A Short Proof that Phylogenetic Tree Reconstruction by Maximum Likelihood is Hard

Introduction

In a series of seminal works, Edwards and Cavalli-Sforza [\cite=EC64], Neyman [\cite=Ne71], and Felsenstein [\cite=Fe81] applied the maximum likelihood methodology to the problem of inferring phylogenies from molecular sequences. Since, the many variants of this approach have gained increasing popularity in the systematics literature. This is due in part to the flexibility of the technique in accomodating a variety of models of evolution as well as to good practical performance. Nevertheless, the approach is not without a flaw: it has been observed to be highly demanding computationally. Remarkably, the computational complexity status of the problem has remained elusive. Partial progress was made recently in [\cite=AC04] where a variant of the problem, known as Ancestral Maximum Likelihood, was shown to be [formula]-hard. Here, we resolve the issue by proving that computing the maximum likelihood tree is [formula]-hard. Moreover, we show that the log-likelihood is [formula]-hard to approximate within a constant ratio. Our proof--which is mostly elementary--combines a connection between likelihood and parsimony observed by Tuffley and Steel [\cite=TS97] with a result on the hardness of approximating parsimony obtained by Wareham [\cite=Wa93].

General references on inferring phylogenies are [\cite=Fe03] [\cite=SS03]. For background on [formula]-completeness and hardness of approximation, refer to [\cite=GJ76] [\cite=AC99]. Many other popular phylogenetic techniques have been shown to be [formula]-hard, including parsimony [\cite=FG82] [\cite=DJS86], compatibility [\cite=DS86], and distance-based methods [\cite=AB+99].

Remark. While writing this paper, Mike Steel brought to our attention that Benny Chor and Tamir Tuller have recently given an independent proof of this result which now appears in the proceedings of RECOMB 2005 [\cite=CT05]. Similarly to the proof presented here, the Chor-Tuller paper uses results from [\cite=TS97] and the hardness of approximating vertex cover (from which follows the hardness of approximating parsimony), but their argument proceeds from a sequence of rather involved constructions. Our reduction has the advantage of being short and elementary. It also sheds some more light on the interesting connection between likelihood and parsimony.

Definitions and Results

The use of maximum likelihood requires the choice of a statistical model of evolution. Here, we consider the simple binary symmetric model generally known as the Cavender-Farris model [\cite=Ca78] [\cite=Fa73]. We are given a tree T on n leaves and probabilities of transition on edges [formula], where E(T) is the set of edges of T and [formula] is the cardinality of E(T). (All trees considered here have no internal vertex of degree 2.) A realization of the model is obtained as follows: choose any vertex as a root; pick a state for the root uniformly at random in {0,1}; moving away from the root, each edge e flips the state of its ancestor with probability pe. Let

[formula]

Proof

In this section, we prove our main result. The proof follows easily from the following propositions. The first proposition borrows heavily from [\cite=TS97] although we need somewhat tighter estimates. The second proposition follows directly from the work of [\cite=Wa93] [\cite=CT99].

Let c'  >  c  >  0 be constants. If there is a (1 + c)-approximation algorithm for ML then there is a (1 + c')-approximation algorithm for MP.

There exists a c' > 0 sufficiently small so that there is no (1 + c')-approximation algorithm for MP unless [formula].

As in [\cite=TS97], the reduction from MP to ML consists in adjoining a large number of constant sites to the data. Let ε  >  0 be a small constant and M  =   max {2n,k}. Fix Nc  =  M1 / ε. Denote by X0  =  {χi}k + Nci = 1 the set X augmented with Nc all-0 characters. For all χ, let Nχ be the number of characters equal to χ in X. To avoid the factors of 2 from the probability of the root state, we define [formula] for [formula]. Also, let [formula]. Let 0 be the all-0 character and 1, the all-1 character. We make three claims, from which Proposition [\ref=prop:1] follows.

Let ε  >  0 and Nc  =  M1 / ε for M  =   max {2n,k}. Let [formula], for all e∈E(T). Then [formula], for M large enough.

Note that, by a calculation identical to [\cite=TS97], where we have used a standard Taylor expansion (note that we have q  ≤  1 / 2 by definition). This bound applies in particular to the case χ  =  0. Then, as in [\cite=TS97] again,

[formula]

for M large enough. (Note that [formula] because [formula] by symmetry.)

For all [formula] such that [formula], one has pe  ≤  , [formula], with [formula].

Assume edge e is such that pe  >  . Take any two leaves u,v joined by a path going through e. As observed in [\cite=TS97], the probability that χ(u)  ≠  χ(v) is at least pe. In particular, the probability that a character is constant is less than 1  -  pe and -   ln 0  ≥    -   ln (1  -  pe)  ≥  pe (by the 0 - 1 symmetry). Therefore,

[formula]

by pe  >   and χ  ≤  1 (by the 0 - 1 symmetry). This contradicts the assumption.

Let ε  >  0 and Nc  =  M1 / ε for M  =   max {2n,k}. For all [formula], we have [formula] for M large enough.

For this proof, we need a better estimate than [\cite=TS97]. From Claim [\ref=claim:2], the result holds whenever max epe  >  . Therefore, we can assume that for all e∈E(T), pe  ≤  . Then, when M is large enough so that   <  1 / ET. For constant sites, we use the bound 0,1  ≤  1 (by the 0 - 1 symmetry). Therefore,

[formula]

for M large enough.

(Proposition [\ref=prop:1]) Let T* be a maximum likelihood tree with corresponding edge probabilities [formula], and T*  *, be a maximum parsimony tree. Assume we have a polynomial-time algorithm which is guaranteed to return a tree T' and edge probabilities [formula] such that Then the claims above and the optimality of T* imply that, if [formula] is chosen as in Claim [\ref=claim:1] (for T = T*  *),

[formula]

for ε small enough.

(Proposition [\ref=prop:2]) Wareham [\cite=Wa93] gives a reduction from vertex cover with bounded degree B (B-VC) to maximum parsimony. (Wareham actually defines MP as a Steiner tree problem on the Hamming cube {0,1}k but the correspondence with our definition is straightforward.) The reduction is such that the existence of a (1 + c')-approximation algorithm for maximum parsimony implies the existence of a (1 + 2Bc')-approximation algorithm for B-VC. By [\cite=CT99], for a sufficiently large B, there is no 1.16-approximation algorithm for B-VC unless [formula].

Acknowledgment

I thank Elchanan Mossel, Mike Steel and Tandy Warnow for discussions and encouragements. I gratefully acknowledge the partial support of CIPRES (NSF ITR grant # NSF EF 03-31494), NSERC, NATEQ, and a Loève Fellowship. This project was initiated at a CIPRES retreat. I also thank Martin Nowak and the Program for Evolutionary Dynamics at Harvard University where part of this work was done.