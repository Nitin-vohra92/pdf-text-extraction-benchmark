Corollary Lemma Proposition Definition ExampleRemark

Addition in Jacobians of tropical hyperelliptic curves

Introduction

Let P0 be a point on a tropical elliptic curve. Suppose P1 to be the point such that P1 = P0 + T, where T is also a point on the tropical elliptic curve and "+" is the addition in the curve [\cite=Vigeland04] [\cite=Nobe08]. By applying the addition + T repeatedly, we obtain the sequence of points [formula] on the tropical elliptic curve. The sequence of points thus obtained can be regarded as a dynamical system on the curve and is often referred as the ultradiscrete QRT system [\cite=Nobe08]. Since each member of the ultradiscrete QRT system has the tropical elliptic curve as its invariant curve and its general solution can be given by using the ultradiscrete theta function [\cite=TTGOR97] [\cite=MZ06] [\cite=Nobe08], it is considered to be a two-dimensional integrable dynamical system. It should be noted that the evolution of the ultradiscrete QRT system is given by a piecewise linear map. On the other hand, if we suppose P1 to be the point such that P1 = P0 + P0 = 2P0 and apply the duplication repeatedly then we obtain the sequence of points [formula] on the tropical elliptic curve as well. The sequence of points thus obtained can also be regarded as a dynamical system on the curve and is often referred as the solvable chaotic system [\cite=KNT08] [\cite=KKNT09]. The solvable chaotic system also has the tropical elliptic curve as its invariant curve and its general solution can also be given by using the ultradiscrete theta function; nevertheless it can not be considered to be an integrable system because the inverse evolution is not uniquely determined. Thus the additive group structure of the tropical elliptic curve leads to two kinds of dynamical systems, one is integrable and the other is not.

In analogy to the theory of plane curves over [formula], there exists a family of tropical plane curves parametrized with an invariant called the genus of the curve. A paradigmatic example of such a family of tropical plane curves consists of the tropical hyperelliptic curves. Tropical elliptic curves are of course the members of the family labeled by the lowest genus. Therefore, it is natural to consider that the additive group structure of the Jacobian of a tropical hyperelliptic curve also leads to several kinds of dynamical systems containing both an integrable one and a solvable chaotic one. In this paper, in order to investigate a dynamical system arising from the additive group structure of the tropical hyperelliptic curve, we first review several important notions in tropical geometry to describe the Riemann-Roch theorem for tropical curves. We also introduce a (g + 2)-parameter family of tropical hyperelliptic curves of genus g known as the set of the isospectral curves of (g + 1)-periodic ultradiscrete Toda lattice. We then show the existence of a surjection between a tropical hyperelliptic curve and its Jacobian by using the tropical version of the Riemann-Roch theorem. This surjection induces the group structure of an appropriate set of effective divisor of degree g on the hyperelliptic curve from that of the Jacobian. We further show that we can realize the addition in the Jacobian of the tropical hyperelliptic curve of genus g as the addition of the g-tuples of points on the curve in terms of the intersection with a curve of genus 0.

Riemann-Roch theorem for tropical curves

We briefly review the notions of tropical curves as well as rational functions and divisors on them. By using these tools we mention the Riemann-Roch theorem for tropical curves, which was independently found by Gathemann-Kerber [\cite=GK06] and Mikhalkin-Zharkov [\cite=MZ06] in 2006.

A metric graph is a pair (Γ,l) consisting of a graph Γ together with a length function [formula], where E(Γ) is the edge set of the graph Γ. The first Betti number of Γ is called the genus of Γ. A tropical curve is a metric graph (Γ,l) with a length function [formula],i.e., a metric graph with possibly unbounded edges.

A divisor D on a tropical curve Γ is a formal [formula]-linear combination of finite points on Γ

[formula]

where [formula] and aP = 0 for all but finitely many P∈Γ.

The addition of two divisors [formula] and [formula] on a tropical curve Γ are defined to be [formula]. All divisors on Γ then naturally compose an abelian group. We call it the divisor group of Γ and denote it by Div(Γ). The degree deg D of a divisor [formula] is defined to be the integer [formula]. The support [formula] of D is defined to be the set of all points of Γ occurring with a non-zero coefficient. If all the coefficients aP of a divisor [formula] are non-negative then the divisor is called effective and is written D > 0. We define the canonical divisor KΓ of Γ to be

[formula]

where val(P) is the valence of the point P∈Γ [\cite=Z93]. If P is an inner point on an edge of Γ then val(P) = 2, therefor such points never appear in KΓ. The canonical divisor KΓ of a tropical curve Γ of genus g is an effective divisor of degree 2g - 2 [\cite=MZ06].

A rational function on a tropical curve Γ is a continuous function [formula] such that the restriction of f to any edge of Γ is a piecewise linear integral function. The values ±    ∞   can only be taken at the unbounded edges of Γ.

The order ordPf of a rational function f at P∈Γ is defined to be the sum of the outgoing slopes of all segments of Γ emanating from P. If ordPf > 0 then the point P∈Γ is called the zero of f of order ordPf. If ordPf < 0 then P is called the pole of f of order [formula]. We define the principal divisor of a rational function f (or divisor associated to f) on Γ to be

[formula]

For any rational function f on a tropical curve Γ we have

[formula]

Let D be a divisor of degree n on a tropical curve Γ. We denote by R(D) the set of all rational functions f on Γ such that the divisor (f) + D is effective:

[formula]

For any f∈R(D) the divisor (f) + D is a sum of exactly [formula] points by the above remark.

When formulating a statement about the dimensions of the linear systems R(D) we have to be careful since R(D) is in general not a vector space but a polyhedral complex and hence its dimension is ill-defined. The following definition serve as a replacement.

Let D be a divisor of degree n on a tropical curve Γ. We define the rank r(D) of the divisor D to be the maximal integer k such that for all choices of (not necessarily distinct) points [formula] we have [formula]. If [formula] then we define r(D) =  - 1.

If we want to specify the curve Γ in the notation of R(D) and r(D) we also write them as RΓ(D) and rΓ(D), respectively.

Two divisors D and [formula] on a tropical curve Γ are called equivalent and written [formula] if there exists a rational function f on Γ such that [formula].

If [formula] then [formula] for some rational function f on Γ. Then the map [formula], g  ↦  g + f is a bijection because we have [formula]. Thus we have [formula].

Let [formula] be a tropical curve and let Γ be the metric graph obtained from [formula] by removing all unbounded edges. Then every divisor D∈Div() is equivalent on [formula] to a divisor [formula] with [formula]. If D is effective then [formula] can be chosen to be effective as well. Moreover, [formula] if and only if [formula].

Let [formula], Γ, and [formula] as in lemma [\ref=lmm:equiv]. By lemma [\ref=lmm:equiv] any effective divisor on [formula] is equivalent to a divisor of the same degree with the support on Γ. Therefore we conclude that [formula].

We then have the Riemann-Roch theorem.

For any divisor D on a tropical curve [formula] of genus g we have

[formula]

It immediately follows a corollary of theorem [\ref=thm:RRT].

If deg D > 2g - 2 then r(D) =  deg D - g.

(Proof)  Since [formula], we have [formula]. This implies [formula] and hence [formula]. By the Riemann-Roch theorem we have

[formula]

as desired.

Surjections between tropical curves and their Jacobians

By applying the Riemann-Roch theorem to a tropical curve of genus g, one can obtain several propositions concerning a surjection from the set of effective divisors of degree g of the tropical curve to its Jacobian. Let [formula] be a tropical curve of genus g. We define D0() to be the subgroup of the divisor group Div() of [formula] generated by the divisors of degree 0. We also define Dl() to be the subgroup of D0() generated by the principal divisors of rational functions on [formula].

We define the Picard group Pic0() of a tropical curve [formula] to be the residue class group Pic0(): = D0() / Dl(). In particular, by lemma [\ref=lmm:equiv] we have

[formula]

Let Ω(Γ) be the space of global 1-form on Γ. Also let [formula] be the vector space of [formula]-valued linear functions on Ω(Γ). Then the integral cycles [formula] form a lattice in [formula] by integrating over them.

We define the Jacobian J(Γ) of a tropical curve [formula] to be

[formula]

Since there exists an isomorphism between Pic0(Γ) and J(Γ) [\cite=MZ06], we can identify them:

[formula]

We define the subset D+g(Γ) of Div() to be

[formula]

Fix an element [formula] of D+g(Γ). Then we can define two maps φ:D+g(Γ)  →  D0(Γ) and :D+g(Γ)  →  J(Γ) to be

[formula]

for A∈D+g(Γ), respectively. We then have the following theorem.

The map :D+g(Γ)  →  J(Γ) is surjective.

(Proof)  It is sufficient to show that there exists an element A of D+g(Γ) such that [formula] for any D∈D0(Γ). By the Riemann-Roch theorem we have

[formula]

because [formula] holds. This means that [formula] and hence there exists a rational function h satisfying [formula]. Let [formula]. Then deg A = 0 + 0 + g = g and A > 0 lead to A∈D+g(Γ). Moreover we have

[formula]

This completes the proof.

As in the non-tropical case, for a tropical curve of genus one the surjection [formula] reduces to the bijection. This fact was first found by Vigeland in 2004 [\cite=Vigeland04].

The map :D+g(Γ)  →  J(Γ) is bijective if and only if g = 1.

(Proof)  If we assume [formula] for some P,Q∈D+g(Γ) then we have [formula] and hence [formula]. This means that there exists a rational function h satisfying (h) = P - Q. Since P is effective, (h) + Q is effective as well. Therefore the rational function h is an element of R(Q). If we assume g = 1 then we have deg Q = 1 > 0 = 2g - 2. By corollary [\ref=crl:CorRRT] we obtain

[formula]

This implies that h∈R(Q) is a constant function, and hence P - Q = (h) = 0. Thus the map [formula] is injective.

On the other hand, if we assume [formula] then we have [formula] and hence [formula]. Let 1 be a constant function then [formula]. This implies [formula] and hence [formula]. Thus we have

[formula]

Therefore there exists a rational function h satisfying [formula].

Any element of D+g(Γ) is given by [formula], where [formula] are the points on the metric graph Γ not necessarily distinct. Let us denote the image of [formula] with respect to the map [formula] by

[formula]

Since the map :D+g(Γ)  →  J(Γ) is surjective, we have

[formula]

Thus the addition in J(Γ) can be pulled back in Γ by [formula]. Actually, we define the addition of g-tuples [formula] and [formula] of the points on Γ to be

[formula]

where the addition in the right-hand-side is considered to be the one in J(Γ).

Tropical hyperelliptic curves

In this and the subsequent sections we concentrate on a (g + 2)-parameter family of smooth tropical curves of genus g called the tropical hyperelliptic curves.

Let us consider the (non-tropical) hyperelliptic curve of genus g defined by the polynomial of degree 2g + 2:

[formula]

where we assume that f(x,0) =  - P(x)2 + 4c- 1 has no multiple root. By applying to f(x,y) the birational transformation (x,y)  ↦  (X,Y)

[formula]

we obtain the hyperelliptic curve given by the polynomial

[formula]

Now we tropicalize F(X,Y). Replace the addition +   and the multiplication ×   in F(X,Y) with the tropical addition [formula] and the tropical multiplication [formula], respectively. If we define these tropical operations to be

[formula]

then we obtain the following tropical polynomial

[formula]

where we assume cg + 1 = 0, [formula] for [formula]. Moreover assume

[formula]

Then the tropical polynomial (X,Y) defines a smooth tropical curve [formula] of genus g to be the set of its all non-differentiable points with respect to X or Y (see figure [\ref=fig:THC]).

The curve [formula] thus obtained is called the tropical hyperelliptic curve and is known as the isospectral curve of the ultradiscrete periodic Toda lattice, or the periodic box-ball system [\cite=IT08].

Let [formula] be the primitive tangent vector along the edge e∈E(), where E() is the edge set of the tropical hyperelliptic curve [formula]. Also let |e| and [formula] be the Euclidean length of e and [formula], respectively. The length function [formula] of [formula] is defined to be

[formula]

The vertex of [formula] whose Y-coordinate is greater than c- 1 / 2 is denoted by Vi and its conjugate (defined below) by [formula] ([formula]):

[formula]

The outgoing slope of the edge [formula], which emanates from Vi and connects it with Vi + 1, is g - i for [formula].

We define the bifurcation point of the tropical hyperelliptic curve [formula] to be the intersection point of [formula] and the line Y = c- 1 / 2. Note that [formula] is symmetric under the refection with respect to Y = c- 1 / 2. There exist exactly g + 1 bifurcation points on [formula]. We denote the g + 1 bifurcation points by [formula] (see figure [\ref=fig:THC]). We also define the conjugate of a point P on [formula] to be the point which coincide with P under the reflection with respect to Y = c- 1 / 2. The conjugate of a point P on [formula] is denoted by [formula]. Thus the bifurcation point is characterized as the point P on [formula] such that [formula].

The canonical divisors of [formula] and Γ are

[formula]

where V-    ∞, [formula], V∞, and [formula] are the end points of the unbound edges (see figure [\ref=fig:THC]). Of course, [formula] holds.

For the tropical hyperelliptic curve [formula] we have a subset of D+g(Γ) on which the surjection :D+g(Γ)  →  J(Γ) reduces to the bijection. Let αi be the basis of the fundamental group π1(Γ) of Γ for [formula] (see figure [\ref=fig:Cycle]). Also let [formula] for [formula]. We define the subset +g(Γ) of D+g(Γ) to be

[formula]

We then have the following theorem.

A reduced map |+g(Γ) is bijective

[formula]

We define the set Γ+g to be the set of g-tuples [formula] satisfying [formula]:

[formula]

In terms of the map [formula], the additive group structure of Γ+g is induced from J(Γ) .

Realization of addition in tropical hyperelliptic curves

The case of even g

Now we assume that the genus g of the tropical hyperelliptic curve [formula] is even. Let us fix [formula] as follows

[formula]

Unit of addition

We have the following proposition.

For any even g we have

[formula]

where [formula] are the points on Γ and [formula] are their conjugates, respectively.

(Proof)  Assume [formula]. Then we have

[formula]

and vice versa. Therefore [formula] is equivalent to the existence of a rational function [formula] on Γ such that [formula].

We show that there exists a rational function [formula] on Γ such that [formula]. Without loss of generality we can assume the Y-coordinate of Pi is greater than or equal to c- 1 / 2 for [formula]. Let us denote the path in Γ connecting Ai with Vi - 1 (resp. [formula]) through Vi (resp. [formula]) by πi (resp. [formula]) for [formula] (see figure [\ref=fig:path]). Also denote the path in Γ connecting A0 with V0 (resp. [formula]) by π0 (resp. [formula]).

Owing to the above assumption, there exist g / 2 points [formula] on [formula]. We construct the rational function [formula] on [formula] as follows. The value of [formula] at Ag can arbitrarily be chosen. We start walking the path πg form Ag to Vg - 1. If we find the point Pg1 on the path πg then we set (Pg1) = (Ag) and the outgoing slope of [formula] from Pg1 to be 1. If we find the next point Pg2 on the path πg then we set the outgoing slope of [formula] from Pg2 to be 2. Thus Pg1 and Pg2 are the zeros of [formula] of order 1. If Pg1 = Pg2 then the part of [formula] of slope 1 disappears and Pg1 = Pg2 is the zero of [formula] of order 2. If there exist exactly k points [formula] on the path πg then the slope of [formula] at Vg - 1 is k. The value of [formula] at Vg - 1 is uniquely determined. By applying the same procedure inductively to the remaining paths [formula] we obtain the rational function [formula] on [formula] satisfying

[formula]

Note that the slope of [formula] at V0 is g / 2 since there exist g / 2 points [formula] on [formula]. Also note that the value of [formula] at the bifurcation points [formula] are uniquely determined by [formula], respectively.

In the same manner we obtain the rational function [formula] on [formula] satisfying

[formula]

If we set [formula] then

[formula]

is the rational function on [formula] satisfying [formula] as desired.

Combining theorem [\ref=thm:bijection] and proposition [\ref=prp:zero], we obtain the following proposition concerning the unit of addition O of the group (Γ+g,O).

For any even g, the g-tuple [formula] is the unit of addition O of the group (Γ+g,O):

[formula]

(Proof)  Since Vi∈αi and [formula] and [formula] for [formula], we have [formula]. By proposition [\ref=prp:zero] we have

[formula]

On the other hand, [formula] is the only choice which satisfies both [formula] and [formula] because the map |+g(Γ) is bijective.

Inverse elements

For any element [formula] of Γ+g the inverse [formula] with respect to the addition is simply given as follows.

For any even g we have

[formula]

where [formula] and [formula]. Therefore we write [formula].

(Proof)  Note first that [formula] since [formula]. By proposition [\ref=prp:zero] we have

[formula]

This completes the proof.

Tropical curves passing through given points

Now we realize the addition

[formula]

of the group (Γ+g,O), where [formula], [formula], and [formula] are the elements of Γ+g, by using the intersection of the tropical hyperelliptic curve [formula] and a tropical curve of degree 3g / 2.

By proposition [\ref=prp:inv] the addition [\eqref=eq:add] can be written

[formula]

Therefore there exists a rational function h on Γ satisfying

[formula]

This implies [formula].

Define the rational functions x and y on the metric graph Γ to be

[formula]

where P = (p,q) is a point on Γ. We can easily see

[formula]

Consider the tropical monomial [formula] in x for [formula]. Then we have

[formula]

where [formula] is the constant function. Because the principal divisor is computed as follows

[formula]

and hence we have

[formula]

for any even g if and only if [formula]. Similarly, for the tropical monomial [formula] in x,y for [formula] we have

[formula]

Because we have

[formula]

for any even g if and only if [formula].

Let us consider the tropical module Mg spanned by the 2g + 1 rational functions [formula] [formula] and [formula] [formula] [\cite=MZ06]:

[formula]

Then we have the following proposition.

For any even g we have

[formula]

(Proof)  Denote the set of poles of a rational function h on the metric graph Γ by Sh. Then for the set [formula] of the poles of the linear combination [formula] of two rational functions f and h on Γ we have

[formula]

Because if it does not hold then there exists a point [formula] which is the pole of neither f nor h. Since P is the pole of [formula], the sum of its outgoing slope at P is negative, while those of both f and h are non-negative. Let the edges outgoing from P be [formula] for k = 2,3. (Note that the point P on Γ is at most trivalent.) Also let the slope of f and h on ei be fi and hi, respectively. We then have [formula] and [formula]. By definition the outgoing slope of [formula] at P is

[formula]

This is a contradiction. Thus if [formula] then [formula]. Therefore we have [formula].

We can easily find a rational function [formula] not included in Mg, e.g., the one whose two zeros are on the edge [formula].

Let h∈Mg. Since h is a tropical polynomial in x and y of degree 3g / 2, it can be extended as a rational function on the (X,Y)-plane. If P is the zero of h then the function h is not differentiable with respect to X or Y at P. Thus the tropical curve C of degree 3g / 2 defined by h passes through the zero P of h. If P is on the tropical hyperelliptic curve [formula] as well then P is the intersection points of [formula] and C.

Assume that the coefficients of h satisfy the generic condition

[formula]

Then C has exactly 2g - 1 vertices and is smooth. Figure [\ref=fig:TC] shows the smooth tropical curve C satisfying the generic condition.

The vertex from which an unbound edge emanating upward is denoted by Ui for non-positive [formula]; and the one from which an unbound edge emanating downward by Ui for positive [formula]. The coordinate of the vertices are given as follows

[formula]

The outgoing slope of the edge [formula] is 3g / 2 - i for [formula] and the one of the edge [formula] is 3g / 2 + i - 1 for [formula]. The slopes of the remaining unbound edges emanating from U- g / 2 + 2 and U3g / 2 are g + 1 and 0, respectively.

If h∈Mg satisfies the generic condition [\eqref=eq:gconde] then the curve C defined by h is smooth. Therefore the dimension of the tropical module Mg is exactly 2g + 1 [\cite=MZ06]. Since [formula] for any [formula], by corollary [\ref=crl:CorRRT], we have

[formula]

This means that the maximal dimension of the cells of [formula] is at least dim Mg [\cite=GK06].

Intersection numbers

In order to investigate the intersection points of [formula] and C, we consider the homogeneous coordinate (x0:x1:x2) of the tropical projective plane [formula] [\cite=MZ06]. Denote the point ( -   ∞  :0: -   ∞  ) at infinity by P∞. Then we can see [formula] passes through P∞. Actually, the unbound edge emanating from the vertex V0 is given as follows

[formula]

in the homogeneous coordinate. Note that this unbound edge goes to the direction x2 =  -   ∞  . If we set x2 =  -   ∞   in [\eqref=eq:pai] then x0 must be -    ∞   since g is positive. We can also see that the g / 2 - 1 unbound edges emanating from U- i for [formula] of the curve C pass through P∞. Thus the two curves [formula] and C intersect at P∞. We then have the following lemma concerning the intersection number of [formula] and C at P∞.

The tropical hyperelliptic curve [formula] intersects the tropical curve C defined by h∈Mg with multiplicity 3g2 / 2 at the point P∞ at infinity.

(Proof)  Let the unbound edge of [formula] emanating from the vertex V0 be e0. Also let the edge of C outgoing upward from the vertex Ui be εi for [formula]. Let the remaining unbound edge of C outgoing from U- g / 2 + 2 be ε- g / 2 + 1. The primitive tangent vector of these unbound edges are given as follows

[formula]

where we choose the basis ( - 1,0) and (1,1).

The intersection number at P∞ of two curves, whose primitive tangent vectors of the unbound edges passing through P∞ are (a,b) and (c,d) respectively, are defined to be

[formula]

where w1 and w2 are the weights of the two edges, respectively [\cite=Gathmann06]. Note that the weights of the edges e0 and εi ([formula]) are all 1. Then the intersection number of [formula] and C at P∞ can be computed as follows

[formula]

This completes the proof.

The degree of the curves [formula] and C are g + 2 and 3g  /  2, respectively. By the Bézout theorem for tropical curves [\cite=RST05] [\cite=Gathmann06] [formula] intersects C at (g + 2)3g  /  2 points, counting multiplicities. Note that [formula] and C do not intersect at the point at infinity other than P∞. Therefore, in the affine part, [formula] intersects C at

[formula]

points, counting multiplicities.

Realization of addition

Let [formula] and [formula] be in Γ+g. Assume the 2g points in [formula] and [formula] to be in generic position. Then there exists a unique tropical curve C passing through these 2g points and defined by a rational function h∈Mg. Note that the rational function h∈Mg is uniquely determined by the 2g points [formula] and [formula] up to a constant because h has 2g + 1 parameters. Consider the intersection of the tropical hyperelliptic curve [formula] and the curve C. Since [formula] intersects C at 3g points, there further exist g intersection points, counting multiplicities. Let these intersection points be [formula]. Figure [\ref=fig:g2int] shows an example of the intersection [formula] and C for g = 2.

Then the principal divisor of the rational function h defining C has the form [\eqref=eq:addrf]. It follows that the g-tuples [formula], [formula], and [formula] satisfy the addition formula

[formula]

of the group (Γ+g,O) (see figure [\ref=fig:g2int]).

The case of odd g

Next we assume the genus g of the tropical hyperelliptic curve [formula] to be odd. Let us fix [formula] as follows

[formula]

Unit of addition

We have the following proposition in analogy to the case of even g.

For any odd g we have

[formula]

where [formula] are the points on Γ and [formula] are their conjugates, respectively.

(Proof)  It is sufficient to show the existence of the rational function h satisfying

[formula]

It is obvious from proposition [\ref=prp:zero].

Combining theorem [\ref=thm:bijection] and proposition [\ref=prp:zeroodd], it immediately follows the proposition concerning the unit O of addition the group (Γ+g,O).

The g-tuple [formula] is the unit of addition O of the group (Γ+g,O):

[formula]

Addition in tropical elliptic curves

Since the case of g = 1 is distinctive, we first consider the case. Let g = 1 then [formula] and O = V0. Note that the map :D+1(Γ) = Γ  →  J(Γ) is bijective, and hence Γ+1  =  D+1(Γ) = Γ≃J(Γ). For the rational functions y and x + y we have

[formula]

Define the tropical module M1 to be

[formula]

It is easy to see that [formula].

Let h∈M1. Suppose h to pass through the points P,Q∈Γ+1  =  Γ≃J(Γ), which are in generic position. Then h is uniquely determined up to a constant. The tropical curve C defined by h is of degree 2 and passes through the points P∞ and [formula] at infinity. The tropical elliptic curve [formula] defined by the tropical polynomial

[formula]

is of degree 3 and passes through both P∞ and [formula] as well.

The primitive tangent vector of the unbound edge of C passing through P∞ is (1,1) with respect to the basis ( - 1,0) and (1,1); and the one of [formula] passing through P∞ is (1,2). Therefore the intersection number of C and [formula] at P∞ is [formula]. The intersection number of C and [formula] at [formula] can also be computed as [formula]. Therefore [formula] intersects C at

[formula]

points in its affine part, counting multiplicities. Thus ∈Γ+1 satisfying

[formula]

is the third intersection point of [formula] and C (see figure [\ref=fig:g1int]).

Let us consider the rational function f∈M1 passing through both [formula] and O = V0. Then the third intersection point M (see figure [\ref=fig:g1int]) of [formula] and the curve [formula] defined by f satisfies the addition

[formula]

This implies that we have

[formula]

Thus the addition in (Γ+1,O) can be realized as the intersection of [formula] and tropical curves C and [formula] of degree 2 (see figure [\ref=fig:g1int]).

Tropical curves passing through given points

Next we consider the case of [formula]. For the rational function x we have

[formula]

for any odd [formula] if and only if [formula]. Moreover we have

[formula]

for any odd [formula] if and only if [formula].

Define the tropical module Mg to be the linear combinations of the 2g + 1 rational functions [formula] [formula] and [formula] [formula]:

[formula]

Then we have the following proposition in analogy to the case of even g.

For any odd g we have

[formula]

Assume that the rational function h∈Mg satisfies the generic condition

[formula]

Then the curve C of degree 3(g - 1) / 2 defined by h has exactly 2g - 1 vertices and is smooth.

As in the case of even g, the vertex from which an unbound edge emanating upward is denoted by Ui for non-positive [formula]; and the one from which an unbound edge emanating downward by Ui for positive [formula]. The coordinates of the vertices are given as follows

[formula]

The slope of the edge [formula] is 3(g - 1) / 2 - i for [formula] and the one of the edge [formula] is 3(g - 1) / 2 + i - 1 for [formula]. The slopes of the remaining unbound edges emanating from U- (g + 1) / 2 + 1 and U3(g - 1) / 2 are g - 2 and 0, respectively (see figure [\ref=fig:TCodd]).

Intersection numbers

We have the following lemma concerning the intersection number of [formula] and C at the point at infinity.

For any odd [formula] the tropical hyperelliptic curve [formula] of genus g intersects the tropical curve C defined by h∈Mg with multiplicity 3(g + 1)(g - 2) / 2 at the point P∞ at infinity.

(Proof)  Let the unbound edge of [formula] emanating from the vertex V0 be e0. Also let the edge of C outgoing upward from the vertex Ui be εi for [formula]. Let the remaining unbound edge of C outgoing from U- (g + 1) / 2 + 1 be ε- (g + 1) / 2. The primitive tangent vector of these unbound edges are given as follows

[formula]

where we choose the basis ( - 1,0) and (1,1). The intersection number of [formula] and C at P∞ can be computed as follows

[formula]

This completes the proof.

For any odd [formula] the degree of [formula] and C are g + 2 and 3(g  -  1)  /  2, respectively. By the Bézout theorem [formula] intersects C at 3(g + 2)(g  -  1)  /  2 points, counting multiplicities. Note that [formula] and C do not intersect at the point at infinity other than P∞. Therefore, in the affine part, [formula] intersects C at

[formula]

points, counting multiplicities.

Realization of addition

Let [formula] and [formula] be in Γ+g. Assume the 2g points in [formula] and [formula] to be in generic position. Then there exists a tropical curve C passing through these 2g points and defined by a rational function h∈Mg. Consider the intersection of the tropical hyperelliptic curve [formula] and the curve C. Since [formula] intersects C at 3g points, there further exist g intersection points, counting multiplicities. Let these intersection points be [formula]. Then the principal divisor of the rational function h defining C has the form

[formula]

Therefore we have

[formula]

Figure [\ref=fig:g3int] shows an example of the intersection of [formula] of g = 3 and C of degree 3.

Moreover consider the curve [formula] defined by a rational function f∈Mg and passing through the 2g points in [formula] and O. Then [formula] intersects [formula] at 3g points, counting multiplicities. Let the remaining g intersection points be [formula]. Then we have

[formula]

where [formula]. It follows that the g-tuples [formula], [formula], and [formula] satisfy the addition formula

[formula]

of the group (Γ+g,O).

Conclusion

We show that there exists a surjection between the set of effective divisors of degree g on the tropical hyperelliptic curve of genus g and its Jacobian. We also show that the surjection is bijective if and only if g = 1. We then show that there exists a subset of the set of effective divisors of degree g on which the surjection reduces to the bijection. It follows that the additive group structure of the subset is induced by the bijection from the Jacobian, which is isomorphic to the Picard group. The addition in the Jacobian of a tropical hyperelliptic curve of genus g thus induced can be interpreted geometrically as the addition of g-tuples of points on the curve. We realize the addition of g-tuples of points on the curve in terms of the intersection of the hyperelliptic curve and a curve of degree 3g / 2 (resp. 3(g - 1) / 2) for even (resp. odd) g.

If g = 1 then the addition of points on a tropical hyperelliptic curve induces two kinds of dynamical systems realized as the evolutions of points on the curve; one is an integrable system referred as the ultradiscrete QRT system and the other is a solvable chaotic system. Since we can realize the addition of g-tuples of points on the tropical hyperelliptic curve of genus g via the intersection with a curve, we can construct several dynamical systems realized as the evolutions of points on the tropical hyperelliptic curve. We will report such dynamical systems in a forthcoming paper.

Acknowledgments

This work was partially supported by Grants-in-Aid for Scientific Research, Japan Society for the Promotion of Science (JSPS), No. 22740100.