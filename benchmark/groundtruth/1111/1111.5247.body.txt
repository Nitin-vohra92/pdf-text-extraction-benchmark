=10000 ="2D Corollary Lemma Observation Definition Claim Fact Assumption Conjecture

Proof of Lemma : Proof of Proposition : Proof of :

The Complexity of the Separable Hamiltonian Problem

Or Sattath

Introduction and Results

Introduction

The class [formula] is the the quantum analogue of the class [formula] (or more precisely, [formula]). The class was first studied by Kitaev [\cite=KSV02], and has been in focus since: see [\cite=aharonov2002qns] for a survey, and [\cite=osborne2011hamiltonian] for a more recent physics-motivated review. First, Watrous showed that [formula] is in [formula] [\cite=Wat00] (this problem is not known to be in [formula]). Then, after a series of works, Kempe, Kitaev and Regev showed that the 2-[formula] problem is [formula]-complete [\cite=KKR04]. Mariott and Watrous also proved a strong amplification result of [formula] [\cite=MW05]. More recently, Aharonov   tried to extend the celebrated PCP theorem to the quantum case [\cite=AALV09]. [formula], as the quantum equivalent of [formula], is one of the most studied classes in quantum complexity.

One of the striking results in proof systems is that sometimes, limiting the prover can increase the power of the proof system. For example   =   [\cite=lund1992algebraic] [\cite=shamir1992ip], while   =   [\cite=babai1991non]. This means that two classical provers can prove more languages to a verifier if it is guaranteed that the provers cannot communicate with each other. However, these classical examples require interaction between the prover and the verifier. The class (k), introduced by Kobayashi et al. [\cite=kobayashi2003quantum], deals with quantum non-interactive proofs and limits the prover to send k non-entangled proofs, or equivalently k-unentangled provers that cannot communicate with each other. The question whether (k)  =   was answered in the affirmative by Harrow and Montanaro [\cite=harrow2010efficient]. The question whether   ⊆   is still open. Note that in the classical case, (k)  =  (2)  =  .

To show the power of unentangled quantum proofs, Blier and Tapp [\cite=BT09] first presented a [formula] protocol for an [formula] problem with two quantum witnesses of size O( log (n)). The drawback of this protocol is that the soundness parameter is somewhat disappointing (1 - Ω(1 / n6)). This was first improved by Beigi [\cite=Bei10] who showed that the soundness can be reduced to 1  -  1 / n3  +  ε for any ε  >  0. Very recently, Le Gall improved this soundness to [formula] [\cite=LNN11]. Aaronson et al.  showed that there exists a short proof for [formula] in [formula] [\cite=ABD+08], where each unentangled witness has logarithmic size, but where the soundness can be exponentially small. In [\cite=harrow2010efficient] it was shown that ∈(2), where the size of each proof is [formula]. These results tend to show that quantum unentangled proofs are very powerful, since they can solve [formula] problems in a seemingly more efficient way than in [formula]. Liu et al.  have shown that N - , an important problem in quantum chemistry, is in [formula][\cite=liu2007quantum]. This problem is not known to be in [formula].

On the other hand, Brandão et al.  [\cite=BCY11] showed that if the verifier is restricted to performing a Bell measurement, then, the resulting class [formula] is equal to [formula]. Trying to understand the relationship between [formula] and [formula] is a fundamental open problem from the point of view of quantum complexity as well as for the understanding of the power of quantum unentangled proofs.

Contribution

In this paper, we study the relationship between [formula] and (2) from a different perspective. We study the local hamiltonian problem with unentangled witnesses. The k -  (see Def. [\ref=def:lh]) problem is the quantum analog of [formula], and is the canonical [formula] problem. The first proof that k -  is [formula] is by Kitaev. Our first result is to extend this construction to separable witnesses in order to find a complete problem for [formula]. The main ingredient in showing that the k -  problem is [formula], is Kitaev's Hamiltonian, a Hamiltonian which penalizes states that are not history states. History states are states of the form [formula], where |ψt〉 is the state at the t-th step of the verification process when starting with |ψ〉 and the the m ancilla qubits in 0 state, i.e. [formula], and Ui is the i-th gate used in the [formula] verification circuit, and we set as a convention U0  =  I.

It is natural to try to adapt this argument to a [formula] verification circuit by constructing a separable local hamiltonian problem: the input for the separable local hamiltonian problem is the same as the local hamiltonian problem, i.e. a collection of local Hamiltonians [formula], the answer is [formula] if there is a separable quantum state with energy at most a, and the answer is [formula] if all separable quantum states have energy at least b for some energies a  <  b. Yet, there is a flaw in this argument: even if [formula], the history state |ηψ〉 might not be separable. This is caused by two reasons:(i) even though [formula] is a tensor product, for t > 0, |ψt〉 can be entangled, and (ii) even if |ψt〉 is not entangled, the fact that |ηψ〉 is a superposition over all time steps creates entanglement, as long as both parts of the proof change during the computation.

In order to resolve the entanglement issue in |ηψ〉, we use the construction of Harrow and Montanaro [\cite=harrow2010efficient]. They show that every (k) verification circuit can be transformed into a [formula] circuit with the following structure: The first and second witnesses(which are promised to be non-entangled) have the same length, where each witness contains r registers, where each register size, in the first and second witnesses, is the same. The first r steps of the verification procedure are swap-tests between the i-th register of the first and second witnesses, and from that point, the verification circuit acts non-trivially only on the first witness. In a [formula] instance, there exists a non-entangled proof, where [formula]. Notice that [formula], therefore, applying the swap-tests to the above witnesses does not change the state. Since there are no other operations on the second witness, the second witness remains fixed during the entire verification process. If we treat the clock, ancilla qubits and the first witness as the A system, and the second witness as the B system, we get that the history state |η〉 is indeed separable with respect to this division. This is only true if the controlled swap operation is applied on all the qubits in the i-th register of the first and second witnesses. This will make the propagation terms in Kitaev's Hamiltonian non-local. But, on the other hand, a controlled swap operation on arbitrary number of qubits is always sparse: each row has one non-zero entry. This makes each propagation term sparse.

Given a sparse Hamiltonian H, the unitary U  =   exp ( - iHt) can be implemented efficiently, which eventually leads to ∈. Together with the idea above, it can be shown that:

[formula] is [formula].

The only reason why, this construction does not lead to a separable local hamiltonian instance, is that the controlled swap gate must be performed in one step; otherwise, |η〉 would become entangled. At first glance, this might seem as a technicality, but we, surprisingly, show that:

separable local hamiltonian is [formula].

Since the separable local hamiltonian problem is at least as hard as the local hamiltonian problem, and local hamiltonian is [formula], therefore separable local hamiltonian is [formula]-hard. To show that ∈, we use the consistency of local density matrices problem [\cite=liu_consistency_2006] as a subroutine. Informally, the consistency of local density matrices  promise problem asks the following question: given a collection of local density matrices ρi over a constant set of qubits Ci, is there a quantum state ρ such that for each i, the reduced density matrix of ρ over the qubits Ci is equal to ρi? Liu showed that this problem is [formula].

To show that separable local hamiltonian is [formula], we do as follows. Assume that there exists a state [formula] of total length 2n, with energy below the threshold a. Let A,B the two spaces of qubits considered, each of size n. The energy is [formula] where [formula]. Let Ci the subset of qubits each Hi act on. We have [formula], where σCi corresponds to the reduced state of σ on the qubits of Ci. Again, we can decompose σCi into the A part and the B part. We can write [formula]. This is because the state σ is a product state between A and B, hence, the state σCi is also a product state between A and B.

The proof will consist of a classical part: the classical description of the reduced density matrices σAi,σBi. This information is sufficient to calculate the energy classically, using [formula]. The proof also consists of a quantum part: the prover tries to convince the verifier that there exists a quantum mixed state ρA and similarly for ρB that are consistent with the reduced density matrices σAi and σBi. Since consistency of local density matrices is known to be in [formula], the prover can convince the verifier if there exists such a state, but cannot fool the verifier if there is no such state.

Discussion

In the case, where we do not consider separable witnesses, the two problems local hamiltonian and sparse hamiltonian are natural [formula] problems. Thus, in this setting, considering sparse Hamiltonians instead of local Hamiltonians does not increase the power of the verifier.

When we consider separable witnesses, things are different. separable local hamiltonian and separable sparse hamiltonian seem to be natural [formula] problems. With Theorem [\ref=thm:ssh_qmatc], we show that separable sparse hamiltonian is indeed [formula] by adapting Kitaev's completeness and using the new construction from Harrow and Montanaro [\cite=harrow2010efficient]. However, we were not able to remove this sparseness condition to show that separable local hamiltonian is also [formula].

On the other hand, we show that separable local hamiltonian is [formula]. We find this surprising because separable local hamiltonian was a natural candidate for a [formula] problem. This also means that when considering separable witnesses, the sparse condition for Hamiltonians is crucial or conversely that separable witnesses do not help a verifier when his accepting procedure is a sum of local Hamiltonians. This is in sharp contrast with the general case where separable witnesses seem to help the verifier significantly. While we do not have a clear separation between [formula] and [formula], we know that   ⊆    ⊆   (first unpublished proof by Kitaev and Watrous then simplified in  [\cite=MW05]) while we only know that   ⊆  (2)  ⊆   [\cite=kobayashi2003quantum].

Our results characterize rather tightly the difference between [formula] and [formula]. We hope that this will lead to a better understanding of the relationship between these classes.

Structure of the paper:

Section [\ref=sec:definitions] contains the preliminaries and definitions. In Section [\ref=sec:sparse], we show that separable sparse hamiltonian is [formula] (Theorem [\ref=thm:ssh_qmatc]). In Section [\ref=sec:local], we show that separable local hamiltonian is [formula] (Theorem [\ref=thm:slh_in_qma]).

Preliminaries and Definitions

A promise problem L = {Lyes,Lno} is in s,c(k) if there exists a uniformly generated polynomial time quantum algorithm A and computable polynomially bounded functions [formula] such that for all input x∈{0,1}n:

Completeness: if x∈Lyes there exist k witnesses [formula], where each witness |ψi〉 consists of fi(n) qubits such that A accepts [formula] with probability at least c.

Soundness: if x∈Lno then for all k witnesses [formula], where each witness |ψi〉 consists of fi(n) qubits the probability that A accepts [formula] is at most s.

We define [formula], and   =  (1).

If c - s  ≥  1 / poly(n), k = poly(n), and p(n) is an arbitrary polynomial, then s,c(k)  =  2- p(n),1 - 2- p(n)(2).

Furthermore, it can be assumed w.l.o.g. that the [formula] protocol has the following structure: The two witnesses have exactly the same size, where both of them consist of r registers of sizes [formula]. The verification process consists of applying the product test (see Def. [\ref=def:product_test]). If the product test fails, Arthur rejects. Otherwise, Arthur runs a polynomial quantum algorithm A on the first proof, and outputs the result. In a [formula] instance, the two Merlins can send identical states, which are tensor product between the r registers: [formula].

The input consists of two states, where each state has r registers of size [formula]. Preform the swap test on each of the r pairs. Accept if all of the swap-tests pass, otherwise reject.

Input: a set of hermitian matrices [formula], where each matrix operates on a set of at most k out of the n qubits, and [formula] (i.e. both Hi and I - Hi are positive semi definite), and two real number a and b such that b - a  >  poly(1 / n). We define the Hamiltonian, with a slight abuse of notation, [formula]. Output: Output [formula] if there exists a state |ψ〉 such that 〈ψ|H|ψ〉  ≤  a, and [formula] if for every state |ψ〉, 〈ψ|H|ψ〉  ≥  b.

We say a Hamiltonian H on n qubits is simulatable if for every t > 0 and every accuracy α  >  0, the unitary transformation U  =   exp ( - iHt) can be approximated to within α accuracy by a quantum circuit of size [formula].

The input is the same as the input for the k-local hamiltonian problem together with a partition of the qubits to disjoint sets A and B. The answer is [formula] if [formula] and the answer is [formula] if 〈ψ|H|ψ〉  ≥  b for all tensor product states [formula].

Remark:

The above definition can be formulated using mixed states in the two following ways, with mixed product states and mixed separable states. It can be verified that indeed these definitions are equivalent.

The input is the same as in Def. [\ref=def:slh]. The answer is [formula] if there exists a product mixed state [formula] s.t. [formula] and the answer is [formula] if [formula] for all product mixed states [formula].

The input is the same as in Def. [\ref=def:slh]. The answer is [formula] if there exists a separable mixed state [formula] and the answer is [formula] if [formula] for all separable mixed states [formula].

We now define the separable sparse hamiltonian problem.

An operator A over n qubits is row-sparse if each row in A has at most poly(n) non-zero entries, and there exists an efficient classical algorithm that, given i, outputs a list (j,Ai,j) running over all non zero elements of Ai,j. The separable sparse hamiltonian problem is the same as separable k-local hamiltonian except each term in the input Hamiltonian is row-sparse instead of k-local.

Finally, we define the consistency of local density matrices problem which we will use to show that the separable k-local hamiltonian problem is [formula].

We are given a collection of local density matrices [formula], where each ρi is a density matrix over qubits [formula], and |Ci|  ≤  k for some constant k. Each matrix entry is specified by poly(n) bits of precision. In addition, we are given a real number β  ≥  1 / poly(n) specified with poly(n) bits of precision. The problem is to distinguish between the following two cases:

There exists an n qubits mixed state σ such that for all i such that [formula]. In this case, output [formula].

For all n qubits mixed states σ, there exists some i such that [formula]. In this case output [formula].

The construction has the same structure as the proof that ∈ in [\cite=KSV02], and uses phase estimation as a subroutine to achieve that [\cite=KSV02] [\cite=NC00]. We consider row sparse Hamiltonians {Hj}1  ≤  j  ≤  m and [formula]. For each j, we construct a quantum algorithm Qj such that

[formula]

where we choose [formula], and the running time of Qj is polynomial in n. Let Q be the algorithm where we pick 1  ≤  j  ≤  m at random, and run Qj.

[formula]

Therefore, in a [formula] instance there exists a state [formula] which is accepted with probability at least [formula], whereas in a [formula] instance, the probability of acceptance for every tensor product state is at most [formula]. Therefore the problem is in c,s(2), which is equal to [formula] by Thm. [\ref=thm:qma_k_equals_qma_2].

All that is left to show how to implement Qj. Aharonov and Ta-Shma have shown:

If H is row-sparse, and ||H||  ≤  poly(n) then H is simulatable.

Let V be a unitary which can be implemented by a quantum circuit with d gates, which has eigenstates {|uj〉}1  ≤  j  ≤  N, and eigenvalues {eiφj}1  ≤  j  ≤  N. Given a state [formula], an error parameter ε and a precision parameter δ, the phase estimation procedure outputs with probability at least pi(1  -  ε) a number which is δ close to φi.

Let [formula]. The phase estimation procedure can be implemented by a quantum circuit with O(t2  +  d2t) gates.

We can now show how to implement Qj:

Start with a state [formula], where |ui〉 is an eigenstate of Hj with eigenvalue φi.

Apply phase estimation with the unitary U =  exp (iHj) with probability for an error and precision [formula]. Denote by φ̃ the output of the phase estimation.

Reject with probability φ̃.

Using Thm. [\ref=thm:phase_estimation], we can get both a lower and an upper bound on the acceptance probability:

[formula]

Since [formula], and [formula] we get:

[formula]

which was the requirement for Qj.

Unfortunately, By Lemma [\ref=le:spare_hamiltonian], we can only approximate U =  exp (iHj) which is needed in step 2. A polynomial approximation, which can be achieved in polynomial time, is good enough for our needs, for similar reasons as the analysis done in [\cite=AT03] and [\cite=WZ06].

Consider a promise problem L  =  {Lyes,Lno} which is in s,c(2) with [formula] and [formula]. C is a universal constant that will be specified later. For such s and c, we have s,c(2)  =  (2) by Theorem [\ref=thm:qma_k_equals_qma_2]. Our goal is to reduce this problem to the separable sparse hamiltonian problem.

Pick an instance x of L and let A the associated verifying procedure. We will omit the dependence in x and write the verifying procedure as a unitary U taking as input the two quantum witnesses. We can assume w.l.o.g. that this verification procedure has the structure described in Thm. [\ref=thm:qma_k_equals_qma_2]. We decompose the verifying procedure into T unitaries [formula] each acting on a 2 qubits. This means that after t steps of the verifying procedure, the unitary applied is [formula], where we add the convention that U0  =  I.

We apply Kitaev's construction (See [\cite=KSV02] for the detailed definition) of the circuit, and get a Hamiltonian of the form:

[formula]

It should be stressed that the swap-test is implemented in a non-local manner, and therefore, Hprop is not local. Nevertheless, each term in Hprop is sparse. Reminder:

[formula]

[formula]

Indeed, it can be verified that Ht has at most 2 non-zero entries in each row, in the case that Ut  =  C - SWAP, regardless of the size of the swapped registers. To prove our reduction, we show the following:

If x∈Lyes then there exists [formula], such that [formula].

If x∈Lno then for all [formula], [formula].

Completeness:

In a [formula] instance, the two Merlins can send identical states which are accepted with probability at least c (where c is the completeness parameter), which have the form [formula]. Since [formula], the first r steps of the verification protocol (see Thm. [\ref=thm:qma_k_equals_qma_2])) have no effect. Therefore,

[formula]

where C is the clock subsystem, A is the ancilla subsystem, and P1 and P2 are the first and second proof subsystems.

Using Theorem [\ref=thm:qma_k_equals_qma_2], we know that in a [formula] instance, the two Merlins can send identical states which are accepted with probability at least c. These states are of the form [formula]. The verifier then does the following: he first performs a swap test on each pair [formula] (characterized by the first r unitaries U1,dots,Ur). This does not change the state at all. He then applies the verifying procedure only on the first proof, and ancilla. Therefore,

[formula]

This shows that |η〉 is a tensor product state with respect to the spaces ([formula]) on one end and P2 on the other. Kitaev's proof (see [\cite=KSV02]) shows that

[formula]

and by substituting c, we get,

[formula]

Soundness:

We first outline the three steps of the proof qualitatively. We assume that there exists a low-energy state [formula], and we show that:

(i) If |ω〉 has low energy, then |ω〉 is close to a history state |η〉, i.e. a state of the form [formula] for some |ψ〉. We usually write such a history state |ηψ〉 to mark the dependence in |ψ〉.

(ii) If a history state |ηψ〉 is close to a product state (and by (i), it is), then, the associated state |ψ〉 is close to a tensor product state.

(iii) If |ψ〉 is close to a tensor product state, the originating history state |ηψ〉 must have high energy which will contradict (i).

If [formula], for some universal constant C, then, there exists a history state |η〉 s.t. |〈ω|η〉|2  ≥  1  -  α.

Let Vhist the subspace spanned by all history states. We can verify that Vhist is the kernel of Hinit  +  Hprop . We use the following Claim, which is proved in Appendix [\ref=app:spectral_gap].

[formula], for some universal constant C, where Δ(A) is the smallest non-zero eigenvalue of A.

We can write [formula], for |η〉∈Vhist, and [formula] . By assumption

[formula]

where the first inequality follows from the assumption of the lemma, the second uses the fact that [formula] and the last inequality uses Claim [\ref=cl:gap]. To conclude, p  ≤  α which implies that |〈ω|η〉|2  =  1  -  p  ≥  1  -  α, as needed.

Let |ηψ〉 a history state and |ψ〉 such that

[formula]

where we consider the following subsystems: C is the clock subsystem, A is the ancilla subsystem, and P1 and P2 are the first and second proof subsystems. If there exist two states [formula] and |ψ2〉∈P2 such that [formula] then there exists a state |L〉∈P1 such that [formula]

We write

[formula]

with [formula]. From this, we immediately have

[formula]

where used Cauchy Schwarz in both inequalities. Therefore,

[formula]

By using [formula], we can further bound

[formula]

Consider a history state |ηψ〉 with an associated state |ψ〉. In a [formula] instance with soundness parameter s, if [formula], then [formula].

To prove this Lemma, we will need the following Claim.

Let Π be a projector, and |v1〉,|v2〉 be arbitrary, and let qi  =  〈vi|Π|vi〉. If |〈v1|v2〉|2  ≥  1  -  δ, then, [formula].

To prove this claim, we use the trace distance between |〉 and |〉. The trace distance is denoted D(|〉,|〉) and is equal to [formula]. We know that from the characterization of the trace distance that can be found in [\cite=NC00], we have

[formula]

Moreover, we know by a Fuchs- van de Graaf inequality that [formula] ([\cite=FG99]). By putting everything together, we have

[formula]

We can now prove the Lemma.

For every state |ψ〉,

[formula]

By using Claim [\ref=cl:close_rejecting_probability], we get

[formula]

where in the last inequality, we used the fact that this is a [formula] instance, and therefore all tensor product states are rejected with probability at least 1 - s.

We can now combine the three steps, and prove the soundness property. Assume, by contradiction, that there exists a state [formula], with energy below the promise, i.e. [formula].

By Lemma [\ref=le:step_one], there exists a state |ηψ〉 such that

[formula]

Using Lemma [\ref=le:step_two], there exists [formula] such that [formula]. By Lemma [\ref=le:step_three],

[formula]

Our goal is to lower bound 〈ω|H|ω〉. We have, [formula], for some [formula] that satisfies [formula], where [formula] by Eq. [\eqref=eq:overlap_omega_psi], therefore

[formula]

We define [formula]. Since, [formula], clearly [formula]. Also, H = Hin + Hprop + Hout, and (Hin + Hprop)|ηψ〉  =  0, and [formula] which implies [formula]. Together, this gives

[formula]

We can lower bound the first term by using [formula] and [formula], and the second term by using [formula], hence

[formula]

This contradicts our assumption that [formula], and proves the soundness property.

To conclude, when [formula] and [formula], we showed that in a [formula] case, there exists a tensor product state with energy at most [formula], and in a [formula] case, all tensor product states have energy at least [formula], which completes the proof of Thm. [\ref=thm:ssh_qmatc].

In this Section, we show that the promise problem separable k-local hamiltonian is [formula]. Let [formula] an instance of separable k-local hamiltonian. We partition the workspace of qubits into disjoints sets A and B, each corresponding to n / 2 qubits. Let Ai  ⊂  A (resp. Bi  ⊂  B) the space of qubits in A (resp. B) on which Hi acts. Hi acts on k qubits represented by the space [formula]. We can have [formula] or [formula]. Let [formula] (where the summation is over the extension of the Hi's to the entire Hilbert space). The size of the instance is N  =  n  +  m  ·  2k. The term 2k follows from the need of O(2k) classical bits to describe a k-local Hamiltonian.

We use Definition [\ref=def:AlternativeDefinition1] to characterize separable k-local hamiltonian. We are in a [formula] instance if there exists [formula] such that [formula], with ρA∈A and ρB∈B. We are in a [formula] instance if for all [formula] with ρA∈A and ρB∈B, we have [formula]

Note that this problem is [formula] hard. Indeed, if we consider that all the Hamiltonians Hi act only on A, which means that for all i, [formula], we obtain an instance of the k-local Hamiltonian problem which is [formula] hence separable k-local hamiltonian is [formula]. It remains to be shown that separable k-local hamiltonian is in [formula].

To show this, we use the fact that another problem, consistency of local density matrices (see Definition [\ref=def:cldm]), is in [formula]. More precisely, we consider the consistency of local density matrices problem with [formula]. It was shown by Liu [\cite=liu_consistency_2006] that this problem is in [formula]. We now describe the [formula] procedure for separable k-local hamiltonian.

The prover sends a classical description of the state [formula] where [formula] and [formula]. This requires sending O(m  ·  2k)  =  O(N) classical bits.

The prover proves to the verifier that the reduced density matrices {ρAi}i∈[1,m] form a [formula] instance of the consistency of local density matrices problem. He also proves that the reduced density matrices {ρBi}i∈[1,m] form a [formula] instance of the consistency of local density matrices problem.

Once the verifier is convinced that the reduced density matrices are consistent, he calculates the value [formula] and accepts if E  ≤  a.

Proof that the protocol works

Completeness: Suppose we are in a [formula] instance. This means that there exists [formula] such that [formula]. The prover sends a classical description of the ρAi and ρBi where [formula] and [formula]. Clearly, these reduced density matrices are consistent with ρA and ρB so the consistency test will pass with probability greater than 2 / 3. Then, we have

[formula]

We conclude that the verifier will accept with probability at least [formula].

Soundness: Suppose we are in a [formula] instance. The prover sends classical descriptions of the states ρAi,ρBi. We distinguish two cases:

These reduced density matrices fail the consistency test. The verifier accepts with probability smaller than [formula].

These reduced density matrices pass the consistency test with probability at least [formula]. This means that there exist two quantum states σA,σB such that if we define [formula] and [formula], we have :

[formula]

Since we are in a [formula] instance, for every σA,σB we have

[formula]

For each i, we have [formula], where the first inequality follows from the subadditivity of the trace distance with respect to tensor products. We now use the following Claim

Let ρ,σ two quantum states with ||ρ  -  σ||1  =  δ. We have for any positive semidefinite matrix H  ≤  I,|tr(H(ρ))  -  tr(H(σ))|  ≤  δ / 2.

Since we do have Hi positive semi definite and Hi  ≤  I for each i, we have for all i

[formula]

Putting this all together, we have

[formula]

therefore, the verifier rejects.

Acknowledgments

We thank Fernando Brandão for his contribution to the soundness proof of Thm. [\ref=thm:ssh_qmatc].

Lower bounding the spectral gap

In this appendix we prove Claim [\ref=cl:gap]. The proof has a similar structure to the one in [\cite=KSV02]. We will first need a few definitions. Given a Hilbert space H and a subspace L, the subspace [formula] is the orthogonal complement of the subspace L (see e.g. [\cite=P91]). Given two subspaces L1,L2, the angle [formula] between the subspaces is:

[formula]

Given a Hamiltonian [formula], we define Δ(A) to be the smallest non-zero eigenvalue of A. We use the notation [formula] as a shorthand for [formula].

Let A1,A2 be positive-semidefinite operators, and L1,L2 their null subspaces respectively, where [formula]. Suppose further that Δ(A1)  ≥  v and Δ(A2)  ≥  v. Then,

[formula]

where θ is the angle between L1 and L2.

We will use a slightly different version.

Let A1,A2 be positive-semidefinite operators, and L1,L2 their null subspaces respectively, where [formula]. Suppose further that Δ(A1)  ≥  v and Δ(A2)  ≥  v. Then,

[formula]

where θ is the angle between [formula] and [formula].

The corollary follows from applying Lemma [\ref=le:kitaev_geometric_lemma], to A1 and A2 with the domain and codomain restricted to [formula].

We use Cor. [\ref=co:geometric_lemma] where we substitute [formula] and [formula], where

[formula]

In this case, the analysis in [\cite=KSV02] shows that [formula] , and we will show that

[formula]

which together gives the desired result.

It can be verified (see [\cite=KSV02] for a full analysis) that

[formula]

[formula]

where [formula], and the superscripts denote the subsystems (see Lemma [\ref=le:step_two]). Therefore,

[formula]

[formula]

Using these definitions we get:

[formula]

where [formula] is the projection onto the space L1. Any state [formula] can be written in the form [formula], where [formula], therefore we can further bound:

[formula]

where the equality follows from the observation that the first term is 0 (see the property of |β〉 mentioned above), and that [formula]. This gives Eq. [\ref=eq:cos_theta], and completes the proof.