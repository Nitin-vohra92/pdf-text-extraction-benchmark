cm cm

Implementation and Application of Kinematic Vertex Fitting in the Software Environment of ILD

Software elements

The Rave library

The Rave library [\cite=RaveHomepage] was created with the aim of avoiding repeated re-implementation of similar algorithms in every new reconstruction software, when specific modules can be formulated in an experiment-independent manner. This is certainly true for the modules doing the reconstruction of interaction vertices, e.g. of particle decays.

The core of the library is an implementation of algorithms for geometric vertex reconstruction which were developed for the CMS experiment at the Large Hadron Collider, augmented by an additional simple and stable interface. The same approach was taken for this work: the algorithms doing vertex reconstruction with kinematic constraints [\cite=Kirill] were extracted from the CMSSW framework and implemented in the library.

The MarlinRave plug-in

A plug-in has been developed for the ILD analysis framework Marlin [\cite=GaedeMarlin], enabling users to access the geometric and kinematic vertex reconstruction capabilities of RAVE. Its name is MarlinRave, and it provides two new processors to the framework - RaveVertexing and RaveKinematics - one of which or both to be selected by the user.

The RaveVertexing processor

Geometric vertex reconstruction (by linear or adaptive filter algorithms) is accessed from Marlin through the RaveVertexing processor. The configuration of this processor requires an input collection containing objects of type |EVENT::Track|. It takes a text string configuring the vertexing algorithm to be used together with its parameters, and the names of two output collections: one containing the fitted vertices, and the other containing the re-fitted ("smoothed") tracks at their vertex.

The RaveKinematics processor

Its algorithm is based on a linear filter with Lagrangian multipliers for the constraints. Because the configuration interface of Marlin does not allow for arbitrary nesting, the RaveKinematics processor is designed to contain a flexible number of pre-defined kinematic decay topologies, thus facilitating the inclusion of new topologies as needed by the user. From the Marlin configuration file only the topology is chosen, whilst a text string allows the passing of specific parameters.

Reconstruction of W+W- decays

RAVE's kinematic capabilities were tested with a data sample consisting of 1376 events e+e-  →  W+W-  →  4 jets at [formula] GeV, generated by Pythia [\cite=Pythia6] and processed for the LDC 2007 layout [\cite=MCRun]; the "true" W masses are plotted in Figure [\ref=fig:TrueMasses]. Events with a mass |mW  -  80.32|  >  6.5 GeV are eventually discarded, retaining 1008 events.

To model the expected performance of jet reconstruction in ILC experiments, the following Gaussian errors have been applied to all four generated jets:

[formula]

The direction resolution affects the θ (polar angle) and φ (azimuth) measurements.

A known general problem with the use of jets as virtual measurements is due to their compositeness: only direction and energy, but not an absolute momentum, are well-defined. However, an initialization of the jet's momentum with its energy, followed by an appropriate inflation of the associated error, gives satisfactory results.

The constraints applied are those of energy and 3-momentum conservation. They are explicitly written as (the subscripts identify the four jets):

[formula]

So far no distinction was made between the four jets: the applied kinematic constraints acted equally on all final states, and did not take into account which particles they could have originated from. Now one has the task of associating the four jets into two pairs (there are 3 possible combinations), with each pair originating from a W boson decay.

A trivial strategy is to assume that each combination is valid, and to calculate the two W masses accordingly. Figure [\ref=fig:AllAssociations] shows the results: each entry represents the W pair masses corresponding to one combination of one event.

A comparison of Figure [\ref=fig:AllAssociations] with [\ref=fig:TrueMasses] suggests that, as a first step, dropping combinations where both W masses exceed a pre-defined cut limit would significantly improve the performance of the association. This cut is chosen at a value of 130 GeV.

For a second step, several options are feasible. A simple "equal-mass hypothesis" introduces in the kinematic fit, as an additional constraint, the requirement of the two fitted masses to be equal (because they both belong to W bosons). However, such a requirement would strongly favour combinations along the 45o diagonal over those parallel to the axes, in contradiction to the true distribution of the W pair masses as shown in Figure [\ref=fig:TrueMasses].

The most obvious improvement of such a hypothesis would be to model a selection requirement from two uncorrelated Breit-Wigner (BW) distributions. But that is not possible in real-world scenarios, because the position parameter of the expected distribution is exactly the (unknown) value to be determined by this kinematic vertex fit. Therefore, a compromise is suggested between this idea and the "equal-mass hypothesis" above [\cite=MoserThesis]:

The two W masses are known to not being equal, however, they are still picked from the same distribution. The likelihood of such a configuration is given by

[formula]

Here, the first term holds the results of the kinematic vertex fit (parameters [formula] and covariances [formula]). The second term represents the new "similar-mass hypothesis"; it models the distribution of the two masses dependent on the position parameter [formula], and it can be split into two symmetric terms if the masses are approximately uncorrelated. Although any p.d.f. can be used within the second term, a Gaussian model is certainly the easiest choice. Then, the objective function for the new fit can be written as

[formula]

where σt  ≈  9 GeV is a pre-defined scale (obtained by integration over the BW).

The objective function M is minimized w.r.t. [formula] and [formula] and yields a pseudo-χ2, the probability of which is used as the new second step selection criterion for finding the best jet association (out of the 3 possible combinations).

This strategy, after application of the first step (130 GeV cut mentioned above), results in 979 events; the W pair masses are shown in Figure [\ref=fig:GaussLowCorrCut].

The association performance of this method is characterized by type 1 and 2 errors of 1.6 % and 0.9 %, respectively.

Figure [\ref=fig:WWReco] shows the reconstructed W masses after kinematic vertex fitting, including the similar-mass constraint.

A Gaussian fit over the histogram range [formula] GeV yields for mean and standard deviation: μ(mW)  =  79.58  ±  0.27 GeV and σ(mW)  =  11.4  ±  0.2 GeV.

Scaled to 664k events expected in 4 years at the ILC (500 fb- 1, 4-jet efficiency ≈  40%) [\cite=MoserThesis], an accuracy of 0.014 GeV in determining the W mass may be achieved.

Reconstruction of ZoZo decays

The other exemplary reconstruction was performed on a data sample of 994 Pythia events e+e-  →  ZoZo  →  4 jets at [formula] GeV, and processed for the LDCprime 2008 layout [\cite=MCRunZZ]. In contrast to the WW data of chapter 2, simulation included initial state radiation; at present, this cannot be accounted for in our kinematic reconstruction. Therefore, events with a total ZZ energy <  249 GeV are discarded, retaining 531 events.

The ZZ data had the momenta of the jets correctly calculated by PFA, so they were used in this study. Apart from that, exactly the same strategies and methods as in chapter 2 have been applied. A comparison (not shown) of the reconstructed Z masses with and without kinematic constraints, respectively, reflects significant improvement.