Matchings vs hitting sets among half-spaces in low dimensional euclidean spaces

Rom Pinchasi

Introduction

Let H = (V,E) be a a hyper-graph. A hitting set for H is a subset of vertices which intersects every edge in E. A matching in H is a subset of mutually disjoint edges. Let τ(H) denote the size of a minimum hitting set of H and let ν(H) denote the size of a maximum matching of H. The parameters τ(H),ν(H) were studied extensively in combinatorics and in computer science. τ(H) and ν(H) relate to each other. Indeed, every hitting set must contain a distinct element from each edge in any matching and therefore ν(H)  ≤  τ(H). Moreover, by strong duality for linear programming it follows that the size of a minimum fractional hitting set, denoted by τ*(H), is equal to the size of a maximum fractional matching, denoted by ν*(H). So every hyper-graph H satisfies:

[formula]

Hyper-graphs H for which τ(H) = ν(H) or for which τ(H) and ν(H) are close to each other have also been studied. See for example [\cite=AK92] [\cite=AK95] [\cite=AKMM02] and references within.

We study the gap between ν(H) and τ(H) for hyper-graphs H which can be realized by an arrangement of half-spaces in [formula] when d is small. This property is quantified by the affine sign-rank. The affine sign-rank of a hyper-graph H is the minimum number d for which there is an identification of V(H) as points in [formula] and of E(H) as half-spaces in [formula] such that for all v∈V(H),e∈E(H), v∈e if and only if the point corresponding to v is in the half-space corresponding to e. The affine sign-rank is closely related to the sign-rank of H which was studied in many contexts such as geometry [\cite=AMY14], machine learning [\cite=FSS01] [\cite=BES02] [\cite=FS06], communication complexity [\cite=PaturiS86] [\cite=Forster01] [\cite=FKLMSS01] [\cite=Sherstov10] and more.

Hyper-graphs with small affine sign-rank have small VC dimension (at most the affine sign-rank plus one) and therefore, by [\cite=BG95] [\cite=ERS05], for such hyper-graphs:

[formula]

How about ν(H)? Is it also close to ν*(H)? In general, low VC dimension does not imply that ν(H) is close to ν*(H). A simple example is given by H = (P,L) where P and L are the sets of points and lines in a projective plane of order n. Recall that in a projective plane of order n |P| = |L| = n2 + n + 1, each two lines intersect in a unique point, each two points have a unique line containing both of them, each line contain exactly n + 1 points and each point has exactly n + 1 lines containing it. Thus, its VC dimension is 2, ν(H) = 1 (since every two lines intersect) and [formula] as we may choose a [formula] fraction of every line so that every point is covered exactly once and the total weight of the fractional matching is [formula]. However, since the affine sign-rank of H is Ω(n1 / 2) [\cite=FKLMSS01] [\cite=AMY14] this example does not rule out the possibility that τ and ν are close for hyper-graphs of constant affine sign-rank.

We show that if the affine sign-rank of H is less than 4 then τ(H) = Θ(ν(H)). We complement this by showing that there are hyper-graphs H with affine sign-rank 4 such that ν(H) = 1 and τ(H) is arbitrarily large.

We note that the fact that τ(H) = Θ(ν(H)) when the affine sign-rank is 2 is already known [\cite=CH12]. For completeness we add our alternative proof for it and show how this proof is generalized to capture the case of affine sign-rank 3.

Our results

For a set P of points in [formula] and a family F of ranges in [formula] we denote by H(P,F) the hyper-graph on the set of vertices P whose edges consist of the sets [formula], without multiplicities. So, the affine sign-rank of H is d if and only if there is a set P of points in [formula] and a family F of half-spaces in [formula] such that H is isomorphic to H(P,F).

The case of affine sign-rank 2 and pseudo-discs

As mentioned above, we show that if H is a hyper-graph with affine sign-rank 2 then τ(H) = Θ(ν(H)). In fact, we prove it for a more general class of hyper-graphs: A family C of simple closed curves in [formula] is called a family of pseudo-circles if every two curves in C are either disjoint or cross at two points. A family of circles, no two of which touch, is a natural example for such a family. A family of pseudo-discs is a family of compact sets whose boundaries form a family of pseudo-circles. Natural examples for families of pseudo-discs are translates of a fixed convex set in the plane as well as homothetic copies of a fixed convex set in the plane.

Note that if the affine sign-rank of H is 2 then there is a set of points P in the plane and a family of pseudo-discs F such that H is isomorphic H(P,F) (just replace each half-space by a large enough circular disc).

Let P be a set of points in the plane and let F be a family of pseudo-discs. Let H be the hyper-graph H  =  H(P,F). Then for every integer k  ≥  1 either H has k pairwise disjoint edges, or one can find O(k) points in P that hit all the edges in H.

Theorem [\ref=theorem:p1] implies that every H with affine sign-rank 2 has τ(H) = Θ(ν(H)). Theorem [\ref=theorem:p1] was proved by Chan and Har-Peled in [\cite=CH12], however the proof that we present here is based on a different approach. Our methods are useful also in the case when the affine sign-rank is 3. The proof of Theorem [\ref=theorem:p1] is based on the following Theorem:

Let F be a family of pseudo-discs in the plane. Let P be a finite set of points in the plane and consider the hyper-graph H  =  H(P,F). There exists an edge e in H such that the maximum cardinality of a matching among the edges in H that intersect with e is at most 156.

Theorem [\ref=theorem:m-discs] implies Theorem [\ref=theorem:p1] as follows. Apply Theorem [\ref=theorem:m-discs] to find an edge e in H such that among those edges intersecting it there are at most 156 pairwise disjoint ones. Delete e and those edges intersecting it from H. Repeat this until the graph is empty. If this continues k steps, then we find k pairwise disjoint edges. Otherwise, we decompose H into less than k families, [formula], of edges such that in each family Hi there are at most 156 pairwise disjoint edges.

We then show that for every [formula] the edges in Hi can be pierced by O(1) points. This will conclude the proof of Theorem [\ref=theorem:p1]. In order to show that each Hi is indeed pierced by O(1) points, we rely on the techniques of Alon and Kleitman in [\cite=AK92] by proving a (p,q) Theorem for each of the Hi (see the proof of Theorem [\ref=theorem:p1]).

Theorem [\ref=theorem:m-discs] is a discrete version (and therefore also generalization) of Theorem 1 in [\cite=P14], in which the set P is the entire plane. The proof of Theorem [\ref=theorem:m-discs] follows the proof of Theorem 1 in [\cite=P14] with some suitable adjustments.

The result in Theorem [\ref=theorem:m-discs] (and also Theorem 1 in [\cite=P14]) can be interpreted as saying that in every family of pseudo-discs there is a so called "small" pseudo-disc. Indeed, notice that in every family of circular discs, the disc of smallest area, D, has the property that the maximum number of mutually disjoint discs from the family that intersect with it is at most O(1) (see the introduction in [\cite=P14] and the references therein for more details). Theorem [\ref=theorem:m-discs] implies that the same phenomenon happens in every family of pseudo-discs.

The authors of [\cite=CH12], in which Theorem [\ref=theorem:p1] was first proved, explicitly note that one of the challenges they overcome is the absence of a "smallest pseudo-disc". In this paper and in [\cite=P14] the existence of such pseudo-disc is proved. We prove Theorems [\ref=theorem:p1] and [\ref=theorem:m-discs] in Section [\ref=sec:proofs1].

The case of affine sign-rank 3

Let P be a set of points in [formula] and let F be a family of half-spaces. Let H be the hyper-graph H  =  H(P,F). Then for every integer k  ≥  1 either H has k pairwise disjoint edges, or one can find O(k) points in P that hit all the edges in H.

Like in the case of affine sign-rank 2, the proof of Theorem [\ref=theorem:p2] is based on the following theorem that is an analogue of Theorem [\ref=theorem:m-discs]:

Let P be a set of points in [formula] and let F be a family of half-spaces. Let H be the hyper-graph H  =  H(P,F). Then there exists an edge in H such that the cardinality of the maximum matching among the edges in H intersecting it is at most 156.

We prove Theorems [\ref=theorem:p2] and [\ref=theorem:m-spaces] in Section [\ref=sec:proofs2].

The case of affine sign-rank 4

We show that the analogous result to Theorems [\ref=theorem:p1] and [\ref=theorem:p2] fails for affine sign-rank greater than 3.

For every [formula] There exists a set P of [formula] points and a set F of n half-spaces in [formula] such that:

Every two edges in H(P,F) have a non-empty intersection (which implies that ν(H) = 1).

Any subset of P which pierce all edges in H(P,F) has at least [formula] points in it (i.e. [formula]).

We prove Theorem [\ref=theorem:gap] in Section [\ref=sec:proofs3]

Connection to ε-nets

Theorems [\ref=theorem:p1] and [\ref=theorem:p2] immediately imply a result from [\cite=MSW90] about the existence of an ε-net of size linear in [formula] for hyper-graphs H(P,F), where F is a family of pseudo-discs in [formula] (hence also the special case where F is a family of half-planes) or half-spaces in [formula]. Indeed, given such a hyper-graph H and ε > 0, we delete from H all the edges of cardinality smaller than ε|P|. Set [formula]. Notice that now H does not contain k pairwise disjoint edges simply because every edge is of cardinality greater than ε|P|. It follows that one can find [formula] points in P that meet all the edges in H.

Pach and Tardos [\cite=PachT13] have recently shown that for every ε > 0 and large enough n, there is a collection of n points, P, in [formula] and a collection of half spaces, F, such that every ε-net for H(P,F) has size [formula]. This corresponds to Theorem  [\ref=theorem:gap], and in fact implies some variant of it.

An algorithmic application

An immediate algorithmic application of Theorems [\ref=theorem:p1] and [\ref=theorem:p2] is a polynomial constant factor approximation algorithm for finding maximum matching in hyper-graphs of the form H(P,F) where F is a set of pseudo-discs (or half-planes) and [formula] or F is a set of half-spaces in [formula] and [formula]. Indeed, given such a hyper-graph H, we can repeatedly find a "small" edge e∈E(H) in the sense of Theorems [\ref=theorem:p1] and [\ref=theorem:p2], add it to the matching and then delete e and those edges intersecting it from H and continue until all the edges of H are consumed. The final maximal (with respect to set containment) matching M has size which is at least [formula] of the size of a maximum matching. We note that Chan and Har-Peled [\cite=CH12] give a PTAS for maximum matching among pseudo-discs, with a different constant, also for the weighted case.

The case of affine sign-rank 2 and pseudo-discs

In this section we prove Theorem [\ref=theorem:p1] and Theorem [\ref=theorem:m-discs].

We start with the proof of Theorem [\ref=theorem:m-discs] and then use this result to prove Theorem [\ref=theorem:p1].

An important special case of Theorem [\ref=theorem:m-discs] in which the set P is the set of all point in [formula] is shown in [\cite=P14]. The proof of Theorem [\ref=theorem:m-discs] will follow the same lines of the proof in [\cite=P14] with some suitable adjustments.

The idea of the proof is to show that if B is a maximum matching in H then on average over all edges e∈B the cardinality of a maximum matching among the edges in H that intersects with e is less than 157. This means that there exists an edge in B with the desired property.

We will make use of the following lemma that is in fact Corollary 1 in [\cite=P14]:

Let B be a family of pairwise disjoint sets in the plane and let F be a family of pseudo-discs. Let D be a member of F and suppose that D intersects exactly k members of B one of which is the set e∈B. Then for every [formula] there exists a set D'  ⊂  D such that D' intersects e and exactly [formula] other sets from B, and [formula] is again a family of pseudo-discs.

We will also need the next lemma that is parallel to (and will take the place of) Lemma 2 in [\cite=P14].

Let F be a family of pseudo-discs in the plane. Let P be a finite set of points in the plane and consider the hyper-graph H  =  H(P,F). Assume B is a subgraph of H consisting of pairwise disjoint hyper-edges. Consider the graph G whose vertices correspond to the edges in B and connect two vertices e,e'∈B by an edge if there is an edge in H that has a nonempty intersection with e and with e' and has an empty intersection with all other edges in B. Then G is planar.

Proof. We draw G as a topological graph in the plane as follows. From every edge e∈B we pick one vertex, that we denote by v(e), and the collection of all these vertices is the set V of vertices of G. Denote by H2 the set of all edges in H that have a non-empty intersection with precisely two of the edges in B. For every pair of edges e and e' in B that are intersected by some edge f (possibly such an edge f is not unique) in H2 we draw an edge between v(e) and v(e') as follows. Pick a vertex [formula] and a vertex [formula]. Recall that f is the intersection of P with some pseudo-disc D in F. Similarly, let C and C' be two pseudo-discs in F whose intersection with P is equal to e and e', respectively. Let Wxx' be an arc, connecting x and x', that lies entirely in D. Let Wv(e)x be an arc connecting v(e) to x that lies entirely in C. Let Wv(e')x' be an arc connecting v(e') to x' that lies entirely in C'. Finally, we draw the edge in G connecting v(e) and v(e') as the union (or concatenation) of Wv(e)x,Wxx', and Wx'v(e'). We will show that any two edges in G that do not share a common vertex are drawn so that they cross an even number of times. The Hanani-Tutte Theorem ([\cite=H34] [\cite=T70]) then implies the planarity of G.

We will use the following elementary lemma from [\cite=BPR13]:

Let D1 and D2 be two pseudo-discs in the plane. Let x and y be two points in [formula]. Let a and b be two points in [formula]. Let γxy be any Jordan arc connecting x and y that is fully contained in D1. Let γab be any Jordan arc connecting a and b that is fully contained in D2. Then γxy and γab cross an even number of times.

Let v(e),v(e') and v(k),v(k') be four distinct vertices of G. This means in particular that e,e',k, and k' are four pairwise disjoint hyper-edges in B. Suppose that v(e) and v(e') are connected by an edge in G. This means that there are x∈e and x'∈e' and f∈H2 such that [formula] and [formula]. Let E,E', and F in F be the pseudo-discs such that [formula], and [formula]. Suppose also that v(k) and v(k') are connected by an edge in G. This means that there are y∈k and y'∈k' and q∈H2 such that [formula] and [formula]. Let K,K', and Q in F be the pseudo-discs such that [formula], and [formula].

By Lemma [\ref=lemma:BPR13], Wv(e)x and Wv(g)y cross an even number of times. Indeed, E contains v(e) and x and does not contain v(k) and y. K contains v(k) and y and does not contain v(e) and x. Similarly, each of Wv(e)x,Wxx', and Wv(e')x' crosses each of Wv(k)y,Wyy', and Wv(k')y' an even number of times. We conclude that the edge in G connecting v(e) and v(e') crosses the edge in G connecting v(k) and v(k') an even number of times, as desired. width4pt depth1pt

Proof of Theorem [\ref=theorem:m-discs]. The proof goes almost verbatim as the proof of Theorem 1 in [\cite=P14]. Lemma 2 in [\cite=P14] is replaced by the above Lemma [\ref=lemma:planarity].

Let B be a collection of pairwise disjoint edges in H of maximum cardinality and let n = |B|. For every e∈B denote by α1(e) the size of a maximum matching among those edges in H that intersect with e but with no other edge in B. Denote by α2(e) the size of a maximum matching among those edges in H that intersect with e and with precisely one more edge in B. Denote by α3(e) the size of a maximum matching among those edges in H that intersect with e and with at least two more edges in B. Observe that it is enough to show that [formula].

We first note that for every e∈B we must have α1(e)  ≤  1. Indeed, otherwise one can find two disjoint edges e' and e'' in H that do not intersect with any edge in B but e. The set [formula] contradicts that maximality of B.

Next, we show that [formula]. Consider the graph G whose vertices correspond to the edges in B and connect two vertices e,e'∈B by an edge if there is an edge in H that has a nonempty intersection with e and with e' and has an empty intersection with all other edges in B. By Lemma [\ref=lemma:planarity], G is planar. Therefore, G has at most 3n edges. For every e∈B denote by d(e) the degree of e in G. Therefore,

[formula]

We claim that for every e in B we have α2(e)  ≤  2d(e). Indeed, otherwise by the pigeonhole principle one can find three pairwise disjoint edges g,g', and g'' in H and an edge e' in B such that each of g,g', and g'' intersects e and e' but no other edge in B. In this case [formula] contradicts the maximality of B.

Inequality ([\ref=eq:1]) implies now [formula]. It remains to show that [formula]. The derivation of this inequality is more involved than the derivation of the inequalities regarding α1,α2. We will show that if it is not the case that [formula], then we can derive an (impossible) embedding of K3,3 in the plane.

Denote by F3 the subfamily of F that consists of pseudo-discs in F that intersect with three or more edges in B. Using repeatedly Lemma [\ref=lemma:sn] with F  =  H3 and with [formula], we can find, for every D∈H3 and every e∈B that is intersected by D, a (new) pseudo-disc De  ⊂  D that intersects with e and with exactly two more sets from B. Moreover, the collection of all the new sets De obtained in this way is a family of pseudo-discs. We denote this family of pseudo-discs by D. Let T denote the set of all triples of edges in B that are intersected by a pseudo-disc in D.

We denote by Z the collection of all pairs of sets from B that appear together in some triple in T. We claim that |Z|  <  12n: Pick every set in B with probability [formula]. Call a pair {e,e'} in Z good if both e and e' were picked and an edge f∈B such that e,e', and f is a triple in T was not picked. The expected number of good pairs in Z is at least 1 / 8 of the pairs in Z. On the other hand, by Lemma [\ref=lemma:planarity] the set of good pairs in Z is the set of edges of a planar graph (on an expected number of n / 2 vertices) and therefore the expected number of good pairs is less than [formula].

Now consider the graph K whose set of vertices is the edges in B and whose set of edges is Z. For every e∈B denote by d(e) the degree of e in this graph. Notice that, in view of the above, [formula].

Fix e∈B. Define a graph Ke on the set of neighbors of e in K where we connect two neighbors e1,e2 of e in K by an edge in Ke if and only if {e,e1,e2} is a triple in T. This is equivalent to that there is D∈D that intersects with e,e1, and with e2. Denote by t(e) the number of edges in Ke. By ignoring the set e and applying Lemma [\ref=lemma:planarity], we see that Ke is planar. Ke has d(e) vertices and is planar and therefore t(e) < 3d(e).

We claim that for every e∈B we must have α3(e)  ≤  2t(e). Indeed, assume to the contrary that α3(e)  >  2t(e). Then there is a collection Q of at least 2t(e) + 1 pairwise disjoint edges of H, each of which has a non-empty intersection with e and with at least two more edges in B. Because of Lemma [\ref=lemma:sn], every edge in Q must have a non-empty intersection with e and with at least two edges e' and e'' that form a pair in Z. The hyper-edges e' and e'' are therefore connected by an edge in Ke. By the pigeonhole principle, because there are only t(e) edges in Ke while |Q|  ≥  2t(e) + 1, there exist e' and e'' that are connected by an edge in Ke such that e,e', and e'' are all intersected by three (pairwise disjoint) edges g1,g2,g3∈D. This is impossible as it gives an embedding of the graph K3,3 in the plane. To see this, recall that also the sets e,e1,e2 are pairwise disjoint. For every 1  ≤  i,j  ≤  3 add a small pseudo-disc surrounding one point in the intersection of ei and gj. Lemma [\ref=lemma:planarity] implies now an (impossible) embedding of K3,3 in the plane.

We conclude that

[formula]

The proof is now complete as we have

[formula]

This implies the existence of e∈B such that α1(e) + α2(e) + α3(e)  ≤  156. width4pt depth1pt

Having proved Theorem [\ref=theorem:m-discs], we are now ready to prove Theorem [\ref=theorem:p1].

Proof of Theorem [\ref=theorem:p1]. Repeatedly apply Theorem [\ref=theorem:m-discs] and find an edge e in H such that among those edges intersecting it there are at most 156 pairwise disjoint ones. Then delete e and those edges intersecting it from H and continue. If we can continue k steps, then we find k pairwise disjoint edges. Otherwise, we decompose H into less than k families, [formula], of edges such that in each family Hi there are at most 156 pairwise disjoint edges.

We will now show that for every [formula] the edges in Hi can be pierced by O(1) points. This will conclude the proof of Theorem [\ref=theorem:p1].

Our strategy is to show that the edges in Hi have the so called (p,q) property for some p and q. That is, out of every p sets in Hi there are q that have a non-empty intersection. In fact, by the definition of Hi, it has the (157,2) property because there are at most 156 sets in Hi that are pairwise disjoint. This is the first step. The next step is to show a (p,q) (for the same q above, that is q = 2) theorem for hyper-graphs H(P,F) where F is a family of pseudo-discs. This means that we will need to show that for a family of pseudo-discs F if H(P,F) has the (p,q) property, then one can find a constant number of points in P that together pierce all edges in H(P,F).

In order to complete the second step we will rely on the techniques of Alon and Kleitman in [\cite=AK92]. Rather than repeating their proof and adjusting it to our case, we observe, following Alon et. al in [\cite=AKMM02] and Matouek in [\cite=M04] that it is enough to show that the edges of H(P,F) have fractional Helly number 2 (see below) and have a finite VC-dimension, which implies the existence of an ε-net of size that depends only on ε. These two ingredients are enough to show that H(P,F) has a (p,2) theorem for every p > 2.

We recall that a hyper-graph H is said to have a fractional Helly number k if for every α > 0 there is β > 0 such that for any n and any collection of n sets in F in which there are at least [formula] k-tuples that have nonempty intersection one can find a point incident to at least βn of the sets. Here β may depend only on α (and the hyper-graph H) but not on n. In our setting the hyper-graph H is of the form H(P,F) where F is a set of pseudo discs and P is a set of points. We will see that every such H has fractional Helly number 2 and that the corresponding β does not depend on P nor on F (it will only depend on certain combinatorial properties that are possessed by every family of pseudo-discs).

We recall also the notion of union complexity of a family of sets. We denote by UF(m) the maximum complexity (that is, number of faces of all dimensions) of the boundary of the union of any m members of F. We will need the following well known result from [\cite=KLPS86] saying that for a family F of pseudo-discs we have UF(m)  ≤  12m

We will use the following theorem from [\cite=P15] (see Theorem 1 there) relating the notion of fractional Helly number with that of union complexity.

Let [formula] be a function such that lim x  →    ∞g(x) = 0. Suppose that F is a family of geometric objects in [formula] in general position, (that is, no point belongs to the intersection of more than d boundaries of sets in F) such that UF(m)  ≤  g(m)mk for every [formula]. Then for every set of points P the family FP has fractional Helly number at most k and this is in a way that depends only on the function g and not on F or P.

To be more precise, for every α > 0 there is a β > 0 such that for any family F satisfying the conditions in the theorem and a set of points P in [formula] the following is true: For any collection of n sets in H(F,P) in which there are at least [formula] k-tuples that have nonempty intersection one can find a point in P incident to at least βn of the sets.

Theorem [\ref=theorem:p] (with d = 2 and k = 2) and the linear bound on the union complexity of pseudo-discs [\cite=KLPS86] imply that H(P,F) has fractional Helly number at most 2. (Notice that we may assume without loss of generality that the sets in F are indeed in general position and therefore Theorem [\ref=theorem:p] applies here.)

It is well known and not hard to show (see for example Theorem 9 in [\cite=BPR13]) that for a family F of pseudo-discs and a set P of points the hyper-graph H(P,F) has a bounded VC-dimension (in fact at most 3). Therefore, each Hi has an ε-net of size that depends only on ε (see [\cite=HW87]). The method of Alon and Kleitman [\cite=AK92] implies that each H(P,F) satisfies a (p,2) theorem. That is, if any subset S of edges in H(P,F) satisfies the (p,2) property (from every p sets in S there are 2 sets that intersect), then there are c(p) (a constant that depends only on p) vertices that together pierce all the sets in S (see Theorem 4 and the discussion around it in [\cite=M04]).

By our assumption each, Hi has the (p,2)-property for p = 157. It follows that one can find a set of points of cardinality at most c(157)k that together intersect all the edges in H. width4pt depth1pt

The case of half-spaces in [formula].

In this section we prove Theorem [\ref=theorem:p2]. The proof follows the same trajectory as the proof of Theorem [\ref=theorem:p1] with analogous lemmata. Technically, the challenge in this case is to derive the analogous lemmata for half-spaces in [formula].

For the proof of Theorem [\ref=theorem:p2] we will need a corresponding three dimensional version of Lemma [\ref=lemma:planarity]:

Let F be a family of half-spaces in [formula]. Let P be a finite set of points in [formula] and consider the hyper-graph H  =  H(P,F). Assume B is a subgraph of H consisting of pairwise disjoint hyper-edges. Consider the graph G whose vertices correspond to the edges in B and connect two vertices e,e'∈B by an edge if there is an edge in H that has a nonempty intersection with e and with e' and has an empty intersection with all other edges in B. Then G is planar.

Proof. We notice that if the points of P are in (strictly) convex position, then Lemma [\ref=lemma:planarity3d] follows almost right away from Lemma [\ref=lemma:planarity]. To see this let S denote the convex hull of P and for every half-space F in F let FS denote the intersection of F with the boundary of S. Then the collection {FS|F∈F} is a family of pseudo-discs lying on the boundary of S. Now Lemma [\ref=lemma:planarity3d] follows from Lemma [\ref=lemma:planarity] that, although stated in the plane, applies also to the boundary of S (homeomorphic to the two dimensional sphere).

When the points of P are not in convex position such a simple reduction is not possible anymore. Nevertheless, we will be able to make use of Lemma [\ref=lemma:planarity] after some suitable modifications.

Denote by M the union of all edges in B. We say that a point of M is extreme if it lies on the boundary of the convex hull of M.

Let e1 and e2 be two edges in B. Suppose that there exists an edge f∈H such that f has a nonempty intersection with e1 and with e2 and f does not intersect any other edge in B. Then there exists a half-space F', not necessarily in F, such that both intersections of F' with e1 and with e2 contain extreme points of M and still F' does not intersect any other edge in B but e1 and e2.

Proof. We shall use the following basic fact several times: Any half-space that has a non-empty intersection with M contains an extreme point of it. Let F denote the half-space in F such that [formula]. F contains at least one extreme vertex of M. Because [formula] we conclude that there is an extreme vertex of M either in [formula], or in [formula] (if there is an extreme vertex of M in both, then we are done with F' = F). Without loss of generality assume that [formula] contains an extreme vertex of M. Let E1∈F be the half-space such that [formula]. E1 contains an extreme vertex of M that belongs to e1. Let [formula] denote the line of intersection of the boundaries of F and E1. Notice that [formula]. Take F' = F and start rotating F' about the line [formula] such that at each moment [formula]. At each moment of the rotation until F' coincides with E1, the half-space F' contains the intersection [formula] and therefore F' has a nonempty intersection with e1. We stop at the last moment where F' still contains an extreme vertex of M that belongs to e2. At this moment F' must also contain a vertex of e1 that is extreme in M. This is because at each moment F' must contain an extreme vertex of M. This completes the proof of the lemma. width4pt depth1pt

Going back to the proof of Lemma [\ref=lemma:planarity3d], let S denote the convex hull of M. For very edge e in B let F(e)∈F be the half-space in F such that [formula]. Denote by ẽ the set of extreme vertices of M in e. Notice that for every e∈B we have [formula] because every edge in B is the intersection of P with some half-space (in F). Let [formula] denote the set of extreme points in M. Because M is just the union of all edges in B, we have [formula]. Observe that {ẽ|e∈B} is the set of edges of the hyper-graph [formula]. For every pair of hyper edges e,e'∈B that are neighbors in the graph G (defined in the statement of Lemma [\ref=lemma:planarity3d]) let F(e,e')∈F denote some half-space in F that has a nonempty intersection only with the edges e and e' from B. By Lemma [\ref=lemma:h], there exists a half-space that, with a slight abuse of notation, we denote by [formula], not necessarily in F, such that [formula] has a non-empty intersection only with ẽ and with [formula] from the collection [formula].

Let

[formula]

We define now a graph G' whose set of vertices is B' = {ẽ|e∈B}. We connect ẽ and [formula] in B' by an edge in G' if there is an edge f in the hyper-graph [formula] such that f has a nonempty intersection with ẽ and with [formula] and f has an empty intersection with all other sets in B'. It follows from the discussion above that if e and e' are two sets in B that are connected by an edge in G, then ẽ and [formula] in B' are connected by an edge in G'.

Because [formula] is in convex position, the hyper-graph [formula] can be presented as a hyper-graph on the set of vertices [formula] whose set of edges correspond to pseudo-discs on S, where S is the boundary of the convex hull of M. We then apply Lemma [\ref=lemma:planarity] (where B is replaced by {ẽ|e∈B} and F is replaced by F') and conclude that G' is planar. The planarity of G follows because G is a subgraph of G'. width4pt depth1pt

We are now ready to prove Theorem [\ref=theorem:m-spaces]. The proof will follow the lines and will have a similar structure as of the proof of the corresponding theorem for pseudo-discs in the plane, namely Theorem [\ref=theorem:m-discs].

Proof of Theorem [\ref=theorem:m-spaces]. As in the proof of Theorem [\ref=theorem:m-discs], let B be a maximum (in cardinality) collection of pairwise disjoint edges in H and let n = |B|. For every e∈B denote by α1(e) the maximum cardinality of a matching among those edges in H that intersect with e but with no other edge in B. Denote by α2(e) the maximum cardinality of a matching among those edges in H that intersect with e and with precisely one more edge in B. Denote by α3(e) the maximum cardinality of a matching among those edges in H that intersect with e and with at least two more edges in in B. It is enough to show that [formula].

For every e∈B we must have α1(e)  ≤  1, or else we get a contradiction to the maximality of B (as in the proof of Theorem [\ref=theorem:m-discs]).

Next we show that [formula]. Consider the graph G whose vertices correspond to the edges in B and connect two vertices e,e'∈B by an edge if there is an edge in H that has a nonempty intersection with e and with e' and has an empty intersection with all other edges in B. By Lemma [\ref=lemma:planarity3d], G is planar. Therefore, G has at most 3n edges. For every e∈B denote by d(e) the degree of e in G. Therefore,

[formula]

We claim that for every e in B we have α2(e)  ≤  2d(e). Indeed, otherwise, by the pigeonhole principle, one can find three pairwise disjoint edges g,g', and g'' in H and an edge e' in B such that each of g,g', and g'' intersects e and e' but no other edge in B. In this case [formula] contradicts the maximality of B. Inequality ([\ref=eq:13d]) implies now [formula].

It remains to show that [formula]. Denote by F3 the subfamily of F that consists of half-spaces in F that intersect with three or more edges in B. Like in the proof of Theorem [\ref=theorem:m-discs] this part is more involved. Similarly, we will show that if it is not the case that [formula], then we derive an (impossible) embedding of K3,3 in an arrangement of hyper-planes in [formula] (see Claim [\ref=claim:aux]).

For every F∈F3 and every e∈B that is intersected by F, we find a (new) half-space Fe that intersects with e and with exactly two more edges in B. To do this, let v∈e be an extreme vertex of P and let h be a hyper-plane supporting the convex hull of P at v. Let [formula] denote the line of intersection of h and the boundary of F. Rotate F about the line [formula] until F intersects only three edges in B one of which must be e because at all times of rotation we have v∈F.

We denote the family of all new half-spaces obtained this way by D. Let T denote the set of all triples of edges in B that are intersected by half-spaces in D.

We denote by Z the collection of all pairs of sets from B that appear together in some triple in T. One can show that |Z|  <  12n: Pick every set in B with probability [formula]. Call a pair {e,e'} in Z good if both e and e' were picked and an edge f∈B such that e,e', and f is a triple in T was not picked. The expected number of good pairs in Z is at least 1 / 8 of the pairs in Z. On the other hand, by Lemma [\ref=lemma:planarity3d] the set of good pairs in Z is the set of edges of a planar graph (on an expected number of n / 2 vertices). (We refer the reader to the proof of Theorem [\ref=theorem:m-discs] to see this argument a bit more detailed.)

Now consider the graph K whose set of vertices is the edges in B and whose edges are those pairs in Z. For every e∈B denote by d(e) the degree of e in this graph. Notice that, in view of the above, [formula].

Fix e∈B. Define a graph Ke on the set of neighbors of e in K where we connect two neighbors e1,e2 of e in K by an edge in Ke if and only if {e,e1,e2} is a triple in T. This is equivalent to that there is D∈D that intersects with e,e1, and with e2. Denote by t(e) the number of edges in Ke. By ignoring the set e and applying Lemma [\ref=lemma:planarity3d], we see that Ke is planar. Ke has d(e) vertices and is planar and therefore t(e) < 3d(e).

We claim that for every e∈B we must have α3(e)  ≤  2t(e).

Indeed, assume to the contrary that α3(e)  >  2t(e). Then there is a collection Q of at least 2t(e) + 1 pairwise disjoint edges of H, each of which has a non-empty intersection with e and with at least two more edges in B. Every edge in Q has a non-empty intersection with e and with at least two edges e' and e'' that form a pair in Z. The hyper-edges e' and e'' are therefore connected by an edge in Ke. By the pigeonhole principle, because there are only t(e) edges in Ke while |Q|  ≥  2t(e) + 1, there exist e' and e'' that are connected by an edge in Ke such that e,e', and e'' are all intersected by three (pairwise disjoint) edges g1,g2,g3∈Q  ⊂  H. We claim that this situation is impossible. This follows directly from the following claim

It is impossible to find three half-spaces u1,u2,u3 in [formula] and another three half-spaces w1,w2,w3 such that there are nine points qij for 1  ≤  i,j  ≤  3 satisfying qij lies only in ui and wj from the half-spaces u1,u2,u3,w1,w2,w3.

Proof. Considering the dual problem, it is enough to show that one cannot find three points u1,u2,u3 in [formula] and another three points [formula] such that there for every 1  ≤  i,j  ≤  3 there is a half-space containing only ui and wj from the points u1,u2,u3,w1,w2,w3.

Without loss of generality we assume that all the points are in general position. We may also assume that one of the triangles Δu1u2u3 or Δw1w2w3 is not a face of the convex hull of {u1,u2,u3,w1,w2,w3}. Otherwise, the points u1,u2,u3,w1,w2,w3 are in convex position and each of the segments

[formula]

α(e) < 2t(e) ≤ 6d(e) ≤ 6 · 24n=144n.

[formula]

α(e)+α(e)+α(e) < n+12n+144n=157n,

[formula]

The case of half-spaces in [formula] where d  ≥  4

In this section we prove Theorem [\ref=theorem:gap].

For every [formula] we need to construct a set P of [formula] points and a set F of n half-spaces in [formula] such that:

Every two edges in H(P,F) have a non-empty intersection

Any subset of P which pierce all edges in H(P,F) must consist of at least [formula] points.

The next lemma will be our main tool in constructing H(P,F). This lemma is a slight variation of an argument which was used by [\cite=AFR85] to upper bound the sign-rank of a hyper-graph.

Let H be a hypergraph such that every v∈V(H) belongs to at most d hyper-edges. Then H can be realized by points and half-spaces in [formula]. That is, H is isomorphic to H(P,F) for some set P of points in [formula] and a family F of half spaces in [formula].

Pick some enumeration of E(H), [formula] where m = |E(H)|. For every v∈V pick some real univariate polynomial Pv(x) such that

Pv(0) =  - 1,

Pv(i)  >  0 if v∈ei and Pv(i) < 0 if v∉ei, and

deg (Pv)  ≤  2d.

It is not hard to see that such a polynomial always exists: For example, the polynomial

[formula]

satisfies the above requirements. For every v∈V let [formula] denote the coefficients of Pv(x). Notice that pv,0 =  - 1 for all v.

Every v∈V will correspond to the point [formula] and every ei correspond to the half-space Hi  =  {x:〈x,ni〉  ≥  1}, where [formula]. Observe that 〈xv,ni〉  =  Pv(i) + 1 and therefore v∈ei if and only if xv∈Hi as required.

We now construct an hyper-graph H with [formula] vertices such that every vertex belongs to precisely two edges, every two edges have a non-empty intersection (that is, any matching in H is of size at most 1), and finally, any set of vertices that pierces all edges must consist of at least [formula] vertices. Once we introduce such a hyper-graph, it follows from Lemma [\ref=lemma:2d] that it can be realized in [formula] by points and half-spaces.

We take the vertices of H to be the edges of a complete simple graph on n vertices Kn. Let us denote the vertices of Kn by [formula]. Then H has [formula] vertices. The hyper-graph H will consist of n edges [formula] defined as follows. For every 1  ≤  i  ≤  n the edge ei is the collection of all edges in Kn incident to xi.

It is easy to check that indeed every two sets in H(P,F) have a non-empty intersection and that any set of vertices of H that pierces all the edges of H must have size of at least [formula], as desired. width4pt depth1pt