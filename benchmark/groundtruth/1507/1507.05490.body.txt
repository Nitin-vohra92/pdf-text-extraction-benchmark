PropositionLemmaCorollary Remarks Notes

Asymptotic results for the number of Wagner's solutions to a generalised birthday problem

Introduction

Let (N,M,L) be three natural numbers larger than or equal to 2. Assume that we have a random matrix

[formula]

with independent elements aij which are uniformly distributed on [formula]. Let [formula] be the set of matrix positions, so that [formula]. For each [formula], define [formula] as the number of vectors [formula] with

[formula]

where the sign [formula] means equality modulo M. Clearly, [formula], so that by the assumption of uniform distribution,

[formula]

The problem of finding all V0 zero-sum vectors

[formula]

for a given matrix [formula], can be viewed as a generalised birthday problem. It arises naturally in a variety of situations including cryptography, see [\cite=Wagner2002] and reference therein; ring linear codes [\cite=Gr]; abstract algebra, where in the theory of modules it is related to the notion of annihilator, see e.g. [\cite=L2002]. This problem can be solved only by exhaustive search and is NP-hard [\cite=SSh]. Wagner [\cite=Wagner2002] proposed a subexponential algorithm giving hope to quickly detect at least some of the solutions to this kind of problems.

Assume that N  =  2n, n  ≥  1 and M  =  2m  +  1, m  ≥  n. It will be convenient to use the symmetric form

[formula]

of [formula] as the set of possible values for aij. Wagner's algorithm has a binary tree structure, see Figure [\ref=waga], starting from N leaves at level n and moving toward the top of the tree at level 0. For a given a vector [formula] with xj∈Dm the algorithm searches for the value

[formula]

obtained recursively in a way explained next (the special state Δ indicates that the algorithm is terminated and a solution is not found). Put [formula]. For [formula] and [formula], let x(h)j = b if there exists such a b∈Dm - h that

[formula]

and put x(h)j  =  Δ otherwise. In particular, if x(h - 1)k  =  Δ for at least one of the two indices k∈{2j - 1,2j}, then x(h)j  =  Δ.

A vector [formula] will be called a Wagner's solution to the generalised birthday problem, if [formula]. The total number [formula] of Wagner's solutions among the vectors [\eqref=ai] has mean

[formula]

where

[formula]

The proportion of Wagner's solutions can be characterised by the ratio of the means

[formula]

Clearly, Rn,m is the conditional probability of a given zero-sum random vector to be Wagner's solution.

There is a growing number of papers studying the properties of various tree based algorithms with some of them, in particular [\cite=MiSi], suggesting further developments of Wagner's approach. The main results of this paper are stated in the next section. Theorem [\ref=pnm] gives an integral recursion for calculating the limit for the key ratio [\eqref=rm]. Theorem [\ref=TH] suggests Chen-Stein bounds for the total variation distance between Poisson distribution and distributions of V0 and W. (Among related results concerning speed of convergence for functional of random matrices over finite algebraical structures we can only name a recent paper [\cite=FG2015].)

Main results

Define a sequence of polynomials [formula] by

[formula]

with [formula].

For any fixed natural number n,

[formula]

where the limit is obtained from the integral recursion [\eqref=recp].

To illustrate Theorem [\ref=pnm], take N = 16, L = 1000, and M = 1045. Then the expected number of zero-sum vectors is μ = 1000. In practice, finding all zero-sum vectors out of LN = 1048 candidates is a time consuming task. In this example we have n = 4 and m is approximately 150. Judging from Figure [\ref=latomu] illustrating the typical values for the proportion factor Rn,m using numerical computations based on the recursions for [\eqref=Rnm] presented in the next section, out of a thousand solutions the Wagner algorithm will catch no more than one.

For a random matrix [\eqref=mA] consider the number V0 of vectors [\eqref=ai] such that [formula]. Then where μ = LNM- 1. Furthermore, if N  =  2n and M = 2m + 1, m  >  n, then with λ = LNpn,m

According to Theorem [\ref=TH], Poisson approximation for V0 works well when LN  ≪  M. For W, a sufficient condition for the Chen-Stein bound to be small is NLN - 1  ≪  M.

Key recursion

Consider a backward recursion

[formula]

involving a system of vectors [formula] for [formula]. In particular, we have

[formula]

For 1  ≤  i  ≤  m - 1, denote by v(m)i(j) the unique solution of [\eqref=recu] determined by the following frontier condition By the forthcoming Corollary [\ref=cor], we can write pn,m = v(m)m - n(0) so that

[formula]

Let 1  ≤  n  ≤  m - 1 and [formula] be defined by [\eqref=hn]. Assuming that [formula] is a random vector with independent component uniformly distributed over Dm, put

[formula]

Then and for 2  ≤  i  ≤  m - 1 and 0  ≤  j  ≤  2m  -  i  -  1, we have pi,m( - j)  =  pi,m(j) with pi,m(j) satisfying the recursion

[formula]

There are exactly M = 2m + 1 different ordered pairs of numbers from the set Dm that add modulo M up to a given j∈Dm - 1. These pairs have the form: for j = 0,

[formula]

for [formula],

[formula]

and for [formula],

[formula]

Since these pairs appear with equal probability M- 2, the first claim follows.

On the other hand, for a given j∈Dm - i with [formula], there are only M - |j| different ordered pairs of numbers from the set Dm - i + 1 that add modulo M up to j. These pairs have the form:

[formula]

This yields for [formula],

[formula]

The stated symmetry property pi,m( - j)  =  pi,m(j) now follows recursively from the assumption of uniform distribution. To finish the proof of the lemma, it remains to observe that after replacing k - 2m  -  i by l in the last relation for pi,m(j) we get

[formula]

which in turn equals to

[formula]

Comparison of the key recursion in Lemma [\ref=thm:pi] with the recursion [\eqref=recu] yields

[formula]

Proof of Theorem [\ref=pnm]

Recall [\eqref=Rnm] and put

[formula]

We prove Theorem [\ref=pnm] by verifying a more general convergence result

[formula]

To this end we use induction over n. The base case n = 1 is trivial. To prove the inductive step observe first that by [\eqref=recu]

[formula]

It is easy to see recursively that the constant

[formula]

is finite.

On the other hand, by [\eqref=recp],

[formula]

so that

[formula]

with accordingly defined remainder term εn,m(j). Uniform continuity of φn(x) yields uniform convergence [formula] as m  →    ∞  , and [\eqref=unif] follows from [\eqref=ru] and [\eqref=rup], since

[formula]

Proof of Theorem [\ref=TH]

The following result is a straightforward corollary of Theorem 1 from [\cite=Arratia1989] and is a key tool for our proof here.

Let [formula] be a sum of possibly dependent indicator random variables with [formula]. Suppose there is a family of subsets [formula] such that for any [formula] and [formula], indicators [formula] and [formula] are independent. Then

[formula]

We start the proof of Theorem [\ref=TH] by observing that [formula], where the indicator random variables

[formula]

are identically distributed with [formula], and mutually independent. Independence is due to the defining property of the matrix [formula]. Indeed, if [formula] and (without loss of generality) [formula] are the coordinates where these two vectors differ, then

[formula]

Therefore, we can apply Lemma [\ref=CS] with [formula], and the Chen-Stein bound for V0 follows from [formula] and

[formula]

To obtain the Chen-Stein bound for W, we define [formula] as the set of [formula] such that vectors [formula] and [formula] share at least one component. Observe that

[formula]

By definition of W,

[formula]

so that [formula] and therefore, Since a Wagner's solution is necessarily is a zero-sum vector, we have for [formula],

[formula]

Let [formula] are the coordinates where the vectors [formula] differ. Then it follows that

[formula]

and we get The proof is finished by applying once again Lemma [\ref=CS].

Acknowledgements. The first author is grateful to Vladimir Vatutin and Andrey Zubkov for formulating an initial problem setting that eventually lead to this research project.