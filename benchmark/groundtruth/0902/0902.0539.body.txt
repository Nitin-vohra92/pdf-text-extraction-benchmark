Convergence of multi-class systems of fixed possibly infinite sizes

Introduction

Kallenberg [\cite=Kallenberg], Kingman [\cite=Kingman], Diaconis and Freedman [\cite=Diaconis], and Aldous [\cite=Aldous] are among many studies of exchangeable random variables (r.v.) with Polish state spaces, a fundamental topic in many fields of probability and statistics. Nevertheless, many models in stratified sampling, statistical mechanics, chemistry, communication networks, biology, etc., actually involve varied classes of similar objects, which we call "particles". Some examples can be found in Graham [\cite=Graham:92] [\cite=Graham:00] and Graham and Robert [\cite=GrahamRobert].

Several classical results for exchangeable systems are extended to such multi-class particle systems in Graham [\cite=Graham:08], under a natural partial exchangeability assumption called multi-exchangeability. It is notably proved that the convergence in law of a family of finite systems, with limit a system with infinite class sizes, is equivalent to the convergence in law of the corresponding family of vectors of the empirical measures within each class, with limit the vector of the directing measures of each limit class (which is exchangeable, and the directing measure is given by the de Finetti theorem). This result allows use of compactness-uniqueness techniques on the measure vectors for convergence proofs, extending those for propagation of chaos proofs for exchangeable systems introduced by Sznitman [\cite=Sznitman] and developed among others by Méléard [\cite=Meleard:96] and Graham [\cite=Graham:92] [\cite=Graham:00]. We refer to [\cite=Graham:08] for further motivation.

In the present paper, we extend this convergence result to multi-exchangeable systems with fixed class sizes, which may be both finite and infinite, by showing that their convergence in law is equivalent to the convergence in law for the vectors of measures with components the empirical measures for finite classes and the directing measure for infinite classes (given by the de Finetti Theorem). We first extend another result of [\cite=Graham:08], and prove that the conditional law of a multi-echangeable system, given the vector of measures defined above, corresponds to sampling independently without replacement from each finite class and i.i.d. from the directing measure for each infinite class, the remarkable fact being independence between different classes.

These new results are related to, and combine well with, those of [\cite=Graham:08]. For instance, results in [\cite=Graham:08] can yield a tractable large size limit for a finite model of interest, one hopes that the long-time behavior of the finite model is well approximated by that of the limit, and the new results can help us study all the long-time behaviors and their relationship. They can be likewise used for e.g. fluid limits or diffusion approximations.

All state spaces S are Polish, and the weak topology is used for the space of probability measures P(S) which is then also Polish, as are products of Polish spaces. For [formula] we denote by Σ(k) the set of permutations of [formula], and by Σ(  ∞  ) the set of permutations of [formula] with finite support.

Some combinatorial facts

Let 1  ≤  k  ≤  N and [formula]. Sampling k times without replacement among N possibly not distinct points [formula] corresponds to sampling from the law

[formula]

which is a continuous function (for the weak and the total variation topologies) of

[formula]

More precisely, [formula] can be written as a sum of continuous linear functions of [formula] for 1  ≤  j  ≤  k by an exclusion-inclusion formula. Sampling k times with replacement corresponds to using the law [formula].

The statements about the laws used for sampling without and with replacement are obvious. Sampling from [formula] corresponds to sampling k times without replacement from the atoms of [formula] counted with their multiplicities, and this fact clearly implies the continuity statement. More precisely,

[formula]

where the term of index j in the sum is a continuous linear function of [formula], and since j  ≤  k - 1 we conclude by recurrence over [formula].

The following result quantifies the difference between sampling with and without replacement in variation norm ||μ||  =   sup {  〈φ,μ〉:||φ||∞  ≤  1  }. See also [\cite=Aldous] and [\cite=Diaconis].

With the notations of Theorem [\ref=combfact], we have

[formula]

and the first inequality is an equality if and only if the x1,  , xN are distinct.

Equation [\eqref=deckj] yields the first inequality for the variation norm, and the condition for it to be an equality. The second inequality follows by bounding Nk  -  (N)k by counting k(k - 1) / 2 possible positions for two identical indices with N choices and Nk - 2 choices for the other k - 2 positions.

Multi-exchangeable systems

Reminders on exchangeable systems

Let [formula] be fixed. A finite system (Xn)1  ≤  n  ≤  N of random variables (r.v.) with state space S is exchangeable if

[formula]

The empirical measure of the system is the random probability measure

[formula]

with samples in P(S). The conditional law of such an exchangeable system given its empirical meausure ΛN is [formula], see Theorem [\ref=combfact] for the definition of λN,N and e.g. Aldous [\cite=Aldous] for the result.

An infinite system (Xn)n  ≥  1 is exchangeable if every finite subsystem (Xn)1  ≤  n  ≤  N is exchangeable. The de Finetti Theorem, see e.g. [\cite=Kallenberg] [\cite=Kingman] [\cite=Diaconis] [\cite=Aldous], states that such a system is a mixture of i.i.d. sequences, and precisely that its law is of the form

[formula]

where LΛ∞ is the law of the random probability measure

[formula]

called the directing measure of the system. The conditional law of such a system given Λ∞ corresponds to i.i.d. draws from Λ∞.

Multi-class systems

In order to consider finite and infinite systems simultaneously, we will take class sizes in [formula], and be redundant for clarity. Let C  ≥  1 and [formula] and state spaces Si be fixed for 1  ≤  i  ≤  C, and consider a multi-class system

[formula]

where the r.v. Xn,i is the n-th particle, or object, of class i, and 1  ≤  n  ≤    ∞   is interpreted as [formula]. We say that [\eqref=eq:mcys] is a multi-exchangeable system if its law is invariant under finite permutations of the particles within classes, and precisely if

[formula]

This natural assumption means that particles of a class are statistically indistinguishable, and obviously implies that (Xn,i)1  ≤  n  ≤  Ni is exchangeable for all i. It is sufficient to check that it is true when all σi but one are the identity.

For a multi-exchangeable system, a fundamental quantity is the random vector of probability measures, with samples in [formula], given by

[formula]

The following extends the results in Section [\ref=ss:rem], as well as Graham [\cite=Graham:08] and Aldous [\cite=Aldous] in which respectively Ni  <    ∞   and Ni  =    ∞   for all i. The remarkable fact is conditional independence between different classes.

The conditional law of a multi-exchangeable system [\eqref=eq:mcys] given the random measure vector (ΛNii)1  ≤  i  ≤  C in [\eqref=eq:emmeve] corresponds to drawing independently for each class i, if Ni  <    ∞   from [formula] given in Theorem [\ref=combfact], i.e, without replacement from the atoms of the empirical measure [formula] counted with their multiplicities, if Ni  =    ∞   in i.i.d. fashion from the directing measure Λ∞i.

Let 1  ≤  k  ≤  M <   ∞   be arbitrary and, for 1  ≤  i  ≤  C,

[formula]

Since ΛNii does not change if one applies a permutation to (Xn,i)1  ≤  n  ≤  Mi, see [\eqref=eq:emmeve], multi-exchangeability implies that for all [formula] and [formula], with the notation in Theorem [\ref=combfact],

[formula]

Considering [\eqref=kimi], if Ni  <    ∞   then [formula], and if Ni  =    ∞   then we let M go to infinity and use Theorem [\ref=combfactvar], [\eqref=dirmeas], continuity, boundedness, and dominated convergence, and we obtain

[formula]

and we conclude using that [formula] and g,fi∈Cb are arbitrary, the spaces are Polish, [formula] depends measurably on [formula] (see Theorem [\ref=combfact]), and the characteristic property of conditional expectation.

Thus, the classes of a multi-exchangeable system are conditionally independent given (ΛNii)1  ≤  i  ≤  C, with conditional laws as for an exchangeable system and depending on whether the class is finite or infinite. Given (ΛNii)1  ≤  i  ≤  C no further information can be attained on the law of the multi-exchangeable system by further observation, in particular involving r.v. in different classes. A statistical interpretation is that the empirical measure vector is a sufficient statistic for the law of the system, the family of all such laws being trivially parametrized by the laws themselves.

We now extend the convergence results for exchangeable systems in Kallenberg [\cite=Kallenberg], see also Aldous [\cite=Aldous] when N1  <    ∞  , to a family of multi-exchangeable systems, of fixed possibly both finite and infinite class sizes.

Let C  ≥  1 and [formula] and state spaces Si be fixed for 1  ≤  i  ≤  C. For [formula] let

[formula]

be multi-exchangeable systems as in [\eqref=eq:mcys], and (ΛNi,ri)1  ≤  i  ≤  C be as in [\eqref=eq:emmeve]. Then

[formula]

if and only if

[formula]

With the notation [\eqref=kimi], let [formula] and [formula] for 1  ≤  i  ≤  C be arbitrary. Taking g = 1 in [\eqref=intfor], or conditioning first on (ΛNi,ri)1  ≤  i  ≤  C and using Theorem [\ref=suffstat], yields

[formula]

and hence if  lim r  →    ∞(ΛNi,ri)1  ≤  i  ≤  C  =  (ΛNi,  ∞i)1  ≤  i  ≤  C in law then

[formula]

using the continuity result in Theorem [\ref=combfact], which proves the "if" part of the theorem since [formula] and fi are arbitrary and the state spaces are Polish. The converse follows similarly from [\eqref=condlam] with functions fi depending only on the first variable.