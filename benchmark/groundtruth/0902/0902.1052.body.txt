Identifying essential genes in E. coli from a metabolic optimization principle

, Andrea De Martino

, Enzo Marinari

, Matteo Marsili

, Isaac Pérez Castillo

ellular metabolism involves a complex network of interactions and cross-regulations between metabolites, proteins and genes. While our knowledge of regulatory functions at the genetic level and at the level of protein-protein interactions is still in its infancy, the biochemical network of reactions that describes metabolism has been characterized in detail for many organisms [\cite=Pals1] [\cite=Pals2] [\cite=Pals3]. Most information about the metabolic network is contained in the matrices [formula] and [formula] describing, respectively, the input and output stoichiometric coefficients of each metabolite μ (ranging from 1 to P) for all the metabolic reactions i (1 to N). Their knowledge allows for the definition of constraint-based models from which a prediction of metabolic fluxes is possible [\cite=Pals4] [\cite=Kau] [\cite=Segre]. These models typically rely on a steady-state assumption that reflects the timescale separation between the (faster) equilibration of metabolic processes and the (slower) dynamics of genetic regulation. Under this condition, the concentration Xμ of metabolite μ and the flux νi  ≥  0 of reaction i are constant in time and globally linked by a set of mass-balance conditions:

[formula]

or, in matrix notation, [formula], where [formula] is a flux vector. The problem is that of finding a flux vector satisfying the set of P linear equations ([\ref=fba]). For real metabolic networks, the above system is usually under-determined as N > P (e.g. E. Coli has around 1100 reactions and less than 800 metabolites [\cite=Pals1]), so that multiple solutions exist and one has to specify which of these are the working, physical states of the network.

In organisms with high functional specificity or whose main objective is to produce certain specified metabolites, like e.g. red blood cells, physical states are taken to be all those consistent with the mass-balance conditions. In such cases, it is important to be able to explore the solution space of ([\ref=fba]) uniformly. Uniform sampling can be achieved in small networks with Monte Carlo methods [\cite=wiback] and, more recently, message-passing algorithms have been employed [\cite=bz] [\cite=pag]. However computational considerations still prevent the application of such techniques to explore more general aspects of larger metabolic networks.

For more complex organisms, one normally complements ([\ref=fba]) with the assumption that the physical state of the network obeys a specific optimization principle. In flux-balance analysis (FBA, [\cite=Kau]) the choice usually falls on the maximization of biomass production, a useful proxy of the growth capabilities of an organism. FBA has been widely applied to different organisms (mostly bacteria) to investigate general aspects of metabolism, like flux distributions in different environments [\cite=Bara1], evolutionary dispensability of enzymes [\cite=Pal], or the plasticity of the reaction network [\cite=Almaas]. Minimization of metabolic adjustment (MOMA, [\cite=Segre]) is instead able to predict the re-organization of fluxes after a reaction knockout by minimizing the distance between the FBA solution and that obtained from ([\ref=fba]) after the knockout.

Here we consider a constraint-based model of metabolic activity with the aim of characterizing flux states corresponding to optimal net metabolic production. We neither assume constancy-in-time of fluxes, nor do we impose mass-balance constraints on metabolites. Rather, we allow for these to be recovered as properties of the solutions. This assumption turns out to be able to reproduce the empirical statistics of fluxes for the bacterium E. coli in different environments with a remarkable accuracy, and the physical and biochemical origin of the robustness of the emerging picture can be completely understood. Further biological insight can be gained by comparing the variability of individual fluxes with data on phenomenological gene essentiality.

Model definitions

The abstract setup we consider was originally introduced by J. Von Neumann to model growth in production economies as an autocatalytic process [\cite=VN]. We consider a system of N chemical reactions between P reagents, with fluxes and concentrations evolving in discrete time [formula] (we leave the timescale unspecified). For now, the system is assumed to be purely autocatalytic, so that the total input of any given metabolite at a certain time step must come from (all of or part of) the output at the previous time step. Let Si(t) denote the scale at which reaction i operates at time t, so that the total input and output of metabolite μ are given by [formula] and [formula], respectively. Stability requires that Cμ(t): = Oμ(t) - Iμ(t + 1)  ≥  0 at all times, otherwise the system would need an outside metabolic source to survive. We focus our attention on the feasibility of dynamical paths with constant growth rate ρ > 0, where Iμ(t + 1) = ρ  Iμ(t). It is easy to see that, in such paths, reaction rates must behave as Si(t) = siρt, with constants si  ≥  0 satisfying the P linear constraints

[formula]

The main assumption now is that the network's physical state [formula] corresponds to one of those for which the growth rate ρ attains its maximum possible value [formula] compatible with the constraints ([\ref=vn]). The rationale for this choice lies in the fact that, under general conditions, it can be proven that paths with the optimal use of resources coincide, apart from an initial transient, with those of maximal expansion [\cite=MacK]. Note that the si's are essentially the discrete-time version of the continuous time fluxes νi of Eq. ([\ref=fba]).

It is intuitive that the solution space of ([\ref=vn]) shrinks as ρ is increased starting from ρ = 0, where any flux configuration is a viable state. Quite importantly, then, for a fixed set of input-output relations, the solutions of ([\ref=vn]) are bound to coincide with those of ([\ref=fba]) if [formula] and [formula].

The typical behaviour of Von Neumann's model can be fully appreciated analytically in the case of random graphs. Depending on their size and topology, autocatalytic networks with random stoichiometry give rise to very different optimal states. As in other constrained optimization problems [\cite=SAT], the key control parameter is the ratio N / P = n of variables-to-constraints. In random topologies [\cite=VNfc] [\cite=VNd] as n increases the system crosses over from a contracting phase with [formula] to an expanding one with [formula], passing through a stationary regime with [formula] in which reaction fluxes are constant in time as in FBA (though the values at which fluxes settle may be different).

Application to E. coli

A natural reaction network can be modeled as an autocatalytic system when the uptake reactions that provide resources and account for exchanges of metabolites with the surrounding environment are included. We have applied the Von Neumann scheme to the cellular metabolism of the bacterium E. coli, as reconstructed in [\cite=Pals1]. To set the stage, three different operations have to be performed.

(a) Environment selection. To fix the environment where the cell lives, we have defined a set of external metabolites on which we applied uptake fluxes. We have considered three distinct environmental conditions: (i) isolated cell, without uptakes; (ii) minimal environment, with uptakes on a restricted set of metabolites [\cite=Bara1], namely CO2, K, NH4, PI, O2, SO4 and either one of glu-L, succ or glc); (iii) rich environment, with uptakes on all external metabolites.

(b) "Leaf-removal". Once the network is built, one has to remove from the internal metabolites those that are never produced, since the corresponding constraints are only satisfied by taking ρ = 0 or by applying a null flux to the corresponding reactions (as is actually done in FBA).

(c) Accounting for reversibility. We have disposed of reversible reactions by introducing two separate fluxes and taking the absolute difference as the positive net flux.

The size of the resulting network, i.e. N and P, is ultimately different for different environments.

We calculate the maximum growth rate [formula] numerically via a generalized MinOver algorithm [\cite=Min], detailed in [\cite=VNd], in which solutions are found at fixed ρ and then ρ is gradually increased. It has been shown rigorously [\cite=VNd] that this algorithm converges to a solution at a fixed ρ if at least one solution exists. Moreover, when multiple solutions occur (in which case they form a connected set), the algorithm provides a uniform sampling of the solution space [\cite=sup]. Anticipating that indeed many flux vectors satisfy ([\ref=vn]) at [formula] for E. coli, the latter is a particularly important advantage since a uniform sampling is required to characterize the solution space.

Characterization of the solutions

For the metabolic network of E. coli, we have found [formula] independently of the environmental conditions we have tested, so that the state of optimal growth is compatible with one with constant fluxes. The distribution of reaction fluxes at [formula] (see Fig. [\ref=distr]) displays a regime (less than two decades) with a scaling form P(s)  ~  s-  γ with exponent close to - 1 (in reasonable agreement with the experimental evidence based on a limited set of measured fluxes [\cite=Emm] [\cite=Bara1]) followed by a cutoff. Note that the flux histogram is remarkably stable over different solutions. This scenario has been partially reproduced by FBA [\cite=Bara1], but the solution obtained optimizing the biomass production systematically overestimates γ.

In order to compare individual fluxes with experiments, we aimed at studying the solution obtained in conditions similar to those described in [\cite=Emm], focusing our attention on 17 fluxes from the central metabolism, as in [\cite=Segre]. Unfortunately, we are unable to reproduce in detail the M9 medium used in [\cite=Emm], and can only fix the uptakes of three metabolites, namely glucose, CO2 and O2 identically to [\cite=Emm]. For the remaining part of the environment, we chose to simulate a minimal medium and fixed the four remaining external uptakes at arbitrary values (we did not observe a strong dependency of the results on these parameters). Results are shown in Fig. [\ref=exps]. We stress that the medium we consider is not strictly identical to that used in experiments. It is worth noting (see also [\cite=Sau2]) that experiments employ 13C-labeled carbon sources as substrates for a growing bacterial culture kept at constant density, and that the relative abundance of metabolites can be captured by nuclear-magnetic-resonance or mass spectroscopy. Reaction fluxes of different metabolic pathways are then inferred assuming a model of the reaction network.

With stationarity recovered at [formula]=1, as discussed above the difference between the Von Neumann solution and that of FBA arises from the fact that not all cμ's attain their lowest allowed value. This is clearly seen in Fig. [\ref=constr2]. In each solution, some metabolites exist with a non-zero cμ, implying that in the steady state a net production of such metabolites occurs. This may also signal an incompleteness of the stoichiometric data.

To get further insight on the existence of multiple flux states compatible with ([\ref=vn]) at [formula] and on the shape of the solution space, a rough but effective way consists in monitoring the mean overlap between different solutions. Given two solutions α and β at fixed ρ, we define their overlap qαβ as:

[formula]

This quantity equals one when [formula] and [formula] coincide and becomes smaller and smaller as the distance between [formula] and [formula] in the space of flux vectors increases. In Fig. [\ref=ov] we report the behaviour of the mean overlap 〈qαβ〉 (the angular brackets representing an average over many pairs of solutions) for E. coli and for a network with the same topology and N / P but random Gaussian stoichiometry. Random networks provide an important benchmark against which the behaviour of real networks can be tested, in order to highlight the extent to which observations are specific of the particular organism that is being analyzed. In particular, the role of topology and stoichiometry can be fully analyzed. For instance, in [\cite=VNd] it is shown that the power-law behaviour of the flux distribution cannot be ascribed to the specific network topology.

One sees that for the artificial metabolic network 〈qαβ〉 is an increasing function of ρ that approaches 1 as [formula] (Fig. [\ref=ov]b). Moreover the overlap histogram has a marked δ-peak at q = 1 whose mass increases as [formula] (data not shown). These results indicate that the optimal solution is unique. On the other hand, the behaviour of 〈qαβ〉 for E. coli suggests that the volume of solutions stops contracting when ρ reaches roughly 0.8 from below. In particular, at [formula] multiple solutions survive. From the corresponding histogram, Fig. [\ref=ov]c, we see that only about the 30% of reactions have an overlap close to 1. In a different jargon, one may say that roughly 30% of the variables are frozen (i.e. assume the same value on all solutions of the constrained optimization problem), while the remaining are free. The existence of frozen variables characterizes many random constraint satisfaction problems [\cite=gui], but it is normally hard to identify topological motifs where variables are more likely to be frozen. In the present case, it is reasonable to expect that for purely structural reasons reaction chains are entirely frozen when the first reaction of the chain is. This is indeed confirmed by the map of frozen/free fluxes in E. coli's central metabolism, displayed in Fig. [\ref=map]. The chain-like part of glycolisis appears indeed to be frozen.

The existence of frozen fluxes raises the obvious question of their biological significance. To address this point, we have correlated reaction overlaps q(i)αβ with the essentiality of the corresponding genes according to the notion of universal essentiality used in [\cite=gerdes], which combines phenomenological relevance (a gene is essential if knocking it out the cell dies) with evolutionary retention (the presence of the gene in different species). In [\cite=gerdes], 55 essential genes of E. coli involved in metabolism have been identified, that are also present in 80% of 32 different bacterial genomes. We have been able to link 52 of such genes to reactions in the reconstructed network. It turns out, see Fig. [\ref=ci], that 43 of such genes correspond to reactions with overlap larger than 0.8 and that only 7 genes relate to reactions with an overlap significantly smaller than 80%. This suggests that frozen fluxes, which in Von Neumann's framework are allowed a very limited variability if a state of optimal growth is to be kept, may carry an evolutionary significance.

The role of conserved moieties

To trace back the physical origin of the results presented above, we have studied the rank of the matrix [formula] associated to the P linear constraints ([\ref=vn]) as a function of the parameter ρ, see Fig. [\ref=rnk]. The singularity occurring at ρ = 1 is related to the presence of conserved pools of metabolites, groups of reagents whose total concentration is constant in time [\cite=Pools]. Their existence is due to the fact that the concentrations of metabolites of a certain pool are always coupled with a common functional group. For example the three metabolites ATP, AMP and ADP belong to a pool of cofactors that preserve the adenylate moiety [\cite=niko]. This implies that a change in the concentration of a given metabolite can not be accomplished without considering the entire pool to which that metabolite belongs.

A conserved pool g is formally defined by a P-dimensional Boolean vector of elements zμg such that zμg = 1 if μ∈g and zμg = 0 if [formula] satisfying

[formula]

Such conservation laws manifest themselves precisely at ρ = 1, By virtue of ([\ref=vn]), the relation [formula] must hold for any g. It follows that either [formula], or all fluxes connected to a metabolite belonging to a conserved pool must be equal to zero. Since the null solution [formula] must be discarded on obvious physical grounds, if all fluxes are connected to metabolites in a conserved pool then necessarily [formula]. This is consistent with the results obtained in different environmental conditions and implies that this scenario must be stable against small perturbations of the network topology.

Moreover, from ([\ref=g]) and ([\ref=vn]), it is easy to see that, for ρ = 1, μ∈g implies cμ = 0, i.e. for a metabolite belonging to a conserved pool the mass-balance condition must be strictly valid. We have shown instead (Fig. [\ref=constr2]) that the values of the constraints are not always zero: for some metabolites, the mass balance condition is not reached and we can assert that they do not belong to any conserved pool (within the stoichiometric description employed). We conclude that in the state of optimal growth with [formula], in addition to the stationarity of reaction rates, a spontaneous condition of mass balance holds for most, not all, metabolites.

In summary, the Von Neumann model relies on the assumption that the arrangement of metabolic fluxes follows a principle of growth maximization. It does not imply a priori either the mass balance or the stationarity of fluxes, but these two conditions are essentially recovered at the maximum growth rate. This is due to the presence of conserved metabolic pools. The singularity in the rank of   -  ρ at ρ = 1 implies that the physically relevant solutions are those to which the system tends as ρ  →  1. In this limit, mass balance is recovered (i.e. cμ = 0) for most but not all metabolites. This provides a non-trivial correction to the picture extracted by FBA and reproduces the limited experimental evidence that is available.