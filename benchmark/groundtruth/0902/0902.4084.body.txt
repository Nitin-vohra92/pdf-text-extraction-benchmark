Counting domino trains

Introduction

Let G be a directed graph with set of vertices VG and edge set EG. A path of length m on G is a sequence of vertices [formula] such that (vi - 1,vi)∈EG for all 1  ≤  i  ≤  m. A path is a cycle if v0 = vm and (vi - 1,vi)  ≠  (vj - 1,vj) for all 1  ≤  i < j  ≤  m. An eulerian path or cycle is a path or cycle of length |EG|. These concepts can be extended to the case when G is an undirected graph in a natural way (see [\cite=WES] for these and other elementary concepts about Graph Theory).

Two eulerian cycles are called equivalent if one is a cyclic permutation of the other. Let (G) denote the number of equivalence classes of eulerian circuits. If G is a directed graph there is a well-known theorem, the so called BEST Theorem (see [\cite=TTS] [\cite=AEB]), which computes (G) but if G is an undirected graph the situation is much more difficult. Nevertheless, in the case of complete graphs interesting results exist. In [\cite=McK] for instance, an asymptotic value for (Kn) (as well as the exact number for [formula]) is given, with Kn being the complete graph with n vertices.

Now let us denote by ji(G) the number of eulerian paths in G starting in vertex vi and ending in vertex vj (with no equivalence relation taken into account). In this paper we introduce a new approach and present a new method to compute ji(G) for any undirected graph G. In particular we will count the number of trains that we can construct with a given set of domino pieces, where a train is a chain constructed following the rules of domino and using all the pieces from the given set. Since any graph gives rise to a set of domino pieces where trains correspond to eulerian paths, our method applies to any graph.

The paper is organized as follows. In the first section we present some elementary definitions and fix the notation. The second section is devoted to prove the main result in the paper, namely to present a method to compute the number of trains constructible from a given set of domino pieces. Finally, in the third section we translate this result to a graph theory setting.

Definitions and notation

Let us denote by {eij | 1  ≤  i,j  ≤  n} the set of matrix units in [formula]; i.e., eij is the square matrix of size n having a 1 in position (i,j) and 0 elsewhere. Now, we define [formula] for all i  ≠  j and [formula]. Clearly the set [formula] is a basis for the vector space [formula] of real symmetric matrices of size n. If we define a new product over [formula] by [formula] our basis multiply in the following way:

[formula]

It is well-known that [formula] is commutative but non-associative. Nevertheless, we may define recursively [formula]. Now, given [formula] we consider the polynomial [formula]. With the previous convention and choosing [formula] for [formula] it makes sense to compute [formula]. Moreover, there must exist [formula] such that [formula].

In what follows we will denote by (i,j) the domino piece marked with numbers i and j. We recall that in the game of domino two pieces can be placed together if they share at least one of their numbers. Now let us suppose that we are given certain set of dominoes that we shall denote by [formula], we define a train as a sequence [formula] admissible by the rules of domino; i.e., such that jkr = ikr + 1 for all 1  ≤  r  ≤  m - 1.

Counting domino trains

Given a set of domino pieces [formula] we are interested in counting the number of trains that we can construct using all the pieces of D. If an element of D appears more than once, we will assume that we can distinguish them.

For any domino piece (i,j) we will identify [formula]. Clearly, two pieces (i,j) and (k,l) can be placed together following the rules of domino if and only if [formula]. Consequently we have the following:

A sequence [formula] is a train if and only if [formula].

By induction on n. Cases n = 1,2 are obvious due to ([\ref=tabla]). Now let us suppose that [formula] is a train with n  ≥  3 and [formula]. Then, there must exist 2  ≤  k < n such that [formula] and by our induction hypothesis [formula] is not a train which is a contradiction. Conversely if [formula], then [formula] and [formula] so, by induction, both (i1,j1)(i2,j2) and [formula] are trains and consequently so is [formula].

Now, given the set D and since the set B is a basis for [formula], we have that [formula]. In fact, the following lemma holds.

In the previous situation, [formula] if and only if we can construct a train starting with ik and ending with jk (or viceversa) using the pieces of the set D.

It is an easy consequence of ([\ref=tabla]) and Lemma [\ref=lema1].

Observe that, given a train (i1,j1)(i2,j2)(i3,j3) we could have placed its pieces in different ways according to the order. Namely we could have firstly placed the piece (i1,j1) then (i2,j2) on its right and finally the piece (i3,j3) on the right of the latter. We could also have started by piece (i2,j2), then (i1,j1) on its left and finally (i3,j3) on the right of the former. If we denote by c(n) the number of different ways we can construct a train of length n we have.

c(n) = 2n - 1

Clearly we can finish a given train either by placing the first piece (the one in the left) or the last one (the one in the right). This implies that c(n) = 2c(n - 1) and since c(1) = 1 the result follows.

With these technical lemmas in mind, we are in condition to prove the main result of this paper.

Given a set of domino pieces [formula], the number [formula] is exactly the number of domino trains that we can construct starting with ik and ending with jk (or viceversa) using the pieces from the set D.

Again, cases m = 1,2 are obvious and can be verified by direct computation using ([\ref=tabla]). Now if m  ≥  3 it is enough to observe that

[formula]

and proceed by induction on m.

Given the set D  =  {(1,1),(1,2),(1,3),(2,2),(2,3),(3,3)} we have that [formula]. So, we can construct 4 trains starting and ending with 1, and the same number with 2 and 3.

Given the set D  =  {(1,2),(1,3),(2,3),(2,3),(2,4),(3,4)} we have that [formula]. So, we can construct 12 trains starting and ending with 1 (the same number with 4), and 24 trains with 2 (the same number with 3).

Counting eulerian paths in graphs

Given a set of dominoes [formula] we can construct a graph in the following straightforward way: we draw a vertex for each of the numbers appearing ir our set D and we join two of such vertices if and only if the corresponding piece lies in our set. Clearly we can proceed backwards and obtain a set of dominoes from every graph. Moreover, domino trains correspond exactly with eulerian paths or cycles. Thus, our previous construction allows us to count them.

Also observe that given a graph G if we denote by DG the set of dominoes coming from the previous construction, then [formula] where AG is the adjacency matrix of G. Conversely, given a graph G with adjacency matrix AG we can write [formula] with m = |EG| and we know that [formula]. The following result translates Proposition [\ref=main] to this setting.

In the previous situation and with the notation of Section 1, [formula].

Given the graph in the figure it is clear that the associated set of domino pieces is DG  =  {(1,2),(1,3),(2,3),(2,3)(2,4),(3,4)} and according to Example 2 above, the total number of eulerian cycles of G is 72, 12 starting and ending in vertex 1, 24 in vertex 2, 24 in vertex 3 and 12 in vertex 4.

Consider the graph G given in the figure below.

In this case [formula] and thus G has 44 eulerian paths starting in vertex 4 and ending in vertex 5 (and vice versa).

Acknowledgments

The author thanks the Spanish project MTM2007-67884-C04-02 for the partial financial support.