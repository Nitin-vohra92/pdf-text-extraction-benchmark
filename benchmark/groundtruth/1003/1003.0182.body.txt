Product-limit estimators of the gap time distribution of a renewal process under different sampling patterns

Introduction

This note is about two classical problems in nonparametric statistical analysis of recurrent event data, both formalised within the framework of a simple, stationary renewal process.

We first consider observation around a fixed time point, i.e., we observe a backward recurrence time R and a forward recurrence time S. It is well known that the nonparametric maximum likelihood estimator of the gap-time distribution is the Cox-Vardi estimator (Cox 1969, Vardi 1985) derived from the length-biased distribution of the gap time R + S. However, Winter & Földes (1988) proposed to use a product-limit estimator based on S, with delayed entry given by R. Keiding & Gill (1988) clarified the relation of that estimator to the standard left truncation problem. Unfortunately this discussion was omitted from the published version (Keiding & Gill, 1990). Since these simple relationships do not seem to be on record elsewhere, we offer them here.

The second observation scheme considers a stationary renewal process observed in a finite interval where the left endpoint does not necessarily correspond to an event. The full likelihood function is complicated, and we briefly survey possibilities for restricting attention to various partial likelihoods, in the nonparametric case again allowing the use of simple product-limit estimators.

Observation of a stationary renewal process around a fixed point

Winter & Földes (1988) studied the following estimation problem. Consider n independent renewal processes in equilibrium with underlying distribution function F, which we shall assume absolutely continuous with density f, minimal support interval (0,  ∞  ), and hazard β(t) = f(t) / (1 - F(t)), t > 0. The reason for our unconventional choice β for the hazard rate belonging to F will become apparent later. Corresponding to a fixed time, say 0, the backward and forward recurrence times Ri and Si, i = 1,...,n, are observed; their sums Qi = Ri + Si are length-biased observations from F, i.e., their density is proportional to tf(t). Let (R,S,Q) denote a generic triple (Ri,Si,Qi). We quote the following distribution results: let μ be the expectation value corresponding to the the distribution F,

[formula]

then the joint distribution of R and S has density f(r + s) / μ , the marginal distributions of R and S are equal with density (1 - F(r)) / μ, and the marginal distribution of Q = R + S has density qf(q) / μ, the length-biased density corresponding to f.

Winter and Földes considered the product-limit estimator

[formula]

where

[formula]

is the number at risk at time t. This estimator is the same as the Kaplan-Meier estimator for iid survival data [formula] left-truncated at [formula] (Kaplan & Meier 1958, Andersen et al. 1993). Winter & Földes showed that [formula] is strongly consistent for the underlying survival function 1 - F .

We shall show how the derivation of this estimator follows from a simple Markov process model similar to the one used by Keiding & Gill (1990) to study the random truncation model.

First notice that the conditional distribution of Q = R + S given that R = r has density

[formula]

that is, intensity (hazard) f(q) / (1 - F(q)), q > r, which is just the hazard β(q) corresponding to the underlying distribution F left-truncated at r. Now define corresponding to (R,S,Q) a stochastic process U on

[formula]

U(t) = {

[formula]

P{U(t+h)=2|U(u),0≤ u≤ t} = o(h).

[formula]

α(t) =

[formula]

β(t) = ,

[formula]

μ f(r+s)

[formula]

(t) =  / 1 R+S,

[formula]

it should be required that

[formula]

in the terminology of Keiding & Gill (1990, Sec. 5c), and using [formula] and

[formula]

the integrability condition translates into

[formula]

or finiteness of E(1 / X) where X has the underlying ("length-unbiased") interarrival time distribution F. It may easily be seen from Gill et al. (1988) that the same condition is needed to ensure weak convergence of the Cox-Vardi estimator.

A variation of the observation scheme of this section would be to allow also right censoring of the Si. This can be immediately included in the Markov-process/counting process approach leading to the inefficient product-limit type estimator [formula]; the delayed-entry observations Si are simultaneously right-censored. See Vardi (1985, 1989) and Asgharian et al. (2002) for treatment of the full non-parametric maximum likelihood estimator of F, extending the Cox-Vardi estimator to allow right censoring.

Other ad hoc estimators and the rich relationships with a number of other important non-parametric estimation problems are discussed by Denby and Vardi (1985) and Vardi (1989).

Observation of a stationary renewal process in a finite interval

We consider again a stationary renewal process on the whole line and assume that we observe it in some interval

[formula]

, actually a right-censored version of 3., contributing factors of the form [formula] to the likelihood.

McClean & Devine (1995) studied nonparametric maximum likelihood estimation in the conditional distribution given that there is at least one renewal in the interval, i.e., that there are no observations of type 4.

Our interest is in basing the estimation only on complete or right-censored gap times, i.e., observations of type 1 or 2. When this is possible, we have simple product-limit estimators in the one-sample situation, and we may use well-established regression models (such as Cox regression) to account for covariates. Peña et al. (2001) assumed that observation started at a renewal (thereby defining away observations of type 3 and 4) and gave a comprehensive discussion of exact and asymptotic properties of product-limit estimators with comparisons to alternatives, building in particular on results of Gill (1980, 1981) and Sellke (1988). The crucial point here is that calendar time and time since last renewal both need to be taken into account, so the straightforward martingale approach displayed by Andersen et al. (1993) is not available. Peña et al. also studied robustness to deviations from the assumption of independent gap times.

As noted by Aalen & Husebye (1991) in their attractive non-technical discussion of observation patterns, observation does however often start between renewals. (In the example of Keiding et al.  (1998), auto insurance claims were considered in a fixed calendar period). As long as observation starts at a stopping time, inference is still valid, so by starting observation at the first renewal in the interval we can essentially refer back to Peña et al. (2001). A more formal argument could be based on the concept of the Aalen filter, see Andersen et al. (1993, p. 164). The resulting product-limit estimators will not be fully efficient, since the information in the backward recurrence time (types 3 and 4) is ignored. It is important to realize that the validity of this way of reducing the data depends critically on the independence assumptions of the model. Keiding et al. (1998), cf. Keiding (2002) for details, used this fact to base a goodness-of-fit test on a comparison of the full nonparametric maximum likelihood estimator with the product-limit estimator.

Similar terms appear in another model, called the Laslett line segment problem (Laslett, 1982). Suppose one has a stationary Poisson process, with intensity μ, of points on the real line. We think of the real line as a calendar time axis, and the points of the Poisson process will be called pseudo renewal times or birth times of some population of individuals. Suppose the individuals have independent and identically distributed lifetimes, each one starting at the corresponding birth time. The corresponding calendar time of the end of each lifetime can of course be called a death time. Now suppose that all we can observe are the intersections of individuals' lifetimes (thought of as time segments on the time axis) with an observational window

[formula]

for which death occurred before time t2.

2. Censored proper lifetimes corresponding to births within

[formula]

t-t+ (1 - F(y)) d y .

[formula]

Acknowledgements

This research was partially supported by a grant (RO1CA54706-12) from the National Cancer Institute and by the Danish Natural Sciences Council grant 272-06-0442 "Point process modelling and statistical inference".

References

Aalen, O.O. & Husebye, E. (1991). Statistical analysis of repeated events forming renewal processes. Statistics in Medicine 10, 1227-1240.

Andersen, P.K., Borgan, Ø., Gill, R.D. & Keiding, N. (1993). Statistical Models Based on Counting Processes. Springer Verlag, New York.

Asgharian, M., Wolfson, D. B. & M'lan, C. E. (2002). Length-biased sampling with right censoring: an unconditional approach. J. Amer. Statist. Assoc. 97, 201-209.

Cook, R.J. & Lawless, J.F. (2007). The statistical analysis of recurrent events. Springer Verlag, New York.

Cox, D.R. (1969). Some sampling problems in technology. In New Developments in Survey Sampling (N.L. Johnson and H. Smith, Jr., eds), 506-527. Wiley, New York.

Denby, L. & Vardi, Y. (1985). A short-cut method for estimation in renewal processes. Technometrics 27, 361-373.

Gill, R.D. (1980). Nonparametric estimation based on censored observations of a Markov renewal process. Zeitschrift für Wahrscheinlichkeitstheorie und verwandte Gebiete 53, 97-116.

Gill, R.D. (1981). Testing with replacement and the product-limit estimator. Annals of Statistics 9, 853-860.

Gill, R.D. (1994). Lectures on survival analysis. Lecture notes in Mathematics 1581, 115-241. Springer, New York.

Gill, R.D., Vardi, Y. & Wellner, J.A. (1988). Large sample theory of empirical distributions in biased sampling models. Annals of Statistics 16, 1069-1112.

Kaplan, E.L. & Meier, P. (1958). Non-parametric estimation from incomplete observations. Journal of the American Statistical Association 53, 457-481.

Keiding, N. (2002). Two nonstandard examples of the classical stratification approach to graphically assessing proportionality of hazards. In: Goodness-of-fit Tests and Model Validity (eds. C. Huber-Carol, N. Balakrishnan, M.S. Nikulin and M. Mesbah). Boston, Birkhäuser, 301-308.

Keiding, N., Andersen, C. & Fledelius, P. (1998). The Cox regression model for claims data in non-life insurance. ASTIN Bulletin 28, 95-118.

Keiding, N. & Gill, R.D. (1988). Random truncation models and Markov processes. Report MS- R8817, Centre for Mathematics and Computer Science, Amsterdam.

Keiding, N. & Gill, R.D. (1990). Random truncation models and Markov processes. Annals of Statistics 18, 582-602.

Laslett, G.M. (1982). The survival curve under monotone density constraints with application to two-dimensional line segment processes. Biometrika 69, 153-160.

McClean, S. & Devine, C. (1995). A nonparametric maximum likelihood estimator for incomplete renewal data. Biometrika 82, 791-803.

Palmer, R.C. (1948). The dye sampling method of measuring fibre length distribution (with an appendix by R.C. Palmer and D.R. Cox). Journal of the Textile Institute 39, T8-T22.

Peña, E. A., Strawderman, R. L. & Hollander, M. (2001). Nonparametric estimation with recurrent event data. Journal of the American Statistical Association 96, 1299-1315.

Sellke, T. (1988). Weak convergence of the Aalen estimator for a censored renewal process, in Statistical Decision Theory and Related Topics IV, (eds. S. Gupta & J. Berger), Springer-Verlag, New York, Vol. 2, 183-194.

Soon, G. & Woodroofe, M. (1996). Nonparametric estimation and consistency for renewal processes. Journal of Statistical Planning and Inference 53, 171-195.

van der Laan, M.J. (1996). Efficiency of the NPMLE in the line-segment problem. Scandinavian Journal of Statistics 23, 527-550.

van der Laan, M.J. and Gill, R.D. (1999). Efficiency of NPMLE in nonparametric missing data models. Mathematical Methods in Statistics 8, 251-276.

van Zwet, E.W. (2004). Laslett's line segment problem. Bernoulli 10, 377-396.

Vardi, Y. (1982). Nonparametric estimation in renewal processes. Annals of Statistics 10, 772-785.

Vardi, Y. (1985). Empirical distributions in selection bias models. Annals of Statistics 13, 178-203.

Vardi, Y. (1989). Multiplicative censoring, renewal processes, deconvolution and decreasing density: nonparametric estimation. Biometrika 76, 751-761

Wijers, B.J. (1995). Consistent nonparametric estimation for a one-dimensional line-segment process observed in an interval. Scandinavian Journal of Statistics 22, 335-360.

Winter, B.B. & Földes, A. (1988). A product-limit estimator for use with length-biased data. Canadian Journal of Statistics 16, 337-355.