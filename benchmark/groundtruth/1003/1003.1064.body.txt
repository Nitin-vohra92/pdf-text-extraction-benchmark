Congruence properties of the function which counts compositions into powers of 2 Giedrius Alkauskas Institute of Mathematics, Department of Integrative Biology Universität für Bodenkultur Gregor Mendel-Straße 33, A-1180 Wien, Austria, & Vilnius University, Department of Mathematics and Informatics Naugarduko 24, LT-03225 Vilnius, Lithuania. giedrius.alkauskas@gmail.com

Introduction

Let ϑ(n) denote the number of compositions of a positive integer n into powers of 2 (compositions are sometimes called ordered partitions): this is the amount of finite sequences [formula] of non-negative integers such that [formula]. Thus, for example, 3 = 1 + 1 + 1 = 2 + 1 = 1 + 2 give all possible compositions, hence ϑ(3) = 3. This sequence appears in Sloane's encyclopedia [\cite=sloane] as A023359. Several properties of this sequence are also listed there. Let us call this function the binary composition function. It is easy to see (with the help of calculus of residues) that

[formula]

where ρ is the unique zero of [formula] in the interval (0,1), and [formula]. Nevertheless, in this note we are mainly concerned with 2 - adic rather than with real asymptotics.

The binary partition function b(n) (which counts the partitions of n into non-negative powers of 2 neglecting the order of the summands) was investigated by many authors, beginning with L. Euler (1750), and in the 20th century A. Tanturi (1918), K. Mahler (1940) (who explored asymptotic behavior). See the sequences A018819 and A000123 in Sloane's Encyclopedia [\cite=sloane]; one can find numerous references there. Congruence properties of b(n) modulo powers of 2 were first observed by R. F. Churchhouse [\cite=church] (the main congruence was given without a proof as a conjecture). This conjecture was later proved by H. Gupta [\cite=gupta] and independently by Ø. Rødseth [\cite=rodseth]. This result can also be found in Andrews' monograph [\cite=andrews]. The paper by the author [\cite=alkauskas1] gives another proof of this fact along with one possible generalization of this congruence. As an aside [\cite=alkauskas1], for every positive integer s which is not divisible by 8 there exists a finite algorithm to verify the fact that infinitely many terms of the sequence b(n) are divisible by s. Calculations confirmed this for 2  ≤  s  ≤  14, s  ≠  8 (as was noticed by Churchhouse himself, b(n) is never divisible by 8). Moreover, for every power of 2 there exists a finite table which lists all the possible remainders of b(n) modulo this power. For example, modulo 32 one of the entries is [\cite=alkauskas1]

[formula]

Here [formula] stands for the "floor" function, w(n) represents the Thue-Morse sequence with initial conditions w(0) = 0, w(1) = 1, and τ(n) stands for the Rudin-Shapiro sequence with conditions τ(0) = 0 and τ(3) = 1.

We will now formulate the Rødseth-Gupta theorem.

On the other hand, the binary composition function has not yet been arithmetically investigated. The only papers (apart from The On-Line Encyclopedia of Integer Sequences) where this sequence appears are the papers by the author [\cite=alkauskas2] and by Chinn and Niederhausen [\cite=chinn]. The authors of the latter are concerned with finding an exact formula for the number of binary compositions of n into exactly n - k parts for small k. If we consider compositions of a positive integer n with no limitation on the non-negative summands, then the amount of these is equal to 2n - 1. On the other hand, compositions with summands coming from a certain set reveal new congruence phenomena. For example, one of our main results is the following surprising fact. Let us denote by s2(n) the amount of 1's in the binary expansion of n. This is the sequence A000120.

Suppose that n  ≥  1, N  ≥  1, and s2(n + 2N - 1)  ≥  2N. Then

[formula]

Let us say that a property A is satisfied for almost all natural numbers, if

[formula]

Let [formula]. Then for almost all natural numbers the congruence [formula] is satisfied.

This is clear: for a fixed [formula], almost all natural numbers will have more than M 1's in the binary expansion.

Congruence properties

Now we will derive some basic facts about ϑ(n). Les us make a convention ϑ(0) = 1 and ϑ( - n) = 0 for [formula]. Binary compositions of n can be divided into disjoined subsets, each of which consists of compositions with the first summand equal to 2k, 1  ≤  2k  ≤  n. Thus, this gives the recurrence relation, which also appears in [\cite=alkauskas2] [\cite=chinn] [\cite=sloane]:

[formula]

Hence, the generating function is give by

[formula]

From the recurrence relation we can already determine the parity of ϑ(n). This is the only property which admits easy proof directly from ([\ref=rec]).

The number ϑ(n) is odd if and only if n = 2u - 1, [formula].

Suppose we have already proved this statement for all positive integers ≤  n - 1. From the recurrence relation and inductive hypothesis we inherit that the parity of ϑ(n) equals the parity of the amount of odd terms among ϑ(n - 2u), u  ≥  0. This term is odd iff (according to the induction hypothesis) n - 2u = 2v - 1; that is, it happens only iff n + 1 = 2u + 2v. Hence, if s2(n + 1) > 2, this cannot occur. If s2(n + 1) = 2, so n + 1 = 2u + 2v, u  ≠  v, we have exactly two odd summands: ϑ(n - 2u) and ϑ(n - 2v), and therefore the sum is even. Finally, we have only one odd summand iff n = 2u - 1, and this summand is ϑ(n - 2u - 1) = ϑ(2u - 1 - 1). We finish by induction.

The congruence properties of the binary composition function modulo higher powers of 2 were observed by the author [\cite=alkauskas2]. One of these congruences claim that

[formula]

Unfortunately, despite many efforts to manipulate with ([\ref=rec]), this and similar claims were not proved in [\cite=alkauskas2] but rather extrapolated from numerical data. This failure suggests the fact that the recurrence ([\ref=rec]) alone is insufficient in proving these congruences. Luckily, one can derive some other recurrence relations, much more convenient and powerful.

For [formula], we have

[formula]

In general, for m,n  ≥  1, the following equality holds

[formula]

Thus, in case m = n this gives ([\ref=dvig]), and in case m = 1 this reduces exactly to ([\ref=rec]).

As a matter of fact, this identity is valid for any function which counts compositions of n into positive integers [formula], only 2s must be replaced with as in the formula. To prove the identity, consider any composition of m + n:

[formula]

Let s be the largest non-negative integer such that [formula] (if s = 0, the empty sum is 0 by convention). The number of compositions of m + n where [formula] for some s is obviously equal to ϑ(m)  ·  ϑ(n). If [formula], then [formula]. Thus, m + n - a - b = 2qs + 1. Thus, if a < m and b < n are fixed, the amount of such compositions is equal to ϑ(a)  ·  ϑ(b). This proves the formula ([\ref=sum]).

Now we are able to derive the following

The sequence ϑ(n) can be completely described modulo 4. (i) For n  ≥  3, let τ3(n) denote the number of solutions of n + 1 = 2s + 2v + 2u with s  ≥  v > u  ≥  0, let τ2(n) denote the number of solutions of n + 1 = 2s + 2u, and let τ1(n) denote the number of solutions of n + 1 = 2s. Then

[formula]

(ii) In a similar way, [formula] for k  ≥  2, and [formula] for [formula]. In all other cases, [formula] (the first occurrence is n = 7).

Note that ([\ref=dvig]) can be rewritten as

[formula]

Consider this equality modulo 4. Obviously, [formula], since this is implied by Proposition [\ref=elem]. In the second sum, only the terms with a = 2u - 1 and b = 2v - 1, u,v  ≥  0, do contribute to the final result. In this case 2n = 2s + 2u - 1 + 2v - 1. Thus, suppose n is of this form. Since a < b, we have u < v, u  ≥  1, and also, since 2v - 1 < n, it is easy to see that s  ≥  v. The number of solutions is thus τ2(n). Finally, the second sum contributes exactly τ2(n).

(ii) Equally, ([\ref=sum]) for m = n - 1 reads as

[formula]

Here we used ([\ref=rec]). In the sum, we have zero contribution to ϑ(2n - 1) modulo 4 unless a = 2u - 1, b = 2v - 1, and 2u - 1 + 2v - 1 = 2n - 1 - 2s. Thus, u = 0 and n = 2s - 1 + 2v - 1. Since b = 2v - 1 < n - 1, this implies s > v. Thus, there exists at most one such solution, and this happens exactly when s2(n) = 2. If n = 2k, k  ≥  1, we get that [formula].

The following table summarizes the results of Proposition [\ref=proposition3].

This table should list all even numbers n such that s2(n + 2)  ≤  3. However, two types of these numbers, namely {2k,k  ≥  3} and {2k + 2l - 2,k > l + 1  ≥  3}, fall under the qualification "other even numbers", while the type {n = 2k + 2l,ł  ≥  2} is a special case of the first type listed in the table.

Let us now inspect the recurrences ([\ref=even]) and ([\ref=odd]) more carefully. We will use the following well-known implication which, as a matter of fact, makes the investigations of quadratic forms over 2 - adic number field rather exceptional in p - adic analysis. Let [formula], N  ≥  1. Then

[formula]

Suppose we know the sequence ϑ(n) modulo 2N. In this case the recurrences ([\ref=even]), ([\ref=odd]) and the above fact show us that the sequence ϑ(n) is completely describable modulo 2N + 1 as well. Further, note that Table 1 lists only those even and odd numbers n such that [formula]. The recurrence ([\ref=even]) shows then that the corresponding table for ϑ(n) modulo 8 will list only those even numbers n such that s2(n + 4)  ≤  7. Exactly the same conclusion follows for odd n. Here is one tricky point. In fact, consider odd number 2n - 1 and the multiplier ϑ(n) of the term 2ϑ(n - 1)ϑ(n) in ([\ref=odd]). This multiplier matters if s2(n + 2)  ≤  3. This shows that odd numbers 2n - 1 such that s2((2n - 1) + 5)  ≤  3 should also be considered as candidates to be listed in the table for ϑ(n) modulo 8. Indeed, it can happen that s2((2n - 1) + 5)  ≤  3 and s2((2n - 1) + 4)  ≥  8 are simultaneously satisfied. But then elementary considerations show that s2(n + 1)  ≥  7. Thus, [formula] and, due to this multiplier, the term 2ϑ(n - 1)ϑ(n) does not contribute to [formula]. We can proceed by induction on N. Therefore, a careful analysis of ([\ref=even]) and ([\ref=odd]) implies the following

For each positive integer N there exists a finite table (analogous to the Table 1) which lists a finite number of possibilities for ϑ(n) modulo 2N. The table encompasses only finite number of classes of those positive integers n such that

[formula]

If the entry [formula] is in this table, the corresponding residue depends solely on [formula] and the exact shape of the collection of inequalities or equalities (the amount of these collections is also finite) satisfied by [formula]. These inequalities or equalities are of the form ki = ki + 1 + di, or ki  ≥  ki + 1 + di, for a fixed collection of [formula]. For those positive integers n which are not in this table, [formula].

This result has numerous corollaries. One immediate corollary is Theorem [\ref=teom]. Also, Theorem [\ref=thm3] says that to prove the congruence ([\ref=ast]) or even to improve it to

[formula]

(which does hold), one needs to perform only a finite number of calculations: all what is demanded is to check that this congruence holds for k up to a given bound, to be rest assured that this holds throughout. Indeed, according to the Theorem [\ref=thm3], two numbers 2k + 1 and 2k will eventually qualify for the same entry in the table for k large enough (or be both left out of the table). For the very same reason, this allows to make the following claim. Let [formula]. Then there exists

[formula]

here [formula] stands for the ring of 2 - adic integers, and the limit is taken in 2 - adic topology. A generalization of this is the following

Let [formula] be a polynomial with non-negative integral coefficients. Then for every integer [formula] there exists [formula] such that

[formula]

According to Theorem [\ref=teom], if a polynomial [formula], ad  ≥  1, has at least one negative coefficient ai < 0 with i  ≥  1, then [formula] in 2 - adic topology.

We finish with providing the table for ϑ(n) modulo 8.

Thus, for example, [formula]. The complete table for 2N = 16 has the following entries, which are not members of larger classes:

[formula]

One could wonder, for example, whether these have combinatoric proofs.

Concerning the condition ([\ref=bound]), it is certainly not sharp for N > 2, as the above table for 2N = 8 suggests. Employing this table, we can show that in fact 2N on the right hand side can be replaced by 2N - 1 + 2N - 3 - 1 for N  ≥  4. This might be also far from the optimal for larger N.

2010 Mathematics Subject Classification: Primary 11P83; Secondary 11P81, 05A17

Keywords: Binary compositions, ordered partitions, congruence properties, 2-adic analysis

(Concerned with sequence A023359)