Theorem Proposition Corollary Lemma

Question

Green's sumset problem at density one half

Introduction

In the paper [\cite=JBAA] Bourgain first addressed the question of showing that if [formula] has positive relative density then A + A contains a very long arithmetic progression. Since his work the problem has received considerable attention, and to help understand it better Green [\cite=BJGFFM] introduced a model version which has turned out to be interesting in its own right. It is this question with which we shall concern ourselves in this note.

Suppose, as we shall throughout, that [formula] and let [formula] denote the normalized counting measure on G. We are interested in what size of subspace one can guarantee that A + A contains, where A is a subset of G of density [formula].

It turns out that there are various ranges of the density in which we see quite different phenomena. To begin note that if α > 1 / 2 then the inclusion-exclusion principle tells us that [formula] for all x∈G and so we have that A + A = G; we write this as follows.

Suppose that [formula] has density α  >  1 / 2. Then A + A contains a subspace of co-dimension 0.

Once the density dips below 1 / 2 things begin to change. In this regime A may be contained in a subspace of co-dimension 1, and so A + A can, at best, be guaranteed to contain a subspace of co-dimension 1. To start with this is best possible:

Suppose that [formula] has density α  >  1 / 2 - ε where [formula]. Then A + A contains a subspace of co-dimension 1.

Once [formula], however, a different sort of behavior manifests. The worst known such is exhibited by the so called Niveau set construction of Ruzsa [\cite=IZREC] and for us this yields the following theorem.

For all [formula], there is a set [formula] of density α  >  1 / 2  -  ε such that any subspace contained in A + A has co-dimension [formula].

We are not able to prove a matching upper bound, although we are able to establish the following weak complement.

Suppose that [formula] has density α  >  1 / 2  -  ε where ε∈(0,1 / 2]. Then A + A contains a subspace of co-dimension [formula].

All previous work on showing that sumsets contain large subspaces has concentrated on the case of positive density (rather than density close to 1 / 2) and has consequently produced weaker results. It turns out the argument used for the previous theorem also yields a new result in this case.

Suppose that [formula] has density α  >  0. Then A + A contains a subspace of dimension Ω(αn).

This improves upon [\cite=BJGFFM] where a lower bound on the dimension of the form Ω(α2n) was given. Recently Croot and Sisask [\cite=ESCOS] also established an improvement of roughly the strength of Theorem [\ref=thm.new2] but by different arguments in a much more general setting.

Finally, Fourier analysis is notoriously weak when dealing with thin sets and, indeed, if α  =  o( log n / n) then it turns out that an elementary counting argument of Croot, Ruzsa and Schoen [\cite=ESCIZRTS] supersedes Theorem [\ref=thm.new2].

As indicated we make use of the Fourier transform the group [formula]. In particular we denote the dual group by [formula] and define the transform to be the map taking f∈L1(G) to We use basic results from Fourier analysis without comment and the reader interested in details may wish to consult Tao and Vu [\cite=TCTVHV].

he note now splits into three further sections in which Theorem [\ref=thm.epssmall], Theorem [\ref=thm.construction] and Theorem [\ref=thm.new] (and [\ref=thm.new2]) are proved, followed by some concluding remarks in the final section including a discussion of the link with the integer version of the problem.

Proof of Theorem [\ref=thm.epssmall]

The argument involves two main tools. The first is Plünnecke's inequality, [\cite=HP], which we record now. One of the key ideas in our work is to make use of it in the region when K  ~  1.

Suppose that [formula] are such that [formula]. Then for any positive integer k there is a set X  ⊂  A with [formula].

The second tool is measure concentration on the cube for which we shall follow McDiarmid [\cite=CM]. The idea of using measure concentration was introduced to difference set problems by Wolf in [\cite=JWSPDS] and that is the inspiration for our application.

For any natural number n we write Qn for the cube {0,1}n. The Hamming metric on Qn is defined in the usual way: For any set A  ⊂  Qn and r  ≥  0 we write that is the set of points of at most distance r from A. Measure concentration provides a lower bound for the density of this set.

Suppose that A is a non-empty subset of Qn. Then for any r  ≥  0 we have

The formal similarity of [formula] and Qn immediately tells us how we shall make use of this result. Suppose that [formula] is a basis of [formula], so that the map is a bijection. Sets in G inherit certain growth properties from those in Qn as follows. Writing [formula] we have that

[formula]

To see this note that if z is a member of the right hand side then there is some y∈A such that Note that this is perfectly well defined since φ- 1E is a bijection. Now, let x∈{0,1}n be such that so that On the other hand the number of i such that xi  ≠  0 is at most r and 0G∈F, whence z∈y + rF. ([\ref=eqn.ku]) then follows. In light of this we have the following consequence of Theorem [\ref=thm.concentrateG].

Suppose that [formula] and E is a basis of G, A is a non-empty subset of G and [formula]. Then for any r  ≥  0 we have

The heart of the argument is the following asymmetric version of Theorem [\ref=thm.epssmall].

Suppose that [formula] has density α  >  1 / 2 - ε where [formula]. Then A + A contains a coset of a subspace of co-dimension 1.

In view of Proposition [\ref=prop.triv] we may certainly assume that [formula]. Put S: = (A + A)c and note that [formula], whence [formula]. Since [formula], it follows that since ε  ≤  1 / 4. Suppose that E is a basis of G such that there is some s∈S with s + E  ⊂  S. Since [formula] is translation invariant we have that [formula] has Now, let [formula] and define a sequence of sets [formula] using Plünnecke's inequality: let [formula] be such that [formula], and [formula] be such that

[formula]

Since [formula] and (Xr)r is nested, we see that the sequence [formula] is increasing and bounded above by [formula]. It follows that there is some r such that [formula]; let r' be the minimal such. In this case by nesting of (Xr)r, whence

[formula]

But by Proposition [\ref=prop.concentrate] we have that Now by ([\ref=eqn.growth]) and the upper bound in ([\ref=eqn.rest]) we get that since [formula] by assumption on ε; whence On the other hand this can be bounded above using the lower bound in ([\ref=eqn.rest]) and the fact that k2  ≥  n: This contradiction means that for all s∈S, the set S - s contains at most n - 1 linearly independent vectors. Thus there is an element s∈S and a subspace H of co-dimension 1 in G such that S  ⊂  s + H. Since S = (A + A)c it follows that A + A  ⊃  (s + H)c; (s + H)c is simply the coset of H not equal to s + H, whence we are done.

We now use the above result in a straightforward manner.

Let U be the smallest subspace of G such that A + A  ⊃  Uc. Note that such a space exists since [formula].

By averaging there is a coset x + U on which A has relative density at least α: write [formula] and note that A + A  ⊃  A' + A' and [formula]. By Proposition [\ref=prop.epssmall] there is a subspace U'  ≤  U of relative co-dimension at most 1 and some u∈U such that u + U'  ⊂  A' + A'  ⊂  A + A. We have three cases:

U' = U: then

U'  ≠  U and u + U'  ≠  U': then A + A  ⊃  U'c and dim U'  <   dim U contradicting the minimality of U;

U'  ≠  U and u + U'  =  U': then let π:G  →  U be a projection which is the identity when restricted to U and note that π- 1(U') is a subspace of G of co-dimension 1 with

[formula]

The result follows.

Proof of Theorem [\ref=thm.construction]

The argument here is a very slight adaptation of [\cite=BJGFFM]. Green established this by reformulating Ruzsa's construction from [\cite=IZRAA] in the model setting where many of the details simplify.

Let Let X be the random variable which takes x∈G to the number of 1s in x. [formula] is the uniform distribution on G, and X is the sum of n independent identically distributed Bernoulli random variables with parameter p = 1 / 2.

The mean of each individual Bernoulli trial is 1 / 2 and the variance 1 / 4 so that the mean of X is n / 2 and the variance is n / 4. It follows from the Berry-Esseen inequality (see, e.g. [\cite=ANS]) that Thus On the other hand It follows that It follows that for [formula] we may pick η = 0.8ε and get that [formula].

Now we shall show that if V  ≤  G has co-dimension at most [formula] then V contains a vector with at most [formula] zeros in the standard basis. Since any x∈A + A has at least [formula] zeros in the standard basis we shall be done. Such a V can be written as where the vis are linearly independent. The vis may be written in the standard basis as where (ei)i is the standard basis. The column rank of the matrix (ε(j)i)ij is n - d hence so is its row rank. Without loss of generality we may suppose that the first n - d rows [formula], [formula] are linearly independent. It follows that we can solve the n - d equations for the λi giving a vector in V with no more than d zeros. The result follows.

Proof of Theorem [\ref=thm.new]

We shall prove the following stronger theorem from which both Theorems [\ref=thm.new] and [\ref=thm.new2] follow.

Suppose that [formula] has density α  ≤  1 / 2. Then A + A contains a subspace of co-dimension

Before proving this we establish our two consequences.

Apply Theorem [\ref=thm.underlying] with α = 1 / 2  -  ε.

It is easy to see that Theorem [\ref=thm.underlying] then tells us that A + A contains a subspace of dimension at least αn /  log 2  -  O(1).

The proof is inspired by the standard iterative method of Roth introduced in [\cite=KFRPre] and the more commonly cited [\cite=KFR], which was adapted to finite fields by Meshulam in [\cite=RM]. The following lemma is the driver.

Suppose that [formula] has density α > 0 and V  ≤  G. Then there is a subspace V'  ≤  V of relative co-dimension 1 such that

For each W∈G / V fix some xW∈W and let AW be [formula] considered as a subset of V. Since - 2xW = 0 we have that [formula], whence write [formula]. In view of the definition of S and our above observation, we get from Plancherel's theorem that

[formula]

Partition [formula] into two sets N: = {γ∈γ) < 0} and P: = {γ∈γ)  ≥  0}. Since [formula] we have On the other hand, from equation ([\ref=eqn.base]) and the definition of N, we get

[formula]

By the Hölder's inequality and then Parseval's theorem we have

[formula]

Combining this with the foregoing we get that

[formula]

Now, by the Cauchy-Schwarz inequality However, [formula], whence Inserting this into ([\ref=eqn.lt]) we get that Since α > 0 and G / V is finite we may divide by the sum and conclude that Let γ∈N be such that this supremum is attained and write [formula]. V' has relative co-dimension 1 and, in view of this, we note that [formula] for any [formula]. Now since [formula] and γ∈N. Furthermore, since V' and x0 + V' partition V we have that Adding these two expressions tells us that It remains only to note that [formula] and the lemma is proved.

Let σ∈(0,1) be a parameter to be optimized later. We use the iteration lemma to produce a sequence of subspaces Vi such that

Vi  ≤  Vi - 1 and the co-dimension of Vi in Vi - 1 is 1;

[formula].

We set V0 = G, and apply the iteration lemma (Lemma [\ref=lem.iteration]) repeatedly to get the sequence. Now, if [formula] then [formula], whence A + A contains a subspace of co-dimension i by ([\ref=enum.pt12]). In view of ([\ref=enum.pt12]) and ([\ref=enum.pt42]) this certainly happens if taking i minimal such that this inequality is satisfied yields the result.

Concluding remarks

As noted in the introduction Theorem [\ref=thm.epssmall] is best possible, however there is still a large gap between Theorem [\ref=thm.construction] and Theorem [\ref=thm.new]. It has been suggested in [\cite=BJGFFM] that the truth is closer to Theorem [\ref=thm.construction] in the case when the density of the set is Ω(1). One might take Theorem [\ref=thm.epssmall] as some support of this conjecture (at least in the case of density 1 / 2 - o(1)). An intermediate question might be the following.

Suppose that [formula] has density [formula]. Does A + A contain a subspace of co-dimension OC(1)?

Theorem [\ref=thm.construction] tells us that this cannot be sublinear, and while showing that may be hard it could be that O(C2) is rather more accessible.

Theorem [\ref=thm.new] (and Theorem [\ref=thm.epssmall]) are the first results which provide a sensible upper bound on the co-dimension rather than lower bound on the dimension of the subspace found in A + A, and given the proof one might imagine an improvement to Theorem [\ref=thm.new] would be possible.

The following is a well-known theorem (see, for example, Metsch [\cite=KM]).

Suppose that [formula] and [formula] meets every subspace of dimension d. Then |S|  ≥  2n + 1 - d - 1.

This result can be used in the proof of Theorem [\ref=thm.underlying] above to tell us that once we have in the iteration then A + A must contain a subspace of dimension d. This certainly happens when again taking i minimal such that this inequality holds we get a saving of 1 in the co-dimension. This is, of course, not particularly impressive and, indeed, no naïve attack along these lines will work as it turns out that Theorem [\ref=thm.proj] is also best possible. (Again, see Metsch [\cite=KM].) This may be contrasted with the following result of Alon.

Suppose that [formula] and [formula] is such that [formula]. Then there is a set A  ⊂  G such that S = (A + A)c.

Here, of course, the set A produced is rather thin and certainly nowhere near the densities we are looking for.

One may also reasonably ask what happens in the transition to the integers. Theorem [\ref=thm.new2] can be proved there through the machinery of Bohr sets as developed by Bourgain [\cite=JB]. However, as the reader will have realised from the proof, the strength comes from the rather precise subgroup structure which is not present in general and as a result the conclusions are weaker than what is already known [\cite=BJGAA].

Acknowledgements

The author should like to thank Endre Szemerédi and Julia Wolf for useful conversations.