Lemma

Proof of validity of first-order travel estimates

Introduction

The purpose of this paper is to clarify and strengthen the derivation of formula (65) of the seminal paper by [\cite=BD1], in which the use of crosscorrelation to estimate traveltime delays is discussed. Formula (65) is a first-order estimate of δτ, the shift in the peak position of the crosscorrelation of observed and synthetic pulses. At a certain point in the derivation, which we explain in detail below, the Taylor series used by [\cite=BD1] is of one order less than would be normally expected, and for a general equation it would not be possible to make the claim that the estimate is indeed of first order. However, we show that in this special context the claim is mathematically true for rather subtle reasons, without the need of justifying it by a subsequent geophysical application. Even though, certain subtleties might be of no interest to geophysicists using the results of [\cite=BD1], we offer this proof in the context of geomathematics and in a spirit of respect for the contributions of the late Tony Dahlen.

Let us describe the derivation in question. The main entity studied is the crosscorrelation

[formula]

where s is the synthetic signal and sobs is the observed signal; this is equation (58) of [\cite=BD1]. Subsequently, they assume that sobs can be written as

[formula]

where δs(t) is a small perturbation; this is equation (59). This permits them to write equation (60):

[formula]

where

[formula]

is the crosscorrelation of s with itself, and

[formula]

is the crosscorrelation of the synthetic signal and the perturbation.

The maximum of the autocorrelation, γ(τ), is at τ = 0; the goal of [\cite=BD1] is to give a first-order estimate of the delay given by the maximum of Γ(τ), which they call δτ. They obtain this estimate by taking the Taylor series of Γ(τ) about τ = 0, to the second order, differentiating this second-order series, and taking δτ to be given by the zero of this derivative. Herein is a technical subtlety. The second-order Taylor series should be

[formula]

so that

[formula]

and the critical point of Γ(τ), using the fact that ∂τγ(0) = 0, would be

[formula]

However, instead of the second-order series ([\ref=trueTaylor]), [\cite=BD1] use

[formula]

which is their equation (63); in other words, they neglect

[formula]

which results in

[formula]

which is estimate (65) of [\cite=BD1].

The absence of the term ([\ref=missingterm]) is not trivial mathematically, even if one might argue for it heuristically in the context of geophysical approximations. We have examined the documents of the late Tony Dahlen, which he sketched in preparation for [\cite=BD1], and which are available at Princeton University. Not having found a mathematical justification therein, we give one in Sections [\ref=firstorder] and [\ref=conclusion], below. Before doing so, however, we give an example that shows that care must be taken when using such a method to estimate critical points.

Illustrative Example

We give an example showing that small perturbations may cause critical points to move great distances. Consider

[formula]

where

[formula]

with 1 > ε > 0, which implies that 0 < a < 1. Thus, we can write

[formula]

and conclude that

[formula]

and that f(t) has a unique maximum at t = 0: f(0) = 1. Furthermore,

[formula]

which attains its maximum absolute value at [formula]:

[formula]

in other words,

[formula]

Now let

[formula]

where b: = 1 / ε, be a perturbation to f(t). Since

[formula]

it is a small perturbation. Also,

[formula]

and we see that g'(t) > 0 for t  ≤  0. Hence, h(t): = f(t) + g(t) is such that

[formula]

and the perturbed function, h, has no negative critical points.

Since for 0  ≤  t  ≤  b / 2, it follows that

[formula]

and, consequently,

[formula]

In other words, any critical points of the perturbed function, h(t), must be greater than b / 2 = 1 / (2ε), which can be arbitrarily large and distant from the original critical point of f(t), which is at t = 0.

First-order estimates

As illustrated in the above example, it is important to understand what is happening if one estimates a critical point by using Taylor series in this way. A critical point, c, of f(t) is a root of its derivative, f'(t). In the expectation that this critical point is near t = 0, it is reasonable to estimate f(t) by its Taylor series about t = 0,

[formula]

Differentiating, we get

[formula]

and the estimate of the critical point is obtained by setting expression ([\ref=fprimet]) to zero and solving for t to get

[formula]

which is analogous to expression (65) of [\cite=BD1]. Notice that this is one iteration, c = t1, of Newton's method for finding a root of f'(t) with t0 = 0 as starting point. Hence the relevant error estimates are those for Newton's method.

([\cite=ostr], p. 56) Suppose that Newton's method is applied to the function F(t) with starting point t0 to obtain the estimate t1 of the true root t = z. Then

[formula]

for some η between z and t0.

If |t0 - z| is "small" then we may refine this error bound as follows. In this case η  ≈  z so that

[formula]

which we may regard as approximately constant, provided [formula] Furthermore, we may expand

[formula]

so that

[formula]

Hence we arrive at, under suitable technical assumptions, that

[formula]

where C is a constant that depends on F, z and t0. Notice that this is a restatement of the fact that Newton's method is quadratically convergent. But we must be careful; estimate ([\ref=NewtonError]) is local in nature -- it depends strongly on the assumptions that t0 is already close to z and that F'(z) is not close to 0. If this is not the case, then there is nothing reasonable to say about |t1 - z|. Figure [\ref=fig1] illustrates this problem.

Returning to our problem, we use F(τ): = ∂τ{γ(τ) + δγ(τ)} with τ0 = 0, so that

[formula]

[formula] of expression ([\ref=truedeltatau]). Hence we conclude that indeed estimate ([\ref=truedeltatau]) does provide a first-order approximation to the delay, provided that the true critical point is close to zero and that ∂ττγ(0) + ∂ττδγ(0) is not close to zero.

Conclusion: Why estimate ([\ref=65]) is of first order

We consider the difference between expression ([\ref=truedeltatau]), which we know to be first-order, and estimate ([\ref=65]) of [\cite=BD1], which we wish to show is also first-order. In fact we claim that the difference between these two expressions is of second order, from which our claim follows. Specifically, we have

[formula]

Following expression ([\ref=deltagamma]), we write which we rewrite symbolically as

[formula]

Herein and below, C1,C2, etc. stand for generic constants.

Taking the derivative, we have which we rewrite symbolically as

[formula]

Differentiating again, we have

[formula]

Using estimates ([\ref=deltasbnd1]) and ([\ref=deltasbnd2]) in expression ([\ref=diff1]), we have, for sufficiently small |δs| and [formula]

[formula]

which means that the difference between the first-order estimate ([\ref=truedeltatau]) and estimate ([\ref=65]) of [\cite=BD1] is second-order in δs. Hence, we conclude that estimate ([\ref=65]) is indeed a first-order estimate.

To demonstrate that estimate ([\ref=65]) is of the first order, we remained in the context of steps (58) to (65) of [\cite=BD1], which are expressions ([\ref=58]) and ([\ref=65]), herein. There is no need to anticipate Fréchet derivatives that are to result from this derivation; in other words, there is no need to let δγ tend to zero, as suggested by Nolet (2009, pers. comm.). Hence, the formulation herein, albeit technical, strengthens the first-order validity of estimate ([\ref=65]) of [\cite=BD1].

Acknowledgments

The authors are grateful for discussions with Qinya Liu, Tarje Nissen-Meyer, Daniel Peter, Michael Rochester and Jeroen Tromp, for email comments of Adam Baig, Shu-Huei Hung and Guust Nolet, for editorial help of David Dalton, for help of Frederik Simons in making Tony Dahlen's notes available. MS's research was supported by the Natural Sciences and Engineering Research Council of Canada, and a part of his work was done at Princeton University during a sabbatical year. The authors are grateful for the encouraging atmosphere at Casaleggio, where the ideas presented came to fruition.