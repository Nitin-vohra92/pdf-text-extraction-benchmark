Adiabaticity Conditions for Volatility Smile in Black-Scholes Pricing Model

Introduction

One of the simplest "products" on the derivative financial market is the European call (put) option [\cite=Hull] [\cite=Wilmott]. Considering the risk neutral approach, the price of the European call option, [formula], is defined by

[formula]

where ST is the stock price at time t  =  T, K is the strike price of the option, T is the expiration time (time to maturity) of the option, r is the interest rate and P(ST)  ≥  0 is the distribution function of the stock prices in a "risk-neutral world" ([formula]).

Eq. ([\ref=pricing_risk_neutral]) is too general since it does not place any restrictions on the underlying stock price distribution function, P(ST). To calculate explicitly the option price, C, using Eq. ([\ref=pricing_risk_neutral]), one must know the distribution function, P(ST). Consequently, one must make some assumptions about the stock prices. An important achievement in the theory of option pricing is the Black-Scholes (BS) theory which gives analytic solutions for the European call and put options [\cite=Black].

In particular, for the European call option, a solution of the BS equation is given by Eq. ([\ref=pricing_risk_neutral]), if one assumes for the distribution function, P(ST), a log-normal distribution,

[formula]

where x  =   ln (ST / S(t))  -  r(T - t) is the logarithmic return deprived of the risk-free component, S(t) is the stock price at time t and σ is the stock price volatility. For seek of simplicity, in the following we consider t  =  0 and we define [formula]. Substituting Eq. ([\ref=normal_dist]) in ([\ref=pricing_risk_neutral]) an explicit expression for the price of the European call option which satisfies the BS equation [\cite=Black] is obtained,

[formula]

where

[formula]

The distribution function ([\ref=normal_dist]) follows from a stochastic model for stock prices,

[formula]

where dz is a Wiener increment [\cite=winer_note]. It can be shown it is never optimal to exercise an American call option on a non-dividend-paying stock early [\cite=Hull],  [\cite=Bouchaud]; therefore Eq. ([\ref=BS_solution]) can also be used to estimate the fair value for this kind of options.

There are some problems with the expressions for C given by Eqs. ([\ref=pricing_risk_neutral])-([\ref=BS_solution]). Indeed, one can derive any option price from Eq. ([\ref=pricing_risk_neutral]), using different assumptions about the distribution function, P(ST). To derive from Eq. ([\ref=pricing_risk_neutral]) a result for C which will even approximately coincide with the real market price, CM, one must specify a distribution function for future stock prices, P(ST). On the other hand, the expression given by ([\ref=BS_solution]) is (a) too specific, and (b) derived using rather strong restrictions. Namely, the stochastic process Eq. ([\ref=log_norm]) does not account for correlations of returns, x and, moreover, the volatility, σ, and the interest rate, r, are not well-defined parameters (given the actual data). As a result, the expression, CBS, often does not coincide (even approximately) with the corresponding market option price, CM. Useful approaches have been developed which partially solve the problems mentioned above.

We shall mention here one analysis which is related to that presented below. This analysis deals with building "implied trees" [\cite=Jack_rev]. There are many variations of this approach, but the main idea is based on the solution of the inverse problem: a search for a stock price model that corresponds to the real market prices of options, CM. A more restricted problem is to search for a stock price model that effectively deals with the volatility smile.

In this case, one starts with the BS formula ([\ref=BS_solution]), (even for American options) but instead of choosing a fixed volatility, σ  =  constant, one uses the dependence, σ  =  σ(K) (volatility smile). To some extent, this dependence corresponds to the "real behavior" of the volatility, σ, if one wants to use Eq. ([\ref=BS_solution]) as the "zeroth approximation" for option pricing. Details for building trees (including implied trees) for stock prices can be found in [\cite=Derman_1] [\cite=Dupire] [\cite=Derman_2] [\cite=Rubinstein].

There are still some problems with these trees. For example, the corresponding "implied" stock prices, ST, can have "bad" (negative) probabilities which must be eliminated. A solution to this kind of problem, despite the simplicity of the calibration procedure, was proposed in Refs [\cite=Jack] [\cite=Herwing].

In this paper, we discuss the inverse problem for Eq. ([\ref=pricing_risk_neutral]) using the following approach. First, using Eq. ([\ref=pricing_risk_neutral]), we build the distribution function for future stocks prices and returns from the empirical data for the market option prices, C(K). Second, we build the returns distribution functions using for C(K) a BS expression, CBS, with a volatility, σ  =  σ(K), in the form of the volatility smile. In particular, we show that the condition of the absence for relative minima in the probability distribution function (PDF) of returns, (or elimination of "bad" probabilities) leads to the condition of "adiabaticity" for the volatility smile. This condition can be introduced in the fitting procedure of the volatility smile to get a probability returns distribution more similar to the actual one. In this way one can avoid to generate arbitrage opportunities (negative probabilities) in the option pricing methodology (exotic derivatives) and can get a more reliable estimation of the implied volatility. The latter has a key role in the scenario generation and in value at risk (VaR) estimation and has application in the risk management activities.

The Inverse problem for the stock price distribution function

In this Section, we derive an explicit expression for the distribution function for the future stock prices, P(ST) and for returns P(x). In Eq. ([\ref=pricing_risk_neutral]) the distribution function, P(ST), can be rather arbitrary but it is natural to assume that P(ST) does not depend on the strike price, K. According to Eq. ([\ref=pricing_risk_neutral]), the option price, C, is expressed explicitly through the strike price, K. Differentiating C in Eq. ([\ref=pricing_risk_neutral]) twice with respect to K, we have [\cite=Malz],

[formula]

In Eq. ([\ref=price_distr]), we indicate only the dependence C(K) in the option prices. In particular, applying Eq. ([\ref=price_distr]) to CBS given in Eq. ([\ref=BS_solution]) we derive a distribution function, PBS(ST), which we present in the form,

[formula]

Analogously, the distribution of returns for the Black-Scholes model is Gaussian, as expected:

[formula]

where x0  =  σ2 / 2T.

We can try to consider the inverse problem substituting the dependence, σ  =  σ(K), in Eq. ([\ref=BS_solution]) and evaluating the distribution of future stocks price and returns, applying ([\ref=price_distr]). After differentiation we get:

[formula]

where we defined:

[formula]

Obviously, we can get the expression for the distribution of returns by a simple change of variable

[formula]

so that,

[formula]

where, in a similar way, we have defined:

[formula]

From ([\ref=perturb_fact]) it is clear that if σ is constant ([\ref=distr_price_pert]) and ([\ref=distr_ret_pert]) are the distributions for the standard Black-Scholes model; we will call them "zeroth-approximation" distributions. If σ  ≠  const, the term F(x;r,T,σ) could "perturb" the relative zero approximation (Gaussian) giving rise to distributions that cannot fit real data. As we will show here, it is possible to get distributions with relative minima (not observed in real returns distributions) and, in the worst case, negative probability.

The rest of the paper is organized as follows. In Section [\ref=real_data], we analyze FX market data and we propose a suitable function to fit the volatility smile. We also determine the typical range of the parameters we use to perform the fit. We will use these ranges to check our adiabatic condition. In Section [\ref=intuitive_explanation], we show qualitatively the reason why we have the presence of the relative minima in the returns distribution and why an adiabatic approach can be suitable to describe the problem and used to avoid these "bad" probabilities. In Section [\ref=results], we show our numerical and theoretical results about the adiabaticity parameter. We also show that there is a critical value of the adiabatic parameter which can be used to determine whether the returns PDF will have relative minima. We discuss the relation of this critical value to the other parameters of the fit. Finally, in Section [\ref=conclusions] we present our conclusions.

The Volatility Smile: Real Market Data

Typically, traders on option markets and practitioners consider the BS model as a zeroth order approximation that takes into account the main features of options prices. To get a pricing closer to the actual data, they consider the volatility as a parameter that can be adjusted considering the inverse problem given by Eq. ([\ref=BS_solution]) and the real price of call and put options. In this way a more reliable value of the volatility (implied volatility) can be obtained and it can be used to price more complex options for which analytical solutions are not available. The value of the implied volatility depends on the value of the strike, K, in a well-known characteristic curve called the smile volatility (typically for foreign currency options) whose shape is approximately parabolic and symmetric, or skew volatility (typically for equity options) when asymmetric effects dominate [\cite=Risk] [\cite=Tompkins] [\cite=Toft] [\cite=Campa].

An intuitive explanation of this shape can be found if an actual returns distribution is considered. In fact, it is well known that the tails of the returns PDF are not Gaussian but exhibit a power law decay (fat-tails) [\cite=Sorn] [\cite=Stan]. On the contrary, BS model assumes that the PDF of returns is Gaussian thus underestimating the actual probability of rare events. To compensate for this model deficiency, one has to consider the greater implied volatility for strike out of the money then for strike at the money.

In this paper we focus our attention on the volatility smile of foreign currency options and we neglect the skew effect [\cite=Kirch]. To perform our analysis we consider the volatility smile as a function of the Δ of the option (defined by Eq. ({[\ref=delta])), the time to maturity, T, and the currency considered. We consider specific days, for which volatility is not affected by the skew effect, and we use Bloomberg as data provider. In the BS model, the Δ of a call options is defined as:

[formula]

Inverting this relation is possible to get an expression for x:

[formula]

where Φ- 1(x) is the inverse of the error function:

[formula]

In Fig. [\ref=figfitsmile] we show an example of volatility smile in terms of our variables and a suitable fit given by the function:

[formula]

where g,χ,n are fitting parameters. In this case, g represents the minimum of the volatility smile, [formula] is the half width at the half height, while g(χ  -  1) represents the height of the smile. In particular χ is the ratio between the limiting value of σ and g as x approches ∞  . In this way the variation of σ is bounded between g and gχ. In the light of the intuitive explanation of the volatility smile proposed above and since from ([\ref=distr_BS]) it follows that the average value,

[formula]

one expects that the minimum of the implied volatility occur at x  =   - g2T / 2 as required by our fitting function.

Repeating many times the interpolation procedure considering different values for T and currencies, we can determine typical parameters that can fit a wide range of volatility smiles; in the following we will use this information to check our results.

Let us notice that the following relation between n,g and T holds:

[formula]

as shown in Fig. [\ref=n_scaling]. This gives a scaling rule that can be used to determine the range of n, fixing T and g.

First Approximation of the Volatility Smile: the Squared Well

In this Section we show qualitatively the reason why there is a relative minimum in the returns distribution and why an adiabatic approach can describe the problem of avoiding these "bad" probabilities. To keep the problem simple, we consider, as a first step, a volatility smile modeled by a squared well defined as follows:

[formula]

where σ2  >  σ1 and x1 are positive constants. See Fig. [\ref=sigma_pdf_sq]a,b. The distribution functions corresponding to two values of σi, i = 1,2 are shown in Fig. [\ref=sigma_pdf_sq]c,d. Indicating as ±  xc1 the abscissa of the intersections between the two distributions, it is clear that a sufficient condition for avoiding spurious minima is x1  <  xc1. A rough estimation of xc1, ignoring the term, x0, usually small, is

[formula]

where χ  =  σ2  /  σ1. Therefore, a sufficient condition to avoid minima in the PDF is to use, as a fitting function a square well depending on the parameters x1,σ1,σ2, such that x1  <  xc1. Therefore, a standard fitting procedure of the volatility smile with a square well, constrained by the condition x1  <  xc1 solves the problem of avoiding spurious minima, even if is very rough.

If we consider a volatility smile with a continuous variation from σ1 to σ2, we can get, instead of a discontinuity, the onset of a relative minimum. The latter can be avoided if the variation between σ1 and σ2 is slow enough so that the connection between the two PDF's takes place keeping constant the sign of the first derivative of the distribution during the whole transition. So there will be a critical "speed" of the transition that will generate zero derivative points which will not correspond to the maximum of the distribution. In this case the variable related to the time is x1, while χ  =  σ2  /  σ1 can be identified as a "distance". To be more precise, one should consider that for x  <  xc1, Pσ1(x)  ≥  Pσ2(x), so that the effective "time" should be: x1  -  xc1. We will define an adiabatic transition as one whose passage from σ1 to σ2 is sufficiently slow, so that relative minima in the distribution are not generated. In this same spirit, we define the critical adiabatic parameter χc(n,g,T) as the minimum value of χ that generates a minimum in the distribution, Eq. ([\ref=distr_ret_pert]). This effect has been shown in Fig. ([\ref=blu_green_map]), modeling the volatility smile using ([\ref=sigma_fit]), so that σ1  =  g, σ2  =  gχ. We fix the parameters g,T and we vary n and χ, seeking relative minima in the PDF. The lines in Fig. [\ref=blu_green_map], obtained respectively at fixed T (a) and fixed g (b), divide the plane of parameters into two regions: to the left of the lines the PDF has spurious minima, while this does not happen in the region to the right of it. It is then clear that for a given set of fixed parameters (g,T), there is a relation between χ and n that allow one to obtain a PDF without minima (minima are not observed in real data). The main goal of this paper is to determine a simple relation that determines whether or not the parameters of a volatility smile fit are consistent with real returns distribution and if they could give a reliable option pricing.

Numerical and Theoretical Results

In this Section we show our numerical and theoretical results about the relation between the set of parameters n,g,T and the critical adiabatic parameter χc. Using a numerical simulation, we kept fixed n,g,T and we continuously increased the parameter χ until we found a zero-derivative point for some x  ≠   - g2T / 2. In this way we could determine numerically the critical χc. We repeated this approach for a wide range of the parameters values, as shown in Table [\ref=tiptab], where we used the parameter ρ  =  n / g2T instead of n, due to the scaling relation ([\ref=n_scaling_rule]). In order to obtain the relation χc  =  fT(n,g), we use the following fit function:

[formula]

This has been obtained assuming that the value of the critical parameter χc depends on the rescaled "time" of the transition (in our model given by ρ). We also consider a further term [formula] to take into account the time correction, xc, as explained in Sec. ([\ref=intuitive_explanation]). In this case we make explicit the dependence of the time correction on T and g as suggested by σ2 in Eq. ([\ref=inter_point]). In Eq. ([\ref=fitf]), α,β,γ,δ are the fitting parameters whose values are given in Table [\ref=tab2].

In Fig. [\ref=fit_ex] we show the result of our fit for a few selected values of g and T.

The whole procedure can thus be summarized as follows :

The real volatility smile, usually given for a fixed T can be fit by a function dependent on three parameters g,n,χ, as indicated in Eq. ([\ref=sigma_fit]) and the optimal values gopt,nopt,χopt are returned.

The optimal values gopt,nopt are inserted in Eq. ([\ref=fitf]), with α,β,γ,δ given in Table II and a critical χc  =  fT(nopt,gopt) obtained.

If χopt  <  χc then we know that relative minima in the PDF do not exist. Otherwise we should perform a fitting procedure to the volatility smile using Eq. ([\ref=sigma_fit]), constrained by χ  ≤  χc.

An example of the previous procedure has been shown in Fig. [\ref=ultima] where the PDF with unwanted minima and the "corrected " one is shown together with the corresponding fitting curve to the volatility smile. As one can see the price to pay in order to get a smooth PDF is very small: the two fitting curves for the real volatility smile are similar, but the PDF has, in the latter case a more realistic behavior.

Conclusions

We started from the pricing equation of the Black-Scholes model for an European call and we considered a suitable generalization to include the volatility smile effect. Then we considered the inverse problem and we analyzed the relative returns distribution, Eq. ([\ref=distr_ret_pert]), varying the typical parameters of the volatility smile. We showed that, for some values of the parameters, it is possible to get relative minima in the returns distribution (bad distribution) that are never observed in real distributions. We demonstrated that bad distributions can be eliminated by requiring adiabatic constraints (intuitively justified with the example of the squared well) on the volatility smile and we gave a numerical formula to determine the value of the adiabatic critical parameter, χc. In this way we provide an easy-to-use tool to determine if a volatility smile fit is consistent with the model hypothesis (P(x)  >  0) and if it can generate a suitable returns distribution. A reliable estimate of the implied volatility has application in the risk management activities and in the pricing of exotic derivatives, where, in general, the implied volatility is an input of more complex models.

Acknowledgements

The work by GPB was carried out under the auspices of the NNSA of the U. S. DOE at LANL under Contract No. DEAC52-06NA2539.