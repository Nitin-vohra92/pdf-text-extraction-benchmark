Observation Proposition Theorem Corollary

Definition Remark

Balances and Abelian Complexity of a Certain Class of Infinite Ternary Words

Laboratory of Physics, Kochi University of Technology Tosa Yamada, Kochi 782-8502, Japan email: ondrej.turek@kochi-tech.ac.jp

Introduction

The balance property is a notion connected with Sturmian words from very first beginning of their investigation. In [\cite=morse2], Sturmian words were defined as aperiodic words with the smallest possible factor complexity. Already in the same article, Hedlund and Morse observed that Sturmian words show also the smallest discrepancy in occurrences of letters. To quote precisely their result, let us denote by |w| the length of the word w and by |w|a the number of occurrences of letter a in w. Hedlund and Morse proved that an infinite aperiodic word u over the alphabet {0,1} is Sturmian if and only if for all pairs w, v of factors of u with |w| = |v| it holds ||w|0 - |v|0|  ≤  1. Let us note that the letter 0 is not preferred as in binary alphabet the relations |w| = |v| and ||w|0 - |v|0|  ≤  1 imply the inequality ||w|1 - |v|1|  ≤  1 as well.

During past 70 years many other characterizations of Sturmian words have appeared, for their overview see [\cite=lothaire]. Each of these characterizations may serve and serves for generalization of Sturmian words to multiliteral alphabets, cf. [\cite=BaPeStar]. Nevertheless, the balance property seems to be the most complicated to deal with. Only a few results are known about words satisfying the so-called c-balanced property.

Let us recall that an infinite word u over an alphabet A is c-balanced if for all letters a∈A and all pairs v,w of factors of u with |v| = |w| it holds ||v|a - |w|a|  ≤  c. Note that Sturmian words are 1-balanced in this terminology. The set of c-balanced words differs substantially from all other generalizations of Sturmian words. Neither generic Arnoux-Rauzy word nor generic word coding interval exchange transformation are c-balanced, see [\cite=CaFeZa] and [\cite=Ad2002].

In [\cite=adamczewski], Adamczewski studies whether fixed point of a primitive substitution is c-balanced for some constant c. He shows that the existence of such c depends only on the spectrum of the incidence matrix of the substitution. However, the minimal value of c cannot be deduced from the spectrum. In [\cite=turek] and [\cite=BPT], the minimal value of c is determined for binary fixed points of canonical substitutions associated with quadratic Pisot numbers. The notion "canonical substitution associated with a number β > 1" comes from positional numeration systems with the base β, see [\cite=fabre]. Generally speaking, it is a very complicated problem to determine minimal value c for a ternary balanced word, let alone for words over alphabets of higher cardinalities. Despite a common belief that the Tribonacci word is 2-balanced, the first proof of this fact has appeared just one year ago in [\cite=RSZ] (the Tribonacci word is the fixed point of the substitution A  ↦  AB, B  ↦  AC, C  ↦  A). In this article we provide minimal value of c for a certain class of ternary words, namely for fixed points of substitutions

[formula]

with the parameter p > 1. These substitutions are canonical substitutions associated with cubic Pisot numbers β > 1, roots of polynomials x3 - px2 - x + 1 (cf. [\cite=KP]). Let us recall that the Tribonacci substitution is associated with a numeration system as well.

The definition of a 1-balanced word may be reformulated equivalently using Parikh vectors. Inspired by this fact, Richome, Saari and Zamboni introduced the Abelian complexity [formula] of infinite word. In their notation, Sturmian words are aperiodic words with [formula] for all [formula]. The question on existence of words with constant Abelian complexity is natural. It was shown in [\cite=CR] that for k  ≥  4 no words with [formula] exist. On the other hand, words with [formula] can be found in [\cite=RSZ2].

The relation between Abelian complexity and balance property is not straightforward. It is easy to see that an infinite word u is balanced if and only if its Abelian complexity is bounded. Moreover, if the Abelian complexity of u is bounded by k, then u is k - 1 balanced. The Tribonacci case shows that the opposite implication is not valid: according to [\cite=RSZ], the Abelian complexity of the Tribonacci word takes all values in the set {3,4,5,6,7}. The fixed point of the substitutions [\eqref=nase] studied in this article has the same property.

Preliminaries

Let A be a finite alphabet. A concatenation of letters in A is called a word. The set A* of all finite words over A equipped with the empty word ε and the operation of concatenation is a free monoid. The length of the word w∈A*, denoted by |w|, represents the number of its letters.

One may also consider infinite words [formula]; the set of infinite words over the alphabet A is denoted by [formula].

A word w is called a factor of v∈A* or [formula] if there exist words w(1)∈A* and w(2)∈A* or [formula], respectively, such that v = w(1)ww(2). The word w is called a prefix of v, if w(1)  =  ε. It is a suffix of v, if w(2)  =  ε.

Let [formula]. For [formula], the symbol wk denotes the concatenation [formula]. We set w0  =  ε. Let a word v∈A* have the prefix wk, [formula]. Then the symbol w- kv denotes the word satisfying wkw- kv = v. Similarly, if a word [formula] has the suffix wk for a [formula], then vw- k denotes the word with the property vw- kwk = v.

A morphism on the free monoid A* is a map φ:A*  →  A* satisfying φ(vw) = φ(v)φ(w) for all v,w∈A*. Obviously, the morphism φ is determined if we define φ(a) for all a∈A.

A morphism φ is called a substitution, if φ(a)  ≠  ε for all a∈A and if there is an a'∈A such that |φ(a')| > 1. An infinite word u is said to be a fixed point of the substitution φ, or invariant under the substitution φ, if

[formula]

If we naturally extend the action of φ to infinite words, we may rewrite [\eqref=eq:word] simply as φ(u) = u.

Balance properties

An infinite word u is c-balanced, if for every a∈A and for every pair of factors v, w of u such that |v| = |w|, it holds [formula]. This property determines the discrepancy of occurrences of letters in the word u. However, it turns out that if the cardinality of A is higher than two, it is useful to have more detailed information, namely what is the discrepancy of occurrences of each particular letter. For this purpose we introduce the following notion:

Abelian complexity

Let us consider an alphabet A with k elements, i.e. [formula], and an infinite word u over A. For any factor w of u, its Parikh vector is the k-tuple [formula]. Let the symbol Fu(n) denote the set of all factors of u of the length n. Then the Abelian complexity of the word u is a function [formula] defined by

[formula]

On the right hand side of [\eqref=AC] there is the cardinality of the set of Parikh vectors of all factors of u of the length n. In the sequel we will denote this set by Pu(n), i.e.

[formula]

On the word studied in this paper

From now on, we will focus on a special class of substitutions on the ternary alphabet {L,S,M}. For any integer p > 1, we denote by φp the substitution given by

[formula]

The substitution φp has a unique fixed point, namely

[formula]

If the results of [\cite=adamczewski] are applied on u(p), one finds out that there is a constant c such that the word u(p) is c-balanced, but it is not known what the value of c is and how it depends on p. This is the main aim of this paper - to determine c.

The fact that u(p) is balanced immediately implies that the Abelian complexity function of u(p) is bounded, see Introduction. The second aim of this paper is thus to find the optimal bound for [formula].

Main result and the proof outline

We begin by the formulation of the main result of the paper.

Let u(p) be the infinite word invariant under the morphism φp given by [\eqref=varphi]. Then u(p) is

3-balanced with respect to the letter L,

2-balanced with respect to the letter S,

2-balanced with respect to the letter M,

and none of these bounds can be improved.

The theorem has the following trivial consequence:

Since the proof is long and slightly complicated, we will split it into four sections and proceed in the following way:

We prove that u(p) is 2-balanced with respect to the letter M.

We prove that u(p) is 2-balanced with respect to the letter S.

We prove that u(p) is 3-balanced with respect to the letter L.

We show that none of the bounds can be improved.

Properties of the word u(p)

As we have explained in Preliminaries, the word u(p) is a fixed point of φp, i.e.

[formula]

In this sense each letter of u(p) can be regarded as the image, or a factor of the image, of another letter of u(p). In view of the definition of φp, cf. [\eqref=varphi], each segment φp(uj) has the structure LkY for k∈{0,p - 1,p} and Y  ≠  L. The letters S and M are thus "terminating symbols" which cut u(p) to images of individual letters. This fact is particularly important when a factor v of u(p) is given and one needs to find a factor x of u(p) such that φp(x) = v. It holds:

Any of the conditions (i), (ii) and (iii) together with Y∈{S,M} ensures that vY is an image of certain factor x, and it is obvious from the definition of φp that φp(x) = φp(y)  ⇒  x = y.

The following observation describes the possible neighbours of each of the letters L,S,M in the word u(p).

(i) Each S is the last letter of φp(uj) for uj = L or uj = M according to Observation [\ref=pripustneVzor], i.e. it is the last letter of the block LpS or Lp - 1S, thus is preceded by L. The letter S is followed by the first letter of φp(uj + 1), which can be either L or M (cf. the substitution rule φp). (ii) Each M is equal to φp(uj) for uj = S. We already know from (i) that uj - 1 = L and uj + 1∈{L,M}, therefore the M is preceded by the last letter of φp(L) (which is S) and followed by the first letter of φp(L) or φp(M) (which is L).

In order to understand the structure of the word u(p), it is useful to describe possible segments z in factors of u(p) of the type SzS and MzM. This is done in the next two observations.

Observations [\ref=JednozVzor] and [\ref=pripustneVzor] imply that [formula], where [formula] is a factor of u(p) the last letter of which is either L or M and which is preceded in u(p) by either L or M.

Since [formula] contains only one S, namely its last letter, all letters of [formula] except the last one have to be different from L and M. Therefore [formula], where X∈{L,M} and [formula].

Taking into account Observation [\ref=pripustne], we infer that k = 0 or k = 1. Therefore only four situations are possible: [formula], [formula], [formula], [formula]. Moreover, since [formula] is preceded by either L or M, it cannot hold [formula], cf. Observation [\ref=pripustne]. Therefore [formula] is equal to one of the factors L, SL, SM, which implies that z is equal to one of the factors Lp, MLp, MLp - 1.

It follows from Observations [\ref=JednozVzor] and [\ref=pripustneVzor] that MzM = φp(Sz'S), where Sz'S is a factor of u(p) such that |z'|S = 0. Therefore z = φp(z') and, according to Observation [\ref=SzS], z'∈{φp(Lp),φp(MLp),φp(MLp - 1)}.

Many times we will need to compare the number of letters L,S,M in a factor of u(p) and in its image. The substitution rule [\eqref=varphi] leads to the equalities

[formula]

which can be inverted subsequently:

For any factor v of u(p) it holds

[formula]

Balance bound with respect to the letter M

We begin the proof of Theorem [\ref=balance] by its second statement, i.e. we show at first that u(p) is 2-balanced with respect to the letter M. As we will see, the determination of the balance bound with respect to the letter M is by far the most complicated part of the work.

Let v, w be factors of u(p) such that |v| = |w|. Then

[formula]

Proof of Theorem [\ref=balanceM]

We will proceed by contradiction. Let us assume that there exist factors v, w of u(p) such that |v| = |w| = n and

[formula]

Let n be the minimal number with this property.

We denote [formula], [formula]. The minimality of n implies

If we apply Observations [\ref=JednozVzor] and [\ref=pripustneVzor], Eq. [\eqref=vMM] implies that the factor v is an image of certain factor of u(p) whose first and last letters equal S. This allows us to define a factor f of u(p) in this way:

[formula]

The factor w is not ready for a direct application of Observation [\ref=JednozVzor] because of [\eqref=wxMxM]. For that reason we at first extend the factor w to both sides up to the closest letter M, i.e. we put

[formula]

where w' is a factor of u(p) and |w(1)|M = |w(2)|M = 0. Now we can define a factor g of u(p) by the relation

[formula]

Let us show that the factor g is shorter than v and w:

It holds |g|  ≤  n - 2(p2 - 1).

Since |v|M = |w|M + 3, the factor v contains at least 3 letters M, and thus [formula]. Observation [\ref=MzM] then implies that |v|  ≥  1 + (p2 + p - 1) + 1 + (p2 + p - 1) + 1 = 2p2 + 2p + 1.

Since |w| = |v|, it holds |w|  ≥  2p2 + 2p + 1, hence necessarily [formula] according to Observation [\ref=MzM]. But then |v|M  ≥  4 and

[formula]

where |z(1)|M = |z(2)|M = 0 and |z(j)|  ≥  p2 + p - 1 for j = 1,2.

One more application of Observation [\ref=MzM] gives |v|  ≥  1 + (p2 + p - 1) + 1 + (p2 + p - 1) + 1 + (p2 + p - 1) + 1 = 3p2 + 3p + 1, hence |w|  ≥  3p2 + 3p + 1 and necessarily [formula], i.e.

[formula]

where |ŵ(1)|M = |ŵ(2)|M = 0.

We deduce from Eqs. [\eqref=vMMM], [\eqref=wMMM], from |z(j)|  ≥  p2 + p - 1 and from the minimality of n that |ŵ(j)|  ≥  p2 + p, j = 1,2.

The factor w' (cf. [\eqref=defw'] and [\eqref=wMMM]) is given by w' = Mw(1)ŵ(1)MŵMŵ(2)w(2)M, hence Equality [\eqref=g] together with Observation [\ref=pripustneVzor] imply

[formula]

where φp(g(1)) = w(1)ŵ(1), φp(g(2)) = ŵ(2)w(2) and φp(SĝS) = MŵM. Hence |g(1)|S = |g(2)|S = 0, and consequently, using Observation [\ref=SzS], |g(1)|  ≤  p + 1 and |g(2)|  ≤  p + 1. The sought inequality |g|  ≤  n - 2(p2 - 1) follows from these relations:   |g| = |g(1)SĝSg(2)| = |g(1)| + |SĝS| + |g(2)|  ≤  2(p + 1) + |SĝS|.

Factors f, g satisfy

Both relations will be proved using the properties of v, w'. Let us begin with Eq. [\eqref=f] [\eqref=g_S]. Considering Proposition [\ref=vzor], we have

[formula]

Moreover, |w'|M = |Mw(1)ww(2)M|M = |w|M + 2. Therefore, taking into account Eq. [\eqref=vw3M], we obtain

[formula]

Now we proceed to Eq. [\eqref=*]. It holds |φp(z)| = (p + 1)|z|L + |z|S + p|z|M for any factor z (cf. the substitution rule [\eqref=varphi]). The identity |z| = |z|L + |z|S + |z|M allows one to eliminate |z|L, hence

[formula]

Since |v| = |w| and |w'| = |Mw(1)ww(2)M|  ≥  |w| + 2, we have |v| - |w'|  ≤   - 2, equivalently |φp(SfS)| - |φp(SgS)|  ≤   - 2. If we apply [\eqref=varphi(z)] to the last inequality, we obtain

[formula]

Now we substitute here from [\eqref=f] [\eqref=g_S] which leads to [\eqref=*].

There is another useful statement, namely Proposition [\ref=f-g<=0], but to prove it we need one more observation which gives an estimate of the number of occurences of the letter M in a factor of u(p) of a given length:

(i) Observation [\ref=MzM] says that if MzM is a factor of u(p), then |zM|  ≥  p2 + p. Consequently [formula]. The inequality [formula] holds trivially. (ii) Let   =  ''' and

[formula]

Then, employing the result of (i), one has [formula].

It holds |f| - |g|  ≤  0, i.e. the factor f is not longer than g.

Let us suppose that the contrary is true, i.e. |f| - |g| = d > 0. Let f' be the suffix of f of the length d and let  = f(f')- 1. Then it holds || = |g| < n (the inequality "< n" is valid due to Observation [\ref=g_kratsi]) and ||M = |f|M - |f'|M.

Our goal is to estimate ||M - |g|M which is equal to |f|M - |g|M - |f'|M. For this purpose an estimate for |f|M - |g|M will be needed; we obtain it from [\eqref=*]: |f|M - |g|M  ≥  (p + 1)  ·  d + 2 - p.

As for |f'|M, since f is followed by S, the last letter of f' is L (cf. Observation [\ref=pripustne]). With regard to this fact, Observation [\ref=obsahM] implies [formula]. Now we distinguish two cases: [formula]  If d = 1, then |f'|M = 0, hence

[formula]

[formula]  if [formula], then [formula], hence

[formula]

We see that for any value of d > 0, the factors [formula] and g of u(p) are of the same length less than n and satisfy [\eqref=unbalance_M]. This is a contradiction with the minimality of n.

At this moment we define another pair of factors. Since SfS and SgS are factors of u(p), Observation [\ref=JednozVzor] says that there exist factors x and y of u(p) such that

[formula]

and

[formula]

It holds |x|  ≤  n - 2(p2 - 3) and |y|  ≤  n - (2p2 - 3), i.e. both factors x, y are shorter that v, w.

We use Propositions [\ref=g_kratsi] and [\ref=f-g<=0]:

[formula]

We remark that one can achieve better estimates, but these will be sufficient.

It holds

The proof of both statements is straightforward using the definitions of x and y, Proposition [\ref=vzor], the identity |v| = |v|L + |v|S + |v|M holding for any factor v, and Equality [\eqref=f] [\eqref=g_S].

Proposition [\ref=vztah_xy] has an immediate corollary:

If we substitute for |f|M - |g|M from [\eqref=xyfg] to [\eqref=xyMfg], we obtain [\eqref=xyMrov]. Equality [\eqref=xyMrov] and Proposition [\eqref=f-g<=0] then give [\eqref=xyMner].

In what follows we split the proof according to the signum of |x| - |y|, and we show that whatever the value of |x| - |y| is, it always contradicts the minimality of n.

We set [formula] and denote ŷ = yy', where y' is a factor of u(p) of the length d such that yy' is a factor of u(p). Then |x| = |ŷ|. Moreover |x| = |ŷ| < n due to Proposition [\ref=x] [\ref=y_kratsi].

Our goal is to estimate |x|M - |ŷ|M which is equal to |x|M - |y|M - |y'|M. The difference |x|M - |y|M can be estimated using Inequality [\eqref=xyMner]: |x|M - |y|M  ≥  d + p.

Let us proceed to |y'|M. Recall at first that φp(y) = gS (cf. [\eqref=y]). Thus the last letter of the factor y is either L or M, which implies, with respect to Observation [\ref=pripustne], that the first letter of y' is either L or S, i.e. different from M. Observation [\ref=obsahM] then gives [formula]. Now we distinguish two cases: [formula]  If d = 1, then |y'|M = 0, hence [formula]; [formula]  if [formula], then [formula], hence

[formula]

The factors x and ŷ are of the same length less than n and for any d > 0 satisfy |x|M - |ŷ|M  ≥  3. In other words, they contradict the minimality of n.

Equality [\eqref=xyMrov] implies |x|M - |y|M =  - (|f| - |g|) + p, and we know from Proposition [\ref=f-g<=0] that [formula]. Therefore: [formula]  If |f| - |g|  ≤   - 1 or [formula], we have [formula]. Since moreover |x| = |y| < n, we have arrived at a contradiction with the minimality of n. [formula]  If |f| - |g| = 0 and p = 2, Equality [\eqref=xyfg] gives |f|M - |g|M =  - 1. This, however, contradicts Inequality [\eqref=*].

The last case to deal with is |x| - |y| < 0. Since the situation |x| - |y| =  - 1 is very complicated to study, we will start with the case |x| - |y|  ≤   - 2 and then deal with |x| - |y| =  - 1 separately.

Let us set for simplicity d = |x| - |y|.

Equality [\eqref=xyfg] gives |f|M - |g|M = d - 1  ≤   - 3. We infer from here and from the minimality of n that |f| < |g| (otherwise one could consider the prefix of f of the length |g|, denote it by [formula], then [formula], [formula], which is a contradiction with the minimality of n).

Similarly, we infer from |x| < y| < n and from the minimality of n that [formula] (otherwise we denote the prefix of y of the length |x| by [formula], then [formula], [formula]). Equality [\eqref=xyMfg] then gives an upper bound on |g| - |f|, namely [formula].

Let us denote  = Sff', where Sff' is a factor of u(p) and |f'| = |g| - |f| - 1. Then [formula] and || = |g| < n, and it follows from [\eqref=f] that if f'  ≠  ε, the factor f' can be chosen such that its first letter is S, i.e. different from M.

Now we are going to express ||M - |g|M which is equal to |f|M - |g|M + |f'|M. Let us distinguish the cases |f'|∈{0,1} and [formula].

[formula]  If |f'|∈{0,1}, we have f' = ε or f' = S, hence ||M - |g|M = |f|M - |g|M = d - 1  ≤   - 3 .

[formula]  Let [formula]. Note that at the same time it holds [formula], thus necessarily d  ≤   - 3. Observation [\ref=obsahM] leads to

[formula]

Then

[formula]

We conclude that for any d  ≤   - 2 it holds || = |g| < n and ||M - |g|M  ≤   - 3. This is a contradiction with the minimality of n.

In this case, Equality [\eqref=xyfg] implies |f|M - |g|M =  - 2 and Equality [\eqref=xyMrov] implies |x|M - |y|M =  - 1 - (|f| - |g|) + p.

Since |x| < |y| < n, necessarily [formula] (the contrary conradicts the minimality of n), hence [\eqref=xyMrov] gives

[formula]

We observe that this case, namely |x| - |y| =  - 1, can occur only for p = 2, because:

If p was greater than 3, Inequality [\eqref=-1fg] would contradict the inequality [formula], derived in Proposition [\ref=f-g<=0].

If p was equal to 3, Inequality [\eqref=-1fg] together with Proposition [\ref=f-g<=0] would give |f| - |g| = 0, which would not conform to [\eqref=*].

This allows us to restrict our considerations on the case p = 2. Inequality [\eqref=-1fg] implies |f| - |g|  ≥   - 1, Inequality [\eqref=*] implies [formula], putting it together we infer |f| - |g| =  - 1. This allows us to use Eq. [\eqref=xyMfg] to compute |x|M - |y|M: we obtain |x|M - |y|M = 2.

Let us sum up the relations between x and y and between f and g:

[formula]

Our next goal is to prove this proposition:

It holds:

The word Lx is a factor of u(p) and at it holds [formula],

the word MLy is a factor of u(p) and at it holds [formula].

Step 1. (Possible prefixes and suffixes of v, w') The following four statements hold:

[formula]   or   [formula],

[formula]   or   [formula],

[formula]   or   [formula],

[formula]   or   [formula].

We have found in the proof of Observation [\ref=g_kratsi] that

[formula]

where |w(j)ŵ(j)|M = 0 and |ŵ(j)|  ≥  p2 + p for j = 1,2. Taking into account Observation [\ref=MzM], we deduce that for p = 2, the prefix of w' and its suffix can be equal to either MLLSLLSM or MLSLLSLLSM, thus (iii) and (iv) are proved.

Statements (i) and (ii) say in fact, with regard to Observation [\ref=MzM], that v cannot have the segment MLSLLSLLSM as its prefix and suffix, respectively. Let us suppose to the contrary that e.g. [formula]. We define  = (MLSLLSLLS)- 1v, then ||M = |v|M - 1. At the same time we denote [formula], where [formula] is the prefix of w of the length 9 (thus |ŵ| = || < n). Since [formula], it follows from Observation [\ref=MzM] that [formula] contains exactly 1 letter M, hence |ŵ|M = |w|M - 1. Therefore ||M - |ŵ|M = 3, which is a contradiction with the minimality of n.

Step 2. (Possible prefixes and suffixes of f, g) It holds

[formula]   or   [formula],

[formula]   or   [formula],

[formula]   or   [formula],

[formula]   or   [formula].

It is a trivial consequence of Step 1 and of the definitions of f and g.

Step 3. (The prefix and suffix of f) It holds [formula].

We show that [formula], the proof of [formula] would be similar.

Step 2 implies that [formula] or [formula]. Let us suppose for a while that [formula]. We put  = M- 1fS (it is a factor of u(p), because fS is a factor of u(p), cf. [\eqref=x]). Then || = |f|, ||M = |f|M - 1.

Since [formula] according to Step 2, we are allowed to set ĝ = gL- 1. Then it holds |ĝ| = |g| - 1, |ĝ|M = |g|M.

The factors [formula] and ĝ satisfy || = |ĝ| < n and ||M - |ĝ|M = |f|M - |g|M - 1 =  - 3, see [\eqref=rozdfg]. This is a contradiction with the minimality of n.

Step 4. (The prefixes and suffixes of v, w' and g) It holds

[formula],

[formula],

[formula].

Statement (i) is a straightforward consequence of Step 3. Statement (ii) follows from (i), which can be proven by contradiction using similar ideas as in the proof in Step 1. Statement (iii) is a consequence of (ii).

Step 5. (The prefixes and suffixes of x and y) It holds

[formula]   or   [formula],

[formula].

(i) Since fS = φ2(x) and [formula] according to Step 3, obviously [formula] or [formula], cf. Observation [\eqref=pripustneVzor] for p = 2. (ii) It follows from Step 4 that [formula]. Observation [\ref=pripustne] implies [formula], Observation [\ref=SzS] gives [formula].

Step 6. (Two letters after y) The word yLS is a factor of u(p).

It is a consequence of Step 5 and Observation [\ref=SzS].

Step 7. (The suffix of x) It holds [formula].

We consider the result of Step 5 and prove that [formula] contradicts the minimality of n. Let [formula]. Observation [\ref=MzM] then implies that x is followed either by SM or by SLLSM. In the first case we define x̂ = L- 1xSM. Taking [\eqref=rozdxy] into account, we see that the pair x̂, y contradicts the minimality of n. In the case when x is followed by the group SLLSM, we define [formula] where [formula] is the prefix of x of the length 2 (i.e. [formula] or [formula]). Also we define ŷ = yLS (this is allowed due to Step 6). The pair x̂, ŷ now contradicts the minimality of n with regard to [\eqref=rozdxy].

Step 8. (The letter before x) The word Lx is a factor of u(p).

Since SfS is a factor of u(p) and fS = φp(x), it follows from Observation [\ref=pripustneVzor] that Lx or Mx is a factor of u(p). However, if Mx is a factor of u(p), then the factors Mx and y contradict the minimality of n with regard to [\eqref=rozdxy].

Step 9. (The prefix of x) It holds [formula].

Since Lx is a factor of u(p) according to Step 8 and [formula] according to Step 5, the word [formula] is a factor of u(p). Observation [\ref=pripustneVzor] then gives [formula].

Step 10. (Two letters before y) The word MLy is a factor of u(p).

Step 5 and Observation [\ref=SzS] imply that LLy or MLy is a factor of u(p). Let us suppose for a while that [formula] is a factor of u(p). Observation [\ref=MzM] implies immediately that [formula]. We introduce the word ŷ = (SLLSM)- 1yLS which is a factor of u(p) due to Step 6. Then we define x̂ = (LS)- 1x, this is a factor of u(p) due to Step 9. It follows from [\eqref=rozdxy] that the factors x̂, ŷ satisfy |x̂| = |ŷ| < n, |x̂|M - |ŷ|M = 3, i.e. they contradict the minimality of n.

This finishes the proof of Proposition [\ref=slozite]. The statement follows from the results of Steps 5, 7, 8, 9, 10.

Proposition [\ref=slozite] together with Observation [\ref=JednozVzor] allow one to define factors r and s of u(p) such that It is obvious that |r|  ≤  |x|, |s|  ≤  |y|, hence |r| < n, |s| < n, cf. Proposition [\ref=x] [\ref=y_kratsi].

Proposition [\ref=vzor] and relations [\eqref=rozdfg], [\eqref=rozdxy] enable us to compute |r| - |s|,

[formula]

and also |r|M - |s|M:

[formula]

The pair r, s thus satisfy |r| = |s| < n and |r|M - |s|M <  - 3. This is a contradiction with the minimality of n.

The proof of Theorem [\ref=balanceM] is completed.

Balance bound with respect to the letter S

Once we know that u(p) is 2-balanced with respect to the letter M, it is easy to prove that it is 2-balanced with respect to the letter S as well.

Let v, w be factors of u(p) such that |v| = |w|. Then

[formula]

We will proceed by contradiction. Let us assume that there exist factors |v|, |w| of u(p) such that |v| = |w| and |v|S - |w|S > 2. Obviously one can suppose that |v|S - |w|S = 3. Then, with regard to the substitution rule [\eqref=varphi], one has

[formula]

hence, using the identities |v|L = |v| - |v|S - |v|M, |w|L = |w| - |w|S - |w|M,

[formula]

Since the factors v and w are of the same length, they satisfy |v|M - |w|M  ≥   - 2 with regard to Theorem [\ref=balanceM], hence

[formula]

Furthermore, since |φp(v)|M = |v|S and |φp(w)|M = |w|S, one has

[formula]

Let ŵ' be a prefix of φp(w) of the length |φp(v)|. Then |ŵ'|M  ≤  |φp(w)|M, hence

[formula]

and since it holds |ŵ'| = |φp(v)|, we have arrived at a contradiction with Theorem [\ref=balanceM].

Balance bound with respect to the letter L

This section is devoted to the proof of the third part of Theorem [\ref=balance]. As we will see, we will use both facts proved in the previous two sections.

Let v, w be factors of u(p) such that |v| = |w|. Then

[formula]

We will again proceed by contradiction. Let us assume that there exist factors |v|, |w| of u(p) such that |v| = |w| = n and

[formula]

Let n be minimal number with this property.

We denote [formula], [formula]. The minimality of n implies

The identity |v| - |w| = |v|L - |w|L + |v|S - |w|S + |v|M - |w|M gives

[formula]

and since |v|S - |w|S  ≥   - 2 and |v|M - |w|M  ≥   - 2 by virtue of Theorems [\ref=balanceM] and [\ref=balanceS], respectively, we infer

[formula]

Note that since v1 = vn = L, Observation [\ref=pripustneVzor] implies that there are [formula] and X∈{S,M} such that [formula] is a factor of u(p). We employ these k and [formula] and define factors v' and w' of u(p) in the following way:

[formula]

Now we can apply Observation [\ref=JednozVzor] which establishes the existence of factors x and y of u(p) satisfying

[formula]

obviously |y|  ≤  |w'| = n - 1.

We are going to compute |x|L - |y|L and |x| - |y|. For that purpose the following relations will be useful: Employing these relations and Propositon [\ref=vzor], one can derive

[formula]

and

[formula]

Since x is shorter than y, we consider the prefix of the factor y of the length |x| and denote it by ŷ; it obviously holds |ŷ|L  ≤  |y|L. Therefore

[formula]

in other words, the factors x and ŷ contradict the minimality of n.

Optimality of the balance bounds

To complete the proof of Theorem [\ref=balance], we have to show that the bounds 3, 2 and 2 corresponding to L, S and M, respectively, are optimal. To demonstrate this fact it suffices to find three pairs of factors of u(p), let us denote them by (v(M),w(M)), (v(S),w(S)) and (v(L),w(L)), such that

There are many possibilities, one can take for example:

v(M) = Mφ2p(SM),  w(M)  =  φ2p(SL)(Lp - 2SM)- 1 Then |v(M)| = |w(M)| = p2 + p + 1,  |v(M)|M - |w(M)|M = 2.

v(S) = L- pφ2p(LL)M- 1,  w(S)  =  φ2p(ML)Lp Then |v(S)| = |w(S)| = 2p2 + 2p + 1,  |v(S)|S - |w(S)|S = 2.

v(L)  =  φ3p(MLp - 1)φ2p(LL)(Lp - 2SM)- 1,  w(L) = SMφ2p(SM)φ4p(SM) Then |v(L)| = |w(L)| = 5p2 + 6p + 5,  |v(L)|L - |w(L)|L = 3.

Abelian complexity

In this section we will determine the optimal bound for the Abelian complexity function [formula] of the infinite word u(p), taking advantage of the results on optimal balance bounds that have been derived in the previous part of the paper.

The set of factors of u(p) of the length n will be denoted by Fu(n), and the symbol Pu(n) will stand for the set of corresponding Parikh vectors, i.e. [formula].

For each [formula] there are numbers [formula] and [formula] such that [formula], where

[formula]

Consequently, [formula].

For each [formula], Theorem [\ref=balanceS] implies that

[formula]

thus there is an [formula] such that

[formula]

Similarly, using Theorem [\ref=balanceM], one finds that there is an [formula] such that

[formula]

Since |v|L = |v| - |v|S - |v|M, we deduce that the set Pu(n) is a subset of [formula], where Ψ(n)j, [formula], are given by [\eqref=mozneParikh].

Proposition [\ref=mozPar] gives an upper bound of [formula], namely [formula] for every [formula], but we can even say more. Indeed, Theorem [\ref=balanceL] implies that Pu(n) cannot contain at the same time Ψ(n)1 and Ψ(n)9, hence [formula]. In fact, the optimal bound is even lower, as we will show with the help of the following proposition.

There is no pair of factors v, w of u(p) such that their Parikh vectors satisfy Ψ(v) - Ψ(w) = (3, - 2, - 1).

We prove the statement by contradiction. Let us suppose that there are factors v and w of u(p) satisfying

[formula]

The factors v and w are obviously of the same length which we denote by n. If [formula] and [formula], we may assume without loss of generality that [formula] (if e.g. v1 = wn, we can replace the pair (v,w) by [formula]). Having this assumption and Eqs. [\eqref=ACLSM], we deduce

[formula]

because if e.g. w1 = L, then the pair [formula] and [formula] contradicts Theorem [\ref=balanceL]. Similarly, Theorem [\ref=balanceS] implies that

[formula]

Let [formula] and X,Y∈{S,M} be such numbers and letters that the word [formula] is a factor of u(p). It is a trivial fact that such [formula], X,Y exist. Moreover, Observation [\ref=pripustne] implies Y = S, Observation [\ref=pripustneVzor] gives [formula]. We take these [formula] and X and define a factor v' of u(p), and then define also a factor w' of u(p): Now we apply Observation [\ref=JednozVzor] which says that there are factors x and y of u(p) such that

[formula]

Let us write down the following relations between v' and v and between w' and w, and use them to express |x|M - |y|M,

[formula]

(note that |x|M - |y|M  ≤   - 3), and also to express |x| - |y|:

[formula]

Statement. It holds

[formula],

w1 = S.

Both (i) and (ii) can be proved by contradiction:

(i) Suppose that e.g. the first letter of y is X  ≠  M. We define ŷ = X- 1y, then |x| = |ŷ| and |x|M - |ŷ|M = |x|M - |y|M  ≤   - 3, which is a contradiction with Theorem [\ref=balanceM]. Similarly we prove that the last letter of y is M.

(ii) Suppose that w1  ≠  S. We know from [\eqref=neL] that also w1  ≠  L, hence w1 = M. Then [\eqref=ACpocetM] gives |x|M - |y|M  ≤   - 3 - p  ≤   - 5. Let Y be the last letter of y and ŷ = yY- 1. Then it holds |ŷ| = |x| and |x|M - |ŷ|M = |x|M - |y|M + |Y|M  ≤   - 5 + 1 =  - 4, which is a contradiction with Theorem [\ref=balanceM].

Statements (i) and (ii) can be used to determine the first three letters of w:

[formula]

However, Observation [\ref=SzS] implies that no factor of u(p) can contain the segment SLp - 1S. This is a contradiction, thus the proposition is proved.

(i) Let u(p) be the fixed point of the substitution φp defined in [\eqref=varphi]. Then its Abelian complexity satisfies [formula] for all [formula] and for all p > 1. (ii) The bound 7 is optimal, i.e. it cannot be improved. Moreover, for any p > 1 there is infinitely many numbers [formula] such that [formula].

(i) Since Ψ(n)1  -  Ψ(n)8 = (3, - 2, - 1) and Ψ(n)2  -  Ψ(n)9 = (3, - 2, - 1), Proposition [\ref=vylucujici] implies that the set Pu(n) can contain at most one of the vectors Ψ(n)1, Ψ(n)8 and at most one of the vectors Ψ(n)2, Ψ(n)9. Therefore Pu(n) has at most 7 elements, hence [formula].

(ii) We prove (ii) by showing that there are infinitely many values [formula] with this property: There are 7 factors of u(p) of the length n such that their Parikh vectors are mutually different.

For all [formula], we define two auxiliary words: Statement. For each [formula] it holds:

(i) v(N) and LpSMv(N) are factors of u(p),

(ii) w(N) and SMLp - 1Sw(N) are factors of u(p),

(iii) v(N) has the suffix SMLp - 1S and w(N) has the suffix LpSM,

(iv) Ψ(v(N)) = Ψ(w(N)).

To see (i), we observe that v(N) is a prefix of φ2N + 2p(LL), thus obviously a factor of u(p). Moreover, since MLL is a factor of u(p) (cf. Observation [\ref=MzM]), the word φ2N + 2p(MLL) is a factor of u(p) as well. Then it suffices to show that φ2N + 2p(M) has the suffix LpSM for each [formula], which can be done easily by induction.

The proof of (ii) is similar: Since φ2N + 1p(L)w(N) is a factor of φ2N + 2p(LSL), w(N) is a factor of u(p). To demonstrate that SMLp - 1Sw(N) is a factor of u(p), it suffices to realize that SMLp - 1S is a suffix of φ2N + 1p(L) for all [formula], which can be shown by induction.

Let us proceed to (iii). By the definitions above, v(N) has the suffix φ2N + 1p(L), w(N) has the suffix φ2Np(L). Now we can use the facts known from (i) and (ii), namely that [formula] and [formula] for all [formula].

The statement (iv) is a consequence of these two equalities:

For each [formula], the auxiliary factors v(N) and w(N) are intrumental to define another set of words that we denote [formula]:

It follows from Statement above that all the words [formula] are factors of u(p) of the same length nN = |v(N)| = |w(N)|. If we compare the numbers of letters L, S and M in these factors, we find that their Parikh vectors and mutually different. This means that [formula] for every n = |v(N)|, where [formula], i.e. the function [formula] attains the value 7 infinitely many times.

We finish this section by two statements describing the lower bound and the range of [formula].

It holds [formula] for all [formula] and for all p > 1.

At first we show that for any prefix v of u(p), both LSv and SMv are factors of u(p). This will be obvious from these three simple facts: (i) Since LL is a factor of u(p), both φ2Np(L)φ2Np(L) and φ2N + 1p(L)φ2N + 1p(L) are factors of u(p) for any [formula]. (ii) It holds [formula] and [formula] for any [formula]. (iii) There is an [formula] such that v is a prefix of φ2Np(L), and thus of φ2N + 1p(L).

Statements (i) and (ii) imply that both SMφ2Np(L)v and LSφ2N + 1p(L)v are factors of u(p), and (iii) then implies that SMv and LSv are factors of u(p) as well.

Let now [formula] be the prefix of u(p) of the length n and let Ψ(v) be its Parikh vector. We will show that then there are factors v' and v'' of u(p) such that Ψ(v')  ≠  Ψ(v)  ≠  Ψ(v'') and Ψ(v')  ≠  Ψ(v''). We distinguish three cases according to un - 1: [formula] If un - 1 = L, then we set [formula], [formula]. [formula] If un - 1 = S, it holds necessarily un - 2 = L (cf. Observation [\ref=pripustne]). In this case we set [formula], [formula]. [formula] If un - 1 = M, it holds necessarily un - 2 = S (cf. again Observation [\ref=pripustne]). We set [formula], [formula].

Conclusion

We have studied balance properties and the Abelian complexity of a certain class of infinite ternary words. We have found the optimal c such that these words are c-balanced, and also the optimal bound for their Abelian complexity functions. We have introduced a new notion, namely the property that a word is "c-balanced with respect to the letter a", which helped us to proceed more effectively from the knowledge of the balance properties to the estimate on [formula].

The class of words studied in this paper has one parameter p > 1. However, it emerged from our calculations that all the three optimal bounds for balances with respect to particular letters, as well as the optimal bound for the Abelian complexity, are independent of the value of p.

The problem has one more aspect. So far the subword complexity and the Abelian complexity are considered as highly independent of each other (cf. e.g. the work of Richome, Saari and Zamboni). However, our result can indicate that there are connections between them, for the present waiting for their discovery. It has been recently shown in [\cite=KP] that a fixed point of a canonical substitution associated with a non-simple cubic Parry number has affine factor complexity if and only if it belongs just to the class with which we have dealt in this paper. Therefore, briefly speaking, "if the factor complexity is affine, then the Abelian complexity has the optimal bound 7" holds in the cubic non-simple Parry case. We remark that this sort of statement holds as well in the quadratic non-simple Parry case, although there it is a trivial fact.

Acknowledgements

The author is grateful to K. B rinda for performing a numerical experiment and to E. Pelantová for helpful discussions on various aspects of the problem.