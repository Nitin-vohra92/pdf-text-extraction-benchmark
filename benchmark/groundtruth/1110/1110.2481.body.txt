hyperref

A Chen-Fliess Approximation for diffusion functionals

Introduction

The expansion of the SDE solution

[formula]

in a stochastic (Stratonovich) Taylor series

[formula]

is an important tool in the numerical analysis of stochastic differential equations, cf. [\cite=kloeden-platen-92]. In this short note we consider a Stratonovich stochastic Taylor expansion in the spirit of Kloeden and Platen [\cite=kloeden-platen-92] and generalize the classic formula ([\ref=eq:stoch_taylor]) that applies to smooth functions [formula] by giving meaning to such an approximation when f is replaced by a sufficiently regular, nonanticipative functional

[formula]

and derive a L2 bound for the remainder of the expansion. The crucial tool in obtaining these results are ideas of B. Dupire [\cite=Duprire_FIto] on derivatives of nonanticipative functionals (cf. the extensions of Cont&Fournie [\cite=ContFournie] [\cite=ContFournie_Pathwise] and the work on pathdependent viscosity PDEs [\cite=2011arXiv1106.1144P] [\cite=2011arXiv1108.4317P] [\cite=2011arXiv1109.5971E]). Dupire showed that one can define a time derivative ∂tF and a space derivative [formula] of F such that one arrives at the approximation (for simplicity assume e = 1)

[formula]

The intuition behind these derivatives is that the time derivative measures the infinitesimal drift of F whereas [formula] measures the response of F to instantaneous changes in the underlying path. In section [\ref=sec:Approximating-Functionals-of] we show that these derivatives allow to give proper meaning to the expression [formula] if one interprets a vector field in a corresponding way as a derivation in terms of these functional derivatives (e.g. if [formula] this simply coincides with the standard notion of [formula] as a differential operator). This subsequently allows us to adapt the standard estimates for ([\ref=eq:stoch_taylor]) in the functional setting.

The functional perspective of the stochastic Taylor expansion suggests some interesting connections to problems studied in deterministic, classic control theory: many systems are modeled as a nonlinear, causal response to a d-dimensional input [formula] and control theory provides a powerful toolbox to deal with functionals of the form

[formula]

which are nonanticipative in the sense that [formula] depends only on values of [formula] up to time t and depend continuously on the input [formula]. The basic example being the solution map of a controlled differential equation

[formula]

i.e. [formula]. We mention - pars pro toto - the work of Brockett, Fliess and Sussmann, [\cite=RogerW1976167] [\cite=fliess1981fonctionnelles] [\cite=sussmann1975semigroup], which emphasized the importance of the signature of a path in the sense of Chen [\cite=chen-57] [\cite=chen-58] as a central object in control theory. It is a well known fact to any system theorist or electrical engineer that a functional F that is linear

[formula]

and additionally time-invariant is completely described by its response to a Dirac impulse δ at time 0 (clearly, the functional given by ([\ref=eq:control]) does not fit into this framework). As mentioned above, Dupire's functional calculus rests on two derivatives and the space derivative is, at least formally, closely related to the well known method in control theory of response to a Dirac delta (however in integrated form "[formula]" and at running time). Our interest lies in the stochastic case, but these functional derivatives might already be of interest to the classic control theory case for non-linear, non-time-invariant systems of the form ([\ref=eq:control]). In this context we recall in section [\ref=sec:control] a result of M. Fliess, [\cite=fliess1981fonctionnelles] on the existence of approximations to continuous, nonanticipative functionals (this result of Fliess is the reason why we refer to the expansion in section [\ref=sec:Approximating-Functionals-of] as a Chen-Fliess approximation instead of stochastic Taylor expansion for functionals).

Of course, one can see the finite expansion ([\ref=eq:stoch_taylor]) as a small piece in the seminal work initiated by Azencott and Ben Arous [\cite=azencott-82] [\cite=benarous-89] on asymptotic expansions of SDE flows and subsequent generalizations of e.g. Castell and Hu [\cite=castell] [\cite=hu] using the generalized Campbell-Baker-Hausdorff formula of Strichartz [\cite=strichartz-87]. From this point of view, the present note is certainly only a first step but we should note that our interest for a Taylor expansion for functionals stems from its potential use in a cubature scheme in the sense of Kusuoka-Lyons-Victoir [\cite=MR2052260] (which we hope to address in forthcoming work) where it replaces ([\ref=eq:stoch_taylor]) and, similar to ([\ref=eq:stoch_taylor]), it might be of independent interest. Finally, let us mention the classic results of Stroock, [\cite=stroock], who considered a Taylor expansion of functionals in the spirit of Malliavin's calculus of variations. However, our results are different and tailored to the study of the smaller class of continuous (in uniform norm) and nonanticipative functionals. In fact, thanks to the extended functional Ito formula of Cont&Fournie, it is easy to relax the continuity assumption to include e.g. functionals of the quadratic variation (the same arguments then apply since the domain of the functional changes but only perturbations of the path are relevant, cf. [\cite=ContFournie]). Nevertheless, we focus our presentation on smooth and continuous functionals since they already cover interesting applications like pathdependent financial derivatives, cf. [\cite=Duprire_FIto], and keep the (necessary) new notation to a minimum, allowing for a concise presentation of the present approach.

Approximating Functionals of bounded variation paths

In this section we adapt some techniques from control theory, introduce notation and recall a classical existence theorem which demonstrates that continuous functionals on continuous, bounded variation paths can be uniformly approximated by linear combinations of iterated integrals, the (truncated) Chen-Fliess series. In section [\ref=sec:Approximating-Functionals-of] we then extend this result to diffusion functionals using a new approach with Dupire's functional derivatives. Set

[formula]

with [formula] being the space of continuous paths [formula] which are of bounded variation,

[formula]

with the sup D taken over all finite dissections of [formula]. We are interested in functionals

[formula]

which are nonanticipative in the sense that [formula] depends only on [formula]. A basic example is the solution map

[formula]

mapping the "input" [formula] to the real valued solution y of the integral equation

[formula]

Such a map is continuous (provided the vector fields are bounded, Lipschitz) if [formula] is equipped with the product topology. However, for later purposes it will be convenient to work with the weaker topology on Λ1 - var induced by the metric

[formula]

where at denotes the stopping operator

[formula]

The proposition below then follows from standard arguments.

The space [formula] is a complete metric space and the topology on Λ1 - var given by the metric ρ1 - var is strictly weaker than the topology induced by the product topology (of [formula], the latter equipped with [formula] convergence).

We will in the following (unless stated otherwise) always work in the topology on Λ1 - var induced by ρ1 - var. Set

[formula]

If [formula], define for every word [formula], and [formula],s  ≤  t, the iterated integral [formula] recursively as

[formula]

We now show that the special class of polynomial functionals are dense in [formula].

Call a functional [formula] a polynomial functional if there exists a [formula] and [formula] s.t.

[formula]

The term polynomial is made more rigorous by using a morphism with the non commutative algebra [formula] over a finite alphabet [formula], cf. [\cite=fliess1981fonctionnelles].

Every polynomial [formula] is continuous with respect to ρ1 - var, i.e. an element of [formula]. Further, the set of polynomials is a subalgebra of [formula].

The theorem below is a straightforward extension of a well-known theorem of control theory, cf. [\cite=sussmann1975semigroup] [\cite=fliess1981fonctionnelles] to bounded variation (but not necessarily absolutely continuous) paths in the topology ρ1 - var. Note that it relies on the Stone-Weierstrass theorem. In section [\ref=sec:Approximating-Functionals-of] we show that under stronger assumptions on the functional (and in a semimartingale context) one can choose the coefficients as functional derivatives in the sense of Dupire (this is similar to the relation of the classic Taylor expansion, applicable to smooth functions, to the Weierstrass approximation theorem which applies to continuous functions).

Let K be a compact subset of [formula] and

[formula]

be continuous with respect to ρ1 - var. Then F can be arbitrarily close approximated in uniform topology by polynomial functionals, that is [formula] exists a polynomial functional [formula] such that

[formula]

The set [formula] is a compact subset of [formula] if the latter set is equipped with the product topology of Euclidean distance on [formula] and [formula]. To see that it is also a compact subset in the topology given by ρ1 - var, take a sequence

[formula]

By compactness there exists a [formula] and a sub-sequence [formula] s.t. [formula] and [formula]. Therefore also

[formula]

hence [formula] is under the ρ1 - var metric a compact subset of Λ1 - var. We now use the Stone-Weierstrass theorem: [formula] is a compact, Hausdorff space and from proposition we know that the space of polynomials is a subalgebra of [formula], hence (strictly speaking the space polynomials with domains restricted to [formula] are) also a subalgebra of [formula]. Further, the space of polynomials contains the nonzero, constant functions and it remains to verify that it separates points. Given two elements of [formula],

[formula]

we can choose a polynomial P s.t. [formula]:

if s  ≠  t: take the functional [formula],

if s = t and bi  ≠  ei for some [formula]: consider the polynomials

[formula]

with [formula] for [formula]. Then [formula] Recall that a continuous path [formula] is of finite variation if and only if [formula] for a signed measure μ on [formula] with finite mass and no atoms. The signed measure μ defines a linear functional on the space [formula]. Hence, if [formula] for all polynomials [formula] this would imply [formula] [formula] by the Stone Weierstrass theorem on [formula], therefore also [formula], [formula]. Applying this reasoning to x = bi - ei shows that [formula] for every [formula] leads to a contradiction to bi  ≠  ei.

An important generalization of theorem [\ref=thm:stone-weierst] to rough path functionals has been obtained by Lyons et al. [\cite=Fawcettthesis]

Approximating Functionals of a diffusion

Theorem [\ref=thm:stone-weierst] applies to bounded variation paths and gives no description of the approximating functionals. We now follow a different approach using Dupire's functional derivatives to show that under some additional smoothness assumption on F one can also approximate functionals of semi-martingales trajectories and give an explicit description of the coefficients in the expansion. Let us fix notation: We are interested in functionals of the form

[formula]

[formula] denoting the space of c�dl�g paths on [formula] with values in [formula] and we write [formula]. Define a metric ρ∞ on Λ,

[formula]

(at denotes as in section [\ref=sec:control] the stopping operator now applied to cadlag paths) and set

[formula]

F being the σ-algebra generated by the coordinate process on [formula]. Following Dupire [\cite=Duprire_FIto], we say that [formula] has a time derivative [formula] at [formula] if the limit

[formula]

exists and a space derivative [formula] in direction [formula] (ei denoting the standard basis on [formula]) at [formula] if the limit

[formula]

exists. Similarly, define the higher order derivatives ∂i∂jF etc. Denote [formula] the subset of [formula] of functionals which are at least m times differentiable in time, at least n times differentiable in space and continuous with respect to ρ∞. More formally, we define a set of multi-indices by letting

[formula]

(by convention [formula] and say [formula] if [formula] for all [formula]. Furthermore we define sets of bounded functions with bounded derivatives by

[formula]

The functional derivatives behave similar to the standard derivatives, we make repeatedly use of two properties.

Let [formula] and suppose [formula]

Then [formula] and [formula] for [formula].

If [formula] for [formula], then [formula] and [formula] and [formula] for [formula]

Let [formula], Y a continuous, [formula]-valued semi-martingale. Then [formula] is a continuous semi-martingale and a.s.

[formula]

See [\cite=Duprire_FIto] and [\cite=ContFournie].

Above formula also holds when the boundedness is replaced by boundedness on bounded sets and F depends only continuous wrt to Y and an extra variable e.g. the quadratic variation of Y, cf. [\cite=ContFournie].

We actually need the Stratonovich version with the Stratonovich integral as usual defined as

[formula]

Above formula then reads

Let [formula], Y a continuous, [formula]-valued semi-martingale. Then we have a.s.

[formula]

We need to show that for [formula],

[formula]

By assumption ∂iF∈C1,2b, hence from theorem [\ref=thm:Dupire_Ito],

[formula]

and it follows that,

[formula]

which equals [formula].

Vector fields as derivations of functionals

Let M be a smooth manifold, then one can regard a vector field V on M as a derivation, [formula]. We need to find a similar concept for the (infinite dimensional) space Λ which respects the additional structure (of being the product of a time coordinate and a pathspace). It seems natural to define for a given vector field [formula],

[formula]

However, above formulation does not take into account the time decay in functionals measured by the functional time derivative ∂0. We therefore instead consider maps [formula] with an additional 0th coordinate [formula] and let [formula] act on [formula] as

[formula]

Given a map [formula], we can identify [formula] as an element of [formula] the derivations on the [formula]algebra [formula], by setting

[formula]

By lemma [\ref=lem:product], [formula] maps [formula] to [formula] functionals. One need to verify that [formula] is an [formula]-algebra and that [formula], but this follows again directly from lemma [\ref=lem:product].

Let [formula] be a continuous, semi-martingale with X0t = t,[formula], [formula] and [formula] be the unique strong solution of the SDE

[formula]

Define [formula] as

[formula]

Then for every [formula] we have a.s.

[formula]

Applying corollary [\ref=cor:functiional_strat] to F gives

[formula]

Identifying [formula] and [formula] as a derivation, as in lemma [\ref=lem:Given-a-map] (recall that [formula] for [formula]), this becomes

[formula]

To identify compositions of the vector fields we define the set of multi-indices A by

[formula]

and let [formula] be a multi-index. Given I∈A set [formula] and also define ||I||: = |I| + card(j:αj = 0). Finally let

[formula]

Given a multi-index [formula] we define [formula].

Set

[formula]

Let [formula] be a continuous semi-martingale with X0t = t. Define the iterated Stratonovich integrals of X as

[formula]

The functional Taylor series and a remainder estimate

We can now formulate our main theorem. The reader will notice that applied to a functional of the form [formula], one recovers the usual stochastic Taylor expansion, [\cite=kloeden-platen-92] [\cite=MR2052260].

Let [formula] be a continuous, semi-martingale with X0t = t, [formula] with [formula] and let Y be the unique strong solution of the SDE

[formula]

Define [formula] as

[formula]

Fix [formula]. Then for every [formula] we have

[formula]

where

[formula]

Applying proposition [\ref=cor:Ito_for_FDE] gives

[formula]

Now by assumption on F and V, the functional [formula] is again in C∞  ,  ∞b and applying proposition [\ref=cor:Ito_for_FDE] to [formula] gives

[formula]

Iterating this procedure, we finally arrive at

[formula]

The choice of truncation in the Taylor approximation in Theorem [\ref=pro:Euler_approx] reflects how the semi-martingale part of the noise X scales compared to the time component X0t = t. If X is a Brownian motion, then (cf. [\cite=MR2052260]) for [formula]

[formula]

This explains the particular truncation of the Taylor expansion via the multi-index sets [formula] and allows to arrive at the L2 error estimate in corollary [\ref=cor:error] which is important in numerical applications, e.g. [\cite=MR2052260].

Even if there is no drift vector field in the SDE, that is in above notation [formula], we still have to deal with iterated integrals which involve dX0t = dt. This is in contrast to the stochastic Taylor expansion for functions [formula] due to the time decay in the functional [formula] which is picked up by the functional derivative ∂0 via the first coordinate of [formula].

Of special importance is the case of Brownian noise in which case we can give a L2 estimate for the remainder term.

Let [formula] be a d-dimensional Brownian motion and set [formula] with B0t = t. Let [formula] with [formula] and Y be the unique strong solution of the Stratonovich SDE with drift,

[formula]

Define [formula] as [formula] Fix [formula]. Then for every [formula] we have

[formula]

Moreover, there exists a constant [formula], only depending on d and m, such that

[formula]

Given [formula], [formula] and [formula]. We show that there exists a constant [formula], only depending on d and k, s.t. [formula]

[formula]

The result then follows from Theorem [\ref=pro:Euler_approx] by applying this to [formula] (without loss of generality one can take s = 0). We assume for induction that for any j  ≤  k,

[formula]

for all t > 0. We will prove the claim for [formula]. First assume that αk + 1 = 0. In this case we have

[formula]

by using the Jensen inequality. Assuming the inductive hypothesis we estimate that last line as

[formula]

Now suppose [formula]. We have if [formula] (it easy to see that αk = 0 follows from a similar calculation)

[formula]

Note that we can bound the second term in the sum using the same arguments as in the case αk + 1 = 0. For the first term we estimate the Ito integral,

[formula]

using the inductive hypothesis. Finally we prove the base case of the induction: Recall that Y is [formula]-valued and [formula]. Similar to proposition [\ref=cor:Ito_for_FDE], we see

[formula]

with BV a continuous bounded variation process. Thus for [formula] we have

[formula]

Hence,

[formula]

which implies the base case of the induction for [formula]. The estimate for the case α1 = 0, i.e. Bα1t = t is obvious.

To demonstrate that above theorem leads to concrete, easy to use, estimates we conclude with a toy example which can be verified (by a longer calculation) with standard Ito calculus.

Take a 1-dimensional Brownian motion B, [formula] and let [formula]. Consider

[formula]

We immediately get [formula], [formula], [formula] and similarly one can calculate higher derivatives. The first nontrivial case of corollary [\ref=cor:error] applied to this example is the step m = 3 approximation,

[formula]

with [formula].

Acknowledgment.

Christian Litterer and Harald Oberhauser were partially supported by the European Unions Seventh Framework Programme, ERC grant agreement 258237.