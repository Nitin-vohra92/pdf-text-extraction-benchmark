Counting numbers in multiplicative sets: Landau versus Ramanujan

Introduction

To every prime p we associate a set E(p) of positive allowed exponents. Thus E(p) is a subset of [formula]. We consider the set S of integers consisting of 1 and all integers n of the form [formula] with ei∈E(pi). Note that this set is multiplicative, i.e., if m and n are coprime integers then mn is in S iff both m and n are in S. It is easy to see that in this way we obtain all multiplicative sets of natural numbers. As an example, let us consider the case where E(p) consists of the positive even integers if [formula] and [formula] for the other primes. The set SB obtained in this way can be described in another way. By the well-known result that every positive integer can be written as a sum of two squares iff every prime divisor p of n of the form [formula] occurs to an even exponent, we see that SB is the set of positive integers that can be written as a sum of two integer squares. In this note we are interested in the counting function associated to S, S(x), which counts the number of n  ≤  x that are in S. By πS(x) we denote the number of primes p  ≤  x that are in S. We will only consider S with the property that πS(x) can be well-approximated by δπ(x) with δ > 0 real and π(x) the prime counting function (thus [formula]). Recall that the Prime Number Theorem states that asymptotically π(x)  ~  x /  log x. Gauss as a teenager conjectured that the logarithmic integral, Li(x), defined as [formula] gives a much better approximation to π(x). Indeed, it is now known that, for any r > 0 we have π(x) = Li(x) + O(x log - rx). On the other hand, the result that π(x) = x  /   log x + O(x log - rx), is false for r > 2. In this note two types of approximation of πS(x) by δπ(x) play an important role. We say S satisfies Condtion A if, asymptotically,

[formula]

We say that S satisfies Condition B if there are some fixed positive numbers δ and ρ such that asymptotically

[formula]

The following result is a special case of a result of Wirsing [\cite=Wirsing], with a reformulation following Finch et al. [\cite=FMS]. As usual Γ will denote the gamma function. By χS we deonte the characteristic function of S, that is we put χS(n) = 1 if n is in S and zero otherwise. In case S = SB we have δ = 1 / 2 by Dirichlet's prime number theoorem for arithmetic progressions. Recall that for fixed r > 0 this theorem states that

[formula]

Theorem [\ref=een] thus gives that, asymptotically, [formula], a result derived in 1908 by Edmund Landau. Ramanujan, in his first letter to Hardy (1913), wrote in our notation that

[formula]

with θ(x) very small. In reply to Hardy's question what 'very small' is in this context Ramanujan wrote back [formula]. (For a more detailed account and further references see Moree and Cazaran [\cite=MC].) Note that by partial integration Ramanujan's claim, if true, implies the result of Landau. This leads us to the following defintion.

Let S be a multiplicative set such that πS(x)  ~  δx /  log x for some δ > 0. If for all x sufficiently large

[formula]

for every x sufficiently large, we say that the Landau approximation is better than the Ramanujan approximation. If the reverse inequality holds for every x sufficiently large, we say that the Ramanujan approximation is better than the Landau approximation.

We denote the formal Dirichlet series [formula] associated to S by LS(s). For Re(s) > 1 it converges. If

[formula]

exists, we say that S has Euler-Kronecker constant γS. In case S consists of all positive integers we have LS(s) = ζ(s) and it is well known that

[formula]

If the multiplicative set S satisfies condtion B, then it can be shown that γS exists. Indeed, we have the following result. The corollary follows on noting that by partial integration we have

[formula]

On comparing ([\ref=part1]) with Theorem [\ref=vier1] we see Ramanujan's claim ([\ref=kleemie]), if true, implies γSB = 0. A special, but common case, is where the primes in the set S are, with finitely many exceptions, precisely those in a finite union of arithmetic progressions, that is, there exists a modulus d and integers [formula] such that for all sufficiently large primes p we have p∈S iff [formula] for some 1  ≤  i  ≤  s. (Indeed, all examples we consider in this paper belong to this special case.) Under this assumption it can be shown, see Serre [\cite=Serre], that S(x) has an aysmptotic expansion in the sense of Poincaré, that is, for every integer m  ≥  1 we have

[formula]

where the implicit error term may depend on both m and S. In particular SB(x) has an expansion of the form ([\ref=starrie]) (see, e.g., Hardy [\cite=Hardy] for a proof).

On the numerical evaluation of γS

We discuss various ways of numerically approximating γS. A few of these approaches involve a generalization of the von Mangoldt function Λ(n) (for more details see Section 2.2 of [\cite=MC]). We define ΛS(n) implicitly by

[formula]

As an example let us compute ΛS(n) in case [formula]. Since

[formula]

we obtain [formula] and hence

[formula]

We infer that ΛS(n) = Λ(n), the von Mangoldt function. Recall that

[formula]

In case S is a multiplicative semigroup generated by [formula], we have

[formula]

and we find

[formula]

Note that SB is a multiplicative semigroup. It is generated by 2, the primes [formula] and the squares of the primes [formula]. For a more general multiplicative set ΛS(n) can become more difficult in nature as we will now argue. We claim that ([\ref=loggie]) gives rise to the identity

[formula]

In the case [formula], e.g., we obtain [formula]. In order to derive ([\ref=idi1]) we use the observation that if [formula], [formula] and [formula] are formal Dirichlet series, then h is the Dirichlet convolution of f and g, that is [formula]. By an argument similar to the one that led us to the von Mangoldt function, one sees that ΛS(n) = 0 in case n is not a prime power. Thus we can rewrite ([\ref=idi1]) as

[formula]

By induction one then finds that ΛS(pe) = cS(pe) log p, where cS(p) = χS(p) and cS(pe) is defined recursively for e > 1 by

[formula]

Also a more closed expression for ΛS(n) can be given ([\cite=MC]), namely

[formula]

if n = pe for some e  ≥  1 and ΛS(n) = 0 otherwise, or alternatively ΛS(n) = We log p, where

[formula]

if n = pe and ΛS(n) = 0 otherwise, where the ki run through the natural numbers and the lj through the non-negative integers. Now that we can compute ΛS(n) we are ready for some formulae expressing γS in terms of this function.

The second formula given in Theorem [\ref=vier] easily follows from the first on invoking the classical definition of γ:

[formula]

Theorem [\ref=vier] is quite suitable for getting an approximative value of γS. The formulae given there, however, do not allow one to compute γS with a prescribed numerical precision. For doing that another approach is needed, the idea of which is to relate the generating series LS(s) to ζ(s) and then take the logarithmic derivative. We illustrate this in Section [\ref=SEK] by showing how γSD (defined in that section) can be computed with high numerical precision.

Non-divisibility of multiplicative arithmetic functions

Given a multiplicative arithmetic function f taking only integer values, it is an almost immediate obervation that, with q a prime, the set [formula] is multiplicative.

Non-divisibility of Ramanujan's τ

In his so-called 'unpublished' manuscript on the partition and tau functions [\cite=BO], Ramanujan considers the counting function of Sτ;q, where q∈{3,5,7,23,691} and τ is the Ramanujan τ-function. Ramanujan's τ-function is defined as the coefficients of the power series in q;

[formula]

After setting q = e2πiz, the function Δ(z) is the unique normalized cusp form of weight 12 for the full modular group SL[formula]. It turns out that τ is a multiplicative function and hence the set Sτ;q is multiplicative. Given any such Sτ;q, Ramanujan denotes χSτ;q(n) by tn. He then typically writes: "It is easy to prove by quite elementary methods that [formula]. It can be shown by transcendental methods that

[formula]

and

[formula]

where r is any positive number'. Ramanujan claims that δ3  =  δ7  =  δ23 = 1 / 2, δ5 = 1 / 4 and δ691 = 1 / 690. Except for q = 5 and q = 691 Ramanujan also writes down an Euler product for C. These are correct, except for a minor omission he made in case q = 23. The reader might wonder why this specific small set of q. The answer is that in these cases Ramanujan established easy congruences such as

[formula]

that allow one to easily describe the non-divisibility of τ(n) for these q. Serre, see [\cite=SwD], has shown that for every odd prime q a formula of type ([\ref=simpelonia]) exists, although no simple congruences as above exist. This result requires quite sophisticated tools, e.g., the theory of l-adic representations. The question that arises is whether γSτ;q exists for every odd q and if yes, to compute it with enough numerical precision as to determine whether it is zero or not and to be able to tell whether the Landau or the Ramanujan approximation is better.

Non-divisibility of Euler's totient function φ

Spearman and Williams [\cite=SW] determined the asymptotic behaviour of Sφ;q(x). Here invariants from the cyclotomic field [formula] come into play. The mathematical connection with cyclotomic fields is not very direct in [\cite=SW]. However, this connection can be made and in this way the results of Spearman and Williams can then be rederived in a rather straightforward way, see [\cite=FLM] [\cite=eerstev]. Recall that the Extended Riemann Hypothesis (ERH) says that the Riemann Hypothesis holds true for every Dirichlet L-series L(s,χ). The explicit inequalities in this result were first proved by the author [\cite=eerstev], who established them assuming ERH. Note that the result shows that Landau wins over Ramanujan for every prime q  ≥  71. Given a number field K, the Euler-Kronecker constant EKK of the number field K is defined as

[formula]

where ζK(s) denotes the Dedekind zeta-function of K. Given a prime p  ≠  q, let fp the smallest positive integer such that [formula]. Put

[formula]

We have

[formula]

(This is a consequence of Theorem [\ref=vier1] and Proposition 2 of Ford et al. [\cite=FLM].) The Euler-Kronecker constants EKK and in particular [formula] have been well-studied, see e.g. Ford et al. [\cite=FLM], Ihara [\cite=I] or Kumar Murty [\cite=KM] for results and references.

Some Euler-Kronecker constants related to binary quadratic forms

Hardy [\cite=Hardy] was under the misapprehension that for SB Landau's approximation is better. However, he based himself on a computation of his student Geraldine Stanley [\cite=Stanley] that turned out to be incorrect. Shanks proved that

[formula]

Various mathematicians independently discovered the result that

[formula]

where [formula] denotes the limiting value of Lagrange's AGM algorithm an + 1 = (an + bn) / 2, [formula] with starting values a0 = 1 and [formula]. Gauss showed (in his diary) that

[formula]

The total arclength of the lemniscate r2  =   cos (2θ) is given by 2l, where [formula] is the so-called lemniscate constant. Shanks used these formulae to show that [formula], thus establishing the falsity of Ramanujan's claim ([\ref=kleemie]). Since γSB < 1 / 2, it follows by Corollary 1 that actually the Ramanujan approximation is better.

A natural question is to determine the primitive binary quadratic forms f(X,Y) = aX2 + bXY + cY2 of negative discriminant for which the integers represented form a multiplicative set. This does not seem to be known. However, in the more restrictive case where we require the multiplicative set to be also a semigroup the answer is known, see Earnest and Fitzgerald [\cite=earnest]. In the former case, the set of represented integers is just the set of norms from the order [formula], which is multiplicative. In the latter case, the smallest example are the forms of discriminant -23, for which the class group is cyclic of order 3: the primes p are partitioned into those of the form X2  -  XY  +  6Y2 and those of the form 2X2  ±  XY  +  3Y2.

Although the integers represented by f(X,Y) do not in general form a multiplicative set, the associated set If of integers represented by f, always satisfies the same type of asymptotic, namely we have

[formula]

This result is due to Paul Bernays [\cite=Bernays], of fame in logic, who did his PhD thesis with Landau. Since his work was not published in a mathematical journal it got forgotten and later partially rediscovered by mathematicians such as James and Pall. For a brief description of the proof approach of Bernays see Brink et al. [\cite=Brink].

We like to point out that in general the estimate

[formula]

does not hold. For example, for f(X,Y) = X2 + 14Y2, see Shanks and Schmid [\cite=SS].

Bernays did not compute Cf, this was only done much later and required the combined effort of various mathematicians. The author and Osburn [\cite=mos] combined these results to show that of all the two dimensional lattices of covolume 1, the hexagonal lattice has the fewest distances. Earlier Conway and Sloane [\cite=CS] had identified the lattices with fewest distances in dimensions 3 to 8, also relying on the work of many other mathematicians.

In the special case where f = X2 + nY2, a remark in a paper of Shanks seemed to suggest that he thought Cf would be maximal in case n = 2. However, the maximum does not occur for n = 2, see Brink et al. [\cite=Brink].

In estimating If(x), the first step is to count BD(x). Given a discriminant D  ≤   - 3 we let BD(x) count the number of integers n  ≤  x that are coprime to D and can be represented by some primitive quadratic integral form of discriminant D. The integers so represented are known, see e.g. James [\cite=James], to form a multiplicative semigroup, SD, generated by the primes p with [formula] and the squares of the primes q with [formula]. James [\cite=James] showed that we have

[formula]

An easier proof, following closely the ideas employed by Rieger [\cite=Rieger], was given by Williams [\cite=Williams]. The set of primes in SD has density δ = 1 / 2. By the law of quadratic reciprocity the set of primes p satisfying [formula] is, with finitely many exceptions, precisely a union of arithmetic progressions. It thus follows that Condition B is satisfied and, moreover, that for every integer m  ≥  1, we have an expansion of the form

[formula]

By Theorem [\ref=vier1] and Theorem [\ref=vier] we infer that b1 = (1 - γSD) / 2, with

[formula]

As remarked earlier, in order to compute γSD with some numerical precision the above formula is not suitable and another route has to be taken. Proof. On noting that

[formula]

and

[formula]

the proof follows on comparing Euler factors on both sides. Proof. Follows on logarithmically differentiating the expression for LSD(s)2 given in Proposition [\ref=expressie], invoking ([\ref=gammo]) and recalling that L(1,χD)  ≠  0.

The latter result together with b1 = (1 - γSD) / 2 leads to a formula first proved by Heupel [\cite=Heupel] in a different way.

The first sum appearing in Proposition [\ref=2gamma] can be evaluated with high numerical precision by using the identity

[formula]

This identity in case D =  - 3 was established in [\cite=M2]. The proof given there is easily generalized. An alternative proof follows on combining Proposition [\ref=55] with Proposition [\ref=56]. Proof. This is Lemma 12 in Cilleruelo [\cite=C]. Proof. Put [formula]. We have

[formula]

The result then follows on logarithmic differentiation of both sides of the identity and the fact that L(1,χD)  ≠  0.

The terms in ([\ref=idie]) can be calculated with MAGMA with high precision and the series involved converge very fast. Cilleruelo [\cite=C] claims that

[formula]

We will now rederive Shanks' result ([\ref=geraldine]). Since there is only one primitive quadratic form of discriminant -4, we see that S- 4 is precisely the set of odd integers that can be written as a sum of two squares. If m is an odd integer that can be written as a sum of two squares, then so can 2em with e  ≥  0 arbitrary. It follows that LSB(s) = (1 - 2- s)- 1LS- 4(s) and hence γSB  =  γS- 4  -   log 2. On invoking Proposition [\ref=2gamma] one then finds the identity ([\ref=geraldine]).

Integers composed only of primes in a prescribed arithmetic progession

Consider an arithmetic progression having infinitely many primes in it, that is consider the progression [formula] with a and d coprime. Let S'd;a be the multiplicative set of integers composed only of primes [formula]. Here we will only consider the simple case where a = 1 and d = q is a prime number. This problem is very closely related to that in Section 3.2. One has [formula]. Since [formula], we then infer that

[formula]

and hence

[formula]

where the latter equality follows by identity ([\ref=EK01]). By Theorem [\ref=eflm], ([\ref=bloep]) and the Table in Ford et al. [\cite=FLM], we then arrive after some easy analysis at the following result.

Multiplicative set races

Given two multiplicative sets S1 and S2, one can wonder whether for every x  ≥  0 we have S1(x)  ≥  S2(x). We give an example showing that this question is not as far-fetched as one might think at first sight. Schmutz Schaller [\cite=PSS], motivated by considerations from hyperbolic geometry, conjectured that the hexagonal lattice is better than the square lattice, by which he means that SB(x)  ≥  SH(x) for every x, where SH is the set of squared distances occurring in the hexagonal lattices, that is the integers represented by the quadratic form X2 + XY + Y2. It is well-known that the numbers represented by this form are the integers generated by the primes [formula], 3 and the numbers p2 with [formula]. Thus SH is a multplicative set. If 0 < h1 < h2 < ... are the elements in ascending order in SH and [formula] the elements in ascending order in SB, then the conjecture can also be formulated (as Schmutz Schaller did) as qj  ≤  hj for every j  ≥  1. Asymptotically one easily finds that

[formula]

with C0(SB)  ≈  0.764 the Landau-Ramanujan constant (see Finch [\cite=Finch]) and [formula]. It is thus clear that asymptotically the conjecture holds true. However, if one wishes to make the above estimates effective, matters become much more complicated. Nonetheless, the author, with computational help of H. te Riele, managed to establish the conjecture of Schmutz Schaller. Many of the ideas used to establish the above result were first developed in [\cite=M2]. There some other multiplicative set races where considered. Given coprime positive integers a and d, let S'd;a be the multiplicative set of integers composed only of primes [formula]. The author established the following result as a precursor to Theorem [\ref=hoho]. We like to point out that in every race mentioned in the latter result, the associated prime number races have no ultimate winner. For example, already Littlewood [\cite=Littlew] in 1914 showed that πS'3;2(x) - πS'3;1(x) has infinitely many sign changes. Note that trivially if πS'd1;a1(x)  ≥  πS'd2;a2(x) for every x  ≥  0, then S'd1;a1(x)  ≥  S'd2;a2(x) for every x  ≥  0.

See Granville and Martin [\cite=GM] for a nice introduction to prime number races.

Exercises

Exercise 1. The non-hypotenuse numberss [formula] are those natural numbers for which there is no solution of n2 = u2 + v2 with u > v > 0 integers. The set SNH of non-hypotenuse numbers forms a multiplicative set that is generated by 2 and all the primes [formula]. Show that LNH(s) = LSB(s) / L(s,χ- 4) and hence

[formula]

Remark. Put f(x) = X2 + 1. Cilleruelo [\cite=C] showed that, as n tends to infinity,

[formula]

with

[formula]

We have [formula]. Recently the error term o(n) has been improved by Rué et al. [\cite=madrid] to

[formula]

with ε > 0. Exercise 2. Let S'D be the semigroup generated by the primes p with [formula]. It is easy to see that LS'D(s)2 = LSD(s)2L(s,χD)- 2 and hence, by Proposition [\ref=2gamma], we obtain

[formula]

Table : Overview of Euler-Kronecker constants discussed in this paper

~  ~

~  ~  ~  ~  Acknowledgement. I like to thank Andrew Earnest and John Voight for helpful information concerning qudaratic forms having a value set that is multiplicative, and Ana Zumalacárregui for sending me [\cite=madrid].