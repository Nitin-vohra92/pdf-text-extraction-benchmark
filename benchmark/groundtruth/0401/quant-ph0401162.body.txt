Proposition

Quantum Circuits for Incompletely Specified Two-Qubit Operators

Introduction

Quantum circuits offer a common formalism to describe various quantum-mechanical effects and facilitate a unified framework for simulating such effects on a quantum computer [\cite=Nielsen:00]. The framework consists of two steps: (1) for a given unitary evolution, find a quantum circuit that computes it, (2) implement this circuit on a quantum computer. The first step is sometimes called quantum circuit synthesis [\cite=Bullock:03], and is the focus of our work. Given that existing physical implementations are severely limited by the number of qubits, a considerable effort was made recently to synthesize small two-qubit circuits [\cite=Vidal:04] [\cite=Vatan:04] [\cite=Shende:18gates:04] [\cite=Shende:cnotcount:04] [\cite=Zhang:Bgate:04]. It has been shown that for such a circuit to implement a typical two-qubit operator, three CNOT gates are needed. However, this result was proven under the assumption that we know nothing about the circuit surrounding the given two-qubit operator. Thus, in the event that we have additional information, say the state of the input qubits or the basis in which the result of the computation is to be measured, the result no longer holds. In fact, we show that if the input state is |0〉, then three one-qubit gates and one CNOT suffice to simulate an arbitrary two-qubit operator. We also show that if a projective measurement in the computational basis follows the two-qubit operator, then it can be implemented by a circuit with two CNOTs.

Background

The following family of "spin flip" or "[formula]" results are invaluable in the study of two-qubit operators. They are all related in some sense to the fact that a two-qubit pure state |φ〉 is separable if and only if [formula]. For this reason, |ε|2 is sometimes used to measure entanglement.

Facts about two-qubit operators.

The Magic Basis [\cite=Bennett:96] [\cite=Hill:97]. There exist matrices E∈U(4) such that [formula]. These are characterized by the property [formula].

The Makhlin Invariants [\cite=Makhlin:02] Let u,v∈SU(4). Then there exist a,b,c,d∈SU(2) such that [formula] if and only if [formula] and [formula] have the same spectrum.

The Canonical Decomposition [\cite=Khaneja:01] [\cite=Lewenstein:01] Any u∈SU(4) can be written in the following form.

[formula]

Above, a,b,c,d∈SU(2) and [formula].

These facts can be used to classify two-qubit pure states up to the action of local unitaries, as shown below, and this result is used later in our work. One can also classify mixed states, but the more general result is harder to state [\cite=Makhlin:02].

Let |φ〉 and |ψ〉 be 2-qubit pure states. Then |φ〉 and |ψ〉 can be interchanged by local unitary operators if and only if |ε(|φ〉)|  =  |ε(|ψ〉)|.

Proof: (⇒  ) Suppose first that φ and ψ are interconvertible by local unitaries, that is, there exist a,b∈U(2) such that [formula]. One can check that for m a 2  ×  2 matrix, mTσym  =  σy det m. Using this to simplify, we have [formula]. The scalar vanishes upon taking absolute value. (⇐) Conversely, suppose [formula]. By ignoring global phase, we may suppose that in fact [formula]. Changing to the Magic Basis transforms the hypothesis into 〈φ|φ〉  =  〈ψ|ψ〉, and the statement we want to prove into: there exists p∈SO(4) such that p|ψ〉  =  |φ〉. So, let [formula] be an arbitrary vector, and v  =  vr  +  ivi be its decomposition into real and imaginary parts. Then we see that vTv  =  |vr|2  -  |vi|2  +  2ivTrvi. Since we know v to be a unit vector, vTv encodes the magnitudes of the real and imaginary parts of v, and the angle between them. From this it is clear that two unit vectors v,w in [formula] can be interchanged by an element of SO(4) if and only if vTv  =  wTw, and we have proven our claim. [formula]

Another important consequence of the [formula] theorems is the result that an arbitrary two-qubit operator can be implemented by a circuit containing three CNOTs and some one-qubit gates. It has been proven in various forms [\cite=Vidal:04] [\cite=Vatan:04] [\cite=Shende:18gates:04], of which we need the particular one described in Fig. [\ref=fig:18:cxz].

It is also known that three CNOT gates are necessary to implement some two-qubit operators, such as a wire swap [\cite=Vidal:04] [\cite=Vatan:04] [\cite=Shende:18gates:04]. To prove this and other lower bound results, one considers generic circuits. These are diagrams with placeholders for unspecified (variable) gates and may also contain specific (constant) gates. Each placeholder corresponds to some subset of possible gates. In this work, all placeholders are for one-qubit gates, and all constant gates are either CNOTs or one-qubit gates; we call such circuits basic. We label a placeholder for an unspecified element of SU(2) with a lower-case roman letter, and placeholders for gates of the form Rx(α), Ry(β), or Rz(γ) by Rx,Ry,Rz respectively. Here, Rn(θ)  =  eiσnθ / 2. We refer to basic circuits whose only placeholders represent Rx,Ry,Rz gates as elementary. The motivation for restricting to elementary circuits is that each placeholder has one degree of freedom, which makes dimension counting easier and more precise. Moreover, nothing is lost by doing so since any u∈SU(2) can be written in the form Rk(α)Rl(β)Rm(γ) for any k,l,m∈{x,y,z},k  ≠  l,l  ≠  m.

We say that an n-qubit generic circuit is universal if, by specifying appropriate values for the placeholders, one can obtain a circuit simulating arbitrary u∈U(2n) up to global phase. The dimension of U(2n) is 4n; subtracting one for global phase, we see that an elementary circuit on n qubits cannot be universal unless there are at least 4n  -  1 placeholders. Our general strategy for showing that a given incompletely specified circuit is not universal is to convert it into an elementary circuit, eliminate as many placeholders as possible via circuit identities, and then count gates. For example, the following well-known identity is particularly instrumental: the Rx (respectively, Rz) gate can pass through the target (respectively, control) of a CNOT gate.

Preparation of Pure States

The three- CNOT lower bound applies when one must find a circuit to simulate a particular given two-qubit operator up to global phase. However, quantum-computational tasks arising in applications are often less completely specified, thus they can be performed by a greater variety of quantum circuits. One such task is state preparation. To prepare the n-qubit state |φ〉 from |0〉, we can use any operator u∈U(2n) with u|0〉  =  eiθ|φ〉. A poor choice of u ensures that u cannot be implemented with fewer than O(4n) gates. However, as the dimension of the space of pure states is 2n  -  1, the lower bound by dimension counting techniques described in Section [\ref=sec:background] only indicate that at least ⌈(2n  -  3n - 1) / 4⌉ CNOTs are necessary to prepare an arbitrary pure state.  We show below that this bound can be matched asymptotically by techniques based on the QR decomposition of matrices.

Preparing a generic n-qubit pure state from |0〉 requires O(2n) gates.

Proof: As shown in [\cite=Vartiainen:04], an arbitrary n-qubit unitary operator can be simulated by a circuit containing approximately 8.7  ×  4n CNOT gates. Their technique is based on the QR decomposition and gives a circuit that builds up a unitary matrix column by column, with each of the 2n columns built by a subcircuit containing O(2n) gates. For our present purposes, only the subcircuit responsible for the first column is needed. [formula]

Other decomposition algorithms find better circuits for arbitrary operators: the best currently known yields about 4n  /  2 CNOTs [\cite=Shende:NQ:04] and is a factor of two away from the lower bound of ⌈(4n  -  3n  -  1) / 4⌉ given in [\cite=Shende:18gates:04]. However, as these algorithms do not build matrices column by column, they do not yield efficient techniques for state preparation. We note in passing that a significantly larger gap exists between the upper and lower bounds on the number of CNOT gates needed to prepare an arbitrary state, as compared to the corresponding bounds for the problem of simulating an arbitrary unitary operator: in the first case, a factor of thirty, in the second, a factor of two.

We now seek optimality results for the task of state preparation in the case of two qubits. As two-qubit states can be entangled, at least one use of a two-qubit gate is necessary to prepare any entangled state. To characterize two-qubit gates which are also sufficient for this purpose, we use some concepts from algebraic geometry, for whose explication the reader is referred to any introductory textbook, such as [\cite=Shafarevich]. We also give an explicitly constructive proof of this result in the special case of the CNOT gate.

Let G∈SU(4). Then an arbitrary pure state |ψ〉 can be prepared from |0〉 by a circuit containing one-qubit gates and a single gate G if and only if there exists a state |φ〉 such that ε(|φ〉)  =  0 and ε(G|φ〉)  =  1.

Proof: (⇐) Note that |ε(|0〉)|  =  0. Define [formula] so |ε(|B〉)|  =  1. Suppose there exist a,b,c,d∈U(2) such that [formula]. Recalling from Proposition [\ref=prop:2qfacts] that one-qubit operators preserve |ε|, we have [formula], and [formula].

(⇒  ) We note that by Proposition [\ref=prop:2qfacts], it suffices to show that circuits of the form [formula] can prepare states with arbitrary |ε| from |0〉. Again by Proposition [\ref=prop:2qfacts], if |φ〉 is the state given in the hypothesis, then there exist a1,b1∈U(2) such that [formula]. So, [formula]. If we show that a state with |ε|  =  0 can be prepared, it will follow by continuity of |ε| that arbitrary states can be prepared as well.

It suffices to show that every two-qubit gate maps some |ε|  =  0 state to another. For, if |φ〉 is such a state for G, then we may choose a0,b0∈U(2) such that [formula], and see that [formula]. Thus it suffices show that ε(|φ〉)  =  0 and ε(G(|φ〉))  =  0 have common solutions for all G. Fix G, and fix a basis for the state space. Then, ε(|φ〉) and ε(G|φ〉) can be seen to be homogenous polynomials in the 4 coordinates (in fact, they are quadratic forms). In particular, the zeroes of these polynomials do not depend on global phase, so we may speak of their zeroes on the space [formula] of two-qubit pure states modulo global phase. It is a fact that any two (nonconstant) homogenous polynomials must have common zeroes here [\cite=Shafarevich]. [formula]

As a single CNOT and a Hadamard gate can be used to prepare [formula] from |00〉, the CNOT gate satisfies the hypothesis of the Proposition [\ref=prop:prep2], and therefore a single CNOT suffices to prepare an arbitrary two-qubit pure state from |0〉. We now give a more explicit construction in this case.

A two-qubit pure state |φ〉 can be prepared from |0〉 using the one CNOT gate and three one-qubit gates.

Proof: Let C12 be the CNOT gate controlled on the higher qubit and acting on the lower. Let [formula] for some [formula]; one can check that c∈SU(2). Let φi  =  〈i|φ〉. We explicitly compute

[formula]

Making the change of variables z  =  u2  -  v2, [formula], we note that [formula] and |z|2  +  λ2  =  1; we want to solve [formula] for z,λ. This is a linear system with two equations and three unknowns; thus we obtain z,λ up to a scalar multiple, and can choose the scalar so that |z|2  +  λ  =  1.

Let [formula] and verify that ε(|η〉)  =  0. Since |η〉 is separable, write it as |s〉|t〉. This allows one to define a and b so that [formula]. Finally, we can write [formula] as desired. [formula]

Measurement Don't-Cares

Fewer gates are required for state preparation because images of basis states other than |0〉 can be arbitrary (in other words, we are using additional information about the input). Similarly, we may be able to save gates if we know in advance how the circuit output will be used. In particular, we now suppose that we know the output is to be measured in some predetermined basis.

Suppose we intend to first simulate an operator u on a yet-unspecified input, then take a projective measurement with respect to some given orthogonal subspace decomposition [formula], and we are interested only in having the measured state appear in a given subspace with the appropriate probability. In particular, if v is an operator that preserves each subspace Ei, then we do not care whether we implement u or vu. Conversely, if w is any operator which, upon any input, agrees with u after projective measurement with respect to the given subspace decomposition, then it is clear that wu- 1 preserves each subspace Ei. If a given circuit simulates some such operator w up to phase, we say that this circuit simulates u up to the measurement don't care associated to the given subspace decomposition.

Mathematically speaking, the problem of state preparation is essentially a special case of a measurement don't care. To prepare the state |φ〉 from |0〉, it is enough to have any operator whose matrix in the computational basis has first column |φ〉. On the other hand, suppose we are interested in simulating some given operator u, then taking a projective measurement with respect to two orthogonal subspaces: one spanned by |0〉 and the other by the rest of the computational basis vectors. Then we may replace u with any operator v such that 〈0|u  =  〈0|v; that is, the matrices of u and v must have the same first row in the computational basis. Thus the problem of state preparation amounts to specifying a single column of a matrix, whereas the aforementioned measurement don't care amounts to specifying a single row. Thus Propositions [\ref=prop:prepn], [\ref=prop:prep2], and [\ref=prop:prep2c] carry over to this context.

To simulate an arbitrary n-qubit operator up to a projective measurement onto two subspaces, one of which is one dimensional, at least ⌈(2n  -  3n  -  1) / 4⌉ CNOT gates are necessary, and O(2n) CNOT gates are sufficient. For n = 2, one CNOT is necessary and sufficient.

Suppose now we have a subspace decomposition and an underspecified circuit S which we believe is universal up to the associated measurement don't care - that is, we believe that for any u, appropriate specification of parameters gives a circuit simulating an operator w such that there exists some operator v preserving the subspace decomposition with vu  =  w. Let T be an underspecified circuit that precisely captures the set of operators that fix the subspace decomposition. It is clear that S is universal up to the given measurement don't care if and only if the concatenated circuit ST is universal. Therefore, as we show below, one cannot claim asymptotic savings for this problem in general.

To simulate an arbitrary n-qubit operator up to a projective measurement in which each of the subspaces is one-dimensional, at least ⌈(4n  -  2n  -  3n) / 4⌉ CNOT gates are required.

Proof: First, note that an operator v can be right-multiplied by any diagonal operator δ (diagonal in the basis of the measurement) and that the group of diagonal matrices is 2n-dimensional. 4n  -  2n parameters remain to be accounted for, and the proof of Proposition 1 of [\cite=Shende:18gates:04] indicates that (4n  -  2n  -  3n) / 4 CNOT gates are necessary to account for this many parameters. [formula]

Given that the best known circuit synthesis technique for n-qubit circuits is still a factor of two away from the theoretical lower bound of ⌈(4n  -  3n - 1)  /  4⌉, it may be difficult to detect a savings of 2n gates by analyzing specific circuits. Thus we turn to the two-qubit case, where all bounds are known, tight, and small -- no more than three CNOT gates are required, and a savings of even one gate would be significant.

On two qubits, there are several different types of measurement possible. We classify them by the subspace dimensions, hence we have "3 + 1", "2 + 2", "2 + 1 + 1", and "1 + 1 + 1 + 1" measurements. In what follows, we generally require that each subspace is spanned by computational basis vectors. We refer collectively to the corresponding measurement don't-cares as CB-measurement don't-cares. Additionally, when dealing with 2 + 2 measurements, we assume that one of the qubits is measured; that is, we do not consider the decomposition [formula]. Indeed, measuring a qubit is a common step in quantum algorithms and communication protocols.

We have already seen in Proposition [\ref=prop:meas1dim] that one CNOT is necessary and sufficient in the 3 + 1 case. We now show that at least two CNOTs are needed in the remaining cases

Let [formula] be a CB-subspace decomposition corresponding to the measurement don't-care M. Suppose no subspace is 3-dimensional, and further that the subspace decomposition is not [formula]. Then there exist two-qubit operators that cannot be simulated up to M by a circuit with only one CNOT.

Proof: First, consider subspace decompositions in which neither [formula], nor [formula] occur. Remaining cases with 2+1+1 decompositions using one of those subspaces are considered separately below. Suppose an operator is universal up to a 1 + 1 + 1 + 1 or 2 + 1 + 1 CB-measurement don't-care satisfying the above condition. Then combining pairs of 1-dimensional subspaces into 2-dimensional subspaces, we see that the same circuit is universal up to a 2 + 2 CB-measurement don't-care in which one of the qubits is measured. Suppose, without loss of generality, that it is the higher order qubit, hence that the subspaces are [formula] and [formula].

We now compose an arbitrary one- CNOT circuit with a circuit for operators preserving the relevant CB-subspaces, as outlined at the beginning of the section (see below-left). Conglomerating adjacent gates, we obtain the circuit below-right.

We now convert 3-dimensional place-holders to one-parameter gates, pass Rx and Rz through CNOT where desirable, and conglomerate adjacent gates again.

As this circuit has 13 one-parameter gates, the circuit we started with cannot be universal.

The 2 + 1 + 1 cases where the 2-dimensional subspace is [formula] or [formula] can be dealt with similarly. We give the circuits preserving these subspace decompositions below; the left circuit corresponds to [formula] and the right to [formula].

In both cases, the placeholder marked Rz' can be conglomerated with another placeholder, leaving a circuit with 14 one-parameter placeholders. [formula]

It is a natural question whether one might do better with a different gate [\cite=Zhang:Bgate:04]. At least for the 1 + 1 + 1 + 1 subspace decomposition, the answer is no.

Fix a two-qubit gate G. Some two-qubit operators cannot be simulated, up to the 1 + 1 + 1 + 1 CB-measurement don't care, by a circuit with a single instance of G.

Proof: Compose the circuit in question with a circuit for simulating a diagonal operator.

We now merge the Rz gates with the c and d placeholders; there remain 13 parameters -- three each in the a,b,c,d placeholders and one in the controlled-Rz gate. This circuit fails to be universal. [formula]

In a different direction, one may ask whether one can do better by measuring in a different basis.

Consider the 1 + 1 + 1 + 1 measurement don't care, M, corresponding to a given fixed basis. Some two-qubit operators cannot be simulated up to M by a circuit with a single CNOT.

Proof: We concatenate the circuit in question with a placeholder for a diagonal operator.

Counting parameters gives 13 (the placeholder for the diagonal operator counts for three.) Thus this circuit cannot be universal. [formula]

Finally, we prove constructively that an arbitrary two-qubit operator can be implemented up to any CB-measurement don't care with a circuit containing two CNOT gates and various one-qubit gates.

The 2-qubit circuit given below is universal up to any CB-measurement don't-care.

Proof: Consider a measurement with respect to any CB-subspace decomposition. The number and the probabilities of outcomes cannot change if we first measure along the 1 + 1 + 1 + 1 subspace decomposition. Indeed, the number of outcomes is determined by the number of subspaces in the last measurement, and the probabilities of outcomes for a given pure state by squared norms of projections onto those subspaces. In a CB-subspace decomposition, the squared norm of a projection onto a 2- or 3-dimensional subspace equals, by the Pythagorean theorem, the sum of squared norms of projections onto the computational-basis vectors in that subspace. Therefore, a circuit which is universal up to a 1 + 1 + 1 + 1 CB-measurement don't-care is universal up to any other CB-measurement don't-care, and it suffices to consider the 1 + 1 + 1 + 1 case.

Recall that the circuit of Fig. [\ref=fig:18:cxz] is universal. As adding a reversible constant gate (e.g., CNOT) to the end does not affect universality, the circuit below is universal as well.

Observe that the right portion of this circuit simulates a diagonal operator, which preserves the subspaces spanned by the computational basis vectors. Thus, by the discussion earlier in the section, the left portion of this circuit is universal up to measurement in the computational basis. [formula]

In applications such as Quantum Key Distribution, one may not know in advance which basis to measure in, but rather that one will choose at random between a given pair of bases for measurement. To save gates in this context, one could maintain two different circuits, one for each type of measurement. While it may seem counterintuitive that building two circuits would save on gates, note that the "circuit" here may consist of classical instructions to initiate a given laser pulse at a given time, thus we may maintain as many as we like in the memory of the classical computer we are using to control the quantum system. At issue is the execution time, which will be smaller when applying either of two smaller circuits (depending on the desired measurement) rather than a common, larger circuit followed by one of two measurements.

An alternative approach to saving gates in such a context is to try and find circuits which simulate the desired operator up to either of the possible measurements. The only fact we used about the computational basis in the proof of Proposition [\ref=prop:univ] was that operators expressible as [formula] are diagonal in the computational basis. Such operators are also diagonal in any basis in which each vector lies in either span(|0〉,|3〉) or span(|1〉,|2〉). In particular, this includes bases of Bell states.

Two CNOTs suffice to simulate any two-qubit operator up to any measurement in a not necessarily predisclosed basis in which each vector lies in either span(|0〉,|3〉) or span(|1〉,|2〉).

Conclusions

Algorithms and lower bounds for quantum circuit synthesis have significantly advanced in the last two years. In particular, several universal two-qubit circuits with optimal gate counts are available [\cite=Vidal:04] [\cite=Vatan:04] [\cite=Shende:18gates:04] [\cite=Shende:cnotcount:04] [\cite=Zhang:Bgate:04], and, in the general case of n-qubit circuits, asymptotically optimal gate counts can be realized by matrix-decomposition algorithms [\cite=Vartiainen:04] [\cite=Mottonen:04].

In this context, we recall that quantum algorithms and cryptographic protocols often apply measurements, known in advance, after reversible quantum circuits. This allows a greater variety of circuits to be functionally equivalent, and we prove that useful information about measurement often facilitates finding smaller circuits. Taking into account a known input state also decreases circuit sizes. Both cases can be viewed as circuit synthesis for incompletely specified operators.

Our work has parallels in synthesis of classical irreversible logic circuits, where truth tables are sometimes underspecified, and the synthesis program must complete them so as to allow for smaller circuits. In other words, outputs produced for some input combinations can be arbitrary. Such unspecified behaviors of classical circuits are traditionally called "don't-cares". While covered in undergraduate circuits courses, they remain a worthy subject of research and appear in a variety of circumstances in practice. For example, if a given circuit operates on outputs of another circuit, the latter may not be able to produce certain combinations of bits. While this cannot happen with reversible quantum circuits, we may nonetheless know in advance that the input state will be |0〉. Indeed, it may happen that the purpose of the circuit all along was to prepare a given state form |0〉. To this end, we point out that an n-qubit state can be prepared using O(2n) gates -- which is asymptotically optimal -- whereas O(4n) gates are necessary to simulate a generic n-qubit unitary operator. We also show that at most one maximally entangling gate is necessary and sufficient to prepare a 2-qubit state, and, in particular, that a single CNOT suffices. We have also shown that, if the final measurement is known to be in the computational basis, only two CNOT gates are necessary.

Acknowledgements

This work is funded by the DARPA QuIST program and an NSF grant. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing official policies or endorsements of employers and funding agencies.