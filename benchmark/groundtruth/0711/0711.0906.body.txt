=8pt

Proposition Conjecture Lemma Corollary Definition Problem Remark Example

Multivariate Fuss-Catalan numbers

Catalan triangle, binary trees, and Dyck paths

We recall in this section well-known results about Catalan numbers and ballot numbers.

The Catalan numbers

[formula]

are integers that appear in many combinatorial problems. These numbers first appeared in Euler's work as the number of triangulations of a polygon by mean of non-intersecting diagonals. Stanley [\cite=stanley] [\cite=stanweb] maintains a dynamic list of exercises related to Catalan numbers, including (at this date) 127 combinatorial interpretations.

Closely related to Catalan numbers are ballot numbers. Their name is due to the fact that they are the solution of the so-called ballot problem: we consider an election between two candidates A and B, which respectively receive a > b votes. The question is: what is the probability that during the counting of votes, A stays ahead of B? The answer will be given below, and we refer to [\cite=bertrand] for Bertrand's first solution, and to [\cite=andre] for André's beautiful solution using the "reflection principle".

Since our goal here is different, we shall neither define ballot numbers by the previous statement, nor by their explicit formula, but we introduce integers B(n,k) defined for a positive integer n and a nonnegative integer k by the following conditions:

B(1,0) = 1;

[formula] and 0  ≤  k < n, [formula];

[formula], B(n,k) = 0.

Observe that the recursive formula in the second condition is equivalent to:

[formula]

We shall present the B(n,k)'s by the following triangular representation (zero entries are omitted) where moving down increases n and moving right increases k.

[formula]

The crucial observation is that computing the horizontal sums of these integers give : 1, 2, 5, 14, 42, 132. We recognize the first terms of the Catalan series, and this intuition will be settled in Proposition [\ref=prop1], after introducing combinatorial objects.

A binary tree is a tree in which every internal node has exactly 2 sons. The number of binary trees with n internal nodes is given by the n-th Catalan number. The nodes of the following tree are labelled to explain a bijection described in the next paragraph: internal nodes are labelled by letters and external nodes by numbers.

A Dyck path is a path consisting of steps (1,1) and (1, - 1), starting from (0,0), ending at (2n,0), and remaining in the half-plane [formula] (we shall sometimes say "remaining above the horizontal axis" in the same sense). The number of Dyck paths of length 2n is also given by the n-th catalan number. More precisely, the depth-first search of the tree gives a bijection between binary trees and Dyck paths: we associate to each external node (except the left-most one) a (1,1) step and to each internal node a (1, - 1) step by searching recursively the left son, then the right son, then the root. As an example, we show below the Dyck path corresponding to the binary tree given above. The labels on steps correspond to those on the nodes of the tree.

An important parameter in our study will be the length of the right-most sequence of (1, - 1) of the path. This parameter equals 2 in our example. Observe that under the correspondence between paths and trees, this parameter corresponds to the length of the right-most string of right sons in the tree. We shall use the expressions last down sequence and last right string, for these parts of the path and of the tree.

Now we come to the announced result. It is well-known and simple, but is the starting point of our work.

For n a positive integer, we have the following equality:

[formula]

Let us denote by Cn,k the set of Dyck paths of length 2n with a last down sequence of length equal to n - k.

We shall prove that B(n,k) is the cardinality of Cn,k.

The proof is done recursively on n. If n = 1, this is trivial. If n > 1, let us suppose that B(n - 1,k) is the cardinality of Cn - 1,k for 0  ≤  k < n - 1. Let us consider an element of Cn,k. If we erase the last step (1,1) and the following step (1, - 1), we obtain a Dyck path of length 2(n - 1), with a last decreasing sequence of length n - 1 - l with l  ≤  k. If we keep track of the integer k, we obtain a bijection between Cn,k and [formula]. We mention that this process is very similar to the ECO method [\cite=eco].

This is a combinatorial proof of Proposition [\ref=prop1].

Remark 1.2. The integers B(n,k) are known as ballot numbers and are given by the explicit formula:

[formula]

This expression can be obtained shortly by checking the recurrence ([\ref=recc]). We can alternatively use the reflection principle (see [\cite=hilton] for a clear presentation), or the cycle lemma (cf. [\cite=cylem]), which will be used in the next sections to obtain a formula in the general case.

The expression ([\ref=ballot]) constitutes a solution to the ballot problem. For this, we use a classical interpretation in terms of paths: we represent a vote for A by an up step, and a vote for B by a down step. The total number of countings of votes, or of paths from (0,0) to (a + b,a - b), is given by the binomial [formula]. The countings such that A stays ahead of B correspond to paths remaining above the horizontal axis. Their number is given by B(a,b). This implies that the probability asked for at the beginning of this section is [formula].

Of course , we could have used expression ([\ref=ballot]) to prove Proposition [\ref=prop1] by a simple computation, but our proof explains more about the combinatorial objects and can be adapted to ternary trees in the next section.

It should be mentionned here that our study of multivariate Fuss-Catalan has nothing to do with the many-candidate ballot problem, as considered for example in [\cite=zeilb] or [\cite=nath]. In particular, the multivariate ballot numbers considered in these papers do not sum to the Fuss-Catalan numbers [formula]. Conversely, the numbers studied in the present article do not give any answer to the generalized ballot problem.

Remark 1.3. Our Catalan array presents similarities with Riordan arrays, but it is not a Riordan array. It may be useful to explicate this point. We recall (cf. [\cite=riordan]) that a Riordan array [formula] is defined with respect to 2 generating functions

[formula]

and is such that

[formula]

We easily observe that a Riordan array with the first two columns M0(x) and M1(x) of our Catalan array is relative to [formula] and [formula], which gives the Pascal triangle.

In fact, the Riordan array relative to [formula] and [formula] gives the ballot numbers, but requires knowledge of the Catalan numbers.

Fuss-Catalan tetrahedron and ternary trees

Definitions

This section, which is the heart of this work, is the study of a 3-dimensional analogue of the Catalan triangle of the previous section. That is we consider exactly the same recurrence, and let the array grow, not in 2, but in 3 dimensions. More precisely, we introduce the sequence B3(n,k,l) indexed by a positive integer n and nonnegative integers k and l, and defined recursively by:

B3(1,0,0) = 1;

[formula], k + l < n, [formula];

[formula], B3(n,k,l) = 0.

Observe that the recursive formula in the second condition is equivalent to:

[formula]

and this expression can be used to make some computations lighter, but the presentation above explains more about the generalization of the definition of the ballot numbers B(n,k).

Because of the planar structure of the sheet of paper, we are forced to present the tetrahedron of B3(n,k,l)'s by its sections with a given n.

[formula]

[formula]

[formula]

[formula]

[formula]

It is clear that B3(n,k,0) = B3(n,0,k) = B(n,k). The reader may easily check that when we compute [formula], we obtain: 1, 3, 12, 55, 273. These integers are the first terms of the following sequence (cf. [\cite=njas]):

[formula]

This fact will be proven in Proposition [\ref=prop2].

Combinatorial interpretation

Fuss-Catalan numbers (cf. [\cite=FC] [\cite=hilton]) are given by the formula

[formula]

and C3(n) appear as order-3 Fuss-Catalan numbers. The integers C3(n) are known [\cite=njas] to count ternary trees, ie. trees in which every internal node has exactly 3 sons.

Ternary trees are in bijection with 2-Dyck paths, which are defined as paths from (0,0) to (3n,0) with steps (1,1) and (1, - 2), and remaining above the line y = 0. The bijection between these objects is the same as in the case of binary trees, ie. a depth-first search, with the difference that here an internal node is translated into a (1, - 2) step. To illustrate this bijection, we give the path corresponding to the previous example of ternary tree:

We shall consider these paths with respect to the position of their down steps. The height of a down step is defined as the height of its end-point. Let Dn,k,l denote the set of 2-Dyck paths of length 3n, with k down steps at even height and l down steps at odd height, excluding the last seqence of down steps. By definition, the last sequence of down steps is of length n - k - l.

We have

[formula]

Moreover, B3(n,k,l) is the cardinality of Dn,k,l.

Let k and l be fixed. Let us consider an element of Dn,k,l. If we cut this path after its (2n - 2)-th up step, and complete with down steps, we obtain a 2-Dyck path of length 3(n - 1) (see figure below). It is clear that this path is an element of Dn,i,j for some i  ≤  k and j  ≤  l. We can furthermore reconstruct the original path from the truncated one, if we know k and l. We only have to delete the last sequence of down steps (here the dashed line), to draw k - i down steps, one up step, l - j down steps, one up step, and to complete with down steps. This gives a bijection from Dn,k,l to [formula], which implies Proposition [\ref=prop2].

Remark 2.2. It is interesting to translate the bi-statistic introduced on 2-Dyck paths to the case of ternary trees. As previously, we consider the depth-first search of the tree, and shall not consider the last right string. We define Tn,k,l as the set of ternary trees with n internal nodes, k of them being encountered in the search after an even number of leaves and l after and odd number of leaves. By the bijection between trees and paths, and Proposition [\ref=prop2], we have that the cardinality of Tn,k,l is B3(n,k,l).

Remark 2.3. It is clear from the definition that:

[formula]

But this fact is not obvious when considering trees or paths, since the statistics defined are not clearly symmetric. To explain this, we can introduce an involution on the set of ternary trees which sends an element of Tn,k,l to Tn,l,k. To do this, we can exchange for each node of the last right string its left and its middle son, as in the following picture. Since the number of leaves of a ternary tree is odd, every "even" node becomes an odd one, and conversely.

Explicit formula

Now a natural question is to obtain explicit formulas for the B3(n,k,l). The answer is given by the following proposition.

The integers B3(n,k,l) are given by

[formula]

We use a combinatorial method to enumerate Dn,k,l. The method is a variation of the cycle lemma [\cite=cylem] (called "penetrating analysis" in [\cite=gopal]).

If we forget the condition of "positivity" (ie. the path remains above the line y = 0), and cut the last down sequence, a path consists in:

at even height: n up steps, and k down steps;

at odd height: n up steps and l down steps.

An important remark is to remember that an element of Dn,k,l has an up step just before the last sequence of down steps! If we suppose that all these steps are distinguished, we obtain:

[formula] choices for even places;

[formula] choices for odd places (we cannot put any odd down step after the last odd step).

Now we group the paths which are "even permutations" of a given path P. By even permutations, we mean cycle permutations which preserve the parity of the height of the steps.

We want to prove that the proportion of elements of Dn,k,l in any even orbit (i.e. in any orbit under even permutations) is given by [formula].

We suppose first that the path P is acyclic (as a word): P cannot be written as P = Up with U a word in the two letters (1,1) and (1, - 2). It is clear that such a path gives n + k different even permutations. Now we have to keep only those which give elements of Dn,k,l. To do this we consider the concatenation of P and P', which is a duplicate of P.

The cyclic permutations of P (not necessarily even) are the subpaths of P + P' of horizontal length 2n + k + l. The number of such paths that remain above the horizontal axis, and end with an up step, is the number of (up) steps of P in the light of an horizontal light source coming from the right. The only transformation is to put the illuminated up step at the end of the path. The number of illuminated up steps is 2n - 2k - 2l, since every down step puts two up steps in the shadow. Among these 2n - 2k - 2l permutations, only half are even (observe that the set of heights of the illuminated steps is an interval). Thus n - k - l paths among the n + k elements of the orbit are in Dn,k,l.

Now we observe that if P is p-cyclic, then its orbit has p times less elements, and we obtain p times fewer different paths, whence the proportion of elements of elements of Dn,k,l in this orbit is:

[formula]

Finally, we obtain that the cardinality of Dn,k,l is

[formula]

which was to be proved.

Remark 2.5. The equation ([\ref=prop2.1eq]) is of course symmetric in k and l:

[formula]

Remark 2.6. I made the choice to present a combinatorial proof of Proposition [\ref=prop2.1]. The interest is to show how these formulas are obtained, and to allow easy generalizations (cf. the next section). It is also possible to check directly the recurrence ([\ref=rec]).

Generating function

Let F denote the following generating series:

[formula]

In this expression, the term "1" corresponds to the empty 2-Dyck path. Thus F is the generating series of 2-Dyck paths with respect to their length (variable t), their number of down steps at even height -excluding the last down sequence- (variable x), and their number of down steps at odd height (variable y).

We also introduce

[formula]

ie. G is the generating function of 2-Dyck paths with respect to their length, to the number of down steps at even height -including the last down sequence- and to the number of down steps at odd height.

To obtain equations for F and G, we decompose a non-empty 2-Dyck path by looking at two points: α, defined as the last return to the axis (except the final point (3n,0)), and β defined as the last point at height 1 after α. This gives the following decomposition of a 2-Dyck path

[formula]

with P1, P2, P3 any 2-Dyck path (maybe empty).

By observing that the up steps after α and β change the parity of the height, this gives the two following equations :

[formula]

and in the same way

[formula]

By permuting the variables x and y in ([\ref=Geq]), we obtain

[formula]

and we can eliminate G(t,y,x) from ([\ref=Geq]) and ([\ref=Geq2]) to obtain the following result.

The generating function F of the B3's is given by:

[formula]

where G(t,x,y) is a solution of the algebraic equation

[formula]

An alternate approach to the generating function is to use formula [\ref=prop2.1eq] to obtain what MacMahon called a "redundant generating function " (cf. [\cite=gessel]), since it contains terms other than those which are combinatorially significant.

To do this we extend the recursive definition of B3(n,k,l) as follows: we define B'3(n,k,l) for integers n > 0, and [formula] by:

[formula]

Of course when k + l > n, the integer B'3(n,k,l) is negative.

As an example, here is the "section" of the array of B'3(n,k,l) with n = 3.

[formula]

The equation ([\ref=prime]) is equivalent to the following recursive definition: [formula] or k,l < 0, B'3(n,k,l) = 0 and

[formula]

[formula]

The interest of this presentation is to give a simple (rational!) generating series. Indeed, it is quite simple to deduce from the recursive definition of B'3(n,k,l) that:

[formula]

This formula then encodes the B3(n,k,l) since [formula].

Fuss-Catalan p-simplex and p-ary trees

The aim of this final section is to present an extension of the results of Section 2 to p-dimensional recursive sequences. In the same spirit, we define the sequence [formula] by the recurrence:

[formula];

[formula] and [formula],

[formula]

[formula], [formula].

Every result of Section 2 extends to general p. We shall only give the main results, since the proofs are straightforward generalizations of the proofs in the previous section.

[formula]

The integers Cp(n) are order-p Fuss-Catalan numbers and enumerate p-ary trees, or alternatively p-Dyck paths (the down steps are (1, - p)). In this general case, the recursive definition of [formula] gives rise to p - 1 statistics on trees and paths analogous to those defined in section 3.

Remark 3.2. By the same method as in the previous section, it is possible to obtain an explicit formula for these multivariate Fuss-Catalan numbers:

[formula]

Comment. The numbers B3(n,k,l) first arose in a question of algebraic combinatorics (cf. [\cite=aval]). Let In be the ideal generated by B-quasisymmetric polynomials in the 2n variables [formula] and [formula] (cf. [\cite=BH]) without constant term. We denote by [formula] the quotient [formula] and by [formula] the bihomogeneous component of [formula] of degree k in [formula] and degree l in [formula]. It is proven in [\cite=aval] that:

[formula]

Acknowledgement. The author is very grateful to referees (and in particular to the anonymous "Referee 3") for valuable remarks and corrections.