Lemma Corollary Proposition

Adjacency preserving mappings on real symmetric matrices

Keywords: real symmetric matrix, adjacency preserving map, rank, geometry of matrices, Lorentz separation zero. AMS classification: 15A03, 15A04, 15A30, 15A57, 16S50, 16W10, 17A15, 17C55.

Introduction

Wen-Ling Huang and Peter emrl in [\cite=ws] characterized adjacency preserving maps from Hn to Hm, where Hn denotes the n  ×  n hermitian matrices over [formula]. They improved the results going back to Hua ([\cite=h], [\cite=h1]). See also [\cite=p1]-[\cite=p9], [\cite=w1]-[\cite=w5]. This article considers adjacency preserving mappings from Sn to Sm, where Sn denotes the n  ×  n symmetric matrices over [formula]. The authors of [\cite=ws] suggested this problem in their article. It turns out that the ideas and methods of their paper work in the real case as well (with modifications in some places).

The proof of the complex case uses results by Wen-Ling Huang, Roland Höfer and Zhe-Xian Wan [\cite=whw], which hold in the real case as well. We also take advantage of a theorem of Alexandrov [\cite=a] on Minkowski geometries. Alternatively, we can use the the recent result [\cite=w] of Wen-Ling Huang on adjacency preserving maps from S2 to S2. (This paper is also based on projective geometry.)

The main result of this paper is Theorem [\ref=theorem:main].

Notation

We will consider only matrices over [formula]. Let [formula] be the space of all n  ×  n matrices. Let Sn denote the linear subspace of all symmetric matrices in Mn, i.e. all A∈Mn such that A = AT, where AT is the transpose of A. Let GL(n) denote the group of all invertible matrices in Mn. Let [formula] denote the real linear span of a set Z (in some vector space). We will often look at matrices in Mn as linear operators on [formula]. So for A∈Mn, [formula] is the image of A or the column space of A.

If we consider [formula] as n  ×  1 matrices, [formula] is the rank one matrix with the property [formula] for [formula].

If P∈Sn and P2 = P = PT  ≠  0, then we call P a projection, as it is the orthogonal projection on [formula]. Two projections P,Q are orthogonal, [formula], iff PQ = 0. If x is a unit vector, then [formula] is the projection on [formula].

Let [formula] be the standard basis in [formula] and let [formula] be the matrix unit, i.e. the matrix with 1 in place (i,j) and zeros elsewhere.

We know that for R,T∈Mn, [formula] and so [formula][formula].

For A,B∈Sn let [formula]. Then (Sn,d) is a metric space. We will often use

Let A,B,C∈Mn and A + B = C. Then [formula] iff [formula].

Two matrices A,B are adjacent if d(A,B) = 1, i.e. [formula]. If d(A,B) = k, there is a sequence of consecutively adjacent matrices [formula] (see Proposition 5.5 in [\cite=wan]). Conversely, if there is such a sequence, it is straightforward that d(A,B)  ≤  k.

Let A,B∈Sn be adjacent. The line [formula] joining A and B is the set consisting of A,B and all Y∈Sn, which are adjacent to both A and B. By [\cite=wan],

[formula]

If P∈Sn is a projection, let [formula].

For A,B,S∈Sn, R∈GL(n), and [formula] we have d(A + S,B + S) = d(A,B) = d(RART,RBRT) = d(cA,cB). Consequently, these are equivalent:

Let Φ:Sn  →  Sm be a map preserving adjacency, i.e. A is adjacent to B implies Φ(A) is adjacent to Φ(B). Let Ψ(A) = Φ(A) - Φ(0) for A∈Sn. Then Ψ is adjacency preserving and Ψ(0) = 0.

Let m, n be natural numbers, n  ≥  2. Let Φ:Sn  →  Sm be a map preserving adjacency, with Φ(0) = 0. Then either:

In this case we say Φ is a degenerate adjacency preserving map.

In this case we say Φ is a standard map. (Obviously, in this case m  ≥  n.)

Preliminary results

We borrow Lemma 2.1. in [\cite=whw]:

Let G∈Sn and let l be a line in Sn. Then either:

Let A∈Sn be adjacent to both R and λR, where R∈Sn has rank one and λ  ≠  1. Then A = μR for some [formula], μ  ≠  1,λ.

Proof: Since λ  ≠  1, R and λR are adjacent and A is contained in the line l(R,λR). So A = R + μ'(R - λR) = μR and μ  ≠  λ,1.

[formula]

The following lemma is slightly more general then Lemma 2.3. in [\cite=ws].

Let P∈Mn be an idempotent and A,B∈Mn such that P = A + B and [formula]. Then A,B are idempotents and AB = BA = 0.

Proof: By Lemma [\ref=lemma:l1], [formula]. So if Px = 0, Ax = Bx = 0 and thus ker P  ⊂   ker A. For [formula], Py = y = Ay + By, hence y - Ay = By. Since [formula], we have By = 0. Thus BA = 0 and A2 = A. By symmetry, AB = 0 and B2 = B.

[formula]

Let [formula] be mutually orthogonal rank one projections and [formula]. Let [formula] be an orthonormal system in [formula] such that Pi(ξ(i)) = ξ(i) for [formula]. Then Pi(ξ(j)) = δijξ(j). Let V be the orthogonal matrix defined by Vei  =  ξ(i) for [formula], so that ξ(i) is the i - th column of V. Then VTPiV = Eii for [formula]. If [formula], then

[formula]

where q(A)∈Sk. We have q(Pi) = Eii for [formula] and [formula].

The mapping q:PSnP  →  Sk is linear, bijective, and q(AB) = q(A)q(B) for A,B,AB∈PSnP. So q(A2) = q(A)2 and q is a Jordan isomorphism. It preserves the distance d and thus adjacency. Also q(ABA) = q(A)q(B)q(A) for all A,B∈PSnP. All these properties are shared by the mappings h:Sk  →  Sn and q- 1:Sk  →  PSnP, where

[formula]

and q- 1(B) = Vh(B)VT.

Let k,n be natural numbers with 3  ≤  k  ≤  n. Let [formula] be nonzero real numbers and [formula] mutually orthogonal rank one projections. Let [formula]. Let B∈Sn have [formula] and let B be adjacent to A  -  λiPi for all i. Assume that d(B,λiPi) = k - 1 for all i. Then B = A.

Proof: By Lemma [\ref=lemma:l1], [formula]. So [formula] for all i. If [formula], then [formula] and [formula], so [formula] and consequently PB = B = BP. Thus A,B∈PSnP. Using notation from Lemma [\ref=lemma:l5], q(A),q(B)∈Sk and q(B) is adjacent to q(A) - λiq(Pi), d(q(B),λiq(Pi)) = k - 1. Also, [formula] and q(A),q(B) have maximal rank as elements in Sk. Thus we may assume that k = n and A,B are invertible in Sn, [formula].

Now [formula]. But [formula], so λiA- 1Pi = Pi. Let C = B- 1A∈Mn. Then C∈GL(n) and [formula].

Now I = (I - C(I - Pi)) + C(I - Pi) and [formula]. By Lemma [\ref=lemma:l3], C(I - Pi) is an idempotent.

Let [formula] be an orthonormal basis of [formula] such that Pifi = fi. Then for j  ≠  i, (I - Pi)fj = fj, so Cfj = C(I - Pi)fj = C(I - Pi)C(I - Pi)fj = C(I - Pi)Cfj. Since C is invertible,

[formula]

Let [formula]. Then [formula]. So am = 0 for m  ≠  i,j and aj = 1. Thus Cfj = fj + aifi. Since n  ≥  3, there exists k, 1  ≤  k  ≤  n, k  ≠  i,j. So Cfj = fj + akfk also. Thus Cfj = fj for all j and C = I. This implies A = B.

[formula]

Let A,B∈Sm and let [formula]. If [formula] for every [formula], then B = 0.

Proof: If [formula], then there exists a nonsingular 2  ×  2 submatrix in B. For λ  ≠  0, we have [formula] for λ large enough, since the chosen submatrix of [formula] will be nonsingular. Therefore, [formula].

If B  ≠  0, then B is adjacent to 0. Also, A + B is adjacent to 0 and B, so A + B∈l(B,0). Thus A + B = μB and A + (1 - μ)B = 0 - a contradiction.

[formula]

Let A,B∈Sn have [formula], with A  ≠  B. There exists a natural number k and invertible matrices [formula] such that the neighbours in this sequence are adjacent and there is a matrix Cj∈l(Aj,Aj + 1) with [formula] for [formula].

Proof: This is a consequence of Lemmas 2.5 and 2.6 in [\cite=whw] and is stated in the proof of Lemma 3.1 in the same paper.

Let Φ:Sn  →  Sm be an adjacency preserving map. Let A,B∈Sn be adjacent. Then Φ(l(A,B))  ⊂  l(Φ(A),Φ(B)). The restriction of Φ to l(A,B) is injective.

Proof: If λ1  ≠  λ2 and Ci = A + λi(B - A)∈l(A,B) (i = 1,2), then C1 is adjacent to C2 and therefore Φ(C1) is adjacent to Φ(C2), thus Φ(C1)  ≠  Φ(C2).

[formula]

Let Φ:Sn  →  Sm (n  ≥  2) be a map preserving adjacency and Φ(0) = 0. Let [formula]. If k  ≥  2 and for every singular A∈Sn we have [formula], then [formula] for every invertible B∈Sn.

Proof: Let [formula] with A  ≠  B and let [formula]. By Lemma [\ref=lemma:l8], there exists a natural number r and invertible matrices [formula] such that the neighbours in this sequence are adjacent and for [formula] there is a matrix Cj∈l(Aj,Aj + 1) with [formula]. Hence [formula]. Now [formula], [formula], [formula]. Lemma [\ref=lemma:l2] (for G = 0) tells us that Φ(C0) is the only point on the line l(Φ(A),Φ(A1)) with rank less than k. Since C0  ≠  A1 , Lemma [\ref=lemma:l9] tells us that Φ(C0)  ≠  Φ(A1). So [formula]. Proceeding in this way we find [formula] for all j, so [formula].

[formula]

Let Φ:Sn  →  Sm (n  ≥  2) be a map preserving adjacency. If there are A,B∈Sn with d(Φ(A),Φ(B)) = n, then d(Φ(X),Φ(Y)) = d(X,Y) for all X,Y∈Sn and Φ is injective.

Proof: For n = m this was proved (in even greater generality) by Wen-ling Huang (Corollary 3.1 in [\cite=wh2]).

We know that d(X,Y) = k  ≥  1 implies the existence of a sequence [formula] of consecutively adjacent matrices. If Ψ:Sn  →  Sm is adjacency preserving, the neighbours in the sequence [formula] are also adjacent and therefore d(Ψ(X),Ψ(Y))  ≤  k. So

[formula]

for any adjacency preserving map Ψ.

Now the map Ψ, defined by Ψ(X) = Φ(X + A) - Φ(A) for X∈Sn is adjacency preserving by Proposition [\ref=proposition:p1] and Ψ(0) = 0. We note that [formula].

If Z∈Sn is singular, [formula]. Lemma [\ref=lemma:l10] tells us that [formula] for every [formula]. In particular, if d(C,A) = n, i.e. [formula], then [formula].

Let X,Y∈Sn be such that d(X,Y) = n. For λ large enough, [formula] and d(λI,X) = n. If we set C = λI above, we see d(Φ(λI),Φ(A)) = n. We may substitute λI for A, A for B in the previous argument and get d(Φ(λI),Φ(X)) = n. Repeating this procedure we get d(Φ(X),Φ(Y)) = n.

We have proven that d(X,Y) = n implies d(Φ(X),Φ(Y)) = n. Suppose now [formula], with k  ≥  1. There is U orthogonal such that [formula], with [formula] nonzero. Let [formula]. Then [formula] and (Z - W) + (W - G) = Z - G is invertible. Since Φ does not increase the metric d, n = d(Z,G) = d(Z,W) + d(W,G)  ≥  d(Φ(Z),Φ(W)) + d(Φ(W),Φ(G))  ≥  d(Φ(Z),Φ(G)) = n. So d(Z,W) = d(Φ(Z),Φ(W)).

If Φ(X) = Φ(Y) and X  ≠  Y, then d(X,Y)  ≥  1, so d(Φ(X),Φ(Y))  ≥  1 - a contradiction.

[formula]

Let m > n  ≥  2 and let A1,B1∈Sn with A1  ≠  B1. If A,B∈Sm are such that

[formula]

and C is adjacent to both A and B, then there is C1∈Sn such that

[formula]

Proof: The matrices A - C and C - B have rank one. So A - B = (A - C) + (C - B) has rank one or two. If A is adjacent to B, then C lies one the line l(A,B), so C = A + λ(B - A) has the desired form.

If A - B has rank two, then [formula] by Lemma [\ref=lemma:l1]. So [formula] and C = A - (A - C) has the desired form.

[formula]

Let m > n  ≥  2 and let Φ:Sn  →  Sm be an adjacency preserving map with Φ(0) = 0. Let

[formula]

where K∈Sn has rank n. Then for all A∈Sn,

[formula]

where A1∈Sn.

Proof: Since n = d(Φ(I),Φ(0)), Lemma [\ref=lemma:l11] tells us that d preserves the distance. Suppose P∈Sn is a projection of rank one. Then d(0,P) = 1, d(I,P) = n - 1, so d(Φ(I),Φ(P)) = n - 1 and d(0,Φ(P)) = 1. Thus

[formula]

By Lemma [\ref=lemma:l1], [formula], so [formula] and Φ(P) has the desired form.

If A = λP, then A lies on the line l(0,P), so Φ(A) lies on the line l(0,Φ(P)), so Φ(A) = μΦ(P) has the desired form.

Now we use the induction on the rank of A. Suppose we have proved the lemma for all matrices of [formula]. Let [formula]. There is U orthogonal and nonzero numbers [formula] such that [formula]. The matrix A is adjacent to [formula] and to [formula]. So Φ(A) is adjacent to

[formula]

where B1,C1∈Sn and B1  ≠  C1. By Lemma [\ref=lemma:l11], Φ(B)  ≠  Φ(C). We use Lemma [\ref=lemma:l12].

[formula]

Adjacent matrices in S2

Wen-Ling Huang proved the following result (Corollary 2 in [\cite=w]):

Let Φ:S2  →  S2 be an adjacency preserving map. Suppose there are A,B∈S2 such that Φ(A) and Φ(B) are not adjacent. Then there are [formula] and T∈GL(2), S∈S2 such that Φ(X) = cTXTT + S for X∈S2.

This Corollary implies the main result of this section, Proposition 3.5. But we can also proceed in a way analoguous to that in [\cite=ws].

Let Φ:S2  →  S2 be a map such that A is adjacent to B iff Φ(A) is adjacent to Φ(B). Then Φ is injective.

Proof: If there are A,B∈S2 such that d(Φ(A),Φ(B)) = 2, then, by Lemma [\ref=lemma:l11], Φ is injective.

Suppose now that d(Φ(X),Φ(Y))  ≤  1 for all X,Y∈S2. We will show this is impossible. Since E11 and E22 are not adjacent, Φ(E11) and Φ(E22) are not adjacent. Therefore Φ(E11) = Φ(E22). Similarly, Φ(2E11) = Φ(E22). On the other hand, E11 is adjacent to 2E11, so Φ(E11) is adjacent to Φ(2E11) = Φ(E11) - a contradiction.

[formula]

We denote by Q the quadratic form on [formula], defined by [formula]. Then Q(x - y) is the Lorentz separation of x and y. A bijective linear transformation [formula] is a Lorentz transformation if Q(Lx) = Q(x) for all [formula]. All Lorentz transformations on [formula] form the Lorentz group. A mapping [formula] is a Weyl transformation if there are: [formula], a Lorentz transformation L and [formula] such that f(x) = αLx + b for all [formula].

The following theorem is due to Alexandrov [\cite=a]. We quote it from Lester [\cite=lester] p. 929, who rediscovered it.

Let D be an open connected subset of [formula] and let [formula] be an injective mapping such that Q(x - y) = 0 iff Q(f(x) - f(y)) = 0. Then f is the restriction of conformal mapping.

Any conformal mapping on [formula] is a Weyl transformation (see [\cite=lester], p. 929 or [\cite=pop], pp. 132-133) and that is all we will need:

Let [formula] be an injective mapping such that Q(x - y) = 0 iff Q(f(x) - f(y)) = 0. Then f is a Weyl transformation.

We have the linear bijection [formula], defined by

[formula]

Now det (Tx - Ty) =  det (T(x - y)) = Q(x - y). Therefore:

[formula]

The following is taken from the book [\cite=rr] on Hyperbolic Geometry by Ramsey and Richtmyer, pp. 246-250. If [formula] is a Lorentz matrix, then [formula] and [formula]. If det L = 1 and l33 > 1, then L is a restricted Lorentz matrix. If L is a restricted Lorentz matrix, then there is a matrix P1∈M2 with det P1 = 1 such that

[formula]

for all [formula]. Now K =  - E11 + E22 + E33  =  K- 1 is a Lorentz matrix with det K =  - 1. For Q = E12 + E21∈S2 we have T(Kx) = Q(Tx)QT.

If L∈M3 is any Lorentz matrix, then there is [formula] such that rL or LK or rLK is a restricted Lorentz matrix. It follows that for any Lorentz matrix L∈M3 we have

[formula]

where [formula], [formula] and [formula].

Let Φ:S2  →  S2 be a map such that A is adjacent to B iff Φ(A) is adjacent to Φ(B). Then there exist [formula], R∈GL(2) and S∈S2 such that

[formula]

Proof: We consider the mapping [formula], defined by

[formula]

By Lemma [\ref=lemma:l31], f is injective. If x  ≠  y and Q(x - y) = 0, then Tx is adjacent to Ty, so Φ(Tx) is adjacent to Φ(Ty), so Q(f(x) - f(y)) = 0. If f(x) = f(y), then x = y.

If f(x)  ≠  f(y) and Q(f(x) - f(y)) = 0, then Φ(Tx) is adjacent to Φ(Ty) by ([\ref=eqn:e31]), so Tx is adjacent to Ty and Q(x - y) = 0.

We see that Q(x - y) = 0 iff Q(f(x) - f(y)) = 0. By Corollary [\ref=corollary:c33], there exist [formula], [formula] and a Lorentz matrix L∈GL(3) such that f(x) = αLx + b for all [formula], hence

[formula]

By ([\ref=eqn:e32]), there are [formula] and P∈GL(n) such that

[formula]

i.e.

[formula]

for A∈S2, where [formula], R∈GL(2) and S∈S2.

[formula]

Let Φ:S2  →  S2 be an adjacency preserving mapping. Suppose d(Φ(G),Φ(H)) = 2 for some G,H∈S2. Then there are [formula], R∈GL(2) and S∈S2 such that

[formula]

Proof: By Lemma [\ref=lemma:l11], d(Φ(X),Φ(Y)) = d(X,Y) for all X,Y∈S2. So Φ(X) is adjacent to Φ(Y) iff X is adjacent to Y. We use Corollary [\ref=corollary:c34].

[formula]

Proof of theorem 1.4

Let n  ≥  2 and let Φ:Sn  →  Sm be a mapping preserving adjacency, Φ(0) = 0. Theorem [\ref=theorem:main] states that Φ is either degenerate or a standard map.

Theorem [\ref=theorem:main] is true if n = 2.

Proof: If m = 1, Φ is a degenerate map. Let m  ≥  2. We consider two cases.

Case 1: Let d(Φ(A),Φ(B))  ≤  1 for all A,B.

Then [formula] for all A. Since E11 is adjacent to 0, Φ(E11) is adjacent to Φ(0) = 0, so [formula]. Let A∈S2. Then d(Φ(A),Φ(E11))  ≤  1. So Φ(A) = Φ(E11) or Φ(A) is adjacent to Φ(E11). In the latter case, if Φ(A)  ≠  0, then Φ(A) is adjacent to 0, so Φ(A)∈l(0,Φ(E11)), thus Φ(A) = λΦ(E11). So Φ(A) = λΦ(E11) in any case. Thus Φ is a degenerate map.

Case 2: We have A,B∈S2 such that d(Φ(A),Φ(B)) = 2.

If m = 2, then Proposition [\ref=proposition:p35] ends the proof. Let m > 2. By Lemma [\ref=lemma:l11], Φ preserves the distance and is injective. So [formula]. Since Φ(I)∈Sm, there is U∈Mm orthogonal such that

[formula]

Let Ψ(A) = UΦ(A)UT for A∈S2. Then Ψ is distance preserving and Ψ(0) = 0. By Lemma [\ref=lemma:l13],

[formula]

where Ψ1(A)∈S2 and Ψ1(0) = 0.

Obviously, d(Ψ(A),Ψ(B)) = d(Ψ1(A),Ψ1(B)). So Ψ1:S2  →  S2 is distance preserving. By Proposition [\ref=proposition:p35], there are [formula] and R∈GL(2) such that Ψ1(A) = cRART. Let

[formula]

Then

[formula]

and

[formula]

[formula]

Let n  ≥  2 and let Φ:Sn  →  Sm be a map preserving adjacency, with Φ(0) = 0. Let

[formula]

where In∈Mn is the identity matrix. Then we can find U∈Mn orthogonal such that for all A∈Sn we have

[formula]

Proof: Obviously m  ≥  n. If m > n, then by Lemma [\ref=lemma:l13], for all A∈Sn we have

[formula]

where Φ1(A):Sn  →  Sn and Φ1(I) = I. Also Φ1(0) = 0 and Φ1 preserves adjacency. Thus it suffices to prove the theorem for m = n. We wil use induction on n. We know our Lemma is true for n = 2 using Proposition [\ref=proposition:p35]. Suppose it is valid for n - 1, where n  ≥  3.

Let P∈Sn be a projection with [formula]. Since d(Φ(I),Φ(0)) = n, Lemma [\ref=lemma:l11] says d(Φ(A),Φ(B)) = d(A,B) for all A,B∈Sn. So [formula] for all A and [formula]. Since d(I,P) = n - k, we have d(I,Φ(P)) = n - k, so I = Φ(P) + R1, where [formula]. By Lemma [\ref=lemma:l4], Φ(P) = Q is a projection. So Φ maps projections into projections of the same rank.

Suppose k = n - 1. By Lemma [\ref=lemma:l5], there is a Jordan isomorphism q:PSnP  →  Sn - 1 which preserves the distance d.

Since Q is similar to [formula], there is W∈Mn orthogonal such that

[formula]

We define f1:Sn - 1  →  Sn by f1(B) = WΦ(q- 1(B))WT. Then

[formula]

We use the induction hypothesis. There is U1∈Mn - 1 orthogonal � such that for B∈Sn - 1

[formula]

For A∈PSnP we have

[formula]

The mapping Φ restricted to PSnP is a Jordan isomorphism (in particular linear) and if AB = 0, then Φ(A)Φ(B) = 0. Thus Φ maps projections in PSnP into projections of the same rank and preserves the orthogonality of projections in PSnP.

Since n  ≥  3, for any rank one projections P1,P2∈Sn with P1P2 = 0 there is a projection P of rank n - 1 such that P1,P2∈PSnP. So Φ1(P1),Φ1(P2) are rank one projections and Φ(P1)Φ(P2) = 0.

Thus [formula] are mutually orthogonal rank one projections. By Lemma [\ref=lemma:l5], there is V∈Mn orthogonal such that VΦ(Eii)VT = Eii ([formula]). By exchanging Φ with the map A  ↦  VΦ(A)VT we may assume Φ(Eii) = Eii for [formula].

Let j  ≠  i and R = Eii + Ejj. Since n  ≥  3, there is a projection P of rank n - 1 such that RSnR  ⊂  PSnP. By the preceding paragraph Φ(R) = Φ(Eii) + Φ(Ejj) = Eii  +  Ejj = R and for A∈RSnR we have Φ(A) = Φ(R)Φ(A)Φ(R) = RΦ(A)R, so Φ(A)∈RSnR. Also, Φ restricted to RSnR is linear, injective, preserving the products (if the products are in RSnR).

By Lemma [\ref=lemma:l5], we have the Jordan isomorphism q:RSnR  →  S2, such that q(Eii) = E11 and q(Ejj) = E22. The map K = qΦq- 1:S2  →  S2 is adjacency preserving, K(0) = 0, K(I2) = I2. By the induction hypothesis, there is U2∈M2 orthogonal such that K(B) = U2BUT2 for B∈S2. Since K(E11) = E11, K(E22) = E22, [formula], with [formula]. It follows there is [formula] such that K(E12 + E21) = wij(E12 + E21), hence Φ(Eij + Eji) = wij(Eij + Eji) and Φ(αEii  +  β(Eij + Eji) + γEjj) = αEii + wijβ(Eij + Eji) + γEjj for [formula]. Let wii = 1 for all i.

For [formula] let B = Eii + b(Eij + Eji) + b2Ejj∈Sn. Then B has rank one and B∈RSnR. If [formula] has rank one, then there exists a projection Q with [formula] such that A,B∈QSnQ. Since Φ restricted to QSnQ is a Jordan map, Φ(BAB) = Φ(B)Φ(A)Φ(B). Also B = BR = RB and so BAB = B(RAR)B. But RAR = aiiEii  +  aij(Eij + Eji) + ajjEjj. We know that Φ(B) = Eii + wijb(Eij + Eji) + b2Ejj, so RΦ(B) = Φ(B)R and Φ(B(RAR)B) = Φ(BAB) = Φ(B)Φ(A)Φ(B) = (Φ(B)R)Φ(A)(RΦ(B)). So

[formula]

If [formula], RΦ(A)R = aii'Eii + aij'(Eij + Eji) + ajj'Ejj. Equation [\ref=eq:421] implies aii' = aii, ajj' = ajj and aij' = wijaij. So for all i,j

[formula]

Suppose now T∈Sn is such that tij = 1 for all i,j. Then T has rank one and consequently [formula] has rank one. There exists [formula] such that Φ(T) = λQ2, where Q2 is a rank one projection. There exists a unit vector [formula] such that [formula]. Now [formula]. So λ > 0. Therefore, if [formula], then [formula], so wij = yiyj for all i,j. But wii = y2i = 1, so [formula] for all i. Therefore, if [formula], VT2 = V2 is orthogonal: V22 = I and Φ(A) = V2AV2. Thus V2Φ(A)V2 = A for all A∈Sn with [formula]. By exchanging Φ with the map A  →  V2Φ(A)VT2 we may assume Φ(A) = A for all A∈Sn with [formula].

Suppose B∈Sn has rank less than n. Then [formula], where [formula] and Pi are mutually orthogonal rank one projections. Let [formula]. Since Φ, restricted to PSnP is linear,

[formula]

Let C∈Sn be invertible. Again, [formula], where αi  ≠  0 and Qi are mutually orthogonal rank one projections. Let G = C - αiQi. Then [formula]. Also G is adjacent to C, so the same is true for Φ(C) and Φ(G) = G = C - αiQi. Since Φ preserves the distance, we have [formula]. Since [formula], Lemma [\ref=lemma:l6] implies Φ(C) = C.

[formula]

Let Φ:Sn  →  Sm (m,n  ≥  3) be an adjacency preserving map and Φ(0) = 0. Suppose that for every projection P∈Sn with [formula] there is a rank one projection Q such that [formula]. Then Φ is a degenerate adjacency preserving map.

Proof: Let P,P1∈Sn be projections of rank n - 1. Let [formula] and [formula], where Q,Q1 are rank one projections. There is a projection R of rank one such that [formula]. Since R is adjacent to 0, Φ(R) is adjacent to 0, so Φ(R) = λQ = μQ1 with λ,μ  ≠  0. Thus Q = Q1 and [formula] for all B∈Sn with [formula]. There is an orthogonal matrix V such that VQVT = E11. Exchanging Φ for the map X  ↦  VΦ(X)VT we may assume Q = E11. So [formula] for all B with [formula].

If A∈Sn is invertible, then

[formula]

where λj are nonzero and Pj are mutually orthogonal rank one projections. So A is adjacent to [formula]. Thus Φ(A) is adjacent to Φ(B) = λE11 and [formula].

Case 1: Assume [formula] for all [formula].

We claim [formula]. Suppose, on the contrary, that there exists A invertible such that [formula]. Then [formula]. Let [formula] as in ([\ref=eqn:411]). Let [formula]. Then Z is adjacent to Φ(B) = λE11 and to 0. If λ  ≠  0, then Z lies on the line l(0,λE11) - a contradiction. So Φ(B) = 0. By Lemma [\ref=lemma:l9], Φ maps the line [formula] into the line [formula] injectively. So there is [formula] such that [formula]. Now [formula] is adjacent to A and [formula] is adjacent to B + λP1, so B1  =  Φ(C1) is adjacent to Z, B2  =  Φ(C2) is adjacent to [formula]. Both B1 and B2 are in [formula]. Since Z is adjacent to [formula], we have [formula]. So B1,B2 = 0 - a contradiction with the fact that B1,B2 are adjacent. Thus, if [formula] for all invertible A∈Sn, the proof is finished.

Case 2: Suppose there is [formula] with [formula].

By Lemma [\ref=lemma:l10], [formula] for every [formula]. So Φ(I) and Φ(I + E11) have rank two and are adjacent. Let [formula]. Then D is adjacent to I and to I + E11, implying that Φ(D) is adjacent to Φ(I). Thus Φ(D)  ≠  0 and Φ(D) = λE11 for some λ  ≠  0. Since Φ(D) is adjacent to Φ(I) and to Φ(I + E11), we have Φ(I) = λE11 + K and Φ(I + E11) = λE11 + K', with [formula]. We claim that

[formula]

In fact, if μ  ≠  0 and [formula], then K + μE11 is adjacent to 0 and to μE11, so K + μE11 is on the line l(0,μE11), so K + μE11  =  γμE11 - a contradiction to the fact that [formula].

Now [formula] and is adjacent to Φ(I) = λE11 + K. Thus [formula], which implies by ([\ref=eqn:431]) that λ  =  λ'. Also [formula] is adjacent to Φ(I + E11) = λE11 + K'. As before, λ'' = λ. But [formula] is adjacent to [formula], so λE11 is adjacent to λE11 - a contradiction.

So [formula] for all invertible A∈Sn and the proof is finished.

[formula]

Let Φ:Sn  →  Sm (m,n  ≥  3) be an adjacency preserving map with Φ(0) = 0. Assume that for every projection P with [formula] the restriction of Φ to PSnP is a standard map. Then Φ is a standard adjacency preserving map.

Proof: Let [formula]. There are [formula] and T∈GL(m) such that for B∈DSnD,

[formula]

If Ψ(X) = cT- 1Φ(X)(T- 1)T for X∈Sn, then Ψ(0) = 0, Ψ preserves adjacency and

[formula]

In particular, Ψ(E11) = E11. If Q is a rank one projection, then we claim Ψ(Q)  ≥  0. There exists a projection P of rank n - 1, such that E11,Q∈PSnP. The restriction of Φ to PSnP is a standard map. This is also true for the restriction of Ψ to PSnP. A standard map Ω has either the property X  ≥  0 implies Ω(X)  ≥  0 or X  ≥  0 implies -  Ω(X)  ≥  0. Since Ψ(E11)  ≥  0, Ψ(Q)  ≥  0.

Thus Ψ(Enn)  ≥  0 and Ψ(Enn) is adjacent to 0, so [formula]. So [formula] for some unit vector [formula] and s > 0. We show that [formula] (This implies m  ≥  n.). If [formula] and [formula], then by ([\ref=eq:441]) we have [formula]. There exists a projection P1 of rank n - 1 such that [formula]. But [formula]. Since the restriction of Ψ to PSnP is standard and thus injective, this is a contradiction.

We construct an invertible R∈Mm such that Rei = ei for [formula] and [formula]. Now [formula]. For i,j  ≤  n - 1 we have [formula]. We define Φ1:Sn  →  Sm by Φ1(X) = RΨ(X)RT. Then ([\ref=eq:441]) is true if we replace Ψ by Φ1. Also Φ1(Enn) = Enn.

Let Ri = I - Eii∈Sn. Then Rn = D and [formula], where [formula]. The restriction of Φ1 to RiSnRi is a standard map and thus linear. So [formula] for [formula].

Since I is adjacent to Ri, Φ1(I) is adjacent to E - Eii for all i. Thus

[formula]

Thus [formula]. If [formula], then [formula], so [formula] by Lemma [\ref=lemma:l1] and [formula] is a subspace in [formula] for all i. Thus [formula] and [formula] - a contradiction, since n  ≥  3.

Suppose [formula]. By ([\ref=eq:442]) we have Φ1(I) = (E - Eii) - Ti with [formula]. Let [formula] with yi a unit vector. If [formula] , then [formula] and that is a contradiction. So [formula] and [formula] for all i. Thus once again [formula] - a contradiction.

Thus [formula]. Now Φ1(I) is adjacent to E - Eii for all i. Also [formula]. By Lemma [\ref=lemma:l11], d(I,Eii) = n - 1 = d(Φ1(I),Φ1(Eii)) = d(Φ1(I),Eii). By Lemma [\ref=lemma:l6], Φ1(I) = E.

By Lemma [\ref=lemma:l42], we can find an orthogonal matrix U∈Mn such that for A∈Sn

[formula]

So Φ1 is a standard map and therefore Φ is a standard map.

[formula]

The statement of Theorem [\ref=theorem:main] is true for n = 3.

Proof: Let P∈S3 be any projection of rank 2. By [\ref=lemma:l41], the mapping Φ restricted to PS3P is either standard or degenerate. If Φ restricted to PS3P is degenerate for all projections P∈S3 of rank 2, Lemma [\ref=lemma:l43] tells us that Φ is degenerate. If Φ restricted to PS3P is standard for all such P, then Lemma [\ref=lemma:l44] tells us that Φ is a standard map.

Suppose there exist two projections P and Q of rank 2 such that Φ restricted to PS3P is degenerate and Φ restricted to QS3Q is standard. Then m  ≥  2. If R∈S3 has rank one, then R is adjacent to 0, so Φ(R) is adjacent to Φ(0) = 0 and has rank one. There exists a rank one matrix R1∈QS3Q such that the rank one matrices Φ(R),Φ(R1) are linearly independent. (If this is not true, then Φ(R1) = λ(R1)Φ(R) for all R1∈QS3Q. Since Φ restricted to QS3Q is standard and [formula], this is impossible.) There exists a rank two projection R2 such that R,R1∈R2S3R2. Then since Φ(R) and Φ(R1) are linearly independent, Φ restricted to R2S3R2 is not degenerate. Hence it is standard and therefore real linear. Thus for any rank one operator R∈S3 we have

[formula]

Let T∈S3. We define ΦT:S3  →  Sm by ΦT(X) = Φ(X + T) - Φ(T). Then ΦT(0) = 0 and ΦT is an adjacency preserving map by Proposition [\ref=proposition:p1].

We show that ΦT is neither standard nor degenerate. If ΦT was standard, then ΦT is real linear, so Φ(Y) = Φ((Y - T) + T) = ΦT(Y - T) + Φ(T) = ΦT(Y) - ΦT(T) + Φ(T). Letting Y = 0 we get 0 = Φ(0) = ΦT(0) + Φ(T) - ΦT(T) = Φ(T) - ΦT(T). So Φ  =  ΦT is standard - a contradiction.

If there exists a rank one operator G such that [formula] for all X∈S3, then for Y∈S3 we have Φ(Y) = ΦT(Y - T) + Φ(T) = Φ(T) + λ(Y)G. Thus 0 = Φ(T) + λ(0)G and Φ(Y) = (λ(Y) - λ(0))G for all Y∈S3 and Φ is degenerate - a contradiction.

As in the beginning of the proof of the Lemma, there are rank two projections PT and QT such that the restriction of ΦT to PTS3PT is degenerate and the restriction of ΦT to QTS3QT is standard. If R is a rank one matrix in S3, then by ([\ref=eq:451]) ΦT(λR) = λΦT(R) for [formula]. So Φ(λR + T) - Φ(T) = ΦT(λR) = λΦT(R) = λ(Φ(R + T) - Φ(T)), i.e.

[formula]

Now we will prove that if [formula] have rank one, then

[formula]

by induction on p. It is true for p = 1. Assume it holds for p. Let [formula] have rank one. Then

[formula]

by ([\ref=eq:452]), so by the induction hypotesis,

[formula]

Since [formula] is adjacent to [formula], we have [formula] is adjacent to [formula]. Thus

[formula]

has rank one for all [formula]. By Lemma [\ref=lemma:l7],

[formula]

If A∈S3, then [formula], where Pi∈S3 are rank one projections. So [formula]. It follows that Φ is linear.

Now Φ maps the rank two operator P into an operator of rank at most 1. By Lemma [\ref=lemma:l11], [formula] for all A∈S3.

Let [formula] be an orthonormal system such that Qfi = fi for i = 1,2. There exists U∈M3 orthogonal such that Uei = fi for i = 1,2. Then QUei = Uei and UTQUei = ei for i = 1,2. Since UTQU∈S3 has rank two, we have UTQU = E11 + E22 = E2. If A∈E2S3E2, then UTQUAUTQU = A, so Q(UAUT)Q = UAUT, so UAUT∈QS3Q. Now Φ restricted to QS3Q is standard. So there are [formula] and T invertible in Mm such that

[formula]

Therefore we may assume that for A∈E2S3E2 we have

[formula]

If F is any rank two projection in S3, the restriction of Φ to FS3F is either standard or degenerate. (Look at the beginning of the proof of this Lemma.) The matrix Φ(E33) is adjacent to 0. Hence [formula], where s  ≠  0 and x is a unit vector. If [formula], then [formula] has rank 3. But [formula]. So [formula] and hence Φ(E33)∈E2S3E2.

There exists a rank one projection R1∈E2S3E2 such that

[formula]

and Φ(E33) are linearly independent. There is a projection R2∈S3 of rank 2 such that R1,E33∈R2S3R2. The restriction of Φ to R2S3R2 is standard, since Φ(R1) and Φ(E33) are linearly independent.

Since Φ(R1) = h(R1)  ≥  0, Φ(E33)  ≥  0. So

[formula]

where c > 0 and P2∈S2 is a rank one projection. Let U1∈M2 be an orthogonal matrix such that UT1P2U1 = E22. We define matrices G∈M3, V∈Mm by

[formula]

Then GE33GT = c- 1E33, so [formula].

If we define Θ(X) = VTΦ(GXGT)V for X∈S3, then once more Θ:S3  →  Sm is a linear adjacency preserving map with Θ(E33) = E22. If A∈E2S3E2, then GAGT∈E2S3E2, so

[formula]

If P1 is a rank two projection in S3, then, as before, Θ restricted to P1S3P1 is either standard or degenerate. Now Θ(E22 + E33) = 2E22, so Θ restricted to (E22 + E33)S2(E22 + E33) is degenerate. Therefore, Θ(E23 + E32) = αE22, with α  ≠  0.

Since Θ(E11 + E33) = E11 + E22 has rank two, the restriction of Θ to (E11 + E33)S3(E11 + E33) is a standard map. As before, there are [formula] and W1∈GL(m) such that for A∈(E11 + E33)S3(E11 + E33) we have

[formula]

But Θ(E11) = E11 and Θ(E33) = E22. So

[formula]

This implies c1 = 1 and We1  =    ±  e1. By exchanging W with - W if necessary we may assume We1 = e1. Similarly, We3 = de2, where [formula]. This implies

[formula]

Let [formula]. Since A has rank 1, A is adjacent to 0, so Θ(A) is adjacent to 0 and has rank one. We calculate Θ(A) = E11 + (2 + α)E22 + (1 + d)(E12 + E21) and det Θ(A) = 2 + α - (1 + d)2  =  α - 2d = 0, since d2 = 1. So Θ(E23 + E32) = 2dE22.

Let now [formula]. Then B has rank one and is adjacent to 0. But Θ(B) = (1 - d2)E22 = 0 - a contradiction.

[formula]

End of proof of theorem [\ref=theorem:main]

Let n  ≥  4. Our induction hypothesis is that every adjacency preserving and zero preserving map from Sk to Sm (2  ≤  k < n) is either standard or degenerate. Let Φ:Sn  →  Sm be an adjacency preserving map and Φ(0) = 0.

Let P∈Sn be a projection of rank n - 1. By Lemma [\ref=lemma:l5] we know that PSnP is isomorphic to Sn - 1. By the assumption, Φ restricted to PSnP is either standard or degenerate. Let Q∈Sn be another projection of rank n - 1. There exists a projection R of rank n - 2  ≥  2 with PR = QR = R, so that [formula]. If Φ restricted to PSnP is degenerate, then Φ restricted to RSnR is degenerate, hence Φ restricted to QSnQ cannot be standard and is thus degenerate. By Lemma [\ref=lemma:l43], Φ is degenerate.

So if Φ restricted to PSnP is degenerate, then Φ is degenerate. The remaining possibility is that Φ restricted to PSnP is standard. Then obviously this is true if we replace P by Q. By Lemma [\ref=lemma:l43], Φ is standard.

Acknowledgement

The author thanks Professor Peter emrl for suggesting this problem to him and for providing the preprint of the article [\cite=ws]. He also thanks Professor Wen-ling Huang for preprints of [\cite=w] and [\cite=wh2].