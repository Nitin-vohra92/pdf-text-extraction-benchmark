Proposition Lemma Corollary Conjecture Question Claim

Definition Remark

Counting subspaces of a finite vector space

Background

The Gaussian binomial coefficients were introduced two hundred years ago by Carl Friedrich Gauss [\cite=summatio-quarumdam] as a tool to find a formula for the following sums, now called Gauss sums: Gauss had easily computed these sums up to sign in 1801, but it took him four years of intense effort to resolve the sign ambiguity; he solved the problem only in 1805. This aspect of Gaussian binomial coefficients makes for a fascinating story in itself, but we shall simply refer the reader to [\cite=BerndtEvans], where an exposition of Gauss's proof (among other things) can be found.

This article concentrates on a different aspect of Gaussian binomial coefficients: they arise as the answer to a counting problem in linear algebra involving finite fields. Vectors with real coordinates arise naturally in our efforts to describe nature by mathematics. Space is described by three real coordinates, space-time by four. Physicists need to keep track of the position and momentum of a particle in space in order to be able to predict is position in the future, leading to the use of six real coordinates for each particle.

Number theorists like to work with vectors with integer or rational coordinates: prospective solutions to Fermat's famous equation

[formula]

are vectors with three integer or rational coordinates. Finding out whether integer solutions exist to a given Diophantine equations can be notoriously difficult, as evidenced by all the fuss over ([\ref=eq:18]). The most powerful weapon in the mathematician's arsenal to tackle this problem was also introduced by Gauss: the notion of modular arithmetic, which is the arithmetic of remainders. Four hours after 9 o'clock, it is 1 o'clock, because the remainder when 9+4=13 is divided by 12 is 1. The clock does arithmetic modulo 12, but one can do it modulo any number n  ≥  2. In arithmetic modulo n, two integers a and b are identified if their remainders after division by n are the same; or, as number theorists say it, their residues modulo n are the same. We write Thus, there are n residue classes of integers modulo n, represented by Addition and multiplication carry over to modular arithmetic and satisfy the same rules of commutativity, associativity and distributivity that hold for the integers.

When n is a prime number (call it p), something special happens: it is possible to divide by any non-zero residue modulo p, meaning to say that for any x not divisible by p, there exists an integer y such that This integer y can be thought of as the reciprocal of x modulo p, and we may write it as 1 / x. A number system, namely a set with the operations of addition and multiplication, which satisfies the usual axioms of commutativity, associativity and distributivity (it is assumed that the set comes with a 0 and a 1), where division by any element different from 0 is possible, is called a field. For every prime power q, Évariste Galois (1811-1832) constructed a finite field with q elements [\cite=Galois-fields]. In 1903, Eliakim Hastings Moore showed that for each prime power q, all fields with q elements are isomorphic [\cite=Moore-finite-fields]. In other words there is, in essence, just one field with q elements for each prime power q.

Vectors with coordinates in any field behave very much like vectors with real numbers as coordinates. The usual notions of linear independence, basis, and subspace carry over from vectors with real coordinates to vectors with coordinates in finite fields, and will be used freely throughout this article. We recall the essentials: a set of vectors which is closed under addition and scalar multiplication (a scalar is an element of the underlying field) is called a linear subspace. A collection [formula] of vectors is said to be linearly independent if, for each 1  ≤  i < n, there exists a linear subspace which contains [formula] but not vi. A basis of a linear subspace is any maximal linearly independent subset. Every vector in the subspace can be written as a sum of scalar multiples of elements from a basis. All bases of a linear subspace have the same number of elements, and this number is called the dimension of the linear subspace.

Introduction

Let F be a finite field of order q. Let V = Fn be the space of vectors with n coordinates in F. For every k  ≤  n, define [formula] as the number of linear subspaces of V of dimension k. The number [formula] is called a Gaussian binomial coefficient. One of the goals of this article is to explore the relationship between [formula] and the binomial coefficient [formula], which is the number of ways of choosing k objects out of n (n choose k).

It is not difficult to write down a formula for [formula]. To do this, note that a k- dimensional subspace is specified by giving k linearly independent vectors [formula] in V. In how many ways can this be done? Firstly, v1 can be taken to be any non-zero vector in V. Therefore there are qn - 1 choices for v1. Given v1, v2 can be chosen to be any vector which is not in the subspace spanned by v1. Since this subspace has q elements, there are qn - q choices for v2. Continuing in this manner, we see that given [formula] for l < k, there are qn - ql choices for vl + 1. The number of sets of k linearly independent vectors in V is therefore Applying the above formula to the special case where n = k, we see that each k- dimensional subspace of V (which is a k- dimensional vector space in its own right) has bases. To obtain the number of k- dimensional subspaces, we divide the first expression by the second one. Thus the number of k- dimensional subspaces of V is

[formula]

So far, q has been the order of a finite field (which can be any prime power), but the above expression is also a rational function of q with a denominator that vanishes only at q = 1. This allows us to get a value for [formula] for any complex number q  ≠  1. Using L'Hôpital's rule one computes for [formula]. Therefore

[formula]

Counting using echelon form

In 1971, Donald Ervin Knuth provided an elegant explanation for the identity ([\ref=eq:3]) in [\cite=MR0270933] based on the idea that every subspace has a unique basis which is in reduced row echelon form.

Let F be a field with q elements. Any k linearly independent vectors in Fn can be arranged into a k  ×  n matrix of rank k, where the entries of the ith row are the coordinates of the ith vector. In other words, every k- dimensional subspace of Fn is the row space of an k  ×  n matrix of rank k. The row space of such a matrix does not change under the following elementary row operations:

permutation of the rows

addition of a scalar multiple of one row to another

multiplication of a row by a non-zero scalar

A k  ×  n matrix is said to be in reduced row echelon form if

the left-most non-zero entry of each row is 1 (let's call it a leading 1)

all the other entries in the column of a leading 1 are zero

the leading 1 in any row occurs to the right of the leading 1 in the row above it

A matrix in reduced row echelon form looks something like where the *  's represent arbitrary elements of F.

The reader should not have much difficulty in seeing that the elementary row operations described above can be used to reduce any k  ×  n matrix to reduced row echelon form. If the matrix has rank k, then all the rows in the reduced row echelon form are non-zero. Moreover, if two matrices in reduced row echelon form have the same row space, they are equal.

Given a matrix in reduced row echelon form, delete all the entries in each row to the left of the leading 1. Then remove the columns containing the leading 1's. Finally, replace each remaining entry with a *  . The result is a pattern of *  's inside a grid with k rows and n - k columns. These patterns are characterized by the property that except for the *  's in the first row, every *   has a *   above it, and except for the *  's in the (n - k)th column, every *   has a *   to the right of it. They are called Ferrers diagrams. Figure [\ref=fig:2] illustrates an example of this process when n = 7 and k = 3. On the left is a matrix in reduced row echelon form. The leading 1's occur in the second, fourth and fifth columns. After deleting the entries to the left of the leading 1's, deleting the columns with leading 1's, and replacing the remaining entries with *  's the Ferrers diagram on the right is obtained.

The above process can be easily reversed: let [formula] denote the k coordinate vectors in Fn, written a columns. Starting with a Ferrers diagram λ in a k  ×  (n - k) grid, replace each *   with an element of F (this can be done in q|λ| ways, where |λ| denotes the number of *  's in λ) and each vacant square in the grid by a 0. Insert [formula] in reverse order as follows: insert ek to the left of the left-most *   in the bottom row. Having inserted [formula], insert ei to the left of all the *  's in the ith row and all the columns [formula]. This gives all the matrices associated with λ.

The problem of counting the k- dimensional subspaces of Fn is equivalent to counting the number of k  ×  n matrices of rank k in reduced row echelon form. Each matrix in reduced row echelon form gives rise to a Ferrers diagram inside a k  ×  (n - k) grid. Each Ferrers diagram λ can be obtained from q|λ| matrices in reduced row echelon form. We have shown that

[formula]

where λ  ⊂  k  ×  n - k is supposed to indicate that λ is a Ferrers diagram in a grid with k rows and n - k columns.

The expression ([\ref=eq:4]) for q-binomial coefficients demonstrates that [formula] is a monic polynomial in q of degree k(n - k) with positive integer coefficients, which is not evident from ([\ref=eq:5]). In the next section, we take a closer look at the right hand side of ([\ref=eq:4]) to give, among other things, another proof of ([\ref=eq:3]).

A partition of a natural number n is a decomposition where each part ni is positive. If one does not distinguish between different reorderings of the same summands, one may assume that [formula]. A Ferrers diagram λ with |λ| = n can be thought of as a partition of n, the parts being the number of *  's in each row of λ. Thus, ([\ref=eq:4]) has the following interpretation:

The coefficient of qr in [formula] is the number of partitions of r into no more than n - k parts, with each part being no larger than k.

Paths, subsets, and permutations

Given a Ferrers diagram λ  ⊂  k  ×  n - k, we identify it with a path from the top-left corner to the bottom-right corner of a rectangular grid of squares of height k and length n - k as follows: begin at the top left corner. As each stage, if you find yourself at the top left corner of a square with a *   in it, move one step downwards. If not, move one step to the right. In the example with n = 7 and k = 3 that we considered in Figure [\ref=fig:2], this process is illustrated in Figure [\ref=fig:fp]. Such a path always consists of n segments of unit length, of which k are vertical and n - k are horizontal. Index the segments of such a path by the numbers [formula], starting at the top-left corner and ending at the bottom-right corner. The path is completely determined by specifying which k of these n segments are vertical. Figure [\ref=fig:1] shows all ten paths for n = 5 and k = 2. Directly beneath each path is listed the subset of {1,2,3,4,5} corresponding to the vertical segments.

Since the paths are completely specified by which k of the n segments are vertical, the number of such paths is [formula]. This gives a more illuminating proof of the identity ([\ref=eq:3]): This proof trumps the one in Section [\ref=sec:introduction] by virtue of being combinatorial; in effect, it constructs a surjective function K (call it a collapse) from the set of k- dimensional subspaces of Fn to the set of subsets of [formula] of order k with all pre-images having cardinality a power of q. We shall now give a combinatorial interpretation of the number |λ|. In order to do this, we associate a permutation πλ of [formula] (namely a rearrangement of these symbols) to each Ferrers diagram λ contained in an k  ×  n - k grid. The permutation πλ is constructed as follows: look at the path corresponding to λ, with its segments indexed by the numbers [formula] as before. First write down the indices corresponding to the horizontal segments in increasing order. Then write down the indices corresponding to the vertical segments in increasing order.

In Figure [\ref=fig:1], for n = 5 and k = 3 the permutation associated to each Ferrers diagram appears below the subset corresponding to the horizontal segments. Note that only ten of the 120 permutations of (1,2,3,4,5) appear in Figure [\ref=fig:1]. These ten permutations are characterized by the property that each entry with the possible exception of the third one is smaller than the next one.

More generally, let [formula] denote a permutation of [formula]. The descent set of π is defined as The permutations πλ that correspond to paths in a k  ×  n - k grid are precisely the ones for which D(π)  ⊂  {k}.

We are now ready to give an interpretation of |λ| in terms of πλ. For a permutation π of [formula], an inversion of π is a pair (i,j) such that 1  ≤  i  <  j  ≤  n but π(i) > π(j). Let [formula] denote the number of inversions of π. We claim that

[formula]

Indeed, if (i,j) is an inversion of πλ, then since [formula] and [formula] are increasing sequences, we must have 1  ≤  i  ≤  k and k < j  ≤  n. The box in the ith column and (j - k)th row of a Ferrers diagram λ in a k  ×  n - k grid contains a *   if and only if the associated path has taken j - k downward steps before it has taken i rightward steps. But this is precisely when π(i) (the index of the ith rightward step) is greater than π(j) (the index of the (j - k)th downward step). The reader who finds the above reasoning hard to follow should try at first to verify ([\ref=eq:6]) for the paths in Figure [\ref=fig:1].

By passing from λ to πλ, we can rewrite ([\ref=eq:4]) in yet another form:

[formula]

Thus the coefficient of qr in [formula] is the number of permutations with r inversions and descent set contained in {k}.

Multinomial coefficients

Recall that multinomial coefficients given by the formula

[formula]

count the number of ways of writing [formula] as a disjoint union [formula] where |Xi| = ki for [formula] (of course, one assumes that [formula]). Let Let [formula] for each [formula]. Then [formula] is a nested sequence of subsets such that |Yi| = si for all [formula], and it is clear that the sequence of disjoint sets (Xi) can be recovered from the sequence of nested sets (Yi). Writing S for an increasing sequence [formula] in [formula], we shall use the notation We have: where ki = si - si - 1 for 1,i < m, k1 = s1 and km = n - sm - 1. This interpretation of the multinomial coefficients has an obvious analogue for vector spaces and subspaces. Define The multinomial coefficients can be expressed in terms of the binomial coefficients. Clearly, the number of choices for Sn - 1 inside Sn is [formula], the number of choices for Sn - 2 inside each choice of Sn - 1 is [formula] and so on, so that

[formula]

Similarly,

[formula]

These expressions allow us to easily deduce some properties of q-multinomial coefficients from the corresponding properties of q-binomial coefficients. For example, the expression ([\ref=eq:5]) expressing a q-binomial coefficient as a rational function in q with denominator non-zero except at q = 1 also shows that a q-multinomial coefficient is a rational function of q with denominator non-zero except at q = 1. From the identity ([\ref=eq:3]) we can deduce that

[formula]

Similarly, from the identity ([\ref=eq:4]) we can deduce that each q-multinomial coefficient is a monic polynomial in q of degree [formula] with positive coefficients. A slightly more careful analysis will allow us to find the analogue of ([\ref=eq:7]) for multinomial coefficients. Not only will it give us a combinatorial interpretation for the coefficient of a power of q in the multinomial coefficient, when combined with the principle of inclusion and exclusion, it will also have the rather surprising consequence that the alternating sum (where |T - S| denotes the number of elements of T which are not in S) is a polynomial in q with non-negative coefficients.

In order to simplify notation, for any [formula], let Then ([\ref=eq:7]) can be rewritten as If we expand the right hand side of ([\ref=eq:10]) using the above identity, we get

[formula]

We claim that the formula defines a bijection (where Σr is identified with the subgroup of Σn which permutes the first r elements of [formula]) such that allowing us to rewrite ([\ref=eq:12]) as Indeed, using induction on m, it suffices to verify

Firstly, note that if [formula] and πm - 1∈Σn({sm - 1}) then both π' and πm - 1 are increasing functions on each of the segments [formula] for [formula], and therefore, their composition is also increasing on these segments. Therefore [formula].

It remains to prove ([\ref=eq:13]). For each permutation π, let I(π) denote the set of inversions of π, namely, the set of pairs i < j for which π(i) > π(j). In general, if σ and τ are permutations then from which it follows that If in addition, [formula], then and therefore, Hence in order to prove ([\ref=eq:13]), one must show that

[formula]

Since π' acts only on [formula], if (i,j) is an inversion of π' then π'(j) < π'(i)  ≤  sm - 1. Since πm - 1 has no descents in this range, (π'(i),π'(j)) can not be an inversion of πm - 1, proving ([\ref=eq:14]).

We have succeeded in generalizing ([\ref=eq:7]) to multinomial coefficients:

[formula]

Combining ([\ref=eq:multinom]) with ([\ref=eq:15])

[formula]

We shall now combine these identity with the principle of inclusion and exclusion to get a surprising positivity result for alternating sums of multinomial coefficients.

Principle of inclusion and exclusion

This principle is most commonly known as a technique for computing the cardinality of a union of finite sets in terms of cardinalities of various intersections. What follows is a more abstract formulation (see [\cite=MR1442260]).

Let R be a finite set. The power set 2R of R is the set of all subsets of R. The principle of inclusion and exclusion can be interpreted as saying that two functions [formula] satisfy the identities

[formula]

for all S,T  ⊂  R if and only if they satisfy the identities

[formula]

for all S,T  ⊂  R.

Assume ([\ref=eq:1]). Then

[formula]

If m = |T - U| > 0, then the inner sum is [formula]. Therefore, the expression reduces to α(T). Conversely, assume ([\ref=eq:2]). Then

[formula]

and as before, the inner sum is zero unless U = T, in which case it is one.

Counting permutations with a given descent set

The principle of inclusion and exclusion allows us to use ([\ref=eq:11]) to write a formula for the number of permutations with a given descent set in terms of multinomial coefficients. Take [formula] and let Then by ([\ref=eq:11]) Thus, by the principle of inclusion and exclusion

A surprising positivity result

Let Then

[formula]

The principle of inclusion and exclusion (Section [\ref=sec:princ-incl-excl]) gives

[formula]

Not only is this alternating sum positive; in fact it is a polynomial in q with positive coefficients!

Closing remarks

The combinatorics of Gaussian binomial coefficients continues to fascinate mathematicians today. That the binomial coefficients [formula] increase with k when k  ≤  n / 2 and decrease for k  ≥  n / 2 is easy to see. An analogous statement for Gaussian binomial coefficients is also not too difficult. Such sequences of numbers are called unimodal. Towards the end of Section [\ref=sec:echelon], we saw that [formula] is a polynomial in q with positive coefficients. The first combinatorial proof of the unimodality of these coefficients was found as late as 1990 by Kathleen M. O'Hara [\cite=O'Hara199029] (see also an expository article on O'Hara's proof by Doron Zeilberger [\cite=Zeilberger]).

Counting subspaces in a finite dimensional vector space over the field [formula] is a special case of the problem of counting subgroups inside a finite abelian group. Every finite abelian group can be written as a product of over a finite set of prime numbers of groups of the form

[formula]

where [formula] is a sequence of positive integers.

A generalization of the problem of counting k-dimensional subspaces in an n-dimensional space is the problem of counting subgroups of type Ap,μ inside Ap,λ for [formula]. The generalizations of ([\ref=eq:5]) and ([\ref=eq:3]) have been known for a long time (e.g., Delsarte [\cite=MR0025463]) and are related to multiset combinatorics (a multiset is a set where elements are allowed to appear with multiplicities, for example, as in the case of roots of a polynomial). However, the analogues of ([\ref=eq:15]) and ([\ref=eq:16]) are more subtle, and can be found in Lynne Butler's beautiful monograph [\cite=MR1223236].

In recent years, techniques from combinatorics have been combined with those from analytic number theory (namely, zeta functions) to study enumeration problems in algebra with great success (see, for example the survey article [\cite=ZetaICM06]). The reader who wishes to start learning the language and basic techniques of modern combinatorics need look no further than Richard P. Stanley's amazing book [\cite=MR1442260]. A slightly different take on some of the contents of this article can be found in Henry Cohn's expository article [\cite=CohnAMM].

Acknowledgements

I benefited from discussions with Kunal Dutta, Sanoli Gun and Shailesh Shirali while preparing this article. It is a pleasure to thank them.