Keywords:

Patlack, Keller-Segel, McKean-Vlasov, chemotaxis, particle method, blow-ups.

Introduction

In this work we discuss a numerical method for studying singularities (blow-ups) in the Keller-Segel model (K-S) of chemotaxis [\cite=Kell70] and in the systems with similar mathematical structure, such as the McKean-Vlasov (McK-V) model of charged interacting particles [\cite=Vill03]. (Patlack derived similar equations nearly two decades prior to Keller and Segel [\cite=Pat53].) We present illustrative numerical examples and provide analytical insights into formation and interaction of singularities from the point of view of the associated stochastic processes. We concentrate on the details of numerical modeling and several specific aspects of mathematical analysis. An interested reader should consult the exhaustive reviews for discussions of physical and biochemical phenomena involved in chemotaxis [\cite=Hor03] [\cite=Hor04] [\cite=Tin08i] [\cite=Tin08ii].

Numerical treatment of equations with singular solutions is challenging because it requires a reliable and efficient approximation of singular functions or even distributions. For example, the conventional finite-difference or spectral methods are not fit for dealing with δ-functions arising in the K-S model. While most finite-element and discontinuous Galerkin methods are efficient and accurate as long as the solutions remain sufficiently smooth, in the vicinity of singularities they struggle with positivity issues, unphysical oscillations, and related problems [\cite=Fil06] [\cite=Epsh08] [\cite=Epsh09] [\cite=Epsh09a] [\cite=Stre10a] [\cite=Stre10b]. (A conservative upwind finite-element method introduced by Saito for the elliptic K-S model overcomes some of these issues [\cite=Sai07].) Generally, unless some regularizations are introduced, these methods cannot propagate solutions past the moment of blow-up altogether. The method presented in this work avoids such difficulties because the singular field is modeled by an ensemble of interacting particles. The singularities manifest themselves as particle aggregates, harmless from the numerical standpoint. Essentially, this approach to chemotaxis reverses the continuous PDE description of ensembles of interacting particles. Ha skovec and Schmeiser have recently introduced a method utilizing similar ideas [\cite=Has10] [\cite=Has11]. Their method, however, is exclusively particle-based and is limited to one specific variety of the elliptic K-S model in the entire plane. Our method employs the grid and particle representations of the fields simultaneously and is suitable for both elliptic and parabolic K-S equations in arbitrary domains. It is also applicable to a wider range of kinetic problems. (Other technical differences are discussed where appropriate.) Conceptually, our method is more in the spirit of the Particle In Cell (PIC) methods widely used, e.g., in plasma physics [\cite=Iva80] [\cite=Cot86] [\cite=Bird91] [\cite=Vic91] [\cite=Allen94] [\cite=Hav96] [\cite=Wall00]. Another interesting numerical method has been recently implemented for the one-dimensional McKean-Vlasov system [\cite=Bla08]. It uses that the McK-V equation describes steepest descent dynamics in the Wasserstein-2 space of probability measures and is suitable for studying singular (measure-valued) solutions.

The usefulness of the particle approach extends beyond numerical methods. Analysis of the stochastic processes underlying the K-S PDEs yields insights into formation and interaction of singularities. In particular, we derive an expression for the critical mass required to create or sustain a singularity and relate the non-uniqueness of solutions of the K-S equations to the underlying diffusion process. Even though our treatment is rather informal, it sheds new light on the mechanism of blow-ups. Some of the results presented in this paper have been proven using different methods and under various assumptions. Much effort has been directed towards obtaining the exact value of the critical mass [\cite=Dol03] [\cite=Bla06] [\cite=Calv06] [\cite=Chav07] [\cite=Bil09]. Velázquez introduced measure-valued solutions and extended the K-S equations beyond the point of blow-up [\cite=Vel04a] [\cite=Vel04b], see also [\cite=Dol09]. These works together with the study of the K-S equations as a hydrodynamic limit of interacting particle systems by Stevens [\cite=Stev00] link the particle and PDE descriptions of chemotaxis. We also mention a rigorous analysis of phase transitions in the McK-V system [\cite=Chay09] (it only covers sufficiently regular interaction kernels not relevant to the K-S model) and an investigation of singularity formation in several related aggregation models [\cite=Bert09] [\cite=Bert10] [\cite=Carri10] (these models do not have diffusive terms and correspond to one special case of the K-S model).

The Keller-Segel model

is prescribed by the following system of PDEs: The function [formula] is the density of active particles (bacteria), [formula] is the concentration of chemoattractant. For numerical simulations we use Neumann (no flux) boundary conditions,

[formula]

in a two-dimensional square domain Ω = (0,L)2. We assume that [formula] integrates to M over the entire domain; M is the total mass of the bacteria. By rescaling the equations, we can always achieve that α = 0 or α = 1. In the former case the model is called elliptic, in the latter -- parabolic. The parameters μ, χ, and k are constants. (The numerical method, however, may be readily extended to a more general class of equations, see Section [\ref=sec:num] for details.)

Physically, these equations describe the following phenomenon. The chemoattractant spreads diffusively and decays with rate k2; it is also produced by the bacteria with rate 1. (In the elliptic case these rates are infinite, i.e., the chemoattractant "thermalizes" infinitely fast.) The bacteria diffuse with mobility μ and also drift in the direction of the gradient of concentration of the chemoattractant with velocity [formula]; χ is called chemosensitivity.

In this work we are interested in singular solutions to the K-S equations. A typical situation is illustrated in Figure [\ref=fig:blowups] where a snapshot of the concentration field [formula] is displayed. The peaks correspond to δ-function-type singularities of the particle density [formula]. (Displaying bacteria density itself is not very illustrative due to its highly singular nature.) As mentioned above, the principal challenge for numerical simulations is in approximating the fields [formula] and [formula] as they become unbounded. Our idea is to use a particle method for the evolution of [formula], so that its singularities manifest themselves as harmless particle aggregates. For the propagation of [formula], we use a second order implicit finite-difference scheme because of its simplicity and excellent stability properties. Even though [formula] also becomes unbounded analytically (it remains large but bounded for a given discretization), its weak logarithmic singularities do not cause any problems for sufficiently stable schemes. In general, one may use a different solver for propagation of the concentration field (including a particle-based solver as well).

The particle-based description

utilizes that the PDE ([\ref=eq:KSrho]) is a Fokker-Planck equation for the evolution of the probability density of the bacteria. Suppose first, that we are given some time-dependent concentration field [formula] and want to solve equation ([\ref=eq:KSrho]). Let [formula] be i. i. d. random variables distributed according to the initial condition [formula] at time t = 0 and satisfying the following stochastic differential equations (with reflecting boundary at [formula]) for t > 0:

[formula]

Then, using the strong law of large numbers and that ([\ref=eq:KSrho]) is a Fokker-Planck equation for the SDEs ([\ref=eq:KS_SDE]), we can see that as N  →    ∞  , the empirical probability densities,

[formula]

converge almost surely to [formula]. (This convergence is in the sense of measures, point-wise in t; a stronger convergence can be established with more effort.) Thus we can simulate equations ([\ref=eq:KS_SDE]) for the particles, and approximate the density [formula] using [formula] whenever required.

Rigorously justifying this approach to the full K-S system ([\ref=eq:KS]) is more challenging because in the full system the concentration field [formula] is a functional of [formula], s  ≤  t, rather than some a priori prescribed field. This implies that equations ([\ref=eq:KS_SDE]) become coupled and we end up with a system of stochastic interacting particles (with memory in the parabolic case). Some progress in this direction, nevertheless, has been made. Stevens derived the K-S equations as limit dynamics for interacting stochastic particle systems via smoothing and rescaling the interaction potentials in a particular fashion [\cite=Stev00]. Ha skovec and Schmeiser proved convergence of their particle method under reasonable assumptions via analysis of the associated BBGKY hierarchy [\cite=Has11].

Numerical method

As mentioned in the introduction, the principal idea behind our numerical scheme is to employ a particle method for the evolution of the particle density field [formula]. The current implementation utilizes an implicit second order finite-difference scheme for simulating equation ([\ref=eq:KSc]) and an explicit Euler-Maruyama scheme for the stochastic particle dynamics ([\ref=eq:KS_SDE]). We discretize the computational (rectangular) domain with grid size Δx and propagate the concentration field Cij using the time step Δt. The particle density field Pij is reconstructed from the particle locations. We evolve the particles using adaptive time steps which may be smaller than Δt; this is needed for stability reasons (see below).

The particle dynamics

is simulated using the forward Euler-Maruyama scheme,

[formula]

where N(0,1) is a standard Gaussian random variable with mean 0 and variance 1. The gradient field [formula] is approximated in two steps. First, we construct the gradient fields CX and CY using the second order approximation,

[formula]

Then we approximate [formula] via bilinear interpolation using the values of CX and CY at the four nearest grid points. Because [formula] becomes unbounded (very large numerically) in the vicinity of blow-ups, it is essential to choose the time step Δτ adaptively, see Figure [\ref=fig:adapt] and its description for details. Consequently, if needed, we subdivide the timestep Δt into smaller intervals Δτ(n) so that [formula]. (Each particle is simulated independently of others, i.e, Δτ(n) are chosen for each particle individually.) A failure to satisfy this condition leads to overshooting in the vicinity of blow-ups, which in turn causes artificial oscillations and damping. Finally, we enforce the no-flux Neumann boundary conditions for [formula] by reflecting the particles escaping from the spatial domain back into it.

The particle density field Pij(t)

is reconstructed from the particle locations as explained in the description to Figure [\ref=fig:scheme]: each particle contributes fractions of its weight to the four nearest grid points according to the bilinear interpolation rules. This approximation preserves the first moment of the corresponding distribution. It is important to use this kind of moment-preserving approximations, e.g., a simple bin-counting (assigning all weight of a given particle to the nearest grid point) is unsatisfactory. The reason is that this creates an artificial flux towards the grid points: the particles feel their own potentials which become artificially aligned to the nearest grid points. This flux is sufficient to pin the singularities to grid points and disrupt such phenomena as logarithmically-weak interaction of singularities with each other and with the boundary of the domain.

The concentration field

is propagated according to the implicit second order finite-difference scheme,

[formula]

where D(2) is the standard second difference operator. It is essential to use an implicit scheme for stability reasons because the concentration field acquires logarithmic singularities. This scheme is quite efficient: even though it requires solving a system of linear equations, the matrix of the finite difference operator is symmetric and banded, and may be Cholesky-factorized before the actual computations. The extra computational cost of solving this linear system is then alleviated by relaxation of the Δt  ~  Δx2 stability constraint of explicit schemes.

The presented numerical method may be generalized to other similar systems of the form and to more complicated domains. This makes it a useful tool for studying various aggregation phenomena for which the conventional finite-difference or finite-elements schemes are inefficient. From the numerical analysis point of view, we do not currently have any estimates of the convergence rates for this scheme. Partially, this problem is complicated due to the singular nature of solutions to the K-S equations. In particular, once the blow-ups are formed, one must interpret the K-S PDEs in some proper sense, and while our numerical scheme is able to propagate the solutions for all times (i.e., it regularizes the PDEs in some fashion), relation of such numerical solutions to a particular analytical regularization must be carefully investigated. On the other hand, we could speculate that our method exhibits the typical for this kind of schemes errors of the order [formula], [formula], and [formula] for regular solutions. Such analysis, however, is not the purpose of this paper and we verify our numerical results by "standard means," i.e., compare the results with simulations employing half the mesh size, double the number of particles, etc.

Formation and interaction of singularities

We now concentrate on the elliptic (α = 0) case, though some of the reasoning is equally applicable to the parabolic case as well. Generally, one can distinguish the soft  and hard  blow-ups: in the first case the fields [formula] and [formula] become unbounded but [formula] does not acquire atomic components, while in the second case the particle density field becomes a bona fide distribution. Here we concentrate on the hard blow-ups which have a more apparent physical meaning: atomic components of the particle density correspond to accumulation of particles at some point locations on the given physical length-scale.

It is convenient to study the elliptic model in a slightly different form, as a McKean-Vlasov system. First, we solve equation ([\ref=eq:KSc]) for [formula]:

[formula]

Here [formula] is the Green's function for Δ - k2 in Ω, which is assumed to be d-dimensional. The entire-space Green's functions (the fundamental solutions) whose singular part is identical to those in bounded domains are known explicitly: Here [formula] is the modified Bessel function of second kind. Substituting expression ([\ref=eq:cconv]) for the concentration field [formula] into equation ([\ref=eq:KSrho]) we get a closed integro-differential equation for the particle density field,

[formula]

Here the energy functional is given by

[formula]

One of the features of the dynamics ([\ref=eq:KS_ell_rho]) is that the functional E(ρ) is non-increasing:

[formula]

When ρ(x) becomes singular with respect to Lebesgue measure, the first ( entropic) term in ([\ref=eq:nrg]) tends to infinity, which must be compensated by the second ( interaction) term. If d = 1, the Green's function [formula] is bounded below and so is the interaction term, thus the blow-ups are not possible. This is no longer the case if d  ≥  2 and so the blow-ups are permissible. A more delicate analysis is needed to understand how exactly they are formed.

From standpoint of the stochastic process underlying the Fokker-Planck PDE ([\ref=eq:KSrho]), the atomic components of [formula] correspond to particles aggregating at point locations. Thus the traps which do not allow the particles to escape must be created. Let us first investigate when a particle aggregate creates a trap for a single particle diffusing in its field. Suppose [formula], the corresponding concentration field is then proportional to the fundamental solution ([\ref=eq:FS]). Equation for the radial component of the location of a single particle diffusing in the field created by ρ is equivalent in law to the following SDE:

[formula]

For d = 1 we get

[formula]

This equation is sufficiently regular and does not allow for existence of a trap for any value of M, so consistently with energy considerations, no blow-ups are possible in this case. For d  ≥  3, a similar reasoning shows that a trap of an arbitrarily small mass may exist. So the interesting case is d = 2.

For d = 2, using that in the leading order, as [formula], [formula], we obtain the following equation:

[formula]

This is a well-known Bessel process [\cite=Kar81], it's behavior near the boundary at r = 0 depends strongly on the value of M. In particular, when

[formula]

the origin is the so-called exit boundary, a trap, i.e., the particles reach it in finite time, and may never escape back to the domain r > 0. For our problem the implication is that the total mass of at least M*c is needed for existence of a stable singularity in the particle density field. For M∈(0,M*c), the SDE ([\ref=eq:bessel]) has the so-called regular boundary at r = 0. In this case the particles may reach the origin, but are not necessarily trapped there, i.e., may also leave it according to some rules which must be prescribed in addition to the SDE itself. This implies that the original K-S PDEs alone are not sufficient to describe the blow-up dynamics and the exchange of mass between the regular and singular components of the particle density when the mass of the singularity is less than M*c.

The critical mass M*c is smallest mass such that a singularity does not shed its mass but only absorbs particles from the smooth component. It is, however, twice less than the mass required to create a singularity from smooth initial data. Indeed, consider the N-particle SDEs approximating the elliptic K-S equations:

[formula]

To study the aggregation dynamics of the particle system, consider the variance of the empirical probability density of the bacteria ([\ref=eq:ePDF]),

[formula]

Rt will be referred to as the  radius  of the system. We concentrate on the problem in the entire space with k = 0; this corresponds to [formula]. Analysis for the other values of k, or in the bounded domains is similar (although more technical) because the singularities of [formula] are the same in the leading order. In this case, however, there exists an explicit closed equation governing the evolution of Rt:

[formula]

The driving stochastic process Wt obeys the following SDE:

[formula]

and can be shown to be a Wiener process using the Lévy characterization of Brownian motion. We can immediately see that in the limit as N  →    ∞  , if

[formula]

the evolution of the radius obeys a well-known deterministic equation,

[formula]

Hence R2t = R20  -  γt  , and for supercritical masses (M > Mc) the blow-up occurs at time T = R20  /  γ. It is independent of the initial distribution of mass except through R0. If M = Mc, after the time rescaling, equation ([\ref=eq:SDE_N]) may be rewritten as

[formula]

This equation describes a critical Bessel process with entrance boundary at R = 0, in this case [formula] a.s. never hits zero, although it visits its arbitrarily small neighborhood. In this limit the particle system remains stochastic even as N  →    ∞   and does not approximate the deterministic K-S equations. As [formula], the particle system approaches blow-up infinitely often, but never actually coalesces into a single particle, cf [\cite=Bla08b].

Formation of singularities.

Our first numerical experiment is designed to test how well our numerical method predicts the value of the critical mass Mc required to develop a singularity from smooth initial data. Notice, first of all, that due to reflection principle for the problem with Neumann boundary conditions, singularity in a corner of the domain, Ω = (0,L)2, only requires a quarter of the critical mass. Since the singularity inside of the domain eventually migrates into a corner, we perform our experiment in the corner to begin with. We scatter all particles over Ω with a slight bias towards (0,0) and vary their total mass observing whether the particles remain aggregated, or spread uniformly over the entire domain. The results are presented in Figure [\ref=fig:supsub]. For the specified values of the parameters, the calculated numerical value of the critical mass lies between 0.34 and 0.35, while the theoretical prediction for elliptic model with k = 0 in the entire plane is Mc / 4 = π / 10 -- slightly smaller. The mismatch is a consequence of the simulation in a finite domain, the limit L  →    ∞  , [formula] is non-trivial because equation ([\ref=eq:KSc]) with Neumann boundary conditions is not well-posed in Ω when α = k = 0. In particular, the boundary of the domain far from the corner where the singularity is formed pulls the particles away from the singularity, effectively increasing the critical mass.

Interesting phenomena occur when a singularity with mass M∈(0,M*c) already exists in the system. In this case the trap absorbs the particles, though the latter may still escape back into the regular component of the particle density. The diffusion process underlying the K-S equations is not uniquely defined by its generator and additional rules for behavior of the particles at singular points must be specified. These rules are not inherently encoded in the K-S equations and are related to non-uniqueness of K-S regularizations. From the modeling perspective, the exchange of mass between the regular and singular components of the particle density in this regime strongly depends on particular details of the numerical method. Note, however, that if the initial particle density is regular, the smallest possible mass for singularity is greater than Mc = 2M*c, so this scenario does not occur.

Interaction of singularities

is illustrated in Figure [\ref=fig:evolv]. The singularities attract each other and are also attracted by the boundary of the domain. Equations governing their dynamics may be derived following [\cite=Vel04a] [\cite=Vel04b] [\cite=Dol09]. If the density [formula] is purely atomic, we obtain

[formula]

Here mj-s are the masses of singularities located at [formula]-s, [formula] is the Green's function. Note that unlike in the method of Ha skovec and Schmeiser [\cite=Has10], in our method, the dynamics of singularities is not imposed by the numerical method explicitly, i.e., it is a natural consequence of the stochastic particle dynamics.

Equations ([\ref=eq:sing_ODE]) are identical to equations ([\ref=eq:KS_SDE]) of the K-S model with particle diffusivity μ set to zero. The naive reasoning is that once the traps are formed, the particles' diffusion is dominated by the (infinitely strong) drift and ceases to contribute into dynamics: the stochastic dynamics self-averages and the martingale component does not contribute into the mean drift. In order to verify how well our method approximates equations ([\ref=eq:sing_ODE]), we perform a numerical experiment illustrated in Figure [\ref=fig:coll]. In this experiment we create two singularities far from the boundaries in a sufficiently large domain, so that the interaction potential is well-approximated by the fundamental solution ([\ref=eq:fs_2d]). We run the K-S solver and track locations of these singularities. Finally, we compare them with locations of the particles evolving according to equation ([\ref=eq:sing_ODE]) from the same initial data. A perfect match indicates that the scheme is very successful in dealing with this kind of phenomena. Similarly, in a bounded domain, the particle interaction potential, [formula], should be replaced by the Green's function which also encodes interaction with the boundary. In particular, this explains attraction of the singularities to the boundary and the corners of the domain.

Discussion

Our investigation of the K-S equations was motivated by the underlying stochastic particle dynamics. A numerical method based on similar ideas has been recently presented by Ha skovec and Schmeiser [\cite=Has10]. The greatest advantage of the H-S method is that the singularities are represented as deterministic particles rather than as a tight cluster of "elemetary" stochastic particles. This, however, requires an explicit knowledge of evolution equations governing the interaction of singularities (at the very least the knowledge of Green's function in a given domain) and is only applicable to the elliptic K-S model. Moreover, the H-S method requires a direct simulation of an ensemble of interacting particles and thus its computational cost scales as N2 with respect to the total number of particles. By combining the particle dynamics and the PDE dynamics of the concentration field which mediates the particle interaction (the PIC ideas) we are able to significantly reduce this computational cost and deal with a much larger number of interacting particles. We can also treat both parabolic and elliptic models with equal ease. The ultimate numerical method should combine ideas presented in this work, the deterministic particles of the H-S method, and also high order conventional schemes in the regions where the solution remains regular. Such a multi-model implementation remains a subject for the future work.

Even though the non-uniqueness issue is well-known, the details of how the exit-entrance conditions for the underlying diffusion process are related to the exchange of mass between the singularity and the regular part are not yet well understood. From the modeling perspective, the implication is that a particular numerical scheme provides a regularization of some sort which affects the critical mass M*c

Another interesting class of stochastic particle models related to our studies of the K-S equations arises in the context of the so-called self-gravitating Brownian particles, see e.g., [\cite=Chav07] [\cite=Chav07b] [\cite=Sir10]. We suggest a model which fits into this class and bears an intrinsic relation to the K-S model. Consider an ensemble of particles in d dimensions characterized by their masses mn and evolving according to the stochastic differential equations

[formula]

Here N0 is the initial number of particles and [formula] is their total mass. If initially mn = M / N0, equation ([\ref=eq:aggr]) is precisely ([\ref=eq:KS_SDE_n]). The interaction allows for particle collisions, thus equation ([\ref=eq:aggr]) is only valid until the first collision, at which point the colliding particles coalesce into a single particle which acquires their combined mass. Dynamics is then restarted with the remaining particles. In the limit as N0  →    ∞  , whenever a particle accumulates an [formula] mass, its diffusivity becomes zero, i.e., it obeys the deterministic equation ([\ref=eq:sing_ODE]) which governs evolution of a point singularity in the K-S model. Therefore we conjecture that in a proper hydrodynamic limit this system is equivalent to the elliptic K-S model. Investigation of this system will be conducted elsewhere.