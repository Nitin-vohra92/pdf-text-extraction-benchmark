Incentivizing Energy Trading for Interconnected Microgrids

Introduction

Traditional power systems often generate power in large power stations using fossil fuel resources, and distribute it over long distances. This results in quick depletion of fossil fuel resources, increased environmental pollution, and potentially significant energy losses during transmission and distribution. This motivates the study and adoption of microgrids [\cite=mgtrend] [\cite=mgs], which are small-scale power supply networks with distributed generations and demands. A microgrid consists of an interconnected network of several energy sources (including both conventional and renewable energy generators), and serves the local electrical loads from residential, commercial, and industrial consumers. In comparison with centralized and conventional models of power system, the microgrid brings several benefits: reducing power transmission loss, enhancing the system resilience, and integrating distributed generations especially from renewable sources. Wide deployment and proper management of microgrids can have significant positive impact on the overall power grid system.

Several recent representative studies on the interactions among multiple microgrids include [\cite=mg5] [\cite=mg6] [\cite=mg8] [\cite=mg9] and the references therein. However, the studies in [\cite=mg5] [\cite=mg6] [\cite=mg8] [\cite=mg9] either assumed that all the microgrids are coordinated by a common grid operator, or focused on the interaction between the main grid and microgrids in a hierarchical structure. Although these scenarios are practically important, it is equally important to consider the scenario that involves multiple small autonomous microgrids operating in an distributed fashion, which is considered as an important feature of the next generation smart grid [\cite=mgtrend] [\cite=mgs]. These interconnected microgrids can exchange energy and information with each other, and are operated by independent microgrid operators instead of a common coordinator. This essentially leads to an (small scale) energy market of interconnected microgrids. Thus, it is important to design a new operation framework for this new decentralized paradigm.

To design a new distributed optimization operation framework for interconnected microgrids, we need to tackle the following two challenges: incentive issues and decision coupling. First, autonomous microgrids are independent entities with self-interests, and they will only interact with other microgrids if such interactions lead to additional benefits. Hence it is essential to design incentive mechanisms that encourage such interactions. Second, each microgrid has two different types of operating decisions: external strategy on how to interact with other microgrids and internal strategy on how to coordinate local power supply and demand. These two types of operating decisions are coupled, e.g., selling energy to other microgrids will reduce the energy supply that can be used to satisfy local needs. Similarly, the decisions of different microgrids are also tightly coupled together, as the total supply and demand in the market depend on every microgrid's decision.

In this paper, we propose an incentive mechanism using Nash bargaining solution, to encourage proactive interactions and fair benefit sharing among interconnected microgrids. All the interconnected microgrids jointly optimize their energy trading and scheduling, by taking the advantages of diverse supply and demand patterns in different microgrids. The key idea is to exploit the fact that supply and demand profiles in different microgrids exhibit both time and location diversities. Due to the time-varying and location-dependent nature of renewable energy generations, one microgrid may have excess local renewable generation at the same time when another microgrid is deficient in power supply from its local generation. In addition, users' power consumption profiles in different microgrids can also be significantly different, because of various types of consumers. Measurement data show that the residential users consume more power in the night, while the commercial power usage reaches peak during day time [\cite=loadprofile]. The diversified renewable outputs and demand profiles provide ample opportunities for interconnected microgrids to exchange electricity with each other to enhance their operational performance and reduce operating cost.

The main contributions of this paper are listed as follows.

Joint scheduling and trading: We develop a holistic model for the microgrids-system to jointly optimize power scheduling within individual microgrids and energy trading among interconnected microgrids.

Incentive mechanism design: We propose a bargaining-based incentive mechanism for energy trading among interconnected microgrids, which can leverage their diverse supply/demand profiles and bring mutual benefits.

Problem decomposition and distributed solution: We decompose the bargaining problem into two sequential subproblems to solve the optimal energy schedules and trading payments, respectively. We also design a distributed solution method with limited information exchange overhead that is suitable for the practical implementation.

Numerical simulations and implications: Numerical studies based on realistic data demonstrate the effectiveness of the energy trading solution, with a total cost reduction of 13.2% for the interconnected-microgrids system.

The remainder of this paper is organized as follows. We review the related work in Section II. In Section III, we formulate the joint energy trading and scheduling of interconnected microgrids as a Nash bargaining problem. We present theoretical analysis of the problem and propose a decentralized solution method in Section IV and V, respectively. Numerical results are presented in Section VI. Finally, we conclude this paper in Section VII.

Related Work

Operation of the multiple-microgrids system has attracted extensive research in [\cite=mg5] [\cite=mg6] [\cite=mg8] [\cite=mg9]. Fathi and Bevrani studied cooperative power dispatching of multiple interconnected microgrids in [\cite=mg5], and considered the impact of demand uncertainty in [\cite=mg6]. The studies in [\cite=mg5] [\cite=mg6] all assumed that the microgrids are coordinated by a common operator. This may not always be the case in practice, where microgrids can be self-managed and independent entities. Asimakopoulou et al. [\cite=mg8] proposed a leader-follower energy management strategy to study the interactions between an energy producer and energy service providers. Wang et al. [\cite=mg9] studied the interactions between a distribution network operator and clusters of microgrids. The studies in [\cite=mg8] [\cite=mg9] have mainly focused on the interactions between the main grid and microgrids under a hierarchical structure.

Several other studies explored direct interactions among interconnected microgrids [\cite=mg14] [\cite=mg15]. Matamoros et al. [\cite=mg14] studied energy trading between two islanding microgrids. Gregoratti and Matamoros [\cite=mg15] explored energy exchange among multiple microgrids, and formulated a convex optimization problem to minimize the global cost. However, studies in [\cite=mg14] and [\cite=mg15] did not consider the self-interests of multiple microgrids. Recent work [\cite=mg10] [\cite=addgame2] [\cite=addagent4] [\cite=addagent5] studied the energy trading and management problems of microgrids using game-theoretic approaches. For example, Zhang et al. in [\cite=mg10] proposed a randomized auction framework for microgrids to participate in the electricity market. Wang et al. in [\cite=addgame2] proposed a double-auction market for distributed storage units to trade energy in the smart grid. Nunna et al. proposed the agent-based energy management methods to facilitate energy trading among microgrids with demand response in [\cite=addagent4] and with distributed storage in [\cite=addagent5]. In this paper, we aim to study the energy trading among multiple interconnected microgrids, considering the self-interest and diverse generation and load profiles of each microgrid. We formulate a holistic model for the interconnected-microgrids system and jointly optimize both their internal power scheduling and external energy trading. We design an incentive mechanism to encourage proactive energy trading among interconnected microgrids, such that each participating microgrid can benefit from the trading. We propose a two-step solution method, and design a distributed algorithm to solve energy trading and payment. Finally, we validate the performance of our proposed method using realistic data.

Interconnected-Microgrids System

We consider a network of M interconnected microgrids M  =  {1,...,M}. These microgrids are connected to the main power grid, and are also interconnected with each other. These interconnected microgrids can exchange power and information with each other through a power bus and a communication network. Fig. [\ref=fig-system] illustrates such a system model. Each microgrid i∈M contains the following components: local renewable generation, energy storage, and demand responsive users. We consider an operation horizon of one day, which is divided into T = 24 equal time slots, denoted as T  =  {1,...,T}. We assume that microgrids can schedule their power supplies and flexible loads based on the prediction of daily renewable energy profiles, and any mismatch caused by the prediction errors can be balanced in the real-time market. In this paper, we focus on the energy trading and scheduling in a day-ahead market. The microgrid operator is responsible for the power scheduling in the microgrid as well as its energy trading with other interconnected microgrids at the beginning of each day.

As power scheduling and energy trading are highly coupled across microgrids, we aim at the joint optimization of all the interconnected microgrids in a distributed fashion. Before presenting the interconnected energy trading model, we formulate the power scheduling problem within each microgrid.

Power Scheduling in Each Microgrid

Power supply in microgrid i can be categorized into local renewable power generation and power from the main grid.

Local renewable power generation

There are various types of renewable energy technologies, such as wind, photovoltaic, biomass, and tidal systems. We will focus on the renewable power generation from the wind source as a concrete example in this paper, as our later numerical evaluations will be based on the wind speed data obtained from the Hong Kong Observatory [\cite=hkdata].

Based on the hourly wind speed data [\cite=hkdata], we use a wind power model [\cite=windmodel] to calculate the corresponding wind power generation [formula] in microgrid i per kW capacity. We assume that microgrid i has installed wind turbine generators with total generation capacity Gi (kW), and have the following constraint for the wind power supply [formula]:

[formula]

where ηtiGi denotes the maximum available wind power of microgrid i in time slot t. Note that the local wind power usage gti of microgrid i in time slot t can be less but no greater than the available wind power ηtiGi, because the microgrid operator can either curtail excess wind power generation or sell excess generation back to the main grid.

Different from conventional power generations, wind power generation does not consume fuel sources, so for simplicity we assume a zero marginal generation cost [\cite=zerocost].

Main grid power

When the local wind power generation is not adequate to meet the demand, microgrid i can also purchase power from the main power grid. Let qtb,i denote the power bought from the main grid by microgrid i in time slot t, and define [formula]. The purchased power [formula] is subject to the following constraint:

[formula]

where Q maxb,i denotes the maximum amount of power that microgrid i can purchase from the main grid, due to physical capacity limit.

When the microgrid has excess local wind power generation, it can sell power back to the main grid under a feed-in tariff contract [\cite=feedin]. Let qts,i denote the power sold to the main grid by microgrid i in time slot t, and define [formula]. The power sold to the main grid [formula] satisfies the following constraint:

[formula]

where Q maxs,i denotes the maximum allowed amount of power that microgrid i can sell to the main grid.

Energy cost is associated with the main grid power schedules and prices. We denote ptb as the power procurement (buying) price and denote pts as the power feed-in (selling) price set by the main grid in time slot t. For notational simplicity, we let [formula] denote the main grid power schedule of microgrid i over T time slots. The energy cost of microgrid i is written as

[formula]

Local power demand

Let Ni denote the set of users in microgrid i∈M. We classify the loads of each user n∈Ni into two categories: inelastic loads and elastic loads.

The inelastic loads, such as refrigerator and illumination demands, cannot be easily shifted over time. We let bti denote the aggregate inelastic load of all the users in microgrid i and time slot t, and denote [formula]. The elastic loads, such as electric vehicle, HVAC (heating, ventilation and air conditioning) and washer demands, can be flexibly scheduled over time. For user n∈Ni in microgrid i, the elastic load is denoted as [formula], where xtn is user n's elastic power consumption in time slot t.

The demand response program can only control the elastic loads, and should be subject to the following constraints:

[formula]

where constraint ([\ref=constraint-load1]) corresponds to the prescribed total energy requirement Dn in the entire operation horizon. Constraint ([\ref=constraint-load2]) provides a lower bound dt, minn and upper bound dt, maxn for the power consumption of user n in each time slot t. Elastic power consumption of user n can be scheduled across time as long as the power consumption satisfies the constraints ([\ref=constraint-load1]) and ([\ref=constraint-load2]). However, scheduling power load may affect user's comfort. Let [formula] denote the most preferred power consumption of user n. When the actual power consumption [formula] deviates from the preferred power consumption [formula], user n will experience discomfort. Similar as the discomfort measure in [\cite=discomfort], we define the discomfort cost of user n as

[formula]

where [formula] measures how much the actual power consumption differs from the preferred power consumption. Weighted coefficient βn is used to indicate the sensitivity of user n towards the power consumption deviation.

Local energy storage

Energy storage (such as batteries) can smooth out the intermittent wind power generation, flatten the power load by charging when the load is low and discharging during peak load times, and exploit time-varying electricity prices for arbitrage. We assume that microgrid i has installed energy storage devices with a total capacity S maxi, and let sti, rtc,i, and rtd,i denote the amount of electricity stored, charged, and discharged in time slot t, respectively.

First, the charging and discharging power in each time slot t are bounded, and satisfy the following constraints:

[formula]

where r maxc,i and r maxd,i denote the maximum charging and discharging rates of energy storage in microgrid i, respectively.

Second, there are power losses when electricity is charged into and discharged from the battery. We denote [formula] and [formula] as the conversion efficiencies of charging and discharging. Therefore, we obtain the energy storage dynamics of microgrid i in time slot t as

[formula]

Third, repeated charging and discharging cause degradation of the energy storage devices. The life-time of energy storage is usually characterized by the number of charging/discharging cycles under a given depth of discharge (DoD) [\cite=DOD], which is defined as the maximum discharge to the capacity. The storage can sustain more charging/discharging cycles with smaller DoD. We denote DoDi as the DoD requirement for energy storage operation in microgrid i, and have the following constraint for the energy level:

[formula]

where S maxi and (1  -  DoDi)S maxi are upper and lower bounds for the level of stored energy in microgrid i, respectively. Specifically, the stored energy should be no greater than the physical capacity S maxi, and no less than the operational requirement (1  -  DoDi)S maxi. We also restrict the terminal energy level sTi to be the same as its initial level s0i, such that the daily storage operation is decoupled across different days.

Last, to incorporate the degradation of energy storage caused by charging and discharging, we introduce cs as the amortized cost of charging and discharging over the lifetime, and model the cost of energy storage operation [\cite=storagecost] as

[formula]

where [formula] and [formula] denote the charging and discharging amount over the operation horizon T in microgrid i, respectively.

Single Microgrid's Cost Minimization Problem

In each microgrid, its operator coordinates the power scheduling, energy storage charging, discharging, and elastic load shifting. First of all, the microgrid operator should keep the power supply and demand balanced, i.e.,

[formula]

where the left-hand side represents the total power supply in time slot t, including wind power generation gti, power drawn from the main grid qtb,i, and power discharged from the battery rtd,i. The right-hand side represents the total power demand in time slot t, including power sold to the main grid qts,i, power charged into the battery rtc,i, aggregate inelastic load bti and aggregate elastic load of all the users [formula].

Moreover, the power sold to the main grid qts,i cannot be greater than the total available power of microgrid i, i.e.,

[formula]

where the total available power in time slot t consists of the local wind power surplus ηtiGi  -  gti and the battery energy level sti.

We assume that the microgrid operator owns both renewable energy generators and energy storage facilities, and can schedule the elastic loads through demand response programs. The objective of each microgrid operator is to minimize its total operating cost, including the energy cost, energy storage operation cost, and users' discomfort costs. For simplicity, we denote the operating cost of microgrid i as

[formula]

Therefore, we formulate the microgrid operator's operating cost minimization problem as follows

Cost minimization problem for Microgrid i (P-MGi)

We can verify that Problem P-MGi is convex, and can be efficiently solved by several standard optimization techniques [\cite=convex]. We let CNoni denote the optimal value of the objective function in Problem P-MGi, which indicates the minimum cost that microgrid i can achieve without trading energy with other microgrids. It also serves as the noncooperative benchmark for comparison in Section IV.

Energy Trading among Microgrids

Now we consider the possibility of energy trading among interconnected microgrids. Microgrids at different locations have different renewable power generations and local load profiles. Through trading energy with each other, interconnected microgrids can exploit the diversities of supply and demand patterns, and achieve mutual benefits. Next we will study the energy trading interactions among interconnected microgrids based on the Nash bargaining solution [\cite=nash].

A Nash bargaining problem solves a fair Pareto optimal solution and leads to a bargaining solution, which fulfills the following axioms [\cite=nash].

Individual Rationality: All players should improve their utilities through the bargaining compared with their performances without cooperation (namely disagreement points); otherwise, they would not cooperate.

Feasibility: For the bargaining game, there exists at least one feasible solution that satisfies all the constraints.

Pareto Optimality: A player cannot find another solution, in which every player receives a utility no smaller than the one received in the Nash bargaining game, and some player receives a payoff that is strictly higher than the one received in the Nash bargaining game.

Independence of Irrelevant Alternatives: If the bargaining solution is found on a smaller domain of the feasible set, then the solution is not affected by expanding the smaller domain within the feasible set.

Independence of Linear Transformations: The bargaining solution is invariant if the utility function and disagreement point are scaled by a linear transformation.

Symmetry: If players have the same disagreement points and utility functions, they will have the same utility at the bargaining solution regardless of their indices.

Axioms 1), 2), and 3) define the bargaining set, and axioms 4), 5), and 6) ensure the fairness of the bargaining solution.

We consider that each microgrid i∈M bargains with all the other interconnected microgrids to determine the amount of energy trading [formula] and the associated payment [formula]. Here eti,j denotes the amount of energy that microgrid i exchanges with microgrid j in time slot t, and πi,j denotes the associated payment for energy trading between microgrid i and microgrid j. If microgrid i purchases energy from microgrid j in time slot t, then eti,j  >  0; otherwise, microgrid i sells energy to microgrid j and eti,j  <  0. Similarly, if microgrid i makes payment to microgrid j, then πi,j  >  0; otherwise microgrid i receives payment from microgrid j and πi,j  <  0.

The energy trading and payment among microgrids should satisfy the market clearing constraints:

[formula]

We assume that the microgrids are located close to each other, such that the loss of energy exchange is negligible. The new power balance constraint for each microgrid is written as

[formula]

where [formula] is the net energy traded between microgrid i and all other microgrids in time slot t. If [formula], microgrid i purchases energy from other microgrids to serve its local demand; otherwise, [formula], microgrid i sells energy to make profit.

Though the interconnected microgrids cooperate and trade energy with each other, they are still independent and selfish players. Each microgrid is a self-interested rational decision maker, it aims to optimize its own performance in terms of minimizing its total cost through energy trading. Compared with the cost function of microgrid i in Problem P-MGi, the interconnected microgrid has an extra cost that is the payment to other microgrids, i.e.,

[formula]

The overall cost of microgrid i consists of both operating cost [formula] and trading payment [formula]. It is clear that a microgrid will only participate in the trading if it can reduce its overall cost. This means that some microgrid may choose not participate in the trading. Thus, we have the following constraint:

[formula]

Here the left-hand side of the inequality counts the overall cost of microgrid i when participating in the energy trading. In the right-hand side, CNoni denotes the minimized cost that microgrid i can achieve without trading energy with other microgrids. In the bargaining literature we also call CNoni the disagreement point.

Nash Bargaining Formulation for Energy Trading

We let M'  ⊆  M denote the set of microgrids who are willing to trade energy with each other. For the microgrids [formula], they cannot benefit from energy trading and thus have no incentive to participate in the energy trading. Therefore, we focus on the microgrids in set M', and formulate their energy trading as a Nash bargaining problem:

Nash bargaining problem for energy trading (NBP)

[formula]

where [formula] corresponds to the cost reduction of microgrid i, i.e., the difference between disagreement point CNoni and the total cost [formula] of microgrid i through bargaining. Compared with the summation of performance improvement of microgrids, the Nash product can guarantee that the benefits of cooperation are shared by each microgrid in a fair manner.

Solving Problem NBP yields the optimal strategy of energy trading and payment, as well as the optimal power scheduling in each microgrid i∈M'. However, we do not know the subset M' before hand. Moreover, to solve Problem NBP centrally, we need complete information of the interconnected-microgrids system, including all the operational parameters of each microgrid. This, however, may not be feasible in practice.

To address the above two issues, we will analyze the Problem NBP to identify the microgrids with willingness to trade energy in Section IV, and design a decentralized solution method for the practical implementation in Section V.

Problem Analysis

In this Section, we will analyze the Nash bargaining problem NBP and explore the connection between the bargaining solution and the social optimal solution of the interconnected-microgrids system. Based on the connection, we then decompose NBP into two consecutive problems on energy trading & scheduling and trading payment, respectively.

We first assume that we know the subset M', and focus on the microgrids in set M'. Each microgrid i∈M' is willing to participate in the energy trading market and can strictly improve its performance in terms of lowering its total cost i.e., [formula]. Take this group of microgrids as the new system, and the total cost for the system will be reduced due to energy trading, i.e., [formula]. But there remains a question: what is the optimal total cost for the microgrids-system? We have the following observation presented in Proposition 1.

For the microgrids in set M', the optimal energy trading & scheduling solution to Problem NBP also minimizes the total cost of this group of microgrids i∈M'.

Proposition 1 shows that the cooperation among microgrids achieves the best performance for the system. The intuition is as follows. The microgrids can be better off if the overall performance of the system improves, as they are able to gain benefits from the performance improvement (as cost reduction) of the overall system through proper money transfer (payments). Therefore, all the microgrids will cooperate to maximize the total benefit of the system, which explains why the minimum total cost can be achieved. For microgrids in set [formula], they do not have incentives to trade energy, and thus each such microgrid i achieves the same performance of CNoni as in Section III.B, when they operate separately from other microgrids. Therefore, only those microgrids in set M' that trade energy with others contribute to the total cost reduction of the system. Next, we present a systematic method to determine which microgrids do not trade energy in the system.

By Proposition 1, we can decompose the original Nash bargaining problem NBP into two sequential subproblems, as presented in Theorem 1.

The energy-trading bargaining problem NBP can be decomposed into two sequential subproblems on energy trading & scheduling and trading payment, denoted as P1 and P2, respectively. In the first step, we solve a social operating cost minimization problem P1 for the interconnected-microgrids system, which yields the optimal energy scheduling and energy trading for all microgrids. Those microgrids that trade energy with other microgrids form the set M'. In the second step, microgrids in set M' bargain with each other to determine the energy-trading payments in P2.

P1: Social operating cost minimization problem

Solving P1 determines the optimal energy trading & scheduling [formula] for each microgrid i∈M. If a microgrid i has a nonzero energy trading vector [formula], then it belongs to set M', and will participate in the payment bargaining in Problem P2. For the non-trading microgrids [formula], they do not participate in the payment bargaining and their operating costs are the same as the disagreement points CNonj.

P2: Payment bargaining problem where [formula] denotes the operating cost reduction of microgrid i based on the optimal solution of Problem P1.

Theorem 1 decomposes the bargaining problem NBP into two subproblems, which can be solved sequentially. Firstly, the interconnected microgrids cooperate together to trade energy and minimize the social operating cost of the entire system. Any microgrid trading energy with others contributes to the social cost reduction of the entire multi-microgrid system. These microgrids can benefit from energy trading through sharing the reduced social cost via the bargaining, and hence have incentives to participate in the trading. Specifically, microgrids selling energy to others can receive payments through bargaining, and microgrids buying energy from others can reduce their operational costs (though they need to pay for energy purchase). Solving Problem P1 involves all the microgrids and does not exclude any of microgrids in the system. In the optimal solution of Problem P1, if there exist any microgrids who do not trade with others, these non-trading microgrids do not contribute to the social cost minimization and won't benefit from energy trading. The only criterion for determining trading and non-trading microgrids is whether they can contribute to the social cost minimization. Secondly, after identifying those microgrids who do not want to participate in the energy trading, we then focus on the rest of the microgrids who trade energy. We decide a fair allocation of benefits to each of participated microgrids through the payment bargaining problem P2.

Problem P1 and P2 are both convex, and can be solved efficiently in a centralized optimization manner. However, this may not be feasible in practice, as each microgrid is an independent decision maker, and the smart grid operator may not directly control each microgrid's energy trading and scheduling. Moreover, each microgrid has two categories of decision variables: power schedules [formula] as internal variables, and energy trading & payment [formula] as external variables. Centralized optimization is not practical, because it may violate the privacy of microgrid's internal operation. We will discuss the design of a decentralized algorithm to solve P1 and P2 in the next section.

For the proofs of Theorems, please refer to the appendix.

Decentralized Solution Method

In this section, we design a decentralized solution method, which enables the microgrids to coordinate with each other to solve P1 and P2. We use the alternating direction method of multipliers (ADMM) [\cite=ADMM] to design the distributed algorithm, as ADMM has good convergence properties for the optimization problems with non-strictly convex objective functions and large-scale variables.

Solving P1 (Social Cost Minimization)

First, we solve P1 in a decentralized fashion. Since the convergence of the multi-block ADMM algorithm cannot be guaranteed, we introduce auxiliary variables for the energy trading decisions in order to convert the M-block (corresponding to M-microgrid) structure of the original optimization problem into an equivalent two-block structure. The convergence of ADMM algorithm with two blocks of variables is guaranteed [\cite=ADMM]. Specifically, let us introduce auxiliary variables [formula], and replace constraints [\eqref=constraint-trading1] by

[formula]

We define [formula] as the dual variables associated with constraints [\eqref=constraint-auxiliary1], and have the augmented Lagrangian for P1:

[formula]

where ρ1 > 0 is a parameter for the quadratic penalty of constraint [\eqref=constraint-auxiliary1].

The ADMM solution method involves iterations between a lower level problem and a higher level problem. Specifically, the lower level problem involves microgrids solving their local optimization problems in parallel based on fixed dual variables [formula] and auxiliary variables [formula]. The upper level problem involves updating the auxiliary variables and dual variables using the results from the low level problems.

In iteration k, given parameter ρ1(k), dual variables λti,j(k) and auxiliary variables êti,j(k), each microgrid i solves its local optimization problem:

Local optimization problem of P1 (P1-MGi)

Based on the solution [formula] from Problem P1-MGi, the higher level problem updates auxiliary variables [formula] and dual variables [formula]. Specifically, the higher level problem of P1 is formulated as follows:

As the auxiliary variables are only coupled between each pair of trading partners, we can solve the higher level problem of P1 by considering the following optimization problem only involving a pair of microgrids i and j, and obtain the optimal closed-form solution for updating êti,j:

[formula]

Based on eti,j(k + 1) and êti,j(k + 1), we update the dual variables as follows:

[formula]

Solving P2 (Payment Bargaining)

Second, we solve P2 in a decentralized fashion. We introduce auxiliary variables [formula], and replace constraints [\eqref=constraint-trading2] by

[formula]

We take the log transformation of the objective function of the bargaining problem P2, and write the Lagrangian for P2:

[formula]

where [formula] are dual variables associated with constraints [\eqref=constraint-auxiliary3], and ρ2 is a penalty parameter.

Similarly, solving Problem P2 involves iterations between a lower problem and a higher problem. In iteration k, given π̂i,j(k) and γi,j(k), each microgrid solves its local optimization problem:

Local optimization problem of P2 (P2-MGi)

Based on the solution πi,j(k + 1) from Problem P2-MGi, the higher level problem updates the auxiliary variables [formula] and dual variable [formula]. Specifically, the higher level problem of P2 is formulated as follows:

We can solve the higher level problem of P2 by considering a pair of microgrids i and j, and obtain the optimal closed-form solution for updating π̂i,j:

[formula]

Based on πi,j(k + 1) and π̂i,j(k + 1), we update the dual variables as follows:

[formula]

Algorithm Design and Implementation

To implement the solution method for solving the energy trading and payment problems P1 and P2, we design a distributed algorithm, as shown in Algorithm 1. We see that Algorithm 1 solves problems P1 and P2 through iterations between higher level and lower level problems within Step 1 and Step 2, respectively. We introduce the concept of virtual clearing house for solving the higher level problem. The virtual clearing house is a communication and computing module, which provides clearing service of energy trading and payment for all the microgrids. At the beginning of each daily operation, the virtual clearing house updates the auxiliary and dual variables according to ([\ref=updateenergy]), ([\ref=updatelambda]) and ([\ref=updatepayment]), ([\ref=updategamma]), and broadcasts to all participating microgrids when solving P1 and P2, respectively. All the participating microgrids concurrently solve P1-MGi and P2-MGi and report their energy trading schedules and payments to the virtual clearing house.

We see that Algorithm 1 only requires limited information exchange overhead among microgrids. Each microgrid only needs to communicate with the clearing house instead of all the remaining microgrids. Such communication can be supported by many existing one-to-many communication technologies, such as the LTE cellular technology. For the microgrids, they only need to report their energy trading and payment schedules, as it's reasonable to let the counterpart microgrids know the trading amount of energy and payment during each iteration. As for the local power scheduling, demand response, and energy storage charging/discharging, each microgrid will compute its own optimal decision, without disclosing its private information of internal operations to other microgrids. Therefore, Algorithm 1 solves the energy trading problem EP1 with minimum information without releasing microgrid's private power schedules.

Based on [\cite=ADMM], we demonstrate the convergence of Algorithm 1 in the following theorem.

Algorithm 1 converges to the optimal solution of P1 in step 1 and the optimal solution of P2 in step 2, under proper stepsizes of ρ1(k) and ρ2(k), e.g., ρ1(k)  =  1 / k  →  0, and ρ2(k)  =  1 / k  →  0, as k  →    ∞  .

We can divide the decision variables of Problem P1 into two blocks: [formula] and [formula]. Similarly, we can divide the decision variables of Problem P2 into two blocks: [formula] and [formula]. Since P1 and P2 are convex problems and Algorithm 1 is a standard two-block ADMM algorithm, we conclude that the convergence of Algorithm 1 is guaranteed [\cite=ADMM].

Simulation Evaluations

We consider three interconnected microgrids, each having its local wind generation. Based on the hourly wind speed data [\cite=hkdata] at several different Hong Kong locations, we calculate the daily realizations of hourly wind power, and use wind power productions on January 18, 2013 at Tate's Cairn, Tai Po Kau, and Sai Kung of Hong Kong as local renewable generations in the three microgrids, respectively. Fig. [\ref=fig-windpower] depicts the wind power generations in microgrids 1, 2 and 3. The electricity price of the main power grid is retrieved from ISO New England [\cite=price] and is depicted in Fig. [\ref=fig-price], and the feed-in rate is set as 0.1. Other parameters are summarized as follows: G1  =  600, G2  =  G3  =  1000, Q max1  =  500, Q max2  =  Q max2  =  300, β1  =  1.0, β1  =  β2  =  0.5, r maxc,1  =  r maxd,1  =  30, r maxc,2  =  r maxd,2  =  40, r maxc,3  =  r maxd,3  =  50, S max1 = 100, S max2  =  S max3  =  200, cs  =  0.01, and ηc,i  =  ηd,i  =  0.95, i = 1,2,3.

Optimal Energy Trading

We first study the optimal energy trading of all three microgrids, as depicted in Fig. [\ref=fig-trading]. Here positive values correspond to purchasing energy, and negative values correspond to selling energy. We see that all three microgrids exchange energy actively across the 24-hour operation horizon. From Fig. [\ref=fig-windpower], we see that microgrid 1 has higher wind power output than other microgrids, and thus sell excessive energy to other microgrids during most of time slots except hour 7. The reason for this is that microgrid 1 has a sudden drop of wind power supply in hour 7, while microgrid 3 has adequate generation in the same hour. Therefore, microgrid 1 purchases energy from microgrid 3 in hour 7. Microgrid 2 and microgrid 3 purchase energy during hours 1-10 and 23-24, because they lack local wind generations during the corresponding time slots.

Optimal Power Scheduling

Through energy trading, the overall multi-microgrid system purchases less power from the main grid, hence improves the overall utilization of local renewable energy. We compare the main grid power schedules with and without energy trading, as depicted in Fig. [\ref=fig-gridpower]. Note that even without energy trading among microgrids, we always allow microgrids to sell excessive renewable energy to the main grid. We see that microgrid 2 purchases less power from main grid with energy trading, because they can get power supply from microgrid 1 and microgrid 3. Microgrid 1 and microgrid 3 also sell less power to the main grid with energy trading, because they sell more local wind power to microgrid 2.

Fig. [\ref=fig-powerload] depicts the optimal demand response of microgrids 1, 2 and 3 in the scenario with energy trading. We see that microgrid 1 has peak power load at night time (hours 18-22), and original power loads in microgrid 2 and microgrid 3 achieve peak levels at day time (hours 9-17). As shown in Fig. [\ref=fig-windpower] and Fig. [\ref=fig-price], the aggregate renewable power generation has higher output during hours 1-10, and the electricity price is higher in peak-time slots (hours 11-20). Therefore, all the microgrids shift their flexible loads from peak-time slots to off-peak time slots to use more renewable energy and reduce their operational costs.

Fig. [\ref=fig-storage] shows the comparison of optimal energy storage dynamics with and without energy trading, for microgrids 1, 2 and 3, respectively. We see that at the beginning of the day, all microgrids charge more power into energy storage in the scenario with energy trading than without energy trading. This is because microgrids can trade renewable power with other microgrids, and thus store more energy in batteries to meet their peak loads later.

Optimal Payment

Table [\ref=tab-payment] shows the operating costs of microgrids 1, 2 and 3 and their payments for energy trading. The total cost of the interconnected microgrids is reduced by up to 13.2% from 1637.8 to 1422.4. We see that energy trading reduces the operating costs of microgrids 2 and 3. The operating cost of microgrid 1, however, increases. The reason is that microgrid 1 sells more wind power to other microgrids for profits, instead of selling back to the main grid. Microgrid 2 pays 124.5 and 33.4 to microgrid 1 and microgrid 3. Considering the overall impact of cost and payment, every microgrid benefits through energy trading. For example, microgrid 1 reduces the cost from 243.8 (no trading) to cost plus payment 172.1 (with trading), which corresponds to a 29.4% decrease. This demonstrates the effectiveness of our proposed payment scheme, which incentivizes microgrids to participate in the energy trading.

Conclusion

In this paper, we studied the energy trading problem among interconnected microgrids using Nash bargaining theory. We first presented a model for a single microgrid that captures key features of smart grid technologies. Then we designed a bargaining-based energy trading market for interconnected microgrids, and proposed a distributed solution method. Numerical simulations based on realistic meteorological data demonstrated the effectiveness of the energy trading mechanism. In our future work, we will consider the role of the power grid operator in the energy trading of microgrids.

Proof of Proposition 1

For the microgrids in set M', they have incentives to trade energy with each other. For any group of microgrids who trade energy with each other, we conclude that the aggregated operational cost of the microgrids-group G decreases, i.e., [formula]. There always exists a feasible payment allocation [formula], such that its performance improves in terms of cost reduction, i.e., [formula].

As constraint [\eqref=constraint-trading4] is guaranteed to be satisfied, we can divide the decision variables of the Nash bargaining problem NBP into two sets: the energy trading & power scheduling variables [formula] and trading payment variables [formula]. We observe that these two sets of variables are decoupled, thus we can solve Problem NBP in a sequential manner.

Given the optimal energy trading & power scheduling decisions [formula], we can solve the optimal trading payment decisions [formula] through

[formula]

and obtain

[formula]

Substituting ([\ref=optimalpayment]) into Problem NBP yields the optimal objective:

[formula]

From ([\ref=optimalobjective]), we conclude that Problem NBP maximizes the social welfare of all microgrids in M', i.e., [formula]. Since CNoni is given, we prove that Problem NBP minimizes the social cost of all microgrids in M', i.e., [formula].

Proof of Theorem 1

For microgrids in set M', we have proved in Proposition 1 that Problem NBP minimizes the social cost of all microgrids in M'. Therefore, we can solve Problem NBP in a sequential manner. First, we solve the optimal energy trading & power scheduling to minimize the social cost of microgrids in M'. Second, we solve the optimal trading payment to maximize the Nash product in NBP.

However, we do not know the set M'. Since a microgrid [formula] does not have incentives to trade energy, its optimal energy trading decisions will be [formula], and its optimal cost is the same as the benchmark cost CNonj. Therefore, we can solve the cost minimization problem for the whole system consisting of all the microgrids in set M, and determine the set M' in which microgrids trade energy.

Specifically, we have the following two steps to solve Problem NBP. In the first step, we minimize the social cost of the microgrids-system in Problem P1:

Solving P1 determines the optimal energy trading & scheduling [formula] for each microgrid i∈M. Based on the optimal energy trading decisions, we determine the set M' in the following. Specifically, set M' is made up of microgrids having nonzero energy trading vector [formula]. For each of the remaining microgrids [formula], it has a zero energy trading vector, i.e., [formula], and thus neither receives nor makes payment, i.e., [formula]. Only those microgrids in set M' would bargain with each other to decide the associated trading payments.

In the second step, we solve the optimal trading payment for microgrids i∈M' in Problem P2: where [formula]. Solving P2 determines the optimal payments for those microgrids participating in energy trading.