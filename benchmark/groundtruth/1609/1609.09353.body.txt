=300

Deep Multi-Species Embedding

Introduction

The distribution of species is an important index in detecting environmental degradation and climate change. Therefore, understanding how species are distributed across landscapes over time is a fundamental question in biodiversity research. However, most species distribution models only target a single species at a time [\cite=Phillips2004Maxent] [\cite=elith2009species] [\cite=fink2013adaptive], despite the fact that the living and diffusion of one species often depends on others. For example, American Robin and Blue Jay are more likely to seen in the same place since the Blue Jay preys on American Robin eggs or fledglings and sometimes even steals its nest. Therefore, a model that predicts the occupancy of a collection of species instead of modelling each species individually is needed. The most straightforward way which directly formulates the probability of seeing a collection of species suffers from combinatorial intractability due to the large number of possible ways to form the collection. As a result, an efficient method of modelling the joint distribution of species in a large scale is still lacking.

We propose a novel method called Deep Multi-Species Embedding which can jointly model the distribution of hundreds of species as well as the correlation among species. DMSE jointly embeds multiple species as well as environmental covariates into a high-dimensional feature vector space via a deep neural network. Each embedded vector carries semantic meaning to the modeled entity, and the inner products between them demonstrate the relationships between entities (such as environmental preference or correlation between species).

Applied to eBird bird watching data [\cite=ebird4], our single-species DMSE model outperforms commonly used random forest models and SVM in terms of accuracy and log-likelihood. The experimental result also shows that our multi-species DMSE model further improves the single version on multi-species modeling. As the number of species goes up, the predictive performance of our multi-species DMSE keeps improving when compared with the single version.

In addition, we also show a visualization of the embedding for hundreds of bird species in the Northeast US. It provides an intuitive picture about species’ environmental preferences and the correlations among each other. Through this model, we are also able to quantitatively measure many species-species interaction which could only be qualitatively described by the ecologists.

Multi-Species Modelling

Our goal is to estimate the joint distribution of different species which can help us better understand the multi-species distribution based on the observation data. More formally, given a collection of species {species1,...,speciesn} and the species observation data D = {(b1,l1),...,(bN,lN)}, we would like to estimate the distribution Pr (bi|li). Here bi∈{0,1}n is an indicator for the species co-occurrence of each observation, bi,j = 1 iff speciesj presents in that observation, and li = (f1,...,fm)T is an environmental feature vector that contains the weight of m relevant environmental covariates for that observation site. For ease of notation, we also use li to denote the observation site i in the following text.

From One Species to More

Our DMSE method originates from the probit model [\cite=chib1998analysis] which is widely used to model binary outcomes, for example, whether a species is present or not. For the clarity of presentation, we start by describing how to model the distribution of single species using the probit model. For each speciesj, we link the occurrence of speciesj at observation site li with a random variable ri,j where the probability speciesj presents at observation site li is equal to the probability that ri,j > 0, i.e.

[formula]

Here, ri,j follows a normal distribution (μj,σ) where μj is a function of li and σ is fixed to be 1. According to the definition of normal distribution, a positive μj implies that the species is more likely to be present than absent and a negative μj implies the opposite. Therefore, we can model the distribution of each species by parameterizing each μj.

A general approach to model the joint distribution of multiple species is to simply joint the distribution of each species without their correlation which means the presence and absence of each species are independent. For ease of presentation, we call this kind of joint distribution "independent joint distribution".

The left graph in the picture above (Fig.[\ref=figure:joint_dis]) depicts the independent joint distribution of two species (American Robin and Blue Jay) corresponding to random variable ri,1 and ri,2. In the graph, the color from light yellow to red represents the probability from low to high and the probability mass in each quadrant represents the probability of each co-occurrence. For example, the probability mass in the first quadrant shows the probability that American Robin and Blue Jay are present together at the observation site li. The one-dimensional distributions on the graphs' upper side and left side are the marginal distributions for American Robin and Blue Jay respectively. The red area in each one-dimensional distribution represents the probability of the presence of each species unconditional of the other.

Since the independent joint distribution fails to model the correlation between species which widely exists in the real world, we upgrade the probit model by applying multivariate normal distribution over the n-dimensional random variables ri = (ri,1,...,ri,n) i.e.

[formula]

In this way, each random variable ri,j still follows a normal distribution, but we can handle the correlation between species by parameterizing the covariance matrix Σ.

As shown in the right graph, we change the covariance between random variable ri,1 and ri,2 from 0 to a positive number ρ, then the joint distribution changes significantly. For example, the probability mass in the first quadrant becomes larger, which means these two species are more likely to be present together. Although we affect the joint distribution of two species by changing the covariance between ri,1 and ri,2, the marginal distribution of each random variable does not change. This means the probability of the presence of each species, unconditional of the other, is unaffected by the covariance. This property ensures that our model can maintain the predictive capability that only use the environmental preference of each species. Meanwhile, it can outperform the independent version when the species have correlations. In addition, if we regulate the variance of each species to be 1, the matrix Σ becomes a correlation matrix. Thus, we can further have a quantitative understanding about the species-species interactions which are only understood qualitatively among ecologists.

Deep Multi-Species Embedding

In order to estimate the proper parameter μ and Σ for the multivariate normal distribution, we need to first model the species-environment relationship as well as the correlation between species. To achieve this, we first embed each speciesi with two vectors si∈Rd1 and λi∈Rd2 representing its environmental preference and interactive behavior respectively. Here d1, d2 are the dimensionality of these two vector spaces which are manually set. Here we choose to model these two characteristics separately instead of embedding to the same vector, otherwise a similar environmental preference will directly imply a high correlation since our model uses the inner products between vectors to measure the relationship between entities. However, it is possible that two species prefer a similar habitat but they do not have intensive interaction with each other. Using our model, they are not necessarily highly correlated.

When it comes to the environmental feature, we apply a deep neural network and a projection matrix to embed the low-dimensional raw environmental data into the same d1-dimensional feature space as the vectors si. For each observation data (bi,li),

[formula]

Here DNN(  ·  ) is the notation for deep neural network , W is the projection matrix used for modulating the data range and mapping the DNN's output layer to the same high-dimensional feature space with si, and noutput is the dimension of output layer. Here we embed the environmental features via the deep neural network to enhance the predictive power of our model. We will discuss more details about the performance of the neural network in the experimental section.

With these embeddings for each species and the environmental features at each observation site, we use the inner-product sjThi to score the relationship between speciesj and environmental features in the observation site li. Similarly, we also use the inner-product λTiλj to score the correlation between speciesi and speciesj. In order to simplify the presentation, we concatenate the vectors si and λi as the columns into two matrices.

[formula]

Using the notations in equation([\ref=eqn:mvn]), ([\ref=eqn:dnn]) and ([\ref=eqn:gv]) , we can formulate our DMSE model as follows,

[formula]

Here μj  =  sjThi scores the habitat suitability of speciesj at observation site li and Σi,j  =  λTiλj represents the correlation between speciesi and speciesj. According to the definition of multivariate normal distribution, we derive that

[formula]

Finally, we train our model by maximizing the log-likelihood on the observation data. The parameters that should be trained are the matrix S,Λ,W and the parameters in the deep neural network denoted by θDNN.

[formula]

Training and Testing

We use the stochastic gradient descent algorithm as proposed in [\cite=duchi2011adaptive] [\cite=bottou2004stochastic] to optimize the log-likelihood function in equation ([\ref=eqn:OPT]). In order to train and test our DMSE model, we need to be able to compute the integration in equation ([\ref=eqn:DEF]) and its derivatives with respect to each parameter.

For the integration part, we use an adaptive algorithm proposed in [\cite=genz1992numerical], implemented using function mvn in python (scipy.stats) which can calculate the cumulative distribution function (CDF) on multivariate normal distribution with a high accuracy (relative error < 1e - 6).

To compute the derivative of Pr (bi|li), one key observation is that if we can compute the derivative of Pr (bi|li) with respect to μ and Σ, we can easily obtain other derivatives we want by simply applying the chain rule. Since the multivariate normal distribution is uniformly continuous, we first transform the derivative of the integration into the integration of the derivative of density function as follows.

[formula]

Using the definition of multivariate normal distribution, we derive the following equations:

[formula]

According to equation ([\ref=eqn:DEF]), we know that

[formula]

Thus, we can consider [formula] as the density function of a distribution over a hyper-cube Q  ⊆  Rn corresponding to the integration range of equation([\ref=equ:DIS]). Thus, we can employ the Markov Chain Monte Carlo sampling method to estimate the derivative of log  Pr (bi|li) with respect to μ and Σ as follows: To make our model more efficient, we apply an enhancement for our model. Using the property of normal distributions, we know that [formula]. As the result, we can make a cut-off on Li and Ri which significantly reduces our sample range and increases the convergence rate in our sampling process.

Related Works

We refer the reader to [\cite=elith2009species] for a survey of general techniques used in correlative species distribution modeling. Modeling approaches in this area vary depending on the type of observational data and application objectives. The most commonly available observational data records only where species have been detected and identified, known as presence-only data. The authors of [\cite=Phillips2004Maxent] developed the popular MaxEnt model using maximum entropy to estimate the population intensity. More recently, the connections between Poisson point processes and MaxEnt have been used to develop presence-only data models [\cite=fithian2013finite]. Other data collection protocols, like eBird, record both when species are and are not detected. These “presence-absence” datasets are typically modeled using a variety of statistical and machine learning methods including additive logistic regression, random forests, and boosted regression trees. Occupancy models [\cite=mackenzie2006occupancy] use these data to explicitly model the observation and occupancy processes, resulting in stronger ecological inferences [\cite=guillera2015my]. Species distribution models have also been extended to capture population dynamics using cascading models [\cite=sheldon2011collective], Brownian Bridges [\cite=horne2007BrownianBridge], circuit theory [\cite=McRae2008circuitscape], and non-stationary predictor response relationships [\cite=fink2013adaptive]. Recent extensions to joint species distribution models focus on modelling the unobserved environmental factors which potentially drive the correlated distribution [\cite=harris2015generating], and for spatiotemporal dynamics based on Gaussian processes [\cite=thorson2016joint]. The previous work most closely related to ours is [\cite=harris2015generating] which also uses the latent random variables to model correlations. However, the model in [\cite=harris2015generating] can only handle a few (no more than 10) random variables to infer the unobserved factors which potentially drive the correlated distribution, and it ignores the interaction between species. In contrast, our DMSE method can handle hundreds of latent random variables for each species and can quantitatively measure the interaction among species.

Our model is also inspired by embedding methods which are widely applied to many areas, including music [\cite=chen2012playlist], language [\cite=bengio2003neural] [\cite=mikolov2013distributed], online purchase behavior [\cite=rendle2010factorizing] etc. The core idea is to learn a vector (or other structure) to represent each of the data points, so that the interaction in the vector space reflects the semantic meaning in the original data. Embedding methods have been proven to have better generalization performance and to provide a better data visualization as well. To our knowledge, we are the first to apply embedding methods to multi-species modelling.

Experiments

We work with crowd-sourced bird watching data collected from the successful citizen science project eBird [\cite=ebird4]. One record in this dataset is often referred to as a “checklist” in which the bird observer reports all the species he/she detects as well as the time and geographical location of the observation site. Crossed with the National Land Cover Database for the U.S. [\cite=homer2015completion], we can estimate the landscape composition of each observation site li with 15 different land types such as the percentage of the water, forest, grass, etc. Besides the land types, we also include other environmental covariates of li such as the population density, the elevation, average temperature etc. For the use of training and testing, we transform all this data into the form (bi,li) as described in the first paragraph of the Multi-Species Modelling section. The dataset for this experiment is formed by picking all the observation checklists from the Bird Conservation Region (BCR) 13 in the last two weeks of March from the year of 2002 to the year 2012. March is a migration period for BCR 13, therefore a lot of non-native birds pass over this region, which gives us excellent opportunities to observe their habitat choice during the migration. Here we choose the top 100 most frequently observed birds as the species collection which covers 97.6% of the records in our dataset.

In order to fight against overfitting, we use a 5-fold cross validation to validate the multiple choices of learning rate, regularization weight and other hyper-parameters.

What do embeddings look like?

We start by giving a qualitative impression of the embeddings produced by our method and visualized by t-SNE algorithm [\cite=maaten2008visualizing]. Fig.[\ref=fig:ebd] visualizes the embeddings of environmental preference and interactive behavior (si and λi) of each species. In the picture, we manually assign the species into four main categories according to their habitat preference: (1) Birds living near residential areas, such as House Sparrow, Common Grackle, American Robin, Blue Jay, Mallard, Canada Goose, etc. Most of them are easy to find in the backyards, city parks, parking lots and agricultural fields. The presence ratio of these species are more than 25% of the records since they are easy for bird-watchers to find. (2) Birds living in wetlands, such as Swamp Sparrow, Northern Rough-winged Swallow, Killdeer, etc. that live near the water but mainly feed on insects. (3) Water birds, such as gulls, herons and cormorants which need a large amount of open water. (4) Birds living in forest and pasture, such as warblers, woodpeckers, nuthatches, thrushes, hawks, etc. These kinds of birds always live in the forest, grassland, pasture, shrubs, or near forest edges. These are the four categories that do not overlap with each other.

One can see in the left map of Fig.[\ref=fig:ebd], the birds of the same category cluster tightly. For example, the birds living near the human settlements are all on the left of the graph, the birds living in wetlands and the water birds are on the right-top corner. Since the birds living in forest and pasture have a large habitat range, we further highlight three breeds in this category: the warblers, the woodpeckers and the raptors. It is interesting to note that the birds within a breed have a high similarity of habitat preference which coincides with the field observation.

When it comes to the embeddings of correlation (the right map), it can be observed that in most cases, the species living in similar places have a relative higher correlation. However, one can find some interesting cases comparing the left map and the right map. For example, although the Mallard and Canada Goose are more common to see near human habitation, the occurrence of these two birds still has a high correlation with other water birds. What is more, in the left map, we find that the locations of Blue Jay and American Robin are not very close, but from the right map, we know that they have a very high correlation which coincides with the ecological relationship as we described in the introduction section.

Predictive Performance of DMSE

While the visualization provides interesting qualitative insights, we now provide a quantitative evaluation of the model quality based on the predictive power. In our experiment, we analyze the performance of DMSE both on single-species modelling and multi-species modelling. Here we use two metrics to analyze the performance of each model: (1) prediction accuracy, i.e. the percentage that the model correctly predicts the occurrence of all species in the observation. In n-species modelling, we require the model to predict the occurrence (presence or absence) of each n species where there are totally 2n possible results for each observation site. In addition, DMSE predicts the co-occurrence of n species by choosing the indicator [formula] with highest probability Pr (|li). (2) log-likelihood, i.e. [formula].

DMSE's performance on a single-species model

We compare the single-species predictive performance of DMSE with the commonly used random forest model and SVM in terms of prediction accuracy. Here we also analyze the effect of the deep neural network in the DMSE model by analyzing the performance of the DMSE model without neural network, in which we only use projection matrix W to embed the environmental features. We test these four models on different species from very common to rarely seen. As shown in Fig.[\ref=fig:exp1], the neural network makes a significant improvement on the predictive power of our model and with the help of neural network, our DMSE model outperforms other models. (Since in most cases you can not see rare birds, the prediction accuracy becomes very high on the birds rarely seen.)

What are the effects of correlation?

We now explore whether the correlation plays an important role in multi-species modelling. We start by comparing the performance of multi-species DMSE and the single version of DMSE on modelling two-species distribution. The single version of DMSE means we model the multi-species distribution by modelling the distribution of each species separately without their correlation. According to our experimental results, the multi-species DMSE outperforms the single version on all the species pairs that we have tried. Because of the limitation of length, here we only show the performance on 3 pairs of species.

As shown in Fig.[\ref=fig:exp2], with the help of correlation, DMSE has a substantial improvement on multi-species modelling. Therefore, the correlation between species plays a very important role in multi-species modelling. Furthermore, we provide a list which quantitatively measures the interaction between some species pairs with relatively high correlation. When the number of species becomes larger, the prediction accuracy becomes meaningless since there are 2n possible results. Therefore, we analyze the difference between multi-species DMSE and the single version of DMSE in terms of the log-likelihood. One can see (Fig.[\ref=fig:exp3]), as the number of species goes up, the predictive performance of our multi-species DMSE keeps improving when compared with the single version. This highlights the importance of modelling the correlation between species.

Conclusion

We present a novel Deep Multi-Species Embedding model that can handle the joint distribution of hundreds of species simultaneously. The ability to visualize the learned embeddings is also a key feature for easy interpretability and open-ended exploratory data analysis. Since our DMSE significantly outperforms the single version on multi-species modelling, it can potentially help ecologists get a better understanding about species distribution. DMSE is also able to provide a quantitative measure of the correlation between species which provides people a with more detailed understanding about species-species relationship. Furthermore, the embedding models described in the paper can easily be adapted and extended to include further information (e.g., spatio-temporal information), providing many directions for future work.