Inference for spatial processes using imperfect data from measurements and numerical simulations

Abstract

We present a framework for inference for spatial processes that have actual values imperfectly represented by data. Environmental processes represented as spatial fields, either at fixed time points, or aggregated over fixed time periods, are studied. Data from both measurements and simulations performed by complex computer models are used to infer actual values of the spatial fields.

Methods from geostatistics and statistical emulation are used to explicitly capture discrepancies between a spatial field's actual and simulated values. A geostatistical model captures spatial discrepancy: the difference in spatial structure between simulated and actual values. An emulator represents the intensity discrepancy: the bias in simulated values of given intensity. Measurement error is also represented. Gaussian process priors represent each source of error, which gives an analytical expression for the posterior distribution for the actual spatial field.

Actual footprints for 50 European windstorms, which represent maximum wind gust speeds on a grid over a 72-hour period, are derived from wind gust speed measurements taken at stations across Europe and output simulated from a downscaled version of the Met Office Unified Model. The derived footprints have realistic spatial structure, and gust speeds closer to the measurements than originally simulated.

Introduction

Spatial fields are used to represent many different types of environmental process, such as maps of weather forecasts or radar images of past events. The environmental process may only be of partial interest; instead it may contribute towards estimating something else. One example is catastrophe models, which are used to provide loss estimates for natural hazards, such as earthquakes, hurricanes, floods and tsunamis; see [\cite=grossi]. These combine data on natural hazard events, such as the intensity of the event at different locations, with data on property, such as its value and susceptibility to damage, to produce loss estimates. Reliable loss estimates require adequate hazard data. We study European windstorm footprints, which represent the maximum 3 second wind gust speed attained during an event over a 72-hour time period. Simulations of these can under-represent intensity [\citep=xwspaper], whereas measurements tend to be imprecise and spatially sparse. Resulting loss estimates from either may therefore be unreliable. We propose a framework that lets us explicitly consider how both types of data relate to actual values of a process under study, which allows us to make inference on its actual values, which cannot be observed.

The accuracy of measurements on environmental processes can vary considerably between processes. Locations for which measurements are available are finite, and usually coincide with an irregularly-spread set of stations, which may not be located at a point of interest. Spatial field data overcome this. Numerical simulation models, such as variants of climate models, typically offer spatially complete data. We recognise that, however well calibrated or high in resolution, a numerical simulation model will always offer an imperfect representation of reality, that is, of the actual spatial field of the environmental process. This discrepancy between reality and a model's estimate must be recognised before reliable inferences about reality can be made. This work will use both measurements and numerical model simulations--and explicitly account for the deficiencies in each source of data--to derive probabilistic representations of actual spatial fields.

We assume that the spatial discrepancy between a simulated and actual spatial field takes a smooth form. We also assume that the intensity discrepancy, which is the mean bias in the environmental process for a given intensity, takes a smooth form. To accommodate these assumptions in a robust way we adopt Gaussian process priors. We combine covariance forms used in geostatistics and statistical emulation; see [\cite=dig-rib] and [\cite=oak] for respective overviews. We can also readily assume within this approach that measurement errors, given actual values, are normally distributed and arise independently. Our assumptions result in a posterior distribution--with an analytical expression--for the actual spatial field, which fully characterises its probability distribution. Deriving actual spatial fields relates closely to the work of [\cite=fuentes] in which measurements of particulate matter and simulated data are related through a Gaussian model to the 'unobserved truth', for which the posterior distribution is derived. Part of the Extreme Wind Storms (XWS) catalogue [\citep=xwspaper] also had the same aim: to combine measurements and simulated footprints to give 'recalibrated footprints', which are linear functions of simulated footprints achieved using a mixed effects model. This work may be seen as an extension that derives an actual spatial field using a variant of kriging to relax the assumption of linearity between actual and simulated values. Kriging was used to derive the E-OBS gridded datasets [\citep=knmidata] [\citep=knmidata2] from measurements. Unlike the E-OBS data, we also consider simulated data.

The next section of this paper gives details of the proposed framework for deriving actual spatial fields for environmental processes. We derive actual footprints for European windstorms in Section [\ref=eurows] using windstorm Daria for illustration. Section [\ref=discuss] summarises the proposed framework.

Proposed framework

This section describes how we derive actual spatial fields for environmental process using measurements and numerical model simulations.

Prior models for spatial fields

Let Z(s) denote the actual value of some environmental process at location s on region R. Let Y(s) denote a measurement on Z(s). We assume that Y(s)  =  Z(s)  +  ε(s) where ε(s) are independent measurement errors. We then assume that these errors have zero mean and are Gaussian distributed with variance σ2Y, so that

[formula]

Now let X(s) denote a simulation of Z(s). (Typically output X(s) will be represented on a grid with the same boundary as R. We assume that X(s) can be interpolated onto R for any s∈R.) We suppose that

[formula]

so that an actual value of the process, Z(s), is related to the simulated value, X(s), through a parametric discrepancy term, m, and a random discrepancy term, ε, which can vary with space and intensity. We assume a Gaussian process (GP) prior for Z(s) given its simulated counterpart, X(s), which is written

[formula]

where m(  ) and σ2XcX(  ,  ) are its mean and covariance functions, respectively. The covariance function will be used to simultaneously allow smooth forms for the spatial discrepancy, εspatial(s), and the intensity discrepancy, εintensity(X(s)) such that ε(s,X(s))  =  εspatial(s)  +  εintensity(X(s)).

Relation [\eqref=cmomod] represents

[formula]

denotes "distribution of" and Θ represents an arbitrary parameter set. [\cite=guttorp] propose a similar decomposition to equation [\eqref=zgxdecomp] for

[formula]

The posterior distribution of an actual footprint

We combine the prior models of relations [\eqref=obsmod] and [\eqref=cmomod] in Section [\ref=prior-haz] to give the marginal model

[formula]

where m(  ) is as in Relation [\eqref=cmomod] and σ2c(  ,  )  =  σ2YcY(  ,  )  +  σ2XcX(  ,  ), which is based on writing relation [\eqref=obsmod] as a GP with covariance function σ2YcY(  ,  ). For tractability, we assume m(x)  =  hT(x)β, where h(  ) comprises q basis functions (eg. h(x)  =  (1,x)T) and β comprises q regression coefficients. Depending on the forms chosen for the correlation functions, not all their parameters, collectively denoted θ, may be identifiable without prior knowledge, in particular if both cX(  ,  ) and cY(  ,  ) contain nugget terms. We address this in Section [\ref=eurows] by incorporating prior knowledge on measurement error. We also choose a common correlation function across events. This choice gives stable θ estimates; see Section [\ref=discuss] for further discussion.

The conjugate prior form for (β,σ2) is normal inverse-gamma of the form

[formula]

where a, b, B and d are hyperparameters. Consider data on hazard events [formula]. Let [formula] where [formula] comprise Kj simulator output and measurement pairs at locations [formula] and [formula]. As no conjugate prior form for π(θ) exists, and θ is difficult to elicit, we set [formula] and choose θ to maximise its posterior distribution

[formula]

Hj is a Kj  ×  q matrix with kth row hT(xj(sk)), Σj is a Kj  ×  Kj matrix with (k,l)th element cX(xj(sk),xj(sl)) for [formula], Aj  =  Σj  +  λ2IKj, λ2  =  σ2Y  /  σ2X and B*j  =  (B- 1  +  HTjA- 1jHj)- 1.

Finally, we obtain an analytical expression for the probability distribution of the actual spatial field for event j at location s given simulated data X(s), which is given by

[formula]

Note that the exact form for relation [\eqref=approxtproc] is Student-t process on Kj - q degrees of freedom, which can be parameterised to have negligible difference from a Gaussian process with corresponding mean and covariance functions for large Kj  -  q. We will typically have large Kj  -  q; hence the form adopted in relation [\eqref=approxtproc].

Model checking

The model will be first checked using a semivariogram to compare model-based and empirical (semi)variances, ie. σ2c(x(sk),x(sk')) and var(y(sk),y(sk')). As multiple variables may be used to define c(  ,  ), this precludes conventional use of a semivariogram. For example, c(  ,  ) is not entirely spatial and nor is its spatial part isotropic. Details to enable semivariogram use are given in Appendix [\ref=emulatordiag]. The fitted model is also checked as a whole, using diagnostic tests developed for GP emulators; see [\cite=bas-ohag]. Appendix [\ref=emulatordiag] gives further details.

Extreme European windstorm footprints

In this section we derive posterior distributions of actual footprints for the 50 extreme European windstorms in the XWS windstorm catalogue [\cite=xwspaper].

Data

The footprint of a windstorm is based on maximum 3 second 10 metre wind gust speeds. For event j, [formula], where J = 50, at location s, it is the maximum gust speed attained over a 72-hour period centred on the event's occurrence time. The 50 European windstorms studied have been classed as 'extreme' based on their insured loss or meteorological characteristics, although often both coincide. Measurement data and simulated climate model output are both available. The simulated footprints are generated from ERA Interim re-analysis [\citep=erainterim] dynamically downscaled from a horizontal resolution of  [formula] to [formula] by the Met Office Unified Model [\citep=metum]. The footprints are given on a rotated grid. Figure [\ref=domain] shows the footprint boundary on original latitude-longitude scale, which is the domain studied here. Measurement data are daily maximum gust speeds taken from the NOAA Global Summary of the Day (GSOD) database, which have been supplemented with data from the BADC Midas database [\citep=midas].

Windstorm Daria (sometimes referred to as The Burns' Day Storm) is used as a case study. Daria reached its peak intensity on 25th January 1990 and had an insured loss estimated at $8.2bn (indexed to 2012 prices). Figure [\ref=daria1] shows Daria's simulated footprint on the rotated grid alongside GSOD measurements. Figure [\ref=daria2] shows measurements against wind gust speeds (bi-linearly interpolated) from the footprint, which will be referred to as 'interpolated gust speeds'. The interpolated gust speeds clearly do not match the measurements. It is difficult, however, to distinguish from Figure [\ref=daria1] regions where agreement is better or worse. The wind gust speeds in the simulated footprint tend to differ more from measurements exceeding 25ms[formula], and appear to asymptote near 30ms[formula], unlike the measurements. This general 'bias' in the relationship between the simulated and measured gust speeds is evidence of intensity discrepancy. Although causes of discrepancy in the simulated gust speeds are beyond the scope of this paper, note that discrepancy tends to be greatest for the highest gust speeds, which lead to most damage and loss.

Model specification

Losses very rarely occur if wind gust speeds are below 25ms[formula]. Consequently the model proposed in Section [\ref=prior-haz] is fitted only to measurement and simulation pairs where the simulated wind gust speeds exceed a threshold, denoted ums- 1. This allows for more accurate estimation of their relationship for high speeds, which are of greatest interest for loss estimation. Gust speed measurements are also sometimes not recorded if they fail to exceed a certain value; focussing only on high gust speeds helps avoid effects of such selection bias. We choose u = 15ms[formula], which is judged in part from the relationship between the measured and interpolated gust speeds in Figure [\ref=daria2]. This is below the 25ms- 1 usually needed for losses to occur.

Imposing the threshold means that we do not use the entire simulated footprint to derive the actual footprint. However, we present the actual footprint for the entire domain, because footprints tend to be simpler to grasp if shown for a complete region, grids are readily accommodated in many software packages, and the censored footprint--corresponding to where the simulated footprint is below the threshold--can be derived from the complete footprint. We choose the mean function for event j to be hT(x)βj, where hT(x)  =  (1,x,x2), with prior probability

[formula]

where b = (0,1,0)T and B = diag(0.1,1,1). Our prior is relatively informative only for the intercept term, and reflects our decision to impose a threshold. It is designed to counteract effects of missing measurements, which occur more frequently amongst lower gust speeds. For example, towards the beginning of the measurement period, often gust speeds were only recorded if they exceeded a threshold. The chosen prior and threshold overcomes issues associated with this sampling bias by letting the posterior mean of the actual footprint revert to the simulated footprint at lower gust speeds, which tend to be simulated more accurately, and tend not to be of importance for loss estimation.

The marginal model is summarised as

[formula]

where σ2j is the event-specific GP variance. Note that the Gaussian assumption applies to Yj(s)  -  hT(Xj(s)), thus to a difference that may be considered a residual. This assumption does not impose that wind gust speeds are non-negative. The model will be inappropriate if, given hT(Xj(s)), residuals frequently coincide with negative wind gust speeds. This is found not to be the case here.

The statistical model is defined on a transformed space: standard latitude-longitude coordinates are adjusted to the rotated grid on which distances between grid cells are more uniform; see Figure [\ref=domain]. Locations on the rotated grid, s*  =  (slon,slat)T, are then adjusted to a transformed space, with location s defined as s  =  (s1,s2)T  =  Ts*, where

[formula]

The unscaled covariance function, c(  ,  ) in relation [\eqref=margmod2] (see also equation [\eqref=corform] of Appendix [\ref=variogdiag]), is chosen have the form

[formula]

with Γ(  ) the gamma function, Kνk(  ) the modified Bessel function of the second kind, hk  =  |sk  -  sk'|, range and smoothness parameters φk and νk, k = 1,2, respectively, and

[formula]

with φX a further range parameter. Thus from relation [\eqref=margmod2] θ = (ω,λ2,φ1,φ2,ν1,ν2,φX). The choice of unscaled covariance function in equation [\eqref=corform2] follows from partitioning discrepancy into spatial and intensity parts. The spatial discrepancy is then separated into (transformed) longitude and latitude directions. In each direction a different Matérn form is assumed, which reflects prevailing directions of winds in windstorms. Non-zero ω allows directions non-parallel to the longitude and latitude axes, which, as the prevailing wind direction is approximately south westerly, should be anticipated. A Gaussian covariance form captures intensity discrepancy, as this is expected to be very smooth, which is the main motivation for its regular use in Gaussian process emulators.

The nugget, λ2, represents a nugget in cY(  ,  ), which captures measurement error, and a nugget in cX(  ,  ), which captures small-scale fluctuations in the actual footprint not captured by the spatially-aggregated simulated footprint. The posterior mode for λ is approximately 3.5ms- 1, which puts an upper bound on the measurement error's standard deviation. Consequently we set [formula]. This choice is intended to be fairly conservative, yet consistent with simple analysis of the measurements.

We fit the model by finding the posterior mode of π(θ  |  D) (equation [\eqref=postmode]) numerically.

Model checks

Semivariograms for the fitted marginal model are shown in Figure [\ref=variogs]. Good agreement between model-based and empirical estimates of dependence for each discrepancy type can be seen. The spatial dependence structure matches the Matérn form in both transformed directions, while the intensity discrepancy matches the Gaussian form. The bounds on the plots represent 95% error bounds, estimated from within-bin sampling variability, but do no take into account parametric uncertainty, which is likely to be comparatively small. As the empirical estimates fall well within the error bounds, this offers very good support for that fit of the marginal model, which relates measured wind gust speeds to those in the simulated footprint. This is confirmed by similar findings for the remaining 49 windstorms (not shown).

The validation plots of Figure [\ref=valid] use the procedures described in Appendix [\ref=emulatordiag] to check the model's assumptions simultaneously. 30 pairs of measured and simulated footprint wind gust speeds are withheld as validation data; the measurements are then compared against their predictive distributions, given the 30 simulated footprint gust speeds. The four plots of Figure [\ref=valid] support the predictions for windstorm Daria: the standardised residuals and pivoted Cholesky errors are consistent with their respective t distributions, and the Mahalanobis distance with the Fñ,nj  -  q distribution. These show the measurements to be consistent with their predictive distribution. Similar results are found for the remaining windstorms (not shown). Coupled with the semivariogram check, we conclude that there is good agreement between the statistical model and the validation data.

Posterior estimates of actual European windstorm footprints

The actual footprint for windstorm Daria is represented in Figure [\ref=recal] by its posterior mean and standard errors. The posterior mean gives plausible spatial structure for a windstorm footprint, preserving much of the structure in the original climate-model-simulated footprint. Uncertainty in the estimate of the actual footprint is smallest where most measurements are present and increases as measurements become fewer and more distant, which should be expected.

For windstorm Daria, the root mean squared error (RMSE) between the measured and interpolated gust speeds is 7.69ms- 1. This reduces to 4.80ms- 1 for the posterior mean of the actual footprint. This is supported by Figure [\ref=recal], which shows that posterior mean estimates for the actual footprint are closer to y = x line than the simulated wind gust speeds (from Figure [\ref=daria2]). The predictions for the 30 validation measurements are concentrated around the y = x line. (Note that these uncertainties are larger than for the actual footprint, as they also include measurement error.) The gust speeds in the posterior estimate of the actual footprint are consistently greater than those simulated by the MetUM climate model, which is reflected in the ratio of Figure [\ref=recal] exceeding one for most of the region studied. That the actual footprints better match the measurements than the simulated footprints is supported by considering posterior estimates of actual footprints for all 50 windstorms together when calculating the RMSE, which reduces from 5.39ms- 1 to 3.62ms- 1.

Discussion

We have presented a framework for deriving posterior distributions for actual values of spatial fields representing environmental processes from measurements and simulated data. The method readily incorporates the natural belief that the actual spatial field exhibits some degree of smoothness over space; capturing spatial dependence pools information across locations to give consistent spatial estimates. Gaussian processes are used to model two forms of discrepancy: spatial discrepancy, which is the spatial difference between the two fields; and intensity discrepancy, which is the systematic bias in intensity between simulated and actual values of the spatial process. The result of this model is that, given the measurements and simulated spatial fields, the posterior distribution of the actual spatial field has a closed-form Gaussian process representation, which gives a full characterisation of its uncertainty.

There has been little research into methods for estimating actual spatial fields. Our method may be thought of as an extension of the XWS recalibration method [\citep=xwspaper], which is based on a random effects regression model, that allows for spatial dependence and removes the constraint that the actual footprint is a function of the simulated footprint that is linear in some parameters. The desirable criterion that the relationship between the simulated and actual footprint may vary between windstorms is preserved. Our work could be classed as a post-processing method, which are seen more commonly in the forecast verification literature, with methods such as bias correction or recalibration; see [\cite=goddard] for details.

The biggest constraints in the proposed method are perhaps imposed by the Gaussian assumptions; these are present in the measurement error model, and the Gaussian process priors for the spatial and intensity discrepancy. Transformations to the measurements, the simulator output, or both, can be used to make the Gaussian assumptions less restrictive. The Box-Cox class of transformation may prove useful [\citep=boxcox]. There is also scope for improvement to the covariance structure. While the mean and variance of discrepancy between actual and simulated spatial fields have been allowed to vary between events, the correlation function has not. This decision helps give stable and reliable estimates of the correlation function. This constraint may not be necessary for applications to spatial processes with more measurements available. A more complex covariance function, in which distance between locations is separated into over-land and over-sea distances, may also benefit the modelling of windstorm events because a windstorm may slow down over land, due to drag, but speed up over sea, where drag is less; see, for example, [\citet=wallhobb]. Extensions to the GP's mean function, such as including a covariate representing distance to the coast, perhaps in the prevailing wind direction, may also bring a more accurate model for windstorms.

Much or our model's simplicity hinges on the marginal formulation of relation [\eqref=margmod] and conjugate priors. This allows all but the correlation function parameters to be integrated out. Although we have used an informative prior for β, there is scope for further prior information to be incorporated, in particular to relax the assumption that the measurements are unbiased. Without prior information, assuming linear forms for bias, for example, could cause identifiability problems with the intensity discrepancy. Here we do not have sufficient evidence to suggest bias in measurements.

Our proposed model has benefits for estimating financial loss. The posterior distribution of actual gust speeds can be derived for irregularly spread locations. Figure [\ref=postcode] shows an alternative posterior mean estimate for the actual footprint for Daria based on standard latitude-longitude scale for administrative areas; for the UK, for example, these correspond to postcode sectors, such as 'EX4 4**'. Note that sizes of administrative areas vary significantly within and between countries. The ability to derive and present footprints on such scales is convenient for the insurance industry for compatibility with exposure data, such as sums insured. This enables loss calculations to be based on actual wind gust speeds, while accounting for uncertainty in their values.

Finally, realisations of actual spatial fields can also be simulated using model [\eqref=approxtproc] to give synthetic 'event sets'. These can be constrained to a specified event's measurements and use to give alternative scenarios that are consistent with its measurements while having realistic spatial structure. Such scenarios are sometimes used in risk estimation.

Acknowledgements

We thank Phil Sansom for helpful discussion. We thank the Willis Research Network for supporting this work, the Met Office for providing the windstorm measurement data, and Julia Roberts for help with data provision.

Appendix to Section [\ref=mod-check]

Semi-variograms

Consider a general form for the correlation function, so that for s and s'

[formula]

where {wk(s)} are variables relating to location s. Define e(s)  =  y(s)  -  hT(s)β. For a given event var(e(s),e(s')) can be plotted against σ̂2jc(s,s') for all pairwise combinations of s and s'. Note that where there are multiple events, combinations across events are not considered, as independence is assumed between events.

To produce a more stable and informative comparison of var(e(s),e(s')) and c(s,s'), binning, as is common in the geostatistics literature, is used. Both var(e(s),e(s')) and c(s,s') are binned, according to bins defined by any variable wk(s), and then plotted against the bins defined by the chosen variable. This is a general and informative way of checking agreement between the model-based covariance structure and the dependence exhibited by observations on the natural hazard event.

Emulator diagnostics

These diagnostics summarise some of those presented in [\cite=bas-ohag]. For event j consider ñ validation points [formula] at locations [formula] with simulator output [formula]. Define matrix ṽ to have (k,l)th element σ̂2jc†(X(s̃k),X(s̃l)), for [formula] and the vector [formula], where

[formula]

These alternative GP mean and covariance functions account for the fact that the measurements that form the validation data are subject to measurement error, unlike the actual values. It follows from model [\eqref=margmod] that   ~  MVNñ(,ṽ).

Now define [formula] for [formula]. Test 1 is based on the approximate distributional result that ẽ(si)  ~  N(0,1); thus large ẽ(si) relative to the standard Gaussian distribution highlight model inadequacy. In the present case, plotting ẽ(si) against i or spatially against s̃i may help show regions in which the predictions are poor. Now consider the pivoted Cholesky decomposition of ṽ so that permutation matrix P and upper triangular matrix U satisfy PTṽP = UTU. Define G = PUT. Elements of the vector ePC = G- 1(  -  ), where [formula], are independent and approximately satisfy ePCi  ~  N(0,1). Test 2 is a quantile-quantile plot of these errors and Test 3 plots ePCi against i. Model inadequacy is indicated in Test 2 with points deviating from the line with intercept zero and unit slope, and in Test 3 with large or non-random values. Test 4 uses the Mahalanobis distance DMH  =  ẽTiẽi, for which DMH  ~  Fñ,n - q, the F-Snedecor distribution with degrees of freedom ñ and n  -  q. Large DMH relative to Fñ,n - q indicates model inadequacy.