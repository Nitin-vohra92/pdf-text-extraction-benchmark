On the computation of the marginal likelihood

Consider a Bayesian analysis in which observables [formula] are modeled conditionally, given that parameter Θ  =  θ, with density fX|Θ(    ·  |θ). Let π(    ·    ) denote the prior density of Θ. For data [formula], the marginal likelihood

[formula]

is a quantity commonly used in Bayesian model selection (see ref. [\cite=ohagan]) to assess the relative adequacy of the model with respect to a set of competing models of the same experiment.

If π(    ·  |x) > 0 is the posterior density of the parameter Θ derived from Bayes's theorem, rewriting the marginal likelihood as

[formula]

we can reinterpret it as the conditional expectation

[formula]

The difficulty with this conditional expectation is that, in general, we don't know the expression of the posterior density π(    ·  |x). But suppose that we have available an iid sample [formula] from the posterior distribution of Θ, obtained by any simulation method. With the help (see ref. [\cite=silverman]) of a pointwise consistent kernel density estimator π̂N(    ·  |x) of the posterior density, we get, by the Law of Large Numbers, a consistent estimator of the marginal likelihood. For the sample [formula], the estimate is

[formula]

As a simple example, let [formula] be conditionally independent and identically distributed, given that Θ  =  θ, such that X1 has distribution [formula]. Suppose that the variance σ2 is known. Then,

[formula]

in which [formula], and [formula]. If Θ has prior distribution [formula], a straightforward calculation using Bayes's theorem shows that the posterior distribution of Θ is

[formula]

and the marginal likelihood is

[formula]

Written in the free R programming language (see ref. [\cite=rproject]), the code presented in the Appendix uses the proposed estimator to numerically approximate the marginal likelihood of this model with data simulated from a normal distribution. For example, running the simulation with N = 1000 points sampled from the posterior, we find a numerical estimate log   ≈   - 66.67655 in good agreement with the theoretical value log fX(x)  ≈   - 66.67619.

Appendix: computer code