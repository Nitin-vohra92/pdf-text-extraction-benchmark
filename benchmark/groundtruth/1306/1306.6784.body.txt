Proposition Corollary Theorem Definition FactRemark Example Claim Proposition Corollary Observation

Palindromic closures using multiple antimorphisms

Introduction

Palindromic closure of a finite word w is the shortest palindrome having w as a prefix. This concept was introduced in 1997 by Aldo de Luca for words over the binary alphabet. In [\cite=Lu], De Luca showed that any standard Sturmian word is a limit of a sequence of palindromes (wn), where w0 equals the empty word and wn + 1 is the palindromic closure of wnδn + 1 for some letter δn + 1 from the binary alphabet. And, vice versa, the limit of such a sequence is always a standard Sturmian word. This construction was extended to any finite alphabet A by Droubay, Justin and Pirillo in [\cite=DrJuPi], and words arising by their construction are called standard episturmian words. The sequence [formula] of letters that are added successively at each step is referred to as the directive sequence of the standard episturmian word.

An important generalization of standard episturmian words appeared in [\cite=LuLu], where the palindromic closure is replaced by ϑ-palindromic closure with ϑ an arbitrary involutory antimorphism of the free monoid A*. The corresponding words are called ϑ-standard words, or pseudostandard words.

A further generalization was provided in 2008 by Michelangelo Bucci, Aldo de Luca, Alessandro De Luca, Luca Q. Zamboni in [\cite=BuLuLuZa2], where the sequence (wn) is allowed to start with an arbitrary finite word w0, and the limit word is a ϑ-standard word with the seed w0. Words obtained by these generalizations are in some sense quite similar to the standard episturmian words: by results of Bucci and De Luca [\cite=BuLu], any ϑ-standard word with a seed is a morphic image of a standard episturmian word.

The described constructions of (wn) guarantee that the language of a standard episturmian word contains infinitely many palindromes.

Droubay, Justin and Pirillo in [\cite=DrJuPi] deduced that any finite word w contains at most |w| + 1 distinct palindromes (|w| stands for the length of w). A word w with exactly |w| + 1 palindromes is called rich (in [\cite=GlJuWiZa]), or full (in [\cite=BrHaNiRe]). An infinite word is rich if every finite factor of this word is rich. Examples of rich words include all episturmian words, see [\cite=DrJuPi], two interval coding of rotations, see [\cite=BlBrLaVu11], words coding interval exchange transformation with symmetric permutation, see [\cite=BaMaPe], etc.

The notion of rich word was generalized as well: the concept of ϑ-rich word was introduced in [\cite=Sta2010]. A ϑ-rich word is saturated by ϑ-palindromes, fixed points of the involutory antimorphism ϑ, up to the highest possible level. Another generalization of the concept of richness is a measure of how many palindromes are missing in a certain sense. This quantity is called the palindromic defect and it was first considered in [\cite=BrHaNiRe]. Analogously to standard episturmian words, one can prove that every ϑ-standard word is ϑ-rich, and every standard word with seed has finite palindromic defect.

Again, both generalizations of rich words are not too far from the original notion. In particular, any uniformly recurrent ϑ-rich word and any uniformly recurrent word with finite defect is just a morphic image of a rich word, see [\cite=PeSta_Milano_IJFCS]. Nevertheless, the operation of palindromic closure enables us to construct a big class of rich words.

Up to this point, we were concerned with properties of words with respect to one fixed involutory antimorphism ϑ on A*.

In the last Section of the paper [\cite=LuLu], De Luca and de Luca introduced an even more general concept - generalized pseudostandard words. They considered a set I of involutory antimorphisms over A* and beside a directive sequence [formula] of letters from A, also a directive sequence of antimorphisms [formula] from I. The construction of (wn) starts with the empty word w0 and recursively, wn is the ϑn-palindromic closure of wn - 1δn.

Then De Luca and de Luca focused on the prominent Thue-Morse word [formula]. They showed that [formula] is a generalized pseudostandard word with the directive sequences [formula] and [formula], where R denotes the mirror image operator, and E the antimorphism which exchanges the letters 0  ↔  1.

The example of the Thue-Morse word illustrates that generalized pseudostandard words substantially differ from the previous notions where only one antimorphism is used. This is due to the fact that the Thue-Morse word is not a morphic image of a standard episturmian word as all ϑ-standard words are. This can be seen when comparing the factor complexities of a standard episturmian word, which is of the form an + b except for finitely many integers n (see [\cite=DrJuPi]), and the factor complexity of the Thue-Morse word (see [\cite=Br89] or [\cite=LuVa]).

The results of [\cite=BlPaTrVu] confirm that the notion of the generalized pseudostandard word is very fruitful. In particular, Blondin-Massé, Paquin, Tremblay, and Vuillon showed that any standard Rote word is a generalized pseudostandard word. Since the Rote words are defined over the binary alphabet, their directive sequences Θ contain antimorphisms R and E only.

In this article we focus on the so-called generalized Thue-Morse words. Given two integers b and m such that b  >  1 and m  >  1, we denote the generalized Thue-Morse word by [formula]. The alphabet of [formula] is [formula]. For a given integer base b, the number sb(n) denotes the digit sum of the expansion of number n in the base b. The word [formula] is defined

[formula]

In this notation the classical Thue-Morse word equals [formula]. As shown in [\cite=Sta2011], the language of [formula] is closed under a finite group containing m involutory antimorphisms. This group is isomorphic to the dihedral group I2(m). Our aim in this paper is to prove the following theorem:

The generalized Thue-Morse word [formula] is a generalized pseudostandard word if and only if   [formula]  or   b - 1  =  0 mod m.

Unlike the case of the standard words with seed, very little is known about the properties of generalized pseudostandard words. In the last section, we propose several questions the answering of which would bring a better understanding of the structure of such words.

Our motivation for the study of generalized pseudostandard words stems from a desire to find G-rich words recently introduced in [\cite=PeSta1]. Words that are rich in the original sense are G-rich with respect to G = {R,Id}. In [\cite=Sta2011], the last author showed that the words [formula] are I2(m)-rich. In particular, the classical Thue-Morse word is H-rich with H = {E,R,ER,Id}. Using the result of [\cite=BlBrLaVu11], one can also show that the Rote words are H-rich (for definition of the Rote words see [\cite=Rote]). These examples are almost all the examples of G-rich words we know for which the group G is not isomorphic to {R,Id}. We believe that generalized pseudostandard words can provide many other new examples.

Preliminaries

By A we denote a finite set of symbols usually called the alphabet. A finite word w over A is a string [formula] with wi∈A. For its length n we write |w|. The set of all finite words over A, including the empty word ε, together with the operation of concatenation of words, form the free monoid A*. A morphism of A* is a mapping φ:A*  →  A* satisfying φ(wv)  =  φ(w)φ(v) for all finite words w,v∈A*. A morphism is uniquely given by the images φ(a) of all letters a∈A. If, moreover, there exists a letter b∈A and a non-empty word w∈A* such that φ(b)  =  bw, then the morphism φ is called a substitution.

If a word w∈A* can be written as a concatenation w = uvz, then v is called a factor of w. If u is the empty word, then v is called a prefix of w; if z is the empty word, then v is called a suffix of w. If φ is a substitution, then for every [formula] the word φn(b) is a prefix of φn + 1(b).

An infinite word [formula] over A is a sequence [formula]. The set of all factors of [formula] is denoted by [formula] and referred to as the language of [formula]. The action of a morphism φ:A*  →  A* can be naturally extended to [formula] by [formula]. If [formula] for some infinite word [formula], then the word [formula] is a fixed point of the morphism φ. Every substitution φ has a fixed point, namely the infinite word which has prefix φn(b) for every n; this infinite word is denoted φ∞(b).

The Thue-Morse word [formula] is a fixed point of the substitution φTM which maps 0  ↦  φTM(0) = 01 and 1  ↦  φTM(1) = 10. The substitution has two fixed points: the Thue-Morse word [formula] and the word φ∞(1).

When manipulating a fixed point [formula] of a substitution φ, we will need the notion of an ancestor: We say that a word [formula] is a φ-ancestor of a word [formula] if the following three conditions are satisfied:

v is a factor of [formula],

v is not a factor of [formula],

v is not a factor of [formula].

Consider the Thue-Morse word

[formula]

The factor v = 010011 has an ancestor w  =  1101, since v is a factor of φTM(1101)  =  10100110, and w is neither a factor of φTM(101)  =  100110 nor a factor of φTM(110)  =  101001. In fact, w is the unique ancestor of 010011.

The factor v = 010 is a factor of φ(11) = 1010 and a factor of φ(00) = 0101. Thus v = 010 has two ancestors, namely 11 and 00.

Let us now define the key notion of this article. The mapping Ψ:A*  ↦  A* satisfying

[formula]

is an involutory antimorphism. Any antimorphism Ψ is determined by the images of the letters from A. The restriction of Ψ to the alphabet A is a permutation π on A with cycles of length 1 or 2 only.

A word w∈A* is a Ψ-palindrome if Ψ(w) = w. The notion pseudopalindrome is also used.

A Ψ-palindromic closure of a factor w∈A* is the shortest Ψ-palindrome having w as a prefix. The Ψ-palindromic closure of w is denoted by wΨ. If w  =  uq such that q is the longest Ψ-palindromic suffix of w, then

[formula]

There are two distinct involutory antimorphisms on the alphabet A  =  {0,1}: R, the mirror image, and E, the antimorphism exchanging letters, i.e., E(0) = 1 and E(1) = 0. Put u = 0110110. Then u is an R-palindrome, and thus uR  =  u. The word u is not an E-palindrome, since E(u) = E(0110110)  =  1001001  ≠  u. The E-palindromic closure of u is uE  =  011011001001 since the longest E-palindromic suffix of u is 10.

In [\cite=LuLu], de Luca and De Luca generalized the notion of standard words considering the set I of all involutory antimorphisms on A* instead of just one fixed antimorphism. We will denote by [formula] the set of all infinite sequences over I.

Let [formula] and [formula]. Denote

[formula]

The word

[formula]

is called a generalized pseudostandard word with the directive sequence of letters Δ and the directive sequence of antimorphisms Θ.

Let us stress that the definition of [formula] is correct as wn is a prefix of wn + 1 for any n.

Consider the directive sequence of letters Δ  =  0(101)ω and the directive sequence of antimorphisms Θ  =  (RE)ω. Then

w0  =  ε

w1  =  0R  =  0

w2  =  (01)E  =  01

w3  =  (010)R  =  010

w4  =  (0101)E  =  0101

w5  =  (01011)R  =  01011010

w6  =  (010110100)E  =  010110100101

w7  =  (0101101001011)R  =  0101101001011010

w8  =  (01011010010110101)E  =  010110100101101010010110100101

[formula]

The authors of [\cite=LuLu] proved that the famous Thue-Morse word [formula] is a generalized pseudostandard word with directive sequences

[formula]

The Generalized Thue-Morse words and their properties

In Introduction, we defined a generalized Thue-Morse word by [\eqref=DefThueMorse], i.e., its n-th letter is the digit sum of the expansion of n in base b taken modulo m. It can be shown that [formula] is a fixed point of the substitution φb,m over the alphabet [formula]:

[formula]

where letters are expressed modulo m. As already stated in [\cite=AlSh], [formula] is periodic if and only if b  =  1 mod m.

(Note about our subsequent notation: When dealing with letters from [formula], we will consider all operations modulo m. We will denote the relation x  =  y mod m by x  =  my, to ease the notation.)

The language of [formula] has many symmetries: denote by I2(m) the group generated by antimorphisms Ψx defined for every [formula] by

[formula]

This group - usually called the dihedral group of order 2m - contains m morphisms and m antimorphisms. As shown in [\cite=Sta2011], if w is a factor of [formula], then ν(w) is a factor of [formula] for every element ν of the group I2(m).

Let us list some properties of the generalized Thue-Morse word we will use later. They are not hard to observe. (See also [\cite=Sta2011].)

Properties of [formula]

Let b  ≠  m1. If [formula] is a factor of [formula] of length [formula], then there exists [formula] such that vj + 1  ≠  mvj + 1. Such index j will be called jump in v. It is important to note here that we always start indices from 0. Sometimes, when no confusion can occur, we will say that there is a jump between the letters vj and vj + 1.

If b  ≠  m1, then a factor v of length at least 2b + 1 has uniquely determined φ-ancestors.

If [formula] is a Ψ-palindrome and an index j is a jump in v, then also the index k - j is a jump in v.

Ψxφ  =  φΨx - b + 1 for every [formula].

For every Ψ∈I2(m) there exists a unique Ψ'∈I2(m) such that Ψφ  =  φΨ'.

If w  ≠  ε is a Ψ-palindrome for some Ψ∈I2(m), then for every antimorphism Ψ'∈I2(m) such that Ψ'  ≠  Ψ we have Ψ'(w)  ≠  w.

If Ψ  ≠  Ψ', then for every letter a∈, Ψ(a)  ≠  Ψ'(a).

Proof of Theorem [\ref=main]

Proof of Theorem [\ref=main] will be split into Propositions [\ref=JdeTo] and [\ref=NejdeTo].

Let [formula]. Denote

[formula]

If [formula] or b = 1 mod m, then the generalized pseudostandard word [formula] with directive sequences Δ and Θ equals [formula].

Axel Thue found the classical Thue-Morse word [formula] when he searched for infinite words without overlapping factors, i.e., words without factors of the form v  =  ws  =  pw such that |w|  >  |s|. The authors of [\cite=MaBrGlLa] showed that the generalized Thue-Morse word [formula] is overlap-free if and only if [formula]. It is worth to mention that the same condition appears in our characterization of non-periodic words [formula] which are the generalized pseudostandard words.

For parameters b = m = 2, Proposition [\ref=JdeTo] was shown in [\cite=LuLu]. The following example illustrates that the assumption [formula] is crucial for validity of Proposition [\ref=JdeTo].

Consider b = 4 and m = 2. On the alphabet [formula], we have Ψ0(k)  =  0 - k  =  k and Ψ1(k)  =  1 - k for any letter k. In the notation of Example [\ref=example1], it means Ψ0  =  R and Ψ1  =  E. Therefore the sequences Δ and Θ from Proposition [\ref=JdeTo] coincide with sequences Δ and Θ from Example [\ref=example2]. The generalized Thue-Morse word [formula] starts as

[formula]

Note that, using the notation from Definition [\ref=def:GPS], w8 is not a prefix of [formula] and thus the generalized pseudostandard word [formula] from Proposition [\ref=JdeTo] does not correspond to [formula].

Propositions [\ref=JdeTo] and [\ref=NejdeTo] rely on several technical lemmas. The first one settles the case for periodic Thue-Morse words.

Let b  =  m1. The word [formula] with the directive sequences Δ and Θ given in [\eqref=directive] equals [formula].

Let [formula] be the expansion of the number n in the base b. The assumption b  =  m1 implies bi  =  m1 for any [formula]. With respect to [\eqref=DefThueMorse], we can write

[formula]

Since [formula] equals [formula], we have showed that [formula]. Moreover, the sequence of antimorphisms Θ can be indexed by natural numbers as [formula] where Ψn  =  Ψx for n = mx. Clearly by [\eqref=antimorphism]

[formula]

Let the words wn have the meaning as in Definition [\ref=def:GPS]. We will show by induction that [formula] for any [formula]. We have w1  =  (0)Ψ0  =  0  =  Ψ0(0). Using definition of wn + 1 and [\eqref=periodic] we get

[formula]

This means that [formula], as desired.

We can now concentrate on the non-periodic Thue-Morse words, i.e., on the case b  ≠  m1, which will be treated using several lemmas.

If Ψ∈I2(m) is an antimorphism and p∈A* is a Ψ-palindrome such that φ(a1a2)a3 is a suffix of p for some letters a1,a2,a3∈A, then there exists a word w of length at least 2 and antimorphism Ψ'∈I2(m) such that

[formula]

Let [formula]. Since p has a suffix φ(a1a2)a3 of length 2b + 1, according to Property [\ref=prop1], p has a jump position. The jump position of p is either n - 1 or n - b - 1. As p is a Ψ-palindrome, the index 0 or b is a jump of p. It implies that a prefix of p is of the form a3'φ(a2'a1') for some letters a1',a2',a3'. Thus p  =  Ψ(a3)φ(w)a3 for some word w with [formula]. As p  =  Ψ(p), using Property [\ref=komutace2], we get φ(w)  =  Ψ(φ(w))  =  φΨ'(w). Since φ is injective, we have w  =  Ψ'(w).

Fix [formula] and [formula]. Put Ψ  =  Ψ(b - 1)n + k. The longest Ψ-palindromic suffix of the factor

[formula]

is   [formula] and thus

[formula]

First we show that [formula] is a Ψ-palindromic suffix of the factor v. It is easy to check that the last letter of φn(0) is the letter (b - 1)n. In our notation Ψ(k)  =  (b  -  1)n  +  k  -  k = (b - 1)n. Therefore Ψ(k) is the last letter of φn(0), and thus u is a suffix of v. To show that u is a Ψ-palindromic suffix, we need to show

[formula]

Using Property [\ref=komutace1], we get

[formula]

and thus [formula] for all i, including i = 0 and i = k.

Now we show by contradiction that u is the longest Ψ-palindromic suffix of v. Consider the minimal n for which the statement is false, i.e., the longest Ψ-palindromic suffix of v - denote it by p - is longer than u. Since [formula], the minimal n is [formula]. As |p|  >  |u|, p has a suffix u and we can apply Lemma [\ref=pomocne]. Therefore p has the form p  =  Ψ(k)φ(w)k, where w is a Ψ'-palindrome and φΨ'  =  Ψφ. According to Property 4, we have Ψ'  =  Ψ(b - 1)(n - 1) + k. In particular, Ψ'(k)wk is Ψ'-palindromic suffix of [formula].

As |p|  =  2 + |φ(w)| > |u|, necessarily [formula]. It means that [formula] has the longest Ψ'-palindromic suffix longer than [formula]  -  contradiction with the minimality of n.

Let v be a factor with the suffix [formula] and let b  ≠  m1. Put Ψ  =  Ψa + b. Under these assumptions, the longest Ψ-palindromic suffix p of the factor v is of length at least 2. Moreover, for |p| and the parameters a and b, the following holds:

if [formula], then p = Ψ(1)φ(w)1, where w is a Ψa + 1-palindrome of length at least 2;

if [formula], then a + b = m1 and b > m;

if |p| = 2, then either a + b  ≠  m1 or a + b  =  m1 with [formula].

Since the last two letters of v are (a + b  -  1)1, and Ψ(1)  =  a  +  b  -  1, the word v has a palindromic suffix of length 2.

If p itself has the suffix [formula], then the form of p is given by Lemma [\ref=pomocne] as p  =  Ψ(1)φ(w)1. According to Properties [\ref=komutace1] and [\ref=komutace2] in Section [\ref=T-M], we have Ψa + bφ  =  φΨa + 1 and thus w is a Ψa + 1-palindrome.

Let p be shorter than the suffix [formula]. It means that p is a suffix of the factor [formula] Since b - 1  ≠  m0, we have a jump between letters a + b - 2 and a. Let us discuss the following two cases separately:

i) If a + b  ≠  m1, then the other jump is between the last two letters a + b - 1 and 1. In the Ψ-palindrome, jump positions must be symmetric with respect to the center, and thus the only two candidates for the palindromic suffix are [formula] and (a + b - 1)1. Since Ψ(1)  =  Ψa + b(1)  ≠  ma + b - 2, only the latter possibility p = Ψ(1)1 occurs.

ii) If a + b = m1, then [formula] has only one jump, namely, as we mentioned above, between letters a + b - 2 and a. Therefore the longest palindromic suffix p does not contain any jumps. It implies, that p is a suffix of [formula]. Let [formula] be a letter such that [formula]. Then a + k  =  Ψ(1)  =  a + b - 1  =  m0. Or equivalently, k = mb - 1.

If [formula], the equality k = mb - 1 has the only solution k = b - 1, i.e., p = (a + b - 1)1  =  Ψ(1)1, as before.

If b > m, then the smallest [formula] solving k  =  mb - 1, satisfies [formula], and as well k  >  0 (since k  =  b - 1  ≠  m0). As [formula] has the length |p|  =  b - k + 1, we get [formula].

The following claim addresses the question of the length of the longest Ψ-palindromic suffix of the factor φn(0)1.

Let b  ≠  m1. Put [formula] and for a fixed [formula] denote Ψ  =  Ψ(b - 1)n + 1.

If [formula], then the longest Ψ-palindromic suffix of the factor φn(0)1 is of length 2.

If b > m and n < q, then the longest Ψ-palindromic suffix of the factor φn(0)1 is of length 2.

If b > m and n = q, then the longest Ψ-palindromic suffix of the factor φn(0)1 is of length greater than 2 and less than b + 1.

As b - 1  ≠  m0, we have [formula]. First we show that Claim holds for n = 0 and n = 1.

Consider n = 0. The factor 01 is a Ψ1-palindrome as Ψ1(0)  =  1.

Consider n = 1. The factor [formula] has only one jump, namely between two last letters b - 1 and 1 because of b - 1  ≠  m0. Thus φ(0)1 cannot have Ψ-palindromic suffix longer than 2. Since Ψ(b - 1)  =  Ψb(b - 1)  =  1, the factor φ(0)1 has the longest Ψ-palindromic suffix of length 2.

Now suppose that there exists an index n such that φn(0)1 has a Ψ-palindromic suffix of length at least 3. Consider the smallest such n. Obviously, [formula]. Denote by p the longest Ψ-palindromic suffix of φn(0)1. We will apply Lemma [\ref=konec1] with [formula]. Since the last letter of φn - 1(0) equals to (n - 1)(b - 1), we denote a = (n - 1)(b - 1). For this choice of a, the antimorphism Ψ  =  Ψ(b - 1)n + 1  =  Ψa + b is as required in Lemma [\ref=konec1]. Since [formula], only Cases 1 and 2 from Lemma [\ref=konec1] apply:

Case 1:    p = Ψ(1)φ(w)1  =  (a + b - 1)φ(w)1 for some factor w of length [formula] and w a Ψa + 1-palindrome.

Let us realize that φn(0)1 is a prefix of [formula] for any n and thus φn(0)φ(1) is its prefix as well. Since (a + b - 1) is the last letter of φ(a), we can deduce that φ(a)φ(w)φ(1) is a suffix of φn(0)φ(1) and thus aw1 is a suffix of φn - 1(0)1. Moreover, aw1 is a Ψa + 1-palindrome of length [formula]. This means that φn - 1(0)1 has a Ψ'-palindromic suffix of length greater than 2, where Ψ' = Ψa + 1  =  Ψ(n - 1)(b - 1) + 1. This is a contradiction with the minimality of n.

Case 2:   a + b = m1, b > m.

Since we denoted a = (n - 1)(b - 1), we have n(b - 1)  =  m0. The smallest n satisfying this equality was denoted by q.

We can conclude: If [formula] then for all n, the longest Ψ-palindromic suffix of φn(0)1has length 2; if b > m then for all n < q, the longest Ψ-palindromic suffix φn(0)1 has length 2; if b > m and n = q, then the longest Ψ-palindromic suffix φn(0)1 has length among numbers [formula].

Let b  ≠  m1. Denote [formula]. Fix [formula] and put Ψ  =  Ψ(b - 1)n + 1.

If [formula], then [formula].

If b > m and n  <  q, then [formula].

If b > m, then [formula] is not a prefix of [formula]

Let us denote by s the length of the longest Ψ-palindromic suffix of φn(0)1. We will apply Claim [\ref=claim2].

If s = 2, we clearly have [formula]. According to Property [\ref=komutace1], Ψφn  =  φnΨ1 and thus [formula].

Consider now [formula]. Then [formula] has length 2|φn(0)| + 2 - s. From the form of the substitution φ, and the fact that [formula] is its fixed point, it follows that a jump in [formula] can occur only on indices i - 1  =  b - 1. Since φn(0) is a prefix of [formula], the prefix of the palindrome [formula] with length |φn(0)|, has jumps on positions i - 1  =  b - 1. Jumps in any palindrome occur symmetrically with respect to the center of the palindrome. The length of the palindrome [formula] is (2 - s) mod b. As 2 - s  ≠  b0, jumps in the left part of [formula] are not compatible with the jump positions in [formula] and thus [formula] cannot be a prefix of [formula]

Now we are ready to complete the proof of Proposition [\ref=JdeTo] for the non-periodic Thue-Morse words.

From Lemma [\ref=konecN1], Part 1, we get the first identity in the following list; the others follow from Lemma [\ref=lemmaVic]:

Since [formula], this together with the simple fact

[formula]

finishes the proof of Proposition [\ref=JdeTo].

Let [formula]. If b > m and b  ≠  1 mod m, then [formula] is not a generalized pseudostandard word.

First, we show that a pseudopalindromic prefix of [formula] which is longer than b is an image of a shorter pseudopalindromic prefix of [formula].

Since the word [formula] has its first jump equal to b - 1, every its pseudopalindromic prefix p longer than b has a jump |p| - b. This implies that p  =  φ(p') for some prefix p'. Since Ψ(p)  =  p for some antimorphism Ψ∈I2(m), according to Property 5, we have Ψ(φ(p'))  =  φ(Ψ'(p'))  =  p  =  φ(p') for some antimorphism Ψ'∈I2(m). Since φ is injective, the last equality implies Ψ'(p')  =  p', and thus p' is a Ψ'-palindromic prefix.

One can see that for all n, φn(0) and φn(01) are pseudopalindromic prefixes. Next, we show that for each [formula], the only palindromic prefix of [formula] which is longer than |φn(0)| and shorter than 2|φn(0)|  +  2, is the prefix φn(0)φn(1).

This part of the proof will proceed by contradiction: Suppose that n is the minimal integer for which the claim does not hold. Clearly n  >  1, since the claim can be easily verified for n = 1. Using the fact that every pseudopalindromic prefix of [formula] is a φ-image of a shorter one, we can immediately see that even for n - 1 the statement does not hold, which is a contradiction with the minimality of n.

Since b  >  2, there is no pseudopalidromic prefix of length |φn(0)| - 1. For the lengths of the words wi from Definition [\ref=def:GPS], we have that [formula] for all i. Therefore, for each n, there exists an index i such that wi  =  φn(0) and wi + 1  =  φn(0)φn(1). Let Ψ be the antimorphism which fixes wi + 1, i.e., wi + 1  =  (wi1)Ψ. The lengths of wi and wi + 1 imply that the longest Ψ-palindromic suffix of wi1 is of length 2.

Since the last letter of φn(0) is the letter n(b - 1), the antimorphism Ψ satisfies Ψ(1)  =  n(b - 1) and thus Ψ  =  Ψn(b - 1)  +  1.

Set n  =  q where q is the order of (b - 1). It follows from Part 3 of Lemma [\ref=konecN1], that the Ψq(b - 1)  +  1-palindromic closure of wi1 is not a prefix of [formula].

Comments and open questions

As shown in Proposition [\ref=JdeTo], the word [formula] is a generalized pseudopalindromic word and its directive sequences are Δ  =  0(12)ω and [formula] . One can easily check that the pairs

[formula]

also correspond to the word [formula].

The authors of [\cite=BlPaTrVu] study this phenomenon for the generalized pseudopalindromic word on the binary alphabet, where [formula] and [formula]. They defined the notion of a normalized bisequence and showed (Theorem 27 in [\cite=BlPaTrVu]) that every pseudostandard word is generated by a unique normalized bisequence. Moreover, for any generalized pseudopalindromic word [formula], a simple algorithms which transforms the pair Δ, Θ into the normalized bisequence is given.

Question:   Is it possible to generalize the notion of a normalized bisequence for the case of a multi-literal alphabet?

It is well known the factor complexity of standard episturmian words is bounded by (  #  A - 1)n  +  1. In particular, on binary alphabet these words which are not periodic are precisely standard Sturmian words and their factor complexity is C(n) = n + 1.

In [\cite=BlPaTrVu], the authors conjectured that generalized pseudostandard words on binary alphabet have their factor complexity bounded by 4n  +    const.

The factor complexity of binary generalized Thue-Morse words can be found in [\cite=TrSh]. The word [formula] is periodic, and thus its factor complexity is bounded by a constant. The word [formula] is aperiodic and its factor complexity is [formula] for any parameter k. It means that even [formula] and [formula] (which are not generalized pseudopalindromic words) have a small complexity. It, of course, does not contradict the conjecture.

The factor complexity of generalized Thue-Morse words on any alphabet is deduced in [\cite=Sta2011]. If the word [formula] is aperiodic, then

[formula]

where q is the order of b - 1 in the additive group [formula], i.e. q is the minimal positive integer such that q(b - 1)  =  m0.

The factor complexity of any infinite word can be derived from knowledge of its bispecial factors. Each aperiodic standard episturmian word [formula] has a nice structure of its bispecial factors. (A factor w is bispecial if and only if w is a palindromic prefix of [formula].)

Question:   Is it possible to describe the structure of bispecial factors for a generalized pseudostandard word?

It is known [\cite=DrJuPi] that classical standard palindromic words with a periodic directive sequence [formula] are invariant under a substitution. For example, the Tribonacci word has the directive sequence Δ  =  (012)ω and simultaneously, it is a fixed point of the substitution φ:0  ↦  01,1  ↦  02,2  ↦  0.

Let us denote [formula] the generalized pseudostandard word with

[formula]

If [formula], then [formula] and obviously [formula] is invariant under the substitution described in [\eqref=substitution].

Question:   Is the word [formula] a fixed point of a substitution if b > m?

Acknowledgements

The second author acknowledges financial support from the Czech Science Foundation grant 13-03538S and the last author acknowledges financial support from the Czech Science Foundation grant 13-35273P.