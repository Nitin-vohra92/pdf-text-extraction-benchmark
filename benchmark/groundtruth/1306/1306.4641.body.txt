Hamiltonians representing equations of motion with damping due to friction

Introduction

The purpose of this document is to provide a Hamiltonian framework which gives rise to equations of motion that include friction or damping effects. The author has found a number of other works [\cite=bruneau] [\cite=chandrasekar] [\cite=froelich] [\cite=herrera] [\cite=koopman] [\cite=rabei] [\cite=riewe1] [\cite=riewe2] [\cite=smith] [\cite=yu] [\cite=zmoginov], but none of them seem to solve the problem in the manner presented here. The methods of this paper allow for extremely general formulas for the damping term, but the method is also artificial. Nevertheless we are able to extract various principles such as Nöther's Theorem.

Notation

We represent the position of a particle by q, which might be in a finite or infinite dimensional manifold M. (Everything in this document is formal, and there is no attempt at rigor.) As usual we have a Lagrangian [formula] which is strictly convex in the second coordinate. The equations of motion are the solution to the variational equation δS  =  0, where the action S is

[formula]

that is

[formula]

As usual, we create the Hamiltonian

[formula]

where p satisfies the equation

[formula]

It can then be shown that where in the latter formula one has to be aware that the first partial derivative is keeping [formula] constant, and the second partial derivative is keeping p constant. The equation of motion becomes

[formula]

The usual example is

[formula]

where A  =  A(q) is positive definite symmetric. Then and the equation of motion is

[formula]

The book [\cite=arnold] gives many more details.

Striving to understand friction

Here we describe a widely held view of how friction arises from reversible Hamiltonian dynamics. Our concrete equations of motion obtained in Sections [\ref=proof_of_concept] and [\ref=wave_equation] should conform to the framework described here.

Suppose the manifold M is a submanifold of M0  ×  M1, where where M0 represents the macroscopic motion, and M1 represents the microscopic motion. The position then splits as q  =  (q0,q1), and the momentum splits as p  =  p0  +  p1 in the obvious manner. Because M1 represents microscopic motion, it makes sense that M1 should have much higher dimension than M0, indeed we will often suppose that M1 is infinite dimensional. For example, maybe the microscopic motion is a large number of high frequency harmonic oscillators.

We assume that the Hamiltonian splits as

[formula]

Here H0 represents the macroscopic motion without friction. The second part, H1, is the energy of the microscopic motion plus coupling between the microscopic and macroscopic parts. We assume that all the interaction between the microscopic and macroscopic parts is via position and not momentum.

Because H1 does not depend upon p0, from equation [\eqref=dot_q_from_p] we obtain and the Lagrangian splits as

[formula]

where and equations [\eqref=p_from_dot_q] and [\eqref=Lq_=_-Hq] become (The only mildly non-obvious statements are equation [\eqref=L0q_=_-H0q] which follows from ∂L0  /  ∂q0  =    -  ∂H0  /  ∂q0 and ∂L0  /  ∂q1  =  ∂H0  /  ∂q1  =  0, and equation [\eqref=L1q_=_-H1q] which follows by subtraction.)

The equations of motion now become Now, if the microscopic motion starts at rest, then we hope that the second law of thermodynamics should be obeyed, and as a function of time, H0 should be non-increasing, and H1 should be non-decreasing. Thus the hope is that the motion described by q1 somehow provides a memory of what has happened to q0, so that we end up with

[formula]

for some function Φ. Then H0 satisfies

[formula]

If Φ satisfies a property like

[formula]

then we that H0 is non-increasing in time.

The case we can handle with our approach is to consider is

[formula]

where y  ↦  (x,y) is a strictly convex. Note that property [\eqref=Phi_prop] holds if (x,y) attains its minimum at y  =  0, because

[formula]

since the Hessian of (x,  ·  ) is positive definite.

The initial values of q1 and p1 should be very important, perhaps representing that the parts in M1 are at rest, or are oscillating in such a manner that the oscillations can only increase. This is because Hamiltonian equations are reversible in time. But dissipative systems should only be solvable forwards in time. The is sometimes known as the "arrow of time." For example, we know that if a wine glass is thrown to the ground, then it shatters. The reverse process, where the wine glass comes back together, is possible in theory if the initial positions and momenta of the molecules and atoms are given in a very precise manner (and we neglect the effects of quantum physics). But finding this initial data should be very difficult.

Friction via the wave equation: proof of concept

We will show how to artificially create damping via the wave equation. As a proof of concept, let us explain how to create a Hamiltonian such that for some positive definite matrix B.

An example of an infinite dimensional Hamiltonian is the wave equation on [formula], whose Hamiltonian is given by

[formula]

Here q' denotes ∂q  /  ∂s. Now the equation of motion coming from this Hamiltonian is

[formula]

which by d'Alembert's principle has a general solution

[formula]

This is a good example of a Hamiltonian for which Poincaré's recurrence theorem does not apply. And furthermore, the equations of motion are a point of variation of the Lagrangian, but are clearly not a minimum of the Lagrangian:

[formula]

The way we simulate friction is to consider the macroscopic motion as driving a wave equation on the half line. Let M1  =  C1(( -   ∞  ,0],M0), that is, the set of functions q:( -   ∞  ,0]  →  M0 such that q' is bounded, q'(s)  →  q'(0) as s  →  0-, where q'(0) denotes the left derivative of q(s) at s = 0, and q'(s)  →  0 as s  →    -    ∞  .

Then let

[formula]

with the Hamiltonian

[formula]

We see that the equation of motion is For example, to obtain equations [\eqref=dot_q0] and [\eqref=dot_q1], see that for any infinitesimal perturbation δq  =  (δq0,δq1) of q  =  (q0,q1), noting that δq0  =  δq1(0) and δq'1(s)  →  0 as s  →    -    ∞  , we have

[formula]

Next we impose initial conditions on (q1,p1)

[formula]

that is, the microscopic part of the motion is initially at rest. Then it can be seen that the solution to the wave equation is given by [\eqref=d'Alemb] with φ1(t)  =  q0(t) and φ2  =  0, that is

[formula]

In particular, we see that [formula], and hence we obtain equations [\eqref=q_f_m_B] and [\eqref=p_f_m_B].

Thus it is seen that the irreversibility of equations of motion with damping comes naturally from the special nature of the initial conditions. (And indeed any initial condition satisfying [formula] and q1(0,T0)  =  q0(T0) will work just as well.)

The general equation of motion with damping

Suppose that H̃, and its corresponding Lagrangian [formula], have the same domains as H0 and L0. Here [formula] is also called the Rayleigh dissipation function.

Consider the Hamiltonian on M  =  {(q0,q1)∈M0  ×  M1:q1(0)  =  q0} given by

[formula]

Note that the corresponding Lagrangian is

[formula]

The equations of motion for the Hamiltonian given by [\eqref=The_H] with initial conditions [\eqref=wave_init] imply

First, looking at the equations of motion for (q1,p1) we obtain where the last term of equation [\eqref=dot_ps] comes by integrating by parts, just as in the previous section.

From the definition of [formula], we see that equation [\eqref=dot_qs] is equivalent to

[formula]

and substituting into equation [\eqref=dot_ps] we obtain

[formula]

This is a wave equation, and since we have initial conditions [\eqref=wave_init], the solution [\eqref=wave_sol] is valid. (The general solution is not so obvious: if (x,y)  =  (x, - y), then φ1(s + t) and φ2(s - t) are both solutions to this equation. However it is not obvious to me how these two solutions should be combined, since this wave equation is non-linear.)

Next, the equations of motion for (q0,p0) become where the last term of equation [\eqref=xxx] from the cross term from integrating by parts. From equation [\eqref=wave_sol] we see that [formula]. Substituting this into equation [\eqref=xxx], and noting that q1(0)  =  q0, we obtain the desired result.

Finally, it is worth noting that under the initial conditions [\eqref=wave_init] the Hamiltonian and Lagrangian evaluate to In the case that [formula], the Hamiltonian becomes

[formula]

The arrow of time

Now that we have an explicit Hamiltonian that generates the equations of motion with friction, we should examine whether it satisfies the comments made at the end of Section [\ref=striving] on the "arrow if time."

One way to reverse the effect of friction would be to first solve the equation backwards in time, from t = T1 back to t = T0, using initial conditions q1(s,T1)  =  q0(T1), p1(s,T1)  =  0 for (s  ≤  0). Solve to find q1(s,T0), noting that it will satisfy [formula]. Then this is the initial data that is required to make the 'wine glass come back together.' Obviously not any initial data satisfying [formula] will work, because the wave has to feed back into the equations of motion for q0 exactly the energy it needs to satisfy the reverse effect of friction.

It would be interesting to see to what extent this equation is sensitive to the initial data, perhaps illustrating that it is very hard to get it exactly right to get the 'wine glass to reconstruct.' The idea would be to analyze the equations of motion for the full system on M, but either restricting to solutions in which [formula] (in which case the solutions should be stable), or to the case in which [formula] (in which case the solutions should be unstable -- this latter case requires (x,y)  =  (x, - y), otherwise the formulation of the problem would be harder). Almost surely one will find that in the latter case, the equation is linearly unstable, corresponding to the fact that the Hessian of (x,  ·  ) is positive definite.

Nöther's Theorem

By applying Nöther's Theorem to our Lagrangian, we can easily obtain a version of Nöther's Theorem that applies to dissipative systems. Suppose there is a flow on M0 that preserves both L0 and [formula], let us denote the parameter driving the flow by λ. Then the following quantity is conserved.

[formula]

Let us illustrate with a couple of examples of computing the momentum. Suppose that q0 is n vectors in [formula]: [formula]. Let μx be the momentum in the direction x

[formula]

which corresponds to the action

[formula]

Suppose that where vij  =  vji. This gives the equation of motion

[formula]

Both of these Lagrangians are invariant under the action [\eqref=action]. We see that

[formula]

is conserved, that is

[formula]

Now suppose we change equation [\eqref=friction] to

[formula]

where ηij  =  ηji, that is, all the damping effects are internal and depend completely on how the distances between the particles change. The equation of motion is now

[formula]

This Lagrangian is also invariant under the action [\eqref=action]. We see that

[formula]

Therefore π  =  μx, and thus the momentum μx is conserved.

Let's try a similar argument with angular momentum. Let αA be the angular momentum about the anti-symmetric matrix A

[formula]

which corresponds to the action

[formula]

Since eλA is an orthogonal matrix, all of the above Lagrangians are invariant under the action [\eqref=action]. For the case [\eqref=friction]

[formula]

is conserved, that is

[formula]

For the case [\eqref=friction2], we obtain

[formula]

and thus similarly αA is conserved.

(We should add that technically Lagrangian [\eqref=friction2] doesn't quite fit into our framework, because it is not strictly convex in [formula]. But this technicality is just that, and easily overcome. One can either redo all the work, or add [formula] to this Lagrangian and take the limit as ε  →  0.)

An identity

In this section we present an identity which we believe might be useful for creating conserved quantities. Suppose that equation [\eqref=wave] is satisfied. Let

[formula]

Then

[formula]

In the case that (x,y)  =  y  ·  B(x)  ·  y, so that [formula], there is a symmetry in the formulas so that we also have

[formula]

and hence both E and F satisfy the standard wave equation:

[formula]