Plünnecke's Inequality

Lemma Proposition Corollary

Conjecture Question Observation Example Claim

Introduction

Plünnecke's inequality is among the most commonly used tools in additive combinatorics. It was discovered by Helmut Plünnecke in the late 1960s. The inequality puts bounds on the magnification ratios of a directed, layered graph G, which are defined as:

[formula]

Plünnecke discovered that under some commutativity conditions on graphs, which have since been known as Plünnecke conditions and will be defined later, the sequence D1 / ii(G) is decreasing. The directed layered graphs that obey these conditions are called commutative (or Plünnecke) graphs. In particular Plünnecke proved [\cite=Plunnecke1970] the following.

Let G be a commutative graph with Dh(G)  =  Δh. Then Di(G)  ≥  Δi for all 1  ≤  i  ≤  h.

The main objective of the paper is to present a new proof of Theorem [\ref=Plunnecke].

Imre Ruzsa has simplified Plünnecke's proof in [\cite=Ruzsa1989] [\cite=Ruzsa1991]. Plünnecke's and Ruzsa's arguments have more similarities than differences as their backbone is the same. Ruzsa's simplified approach has become the standard way to prove the inequality and we will thus use it as the point of comparison with the present argument. The reader should bear in mind that the same could have been achieved for Plünnecke's proof.

Ruzsa's argument relies on two key ingredients: Menger's theorem [\cite=Menger] and Cartesian products of graphs. While there are several variations in the literature [\cite=Malouf1995] [\cite=Nathanson1996] [\cite=Ruzsa2009] [\cite=TaoNotes] [\cite=Tao-Vu2006] they all follow the original approach closely in first proving the special case when Dh(G) = 1 by applying Menger's theorem and then deducing the inequality by using Cartesian product of graphs. Here we present an elementary and more direct proof, which stays close to Plünneke's and Ruzsa's argument for the special case, but uses neither of the two ingredients.

Completing the proof with no reference to Menger's or any other equivalent theorem is noteworthy for two reasons. It shows that Plünnecke's inequality is a direct consequence of Plünnecke's conditions and little else. Therefore the bounds on the cardinality of sumsets that follow from it are also a direct consequence of commutativity of addition and little else. The second reason is that by avoiding Menger's theorem we are able to complete the proof without using Cartesian products of graphs. It was so far not clear whether this very helpful tool was a necessary ingredient and removing it makes the proof more transparent.

Despite its widespread use there has so far been no attempt to investigate whether Plünnecke's inequality is sharp. We answer this question for both finite and infinite commutative graphs.

For all [formula] and [formula] there exists a commutative graph with

[formula]

for all 1  ≤  i  ≤  h.

Let G be an infinite commutative graph. Then

[formula]

can hold if and only if C = 1.

The extremal graphs for Plünnecke's inequality we present are all regular. It is natural to ask whether this condition is necessary. The final result of this paper is to show that in a way it is: every commutative graph where Plünnecke's inequality is attained must contain a regular commutative subgraph - the exact meaning of this assertion is explained in Section [\ref=Inverse].

The remaining sections of the paper as organised as follows. In Section [\ref=Commutative_Graphs] we introduce commutative graphs and the notation used at the remainder of the paper. Section [\ref=Proof] is devoted to the proof of Plünnecke's inequality; an entirely self-contained argument is found in Sections [\ref=Weighted_Commutative_Graphs] and [\ref=Separating_Sets]. In Section [\ref=Regular] we prove Theorems [\ref=Sharp_Commutative_for_Finite] and [\ref=Sharp_Commutative_for_Infinite]. Finally in Section [\ref=Inverse] we deduce the existence of the regular subgraph in the case when all the quantities D1 / ii(G) are equal.

Commutative Graphs

The material in this section can be found in any of the standard references [\cite=Nathanson1996] [\cite=Ruzsa2009] [\cite=Tao-Vu2006]. The notation used is however slightly different.

Commutative graphs: definition and notation

G will always be a directed layered graph with edge set E(G) and vertex set [formula], where the Vi are the layers and h the level of the graph. For any S  ⊆  Vi we will write [formula] for the complement of S in Vi and not in V(G). We will furthermore assume that directed edges exist only between Vi and Vi + 1 and denote this set of edges by E(Vi,Vi + 1).

In order to introduce Plünnecke's conditions we briefly recall that given an integer k and a bipartite undirected graph G(X,Y) we say that a one-to-k matching exits from X to Y if we can find distinct elements {yix:x∈X    1  ≤  i  ≤  k} in Y such that xyix∈E(G) for all x∈X and 1  ≤  i  ≤  k. A one-to-one matching is referred to as a matching.

Plünnecke's upward condition states that if uv∈E(G), then there exists a matching from [formula] to [formula] (in the bipartite graph [formula] where xy is an undirected edge if and only if it is a directed edge in G). Plünnecke's downward condition states that if vw∈E(G), then then there exists a matching from [formula] to [formula] (in the bipartite graph [formula] where xy is an undirected edge if and only if it is a directed edge in G). A commutative graph is a directed layered graph that satisfies both properties. In the literature such graphs are sometimes referred to as Plünnecke graphs.

The most typical example is G+(A,B), the addition graph of two sets A and B in a commutative group. This is defined as the directed graph whose ith layer Vi is A + iB and a directed edge exists between x∈Vi - 1 and y∈Vi if and only if y - x∈B. When we take A = {0} and [formula] where 0 is the identity and γi the generators of a free commutative group we call [formula] the independent addition graph on n generators.

d+H(v) = |{w:vw∈E(H)}| is the outgoing degree of a vertex v in a subgraph H and d+(v) = d+G(v) is the outgoing degree of v in G. In particular d+H(v)  ≤  d+G(v). Similarly, d-H(v) = |{u:uv∈E(H)}| is the incoming degree of a vertex v in a subgraph H and d-(v) = d-G(v) is the incoming degree of v in G. In particular d-H(v)  ≤  d-G(v).

A path of length l in G is a sequence of vertices [formula] so that vivi + 1∈E(G) for all 1  ≤  i  ≤  l - 1. For a subgraph H of G and Z  ⊆  V(H) we thus define

[formula]

and

[formula]

When the subscript is omitted we are taking H to be G. When i = 1, and consequently [formula] is the neighbourhood of Z in H, the superscript will be omitted. We can now formally define magnification ratios. As we have seen the ith magnification ratio of G is defined as

[formula]

We will also write

[formula]

For X,Y  ⊆  V(G) the channel between X and Y is the subgraph that consists of directed paths starting at X and finishing in Y. For Z  ⊆  V0 the channel of Z is the channel between Z and Vh.

A separating set in any subgraph H is a set S  ⊆  V(H) that intersects all directed paths of maximum length in H.

Properties of commutative graphs

The following properties of commutative graphs are standard and will be used repeatedly.

(1) For i > j and X  ⊆  Vi, Y  ⊆  Vj the channel between X and Y is a commutative graph in its own right. An important special case is the channel of Z  ⊆  V0.

(2) For uv∈E(G) Plünnecke's conditions imply d+(u)  ≥  d+(v) and d-(u)  ≤  d-(v).

(3) For commutative graphs G and H we define their Cartesian product G  ×  H as follows. The ith layer of G  ×  H is the Cartesian product of the ith layer of G with the ith layer of H. As for the edges, (u,x)(v,y)∈E(G  ×  H) if and only if uv∈E(G) and xy∈E(H). G  ×  H is a commutative graph with Di(G  ×  H)  =  Di(G)  Di(H). Vertex degrees are also multiplicative as d±G  ×  H((u,x))  =  d±G(u)  d±H(x).

(4) We define the inverse I of a commutative graph G as follows: the ith layer of I is the (h - i + 1)th layer of G and uv∈E(I) if and only if vu∈E(G). One can informally think of I as the graph consisting of all paths from Vh to V0. I is always a commutative graph due to the symmetry of Plünnecke's conditions.

Hall's marriage theorem

We finish this introductory section by stating Hall's marriage theorem for bipartite graphs G = G(X,Y). For any x∈X we define its neighborhood by

[formula]

and the neighborhood of S  ⊆  X by

[formula]

It is clear that in order to have a one-to-k matching from X to Y we need |Γ(S)|  ≥  k  |S| for all S  ⊆  X. Philip Hall proved in 1935 that the converse is also true [\cite=Hall].

Let G(X,Y) be a bipartite graph. Then a one-to-k matching exists from X to Y if and only if

[formula]

Proof of Plünnecke's Inequality

We begin our examination of Plünnecke's inequality with a new proof of Theorem [\ref=Plunnecke]. The proof is inspired by the work of Ruzsa that appeared in [\cite=Ruzsa1989] [\cite=Ruzsa1991] and in particular by an exposition of Ruzsa's argument due to Terence Tao [\cite=TaoNotes]. However, there are crucial differences, as Menger's theorem and Cartesian products of graphs are not needed.

Outline of the Plünnecke-Ruzsa proof

The traditional proof of Theorem [\ref=Plunnecke] can be split in two distinct parts. The first is to establish the special case when Δ  =  1. The key is the relation between magnification ratios and separating sets in the graph. By applying Menger's theorem Plünnecke proved the following powerful result:

Let G be a commutative graph with Dh(G)  ≥  1. Then there are |V0| vertex disjoint paths from V0 to Vh in G and therefore Di(G)  ≥  1 for all i.

The duality between separating sets and vertex disjoint paths is exploited fully. This poses a serious obstacle when trying to extend this idea for general values of Δ as Menger's theorem is no longer useful. Even for integer Δ  ≠  1 there is an example which shows that proving the following natural and plausible generalisation

Suppose that Dh(G)  ≥  kh for some integer k. Then there are |V0| vertex disjoint trees each having at least ki vertices in Vi.

would require ideas beyond those found in this paper.

The second part of the proof is to overcome this obstacle by deducing the general case from Proposition [\ref=Ruzsa]. Ruzsa achieved this using the multiplicativity of magnification ratios. The quickest way to do this is by using some graphs we will introduce in Section [\ref=Regular] (c.f. Section [\ref=Regular]). For any rational q  ≤  Δ there is a commutative graph Rq with Di(Rq) = q- i for all [formula]. We know that Dh(G  ×  Rq)  =  Dh(G)  Dh(Rq)  =  (Δq- 1)h  ≥  1 and so

[formula]

This implies that Di(G)  ≥  qi for all rationals q  ≤  Δ and hence that Di(G)  ≥  Δi. For the reader's benefit we will note that the standard deduction uses independent addition graphs instead. In this context it is mandatory to take the product of r copies of G with suitably chosen independent addition graphs and then let r  →    ∞  .

Ruzsa's approach is elegant, but leaves one question unanswered: what is the precise role of Cartesian products in the proof and how does it allow us to use Proposition [\ref=Ruzsa] in such a simple way when proving a generalisation is tricky? A simpleminded approach is to see what the existence of the paths in G  ×  Rq implies about G, but this yields a mere reformulation of Plünnecke's inequality. A more refined approach suggested by Tim Gowers is to work in a weighted version of G. In this setting Menger's theorem could be replaced by the Max Flow - Min Cut theorem.

In fact Theorem [\ref=Plunnecke] will be proved by focusing on the minimum cut in (the network generated by) G without using any properties of a maximal flow. In doing so we will mirror Plünnecke's proof of Proposition [\ref=Ruzsa] closely, but will introduce a further ingredient in Section [\ref=Separating_Sets] that allows us to apply his argument to all Δ.

Weighted Commutative Graphs

The proof of Proposition [\ref=Ruzsa] is built around the fact that when Δ = 1 there is a very natural relation between separating sets in G and magnification ratios. In order to make use of this observation for general Δ we need to work with weighted commutative graphs; i.e. a commutative graph with a weight function

[formula]

We will eventually give every vertex in Vi weight Δ- i. The reasons behind this choice will become apparent shortly, but different weights may be more suitable in other applications. It should be noted that this can be thought of as an alternative to taking a Cartesian product of G with the Rq. We also need a notion of the weight of a set of vertices in G and so we define the weight of any set S  ⊆  V(G) as

[formula]

In what follows this will equal

[formula]

for a positive constant C. The heart of the proof of Proposition [\ref=Ruzsa] is to "pull down" any minimum separating set to one that lies entirely in [formula]. Plünnecke achieved this by applying Plünnecke's conditions to the paths given by Menger's theorem. The same can be done for weighted commutative graphs and in fact without any reference to Menger's or some other equivalent theorem. The following result demonstrates how powerful Plünnecke's conditions are.

Let C be a positive real and G a weighted commutative graph with vertex set [formula] and w(v) = C- i for all v∈Vi. A separating set of minimum weight that lies entirely in [formula] exists.

Proving this lemma will be the main objective of the next subsection. For the time being let us quickly see how to deduce Theorem [\ref=Plunnecke] from it.

Let G a weighted commutative graph with vertex set [formula] and w(v) = Δ- i  =  Dh(G)- i / h for all v∈Vi. The weight of any minimal separating set is |V0|.

By applying Lemma [\ref=Pull_Down] we can assume that [formula] is a separating set of minimum weight with Si  ⊆  Vi. We know that [formula] and so [formula]. This in turn implies w(S) = w(S0)  +  w(Sh)  =  |S0|  +  |Sh|  D- 1h(G)  ≥  |S0| + |Sc0|  =  |V0|. On the other hand V0 is a separating set and hence w(S) = |V0| for any separating set of minimum weight.

Plünnecke's inequality follows in a straightforward manner:

We consider any Z  ⊆  V0 in the weighted version of G, where each v∈Vi has weight Δ- i. [formula] is a separating set and thus

[formula]

I.e. [formula]. Taking the minimum over all Z  ⊆  V0 gives the lower bound on Di(G).

Separating sets on weighted commutative graphs

We now turn to the proof of Lemma [\ref=Pull_Down]. The key is to make optimal use of separating sets of minimal weight. Instead of using vertex disjoint paths we rely on the following elementary observation. Suppose that S is a separating set of minimum weight. Then for any Z  ⊆  S

[formula]

We begin with establishing the simplest case of Lemma [\ref=Pull_Down] when h = 2 and the middle layer is the separating set. We will need to apply the following in the coming section and therefore state it in slightly more general terms.

Let C be a positive real and H be a commutative graph of level two with vertex set [formula]. Suppose that for all S  ⊆  U1

[formula]

If Xi is the set of vertices in U1 that have incoming degree equal to i and Yi is set of vertices in U2 that have incoming degree equal to i, then

[formula]

Similarly if [formula] is the set of vertices in U1 that have outgoing degree equal to i and [formula] is the set of vertices in U0 that have outgoing degree equal to i, then

[formula]

The sets Xi form a partition of U1. We partition U2 into:

[formula] [formula] [formula] [formula]

Similarly we have a partition of U1 into [formula] and a partition of U0 into:

[formula] [formula] [formula] [formula]

This is probably a good moment for the reader to look at Figure [\ref=Figure_of_Technical_Lemma].

By the definition of the Ti we have that

[formula]

If we let xi  =  |Xi| and ti  =  |Ti|, then the hypothesis on H implies that

[formula]

Adding these inequalities for [formula] gives

[formula]

It follows from Plünnecke's downward condition and the definition of Ti and Xi that d-(v)  ≥  i for all v∈Ti. Hence

[formula]

We repeat the above calculation this time using the second partition of U1 and get

[formula]

Putting everything together yields:

[formula]

We must therefore have equality in every step, which implies that Yi = Ti and [formula], as well as C|Xi| = |Yi| and [formula].

We now apply the lemma to "pull down" minimal separating sets in the special, yet important, class of graphs of level two discussed in the beginning of the subsection.

Let C be a positive real and H be a weighted commutative graph of level two with vertex set [formula] and w(v) = C- i for all v∈Vi. Suppose that U1 is a separating set of minimum weight. Then so is U0.

For every S  ⊆  U1 both [formula] and [formula] are separating sets. The minimality of w(U1) implies that

[formula]

We can therefore apply Lemma [\ref=Technical_Three_Layer_Pull_Down] to get

[formula]

We are finally able to prove Lemma [\ref=Pull_Down], which will finish the proof of Theorem [\ref=Plunnecke].

Let S be any separating set of minimum weight and [formula]. Let [formula] be maximal subject to [formula]. We will show that when j > 0 we can find another separating set of minimum weight that lies in [formula].

We work in a subgraph H of level two consisting of all paths in G that start in a suitably chosen U0  ⊆  Vj - 1 and end in a suitably chosen U2  ⊆  Vj + 1. U0 consists of all vertices in Vj - 1 that can be reached via paths in G that successively pass from [formula] and U2 consists of all vertices in Vj + 1 that lead to Sch. S is a separating set of minimal weight and thus the middle layer U1 equals Sj. In the weighted version of H, where vertices in Ui have weight C- i, U1 is a separating set of minimum weight (if not let [formula] be a separating set of smaller weight and observe that [formula] is then a separating set in G of smaller weight than S). By Lemma [\ref=Three_Layer_Pull_Down] U0 is also a separating set of minimum weight in H and thus [formula] is a separating set of minimum weight in G.

Looking back at the proof of Plünnecke's inequality we realise that Plünnecke's conditions were not used directly. Instead we relied on two properties that follow from them: properties (1) and (2) in Section [\ref=Commutative_Graphs]. It is clear that both are necessary in the proof. It is therefore natural to ask how different this pair of conditions is compared to Plünnecke's.

Ruzsa has already noted in [\cite=Ruzsa2009] that the two sets of conditions are equivalent and as a consequence the proof of Plünnecke's inequality requires the full strength of Plünnecke's conditions. This observation was left as an exercise and so we offer a quick explanation. Suppose that Plünnecke's, say upward, condition fails for an edge uv. It follows that there is no matching from [formula] to [formula] in the bipartite graph [formula] where xy is an edge if and only if yx is an edge in G. By Lemma [\ref=Hall] we know there exists [formula] such that [formula]. Now consider the channel H between u and S. This is a commutative graph and uv∈E(H), yet [formula].

Before moving on we prove a slight variation of Lemma [\ref=Technical_Three_Layer_Pull_Down], which will be useful in Section [\ref=Inverse].

Let C be a positive real and H be a commutative graph of level two with vertex set [formula]. Suppose that for all S  ⊆  U1 we have

[formula]

Then |U1| = C|U0|.

This is almost identical to what we have already seen. We partition U1 and U0 into respectively [formula] and [formula] like in the proof of Lemma [\ref=Technical_Three_Layer_Pull_Down]. We have

[formula]

If we once again let [formula] and [formula], then the first hypothesis on H implies that

[formula]

Adding the [formula] inequalities gives

[formula]

From Plünnecke's upward condition we know that d+(v)  ≥  i for all [formula] and in a similar fashion to the proof of Lemma [\ref=Technical_Three_Layer_Pull_Down] we get

[formula]

The second condition on H implies that equality must hold in every step. In particular setting j = 1 on [\eqref=Partial_Sum_Prime] gives

[formula]

Regular Commutative Graphs

We now turn to investigating the sharpness of Plünnecke's inequality and prove Theorems [\ref=Sharp_Commutative_for_Finite] and [\ref=Sharp_Commutative_for_Infinite]. For the former we construct arbitrarily long commutative graphs where D1 / ii(G) is constant. The latter will be proved by examining the growth of commutative graphs that originate at a singleton.

Regular commutative graphs

The two theorems are closely related with the existence of regular commutative graphs.

Let [formula]. RC is a regular commutative graph of ratio C whenever d-(v) = d and d+(v) = Cd for all v∈V(G) and some [formula].

It is easy to see why they are important in this context.

Let [formula] and i  ≤  h be positive integers. Suppose that G is a regular commutative graph of ratio C with vertex set [formula]. Then

[formula]

and

[formula]

Furthermore the inverse of G is an RC- 1.

Suppose that d- = d and d+ = Cd for all vertices of the graph. There are Cd|Z| edges coming out from every Z  ⊆  V0. These edges land in at least C|Z| vertices in V1 and hence we get that [formula] - and consequently that D1(G)  ≥  C. Looking at [formula] we see that [formula] - and consequently that Di(G)  ≥  Ci. Next we count the edges between Vi - 1 and Vi in two different ways to get

[formula]

Hence |Vi|  =  Ci|V0|, which shows that Di(G)  ≤  Ci.

We know that the inverse of G is a commutative graph. It is furthermore regular with ratio C- 1.

To prove Theorem [\ref=Sharp_Commutative_for_Finite] it is therefore enough to construct arbitrarily long RC for all [formula]. Let us begin by two simple yet fundamental observations. It is enough to construct arbitrarily long Rk for all positive integers k because if we let C = p / q be any rational, then the Cartesian product of an Rp with the inverse of an Rq is an RC. A path is an infinite R1 so from now on we will focus on Rk for integer k > 1.

Arbitrarily long regular commutative graphs

We begin with the explicit construction of arbitrarily long Rk. Getting an Rk of level two is not hard, but we will not present the simplest example as it cannot be extended to an Rk of level three. We will instead inductively build arbitrarily long Rk. Our aim is to take an Rk of level h and add a layer from below in such as a way as to get an Rk of level h + 1. To achieve this we have to tweak the Rk of level h slightly by taking its Cartesian product with a suitably chosen commutative graph. The following graph has the desired properties.

Let k and h be positive integers. There exists an R1 of level h that gives rise to a one-to-k matching from the image of any v∈U0 to U0 itself. U0 is the bottom layer of the graph.

We work in [formula] and consider the level h addition graph G+(A,B) for [formula] and

[formula]

This is an R1. We define a map θ from the image of any v∈U0 to Uk0 by:

[formula]

A routine check confirms that every element of θ(v + j) is indeed joined to v + j in the graph. For example, v + 1 is joined to v + 1 as it equals v + 1 - 0 and v - k is joined to v + k as it equals v + k - 2k. A second routine check confirms that [formula] for all v∈U0 and distinct [formula]. In other words the graph yields a one-to-k matching between the image of any v∈U0 and U0 itself, as claimed.

We can now complete the inductive step by combining the above with Lemma [\ref=Hall] and the multiplicativity of degrees.

Suppose that an Rk of level h exists with the property that every vertex in the first layer is joined to every vertex in the second layer. Then an Rk of level h + 1 with the same property exists.

Suppose that [formula] are the layers of Rk with |W0| = d. The defining properties of Rk imply that d- = d and d+  =  dk. Let R1 be the graph described in Lemma [\ref=One_to_k_map] with layers [formula].

We let Gh  =  Rk  ×  R1. This graph is a regular commutative graph of ratio k whose bottom layer has size |W0  ×  U0| = 2dk2. Next we add a layer of size 2dk to the bottom and join every added vertex to the whole of W0  ×  U0. Let Gh + 1 be the resulting graph of level h + 1, which is regular with incoming degree 2dk and outgoing 2dk2. To complete the proof we show that Gh + 1 is a commutative graph.

We only need to check Plünnecke's conditions involving the recently added bottom layer. The remaining layers pose no problem as they belong to Gh, which is commutative. The downward is immediate as the size of the bottom layer equals the incoming degree. To check the upward we consider an edge u(w,v), where u lies in the bottom layer of Gh + 1 and (w,v) lies in the second layer; i.e. w∈W0 and v∈U0. Plünnecke's condition requires finding a matching from [formula] to [formula].

With this in mind we turn our attention to the bipartite graph [formula] and aim to apply Lemma [\ref=Hall]. We keep the same notation as in Chapter [\ref=Commutative_Graphs] and write Γ(x) for the neighborhood of x in the bipartite graph, which is precisely [formula]. Let π2 be the projection onto R1. For any [formula] we have from Lemma [\ref=One_to_k_map]

[formula]

Hence Hall's condition is satisfied and as a consequence so is Plünnecke's.

We construct arbitrarily long Rk (and hence finish the proof of Theorem [\ref=Sharp_Commutative_for_Finite]) as follows. We start with the two layer (and hence non-commutative) graph consisting of a single vertex in V0 joined to all k vertices in V1. A first application of Proposition [\ref=Multilayer_Extension] yields an Rk of level two. Repeated applications yield an arbitrarily long Rk.

In light of Theorem [\ref=Sharp_Commutative_for_Infinite] it should be noted that this construction does not lead to infinite regular commutative graphs as in each step the size of the bottom layer increases.

Infinite regular commutative graphs

The construction of arbitrarily long regular commutative graphs we have presented does not give infinite regular commutative graphs. This doesn't of course rule out their existence. In order to prove Theorem [\ref=Sharp_Commutative_for_Infinite] we will examine how much a Plünnecke graph originating at a singleton can grow. Plünnecke's inequality gives |Vh|  ≤  |V1|h, but the growth is in fact far from exponential.

Let G be an infinite commutative graph where |V0| = 1 and |V1| = n. Then

[formula]

The bound is best possible.

We perform a double induction on n and h. Let A(n,h) be the maximum of |Vh| taken over all commutative graphs with |V0| = 1 and |V1| = n. Take such a G with V0  =  {u} and [formula]. Any element of Vh can either be reached from a path passing from v1 or exclusively via paths that pass from [formula]. In the former case the vertex lies in the commutative graph consisting of all paths that start in v1. By Plünnecke's upward condition the second layer of this graph has at most n elements and so there are at most A(n,h - 1) such vertices in Vh. In the later case the vertex lies in the commutative graph consisting of all paths that start in u and end in [formula]. The second layer of this graph is a subset of [formula] and hence there are at most A(n - 1,h) such vertices in Vh. We have therefore proved that

[formula]

It follows from Plünnecke's condition that [formula] for all h and we know that [formula]. The stated bound follows inductively from the well known identity [formula] and is attained when G is an independent addition graph on n generators.

Deducing Theorem [\ref=Sharp_Commutative_for_Infinite] is straightforward.

A path is an infinite commutative graph whose magnification ratios are all equal to one.

Let [formula] and G be a commutative graph where Di(G) = Ci for all i. We have to show that G is finite.

When C < 1 we let V0 be the bottom layer of G. The definition of magnification ratios implies that there exists [formula] such that [formula]. The quantity Ci|Zi| is a non-zero integer less than Ci|V0| and so i cannot be arbitrarily large. When C > 1 we let V1 be the second layer of G. Lemma [\ref=Growth_m=1] implies that

[formula]

which for large enough i is less than Ci.

Inverse Theorem for Plünnecke's Inequality

We conclude the paper by establishing a necessary condition for Plünnecke's inequality to be attained. Let us first recall a definition from Section [\ref=Commutative_Graphs].

Let Z  ⊆  V0. The channel of Z is the commutative subgraph which consists of all paths of maximum length that start in Z.

We use some of the results in Section [\ref=Proof] to prove an inverse result for Theorem [\ref=Plunnecke].

Let [formula] and G be a commutative graph with Di(G) = Ci for all i. Then exists [formula] whose channel is a regular commutative graph of ratio C.

Inverse theorem for Plünnecke's inequality

The first step in proving Theorem [\ref=Inverse_Theorem_for_Plunnecke_Inequality] is to identify Z. It turns out that choosing the smallest non-empty subset of V0 that has a chance of working will do. We will later need the cardinalities of the various layers of the channel of such a Z.

Let [formula] and suppose G is a commutative graph with Di(G) = Ci for all 1  ≤  i  ≤  h. Let [formula] be of minimal size subject to [formula] and H be the channel of Z with vertex set [formula]. Then |Ui| = Ci|U0| for all 1  ≤  i  ≤  h.

For any S  ⊆  Z = U0 we have that [formula] so we will drop the subscript. Observe that D1(H) = C. We use this to show that Di(H) = Ci for all i. Indeed

[formula]

the first inequality following from the definition of magnification ratios, while the second from Theorem [\ref=Plunnecke]. Hence [formula] for some S  ⊂  U0. [formula] is a separating set in the weighted version of H, where as usual w(v) = C- i for all v∈Ui. By Corollary [\ref=Min_Weight] we know that

[formula]

Thus [formula]. The minimality of Z implies that S = Z = U0.

We proceed with the proof of Theorem [\ref=Inverse_Theorem_for_Plunnecke_Inequality]. We will use Lemma [\ref=Technical_Three_Layer_Pull_Down] on page repeatedly to show that H has to in fact be regular.

Similarly to above we let [formula] be of minimal size subject to [formula]. Our goal is to prove that its channel H is a regular commutative graph of ratio C. We will not have to work in G any further so to keep the notation simple we will write [formula] and [formula] instead of [formula] and [formula]. Note however that in general [formula].

We want to apply Lemma [\ref=Technical_Three_Layer_Pull_Down] so we let [formula] be the vertex set of H with the usual weights w(v) = C- i for all v∈Ui. We partition U1 into [formula] (where [formula]) and [formula] (where [formula]). We also partition U0 and U2 respectively into [formula] (where [formula]) and [formula] (where [formula]). To check that the condition of Lemma [\ref=Technical_Three_Layer_Pull_Down] is satisfied we observe that U1, which by Lemma [\ref=Cardinality_of_Z_i] has weight |U0|, is by Corollary [\ref=Min_Weight] a separating set of minimum weight. For every S  ⊆  U1 both [formula] and [formula] are separating sets. The minimality of w(U1) implies that

[formula]

Our first task will be to establish that [formula] and that the outgoing degree in [formula] is [formula]. Suppose not. Then

[formula]

is both non-empty and not the whole of U0. By the minimality of Z

[formula]

On the other hand by Lemma [\ref=Technical_Three_Layer_Pull_Down] we know that

[formula]

So [formula] and by Lemma [\ref=Technical_Three_Layer_Pull_Down] [formula], so [formula] and [formula].

Next we establish that Xk = U1 and that the incoming degree in [formula] is k. Let j be minimal subject to [formula]. Let R be the channel between Z = U0 and Yj.

We observe that [formula]. This holds as by Plünnecke's downward condition

[formula]

The choice of j implies that [formula], for i < j. By Lemma [\ref=Technical_Three_Layer_Pull_Down] we have |Xi| = C- 1|Yi| = 0 for all i < j. Thus [formula] as claimed.

Thus [formula], R1  =  Xj and R2 = Yj are the layers of R. We will apply Lemma [\ref=Technical_Three_Layer_Pull_Down_Prime] on page to R and so we need to check that the two conditions are satisfied. We begin with the second. We have d-R(v) = d-H(v) = j for all v∈R and by Lemma [\ref=Technical_Three_Layer_Pull_Down] that |R2| = |Yj|  =  C|Xj|  =  C|R1|. Thus

[formula]

For the first we observe that [formula] for all v∈R. We have seen above that U1 is a separating set in H of minimum weight and so we have that [formula] for all S  ⊆  R1. We can now apply Lemma [\ref=Technical_Three_Layer_Pull_Down_Prime] to get:

[formula]

On the other hand we know that [formula] and so if [formula], the minimality of Z implies

[formula]

i.e. that C|R0| > |R1|, which contradicts ([\ref=Size_of_Downward_Graph]). We must therefore have R0 = U0. Hence |Xj| = |R1| = C|R0| = C|U0| = |U1|, i.e. Xj = U1 = Xk and so |Yj| = C|Xj| = |U2|, i.e. Yj = U2 = Yk. In particular [formula].

We therefore have regularity in the bottom three layers. We must check that the ratio of [formula] to k is C. This follows from counting the edges between U0 and U1 in two ways:

[formula]

The final step is to establish regularity for the remaining layers of G. We consider any w∈U2. [formula] and so

[formula]

The fact that |U2| = C|U1| follows from by Lemma [\ref=Cardinality_of_Z_i]. Similarly d-(x)  ≥  k for any x∈U3 and so

[formula]

We must therefore have equality in each step and therefore d+(w) = Ck for all w∈U2 and d-(x) = k for all x∈U3. We repeat this step for all remaining layers to finish off the proof.

An alternative way to prove Theorem [\ref=Inverse_Theorem_for_Plunnecke_Inequality] is to first establish the special case when C = 1 using Proposition [\ref=Ruzsa] and then deduce the general case by the multiplicativity of magnification ratios and degrees. This time independent addition graphs cannot work and we need to use regular commutative graphs.

Proposition [\ref=Ruzsa] gives a sensible looking necessary and sufficient condition for all magnification ratios of a commutative graph to equal one.

Let G be a commutative graph and V0 be its bottom layer. Di(G) = 1 for all i if and only if there exist |V0| vertex disjoint paths of maximum length in G and the channel of some [formula] is an R1.

When Di(G) = 1 for all i we know from Proposition [\ref=Ruzsa] that there are |V0| vertex disjoint paths of maximum length in G and just proved the existence of a suitable non-empty Z  ⊆  V0. Conversely the existence of the vertex disjoint paths of maximum length guarantees that Di(G)  ≥  1 for all i and Lemma [\ref=Cardinality_of_Z_i] guarantees that [formula] and hence Di(G)  ≤  1.

Not a whole lot more can be said about the structure of such G. It is clear that the channel of Zc must have magnification ratios no smaller than one and that is about it. For example take any commutative graph G of level two with vertex set [formula] and Di(G)  ≥  1 and any regular commutative graph R with ratio one and vertex set [formula]. Form a new graph [formula] of level two by placing an edge between any u∈Vi and any v∈Ui + 1. [formula] has magnification ratios equal to one as

[formula]

and

[formula]

[formula] is furthermore a commutative graph. The way G is joined to R means that for the upward condition we only need to worry about elements in V0. Let uv∈E(V0,V1). Then [formula] and [formula]. We know from Plünnecke's condition that a matching exists from [formula] to [formula] and from Proposition [\ref=Ruzsa] and Lemma [\ref=Cardinality_of_Z_i] that a matching exists from U2 to U1. Putting the two matchings together gives a matching from [formula] to [formula]. Next take uv∈E(V0,U1), [formula] and we know from Proposition [\ref=Ruzsa] that there is a matching from [formula] to [formula] and hence from [formula] to [formula]. Similar considerations show that the downward condition is satisfied.

[formula]Department of Pure Mathematics and Mathematical Statistics Wilberforce Road, Cambridge CB3 0WB, England

[formula] Email address: giorgis@cantab.net