Lemma Fact Claim Corollary Conjecture Definition Construction

Perfect matching in 3-uniform hypergraphs with large vertex degree

Department of Computer Science College of Computing and Information Systems Umm Al-Qura University Makkah, Saudi Arabia iikhan@uqu.edu.sa

Introduction and Notation

For graphs we follow the notation in [\cite=B1]. For a set T, we refer to all of its k-element subsets (k-sets for short) as [formula] and to the number of such k-sets as [formula]. We say that H  =  (V(H),E(H)) is an r-uniform hypergraph or r-graph for short, where V(H) is the set of vertices and [formula], a family of r-sets of V(H), is the set of edges of H. We say that [formula] is an r-partite r-graph, if there is a partition of V(H) into r sets, i.e. [formula] and every edge of H uses exactly one vertex from each Vi. We call it a balanced r-partite r-graph if all Vi's are of the same size. Furthermore [formula] is a complete r-partite r-graph if every r-tuple that uses one vertex from each Vi belongs to E(H). We denote a complete balanced r-partite r-graph by K(r)(t), where t  =  |Vi|. When the graph referred to is clear from the context we will use V instead of V(H) and will identify H with E(H) and er(H)  =  |E(H)|. A matching in H is a set of disjoint edges of H and a perfect matching is a matching that contains all vertices. For U  ⊂  V, H|U is the restriction of H to U.

For an r-graph H and a set [formula], the degree of D in H, deg H(D)  =   deg r(D) denotes the number of edges of H that contain D. For 1  ≤  d  ≤  r, let

[formula]

When H is an r-graph and A and B are disjoint subsets of V(H), for a vertex v∈A we denote by [formula] the number of (r - 1)-sets of B that make edges with v, while [formula] denotes the density. For such A and B, [formula] is the sum of [formula] over all v∈A while [formula]. We denote by [formula] such an r-graph when all edges of H use one vertex from A and r - 1 vertices from B. When [formula] are disjoint subsets of V, for a vertex v∈A1 we denote by [formula] the number of edges in the r-partite r-graph induced by the subsets [formula], and [formula] is the sum of [formula] over all v∈A1. Similarly

[formula]

An r-graph H on n vertices is η- dense if it has at least [formula] edges. We use the notation dr(H)  ≥  η to refer to an η-dense r-graph H. A bipartite graph G = (A,B) is η- dense if d(A,B)  ≥  η. For U  ⊂  V, for simplicity we refer to dr(H|U) as dr(U) and to E(H|U) as E(U). Throughout the paper log  denotes the base 2 logarithm. Moreover we will only deal with r-graphs on n vertices where n = rk for some integer k, we denote this by [formula].

Let d,r and n be integers such that 1  ≤  d  <  r, and [formula]. Denote by md(r,n) the smallest integer m, such that every r-graph H on n vertices with δd(H)  ≥  m contains a perfect matching.

For graphs (r = 2), by the Dirac's theorem on Hamiltonicity of graphs [\cite=Dirac1952], it is easy to see that m1(2,n)  ≤  n / 2, and since the complete bipartite Kn / 2 - 1,n / 2 + 1 does not have a perfect matching we get m1(2,n)  =  n / 2. For r  ≥  3 and d  =  r - 1, it follows from a result of Rödl, Ruciski and Szemerédi on Hamiltonicity of r-graph [\cite=RRSz_HAM_ku_colDeg_approx] that mr - 1(r,n)  ≤  n / 2  +  o(n). Kühn and Osthus [\cite=KO_PM_ku_colDeg] improved this result to [formula]. This bound was further sharpened in [\cite=RRSz_PM_ku_colDeg] to mr - 1(r,n)  ≤  n / 2  +  C log n. In [\cite=RRSz_PM_ku_colDeg_approx_better] the bound was improved to almost the true value; it was proved that mr - 1(r,n)  ≤  n / 2  +  r / 4. Finally [\cite=RRSz_PM_ku_colDeg_tight] settled the problem for d = r - 1. Kühn and Osthus [\cite=KO_PM_ku_colDeg] and Aharoni, Georgakopoulos and Sprüssel [\cite=AGS_partite] studied the minimum degree threshold for perfect matching in r-partite r-graphs.

The case d < r - 1 is rather hard. Pikhurko [\cite=Pikh_PM_ku_dDeg] proved that for all d  ≥  r / 2, md(r,n) is close to [formula]. For 1  ≤  d < r / 2, Hàn, Person and Schacht [\cite=HPS_PM_3u_vertDeg] proved that

[formula]

A recent survey of these and other related results appear in [\cite=Rod_Ruc_Survey]. In [\cite=HPS_PM_3u_vertDeg] the authors posed the following conjecture.

For all 1  ≤  d  <  r / 2,

[formula]

Note that for r = 3 and d = 1 the above bound yields

[formula]

Improving an old result of Daykin and Häggvist [\cite=DH1981], the authors of [\cite=HPS_PM_3u_vertDeg] proved an approximate version of their conjecture for the case r = 3 and d = 1, they showed that [formula] for large n. For the case r = 4 and d = 1, Markström and Ruciski [\cite=Ruc_Marks_approx4u] proved that [formula]. Lo and Markström [\cite=Lo_Markst_3partite] determined the exact degree threshold for r = 3 and d = 1 for the case of 3-partite 3-graphs.

In this paper we settle Conjecture [\ref=conject] for the case r = 3 and d = 1. Parallel to this work, independently Kühn, Osthus and Treglown [\cite=KOT_parallel] proved the same result. We believe our techniques are more general and have many other applications. In our subsequent work [\cite=Khan_4u_vertDeg] we use similar techniques to prove Conjecture [\ref=conject] for the case r = 4 and d = 1 as well. Our main result in this paper is the following theorem.

There exist an integer n0 such that if H is a 3-graph on n  ≥  n0 vertices ([formula]), and

[formula]

then H has a perfect matching.

On the other hand the following construction from [\cite=HPS_PM_3u_vertDeg] shows that the result is best possible.

We have [formula] (the degree of a vertex in B) but since every edge in a matching must use at least one vertex from A, the maximum matching in H is of size [formula].

The main result

We distinguish two cases to prove Theorem [\ref=ourMainThm]. In Section [\ref=non_ext_case] we show that a slightly relaxed minimum degree condition implies that either H has an 'almost perfect matching' or H is 'close to' the extremal example of Construction [\ref=extConstruction]. In case H is not close to the extremal example we first find an almost perfect matching and extend it to a perfect matching in H using the 'absorbing' technique. On the other hand, when H is close to the extremal example, in Section [\ref=extCase] we build a perfect matching in H with a greedy approach.

For a constant 0 < α  <  1, we say that H is α-extremal, if the following is satisfied otherwise it is α-non-extremal. There exists a B  ⊂  V(H) such that

[formula]

[formula].

When H is α-non-extremal, we use the absorbing lemma, which roughly states that in H there exists a small matching M with the property that every 'not too large' subset of vertices W can be absorbed into a matching covering [formula].

(Absorbing Lemma, [\cite=HPS_PM_3u_vertDeg]) For every η > 0, there is an integer n0  =  n0(η) such that if H is a 3-graph on n  ≥  n0 vertices with [formula], then there exists a matching M in H of size |M|  ≤  η3n such that for every set [formula] of size at most [formula], there exists a matching covering all the vertices in [formula].

After removing an absorbing matching M from H we find an almost perfect matching in [formula]. The few vertices not covered by this almost perfect matching are absorbed into M to get a perfect matching in H. Theorem [\ref=optCoverTheorem] in Section [\ref=non_ext_case], using the tools developed in Section [\ref=tools], guarantees the existence of an almost perfect matching in the non-extremal case.

For all [formula], there is an n0 such that if H is a 3-graph on n  ≥  n0 vertices with

[formula]

then either

H contains a matching leaving strictly less than η2n vertices unmatched or

H is α-extremal.

When H is α-extremal then almost all vertices of A make edges with almost all 3-sets in [formula], where B is as in Definition [\ref=ext_defn] and [formula]. In Section [\ref=extCase] we first match the few vertices of A that do make edges with almost all 3-sets in [formula] and the remaining vertices are matched using a König-Hall type argument.

For all [formula], there is an n0 such that if H is an α-extremal 3-graph on n  ≥  n0 vertices with

[formula]

then H contains a perfect matching.

Let [formula] be given. Applying Lemma [\ref=absorbLemma] with parameter [formula], Theorem [\ref=optCoverTheorem] with parameter α3 / 2 and Theorem [\ref=extCaseTheorem] with parameter α, we get n0',n0'' and n0''' respectively. Let n0  =  2 max {n0',n0'',n0'''}. Now assume that we have a 3-graph H on n  ≥  n0 vertices satisfying ([\ref=minDegree]). From ([\ref=minDegree]) when n is large we have

[formula]

Hence H satisfies the conditions of Lemma [\ref=absorbLemma] with parameter [formula]. We remove from H an absorbing matching M of size at most α3 / 2n.

Let [formula] be the remaining hypergraph (after removing M) on n'  =  n  -  |V(M)| vertices. Since [formula], it is easy to see that

[formula]

As n'  >  n0'', using Theorem [\ref=optCoverTheorem] (with η  =  α3 / 2), in H' we find an almost perfect matching that leaves out a set of at most α3n'  <  α3n vertices. As guaranteed by Lemma [\ref=absorbLemma] the vertices that are left out from this almost perfect matching are absorbed into M, and we get a perfect matching in H.

In case H is α-extremal, using Theorem [\ref=extCaseTheorem] we get a perfect matching in H, which concludes the proof of Theorem [\ref=ourMainThm].

Tools

We use the following result of Erdös [\cite=ErdosKST] to find complete balanced r-partite subhypergraphs of r-graphs.

For every integer l  ≥  1 there is an integer n0  =  n0(r,l) such that every r-graph on n > n0 vertices, that has at least nr - 1 / lr - 1 edges, contains a K(r)(l).

For [formula] and r  ≤  3, if H is an r-graph on n > n0(η,r) vertices with

[formula]

then H contains a K(r)(t), where

[formula]

This is so because [formula] , as [formula].

The following lemma is a very useful tool in this section.

Let m be a sufficiently large integer. If G(A,B) is an η-dense bipartite graph with |A|  =  c1m and B  ≥  c22m for some constants 0 < c1,c2 < 1, then there exists a complete bipartite subgraph G'(A',B') of G such that A'  ⊂  A, B'  ⊂  B, [formula].

First we show that there is a set B1  ⊂  B such that |B1|  ≥  η|B| / 2 and for every vertex b∈B1, deg(b,A)  ≥  η|A| / 2. Such a subset exists because otherwise the total number of edges in G would be strictly less than

[formula]

a contradiction to the fact that G(A,B) is η-dense. Now we show that there is the required complete bipartite subgraph in G(A,B1). To see this consider the neighborhoods in A, of the vertices in B1. Since there can be at most 2|A|  =  2c1m such neighborhoods, by averaging there must be a neighborhood that appears for at least [formula] vertices of B1. Hence we get the desired complete bipartite graph.

The following two lemmas are repeatedly used in Section [\ref=non_ext_case].

Let m be a sufficiently large integer and let H(X,Y,Z) be a 3-partite 3-graph with |X|  =  |Y|  =  c1m and |Z|  ≥  c22m2 for some constants 0 < c1,c2 < 1. If d3(Z,(X  ×  Y))  ≥  η, then there exists a complete 3-partite 3-graph H'(X',Y',Z') as a subgraph of H, such that [formula].

First consider the auxiliary bipartite graph G1(A,Z), where A = X  ×  Y and a vertex z∈Z is connected to a pair (a,b)∈A if {a,b,z} is an edge of H. Clearly G1 satisfies the conditions of Lemma[\ref=subsetsPHP]. Applying Lemma [\ref=subsetsPHP] on G1 we get a complete bipartite graph G2(A',Z') such that A'  ⊂  A = X  ×  Y, Z'  ⊂  Z, |A'|  ≥  η|X||Y| / 2 and [formula] where the last inequality follows when m is large.

Now Let G3 be a graph on vertex set [formula] and (a,b) is an edge in G3 if (a,b)∈A'. Since |A'|  ≥  η|X||Y| / 2, we have [formula]. Applying Corollary [\ref=hyperKST_corr] (for r = 2), in G3 we get a complete bipartite graph G4(X',Y') with X'  ⊂  X and Y'  ⊂  Y such that [formula]. Clearly X', Y' and a subset of Z' (of size |X'|), correspond to the color classes of required complete 3-partite 3-graph.

Let m be a sufficiently large integer and let [formula] be a 3-graph such that |A| = c1m, |B|  ≥  c22m2, for some constants 0 < c1,c2 < 1. If [formula], then there exists a complete 3-partite 3-graph H'(A',B',B''), with A'  ⊂  A, B'B'' are disjoint subsets of B such that |A'| = |B'| = |B''|  =  η|A| / 2.

First consider the auxiliary bipartite graph G1(A,P), where [formula] and a vertex a∈A is connected to a pair (b1,b2)∈P if (a,b1,b2) is an edge of H. Applying Lemma [\ref=subsetsPHP] on G1 we get a complete bipartite graph (A',P') in G1 with A'  ⊂  A and P'  ⊂  P such that |A'|  ≥  η|A| / 2 and

[formula]

where the last inequality follows when m is large and η, c1 and c2 are small constants.

Now construct an auxiliary graph G2 where V(G2) = B and edges of G2 corresponds to pairs in P'. Since |E(G2)  ≥  |B|2 - 2 / η|A|, applying lemma [\ref=hyperKST] on G2 (for r = 2) we get a complete bipartite graph with color classes B' and B'' each of size η|A| / 2. Clearly A', B', and B'' corresponds to color classes of a complete 3-partite 3-graph in H as in the statement of the fact.

We also use the following simple facts about graphs.

Any graph on n vertices with m edges has a subgraph of minimum degree m / n.

Any graph on n vertices has a matching of size [formula].

Proof of Theorem [\ref=optCoverTheorem]

Let H be a 3-uniform hypergraph on n vertices where n is sufficiently large and

[formula]

In H we will find an almost perfect matching (covering at least (1 - η2)n vertices). In fact, we will prove a much stronger result. We are going to build a cover [formula]} where each Ti is a disjoint complete 3-partite 3-graph in H. These complete 3-partite 3-graphs will be balanced and will be of the same size. We refer to them as tripartite graphs. We say that such a cover is optimal if it covers at least (1 - η2)n vertices. We will show that either we can find an optimal cover or H is α-extremal. It is easy to see that such an optimal cover readily gives us a matching in H that leaves out at most η2n vertices.

We begin with a cover T obtained by repeatedly applying Lemma [\ref=hyperKST] in the remaining part of H as long as there are at least η2n vertices left and the condition of Lemma [\ref=hyperKST] is satisfied, to get disjoint K(3)(t)'s where [formula]. Note that by Lemma [\ref=hyperKST] we can find larger tripartite graphs in H (at least initially) but since we want all tripartite graphs to be of the same size we find all tripartite graphs of size 3t.

Identify by T the set of tripartite graphs in the cover and let V(T) be the union of vertices in the tripartite graphs in T. We refer to |V(T)| as size of the cover and to a subset of T as a subcover in T. Let [formula] be the set of remaining vertices. If T is not an optimal cover, then since we cannot apply Lemma [\ref=hyperKST] in H|I (with parameters η to get another K3(t)), we must have that |I|  >  η2n and

[formula]

Note that from ([\ref=minDeg_nonext]) and ([\ref=denI]) we immediately get that |V(T)|  >  ηn. We show that if H is α-non-extremal and T is not optimal then using the iterative procedure outlined below we can significantly increase the size of our cover (by at least η4n vertices). After every iteration all tripartite graphs in T will be of the same size. Furthermore, all tripartite graphs in T will be balanced and if the size of a color class in the tripartite graphs at a given iteration is t, then after the iteration it will be [formula]. We take n to be sufficiently large so that till the end of the procedure the size of each color class is large enough for Lemma [\ref=3partVolArg] and Lemma [\ref=subsetPHP_hyper] to be applicable.

Let Ti  =  (Vi1,Vi2,Vi3) be a tripartite graph in T. For 1  ≤  l,k  ≤  3, we say that Ti is k-sided, if [formula], for k color classes Vil of Ti. We will show that most of the tripartite graphs in T are at most 1-sided or we can significantly increase the size of our cover.

If the number of vertices in the at least 2-sided tripartite graphs in T is more than η|V(T)|, then we can increase the size of T by at least η3n / 8 vertices, such that all tripartite graphs in the cover are balanced and are of the same size.

We repeatedly use Claim [\ref=few_2sided] to increase the size of our cover as long as the condition of Claim [\ref=few_2sided] is satisfied. Hence in at most 8η- 3 iterations we either get an optimal cover or the number of vertices in the at least 2-sided tripartite graphs is reduced to at most η|V(T)|. For simplicity we still denote the cover by T and [formula]. The size of a color class in each tripartite graph is still denoted by t.

Suppose that T is not optimal and we cannot apply Claim [\ref=few_2sided], then the number of 2-sided vertices in T is at most η|V(T)|. Note that if Ti∈T is at most 1-sided, then by definition [formula]. This together with the bound on the number of 2-sided tripartite graphs gives us

[formula]

For the sum of the degrees of vertices in I, ([\ref=minDeg_nonext]) gives us

[formula]

On the other hand considering the number of times each edge is counted, by ([\ref=denI]) and ([\ref=edges_T_to_I])

[formula]

Combining ([\ref=lower]) and ([\ref=upper]) we get

[formula]

In ([\ref=lower]) and ([\ref=upper]) using [formula] and the fact that η is a small constant we get |V(T)|  ≥  n / 2.

For a vertex v∈V(H), consider the edges that v makes with pairs of vertices within a tripartite graph. Since the size of a tripartite graph is [formula], the number of pairs of vertices of any tripartite graph Ti∈T is O( log n). Hence the total number of pairs of vertices within the tripartite graphs in T is [formula]. We ignore the at most [formula] edges that use more than one vertex from a tripartite graph. By the above observation we still have

[formula]

Let Ti  =  (Vi1,Vi2,Vi3) and Tj  =  (Vj1,Vj2,Vj3) be two tripartite graphs in T. We say that I is connected to a pair of color classes (Vip,Vjq), 1  ≤  p,q  ≤  3, if d3(I,(Vip  ×  Vjq))  ≥  2η. For [formula] we define the link graph, Lij, to be a balanced bipartite graph, where the vertex set of each color class of Lij corresponds to the color classes in Ti and Tj. A pair of vertices is an edge in Lij iff I is connected to the corresponding pair of color classes. We will use the following fact from [\cite=HPS_PM_3u_vertDeg] for the analysis of the link graph.

Let B320 and B311 be as defined in Figure [\ref=3x3bipgraphs]. If B is a balanced bipartite graph on 6 vertices with |E(B)|  ≥  5, then at least one of the following must be true.

B has a perfect matching.

B contains B320 as a subgraph.

B is isomorphic to B311.

If there are [formula] pairs of tripartite graphs (Ti,Tj) such that Lij has a perfect matching or contains a B320, then we can increase the size of T by at least η3n / 8 vertices such that all tripartite graphs in the cover are balanced and are of the same size.

We can repeatedly use Claim [\ref=expanding_byVolArg] to increase the size of our cover as long as the condition of Claim [\ref=expanding_byVolArg] is satisfied. Hence in at most 8η- 3 iterations we either get an optimal cover or we have that there are at most [formula] pairs of tripartite graphs (Ti,Tj) such that the link graph Lij has at least 5 edges and contains either a perfect matching or B320 as a subgraph. For simplicity we still denote the cover by T and [formula].

Assume that T is not optimal. We show that if we cannot apply Claim [\ref=expanding_byVolArg], then for most of the pairs of tripartite graphs in [formula], the link graph has exactly 5 edges and is isomorphic to B311. Indeed, if there are many ([formula]-fraction) pairs of tripartite graphs (Ti,Tj) for which |E(Lij)|  ≤  4 then there is another set of at least η-fraction of pairs of tripartite graphs (Ti,Tj) for which |E(Lij)|  ≥  6. To see this let [formula] and [formula]. Note that for any (Ti,Tj)∈P4 by definition d3(I,V(Ti)  ×  V(Tj))  ≤  (4 / 9  +  10η).

Now if [formula] and [formula] then

[formula]

a contradiction to ([\ref=min_cross_density]). Therefore for at least [formula] pairs of tripartite graphs [formula], Lij has at least 5 edges. Since we cannot apply Claim [\ref=expanding_byVolArg], for at least [formula] of them the Lij is isomorphic to B311 and |E(Lij)| = 5.

If there are at least [formula] pairs of tripartite graphs (Ti,Tj) such that Lij is isomorphic to B311, then either

we can increase the size of T by at least η4n vertices such that all tripartite graphs in the cover are balanced and are of the same size, or

H is α-extremal.

We repeatedly use Claim [\ref=noExpand_extremal] to increase the size of our cover as long as the condition of Claim [\ref=noExpand_extremal] is satisfied.

Hence proceeding in iterations applying the appropriate claim at each iteration, it is clear that in at most 8η- 4 iterations we either get an optimal cover or that H is α-extremal. The optimal cover readily gives us an almost perfect matching.

Proof of Claim [\ref=few_2sided]

Let [formula] be the subcover of the at least 2-sided tripartite graphs such |V(T')|  ≥  η|V(T)|  ≥  η2n. Without loss of generality, say in each Ti∈T' we have

[formula]

For each such Ti, we have [formula] and |I|  ≥  η2n  >  η22m2. By Lemma [\ref=subsetPHP_hyper] (with parameter η ) we find two disjoint balanced complete tripartite graphs (Ui1,Ai1,Bi1) and (Ui2,Ai2,Bi2) where Ui1 and Ui2 are subsets of Vi1 and Vi2 respectively, and Ai1,Ai2,Bi1Bi2 are disjoint subsets of I (see Figure [\ref=2sided_extension]). The size of each color class of these tripartite graphs is η|Vi1| / 2 (we assume it is an integer). Note that we can find larger tripartite graphs but we keep the size of these new tripartite graphs 3η|Vi1| / 2 only. We remove the vertices of these new tripartite graphs from their respective sets and add the tripartite graphs to our cover. Removing these vertices from Vi1 and Vi2 creates an imbalance in the leftover part of Ti (Vi3 has more vertices). To restore the balance in the leftover of Ti we discard (add to I) some arbitrary |Ui1|  =  |Ui2|  =  η|Vi1| / 2 vertices from Vi3. The new tripartite graphs use at least 2|Ai1|  +  2|Bi1|  =  2η|Vi1| vertices from I. Therefore, after discarding the vertices from Vi3 the net increase in the size of our cover is 3η|Vi1| / 2, while all the tripartite graphs in T are balanced.

We proceed as above for the remaining tripartite graphs in T' one by one until we remove at least η|I| / 8  ≥  η3n / 8 vertices from I. Since each Ti∈T' is at least 2-sided we can continue as above. Indeed, until we remove η|I| / 8 vertices from I, for the remaining tripartite graphs in T' and the remaining part of I the condition of Lemma [\ref=subsetPHP_hyper] is still satisfied (with parameter η). Since |V(T')|  ≥  η|V(T)|  ≥  η2n, it is easy to see that with this procedure we increase the size of our cover by at least η3n / 8 vertices. Note that the newly made tripartite graphs have color classes of size ηt / 2 while the remaining parts of tripartite graphs in T' and those in [formula] are bigger. To make all tripartite graphs in the cover of the same size, we split each tripartite graph in the cover, into disjoint balanced complete tripartite graphs, such that each color class of every tripartite graph is of size ηt / 2 (we assume divisibility).  [formula]

Proof of Claim [\ref=expanding_byVolArg]

We first find a set of disjoint pairs of tripartite graphs such that for each pair the link graph either has a perfect matching or contains a B320. Consider the auxiliary graph where vertices are the tripartite graphs in T and two vertices are connected if for the corresponding tripartite graphs Ti and Tj, Lij has a perfect matching or contains a B320. Since this auxiliary graph has at least [formula] edges, by Lemma [\ref=folk_subgraph] and Lemma [\ref=folk_matching], we find a matching of size η|T| / 3 in this graph. Clearly, this matching corresponds to a set of disjoint pairs of tripartite graphs, [formula], such that for the each pair (Ti,Tj)∈P, Lij has a perfect matching or contains a B320. The number of vertices in the 2|P| tripartite graphs in P is at least ηn / 3 as |V(T)|  ≥  n / 2. We distinguish the following two cases for each pair in P, to make new tripartite graphs using some vertices from I.

Case 1: Lij has a perfect matching. Without loss of generality assume that the perfect matching in Lij corresponds to the pairs (Vi1,Vj1), (Vi2,Vj2) and (Vi3,Vj3). Note that by construction of Lij, I is connected to (Vi1,Vj1), (Vi2,Vj2) and (Vi3,Vj3). By definition of connectedness, d3(I,Vi1  ×  Vj2)  ≥  2η and [formula] and |I|  ≥  η2n  >  η22t2, hence the 3-partite 3-graph H(Vi1,Vj1,I) satisfies the conditions of Lemma [\ref=3partVolArg]. Applying Lemma [\ref=3partVolArg] (with parameter η) we find a complete balanced tripartite graph T1  =  (Ui1,Uj1,I1), such that

[formula]

Similarly, we find such complete balanced tripartite graphs T2 and T3 in H(Vi2,Vj2,I) and H(Vi3,Vj3,I) respectively (see Figure [\ref=fig:case1]). Clearly we can have that T1,T2 and T3 are disjoint from each other as |I|  ≥  η2n .

We remove the vertices in T1,T2 and T3 from their respective sets and add these three new tripartite graphs to our cover. In the remaining parts of Ti and Tj we remove another such set of 3 disjoint tripartite graphs. By definition of connectedness until we remove at least η2t / 2 vertices from each color class of Ti and Tj we still have d3(I,(Vi1  ×  Vj1)) > η. Hence by Lemma [\ref=3partVolArg] we continue removing such three tripartite graphs until from each color class of Ti and Tj we remove η2t / 2 vertices. Note that the new tripartite graphs use 3η2t / 2 vertices from I. Therefore adding these new tripartite graphs to our cover increases the size of the cover by 3ηt2 / 2 vertices while all tripartite graphs in the cover are still balanced.

Case 2: Lij contains a B320. Again without loss of generality assume that in the B320 the vertices of degree 3 and 2 correspond to the color classes Vi1 and Vi2 respectively. Furthermore, we may assume that I is connected to (Vi1,Vj1), (Vi1,Vj2), (Vi2,Vj2) and (Vi2,Vj3). By definition of connectedness the 3-partite subhypergraph of H induced by I and any of the above four pairs of color classes satisfies the conditions of Lemma [\ref=3partVolArg].

Similarly as in the previous case, applying Lemma [\ref=3partVolArg] (with parameter η) we find the following four disjoint complete tripartite graphs: (Vi11,Vj11,I1), (Vi22,Vj32,I2), (Vi13,Vj23,I3) and (Vi24,Vj24,I4) such that for 1  ≤  p  ≤  3 and 1  ≤  q  ≤  4, Iq,VipqVjpq are disjoint subsets of I,Vip and Vjp respectively (see Figure [\ref=fig:case2]).

For the sizes of these new tripartite graphs we have

[formula]

and

[formula]

In the remaining parts of Ti and Tj we remove another such set of 4 disjoint tripartite graphs. Again by definition of connectedness and Lemma [\ref=3partVolArg] we can continue this process until we remove η2t / 2 vertices each from Vi1 and Vi2. Note that when we remove the vertices of these new tripartite graphs from their respective color classes in Ti and Tj, the remaining part of Tj is still balanced while it creates an imbalance in the remaining part of Ti, as Vi3 has η2t / 2 more vertices than the other two color classes To restore the balance we discard (add to I) an arbitrary subset of vertices in Vi3 (of size η2t / 2). These new tripartite graphs use at least η2t vertices from I. Therefore, after discarding the vertices from Vi3 the net increase in the number of vertices in the cover is η2t / 2.

We proceed in similar manner for all pairs in P one by one until we remove at least η|I| / 8  ≥  η3n / 8 vertices from I. Applying the appropriate procedure in Case 1 or Case 2 we increase the size of the cover by η3n / 8 vertices (as the size of P is at least ηn / 3 and for every pair the increase is η2t / 2) while keeping all the tripartite graphs in the cover balanced. Note that even after removing η|I| / 8 vertices from I for the remaining pairs (Ti,Tj)∈P, the conditions of Lemma [\ref=3partVolArg] are satisfied (with parameter η).

Again as above we make all tripartite graphs in the cover of the same size, by arbitrarily splitting each larger tripartite graph into disjoint tripartite graphs with color classes of size η log t / 4.  [formula]

Proof of Claim [\ref=noExpand_extremal]

Similarly as above, first consider the auxiliary graph where vertices are the tripartite graphs in T and two vertices are connected if for the corresponding tripartite graphs Ti and Tj, Lij is isomorphic to B311. This auxiliary graph has T vertices and at least [formula] edges. By Lemma [\ref=folk_subgraph] and Lemma [\ref=folk_matching], in this graph we can find a matching of size [formula]. This matching corresponds to a set of disjoint pairs of tripartite graphs, [formula], such that for each pair (Ti,Tj)∈Pg, Lij is isomorphic to B311. Let the set of tripartite graphs in Pg be Tg and let V(Pg) be the set of vertices in these tripartite graphs, we have

[formula]

Without loss of generality assume that for each (Ti,Tj)∈Pg, the vertices of degree 3 in the B311 in Lij correspond to the color classes Vi1 and Vj1. Thus by definition of connectedness for each (Ti,Tj)∈Pg, (see Figure [\ref=all_B311])

[formula]

Let [formula] (V2 and V3 are similarly defined). We have

[formula]

For each (Ti,Tj)∈Pg the conditions of Lemma [\ref=3partVolArg] are satisfied for H(Vi1,Vj2,I), H(Vi1,Vj3,I), H(Vi2,Vj1,I) and H(Vi3,Vj1,I). We find a disjoint complete tripartite graphs in each of these four 3-partite 3-graphs (see Figure [\ref=B311_ext]). The size of each color class in the new tripartite graphs is [formula]. Again we continue removing such sets of four tripartite graphs until we remove η3t vertices each from Vi1 and Vj1. By construction, these new tripartite graphs remove η3t / 2 vertices each from Vi2, Vi3, Vj2 and Vj3.

These new tripartite graphs use 2η3t vertices from I. Removing these new tripartite graphs creates an imbalance among the color classes of the remaining parts of Ti and Tj, to restore the balance we will have to discard η3t / 2 vertices from each color class of Ti and Tj except Vi1 and Vj1. This leaves us with no net gain in the size of the cover. Therefore we will not discard any vertices from these color classes at this time and say that these color classes have η3t / 2 extra vertices.

We proceed in similar manner for each pair in Pg. Since in total we will use |Tg|  ·  η3t  ≤  η3n  ≤  η|I| vertices from I for the remaining pairs of tripartite graphs in Pg the conditions of Lemma [\ref=3partVolArg] (with parameter η) are satisfied. So we can continue to make new tripartite graphs.

Let Vg1  ⊂  V1,Vg2  ⊂  V2,Vg3  ⊂  V3 be the union of the corresponding color classes of remaining parts of tripartite graphs in Tg. Since the number of vertices used in the newly made tripartite graphs above is at most η3n, by ([\ref=numVertices_good]) we have

[formula]

Next we show that if at least one of the following density conditions is true then we can increase the size of our cover:

[formula]

[formula]

Assume that [formula]. We will show that in [formula] there exist disjoint balanced complete tripartite 3-graphs of size η3t / 4 (half the number of extra vertices in a color class) covering at least η4n vertices. Furthermore, we can find such tripartite graphs in [formula] such that from no color class we use more than the number of extra vertices in that color class.

To see this, call a color class 'full' if these new tripartite graphs use at least η3t / 4 vertices. We remove all vertices of each full color class and find tripartite graphs of size η3t / 4 in the remaining vertices. Let k be the number of full color classes at a given time and suppose that the total number of vertices covered by the new tripartite graphs is at most η4n. Then, k  ·  η3t / 4  <  η4n which implies that tk  <  4ηn i.e. the total number of vertices in the full color classes is at most 4ηn. Let H' be the remaining part of [formula] (after removing all vertices in every full color class). By the above observation [formula] and [formula]. Hence by Lemma [\ref=hyperKST] we can continue to find complete tripartite graphs of size η3t / 4 in H'. Note that we do not use more than the number of extra vertices from any color classes.

We remove some of these new tripartite graphs so that the total number of vertices covered by them is at least η4n. Now adding these new tripartite graphs to our cover increases the size of our cover by at least η4n vertices, as we did not discard vertices from [formula] for rebalancing. Instead the extra vertices are part of these new tripartite graphs. Now in the remaining parts of each Ti∈Tg we arbitrarily remove some extra vertices to restore the balance in the tripartite graphs and as above make all tripartite graphs of the same size.

On the other hand if [formula], then since both |I| and [formula] are at least η2n, by Lemma [\ref=hyperKST] we find disjoint complete tripartite graphs with one color class in [formula] and two color classes in I covering at least η4n vertices. Again as above we make these tripartite graphs so as to not use more than the number of extra vertices in any color class. Adding these tripartite graphs increases the size of our cover by at least η4n vertices.

In case none of the above density conditions hold then by ({[\ref=emptyI_to_V2V3]), ([\ref=emptyV2V3]), ([\ref=emptyV2V3_to_I]) and the fact that d3(I) < η, we get [formula]. By ([\ref=sizeV2V3g]) we have [formula]. Hence H is α-extremal. This concludes the proof of Claim [\ref=noExpand_extremal].  [formula]

Proof of Theorem [\ref=extCaseTheorem]

Let α be given and let [formula]. Our hypergraph H is α-extremal i.e. there exists a B  ⊂  V(H) such that

[formula]

d3(B)  <  α.

Let [formula], by shifting some vertices between A and B we can have that A = n / 3 and B = 2n / 3 (we keep the notation A and B). It is easy to see that we still have

[formula]

Since we have

[formula]

together with ([\ref=extDen]) this implies that almost all 3-sets of V(H) are edges of H except 3-sets of B. Thus roughly speaking almost every vertex b∈B makes edges with almost all pairs of vertices in [formula] and with almost all pairs of vertices in [formula] and vice versa. Therefore, we will basically match every vertex in A with a distinct pair of vertices in [formula] to get the perfect matching. However, there may be a few vertices making edges with different pairs of vertices than the typical ones. Hence we will first match those few vertices and then we will use a König-Hall type argument to match every remaining vertex in A with a distinct pair of remaining vertices in B.

We first identify vertices in A and B that do not satisfy the typical degree conditions as follows.

[formula]

We will show that there are few vertices in XA and XB and very few vertices in SA and SB.

We have the following bounds on the sizes of the sets defined above.

[formula].

[formula].

|SB|  ≤  40α|B|.

|SA|  ≤  40α|A|.

We only prove the bounds on |XB| and |SA| (the others are similar). Assume that [formula]. By ([\ref=minDeg_ext]) and the definition of XB, for any vertex b∈XB, [formula]. Therefore for the number of edges inside B we have

[formula]

where the last inequality uses |A| = |B| / 2. This implies that d3(B)  ≥  9α, a contradiction to ([\ref=extDen]).

To see the bound on |SA|, note that by ([\ref=minDeg_ext]), if there is a set of k vertices [formula] in A and a pair {b1,b2} of vertices in B such that for 1  ≤  i  ≤  k, {ai,b1,b2}∉E(H), then to make up the minimum degree of b1, there are at least k + 1 edges in E(B) containing b1. Similarly (not necessarily distinct) k + 1 edges exist in B to make up the minimum degrees of b2. This, together with the fact that every a∈SA does not make edges with at least [formula] pairs of vertices in B, implies that

[formula]

If |SA| > 40α|A|, then

[formula]

where the last inequality holds when α is a small constant and is a contradiction to ([\ref=extDen]).  [formula]

There exists a matching M in H such that M covers all the strongly exceptional vertices and if [formula], [formula] and n' = n - |V(M)|, then |B'|  =  2|A'|  =  2n' / 3.

We first show that if both SB and SA are non empty, then we can reduce the sizes of both. To see this assume b∈SB and a∈SA. By definition, [formula] and deg 3(b,(B  ×  A))  <  α1 / 3|A|(|B| - 1). Hence by ([\ref=minDeg_ext]), deg 3(a,A  ×  B)  ≥  (1 - 2α1 / 3)(|A| - 1)|B| and [formula]. We can exchange a with b and reduce the size of both SB and SA, as both a and b are not strongly exceptional in their new sets. Applying the above procedure we take the sets A and B such that |SA| + |SB| is as small as possible (and one of the sets SA and SB is empty).

First assume that [formula]. As observed above by the minimum degree condition and definition of SB, for every vertex b∈SB, [formula]. Since |SB| is very small and every vertex in SB makes many edges insides B we can greedily find |SB| vertex disjoint edges in H|B each containing exactly one vertex of SB. Indeed after removing at most |SB| - 1 disjoint edges from H|B the remaining vertex in SB still makes edges with at least [formula] pairs of the remaining vertices. Hence we can greedily match each vertex in SB in a matching M in H|B. To keep the ratio of the sizes of the remaining parts of A and B intact, we add to M, |SB| other vertex disjoint edges such that each edge has a vertex in [formula] and the two other vertices are in A. We can clearly find such edges because by ([\ref=minDeg_ext]) and ([\ref=extDen]) almost every vertex in [formula] makes edges with at least [formula] pairs of vertices in A (as otherwise d3(B) will be very large). We remove the vertices of M from A and B and by construction n'  =  n - 6|SB|, |A'| = |A| - 2|SB| and |B'| = |B| - 4|SB|, hence |B'|  =  2|A'|  =  2n' / 3.

In case [formula] (and [formula]), we will find a matching such that each edge contain a vertex in SA. Note that in this case for any vertex b∈B we have [formula]. Indeed, if there is a vertex b∈B such that [formula] then we can replace b with any vertex a∈SA to reduce the size of SA (as the vertex b is not strongly exceptional in A and a is not strongly exceptional in the set B). We say that vertices in SA are exchangeable with vertices in B and consider the whole set [formula]. By ([\ref=minDeg_ext]) for any vertex [formula]

[formula]

We will prove by induction on |SA| that we can find a matching M in [formula] of size |SA|. Note that this also follows from a result of Bollobás, Daykin and Erdös [\cite=BDE]. If |SA|  =  1 then clearly we get an edge in [formula] and we are done. Now assume that |SA| > 1 and that the assertion is true for smaller values of |SA|. Let v be a maximum degree vertex in [formula] and let [formula].

For any vertex u∈V(H') the number of pairs of vertices in [formula], containing v but not u, is at most [formula]. Therefore we get that

[formula]

where the last equality follows by a simple calculation. Hence by induction hypothesis there is a matching in H' of size at least |SA|  -  1. Let M1 be a maximum matching in H', if |M1|  ≥  |SA| then we are done so assume that |M1|  =  |SA| - 1 and every edge in H' intersects V(M1). This gives us a lower bound on the maximum degree of a vertex in V(M1) and since v is the overall maximum degree vertex we get

[formula]

where the last inequality uses the fact that |B| is much larger compared to |SA|. Since the last quantity is larger then the number of pairs that use at least one vertex from V(M1), there is a pair of vertices in [formula] that makes an edge with v. Adding this edge to M1 we get a matching M which is the required matching. Using the fact that vertices in SA are exchangeable with vertices in B, we get n'  =  n - 3|SA|, |A'| = |A| - |SA| and |B'| = |B| - 2|SA|, hence we get |B'|  =  2|A'|  =  2n' / 3.

Having dealt with the strongly exceptional vertices, the vertices of XA and XB in A' and B' can be eliminated using the fact that their sizes are much smaller than the crossing degrees of vertices in those sets. We have [formula] while for any vertex a∈XA, we have that [formula] (because a∉SA). For each a∈XA we remove a disjoint edge that contains a and two vertices from B'. This can be done greedily as after covering |XA| - 1 vertices of XA, the total number of edges removed is at most [formula]. So there are pairs of vertices in the remaining part of B' making edges with the next vertex of XA. Similarly for each b∈XB we remove an edge that contains b and uses one vertex from A' and the other vertex is from B' distinct from b. Clearly we can find such disjoint edges by a simple greedy procedure. Hence we removed a partial matching that covers all vertices in the exceptional sets.

Denote the leftover sets of A' and B' by A'' and B'' respectively. By construction |B''| = 2|A''|). We will find |A''| disjoint edges each containing one vertex from A'' and two vertices from B''. Note that for every vertex a∈A'' we have [formula] (as a∉XA). We say that a pair (b1,b2) of vertices in B'' is good if (bi,bj,ak)∈E(H) for at least (1 - 40α1 / 4)|A''| vertices ak in A''. Any vertex bi∈B'' makes a good pair with at least (1 - 40α1 / 4)|B''| other vertices in B'' (again this is so because bi∉XB).

We randomly select a set P1 of 100α1 / 4|B''| vertex disjoint good pairs of vertices in B''. By the above observation with high probability every vertex a∈A'' make edges in H with at least 3|P1| / 4 pairs in P1 and every pair in P1 makes an edge with at least 3|A''| / 4 vertices in A''. In [formula] still every vertex makes good pairs with almost all other vertices. We pair up each vertex of [formula] with a distinct vertex in [formula] such that they make a good pair. This can be done by considering a 2-graph with vertex set [formula] and all the good pairs as its edges. A simple application of Diracs theorem on this 2-graph gives such a perfect matching of vertices in [formula]. Let the set of these pairs be P2.

Now construct an auxiliary bipartite graph G(L,R), such that L = A'' and vertices in R correspond to the pairs in P1 and P2. A vertex in ak∈L is connected to a vertex y∈R if the pair corresponding to y (say bi,bj) is such that (bi,bj,ak)∈E(H). We will show that G(L,R) satisfies the König-Hall criteria. Considering the sizes of A'' and P1 it is easy to see that for every set Q  ⊂  R if |Q|  ≤  (1 - 40α1 / 4)|A''| then |N(Q)|  ≥  |Q|. When |Q| > (1 - 40α1 / 4)|A''| (using |B''| = 2|A''|) any such Q must have at least 6|P1| / 10 vertices corresponding to pairs in P1, hence with high probability |N(Q)|  =  |L|  ≥  |Q|. Therefore there is a perfect matching of R into L. This perfect matching in G readily gives us a matching in H covering all vertices in A'' and B'', which together with the edges we already removed (covering exceptional and strongly exceptional vertices) is a perfect matching in H.