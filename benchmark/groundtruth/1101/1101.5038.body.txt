Improved methodology for the automated classification of periodic variable stars

Introduction

In recent years there has been a rapid progress in astronomical instrumentation giving us an enormous amount of new time-resolved photometric data, resulting in large databases. These databases contain many light curves of variable stars, both of known and unknown nature. Well-known examples are the large databases resulting from the CoRoT [\citep=Fridlund:2006] and Kepler [\citep=Gilliland:2010] space missions, containing respectively ~  100  000 and ~  150  000 light curves so far. The ESA Gaia mission, expected to be launched in 2012, will monitor about one billion stars during five years. Besides the space missions, also large scale photometric monitoring of stars with ground-based automated telescopes deliver large numbers of light curves. The challenging task of a fast and automated detection and classification of new variable stars is therefore a necessary first step in order to make them available for further research and to study their group properties.

Several efforts have already been made to detect and classify variable stars. In the framework of the CoRoT mission, a procedure for fast light curve analysis and derivation of classification parameters was developed by [\citet=Debosscher:2007]. That algorithm searches for a fixed number of frequencies and overtones, giving the same set of parameters for each star. The variable stars were then classified using a Gaussian classifier [\citep=Debosscher:2007] [\citep=Debosscher:2009] and a Bayesian network classifier [\citep=Sarro:2009].

In this paper we present a new version of this method to detect and classify periodic variable stars. In contrast to the previous versions, the new automated methodology only uses significant frequencies and overtones to classify the variables with it giving less rise to confusion, especially when dealing with ground-based data. In order to be able to deal with a variable number of parameters, we also introduce a novel multi-stage approach. This new methohology offers much more flexibility. We applied this method to the ground-based photometric data of the TrES Lyr1 field, covering about ~  26  000 stars. The classification algorithm considers various classes of non-radial pulsators, such as β Cep, slowly pulsating B (SPB) stars, δ Sct and γ Dor stars, as well as classical radial pulsators (Cepheids, RR Lyr) and eclipsing binaries (see, e.g., [\citet=Aerts:2010] for a definition of the classes of these pulsators).

A new methodology

Variability detection

To detect and extract the variables we performed an automated frequency analysis on all time series. The algorithm first checks for a possible polynomial trend up to order 2 and subtracts it, as it can have a large detrimental influence on the frequency spectrum through aliasing. The order of the trend was determined using a classical likelihood-ratio test. Although the coefficients of the trend are recomputed each time a new oscillation frequency is added to the fit, the order of the trend remains fixed.

After detrending, the algorithm searches for significant frequencies and overtones in the residuals, using Fourier analysis. The algorithm searches for the frequency with the highest amplitude in the discrete Fourier transform and checks if this period is significant, using the false alarm probability ([\citet=HB:1986], [\citet=SC:1998]). Note that a detected frequency peak can be significant but unreliable. Reliability is checked through pre-specified frequency intervals that are not trustworthy (e.g. around multiples of 1 c/d for ground-based data). Unreliable frequencies are prewhitened, but flagged as "unreliable" and are not used for classification. If the frequency is the first significant reliable frequency, then the algorithm checks whether half of this frequency is also significant and reliable. In this case, the original new frequency is replaced with half of this frequency to better model the binary light curves. In a next step, the algorithm searches for significant overtones, using the likelihood-ratio test, to model possible non-sinusoidal variations (like those of RR Lyr stars). This procedure is repeated as long as significant frequencies are found. These frequencies νn can be used to make a harmonic best fit to the light curve of the form:

[formula]

with [formula] the order of the trend, and N, the number of significant frequencies, determined using the false alarm probability and [formula] the number of harmonics, determined using the likelihood-ratio test.

The frequency analysis method used by [\citet=Debosscher:2007] performs well on properly-reduced satellite data for which it was designed, but not on noisier ground-based data, as many insignificant frequencies and overtones can degrade the performance of the classifier.

The classifier

The aim of supervised classification is to assign to each variable target a probability that it belongs to a particular predefined variability class, given a set of observed parameters. This set of parameters (also called attributes) is obtained from the variability detection pipeline described above and contains frequencies, amplitudes and phase differences. The classifier relies on a set of known examples, the so-called training set, of each class that needs to represent well the entire variability class.

We used a novel multi-stage approach, where the classification problem is divided into several sequential steps. This classifier partitions the set of given variability classes Ci, into two or more parts: C(1), C(2), . This simplifies the classification by degrading the level of detail to a smaller number of categories. Each of these partitions C(i), which can contain several variability classes, is then again splitted into C(i,1), C(i,2), , which in turn can be partitioned into C(i,j,1), C(i,j,2), and so on, each time specializing the classification until each subpartition contains only one variability class. These partitions can be represented in a tree.

This approach offers several advantages compared to a single-stage classifier. The main advantage of this approach is that in each stage a different classifier and a different set of attributes can be used. This is important as attributes carrying useful information for the separation of two classes can be useless or even harmful for distinguishing other classes. In each stage, informationless attributes for the separation of the classes of interest can be removed, thereby significantly reducing possible confusion. In addition, it is also possible to have a variable number of attributes. This allows to make different branches for mono- versus multi-periodic pulsators. In this way we do not need a fixed set of attributes, thereby avoiding the introduction of spurious frequencies or overtones, which was sometimes the case in [\citet=Debosscher:2007]. As already mentioned earlier, this too is important as insignificant attributes can degrade the performance of the classifier.

We took each of the classifier nodes in the multi-stage tree as a Gaussian mixture classifier. The Gaussian mixture classifier is based on the general law of Bayes:

[formula]

with Nc the number of different classes. These classes can correspond to the variability classes (e.g. β Cep, SPB,...), but as the Gaussian mixture classifier is used at the nodes in the multi-stage classifier, a class in this context may also correspond to a group of variability classes relevant for a particular node. P(C = ci|A = a) is the a posteriori probability of the target belonging to class ci given the observational evidence a, and is the goal of the classification problem. L(A = a|C = ci) is the conditional likelihood of a attribute set a given that it belongs to variability class ci. P(C = ci) is the a priori probability of a target belonging to class ci. As no reliable prior values for variability classes are known yet, we used a uniform prior.

In previous versions of the classifier, the likelihood was approximated as a single Gaussian. Some of the variability classes, however, are not well modeled by a single Gaussian. An example of this is shown in Fig. [\ref=gm], in which multiple components are clearly preferable.

The likelihood is now approximated as a finite sum of multivariate Gaussians:

[formula]

where

[formula]

with Mi the finite number of Gaussian components of class ci, Na the number of attributes, αk the a priori probability to belong to component k, and μk and Σk, the mean vector and covariance matrix of Gaussian component k.

For each node of the multi-stage tree, the set of variability classes is partitioned. The best attributes are selected for that node and the classifier is trained, meaning that the Gaussian mixture for each class is determined. To do so, we used the Expectation-Maximization (EM) method (see e.g. [\citet=GM:1993]). Given a variability class, the unknowns are the number of Gaussian components of each class, the prior probability to belong to a particular component, and the mean vectors μk and covariance matrices Σk of each component. The EM algorithm is an iterative method for calculating maximum likelihood estimates of parameters in probabilistic models, where the model depends on unobserved latent variables. EM alternates between performing an expectation (E) step, which computes the expectation of the log-likelihood evaluated by using the current estimate for the latent variables, and a maximization (M) step, which computes parameters maximizing the expected log-likelihood found in the E step. These parameter-estimates are then used to determine the distribution of the latent variables in the next E step. Given the number of Gaussian components Nc, the remaining unknowns in the model can be determined by using this procedure. The actual number of components is determined using the Bayesian information criterion (BIC), which is a criterion for model selection among a set of parametric models with different number of parameters. We obtained three components in the example in Fig. [\ref=gm] using BIC. The Akaike information criterium (AIC) gives the same number of components. This solution turns out to be very stable when changing initial values, in the sense that the EM algorithm always converges to the same solution.

Automated classification

Once the classifiers in each node are trained, the targets can be classified. In each node we assign a probability to each target that it belongs to a particular class relevant for that node. In order to obtain the final probability for each variability class we multiply the probabilities along the corresponding root-to-leaf path using the chain rule of conditional probability. Let [formula] be the subpartition that contains only class Ci. The probability that the target T belongs to Ci is thus given by:

[formula]

where we dropped "T∈" and the observed attributes {Ai} in the right-hand side of the equation, for the sake of notational simplicity. We retain the most probable class assignment for a given variable star of unknown type and label it according to the Mahalanobis distance.

Note that the denominator in Eq. [\eqref=bayes] enforces the target to belong to one of the predefined classes, although the target can be very far from the class centers in attribute space. For that reason it is important to include an outlier detection step to flag possible wrong predictions. [\citet=Debosscher:2009] approximated a training class with a single Gaussian, and computed the Mahalanobis distance of a target to the center of the class as an outlier indicator. For the multi-stage approach with multi-dimensional Gaussians, we use the following extension of the Mahalanobis distance:

[formula]

with a the attribute vector of the target, and [formula] the center of mass of the Gaussian mixture. The total variance [formula] is defined as the sum of the intra-component variances and the inter-component variance:

[formula]

where μk is the mean vector of each of the Nc Gaussian components. If, and only if, the distance is above a certain threshold, the outlier flag will be set to indicate that the target does not seem to belong to any of the predefined classes. This distance is a multi-dimensional generalisation of the one-dimensional statistical distance (e.g. distance to a mean value of a Gaussian in terms of the standard deviation). For this reason, a value of the distance threshold d=3 is chosen.

Training the classifier

In order to train the classifier, we computed the attributes of the training set objects, which were taken from Hipparcos, OGLE and CoRoT, with the variability detection pipeline, described in section [\ref=sec:vd]. We only computed up to 2 significant frequencies with each up to 3 harmonics, which in our experience is sufficient for classification purposes. Since the quality of the classification results depends crucially on the quality of the training set, we checked all the light curves and phase plots in this set. The variability classes we took into account are listed in Table [\ref=classes]. We carefully set up the multi-stage tree, which is given in Fig. [\ref=mstree]. Applying clustering techniques on CoRoT data, [\citet=Sarro:2009] managed to identify new classes. In view of the Kepler mission, two of these classes, stars with activity and variables due to rotational modulation, are taken into account in the multi-stage tree. A detailed description of these two classes can be found in [\citet=Debosscher:2010].

In each node, we manually selected the best attributes to distinguish the classes considered in that node. In order to evaluate the significance of an attribute we measured the information gain and gain ratio with respect to each class [\citep=WF:2005]. Based on these results we selected the best attributes in terms of highest information gain and gain ratio, that make sense from an astrophysical point of view. In practice 'random' attributes can show structure, even if they are not supposed to. The attributes we know by theory that should be random variables were excluded in order to avoid overfitting. In each node the classifier was then tested using stratified 10-fold cross-validation (see e.g. [\citet=WF:2005]). In stratified n-fold cross-validation, the original sample is randomly partitioned into n subsamples. Of the n subsamples, a single one is retained as the validation data for testing the model, and the remaining n - 1 subsamples are used as training data. The cross-validation process is then repeated n times (the folds), with each of the n subsamples used exactly once as the validation data. Then the n results from the folds are combined to produce a single estimation. Each fold contains roughly the same proportions of the class labels. We kept the attributes giving the best classification results, not only in terms of correctly classified targets, but also in terms of accuracy measured by the area under the ROC curve [\citep=WF:2005]. The higher the area under the ROC curve, the better the test.

Stratified 10-fold cross-validation was also applied on the multi-stage tree as a whole. When only the first frequency and its main amplitude are available, poor results are obtained, because there is simply too little information available for classification. When we leave out those examples and only use the training examples for which we have more information, very good results are obtained as can be seen in Table [\ref=cm_tree_gm]. Only 5.8% of the training examples is wrongly classified. When we replace the variability classes models by single Gaussians, we have a worse result with 7.3% of wrong predictions (see Table [\ref=cm_tree_sg]). When we then also use only one stage, 10.7% of the training examples is misclassified (see Table [\ref=cm_sg]). We can thus conclude that our multi-stage classification tree with Gaussian mixtures at its nodes, is a significant improvement.

Application to TrES data

The TrES Lyr1 dataset

We analyzed 25  947 light curves in the TrES Lyr1 field. TrES, the Trans-atlantic Exoplanet Survey, is a network of three ten-centimeter optical telescopes searching the sky for transiting planets [\citep=Alonso:2007] [\citep=Donovan:2008]. This network consisted of Sleuth (Palomar Observatory, Southern California), the PSST (Lowell Observatory, Northern Arizona) and STARE (Observatorio del Teide, Canary Islands, Spain), as TrES now excludes Sleuth and STARE, but includes WATTS. The TrES Lyr1 field is a [formula] field, centered on the star 16 Lyr and is part of the Kepler field [\citep=Alonso:2007]. Most light curves have about 15  000 observations spread with a total time span of aproximately 75 days. A small fraction has less than 5  000 observations with a total time span of around 62 days. Observations are given in either the Sloan r (Sleuth) or the Kron-Cousins R magnitude (PSST) and the mean R magnitude ranges from 9.2 to 16.3.

Classification of variable stars

Results of the variability detection

With the use of the variability detection algorithm, described in section [\ref=sec:vd], we searched for frequencies in the range 3 / Ttot to 50 c/d, with Ttot the total timespan of the observations in days. In order to avoid the problem of daily aliasing in an automated way, small frequency intervals around multiples of 1 c/d were flagged as "unreliable". Using a false alarm probability of α  =  0.005 (the null-hypothesis of only having noise in the light curves is rejected when P < α, with P the probability of finding such a peak in the power spectrum of a time series that only contains noise.), about 18 000 objects were found non-constant. The stars for which we could not find significant frequencies were used to determine the RMS level of the time series as a function of the mean magnitude, which is plotted in Fig. [\ref=noise], indicating to what level we can detect variability. The upward trend can be explained in terms of photon noise.

Classification results

We used the multi-stage tree presented in section [\ref=sec:tc], where we excluded the stars with activity and variables with rotational modulation. As already mentioned earlier, these classes were included in the multi-stage tree in view of the Kepler mission. However, we do not expect to find good candidates in the ground-based data of TrES Lyr1 as these classes are characterized by low amplitudes. The classification algorithm was able to detect many good candidate class members. By candidate we mean a target belonging to the class with the highest class probability above 2 different cutoff values pmin: 0.5 and 0.75 and with a generalized Mahalanobis distance d < 3 to that class. A quick visual check of the light curves and phase plots of the targets with a distance above 3 showed that a large fraction of light curves suffers from instrumental effects. The results of the classification are listed in Table [\ref=candidates].

As with CoRoT, the main objective for TrES was the search for planets. We do not find many Long Period Variables (LPV), Cepheids and RR Lyr among its targets. The total time span of the light curves is also too short to be able to detect Mira type variables.

Eclipsing binaries and ellipsoidal variables

Irrespective of the observed field on the sky, we should always find a number of eclipsing binaries and ellipsoidal variables. Light curves of eclipsing binaries are very different from those of pulsating stars and therefore generally well separated using the phase differences between the first 3 harmonics of the first frequency. Most detected candidate binaries have therefore a very high probability (> 90%) of belonging to the ECL class. We found about 158 reliable eclipsing binaries. Some good examples of eclipsing binary light curves are shown in Fig. [\ref=lc_ecl]. It is remarkable that, although eclipses are not always easily seen in the light curve, they clearly show up in the phase plot and are detected by the classification algorithm.

Monoperiodic pulsators

Despite the fact that Cepheids and RR Lyr are easy to distinguish from other classes due to their large amplitudes, almost no good candidates were found. Examples of the few candidates found, are shown in Fig. [\ref=lc_rp].

Multiperiodic pulsators

As no colour information was available, confusion between β Cep and δ Sct stars occurs, because of overlapping frequency ranges. For this reason we merged these 2 classes into a single class. It is possible that, for the same target, these classes have similar probabilities below 0.5, but add up to a value well above 0.5. Similarly, we could often not make a clear distinction between γ Dor and SPB stars, because they show similar gravity-mode spectra. This problem may be solved by adding supplementary information like temperature, colours or a spectrum, not only for the targets but also for the training sets. Although frequencies around multiples of 1 c/d have been set unreliable, especially the γ Dor and SPB classes suffer from the combination of daily aliasing and instrumental effects. For this class, a visual inspection of the light curves and phase plots was needed. Fig. [\ref=lc_nrp] shows some good examples of non-radial pulsators.

Discussion and conclusions

In contrast to previous classification methods for time series of photometric data (e.g. [\citet=Debosscher:2007]) we now only use significant frequencies and overtones as attributes, giving less rise to confusion. We are able to statistically deal with a variable number of attributes using the multi-stage approach developed here. Another advantage of this approach is that the conditional probabilities in each node can be simplified by dropping one or more attributes that are not relevant for a particular node. Moreover, in each node, a different classifier can be chosen. In this paper we only used the Gaussian Mixture classifier, but also other methods like, e.g., Bayesian Nets can be used, which gives more flexibility. Finally, the variability classes were better described by a finite sum of multivariate Gaussians.

We applied our methods to the ground-based data of the TrES Lyr1 field, which is also observed by the Kepler satellite. We found non-radial pulsators such as β Cep stars, δ Sct stars, SPB stars, and γ Dor stars. Because of lack of precise and dereddened information, and because of overlap in frequency range we could, however, sometimes not avoid confusion between β Cep and δ Sct stars, on one hand, and between SPB and γ Dor stars on the other hand. Besides non-radial pulsators we also mention the detection of binary stars and some classical radial pulsators. The results of this classification will be made available through electronic tables.

Acknowledgments

The research leading to these results has received funding from the European Research Council under the European Community's Seventh Framework Programme (FP7/2007-2013)/ERC grant agreement n[formula]227224 (PROSPERITY), from the Research Council of K.U.Leuven (GOA/2008/04), from the Fund for Scientific Research of Flanders (G.0332.06), from the Belgian federal science policy office (C90309: CoRoT Data Exploitation, C90291 Gaia-DPAC), and from the Spanish Ministerio de Educación y Ciencia through grant AYA2005-04286. Public access to the TrES data were provided to the through the NASA Star and Exoplanet Database (NStED, http://nsted.ipac.caltech.edu).