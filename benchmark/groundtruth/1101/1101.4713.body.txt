Corollary Result Lemma Proposition

Definition

Notation

Remark

Problem

Example Examples

Remarks

Introduction

Actions of the real line [formula] on C*-algebras are used to describe the time evolution in physical models, and also arise in a wide variety of mathematical contexts. The KMS states for the action were originally intended to be mathematical realisations of the equilibrium states in statistical mechanics [\cite=bra-rob]. More recently, mathematicians have found actions of [formula] on algebras of number-theoretic origin that exhibit phase transitions of the sort one might expect in a statistical-mechanical model [\cite=bos-con] [\cite=laca98] [\cite=lr]. Here we describe a similar phenomenon for the gauge action on an Exel crossed-product C*-algebra associated to an integer dilation matrix A.

An illuminating example for the analysis of KMS states is the action σ lifted from the gauge action of [formula] on the Toeplitz-Cuntz algebra TOn [\cite=eva]. The system (TOn,σ) has a single KMS state for each inverse temperature β  ≥   log n, but only the one at β  =   log n factors through the purely infinite simple quotient On (see, for example, [\cite=ln]) . Our situation is similar: the Exel crossed product is purely infinite simple and has a unique KMS state, which has inverse temperature β  =   log | det A|, whereas its Toeplitz analogue has KMSβ states for all β  ≥   log | det A|. Here, though, the simplex of KMSβ states is large for β  >   log | det A|, and we have a phase transition at β  =   log | det A|.

Before stating our results more precisely, we set up some notation. We consider a matrix [formula] with nonzero determinant, and write σA for the associated self-covering of [formula]. Then [formula] is an endomorphism of [formula],

[formula]

defines a transfer operator L for αA, and the triple [formula] is one of the Exel systems studied in [\cite=ehr]. We write ML for the associated right-Hilbert bimodule over [formula], which has underlying space [formula], actions defined by f  ·  m  ·  g = fmαA(g), and inner product defined by 〈m,n〉 = L(m*n). We write φ for the homomorphism of [formula] into L(ML) which implements the left action.

If Σ is a set of coset representatives for [formula], then the characters {γm:z  ↦  zm  :  m∈Σ}, viewed as continuous functions on [formula] and hence as elements of ML, form an orthonormal basis for ML (this observation is due to Packer and Rieffel [\cite=pr], and a proof consistent with our notation is given in [\cite=ehr]). The reconstruction formula for this basis implies that φ(f) is the finite-rank operator [formula] for every [formula]. Then since αA is unital, the results of [\cite=br] imply that Exel's Toeplitz algebra [formula] is the Toeplitz algebra T(ML), and that the Exel crossed product [formula] is isomorphic to the Cuntz-Pimsner algebra O(ML).

The Toeplitz algebra T(M) of a Hilbert bimodule M over C is generated by a universal representation (iM,iC) of M, and carries a gauge action of [formula] characterised by γz(iM(m)) = ziM(m) and γz(iC(c)) = iC(c); this action descends to the Cuntz-Pimsner algebra (O(M),jM,jC). The gauge actions inflate to actions σ of [formula] which are characterised by

[formula]

Our goal is the following description of the KMS states of (T(ML),σ) and (O(ML),σ).

Suppose that [formula] has nonzero determinant, [formula] is the associated Exel system, and σ denotes the action of [formula] on [formula] satisfying [\eqref=defdynamics].

There are no KMSβ states on [formula] unless β  ≥   log | det A|.

For each β∈( log | det A|,  ∞  ], the simplex of KMSβ states on [formula] is affinely homeomorphic to the simplex [formula] of probability measures on [formula].

If A is a dilation matrix, then [formula] has a unique KMSlog | det A| state, and this state factors through the quotient map

[formula]

Every ground state of [formula] is a KMS∞ state.

After a short review of notation and coventions, we begin in §[\ref=sec-pres] by giving presentations of [formula] and [formula] in terms of a unitary repesentation u of [formula] and an isometry v which, loosely, implements the action αA. Then in §[\ref=sec-charKMS], we characterise the KMS states of [formula] in terms of their behaviour with respect to the presentation in §[\ref=sec-pres].

We then set about proving Theorem [\ref=summary] in stages, and we give more precise formulations of our results as we go. For example, we prove part (c) in §[\ref=sec-Exelcp], and we prove a little more than we stated above: we only need to assume that A is a dilation matrix to get uniqueness of the KMSlog | det A| state. In §[\ref=sec-existence], we prove existence of lots of KMS states (see Proposition [\ref=existforbeta>1]); a novelty in our construction is the use of induced representations to build Hilbert spaces where we can construct KMS states from vector states. Then in §[\ref=sec-par], we prove that we have found all the KMSβ states for β  >   log | det A|. In §[\ref=sec-ground], we prove part (d).

Theorem [\ref=summary] and our strategy for proving it were motivated by our previous work in [\cite=lr], or more precisely, by what it says about the KMS states of the additive boundary quotient [formula] of the Toeplitz algebra [formula] (see [\cite=BaHLR]). The connection with Exel crossed products is made in [\cite=BaHLR], where it is shown that there is an Exel system [formula] of the kind studied in [\cite=l] whose Nica-Toeplitz crossed product [formula] is [formula] and whose Exel crossed product [formula] is the Crisp-Laca boundary quotient of [formula] (or in other words, Cuntz's [formula] [\cite=c2]). So our present analysis differs from that in [\cite=lr] in that we have raised the dimension of the torus to d, but have replaced [formula] by [formula]. The case d = 1, where A has the form (N), is in some sense an intersection of our results with those in [\cite=lr], and in §[\ref=BSsemigp] we carry out an analysis of the KMS states on [formula] parallel to that in [\cite=BaHLR].

We close in §[\ref=sec-gpalgs] with a discussion of the case where A is invertible over [formula]. The endomorphism αA is then an automorphism, and [formula] is the usual crossed product [formula], which can also be viewed as a group algebra [formula]. We know from §[\ref=sec-Exelcp] that there can only be KMSβ states when β  =   log | det A| = 0, so we are left to determine the invariant traces, which we do in Proposition [\ref=invtr]. When [formula] is the integer Heisenberg group, for example, we can find lots of invariant traces.

Notation and coventions

Integer matrices.

Throughout this paper A is a matrix in [formula] whose determinant det A is nonzero. If the eigenvalues λ of [formula] all satisfy |λ| > 1, then we call A a dilation matrix. This was a standing assumption in [\cite=ehr], but here we do not in general assume that A is a dilation matrix. We use multiindex notation, so that [formula] for [formula], and the covering map [formula] is characterised by σA(e2πix) = e2πiAx for [formula]. Since the transpose At appears more often than A, we write B: = At; we have tried to avoid using the letters A and B for anything else. We choose a set Σ of coset representatives for [formula], and assume for convenience that 0∈Σ. We sometimes write N for | det A| = | det B|.

Hilbert bimodules

A bimodule M over a C*-algebra C is a right-Hilbert bimodule if it is a right Hilbert C-module, and if the left action of C is implemented by a homomorphism φ of C into the C*-algebra L(M) of adjointable operators. (Such bimodules are also called "correspondences" over C, or just "Hilbert bimodules" for short.) Our C*-algebras will always have identities, and our bimodules are always essential in the sense that φ:C  →  L(M) is unital.

A representation (ψ,π) of a Hilbert bimodule M in a C*-algebra D consists of a linear map ψ:M  →  D and a unital representation π:C  →  D such that

[formula]

Every Hilbert bimodule M has a Toeplitz algebra T(M), which is generated by a universal representation (iM,iC).

Every representation (ψ,π) of M in D induces a representation (ψ,π)(1):K(M)  →  D such that (ψ,π)(1)(Θm,n) = ψ(m)ψ(n)* (see [\cite=p] or [\cite=fr]). The representation (ψ,π) is Cuntz-Pimsner covariant if

[formula]

The Cuntz-Pimsner algebra O(M) is the quotient of T(M) that is universal for Cuntz-Pimsner covariant representations. We write Q:T(M)  →  O(M) for the quotient map, and [formula] for the universal Cuntz-Pimser covariant representation in O(M). (Though there are several different definitions of Cuntz-Pimsner covariance out there, they all coincide for the bimodules in this paper.)

Exel crossed products

An Exel system consists of an endomorphism α of a C*-algebra C, and a transfer operator L for α, which is a bounded positive linear map L:C  →  C such that L(α(c)d) = cL(d). The examples of interest here are the systems [formula] discussed in the introduction, where αA is the endomorphism [formula] associated to an integer matrix A, and L is defined by averaging over inverse images of points, as in [\eqref=defL]. Notice that both α and L are unital.

Every Exel system (C,α,L) gives rise to a Hilbert bimodule over C as follows. We first make a copy CL of C into a bimodule over C by setting c  ·  m = cm and m  ·  c = mα(c) for m∈CL and c∈C. The formula 〈m,n〉: = L(m*n) carries a C-valued pre-inner product on CL, and completing CL gives a right Hilbert C-module ML. Because L is bounded, the left action of C extends to an action of C by adjointable operators on the completion ML. (The details are in [\cite=br].) In general the completion process involves modding out by vectors of length zero, so that the quotient carries a C-valued inner product. However, for the systems [formula], the module [formula] has no vectors of length zero and is already complete (see [\cite=LR2]). So we dispense with the quotient maps q:CL  →  ML which were used in [\cite=br] to distinguish between elements of the algebra and elements of the bimodule.

For an Exel system (C,α,L), we define the Toeplitz algebra T(C,α,L) to be T(ML), and the Exel crossed product [formula] to be the Cuntz-Pimsner algebra O(ML). This is not quite Exel's original definition [\cite=e1], but for the systems [formula] of interest to us it is equivalent. (The precise relationship between Exel's crossed product and Cuntz-Pimsner algebras is worked out in [\cite=br].) So [formula] and [formula] are generated by universal representations [formula] and [formula].

KMS states

Suppose that σ is an action of [formula] by automorphisms of a C*-algebra C. An element c of C is analytic if t  ↦  σt(c) is the restriction of an entire function. A state φ of C is a KMS state at inverse temperature β∈(0,  ∞  ) if there is a set S of analytic elements such that [formula] is dense in C and

[formula]

In [\cite=lr], we were careful to explain why this definition is equivalent to that used in the standard sources [\cite=bra-rob] and [\cite=ped]. We also adopt two more recent conventions which are possibly nonstandard. First, we regard the KMS0 states to be the σ-invariant traces; this agrees with the convention in [\cite=ped] rather than the one in [\cite=bra-rob]. Second, we use the conventions of Connes and Marcolli [\cite=cm], which distinguish between the KMS∞ states (those which are weak* limits of KMSβ states as β  →    ∞  ) and the ground states (those such that z  ↦  φ(cσz(d)) is bounded on the upper half-plane). Neither [\cite=bra-rob] nor [\cite=ped] makes this distinction.

A presentation

We describe a presentation of the Toeplitz algebra T(ML) like that of [formula] in [\cite=lr], or, more precisely, like that of the additive boundary quotient [formula] in [\cite=BaHLR].

Suppose that [formula] has [formula], and consider the Exel system [formula]. Then the Toeplitz algebra T(ML) is the universal C*-algebra generated by a unitary representation [formula] and an isometry v∈T(ML) satisfying

vum = uBmv, and

[formula]

If U is a unitary representation of [formula] in a C*-algebra C and V∈C is an isometry satisfying and , then the corresponding representation (ψ,π) of ML satisfies Um  =  π(γm) and V = ψ(1).

It might be helpful to see how our presentation is related to the presentation of [formula] in [\cite=BaHLR]. The isometries {vp:p∈P} have become the single isometry v, and the additive generator s has been replaced by the unitary representation u of the additive group [formula]. The relations (T2) and (T3) in [\cite=BaHLR] are not needed because here "we only have one prime" (which we will normalise to e when we define our dynamics!), and the relation (Q6) in [\cite=BaHLR] is replaced by the assumption that u is a unitary representation. So we are left with (T1) and (T5), which are analogous to (E1) and (E2) respectively.

The relation (E2) implies that {umv:m∈Σ} is a Toeplitz-Cuntz family. The analogue of the relation (Q5) used in [\cite=lr] and [\cite=BaHLR] is the Cuntz relation

[formula],

which is satisfied in the Cuntz-Pimsner algebra O(ML) (see Proposition [\ref=CPquotient] below).

The Toeplitz algebra T(ML) is generated by a universal representation [formula]. It is shown in [\cite=br] that T(ML) is generated by the range of [formula] and the single element S: = iML(1), that [formula] is a Toeplitz-covariant representation in the sense of [\cite=br], and that [formula] is universal for Toeplitz-covariant representations (ρ,V) satisfying

Vρ(a) = ρ(αA(a))V, and

V*ρ(a)V = ρ(L(a)).

In our system L(1) = 1, and (TC2) implies that the operator V is an isometry.

The Stone-Weierstrass theorem implies that the characters γm:z  ↦  zm of [formula] span a dense *  -subalgebra of [formula], and a representation ρ of [formula] is completely determined by the unitary representation u:m  ↦  ρ(γm) of [formula]. One checks that αA(γm) = γBm, so (TC1) is equivalent to (E1). We will complete the proof by showing that (TC2) is equivalent to (E2).

To see what (TC2) says about the um, we need to compute L(γm). For any [formula] and [formula], we can compute L(f)(z) by choosing one solution w0 of σA(w) = z, such as w0 = e2πiA- 1x, and computing

[formula]

and hence

[formula]

If [formula] is not the identity character, then [formula] is a nontrivial subgroup of [formula], the sum is zero, and L(γm) = 0. So [formula], and for such m, L(γm)(e2πix) = γm(e2πiA- 1x) = γB- 1m(e2πix). Now

[formula]

Thus

[formula]

and using this we can see that (TC2) is equivalent to (E2).

For the last comment, recall from [\cite=br] that the representation (ψ,π) corresponding to the Toeplitz-covariant representation (ρ,V) in the above argument is characterised by π  =  ρ and V = ψ(1), and that ρ satisfies ρ(γm) = um.

We now want an analogous presentation of O(ML). To help keep things straight later, we write [formula] and : = Q(v).

Suppose that [formula] has [formula], and consider the Exel system [formula]. Then the Cuntz-Pimsner algebra O(ML) is the universal C*-algebra generated by a unitary representation [formula] and an isometry ∈O(ML) satisfying , and .

We need to prove that the unitary representation ū and the isometry [formula] satisfy (E1-3) and are universal for families satisfying these relations. They satisfy (E1) and (E2) because u and v do. To see that they satisfy (E3), note that the unitary um in Proposition [\ref=presadd] is [formula] and the isometry v is iML(1). We know from [\cite=ehr] that {γm:m∈Σ} is an orthonormal basis for ML, so Lemma 2.5 of [\cite=ehr] says that a representation (ψ,π) is Cuntz-Pimsner covariant if and only if

[formula]

Since γm  =  γm  ·  1 in ML, we have

[formula]

and Equation [\eqref=CPcovgeneral] for [formula] reduces to (E3) for [formula] and Q(v).

Next suppose that Um and V satisfy (E1), (E2) and (E3). Then Proposition [\ref=presadd] gives a representation (ψ,π) of ML such that Um  =  π(γm) and V = ψ(1), and, in view of [\eqref=checkCP], (E3) implies that ψ satisfies Equation [\eqref=CPcovgeneral]. Thus (ψ,π) is Cuntz-Pimsner covariant, and hence factors through a representation of O(ML), and this representation takes ūm = Q(um) to Um and  = Q(v) to V because ψ  ×  π takes um to Um and v to V.

Next we want a convenient spanning family to do calculations with. Again, we are looking for something similar to what we used in [\cite=lr].

In T(ML) we have

[formula]

We compute, using first (E2) and then (E1), to get

[formula]

as required.

We have

[formula]

Equation [\eqref=alternatives] implies that [formula] is a *  -algebra, and it contains all the generators of T(ML).

Since u is a unitary representation, we have u*n = u- n, and the * in u*n in [\eqref=spanningset] is technically redundant. We have retained the * to emphasise the parallels between this situation and the one in [\cite=lr]. It also makes formulas more symmetric, and this sometimes simplifies calculations.

A characterisation of KMS states

The gauge action [formula] is characterised by γz(iML(x)) = ziML(x) and [formula], or equivalently by γz(v) = zv and γz(um) = um. Our dynamics [formula] is defined in terms of the gauge action by σt  =  γeit. Then we have which since z  ↦  eiz(k - l) is entire implies that the spanning elements umvkv* lu*n are all analytic elements. Thus a state φ on T(ML) is a KMSβ state for σ if and only if

[formula]

for all [formula] and [formula].

The next result is an analogue of [\cite=lr].

The system (T(ML),σ) has no KMSβ states for β  <   log | det A|. For β  ≥   log | det A|, a state φ of T(ML) is a KMSβ state if and only if

[formula]

Suppose that φ is a KMSβ state on (T(ML),σ). Then for every [formula], we have

[formula]

Since {umv:m∈Σ} is a Toeplitz-Cuntz family with | det A| elements, we have

[formula]

Thus eβ  ≥  | det A|, and β  ≥   log | det A|.

Next we verify that φ satisfies [\eqref=charKMS]. Applying the KMS condition twice gives

[formula]

Since β  ≥   log | det A| > 0, this implies that φ(umvkv* lu*n) = 0 unless k = l. For k = l we have

[formula]

From k applications of (E2), we see that

[formula]

and [\eqref=calcphi] implies [\eqref=charKMS].

Now we suppose that φ is a state of T(ML) satisfying [\eqref=charKMS], and aim to prove that φ is a KMSβ state by verifying [\eqref=defKMSbeta]. There is a certain amount of symmetry to the two nonzero alternatives in formula [\eqref=alternatives], so we may as well assume that i  ≥  l and [formula]. Then [\eqref=alternatives] and [\eqref=charKMS] imply that [formula] is

[formula]

The right-hand side of [\eqref=defKMSbeta] also vanishes unless k + i - l = j, so we assume this from now on. Rewriting this equation as k - j = l - i shows that our assumption i  ≥  l is equivalent to k  ≤  j. Thus when we calculate the right-hand side of [\eqref=defKMSbeta], the second alternative in [\eqref=alternatives] comes into play:

[formula]

Multiplying this by e- (k - l)β gives the right-hand side of [\eqref=defKMSbeta], and in view of the equation k + i - l = j, it follows that the right-hand side of [\eqref=defKMSbeta] is

[formula]

Since

[formula]

we have

[formula]

so the numbers arising on the two sides of [\eqref=defKMSbeta] are the same, and it remains to check that the conditions for nonvanishing are equivalent. So we need to check that

[formula]

Suppose that the first set of conditions holds. Then q - m belongs to the coset [formula], which is contained in [formula] because k  ≤  j and B- l(p - n) is in [formula], and

[formula]

belongs to [formula]. So the forward implication holds, and similar arguments prove the converse. We have now proved [\eqref=defKMSbeta], and thus φ is a KMSβ state.

KMS states for β  =   log | det A|.

We begin by showing that the Exel crossed product has very few KMS states.

If φ is a KMSβ state on (O(ML),σ), then β  =   log | det A|.

We compute using the relation (E3) and the KMS condition:

[formula]

since [formula].

Every KMSlog N state of (T(ML),σ) factors through the quotient map Q of T(ML) onto O(ML).

Suppose that φ is a KMSlog N state of (T(ML),σ). The formula [\eqref=charKMS] implies that φ(umvv*u*m) = N- 1, and hence

[formula]

Now the argument of [\cite=lr] implies that φ vanishes on the ideal generated by [formula]. But Proposition [\ref=CPquotient] says that this ideal is the kernel of Q, and the result follows.

The next result was first obtained by Ted Boey as an application of the general theory in [\cite=ln].

Suppose that [formula] has [formula]. Then there is a KMSlog N state φ of (O(ML),σ) such that

[formula]

If A is a dilation matrix, then this is the only KMS state of (O(ML),σ).

We will construct the state by factoring through an expectation onto the commutative subalgebra spanned by the range projections of the generators.

Suppose that [formula] has nonzero determinant. Then there is an expectation E of O(ML) onto

[formula]

such that

[formula]

We prove this by averaging over a dual coaction, following a line of argument used in [\cite=lr1] and [\cite=lr] (and this explains the notation O(ML)δ). We will later give a second proof which avoids the use of coactions.

The Baumslag-Solitar group [formula] is the semidirect product of the additive subgroup [formula] of [formula] by the action of [formula] by powers of B. We write ε for the canonical unitary representation of [formula] in [formula], so that in particular

[formula]

These identities imply that [formula] and [formula] satisfy the relations (E1), (E2) and (E3), and hence give a homomorphism δ: = πU,V of O(ML) into [formula]. One can check on generators that δ is a coaction of [formula] on O(ML). Since [formula] is amenable, averaging over this coaction gives an expectation E of O(ML) onto the fixed-point algebra

[formula]

(see [\cite=lr1]). Since

[formula]

ūmk* lū*n belongs to the fixed-point algebra if and only if (m,k) = (n,l), and thus E satisfies [\eqref=defexpect]. Since E is norm-decreasing, and the ūmk* lū*n span a dense subspace of O(ML), [\eqref=defexpect] implies [\eqref=fpa].

The coaction-free proof of Lemma [\ref=existexpect] involves averaging twice over actions of abelian groups. Averaging over the gauge action [formula] gives an expectation Eγ onto the fixed-point algebra O(ML)γ; since this expectation is continuous and kills elements ūmk* lū*n with [formula], we have

[formula]

For this proof of Lemma [\ref=existexpect], we need to analyse the structure of O(ML)γ, and since we'll use this analysis elsewhere in the proof of Theorem [\ref=betalogN], we might as well do it properly now. As a point of notation, we write

[formula]

and observe that Σk is a set of coset representatives for [formula].

For each k  ≥  1, we set

[formula]

Then the Ck are C*-subalgebras of O(ML)γ satisfying Ck  ⊂  Ck + 1 and [formula].

For each k  ≥  1, {ekm,n: = ūmk* kū*n:m,n∈Σk} is a set of nonzero matrix units which spans a matrix algebra [formula]. The respresentation ū of [formula] in O(ML) maps [formula] into Ck, and every ūBkm belongs to the commutant of [formula] in Ck.

The inclusion ιk of [formula] in O(ML)γ and the integrated form πū,k of [formula] give an isomorphism [formula] of [formula] onto Ck which carries [formula] into ūm + Bkpk* kū*n.

Calculations using the relations (E1) and (E2) show that

[formula]

which implies that Ck is a C*-subalgebra. The Cuntz relation (E3) implies that

[formula]

which in view of the definition of Σk + 1 implies that Ck  ⊂  Ck + 1. Now [formula] follows from [\eqref=gaugefpa], and we have proved (a).

Since {Sm: = ūm:m∈Σ} is a Cuntz family, for each fixed k the products [formula] form a Cuntz family; since

[formula]

this Cuntz family is precisely {ūmk:m∈Σk}, and it follows that the ekm,n are nonzero matrix units. The relation (E1) implies that ūBkp commutes with every ekm,n, which gives (b).

Since the representation of [formula] in [formula] is faithful, and since [formula] is injective (by [\cite=br], for example), πū,k is injective, and hence so is the representation [formula] of [formula]. It is surjective because every [formula] can be written uniquely as m' + Bkm'' for some m'∈Σk, and then

[formula]

is in Ck because each matrix unit and each ūBkm'' are. To see the last assertion about what [formula] does to [formula], recall that the representation [formula] of a tensor product [formula] coming from commuting representations φ of C and ψ of D takes [formula] to φ(c)ψ(d) = ψ(d)φ(c) (see [\cite=tfb], for example).

There is a continuous action τ of [formula] on O(ML)γ such that

[formula]

There is a continuous action η of [formula] on [formula] such that ηz(ekm,n) = zm - nekm,n -- indeed, ηz is conjugation by the unitary [formula]. Lifting the dual action of [formula] to [formula] gives an action ζ of [formula] on [formula] which multiplies the generator εBkm by zBkm. Pulling the action [formula] on [formula] over to O(ML)γ under the isomorphism of Proposition [\ref=analcore](c) gives an action τk on Ck which satisfies [\eqref=deftau] (for fixed k). A calculation using the Cuntz relation (E3) shows that the automorphisms τkz combine to give an automorphism τz of [formula], which is isometric because each τkz is, and hence extends to an automorphism of O(ML)γ. Continuity follows from the continuity of scalar multiplication.

Averaging over the action τ of Corollary [\ref=2ndaction] gives an expectation Eτ of O(ML)γ onto O(ML)δ, and [formula] has the required properties.

The description of O(ML)δ in [\eqref=fpa] shows that each σt is the identity on O(ML)δ, so it suffices to find a trace τ on O(ML)δ such that τ(ūmk* kū*m) = N- k, and then Proposition [\ref=charKMSbeta] implies that [formula] is a KMSlog N state on (O(ML),σ).

We can write each [formula] uniquely as m' + Bkm'' for some m'∈Σk, and then part (b) of Proposition [\ref=analcore] implies that

[formula]

Now part (a) of Proposition [\ref=analcore] implies that

[formula]

is a finite-dimensional commutative C*-algebra, and that Dk has a normalised trace τk satisfying τk(ūmk* kū*m) = N- k. The Cuntz relation (E3) implies that Dk  ⊂  Dk + 1, and the normalised traces τk combine to give a trace τ on [formula] such that τ(ūmk* kū*m) = N- k. Then, as foreshadowed above, [formula] is a KMSlog N state on (O(ML),σ) satisfying [\eqref=KMSlogN].

For the proof of uniqueness, we need a standard fact about dilation matrices.

If B is an integer dilation matrix, then [formula].

Suppose that [formula]. Then B- km belongs to [formula] for every k, and since we know from [\cite=ehr], for example, that [formula] as k  →    ∞  , we must have Bkm = 0 for large k, and m = 0.

Suppose that φ is a KMS state of (O(ML),σ). Proposition [\ref=onlybeta] implies that φ has inverse temperature β  =   log N. We need to prove that φ satisfies [\eqref=KMSlogN], and comparing [\eqref=KMSlogN] with [\eqref=charKMS] (which we know holds with e- kβ = N- k) shows that we need to prove that φ(ūn) = 0 for all nonzero n. So suppose [formula] and [formula]. Lemma [\ref=dilpure] implies that there is a smallest integer k such that n does not belong to [formula]. Then, recalling from the proof of existence that {ūmk:m∈Σk} is a Cuntz family in O(ML), we have

[formula]

which vanishes by [\eqref=charKMS] because (n + m) - m = n is not in [formula] for every m.

It seems to be quite easy to find representations of O(ML), and we describe an interesting one in the following example (which was one of our reasons for becoming interested in the C*-algebras associated to dilation matrices in the first place [\cite=ehr]). However, it does not seem to be so easy to find natural Hilbert space representations of O(ML) in which the KMSlog | det A| state is a vector state.

The operators V and Um on [formula] defined by

[formula]

satisfy (E1-3), and hence give a representation of O(ML) on [formula]. The Cuntz family {UmV:m∈Σ} is one of the sort studied by Bratteli and Jorgensen in the context of wavelets [\cite=bj], or more precisely, one of the more general sort studied in [\cite=aijln].

To make the connection, note that the characters {γn:n∈Σ} form an orthonormal basis for the right Hilbert module ML, or what is called in [\cite=aijln] a "filter bank for dilation by A". It is shown in [\cite=aijln] that any filter bank {mi:0  ≤  i < N} gives rise to a Cuntz family Si: = M(mi)V, where M(f) is the operator of multiplication by [formula]. In the construction of wavelets, the more interesting filter banks are those in which m0 is "low-pass", which implies in particular that m0(1) = N1 / 2 and mi(1) = 0 for i > 0 (see [\cite=aijln]); the filters γn satisfy [formula], and hence are "all-pass".

Exel has previously studied KMS states on Exel crossed products [\cite=e2], and we now reconcile our result with his [\cite=e2]. The situation in [\cite=e2] is more general than ours, but applies with h = e1 and [formula], which is easily seen to be an expectation of [formula] onto the range of α; since our orthonormal basis for ML is a quasi-basis, E has finite type with index N: = | det A| (strictly speaking, [formula] is the element N1 of [formula]). Exel proved in [\cite=e2] that there is an expectation [formula] such that G(ūmk* lū*n) = δk,lN- kūmū*n; in our situation, it is quite easy to check directly that G is given by first averaging over the gauge action γ, and then combining the expectations Gk on [formula] defined by [formula] to get G on [formula] (see [\cite=ev]). Then [\cite=e2] implies that the KMSβ states on [formula] have the form [formula], where φ is a trace on [formula] satisfying φ(f) = e-  βNφ(L(f)) for [formula].

Traces on [formula] are given by measures μ, and Exel's condition says that μ satisfies

[formula]

It follows from [\cite=aijln], for example, that the Haar measure λ on [formula] satisfies [\eqref=Exelschar] with 1 = e-  βN, and since [formula] is the image of the function zn in [formula], the corresponding KMSlog N state ψ on [formula] satisfies

[formula]

Thus Exel's result also gives the KMSlog N state described in Theorem [\ref=betalogN], even though his state was obtained by factoring through a different expectation on [formula].

Existence of KMS states for β  >   log | det A|.

Our goal here is to prove the existence of KMSβ states for β  >   log | det A|. Note that, when A is a dilation matrix, Lemma [\ref=dilpure] implies that the sum on the right-hand side of [\eqref=formpsibetamu] is finite.

Suppose that [formula] satisfies [formula] and that β  >   log | det A|. Then for each probability measure μ on [formula], there is a KMSβ state ψ  =  ψβ,μ of (T(ML),σ) such that ψ(umvkv* lu*n) vanishes unless k = l and [formula], and

[formula]

when k = l and [formula].

We use the representation M of [formula] by multiplication operators on [formula], and use the same notation for the corresponding unitary representation of [formula], so that Mm: = M(γm). For each [formula], we have a unitary representation [formula] of the subgroup [formula] of [formula], and we denote by Hj the Hilbert space of the induced representation [formula]. Our state ψβ,μ will be built from vector states for a representation πμ of T(ML) on [formula].

We will need to do some calculations in the Hilbert spaces Hj, and for this it is convenient to use the sets Σj described in [\eqref=defSigmak]; for [formula], we write cj(g) for the element of Σj such that cj(g)∈g. Then (from [\cite=tfb], for example) Hj is the completion of the space

[formula]

in the inner product defined by

[formula]

(Although we have used the cross-section cj to get a useful formula for the inner product, the translation condition on ξ and η means that this inner product does not depend on the choice of cj.) Then the induced representation acts on Hj by

[formula]

We now take U to be the unitary representation of [formula] on Hμ defined by

[formula]

For each j  ≥  0 and ξ∈Hj, we define

[formula]

a quick calculation shows that Vjξ belongs to Hj + 1. The Vj combine to give an isometry V on [formula], and the adjoint V* is given on Hj + 1 by the formula (V*ξ)(n) = ξ(Bn). Calculations show that the pair (U,V) satisfies (E1) and (E2), and hence there is a representation πμ of T(ML) on Hμ such that πμ(um) = Um and πμ(v) = V.

We now let e0,0 be the constant function 1 viewed as a unit vector in [formula]. For [formula] and [formula], we define ej,g: = Ucj(g)Vje0,0, so that for each j,

[formula]

is an orthonormal set of | det B|j = | det A|j vectors in Hj. We view them as elements of Hμ by adding 0s in the other summands. Inspired by the proof of [\cite=lr], we define

[formula]

Summing the geometric series [formula] shows that this series converges in norm in T(ML)*, and that the sum is a state ψ of T(ML).

Next we fix [formula] and [formula], and verify the formula for ψ(umvkv* lu*n). Then

[formula]

belongs to Hj - l, and hence

[formula]

We now recall that Hj - k is the Hilbert space of the representation [formula], and hence

[formula]

The h-summand vanishes unless both

[formula]

As a function in the Hilbert space

[formula]

e0,0 satisfies e0,0(q)(z) = z- q, and (Vje0,0)(Bjq)(z) = e0,0(q)(z) = z- q. Thus, when both criteria in [\eqref=condsongh] are satisfied, we have

[formula]

(Notice that when [\eqref=condsongh] holds, we have [formula], so the last integral makes sense.) For each pair m,n such that m - n is in [formula], and each h in [formula], there is exactly one g such that [\eqref=condsongh] holds. Thus, using [\eqref=formforip2] to view

[formula]

as a sum over [formula] and [formula], we find that [\eqref=collapsiblesum] has exactly

[formula]

nonzero terms, each of which is equal to [\eqref=calcip]. Thus ψ(umvkv* lu*n) vanishes unless k = l and [formula], and then equals

[formula]

as stated in the Proposition.

We still need to prove that ψ is a KMSβ state, and we will do this using Proposition [\ref=charKMSbeta]. So we need to compute e- kβψ(uB- k(m - n)) under the assumption that [formula]. We have already done most of the work: the calculation [\eqref=calcip1] shows that

[formula]

which reduces to [\eqref=ansforpsi] on writing j = j' + k. Thus Proposition [\ref=charKMSbeta] implies that ψ is a KMSβ state, and this completes the proof of Proposition [\ref=existforbeta>1].

Parametrisation of KMSβ states

Suppose that [formula] has nonzero determinant and β  >   log | det A|. Then the map μ  ↦  ψβ,μ of Proposition [\ref=existforbeta>1] is an affine homeomorphism of the simplex [formula] of probability measures onto the simplex of KMSβ states for (T(ML),σ).

As in [\cite=lr], the crux of the argument is a reconstruction formula which allows us to recover a KMSβ state from its "conditioning" φP to a corner PT(ML)P. In the present situation, though, the projection

[formula]

belongs to T(ML), so we don't need to resort to spatial arguments to make sense of the conditioning: we can just define

[formula]

and then since φ(uc(g)vv*u*c(g)) = e-  β, the normalising factor ensures that φP is a state of T(ML). We can now state our reconstruction formula.

Suppose that β  >   log | det A|, and that φ is a KMSβ state on T(ML). Then for every a∈T(ML) we have

[formula]

Convergence of the limit in Proposition [\ref=reconstruct] will follow from the following simple lemma:

Suppose that φ is a state of a unital C*-algebra A, and that {pn} is a sequence of projections in A such that φ(pn)  →  1. Then φ(pnapn)  →  φ(a) for every a∈A.

We know that φ(1 - pn) = 1 - φ(pn)  →  0, so the Cauchy-Schwarz inequality for φ implies that φ(a(1 - pn))  →  0 for all a∈A. Another application of the Cauchy-Schwarz inequality shows that φ(pna(1 - pn))  →  0 also, so

[formula]

When we apply Lemma [\ref=approxstate], the projections pn will be sums of the projections in the next proposition.

For [formula] and [formula] we define

[formula]

Then the Pj,g are mutually orthogonal projections in T(ML).

The proposition follows from the next lemma.

For each pair (j,g) and (l,h) we have

[formula]

If [formula], say j < l, then for [formula] we have

[formula]

Now every [formula] (including n = B- jm) has the form n = c(n) + Bk, so

[formula]

which vanishes because P contains the factor (1 - uc(n)vv*u*c(n)). So Pv* jumvlP vanishes when [formula], and for j = l, Pv* jucj(h) - cj(g)vjP vanishes unless cj(h) - cj(g) belongs to [formula], which occurs precisely when g = h in [formula].

We aim to apply Lemma [\ref=approxstate] with

[formula]

which is a projection by Proposition [\ref=Psorthog]. So we need to compute φ(pn), which we do using the KMS condition:

[formula]

which on summing the geometric series converges to 1 as n  →    ∞  . So Lemma [\ref=approxstate] implies that for every a∈T(ML), we have

[formula]

Applying the KMS condition shows that this sum is

[formula]

and it follows from Lemma [\ref=calcorthog] that the summands are zero unless j = l and g = h, in which case the right-hand factor Pv* lu*cl(h)ucj(g)vjP collapses to P, and we recover the desired formula [\eqref=reconform].

The formula [\eqref=formpsibetamu] for ψβ,μ shows that μ  ↦  ψβ,μ is affine and weak* continuous, and both sets of states are weak* compact, so it suffices to show that μ  ↦  ψβ,μ is surjective and one-to-one.

To see that μ  ↦  ψβ,μ is surjective, suppose that φ is a KMSβ state of T(ML). On [formula], the conditioned state φP is given by a probability measure μ; we choose μ such that

[formula]

and aim to prove that φ  =  ψβ,μ. Since both states are KMSβ states, formula [\eqref=charKMS] shows that it suffices to check that φ(um) = ψβ,μ(um). Since [formula] is abelian, the reconstruction formula [\eqref=reconform] implies that

[formula]

which by [\eqref=formpsibetamu] is precisely ψβ,μ(um). We have now proved surjectivity.

To see that our map is one-to-one, suppose that μ and ν are probability measures on [formula] and ψβ,μ  =  ψβ,ν. Write Mμ(n) for the nth moment [formula] of μ, and fix [formula]. Two applications of [\eqref=formpsibetamu] show that

[formula]

The left-hand side of [\eqref=equatemoments] can be rewritten as

[formula]

which by [\eqref=formpsibetamu] is

[formula]

If m is not in [formula], then [\eqref=equatemoments] says precisely that Mμ(m) = Mν(m); if [formula], then, since ψβ,μ(uB- 1m) = ψβ,ν(uB- 1m), subtracting | det A|e-  βψβ,μ(uB- 1m) from both sides of [\eqref=equatemoments] shows that Mμ(m) = Mν(m). Thus μ and ν have the same moments, and are therefore equal.

Limits of KMS states

Proposition [\ref=parametrisation] describes all the KMSβ states for β  >  βc: =  log | det A|, and Theorem [\ref=betalogN] says there is exactly one KMSβc state when A is a dilation matrix. So it is natural to ask what we can say about the KMSβc states when A is not a dilation matrix. General results from [\cite=bra-rob] suggest that we might be able to find other KMSβc states by taking limits of KMSβ states as β  →  βc from above.

Let [formula]. Then there is a decreasing sequence βn  →  βc such that {ψβn,μ} converges weak* to a state ψμ, and then ψμ is a KMSβc state of (T(ML),σ).

Choose any decreasing sequence converging to βc, and the weak* compactness of the state space implies that there is a subsequence {βn} such that {ψβn,μ} converges in the weak* topology. Now [\cite=bra-rob] implies that the limit ψμ is a KMSβc state, at least when βc > 0. When βc = 0, [\cite=bra-rob] only asserts that ψμ is a trace (because that is what being a KMS0 state means in [\cite=bra-rob]). However, KMSβ states for β > 0 are σ-invariant, and hence so is the limit. Thus ψμ is a KMS0 state in the sense we are using.

We now assume that A is not a dilation matrix, so that [formula] could be bigger than {0}. Suppose β  >  βc and write r = e- (β  -  βc). As in the last proof, we write Mμ(m) for the mth moment [formula]. Rearranging [\eqref=formpsibetamu] shows that ψβ,μ(umvkv* lu*n) vanishes unless k = l and [formula], and then equals

[formula]

So we want to compute the limit of [\eqref=formrewritten] as β  →  βc, in which case r  →  1 - . If m - n does not belong to [formula], then the sum in [\eqref=formrewritten] is finite, and since (1 - r)rj  →  0 as r  →  1 for each fixed j, [\eqref=formrewritten] converges to 0 as r  →  1. So it remains for us to compute the limit of [\eqref=formrewritten] when [formula]. Unfortunately, this seems to be a fairly delicate matter (see Remark [\ref=cantuseDCT] below), and the best we can do is illustrate the issues with some examples.

If μ is normalised Haar measure on [formula], then Mμ(0) = 1 and Mμ(m) = 0 for all other m. The series in [\eqref=formrewritten] is identically zero unless m = n, and then is geometric; summing it shows that

[formula]

Letting β  →  βc gives the state described in Theorem [\ref=betalogN].

If μ has the property that Mμ(m) = 1 for every [formula], then the series in [\eqref=formrewritten] is geometric whenever [formula]. Summing and letting β  →  βc shows that the limit ψμ satisfies

[formula]

The previous item (b) applies in particular to the point mass δ1 at the identity [formula] of [formula]. This shows that the KMSβc state in Theorem [\ref=betalogN] is unique if and only if [formula].

Consider the matrix [formula], for which [formula]. Then item (b) applies to any measure of the form ν  ×  δ1. Thus when A is not a dilation matrix, we expect there to be many KMSβc states besides the one in Theorem [\ref=betalogN].

We wonder whether every KMSβc state is a limit of KMSβ states. It is trivially the case in our examples when | det A| > 1, and in these examples it also works for βc = 0.

When βc = 0, we have to be careful to distinguish between traces (the KMS0 states in [\cite=bra-rob]) and the invariant traces (the KMS0 states in [\cite=ped]). Certainly any limit of KMSβ states will be invariant, so the answer to the previous question is trivially false with the definition in [\cite=bra-rob] if the algebra has traces which are not invariant. We give an example where this happens in Remark [\ref=tracesonHgp].

The obvious way to try to compute the limit of [\eqref=formrewritten] as r  →  1 -  is to evaluate it term-by-term. This amounts to pulling lim r  →  1 - through the infinite sum, and therefore requires the dominated convergence theorem. Write mj: = Mμ(B- (j + k)(m - n)). To apply the dominated convergence theorem, we need a convergent series [formula] such that 0  ≤  (1 - r)rj|mj|  ≤  aj (and we need to consider a sequence {rn}). We know |mj|  ≤  1. Calculus shows that [formula] occurs at j / (j + 1). So the best general estimate seems to be

[formula]

Taking aj to be the right-hand side and bj: = 1 / (j + 1), we have

[formula]

and the limit form of the comparison test implies that [formula] diverges.

So pulling the limit through the sum seems to be a nontrivial matter. Of course, it is really just as well we can't do this, since we know that [formula] as r  →  1 - , whereas the term-by-term calculation would give 0.

KMS∞ and ground states

Suppose that [formula] has nonzero determinant. Then for every probability measure μ on [formula], there is a KMS∞ state ψ∞  ,μ on (T(ML),σ) such that

[formula]

Every ground state of (T(ML),σ) has the form ψ∞  ,μ, and is in particular a KMS∞ state.

The proof of [\cite=lr] gives the following characterisation of ground states.

A state φ of T(ML) is a ground state for σ if and only if

[formula]

Choose a sequence {βi} such that βi  →    ∞  ; by passing to a subsequence, we may suppose that ψβi,μ converges in the weak* topology to a state ψ∞  ,μ, which is by definition a KMS∞ state. Next we verify the formula for ψ∞  ,μ. As β  →    ∞  , each summand in the right-hand side of [\eqref=formpsibetamu] with j > 0 goes to zero. Thus as i  →    ∞  , we have

[formula]

and hence φ∞  ,μ has the required form. (If A is not a dilation matrix, so that [formula] could contain nonzero elements, then the sum on the right-hand side of [\eqref=formpsibetamu] could have infinitely many nonzero terms, and calculating the limit as i  →    ∞   would require some analysis of the sort discussed in Remark [\ref=cantuseDCT].)

If φ is a ground state, then the restriction of φ to the range of [formula] is given by a probability measure μ, and then Lemma [\ref=charground] implies that φ  =  ψ∞  ,μ.

The Toeplitz algebra of the Baumslag-Solitar semigroup

We fix an integer N with N > 1, and consider the additive group [formula] of rational numbers of the form mN- l for [formula]. The Baumslag-Solitar group is the semidirect product [formula] with

[formula]

The semigroup semidirect product [formula] is a subsemigroup of [formula], and the pair [formula] is closely related to the pair [formula] studied in [\cite=lr]. Indeed, the map (r,k)  ↦  (r,Nk) of [formula] into [formula] carries [formula] into [formula]. The pair [formula] is also quasi-lattice ordered in the sense of Nica [\cite=n]. (One way to see this is via the embedding of [formula] in [formula]: we just need to check that if [formula] and (r,Nk) has an upper bound in [formula], then the least upper bound constructed in [\cite=lr] lies in [formula].) So [formula] also has a Toeplitz algebra [formula] which is universal for Nica covariant representations of [formula] [\cite=n] [\cite=lr1]. The Toeplitz algebra [formula] is a quotient of [formula] analogous to the additive boundary quotient of [formula] studied in [\cite=BaHLR]. We now discuss the KMS states on [formula], following the analysis of [\cite=BaHLR].

The Toeplitz algebra [formula] is generated by two isometries s = T(1,0) and v = T(0,1), and an argument like that of [\cite=lr] shows that [formula] is universal among C*-algebras generated by a pair of isometries S and V satisfying

VS  =  SNV,

S*V  =  SN - 1VS*, and

V*SkV  =  0 for 1  ≤  k  <  N.

We define [formula] to be the quotient of [formula] by the extra relation ss* = 1, [formula] to be the quotient by the relation [formula], and [formula] to be the quotient in which both extra relations hold, and which is therefore the analogue of Cuntz's [formula]. Thus we have the following commutative diagram of quotient maps:

[formula]

In [formula] the generator s becomes unitary, and (T4) is redundant. The unitary s generates a unitary representation [formula], and the relations (T1) and (T5) (taken together) are equivalent to (E1) and (E2) (taken together). Thus Proposition [\ref=presadd] implies that [formula] is our Toeplitz algebra T(ML). Proposition [\ref=CPquotient] implies that [formula] is the quotient O(ML) of T(ML). (When N = 2, O(ML) has been studied by Larsen and Li under the name Q2; see [\cite=LL].)

Since the presentation of [formula] is not affected by multiplying v by [formula], we can deduce from the presentation that there is an action [formula] such that γz(s) = s and γz(v) = zv. Inflating this action to [formula] gives a dynamics [formula] such that σt(s) = s and σt(v) = eitv. This action leaves the kernels of the quotient maps in the diagram [\eqref=commdiagBS] invariant, and hence induces actions (still denoted by σ) on all three quotients. On [formula] and [formula] we recover the actions on T(ML) and O(ML) that we have been studying, in the case where A is the 1  ×  1 matrix (N) and σA is the covering map z  ↦  zN of [formula]. So our results tell us about the KMS states of [formula] and [formula].

Just as in [\cite=lr], every KMSβ state of [formula] vanishes on the ideal generated by 1 - ss*, and hence comes from a KMSβ state of T(ML). So we know all the KMS states of [formula]. For ground states, though, there is a difference. As in [\cite=lr] (or Lemma [\ref=charground] above), a ground state of [formula] is determined by its values on C*(s), and we claim that the map φ  ↦  φ|C*(s) is an affine homeomorphism of the set of ground states onto the state space of [formula]. Indeed, we can deduce this from [\cite=lr], since Theorem 3.7 of [\cite=lr1] implies that [formula] embeds as the subalgebra C*(s,vN) of [formula], and the homeomorphism φ  ↦  φ|C*(s) factors through C*(s,vN).

We can sum up these results by saying that the system [formula] has a phase transition at inverse temperature β  =   log N, and a further phase transition (in the sense of Connes and Marcolli) at β  =    ∞  . We believe that this is the simplest known system which exhibits both these phenomena. As for the system in [\cite=lr], the circular symmetry at β  =   log N which disappears for β  >   log N is not apparently realised by an action of [formula] on [formula]. In [\cite=lr], though, this circular symmetry persists for β∈[1,2], as a result of the more complicated convergence issues for the series representations of the normalising factors.

Since we can view [formula] as a subsemigroup of [formula], it might be more natural to use the dynamics satisfying σt(v) = Nitv. If we do this, then the phase transition will occur at β = 1.

Integer matrices with determinant ±  1

When [formula] has | det A| = 1, the inverse A- 1 has integer entries (as the cofactor formula shows), the map σA is a homeomorphism, and αA is an automorphism. The inverse α- 1A is then a transfer operator for αA, so we have an Exel system [formula], and this system has a Toeplitz algebra and an Exel crossed product. One would guess that these C*-algebras must be related to the ordinary crossed product, and they are, but we have not seen this explicitly pointed out before.

Suppose that α is an automorphism of a unital C*-algebra C. Then

Exel's Toeplitz algebra T(C,α,α- 1) is the universal C*-algebra generated by an isometry v and a unital representation iC of C satisfying viC(c) = iC(α(c))v, and

the Exel crossed product [formula] is the universal C*-algebra generated by a unitary u and a unital representation jC of C satisfying jC(α(c)) = ujC(c)u*.

We know from [\cite=br] that T(C,α,α- 1) is universal for Toeplitz-covariant representations (ρ,V) satisfying two relations called (TC1) and (TC2) (see page ). As we observed earlier, plugging the identity 1 of C into (TC2) shows that V is an isometry. For our system (C,α,α- 1), (TC1) implies (TC2):

[formula]

and (a) follows.

To establish (b), notice first that φ(c)∈L(Mα- 1) is the rank-one operator Θc,1. The Cuntz-Pimsner algebra is generated by a universal Cuntz-Pimsner covariant representation (jMα- 1,jC), and then the isometry v in part (a) is v = jMα- 1(1). Cuntz-Pimsner covariance says that

[formula]

since c = c  ·  1, we have jMα- 1(c) = jC(c)jMα- 1(1),, and Cuntz-Pimsner covariance is equivalent to jC(c) = jC(c)vv*. This is equivalent to vv* = 1, so v is unitary, and now vjC(c) = jC(α(c))v is equivalent to jC(α(c)) = vjC(c)v*.

These universal properties immediately imply that our algebras are familiar objects:

Suppose that α is an automorphism of a unital C*-algebra C. Then the Exel crossed product [formula] is the usual crossed product [formula], and the Toeplitz algebra T(C,α,α- 1) is the crossed product [formula] introduced and studied by Murphy [\cite=m]. In both cases, the gauge action of [formula] is the dual action of [formula].

Although Mα- 1 is not the bimodule E considered by Pimsner in [\cite=p], the two are isomorphic; indeed, a  ↦  α(a) is a Hilbert-bimodule isomorphism of E onto Mα- 1. So the identity [formula] also follows from the assertion in [\cite=p].

We now return to the case of an integer matrix A with | det A| = 1, where Corollary [\ref=ordcp] identifies the Toeplitz algebra [formula] as a Murphy crossed product, and the Exel crossed product [formula] with the ordinary crossed product [formula]. We will be working primarily with the crossed product, so it is worth observing that the generator [formula] is now unitary, and hence we can simplify our presentation: we view [formula] as being generated by a unitary representation ū of [formula] and a unitary [formula] satisfying ūm*  =  ūBm, and then

[formula]

We can if we wish make the further identification of the crossed product [formula] with the group algebra [formula] of the semidirect product (using Proposition 3.11 of [\cite=tfb^2], for example).

As before, lifting the dual actions of [formula] gives actions σ of [formula] on [formula] and [formula] such that σt fixes the copies of [formula] and multiplies the additive generators by eit. Proposition [\ref=existforbeta>1] describes the KMSβ states of [formula] for β  >   log | det A| = 0. Since | det B| = 1, B is invertible over the integers, [formula] for all j, and the series in [\eqref=formpsibetamu] is infinite for every pair m, n. Thus for each [formula] there is a KMSβ state ψβ,μ on [formula] such that

[formula]

Indeed, the proof of Proposition [\ref=existforbeta>1] simplifies substantially in this case: with [formula] acting on [formula], V the unilateral shift on the same direct sum, and ej the constant function 1 in the jth summand and 0 elsewhere, we have

[formula]

Proposition [\ref=existforbeta>1] also shows that all the KMS0 states (that is, the invariant traces) on [formula] factor through traces of [formula]. Since the uniqueness assertion in Theorem [\ref=betalogN] does not apply, we might expect to find more than one.

Suppose that [formula] has | det A| = 1. If [formula] satisfies σ*Aμ  =  μ, then there is a σ-invariant trace ψμ on [formula] such that

[formula]

and every σ-invariant trace on [formula] has this form.

Since the action σ of [formula] is inflated from the dual action A of [formula], a state is invariant for σ if and only if it is invariant for A. So the following standard lemma is useful.

Suppose that [formula] is a strongly continuous action on a unital C*-algebra D and [formula] is the expectation onto the fixed-point algebra Dγ. Then a state φ of D is γ-invariant if and only if there is a state τ of Dγ such that [formula].

Suppose [formula]. Then the invariance of Haar measure implies that [formula], and hence [formula], so φ is invariant. Conversely, if φ is invariant, then

[formula]

so [formula]; since 1∈Dγ, φ|Dγ is a state.

With γ  =  A, the expectation Eγ is given by

[formula]

It follows easily that if θμ is the state on [formula] given by integration against [formula], then [formula] satisfies [\eqref=proppsimu]. Lemma [\ref=invstate] implies that every invariant state of [formula] has this form. So we need to show that ψμ is a trace if and only if μ is invariant under σ*A.

We compute

[formula]

and similarly the other way round. Thus ψμ is a trace if and only if

[formula]

or, equivalently, if and only if ψμ(ūm) = ψμ(ūBm) for all [formula]. But these are just the moments of μ, and a calculation shows that MBm(μ) = Mm(σ*Aμ). So we deduce that ψμ is a trace if and only if μ is invariant, as required.

When μ is invariant under σA, the moments Mμ(B- j(m - n)) appearing in [\eqref=psibeta] are all equal to Mμ(m - n). Thus the series on the right-hand side of [\eqref=psibeta] is geometric, and summing it shows that which converges to ψμ(Q(umvkv* lu*n)) = ψμ(ūm + Bk - lnk - l) as β  →  0. In view of Proposition [\ref=limitKMS], this gives an alternative proof that ψμ is an invariant trace.

When | det A| = 1, [formula] has many invariant traces.

The homeomorphism σA has many finite orbits -- indeed, the periodic points are dense in [formula]. (If the coordinates of [formula] have common denominator N, then the denominators of all the coordinates in all the Anr divide N too, and the pigeon-hole principle implies that e2πir is periodic.) But if [formula] has σnA(z) = z, then [formula] is an invariant measure.

Consider [formula], for which we have σA(w,z) = (w,wz). Let λ denote Haar measure on [formula] and let ν be a probability measure on [formula]. Then the product measure μ  =  ν  ×  λ is invariant for σA:

[formula]

The moments of μ are given by

[formula]

Thus Proposition [\ref=invtr] gives σ-invariant traces [formula] on [formula] such that

[formula]

When [formula] and μ  =  λ  ×  ν, we claim that the state ψβ,μ described in [\eqref=psibeta] converges as β  →  0 +  to the state of Theorem [\ref=betalogN], which for β  =   log | det A| = 0 vanishes on umvk unless (m,k) = (0,0) and satisfies ψ(u0) = 1. To see this, note that [formula], so [formula], and

[formula]

which vanishes unless m1 - n1 = j(m2 - n2). For m = n, we have Mμ(B- j(m - n)) = 1 for all j, and summing the series shows that ψβ,μ(unvkv* ku*n) = e- kβ  →  1 as β  →  0 for all k. If [formula] and m - n does not have the form (li,i), then ψβ,μ(umvkv* ku*n) = 0 for all k. If m - n = (li,i), then ψβ,μ(umvkv* ku*n) vanishes for k > l, and

[formula]

for k  ≤  l. So whenever [formula], we have ψβ,μ(umvkv* ku*n)  →  0 as β  →  0, and the limit is the state φ of Theorem [\ref=betalogN], as claimed. (Well, strictly speaking the limit is [formula].)

When [formula] and [formula], the map

[formula]

is an isomorphism of [formula] onto the integer Heisenberg group [formula]. (The crux is that [formula].) For θ∈[0,1], we view the rotation algebra Aθ as the universal C*-algebra generated by unitaries U,V satisfying VU = e2πiθUV, and then the unitary representation (m,k)  ↦  e2πim1θUm2Vk induces a surjection qθ of [formula] onto Aθ. (Indeed, the quotients Aθ are the fibres of a C*-bundle over [formula] which has [formula] as its algebra of continuous sections -- see [\cite=e], [\cite=ap] or [\cite=prae].)

Every rotation algebra Aθ has a trace τθ which kills Um2Vk unless m2 = 0 = k, and the composition [formula] is the invariant trace described in Example [\ref=tracesHgp] for ν the point mass at e2πiθ. When θ is irrational, τθ is the only trace on Aθ (see [\cite=dav], for example). When θ is rational, Aθ is a homogeneous C*-algebra with spectrum [formula] (by, for example, [\cite=dr]), and has other traces which give non-invariant traces of [formula]. For example, the matrices [formula] and [formula] are unitary and satisfy TS =  - ST, hence give a homomorphism [formula], and composing with the usual normalised trace [formula] gives a trace τ on A1 / 2 such that [formula]. Since T2 = 1, we have τ(V2) = τ(1) = 1, and since σt(v2) = e2itv2, τ(V2) = 1 implies that [formula] cannot be σ-invariant.

To explain where the other invariant traces in Example [\ref=tracesHgp] come from, we examine the structure of [formula] from another point of view. Consider the normal subgroup N of matrices [\eqref=defHgp] with k = m2 = 0, which is the centre of [formula], and which has quotient [formula] isomorphic to [formula] via (m,k)  ↦  (k,m2). Applying Theorem 4.1 of [\cite=prae2] to N gives a realisation of [formula] as a Busby-Smith twisted crossed product [formula]; identifying C*(N) with [formula] and ploughing through the formulas in [\cite=prae2] shows that β is the identity and the cocycle [formula] is given by

[formula]

Averaging over the dual action of [formula] gives an expectation [formula] whose range is the fixed-point algebra [formula], which we can pull over to an expectation E on [formula] such that

[formula]

A direct calculation shows that E has the tracial property E(ab) = E(ba) (E is a centre-valued trace on [formula] ), and the isomorphism of [formula] onto [formula] carries σ into t  ↦  (eit,1). Thus any state of the form [formula] is an invariant trace of [formula]. These are the traces described in Example [\ref=tracesHgp].