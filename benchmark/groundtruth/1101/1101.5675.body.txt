Lemma Fact Claim

Perfect Matchings in 4-uniform hypergraphs

Introduction and Notation

For graphs we follow the notation in [\cite=B1]. For a set T, we refer to all of its k-element subsets (k-sets for short) as [formula] and the number of such k-sets as [formula]. We say that H  =  (V(H),E(H)) is an r-uniform hypergraph or r-graph for short, where V(H) is the set of vertices and [formula] is a family of r-sets of V(H). When the graph referred to is clear from the context we will use V instead of V(H) and will identify H with E(H). For an r-graph H and a set [formula], the degree of D in H, deg H(D)  =   deg r(D) denotes the number of edges of H that contain D. For 1  ≤  d  ≤  r, let

[formula]

We say that [formula] is an r-partite r-graph, if there is a partition of V(H) into r sets, i.e. [formula] and every edge of H uses exactly one vertex from each Vi. We call it a balanced r-partite r-graph if all Vi's are of the same size. We say [formula] is a complete r-partite r-graph if every r-tuple that uses one vertex from each Vi belongs to E(H). We denote a complete balanced r-partite r-graph by K(r)(t), where t  =  |Vi|. For r = 3, we refer to the balanced 3-partite 3-graph H(V1,V2,V3), where |Vi| = 4 as a [formula] 3-graph. For an r-graph H, when A and B make a partition of V(H), for a vertex v∈A we denote by [formula] the number of (r - 1)-sets of B that make edges with v while [formula] is the sum of [formula] over all v∈A and [formula]. We denote by [formula], such an r-graph, when all edges use one vertex from A and r - 1 vertices from B. Similarly [formula] is an r-graph where A, B and C make a partition of V(H), and every edge in H uses one vertex each from A and B and r - 2 vertices from C. Degrees of vertices in A and B are similarly defined as above. The density of [formula] is

[formula]

When [formula] make a partition of V(H), for a vertex v∈A1 we denote by [formula] the number of edges in the r-partite r-graph induced by subsets [formula], and [formula] is the sum of [formula] over all v∈A1. Similarly

[formula]

An r-graph H on n vertices is η- dense if it has at least [formula] edges. We use the notation dr(H)  ≥  η to refer to an η- dense r-graph H. For U  ⊂  V, H|U is the restriction of H to U. For simplicity we refer to dr(H|U) as dr(U) and to E(H|U) as E(U). A matching in H is a set of disjoint edges of H and a perfect matching is a matching that contains all vertices. Moreover we will only deal with r-graphs on n vertices where n = rk for some integer k, we denote this by [formula]. Throughout the paper log  denotes the base 2 logarithm.

Let d,r and n be integers such that 1  ≤  d  <  r, and [formula]. Denote by md(r,n) the smallest integer m, such that every r-graph H on n vertices with δd(H)  ≥  m contains a perfect matching.

For graphs (r = 2), by the Dirac theorem on Hamiltonicity of graphs, it s easy to see that m1(2,n)  ≤  n / 2, and since the complete bipartite Kn / 2 - 1,n / 2 + 1 does not have a perfect matching we get m1(2,n)  =  n / 2. For r  ≥  3 and d  =  r - 1, it follows from a result of Rödl, Ruciski and Szemerédi on Hamiltonicity of r-graph [\cite=RRSz_HAM_ku_colDeg_approx] that mr - 1(r,n)  ≤  n / 2  +  o(n). Kühn and Osthus [\cite=KO_PM_ku_colDeg] improved this result to [formula]. This bound was further sharpened in [\cite=RRSz_PM_ku_colDeg] to mr - 1(r,n)  ≤  n / 2  +  C log n. In [\cite=RRSz_PM_ku_colDeg_approx_better] the bound was improved to almost the true value, it was proved that mr - 1(r,n)  ≤  n / 2  +  r / 4. Finally [\cite=RRSz_PM_ku_colDeg_tight] settled the problem for d = r - 1. The case d < r - 1 is rather hard, in [\cite=Pikh_PM_ku_dDeg] it is proved that for all d  ≥  r / 2, md(r,n) is close to [formula]. For 1  ≤  d < r / 2 in [\cite=HPS_PM_3u_vertDeg] it was proved that

[formula]

A recent survey of these and other related results appear in [\cite=Rod_Ruc_Survey]. In [\cite=HPS_PM_3u_vertDeg] the authors posed the following conjecture.

For all 1  ≤  d  <  r / 2,

[formula]

Note that for r = 4 and d = 1 the above bound yields

[formula]

For r = 3 and d = 1 this conjecture was proved in [\cite=Khan_3u_vertDeg] and [\cite=KOT_parallel]. Markstöm and Ruciski in [\cite=Ruc_Marks_approx4u] improved the bound on md(r,n) for 1  ≤  d  <  r / 2 slightly, by proving

[formula]

Furthermore for r = 4 and d = 1 in [\cite=Ruc_Marks_approx4u] the authors proved that [formula]. In this paper we settle Conjecture [\ref=mainConjecture] for the case r = 4 and d = 1. The main result in this paper is the following theorem.

There exist an integer n0 such that if H is a 4-graph on n  ≥  n0 ([formula]) vertices, and

[formula]

then H has a perfect matching.

On the other hand the following construction from [\cite=HPS_PM_3u_vertDeg] shows that this result is tight.

We have [formula] (the degree of a vertex in B) but since every edge in a matching must use at least one vertex from A, the maximum matching in this graph is of size [formula]

Outline of the proof

We distinguish two cases to prove Theorem [\ref=ourMainThm]. When H is 'far from' the extremal example as in Construction [\ref=extConstruction] we use the absorbing lemma to find a perfect matching in H. The absorbing lemma (Lemma [\ref=absorbLemma]) roughly states, that any 3-graph H satisfying ([\ref=minDegree]), contains a small matching M with the property that every "not too large" subset of vertices can be absorbed into M. In Section [\ref=non_ext_case], we first remove an absorbing matching M from H. Then using the tools developed in section [\ref=tools] and the auxiliary results of section [\ref=aux_results], we find an almost perfect matching in [formula]. The left over vertices are absorbed into M to get a perfect matching in H. We will show that we can either find an almost perfect matching or H is in the extremal case. For a constant 0 < α < 1, we say that H is α-extremal, if the following is satisfied, otherwise it is α-non-extremal.

There exists a B  ⊂  V(H) such that

[formula]

[formula].

In section [\ref=extCase], using a König-Hall type argument, we build a perfect matching in H, when it is α-extremal.

Main tools

We use the following two easy observations that will, nevertheless, be useful later on.

If G(A,B) is a 2η-dense bipartite graph, then there must be at least η|B| vertices in B for which the degree in A is at least η|A|.

Indeed, otherwise the total number of edges would be less than

[formula]

a contradiction to the fact that G(A,B) is 2η-dense.

If G(A,B) is a bipartite graph, |A|  =  c1 log n, |B| = c2n and for every vertex b∈B deg(b,A)  ≥  η|A|, then we can find a complete bipartite subgraph G'(A',B') of G such that [formula].

To see this consider the neighborhoods in A, of the vertices in B. Since there can be at most 2|A|  =  nc1 such neighborhoods, by averaging there must be a neighborhood that appears for at least [formula] vertices of B. This means that we can find the desired complete bipartite graph. The main tool in this paper is the following result of Erdös [\cite=ErdosKST], on complete balanced r-partite subhypergraphs of r-graphs.

For every integer l  ≥  1 there is an integer n0  =  n0(r,l) such that: Every r-graph on n > n0 vertices, that has at least nr - 1 / lr - 1 edges, contains a K(r)(l).

In particular Lemma [\ref=hyperKST] implies that for η > 0 and a sufficiently small constant β, if H is an r-graph on n > n0(η,β) vertices with

[formula]

then H contains a K(r)(t), where

[formula]

This is so because [formula], when [formula].

The following three lemmas are repeatedly used in section [\ref=non_ext_case].

Let [formula] be a 4-graph, |A| = c1m, |B| = c22m3, for some constants 0 < c1,c2 < 1, if

[formula]

then there exists a complete 4-partite 4-graph H'(A1,B1,B2,B3), with A1  ⊂  A and B1,B2B3 are disjoint subsets of B such that |A1| = |B1| = |B2| = |B3|  =  η|A|.

First apply Fact [\ref=denseSubgraph] to get a subset of 3-sets of vertices in B, [formula], such that every 3-set in T1 makes edges with at least η|A| vertices in A and [formula]. Next we find a T2  ⊂  T1, such that all 3-sets in T2 make edges with the same subset of A (say A1  ⊂  A). By Fact [\ref=subsetsPHP] we have

[formula]

where the last inequality follows when m is sufficiently large and η, c1 and c2 are small constants.

Now construct an auxiliary 3-graph H1 where V(H1) = B and edges of H1 corresponds to 3-sets in T2. Applying lemma [\ref=hyperKST] on H1 (for r = 3) we get a complete 3-partite 3-graph with color classes B1, B2 and B3 each of size η|A|. Clearly A1, B1, B2 and B3 corresponds to color classes of a complete 4-partite 4-graph in H as in the statement of the lemma.

Let [formula] be a 4-graph with |A| = |B| = c1m, |Z| = c22m3 for some constants 0 < c1,c2 < 1, if

[formula]

then there exists a complete 4-partite 4-graph H'(A',B',Z1,Z2), with A'  ⊂  A, B'  ⊂  B and Z1Z2 are disjoint subsets of Z such that |A'| = |B'| = |Z1| = |Z2| = c log m for a constant c = c(c1,c2,η).

First apply Fact [\ref=denseSubgraph] to get a subset of pairs of vertices in Z, [formula], such that every pair in P1 makes edges with at least η|A||B| pairs of vertices in A  ×  B and [formula]. Next we find a P2  ⊂  P1, such that all pairs in P2 make edges with the same subset of pairs in A  ×  B (say Q1  ⊂  A  ×  B). By Fact [\ref=subsetsPHP] we have

[formula]

where the last inequality follows when m is sufficiently large, and η, c1 and c2 are small constants.

Now construct an auxiliary 2-graph G1 where V(G1) = Z and edges of G1 corresponds to pairs in P2. Applying lemma [\ref=hyperKST] on G1 (for r = 2) we get a complete bipartite graph with color classes Z1 and Z2 each of size log m. Similarly construct an auxiliary bipartite graph G2 with color classes A and B, and edges of G2 corresponds to pairs in Q1. Since we have |Q1|  ≥  η|A||B| applying lemma [\ref=hyperKST] on G2 (for r = 2) we get a complete bipartite graph with color classes A' and B', each of size c log m. Clearly A', B' and a subset of vertices each from Z1 and Z2 of size |A'| corresponds to color classes of the balanced complete 4-partite 4-graph in H as in the statement of the lemma.

Let H(A,B,C,Z) be a 4-partite 4-graph with |A|  =  |B|  =  |C| = c1m and |Z|  =  c22m3 for some constants 0 < c1,c2 < 1. If

[formula]

then there exists a complete 4-partite 4-graph H'(A',B',C',Z') such that [formula].

First apply Fact [\ref=denseSubgraph] on H to get a subset Z1 of Z such that for every vertex z∈Z1, deg 3(z,(A  ×  B  ×  C))  ≥  η|A|3 and |Z1|  ≥  η|Z|. Now consider the auxiliary bipartite graph G(D,Z1), where D = A  ×  B  ×  C and a vertex z∈Z1 is connected to a 3-set (a,b,c)∈D if (a,b,c,z) makes an edge of H. An application of Fact [\ref=subsetsPHP] on G gives a complete bipartite graph G2(D',Z'1) where

[formula]

when m is sufficiently large. Let G3 be a 3-partite 3-graph where the color classes are A, B and C and edges correspond to 3-sets in D'. Since |D'|  ≥  η|A|3 applying Lemma [\ref=hyperKST] on G3 (r = 3), we get a balanced complete 3-partite 3-graph in G3 with color classes A', B' and C', such that [formula]. Clearly A', B', C' and a subset of Z'1 of size |A'|, correspond to the color classes of the required complete 4-partite 4-graph.

We will frequently apply the following folklore statements (proofs are omitted):

Every graph H has a subgraph H' such that δ1(H')  ≥  |E(H)| / |V(H)|.

Every 3-graph H on n vertices, with [formula], has a matching of size ηn / 24.

Finally we use the following lemma from [\cite=HPS_PM_3u_vertDeg].

(Absorbing Lemma) For every η > 0, there is an integer n0  =  n0(η) such that if H is a 4-graph on n  ≥  n0 vertices with [formula], then there exist a matching M in H of size |M|  ≤  η4n / 4 such that for every set [formula] of size at size at most [formula], there exists a matching covering exactly the vertices in [formula].

Auxiliary results

For a [formula] 3-graph, denote by Q1,Q2,Q3 its 3 color classes and let Q1  =  {a1,a2,a3,a4}, Q2  =  {b1,b2,b3,b4} and Q3  =  {c1,c2,c3,c4}. For two vertices, x∈Qi,  y∈Qj,  i  ≠  j, N(x,y) denotes the neighborhood of the pair x,y, i.e. the set of vertices in the third color class that make edges with the pair x,y. Let deg(x,y) = |N(x,y)|. For two disjoint pairs (x1,y1) and (x2,y2) in Qi  ×  Qj, i  ≠  j the pairs (x1,y2) and (x2,y1) are called the crossing pairs and the value deg(x1,y2)  +  deg(x2,y1) is referred to as the crossing degree sum. We define the following four special [formula] 3-graphs.

H432 is a [formula] 3-graph, such that there exist 3 disjoint pairs in a Qi  ×  Qj, i  ≠  j, with degrees at least 4, 3 and 2 respectively.

In the figures the triplets joined by a line represent an edge in the 3-graph. Let the H432 be as in Figure [\ref=fig_H_{432_1}] or Figure [\ref=fig_H_{432_2}]. If the H432 does not have a perfect matching then we must have deg(b4,c4)  =  0, (as otherwise by the König-Hall criteria we get a perfect matching).

H4221 is a [formula] tripartite 3-graph, such that there exist 4 disjoint pairs in a Qi  ×  Qj, i  ≠  j, with degrees at least 4, 2, 2 and 1 respectively.

Let the H4221 be as in Figure [\ref=fig_H_{4221_1}]. If [formula] then again by the König-Hall criteria we get that H4221 has a perfect matching. We only consider the H4221 that has no perfect matching.

H3321 is a [formula] 3-graph, such that there exist 4 disjoint pairs in a Qi  ×  Qj, i  ≠  j, with degrees at least 3, 3, 2 and 1 respectively (see Figure [\ref=fig_H_3221_1]).

Hext is a [formula] 3-graph with exactly 37 edges such that there are three vertices, one in each of Q1,Q2 and Q3, and all edges are incident to at least one of these three vertices.

The following lemma that classifies, [formula] 3-graphs with at least 37 edges, will be very useful in the subsequent section.

Let H(Q1,Q2,Q3) be a [formula] 3-graph. If |E(H)|  ≥  37 then one of the following must be true

H has a perfect matching.

H has a subgraph isomorphic to H3321

H has a subgraph isomorphic to H432

H has a subgraph isomorphic to H4221

H is isomorphic to Hext.

We consider the following cases based on degree of pairs in Qi  ×  Qj.

Case 1: There is Qi and Qj, i  ≠  j such that no pair in Qi  ×  Qj has degree 4.

Let Q2,Q3 be such a pair. Since |E(H)|  ≥  37 and no pair has degree 4, at least 5 out of the 16 pairs in Q2  ×  Q3 must be of degree 3. Which implies that there must be at least 2 disjoint pairs of degree 3. Consider the largest set of disjoint pairs of degree 3 in Q2  ×  Q3. Assume that there are 3 disjoint pairs in Q2  ×  Q3 of degree 3, say (b1,c1), (b2,c2) and (b3,c3).

If deg(b4,c4)  ≥  1, then we have a H3321. So assume that deg(b4,c4) = 0, The total number of edges incident to pairs in {b1,b2,b3}  ×  {c1,c2,c3} is at most 27 (as there are 9 pairs and degree of every pair is at most 3), the remaining at least 10 edges are incident to either b4 or c4. Which implies that there must be at least one pair (say (b3,c3)), such that crossing degree sum of (b3,c3) and (b4,c4) is at least 4. Therefore we have that the degree of one crossing pair is at least 2 and that of the other crossing pair is at least 1. These two crossing pairs together with (b1,c1) and (b2,c2) gives us a subgraph isomorphic to H3321.

On the other hand, if there are exactly 2 disjoint pairs of degree 3, say (b1,c1) and (b2,c2). Again the total number of edges incident to pairs in {b1,b2}  ×  {c1,c2} is at most 12 (as there are 4 pairs and degree of every pair is at most 3). If there is a pair in {b3,b4}  ×  {c3,c4} (say (b3,c3)) such that the crossing degree sum of (b1,c1) and (b3,c3) is at least 6, then since there is no degree 4 pair we must have that both deg(b1,c3) and deg(c1,b3) are 3. Now these crossing pairs together with (a2,b2) are 3 disjoint pairs of degree 3 which is a contradiction to the maximality of the set of disjoint pairs of degree 3. Therefore we must have that the sum of degrees of pairs in {b1,b2}  ×  {c3,c4} and {c1,c2}  ×  {b3,b4} is at most 4  ×  5  =  20. Hence the number of edges of H incident to pairs in {b3,b4}  ×  {c3,c4} is at least 37 - 12 - 20  =  5 and no pair has degree 3. Therefore, in {b3,b4}  ×  {c3,c4}, we can find two disjoint disjoint pairs, (say (b3,c3) and (b4,c4)) with degree at least 2 and 1 respectively and we get a graph isomorphic to H3321.

Case 2: There is a Qi and Qj, i  ≠  j such that exactly one disjoint pair in Qi  ×  Qj has degree 4. Let Q2,Q3 be such a pair. Consider the largest set of disjoint pairs in Q2  ×  Q3 with one pair of degree 4 and the remaining of degree 3. Note that if there are two disjoint pairs of degree 3 besides the degree 4 pair in the selected set, then clearly we have an H432. So we consider the following two subcases based on whether or not there is a pair of degree 3 in the selected set. Let (b1,c1) be the degree 4 pair in the selected set. Subcase 2.1 There is another pair in Q2  ×  Q3 disjoint from (b1,c1) with degree 3. Assume that deg(b2,c2)  =  3. First observe that

If any pair in {b3,b4}  ×  {c3,c4} has degree at least 2 then that pair together with (b1,c1) and (b2,c2) makes an H432.

If both deg(b1,c2) and deg(b2,c1) are 4 then we get two disjoint degree 4 pairs. Therefore we have that the number of edges incident to pairs in {b1,b2}  ×  {c1,c2} is at most 4 + 3 + 4 + 3  =  14.

If there is a pair in {b3,b4}  ×  {c3,c4} (say (b3,c3)) such that the crossing degree sum of (b2,c2) and (b3,c3) is at least 5. Then we must have that one crossing pair is of degree at least 3, and the other is of degree at least 2 (because none of them can be of degree 4). These 2 crossing pairs together with (b1,c1) makes the disjoint pairs of an H432. Therefore we must have that (b2,c2) and any pair in {b3,b4}  ×  {c3,c4} have their crossing degree sum at most 4.

Similarly (b1,c1) and any pair in {b3,b4}  ×  {c3,c4} have their crossing degree sum at most 6.

Assume that (b1,c1) and (b3,c3) have their crossing degree sum, equal to 6. If the degrees of crossing pairs are 4 and 2, then these crossing pairs and (b2,c2) makes the disjoint pairs of an H432. On the other hand if both the crossing pairs have degree 3. Then (b1,c3), (b3,c1) and (b2,c2) are three disjoint pairs of degree 3. From observation 1 we have deg(b3,c3)  ≤  1 and from observation 3 the crossing degree sum of (b3,c3) and (b2,c2) is at most 4. Which together with observation 2 gives us that the total number of edges incident to pairs in {b1,b2,b3}  ×  {c1,c2,c3} is at most 14 + 6 + 1 + 4 = 25. Now if deg(b4,c4) = 1 then we have an H3321, otherwise we have that the number of edges containing either b4 or c4 is at least 37 - 25  ≥  12. By observation 1 we have that both deg(b4,c3) and deg(b3,c4) are at most 1 hence we must have that the crossing degree sum of (b2,c2) and (b4,c4) is 4 with one crossing pair of degree at least 1 and the other of degree at least 2. These crossing pairs together with (b1,c3) and (b3,c1) gives us an H3321. On the other hand if for any pair in {b3,b4}  ×  {c3,c4} and (b1,c1) their crossing degree sum is be at most 5. Then the number of edges incident to pairs in {b3,b4}  ×  {c3,c4} is at least 37 - 14 - 4(2) - 5(2) = 5. Which implies that there must a degree 2 pair, and hence by observation 1, we get an H432.

Subcase 2.2 There is no pair of degree 3 disjoint from (b1,c1). In this case again as in observation 2, the crossing degree sum of (b1,c1) and any pair in {b2,b3,b4}  ×  {c2,c3,c4} is at most 6 (as any other case results in two disjoint pairs of degree 4 and 3). This implies that the number of edges incident to pairs in {b2,b3,b4}  ×  {c2,c3,c4} is at least 37 - 4  -  3(6)  =  15 and no pair has degree 3. Which implies that there are three disjoint pairs in {b2,b3,b4}  ×  {c2,c3,c4} with degrees 2, 2 and at least 1 respectively. These pairs and (b1,c1) makes the 4 disjoint pairs of an H4221.

Case 3: In every Qi and Qj, i  ≠  j there are exactly two disjoint pairs in Qi  ×  Qj with degree 4.

Consider Q1,Q2 and assume that (a1,b1) and (a2,b2) are the two disjoint pairs with degree 4. We make the following observations:

If any pair in {a3,a4}  ×  {b3,b4} has degree at least 2 then that pair together with (a1,b1) and (a2,b2) makes the disjoint pairs of an H432. Therefore the total number of edges spanned by pairs in {a3,a4}  ×  {b3,b4} is at most 4.

For any of (a1,b1) and (a2,b2) and any pair in {a3,a4}  ×  {b3,b4} their crossing degree sum can be at most 5. Indeed otherwise say the crossing degree sum of (a1,b1) and (a3,b3) is 6, then we must have that one crossing pair has degree at least 3, and the other has degree at least 2. These crossing pairs and (a2,b2) make the disjoint pairs of an H432. Furthermore if any such crossing degree sum is 5 then by the same reasoning as above, it must be that one crossing pair is of degree 4 and the other is of degree 1.

If the total number of edges spanned by pairs in {a1,a2}  ×  {b1,b2} is at most 12, then the number of edges that uses one vertex from {a1,a2,b1,b2} and one vertex from {a3,a4,b3,b4} is at least 37 - 12 - 4 = 21. Hence there will be a pair in {a3,a4}  ×  {b3,b4} (say (a3,b3)) such that crossing degree sum of (a3,b3) and at least one of (a1,b1) and (a2,b2) is at least 6, and by observation 2 we get an H432.

The above observations are true for any two disjoint pairs of degree 4. We choose two disjoint pairs of degree 4, (say (a1,b1) and (a2,b2)) pairs in Q1  ×  Q2 such that (i) a1 has the maximum vertex degree among all vertices that are part of some pairs of degree 4 and (ii) deg(a2,b1) is as small as possible. Let deg(a2,b1)  =  x. Note that by observation 3, we have x  ≥  1. We consider the following cases based on the value of x.

Subcase 3.1 x = 4 Note that that the number of edges in {a1,a2}  ×  {b1,b2} is at most 16 (deg(a1,b2)  ≤  4). First we will show that both deg(a3,b1),deg(a4,b1)  ≤  1. Assume that deg(a3,b1)  ≥  2, but then as in observation 2 both deg(a1,b3) and deg(a1,b4) can be at most 2. Hence by the maximality of the degree of a1 we get deg(a3,b1) + deg(a4,b1)  ≤  4. Now by observation 1, there must be at least 37 - 16 - 4 - 8 = 9 edges containing one vertex from {a3,a4,b3,b4} and one of {a2,b2}. Which implies that the degree of a2 or b2 is strictly larger than that of a1, a contradiction. So we have deg(a3,b1) = deg(a4,b1) = 1. Now we show that both deg(a3,b2),deg(a4,b2)  ≤  1. To see this first assume that either deg(a1,b3) or deg(a1,b4) is equal to 4, (say deg(a1,b3) = 4) then by the minimality of x we must have that deg(a2,b3) = 4 too, because if deg(a2,b3) < x, then we can exchange b1 with b3 to get a smaller value of x. But if deg(a2,b3) = 4 then by observation 2 we must have deg(a3,b2) = deg(a4,b2) = 1. On the other hand if both deg(a1,b3) and deg(a1,b4) are at most 3 (deg(a1,b3) + deg(a1,b4)  ≤  6) then again there must be at least 37 - 16 - 4 - 8 = 9 edges containing some pair in {a2}  ×  {b3,b4} and {a3,a4}  ×  {b2}. Which means at least one of these pairs must be of degree at least 3. Say deg(a2,b3)  ≥  3, but then by observation 2 we have deg(a3,b2),deg(a4,b2)  ≤  1 and we are done. In case say deg(a3,b2)  ≥  3 then we have deg(a3,b2) + deg(a4,b2)  ≥  7 and we get that the degree of b2 is larger than degree of a1, a contradiction. So we have that deg(a3,b1),deg(a4,b1),deg(a3,b2)deg(a4,b2)  ≤  1. This together with observation 1 implies that the number of edges containing some pair in {a1,a2}  ×  {b1,b2,b3,b4} is at least 37 - 4 - 4  =  29. Therefore the [formula] 3-graph H'({b1,b2},Q2,Q3) has at least 37 - 4 - 4 = 29 edges. There must be at least three vertices in Q2 such that each one of them is part of at least three pairs in (Q2  ×  Q3) that are of degree at least 2. To see this assume that there are at most two such vertices in Q2 (say b1 and b2). Then using the fact that the maximum degree of a pair in Q2  ×  Q3 in H' is 2, we get that b1 and b2 can be contained in at most 2(4  ·  2)  =  16 edges. While at most 2 pairs containing either b3 and b4 can be of degree 2, we get that the number of edges containing either b3 and b4 is at most 2  ·  (2  ·  2  +  2  ·  1)  =  12 which implies that |E(H')|  ≤  28 a contradiction Now since in Q2 there are at least 3 vertices such that each one of them is part of at least 3 pairs in (Q2  ×  Q3) of degree at least 2. Which implies that there must a degree 2 pair disjoint from the two degree 4 pairs (guaranteed in Case 3) in Q2  ×  Q3. Therefore we get an H432.

Subcase 3.2 x = 3 Now we have that the number of edges in {a1,a2}  ×  {b1,b2} is at most 15. Again we first show that both deg(a3,b1),deg(a4,b1)  ≤  1. Assume that deg(a3,b1)  ≥  2, but then by observation 2 both deg(a1,b3) and deg(a1,b4) can be at most 2. Hence by the maximality of the degree of a1 we get deg(a3,b1) + deg(a4,b1)  ≤  5. Now by observation 1, there must be at least 37 - 15 - 4 - 9 = 9 edges containing one vertex from {a3,a4,b3,b4} and one of {a2,b2}. Which implies that the degree of a2 or b2 is strictly larger than that of a1, a contradiction. So we have deg(a3,b1) = deg(a4,b1) = 1. Similarly as in the previous case we show that both deg(a3,b2),deg(a4,b2)  ≤  1. To see this first assume that either deg(a1,b3) or deg(a1,b4) is equal to 4, (say deg(a1,b3) = 4) then by the minimality of x we must have that deg(a2,b3)  ≥  3 too. But if deg(a2,b3) = 3 then by observation 2 we must have [formula]. On the other hand if both deg(a1,b3) and deg(a1,b4) are at most 3 (deg(a1,b3) + deg(a1,b4)  ≤  6) then again there must be at least 37 - 15 - 4 - 8 = 9 edges containing some pair in {a2}  ×  {b3,b4} and {a3,a4}  ×  {b2}. Which means at least one of these pairs must be of degree at least 3. Say deg(a2,b3)  ≥  3, but then by observation 2 we have deg(a3,b2),deg(a4,b2)  ≤  1 and we are done. In case say deg(a3,b2)  ≥  3 then we have deg(a3,b2) + deg(a4,b2)  ≥  7 and we get that the degree of b2 is greater than the degree of a1, a contradiction. So we have that deg(a3,b1),deg(a4,b1),deg(a3,b2)deg(a4,b2)  ≤  1. Again we get that the [formula] 3-graph H'({b1,b2},Q2,Q3) has at least 37 - 4 - 4 = 29 edges. and we are done.

Subcase 3.3 x = 2 Similarly as in the previous two subcases we have that deg(a3,b1),deg(a4,b1),deg(a3,b2)deg(a4,b2)  ≤  1 and the [formula] 3-graph H'({b1,b2},Q2,Q3) has at least 37 - 4 - 4 = 29 edges and we are done.

Subcase 3.4 x = 1

In this case observation 3 implies that the number of edges in {a1,a2}  ×  {b1,b2} is exactly 13 (deg(a1,b2) = 4). Using |E(H)  ≥  37| and observation 2 we get that every pair in {a3,a4}  ×  {b3,b4} has degree exactly 1 and for any pair in {a3,a4}  ×  {b3,b4} and any of (a1,b1) or (a2,b2) their crossing degree sum is exactly 5 (4 + 1).

Therefore, we have that either

[formula]

[formula]

In the latter case note that again we have that H'({b1,b2},Q2,Q3) has at least 29 edges and we are done as above. So assume that deg(a1,b3) = deg(a1,b4) = deg(a3,b2) = deg(a4,b2) = 4 and deg(a1,b1)  =  deg(a2,b2)  =  deg(a1,b2)  =  4 and every other pair in Q1  ×  Q2 is of degree exactly 1. This means that a1 and b2 are not part of any degree 1 pair. Now the neighborhoods of all the degree 1 pairs must be the same vertex in Q3 (say c3). Because otherwise we get a perfect matching in H, (using those two vertices in Q3 for two disjoint degree 1 pairs, and the remaining two vertices of Q3 are matched with two of the degree 4 pairs in (Q1  ×  Q2)). But if all of these edges are incident to c3, then all edges in this graph are incident to at least one vertex in {a1,b2,c3} and the number of edges is exactly 37, hence H is isomorphic to Hext.

Let A, B and C be three disjoint balanced complete 4-partite 4-graphs with color classes [formula], [formula] and [formula] respectively, and |A1| = |B1| = |C1|  =  m. Let Z be a set of vertices disjoint from vertices in A, B and C. For a small constant η > 0, we say that Z is connected to a triplet of color classes (Ai,Bj,Ck), 1  ≤  i,j,k  ≤  4, if d4(Z,(Ai  ×  Bj  ×  Ck))  ≥  2η. For Z and (A,B,C) we define an auxiliary graph, (the link graph), Labc to be a [formula] 3-graph where the vertex set of each color class of Labc corresponds to the color classes in A, B and C. While a triplet of vertices (ai,bj,ck) is an edge in Labc iff Z is connected to the triplet of color classes (Ai,Bj,Ck). Given three balanced complete 4-partite 4-graphs A, B and C and another set of vertices Z, as above, we say that we can extend (A,B,C) if we can build another set of balanced complete 4-partite 4-graphs using [formula] such that the total number of vertices in the new 4-partite 4-graphs is at least 12m  +  ηm / 16 and the size of a color class in each new 4-partite 4-graph is [formula]. In what follows we outline a procedure to extend (A,B,C) using the structure of Labc.

For η,c > 0, let A,B and C be three balanced complete 4-partite 4-graphs such that |A1| = |B1| = |C1|  =  m. If Z is a disjoint set of vertices with |Z|  ≥  c2m3. If the link graph Labc has at least 37 edges and Labc is not isomorphic to Hext then we can extend (A,B,C).

Since Labc is a [formula] 3-graph with at least 37 edges and is not isomorphic to Hext, for each of the other cases as in Lemma [\ref=ext_categories], we give the procedure to extend (A,B,C).

Case 1: Labc has a perfect matching:

Without loss of generality assume that the perfect matching in Labc corresponds to {(Ai,Bi,Ci)  :1  ≤  i  ≤  4} i.e. Z is connected to the triplets {(Ai,Bi,Ci)  :1  ≤  i  ≤  4}. Note that by the definition of connectedness and the sizes of the sets the 4-partite 4-graph (A1,B1,C1,Z) satisfies the conditions of Lemma [\ref=4partVolArg]. Hence we find a complete balanced 4-partite 4-graph X1  =  (A11,B11,C11,Z1), such that

[formula]

[formula]

Similarly, we find such complete balanced 4-partite 4-graphs X2, X3 and X4 in (A2,B2,C2,Z), (A3,B3,C3,Z) and (A4,B4,C4,Z) respectively, that are disjoint from each other (as |Z| is very large compared to m) (see Figure [\ref=fig_4_unif_PM_extended]). We remove the vertices in X1,X2,X3 and X4 and make these four new 4-partite 4-graphs. In the remaining parts of A,B and C we remove another such set of 4 disjoint complete balanced 4-partite 4-graphs. Again by definition of connectedness and Lemma [\ref=4partVolArg] we can continue this process until we remove at least ηm / 8 vertices from each color class of A,B and C. Note that the new 4-partite 4-graphs use at least 4ηm / 8 vertices from Z. Therefore these new 4-partite 4-graphs together with leftover parts of A,B and C have at least 3(4m)  +  ηm / 2 vertices while all the 4-partite 4-graphs are balanced. Hence, we extended (A,B,C).

Case 2: Labc has a subgraph isomorphic to H432:

In this case we show in detail how to extend such an (A,B,C), while in the latter cases we will only briefly outline the procedure. First assume that the H432 in Labc is as in Figure [\ref=fig_H_{432_1}] and let the pairs corresponding to the degree 4, 3 and 2 pairs in this subgraph be (B1,C1), (B2,C2) and (B3,C3) respectively. Furthermore let the color classes corresponding to the neighbors of degree 3 and degree 2 pairs in H432 be {A2,A3,A4} and {A3,A4} respectively. Using the definition of connectedness and Lemma [\ref=4partVolArg] we find two disjoint complete balanced 4-partite 4-graphs X1  =  (A14,B13,C13,Z1) and X2  =  (A23,B23,C23,Z2) such that Zj,Aji,Bji,Cji are subsets of Z,Ai,Bi,Ci respectively.

Similarly we find three more disjoint balanced complete 4-partite 4-graphs X3,X4 and X5 where vertices of three color classes in all of them are from B2,C2 and Z while vertices of the fourth color class are from A2,A3 and A4 respectively. We build two more disjoint balanced complete 4-partite 4-graphs X6 and X7 such that vertices of three color classes in both of them are from B1,C1 and Z while vertices of the fourth color class are from A1 and A2 respectively.

The size of a color class in [formula] is [formula]. We remove the vertices in [formula] from their color classes to make these 7 new 4-partite 4-graphs In the remaining parts of A,B and C we remove another such set of seven disjoint balanced complete 4-partite 4-graphs that are disjoint from the previous ones. Again by definition of connectedness and Lemma [\ref=4partVolArg] we can continue this process until we remove ηm / 8 vertices each from Bi and Ci, 1  ≤  i  ≤  3. By construction, if the number of vertices used from Bi and Ci, 1  ≤  i  ≤  3 is t (=  ηm / 8) then the number of vertices used in A2,A3 and A4 is 5t / 6, while that in A1 is t / 2 (see Figure [\ref=fig_4_unif_H_432_1_extended]). Note that the new 4-partite 4-graphs use at least 3t  ≥  3ηm / 8 vertices from Z, but the remaining parts of A, B and C are not balanced (A1, B4 and C4 have more vertices). To restore the balance in the remaining part of A we discard some arbitrary t / 3 vertices from the remaining part of A1. Similarly we discard some arbitrary t vertices from B4 and C4 to restore the balance in the remaining part of B and C. Therefore the new 4-partite 4-graphs together with leftover parts of A,B and C (after discarding the vertices) have at least 4(|A1| + |B1| + |C1|)  +  3t  -  t / 3  -  2t  ≥  12m  +  ηm / 12 vertices while all the 4-partite 4-graphs are balanced. Hence we extended (A,B,C).

On the other hand if the H432 in Labc is as in Figure [\ref=fig_H_{432_2}], then let the color classes corresponding to the neighbors of degree 3 and degree 2 pairs in H432 be {A1,A2,A3} and {A3,A4} respectively. In this case extend (A,B,C) as follows.

For the pair (B3,C3) we remove two balanced complete 4-partite 4-graphs with the fourth color classes in A3 and A4 respectively. For the pair B2,C2 we remove two balanced complete 4-partite 4-graphs with the fourth color classes in A1 and A2 respectively. The size of of each color class in all of these new 4-partite graphs is [formula]. Since the pair (B1,C1) has degree 4, we remove four balanced complete 4-partite 4-graphs with the fourth color class in A1,A2,A3 and A4 respectively.

Similarly as in the previous case we repeat this process so that we remove at least t  ≥  ηm / 8 vertices from each Bi and Ci, 1  ≤  i  ≤  3. Note that by construction we have used 3t / 4 vertices in each color class of A (see Figure [\ref=fig_4_unif_H_432_2_extended]). So the remaining part of A is still balanced. While to restore balance in the remaining parts of B and C, we discard some arbitrary t vertices from each of B4 and C4. Again in total we added 3t vertices from Z, while we discarded 2t vertices form B4 and C4. Therefore the net increase in the number of vertices in the new set of complete 4-partite 4-graphs is t  ≥  ηm / 8, while all the 4-partite 4-graphs are balanced.

Case 3: Labc has a subgraph isomorphic to H4221:

Without loss of generality, assume that the pairs corresponding to the degree 4, 2, 2 and 1 pairs in this H4221 are (B1,C1), (B2,C2), (B3,C3) and (B4,C4) respectively. Furthermore let the color classes corresponding to the neighbors of degree 1 and the two degree 2 pairs in H4221 be {A4}, {A3,A4} and {A3,A4} respectively (as in Figure [\ref=fig_H_{4221_1}]). By the definition of connectedness and Lemma [\ref=4partVolArg] we build complete balanced 4-partite 4-graphs using (A4,B4,C4,Z) and (A3,B3,C3,Z) of size [formula]. For the pair (B2,C2) we make two more balanced complete 4-partite 4-graphs using (A4,B2,C2,Z) and (A3,B2,C2,Z). For the degree 4 pair (B1,C1) we remove balanced complete 4-partite 4-graphs in (A1,B1,C1,Z) and (A2,B1,C1,Z). Again we repeat this process so that we remove t  ≥  ηm / 24 vertices from each color class of B and C. Note that with this process we have used 3t / 2 vertices in A3 and A4 while t / 2 vertices each in A1 and A2 (see Figure [\ref=fig_4_unif_H_4221_extended]). Furthermore only the remaining part of A is not balanced. The balance can be restored by discarding t vertices each from the remaining part of A1 and A2 which results in the net increase of 2t  ≥  ηm / 12 vertices in all the balanced complete tripartite graphs. Case 4: Labc has a subgraph isomorphic to H3321:

Assume that the pairs corresponding to the degree 3, 3, 2 and 1 pairs in the H3321 are (B1,C1), (B2,C2), (B3,C3) and (B4,C4) respectively. Let the color classes corresponding to the neighbors of these pairs in H3321 be {A2,A3,A4}, {A2,A3,A4}, {A3,A4} and {A4}. By the definition of connectedness and Lemma [\ref=4partVolArg] we build three complete balanced 4-partite graphs in each of (A4,B4,C4,Z), (A3,B3,C3,Z) and (A2,B2,C2,Z) of size [formula]. In addition we build three more complete balanced 4-partite 4-graphs using (B1,C1) and Z, while the vertices of the fourth color classes are in A2, A3 and A4 respectively. We repeat this process so as to remove at least t  ≥  3ηm / 64 vertices each from each color class of B and C. Clearly the remaining part of B and C are still balanced, while in A we have used 4t / 3 vertices in each of A2,A3 and A4. To restore the balance in remaining part of A we discard arbitrary 4t / 3 vertices from A1. In the process the net increase in the number of vertices in the resultant balanced 4-partite 4-graphs is at least 8t / 3  ≥  3ηm / 8, hence (A,B,C) is extended.

The Non Extremal Case

Throughout this section we assume that we have a 4-graph H satisfying ([\ref=minDegree]) such that the extremal case does not hold for H. We shall assume that n is sufficiently large and besides our main parameter γ we use the parameters β and α such that the following holds

[formula]

where a  ≪  b means that a is sufficiently small compared to b. From ([\ref=minDegree]) and ([\ref=para]), when n is large we have

[formula]

Hence our hypergraph H satisfies the conditions of Lemma [\ref=absorbLemma] (the absorbing lemma). We remove from H an absorbing matching M of size at most [formula]. In the remaining hypergraph we find an almost perfect matching that leaves out a set of at most α4n  =  γn vertices. As guaranteed by Lemma [\ref=absorbLemma] the vertices that are left out from the almost perfect matching can be absorbed into M, therefore we get a perfect matching in H. In what follows we work with the remaining hypergraph (after removing V(M)). For simplicity we still denote the remaining hypergraph by H and assume that it is on n vertices. Since [formula], in the remaining hypergraph we still have

[formula]

as for any vertex v in the remaining hypergraph, there can be at most [formula] edges containing v and at least one vertex in V(M).

The optimal cover

Our goal is to find an almost perfect matching in H. We are going to build a cover [formula]}, such that, each Qi is a disjoint balanced complete 4-partite 4-graph in H (we refer to them as 4-partite graphs). We say that such a cover is optimal if it covers at least (1 - γ)n vertices. We will show that either we can find an optimal cover or H is α-extremal. It is easy to see that such an optimal cover readily gives us an almost perfect matching. Using the following iterative procedure, we either build an optimal cover or find a subset of vertices, which shows that H is α-extremal. We begin with a cover F0. Then in each step t  ≥  1, if Ft - 1 is not optimal, we find another cover Ft, such that |V(Ft)|  ≥  |V(Ft - 1)|  +  γ2n / 16 (for this we use the notation, Ft  >  Ft - 1). The size of a color class in each 4-partite graph in Ft is mt. To get the initial cover, F0, we repeatedly apply Lemma [\ref=hyperKST] in the leftover of H, while the conditions of the lemma are satisfied and the number of leftover vertices are at least γn, to find 4-partite graphs, K(4)(m0), where m0  =  β( log n)1 / 3. After the [formula] step in this iterative procedure, if Ft is not an optimal cover, then we get Ft + 1. We will show that, unless H is α-extremal, we have Ft + 1  >  Ft and [formula]. Let [formula]. Since Ft is not optimal and we cannot apply Lemma [\ref=hyperKST] in H|It, we must have that |It|  ≥  γn and

[formula]

By non-extremality of H, this implies that |V(F0)|  ≥  n / 4.

In what follows we will show that if there are 'many' edges with three vertices in It and one vertex in some Qi∈Ft then we get Ft + 1  >  Ft. To that end let Qi  =  (Vi1,Vi2,Vi3,Vi4) be a 4-partite graph in Ft, we say that a color class, Vip of Qi, (1  ≤  p  ≤  4) is connected to It, if [formula]. We will show that if a 4γ-fraction of the 4-partite graphs in Ft have at least 2 color classes connected to It, then we can we get Ft + 1  >  Ft. To see this assume that we have a subcover F'  ⊂  Ft, such that each Qi∈F' has at least 2 color classes connected to It and |V(F')|  ≥  γn. Let [formula] and without loss of generality, say Vi1 and Vi2 are the color classes in each Qi that are connected to It. For each such Qi, since |Vi1| = |Vi2| = mt  ≤  β( log n)1 / 3 and |It|  ≥  γn, by Lemma [\ref=subsetPHP_hyper] we can find two disjoint balanced complete 4-partite graphs (Ui1,Ai1,Bi1,Ci1) and (Ui2,Ai2,Bi2,Ci2) where Ui1 and Ui2 are subsets of Vi1 and Vi2 respectively, and Aik,BikCik, k∈{1,2} are disjoint subsets of It. The size of each color class of these new 4-partite graphs is at least γmt / 4 (see Figure [\ref=4_unif_2sided_extension]).

We remove the vertices of these new 4-partite graphs from their respective sets and add them to Ft + 1. Removing these vertices from Vi1 and Vi2 creates an imbalance in the leftover part of Qi (Vi3 and Vi4 have more vertices). To restore the balance, we discard (add to It) some arbitrary |Ui1|  =  |Ui2| vertices each from Vi3 and Vi4. The new 4-partite graphs use 6γmt / 4 vertices from It. Therefore even after discarding the vertices from Vi3 and Vi4 the net increase in the size of our cover is γmt, while all the 4-partite graphs are balanced. We repeat this procedure for every Qi∈F' and add the leftover part of Qi and all 4-partite graphs in [formula], to Ft + 1. Now, we split each 4-partite graph in Ft + 1 into disjoint balanced complete 4-partite graphs, such that each has a color class of size [formula] (we assume divisibility). Since |V(F')|  ≥  γn, by the above observation, we have |V(Ft + 1)|  ≥  |V(Ft)|  +  γ2n, hence Ft + 1  >  Ft.

Similarly, if there are 'many' edges that uses two vertices in It and two vertices from V(Ft) then we get Ft + 1  >  Ft. First note that the number of pairs of vertices of any 4-partite graph Qi∈Ft is O( log n)2 / 3, so the number of pairs of vertices within the 4-partite graphs in Ft is [formula]. Therefore the total number of edges, containing two vertices within a Qi∈Ft and two vertices in It is [formula], hence we ignore such edges. Let Qi  =  (Vi1,Vi2,Vi3,Vi4) and Qj  =  (Vj1,Vj2,Vj3,Vj4) be a pair of 4-partite graphs in Ft we say that It is connected to a pair of color classes (Vip,Vjq), (1  ≤  p,q  ≤  4), if [formula]. We say that It is k-sided to a pair [formula] if It is connected to k-pairs in {Vi1,Vi2,Vi3,Vi4}  ×  {Vj1,Vj2,Vj3,Vj4}. Assume that It is at least 9-sided to a 4γ-fraction of pairs of 4-partite graphs in [formula]. By a simple greedy procedure, (Lemma [\ref=folklore_min_degree_subgraph] and the 2-graph analog of Lemma [\ref=folklore_matching]) we get a disjoint set of pairs, [formula], such that for each pair (Qi,Qj)∈M', It is at least 9-sided to (Qi,Qj) and the number of vertices covered by M' is at least γn.

For every (Qi,Qj)∈M' we proceed as follows: Since It is connected to at least 9 pairs of color classes in {Vi1,Vi2,Vi3,Vi4}  ×  {Vj1,Vj2,Vj3,Vj4}, it is easy to see that we can find 3 disjoint pairs of color classes such that It is connected to each of them (say (Vi1,Vj1),(Vi2,Vj2)(Vi3,Vj3) are such disjoint pairs of color classes). We have |Vi1| = |Vj1|  =  mt  ≤  β( log n)1 / 3 and |It|  ≥  γn, so by definition of connectedness, the induced hypergraph, [formula] satisfies the conditions of Lemma [\ref=subsetPHP_hyper_2]. Therefore by Lemma [\ref=subsetPHP_hyper_2] we remove balanced complete 4-partite 4-graphs, such that each of them has one color class in Vi1, one in Vj1 and two color classes in It. Note that the conditions of Lemma [\ref=subsetPHP_hyper_2] are satisfied until in total we remove at least γmt / 2 vertices each from Vi1 and Vj1. We repeat the same process with (Vi2,Vj2)(Vi3,Vj3) (see Figure [\ref=4_unif_9Sided_pair_extended]). In total these new balanced complete 4-partite 4-graphs use 3γmt vertices from It and when we remove the vertices of the new 4-partite graphs, from Qi and Qj the remaining parts of Qi and Qj are not balanced (Vi4 and Vj4 have extra vertices). To restore the balance we remove an arbitrary set of vertices each from Vi4 and Vj4 (equal to the difference in color classes). Still the net increase in the number of vertices in the cover is at least 2γmt.

Applying this procedure for every (Qi,Qj)∈M' and making all of the 4-partite graphs of the same size, by splitting, we get Ft + 1. Again we have all 4-partite graphs balanced with color classes of size [formula] and Ft + 1  >  Ft.

Now, if we can not get Ft + 1  >  Ft, we must have that, in almost all 4-partite graphs in Ft, at most one color class is connected to It and almost all pairs of 4-partite graphs in [formula] are at most 8-sided. In particular this implies that for a typical vertex v∈It we have

[formula]

and

[formula]

From ([\ref=minDegOrig]), ([\ref=denI]) and the above degree bounds, for a typical vertex v∈It we have

[formula]

where the last inequality holds when |It|  ≥  γn and |V(Ft)|  ≥  n / 4. For a vertex v, consider the edges that v makes with 3-sets of vertices within a Qi∈Ft. The number of 3-sets of vertices of any Qi∈Ft is O( log n), (as the size of Qi is at most β log 1 / 3n), hence the total number of 3-sets of vertices within the 4-partite graphs in Ft is [formula]. Similarly the number of 3-sets of vertices which uses 2 vertices from a Qi and one vertex from some other Qj is [formula]. Therefore, for any vertex v, we ignore these types of edges and we will only consider the edges that v makes with 3-sets of vertices (x,y,z),  x∈V(Qi),  y∈V(Qj),  z∈V(Qk),  i  ≠  j  ≠  k. By the above observation, for the minimum degree of a typical vertex v∈It we still have

[formula]

Let [formula], [formula] and [formula] be three 4-partite graphs in Ft, we say that It is connected to a triplet of color classes (Vip,Vjq,Vkr), 1  ≤  p,q,r  ≤  4, if d4(It,(Vip  ×  Vjq  ×  Vkr))  ≥  2γ. For [formula] we consider the link graph Lijk as defined above (with It playing the role of the set Z).

For a constant η > 0, we say that It is (η,s)- connected to Ft, if there is a subset of triplets of 4-partite graphs, [formula], such that for each triplet (Qi,Qj,Qk)∈T, the link graph, Lijk has s edges and [formula].

A simple calculation, using ([\ref=min_cross_Degree]), implies that if It is (γ1 / 3,s)-connected to Ft for some s  ≤  36, then we also have that It is [formula]-connected to Ft.

We consider the following cases based on the way It is connected to Ft and show that either we get Ft + 1  >  Ft or H is extremal. First assume that It is [formula]- connected to Ft such that for every triplet (Qi,Qj,Qk)∈T, the link graph Lijk is not isomorphic to Hext. Then by lemma [\ref=folklore_min_degree_subgraph] and lemma [\ref=folklore_matching] there exists a set a disjoint set of triplets of 4-partite graphs, T'  ⊂  T, such that for each triplet (Qi,Qj,Qk)∈T' the link graph Lijk has at least 37 edges and is not isomorphic to Hext. Furthermore, the number of vertices covered by T' is at least γn.

Now, for each (Qi,Qj,Qk)∈T', since Lijk has at least 37 edges and Lijk  ≠  Hext, using Lemma [\ref=extensionLemma] we extend (Qi,Qj,Qk) to add at least γmt / 16 vertices to our cover. Clearly if we extend every triplet in T' the net increase in the size of our cover is at least γ2n / 16 (as the size of T' is at least γn). Similarly as above we can split the 4-partite graphs to make them of the same size and get Ft + 1  >  Ft.

On the other hand, if there is no such T, then we must have that It is not (γ1 / 3,s)- connected to Ft for any s  ≤  36, because otherwise, as observed above, we will get such a T. So, roughly speaking, for almost all triplets of 4-partite graphs in [formula], we have that the link graph of the triplet has exactly 37 edges and is isomorphic to Hext. Call a 4-partite graph Qi∈Ft good, if for almost all pairs of other 4-partite graphs Qj,Qk, we have that the link graph Lijk is isomorphic to Hext. By the above observation, almost all 4-partite graphs (covering ≥  (1 - 2γ1 / 3)|V(Ft)| vertices) are good. By a simple greedy procedure we find a set of disjoint triplets of 4-partite graphs, Tg, such that for each triplet (Qi,Qj,Qk)∈Tg, the link graph Lijk is isomorphic to Hext and all good 4-partite graphs are part of some triplet in Tg. Let the set of 4-partite graphs covered by Tg be Fg, clearly |V(Fg)|  ≥  (1 - 2γ1 / 3)|V(Ft)|. With relabeling we may also assume that in each triplet (Qi,Qj,Qk)∈Tg, Vi1,Vj1 and Vk1 are the color classes corresponding to the vertices of the link graph Lijk that intersect every edge of Lijk.

For every (Qi,Qj,Qk)∈Tg, by definition of connectedness and the sizes of the Qi,Qj and Qk, the 4-partite hypergraph induced by (Vi1,Vj2,Vk2,It) satisfies the conditions of Lemma [\ref=4partVolArg]. Hence applying Lemma [\ref=4partVolArg] we find a balanced complete 4-partite graphs Xi1 in H(Vi1,Vj2,Vk2,It). We also find two more disjoint balanced complete 4-partite graphs, Xi2 and Xi3 in H(Vi1,Vj3,Vk3,It) and H(Vi1,Vj4,Vk4,It). Since |It|  ≥  γn, we can find these complete 4-partite graphs that are disjoint from each other. The sizes of a color class in each of X11,X12 and X13 is [formula].

Similarly for each of Vj1 and Vk1 we find 3 disjoint balanced complete 4-partite graphs Xjp and Xkp in H(Vip,Vj1,Vkp,It) and H(Vip,Vjp,Vk1,It), (2  ≤  p  ≤  4), respectively. All of these these balanced complete 4-partite graphs are disjoint from each other and the size of a color class in each one of them is [formula].

By the definition of connectedness, the structure of the link graph Lijk and the fact that |It|  ≥  γn, clearly we can find these nine disjoint 4-partite graphs. And as argued above we repeat this process (remove another set of 9 such 4-partite graphs) until in total we remove γmt / 2 vertices from each of Vi1, Vj1 and Vk1, while γmt / 3 vertices from each of the other classes in Qi,Qj and Qk.

Note that these tripartite graphs in total use 3γmt / 2 vertices from It. But this creates an imbalance among the color classes of the remaining parts of Qi, Qj and Qk (Vi1,Vj1 and Vk1 have fewer vertices), to restore the balance we will have to discard γmt / 6 vertices from each color class in Qi, Qj and Qk except Vi1, Vj1 and Vk1. Which leaves us with no net gain in the size of the cover. Therefore we will not discard any vertices from these color classes at this time and say that these color classes have extra vertices. We proceed in similar manner for each triplet in Tg. So we have about γn / 24 extra vertices altogether.

Denote by Vg1,Vg2,Vg3 and Vg4 the union of the corresponding color classes of remaining parts of 4-partite graphs in Fg. Clearly |Vg2|  =  |Vg3|  =  |Vg4|  ≥  (1 - 2γ1 / 3)|V(Ft)| / 4  -  γn / 24  ≥  (1 / 16  -  3γ1 / 3)n. The last inequality follows from the lower bound on size of V(Ft) above, and the fact that γ is a small constant. We will show that either we can increase the size of our cover or we have

[formula]

For [formula], we only consider those edges that use exactly one vertex from a 4-partite graph Qi, as the number of edges of other types is o(n4). Assume that [formula] then by Lemma [\ref=hyperKST] there exist complete 4-partite graphs in [formula] covering at least γn vertices. We remove some of these 4-partite graphs (possibly with splitting and discarding part of it) such that from no color class we remove more then the number of extra vertices in that color class. Adding these new 4-partite graphs to our cover increases the size of our cover by at least γ2n vertices. As we will not need to discard vertices from [formula] for rebalancing. Instead the extra vertices are part of these new 4-partite graphs. In the remaining parts of Vg2, Vg3 and Vg4 we arbitrarily discard some extra vertices to restore the balance in the 4-partite graphs.

Similarly we will show that either we can increase the size of our cover or we have

[formula]

Indeed assume the contrary, i.e. [formula], then since both |It| and [formula] are at least γn, by Lemma [\ref=hyperKST] we can find disjoint complete 4-partite graphs with one color class in [formula] and three in It covering at least γ2n / 2 vertices. And again as above we can add these 4-partite graphs to our cover and increase the size of our cover as we have extra vertices in [formula]. By the same reasoning we can prove that there are very few edges that uses two vertices from [formula] and two from It.

From the above observations about the size of Fg and ([\ref=para]) we have that [formula]. Therefore if we can not increase the size of our cover significantly (by at least γ2n / 16 vertices), then by ([\ref=denI]), ([\ref=emptyV2V3V4]) and ([\ref=emptyV2V3V4_to_I]) we get that [formula]. Hence H is α-extremal.

The Extremal Case

Here our graph H is in the Extremal Case, i.e. there is a B  ⊂  V(H) such that

[formula]

d4(B)  <  α.

We assume that n is sufficiently large and α is a sufficiently small constant <  1. Let [formula], by shifting some vertices between A and B we can have that A = n / 4 and B = 3n / 4 as [formula] (we still keep the notation A and B). It is easy to see that we still have

[formula]

Since we have

[formula]

this together with ([\ref=extDen]) implies that almost all 4-sets of V(H) are edges of H except 4-sets of B. Thus roughly speaking we have that almost every vertex b∈B makes edges with almost all 3-sets of vertices in [formula], with almost all 3-sets of vertices in [formula] and with almost all 3-sets of vertices in [formula] and vice versa. Therefore, we will basically match every vertex in A with a distinct 3-set of vertices in [formula] (disjoint from all 3-sets matched with other vertices in A) to get the perfect matching. However some vertices may be ' atypical', in the sense that they may not have this connectivity structure hence we will first find a small matching that covers all such ' atypical' vertices. For the remaining ' typical' vertices we will show that they satisfy the conditions of König-Hall theorem, hence we will match every remaining vertex in A with a distinct 3-sets of remaining vertices in B.

A vertex a∈A is called exceptional if it does not make edges with almost all 3-sets of vertices in B, more precisely if

[formula]

A vertex a∈A is called strongly exceptional if it makes edges with very few 3-sets in B, more precisely if

[formula]

Similarly a vertex b∈B is called exceptional if it makes edges with many 3-sets of vertices in B more precisely if

[formula]

A vertex b∈B is called strongly exceptional if it makes edges with almost all 3-sets of vertices in B more precisely if

[formula]

Denote the set of exceptional and strongly exceptional vertices in A (and B) by XA and SXA respectively (similarly XB and SXB). Easy calculations using ([\ref=minDegree]) and ([\ref=extDen]) yields that [formula] and [formula] and for the strongly exceptional sets we have |SXA|  ≤  40α|A| and |SXB|  ≤  40α|B|. The constants are not the best possible but we choose them for ease of calculation.

If we have both SXB and SXA non empty, (say b∈SXB and a∈SXA) then since then we can exchange a with b and reduce the size of both SXB and SXA, as it is easy to see that both a and b are not strongly exceptional in their new sets. Hence one of the sets SXA and SXB must be empty.

Assume [formula]. By definition of SXB, for every vertex b∈SXB, we have [formula]. This together with the bound on the size of SXB implies that we can greedily find |SXB| vertex disjoint edges in H|B each containing exactly one vertex of SXB. We also select |SXB| other vertex disjoint edges such that each edge has two vertices in [formula] and the two other vertices are in A. We can clearly find such edges because by ([\ref=minDegree]) and definition of XB every vertex in [formula] makes edges with at least [formula]-fraction of 3-sets in [formula]. We remove the vertices of these edges from A and B and denote the remaining set by A' and B'. Let |A'| + |B'|  =  n', by the above procedure we have n'  =  n - 8|SXB|, |A'| = |A| - 2|SXB| and |B'| = |B| - 6|SXB| hence we get |B'|  =  3|A'|  =  3n' / 4. In case [formula] (and [formula]), we will first eliminate the vertices in SXA. Note that in this case any vertex b∈B is exchangeable with any vertex in SXA, because if there is a vertex b∈B such that [formula] then we can replace b with any vertex a∈SXA to reduce the size of SXA (as the vertex b is not strongly exceptional in A and a can not be strongly exceptional in the set B). Therefore we consider the whole set [formula]. By ([\ref=minDegree]) for any vertex [formula] we have

[formula]

where the last inequality holds when n is large enough and |SXA is small. So with a simple greedy procedure we find |SXA| disjoint edges in [formula] and remove these edges from H. Note that this is the only place where we critically use the minimum degree. We let [formula] and B' has all other remaining vertices. Again as above we have n'  =  n - 4|SXA|, |A'| = |A| - |SXA| and |B'| = |B| - 3|SXA| hence we get |B'|  =  2|A'|  =  3n' / 4.

Having dealt with the strongly exceptional vertices, the vertices of XA and XB in A' and B' can be eliminated using the fact that their sizes are much smaller than the crossing degrees of vertices in those sets. For instance as observed above we have [formula] while for any vertex a∈XA, we have that [formula] (because a∉SXA). Therefore by a simple greedy procedure for each a∈XA we delete a disjoint edge that contains a and three vertices from B'. Similarly for each b∈XB we delete an edge that contains b and uses one vertex from A' and the other two vertices from B' distinct from b. Clearly we can find such disjoint edges, hence we removed a partial matching that covers all vertices in the strongly exceptional and exceptional sets.

Finally in the leftover sets of A' and B' (denote them by A'' and B'', by construction we still have |B''| = 3|A''|) we will find |A''| disjoint edges each using one vertex in A'' and three vertices in B''. Note that for every vertex a∈A'' we have [formula] (as a∉XA). We say that a vertex bi and a pair bj,bk in B'' are good for each other if (bi,bj,bk,al)∈E(H) for at least (1 - 40α1 / 4)|A''| vertices al in A''. We have that any vertex bi∈B'' is good for at least [formula] pairs of vertices in B'' (again this is so because bi∉XB). We call such a (bi,bj,bj) a good triplet. We randomly select a set T1 of 100α1 / 4|B''| vertex disjoint 3-sets of vertices in B''. By the above observation with high probability every vertex a∈A'' make edges in H with at least 3|T1| / 4 triplets in T1 and every triplet in T1 makes an edge with at least 3|A''| / 4 vertices in A''. In [formula] still every vertex is good for almost all pairs (as the size of T1 is very small). We cover vertices in [formula] with disjoint good triplets (i.e. the triplet makes an edge in H with at least (1 - 40α1 / 4)|A''| vertices in A''. This can be done by considering a 3-graph with vertex set [formula] and all the good triplets as its edges. As argued above every vertex is good for almost all pairs. We can find a perfect matching in this 3-graph (see [\cite=Khan_3u_vertDeg]). Let the set of triplets in this perfect matching be T2. Now construct an auxiliary bipartite graph G(L,R), such that L = A'' and vertices in R corresponds to the triplets in T1 and T2. A vertex in al∈L is connected to a vertex y∈R if the triplet corresponding to y (say bi,bj,bk) is such that (bi,bj,bk,al)∈E(H). We will show that G(L,R) satisfies the König-Hall criteria. Considering the sizes of A'' and T1 it is easy to see that for every subset Q  ⊂  R if |Q|  ≤  (1 - 40α1 / 4)|A''| then |N(Q)|  ≥  |Q|. When |Q| > (1 - 40α1 / 4)|A''| (using |B''| = 2|A''|) any such Q must have at least 6|T1| / 10 vertices corresponding to pairs in T1, hence with high probability N(Q)  =  L  ≥  |Q|. Therefore there is a perfect matching of R into L. This perfect matching in G(L,R) readily gives us a matching in H covering all vertices in A'' and B'', which together with the edges we already removed (covering strongly exceptional and exceptional vertices) is a perfect matching in H.  [formula]