Lemma Proposition Corollary

Boundary crossing Random Walks, clinical trials and multinomial sequential estimation.

Introduction

In many applications stochastic processes are used to model the behavior of some phenomena up to the first crossing of a threshold. It is the case of neuronal modeling, population dynamics, ruin probabilities... (just to mention a few). Parametric inference is needed to calibrate such models in order to obtain good fits with experimental data and specific sequential statistical methods are needed (cf. e.g. [\cite=susanne]). In many cases Random Walks (RWs) might be used as toy models for such phenomena. In the special case where the increments are independent Bernoulli random variables, then a classical result in binomial sequential estimation (cf. [\cite=Girshick1946]) may be applied to find an unbiased estimator. In [\cite=savage] (updating other references quoted therein) a sufficient condition for the uniqueness of the unbiased estimator is found. If we have a RW on a higher dimensional lattice or any other RW whose increments have k possible outcomes with probabilities [formula], a generalization of the above result still applies. Indeed in [\cite=multinomial] and [\cite=kremers] unbiased sequential estimation is extended to the multinomial context. In such a case a sufficient condition for the uniqueness of the unbiased estimators is not available. The present letter fills this gap and presents a few examples where unbiased estimation is applied to multidimensional or multinomial boundary crossing RWs. An application of sequential estimation of the multinomial probabilities that deserve a special attention is that following phase II multistage clinical trials (cf. [\cite=multinomial-trials]) where patients are classified according to their respondence to a treatment. A short account of such application concludes the paper. Further relevant results related to the main topic can be found in [\cite=bhat-efficient] regarding efficient multinomial sampling plans, in [\cite=sinha] for a review of the binomial case and in [\cite=sinha2] for generalizations to the quasi-binomial context.

Unbiased multinomial sequential estimation

We consider a repeated experiment having k possible outcomes occurring with probabilities [formula]. Denote by [formula] the process whose components [formula] count how many occurrences of events of type i we had at the n-th (independent) repetition. The process Xn lives in the hyper-plane where the sum of the coordinates is n. Denoting by [formula] the portion of such plane where all the coordinates are positive or null and [formula] the set of points in Sn with natural coordinates, for any n we have [formula].

Let Xn be observed until it reaches the boundary B of an accessible region [formula] (we mean those points which are not in R but that might be reached in one step starting from R).

For every point y∈B with coordinates [formula] let us denote by k(y) the number of paths in R that start at the origin and end in y and by [formula] the number of those that end in y but start in the point whose i - th coordinate is 1 and the others are 0. The probability that the first hitting to the boundary occurs in y is

[formula]

The region R is defined to be closed if [formula].

For any closed region R, the ratios

[formula]

are unbiased estimators for the probabilities pi.

A sufficient condition on the region R for the estimator [\eqref=est] to be the unique bounded unbiased estimator for the binomial (k=2) probability is given in [\cite=savage]. We are going to generalize it to the multinomial context. For any n the region [formula] and its boundary B project onto [formula] defining the accessible points of order n, [formula], the inaccessible points [formula] and (among them) the boundary points [formula]. R is said to be a simple region if for any n the convex hull H(Rn) of Rn does not contain inaccessible points.

If the region [formula] is simple and closed, the estimators [\eqref=est] are the unique bounded unbiased estimators of the parameters pi.

We adapt the method in [\cite=savage], but we need the following Lemma (obvious when k = 2) that will be proved after the main theorem.

Let R be a simple region, and n an order such that in [formula] there are both accessible and boundary points. Among any collection of boundary points Cn  ⊂  Bn it is always possible to choose a ∈Cn and a (k - 2)-hyperplane [formula] lying in the (k - 1)-hyperplane that contains Sn such that

[formula]

[formula] is identified by two linear equations

[formula]

where [formula] one vanishing and at least one non-vanishing and [formula].

on Rn we have L(x)  ≥  b + 1

at any other boundary point y∈Cn, we have L(y)  ≥  b + 1

If the theorem were false we would have another unbiased estimator Û of pi and the difference Δ  =  p̂i  -  Û would be a non-identically vanishing unbiased estimate of zero. Since the first boundary point y hit by the process is a sufficient statistics (cf. [\cite=ferguson], Section 7.3, Lemma 1), we restrict to those estimators that are function of it and [formula]. Let m be the smallest integer such that Δ is not vanishing at one element of Bm. If [formula] for such m then the region R is finite and the thesis follows from Theorem 4 in [\cite=kremers]. If instead [formula] contains accessible points we apply Lemma [\ref=lemma] to the collection Cm of boundary points y∈Bm such that Δ(y)  ≠  0 and find a point [formula] and a linear combination [formula] (for notational convenience we stipulate that the vanishing coefficient is the first one) with [formula] such that L() = b and that for any [formula] we have L(z)  ≥  b + 1. A fortiori L(y)  ≥  b + 1 at any y in any Bn with n > m since any such a y may only be reached evolving from an x∈Rm. For some positive [formula] we have

[formula]

We are going to show that there are values of the parameters at which such inequality cannot hold. By construction any path from the origin to an y∈B such that [formula] and L(y)  ≥  b + 1 either ends in Cm or crosses Rm. In [formula] we have a finite number F of points [formula] and there L(zi)  ≥  b + 1. For any y∈B such that [formula] and L(y)  ≥  b + 1 we have

[formula]

Let us now choose the parameters [formula] in such a way that for some common factor 0 < p < 1 we have pi = pmi for any [formula]. We get

[formula]

and inequality [\eqref=ineq] becomes

[formula]

that is always violated when p is small enough.

Existence of an y' and of a πy' satisfying conditions 1. and 3. with rational coefficients in [\eqref=sistema] is ensured by the Separating Hyperplane theorem (cf. [\cite=ferguson], Sec. 2.7) and the density of [formula] in [formula]. To get natural coefficients in [\eqref=sistema] it is then sufficient to multiply the first equation by a suitable integer and to add to it the second equation a sufficient number of times. Let us denote by L'(x) = b' the new equation of πy' meeting the first three conditions. Condition 4. may still not be fulfilled by πy'. Let us denote by c  ≤  b' the minimum value taken by L' on Cn and let us consider the plane πc with first equation L'(x) = c. If it intersects Cn in one and only one point we have found both the point and the plane satisfying condition 4. If [formula] contains more than one point, let us select one with the following algorithm. Start with the last coordinate xn and select the points in [formula] where xk is largest. Among them choose those at which xk - 1 is largest and continue until the choice of the largest j-th coordinate singles out one and only one point [formula] of [formula]. Now consider the plane π,r with first equation

[formula]

Of course π,r still passes through [formula], and equation [\eqref=www], once multiplied by rk, has integer coefficients. Moreover, since Rn is finite and since L(x) - b > 0 for any x∈Rn, we can take r large enough to ensure both that Lr(x) - br > 0 for every x∈Rn and that the coefficients are natural. The same argument applies to the points in Cn  -  πc. Moreover for any [formula] we have

[formula]

which is certainly positive due to the algorithm we used to select [formula].

Examples

In the following examples we derive the unbiased estimators for some multidimensional or multinomial RWs observed up to the crossing of a boundary.

RWs on a bidimensional lattice

Let Wi be a RW on [formula] such that W0 = 0 and Wi = Wi - 1  +  Ii where the increments Ii take the values (0,1), (1,0),(0,-1) and (-1,0) with probabilities p1,p2,p3 and [formula]. Let Wi be observed up to the first time its second component equals b > 0. The process [formula] whose components xin count how many occurrences of increments of type i we had at the n-th step of the RW is of the kind described in Section [\ref=teoria] and it is observed until it hits [formula]. The accessible region is closed whenever p1  ≥  p3 > 0 and simple. The maximum likelihood (ML) estimators of the pi are XiN / N, while the unique unbiased estimators [\eqref=est] are

[formula]

The trajectory count is based on the reflection principle (cf. [\cite=feller]).

The results of a simulation study performed on 10.000 paths are shown in Table [\ref=bidimensionale]. The performances of the two methods are not much different and the best choice depends on the parameter range. When p1 is close to p3 some of the unbiased estimators have a smaller mean square error than the corresponding ML, while when p1 is higher ML estimates are better. Let us remark that the estimates of parameters p2 and p4, in the direction on which the RW is not constrained, are estimated much better than the other two.

A simple RW allowing for null steps

Let Wi be a RW on [formula] such that W0 = 0 and Wi = Wi - 1  +  Ii where the increments Ii are 1, 0 or -1 with probabilities p1,p2 and [formula]. Still we count the increments by [formula]. Wi is observed up to the first time it equals b > 0 and Xi until X1 - X3 = b. The accessible region is simple and whenever p1  ≥  p3 > 0 also closed. ML estimators are again the sample proportions, and the unbiased ones are

[formula]

Sequential multinomial estimation and clinical trials

In a multinomial multistage phase II cancer trial (cf. [\cite=multinomial-trials]) a group of patients is treated with a new drug and then classified as responders if tumor shrinkage is more than 50%, non-responders if it is less and early progressions if they undergo a progress in the disease. A decision is taken whether to stop the trial and conclude that the therapy is promising (or ineffective) if the responders are more (less) than a predetermined value and the early progressions are less (more) than another value. In the intermediate case when the number of respondent patients or of the early progressions is between the thresholds a new group of patients is enrolled and the trial continue to a next stage. Estimation of the probability of response and early progressions after such trials matters in practice. In the case of a binomial trial (patients are either responders or non-responders) the presence of a bias from ML was already noticed in [\cite=JungTrials] and unbiased estimators were studied. The design proposed in [\cite=multinomial-trials] was the following: let K be the maximum number of stages allowed and ns for [formula] the number of patients enrolled in each stage. We denote by [formula] the number of patients involved up to the s-th stage. The process Xj = (rj,j - rj - ej,ej) counts the number of respondent, non-respondent and early progressions among the first j patients. For any j  ≠  Ns the trial is continued, but when j = Ns for some s < K there are three options:

the trial is stopped and the therapy considered promising if rNs  ≥  ρPs and eNs  ≤  εPs and such stopping region is denoted by BPNs

the trial is stopped and the therapy considered ineffective if rNs  ≤  ρIs and eNs  ≥  εIs and such stopping region is denoted by BINs

the trial is continued to stage s + 1 if ρIs  ≤  rNs  ≤  ρPs or εPs  ≤  eNs  ≤  εIs and such continuation region is denoted by RNs.

The trial ends at a random stage S  ≤  K with a final observation XNS = (r,NS - r - e,e). The probabilities of response and of an early progression can be estimated by means of the unbiased estimators [\eqref=est] that are

[formula]

where [formula] denotes the multinomial coefficient [formula] and the sums are performed over the triples (rNi,yi,eNi) belonging to the continuation regions RNi with i < S.

Conclusion

The main result of the paper is to prove that simplicity of the accessible region R is a sufficient condition to ensure the uniqueness of the unbiased estimators [\eqref=est]. Of course the availability (and the uniqueness) of unbiased estimators does not mean that they are the best way to estimate the parameters and the simulation study performed on RWs in Sec.[\ref=RW] shows that there are both parameter ranges where the unbiased estimators are superior than ML and vice-versa. The bias of the ML estimators, moreover, can be reduced as in [\cite=whitehead] or by bootstrapping and the best method to be used needs to be decided case by case. Multinomial clinical trials provide an important application of the method presented.