Lemma

The existence of k-radius sequences

Introduction

Let n and k be positive integers, and let F be an alphabet of size n. A sequence [formula] over F of length m is a k-radius sequence if for all x,y∈F there exists [formula] such that ai = x, aj = y and |i - j|  ≤  k. The following is an example of an 8-ary 3-radius sequence over the alphabet F = {0,1,2,3,4,5,6,7}:

[formula]

We write fk(n) for the length of the shortest n-ary k-radius sequence; so the example above shows that f3(8)  ≤  16.

The concept of a k-radius sequence was introduced by Jaromczyk and Lonc [\cite=JL]. They were interested in these sequences so they could design an efficient caching strategy to compute a function that depends on comparing pairs of a sequence of large data sets such as medical images (see the discussion in Section [\ref=sec:comments] below).

Ghosh [\cite=Ghosh] showed that

[formula]

Jaromczyk and Lonc [\cite=JL] showed that [formula], and gave a construction for k-radius sequences of the right order of magnitude but with a leading term that is not tight. Chee, Ling, Tan and Zhang [\cite=CheeLing] provided good constructions for n-ary 2-radius sequences for small values of n. Blackburn and McKee [\cite=BlackburnMcKee] showed how to construct asymptotically good k-radius sequences for many values of k. In particular, their constructions show that [formula] whenever k  ≤  194, or k + 1 is a prime, or 2k + 1 is a prime. They asked whether [formula] exists and is equal to 1 / k. The main purpose of this paper is to answer this question positively, by proving the following theorem.

Let k be a fixed positive integer. Then

[formula]

as n  →    ∞  .

We use probabilistic methods, our main tool being Pippenger and Spencer's version of the Frankl-Rodl theorem on the size of the matchings in a quasi-random hypergraph [\cite=FranklRodl] [\cite=PippengerSpencer] (see Section [\ref=sec:comments]).

Theorem [\ref=thm:main] is proved in the next section. In the final section of the paper we observe that the proof of this theorem can be generalised (Theorem [\ref=thm:general]) to the situation where we are interested in subsets of t elements, rather than pairs of elements, from the alphabet. The final section also contains various comments and open problems.

The proof of Theorem [\ref=thm:main]

We begin with an elementary lemma which establishes a lower bound on fk(n). Jaromczyk and Lonc [\cite=JL] prove a slightly stronger version of this lemma in their paper.

For all positive integers n and k,

[formula]

Let [formula] be an n-ary k-radius sequence. There are less than km pairs of the form {ai,ai + z} where [formula] and 1  ≤  z  ≤  k. The k-radius sequence property implies that every unordered pair of alphabet symbols must occur at least once as a pair {ai,ai + z} for some i and z, and so [formula].

To provide an upper bound on fk(n), we use a well-known theorem in hypergraph theory. Recall that a hypergraph Γ is r-uniform if all its hyperedges have cardinality r. The degree deg (v) of a vertex v∈Γ is the number of hyperedges containing v; the codegree [formula] of a pair of distinct vertices v,w∈Γ is the number of hyperedges containing both v and w. A cover is a set of hyperedges in Γ whose union is equal to the set of all vertices of Γ.

Fix an integer r and a positive real number δ. Then there exists an integer n0 and a positive real number δ' with the following property.

Let Γ be an r-uniform hypergraph on n vertices, where n  ≥  n0. Suppose that all vertices of Γ have degree d for some integer d. Let [formula], where the maximum is taken over all pairs of distinct vertices u,v∈Γ. If c  ≤  δ'd, then there exists a cover consisting of at most (1 + δ)n / r hyperedges.

Theorem [\ref=thm:hypergraph] can be proved using a second-moment technique that Alon and Spencer [\cite=AlonSpencer] call the 'Rödl nibble' (see [\cite=Rodl] [\cite=FranklRodl] or [\cite=Furedi] for example). Also see Pippenger and Spencer [\cite=PippengerSpencer] for a stronger result.

We need to prove that [formula]. Now [formula] by Lemma [\ref=lem:lower_bound]. Let ε be a fixed positive real number. To prove the theorem, it suffices to show that for all sufficiently large integers n, we have that [formula].

Choose an integer [formula] and a positive real number δ such that [formula] and

[formula]

Let n be an integer such that [formula], and let F be a set of cardinality n. Define a hypergraph Γn as follows. The vertices of Γn are the [formula] unordered pairs {x,y} where x,y∈F. The hyperedges of Γn are the [formula] sequences [formula] of length [formula] over F whose entries bi are all distinct. We define a vertex {x,y} to lie in a hyperedge [formula] whenever x and y occur in [formula] within a distance of k; more precisely, whenever there exist [formula] such that bi = x, bj = y and |i - j|  ≤  k.

Let r be the number of ways of choosing an (unordered) pair of distinct positions in a sequence of length [formula], where the positions are at most a distance k apart. So

[formula]

Clearly r does not depend on n. Since the entries of [formula] are distinct, every hyperedge in Γn contains exactly r vertices, and so Γn is an r-uniform hypergraph. The degree d of any vertex v∈Γn is equal to [formula], which is of the order of [formula]. The codegree of distinct vertices v,w∈Γn depends on whether v and w are intersecting when thought of as pairs of elements of F. But in either case [formula]. So Theorem [\ref=thm:hypergraph] implies that for all sufficiently large integers n there exists a cover [formula] for Γn consisting of s hyperedges, where [formula].

The definition of Γn and the fact that the sequences [formula] form a cover show that the concatenation of [formula] is a k-radius sequence. The length of this sequence is [formula], and

[formula]

So [formula] for all sufficiently large integers n, as required.

Comments

We have found the leading term for fk(n) as n  →    ∞   with k fixed using probabilistic methods. It would be very interesting to search for explicit constructions of k-radius sequences that are asymptotically good for any value of k. (The constructions of Jaromczyk and Lonc [\cite=JL] and of Blackburn and McKee [\cite=BlackburnMcKee] only lead to asymptotically good constructions for some values of k.) The following problem would also be very interesting:

Provide an upper bound (using explicit or probabilistic methods) of the form

[formula]

where g(n) is a function of n that grows significantly more slowly than n2.

Note added in final revision: A recent preprint of Jaromzcyk, Lonc and Truszczynski [\cite=JLT] provides some beautiful recursive constructions of k-radius sequences, solving Open Problem [\ref=prob:k_radius]. Indeed, they show that we may take g(n) = O(n1 + ε) for any positive real number ε. They also give optimal constructions of 2-radius sequences when n = 2p with p a prime.

We now discuss the caching application that motivated Jaromczyk and Lonc in a little more detail. Suppose we have a total of n medical images, and we wish to compute some function which depends on all pairs of these images. We assume that the computation involving each pair of images is computationally intensive, so we wish to place these images in our cache before carrying out this computation. We assume our cache can hold up to k + 1 images at one time. Then an n-ary k-radius sequence will enable us to design an efficient caching strategy, as follows. Let [formula] be an n-ary k-radius sequence. Suppose we load image at into our cache at time t, using a first-in first-out caching strategy. So at time t (for t  ≥  k + 1) our cache holds the images [formula]. The property of being a k-radius sequence implies that any pair of alphabet symbols occurs in some window of length k + 1 in the sequence, and so any pair of images simultaneously lies in our cache at some point. Short sequences correspond to efficient caching strategies for this problem.

We might ask what the consequences are of removing our insistence on a first-in first-out strategy in the application above. But whatever caching strategy is used it is clear that at most k new pairs of images are introduced into our cache at every time period: the bound of Lemma [\ref=lem:lower_bound] holds for any caching strategy. So the results of this paper show that imposing the restriction to a first-in first-out strategy does not affect the asymptotic efficiency. We should also remark that when we are not imposing the restriction to a first-in first-out strategy there is a simple caching method that gives asymptotically tight results, which can be described as follows. We begin by loading the first batch of k images [formula] into the cache. Our cache can store one more image: keeping our initial batch of images in our cache, we load all the remaining images in turn. So at time k + i where 1  ≤  i  ≤  n - k, the cache holds images [formula] and k + i. We then continue with the next batch of k images [formula]: at time n + k + i where 1  ≤  i  ≤  n - 2k the cache holds images [formula] and 2k + i. We continue in this way, first loading a batch of k images into our cache and then using the remaining space to load each of the later images in turn.

The results of this paper are easily generalised to a wider class of combinatorial objects. Let k, t and n be fixed positive integers, with t  ≤  n. Let F be an alphabet of cardinality n. We may define a t-subset k-radius sequence over F to be a finite sequence [formula] over F such that for all t-subsets X  ⊆  F, there exists [formula] such that

[formula]

So a k-radius sequence satisfies this definition in the special case when t = 2. Let ft,k(n) be the length of the shortest t-subset k-radius sequence.

Let k and t be fixed integers such that 2  ≤  t  ≤  k + 1. Then

[formula]

as n  →    ∞  .

The lower bound follows by observing that each new element added to a sequence can 'cover' at most [formula] new subsets X (as these new subsets must involve the new element).

The upper bound follows as in the proof of Theorem [\ref=thm:main]. So we define the hypergraph Γn to have hyperedges as before, with vertices the t-subsets of the n-set F, and with a vertex lying in a hyperedge [formula] if and only if the subset is contained in a set of k + 1 consecutive elements of the sequence [formula]. The graph Γn is r-uniform, where [formula] for some fixed function h of k and t. The degree of a vertex in Γn does not depend on the vertex and is of the order of [formula], whereas the codegree of a pair of vertices depends on the size of intersection of the subsets the vertices are identified with, but is at most [formula]. We may use Theorem [\ref=thm:hypergraph] to obtain a small cover for Γn, and then concatenate the resulting sequences in this cover to obtain a short t-subset k-radius sequence, just as in the proof of Theorem [\ref=thm:main].

Find good explicit constructions of t-subset k-radius sequences.

This problem has been considered in the case t = k + 1 by Lonc, Traczyk, and Truszczynski [\cite=LTT]. The authors show that [formula], determine f3,2(n) exactly and determine f4,3(n) and f6,5(n) for infinitely many values of n.

The corresponding packing rather than covering problem is also interesting combinatorially (although we do not know of an application). Here we may define a packing t-subset k-radius sequence over F to be a sequence [formula] over F with the property that any t-subset X  ⊆  F only occurs as a subset of [formula] in at most one position in the sequence. More precisely, we require that for all t-subsets X  ⊆  F there exists at most one choice for an increasing sequence [formula] of integers such that

[formula]

and where |zt - z1|  ≤  k.

Define Ft,k(n) to be the length of the longest packing t-subset k-radius sequence. Find good asymptotic lower bounds on Ft,k(n), either using probabilistic or explicit constructions.

This problem has been considered in the case when t = k + 1 by Curtis, Hines, Hurlbert and Moyer [\cite=CHHM] under the name of Ucycle packings. The authors prove that for any t, we have

[formula]

Their work was motivated by the concept of a universal cycle; see [\cite=CDG] [\cite=Hurlbert] [\cite=Jackson].

Acknowledgement

The author would like to thank Jason Crampton for pointing out the simple caching construction described in Section [\ref=sec:comments], and the referees for suggesting several improvements in the exposition and bibliography.