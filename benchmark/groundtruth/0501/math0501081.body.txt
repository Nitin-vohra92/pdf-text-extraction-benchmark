Corollary Lemma Proposition Definition Remark

Path Coupling Using Stopping Times and CountingIndependent Sets and Colourings in Hypergraphs

,   Martin Dyer[formula] and Marek Karpinski

Introduction

We develop a new approach to using stopping times in conjunction with path coupling to bound the convergence of time of Markov chains. Our main interest is in applying these results to randomised approximate counting. For an introduction, see [\cite=J03]. To illustrate our methods, we consider approximation of the numbers of independent sets and q-colourings in hypergraphs with upper-bounded degree, and lower-bounded edge size. These problems in hypergraphs are of interest in their own right but, while approximate optimisation has received attention [\cite=DRS02] [\cite=DGKR03] [\cite=HL98] [\cite=KNS01], there has been surprisingly little work on approximate counting.

Our results are achieved by considering, in the path coupling setting, the stopping time at which the distance between two coupled chains first changes. The first application of stopping times to path coupling was by Dyer, Goldberg, Greenhill, Jerrum and Mitzenmacher [\cite=DGGJM01]. Their analysis was later improved by Hayes and Vigoda [\cite=HV04], using a method closely related to that developed in this paper. Theorem [\ref=stopping], the main technical result of the paper, shows that if the expected distance between the two chains has decreased at this stopping time, then the chain mixes rapidly. This also follows from [\cite=HV04]. However we give a simpler proof than that of [\cite=HV04], and our Theorem [\ref=stopping] will usually give a moderate improvement in the bound on mixing time in comparison with [\cite=HV04]. See Remark [\ref=rem20] below.

The problem of approximately counting independent sets in graphs has been widely studied, see for example [\cite=DFJ99] [\cite=DG00a] [\cite=LV99] [\cite=M01] [\cite=V01], but the only previous work on the approximate counting of independent sets in hypergraphs seems to that of Dyer and Greenhill [\cite=DG00a]. They showed rapid mixing to the uniform distribution of a simple Markov chain on independent sets in a hypergraph with maximum degree 3 and maximum edge size 3. However, this was the only interesting case resolved. Their results imply rapid mixing only for m  ≤  Δ / (Δ - 2), which gives m  ≤  3 when Δ = 3 and m  ≤  2 when Δ  ≥  4. In Theorem [\ref=indsets] we prove rapid mixing of the Glauber dynamics for any hypergraph such that m  ≥  2Δ + 1, where m is the smallest edge size and Δ is the maximum degree. This is a marked improvement for large m. More generally, we consider the hardcore distribution on independent sets with fugacity λ. (See, for example, [\cite=DG00a] [\cite=LV99] [\cite=V01].) In [\cite=DG00a], it is proved that rapid mixing occurs if λ  ≤  m / ((m - 1)Δ - m). Here we improve this considerably for larger values of m, to λ  ≤  (m - 1) / 2Δ. We also give proofs that computing the number of independent sets in hypergraphs is #P-complete except in trivial cases, and that there can be no approximation for the number of independent sets in a hypergraphs if the minimum edge size is at most logarithmic in Δ. It may be noted that our upper and lower bounds are exponentially different. We have no strong belief that either is close to the threshold at which approximate counting is possible, if such a threshold exists.

Counting q-colourings of hypergraphs was considered by Bubley [\cite=B01], who showed that the Glauber dynamics was rapidly mixing if q  ≥  2Δ, generalising a result of Jerrum [\cite=J95] and Salas and Sokal [\cite=SS97] for graphs. Much work has been done on improving this result for graph colourings, see [\cite=DFHV04] and its references, but little attention appears to have been given to the hypergraph case. Here we prove rapid mixing of Glauber dynamics for proper colourings of hypergraphs if m  ≥  4, q > Δ, and if m = 3, [formula]. For a precise statement of our result see Theorem [\ref=colouring]. Again we give proofs that computing the number of colourings in hypergraphs is #P-complete except in trivial cases, and that there can be no approximation for the number of colourings of hypergraphs if q  ≤  (1 - 1 / m)Δ1 / (m - 1). Again, there is a considerable discrepancy between the upper and lower bounds for large m.

The paper is organised as follows. Section [\ref=sec:intuit] gives an intuitive motivation for the stopping time approach of the paper. Section [\ref=sec:stopping] contains the full description and proof of Theorem [\ref=stopping] for path coupling with stopping times. We apply this to hypergraph independent sets in Section [\ref=sec:indsets]. Section [\ref=sec:hard] contains the hardness proofs. Section [\ref=sec:colour] contains analysis of the Glauber dynamics for hypergraph colouring. Finally, Section [\ref=sec:hardcol] contains the hardness results for counting colourings in hypergraphs.

Intuition

Let H = (V,E) be a hypergraph of maximum degree Δ and minimum edge size m. A subset S  ⊆  V of the vertices is independent if no edge is a subset of S. Let Ω(H) be the set of all independent sets of H. Let λ be the fugacity, which weights independent sets. (See [\cite=DG00a].) The most important case is λ = 1, which weights all independent sets equally and gives rise to the uniform distribution on all independent sets. We define the Markov chain M(H) with state space Ω(H) by the following transition process (Glauber dynamics). If the state of M at time t is Xt, the state at t + 1 is determined by the following procedure.

Select a vertex v∈V uniformly at random,

if v∈Xt let [formula] with probability 1 / (1 + λ),

if [formula] and [formula] is independent, let [formula] with probability λ / (1 + λ),

otherwise let Xt + 1 = Xt.

This chain is easily shown to be ergodic with stationary probability proportional to λ|I| for each independent set I  ⊆  V. In particular, λ = 1 gives the uniform distribution. The natural coupling for this chain is the "identity" coupling, the same transition is attempted in both copies of the chain. If we try to apply standard path coupling to this chain, we immediately run into difficulties. Consider two chains Xt and Yt such that [formula], where w∉Xt (the change vertex) is of degree Δ. An edge e∈E is critical in Yt if it has only one vertex z∈V which is not in Yt, and we call z critical for e. If each of the edges through w is critical for Yt, then there are Δ choices of v in the transition which can be added in Xt but not in Yt. Thus, if λ = 1, the change in the expected Hamming distance between Xt and Yt after one step could be as high as [formula]. Thus we obtain rapid mixing only in the case Δ = 2. This case has some intrinsic interest, since the complement of an independent set corresponds, under hypergraph duality, to an edge cover [\cite=GJ79] in a graph. Thus we may uniformly generate edge covers, but the scope for unmodified path coupling is obviously severely limited.

The insight on which this paper is based is as follows. Although in one step it could be more likely that a bad vertex (increasing Hamming distance) is chosen than a good vertex (decreasing Hamming distance), it is even more likely that one of the other vertices in an edge containing w is chosen and removed from the independent set. Once the edge has two unoccupied vertices other than w, then any vertex in that edge can be added in both chains. This observation enables us to show that, if T is defined to be the stopping time at which the distance between Xt and Yt first changes, the expected distance between XT and YT will be less than 1. Theorem [\ref=stopping] below shows that under these circumstances path coupling can easily be adapted to prove rapid mixing.

Having established this general result, we use it to prove that M(H) is rapidly mixing for hypergraphs with m  ≥  2λΔ + 1. Note that, though all the results in this paper will be proved for uniform hypergraphs of edge size m, they carry through trivially for hypergraphs of minimum edge size m.

Path coupling using a stopping time

First we prove the main result discussed above.

Let M be a Markov chain on state space Ω. Let [formula] be an integer valued metric on Ω  ×  Ω, and let (Xt,Yt) be a path coupling for M, where S is the set of pairs of states (X,Y) such that [formula]. For any initial states (X0,Y0)∈S let T be the stopping time given by the minimum t such that [formula]. Suppose, for some p > 0, that

Pr (T = t  |  T  ≥  t)  ≥  p, independently for each t,

[formula].

Then M mixes rapidly. In particular the mixing time τ(ε) of M satisfies

[formula]

where [formula] and [formula].

Consider the following game. In each round a gambler either wins £1, loses some amount £(l - 1) or continues to the next round. If he loses £(l - 1) in a game, he starts l separate (but possibly dependent) games simultaneously in an effort to win back his money. If he has several games going and loses one at a certain time, he starts l more games, while continuing with the others that did not conclude. We know that the probability he finishes a game in a given step is at least p, and the expected winnings in each game is at most 1 - α. The question is: does his return have positive expectation at any fixed time ? We will show that it does. But first a justification for our interest in this game.

Each game represents a single step on the path between two states of the coupled Markov chain. We start with X0 and Y0 differing at a single vertex. The first game is won if the first time the distance between the coupled chains changes is in convergence. The game is lost if the distance increases to l. At that point we consider the distance l path Xt to Yt, and the l games played represent the l steps in the path. Although these games are clearly dependent, they each satisfy the conditions given. The gambler's return at time t is one minus the length of the path at time t, so a positive expected return corresponds to an expected path length less than one. We will show that the expected path length is sufficiently small to ensure coupling.

First note that the gambler's return at time t is one minus the number of games active at time t. For the initial game we define the level to be zero, for any other possible game we define the level to be one greater than the level of the game whose loss precipitated it. We define the random variables Mk,ljk and Ijk(t) as follows. Mk is the number of games at level k that are played, ljk, for [formula], is the number of games in level k + 1 which are started as a result of the outcome of game j in level k, and Ijk(t) is an indicator function which takes the value 1 if game j in level k is active at time t, and 0 otherwise. Let N(t) be the number of games active at time t. Then, by linearity of expectations,

[formula]

We will bound this sum in two parts, splitting it at a point k = K to be determined. For k  ≤  K we observe that Mk  ≤  Dk2. Since Pr (Ijk(t) = 1) is at most the probability that exactly k - 1 games of a sequence are complete at time t, regardless of outcome, we have

[formula]

So that

[formula]

On the other hand, for k > K we observe that

[formula]

Since [formula] for any starting conditions, we may apply this bound even when conditioning on Mk - 1. So

[formula]

using linearity of expectation, induction and [formula]. Putting [\eqref=front] and [\eqref=tail] together we get

[formula]

We now set [formula], hence the final term is at most ε / 2D1. The probability that a game completes in any given step is at least p. If we select a time τ  ≥  c / p for c  ≥  K + 1  ≥  1, then the probability that at most K games are complete is clearly maximised by taking this probability to be exactly p in all games. Hence, by Chernoff's bound (see, for example, [\cite=JLR00]),

[formula]

Choosing [formula], we obtain [formula], where [formula].

We conclude that the gambler's expected return at time τ is positive. More importantly, for any initial states X0,Y0∈Ω, the expected distance at time τ is at most ε by linearity of expectations, and so the probability that the chain has not coupled is at most ε. The mixing time claimed now follows by standard arguments. See, for example, [\cite=J03].

The assumption that the stopping time occurs when the distance changes is not essential. We clearly cannot dispense with assumption (ii), or we cannot bound mixing time. Assumption (i) may appear a restriction, but appears to be naturally satisfied in most applications. It seems more natural than the assumption of bounded stopping time, used in [\cite=HV04]. Assumption (i) can easily be replaced by something weaker, for example by allowing p to vary with time rather than remain constant. Provided p  ≠  0 sufficiently often, a similar proof will be valid.

Let γ = 1 / (1 - α). It seems likely that D2 will be small in comparison to γ in most applications, so we might suppose D2  <  γ  <  D1. The mixing time bound from Theorem [\ref=stopping] can then be written O(p- 1γ log D2 log (D1  /  ε)). We may compare this with the bound which can be derived using [\cite=HV04]. This can be written in similar form as O(p- 1γ log γ log (D1  /  ε)). In such cases we obtain a reduction in the estimate of mixing time by a factor log γ  /   log D2. In the applications below, for example, we have D2 = 2 and γ  =  Ω(Δ), so the improvement is Ω( log Δ).

The reason for our improvement on the result of [\cite=HV04] is that the use of an upper bound on the stopping time, as is done in [\cite=HV04], will usually underestimate the number of stopping times which occur in a long interval, and hence the mixing rate.

Hypergraph independent sets

We now use the approach of path coupling via stopping times to prove that the chain discussed in Section [\ref=sec:intuit] is rapidly mixing. The metric used in path coupling analyses throughout the paper will be Hamming distance between the coupled chains. We prove the following theorem.

Let λ,Δ be fixed, and let H be a hypergraph such that m  ≥  2λΔ + 1. Then the Markov chain M(H) has mixing time O(n log n).

Before commencing the proof itself, we analyse the stopping time T for this problem.

Edge Process

Let Xt and Yt be copies of M which we wish to couple, with [formula]. Let e be any edge containing w, with m = |e|. We consider only the times at which some vertex in e is chosen. The progress of the coupling on e can then be modelled by the following "game". We will call the number of unoccupied vertices in e (excluding w) units. At a typical step of the game we have k units, and we either win the game, win a unit, keep the same state or lose a unit. These events happen with the following probabilities: we win the game with probability 1 / m, win a unit with probability at least (m - k - 1) / (1 + λ)m, lose a unit with probability at most λk / (1 + λ)m and stay in the same state otherwise. If ever k = 0, we are bankrupt and we lose the game. Winning the game models the "good event" that the vertex v is chosen and the two chains couple. Losing the game models the "bad event" that the coupling increases the distance to 2. We wish to know the probability that the game ends in bankruptcy. We are most interested in the case where k = 1 initially, which models e being critical. Note that the value of k in the process on hypergraph independent sets dominates the value in our model, since we can always delete (win in the game), but we may not be able to insert (lose in the game) because the chosen vertex is critical in some other edge.

Let pk denote the probability that a game is lost, given that we start with k units. We have the following system of simultaneous equations.

[formula]

Adding the equations in ([\ref=p-eq1]) from the [formula] onwards gives

[formula]

Now ([\ref=p-eq2]) is equivalent to ([\ref=p-eq1]), since we have simply multiplied the coefficient matrix of ([\ref=p-eq1]) by an upper triangular matrix with all entries 1. This transformation is clearly nonsingular. We will show by induction that ([\ref=p-eq2]) has solution

[formula]

When k = 1, the first equation in ([\ref=p-eq2]) is clearly satisfied by ([\ref=p-eq3]). Assume by induction that ([\ref=p-eq3]) is true for pk - 1, with k  ≥  2. Then

[formula]

continuing the induction. For consistency, we must clearly have

[formula]

Using ([\ref=p-eq4]), ([\ref=p-eq3]) can be rewritten

[formula]

In particular

[formula]

The expected distance between XT and YT

The stopping time for the pair of chains Xt and Yt will be when the distance between them changes, in other words either a good or bad event occurs. The probability that we observe the bad event on a particular edge e with w∈e is at most pk as calculated above. Let ξt denote the number of empty vertices in e at time t when the process is started with ξ0 = k. Now ξt can never reach 0 without first reaching k - 1 and, since the process is Markovian, it follows that

[formula]

Since w is in at most Δ edges, the probability that we observe the bad event on any edge is at most Δp1. The probability that the stopping time ends with the good event is therefore at least 1 - Δp1. The path coupling calculation is then

[formula]

This is required to be less than 1 in ordered to apply Theorem [\ref=stopping]. If m  ≥  2λΔ + 1, then by ([\ref=p-eq6])

[formula]

The above work puts us in a position to apply Theorem [\ref=stopping]. Let m  ≥  2λΔ + 1. Then for M(H) we have

[formula] for all t, and

[formula]

Also for M(H) we have D1 = n and D2 = 2. Hence by Theorem [\ref=stopping], M(H) mixes in time

[formula]

This is O(n log n) for fixed λ,Δ.

In the most important case, λ = 1, we require m  ≥  2Δ + 1. This does not include the case m = 3, Δ = 3 considered in [\cite=DG00a]. We have attempted to improve the bound by employing the chain proposed by Dyer and Greenhill in [\cite=DG00a]. However, this gives only a marginal improvement. For large λΔ, we obtain convergence for [formula]. For λ = 1, this gives a better bound on mixing time for m = 2Δ + 1, with dependence on Δ similar to Remark [\ref=rem05] below, but does not even achieve mixing for m = 2Δ. We omit the details in order to deal with the Glauber dynamics, and to simplify the analysis.

The terms in the running time which are exponential in λ,Δ would disappear if we instead took graphs for which m  ≥  2λΔ + 2. In this case the running time would be

[formula]

Furthermore, if we took graphs such that m > (2 + δ)λΔ, for some δ > 0, then the running time would no longer depend on λ,Δ at all, but would be τ(ε)  ≤  cδn ln (nε- 1) for some constant cδ.

It seems that path coupling cannot show anything better than m linear in λΔ. Suppose the initial configuration has edges [formula] for [formula], with [formula], [formula] and w the change vertex. Consider the first step where any vertex changes state. Let μ = (1 + λ)(m - 1 + Δ). The good event occurs with probability (1 + λ) / μ, insertion of a critical vertex with probability λΔ  /  μ, and deletion of a non-critical vertex with probability (m - 1) / μ. We therefore need (m - 1) + (1 + λ)  ≥  λΔ, i.e. m  ≥  λ(Δ - 1), to show convergence by path coupling.

It seems we could improve our bound m  ≥  2λΔ + 1 for rapid mixing of the Glauber dynamics somewhat if we could analyse the process on all edges simultaneously. Examination of the extreme cases, where all edges adjacent to w are otherwise independent, or where they are dependent except for one vertex (as in Remark [\ref=rem10]), suggests that improvement to (1 + o(1))λΔ may be possible, where the o(1) is relative to λΔ. However, the analysis in the general case seems difficult, since edges can intersect arbitrarily.

Hardness results for independent sets

We have established that the number of independent sets of a hypergraph can be approximated efficiently using the Markov Chain Monte Carlo technique for hypergraphs with edge size linear in Δ. We show next that exact counting is unlikely to be possible, and that our approximation scheme cannot be extended to cover all hypergraphs with edge size Ω( log Δ).

#P-completeness

We show that the exact counting problem is #P-Complete except in trivial cases.

Let G(m,Δ) be the class of uniform hypergraphs with minimum edge size m  ≥  3 and maximum degree Δ. Computing the number of independent sets of hypergraphs in G(m,Δ) is #P-complete if Δ  ≥  2. If Δ  ≤  1, it is in P.

Since m is the minimum edge size, we will assume m  ≥  3. The cases Δ = 0,1 are trivially in P. As discussed in Section [\ref=sec:intuit], independent sets in a hypergraph with Δ = 2 correspond to edge covers in a graph. Counting these is #P-complete, even for graphs with arbitrarily large minimum degree. This is stated in [\cite=BD97] but without proof, so we provide a proof in Appendix [\ref=app1]. We now consider Δ  ≥  3. (The case m = Δ = 3 is discussed in [\cite=DG00a].) Take a graph G = (V,E), and construct a hypergraph G = (V,E) by "extending" each edge [formula] to an edge [formula]. Observe that, for each independent set I of G and edge e∈E, there are 2m - 2 - 1 independent assignments to [formula] if v1,v2∈I and 2m - 2 otherwise. This is equivalent to evaluating the partition function of a weighted H-colouring problem [\cite=BG04] [\cite=DG00b] on G, with weight matrix

[formula]

The #P-completeness of H-colouring with this weight matrix follows either directly from [\cite=BG04] or indirectly from [\cite=DG00b]. The degree bound Δ = 3 follows from [\cite=DG00b], on noting that A is nonsingular.

Approximation hardness

We now show that unless NP=RP, there can be no fpras for the number of independent sets of all hypergraphs with edge size Ω( log Δ).

Let G = (V,E), with |V| = n, be a graph with maximum degree Δ and Ni independent sets of size i ([formula]). For λ > 0 let [formula] define the hard core partition function. The following is a combination of results in Luby and Vigoda [\cite=LV99] and Berman and Karpinski [\cite=BK03].

If λ  >  694 / Δ, there is no fpras for ZG(λ) unless NP=RP.

Let ε be a constant such that the size of the largest independent set in a graph of maximum degree 4 cannot be approximated to within a ratio (1 + ε) unless P = NP. Berman and Karpinski [\cite=BK03] show that ε  ≥  1 / 49. Luby and Vigoda [\cite=LV99] prove the hardness of approximating ZG(λ) if λ  >  c / Δ for any c  >  20 ln 2  (1 + ε) / ε. Together, these two results give the theorem.

We note that Theorem [\ref=h-thm20] could probably be strengthened using the approach of [\cite=DFJ99]. However, this has yet to be done.

Unless NP=RP, there is no fpras for counting independent sets in hypergraphs with maximum degree Δ and minimum edge size m < 2lg(1 + Δ / 694) - 1 = Ω( log Δ).

Given a graph G = (V,E) with maximum degree Δ, we construct a hypergraph H = (V,E) as follows. Let k = ⌈m / 2⌉. For each v∈V, let [formula] and [formula]. For each edge [formula], let [formula], and let [formula]. It is clear that H has maximum vertex degree Δ and every edge has size 2k  ≥  m.

An independent set I in H corresponds to a unique independent set I in G as follows. If Sv  ⊆  I, then v∈I, otherwise v∉I. Clearly I independent in H implies I independent in G. Note that for each v∉I, there are (2k - 1) possible subsets of Sv which may be in I. Thus, if N is the number of independent sets in H, Thus approximating N is equivalent to approximating ZG(λ) with λ = 1 / (2k - 1). But, by Theorem [\ref=h-thm20], this will be hard if 1 / (2k - 1) > 694 / Δ. This gives k < lg(1 + Δ / 694), which holds whenever m < 2lg(1 + Δ / 694) - 1.

Hypergraph colouring

We now consider Glauber dynamics on the set of proper colourings of a hypergraph. Again our hypergraph H will have maximum degree Δ, minimum edge size m, and we will have a set of q colours. A colouring of the vertices of H is proper if no edge is monochromatic. Let Ω'(H) be the set of all proper q-colourings of H. We define the Markov chain C(H) with state space Ω'(H) by the following transition process. If the state of C at time t is Xt, the state at t + 1 is determined by

selecting a vertex v∈V and a colour [formula] uniformly at random,

let X't be the colouring obtained by recolouring v colour k

if X't is a proper colouring let Xt + 1 = X't otherwise let Xt + 1 = Xt.

This chain is easily shown to be ergodic with the uniform stationary distribution. Again we will use Theorem [\ref=stopping] to prove rapid mixing of this chain under certain conditions, however first we will examine the chain using standard path coupling techniques.

For m  ≥  4, q > Δ, the Markov chain C(H) mixes in time O(n log n).

Suppose that two copies of C(H), X0 and Y0 say, start at distance one apart, i.e. they differ in only one vertex w. Suppose that the number of colours available for recolouring w is q - k, then the probability of the two copies of the chain coupling in one step is [formula]. The distance between the two chains can only increase (to 2) if we select a vertex v and recolour it with a colour that is permitted in one copy of the chain only. For this to happen, there must be an edge containing v and w such that the other vertices in this edge are all either red and we have chosen red for v, or blue and we have chosen blue for v. Hence there can be at most one vertex on each edge, and one colour for that vertex, such that the chains diverge if we select that vertex and colour. Furthermore, for each of the k unavailable colours there must be an edge containing w which, apart from w itself, is monochromatic in the forbidden colour, so on these edges there are no vertices whose selection can cause the chains to diverge. Hence the probability that the distance increases to 2 in one step is at most [formula]. The path coupling calculation is therefore

[formula]

If q  ≥  Δ + 1 then [formula], and therefore by the path coupling theorem the mixing time is

[formula]

This analysis leaves little room for improvement in the case m  ≥  4, indeed it is not clear whether the Markov chain described is even ergodic for q  ≤  Δ. The following simple construction does show that the chain is not in general ergodic if [formula]. Let [formula], and take a hypergraph H on q(m - 1) vertices. We will group the vertices into q groups [formula], each of size m - 1. Then the edge set of H is [formula]. The degree of each vertex is (q - 1) + (q - 1)(m - 1) = Δ. If we now colour each group Vj a different colour, we obtain q! distinct colourings, but for each of these the Markov chain is frozen (no transition is valid).

The case m = 2 is graph colouring and has been extensively studied. See, for example, [\cite=DFHV04]. This leaves the case m = 3, hypergraphs with 3 vertices in each edge. The standard path coupling argument, as in Theorem [\ref=colsmge4], only shows rapid mixing for q  ≥  2Δ, since there may be two vertices in each edge that can be selected and lead to a divergence of the two chains. This occurs if, of the two vertices in an edge which are not w, one is coloured red and the other blue. However, we can do better using Theorem [\ref=stopping]. We will need the following technical Lemma.

Let φ(d) = 1 - d(1 - e- (q - Δ + d)t / Mq) / (q - Δ + d). For all t  ≥  0 and all d  ≥  1, φ(d)  ≥  φ(1)d.

Let κ = q - Δ  >  0, x = t / Mq  ≥  0. We wish to show that

[formula]

Since ψ(0) = 0, it suffices to show that ψ(x) is increasing for all x  ≥  0. But

[formula]

so it suffices to show 1 - (1 - e- (κ + 1)x) / (κ + 1)  ≥  e- x. Let ζ(x) = 1 - e- x - (1 - e- (κ + 1)x) / (κ + 1). Then ζ(0) = 0, so we need only show that ζ(x) is increasing for all x∈(0,  ∞  ). But for x  ≥  0.

There exists Δ0 such that, if H is a 3-uniform hypergraph with maximum degree Δ  >  Δ0 and q  ≥  1.65Δ, the Markov chain C(H) mixes rapidly.

We choose Δ0 large enough that all the approximations below are valid. We couple two copies of this chain using the identity coupling. Let X and Y be two copies of C(H) such that X0 and Y0 differ only at a single vertex w. As before, we will examine the stopping time T at which [formula] for the first time, and show that [formula]. We assume that w is coloured blue in X0 and red in Y0. We will call any other colour neutral. Let Γ(w) denote the set of vertices of H that share an edge with w. We will only consider transitions in which either w or a vertex in Γ(w) is selected, since any transition which involves any other vertex will not change the distance between X and Y. Let M = |Γ(w)| + 1. We will first assume that none of the edges containing w is otherwise monochromatic, and hence that all colours are available for recolouring w. We will deal with other cases later. Let St denote the event that T = t and [formula], which we will call success. The bad event we will call failure.

The probability that the two chains couple in any one step is [formula]. For each v∈Γ(w), let βv,t be an indicator variable which takes value 1 if v is either red or blue after t steps of the chain, and takes value 0 otherwise. We describe a choice of vertex v∈Γ(w) and colour c∈{} at step t as 'bad' if there is an edge containing v and w whose other vertex is currently coloured c, and let Bt denote the number of bad choices at time t. The probability of failure in step t is therefore [formula]. For each v∈Γ(w) let dv be the number of edges which contain both v and w. Then [formula]. Now, using ≈   to imply equality up to a factor 1 + oΔ(1),

[formula]

We will now study the properties of βv,t, with a view to analysing [formula]. Note that the probability has not coupled or diverged by time 40Δ is at most

[formula]

so we consider times only up to 40Δ. Let tv  =   max {t:t < 40Δβv,t = 1}. If v starts out either red or blue, the probability that it is recoloured to a neutral colour in each step is at least (q - Δ - 2) / Mq. Also, the probability that it becomes red or blue before time 40Δ is at most 80Δ / Mq. Hence

[formula]

since the second term is O(1 / Δ) and small compared to the first, which is Ω(1) for t  ≤  40Δ. Now we can bound [formula] by the minimum of t and tv, an exponentially distributed random variable with parameter [formula]. We are in a position to bound [formula] as follows.

[formula]

Inserting this into Equation ([\ref=prs]), we get

[formula]

where φ(d) was defined in Lemma [\ref=dws]. Since Σv∈Γ(w)dv = 2Δ, Lemma [\ref=dws] implies that for all t  ≥  0,

[formula]

Hence, for t  ≤  40Δ,

[formula]

Finally, noting that [formula] by linearity of expectation, we have

[formula]

If we now substitute q = 1.65Δ and M  ≤  2Δ, we see that

[formula]

Since [formula], it follows that [formula] and we can apply Theorem [\ref=stopping]. This yields the claimed result.

We have assumed that all colours are available for recolouring w at every step. This will not be the case if there is any edge e adjacent to w for which [formula] is monochromatic. Let us call such an edge blocking, and suppose there are ρt blocking edges at time t. Note that the failure cannot occur on a blocking edge. The total number ρ' of blocking edges created during time 40Δ is at most ln Δ since

[formula]

for every constant γ > 0. Since ln Δ is negligible in comparison with q and M, these do not affect the probability estimates in the proof above. Thus we may assume that all blocking edges exist initially. We may further assume these persist until termination, so ρt  =  ρ0  =  ρ for all t. This can only decrease the probability of success. We now observe that this is no worse in our analysis than taking Δ' = Δ  -  ρ and q' = q - ρ. Let us formally define M' = Mq / q'. Then the conditional success probability is (q - ρ) / Mq = 1 / M', and the recolouring probability at each step is at least (q - Δ) / Mq = (q' - Δ') / M'q'. The analysis now proceeds as before. Since M' plays no part in the final condition, we finally require q'  ≥  1.65Δ', i.e. q  ≥  1.65Δ - 0.65ρ. This is clearly a weaker condition than q  ≥  1.65Δ.

If we let β = (q - Δ) / q then, as Δ0  →    ∞  , the analysis can be tightened slightly to work for β  >  β*, where β* is the root of the equation

[formula]

The integral can be expanded, by parts integration, as an infinite series to give an alternative equation

[formula]

This has root β* = 0.392729, giving q  >  1.64671.

A route to improving our bound on q would be to consider the changes in the numbers of colours available at each vertex of Γ(w) during the process. We make the pessimistic assumption that this is always q - Δ but, while this could be true initially, we would expect more colours to become available later on. A proper analysis of this effect seems more difficult, however, because Θ(Δ2) vertices are now involved, and the edges containing them may intersect.

Hardness results for colouring

#P-completeness

Again we show that exact counting is #P-complete except in the few cases where it is clearly in P. Let G(m,Δ) be as in Theorem [\ref=h-thm10].

Computing the number of q-colourings of hypergraphs in G(m,Δ) is #P-complete if Δ,q  >  1. If Δ  ≤  1 or q  ≤  1 it is in P.

Again we assume m  ≥  3. The cases Δ  ≤  1, q  ≤  1 are trivially in P. The case Δ = 2 corresponds to counting edge q-colourings of graphs in which no vertex is monochromatic. We call an edge colouring with no monochromatic vertex a weak edge colouring. Counting weak edge colourings is #P-complete for graphs of arbitrarily large minimum degree. We give a proof in Appendix [\ref=app2].

For Δ  ≥  3, q  ≥  2, we use the construction from the proof of Theorem [\ref=h-thm10]. For each colouring [formula] of G and edge e∈E, there are qm - 2 - 1 permitted colourings of [formula] if X(v1) = X(v2) and qm - 2 otherwise. The corresponding H-colouring problem has the following q  ×  q weight matrix:

[formula]

The #P-completeness of H-colouring with this weight matrix, and the bound Δ = 3, follow as in Theorem [\ref=h-thm10], since A is again nonsingular.

Hardness of Approximation

Again let G(m,Δ) be as defined in Theorem [\ref=h-thm10]. Our result, Corollary [\ref=h-cor10], follows directly from the following NP-completeness proof.

Determining whether a hypergraph in G(m,Δ) has any q-colouring is NP-complete for any m  >  1 and 2  <  q  ≤  (1 - 1 / m)Δ1 / (m - 1).

If m = 2, this is graph colouring, and the result follows from [\cite=EHK98]. (See also [\cite=MR01].) For m  ≥  3, we use the following reduction from graph colouring. Let G = (V,E) be a graph with degree ΔG, and 2  <  q  ≤  3ΔG / 4. Without loss, we may assume ΔG  =  ⌈4q / 3⌉. Colouring G with q colours is NP-complete [\cite=EHK98]. For each edge [formula], let [formula] [formula] and [formula]. Let Ee0 comprise all subsets of Ve0 of size m other than Sei [formula]. We claim that any proper q-colouring of the hypergraph He0 = (Ve0,Ee0) must assign the same colour to all ueij∈Sei [formula], and a different colour for each [formula]. The claim holds since there must be some colour class of size at least m, since there are q colours and mq vertices. If there was a colour class of size greater than m, at least one of its subsets of size m would be a monochromatic edge. Thus there must be exactly q colour classes, each of size m. If these are not the Sei [formula], again there is a monochromatic subset of size m which is an edge. Clearly, by symmetry, any assignment of the q colours to the q classes Sei is permissible.

Let [formula], and add the edges [formula] [formula] and [formula] [formula] to Ee0 to give Ee. We claim that, in any proper q-colouring of the hypergraph He = (Ve,Ee), v1 and v2 must receive different colours. The claim holds since v1 can have any colour different from all Sei [formula], and v2 any colour different from all Sei [formula]. But these permitted colour sets for v1 and v2 are disjoint. Also, given any colours for v1 and v2, there are ⌊q / 2⌋⌈q / 2⌉(q - 2)! > 0 colourings of He. Thus we may use He to simulate the edge e∈E. Thus we set [formula], [formula] and consider the hypergraph H = (V,E). Then H is q-colourable if and only if G is q-colourable.

The maximum degree in H of any uij is [formula]. The degree in H of each v∈V is at most ΔG⌈q / 2⌉  ≤  (4q + 2)(q + 1) / 6  <  2q2. Thus [formula], and hence q  ≤  (1 - 1 / m)Δ1 / (m - 1).

Unless NP=RP, there is no fpras for counting q-colourings of a hypergraphs with maximum degree Δ and minimum edge size m if 2  <  q  ≤  (1 - 1 / m)Δ1 / (m - 1).

We cannot tell if there is any colouring for q in this range, so there can be no fpras.

It is clearly a weakness that our lower bound for approximate counting is based entirely on an NP-completeness result. However, we note that the same situation pertains for graph colouring, which has been the subject of more intensive study.

Conclusions

We have presented an approach to the analysis of path coupling with stopping times which improves on the method of [\cite=HV04] in most applications. Our method may itself permit further development.

We apply the method to independent sets and q-colourings in hypergraphs with maximum degree Δ and minimum edge size m. In the case of independent sets, there seems scope for improving the bound m  ≥  2Δ + 1, but anything better than m  ≥  Δ + o(Δ) would seem to require new methods. For colourings, there is probably little improvement possible in our result q  >  Δ for m  ≥  4, but many questions remain for m  ≤  Δ. For example, even the ergodicity of the Glauber (or any other) dynamics is not clearly established. For the most interesting case, m = 3, the bound q > 1.65Δ (for large Δ) can almost certainly be reduced, but substantial improvement may prove difficult.

Our #P-completeness results seem best possible for both of the problems we consider. On the other hand, our lower bounds for hardness of approximate counting seem very weak in both cases, and are far from our upper bounds. These lower bounds can probably be improved, but we have no plausible conjecture as to what may be the truth.

Acknowledgments

We are grateful to Tom Hayes for commenting on an earlier draft of this paper, and to Mary Cryan for useful discussions at an early stage of this work.

Appendices

Edge cover is #P-complete

We prove this by reduction from counting independent sets, using methods similar to Bubley and Dyer [\cite=BD97], where this result was claimed without proof. Let G be a class of 3-regular graphs for which counting independent sets is #P-complete [\cite=G00]. Let G = (V,E), with Ij(G) independent sets of size j ([formula]). Form G' by subdividing each edge e∈E with a new vertex ue. Let [formula]. Let Ni(G') be the number of edge sets in G' which leave exactly i vertices in V uncovered, but no vertex in U. In particular, N0(G') is the number of edge covers of G', and we assume an oracle computing this quantity. Observe that the uncovered vertices in G' must form an independent set in G. Then it follows, similarly to [\cite=BD97], that

[formula]

Thus, if we can determine the Ni(G'), we can determine the number of independent sets of all sizes in G. Let Nij(G') be the number of edge sets of G' in which i vertices in V and j in U are uncovered ([formula]). Then Ni(G') = Ni0(G'). We attach a copy Kvm of Km to each vertex v∈V and a copy Kuk of Kk to each vertex u∈U. Call the resulting graph Gmk. Let Mm be the number of edge covers of Km, then Mm - 1 is the number of edge sets in Km which leave a fixed vertex uncovered. We can show by inclusion-exclusion that (See [\cite=S04].) It is easy to show that that Mm / Mm - 1 is a rapidly increasing sequence (in fact Mm / Mm - 1  ≈  2m - 1 for large m), and hence has a different value for every value of m. We have

[formula]

By choosing any (n + 1) values of m and any (3n / 2 + 1) values of k, we can determine all the Nij(G') by interpolation, and hence all the Ni(G'). From these, we can determine all the Ij(G), and hence [formula], the total number of independent sets in G.

Note that the minimum degree of G'mk, min {m,k} - 1, can be made as large as we wish.

Weak edge colouring is #P-complete

We use the same notation and construction as in Appendix [\ref=app1]. Now G is a class of 3-regular graphs for which vertex q-colouring is #P-complete [\cite=G00]. Let Ni(G') denote the number of edge colourings of G' with i monochromatic vertices, so N0(G') is the number of weak edge colourings of G', and we assume an oracle for this. Let Nij(G') be the number edge colourings of G' in which i vertices in V and j in U are monochromatic ([formula]). Now observe that Nn0(G') is equal to the number of proper vertex q-colourings of G, Qq(G) say. In every colouring counted in Nn0(G'), every vertex is monochromatic and adjacent vertices receive different colours. Again we attach a copy Kvm of Km to each vertex v∈V, and a copy Kuk of Kk to each vertex u∈U, to give Gmk. Let Mm be the number of weak colourings of Km, and M'm the number of edge colourings of Km with a given monochromatic vertex. Now we have Again the sequence Mm / M'm increases rapidly (Mm / M'm  ≈  qm - 2 for large m), and takes a different value for every m when q  ≥  2. Now, as in ([\ref=app1-eq0]), Hence, choosing (n + 1) values of m and (3n / 2 + 1) values of k, we can determine all the Nij(G') by interpolation. In particular, we can determine Nn0(G') = Qq(G).

Again the minimum degree of G'mk, min {m,k} - 1, can be made arbitrarily large.