Lemma Proposition Corollary Definition Remark Example Exercise Assumption

Asymptotic preserving schemes for the Klein-Gordon equation in the non-relativistic limit regime

Introduction

The Klein-Gordon equation is a fundamental physical equation describing the motion of a spin-less particle, see for instance [\cite=BjoD65], [\cite=Sak67] and [\cite=Bog59] for a physical introduction on this topic and [\cite=GinVe85], [\cite=BreWa81] and the references therein for the mathematical analysis, and in particular [\cite=Bou96] [\cite=Bam03] for some long time results when the equation is set on a compact domain, the case mainly considered in the present work.

In the relativistic regime, i.e. the speed of light c = 1, the Klein-Gordon equation (as a non-linear wave equation) is numerically well studied, see for instance [\cite=StVaz78], [\cite=JimVaz78], [\cite=PasJimVaz95], and, for long time behavior results in the weakly nonlinear regime, [\cite=CoHaLu08], [\cite=FG11] and [\cite=FGP1] [\cite=FGP2]. Here we are interested in the Klein-Gordon equation in the non-relativistic limit regime, i.e. the speed of light c tending to infinity. Thus, our model problem reads

[formula]

where we will consider essentially the case f(z)  =  λ|z|2pz, [formula], assume that the initial condition φ and γ do not depend on c, and consider periodic boundary conditions in the space variable. In this regime the Klein-Gordon equation has recently gained a lot of attention, see for instance [\cite=MaNakOz02], [\cite=MaNak02] and [\cite=Tsu84] (when Equation [\eqref=eq:kgr] is set on the whole space [formula]). Numerically, the highly oscillatory nature of the exact solution is very challenging as standard numerical schemes require severe time step restrictions depending on the large parameter c2, see for instance [\cite=HLW], [\cite=EFHI09] and [\cite=PetzJ97] for a numerical overview on highly oscillatory problems. In the recent work [\cite=BaoD12], Gautschi-type exponential integrators (proposed in [\cite=HoLu99] for equations with high frequencies generated by the linear part) were applied to the non-relativistic Klein-Gordon equation, which allow time steps of order O(c- 2).

Following the one-term asymptotics results given in [\cite=MaNak02] we study in this paper the existence of a complete asymptotic expansion of the exact solution of [\eqref=eq:kgr] in terms of c- 2 over a c -independent interval (0,T), and for smooth initial data. This will allow us to construct numerical schemes which do not need to obey any c-dependent smallness restriction. In a nutshell, the asymptotic expansion up to the first-order correction term of [\eqref=eq:kgr] reads

[formula]

where u0 and v0 solve the coupled nonlinear Schrödinger equations

[formula]

The essential point is that the highly-oscillating part in the asymptotic expansion [\eqref=eq:asympz] is only contained in the phases [formula] and [formula], but does not appear in the above Schrödinger equations for u0 and v0. In particular the numerical time integration of [\eqref=eq:nsl0] can be carried out without any c-dependent time step restriction. Thus, with this asymptotic expansion we are able to obtain a well suited numerical approximation to the exact solution z(t) of the Klein-Gordon equation in the non-relativistic limit c  ≫  1, without any time step restriction as we only need to solve the Schrödinger equations [\eqref=eq:nsl0] and multiply the numerical approximations of u0 and v0 with the highly-oscillatory phases [formula] and [formula], respectively.

Note that in comparison with [\cite=MaNak02] and motivated by numerical implementation, we choose to work here with periodic boundary conditions, that is the space variable [formula] the d-dimensional torus. Moreover, we show that for sufficiently smooth initial values the asymptotic expansion of the exact solution to [\eqref=eq:kgr] exists up to an arbitrary order, and can be reconstructed by superposing highly oscillatory terms to cascaded solutions of c-independent Schrödinger-like systems. After a full discretization of these cascaded terms, we are able to build numerical schemes which approach the exact solution up to errors terms of order O(τk + c- 2N - 2  +  hs) by simulating the terms in the asymptotic expansion up to order N with a numerical scheme of order k in time (with step size τ) and Fourier pseudo-spectral discretization on a grid with mesh size h. Note that here, h and τ can be chosen independently of c, and that s  =  s(N) depends on the regularity of the solution and of the degree of the asymptotic expansion. The paper is organized as follows. We commence in Section [\ref=sec:boundi] with the essential a priori bounds on the exact solution of the Klein-Gordon equation [\eqref=eq:kgr] showing the existence on a time interval independent of the large parameter c. In Section [\ref=sec:asymp] we will derive an asymptotic expansion of the exact solution in powers of c- 2. In Section [\ref=sec:firstt] we will precisely state the first terms in this expansion, which will allow us to construct numerical schemes which are robust with respect to c, see Section [\ref=sec:nume]. Furthermore, in Section [\ref=sec:enq] we analysis the asymptotic behavior of the conserved physical quantities.

A priori bounds on the exact solution

We consider our model problem [\eqref=eq:kgr] set on the d-dimensional torus [formula]. We make the following assumptions:

For ease of presentation and numerical motivations, we will mainly work on the d-dimensional torus [formula], [formula]. However, as the only arguments used in the sequel are the local Lipschitz nature of the nonlinearity in Sobolev space and some explicit calculations for diagonal operators in Fourier, the reader should be convinced that all the result of this paper can be easily extended to functions defined on [formula].

For a function u(x), [formula] in [formula] we set

[formula]

where

[formula]

[formula], denote the Fourier coefficients associated with u. Here, we have set

[formula]

for [formula] and [formula]. For a given c  >  0, we define the operator

[formula]

In Fourier, the operator [formula] is represented by the diagonal operator with coefficients

[formula]

where [formula] denotes the Kronecker operator. In particular note that the operator [formula] is uniformly bounded with respect to c: we have for all [formula], [formula], which implies that for all functions u, [formula]. With these notations, Equation [\eqref=eq:kgr] can be written as

[formula]

In order to rewrite the above equation as a first-order system in time, we set

[formula]

Note that we have

[formula]

and if z is real, then u  =  v. A short calculation shows that in terms of the variables u and v equation [\eqref=eq:kgrr] reads

[formula]

The initial boundary conditions associated with this problem are (see [\eqref=eq:kgr])

[formula]

Eventually, we set

[formula]

so that the problem [\eqref=eq:NLSc]-[\eqref=eq:BCc] can be written as

[formula]

We see that this equation is posed on Hs  ×  Hs. For an element [formula], we set

[formula]

In the previous and in the following, if an operator - like [formula] - acts on Hs, we naturally extend diagonally its action on Hs  ×  Hs by setting for instance for [formula],

[formula]

The solution of the linear equation (F  =  0 in the previous equation) can be written as follows: For [formula],

[formula]

where the right hand-side is easily defined in Fourier by the formula

[formula]

where k denote the (vector valued) Fourier coefficients of [formula]. Note that the linear flow is an isometry in the sense that for [formula],

[formula]

Note that in the sequel, and because the equation is set on the torus, we will not use any argument involving Strichartz estimates as in [\cite=MaNak02] but we will require more regularity on the initial conditions γ and φ.

As we assume that the function f is polynomial of degree r  >  2 in z and [formula] the application [formula] satisfies estimates of the form

[formula]

for s  >  d / 2, with some constants C, and for [formula] and [formula] in Hs  ×  Hs. These estimates are consequences of classical bilinear estimates in Hs:

[formula]

for some constants Cs. Moreover the assumption that f is real implies that for all w∈Hs  ×  Hs, [formula].

With these notations, the mild formulation of [\eqref=eq:NLF] is given by

[formula]

Using the fact that the linear flow [formula] is an isometry in Hs and that [formula] is a bounded operator in Hs, in particularly uniformly bounded with respect to c, we easily derive the following result by a standard fix point argument combined with [\eqref=eq:lips]:

Let s  >  d / 2 and M  >  0 a given constant. Then there exist constants Ts > 0 and Bs > 0 such that for all c  >  0 and for all [formula] such that [formula], there exists a mild solution [formula] to the equation [\eqref=eq:NLF], and such that

[formula]

In terms of u and v, the previous proposition can be reformulated as

Let s  >  d / 2, and assume that φ∈Hs and γ∈Hs are given. Then there exist constants Ts > 0 and Bs > 0 such that for all c there exists a mild solution (u(t),v(t))∈C1((0,Ts),Hs  ×  Hs) to the equation [\eqref=eq:NLSc] satisfying the initial boundary conditions [\eqref=eq:BCc] and such that

[formula]

Using the expression [\eqref=eq:rlb] for [formula] in terms of φ and γ, and the fact that [formula] is uniformly bounded in with respect to c, we obtain that [formula], a constant independent of c. This shows that Proposition [\ref=prop21] applies.

This corollary immediately gives the existence of the exact solution z(t) of [\eqref=eq:kgr] on a time interval (0,Ts) and with Hs-bounds both independent of c.

Asymptotic expansion

On the c-independent time interval (0,Ts) given by the previous results, we search w (at least formally) under the form

[formula]

where we separate the high oscillations from the slow time dependency of the solution. Here, [formula] is a function defined on [formula] and taking values in [formula]. The equation for [formula] is the transport equation (see [\eqref=eq:NLF])

[formula]

with boundary condition

[formula]

In a first step, we expand the previous equations with respect to the small parameter c- 2 in the following sense: For a given k, we can write

[formula]

for some coefficients αn defining a power series of convergent radius 1. However, as k is an arbitrary integer, the meaning of the previous expansion in terms of operators has to be understood in the sense of asymptotic expansions; this means that for a given sufficiently smooth function [formula], we can write

[formula]

in the sense that for all [formula], there exists a constant CN such that if [formula] for some [formula], then for all c  >  0,

[formula]

This last equation can be rigorously proved by using Taylor expansions of the function [formula], x  >  0 and Fourier decomposition of [formula]. Similarly, we can write

[formula]

for some coefficients βn. Hence in view of [\eqref=eq:rlb] the initial condition [formula] can be expanded in the sense of asymptotic expansion as

[formula]

with

[formula]

Similarly, Equation [\eqref=eq:trans] can be expanded in the sense of asymptotic expansion for smooth [formula] as where

[formula]

For later use we will give the first term [formula]: For [formula],

[formula]

Note that for s  >  d / 2, can prove the following estimates:

[formula]

where r is the polynomial degree of f (see [\eqref=eq:bil1]), and for some constant Cn depending on n and s. We now look for an asymptotic expansion for [formula] as

[formula]

With this expression, we can expand the nonlinear term [formula] using the fact that f is polynomial. We obtain an expansion of the form

[formula]

where [formula] denotes a nonlinear term depending only on [formula] for j  ≤  n - 1. Also note that this term is polynomial in the functions [formula]. Here, [formula] is the differential of [formula] at [formula]. It is a polynomial term of oder r - 1, in [formula] if f is polynomial of degree r.

Hence we get a recurrence relation of the form

[formula]

and for n  ≥  2,

[formula]

where [formula] denotes a term depending only on [formula] for j  ≤  n - 2 that is polynomial in the functions [formula] and their derivatives. Using the previous estimates we obtain that for all n and all collections [formula], [formula] of sufficiently smooth functions,

[formula]

where the constant Cn does not depend on the [formula]'s (but depends on n and s). Eventually, the initial condition [\eqref=eq:psiinit] yields the conditions

[formula]

where [formula] is given by the expansion [\eqref=eq:psin].

To solve the previous induction relation [\eqref=eq:induc] and [\eqref=eq:psibn], we impose the initial condition [formula] for j  <  0. We also introduce the following space: we say that [formula] if [formula] is a trigonometric polynomial in θ with coefficients in C1((0,T),Hs  ×  Hs). In other words, we can write G as

[formula]

where p  <    +    ∞   and with [formula]. By construction, as the nonlinearity is assumed to be polynomial, it is clear that if for [formula], [formula], is an element of Hs  +  2(n - j)T, then we have (see [\eqref=eq:derivW]),

[formula]

We will use repeatedly the following result:

Let [formula] and s  >  0. Assume that [formula] is given. Then there exists a unique solution [formula] satisfying the equations

[formula]

and

[formula]

Moreover, for all function [formula], the function

[formula]

satisfies the equation [\eqref=eq:homo].

We decompose [formula] in Fourier in θ: we can express this function as

[formula]

with p  <    +    ∞   and where [formula]. Note that

[formula]

Let us seek [formula] under the form

[formula]

for some unknown functions [formula] in C1((0,T),Hs  ×  Hs). Equation [\eqref=eq:homo] can be written as

[formula]

where δ1a denotes the Kronecker symbol. It is clear that this equation is solvable for the functions [formula], a  ≠  1 and that with the condition [\eqref=eq:train] we can set [formula]. The last statement is a consequence of the fact that the kernel of the operator i∂θ  +  1 is the space spanned by eiθ.

We are now ready to state the main result of this section:

Let [formula], s  >  d / 2, c0  >  0 and assume that φ∈Hs  +  2N  +  4 and γ∈Hs  +  2N  +  4 are given. Then there exists T  =  T(s,N)  >  0, and a sequence of functions [formula], satisfying the following properties: [formula] where [formula] satisfies the equation

[formula]

where [formula] is defined in [\eqref=eq:psin] and where by definition,

[formula]

and for all n, [formula] solve the equations [\eqref=eq:induc]-[\eqref=eq:psibn] for [formula], and can be decomposed into trigonometric polynomials of the form

[formula]

with pn  <    +    ∞  , and where [formula]. Moreover, there exists a constant CN such that for c  >  c0, if [formula] denotes the solution given by Proposition [\ref=prop21] with initial value [formula] given by [\eqref=eq:rlb] in terms of φ and γ, then

[formula]

Let us consider the recursion [\eqref=eq:induc] together with the initial condition [\eqref=eq:psibn] where the [formula] are given by [\eqref=eq:psin]. For n  =  0, we obtain the equation

[formula]

which implies, according to the previous lemma, that

[formula]

that is we have determined [formula] for a  ≠  1 (and set p0  =  1).

For n  =  1, the equation [\eqref=eq:induc0] is written

[formula]

According to the result of given in the previous lemma (see [\eqref=eq:homo]), this equation will be solvable if the right-hand side satisfies

[formula]

In view of [\eqref=eq:W0], this equation can be written as

[formula]

which gives the equation [\eqref=eq:nlsw0] with the boundary condition [\eqref=eq:psibn]. Now let T be such that [formula] is a solution to the previous equation with initial value [formula] in the space C1((0,T),Hs  +  2N + 4  ×  Hs + 2N + 4). Then we can set [formula] and solve for the functions [formula], a  ≠  1 according to the previous lemma. Note that p1 is given by the degree of the polynomial in the nonlinear right-hand side.

Now assume that n  ≥  1 is given, and that [formula], a  ≤  pk are known functions in C1((0,T,Hs  +  2(N  -  k) + 4  ×  Hs  +  2(N - k) + 4) for k  ≤  n - 2 and pk  <    ∞  , and that [formula] is determined for a  ≠  1.

Consider Equation [\eqref=eq:induc]. Using [\eqref=eq:derivW] and the induction hypothesis, the right-hand side of this equation belongs to C1((0,T,Hs  +  2(N  -  n) + 2  ×  Hs  +  2(N - n) + 2), and is a polynomial in eiθ of degree pn  ≥  pn - 1, because the nonlinearity is a polynomial. To be solvable, the right-hand side of [\eqref=eq:induc] has to be orthogonal to e- iθ in [formula]. By induction hypothesis, only the term w(1)n - 1 has to determined. In view of [\eqref=eq:induc], we thus see that w(1)n - 1 has to satisfy a linear equation of the form

[formula]

where [formula] is a linear multiplicative operator with coefficients in the space C1((0,T),Hs  +  4N + 2), and where [formula]. The initial condition associated with this equation is written, according to [\eqref=eq:psibn], as

[formula]

where [formula] is given by [\eqref=eq:psin] in terms of φ and γ, and where the other terms in the right-hand side are known by induction hypothesis.

As the equation [\eqref=eq:eqlin] in linear with coefficients bounded on the time interval (0,T); we deduce that [formula] is well defined in C1((0,T,Hs  +  2(N  -  n) + 2  ×  Hs  +  2(N - n) + 2). Using the previous Lemma, we can then solve for the terms [formula] for a  ≠  1 in C1((0,T,Hs  +  2(N  -  n) + 2  ×  Hs  +  2(N - n) + 2).

To prove the asymptotic expansion, we note that by construction the term

[formula]

belong to C1((0,T,Hs + 2  ×  Hs + 2) and satisfies the equation [\eqref=eq:NLF] up to an error or order c- 2(N + 1), that is

[formula]

with

[formula]

satisfying the following uniform bounds: for a given c0 > 0, there exists a constant CN such that

[formula]

Using Proposition [\ref=prop21], we can assume that the exact solution [formula] is also uniformly bounded (with respect to c) on (0,T) in Hs. We conclude by using [\eqref=eq:approx21] and standard comparison arguments based on the Gronwall Lemma on (0,T) and in Hs with s  >  d / 2.

First terms

The previous result implies the existence of an asymptotic expansion of u(t,x) and v(t,x) solutions of [\eqref=eq:NLSc]-[\eqref=eq:BCc] up to any arbitrary order, provided the initial condition is smooth. Note that we will use the following notations: for all n  ≥  0, [formula] with, according to the decomposition [\eqref=eq:Wbn]

[formula]

This implies an asymptotic expansion of the solution u(t), v(t) and z(t) of the form

[formula]

and

[formula]

with the relation [formula]. Note that here, the equality signs must be understood in the sense of asymptotic expansion. Remark also that in the case where φ and γ are real, that is when the solution z(t) is real, then we have for all n, un  =  vn. Using the result of Theorem [\ref=thm:main], z0(t,x) is an approximation of the solution z(t,x) over the time interval (0,T) with an error order O(c- 2), while

[formula]

approximates the exact solution z(t,x) over the time interval (0,T) up to terms of order c- 4. The goal of this section is to express the two first terms z0 and z1. For simplicity we consider the one dimensional case and assume the initial values φ,γ to be sufficiently smooth so that Theorem [\ref=thm:main] can be applied. Note that a generalization to higher dimensions follows the line of argumentation. We will use these computations to derive our numerical schemes in Section [\ref=sec:nume]. For reasons of ease we will focus on the linear case f(z)  =  λz, see Section [\ref=ex:lin], and a cubic-nonlinearity f(z)  =  λ|z|2z, see Section [\ref=ex:cub]. Nevertheless we state the equations for [formula] and [formula] in the general case f(z)  =  λ|z|2pz, [formula].

The first term z0 approximating the exact solution of Klein-Gordon equation [\eqref=eq:kgr] up to terms of order c- 2 is easily derived from Theorem [\ref=thm:main] using [\eqref=eq:zuv] and [\eqref=eq:rlb]. More precisely, we have

[formula]

where u0,v0 solve the nonlinear Schrödinger system [\eqref=eq:nlsw0].

In order to explicit the term z1(t,x), we expand the non-linearity [formula] in a Taylor-series, up to terms of order c- 2. With the notation [formula] and keeping in mind that [formula], we obtain Furthermore, in the above notation we calculate that where in this formula f is evaluated in [formula].

Thus, we obtain by [\eqref=eq:induc] with n = 2 (using [\eqref=eq:F1] and the above calculations) that the homological equation in terms of [formula] is written

[formula]

and a similar equation for [formula] with [formula] replaced by [formula], k = 0,1,2, and vice versa.

Formula for the first terms in the linear case

In the linear case we have f(z)  =  λz. In this case we obtain the following limit equation for u0 and v0

[formula]

see [\eqref=eq:nlsw0]. For [formula] we obtain by [\eqref=eq:W1] Thus, plugging the Fourier expansion [\eqref=eq:devU] of [formula] in θ, we obtain with the orthogonality relation [\eqref=eq:u0lin] for u0 that Thus, u(a)1  =  0 for a  ≠    ±  1 and [formula], and we set ξ1: = u(1)1, so that we can write

[formula]

Note that similarly [formula] with η1: = v(1)1. In order to determine ξ1 and η1 we analyze [\eqref=eq:U2] in the linear case, i.e. p = 0, which reduces to To be solvable, the right-hand side of the equation needs to be orthogonal to [formula] which yields the following equation for ξ1(t,x): Using twice the Schrödinger equation [\eqref=eq:u0lin] for u0, the above equation can be rewritten as The same equation holds true for η1 with ξ1 and u0 replaced by η1 and v0, respectively. The initial values ξ1(0) and η1(0) have to be chosen such that [formula], see [\eqref=eq:psibn]. As [formula] and [formula] we thus obtain by [\eqref=eq:psin] the following initial value problems for ξ1 and η1

[formula]

We summarize our findings in the following corollary.

In the linear case, i.e. f(z)  =  λz, the first and second terms in the asymptotic expansion [\eqref=eq:devz] read and

[formula]

where u0, v0 and ξ1, η1 solve [\eqref=eq:u0lin] and [\eqref=eq:u1lin], respectively. Then the functions z0(t,x) and [formula] approximate the exact solution of [\eqref=eq:kgr] in Hs up to terms of order c- 2 and c- 4 for initial values in Hs + 4 and Hs + 6, respectively.

Note that both corrections terms [\eqref=eq:u0lin] and [\eqref=eq:u1lin] can be solved exactly in Fourier. Thus, in the linear case we can state the correction terms z0 and z1 in an exact way. See Section [\ref=sec:lin] for further details.

Formula for the first terms in the cubic case

We consider now the case of cubic nonlinearity, i.e. p  =  1 with the previous notations. Moreover, for simplicity we consider the case, where [formula], i.e. z(0) and [formula]. Thus, [formula] and the limit equation for u0 reduces to

[formula]

see [\eqref=eq:nlsw0]. Plugging the Fourier expansion [\eqref=eq:devU] of [formula] in θ into [\eqref=eq:W1], we obtain with the orthogonality relation [\eqref=eq:u0rel] for u0 that

[formula]

Hence, u(a)1  =  0 for a  ≠   - 3, - 1,1,3 and

[formula]

Setting ξ1: = u(1)1, we obtain

[formula]

In order to determine the function ξ1 we need to state the equation for [formula], which reduces in our cubic setting to see [\eqref=eq:U2]. To be solvable, the right-hand side of the equation needs to be orthogonal to [formula] which yields the following equation for ξ1(t,x)  =  u(1)1(t,x): The initial value ξ1(0) needs to be chosen such that [formula], see [\eqref=eq:psibn] as well as the definition [\eqref=eq:psin]. Thus, by [\eqref=eq:U1cub] we obtain that Using [\eqref=eq:u0rel] we rewrite the equation for u1 as

[formula]

Again we summarize our findings in the following corollary.

For a cubic non-linearity, i.e. f(z)  =  λ|z|2z, and for real initial values functions [formula] and [formula], the first and second terms in the expansion [\eqref=eq:devz] read and

[formula]

where u0 and ξ1 solve [\eqref=eq:u0rel] and [\eqref=eq:u1rel], respectively. Then the functions z0(t,x) and [formula] approximate the exact solution of [\eqref=eq:kgr] in Hs up to terms of order c- 2 and c- 4 for initial values in Hs + 4 and Hs + 6, respectively.

Energy and charge density conservation

Analyzing the conserved quantities of the Klein-Gordon equation [\eqref=eq:kgr], we follow Dirac's approach via the "hole" theory, i.e. antiparticles are related to negative energy eigenstates (u particle with positive charge, v antiparticle with negative charge). This allows us to overcome the problem of indefinite probability density (i.e. if we would consider z(t) as a probability amplitude, its probability density [formula] which is naturally defined by the continuity equation, would allow positive and negative values.) For further details on the quantization of the Klein-Gordon field we refer to [\cite=BjoD65].

In this interpretation (ρ(z) being the charge-density) the conserved physical quantities of the Klein-Gordon equation are the charge

[formula]

as well as the energy

[formula]

Hence for all times t where the solution exists and is smooth enough,

[formula]

and

[formula]

Using the result given by Theorem [\ref=thm:main], and under smoothness assumptions on φ and γ, we can easily prove that the charge and energy admit asymptotic expansion with respect to c- 2. In this section, we give the expression of the first terms of these expansions. We commence with the asymptotic expansion of the charge Q(z), i.e.

[formula]

Using [\eqref=eq:uv] we can easily (as we are working on the torus [formula] and thus integration by parts yields no boundary-terms) rewrite the charge as

[formula]

Thus, using the asymptotic expansion given in Theorem [\ref=thm:main], we obtain

[formula]

where u0,v0 solve the nonlinear Schrödinger system [\eqref=eq:nlsw0] and hence in particular their L2 norms are conserved. Thus, the first term of the charge reads

[formula]

Using the relation [formula] as well as [formula], see [\eqref=eq:NLSc], we obtain

[formula]

Hence similarly to Q(z), we obtain an asymptotic expansion of the form

[formula]

with

[formula]

In order to analyze the asymptotic behavior of the energy E(z), we first have to subtract the relativistic rest-energy [formula] (see below) as from the energetic point of view the non-relativistic limit regime means that [formula] is small. According to [\eqref=eq:quqv], we can write

[formula]

where in the sense of asymptotic expansion (see [\eqref=eq:alphn]),

[formula]

and where Qv(v) denotes the part of Q(z) which contains the antiparticle component, i.e.

[formula]

With this notation, we define the rest energy [formula]. Using these notations, we obtain an asymptotic expansion of the form

[formula]

Using the asymptotic expansion given in Theorem [\ref=thm:main], we calculate that the first-order correction term of the energy E(z) in [\eqref=eq:asympE] is given by

[formula]

where u0,v0 solve the nonlinear Schrödinger system [\eqref=eq:nlsw0].

Construction of robust numerical schemes

The aim of this section is to show that we can use the derived asymptotic expansions to construct numerical schemes for the non-relativistic Klein-Gordon equation [\eqref=eq:kgr] which are robust with respect to the speed of light c. Firstly we underline our theoretical results in the linear case, where the exact solution to [\eqref=eq:kgr] is analytically known, see Section [\ref=sec:lin]. Finally, in Section [\ref=sec:cub] we construct robust numerical methods for the cubic non-relativistic Klein-Gordon equation and discuss their convergence. Numerical experiments are included.

Linear case

In the linear case, i.e. p  =  0, our model problem reads

[formula]

with the exact solution

[formula]

In the linear case we can solve the first- and second-order limit systems exactly in Fourier, see Corollary [\ref=cor:lin] and equation [\eqref=eq:u0lin] and [\eqref=eq:u1lin], respectively. Thus, we can state the first- and second correction terms z0 and z1 in an exact way. A simple computation shows that

[formula]

Thus, we nicely see that the difference between the exact solution z of the linear Klein-Gordon equation and its first-order correction term z0 in the non-relativistic limit c  ≫  1 are the formal approximations which are of order O(c- 2) for sufficiently smooth initial values φ and γ.

For the second correction term z1 we get after a short computation

[formula]

where

[formula]

Again this can easily be motivated by formally taking the next approximations in the exact solution z, i.e.

[formula]

and

[formula]

which are of order O(c- 4) for sufficiently smooth initial values φ and γ.

The numerical results for the initial values

[formula]

and λ  =   - 1 on the time interval

[formula]

Cubic non-linearity

In the cubic setting, i.e. p  =  1, our model problem reads

[formula]

and the limit Schrödinger system [\eqref=eq:nsl0] reduces to

[formula]

i.e. the first-order correction term z0 is given by

[formula]

where (u0,v0) solves the system of nonlinear Schrödinger equations [\eqref=eq:nsl0c]. Here the enhancement of our Ansatz is clearly seen: the limit Schrödinger system can easily be simulated without any c-dependent time step restriction, and a well suited approximation to the exact solution in the non-relativistic limit regime is then obtained by simply multiplying the numerical approximations of u0 and v0 with the highly-oscillatory phases [formula] and [formula], respectively.

For the numerical time integration of the first-order limit system, i.e. the Schrödinger system [\eqref=eq:nsl0c], we apply an exponential Strang splitting method, where we split the limit system in a natural way into the kinetic

[formula]

and potential part

[formula]

The exact flow Φt(u0(0),v0(0)) = ΦtT + P(u0(0),v0(0)) of the coupled system [\eqref=eq:nsl0c] at time tn  =  nτ is then approximated by

[formula]

where ΦtT(u0(0),v0(0)) and ΦtP(u0(0),v0(0)) are the exact flows associated to the kinetic Hamiltonian [\eqref=eq:NSLT] and potential Hamiltonian [\eqref=eq:NSLP], respectively.

Note that the kinetic equation [\eqref=eq:NSLT] can be solved exactly in Fourier space. Furthermore note that in the potential equation [\eqref=eq:NSLP] the moduli of u0 and v0 are conserved quantities, i.e. |u0(t)|2  =  |u0(0)|2 an |v0(t)|2  =  |v0(0)|2 for all t and thus we can solve both split equations in an exact way.

For the space discretization, we use pseudo-spectral Fourier with mesh-size h and grid points xj  =  2jhπ, [formula] where [formula] is the number of frequencies. Note the fully discrete scheme can be easily implement using the Fast Fourier transform algorithm. We refer to [\cite=Lubich08] [\cite=Faou12] for convergence results over finite time of such splitting schemes.

In the first example we are interested in the asymptotic expansion up to the first-order correction term z0. The asymptotic expansion derived in the previous section allows us the following convergence result for the natural choice of numerical approximation to z0.

Let s  >  d / 2 and assume that φ and γ are smooth functions defined on the one-dimensional torus [formula]. Then there exist constants T,c0,C,h0 and τ0 such that the following hold: for c  >  c0, τ  <  τ0 and h  <  h0, if we define by

[formula]

the numerical approximation of the first-order approximation term z0(t) at time tn  =  nτ, where un,h0 and vn,h0 denote the numerical approximations to the first-order limit system [\eqref=eq:nsl0c] obtained by the Strang splitting [\eqref=eq:Lie] at time tn  =  nτ with a discrete grid of mesh-size h; then if z(t) denotes the exact solution of the equation [\eqref=eq:kgrc], we have

We have

[formula]

By Theorem [\ref=thm:main] we have over the time interval (0,T) and c  >  c0,

[formula]

To bound the second term we use the following inequality Using arguments similar to [\cite=Faou12] (see also [\cite=Lubich08]), it is then possible to prove that

[formula]

if the exact solution is smooth enough (i.e. belongs to some Sobolev space Hs' with s'  >  s sufficiently large). Note that the proof of the fully discrete scheme in [\cite=Faou12] is given only for the Lie-splitting, real initial data (that is φ and γ real valued functions) and uses function spaces based on the Wiener algebra (the [formula] spaces). However, the rigorous proof of [\eqref=eq:umun] is essentially a variation on the same theme and does not present any particular difficulty as soon as the solution is smooth enough. Using this bound, we obtain that

[formula]

Plugging the bounds [\eqref=eq:boundi1] and [\eqref=eq:boundi2] into [\eqref=eq:boundi] yields the desired convergence result.

The numerical results for the initial data

[formula]

and λ  =   - 1 on the time interval

[formula]

In this example we simulate the first- and second-order approximation terms z0 and z1 given in [\eqref=eq:corr1] and [\eqref=eq:corr2], respectively. For the numerical approximation of the first approximation term we proceed as in Example [\ref=ex:firstCorr]. For the numerical approximation of the correction term z1, we solve the equation for ξ1, i.e. equation [\eqref=eq:u1rel], with a symmetric Strang splitting based on the following split-equations: The kinetic equation which can be solved exactly in Fourier, and the linear potential equation

[formula]

which we solve as described in the following. We set [formula], [formula], [formula], [formula], and furthermore [formula]. Then we can rewrite the potential equation as

[formula]

We set and approximate the potential equation [\eqref=eq:poti] with an exponential trapezoidal rule, i.e. for αnk  ≈  αk(tn), βnk  ≈  βk(tn), k = 0,1, gn  =  g(αn0,βn0), tn  =  nτ, we set

[formula]

The numerical approximation ξn + 1 to the exact solution ξ(tn + 1) of the potential equation [\eqref=eq:poteq] starting in a given point ξn is then simply given by ξn + 1  =  αn + 1  +  iβn + 1.

Concerning the space discretization, we use again the Fourier pseudo-spectral method described in the previous Section, and we denote by h the corresponding mesh size. Note that in this setting, the approximation of g0 can be easily made using FFT.

Let un,h0 be defined as in the previous section, and let ξn,h1 denote the numerical approximation to the full system [\eqref=eq:u1rel] at time tn obtained by the fully discrete Strang splitting described above, where we make half a step with the kinetic, a full step with the potential and again half a step with the kinetic part. Then, as the numerical approximation to the exact second-order approximation term at time tn  =  nτ we take

[formula]

For this approximation we have the following convergence result.

Let s  >  d / 2 and assume that φ and γ are smooth functions defined on the one-dimensional torus [formula]. Then there exist constants T,c0,C,h0 and τ0 such that the following hold: for c  >  c0, τ  <  τ0 and h  <  h0, then if z(t) denotes the exact solution of the equation [\eqref=eq:kgrc], we have where the approximation zn,h0  +  c- 2zn,h1 is defined in [\eqref=eq:approxnh].

Note that by Theorem [\ref=thm:main] we have over the time interval (0,T) and c > c0,

[formula]

The rest of the proof follows the line of argumentation given for the proof to Theorem [\ref=thm:con0], since the scheme described in [\eqref=eq:num2corr] is second-order convergent. We do not give the detail of this proof. Again it is a variation on the same theme as in [\cite=Faou12] [\cite=Lubich08].

The numerical results for the initial data

[formula]

and λ  =   - 1 on the time interval

[formula]

Here we simulate the deviation of the the first energy and charge correction term [\eqref=eq:E0] and [\eqref=eq:Q0], respectively. Also, we simulate the energy and charge deviation of the first-correction term z0(t), i.e. E(z0(t)) and Q(z0(t)), where the energy and charge are defined in [\eqref=eq:eni] and [\eqref=eq:chargi], respectively.

We set [formula] the numerical energy of the first correction term z0, for tn  =  nτ, and where un,h0 and vn,h0 are the numerical approximations of the first limit system [\eqref=eq:nsl0c] again obtained by the Strang splitting [\eqref=eq:Lie]. Similarly, we set [formula] the approximation of the first term in the asymptotic expansion of the energy. In the same way, we define the numerical charge [formula] of the first correction term, as well as the numerical approximation of the first term in the asymptotic expansion Qn,h0  =  Q0(un,h0,vn,h0).

We carry out the simulations on the time interval

[formula]