Lemma Proposition Observation Corollary

Small-Size Relative (p,ε)-Approximations for Well-Behaved Range Spaces

Work on this paper has been supported by NSF under grant CCF-12-16689.

Introduction

Motivated by the problem of approximate range counting, relative (p,ε)-approximations have been introduced by Har-Peled and Sharir [\cite=HS-11], where they revisited the seminal work of Li et al. [\cite=LLS-01], and showed how to apply it in order to derive known bounds on the size of various notions of sampling, and, in particular, relative (p,ε)-approximations. We recall their definition: A range space [formula] is a pair consisting of an underlying universe [formula] of objects and a certain collection [formula] of subsets (ranges). Of particular interest are range spaces of finite VC-dimension; the reader is referred to [\cite=HW87] for the exact definition. Informally, it suffices to require that, for any finite subset [formula], the number of distinct sets [formula] for [formula] be O(|X|d) for some constant d (which is upper-bounded by the VC-dimension). This is indeed the case in many geometric applications. In a typical geometric setting X is a subset of some infinite ground set [formula], e.g., [formula], for some low or fixed dimension d, and thus X is a finite point set in [formula], and [formula] is a collection of subsets (ranges) of [formula] of some simple shape, such as halfspaces, simplices, balls, ellipsoids, and boxes in [formula], where d is considered a fixed. In general, range spaces involving semi-algebraic ranges of constant description complexity, i.e., semi-algebraic sets defined as a Boolean combination of a constant number of polynomial equations and inequalities of constant maximum degree, have finite VC-dimension (see, e.g., [\cite=Har-Peled-11] for further details and examples). In what follows we assume to have a finite range space defined on a set X of objects, and, with a slight abuse of notation, denote its set of ranges by [formula].

Following the notation in [\cite=HS-11], the measure of a range [formula] is the quantity [formula]. Given two parameters, 0  <  p < 1 and 0  <  ε  <  1, we say that a subset Z  ⊆  X is a relative (p,ε)-approximation if it satisfies, for each range τ,

[formula]

[formula]

In fact, a slightly more general notion is the so-called (ν,α)-sample [\cite=Har-Peled-11] [\cite=Haussler-92] [\cite=LLS-01], in which case the subset Z  ⊆  X satisfies, for each range τ,

[formula]

As observed by Har-Peled and Sharir [\cite=HS-11], relative (p,ε)-approximations and (ν,α)-samples are equivalent with an appropriate relation between p, ε, and ν, α (roughly speaking, they are equivalent up to some constant factor). Due to this observation they conclude that the analysis of Li et al. [\cite=LLS-01] (that shows a bound on the size of (ν,α)-samples) implies that, for range spaces of finite VC-dimension d, there exist relative (p,ε)-approximations of size [formula], where c  >  0 is an absolute constant. In fact, any random sample of these many elements of X is a relative (p,ε)-approximation with constant probability. More specifically, success with probability at least 1 - q is guaranteed if one samples [formula] elements of X. These bounds are in fact an improvement over the bound [formula] obtained by Haussler [\cite=Haussler-92] and Pollard [\cite=Pollard-86].

It was also observed in [\cite=HS-11] that p-nets and ε-approximations are special cases of (ν,α)-samples. The first is a subset N  ⊆  X with the property that any range [formula] with [formula] contains an element of N, and the latter is a subset Z  ⊆  X with the property that any range [formula] satisfies: [formula].

In this paper we present improved bounds on the size of relative (p,ε)-approximations under certain assumptions, and emphasize their implications to p-nets--see below.

Previous results.

It has been shown in [\cite=VC-71] that range spaces of finite VC dimension d always admit an absolute-error ε-approximation of size O( log (1  /  ε)  /  ε2), where the constant of proportionality depends on d (see also [\cite=Chaz-01] [\cite=Chaz-04] [\cite=Mat-99] [\cite=PA95]). In fact, a random sample of that size is an ε-approximation with constant probability. As noted in [\cite=HS-11], the analysis in [\cite=LLS-01] (see also [\cite=Tal-94]) reduces this bound to O(1 / ε2), where, once again, a random sample of that size is an ε-approximation with a constant probability. In fact, as shown in [\cite=Chaz-01] [\cite=Chaz-04] [\cite=Mat-99], the size of the ε-approximation can be further improved to be slightly higher than O(1 / ε2 - 2 / (d + 1)); see [\cite=HS-11] for a more comprehensive review of these results.

Concerning relative (p,ε)-approximations, as noted in [\cite=HS-11], any absolute error εp-approximation Z will approximate ranges of measure at least p to within relative error ε. Nevertheless, the bound in [\cite=VC-71] for absolute-error approximations just mentioned yields a sample of size O( log (1  /  (εp))  /  ε2p2) in this case, whereas the bound of Li et al. [\cite=LLS-01] is smaller by roughly a factor of 1 / p (see the discussion above).

In addition to the observations made by Har-Peled and Sharir [\cite=HS-11], their analysis also improves the bound on the size of relative (p,ε)-approximations for several special cases of geometric range spaces. Specifically, the bound obtained for point sets in the plane and halfplane ranges has been improved to [formula] (this is an improvement if ε is sufficiently small with respect to p). In 3-space they reduced the bound to [formula], although this latter case is somewhat restricted, as this is the bound on the overall size of O( log (1  /  p)) subsets, and each halfspace range has one such subset that constitutes its relative approximation.

Our results.

In this paper we derive improved bounds for range spaces with certain favorable properties, which we call "well-behaved". Our goal is to improve the dependency on p, which is somewhat different than the improvement obtained in [\cite=HS-11]. That is, for any induced (finite) ranges space, the number of ranges of size k is only nearly-linear in the size of the space and polynomial in k, where k  >  0 is an integer parameter. We first present our technique on abstract range spaces that satisfy these properties, in which case we show there exists a sample of size roughly O(( log  log (1  /  p)  +   log (1  /  ε)) / ε2p) (see Corollary [\ref=cor:small_relative_approx] for the exact bound), from which the relative approximation is derived. We also present an algorithm that constructs such a sample in expected polynomial running time. In fact, this sample consists of two subsets of the aforementioned overall size, on which we assign weights, in order to obtain a single weighted sample with the desired properties; see Section [\ref=sec:construction] for this derivation and the discussion below.

As observed by Har-Peled [\cite=Har-Peled-11] relative approximations are interesting in the case where p  =  o(ε), since one can approximate ranges of measure larger than p with a sample that has only linear dependency on 1 / p. Our bounds improve over the bound of Li et al. [\cite=LLS-01] for these cases. Nevertheless, our bounds also have an interesting interpretation when ε is some fixed constant in (0,1). In this case, as mentioned earlier, the relative (p,ε)-approximation becomes a p-net. Thus when ε is a constant smaller than 1, a p-net of size O( log (1  /  p) / p) (with a constant of proportionality depending on the VC dimension d) always exists by applying the bound of Li et al. [\cite=LLS-01]. In this case, each range of measure at least p contains roughly log (1  /  p) points of the sample. Nevertheless, in some cases it might be wasteful to sample this number of points in order to guarantee a small relative error. There are several known constructions for small-size p-nets, see, e.g., [\cite=AES-10] [\cite=CV07] [\cite=Mat-92] [\cite=Lauen-08] [\cite=MSW90] [\cite=PR08] [\cite=Var-09] for several such improved bounds. However, we are not aware of any such small-size p-nets that are also relative approximations. Our bound guarantees such properties. For example, for primal range spaces of points and axis-parallel boxes in two and three dimensions this bound becomes [formula] instead of the standard bound O( log (1  /  p) / p). This bound matches the previously known (optimal) bound for p-nets [\cite=AES-10] [\cite=PT-11].

We also note that the task of constructing a relative (p,ε)-approximation is much more difficult than just constructing p-nets. Indeed, in p-nets we aim to add sufficiently many objects (e.g., points) into the output sample so as to guarantee that each range of measure at least p is indeed stabbed, whereas in relative (p,ε)-approximations we also need to keep the set of the chosen objects under control in order to have a balance between the original measure and the approximate measure for each range τ.

In our analysis we initially replace the set of the input objects with a relative (p,ε)-approximation [formula] of size [formula]. We then classify the objects of [formula] as "heavy" (that is, objects that participate in many ranges) and "light" (otherwise). We show that the number of heavy objects is relatively small. For the light objects, we randomly and independently choose each of them into the new relative (p,ε)-approximation with some probability π (calibrated to produce a sample of a certain expected size). Since the original range space is well-behaved, we are able to show that each range τ (of any measure 0  <  p'  <  1) admits a small degree of dependency in the space of events "[formula]: does the relative error for τ exceeds ε?". We then apply the asymmetric version of the Local Lemma of Lovász in order to conclude that with a positive probability there exists such a "good" sample for which the relative error of all such ranges does not exceed ε. In fact, we show that both conditions of having a good sample (in the above sense) and keeping its size close to its expectation (up to some constant factor) happen with a positive probability--this latter condition can be included into the Local Lemma, which extends to that case. See Section [\ref=sec:construction] for these details.

The manner in which we construct our relative approximation enforces a somewhat different form for the measure Z(τ). This is due to two main ingredients of our analysis: (i) Contrary to the standard constructions of relative (p,ε)-approximations [\cite=LLS-01] (as well the the construction in [\cite=HS-11]), absolute ε-approximations (e.g., [\cite=Chaz-01]), and p-nets (e.g., [\cite=CV07] [\cite=Var-09]), where the size of the sample is fixed, in our probabilistic model each object is chosen independently with a fixed probability π, and thus in the denominator of the measure we replace the size of the sample by its expectation. (ii) Our sample consists of two subsamples, where the first one H consists of a pre-determined subset of the input, which, due to its small size, is taken in its entirety into the output, and the second sample [formula] is obtained by choosing each input object randomly and independently with probability π . This results in a biased sample. Specifically, we obtain a weighted measure, in which we assign a unit weight to each object in [formula], and a weight π to each object in H.

Lastly, we list several useful applications of well-behaved geometric range spaces, including primal range spaces of points and halfspace ranges in two and three dimensions, points and axis-parallel boxes in two and three dimensions (as well as points and "fat" triangles in the plane), and dual range spaces involving planar regions of nearly-linear union complexity.

We note that our technique is inspired by the machinery of Varadarajan [\cite=Var-09] for constructing small-size p-nets for dual range spaces of "α-fat" triangles and points in the plane, where the idea for exploiting the (simpler version of the) Local Lemma of Lovász has initially been introduced, as well as classifying each object as "heavy" or "light". Nevertheless, the technique in [\cite=Var-09] does not necessarily produce a relative approximation, but only guarantees that the sample is a p-net, which is the reason we had to generalize and enhance the ideas in [\cite=Var-09] in order to be matched with the more intricate scenario arising in our problem.

The Construction for Well-Behaved Range Spaces

Preliminaries

Well-behaved range-spaces.

Let [formula] be a range space of finite VC dimension. We say it is well behaved it it has the following property: Let [formula] be any range space projected onto a finite subset [formula], where [formula]), and put n: = |X|. Then, for any parameter 1  ≤  k  ≤  n, the number of ranges in [formula] of size ≤  k is at most O(nφ(n)kc), where φ(  ·  ) is a slowly-growing function, and c  >  0 is an absolute constant. In other words, for any induced (finite) range space [formula] the number of ranges of size at most k is only nearly-linear in |X| and polynomial in k. Note that by definition any induced finite range space [formula] as above is also well-behaved.

In what follows we assume, without loss of generality, that 0  <  p  ≤  1 / 8. Otherwise, if we also have ε  ≥  1 / 8, then the size of the relative approximation is a constant, and if 0  <  ε  <  1 / 8 is arbitrary (and p  >  1 / 8) then an (absolute) (ε / 8)-approximation always yields an error smaller than εp. In this case the size of the sample is only O(1 / ε2), as shown by Li et al. [\cite=LLS-01]. In addition, we assume p  ≤  ε, otherwise, we output a sample of size O( log (1  /  p)  /  ε2p), as shown in [\cite=LLS-01].

The Construction

Let [formula] be a well-behaved (finite) range space. We first replace the objects in X by a sample [formula] that is a relative (p,ε)-approximation for [formula]; let [formula] be the resulting collection of ranges projected onto [formula]. By the discussion in Section [\ref=sec:intro], there exists such a sample of size [formula], where D  >  0 is a sufficiently large absolute constant. Moreover, a random sample of X of that size is a relative (p,ε)-approximation with constant probability. The replacement of X with [formula] implies that each range [formula] satisfies: and

[formula]

From now on, we focus on the construction of an improved relative (p,ε)-approximation for [formula]. This (standard) reduction involves no loss of generality, because, as is easily verified, a relative (p(1  -  ε),ε)-approximation of a relative (p,ε)-approximation is a relative (p,2ε  +  ε2)-approximation. Hence by scaling p and ε by the appropriate constant factors, it suffices to construct a relative (p,ε)-approximation for [formula].

Our construction partitions [formula] into two subsets, and represents the approximation for [formula] as the sum of two appropriate sample measures--see below for details, and for the consolidation of the two samples into a common (weighted) set.

A range τ is said to lie at the ith layer [formula] of [formula], for [formula], if it satisfies

[formula]

For the sake of completeness, the 0th layer [formula] consists of those ranges τ with [formula].

Consider a fixed layer [formula], where i  ≥  1. Put [formula]. Equation ([\ref=eq:layer]) and the bound on |F| then imply that each range [formula] satisfies [formula]. If [formula], then Equation ([\ref=eq:layer]) implies [formula].

In other words, all ranges [formula] have size at most 2Δi (and at least Δi, if i  ≥  1), [formula], and they appear now as ranges from the range space [formula] projected onto (that is, restricted to) [formula]. The assumption that the (original) range space [formula] is well-behaved implies that the number of the distinct ranges in a fixed layer [formula] is only [formula].

A classification of the objects.

The discussion above implies that the number of containments between the objects in [formula] and the ranges in layer [formula] is [formula], for [formula]. We say that an object in [formula] is heavy in [formula] if it appears in at least [formula] ranges (at layer [formula]), for a sufficiently large constant A  >  0 that depends on the constant of proportionality in the bound on the number of containments. Otherwise, this object is said to be light in [formula]. An easy variant of Markov's inequality implies that the number of heavy objects (in [formula]) is at most [formula]. Hence, the overall number of heavy objects, over all layers [formula], is only O(1 / p). Let H denote this subset, which, from now on, we just refer to as the heavy objects. Note that, by construction, each remaining object (an object in [formula]) is light in each layer [formula]. Put [formula] and refer to its elements as the light objects.

We next consider, for each range τ, the two subsets [formula], [formula] of heavy and light objects, respectively, which τ stabs, and approximate each of their measures in turn. First, since the number of heavy objects is only O(1 / p), we put all of them in the target relative (p,ε)-approximation. In the sequel we describe our approximation with respect to the light objects.

The Analysis for the Light Objects

We first observe that the analysis above regarding the size of |H| allows us to assume that [formula]. Indeed, this easily follows by choosing the constant A sufficiently large.

We now restrict the range space [formula] to L. Our goal is now to approximate [formula]. We keep associating these ranges with the same layers [formula], as defined in ([\ref=eq:layer]). Note that a range τ at layer i may now satisfy [formula]. This can happen, for example, when the overall majority of objects in [formula] are heavy and then [formula] is considerably smaller than [formula]. These differences, however, do not affect the final approximation for [formula], which is a key observation in our analysis; see Section [\ref=sec:derivation] for this derivation.

We next sample each object in L independently with probability [formula], and let [formula] be the resulting sample. Thus its expected size is [formula]. Note that, by assumption φ(  ·  ) is a sublinear function, and p  ≤  ε, thus we always have π  <  1, as is easily verified. The main ingredients of the analysis are shown in the following proposition:

With some positive probability, [formula] satisfies, for every layer [formula] and for every range τ of [formula], [formula], (where [formula] denotes expectation):

[formula]

and

[formula]

When i = 0 we have for each [formula] (in which case [formula]):

[formula]

Fix a layer [formula] and a range [formula], i  ≥  1. Let [formula] be the event that [formula] does not satisfy ([\ref=eq:approx_size]) for τ. We consider separately the following two cases: [formula], and [formula].

(i) [formula]: Since [formula], the event [formula] in this case is

[formula]

That is, [formula]   or   [formula]. Since [formula], we have:

[formula]

Using Chernoff's bound (see, e.g., [\cite=AS-00]) and the fact that [formula], we thus obtain:

[formula]

Substituting [formula], [formula], we obtain

[formula]

where B  >  0 is a constant that depends linearly on D, and can be made arbitrarily large by choosing D sufficiently large.

(ii) [formula]: Here [formula] is the event:

[formula]

That is, [formula]   or   [formula]. We then have:

[formula]

[formula]

Applying once again Chernoff's bound, we obtain:

[formula]

Since in this case [formula], and, as stated above, [formula], we obtain that the latter term is bounded by [formula], on which we can derive the same bound as in case (i), using similar considerations. Hence in summary we obtain in both cases

[formula]

The case i = 0 (or rather [formula]) follows by similar considerations as in case (ii) above when replacing 2i - 1p with p. This yields the bound [formula] in this case.

Applying the Asymmetric Local Lemma of Lovász.

We next apply the Local Lemma of Lovász (see, e.g., [\cite=AS-00]), to show that

[formula]

This will imply that there exists a sample [formula] of L that approximates [formula] as in ([\ref=eq:approx_size]), for all ranges τ. Specifically, we are going to apply the asymmetric version of the Local Lemma, stated below in the context of our problem.

We first observe that for a pair of ranges τ, τ', the corresponding events [formula], [formula] are mutually independent if and only if there is no object in L that participates in both τ, τ'. Indeed, since we sample each object of L independently, the two corresponding events [formula], [formula] can affect each other only if there is an object in L that τ, τ' share. In what follows we denote a pair E, E' of mutually dependent events by E  ~  E'.

Let [formula] denote the collection of events [formula] for all ranges τ at a fixed layer i, and let [formula] denote the entire collection [formula]. In order to apply the asymmetric version of the Local Lemma we need to show there exists an assignment [formula], such that

[formula]

for each [formula]. The Local Lemma of Lovász then implies that

[formula]

(Once again, see [\cite=AS-00] for further details.) In Lemma [\ref=lem:local_lemma] we show that there exists such a valid assignment. This will complete the proof of the proposition.

The assignment [formula], for each [formula] and for each layer [formula], [formula], satisfies ([\ref=eq:assignment]) for every [formula].

We postpone the proof of Lemma [\ref=lem:local_lemma] to Appendix [\ref=app:proof_local_lemma], but leave several remarks below.

Remarks: 1). We note that for each [formula], the exponent 2j - 1 in the bound on [formula] "beats" the term Δc + 2j in the degree of dependency (see Appendix [\ref=app:proof_local_lemma]). Nevertheless, when i  >  j, this exponent cannot beat Δi, which is the reason we set [formula]. This also demonstrates the crucial property of classifying the ranges according to their layers, and then bounding the probability to fail to produce a relative (p,ε)-approximation in each of these layers, as we did in Proposition [\ref=prop:F_1]. In other words, just the information [formula] or [formula] (which is the standard "cut-off" in relative approximations) is insufficient to produce a relative bounded error in the manner that we do. 2). We note that applying the simpler version of the Local Lemma of Lovász, in each fixed layer i, is almost immediate (a similar step has been taken in [\cite=Var-09] for "fat" triangles in the plane and points). Indeed, each range has a degree-of-dependency δ that is at most [formula]. Following Inequality ([\ref=eq:chernoff]), we obtain [formula], for a sufficiently large choice of D (and thus of B). In this case, the Local Lemma implies that, with a positive probability, all the complementary events [formula] (for [formula] in layer i) are satisfied. Nevertheless, this property is not guaranteed for the entire set of events over all layers, as the interaction among events from different layers may involve a higher degree of dependency. This is the main reason we had to resort to the asymmetric version of the Local Lemma, which, as our analysis shows, overcomes this difficulty, and eventually obtains a single sample for all layers.

Bounding the size of the sample.

As noted above, the expected size of [formula] is [formula]. Nevertheless, we need to show that a sample of that actual size exists and that it satisfies the assertions in Proposition [\ref=prop:F_1]. In Appendix [\ref=app:proof_sample_size] we show that Lemma [\ref=lem:local_lemma] can be extended to include the event [formula] that [formula] deviates from its expectation by some constant factor. This yields:

There exists a sample [formula] that satisfies the assertion of Proposition [\ref=prop:F_1], whose size is [formula].

Deriving the Relative Approximation

We now combine the two samples [formula] and H that we have constructed in order to derive the relative approximation for each range τ. By construction, [formula]. Combining the two cases in ([\ref=eq:approx_size]) for each range τ in [formula], [formula], and adding the term [formula] for each side of the inequality, we have:

[formula]

Substituting [formula], we obtain:

[formula]

Since [formula], the above inequality can be written as

[formula]

or

[formula]

For [formula], since [formula] (by definition), this implies that

[formula]

When i = 0, we have [formula], and then, using similar considerations as above, the case i = 0 of ([\ref=eq:approx_size]) implies:

[formula]

and we can replace the term εp by 2εp in order to be consistent with the previous form obtained for [formula].

Note that the measure approximating [formula] can be interpreted to be defined on a weighted sample, where each object of [formula] is assigned a unit weight, and each object of H is assigned a (fractional) weight π. Also, observe that the total expected weight of the sample satisfies [formula] (matching the denominator in our measure), and so in our construction this weighted measure replaces the standard "uniform measure" [formula] (defined in the introduction) resulting when the entire relative approximation is obtained as a uniform sample.

Scaling the parameter ε appropriately, we conclude:

Let [formula] be a well-behaved range space. Then there exist two subsets [formula], [formula], with the following properties: Each range [formula] satisfies:

[formula]

if [formula], and

[formula]

otherwise. Thus the sample [formula] is a (weighted) relative (p,ε)-approximation for [formula], and its overall size is only [formula].

Scaling appropriately the parameter ε once again and also p (see Section [\ref=sec:construction] for the discussion) we obtain:

Let [formula] be a well-behaved range space. Then there exists a (weighted) relative a (p,ε)-approximation for [formula], of size [formula].

A polynomial-time algorithm.

We note that classifying the objects as light or heavy can be done in time polynomial in [formula] (we omit these straightforward details here). In order to apply the Local Lemma in a constructive manner, we resort to a recent result by Moser and Tardos [\cite=MT-10]. In our scenario we apply the extended version of Lemma [\ref=lem:local_lemma] (including the event [formula]), discussed briefly above and proved in Appendix [\ref=app:proof_sample_size]. The main property required in order to apply the randomized algorithm described in [\cite=MT-10] is the fact that the objects in [formula] are chosen randomly and independently with probability π. That is, the set L induces a finite set of mutually and independent random variables. Then each event [formula], as well as [formula], is determined by these variables. Omitting any further details, we obtain:

Given a well-behaved range space [formula], one can construct in expected polynomial time, a (weighted) relative (p,ε)-approximation for [formula], whose size is [formula].

Applications

Using the bound in Theorem [\ref=the:approximation] we obtain several geometric settings that admit small-size relative (p,ε) approximations. We review these settings and their analysis in Appendix [\ref=app:applications], and conclude:

Any range space of points and axis-parallel rectangles in the plane admits a (weighted) relative (p,ε)-approximation of size O(( log  log (1  /  p)  +   log (1  /  ε))  /  ε2p), for any 0  <  p  <  1, 0  <  ε  <  1, which can be constructed in expected polynomial time. The same asymptotic bound holds for points and axis-parallel boxes in three dimensions, and points and α-fat triangles in the plane (where α  >  0 is a constant). When ε is a constant these bounds match the optimal Θ( log  log (1  /  p)  /  p) bound for p-nets.

Any range space of points and halfspaces in two and three dimensions admits a (weighted) relative (p,ε)-approximation of size O(( log  log (1  /  p)  +   log (1  /  ε))  /  ε2p), for any 0  <  p  <  1, 0  <  ε  <  1, which can be constructed in expected polynomial time.

Any dual range space defined on (i) pseudo-disks, (ii) α-fat triangles, (iii) locally γ-fat objects and points in the plane admits a relative (p,ε)-approximation of size O(( log  log (1  /  p)  +   log (1  /  ε))  /  ε2p), for any 0  <  p  <  1, 0  <  ε  <  1, which can be constructed in expected polynomial time.

Concluding Remarks.

This study raises several open problems and further improvements, some of which are under on-going research. First, it is very likely that the sampling scheme that we introduce can be applied over iterations, where at the kth iterations we are given a sample [formula], from which we extract the sets Hk - 1, Lk - 1 of the corresponding heavy and light objects, and then sample each object from Lk - 1 with probability [formula], obtaining [formula]; we stop at iteration k if log (k + 1)(1  /  p)  <   log φ(|Fk  -  1|). However, this process involves several technical difficulties since (i) the values of p, ε change over iterations, and (ii) the (weighted) measure becomes somewhat intricate, as it should consist of [formula] and all sets of heavy objects collected over all iterations. The author has several initial bounds obtained for this process, and she plans to finalize these details in the full version of this paper. This will tighten the current (probably, suboptimal) bounds stated in Corollaries [\ref=cor:halfspaces] and [\ref=cor:small_union_applications].

Another interesting problem that we plan to study is whether the log (1  /  ε) factor in the enumerator of our bound can be removed. Li et al. [\cite=LLS-01] obtained such an improvement, where they reduced the previously known bound O( log (1  /  (pε))  /  ε2p) in [\cite=Haussler-92] [\cite=Pollard-86] to O( log (1  /  p)  /  ε2p), which they showed to be optimal in the worst case. This improvement is derived by applying the chaining method of Kolmogorov. Roughly speaking, in this technique the standard union bound over a set of events (defined in some probability space) is replaced by a tighter bound when considering only a relatively small subset of events, each of which is "distinct" in some sense (such a subset is also called an "ε-packing" [\cite=Har-Peled-11]). It is a challenging open problem to combine our machinery with the chaining method. Specifically, does an ε-packing exist in our scenario? If so, can one apply the Local Lemma of Lovász on the corresponding events?

Last but not least is the implications of our approach to the bounds on combinatorial discrepancy for well-behaved range spaces. In particular, even just the case of points and halfplane ranges is already challenging. Har-Peled and Sharir [\cite=HS-11] showed that in such range spaces [formula] the discrepancy [formula] of each range [formula] is only [formula], where n  =  |P|. This property eventually yields the improved bound for relative (p,ε)-approximations in this scenario; recall that the improvement in [\cite=HS-11] is with respect to the dependency on ε. If the factor log n in [formula] can be reduced to o( log n) then this will yield an improvement in the parameter p as well. Nevertheless, we were unable to apply our technique on this setting so far, due to the differences in our probabilistic model and the one applied in [\cite=HS-11].

Acknowledgments.

The author wishes to thank Micha Sharir for helpful discussions and for his help in writing this paper. The author also wishes to thank Boris Aronov and Sariel Har-Peled for several useful comments, and, in particular, to Sariel's comment regarding the strength of the result for the case of p-nets. The author also thanks Gabor Tardos for a useful discussion about the constructive proof of the Local Lemma of Lovász.

The Construction

Proof of Lemma [\ref=lem:local_lemma]:

For simplicity of presentation, we bound [formula], for all [formula] by [formula], which clearly holds by the bound given in the proof of Proposition [\ref=prop:F_1]. Thus ([\ref=eq:chernoff]) holds for all [formula].

Fix a range τ and a layer [formula]. We first observe that [formula]. The lower bound is trivial. For the upper bound, we obtain from ([\ref=eq:chernoff]) that [formula], which is smaller than 1 since B  >  1 (and is chosen to be sufficiently large) and p  ≤  1 / 8 by our assumption.

We next consider all events [formula] with [formula], [formula]. Let i be the layer of the range τ, and let j be the layer of τ'. The corresponding product [formula] in the right-hand side of ([\ref=eq:assignment]) can be spelled out for τ as

[formula]

We lower bound separately the sub-products involving layers [formula] with i  ≤  j and layers [formula] with i  >  j.

(i) i  ≤  j: In this case, since τ contains at most O(Δi) light objects (as noted above, τ may also contains at most O(Δi) heavy objects, but they are ignored at that part of the analysis), each of which participates in at most [formula] ranges τ' of [formula], it follows that τ has a degree-of-dependency at most [formula], for some absolute constant α  >  0, with the ranges of [formula]. We thus obtain:

[formula]

We simplify the right-hand side using the inequality (1 - y)z  ≥  1  -  zy, for 0  <  y  <  1, and the fact that [formula], for each [formula]. Specifically, we have

[formula]

for another constant α'. We then have

[formula]

[formula]

By "stealing" a small portion β  ·  2j - 1 from the exponent B  ·  2j - 1, for some sufficiently large constant β  >  0, we can assume that

[formula]

By choosing B sufficiently large, we thus obtain:

[formula]

for a suitable constant 0  <  B'  <  B that can be made arbitrarily large by choosing B sufficiently large. Having such a choice for B', and recalling that p  ≤  1 / 8, we obtain that the latter expression is greater than [formula], where κ  >  0 is a large constant, whose choice depends on B' (and thus on B).

(ii) i  >  j: As in the previous case, τ has a degree-of-dependency at most [formula] with the layers of [formula], and we have:

[formula]

Choosing B sufficiently large, we can assume that [formula]. We can now use the inequality (1 - y)z  ≥  e- 2yz, for 0  <  y  ≤  1 / 2. Proceeding as in the previous case, we have

[formula]

[formula]

[formula]

Applying an exponent stealing similar to the one above, we can cancel most of the other part of the expression, and end up with a lower bound of the form:

[formula]

where 0  <  B''  <  B is another constant sufficiently close to B. We can in fact assume that B''  =  B' by replacing the larger of them by the smaller. Choosing B (and thus B') to be sufficiently large, and using, as above, the inequality p  ≤  1 / 8, we obtain that

[formula]

where κ  >  0 can be chosen to be the same constant as in case (i).

Putting the bounds together:

We thus obtain, for a fixed range τ,

[formula]

For the first product we have

[formula]

For the latter product we have

[formula]

This implies that

[formula]

Given that κ is chosen to be sufficiently large we obtain

[formula]

as asserted. This completes the proof of the lemma.

Proof of Corollary [\ref=cor:F_1]

To this end, we strengthen ([\ref=eq:all_events]) to include the event [formula], where γ is a sufficiently large constant. That is, we show that there exists an additional assignment [formula], such that

[formula]

implying that all complementary events occur with a positive probability. By construction, for each each event [formula], we have [formula]. We thus need to modify ([\ref=eq:assignment]) as follows:

[formula]

[formula]

Indeed, we obtain using Chernoff's bound once again, the fact that [formula], and [formula]:

[formula]

[formula]

By ([\ref=eq:all_events]) and the assignment of [formula] in Lemma [\ref=lem:local_lemma] we obtain:

[formula]

Using ([\ref=eq:chernoff]) and the fact that there are only [formula] ranges in layer i, the latter term is lower bounded by

[formula]

[formula]

for two absolute constants α,α'  >  0. Applying once again "exponent stealing" similarly to the proof of Lemma [\ref=lem:local_lemma], we obtain that this term is at least

[formula]

for a suitable constant 0  <  B'  <  B that can be made arbitrarily large by choosing B sufficiently large. Comparing the latter exponent with that of ([\ref=eq:size_F_1]), we conclude that

[formula]

when γ is chosen to be sufficiently large. We now put [formula] to be

[formula]

In other words, we set [formula] to be the ratio between the upper bound on [formula] and the lower bound on [formula]. Due to this property we always have [formula], and thus the second part of Inequality ([\ref=eq:assignment_B]) is satisfied. We also note that when γ is chosen to be sufficiently large, we should have [formula]. In fact, [formula] can be made arbitrarily small (by choosing γ sufficiently large), and then we have, say, [formula]. This implies that we can modify Inequality ([\ref=eq:final_condition]) from the proof of Lemma [\ref=lem:local_lemma] so that it now satisfies

[formula]

which shows the first part of ([\ref=eq:assignment_B]).

Applications

Points and Axis-Parallel Boxes in Two and Three Dimensions

We begin with the two-dimensional case. It is well known that a set P of n points in the plane admits Θ(n2) rectangular "empty" ranges (that is, these ranges do not contain any point of P in their interior); see, e.g., [\cite=AES-10]. Thus we resort to the technique presented in [\cite=AES-10] [\cite=EHR-12] instead. We use the following property shown in [\cite=EHR-12] (and based on the analysis in [\cite=AES-10]):

Given a set P of n points in the plane and a parameter k  >  0, one can compute a set Rk of O(k2n log n) axis-parallel rectangles (each of which is "anchored" either on its right side or its left side to a vertical line), such that for any axis-parallel rectangle r, if [formula], then there exists two rectangles r1,r2∈Rk such that [formula].

Thus in this case c = 2 and φ(  ·  ) is the log (  ·  ) function, so the range space (P,Rn) is well-behaved. In order to bound the relative error for the original (non-anchored) rectangular ranges we proceed as follows. Let τ be such a range realized by a rectangle r, let r1, r2 be its two corresponding portions satisfying the property in Lemma [\ref=lem:rectangles], and let τ1, τ2 be [formula], [formula], respectively. We now replace P by the corresponding sample [formula], and, as before, denote by [formula] the set of the resulting ranges, and then apply Theorem [\ref=the:approximation] in order to obtain:

[formula]

for i = 1,2. By combining these inequalities for τ1, τ2, we obtain:

[formula]

This implies that [formula] is a relative (p,3ε)-approximation for [formula] (in the above "weighted sense"), and [formula].

When P is a set of points in three dimensions, one can obtain similar properties to those in Lemma [\ref=lem:rectangles], derived from the analysis in [\cite=AES-10]. In this case one can compute a set Bk of O(k2n log 3n) axis-parallel boxes such that for any axis-parallel box b, if [formula], then there exists eight boxes [formula] such that [formula]. We omit the straightforward details in this version.

Thus in this case c = 2 and φ(  ·  ) is the log 3(  ·  ) function, so the range space (P,Bn) is well-behaved. As above, put [formula], [formula]. Replacing P with [formula] once again, applying Theorem [\ref=the:approximation], and then combining the resulting inequalities for τi, [formula]:

[formula]

and thus [formula] is a relative (p,9ε)-approximation for [formula], and its size has the same asymptotic bound as in the two-dimensional case.

Points and α-fat triangles in the plane.

When P is a set of n points in the plane and the ranges are α-fat triangles (that is, triangles for which each of their angles is at least α) the analysis in [\cite=EHR-12] implies:

Given a set P of n points in the plane, a parameter k, and a constant α  >  0, one can compute, in polynomial time, a set [formula] of O(k3n log 2n) regions, such that for any α-fat triangle Δ, if [formula], then there exists (at most) 9 regions in [formula] whose union has the same intersection with P as Δ does.

Using similar arguments and notation as in the case for axis-parallel boxes (here we have c = 3 and φ(  ·  ) is the log 2(  ·  ) function), we obtain:

[formula]

and thus is [formula] is a relative (p,10ε)-approximation for [formula], and its size has the same asymptotic bound as in the previous cases.

We now appropriately scale the parameters ε, p, for each of the above three settings, in order to obtain Corollary [\ref=cor:boxes_triangles].

Points and Halfspaces in Two and Three Dimensions

Let P be a set of n points, and let [formula] denote all halfspace ranges. Using the random sampling theory of Clarkson and Shor [\cite=CS-89], for any subset of m points of P, the number of halfspaces of size at most k, for any integer parameter 0  ≤  k  ≤  m, is O(mk  +  m) in two dimensions and O(mk2  +  m) in three dimensions. It thus follows that in both cases [formula] is a well-behaved range space, and we can thus apply Theorem [\ref=the:algorithm] for these cases, thereby showing Corollary [\ref=cor:halfspaces].

Planar Regions of Nearly-Linear Union Complexity and Points

Let R be a set of n (closed) connected planar regions, and let [formula] denote the union of R. The combinatorial complexity of [formula] is the number of vertices and edges of the arrangement [formula] that appear along [formula]. For r  ≤  n, let [formula] denote the maximum complexity of the union of any subset of r regions in R, measured as above. We assume that [formula] is nearly linear, i.e., [formula], where φ(  ·  ) is a (sublinear) slowly growing function. We now consider the dual range space defined on R and all points in the plane. In fact, it is fairly standard to show that these ranges correspond to all faces in the arrangement [formula], where each range is the subset of regions covering a fixed face of [formula]. Using a standard application of the Clarkson-Shor technique [\cite=CS-89], for any subset of r regions of R, the number of such faces of size at most k, for any integer parameter k  >  0, is [formula], or O(krφ(r / k)). Applying Theorem [\ref=the:algorithm], we obtain:

Let R be a set of n planar regions such that the union complexity of any r of them is [formula], where φ(  ·  ) is a (sublinear) slowly growing function. Then any dual range space on R and a set of points in the plane admits a (weighted) relative (p,ε)-approximation of size

[formula]

for any 0  <  p  <  1, 0  <  ε  <  1. This relative approximation can be constructed in expected polynomial time.

We now present several standard families with this property, state their union complexity, and then apply Corollary [\ref=cor:small_union] for each of these cases in order to conclude Corollary [\ref=cor:small_union_applications].

Pseudo-disks.

In a set of pseudo-disks, the boundary of any pair of regions are either disjoint or cross twice. In this case [formula] [\cite=KLPS-86].

α-fat triangles.

Recall that a triangle is α-fat if each of its angles is at least α. In this case [formula], where the constant of proportionality depends on α [\cite=AdBES-12] [\cite=EAS-11]. When the triangles have roughly the same size, this complexity reduces to O(r) [\cite=MPSSW-94]. When on the sides of these triangles is unbounded (in which case the triangles become α-fat wedges), this complexity also reduces to O(r) [\cite=ERS-94].

Locally γ-fat objects.

Given a parameter 0  <  γ  ≤  1, an object o is locally γ-fat if, for any disk D whose center lies in o, such that D does not fully contain o in its interior, we have [formula], where [formula] is the connected component of [formula] that contains the center of D. We also assume that the boundary of each of the given objects has only O(1) locally x-extreme points, and that the boundaries of any pair of objects intersect in at most s points, for some constant s. It is then shown in [\cite=AdBES-12] that [formula], where the constant of proportionality (in the linear term) depends on γ.