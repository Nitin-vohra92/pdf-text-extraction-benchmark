Lemma Proposition Corollary Claim

Incidences between points and lines in three dimensions

Work on this paper by Noam Solomon and Micha Sharir was supported by Grant 892/13 from the Israel Science Foundation. Work by Micha Sharir was also supported by Grant 2012/229 from the U.S.-Israel Binational Science Foundation, by the Israeli Centers of Research Excellence (I-CORE) program (Center No. 4/11), and by the Hermann Minkowski-MINERVA Center for Geometry at Tel Aviv University.

Noam Solomon

Introduction

Let P be a set of m distinct points in [formula] and let L be a set of n distinct lines in [formula]. Let I(P,L) denote the number of incidences between the points of P and the lines of L; that is, the number of pairs [formula] with p∈P, [formula], and [formula]. If all the points of P and all the lines of L lie in a common plane, then the classical Szemerédi-Trotter theorem [\cite=SzT] yields the worst-case tight bound

[formula]

This bound clearly also holds in three dimensions, by projecting the given lines and points onto some generic plane. Moreover, the bound will continue to be worst-case tight by placing all the points and lines in a common plane, in a configuration that yields the planar lower bound.

In the 2010 groundbreaking paper of Guth and Katz [\cite=GK2], an improved bound has been derived for I(P,L), for a set P of m points and a set L of n lines in [formula], provided that not too many lines of L lie in a common plane. Specifically, they showed:

Let P be a set of m distinct points and L a set of n distinct lines in [formula], and let s  ≤  n be a parameter, such that no plane contains more than s lines of L. Then

[formula]

This bound was a major step in the derivation of the main result of [\cite=GK2], which was to prove an almost-linear lower bound on the number of distinct distances determined by any finite set of points in the plane, a classical problem posed by Erd os in 1946 [\cite=Er46]. Their proof uses several nontrivial tools from algebraic and differential geometry, most notably the Cayley-Salmon theorem on osculating lines to algebraic surfaces in [formula], and additional properties of ruled surfaces. All this machinery comes on top of the main innovation of Guth and Katz, the introduction of the polynomial partitioning technique; see below.

In this paper, we provide a simple derivation of this bound, which bypasses most of the techniques from algebraic geometry that are used in the original proof. A recent related study by Guth [\cite=Gu14] provides another simpler derivation of a similar bound, but (a) the bound obtained in [\cite=Gu14] is slightly worse, involving extra factors of the form [formula], for any ε > 0, and (b) the assumptions there are stronger, namely that no algebraic surface of degree at most [formula], a (potentially large) constant that depends on ε, contains more than s lines of L (in fact, Guth considers in [\cite=Gu14] only the case [formula]). It should be noted, though, that Guth also manages to derive a (slightly weaker but still) near-linear lower bound on the number of distinct distances.

As in the classical work of Guth and Katz [\cite=GK2], and in the follow-up study of Guth [\cite=Gu14], here too we use the polynomial partitioning method, as pioneered in [\cite=GK2]. The main difference between our approach and those of [\cite=Gu14] [\cite=GK2] is the choice of the degree of the partitioning polynomial. Whereas Guth and Katz [\cite=GK2] choose a large degree, and Guth [\cite=Gu14] chooses a constant degree, we choose an intermediate degree. This reaps many benefits from both the high-degree and the constant-degree approaches, and pays a small price in the bound (albeit much better than in [\cite=Gu14]). Specifically, our main result is a simple and fairly elementary derivation of the following result.

Let P be a set of m distinct points and L a set of n distinct lines in [formula], and let s  ≤  n be a parameter, such that no plane contains more than s lines of L. Then

[formula]

where B is an absolute constant, and, for another suitable absolute constant b > 1,

[formula]

Remarks. (1) Only the range [formula] is of interest; outside this range, regardless of the dimension of the ambient space, we have the well known and trivial upper bound O(m + n).

(2) The term m2 / 3n1 / 3s1 / 3 comes from the planar Szemerédi-Trotter bound ([\ref=inc2]), and is unavoidable, as it can be attained if we densely "pack" points and lines into planes, in patterns that realize the bound in ([\ref=inc2]).

(3) Ignoring this term, the two terms m1 / 2n3 / 4 and m "compete" for dominance; the former dominates when m  ≤  n3 / 2 and the latter when m  ≥  n3 / 2. Thus the bound in ([\ref=st]) is qualitatively different within these two ranges.

(4) The threshold m = n3 / 2 also arises in the related problem of joints (points incident to at least three non-coplanar lines) in a set of n lines in 3-space; see [\cite=GK].

A concise rephrasing of the bound in ([\ref=st]) and ([\ref=amn]) is as follows. We partition each of the ranges m  ≤  n3 / 2, m  >  n3 / 2 into a sequence of subranges nαj - 1  <  m  ≤  nαj, [formula] (for m  ≤  n3 / 2), or nαj - 1  >  m  ≥  nαj, [formula] (for m  ≥  n3 / 2), so that within each range the bound asserted in the theorem holds for some fixed constant of proportionality (denoted as Am,n in the bound), where these constants vary with j, and grow, exponentially in j, as prescribed in ([\ref=amn]), as m approaches n3 / 2 (from either side). Informally, if we keep m "sufficiently away" from n3 / 2, the bound in ([\ref=st]) holds with a fixed constant of proportionality. Handling the "border range" m  ≈  n3 / 2 is also fairly straightforward, although, to bypass the exponential growth of the constant of proportionality, it results in a slightly different bound; see below for details.

Our proof is elementary to the extent that, among other things, it avoids any explicit handling of singular and flat points on the zero set of the partitioning polynomial. While these notions are relatively easy to handle in three dimensions (see, e.g., [\cite=EKS] [\cite=GK]), they become more complex notions in higher dimensions (as witnessed, for example, in our companion work on the four-dimensional setting [\cite=SS4d]), making proofs based on them harder to extend.

Additional merits and features of our analysis are discussed in detail in the concluding section. In a nutshell, the main merits are:

(i) We use two separate partitioning polynomials. The first one is of "high" degree, and is used to prune away some points and lines, and to establish useful properties of the surviving points and lines. The second partitioning step, using a polynomial of "low" degree, is then applied, from scratch, to the surviving input, exploiting the properties established in the first step. This idea seems to have a potential for further applications.

(ii) Because of the way we use the polynomial partitioning technique, we need induction to handle incidences within the cells of the second partition. One of the nontrivial achievements of our technique is the ability to retain The "planar" term O(m2 / 3n1 / 3s1 / 3) in the bound in ([\ref=st]) through the inductive process. Without such care, this term does not "pass well" through the induction, which has been a sore issue in several recent works on related problems (see [\cite=SSS] [\cite=SSZ] [\cite=surf-socg]). This is one of the main reasons for using two separate partitioning steps.

Background.

Incidence problems have been a major topic in combinatorial and computational geometry for the past thirty years, starting with the aforementioned Szemerédi-Trotter bound [\cite=SzT] back in 1983. Several techniques, interesting in their own right, have been developed, or adapted, for the analysis of incidences, including the crossing-lemma technique of Székely [\cite=Sz], and the use of cuttings as a divide-and-conquer mechanism (e.g., see [\cite=CEGSW]). Connections with range searching and related algorithmic problems in computational geometry have also been noted, and studies of the Kakeya problem (see, e.g., [\cite=T]) indicate the connection between this problem and incidence problems. See Pach and Sharir [\cite=PS] for a comprehensive (albeit a bit outdated) survey of the topic.

The landscape of incidence geometry has dramatically changed in the past six years, due to the infusion, in two groundbreaking papers by Guth and Katz [\cite=GK] [\cite=GK2], of new tools and techniques drawn from algebraic geometry. Although their two direct goals have been to obtain a tight upper bound on the number of joints in a set of lines in three dimensions [\cite=GK], and a near-linear lower bound for the classical distinct distances problem of Erd os [\cite=GK2], the new tools have quickly been recognized as useful for incidence bounds. See [\cite=EKS] [\cite=KMSS] [\cite=KMS] [\cite=SSZ] [\cite=SoTa] [\cite=Za1] [\cite=Za2] for a sample of recent works on incidence problems that use the new algebraic machinery.

The simplest instances of incidence problems involve points and lines, tackled by Szemerédi and Trotter in the plane [\cite=SzT], and by Guth and Katz in three dimensions [\cite=GK2]. Other recent studies on incidence problems include incidences between points and lines in four dimensions (Sharir and Solomon [\cite=surf-socg] [\cite=SS4d]), and incidences between points and circles in three dimensions (Sharir, Sheffer and Zahl [\cite=SSZ]), not to mention incidences with higher-dimensional surfaces, such as in [\cite=BS] [\cite=KMSS] [\cite=SoTa] [\cite=Za1] [\cite=Za2]. In a companion paper (with Sheffer) [\cite=SSS], we study the general case of incidences between points and curves in any dimension, and derive reasonably sharp bounds (albeit weaker in several respects than the one derived here).

That tools from algebraic geometry form the major key for successful solution of difficult problems in combinatorial geometry, came as a big surprise to the community. It has lead to intensive research of the new tools, aiming to extend them and to find new applications. A major purpose of this study, as well as of Guth [\cite=Gu14], is to show that one can still tackle successfully the problems using less heavy algebraic machinery. This offers a new, simplified, and more elementary approach, which we expect to prove potent for other applications too, such as those just mentioned. Looking for simpler, yet effective techniques that would be easier to extend to more involved contexts (such as incidences in higher dimensions) has been our main motivation for this study.

A more detailed supplementary discussion (which would be premature at this point) of the merits and other issues related to our technique is given in a concluding section.

Proof of Theorem [\ref=th:main]

The proof proceeds by induction on m. As already mentioned, the bound in ([\ref=st]) is qualitatively different in the two ranges m  ≤  n3 / 2 and m  ≥  n3 / 2. The analysis bifurcates accordingly. While the general flow is fairly similar in both cases, there are many differences too.

The case m  <  n3 / 2.

We partition this range into a sequence of ranges m  ≤  nα0, [formula], where α0  =  1 / 2 and the sequence {αj}j  ≥  0 is increasing and converges to 3 / 2. More precisely, as our analysis will show, we can take [formula], for j  ≥  0. The induction is actually on the index j of the range nαj - 1 < m  ≤  nαj, and establishes ([\ref=st]) for m in this range, with a coefficient Aj (written in ([\ref=st], [\ref=amn]) as Am,n) that increases with j. This paradigm has already been used in Sharir et al. [\cite=SSZ] and in Zahl [\cite=Za2], for related incidence problems, albeit in a somewhat less effective manner; see the discussion at the end of the paper.

The base range of the induction is [formula], where the trivial general upper bound on point-line incidences, in any dimension, yields I = O(m2 + n) = O(n), so ([\ref=st]) holds for a sufficiently large choice of the initial constant A0.

Assume then that ([\ref=st]) holds for all m  ≤  nαj - 1 for some j  ≥  1, and consider an instance of the problem with nαj - 1  <  m  ≤  n3 / 2 (the analysis will force us to constrain this upper bound in order to complete the induction step, thereby obtaining the next exponent αj).

Fix a parameter r, whose precise value will be chosen later (in fact, and this is a major novelty of our approach, there will be two different choices for r--see below), and apply the polynomial partitioning theorem of Guth and Katz (see [\cite=GK2] and [\cite=KMS]), to obtain an r-partitioning trivariate (real) polynomial f of degree D = O(r1 / 3). That is, every connected component of [formula] contains at most m / r points of P, where Z(f) denotes the zero set of f. By Warren's theorem [\cite=w-lbanm-68] (see also [\cite=KMS]), the number of components of [formula] is O(D3)  =  O(r).

Set [formula] and [formula]. A major recurring theme in this approach is that, although the points of P'1 are more or less evenly partitioned among the cells of the partition, no nontrivial bound can be provided for the size of P1; in the worst case, all the points of P could lie in Z(f). Each line [formula] is either fully contained in Z(f) or intersects it in at most D points (since the restriction of f to [formula] is a univariate polynomial of degree at most D). Let L1 denote the subset of lines of L that are fully contained in Z(f) and put [formula]. We then have

[formula]

We first bound I(P1,L'1) and I(P'1,L'1). As already observed, we have

[formula]

We estimate I(P'1,L'1) as follows. For each (open) cell τ of [formula], put [formula] (that is, [formula]), and let Lτ denote the set of the lines of L'1 that cross τ; put mτ  =  |Pτ|  ≤  m / r, and nτ  =  |Lτ|. Since every line [formula] crosses at most 1 + D components of [formula], we have

[formula]

For each τ we use the trivial bound I(Pτ,Lτ)  =  O(m2τ + nτ). Summing over the cells, we get

[formula]

For the initial value of D, we take D  =  m1 / 2 / n1 / 4 (which we get from a suitable value of r = Θ(D3)), and get the bound

[formula]

This choice of D is the one made in [\cite=GK2]. It is sufficiently large to control the situation in the cells, by the bound just obtained, but requires heavy-duty machinery from algebraic geometry to handle the situation on Z(f).

We now turn to Z(f), where we need to estimate I(P1,L1). Since all the incidences involving any point in P'1 and/or any line in L'1 have already been accounted for, we discard these sets, and remain with P1 and L1 only. We "forget" the preceding polynomial partitioning step, and start afresh, applying a new polynomial partitioning to P1 with a polynomial g of degree E, which will typically be much smaller than D, but still non-constant.

Before doing this, we note that the set of lines L1 has a special structure, because all its lines lie on the algebraic surface Z(f), which has degree D. We exploit this to derive the following lemmas. We emphasize, since this will be important later on in the analysis, that Lemmas [\ref=donpl]-[\ref=incone] hold for any choice of (r and) D.

We note that in general the partitioning polynomial f may be reducible, and apply some of the following arguments to each irreducible factor separately. Clearly, there are at most D such factors.

Let π be a plane which is not a component of Z(f). Then π contains at most D lines of L1.

Proof. Suppose to the contrary that π contains at least D + 1 lines of L. Every generic line λ in π intersects these lines in at least D + 1 distinct points, all belonging to Z(f). Hence f must vanish identically on λ, and it follows that [formula] on π, so π is a component of Z(f), contrary to assumption.  [formula] =0

The number of incidences between the points of P1 that lie in the planar components of Z(f) and the lines of L1, is O(m2 / 3n1 / 3s1 / 3  +  nD).

Proof. Clearly, f can have at most D linear factors, and thus Z(f) can contain at most D planar components. Enumerate them as [formula], where k  ≤  D. Let P̃1 denote the subset of the points of P1 that lie in these planar components. Assign each point of P̃1 to the first plane πi, in this order, that contains it, and assign each line of L1 to the first plane that fully contains it; some lines might not be assigned at all in this manner. For [formula], let P̃i denote the set of points assigned to πi, and let i denote the set of lines assigned to πi. Put mi  =  |P̃i| and ni  =  |i|. Then [formula] and [formula]; by assumption, we also have ni  ≤  s for each i. Then

[formula]

Summing over the k planes, we get, using Hölder's inequality,

[formula]

We also need to include incidences between points p∈P̃1 and lines [formula] not assigned to the same plane as p (or not assigned to any plane at all). Any such incidence [formula] can be charged (uniquely) to the intersection point of [formula] with the plane πi to which p has been assigned. The number of such intersections is O(nD), and the lemma follows.  [formula] =0

Each point p∈Z(f) is incident to at most D2 lines of L1, unless Z(f) has an irreducible component that is either a plane containing p or a cone with apex p.

Proof. Fix any line [formula] that passes through p, and write its parametric equation as [formula], where v is the direction of [formula]. Consider the Taylor expansion of f at p along [formula]

[formula]

where Fi(p;v) is the i-th order derivative of f at p in direction v; it is a homogeneous polynomial in v (p is considered fixed) of degree i, for [formula]. For each line [formula] that passes through p, f vanishes identically on [formula], so we have Fi(p;v) = 0 for each i. Assuming that p is incident to more than D2 lines of L1, we conclude that the homogeneous system

[formula]

has more than D2 (projectively distinct) roots. The classical Bézout's theorem, applied in the projective plane where the directions v are represented (e.g., see [\cite=CLO]), asserts that, since all these polynomials are of degree at most D, each pair of polynomials Fi(p;v), Fj(p;v) must have a common factor. The following slightly more involved inductive argument shows that in fact all these polynomials must have a common factor.

Let [formula] be n homogeneous polynomials of degree at most D. If [formula], then all the fi's have a nontrivial common factor.

Proof. The proof is via induction on n. The case n = 2 is precisely the classical Bézout's theorem in the projective plane. Assume that the inductive claim holds for n - 1 polynomials. By assumption, [formula], so the induction hypothesis implies that there is a polynomial g that divides fi, for [formula]; assume, as we may, that [formula]. If there are more than [formula] points in Z(g,fn), then again, by the classical Bézout's theorem in the projective plane, g and fn have a nontrivial common factor, which is then also a common factor of fi, for [formula], completing the proof. Otherwise, put i  =  fi / g, for [formula]. Notice that [formula], implying that each point of [formula] belongs either to [formula] or to [formula]. As [formula] and [formula], it follows that

[formula]

Hence, applying the induction hypothesis to the polynomials [formula] (all of degree at most [formula]), we conclude that they have a nontrivial common factor, contradicting the fact that g is the greatest common divisor of [formula].  [formula] =0

Continuing with the proof of Lemma [\ref=md2], there is an infinity of directions v that satisfy ([\ref=allf0]), so there is an infinity of lines passing through v and contained in Z(f). The union of these lines can be shown to be a two-dimensional algebraic variety, contained in Z(f), so Z(f) has an irreducible component that is either a plane through p or a cone with apex p, as claimed.  [formula] =0

The number of incidences between the points of P1 that lie in the (non-planar) conic components of Z(f), and the lines of L1, is O(m  +  nD).

Proof. Let σ be such an (irreducible) conic component of Z(f) and let p be its apex. We observe that σ cannot contain any line that is not incident to p, because such a line would span with p a plane contained in σ, contradicting the assumption that σ is irreducible and non-planar. It follows that the number of incidences between [formula] and Lσ, consisting of the lines of L1 contained in σ, is thus O(|Pσ| + |Lσ|) (p contributes |Lσ| incidences, and every other point at most one incidence). Applying a similar "first-come-first-serve" assignment of points and lines to the conic components of Z(f), as we did for the planar components in the proof of lemma [\ref=incpl], and adding the bound O(nD) on the number of incidences between points and lines not assigned to the same component, we obtain the bound asserted in the lemma.  [formula] =0

Remark. Note that in both Lemma [\ref=incpl] and Lemma [\ref=incone], we bound the number of incidences between points on planar or conic components of Z(f) and all the lines of L1.

Pruning.

To continue, we remove all the points of P1 that lie in some planar or conic component of Z(f), and all the lines of L1 that are fully contained in such components. With the choice of D = m1 / 2 / n1 / 4, we lose in the process

[formula]

incidences (recall that the term m is subsumed by the term m1 / 2n3 / 4 for m < n3 / 2). Continue, for simplicity of notation, to denote the sets of remaining points and lines as P1 and L1, respectively, and their sizes as m and n. Now each point is incident to at most D2 lines (a fact that we will not use for this value of D), and no plane contains more than D lines of L1, a crucial property for the next steps of the analysis. That is, this allows us to replace the input parameter s, bounding the maximum number of coplanar lines, by D; this is a key step that makes the induction work.

A new polynomial partitioning.

We now return to the promised step of constructing a new polynomial partitioning. We adapt the preceding notation, with a few modifications. We choose a degree E, typically much smaller than D, and construct a partitioning polynomial g of degree E for P1. With an appropriate value of r = Θ(E3), we obtain O(r) open cells, each containing at most m / r points of P1, and each line of L1 either crosses at most E + 1 cells, or is fully contained in Z(g).

Set [formula] and [formula]. Similarly, denote by L2 the set of lines of L1 that are fully contained in Z(g), and put [formula]. We first dispose of incidences involving the lines of L2. (That is, now we first focus on incidences within Z(g), and only then turn to look at the cells.) By Lemma [\ref=incpl] and Lemma [\ref=incone], the number of incidences involving points P2 that lie in some planar or conic component of Z(g), and all the lines of L2, is

[formula]

(For E  ≪  D, this might be a gross overestimation, but we do not care.) We remove these points from P2, and remove all the lines of L2 that are contained in such components; continue to denote the sets of remaining points and lines as P2 and L2. Now each point is incident to at most E2 lines of L2 (Lemma [\ref=md2]), so the number of remaining incidences involving points of P2 is O(mE2); for E suitably small, this bound will be subsumed by O(m1 / 2n3 / 4).

Unlike the case of a "large" D, namely, D = m1 / 2 / n1 / 4, here the difficult part is to treat incidences within the cells of the partition. Since E  ≪  D, we cannot use the naive bound O(n2 + m) within each cell, because that would make the overall bound too large. Therefore, to control the incidence bound within the cells, we proceed in the following inductive manner.

For each cell τ of [formula], put [formula], and let Lτ denote the set of the lines of L'2 that cross τ; put mτ  =  |Pτ|  ≤  m / r, and nτ  =  |Lτ|. Since every line [formula] (that is, of L'2) crosses at most 1 + E components of [formula], we have [formula].

It is important to note that at this point of the analysis the sizes of P1 and of L1 might be smaller than the original respective values m and n. In particular, we may no longer assume that |P1|  >  |L1|αj - 1, as we did assume for m and n. Nevertheless, in what follows m and n will denote the original values, which serve as upper bounds for the respective actual sizes of P1 and L1, and the induction will work correctly with these values; see below for details.

In order to apply the induction hypothesis within the cells of the partition, we want to assume that mτ  ≤  nταj - 1 for each τ. To ensure that, we require that the number of lines of L'2 that cross a cell be at most n / E2. Cells τ that are crossed by κn / E2 lines, for κ > 1, are treated as if they occur ⌈κ⌉ times, where each incarnation involves all the points of Pτ, and at most n / E2 lines of Lτ. The number of subproblems remains O(E3). Arguing similarly, we may also assume that mτ  ≤  m / E3 for each cell τ (by "duplicating" each cell into a constant number of subproblems, if needed).

We therefore require that [formula]. (Note that, as already commented above, these are only upper bounds on the actual sizes of these subsets, but this will have no real effect on the induction process.) That is, we require

[formula]

With these preparations, we apply the induction hypothesis within each cell τ, recalling that no plane contains more than D lines of L'2  ⊆  L1, and get

[formula]

Summing these bounds over the cells τ, that is, multiplying them by O(E3), we get, for a suitable absolute constant b,

[formula]

We now require that E = O(D). Then the last term satisfies nE  =  O(nD)  =  O(m1 / 2n3 / 4), and, as already remarked, the preceding term m is also subsumed by the first term. The second term, after substituting D = O(m1 / 2 / n1 / 4), becomes O(m5 / 6n1 / 4E1 / 3). Hence, with a slightly larger b, we have

[formula]

Adding up all the bounds, including those for the portions of P and L that were discarded during the first partitioning step, we obtain, for a suitable constant c,

[formula]

We choose E to ensure that the two E-dependent terms are dominated by the term m1 / 2n3 / 4. That is,

[formula]

Since [formula], and both sides are ≥  1, the latter condition is stricter, and we ignore the former. As already noted, we also require that E = O(D); specifically, we require that E  ≤  m1 / 2 / n1 / 4.

In conclusion, recalling ([\ref=Dlb]), the two constraints on the choice of E are

[formula]

and, for these constraints to be compatible, we require that

[formula]

and that

[formula]

which fortunately always holds, as is easil;y checked, since m  ≤  n3 / 2 and αj - 1  ≥  1 / 2. Note that we have not explicitly stated any concrete choice of E; any value satisfying ([\ref=econ]) will do. We put

[formula]

and conclude that if m  ≤  nαj then the bound asserted in the theorem holds, with Aj  =  bAj - 1  +  c and B = c. This completes the induction step. Note that the recurrence Aj  =  bAj - 1 + c solves to Aj  =  O(bj).

It remains to argue that the induction covers the entire range m  =  O(n3 / 2). Using the above recurrence for the αj's, with α0  =  1 / 2, it easily follows that

[formula]

for each j  ≥  0, showing that αj converges to 3 / 2, implying that the entire range m  =  O(n3 / 2) is covered by the induction.

To calibrate the dependence of the constant of proportionality on m and n, we note that, for nαj - 1  ≤  m  <  nαj, the constant is O(bj). We have

[formula]

This establishes the expression for Am,n given in the statement of the theorem.

Handling the middle ground m  ≈  n3 / 2.

Some care is needed when m approaches n3 / 2, because of the potentially unbounded growth of the constant Aj. To handle this situation, we simply fix a value j, in the manner detailed below, write m = knαj, solve k separate problems, each involving m / k = nαj points of P and all the n lines of L, and sum up the resulting incidence bounds. We then get

[formula]

for a suitable absolute constant a. Recalling that [formula], we have

[formula]

Hence the coefficient of the leading term in the above bound is bounded by an1 / (j + 2)bj, and we (asymptotically) minimize this expression by choosing

[formula]

With this choice all the other coefficients are also dominated by the leading coefficient, and we obtain

[formula]

In other words, the bound in ([\ref=st]) and ([\ref=amn]) holds for any m  ≤  n3 / 2, but, for m  ≥  nαj0 one should use instead the bound in ([\ref=eq:mn32]), which controls the exponential growth of the constants of proportionality within this range.

The case m  >  n3 / 2.

The analysis of this case is, in a sense, a mirror image of the preceding analysis, except for a new key lemma (Lemma [\ref=nd2]). For the sake of completeness, we repeat a sizeable portion of the analysis, providing many of the relevant (often differing) details.

We partition this range into a sequence of ranges m  ≥  nα0, [formula], where α0  =  2 and the sequence {αj}j  ≥  0 is decreasing and converges to 3 / 2. The induction is on the index j of the range nαj  ≤  m  <  nαj - 1, and establishes ([\ref=st]) for m in this range, with a coefficient Aj (written in ([\ref=st],[\ref=amn]) as Am,n) that increases with j.

The base range of the induction is m  ≥  n2, where the trivial general upper bound on point-line incidences in any dimension, dual to the one used in the previous case, yields I = O(n2 + m) = O(m), so ([\ref=st]) holds for a sufficiently large choice of the initial constant A0.

Assume then that ([\ref=st]) holds for all m  ≥  nαj - 1 for some j  ≥  1, and consider an instance of the problem with n3 / 2  ≤  m  <  nαj - 1 (again, the lower bound will increase, to nαj, to facilitate the induction step).

For a parameter r, to be specified later, apply the polynomial partition theorem to obtain an r-partitioning trivariate (real) polynomial f of degree D = O(r1 / 3). That is, every connected component of [formula] contains at most m / r points of P, and the number of components of [formula] is O(D3)  =  O(r).

Set [formula] and [formula]. Each line [formula] is either fully contained in Z(f) or intersects it in at most D points. Let L1 denote the subset of lines of L that are fully contained in Z(f) and put [formula]. As before, we have

[formula]

We have

[formula]

and we estimate I(P'1,L'1) as follows. For each cell τ of [formula], put [formula] (that is, [formula]), and let Lτ denote the set of the lines of L'1 that cross τ; put mτ  =  |Pτ|  ≤  m / r, and nτ  =  |Lτ|. As before, we have [formula], so the average number of lines that cross a cell is O(n / D2). Arguing as above, we may assume, by possibly increasing the number of cells by a constant factor, that each nτ is at most n / D2. Clearly, we have

[formula]

For each τ we use the trivial dual bound, mentioned above, I(Pτ,Lτ)  =  O(n2τ + mτ). Summing over the cells, we get

[formula]

For the initial value of D, we take D  =  n2 / m, noting that 1  ≤  D3  ≤  m because n3 / 2  ≤  m  ≤  n2, and get the bound

[formula]

where the latter bound follows since m  ≥  n3 / 2.

It remains to estimate I(P1,L1). Since all the incidences involving any point in P'1 and/or any line in L'1 have been accounted for, we discard these sets, and remain with P1 and L1 only. As before, we forget the preceding polynomial partitioning step, and start afresh, applying a new polynomial partitioning to P1 with a polynomial g of degree E, which will typically be much smaller than D, but still non-constant.

For this case we need the following lemma, which can be regarded, in some sense, as a dual (albeit somewhat more involved) version of Lemma [\ref=md2]. Unlike the rest of the analysis, the best way to prove this lemma is by switching to the complex projective setting. This is needed for one key step in the proof, where we need the property that the projection of a complex projective variety is a variety. Once this is done, we can switch back to the real affine case, and complete the proof.

Here is a very quick review of the transition to the complex projective setup. A real affine algebraic variety X, defined by a collection of real polynomials, can also be regarded as a complex projective variety. (Technically, one needs to take the projective closure of the complexification of X; details about these standard operations can be found, e.g., in Bochnak et al. [\cite=BCR] and in Cox et al. [\cite=CLO].) If f is an irreducible polynomial over [formula], it might still be reducible over [formula], but then it must have the form f = g, where g is an irreducible complex polynomial and [formula] is its complex conjugate. (Indeed, if h is any irreducible factor of f, then [formula] is also an irreducible factor of f, and therefore h is a real polynomial dividing f. As f is irreducible over [formula], the claim follows.)

In the following lemma, adapting a notation used in earlier works, we say that a point p∈P1 is 1-poor (resp., 2-rich) if it is incident to at most one line (resp., to at least two lines) of L1.

Recall also that a regulus is a doubly-ruled surface in [formula] or in [formula]. It is the union of all lines that pass through three fixed pairwise skew lines; it is a quadric, which is either a hyperbolic paraboloid or a one-sheeted hyperboloid.

Let f be an irreducible polynomial in [formula], such that Z(f) is not a complex plane nor a complex regulus, and let L1 be a finite set of lines fully contained in Z(f). Then, with the possible exception of at most two lines, each line [formula] is incident to at most O(D3) 2-rich points.

Proof. The strategy of the proof is to charge each incidence of [formula] with some 2-rich point p to an intersection of [formula] with another line of L1 that passes through p, and to argue that, in general, there can be only O(D3) such other lines. This in turn will be shown by arguing that the union of all the lines that are fully contained in Z(f) and pass through [formula] is a one-dimensional variety, of degree O(D3), from which the claim will follow. As we will show, this will indeed be the case except when [formula] is one of at most two "exceptional" lines on Z(f).

Fix a line [formula] as in the lemma, assume for simplicity that it passes through the origin, and write it as [formula]; since [formula] is a real line, v0 can be assumed to be real. Consider the union [formula] of all the lines that are fully contained in Z(f) and are incident to [formula]; that is, [formula] is the union of [formula] with the set of all points [formula] for which there exists [formula] such that the line connecting p to [formula] is fully contained in Z(f). In other words, for such a t and for each [formula], we have f((1 - s)p + stv0) = 0. Regarding the left-hand side as a polynomial in s, we can write it as [formula], for suitable (complex) polynomials Gi(p;t) in p and t, each of total degree at most D. In other words, p and t have to satisfy the system

[formula]

which defines an algebraic variety [formula] in [formula]. Note that, substituting s = 0, we have [formula], and that the limit points (tv0,t) (corresponding to points on [formula]) also satisfy this system, since in this case f((1 - s)tv0 + stv0) = f(tv0) = 0 for all s.

In other words, [formula] is the projection of [formula] into [formula], given by (p,t)  ↦  p. For each [formula] this system has only finitely many solutions in t, for otherwise the plane spanned by p and [formula] would be fully contained in Z(f), contrary to our assumption.

By the projective extension theorem (see, e.g., [\cite=CLO]), the projection of [formula] into [formula], in which t is discarded, is an algebraic variety [formula]. We observe that [formula] is contained in Z(f), and is therefore of dimension at most two.

Assume first that [formula] is two-dimensional. As f is irreducible over [formula], we must have [formula]. This implies that each point [formula] is incident to a (complex) line that is fully contained in Z(f) and is incident to [formula]. In particular, Z(f) is ruled by complex lines.

By assumption, Z(f) is neither a complex plane nor a complex regulus. We may also assume that Z(f) is not a complex cone, for then each line in L1 is incident to at most one 2-rich point (namely, the apex of Z(f)), making the assertion of the lemma trivial. It then follows that Z(f) is an irreducible singly ruled (complex) surface. As argued in Guth and Katz [\cite=GK2] (see also our companion paper [\cite=SS3dvar] for an independent analysis of this situation, which caters more explicitly to the complex setting too), Z(f) can contain at most two lines [formula] with this property.

Excluding these (at most) two exceptional lines [formula], we may thus assume that [formula] is (at most) a one-dimensional curve.

Clearly, by definition, each point [formula], except for [formula], defines a line λ, in the original 3-space, that connects p to tv0, and each point q∈λ satisfies [formula]. Hence, the line {(q,t)|q∈λ} is fully contained in [formula], and therefore the line λ is fully contained in [formula]. Since [formula] is one-dimensional, this in turn implies (see, e.g., [\cite=SS4d]) that [formula] is a finite union of (complex) lines, whose number is at most [formula]. This also implies that [formula] is the union of the same number of lines, and in particular [formula] is also one-dimensional, and the number of lines that it contains is at most [formula].

We claim that this latter degree is at most O(D3). This follows from a well-known result in algebra (see, e.g., Schmid [\cite=Schmid]), that asserts that, since [formula] is a one-dimensional curve in [formula], and is the common zero set of polynomials, each of degree O(D), its degree is O(D3).

This completes the proof of the lemma. (The passage from the complex projective setting back to the real affine one is trivial for this property.)  [formula] =0

Let f be a real or complex trivariate polynomial of degree D, such that (the complexification of) Z(f) does not contain any complex plane nor any complex regulus. Let L1 be a set of n lines fully contained in Z(f), and let P1 be a set of m points contained in Z(f). Then I(P1,L1)  =  O(m + nD3).

Proof. Write [formula] for its decomposition into irreducible factors, for s  ≤  D. We apply Lemma [\ref=nd2] to each complex factor fi of the f. By the observation preceding Lemma [\ref=nd2],some of these factors might be complex (non-real) polynomials, even when f is real. That is, regardless of whether the original f is real or not, we carry out the analysis in the complex projective space [formula], and regard Z(fi) as a variety in that space.

Note also that, by focussing on the single irreducible component Z(fi) of Z(f), we consider only points and lines that are fully contained in Z(fi). We thus shrink P1 and L1 accordingly, and note that the notions of being 2-rich or 1-poor are now redefined with respect to the reduced sets. All of this will be rectified at the end of the proof.

Assign each line [formula] to the first component Z(fi), in the above order, that fully contains [formula], and assign each point p∈P1 to the first component that contains it. If a point p and a line [formula] are incident, then either they are both assigned to the same component Z(fi), or p is assigned to some component Z(fi) and [formula], which is assigned to a later component, is not contained in Z(fi). Each incidence of the latter kind can be charged to a crossing between [formula] and Z(fi), and the total number of these crossings is O(nD). It therefore suffices to consider incidences between points and lines assigned to the same component. Moreover, if a point p is 2-rich with respect to the entire collection L1 but is 1-poor with respect to the lines assigned to its component, then all of its incidences except one are accounted by the preceding term O(nD), which thus takes care also of the single incidence within Z(fi).

By Lemma [\ref=nd2], for each fi, excluding at most two exceptional lines, the number of incidences between a line assigned to (and contained in) Z(fi) and the points assigned to Z(fi) that are still 2-rich within Z(fi), is [formula]. Summing over all relevant lines, we get the bound O(nD3).

Finally, each irreducible component Z(fi) can contain at most two exceptional lines, for a total of at most 2D such lines. The number of 2-rich points on each such line [formula] is at most n, since each such point is incident to another line, so the total number of corresponding incidences is at most O(nD), which is subsumed by the preceding bound O(nD3). The number of incidences with 1-poor points is, trivially, at most m. This completes the proof of the corollary.  [formula] =0

Pruning.

In the preceding lemma and corollary, we have excluded planar and reguli components of Z(f). Arguing as in the case of small m, the number of incidences involving points that lie on planar components of Z(f) is O(m2 / 3n1 / 3s1 / 3 + m) (see Lemma [\ref=incpl]), and the number of incidences involving points that lie on conic components of Z(f) is O(m + nD)  =  O(m) (see Lemma [\ref=incone]). A similar bound holds for points on the reguli components. Specifically, we assign each point and line to a regulus that contain them, if one exists, in the same first-come first-serve manner used above. Any point p can be incident to at most two lines that are fully contained in the regulus to which it is assigned, and any other incidence of p with a line [formula] can be uniquely charged to the intersection of [formula] with that regulus, for a total (over all lines and reguli) of O(nD) incidences.

We remove all points that lie in any such component and all lines that are fully contained in any such component. With the choice of D = n2 / m, we lose in the process

[formula]

incidences (recall that nD  ≤  m for m  ≥  n3 / 2). For the remainder sets, which we continue to denote as P1 and L1, respectively, no plane contains more than O(D) lines of L1, as argued in Lemma [\ref=donpl].

A new polynomial partitioning.

We adapt the notation used in the preceding case, with a few modifications. We choose a degree E, typically much smaller than D, and construct a partitioning polynomial g of degree E for P1. With an appropriate value of r = Θ(E3), we obtain O(r) cells, each containing at most m / r points of P1, and each line of L1 either crosses at most E + 1 cells, or is fully contained in Z(g).

Set [formula] and [formula]. Similarly, denote by L2 the set of lines of L1 that are fully contained in Z(g), and put [formula]. We first dispose of incidences involving the lines of L2. By Lemma [\ref=incpl] and the preceding arguments, the number of incidences involving points of P2 that lie in some planar, conic, or regulus component of Z(g), and all the lines of L2, is

[formula]

We remove these points from P2, and remove all the lines of L2 that are contained in such components. Continue to denote the sets of remaining points and lines as P2 and L2. By Corollary [\ref=nd3], the number of incidences between P2 and L2 is O(m + nE3).

To complete the estimation, we need to bound the number of incidences in the cells of the partition, which we do inductively, as before. Specifically, for each cell τ of [formula], put [formula], and let Lτ denote the set of the lines of L'2 that cross τ; put mτ  =  |Pτ|  ≤  m / r, and nτ  =  |Lτ|. Since every line [formula] crosses at most 1 + E components of [formula], we have [formula], and, arguing as above, we may assume that each nτ is at most n / E2, and each mτ is at most m / E3. To apply the induction hypothesis in each cell, we therefore require that [formula]. (As before, the actual sizes of P1 and L1 might be smaller than the respective original values m and n. We use here the original values, and note, similar to the preceding case, that the fact that these are only upper bounds on the actual sizes is harmless for the induction process.) That is, we require

[formula]

With these preparations, we apply the induction hypothesis within each cell τ, recalling that no plane contains more than D lines of L'2  ⊆  L1, and get

[formula]

Summing these bounds over the cells τ, that is, multiplying them by O(E3), we get, for a suitable absolute constant b,

[formula]

Requiring that E  ≤  m / n, the last term satisfies nE  ≤  m, and the first term is also at most O(m) (because m  ≥  n3 / 2). The second term, after substituting D = O(n2 / m), becomes O(m1 / 3nE1 / 3). Hence, with a slightly larger b, we have

[formula]

Collecting all partial bounds obtained so far, we obtain

[formula]

for a suitable constant c. We choose E to ensure that the two E-dependent terms are dominated by m. That is,

[formula]

In addition, we also require that E  ≤  m / n, but, as is easily seen, both of the above constraints imply that E  ≤  m / n, so we get this latter constraint for free, and ignore it in what follows.

As is easily checked, the second constraint E  ≤  m1 / 3 / n1 / 3 is stricter than the first constraint E  ≤  m2 / n3 for m  ≥  n8 / 5, and the situation is reversed when m  ≤  n8 / 5. So in our inductive descent of m, we first consider the second constraint, and then switch to the first constraint.

Hence, in the first part of this analysis, the two constraints on the choice of E are

[formula]

and, for these constraints to be compatible, we require that

[formula]

We start the process with α0 = 2, and take [formula]. As this is still larger than 8 / 5, we perform two additional rounds of the induction, using the same constraints, leading to the exponents

[formula]

To play it safe, we reset α3: = 8 / 5, and establish the induction step for m  ≥  n8 / 5. We can then proceed to the second part, where the two constraints on the choice of E are

[formula]

and, for these constraints to be compatible, we require that

[formula]

We define, for j  ≥  4, [formula]. Substituting α3 = 8 / 5 we get α4 = 11 / 7, and in general a simple calculation shows that

[formula]

for j  ≥  3. This sequence does indeed converge to 3 / 2 as j  →    ∞  , implying that the entire range m  =  Ω(n3 / 2) is covered by the induction.

In both parts, we conclude that if m  ≥  nαj then the bound asserted in the theorem holds with Aj  =  bAj - 1 + c,, and B = c. This completes the induction step.

Finally, we calibrate the dependence of the constant of proportionality on m and n, by noting that, for nαj  ≤  m  <  nαj - 1, the constant is O(bj). We have

[formula]

(Technically, this only handles the range j  ≥  3, but, for an asymptotic bound, we can extend it to j = 1,2 too.) This establishes the explicit expression for Am,n for this range, as stated in the theorem, and completes its proof.  [formula] =0

Again, as in the case of a small m, we need to be careful when m approaches n3 / 2. Here we can fix a j, assume that n3 / 2  ≤  m  <  nαj, and set k: = m / nα'j, where α'j  =  3 / 2  -  2 / (j + 2) is the j-th index in the hierarchy for m  ≤  n3 / 2. That is,

[formula]

As before, we now solve k separate subproblems, each with m / k points of P and all the lines of L, and sum up the resulting incidence bounds. The analysis is similar to the one used above, and we omit its details. It yields almost the same bound as in ([\ref=eq:mn32]), where the slightly larger upper bound on k leads to the slightly larger bound

[formula]

with a slightly different absolute constant b.

Discussion

In this paper we derived an asymptotically tight bound for the number of incidences between a set P of points and a set L of lines in [formula]. This bound has already been established by Guth and Katz [\cite=GK2], where the main tool was the use of partitioning polynomials. As already mentioned, the main novelty here is to use two separate partitioning polynomials of different degrees; the one with the higher degree is used as a pruning mechanism, after which the maximum number of coplanar lines of L can be better controlled (by the degree D of the polynomial), which is a key ingredient in making the inductive argument work.

The second main tool of Guth and Katz was the Cayley-Salmon theorem. This theorem says that a surface in [formula] of degree D cannot contain more than 11D2 - 24D lines, unless it is ruled by lines. This is an "ancient" theorem, from the 19th century, combining algebraic and differential geometry, and its re-emergenece in recent years has kindled the interest of the combinatorial geometry community in classical (and modern) algebraic geometry. New proofs of the theorem were obtained (see, e.g., Terry Tao's blog [\cite=tt:blog]), and generalizations to higher dimensions have also been developed (see Landsberg [\cite=Land]). However, the theorem only holds over the complex field, and using it over the reals requires some care.

There is also an alternative way to bound the number of point-line incidences using flat and singular points. However, as already remarked, these two, as well as the Cayley-Salmon machinery, are non-trivial constructs, especially in higher dimensions, and their generalization to other problems in combinatorial geometry (even incidence problems with curves other than lines or incidences with lines in higher dimensions) seem quite difficult (and are mostly open). It is therefore of considerable interest to develop alternative, more elementary interfaces between algebraic and combinatorial geometry, which is a primary goal of the present paper (as well as of Guth's recent work [\cite=Gu14]).

In this regard, one could perhaps view Lemma [\ref=md2] and Corollary [\ref=nd3] as certain weaker analogs of the Cayley-Salmon theorem, which are nevertheless easier to derive, without having to use differential geometry. Some of the tools in Guth's paper [\cite=Gu14] might also be interpreted as such weaker variants of the Cayley-Salmon theory. It would be interesting to see suitable extensions of these tools to higher dimensions.

Besides the intrinsic interest in simplifying the Guth-Katz analysis, the present work has been motivated by our study of incidences between points and lines in four dimensions. This has begun in a year-old companion paper [\cite=surf-socg], where we have used the the polynomial partitioning method, with a polynomial of constant degree. This, similarly to Guth's work in three dimensions [\cite=Gu14], has resulted in a slightly weaker bound and considerably stricter assumptions concerning the input set of lines. In a more involved follow-up study [\cite=SS4d], we have managed to improve the bound, and to get rid of the restrictive assumptions, using two partitioning steps, with polynomials of non-constant degrees, as in the present paper. However, the analysis in [\cite=SS4d] is not as simple as in the present paper, because, even though there are generalizations of the Cayley-Salmon theorem to higher dimensions (due to Landsberg, as mentioned above), it turns out that a thorough investigation of the variety of lines fully contained in a given hypersurface of non-constant degree, is a fairly intricate and challenging problem, raising many deep questions in algebraic geometry, some of which are still unresolved.

One potential application of the techniques used in this paper, mainly the interplay between partitioning polynomials of different degrees, is to the problem, recently studied by Sharir, Sheffer and Zahl [\cite=SSZ], of bounding the number of incidences between points and circles in [formula]. That paper uses a partitioning polynomial of constant degree, and, as a result, the term that caters to incidences within lower-dimensional spaces (such as our term m2 / 3n1 / 3s1 / 3) does not go well through the induction mechanism, and consequently the bound derived in [\cite=SSZ] was weaker. We believe that our technique can improve the bound of [\cite=SSZ] in terms of this "lower-dimensional" term.

A substantial part of the present paper (half of the proof of the theorem) was devoted to the treatment of the case m > n3 / 2. However, under the appropriate assumptions, the number of points incident to at least two lines was shown by Guth and Katz [\cite=GK2] to be bounded by O(n3 / 2). A recent note by Kollár [\cite=Kol] gives a simplified proof, including an explicit multiplicative constant. In his work, Kollár does not use partitioning polynomials, but employs more advanced algebraic geometric tools, like the arithmetic genus of a curve, which serves as an upper bound for the number of singular points. If we accept (pedagogically) the upper bound O(n3 / 2) for the number of 2-rich points as a "black box", the regime in which m > n3 / 2 becomes irrelevant, and can be discarded from the analysis, thus greatly simplifying the paper.

A challenging problem is thus to find an elementary proof that the number of points incident to at least two lines is O(n3 / 2) (e.g., without the use of the Cayley-Salmon theorem or the tools used by Kollár). Another challenging (and probably harder) problem is to improve the bound of Guth and Katz when the bound s on the maximum number of mutually coplanar lines is ≪  n1 / 2: In their original derivation, Guth and Katz [\cite=GK2] consider mainly the case s = n1 / 2, and the lower bound constrcution in [\cite=GK2] also has s = n1 / 2. Another natural further research direction is to find further applications of partitioning polynomials of intermediate degrees.