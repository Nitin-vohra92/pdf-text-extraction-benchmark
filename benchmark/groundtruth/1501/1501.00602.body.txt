Lemma Corollary Proposition Conjecture Remark Claim Definition Notation

mm

An analogue of Vosper's Theorem for Extension Fields

Introduction

Inverse problems in additive theory aim to provide structural results of sets in an additive group which have a small subset sum. Motivated by a problem on difference sets, Hou, Cheng and Xiang [\cite=hou2002] obtained a linear analogue of one of the central results in the area, the theorem of Kneser [\cite=knesrcomp], in which cardinalities of sets in an abelian group are substituted by dimensions of subspaces over a field. To be specific, Let F be a field and let L be an extension field of F. If S and T are F-subvector spaces of L, we shall denote by ST the F-linear span of the set of products st, s∈S, t∈T. The linear analogue of Kneser's theorem can be stated as follows.

Let F  ⊂  L be fields and let S,T be F-subvectorspaces of L of finite dimension. Suppose that every algebraic element in L is separable over F. Then

[formula]

where H(ST) = {x∈L:xST = ST} denotes the stabilizer of ST in L.

One of the remarkable features of the above theorem is that the original theorem of Kneser can be obtained as a corollary. It can therefore be viewed not only as a transposition of an additive result, but as a generalization. This gives extra motivation for studying the translation of additive theory to its linear counterpart, since we may obtain insight on the original additive results and methods.

Eliahou and Lecouvey [\cite=eliahou2009] obtained similar linear analogues of classical additive theorems including theorems of Olson [\cite=olson] and Kemperman [\cite=kemperman] in nonabelian groups. Lecouvey [\cite=lecouvey2011] pursued this direction by obtaining, among other extensions, linear versions of the Plünecke-Ruzsa [\cite=ruzsa] inequalities.

Going back to the statement of Theorem [\ref=thm:kneser], since the stabilizer H(X) of a finite dimensional subspace is a subfield of L of finite dimension, if L / F is an extension with no proper finite intermediate extension, then either H(X) = F or, if  dimF(L) is finite, H(X) = L. Hence one obtains a linear analogue of the Cauchy-Davenport inequality, which states that in an extension without a proper finite intermediate extension (in particular in finite extensions of prime degree), the dimension of the product of two subspaces S and T is either the whole extension, or has dimension at least  dim(S) +  dim(T) - 1. Strictly speaking, if we derive this result from Theorem [\ref=thm:kneser] we need to suppose the extension to be separable. However the linear analogue of the Cauchy-Davenport Theorem is obtained in full generality, without the separability hypothesis by Eliahou and Lecouvey (see [\cite=eliahou2009] Theorem 6.2). Let us state it formally:

Let L / F be an extension with no proper finite intermediate extension. For every pair of subspaces S,T  ⊂  L of finite dimension,

[formula]

One of the first inverse statements of additive theory is the theorem of Vosper [\cite=vosper] which states that, in a group of prime order, a pair of sets attaining equality in the Cauchy-Davenport inequality are, except for some degenerate cases, arithmetic progressions. In the present paper, our main result is a transposition of Vosper's theorem to the linear setting which reads:

Let F be a finite field and let L be an extension of prime degree p of F. Let S,T be subspaces of L such that 2  ≤   dim(S), dim(T) and  dim(ST)  ≤  p - 2. If

[formula]

then there are bases of S and T of the form [formula] and [formula] for some g,g',a∈L.

We shall see that the conclusion of Theorem [\ref=thm:main] continues to hold if L is replaced by an infinite-dimensional extension of the finite field F containing no algebraic extension of F besides F. This last result will be seen to result from Theorem [\ref=thm:main] through a valuation argument, and can also be derived by the same methodology that leads to Theorem [\ref=thm:main].

The question naturally arises whether the conclusion of Theorem [\ref=thm:main] holds for any extension L / F with no finite intermediate extensions, not just when F is a finite field. The answer turns out to be negative, and we shall give a counter-example for some infinite extension L / F, and also for a finite extension. We shall obtain some partial results in the case of arbitrary fields F, but the complete picture remains very much unclear. In particular, crucial to our method in the finite extension case is the hypothesis that the extension is separable.

The proof of Theorem [\ref=thm:main] will import ideas from additive combinatorics, and also use results on quadratic forms and what has become known as the linear programming method in the theory of error-correcting codes. Since the route to Theorem [\ref=thm:main] is fairly long and devious we give an overview.

Overview of the proof of Theorem [\ref=thm:main].

Given the hypothesis of Theorem [\ref=thm:main], we shall consider subspaces A of L of minimum dimension (but at least equal to 2) such that

[formula]

We shall first remark that if we can prove that such a subspace has dimension exactly 2, and has a basis of the form 1,a, then the conclusion of Theorem [\ref=thm:main] follows fairly straightforwardly. From then on we work towards showing that such a subspace A must have dimension 2.

With this objective, we shall transpose to the linear setting the so-called isoperimetric method in additive combinatorics, a method largely due to the late Hamidoune [\cite=hamidoune], which has proved to be a particularly useful tool in dealing with additive problems. We shall show that the subspaces A of [\eqref=eq:SA], that we call atoms by analogy with the classical additive setting, must satisfy intersection properties. In particular we shall show that an atom A must satisfy the following:

[formula]

We call a subspace with this property a Sidon space by analogy with Sidon sets of integers which are sets such that, for any x,y,z,t in the set,

[formula]

Furthermore, we shall arrive at the conclusion that atoms must have a product of small dimension, namely:

[formula]

It remains to prove that this last property is incompatible with the Sidon property for any subspace A of dimension n greater than 2. To obtain this we shall need more tools: we shall consider the space of quadratic forms over the base field F in the variables [formula] together with the natural mapping Φ into A2 deduced from the correspondence:

[formula]

where [formula] is a basis of A. We make the observation that any non-zero quadratic form that is of the form [formula] where [formula] are F-linear expressions in [formula] can not map to zero by Φ: this is a reformulation of the Sidon property. This motivates introducing the notion of weight of a quadratic form Q.

We shall say that the zero quadratic form has weight 0, that Q has weight 1 if it is the product of two non-zero linear forms, and inductively for t > 1 that it has weight t if it is the sum of t quadratic forms of weight 1 and is not of weight < t. This slightly non-standard notion is related to the quadratic form's rank, but behaves somewhat differently. The Sidon property of A means therefore that the kernel of the mapping Φ is a subspace C of the space of quadratic forms with minimum non-zero weight at least 3. On the other hand property [\eqref=eq:dim(A^2)] implies that C must be a space of large dimension. The rest of the proof of Theorem [\ref=thm:main] consists in showing that such a large set C of quadratic forms of weight at least 3 can not exist.

Specifically, we shall show that if F is the finite field with q elements and C is a set of quadratic forms over Fn, any two of which differ by a quadratic form of weight at least 3, then the cardinality |C| of C must satisfy:

[formula]

This is the minimal result that we need to finish the proof of Theorem [\ref=thm:main]. To the best of our knowledge, packing problems in the space of quadratic forms endowed with the aforementioned weight distance have not been considered before, making [\eqref=eq:(n-1)(n-2)/2] of possibly independent interest. Loosely connected packing problems have been studied before for the related rank distance, in the space of bilinear forms [\cite=Del1], in the space of alternating bilinear forms [\cite=Del2], and more recently in the space of symmetric bilinear forms [\cite=Sch1] [\cite=Sch2]. The above papers have all applied what has become known as the Delsarte linear programming method, a powerful approach for deriving upper bounds on the size of codes (packings) initiated in [\cite=Del] (see also [\cite=DL]) in the framework of association schemes. The results obtained in [\cite=Del1] [\cite=Del2] [\cite=Sch1] [\cite=Sch2] can not be made to yield [\eqref=eq:(n-1)(n-2)/2] directly however, and we have needed to work on the problem from scratch, also applying the Delsarte methodology.

The paper is organized as follows. Section [\ref=sec:critical] sets up matters by reducing Theorem [\ref=thm:main] to the existence of critical spaces of dimension 2. Section [\ref=sec:con] develops an extension field analogue of Hamidoune's isoperimetric method: in particular the intersection theorem for atoms (Theorem [\ref=thm:intersection]) is proved. Section [\ref=sec:2atom] derives further properties of atoms and proves Theorem [\ref=thm:twin] which can be seen as a weak version of Theorem [\ref=thm:main] in the sense that it is valid only for extensions of degree n such that n - 2 is prime. It places no restriction on the base field F however, and requires only the extension to be finite separable, with no intermediate extensions. Section [\ref=sec:sidon] introduces Sidon spaces, makes the point that under the hypothesis of Theorem [\ref=thm:main] atoms must be Sidon spaces, and connects them to packings in spaces of quadratic forms. Theorem [\ref=thm:main] is reduced to a lower bound (Theorem [\ref=thm:sidon]) on the dimension of the square of Sidon space. Section [\ref=sec:codes] develops the study of packings of quadratic forms necessary to prove Theorem [\ref=thm:sidon] and hence conclude a proof of Theorem [\ref=thm:main]. Section [\ref=sec:transcendental] is devoted to extensions of Theorem [\ref=thm:main] to the case of infinite-dimensional extensions. Finally Section [\ref=sec:comments] concludes with some comments.

Deriving Theorem [\ref=thm:main] from the existence of critical spaces of dimension 2

In this section we reduce Theorem [\ref=thm:main] to showing the existence of a subspace A of dimension 2 satisfying [\eqref=eq:SA]. Note that if such a space exists, then without loss of generality we may suppose that it contains the field unit element 1, by multiplying A by an appropriate element of L if necessary.

Let L be an extension of F with no proper finite intermediate extension. Suppose that S is an F-subspace of dimension s of L, and that A is a subspace of dimension 2 generated by {1,a} such that  dim(AS) =  dim(S) + 1  ≤   dim(L) - 1. Then there exists g∈S such that [formula] is a basis for S.

We have [formula] so

[formula]

We next show the result by induction on s  ≥  2.

If  dim(S) = 2, let g' generate [formula], i.e. [formula]. Then, g' = ag with g∈S. Moreover g∉aS otherwise g = λg' = λag for some λ∈F* which would mean a∈F, so {g,ag} is a basis of S.

In the general case  dim(S) = s, let [formula]. Then, from [\eqref=eq:k-1],  dim(S') = s - 1; moreover S' also satisfies  dim(AS') =  dim(S') + 1. Indeed, we have where Theorem [\ref=thm:Cauchy] gives the first inequality while the second follows from AS' = S' + aS'  ⊂  aS. By induction, S' has a basis of the form [formula]. Since g'∈aS, for some g∈S, g' = ga. Moreover g∉S' otherwise [formula] for some λi∈F but this would mean that deg F(a)  ≤  s - 1 <  dim(L). So, [formula] is a basis of S.

Let L / F be an extension with no proper finite intermediate extension. Let S,T be subspaces of L with  dim(S), dim(T)  ≥  2. Suppose that there exists a basis of S of the form [formula] for a,g∈L and that we have

[formula]

Then there is a basis of T of the form [formula] for some g'∈L.

Without loss of generality we will assume that S has a basis of the form [formula] and we will proceed by induction on s =  dim(S)  ≥  2. The case s = 2 is treated in Lemma [\ref=lem:prog].

Let S' be the subspace generated by [formula]: because ST = T + S'T, we have thus

[formula]

Since

[formula]

the leftmost inequality coming from Theorem [\ref=thm:Cauchy], we have that [\eqref=eq:prime] leaves two possibilities: either [formula] or [formula]. Let us rule out the latter: indeed, it would mean that ST = S'T, therefore, setting [formula] we get W  ⊂  ST = S'T = aW. But W and aW have the same dimension, so we would have W = aW, which is impossible, given that 0 <  dim(W) <  dim(L) and F(a) is either infinite-dimensional or equal to L.

So  dim(S'T) =  dim(S') +  dim(T) - 1 and  dim(S') = s - 1 so by induction T has a basis of the required form.

Connectivity in Field Extensions

We now transpose to the context of field extensions the basic notions of the isoperimetric method as introduced in [\cite=HALG] and developed in a number of later papers, see [\cite=YOH13]. We borrow the terminology of [\cite=HACTA] [\cite=y2008] and other papers with some adaptation to the linear case.

Recall that in a finite separable field extension the symmetric bilinear form

[formula]

where TrL / F() denotes the trace map, is non-degenerate. Crucial to the developments below will be the property:

[formula]

We make the remark that the statements of this section rely mostly on [\eqref=eq:frobenius] and as such could be stated in the general context of algebras over F in which a non-degenerate symmetric bilinear form satisfying [\eqref=eq:frobenius] exists, namely symmetric Frobenius algebras. Since our applications will only concern extension fields, we do not pursue this generalization.

The next proposition is valid for any field extension L / F. Let S be a subspace of L of finite dimension.

For every subvectorspace X of L with non-zero, finite dimension we denote by

[formula]

the increment of dimension of X when multiplied by S. We have the submodularity relation:

Let X,Y be finite-dimensional subspaces of L. We have

[formula]

We have (X + Y)S  ⊂  XS + YS and [formula]. Therefore,

[formula]

Let [formula] be the set of subvectorspaces X of L such that

[formula]

If the set [formula] is non-empty, we define the k-th connectivity of S by

[formula]

If the set [formula] is empty we set κk(S) =  -   ∞  . When κk(S)  ≠    -    ∞  , we define a k-fragment of S to be a subspace M of [formula] with ∂SM = κk(S). A k-fragment with minimum dimension is called a k-atom.

Suppose henceforth that the extension L / F is either infinite or finite separable in which case let [formula] denote the trace inner product [\eqref=eq:frobenius]. For a subspace X < L we denote by

[formula]

The following Lemma is crucial to the development of the isoperimetric method.

Let L / F be a finite separable extension. If X is a k-fragment of S, then [formula] is also a k-fragment of S.

Since

[formula]

for every x∈X,s∈S and x*∈X*, we have [formula], so that

[formula]

It follows that

[formula]

Finally, since X satisfies  dim(XS)  ≤   dim(L) - k we have that  dim(X*)  ≥  k. Together with [\eqref=eq:n-k] and [\eqref=eq:fragment] this implies that X* is a k-fragment of S.

Let L / F be a finite separable extension. Let S  ⊂  L be a subvectorspace. If A is a k-atom of S then

[formula]

Let [formula]. Since  dim(AS) =  dim(A) + ∂S(A) =  dim(A) + κk(S) by definition of ∂S(A) and κk(S), we have that  dim(L)  =   dim(AS)  +   dim(A*)  =   dim(A) + κk(S)  +   dim(A*). Furthermore, by definition of an atom we have  dim(A)  ≤   dim(A*) since A* is a fragment by Lemma [\ref=lem:F*]. Hence the result.

The cornerstone of the isoperimetric method is the following property.

Let the extension L / F be either infinite or finite separable. Let A,B be two distinct k-atoms of S. Then,

[formula]

By the submodularity relation one has

[formula]

Suppose that [formula]. By the definition of a k-atom, we have [formula]. It follows that ∂S(A + B) < κk(S). Hence,

[formula]

from which we get

[formula]

trivially if L is infinite dimensional and by Corollary [\ref=cor:A<A*] if L is a finite separable extension of F. By the definition of κk(S), this contradicts ∂S(A + B) < κk(S).

Let A be a k-atom of S. We observe that, from the definitions of ∂S and of atoms, for each [formula], αA is also a k-atom of S. Therefore there is a k-atom of S containing 1. By the Intersection Theorem, when k = 1 the atom containing 1 is unique. The following Theorem is the linear analogue of a theorem of Mann [\cite=mann]. It is not as powerful as Kneser's theorem but it is already enough to recover the linear Cauchy-Davenport Theorem [\ref=thm:Cauchy].

Let A be the 1-atom of S containing 1. Then A is a subfield of L. Moreover, if

[formula]

for some subspace T, then A is a subfield of L properly containing F.

For each [formula] we have [formula]. Hence, by the Intersection Theorem aA = A. Therefore a- 1∈A and A is a subfield of L. Moreover, if  dim(ST) <  dim(S) +  dim(T) - 1 for some subspace T then

[formula]

so that we can not have  dim(A) = 1.

One consequence of Theorem [\ref=thm:atom] is the linear Cauchy-Davenport inequality of Theorem [\ref=thm:Cauchy]

[formula]

when L has no proper finite-dimensional subfields containing F and L / F is either infinite or finite separable.

The 2-atom of a Vosper space

We now investigate the properties of 2-atoms of a subspace S, with in particular the goal of showing that under the conditions of Theorem [\ref=thm:main] they must be of dimension 2. Note that under the conditions of Theorem [\ref=thm:main], 2-atoms of S must exist.

Let L / F be either an infinite dimensional extension with no intermediate subfields of finite dimension, or a finite separable extension that has no intermediate subfields. In the latter case, if F is a finite field this means that L / K has prime degree, hence the hypothesis of Theorem [\ref=thm:main], but the results of this section hold in the more general case.

Let S be an F-vector space of finite dimension in L such that

[formula]

Let A be a 2-atom of S. We shall be interested in the sequence of subspaces Ai, i  ≥  1, where Ai is defined inductively by Ai = Ai - 1. In this section we shall show that A is also a 2-atom of A, that Ai, i  ≥  1 is a 2-fragment of A as long as  dim(AiS) + 2  ≤   dim(L), and that in the case when  dim(L) is finite [formula], where n =  dim(A).

If A is a 2-atom of S then A is a 2-atom of A.

The statement is clear if  dim(A) = 2. Suppose that  dim(A) = n  ≥  3. Note that S is a witness that κ2(A) =  dim(A) - 1. Let B be a 2-atom of A. Without loss of generality we assume [formula].

Let [formula] and [formula].

dim(A) =  dim(B) and AB = A + bA = B + aB.

By the Intersection Theorem (Theorem [\ref=thm:intersection]),

[formula]

which implies  dim(B)  ≥   dim(A). Analogously,

[formula]

so that  dim(A) =  dim(B) = n. Moreover

[formula]

dim(A2B) <  dim(L).

We have

[formula]

Hence,

[formula]

where in the second inequality we use that [formula]. On the other hand, by Corollary [\ref=cor:A<A*],

[formula]

Claim [\ref=claim:<dimL] allows us to apply the linear Cauchy-Davenport inequality [\eqref=eq:cd] to the spaces A2 and B, and together with [\eqref=eq:a2b] we obtain

[formula]

which implies

[formula]

This shows that A is its own 2-atom.

Let A be a 2-atom of S and t  ≥  2 an integer. We have

[formula]

Let [formula]. By Lemma [\ref=lem:2atom] A is a 2-atom of A and  dim(A2) =  dim(A + aA) = 2 dim(A) - 1, which establishes the result for t = 2. In particular, A2 = A + aA, so that we have

[formula]

Now, notice that [formula] contains aAt - 2, therefore

[formula]

Suppose that At  ≠  L. By induction on t we have that  dim(At - 1)  -   dim(At - 2)  =   dim(A) - 1 therefore

[formula]

Now since At  ≠  L, the linear Cauchy-Davenport inequality [\eqref=eq:cd] gives

[formula]

which yields  dim(At) =  dim(At - 1) +  dim(A) - 1.

Let A be a 2-atom of S with  dim(A) = n > 2. Then if  dim(L) is finite we have:

[formula]

Let t be the largest positive integer such that  dim(At) <  dim(L). We recall that  dim(A2)  ≤   dim(L) - 2, so that t  ≥  2. Let X = At - 1 and let [formula]. Since we have supposed  dim(At) <  dim(L), we have  dim(X*) > 0. Lemma [\ref=lem:ak] implies that either  dim(X*) = 1 or X = At - 1 is a 2-fragment of A. But if X is a 2-fragment of A then Lemma [\ref=lem:F*] applied to X and A implies that X* is also a 2-fragment of A. But then the maximality of t such that  dim(At) <  dim(L) and Lemma [\ref=lem:ak] imply that  dim(X*)  ≤   dim(A) - 1, which is in contradiction with A being a 2-atom of A (Lemma [\ref=lem:2atom]). Therefore  dim(At) =  dim(L) - 1. To conclude, observe that Lemma [\ref=lem:ak] gives  dim(At)  =   dim(A) + (t - 1)( dim(A) - 1), hence

[formula]

As an immediate consequence of Lemma [\ref=lem:dim(A)even], we have that if  dim(L) - 2 = m - 2 is prime, then atoms can only have dimension 2 and by Lemmas [\ref=lem:prog] and [\ref=lem:T] the linear version of Vosper's theorem holds for any separable extension of degree m over any field, given that there is no intermediate subfield. This is the case in particular if p and p - 2 are a pair of twin primes and if L / F is separable of degree p. Specifically:

Let L / F be a finite separable extension with no intermediate proper extension. Suppose furthermore that - 2 is prime. Let S,T be subspaces of L such that 2  ≤   dim(S), dim(T) and  dim(ST)  ≤   dim(L) - 2. If

[formula]

then there are bases of S and of T respectively of the form

[formula]

for some g,g',a∈L.

Without the condition that  dim(L) - 2 is prime some possible dimensions other than 2 escape Lemma [\ref=lem:dim(A)even]. To remove them we introduce more tools.

Sidon spaces and quadratic forms

The Intersection Theorem [\ref=thm:intersection] gives a key property of 2-atoms that in infinite or finite separable extensions L / F without proper finite sub-extensions, translates into:

[formula]

We note that [\eqref=eq:sidon] implies

[formula]

This is because since [formula] contains F, we deduce that either x and z are F-proportional, from which the conclusion follows, or that [formula] by [\eqref=eq:sidon] from which it follows that x- 1t and z- 1y each generate the constant field F.

This suggests calling a subspace which satisfies [\eqref=eq:sidon] a Sidon space, by analogy with classical Sidon sets. We make the remark that when a space A has a basis in geometric progression then there exists an x∈L such that [formula]. Therefore Sidon spaces can be thought of as spaces that are "furthest away" from a space with a basis in geometric progression.

For a Sidon space we clearly have

[formula]

for any [formula]. According to Lemma [\ref=lem:2atom], if A is a 2-atom of some set S satisfying [\eqref=eq:SA] in an infinite of finite separable extension without proper finite sub-extensions, then the inequalities in [\eqref=eq:sidon2] are actually equalities. To recap we have:

Let L / F be either a finite separable extension without proper subfields, or an infinite extension without proper finite intermediate subfields. Let S be a subspace of L with finite dimension ≥  2 and let A be a 2-atom of S. Then A is a Sidon space. Furthermore if  dim(SA) =  dim(S) +  dim(A) - 1 then  dim(A2) = 2 dim(A) - 1.

Now classical Sidon sets S of integers (or Sidon sets in abelian groups) have the property that [formula] which implies in particular that |S  +  S|  =  2|S| - 1 if and only if |S|  ≤  2. If we let ourselves be guided by the additive analogy, we may be led to expect for a moment that for any Sidon space A it is true that [formula]. This would immediately imply that the only Sidon spaces A such that  dim(A2)  =  2 dim(A) - 1 are of dimension ≤  2. It is however not true in general that [formula] for Sidon spaces, even in separable extensions of prime order.

For the sake of explicitness, here is a counter-example: take for F the finite field of size 2, for L the field of size 219, and let A be the F-vector with basis (1,α,α7,α12  +  α2 + 1) where α is a root of the irreducible polynomial X19  +  X14  +  X10  +  X7  +  X2  +  X  +  1. Computing dimensions yields [formula].

However, for the purpose of deriving Theorem [\ref=thm:main], we only need to prove that the only Sidon spaces that satisfy [\eqref=eq:sidon2] with equalities are of dimension ≤  2. If F is allowed to be any field, again this is not true. After we make the connection between Sidon spaces and quadratic forms, we shall give an example at the end of this section of a Sidon space of dimension 3 that satisfies [\eqref=eq:sidon2] with equalities.

When F is a finite field it is true though that Sidon spaces satisfying [\eqref=eq:sidon2] with equalities must be of dimension ≤  2. Specifically:

Let F be a finite field and let L be an extension field of F. Let A be a Sidon subspace of L of finite dimension  dim(A)  ≥  3. Then  dim(A2) > 2 dim(A) - 1.

Note that we do not need to suppose that L / F is finite and of prime degree.

Theorem [\ref=thm:sidon] together with Proposition [\ref=prop:sidon] will in particular establish that the 2-atom of S in Theorem [\ref=thm:main] can only have dimension 2, and Theorem [\ref=thm:main] will follow from Lemmas [\ref=lem:prog] and [\ref=lem:T].

To prove Theorem [\ref=thm:sidon] we shall transform our problem into a problem in the space of quadratic forms.

Let Qn denote the vector space of homogeneous polynomials of degree 2 in the variables [formula] with coefficients in the field F. A typical element of Qn will be denoted

[formula]

The F-vector space Qn is of dimension n(n + 1) / 2 and we can identify it with the space of quadratic forms over Fn. Similarly, let Ln denote the space of linear forms over Fn, identified with the space of homogeneous polynomials of degree 1 in [formula]. Let us now introduce a notion of weight of a quadratic form.

For a non-zero quadratic form Q∈Qn, let its weight equal the smallest integer k such that Q can be expressed as a sum of k products of linear forms in [formula].

[formula]

If C is a set of quadratic forms, we will call the minimum weight of C the smallest weight of the difference between two distinct quadratic forms of C:

[formula]

We note that, it C is a linear subspace of Qn, then [formula].

Now let A be a Sidon space of dimension n in some extension of F. Let [formula] be a basis of A. Consider the homomorphism Φ of vector spaces Ln  →  A defined by the mapping

[formula]

This homomorphism extends in a natural way to a homomorphism of F-vector spaces

[formula]

through the relations xixj  ↦  aiaj. Note that for any [formula], the map Φ satisfies [formula]. Consider the subspace C of Qn, C  =   ker Φ.

A is a Sidon space if and only if for any Q∈C,Q  ≠  0, we have [formula].

That [formula] is simply that elements of A2 live in a field where products of non-zero elements are non-zero. If [formula], meaning that [formula], then setting [formula] we have that xy + zt = 0 in A2. But A being a Sidon set implies, according to the remark following [\eqref=eq:sidon], that either x is an F-multiple of z and y is an F-multiple of t or x is an F-multiple of t and y is an F-multiple of z. Since the mapping Φ is one-to-one from Ln to A we deduce from this that Q is F-proportional to [formula], which contradicts [formula]. The reverse implication should be obvious.

Example of a Sidon Space.

Let [formula] denote the rational field and consider the extension [formula]. The polynomial x2 + y2 + 1 is absolutely irreducible over [formula], meaning that L contains no proper finite intermediate extension of [formula]. We claim that the subspace A with basis (1,x,y) is a Sidon space such that  dim(A2) = 5 = 2 dim(A) - 1. The statement regarding the dimensions is obvious: to see that A is indeed a Sidon space, suppose the contrary which would mean that four [formula]-linear combinations a,b,c,d of 1,x,y are such that ab + cd = x2 + y2 + 1. Switching to projective coordinates, this would mean exactly that the quadratic form x2 + y2 + z2 is of weight 2 over [formula]. But it is readily seen that this form is actually of weight 3 over [formula], therefore A can only be a Sidon space.

As remarked at the beginning of the section, the definition of a Sidon space contradicts, for dimensions at least 3, having a basis in geometric progression. Therefore the above example is also an example of a space A satisfying  dim(A2) = 2 dim(A) - 1 which does not have a basis in geometric progression. The setting is that of an infinite extension but this Sidon space can be transplanted as follows into a finite separable extension without intermediate subfields.

Example of a Sidon Space in a finite extension.

Let [formula] where a is a root of the irreducible polynomial P(x) = 2 + 2x + 2x2 + 2x4 + 2x5 + x8  =  1 + x2 + (1 + x + x4)2. It can be checked that the Galois group of this polynomial is the full symmetric group S8 which implies that the extension [formula] has no intermediate extension. Setting A to be the subspace of L generated by 1,a,b = 1 + a + a4, we again have  dim(A2) = 5 since 1 + a2 + b2 = 0. We also have that if Φ is the mapping from the space of quadratic forms in the variables x,y,z over [formula] into A defined by x  ↦  a, y  ↦  b, z  ↦  1, then ker Φ has dimension 1 and is generated by the quadratic form x2 + y2 + z2 which is of weight 3 as mentioned above. Therefore A is a Sidon set in L.

We remark that the quadratic form x2 + y2 + z2 is anisotropic over [formula], and that this makes it of weight 3. Similar examples can be constructed whenever we have such a quadratic form: these forms do not exist over finite fields however, which motivates our quest for Theorem [\ref=thm:main] and our study of packings of quadratic forms of minimum weight 3 in the next section.

We remark that if  dim(A2) = 2 dim(A) - 1 = 2n - 1, we have that  dim( ker Φ) = n(n + 1) / 2 - (2n - 1)  =  (n - 1)(n - 2) / 2. Theorem [\ref=thm:sidon] will follow if we can prove that for every n  ≥  3, a subspace of Qn of dimension (n - 1)(n - 2) / 2 and of minimum weight 3 does not exist.

Codes in the space of quadratic forms over finite fields

In this section, q is a power of a prime and [formula] is the finite field with q elements. As mentioned in the previous section, we will prove the following theorem, which will enable us to conclude the proof of Theorem [\ref=thm:main].

Let n  ≥  3, and let C  ⊂  Qn, with [formula]. Then, |C|  <  q(n - 1)(n - 2) / 2.

The inequality |C|  ≤  q(n - 1)(n - 2) / 2 follows from a simple packing argument. Indeed, if [formula] and [formula] are two linearly independent elements of Ln, let

[formula]

[formula] is a subspace of Qn, of dimension 2n - 1: if [formula] are such that [formula] is a basis of Ln, then [formula] is a basis of [formula]. Moreover, for all [formula], [formula]. So, if C has minimum weight at least 3, and if (Q,Q')∈C2, then [formula] unless Q = Q'. Said differently, the elements of C are pairwise distinct in the quotient space [formula]. As a consequence, their cardinalities satisfy

[formula]

The bound [\eqref=bound] is an instance of an anticode bound in coding theory terminology [\cite=mcws]: the set [formula] is an anticode, i.e. a set of diameter 2. Henceforth we refer to C as a code, i.e. a set C  ⊂  Qn with a minimum weight condition.

The claim in Theorem [\ref=Theorem_main] is therefore that the inequality in [\eqref=bound] is not attained when n  ≥  3. Improving upon [\eqref=bound] seems out of reach by elementary packing arguments and we shall need to involve group actions. As mentioned in the introduction, we shall derive Theorem [\ref=Theorem_main] by applying the Delsarte "linear programming" method.

Let us first give a short sketch of the proof. The space Qn affords the action of the group [formula], where [formula] acts by scalar multiplication on quadratic forms and the linear group [formula] acts linearly on the variables. This action preserves Ln, and hence the weight of a quadratic form. The orbits of the action of G on Qn will be denoted {Ot, t∈Tn}, where the index set Tn will be specified later. For a code of quadratic forms C, let [formula]. In a first step, we will prove that, under the assumptions [formula] and |C| = q(n - 1)(n - 2) / 2, these numbers satisfy a certain system of linear equations (Proposition [\ref=prop:primal_system]). Some of the equations are straightforward translations of the assumptions, but the most interesting ones arise from an application of Delsarte linear programming method [\cite=Del], that focuses on an appropriate test function with non negative Fourier coefficients. In a second step, we will prove that this system doesn't have any real solutions when n  ≥  3. To this end, we will work on a much smaller linear system (Proposition [\ref=prop_eq_all_dual]) satisfied by certain variables related to the Fourier coefficients of the characteristic function of C. When the code C is linear, these new variables can be interpreted in terms of the dual code of C. The duality notion that we shall rely on is somewhat non-standard and associates to a code of quadratic forms a dual code of symmetric bilinear forms.

We start by recalling some classical results on the classification of quadratic forms and symmetric bilinear forms over finite fields.

Group actions on quadratic forms and symmetric bilinear forms over finite fields

Let [formula], and [formula]. Denoting by ut the transpose matrix of u, to any quadratic form Q:x  ↦  Q(x) we can associate the form Qu:x  ↦  Q(xut), For [formula], a (right) group action is thus defined on elements Q of Qn by Qg = aQu. The orbits of Qn under this action are straightforwardly obtained from the well known description of the orbits of Qn under [formula] ([\cite=Tay]). We use the notation Q  ~  Q' for two G-equivalent quadratic forms. We recall that a symmetric bilinear form BQ, defined by BQ(x,y) = Q(x + y) - Q(x) - Q(y), is naturally associated to Q∈Qn. The radical [formula] of Q is the linear space of elements of [formula] such that Q(x) = 0 and BQ(x,y) = 0 for all [formula]. The rank [formula] of Q is the codimension of its radical, and Q is said to be non degenerate if [formula]. The set of quadratic forms of given rank r makes up one orbit if r is odd, and splits into two orbits if r is even:

If Q∈Qn is a quadratic form over [formula] in n variables of rank [formula], then one of the following holds:

r is odd and [formula].

r is even and [formula].

r is even and [formula], where In the above, [formula] is such that [formula] if p  ≠  2, and [formula] if p = 2, where [formula].

The space Sn of symmetric bilinear forms over [formula] is also equipped with a natural action of G, given by Bg = autBu, where we identify symmetric bilinear forms and symmetric matrices. We note that the [formula]-vector spaces Qn and Sn have the same dimension n(n + 1) / 2. Moreover, the correspondence Q  ↦  BQ defines an isomorphism of G-spaces when q is odd, because Q can be recovered from BQ thanks to the formula BQ(x,x) = 2Q(x). When q is even, BQ is alternating and the correspondence Q  ↦  BQ is not one to one. However, for all q, there exists a pairing between Qn and Sn that behaves well with respect to the action of G (the duality between the association schemes of quadratic forms and of symmetric bilinear forms derived from this pairing was already observed in [\cite=WWMM]).

Let [formula] be a fixed non trivial character. Let, for Q∈Qn, [formula] and B∈Sn, B = (bi,j)1  ≤  i,j  ≤  n,

[formula]

Then, this expression defines a non degenerate pairing between Qn and Sn, i.e. it satisfies:

(Q + Q',B) = (Q,B)(Q',B) for all Q,Q'∈Qn, B∈Sn.

(Q,B + B') = (Q,B)(Q,B') for all Q∈Qn, B,B'∈Sn.

(Q,B) = 1 for all B∈Sn if and only if Q = 0.

(Q,B) = 1 for all Q∈Qn if and only if B = 0.

For g = (a,u)∈G, let gt = (a,ut). We have:

[formula]

It is a straightforward verification.

The pairing introduced above allows for a convenient description of the multiplicative characters of the additive group (Qn, + ) and of the way the group G acts on them. Indeed, the characters of (Qn, + ) are in one to one correspondence with Sn and for every B∈Sn the associated character is given by:

[formula]

where B∈Sn. Furthermore, if we define the action of G on characters by (g.χ)(Q): = χ(Qg), then Lemma [\ref=lemma_pairing] translates into:

[formula]

In the next proposition, we recall the description of the orbits of Sn under the action of G. If q is even, and B∈Sn is non degenerate, [formula] is a hyperplane, and the restriction of B to W is alternating, so the description of the [formula]-orbits of Sn follows easily from the classification of alternating forms [\cite=Tay]. A matrix with a diagonal block structure [formula] is denoted below by [formula].

If B∈Sn is a symmetric bilinear form over [formula] in n variables of rank [formula], then one of the following holds:

r is odd and [formula].

r is even and [formula].

r is even and [formula] where [formula] if p = 2, and [formula], [formula], if [formula].

From Propositions [\ref=proposition_equivalence_Q] and [\ref=proposition_equivalence_S], we see that the orbits of Qn and of Sn under the action of G can be parametrized by the same set Tn, where

[formula]

as follows:

For a non-zero quadratic form Q∈Qn (respectively a non-zero symmetric bilinear form B∈Sn), of rank r, let e = 0 in case (1), e = 1 in case (2), e =  - 1 in case (3). The pair (r,e)∈Tn will be called the type of the quadratic form or of the symmetric bilinear form. The type of Q = 0, or of B = 0, will by definition be 0.

If Q is of type t∈Tn, we will use the notation Q  ~  t. The orbit of Q  ~  t will be denoted by OQ or Ot, and GQ will denote the stabilizer of Q in G.

When dealing with types, orbits and stabilizers, we will use the same set of notations whether we are speaking of quadratic forms or of symmetric bilinear forms. However, to avoid confusion, we will preferentially reserve the letter t for types of elements of Qn and the letter s for types of elements of Sn.

Let us now make the connection between the weight and the type of a quadratic form. Since the weight of a quadratic form is left unchanged under the action of G, it should be expressible in terms of its type. Indeed, we have:

If Q  ~  (r,e), [formula].

This formula can be put in a more general context as follows: over an arbitrary field F, it is well known that a non degenerate quadratic form Q∈Qn can be decomposed up to G-equivalence into the direct sum of a hyperbolic form [formula] of rank 2h and of an anisotropic form [formula] of rank n - 2h. Then, it is not difficult to verify that [formula], [formula] and [formula].

The equations satisfied by {Xt, t∈Tn}

Let C  ⊂  Qn denote a (not necessarily linear) subset of Qn, such that [formula]. Without loss of generality, we will assume that 0∈C. We have already introduced, for t∈Tn,

[formula]

These numbers satisfy a few trivial equations:

[formula]

The last set of conditions follow from the assumption [formula] and Lemma [\ref=lemma_weight_to_type]. We will prove that, if C is a hypothetical optimal code, i.e. if it satisfies equality in [\eqref=bound], then there are more equations for {Xt}:

For s∈Tn, the expression [formula] only depends on the type of Q. Let

[formula]

If C  ⊂  Qn, 0∈C, [formula] and |C| = q(n - 1)(n - 2) / 2, for all s = (r,e) such that 1  ≤  r  ≤  n - 2, we have

[formula]

We consider the function on Qn defined by:

[formula]

where A: = Ax1,x2. We note that Ag runs over the set [formula]. We will compute in two different ways the expression:

[formula]

The first way is straightforward; taking account of the fact that, if Q  ≠  Q', [formula], so that Q - Q' cannot belong to Ag, we have

[formula]

The second method uses the expansion of F over the characters of Qn, in other words its Fourier expansion. We introduce the complex vector space The multiplicative characters [formula], for B∈Sn, form a basis of L(Qn), which is orthonormal for the standard inner product

So, F can be written [formula]. It will be essential in what follows that fB  ≥  0, and we will also need to know when fB > 0. The next lemma clarifies this.

With the above notation, fB  ≥  0 for all B∈Sn, and fB > 0 if and only if [formula]. Moreover, f0 = |G||A| / |Qn|.

We have

[formula]

Let [formula]. Then, from the property [\eqref=pairing_action] of the pairing, [formula] (where g- t denotes the transpose of the inverse of g), and, because Ag is a subgroup of Qn, So, we find

[formula]

From [\eqref=equation_fB], it is clear that fB  ≥  0. Moreover, we see that fB > 0 if and only if the orbit of B intersects [formula]. Going back to the definitions of A [\eqref=eq_A] and of the pairing [\eqref=def_pairing], we see that [formula]. So, the orbit of B intersects [formula] if and only if [formula]. The expression for f0 follows from [\eqref=equation_fB].

Going back to Σ in [\eqref=sum], we have:

[formula]

where, in the last inequality, we have neglected the contributions of all the characters except that of the trivial one; the non negativity of the coefficients fB is crucial in this step.

Now we recap our findings: from [\eqref=first], [\eqref=second] and Lemma [\ref=lemma_fB],

So, we obtain after simplification, the inequality 1  ≥  (|A| / |Qn|)|C|; this inequality is nothing more than [\eqref=bound]. The interesting point here is that the equality 1 = (|A| / |Qn|)|C| holds if and only if the neglected terms in [\eqref=second] are equal to zero, leading, in the case of a hypothetical optimal code, to the conditions

[formula]

From Lemma [\ref=lemma_fB], we know that fB > 0 if and only if [formula]. Let s = (r,e) where 1  ≤  r  ≤  n - 2; observing that the condition fB > 0 holds simultaneously for all the elements of the orbit Os allows us to sum up the equations [\eqref=eq_new] over B∈Os. The expression [formula] only depends on the type of Q, since so the definition [\eqref=def_chis] of χs(t) is consistent and we obtain that

A change of variables

Let us recapitulate what we have achieved by now:

Suppose C  ⊂  Qn is such that 0∈C, [formula] and |C| = q(n - 1)(n - 2) / 2. Then, satisfy the following equations:

[formula]

[\eqref=eq_all] is a linear system of equations with |Tn| unknowns (the variables Xt) and |Tn| + 3 equations. So, if we are reasonably lucky, this linear system has no solutions, which in turn proves the non existence of the code C. Unfortunately, only a few of the unknowns are equal to zero so we cannot easily reduce the size of this system, and moreover, we so far have no closed expression for the coefficients χs(t). In order to overcome these issues, we will introduce a change of variables, whose effect will be to 'exchange' variables and equations, the end result yielding a very small linear system.

Suppose C  ⊂  Qn is such that 0∈C, [formula] and |C| = q(n - 1)(n - 2) / 2. Let and let The numbers Ys satisfy the following equations:

[formula]

The new variables Yt are related to the coefficients {λB, B∈Sn} of the characteristic function [formula] of C on the basis of characters:

[formula]

Indeed, we have

[formula]

so and thus

[formula]

Let us verify the equations (i') - (iv'). From [\eqref=eq_Ys], [formula] and from [\eqref=eq_lambdaB], [formula] so we find (i'). The equations (ii') follow immediately from (iv). From [\eqref=eq_lambdaB] and [\eqref=eq_1C], we obtain (iii'):

It remains to prove (iv)'. To this end, we introduce the characteristic function [formula] of the orbit Ot of quadratic forms of type t and its decomposition as a linear combination of characters: where the last equality being because for any Q∈Ot we have - Q∈Ot and [formula] by definition [\eqref=def_pairing] of (Q,B). Now the expression [formula] only depends on the type s of B, and

[formula]

so

[formula]

Then, Taking account of [\eqref=eq_mutB] and of [\eqref=eq_Ys], we find

[formula]

The above relation between Xt and Ys shows that (ii) is equivalent to (iv').

If the code C is a linear subspace of Qn, the numbers Ys have a combinatorial interpretation in terms of the dual code Indeed, it follows from the Poisson summation formula that [formula]. Moreover, it now follows from Proposition [\ref=prop_eq_all_dual] that we have a remarkable connection between linear codes of quadratic forms endowed with the weight distance, and linear codes of symmetric bilinear forms endowed with the rank distance, namely:

If C is a linear subspace of Qn of dimension (n - 1)(n - 2) / 2 and minimum weight 3, then [formula] is a linear subspace of Sn of dimension 2n - 1 and minimum rank n - 1.

Codes of symmetric bilinear forms for the rank distance have been studied in [\cite=Sch1] and [\cite=Sch2]. In particular, the tight upper bound of qn + 1 is proved for a linear code of minimum rank at least n - 1, if q is even and n is even ([\cite=Sch1]), and if q is odd ([\cite=Sch2]). Noting that n + 1 < 2n - 1 if and only if n  ≥  3, we have therefore that Corollary [\ref=cor:linear] together with [\cite=Sch2] proves Theorem [\ref=thm:sidon] for q odd and hence Theorem [\ref=thm:main] for q odd. For even q, the results of [\cite=Sch1] together with Corollary [\ref=cor:linear] yield Theorem [\ref=thm:sidon] with the additional hypothesis that  dim(A) is even. If we remark that Lemma [\ref=lem:dim(A)even] proves that under the hypothesis of Theorem [\ref=thm:main] the 2-atom A can not have odd dimension, then we obtain a proof of Theorem [\ref=thm:main] for finite fields with q even.

In the next section we shall nevertheless give a self-contained proof that the system [\eqref=eq_all_dual] has no solutions over the real numbers. This will give us a complete proof of Theorem [\ref=thm:sidon] which is of independent interest besides being a stepping stone towards Theorem [\ref=thm:main].

Solving the linear system satisfied by {Ys, s∈Tn}

The linear system [\eqref=eq_all_dual] is much more friendly than [\eqref=eq_all] because it can be re-written as a linear system in only three variables (depending on the parity of n, {Y(n - 1,0),Y(n, - 1),Y(n,1)} or {Y(n - 1, - 1),Y(n - 1,1),Y(n,0)}) and six equations. In order to prove that this linear system doesn't have any solutions when n  ≥  3, it will be enough to take account of the equations (iv') associated to the types t = (1,0),(2,1),(2, - 1), and thus to compute the values of χs(t) for s = (n,e),(n - 1,e) and t = (1,0),(2,1),(2, - 1). These numbers are the so-called P-numbers of the association scheme defined by the action of G on Qn ([\cite=BI]) and they could be derived from [\cite=FWMM] and [\cite=Sch2]. In order to keep this paper self-contained, we offer a direct computation in the appendix. We obtain the following systems of equations:

With the notation of Proposition [\ref=prop_eq_all_dual], let Y = (Y(n - 1,0),Y(n,1),Y(n, - 1)) if n is even, and Y = (Y(n - 1,1),Y(n - 1, - 1),Y(n,0)) if n is odd, then where:

If n is even and p = 2,

If n is odd and p = 2,

If n is even and p  ≠  2,

If n is odd and p  ≠  2,

The following proposition will conclude the proof of Theorem [\ref=Theorem_main].

The linear systems defined in Lemma [\ref=lemma_system] have no solutions if n  ≥  3.

By brute force: we solve for the first three equations; it turns out that there is a unique solution Y*, and then we evaluate the left hand side of the last equation at Y*, and observe that it cannot be equal to - 1 unless n = 1,2. We skip the details.

If n is even and p = 2, and the LHS of the last equation evaluated at Y* is equal to

If n is odd and p = 2, and the LHS of the last equation evaluated at Y* is equal to

If n is even and p  ≠  2,

[formula]

and the LHS of the last equation evaluated at Y* is equal to

If n is odd and [formula],

[formula]

and the LHS of the last one at Y* is equal to

Transcendental extensions

We now suppose that the two finite-dimensional subspaces S and T are such that  dimF(ST)  =   dimF(S) +  dimF(T) - 1 but that they live in an infinite dimensional extension L / F, with no element of [formula] algebraic over F. When  dim(S), dim(T)  ≥  2, can we conclude that S and T have bases in geometric progression as in Theorem [\ref=thm:main] ? It is natural to search for guidance in the classical additive setting: it is much easier to prove in the set [formula] of integers than in [formula], that if |S|,|T|  ≥  2 and |S + T| = |S| + |T| - 1, then S and T must be arithmetic progressions. This leads us to think that the case of infinite extensions should be easier than the case of finite extensions. This turns out to be true, but only in part. Transcendental extensions have valuation rings which allow us to transfer the structure of spaces with small products to sets with small sumsets in totally ordered abelian groups. This method has limitations however as we develop below.

We first deal with the case when F is algebraically closed: in this case the valuation approach is straightforward.

Let F be an algebraically closed field and let L / F be a non-trivial extension of F. Let S,T be subspaces of L such that  dim(S)  ≥  2, dim(T)  ≥  2 and

[formula]

Then there are bases of S and T of the form [formula] and [formula] for some g,g',a∈L.

From Section [\ref=sec:critical] it suffices to show that there exists a space A of dimension 2 such that  dim(SA) =  dim(S) + 1. The result will therefore follow by induction if we can show that when  dim(T) > 2, there exists a subspace of T' such that  dim(T') =  dim(T) - 1 and  dim(ST')  ≤   dim(S) +  dim(T') - 1. Without loss of generality we may suppose that L is the subfield generated by S and T, hence its transcendence degree is finite, in other words L is a function field. Since there always exists a place of L, by composition of places we may choose a place with values in an algebraic extension of F which is F because F is algebraically closed. This place is equivalent to a valuation ring with residual field equal to F (e.g. Lang [\cite=lang]). We may now choose a basis [formula] of T such that [formula] where v is the valuation function. Setting T' to be the subspace generated by [formula], we see that elements of ST of minimum valuation can not exist in ST'. Therefore  dim(ST') <  dim(ST) so that  dim(ST')  ≤   dim(S) +  dim(T') - 1 and we are done.

The above approach extends to every case when we can guarantee the existence of a place of L with values in F. However when F is not algebraically closed, it may happen that L has no F-valued places in which case we can only guarantee the existence of places with values in an algebraic extension of F. In this type of situation we can hope to obtain a result through the valuation approach only if we already have a version of Vosper's Theorem for finite extensions. We illustrate this below by extending Theorem [\ref=thm:main] to transcendental extensions of finite fields.

Let F be the finite field [formula] with q elements and let L / F be an infinite extension such that no element of [formula] is algebraic over F. Let S,T be subspaces of L such that  dim(S)  ≥  2, dim(T)  ≥  2 and

[formula]

Then there are bases of S and T of the form [formula] and [formula] for some g,g',a∈L.

As in the proof of Theorem [\ref=thm:closed], we are done if we can exhibit a subspace T' of codimension 1 in T such that  dim(ST')  ≤   dim(S) +  dim(T') - 1.

By the Lang-Weil estimation of the number of rational points of an algebraic variety, for any sufficiently large m there exists a place of L with values in the finite extension [formula] of [formula] [\cite=langweil]. From this we have a valuation v from L into an ordered abelian group, together with a valuation ring O in L made up of all elements of non-negative valuation. If P is the maximal ideal of O made up of all elements of positive valuation, we have the isomorphism [formula]. We chose m to be prime and such that m  ≥   dim(ST) + 2.

Without loss of generality, translating T if need be, we may suppose that the minimum valuation of elements of T is 0. Let [formula] and decompose T as [formula] where T0 is any subspace of T in direct sum with TP. Note that since 0 is the minimum valuation in T, we have that T0  ≠  {0} and all non-zero elements of T0 are of valuation 0. Let S = S0 + SP be a similar decomposition.

We clearly have ST  ⊃  S0T0  +  SPTP. Now let E be a maximal subspace of S0T0 all of whose non-zero elements have valuation zero. We therefore have

[formula]

We make the remark that if s∈S0 and if τ is an element of TP of minimum valuation, then the valuation of sτ equals the valuation of τ and does not belong to the set of valuations of the space E + SPTP. Therefore [formula] and

[formula]

The map π:O  →  O / P is injective on E and we have

[formula]

By the Cauchy-Davenport inequality (Theorem [\ref=thm:Cauchy]) applied in the extension O / P of F, i.e. in [formula], we have that  dim(E)  ≥   dim(S0)  +   dim(T0) - 1. From the Cauchy-Davenport inequality applied in L we have that  dim(SPTP)  ≥   dim(SP)  +   dim(TP) - 1. Since  dim(ST) =  dim(S) +  dim(T) - 1 by the hypothesis of the Theorem, [\eqref=eq:+1] implies that both the above inequalities must be equalities so that we have

[formula]

Now if  dim(S0)  ≥  2 and  dim(T0)  ≥  2, because we have chosen the extension [formula] sufficiently large, Theorem [\ref=thm:main] applies in [formula] and there exists a subspace T'0 of T0 of codimension 1 such that  dim(π(S0)π(T'0))  <   dim(π(S0)π(T0)) and [formula] is the required subspace of T of codimension 1. If either  dim(S0) = 1 or  dim(T0) = 1, then T' = T'0  +  TP for any subspace T'0 of codimension 1 of T0 again yields the required subspace of T.

Concluding Comments

An alternative proof of Theorem [\ref=thm:closed] follows from a version of Theorem [\ref=thm:sidon] for algebraically closed fields F. To obtain this, we need the equivalent of Theorem [\ref=Theorem_main]. We actually have a stricter upper bound. We only deal with odd characteristic:

If F is algebraically closed of odd characteristic, and if C  ⊂  Qn is a linear space, such that [formula], then  dim(C)  ≤  n(n + 1) / 2 - (4n - 6).

If F is algebraically closed, up to [formula]-equivalence, x21 is the only anisotropic form, from which it follows fairly easily that for a quadratic form Q, We identify Qn with the space Sn of symmetric matrices over F. We introduce [formula], which is an algebraic variety over F (because the rank condition is equivalent to the condition that the minors of order 5 vanish, and the minors are polynomials in the matrix coefficients). The assumption [formula] translates to [formula] which implies that  dim(C) +  dim(R4)  ≤   dim(Sn) = n(n + 1) / 2 (see [\cite=Har]) so it remains to compute  dim(R4). The variety R4 splits into 5 orbits under the action of [formula], with representatives of the form where

Each of these orbits can be identified with the quotient space [formula] where [formula] denotes the orthogonal group of the form [formula]. We assume S0  ≠  (0) since in this case the orbit is reduced to one point. Let U∈O(S), and let us write [formula] according to the block structure of S. Then, a straightforward verification shows that the condition UtSU = S translates to: U2 = 0 and U1∈O(S0). There are no constraints on U3; the only condition on U4 is [formula] where [formula] (so that [formula]). Putting everything together, we find that [formula], and the corresponding orbit in R4 has dimension nn0  -   dim(O(s0)) = nn0 - n0(n0 - 1) / 2.

Theorem [\ref=thm:infinite] follows also from Proposition [\ref=prop:sidon] and Theorem [\ref=thm:sidon]. However the alternative proof given in Section [\ref=sec:transcendental] serves to illustrate that versions of Vosper's theorem for an infinite dimensional extension will require a finite-dimensional theorem as a stepping stone.

What is the minimum dimension of the square of a Sidon space ? This question is quite intriguing and very much open even in the case of finite fields. It is likely that the upper bound claimed in Theorem [\ref=Theorem_main] is far from tight, and that it would be possible to greatly improve it by pursuing the Delsarte methodology further. For finite fields this would yield a lower bound on the minimum dimension of the square of a Sidon space that improves upon Theorem [\ref=thm:sidon].

The central question left open is that of a complete characterisation of the critical spaces achieving equality in the Cauchy-Davenport inequality of Theorem [\ref=thm:Cauchy]. The example at the end of section [\ref=sec:sidon] shows that it is not true for all base fields that all such pairs {S,T} of spaces have bases in geometric progression whenever [formula]. We also note that for finite non-separable extensions, the methods of this paper break down completely.

Acknowledgement.

We are indebted to Jean-Marc Couveignes, Alain Couvreur and Qing Liu for valuable comments.

Appendix: the computation of the needed values of [formula]

We compute explicit expressions for χs(t) / |Os| when t = (1,0),(2,1),(2, - 1). It turns out that the formulas are slightly different depending on the parity of q. We start by recalling the formulas for the number of elements on which a quadratic form vanishes, in terms of its type (see [\cite=Tay]).

For Q∈Qn, let The value of ZQ only depends on the dimension n and the type t = (r,e) of Q, and will be denoted Zn,t. We have:

We have, for s = (r,e),

Case t = (1,0)

If p = 2

If p  ≠  2

Case t = (2,1)

If p = 2

If p  ≠  2

Case t = (2, - 1)

If p = 2

If p  ≠  2

In the following, [formula] denotes the representative of the orbit of quadratic forms of type t given in Proposition [\ref=proposition_equivalence_Q], and analogously Bs = (bsi,j) denotes the representative of the orbit of symmetric bilinear forms of type s from Proposition [\ref=proposition_equivalence_S]. We introduce the following notation: if [formula] and B = (bi,j), we let [formula]. We recall that (Q,B) = α(b(Q,B)), where [formula] is a fixed non trivial character. Then,

[formula]

Due to the standard properties of characters, We introduce: and we have:

[formula]

Let [formula] denote the column vectors of the matrix [formula]. We have

[formula]

We introduce the quadratic form Q(x): = xtBsx and will denote its type by t'; it can be readily verified that, if p  ≠  2, t' = s, and if p = 2, t' = (1,0) for e = 0, - 1 and t' = 0 for e = 1.

Case 1: t = (1,0). Then, Qt = x21 and b(Qt,Bus) = vt1Bsv1. So, with the notation above and that of Proposition [\ref=prop_NQ],

[formula]

The expressions for χs(t) / |Os| follow then immediately from the formulas for Zn,t' in Proposition [\ref=prop_NQ] and from [\eqref=eq_Pst].

Case 2: t = (2,1). In this case, Qt = x1x2 and b(Qt,Bus) = vt1Bsv2. For [formula], Q(w): = vt1Bsv2 defines a quadratic form which can be easily seen to be of type (2r,1). So, the number of w = (v1,v2) such that Q(w) = 0 is equal to Z2n,(2r,1). Because v1,v2 are the two first column vectors of [formula], they should not be linearly dependent. The number of (v1,v2) such that Q(w) = 0 and {v1,v2} are linearly dependent is: 2qn - 1 + (q - 1)(Zn,t' - 1) so we obtain:

Case 3: t = (2, - 1). In this case, Qt depends on the parity of p. If p = 2, Qt = x21 + x1x2 + bx22 and b(Qt,Bus) = vt1Bsv1  +  vt1Bsv2 + bvt2Bsv2. For [formula], let Q(w): = vt1Bsv1  +  vt1Bsv2 + bvt2Bsv2. Again, we count the number of (v1,v2) such that Q(w) = 0 and {v1,v2} are linearly dependent, and find 1 + (q + 1)(Zn,t' - 1). We need to determine the type t'' of Q. With some work, we find:

[formula]

so

If p  ≠  2, Qt = x21 - bx22 and b(Qt,Bus) = vt1Bsv1 - bvt2Bsv2. For [formula], let Q(w): = vt1Bsv1 - bvt2Bsv2. The number of (v1,v2) such that Q(w) = 0 and {v1,v2} are linearly dependent is as in the previous case of p = 2 equal to 1 + (q + 1)(Zn,t' - 1). Also, we find the same type t'' for Q so again