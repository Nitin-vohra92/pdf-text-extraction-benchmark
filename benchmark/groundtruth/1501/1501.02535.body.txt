The Langevin function and truncated exponential distributions

Introduction, applications

Preamble, not for journal publication. This paper was in 2007 submitted to Solar Energy as it was a slight improvement on the theory part of a paper in that journal. As it lacked observational data, that journal suggested it wasn't appropriate as it stood. (WRF simulations have been considered, but not implemented.) In 2012 another journal proposed a Special Issue on Special Functions and Probablity and Statistics Applications, but this proposal didn't eventuate. The arXiv version here is the 2012 version of the paper.

The frequency distribution of insolation values is important for the prediction of the performance of systems involving solar heating. The fractional time distribution for the clearness K, for K min  ≤  K  ≤  K max can be modelled by

[formula]

see [\cite=BCR] . (Of course, F(K) = 0 for K < K min and F(K) = 1 for K > K max.) This is the doubly-truncated exponential distribution. We remark that γ could be negative. Equation ([\ref=eq:fK]) appears in equation (3.7.4) of [\cite=R] p72 and equation (1) of [\cite=SM]. K max and K min are the maximum and minimum of the daily clearness index over the period of interest (and a common approximation is that K min = 0.05). Simulations of solar water and air heaters are discussed in [\cite=R]. Oher situations - and one which the author encounted is described in [\cite=D] - might also be simulated in like manner.

The truncated exponential distribution has many other applications including distributions of earthquakes, of forest-fire sizes, raindrop sizes, reliability modelling, etc. See [\cite=AB] [\cite=BD] [\cite=HD] for example (noting that, in some applications, K min, K max and γ are all unknowns). The Langevin function, defined in §[\ref=sec:Langevin], is easily recognized in formulae in these papers. For example, equation (2.7), h2(ν) = r, in [\cite=BD], is L(ν / 2) = 2r - 1.

If one supposes K max and K min values to be known, it remains to estimate γ. To do this, first calculate

[formula]

The quantity γ can be estimated by solving q  =  μK(γ), where q is the mean of the observations. See [\cite=R] p72 equation (3.7.5) and [\cite=SM] equation (2). The γ so found is the method of moments estimate and, in fact, the maximum likelihood estimate of γ.

To shorten the formulae which follow, define α (an average) and δ (half the difference) by

[formula]

Using K min  =  α  -  δ, and K max  =  α  +  δ in the right-hand side of equation ([\ref=eq:gK])

[formula]

so equation ([\ref=eq:gK]e) becomes

[formula]

The Langevin function

The purpose of this genuinely elementary note is to call attention to the fact that the function occuring on the right-hand side of equation ([\ref=eq:3e]) is the Langevin function, and various consequences of this. For example, γ can be expressed exactly in terms of the inverse Langevin function. Both the Langevin function and its inverse have been studied widely in other contexts: see, for example, [\cite=C] [\cite=P] [\cite=SO]. The Langevin function is defined, with x  ≠  0, by

[formula]

and, for x = 0, by L(0) = 0. The function L is a monotonic increasing function mapping the real line into the interval from - 1 to 1, and it satisfies

[formula]

The inverse Langevin function is the function L- 1 inverse to L. Of course, the computation of L- 1 remains a numerical issue, just as the solution for γ of equation ([\ref=eq:gK]e) is. However, with the knowledge of the name of the function, the solar applications can share algorithms and code with the other applications, if it is so desired. Knowing the name of the function involved assists in the search for numerical software. Numerical codes, in C, are available for the inverse Langevin function.

With

[formula]

equation ([\ref=eq:3e]) can be written y  =  L(x). Consequently

[formula]

Suehrcke et al. [\cite=SM] gave an approximation to γ solving equation ([\ref=eq:3e]) which amounts to approximating x = L- 1(y) by

[formula]

Suehrcke used a polynomial expression for A, finding its coefficients in the best way to be useful over the range of values of K min, K max and q occuring in the clearness application. Restricting to the one tangent evaluation, this can be used in other ways to approximate L- 1. Let τ  =   tan (πy / 2) =  tan (πL(x) / 2). By fitting for small τ and for large τ using Maple we find that

[formula]

This approximates L- 1 with a relative error of about 0.3% over the entire range and even smaller relative errors can be obtained by using higher degree polynomials in the numerator and denominator.

The Langevin function - and nothing worse than this - arises in the formulae for all the higher moments and for all the higher cumulants in the truncated exponential distribution. The moment generating function M, and the cumulant generation function C, are defined by

[formula]

One easily finds

[formula]

Differentiating this gives

[formula]

The fact that C'(0) = μK(γ) recovers equation ([\ref=eq:muK]). Equations ([\ref=eq:Lderiv]) and  ([\ref=eq:Cderiv]) show that each higher derivative of C can be expressed as a polynomial in L = L(x + sδ), δ, and 1 / (x + sδ). The most important cumulant after the mean μK(γ) is the second, the variance σ2K(γ).

[formula]

where L = L(γδ) = (μK(γ) - α) / δ. (The right hand side can be expressed, equally well, in terms of coth (x) as in terms of L(x).)

There is a practical use for equation ([\ref=eq:sigma2K]). Let the first and second cumulants from the data be denoted q (for the sample mean) and s2K (for the sample variance). Next, denote by v the value of the right-hand side of equation ([\ref=eq:sigma2K]), when γ is given by that solving q  =  μK(γ). and μK(γ) is replaced by q. would give some indication of how well the truncated exponential distribution (with the given K min, K max) fits the data.

There is a more general context for some of this, for example, in the context of natural exponential families with quadratic variance functions. Equation ([\ref=eq:sigma2K]) is an example of a 'quadratic variance function'. The untruncated versions of these distributions are treated in [\cite=Mo], but further consideration of such matters takes us too far from the Langevin function observation which is the subject of this note.

Conclusions

We hope that practitioners in the different disciplines using truncated exponential distributions will be able to benefit from sharing experiences. In particular, in this paper, we have called attention to the Langevin function, and the existing methods of approximating its inverse appropriate to estimating γ.