Minimal nontrivial solutions of the isometry equation

Preliminaries

Let K be a finite field of size |K| = q and let W be a vector space over K of dimension greater than one. Let m be a positive integer and let Vi,Ui  ⊆  W be vector spaces, where [formula].

Recall for the pair of sets X  ⊆  Y the indicator function [formula] is defined as [formula] for x∈X and [formula] otherwise.

The following equation is called an isometry equation,

[formula]

Denote [formula], [formula] and call the tuples of spaces. A pair of tuples (U,V) is called a solution if it satisfies .

The easiest way to find a solution is to chose any spaces [formula] and define Ui  =  Vπ(i), for some permutation π∈Sm, where [formula]. We say that tuples V and U are equivalent (U  ~  V) if there exists a permutation π∈Sm, such that Vi  =  Uπ(i), for all [formula]. Such a solution (U,V), where the tuples U and V are equivalent, is called trivial. Note that the defined equivalence of tuples is really an equivalence relation.

We say that two pairs (U,V) and (U',V') are equivalent (denote (U,V)  ~  (U',V')) if U  ~  U', V  ~  V' or V  ~  U', U  ~  V'. The defined equivalence of pairs is also an equivalence relation on the set of all pairs of tuples of spaces. A pair (U,V) is a solution if and only if any equivalent is a solution. Moreover, (U,V) is a trivial solution if and only if any equivalent pair is a trivial solution.

In general, not all the solutions are trivial. Denote by [formula] a projective space of dimension one over K. Note that [formula]. For m  =  q  +  1 there exists an example of a nontrivial solution.

A pair (U,V) is called a pair of Type A, if there exist a subspace S  ⊆  W of dimension k and two different vectors a,b∈W, with [formula], such that [formula], Vq + 1  =  S and Ui  =  〈S,αia  +  βib〉K, for [formula], where

[formula]

In fact, the spaces [formula] from a pair of Type A are all different hyperplanes in 〈S,a,b〉K that contain the subspace S. In [\cite=d1] it was proved that a pair of Type A is a nontrivial solution. Indeed, denote V  =  〈S,a,b〉K, then

Evidently, a solution of Type A is nontrivial. The inclusion diagram of spaces from a pair of Type A is presented in .

To classify all the solutions, up to equivalence, for some m, we have to describe all trivial and all nontrivial solutions. For trivial solutions the task is easy -- all such solutions are parametrized by tuples of spaces of length m, where the spaces are subspaces of W.

The case of nontrivial solutions is more complicated. We introduce several important properties of nontrivial solutions that we are using further.

Let V be a nonzero vector space over K and let Ui  ⊂  V be proper subspaces, for [formula]. If [formula], then m is greater than the cardinality of K.

For any [formula], dim KUi  ≤   dim KV  -  1 and hence [formula]. Thus we have that implies m  >  |K|.

Let [formula] be different vector spaces over K. Assume that [formula] and Then max {r,s} is greater than the cardinality of K.

Among the spaces [formula] choose one that is maximal under inclusion. It is either Vi for some [formula], or Uj for some [formula]. In the first case [formula], where for all [formula], [formula]. From Lemma [\ref=lemma-minimum-covering-number-of-one-space], r  >  |K|. Similarly, in the second case s  >  |K|.

There exists a nontrivial solution if and only if m  ≥  q + 1.

Let (U,V) be a nontrivial solution. Simplify by combining and elimination of all equal spaces. The resulting equation is in the form of the equation from and therefore m  >  q.

Conversely, let (U,V) be of Type A. If m  =  q + 1 we have already shoved that (U,V) is a nontrivial solution. If m  >  q  +  1, let [formula] be subspaces in W. Define tuples U',V' by adding all these spaces to both tuples U and V. The pair (U',V') is a nontrivial solution.

In this paper our objective is the description of all solutions of for m  =  q  +  1, up to equivalence, and to study their properties. As we mentioned above, this task is reduced to the description of nontrivial solutions.

From we see the importance of the coverings of a vector space by proper subspaces. In the case m  =  q + 1 there is a description of all such coverings.

Let V be a nonzero space over K. Let Wi  ⊂  V, for [formula], be proper subspaces and [formula]. There exists subspace S  ⊂  V of codimension 2 such that [formula] is the set of all hyperplanes in V that contain S. The equality holds,

[formula]

The proof is based on the fact that a finite K-linear space can be covered by at least q + 1 proper subspaces. Using the sieve theorem for the size of the covering, it is easy to prove that the only possible covering by the minimum number of the proper subspaces is the one presented in the statement. evidently follows.

Properties of minimal nontrivial solutions

In [\cite=d1] we completely observed the solutions with different maximum dimensions of spaces in two tuples, max 1  ≤  i  ≤  m dim KVi  ≠   max 1  ≤  i  ≤  m dim KUi.

Let (U,V) be a nontrivial solution and

[formula]

Then (U,V) is equivalent to a solution of Type A.

The proof is based on . Due to the different maximum dimensions, without a loss of generality, the space V1 has dimension greater than one and is covered by the spaces [formula].

From now in this section we suppose that (V,U) is a nontrivial solution, m  =  q + 1, max 1  ≤  i  ≤  m dim KVi  =   max 1  ≤  i  ≤  m dim KUi  =  n  >  1 and the maximum is achieved on the spaces V1 and U1.

For all [formula] the following hold,

Ui  ≠  Vj,

Vi  ⊆  Vj implies i  =  j,

dim KVi  ≥  n - 1, dim KUj  ≥  n  -  1,

if dim KUj  >   dim KVi, then Vi  ⊂  Uj,

if dim KUj  =  n, then there exists a subspace S  ⊂  Uj of dimension n  -  2 such that S  ⊂  Vi for all [formula].

Assume that (a) does not hold. Without loss of generality, we can assume that Um  =  Vm. Reduce to [formula]. The pair [formula] is therefore a nontrivial solution of the new equation and, by , m  -  1  ≥  q + 1, which contradicts to the fact that m  =  q + 1.

Let [formula] be such that dim KUl  =  n. Assume that for some [formula], Vi  ⊆  Vj. Then [formula]. Since Ul has the largest dimension among all the spaces, according to (a), for all [formula], [formula]. Also [formula]. From , since m  =  q + 1, the spaces [formula], for [formula], are all different hyperplanes in Ul. Thus [formula] implies i  =  j and [formula], for [formula]. Therefore we have (b) and (c). If dim KVt  =  n  -  1, then [formula], which proves (d). Also, from there exists a space S  ⊂  Ul of dimension n - 2, such that [formula], for all [formula]. This proves (e).

There exists a space S of dimension n - 2 such that for all [formula], S  ⊂  Ui,Vi.

From (e), there exists a subspace S  ⊂  U1 of dimension n - 2 such that for all [formula], S  ⊂  Vi. Restrict both sides of on the space S. In result we get,

[formula]

Calculating in zero we get the equality, [formula]. Thus the coefficient on the left side of is positive. On the right side of there are m - 1 terms and therefore, by , there exists [formula], without loss of generality assume i  =  2, such that S  ⊂  U2. Continuing the procedure of elimination for all [formula], we get S  ⊂  Ui, for all [formula].

(c) states that in a nontrivial solution the only possible dimensions of spaces are n - 1 and n. Denote [formula] and [formula].

The cardinalities of X and Y are equal and they are not greater than one.

Verify that |X|  =  |Y|. Calculate in the point {0}. Since all the spaces contain zero, we have [formula] or, the same, [formula]. Hence |X|  =  |Y|.

From (d), we have the inclusions,

[formula]

Prove that |X|  >  1 implies |Y|  ≥  m  -  1. By the contradiction, assume that |Y|  <  m  -  1. Inequality |X| > 1 implies that there exist [formula] such that dim KVi  =   dim KVj  =  n  -  1. By (b), Vi  ≠  Vj and, by (e), [formula]. From , [formula] and, using the fact that [formula], we have, This inequality does not hold and hence, by contradiction, |Y|  ≥  m  -  1.

The general assumption in the section is dim KV1  =  n, hence 1∉X and|X|  ≤  m  -  1. Combining it with the result above, |X|  >  1 implies |Y|  =  |X|  =  m  -  1. Prove that |X|  =  m  -  1 is impossible. Assume that |X|  =  m  -  1. This means that dim KV1  =   dim KU1  =  n and dim KUi  =   dim KVi  =  n - 1, for [formula]. Using , it is easy to see that [formula] and [formula], for [formula], where S  ⊂  V1 is a space from (e) with dim KS  =  n  -  2 and for all [formula], S  ⊂  Ui. Calculate the restrictions of on U1,

[formula]

implies [formula], where the spaces [formula], [formula] do not equal U1. From , [formula] on U1. Substituting it to , we get [formula] that is not true. By the contradiction, |X|  <  m  -  1.

In result, there are two possibilities, |X|  =  |Y|  =  0 and |X|  =  |Y|  =  1.

So, there exist at most two possible dimension vectors for nontrivial solutions, with |X|  =  |Y|  =  1 and |X|  =  |Y|  =  0.

Let S be the space with dim KS  =  n  -  2 such that for all [formula], S  ⊂  Ui,Vi. Let Zij denote the space [formula] for [formula]. Without loss of generality, assume that if |X|  =  |Y|  =  1, then dim KVm  =   dim KUm  =  n  -  1.

For all [formula] the following statements hold,

if i  ≠  j, then dim KZij  =  n - 1,

if dim KVj  =  n, then

[formula]

for all [formula], such that i  ≠  k or j  ≠  l, [formula].

Note that, for all [formula], we have [formula]. Also, by (a) and (c), [formula]. If dim KVj  =  n, then Zij  ⊂  Vj and, by , the spaces Zij for [formula] form a covering of Vj by hyperplanes that intersect in S. Therefore, for all [formula], such that dim KVj  =  n, for all [formula], dim KZij  =  n - 1 and holds. If j  =  m, dim KVj  =  n  -  1 and i  ≠  m then, by (d), Zij  =  Zji  =  Vm and dim KZij  =   dim KZji  =   dim KVm  =  n  -  1.

Consider again the equality [formula], for all [formula], and calculate [formula]. By , [formula]. If one of these two spaces [formula] or [formula] has dimension n  -  2, then it is equal to S and therefore [formula]. Consider the case [formula]. This implies dim KUi  =   dim KUj  =   dim KVk  =   dim KVl  =  n. In this case, if i  ≠  k, [formula], since Zij and Zkj are different hyperplanes in Vj. The same holds if j  ≠  l.

Detailed description of minimal nontrivial solutions

In this section we keep all the assumptions and notations from the previous section.

Let W be a K-space, [formula] be K-spaces that have a common subspace S. The equality [formula] of the functions on W is equivalent to the equality

[formula]

of the functions on W / S.

Let S,V  ⊆  W be spaces such that S  ⊆  V. Let πS:W  →  W / S, x  ↦  x̄ be a canonical projection, where x̄  =  x  +  S. The equality [formula] holds. Indeed, x∈V implies x̄∈V / S, and conversely, x̄∈V / S implies that there exists x'∈V such that x̄  =  , which is equivalent to the fact that x  -  x'∈S and thus x∈V.

Let [formula] be spaces with a common subspace S. Consider the function [formula], [formula], where [formula] for [formula]. Let [formula]. For each x∈W the equality F(x)  =  (πS(x)) holds, [formula]. Since πS is a projection, the identity [formula] on W is equivalent to the identity [formula] on W / S.

Using the arguments above, the equation [formula] of the functions on W is equivalent to the equation [formula] of the functions on W / S. Since |Vi / S|  =  |Vi| / |S| and |Ui / S|  =  |Ui| / |S|, for all [formula], it is the same as [formula]. The set S contains zero, so |S|  >  0 and we divide both sides of the equality by S, obtaining the necessary equality.

Since the spaces in the nontrivial solution (U,V) have a common subspace S of dimension n  -  2, we can factorize all the spaces by S and describe nontrivial solutions in the case S  =  {0}. In such a way we can simplify sometimes the proof without loss of properties of nontrivial solutions. Therefore, we can assume that n  =  2. We will use this assumption when we need it.

Call a pair of tuples (U,V) to be of Type B, if there exists a subspace S  ⊂  W and linearly independent vectors a,b,c∈W, where [formula], such that Vm  =  〈S,a〉K, Vi  =  〈S,b,αia  +  c〉K, Um  =  〈S,b〉K and Ui  =  〈S,a,αib  +  c〉K, where αi is the ith element in the field K, for [formula].

In there is presented the inclusion diagram of spaces in a pair of Type B along with intersections.

A pair (U,V) of Type B is a nontrivial solution with |X|  =  |Y|  =  1. If a pair (U,V) is a nontrivial solution with |X|  =  |Y|  =  1, then (U,V) is equivalent to a solution of Type B.

To simplify both parts of the proof, according to and , we can assume S  =  {0} and n  =  2.

Prove the first part. Calculate the intersection of the spaces, [formula], for [formula]. After computations we get Zij  =  〈αja  +  αib  +  c〉K. All the spaces Zij for [formula], Vm and Um are different. From (b), [formula], for any [formula]. Note that [formula], for [formula].

For all [formula] calculate the projection of both sides of , multiplied from both sides by qn, on Vj, where [formula],

[formula]

[formula]

Considering the fact that [formula], the projection of the left and the right side of are equal and therefore the pair (U,V) of the Type B is a nontrivial solution. It is easy to see that |X|  =  |Y|  =  1, the corresponding spaces of dimension n - 1 are Vm and Um.

Prove the second part. Let (U,V) be a nontrivial solution with |X|  =  |Y|  =  1. At first, note some properties of the spaces in V and U. From (d), Um  ⊂  Vi and Vm  ⊂  Ui for all [formula]. As a result, using (b), [formula] and [formula] for all [formula]. Also, [formula] for [formula]. From (c), all the spaces Vm, Um and Zij, [formula] are different.

Let a,b,c∈W be three vectors, such that Vm  =  〈a〉K, Um  =  〈b〉K, Z11  =  〈c〉K. From the properties that we mentioned above, the spaces Vm, Um and Z11 are all different so the vectors a,b,c are pairwise linearly independent. Obviously, V1  =  〈b,c〉K and U1  =  〈a,c〉K. (a) states that V1  ≠  U1 and thus all three vectors a,b,c∈W are linearly independent.

The plane U1 is covered by m different lines [formula]. Let [formula] be such that Z1i  =  〈vi〉K for [formula]. In the same way, the plane V1 is covered by the lines [formula]. Let Zi1  =  〈ui〉K, for some ui∈W, where [formula].

In there are illustrated the intersections of the spaces [formula], [formula]. Note that if we calculate the union of all spaces in a row of the table, we get the space that corresponds to the row. The same is for the columns of the tables. To satisfy this requirement, for all [formula], vi∈〈a,c〉K, ui∈〈b,c〉K, Vi  =  〈b,vi〉K and Ui  =  〈a,ui〉K. Hence vi  =  αia  +  βic, ui  =  γib  +  δic for some αi,βi,γi,δi∈K, [formula]. Then [formula]. After computations we get Zij  =  〈δiαja  +  γiβjb  +  δiβjc〉K or the same, since bj  ≠  0 and δi  ≠  0, [formula]. As we have mentioned before, all the spaces Zij for [formula] should be different, thus the values [formula] and [formula] should both run through K while i runs through [formula]. As a result, we showed that the pair (U,V) is, up to an order of spaces in tuples, exactly of the Type B.

Say that a pair (U,V) if of Type C, if there exist a subspace S  ⊂  W and linearly independent vectors a,b,c,d∈W, where [formula], such that Vi  =  〈S,αia  +  βib,αic  +  βid〉K and Ui  =  〈S,αia  +  βic,αib  +  βid〉K, where

[formula]

In there is presented the inclusion diagram of spaces in a pair of Type C along with intersections.

A pair (U,V) of Type C is a nontrivial solution with |X|  =  |Y|  =  0. If a pair (U,V) is a nontrivial solution with |X|  =  |Y|  =  0, then (U,V) is equivalent to a solution of Type C.

To simplify both parts of the proof, according to and , we can assume S  =  {0} and n  =  2.

Prove the first part. Calculate the intersection of the spaces, [formula], for [formula]. After computations we get Zij  =  〈αiαja  +  βiαjb  +  αiβjc  +  βiβjd〉K. All the spaces Zij for [formula] are different. From , [formula], for any [formula]. Note that [formula], for [formula].

We calculate for [formula] the restriction of both sides of , multiplied by qn, on the space Vj,

[formula]

[formula]

Obviously, the pair (U,V) of Type C satisfy these equations for any [formula], and therefore is a nontrivial solution with |X| = |Y|  =  0.

Prove the second part. Let (U,V) be a nontrivial solution with |X|  =  |Y|  =  0. Using , and the fact that the right sides of and are equal, for the fixed j, [formula]. From for all [formula], [formula]. In the same way for all [formula], [formula]. From for all [formula], dim KZij  =  n - 1 and the spaces Zij, [formula] are all different.

Let a,b,c,d∈W be such that Z11  =  〈a〉K, Z12  =  〈b〉K, Z21  =  〈c〉K and Z22  =  〈d〉K. We deduce that V1  =  〈a,c〉K, V2  =  〈b,d〉K, U1  =  〈a,b〉K and U2  =  〈c,d〉K. The intersection [formula] and dim KV1  =   dim KV2  =  2 that implies the linearly independence of the vectors a,b,c,d.

Consider the where in the cells there are the one-dimensional spaces [formula]. The union of the lines in each row gives the space that represents the row and the union of the lines in each column gives the space that represents the column.

Let αi,βi,α'i,β'i,γi,δi,γ'i,δ'i∈K be such that Z1i  =  〈αia  +  βib〉K, Zi1  =  〈γia  +  δic〉K, Zi2  =  〈γ'ib  +  δ'id〉K and Z2i  =  〈α'ic  +  β'id〉K for [formula]. With the defined coefficients we get Vi  =  〈αia  +  βib,α'ic  +  β'id〉K and Ui  =  〈γia  +  δic,γ'ib  +  δ'id〉K. Since all the spaces Zji, [formula] should be different, the equalities αi'βi  =  βi'αi, γ'iδi  =  δi'γi hold for all [formula] and the intersection space is Zji  =  〈αiγja  +  γjβib  +  αiδjc  +  δjβid〉K. It is easy to verify that (U,V) is of Type C.

Let (U,V) be a nontrivial solution of with m  =  |K|  +  1. Up to an equivalence, the pair (U,V) is of one of the following types: Type A, Type B or Type C.

If max 1  ≤  i  ≤  q + 1 dim KVi  ≠   max 1  ≤  i  ≤  q + 1 dim KUi, by , (U,V) is equivalent to a pair of Type A. If max 1  ≤  i  ≤  q + 1 dim KVi  =   max 1  ≤  i  ≤  q + 1 dim KUi, by , either |X|  =  |Y|  =  1 or |X|  =  |Y|  =  0. In the first case, using , (U,V) is equivalent to a pair of Type B. In the first case, using , (U,V) is equivalent to a pair of Type C.

After the full description and classification of all the nontrivial minimal solutions have been made, we can prove some interesting facts on their properties.

Let m  =  q + 1. For any tuple of spaces V there exists at most one tuple of spaces U, up to an equivalence, such that (U,V) is a nontrivial solution.

The statement is obvious for the solution of Type A. By and , we can assume S  =  {0}. Consider the solution (U,V) of Type B. Having the tuple U we can uniquely, up to equivalence, recover the tuple V. Really, at first, we recover the space Vm  =  〈a〉K as the intersection of any two two-dimensional spaces and we already have Um  =  〈b〉K. Assume that there exists another solution (U,V'), where [formula]. But then V'i  =  〈b,xi〉K, xi∈U1 for [formula], where [formula] is a set of all lines in U1. Therefore V  ~  V'.

Consider the solution (U,V) of Type C. Using the notations from , the vector a + c is in V1 and in Ui, for some [formula]. Let (U,V') be another solution. For this solution let [formula] be such that [formula] and [formula]. Also, let c',d'∈W be such that [formula] and [formula]. Then V'i  =  〈a,c'〉K, V'j  =  〈b,d'〉K. The vector a  +  c should be presented in some intersection with V'k, for [formula]. This is only possible if 〈c〉K  =  〈c'〉K. In the same way, observing the vector b + d, we deduce 〈d'〉K  =  〈d〉K and thus V  ~  V'.

Let (U,V) be a nontrivial solution with m  =  q + 1. For any [formula], for any [formula], Vk,Uk  ⊆  Vi  +  Vj. For any [formula], [formula].

The description of all the nontrivial solutions for the codes of the length m  =  q  +  1 is given in . Let [formula] and fix [formula], i  ≠  j. If the solution is of Type B, then the space Vi + Vj is of dimension dim KV1  +  1  =  n  +  1 and contains all the spaces [formula]. If the solution is of Type C, then the space Vi  +  Vj has the dimension dim KV1 + 2  =  n  +  2 and contains all the spaces [formula]. Regarding the solution of Type A, depending on which tuple of spaces we observe, the space Vi  +  Vj contains all the spaces from the tuple and has the dimension n or n + 1. Combining these three cases, all the spaces [formula] are in the space Vi  +  Vj and therefore the spaces [formula] are all in Vi  +  Vj. Also, dim KVi  +  Vj  ≤  n  +  2.