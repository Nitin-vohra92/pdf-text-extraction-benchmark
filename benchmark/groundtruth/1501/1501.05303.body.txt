Cosmic Web Reconstruction through Density Ridges: Method and Algorithm

Shirley Ho,2,3 Peter E. Freeman,1,3 Christopher R. Genovese,1,3 Larry Wasserman1,3 1Department of Statistics, Carnegie Mellon University, Pittsburgh, PA 15213, USA 2Department of Physics, Carnegie Mellon University, Pittsburgh, PA 15213, USA 3McWilliams Center for Cosmology, Department of Physics, Carnegie Mellon University, Pittsburgh, PA 15213, USA

Introduction

Observations of the local universe made over the last four decades show that on megaparsec scales, matter is distributed in web-like structures-  clusters, filaments, sheets, and voids-  that arise naturally from the non-linear evolution of initially small density fluctuations [\citep=Peebles1980] [\citep=Bond1996] [\citep=Jenkins1998] [\citep=Colberg2005] [\citep=2005Natur.435..629S] [\citep=2006MNRAS.370..656D]. Of particular interest to us are the filaments, one-dimensional structures that connect galaxy clusters and form at the boundaries of empty voids. Filaments are of interest for several reasons. The detection and characterization of filaments at a range of redshifts provides a means by which cosmologists can constrain theories of the universe's evolution [\citep=Bond1996] [\citep=2009ApJ...706..747Z] [\citep=2013ApJ...779..160Z]. Filaments also influence the shape, angular momentum, and peculiar velocities of dark matter haloes [\citep=2007MNRAS.381...41H] [\citep=2007MNRAS.375..489H] [\citep=2008MNRAS.389.1127P] [\citep=2009MNRAS.398.1742H] [\citep=2009ApJ...706..747Z] [\citep=Jones2010] [\citep=2013ApJ...779..160Z] [\citep=ForeroRomero2014], as well as the intrinsic alignments and luminosities of nearby galaxies [\citep=2015ApJ...800..112G] [\citep=2014arXiv1402.3302C] [\citep=codis2014].

As the review of [\cite=Cautun2014] amply demonstrates, the detection of filamentary structure is a non-trivial problem for which many solutions have been proposed. These solutions include methods that examine the Hessian matrix of the galaxy density field, such as the Multiscale Morphology Filter (MMF; [\citealt=AragonCalvo2007] [\citealt=2010MNRAS.408.2163A]) and NEXUS and NEXUS+ [\citep=Cautun2013], as well as segmentation-based methods, such as the Candy model [\citep=Stoica2007] [\citep=2005A&A...434..423S], the skeleton [\citep=2006MNRAS.366.1201N], the Spine method [\citep=2010ApJ...723..364A], and DisPerSE models [\citep=2011MNRAS.414..350S], and the path density method [\citep=Genovese2009]. While all of these methods provide estimates of filamentary structure, none provide an assessment of estimator uncertainty. The fact that filament estimates are random sets presents a significant challenge to the construction of valid uncertainty measures [\citep=Molchanov2005].

In this paper, we introduce a new method for filament detection based on the Subspace Constrained Mean Shift (SCMS) algorithm of [\cite=Ozertem2011]. The statistical properties of SCMS were studied in [\cite=2012arXiv1212.5156G]. The mathematical properties of density ridges and the statistical consistency of SCMS are discussed in [\cite=Eberly1996] [\cite=2012arXiv1212.5156G], and [\cite=2014arXiv1406.5663C], respectively, while [\cite=2014arXiv1406.5663C] introduce an uncertainty measure to the ridge formalism that allows one to quantitatively assess, in the context of the current paper, putative cosmic filaments.

In §2, we describe the SCMS algorithm and the methods we use to assess the uncertainty of its filament estimates. In §3, we apply SCMS, first to a P3M N-body simulation output [\citep=2015arXiv150702685T], and then to low-redshift (0.235 ≤  z  ≤   0.240) and high-redshift (0.530 ≤  z  ≤   0.535) data collected by the Baryon Oscillation Spectroscopic Survey (BOSS), which was released as part of SDSS Data Release 11. We also demonstrate the consistency between filaments detected by SCMS and galaxy clusters listed in the redMaPPer catalog. In §4 we summarize our results and offer possible avenues for future methodological development. In Appendix A we provide further detail on how to optimally select values for the tuning parameters of the SCMS algorithm, while in Appendix B we apply the algorithm to labeled simulated data generated via the Voronoi model of [\citep=1994A&A...283..361V] to show that it preferentially detects structures labeled as filaments. In a second paper, we will provide a full catalogue of filaments detected in SDSS data.

Subspace Constrained Mean Shift: Algorithm

Density Ridge Formalism

Assume that we observe n galaxies with locations [formula] that are d - dimension points; for data from typical astronomical surveys, d = 2 (if the galaxies are constrained to a redshift shell) or d = 3. We model [formula] as random variables sampled from an unknown density function p.

Formally, a density ridge [\citep=Eberly1996] [\citep=Ozertem2011] [\citep=2012arXiv1212.5156G] [\citep=2014arXiv1406.5663C] [\citep=2014arXiv1406.1803C] of p is defined as follows. Let [formula] and H(x) be the gradient and Hessian, respectively, of p(x) and let [formula] be the eigenvectors of the Hessian matrix, with associated eigenvalues [formula]. We define V(x) to be the matrix of all eigenvectors orthogonal to the first,

[formula]

SCMS: Filament Detection

The algorithm consists of three steps described below and listed in Algorithm [\ref=alg::FE]. The first is to estimate the underlying density function p(x) given [formula], the observed locations of galaxies. We use the standard kernel density estimator (see e.g. [\citealt=AllNonPar]):

[formula]

where K(  ·  ) is the smoothing kernel (e.g. a Gaussian), [formula] is the Euclidean distance between the point x and the ith galaxy location Xi, and h is the smoothing bandwidth (the selection of which is discussed in Appendix [\ref=sec::parameters]).

In the second step, we denoise by applying a threshold to the estimated density function p̂(x) to eliminate the effect that galaxies in low-probability density regions, i.e. where p̂(x)  <  τ, would have on filament estimation. How one selects τ is also discussed in Appendix [\ref=sec::parameters]. The denoising step is not part of the original SCMS algorithm but is important to increase its statistical power in low-density regions (see Figure [\ref=fig:SCMSvsSCMS]. We note that a thresholding step is included in several filament-detection algorithms, including those of e.g. [\cite=2006MNRAS.366.1201N] and [\cite=2011MNRAS.414..350S].

For the final step, given a set of galaxies in high-density regions, we apply the original version of the SCMS [\citep=Ozertem2011] to detect filamentary structures. Given a point x on a defined, uniform mesh, SCMS moves it according to an "estimated projected gradient" given by

[formula]

where V̂(x),ĝ(x) are estimates of the quantities V(x),g(x) that we define above in Section [\ref=sec::ridges]. One may view this procedure as estimating a ridge set R by applying the Ridge operator to p̂:

[formula]

Essentially, R̂ is very similar to the filaments defined in [\cite=2008MNRAS.383.1655S] [\cite=2010MNRAS.409..156B] [\cite=2010MNRAS.406..320C]. Note that a putative filament is, in the context of this algorithm, a set of points and not a one-dimensional curve. In Step 4 of Algorithm [\ref=alg::FE], We further describe how we apply SCMS. In Figure [\ref=fig::SCMS], we illustrate the application of SCMS to uniform mesh of points, and in Figure [\ref=fig:SCMSvsSCMS] we demonstrate the importance of the thresholding step: the left and right panels show putative filaments detected without and with thresholding, respectively. We observe that thresholding greatly decreases the rate of false filament detection.

SCMS: Filament Uncertainty Estimation

We quantify the uncertainty in the filament estimates produced by SCMS using the concept of local uncertainty [\citep=2014arXiv1406.5663C]. The local uncertainty in an estimated filament R̂ at a point x on the true filament R is the expected distance between x and the closest point to x on R̂. This is denoted by ρ(x) and is given by:

[formula]

where [formula] and the notation [formula] denotes the expected value operator. ρ(x) is the radius of a local confidence ball that surrounds the point x: the more uncertain the true location of the estimated filament, the larger the value of ρ(x). We estimate ρ(x), which is defined as a function of the unknown density field p and the unknown filament set R, by utilizing bootstrap resampling.

In this paper, we consider both the original version of bootstrap [\citep=Efron1979] and the smooth bootstrap. The smooth bootstrap (see e.g. [\citealt=SilvermanSmooth]) is a variant of the bootstrap that is useful in functional estimation problems in which the bootstrap sample is drawn from the estimated density p̂ instead of the original data. When the smoothing kernel is a bivariate Gaussian, we generate the smooth bootstrap sample via the following two steps:

Generate the bootstrap sample.

Add independent and identically distributed Gaussian noise with variance h2.

Unlike the bootstrap, the smooth bootstrap takes into account both the variance and the bias of filament estimation, but with less precision in variance estimation with respect to the bootstrap.

Assume we generate B bootstrap samples, and each of them is denoted as [formula], [formula]. For each bootstrap sample, say [formula], we compute the density estimate p̂* (b), the ridge estimate R̂* (b)  =  (p̂* (b)), and the confidence ball radii ρ(b)(x) for all x∈R̂. We estimate ρ(x) by adding the B radius estimates in quadrature:

[formula]

In Algorithm [\ref=alg::UM] we outline the computational steps that one must follow to derive (x).

Note that calculating the uncertainty measure is not part to the SCMS algorithm-we can detect filaments without using the uncertainty measure. However, this uncertainty measure is a feature that SCMS filaments have. This measure has a geometric interpretation and can be consistently estimated. See [\cite=2014arXiv1406.5663C] for more involved discussion. Note that other filament finders do have have such a statistically consistent error measurement.

SCMS: Boundary Bias

When computed with a kernel density estimator as in equation [\eqref=eq::KDE], SCMS filament estimates suffer from boundary bias within ~   two bandwidths of the edge of the observation region. This is a systematic deviation from the true filament caused by the density estimator averaging over a region where no data can be observed, and it can degrade the confidence band coverage probabilities near the boundary. One remedy for boundary bias is to include additional data immediately outside of the region of interest. Including galaxies within 2h of the boundaries eliminates most of the boundary bias, since very little of the volume under a bivariate Gaussian kernel lies beyond that point. If one cannot include additional data points outside the boundaries (for instance, due to overall survey limits), then one must be careful when interpreting filaments detected near the boundaries.

Filament Coverage

Here we introduce some useful geometric concepts about coverage. Given two sets A and B. The coverage of B by A is defined as

[formula]

Note that when A and B are curves, they will contain infinite number of points. In this case, we will replace 'number of points in' by 'the length of'. Similarly, we can define the coverage of A by B as [formula].

Given two collections of filaments R1 and R2, since R1 and R2 are curves so that they may not intersect each other in general so that the coverage is 0. Thus, instead of directly compute their coverage, we consider a flatten version of R1 (and R2 respectively). We define

[formula]

as the r-flatten set of R1. Then we define the coverage of R2 by R1 as a function of r as

[formula]

Similarly, we can define [formula]. The two functions [formula] and [formula] contain information about the similarity between R1 and R2.

In simulation, we are able to define true filaments, say Rtrue, and we will have an estimate filament, denoted as R̂n. Then we call the quantity [formula] the true positive coverage (ratio of true filaments being covered by estimated filaments) and we call [formula] the false positive coverage ([formula] is the ratio of estimated filament being covered by truth so that 1 minus this ratio is the ratio of false positive). See Figure [\ref=fig::TPFP] for an example of true positive and false positive coverage.

Combining the uncertainty measures and the coverage, we can study the properties of the uncertainty band.. An uncertainty band for a detected filament is simply the union of the confidence balls computed for each point on the filament, i.e.

[formula]

where [formula] represents the set of points within a ball centered at x and with radius r. Denote the region within the uncertainty band as A. The coverage for A is then

[formula]

One can think of [formula] as the true positive coverage using a set A. For instance, if [formula], then on average, 80% of the points on any given true filament lie within its associated uncertainty band, and 20% lie outside the band. This interpretation of coverage differs from the standard interpretation of confidence band coverage, thus motivating our use of the term "uncertainty band" instead of "confidence band." Figure [\ref=fig::FCov] gives examples of the coverage for uncertainty bands Û(k) with k∈(0,3) and n  =  250 and 2500. As we observe in Figure [\ref=fig::FCov], the coverage percentage depends sensitively on the sample size n; thus, we cannot provide simple rules for converting kσ uncertainty bands to coverage percentages.

Subspace Constrained Mean Shift: Applications

Voronoi Dataset

To show the effectiveness of capturing filaments, we compare the SCMS filaments (density ridges) to the filaments in the Voronoi model. The Voronoi model [\citep=1994A&A...283..361V] applies Voronoi tessellation to compute a density estimate for galaxies as well as the curvature of that estimate. Given a curvature estimate, the Voronoi method assigns a class label to each galaxy, indicating the type of large-scale structure to which to associate the galaxy. There are four possible classes: cluster, filament, wall, and void.

We use the SCMS algorithm to analyze a simulated dataset (2563 galaxies, each with a class label, that span a 100  ×  100  ×  100 Mpc3 box) generated with the Voronoi model (M. A. Aragón-Calvo, private communication). Figure [\ref=fig::voro] shows a comparison between our density ridges (blue curves) and galaxies with different class labels (brown: cluster; red: filament; green: wall; pink: void). The two methods generate remarkably similar results: Voronoi clusters (i.e. galaxies labeled cluster) occur at the intersection points of density ridges; Voronoi filaments surround the density ridges; and Voronoi walls span surfaces on which the density ridges lay.

To further quantify the association between density ridges and each Voronoi model class, we study their projection distances onto each other. Note that the distribution of projection distances is related to filament coverage; further discussion of this may be found in [\cite=2015arXiv150602278C]. Figure [\ref=fig::voro2] displays the distributions of projection distances. In both panels, we see that the distribution for ridges versus the Voronoi filaments peaks at distances [formula] 1 h- 1Mpc This indicates that the density ridges and the Voronoi filaments are very similar. On the other hand, the projection distances from the density ridges increases as we consider clusters, walls, and voids; the distributions exhibit increasing positive skewness.

P3M N-body Simulation

To further demonstrate the efficacy of SCMS, we apply it to P3M N-body simulations from [\cite=2015arXiv150702685T], which assume a ΛCDM cosmology with Ωm = 0.3, Ωl = 0.7, Ωb = 0.045, h = 0.7, σ8 = 0.8 and ns = 0.96. Each side of the simulation box is of length 1 Gpc/h, and each contains 20483 particles.

In Figure [\ref=fig::simN1], we demonstrate that, as sample size increases, SCMS outputs filament estimates that are closer to the true filaments (defined by the true density function); the uncertainty measures capture SCMS errors due to the sampling variability. We take a slice of the full simulation data (x,y∈[125,375] Mpc/h and z∈[100,105] Mpc/h) and smooth the data with smoothing bandwidth h = 5 (recommended by the selection rule in Appendix [\ref=sec::parameters] with A0 = 0.4) to get the density function and the filaments (cyan curves). Figure [\ref=fig::simN1](a) shows a contour plot for the density function. The original sliced data contains 88,406 points (gray dots). We downsample to get three different subsamples; each contains 250 / 2500 / 10000 particles. For each subsample (black dots), we apply SCMS to detect filaments (blue curves). Note that the convergence phenomena of Figure [\ref=fig::simN1] are further quantified by the true positive and false positive coverage plot in Figure [\ref=fig::TPFP].

Note that the sparsest subsample n = 250 has a galaxy number density 5.56  ×  10- 4 Mpc- 3 which is similar to the number density observed in SDSS CMASS data ([formula] Mpc- 3). The future survey Wide-Field Infrared Survey Telescope (WFIRST), a NASA mission with science objectives in exoplanet exploration, dark energy research and galactic and extragalactic surveys, will observe a number density similar to the n = 2500 subsample ([formula] Mpc- 3).

We show the uncertainty measures and filament coverage for n = 2500 in Figure [\ref=fig::FCov]. We plot filament coverage for confidence regions Û(k) for k∈(0,3) in Figure [\ref=fig::FCov](a), where n = 250 and 2500, and where [formula] is estimated by both the bootstrap (BT) and the smooth bootstrap (SB). This range contains sample sizes that are in line with both CMASS (n  ≈   250) and WFIRST (n  ≈   2500) data. We observe that filament coverage is, as noted above, sensitive to the sample size n and that the smooth bootstrap provides considerably more conservative confidence bands, particularly for [formula]. The gray regions displayed in Figure [\ref=fig::FCov](b) are the smooth bootstrap confidence regions Û(1), which we estimate contain 85% of the true filaments (cyan curves).

Figure [\ref=fig::bdy] illustrates the effect of boundary bias in the n = 2500 subsample by comparing the estimates and uncertainties with padded and unpadded data near the boundary. Panels (a) and (b) show the boundary bias. Note that the red curves are filaments estimated by using only points within the boundary (given by the orange rectangle). The blue curves are filaments detected by SCMS with boundary points (i.e. points outside the orange rectangle). As can be seen, the estimation of filaments without boundary data (red curves) becomes more inaccurate as we approach the boundary. The boundary bias occurs for filaments with distances less than 10 Mpc/h (2 times smoothing parameter h) to the boundaries. The uncertainty measures also show the influence of boundary bias. Figure [\ref=fig::bdy](c) and [\ref=fig::bdy](d) exhibit the uncertainty measures for filaments estimated with and without boundary points. As expected, the uncertainty measures in panel (d) increase as we move close to the boundary.

Sloan Digital Sky Survey

Data

We further demonstrate the efficacy of SCMS by applying it to data from Data Release 12 [\citep=2015arXiv150100963A] of the Sloan Digital Sky Survey [\citep=2000AJ....120.1579Y]. Together, SDSS I, II [\citep=2009ApJS..182..543A], and III [\citep=2011AJ....142...72E] used a drift-scanning mosaic CCD camera [\citep=1998AJ....116.3040G] to image over one third of the sky (14,555 square degrees) in five photometric bandpasses [\citep=1996AJ....111.1748F] [\citep=2002AJ....123.2121S] [\citep=2010AJ....139.1628D] to a limiting magnitude of r≃22.5, using the dedicated 2.5-m Sloan Telescope [\citep=2006AJ....131.2332G] located at Apache Point Observatory in New Mexico. The imaging data were processed through a series of pipelines that perform astrometric calibration [\citep=2003AJ....125.1559P], photometric reduction [\citep=2001ASPC..238..269L], and photometric calibration [\citep=2008ApJ...674.1217P]. All of the imaging was reprocessed as part of SDSS Data Release 8 (2011ApJS..193...29A; [\citealt=2011ApJS..193...29A]).

The Baryon Oscillation Spectroscopic Survey (BOSS) has obtained spectra and redshifts for 1.35 million galaxies over a footprint covering 10,000 square degrees. These galaxies are selected from the SDSS 2011ApJS..193...29A imaging and are being observed together with 160,000 quasars and approximately 100,000 ancillary targets. The targets are assigned to tiles of diameter [formula] using a 2003AJ....125.2276B algorithm that is adaptive to the density of targets on the sky [\citep=2003AJ....125.2276B]. Spectra are obtained using the double-armed BOSS spectrographs [\citep=2013AJ....146...32S]. Each observation is performed in a series of 900-second exposures, integrating until a minimum signal-to-noise ratio is achieved for the faint galaxy targets. This ensures a homogeneous data set with a high redshift completeness of more than 97 percent over the full survey footprint. Redshifts are extracted from the spectra using the methods described in [\cite=2012AJ....144..144B]. A summary of the survey design appears in [\citet=2011AJ....142...72E], and a full description is provided in [\citet=2013AJ....145...10D].

BOSS selects two classes of galaxies to be targeted for spectroscopy using SDSS 2011ApJS..193...29A imaging: 'LOWZ' and 'CMASS' (we refer the reader to [\citet=And13] for further description of these classes). For the LOWZ sample, the effective redshift is zeff = 0.32, slightly lower than that of the SDSS-II luminous red galaxies (LRGs) as we place a redshift cut z < 0.43. The CMASS selection yields a sample with a median redshift z  =  0.57 and a stellar mass that peaks at [formula] [\citep=2013MNRAS.435.2764M]. Most CMASS targets are central galaxies residing in dark matter haloes of mass [formula].

We test SCMS using two slices of data: at low and high redshift. The low-z dataset comprises 1,158 galaxies in the volume

[formula]

while the high-z dataset lies in the volume

[formula]

and contains 4,678 galaxies. Both samples have a very thin redshift range Δz  =  0.005 (the corresponding comoving distance is around 14 - 21 Mpc) so that their constituent galaxies may be viewed as lying on a two-dimensional surface with coordinates (RA,δ).

There are two principal reasons for our choice to perform a two-dimensional analysis of the SDSS data. The first is that there is too large a change in the number density of detected galaxies over the SDSS redshift range. The SCMS algorithm incorporates kernel density estimation to locate density ridges, and KDE requires a fixed smoothing parameter h. However, in low-density regions, h should be large to obtain reliable results, while in high-density regions, h has to be small so as to not oversmooth the point cloud. The second reason is that when z > 0.2, the number density is very low, and performing a three-dimensional analysis will produce results with large statistical errors due to the small sample size. Lower-dimensional analyses result in decreased statistical error; see e.g. [\citealt=AllNonPar].

Results

We apply SCMS to the low-z data with smoothing bandwidth [formula] (41.8 Mpc) and threshold level τ  =  1.02  ×  10- 3; we display our results in Figure [\ref=fig::FE1]. For the high-z data, h and τ are [formula] (71.1 Mpc) and [formula], respectively; we display our results in Figure [\ref=fig::FE2]. Note that we have included additional galaxies within 5 degrees of our selected window to mitigate boundary bias.

As can be seen in Figures [\ref=fig::FE1] and [\ref=fig::FE2], SCMS filament estimates capture high density regions and they exhibit one-dimensional, nearly connected structures. In addition, SCMS yields smooth filaments; most filament estimators do not output such smooth structures [\citep=Stoica2007] [\citep=2005A&A...434..423S] [\citep=2011MNRAS.414..350S] [\citep=Aanjaneya2012] [\citep=2013arXiv1305.1212L]. We note that the filaments detected by SCMS will not actually connect with each other; points on merging filaments have eigengap β (equation [\ref=eq::eigengap]) that asymptote toward 0, making the density ridge ill-defined since the first and second eigenvalues become equal. We note that in both figures there are possibly spurious filaments; for instance, in Figure [\ref=fig::FE1], at (RA,δ)[formula] and [formula], we see filaments that are associated with a relatively small number of galaxies. As we demonstrate below, these putative filaments have higher estimates of uncertainty.

We derive the uncertainties for the filament estimators as described in Section [\ref=sec::LU] from the two test datasets; the results for low-z and high-z samples are given in Figures [\ref=fig::LU1] and [\ref=fig::LU2], respectively. We visualize local uncertainty using color, where red indicates locations where the filamentary structure is highly uncertain. We also display uncertainty regions as bands of varying width (shown in gray) centered on the filaments. Our simulation study in Section [\ref=sec::simulation] indicates that the filament coverage [formula] for the regions in Figures [\ref=fig::LU1](a) and [\ref=fig::LU2](a) is ≈  45%, while that in Figures [\ref=fig::LU1](b) and [\ref=fig::LU2](b), is ≈  60%. We find that the overall structure for filaments in the high-z dataset is more stable than for the low-z data, due to the significantly larger size of the high-z dataset; as shown in Figure [\ref=fig::simN1], sample size plays a crucial role in determining the size of the uncertainty regions associated with SCMS filament estimates.

As can be inferred from Figures [\ref=fig::LU1] and [\ref=fig::LU2], our measures of local uncertainty provide useful information to determine the quality of filament detections. We declare a point x∈R̂ to be 'unstable' if

[formula]

where [formula] is the mean of uncertainty over all filament points and σρ is the root mean square of uncertainty. Namely, if the local uncertainty at x is too large, this point is not stable. The constant 1.69 comes from the width of 90% confidence interval for a Gaussian distribution. For instance the two filaments at (RA,δ)[formula] and [formula] in Figure [\ref=fig::FE1] appear by eye to be spurious, given the relative lack of galaxies in their vicinity. Based on the uncertainty measures and our stability test [\eqref=eq::sig], these filaments are declared as unstable (yellow color in Figure [\ref=fig::LU1]).

Test Data: Comparison to redMaPPer Clusters

As one last demonstration of the efficacy of SCMS, we examine the consistency between our filament maps and the galaxy clusters in the redMaPPer catalog [\citep=2014ApJ...785..104R] [\citep=2014ApJ...783...80R] [\citep=2015MNRAS.450..592R]. We make this comparison within the window

[formula]

and within annuli of width Δz  =  0.005 from zlo = 0.100 to zhi = 0.500 (a range that includes 10,602 galaxy clusters with spectroscopically determined redshifts, or 93.1% of the redMaPPer sample). Note that we also include SDSS DR7 main sample galaxy from NYU VAGC [\citep=2005AJ....129.2562B] [\citep=2008ApJ...674.1217P] [\citep=2008ApJS..175..297A] to detect filaments for low redshift regions (z < 0.25). We slice the data primarily for computational efficiency, since SCMS is an O(n2) algorithm, but slicing has the ancillary benefit of simplifying visualization. In total we examine 80 slices, each of which contains ≈  100 galaxy clusters. Within each slice, we determine optimal values of h and τ using the criteria described in Appendix [\ref=sec::parameters].

In Figure [\ref=fig::BCG], we display SCMS-detected filaments along with redMaPPer clusters (in red). As can be seen, nearly all galaxy clusters are associated with detected filaments. Qualitatively similar results hold for all other slices. To quantify the association of galaxy clusters and filaments, we compare the distance to filaments for three types of objects: galaxy clusters, galaxies and randomly generated points within the regions where galaxies are observed. We divide the whole redshift range z = 0.100 - 0.500 evenly into 8 sub-regions (each sub-region contains 10 slices); within each sub-region we compute distance statistics. Ideally, galaxy clusters should be systematically closer to filaments than galaxies are, and both galaxies and galaxy clusters should be far closer to filaments than randomly generated points. Figure [\ref=fig::DP] and Table [\ref=tab::RM] confirm this hypothesis. Figure [\ref=fig::DP] shows the cumulative distribution for these distance statistics. For a collection of values [formula], the cumulative distribution function (CDF) is a non-decreasing function ranging from 0 to 1 defined as

[formula]

Both galaxies (blue curves) and galaxy clusters (red curves) tend to be much closer to the filaments than random points; this suggests that galaxies and galaxy clusters are indeed concentrated around the detected filaments. When we compare galaxies and clusters, we observe that galaxy clusters are much more right-skewed in the CDF plot for every redshift sub-region. That is, galaxy clusters tend to distribute around low-distance-to-filament regions compared to a random galaxy. We conduct the two-sample, one-sided KS test [\citep=Stephens1974], which compares the distributions of distance statistics for galaxy clusters and randomly generated points, for all eight sub-regions. Table [\ref=tab::RM] shows the p-values, a statistical quantity measuring the significance of observations, for the eight KS tests that we carry out. A smaller p-value indicates stronger evidence for clusters being closer to a filament than galaxies. Typically, we declare significance as p-value being less than 0.05. We observe an increasing trend in p-value as the redshift increases, due to the decrease in the number density of galaxies along the line of sight. The sharp reversal in this trend at the last sub-region (z = 0.450 - 0.500) is due to the large size of the CMASS sample at z > 0.430: the number density of galaxies in our sample actually increases from z = 0.430 - 0.500.

Note that in Figure [\ref=fig::BCG], many clusters appear to be located near the intersections of filaments. However, we do not construct a statistics to summarize this phenomena since defining the intersections of filaments detected by SCMS is a non-trivial problem. The main difficulty is due to the 'gap' between filaments; the SCMS filaments will not intersect each other but with a small gap. This gap can be explained by the model of density ridges. In the density ridges model, we require the eigengap β > 0 (recall equation [\eqref=eq::eigengap]) to ensure the properties of filaments. Therefore, when one ridge merges with another, the eigengap vanishes at some point (i.e. β = 0). This leaves a small gap between one ridge and another.

Summary and Discussion

In this paper, we demonstrate how one may apply the Subspace Constrained Mean Shift (SCMS) algorithm of [\cite=Ozertem2011] to uncover filamentary structure in galaxy point cloud data. The density ridge model behind the SCMS algorithm ensures that galaxies will concentrate around detected filaments. In addition, we introduce an uncertainty measure for detected filaments that is based on the bootstrap, allowing us to study the significance of these filaments.

In §3 we first show that the SCMS filaments are very similar to the Voronoi filaments. Then we demonstrate the efficacy of our SCMS-based filament-finding algorithm by applying it both to P3M N-body simulation output and to SDSS DR 12 data (including the NYU main sample galaxy, LOWZ and CMASS datasets). By applying SCMS to simulated data, we are able to estimate the coverage of our bootstrap-generated uncertainty bands, i.e. the fraction of any one true filament that lies within its associated band (see Figure [\ref=fig::FCov]). We find that the coverage depends sensitively on the number of galaxies in an analyzed sample, with the smooth bootstrap algorithm generating more conservative uncertainty bands with 1σ coverage ≈  0.6-0.8 (cf. 0.683 for a 1σ confidence band) for galaxy number densities ≈  5 ×   10- 4 - 5 ×   10- 3 (densities observed/to be observed by SDSS CMASS and WFIRST, respectively).

In Figures [\ref=fig::FE1]-[\ref=fig::LU2], we show the results of applying the SCMS algorithm to SDSS spectroscopically observed galaxies in the redshift slices 0.235 ≤  z  ≤   0.240 and 0.530 ≤  z  ≤   0.535, respectively. To test the hypothesis that our estimated filaments are associated with real filamentary structures, we compare the distances between filaments and redMaPPer galaxy clusters, random field galaxies, and random points in the galaxy field. By using the one-sided, two-sample KS test, we find that we can safely reject the null hypothesis that galaxy clusters and field galaxies reside at similar distances from filaments; the p-values are [formula] (cf. the usual rejection criterion that p  <  0.05; see Table [\ref=tab::RM]).

The SCMS algorithm models filaments as one-dimensional ridges that trace high-density regions within the point cloud; as such, SCMS may be grouped with other filament-modeling algorithms that use the eigenvalues and eigenvectors of the Hessian matrix associated with the point cloud density function, such as MMF [\citep=AragonCalvo2007] [\citep=2010MNRAS.408.2163A] and NEXUS/NEXUS+ [\citep=Cautun2013]. However, in contrast to these methods, which output filament estimates as two-dimensional regions, SCMS filament estimates are smooth, one-dimensional curves; the filament orientations are well-defined. Also in contrast to these methods, we offer measures of uncertainty by augmenting the SCMS algorithm with bootstrap-based uncertainty estimation algorithms that allow one to e.g. place bands around putative filaments, whose relative sizes indicate uncertainty in filament location (as in e.g. Figure [\ref=fig:UMex]). We note that the segmentation-based DisPerSE algorithm of [\cite=2011MNRAS.414..350S] uses the persistence ratio, a metric encapsulating the evolution of topological structure in the galaxy field, to define the significance of putative filaments, but not their spatial uncertainty. Finally, we compare SCMS filaments to those generated by the Spine [\citep=2010ApJ...723..364A] [\citep=2014MNRAS.440L..46A] and Skeleton [\citep=2006MNRAS.366.1201N] algorithms. Both the Skeleton and Spine models look for ridges within a density field. However, the Skeleton model does not provide a means by which to compute density ridges. In contrast, the SCMS algorithm allows us to efficiently compute ridges of the field's kernel density estimate. The Spine method outputs ridges as points on grids, so that resolution is an issue. On the other hand, the SCMS algorithm yields points that are on continuous curves (ridges), so there is no resolution issue to address.

We conclude by stating that one may extend the use of the SCMS algorithm beyond the analysis of galaxy point cloud data. For instance, [\cite=2014arXiv1406.1803C] discuss how to apply the algorithm to pixelized image data; in particular, they modify the algorithm (calling it the weighted SCMS algorithm) to find intensity ridges caused by e.g. tidal tails. In addition, the authors also discuss how one would incorporate the mass of a galaxy to achieve a better estimate of the local density as well as of corresponding ridges.

Acknowledgments

We thank Hy Trac for providing the Nbody simulations and Rachel Mandelbaum for useful discussions. We also thank the referee Miguel A. Aragón-Calvo for useful comments and for providing the Voronoi dataset that we analyze in § [\ref=sec::voronoi]. This work is supported in part by the Department of Energy under grant DESC0011114; YC is supported by DOE; SH is supported in part by DOE-ASC, NASA and NSF; CG is supported in part by DOE and NSF; LW is supported by NSF.

Funding for SDSS-III has been provided by the Alfred P. Sloan Foundation, the Participating Institutions, the National Science Foundation, and the U.S. Department of Energy Office of Science. The SDSS-III web site is http://www.sdss3.org/.

SDSS-III is managed by the Astrophysical Research Consortium for the Participating Institutions of the SDSS-III Collaboration including the University of Arizona, the Brazilian Participation Group, Brookhaven National Laboratory, Carnegie Mellon University, University of Florida, the French Participation Group, the German Participation Group, Harvard University, the Instituto de Astrofisica de Canarias, the Michigan State/Notre Dame/JINA Participation Group, Johns Hopkins University, Lawrence Berkeley National Laboratory, Max Planck Institute for Astrophysics, Max Planck Institute for Extraterrestrial Physics, New Mexico State University, New York University, Ohio State University, Pennsylvania State University, University of Portsmouth, Princeton University, the Spanish Participation Group, University of Tokyo, University of Utah, Vanderbilt University, University of Virginia, University of Washington, and Yale University.

Parameter Selection

Our version of SCMS has two key parameters, the smoothing bandwidth h and the threshold level τ. In this section we show how we select optimal values for each.

The smoothing bandwidth h represents the amount by which we smooth the observed point cloud of galaxies when estimating p. One can choose h by applying prior knowledge or by letting h adapt to the sample. There is a large body of literature on the choice of bandwidth, e.g. [\cite=sheather2004density] and [\cite=Chacon2011] [\cite=chacon2013data]. Among all methods, we recommend choosing h via

[formula]

where A0 is a constant that we discuss below, n is the sample size, d is the dimension (in our case d = 2) and σmin is the minimal value for the standard deviation along each coordinate. Note that the reference rule [\eqref=eq::h] will choose smaller h values as the sample size increases.

If A0 is 1, [\eqref=eq::h] corresponds to Silverman's rule [\citep=Silverman1986]. Silverman's rule selects h via minimizing the mean integrated error

[formula]

when p is a Gaussian. When the data include filaments, p is no longer Gaussian and A0 must be optimized as a free parameter. A smaller A0 yields more filaments in a given dataset but more spurious filaments as well. There is no general rule for selecting A0 since the optimality criterion involves the unknown density p. Figure [\ref=fig::h] shows how varying A0 affects the estimation of filamentary structures. Our results indicate that the optimal A0 lies in the range

[formula]