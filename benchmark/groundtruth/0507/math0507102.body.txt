CorollaryPropositionLemmaDefinitionExampleHypothesisProblemRemark

On the strong consistency of asymptotic M-estimators

Introduction

After the seminal work of Fisher, the asymptotic properties of maximum likelihood estimators, and in particular their consistency, were studied by various authors, including Doob [\cite=MR1501765], Cramér [\cite=MR0016588], and Huzurbazar [\cite=MR0028000]. Nowadays, one of the best known result regarding consistency goes back to Wald, who gave in [\cite=MR0032169] a short and elegant proof of strong consistency of parametric maximum likelihood estimators. Since that time, several authors studied various versions of such consistency problems, including among others, Le Cam [\cite=MR0054913], Kiefer and Wolfowitz [\cite=MR0086464], Bahadur [\cite=MR0207085] [\cite=MR0315820], Huber [\cite=MR0216620], Perlman [\cite=MR0405668], Wang [\cite=MR803749], and Pfanzagl [\cite=MR944202] [\cite=MR1074441].

Wald's original proof relies roughly on local compactness of the parameter space, on continuity and coercivity of the log-likelihood, on the law of large numbers, and last but not least on local uniform integrability of the log-likelihood. It does not require differentiability, and makes extensive use of likelihood ratios. The integrability assumption has been weakened by many authors, including for instance Kiefer and Wolfowitz in [\cite=MR0086464] and Perlman in [\cite=MR0405668], see also [\cite=MR0315820]. One can find a modern presentation of Wald's method for M-estimators in van der Vaart's monograph [\cite=MR1652247].

Pfanzagl gave in [\cite=MR944202] [\cite=MR1074441] a proof of strong consistency of asymptotic maximum likelihood estimators for nonparametric "concave models" with respect to the estimated parameter, including nonparametric mixtures. His approach relies in particular on a simplification of an earlier work of Wang in [\cite=MR803749] based on uniform local bound of the likelihood ratio.

The present work was initially motivated by the inverse problems considered in [\cite=chafai-loubes]. Our aim is to simplify Pfanzagl's approach, and to extend the framework from asymptotic maximum likelihood to more general asymptotic M-estimators. In particular, log-likelihood ratios are replaced by contrast differences. The hypotheses appearing in our main Theorem are unnecessarily strong. However, they allow a simple and short presentation. We emphasize the role played by a sort of contraction map a* defined on the parameter space. We do not assume any coercivity of the contrast as in [\cite=MR0032169]. However, we require the compactness of the space of the estimated parameter, as in [\cite=MR0086464] and [\cite=MR1652247] for example. This compactness comes usually for free in the case of fully nonparametric models. We do not make use of any Uniform Law of Large Numbers. Our method does not belong to the Glivenko-Cantelli approaches of consistency, as in [\cite=MR1652319], [\cite=MR1797759], [\cite=MR1365666], [\cite=MR1652247] and [\cite=MR1973724] [\cite=MR1739079] and references therein.

Let Θ be a separable Hausdorff topological space with countable base. Let [formula] be a known family of Borel measures on a measurable space [formula]. Let θ*∈Θ be some unknown point of Θ such that P*: = Pθ* is a probability measure. Let [formula] be an i.i.d. sequence of observed random variables defined on a probability space [formula] and taking their values in [formula], with common law P*. Let [formula] be a sequence of random variables defined on [formula], taking their values in Θ, and such that [formula] is [formula]-measurable for any [formula], where [formula]. We say that [formula] is strongly consistent if and only if

[formula]

We use in the sequel the abbreviations "a.s." for almost sure, "a.a." for almost all, and "a.e." for almost everywhere. Let [formula] be a known function such that [formula] is measurable for any θ∈Θ. For any n, we define the random function [formula] by This can be written also [formula] where [formula] is the empirical measure. We say that (n)n is a sequence of asymptotic M-estimators if and only if

[formula]

The term asymptotic is used for the same notion (with the likelihood) by Pfanzagl in [\cite=MR944202]. In the literature, some authors, including Wald and Perlman, use the term approximate rather than asymptotic. However, the term approximate has been used by Bahadur in a different sense in [\cite=MR0315820].

For example, if for large enough n, there exists an [formula]-measurable n in Θ such that [formula], then such a random sequence [formula] fulfils [\eqref=eq:ame].

For any probability measure P on [formula], let [formula] (resp. [formula]) be the set of random variables [formula] such that Z+: =  max ( + Z,0) (resp. Z-: =  max ( - Z,0)) is in [formula]. On [formula], the expectation P(Z) = P(Z+) - P(Z-) makes sense and takes its values in [formula]. For any θ∈Θ such that [formula], we define the contrast [formula] by

[formula]

In the sequel, we say that the model is identifiable when for any θ∈Θ, the condition [formula] implies that θ  =  θ*.

One can notice that the observation of Lindsay in [\cite=MR684866] [\cite=MR707929] regarding the nature of maximum likelihood for nonparametric mixture models remains valid for more general models provided that m is concave.

Main result and Corollaries

With the settings given in the Introduction, the following Theorem holds.

Assume that Θ is compact and that the following assumptions hold.

For P*-a.a. [formula], the map m(  ·  ,x) is continuous on Θ;

There exists a continuous map a*:Θ  →  Θ which may depend on θ* such that for any θ  ≠  θ*, there exists a neighborhood V  ⊂  Θ of θ for which [formula] and [formula].

Then any sequence (n)n of asymptotic M-estimators is strongly consistent.

Postponed to section [\ref=se:proof:th:consistency-a-la-pf].

The quantity [formula] in (A[\ref=hyp:sep]) has a meaning in [formula] since the first part of (A[\ref=hyp:sep]) ensures that [formula]. Moreover, [formula] reads M*(θ) - M*(a*(θ)) when the couple [formula] is in [formula] or in [formula].

Since θ* is unknown in practice, each assumption in Theorem [\ref=th:consistency-a-la-pf] must hold for any θ*∈Θ such that Pθ* is a probability measure, in order to make the result useful.

The first part of (A[\ref=hyp:sep]) is in a way an M-estimator version of the integrability condition considered by Kiefer and Wolfowitz for the log-likelihood in [\cite=MR0086464]. The assumptions (A[\ref=hyp:cont]) and (A[\ref=hyp:sep]) required by Theorem [\ref=th:consistency-a-la-pf] can be weakened. However, they permit a streamlined presentation. In particular, only lower semi-continuity is needed in (A[\ref=hyp:cont]), see for instance [\cite=MR944202]. Additionally, and following for example [\cite=MR0405668], the uniform integrability assumption (A[\ref=hyp:sep]) can be weakened, by considering blocks of k > 1 observations instead of one observation, see also [\cite=MR1652247].

As stated in the following Corollary, Theorem [\ref=th:consistency-a-la-pf] implies a version of Wald consistency Theorem for asymptotic M-estimators, see [\cite=MR0032169], [\cite=MR0405668], and [\cite=MR1652247].

Assume that Θ is compact, and that for P*-a.a. [formula], the map m(  ·  ,x) is continuous on Θ. Assume that for any θ in Θ, there exists a neighborhood V such that [formula]. Assume in addition that M* achieves its supremum over Θ at θ*, and only at θ*. Then, any sequence of asymptotic M-estimators is strongly consistent.

One has [formula] for any θ in Θ, and thus [formula] is well defined. Moreover, (A[\ref=hyp:sep]) holds with a constant map [formula]. Namely, for any θ  ≠  θ*, one has on one hand [formula] since M*(θ) < M*(θ*), and on the other hand

[formula]

As stated in the following Corollary, Theorem [\ref=th:consistency-a-la-pf] implies the main result of Pfanzagl in [\cite=MR944202] for concave models, itself based on an earlier result of Wang in [\cite=MR803749]. This is typically the case for mixtures models, for which Θ is a convex set of probability measures on some measurable space, cf. section [\ref=se:mix].

Let Q be a reference Borel measure on [formula]. Consider the case where Θ is a convex compact subset of a linear space such that for any θ∈Θ, [formula] and [formula] with [formula] on [formula]. Suppose that Q-a.e. on [formula], the map [formula] is concave and continuous on Θ. Assume that the model is identifiable. Consider [formula] and the related log-likelihood Mn. Then any sequence of asymptotic log-likelihood estimators is strongly consistent.

First of all, we notice that it is not possible to take [formula] since we cannot ensure that the condition [formula] of (A[\ref=hyp:sep]) is true. However, the concavity of the model allows to take a map a* which is a strict contraction around θ*. Namely, for an arbitrary λ∈(0,1), let us take

[formula]

The concavity of the model yields

[formula]

Now, we have [formula] since λ < 1. Define the function [formula] by Φ(u): = u log (λu  +  (1 - λ)). The concavity of the model yields

[formula]

Let us show that the right hand side of the inequality above is strictly positive when θ  ≠  θ*. One has [formula] since [formula]. Define Ψ(u): = uΦ(1 / u). Jensen's inequality for the probability measure [formula] and the convex function Φ yields

[formula]

It is enough to show that either [\eqref=eq:J] is strict or the right hand side of [\eqref=eq:J] is strictly positive. Since λ > 0, the function Φ is strictly convex. Thus equality holds in [\eqref=eq:J] if and only if [formula] for some [formula]. The only admissible case is [formula] since [formula] and since identifiability forbids [formula]. Therefore, if [formula], inequality [\eqref=eq:J] is necessarily strict. On the other hand, Ψ(1) = 0 and Ψ(u) > 0 when u < 1. Thus the right hand side of [\eqref=eq:J] is always non negative, and is strictly positive as soon as [formula]. We conclude that [formula] as soon as θ  ≠  θ*. This shows that (A[\ref=hyp:sep]) holds with V = Θ, and the proof is thus complete.

Let a*:Θ  →  Θ be a map which satisfies the condition [formula] for any θ  ≠  θ* of (A[\ref=hyp:sep]). Then, the impossibility of [formula] for any θ yields that

a*(θ)  ≠  θ for any θ  ≠  θ*. In particular,

the map a* cannot be the identity map ;

if a* is constant, then [formula] ;

the point θ* is the only possible fixed point for a*.

The proof of Corollary [\ref=co:wald] gives an example where [formula] works and fulfills (A[\ref=hyp:sep]). In contrast, Corollary [\ref=co:pf] provides a situation where a constant a* does not fulfill (A[\ref=hyp:sep]). However, we have shown in the proof of Corollary [\ref=co:pf] that an a* map which is a strict contraction around θ* fulfills (A[\ref=hyp:sep]). Actually, when Θ has the structure of a convex subset of a vector space, any strict contraction around θ* fulfills the properties of a* listed above. The existence of a fixed point can be related to Brouwer-like fixed point Theorems. For instance, any continuous mapping of a non-empty compact convex subset of [formula] into itself contains at least one fixed point. Consequently, when Θ is a non-empty compact and convex subset of [formula], any continuous a* map admits θ* as a unique fixed point. There exists numerous dimension free Brouwer-like fixed points theorems, due to Schauder, Tikhonov, Kakutani, , see for instance [\cite=MR816732] and [\cite=MR1996163].

Theorem [\ref=th:consistency-a-la-pf] does not allow m to take the value -    ∞  . This limitation is due to the fact that differences of the form [formula] do not make sense if m is allowed to take the value -    ∞  . The consistency proof of Wald does not suffer from such a limitation since it does not rely on m differences, but it requires however strong uniform integrability assumptions. A careful reading of the proof of Theorem [\ref=th:consistency-a-la-pf] shows that only differences of the form [formula] are involved. On the other hand, according to Remark [\ref=rm:a-xtrm], a*(θ)  ≠  θ for any θ  ≠  θ*. Consequently, one may allow, in Theorem [\ref=th:consistency-a-la-pf], the map m(θ,x) to take the value -    ∞   for at most one value of θ. For the log-likelihood, [formula] and one has [formula] if and only if [formula]. One may allow [formula] for at most one value of θ in Corollary [\ref=co:pf].

Let θ∈Θ such that [formula]. Then, the law of large numbers applies and gives that P*-a.s., [formula], and the a.s. subset of [formula] may depend on θ. In particular Mn(θ) = M*(θ) + oP(1). For a sequence (n)n satisfying [\eqref=eq:ame], one can write for any θ∈Θ with finite Mn(θ)

[formula]

where the last step follows by [\eqref=eq:ame] and the law of large numbers.

Log-Likelihood and mixtures models

For any topological space [formula] equipped with its Borel σ-field, we denote by [formula] the set of probability measures on [formula], and by [formula] the set of bounded real valued continuous functions on [formula]. The Prohorov topology on [formula] is defined as follows: θn  →  θ in [formula] if and only if [formula] for any [formula]. It is known that a subset of [formula] is compact if and only if it is tight. As a consequence, [formula] is not compact in general. Following [\cite=MR944202], the set sub-probabilities provides a compactification which allows the following consistency result for asymptotic log-likelihood estimators of nonparametric mixture models.

Let [formula] be a locally compact Hausdorff topological space with countable base. Let Q be a measure on a measurable space [formula]. Let [formula] be such that [formula] for any [formula] and [formula] for any [formula]. Let [formula] and consider the family [formula] of probability measures on [formula] defined by [formula] with [formula]. Assume that the model is identifiable. Let [formula] be the map defined by [formula], and Mn be the corresponding log-likelihood. Then any sequence of asymptotic maximum likelihood estimators is strongly consistent for the Prohorov topology.

As explained above, [formula] is not compact for the Prohorov topology, and one must consider a suitable compactification, as in [\cite=MR0315820] for instance. Let [formula] be the set of real valued continuous functions on [formula] which vanish at infinity. Let [formula] be the set of Borel measures θ on [formula] such that [formula] (i.e. sub-probabilities), equipped with the vague topology related to [formula]. Namely, θn  →  θ in [formula] if and only if [formula] for any [formula]. The injection [formula] is continuous; [formula] is a compact metrizable topological space, and thus has a countable base. Moreover, [formula] is convex, and for any [formula], there exists θ'∈Θ and α∈[0,1] such that θ  =  αθ'.

We extend the set of probability measures [formula] on [formula] to the set of sub-probability measures [formula] on [formula], where [formula] and [formula]. One has by virtue of Fubini-Tonelli Theorem that [formula], and thus [formula] if and only if [formula]. Notice that θ* is taken in Θ.

Let [formula] such that [formula]. Since θ* is taken in Θ, one has that [formula], therefore θ∈Θ and thus θ  =  θ* by identifiability in Θ. Notice that [formula] is the convex envelope of [formula]. The set [formula] contains the null measure 0, for which [formula] and thus [formula]. If [formula] with [formula], then [formula] on [formula] since k > 0, and thus [formula] is finite for any [formula]. For any [formula], the map [formula] is continuous since k(x,  ·  ) is in [formula].

For any [formula] with [formula], one can write θ  =  αθ' with θ'∈Θ and [formula]. One has then fθ  =  αfθ' and thus mθ  =   log α + mθ'. Therefore,

[formula]

As a consequence, [formula], and one may substitute Θ by [formula] in the definition [\eqref=eq:ame]. Now, let [formula] be a sequence in Θ of asymptotic maximum likelihood estimators. Corollary [\ref=co:pf] and Remark [\ref=rm:m-inf] for [formula] apply and give the P*-a.s. convergence for the vague topology of [formula] towards θ*. Since both the sequence and the limit are in Θ, the convergence holds for the Prohorov topology, and the desired result is established.

A mixture model can always be seen as a conditional model. The observed random variables X with values in [formula] is the first component of the couple (X,Z) with values in [formula]. The component Z is not observed. However, the conditional law [formula] is known, and has density k(  ·  ,z) with respect to Q on [formula]. If [formula], then [formula] has density [formula] with respect to Q on [formula].

Proof of main result

The random sequence (n)n is a sequence of asymptotic M-estimators if and only if

[formula]

The proof is done "ω by ω", and the a.s. sets in [\eqref=eq:ame] and [\eqref=eq:ame-cns] are the same. Recall that (n)n is a sequence of asymptotic M-estimators if and only if [\eqref=eq:ame] holds. Actually, the definition of the supremum gives [formula]. Therefore, [\eqref=eq:ame] is equivalent to

[formula]

The Lemma is thus reduced to the equivalence between [\eqref=eq:ame-alt] and [\eqref=eq:ame-cns]. We begin by the proof of the implication [\eqref=eq:ame-alt] ⇒   [\eqref=eq:ame-cns]. Let A be some [formula]-a.s. set such that [\eqref=eq:ame-alt] holds. We proceed by fixing ω∈A. We hide the dependency on ω in the notation of Mn and n to lightweight the expressions. Let (θn)n be a sequence in Θ. By definition of the supremum, we have Mn(θn)  ≤   sup θ∈ΘMn(θ). Thus, we get

[formula]

Taking the [formula] of both sides and using [\eqref=eq:ame-alt] provides the expected result [\eqref=eq:ame-cns]. It remains to establish the implication [\eqref=eq:ame-cns] ⇒   [\eqref=eq:ame-alt]. Let A be some [formula]-a.s. set such that [\eqref=eq:ame-cns] holds. Here again, we proceed by fixing ω∈A, and we hide the dependency on ω in the notation of the random objects like Mn and n. By definition of the supremum, there exists, for any n, an element θn∈Θ such that

[formula]

Notice that θn depends on ω since Mn depends on ω. This yields

[formula]

Now we write the telescopic sum

[formula]

which gives

[formula]

The two terms of the right hand side are "≤  0" by virtue of [\eqref=eq:ame-cns-aux] and [\eqref=eq:ame-cns] respectively. This provides the desired result [\eqref=eq:ame-alt], as expected.

Assume that [formula]-a.s., for any neighborhood U of θ*, for any sequence (θn)n in Uc, there exists a sequence (θ'n)n in Θ such that

[formula]

Then, any asymptotic M-estimators sequence (n)n is strongly consistent.

Suppose that [\eqref=eq:sep-seq] holds for some a.s. set A, and that (n)n is a sequence of asymptotic M-estimators which is not strongly consistent. Saying that (n)n is not strongly consistent means that for any [formula]-a.s. set, there exists a neighborhood U of θ* and a subsequence (nk)k in Uc. In particular, on the a.s. set A, this gives a neighborhood U of θ* and a subsequence (nk)k in Uc. Now, by virtue of [\eqref=eq:sep-seq],

[formula]

where the a.s. set is A. This contradicts [\eqref=eq:ame-cns] which holds [formula]-a.s. too.

Assume that Θ is compact and that there exists a map a*:Θ  →  Θ such that for any θ  ≠  θ*, there exists a neighborhood Uθ of θ such that

[formula]

Then, any asymptotic M-estimators sequence (n)n is strongly consistent.

Let us show that the assumptions of Lemma [\ref=le:consistency-from-sep-seq] are fulfilled. We will establish [\eqref=eq:sep-seq] for an a.s. set A which does not depend on the neighborhood U of θ*. Namely, let U be an open neighborhood of θ*. For any θ∈Uc, let [formula] and [formula] be the neighborhood of θ and the [formula]-a.s. set for which [\eqref=eq:sep-pf] holds. Notice that [formula] depends on [formula]. The set [formula] is compact as a closed subset of the compact set Θ. We can thus extract a finite sub-covering [formula], and write

[formula]

By virtue of [\eqref=eq:sep-pf] we get from the above that

[formula]

where the [formula]-a.s. set is [formula]. Recall that U was a freely chosen neighborhood of θ*. Consider now a countable base (Uk)k for θ*. Then [\eqref=eq:sep-U] holds on the [formula]-a.s. set [formula], which does not depend on U. Notice at this step that

[formula]

as soon as θn∈Uc by definition of the infimum. This gives [\eqref=eq:sep-seq] from [\eqref=eq:sep-U] on the [formula]-a.s. set A defined above, with [formula].

The desired result follows from Lemma [\ref=le:astar-prop-is-enough]. Namely, let us show that [\eqref=eq:sep-pf] is a consequence of (A[\ref=hyp:cont]) and (A[\ref=hyp:sep]). Let θ  ≠  θ* and let a* and V as in (A[\ref=hyp:sep]). Let [formula] be a decreasing local base with V0  ⊂  V. Let Z: =  inf V(ma* - m) and Zk: =  inf Vk(ma* - m) and [formula]. By (A[\ref=hyp:cont]) and the continuity of a* and the separability of Θ, we get that [formula] is measurable, and that

[formula]

Now, by (A[\ref=hyp:sep]), we get that [formula] and [formula] and P*(Z∞) > 0. Observe that [formula]. Thus, by the monotone convergence Theorem,

[formula]

Therefore, P*(Zk) > 0 for some k (actually for k large enough). Let us denote [formula]. Now, by the law of large numbers

[formula]

This gives finally [\eqref=eq:sep-pf] since for any n

[formula]

Acknowledgements. The article benefited from the comments and criticism of the Advisory Editor and two anonymous referees. The authors would like also to sincerely thank Professor Jon A. Wellner who has kindly answered to their questions during his visit in Toulouse.

Djalil Chafaï, corresponding author. Address: UMR 181 INRA/ENVT Physiopathologie et Toxicologie Expérimentales, École Nationale Vétérinaire de Toulouse, 23 Chemin des Capelles, F-31076, Toulouse Cedex 3, France. E-mail: Address: UMR 5583 CNRS/UPS Laboratoire de Statistique et Probabilités, Institut de Mathématiques de Toulouse, Université Paul Sabatier, 118 route de Narbonne, F-31062, Toulouse, Cedex 4, France. E-mail: Web: