Population genetic consequences of the Allee effect and the role of offspring-number variation

Keywords: critical population size, family size, founder effect, genetic variation, invasive species, stochastic modelling

Introduction

The demographic Allee effect, a reduction in per-capita population growth rate at small population sizes [\citep=2080Stephens1999], is of key importance for the fate of both endangered and newly introduced populations, and has inspired an immense amount of empirical and theoretical research in ecology [\citep=3987Courchamp2008]. By shaping the population dynamics of small populations, the Allee effect should also strongly influence the strength of genetic drift they are exposed to and hence their levels of genetic diversity and evolutionary potential. In contrast to the well-established ecological research on the Allee effect, however, research on its population genetic and evolutionary consequences is only just beginning [\citep=3699Kramer2008] [\citep=605Hallatschek2008] [\citep=3635Roques2012]. In this study, we focus on the case where the average population growth rate is negative below a certain critical population size. This phenomenon is called a strong demographic Allee effect [\citep=2084Taylor2005]. Our goal is to quantify levels of genetic diversity in introduced populations that have successfully overcome such a strong demographic Allee effect. Of course, the population genetic consequences of the Allee effect could depend on a variety of factors, some of which we investigated in [\citep=3989Wittmann2013]. Here we focus on the role of variation in the number of offspring produced by individuals or pairs in the population.

There are several reasons why we hypothesise offspring-number variation to play an important role in shaping the population genetic consequences of the Allee effect. First, variation in individual offspring number can contribute to variability in the population dynamics and this variability influences whether and how introduced populations can overcome the Allee effect. In a deterministic model without any variation, for instance, populations smaller than the critical size would always go extinct. With an increasing amount of stochastic variability, it becomes increasingly likely that a population below the critical population size establishes [\citep=301Dennis2002]. Depending on the amount of variability, this may happen either quickly as a result of a single large fluctuation or step-by-step through many generations of small deviations from the average population dynamics. Of course, the resulting population-size trajectories will differ in the associated strength of genetic drift. Apart from this indirect influence on genetic diversity, offspring-number variation also directly influences the strength of genetic drift for any given population-size trajectory. In offspring-number distributions with large variance, genetic drift tends to be strong because the individuals in the offspring generation are distributed rather unequally among the individuals in the parent generation. In distributions with small variance, on the other hand, genetic drift is weaker.

In [\citep=3989Wittmann2013], we have studied several aspects of the population genetic consequences of the Allee effect for Poisson-distributed offspring numbers, a standard assumption in population genetics. However, deviations from the Poisson distribution have been detected in the distributions of lifetime reproductive success in many natural populations. Distributions can be skewed and multimodal [\citep=3977Kendall2010] and, unlike in the Poisson distribution, the variance in the number of surviving offspring is often considerable larger than the mean, as has been shown for example for tigers [\citep=3972Smith1991], cheetahs [\citep=3980Kelly1998], and steelhead trout [\citep=3959Araki2007]. Several sources contribute to this variance, for example variation in environmental conditions, sexual selection, and predation. For several bird species, there is evidence that pairs individually optimise their clutch size given their own body condition and the quality of their territories [\citep=3965Hogstedt1980] [\citep=3979Davies2012]. Variation in offspring number may also depend on population size or density and thus interact with an Allee effect in complex ways. A mate finding Allee effect, for example, is expected to lead to a large variance in reproductive success among individuals [\citep=302Kramer2009] because many individuals do not find a mating partner and thus do not reproduce at all, whereas those that do find a partner can take advantage of abundant resources and produce a large number of offspring. In this study, we therefore investigate how the genetic consequences of the Allee effect depend on offspring-number variation. With the help of stochastic simulation models, we generate population-size trajectories and genealogies for populations with and without Allee effect and with various offspring-number distributions, both models with a smaller and models with a larger variance than the Poisson model.

Although probably only few natural populations conform to standard population genetic assumptions such as that of a constant population size and a Poisson-distributed number of offspring per individual, many populations still behave as an idealised population with respect to patterns of genetic variation [\citep=619Charlesworth2009]. The size of this corresponding idealised population is called the effective population size and is often much smaller (but can, at least in theory, also be larger) than the size of the original population, depending on parameters such as the distribution of offspring number, sex ratio, and population structure. Because of this robustness and the tractability of the standard population genetics models, it is common to work with these models and effective population sizes, instead of using census population sizes in conjunction with more complex and realistic models. For example, when studying the demographic history of a population, one might estimate the effective current population size, the effective founder population size etc. If one is interested in census population size, one can then use the biological knowledge to come up with a conversion factor between the two population sizes. Therefore, if we find differences in the genetic consequences of the Allee effect between different family size distributions but it is possible to resolve these differences by rescaling population size or other parameters, those differences might not matter much in practice. If, on the other hand, such a simple scaling relationship does not exist, the observed phenomena would be more substantial and important in practice. We therefore investigate how closely we can approximate the results under the various offspring-number models by rescaled Poisson models.

Methods

Scenario and average population dynamics

In our scenario of interest, N0 individuals from a large source population of constant size k0 migrate or are transported to a new location. The average population dynamics of the newly founded population are described by a modified version of the Ricker model [\citep=1041Kot2001] with growth parameter r, carrying capacity k1, and critical population size a. Given the population size at time t, Nt, the expected population size in generation t + 1 is

[formula]

Thus, below the critical population size and above the carrying capacity, individuals produce on average less than one offspring, whereas at intermediate population sizes individuals produce on average more than one offspring and the population is expected to grow (figure [\ref=fig:Alleemodel]). We compared populations with critical population size a = aAE  >  0 to those without Allee effect, i.e. with critical size a = 0. In all our analyses, the growth parameter r takes values between 0 and 2, that is in the range where the carrying capacity k1 is a locally stable fixed point of the deterministic Ricker model and there are no stable oscillations or chaos [\citep=101Vries2006].

Offspring-number models

Our goal was to construct a set of offspring-number models that all lead to the same expected population size in the next generation (equation [\eqref=eq:expectedpopsize]) but which represent a range of values for the variability in population dynamics and the strength of genetic drift c (table [\ref=tab:distributions]). All our models have in common that individuals are diploid and biparental, and, for simplicity, hermaphroditic. The models differ in how pairs are formed, in whether individuals can participate in multiple pairs, in whether or not selfing is possible, and in the distribution of the number of offspring produced by a pair.

Poisson model

This is the model underlying the results in [\citep=3989Wittmann2013] and we use it here as a basis of comparison. Given a current population size Nt,

[formula]

such that [formula].

Poisson-Poisson model

Under this model, first a Poisson-distributed number of pairs

[formula]

are formed by drawing two individuals independently, uniformly, and with replacement from the members of the parent generation. That is, individuals can participate in multiple pairs and selfing is possible. Each pair then produces a Poisson-distributed number of offspring with mean 2. The offspring numbers of the Pt + 1 pairs are stored in the vector of family sizes [formula]. This vector is required to simulate the genealogies backward in time, unlike in the Poisson model where we only needed to store the total population size in each generation.

To compute the variance of Nt + 1 given Nt, we used the formula for the variance of the sum of a random number of independent and identically distributed random variables [\citep=3100Karlin1975]

[formula]

where [formula] and [formula] are mean and variance of the number of offspring produced by a single pair. The resulting variance (see table [\ref=tab:distributions]) is larger than that under the Poisson model.

Poisson-geometric model

This model is identical to the Poisson-Poisson model except that the number of offspring of a given pair is geometrically distributed with mean 2, rather than Poisson-distributed. Using equation [\eqref=eq:randomvariance] again, we obtain an even larger variance than under the Poisson-Poisson model (table [\ref=tab:distributions]).

Binomial model

Here, individuals can participate in only one pair and selfing is not possible. First, the individuals from the parent generation t form as many pairs as possible, i.e. Pt + 1  =  ⌊Nt  /  2⌋. Then, each pair produces a binomially distributed number of offspring with parameters n = 4 and [formula], such that the population size in the offspring generation

[formula]

The reason for our choice of n was that it leads to a variance np(1 - p) that is smaller than the variance under the Poisson model (see table [\ref=tab:distributions]). As was the case for the previous two models, also here we needed to store the vector of family sizes to be able to simulate the genealogies backward in time.

Demographic simulations

As we are only interested in populations that successfully overcome demographic stochasticity and the Allee effect, we discarded simulation runs in which the new population went extinct before reaching a certain target population size z. Here, we used z = 2  ·  aAE, i.e. twice the critical population size in populations with Allee effect. We generated 20,000 successful populations with and without Allee effect for each offspring-number model and for a range of founder population sizes between 0 and z. The population-size trajectories [formula], where NTz is the first population size larger or equal to z, and the family-size vectors were stored for the subsequent backward-in-time simulation of genealogies. We also used the population-size trajectories to compute the average number of generations that the 20,000 replicate populations spent at each population size before reaching z. The complete simulation algorithm was implemented in C++ [\citep=3991Stoustrup1997], compiled using the g++ compiler [\citep=3992gcc], and uses the boost random number library [\citep=3993boost.org2013]. We used R [\citep=575Team2009] for the analysis of simulation results.

Simulation of genealogies

From each successful model population, we simulated ten independent single-locus genealogies, each for ten individuals sampled at both genome copies at the time when the population first reaches z. To construct the genealogies, we trace the ancestral lineages of the sampled individuals backward in time to their most recent common ancestor. For the Poisson model, we applied the simulation strategy of [\citep=3989Wittmann2013]: Given the population-size trajectory [formula] we let all lineages at time t + 1 draw an ancestor independently, with replacement, and uniformly over all Nt individuals in the parent generation. For the other offspring-number models considered in this study, we use a modified simulation algorithm (see [\ref=sec:genealogydetails] for details) that takes into account the family-size information stored during the demographic simulation stage. Both simulation algorithms account for the possibility of multiple and simultaneous mergers of lineages and other particularities of genealogies in small populations. All lineages that have not coalesced by generation 0 are transferred to the source population. As in [\citep=3989Wittmann2013], we simulated this part of the ancestral history by switching between two simulation modes: an exact and a more efficient approximative simulation mode (see [\ref=sec:genealogydetails]). At the end of each simulation run, we stored the average time to the most recent common ancestor [formula] for pairs of gene copies in the sample.

To visualise our results and compare them among the offspring-number models, we divided [formula] by the average time to the most recent common ancestor for two lineages sampled from the source deme (2k0 / c). The quotient [formula] can be interpreted as the proportion of genetic diversity that the newly founded population has maintained relative to the source population. We also computed the per-cent change in expected diversity in populations with Allee effect (AE) compared to those without:

[formula]

Effective-size rescaled Poisson model

Given a population size n in an offspring-number model with relative strength of genetic drift c (see table [\ref=tab:distributions]), we define the corresponding effective population size as ne(n) = n / c. In this way, a population of size n in the target offspring-number model experiences the same strength of genetic drift as a Poisson population of size ne. To approximate the various offspring-number models by a rescaled Poisson model, we thus set the population size parameters of the Poisson model (a, k0, k1, z, and N0) to the effective sizes corresponding to the parameters in the target model. For example, to obtain a Poisson model that corresponds to the Poisson-geometric model we divided all population size parameters by 3. In cases where the effective founder population size ne(N0) was not an integer, we used the next-larger integer in a proportion q = ne(N0)  -  ⌊ne(N0)⌋ of simulations and the next-smaller integer in in the remainder of simulations. For the target population size, we used the smallest integer larger or equal to the rescaled value. All other parameters were as in the original simulations.

Results

The main results on the population dynamics and genetic diversity of populations with and without Allee effect are compiled in figure [\ref=fig:results]. The upper two rows show the population genetic consequences of the Allee effect for different founder population sizes, the lower row the average number of generations that successful populations spend in different population-size ranges. Each column stands for one offspring-number model. Variation in offspring number and variability in the population dynamics increases from left to right. A first thing to note in figure [\ref=fig:results] is that with increasing offspring-number variation the amount of genetic variation maintained in newly founded populations decreases, both for populations with and without Allee effect (solid black and grey lines in figure [\ref=fig:results]a-d). In populations without Allee effect, however, the decrease is stronger. As a result, the magnitude and direction of the Allee effect's influence on genetic diversity changes as variation in offspring number increases. For the binomial model, the model with the smallest variability in population dynamics and genetics, the Allee effect has a negative influence on the amount of diversity maintained for all founder population sizes we considered (figure [\ref=fig:results]a,e). For the model with the next-larger variation, the Poisson model, the Allee effect increases genetic diversity for small founder population sizes but decreases genetic diversity for large founder population sizes (figure [\ref=fig:results]b,f). These results on the Poisson model are consistent with those in [\citep=3989Wittmann2013]. As variability further increases, the range of founder population sizes where the Allee effect has a positive effect increases (figure [\ref=fig:results]c,g). For the model with the largest offspring-number variation, the Poisson-geometric model, the Allee effect has a positive effect for all founder population sizes (figure [\ref=fig:results]d,h). In summary, the larger is the offspring-number variation, the more beneficial is the Allee effect's influence on genetic diversity.

The differences between offspring-number models in the population genetic consequences of the Allee effect (represented by the solid lines in figure [\ref=fig:results]a-h) result from two ways in which offspring-number variation influences genetic diversity: directly by influencing the strength of genetic drift for any given population-size trajectory, and indirectly by influencing the population dynamics of successful populations and thereby also the strength of genetic drift they experience. To disentangle the contribution of these two mechanisms, we first examine the direct genetic effect of offspring-number variation that results from its influence on the strength of genetic drift. For this, we generated a modified version for each of the binomial, Poisson-Poisson, or Poisson-geometric model (dashed lines in figure [\ref=fig:results]). We first simulated the population dynamics forward in time from the original model. Backwards in time, however, we ignored this family-size information and let lineages draw their ancestors independently, uniformly, and with replacement from the parent generation as in the Poisson model. In the case of the binomial model, where the modified model has stronger genetic drift than the original model, both populations with and without Allee effect maintain on average less genetic variation in the modified than in the original model (figure [\ref=fig:results]a). The Allee effect leads to a stronger reduction in genetic diversity in the modified model than in the original model (figure [\ref=fig:results]e). The opposite pattern holds for the Poisson-Poisson and Poisson-geometric model where the modified model has weaker genetic drift than the original model. Populations in the modified model versions maintain a larger proportion of genetic variation (figure [\ref=fig:results]c,d), and the relative positive influence of the Allee effect is weaker (figure [\ref=fig:results]g,h).

Next, we consider the population dynamics of successful populations with and without Allee effect under the different offspring-number models. For this, we plotted the average number of generations that successful populations starting at population size 15 spend at each population size between 1 and z - 1 before reaching the target state z (lower row in figure [\ref=fig:results]). As variability increases (going from left to right) both kinds of successful populations spend fewer generations in total, i.e. reach the target population size faster, but again populations with and without Allee effect respond differently to increasing variability. If we first focus on the offspring-number models with intermediate variation (figure [\ref=fig:results]j,k) we observe that successful Allee-effect populations spend less time at small population sizes but more time at large population sizes than successful populations without Allee effect. This indicates that successful Allee-effect populations experience a speed-up in population growth at small sizes but are then slowed down at larger population sizes. If we now compare the results for the various offspring-number models, we observe that with increasing variability the speed-up effect becomes stronger and takes place over a larger range of population sizes, whereas the slow-down effect becomes weaker and finally disappears.

When rescaling the population-size parameters in the Poisson model to match one of the other offspring-number models, the resulting Poisson model behaves more similarly to the approximated model than does the original Poisson model, but the fit is not perfect (dotted lines in the upper two rows in figure [\ref=fig:results]). In general, the model versions without Allee effect are better approximated by the rescaled Poisson models than the model versions with Allee effect. Although the proportion of variation maintained in the rescaled model is close in magnitude to the one in the target model, the rescaled model often differ in its predictions as to the genetic consequences of the Allee effect. Rescaled Poisson models always predict the Allee effect to have a positive effect for small founder population sizes and a negative effect for larger founder population sizes, although for the binomial and Poisson-geometric model the effect is always negative or positive, respectively (figure [\ref=fig:results]e,h).

Discussion

Our results indicate that offspring-number variation plays a key role for the genetic consequences of the Allee effect. We can understand a large part of the differences between offspring-number models if we consider how many generations successful populations spend in different population-size regions before reaching the target population size. In [\citep=3989Wittmann2013], we found that with Poisson-distributed offspring numbers successful Allee-effect populations spend less time at small population sizes than populations without Allee effect. Apparently, small Allee-effect populations can only avoid extinction by growing very quickly (speed-up in figure [\ref=fig:flowchart]). We also found, however, that Allee effect-populations spend on average more time at large population sizes than populations without Allee effect (slow-down in figure [\ref=fig:flowchart]). Consequently, under the Poisson model the Allee effect had either a positive or a negative effect on levels of genetic diversity depending on the founder population size.

An increase in offspring-number variation leads to more variable population dynamics, which on the one hand lets successful populations escape even faster from the range of small population sizes than under the Poisson model. On the other hand, a large variation also prevents successful Allee-effect populations from spending much time near or above the critical population size because those that do still have a high risk of going extinct even at such high population sizes. Therefore, an increase in variability reinforces the speed-up effect but mitigates the slow-down effect and thus increases the range of founder population sizes for which the genetic consequences of the Allee effect are positive (see figure [\ref=fig:results],[\ref=fig:flowchart]). In that sense, variation in family sizes plays a similar role as variation in founder population size and in the number of introduction events (see figure [\ref=fig:flowchart]), two factors that were examined in [\citep=3989Wittmann2013]  and, in the case of founder population size, also by Kramer and Sarnelle [\citep=3699Kramer2008]. Variation in these aspects also leads to a positive influence of the Allee effect on diversity because by conditioning on success we let the Allee effect select the outliers of the respective distributions, and it is those outliers (particularly large founder sizes, exceptionally many introduction events) that lead to a large amount of genetic diversity.

Apart from its indirect but strong influence via the population dynamics, variation in offspring number also has a direct influence on genetic diversity by determining the strength of drift for a given population-size trajectory. Our comparisons between models with the same population dynamics but a different strength of drift suggest that an increase in the strength of genetic drift amplifies the per-cent change in diversity of Allee-effect populations compared to populations without Allee effect. We suggest this is the case because the stronger genetic drift is, the more genetic variation is lost or gained if it takes one generation more or less to reach the target population size. Thus, by reinforcing both the positive effect of a speed-up on genetic variation and the negative effect of a slow-down (figure [\ref=fig:flowchart]), an increase in variation increases the magnitude of the net influence of the Allee effect on genetic variation.

We have now established that for a given set of parameter values, the population genetic consequences of the Allee effect differ strongly between offspring-number models. Nevertheless, we would still be able to use the Poisson model for all practical purposes if for any given set of parameters in one of the other offspring models we could find a set of effective parameters in the Poisson model that would yield similar results. The most obvious way to do this is to replace the population size parameters in the Poisson model by the corresponding effective population sizes, i.e. the population sizes in the Poisson model at which genetic drift is as strong as it is in the target model at the original population size parameter. However, our results (see figure [\ref=fig:results]) indicate that the effective-size rescaled Poisson models cannot fully reproduce the results of the various offspring-number models. In particular, the population dynamics of successful populations remain qualitatively different from those under the target model.

Apart from the population-size parameters, the Poisson model has an additional parameter that we could adjust, the growth parameter r. In [\citep=3989Wittmann2013], we considered different values of r in the Poisson model. Small values of r led to qualitatively similar results as we have seen here in models with a larger offspring-number variation and larger values of r. The reason appears to be that the population dynamics of successful populations depend not so much on the absolute magnitude of the average population growth rate (the deterministic forces) or of the associated variation (the stochastic forces), but on the relative magnitude of deterministic and stochastic forces. Indeed, a theorem from stochastic differential equations states that if we multiply the infinitesimal mean and the infinitesimal variance of a process by the same constant ρ, we get a process that behaves the same, but is sped up by a factor ρ [\citep=3975Durrett1996]. Intuitively, we can make a model more deterministic either by increasing the growth parameter or by decreasing the variance. This suggests that we can qualitatively match the population dynamics of any given offspring-number model if we choose r appropriately. Furthermore, we can match the strength of genetic drift if we rescale the population-size parameters appropriately. One could therefore suppose that by adjusting both the population-size parameters and the growth parameter in the Poisson model, we might be able to match both the population dynamic and the genetic aspects of the other offspring-number models. In [\ref=sec:rescalingimpossible], however, we show that this can only be possible if the equilibrium strength of genetic drift c equals [formula]. This is not the case for the offspring-number models we examine in this study (see table [\ref=tab:distributions]), neither with nor without Allee effect. However, our results suggest that the Allee effect enhances the mismatch between the effective-size rescaled Poisson models and their target models.

Overall, our results suggest that if we study populations that had been small initially but successfully overcame an Allee effect, microscopic properties such as the variation in offspring number can play a large role, although they may not influence the average unconditional population dynamics. Thus the common practice of first building a deterministic model and then adding some noise to make it stochastic may not produce meaningful results. As emphasised by Black and McKane [\citep=3654Black2012], stochastic population dynamic models should be constructed in a bottom-up way starting with modelling the relevant processes at the individual level and then deriving the resulting population dynamics in a second step. This means, we have to gather detailed biological knowledge about a species of interest before being able to predict the population genetic consequences of the Allee effect or other phenomena involving the stochastic dynamics of small populations. In this study, we have combined offspring-number models with a separate phenomenological model for the Allee effect. This helped us to compare the population-genetic consequences of the Allee effect among the different offspring-number model. A next step to make our model more mechanistic could be to let both the Allee effect and offspring-number variation emerge from a detailed mechanistic model for individual reproductive success.

In this study and in [\citep=3989Wittmann2013], we have focused on how the Allee effect impacts levels of neutral genetic diversity. Additional complications will arise if we take into account aspects of genetic variation that are required for the adaptation of an introduced population to its new environment. This need for adaptation can give rise to an Allee effect in itself because larger founding populations will have a larger probability to harbour the alleles that are advantageous in the new environment. We are currently investigating how this genetic Allee effect interacts with mate-finding or other ecological Allee effects and with the phenomena discussed in this paper.

Acknowledgements

We thank Peter Pfaffelhuber for pointing us to an interesting result on rescaling diffusion processes. MJW is grateful for a scholarship from the Studienstiftung des deutschen Volkes.

Details of the genealogy simulation

To simulate a genealogy, we start with the ns = 10 individuals sampled at generation Tz and then trace their ancestry backward in time generation by generation until we arrive at the most recent common ancestor of all the genetic material in the sample. At time t + 1, for example, we may have na individuals that carry genetic material ancestral to the sample. To trace the ancestry back to generation t, we make use of the family-size vector [formula] stored during the forward-in-time simulation stage. We first assign each of the na individuals to a family by letting them successively pick one of the families in proportion to their sizes, i.e. the entries fi of the family-size vector. After a family has been picked, the corresponding entry in the family-size vector is reduced by 1 to avoid that the same individual is picked twice.

After all na individuals have been assigned, all families that have been chosen at least once draw parents in generation t. Here, the models differ. In the Poisson-Poisson and Poisson-geometric model, each family picks two parents independently, with replacement, and uniformly over all individuals in the parent generation. That is, parents can be picked by several families, and they can even be picked twice by the same family, corresponding to selfing. In the binomial model, on the other hand, parents are chosen without replacement. Each parent can only be picked by one family and selfing is not possible. From there on, everything works as described in [\citep=3989Wittmann2013]: The two genome copies of each ancestral individual split and each of the two parents (or possibly the same individual in the case of selfing) receives one genome copy. A coalescent event happens if the same genome copy in a parent receives genetic material from several children.

At time 0, i.e. at the time of the introduction, all remaining ancestors are transferred (backwards in time) to the source population, which is of large but finite size k0 at all times. We assume that the mechanism of pair formation and the distribution of the number of offspring per pair are the same in the source population and in the newly founded population. Therefore, we still need to take into account family-size information to simulate the genealogy backward in time. Since we did not generate the required family-size vectors during the forward-in-time simulation stage, we now simulate them ad-hoc at every backward-in-time step. We do this by sampling from the distribution of family sizes (Poisson or geometric with mean 2, or binomial with n = 4,p = 1 / 2) until we get a total number of k0 individuals (truncating the last family if required). Apart from this modification, the simulation algorithm is identical to the one used in the first stage of the simulation. When the simulation arrives at a point where all na ancestors carry ancestral material at only one genome copy, it usually takes a long time until lineages are again combined into the same individual. Under these circumstances, we therefore use a more efficient approximative simulation mode: We draw the number of generations until two ancestors are merged into the same individual from a geometric distribution with parameter

[formula]

where c is the strength of genetic drift compared to that under the Poisson model (see table [\ref=tab:distributions]). Whenever such an event happens, two randomly chosen ancestors are merged. Here we need to distinguish between two possible outcomes, both of of which occur with probability 1/2. In the first case, there is a coalescent event and we now have na  -  1 ancestors, each still with ancestral material at only one genome copy. We therefore continue in the efficient simulation model. In the second case, there is no coalescent event and the resulting individual has ancestral material at both genome copies. Therefore, we switch back the other exact simulation mode. In this way, we switch back and forth between the two simulation modes until the most recent common ancestor of all the sampled genetic material has been found. For each simulation run, we store the average pairwise time to the most recent common ancestor of pairs of gene copies in the sample.

We will now take a closer look at the genealogical implications of the different offspring number models. Thereby, we will derive the values for the relative strength of genetic drift c given in table [\ref=tab:distributions] and justify the approximation in [\eqref=eq:coalapprox]. Equation [\eqref=eq:coalapprox] is valid as long as we can neglect events in which at least three ancestors are merged into the same individual in a single generation (multiple mergers) and events in which several pairs of ancestors are merged in a single generation (simultaneous mergers). In the following, we will show that we can indeed neglect such events for large source population sizes k0 because the per-generation probability of multiple and simultaneous mergers is O(1 / k20) whereas single mergers occur with probability O(1 / k0). Here f(k0) = O(g(k0)) means that there exist positive constants M and k* such that

[formula]

for all k0  >  k* [\citep=4129Knuth1997]. In other words, as k0 goes to infinity, an expression O(1 / kn0) goes to zero at least as fast as 1 / kn0.

To derive the probabilities of multiple and simultaneous mergers, we first introduce some notation. Let P be a random variable representing the number of pairs with at least one offspring individual, and Ol the number of offspring of the lth of them, with [formula]. Because we assume a fixed size k0 of the source population and because we truncate the last family if necessary to achieve this (see above), the Ol are not exactly independent and identically distributed. However, in all cases we are considering, k0 is very large relative to typical offspring numbers Ol. To facilitate our argument, we therefore approximate the Ol by independent and identically distributed [formula] taking values in [formula].

In the following computations, we will need the fact that the first three moments of the Yl ([formula]) are finite. These are the moments of the number of offspring per pair, conditioned on the fact that there is at least one offspring. Let X denote a random variable with the original distribution of the number of offspring per pair, i.e. the one allowing also for families of size 0. Then the moments of the Yl can be computed from the moments of X with the help of Bayes' formula:

[formula]

These computations lead to finite constants for the first three moments of the Yl in the binomial, Poisson-Poisson, and Poisson-geometric model.

Since we switch to the accurate simulation mode whenever two lineages are combined into the same individual, we can assume here that the lineages at time t + 1 are in different individuals. Thus, the number of lineages is equal to the number of ancestors na and is at most twice the sample size (in our case at most 20), but usually much lower since many coalescent events already happen in the newly founded population. Of course, each ancestor has two parents, but since ancestors here carry genetic material ancestral to the sample only at one genome copy, only one of their two parents is also an ancestor and the other one can be neglected.

A multiple merger can occur in three, not necessarily mutually exclusive, ways (figure [\ref=fig:mergers]a-c). First we will consider the case where there is at least one family that at least three lineages trace back to (figure [\ref=fig:mergers]a). The probability of such an event is

[formula]

Here, we used the fact that P  ≤  k0, which is true because we take P to be the number of families with at least one member. Note that when lineages trace back to the same family, they still need to draw the same parent individual in order to be merged. For the three lineages here, this probability is 1/4 if the family did not arise from selfing, and 1 if it did. For simplicity, we take 1 as an upper bound for this probability here and for similar probabilities in the following inequalities.

Under the binomial model, the above case is the only way in which multiple mergers can occur. Under the Poisson-Poisson and Poisson-geometric model, however, parent individuals can participate in several pairs and therefore potentially contribute to more than one family. Therefore, we additionally have to take into account the possibility that lineages trace back to different families but then choose the same parent individual (figure [\ref=fig:mergers]b,c). One possibility (figure [\ref=fig:mergers]b) is that there is exactly one family that at least two lineages trace back to (event E1), that two lineages in this family draw the same parent individual (event E2), and that there is at least one lineage outside the family that draws the same parent (event E3). Using an argument analogous to that in [\eqref=eq:triplemergerbound], we obtain

[formula]

Furthermore, [formula] and

[formula]

Here we use the fact that families choose their parents independently and uniformly over all k0 individuals in the parent generation, such that lineages in different families have a probability of 1 / k0 of drawing the same parent. Combining the last three inequalities, we can conclude

[formula]

Finally, the probability that lineages from at least three different families choose the same parent (figure [\ref=fig:mergers]c) is bounded by

[formula]

For a simultaneous merger to occur, there must be at least two mergers of at least two lineages each. This can happen in three (not necessarily mutually exclusive) ways (figure [\ref=fig:mergers]d-f). To compute bounds for the corresponding probabilities, we again take 1 as an upper bound for all probabilities that lineages in the same family choose the same parent. First, a simultaneous merger can occur if there are at least two families, each with at least two lineages tracing back to them (event M1, figure [\ref=fig:mergers]d). This occurs with probability

[formula]

Second, there can be a simultaneous merger if there is one family with at least two lineages tracing back to it and two lineages that merge separately without being in the family (event M2, figure [\ref=fig:mergers]e). Using the bound for the probability of exactly one merger of two individuals from [\eqref=eq:E1], we obtain

[formula]

Finally, we can have two pairs of lineages both merging without being in the same family (event M3, figure [\ref=fig:mergers]f). This occurs with probability

[formula]

The different possibilities for multiple and simultaneous mergers are not mutually exclusive (for example there could be one triple merger and two double mergers), but since all of them have probability [formula], the probability of their union is also [formula]. With these results, we can write

[formula]

where A denotes the event that a specific pair of lineages merges into the same individual in the previous generation.

[formula]

For the binomial model,

[formula]

and

[formula]

For the other models,

[formula]

thereby accounting for the possibility of selfing, and

[formula]

For all models, we have

[formula]

where [formula] is the expected number of siblings of a sampled individual and [formula] is the size-biased expectation of the number of offspring per family. Using [\citep=3975Arratia2010], we obtain

[formula]

which is 2.5 for the binomial model, 3 for the Poisson-Poisson model, and 5 for the Poisson-geometric model.

Substituting [\eqref=eq:Asamefambino], [\eqref=eq:Adifffambino], and [\eqref=eq:Psamefam] into [\eqref=eq:PrA] and then into [\eqref=eq:P1merger], we obtain for the binomial model:

[formula]

Analogously, substituting [\eqref=eq:Asamefamother], [\eqref=eq:Adifffamother], and [\eqref=eq:Psamefam] into [\eqref=eq:PrA] and then into [\eqref=eq:P1merger], we obtain for the other models:

[formula]

For the approximation in [\eqref=eq:coalapprox], we neglect terms of order 1 / k20 and thus the relative strength of genetic drift in [\eqref=eq:coalapprox] is given by

[formula]

Evaluating this expression for the various models yields the values in table [\ref=tab:distributions].

Rescaling the Poisson model

In this section, we argue that in general it is not possible to rescale the Poisson model such that it gives reasonable approximations to one of the other offspring-number models with respect to both population dynamics and genetics, even if we both linearly rescale the population-size parameters and change the growth parameter. Given an offspring-number model M with critical population size a, carrying capacity k1, target population size z, founder population size N0, growth parameter r, [formula], and relative strength of genetic drift c, we will attempt to determine scaling parameters s and ρ such that a Poisson model M' with parameters a' = s  ·  a,k1' = s  ·  k1,z' = s  ·  z,N0' = s  ·  N0, and r' = ρ  ·  r approximates the original model.

In our argument, we will be guided by the following theorem on a time change in diffusion processes [\citep=3975Durrett1996]: If we speed up a diffusion process by a factor ρ, we obtain the same process as when we multiply both its infinitesimal mean and its infinitesimal variance by a factor ρ. In this study, we do not consider diffusion processes, but processes in discrete time and with a discrete state space. Furthermore, we cannot manipulate mean and variance independently. Therefore, the theorem cannot hold exactly for the models in this study. Nevertheless, it yields good approximations to the population dynamics under the the binomial, Poisson-Poisson, and Poisson-geometric model (figure [\ref=fig:r_rescaling_timespent]). Specifically, a Poisson model M' with r' = ρ  ·  r runs ρ times as fast but otherwise exhibits approximately the same population dynamics as a model M'' with growth parameter r and [formula], given that all other parameters are the same, i.e. a'' = a',k1'' = k1',z'' = z' and N0'' = N0'. However, due to the difference in time scale, the genetic drift experienced by populations under the two models may be very different.

To determine whether the offspring-number model M can be approximated by a Poisson model M', we will check whether it is possible to simultaneously fulfil two conditions, one on the population dynamics and one on the genetic aspect of the models. These two conditions are not sufficient to ensure that the models behave the same in every respect, but they appear necessary. If we can show that it is not possible to fulfil them simultaneously, not even in the unconditioned model, then the population dynamics and/or genetics of successful populations should be different under the two models.

First, we will specify a condition required to match the population dynamics. Since the success or failure of a population and other qualitative features of the population dynamics do not depend on the time scaling and since it is easier to compare models with the same growth parameter, we will use the model M'' instead of model M' here. To match the relative strength of stochastic vs. deterministic forces in the population dynamics, we will require that the standard deviation of the population size in the next generation relative to the corresponding expected value is equal in both models for corresponding population sizes n'' = s  ·  n:

[formula]

Given the properties of the model M'' and M stated above, this is equivalent to

[formula]

[formula]

[formula]

where

[formula]

is the expected per-capita number of surviving offspring in a population whose current size is a fraction x of the carrying capacity (see equation [\eqref=eq:expectedpopsize]). Since n'' / k1''  =  n / k1, [\eqref=eq:popdynamiccondition5] reduces to

[formula]

This is our first condition.

Second, both models should have the same strength of genetic drift at corresponding population sizes n and n'. Specifically, we require that the heterozygosity maintained over a corresponding time span is equal in both models:

[formula]

which corresponds approximately to the condition

[formula]

as long as n and n' are not too small. Here, we need the exponent 1 / ρ because--as we have seen above and in figure [\ref=fig:r_rescaling_timespent]--multiplying the growth parameter by a factor ρ effectively speeds up the process by the same factor such that there is less time for genetic drift to act. Using n' = s  ·  n, [\eqref=eq:driftconditon] simplifies to

[formula]

This is our second condition.

Combining [\eqref=eq:popdynamiccondition6] and [\eqref=eq:driftcondition2] shows that the two conditions can only be fulfilled simultaneously if ν  =  c, which is not the case for the offspring-number models we consider in this study (see table [\ref=tab:distributions]). The mismatch between ν and c in our models is related to the way in which the diploid individuals form pairs to sexually reproduce. In a haploid and asexual model, in which individuals independently produce identically distributed numbers of offspring, [formula] and [formula], where X is a random variable representing the number of offspring produced by a single individual. In analogy to [\eqref=eq:cfinal], we can then quantify the strength of genetic drift as

[formula]

This shows that in equilibrium, i.e. for [formula], there would be no mismatch between c and ρ in such a haploid model. In other situations, however, especially if we condition on the success of a small Allee-effect population, there could still be a mismatch. Furthermore, as discussed above, conditions [\eqref=eq:popdynamiccondition6] and [\eqref=eq:driftcondition2] may not be sufficient to ensure that two processes behave similarly. Especially if we condition on an unlikely event, the higher moments characterising the tail of the offspring-number distribution may be important and they are not necessarily matched even if mean and variance are. We therefore suggest that the strong differences among offspring-number distributions in the genetic consequences of the Allee effect can only in special cases be resolved by rescaling the parameters of the Poisson model.