=1 equation* endequation*

Financial interaction networks inferred from traded volumes

Introduction

Inferring Ising models is an interesting and important field in the study of complex systems. Growing amounts of data are generated in different domains studying complex interacting systems: biology, economics, finance, social sciences and others. Inverse Ising problems provide very flexible tools which guess the interaction patterns from the observed data, even for non-equilibrium systems [\cite=roudi2011] [\cite=mezard2011] [\cite=mastromatteo_marsiliJSTAT2011] [\cite=tyrcha2013], by linking pairwise correlations in the data to Ising couplings of the inferred model. An important question, which is studied in the present work, concerns the mapping of this complex data into binary variables. The data studied in inverse Ising problems consists indeed in binary strings, which explains why these models have been preferably applied to systems presenting activity/inactivity patterns, like neural networks [\cite=schneidman2006Nautre] [\cite=shlens2006Neuroscience].

But we show here how these tools can be applied to systems which provide more detailed data than activity/inactivity. This study deals with financial data generated by transactions on the New York Stock Exchange (NYSE). The activity of 100 highly traded stocks is recorded over a few years, and each trade is characterized by a time, a volume traded, and a price. Here we do not consider the price information and focus on time and volume traded. The simplest way to map such information to binary variables consists in forgetting about the traded volumes, and considering a trade as an activity, in the spirit of works on neural networks. This is done for instance by [\cite=mastromatteo_marsiliJSTAT2011], a work on which we build. However, in such work, the mapping of the data to binary strings has only one parameter, the length of the window. For large window sizes, one usually has a magnetization going to 1 - as at least one trade is quite sure to happen if the window is large enough - and low connected correlations. Then, in order to access phenomena taking place on bigger time scales, we use here a different mapping, which also allows us to consider volume information instead of just activity.

The paper presents the data, mapping and inference methods in section [\ref=data], the obtained couplings in section [\ref=results], and describes the inferred financial networks in section [\ref=networks] before concluding.

Data and inference

We focus on the trades between 100 highly traded stocks of the NYSE, for 100 trading days between the 01.02.2003 and 30.05.2003. As [\cite=mastromatteo_marsiliJSTAT2011], we only study the 104 central seconds of each day so that the system is not perturbed by the opening and closing periods of the stock exchange. Nonetheless, a Fourier transform of the data still shows a sharp peak at a frequency corresponding to this 104 seconds long day - a result also observed in [\cite=mathiesen2013].

This work has two particular details in the way it maps multi-dimensional financial trade data to binary strings of activity and inactivity. The first one is the use of a sliding time window, of length Δt, and shifted by a constant Δs = 1 second, which is the time resolution of the data. This means that the information contained in two mapped datapoints separated by a time less than Δt is partly redundant. In the case of a simple activity / inactivity mapping (neuronal data for instance), it also means that no information from the original data is lost.

The second characteristic of our mapping is more important, and allows us to consider also the volume information related to a trade. This is motivated by the fact that the distribution of traded volumes in the data is very broad, as illustrated by the top panel of figure [\ref=fig1], where the distribution looks roughly like a power-law, and spreads over more than 3 decades (see also [\cite=mathiesen2013] for distributions of trading volume rates). Our goal is to capture this important volume information through our mapping. To this end, we consider for each stock i the sum Vi(t,Δt) of the volumes traded in the time window of length Δt beginning at time t, and compare it to a given volume threshold Vith  =  χViavΔt, where Viav is the average volume of the considered stock traded per second, and χ a parameter governing our volume threshold:

[formula]

This mapping, illustrated on the bottom panel of figure [\ref=fig1], ensures that volume information (and not only trade / no trade information) is taken into account in the obtained binary strings.

For instance with χ = 1, there will be a signal if the total volume traded in the considered time window exceeds the average. In addition, it preserves the possibility to use only trade / no trade information: if [formula] (concretely, if χ is small enough that Vith is for every stock i smaller than the minimal traded volume, which is 100 in the data), we obtain the usual trade / no trade pattern used for instance by [\cite=mastromatteo_marsiliJSTAT2011].

Using this mapping, parameters Δt and χ control the time and volume scales which will be explored by the inference. However, in order to completely characterize the behaviour of the system, the inference should be done for all possible values of these parameters Δt and χ, giving different results each time. The methods used (equilibrium, synchronous and asynchronous Ising inference) are described in [\ref=inference]. In order to infer Ising couplings, equilibrium inference [\cite=Kappen1998] uses equal-time pairwise correlations of the data. Synchronous [\cite=roudi2011] and asynchronous inference [\cite=zeng2013], which work both on non-equilibrium systems, consider also respectively time-lagged pairwise correlations and their derivative with respect to the time lag.

Results

Our mapping using volume information allows to obtain information on larger time scales, on which trade / no trade patterns are inefficient, because the window size is so large that always at least one trade happens during this time. Indeed, the local magnetizations do not necessarily go to one when the window size increases. As a consequence, the connected correlations do not tend to zero, and neither do the inferred couplings. This is illustrated by the top panel of figure [\ref=fig2], which shows that the average absolute value of the equilibrium couplings [formula], where 〈.〉 denotes the average over all pairs of stocks, increases with the window size, for different values of the volume threshold parameter χ. The evolution of the slope is however not monotonous with χ. We study the absolute value of the couplings, because large negative values, which can counterbalance positive ones in the average without absolute value, might also give interesting information about the system. Actually, for larger values of the threshold parameter, χ = 2 for instance, large negative values of couplings are an important contribution to the high value of [formula]. We can note also that the correlations observed are much bigger than the N- 1 / 2 = 10- 3 which would be observed for independent spins, with data spanning over 106 seconds.

The same analysis performed on the synchronous couplings on the bottom panel of figure [\ref=fig2] shows that for small values of the window size Δt, the average absolute value of couplings has a maximum for a value of the time-lag of correlations τ  =  Δt. This corresponds to the smallest time-lag which presents no redundancy between the two considered time windows. For higher values of the window size, big values of the time-lag give a maximal plateau.

The goal of this study is to find values of the parameters introduced by the mapping and the inference, which yield inferred couplings containing interesting information. A first rough approach is to consider that couplings contain more information if they are bigger in absolute value. A more refined, but also laborious one, consists in looking at the distributions of couplings for different values of the parameters. This is done on figure [\ref=fig3]. For asynchronous inference, the derivative of the time-lagged correlations [formula] (see [\ref=inference]) is computed through a linear fitting of this function Cij(τ) using four points: C(0), C(Δt / 5), C(2Δt / 5) and C(3Δt / 5). This explains why the histogram of Jasyn becomes sharper when Δt is increased on the upper panel of figure [\ref=fig3], as this parameter is then in the denominator of the derivative.

The bottom panel of figure [\ref=fig3] shows that the three inference methods give close results when the distributions of couplings are considered.For comparison, the distributions are rescaled on the bottom panel so as to have the same standard deviation. The upper panel shows how these distributions change with the parameters. It can be remarked that for small time scales, they have a strictly positive mean and a long positive tail. For higher time scales, the distributions are more centered around zero, but they keep an asymmetry and a longer positive tail than the negative one. This prevalence of positive couplings can intuitively be linked with the market mode phenomenon.

Indeed, a spectral analysis of the inferred coupling matrices (not presented here) yields the well-known fact (at least for correlations or couplings of stock prices [\cite=bouchaud2003] [\cite=mantegna1999] [\cite=biely2008] [\cite=bury2013]) that a large eigenvalue appears, corresponding to a collective activity of all stocks, usually named market mode. However, we did not manage to give an interpretation to the eigenvectors corresponding to the next eigenvalues in order of magnitude, as they do not seem to correspond to specific industrial or activity sectors for instance.

With increasing values of Δt, the histograms of Jeq (and Jsyn with τ  =  Δt) become broader, which is consistent with the increasing values of [formula] observed on the upper panel of figure [\ref=fig2] (and with the lower panel of figure [\ref=fig2]). The last figure of the upper panel of figure [\ref=fig3] shows that the histogram of Jsyn does not change much with τ for high values of this parameter, which [formula] indicates also on the bottom panel of figure [\ref=fig2].

[\ref=similarity] describes a more precise measurement QJJ' of the similarity between interactions matrices J and J' inferred by different methods. Figures [\ref=fig5b] (see also figure [\ref=fig5a] in the Appendix) shows that the inferred coupling matrices with different methods are much more similar than matrices whose elements are drawn at random from the same distribution, which also indicates the coherence of the different inference methods. Indeed, figure [\ref=fig5b] displays high similarities between couplings obtained from equilibrium, synchronous and asynchronous inference. Synchronous and asynchronous inference give especially close results, while equilibrium inference gives couplings which differ more from the other two methods. Let us note that synchronous and asynchronous methods infer directed networks, whereas equilibrium inference infers an undirected one. All similarities decrease when Δt increases, which might indicate that the specificity of each method appears more clearly on bigger time scales.

Financial networks

Although the spectral analysis does not distinguish industrial sectors, these can still be found in the inferred couplings, over a wide range of parameters, as figure [\ref=fig5] shows. We focus only on the largest couplings, which can be easily explained by closely related activities of the considerd stocks. The left panel of figure [\ref=fig5] shows that with equilibrium inference, more than half the stocks in the data can be displayed on a network where almost all links have simple explanations.

The following couplings in order of magnitude (not displayed on the figure) can also for some of them be given such simple explanations, but this is generally not true for small positive couplings. And negative ones do not actually give information which can be used easily, as they may simply indicate that the stocks are unrelated.

The network of the left panel of figure [\ref=fig5] presents different communities, which are most of the time determined by a common industrial activity. Some of the links are very easy to explain with the proximity of activities (and often quite robust), for instance the pairs FNM - FRE (Fannie Mae - Freddie Mac, active in home loan and mortgage), UNP - BNI (Union Pacific Corporation - Burlington Northern Santa Fe Corporation, railroads), BLS - SBC (BellSouth - SBC Communications, two telecommunications companies now merged in AT&T), NCC - PNC (National City Corp. - PNC Financial Services, now merged), HD - LOW (The Home Depot - Lowe's, both retailers of home improvement products), DOW - DD (Dow - DuPont, chemical companies), MRK - PFE (Merck & Co. - Pfizer, pharmaceutical companies), KO - PEP (The Coca-Cola Company - PepsiCo, beverages).

These two last companies display strong links with the medical sector at different scales of volume and time, as KO here with MDT (Medtronic) and JNJ (Johnson & Johnson). This medical sector is itself linked to the pharmaceutical sector with PFE, MRK, LLY (Lilly), BMY (Bristol-Myers Squibb) and SGP (Schering-Plough). Telecommunications (BLS, SBC) are linked to electric power with DUK (Duke Energy), itself linked to electric utilities with SO (Southern Company).

GE (General Electrics) is for a large range of parameters a very central node, which is consistent with its very diversified activities. On the left panel of figure [\ref=fig5], the relation between PG (Procter & Gamble) and WMT (Walmart), both retailers of consumer goods, comes at this level of interaction strength through GE.

The banking sector, with WFC (Wells Fargo), BAC (Bank of America), MER (Merrill Lynch), BSC (Bear Stearns), LEH (Lehman Brothers) has here the structure of a chain. It is linked to the sector of electronic technology: IBM, TYC (Tyco International), CA (CA Technologies, software company), TXN (Texas Instruments), ADI (Analog Devices), MOT (Motorola, telecommunications).

The defense and aerospace sector, with GD (General Dynamics), NOC (Northrop Grumman) and BA (Boeing), is linked to engines and machinery with CAT (Caterpillar Inc.) and DE (John Deere), and more strangely, to packaged food with CAG (ConAgra Foods), SYY (Sysco) and K (Kellogg Company).

Some non-intuitive links appear on different time and volume scales and with different inference methods: the links of KO with the medical sector have been mentioned, DD is linked to PG, and GD is linked here with OMC (Omnicom Group, advertising and marketing), and sometimes with UNP or HDI (Harley-Davidson, motorcycles manufacturer).

The right panel of figure [\ref=fig5] presents the results of synchronous inference in the same conditions. It shows that the results of equilibrium and synchronous inference are consistent, and that synchronous inference provides additional information, as it infers an undirected network (all this is also true for asynchronous inference). For instance, GE is clearly a node which influences others and is not strongly influenced itself at this level of interaction, and the financial sector is a directed chain. Stocks whose tickers are not indicated in the text are described in [\ref=stocks].

To sum it up, what do these results tell about financial markets? First, they go in the same direction as the results about market mode [\cite=bouchaud2003] [\cite=mantegna1999]: most of the interaction strengths found are usually positive, which indicates that the financial market has a clear collective behaviour, even when only trade and volume information is considered. Stocks tend to be traded or not traded at the same time, which can be partly explained by the fact evoked previously that the frequency spectrum of the data has a strong component corresponding to a collective motion with a frequency of one day.

However, this does not explain the fact that the strongest inferred interactions can be easily understood by similarities in the industrial activities of the considered stocks. This means that financial activity - a priori irrespectively of bullish or bearish market, as no price information is considered - tends to concentrate on a certain activity sector at a certain time. For price dynamics this phenomenon is well-known [\cite=biely2008] [\cite=bury2013] [\cite=kullmann2002], but it is more surprising that it appears also on traded volumes.

Actually, these two phenomena (collective behaviour, and strong interactions within industrial sectors), and models such as [\cite=cont2000] also support the idea that financial markets relie a lot on imitation, a fundamental social behaviour which is still very much at work in the 21st century society, as illustrated for instance by fashion trends, important news subjects, or even popular research themes. As a consequence, assessing the predictive power of such inferred models, at least on short time scales, is an interesting perspective of work.

Conclusion and perspectives

Using a mapping of complex data to binary strings, we infer Ising models on financial data, based only on traded volume information. We recover standard results of the literature (obtained using price information), and the inferred networks give a consistent picture of the financial markets. Synchronous and asynchronous inference give a directed network in agreement with the undirected equilibrium one. An obvious first perspective is then to combine this volume information to price information in a more involved mapping (which could be inspired from the relationship between price and volume [\cite=karpoff1987]), to obtain new insights about the interactions on the stock market. Indeed, price is usually more studied, because it corresponds essentially to the economic value of the considered stock on the market.

More immediate perspectives would be to study the influence of the time scale parameter τ of synchronous and asynchronous inference, and also to study close mappings using only volume information. Indeed, instead of using the average volume traded per unit of time as a reference, other variables characterizing the stock could be used, in order to obtain different information, for instance an indicator of the economic size of the considered company, such as revenue, operating income or total assets.

Other immediate possibilities would be to introduce a regularization (L1 for instance), which would be a clearer way than thresholding to determine which interactions are meaningful. And also, to overcome a limit of our method, which is that for big scales of both volume and time, some stocks may have a -1 average magnetization (meaning that no traded volume exceeded the threshold on the whole period), which prevents us from inverting the correlation matrix and doing the inference. A solution to explore as a perspective of this work would be to take these stocks off the data, because they are inactive on these time and volume scales. It would even make sense to also ignore all stocks which do not have significant activity on these scales.

Finally, to test the results of different inference methods, the predictive power of such models (assessed for instance by measuring the distance between data generated by the model and real data following the period on which inference was done) on different time and volume scales could be a valuable indicator of their worth. With additional price information, this predictive power can be expected to be greater. It is also an interesting perspective from a financial engineering point of view, with different goals.

Acknowledgements

The authors thank Matteo Marsili for providing the data, and acknowledge interesting discussions with Erik Aurell, Matteo Marsili and Iacopo Mastromatteo. This work was supported by funding from the Center of Excellence program of the Academy of Finland, for the COMP Center.

References

Inference methods

The mapping described in section [\ref=data] provides us with time series si(t) for each stock. With this, it is natural to define local magnetizations mi and correlations Cij(τ) as follows:

[formula]

where 〈.〉t denotes time averaging over the whole data length.

Several inference methods have been developed recently. We focus here on mean-field approximation, using three different versions, which can be described as follows. Let us first present the inference formula for coupling strengths, which differs for each method:

Equilibrium inference, which focuses on equal time correlations [\cite=Kappen1998]

[formula]

Synchronous inference is suitable for non-equilibrium inference, and considers also time-lagged correlations with a time lag τ in addition to equal time correlations [\cite=roudi2011]:

[formula]

Asynchronous inference, also modeling non-equilibrium processes, uses the derivative of the time-lagged correlations [formula] [\cite=zeng2013]:

[formula]

And the inference formula for fields is each time the same:

[formula]

The main difference between the two last methods is that synchronous inference assumes that all spins are proposed to update in parallel at discrete time instances, while asynchronous inference does not have a such assumption: update times themselves are stochastic variables. The asynchronous method is supposedly more powerful, as it monitors the decay in time of all pair correlations, and thus the time derivative [formula] appears in the formula.

It can be remarked that, in addition to the mapping parameters ΔT and χ, the synchronous and asynchronous inference methods have a parameter τ, which is in these respective cases the considered time-lag of correlations, and the time scale on which the derivative of correlations dC(τ) / dτ|τ = 0 is computed. For the asynchronous case, this time scale does not appear explicitly in the formula, but arises when the derivative is computed from the data.

Similarities

We want to study more precisely the closeness between couplings obtained with different methods. The distributions presented on figure [\ref=fig3] give a first idea, but we want to assess how similar individual couplings Jij and J'ij are. To this end, we introduce for two coupling matrices Jij and J'ij a similarity measure QJJ' given by

[formula]

This measure considers actually these coupling matrices as the vectors containing all their elements, compares them one by one and gives a global similarity measure. It takes real values between 1 (when Jij = J'ij for all i and j) and -1 (when Jij =  - J'ij for all i and j), and values close to zero indicate uncorrelated couplings. For comparison with the similarity measures obtained between two different methods on figure [\ref=fig5b], we show on figure [\ref=fig5a] that this similarity measure takes small values (smaller than 0.02 in absolute value) when all elements of the vectors Jij and J'ij are drawn independently at random from the same Gaussian distribution, of mean 0, and for different values of the standard deviation of this distribution. Negative values are even obtained sometimes, as can be expected from the formula defining QJJ'. However, figure [\ref=fig5b] displays much bigger similarities between the different inference methods.

Description of stocks