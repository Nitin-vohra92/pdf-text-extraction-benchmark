EFFECTIVE FREE ENERGY FOR INDIVIDUAL DYNAMICS

Introduction

The intricate relations between the individual and collective levels are at the heart of many natural and social sciences [\cite=grauwin2009]. Physics looks at the collective level, selecting the configurations that minimize the global free energy [\cite=goodstein]. In contrast, economic agents behave in a selfish way, and equilibrium is attained when no agent can increase its own satisfaction [\cite=mascolell].

Recently, physicists have tried to use statistical physics approaches to understand social phenomena such as the segregation transition [\cite=dallasta] [\cite=vinkovic06]. The idea seems promising because statistical physics has successfully bridged the gap between the micro and macroscopic levels for physical systems governed by collective dynamics. However, progress remained slow due to the lack of an appropriate framework allowing to take into account the selfish dynamics typical of socio-economic agents. On the other hand, game theorists have developed in the last decades the notion of Potential Games, in which each player's gain resulting from a change of state is equal to the variation of a potential function [\cite=anderson92] [\cite=young93] [\cite=monderer96] [\cite=ui2000svr]. This potential function hence provides what physicists need: a link between individual and collective levels.

In this paper, we propose a generic analytical framework that builds on concepts originating both from statistical physics and game theory. We introduce a rigorous generalization of the physicist's free energy, which encompasses individual dynamics. By introducing a "link" state function that is maximized in the stationary state, we pave the way to analytical treatments of a much wider class of systems, where dynamics is governed by individual strategies. Quantitative solutions of two models are also provided as examples.

The Model

Generic model

Our model represents in a schematic way the dynamics of agents making individual choices. Throughout this paper, [formula] denotes a finite set of agents, [formula] the choice of agent i∈N, the vector [formula] describing the state of the system and Nq (resp. nq) the set (resp. number) of agents following choice [formula]. Each agent i∈N can moreover be characterized by his utility function, which describes the degree of satisfaction concerning his choice. An agent's utility function is supposed to depend only on his own choice and on the set Nqi of agents making the same choice, namely [formula]. We also introduce the collective utility, defined as the total utility of all the agents: [formula].

The dynamical rule allowing the agents to change their choice is the following. At each time step, one picks up at random an agent and a choice [formula]. Then the agent goes from choice qi to choice qi' = q* with probability:

[formula]

where [formula] is the variation of the agent's own utility upon his change of choice. The parameter T > 0 is a "temperature" that introduces in a standard way some noise on the decision process [\cite=anderson92]. It can be interpreted as the effect of features that are not explicitly included in the utility function but still affect the decision.

We wish to find the stationary probability distribution [formula] of the microscopic configurations [formula]. If Δui can be written as [formula], where [formula] is a state function of the configuration [formula], then the dynamics satisfies detailed balance [\cite=evans] and the distribution [formula] is given by

[formula]

with Z a normalization constant.

It can be shown [\cite=grauwin2009] [\cite=ui2000svr] that a sufficient and necessary condition for a "linking" function L to exist is

[formula]

for any i∈N and j∈N. Note that this relation is automatically satisfied in the case qi  ≠  qj. Eq. ([\ref=cond]) expresses a symmetric condition on the utility variation (or externality) an agent produces on another one when he changes his choice. Condition Eq. ([\ref=cond]) is also rather easy to satisfy in case of homogeneous agents sharing the same utility function (see examples in section [\ref=appl]). In contrast, this condition imposes more restriction to models with heterogeneous agents and explicit examples are then more difficult to build.

Interestingly, the linking function L appears as (the opposite of) an effective energy in terms of physical systems (Eq. ([\ref=eq2]) being the analogue of a Gibbs distribution), but also corresponds to the notion of potential function in game theory [\cite=monderer96] [\cite=ui2000svr].

Homogeneous agents

In the following, we restrict our study to models where the agents' utility functions can be written as [formula], where H is a parameter characterizing the typical number of agents making a given choice (for instance the natural capacity of an infrastructure). This parameter is assumed to scale linearly with N, the ratio h = H / N being fixed. This particular form of utility function implies that the agents share homogeneous properties and that they are sensitive to the relative proportion of agents making the same choice as them. It also implies that Eq ([\ref=cond]) is verified, meaning that a linking function L always exists. It is straightforward to check that it can be written as :

[formula]

In the limit N  →    ∞   with ρq = nq / H fixed, one finds

[formula]

This particular form of the potential function L allows us to interpret it as the sum of the individual marginal utilities gained by agents as they progressively enter the system after leaving a reservoir of zero utility (a similar interpretation can be found in [\cite=mascolell2]).

Since the agents are supposed to be identical (but still distinguishable), it seems natural to keep track of "mesoscopic" observables such as the coarse-grained states [formula] rather than the "microscopic" states [formula]. The number of states [formula] corresponding to a given coarse-grained state x is quantified by its logarithm S(x), where:

[formula]

The stationary distribution of the coarse-grained configurations hence takes the form:

[formula]

where [formula] can be seen as (the opposite of) an effective free energy of the system, Z'N,T = ZN,Th- N and where

[formula]

In the limit N  →    ∞   with ρq = nq / H fixed, one finds

[formula]

According to the form of the distribution ΠN,T given by Eq ([\ref=piinf]), in the limit of large N the stationary configurations are those that maximize the sum [formula] under the constraint [formula]. We explore different maximization procedures in examples of applications presented in next section.

Applications

Road congestion

We apply here our generic model framework to a simplified version of Chu's [\cite=chu1995] congestion model. In this model, a number N of identical commuters travel every morning from home to work. All agents travel on the same road and wish to arrive at time t*. Since congestion is a collective phenomenon that no single agent can master to arrive at her preferred arrival time t*, agents have to choose a less optimal arrival time [formula] (time is supposed to be discrete) in order to minimize the private trip cost, c(t), which includes two parts. The first part is the travel time cost αTT(t) where α is the unit cost of travel time and TT(t) is the travel time. The second part is the schedule delay cost, which is β(t* - t) if one arrives early and ν(t - t*) if one arrives late, β and ν being unit costs of schedule delay. To make analytical calculations possible, the travel time is supposed to depend on the number nt of commuters arriving at time t through the function TT(t)  =  (nt / H)γ where H and γ are fixed parameters. The parameter H can be interpreted as a standard road capacity (the linearity between H and N can thus reflect that bigger roads are built when the traffic is more important) and the parameter γ measures the elasticity of travel time with respect to nt.

This congestion model fits our framework model, the utility of an agent arriving at time t being

[formula]

The stationary coarse-grained configurations in the limit of large N are thus those that maximize the sum [formula], where:

[formula]

under the constraint [formula]. Since the sum [formula] is maximized by the stationary configuration, the stationary values of {ρt} verify (for any t such that ρt  ≠  0) the relation:

[formula]

which can be easily derived using Lagrange multipliers. Eq ([\ref=cong3]) provides for each time step t an implicit relation between ρt and ρt* (resp. the normalized densities at time t and t*). All these implicit relations along with the conservation of the number of agents expressed by the condition [formula] allow one to compute numerically the distribution {ρt}. Fig. [\ref=congestion] presents results that have been computed with this method, for N  →    ∞   and for a finite value (N = 5000) of the number of agents obtained by solving numerically an equivalent of Eq. ([\ref=cong3]). These results suggest that finite size effects remain small as soon as N reaches values of a few thousands, and that the main properties of the model can be studied in the limit N  →    ∞  . Notice that our analysis of the congestion model in terms of a potential games allows us to determine (numerically) the stationary state of the systems even for finite size, which is rarely possible with usual economics analysis since, quoting [\cite=otsubo2008], the common practice in transportation science and economics is to use continuous models for analyzing phenomena that are essentially discrete.

Residential choice

As a second example, we apply our generic framework to a Schelling-like model describing the dynamics of residential moves in a city [\cite=grauwin2009] [\cite=schelling78]. The virtual city is divided into Q blocks (Q  ≫  1), each block containing H cells or flats (Fig [\ref=segr1]). We assume that each cell can contain at most one agent, so that the number nq of agents in a given block satisfies nq  ≤  H. An agent's utility depends only on the density ρq = nq / H of the block he is living in, ie [formula], with the convention that u(ρ) =  -   ∞   for ρ  >  1.

Once again, this residential model can be solved thanks to our framework. With the particular choice of the asymmetrically peaked utility function given Fig [\ref=segr1](a), the stationary coarse-grained configurations in the limit of large N are thus those which maximize the sum [formula], where :

[formula]

To perform the maximization procedure, one can follow standard physics methods used in the study of phase transitions (like liquid-vapor coexistence [\cite=callen85]). In this case, it is a simple exercise to determine that for N  ≫  1 and in the limit T  →  0, a phase separation occurs. A fraction [formula] of the blocks have a density [formula] while the others are empty. This result is illustrated on Fig. [\ref=segr1]. For more details on the maximization procedure, the interested reader is referred to [\cite=grauwin2009].

Discussion

We derived in this paper an effective free energy F = L + TS in a generic framework model. The main property of this function is to intimately connect the individual and global points of view. Our simple model raises a number of interesting questions: in the limit T  →  0, the stationary configurations are those maximizing the potential L and not the collective utility U. Hence, they may differ from the simple collection of individual optima [\cite=kirman92], illustrating the unexpected links between micromotives and macrobehavior.

More specifically, we derived a simple expression of this effective free energy in the thermodynamic limit N  →    ∞   for homogeneous agents. We showed that this simple form allows us to derive in an easy and flexible way quantitative solutions to economics models based on individual dynamics. This approach can be extended to some models with heterogeneous agents. Possible examples range from a two-population residential segregation model [\cite=grauwin2009], Ising-like model with heterogeneous pairs interactions [\cite=nadal2005physique], or the Hopfield model [\cite=ui2000svr].