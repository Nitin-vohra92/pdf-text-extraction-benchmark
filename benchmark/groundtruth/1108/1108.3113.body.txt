Theorem Corollary Lemma Proposition Claim Definition Example Problem Conjecture Remark

Cubes of integral vectors in dimension four

plus 2.5pt

Introduction and main results

Two vectors are called twins if they are orthogonal, and have the same length. An m-icube in [formula] is a sequence [formula] of nonzero vectors in [formula] that are twins pairwise. The common length of the vectors [formula] is the edge length of the icube. By the norm of [formula] we mean the square of its length. The main object of this paper is to study how icubes can be constructed, extended and counted. The paper [\cite=GKMS08] investigates these questions extensively in [formula], using the number theory of quaternions.

For a trivial example, if the dimension is even, then every vector [formula] has a twin, namely [formula]. Similarly, the rows of the matrix

[formula]

form an 8-icube, proving that every 8-dimensional integral vector can be extended to an 8-icube. The above matrix comes from the multiplication table of Cayley-numbers. The 4  ×  4 minor in the upper left corner yields a 4-icube in dimension 4, extending an arbitrary element of [formula].

Classical results of Hurwitz [\cite=H23] and Radon [\cite=R22] show, however, that a similar "permutational" extension is possible only in dimensions 1, 2, 4 and 8 (an interesting approach using extraspecial 2-groups is given by Eckmann in [\cite=E43]). To prove further extension theorems we have to explore the number-theoretic structure of the components of the vectors. An example for this type of argument is the Euler-matrix

[formula]

which is a "typical" 3-icube in dimension 3 (see [\cite=Sar61] and [\cite=GKMS08]). We start with an extension theorem that generalizes Corollary 5.11 of [\cite=GKMS08].

Let [formula] be an n - 1-icube in [formula], where n  ≥  2. If n is even, then this icube can be extended to an n-icube. If n is odd, then such an extension is possible if and only if the common length of the vectors [formula] is an integer.

Note that this extending vector, if exists, is obviously unique up to sign.

Let N denote the edge norm of [formula]. By Proposition 1.3 of [\cite=GKMS08], if n is odd, then the edge length of any n-icube in [formula] is an integer. Therefore an extension is only possible if n is even or if N is a square.

Define L to be the n  ×  (n - 1) matrix whose columns are [formula]. Then LTL = NIn - 1 (where In - 1 denotes the identity matrix). The Cauchy-Binet formula therefore implies that

[formula]

where Li is the minor of L obtained by deleting the i-th row.

Let Mi = ( - 1)n + i det (Li). Add a last column to L whose entries are Mi / N(n - 2) / 2, and denote the resulting matrix by K. Then the columns of L are pairwise orthogonal by the Laplace expansion theorem for determinants. The displayed formula above shows that KTK = NIn. This implies that KKT = NIn. Denote the rows of L by si. We get that the scalar product of si by itself, which is an integer, equals N - M2i / Nn - 2. Therefore if n is even or if N is a square, then N(n - 2) / 2 divides Mi, and the last column of K consists of integers.

Here are the main results of this paper.

Every m-icube in [formula] can be extended to a 4-icube for 1  ≤  m  ≤  3.

Of course, the only nontrivial case occurs when m = 2, according to the statements above. The proof is found at the end of Section [\ref=sec_twin].

The following result, proved in Section [\ref=sec_count], counts the number of m-icubes in [formula]. Denote by fm(N) the number of m-icubes with edge norm N (that is, edge length [formula]) in [formula]. A famous theorem by Jacobi provides the value of f1(N), we include it for comparison. Let [formula], thus c1 = 8, c2 = 48, c3 = 192 and c4 = 384. Furthermore, if p is a (positive) odd prime and k  ≥  1, then define

[formula]

Let gm(N) = fm(N) / cm. Then gm is a multiplicative function for every 1  ≤  m  ≤  4, whose value on prime powers is given by the following formulae, where p is an odd prime and k  ≥  1.

gm(2k) = 3 for every k  ≥  1.

g1(pk) = σ(pk) = (pk + 1 - 1) / (p - 1) (this is Jacobi's classical result) and g3(pk) = g4(pk) = g(pk) (the function defined before the theorem).

If [formula], then g2(pk) = g(pk). If [formula], then g2(pk) = (k + 1)pk.

In particular, we have that f4(N) = 2f3(N).

The proofs are based on a representation theorem of icubes using Hurwitz integral quaternions (see Theorems [\ref=twin_decomp_thm], [\ref=twin_decomp_odd], [\ref=icube_unique] and [\ref=icube_unique2]).

Integral quaternions

We review some properties of integral quaternions. The general references are [\cite=CS03], [\cite=H19] and [\cite=HW79], but we ask the reader to browse Section 2 of [\cite=GKMS08] for background, as we shall use the notation and the results introduced there. The norm of α = a + bi + cj + dk is [formula]. This α is a Hurwitz integral quaternion if 2a,2b,2c,2d are all integers of the same parity. Hurwitz integral quaternions form a left Euclidean ring [formula]. The ring of quaternions with integral coefficients is denoted by [formula] (these are the Lipschitz integral quaternions). The sign α|β means: α divides β on the left in [formula]. The ring [formula] has 24 units. Every element α of [formula] has a left associate in [formula] and a right associate in [formula].

An integral quaternion is irreducible in the ring [formula] if and only if its norm is a prime in [formula]. The only elements of [formula] whose norm is 2 are 1 + i and its left associates. If p > 2 is a prime in [formula], then there exist exactly 24(p + 1) integral quaternions whose norm is p.

We shall reduce questions to quaternions having odd norm, using the following assertion.

(1) can be shown by direct calculation. Since [formula] for every odd integer m, we see that [formula] is divisible by 8 if and only if a, b, c, d are all even, so (2) holds. By the same argument, if [formula], then a, b, c, d are all even, or are all odd. In the first case we have (3), since 2 = (1 + i)(1 - i). In the second case (3) also holds by (1). Now suppose that [formula]. Then two numbers of a, b, c, d are even and two are odd. If [formula], then [formula], so (1) shows that (1 + i) can be pulled out from α, but 1 + j and 1 + k cannot.

Next we investigate quaternions with integral coefficients having odd norm. Let K = {1,i,j,k}, and write a general quaternion [formula] as a1 + aii + ajj + akk. For g∈K define

[formula]

So for example the elements of Si are those where the coefficient of i is odd and the other coefficients are even, or vice versa. Let *   denote the Klein-group multiplication on K (which is quaternion-multiplication, but disregards the signs). Call two nonzero quaternions twins if so are the vectors formed by their coefficients. The following claim summarizes well-known, easy facts.

If [formula], then α has exactly one odd component. If [formula], then α has exactly one even component. Suppose that α and β are twins in Sg. Then [formula] implies that the scalar product of the corresponding vectors is congruent to 1 modulo 2, which is impossible, since they are orthogonal. If [formula], then this scalar product is congruent to 3 modulo 2, also a contradiction. This shows (1). The proofs of (2) - (4) are left to the reader.

Suppose that α∈S1 and αγ  =  δ∈Sg. Then [formula]. Since [formula] is odd, this implies that [formula]. The norm of γ is odd, so (5) follows from (4).

Call a quaternion α primary if α∈S1 and [formula]. Obviously, if α∈S1, then exactly one of α and -  α is primary.

Statement (3) clearly follows from Claim [\ref=Sg_elementary] (5). The rest of the proof is left to the reader.

We close this section with two counting results. Call a quaternion with integral coefficients primitive, if its coefficients are relatively prime.

A pure quaternion is one with real part zero.

(In other words, sp = ( - 1)(p - 1) / 2 = ( - 1 / p) as a Legendre-symbol).

Theorem 4.8 in [\cite=GKMS08] implies that the number of primitive vectors (x,y,z) with norm N2 is 6q(N). By Lemma [\ref=3repr], the quaternions corresponding to such vectors can be written as [formula] for some [formula]. Conjugacy with the units in [formula] yields an equivalence relation on the set of all such elements θ. The fact that θ is primitive, but not a unit implies that at least two of its components are nonzero. Therefore each conjugacy class has 12 elements (the stabilizer is just {1, - 1} in each case). It is sufficient to show that exactly two of these conjugates can be written in the form [formula] such that γ is primary.

If [formula], then Claim [\ref=Sg_elementary2] shows that γ  =  εα, where ε is a unit and α is primary. Therefore θ has a conjugate of the required form, namely [formula]. Exactly one of [formula] is primary, and [formula] is a conjugate of θ that is different from θ.

Conversely, suppose that θ has two conjugates [formula] and [formula] such that γ1 and γ2 are primary. Thus [formula] for some unit ε. By the uniqueness statement of Lemma [\ref=3repr], εγ1  =  γ2ρ for some ρ∈{1, - 1,i, - i}. Claim [\ref=Sg_elementary2] shows that ε∈Q, and Claim [\ref=Sg_elementary] (5) gives that ε  =    ±  ρ. If ε  =    ±  1, then θ1  =  θ2. If ε  =    ±  i, then [formula].

There is an alternative argument for the previous statement: the reader may go through the proof of Theorem 4.8 in [\cite=GKMS08], and modify it in such a way that only primary prime factors are used when building γ.

Construction and extension

We shall speak about m-icubes [formula] in [formula] and in [formula], meaning that this is a sequence of simultaneous twins such that each [formula] lies in [formula] or in [formula], respectively.

If α = a1 + aii + ajj + akk and β = b1 + bii + bjj + bkk, then the real part of αβ is a1b1 - aibi - ajbj - akbk. Therefore the vectors corresponding to α and β are orthogonal if and only if the real part of [formula] is zero (if and only if the real part of [formula] is zero). However, the real part of a quaternion is zero if and only if its conjugate is its negative.

If γ  ≠  0, then α and β are twins if and only if αγ and βγ are twins if and only if γα and γβ are twins.

If p|α, then every [formula] with norm p divides α both on the left and on the right, since [formula] (and such an element exists by Theorem [\ref=quat_irred]). If α is not divisible by p, then Lemma [\ref=quat_lnko] yields a left divisor [formula] with norm p. Applying this lemma to [formula] we get a right divisor π2 of α with norm p. Similarly, β has a left divisor π3 and a right divisor π4 of norm p. We also see that if α or β is divisible by p, then π1  =  π3 and π2  =  π4 can be achieved, so the statement of the lemma holds both on the left and on the right.

Thus we can assume that α and β are not divisible by p. By Lemma [\ref=twin_char], we have [formula]. Suppose first that this quaternion is not divisible by p. The uniqueness statement of Lemma [\ref=quat_lnko] can be applied to [formula], so π1 and π3 are right associates, and the statement of the lemma holds on the left.

If [formula] is divisible by p, then apply Lemma [\ref=twin_primeprop] to [formula], [formula], [formula]. We get that [formula], so π2 is a right divisor of β, too, and the statement of the lemma holds on the right.

Lemma [\ref=quat_lnko] yields a left divisor [formula] of [formula] and a right divisor [formula] of [formula] with norm p. If p does not divide [formula], then [formula] and [formula] are essentially unique, otherwise they can be chosen arbitrarily. Thus we can disregard those [formula] that are divisible by p, and can assume (to simplify notation) that no [formula] is divisible by p.

Consider the complete graph on [formula]. Color the edge {u,v} to Lilac if πu and πv are right associates, and to Red if ρu and ρv are left associates (any edge can carry both colors). The previous lemma shows that every edge has a color. By uniqueness, the lilac edges, as well as the red edges yield a transitive relation. This implies by an elementary graph-theoretic argument that either every edge is lilac, or every edge is red.

Recall that Q = {  ±  1,  ±  i,  ±  j,  ±  k}. We characterize icubes in [formula] first.

Let [formula] be an m-icube [formula]. Then there exist [formula] and an m-icube [formula] such that ε1 = 1 and [formula] for every [formula]. Conversely, every such [formula] is an m-icube in [formula].

Corollary [\ref=twin_char_cor] implies that [formula] is an m-icube. Conversely, suppose that [formula] is an m-icube in [formula]. Applying Lemma [\ref=icube_param] and Corollary [\ref=twin_char_cor] several times successively we see that [formula] for some [formula] and units [formula]. Replacing γ by γε1 we can assume that ε1 = 1. Then [formula] is an m-icube by Corollary [\ref=twin_char_cor]. Since 1 and [formula] are twins, the real part of each [formula] is zero for [formula], and therefore [formula] has integer coefficients.

To prove extension results we have to characterize icubes in [formula]. To count them, we need uniqueness in the above decomposition. To achieve these ends we reduce the problem to quaternions with odd norm. The next statement is clear by Claim [\ref=twin_even].

By the proof of Claim [\ref=twin_even] we see that exactly two of the components of every [formula] are even. Since the vectors corresponding to [formula] are pairwise orthogonal, looking at the scalar products modulo 2 we see that these two-element subsets of the indices are either equal or disjoint. Thus (1) of Claim [\ref=twin_even] shows that the same element of {1 + i,1 + j,1 + k} can be pulled out of each αi on the left. This shows that every m-icube of edge norm D yields exactly three m-icubes of edge norm 2D.

To each m-icube [formula] with odd edge norm assign the unique sequence [formula] with the property that [formula] for every [formula] (see Claim [\ref=Sg_elementary]). This sequence is called the type of [formula]. By Claim [\ref=Sg_elementary] (1), the elements [formula] are pairwise different. Call an m-icube [formula] orderly, if its type is (1) or (1,i), or (1,i,j), or (1,i,j,k), depending on m.

Permuting the components of vectors preserves norm as well as orthogonality. If [formula] and [formula] are types, then one can fix a permutation r of K that maps each [formula] to [formula]. This permutation induces a bijection on [formula]:

[formula]

If [formula] has type [formula], then [formula] has type [formula], so the number of m-icubes of type [formula] does not depend on [formula]. The number of possible types is [formula]. Hence:

Let γ and [formula] be primary quaternions, and ε1  =    ±  1, ε2  =    ±  i, ε3  =    ±  j and ε4  =    ±  k. Then [formula] is an orderly m-icube in [formula]. Conversely, every orderly m-icube in [formula] with odd edge norm can be obtained this way.

Since γ and δ are primary, [formula] is orderly by (4) of Claim [\ref=Sg_elementary]. Conversely, suppose that C is an orderly m-icube in [formula] with odd edge norm. Apply Lemma [\ref=icube_param] successively, but in every step make sure that π is primary (this can be done by Claim [\ref=Sg_elementary2]). Claim [\ref=Sg_elementary] ensures that after pulling out π we get an orderly icube in [formula]. Thus we get a representation [formula], where γ and δ are primary. Since [formula] is orderly, ε1  =    ±  1, ε2  =    ±  i, ε3  =    ±  j and ε4  =    ±  k.

Now we prove the extension property (Theorem [\ref=main_extension]). Suppose that an m-icube C in [formula] is given. Claims [\ref=odd_reduction] and [\ref=odd_reduction_2] show that we can write C as [formula], where [formula] is an m-icube in [formula] with odd edge norm. By rearranging the coordinates of the vectors we get an m-icube of the form [formula] by Theorem [\ref=twin_decomp_odd]. This clearly extends to an m + 1-icube [formula]. Permuting the coordinates back, and then multiplying by η we get the desired extension of C.

Counting

To deal with the case m = 3 and m = 4 we prove uniqueness in Theorem [\ref=twin_decomp_odd]. We keep the notation that ε1  =    ±  1, ε2  =    ±  i, ε3  =    ±  j and ε4  =    ±  k.

Multiply the first equation by the conjugate of the second. We obtain that [formula]. Now multiply on the left by [formula] and on the right by γ2, and then simplify by [formula].

An m-icube is called primitive, if the 4m components of its m vectors have no common divisor other than ±  1.

Suppose that m  ≥  3 and [formula] are two representations of an icube given by Theorem [\ref=twin_decomp_odd], where γ1 and γ2 are primitive. Then γ1  =  γ2 and δ1  =  δ2. Furthermore, such an icube [formula] is primitive if and only if γ1 and δ1 are both primitive.

Lemma [\ref=twin_unique] shows that [formula] permutes with [formula] and with [formula]. Therefore [formula] is a real number. As γ1 and γ2 are primary, [formula]. We have [formula]. Since γ1 and γ2 are primitive, the gcd of the coefficients of the two sides of this equation is [formula]. Therefore γ2  =    ±  γ1. Since they are primary, they are equal. Then γ1ε1δ1  =  γ2ε1δ2 yields δ1  =  δ2.

Now let [formula] such that γ1 and δ1 are primitive and assume to get a contradiction that C is not primitive. Write C as cC', where c > 1 and C' is a primitive m-icube. Then C' can be represented as [formula], where γ3 must be primitive, so C has a representation [formula]. Here cδ3 is also primary, since c is a positive odd integer. The uniqueness statement proved in the previous paragraph shows that δ1 = cδ3, contradicting the assumption that δ1 is primitive.

Suppose that m  ≥  3 and N is an odd integer. Then the number of orderly, primitive m-icubes with edge norm N is

[formula]

Here [formula], where p runs over the prime divisors of d.

Recall that h(d) is the number of primitive, primary quaternions with norm d by Claim [\ref=twin_primary_count]. Consider the unique representation given by Theorem [\ref=icube_unique], and let [formula]. Then [formula]. These two quaternions can be chosen h(d)h(N / d) ways, and d can be any divisor of N. Finally, there are 2m possibilities to chose the signs of [formula].

We can now compute f4 as stated in Theorem [\ref=main_count]. Fix m = 4 and write N = 2nD, where D is odd. By Claims [\ref=odd_reduction] and [\ref=odd_reduction_2] we have that f4(N) = 3f4(D) if n  ≥  1. Next Claim [\ref=odd_reduction_1] shows that f4(D) = 24M, where M is the number of orderly m-icubes with edge norm D. Finally, each orderly m-icube can be written uniquely as C = cC', where c is a positive integer and C' is primitive. Clearly, c|D2, and therefore

[formula]

where k is the function defined in Corollary [\ref=icube_orderly_count] for m = 4. Thus

[formula]

It is a well-known fact that the convolution of multiplicative functions is multiplicative. Since h is obviously multiplicative, so is k / 16, which is the convolution of h by itself. The function assigning 1 to squares and 0 to all other integers is also multiplicative, so the double sum above (which is f4(D) / 384) is also multiplicative for odd values of D. Finally the remarks at the beginning of this argument show that f4(N) / 384 is multiplicative on the set of positive integers.

The proof above clearly shows that f4(2n) = 384  ·  3 for n  ≥  1. If p is an odd prime, then it is a routine calculation to prove, using the last displayed formula, that the value of f4(pn) is the one given in (2) of Theorem [\ref=main_count]. This somewhat complicated summation is left to the reader.

To show that f3(N) = f4(N) / 2 one can either go through the argument above with m = 3, or invoke Theorem [\ref=main_extension_gen] (stating that each 3-icube has exactly two extensions in dimension 4). To compute f2(N) we need to improve Theorem [\ref=twin_decomp_odd], since uniqueness does not hold for m = 2.

Every orderly 2-icube in [formula] with odd edge norm can be written in the from (γε1δ,γε2δ), where γ and [formula] are primary quaternions such that [formula] is primitive and ε1  =    ±  1, ε2  =    ±  i. Here γ and δ are uniquely determined. Such an icube is primitive if and only if δ is primitive as well.

Theorem [\ref=twin_decomp_odd] yields a decomposition C = (γε1δ,γε2δ). Suppose that [formula] is divisible by a prime p. Apply Lemma [\ref=twin_param] to α  =  γ and β  =  γi. We get that there is a primary π with norm p that divides both γ and γi on the right. Let γ  =  γ1π (so γ1 is primary). Now γi = γ1πi is right divisible by π, so the uniqueness statement of Lemma [\ref=quat_lnko] shows that πi = επ for some unit ε. As π is primary, Claim [\ref=Sg_elementary2] gives that ε∈Q, so ε∈Si by Claim [\ref=Sg_elementary], that is, ε  =    ±  i. Therefore we can write C as [formula]. Applying this several times we get a representation where [formula] is primitive.

Suppose that C = (α1,α2) = (γ1ε1δ1,γ1ε2δ1) = (γ2ε1δ2,γ2ε2δ2) are two representations such that [formula] are both primitive. Then [formula]. Here [formula], and therefore this quaternion determines [formula] as the positive gcd of its coefficients. Thus [formula] and [formula]. The uniqueness statement of Lemma [\ref=3repr] shows that γ1  =  γ2, since both are primary. Thus δ1  =  δ2 as well. The uniqueness statement in the last sentence of the theorem can be proved exactly as in Theorem [\ref=icube_unique].

Suppose that N is an odd integer. Then the number of orderly, primitive 2-icubes with edge norm N is

[formula]

where p runs over the prime divisors of d and the functions q and h are given by Claim [\ref=twin_count2] and Claim [\ref=twin_primary_count], respectively.

Consider the unique representation given by Theorem [\ref=icube_unique2], and let [formula]. Then [formula]. These two quaternions can be chosen q(d)h(N / d) ways by the claims quoted in the corollary, and d can be any divisor of N. Finally, there are 4 possibilities to chose the signs of ε1 and ε2.