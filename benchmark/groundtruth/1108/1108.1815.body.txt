1em

1em

A problem of Ramanujan, Erd os and Kátai on the iterated divisor function

Introduction

Let d(n) denote the number of positive divisors of an integer n. The extreme large values of d(n) were studied by Wigert [\cite=Wigert:1907], (see also [\cite=HardyWright]). Wigert proved that

[formula]

Here log kx denotes the k-th iterate of the logarithm. The lower bound comes from considering integers of the form [formula], where pj denotes the jth smallest prime. Here d(Nk) = 2k, while log Nk  ~  k log k by the prime number theorem. In his seminal 1915 paper on highly composite numbers [\cite=Ramanujan:1915], Ramanujan gave a more precise asymptotic for m1(x). At the very end of his paper, Ramanujan posed the problem of finding the extreme large values of d(d(n)). By considering integers of the form

[formula]

Ramanujan showed that

[formula]

The problem of finding the order of m2(x) has been mentioned in Erds [\cite=Erdoes], Ivi [\cite=Ivic:1995], and has been mentioned by Ivi in problem sessions in Ottawa [\cite=Ivic:1999] and Oberwolfach.

Erds and Kátai [\cite=Erdoes:1969] showed m2(x)  =  ( log x)1 / 2( log 2x)O(1) (see (4.1) on p. 270 of [\cite=Erdoes:1969]). Twenty years later Erds and Ivi [\cite=Erdoes:1989] improved the upper bound to

[formula]

Smati [\cite=Smati:2005] [\cite=Smati:2008] gave a further improvement

[formula]

the best estimate known to date. Constructions similar to Ramanujan's seem rather natural, and one might expect that [formula]. This is indeed the case, as we now show. More precisely, we prove an asymptotic formula for m2(x) with an error term.

We have

[formula]

where

[formula]

In particular, Theorem [\ref=m2] implies that

[formula]

Ramanujan's examples [\eqref=Rama1] are seen to be suboptimal with respect to the constant c, since [formula].

There is a closely related problem, to estimate the extreme values of ω(d(n)), where ω(n) is the number of distinct prime factors of n. In fact, both Erds and Ivi [\cite=Erdoes:1989] and Smati [\cite=Smati:2008] obtained upper bounds for d(d(n)) by first bounding ω(d(n)) and then using the elementary inequality log d(m)  ≪  ( log 2m)ω(m) (see, e.g., Lemme 3.3 of [\cite=Smati:2005] or Lemma [\ref=domega] below). For this problem, Ramanujan's examples [\eqref=Rama1] are essentially optimal, providing the true order and constant in the asymptotic for [formula].

We have

[formula]

Previously, Erds and Ivi [\cite=Erdoes:1989] had shown

[formula]

and later Smati [\cite=Smati:2005] found the true order [formula].

The lower bound in Theorem [\ref=m2]

Notation and basic prime number estimates. Throughout, we make use of the asymptotic

[formula]

which is a simple consequence of the prime number theorem with error term [formula]. Here π(x) is the number of primes which are [formula]. We also denote by Ω(n) the number of prime power divisors of n.

Let x be large and define [formula] Let

[formula]

and let

[formula]

The Taylor expansion of [formula] shows that a1  =  ⌊(21 / t - 1)- 1⌋  =  t /  log 2 + O(1). By [\eqref=ai], for every positive integer j, there are [formula] indices i with [formula]. Also, [formula]. Using [\eqref=pj], we have [formula], hence

[formula]

From yj = O(t / j) and the definition of c we obtain

[formula]

From the definition of t, [formula] and log 2t =  log 3x  +  O(1). Thus,

[formula]

Hence, if x is large enough, then [formula]. From the definition of n above, we have [formula]. Therefore,

[formula]

Proof of the upper bound in Theorem [\ref=m2]

Let mN  =   min {m:d(m) = N} and write [formula]. We have

Using [\eqref=pj] and taking k = 1, we see from (iii) that if r is large, then [formula] is prime for [formula]. Also, by (iii), [formula] for all j.

(i) This is trivial and was observed by Ramanujan [\cite=Ramanujan:1915].

(ii) If N'|N, we can find [formula] for each j such that [formula], and clearly [formula].

(iii) If pj  >  p1 / 2kr + 1 and [formula], then there are integers a,b with [formula], [formula] and [formula]. Letting

[formula]

we see that d(m*) = d(mN) = N, but

[formula]

a contradiction.

For every [formula], and for [formula] we have

[formula]

Write the prime factorization of n as [formula], where [formula]. Using the arithmetic mean - geometric mean inequality and that [formula], we have

[formula]

the last inequality coming from excluding factors corresponding to [formula]. Finally, the prime number theorem implies [formula].

Remark. Lemma [\ref=domega] is fairly sharp. For example, from the inequality [formula], and the observation that m1(x) is monotonically increasing, we immediately obtain Wigert's upper bound for log d(n).

The following is the key lemma, which explains the constant c.

Let [formula] be positive integers.

(a) we have

[formula]

Moreover, the constant c / 2 is best possible.

(b) If [formula] for all i, where A is a positive integer, then

[formula]

(a) Without loss of generality, suppose [formula]. Let [formula]. Then

[formula]

By partial summation and the Cauchy-Schwarz inequality,

[formula]

Moreover, the inequality in [\eqref=CS] is an equality if and only if for some real Y, yj = Y log (1 + 1 / j) for every j. As the yj are integers, this cannot happen. However, we can come very close to equality in [\eqref=CS] by taking t large and choosing the ai by [\eqref=ai], so that [formula]. By [\eqref=lower1] and [\eqref=lower2], we have in this case

[formula]

whence

[formula]

(b) Observe that [formula]. Arguing similarly to [\eqref=CS], we obtain

[formula]

Observing that log (1 + 1 / j)  <  1 / j and [formula], we obtain (b).

The next lemma is trivial.

For any positive integer m, [formula].

Let n be large, let N = d(n) and factor N = N'N'', where

[formula]

where [formula], [formula] are primes, bi > ( log 2n)6 for every i and [formula] for every i.

Write [formula]. By Lemma [\ref=2.2'] (ii), [formula], so that h  ≪   log n. By Lemma [\ref=2.2'] (iii), [formula] for every i. Since [formula], for each [formula] there are [formula] values of i for which [formula]. Thus, by Lemma [\ref=sump],

[formula]

Combining this estimate with Lemma [\ref=2.4'] (b) with A = ( log 2n)6 gives

[formula]

Next, we bound d(N''). Case 1) If [formula], Lemma [\ref=domega] implies that [formula]. Case 2) Now suppose that [formula]. Write [formula]. By Lemma [\ref=2.2'] (iii),

[formula]

In particular, [formula], so [formula]. Thus, for large enough n, [formula]. Also by Lemma [\ref=2.2'] (iii), [formula] is prime for [formula]. Let [formula]. By the lower bound on s, and using [formula],

[formula]

hence, using [\eqref=OmegaN''],

[formula]

Using Lemma [\ref=2.2'] (i), αi + 1 = q1 for [formula], and similarly for each [formula], αi + 1 = qj for [formula]. We obtain

[formula]

By [\eqref=bigl], uniformly for [formula] we have

[formula]

Using [\eqref=pj], [formula] for large j. Hence, by Lemma [\ref=2.2'] (ii),

[formula]

By the definition of [formula], [formula]. Also, trivially [formula]. Recalling that [formula] for every j, we have

[formula]

Combining the last two inequalities gives

[formula]

Applying Lemma [\ref=2.4'] (a), we conclude that

[formula]

Recall that we have a smaller upper bound for log d(N'') in case 1). Finally, using d(d(n)) = d(N')d(N'') and combining [\eqref=d(N')] and [\eqref=dN''], we obtain the desired upper bound for d(d(n)).

Proof of Theorem [\ref=wn]

For the lower bound, let x be large and put [formula], where s is the largest integer such that [formula]. Recall that pj is the j-th smallest prime. Then [formula], thus ω(d(n)) = s. By [\eqref=pj],

[formula]

Solving for s gives [formula]. We now prove a lower bound on n. Since [formula] by [\eqref=pj], we have

[formula]

That is, [formula]. Therefore, [formula].

Now let n be a large, positive integer factored as n  =  n1n2, [formula], [formula], where qi,qi' are primes, qi > P and [formula] for each i, where [formula]. We have

[formula]

Since [formula], Lemma [\ref=domega] implies [formula]. Applying the elementary inequality [formula] gives

[formula]

Next,

[formula]

Letting [formula], Lemma [\ref=sump] implies that

[formula]

Here we used the one-sided inequality [formula] deduced from [\eqref=pj]. Thus,

[formula]

Consider two cases: (i) [formula], (ii) [formula]. In case (ii), we have [formula], and we obtain in both cases

[formula]

Combining this inequality with [\eqref=omega12] and [\eqref=wn2], we obtain the desired upper bound for ω(d(n)).

Acknowledgement. The authors would like to thank Prof. L. G. Lucht for discussions on the subject and helpful comments on an earlier version of this paper.