, Aline Parreau

Acyclic edge-coloring using entropy compression

Introduction

An edge-coloring of a graph G is acyclic if it is a proper edge-coloring (adjacent edges have different colors) and every cycle contains at least three colors. The smallest number of colors in an acyclic edge-coloring of G is the acyclic chromatic index of G, denoted by a'(G). A corollary of a general theorem of Alon et al. [\cite=AMR91] from 1991, proved using the Lovász Local Lemma, is that if G has maximum degree at most Δ, then a'(G)  ≤  64Δ. Molloy and Reed [\cite=MR98] improved the bound to 16Δ in 1998, and this was recently improved by Ndreca et al. [\cite=NPS12] to ⌈9.62  (Δ - 1)⌉, using a stronger version of the Local Lemma due to Bissacot et al. [\cite=BFPS11]. Here we improve the bound further to 4Δ - 4. Fiamik [\cite=F78] (in 1978) and Alon et al. [\cite=ASZ01] (in 2001) independently conjectured that the right bound should be Δ + 2 (only one more than the bound of Vizing for proper edge-coloring).

Let γ > 1 be a fixed real and let K = ⌈(2 + γ)(Δ - 1)⌉. We study the following simple randomised algorithm. Order the edges of G as [formula], and do the following at each step: take the non-colored edge with smallest index, say ei, and assign it a random color in [formula] that does not appear on some edge adjacent to ei (this will be slightly modified to allow an easier analysis). If some 2-colored cycle is created, then uncolor ei and all the other edges on this cycle (except two of them, we will understand why later). This way, we maintain a partial edge-coloring that is acyclic at each step.

Our aim in this paper is to show that this algorithm terminates (every edge is eventually colored) with positive probability, provided that γ (and thus, K) is large enough. This implies that G has an acyclic edge-coloring with at most K colors.

To analyse the algorithm, we will use ideas that have been developed to obtain bounds on nonrepetitive coloring of graphs [\cite=DJKW12] [\cite=GKM12]. The proofs in these two articles were inspired by the algorithmic proof of the Local Lemma due to Moser [\cite=M09] and Moser and Tardos [\cite=MT10].

We want to insist on the fact that the generality of the work done in Section [\ref=sec:analysis] makes the technique presented in this paper (or rather, its precise analysis) easily extendable to a wide variety of graph coloring problems. We could have made a more general presentation throughout the whole paper instead of concentrating on acyclic edge-coloring, but we felt that the paper would completely loose its pedagogic side. Instead, we chose to present acyclic edge-coloring first, then give another example (a generalisation of star coloring, see Section [\ref=sec:star]), and then finally to explain briefly how these examples could be encompassed in a wider framework (see Subsection [\ref=sub:ext]). The algorithmic aspects are analysed in Subsection [\ref=sub:algo].

The algorithm

In order to analyse such a randomised algorithm running on a deterministic instance, we will consider it instead as a deterministic algorithm taking a large vector with random entries as input. Take some large integer t, and consider a vector [formula]. At step i of the algorithm, the i-th entry Fi of F will be used to assign a color to the non-colored edge ej with smallest index as follows. Let ej = uv, and let [formula], where S' is the set of colors appearing on edges xy  ≠  uv such that

x = u or x = v, or

edges ux and vy exist and have the same color.

Observe that that the set S has cardinality at least ⌈γ(Δ - 1)⌉: for any color counted in (2), some color c is counted at least twice in (1). Moreover since we maintain a proper coloring at any step (see below), the color c is counted precisely twice. Hence, S' contains no more colors than the number of edges adjacent to ej, and so |S'|  ≤  2(Δ - 1).

We now assign the Fi-th smallest element of S to ej. This implies that the partial edge-coloring at any step (1) is proper and (2) has no 2-colored 4-cycle. If a 2-colored cycle (of length at least 6) is created, say [formula] with ei1 = ej and i2 < i2k, then uncolor all the edges on this cycle except ei2 and ei3. Since ej is uncolored, the partial edge-coloring remains acyclic.

The key of the analysis of the algorithm is to keep a (compact) record of each step of the algorithm, in such way that at any step i, the record until step i and the partial coloring at step i are enough to deduce all the entries Fj, j  ≤  i. In particular, the set of all vectors F such that the algorithm did not terminate before step t, is smaller than the set of all possible records of all steps and partial colorings at step t. The total number of choices for F is ⌈γ(Δ - 1)⌉t and the number of partial colorings of G is independent of t (it is at most (K + 1)m). Thus, if we prove that the number of possible records is o(⌈γ(Δ - 1)⌉t) when t  →    ∞  , this shows that the algorithm terminates for some input vector. Equivalently, the randomised version of the algorithm terminates with non-zero probability.

We now precise what we meant by compact record of each step of the algorithm. We define a vector R having t entries as follows. Assume that at step i of the algorithm, the edge ej was colored and a 2-colored cycle (of length at least 6) was created, say [formula] with ei1 = ej. Observe that there are at most (Δ - 1)2k - 2 cycles of length 2k containing ej, so we can fix an order on such cycles (say the lexicographic order), as [formula], with s  ≤  (Δ - 1)2k - 2. In this case we uncolor all edges of C except two, as described above, and we set the i-th entry Ri of R to be equal to the pair [formula], where [formula] is the index of C among all cycles of length 2k containing ej. If no 2-colored cycle is created at step i, Ri is left empty.

The algorithm will be analysed in Section [\ref=sec:analysis]. In order to find good asymptotics for the number of possible records, we will need to count Dyck words with prescribed descent lengths which is equivalent to counting rooted plane trees with prescribed number of children. The full generality of the counting lemma will be used to obtain better bounds for the acyclic edge-coloring of graphs without small cycles and for the star vertex-coloring of graphs (Section [\ref=sec:star]).

Analysis of the Algorithm

We denote by Xi the set of uncolored edges after step i, and by Φi the partial coloring of G after step i. Assume that for some input vector F, the algorithm applied on the graph G returns output (R,Φt). We now prove that (R,Φt) uniquely determines F.

At each step i, the set Xi is uniquely determined by the record (Rj)j  ≤  i.

We prove the result by induction on i. First observe that the set X1 is the set of all edges except e1. Assume now that i  ≥  2. By the induction, Xi - 1 is uniquely determined, so in particular the uncolored edge with smallest index before step i, say ej, is uniquely determined. If Ri is empty, [formula]. If Ri is not empty, say [formula], we know which cycle of length 2k containing ej was a 2-colored cycle, and which edges from this cycle were uncolored. So Xi is uniquely determined also in this case.

At each step i, the application that assigns to each input (Fj)j  ≤  i the output ((Rj)j  ≤  i,Φi) is injective.

We prove by induction on i that the record (Rj)j  ≤  i and the partial coloring Φi uniquely determine the input (Fj)j  ≤  i that produced such record and coloring. After the first step, the color of the only colored edge in Φ1 is equal to F1. Next, assume that i  ≥  2. By Lemma [\ref=lem:uncolored] we know Xi and Xi - 1. In particular, we know the edge ej that is colored at step i.

Assume first that Ri is empty. Then Φi - 1 is obtained from Φi by simply uncoloring ej. By the induction, it follows that (Fj)j  ≤  i - 1 is uniquely determined, and all that remains is to find Fi. Let [formula] be the color of ej = uv in Φi, and let a be the number of different colors {i  |  i  <  c} appearing in the coloring Φi - 1 on (1) edges adjacent to ej or (2) edges xy such that ux and yv are edges of G and have the same color. Then Fi = c - a.

Now assume that [formula], with [formula] corresponding to some cycle of length 2k  ≥  6, say [formula] with ei1 = ej and i2 < i2k. Then since C is 2-colored when ej is assigned its color, the coloring Φi - 1 is obtained from Φi by coloring [formula] with color Φi(ei3) and [formula] with color Φi(ei2). Moreover, ej received color Φi(ei3) at step i just before being uncolored. As above, we conclude using the induction that since Φi - 1 is uniquely determined, so is (Fj)j  ≤  i - 1, and we obtain Fi from the color assigned to ej at this step as in the previous paragraph.

Let Ft be the set of vectors F such that at step t of the algorithm, the graph G has not been completely colored (in other words, Xt is not empty). By definition of F, |Ft|  ≤  ⌈γ(Δ - 1)⌉t and if the inequality is strict, then G has an acyclic edge-coloring with K = ⌈(2 + γ)(Δ - 1)⌉ colors.

Let Rt be the set of records R that can be produced with inputs from Ft. Since there are at most (K + 1)m partial colorings Φt of G, the two previous lemmas have the following direct consequence:

|Ft|  ≤  (K + 1)m|Rt|.

We will now compute |Rt| and show that for t large enough, |Ft| is smaller than the set of all possible vectors, meaning that there is a vector F for which the algorithm terminates.

Recall that a 2-colored cycle that is partially uncolored at some step is recorded by a pair [formula], where the cycle has length 2k  ≥  6, and index [formula] among the at most (Δ - 1)2k - 2 cycles of length 2k containing the current edge. Hence [formula].

Consider a word [formula] of length 2k - 2 on the alphabet [formula], and define [formula]. Then the function θk has range in [formula] and is bijective.

Let R∈Rt. Define R* = (R*i)i  ≤  t as the following sequence of t words on the alphabet [formula]: for any 1  ≤  i  ≤  t, if Ri is empty, then R*i = 0. Otherwise [formula] for some [formula] and we set R*i to be the concatenation of 0 and [formula]. We now consider the sequence of words R* as a word [formula] (concatenating all the entries in order), and define [formula] as the word on {0,1} obtained from [formula] by the morphism κ(x) = 0 if x = 0 and κ(x) = 1 otherwise. For instance, if Δ = 4 and

Observe that the function [formula] is an injection since every entry of R* starts with a 0 and there are no other 0's in words of R*. It follows that the function [formula] is also an injection. We now make a couple of observations on words [formula], for R∈Rt.

A partial Dyck word is a word w on the alphabet {0,1} such that any prefix of w contains at least as many 0's as 1's. A Dyck word of length 2t is a partial Dyck word with t 0's and t 1's. A descent in a (partial) Dyck word is a maximal sequence of consecutive 1's.

For any R∈Rt, the word [formula] is a partial Dyck word with t 0's and t - r 1's, where r is the number of colored edges after step t. Moreover, all descents in [formula] are even, and if every cycle of G has length at least [formula], for some [formula], then all descents in [formula] have length at least [formula].

When we read [formula] from left to right, every 0 in [formula] corresponds to an edge that is assigned a color according to the vector F, while every 1 corresponds to the process of uncoloring some colored edge. Indeed, every word κ(R*i) is of the form 012k - 2, for some k  ≥  1; if k = 1 it means that at step i of the algorithm, the edge that is colored is not involved in any conflict, while if k  ≥  2 the colored edge is contained in some 2-colored cycle of length 2k. In this case we uncolor 2k - 2 edges, which is precisely the number of 1's in κ(R*i). Since we cannot uncolor more edges than the number of colored edges, the result of the first part follows. The second part follows from the fact that if all cycles have length at least [formula], all even cycles have length in at least [formula]. A 2-colored cycle in the algorithm has length at least 6, so each descent is even and has length at least [formula].

Let R∈Rt. If the word [formula] has t - r 1's, then the preimage of [formula] under the function [formula] has cardinality at most (Δ - 1)t - r. This follows from the fact that R  ↦  R* and [formula] are injections, and each 1 in [formula] corresponds to an element of [formula] in [formula].

Let [formula]. The preceding remark, together with Lemma [\ref=lem:partialdyck] (more precisely, the fact that the number of 1's is at most the number of 0's in [formula]) show that [formula]. Hence, Lemma [\ref=lem:cor] implies the following.

[formula].

Our objective is now to count partial Dyck words having the properties described in Lemma [\ref=lem:partialdyck]. To make the computation easier, we will in fact count Dyck words with these properties. The next lemma shows that counting these two objects is almost equivalent, provided that r (the difference between the number of 0's and 1's in the partial Dyck word) is not too large.

Let t and r  ≤  t be integers, and let E  ≠  {1} be a non-empty set of non-negative integers. Let Ct,r,E (resp. Ct,E) be the number of partial Dyck words with t 0's, t - r 1's (resp. Dyck words with length 2t), and all descents having length in E. Then Ct,r,E  ≤  Ct + r(s - 1),E, where [formula].

Let Dt,r,E (resp. Dt,E) be the set of partial Dyck words with t 0's, t - r 1's (resp. Dyck words with length 2t), and all descents having length in E. Let ψ:Dt,r,E  →  Dt + r(s - 1),E be the application that appends to the end of a word the word (0s - 11s)r. Observe that the application ψ is well-defined and injective. The result follows.

There are various ways to compute asymptotics for Ct,E, in particular by finding bijections with well-known structures. We use here a bijection with rooted plane trees.

The number Ct,E of Dyck words with length 2t and all descents in E is equal to the number of rooted plane trees on t  +  1 vertices such that the degree (number of children) of each vertex is in [formula].

There are bijections between the following three objects for any integer t, proving the lemma:

rooted plane trees on t + 1 vertices such that the degree of each vertex is in [formula];

Dyck words of length 2t in which the length of any maximal sequence of consecutive 0's is in E;

Dyck words of length 2t such that the length of each descent is in E.

The bijection between items 1 and 2 is as follows: in a DFS walk of the tree, encode each vertex (except the very last one) having i children by 0i1. The word obtained is a Dyck word in which every maximal sequence of consecutive 0's is in E, and this application is clearly a bijection. The bijection between items 2 and 3 proceeds by taking the mirror of the word and interchanging 0's and 1's.

We now use generating functions and the method described by Drmota in [\cite=D] (see also the book of Flajolet and Sedgewick [\cite=FS]) to estimate Ct,E. Let XE(z) be the ordinary generating function (OGF) associated to the number of rooted plane trees on t + 1 vertices such that the degree (number of children) of each vertex is in [formula]. By the previous lemma, [formula]. But a rooted plane tree as above is either a unique vertex (the root), or the root together with a sequence of i rooted plane trees (such that the degree of each vertex is in [formula]), for some i∈E. It follows that XE satisfies the equation [formula], with [formula].

The next lemma is a direct corollary of [\cite=D] (see also [\cite=FS] where the result is stated in the specific case of aperiodic schemes). We just need to observe that for any non-empty set E  ≠  {1} of nonnegative integers, all the coefficients of φE are nonnegative and φE(x) is not linear in x.

Let E  ≠  {1} be a non-empty set of nonnegative integers such that the equation φE(x) - xφE'(x) = 0 has a solution x = τ with 0  <  τ < R, where R is the radius of convergence of φE. Then τ is the unique solution of the equation in the open interval (0,R). Moreover there is a constant cE such that Ct,E  ≤  cE  γt  t- 3 / 2, where γ  =  φE'(τ) = φE(τ) / τ.

We can now derive bounds on the acyclic chromatic index of graphs. Recall that the girth of a graph G is the length of a shortest cycle of G (if G is acyclic, its girth is +    ∞  ).

Let [formula] be a fixed integer, and let [formula]. Then the polynomial P(x) = (2k - 3)x2k + 2 + (1 - 2k)x2k + x4 - 2x2 + 1 has a unique root τ in the open interval (0,1). Moreover, every graph with maximum degree Δ and girth at least [formula] has an acyclic edge-coloring with at most ⌈(2 + γ)(Δ - 1)⌉ colors, where γ = (τ2k  -  τ2 + 1) / (τ  -  τ3).

Let [formula]. Then [formula]. It follows that φ'E(x) = (2kx2k - 1 - (2k - 2)x2k + 1) / (1 - x2)2, and the characteristic equation φE(x) - xφ'E(x) = 0 is equivalent to P(x) = 0. The radius of convergence of φE is 1 and since P(0) = 1 and P(1) =  - 2 the polynomial P has a root τ in the open interval (0,1). By Lemma [\ref=lem:dyck], this is the unique root in (0,1). Lemma [\ref=lem:dyck] also implies that for some constant cE, Ct,E  ≤  cE  γt  t- 3 / 2, where γ  =  φ'E(τ) = φE(τ) / τ  =  (τ2k  -  τ2 + 1) / (τ  -  τ3).

In order to prove the theorem, we just need to show the existence of a vector [formula] such that the algorithm taking G and F as inputs yields an acyclic edge-coloring of G. In other words, all the edges are colored at step t. As before, let Ft be the set of vectors F for which some edges remain uncolored at step t, and let m be the number of edges of G. By Lemma [\ref=lem:cor2], [formula]. Observe that for any R∈Rt, the number of 0's and 1's in each prefix of [formula] differ by at most m - 1, since at most m - 1 edges are colored at each step of the algorithm. By Lemmas [\ref=lem:partialdyck] and [\ref=lem:countingpartial], it implies that [formula], where c'E = cE / (γ2k - 1 - 1). It follows that |Ft|  ≤  c'E(⌈(2 + γ)(Δ - 1)⌉ + 1)m(Δ - 1)tγt + m(2k - 1)t- 3 / 2, and |Ft| / ⌈γ(Δ - 1)⌉t tends to 0 as t goes to infinity. In particular, for t large enough |Ft|  <  ⌈γ(Δ - 1)⌉t, which means that for some vector F the algorithm terminates in less than t steps and yields an acyclic edge-coloring of G with at most ⌈(2 + γ)(Δ - 1)⌉ colors.

Muthu et al. [\cite=MNS07] proved in 2007 that graphs of maximum degree at most Δ and girth at least 9 have an acyclic edge-coloring with at most 6Δ colors, and for graphs with girth at least 220 the bound was improved to 4.52  Δ. Ndreca et al. [\cite=NPS12] recently showed the following bounds for the acyclic edge-coloring of graphs G with maximum degree Δ and girth at least g: a'(G)  ≤  ⌈9.62  (Δ - 1)⌉, a'(G)  ≤  ⌈6.42  (Δ - 1)⌉ if g  ≥  5, a'(G)  ≤  ⌈5.77  (Δ - 1)⌉ if g  ≥  7, and a'(G)  ≤  ⌈4.52  (Δ - 1)⌉ if g  ≥  53. The following direct corollary of Theorem [\ref=th:main] significantly improves all these bounds.

Let G be a graph with maximum degree Δ and girth g. Then

a'(G)  ≤  4Δ - 4;

if g  ≥  7, a'(G)  ≤  ⌈3.74  (Δ - 1)⌉;

if g  ≥  53, a'(G)  ≤  ⌈3.14  (Δ - 1)⌉;

if g  ≥  220, a'(G)  ≤  ⌈3.05  (Δ - 1)⌉.

The constants appearing in the computations leading to Corollary [\ref=cor:main] are given in Table [\ref=tab1].

Star coloring

We now apply the analysis of the algorithm to star coloring of graphs. A star coloring of a graph G is a proper coloring of its vertices such that any two color classes induce a forest of stars. Equivalently, every path on four vertices contains at least three colors. The star chromatic number of a graph G, denoted by χs(G), is the minimum number of colors in a star coloring of G. Fertin et al. [\cite=FRR04] proved that for every graph G with maximum degree Δ, χs(G)  ≤  20Δ3 / 2, and that this bound is best possible up to a polylogarithmic factor: for some absolute constant C, there are graphs with maximum degree Δ requiring C  Δ3 / 2 / ( log Δ)1 / 2 colors in any star coloring. Recently, Ndreca et al. [\cite=NPS12] showed that for every graph G with maximum degree Δ, χs(G)  ≤  4.34  Δ3 / 2 + 1.5  Δ.

We will show how to divide this bound by [formula] using a variant of the algorithm analysed in this paper. Instead of considering star coloring, we will consider the following more general concept: a star-k coloring of a graph G is a proper vertex-coloring of G such that every path on 2k vertices contains at least three colors. A star coloring is the same as a star-2 coloring.

For every k  ≥  2, every graph G with maximum degree Δ has a star-k coloring with at most [formula] colors, where [formula].

Let [formula] and [formula]. We order the vertices as [formula], and at each step we consider the non-colored vertex with smallest index, say vj, pick a random integer r in [formula], and assign vj the r-th color in the set [formula] that does not appear in the neighborhood of vj. If some path of length 2k is now 2-colored, we choose such a path and uncolor vj and all the other vertices on the path, except two consecutive ones. Hence, the coloring remains a star-k coloring at each step. The analysis is the same as above. The two vertices on the 2-colored path that are not uncolored are enough to recover the colors of all the other vertices on the path, including vj. It follows that the complete record until step i together with the partial coloring at step i are enough to deduce all the random choices until step i. Hence, we only need to show that their are o(Kt) possible complete records at step t.

Every vertex is contained in at most kΔ2k - 1 paths on 2k vertices, so the 2-colored path containing vj that will be partially uncolored at this step can be recorded using a word of length [formula] on the alphabet [formula] ([formula] is precisely the number of vertices that are uncolored at this step). Applying the same morphism as in Section [\ref=sec:analysis] we obtain a partial Dyck word in which every descent has length precisely [formula].

It can be proven fairly easily with a bijective argument that the number of Dyck words of length 2t in which every descent has length precisely [formula] is [formula] and, using Stirling formula, its asymptotic value is [formula] where c is a constant. We omit the details, and rather present how these asymptotics can be directly deduced from the framework of Section [\ref=sec:analysis]. In this framework, we have [formula] and we want the asymptotic behavior of Ct,E. We have [formula], whose radius of convergence is +    ∞  . Then [formula] is the only solution of the characteristic equation φE(x) - xφ'E(x) = 0 in the interval (0, +   ∞  ). Since [formula], Lemma [\ref=lem:dyck] implies that for some some constant c, [formula].

We can now conclude that for some constant c' depending only on c and the number of vertices of G, the number of possible records of the algorithm after t steps is at most [formula]. It follows that G has a star-k coloring with K + Δ colors.

This theorem has the following immediate corollary, improving on [\cite=NPS12].

For every graph G with maximum degree Δ, [formula].

Conclusion

Extensions

The method presented in this paper can be applied to any vertex-coloring (or edge-coloring) that can be defined as a coloring where some configurations of colors are forbidden. By a configuration, we mean a graph Hi with a specific vertex- (or edge-) coloring ci, and we seek a coloring c of a graph G, such that for any i, and any copy H of Hi in G, the restriction of the coloring c to H is not congruent to ci (two colorings of the same graph are congruent if one can be obtained from the other one by a permutation of the color names). For instance, in the case of star coloring, there would only be two configurations: H1 (a single edge with both ends having the same color) and H2 (a properly 2-colored path on 4 vertices).

Assume that for any vertex v of Hi, there are ki fixed vertices different from v in Hi for which, if we know their color, there is a unique way to extend this partial coloring to a coloring of Hi congruent to ci. For any i, let [formula], and let [formula]. For [formula], let [formula] be the maximum over all vertices v of G, of the number of subgraphs containing v and isomorphic to some Hi with [formula]. Let γ be defined as in Lemma [\ref=lem:dyck] using this set E. Using the same analysis as before, we can prove that there is a coloring of the graph with [formula] colors, so that no copy of Hi as a coloring congruent to ci, for any i.

Example 1: Star coloring

Taking H1 and H2 as defined above, we obtain k1 = 1 and k2 = 2, and thus [formula] and [formula]. It follows that E = {1,2}, and so γ = 3, and if G has maximum degree Δ we have d1  ≤  Δ and [formula]. It follows that [formula]. This is not as good as the bound of Corollary [\ref=cor:star], though. The reason is that in the previous section we did not consider H1 and used a different (and less expensive) tool to keep the coloring proper at any step.

Example 2: Nonrepetitive coloring

Here all paths on an even number of vertices where the sequence of colors of the first half of the path is repeated on the second half are forbidden. If we only consider paths on 2 and 4 vertices, this corresponds exactly to star coloring. The forbidden configurations are paths Hi of length 2i, i  ≥  1, with colorings ci such that for any two vertices x and y at distance i in Hi, ci(x) = ci(y). We obtain that for each i  ≥  1, [formula] and [formula]. It implies that [formula], which yields a constant γ = 4 in the computation of Lemma [\ref=lem:dyck]. For any i  ≥  1, we have di  ≤  i  Δ2i - 1, therefore every graph of maximum degree Δ has a nonrepetitive coloring with [formula]. In [\cite=DJKW12], the authors analysed this randomised procedure more precisely and obtained a bound of (1 + o(1))Δ2.

Example 3: Acyclic edge-coloring

In this last example, we compare the bound obtained by a direct application of the framework above with the bound proved in Theorem [\ref=th:main]. The forbidden configurations are H1 (a path on two edges having the same color), and for any i  ≥  2, a properly 2-colored cycle Hi on 2i edges. We obtain that [formula] and for each i  ≥  2, ki = 2 and [formula]. It implies that [formula] and [formula], which yields a constant γ = 3.6 in the computation of Lemma [\ref=lem:dyck]. We have d1  ≤  2Δ and for any i  ≥  2, d2i - 2  ≤  Δ2i - 2, therefore every graph of maximum degree Δ has an acyclic edge-coloring with 3.6  ·  2Δ = 7.2  Δ colors. This is of course not as good as the bound of Theorem [\ref=th:main], in which small configurations are taken care of in a different way to minimize their influence on the final bound.

The algorithm and the different bounds in the applications have been formulated in terms of coloring for the sake of clarity but it is not difficult to see that everything works in the more general context of list coloring. Hence, all the bounds obtained here also hold for acyclic/star choosability.

Algorithmic remarks

By Corollary [\ref=cor:main].1, the acyclic chromatic index of every graph G with maximum degree Δ is at most 4Δ - 4. To prove this result, we showed that for t large enough, our random procedure colors G in at most t steps with non-zero probability (more precisely, with probability tending to 1 as t  →    ∞  ). In the proof of Theorem [\ref=th:main] the value t for which this probability is non-zero is exponential in the number of edges, but if we allow one more color (i.e. we take K = 4Δ - 3 instead of 4Δ - 4) we obtain that the probability that the algorithm stops in at most t  ≥  t0 steps (with [formula]) is at least

[formula]

where [formula]. This corresponds to an exponential distribution, therefore the expected number of steps is at most [formula].

The previous remark also holds in the full generality of Subsection [\ref=sub:ext]: if one allows one more color than the number of colors guaranteed by the general technique, then the expected number of steps becomes polynomial in the size of the graph. The issue is that in general, there is no clear way to perform each step of the algorithm in polynomial time. An example is the case of nonrepetitive coloring considered in the previous subsection. It was proved in [\cite=MS09] that deciding whether a given coloring of a graph is nonrepetitive is Co-NP-complete, so there is no polynomial time algorithm finding a repetitive path in a colored graph unless P=NP.

However in the case of acyclic edge-coloring each step can be performed in time O(nΔ) (the time it takes to find a 2-colored cycle containing a given edge, if such a cycle exists, in a graph with a proper edge-coloring). We only need to modify slightly the way we encode cycles in the record R (for each vertex u, we label the ordered pairs of neighbors (u,v) by [formula], and a cycle [formula] of length 2k containing the edge u1u2 is uniquely determined by the sequence of 2k - 2 labels of consecutive ordered pairs [formula]).

It follows that the overall expected running time is O(mnΔ2 log Δ). In particular, if Δ is fixed, the expected running time of our procedure is O(n2).

Note that this improves procedures producing an acyclic edge-coloring in expected polynomial time given by Molloy and Reed in 1998 using 20Δ colors [\cite=MR98], and recently by Haeupler, Saha, and Srinivasan using 16Δ colors [\cite=HSS11]. The latter result was proved using a refined analysis of the constructive proof of Moser and Tardos [\cite=MT10].

Acknowledgement

We would like to thank Mireille Bousquet-Mélou for mentioning the bijection between Dyck words and plane rooted trees, Jakub Kozik for his suggestion improving our original bound of [formula] to 4Δ, and Zhentao Li and Jan Volec for discussions related to algorithmic issues.