=1 =2500

Channel Impulse Responses in Diffusive Molecular Communication with Spherical Transmitters

Introduction

Molecular communication (MC) is a physical layer design strategy where molecules are used as information carriers. It is ubiquitous for communication in biological systems, but over the past decade it has also received growing attention for synthetic communication in fluid environments where conventional communication strategies are infeasible or undesirable; see [\cite=Farsad2016]. One MC approach that is commonly found in biological cells is free diffusion, where molecules propagate via collisions with each other; see [\cite=Alberts]. From a conventional wireless communications perspective, communication via diffusion can be viewed as analogous to broadcast communication (as described in [\cite=Atakan2010]), since the transmitter has no direct influence on the trajectory of molecules once they are released and molecules might reach any receivers that are within the vicinity.

While there is a firm theoretical foundation for the modeling of diffusion-based processes, closed-form channel impulse responses are only available with simplifying assumptions and under specific environment geometries; see [\cite=Crank1979]. One common assumption that has been widely applied in the MC literature is that a transmitter is modeled as a point source of molecules; see [\cite=Nakano2013c]. We formally define this here as the point transmitter assumption (PTA). In practice, a transmitter (and correspondingly its container of molecules) will occupy physical space, so it is of interest to account for the initial physical distribution of molecules when they begin to diffuse. This was identified as an open problem in [\cite=Farsad2016]. We anticipate that modeling a transmitter as a finite volume will substantially improve the accuracy of the channel impulse response when the transmitter is close to its intended receiver.

In this paper, we formulate the channel impulse response at a spherical receiver due to molecules diffusing from a spherical transmitter. The transmitter is a virtual boundary that releases molecules by initializing them uniformly within the sphere. The receiver can be either an absorbing surface or a passive observer. Both one-dimensional (1D) and three-dimensional (3D) environments are considered, since channel impulse responses from a point transmitter are available in closed form for both absorbing and passive receivers in 1D and 3D. Our contributions can be summarized as follows:

We derive the spherical transmitter channel impulse responses for passive and absorbing receivers in 1D and 3D environments. The impulse responses can be obtained in closed form in 1D, and are obtained via numerical integration in 3D.

We define the point transmitter assumption (PTA), which enables us to measure its deviation from the spherical transmitter model.

We use simulations to verify all spherical transmitter impulse responses and compare them with the PTA. For a passive receiver, we also compare with the uniform concentration assumption (that we defined in [\cite=Noel2013b]), which effectively treats the receiver as a point observer. The spherical transmitter impulse responses are shown to initially be much more accurate than the approximations when the transmitter is close to the receiver.

We briefly use simulations to consider the "solid" spherical transmitter, where molecules are released by initializing them on its surface. In this scenario, it is still more accurate to use the spherical transmitter impulse response for the virtual boundary transmitter than to use the PTA.

We conduct the simulations using our AcCoRD simulator (Actor-based Communication via Reaction-Diffusion). AcCoRD is in active development on Github, where source code and executables are available; see [\cite=Noel2016].

Existing papers that have considered volume transmitters include [\cite=Chou2015b] [\cite=Yilmaz2014a] and related works by the same authors. [\cite=Chou2015b] uses a mesoscopic model where the environment is divided into subregions called voxels, such that the transmitter can occupy one or more voxels, and channel responses are derived in the Laplace domain. [\cite=Yilmaz2014a] simulates spherical transmitters but does not account for finite transmitter volume in the corresponding analytical model.

The rest of this paper is organized as follows. Section [\ref=sec_model] describes the system model and presents the channel impulse responses for point sources. Section [\ref=sec_volume_tx] derives the spherical transmitter channel impulse responses and defines the point transmitter assumption. We verify our analysis with numerical results and simulations in Section [\ref=sec_results], and conclude in Section [\ref=sec_concl].

System Model and Analytical Preliminaries

We consider a transmitter with radius [formula] releasing [formula] molecules into an unbounded 1D or 3D environment with uniform temperature and viscosity. Thus, the transmitter is a segment of length [formula] in 1D and a sphere in 3D. Local molecule concentrations are low enough to assume that the molecules diffuse with constant diffusion coefficient [formula]. These molecules are observed by a receiver that is centered at a distance d from the center of the transmitter and has radius [formula]. If the receiver is active, then we consider a perfectly-absorbing surface that removes and counts molecules as they arrive, i.e., the absorption rate is [formula]. If the receiver is passive, then it has no impact on molecule behavior but is able to count the number of molecules within its virtual boundary at any instant. Finally, we assume that diffusion is the only phenomenon affecting molecule behavior in the propagation environment (except for absorption at the absorbing receiver's surface). We leave the integration of other realistic molecular phenomena, such as bulk fluid flow or the potential for other chemical reactions, for future work.

We define the channel impulse response [formula] as the number of molecules expected at the receiver at time [formula], given that [formula] molecules are instantaneously released by the transmitter at time [formula]. In the following subsections, we present the channel impulse responses for a point transmitter. These impulse responses are needed to derive the channel impulse responses of the corresponding spherical transmitters in Section [\ref=sec_volume_tx]. We also briefly comment on the expected signal peak times, which we will use in Section [\ref=sec_results] to normalize time when assessing the accuracy of the point transmitter assumption.

1D Channel Impulse Responses Due to a Point Source

If the environment is 1D, then the channel impulse response of the absorbing receiver due to a point source is given by [\cite=Farsad2016]

[formula]

where we use the "[formula]" superscript for "absorbing". [formula] is the complementary error function (from [\cite=Gradshteyn2007]), and the error function is [\cite=Gradshteyn2007]

[formula]

The expected point concentration for the 1D passive receiver is [\cite=Crank1979]

[formula]

where we use the "[formula]" superscript to denote "passive".

We can integrate ([\ref=passive_response_point_1D]) over the receiver line segment in a manner analogous to our derivation of the impulse response at a 3D Cartesian box receiver in [\cite=Noel2013b] to arrive at

[formula]

It is common to assume that the molecule concentration throughout a passive receiver at any time is uniform, which is justified if the receiver is sufficiently far from the transmitter, i.e., if [formula] (as we demonstrated in [\cite=Noel2013b]). If we do so, then we can scale ([\ref=passive_response_point_1D]) by the receiver volume [formula] and write

[formula]

3D Channel Impulse Responses Due to a Point Source

If the environment is 3D, then the channel impulse response of the absorbing receiver due to a point source is given by [\cite=Yilmaz2014b]

[formula]

Eq. ([\ref=absorbing_response]) describes the total number of molecules that have been absorbed by time [formula]. For the passive receiver, the expected point concentration [formula] due to a point source is [\cite=Crank1979]

[formula]

We previously integrated ([\ref=passive_response_point]) over a sphere to derive the impulse response of the passive spherical receiver as [\cite=Noel2013b]

[formula]

If we assume that the passive receiver is sufficiently far from the transmitter, then the simplified 1D channel impulse response comes directly from ([\ref=passive_response_point]) as

[formula]

Signal Peak Time

One of the tests in Section [\ref=sec_results] will be to measure the relative deviation of the point transmitter assumption over time for a range of distances between the transmitter and receiver. However, the time delay until the expected arrival of molecules at the receiver is a function of the distance d, so we will find it convenient to normalize time by the expected signal peak time [formula] at each distance. For a passive receiver, the expected channel impulse response peak times in 1D and 3D due to a point transmitter can be shown to be

[formula]

respectively, when using the uniform concentration assumption. For an absorbing receiver, the channel impulse responses ([\ref=absorbing_response_1D]) and ([\ref=absorbing_response]) are non-decreasing. However, it is common to measure the rate of molecule absorption over time, and this is expected to be greatest at time

[formula]

which can be shown to apply in both 1D and 3D when the transmitter is a point.

Channel Impulse Responses for Spherical Transmitters

In this section, we derive the channel impulse responses when the transmitter is a virtual spherical source. Generally, the channel impulse response due to such a source is defined as follows. The release of [formula] molecules means that [formula] molecules are uniformly distributed over the transmitter volume [formula], i.e., the density of molecules throughout the transmitter is [formula], where [formula] could be defined in 1D or 3D. Due to the spherical symmetry of the receiver, the expected observation of a molecule that is initialized at any point outside of the receiver is only a function of the distance from that point to the receiver's surface. Thus, the expected channel impulse response of a volume source is found by the corresponding volume integration of the point source channel impulse response. Given the point source channel impulse response [formula], the volume source channel impulse response [formula] is

[formula]

which can be solved numerically for any of the point source channel impulse responses presented in Section [\ref=sec_model]. We emphasize that the form of ([\ref=volumeCIR_general]) would not apply if the receiver were not spherically symmetric, such that the expected observation of a molecule would depend on its precise initial location and not only on its initial distance from the receiver.

In the following subsections, we discuss solving ([\ref=volumeCIR_general]) in 1D and 3D environments. For the 1D environment, the channel impulse responses are derived in closed form. For the 3D environment, closed-form solutions are not readily available and we briefly comment on one of the challenges. Finally, we formally define the point transmitter assumption, where we assume that a volume transmitter can be approximated as a point.

Line Transmitter in 1D

In the 1D environment, the transmitter is a line segment. Thus, the expected channel impulse response is found by solving

[formula]

where c is the distance from the center of the transmitter to an arbitrary point in [formula]. If we define the vectors [formula] and [formula] relative to the center of the transmitter, such that [formula] and [formula] (i.e., [formula] is the vector from the center of the transmitter to the center of the receiver), then the distance from the center of the receiver to an arbitrary point in [formula], [formula], is

[formula]

and to solve ([\ref=volumeCIR_1D]) we replace d with [formula] in the appropriate equation for [formula], i.e., in ([\ref=absorbing_response_1D]) or ([\ref=passive_response_exact_1D]) for the absorbing or passive receiver, respectively.

Unlike the 3D case, we can solve ([\ref=volumeCIR_1D]) in closed form for both types of receivers. It can be shown that the expected channel impulse responses at a 1D passive receiver and at a 1D absorbing receiver due to a line transmitter are in ([\ref=volumeCIR_passive_1D]) and ([\ref=volumeCIR_absorbing_1D]) at the top of the following page, respectively, where

[formula]

and we use the integral [\cite=Gradshteyn2007]

[formula]

Due to their verbosity, it is challenging to gain intuition from ([\ref=volumeCIR_passive_1D]) and ([\ref=volumeCIR_absorbing_1D]). However, both impulse responses are exact and they show the importance of the precise location of the transmitter (via [formula] and [formula]).

Spherical Transmitter in 3D

In the 3D environment, the transmitter is a sphere. Thus, the expected channel impulse response is found by solving

[formula]

where c, as in the 1D case, is the distance from the center of the transmitter to an arbitrary point in [formula]. The distance from the center of the receiver to an arbitrary point in [formula] is

[formula]

and to solve ([\ref=volumeCIR_3D]) we must replace d with [formula] in the appropriate equation for [formula], i.e., in ([\ref=absorbing_response]) or ([\ref=passive_response_exact]) for the absorbing or passive receiver, respectively.

The main challenge to solving ([\ref=volumeCIR_3D]) in closed form is that both ([\ref=absorbing_response]) and ([\ref=passive_response_exact]) have d terms that are not squared. This means that the trigonometric terms in [formula] remain inside a square root, such that approximations are needed to integrate ([\ref=volumeCIR_3D]) with respect to θ and φ. Approximations that are accurate for both ([\ref=absorbing_response]) and ([\ref=passive_response_exact]) over a range of d-values have not yet been identified so they are outside the scope of this work. In this paper, we only consider solving ([\ref=volumeCIR_3D]) numerically with MATLAB.

Point Transmitter Assumption

In [\cite=Noel2013b], we defined and measured the common uniform concentration assumption (UCA) for a receiver, where it is assumed that the molecule concentration throughout a passive receiver at any instant is uniform. Here, we analogously define the point transmitter assumption (PTA), which assumes that all molecules released by a transmitter are initialized at a single point. Even though this has also been a common assumption throughout the molecular communication literature, we now establish that this assumption replaces the integration over [formula] in ([\ref=volumeCIR_general]) with the volume's size [formula]. Specifically, the PTA simplifies the volume transmitter impulse response in ([\ref=volumeCIR_general]) as

[formula]

The definition of the PTA enables us to measure its accuracy. In Section [\ref=sec_results], we will measure the relative deviation of the PTA. For a given channel impulse response approximation [formula], its percent relative deviation [formula] is

[formula]

Simulation and Numerical Results

In this section, we verify the channel impulse responses derived for spherical transmitters in Section [\ref=sec_volume_tx] via simulations and numerical evaluation. We consider both passive and absorbing receivers in two environments (one that is 1D and one that is 3D). Unless otherwise noted, the two environments have the same parameters as summarized in Table [\ref=table_model_param]. We consider a transmitter and a receiver with radii [formula], which is on the order of the size of a bacterial cell. The diffusion coefficient of released molecules is [formula]. The transmitter and receiver are either centered [formula] apart (i.e., they touch at their edges) or [formula] apart. The transmitter releases 103 molecules at time [formula]. The microscopic simulation time step [formula] is [formula] when the receiver is passive and [formula] when the receiver is absorbing. The smaller time step for simulations with the absorbing receiver is needed to accurately simulate the absorption behavior.

All simulations are averaged over at least 100 independent realizations using release v0.5 of the AcCoRD simulator [\cite=Noel2016], where the 3D environment is truly unbounded and the 1D environment is a long rectangular pipe with dimensions [formula] and having the receiver in the middle. In each time step [formula], all released molecules diffuse. If the receiver is absorbing, then the trajectory of each molecule is checked in each time step for crossing the surface of the receiver.

In Fig. [\ref=fig_1D_CIR], we plot the channel impulse responses of the receivers in the 1D environment. The simulations of the passive receiver are compared with the derived spherical transmitter channel impulse response in ([\ref=volumeCIR_passive_1D]), the point transmitter approximation (PTA) in ([\ref=passive_response_exact_1D]), and the combination of the PTA and the uniform concentration assumption (UCA) found using ([\ref=passive_response_UCA_1D]). The simulations of the absorbing receiver are compared with the derived spherical impulse response in ([\ref=volumeCIR_absorbing_1D]) and the PTA in ([\ref=absorbing_response_1D]). All curves are normalized by the peak values of the corresponding analytical curves (i.e., solid black lines), as listed in Table [\ref=table_norm], and are shown on a log-log scale to more easily observe deviations in the curves at early times and when a low number of molecules are observed. The only exception to the parameters listed in Table [\ref=table_model_param] is that the simulation time step for the absorbing receiver centered [formula] from the transmitter is reduced to [formula] to improve accuracy.

Fig. [\ref=fig_1D_CIR] shows that the derived spherical transmitter impulse responses are very accurate for both the passive and absorbing receivers over the entire range of time simulated. The approximations initially underestimate the number of molecules at the receiver but become more accurate with increasing time. Applying the UCA with the PTA for the passive receiver, i.e., using a point-to-point model, is noticeably less accurate than only applying the PTA. As expected, the accuracy of the approximations is much poorer when [formula], i.e., when the transmitter is adjacent to the receiver. Nevertheless, even the point-to-point model is accurate for the passive receiver at this distance when the impulse response is at its peak. We claim that the approximations are sufficient for long-term behavior but they do not accurately model the receiver signal as molecules first arrive from the transmitter.

Fig. [\ref=fig_3D_CIR] is analogous to Fig. [\ref=fig_1D_CIR] and plots the channel impulse responses of the receivers in the 3D environment. The spherical transmitter impulse responses are determined by numerically solving the integration in ([\ref=volumeCIR_3D]) for all receivers. The PTA for the passive receiver is found via ([\ref=passive_response_exact]), and the PTA is combined with the UCA using ([\ref=passive_response_UCA]). The PTA for the absorbing receiver is found via ([\ref=absorbing_response]). The only exception to the parameters listed in Table [\ref=table_model_param] is that the number of molecules released by the transmitter when [formula] is increased to [formula] (molecules) so that more can be observed.

The results in Fig. [\ref=fig_3D_CIR] are consistent with our observations from Fig. [\ref=fig_1D_CIR]. Even though we did not derive the spherical transmitter channel impulse responses in closed form, the numerical integration of ([\ref=volumeCIR_3D]) agrees with the simulations and is more accurate than the approximations for low values of [formula]. The accuracy of the approximations is worse when the transmitter is closer to the receiver.

To get a better sense of the sensitivity of the PTA as a function of distance, we measure its percent deviation [formula] from the spherical transmitter impulse response for different distances as a function of time in Fig. [\ref=fig_pta]. We consider both the absorbing and passive receivers in 1D and 3D environments, and consider the distances [formula]. Time is normalized for each curve by its corresponding [formula] in ([\ref=tpeak_passive]) or ([\ref=tpeak_absorbing]). We see that the deviations of the approximation generally improve with increasing distance. For a passive receiver, the PTA initially underestimates the impulse response but overestimates it after [formula]. This overestimation is as much as 6% for the 3D receiver when [formula]. Otherwise, all deviations at the passive receiver are less than 5% for all time [formula]. For an absorbing receiver, the PTA always underestimates the signal, and it improves more slowly than for the passive receiver; for [formula] the deviation is still greater than 10% when [formula].

Finally, we briefly consider a variation of the spherical transmitter model, where the transmitter is a solid impenetrable sphere and the molecules that it releases are initialized uniformly over its surface. The analysis to correctly determine the corresponding channel impulse response is outside the scope of this work, but we are interested in assessing the accuracy of the virtual transmitter model in this scenario. We simulated this scenario with a 3D absorbing receiver using the same system parameters as for Fig. [\ref=fig_3D_CIR], and compared the results with the numerical integration of ([\ref=volumeCIR_3D]) and the PTA in ([\ref=absorbing_response]). At both distances, ([\ref=volumeCIR_3D]) and ([\ref=absorbing_response]) initially underestimate the simulation. This makes intuitive sense, since the molecules initialized on the half of the transmitter closest to the receiver will arrive sooner than when predicted by our model, where the molecules are distributed within [formula]. Analogously, ([\ref=volumeCIR_3D]) and ([\ref=absorbing_response]) eventually overestimate the simulation, since the molecules initialized on the half of the transmitter further from the receiver will take longer to reach the receiver than when predicted. The accuracy of our virtual transmitter model is much better when [formula] than when [formula], and at both distances solving ([\ref=volumeCIR_3D]) is still more accurate than using the PTA in ([\ref=absorbing_response]). While the solid transmitter variation merits further study, the virtual transmitter model may be a sufficient approximation for the channel impulse response.

Conclusions

In this paper, we considered the channel impulse responses due to transmitters that release molecules into diffusing environments from a volume instead of a point. We derived the channel impulse responses for spherical passive and absorbing receivers in 1D and 3D environments due to a spherical transmitter. The impulse responses could be determined in closed form for the 1D environment. The accuracy of the derived impulse responses were supported by simulations. We referred to existing analysis, which assumes a point transmitter, as making the point transmitter assumption, and its accuracy was shown to generally improve with time. Future work will seek to obtain additional closed-form results to more accurately model the behavior of diffusing molecules that are released from finite volume transmitters.