Cutting a Cake without Harming the Toppings

Introduction

Let C ("cake") be a compact subset of the Euclidean plane [formula]. Let [formula] be pairwise-disjoint subsets of C ("toppings"), such that [formula].

Our goal is to create a partition of C, [formula], for some b  ≥  0, such that:

[formula]

i.e, each topping is contained in a unique piece.

Subject to that requirement, it is desired to minimize b. This b is the number of empty pieces (henceforth "blanks") - the number of pieces in the final partition with no topping. What is the smallest b that can be guaranteed, in the worst case, as a function of m?

Without further restrictions on the pieces, the answer is trivial: it is always possible to get b = 0 by setting e.g. [formula] (arbitrarily attach all the cake outside of the toppings to one of the toppings). The question becomes more interesting when there are geometric constraints on the pieces. A geometric constraint is represented by a family S of subsets of the plane. It is given that for each [formula], Ci∈S. It is required that for each [formula], Ci'∈S. Several such constraints are considered here:

S is the family of path-connected sets, and the cake C is path-connected.

S is the family of convex sets, and C is convex.

S is the family of axes-parallel rectangles and C an axes-parallel rectangle.

S is the family of axes-parallel rectangles and C a rectilinear polygon.

A-priori, one could think that a sophisticated computational-geometric algorithm is needed to find a partition with a minimal b. However, I found out that the following simple algorithm provides near-optimal results:

For each i, expand Ci arbitrarily to the largest extent possible, while keeping it contained in C and an element of S and disjoint from the other toppings.

I.e, it does not matter how exactly the toppings are expanded, to what direction and in what order, as long as they are expanded to the maximum possible amount. Formally, say that a sequence [formula], is maximal, if for each [formula], there is no [formula] such that C*i  ⊆  C and C*i∈S and [formula] are pairwise-disjoint. The simple algorithm stated above can also be stated as: Below, I analyze the performance of this algorithm for the four geometric scenarios presented above. During the analysis, for simplicity, I assume that the set [formula] is already maximal. The analysis amounts to proving bounds on the number of blanks when the set of toppings is maximal.

The results are summarized in the table below. The expressions are upper and lower bounds on the worst-case number of blanks b, as a function of the number of toppings m and the number of reflex vertexes in the rectilinear polygon, R.

Path-Connected Cake and Path-Connected Pieces

In this section, S is the family of path-connected sets and the cake C is also path-connected.

It is apparent that when the set of toppings is maximal, b = 0 (there are no blanks). Indeed, suppose there is a blank H  ⊆  C. Since C is path-connected, H can be connected by a path to any of the Ci-s. In particular, there is some topping Ci such that a path from H to Ci through C does not pass through any other topping Cj. The union of Ci and the path and H is path-connected, contained in C and disjoint from the rest of the toppings, and it strictly contains Ci - in contradiction to maximality.

Convex Cake and Convex Pieces

In this section, S is the family of convex sets and the cake C is also convex. [\citet=Akopyan2016Partitioning] proved that the worst-case number of blanks when the set of toppings is maximal is 2m - o(m). I now briefly describe his proof.

Lower bound

Consider the tiling shown in Figure [\ref=fig:holes-convex-worst], and imagine that it fills the entire plane. This tiling is apparently maximal - no hexagon can be expanded while remaining convex and disjoint from the other hexagons. Each blank touches three hexagons and each hexagon touches six blanks. Hence, the number of blanks is asymptotically twice the number of hexagons.

If the tiling is finite, then the number of blanks is slightly smaller, since some blanks near the boundary of C can be discarded or joined with nearby toppings. But (assuming e.g. that C is square), the number of blanks near the boundary is only [formula]. Hence, in the worst case there are [formula] blanks.

Upper bound

For the upper bound, we should distinguish between holes and blanks. A hole is a connected subset of C which is not contained in any of the toppings Ci. A-priori, a hole need not be convex. We can imagine arrangements of convex toppings, such that the space between them is not convex. Hence, the number of blanks may be much larger than the number of holes (each convex component of a hole is counted as a different blank).

However, when the set of toppings is maximal, which is the case of interest here, it can be proved that all holes are convex. Hence, in particular, each hole is a single blank, and the number of blanks equals the number of holes. The proof is in Claim 2 of [\citet=Pinchasi2015Perimeter]:

When the set of toppings is maximal, every hole is convex.

From here, Akopyan's proof proceeds as follows.

Each side of a hole is formed by one of the Ci-s. Lets call two sets Ci and Cj neighbors, if they form two adjacent sides of some hole. Note that:

To each hole correspond at least 3 neighbor-pairs - since each hole has at least 3 sides.

To each neighbor-pair Ci,Cj correspond at most two holes - since all such holes must have a side co-linear with the segment in which the boundaries of Ci and Cj intersect.

Therefore, the number of holes is at most 2/3 the number of neighbor-pairs.

The "neighbor" relation defines a planar graph which is denoted by G. Denote by V the set of vertexes of G - which are the toppings [formula]. Denote by E the set of edges of G - which are the neighbor-pairs defined above. Denote by F the set of faces of G. By Euler's formula: |V| - |E| + |F| = 2. Each face is at least a triangle so it is adjacent to at least three edges. Each edge is adjacent to at most two faces. Hence, |F|  ≤  2|E| / 3. Substituting into Euler's formula gives |V| - |E| / 3  ≥  2 so |E|  ≤  3|V| - 6. Hence, the number of neighbor-pairs is at most 3k - 6. Hence, the number of holes is at most 2m - 4, and so is the number of blanks: b  ≤  2m - 4.

Rectangular Cake and Rectangular Pieces

In this section, S is the family of axes-parallel rectangles and the cake C is also an axes-parallel rectangle. I adapt the proofs of [\citet=Pinchasi2015Perimeter] and [\citet=Akopyan2016Partitioning] to prove that the worst-case number of blanks when the set of toppings is maximal is m - o(m).

Lower bound

Consider the tiling in Figure [\ref=fig:holes-rect-worst], and imagine that it fills the entire 2-dimensional plane.

This set of squares is apparently maximal. Each blank touches four squares and each square touches four blanks. Hence, the number of squares and blanks is asymptotically the same.

If the tiling is finite, then the number of blanks is slightly smaller, since some blanks near the boundary of C can be discarded or joined with nearby rectangles. But, the number of blanks near the boundary is only [formula]. Hence, in the worst case there may be as many as [formula] blanks.

Upper bound part A: All holes are axes-parallel rectangles

Similarly to the convex setting, I prove that every hole is an axes-parallel rectangle, and thus every hole corresponds to a single blank. Let H be a hole (a part of C not contained in any of the toppings Ci). The boundary of H is made of line-segments that are parts of the boundaries of the Ci, and possibly some line-segments that are parts of the boundary of C. The examples below refer to Figure [\ref=fig:holes-rect].

A vertex of H is a point on H's boundary that is a vertex of Ci or of C.

Note that this includes the vertexes of H as a polygon, but may also include "flat vertexes" (vertexes with angle [formula], such as the vertex N).

An edge of H is a line-segment between two vertexes of H.

A vertex/edge that is contained in the boundary of C is called a boundary-vertex/edge. Otherwise it is called an internal-vertex/edge.

A connection-vertex is a boundary-vertex connecting an internal-edge and a boundary-edge (e.g. the vertexes J, O).

By our definition of the vertexes of a hole H, it is clear that each edge of H is contained either in an edge of a single topping Ci (an internal edge) or in an edge of the cake C (a boundary edge).

For each edge e, let Con(e) be the (unique) rectangle one of whose edges contains e. This may be either a single Ci or C.

Given a vertex v and an edge e of a hole H, say that v is exposed in e if v is a vertex of Con(e).

For example, the vertex D is exposed in the edge DQ but not in the edge DR.

A vertex of H is called reflex if the internal angle adjacent to it (the angle through the interior of H) is larger than [formula].

Since all rectangles are parallel to the axes, a reflex vertex (e.g. the vertex G) must have an internal angle of [formula].

Every internal edge of a hole cannot have both of its vertexes exposed.

Let e be an internal edge of a hole H. Then Con(e) must be one of the toppings Ci. This means that e is equal to an edge of Ci. But then, the rectangle Ci can be stretched over e and into the hole H, contradicting the maximality condition.

For example, the internal edge DQ has both its vertexes exposed, and indeed the rectangle C1 can be stretched rightwards into the hole and the configuration is not maximal.

Every internal vertex is exposed in at least one of its two adjacent edges.

Let v be an internal vertex and let e,e' be its two adjacent edges (which must both be internal edges). Suppose by contradiction that v is not exposed in e nor in e'. Then v is both internal to an edge of Con(e) = Ci and internal to an edge of Con(e') = Cj. But this implies that Ci and Cj overlap, contradicting the pairwise-disjointness condition.

Every internal reflex-vertex is exposed in both its adjacent edges.

An internal reflex-vertex of a hole is necessarily a vertex of some topping Ci which does not touch any other topping. Hence, its two adjacent edges are edges of Ci, so it is exposed in both of them (see e.g. vertexes G, R).

Every connection-vertex is exposed in its adjacent internal edge.

Since the cake C is a rectangle, a connection-vertex of a hole can happen only when the vertex of a rectangle-topping touches the interior of an edge of C.

Every vertex of a hole must be internal.

By contradiction, let H be a hole with a boundary-vertex. Let [formula] be a maximal path of edges of H that are internal. Let v0 be the vertex before e1 and vt the vertex after et; note that v0 and vt are connection-vertexes (e.g. J and O).

By Lemma [\ref=lem:connection-exposed], v0 is exposed in e1 and vt is exposed in et. So, in the traversal from v0 to vt through [formula], the first vertex is exposed in the edge after it (e.g. J is exposed in JR) and the last vertex is exposed in the edge before it (e.g. O is exposed in GO). All other vertexes in the path are internal, so by Lemma [\ref=lem:exposed1of2-internal] each of them is exposed in at least one edge. All in all, there are t + 1 exposed vertexes but only t edges, so by the pigeonhole principle, at least one edge in the path must have two of its vertexes exposed - a contradiction to Lemma [\ref=lem:exposedno2].

No vertex of a hole H is reflex.

By contradiction, let v be a reflex vertex of H (e.g. the vertex G). By Lemma [\ref=lem:no-boundary-vertex] it is internal so by Lemma [\ref=lem:reflex-exposed] it is exposed in both its adjacent edges.

Starting from v, traverse the edges and vertexes of H until you reach v again (e.g. from G through GP to P through PF to F ... to O through OG to G). In this traversal, v is exposed both in the edge after it (e.g. GP) and in the edge before it (e.g. GO). By Lemma [\ref=lem:no-boundary-vertex], all vertexes in the traversal are internal, so by Lemma [\ref=lem:exposed1of2-internal], each of them is exposed in at least one edge. All in all, there are t + 1 "exposed" relations but only t edges, so by the pigeonhole principle, at least one edge in the path must have two of its vertexes exposed - a contradiction to Lemma [\ref=lem:exposedno2].

Every hole H must be a rectangle and must be strictly in the interior of C (not adjacent to its boundary).

Upper bound part B: Counting the holes

By Corollary [\ref=cor:holes-rect], each hole must be a rectangle internal to the cake C. Therefore, the sides of each hole are formed by the rectangular toppings [formula]. Let's call two such toppings neighbors if they form adjacent sides of the same hole.

Each hole has 4 sides, so to each hole correspond (at least) 4 neighbor-pairs.

To each neighbor-pair Ci,Cj correspond at most two holes - since all such holes must have a side co-linear with the segment in which the boundaries of Ci and Cj intersect.

Therefore, the number of holes is at most 1/2 the number of neighbor-pairs.

The "neighbor" relation defines a planar graph which is denoted by G. Denote by V the set of vertexes of G - which are the rectangles [formula]. Denote by E the set of edges of G - which are the neighbor-pairs defined above. Denote by F the set of faces of G. By Euler's formula: |V| - |E| + |F| = 2. Since all angles are multiples of [formula], each face is adjacent to at least four edges. Each edge is adjacent to at most two faces. Hence, |F|  ≤  |E| / 2. Substituting into Euler's formula gives |V| - |E| / 2  ≥  2 so |E|  ≤  2|V| - 4. Hence, the number of neighbor-pairs is at most 2m - 4, so the number of holes is at most m - 2 and so is the number of blanks: b  ≤  m - 2.

Rectilinear-polygonal cake and rectangular pieces

In this section, S is still the family of axes-parallel rectangles, but now the cake C can be an arbitrary axes-parallel rectilinear polygon. The "complexity" of a rectilinear polygon is characterized by the number of its reflex vertexes - vertexes with internal angle [formula]. It is known that a rectilinear polygon with R reflex vertexes can always be partitioned to at most R + 1 rectangles [\citep=Keil2000Polygon] [\citep=Eppstein2009GraphTheoretic], and this bound is tight when the vertexes of C are in general position. Since our goal is to bound b - the number of blank rectangles - it is expected that the bound should depend on R, in addition to m (the number of toppings).

Lower bound

Consider the tiling of Figure [\ref=fig:holes-rect-worst] in Subsection [\ref=sub:rect-lower]. Assume that the tiling is contained in a very large square, and the square is connected in a narrow pipe to a rectilinear polygon with R reflex vertexes. As explained there, there are [formula] blanks in the square. The connected rectilinear polygon is a single hole, but it may contain as many as R + 1 blanks (its rectangular components). All in all, there are [formula] blanks.

Upper bound part A: characterizing the holes

The first three lemmas of Subsection [\ref=sub:rect-upper-a] ( Lemmas [\ref=lem:exposedno2] and [\ref=lem:exposed1of2-internal] and [\ref=lem:reflex-exposed]) are still true since they do not depend on the shape of C. But the last three lemmas are not true.

The difference starts at Lemma [\ref=lem:connection-exposed]: since C is not a rectangle, there may be connection-vertexes which are vertexes of C and not of any topping Ci. See e.g. the vertexes S1,T1,S2 in Figure [\ref=fig:holes-rectilinear]. That lemma has to be generalized as follows:

Every connection-vertex of a hole is either exposed in its adjacent internal edge, or it is a reflex vertex of the cake C.

Let v be a connection-vertex. If it is a vertex of a topping, then it is exposed in the edge of that topping (which is an internal edge), so we are done.

Otherwise, it must be a vertex of the cake. If it is a convex vertex of the cake, then it necessarily connects two edges of the cake, so it cannot be a connection-vertex. Hence, it must be a reflex vertex of the cake.

Note that, if a connection-vertex of a hole H is a reflex-vertex of C (the latter case in the above lemma), then that vertex must be a convex vertex of H. Hence, such a vertex is called a convexified vertex:

A convexified vertex is a reflex-vertex of C which is a convex-vertex of some hole.

So by Lemma [\ref=lem:connection-exposed-reflex], every connection-vertex of a hole is either exposed in its adjacent internal edge, or it is a convexified vertex.

Lemma [\ref=lem:no-boundary-vertex] is also no longer true; a hole may be adjacent to the boundary of C. That lemma has to be generalized as follows:

If a hole is adjacent to the boundary of C, then it must have at least one convexified vertex.

Each hole must have at least two connection-vertexes. If, by contradiction, none of these vertexes is convexified, then by Lemma [\ref=lem:connection-exposed-reflex], both must be exposed in the internal edges adjacent to them. But then, similarly to the proof of Lemma [\ref=lem:no-boundary-vertex], the path between these vertexes must have an edge both of whose vertexes are exposed - a contradiction.

Lemma [\ref=lem:no-reflex-vertex] is also no longer true. A hole may have reflex vertexes. E.g, in H1, both Q1 and R1 are reflex vertexes; Q1 is a reflex boundary-vertex (it is a reflex vertex of C), and R1 is a reflex inner-vertex. That lemma has to be generalized as follows:

Let v be a reflex internal-vertex of a hole H. Then, any traversal of the boundary of H starting at v, either clockwise or counter-clockwise, must eventually meet a convexified vertex of C, and it must not meet any other reflex vertex of H on its way.

Lemma [\ref=lem:reflex-exposed] is still true, so regardless of the direction of our traversal, v is exposed in the edge following it in the path. If it meets another reflex vertex (including itself), then, since this another vertex is exposed in the edge before it in the path, by the pigeonhole principle there must be an edge both of whose vertexes are exposed - a contradiction (this reasoning is similar to the proof of Lemma [\ref=lem:no-reflex-vertex]). Similarly, if it meets a connection-vertex which is not convexified (like T2), then this vertex is exposed in the edge before it in the path, which again leads to a contradiction. The only remaining option is that the traversal ends in a convexified vertex, since this is the only kind of vertex which may be not exposed.

For example, a traversal from R1 clockwise meets T1 and a traversal counter-clockwise meets S1; both are convexified vertexes of C, and both are not exposed in the edges between them and R1.

The above lemma has the following corollary, which replaces Corollary [\ref=cor:holes-rect]:

Every internal hole (a hole not adjacent to the boundary of C) must be a rectangle.

Upper bound part B: Counting the holes

The upper bound in Subsection [\ref=sub:rect-upper-b], namely m - 2, is still a valid upper bound on the number of internal holes. By Corollary [\ref=cor:holes-rect-internal], this is a valid bound on the number of internal blanks.

To bound the total number of blanks, we have to handle the blanks resulting from boundary holes. The main step is to bound the number of reflex vertexes in the boundary holes.

Let Bh be the set of boundary holes, Rh the set of reflex vertexes in all boundary holes, and RC the set of reflex vertexes in C. Then:

[formula]

The lemma is proved by the following 1-1 mapping from [formula] into RC:

Each element of Bh (a boundary hole) is mapped to a convexified vertex of C, which exists by Lemma [\ref=lem:connection-exposed-reflex].

Each element v∈Rh which is an internal reflex-vertex, by Lemma [\ref=lem:reflex-vertexes] corresponds to two convexified-vertexes; at most one of them is already mapped to the hole containing v, so v can be mapped to the other convexified-vertex.

Each element v∈Rh which is a boundary reflex-vertex is mapped to itself. Note that v is a reflex vertex of a hole, so it is not convexified, so it was not mapped in the previous two bullets.

The total number of reflex-vertexes in all boundary holes satisfies:

[formula]

where R = |RC| =  the number of reflex vertexes of C.

As mentioned above, a rectilinear polygon with R reflex vertexes can always be partitioned to at most R + 1 rectangles [\citep=Keil2000Polygon] [\citep=Eppstein2009GraphTheoretic]. Hence, by Corollary [\ref=cor:reflex-vertexes-count], the set Bh can be partitioned to rectangles such that the total number of rectangles is at most (R - |Bh|) + |Bh| = R.

All in all, the number of (rectangular) blanks is at most: R + m - 2.

Acknowledgments

I am grateful to Arseniy Akopyan, whose answer to my question in Math Overflow [\citep=Akopyan2016Partitioning] lead me to writing this paper. I am also grateful to Reuven Cohen and David Peleg for discussions about the problem studied in this paper. All figures were created with GeoGebra 5 [\citep=GeoGebra5].