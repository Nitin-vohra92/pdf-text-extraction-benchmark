Quadratic forms and semiclassical eigenfunction hypothesis for flat tori

Proposition

Remark Lemma Conjecture

Corollary

Definition Example

Proof

Introduction

Semiclassical eigenfunction hypothesis for flat tori

We begin by describing the main application of this paper. Let [formula] be the flat torus of dimension [formula] with the laplacian operator [formula], and {ψi} an orthonormal basis of eigenfunctions. Malkloff and Rudnick [\cite=Marklof] showed that for every rational polygonal and flat torus [formula] there is a density one subsequence of any orthonormal basis {ψi} such that |ψi|2 converges weakly to the uniform distribution in [formula], i.e. for any continuous function f on [formula]

[formula]

M.V. Berry [\cite=Berry] [\cite=Michael] in his work on the " Semiclassical Eigenfunction Hypothesis" suggested to go beyond this weak convergence, and study the equidistribution of |ψn|2 on small scale. Recently, Lester and Rudnick [\cite=Rudnick] prove the equidistribution of a density one subsequence of {ψi} in an optimal small scale on the flat torus [formula] for d  ≥  2. Density one means if we order the eigenfunctions by their eigenvalue then the subsequence contains a density one subset of the basis. More precisely, they show that along a density one subsequence of the orthonormal basis {ψn},

[formula]

where ψn is an eigenfunction with eigenvalue λn and B(y,r) is any ball of radius [formula] centered at an arbitrary point [formula]. The exponent [formula], for the size of the ball, is optimal. Moreover, for dimension 3 and 4, they prove a stronger result. They prove the small scale equidistribution holds for almost every eigenfunction in individual eigenspace with the optimal exponent [formula] and they conjecture that the same result holds for every d  ≥  5 . The main application of this paper is to resolve this conjecture. In what follows, we explain their result and conjecture in detail and how it is reduced to counting pair of integral points with small distance on sphere.

We note that the set of eigenvalues of laplacian Δ on [formula] are given by the set of non-negetive integers [formula]. We denote the associated eigenspace by En. It is well-known that the dimension of this space is equal to the number of integral points on sphere of radius [formula] in [formula]. Therefore, for d  ≥  5, the multiplicity of each eigenvalue n is large and grow like a scaler multiple of [formula]. The intersection of the orthonormal basis of eigenfunctions {ψi} with En gives us an orthonormal basis of eigenfunctions for En. We denote this orthonormal basis of En by [formula]. Rudnick and Lester [\cite=Rudnick] prove that there exists a large subset Cn  ⊂  Bn, which means |Cn| = (1 - o(1))|Bn|, such that along any sequence of {ψn:ψn∈Cn}

[formula]

where B(y,r) is any ball of radius [formula] centered at an arbitrary point [formula]. This means that we can choose our density one subsequence so that it contains a large proportion of the basis restricted to each eigenspace. In this paper we prove the analogue of this result for d  ≥  5.

Let [formula] be a [formula] dimensional flat torus and {ψi} an orthonormal basis of eigenfunctions for the laplacian operator. Let En be the associated eigenspace for eigenvalue [formula] and [formula] {ψi} be the restriction of the orthonormal basis {ψi} to En. Then there exists a large subset Cn  ⊂  Bn, which means |Cn| = (1 - o(1))|Bn|, such that along any sequence of {ψn:ψn∈Cn}

[formula]

where B(y,r) is any ball of radius [formula] centered at an arbitrary point [formula]. The exponent [formula] is optimal. In fact there exists a sequence of balls with radius [formula] and an orthonormal basis {ψi} where ([\ref=smallscale]) does not hold for a positive proportion of eigenfunctions in Bn.

Local statistics of integral points on sphere

In this section we explain Lester and Rudnick's [\cite=Rudnick] observation that the small scale equidistribution for individual eigenspace on flat tori is related to counting pair of integral points with small distance on sphere.

Let ψ∈Bn be an orthonormal function in our basis then we can write

[formula]

where

[formula]

Since Bn is an orthonormal basis for En, similarly if we fix [formula] we also obtain

[formula]

Rudnick and Lester estimate the indicator function of the ball B(x,r) by the majorant and minorant Beurling-Selberg trigonometric polynomials a±(θ) on the flat torus [formula] such that

[formula]

Then one can estimate from below and above the local integral ([\ref=smallscale]) by using the trigonometric polynomials a± and reduce the problem into counting pair of integral points with small distance on the sphere. We include a brief exposition of this reduction in what follows

[formula]

Average this inequality over ψ∈Bn and use the identity ([\ref=orthogonality]) to obtain

[formula]

Note that the right hand side of the above inequality is the average over the pair of integral points [formula] on the sphere of radius [formula] where their distance is less than [formula]. For a large integer n, let

[formula]

be the set of integral lattice points on the sphere [formula] of radius [formula]. For any [formula], and |x|2 = n, let

[formula]

be the spherical cap of size Y around the point x on the sphere [formula]. Given a point x∈E(n), let

[formula]

be the number of other lattice points in the cap around x. The mean of μ(x;n,Y), averaged over all lattice points E(n) is:

[formula]

We note that [formula] when d  ≥  5 and the volume of [formula] is [formula]. Heuristically, if we assume that the integral points are uniformly distributed, then we expect to have [formula] integral points inside a cap of size Y. So, if [formula] then we expect to have no integral points inside a cap of size Y. On the other hand, if [formula] then we expect to have many points. In fact, we have the following corollary of our main theorem that makes this heuristics rigorous.

Let d  ≥  5. Assume that Y, the size of the caps, satisfies

[formula]

Then the probability that a cap of size Y centered at integral point has more than log (n) points is greater than 1 / 2

[formula]

as a result

[formula]

On the other hand, if [formula], then

[formula]

Lester and Rudnick [\cite=Rudnick] remarked that the small scale equidistributin for individual eigenspace as stated in Corollary [\ref=small] is implied from

[formula]

where [formula]. Bourgain [\cite=Rudnick] show that the exponent [formula] is optimal by using the fact that

[formula]

Therefore corollary [\ref=mainn] implies the corollary [\ref=small].

Main theorem

In our main Theorem ([\ref=main]), we give an uniform upper bound on the number of integral points on a quadric that is defined by any positive definite integral primitive quadratic form with discriminant D in k  ≥  4 variables. First, We state our main theorem.

Let n be any integer, and let Q(X) be any primitive positive definite integral quadratic form of discriminant D in k  ≥  4 variables. If [formula], then the number of integral solutions of Q(X) = n is bounded from above by

[formula]

where cε is a constant which depends only on ε and not on Q(X) or n.

Outline of the paper

We give a brief outline of this paper. In section ([\ref=sec]), we show that corollary ([\ref=mainn]) is a consequence of our main Theorem ([\ref=main]). Next, we give a proof of our main Theorem ([\ref=main]). In the proof of Theorem ([\ref=main]), we use an improved version of a lemma in Blomer's papers [\cite=Val] or [\cite=VB]. Professor Blomer provided us a proof for this improved version of his previous lemma.We include his proof in our appendix. We are responsible for any gap or typo in the appendix.

We begin by introducing some notations. We write r(Q,n) for the number of integral solutions of

[formula]

We consider the Theta series associated to this quadratic form

[formula]

This is a modular form of weight k / 2 and level N, where N is the smallest integer such that NL- 1 is an integral matrix . From the theory of modular forms we can write Θ(z) uniquely as a sum of standard Eisenstien series E(z,Q) (the Eisenstein series of the form Q) and a cusp form F(z,Q)

[formula]

From this decomposition

[formula]

where, ρ(n,Q) and τ(n,Q) are the n-th Fourier coefficients of E(z,Q) and F(z,Q) respectively. In Lemma ([\ref=1]), we use the Siegel product formula (The main term of the Hardy-Littlewood formula) to give an upper bound on ρ(n,Q). In Lemma ([\ref=Cusp]), we invoke the upper bound of Blomer [\cite=Val] on [formula] and then we apply the Petersson trace formula to give an upper bound on τ(n,Q). The theorem is a consequence of lemma ([\ref=1]) and lemma ([\ref=Cusp]).

Acknowledgments

We are grateful to Professor Valentin Blomer for his comments and letter to us. In the letter, he proves lemma ([\ref=l2]) which improves his earlier lemma [\cite=Val]. This lemma is crucial in our work. We would also like to thank Professor Zeev Rudnick for suggesting this project to us and his comments on the earlier version of this paper. Finally, I would like to thank Masoud Zargar for several comments and remarks on the earlier versions of this work.

Proof of corollary ([\ref=mainn])

We begin by proving the first part of Corollary ([\ref=mainn]) when the size of the caps is large, i.e.

[formula]

This part is elementary; we use a covering argument in combination with a pigeonhole argument. We assume that [formula]. Call an integral point p∈E(n) bad if

[formula]

We denote the number of bad points by B. Assume to the contrary that [formula]. Hence, using [formula], [formula] Consider balls of radius [formula] centered at each bad point. Each point of the sphere is covered by at most log (n) of these balls; otherwise, there are more than log (n) bad points with distance at most Y, contradicting the definition of a bad point. Therefore, we have the following inequality from a covering argument

[formula]

Hence,

[formula]

This is a contradiction to [formula] Therefore, [formula]. Consequently,

[formula]

Therefore,

[formula]

This concludes the proof of the first part.

The second part of the Corollary ([\ref=mainn]) is a consequence of the inequality

[formula]

where [formula] and 5  ≤  d.

For the second part of Corollary ([\ref=mainn]), when the size of caps is small, i.e.

[formula]

we follow the technique in the argument for [\cite=Rudnick] to prove lemma ([\ref=ll]). Let Ad(n,t) be the number of ordered pairs of distinct integral lattice points [formula] such that |p|2 = |q|2 = n and |p - q|2 = 2(n - t). Note that a change of summation argument gives us the equality

[formula]

Since [formula] and [formula], so [formula] and we can apply the inequality

[formula]

and we obtain

[formula]

Using [formula] and [formula], we get

[formula]

Lemma ([\ref=lem]) is devoted to showing that the following inequality in lemma ([\ref=ll]) is true:

[formula]

for [formula] and 5  ≤  d.

Theorem ([\ref=main]) implies that

[formula]

where [formula] and 5  ≤  d.

Recall that Ad(n,t) is the number of ordered pairs of distinct integral lattice points [formula] such that |p|2 = |q|2 = n and |p - q|2 = 2(n - t). Let v: = p - q. Note that v is an integral vector of length [formula] and so, up to a constant, we have at most

[formula]

choices for v, because d  ≥  5 . Note that

[formula]

and

[formula]

Let L be the (d - 1)-dimensional lattice that is given by the intersection of [formula] and the hyperplane orthogonal to v. Therefore, p + q lies inside the lattice L and the sphere of radius [formula]. The fundamental domain of the lattice L has volume [formula] where [formula] is the primitive integral vector in the direction of v. We take an integral basis for the lattice L and denote it by

[formula]

We define the symmetric matrix A by

[formula]

We define the quadratic form Q(X) by

[formula]

This quadratic from is a primitive quadratic form in (d - 1)  ≥  4 variables with discriminant [formula]. We have the following upper bound on the discriminant of Q

[formula]

Since [formula] when d  ≥  5 we also have

[formula]

We can apply theorem [\ref=main], and as a consequence we have the following bound on the number of lattice points of L with norm 2(n + t)

[formula]

Recall that |v|2 = |p - q|2 = 2(n - t) and the number of integral points v where [formula] is less than [formula] up to a constant. We give an upper bound on Ad(n,t) by first choosing v = p - q and then p + q

[formula]

Therefore,

[formula]

Proof of the Main thoerem

We write r(Q,n) for the number of integral solutions of

[formula]

We consider the theta series associated to this quadratic form

[formula]

This is a modular form of weight [formula] and level N, where N is the smallest integer such that NL- 1 is an integral matrix . From the theory of modular forms we can write Θ(z) uniquely as a sum of standard Eisenstien series E(z,Q) (the Eisenstein series of the form Q) and a cusp form F(z,Q)

[formula]

From this decomposition

[formula]

where, ρ(n,Q) and τ(n,Q) are the n-th Fourier coefficients of E(z,Q) and F(z,Q) respectively. In Lemma [\ref=1], we use the Siegel product formula (The main term of the Hardy-Littlewood formula) to give an upper bound on ρ(n,Q). In Lemma [\ref=Cusp], we invoke the upper bound of Blomer on [formula] in Lemma ([\ref=Valup]) that is proved in our appendix. Finally we apply the Petersson trace formula together with a Cauchy inequality to give an upper bound on the n-th Fourier coefficient τ(n,Q) of F(z,Q). Theorem ([\ref=main]) is a consequence of lemma ([\ref=1]) and lemma ([\ref=Cusp]).

The following lemma proved by Blomer [\cite=VB] for k = 3. We follow his strategy and give a proof for every k  ≥  4.

We have the following upper bound on the n-th Fourier coefficient of the Eisenstein series of the form Q

[formula]

where N is the level of the quadratic from Q.

ρ(n,Q), the n-th Fourier coefficient of the Eisenstein series, coincides with the main term of the Hardy-Littlewood formula. The main term of the Hardy-Littlewood formula, is given by the product of local densities

[formula]

We have the following formula for the local densities:

[formula]

where

[formula]

([formula] means gcd (a,p) = 1 and that a varies mod pt, b is a vector that varies mod [formula], and S(1)=1).

We give an upper bound for each place. First, we start with ∞  . The density at ∞   is given by

[formula]

We diagonalize Q(X) in an orthonormal coordinates [formula] such that

[formula]

where [formula] are the eigenvalues of the symmetric matrix A. We change the variables to [formula] to get

[formula]

Next, we give an upper bound on the local densities σp where p  ≠  2. Since p is an odd prime number, we can diagonalize our quadratic form Q(X) over the local ring [formula]. Without loss of generality we assume that

[formula]

where gcd (ai,p) = 1 and [formula]. We substitute the diagonal expansion of [formula] to compute S(pt) We note that the last summation is a Gauss sum. Let [formula] be the Gauss sum, and let εm = 1 if [formula] and εm = i if [formula]. Then if gcd (h,m) = 1 we have

where [formula] is the Jacobi symbol. We have

[formula]

We define [formula] when t  <  αi. We substitute the values of G and obtain,

where [formula] is the number of integers i such that 1  ≤  i  ≤  k and t - αi is a positive odd integer. Assume that [formula], where [formula]. If [formula] is an odd number then the inner sum is a Gaussian sum, and we obtain Hence, if [formula] is odd we deduce that

[formula]

On the other hand, if [formula] is even then the inner sum is a Ramanujan sum cpt(n),

[formula]

Hence, if [formula] is even we deduce that

[formula]

Without loss of generality suppose that [formula]. Since Q(X) is primitive we deduce that α1 = 0. If [formula] is odd ([\ref=odd]) and if [formula] is even ([\ref=even]), we deduce that

[formula]

From the above inequality and the condition that k  ≥  4, we give an upper bound on the product of local densities [formula] as follows.

[formula]

If p is an odd prime number from the inequality ([\ref=inq]), we obtain

[formula]

Hence, for odd prime numbers where p|nN we have

[formula]

Finally, we assume that p = 2. One can write any quadratic form Q(X), after a change of variables over the 2-adic integers [formula], as a direct sum of scalar multiples of q0(x): = x2, q1(x1,x2): = x1x2 and q2(x1,x2): = x21 + x1x2 + x22. The corresponding Gauss sums can be evaluated for odd h:

[formula]

and

[formula]

We substitute the values of these Gauss sums and obtain

[formula]

From the inequality ([\ref=inq22]), we obtain

[formula]

This inequality together with inequality ([\ref=rrr]) for odd primes p implies

[formula]

Therefore, we conclude the lemma.

In Lemma [\ref=Cusp], we invoke a result of Blomer, proved in Appendix 1, and then we apply the Petersson trace formula together with a Cauchy inequality to give an upper bound on τ(n,Q). Theorem ([\ref=main]) is a consequence of lemma ([\ref=1]) and lemma ([\ref=Cusp]).

Let Q(X) be a quadratic form in k  ≥  4 variables and discriminant [formula]. Then we have the following upper bound on the n-th Fourier coefficient of the cusp form part of the theta series associated to Q

[formula]

In particular

[formula]

We take an orthonormal basis {fi} for the space of cusp forms of weight k / 2 and level N. We write F(z,Q) as a linear combination of them

[formula]

We obtain

[formula]

We apply Cauchy inequality to obtain

[formula]

Since we take an orthonormal basis for the space of cusp forms we deduce that

[formula]

We invoke a result of Blomer. The proof is included in Appendix 1.

We have

[formula]

for k  ≥  4. As a corollary,

[formula]

Next, we give an upper bound on the sum over the square norm of the n-th Fourier coefficients of {fi}

[formula]

We apply the Petterson formula for the modular forms of weight k / 2 . See [\cite=Hen]

[formula]

In order to give an upper bound on K(n,n;c), we apply the bound on Salie's sum for odd dimensions k and Weil's bound on the Kloosterman's sum for even dimensions k. We invoke the following formula [\cite=Iwan]

[formula]

where l = k / 2. Since the discriminant [formula] and N|D then

[formula]

From the inequalities ([\ref=kkk]), ([\ref=kk]) and ([\ref=k]) we deduce that

[formula]

This concludes the first part of the lemma. For the second part, [formula] implies that

[formula]

Hence,

[formula]

The main theorem ([\ref=main]) is a consequence of lemma ([\ref=l2]) and lemma ([\ref=1]).

Appendix

In this appendix, we include Valentin Blomer's paper to us. We are responsible for any gap or typo in this section.

Let

[formula]

be a primitive positive definite integral k-dimensional quadratic form (k  ≥  3) of discriminant D and level N. For [formula] let r(n,Q) denote the number of representations of n by Q and let ρ(n,Q) be the main term given by a formal application of the circle method. Denote by [formula] the successive minima (see [\cite=Cassels] ) of Q(X). We can write

[formula]

with [formula] such that

[formula]

Let Θ(Q,z) denote the corresponding theta-series and F(z,Q) the orthogonal projection onto the space of cusp forms. The following lemma uses only reduction theory and the Lipschitz principle.

We have

[formula]

and

[formula]

We choose [formula] in

[formula]

ways. Then we are left with an inhomogeneous binary problem that has O(nε) solutions (see [\cite=Michel]), uniformly for all choices of [formula]. To prove the second part, we choose [formula] in

[formula]

ways.

We have

[formula]

Finally, we give a proof of Lemma ([\ref=Valup]). It suffices to show that

[formula]

Note that if k  ≥  4, then the right hand side is ≪  NDk - 3 + ε.

We follow the argument of [\cite=Val] or [\cite=VB]. This gives

[formula]

where [formula] has determinant NkD- 1 and level N. Inserting Lemma [\ref=1] and Corollary [\ref=cor1], we obtain after a short computation the desired bound.