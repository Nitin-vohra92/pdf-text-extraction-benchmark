=1

Remark Lemma

A Mixed Finite Element Method to Solve the EEG Forward Problem

Vorwerk : A Mixed Finite Element Method to Solve the EEG Forward Problem

Introduction

EEG forward problem is to simulate the electric potential on the head surface that is generated by a minimal patch of active brain tissue. Its accurate solution is fundamental for precise EEG source analysis. This can be achieved via numerical methods that allow one to take the realistic head geometry into account. Here, finite element methods (FEM) achieve high accuracies and enable one to realistically model complicatedly shaped tissue boundaries, such as the gray matter/CSF interface, and to incorporate tissue conductivity anisotropy. The importance of incorporating these model details for the computation of accurate forward solutions and in consequence also for precise source analysis was shown in multiple studies [\cite=aca2013effects] [\cite=cho2015influence] [\cite=CHW:Vor2014].

A variety of different FEM approaches has been proposed, e.g., the St. Venant, partial integration, Whitney, or subtraction approach [\cite=CHW:Buc97] [\cite=CHW:Yan91] [\cite=CHW:Pur2011] [\cite=CHW:Wol2007e] [\cite=vor2016] [\cite=CHW:Wol2007b]. While these approaches differ in the way the dipole source is modelled, the underlying discretization of the continuous partial differential equation (PDE) is the same; a conforming Galerkin-FEM with most often linear Ansatz-functions (CG-FEM). The necessary discretization of the head volume can be achieved either using tetrahedral or hexahedral head models. Hexahedral models have the advantage that they can be directly generated from voxel-based magnetic resonance images (MRI), while the generation of tetrahedral meshes can be complicated. Therefore, hexahedral meshes are more and more frequently used in praxis [\cite=ayd2014combining] [\cite=CHW:Rul2009] and were furthermore recently positively validated in an animal study [\cite=lau2016skull].

In this article, a mixed finite element method (Mixed-FEM) to solve the EEG forward problem is introduced. Compared to the CG-FEM it has the advantage that the current source can be represented in a direct way, while either an approximation using electrical monopoles has to be derived or the subtraction approach has to be applied when using the CG-FEM. Furthermore, the Mixed-FEM is current preserving and thereby prevents the effects of the (local) current leakages through the skull that might occur for the CG-FEM [\cite=son2013leakage] [\cite=eng2015subtraction]. This is also shown in simulations in Section [\ref=sub:results-leaky]. An accurate simulation of the currents penetrating the skull is important, as the influence of an accurate representation of the skull for accurate forward simulations was shown [\cite=mon2014influence] [\cite=CHW:Lan2012]. The accuracy of the Mixed-FEM in comparison to CG-FEM approaches is evaluated in both sphere and realistic head models. It is shown that the Mixed-FEM achieves higher accuracies in solving the EEG forward problem than the CG-FEM for highly eccentric sources in sphere models and also in realistic head models.

Theory

the quasi-static approximation of Maxwell's equations [\cite=ham1993] [\cite=CHW:Bre2012], the forward problem of EEG is commonly formulated as a second-order PDE with homogeneous Neumann boundary condition Here, u denotes the electric potential, [formula] the source current, and σ the conductivity distribution in Ω. This PDE is obtained by eliminating the current [formula] as an unknown from the system of first-order PDEs To derive the Mixed-FEM for the EEG forward problem, we proceed with [\eqref=eq:forward-system] instead of discretizing [\eqref=eq:forward] as it is done for the CG-FEM.

A (Mixed) Weak Formulation of the EEG Forward Problem

Due to the vector-valued equation [\eqref=eq:forward-system1], it is necessary to introduce a space of vector-valued test functions. A natural function space for the current in the mixed formulation is [formula]:

[formula]

Akin to the scalar-valued Sobolev spaces [formula], this space becomes a Hilbert space with the norm

[formula]

We introduce a subspace [formula] of [formula], such that the boundary condition [formula] is fulfilled by definition:

[formula]

For the scalar-valued equation [\eqref=eq:forward-system2], one can simply choose the space of square-integrable functions [formula] as the test space.

Now, we can introduce the weak formulation of [\eqref=eq:forward-system] This is the so-called dual mixed formulation, since the derivatives operate on the vector-valued functions [\cite=arn1990mixed]. We define the bilinear forms for [formula], [formula], [formula], σ∈L  ∞  , σ  >  0. Thereby, to solve [\eqref=eq:mixed-weak] is to In this notation, the saddle point structure of problem [\eqref=eq:mixed-op] and thus also [\eqref=eq:mixed-weak] is recognizable. As a consequence, existence and uniqueness of a solution cannot be shown using the Lemma of Lax-Milgram. Indeed, while the therefore necessary boundedness is satisfied for operator a as defined in [\eqref=def:mixed-a], ellipticity is not given.

Further analysis shows that to prove existence and uniqueness of a solution to [\eqref=eq:mixed-op], it is necessary that the operator a is [formula]-elliptic and b fulfills an inf-sup condition, which is in this case also called LBB condition, named after the mathematicians Ladyzhenskaya, Babuska, and Brezzi. At this point, we shall restrict to noting that these conditions are fulfilled by a and b defined as in [\eqref=def:mixed] and thereby existence and uniqueness of a solution [formula] is given. For a detailed proof we refer, e.g., to [\cite=vor2016] [\cite=CHW:Bra2007] [\cite=bre2012mixed].

Mixed Finite Element Method

Obtaining a numerical solution for [\eqref=eq:mixed-weak]/[\eqref=eq:mixed-op] necessitates choosing suitable discrete approximations for the test function spaces [formula] and [formula]. Utilizing a Galerkin approach, these are also the spaces in which the discrete solution [formula] lies.

In order to construct the discrete subspaces, the volume Ω is subdivided and approximated by a set of simple geometrical objects. In three dimensions, these objects are usually tetrahedra or hexahedra. For the sake of simplicity, any subdivision of Ω into either tetrahedra or hexahedra is referred to as triangulation T  =  {T1,T2,T3,...,Tm} in the following. We further assume that the triangulation T is admissible [\cite=CHW:Bra2007] and write Th instead of T, if each element T∈T has a diameter of maximally 2h.

As a discrete subspace of [formula], we can now simply choose the space P0 of piecewise constant functions on each element.

[formula]

A basis of this space is given by the set of characteristic functions [formula] for each element T∈Th. We denote this set of P0 basis functions by [formula].

For [formula], we choose the space RT0 of lowest order Raviart-Thomas elements as discrete subspace [\cite=ned1980mixed] [\cite=rav1977mixed].

[formula]

A basis of the space RT0 can be defined for both tetrahedral and hexahedral elements. We restrict to explicitly noting the hexahedral case, which is also used in the numerical evaluations. For a regular, hexahedral mesh with edge length h, a RT0 basis function [formula] is supported on the two hexahedra Q1,Q2∈Th sharing the face [formula] with normal vector [formula] and centroid k. It can be defined via

[formula]

This definition can be transferred to non-degenerated parallelepipeds using a Piola transformation to preserve the normal components [\cite=ned1980mixed] [\cite=bre2012mixed]. We denote the set of Raviart-Thomas basis functions [formula] by SRT0.

Using Fortin's criterion, it can be shown that existence and uniqueness of a solution to [\eqref=eq:mixed-op] are conserved when replacing [formula] and [formula] by their discrete approximations P0 and RT0. For details it is referred to [\cite=bre2012mixed]. [\eqref=eq:mixed-op] can now be written as a matrix equation:

[formula]

with

[formula]

For the submatrices A and B we have [formula] and [formula], [formula], respectively, and thus the dimension of K is [formula].

The Schur Complement

The matrix K has a large 0-block. Thus, directly solving [\eqref=eq:mixed-disc] is not recommendable [\cite=ber1994mixed]. Krylov subspace algorithms, such as variants of the conugate gradient (CG) or generalized minmal residual (GMRES) method, are not as efficient as for many other problems, since the commonly used methods for preconditioning fail. Nevertheless, much research has been performed trying to find preconditioning techniques that make a solution using CG-solvers possible [\cite=axe1994iterative] [\cite=gol1989matrix]. We apply a different solution strategy that makes use of the fact that A is - unlike K - positive definite. If we write [\eqref=eq:mixed-disc] as a system of two equations, we can left-multiply A- 1 to [\eqref=eq:mixed-disc-1] and solve for j, i.e., j  =  A- 1(b  -  Btu). Inserting this into [\eqref=eq:mixed-disc-2] leads to

[formula]

S  =  BA- 1BT is the so-called Schur complement, [formula]. S is positive definite and since A is symmetric, also S is symmetric. Thus, with h  =  BA- 1b, solving [\eqref=eq:mixed-disc] is reduced to solving

[formula]

Modeling of a Dipole Source

This section focuses on the exact choice of the source distribution [formula], which was left open until now. Principally, arbitrary distributions [formula] can be modelled. However, a common choice in EEG forward modeling is [formula], where [formula] is the Dirac delta distribution and [formula] the dipole moment. Since maximally δ∈H-  3 / 2  -  ε, the assumption [formula] is violated. This does not affect existence and uniqueness of a solution, but may lead to a worse convergence.

As [\eqref=eq:forward] is represented by a system of two PDEs now, there are two options to model the dipole source. The dipole can be modelled either in the "current space" [\eqref=eq:mixed-weak1] or in the "potential space" [\eqref=eq:mixed-weak2] (sometimes also called "pressure space" due to the origin of Mixed-FEM in reservoir simulations [\cite=ste2014comparison]). The first option corresponds to an evaluation of the functional l in the discrete space RT0 as it was defined in [\eqref=eq:mixed-rhs]. For [formula], i.e., a current dipole with moment [formula] at position [formula], we have

[formula]

This approach is called direct approach in the following and we have h  =  hdirect  =  BA- 1b.

A representation of the dipole in the potential space, in the following called projected approach, can simply be obtained using the matrix B, which can be interpreted as a mapping between the current and the potential space. This is similar to the idea of the Whitney approach that was introduced for the CG-FEM [\cite=CHW:Pur2011] [\cite=bau2015comparison], just for the scalar space P0 instead of P1 here. In both approaches, a current source, represented by RT0 basis functions, is projected to the potential space. This results in h  =  hproj  =  Bb; the dipole is represented by a source and a sink in the potential space in this case (Figure [\ref=fig:mixed-rhs-fitted], left).

Solving the Linear Equation System [\eqref=eq:schur]

In the computation of S, A- 1 is a dense matrix. Instead of explicitly computing it, A- 1 is accessed on-the-fly by solving a linear equation system, i.e., instead of calculating x  =  A- 1y we solve Ax  =  y. This can usually be done efficiently, e.g., using preconditioned CG-solvers. Using the obtained implicit representation of S, common solver schemes such as the gradient descent or CG method can be applied to solve [\eqref=eq:mixed-schur]. This corresponds to the frequently described (conjugated) UZAWA-algorithm [\cite=CHW:Bra2007].

When solving [\eqref=eq:mixed-schur] via the CG algorithm with the implicit representation of S, preconditioning is advisable as S has a large condition number. Since S is not directly accessible, it is necessary to use an approximation of S for preconditioning. The use of BBT is proposed in [\cite=ng1993solution], but is only efficient in the case of constant conductivities [\cite=ber1994mixed]. Although BBT approximates the pattern of S well enough, it does not provide a reasonable approximation of the matrix entries of S. Instead, it is suggested to choose a diagonal matrix D that in some sense approximates A and use BD- 1BT as input to the preconditioner [\cite=ber1994mixed]. It is further proposed to choose [formula]. Indeed, this approximation led to the best results when it was compared to the choices Di,i  =  Ai,i, [formula], and [formula] [\cite=vor2016].

Since all considered choices for D are diagonal, the structure of the matrix P  =  BD- 1BT is identical to the structure of BBT and cannot easily be inverted. Also, due to the band structure of P, commonly chosen preconditioners such as the incomplete LU-factorization (ILU) cannot be expected to be efficient [\cite=che2005matrix]. It was shown that approximating P- 1 using an algebraic multigrid (AMG) method is preferrable with regard to performance [\cite=vor2016].

Besides preconditioning of the "outer iteration", a speed-up of the solver could also be achieved by reducing the accuracy with which the inner equation, Ax  =  y, is solved. This can be interpreted to be similar to inexact UZAWA-algorithms as they are proposed in the literature [\cite=elm1994inexact]. Since reducing the number of iterations for solving the inner equation did not result in an increase of the number of outer iterations, performing only one iteration led to the fastest solving speed, allowing to solve this equation system in less than two minutes for the finest used model segres [\cite=vor2016].

Methods

Implementation

this study, both the direct (i.e., h  =  hdirect  =  BA- 1b) and the projected (h  =  hproj  =  Bb) Mixed-FEM approach were implemented in the DUNE framework [\cite=dune08:1] [\cite=dune08:2] using the DUNE-PDELab toolbox [\cite=bastian2010generic]. In addition, a solver corresponding to a preconditioned conjugate UZAWA-algorithm was implemented using the CG-solver template from the DUNE module iterative solvers template library (DUNE-ISTL) in combination with the AMG preconditioner [\cite=bla2010parallel].

Evaluation

In order to evaluate the accuracy of the Mixed-FEM, different comparisons both in hexahedral four-layer sphere and realistic head models were performed. As it is common for the evaluation of EEG forward approaches, the error measures RDM (minimal error 0, maximal error 2) and lnMAG (minimal error 0, maximal error ±    ∞  ) were used [\cite=CHW:Mei89] [\cite=CHW:Gue2010].

[formula]

In the sphere models, the solution was evaluated on the whole outer boundary instead of using single electrode positions, so that the results are independent of the choice of the evaluation points. For the realistic head model the sensor positions of a realistic EEG cap were used [\cite=CHW:Vor2014] [\cite=vor2016].

Besides the two Mixed-FEM approaches, the Whitney CG-FEM was included in our sphere model comparisons as it relies on the same approximation of the dipole source [\cite=CHW:Pur2011] [\cite=bau2015comparison]. In this way, the differences between Mixed- and CG-FEM could be directly evaluated. Two four-layer hexahedral sphere models, segres and segres, with a mesh resolution of 1 and 2 mm, respectively, were generated (Tables [\ref=tab:4-layer-compartments], [\ref=tab:models]). Sources were placed at 10 different radii and for each radius 10 sources were randomly distributed to gain a statistical overview of the numerical accuracy. Since the numerical errors increase along with the eccentricity, i.e., the quotient of source radius and radius of the innermost compartment boundary, the radii of the source positions were chosen so that the distances to the next conductivity jump (brain/CSF boundary) were logarithmically distributed. The most exterior eccentricity 0.993 corresponds to a distance of only ≈   0.5 mm to the conductivity jump. In praxis (and for the realistic head model used in this study), sources are usually placed so that at least one layer of elements is between the source element and the conductivity jump, which is fulfilled for the considered eccentricities ≤  0.987 in the 1 mm model and the eccentricities ≤  0.964 in the 2 mm model. The reference solutions uref were computed using a quasi-analytical solution for sphere models [\cite=mun1993].

In the first study, for each model, the source positions were projected to the closest face center and the source directions were chosen according to the face normals, so that only one basis function contributes to the right-hand side. Thereby, the results are not influenced by the interpolation that is needed for arbitrary source directions and positions. For the Whitney approach it was shown that it has the highest accuracy of all CG-FEM approaches in this scenario [\cite=bau2015comparison]. Next, the three approaches were compared in the same models using the initially generated random source positions and radial source directions, so that neither position nor direction were adjusted to the mesh. We limit our investigations to radial sources, as eccentric radial sources were shown to lead to higher numerical errors than tangential sources in previous studies [\cite=CHW:Wol2007a]. Finally, the projected Mixed-FEM and Whitney CG-FEM were evaluated in combination with the models segresr82, segresr83, and segresr84 generated out of model segres but with an especially thin skull layer, again with random positions and radial source directions. Table [\ref=tab:leaks] indicates the outer skull radii of the different models and the thereby generated number of leakages, i.e., the number of nodes in which elements of skin and CSF compartment touch.

Mixed-FEM, CG-FEM, and also the recently proposed discontinuous Galerkin (DG)-FEM [\cite=eng2015subtraction] were evaluated in a more realistic scenario. As the Mixed-FEM, the DG-FEM is current preserving. Two realistic six-compartment hexahedral head models with mesh widths of 1 mm and 2 mm were created, resulting in 3,965,968 vertices and 3,871,029 elements and 508,412 vertices and 484,532 elements, respectively (Figure [\ref=fig:headmodel]). As the model with a mesh width of 2 mm was not corrected for leakages, 1,164 vertices belonging to both CSF and skin elements were found, which were mainly located at the temporal bone. The conductivities were chosen according to [\cite=CHW:Vor2014]. Out of 18,893 source positions placed in the gray matter with a normal constraint, those that were not fully contained in the gray matter compartment (i.e., where the source was placed in an element at a compartment boundary) were excluded. This resulted in 17,870 remaining source positions for the 1 mm model and 17,843 source positions for the 2 mm model. As sensor configuration an 80 channel realistic EEG cap was chosen. The investigated approaches were projected Mixed-FEM, Whitney CG-FEM, St. Venant CG-FEM [\cite=CHW:Buc97], and Partial Integration DG-FEM [\cite=vor2016] [\cite=eng2015subtraction]. St. Venant CG-FEM and Partial Integration DG-FEM are additionally used here, since they were shown to achieve the highest accuracies of the different CG- and DG-FEM approaches, respectively, when choosing arbitrary source directions and positions [\cite=eng2015subtraction] [\cite=bau2015comparison]. Solutions for all methods were computed in the 2 mm model, additionally also a solution in the 1 mm model was calculated using the St. Venant CG-FEM. In the realistic scenario, RDM and lnMAG were evaluated in comparison to a reference solution that was computed using the St. Venant method in a high-resolution tetrahedral model based on the same segmentation (2,242,186 vertices, 14,223,508 elements). For details of this model, please refer to [\cite=CHW:Vor2014] [\cite=vor2016].

Results

In this paper, a new finite element method to solve the EEG forward problem is introduced. It is expected that it should be preferrable compared to the commonly used CG-FEM approaches especially in leakage and realistic scenarios. The goal of Sections [\ref=sub:mfem-evaluation1] and [\ref=sub:mfem-evaluation2] is to show that this new method performs appropriately when compared to the established CG-FEM in common sphere models, while in Sections [\ref=sub:results-leaky] and [\ref=sub:realistic] the advantages in leakage and realistic scenarios are evaluated.

Comparison of Whitney CG-FEM and Mixed-FEM for optimal source positions

the three approaches with regard to the RDM in model segres (Figure [\ref=fig:radial-conv-mixed]), no remarkable differences are found up to an eccentricity of 0.964 (distance from next conductivity jump ≥  2.8 mm) with maximal errors below 0.05 for all approaches (Figure [\ref=fig:radial-conv-mixed], top row). At an eccentricity of 0.979 (dist. ≈  1.6 mm) the maximal errors for the Mixed-FEM slightly increase. However, the maximal errors remain clearly below 0.1. Also the Whitney CG-FEM has a maximal error below 0.1 here and also upper quartile and median are lower than for the Mixed-FEM. For the highest three eccentricities, the RDM clearly increases for all considered approaches. The variance especially for the highest eccentricities is lowest for projected Mixed-FEM and Whitney CG-FEM. In the coarser model segres, direct and projected Mixed-FEM perform similar up to eccentricities of 0.933 or 0.964 (dist. ≥  2.8 mm), while the errors for the Whitney CG-FEM are lower and have less variance. For higher eccentricities, a rating of the accuracies is hardly possible due to the higher variance.

With regard to the lnMAG (Figure [\ref=fig:radial-conv-mixed], bottom row), only minor differences are recognizable for model segres. In model segres, it is notable that the direct Mixed-FEM leads to very high maximal errors for eccentricities of 0.987, while Whitney CG-FEM and projected Mixed-FEM perform similar with a tendency of the Whitney CG-FEM towards lower errors.

Comparison of Whitney CG-FEM and Mixed-FEM for random source positions

The next comparison expands the previous results to random source positions and radial source orientations. When comparing the two Mixed-FEM approaches with regard to the RDM (Figure [\ref=fig:radial-geom-mixed], top row), for both models no major differences are found up to an eccentricity of 0.964 (dist. ≥  2.8 mm), while the Whitney CG-FEM leads to lower errors especially in model segres. For model segres, the RDM is constantly below 0.05 at low eccentricities (up to eccentricity ≤  0.964, i.e., dist. ≥  2.8 mm). With increasing eccentricity, the RDM for the projected Mixed-FEM and Whitney CG-FEM mainly remains below 0.1, while the maximal RDM is at nearly 0.3 for the direct approach and the median is above 0.1. Also in model segres, the projected approach outperforms the direct approach with regard to the RDM. The less accurate approximation of the geometry leads to higher errors in these models, e.g., the minimal RDM at an eccentricity of 0.964 (dist. ≥  2.8 mm) is already at nearly 0.1 for both approaches in model segres. The Whitney CG-FEM performs clearly better than both Mixed-FEM approaches in this model, with maximal errors below 0.13 at this eccentricity. For more eccentric sources, the projected approach, again, performs better than the direct approach. Nevertheless, the errors for the Whitney CG-FEM remain at a lower level.

The results for the lnMAG (Figure [\ref=fig:radial-geom-mixed], bottom row) do not show remarkable differences for all models up to an eccentricity of 0.964. In model segres, the projected Mixed-FEM leads to the lowest spread for the three highest eccentricities. However, the lnMAG decreases from positive values for all source positions at low eccentricities to completely negative values at the highest eccentricity. This effect is even stronger for the Whitney CG-FEM. In contrast, the median of the direct Mixed-FEM remains close to constant up to the highest eccentricity, however, with higher spread. The same behaviour of the three approaches, just at a generally higher error level is found for model segres.

Comparison of Mixed-FEM approaches in leaky sphere models

In Sections [\ref=sub:mfem-evaluation1] and [\ref=sub:mfem-evaluation2] we found that the projected Mixed-FEM is superior to the direct Mixed-FEM. To keep the presentation concise, we therefore from now on only compare the projected Mixed-FEM with the Whitney CG-FEM. The results in model segresr84 (Table [\ref=tab:leaks]), which does not contain any skull leakages yet, mainly resemble those in model segres for both RDM and lnMAG (Figure [\ref=fig:radial-leak-mixed]).

In models segresr82 and segresr83 the effects of the leakages become apparent. With regard to the RDM (Figure [\ref=fig:radial-leak-mixed], top row), the projected Mixed-FEM leads to lower errors in both models. In model segresr83, the differences between the two approaches are still moderate. However, especially up to an eccentricity of 0.964 (dist. ≥  2.8 mm) a higher accuracy for the projected Mixed-FEM is clearly observable. The increased number of leakages in segresr82 intensifies the difference between the approaches. The errors for the Whitney CG-FEM are clearly higher than for the Mixed-FEM here, with maximal errors larger than 0.5 at eccentricities above 0.964 (dist. ≤  1.6 mm).

Also with regard to the lnMAG (Figure [\ref=fig:radial-leak-mixed], bottom row), the influence of the skull leakages is apparent. In models segresr82 and segresr83, the lnMAG increases up to an eccentricity of 0.964, and only decreases for higher eccentricities. This effect is clearly stronger for the Whitney CG-FEM than for the Mixed-FEM. In contrast, the lnMAG for the Whitney CG-FEM decreases clearly stronger than for the Mixed-FEM in model segresr84 with increasing eccentricity, leading to a switch from about 0.2 for eccentricities below 0.964 to values lower than 0.2 at an eccentricity of 0.993. Especially in model segresr83 the Whitney CG-FEM also leads to a higher variance of the lnMAG, while this is less distinct in the other models.

For a single, exemplary dipole the distribution of the volume currents in skull and skin in model segresr82 simulated with the Whitney CG- and projected Mixed-FEM is visualized in Figure [\ref=fig:current]. The leakage effect for the CG-FEM (Figure [\ref=fig:current], left) is obvious. While the Mixed-FEM (Figure [\ref=fig:current], right) leads to a smooth current distribution and highest current strengths in the skull compartment (up to ≈  13 μA/mm2), the current strength peaks in the skin compartment for the Whitney CG-FEM (maximum ≈  144 μA/mm2) and the value is increased by a factor of more than 11 compared to the Mixed-FEM (note the different scaling of the colorbars). In comparison, the current strength in the skull is very low here, showing the leakage of the volume currents through the nodes shared between CSF and skin.

Realistic Head Model Study

The cumulative relative frequencies of RDM and lnMAG are displayed in Figure [\ref=fig:mixed-pi-6-realistic]. Due to the rough approximation of the smooth surfaces, all models consisting of regular hexahedra (especially at the mesh width of 2 mm) lead to relatively high topography and magnitude errors when compared to the surface-based tetrahedral reference model. Comparing the results in the 2 mm model with regard to the RDM (Figure [\ref=fig:mixed-pi-6-realistic], top), the projected Mixed-FEM performs best with roughly 95% of the errors below 0.31. Thereby, the result is nearly as good as that achieved with the St. Venant approach in the 1 mm model, where 95% of the errors are below 0.28. The partial integration DG-FEM performs nearly equally well to the Mixed-FEM with 95% of the errors reached at about 0.36. Whitney and St. Venant CG-FEM perform nearly identical and this mark is reached at an RDM of nearly 0.4.

With regard to the lnMAG, the differences between the results obtained using the mesh resolutions of 1 and 2 mm and also between Mixed-, DG- and the two CG-FEM approaches are larger than for the RDM (Figure [\ref=fig:mixed-pi-6-realistic], bottom). The projected Mixed-FEM performs best when using the 2 mm model, with 90% of the errors in the range from -0.15 and 0.35. The partial integration DG-FEM performs only slightly worse with 90% of the errors in the range from -0.15 and 0.4. Again, Whitney and St. Venant CG-FEM lead to nearly identical accuracies and show the highest errors for the 2 mm model, both with regard to absolute values and spread (90% of the errors in the range from -0.1 to 0.54). The increase in accuracy when using a mesh resolution of 1 mm is clearer for the lnMAG than for the RDM, as for the St. Venant CG-FEM 90% of the lnMAG-errors are in the range from -0.2 to 0.25, thus showing both a smaller spread than the results in the 2 mm model and also lower absolute values.

Discussion and Conclusion

study introduced the Mixed-FEM approach for the EEG forward problem. Two approaches to model the dipole source were derived, the direct and the projected approach. Numerical results for sphere and realistic head models were presented and compared to different established numerical methods.

The results suggest that the Mixed-FEM achieves an appropriate accuracy for common sphere models, especially the projected approach. The comparison with the Whitney CG-FEM approach with optimized positions and orientations shows that the Mixed-FEM leads to comparable accuracies (Figure [\ref=fig:radial-conv-mixed]). Both for optimized and arbitrary source positions, the projected approach achieved a superior accuracy compared to the direct approach. Previous publications concentrated on evaluating the Whitney CG-FEM in tetrahedral models [\cite=bau2015comparison]. In these studies, the accuracy of the Whitney approach deteriorated when using arbitrary source positions and orientations, most possibly due to interpolation. This effect is not found in the hexahedral models used here and a high accuracy is achieved (Figure [\ref=fig:radial-conv-mixed]). These results should be deeper investigated in further studies. In the leaky models segresr82, and segresr83 the Mixed-FEM performs better than the Whitney CG-FEM (Figure [\ref=fig:radial-leak-mixed]). This is an expected result, since the Mixed-FEM is by construction charge preserving, which should prevent current leakages [\cite=ewi1999superconvergence].

For EEG forward modeling, the Mixed-FEM shares this current preserving property with the recently proposed DG-FEM [\cite=eng2015subtraction]. Both approaches were evaluated against CG-FEM approaches in the realistic six-compartment head model. In this head model, both Mixed- and DG-FEM were advantageous in comparison to the CG-FEM (Figure [\ref=fig:mixed-pi-6-realistic]). The projected Mixed-FEM clearly outperforms both Whitney and St. Venant CG-FEM in this model and achieves a slightly higher accuracy than the partial integration DG-FEM. Since only few skull leakages occured in this model and as these were concentrated in the area of the temporal bone, leakage effects do not suffice to explain the higher accuracy of Mixed- and DG-FEM. An overall higher accuracy of these approaches in this kind of model, i.e., regular hexahedral with a mesh resolution of 2 mm, can be assumed. The relatively high level of errors is a consequence of the coarse regular hexahedral meshes that were used, while the reference solution was computed in a highly-resolved tetrahedral model. The result for the St. Venant CG-FEM in the 1 mm model helps to estimate the relation between the influence of the different numerical approaches and the accuracy of the approximation of the geometry. It is shown that the difference between projected Mixed-FEM and Whitney and Venant CG-FEM in the 2 mm model is nearly as big as the difference between using the 1 mm and the 2 mm model for the Venant CG-FEM.

Realizing this directly leads to the three main sources of error that exist in these evaluations - besides the already discussed leakage effects, these are inaccurate representation of the geometry and numerical inaccuracies. A major source of error is the representation of the geometry. Since regular hexahedral meshes were used here, the influence of geometry errors is significant, especially for coarse meshes with resolutions of 2 mm or higher. No explicit convergence study comparing the results in models with increasing mesh resolution but a constant representation of the geometry was performed. Though, it can be assumed from the results of further studies that the geometry error dominates the numerical errors due to lower mesh resolutions [\cite=eng2015subtraction] [\cite=vor2016].

In order to reduce the geometry error, the use of geometry-adapted meshes was considered for the CG-FEM and it was shown in a variety of studies that this already clearly improves the representation of the geometry [\cite=CHW:Cam97] [\cite=CHW:Wol2007a] [\cite=CHW:Vor2011]. However, while the use of non-degenerated parallelepipeds is uncritical for the Mixed-FEM, "some complications may arise for general elements" [\cite=bre2012mixed]. At least for the two-dimensional case, error estimates for general quadrilateral grids can be obtained when modifying the lowest-order Raviart-Thomas elements [\cite=cho2002flux] [\cite=kwa2011mixed] and for convex quadrilaterals even superconvergence could be shown [\cite=ewi1999superconvergence]. The use of geometry-adapted hexahedral meshes in combination with the Mixed-FEM should therefore be evaluated in future studies.

Regarding the numerical inaccuracy due to the discretization of the equations and the source singularity, the Mixed-FEM allows one to increase the regularity of the right-hand side by one degree, since by the splitting into two first order PDEs in [\eqref=eq:mixed-weak] applying the derivative to the delta distribution included in the primary current [formula] can be circumvented. The obtained results show high numerical accuracies, especially at highest eccentricities, and particularly for the projected Mixed-FEM. This comes at the cost of a higher number of degrees of freedom than for the CG-FEM, as also the current [formula] is considered as an unknown now, meaning that it has to be discretized. Furthermore, the discrete problem has saddle point structure [\eqref=eq:mixed-disc] and can no longer be efficiently solved with the previously used AMG-CG solvers. Although the number of unknowns is clearly increased compared to the CG-FEM, e.g., in model segres we have [formula], and [formula] (cf. Table [\ref=tab:models]), by introducing a conjugated UZAWA-algorithm with proper preconditioning, the solving time even in the finest model segres was reduced to less than two minutes. This is only few seconds slower than for the CG-FEM. Furthermore, as the equation system [\eqref=eq:mixed-disc] is symmetric, the transfer matrix approach [\cite=CHW:Wei2000] [\cite=CHW:Wol2004] can be applied for the Mixed-FEM to reduce the number of equation systems that has to be solved to the number of sensors.

As mentioned, the Mixed-FEM guarantees the conservation of charge by construction and especially in models with thin insulating compartments and at highest eccentricities it still leads to high accuracies. These results encourage the use of the Mixed-FEM also in related applications that depend on an accurate simulation of the electric current, such as the magnetoencephalography (MEG) forward problem, transcranial direct current stimulation (tDCS), or deep brain stimulation (DBS) simulations.

Overall, the presented Mixed-FEM is an interesting new approach that can at least complement and in some scenarios even outperform standard continuous Galerkin FEM approaches for simulation studies in bioelectromagnetism.