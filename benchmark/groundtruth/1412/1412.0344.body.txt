Lemma Corollary Claim Problem Question

(1,k)-coloring of graphs with girth at least 5 on a surface

Ilkyoo Choi*

Jisu Jeong* Geewon Suh*

Introduction

Only finite, simple graphs are considered. Given a graph G, let V(G) and E(G) denote the vertex set and the edge set of G, respectively. A neighbor of a vertex v is a vertex adjacent to v, and let N(v) denote the set of neighbors of v. The degree of a vertex v, denoted d(v), is |N(v)|. The degree of a face f, denoted d(f), is the length of a shortest boundary walk of f. A k-vertex, k+-vertex, k--vertex is a vertex of degree k, at least k, at most k, respectively. A k-face is a face of degree k.

Given a graph G, the chromatic number is the minimum k such that the vertex set V(G) can be partitioned into k parts so that each part induces a graph with maximum degree at most 0. Maybe we can allow some non-zero maximum degree in each color class and obtain a partition with fewer parts than the chromatic number; this notion is known as improper coloring, and has been widely studied recently. To be precise, a graph is [formula]-colorable if its vertex set can be partitioned into r sets [formula] so that the maximum degree of the graph induced by Vi is at most di for each [formula]; in other words, there exists a function [formula] where the graph induced by vertices of color i has maximum degree at most di for [formula].

There are many papers that study [formula]-colorings of sparse graphs resulting in corollaries regarding planar graphs, often with restrictions on the girth. The well-known Four Color Theorem [\cite=1977ApHa] [\cite=1977ApHaKo] is exactly the statement that planar graphs are (0,0,0,0)-colorable. Cowen, Cowen, and Woodall [\cite=1986CoCoWo] proved that planar graphs are (2,2,2)-colorable, and Eaton and Hull [\cite=1999EaHu] and Skrekovski [\cite=1999Sk] proved that this is sharp by exhibiting a non-(1,k,k)-colorable planar graph for each k. Thus, the problem of improper coloring planar graphs with at least three parts is completely solved.

Naturally, the next line of research is to consider improper colorings of planar graphs with two parts. The following two questions are attracting much interest.

Given a pair (d1,d2), determine the minimum g = g(d1,d2) such that every planar graph with girth g is (d1,d2)-colorable.

Given a pair (g,d1), determine the minimum d2 = d2(g;d1) such that every planar graph with girth g is (d1,d2)-colorable.

Regarding Problem [\ref=problem-girth], the special case when d1 = d2 was first considered by Cowen, Cowen, and Woodall [\cite=1986CoCoWo], who constructed a planar graph that is not (d,d)-colorable for each d. This shows that g(d,d)  ≥  4 for all d, and instigated the girth constraint for future research in this area. Skrekovski [\cite=1999Sk] [\cite=2000Sk] continued the study and obtained some bounds on g(d,d), which were improved by Havet and Sereni [\cite=2006HaSe] and Borodin, Kostochka, and Yancey [\cite=2013BoKoYa]; the current best known bounds are 6  ≤  g(1,1)  ≤  7 and 5  ≤  g(3,3)  ≤  g(2,2)  ≤  6 and g(d,d) = 5 for d  ≥  4. Note that since g(d1 + 1,d2 + 1)  ≤  g(d1,d2 + 1)  ≤  g(d1,d2), we know that g(d1,d2) = 5 whenever d1,d2  ≥  4.

Values of g(d1,d2) that are determined when min {d1,d2}  ≤  3 are g(0,d2) = 7 when d2  ≥  4 by Borodin and Kostochka [\cite=2014BoKo] and Borodin, Ivanova, Montassier, Ochem, and Raspaud [\cite=2010BoIvMoOcRa], g(2,d2) = 5 when d2  ≥  6 by Havet and Sereni [\cite=2006HaSe] and Skrekovski [\cite=2000Sk], and g(3,d2) = 5 when d2  ≥  5, proved by Choi and Raspaud [\cite=unpub_ChRa] and Skrekovski [\cite=2000Sk].

To our knowledge, the exact value of g(1,d2) were not known for any value of d2 before this paper. Our main result (Theorem [\ref=thm-main]) determines infinitely many values of g(1,d2); namely, our main result implies that g(1,d2) = 5 when d2  ≥  10. These facts are summerized in the following theorem.

If g(d1,d2) is the minimum g where every planar graph with girth g is (d1,d2)-colorable, then

g(0,d2) = 7 for d2  ≥  4,

g(1,d2) = 5 for d2  ≥  10,

g(2,d2) = 5 for d2  ≥  6,

g(3,d2) = 5 for d2  ≥  5,

g(d1,d2) = 5 for d1,d2  ≥  4.

None of the thresholds on d2 in the previous theorem are known to be tight. There has been substantial effort in trying to find the exact value of g(0,1) by various authors [\cite=2007GlZa] [\cite=2009BoIv] [\cite=2011BoKo] [\cite=2013EsMoOcPi] [\cite=unpub_KiKoZh], and the current best bound is 10  ≤  g(0,1)  ≤  11 by Kim, Kostochka, and Zhu [\cite=unpub_KiKoZh] and Esperet, Montassier, Ochem, and Pinlou [\cite=2013EsMoOcPi]. Interestingly, it is known that g(0,2) = 8, proved by Montassier and Ochem [\cite=unpub_MoOc] and Borodin and Kostochka [\cite=2014BoKo].

Regarding Problem [\ref=problem-d2], we know that d2(g;d1) is not finite when either g∈{3,4} by Montassier and Ochem [\cite=unpub_MoOc] or d1 = 0 and g  ≤  6 by Borodin, Ivanova, Montassier, Ochem, and Raspaud [\cite=2010BoIvMoOcRa]. Various authors [\cite=2010BoIvMoOcRa] [\cite=2014BoKo] [\cite=2013BoKoYa] [\cite=2012BoIvMoRa] [\cite=2006HaSe] [\cite=2011BoIvMoRa] [\cite=unpub_MoOc] conducted research on trying to find the exact value of d2(g;d1) for various pairs (g,d1). See Table [\ref=table] for the current best known bounds. Improving any value in the table would be a noteworthy result.

The finiteness of d2(g;d1) was known for all pairs (g,d1), except when (g,d1) = (5,1). This case was an open question that was explicitly asked in Montassier and Ochem [\cite=unpub_MoOc] and was also mentioned in Choi and Raspaud [\cite=unpub_ChRa].

Does there exist a finite k where planar graphs with girth at least 5 are (1,k)-colorable?

We answer Question [\ref=question] in the affirmative by proving that d2(5;1)  ≤  10. This finishes the long journey of characterizing all pairs (g,d1) where d2(g;d1) is finite. Moreover, our proof easily extends to the statement that for any surface S of Euler genus γ, there exists a K = K(γ) where graphs with girth at least 5 that are embeddable on S are (1,K)-colorable. This is best possible in the sense that it was already known that there is no finite k where planar graphs with girth at least 5 are (0,k)-colorable [\cite=2010BoIvMoOcRa]. The following is the precise statement of our main results.

Projective planar graphs with girth at least 5 are (1,10)-colorable.

Planar graphs with girth at least 5 are (1,10)-colorable.

Given a surface S of Euler genus γ, every graph with girth at least 5 that is embeddable on S is [formula]-colorable where K(γ) =  max {10,4γ + 3}.

In Section [\ref=section-lemmas], we will reveal some structure of minimum counterexamples to Theorem [\ref=thm-main]. We use discharging, and the discharging rules are laid out in Section [\ref=section-discharging]. Finally, we finish the proof of Theorem [\ref=thm-main] and explain how the proof extends to the proof of Theorem [\ref=thm-gen] in Section [\ref=section-proof]. The ideas of the lemmas used in the proof of Theorem [\ref=thm-gen] are in Section [\ref=section-lemmas], yet, in order to improve the readability of the paper, we will not explicitly rewrite all the lemmas for the case γ  ≥  2 as they do not add more value.

From now on, assume a graph G is a counterexample to Theorem [\ref=thm-main] with the minimum number of vertices, and fix some embedding of G. Note that G is connected and the minimum degree of G is at least 2. We will also assume that for a (partial) (d1,d2)-coloring φ of G, the two colors will be d1,d2 and the graph induced by the color i has maximum degree at most i for i∈{d1,d2}.

In the figures throughout this paper, the white vertices do not have incident edges besides the ones drawn, and the black vertices may have other incident edges.

Structural Lemmas of G

In this section, we will reveal some structural aspects of G. A 12+-vertex is high and a 4--vertex is low. A vertex of degree 6 to 11 is a medium vertex. Given a (partial) coloring φ:V(G)  →  {1,10} of G, a vertex v is i-saturated if φ(v) = i and v is adjacent to i neighbors colored i. Note that by definition, an i-saturated vertex has at least i neighbors.

Let v be a 2-vertex of G where N(v) = {v1,v2} and d(v1)  ≤  11. If φ is a (1,10)-coloring of G - v, then φ(v1) = 1 and φ(v2) = 10.

If φ(v1) = φ(v2), then letting [formula] gives a (1,10)-coloring of G, which is a contradiction. If v1 is 10-saturated and φ(v2) = 1, then recolor v1 with 1; this is possible since d(v1)  ≤  11. Now let φ(v) = 10 to obtain a (1,10)-coloring of G, which is again a contradiction. If v1 is not 10-saturated and φ(v2) = 1, then let φ(v) = 10 to obtain a (1,10)-coloring of G. Thus, φ(v2) = 10 and φ(v2) = 1.

If v is an 11--vertex of G, then v is adjacent to at least one 12+-vertex.

Suppose that every neighbor of v has degree at most 11. Since G is a counterexample with the minimum number of vertices, G - v has a (1,10)-coloring with two colors 1 and 10. There must exist a neighbor of v that is colored with 1, otherwise we can color v by 1 to obtain a (1,10)-coloring of G, which is a contradiction. Since each neighbor of v has degree at most 11, we can recolor each 10-saturated neighbor of v with the color 1. Now we can color v with the color 10 since v has no 10-saturated neighbor and v has at most ten neighbors colored with 10. This is a (1,10)-coloring of G, which is a contradiction.

There are no 2-vertices adjacent to each other in G.

Assume two 2-vertices u,v are adjacent to each other and N(u) = {v,u'} and N(v) = {u,v'}. Since G is a counterexample with the minimum number of vertices, [formula] has a (1,10)-coloring φ with two colors 1 and 10. If φ(u') = φ(v'), then by letting [formula] we obtain a (1,10)-coloring of G, which is a contradiction. Otherwise, by letting [formula] and [formula], we obtain a (1,10)-coloring of G, which is also a contradiction.

Given a vertex v on a face f, the f-external neighbors of v are the neighbors of v that are not on f. A 5-face is special if the degrees of the vertices are 2,12+,2,5,3 is some cyclic order. Note that by Lemma [\ref=vx-degree], the f-external neighbor of a 3-vertex on a special face f must be high.

A vertex v of degree 5 in G is incident to at most two special faces.

Let [formula] be the neighbors of v in some cyclic order. Without loss of generality, assume v5 is a high neighbor of v, which is guaranteed by Lemma [\ref=vx-degree]. This implies that the two faces incident to an edge vv5 cannot be special faces, by the cyclic ordering of the vertices on a special face. Suppose that v is incident to three special faces, and let f be the face incident to v3v and vv2. Without loss of generality assume v2 and v3 are a 2-vertex and a 3-vertex, respectively. By Lemma [\ref=vx-degree], the f-external neighbor of v3 must be high. Yet, the face incident to vv3 that is not f cannot be a special face by the cyclic ordering of the vertices of a special face, which is a contradiction.

A 5-face f is an X1-face if the degrees of the vertices are 2,12+,2,12+,3 in some cyclic order and the f-external neighbor of the 3-vertex on f is not high. A 5-face f is an X2-face if the degrees of the vertices are 2,12+,2,12+,4 in some cyclic order and the degrees of the neighbors of the 4-vertex on f are 11-,2,12+,2+ in some cyclic order. A 5-face f is a Y1-face if the degrees of the vertices are 2,12+,2,4,3 in some cyclic order, the degrees of the neighbors of the 4-vertex on f are 2,3,11-,12+ is some cyclic order, and the faces incident to the two 2-vertices on f that are not f are an X1-face and an X2-face. A 5-face f is a Y2-face if the degrees of the vertices are 2,12+,2,3,3 in some cyclic order, and the faces incident to the two 2-vertices on f that are not f are both X1-faces. See Figure [\ref=fig-defs-faces].

A bad face is a Y1-face or a Y2-face. A 5-face f is a terrible face if the degrees of the vertices are 2,12+,2,4,4 in some cyclic order, the degrees of the neighbors of both 4-vertices on f are 2,4,11-,12+ is some cyclic order, and the faces incident to the two 2-vertices on f that are not f are both X2-faces.

A 12+-vertex v of G has at most [formula] incident terrible faces.

By the configuration of a terrible face, no two terrible faces can share an X2-face. Thus, v has at most [formula] incident terrible faces.

Suppose v has at least d(v) - 11 incident terrible faces. We will show this implies in some partial coloring φ of G, v has one uncolored neighbor, ten neighbors colored with 10, and at least d(v) - 10 neighbors colored with 1. This contradicts the degree of v.

Let [formula] be the neighbors of v is some cyclic order and for each 2-vertex vi, let N(vi) = {ui,v} for [formula]. From now on, the addition of the indicies of vertices will be modulo d(v). Also, for a given terrible face uivivvi + 1ui + 1 and j∈{i,i + 1}, let N(uj) = {vj,uj - 1,uj + 1,wj}. Without loss of generality assume u4v4vv5u5 is a terrible face incident to v where the face incident to v1,v,v2 is not a terrible face. Note that such a configuration exists since 3(d(v) - 11) = d(v) cannot be satisfied.

Since G is a minimum counterexample, G - v4 has a (1,10)-coloring φ, and by Lemma [\ref=partial-coloring], φ(u4) = 1 and φ(v) = 10. If φ(u3) = 1, then φ(w4) = φ(u5) = 10. If w4 is 10-saturated, then recolor w4 with 1, which is possible since d(w4)  ≤  11. Now letting φ(v4) = 1 and recoloring u4 with 10 gives a (1,10)-coloring of G, which is a contradiction. Thus φ(u3) = 10, which implies that φ(v3) = 1 since otherwise letting φ(v4) = 10 and recoloring v3 with 1 gives a (1,10)-coloring of G, which is a contradiction.

Similarly, for a terrible face uivivvi + 1ui + 1, if φ(ui - 1) = 10, then φ(vi - 1) = 1, since otherwise letting φ(v4) = 10 and recoloring vi - 1 with 1 gives a (1,10)-coloring of G, which is a contradiction. Suppose φ(ui - 1) = 1 and φ(vi) = 10. Then letting φ(v4) = 10 and recoloring vi with 1 must not give a (1,10)-coloring of G, so φ(ui) = 1. Now if wi is 10-saturated, then recolor it with 1, which is possible since d(wi)  ≤  11. Now letting φ(v4) = 10 and recoloring vi and ui with 1 and 10, respectively gives a (1,10)-coloring of G, which is a contradiction. Thus, if φ(ui - 1) = 1, then φ(vi) = 1. That is, for every terrible face uivivvi + 1ui + 1, at least one of φ(vi - 1) and φ(vi) is 1.

Now consider a terrible face ujvjvvj + 1uj + 1 that is incident to v with the highest index j. Since uj + 2  ≠  u3, by the above logic, either φ(vj + 1) = 1 (if φ(uj + 2) = 1) or φ(vj + 2) = 1 (if φ(uj + 2) = 10). This implies that at least two of vj - 1,vj,vj + 1,vj + 2 are colored with 1.

Since there are at least d(v) - 11 terrible faces incident to v and none of the vertices that we verified to be colored with 1 can be counted twice, v has at least d(v) - 10 neighbors colored with 1. Since coloring v4 with 10 must not give a (1,10)-coloring of G, we know that v is 10-saturated, which implies that v has ten neighbors colored with 10. Since v4 is uncolored, we showed that v has at least d(v) - 10 + 10 + 1 = d(v) + 1 neighbors, which is a contradiction.

A 12+-vertex v of G has at most [formula] incident bad faces.

Follows from Lemma [\ref=terrible-faces-num], since each bad face is a subgraph of a terrible face.

A face f1 is a (d2,d3)-sponsor of an adjacent face f2 if f1 and f2 share the edge u2u3 where d(u2) = d2,d(u3) = d3 and u1,u2,u3,u4 are consecutive vertices of f1 where u1,u4 are high vertices. A face that is not an X1-face is a sponsor of another face if both u2,u3 are low vertices. See Figure [\ref=fig-sponsor].

Discharging Procedure

Since the embedding of G is fixed, we can let F(G) denote the set of faces of this embedding. In this section, we will prove that G cannot exist by assigning an initial charge μ(z) to each [formula], and then applying a discharging procedure to end up with final charge μ*(z) at z. We prove that the final charge sum is greater 6γ - 12, whereas the initial charge sum is equal to 6γ - 12. The discharging procedure will preserve the sum of the initial charge, and hence we find a contradiction to conclude that the counterexample G does not exist.

For each vertex v∈V(G), let μ(v) = 2d(v) - 6, and for each face f∈F(G), let μ(f) = d(f) - 6. The initial charge sum is 6γ - 12, since

[formula]

The last inequality holds by Euler's formula.

Discharging Rules

The discharging rules (R1)-(R4) indicate how the vertices distribute their initial charge to incident faces. Rule (R5) is the only rule where a face sends charge to a vertex, and rules (R6)-(R8) instruct faces on how to send and receive charge between faces.

Here are the discharging rules:

Each 4-vertex sends charge [formula] to each incident face.

Each 5-vertex v sends charge [formula] to each incident special face and charge 1 to each other incident face where a high neighbor of v is not incident to f.

Each medium vertex v distributes its initial charge uniformly to each incident face f where a high neighbor of v is not incident to f.

Each high vertex sends charge 2 to each incident bad face and sends charge [formula] to each other incident face.

Each face sends charge 1 to each incident 2-vertex.

Each face f1 sends charge 1 to each face f2 where f1 is a (3,3)-, (3,4)-, (4,3)-, or (4,4)-sponsor of f2.

Each face f1 that is not an X1-face sends charge [formula] to each face f2 where f1 is a (2,3)- or (3,2)-sponsor of f2.

Assume f1 is a (2,4)- or (4,2)-sponsor of f2.

If f1 is an X2-face, then f1 sends charge [formula] to f2.

If f1 is not an X2-face, then f1 sends charge 1 to f2.

Here is a list of facts to keep in mind:

A medium vertex v will send charge either 0 or at least [formula] to each incident face by (R3), since v must have a high neighbor by Lemma [\ref=vx-degree].

A high vertex will send charge at least [formula] to each incident face by (R4).

If (R7) or (R8) happens, then (R5) must happen as well.

A face f will spend charge at most [formula] each time f is a sponsor, except for when (R8B) applies; in this case, f receives charge [formula] from the 4-vertex on f, so the net charge sent is still [formula].

Since (R7) and (R8) include instances of (R5), we will say that an instance of (R5) is independent if it is not part of an instance of (R7) and (R8).

Claims

We will first show that each vertex has nonnegative final charge. Then, we will show that each face has nonnegative final charge.

Each vertex v has nonnegative final charge.

If v is a 19+-vertex, then by Lemma [\ref=bad-faces-num], [formula]. If 12  ≤  d(v)  ≤  18, then by Lemma [\ref=bad-faces-num], [formula]. If v is a medium vertex, then by (R3), the final charge is nonnegative since v only distributes its initial charge. If v is a 5-vertex, then by Lemma [\ref=special-faces-num], [formula]. If v is a 4-vertex, then [formula]. If v is a 3-vertex, then v neither sends nor receives any charge, so μ*(v) = μ(v) = 2  ·  3 - 6 = 0. If v is a 2-vertex, then by (R5), v receives charge 1 from each of its incident faces, so μ*(v) = 2  ·  2 - 6 + 2  ·  1 = 0.

Each face f of degree at least 7 has positive final charge.

If f sends charge by (R6), (R7), or (R8A), f receives charge [formula] and sends charge at most [formula] for each instance. If f sends charge by (R8B), f receives charge [formula] and sends charge at most 1 + 1 for each instance. In either case, f can use half of the charge it receives from the high vertices (not the 4-vertex when f is a (2,4)- or (4,2)-sponsor) to take care of each instance of (R6)-(R8).

For each independent instance of (R5), one of the two neighbors of the 2-vertex must be high by Lemma [\ref=vx-degree], so f receives charge at least [formula]. Since f may only use half of this [formula] to this instance, f may need an additional [formula] charge, which can be provided by the initial face charge of f. By Lemma [\ref=no-22], there are at most [formula] 2-vertices incident with f. If [formula] is satisfied, then we have μ*(f) > 0, since f may need an additional [formula] charge for each instance of (R5). If d(f)  ≥  7, then the aforementioned equation is satisfied.

Each 6-face f has nonnegative final charge.

Assume f sends charge by (R6)-(R8), which implies that f has at least two high vertices. If (R6)-(R8) applies to f twice, then [formula]. If (R6)-(R8) applies to f once, then there is at most one independent instance of (R5). Thus, [formula].

Now assume f does not send charge by (R6)-(R8). If f has three 2-vertices, then f must have at least two high vertices by Lemma [\ref=no-22]. Thus, [formula]. If f has one 2-vertex, then f must have at least one high vertex by Lemma [\ref=no-22]. Thus, [formula].

Assume f has exactly two 2-vertices. If f has two 2-vertices and at least two high vertices, then, [formula]. Since f has a 2-vertex, f must have one high vertex v. Without loss of generality, assume v,u1,u2,u3,u4,u5 are vertices of f in cyclic order so that u1,u5 are 2-vertices. If u2,u3,u4 are not all 3-vertices, then [formula]. Otherwise, d(u2) = d(u3) = d(u4) = 3. The f-external neighbors of u2,u3,u4 must be high by Lemma [\ref=vx-degree], and therefore f will receive charge at least 1 by (R6). Thus, [formula].

The only remaining case is when f has no 2-vertices, which implies that no rules from (R5)-(R8) apply and so f does not send any charge. Thus, μ*(f)  ≥  μ(f) = 6 - 6 = 0.

Each 5-face f has nonnegative final charge.

Let [formula] be the vertices of f in some cyclic order. Note that μ(f) =  - 1.

Assume f sends charge to another face by (R6)-(R8), which implies that f has two high vertices; without loss of generality assume v1 and v4 are the high vertices, which each sends charge at least [formula] to f by (R4). Note that f is not an X1-face, which is not a sponsor of another face by definition. If v5 is not a 2-vertex, then [formula], since the net charge f spends by (R6)-(R8) is at most [formula]. Therefore we may assume v5 is a 2-vertex. If f sends charge to another face by (R6) or (R8A), then [formula].

If f sends charge to another face f' by (R7), then f must be either a (2,3)-sponsor or a (3,2)-sponsor. Without loss of generality assume v2 is the 3-vertex on f and let u be the f-external neighbor of v2. Since f is not an X1-face, u must be high. This implies that f' cannot be an X1-face since v1 is high, so f' will also send charge [formula] to f as well. Thus, [formula].

If f sends charge to another face f' by (R8B), then f is not an X2-face. Without loss of generality assume v2 is the 4-vertex on f and let u be the f-external neighbor of v2 on f'. Now u must be a high vertex otherwise f becomes an X2-face, which implies that f' is either a (2,4)-sponsor or a (4,2)-sponsor of f as well. Thus, [formula].

Now assume f is not a sponsor of another face.

Assume f is incident to no 2-vertices. If f is incident to a high vertex, then [formula]. If f is incident to a 5+-vertex and no high vertex, then μ*(f)  ≥  1 - 1 = 0. If f is incident to at least two 4-vertices, then [formula]. Otherwise, f has two consecutive 3-vertices, and their f-external neighbors must be both high. Thus, μ*(f)  ≥   - 1 + 1 = 0, since f will receive charge 1 by (R6).

It is easy to see that the number of 2-vertices on f is at most 2. Assume f is incident to exactly one 2-vertex v2 and without loss of generality assume v1 is a high vertex, which exists by Lemma [\ref=vx-degree]. If f is incident to two high vertices, then [formula]. Otherwise f is incident to exactly one high vertex. If either v3 or v4 is a 4+-vertex, then [formula]. If both v3 and v4 are 3-vertices, then their f-external neighbors must be both high. Thus, [formula], since f will receive charge 1 by (R6).

Now assume f is incident to exactly two 2-vertices. If f is also incident to at least two high vertices, then [formula]. Since a 2-vertex must be adjacent to a high vertex by Lemma [\ref=vx-degree], we may assume that v1 and v3 are the 2-vertices and v2 is the only high vertex on f. If either v4 or v5 is a 6+-vertex, then [formula]. We may assume d(v4)  ≤  d(v5). If v5 is a 5-vertex and v4 is a 4+-vertex, then [formula]. If v5 is a 5-vertex and v4 is a 3-vertex, then f is a special face and [formula], since v5 now sends charge [formula] to f by (R2). If v5 and v4 are 4-vertices, then [formula], since at least one adjacent face to f will be a sponsor for f.

If v5 is a 4-vertex and v4 is a 3-vertex, then the f-external neighbor of v4 must be high by Lemma [\ref=vx-degree]. If f is a bad face, then [formula], since v2 now sends charge 2 to f by (R4) and f receives charge [formula] by (R8A). If f is not a bad face, then either the face incident to v1 that is not f is not an X2-face or the face incident to v3 that is not f is not an X1-face. If the f-external neighbor of v5 that is on the same face as the edge v4v5 is high, then [formula], since f will receive charge 1 by (R6). Otherwise, either [formula], since f will receive charge [formula], [formula] by (R7), (R8A), respectively, or [formula], since f will receive charge 1 by (R8B). See Figure [\ref=fig-helper].

If v5 and v4 are both 3-vertices, then the f-external neighbors of v5 and v4 must be high by Lemma [\ref=vx-degree]. If f is a bad face, then μ*(f)  ≥  2 - 1 - 2  ·  1 + 1 = 0, since v2 now sends charge 2 to f by (R4) and f will receive charge 1 by (R6). If f is not a bad face, then the face incident to either v1 or v3 that is not f is not an X1-face. Thus, [formula], since f will receive charge 1, [formula] by (R6), (R7), respectively.

Proofs of Theorems

We finish the paper by proving Theorem [\ref=thm-gen], which implies Theorem [\ref=thm-main] and Corollary [\ref=cor-planar]. Note that the lemmas used in Section [\ref=section-lemmas] are specifically for γ  ≤  1. However, in order to improve the readability of the paper, we did not explicitly rewrite all the lemmas for when γ  ≥  2 as the ideas are identical and adds no extra value. We restate the generalized version of Lemma [\ref=vx-degree] and Lemma [\ref=no-22] in order to prove Lemma [\ref=vx-high-general], which is used in the proof of Theorem [\ref=thm-gen].

Let H be a graph with girth at least 5 that is not (1,t)-colorable but every proper subgraph of H is (1,t)-colorable.

If v is a (t + 1)--vertex of H, then v is adjacent to at least one (t + 2)+-vertex.

There are no 2-vertices adjacent to each other in H.

The minimum degree of H is at least 2.

If H is a graph with girth at least 5 that is not (1,t)-colorable but every proper subgraph of H is (1,t)-colorable, then H has at least three (t + 2)+-vertices.

Since H cannot be a tree, which is (0,0)-colorable, there must exist some cycle C in H. Since H has girth at least 5, C has at least five vertices. If H has at most two (t + 2)+-vertices, then there exists an edge uv on C where d(u),d(v)  ≤  t + 1.

By Lemma [\ref=vx-degree-gen] (i), each of u,v has a neighbor u', v', respectively, that is a (t + 2)+-vertex. Note that u'  ≠  v' since otherwise H has a cycle u,v,u' = v' of length 3. Since the minimum degree of H is at least 2 and two 2-vertices cannot be adjacent by Lemma [\ref=vx-degree-gen] (iii), (ii), we may assume that u has a neighbor z that is neither v nor u'. If z is a (t + 2)+-vertex, then u',v',z are three (t + 2)+-vertices of H.

If z is not a (t + 2)+-vertex, then z must have a neighbor z' of degree at least t + 2 by Lemma [\ref=vx-degree-gen] (i). Note that [formula] since otherwise H has a cycle of length at most 4. Hence, H has at least three (t + 2)+-vertices u',v',z'.

Suppose a counterexample to the theorem exists, and consider the minimum one.

If S is the plane or the projective plane, then γ  ≤  1 and so K(γ) = 10. The initial charge sum is less than 0, but by claims in Subsection [\ref=claims], the sum of the final charge is nonnegative. Thus, we conclude that there is no such counterexample.

If S is neither the plane nor the projective plane, then K(γ) = 4γ + 3 and let [formula]. By Lemma [\ref=bad-faces-num] and (R4) of the discharging procedure in Section [\ref=section-discharging], for a (K(γ) + 2)+-vertex v, [formula]. If [formula], then k(v,γ) = d(v) - K(γ) - 2, so [formula]. Otherwise, [formula], and [formula], so [formula]. Therefore, [formula].

Note that Lemma [\ref=vx-high-general] guarantees the existence of three (K(γ) + 2)+-vertices. Thus, via the discharging procedure explained in Section [\ref=section-discharging] and the claims in Subsection [\ref=claims], the final charge sum is at least 3(2γ - 3.5), which is strictly greater than the initial charge sum, which is 6γ - 12. This is a contradiction, and therefore there is no counterexample to the theorem.

Acknowledgments

The authors thank André Raspaud for introducing the problem to the second author when he was a student at the University of Illinois at Urbana-Champaign.