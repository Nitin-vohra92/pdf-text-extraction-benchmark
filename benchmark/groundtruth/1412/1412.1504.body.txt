Proposition Property Lemma Corollary Definition Example Conjecture

A bijection between certain quarter plane walks and Motzkin paths

Introduction

Problem

In [\cite=BoMi10] Bousquet-Mélou and Mishna observed that the class of quarter plane walks using the steps [formula] is equinumerous with the class of Motzkin paths and that the class of quarter plane walks using the steps [formula] is equinumerous with the class of bicoloured Motzkin paths. In both cases their proofs were generating function-based consequences of a larger theory and did not yield bijections between the classes.

A bijection for the first case was given by Eu [\cite=Eu10] in the context of standard Young tableaux with at most three rows. The purpose of this short note is to give a bijection for the larger step set which restricts to Eu's bijection. Note that this new bijection is not the one sought by Mortimer and Prellberg in [\cite=MoPr14] as is briefly discussed in the final section.

Setup

A class of quarter plane walks is a class of walks in the lattice [formula] starting at (0,0), remaining in the first quadrant {(i,j):i  ≥  0,j  ≥  0}, and using steps from a given set of vectors. The length of a quarter plane walk is the number of steps making up the walk.

There are two particular classes of quarter plane walks of interest here, so let us reserve some notation for them.

Let Y be the class of quarter plane walks using steps from the set

[formula]

Let S be the class of quarter plane walks using steps from the set

[formula]

A Motzkin path is a walk using the steps {(1,1),(1,0),(1, - 1)} with the additional requirement that the walk ends on the x-axis.

A bicolouring of a walk is an assignment of one of two colours, say red and black, to each step of the walk.

Since there are no steps with negative x coordinate it makes no difference if we think of Motzkin paths as restricted to the quarter plane or as restricted to the upper half plane. We are interested in the following classes of Motzkin paths.

Let M be the class of Motzkin paths. Let M2 be the class of bicoloured Motzkin paths.

Finally, it will be convenient, in order to define the bijection, to mark some steps of the bicoloured Motzkin paths. In fact this is just a second bicolouring where the two colours are called marked and unmarked. This class will be sufficiently useful to also give it a name.

Let 2 be the class of bicoloured Motzkin paths where each step is additionally either marked or unmarked.

The structure of the remainder of this note is as follows. The first step is to define a map φ:S  →  2. This map is not onto but is one-to-one and φ- 1:φ(S)  →  S is easy to give. The second step is to define ψ:M2  →  2 with the property that [formula] where f:2  →  M2 is the map which forgets the marking. The third step is to show φ(S)  =  ψ(M2) and hence that [formula] is a bijection with inverse [formula].

Once these maps are in place we can observe that [formula] restricted to Y gives all paths using only one colour and hence gives a bijection Y  →  M which turns out to be the bijection of Eu [\cite=Eu10].

The maps

S to 2

Given w∈S define m = φ(w) by the following procedure.

Read through w from beginning to end, at each stage adding a new step to the path m as follows:

If the current step in w is [formula] then add a marked red →   to the end of m.

If the current step in w is →   then add a marked black →   to the end of m.

If the current step in w is [formula] then find the rightmost step in m which is either a marked red →   or a marked black [formula]

if the found step was a marked red →   replace it with an unmarked red [formula]

if the found step was a marked black [formula] replace it with an unmarked black →

In both cases add a marked red [formula] to the end of m.

If the current step in w is [formula] then find the rightmost step in m which is either a marked black →   or a marked red [formula]

if the found step was a marked black →   replace it with an unmarked black [formula]

if the found step was a marked red [formula] replace it with an unmarked red →

In both cases add a marked black [formula] to the end of m.

If the current step in w is ← then find the rightmost step in m which is either a marked black →   or a marked red [formula]

if the found step was a marked black →   replace it with an unmarked black [formula]

if the found step was a marked red [formula] replace it with an unmarked red →

In both cases add an unmarked red [formula] to the end of m.

If the current step in w is [formula] then find the rightmost step in m which is either a marked red →   or a marked black [formula]

if the found step was a marked red →   replace it with an unmarked red [formula]

if the found step was a marked black [formula] replace it with an unmarked black →

In both cases add an unmarked black [formula] to the end of m.

Figure [\ref=phi_eg_fig] gives a step by step example.

Let m = φ(w) with w∈S. The sum of the number of marked red [formula] steps and the number of marked black →   steps in m is the x-coordinate of the end of w. The sum of the number of marked red →   steps and the number of marked black [formula] steps in m is the y-coordinate of the end of w.

φ is a length-preserving map from S to 2.

Proceed inductively. The statement immediately holds for the two length 1 elements of S. Suppose it holds for all elements of S of length at most n. Take w∈S of length n + 1 and let w' be w with the last step removed. By induction the statement holds for m' = φ(w'). Consider the last step of w; it falls into one of the six cases in the definition of φ.

In case (1) w moves one final step upwards and m = φ(w) gets one additional marked red →  , which contributes to the y-coordinate count, and so the statement holds. Similarly in case (2) with leftwards in place of upwards and black in place of red. In case (3) the end of w moves one step right and one step down, while m loses a step contributing to the y-coordinate count and gains one marked red [formula] which contributes to the x-coordinate count. Thus the statement holds for w. Case (4) is analogous but reversed. In case (5) w moves one step left and m loses a step contributing to the x-coordinate count. Case (6) is again analogous but reversed.

In all cases the statement holds for w and so by induction holds for all of S.

The paths given by the construction of φ are immediately bicoloured and with each step additionally either marked or unmarked; furthermore length is preserved since each step of w yields exactly one step of φ(w). Thus we only need to check the Motzkin property and that in cases (3), (4), (5), and (6) the desired past step of m is always findable.

Again proceed inductively. The base case is an immediate check. Take w∈S and let w' be w with the last step removed. By induction m' = φ(w') is a Motzkin path. Consider the final step of w; it falls into one of the six cases in the definition of φ.

In cases (1) and (2) the Motzkin property of m holds because we are adding a →   to the end of m'. In cases (3) and (6) for the end of w to remain in the quarter plane, the end of w' must have y-coordinate at least 1, and so by part (1) of this proposition the past step of m needed in the construction of φ must exist. In cases (4) and (5) the same holds with x in place of y. Therefore in cases (3), (4), (5), and (6), the construction of m converts one step of m' to end one unit higher and adds a [formula] to the end of m' thus preserving the Motzkin property. Therefore φ:S  →  2.

φ is one-to-one and hence S is in bijection with the image of φ in 2.

First note that the construction of φ never gives a marked [formula].

Given a bicoloured, marked Motzkin path m with no marked [formula], build a lattice path w using the steps [formula] as follows. Read through m from left to right at each stage adding a new step to w as follows:

If the current step in m is a marked red →   or an unmarked red [formula] then add [formula] to the end of w.

If the current step in m is a marked black →   or an unmarked black [formula] then add →   to the end of w.

If the current step in m is a marked red [formula] or an unmarked red →   then add [formula] to the end of w.

If the current step in m is a marked black [formula] or an unmarked black →   then add [formula] to the end of w.

If the current step in m is an unmarked red [formula] then add ← to the end of w.

If the current step in m is an unmarked black [formula] then add [formula] to the end of w.

Call the map defined above g. Matching up the different possibilities we see that [formula] and hence φ is one-to-one.

φ has a nice shift property.

Suppose w∈S can be written as the concatenation of two walks w = w1w2 with w1,w2∈S. Then φ(w) can also be written as a concatenation, φ(w)  =  φ(w1)φ(w2).

Conversely suppose φ(w)  =  m1m2 for some m1,m2∈2. Then m1  =  φ(w1) and m2  =  φ(w2) for some w1,w2∈S and w = w1w2.

Suppose w = w1w2 with w1,w2∈S. By the construction of φ, once we have read through all the steps of w1 we will have φ(w1). Since φ(w2) is well-defined, it must be the case that while reading through the steps of w2, in cases (3), (4), (5), and (6), the previous step can always be found among the steps of w2. Thus the steps of w2 contribute φ(w2) to the end of φ(w). In other words φ(w)  =  φ(w1)φ(w2).

Conversely suppose φ(w)  =  m1m2 with m1,m2∈2. Suppose m1 has length i. Once we have read through the first i steps of w in the definition of φ we will have m1, because if not then some later step affects a step of m1, but in such a case all subsequent steps of m1 and in particular the end of m1 would be lifted by one unit, and so [formula]. Thus m1  =  φ(w1) where w1 is the first i steps of w.

Let w2 be the rest of w. We already observed that the steps of w2 do not affect m1 and so m2  =  φ(w2). Furthermore w2∈S since otherwise at some point w2 would leave the bounds of the quarter plane, at which point we would be in case (3), (4), (5), or (6), but by Proposition [\ref=endpt_prop] part (1) we would not be able to find an appropriate previous step in m2 which is a contradiction.

Thus φ(w)  =  φ(w1)φ(w2) with w1,w2∈S. Then from the first part of this proposition φ(w)  =  φ(w1w2), while by Proposition [\ref=phi_prop] φ is one-to-one and so w = w1w2.

M2 to 2

Given s∈M2 define ψ(s) by the following procedure. Read through s from left to right marking and unmarking steps as follows.

If the current step is a [formula] of either colour then do nothing.

If the current step is a red →   then find (if possible) the rightmost step before the current step which is either

a red [formula] which is not yet marked or unmarked or

a black →   which is not yet marked or unmarked.

If such a step exists then set it to unmarked and do nothing with the current step. If such a step does not exist then set the current step to marked.

If the current step is a black →   then find (if possible) the rightmost step before the current step which is either

a black [formula] which is not yet marked or unmarked or

a red →   which is not yet marked or unmarked.

If such a step exists then set it to unmarked and do nothing with the current step. If such a step does not exist then set the current step to marked.

If the current step is a red [formula] then find (if possible) the rightmost step before the current step which is either

a black [formula] which is not yet marked or unmarked or

a red →   which is not yet marked or unmarked.

If such a step exists then set both it and the current step to unmarked. If no such step exists then find the rightmost step before the current step which is either

a red [formula] which is not yet marked or unmarked or

a black →   which is not yet marked or unmarked.

Then set this step to unmarked and set the current step to marked.

If the current step is a black [formula] then find (if possible) the rightmost step before the current step which is either

a red [formula] which is not yet marked or unmarked or

a black →   which is not yet marked or unmarked.

If such a step exists then set it and the current step to unmarked. If no such step exists then find the rightmost step before the current step which is either

a black [formula] which is not yet marked or unmarked or

a red →   which is not yet marked or unmarked.

Then set this step to unmarked and set the current step to marked.

Figure [\ref=psi_eg_fig] gives a step by step example.

ψ is a length-preserving map from M2 to 2.

Let f:2  →  M2 be the map which forgets the marking. Then [formula] and hence M2 is in bijection with the image of ψ in 2.

Every time the construction meets a →   step, one step at or before the current step which had not been previously marked or unmarked gets marked or unmarked. Every time the construction meets a [formula] step the current step and one earlier step which had not been previously marked or unmarked get marked or unmarked. By the Motzkin property there are as many [formula] steps as [formula] steps, and every [formula] step has some step not yet marked or unmarked before it. Thus the construction is always possible and at the end every step is marked or unmarked. The remaining properties follow as ψ does not change the underlying bicoloured Motzkin path.

The construction of ψ does not change the underlying bicoloured Motzkin path, only the markings. Thus [formula].

The images

φ(S)  =  ψ(M2)

Let f:2  →  M2 be the map which forgets the marking.

Take w∈S. Let m = φ(w) and s = f(m). We want to show that ψ(s)  =  m. Read through w and s step by step following the definitions of φ and ψ respectively.

Claim:

If the current step in s is a [formula] and hence has unknown marking status, then the current step in the construction of m is a marked →   of the same colour which will later be lifted to a [formula]. This later lifting step will be the same step which unmarks the current step in the construction of ψ.

If the current step in s is a →   which has unknown marking status, then the current step in the construction of m is a marked [formula] of the same colour which will later be lifted to a →  . This later lifting step will be the same step which unmarks the current step in the construction of ψ.

If the current step in s is a marked →   then the current step in the construction of m is a marked →   of the same colour which will not later be raised.

If the current step in s is a [formula] then the current step in the construction of m is a [formula] of the same colour and marking status.

Now prove the claim by induction on the steps. At a given step we are in one of the following situations

The current step in s is a [formula]. This can only come from a marked →   in the partial construction of m which will later be lifted to a [formula].

The current step in s is a →   which caused a previous step to be unmarked. By the induction hypothesis, the conditions in the definitions of φ and ψ for finding a previous step will find the same step and so this previous step is the step raised by the current step in the definition of φ and hence is also unmarked at this same point by φ.

The current step in s is a →   which has just been marked. Then as the condition in (2) or (3) of the definition of ψ was not fulfilled, by the correspondence of the induction hypothesis, there was no previous match for this step in the construction of φ and so it corresponds to a marked →   in m.

The current step in s is a [formula]. By the induction hypothesis, the first set of conditions in the definition of ψ corresponds to the conditions to match a current unmarked [formula] in the definition of φ, and the matching step is raised, hence unmarked in both ψ and φ. If this match is not possible then the [formula] must be marked and hence raises a step using the opposite condition as given in both ψ and φ. The unmarked possibility for the current step must be considered first in the definition of ψ as otherwise when the step which should match with the found occurs it would match with the current step instead which would change the shape of the Motzkin path.

Using the above we can conclude that ψ(s) = m and so φ(S)  ⊆  ψ(M2).

In the other direction take s∈M2. Let m = ψ(s). Note that every [formula] of m is unmarked and so we can let w = g(m) where g is as defined in the proof of Proposition [\ref=phi_prop]. The correspondence from the claim again holds, and can again be proved inductively by reading through w and s step by step. Hence φ(w)  =  m and so ψ(M2)  ⊆  φ(S).

Therefore φ(S)  =  ψ(M2).

Results

Let f:2  →  M2 be the map which forgets the marking. Then [formula] is a length-preserving bijection.

Immediate from Proposition [\ref=endpt_prop] (2) along with Propositions [\ref=phi_prop], [\ref=psi_prop], and [\ref=image_prop].

Let f be as in the previous theorem. The image of Y under [formula] is the set of bicoloured Motzkin paths using only red steps. Thus [formula] also gives a length-preserving bijection between Y and M.

Consider the six cases in the construction of φ. No case changes the colour of a previous step. Cases (1), (3), and (5) involve steps used in Y and add a red step to the end of the Motzkin path. Thus the image of Y under [formula] consists of Motzkin paths using only red steps. Cases (2), (4), and (6) involve steps not used in Y and add a black step to the end of the Motzkin path. Thus any element of [formula] under [formula] gives a Motzkin path with at least one black step. The result follows.

Comments

Eu in [\cite=Eu10] gives a size-preserving bijection between the set of standard Young tableau with at most 3 rows and the set of Motzkin paths. There is a well-known bijection between Standard Young tableau with at most 3 rows and Y given by the following rule: step i of the walk is

[formula] if i appears in row 1 of the Young tableau,

[formula] if i appears in row 2 of the Young tableau and

← if i appears in row 3 of the Young tableau.

The standard Young property is then equivalent to the quarter plane condition on the walk. Equivalently, the Yamanouchi word of the tableau is the walk using the alphabet [formula] in place of {1,2,3}. In view of this, Eu's map associating a Motzkin path to a word ([\cite=Eu10] p465) is identical to [formula]; the labelling and looking back in Eu's step A1 is the finding and marking of ψ.

Mortimer and Prellberg show ([\cite=MoPr14], Corollary 4), using generating function techniques, that

walks in S which never go outside the triangle bounded by the axes and x + y = 2H + 1 are equinumerous with bicoloured Motzkin paths in a strip of height H and

walks in S which never go outside the triangle bounded by the axes and x + y = 2H are equinumerous with bicoloured Motzkin paths in a strip of height H which never have a horizontal step at height H.

The bijection given here does not have this height property. A natural problem then is to find a bijection which does. After extensive playing around, I feel it is likely that there is such a bijection in which the Motzkin path is built step by step from the walk and where each new step modifies the path so far by possibly raising a step, with one small exception when H = 1. This would give a bijection with a similar flavour to the one described in this note. Unfortunately the raising rule, if it exists, is obscure at present.

Examples of φ

To aid the reader in their intuition this appendix contains some examples of φ. Observe that reflecting a walk s∈S is equivalent to swapping the colours in φ(s), so only walks beginning [formula] will be shown. In all the examples marked steps are fat and unmarked steps are thin. Figure [\ref=up_to_3_fig] gives φ on such walks up to length 3.

In view of Proposition [\ref=shift_prop] only walks whose Motzkin paths have no interior returns to the x-axis are shown for length 4, see Figure [\ref=size_4_fig]. Finally, to give a partial sense of the length 5, φ on the walks from Y of length 5 with Motzkin paths with no interior returns to the x-axis is given in Figure [\ref=size_5_fig].