Lemma Problem Proposition Definition Remark Corollary Assumption Observation Conjecture Notation Example

Duality for Mixed-Integer Convex Minimization

Introduction

Several attempts have been made in the past to define formally a dual of a linear integer or mixed-integer programming problem. Let us first mention some important developments in this direction.

One idea to define a dual program associated with a binary linear integer programming problem is to encode the given 0 / 1-problem in form of a linear program in an extended space, so that the new variables correspond to linearizations of products of original variables. The variables of the dual of the resulting linear optimization program can be reinterpreted in terms of the original variables. This concept of duality has its origins in the work of [\cite=SheraliAdams90] [\cite=SheraliAdams99] and [\cite=LovaszSchrijver91] and is closely connected with the earlier work of [\cite=Balas75a] [\cite=Balas85b] on disjunctive optimization. It also provides us an interesting link to the theory of polynomial optimization including duality results associated with hierarchies of semidefinite programming problems, see [\cite=Lasserre13]. For a nice survey treating the relationships and differences between several relaxations of this kind we refer to [\cite=Laurent01].

A second important development in integer optimization is based on the connections between valid inequalities and subadditive functions. This leads to a formalism that allows us to establish a subadditive dual of a general mixed integer linear optimization problem, see [\cite=Johnson73] [\cite=Jeroslow78] [\cite=Jeroslow79] [\cite=Jeroslow1979] [\cite=Johnson79] and [\cite=NemhauserWolsey88] for a treatment of the subject and further references. Recently, a strong subadditive dual for conic mixed integer optimization has been constructed in [\cite=RW_MDV2012].

There are several other special cases for which the dual of a mixed integer optimization problem has been derived. One such example is based on the theory of discrete convexity established in [\cite=RW_M2003]. Here, an explicit dual is constructed for L-convex and M-convex functions.

A third general approach to develop duality in several subfields of optimization is based on the Lagrangian relaxation method. The latter method is broadly applicable and - among others - leads to a formalism of duality in convex optimization. The connection between the Lagrangian dual and linear relaxations of linear integer optimization problems has its origins in [\cite=HeldKarp70]. This paper developed a combinatorial version of a Lagrangian relaxation in form of 1-trees for the traveling salesman problem. Since then there is a large number of applications using this relaxation technique for integer optimization problems, see e.g. Chapter II.3 in [\cite=NemhauserWolsey88].

Our point of departure is the strong duality theorem for convex optimization based on the Lagrangian relaxation method. We will show that optimality certificates and duality in convex optimization have a very natural mixed-integer analogue. A duality theory in Euclidean space follows from a precise interplay between points - that are viewed as primal objects - and level sets of linear functions, that is, closed half-spaces, interpreted as dual objects. It turns out that there is a similar interplay in the mixed-integer setting. Here, the primal objects are sets of points, whereas the dual objects are lattice-free open polyhedra. Our motivation for studying optimality certificates and a mixed-integer convex dual comes from the important developments in convex optimization in the past decade. As a first step towards new mixed-integer convex algorithms, it seems natural to make an attempt of extending some of the basic convex optimization tools to the mixed-integer setting.

Mixed-integer optimality certificates

Let [formula] be a continuous convex function. In order to simplify our exposition we may assume w.l.o.g. here that [formula]. Assume that f has a, not necessarily unique, minimizer [formula]. Then a necessary and sufficient certificate for [formula] being a minimizer of f is that [formula], i.e. the zero-function is in the subdifferential of f at [formula]. Hence

[formula]

The question emerges how to obtain a certificate that a point [formula] solves the corresponding mixed-integer convex problem

[formula]

Let us first explain the idea of our approach. By definition, [formula] if and only if

[formula]

The level set [formula] is convex. If it is nonempty, then its projection to its first n components, that is, to the subspace spanned by the integer variables is again a convex set. Clearly, [formula] if and only if

[formula]

From a theorem of Lovasz, inclusionwise maximal lattice-free convex sets are polyhedra [\cite=Lovasz89]: we can restrict our attention to such polyhedra P that contain the (convex) projection Q. From the theorem of Doignon [\cite=Doignon1973], it follows that a subset of at most 2n inequalities in the description of P are enough to prove that [formula]. It remains to show how to relate these 2n inequalities to the function f. The following theorem, which is an immediate consequence of our Theorem [\ref=mixedIntgerKKT] proved at the end of this section, clarifies this relationship, providing a necessary and sufficient condition for our original mixed-integer convex problem. Each of these 2n inequalities is related to a mixed-integer point, the set of which constitutes our optimality certificate. Condition (a) ensures that [formula] is one of the points of the optimality certificate and is the best of them. Also, in view of Condition (c), every point x in the certificate minimizes f on its own fiber, that is, in the set [formula]. Finally, the subgradient of f at each point of the certificate defines a half-space. The interior of their intersection plays the role of a polyhedron whose projection on the first n components is the P described above. Condition (b) ensures that this interior is lattice-free.

One direct implication of the result below is that it provides us with a certificate for the optimality of a given mixed-integer point. The verification can be performed in polynomial time, provided that the number of integer variables is a constant.

[formula] if and only if there exist k  ≤  2n points [formula] and vectors hi∈∂f(xi) such that the following conditions hold:

[formula].

[formula].

[formula] for [formula].

As announced, we formulate and prove a version of the above theorem that takes possible convex functional constraints to problem [\eqref=eq:unconstrained_MICO] into account.

Let [formula] be continuous convex functions. Again we may assume w.l.o.g. that [formula] for all j. By g(x) we denote the vector of components [formula]. Let us first discuss the continous convex optimization problem

[formula]

Assume that there exists a point [formula] fulfilling the so-called Slater condition, that is, g(y) < 0. Under this assumption the Karush-Kuhn-Tucker (KKT) conditions (e.g. [\cite=Karush39] [\cite=KuhnTucker51]) provide necessary and sufficient optimality conditions. Namely, the point [formula] such that [formula] attains the optimal continuous solution if and only if there exist [formula], [formula], for [formula] and non-negative λi, [formula], such that

[formula]

Note that in this representation it suffices to consider only those [formula] that are active, i.e. λi  ≠  0, and for which the corresponding hgi are linearly independent.

It is our intention to generalize these optimality conditions to the mixed-integer setting

[formula]

We first generalize the Slater condition.

We say that the constraints [formula] fulfill the mixed-integer Slater condition if for every point [formula] with [formula] there exists a [formula] such that g((z,y')) < 0.

Under the assumption of the mixed-integer Slater condition, we next formulate and justify mixed-integer optimality conditions.

As in the unconstrained situation, a certificate is given by a list of k  ≤  2n mixed-integer points [formula]. Our substitute for the nonnegative multipliers λ are k nonnegative vectors [formula] of size m + 1. Condition (c) asserts that none of these vectors is null; their maximal sparsity is a consequence of Caratheodory's Theorem. As in Theorem [\ref=mixedIntgerunconstrained], Condition (e) indicates that the points of the certificate are optimal in their own fiber. Condition (a) ensures that the mixed-integer optimum [formula] is in the certificate, and is the best among all those that are in it. The additional complementarity conditions are inherited from the continuous KKT theorem quoted above. Among the certificate points [formula], several might be infeasible for the primal problem. Let us define the set [formula] for every 1  ≤  i  ≤  k. Condition (b) addresses infeasible points xi in the certificate, that is, those for which gj(xi) > 0 for any j∈Ii. It ensures that ui,j > 0 only when j∉Ii. (Note that the complementarity condition for feasible points xi's in Condition (a) can be expressed identically). The lattice-freeness Condition (d) is the natural extension of Condition (b) in Theorem [\ref=mixedIntgerunconstrained].

Similarly to the unconstrained case, one implication of this result is that the optimality of a mixed-integer point can be verified in polynomial time, provided that the number of integer variables is a constant.

Suppose that the problem [\eqref=eq:constrained_MICO] is feasible. Let g fulfill the mixed-integer Slater condition. A point [formula] is optimal for the mixed-integer constrained problem [\eqref=chapter:CenterPoints::equ:mixedIntegerOpti] if and only if [formula] and there exist k  ≤  2n points [formula] and k vectors [formula] with corresponding hi,m + 1∈∂f(xi), and hi,j∈∂gj(xi) for [formula] such that the following five conditions hold:

If [formula] then [formula], ui,m + 1 > 0 and ui,jgj(xi) = 0 for [formula].

If [formula] then ui,m + 1 = 0 and ui,j = 0 for all [formula].

[formula] for [formula].

[formula].

[formula] for [formula].

In order to prove the first implication, we assume that [formula] is optimal. Let [formula] denote the set of all optimal solutions to [\eqref=eq:constrained_MICO]. This set is not empty by assumption, and contains [formula]. If there exists a point [formula] with 0∈∂f(x), then the theorem follows directly from the purely continuous version of the KKT conditions described above; we can also take k  =  1. Next, assume there exists an [formula] and hx∈∂f(x) such that [formula]. By convexity, f must be constant on [formula], contradicting that hx  ≠  0. This implies that if [formula], then 0∈∂f(x) for all [formula]. Hence, let us assume that [formula] and that 0∉∂f(x) for all [formula].

For every [formula] we consider the following continuous convex subproblem,

[formula]

We distinguish two cases.

(i) Problem [\eqref=chapter:CenterPoints::equ:ContSubProb] is infeasible. Let us define

[formula]

Let Iz: = {1  ≤  j  ≤  m  |  gj((z,yz)) =  max 1  ≤  i  ≤  mgi((z,yz))}. Since yz is an optimal solution to an unconstrained convex problem, there exists a vector [formula] such that [formula]. We can write

[formula]

with [formula] for j∈Iz, uz,j  =  0 for j∉Iz, [formula] and hz,j∈∂gj((z,yz)) for [formula]. We also define uz,m + 1: = 0. From Caratheodory's Theorem it follows that we can choose [formula] such that [formula]. We verify Conditions (b), (c), and (e).

(ii) Problem [\eqref=chapter:CenterPoints::equ:ContSubProb] is feasible. We define

[formula]

Since by our initial assumption [formula] is optimal, it follows that [formula]. From Slater's condition, we can apply the standard continuous KKT conditions. There exist a vector of multipliers [formula], a vector hz,m + 1∈∂f((z,yz)), and vectors hz,j∈∂gj((z,yz)) for [formula] such that

[formula]

Condition (a) would thereby be verified whatever fiber minimizer we would take in our certificate.

Furthermore, the KKT conditions implies also that [formula], which will lead to Condition (e).

Note that uz,m + 1 > 0 implies that [formula]. Caratheodory's Theorem implies that we can choose u such that [formula], which will yield Condition (c).

Next we define

[formula]

and the open half-space

[formula]

Since the last d components of hz are null, (z',y') belongs to Lz if and only if the whole fiber containing z' belongs to Lz. So, the fiber of z does not belong to Lz because (z,yz)∉Lz.

Suppose now that (z',y') is a (continuous) feasible point that does not belong to Lz. Then f((z',y'))  ≥  f((z,yz)). Indeed, we first have:

[formula]

where we have used successively the nonnegativity of the multipliers uz,j, the complementarity conditions, and the convexity of the functions gj. Since uz,m + 1 > 0, we deduce that:

[formula]

as announced.

Therefore, the intersection [formula] is lattice-free and contains every feasible point (z,y) for which [formula]. We have excluded at the beginning of this proof the situations where L could be empty.

It follows from [\cite=Doignon1973] that a sub-selection of [formula] inequalities [formula], [formula] suffices to describe a lattice-free polyhedron containing L. By convexity, one of those k points has to be a solution [formula] to our mixed-integer problem. Then we obtain the desired certificate by defining [formula]. Note that we have written hi for hzi in the theorem's statement.

All the conditions are now satisfied.

To prove the other direction, let [formula] be the points in the certificate, and consider the open polyhedron:

[formula]

with hi,j as defined in the statement of the Theorem. We assume that Conditions (a) - (e) are satisfied. In particular, P is lattice-free. Let [formula]. Then x̄ must violate at least one inequality of P, say the i-th inequality, i.e.,

[formula]

Since [formula] is a subdifferential of the convex function [formula] at xi, the minimum of ψ(x) over the half-space [formula] is precisely xi.

Assume [formula]. Since ui,m + 1  =  ui,j  =  0 for all j∉Ii, we get

[formula]

from which we deduce that x̄ is not feasible.

Assume now that [formula]. Then ui,jgj(xi)  =  0, so

[formula]

So, if x̄ is feasible, the sum of the m first terms above is nonpositive, and f(x̄)  ≥  f(xi). Thus the best point [formula] among those in the certificate must be optimal.

As an illustration of the above theorem, let us consider the mixed-integer Euclidean Projection problem:

[formula]

for a given point [formula].

The continuous version of this problem has a unique solution, say [formula], which satisfies the so-called projection condition:

[formula]

Observe that this projection condition implies:

[formula]

Assume that the feasible set fulfills the mixed-integer Slater's condition. The certificate [formula] given for the problem [\eqref=eq:MIP_projection] satisfies the projection property:

[formula]

and

[formula]

We denote by S the feasible set [formula]. Theorem [\ref=mixedIntgerKKT] for f(x): = ||x - y||22 / 2 provides us with a certificate of points [formula], its accompanying set of nonnegative vectors ui and subgradients hi,j. Let [formula]. By Condition (d), the point x violates at least one of the inequalities describing the open lattice-free polyhedron, say [formula]. By feasibility of x, we know that ui,m + 1 > 0. Thus:

[formula]

The second inequality comes readily from:

[formula]

The following theorem characterizes another set of optimality conditions. We use here a larger set of points in the certificate, and therefore a more complex lattice-free polyhedron. Moreover, these points do not necessarily belong to the lattice. However, the Slater condition becomes much simpler to verify.

Assume the standard Slater's condition: there exists a point [formula] such that g(s) < 0. A point [formula] is optimal with respect to [\eqref=chapter:CenterPoints::equ:mixedIntegerOpti] if and only if

[formula],

there exist k + l  ≤  2n(d + 1) points [formula] and [formula] in [formula] such that [formula] for [formula] and g(yi)  ≤  0 for [formula],

there exist numbers [formula] such that gji(yi)  =  0 and there exist subgradients hxi∈∂f(xi) and hyi∈∂gji(yi) such that

[formula]

is lattice-free.

Let [formula] denote the set of all optimal solutions. We can assume that [formula] is not empty, for otherwise the statement holds vacuously. In view of Slater's condition, the case where a point of X* coincides with a continuous optimum corresponds to the continuous KKT conditions [\eqref=eq:KKT_continuous], which imply the stated optimality certificate: if all the Lagrange multipliers are null, we simply take k  =  1, l  =  0, [formula] to ensure that the set P is empty; if the Lagrange multipliers are not all null, we take k  =  l  =  1, [formula], and, using the notation of [\eqref=eq:KKT_continuous], we take [formula] to get an empty P.

Therefore, we assume without loss of generality that no [formula] has a nonnegative [formula] that satisfies the KKT conditions [\eqref=eq:KKT_continuous]. Using the argument of the proof of Theorem [\ref=mixedIntgerKKT], we can assume that [formula] in empty.

Denote by L the level set [formula], where [formula], and by [formula] the sets [formula], whose intersection S is the feasible set. Thus [formula].

In fact, our assumptions ensure that [formula] is lattice-free. Suppose otherwise and take a point [formula] that would be in the above set. Then there exists a closed ball B centered in [formula] and contained in L. By convexity, the maximum of f on B is attained on [formula] and cannot exceed [formula]. Hence the function f is constant on B, so that [formula]. Taking λ: = 0 shows that [formula] satisfies the continuous KKT conditions, a contradiction.

Since f and g are continuous, L and S are closed. Additionally, the existence of a point x̂ with [formula] -- because [formula] -- allows us to describe L as the intersection of half-spaces defined by its boundary points and their corresponding subdifferentials:

[formula]

The interior of L is easily seen to coincide with:

[formula]

Similarly, in view of Slater's conditions, every set Sj can be described as:

[formula]

so that S is:

[formula]

It follows from [\cite=AverkovWeismantel12] that a subset of 2n(d + 1) half-spaces suffice in order to guarantee that the corresponding intersection remains mixed-integer lattice-free. Without loss of generality, we can choose one of the supporting half-spaces in this description (see the construction in [\cite=AverkovWeismantel12]); thus, we can take the inequality in the description of L corresponding to [formula] for x1.

To prove the other direction, let [formula] be the points of the certificate and consider the lattice-free set P given by the statement of the theorem. Let [formula]. Then x violates one of the inequalities in the description of P. If that violated inequality is of the form [formula], for a point xi in [formula], then we have [formula] and x cannot be better than [formula]. Otherwise the violated inequality is of the form [formula], for a point yi in [formula] and a subgradient hyi∈∂gji(yi). Since gji(yi)  =  0, we have

[formula]

so x is not feasible and therefore not a solution to our problem.

The mixed-integer convex dual

In the purely continuous setting, it is not too difficult to apply the KKT-theorem in order to show a duality theorem. Provided that the standard Slater condition holds, that all functions f and [formula] are continuous and convex, and that the primal and dual feasible sets are nonempty, one has

[formula]

In other words, any multiplier u  ≥  0 gives rise to an unconstrained convex optimization problem [formula] whose optimum is a lower bound on the optimal primal value [formula]. The naive extension of the continuous convex dual would be to replace [formula] in [\eqref=eq:continuous_convex_dual] everywhere by [formula]. This is not correct, though.

Let n  =  m = 2, d  =  0, [formula], [formula], and [formula], where [formula] is the all-one vector. The mixed integer optimal point is [formula], so [formula]. However,

[formula]

which equals [formula] at x  =  (1,0)T and [formula] at x  =  (0,1)T, showing that we only obtain a dual bound [formula].

Instead of using just one multiplier per constraint, our dual, as in our KKT Theorem [\ref=mixedIntgerKKT] for mixed-integer problems, must use a selection of up to 2n multipliers per constraint. To every mixed integer point is associated one multiplier of the selection. We denote the function that describes this association as [formula].

Formally, the dual object is the pair of the function π and the matrix [formula] that pile up the multipliers. Here is a geometrical interpretation of that dual object. Consider a polyhedron [formula], where [formula] and [formula] with a lattice-free interior that contains the continuous optimum and suppose that we are given vectors [formula] associated to each row of Ax  ≤  b. We can use this polyhedron and these nonnegative vectors to generate a lower bound α for the original minimization problem [\eqref=chapter:CenterPoints::equ:mixedIntegerOpti] as follows. For each [formula], we consider the continuous convex problem

[formula]

If the half-space [formula] contains feasible points, the optimal value of [\eqref=lowerBoundsFeasibility] is non-positive. Denote by IP the set of index i of all those half-spaces containing feasible points. We can write: These lower bounds lead to the mixed integer duality result stated below.

Let [formula] and [formula] be convex functions, and assume that the mixed-integer feasible set [formula] is non-empty, compact and contained in the domain of f. Further, assume that g fulfills the mixed-integer Slater condition. Then [formula] equals:

[formula]

where Ui denotes the i-th row of U.

We call the minimization problem the primal problem and the maximization problem the dual problem. The assumptions regarding f and g guarantee that there exists a feasible point [formula] such that [formula] attains the primal optimum. Then, for any [formula] we obtain using the point [formula] as a condition on the optimal dual value,

[formula]

This bound on α guarantees that the optimal dual solution must be less or equal than the primal value.

To show the other direction we apply Theorem [\ref=mixedIntgerKKT] using the same notation. Since [formula] is optimal it follows from Theorem [\ref=mixedIntgerKKT] that there exist [formula] fulfilling the conditions in Theorem [\ref=mixedIntgerKKT]. If ui,m + 1 > 0, we define [formula] for [formula]. Otherwise, ui,m + 1 = 0 and we define [formula] for [formula], where [formula]. Note that, if k < 2n we can introduce artificial redundant rows Ui = Uk for [formula]. Now, we define π as follows: [formula]. The lattice-freeness of the set P in the statement of Theorem [\ref=mixedIntgerKKT] shows that this function is well-defined for every lattice point. If x happens to be infeasible, then [formula], i.e., Uig(x)  ≥  1. If x is feasible, then ui,m + 1 > 0 and

[formula]

We conclude that the primal and the dual solution attain the same objective function value.

It is straightforward to generalize the previous result slightly: one may drop the assumptions about the convex functions [formula] and [formula] that ensure that the primal and dual problem are feasible and bounded. This then forces us to replace the minimum and the maximum with the infimum and the supremum, respectively.

Let us finally comment on the linear case. In this special situation we have that [formula] and g(x) = Ax - b, with [formula], [formula] and [formula]. This special setting allows us to simplify the min-max relation and at the same time highlight the connection to mixed-integer free polyhedra. Let us assume without loss of generality that the row vectors [formula] correspond to the first type of inequality in the duality statement, i.e. α  ≤  f(x)  +  Uig(x), and the remaining Ui's correspond to the second type of inequality, 1  ≤  Uig(x). We define Then the duality statement in the linear mixed-integer situation can be recast as follows:

With the notation introduced above one has

[formula]