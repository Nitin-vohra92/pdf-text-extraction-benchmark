Identifying and tracing potential energy surfaces of electronic excitations with specific character via their transition origins: application to oxirane

Introduction

Kohn-Sham (KS) density functional theory (DFT)[\cite=HK64] [\cite=KS65] [\cite=PY94] [\cite=GV05] can accurately reproduce many properties of molecular and solid state systems[\cite=KBP96] [\cite=B97] [\cite=CH08] as compared to experimental methods and higher-level theory, e.g. molecular structures, vibrational frequencies, atomisation energies and ionisation potentials. Meanwhile, its time-dependent extension, TDDFT[\cite=RG84] [\cite=MUN06] [\cite=C95] [\cite=DH05], particularly in the linear response (LR) formalism[\cite=C95], can deliver properties of excited states and optical absorption spectra of molecular systems. DFT and TDDFT calculations are increasingly able to treat large, complex biological systems, such as proteins, enzymes, and nucleic acids, due to the increasing availability of large computational facilities in recent years[\cite=LC14] [\cite=CC13] [\cite=FP13] [\cite=TB13]. However, there remain serious obstacles to such uses: the intrinsic cubic scaling of traditional KS-DFT with respect to the number of electrons; the explosion of the size of the available configurational phase space associated with large, flexible molecules; and the challenges of accurate electrostatics of solvated systems[\cite=LCHHP]. When excited state properties are considered, further challenges come into play such as the proliferation of spurious charge transfer excitations, and the difficulty of identifying connected excited states on a PES.

Recent advances in linear-scaling (LS)-DFT[\cite=WH94] [\cite=WC06] [\cite=SSF96] [\cite=HG95] [\cite=FG06] [\cite=VK05] [\cite=SA02] [\cite=SHMP05] have made the study of very large molecular systems much more feasible. LS-DFT relies on the exponential decay of the density matrix, [formula], with respect to [formula] in a system with a finite band-gap[\cite=BH97] [\cite=IA99] [\cite=HV01]. In such systems, the density matrix, expressed using local orbitals, can be truncated by value or by range to render it local. In this work we use the ONETEP code[\cite=SHMP05], where a minimal number of local optimisable functions, called nonorthogonal generalised Wannier functions (NGWFs), are optimised in situ to best represent the density matrix of the system. Recently, Linear-Response TDDFT Tamm-Dancoff approximation (TDA) calculations have also become available in ONETEP, using a similar density matrix formalism[\cite=ZH13]. Such methods can provide valuable knowledge about the electronic excitations of very large molecular systems such as proteins and DNA segments. However, the low symmetry and complex geometry of biological systems exacerbates the aforementioned problem of tracing the PES of specific excited states. This work therefore focuses on quantified natural transition orbital (QNTO) analysis, recently proposed by Li et al.[\cite=LCGH11], which offers progress towards this goal.

QNTO analysis rewrites the transition vectors of an electronic excitation identified by a theoretical calculation, e.g. TDDFT, in terms of the natural transition orbitals (NTOs)[\cite=M03] [\cite=DH05] [\cite=PWD14]. The projection of hole (NTOn-H) and electron (NTOn-E) orbitals of the nth NTO pair onto a standard orbital basis set such as natural bond orbitals (NBOs)[\cite=RCW88] [\cite=GLW12] [\cite=LC12] then helps quantify the transition origins of the NTOs of the excitation. Alongside the absorption energy and oscillator strength, knowledge of these transition origins helps provide a physical interpretation of the role of a given excitation dominated by single excitation character. Similar analysis may also be developed for single de-excitations, which is not as important in generic biological systems where de-excitations are usually negligible[\cite=DH05], signified by the good approximation of TDDFT/TDA to TDDFT. In addition, even in large and complex systems, electronic excitations may involve numerous electronic transitions between valence and conduction orbitals; using NTOs as the orbital basis, the number of dominant electronic transitions is often reduced to one or two, helping clarify what transition components contribute to the electronic excitations. QNTO analysis can help to assess the variation of transition origins determined by the different theoretical methods available in an electronic excitation calculation. For example, this approach has been used to assess the performance of different exchange-correlation functionals in predicting transition origins by comparing to a high-level theoretical calculation[\cite=LCGH11]. The variations of transition origins caused by the presence of different molecular environments and/or different molecular geometries can also be investigated. For example, QNTO has been used to study the role of the DNA backbone in mediating the transition origins of electronic excitations of B-DNA[\cite=LCGH12].

In the present paper, we introduce theoretical background to Linear-Response calculations in ONETEP (Sec. II), and show that QNTO analysis can be implemented with a non-orthogonal basis set such as the NGWFs used in ONETEP (Sec. III). In Sec. IV we then demonstrate two applications of LR-TDDFT/TDA/QNTO: (1) studying the photo-driven ring opening reaction of oxirane, and (2) identifying and comparing similar excitations between trans-2,3-diphenyloxirane and oxirane. We demonstrate that QNTO analysis can be readily used to locate state crossings that are otherwise unclear from plotting potential energy curves. The results are consistent with previous experimental and theoretical studies, showing that the present method is a feasible and reliable approach for investigating excited state related reactions.

LR-TDDFT in ONETEP

Linear-scaling DFT as implemented in ONETEP[\cite=SMHDP02] [\cite=SHMP05] relies on a reformulation of the single-electron density matrix in terms of local orbitals, as follows

[formula]

where [formula] are single-particle eigenstates with occupation fp, while [formula] are spatially-localised nonorthogonal orbitals. Kαβ is a generalised matrix representation of the occupancies, known as the density kernel. Note that implicit summation over repeated Greek indices is used throughout this work. The density kernel is defined by [formula], with [formula] being the KS single-particle density operator. The nonorthogonal orbitals {φα} and their duals {φα} form a biorthonormal basis set such that 〈φα|φβ〉  =  δβα.

ONETEP employs a minimal number of NGWFs, each expressed in terms of periodic bandwidth limited delta functions (psincs) centred on the grid points of the simulation cell, with a spacing determined by a kinetic energy cutoff akin to that in a plane-wave code.[\cite=SHMP5757] NGWFs are localised to atom-centred spherical regions defined by a cutoff Rφ. A total energy calculation proceeds by minimising the total energy simultaneously with respect to the matrix elements of the density kernel and the expansion coefficients of the NGWFs in terms of the psinc functions, via nested loops of conjugate gradients optimisations[\cite=MHSP03]. NGWFs are initialised to pseudoatomic orbitals which solve the pseudopotential for a free atom.[\cite=RHS12] We confine our attention to closed-shell systems (even number of electrons) with non-fractional occupancy, and the total electronic energy of the real system is written as

[formula]

where {v} denotes 'valence', [formula] and Kαβ{v}  =  〈φα|{v}|φβ〉 with [formula]. The factor 2 accounts for the spin degeneracy and [formula] is the standard "double-counting" correction. An FFT box technique[\cite=SMHDP02] is employed to allow one to construct matrix elements and density components in O(1) computational effort independent of system size.

As described in detail in Ref. [\cite=HSMP08], the minimisation is carried under the constraint of conserved total electron number,

[formula]

where S{v}αβ  =  〈φα|φβ〉, and also the constraint of idempotent density matrix,

[formula]

which is equivalent to requiring the orthonormal orbitals have occupancy of 0 or 1. An important advantage of optimising the NGWFs in situ is that basis set superposition error (BSSE) is eliminated.[\cite=HSMP06] Sophisticated algorithms have been implemented so that a high performance can be achieved running on parallel computers[\cite=HHMSP09].

Because the NGWFs are optimised in situ to describe the occupied part of the density matrix, they do not in general provide a good description of unoccupied states. Therefore, we instead generate and optimise in situ a second set of NGWFs, denoted as {χα}, obtained by minimising the bandstructure energy associated with a chosen range of low-energy conduction band states, having first projected out the valence states. The bandstructure energy to be minimised is written as

[formula]

where {c} denotes 'conduction', [formula] and Kαβ{c}  =  〈χα|{c}|χβ〉. A full description of this procedure can be found in Ref. [\cite=RHH11].

Recently Zuehlsdorff et al. proposed a formulation for linear-scaling LR-TDDFT/TDA (hereafter simply denoted as TDDFT) calculations, which uses the conduction and valence NGWFs as a basis for describing the response densities of electronic excitations[\cite=ZH13]. This approach adapts the Casida formulation for finding transition vectors, [formula], and excitation energies ωI by using the TDDFT equation, [formula], to a nonorthogonal local orbital basis. The quantity sought is the sum of the energies of the Nω lowest excitations

[formula]

A conjugate gradients minimisation of Ω is performed subject to the constraint of keeping the eigenvectors orthonormal, expressing each transition I using a transition density kernel [formula]

[formula]

The transition density kernel, Kαβ{1}I  =  〈χα|{1}|φβ〉 with [formula], defines the transition density according to

[formula]

and the Hartree-exchange-correlation self-consistent field matrix is defined by:

[formula]

with [formula] being the Hartree and exchange-correlation response to the transition density as defined in Eq. 9 of Ref. [\cite=ZH13].

The minimisation of Eq. [\ref=eq:Omega] proceeds as described in Ref. [\cite=ZH13]. To avoid unwanted valence-valence transitions, we project out these unwanted components by constructing the kernel as

[formula]

Additionally, we define a combined NGWF set by amalgamating valence and conduction NGWF sets to create a joint set, [formula]. Using this representation, and the corresponding overlap matrix [formula], in place of {χα} and [formula], means that we no longer need the explicit representation of the conduction space density operator. Instead, the conduction space projector can be replaced by subtracting the valence density operator from the identity operator within the subspace of the full joint NGWF representation. This defines {j} through Kαβ{j}  =  〈ζα|{c}|ζβ〉  =  〈ζα|Î  -  {v}|ζβ〉, giving

[formula]

where S{jv}αβ  =  〈ζα|φβ〉 and [formula] is the inverse of [formula].

We also note that in the TDDFT the KS-system is linked to the real-system by

[formula]

where |Ψ0〉 and |ΨI〉 are the 'exact' many-body wavefunctions that are obtained from diagonalising the exact Hamiltonian in the configuration space. The linear dependence among the products [formula] becomes likely as the orbital basis approaches completion [\cite=H86] and the simple assignment [formula] may not be justified. Nevertheless, this assignment would become reasonable[\cite=C95] if the number of orbitals involved in [formula] is not too large, e.g. for low-lying excitations, and therefore the study of transition origins becomes possible via directly analysing xIcv or Kαβ{1}I from the TDDFT calculation.

Quantified natural transition orbital (QNTO) analysis

In this section, we first introduce the basic formulation of QNTO analysis in terms of an orthonormal orbital basis such as KS-orbitals. We then detail how it is implemented in ONETEP within the NGWF representation. The standard notation '[formula]' is used throughout to denote conjugate transpose.

Natural transition orbitals

The NTO basis

[formula]

is an orbital basis that makes [formula] diagonal, with non-negative real numbers [formula] on the diagonal. In this representation the transition density operator is simplified to require summation over just one index:

[formula]

NN denotes the number of non-zero values [formula], which are ranked by magnitude. [formula] are called the singular values from the singular value decomposition (SVD) of [formula]. We also see that the [formula] and [formula] respectively diagonalise [formula] and [formula],

[formula]

with the same eigenvalue set {λn}, where [formula] and [formula] are density matrices for the electron and hole orbitals, respectively.

In TDDFT calculations in ONETEP, the local orbitals (NGWFs) are not an orthonormal basis. If the NTOs are expressed in terms of NGWFs as

[formula]

[formula] is then rewritten as [formula] and the target for decomposition becomes

[formula]

If we hope to directly employ an SVD algorithm for orthonormal basis, we would have to first construct [formula], where [formula] and [formula]. Once the singular vector matrices [formula] and [formula] are obtained, we would then need to calculate [formula] and [formula] in order to solve for [formula] and [formula].

However, since the square root and inverse of a sparse matrix are in general much less sparse, their calculation would be very costly when dealing with large matrices. As an alternative approach, we can instead choose to diagonalise the [formula] and [formula] as shown in Eq. [\ref=eq:NTOHE]. Since [formula] and [formula], the eigenvalue equations can be derived as

[formula]

Note that in the SVD of [formula], the relative phase between each pair of left (NTOn-E) and right (NTOn-H) singular vectors are fixed: if the left vector is multiplied by ( - 1), the right vector must be multiplied by ( - 1) to remain a solution. Hence, the relative phase between each pair of eigenvectors needs to be determined after solving Eq. [\ref=eq:NTOHEinNGWFs]. The following relation from Eq. [\ref=eq:SVDinNGWFs] can be used:

[formula]

We define two matrices [formula] and [formula] as

[formula]

From Eqs. [\ref=eq:K1defviaUV] and [\ref=eq:dpmdefviaKUV], we see there is the relation:

[formula]

We can thus start from NTO1 and proceed iteratively through higher NTOs, checking which of the associated two eigenvectors obtained in Eq. [\ref=eq:NTOHEinNGWFs], denoted as [formula] and [formula], produces the smaller value in Eq. [\ref=eq:DevNorm]. If Eq. [\ref=eq:DevNorm] is not obeyed, we can multiply the whole vector [formula] (or [formula]) by ( - 1) to obtain a correct pair of [formula] and [formula]. As this is a separate operation from the calculation of [formula] (Eq. [\ref=eq:NTOHEinNGWFs]), we can first solve for a number of eigenvalues n, where n  ≤  NN, and subsequently define a number m, where (m  ≤  n) of these where the associated singular vectors are of interest. This can reduce the computational effort compared to directly running an SVD algorithm given that many excitations will be dominated by just NTO1 or a small number of NTOn pairs.

Interpretation of the transition origins of NTOn electron-hole pairs

After obtaining the NTO-based transition vector element to any NTOn, n  ≤  NN, next we want to interpret the transition origins of each NTOn electron-hole pair from the projection to a standard orbital set. In the present work, we will in some places employ natural bond orbitals (NBOs)[\cite=LC12] as the standard orbital set. By such a projection the composition of NTOn-H and NTOn-E can be quantitatively defined. We generate NBOs by applying the NBO 5.0[\cite=GB11] program as a postprocessing step after the ONETEP calculation. A relatively large atomic orbital (AO) basis set is used in ONETEP for generating NBOs, so that its quality is comparable to that of standard in-situ optimised NGWFs. The electron spillage is thus reduced to a low level, typically 0.006% in the systems studied here, while the HOMO energy is typically within 0.03 eV of its value for NGWFs.

Note that the transition vector, [formula], can be based on different sets of reference orbitals in different calculations. Rewriting the transition vector using the unique NTO basis removes this reference dependence. Projection of NTOs onto a common orbital set such as NBOs then provides a unification of interpretative orbital set for these NTOs. For example, excitations in two systems of different environments and/or geometries can be compared and the precise contribution of an orbital of interest to an excitation can be computed. We may be interested in the hole orbital involved in a [formula] excitation of a molecule, and can compute its quantitative involvement in an excitation of the same molecule embedded in a chemical/physical environment with or without a covalent bond formed.

Two NTOs can be compared using the root mean square deviation, σ, of the projection coefficients with respect to a common standard orbital set[\cite=LCGH12] such as the NBOs used in this work. The similarity of two NTOs can also be quantified by the magnitude of projection from one to the other. The projection sign can be arbitrary, as switching the overall phases of both NTOn-H and NTOn-E orbitals at the same time will result in them remaining a singular vector pair in Eq. [\ref=eq:SVDinNGWFs]. We will use the latter method for comparing two NTOn-H(E) orbitals in the present work, while the projection to NBOs is only employed to help interpret the transition origins of NTOs.

The transition origins of each excitation can be seen as its fingerprint, helping to identify excitations of similar character. The adiabatic potential energy surfaces of electronic states can then be 'reconnected' on the basis of their character. If an electronic state of specific character changes its adiabatic energetic ordering from one geometry to the next, one would expect that at least one conical intersection (CX), key to many photochemical and photophysical processes [\cite=BRS94] [\cite=Y01] [\cite=DY12] [\cite=MBL00] [\cite=LM07] [\cite=CB03] [\cite=LCM08] [\cite=RC98] [\cite=PD06] [\cite=KT02] [\cite=CO95], of electronic states has been passed between the two geometries. A by-product of analysing transition origins of a series of geometries along some coordinate(s) is, therefore, that one observes the influence of a CX (hyper-)point and locates the point where its projection onto the chosen path lies. Note that the current method is not by itself intended for locating the precise geometry of CX points, as to do that would require searching through the full internal coordinate space. In many well-defined cases, an appropriate series of geometries for analysing transition origins may be obtained by (constrained) geometry optimisation within the ground state or a chosen excited state[\cite=FA02], by molecular dynamics for the ground state or excited states[\cite=TTR07], via transition state search [\cite=GPFKA03] etc. Overall, the method can be highly illustrative as to how a photo-absorption driven process/reaction might proceed.

We also note that due to the approximate nature of practical TDDFT functionals, the behaviour of TDDFT excitation energies around CXs may be incorrect[\cite=LKQM06], e.g. they may have overly rapid energy variation. TDDFT can also give the wrong dimension of the branching plane[\cite=LKQM06]. In other words, the PESs along some branching plane coordinates can be qualitatively wrong as the degeneracy is not lifted. While these issues of TDDFT on the study of CXs are still highly debated, TDDFT has, however, been able to offer a reasonable description of oxirane photochemistry[\cite=TT08] [\cite=CD07] which will be our focus in the present work. It has also been shown that TDA as implemented in the current work has some advantage over full TDDFT in the description of regions around intersections [\cite=HW14] [\cite=CD07]. It is known that the use of the TDA in TDDFT avoids the problems associated with singlet and triplet instabilities[\cite=CG00]. The former can occur for systems which have strong static correlation, signified by the vanishing HOMO-LUMO gap, whereas the latter can occur for systems which have an unstable closed-shell ground state, reflected by a negative triplet excitation energy within the TDDFT/TDA.

Overall, since locating CXs is not the point of the present method, the ability to describe the immediate vicinity of a CX is not critical. As long as the influence of a CX on the excitation character of geometries reasonably distant from the CX itself in configuration space is qualitatively correct, then the method outlined will be useful. Note also that the current QNTO method is not limited to use with TDDFT; any electronic structure methods that provide a decomposition of excitations into single transitions of electrons can be combined with this approach, and TDDFT is particularly useful for the study of very large molecular systems.

As an example, we can examine the 2nd excitation of an oxirane molecule using TDDFT/QNTO. The geometry of the oxirane molecule, with CCO angle=[formula], is taken from a scan along the CCO angle which will be discussed in greater detail in Sec. IV. There are 9 valence (occupied) KS-orbitals in the calculation, and therefore the HOMO(LUMO) is indexed 9(10) etc. The transition density operator expressed in the KS-orbital basis results from summation over several pairs of orbitals:

[formula]

By contrast, in the NTO basis it is mostly accounted for by a single NTO pair:

[formula]

The transition density operator is dominated by the NTO1 transition, which accounts for about 97% of the total transition density, whereas in the KS-orbital basis the largest component, [formula], only accounts for about 72% of the density. In Fig. [\ref=fig:NTOexample] we plot the NTO1-H and NTO1-E orbitals as well as the most dominant NBOs for each.

Results and Discussion

In this section, we discuss two applications of QNTO. In subsection A, we focus on tracing the PESs associated with the ring opening process of oxirane. In subsection B, we use QNTO to locate and compare similar excitations between trans-2,3-diphenyloxirane and those of oxirane. As discussed in Sec. III B, it is interesting to see how environmental factors can affect the transition origins of excitations of a molecule, which in turn may modify its reaction pathways. The study of trans-2,3-diphenyloxirane thus serves as an excellent example of the use of QNTO to identify specific excitations of the oxirane molecule embedded in a different environment.

In all calculations a cut-off Coulomb approach[\cite=HDHS11] has been employed to avoid the influence of periodic images from neighbouring simulation cells. A minimal set of 1 NGWF for H atom and 4 NGWFs for C and O atoms is used. All calculations are well-converged with respect to the variational parameters of the localisation radii: suitable values are 10 bohr for valence NGWFs and 16 bohr for conduction NGWFs. The kinetic energy cutoff for the grid spacing is well-converged at 1000 eV. Norm-conserving pseudopotentials are used to replace core electrons. For DFT and TDDFT calculations we make use of the (A)LDA functional in the Perdew-Zunger parameterisation[\cite=PZ81] throughout. While checking the accuracy of results using other higher level method may be desirable, we note that DFT/TDDFT calculations with the standard (semi-)local functionals LDA and PBE[\cite=PBE96] are capable of describing the photochemically relevant PESs of ring-opening reactions in qualitative agreement with high quality quantum Monte Carlo calculations[\cite=TT08] [\cite=CD07]. In addition, even though the use of Hartree-Fock exchange hybridised functionals such as PBE0[\cite=AB99] or asymptotically corrected functionals such as LB94[\cite=LB94] may improve the DFT/TDDFT results, the results can deteriorate to be worse than that of pure PBE for structures near bond breaking region at large CCO angle where correlation effects become highly significant[\cite=TT08]. Although further examinations of functionals such as range-separated hybrid ones that have been used for similar molecular systems [\cite=CH08] [\cite=WPS09] [\cite=SG11] [\cite=LCGH11] may still be desirable, the (A)LDA is considered to be sufficient for the purpose of the present work.

Photoinduced ring opening of oxirane

The Gomer-Noyes mechanism, as depicted in Fig. [\ref=fig:GN_pic], was postulated and experimentally confirmed[\cite=GN50] [\cite=KIIT73] as a way to explain the photoinduced ring opening process of the oxirane molecule. More discussions about this textbook molecule of stereochemistry can be found, for example, in Ref. [\cite=MB90]. In particular, the specific electronic states involved in the Gomer-Noyes mechanism have been examined in some detail through TDDFT excited state molecular dynamics (MD) simulations validated by high-quality quantum Monte Carlo calculations[\cite=TT08] [\cite=CD07], and several states have been found to be involved in mediating the ring-opening reaction.

Here, we perform a constrained ground state optimisation scan along the CCO bond angle of oxirane. We relax all internal coordinates except for a fixed CCO bond angle, which is set to values in the range [formula] to [formula]. For each oxirane geometry in the scan, a TDDFT calculation (vertical excitations) is performed followed by QNTO analysis to obtain the transition origins of the first few low-lying excitations.

The potential energy curves of the low-lying singlet and triplet states are plotted in Fig. [\ref=fig:CCOscan]. For reference we also show the negative HOMO energy and the value of the HOMO-LUMO gap at each angle. A caveat is that the calculation quality would deteriorate for those excitations of energies higher than the negative HOMO energy. As this tends to be underestimated by the TDDFT/LDA[\cite=CJCS98], one may obtain fewer bound states than are present in the real system. In addition, as mentioned in Sec. III. B, a vanishing HOMO-LUMO gap and triplet excitation energy signifies a (nearly) singlet and triplet instability, respectively, whereas employment of TDA helps circumvent these problems and may be recommendable when using generic approximate functionals in TDDFT calculations.

We note that from the excitation energies alone there is no clear indication of where crossings, indicating nearby CX points, have been passed while progressing along these curves. This is where the utility of QNTO analysis can be seen, as discussed in Sec. III B. If the transition density operator for these systems is dominated by the NTO1 component (Eq. [\ref=Tran_vec_NTO]), the character of each excitation can be represented by the transition origins of just NTO1. The transition vector component for NTO1, [formula], along the scan are listed in Table [\ref=tab:60-115SEC]. As can be seen, in most cases [formula] is higher than 0.99. For the first three excitations, the smallest [formula], 0.8477, is from the 3rd excitation of the oxirane geometry at CCO=[formula], which still captures about 72% of the density contribution. Thus, all the excitations on the oxirane geometries from the scan are dominated by the NTO1 transition, and when a switch of the NTO1 transition origins occurs, it shows that the excitation changes its character.

To put this in a form suitable for identifying electronic states of similar character section by section, we can construct a map (Fig. [\ref=fig:60-115map]) showing the projections of the NTO1 pairs for each of the first three excitations (S1, S2, S3) at each geometry onto their equivalents at different geometries, forming a [formula] block for each pair of geometries. We refer to the geometry listed down the row of the map as the 'System' (Sys) and compare it to a 'Reference' (Ref) geometry along the columns. To obtain a meaningful projection while accounting for the geometry change, the NTO1-H(E) orbitals are translated from the Sys-geometry to the Ref-geometry and renormalised before being used for projection. The optimised atom-centred NGWFs |φα;〉 from the calculation in the Sys-geometry are translated to the corresponding atom centres in the Ref-geometry to produce NGWFs |φα;  →  〉. The NTO1-H orbital (Eq. [\ref=eq:NTOinNGWFs]) is then re-expressed in terms of these using the original coefficients [formula]

[formula]

The translated orbital is then renormalised:

[formula]

and each [formula] block of projections is calculated as

[formula]

for I = 1,2,3 and J = 1,2,3.

In Fig. [\ref=fig:60-115map] one can immediately see which cells involve pairs of excitations with similar transition origins. We highlight those that have both projections greater than [formula], indicating that the density contribution to one from the other is higher than 50%. One then sees where there are switches of transition origins of these adiabatic excited state curves, or changes of transition character of all excited states, from one block to another. The former case can indicate that there has been one or more CXs passed between the two excitations. The latter would be caused by a character change of the ground state itself. This can be due to the fact that a CX between S0 and S1 has been passed, e.g. [formula] and [formula], or that the molecular structures have become drastically different, e.g. [formula] and [formula].

One can further subdivide the geometry scan to more accurately locate the position along the CCO angle coordinate where the character of the excitation changes. We demonstrate two such examples of switches of excitation which show subtly different behaviour. Fig. [\ref=fig:60-65map] shows an example where the switch of excitation character previously shown from the coarser map to occur between [formula] and [formula] is narrowed down to occurring abruptly between [formula] and [formula]. The corresponding potential energy curves for the two states involved, and the NTO1-H and NTO1-E orbitals before and after the switch, are plotted in Fig. [\ref=fig:60-65PES], showing that the bands approach very closely around this point.

In other cases, however, when a more closely spaced geometry map is considered, the change of excitation character may be so smooth that no abrupt character switch occurring between two minimally-differentiated geometries can be found. An example is shown in Fig. [\ref=fig:65-70map]. The two adiabatic excited state curves as plotted in Fig. [\ref=fig:65-70PES] also do not come closer than 0.2 eV to each other. However, as the transition characters have switched for the two adiabatic excited states curves between CCO=[formula], there must be a CX located nearby, i.e. on other (internal) coordinates, even if it does not occur exactly along the scanned coordinate. Thus, without analysing the electronic character, only from the plot of the energy, one would not necessarily know that molecular motions in this region of the scanned coordinate would be near a CX, and that an electronic state change from the upper surface to the lower surface could occur. However, note that from considering the overall shape of the energies in Fig. [\ref=fig:CCOscan], it is not difficult to envisage that a crossing could have occurred between S1 and S2. For further analysis, the NTO1-H(E) orbitals of excitations from a geometry somewhat further away from those being considered can be used as a reference set, similar to a diabatic configurations set used for locating CXs[\cite=AR97]. For the map shown in Fig. [\ref=fig:65-70map], the NTO1-H and NTO1-E orbitals of the first two excitations at CCO=[formula] can provide an appropriate reference set. We thus project the NTO1-H and NTO1-E orbitals at varying geometries onto these reference orbitals, giving:

[formula]

[formula]

This shows that the two reference electron orbitals from CCO=[formula] switch domination between CCO=[formula] and [formula], which could not have been determined from Fig. [\ref=fig:65-70PES] alone. Thus, a better strategy without overlooking a character switch between two curves would be to employ a wide coordinate window within which all the cross-projection data between each pair of geometries are checked.

We note that the exact point where the domination switches occur can be somewhat affected by the choice of reference orbitals used, although this does not in general prevent us from tracing down the CX to a small region in the scanned coordinate. In the language of diabatic configurations[\cite=AR97], the situation can be analysed by considering the matrix elements of a Hamiltonian Ĥ acting on a reduced subspace consisting of just two such configurations, denoted as |Φ1〉 and |Φ2〉. The switch of domination of two diabatic configurations as a given geometry path is traversed indicates that the surface 11  -  22 = 0 has been crossed, though the exact shape of the surface of 11  -  22 = 0 will be affected by the reference diabatic configurations used.

Evidence of a CX between S1 and S0, on the other hand, would be reflected in the map by the fact that a whole column of excitations would change transition character at the same time, because the ground state itself on which excitations are based has changed character. We are able to locate two such points in Fig. [\ref=fig:60-115map]: between [formula] and [formula], and between [formula] and [formula], both related to the change of the ground state character expected from the Gomer-Noyes mechanism.

After locating the regions where two adiabatic excited state curves switch their characters, we can plot the adiabatic singlet states again, with the curves for the various excitations 're-connected' based on their transition origins, as shown in Fig. [\ref=fig:reconPES]. State labels of 1(n,3pz), 1(n,3s) and 1(n,[formula]) are based on the symmetry at the CCO=[formula] geometry and propagated to other geometries based on the connection of the states.

It then becomes clear that population of the S'3 state at CCO=[formula] can directly lead to a crossing between S0 and S1. The energy decreases monotonically along with the widening CCO angle, which will result in a rapid ring opening reaction. This is consistent with the previous excited states MD study[\cite=TT08] which found that the population of the 1(n,3pz) state would facilitate the occurrence of ring opening process. If the 1(n,3s) state is populated instead, it has to overcome an energy barrier to a widening of CCO angle before meeting a crossing with the 1(n,3pz) state which can then lead to the ring opening of oxirane. Thus, this chemical process is more difficult and would produce a lower quantum yield. We identify that the ground state is re-populated from the 1(n,3pz) state after oxirane passing the critical point between [formula] and [formula].

Meanwhile, passing the critical point between [formula] and [formula] leads to another change of ground state character, which corresponds to a proton transfer process producing acetaldehyde, the product in the 3rd stage of the Gomer-Noyes mechanism (Fig. [\ref=fig:GN_pic]). This is also consistent with the MD study[\cite=TT08] finding that the proton shift occurs after the oxirane has been de-excited to the ground state. Under thermally elevated conditions this proton shift will likely occur at lower CCO angles: here we address only the quasistatic constrained geometries. A follow-up reaction breaking the C-C bond, the final stage in Fig. [\ref=fig:GN_pic], would then be possible while remaining in the ground state, given an appropriate combination of internal motion[\cite=TT08].

To demonstrate the chemical composition of these transitions, a decomposition of NTO1-H and NTO1-E into natural bond orbitals for the first three excitations at CCO=[formula] is shown in Table [\ref=tab:QNTOinfo60]. The AO basis used for generating NBOs is fairly large, producing 525 NBOs, but these are mostly of Rydberg (RY[formula]) type. In practice, the lone-pair (LP) and bonding (BD) NBOs describe the majority of the NTO1-H excitation, which in all three cases is well-described by just five main NBOs. For the NTO1-E orbitals of the three excitations, however, a substantial contribution comes from RY[formula] orbitals, which are highly dependent on the AO basis set used in generating NBOs. The LP and BD NBOs for NTO1-H, and the most relevant BD[formula] NBOs for NTO1-E are shown in Fig. [\ref=fig:NBOs].

Trans-2,3-Diphenyloxirane

In this subsection we focus on a significantly larger system, the trans-2,3-diphenyloxirane molecule, which contains the same CCO subsystem as oxirane as its central motif. We show that we can use the QNTO method to compare the excitations with those of an oxirane molecule. As would be expected, molecules with different physical/chemical environments can have distinct properties. For example, aryl substitution of oxirane can lead to a different ring opening mechanism[\cite=FF09]. The fact that the trans-2,3-diphenyloxirane, referred to as the system (Sys) molecule, is formed by two aryl substitutions on oxirane makes it a good example for examining the influence of chemical environment on the excitations of the core oxirane moiety using TDDFT/QNTO.

The structure of the Sys-molecule is first fully optimised without constraints. A equivalent geometry for the oxirane molecule, referred to as the reference (Ref) molecule, is then extracted from the optimised Sys-molecule by replacing the two aryl substitutents with hydrogen atoms and optimising the C-H bond lengths, at fixed bond angles (Fig. 11). The widespread problem that the energy of charge-transfer excitations is underestimated by local density functionals such as the LDA[\cite=DH05] means in this case that we expect to find large numbers of charge-transfer excitations in the energy window of interest. In practice we find we need to calculate up to 100 excitations of the Sys-molecule so that the highest (100th) excitation energy calculated, 7.74 eV, exceeds the energy of the 8th excitation of the Ref-molecule (7.61 eV), which was the highest Ref-excitation studied in the current work.

The NTO1-H and NTO1-E orbitals for the excitations of Sys-molecule (Sys-excitations) and Ref-molecule (Ref-excitations) are then compared to each other to see if similar excitations can be identified between the first 8 Ref-excitations and the first 100 Sys-excitations. This is achieved by constructing, for each NTO1-H(E), a renormalised orbital based on just the component of each on the local orbitals of the 5 atoms common to both geometries (the oxirane core). We denote the NTO1-H(E) orbital of a Sys-excitation as |〉, and the corresponding core orbital cNTO1-H(E) in the form |〉. Similarly, we define |〉 and |〉 for the Ref-molecule. The |〉 orbtitals are the NTO1-H(E) orbitals of the original reference oxirane geometry, whereas |〉, |〉, and |〉 are constructed via a similar procedure to that used in constructing the projections of the previous section.

In particular, constructing |〉 and |〉 requires a translation of the NTO1-H(E) from the Sys-molecule geometry to the Ref-molecule geometry. Using NTO1-H as an example, the set below are constructed:

[formula]

followed by renormalisation as in Eq. [\ref=eq:renormal] to obtain |〉, |〉, and |〉, respectively. The "s→  r" in Eq. [\ref=eq:s_sc] denotes that the orbital is translated from the Sys-molecule to the Ref-molecule. [formula] and [formula] are defined by setting respectively the coefficients [formula] and [formula] in Eq. [\ref=eq:NTOinNGWFs] to zero for those NGWFs not centred on the core atoms; the subscript 's' for Sys-excitations and 'r' for Ref-excitations indicate that the original NGWF coefficient matrices have been used.

By evaluating the overlap 〈|〉 between an NTOn-H or NTOn-E orbital of the Sys-molecule and the corresponding NTO of the Ref-molecule, one can then tell whether there is a strong overlap of the character in the core region. In addition, the overlaps 〈|〉 and 〈|〉 allow one to determine how large a proportion of the total excitation is accounted for by the component within the core region.

In the general cases where excitations are dominated by the NTO1, one can then say that the two excitations from different molecules are similar if the following three conditions hold: (1) a Sys-excitation must have a substantial 〈|〉 for both NTO1-H and NTO1-E, (2) a Ref-excitation must have a substantial 〈|〉 for both NTO1-H and NTO1-E, and (3) the magnitude of 〈|〉 must be large.

We find that of all the 100 excitations of the larger system, there are 16 whose cNTO1-H and cNTO1-E respectively match with the cNTO1-H and cNTO1-E of one or more Ref-excitations. We choose a threshold of [formula] for both cNTO1-H and cNTO1-E. Overall there are 20 matching combinations, as some excitations overlap significantly with several excitations of the reference system. The 1st, 2nd, 4th, and 8th Ref-excitation are involved in these matching pairs.

If the threshold is lowered to [formula], the number of involved Sys-excitations becomes 25 and the number of matchings becomes 35. The 3rd and 7th Ref-excitation also now match with some Sys-excitations. All the 35 excitation matchings are listed in Table [\ref=tab:Trans-Oxi].

In Table [\ref=tab:Trans-Oxi], we see that [formula] for both NTO1-H and NTO1-E of the 1st-6th and 8th Ref-excitation. As for 〈|〉, of all the involved 25 Sys-excitations discussed above only the 34th Sys-excitation (hereafter denoted as Sys-34) satisfies [formula] for both NTO1-H and NTO1-E. In other words, for the remaining 24 Sys-excitations there are [formula] density contributions of NTO1-H and/or NTO1-E which come from outside of the core region. This would be unsurprising as there remain 22 atoms outside of the core region compared to 5 atoms in the core, and the de-localisation of the density contribution for many Sys-excitations is anticipated. If we lower the threshold to [formula] for both NTO1-H and NTO1-E, the Sys-37 and 44 also fall into the set. Some excitation properties of the Sys-34, 37, and 44 along with two more excitations, Sys-71 and 81, respectively for comparing with the Ref-08 and Ref-03, are listed in Table [\ref=tab:Trans-Oxi2] and the NTO1-H(E) orbitals plotted in Fig. [\ref=fig:Diphenyloxirane]. It can be seen in Table [\ref=tab:Trans-Oxi2] that the NTO1 transition vector component, [formula], has generally decreased for the larger-sized Sys-molecule, although the NTO1 still accounts for at least 60% density contribution.

In Fig. [\ref=fig:Diphenyloxirane] we see that the NTO1-H orbitals are essentially the same for the first 7 Ref-excitations. Moreover, the core parts of the Sys-excitations, Sys-34, 37, 44, and 81, fully coincide with the core parts of this NTO1-H orbital shared by the first 7 Ref-excitations, namely, |〈|〉| = 1.00. The differences between Sys-excitations and Ref-excitations mainly come from the more diffuse NTO1-E orbitals.

Strictly speaking, only the Sys-34 has a significant orbital component of NTO1-E coming from the core region, namely [formula]. In Table [\ref=tab:Trans-Oxi2], it can be seen that the Sys-34 has an excitation energy that is close to those of the Ref-02 and Ref-04. The oscillator strength of Sys-34 also falls in between those of the Ref-02 and Ref-04. As for the orbital shape, the NTO1-E of the Sys-34 in Fig. [\ref=fig:Diphenyloxirane] appears to be a mix between those of the Ref-02 and Ref-04, also reflected by a substantial |〈|〉| for both the Ref-02 and Ref-04.

The other Sys-excitations have a high proportion of NTO1-H and/or NTO1-E on the region outside the core, so comparing these Sys-excitations with the Ref-excitations would be misleading. In fact, the excitation energy can be close, as between the Ref-04 and Sys-44, or significantly different as between the Ref-03 and Sys-81. Nevertheless, the energies of similar-core excitations between the Sys- and Ref-molecule still fall reasonably close to each other, given the wide ranges of Sys- and Ref-excitation energies, i.e. 4.85-7.74 eV for the Sys-molecule and 6.04-7.61 eV for the Ref-molecule. Hence, the present method has been able to locate similar excitations of the two molecules among numerous other excitations, by appropriately tuning the thresholds of 〈|〉, 〈|〉, and 〈|〉.

It would be interesting to perform a similar study, and its ring opening reaction, using self-interaction error corrected or reduced functionals such as range-separated ones [\cite=CH08] [\cite=LCGH11] in the near future[\cite=DHS13]. For reducing charge-transfer contamination to local excitations, using some technique to confine electronic transitions to a small spatial range to counteract the de-localisation error from the LDA may also be a feasible approach.

Conclusions and future work

In this work we have developed QNTO analysis based on a non-orthogonal basis, as implemented in the linear-scaling DFT/TDDFT code ONETEP. We use the QNTO method to analyse the transition vectors of electronic excitations of various molecular systems offered by TDDFT calculations.

We first studied the photo-induced ring-opening process of the oxirane molecule. Through a ground state scan along the reactive CCO angle of an oxirane molecule followed by TDDFT calculations (vertical excitations), a profile of several low-lying adiabatic excited state curves on which the excited state driven reaction may be carried can be constructed. However, these adiabatic excited state curves ranked by energies do not give us very much knowledge on how the reaction will proceed. We stress that the reaction process can be made much clearer if the excited state potential energy curves are labelled according to their excitation character instead of their energies. We demonstrated that the transition vectors of these low-lying excitations are dominated by the first NTO electron-hole pair (NTO1), and therefore the transition origins of NTO1 can be used to represent the character of these excitations. Based on this approach, we have successfully located several special geometrical points along the scanned CCO coordinate where the transition origins of two adiabatic excited state curves switch. By reconnecting the adiabatic excited state energy points (calculated by TDDFT) based on transition origins instead of energetic ordering, we are then able to depict how the excited state-driven ring-opening process can proceed. This picture is consistent with the previous excited state molecular dynamics study that found that the population of the 1(n,3pz) state facilitates the ring-opening process, while the population of 1(n,3s) state does not. We have demonstrated that the 1(n,3pz) state exhibits a monotonically-decreasing energy curve along the widening CCO angle, leading to a ring-opening reaction. For more complicated reactions with several coordinates involved and geometry strongly distorted, more geometries may be used, e.g. those from an excited state scan and molecular dynamics simulation, to help identify the photo-driven reaction pathways of interest. A promising future direction could be to apply this methodology to larger molecules with much more complex reaction pathways.

QNTO analysis has also been employed to study an aryl-substituted oxirane, the trans-2,3-diphenyloxirane molecule. The results demonstrate that the approach can be used to identify specific excitations among a large number of other excitations of a large/complex molecular system. By comparing the excitations of this larger molecule to those of oxirane, we have shown that a small number of mutually similar excitations can be identified and compared between the two molecules. The matching conditions that define similar excitations can be tuned by the magnitudes of: (1) the projection result of the core orbitals, cNTO1-H(E), between Sys-excitations and Ref-excitations; (2) the proportion of the cNTO1-H(E) accounting for the whole NTO1-H(E) in the Sys-excitation; (3) the proportion of the cNTO1-H(E) accounting for the whole NTO1-H(E) in the Ref-excitation. For example, a Sys-excitation can have a similar cNTO1-E to that of a Ref-excitation, but the cNTO1-E of the Sys-excitation only accounts for a tiny proportion to the whole NTO1-H(E) of Sys-excitation. In such a case, the orbital-section of the NTO1-E of Sys-excitation coming from outside of the core region cannot be ignored and the two excitations can not be assigned as similar excitations. The same approach for finding similar excitations through the transition origins would be particularly powerful when there are numerous excitations in a large molecular system. For example, those excitations that are located in a specific geometric region can be readily identified, helping to analyse the chemical properties of that region in a specific energy range of light absorption.

Acknowledgement

The authors would like to thank Louis Lee for very helpful discussions. All calculations in this work were carried out using the Cambridge HPC Service under EPSRC Grant EP/J017639/1. JHL acknowledges the support of Taiwan Cambridge Scholarship. TJZ acknowledges the support of EPSRC Grant EP/J017639/1 and the ARCHER eCSE programme. NDMH acknowledges the support of the Winton Programme for the Physics of Sustainability.