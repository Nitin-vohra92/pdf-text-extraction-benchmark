Theorem

DIFFERENCE SETS AND SHIFTED PRIMES

Introduction

For a set of integers A we denote by A - A the set of all differences a - a' with a and a' in A, and if A is a finite set we denote its cardinality by |A|. Sárközy [\cite=Sarkozy1] proved, by the Hardy-Littlewood method, that if A is a subset of [formula] such that A - A does not contain a perfect square, then

[formula]

This estimate was improved by Pintz, Steiger and Szemerédi [\cite=PSS] to

[formula]

This improvement was obtained using the Hardy-Littlewood method together with a combinatorial result concerning sums of rationals. Balog, Pelikán, Pintz and Szemerédi [\cite=BPPS], elucidating the method in [\cite=PSS], proved for any fixed integer k  ≥  2, that if A is a subset of [formula] such that A - A does not contain a perfect k-th power, then

[formula]

In the works cited above the following basic property is used; if s is a perfect k-th power then so is qks for every positive integer q. This multiplicative property is used in the following fashion: Suppose that B is a set of integers and A  =  {c + qkb:b∈B} for some integers c and q  ≥  1, if A - A does not contain a perfect k-th power, then the same is true for B - B. This deduction is the basis of an iteration argument that plays a fundamental rôle in [\cite=BPPS], [\cite=PSS], and [\cite=Sarkozy1].

Sárközy [\cite=Sarkozy3] also considered the set [formula] of shifted primes, and showed that if A is a subset of [formula] such that A - A does not contain an integer from S then

[formula]

The argument Sárközy used in [\cite=Sarkozy1] cannot be applied directly to the set S of shifted primes since it does not have a multiplicative property analogous to the one possessed by the set of perfect k-th powers. Sárközy got around this difficulty by not only considering the set S of shifted primes, but also the sets defined for each positive integer d by

[formula]

In [\cite=Sarkozy3] Sárközy uses an iteration argument based on the following observation. Suppose B is a set of integers and A  =  {c + qb:b∈B} for some integers c and q  ≥  1, if A - A does not intersect Sd for some positive integer d, then B - B does not intersect Sdq.

In this article we show that the combinatorial argument presented in [\cite=BPPS] and [\cite=PSS] can be carried out to improve Sárközy's result on the set S of shifted primes. We shall prove the following.

The set of perfect squares and the set S of shifted primes are examples of intersective sets. To define this class of sets we introduce some notation. Given a set of positive integers H we define D(H,n), for any positive integer n, to be the maximal size of a subset A of [formula] such that A - A does not intersect H. A set of positive integers H is called intersective if D(H,n)  =  o(n).

Kamae and Mendès France [\cite=Kamae_&_MendesFrance] supplied a general criterion for determining if a set of positive integers is intersective. From their criterion they deduced the following.

For any fixed integer a the set [formula] is intersective if and only if a  =    ±  1.

Let h be a nonconstant polynomial with integer coefficients and whose leading coefficient is positive. The set {  h(m)  :  m  ≥  1,h(m)  ≥  1  } is intersective if and only if for each positive integer d the modular equation [formula] has a solution.

Let h be a polynomial as in (II) with degree k  ≥  2 and such that [formula] has a solution for every positive integer d. The author [\cite=Lucier] has shown that if A is a subset of [formula] such that A - A does not intersect {  h(m)  :  m  ≥  1,h(m)  ≥  1  }, then |A|  ≪  n( log 2n)μ / (k - 1)( log n)- (k - 1), where μ  =  3 if k = 2 and μ = 2 if k  ≥  3. It is possible to improve this result with the method presented in this paper.

Preliminary lemmata

In this paper we use the following notations. For a real number x we write e(x) for e2πix, and

[formula]

defined by

[formula]

If θ is a positive number such that

[formula]

then there exists an arithmetic progression P in [formula] with difference q such that

[formula]

This closely resembles Lemma 20 in [\cite=Lucier] and can be proved in the same manner.

We now state a combinatorial result presented by Balog, Pelikán, Pintz and Szemerédi in [\cite=BPPS], the proof of which uses only elementary techniques. It is this result, that we use in Lemma [\ref=lemma_nonuniform], that allows us to improve Sárközy result on the set S of shifted primes.

Let K and L be positive integers, and let τ be the maximal value of the divisor function up to KL. Let K be a nonempty subset of rationals such that if a / k∈K is in lowest terms then 1  ≤  a  ≤  k  ≤  K. Suppose that for each a / k∈K there corresponds a subset of rationals La / k such that if b / l∈La / k is in lowest terms then 1  ≤  b  ≤  l  ≤  L. Suppose further that B and H are positive integers such that

[formula]

and

[formula]

Then the size of the set

[formula]

satisfies

[formula]

This is Lemma CR in [\cite=BPPS].

Exponential sums over primes

Let d and n denote positive integers. As in [\cite=Sarkozy3], our application of the Hardy-Littlewood method employs exponential sums over numbers from the set Sd defined in the introduction. For any real number α we set

[formula]

In this section we present some estimates related to Sn,d(α). Throughout this section we assume d and n satisfy

[formula]

For n sufficiently large,

[formula]

By the definition of Sd we find that

[formula]

Since d  ≤   log n the Siegel-Walfisz theorem says that this sum is asymptotic to (dn + 1) / φ(q), from which the result follows.

The next two lemmas provide estimates of S(α) derived by A. Sárközy.

Let a and b be integers such that (a,b) = 1 and 1  ≤  b  ≤   log n. There exists a positive real number c such that if α is a real number that satisfies and n is sufficiently large, then furthermore, if α  ≠  a / b then

This is a restatement of Lemma 5 from [\cite=Sarkozy3].

Let R denote a real number that satisfies

[formula]

For integers a and b such that (a,b) = 1 and 0  ≤  a  ≤  b  ≤  R we set

[formula]

Let [formula] denote the set of real numbers α for which there do not exist integers a and b such that (a,b) = 1, 1  ≤  b  <  R , and [formula].

For [formula] and large n,

[formula]

This is a restatement of Lemma 9 from [\cite=Sarkozy3].

Let a and b be integers such that 0  ≤  a  ≤  b  ≤  R and (a,b) = 1. Then for n sufficiently large

[formula]

Suppose that [formula]. Then and since b  ≤  R  ≤   log n we can, for large enough n, apply Lemma [\ref=majorestimates] with α replaced by t / n.

Let u and v be integers such that

[formula]

Applying Lemma [\ref=majorestimates] we obtain

[formula]

For [formula] with t / n  <  u / n, Lemma [\ref=majorestimates] implies

[formula]

Therefore

[formula]

Similarly

[formula]

The result follows.

A multiplicative arithmetic function f is called strongly multiplicative if f(pk)  =  f(p) for every prime p and positive integer k. The next lemma contains a standard deduction on the average order over arithmetic progressions for certain strongly mutliplicative arithmetic functions.

Let x be a real number such that x  ≥  1, and let d and r be positive integers. If f is a strongly multiplicative arithmetic function such that f(m)  ≥  1 for every positive integer m and f(p)  =  1  +  O(p- 1). Then

[formula]

Let g be the arithmetic function defined by

[formula]

where μ is the Möbius function. Using the fact that f is strongly multiplicative we deduce that

[formula]

Since f(m)  ≥  1 for every positive integer m it follows that g is a non-negative valued arithmetic function. By the Möbius inversion formula [formula], therefore The last sum above is zero if [formula] and at most x(d,k) / (dk) if (k,d)|r. This implies, since g is a non-negative valued function, that

[formula]

For positive integers u and v it can be verified that g(uv)  ≤  g(u)g(v), thus

[formula]

Since f(p)  ≥  1 and f(p)  =  1  +  O(p- 1) the previous product is bounded from above by the absolutely convergent infinite product [formula]. Therefore

The next lemma is analogous to Proposition 11 of Green [\cite=Green].

By Gallagher's inequality [\cite=Montgomery] we have

[formula]

where Sd,n'(α) is the derivative of Sd,n(α) with respect to α. By Hölder's inequality

[formula]

Let rd(m) denote the number of pairs (p1,p2) where p1 and p2 are primes such that [formula] and

[formula]

By Parseval's identity,

[formula]

and

[formula]

From the above we deduce that

[formula]

For each positive integer m we have

[formula]

To bound rd(m) we apply the combinatorial sieve to estimate the size of the set above. In particular, Corollary 2.4.1 of [\cite=Halberstam_&_Richert] implies

[formula]

Note that

[formula]

therefore

[formula]

This implies

[formula]

Let f(u)  =  (u / φ(u))2. It can verified that f is a strongly multiplicative arithmetic function such that f(u)  ≥  1 for every positive integer u and f(p)  =  1  +  O(p- 1). Thus, we can apply Lemma [\ref=average_order] to obtain

[formula]

Therefore

[formula]

and thus, on account of ([\ref=bridge]), the result follows.

A density increment

Throughout this section n denotes a positive integer and A a subset of [formula]. For any real α we set

[formula]

We denote by C1 a fixed positive constant. This constant will be used throughout the rest of the paper. We will need C1 to be sufficiently large, but it should be noted that the size of C1 will never be determined by n or A. Let δ denote the density of A, that is, |A|  =  δn. The following parameters are defined in terms of C1 and δ.

[formula]

[formula]

[formula]

[formula]

With R = R(δ) we let [formula] be defined as in ([\ref=major_arc]), and for any positive integer q  ≤  R we set

[formula]

Let d be a positive integer such that d  ≤   log n. Suppose that A - A does not intersect Sd and that

[formula]

Provided C1 and n are sufficiently large there exists a positive integer q  ≤  R(δ) such that

[formula]

Here we adopt the method used in [\cite=BPPS]. Given any positive integer λ we make the following definitions. For integers a and k, with k  ≥  1, we define

[formula]

and for real numbers K,U  ≥  1 we define

[formula]

Furthermore, we set

[formula]

and

[formula]

Let Kλ and Uλ denote a pair for which μλ takes its maximum. As K = U = 1 is considered in the definition of μλ we have

[formula]

It follows that

[formula]

For each λ  ≤  Λ we want that the intervals [formula] with k  ≤  Qλ to be pairwise disjoint. It can be verified that this will happen if

[formula]

To show this is true we estimate λ, R, and Qλ for λ  ≤  Λ. By ([\ref=definition_of_Lambda]) and ([\ref=size_constraint]) we deduce that

[formula]

By ([\ref=definition_of_Lambda]) we find that 2λ  ≤  ( log  log C1δ- 1)3 / 4, and thence by () and () we find that

[formula]

By ([\ref=definition_of_R]) this implies log Qλ  ≤   log R, and so

[formula]

By ([\ref=definition_of_R]) and ([\ref=size_constraint]) we find, for n large enough, that

[formula]

From the above estimates for λ, R, and Qλ we deduce that ([\ref=wish]) holds for sufficiently large n. Therefore, when λ  ≤  Λ we have

[formula]

So

[formula]

Let us assume, to obtain a contradiction, that

[formula]

By using Lemma [\ref=lemma_CR] and ([\ref=assumption]) we will show, provided C1 and n are sufficiently large, that

[formula]

Assuming for now that ([\ref=target]) holds we show how a contradiction is obtained, thus proving that the assumption ([\ref=assumption]) is false. Since μ1  ≥  1, it follows from ([\ref=target]) that μΛ + 1  ≥  θ(δ)- (1 / 2)Λ, and thus by ([\ref=mu_ineq2]) we have

[formula]

We can take C1 to be large enough so that ([\ref=definition_of_Lambda]) implies Λ  ≥  (1 / 4) log 3C1δ- 1, then by ([\ref=definition_of_theta]) we find that

[formula]

a contradiction. Therefore ([\ref=assumption]) cannot hold for all 1  ≤  q  ≤  R.

We now proceed to show that ([\ref=target]) holds. To that end, let us fix λ with 1  ≤  λ  ≤  Λ. For now we also fix a rational a / k in Pλ(Uλ,Kλ). We associate with a / k a fraction [formula] such that |F(u / n)|  ≥  |A| / Uλ. Such a u / n exists by the way a / k was chosen.

Since A - A contains no integers from Sd we find that

[formula]

By the triangle inequality, Lemma [\ref=Siegel_Walfisz], and the way u / n was chosen we find that

[formula]

Set

[formula]

and let N denote the set of t / n such that |F(t / n)|  ≤  |A| / Y. By two applications of the Cauchy-Schwartz inequality, Parseval's identity, and Lemma [\ref=sumfourthpowers] we find that

[formula]

Now

[formula]

Therefore

[formula]

By ([\ref=chain]) and ([\ref=definition_of_Y]) we find that

[formula]

thus

[formula]

Let N1 denote the set of t / n such that |F1(u / n + t / n)|  ≤  |A| / Y. By the same reasoning used in the deduction of ([\ref=small_contribution_0]) we find that

[formula]

For λ  ≤  Λ we have Qλ + 1 / Qλ  <  R. Indeed, ([\ref=definition_of_Lambda]) and ([\ref=Ql]) imply

[formula]

Let [formula] denote the union of the [formula] with Qλ + 1 / Qλ  ≤  q  ≤  R. By the Cauchy-Schwartz inequality we find that

[formula]

We are now going to show that

[formula]

Suppose that [formula], then [formula] for some integers a and q such that 0  ≤  a  ≤  q, (a,q) = 1, and Qλ + 1 / Qλ  ≤  q  ≤  R. Since q  ≤  R  ≤   log n, we deduce from Lemma [\ref=majorestimates] that

[formula]

Using the well-known estimate

[formula]

(see for example [\cite=Hardy_&_Wright]), we obtain

[formula]

The lower bound on q implies

[formula]

By ([\ref=Ql]) we have Qλ + 1 / Qλ  =  QλQ1  =  Q2λ1, thus

[formula]

Using ([\ref=definition_of_Q1]) and ([\ref=definition_of_Lambda]) we find that λ  ≪   log  log Q1, by this and ([\ref=chain]) we obtain

[formula]

Using ([\ref=definition_of_Q1]) we find, by taking C1 large enough, that

[formula]

and thus

[formula]

From ([\ref=v7]) and the subsequent estimates we obtain

[formula]

Since [formula] is arbitrary ([\ref=v6]) and ([\ref=v11]) imply that ([\ref=super]) is true. By ([\ref=minortrick1]) and ([\ref=super]) we have

[formula]

The contribution to the sum in ([\ref=start]) coming from the terms with [formula] can similarly be bounded. By the Cauchy-Schwartz inequality and Lemma [\ref=minorestimate] we find that

[formula]

Since R  ≥  Qλ + 1 / Qλ the argument used the previous paragraph implies

[formula]

Let [formula] be the set of [formula] with t / n  ≠  0 such that

[formula]

By ([\ref=small_contribution_0]), ([\ref=small_contribution_1]), ([\ref=minorstar_contribution]), and ([\ref=minor_contribution]) it follows for C1 large enough that

[formula]

Since d  ≤   log n we can apply Lemma [\ref=sumovermajorarc] to the inner sum above to obtain

[formula]

Let L(L,V,W) denote the set of reduced fractions b / l∈[0,1] such that

[formula]

[formula]

[formula]

For b / l∈L(L,V,W), we have

[formula]

by ([\ref=phi_estimate]). Therefore

[formula]

where L runs through all the powers of 2 in the interval

[formula]

. There must exist a triple (L,V,W) of such indices such that

[formula]

We associate this triple with a / k.

The number of possible triples (L,V,W) is ≪   log (Qλ + 1 / Qλ)( log Y)2, which by ([\ref=okay]) and ([\ref=definition_of_Y]) is ≪  ( log R)3. Therefore there exists a subset K  ⊂  Pλ, satisfying

[formula]

such that for each a / k∈K we associate the same triple, say (L,V,W).

Let a / k∈K, then together with the associated fraction [formula], we associate a set La / k of rationals b / l, 0  ≤  b  ≤  l, (b,l) = 1, L / 2  ≤  l  ≤  L, such that

[formula]

[formula]

[formula]

Set

[formula]

Let us estimate the cardinality of Q. Since L  ≤  Qλ + 1 / Qλ  ≤  R, assumption ([\ref=assumption]) and ([\ref=dm2]) imply

[formula]

So that

[formula]

Lemma [\ref=lemma_CR] then implies

[formula]

From ([\ref=chain]) and ([\ref=okay]) we obtain log Kλ  ≤   log R, by this and ([\ref=size1]) it follows that

[formula]

Note that Q is a subset of (0,2]. Let [formula] and [formula]. Let us assume without loss of generality that |Q1|  ≥  (1 / 2)|Q|. If this is not the case, then |Q2|  ≥  (1 / 2)|Q|, and we can replace Q1 in the argument below by the rational numbers in Q2 shifted to the left by 1. Since |Q1|  ≥  (1 / 2)|Q| we see that ([\ref=road]) is still valid with Q replaced by Q1

Let r / s  =  a / k  +  b / l be in Q1. For [formula] and [formula] we have

[formula]

and therefore [formula]. Thus, by ([\ref=dm3]) we deduce that

[formula]

We now estimate the size of the denominator of r / s. Certainly s  ≤  kl  ≤  KλL. By ([\ref=chain]) we have Kλ  ≤  Qλ and L was chosen to satisfy L  ≤  Qλ + 1 / Qλ. Therefore s  ≤  Qλ + 1 whenever r / s∈Q1. By this and ([\ref=trans]) we obtain

[formula]

By ([\ref=road]), with Q replaced by Q1, and ([\ref=inside]) we find that

[formula]

This implies

[formula]

We now estimate τ the maximum of the divisor function up to KλL  ≤  Qλ + 1. If d(m) is the number of divisors of m then

[formula]

(see [\cite=Hardy_&_Wright]). Thus, by ([\ref=Ql]), we have

[formula]

and since λ  ≤  Λ we deduce from ([\ref=definition_of_Q1]) and ([\ref=definition_of_Lambda]) that

[formula]

It follows from ([\ref=definition_of_theta]) that

[formula]

We also find from ([\ref=definition_of_R]) and ([\ref=definition_of_theta]) that

[formula]

Since θ(δ)- 1 tends to infinity as C1δ- 1 tends to infinity, we deduce from ([\ref=inc1]), ([\ref=appx1]), and ([\ref=appx2]) that for C1 sufficiently large

[formula]

Since λ  ≤  Λ was arbitrary ([\ref=target]) is true, and as shown earlier the lemma can be deduced from this.

We now derive a density increment argument that will be iterated in the next section to prove our theorem.

Let d be a positive integer such that d  ≤   log n. Suppose that A - A does not intersect Sd and that δ, the density of A, satisfies ([\ref=size_constraint]). Provided C1 and n are sufficiently large there exist positive integers d' and n', and a subset A' of [formula] of size δ'n', such that A' - A' does not intersect Sd', and moreover;

[formula]

[formula]

By the hypotheses Lemma [\ref=lemma_nonuniform] implies there exists a positive integer q  ≤  R(δ) such that ([\ref=arith_nonuniform]) is true. With this q and U = R(δ) /  log  log R(δ) let E be defined as in Lemma [\ref=bump]. Note that [formula]. The inequality ([\ref=R_home]) is still valid, thus 2πqU  ≤  2πR(δ)2  ≤  n for sufficiently large n. Therefore, we can apply Lemma [\ref=bump] with θ  =  θ(δ) to deduce that there exists an arithmetic progression P with difference q such that

[formula]

and

[formula]

Let n'  =  |P|. Then there exists an integer c and subset A' of [formula] such that [formula]. Put d'  =  dq. Since A - A does not intersect Sd, we deduce that A' does not intersect Sdq. Let the size of A' be δ'n'. Then ([\ref=lu2]) implies

[formula]

To finish we need to estimate n' and d'. Since q  ≤  R(δ) we find by ([\ref=lu1]) and for C1 large enough that n'  ≥  R(δ)- 2n, and clearly, n'  ≤  n. Now, again by the fact that q  ≤  R(δ), we obtain q  ≤  d'  =  dq  ≤  R(δ)q. This completes the proof.

Proof of the Theorem

Let us assume, for a contradiction, that the theorem is false. Then for C1 and n sufficiently large, there exists a subset A of [formula] of size δn, such that A - A does not intersect S and

[formula]

Set

[formula]

and put d0  =  1, n0  =  n, A0  =  A, and δ0  =  δ. By using Lemma [\ref=crank] repeatedly we can show that for each integer k, with 1  ≤  k  ≤  Z, there are integers dk and nk and a subset Ak of [formula] of size δknk such that Ak - Ak does not intersect Sdk. Moreover, dk, nk, and δk satisfy

[formula]

[formula]

Since d0 = 1 and n0 = n, these estimates imply

[formula]

Let us show that we can actually perform this iteration Z many times. Let 0  ≤  l  ≤  Z - 1, and suppose that we have performed this iteration l many times. To show that Lemma [\ref=crank] can be applied a (l + 1)-th time we need to show that nl is sufficiently large, dl  ≤   log nl, and that ([\ref=size_constraint]) is satisfied with δ replaced by δl.

We begin by estimating nl. By ([\ref=powertrio]) we obtain

[formula]

Since l  <  Z, ([\ref=definition_of_R]) and ([\ref=definition_of_Z]) imply

[formula]

By ([\ref=hyp]) we obtain

[formula]

for large enough n. By ([\ref=definition_of_theta]) and ([\ref=hyp]) we find, for n and C1 sufficiently large, that

[formula]

(Here we used that ( log x)( log 3x)- 1 is eventually increasing.) Therefore

[formula]

From the above we deduce, for n and C1 large enough, that

[formula]

Therefore, by ([\ref=estimate_of_nk]),

[formula]

and so

[formula]

for l  <  Z. This shows that by taking n to be arbitrarily large, the same is true for nl.

We now show that dl  ≤   log nl. By ([\ref=powertrio]) we have log dl  ≤  l log R(δ), and thus by ([\ref=peq2]) we obtain log dl  ≤  (1 / 2) log 2n. For large n this implies

[formula]

by ([\ref=peq3]).

We leave it to the reader to verify that ([\ref=hyp]) and ([\ref=peq3]) imply, for n and C1 sufficiently large, that ([\ref=size_constraint]) is satisfied with δ and n replaced by δl and nl respectively. Finally, since Al  -  Al does not intersect Sdl we can apply Lemma [\ref=crank] to obtain the desired outcome.

Since ([\ref=powertrio]) is true with k = Z we find that

[formula]

Since 8- 1θ(δ)  <  1, this implies

[formula]

(Here we used log (1 + x)  ≥  x / 2 for 0  ≤  x  ≤  1.) For C1 large enough Z  ≥  32θ(δ)- 1 log C1δ- 1, thus

[formula]

This implies δZ  >  1, a contradiction, since by definition δZ  ≤  1. This contradiction establishes the theorem.

acknowledgements

The author was supported by a postdoctoral fellowship from the Centre de recherches mathématiques at Montréal.