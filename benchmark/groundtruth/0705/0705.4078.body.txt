Lemma Corollary Fact Proposition Claim Example Remark Definition Question

On canonical bases and internality criteria

Introduction

This paper is concerned with analysability and internality in the context of stable theories of finite rank. While we will briefly recall these notions at the end of this introduction, we refer the reader to [\cite=pillay96] for details on geometric stability theory.

In the many sorted structure A of compact complex spaces, a space X will be an algebraic variety (or rather a Moishezon space) iff its generic type is internal to the sort of the projective line. Roughly speaking, Campana proves in [\cite=campana81] that if the space X is of Kähler-type and "algebraically connected" in the sense that there exists an analytic family of algebraic subvarieties of X such that any two points of the space X are connected by a finite sequence of algebraic subvarieties from this family, then X is itself algebraic.

We wanted to find a general model-theoretic treatment or at least analogue of this result, and this is what the current paper is about.

We work in a saturated model [formula] of a complete stable theory T of finite U-rank sort-by-sort. In general we will be concerned with types (over arbitrary small sets of parameters) of possibly infinite tuples that are contained in the algebraic closure of a finite tuple.

For p(x)∈S(A) a stationary type, the canonical base of p usually means (an enumeration of) the smallest definably closed subset A0 of [formula] such that p(x) does not fork over A0 and the restriction of p to A0 is stationary. It will be more convenient for us to consider (an enumeration of) the algebraic closure of A0, which we will denote by [formula] and also refer to as the canonical base. This abuse of notation is harmless since throughout this paper we will only be concerned with precision up to interalgebraicity. We will also write [formula] to mean [formula].

The following is a property that is conjectured to hold in all finite rank theories. Let [formula] be the set of all nonmodular minimal (stationary U-rank 1) types.

Canonical Base Property (CBP). If [formula] then [formula] is almost [formula]-internal.

The CBP is preserved by naming parameters.

The CBP is equivalent to the statement where one replaces [formula] by the set of all minimal types. The reason is that from Proposition 1.9 of [\cite=chatzidakis06] (see also  [\cite=pillay-cb]) we know that [formula] is already (almost) analysable in [formula], hence orthogonal to all modular minimal types.

The following definition is inspired by a related notion for cycle spaces of compact complex manifolds introduced by Campana in [\cite=campana81].

Suppose q(x,y),s(y),p(x)∈S(A) are stationary types. We say that q is a generating family for p over s if

[formula],

qb(x): = q(x,b) is stationary for [formula], and

if [formula] then [formula]

We call s the parameter space for the family, and qb the fibres, where [formula]. If s is algebraic then we say the family is trivial. A generating family is canonical if [formula] for [formula]. It is said to almost separate points of p if for any [formula] there are only finitely many other realisations of p that lie on all the same fibres as a.

Note that to be given a generating family for a stationary type [formula] is to be given a tuple b such that [formula], [formula] is stationary, and [formula] is stationary. The generating family is then canonical if [formula], and trivial if [formula] is algebraic.

If q almost separates points of p then [formula].

If q is a nontrivial canonical generating family with fibres of U-rank 1, then q almost separates points.

If p has a nontrivial canonical generating family then p is not 1-based.

Part (a) is clear.

For part (b) note that as [formula], condition (iii) of the definition implies that [formula]. Hence there exists [formula] realising [formula]. In particular [formula]. As [formula], we must have that [formula] is not a nonforking extension of both qb and qb', which implies by the rank hypothesis that [formula] is algebraic. So q almost separates points of p.

For part (c) note that if p is 1-based then [formula], and so by condition (iii), [formula]. That is, the family is trivial.

The following lemma justifies the term "generating family"; it says that if q is a generating family for p over s, and given independent realisations a and a' of p, one can get from a to a' by "moving along the fibres" of q over s. The lemma is due originally to Lascar  [\cite=Lascar] who stated it in the language of groups of automorphisms, but we give a proof for the sake of completeness.

The following are equivalent:

[formula]

For any [formula] independent of a over A, there exist [formula] and [formula] such that

[formula] and

[formula],

for all [formula].

We suppress the parameters A by naming them as constants to the language. Assume (i). By stationarity, in order to show (ii) it suffices to find some [formula] independent of a satisfying the desired properties. This is what we do. Define sequences [formula] and [formula] inductively so that

ai + 1 realises the nonforking extension of [formula] to abi

bi + 1 realises the nonforking extension of [formula] to aai + 1

Note that U(ai + 1,bi / a)  ≥  U(ai,bi / a). Indeed,

[formula]

Similarly, U(ai + 1,bi + 1 / a)  ≥  U(ai + 1,bi / a). So we get a sequence

[formula]

Hence, for some [formula] it must be the case that [formula]. It follows that

[formula]

That is, [formula] and so [formula] and a are independent over [formula]. On the other hand, [formula] and a are independent over [formula] by construction. So [formula]. But [formula] has the same type as ab, and [formula]. What we have shown is the following statement that we will use again later:

If [formula] and [formula] and [formula] satisfy (1) and (2), then there exists [formula] such that a is independent of [formula] over [formula].

In particular, [formula] and a are independent over the empty set. Setting [formula], we have shown (ii).

For the converse, suppose (ii) holds and let [formula] and [formula] be automorphisms such that σi(aibi) = ai + 1bi and τi + 1(ai + 1bi) = ai + 1bi + 1, for all [formula]. Hence, for each i, σi witnesses that [formula] and τi + 1 witnesses that [formula]. So [formula]. In particular, [formula]. But the independence of a and a' implies that the latter is [formula], as desired.

The purpose of this note is to prove the following theorem which is motivated by, and in part recovers, Campana's "algebraicity criteria" for compact Kähler manifolds (cf. Théorèmes  2 and 3 of [\cite=campana81]). It depends heavily on the results of Chatzidakis  [\cite=chatzidakis06].

Suppose that a stationary type p(x)∈S(A) has a generating family with a fibre that is almost internal to a nonmodular minimal type r.

Then r is nonorthogonal to A (and so every fibre of the generating family is almost internal to r) and p is almost analysable in r.

If moreover the CBP holds for T, then p is almost internal to r.

The rest of the paper is organised as follows. In Section [\ref=ccm] we elaborate on the connections between the notions presented here and the model theory of compact complex manifolds, in Section [\ref=cbpconsequences] we discuss a natural strengthening of the CBP which is true in compact complex manifolds and relate it to the work of Zoé Chatzidakis [\cite=chatzidakis06], and finally in Section [\ref=criteria] we prove Theorem [\ref=ample-by-moishezon=moishezon].

We end this introduction with a brief discussion of internality and analysability. If p(x)∈S(A) is stationary and [formula] is some family of partial types (over possibly differing sets) we say p is internal to [formula] or is [formula] -internal, if there is some C containing A and a realizing p independent from C over A, such that a is in the definable closure of C together with some realisations of some partial types in [formula] whose domains are contained in C. If we replace definable closure by algebraic closure we get the notion of p being almost internal to [formula]. We will be using this notion in at least two cases, first where [formula] is some [formula]-invariant family of minimal (stationary U-rank 1) types over varying domains, such as the family of all nonmodular minimal types, and second where [formula] is a single minimal type (over some set) q say. In the second case the hypothesis that p∈S(A) is almost internal to q implies that q is nonorthogonal to all of its conjugates over [formula] - that is, q is nonorthogonal to A. So almost internality of p to q is equivalent to almost internality of p to [formula] where [formula] is the family of conjugates of q over [formula].

We also have the standard notion of analysability; p(x)∈S(A) is analysable in [formula] if there are [formula] such that [formula] is internal to [formula] for [formula] and [formula]. So algebraic closure is built into the definition. We might also want to define almost analysability by only requiring that [formula] be almost internal to [formula] for [formula], and in this case we may as well require that an  =  a. Assuming that the family [formula] is [formula]-invariant, it is not hard to see that p(x)∈S(A) is almost analysable in [formula] iff p(x) is analysable in [formula]. As in the case of internality, if q is a minimal type nonorthogonal to A then almost analysability of p in q is equivalent to (almost) analysability of p in [formula] where [formula] is the family of conjugates of q over [formula].

Compact complex manifolds

Much of the discussion in the introduction - including the CBP, the notion of a generating family, as well as the statement of Theorem [\ref=ample-by-moishezon=moishezon] itself - is informed by certain aspects of the model theory of compact complex manifolds. In this section we aim to make these origins and connections precise. The material here is almost entirely of an expository nature. Let A denote the multi-sorted structure where there is a sort for each irreducible compact complex-analytic space and the language consists of a predicate for each complex-analytic subset of each finite cartesian product of sorts. The theory [formula] admits quantifier elimination and is, sort-by-sort, of finite Morley rank. A survey of some of the model theory of [formula] can be found in [\cite=moosa-ccs].

We work in a fixed sufficiently saturated elementary extension A' of A. Here it is more natural to work only with types of finite tuples. Since the theory is totally transcendental there will be no loss of generality in doing so. It may however lead to some (harmless) abuse of notation; for example, we will often write [formula] when we really mean a finite tuple whose algebraic closure is [formula].

Among the sorts of A we have the projective line [formula] in which the complex field is definable. In [formula] the interpretation of this sort is [formula] where [formula] is the corresponding elementary extension of the complex field.

The nonmodular minimal types in this theory are exactly those that are nonorthogonal to the generic type of the projective line (which is equal to the generic type of [formula]). Indeed, this follows from the truth of the Zilber dichotomy in [formula] via Zariski geometries plus the fact that the only infinite field definable in [formula] is [formula] (see Corollary 4.8 of [\cite=ret]). However, it also follows directly from a theorem of Campana [\cite=campana80] (due independently to Fujiki [\cite=fujiki82]) as observed by the second author in [\cite=pillay01]. We will discuss this theorem of Campana's later, as it is tied up with the issues we are concerned with in this paper. In any case, it follows that almost internality to the set of nonmodular minimal types coincides in this theory with almost internality to the generic type of the projective line. Moreover, as the following summarising fact describes, almost internality to the projective line has a very natural geometric meaning.

First some notation: given a tuple a from [formula] by the locus of a, denoted [formula], we mean the smallest complex-analytic set whose interpretation in [formula] contains a.

Suppose [formula] is a stationary type. Let [formula], [formula], [formula], and G  →  S and G  →  X the natural projections. Then the following are equivalent:

p is almost internal to the set of nonmodular minimal types.

p is almost internal to the projective line.

p is internal to the projective line.

After base change G  →  S is a Moishezon morphism: that is, for some complex-analytic space T over S, the fibred-product G  ×  ST bimeromorphically embeds into a projective linear space [formula] over T, where F is some coherent analytic sheaf on T.

For some complex-analytic space T̂ over S, the fibred-product G  ×  ST̂ bimeromorphically embeds into [formula] over T̂, for some n  ≥  0.

The equivalence of (c), (d), and (e) is Proposition 4.4 of [\cite=ret]. In the preceeding discussion we explained the equivalence of (a) and (b). It remains to prove that (b) implies (c). In the case when the tuple b comes from the standard model A this is stated in  [\cite=pillay2000] and boils down to the fact that if X is a Moishezon space and X' is another space such that there is dominant generically finite-to-one meromorphic map from X' to X, then X' is also Moishezon. To prove that (b) implies (c) in general we actually need a relative version of the above fact, which we now explain. If [formula] is almost internal to the projective line then there exist a tuple c extending b such that a is independent of c over b, and a tuple d from [formula] such that [formula]. It suffices to prove that [formula] is [formula]-internal. Let [formula], [formula], [formula], and [formula]. We then have the following diagram where all the maps are the natural projections:

[formula]

Now P  →  T is Moishezon as [formula]. Also Z  →  P is generically finite-to-one since [formula], and all generically finite-to-one maps are Moishezon. Hence the composition Z  →  T is Moishezon. (See for example Section 1 of [\cite=fujiki82] for these facts about Moishezon morphisms.) By the equivalence of parts (c) and (d) this implies that [formula] is [formula]-internal. Hence [formula] is [formula]-internal.

In particular, note that if p is a stationary type over [formula], then p is (almost) internal to the projective line if and only if it is the generic type of a Moishezon variety: an irreducible complex-analytic space that is bimeromorphic to a projective variety.

We now explain why the CBP is true in [formula]. This is a consequence of a theorem of Campana [\cite=campana80] already referred to earlier. Indeed, it was this theorem in complex analytic geometry that inspired the second author to introduce the CBP in [\cite=pillay01]. To describe Campana's theorem we need to recall the Barlet space of cycles. For X any complex-analytic space, a k-cycle of M is a finite linear combination [formula] where the Zi's are distinct k-dimensional irreducible compact complex-analytic subsets of X, and each ni is a positive integer called the multiplicity of Zi in Z. By |Z| we mean the underlying set or support of Z, namely [formula]. We denote the set of all k-cycles of X by Bk(X), and the set of all cycles of X by [formula]. In [\cite=barlet] Barlet endowed Bk(X) with a natural structure of a complex-analytic space whereby if for s∈Bk(X) we let Zs denote the cycle respresented by s, then the set {(x,s):s∈Bk(X),x∈|Zs|} is a complex-analytic subset of X  ×  Bk(X). Equipped with this complex structure, B(X) is called the Barlet space of X. When X is a projective variety the Barlet space coincides with the Chow scheme. In [\cite=campanathesis] it is shown that

[formula]

is a Zariski open subset of B(X): its complement in B(X) is a proper complex-analytic subset. An irreducible component of B(X) is prime if it has nonempty intersection with B*(X).

Note that even for a compact complex-analytic space X it is not necessarily the case that the (prime) irreducible components of B(X) are again compact. Indeed, the condition that all the prime components of B(Xn) for all n  ≥  0 turns out to be important model-theoretically; it is equivalent to the property introduced by the first author in [\cite=sat] of being essentially saturated. This property is satisfied for example, by all holomorphic images of compact Kähler manfiolds (these are the so-called Kähler-type spaces introduced by Fujiki in [\cite=fujiki78]).

Suppose X is a compact complex-analytic space and S is an irreducible compact complex-analytic subset of B(X) such that [formula]. Let ZS: = {(x,s):s∈S,x∈|Zs|}  ⊆  X  ×  S denote the graph of the family of cycles S. Then the natural projection pX:ZS  →  X is a Moishezon morphism.

Let us see how this implies the CBP. Given a stationary type [formula] let [formula], and [formula]. By stationarity the general fibres of G over Y are irreducible complex-analytic subsets of X. The universal property of the Barlet space, along with the geometric flattenning theorem of [\cite=barlet79], gives us a meromorphic map φ:Y  →  B(X) such that for general y∈Y, Gy = Zφ(y) (see for example Proposition 2.20 of [\cite=campanapeternell94]). The condition that [formula] translates into the statement that φ is generically finite-to-one onto its image. Let S denote the image of Y under φ. Then S is an irreducible compact complex-analytic subset, [formula], and [formula] induces a dominant generically finite-to-one meromorphic map from G to ZS over X. By Theorem [\ref=campanacbp], pX:ZS  →  X, and hence G  →  X, is Moishezon. By Fact [\ref=algebraicity], [formula] is internal to the projective line. That is, the CBP holds in [formula].

Finally in this section we explain the origins of our notion of a generating family for a stationary type. Fix an irreducible compact complex-analytic space X. In [\cite=campana81] Campana calls a family of cycles (Zs:s∈S), where S is an irreducible compact complex-analytic subset of B(X) with [formula], a generating family for X if for any x,x'∈X there exists a sequence [formula] in X and [formula] such that xi and xi + 1 both lie in the cycle |Zsi + 1|, for all [formula]. That is, if every pair of points in X can be connected by moving along the cycles in the family. The motivation for Definition [\ref=ample] is made explicit by the following:

Suppose [formula] is a canonical generating family for [formula] over [formula] in the sense of Defintion [\ref=ample]. Let [formula], and [formula]. Let φ:Y  →  B(X) be the meromorphic map given by the universal property of the Barlet space, as discussed above. Let S denote the image of Y under φ. Then (Zs:s∈S) is a generating family of cycles for X.

Note that φ is generically finite-to-one onto S and that for general y∈Y, Gy = Zφ(y). As in section 1 of [\cite=campana81], for each [formula], let Rn  ⊆  X  ×  X be the set of pairs (x,x') for which there exist [formula] and [formula] such that x,x1∈|Zs1|, x1,x2∈|Zs2|, [formula], xn - 1,x'∈|Zsn|. By construction Rn is a complex-analytic subset of X  ×  X. To show that (Zs:s∈S) is a generating family of cycles for X we need to show that [formula] for some [formula]. Now, since q is a generating family for p, Lemma [\ref=justify] implies there exists [formula] independent from a and [formula] for which there exist [formula] and [formula] such that [formula] and [formula], for all [formula]. In particular the bi's are all generic in Y and hence φ is defined on them, and ai,ai + 1∈Gbi = Zφ(bi). That is, [formula]. Since a and a' are generic independents of X, and X is irreducible, it follows that [formula].

Campana proves the following algebraicity criterion (cf. Théorème 3 of [\cite=campana81]):

Suppose X is a Kähler-type complex-analytic space. If (Zs:s∈S) is a generating family of cycles for X, and each Zs is Moishezon, then X is Moishezon.

Using Proposition [\ref=mtgen-campanagen] it is not hard to see that our main result (Theorem [\ref=ample-by-moishezon=moishezon]) specialised to compact complex manifolds is a consequence of the above algebraicity criterion of Campana. In fact, Theorem [\ref=ample-by-moishezon=moishezon] can be viewed as generalising the "generic" content of Theorem [\ref=campanacriterion] to all finite rank theories with the CBP.

Variants of the CBP

Zoé Chatzidakis [\cite=chatzidakis06] has shown that the CBP implies what on the face of it appears to be a stronger property. We will use this in our proof of Theorem [\ref=ample-by-moishezon=moishezon] in Section [\ref=criteria] below.

Suppose the CBP holds for T. If [formula] then [formula] is almost [formula]-internal.

The point here is that we are able to conclude that [formula] rather than just [formula] is almost [formula]-internal. The following immediate corollary is our main use of this theorem.

Suppose the CBP holds for T and q(x,y) is a canonical generating family for p(x) over s(y). Then s(y) is almost [formula]-internal.

Writing [formula] we have that [formula] and [formula]. Then [formula] and [formula]. Hence by Theorem [\ref=strongcbp], [formula] is almost [formula]-internal. So [formula] is almost [formula]-internal.

The proof of Theorem [\ref=strongcbp] involves some substantial model-theoretic technicalities. It turns out however that in the case of compact complex manifolds the conclusion follows from a very transparent geometric argument. In this section, generalising from the case of compact complex manifolds, we introduce a "uniform" version of the CBP and give a rather conceptual argument for why the conclusion of Theorem [\ref=strongcbp] follows from this strengthened form of the CBP.

To motivate this "uniform" CBP, let us look back to the previous section at how the CBP was established for [formula], and notice that one actually gets more. Suppose [formula] is a stationary type, [formula], [formula], and [formula] and πX:G  →  X is the natural projection. Campana's theorem (Theorem [\ref=campanacbp]) implies that if [formula] then πX is a Moishezon morphism, without taking any base change. On the other hand, the CBP only concludes that [formula] is internal to the projective line, which means that πX is Moishezon after a suitable base change (cf. the equivalence of (c) and (d) in Fact [\ref=algebraicity]). To see concretely how these conclusions differ, consider what happens if there is another Moishezon morphism f:X  →  X'. The Moishezonness of πX:G  →  X would imply that [formula] is Moishezon, and so [formula] would be [formula]-internal. Whereas internality of [formula] to the projective line only implies that [formula] is [formula]- analysable (in two steps). So Campana's theorem tells us more than the CBP for [formula].

This motivates the following definition; we return to our general set-up where T is an arbitrary complete stable theory of finite rank and [formula] is the collection of all nonmodular minimal types.

Uniform Canonical Base Property (UCBP). Suppose [formula] and C is a set of parameters such that [formula] is almost [formula]-internal. Then for b' realising the nonforking extension of [formula] to [formula], [formula] is almost [formula]-internal.

Note that UCBP implies CBP by taking C = a.

[formula] has the UCBP.

This is more or less the preceding discussion, but we give some details now. Suppose [formula] is stationary in [formula] with [formula]. We have seen that the projection [formula] is a Moishezon morphism. Now suppose C is a set of parameters such that [formula] is [formula]-internal and let b' realise the nonforking extension of [formula] to [formula]. Set [formula], [formula], [formula] and [formula]. So X  →  Y is a Moishezon morphism as it is obtained from [formula] by base change (this is where the choice of b' independent of c over a is used). We need to show that, possibly after further base change, X  →  Z is Moishezon. Since [formula] is [formula]-internal, we have by Fact [\ref=algebraicity] that for some T  →  Z, Y  ×  ZT  →  T is Moishezon. On the other hand, X  ×  ZT  →  Y  ×  ZT is Moishezon since it is obtained from X  →  Y by base change. Hence the composition X  ×  ZT  →  T is Moishezon, as desired.

The following argument yields the conclusion of Chatzidakis' theorem under the stronger hypothesis of UCBP.

Suppose the UCBP holds for T. If [formula] then [formula] is almost [formula]-internal.

Working over [formula] we may assume that [formula], and aim to show that [formula] is almost [formula]-internal.

Next, we may assume that [formula] also. Indeed, letting [formula] and [formula] we see that b and a are independent over b'. This implies that [formula]. Since [formula], [formula], and [formula], we have obtained the desired reduction.

Now define inductively sequences [formula] and [formula] satisfying the following

ai + 1 realises the nonforking extension of [formula] to abi

bi + 1 realises the nonforking extension of [formula] to aai + 1

[formula] is almost [formula]-internal.

This is done as follows. Applying UCBP to (a,b,C = a) we get that [formula] is almost [formula]-internal. Now, appying UCBP to (b,a,C = a) we obtain a realisation a1 of the nonforking extension of [formula] to ab such that [formula] is almost [formula]-internal. Hence [formula] is almost [formula]-internal. Now apply UCBP to (a1,b,C = a) to obtain a realisation b1 of the nonforking extension of [formula] to aa1 such that [formula] is almost [formula]-internal. Hence, [formula] is almost [formula]-internal, and we may continue.

By (*  ) in the proof of Lemma [\ref=justify] we know that eventually, for some [formula], a is independent of [formula] over [formula]. In particular, [formula] - which is almost [formula]-internal since [formula] is almost [formula]-internal - is a nonforking extension of [formula]. Hence [formula] is almost [formula]-internal, as desired.

Does the CBP imply the UCBP? Equivalently, does the conclusion of Chatzidakis' Theorem [\ref=strongcbp] imply the UCBP?

Internality criteria

We now work toward proving Theorem [\ref=ample-by-moishezon=moishezon]. We will need at least Chatzidakis' Proposition 1.9 from [\cite=chatzidakis06], which we now state in a slightly different form.

Suppose that a,b are tuples, A is algebraically closed, [formula], [formula] and [formula]. Then there are mutually orthogonal nonmodular U-rank 1-types r1,..,rk, each nonorthogonal to A, and tuples a1,..,ak,b1,..,bk∉A such that [formula] and [formula] are [formula]-analysable for each i (where [formula] is the set of A-conjugates of ri), a is interalgebraic with (a1,..,ak) over A, b is interalgebraic with (b1,..,bk) over A, and for each i, [formula] and [formula].

We now prove Theorem [\ref=ample-by-moishezon=moishezon] in the special case when the fibres of the generating family are of rank 1.

Suppose that a stationary type [formula] has a nontrivial canonical generating family [formula] over [formula], with [formula] of rank 1.

Then qb is nonorthogonal to A and p is almost analysable in qb.

If moreover T has the CBP, then p is almost internal to qb.

Note that if the fibre qb is almost internal to a nonmodular minimal type r then we can replace qb by r in the conclusions (i) and (ii) above. Hence Proposition [\ref=theoremrank1] does indeed imply a special case of Theorem [\ref=ample-by-moishezon=moishezon].

Without loss of generality asume that [formula]. Also note that b and [formula] are interalgebraic over A, and replacing b by [formula] preserves the hypotheses of the proposition. So we may assume that [formula].

Let [formula] and [formula]. Then, as observed in the proof of Proposition [\ref=ucbp-zoe], b and b' are interalgebraic over A.

We claim that a and a' are interalgebraic over Ab. Note first that b forks with a' over A. For if not, then b is independent from a over A, and so b∈A, contradicting nontriviality. So a'∉A. If [formula], then, as [formula], we contradict the hypothesis that [formula]. So U(a' / Ab)  ≥  1. As U(a / Ab)  =  1 and [formula] it follows that a is interalgebraic with a' over Ab as required.

We have [formula], [formula] and [formula]. So we can apply Lemma [\ref=chatzidakisprop] to a',b',A to obtain [formula] and [formula] satisfying the conclusion of that lemma (with the obvious notational changes).

k = 1 and r1 is nonorthogonal to qb.

Recall that ai'∉A and a' is interalgebraic with [formula] over A. So [formula] and it follows that [formula]. Hence U(ai' / Ab')  ≥  1 for each [formula]. Since each [formula] is [formula]-analysable and the ri's are mutually orthogonal, it follows that U(a' / Ab')  ≥  k. But as b and b' are interalgebraic over A and a and a' are interalgebraic over Ab, it follows that U(a' / Ab') = U(a / Ab) = 1. So k = 1 and [formula] is [formula]-analysable. Hence [formula] is [formula]-analysable, and so nonorthogonal to r1 as desired.

We can now prove (i). Since by the claim r1 is nonorthogonal to qb, and since r1 is nonorthogonal to A, it follows that qb is nonorthogonal to A. Moreover, b is interalgebraic with b1' over A. It follows that [formula] is almost analysable in r1, and hence in qb. But [formula]. So [formula] is almost analysable in qb.

For (ii) we already know from Corollary [\ref=corstrongcbp] that the CBP implies that [formula] is almost [formula]-internal. On the other hand, we have just seen that [formula] is almost analysable in [formula]. Hence, [formula] must be almost internal to qb. On the other hand, as the fibres have rank 1, we know that q almost separates points of p (cf. part (b) of Remark [\ref=genrem]). So [formula], and hence p is almost internal to qb as well. This completes the proof of Proposition [\ref=theoremrank1].

The following lemma will enable us to reduce Theorem [\ref=ample-by-moishezon=moishezon] to Proposition [\ref=theoremrank1].

Suppose r is a stationary type of rank at least 2 that is almost internal to a nonmodular minimal type. Then r has a canonical generating family whose fibres are of rank 1.

There is no harm in assuming r to be over [formula]. It suffices to show

there is some rank 1 stationary extension qb∈S(b) of r such that there are realizations c1,c2 of qb which are independent over [formula].

Indeed, assume such a qb exists and let [formula]. Restricting qb we may assume [formula]. Hence in order to see that [formula] is a canonical generating family for r over [formula] it remains to show that [formula]. Suppose [formula]. Then, as qb is stationary, if [formula] is independent from c over [formula] then [formula], as desired. So (*  ) suffices.

We next prove the lemma in the special case that [formula] where {a1,..,an} is an independent set of realizations of a nonmodular stationary rank 1 type p(x). By nonmodularity of p we can find, for each i = 2,..,n, some bi such that [formula] is stationary of rank 1, bi is the canonical base of [formula], and U(bi)  ≥  2. (See Chapter 2 of  [\cite=pillay96].) Choose the bi as freely as possible, namely {b2,..,bn} is independent over [formula], and {a1,ai} is independent from all the other aj's together with all the bj's over bi (for each i  =  2,..,n). Let b  =  (b2,..,bn). Then [formula] has rank 1 and b is interalgebraic with the canonical base of the latter strong type. Let (a1',..,an') be a realization of [formula], independent from (a1,..,an) over b. Now if U(a1',ai' / a1,ai)  =  1 then (a1',ai') is independent from (a1,ai,bi) over (a1,ai). But [formula], so [formula]. But then computing the rank of [formula] shows that U(bi)  ≤  1, which is a contradiction. So, for each i, (a1,ai) must be independent of (a1',ai') over [formula]. It is now routine to conclude, using our free choice of the bi's, that (a1',...,an') is independent from (a1,..,an) over [formula]. So (*  ) has been proved in the special case.

Now for the general case. Our assumption on r implies that there is a realization c of r, a model M independent from c, a nonmodular rank 1 type p over M, and an M-independent set {a1,..,an} (n  ≥  2) of realizations of p which is interalgebraic with c over M. Denote (a1,..,an) by a. Let b be given by the special case treated above, namely [formula] has rank 1, and if a' realizes [formula] independently from a,b over M, then a' is independent from a over M. Note that [formula] has rank 1 too. Now let (a,c) and (a',c') be independent (over M,b) realizations of [formula]. As a' is independent from a over M it follows (from the interalgebraicity of c and a over M), that c' and c are independent over M, and thus independent over [formula]. So c' and c are realizations of [formula] which are independent over [formula]. This proves (*  ) for r.

Proof of Theorem [\ref=ample-by-moishezon=moishezon]

Write [formula], [formula], and [formula], such that q generates p over s and qb is internal to a nonmodular minimal type r.

Without loss of generality assume that [formula]. Let [formula]. Then [formula] is stationary and almost internal to r, and [formula]. So the hypotheses of the theorem are preserved by replacing b with b'. We may therefore assume that [formula] and q is thus a canonical generating family. If q were a trivial generating family then qb = p and the theorem would follow. So we may assume that q is a nontrivial canonical generating family.

If U(qb) = 1 then the theorem follows from Proposition [\ref=theoremrank1]. So we may assume that the fibres are of rank at least 2. Applying Lemma [\ref=moishezon=veryample] we obtain c such that

[formula] is stationary of rank 1,

[formula], and

[formula].

Letting [formula] we have that

∉A,

[formula] is stationary of rank 1,

[formula], and

[formula].

That is, [formula] is a nontrivial canonical generating family for p over [formula] with fibre [formula] of rank 1. Hence Proposition [\ref=theoremrank1] yields

[formula] is nonorthogonal to A and p is almost analysable in [formula]

If moreover T has the CBP then p is almost internal to [formula].

But since [formula] is almost internal to r so is the extension [formula] and hence also [formula]. So (i)[formula] and (ii)[formula] yield

r is nonorthogonal to A and p is almost analysable in r

If moreover T has the CBP then p is almost internal to r.

This completes the proof of Theorem [\ref=ample-by-moishezon=moishezon].