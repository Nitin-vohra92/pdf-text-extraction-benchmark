Corollary Lemma Claim Proposition Conjecture

Non-linear Recurrences that Quite Unexpectedly Generate Rational Numbers

Introduction

Many people have studied non-linear recurrences that generate sequences of integers despite the fact that every iteration of the recurrence requires division by some previous term in the sequence. These types of non-linear recurrences generally have the following form

[formula]

where L is a Laurent polynomial with integer coefficients, i.e.- L is in the set [formula]. Well studied examples of this phenomenon are the Somos sequences, introduced by Michael Somos in 1989 [\cite=DGale], defined by the recurrence

[formula]

with initial conditions s(m) = 1 for m  ≤  k. For k = 2,3 the recurrence generates the infinite sequence {1}∞n = 1. More interestingly, for k = 4,5,6,7 it is known that these recurrences each generate an infinite sequence of integers ([\cite=FZ][\cite=DGale]). There are, of course, other examples of this integrality phenomenon, and many are generalizations of the Somos recurrences (for some examples see [\cite=DGale]).

It seems to be the case that all recurrences of the form ([\ref=nonLinRecurDef]) that have been studied have no exponent on a(n). In this paper I will discuss recurrences of the form

[formula]

where m > 1, and L is still a Laurent polynomial. I will refer to m many times in this paper, and (unless otherwise stated) this will refer to the exponent on a(n) in the left-hand side of a recurrence of the form ([\ref=MnonLinRecurDef]).

In general one would imagine that if a(n) is raised to a power m > 1 then what is generated is not a sequence at all, since solving an equation of degree m yields up to m answers. So I need to introduce the concept of a recurrence tree.

A recurrence tree is a way of storing the values generated by a recurrence of the form ([\ref=MnonLinRecurDef]) with m > 1. Solving for the n + 1st term, given a specific nth term requires solving an equation of degree m. This yields up to m possibilities for the n + 1st term. We can store these numbers in a complete m-ary tree.

For example when m = 2 we get the following structure

[formula]

Also, since solving an equation of degree m yields answers which can be in [formula], we may expect that the numbers generated are not rational. However, in some cases a recurrence of this form generates rational numbers. When the tree consists only of numbers in [formula] (resp. [formula]) we will call it a rational (resp. integer) recurrence tree.

One way to come up with recurrences that obviously generate rational recurrence trees is to take a recurrence that generates integers and find the "ratios of ratios" sequence.

Given the sequence {b(n)}∞n = 1, we call [formula] the sequence of ratios of {b(n)} and [formula] the sequence of ratios of ratios of {b(n)}.

Obviously, if a sequence [formula] then the sequence of ratios of {b(n)} and the sequence of ratios of ratios of {b(n)} are in [formula].

Of course, it may not be the case that the recurrence that generates these ratio sequences has the m > 1 property, but in the case of the generalized Somos-4 sequences we can find an alternate recurrence for the sequence of ratios of ratios that does have this property. We can then generalize and find new recurrences that do not obviously generate rational numbers.

Generalized Somos-4 Ratios of Ratios Sequence

Let {sc(n)}∞n = 1 be a sequence defined by the following recurrence:

[formula]

with initial conditions sc(i) = 1 for [formula], where [formula] . This is a special case of the three term Gale-Robinson recurrence ([\cite=FZ][\cite=DGale]) that further specializes to the Somos-4 recurrence when c1 = c2 = 1. The first few terms of the sequence are

[formula]

Using cluster algebras and the Caterpillar Lemma, Fomin and Zelevinsky proved that the recurrence ([\ref=GenSom4]) generates a sequence of integers [\cite=FZ].

Now, define sequences {tc(n)}∞n = 1, and {ac(n)}∞n = 1 by

[formula]

then {tc(n)}∞n = 1 is the sequence of ratios of sc(n)

[formula]

and {ac(n)} is the sequence of ratios of ratios of sc(n).

[formula]

In this paper we will be interested in the sequence {ac(n)}. By algebraic manipulation we can easily find a first order quadratic recurrence for ac(n).

The sequence {ac(n)}∞n = 1 is defined by the recurrence

[formula]

with initial conditions ac(1) = ac(2) = 1.

We will simply manipulate the recurrence equation for sc(n) to look like the recurrence equation ([\ref=acRecur]).

[formula]

Notice that the sc term on the right side is ac(n + 1). By multiplying and dividing by the correct terms on the left side we will get the left side of ([\ref=acRecur]).

[formula]

Finally we obtain

[formula]

which is ([\ref=acRecur]).

Unfortunately, this recurrence for the ratios of ratios of sc(n) does not satisfy m > 1. The proof of the next claim will help to create a recurrence with m = 2.

The sequence generated by the recurrence ([\ref=acRecur]) also satisfies the recurrence

[formula]

Showing the converse, that the sequence defined by ([\ref=acRecur2]) satisfies ([\ref=acRecur]), will prove this claim because of uniqueness of the sequence. So assume the sequence {ac(n)}∞n = 0 is defined by ([\ref=acRecur2]). Now let us define a function T(n) by

[formula]

I claim that it is enough to show T(n) = 0, for if this is true then rearranging terms and dividing both sides by ac(n + 1)2ac(n) we get

[formula]

The RHS of the above equality equals ac(n + 2) because we assumed the sequence {ac(n)} is defined by the recurrence ([\ref=acRecur2]). Therefore we also have that ac(n + 2) = LHS, i.e.-

[formula]

which is recurrence ([\ref=acRecur]). So the sequence {ac(n)}∞n = 1, generated by ([\ref=acRecur2]), also satisfies the recurrence ([\ref=acRecur]).

All that is left is showing, by induction, that T(n) = 0 for all n. For n = 1 we do the following calculation

[formula]

Now assume that T(n - 1) = 0 for some n. We substitute for ac(n + 1) in T(n) from ([\ref=acRecur2]) and simplify to obtain

[formula]

Therefore by induction, T(n) = 0 for all n and the claim is proved. This proof used ideas from Guoce Xin's paper [\cite=Xin].

Coming out of the proof of Claim [\ref=acRecur2C] we get that T(n) = 0 is a first order recurrence with m = 2 for {ac(n)} as we had hoped. One would expect that, since {ac(n)} is by definition a single sequence, the recurrence tree for T(n) = 0 would somehow consist only of this single sequence. Indeed this is the case as we prove now.

The recurrence tree for

[formula]

with a(1) = 1, produces a single sequence in the sense that at every level of the tree there is only one value that we haven't yet seen.

Let X: = ac(n + 1) and Y: = ac(n), then the first order quadratic recurrence for the generalized Somos-4 sequence is rewritten as

[formula]

Given some value yo for Y there are two possible values for X which satisfy ([\ref=XYRecur]). This corresponds to the fact that given some ac(n) there are two possible values for ac(n + 1). Using the quadratic formula, these two values, in terms of yo, are

[formula]

Now, since these are values for ac(n + 1) we substitute them back in for Y in ([\ref=XYRecur]), solve for X, and get potentially 4 possible values for ac(n + 2) that come from this specific ac(n) = yo. However, when we solve the quadratic equation

[formula]

for X the two solutions we get are yo and a large expression in terms of yo,c1,c2 (similarly for y-). This means that in the ith level of the tree, representing all possible values for ac(i), from each of the terms in the i - 1st level there is at most one term that we haven't yet seen. Now, lets look at the second level given the initial condition (the root) ac(1) = 1. We solve the quadratic equation

[formula]

So on the second level we only have one new term. Therefore, on the third level, and all subsequent levels, we also only have one new term.

Since the recurrence tree for ([\ref=SomO1D2]) consists only of numbers from the sequence of ratios of ratios of {sc(n)}, it must be a rational recurrence tree. So we have found an example of a non-linear recurrence with m > 1 that generates rational recurrence tree. However, this example was constructed in such a way that it had to generate a rational recurrence tree. In the next section I will generalize this example to get nontrivial sequences generating rational recurrence trees.

Generalized First Order Quadratic Recurrence Tree

The general form of a first order non-linear recurrence is

[formula]

where Pi(Y) is a polynomial in Y of some degree di. For example, the sequence of ratios of ratios of generalized Somos-4 has recurrence given by ([\ref=O1D2Gen]) where m = 2 and

[formula]

For the remainder of this section we will assume that m = 2, d0 = d1 = 1, and P2(Y) = Y2. Let

[formula]

where [formula]. Under certain minimal sufficient conditions a recurrence of this form will generate a rational recurrence tree.

Let a(1) = 1 in the recurrence ([\ref=O1D2Gen]) with coefficient polynomials given by ([\ref=specP]). If

A1 = B2 and

solving for a(2) yields rational numbers,

then the recurrence generates a rational recurrence tree.

First we will show that A1 = B2 implies that for every term a1  =  a(n) coming from solving

[formula]

with a(n - 1) = a0, we get only one new a(n + 1). In other words, solving

[formula]

for a(n + 1) yields the solutions {a(n + 1),a0}. In recurrence tree form this looks like:

[formula]

Let ao be a term in the n - 1st level. Its children in the recurrence tree are the solutions of the quadratic equation

[formula]

In other words, possibilities for a(n) given that a(n - 1) = ao are

[formula]

If a(n) = a(n)i, for i = 1,2, then to get a(n + 1) we solve

[formula]

for a(n + 1). The goal is to show that ao is a solution for a(n + 1), so it is enough to show that a(n)2ia2o + (A1 + A2a(n)i)ao + (B1 + A1a(n)i) = 0 for i = 1,2. This is nothing but algebraic manipulation that can be easily done using Maple or any other computer algebra system.

The other assumption that we made is that both answers for a(2) are rational. When we solve for level 3 we know that in each case one answer will be from level 1, so rational. Then the other answer must be rational because the product of the two answers is the constant term in the quadratic polynomial, B1 + A1a(2)i, which is rational. Likewise, if levels n - 1 and n are rational then level n + 1 will be rational. So by induction we see that all levels are rational numbers.

Even with the stipulation that A1 = B2 and a(2)1,a(2)2 are both rational, this more general first order recurrence encompasses more than just the Somos-4 ratios of ratios. For example, let A1 = B2 = 1,A2 = 5,B1 = 8 with the initial condition a(1) = 1, then the recurrence is

[formula]

The reader may check that a(2)1,a(2)2 are in fact rational. There is no (c1,c2) such that ([\ref=SomO1D2]), the generalized Somos-4 ratios of ratios recurrence, is the same as ([\ref=example]).

Another fact that is worth pointing out is that these recurrences produce at most two sequences. In Section [\ref=GenS4RatRat] we showed that the first order quadratic recurrence for ac(n), the ratios of ratios of the generalized Somos-4 sequence, generates a unique sequence. This was partly due to the fact that at level 2 one of the solutions is ac(1), so we only have one new solution. However, it is possible to have two new solutions on level 2. In this case, on level n > 2 we could have two new solutions, each coming from one of the a(2). However, we can never get more than two sequences.

Recurrence Tree for Generalized Somos-4 Sequence

So far we have looked at first order nonlinear recurrences that generate trees. What about higher order nonlinear recurrences that generate trees? As an example we will look at the generalized Somos-4 recurrence ([\ref=GenSom4]). This recurrence is order 4 and quadratic, but with m = 1. Since we have a first order quadratic recurrence for the ratios of ratios of the generalized Somos-4 sequence given by ([\ref=SomO1D2]) we can "unfold" this recurrence to get an order 3 recurrence that should be satisfied by the generalized Somos-4 sequence. Since we assumed that ac(n): = tc(n + 1) / tc(n) and tc(n): = sc(n + 1) / sc(n) we can substitute into ([\ref=SomO1D2]). The recurrence we obtain is

[formula]

In Section [\ref=GenS4RatRat] we were able to show that the recurrence tree for the ratios of ratios of the Somos-4 recurrence is just a sequence in disguise because there is only one new term per level. One might think that the same happens here since ([\ref=Som4Ord3]) is supposed to generate the generalized Somos-4 sequence, however this is not the case. Instead, we get many new terms per level, and therefore generate many sequences. Also surprisingly, we even get some non-integer rational numbers in the tree. As it turns out, at least one of the sequences in the tree has a simple closed form.

One of the sequences generated by the recurrence ([\ref=Som4Ord3]) is

[formula]

where [formula].

First note that the sequence {f(n)}∞n = 4 is

[formula]

I claim that f(2i + 1) - f(2i) = i - 1, and f(2(i + 1)) - f(2i + 1) = i - 1. The value of f(2i) is

[formula]

and the value of f(2i + 1) is

[formula]

Their difference is i - 1 as claimed. Now, f(2(i + 1)) is

[formula]

The difference f(2(i + 1)) - f(2i + 1) is indeed i - 1.

Now we will prove this proposition by induction. First, the base case: we need to show that sc(4) = (c1 + c2)0,sc(5) = (c1 + c2)1,sc(6) = (c1 + c2)2. This is straightforward computation, substitute in sc(1) = sc(2) = sc(3) = 1 in ([\ref=Som4Ord3]) and solve for sc(4). We get two possibilities, 1 and c1 + c2. In this case we choose sc(4) = 1. Now we again substitute sc(2) = sc(3) = sc(4) = 1 in ([\ref=Som4Ord3]) and solve for sc(5). This is the same quadratic equation so we get the same 2 solutions, this time we choose sc(5) = c1 + c2. To finish off the base case we substitute sc(3) = sc(4) = 1,sc(5) = c1 + c2 in ([\ref=Som4Ord3]) and solve for sc(6). Our two possible solutions are

[formula]

so we choose sc(6) = (c1 + c2)2. So the base case is true. Now assume, as the inductive hypothesis, that the proposition is true up to n + 2. We have two possibilities

If we substitute this into ([\ref=Som4Ord3]) and simplify, we obtain the quadratic equation

which we can easily solve using the quadratic formula. Our two possibilities when solving for s(2i + 3) are

Again we substitute this in to ([\ref=Som4Ord3]) to obtain the following quadratic equation

which we can again solve using the quadratic equation and obtain

Again, if we choose the `` + " in the quadratic equation we get

as expected.

The fact that we were able to find a nice closed form for one of the integer sequences in this recurrence tree is very surprising. The closed form for the generalized Somos-4 sequence is in terms of elliptic theta functions [\cite=Hone], but by finding a lower order recurrence with higher degree we were able to find a polynomial sequence.

In looking at the tree that the recurrence ([\ref=Som4Ord3]) generates I have noticed that something even more general seems to be true.

Let T be the recurrence tree for ([\ref=Som4Ord3]). Every integer, and the numerator and denominator of every (reduced) non-integer rational number in T, are products of terms in the generalized Somos-4 sequence.

Clearly, proposition [\ref=Som4Ord3Subseq] is consistent with this conjecture since sc(5) = c1 + c2 in the general Somos-4 recurrence ([\ref=GenSom4]).

Maple code

This subject could not have been studied without the use of a computer algebra system, Maple in my case. The Maple code accompanying this paper can be found on my website http://math.rutgers.edu/~  eahogan/maple/. I created programs that calculate the recurrence tree for a given recurrence of any order and any degree. These programs can be found in the file RecurrenceTree.txt. I also created programs that generate all recurrences that have rational recurrence trees to a certain depth (i.e.- if the tree for a specific recurrence is rational up to a test depth, the program outputs that recurrence). Those can be found in file GenerateRationalRecurrenceTrees.txt.

Conclusion

My study of recurrence trees in this paper may be just the beginning. The first order recurrences I looked at were limited to the case where m = 2. As m grows it seems less likely that the recurrence trees generated will be rational. Though it could be the case that a subtree is rational, or perhaps just a single sequence. The only higher order recurrence tree I investigated was that of the generalized Somos-4 recurrence. That specific recurrence is not completely characterized, but I suspect a generalization, along the lines of section [\ref=Ord1QuadTree], can be made which may yield behavior like ([\ref=Som4Ord3]).

Acknowledgements

I would like to thank my advisor, Doron Zeilberger, for bringing my attention to this problem and helping me along the way. This material is based upon work supported by the U.S. Department of Homeland Security under Grant Award Number 2007-ST-104-000006. The views and conclusions contained in this document are those of the authors and should not be interpreted as necessarily representing the official policies, either expressed or implied, of the U.S. Department of Homeland Security.