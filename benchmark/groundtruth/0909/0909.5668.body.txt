Theorem Definition Corollary

Metastability and the Furstenberg-Zimmer Tower II: Polynomial and Multidimensional Szemerédi's Theorem

Introduction

If X is a measure preserving system acted on by a group Γ, the Furstenberg-Zimmer structure theorem shows that X may be decomposed into a tower of primitive extensions: that is, a tower (Yα)α  ≤  θ such that Y0 is the trivial factor, limit levels are the limit of the preceeding factors, and each Yα + 1 is compact relative to some subgroup Δ  ⊆  Γ and weak mixing relative to all [formula] (see [\cite=FurstenbergBook]).

When X is separable, a simple countable argument shows that this tower must have countable height, and Beleznay and Foreman [\cite=foreman96] have shown that even when Γ is [formula], the tower may reach any countable height.

The structure theorem is commonly used to prove finitary combinatorial results, and we might hope that, for these finitary applications, only a limited portion of the tower is necessary. In [\cite=avigad09], Avigad and the author showed that the proof of Szemerédi's Theorem from the structure theorem for [formula] actions requires only the first ωωω levels of the tower.

In this paper, we apply similar methods to Bergelson and Liebman's multidimensional polynomial Szemerédi Theorem [\cite=bergelson96]; as such, we follow the proof from [\cite=bergelson96] closely, applying theorems from there directly without repeating the proof when possible. These methods generalize Furstenberg and Katznelson's multidimensional Szemerédi Theorem [\cite=furstenberg79], and therefore apply to that argument as well. In the one-dimensional polynomial case, the corresponding bound is ωωωω; the higher bound is due to the use of the PET induction scheme, which has order-type ωω. In the multidimensional case, the situation is slightly more complicated, since we need a system of nested towers with each section having this larger height. (In the multidimensional linear case, the theorems here show that the corresponding system of nested towers with each section having height ωωω suffices.)

A central idea in this paper is that, while the property of being a weakly mixing extension is quite infinitary, the finitary consequences of being weak mixing can also be extracted from a sufficiently long sequence of factors which are all "almost" weak mixing with the same parameters. While there is no countable bound on how tall a tower must be to ensure that an extension is weak mixing, there is a countable bound which is sufficient to guarantee the existence of these almost weak mixing extensions. This type of approximation to infinitary convergence has been called "metastability" by Tao [\cite=tao08Norm].

The bounds obtained here are not optimal; however they are, in some sense, "a priori": they are extracted directly from the proof, without additional combinatorial techniques. [\cite=avigad09] discusses the logical methods underlying this extraction.

Regarding optimal bounds, Furstenberg's original ergodic proof [\cite=furstenberg77] used only ω levels of the tower to prove Szemerédi's Theorem; that method has not directly been generalized to the multidimensional or polynomial case, but more recent methods [\cite=host05] [\cite=tao06] [\cite=ziegler07] are generally believed to be sufficient to show that ω levels of the tower suffice for the multidimensional polynomial Szemerédi's Theorem as well (this has not, to our knowledge, been written down, although [\cite=ziegler08] can be seen as implying the claim for the single dimensional polynomial Szemerédi Theorem).

We are grateful to Vitaly Bergelson for answering questions about the proof of the polynomial Szemerédi Theorem, and to Jeremy Avigad, with whom most of the new techniques in this paper were originally developed.

Preliminaries

Bergelson and Liebman's polynomial Szemerédi Theorem [\cite=bergelson96] states:

Let [formula] be a collection of polynomials with rational coefficients taking on integer values on the integers and satisfying pi,j(0) = 0 for all i,j. Then for any δ > 0, there is an N large enough so that if S is any subset of [formula] with density at least δ and [formula], there exists an integer n and a vector [formula] so that

[formula]

for every i  ≤  k.

Using the correspondence principle introduced by Furstenberg [\cite=furstenberg77], they obtain this as a consequence of the following ergodic theorem:

Let [formula] be a dynamical system, let [formula] actions of elements of [formula], and let [formula] p1,t(n), p2,1(n), [formula] p2,t(n), [formula] [formula] be a collection of polynomials with rational taking on integer values on the integers and satisfying pi,j(0) = 0 for all i,j. Then for any A∈B with μ(A) > 0,

[formula]

Fix the integer d. Throughout this paper, we will be concerned with measure preserving systems of the form (X,B,μ,Γ) where Γ is a subgroup of [formula]. We will also be concerned with minimal sets of generators for Γ; that is, linearly independent sequences [formula] generating Γ.

If (X,B,μ,Γ) is an extension of (Y,C,ν,Γ), we say it is a compact extension if for every f∈L2(X) and any ε,δ > 0, there exist B∈C with ν(B) > 1 - ε and a finite set of functions [formula] such that for each R∈Γ, min 1  ≤  i  ≤  K||R(f  ·  χB) - hl||y  <  δ for all y∈B.

See [\cite=FurstenbergBook] for an extensive discussion of the properties of compact extensions. Note that every function in L2(Y) is compact relative to Y.

Let [formula] be a dynamical system and let [formula] be a subgroup and [formula] a minimal set of generators. For any L∞ function g, we define

[formula]

The Mean Ergodic Theorem for [formula] actions [\cite=wiener39] implies that the functions [formula] converge to a limit [formula]. In particular, it is standard that an extension generated by functions of the form [formula] is compact (relative to the group generated by [formula]), and that conversely, every compact function is a limit of such functions.

An increasing tower of factors of height γ is a sequence of factors (Yδ)δ  <  γ such that α  <  β  <  γ implies Yα  ⊆  Yβ and whenever λ  <  γ is a limit ordinal, Yλ is generated by [formula].

If Γ is a group, we define ZΓ(Y) to be the space of all functions compact relative to Y with respect to the group Γ. Given a fixed action of [formula] on Y, define Zt(Y) to be the space generated by the union of ZΓ(Y) as Γ ranges over subgroups of [formula] of dimension ≥  t.

If Γ is a group, a tower of Γ-compact extensions is an increasing tower of factors (Yδ)α  <  γ such that for each α, ZΓ(Yα)  ⊆  Yα + 1.

If [formula] is a group, a tower of Γ+-compact extensions is an increasing tower of factors (Yδ)α  <  γ such that for each α and each [formula], [formula].

(Note that in a tower of Γ-compact extensions, we do not require that Yα + 1 be a compact extension of Yα; rather, we require that it contain every compact extension of Yα.)

Let Z,η be given. We define a tower of factors by main induction on n  ≤  d and side induction on α:

Yd - n,η0(Z): = Z

Yd,ηα + 1(Z): = Zd(Yd,ηα(Z))

[formula]

For limit λ, [formula]

In particular, note that for any Z, η, n, {Yd - n,ηα(Z)}α  <  η is a tower of Γ-compact extensions for every [formula] of dimension d - n. When we take Z to be the trivial factor, note that Y0,η1  =  X for any η (since everything in X is compact with respect to the group of dimension 0).

The main result is:

For every ε > 0, every [formula], every linearly independent [formula], every tower (Yδ)δ  <  η of [formula]-compact extensions for every S generated by [formula], every sequence of polynomials [formula] as in the polynomial Szemerédi Theorem, all functions [formula] in L∞(X), there is a δ  <  ωωωω and an n such that, for all m  ≥  n,

[formula]

Note that, in particular, the towers Yd - n,ηα(Z), where Γ has dimension d - n, always satisfy the premise. We obtain this inductively using a stronger property, namely that this holds not for one δ, but for many δ simultaneously in the same n.

If θ and η are ordinals, (θ,η] denotes the interval {δ|θ  <  δ  ≤  η}.

If α is an ordinal, s is an α-sequence if s = (sβ)β  ≤  α is a strictly increasing sequence of ordinals indexed by ordinals less than or equal to α. Say t is a β-subsequence of s if t is a β-sequence and a subsequence of s.

If s is an α-sequence and P(δ) is any property, say P holds for s-many δ if for every β  <  α, there is a δ in (sβ,sβ + 1] such that P(δ) holds.

Approximating Weak Mixing

The following metastable form of the Mean Ergodic Theorem follows immediately from Theorem 4.4 of [\cite=avigad09]:

Let ε > 0, B > 0, and let (Yδ) be an increasing tower of factors. Then there is a natural number K such that for every αK-sequence s and every g in L∞(X) with ||g||∞  ≤  B, there are a natural number n and an α-subsequence t of s such that the property

for every m  ≥  n and h with ||h||L2(X)  ≤  B, [formula]

holds for t-many δ.

The following theorem is proven almost identically to the analogous Theorem 5.1 in [\cite=avigad09]; the only difference is that we have to use the Γ-compactness of g with respect to every element of the tower to obtain the needed [formula]-compactness of [formula].

For every ε > 0 and B > 0, there is a natural number K such that for every [formula], every [formula], every tower (Yδ)δ  <  η of [formula]-compact extensions, every α  ≥  ω, every αK-sequence s, and every f,g compact with respect to Γ relative to Y0 with ||f||∞,||g||∞  ≤  B, there are an n and an α-subsequence t of s such that the property

for every m  ≥  n, [formula]

holds for t-many δ.

For any δ, if we set hδ equal to f - E(f|Yδ), we have

[formula]

Since g is compact relative to Y0 with respect to Γ, it compact relative to Yδ with respect to Γ. Then [formula] is a limit of a sum of a product of a function in L2(Yδ) with a function compact relative to Yδ, and is therefore itself compact relative to Yδ with respect to Γ. Further, by construction it is compact relative to Yδ with respect to T. It is standard (see [\cite=FurstenbergBook]) that [formula] is therefore compact relative to Yδ with respect to the group generated by [formula], and therefore [formula].

Given ε > 0 and B > 0, choose K given by Lemma [\ref=ergodic] for ε / 2B, B. We claim that 2K satisfies the claim. Suppose we are given an α2K-sequence s and f and g with ||f||∞  ≤  B, ||g||∞  ≤  B. Since α  ≥  ω, we may restrict s to the initial (ω  ·  α)K-subsequence, and by our choice of K, there is an n and an ω  ·  α-subsequence t with the property that

for every m  ≥  n and h with ||h||L2(X)  ≤  B, [formula] ([formula])

holds for t-many δ. Let t' be the α-sequence obtained by setting t'β: = tω  ·  β for each β  ≤  α. Then for each β  <  α and each i, there is a δi∈(tω  ·  β + i,tω  ·  β + i + 1] such that ([formula]) holds. In particular, there is some i such that ||hδi + 1 - hδi|| = ||E(f|Yδi + 1) - E(f|Yδi)|| < ε / 2B2, and so for δ: = δi, we have

[formula]

For every m  ≥  n, by ([formula]), the first term is bounded by ||hδ||∞  ·  ε / 2B  ≤  ε / 2 since ||hδ||∞  ≤  B. The second term is bounded in L2(X) norm by [formula], which is less than ε / 2 since [formula]. The integral of the last term is 0 since hδ + 1 is orthogonal to Yδ + 1 and [formula] is an element of Yδ + 1. Hence [formula] as required.

Polynomials

The definitions in this section are essentially those of [\cite=bergelson96].

An integral polynomial is a polynomial with rational coefficients taking integer values on the integers. An integral-zero polynomial is a polynomial taking the value 0 at 0.

Let t be fixed. If 〈pj〉j∈[1,t] is a sequence of integral polynomials of degree at most D, the degree of 〈pj〉 is max i∈[1,t]deg(pi) and the weight, w(〈pj〉), is the pair (r,d) such that whenever i > r, deg (pi) = 0, and deg (pr) = d  ≥  1. We order weights by the lexicographic ordering, (r,d) > (s,e) if r > s or r = s and d > e.

We say two such sequences 〈pj〉,〈qj〉 are equivalent if they have the same weight and the leading coefficients of the polynomials pr, qr are the same.

The degree of a finite collection A: = {〈pi,j〉j∈[1,t]}i∈[1,k] of such sequences is the maximum of the degree of any of its elements. The weight matrix, wm(A), is the matrix

[formula]

where D is the degree of A and Ns,d is the number of equivalence classes with weight (s,d) in the collection.

The system with t = 2, D = 5 given by

[formula]

has weight matrix

[formula]

We introduce an ordering on weight matrices (with t and D fixed): N < M if for some (r,d), N(r',d') = M(r',d') for all (r',d') > (r,d) and N(r,d) < M(r,d). It is easy to see that this is a well-ordering of order type ωt  ·  D, and when M is a weight matrix, we will write o(M) for the height of A in this ordering (that is, o(M) is the order-type of {N|N < M}). If A is a finite set of sequences of integral polynomials, we write o(A): = o(wm(A)).

We say two sequences of polynomials 〈pi〉, 〈qi〉 are essentially distinct if for some i, pi(n) - qi(n) is not constant.

Let A be such a set of sequences. For any h, we define a new set Ãh: = {〈pj(n)〉,〈pj(n + h) - pj(h)〉|〈pj(n)〉∈A}. When deg 〈pj〉 = 1, pj(n) = pj(n + h) for every j. But whenever deg 〈pj〉  ≥  2, there is at most one h such that pj(n) = pj(n + h) - pj(h). Note that Ãh has the same weight matrix as A.

Assume A, and therefore Ãh, contains no polynomials of weight < (1,1). Let 〈pj〉∈Ãh be chosen with minimal weight and define Ah: = {〈p'j(n) - pj(n)〉|〈p'j〉∈Ãh}. Note that if 〈p'j〉∈Ãh is not equivalent to 〈pj〉 then 〈p'j - pj〉 is equivalent to 〈p'j〉, and if 〈p'j〉 is equivalent to 〈pj〉 then w(〈p'j - pj〉) < w(〈p'j〉). In particular, this means that the weight matrix of Ah preceeds the weight matrix of A.

If [formula] is a sequence of transformations and 〈pj〉j∈[1,t] is a sequence of polynomials, we write [formula].

If X is a dynamical system and [formula] is a minimal generating set of a subgroup of [formula], we say X satisfies [formula]-SZP if for any B with μ(B) > 0,

[formula]

We say X is SZP if it is [formula]-SZP for every choice of [formula] and every set A of pairwise distinct sequences of length t of integral-zero polynomials.

Note that distinct integral-zero polynomials are essentially distinct.

Approximating Weak Mixing Along Polynomials

We recall the following technical results from [\cite=avigad09]:

A formula [formula] is continuous in an ordinal parameter δ if whenever [formula] for every γ  <  β, also [formula].

Suppose [formula] and [formula] are continuous in δ. Fix [formula].

Suppose that for each i∈{1,2}, for every B > 0 there is a θi  <  ωpi such that for every αθi-sequence s with α  ≥  ω and every f with ||f||L∞  ≤  B, there are a natural number ni and an α-subsequence t of s such that the property

for every m  ≥  ni, [formula]

holds for t-many δ.

Then for every B > 0 there is a θ  <  ωp1 + p2 - 1 such that for every αθ-sequence s with α  ≥  ω and every f with ||f||L∞  ≤  B, there are a natural number n and an α-subsequence t of s such that the property

for every m  ≥  n, [formula] and [formula]

holds for t-many δ.

Suppose there is a θ  <  ωp such that for every αθ-sequence s with α  ≥  ω and every f with ||f||L∞  ≤  B, there are a natural number n and an α-subsequence t of s such that the property

for every m  ≥  n, φ(f,m,δ)

holds for t-many δ.

Suppose also that ε > 0 is such that whenever ||f - f'||L2  <  ε and φ(f,m,δ) holds, also φ'(f',m,δ) holds. Let φ be continuous in δ. Then there is a θ  <  ω2p - 1 such that for every αθ-sequence s with α  ≥  ω and every f with ||f||L∞  ≤  B, there are a natural number n and an α-subsequence t of s such that the property

for every m  ≥  n, φ'(E(f|Yδ),m,δ) and φ'(f - E(f|Yδ),m,δ)

holds for t-many δ.

Suppose there is a θ0  <  ωp such that for every αθ0-sequence s with α  ≥  ω and every f with ||f||L∞  ≤  B, there are a natural number n0 and an α-subsequence t of s such that the property

for every m  ≥  n0, φ0(f,m,δ)

holds for t-many δ.

Suppose that, additionally, for every d there is a θd  <  ωq such that for every αθd-sequence s with α  ≥  ω and every f with ||f||L∞  ≤  B, there is a natural number nd and an α-subsequence t of s such that the property

for every m  ≥  nd, φd(f,m,δ)

holds for t-many δ.

If φi is continuous in δ for each i then there is a θ  <  ωp + q such that for every αθ-sequence s with α  ≥  ω and every f with ||f||L∞  ≤  B, there are an n, an N, and an α-subsequence t of s such that the property

φ0(f,N,δ) and for every m  ≥  n, φN(f,m,δ)

holds for t-many δ.

Recall that if X is a measure-preserving system and Y is a factor, X  ×  YX is again a measure-preserving system with factor Y. L∞(Y) can be identified as a subset of L∞(X  ×  YX), and if f and g are elements of L∞(X) then [formula] is an element of L∞(X  ×  YX). Thus, the most basic elements of L∞(X  ×  YX) can be viewed as tensor products of elements of L∞(X). We define the simple elements of L∞(X  ×  YX) to be those that can be represented as finite sums of such basic elements. The advantage to focusing on simple elements is that if f is such an element then f can be viewed as an element of L∞(X  ×  Yk,ηδ(Z)X) for each k,η,Z,δ simultaneously.

More precisely, we define L∞0(X  ×  X) to be the set of finite formal sums of such basic elements; then each element f of L∞0(X  ×  X) denotes an element of L∞(X  ×  YX) for any Y. Note that if f and g are elements of L∞0(X  ×  X) it makes sense to talk about f + g and E(f|Y) as elements of L∞0(X  ×  YX). We may define an L∞ bound of such a formal sum in the natural way, taking [formula]. Such a bound is an upper bound for the true L∞ bound in L∞(X  ×  YX) and respects the usual properties of the L∞ norm with respect to sums and products.

Using this, we can generalize Theorem [\ref=wm] to the relative square X  ×  YδX; we could go further, extending to the relative square of the relative square, and so on, but we will not need to do so here.

For every ε > 0 and B > 0, there is a natural number K such that for every [formula], every [formula], every tower (Yδ)δ  <  η of [formula]-compact extensions, every α  ≥  ω, every αK-sequence s, and every f,g∈L∞0(ZΓ(Y0)  ×  ZΓ(Y0)) with ||f||∞,||g||∞  ≤  B, there are an n and an α-subsequence t of s such that the property

for every m  ≥  n, [formula]

holds for t-many δ.

By Lemma [\ref=tech:split] and the subadditivity of the left hand side, it suffices to consider the cases where [formula], [formula], and either E(fi|Yδ) = 0 or E(fi|Yδ) = fi for each i∈{1,2}. When E(fi|Yδ) = fi for both i = 1 and i = 2, the claim is trivial, so we may further assume that for some i∈{1,2}, E(fi|Yδ) = 0. By Theorem [\ref=wm] and Lemma [\ref=tech:pair], for any ε' > 0, we can find K large enough so that every αK-sequence s has an n and an α-subsequence t such that

for all m  ≥  n, both

[formula]

and

[formula]

holds for t-many δ. But then, for such δ and m  ≥  n,

[formula]

[formula]

is close to

[formula]

which is 0 since either E(f1|Yδ) = 0 or E(f2|Yδ) = 0

We need to generalize Theorem [\ref=wm] to arbitrary polynomials of degree 1.

For every ε > 0 and B > 0, there is a natural number K such that for every [formula], every linearly independent [formula], every tower (Yδ)δ  <  η of Γ+-compact extensions, every α  ≥  ω, every αK-sequence s, every sequence of polynomials pj of degree 1, and every f,g∈L∞(ZΓ(Y0)) with ||f||∞,||g||∞  ≤  B, there are an n and an α-subsequence t of s such that the property

for every m  ≥  n, [formula]

holds for t-many δ.

Since p has degree 1, [formula] has the form [formula] for some [formula] not all 0. So we may apply Theorem [\ref=wm] to [formula].

By the same argument, we obtain the analogous version of Theorem [\ref=wm2].

The following is our main theorem; we show that for any system A of polynomials, there is a height such that all towers of that height contain many levels which are "almost weak mixing" along the system A.

For every ε > 0, B > 0, and γ  <  ωω, there are polynomials q,q' such that for every integer D, there is an ordinal θ  <  ωγ  ·  q(D) + q'(D) such that for every [formula], every linearly independent [formula], every tower (Yδ)δ  <  η of Γ+-compact extensions, every system of essentially distinct non-constant integral polynomials A with |A|  ≤  D, o(A)  ≤  γ, every {fp}p∈A in L∞(ZΓ(Y0)) with ||fp||∞  ≤  B for each p∈A, every α  ≥  ω, every αθ-sequence s, there are an n and an α-subsequence t of s such that

for every m  ≥  n, [formula]

holds for t-many δ.

We proceed by induction on γ. Since ||  ·  || is subadditive, it suffices to split the key formula into 2D cases, where each fp is replaced by either E(fp|Yδ) or fp - E(fp|Yδ). By Lemma [\ref=tech:split], the claim will follow from the claim for each of these simpler cases. So it suffices to work with the property

for every m  ≥  n, [formula]

where the f'p are terms of the form E(fp|Yδ) or fp - E(fp|Yδ).

When every f'p is the term E(fp|Yδ), this is clearly true for all δ, so we may reduce to the property (**):

for every m  ≥  n, [formula]

where f'p* is fp* - E(fp*|Yδ) = 0 for some p*∈A.

So let ε > 0, B, γ be given. Recall the set Ah with o(Ah) < o(A) (relative to any choice of p0∈Ãh with p0 of minimal weight); for p∈Ah, define p to be one of f'p, [formula], or [formula] for some p'∈A (the correct choice is directed by the calculations below). There are two slightly different cases, depending on whether p* has degree 1; if not, we may apply IH to obtain a θ so that, given {fp} and an αθ-sequence s, there is a subsequence t, an H large enough (see below), and an N such that

for every m  ≥  N and h∈[ -  H,H],

holds for t-many δ, and in this case. If p* does have degree 1, we apply Lemma [\ref=tech:tech] to Lemma [\ref=wmgen] and IH, and obtain the property that for t-many δ, [formula] holds and additionally

(The bounds from 1 - H to H - 1, instead of 0 to H - 1, are insignificant, since we can bound the positive and negative halves simultaneously using Lemma [\ref=tech:split], and so their sum is also bounded.)

We claim that whenever these conditions hold at δ, (**) holds as well for n: =  max {N,cH} where c is an integer chosen large relative to ε and B. To see this, observe that

[formula]

where ||Ψ'H|| and ||Ψ''H|| are small when c is large and m  ≥  n.

Consider the expression [formula]. If p has degree 1, this is [formula], and if p has degree greater than 1, this is [formula]. In particular,

[formula]

where each p is one of f'p', [formula], or [formula] for some p'∈A. For any p0∈Ãh, we also have

[formula]

and when p0 has minimal weight, this is equal to

[formula]

When m  ≥  n, [formula] implies that

[formula]

is close to

[formula]

Recall that E(f'p*|Yδ) = 0. If p* has degree greater than 1 then for all but an initial segment of the h, p = f'p* for some p∈Ah, and therefore this expression is 0. If p* has degree equal to 1, this expression is bounded by

[formula]

But by [formula],

[formula]

is close to ||E(f'p*|Yδ)||2L2 = 0.

Similarly, we can prove the same thing for formal elements of the relative square:

For every ε > 0, B > 0, and γ  <  ωω, there are polynomials q,q' such that for every integer D, there is an ordinal θ  <  ωγ  ·  q(D) + q'(D) such that for every [formula], every linearly independent [formula], every tower (Yδ)δ  <  η of Γ+-compact extensions, every system of essentially distinct non-constant integral polynomials A with o(A)  ≤  γ and |A|  ≤  D, and every {fp} in L∞0(ZΓ(Y0)  ×  ZΓ(Y0)) with ||fp||∞  ≤  B, every α  ≥  ω, every αθ-sequence s, there are an n and an α-subsequence t of s such that

for every m  ≥  n, [formula]

holds for t-many δ.

Identical to the proof of the previous theorem, using Lemma [\ref=wm2] in place of Theorem [\ref=wm].

As in [\cite=bergelson96], we prove the following special cases:

For every ε > 0, B > 0, and γ  <  ωω, there is an ordinal θ  <  ωγ  ·  ω such that for every [formula], every linearly independent [formula], every tower (Yδ)δ  <  η of Γ+-compact extensions, every system of pairwise essentially distinct polynomials A with o(A)  ≤  γ, every {fp}p∈A in L∞(ZΓ(Y0)) with ||fp||∞  ≤  B for each p∈A, every α  ≥  ω, every αθ-sequence s, there are an n and an α-subsequence t of s such that

for every m  ≥  n, [formula]

holds for t-many δ.

Repeatedly applying Lemma [\ref=tech:split], we may reduce to proving

for every m  ≥  n, [formula]

where f'p is either fp - E(fp|Yδ) or E(fp|Yδ), and for at least one p the first case holds.

By Theorem [\ref=polywm2] and for suitable δ, we may choose θ, and given the remaining parameters (using [formula] as the elements of L∞0(ZΓ(Y0)  ×  ZΓ(Y0))), since the elements of A are pairwise essentially distinct and the Ti are linearly independent, at most one [formula] is constant. Without loss of generality, we may assume this is a distinguished element c∈A. Then we have

for every m  ≥  n, [formula]

for t-many δ, and therefore

[formula]

But this implies that

[formula]

and, having chosen δ small in ε and B, also

[formula]

For every ε,ε' > 0, and γ  <  ωω, there is an ordinal θ  <  ωγ  ·  ω such that for every [formula], every linearly independent [formula], every tower (Yδ)δ  <  η of Γ+-compact extensions, every system of pairwise essentially distinct integral polynomials A with o(A)  ≤  γ, every set B measurable with respect to ZΓ(Y0), every α  ≥  ω, every αθ-sequence s, there is an α-subsequence t of s such that

[formula] has density 0

holds for t-many δ.

Apply Corollary [\ref=polywm2] to χB obtain

[formula]

Setting [formula], if the set

[formula]

has positive density then we could find c such that for arbitrarily large N, {n∈P|n < N}  ≥  cN, and therefore

[formula]

which is a contradiction.

We could insist on slightly more, requiring that the sets begin having low density at a fixed value n simultaneously, for instance, but we do not need this.

Almost Primitive Extensions

The following is essentially shown in [\cite=furstenberg79]:

If for every α, Yα is an SZP-system then so is the system generated by [formula].

Bergelson and Liebman [\cite=bergelson96] prove the following:

Let X be an extension of Y with Y SZP, let [formula] so that X is compact relative to Y with respect to Γ, let f∈L2(X) be given. Let [formula] each have the form [formula] for some sequence of pairwise distinct integral-zero polynomials pj and some [formula] in Γ, and let [formula] have the form [formula] for some polynomial p and some [formula] in Δ. Let B be measurable with respect to Y with μ(B) > 0, and let ε > 0. Then there exist [formula], (P) > 0, a family of sets {Bn|n∈P}, each Bn measurable with respect to Y, and a b > 0 so that, for any n∈P, 1  ≤  j  ≤  s, 1  ≤  i  ≤  r, we have

μ(Bn) > b

Sj(n)Bn  ⊆  B

[formula].

For our purposes, we need slightly more than this: we need a little bit of continuity allowing us to pass to an approximation to Y while retaining some control over the value of b. Fortunately, the following strengthening follows immediately from their proof:

Let X be an extension of [formula] with Y SZP, let [formula] so that X is compact relative to Y with respect to Γ, let f∈L2(X) be given. Let [formula] each have the form [formula] for some polynomial p and some [formula] in Γ, and let [formula] have the form [formula] for some sequence of pairwise distinct integral-zero polynomials pj and some [formula] in Δ. Let B be measurable with respect to Y with μ(B) > 0, and let ε > 0. There is a b, an ε' > 0, and an M such that for each m  ≥  M and each B' measurable with respect to Ym such that [formula], there exists [formula], (P) > 0 and a family of sets {Bn|n∈P}, each Bn measurable with respect to Y, so that, for any n∈P, 1  ≤  j  ≤  s, 1  ≤  i  ≤  r, we have

μ(Bn) > b

Sj(n)Bn  ⊆  B'

[formula].

To simplify notation, we write ω4 for the ordinal ωωωω.

If (Yδ)δ  <  ω4 is a tower of Γ-compact extensions for every [formula] of dimension ≥  d - n and each Yδ is SZP then [formula] is SZP.

By Lemma [\ref=SZPlimit], it suffices to show that [formula] is SZP for each [formula] of dimension ≥  d - n - 1 and δ  <  ω4. Further, since we can replace Y0 with Yδ and still have a tower of height ω4 above, it suffices to show that ZΓ(Y0) is SZP.

Fix some system of polynomials A and some [formula]. We may assume that for some q, [formula] and [formula].

Let C be a measurable set in ZΓ(Y0) with μ(C) > a. For each p∈A, we may write [formula] where [formula] and [formula]. We may list the pairwise distinct components [formula], [formula] appearing. It suffices to find a set P of positive lower density and a c > 0 so that for each n∈P, [formula].

By Lemma [\ref=polywm3], for each m, we may find a δm and a [formula] such that the complement of P'm has density 0 and the set of y such that

[formula]

has size less than 1 / m. We may assume that the sequence δm is increasing, and set δ: =  lim m  →    ∞δm.

Let [formula] and let B: = {y|E(C|Yδ))(y) > a}; in particular, μ(B) > 0 and B is measurable with respect to Yδ. Apply the preceeding lemma to χC, B, and Yδ; we obtain b and an ε', and may choose m so that B': = {y|E(C|Yδm))(y) > a} satisfies [formula] and 1 / m < b / 2 is sufficiently small relative to b. We obtain P,{Bn} such that, in particular, [formula] and E((Sj(n))- 1C|Yδm))(y) > a for each y∈Bn.

Now consider some [formula]; for all y∈Bn, [formula], and for all y∈Bn except for a set of size at most b / 2,

[formula]

Therefore, for such y, [formula]. Finally, for every y∈Bn, [formula], and therefore [formula]. Since this holds for a set of y of size ≥  b / 2, it follows that [formula].

If Z is SZP then so is Yd - n,ω4α(Z) for every α.

For all Z simultaneously, by main induction on n and side induction on α. For all n, the limit case follows from Lemma [\ref=SZPlimit].

When n = 0, the claim follows at successor stages since Yd,ω4α + 1(Z) is a compact extension of Yd,ω4α(Z) and it is shown in [\cite=bergelson96] that compact extensions preserve the SZP property.

If the claim holds for n and Yd - n - 1,ω4α(Z) is SZP, the previous theorem implies that

[formula]

is compact since, by main IH, Yd - n,ω4ω4(Yd - n - 1,ω4α(Z)) is SZP.

In particular, the trivial factor is SZP, so if Z is the trivial factor, the previous theorem implies that the entire space X  =  Y0,ω41(Z) is SZP as well. Therefore all dynamical systems are SZP.