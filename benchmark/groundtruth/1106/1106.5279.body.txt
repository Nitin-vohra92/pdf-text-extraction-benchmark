=1

Proposition Lemma Guess Corollary Proposition/Definition

Definition Notation Observation Conjecture Example

Remark

A Penrose polynomial for embedded graphs

Introduction

The Penrose polynomial, P(G,λ), of a plane graph first appeared implicitly in [\cite=Pen71], where it arose out of Penrose's work on diagrammatic tensors. The Penrose polynomial has a number of remarkable graph theoretical properties, particularly with respect to graph colouring. For example, it is well-known that The Four Colour Theorem is equivalent to showing that every plane, cubic, connected graph can be properly edge-coloured with three colours. The Penrose polynomial encodes exactly this information (see Penrose [\cite=Pen71]): if G is a plane, cubic, connected graph, then

[formula]

In addition to this relation with the Four Colour Theorem, the Penrose polynomial has a host of other significant graph theoretical properties. We refer the reader to the excellent expositions on the Penrose polynomial given by Aigner in [\cite=Ai97] and [\cite=Aig00], and also to the papers [\cite=AM00] [\cite=E-MS01] [\cite=Sar01] [\cite=Sze02] for further explorations of its properties.

In this paper we extend the Penrose polynomial, previously defined only for plane graphs, to graphs embedded in arbitrary surfaces. This leads to a number of new properties of the Penrose polynomial of both plane graphs and embedded graphs. Our primary tools for investigating the Penrose polynomial are twisted duality and the ribbon group action which were introduced by the authors in [\cite=E-MMe], where they were used to solve isomorphism problems involving medial graphs and to expose the connections among embedded graphs and their medial graphs. This ribbon group action depends on two operations: τ(e) which gives a half-twist to an edge e, and δ(e) which forms the partial dual with respect to an edge e. The connection between the ribbon group action and the Penrose polynomial arises through the transition polynomial. It has been shown that the Penrose polynomial of a plane graph can be expressed in terms of the transition polynomial (see e.g. [\cite=Ja90]). We will show that, analogously, the Penrose polynomial of an embedded graph can be written in terms of the topological transition polynomial defined in [\cite=E-MMe]. Also, in [\cite=E-MMe], it was shown that the ribbon group acts on embedded graphs and on the topological transition polynomial in a compatible way. It is this connection between operations on embedded graphs and graph polynomials that we exploit to determine properties of the Penrose polynomial.

Many of the properties we describe here can not be realized within the class of plane graphs in that a relation for a graph G may involve graphs embedded in different surfaces than G. For example, we will show that, for embedded graphs, the Penrose polynomial satisfies the deletion-contraction relation

[formula]

, where Gδτ(e) is a twisted dual of G, and is generally non-plane. We also show that the Penrose polynomial of a plane graph G can be expressed as a sum of the chromatic polynomials of the duals of its partial Petrials, where a partial Petrial results from giving a half-twist to some subset of the edges of a graph:

[formula]

This identity completes a result of Aigner from [\cite=Ai97], which states that

[formula]

for all [formula]. The expression χ(G*;k) in Aigner's inequality is a single summand in our expression ([\ref=penchrom1]) for the Penrose polynomial P(G;k).

This relation between the chromatic and Penrose polynomials allows us to give a new reformulation of the Four Colour Theorem in terms of the chromatic polynomial.

Further to these results, which illustrate the advantage of considering the Penrose polynomial for graphs embedded in an arbitrary surface, rather than just the plane, we also discuss which of the known properties of the Penrose polynomial for plane graphs extend to non-plane graphs. In particular, we relate the Penrose polynomial of an orientable checkerboard colourable graph to the circuit partition polynomial of its medial graph and use this to find new combinatorial interpretations of the Penrose polynomial.

This paper is structured as follows. We begin with some preliminary definitions for embedded graphs. Then, in Section [\ref=s.penrose], we define the Penrose polynomial of an embedded graph, discuss some differences between the plane and non-plane Penrose polynomial, and describe the relation between the topological transition polynomial and the Penrose polynomial, which is of fundamental importance here. In Section [\ref=s.td], we give a reasonably comprehensive overview of the ribbon group action and twisted duality, our main tools in this paper, and describe how the ribbon group interacts with the transition polynomial. In Section [\ref=s.tdpenrose] we apply our results on twisted duality to to obtain identities for the Penrose polynomial, including several deletion-contraction relations. Section [\ref=s.cpp] contains the relation to the circuit partition polynomials and new combinatorial interpretations for evaluations of the Penrose polynomial. In Section [\ref=s.colour], by examining connections between the Penrose polynomial and graph colourings we express the Penrose polynomial as a sum of the chromatic polynomials of twisted duals. We conclude with a new reformulation of the Four Colour Theorem.

We would like tho thank Gabriel Cunningham for helpful comments.

Preliminary definitions

Embedded graphs and medial graphs

A cellularly embedded graph is a graph G embedded in a surface Σ such that every face is a 2-cell. If G  ⊂  Σ, the homeomorphism class of the surface Σ generates an equivalence class of embedded graphs, and we say that embedded graphs are equal if they are in the same equivalence class. We assume familiarity with embedded graphs, referring the reader to [\cite=GT87] for further details.

We use standard notation: V(G), E(G), and F(G) are the sets of vertices, edges, and faces, respectively, of a cellularly embedded graph G, while v(G), e(G), and f(G), respectively, are the numbers of such. We will say that a loop ( i.e. an edge that is incident to exactly one vertex) in a cellularly embedded graph is non-twisted if a neighbourhood of it is homeomorphic to an annulus, and we say that the loop is twisted if a neighbourhood of it is homeomorphic to a Möbius band.

Representing cellularly embedded graphs

There are several ways to represent cellularly embedded graphs, and it is often more convenient and natural to work in the language of one or the other of these representations. Thus, we briefly describe ribbon graphs, arrow presentations and their equivalence to each other and to signed rotation systems and cellularly embedded graphs. Further details may be found in [\cite=Ch1] [\cite=GT87].

A ribbon graph [formula] is a (possibly non-orientable) surface with boundary, represented as the union of two sets of topological discs, a set V(G) of vertices, and a set E(G) of edges such that:

the vertices and edges intersect in disjoint line segments;

each such line segment lies on the boundary of precisely one vertex and precisely one edge;

every edge contains exactly two such line segments.

Two ribbon graphs are said to be equivalent or equal if there is a homeomorphism between them that preserves the vertex-edge structure. The genus of a ribbon graph is its genus as a punctured surface. A ribbon graph is said to be plane if it is of genus zero. In the context of ribbon graphs, f(G) is the number of boundary components of the surface comprising the ribbon graph G.

It is well known that ribbon graphs and cellularly embedded graphs are equivalent: if G is a cellularly embedded graph, a ribbon graph representation results from taking a small neighbourhood of the embedded graph G. Neighbourhoods of vertices of the graph G form the vertices of a ribbon graph, and neighbourhoods of the edges of the embedded graph form the edges of the ribbon graph. On the other hand, if G is a ribbon graph, we simply cap off the punctures to obtain a ribbon graph cellularly embedded in the surface. Form an embedded graph by placing one vertex in each vertex disc and connect them with edges that follow the edge discs. See Figure [\ref=f.desc], which shows a graph embedded in the projective plane.

We will also find the following, more combinatorial, description of a cellularly embedded graph useful.

An arrow presentation consists of a set of circles, each with a collection of disjoint, labelled arrows, called marking arrows, lying on them. Each label appears on precisely two arrows.

Two arrow presentations are equivalent if one can be obtained from the other by reversing the direction of all of the marking arrows which belong to some subset of labels, or by relabelling the pairs of arrows.

A ribbon graph can be obtained from an arrow presentation by viewing each circle as the boundary of a disc that becomes a vertex of the ribbon graph. Edges are then added to the vertex discs by taking a disc for each label of the marking arrows. Orient the edge discs arbitrarily and choose two non-intersecting arcs on the boundary of each of the edge discs. Orient these arcs according to the orientation of the edge disc. Finally, identify these two arcs with two marking arrows, both with the same label, aligning the direction of each arc consistently with the orientation of the marking arrow. This process is illustrated pictorially thus:

[formula]

Conversely, every ribbon graph gives rise to an arrow presentation. To describe a ribbon graph G as an arrow presentation, start by arbitrarily orienting and labelling each edge disc in E(G). This induces an orientation on the boundary of each edge in E(G). Now, on the arc where an edge disc intersects a vertex disc, place a marked arrow on the vertex disc, labelling the arrow with the label of the edge it meets and directing it consistently with the orientation of the edge disc boundary. The boundaries of the vertex set marked with these labelled arrows give the arrow marked circles of an arrow presentation. See Figure [\ref=f.desc] for an example, and [\cite=Ch1] for further details.

Arrow presentations are essentially signed rotation systems (see [\cite=MT01] for example) with the labels about the circles giving the rotations and the agreement or disagreement of the directions of the marking arrows corresponding to the plus or minus signs on the edges.

Since cellularly embedded graphs, ribbon graphs and arrow presentations are all equivalent, we can, and will, move freely between these representations, choosing whichever is most convenient at the time for our purposes. We will use the term 'embedded graph' loosely to mean any one of these representations of a cellularly embedded graph.

Medial graphs

The Penrose polynomial of a plane graph can be defined via its medial graph, and we similarly will define the Penrose polynomial of an embedded graph via its medial graph. Accordingly, medial graphs play a central role in this paper. If a graph G is cellularly embedded, we construct its medial graph, Gm, by placing a vertex of degree 4 on each edge of G, and then drawing the edges of the medial graph by following the face boundaries of G. Consistent with this definition is that the medial graph of an isolated vertex is an isolated face, and we adopt this convention. Note that if G is cellularly embedded in a surface Σ, then Gm is also cellularly embedded in Σ.

A checkerboard colouring (or face 2-colouring) of a 4-regular embedded graph F is an assignment of the colour black or white to each of its faces such that adjacent faces have different colours. While not all 4-regular embedded graphs admit checkerboard colourings, all medial graphs do. In fact, we can associate a canonical checkerboard colouring to a medial graph. In the construction of Gm, the vertices of G appear in some of the faces of Gm. Thus we can associate a face of Gm with each vertex of G. We can then construct a checkerboard colouring (or face 2-colouring) of Gm by colouring a face black if it is associated with a vertex of G, and colouring it white otherwise. This checkerboard colouring is called the canonical checkerboard colouring of Gm.

An example of a medial graph and its canonical checkerboard colouring is given in Figure [\ref=fig.medialgraph].

Weight systems and graph states

A vertex state at a vertex v of an abstract 4-regular graph F is a partition, into pairs, of the edges incident with v. Thus, if F is an cellularly embedded graph, a vertex state is simply a choice of one of the following configurations in a neighbourhood of the vertex v:

[formula]

A choice of one of the configurations on the right replace a small neighbourhood of the vertex v.

If G is an embedded graph and Gm its canonically checkerboard coloured medial graph, then we may use the checkerboard colouring to distinguish among the vertex states, naming them a white split, a black split or a crossing, as follows:

[formula]

A graph state s of any 4-regular graph F is a choice of vertex state at each of its vertices. Each graph state corresponds to a specific family of edge-disjoint cycles in F, and this family is independent of embedding (although different embeddings of F will generally use different vertex states to generate the same family of disjoint cycles). We call these cycles the components of the state, denoting the number of them by c(s). We will denote the set of states of a 4-regular graph F by St(F). If Gm is the canonically checkerboard coloured medial graph of G, then P(Gm) denotes the set of states with no black splits, and we will call such states Penrose states.

Three of the possible nine graph states of the graph [formula] are  ,  , and  .

A weight system, W(F), of any 4-regular graph F (embedded or not) is an assignment of a weight in a unitary ring R to every vertex state of F. (We simply write W for W(F) when the graph is clear from context.) If s is a state of F, then the state weight of s is [formula], where ω(v,s) is the vertex state weight of the vertex state at v in the graph state s. See [\cite=E-MS02] for further details.

If Gm is an embedded medial graph, then we can construct a weight system by associating a weight to white splits, black splits and crossings as in the definition below. We will use the resulting medial weight system to define the Penrose polynomial of an embedded graph in Section [\ref=s.penrose].

Let G be an embedded graph with embedded medial graph Gm. Define the medial weight system, Wm(Gm), using the canonical checkerboard colouring of Gm as follows. A vertex v has state weights given by an ordered triple (αv,βv,γv), indicating the weights of the white split, black split, and crossing state, in that order. We write [formula] for the set of these ordered triples, indexed, equivalently, either by the vertices of Gm, or by the edges of G.

Visually, the medial weight system [formula] will assign weights to a vertex v of Gm as follows:

weight αv βv γv

.

We will use the following convention: if in a medial weight system [formula] we have [formula], where [formula], we mean that each αv = k, and similarly for [formula] and [formula]. For example, [formula], denotes the medial weight system where αv =  - 1, βv = 0, and γv = 1, for each v.

The topological Penrose polynomial

The Penrose polynomial of an embedded graph

We now have the necessary foundations to extend the Penrose polynomial to embedded graphs. The classical Penrose polynomial is just Definition [\ref=d.Penrose] restricted to plane graphs.

Let G be an embedded graph with canonically checkerboard coloured medial graph Gm, let St(Gm) be the set of states of Gm, and let P(Gm) be the set of Penrose states. Then the Penrose polynomial is defined by

[formula]

where ωP(s) denotes the graph state weights of the medial weight system WP(Gm) defined by [formula], where c(s) is the number of components in the graph state s, and cr(s) is the number of crossing vertex states in the graph state s.

As an example, consider the graph G embedded on the torus shown below.

[formula]

The terms of the Penrose polynomial are calculated as follows:

+  λ -  λ -  λ -  λ

+  λ +  λ2 +  λ2 -  λ

Thus, P(G;λ) = 2λ2 - 2λ.

The Penrose polynomial of a plane graph may also be computed via a linear recursion relation (see Jaeger [\cite=Ja90]), by repeatedly applying the skein relation

[formula]

to vertices of degree 4 in Gm, and at the end, evaluating each of the resulting cycles to x. This extends mutis mutandis to embedded graphs and the topological Penrose polynomial.

The relation with the transition polynomial

There is a very useful relation, due to Jaeger [\cite=Ja90], between the original Penrose and transition polynomials. Here we will show that this relation extends to a relation between the topological Penrose polynomial and the topological transition polynomial given in [\cite=E-MMe]. Many of the results presented in this paper rely on this relation between these two topological graph polynomials.

The generalized transition polynomial, q(G;W,t), of [\cite=E-MS02] extends the transition polynomial of Jaeger [\cite=Ja90] to arbitrary Eulerian graphs and incorporates pair and vertex state weights. For the current application, however, we will restrict q to 4-regular embedded graphs (typically medial graphs) and we will only work in the generality needed for our current application. See [\cite=E-MS02] or [\cite=ES] for further details on the generalized transition polynomial.

Let F be a 4-regular graph having weight system W with values in a unitary ring R. Then the generalized transition polynomial is

[formula]

where the sum is over all graph states s of F.

Because we are interested in applications to the Penrose polynomial, we specialize further to embedded medial graphs and to medial weight systems and the topological transition polynomial of [\cite=E-MMe], defined as follows.

Let G be an embedded graph with canonically checkerboard coloured embedded medial graph Gm, and let [formula] be a medial weight system. Then the topological transition polynomial of G is:

[formula]

We will also use the following recursive formulation of the topological transition polynomial, which follows from its being a specialization of the generalized transition polynomial, which has such a recursion (see [\cite=E-MS02]). We use the notation that if v is a vertex of Gm, then (Gm)bl(v), (Gm)wh(v), and (Gm)cr(v) denote the graphs obtained by taking a black, white, or crossing state, respectively, at the vertex v.

The topological transition polynomial may be computed by repeatedly applying the following linear recursion relation at each v∈V(Gm), and, when there are no more vertices of degree 4 to apply it to, evaluating each of the resulting closed curves to an independent variable t:

[formula]

The recursion relation in Proposition [\ref=p.recQ] has the following pictorial presentation:

[formula]

A comparison between the skein relation for the Penrose polynomial in Equation [\eqref=e.skP], and the skein relation for the topological transition polynomial in Equation [\eqref=e.skT] immediately makes clear how the Penrose polynomial is related to the topological transition polynomial:

Let G be an embedded graph and Gm be its canonically checkerboard coloured medial graph. Then

[formula]

where Q is the topological transition polynomial.

Some distinctions between the classical and topological Penrose polynomials

The Penrose polynomial of a plane graph is known to satisfy several combinatorial identities and has numerous connections with graph colouring. It is natural to ask which of these properties hold for arbitrary embedded graphs. We begin by observing that many of the basic properties of the Penrose polynomial of a plane graph given by Penrose in [\cite=Pen71], Jaeger in [\cite=Ja90], and Aigner in [\cite=Ai97] do not hold for non-plane graphs. For example, the following properties for plane graphs provided by Aigner in [\cite=Ai97] do not hold for embedded graphs in general, although we will see in Section [\ref=s.cpp] that some of them do hold for orientable checkerboard colourable graphs. Some small counterexamples to non-plane extensions of these properties are provided by: F1  =   with P(F1;λ) =  - λ3 + 3λ2 - 2λ; by F2  =   with P(F2;λ) = λ3  -  λ; and by F3  =   with P(F3;λ) = 4(λ2  -  λ). F1 gives counter examples to Items [\ref=faces], [\ref=3colour], while F2 gives counter examples to Items [\ref=verts], [\ref=edges], [\ref=twoface] and [\ref=faces], and F3 to Items [\ref=edges], and [\ref=notwoface]. For Item [\ref=bridge], if G is an embedded graph that contains a bridge, the P(G;λ) = 0, but Example [\ref=hemi] will give an example of a bridgeless, non-plane embedded graph with trivial Penrose polynomial.

If G is plane and Eulerian then P(G;2) = 2v(G).

If G is plane and Eulerian then P(G; - 1) = ( - 1)f(G)2e(G).

If G is plane and edges e,f are both on the same two faces, then P(G;λ) = 2P(G / e;λ).

If G is plane, 2-connected, and has no two faces sharing more than one edge, then the leading term of P(G;λ) is 1.

If G is plane then the degree of P(G;λ) is the number of faces of G.

If G is plane, cubic and connected, then P(G;3) counts the number of edge 3-colourings.

If G is a plane graph, then G contains a bridge if and only if P(G;λ) = 0.

The Penrose polynomial also has the following properties for plane graphs: if G is Eulerian, the coefficients of P(G;λ) alternate in sign; and if G is non-Eulerian, |P(G; - 1)| < 2e(G). We would like to know if these properties hold more generally. A natural extension is to characterize the embedded graphs for which the properties in the above list do hold or give more inclusive combinatorial interpretations for these evaluations of the Penrose polynomial.

Twisted duality

In this section we provide an overview of twisted duality and the ribbon group action which were introduced by the authors in [\cite=E-MMe] to unravel the connections between graphs and their medial graphs, and to solve isomorphism problems for 4-regular graphs. The ribbon group action and the results described in this section provide the tools that we use to determine properties the Penrose polynomial.

Unless otherwise stated, all of the results in this section appear in [\cite=E-MMe], and their proofs and further details may be found therein.

Twisted duals and the ribbon group

In this section we provide an overview of twisted duals and the ribbon group action. The ribbon group action is a far reaching generalization of the idea of the geometric dual of an embedded graph. The importance of the ribbon group lies in that it provides new connections, and a new understanding of the relationship between graphs and their medial graphs. For example, [\cite=E-MMe] shows that two medial graphs Gm and Hm are isomorphic as abstract graphs if and only if G and H are twisted duals. Here we will focus on the way that the ribbon group interacts with graph polynomials, such as the Penrose polynomial, that can be defined through medial graphs.

Let G(n) denote the set of equivalence classes of embedded graphs with exactly n edges. (Recall that the equivalence relation here is generated by homeomorphism of surfaces.) Furthermore, let

[formula]

be the set of equivalence classes of embedded graphs with exactly n ordered edges. As is standard, we will abuse notation and identify a representative of an equivalence class with the class itself.

We will define two operations, a half-twist and a dual, that act on a specified edge of an embedded graph. These operations generate an action, called the ribbon group action, of the group [formula] on the set Gor(n), where [formula] is the symmetric group of degree three.

Let [formula] and suppose ei is the [formula] edge in the ordering [formula]. Also, suppose G is given in terms of its arrow presentation, so ei is a label of a pair of arrows.

The half-twist of the [formula] edge is [formula] where H is obtained from G by reversing the direction of exactly one of the ei-labelled arrows of the arrow presentation. H inherits its edge order [formula] in the natural way from G.

The dual with respect to the [formula] edge is [formula], where H is obtained from G as follows. Suppose A and B are the two arrows labelled ei in the arrow presentation of G. Draw a line segment with an arrow on it directed from the the head of A to the tail of B, and a line segment with an arrow on it directed from the head of B to the tail of A. Label both of these arrows ei, and delete A and B with the arcs containing them. The line segments with their arrows become arcs of a new circle (or circles) in the arrow presentation of H. As with the twist, H inherits its edge order [formula] from G.

The actions of (τ,i) and (δ,i) on an arrow presentation are illustrated thus:

[formula]

Examples of the action of (τ,i) and (δ,i) can be found in Example [\ref=e.pd] below.

It was shown in [\cite=E-MMe] that, for each i, we have [formula]. Consequently, the group

[formula]

which is isomorphic to the symmetric group of order three, acts on the set Gor(n).

This action readily extends to a group action of [formula] on Gor(n) by allowing the twists and partial duals to act on any subset of edges, not just a single distinguished edge. We call [formula] the ribbon group for n edges and define the ribbon group action to be the action of [formula] on Gor(n) given by:

[formula]

where [formula] for all i.

We make the simple but important observation that these operations when applied to different edges commute: if i  ≠  j and ξ,ζ∈{τ,δ}, then [formula]. However, in general, (ξ,i) and (ζ,i) do not commute.

We can now define twisted duals to be embedded graphs that are related under the ribbon group action.

Two embedded graphs with linearly ordered edges [formula] and [formula] are said to twisted duals if (the equivalence class of) [formula] is in the orbit of (the equivalence class of) [formula] under the ribbon group action.

Two embedded graphs G and G' are said to be twisted duals if [formula] and [formula] are twisted duals for some edge orderings [formula] and [formula] of G and G' respectively.

As an example, all of the embedded graphs shown in Example [\ref=e.pd] are twisted duals.

In this paper, we will focus on twisted duality for embedded graphs without edge ordering. In [\cite=E-MMe], it was shown that every twisted dual of an embedded graph G can be written in the form [formula]. For our purposes, this notation is particularly efficient and we will now give a quick exposition of it. In order to introduce the notation [formula], we need to first introduce the notation Gξ(A). To do this, suppose that G∈G(n), A  ⊆  E(G) and [formula]. Then Gξ(A) is defined by letting [formula] be an arbitrary ordering [formula] of the edges of G; and [formula], where εi  =  ξ if ei∈A and εi = 1 otherwise. With this, we can then define

[formula]

If, in addition, B  ⊆  E(G) and [formula] then we set Gξ(A)ζ(B): = (Gξ(A))ζ(B), and Gξζ(A): = Gζ(A)ξ(A).

With this notation, it can be shown (see Proposition 3.7 of [\cite=E-MMe]) that every twisted dual admits a unique expression of the form

[formula]

where the Ai partition E(G), and where ξ1 = 1,ξ2  =  τ,ξ3  =  δ,ξ4  =  τδ,ξ5  =  δτ, and [formula].

To illustrate the ribbon group action, we recall the following example from [\cite=E-MMe].

If G is an embedded graph with E(G) = {e1,e2}, with the order (e1,e2), represented as an arrow presentation and as a ribbon graph shown below,

[formula]

then we have

[formula]

and

[formula]

The full orbit of G is

[formula]

If [formula], then

[formula]

Other important forms of duality appear as actions of subgroups of of the ribbon group on the set of embedded graphs. These dualities include geometric duality, Petriality, and Chmutov's partial duality from [\cite=Ch1]. These connections were discussed in detail in [\cite=E-MMe], and we summarize them below.

The action of the ribbon group on the transition polynomial

We will be especially interested in the behaviour of the Penrose polynomial under the operations of twisted duality. In order to study how the Penrose polynomial of an embedded graph and its twisted duals are related, we consider the action of the ribbon group on the more general topological transition polynomial. The effect of twisted duality on the Penrose polynomial can then be determined by applying Proposition [\ref=p.petr]. In this subsection we review the action of the ribbon group on the topological transition polynomial that was introduced in [\cite=E-MMe].

The group [formula] is isomorphic to [formula] via an isomorphism η defined by

[formula]

Furthermore, the symmetric group [formula] acts on the ordered triple, (αv,βv,γv), of the weight system at a vertex by permutation. This action by [formula] on weight systems at a vertex can be extended to an action of [formula] on medial weight systems of medial graphs with n linearly ordered vertices. Since we will only need the order independent analogue of this action, we will focus on it here. This action allows us to use the ribbon group to modify the medial weight system of an embedded medial graph.

To define this action, let Gm be a canonically checkerboard coloured embedded medial graph of an embedded graph G with medial weight system Wm (or equivalently [formula]). Suppose further that [formula] where the Ai's partition E(G), and the ξi's are the six elements of [formula] (as in Equation [\eqref=e.ga]). Then we define WmΓ (or [formula]), the weight system permuted by Γ, to be the ordered triple of the weight system at a vertex ve given by η(ξi)(αve,βve,γve) when e∈Ai.

In [\cite=E-MMe], it was shown that this action of the ribbon group on a medial weight system is compatible with the action of the ribbon group on embedded graphs. This compatibility is given in Theorem [\ref=t.qsd] as a twisted duality relation for the topological transition polynomial. This twisted duality relation says that the topological transition polynomial of the medial graph of G is the same as that of the medial graph of any of the twisted duals, provided the weight system is appropriately permuted. We will apply this twisted duality relation in the subsequent sections to derive new properties for the Penrose polynomial.

Let G be an embedded graph with embedded medial graph Gm, and let [formula] where the Ai's partition E(G), and the ξi's are the six elements of [formula]. Then,

[formula]

or equivalently,

[formula]

We note that this twisted duality identity for the transition polynomial unifies a number of duality relations for several important graph polynomials. These relations include the well-known identity T(G;x,y) = T(G*;y,x) for the Tutte polynomial; the identity [formula], from [\cite=ES], for the topological transition polynomial; the identities for Bollobás and Riordan's topological Tutte polynomial under duality from [\cite=ES] [\cite=Mo1], and under partial duality from [\cite=Ch1] [\cite=E-MMd] [\cite=Mo3] [\cite=VT].

Deletion, contraction, and the transition polynomial

If H is an abstract ( i.e. non-embedded) graph and e is any edge of H, then the contraction H / e of H along e will always result in an abstract graph, and so contraction is a well defined operation on abstract graphs. However, for graphs embedded in surfaces, contraction is a more subtle operation. Suppose that a graph G is cellularly embedded in a surface Σ. If e is not a loop, then G / e is defined as the embedded graph obtained taking the quotient Σ  /  {e}. Contraction then works as expected for non-loops. Moreover, this definition of contraction is compatible with the contraction of a non-loop in a ribbon graph (if G is a ribbon graph, then G / e is the ribbon graph obtained by contracting the edge disc e). However, difficulties arise when the edge e is a loop. In this case, the quotient space Σ  /  {e} need not be a surface. So with this definition of contraction, the contraction of a loop in a cellularly embedded graph can result in a graph embedded in a pseudo-surface. Furthermore, if we view G as a ribbon graph, and if e is a loop incident to v, then forming the quotient of the ribbon graph G by the disc e will take the vertex v of G to an annulus rather than a disc, and the quotient is not a ribbon graph.

In [\cite=BR2], Bollobás and Riordan defined a way to contract edges of a ribbon graph in a way that was compatible with the usual contraction of non-loop edges, and with the deletion-contraction relations of their topological Tutte polynomial. Chmutov, in [\cite=Ch1], showed that Bollobás and Riordan's definition of contraction can be cleanly expressed in terms of partial duality. We take Chmutov's expression to be our definition of the contraction of any edge of an embedded graph.

Let G be an embedded graph and e be any edge of G, then

[formula]

Let G be the embedded graph consisting of a single vertex and a loop e. Then G / e is the embedded graph consisting of two isolated vertices.

As a second example, if [formula], then [formula], and [formula].

This definition of contraction allowed the authors to find, in [\cite=E-MMe], a three term deletion-contraction relation for the topological transition polynomial. This deletion-contraction relation, which is stated in the following theorem, will be important in our study of the Penrose polynomial.

Let G be an embedded graph and e∈E(G). Then

[formula]

where the weight systems on the right-hand side are the weight systems on G / e, G - e or Gτ(e) / e induced by [formula].

Let G be an embedded graph, e∈E(G) and [formula]. Let [formula], so that , (α'e,β'e,γ'e)  =  η(ξ)(αe,βe,γe) where the permutation η(ξ) is defined in Subsection [\ref=ss.tdtrans]. Then

[formula]

where the weight systems on the right-hand side are the weight systems on Gξ(e) / e, Gξ(e) - e or Gτξ(e) / e induced by [formula].

Twisted duality and identities for the Penrose polynomial

One of the major advantages of considering the topological Penrose polynomial is that it satisfies various identities that are not realizable in terms of plane graphs. Many of these identities arise by considering twisted duality. For example, we see in this context that, unlike the classical Penrose polynomial of a plane graph, the topological Penrose polynomial has deletion-contraction reductions similar to those for the Tutte polynomial.

Some non-plane identities for the Penrose polynomial

The following proposition provides a reformulation of the Penrose polynomial that will be useful later. This proposition expresses the Penrose polynomial P(G;λ) as a sum over all of the partial Petrials, Gτ(A), of G.

Let G be a ribbon graph, then

[formula]

recalling that f(G) is the number of faces of G.

Let Gm be naturally embedded in the same surface as G. To each Penrose state s of Gm associate a set As  ⊆  E(G) by including an edge e in As if and only if the vertex state se at the vertex ve of Gm corresponding to e is a crossing. This gives a bijection between the set of Penrose states and the set of subsets of E(G). Clearly cr(s) = |As|. To prove the lemma we must show that c(s) = f(Gτ(As)). To see why this is the case, let a,b,c,d be the corners of e. If se is a crossing that forms arcs (ac) and (bd) along e, then in Gτ(As), the boundary of the half-twisted edge e also forms arcs (ac) and (bd). Similarly, if se is a white split that forms arcs (ad) and (bc) along e, then in Gτ(As), the boundary of the edge e also forms arcs (ad) and (bc). Since the points a,b,c,d for each edge e are connected along the vertex set of G in an identical way for both Gτ(As) and s, then c(s) = f(Gτ(As)). The proposition then follows.

Many graph polynomials satisfy natural duality relations (for example, the Tutte polynomial satisfies T(G;x,y) = T(G*;y,x) for plane graphs). In the following result, we give a duality, or rather a twisted duality, identity for the Penrose polynomial.

Let G be an embedded graph and e be any edge of G. Then the Penrose polynomial satisfies the following twisted duality relation:

[formula]

We begin with the equation

[formula]

To see why this equation holds, note that by applying Proposition [\ref=p.recQ] to the weight systems WP, Wδ(e)p, and Wτδ(e)P, respectively, we have

[formula]

[formula]

and

[formula]

Substituting the three identities above into the left and right hand sides of Equation [\eqref=eq.peng2] will give the required equality.

We will now express each of the terms in Equation [\eqref=eq.peng2] in terms of the Penrose polynomial. By Proposition [\ref=p.petr], we have

[formula]

For the second term we have

[formula]

where the first equality follows by Proposition [\ref=p.petr], the second follows from Theorem [\ref=t.qsd], and the third follows from the fact that (δ(e))(δ(e))  =  1(e).

Finally, we can rewrite third term of Equation [\eqref=eq.peng2]:

[formula]

Here, the first equality follows by Proposition [\ref=p.petr], the second follows from Theorem [\ref=t.qsd], and the third from the fact that (δτ(e))(τδ(e))  =  1(e).

The result stated in the proposition then follows by substituting the identities in Equations [\eqref=eq.peng12], [\eqref=eq.peng13] and  [\eqref=eq.peng14] into Equation [\eqref=eq.peng2].

The final form in the statement of the theorem is obtained by applying the first to Gδ(e).

The Penrose polynomial of an embedded graph G has the following properties.

If A  ⊆  E(G), then P(G;λ)  =  ( - 1)|A|P(Gτ(A);λ), and in particular |P(G;λ)| is an invariant of the orbits of the half-twist, (i.e. of partial Petrials). Furthermore, [formula].

If e is a non-twisted loop of G that bounds a 2-cell, then P(G;λ)  =  (λ - 1)P(G - e;λ).

The Penrose polynomial satisfies the four-term relation:

[formula]

where the four ribbon graphs in the figure are identical except in the region shown.

We will prove the properties one by one.

We have that

[formula]

where the first equality follows from Proposition [\ref=p.petr], the second from Theorem [\ref=t.qsd], and the third follows from the fact that τ(A)τ(A) = 1(A). It remains to show that

[formula]

This identity follows by recalling the skein definition of the Penrose weight system:

[formula]

and observing that the relations differ only by a factor of - 1. This proves both parts of Item ([\ref=651]).

The proof of this property is routine and therefore omitted.

Let Gi, for [formula], be the four embedded graphs shown in the four-term relation of Item [\ref=4term_fig] in the order shown in the defining figure. There is a natural bijection between their edge sets. Identify the edge sets of each of the Gi's using this correspondence, letting e and f denote the distinguished edges of the Gi's shown in the figure. Since by Proposition [\ref=l.peng]

[formula]

it is enough to show that for a fixed subset A of E(Gi) - {e,f}, we have

[formula]

This identity is easily verified by calculation.

The fact that the state sum defining the Penrose polynomial satisfies the four-term relation is well known in the theory of Vassiliev invariants of knots (see e.g. [\cite=BN95]) that we are now able to recognize in the context of the topological Penrose polynomial. This result appears in knot theory since the Penrose polynomial can be expressed in terms of the [formula] weight system.

If G is a self-Petrial embedded graph, then P(G;λ) = 0 or |E(G)| is even.

G is self-Petrial if and only if Gτ(E(G)) = G. By Item [\eqref=651] of Proposition [\ref=p.penid], we then have P(G;λ)  =  ( - 1)|E(G)|P(Gτ(E(G));λ), and the result follows.

In Section [\ref=distinct] it was noted that a plane graph has trivial Penrose polynomial if and only if it contains a bridge. While P(G;λ) = 0 for all embedded graphs that contain a bridge, the converse does not hold in general. That is, a trivial Penrose polynomial does not ensure that an embedded graph contains a bridge. For example, the hemidodecahedron is bridgeless, but, as it has an odd number of edges and is self-Petrial, it follows from Corollary [\ref=c.sp] that its Penrose polynomial is zero.

A deletion-contraction relation for the Penrose polynomial

We emphasize that in the following theorem the contraction of a loop e, or any other edge e for that matter, is defined by G / e: = Gδ(e) - e as described in Subsection [\ref=ss.delcon].

By moving into the broader class of embedded graphs, we now see that the Penrose polynomial actually does have deletion-contraction reductions, like those for the Tutte polynomial, albeit with a slight twist.

Suppose G is an embedded graph, and e∈E(G). Then:

[formula]

[formula]

[formula]

Items ([\ref=661]) and ([\ref=662]) follow immediately from Theorem [\ref=t.transdl] and Corollary [\ref=c.trans_delete_contract] and the definition of contraction. (Item ([\ref=662]) also follows from ([\ref=661]) since Gτδ(e) / e  =  Gδτδ(e) - e  =  Gτδτ(e) - e  =  Gδτ(e) - e  =  Gτ(e) / e.) For Item ([\ref=663]), observe that G / e = Gδ(e) - e = Gτδ(e) - e, and so [\eqref=662] gives P(G;λ) = P(Gτδ(e) - e;λ) - P(Gτδ(e) / e;λ). Item [\eqref=663] then follows by applying this identity to Gδτ(e).

Connections with the circuit partition polynomial and some evaluations

An Eulerian digraph is an Eulerian graph with the edges directed so that the in-degree and out-degree are equal at each vertex. The circuit partition polynomial of an Eulerian digraph, [formula], defined in [\cite=E-M98], may be given by [formula], where G is the underlying undirected graph of [formula] and WD is the weight system that assigns a 1 to a pair of edges at a vertex if one is directed into and the other out of the corresponding vertex in [formula] . Pictorially, this is:

[formula]

A number of combinatorial interpretations are known for evaluations of [formula]. We will now relate the Penrose polynomial and the circuit partition polynomial in the special case of orientable checkerboard colourable (i.e. properly face 2-colourable) graphs. This gives new interpretations for the Penrose polynomial for this class of graphs, which in turn motivates interpretations for broader classes of graphs.

The connection between the circuit partition polynomial and the Penrose polynomial for an oriented checkerboard coloured graph G depends on a particular Eulerian digraph based on the medial graph, which we will refer to as the Penrose directed medial graph and denote by [formula]. The digraph [formula] is the graph Gm with the edges directed clockwise as they follow the white faces of G and counter clockwise as they follow the black faces of G (these are the black and white faces of the checkerboard colouring of G, not faces in the canonical checkerboard colouring of Gm). Note that the Penrose states of Gm correspond exactly to the non-zero weighted states of Gm in the weight system WD induced by [formula].

We begin with the following lemma, which is an adaptation of Proposition 3 of [\cite=Ai97].

Let G be an orientable checkerboard colourable graph. Then, if s∈P(Gm) is a Penrose state of Gm, we have [formula].

We begin by reformulating the result in terms of twisted duals. Let s∈P(Gm), and let Bs denote the set of edges of G at which there is a non-crossing vertex state at the corresponding vertex in the state s. We immediately have that cr(s) = e(G) - |Bs|. In addition, since Gτδ(E(G)) and Gτ(E(G)) have the same boundary components, c(s) = f(Gτδ(E(G)) - Bs).

Since G is orientable and G* is bipartite, it follows from Proposition 4.30 of [\cite=E-MMd] that Gτδ(E(G)) is orientable. Thus Euler's formula gives

[formula]

where genus g(Gτδ(E(G)) - Bs) is obtained by summing the genus of the connected components of Gτδ(E(G)) - Bs.

Making the substitutions v(Gτδ(E(G)) - Bs) = f(G), e(Gτδ(E(G)) - Bs) = e(G) - |Bs| = cr(s), and f(Gτδ(E(G)) - Bs) = c(s) in Equation [\eqref=e.pc], gives

[formula]

Considering this equation modulo 2 gives the result.

Let G be an oriented checkerboard coloured graph. Then

[formula]

With the given orientation of [formula], the states of [formula] are precisely the Penrose states of Gm. Thus

[formula]

where the second last equality follows by Lemma [\ref=l.cpp].

We can now extend some results listed in Subsection [\ref=distinct] to more general classes of graphs.

If G is orientable and checkerboard colourable, then P(G;2)  =  2v(G).

By theorem [\ref=t.cpp], [formula]. However, in [\cite=E-M04] it was shown that if [formula] is a 4-regular Eulerian digraph, then [formula], where [formula] is the number of components in the anticircuit state of [formula], that is, the state that results from pairing the two incoming edges and pairing the two outgoing edges at each vertex, so the arrows alternate along the edges of each circuit.

In a medial graph Gm with a Penrose orientation, the anticircuits simply follow the black faces in the canonical checkerboard colouring of Gm, and thus [formula]. Furthermore [formula].

Thus, P(G;2) = ( - 1)f(G) + e(G)( - 2)v(G) = ( - 1)f(G) - e(G) + v(G)2v(G) = ( - 1)2k(G) - γ(G)2v(G). Since G is orientable, γ(G) is even, and the result follows.

If G is orientable and checkerboard colourable, then P(G; - 1)  =  ( - 1)f(G)2e(G).

By Theorem [\ref=t.cpp], [formula]. However, from [\cite=E-M04], if [formula] is a 4-regular Eulerian digraph, then [formula]. Since [formula] is 4-regular, the result follows.

As noted in Subsection [\ref=distinct], these two results do not extend to general embedded graphs.

We can now use the connection in Theorem [\ref=t.cpp], and give combinatorial interpretations for the Penrose polynomial at all negative integers for orientable checkerboard colourable graphs, and to motivate interpretations for all positive integers for all embedded graphs. These interpretations are in terms of special edge colourings of the medial graph extended from those described by Jaeger in [\cite=Ja90] to give combinatorial interpretations for the Penrose polynomial of a plane graph at positive integers. We will recover Jaeger's result as a corollary.

We begin with the special edge colouring, called a k-valuation, extended to general embedded graphs.

Let G be an embedded graph and Gm be its canonically checkerboard coloured medial ribbon graph. A k-valuation of Gm is a k-edge colouring [formula] such that for each i and every vertex ve of Gm, the number of i-coloured edges incident with ve is even.

A k-valuation is said to be admissible if, at each vertex of Gm, the k-valuation is of one of the following two types:

[formula]

where i  ≠  j. The configuration on the left corresponds to a white split state, and the one on the right to a crossing state.

A k-valuation is said to be permissible if at each vertex of Gm, the k-valuation is of one of the two types shown above, or of the following type, called total:

[formula]

We begin with a new combinatorial interpretation for the Penrose polynomial evaluated at negative integers. A different, recursive, formula for plane graphs may be found in [\cite=E-MS01] [\cite=Sar01].

If G is orientable and checkerboard colourable, then [formula], where the sum is over all permissible n-valuations s of Gm and where m(s) is the number of total vertices in s.

By Theorem [\ref=t.cpp], [formula]. However, from [\cite=E-M04], if [formula] is a 4-regular Eulerian digraph, then [formula], where c is an Eulerian n-colouring, that is, an edge colouring of [formula] such that the restriction to any one colour is an Eulerian digraph (not necessarily connected), and where m(c) is the number of total vertices. Since this exactly corresponds to a permissible n-colouring, the result follows.

Proposition [\ref=total] does not hold for general embedded graphs. For example, any graph with a bridge has a Penrose polynomial of zero.

The following theorem, which expresses the Penrose polynomial of a plane graph in terms of k-valuations, is due to Jaeger (see [\cite=Ja90] Proposition 13, and also see [\cite=Ai97] Proposition 4).

If G is a plane graph, then for each [formula], P(G;k) is equal to the number of admissible k-valuations of Gm.

This evaluation of the Penrose polynomial does not extend to general embedded graphs. For example, the embedded graph in the torus given by has Penrose polynomial -  λ3 + 4λ2 - 3λ, but its medial graph has k3 - 2k2 + k admissible k-valuations. However, we are able to give a more general formulation, motivated by an identity for the circuit partition polynomial at negative integers in [\cite=E-M04], one that does hold for all embedded graphs, and that reduces to Theorem [\ref=th.addval] for plane graphs.

If G is an embedded graph, then [formula], where the sum is over all admissible n-valuations s of Gm and where cr(s) is the number of crossing states in s.

We induct on the edges of G. The result clearly holds if G has no edges, so let e be an edge of G. We will use the following observations from [\cite=E-MMe]. Let G be an embedded graph with embedded medial graph Gm, and e be an edge of G. Then

(Gm)bl(ve)  =  (G - e)m;

(Gm)wh(ve) = (G / e)m;

(Gm)cr(ve) and (Gτ(e) / e)m are twists of each other.

We note that the admissible colourings of a graph are unaffected by twists, since the cyclic order of edges about each vertex is preserved. Thus, the admissible colourings of (Gm)cr(ve) and (Gτ(e) / e)m are the same.

By Theorem [\ref=t.delcon],

[formula]

By induction, the right-hand side is

[formula]

where the first sum is over all admissible n-valuations s of (G / e)m and the second sum is over all admissible n-valuations s of (Gτ(e) / e)m.

As noted above, this becomes

[formula]

where the first sum is over all admissible n-valuations s of (Gm)wh(ve) and the second sum is over all admissible n-valuations s of (Gm)cr(ve).

In an admissible n-valuation of (Gm)wh(ve), the two arcs forming the white transition can either be assigned different colours, or both be assigned the same colour, and similarly in the crossing case. We can separate the sums accordingly:

[formula]

The first sum corresponds to a sum over all admissible n valuations of Gm with a split state at ve. The second and fourth sums both correspond to all permissible n valuations of Gm with exactly one total vertex at ve, and hence cancel. The third sum corresponds to a sum over all admissible n valuations of Gm with a crossing state at ve, but with one more crossing to be counted, thus changing the subtraction to addition.

This yields that [formula], as desired.

Theorem [\ref=th.addval] follows as an immediate corollary, using the Jordan curve theorem. If G is plane, then in any admissible colouring, Gm|Ei, the subgraph induced by the edges of colour i, is a disjoint union of simple closed curves in the plane. By the Jordan curve theorem, the intersection of Gm|Ei and Gm|Ej for any i  ≠  j must be an even number of points. Thus, [formula] mod 2 for every admissible colouring s of Gm.

Colourings and the Penrose polynomial

We now use the ribbon group action to develop connections between the Penrose polynomial and proper graph colourings. In particular, we will show how the Penrose polynomial of a plane graph can be written as a sum of the chromatic polynomials of its twisted duals. This results completes a theorem of Aigner where the Penrose polynomial was shown to give an upper bound on the number of proper graph colourings. This extension of Aigner's result can not be realized by the original Penrose polynomial which is restricted to plane graphs.

Let G be a plane graph, then for all [formula] we have

[formula]

In Theorem [\ref=t.pac], we will complete Theorem [\ref=t.aigner] by showing that the Penrose polynomial of a plane graph G is in fact equal to a sum of specific chromatic polynomials, that is, [formula]. Thus, the expression χ(G*;k) is just one summand in the full expression for the Penrose polynomial P(G;k) given in Theorem [\ref=t.pac]. Theorem [\ref=t.aigner] then follows from Theorem [\ref=t.pac] as a corollary.

If G = (V(G),E(G)) is a plane graph, then

[formula]

If G is a plane graph, then, by Theorem [\ref=th.addval], P(G;k) is equal to the number of admissible k-valuations for all [formula]:

[formula]

We construct a bijection from the set of admissible k-valuations of the medial graph Gm to a certain set of colourings of the boundaries of the partial Petrials of G. To do this we view G as a ribbon graph. Given an admissible k-valuation, φ, of Gm, let {ve  |  e∈Aφ} be the set of vertices of Gm at which a crossing state is assigned in the k-valuation. Note that the indexing set, Aφ, is a set of edges of G. Observe that the cycles in Gm (which are determined by the colours in the k-valuation φ) follow exactly the boundary components of the partial Petrial Gτ(Aφ). Moreover, the colours of the cycles in the k-valuation induce a colouring of the boundary components of Gτ(Aφ). We define a proper boundary k-colouring of a ribbon graph to be a map from its set of boundary components to the colours [formula] with the property that whenever two boundary components share a common edge, they are assigned different colours. It is then clear that the map from φ to Gτ(Aφ) defines a bijection between the set of admissible k-valuations of Gm and the set of proper boundary k-colourings of the partial Petrials of G:

[formula]

Finally, we observe that a proper boundary k-colouring of Gτ(A) corresponds to a proper face k-colouring of Gτ(A) when Gτ(A) is viewed as cellularly embedded, and hence to a proper k-colouring of (Gτ(A))*. Thus, the number of boundary k-valuations of a ribbon graph Gτ(A) is equal to χ((Gτ(A))*;k), for [formula]:

[formula]

The result then follows from Equations [\eqref=pc1], [\eqref=pc2],and [\eqref=pc3].

We observe that Theorem [\ref=t.pac] does not hold for arbitrary non-plane graphs (for example, consider the graph embedded on the Klein bottle that consists of one vertex and two edges e and f with the cyclic order efef at the vertex). Nor does Theorem [\ref=t.pac] provide a characterization of plane graphs (for example, consider the graph embedded on the torus that consists of one vertex and two edges e and f with the cyclic order efef at the vertex).

We conclude by using Theorem [\ref=t.pac] to reformulate the Four Colour Theorem.

The following statements are equivalent:

the Four Colour Theorem is true;

for every connected, bridgeless plane graph G there exists A  ⊆  E(G) such that [formula];

for every connected, bridgeless plane graph G there exists A  ⊆  E(G) such that [formula].

Corollary 9 of [\cite=Ai97] states that the Four Colour Theorem is equivalent to showing that P(G;3) > 0 or P(G;4) > 0 for all connected, bridgeless plane graphs G. Since χ(H;k)  ≥  0 for all [formula] and graphs H, Theorem [\ref=t.pac] tells us that P(G;k) > 0 if and only if one of the summands [formula]. The result then follows.