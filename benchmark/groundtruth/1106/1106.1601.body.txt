=10pt =0pt

Z

Roth's theorem in many variables

Abstract

We prove, in particular, that if [formula] has no nontrivial solution to the equation x1 + x2 + x3 + x4 + x5 = 5y then |A|  ≪  Ne- c( log N)1 / 6 - ε,  c > 0. In view of the well-known Behrend construction this estimate is close to best possible.

Introduction

The celebrated theorem of Roth [\cite=Roth_AP3] asserts that every subset of [formula] that does not contain any three term arithmetic progression has size O(N /  log  log N). There are numerous refinements of Roth's result [\cite=Bu] [\cite=Bourgain_AP2007] [\cite=a_H-B] [\cite=Sz_inf]. Currently the best known upper bound O(N / ( log N)1 - o(1)) is due to Sanders [\cite=Sanders_Roth_1-eps]. The comprehensive history of the subject can be found in [\cite=Tao_Vu_book].

It turns out that the Roth's method gives a similar upper bound for the size of sets having no nontrivial solutions to a invariant linear equation

[formula]

i.e. [formula] (three term arithmetic progressions corresponds to the equation x + y = 2z). On the other hand, the well-known construction of Behrend [\cite=Behrend] [\cite=Elkin] [\cite=Koester] [\cite=Moser] [\cite=Ra] [\cite=Salem1] [\cite=Salem2] provides large sets having no solution to certain kind of invariant equations. He showed that there are subsets of [formula] of size [formula] without solution to the invariant equation

[formula]

where [formula]

The aim of this paper is to establish a new upper bound for subsets of [formula] having no solution to an invariant equation in at least 6 variables.

Theorem . Let N and [formula] be positive integers. Let [formula] be a set having no solution to the equation ([\ref=e]), where all [formula] are distinct integers. Then

[formula]

where [formula]

Observe, that Theorem [\ref=t:Roth_Schoen_Gr''_intr] together with Behrend's example give a reasonable estimates for all equations of the type ([\ref=eq:_Behrend]). Let us also formulate an immediate corollary to Theorem [\ref=t:Roth_Schoen_Gr''_intr] for the equation

[formula]

which is very close to the most intriguing case x + y = 2z.

Corollary . Suppose that [formula] has no solution to the equation ([\ref=f]) with distinct integers. Then there exists a constant c > 0 such that

Our argument heavily relies on a recent work on Polynomial Freiman-Ruzsa Conjecture, by Sanders [\cite=Sanders_2A-2A_new_optimal] (see also [\cite=sch]). A fundamental tool in our approach is a version of Bogolyubov-Ruzsa Lemma proved in [\cite=Sanders_2A-2A_new_optimal]. We also use the density increment method introduced by Roth, however in a different way. The density increment is not deduced from the existence of a large Fourier coefficient of a set A,  |A| = αN, having no solution to an equation ([\ref=e]) (which is always the case). We will be rather interested in finding a translation of a large Bohr set in a1  ·  A + a2  ·  A + a3  ·  A + a4  ·  A, from which one can easily deduce a large density increment of A by a constant factor on some large Bohr set. By Sanders' theorem dimension of the Bohr set increases by O( log 4(1 / α)) in each iteration step, which makes the argument very effective.

The paper is organized as follows. We start with proving analogues of Theorem [\ref=t:Roth_Schoen_Gr''_intr] and Corollary [\ref=c:roth5x] for finite fields in section [\ref=sec:F_p^n]. The argument is especially simple and transparent in this case. Theorem [\ref=t:Roth_Schoen_Gr''_intr] is proved in next three sections. In section [\ref=sec:Bohr_sets] we recall some basic properties of Bohr sets in abelian groups. In section [\ref=sec:Sanders_Bohr] we prove a local version of Sanders result. The next section contains the proof of Theorem [\ref=t:Roth_Schoen_Gr''_intr]. We conclude the paper with a discussion concerning consequences of Polynomial Freiman-Ruzsa Conjecture for sets having no solutions to an invariant linear equation with distinct integers.

Notation

Let [formula] be a finite Abelian group with additive group operation +  , and let [formula]. By [formula] we denote the Pontryagin dual of [formula], i.e. the space of homomorphisms γ from [formula] to S1. It is well known that [formula] is an additive group which is isomorphic to [formula]. The Fourier coefficients of [formula] are defined by

[formula]

By the convolution of two function [formula] we mean

[formula]

It is easy to see that γ) = γ)γ). If X is a nonempty set, then by μX we denote the uniform probability measure on X and let

[formula]

Let [formula], and [formula]. If A is a set, then we write A(x) for its characteristic function i.e. A(x)  =  1 if x∈A and A(x) = 0 otherwise. All logarithms are to base 2. The signs ≪   and ≫   are usual Vinogradov's symbols.

Finite fields model

In this section we present proofs of Corollary [\ref=c:roth5x] and Theorem [\ref=t:Roth_Schoen_Gr''_intr] in finite fields setting. Here we assume that [formula] The case of [formula] in view of its linear space structure over [formula], is considerable simpler than the case of [formula] Even the simplest version of Roth's argument yields an estimate Op(pn / nk - 2) for size of sets free of solution to ([\ref=e]) (see [\cite=Meshulam] [\cite=LS09], [\cite=Sanders_Z_4^n],[\cite=Sanders_log]).

Our main tool is the following finite fields version of Sanders' theorem [\cite=Sanders_2A-2A_new_optimal].

Lemma . Suppose that [formula] are finite non-empty sets such that |A + S|  ≤  K min {|A|,|S|}. Then A - A + S - S contains a subspace V of codimension at most Op( log 4K).

The proof of the next theorem illustrates the main idea of our approach.

Theorem . Suppose that [formula] and A has no nontrivial solution to ([\ref=f]) with [formula] for some i. Then

[formula]

for some positive constant cp.

Suppose that [formula] has density α and contains no solution to (). We split A into two disjoint sets A1,A2 of equal size. Clearly, there exists [formula] such that

[formula]

Let us put [formula].

By Lemma [\ref=l:Sanders_F_p^n], there exists a subspace V of codimension at most Op( log 4(1 / α)) such that V  ⊆  2B - 2B, so that

[formula]

Therefore, in view of [formula], we have [formula] for all x,y∈A, hence A intersects at most half of cosets of V, which implies

[formula]

for some v. Thus, [formula] is free of solutions to ([\ref=f]) and has density at least 2α on V. After t iterations we obtain a subspace of codimension at most Op(t  ·   log 4(1 / α)) such that

[formula]

for some vt. Since the density is always at most one we can iterate this procedure at most log (1 / α) + 1 times. Hence

[formula]

so that

[formula]

for some positive constant [formula]

To prove the main result of the section we will need the following consequence of Lemma [\ref=l:Sanders_F_p^n]. We sketch its proof here; the interested reader will find all details in Section [\ref=sec:Sanders_Bohr].

Lemma . Let [formula] be sets of density at least α. Then [formula] contains a subspace V of codimension at most Op(k- 3 log 4(1 / α)).

We have

[formula]

so that there exists 2  ≤  i  ≤  k such that

[formula]

Thus, setting [formula], we have [formula], [formula] Then applying Lemma [\ref=l:Sanders_F_p^n] and Theorem [\ref=t:Sanders_2A-2A_reformulation] (see Section [\ref=sec:Sanders_Bohr]) we infer that there is a subspace V of codimension Op( log 3(α- 1 / (k - 1))  ·   log (1 / α)) = Op(k- 3 log 4(1 / α)) such that

[formula]

and the assertion follows. [formula]

Theorem . Suppose that [formula] has no solution with distinct elements to an invariant equation

[formula]

where [formula] and [formula] Then

[formula]

for a positive constant cp.

Suppose [formula] has no solution with distinct elements to ([\ref=equation:F_p^n]) and |A| = αpn. Let [formula] be arbitrary disjoint subsets of A of size [formula] and put [formula] Clearly, there are [formula] such that

[formula]

and let [formula] be the sets on the left hand side in the above inequalities, respectively. By Lemma [\ref=l:trick_small_sumsets], applied for [formula] and K = O((k / α)2) there is a subspace V of codimension d = Op(k- 3 log 4(k / α)) such that

[formula]

so that

[formula]

for some v. Since A does not contain any solution to ([\ref=equation:F_p^n]) with distinct elements it follows that

[formula]

for all [formula] Hence, if for some w the coset w + V contains at least 2 elements of A', then - a- 1k(ak - 1w - v) + V is disjoint from A'. The number of cosets of V sharing exactly 1 element with A is trivially at most pd. Thus, there exists w' such that [formula] which is at least (3 / 2)α|V|, provided that

[formula]

After t iterates of this argument we obtain a subspace Vt of codimension Op(tk- 3 log 4(k / α)) such that

[formula]

Since [formula] it follows that [formula]. Thus, ([\ref=d]) must be violated after at most 2 log (1 / α) steps, in particular pn - 2 log (1 / α)d  ≪  α- 1, so that

[formula]

Hence [formula]

Basic properties of Bohr sets

Bohr sets were introduced to additive number theory by Ruzsa [\cite=Ruzsa_freiman]. Bourgain [\cite=Bu] was the first, who used Fourier analysis on Bohr sets to improve estimate in Roth's theorem. Sanders [\cite=Sanders_2A-2A_new_optimal] further developed the theory of Bohr sets proving many important theorems, see for example Lemma [\ref=l:Chang+large_Bohr_exp_sums] below.

Let Γ be a subset of [formula], |Γ|  =  d, and [formula].

Definition . Define the Bohr set B  =  B(Γ,ε) setting

[formula]

where [formula]

The number d  is called dimension of B and is denoted by  dim B. If M  =  B  +  n, [formula] is a translation of a Bohr set B, we put  dim M  =   dim B. The intersection [formula] of two Bohr sets B  =  B(Γ,ε) and B'  =  B(Γ',ε') is the Bohr set with the generating set [formula] and new vector  min (εj,ε'j). We write [formula] for two Bohr sets B  =  B(Γ,ε), B'  =  B(Γ',ε') if Γ  ⊆  Γ' and [formula], j∈[dim B]. Thus B'  ≤  B implies that B'  ⊆  B and always [formula]. Furthermore, if B = B(Γ,ε) and ρ > 0 then by Bρ we mean B(Γ,ρε).

Definition . A Bohr set B  =  B(Γ,ε) is called regular, if for every [formula] we have

[formula]

We formulate a sequence of basic properties of Bohr (see [\cite=Bu]), which will be used later.

Lemma . Let B(Γ,ε) be a Bohr set. Then there exists ε1 such that [formula] and B(Γ,ε1) is regular.

Lemma . Let B(Γ,ε) be a Bohr set. Then

[formula]

Lemma . Let B(Γ,ε) be a Bohr set. Then

[formula]

Lemma . Suppose that [formula] is a sequence of Bohr sets. Then

[formula]

The next lemma is due to Bourgain [\cite=Bu]. It shows the fundamental property of regular Bohr sets. We recall his argument for the sake of completeness.

Lemma . Let B  =  B(Γ,ε) be a regular Bohr set. Then for every Bohr set B'  =  B(Γ,ε') such that [formula] we have: 1) ~  the number of n's such that (B  *  B')(n)  >  0 does not exceed |B|(1 + κ), 2) ~  the number of n's such that (B  *  B')(n)  =  |B'| is greater than |B|(1 - κ) and

[formula]

If (B  *  B')(n)  >  0, then there exists m such that for any γj∈Γ, we have so that for all γj∈Γ. Therefore [formula] and by Lemma [\ref=l:Reg_B], we have [formula].

On the other hand, if then (B  *  B')(n)  =  |B'|. Using Lemma [\ref=l:Reg_B], we obtain |B-|  ≥  (1 - κ)|B|.

To prove ([\ref=2k]) observe that

[formula]

as required. [formula]

Corollary . With the assumptions of Lemma [\ref=l:L_pm] we have [formula].

Notice that for every [formula] and a Bohr set B(Γ,ε) we have γ  ·  B(Γ,ε)  =  B(γ- 1  ·  Γ,ε). Thus, if B(Γ,ε) is a regular, then γ  ·  B(Γ,ε) is regular as well.

A variant of Sanders' theorem

Very recently Sanders [\cite=Sanders_2A-2A_new_optimal] proved the following remarkable result.

Theorem . Suppose that [formula] is an abelian group and [formula] are finite non-empty sets such that [formula]. Then (A - A) + (S - S) contains a proper symmetric d(K)-dimensional coset progression M of size exp ( - h(K))|A + S|. Moreover, we may take d(K)  =  O( log 6K), and h(K)  =  O( log 6K log  log K).

The aim of this section is to show the following modification of Sanders' theorem which is crucial for our argument.

Theorem . Let ε,δ∈(0,1] be real numbers. Let A,A' be subsets of a regular Bohr sets B and let S,S' be subsets of a regular Bohr sets [formula], where [formula] and d =  dim B. Suppose that [formula]. Then the set (A - A') + (S - S') contains a translation of a regular Bohr set z +  such that  dim d  +  O( log 4(1 / α)) and

[formula]

Observe that the statement above with O(d4  +   log 4(1 / α)) instead of d  +  O( log 4(1 / α)) is a direct consequence of Theorem [\ref=t:Sanders_2A-2A_new_optimal] (see the beginning of the proof of Theorem [\ref=t:Sanders_2A-2A_reformulation]).

Next we will formulate two results, which will be used in the course of the proof of Theorem [\ref=t:Sanders_2A-2A_reformulation]. The first lemma, proved by Sanders [\cite=Sanders_2A-2A_new_optimal], is a version of Croot-Sisask theorem [\cite=Croot_Sisask_convolutions].

Lemma . Suppose that [formula] is a group, [formula] are finite non-empty sets such that [formula] and [formula]. Let ε∈(0,1] and let h be a positive integer. Then there is t∈T and a set X  ⊆  T - t, with

[formula]

such that

[formula]

The next lemma is a special case of Lemma 5.3 from [\cite=Sanders_2A-2A_new_optimal]. This is a local version of Chang's spectral lemma [\cite=Chang], which is another important result recently proved in additive combinatorics.

Lemma . Let ε,ν,ρ be positive real number. Suppose that B is a regular Bohr set and let X  ⊆  B. Then there is a set Λ of size O(ε- 2 log (2μ- 1 / 2B(X))) such that for any γ∈Spec  ε(μX) we have

[formula]

where B'  =  B(Λ,1 / 2).

Proof of Theorem [\ref=t:Sanders_2A-2A_reformulation] Applying Lemma [\ref=pr:Periodic_convolution_3_sets] with A,  S and T = Bδ,  δ  =  ε  /  100d and K = L = O(1 / α), we find a set [formula] such that

[formula]

and

[formula]

We may assume that [formula] is regular.

Let ε be a small positive constant to be specify later. Put h  =  ⌈ log (K / ε)⌉ and l = O(ε- 4h2 log 2K). Applying Lemma [\ref=l:Chang+large_Bohr_exp_sums] for [formula] with parameters ν  =  O(ε  /  (lK1 / 2)), ρ  =  O(ε  /  (ld2K1 / 2)), we obtain

[formula]

We have [formula].

By the same argument, applied for sets A',S' there are sets X', Λ' of cardinality l and a Bohr set B*ν that satisfy inequalities ([\ref=tmp:18.02.2011_1]) and ([\ref=tmp:18.02.2011_2]), respectively. Finally, we set

[formula]

Clearly, d'' =  dim B'' = d + O( log 4(1 / α)) and by Lemma [\ref=l:Bohr_est], Lemma [\ref=l:entropy_Bohr], Lemma [\ref=l:Bohr_intersection_Sanders] and ε  =  Ω(1) we have

[formula]

In view of the inequality

[formula]

which follows from Cauchy-Schwarz inequality and Parseval's formula, we may proceed in the same way as in the proof of Lemma 9.2 in [\cite=Sanders_2A-2A_new_optimal] and conclude that for any probability measure μ supported on B'' we have

[formula]

Let η  =  1 / 4d''. We show that (A - A') + (S - S') contains a translation of B''η.

Indeed, note that

[formula]

so that by pigeonhole principle, there is some i  ≤  2d'' such that [formula]. We apply ([\ref=tmp:18.02.2011_3]) for

[formula]

Thus, there is x such that

[formula]

Taking ε sufficiently small (see [\cite=Sanders_2A-2A_new_optimal] for details), we get

[formula]

Analogously, for some y, we obtain

[formula]

Hence for each b∈, we have

[formula]

Therefore, (A - A') + (S - S') contains a translation of [formula]. Finally, by Lemma [\ref=l:Reg_B], there is [formula] such that σ is regular. By ([\ref=in:bohr_size]) and Lemma [\ref=l:entropy_Bohr] σ also satisfies ([\ref=f:t(B)_size]). This completes the proof. [formula]

Proof of the main result

Let [formula] be a set having no solution to ([\ref=e]). As usually, we embed A in [formula] with p between [formula] and [formula], so A has no solution to ([\ref=e]) in [formula]. All sets considered below are subsets of [formula] We start with the following simple observation.

Lemma . Let B be a regular Bohr set of dimension d, B'  ≤  Bρ be a Bohr set and [formula]. Suppose that [formula]. Then there exists x∈B such that

[formula]

or

[formula]

Proof. By regularity of B we have

[formula]

and

[formula]

Hence

[formula]

and the result follows. [formula]

Theorem [\ref=t:Roth_Schoen_Gr''_intr] is a consequence of the next lemma.

Lemma . Suppose that B is a regular Bohr set of dimension d and A  ⊆  B,   μB(A)  =  α has no solution with distinct elements to ([\ref=e]). Assume that

[formula]

Then there exists a regular Bohr set B', such that

[formula]

dim B'  =  d  +  O( log 4(1 / α)), and

[formula]

We start with mimicking the argument used by Sanders in [\cite=Sanders_Roth_1-eps]. Suppose that ε = cα / (100Mdk2), where c > 0 is a small constant and [formula], is such that Bε is a regular Bohr set and put [formula]. By Lemma [\ref=l:L_pm], we have

[formula]

Thus, for η = 1 / (16k),   either we have [formula] for some [formula] or there is w∈B such that [formula] for every i, where [formula]. In the first case we are done, so assume that the last inequalities hold. Since ([\ref=e]) is an invariant equation we may translate our set and assume that [formula] for all [formula].

Let [formula] and [formula] are regular Bohr sets. By regularity of B' and Lemma [\ref=l:A_and_-A] either ([\ref=f:l_A_and_-A_inc]) holds, and we are done, or there exists x∈B' with [formula] and [formula] We show that there are disjoint sets A1,A2 of A such that [formula] and [formula]. Indeed, let Q1  =  {q∈A ~ : ~ a1  ·  q∈B'' + x}, Q2  =  {q∈A ~ : ~ a2  ·  q∈B'' - x}. Note that |Q1|,|Q2|  ≥  α|B''| / 8. If [formula] then split [formula] into two parts A1, A2 whose sizes differ by at most one. Otherwise, we put [formula] and [formula].

Put [formula] then [formula] for i  ≥  3. Again applying Lemma [\ref=l:A_and_-A] for B''' and the arguments above, we find y∈B' and disjoint sets A3,A4  ⊆  A' such that [formula] and [formula]

Assume that k is even. Let l  =  (k - 6) / 2  ≥  0. Using the arguments as before, we infer that then there are disjoint sets [formula] and elements [formula] such that

[formula]

and

[formula]

Finally, by Theorem [\ref=t:Sanders_2A-2A_reformulation] applied to sets

[formula]

there exists a Bohr set B' and z such that

[formula]

dim d  +  O( log 4(1 / α)) and

[formula]

The sum over j in ([\ref=tmp:02.05.2011_1]) can be empty. In the case we put the sum to be equal to zero. Notice that z∈4B''  +  (k - 6)B'''  ⊆  kB''. Since [formula] are disjoint it follows that

[formula]

for all distinct [formula]

By Lemma [\ref=l:Reg_B] we find [formula] such that [formula] is regular. Obviously δ satisfies ([\ref=tmp:22.02.2011_1']). Write

[formula]

Observe that if - z∈Ek - 1 + Ek, then one can find a solution to ([\ref=e]) with distinct [formula] Therefore [formula] so that

[formula]

Finally

[formula]

so that [formula] for some i. Thus

[formula]

By ([\ref=l:large_bohr])

[formula]

and since Lemma [\ref=l:entropy_Bohr] implies [formula] so that

[formula]

Hence

[formula]

where B* = a- 1i  ·  δ, and the assertion follows.

Now suppose that k is odd. Only the first part of the proof needs to be slightly modified. Certainly, we may assume that a5  =  1. By regularity of B we have

[formula]

where Bi and B'' are defined as before. Put l = (k - 7) / 2  ≥  0. By Lemma [\ref=l:A_and_-A] there are disjoint sets [formula] and elements [formula] such that ([\ref=tmp:02.05.2011_1])-([\ref=tmp:13_02_2011_1']) hold. However, A5  ⊆  B'', so that z∈kB''. One can finish the proof in exactly the same way as before. [formula]

Proof of Theorem [\ref=t:Roth_Schoen_Gr''_intr] Let [formula] We apply iteratively Lemma [\ref=l:Roth_Schoen_Gr']. After t steps we obtain a regular Bohr set Bt and [formula] such that [formula] and

[formula]

Since the density is always less than 1 we may apply Lemma [\ref=l:Roth_Schoen_Gr'] at most O( log (1 / α)) times. Therefore, after t = O( log (1 / α)) iterates assumption of Lemma [\ref=l:Roth_Schoen_Gr'] are violated, so that

[formula]

which yields

[formula]

and the assertion follows. [formula]

Polynomial Freiman-Ruzsa Conjecture and linear equation

Freiman-Ruzsa Polynomial Conjecture can be formulated in the following way.

Conjecture . Let [formula] then there exists a Bohr set B(Γ,ε)  ⊆  2A - 2A such that |Γ| = d  ≪   log (1 / α) and ε  ≫  1 /  log (1 / α).

We have

[formula]

so that it would give a nontrivial result provided that α  ≫  N- c /  log  log N. However, it was proved in [\cite=Shkredov1] and [\cite=Shkredov2] that in Chang's lemma (see section [\ref=sec:Sanders_Bohr]) one can take much larger ε. This give a (little) support for the following version of the above conjecture for sparse sets.

Conjecture .

We shall give here an application of Conjecture [\ref=con2]. First we recall some definitions from [\cite=Ruzsa_equations]. Let

[formula]

be an invariant linear equation. We say that the solution [formula] of ([\ref=equation]) is trivial if there is a partition [formula] into nonempty and disjoint sets Tj such that xu = xv if and only if u,v∈Tj for some j and

[formula]

for every [formula] The genus of ([\ref=equation]) is the largest [formula] such that there is a partition [formula] into nonempty and disjoint sets Tj such that

[formula]

for every [formula] Let r(N) be the maximum size of a set [formula] having no nontrivial solution to ([\ref=equation]) with xi∈A and let R(N) be the analogous maximum over sets that the equation ([\ref=equation]) has no solution with distinct xi∈A. It is not hard to prove that r(N)  ≪  N1 / . Much less is known about the behavior of R(N). Bukh [\cite=Bukh] showed that we always have R(N)  ≪  N1 / 2 - ε for the symmetric equations

[formula]

Our result is the following.

Theorem . Assuming Conjecture [\ref=con2] we have

[formula]

for every invariant equation ([\ref=equation]) with a1 =  - a2, ~ a3 =  - a4, where [formula]

Suppose that A has no solution to an equation ([\ref=equation]) with a1 =  - a2, ~ a3 =  - a4, where [formula] and assume that |A|  ≫  N1 - c,  c > 0. We embed A in [formula] with M = SN, where [formula] so that any solution to ([\ref=equation]) in [formula] is a genuine solution in [formula] Let [formula] be a partition of A into roughly equal parts. If Conjecture [\ref=con2] holds, then there is a Bohr set

[formula]

of dimension at most δc log N and size at least ≫  N1 - c'. Put B' = B1 / S. We show that for every [formula] we have

[formula]

Indeed, if there are distinct [formula], then

[formula]

However, each element in B has at least |A|4 / M representations in the form a1x - a1y + a3z - a3w,  x,y,z,w∈A1. This would give a solution to ([\ref=equation]) with distinct integers. Hence,

[formula]

so

[formula]

Now, by Lemma [\ref=l:entropy_Bohr] it follows that |B'|  ≫  S- 4d|B|  ≫  N1 - c' - 2δc log S. This leads to a contradiction, provided c is small enough. [formula]

Acknowledgement We wish to thank Tom Sanders for stimulating discussions.

schoen@amu.edu.pl

ilya.shkredov@gmail.com