true in true in in

Corollary Conjecture Lemma Proposition Definition

Half-integral weight Eichler integrals and quantum modular forms

Introduction and statement of results

It is well-known that the derivative of a modular form is typically not a modular form. However, thanks to an identity of Bol [\cite=Bol], there exists a canonical differential operator Dk - 1:M!2 - k  →  M!k for [formula], where [formula] and [formula] denotes the space of weight [formula] weakly holomorphic modular forms. Motivated by this, Eichler [\cite=Eichler] considered the formal (k - 1)-st antiderivative of a cusp form. Specifically, if [formula] (throughout q: = e2πiτ with [formula]) is a cusp form on [formula], then we define the holomorphic Eichler integral by [formula] Denoting by [formula] the Petersson slash operator in weight [formula] (defined in Section 2.1), we easily see from the remarks above that [formula] (where [formula]. Hence, [formula] is a polynomial of degree at most k - 2, called the period polynomial of f. Eichler integrals play a fundamental role in the study of integral weight modular forms. For example, as further elaborated on by Shimura [\cite=Shimura] and Manin [\cite=Manin], the theory of Eichler integrals provides deep insights into the theory of elliptic curves and critical values of L-functions. For an interesting discussion of the general cohomology theory, see also [\cite=Bruggeman].

Since half-integral weight modular forms (see Section 2.1 for the definition) also encode deep arithmetic information, it is natural to ask what the analogous Eichler-Shimura theory is for half-integral weight. Here, the situation is more complicated. In particular, the operator Dk - 1 no longer makes sense. In fact, it is a central problem in the theory of harmonic Maass forms to construct a suitable operator which plays a similar role as Dk - 1 in half-integral weight (see, for example, [\cite=FractionalDeriv]). The first pioneering examples of half-integral weight Eichler integrals were considered in connection with WRT invariants of 3-manifolds by Lawrence and Zagier [\cite=Lawrence-Zagier]. Although the proof is more difficult for general weight modular forms, they formally considered the same Eichler integral as defined above for certain weight 3 / 2 theta functions ϑ. Even though it is impossible for [formula] (where γ is any element of the congruence subgroup of ϑ) to be a polynomial of degree k - 2 as in the integral weight case, they give a nice characterization of its modular properties as one approaches cusps. In fact, [formula] can be extended to [formula], and the resulting function [formula] becomes real-analytic on [formula]. This provides one of the first examples of the burgeoning new theory of quantum modular forms, laid out by Zagier [\cite=ZagierQMF], which we review in Section 2.2. Essentially, a quantum modular form of weight k is a complex-valued function f on [formula] whose modular obstructions, or cocycles, f|k(1 - γ) are "nicer" than the original function in some analytic way. For example, f is usually only well-defined on [formula], whereas f|k(1 - γ) typically extends to an open set of [formula] and is differentiable, smooth, etc.

Since [\cite=Lawrence-Zagier], there has been an explosion of research aimed at constructing examples of quantum modular forms related to non-holomorphic Eichler integrals, see for example [\cite=Kimport] [\cite=Bringmann-Creutzig-Rolen] [\cite=Bringmann-Folsom-Rhoades] [\cite=Folsom-Ono-Rhoades] [\cite=ZagierVass]. For instance, quantum modular forms are closely tied to surprising identities relating the combinatorial generating functions counting ranks, cranks, and unimodal sequences [\cite=Folsom-Ono-Rhoades], and to the general theory of negative index Jacobi forms and Kac-Wakimoto characters [\cite=Bringmann-Creutzig-Rolen]. In this paper, we elucidate the general picture in arbitrary half-integral weight. Although the previous proofs depended on the modular forms considered being theta functions, we show that a similar phenomenon is true in general, along the way constructing large families of quantum modular forms. Our main result is the following, where a more detailed definition of quantum modular forms and "nice properties" is given in Section 2.2.

If f∈Sk(N) with [formula] and [formula], then [formula] is a quantum modular form of weight 2 - k. In this instance, the "nice" property of the cocycle is that for every γ∈Γ0(N), [formula] is real-analytic except at γ- 1  ∞  .

Two remarks.

1) In fact, the proof of Proposition 2.1 shows that [formula] satisfies a much stricter condition of quantum modularity and, in the language of Zagier, is a strong quantum modular form (cf. Section 2.2).

2) The quantum modular forms in Theorem [\ref=mainthm] were recently described in a different guise using the theory of mock theta functions (see Theorem 1.5 and Lemma 3.1 of [\cite=RhoadesChoiLim]). However, we give a different proof of their quantum modularity, as the techniques here are of general interest.

Although the definition of quantum modular forms by Zagier is (intentionally) vague, the evolution of the literature indicates that it is now worthwhile to split up the types of quantum modular forms which naturally arise into various categories. Theorem 1.1 shows that it makes sense to consider the vector space of Eichler integrals of cusp forms in Sk(N) as an interesting space of quantum modular forms, and we propose this new area of study in a series of questions at the end of the paper. In addition to the results of Theorem [\ref=mainthm], we give explicit formulas for the resulting quantum modular forms. Recall that for a half-integral weight cusp form [formula], its L-function is defined for [formula] by [formula] More generally, consider the twisted L-function defined for [formula] and [formula] (throughout we assume that fractions are expressed in lowest terms) by [formula] where [formula] with e(x): = e2πix, and define the function [formula] by

[formula]

We show that Qf is a quantum modular form.

Assume the notation of Theorem [\ref=mainthm]. Then Qf is a quantum modular form on Γ0(N), with Qf|2 - k(1 - γ) real-analytic except at γ- 1  ∞   for all γ∈Γ0(N).

We will see in Section 2.4 that Lf(ζdc;s) has an analytic continuation to [formula], so that Qf is well-defined.

The paper is organized as follows. In Section 2, we review the definitions of half-integral weight modular forms and quantum modular forms, recall an auxiliary non-holomorphic Eichler integral considered in [\cite=Lawrence-Zagier], and reduce the statement of Theorem [\ref=mainthm] to a certain claim about asymptotic expansions. We conclude Section 2 by giving several useful facts about L-functions needed for the proof of Theorem [\ref=mainthm]. In Section 3, we complete the proof of Theorem [\ref=mainthm] and Corollary 1.2. We conclude in Section 4 with a list of further questions raised by this paper.

Acknowledgements

The authors are grateful to Robert C. Rhoades for enlightening comments and discussion, as well as the referee for useful suggestions which improved the paper.

Preliminaries

Half-integral weight modular forms

Here we review some standard definitions and facts concerning modular forms. Firstly, for [formula], recall that the Petersson slash operator is defined for functions [formula] and [formula] (with γ∈Γ0(4) if [formula]) by

[formula]

where [formula] denotes the Jacobi symbol and for odd d,

[formula]

We require the following congruence subgroups of [formula]: We then make the following definition.

Let [formula], [formula], and χ be a Dirichlet character modulo N. Then a holomorphic function [formula] is a cusp form of weight k on Γ0(N) with Nebentypus χ if the following conditions hold:

For all [formula], we have f|kγ  =  χ(d)f.

As τ approaches any cusp of Γ0(N), f decays exponentially fast.

We denote the space of cusp forms of weight k on Γ0(N) and Nebentypus χ by Sk(N,χ). If χ is trivial, then we also use the notation Sk(N). One may analogously define a space of cusp forms Sk(Γ1(N)). We have the following well-known decomposition

[formula]

where χ runs over all even Dirichlet characters modulo N. Thus, in the study of modular forms on Γ1(N), it is often sufficient to consider modular forms on Γ0(N) with Nebentypus.

Quantum modular forms

In this subsection, we recall some definitions and examples of quantum modular forms. Following Zagier, we make the following definition.

A function [formula] is a quantum modular form of weight k on a congruence subgroup Γ if, for all γ∈Γ, the cocycle rγ: = f|k(1 - γ) extends to an open subset of  [formula] and is analytically "nice". Here "nice" could mean continuous, smooth, real-analytic, etc. We say that f is a strong quantum modular form if, in addition, f has formal power series attached to each rational number which also have near-modularity properties (see [\cite=ZagierQMF] for more details).

All of the quantum modular forms occurring in this paper have cocycles defined on [formula] which are real-analytic except at one point.

One of the most striking examples of a quantum modular form is given by Kontsevich's "strange function" F(q), as studied by Zagier in [\cite=ZagierVass], which is given by

[formula]

where [formula] denotes the usual q-Pochhammer symbol. This function is strange as it does not converge on any open subset of [formula], but converges as a finite sum for q any root of unity. Zagier's study of F depends on the "sum of tails" identity

[formula]

where η(τ): = q1 / 24(q;q)∞ and [formula] The key observation of Zagier is that in ([\ref=sumoftails]), the functions η(τ) and η(τ)D(τ) vanish of infinite order as [formula], so at a root of unity ξ, F(ξ) is essentially the limiting value of the Eichler integral of η, which he showed has quantum modular properties [\cite=ZagierVass].

Non-holomorphic Eichler integrals

We now suppose that f∈Sk(N) for [formula] and [formula]. The main idea in studying the modularity properties of half-integral weight Eichler integrals, due to Lawrence and Zagier, is to introduce the non-holomorphic Eichler integral

[formula]

defined for [formula] The point is that [formula] has a q-series expansion (e.g., if f is a theta function, then [formula] is a partial theta function), while f* satisfies a nice transformation law. These transformation properties of f* transfer over to [formula] near the real axis. For concreteness, we make the following definition.

Let f(τ) and g(τ) be defined for [formula] and [formula], respectively. We say that the asymptotic expansions of f and g agree at a rational number [formula] if there exist β(n) such that as [formula],

[formula]

We now look at the transformation properties of f*. We easily compute for [formula] and [formula] that

[formula]

where χ- 4 is the Dirichlet character defined by [formula]. This is the key transformation property giving rise to quantum modularity in Theorem [\ref=mainthm]. The connection between [formula] and f* is given by the following proposition, whose proof we defer to Section 3 (similar results were explored in less generality in e.g. [\cite=Hikami] [\cite=Lawrence-Zagier] [\cite=ZagierVass]).

Assuming the notation of Theorem [\ref=mainthm], the asymptotic expansions of [formula] and f* agree at any [formula].

Thus, by Proposition [\ref=fooprop], [formula] inherits the same transformation properties as f* as one approaches the real line.

Properties of L-functions

In this subsection, we recall some basic properties of modular L-functions needed for the proof of Theorem [\ref=mainthm]. Firstly, we require the following lemma.

Let f∈Sk(N), where [formula], [formula], and [formula]. Then Lf(ζdc;s) has an analytic continuation to [formula] and Lf(ζdc; - m) = 0 for [formula].

We first determine the modularity properties of [formula]. Note that

[formula]

It is well-known that [formula] and hence [formula] By the decomposition ([\ref=decompgamma1]), we see that [formula] can be written as a finite sum [formula] where [formula] and χj is a Dirichlet character modulo Nc2. Clearly [formula], so it suffices to show that the lemma holds for Lg(s) where g∈Sk(M,χ) with [formula] and χ is a Dirichlet character modulo M. For such a g, the proof of the analytic continuation and vanishing condition of Lg is essentially classical, due to Hecke (see Theorem 14.7 of [\cite=Iwaniec-Kowalski] and Satz 4 of [\cite=Petersson]). However, since the multiplier is different in half-integral weight, for completeness we prove it directly.

For this, we first recall the action of the Fricke involution, given by

[formula]

It is well-known that [formula] (see Section 3 of [\cite=Bruinier]). We now consider the completed L-function

[formula]

By a simple calculation, one sees that the completed L-function factors as

[formula]

The key property of Λg(s) is its functional equation. To determine it, we begin by splitting Λg(s) into two pieces as

[formula]

and make a change of variables in the first integral to obtain

[formula]

Inserting ([\ref=WNDefn]), we find

[formula]

Since both g and g|kWN are cusp forms, and hence have rapid decay as v  →    ∞  , ([\ref=completedint]) immediately gives an analytic continuation of Λg(s) to [formula]. The analytic continuation of Lg(s) now follows immediately from ([\ref=completedsplitting]) and the fact that 1 / Γ(s) has no poles. The integral representation ([\ref=completedint]) also directly implies the functional equation, namely

[formula]

Now the claims follow, as the Gamma factor Γ(s) in ([\ref=completedsplitting]) forces Lg(s) to have zeros at non-positive integers, as Γ(s) has a pole at these locations whereas the right hand side of ([\ref=functionaleqn]) does not.

Besides the analytic continuation of our L-functions, we require a growth estimate as [formula]. For our purposes, the following basic lemma suffices. Since the proof is a standard application of the functional equation and the Phragmén-Lindelöf principle, we omit the proof.

For fixed [formula], Lf(ζdc;x + it) grows at most polynomially in t as |t|  →    ∞  .

Proof of Theorem [\ref=mainthm] and Corollary 1.2

In this section, we show Proposition [\ref=fooprop], use it to prove Theorem [\ref=mainthm], and then deduce Corollary 1.2. To prove Proposition 2.1, we compute the asymptotic expansions of [formula] and f* separately to show that they agree. This is done using the Mellin transform, defined by [formula], which provides a fundamental connection between the asymptotic expansion of one function and the poles of another. Specifically, we require the following result for computing asymptotic expansions, which is a special case of Theorem 4 (i) of [\cite=Flajolet].

Let F(x) be continuous on (0,  ∞  ) with Mellin transform M(F)(s) converging on a right half-plane [formula]. Assume that M(F)(s) can be meromorphically continued to the half-plane [formula], where β  <  α, with a finite number of poles [formula] in that half-plane, each simple with residue αj. Further assume that M(F)(s) is analytic on the line [formula] and that in the right half-plane [formula], the estimate

[formula]

holds as |s|  →    ∞   for some r > 1. Then we have the asymptotic expansion

[formula]

For later use, we also recall that for a general function f with [formula] and [formula] M(f)(s) converges in the strip [formula].

In order to apply Lemma [\ref=AsympExpExists] to the function [formula], we first compute its Mellin transform by integrating termwise

[formula]

We next show that this Mellin transform satisfies the conditions of Lemma [\ref=AsympExpExists]. Firstly, note, using the right-hand side of ([\ref=neednow]), that [formula] is convergent on some right half-plane, and by Lemma [\ref=vanishing], it has an analytic continuation to [formula] with poles only at non-positive integers (coming from the Gamma factor). To estimate the growth of the Mellin transform in vertical strips, we first recall Stirling's estimate (see 5.11.9 of [\cite=Nist]):

[formula]

By Lemma 2.3 and ([\ref=Stirling]), the Mellin transform is thus of rapid decay for fixed [formula] as [formula]. Hence, letting β  →    -    ∞   in Lemma [\ref=AsympExpExists], we directly find

[formula]

We now turn to computing the asymptotic expansion of [formula] as [formula]. We begin by expanding f*. By a change of variables, we have for n > 0 and τ = u + iv with v < 0

[formula]

where [formula] denotes the incomplete Gamma function. Thus, integrating term-by-term, we obtain

[formula]

Taking the Mellin transform of the right hand side of ([\ref=fstarexp]), we obtain

[formula]

In order to use Lemma [\ref=AsympExpExists] to compute the asymptotic expansion of f*, we first determine the location and residues of the poles of [formula] using the representation on the right-hand side of ([\ref=mellinnonholeich]).

Assuming the notation above, the following are true:

The function [formula] has a simple pole at [formula] with residue

[formula]

The function [formula] is holomorphic for [formula].

(1) We begin by rewriting the Mellin transform M(etΓ(k - 1,2t))(s) in a more convenient form. Namely, we claim that for [formula] and [formula], we have

[formula]

where, for [formula], [formula], and 0  ≤  z  ≤  1, is the incomplete beta function. To see ([\ref=bleh]), define for |z| < 1 the Gaussian hypergeometric series

[formula]

where [formula] is the Pochhammer symbol (note that 2F1 is sometimes denoted by F in [\cite=Nist]). Now use (8.14.6) of [\cite=Nist], which states that for [formula] and [formula]

[formula]

Choosing b = k - 1, a = s, and [formula], we obtain, after a change of variables,

[formula]

Here we remark that the specialization of 2F1 in ([\ref=labelfoo]) is defined by analytic continuation, as discussed in Section 15.2 of [\cite=Nist]. We then use (8.17.9) of [\cite=Nist] which states that

[formula]

Plugging in [formula], a = s, and b = 2 - k - s and using ([\ref=labelfoo]) gives ([\ref=bleh]).

To determine the poles and residues of the incomplete beta function, we make use of the beta function β(a,b): = β(1;a,b) and the regularized beta function [formula] Using the standard fact that

[formula]

along with the Euler reflection formula for Γ(s), we obtain

[formula]

Combining ([\ref=mellinnonholeich]), ([\ref=bleh]), and ([\ref=mellinrewrite]) and again using Euler's reflection formula, we find that We next specialize to s =  - n. Note that [formula]. Using Lemma 2.2 again, Lemma 3.1 (1) thus follows immediately once we have established that

[formula]

To see ([\ref=foobar]), first note the following two identities, stated in (26.5.2) and (26.5.15) of [\cite=AS], respectively:

[formula]

[formula]

For [formula], ([\ref=recurrencebetareg]) implies that

[formula]

since the factor [formula] is zero. Using ([\ref=recurrencebetareg]) again implies that

[formula]

The right-hand side of ([\ref=lastrecurr]) may now be evaluated directly. For this, we note that 2F1(1,0;2 - k; - 1) = 1, as all but the first term in ([\ref=2F1Defn]) vanish, and hence, by ([\ref=beta2f1]), [formula] Although this specialization is on the border of the region of convergence |z| < 1 of 2F1, by Abel's Lemma the value of the analytic continuation to a point on the boundary of convergence is the value at that point, assuming it exists. Now note that by ([\ref=betafactor]), β(1 - k,1) = (1 - k)- 1, and hence by the definition of I, we have that [formula]. Thus, by ([\ref=anotherrecurr]) and ([\ref=lastrecurr]), we have [formula]. But then ([\ref=foo1]) gives

proving ([\ref=foobar]).

(2) Before proving that [formula] is holomorphic for [formula], we first analyze where potential poles could arise. To do this, note that using ([\ref=mellinnonholeich]), ([\ref=labelfoo]), and the standard Pfaff transformation formula

[formula]

together gives

[formula]

Hence, using the fact that the only possible poles of 2F1(a,b;c;z) for |z| < 1 occur if [formula], together with Lemma 2.2, we see that [formula] can only possibly have poles for [formula] or for [formula] with s  ≤  1 - k.

Thus, to complete the proof of (2) we just need to prove that there are no poles for [formula] with s  ≤  1 - k. We thus fix s to be such a half-integer. Now it suffices by ([\ref=simpler]) to show that [formula], as the only potential pole arises from a simple pole in the function Γ(s + k - 1). However, by the assumption on s, we note that [formula], so that the desired vanishing condition is stated in Lemma 2.2.

We are now ready to provide the asymptotic expansion of f*, which, by comparison with ([\ref=HolEichAsympFinal]), proves Proposition 2.1. One may easily show, using ([\ref=beta2f1]), ([\ref=Pfaff]), and ([\ref=Stirling]), that [formula] is bounded in vertical strips for [formula] large enough. By this fact, together with ([\ref=mellinnonholeich]), ([\ref=bleh]), Lemma [\ref=Lfunctiongrowth], and ([\ref=Stirling]), we find that [formula] is of rapid decay in vertical strips as [formula]. Hence, we can directly plug Lemma [\ref=crap] into Lemma [\ref=AsympExpExists] to find that

[formula]

which establishes Proposition 2.1.

We now have all of the pieces needed to prove Theorem [\ref=mainthm].

By ([\ref=nonholfinalexp]), we find that [formula] has a well-defined limit as [formula], namely, [formula] By ([\ref=nonholtransform]), we see that f* is a quantum modular form, as for [formula], the cocycle [formula] is real-analytic on [formula]. By ([\ref=HolEichAsympFinal]), we see that [formula] also extends to a function on [formula] with the same values as f*, and hence is a quantum modular form. The claim that it is a strong quantum modular form follows from Proposition [\ref=fooprop].

The proof of Corollary 1.2 is now straightforward.

As in the proof of Theorem [\ref=mainthm], we see by ([\ref=HolEichAsympFinal]) that [formula] is a quantum modular form, and that its values at the rational point [formula] is Lf(ζdc;k - 1).

Questions and outlook

Theorem 1.1 and Corollary 1.2 provide a canonical family of quantum modular forms, which gives a different perspective on the quantum modular forms defined in [\cite=RhoadesChoiLim]. As discussed in Sections 1 and 2.2, this family includes many examples in the literature, such as Kontsevich's strange function ([\ref=kontstrange]) [\cite=ZagierVass], quantum modular forms arising from specializations of the crank and rank generating functions [\cite=Folsom-Ono-Rhoades], and decomposition formulas for Kac-Wakimoto characters [\cite=Bringmann-Creutzig-Rolen]. Due to the number of connections with combinatorics and number theory, we propose that studying these quantum modular forms in more detail is worthwhile. Thus, we make the following definition.

We say that a quantum modular form is an Eichler quantum modular form if its values on [formula] are equal to the radial limits from inside the unit disk of [formula] for some cusp form f.

The results presented here leave many open questions about the structure of these quantum modular forms. We conclude by giving a few natural questions that merit further investigation.

If we replace the cusp form f by a holomorphic modular form which is not cuspidal, then an inspection of the proof of Theorem [\ref=mainthm] shows that the same calculations formally hold, but the Eichler integral has a mild singularity at cusps at which f is not cuspidal. Is there a natural (and nontrivial) way to subtract a canonical holomorphic function which gives an associated quantum modular form?

If f is a unary theta function, then [formula] is a partial theta function. Can one add a non-holomorphic completion term to the partial theta function which corrects the modularity transformations on the upper half plane as well as on [formula]? More generally, for any cusp form f, are the modularity transformations proven in Theorem [\ref=mainthm] a consequence of a more general non-holomorphic completion on the upper or lower half plane?

What are the arithmetic properties of Eichler quantum modular forms? For example, inspired by the congruences proven in [\cite=Andrews], is there a general theory of congruences for the coefficients of [formula] (note the slight abuse of notation here) or for the coefficients of the asymptotic expansion of [formula] as τ approaches a given root of unity? In particular, if f is a theta function, can one show in a uniform manner whether or not there are infinitely many such congruences, or does there exist a "Sturm-type" theorem which gives a finite condition to verify congruences?

What does the Shimura correspondence tell us about the structure of half-integral weight Eichler quantum modular forms, given that the theory of integral weight Eichler integrals is much simpler?