.def .tex

Conjecture Proposition Definition Exercise Claim

Example Problem Question

Averages of character sums

Introduction

For a primitive Dirichlet character χ modulo q, the character sum

[formula]

is a periodic function with period q. The Fourier expansion of this sum,

[formula]

(exactly valid for any t which is not a discontinuity of the function), is a useful tool for its study. This sum can be shortened considerably without losing much accuracy; an example quantitative version is

[formula]

By trivially bounding the terms in this sum, for instance, we can arrive at the well-known Pólya-Vinogradov inequality

[formula]

If we think that for large enough n the values of the character sum are fairly randomly distributed, then we might believe that a much shorter truncation of this sum is still an accurate approximation to the character sum. We can construct characters for which the values of χ(p) can be controlled for all primes p  ≪   log q, but beyond this point it becomes much more difficult to understand the values of the character, and it seems natural to expect the behavior to become more and more "random", from which we might expect something like

[formula]

for some A. On the other hand, we cannot truncate the sum too early, as there are examples of characters χ and real numbers t such that

[formula]

This difficulty in truncating the sum early is an obstruction in attempts to improve on the Pólya-Vinogradov inequality, and currently it is only through the assumption of the Generalized Riemann Hypothesis that any completely general improvement on this bound is known ([\cite=MV]).

In this paper we show that if we are interested in the average value of the character sum in a small interval, instead of the value of the sum at an exact point, then a short truncation of the Fourier expansion can in fact be quite accurate. We prove the following theorem.

For a primitive character χ mod q,

[formula]

where f(x)  =    -   cos (x) if χ( - 1)  =   - 1 and f(x)  =  i sin (x) otherwise, and

[formula]

One immediate application of this is that for even characters an improvement of the Pólya-Vinogradov inequality for sums of length o(q) would yield an improvement for sums of length O(q) as well.

For a primitive character χ with χ( - 1)  =  1,

[formula]

In fact, we can get this corollary with a small enough constant so that when it is combined with lower bounds for the size of M(χ), we obtain character sums of length <  q /  log q which have size ≫  q1 / 2 log  log q. Granville and Soundararajan give stronger results of this form in [\cite=large-character-sums], but the same result does not explicitly appear for characters of larger order.

For any [formula] there exist infinitely many primitive even χ mod q of arbitrarily large order such that

[formula]

for some |N|  ≤  q / ( log q)A.

We will next examine Paley's construction [\cite=paley] of quadratic characters with M(χ)  ≫  q1 / 2 log  log q. Paley's construction suggests that the character sums he considers will get large when they have length q / 4, but his proof does not actually give this result. Using Theorem [\ref=thm-average], we will fall only slightly short of this, showing that with Paley's construction the character sum gets large at (1 / 4  +  t)q for some t  ≪  1 /  log q. Moreover, we can get such a result for any rational number.

For any b  >  0, fix any primitive [formula] of order g. There exist infinitely many [formula] with parity opposite to ψ and order [formula] such that for every a coprime to b

[formula]

for some α satisfying [formula]. Moreover, if χ is odd and b  >  1, then assuming the Generalized Riemann Hypothesis, we may take A(χ)  ≪  q1 / 2 for these χ.

When χ is even A(χ)  =  0, so Sχ(αq) is large. When χ is odd, we will be using GRH to show that L(1,χ)  ≪  1 for the characters we construct if b  =  1. Without the GRH assumption, all we can conclude is that either Sχ(αq) is particularly large or L(1,χ) is particularly large. When b  =  1, we expect that L(1,χ) will be large.

To prove this theorem we will examine what happens when χ(n)  =  ψ(n) for all small n. As such, we expect that this is a prototypical example of what happens when (in the language of Granville and Soundararajan [\cite=pretentious-characters]) a character of large conductor is pretentious to a character of small conductor and opposite parity.

This theorem includes the existence of characters of arbitrary even order for which M(χ)  ≫  q1 / 2 log  log q, a result of Goldmakher and Lamzouri [\cite=GLeven]. Our construction of these characters is the same as theirs, though our proof that the sum is large differs. Both results suffer from the defect that the maximum of these character sums may decrease as the order increases.

In fact, there exist characters of arbitrarily large (increasing) order such that M(χ)  ≥  (eγ  /  π  +  o(1))q1 / 2 log  log q (this follows from [\cite=pretentious-characters]), and we expect such characters to be odd, and hence have even order. However, current results seem to still leave open the possibility that for any ε  >  0 there exist (large) even g such that all characters of order g satisfy M(χ)  ≤  εq1 / 2 log  log q. On the other hand, any analogue of Theorem [\ref=thm-large-sums] which allowed for odd order characters would need to have the order of χ tending to infinity (as long as we accept the Generalized Riemann Hypothesis; see [\cite=pretentious-characters] and [\cite=mimicry]).

It is possible to obtain a slightly better constant in the above theorem by employing a version of Vinogradov's trick (as in [\cite=pvlqnr], for example). The theorem is probably true with the lower bound replaced by

[formula]

and α  =  a / b. In fact, if χ mimics ψ sufficiently closely and b  >  1, then it should be the case that

[formula]

The proof of the above theorem will reveal some partial information about the direction in which the large value points, but because we get the result by averaging the character sum over an interval, this information seems difficult to extract from a complex-valued sum. For quadratic characters, we can take advantage of the fact that the character sum is real and obtain some approximation of equation [\eqref=eq-conjecture]. As an example, we prove

Fix any primitive odd quadratic character ψ mod b. There exist infinitely many even quadratic characters χ mod q such that for all a relatively prime to b

[formula]

for some α satisfying [formula].

Finally, we will examine the case of prime [formula] with [formula] for many small n. In this case we expect that the value of the L-function at 1 -- and hence the constant term in the Fourier expansion -- is large. This makes the character sum Sχ(qt) large for almost all [formula], and the character sum tends to be maximized somewhat close to the central point. However, the central point is a local minimum of the character sum, and computations suggest that the maximum actually tends to occur at or near (B - 1) / 2B, where B is the smallest quadratic nonresidue modulo q.

What we manage to prove here, using the same method of proof as Theorem [\ref=thm-average] but examining this specific case more carefully, is that Sχ(qt) does get a bit larger than its value at the central point for some t within 1 / B of 1 / 2.

For any sequence of odd quadratic characters χ mod q such that the least B with χ(B)  =   - 1 tends to infinity, there exists a tχ∈[1  /  2   -   1  /  B,1  /  2] for each χ such that

[formula]

As with Theorem [\ref=thm-large-sums], the constant here is probably not the best possible. The ( log 2) / π comes from computing the average of the character sum over an interval, and at some points we know that the character sum is significantly smaller than the average value. So it is natural to expect that the character sum also gets significantly larger than its average value; perhaps the theorem would still be true if the lower bound were doubled.

If we consider the extreme case where B  >   log q, then it seems likely that Sχ(q / 2)  ≥  eγ  /  π(1  +  o(1)) log  log q, and so [formula]. However, even this small difference may have a large effect on the distribution of M(χ). (See [\cite=distribution-of-max2].)

We also note that Theorem [\ref=thm-lqnr] has the following consequence: If [formula] for all M  <  q1 - ε, then the least quadratic nonresidue for [formula] is ≪  qε.

Averages of character sums

We begin by recalling the Fourier expansion of Sχ(tq). For our purposes in this paper, it will be convenient make explicit the difference between odd and even characters, so we will work with the form

[formula]

where

[formula]

if χ is odd (χ( - 1)  =   - 1) and

[formula]

if χ is even (χ(1)  =  1). As the character sum is not a continuous function, the Fourier series does not always converge to the value of the character sum, so here we are defining

[formula]

However, if we integrate the character sum, these discontinuities are unimportant, and hence

[formula]

We'll be particularly interested in the case where we integrate to compute the average value over an interval a little bit shorter than q. We examine

[formula]

For this average, it will turn out that we can truncate the Fourier expansion at B and still obtain a good approximation. We recall Theorem [\ref=thm-average], stated in the introduction.

We wish to compute

[formula]

We can evaluate the integral of F(t,χ) directly, integrating term-by-term. For brevity we stick to the case where χ is odd (when χ is even the proof is nearly identical, swapping sines and cosines). We have

[formula]

The advantage of this process is that the sum now converges absolutely. The tail of the sum is bounded in size by

[formula]

so we truncate the sum at B to obtain

[formula]

Finally, using the approximation sin (x) / x  =  1  +  O(x2), we have

[formula]

Putting this back into Equation [\eqref=eq:average1] yields the theorem.

Large character sums at any point

The existence of characters χ such that M(χ)  ≫  q1 / 2 log  log q was first discovered by Paley ([\cite=paley]). Paley constructed such characters explicitly by using quadratic reciprocity to construct arbitrarily large [formula] such that

[formula]

for all [formula]. For [formula], the Fourier expansion for Sχ(q / 4) is

[formula]

Thus, we should probably expect Sχ(q / 4) to be of size ≫  q1 / 2 log  log q; however, the tail of this sum presents some difficulties, and Paley proved his result in a manner that does not actually give information about spot where Sχ(tq) is large. By applying Theorem [\ref=thm-average] we can average out the effects of the tail of the sum to get the result that this sum is large near t  =  1 / 4. Moreover, by generalizing Paley's construction we can construct even characters χ such that Sχ(tq) gets large near any rational number t.

Paley's construction makes use of the fact that the sum

[formula]

Here [formula] is an odd character modulo 4. More generally it turns out that if χ mod q is an odd character, then

[formula]

while if χ is even,

[formula]

This is proved in the following lemma.

For a primitive character χ mod q and an a relatively prime to q, if χ( - 1)  =  1, then

[formula]

while if χ( - 1)  =   - 1, then

[formula]

We may assume that x is a multiple of q, since [formula]. We treat the case of χ( - 1)  =  1; the second case is basically identical.

We have

[formula]

Note that

[formula]

so the above sum is

[formula]

where

[formula]

Note that

[formula]

however, since χ is even and sine is odd, the sum on the right hand side vanishes, and we have

[formula]

Using this lemma and Theorem [\ref=thm-average], we can prove that there are characters for which the character sum large gets near any rational number that is not 0 or 1 / 2. We recall Theorem [\ref=thm-large-sums], which was stated introduction.

A standard modification of Paley's construction gives the existence of a primitive odd quadratic character χ1 of arbitrarily large conductor q such that χ1(n)  =  1 for all [formula]. (See [\cite=GLeven], for example.) We can then take any primitive ψ mod b and consider the character χ  =  χ1ψ mod q, where q  =  bq1, which is primitive and has order [formula], where g is the order of ψ. For this character we have

[formula]

where again f(x)  =    -   cos (x) if χ( - 1)  =   - 1 and f(x)  =  i sin (x) otherwise. Choose [formula]. In this range, [formula], so we have

[formula]

Then by the previous lemma we have

[formula]

We conclude that for some α∈[a  /  b   -   1  /  B,a  /  b   +   1  /  B], S(χ) must get at least as large as this average value, which has size

[formula]

For the extra statement about the size of A(χ) when χ is odd and b  >  1, we appeal to Littlewood's GRH-conditional result [\cite=littlewood] that

[formula]

Note that

[formula]

so

[formula]

which is bounded as q  →    ∞  .

In the above proof, if we take ψ to be quadratic, then χ will be quadratic as well, so we know the signs of the Gauss sums. For an even character we obtain

[formula]

In this case, since Sχ(qt) is real and close enough to a continuous function, it must be within 1 / 2 of its average value at some point in the interval, which gives Theorem [\ref=thm-large-quadratic].

Large character sums over short intervals

The error term in Theorem [\ref=thm-average] is too large to be of much use when considering sums with length smaller than q1 - ε. However, there is a range of lengths between q and q1  -  ε where we can say something, and by combining known lower bounds for character sums with stronger upper bounds for averaged sums, we can assert the existence of sums of size [formula] over intervals of length o(q), which is our Corollary [\ref=corollary-large-sums] in the introduction of this paper.

Some results of this type for real characters are obtained by Granville and Soundararajan in [\cite=large-character-sums] (see Theorem 11, for example) for character sums over initial intervals. Granville and Soundararajan's results are stronger than what we obtain from Theorem [\ref=thm-average], but our proof is very simple and applies to any character for which the sum up to q / 3 is large, so it is not restricted to real characters.

For a primitive even character, Theorem [\ref=thm-average] trivially gives

[formula]

On the other hand, there exist primitive even characters such that

[formula]

(See [\cite=pretentious-characters].) This means that for such characters, whenever

[formula]

the average value of the character sum over this interval is significantly less than the maximum of the character sum on this interval. So for such B, there exist sums of length ≤  q / B which are large. If we take B  =  ( log q)A, then we find that for [formula], there exists an N with |N|  ≤  q / ( log q)A such that

[formula]

A look at odd characters with large least nonresidue

We now use the same methods as above to examine what happens with a quadratic character modulo a prime [formula] such that all small primes are quadratic residues modulo q. For such characters, we expect that L(1,χ) is exceptionally large. The central value of the character sum is [formula], so the character sum should be quite large at this point; this central point, however, will actually be a local minimum of the character sum. In fact, computations tend to reveal that the maximum of this sum occurs at or near (B - 1) / 2B, where B is the least quadratic nonresidue modulo q.

Recall the Fourier expansion for an odd quadratic character χ mod q with χ(2)  =  1:

[formula]

where

[formula]

If χ(n)  =  1 for all n  <  B, then for t  =  1 / 2, the sum in the expansion starts

[formula]

However, for t  =  1 / 2 we know that that

[formula]

exactly, which means that

[formula]

and thus the terms in the sum for n  ≥  B completely cancel out the initial contribution from the terms where χ(n)  =  1. However, as with Theorem [\ref=thm-average], if we instead consider the average value of this sum in an interval around t  =  1 / 2, the rapid oscillation of the cosines for large n will cause these terms to have a much smaller influence.

We consider the average of the character sum around 1 / 2, computing the same integral as in Theorem [\ref=thm-average].

[formula]

Instead of truncating now at B, we choose some (large) parameter A and truncate the sum at AB, with an error of at most [formula], so that

[formula]

Now, since asymptotically 100% of the numbers up to AB are (B - 1)-smooth as B  →    ∞  , this sum will be well approximated by χ(n) replaced by 1. Specifically, since all of these numbers are ≥  B, each one contributes at most [formula] to the sum and an easy count reveals that the set of n in this range such that χ(n)  ≠  1 is very small.

The number of integers up to AB that are not (B - 1)-smooth is [formula].

Suppose that B  ≤  n  ≤  AB is divisible by some prime p  ≥  B. Then n / p  ≤  A. This means that any number in the range B  ≤  n  ≤  AB which is not B-smooth is the product a prime in that range and a number less than A. There are ≪  AB /  log (AB) primes in this range, and A integers <  A, which gives the bound.

Using this lemma, we see that if we replace χ(n) by 1 in the sum up to AB, the error will be at most

[formula]

After replacing χ(n) by 1, we can also extend the sum to infinity at an error of at most O(1 / A), so we have

[formula]

Now as B gets large we see that this sum approaches

[formula]

This proves Theorem [\ref=thm-lqnr], which we recall here.