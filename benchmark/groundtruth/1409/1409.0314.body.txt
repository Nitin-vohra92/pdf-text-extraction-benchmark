Empirical Evaluation of Tree distances for Parser Evaluation

Introduction

The tree, as a device, has been employed to depict the relationships both within languages as well as species. Both historical linguists and evolutionary biologists employ the tree device to capture language and biological evaluation. The computational subbranches of both the disciplines employ statistical and quantitative techniques to infer relationships based on sequence data: linguistic units such as lexemes, grammatical markers; and gene sequences [\cite=levinson2012tools] [\cite=felsenstein2004inferring]. In the case of historical linguistics, inferred language trees are compared with trees inferred from application of the comparative method [\cite=hoenigswald1973comparative]. and compare different tree distance measures for comparing different language relationship inference techniques.

In the related field of computational linguistics, the grammatical relationships between words in a sentence are captured through rooted, labeled trees. Moving along the spectrum, trees by themselves play a major role in computer science [\cite=bille2005survey]. formalizes the PARSEVAL metrics [\cite=abney1991procedure] in the context of constituency-based parsing. In any case, much research seems to be have gone into quantitative tree comparison in related disciplines.

The rest of the article is organized as followed: Section [\ref=sec:treedist] describes tree distance measures. Section [\ref=sec:dataset] describes the dataset used in our experiments. In section [\ref=sec:results], I describe the results of the empirical study. Section [\ref=sec:concl] concludes and provides the future directions.

Tree distances

Basics

In this subsection, I define basic symbols and terms. A input string I is composed of words [formula] of length n. A parse tree, T defines the relationship between these words. Following , a tree T is composed of triples (s,t,X) where, s to t are consecutive words dominated by an internal node labeled as X. Following , the matching criteria for an automatic parse tree Ta with its gold standard tree Tg is defined in terms of unlabeled precision (P) and recall (R). Let Ng be the number of internal nodes in Tg and Na be the number of internal nodes in Ta. Let [formula].

Precision (P): B / Na

Recall (R): B / Ng

F-score: 2PR / (P + R)

Let E be the set of edges, V be the set of internal nodes, IE be the set of internal edges and, n the number of leaves in a tree. Then the following conditions hold for any tree:

|E|  =  |V|  +  n - 1

|IE| = |V| - 1

|V|  =  n - 2

The rest of the article assumes that trees are both unlabeled and m-ary.

RF (Robinson-Foulds) Distance

defined two operations α and α- 1 for transforming a tree T to tree T' in a finite sequence of operations. The α operation is a edge contraction operation whereas α- 1 is an expansion operation. It takes a maximum of |E| + |E'| operations and a minimum of ||E| - |E'|| operations to transform T to T'. In essence, the RF distance is defined as the number of α- 1 and α operations needed to transform one tree to another. An internal edge divides a tree into two disjoint sets of leaf nodes known as bipartition. A tree with n leaves has n - 3 bipartitions. Consequently, an internal edge defines a bipartition. In terms of bipartitions, RF distance, RFD between two trees T,T' is defined as:

[formula]

[formula]

Thus, the RF distance measures the dissimilarity in the topology between the inferred tree and the corresponding family tree. It should be noted that the RF distance does not take branch lengths into account. Also, the RF distance can be further modified to compute the distance between two trees by introducing a label substitution operation. It can be easily seen that RF distance is related to tree edit distance used in . RF distance works in terms of internal edges whereas, tree edit distance works in terms of node insertion, deletion, and substitution. I also show that P and R are related to RFD.

[formula]

[formula]

Substituting, P and R into the formulas for RFD yields another formula: [formula].

This formulation suggests that the F-score, of each parse tree, obtained from the EvalB metric should correlate highly with the RF distance. The RF distance is zero when both the trees have no internal edges. Such trees have star topologies.

RF distance is a harsh measure that penalizes Ta for small errors. For example, a triple (s,t- 1,X) - assuming that position of s is not the same as t - in Ta will be counted as an error since it is not present as (s,t,X) in Tg. Such kind of harsh penalization can be smoothened by employing Generalized Robinson-Foulds distance (GRFD).

GRFD, as introduced by , relaxes the strict equality condition of bipartitions with compatibility criterion. To start with, a bipartition k divides the leaf set into two disjoint sets k1,k2. In the authors' terms, a bipartition a in tree Ta is said to be compatible with i-th bipartition in Tg - consisting of gi1,gi2 sets - if for each bipartition i in Tg, one of the following is true: a1  ⊆  gi1, or a1  ⊆  gi2, or a2  ⊆  gi1, or a2  ⊆  gi2. Finally, GRFD is defined as [formula] where, C(T,T') yields a set of compatible bipartitions. The GRFD is not a metric whereas, RFD is shown to be a metric [\cite=robinson1981comparison].

Quartet distance

Both RFD and GRFD work with internal edges (or subtrees). Another possible distance is the quartet distance which measures the distance between two trees in terms of the number of different quartets between the two trees [\cite=estabrook1985comparison]. A quartet is defined as a set of four leaves selected from a set of leaves without replacement. A tree with n leaves has [formula] quartets in total.

A quartet defined on four leaves a,b,c,d can have four different topologies: ab|cd, ac|bd, ad|bc, and ab  ×  cd. The first three topologies have an internal edge separating two pairs of leaves. Such quartets are called as butterflies. The fourth quartet has no internal edge and as such is known as star quartet. A parse tree can have an internal node that is a parent to at least four leaves. By definition, quartet distance is defined only for those sentences whose length is at least 4.

For a tree T with n leaves, the quartets can be partitioned into set of butterflies, B(T), and set of stars, S(T). Then, quartet distance (QD) between T and T' is defined as:

[formula]

reformulate QD as follows:

[formula]

where, DB(T,T') is the number of different butterflies between T,T'. A different butterfly is based on the same leaf set but has different topologies in the two trees. Since the trees are m-ary, d is defined as the maximum degree of an internal node. developed a fast algorithm that runs in O(n2d2) in time, and needs O(n2) in terms of space.

The QD formula in equation [\ref=eq:qd] counts the butterflies in Ta as errors. The tree Ta should not be penalized for the unresolvedness in the gold standard tree Tg. To this end, defined a new measure known as GQD (Generalized QD) to discount the presence of star quartets in Tg. GQD is defined as DB(Ta,Tg) / B(Tg). We use both QD and GQD to evaluate the quality of the automatically generated parse trees. It can be easily seen that both QD and GQD are lenient in scoring a subtree when the parser misses or adds a leaf in comparison with the gold standard tree.

Parser and dataset

For our experiments, I use the Charniak parser to parse the 2416 sentences in the section 23 of the Penn TreeBank. Out of these parses, I discarded all the parses which have sentence length less than 4. I was left with 2378 parses after this step. I also converted both the automatic and gold parses into the NEWICK format [\cite=felsenstein2004inferring]. NEWICK format is a bracketing format to represent trees and uses "," symbol to separate adjacent leaves; opening and closing parantheses. I also removed the POS tag for each word. This step removes all the nodes which have a degree of 2. Hence a final NEWICK format tree consists of brackets and words alone. I use the EvalB program to compute the sentence-level precision and recall scores.

Results

In this paper, I only work with sentence-level parsing F-scores. Our first hypothesis is that RFD will correlate to a large extent with the F-scores. This hypothesis is formed from the similarity in the formulae shown in section [\ref=subsec:bipart]. Accordingly, the pearson's r between RFDs and F-scores is - 0.9. We attribute the difference to the handling of top-level brackets. We ignore the top-level bracket enclosing the root symbol whereas EvalB includes it in the calculation. GRFDs and F-scores also show a correlation of - 0.82. The correlation is expected to be negative since F-score is a measure of similarity whereas RFD is a distance metric.

I also checked the correlation of QDs and GQDs with F-scores. The correlation is quite high: - 0.73 and - 0.68 respectively. I also computed the correlation between the four different distance measures. The correlation is shown in table [\ref=tab:corrs].

The measures correlate highly but not completely. This is in line with the observation of who observe - based on simulated trees and real world data - that RFD and QD correlate quite well but measure different aspects of the trees.

Conclusion and future work

In this article, I described two popular tree distance measures from computational biology and applied them for the purpose of parser evaluation. I observe that the measures correlate with each other, to a large extent, for a single parser's output. I argued that QD and generalized tree distance measures are much suitable for parser evaluation task since the gold parses can have internal nodes with degrees greater than 2. I also argued that RF distance measures the same thing as the tree edit distance does for computing unlabeled accuracies. This hypothesis is corroborated in terms of a high pearson's r. In future, we plan to test the different measures on other off-the-shelf parsers.

Acknowledgements

I thank Richard Johansson for providing the binaries of Charniak parser. I thank Prasanth Kolachina and Richard Johansson for interesting discussions. I thank Joakim Nivre for the patience and encouragement through the whole process of experiments and report writing.