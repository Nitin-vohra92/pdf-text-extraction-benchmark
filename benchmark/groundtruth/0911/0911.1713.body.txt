Isometries and Construction of Permutation Arrays

Permutation arrays and permutation codes

An (n,d)-permutation code of distance d, size s and degree n is a non-empty subset C of the symmetric group Sym(n) such that the Hamming distance between any two distinct elements of C is at least equal to d. The Hamming distance between two permutations φ,ψ∈Sym(n) is defined as [formula]. The s  ×  n array A associated to a (n,d)-permutation code [formula] of size s by Aij  =  φi(j) has the following properties: every symbol 1 to n occurs exactly in one cell of any row and any two rows disagree in at least d columns. Such an array is called a permutation array (PA) of distance d, size s and degree n. Permutation codes have first been proposed by Ian Blake in 1974 as error-correcting codes for powerline communication [\cite=D29]. This application motivates the study of permutation codes having the largest possible size. Upper bounds for the maximal size μ(n,d) of a permutation code with fixed parameters n and d have been studied by many authors, see e.g. Deza [\cite=C26], Cameron [\cite=C3], and more intensively since Chu, Colbourn and Dukes [\cite=C6],Tarnanen [\cite=C14], and Han Vinck [\cite=B19] [\cite=B22].

A (n,d)-permutation code C of size s is maximal if C is not contained in a (n,d)-permutation code of larger size s' > s. Note that a (n,d)-permutation code reaching the maximal size μ(n,d) is necessarily maximal while the converse is not true. In this article, we will focus on the generation up to isometry of all maximal permutation codes with fixed parameters n and d.

The paper is organised as follows: section [\ref=secIso] describes the isometry group of the metric space (Sym(n),dH), section [\ref=secGenAllPA] contains improvements of methods to obtain all PA's of a given size. Section [\ref=GenAllMaxPA] describes two algorithms for generating all maximal permutation codes up to isometry.

Isometries

A distance D on Sym(n) is called left-invariant (resp. right-invariant) if D(φ,ψ) = D(αφ,αψ) (resp. D(φ,ψ) = D(φα,ψα) ) for all α,φ,ψ∈Sym(n). A distance that is both left- and right-invariant is said to be bi-invariant. For any bi-invariant distance, the left multiplications lα:φ  ↦  αφ and the right multiplications rα:φ  ↦  φα- 1 are isometries. As noticed by Deza [\cite=D18], any bi-invariant distance is invertible: D(φ,ψ) = D(φ- 1,ψ- 1), or equivalently, the inversion ı, mapping each permutation onto its inverse, is an isometry. Let denote by R (resp. L) the group of all right (resp. left-) multiplications and by I the group generated by the inversion ı. We will say that the distance D distinguishes the transpositions if there exists a constant c such that [formula] is a transposition.

In 1960, Farahat characterized the isometry group Iso(n) of the metric space (Sym(n),dH) [\cite=D17]. Since the Hamming distance is bi-invariant and distinguishes the transpositions, the following result generalizes the characterisation given by Farahat:

Let D be a bi-invariant distance distinguishing the transpositions on Sym(n) (n  ≥  3), then the group IsoD of isometries of (Sym(n),D) is [formula], isomorphic to [formula].

Proof: For any bi-invariant distance D distinguishing the transpositions, the isometry group of (Sym(n),D) contains the groups L, R and I, generating the group [formula]. The pointwise stabiliser of the set containing the identity, the transpositions (1,k) with 2  ≤  k  ≤  n and (1,2,3) in the isometry group Iso(n) is the trivial group, proving that there is no other isometries than [formula]. See [\cite=MB2009] for developements.

Every isometry t∈Iso(n) can be uniquely written as lαrβık with k = 0 or 1, α,β∈Sym(n). The action of a left multiplication lα on a given code corresponds to the permutation under α of the symbols appearing in the PA associated to the code, and the action of a right-multiplication rβ is equivalent to the permutation under β of the columns of the PA. In other words, classifying permutation codes up to isometry is equivalent to classifying PA's up to permutation of their rows, their columns, their symbols and up to the inversion.

Generate all (n,d)-permutation codes of a given size

An efficient way to generate all permutation codes of a given size is described in [\cite=C6] as a clique search. A graph is built whose vertices are the elements of Sym(n) and whose edges are the pairs of permutations at distance at least equal to d. A (maximal) (n,d) - permutation code is equivalent to a (maximal) clique in this graph. Since the isometry group Iso(n) is transitive on Sym(n), any (n,d)-permutation code is isometric to a permutation code containing the identity permutation Id. Assuming that the permutation code contains Id, the clique search is restricted to the neighbourhood of the vertex Id, that is, to the set of permutations that are at distance at least equal to d from the permutation Id. This improvement reduces the number of vertices to consider from n! to [formula], where Dk is the number of fixed-point-free permutations of k points .

Using this method, we confirm the results of T. Kløve [\cite=B5]: there are, up to isometry, exactly 7 (6,5) -  permutation codes of size 18. Note that the equivalence between PA's used in [\cite=B5] doesn't take in consideration the inversion ı.

The subgroups of Sym(n) can be used to construct large PA's. Starting form a subgroup G, Chu, Colbourn and Dukes used the orbits of LG =  < lβ:β∈G >  to simplify the construction of PA's using a clique search algorithm. More recently, Janiszczak and Staszewski [\cite=IJRS] used the orbits a subgroup of Iso(10) (more precisely, a subgroup UG of the conjugacies UG =  < lβrβ:β∈G > ) in order to prove that μ(10,9)  ≥  49. Using other subgroups of Iso(n), we found other codes as e.g. an (7,4) - permutation code of size 336 preserved by a subgroup of Iso(7) of order 7056 [\cite=HomepageMB].

Generating all maximal permutation codes up to isometry

In the past few years, techniques have been developped in order to construct PA's of large size. We adopt another approach, and for small values of n and d, succeed to classify all maximal permutation codes up to isometry. Note that for d = n, a maximal permutation code has size s = n and the PA associated to such a code is a latin square. The enumeration of latin squares up to permutation of the rows, columns and symbols has been widely studied and has been achieved for n  ≤  11, see [\cite=B16] [\cite=B14]. As far as we know, the only classification of maximal (n,d)-permutation codes with d < n has been made by Torleiv Kløve for (6,5) - permutation codes of size 18, as mentionned in section [\ref=secGenAllPA].

In order to generate all maximal permutation codes with fixed parameters n and d, we used two isomorphism free generation algorithms, as introduced by McKay [\cite=D13]. The first one is based on the backtrack principle, at every step the generated code is compared to the list of already encountered codes. We introduce here the notation Vd(C) for the set of permutations that are at distance at least equal to d of all elements in C.

Initiated with an empty list and a code C consisting of a single permutation, algorithm [\ref=GENBYLIST] produces exactly one representative of each permutation code up to isometry. It requires to compare permutation codes, motivating the developpement of invariants that are efficient to test whether two permutation codes are isometric or not.

We define the pair of quotient sets of a (n,d)-permutation code C as the ordered set (Δ(C),Σ(C)) where

[formula]

[formula]

Two pairs of quotients sets (Δ,Σ),(Δ',Σ') are equivalent if there exists α,β∈Sym(n) such that αΔα- 1  =  Δ' and βΣβ- 1  =  Σ' or αΔα- 1  =  Σ' and βΣβ- 1  =  Δ'.

A famous code invariant is the distance enumerator polynomial of a code C, that enumerates the number of pairs of permutations wich are at distance k for 0  ≤  k  ≤  n. This invariant is weaker than the cycle index polynomial QC(x) of the permutation code C, defined using the p(n) conjugacy classes [formula] as [formula] where bj is the number of pairs of permutations (φ,ψ) of C such that φψ- 1∈Cj. If the code C is a group, the cycle index polynomial of C coincides with the usual definition of the cycle index polynomial of a group.

The set of occurences Occ(C) associated to a (n,d)-permutation code C is defined as Occ(C): = {oij:1  ≤  i,j  ≤  n} where oij is the number of permutations φ∈C such that φ(i) = j. If Occ(C) = {r}, then the permutation code is said to be r-balanced (see [\cite=C24]).

Given an (n,d)-permutation code C of size s, we define the graph (V(C),E(C)) as follows. The s + n2 + 2n vertices are partionned into four sets V1: = {φi:1  ≤  i  ≤  s}, V2: = {cj:1  ≤  j  ≤  n}, V3: = {sj:1  ≤  j  ≤  n} and V4: = {cij:1  ≤  i,j  ≤  n}, φi is the i-th permutation of C, cj is the j-th column, sj is the j-th symbol and cij is the (i,j)-cell of the permutation array associated to C. The edges of the graph are defined by the following rule: φk(i) = j if and only if the vertex cij∈V4 is adjacent to the vertices φk∈V1, ci∈V2 and sj∈V3.

The pair of quotient sets, the cycle index polynomial and the set of occurences are invariants, but are not complete invariants. The graph (V(C),E(C)) of the code C is a complete invariant.

The proof of this statement is routine check since the isometry group is described by Theorem [\ref=TheoIso].

The graph (V(C),E(C)) can also be used to obtain a canonical form of the permutation code by a canonical labelling of the vertices of the graph (using e.g. routines of Nauty [\cite=Nauty]). The canonical form automatically defines a canonical augmentation p(C) for any code C, and insures that the algorithm [\ref=CANAUG] generates all non-isomorphic maximal codes. Results of algorithm [\ref=GENBYLIST] are confirmed by the results of algorithm [\ref=CANAUG]: there are, up to isometry, 61 (4,3) - permutation codes (4 are maximal) and 9445 (5,4) - permutation codes (139 are maximal). Table [\ref=NonIsoPA] details the numbers of non-isometric maximal PA's of distance 4 on Sym(5), of size 7 to 20.

An r-balanced PA with n symbols has size exactly nr. We constructed all non-isometric r-balanced codes C(n,d) for small values of n and d. Table [\ref=NonIsoPAbal] shows the exact number Mr(n,d) of non-isometric r - balanced (n,d) - permutation codes for small values of n,d and r. All our permutation codes and the code of our Magma [\cite=MAGMA] programs are available [\cite=HomepageMB].