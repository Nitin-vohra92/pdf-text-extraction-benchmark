The Chromatic Number of Random Regular Graphs

Introduction

In [\cite=luczak2], Luczak proved that for every real d > 0 there exists an integer k = k(d) such that w.h.p. χ(G(n,d / n)) is either k or k + 1. Recently, these two possible values were determined by the first author and Naor [\cite=AchNaor].

Significantly less is known for random d-regular graphs [formula]. In [\cite=friezeluczak], Frieze and Luczak extended the results of [\cite=luczak] for [formula] to random d-regular graphs, proving that for all integers d > d0, w.h.p.

[formula]

Here we determine [formula] up to three possible values for all integers. Moreover, for roughly half of all integers we determine [formula] up to two possible values. We first replicate the argument in [\cite=luczak2] to prove

For every integer d, there exists an integer k = k(d) such that w.h.p. the chromatic number of  is either k or k + 1.

We then use the second moment method to prove the following.

For every integer d, w.h.p. [formula] is either k, k + 1, or k + 2, where k is the smallest integer such that d  <  2k log k. If, furthermore, d  >  (2k - 1) log k, then w.h.p. [formula] is either k + 1 or k + 2.

The table below gives the possible values of [formula] for some values of d.

[formula]

Preliminaries and outline of the proof

Rather than proving our results for  directly, it will be convenient to work with random d-regular multigraphs, in the sense of the configuration model [\cite=BoRG]; multigraphs [formula] generated by selecting a uniformly random configuration (matching) on dn "vertex copies." It is well-known that for any fixed integer d, a random such multigraph is simple w.p.p. As a result, to prove Theorem [\ref=thm:twoval] we simply establish its assertion for [formula].

To prove Theorem [\ref=thm:f] we use the second moment method to show

If d  <  2k log k, then w.p.p. [formula].

Proof of Theorem [\ref=thm:f]. For integer k let uk  =  (2k - 1) log k and ck  =  2k log k. Observe that ck - 1  <  uk  <  ck. Thus, if k is the smallest integer such that d  <  ck, then either i) uk  <  d  <  ck or ii) uk - 1  <  ck - 1  <  d  ≤  uk  <  ck.

A simple first moment argument (see e.g. [\cite=molloyms]) implies that if d  >  uk then w.h.p. [formula]. Thus, if uk  <  d  <  ck, then w.h.p. [formula] is non-k-colorable while w.p.p. it is (k + 1)-colorable. Therefore, by Theorem [\ref=thm:twoval], w.h.p. the chromatic number of  (and therefore ) is either k + 1 or k + 2. In the second case, we cannot eliminate the possibility that [formula] is w.p.p. k-colorable, but we do know that it is w.h.p. non-(k - 1)-colorable. Thus, similarly, it follows that [formula] is w.h.p. k, k + 1 or k + 2. [formula]

Throughout the rest of the paper, unless we explicitly say otherwise, we are referring to random multigraphs . We will say that a multigraph is k-colorable iff the underlying simple graph is k-colorable. Also, we will refer to multigraphs and configurations interchangeably using whichever form is most convenient.

2-point concentration

Our main technical tool is the following martingale-based concentration inequality for random variables defined on  [\cite=wormaldreg]. Given a configuration C, we define a switching in C to be the replacement of two pairs {e1,e2}, {e3,e4} by {e1,e3}, {e2,e4} or {e1,e4}, {e3,e2}.

Let Xn be a random variable defined on [formula] such that for any configurations C,C' that differ by a switching

[formula]

for some constant b > 0. Then for every t > 0,

[formula]

Theorem [\ref=thm:twoval] will follow from the following two lemmata. The proof of Lemma [\ref=sparseness] is a straightforward union bound argument and is relegated to the full paper.

For any 0  <  ε  <  1 / 6 and d  <  n1 / 6 - ε, w.h.p. every subgraph induced by s  ≤  nd- 3(1 + 2ε) vertices contains at most (3 / 2 - ε)s edges.

For a given function ω(n), let k = k(ω,n,p) be the smallest k such that

[formula]

With probability greater than 1  -  1 / ω(n), all but [formula] vertices of  can be properly colored using k colors.

Proof. For a G, let Yk(G) be the minimal size of a set of vertices S for which G - S is k-colorable. Clearly, for any k and G, switching two edges of G can affect Yk(G) by at most 4, as a vertex cannot contribute more than itself to Yk(G). Thus, if [formula], Theorem [\ref=thm:pairing] implies

[formula]

Define now u = u(n,p,ω(n)) to be the least integer for which Pr [χ(G)   ≤   u]  ≥  1 / ω(n). Choosing λ  =  λ(n) so as to satisfy e-  λ2 / (16d)  =  1 / ω(n), the first inequality in ([\ref=pocoloco]) yields

[formula]

Clearly, if Pr [null]  <   Pr [Yu  =  0] then [formula]. Thus, the second inequality in ([\ref=pocoloco]) implies Pr [null]  <  1 / ω(n) and, by our choice, [formula]. [formula]

Proof of Theorem [\ref=thm:twoval]. Given d  ≥  3, let k = k(d,n)  ≥  3 be the smallest integer for which the probability that  is k-colorable is at least 1 /  log  log n. By Lemma [\ref=tail], w.h.p. there exists a set of vertices S such that all vertices outside S can be colored using k colors and [formula]. From S, we will construct an increasing sequence of sets of vertices {Ui} as follows. U0 = S; for i  ≥  0, [formula], where [formula] are adjacent and each of them has some neighbor in Ui. The construction ends, with Ut, when no such pair exists.

Observe that the neighborhood of Ut in the rest of the graph, N(Ut), is always an independent set, construction would have gone on. We further claim that w.h.p. the graph induced by the vertices in Ut is k-colorable. Thus, using an additional color for N(Ut) yields a (k + 1)-coloring of the entire , concluding the proof.

We will prove that Ut is, in fact, 3-colorable by proving that |Ut|  ≤  s0  /  ε. This suffices since by Lemma [\ref=sparseness] w.h.p. every subgraph H of b or fewer vertices has average degree less than 3 and hence contains a vertex v with deg (v)  ≤  2. Repeatedly invoking Lemma [\ref=sparseness] yields an ordering of the vertices in H such that each vertex is adjacent to no more than 2 of its successors. Thus, we can start with the last vertex in the ordering and proceed backwards; there will always be at least one available color for the current vertex. To prove |Ut|  ≤  2s0 log n we observe that each pair of vertices entering U "brings in" with it at least 3 new edges. Therefore, for every j  ≥  0, Uj has at most s0  +  2j vertices and at least 3j edges. Thus, by Lemma [\ref=sparseness], w.h.p. t  <  3s0 / (4ε). [formula]

Establishing colorability in two moments

Let us say that a coloring σ is if its color classes differ in size by at most 1, and let X be the number of nearly-balanced k-colorings of . Recall that ck  =  2k log k. We will prove that for all k  ≥  3 and d  <  ck - 1 there exist constants C1,C2 > 0 such that for all sufficiently large n (when dn is even),

[formula]

By the Cauchy-Schwartz inequality (see e.g. [\cite=jlr]), we have [formula], and thus Theorem [\ref=thm:pos].

To prove [\eqref=eq:down], [\eqref=eq:up] we will need to bound certain combinatorial sums up to constant factors. To achieve this we will use the following Laplace-type lemma, which generalizes a series of lemmas in [\cite=ksat] [\cite=hyper] [\cite=AchNaor]. Its proof is standard but somewhat tedious, and is relegated to the full paper.

Let [formula] be positive integers. Let [formula], and let M be a [formula] matrix of rank r with integer entries whose top row consists entirely of 1's. Let s,t be nonnegative integers, and let [formula] for 1  ≤  i  ≤  s and 1  ≤  j  ≤  t, where each [formula] and [formula] has at least one nonzero component, and where moreover [formula]. Let [formula] be a positive twice-differentiable function. For [formula], define

[formula]

and define [formula] as

[formula]

where [formula]. Now suppose that, conditioned on [formula], g is maximized at some ζ* with ζ*i  >  0 for all i, and write g max  =  g(ζ*). Furthermore, suppose that the matrix of second derivatives g''  =  ∂2g  /  ∂ζi  ∂ζj is nonsingular at ζ*.

Then there exist constants A,B  >  0, such that for any sufficiently large n for which there exist integer solutions [formula] to [formula], we have

[formula]

For simplicity, in the proofs of [\eqref=eq:down] and [\eqref=eq:up] we will assume that n is a multiple of k, so that nearly-balanced colorings are in fact exactly balanced, with n / k vertices in each color class. The calculations for other values of n by at most a multiplicative constant.

The first moment

Clearly, all balanced k-partitions of the n vertices are equally likely to be proper k-colorings. Therefore, [formula] is the number of balanced k-partitions, n!  /  (n / k)!k, times the probability that a random d-regular configuration is properly colored by a fixed balanced k-partition.

To estimate this probability we will label the d copies of each vertex, thus giving us (dn - 1)!! distinct configurations, and count the number of such configurations that are properly colored by a fixed balanced k-partition. To generate such a configuration we first determine the number of edges between each pair of color classes. Suppose there are bij edges between vertices of colors i and j for each i  ≠  j. Then a properly colored configuration can be generated by i) choosing which bij of the dn / k copies in each color class i are matched with copies in each color class j  ≠  i, and then ii) choosing one of the bij! matchings for each unordered pair i  <  j. Therefore, the total number of properly colored configurations is

[formula]

Summing over all choices of the {bij} that satisfy the constraints

[formula]

we get

[formula]

By Stirling's approximation [formula] we get

[formula]

where D1  =  2- (k + 1) / 2  d(k - 1) / 2.

To bound the sum in [\eqref=eq:1stmoment2] from below we use Lemma [\ref=lem:laplace]. Specifically, [formula] consists of the variables bij with i  <  j, so [formula]. For k  ≥  3, the k constraints [\eqref=eq:bij] are linearly independent, so representing them as [formula] gives a matrix M of rank k. Moreover, they imply [formula], so adding a row of 1's to the top of M and setting y1  =  d / 2 does not increase its rank. Integer solutions [formula] exist whenever n is a multiple of k and dn is even. We set s = 1 and [formula]; the vector [formula] consists of 1's and the [formula] are the [formula] basis vectors. Finally, f(ζ) = 1. Thus, [formula] and

[formula]

where H is the entropy function [formula].

Since g is convex it is maximized when [formula] for all [formula], and g'' is nonsingular. Thus, g max  =  (k(k - 1) / 2)d / 2 implying that for some A > 0 and all sufficiently large n

[formula]

Setting C1  =  D1A completes the the proof.

The second moment

Recall that X is the sum over all balanced k-partitions of the indicators that each partition is a proper coloring. Therefore, [formula] is the sum over all pairs of balanced k-partitions of the probability that both partitions properly color a random d-regular configuration. Given a pair of partitions σ,τ, let us say that a vertex v is in class (i,j) if σ(v) = i and τ(v) = j. Also, let aij denote the number of vertices in each class (i,j). We call A = (aij) the overlap matrix of the pair σ,τ. Note that since both σ and τ are balanced

[formula]

We will show that for any fixed pair of k-partitions, the probability that they both properly color a random d-regular configuration depends only on their overlap matrix A. Denoting this probability by q(A), since there are [formula] pairs of partitions giving rise to A, we have

[formula]

where the sum is over matrices A satisfying [\eqref=eq:aconstraints].

Fixing a pair of partitions σ and τ with overlap matrix A, similarly to the first moment, we label the d copies of each vertex thus getting (dn - 1)!! distinct configurations. To generate configurations properly colored by both σ and τ we first determine the number of edges between each pair of vertex classes. Let us say that there are [formula] edges connecting vertices in class (i,j) to vertices in class [formula]. By definition, [formula], and if both colorings are proper, [formula] unless i  ≠  k and [formula]. Since the configuration is d-regular, we also have

[formula]

To generate a configuration consistent with A and [formula] we now i) choose for each class (i,j), which [formula] of its daij copies are to be matched with copies in each class [formula] with k  ≠  i and [formula], and then ii) choose one of the [formula] matchings for each unordered pair of classes i  <  k, [formula]. Thus,

[formula]

where the sum is over the [formula] satisfying [\eqref=eq:bconstraints]. Combining [\eqref=eq:x2q] with [\eqref=eq:x2] gives

[formula]

To bound the sum in [\eqref=eq:x2sum] from above we use Lemma [\ref=lem:laplace]. We let [formula] consist of the combined set of variables [formula], in which case its dimensionality [formula] (not to be confused with the color [formula]) is k2  +  (k(k - 1))2  /  2. We represent the combined system of constraints [\eqref=eq:aconstraints], [\eqref=eq:bconstraints] as [formula]. The k2 constraints [\eqref=eq:bconstraints] are, clearly, linearly independent while the 2k constraints [\eqref=eq:aconstraints] have rank 2k - 1. Together these imply [formula] and [formula], so adding a row of 1's to the top of M does not change its rank from r  =  k2  +  2k  -  1. Integer solutions [formula] exist whenever n is a multiple of k and dn is even. Finally, f(ζ)  =  2d / 2, s  =  k2 + 2 and t  =  k2 + 1 + (k(k - 1))2 / 2, so [formula].

Writing αij and [formula] for the components of ζ corresponding to aij / n and [formula], respectively, we thus have

[formula]

In the next section we maximize g(ζ) over [formula] satisfying [formula]. We note that g'' is nonsingular

A tight relaxation

Maximizing g(ζ) over [formula] satisfying [formula] is greatly complicated by the constraints

[formula]

To overcome this issue we i) reformulate g(ζ) and ii) relax the constraints, in a manner such that the maximum value remains unchanged while optimization becomes much easier.

The relaxation amounts to replacing the k2 constraints [\eqref=eq:betaconstraints] with their sum divided by 2, i.e., with the single constraint

[formula]

But attempting to maximize [\eqref=eq:x2g] under this single constraint is, in fact, a bad idea since the new maximum is much greater. Instead, we

[formula]

using [\eqref=eq:betaconstraints] to substitute for the exponents dαij in the numerator of [\eqref=eq:x2g]. This turns out to be enough to drive the maximizer back to the subspace [formula].

Specifically, let us hold {αij} fixed and maximize g(ζ) with respect to [formula] using the method of Lagrange multipliers. Since log g is monotonically increasing in g, it is convenient to maximize log g instead. If λ is the Lagrange multiplier corresponding to the constraint [\eqref=eq:single], we have for all [formula]:

[formula]

and so

[formula]

{Clearly, such [formula] also satisfy the original constraints [\eqref=eq:betaconstraints],

To solve for C we sum [\eqref=eq:lagrange] and use [\eqref=eq:single], getting

[formula]

Thus C = d / p and [\eqref=eq:lagrange] becomes

[formula]

Observe that p  =  p({aij}) is the probability that a single edge whose endpoints are chosen uniformly at random is properly colored by both σ and τ, if the overlap matrix is aij  =  αijn. Moreover, the values for the [formula] are exactly what we would obtain, in expectation, if we chose from among the [formula] edges with replacement, rejecting those improperly colored by σ or τ, until we had dn / 2 edges--in other words, if our graph model was G(n,m) with replacement, rather than [formula].

Substituting the values [\eqref=eq:b] in [\eqref=eq:rewriteg] and applying [\eqref=eq:single] yields the following upper bound on g(ζ):

[formula]

In [\cite=AchNaor], Achlioptas and Naor showed that for d  <  ck - 1 the function [formula] is maximized when αij  =  1 / k2 for all i,j. In this case p  =  (1 - 1 / k)2, implying

[formula]

and, therefore, that for some constant C2 and sufficiently large n

[formula]

Directions for further work

A sharp threshold for regular graphs.

It has long been conjectured that for every k > 2, there exists a critical constant ck such that a random graph G(n,m = cn) is w.h.p. k-colorable if c < ck and w.h.p. non-k-colorable if c > ck. It is reasonable to conjecture that the same is true for random regular graphs, i.e.  that for all k > 2, there exists a critical integer dk such that a random graph [formula] is w.h.p. k-colorable if d  ≤  dk and w.h.p. non-k-colorable if d > dk. If this is true, our results imply that for d in "good" intervals (uk,ck) w.h.p. the chromatic number of [formula] is precisely , while for d in "bad" intervals (ck - 1,uk) the chromatic number is w.h.p. either k or k + 1.

Improving the second moment bound.

Our proof establishes that if X,Y are the numbers of balanced k-colorings of [formula] and G(n,m = dn / 2), respectively, then [formula]. Therefore, any improvement on the upper bound for [formula] given in [\cite=AchNaor] would immediately give an improved positive-probability k-colorability result for [formula].

In particular, Moore has conjectured that the function [formula] is maximized by matrices with a certain form. If true, this immediately gives an improved lower bound, c*k, for k-colorability satisfying c*k - 1  →  uk  -  1. This would shrink the union of the "bad" intervals to a set of measure 0, with each such interval containing precisely one integer d for each k  ≥  k0.

3-colorability of random regular graphs.

It is easy to show that a random 6-regular graph is w.h.p. non-3-colorable. Based on considerations from statistical physics, Krzkała, Pagnani and Weigt [\cite=weigt] have conjectured that a random 5-regular graph is w.h.p. 3-colorable. The authors (unpublished) have shown that applying the second moment method to the number of balanced 3-colorings cannot establish this fact (even with positive probability).

Acknowledgments. C. Moore is grateful to Tracy Conrad, Alex Russell, and Martin Weigt for helpful conversations, and is supported by NSF grant PHY-0200909.