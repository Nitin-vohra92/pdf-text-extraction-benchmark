Lemma Corollary

Weighted genomic distance can hardly impose a bound on the proportion of transpositions

Introduction

Genome rearrangements are evolutionary events that change genomic architectures. Most frequent rearrangements are reversals (also called inversions) that "flip" continuous segments within single chromosomes. Other common types of rearrangements are translocations that "exchange" segments from different chromosomes and fission/fusion that respectively "cut"/"glue" chromosomes.

Since large-scale rearrangements happen rarely and have dramatic effect on the genomes, the number of rearrangements (genomic distance) between two genomes represents a good measure for their evolutionary remoteness and often is used as such in phylogenomic studies. Depending on the model of rearrangements, there exist different types of genomic distance [\cite=Fertin2009].

Particularly famous examples are the reversal distance between unichromosomal genomes [\cite=HP1] and the genomic distance between multichromosomal genomes under all aforementioned types of rearrangements [\cite=HP2]. Despite that both these distances can be computed in polynomial time, their analysis is somewhat complicated, thus limiting their applicability in complex setups. The situation becomes even worse when the chosen model includes more "complex" rearrangement operations such as transpositions that cut off a segment of a chromosome and insert it into some other place in the genome. Computational complexity of most distances involving transpositions, including the transposition distance, remains unknown [\cite=Radcliffe05] [\cite=Bader2007] [\cite=Elias2007]. To overcome difficulties associated with the analysis of genomic distances many researchers now use simpler models of multi-break [\cite=AlekseyevTCS2008], DCJ [\cite=Yancopoulos05], block-interchange [\cite=Christie1996] rearrangements as well as circular instead of linear genomes, which give reasonable approximation to original genomic distances [\cite=AlekseyevJCB2008].

Another obstacle in genomic distance-based approaches arises from the fact that transposition-like rearrangements are at the same time much rare and "powerful" than reversal-like rearrangements. As a result, in models that include both reversals and transpositions, the genomic distance typically corresponds to rearrangement scenarios with a large proportion of transpositions, which is not biologically adequate. A traditional approach to bounding the proportion of transpositions is weighted genomic distance defined as the minimum weight of a transformation between two genomes, where transpositions are assigned a relative weight α > 1 [\cite=Fertin2009]. A number of previous studies addressed the weighted genomic distance for α  ≤  2. In particular, Bader and Ohlebusch [\cite=Bader2007] developed a 1.5-approximation algorithm for α∈[1,2]. For α = 2, Eriksen [\cite=Eriksen2001] proposed a (1 + ε)-approximation algorithm (for any ε > 0).

Employing the model of multi-break rearrangements [\cite=AlekseyevTCS2008] on circular genomes, that captures both reversals (modelled as 2-breaks) and transpositions (modelled as 3-breaks), we prove that for α∈(1,2], a minimum-weight transformation may entirely consist of transpositions. Therefore, the corresponding weighted genomic distance does not actually achieve its purpose of bounding the proportion of transpositions. We further prove that for α∈(1,2), the minimum-weight transformations do not depend on a particular choice of α from this interval (thus are the same, say, for α = 1.001 and α = 1.999), and give a complete characterization of such transformations. In particular, we show that these transformations coincide with those that at the same time have the shortest length and make the smallest number of breakages in the genomes, first introduced by Alekseyev and Pevzner [\cite=Alekseyev2007].

Our results also provide a theoretical foundation for the empirical observation of Blanchette et al. [\cite=Blanchette1996] that for α  <  2, transpositions are favored over reversals in the minimum-weight transformations.

Multi-break Rearrangements and Breakpoint Graphs

We represent a circular chromosome on n genes [formula] as a cycle graph on 2n edges alternating between directed "obverse" edges, encoding genes and their directionality, and undirected "black" edges, connecting adjacent genes (Fig. [\ref=Fig2]a). A genome consisting of m chromosomes is then represented as m such cycles. The edges of each color form a perfect matching.

A k-break rearrangement [\cite=AlekseyevTCS2008] is defined as replacement of a set of k black edges in a genome with a different set of k black edges forming matching on the same 2k vertices. In the current study we consider only 2-break (representing reversals, translocations, fissions, fusions) and 3-break rearrangements (including transpositions).

For two genomes P and Q on the same set of genes, represented as black-obverse cycles and gray-obverse cycles respectively, their superposition is called the breakpoint graph G(P,Q) [\cite=Bafna1996]. Hence, G(P,Q) consists of edges of three colors (Fig. [\ref=Fig2]b): directed "obverse" edges representing genes, undirected black edges representing adjacencies in the genome P, and undirected gray edges representing adjacencies in the genome Q. We ignore the obverse edges in the breakpoint graph and focus on the black and gray edges forming a collection of black-gray alternating cycles (Fig. [\ref=Fig2]c).

A sequence of rearrangements transforming genome P into genome Q is called transformation. The length of a shortest transformation using k-breaks (k = 2 or 3) is called the k-break distance between genomes P and Q.

Any transformation of a genome P into a genome Q corresponds to a transformation of the breakpoint graph G(P,Q) into the identity breakpoint graph G(Q,Q) (Fig. [\ref=Fig3]). A close look at the increase in the number of black-gray cycles along this transformation, allows one to obtain a formula for the distance between genomes P and Q. Namely, the 2-break distance is related to the number c(P,Q) of black-gray cycles in G(P,Q), while the 3-break distance is related to the number codd(P,Q) of odd black-gray cycles (i.e., black-gray cycles with an odd number of black edges):

The 2-break distance between genomes P and Q is

[formula]

The 3-break distance between genomes P and Q is

[formula]

Breakages and Optimal Transformations

Alekseyev and Pevzner [\cite=Alekseyev2007] studied the number of breakages in transformations. The number of breakages made by a rearrangement is defined as the actual number of edges changed by this rearrangement. A 2-break always makes 2 breakages, while a 3-break can make 2 or 3 breakages. A 3-break making 3 breakages is called complete 3-break. We treat non-complete 3-breaks as 2-breaks.

Alekseyev and Pevzner [\cite=Alekseyev2007] proved that between any two genomes, there always exists a transformation that simultaneously has the shortest length and makes the smallest number of breakages. We call such transformations optimal.

For a 3-break r, we let n3(r) = 1 if r makes 3 breakages (i.e., r is a complete 3-break) and n3(r) = 0 otherwise. For a transformation t, we further define

[formula]

that is, n2(t) and n3(t) are correspondingly the number of 2-breaks and complete 3-breaks in t. If 2-breaks and complete 3-breaks are assigned respectively the weights 1 and α, then the weight of a transformation t is

[formula]

It is easy to see that a transformation t has the length n2(t) + n3(t) = W1(t) and makes [formula] breakages overall. Therefore, a transformation is optimal if and only if it simultaneously minimizes W1(t) and [formula]. We generalize this result in Section [\ref=Sec2] by showing that [formula] can be replaced with any α∈(1,2).

For a rearrangement r applied to a breakpoint graph, let Δrcodd and Δrceven be the resulting increase in the number of respectively odd and even black-gray cycles, respectively. Clearly, Δrcodd  +  Δrceven  =  Δrc gives the increase in the total number of black-gray cycles.

For any 3-break r,

|Δrc|  ≤  1 + n3(r);

Δrcodd is even and |Δrcodd|  ≤  2;

|Δrceven|  ≤  1 + n3(r).

A 3-break r operating on black edges in the breakpoint graph G(P,Q) destroys at least one and at most three black-gray cycles. On the other hand, it creates at least one and at most three new black-gray cycles. Therefore, |Δrc|  ≤  3 - 1  =  2. Similarly, if n3(r) = 0, then |Δrc|  ≤  2 - 1  =  1.

By similar arguments, we also have |Δrcodd|  ≤  3 and |Δrceven|  ≤  3.

Since the total number of black edges in destroyed and created black-gray cycles is the same, Δrcodd must be even. Combining this with |Δrcodd|  ≤  3, we conclude that |Δrcodd|  ≤  2.

If Δrceven = 3, then the destroyed cycles must be odd, implying that Δrcodd =  - 2. However, it is not possible for a 3-break to destroy two cycles and create three new cycles. Hence, Δrceven  ≠  3. Similarly, Δrceven  ≠   - 3, implying that |Δrceven|  ≤  2. If n3(r) = 0 (i.e., r is a 2-break), similar arguments imply |Δrceven|  ≤  1.

A transformation t between two genomes is shortest if and only if Δrcodd = 2 for every r∈t. Furthermore, if t is a shortest transformation between two genomes, then for every r∈t,

if n3(r) = 0, then Δrceven =  - 1;

if n3(r) = 1, then Δrceven = 0 or - 2.

A transformation t of a genome P into a genome Q increases the number of odd black-gray cycles from codd(P,Q) in G(P,Q) to codd(Q,Q) = |P| in G(Q,Q) with the total increase of |P| - codd(P,Q) = 2  ·  d3(P,Q). By Lemma [\ref=Le0], Δrcodd  ≤  2 for every r∈t and thus

[formula]

implying that |t| = d3(P,Q) (i.e., t is a shortest transformation) if and only if Δrcodd = 2 for every r∈t.

Now let t be a shortest transformation and thus Δrcodd = 2 for every r∈t. For a 2-break r to have Δrcodd = 2, it must be applied to an even black-gray cycle and split it into two odd black-gray cycles. Thus any such r also decreases the number of even black-gray cycles by 1, i.e., Δrceven =  - 1.

If a complete 3-break r has Δrcodd = 2, then Δrceven  =  Δrc  -  Δrcodd  ≤  2 - 2 = 0. By Lemma [\ref=Le0], we also have Δrceven  ≥   - 2 and Δrceven  ≠   - 1, implying that Δrceven = 0 or - 2.

By the definition, any optimal transformation is necessarily shortest. However, not every shortest transformation is optimal. The following theorem characterizes optimal transformations within the shortest transformations:

A shortest transformation t between two genomes is optimal if and only if for any r∈t, Δrceven  ≠   - 2.

Let t be a shortest transformation t between two genomes. By Lemma [\ref=Le1], n3(t) = u + v where u is the number of complete 3-breaks with Δrceven = 0 and v is the number of complete 3-breaks with Δrceven =  - 2 (Fig. [\ref=Forbid2]).

With n2(t) 2-breaks and n3(t) = u + v complete 3-breaks G(P,Q) is transformed into G(Q,Q) with |P| = |Q| trivial black-gray cycles, which are all odd. By Lemma [\ref=Le1], for the increase in the number of odd and even black-gray cycles in the breakpoint graph, we have:

[formula]

implying that

[formula]

which is minimal if and only if v = 0, i.e., Δrceven  ≠   - 2 for any r∈t.

Lemma [\ref=Le1] and Theorem [\ref=Th0] imply:

A transformation t between two genomes is optimal if and only if for any r∈t,

if n3(r) = 0, then Δrcodd = 2 and Δrceven =  - 1;

if n3(r) = 1, then Δrcodd = 2 and Δrceven = 0.

A transformation t between genomes P and Q is optimal if and only if

[formula]

Let t be an optimal transformation between genomes P and Q. Then with n2(t) 2-breaks and n3(t) complete 3-breaks, it transforms G(P,Q) into G(Q,Q) with |P| = |Q| trivial black-gray cycles, which are all odd. By Corollary [\ref=Cor0], we have

[formula]

implying formulae [\eqref=n23opt].

Vice versa, a transformation t between genomes P and Q, satisfying [\eqref=n23opt], has the length [formula], implying that t is a shortest transformation. By Lemma [\ref=Le1], Δrceven  =   - 1 for every 2-break r∈t and Δrceven  =  0 or - 2 for every complete 3-break r∈t. Let v be the number of complete 3-breaks r∈t with Δrceven  =   - 2. Then the increase in the number of even black-gray cycles along t is

[formula]

implying that v = 0 and thus t is optimal by Theorem [\ref=Th0].

Theorem [\ref=Th1] implies that for some genomes, every optimal transformation consists entirely of complete 3-breaks:

For genomes P and Q with ceven(P,Q) = 0, every optimal transformation t has n2(t) = 0 and thus consists entirely of complete 3-breaks.

For an optimal transformation t between genomes P and Q,

[formula]

Weighted multi-break distance

Let T(P,Q) be the set of all transformations between genomes P and Q. For a real number α, we define the weighted distance Dα(P,Q) between genomes P and Q as

[formula]

that is, the minimum possible weight of a transformation between P and Q.

Two important examples of the weighted distance are the "unweighted" distance D1(P,Q) = d3(P,Q) and the distance [formula] equal the half of the minimum number of breakages in a transformation between genomes P and Q. By the definition of an optimal transformation, we have [formula], where t0 is an optimal transformation between genomes P and Q. Below we prove that Dα(P,Q)  =  Wα(t0) for any α∈(1,2].

For α∈(1,2],

[formula]

where t0 is any optimal transformation between genomes P and Q.

Furthermore, for α∈(1,2), if Dα(P,Q)  =  Wα(t) for a transformation t between genomes P and Q, then t is an optimal transformation.

Let t be any transformation and t0 be any optimal transformation between genomes P and Q.

We classify all possible changes in the number of even and odd black-gray cycles resulted from a single rearrangement r. By Lemma [\ref=Le0], Δrcodd may take only values - 2,0,2, while |Δrc|  =  |Δrcodd  +  Δrceven|  ≤  1 (if r is a 2-break) or ≤  2 (if r is a complete 3-break). The table below lists the possible values of Δrcodd and Δrceven, satisfying these restrictions, along with the amount of rearrangements of each particular type in t, denoted xi for 2-breaks and yj for complete 3-breaks.

For the transformation t, we have

[formula]

Calculating the total increase in the number of odd and even black-gray cycles along t, we have

[formula]

Theorem [\ref=Th1] further implies

[formula]

Now we can evaluate the difference between the weights of t and t0 as follows:

[formula]

Since α∈(1,2] and xi,yj  ≥  0, all summands in the last expression are nonnegative and thus Wα(t) - Wα(t0)  ≥  0. Since t is an arbitrary transformation, we have

[formula]

For α∈(1,2), if Dα(P,Q)  =  Wα(t) then Wα(t)  -  Wα(t0)  =  0, implying that only x5 and y6 (appearing with zero coefficients in the expression for Wα(t)  -  Wα(t0)) can be nonzero and thus t is optimal by Corollary [\ref=Cor0].

Discussion

We proved that for α∈(1,2], the minimum-weight transformations include the optimal transformations (Theorem [\ref=Th2]) that may entirely consist of transposition-like operations (modelled as complete 3-breaks) (Corollary [\ref=Cor1]). Therefore, the corresponding weighted genomic distance does not actually impose any bound on the proportion of transpositions.

For α∈(1,2), we proved even a stronger result that the minimum-weight transformations coincide with the optimal transformations (Theorem [\ref=Th2]). As a consequence we have that a particular choice of α∈(1,2) imposes no restrictions for the minimum-weight transformations as compared to other values of α from this interval. The value [formula] then proves that the optimal transformations coincide with those that at the same time have the shortest length and make the smallest number of breakages, studied by Alekseyev and Pevzner [\cite=Alekseyev2007]. We further characterized the optimal transformations within the shortest transformations (i.e., the minimum-weight transformations for α = 1) by showing that the optimal transformations avoid one particular type of rearrangements (Theorem [\ref=Th0], Fig. [\ref=Forbid2]).

It is worth to mention that the weighted genomic distance with α  ≥  2 is useless, since it allows (for α = 2) or even promotes (for α > 2) replacement of every complete 3-break with two equivalent 2-breaks, thus eliminating complete 3-breaks at all.

The extension of our results to the case of linear genomes will be published elsewhere.