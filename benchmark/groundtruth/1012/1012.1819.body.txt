Corollary Lemma Remark Claim Proposition Definition

On the Lipschitz constant of the RSK correspondence

Nathan Linial

Introduction

The Robinson-Schensted-Knuth (RSK) correspondence [\cite=Rob] [\cite=Sch] [\cite=Knu] maps an arbitrary permutation π∈Sn bijectively to an ordered pair of Young tableaux of the same shape λ  =  λ(π). How much can λ(π) change as we mildly vary π? For example, if we left-multiply π by t transpositions, to what extent can λ change? We begin with the case when t = 1 and show that the resulting Young diagram can differ from λ on at most [formula] cells. We show that this bound is tight by giving explicit constructions of permutations π for which this bound is attained where the diagrams differ in at least [formula] cells. We then turn to consider the same question for larger t and show that the corresponding diagram changes in at most [formula] cells. The best constructions we know nearly match this bound and yield, e.g., [formula] changes for t = o(n).

The outline of this paper is as follows. In the remainder of this section we recall some definitions and properties of Young tableaux and the RSK correspondence. In Section [\ref=sec:t=1] we prove upper bounds on the Lipschitz constant when t = 1 and show a matching construction. In Section [\ref=sec:upper-bounds-general-t] we give upper bounds and extend our constructions for the case of general t. We conclude with some directions for further research in Section [\ref=sec:conclusions].

Notation and Preliminaries

We recall some definitions and background on Young Tableaux and the RSK algorithm here. For more detailed expositions refer to [\cite=Ful] [\cite=Mac] or [\cite=Sta].

Let [formula] be a positive integer. A vector [formula] of positive integers is a partition of n (denoted by [formula]) if

[formula]

The Young diagram (or diagram) of a partition λ is a left-justified array of cells with λi cells in the i-th row for each i  ≥  1. For example, the diagram of the partition (5,5,3,2) is

[formula]

The cell in the i-th row and j-th column is referenced by its coordinate (i,j). Thus (1,1) is the top leftmost cell of the diagram.

The conjugate of a partition λ, denoted by λ' is the partition whose diagram is the transpose of the diagram of λ.

A standard Young tableau (SYT or tableau) of size n with entries from

[formula]

in such a way that the entries are strictly increasing from left to right along a row as well as from top to bottom down a column. The shape of a tableau T, denoted sh(T) is the partition corresponding to the diagram of T. For example,

[formula]

is a tableau of size 7 of shape (4,2,1). Note that the elements in the cells of a SYT are distinct integers. Let Tn denote the set of SYT of size n.

The Robinson-Schensted-Knuth (RSK) Correspondence

The RSK correspondence discovered by Robinson [\cite=Rob], Schensted [\cite=Sch] and further extended by Knuth [\cite=Knu] is a bijection between the set of permutations Sn and pairs of tableau of size n of the same shape. This bijection is intimately related to the representation theory of the symmetric group [\cite=Jam] [\cite=Dia], the theory of symmetric functions [\cite=Sta], and the theory of partitions [\cite=And].

The bijection can be defined through a row-insertion algorithm first defined by Schensted [\cite=Sch] in order to study the longest increasing subsequence of a permutation. Suppose that we have a tableau T. The row-insertion procedure below inserts a positive integer x that is distinct from all entries of T, into T and results in a tableau denoted by T←x.

Let y smallest number larger than x in the first row of T. Replace the cell containing y with x. If there is no such y, add a cell containing x to the end of the row.

If y was removed from the first row, attempt to insert it into the next row by the same procedure as above. If there is no row to add y to, create a new row with a cell containing y.

Repeat this procedure on successive rows until either a number is added to the end of a row or added in a new row at the bottom.

The RSK correspondence from Sn to {(P,Q)∈Tn  ×  Tn : sh(P) = sh(Q)} can now be defined as follows. Let π∈Sn and let πi denote the element of

[formula]

Motivation and Related Work

In view of the important role of the RSK correspondence, it is natural to investigate various aspects of it. Thus Fomin's appendix in [\cite=Sta] starts with the following two motivating questions:

Given a partition λ, characterize those permutations π for which λ(π) = λ.

Given a tableau P, characterize the permutations π which have P as their insertion tableau.

We consider an approximate version of such questions and ask to what extent λ changes as π changes slightly. Question (1) is answered by the following theorem of Greene.

Let π be a permutation, and suppose that the largest cardinality of the union of j increasing subsequences in π is μj, then [formula], where λ1  =  μ1 and λj  =  μj  -  μj - 1 for all j  ≥  2.

In his study of the RSK correspondence, Knuth discovered certain equivalence relations that are key to the solution of Question (2) above. Two permutations are Knuth equivalent if one can be obtained from the other by certain restricted sequences of adjacent transpositions. Knuth equivalent permutations are the equivalency classes of permutations that have the same insertion tableau. For more on the subject, see [\cite=Sta].

In order to make our question concrete, we need to specify two measures of distance: One between permutations and the other between diagrams. A natural metric on permutations is left-multiplication by adjacent transpositions. An adjacent transposition is a permutation of the form (i,i + 1). Left-multiplying π by an adjacent transposition is denoted by [formula] and means that first, the permutation π is applied and then the transposition. We denote the least number of adjacent transpositions that transform the permutation π to τ by d(π,τ). Recall that d(  ·  ,  ·  ) is the graph metric in the Cayley graph of Sn w.r.t. the generating set of adjacent transpositions [formula]. We will say that two permutations π and τ are at distance t if d(π,τ) = t. If λ and μ are two diagrams, define their distance to be

[formula]

Let π and τ be any two permutations. We are interested in the Lipschitz constant of this mapping, i.e.,

[formula]

where the maximum is over all π,τ∈Sn with d(π,τ) = t.

The choice of left-multiplication above is in fact without loss of generality. By Proposition [\ref=prop:inverse_RSK] the shape of a permutation and its inverse under the RSK correspondence are the same. Our results thus all follow immediately for right-multiplication since [formula] is equivalent to [formula].

In general, although d and Δ are natural metrics to study for permutations and diagrams respectively, the same question can be asked for other metrics. We discuss the extension of our results to other metrics on permutations in Section [\ref=sec:conclusions].

Exact Bounds on the Lipschitz Constant for a Single Transposition.

In this section we will show upper bounds on the Lipschitz constant when the number of transpositions t = 1. We also give a construction of a family of permutations which achieve this bound asymptotically.

Upper Bounds

The first step of the proof is to show that left-multiplying a permutation by a transposition can result in only a bounded number of cells being different in each row of the diagram.

Let π,τ∈Sn and let λ,μ be the respective diagrams. Suppose that [formula], and πi  <  πi + 1. Then,

[formula]

Suppose that the largest cardinality of the union of j increasing subsequences in π is [formula]. Suppose there is a subsequence which includes the pair that is being transposed in π. By deleting one of the elements of the pair we obtain a set of j increasing subsequences of τ whose cardinality is at least [formula]. If there is no such subsequence, then the same j subsequences are also increasing in τ. By Greene's Theorem [\ref=thm:Greene] this implies [formula]

For the lower bound, consider the largest cardinality of the union of j increasing sequences in τ. No subsequence in this union can contain both of the elements involved in the transposition. Since the pair involved in the transposition have no other elements between them in both π and τ the subsequences are also increasing in π. We conclude in the same way that [formula]

Figure [\ref=fig:tableaux-t1] will be useful in the following discussion. It depicts the union of two diagrams λ and μ, which is also a Young diagram. The symmetric difference consists of the cells marked by a dot. The remaining set of cells of the diagram labeled W is the intersection of λ and μ and this is a Young diagram as well.

Let π,τ∈Sn where d(π,τ) = 1 and let λ,μ be the corresponding diagrams. Then at most one cell in each row and each column of the union of λ and μ can be in the symmetric difference.

To see this for a row r, consider inequality [\eqref=eq:running-sum-t1] for j = r and for j = r - 1 and take their difference. A similar argument applied to the reversed permutations implies the claim for columns. (see Proposition [\ref=prop:reverse_conjugate]).

Let π and τ be permutations in Sn with respective Young diagrams λ and μ, and suppose that d(π,τ) = 1. Then

[formula]

As shown in Figure [\ref=fig:tableaux-t1], let (i,j) and (i',j') be the coordinates of two distinct cells in the symmetric difference. By Corollary [\ref=cor:one-cell-different], i  ≠  i' and j  ≠  j', and ( min (i,i'), min (j.j'))∈W. This gives a 1:1 map from unordered pairs of cells in the symmetric difference into W. Therefore,

[formula]

implying the required bound

[formula]

Construction

In this section we construct pairs of permutations in Sn which differ by a single transposition whose corresponding Young diagrams differ by at least [formula] cells, matching the upper bound in Theorem [\ref=thm:upperbound-easy] asymptotically. The following lemma characterizes the shape of a permutation by the cardinalities of increasing and decreasing subsequences.

Let π∈Sn be a permutation whose elements can be decomposed in the following two ways: (i) into increasing subsequences of cardinalities [formula], and (ii) into decreasing subsequences of cardinalities [formula], where the partitions λ and λ' are conjugate. Then λ  =  λ(π).

By Greene's Theorem [\ref=thm:Greene] it suffices to show that for each r, the largest cardinality of the union of r increasing sequences in π is [formula]. By assumption we know it is at least this number and we need to show the opposite inequality. Namely, that if [formula] is a collection of disjoint increasing sequences in π, [formula].

By assumption, there is a decomposition [formula] of π into disjoint decreasing subsequences of cardinalities [formula]. But each si and dj can have at most one element in common, so that

[formula]

where the last equality follows because the partitions [formula] and [formula] are conjugate.

For every n there are permutations π,τ∈Sn with d(π,τ) = 1 and respective shapes λ,μ such that [formula].

Our proof says, in fact, a little more than what is stated. Namely for n = (k + 1)2 / 2 with k an odd integer, we will construct two permutations π and τ of shapes [formula] and [formula] which differ by exactly one cell in each row and column, giving [formula]. Thus it can be verified that together with Theorem [\ref=thm:upperbound-t=1] this gives a complete answer to our question for n of this form. For other values of n we get the result by padding this basic construction. In the discussion that follows we decompose these permutations into monotone subsequences. The decompositions we exhibit are not necessarily unique, but for our purpose any decomposition suffices.

The construction can, perhaps, be best understood by observing alongside with the general discussion a concrete special case. So we intersperse our general constructions with an illustration that shows how things work for n = 18 (k = 5). We start by dividing the elements of

[formula]

. The next k + 1 elements, i.e., interval

[formula]

are "big".

We further subdivide the big elements (in order) into blocks [formula]. The small elements are split (in order) into blocks [formula]. Both si and bi have cardinality 2i.

[formula]

The permutation π is constructed by spreading out the intermediate elements with n / 2 and n / 2 + 1 remaining fixed points (see below). The blocks of big elements are then inserted in the order [formula] in the spaces between the smaller intermediate elements while the blocks of small elements are inserted in the order [formula] in the spaces between the larger intermediate elements. To obtain τ we apply the transposition (n / 2,n / 2 + 1) to π. The permutations are defined in this manner with a view to decomposing them into increasing and decreasing sequences of desired cardinalities.

[formula]

From the construction we claim that π and τ can be decomposed into a disjoint union of increasing subsequences of cardinalities [formula] and [formula] respectively. For π the increasing sequences consist of (i) The intermediate elements, which in our example is 7,8,9,10,11,12, (ii) The blocks of small elements, i.e., 1,2,3,4 and 5,6 and (iii) The blocks of big elements, i.e., 15,16,17,18 and 13,14.

The permutation τ can be decomposed into the increasing subsequences of the following three types: (i) An intermediate element and the block of big elements following it, which in the example are 7,15,16,17,18 and 8,13,14, (ii) A block of small elements and the following intermediate element, i.e., 5,6,11 and 1,2,3,4,12 and (iii) The two subsequences of length one consisting of one of the two middle intermediate elements, i.e. 10 and 9.

The proof that π and τ have the shapes [formula] and [formula] respectively uses Lemma [\ref=lem:decreasing-witness]. It is enough to decompose π and τ into a union of decreasing sequences whose cardinalities are given by the respective conjugate sequences. Note that as it happens, the shapes λ and μ are conjugates.

We assign the elements of π to decreasing subsequences [formula] of cardinalities [formula]. as follows. Since the di are subsequences, elements in them appear in the same order as in the permutation. Secondly, the assignment is made so that each subsequence has exactly one of the intermediate elements, and it appears after any of the big elements and before any of the small elements. (There is more than one way to do this.) We first see how this is done in the example.

We first construct d1 and d2 which are both decreasing sequences of length 5. The largest elements in the blocks bi, the largest elements in the blocks si and one of the middle intermediate elements are assigned to d1. Then we choose d2 similarly from among the remaining elements.

[formula]

The remaining elements can be seen to have the same structure recursively (the remaining elements appear in the same relative order as would the elements of the permutation for n = 8), where the brackets indicate blocks of big and small elements as before.

[formula]

To assign elements to d3 and d4, we want to continue with the strategy of choosing the largest elements that remain in the blocks. Note that since the big elements 13 and 14 have been assigned, there are no big elements that follow the element 8, and it now becomes "available". Thus d3 and d4 are constructed by assigning the largest elements that remain in the small and big blocks and one of the remaining intermediate elements in the middle of the blocks.

[formula]

Proceeding the same way, we obtain the subsequences: d1 = 18,14,9,6,4, d2 = 17,13,10,5,3, d3 = 16,8,2, d4 = 15,11,1, d5 = 7, d6 = 12. In general, the assignment is done as follows.

The i-th largest element in each block of big elements, is assigned to the subsequence di.

The i-th largest element in each block of small elements, is assigned to the subsequence di.

For the intermediate elements, assign the lower (k + 1) / 2 elements to the subsequences [formula] (in that order) and the top (k + 1) / 2 elements to [formula] (in that order).

Clearly, this is a decomposition of

[formula]

We have carried out computer simulations and found other pairs of permutations for which the bound holds with equality. Several mysteries remain here, a few of which we mention in Section [\ref=sec:conclusions].

Bounds on the Lipschitz Constant for t > 1

In this section we show bounds on the Lipschitz constant for t > 1. Extending the arguments from the previous section for both the upper and lower bound gives bounds that are tight up to constant factors for t = O(1). In the latter half of this section we give a more complicated argument that yields an improved upper bound for general t.

A construction for permutations at linear distance t.

The construction for the case of one transposition can be extended to the case of more than one transposition as follows.

Let t  ≤  n / 2. For every n there are permutations π,τ∈Sn with d(π,τ) = t and respective shapes λ,μ such that [formula].

Let [formula], and m = (k + 1)2 / 2 so that mt  ≤  n. Divide the first mt elements of

[formula]

Upper Bounds

We start with an easy observation:

Let π and τ be permutations in Sn such that d(π,τ) = t. Let λ and μ be the respective Young diagrams. Then

[formula]

Since d(π,τ) = t, there is a sequence of permutations [formula] such that for each 0  ≤  i  <  t, σi and σi + 1 differ by an adjacent transposition. The distance Δ(  ·  ,  ·  ) is a metric on diagrams and hence the bound follows by the triangle inequality from Theorem [\ref=thm:upperbound-t=1].

We do not see how to appropriately adapt the bijective argument of Theorem [\ref=thm:upperbound-t=1]. However, the following argument yields a near-optimal bound.

Let π,τ∈Sn be such that d(π,τ) = t. Let λ,μ be the corresponding diagrams. Then

[formula]

We start by showing some preliminary results that will be useful in the proof. Suppose π and τ are two permutations such that d(π,τ) = t. Let [formula] be a sequence of permutations such that for each 0  ≤  i  <  t, σi and σi + 1 differ by an adjacent transposition. Say that s (resp. r) of the transpositions put the relevant pair in decreasing (resp. increasing) order, where t = r + s. Let λ and μ be the diagrams corresponding to π and τ respectively.

Let π,τ be as above. Then,

[formula]

For each pair σi,σi + 1 in the sequence of permutations [formula], by Proposition [\ref=prop:running-sum-t1] the inequality [\eqref=eq:running-sum-t1] holds for the diagrams corresponding to σi and σi + 1. The result is obtained by adding up all these inequalities.

In Figure [\ref=fig:tableaux-blocks] we depict the union of two diagrams. Their intersection is labeled W as before. We split the symmetric difference of the two diagrams into blocks. We say that j indexes a λ-row if λj  >  μj. A maximal interval of λ-rows determines a λ-pre-block. A maximal collection of consecutive λ-pre-blocks constitutes a λ-block. We likewise define μ-blocks. Blocks are labeled Bi as in the figure. The number of cells in a set S will be denoted by A(S). We use the following fact about the sizes of the blocks.

Let d(π,τ) = t with corresponding diagrams λ, μ and let B be a block in the union of the diagrams, then A(B)  ≤  t.

This bound is obtained from Lemma [\ref=lem:running-sum] as follows. Let B reside in the set of rows I of the diagram. Assuming it exists, let i0 be the row just preceding I, and i1  =   max I. Then the bound is obtained by subtracting the inequality [\eqref=eq:running-sum] corresponding to j = i0 from the inequality corresponding to j = i1, and using the fact that r + s = t. If there is no row i0, then the bound is immediate from the inequality for j = i1.

The main step in the proof of Theorem [\ref=thm:t-3/4] is the following lemma about two sequences of integers.

Let k  ≥  2, T  ≥  3 and let [formula] and [formula] be two sequences of positive integers. Denote [formula] and [formula] If

[formula]

then

[formula]

This bound is tight up to constants.

We first show how to derive the theorem from Lemma [\ref=lem:int-seq].

Let λ and μ be two diagrams of size n (not necessarily corresponding to permutations at distance t). For the union of these diagrams, define the blocks of the symmetric difference {Bi} and W as before. Suppose that for each block B, A(B)  ≤  t. To prove Theorem [\ref=thm:t-3/4], it is sufficient to show that for these diagrams,

[formula]

With this formulation in mind, we can make the following assumptions about the pair of diagrams. The aim is to make a number of transformations and show that the pair of diagrams can be assumed to be of the form shown in Figure [\ref=fig:diagrams-with-blocks-final].

This transformation decreases A(W) and keeps the size of the block fixed. Secondly, we may assume that the transformation is done so that all rows of a block, with the possible exception of the last one have the same length. The result of such a transformation on the blocks B2 and B3 is shown in Figure [\ref=fig:blocks-top-left-fixed].

Thus, we may assume that the diagrams are as shown in Figure [\ref=fig:diagrams-with-blocks-final] and that the sizes of the blocks are bounded by t. As in the figure, let ai and bi denote the lengths of the vertical and horizontal sides of the rectangle which bounds the block Bi. Thus the area A(W) can be written as a sum of areas of rectangles aibj whose sides are determined by the side lengths of pairs of blocks. Also note that by our construction of the blocks, aibi  ≤  2t.

To obtain the formulation of the lemma, suppose that we add cells to the last row of each block to complete it to a rectangle. Denote the modified blocks by B'. Then for each block, A(B')  ≤  2A(B). If we show the bound for these modified diagrams with a bound of 2t for each block, then the bound is implied for the original diagrams since the constants can be absorbed by the O(  ·  ). Formally, this follows from the following inequalities.

[formula]

[formula]

Thus Lemma [\ref=lem:int-seq] implies the bound [\eqref=eq:bound-on-diagrams] for a pair of diagrams as above and we have verified that to prove Theorem [\ref=thm:t-3/4] it is sufficient to prove the lemma.

Proof of Lemma [\ref=lem:int-seq]: We will minimize N / Δ2. For k = 2, the lemma can be easily verified by calculation once we use the fact that a1 = b2 = 1. Thus we will assume that k  ≥  3. Consider the following relaxation of the minimization problem where the ai,bj are not necessarily integral.

[formula]

We will use the method of Lagrange multipliers (see Appendix [\ref=app:lagrange] for a brief introduction) to obtain a lower bound on the value of the objective above at any local optimum. Since the problem is a relaxation of the discrete minimization problem, this also lower bounds the objective of the discrete problem. We obtain the following Lagrangian for the relaxation above.

[formula]

The Karush-Kuhn-Tucker conditions yield the following necessary conditions for minimality.

[formula]

From these conditions, we can show that at optimality either aibi = T or 1. Suppose that for some i, aibi < T. Note that by the conditions above, this implies λi = 0. Now, if aibi  ≠  1, at least one of ai or bi is > 1. Assume without loss of generality that bi > 1 (the argument in the other case is exactly the same). In this case νi = 0 by [\eqref=eq:Lagrange-zeros] . Hence from [\eqref=eq:del-b] above, we have

[formula]

and therefore, since Δ > 0

[formula]

Now we show that it is possible to increase bi by a factor (1 + ε) for ε > 0 so that N / Δ2 decreases and we can conclude that the solution is not optimal. This is allowed, at least for ε > 0 small enough, since, by assumption aibi  <  T. Let N' and Δ' be the summations as defined before for the sequences where we replace bi by bi(1 + ε).

[formula]

To prove the claim N' / (Δ')2  <  N / Δ2, using the right hand side above, it is enough to show that

[formula]

Or equivalently, dividing throughout by 2aibiεΔ2, that

[formula]

This inequality follows by [\eqref=eq:optimality-N-Delta]. The left-hand term equals the first term on the right and ε > 0.

The next step is to argue that it is enough to show the claimed bound assuming that the blocks are arranged in a specific manner (i.e., the sequences are of a certain form). In particular, the blocks of area T are arranged such that ai is increasing and bi is decreasing. Secondly, the blocks of area 1 occur after all blocks such that ai  ≤  bi and before all blocks such that ai  >  bi. This can be argued by noticing that such an arrangement can be achieved by exchanging blocks which are out of order since Δ remains unchanged and N does not increase. Thus a lower bound on N / Δ2 for the modified sequence is a lower bound on the corresponding quantity for the original sequence.

We next argue that, in fact, w.l.o.g. no block has area 1. Recall that we wish to show

[formula]

We will show that if we add a single block of area 1 then

[formula]

where N' and Δ' are the modified values of N and Δ. This inequality above allows us to reduce the argument to the case when there are no blocks of area 1. Let the shorter sequence have k terms. Note that Δ' = Δ + 1 and the change in the number of cells N'  -  N is at least [formula].

Recall that k,T  ≥  3 and for 1  ≤  i  ≤  k, ai,bi  ≥  1. Thus,

[formula]

which implies the required inequality [\eqref=eq:no-1-blocks].

In the next step, we will make a further simplification to the picture. To summarize, we now know that we may optimize over sequences such that each block has size T, a1 = bk = 1, the sequence ai is non-decreasing and bi is non-increasing. The claim is that the optimal solution is of the form where there is some i such that ai > 1 and bi > 1. If not, then it can be checked that [formula] and the claimed bound holds.

We relabel the sequences [formula] and [formula] where [formula] and k  ≥  0 so that ai,bi > 1 for 1  ≤  i  ≤  k. Let N and Δ be the corresponding summations as defined before. We can reformulate the minimization problem as follows.

[formula]

Solving this optimization problem gives the following conditions for the solutions (see Proposition [\ref=prop:geometric] in the Appendix [\ref=sec:minimization] for the detailed calculations). The sequences b1   ≤   i   ≤   k and (hence a1   ≤   i   ≤   k) are a geometric series with

[formula]

and

[formula]

and the ratio between successive terms c > 1. Also,

[formula]

and

[formula]

Substituting, we also have that

[formula]

Since bk,a1  >  1 we have

[formula]

Furthermore, ck - 1  <  T and therefore

[formula]

In the next step we will show the w.l.o.g. we may assume [formula]. Let [formula] and [formula]. These are the values of the summations with the first [formula] and last [formula] members of the sequences removed. Then

[formula]

We have above that [formula]. We will show that the optimal of 32T ln TN  -  Δ2 when N0 and Δ0 are fixed is at [formula] by showing

[formula]

Wlog, suppose that [formula] so that [formula]. Therefore by [\eqref=eq:k-upper-bound] and using the fact that for x  ≤  1 / 2, ln (1 + x)  ≥  x / 2, we have

[formula]

Now, we have

[formula]

On the other hand, by the bound from [\eqref=eq:k-upper-lnT] on k,

[formula]

as required. Finally, if [formula], then using the fact that b1  ≤  T, from [\eqref=eq:T-and-b1], we obtain that c > 2. Hence by [\eqref=eq:k-upper-lnT] k < 2 ln T + 1. Note that if [formula], Δ  =  (k + 2)T. We can then use the following straightforward bound.

[formula]

Theorem [\ref=thm:t-3/4] now follows.

As we show next, the upper bound of Lemma [\ref=lem:int-seq] is tight. To construct a pair of diagrams where the ai and bi are integers and [formula] we argue as follows. Let T = 2k, c = 2, b1 = 1 and bk = T. Then Δ is at least [formula]. However, the tightness of Theorem [\ref=thm:t-3/4] does not follow from this since it is not clear that there exist corresponding permutations.

Conclusions

A number of interesting directions remain for further research.

Characterize extremal permutations. The permutations constructed in Section [\ref=sec:t=1] achieve the maximum difference in the shapes for one transposition. There it was possible to construct the examples by carefully arranging the increasing and decreasing sequences. On the other hand, with the help of a computer, we observed several other examples whose structure we do not completely understand. We know that for Δ to achieve the upper bound, by Greene's Theorem, the permutations must be decomposable into unions of increasing sequences whose sizes are given by the required shape of the diagram. An example of such a pair of permutations from simulation for n = 18 is:

[formula]

Notice that in this example the permutations cannot be decomposed into conjugate increasing and decreasing sequences as done in our construction. In our view the class of such permutations is an intriguing mathematical object. We would like to know how many such permutations exist, what their structural properties are etc. This seems like a good subject for further work in this area.

Constructions for t > 1 transpositions. As mentioned, we do not know whether there exists a pair of permutations corresponding to the diagrams which are tight for Lemma [\ref=lem:int-seq]. We do not see how to extend our construction for one transposition to this case.

Secondly, our constructions achieve [formula] differences when t  ≤  n / 2. The behavior for larger t is still unclear. For example, the maximum possible value of Δ is n - 1, and this is uniquely achieved with [formula] transpositions. We also know from Theorem [\ref=thm:construction:t>1] that we can make Δ  ≥  Ω(n) with t  ≤  O(n). We still do not know how large t should be to make Δ  ≥  αn with α close to 1.

Dependence on transpositions. It would be interesting to obtain more detailed information about the change in Δ as a result of left-multiplication with a transposition. Knuth and Knuth-dual equivalence classes characterize transpositions which keep Δ fixed. What is the expected change in Δ for a transposition in a random permutation? How do the position of the transposition or properties of the permutation affect the change?

Other metrics. In this work we studied the adjacent transposition metric on permutations but there are a number of natural measures for the distance between two permutations which may be worth studying in this setting.

For example it can be verified that up to constants, the same bounds on the Lipschitz constant hold for the distance d' on permutations with respect to general (not necessarily adjacent) transpositions. The lower bounds from Theorems [\ref=thm:lower-bound-one-transp] and [\ref=thm:construction:t>1] hold since the constructions give permutations π and τ which differ by 1 and t transpositions respectively. On the other hand, the upper bounds on the Lipschitz constant follow (and are within a constant factor of the bounds for adjacent transpositions) since by Greene's Theorem the bounds in Proposition [\ref=prop:running-sum-t1] change only by a small additive constant and in Lemma [\ref=lem:running-sum] this translates to the absolute value of the difference between the sums being bounded by 2t if the permutations differ by the multiplication of t transpositions.

The Method of Lagrange Multipliers

The method of Lagrange multipliers is used to solve for the maxima or minima of a real-valued multivariate function subject to equality constraints. In particular, the method gives necessary conditions for optimality which are the analog of the conditions on the gradient for unconstrained problems. The Karush-Kuhn-Tucker (KKT) conditions for optimality generalize these to the case when some of the constraints may be inequalities. Consider the following optimization problem, where [formula] and [formula]:

[formula]

The Lagrangian for this problem is defined to be the function:

[formula]

The KKT conditions say that if a local optimizer [formula] satisfies certain technical "constraint qualifications" (explained below) then there are constants λ*j ([formula]) and μ*k ([formula]) satisfying

[formula]

A number of constraint qualifications are known to be sufficient for the result and in our case, the so-called Mangasarian-Fromovitz constraint qualification holds. This condition requires that at [formula], the gradients of any active inequality constraints and the gradients of the equality constraints are positively-linearly independent. A collection of vectors [formula] is positively-linearly dependent if there are [formula], not all 0 such that [formula]. for the optimization problems we consider, the constraint qualification can be verified without much difficulty for any possible set of active constraints, so we leave this to the reader and assume that the KKT conditions are satisfied. For more details regarding the method of Lagrange multipliers and extensions, the reader may refer to [\cite=Ber].

Solution to the Minimization Problem

We show below the calculations that solve the minimization problem in [\eqref=eq:min-ab-is-T] which is reproduced below.

[formula]

At a minimum of the optimization, the sequences b1   ≤   i   ≤   k and (hence a1   ≤   i   ≤   k) are a geometric series with

[formula]

and

[formula]

and the ratio between successive terms c > 1. Also,

[formula]

and

[formula]

We obtain the following Lagrangian.

[formula]

From the KKT conditions for optimality, we obtain:

[formula]

As outlined before, we may assume that the optimal solution is such that ai,bi > 1 for 1  ≤  i  ≤  k. Hence by the conditions above, μi  =  νi = 0. Performing the differentiations in [\eqref=eq:simp-del-a] (w.r.t. ai) and [\eqref=eq:simp-del-b] (w.r.t. bi) and multiplying them by ai and bi respectively we obtain the following relations.

[formula]

[formula]

Equating [\eqref=eq:Lagrange-equality-1] and [\eqref=eq:Lagrange-equality-2] and cancelling terms, we conclude that since Δ  ≠  0,

[formula]

We can solve the above set of relations as follows. Dividing [\eqref=eq:general-equality] by ai and using the equations corresponding to i and i + 1 there, and that aibi = T, after rearranging terms we obtain the following relations:

[formula]

Subtracting we obtain

[formula]

Rearranging,

[formula]

Let

[formula]

so that

[formula]

Rearranging [\eqref=eq:b-recurrence] and manipulating both sides, we have

[formula]

In other words, we can conclude that b1   ≤   i   ≤   k (and hence a1   ≤   i   ≤   k) is a geometric series. Let

[formula]

and

[formula]

It can be checked that c  >  1 since for c = 1 [\eqref=eq:b-recurrence] is not satisfied.

Next, suppose we multiply the equation [\eqref=eq:general-equality] by c - 1, we obtain

[formula]

Since the right hand side of the last equality is the same for all 1  ≤  i  ≤  k, from i = 1 and i = k, we obtain

[formula]

Now since c > 1, [formula] and therefore

[formula]

By similar arguments,

[formula]