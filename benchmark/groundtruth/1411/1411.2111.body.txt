Cascading of Fluctuations in Interdependent Energy Infrastructures: Gas-Grid Coupling

The ongoing evolution to intermittent wind and solar electric generation is causing many electrical grid operators to use more agile natural gas-fired electric generation to balance these new stochastic resources. This interdependence causes a cascade of the fluctuations of renewable generation into the systems that supply fuel to the gas-fired generators, i.e. natural gas pipelines. We develop a model of the coupling between electrical grid fluctuations and natural gas pipeline systems, analyze the resulting fluctuations of pipeline pressure, and draw conclusions about the impact of renewable electrical generation on the stability and security of natural gas pipelines.

Introduction

By making unconventional natural gas sources economic to extract, hydrofracking has created a revolution in the U.S. natural gas industry [\cite=fracking]. Many of these new gas sources are in nontraditional locations such as the Marcellus shale in Pennsylvania, the Niobrara shale in Eastern Colorado, and the Bakken shale in North Dakota. See Fig. [\ref=fig:gas_pipes]. The dramatic increase in supply has driven down prices and spurred many new or expanded uses for natural gas [\cite=2010MITEI] [\cite=2013MITEI]. This revolution in the natural gas supply and loads is creating new challenges for natural gas pipelines that transport the gas from source to load. With a limited amount of throughput and short-term gas storage (in the form of pressure in pipeline itself), these pipelines may become vulnerable as their operating environment changes.

A dominant new load on the gas pipelines is natural gas-fired generators. Previously, the marginal cost of electricity from these generators was higher than from coal-fired generators. However, the rapid drop in gas prices has made gas generation competitive with coal and spurred its construction. An example of this dramatic expansion is in the electrical grid controlled by the Independent System Operator of New England (ISO-NE) where natural gas-fired electrical generation increased from 5% of total capacity to 51% in a span of 20 years [\cite=ISO-NE]. A parallel development in many U.S. electrical grids is the expansion of intermittent renewable generation such as wind and PhotoVoltaic (PV) generation--a trend that is expected to continue as utilities work to meet state-imposed renewable portfolio standards that mandate a certain fraction of electrical generation be derived from renewable sources. See Fig. [\ref=fig:power_transmission]. In contrast to traditional nuclear, coal, or gas-fired generation, these new forms of generation have a small degree of controllability. To maintain the second-by-second balance of generation and load, other grid resources must respond to counteract the fluctuations of the intermittent generation. Although many different types of advanced control of nontraditional resources are being considered to provide these balancing services, e.g. grid-scale battery storage and demand response, the currently most available resources are the controllable traditional generators with gas-fired generators being the most flexible among these.

The combination of expanded natural gas-fired generation and its increased use to balance intermittent renewable generation is creating loads on natural gas pipelines that are significantly different than in the past. Traditional gas pipeline loads (Load Distribution Companies or LDCs) primarily serve space or water heating or other individual customer needs and evolve slowly throughout the day in a relatively well-known pattern that can be predicted based on historical information and weather forecasts. Other traditional pipeline customers are industrial loads that, although they may change from day to day, are very predictable over the span of a day. In contrast, when gas-fired generation is used to balance fluctuating renewable generation, a component of the resulting gas loads take on a stochastic nature. Unlike the gas load of an LDC, wind and PV generation respond to short-term fluctuations in environmental conditions, e.g. wind fluctuations on the timescale of 10-100 minutes and solar insolation fluctuations on the timescale of 1-100 minutes. At the longer timescales, these fluctuations may contain spatiotemporal correlations that increase the aggregate fluctuations of wind or PV generation across an entire electrical grid magnifying the fluctuations of natural gas loads used by gas generators to balance these changes.

Fluctuating gas loads create new dynamics in natural gas pipelines that can impact their reliability and the reliability of all interdependent infrastructures, including the electrical grid. To a great extent, electrical grid dynamics are determined by the very small amount of energy stored in the rotating kinetic energy of large centralized generators. Under a serious upset, this energy storage can maintain the reliable operation of the grid for a second or two while other resources are adjusted to compensate--typically an adjustment of mechanical power input to these same generators supported by a change in fuel burn rate. In some respects, if the grid "storage" is sufficient to survive the initial upset, an electrical grid with fuel-burning generators has very large amounts of storage on longer timescale in the fuel supplied to those generators.

Gas pipelines dynamics evolve on very different timescales. In the short term (10-100 minutes), gas pipelines have a large amount of storage in the compressed natural gas in the pipeline itself. A typical gas pipeline might be run very near its upper limit on pressure of 800 psi whereas the minimum gas delivery pressure is 500 psi. Even if all gas injections into the pipeline were cutoff, the gas loads would slowly reduce the pressure of compressed gas over a few hours without any significant impact on the loads until the gas pressure falls below the minimum delivery pressure. However, unlike the electrical grid, there may be very little gas storage on longer timescales. Injections of gas into the pipeline are scheduled via bi-lateral transactions in gas markets and are typically held constant throughout a 24-hour period. Therefore, the gas pressure in the pipeline evolves over both space and time according to the spatiotemporal arrangements of the gas injection and gas loads. If the injections and loads are out of balance, the gas pressure will undergo spatiotemporal evolution. However, the fluctuations in pressure will not be spatially uniform. In fact, the pressure fluctuations are nonlocal with the swings at one locations depending on the behavior at all other locations.

The feedback between fluctuating gas loads and gas pressure creates coupled reliability concerns across the natural gas pipeline and electrical grid infrastructures. The nonlocal effects mentioned above can couple with spatiotemporal correlations in the fluctuations of renewable generation through the response of the gas generators to magnify pressure fluctuations at certain locations in the pipeline. These fluctuations may lead to significant over or under pressures, both of which have serious impact on the reliability and safety of the pipeline itself. Under pressures may impact the gas generators by forcing them to reduce electrical output or potentially shutdown to preserve the integrity of service to other pipeline customers. As we will show in this manuscript, the most sensitive locations are those of zero flow at the end of the pipeline with unidirectional flow or at location(s) of flow reversal in pipelines with well separated injection locations. Therefore, the evolving spatial dependence of U.S. natural gas supply will couple to the stochasticity to create additional uncertainty in the reliability of the gas and electrical systems.

Neither gas pipeline nor electrical grid operators have the analysis tools to sufficiently address the probabilistic nature of the reliability impacts created by the coupled stochasticity of these infrastructures. The goal of the manuscript is to lay the foundation for these tools by developing a model and analysis to predict the spatiotemporal evolution of the probability distribution of gas pipeline pressure fluctuations. This first step seeks to develop a measure of probabilistic risk that can be subsequently integrated into the operations of both the electrical and pipeline infrastructure networks. We approach the problem by adopting phenomenological gas flow equations consisting of Partial Differential Equations (PDE) in one spatial dimension that have been accepted as accurate representations of long natural gas pipelines [\cite=osiadacz1987simulation] [\cite=87TT] [\cite=05Sar].

We develop models of fluctuations of gas-fired generator natural gas loads and the constraints imposed by natural gas markets to analyze the stochastically-driven PDEs. We develop analytic expression for probability distributions of gas pipeline pressures as a function of space and time and as a function of the settings of gas compressor stations that push the gas along the pipeline. Our analysis shows that, under constant compressor station settings, the mean square pressure fluctuations grow linearly in time similar to a diffusive process. We find that the largest mean square pressure fluctuations occur at location of zero flow that can potentially occur at any location along the pipeline depending on the average natural gas injections and loads. The results form the basis for a risk-aware optimization problem for the gas compressor stations controls.

The material in the rest of the manuscript is organized as follows. Section [\ref=sec:model] describes the basic model of natural gas pipelines. Section [\ref=sec:fluct] describes pressure sensitivity to fluctuating gas draws. Future work and extensions are discussed in Section [\ref=sec:conclusions]. Appendixes describe in greater detail the physical models of gas flow and the approximations used to develop the models discussed in the main text.

Model of Natural Gas Pipelines

The Transco pipeline (see Fig. [\ref=fig:Transco]) is a major interstate pipeline that delivers large quantities of natural gas to population centers and to natural gas-fired generators that supply electricity to those same population centers. Like many other major interstate pipelines, the Transco pipeline displays a nearly radial structure and it is equipped with many compressors that are often nearly equally spaced along its length (~  50-100 km between compressors). These two properties are reasonably well approximated by the radial, distributed compression model discussed in the main text. Under these two approximations, the Transco and similar pipelines can be analyzed using the simplified models and analysis discussed in the following.

We adopt a phenomenological, spatially one-dimensional model of a transmission pipeline delivering gas over long distances (~   1000's of km)--a reasonable model of interstate pipelines in the US. The form of this model is generally accepted as an accurate representation of long pipelines [\cite=osiadacz1987simulation] [\cite=87TT] [\cite=05Sar]. See the supplementary information (Appendixes) for model derivation and additional details. The gas injections may be configured in many different ways, e.g. at a single source at the originating end of the pipeline, two sources at either end of the pipeline, or in a distributed manner along the pipeline. However, in all that follows, the injections will be assumed to be constant in time-a simplification that is also a close representation of pipeline operations in the U.S. Natural gas loads are distributed along the pipeline and may fluctuate in time. Pressure gradients drive the gas along the pipeline from sources to sinks, and these gradients are maintained by gas compressors. A few other assumptions in the derivation and analysis of the model are made, but these are mostly taken to simplify the presentation. We will point out where these assumptions can be removed via more complicated analysis.

Gas Dynamic Equations

By integrating over the cross section of the natural gas pipeline, the three-dimensional equations of hydrodynamics are reduced to a representation in one spatial dimension. Mass conservation becomes

[formula]

where t is time, x is coordinate along the pipe (0 < x < L), p is the pressure along the pipe, φ is the mass flow along the pipe, q(x) is the density of the distributed gas consumption (q > 0 for injection and q < 0 for loads), and cs is sound velocity of the gas. Using a friction factor β as a phenomenological representation of turbulent drag, Navier-Stokes equation becomes

[formula]

Here, d is the pipe diameter and γ(x) is a distributed representation of the many compressor stations in long pipelines. A real compressor station can operate in several different modes, one of which is a fixed compression ratio γ such that pout  =  γpin where pout and pin are the pressures at the outlet and inlet of the compressor. Here, we have distributed this lumped compression ratio along the pipeline such it makes a positive contribution to the ∂xp of size γ(x). Fast acoustic transients are ignored in Eq. ([\ref=eq:NS]) by assuming cs  ≫  u, where u is the typical gas velocity. u is generally small enough that this condition holds everywhere in the pipeline, however, u (and its associated Reynolds number) is also large enough that β can be taken to be constant. We note that Eqs. ([\ref=eq:mass_con],[\ref=eq:NS]) have already been supplemented with an ideal gas equation state for the natural gas of the form p = c2sρ. The model derivation in the Appendixes addresses more general and more realistic settings such as meshed networks and compression spatially concentrated at the nodes.

Simplified Market Model

The flow of natural gas in a pipeline is scheduled via bilateral transactions between buyers and sellers in a day-ahead market with market clearing and gas flows scheduling done well in advance of the following 24-hour period of gas delivery. Scheduling consists of determining the locations and constant rates of gas injections. The gas pipeline operator expects that gas loads will be fairly uniform over the 24-hour delivery period. Some level of fluctuating gas load is allowed, and it is these fluctuations that is expected to grow as natural gas-fired electrical generation is increasingly used to balance renewable fluctuations. After the 24-hour delivery period begins and gas buyers have better estimates of their actual needs, they can make mid course corrections by transacting and scheduling gas flows in two subsequent intra-day markets at 10 and 14 hours after the start of the 24-hour delivery period. In the three intervening periods, the gas injections are held relatively constant, and it is these periods we seek to analyze.

We model these subperiods by first solving for a stationary solution where time-averaged gas loads q()(x) are given and are globally balanced by time-independent gas injections at either end of the pipeline, i.e. [formula] and [formula]. The stationary gas flow along the pipe is related to the loads by

[formula]

and the global mass balance implies

[formula]

Natural gas pipeline operators require that Eq. ([\ref=eq:stationary_balance]) be satisfied over the 24-hour delivery period. To insure this condition over the 24-hour period, there may be some deviation in the balance in the intra-day periods to compensate for inaccurate forecasting or changes in the average gas loads. However, in the remainder of this discussion, we will assume that the stationary solution is balanced in each intra-day subperiod. In the following, we will add fluctuations to q()(x), and therefore φ()(x), to model the affects of renewable generation on the pipeline pressure fluctuations.

Compressor Model For Stationary Flows

Before adding fluctuations, we first describe the control of the gas compressors for the stationary gas flows. If the gas loads q(x) and flow φ(x) were actually stationary, then the control for the gas compression stations could be computed once and implemented for the entire 24-hour gas delivery period, or at least for the intra-day periods. Natural gas pipeline operators seek to maintain a relatively uniform pressure profile up to the the pressure drop between compressor stations. Our simple model of spatially-distributed compression γ(x) in Eq. ([\ref=eq:NS]) is a reasonable representation of gas pipeline operations and provides a spatially uniform pressure p0 when

[formula]

We pick this model for ease of presentation. Spatially discrete compression and nonuniform pressure profiles [\cite=68WL] [\cite=00WRBS] [\cite=12BNV] [\cite=13MFBBCP] can be incorporated in an edge-node network model in straightforward manner. See Appendixes for additional discussions.

Pressure Sensitivity to Fluctuating Gas Draws

Time-dependent gas loads require the solution of the dynamic versions of Eqs. ([\ref=eq:mass_con],[\ref=eq:NS]). Here, we consider the time-dependent component to be fluctuations of the gas loads about their forecasted values, q(t;x) = q()(x) + ξ(t;x), where ξ(t;x) models the random, zero mean and statistically stationary fluctuations. As described in Appendix [\ref=sec:methods] when these fluctuations are relatively weak (even though they may be spatio-temporarily nontrivial), an analytical solution for the time-dependent variance of the gas pressure valid at t  ≫  τ becomes

[formula]

The solution shows that a pipeline's sensitivity to fluctuating gas draws depends on the stationary solutions φ()(x) or γ(x) and the statistics of the fluctuating gas loads.

Here, we analyze three exemplary stationary configurations to explore the qualitative features of this sensitivity. The first two cases are shown in Fig. [\ref=fig:Mass_flux].

Case 1 displays injection of gas only at the two ends of the pipeline (φ()(0) / φ0 = 1 and φ()(L) / φ0 =  - 2 / 3) with uniformly distributed gas draws along the pipeline (q()=const). The resulting mass flux along the pipeline is φ()(x)  =  φ0(1 - x / x*) - thin black trace in Fig. [\ref=fig:Mass_flux] - where x*  =  0.6L. According to Eq. ([\ref=eq:stationary_compression]), the stationary compression is proportional to φ()|φ()| creating a compression profile that goes to zero at x* and is biased toward either end of the pipeline at x = 0 or x = L - thick black trace in Fig. [\ref=fig:Mass_flux].

Case 2 is a simple modification of Case 1 that concentrates the gas draws near a single location at x*. In Case 2, [formula] - thin red trace in Fig. [\ref=fig:Mass_flux] - where the choice of the 0.918 factor for Case 2 makes the total gas injection into the pipeline, φ()(0) - φ()(L), the same as in Case 1. The larger gas draws near to x* are indicated by the higher values of ∂xφ() at x*. The resulting compression shows a linear dependence with heavier weighting of compression closer to x* than in Case 1.

Using the distributed compression γ(x) in Fig. [\ref=fig:Mass_flux], Z(x) / Y is computed using Eq. ([\ref=eq:mean_square_nondim]). The results for Case 1 and Case 2 are shown in Fig. [\ref=fig:ZoverY_linear] and Fig. [\ref=fig:ZoverY_sqrt], respectively. The different traces in these Figures are for different values of the coefficient, [formula], that scales the compression density γ(x). Interpreting the distributed compression in terms of a set of discrete compressor stations of uniform compression ratio, Case 2 with C = 50 corresponds to between 6 and 7 compressors with compression ratio 1.5 placed uniformly between x= 0 to x*, i.e. a typical number of compressors for a mildly stressed pipeline configuration.

When the pipeline is under very little stress (C = 1), both Case 1 and Case 2 show a relatively uniform Z(x) / Y  ~  1. Under these conditions, there are no regions of the pipeline that show a significantly enhanced sensitivity to stochastic gas loads. As the stress is increased (larger C), proportionally more compression is deployed in the stationary solution. Both Case 1 and Case 2 show a depression of Z(x) / Y near the ends of the pipeline, i.e. the injection points, and an enhancement near x*. Although the total gas injection into the pipeline is the same in Cases 1 and 2 (for the same value of C), the enhancement of the sensitivity to stochastic gas loads in Case 2 is stronger and more focused for two reasons. First, the total (aggregated) compression on the system is larger in Case 2. This can be seen from the curves for compression γ(x) in Fig. [\ref=fig:Mass_flux]. Second, the stationary gas loads are more concentrated near x* resulting in more compression located near x*. After normalization by Y, Z(x) / Y displays a sharper peak. If the gas load were entirely concentrated at x*, the mass flux and compression would be uniform along the pipeline (on either side of x*), and the peak in Z(x) / Y would be even sharper.

The result that the pipeline shows the highest sensitivity to fluctuations near x* is not a coincidence. The mass flux in the pipeline exhibits a reversal at this point and the compression changes sign. It is at the flow reversal that the integral in Eq. ([\ref=eq:mean_square_nondim]) of the Appendix is the largest. Therefore, in pipelines where the direction of the stationary mass flux is primarily in one direction over long distances, the resulting compression will cause the points of flow reversal to be the most sensitive to pressure fluctuation from stochastic gas draws. This qualitative result begins to suggest the possibility of fluctuation-aware control algorithms that adjust either the mean gas pressure or the spatial distribution of compression to limit the probability of the gas pressure violating either upper or lower pressure limits.

Gas injections at the ends of the pipeline do not always dominate the flow in a pipeline. Such a situation may occur near the beginning of a major pipeline where there are many sources of gas injections interspersed with many gas customers. The flow in the pipeline may alternate many times before a significant unidirectional flow builds up. This situation often occurs in the Williams Transco interstate pipeline near its beginning in Texas[\cite=Transco]. This situation may also arise in smaller intrastate pipelines where many smaller, spatially distributed sources are injecting into a pipeline that is serving many different customers. Case 3 models these configurations by distributing both gas loads and injections along the pipeline with zero injection or load at the ends, i.e. φ()(0) = φ()(L) = 0. Fig. [\ref=fig:Random] (solid line) displays a realization of spatially disordered stationary loads and injections q()(x) that corresponds to a total gas flow equivalent to C  ≈  14.9 in Case 1 or 2 from above. Although the total gas injection is similar, the frequent flow reversals limit and the build up of the integral in Eq. ([\ref=eq:mean_square_nondim]) reduces the values of Z(x) / Y in Fig. [\ref=fig:Random] (dashed line) as compared to the Cases 1 and 2 where the flow is more spatially uniform. The spatial disorder of q()(x) results in a system that is more robust to fluctuations of gas loads.

Perspectives

We have developed a dynamical model of natural gas pipelines that incorporates the effect of fluctuating gas injections and loads on the pressure at all points along the pipeline. The model divides the injections and loads into a stationary component and a fluctuating in time component. Compressors along the pipeline are adjusted so that the solution for the stationary gas pressure is spatially uniform. An asymptotic solution for the fluctuating pressure factorizes into a product of two terms. The first term depends on the profile of the stationary injection/consumption along the paper and is related to the compression deployed in the stationary solution. Surprisingly, this term does not depend on the gas load fluctuations. The second term grows diffusively in time as given by a spatiotemporal integral of the zero-mean gas load fluctuations. Results for exemplary cases show that the sensitivity of pressure fluctuations to gas load fluctuations is peaked at and around locations of stationary mass flux reversals. The results suggest the development of a risk-aware gas compressor control that limits the probability of the gas pressure exceeding upper engineering limits or lower contract delivery limits. Pipelines with spatially-disordered injections and loads show less sensitivity to gas load fluctuations.

There are many areas for future work including:

The current formulation should be converted to a node-edge network model more amenable to the simulation of real gas networks with compression concentrated at gas compressor stations.

Discrete compressor stations will force the relaxation of our assumption of spatially uniform pressure.

The solution for the stationary compression should be converted to an optimization for gas pipeline operations (e.g. for minimum cost of compression, maximum throughput, etc) while limiting the probability of violating an upper or lower gas pressure limit.

The authors acknowledge multiple discussions with R. Bent and S. Misra, and support of the Advanced Grid Modeling Program in the Office of Electricity in the U.S. Department of Energy.

Description of Appendixes

The Supplementary Information contained in the Appendixes describes in greater detail the physical models of gas flow and the approximations used to develop the models discussed in the main text.

Methods used to derive main results of the paper are detailed in Appendix [\ref=sec:methods], consisting of two Subsections devoted to discussion of the linearized one-dimensional model of stochastic gas dynamics and following analysis of the probabilistic measure of risk, respectively.

The remaining Appendixes provide discussions of more general modeling needed to support the paper's conclusions. Appendix [\ref=sec:pipe] describes basic hydrodynamic equations for a single pipe and discusses the slow transient approximation used in the main text. Appendix [\ref=sec:DGF] generalizes the single pipe Dynamic Gas Flow (DGF) description to the case of non-steady gas flows over a meshed network. Appendix [\ref=sec:steady] briefly discusses steady Gas Flow (GF) solutions of the DGF model and puts them in the context of the Optimum Gas Flow (OGF) problem used to determine gas compressor operation. In Appendix [\ref=sec:pert], the DGF system is linearized around a steady solution and the general solution of the linear dynamic problem over the network is constructed. The solution is split into homogeneous (zero mode) and inhomogeneous parts and it is argued that the inhomogeneous part of the linearized DGF becomes asymptotically small in the regime of interest. Here we also add a Subsection briefly discussing the inhomogeneous correction, for the general case and then also for the special model of a long pipeline with distributed compression discussed in the main text.

Methods

Linearized Model of Stochastic Gas Dynamics

The stationary solution described above applies to gas pipelines with well-behaved gas loads. Under these conditions, the pressure p0 does not vary and the pipeline operations are very secure and reliable. Stochastic gas loads that arise from gas generation compensating fluctuating renewable generation change this picture. Fluctuating gas loads are added to the stationary solution

[formula]

where ξ(t;x) is zero mean (〈ξ〉 = 0) so that each load, although stochastic, is restricted to consume its scheduled amount q()(x) over the intra-day market subperiod. The stochastic component of the gas load ξ(t;x) is expected to include spatiotemporal correlations typical of renewable generation, e.g. ξ(t;x) for wind generation is expected to be correlated on the time scale of tens of minutes to hours over lengths from tens to hundreds of miles.

The effect of the stochastic gas loads is analyzed by linearizing the hydrodynamic model in Eqs. ([\ref=eq:mass_con],[\ref=eq:NS]). (Linearization of the basic non-stationary gas flow equations was already discussed in the literature, however only in the context of simplifying numerical evaluations of the underlying partial differential equations (e.g. [\cite=10BS] and references therein). Here, we carry it two steps further-we derive analytical relations and then to analyze effects of stochastic fluctuations and spatial disorder in gas loads. Another recent analytical approach retains the basic nonlinearity but assumes adiabaticity, i.e. very slow changes in the gas loads [\cite=11HMS]. Although promising computationally, this approach fails to account for fast, but not necessarily large, fluctuations in the gas draws originating from the electric grid-natural gas pipeline interaction.) Expanding these equations to first order in the fluctuations yields

[formula]

where δp and δφ are the fluctuating pipeline pressures and mass flows, respectively. Although the gas loads fluctuate, the gas injections φ0 and φL remain at their stationary values imposing conditions on the fluctuating mass flows

[formula]

The structure of Eqs. ([\ref=eq:mass_con_1]-[\ref=eq:balance_1]) provides some guidance regarding the types of solutions expected. Differentiating Eq. ([\ref=eq:NS_1]) with respect to x (and temporarily assuming a uniform φ()) enables the elimination of δφ via Eq. ([\ref=eq:mass_con_1]). The resulting PDE in δp has the structure of a nonlinear diffusion equation that is driven by exogenous perturbations ξ(t;x). Because 〈ξ〉 = 0 over the intra-day periods, it is tempting to drop all time derivatives in Eq. ([\ref=eq:balance_1]) and compute time-independent mean square fluctuations of δp, however, this approach is incomplete. Spatiotemporal correlations in ξ(t;x) occurring on time scales shorter than the intra-day period will result in gas draw fluctuations that create shorter-term imbalance with net flow of gas into or out of the pipeline. Eq. ([\ref=eq:balance_1]) shows that these non-zero net fluctuations are not allowed to leak out either end of the pipeline because φ0 and φL are held fixed. The only way for the system to accommodate these short-term correlated fluctuations is through a "zero mode" where the average pressure in the entire pipeline raises or falls along with the fluctuating injections. This zero mode and its effects on the pipeline pressure fluctuations are the emphasis of the remainder of this manuscript.

Probabilistic Measure of Risk: Analysis

To represent the slow drifts of pipeline pressure discussed above, we suggest a solution to Eqs. ([\ref=eq:mass_con_1],[\ref=eq:NS_1]) of the form

[formula]

where the two components of the solution respond to the different characteristics of the fluctuations ξ(t;x). The first component a(t)Z(x) is the zero mode where Z(x) is a slowly varying function of x that captures the spatial distribution of gas stored in the pipeline as pressure rise or fall driven by the correlated component of the fluctuating gas draws. The time dependence of these global pressure swings are captured by a(t). In contrast, b(t;x) varies more rapidly in space and responds to the uncorrelated component of the fluctuations of ξ(t;x) that occur on finer spatial and time scales. The larger spatial derivatives of b(t;x) result in relatively rapid diffusion of pressure (and gas) which limits the impact of b(t;x) on pressure fluctuations.

Substituting our proposed solution ([\ref=eq:solution_form]) into Eqs. ([\ref=eq:mass_con_1],[\ref=eq:NS_1]) yields an equation for the zero mode

[formula]

which has a solution

[formula]

The solution for Z(x) does not depend on the form of the fluctuations ξ. Rather, it depends on the stationary solution φ()(x), or equivalently on deployed gas compression in the stationary solution. The same substitution also yields an expression for a(t) that does depend on the gas load fluctuations:

[formula]

Since a(t) is independent of x, Eq. ([\ref=eq:a_eq]) can be integrated over the length of the pipeline to yield an explicit expression for a(t):

[formula]

where Eq. ([\ref=eq:balance_1]) has been used to eliminate the δφ term.

The physical interpretation of the zero mode a(t)Z(x) now becomes clear. The double integral in Eq. ([\ref=eq:a_solution]) filters out the uncorrelated components of ξ showing that the time dependence of the zero mode a(t) only responds to the fluctuations of ξ that are correlated in space (over the entire length of the pipeline) and in time (since the beginning of the intra-day market period). A discussion of the solution component b(t;x) is given below in Section [\ref=subsec:inhomogeneous]. The zero mode a(t)Z(x) will dominate the contribution to δp(t) at times longer than the correlation time τ of ξ where τ is expected to be in the range of tens of minutes to hours for fluctuating gas loads creating by gas-fired electric generators balancing intermittent wind generation. For t  ≫  τ, we may safely drop the b in favor of a(t)Z(x) and estimate the pressure variation covariance as

[formula]

where we have also assumed statistical stationarity of ξ(t;x) over time.

Eq. ([\ref=eq:mean_square]) can be rearranged slightly to reveal a physical interpretation, as shown in Fig. (6) of the main text. The first term on the right hand side of Eq. (6) of the main text is the square of the fractional pressure decline if the entire pipeline was subject to the spatially averaged gas load [formula] without any compensating injections for one correlation time τ of the gas load fluctuations. This first term is multiplied by the number of correlation times (t / τ) since the intra-day period began. The third term provides the only x dependence and describes the sensitivity of different locations in the pipeline to pressure fluctuations. This dependence comes entirely through Z(x) which (see Eq. ([\ref=eq:Z_solution])) depends only on the compression deployed in the stationary solution. The dependence on Z(x) demonstrates that a highly stressed pipeline, i.e. one with a large [formula], is more susceptible to pressure fluctuations driven by stochastic gas loads, and Z(x) shows which pipeline locations are most susceptible. The final term on the the right hand side of Eq. (6) of the main text measures the spatial average of the correlated fluctuations in the gas loads normalized by the average stationary gas load.

The right hand side of expression for a(t) in Eq. ([\ref=eq:a_solution]) is a time integral over a stochastic process, and per the law of large numbers, a(t;x) and δp(t;x) are expected to be asymptotically Gaussian when the integration time is longer than the correlation time of ξ. In this limit, the estimate of the pressure fluctuation covariance in Eq. ([\ref=eq:mean_square]) or Eq. (6) of the main text also predicts the tails of the distribution over δp, thus allowing the estimation of the probability of relatively rare events of high or low pressure fluctuations (under the condition that the fluctuations are still within the linear approximation used here). Eq. ([\ref=eq:mean_square]) becomes a probabilistic measure of risk to reliability of natural gas pipeline operations and a route to modeling the risk that cascades to the interdependent infrastructures such as electric power systems.

Gas Flow Equations: Individual Pipe

Following [\cite=13MFBBCP], we consider the flow of a compressible gas in a single length of pipe. Major transmission pipelines are typically 16-48 inches in diameter and operate at high pressures and mass flows, e.g. 200 to 1500 pounds per square inch (psi) and moving millions of cubic feet of gas per day [\cite=Ref_Crane1982] [\cite=Ref_Mokhatab2006]. Under these highly turbulent conditions, the pressure drop and energy loss due to shear is well represented by a nearly constant phenomenological friction factor f. The resulting gas flow model is a partial differential equation (PDE) with one spatial dimension x (along the pipe axis) and one time dimension [\cite=osiadacz1987simulation] [\cite=87TT] [\cite=05Sar]:

[formula]

Here, u,p,ρ are velocity, pressure, and density at position x; Z is the gas compressibility factor; T is the temperature, R is the gas constant, and d is the diameter of the pipe.

Eqs. ([\ref=density_eq],[\ref=momenta_eq],[\ref=state_eq]) represent mass conservation, momentum balance and the ideal gas thermodynamic relation, respectively. The first term on the rhs of Eq. ([\ref=momenta_eq]) represents the friction losses in the pipe. The second term on the rhs of Eq. ([\ref=momenta_eq]) accounts for the gain or loss of momentum due to gravity g if the pipe is tilted by angle α. The frictional losses typically dominate the gravitational term, which is typically dropped. Similarly, the gas inertia term (∂t(ρu) is also typically small compared to the frictional losses (as the flow velocity is significantly smaller than sound velocity) and is dropped. For simplicity of presentation, we have also assumed that the temperature does not change significantly along the pipe.

Taking into account these assumptions, Eqs. ([\ref=density_eq],[\ref=momenta_eq],[\ref=thermodynamic_eq]) are rewritten in terms of the pressure p and the mass flux φ = uρ:

[formula]

where [formula] is the sound velocity and [formula] are both considered constant. To resolve the dynamic problem for t∈[0,τ] over x∈[0,L] we also need to supply Eqs. ([\ref=density_eq1],[\ref=momenta_eq1]) with initial and boundary conditions for flows,

[formula]

which are consistent, i.e. φ0(0) = q()(0) and φ0(L) = q()(0), in addition fixing pressure initially at an end of the pipe, e.g. p(0;0) = p0.

Dynamic Gas Flow (DGF) over Network

The single pipe setting in Eqs. [\ref=density_eq1] and [\ref=momenta_eq1] is generalized to a gas network represented by a graph G = (V,E) with a set of vertexes V and set of edges E, where the edges will be considered directed or undirected, depending on the context. See Fig. [\ref=fig:scheme] for a schematic illustration. We will adopt (i,j) and {i,j} notations for directed and undirected edges, respectively. Each vertex, i∈V represents a node with a gas injection/consumption rate qi (mass per unit time). Each edge (i,j)∈E is a single pipe with mass flow φij. The flow along each edge is described by a set of PDEs:

[formula]

where pij(t,x) and φij(t,x) are the pressure and mass flow, respectively, at time t and position x along edge (i,j) of length Lij. Here, pij = pji, φij =  - φji, and Lij = Lji. See Fig. [\ref=fig:scheme]a for a schematic description of the variables.

The flow of gas create a pressure drop. To compensate, the pressure is boosted at compressor stations potentially located at both ends of each edge {i,j}. αi  →  j is the compression ratio of the station adjacent to node i while αj  →  i is the compression ratio adjacent to node j. We choose to place compressors at the two ends of every line/pipe for generality, which also simplifies the notations in the following discussion. In reality there will be only none or one compressor on any particular edge of the graph. Note also that αi  →  j may be larger or smaller than unity, thus representing compression or decompression. If only compression is allowed, then αi  →  j  ≥  1. The relationships between the pressures in Fig. [\ref=fig:scheme] are

[formula]

where pi and pi  →  j are the pressures at node i and just past the compressor on edge (i,j) adjacent to node i and the last part of Eq. ([\ref=compressor]) is added for clarity. If there is no compressor installed at the beginning of the edge (i,j) or if the compressor is inactive, αi  →  j = 1. In the current operational paradigm, compression rates are not changed very frequently, however, we anticipate changes and allow the αi  →  j to depend on time.

Eqs. ([\ref=momenta_eq1],[\ref=compressor]) are complemented with mass conservation at all nodes of the network:

[formula]

When the gas injections q(t) = (qi(t)|i∈V) for are given for t∈[0,τ], nodal conditions ([\ref=flow_conserve]) generalize the single-pipe boundary conditions in ([\ref=phi-in-out]) to a pipe network. Eqs. ([\ref=density_eq1],[\ref=momenta_eq1],[\ref=compressor],[\ref=flow_conserve]) constitute a complete set of equations describing the Dynamic Gas Flow (DGF) problem if they are supplemented with compression ratios, i.e. α = (αi  →  j|(i,j)∈E), initial conditions on the flows

[formula]

and pressure at one arbitrarily chosen slack node, pi = 0(0) = p0.

Stationary Gas Flow and Optimum Gas Flow

The stationary/steady version of the DGF problem is the Gas Flow (GF) problem. In the GF problem, all input parameters (consumptions/injections, compression ratios and the pressure at the slack bus) are constant in time, and the total injection and consumption are balanced

[formula]

The steady solution of Eq. ([\ref=density_eq1]) is uniform mass flow along each pipe in the network, [formula]. Substituting this result into Eq. ([\ref=momenta_eq1]) and taking straightforward spatial integration yields algebraic relations between flow through and pressures at both ends of every pipe in the network

[formula]

The GF problem has a unique solution provided the compression ratios are known.

Compression ratios α are time-independent in the steady GF setting. The configuration of α over the network is typically decided using a combination of economic and operational factors. The model selected in the main text corresponds to a simple greedy approach, i.e. maintain constant pressure throughout the network for flows corresponding to the forecasted comsumptions/injections. This model roughly replicates the behavior of pipeline operators in the U.S. where the energy consumed in the compression of the gas is not a major concern. More sophisticated compression dispatch options, in particular minimization of the total work spent on compression subject to maintaining pressure within acceptable limits, have been extensively discussed in the literature, e.g. [\cite=68WL] [\cite=00WRBS] [\cite=10Bor] [\cite=13MFBBCP] and references therein.

Perturbative solution of the DGF problem

We generalize discussion in the main text by introducing stochastic gas loads (due, e.g., to natural gas-fired generators) from a line to a network, such that q(t) = q()  +  ξ(t) where components of ξ(t) = (ξi(t)|i∈V) are time varying but relatively small in comparison with q(). We look for a linearized solution of the DGF problem of the form p(t) = p()  +  δp(t) and φ(t) = φ()  +  δφ(t), where the respective corrections are small, i.e. |δp(t)|  ≪  p() and |δφ(t)|  ≪  φ(). The linearized versions of Eqs. ([\ref=density_eq1],[\ref=momenta_eq1],[\ref=compressor],[\ref=flow_conserve]) become

[formula]

The remainder of the Subsection is devoted to finding an asymptotic solution of Eqs. ([\ref=density_delta],[\ref=momenta_delta],[\ref=compressor_delta],[\ref=conditions_delta_p],[\ref=conditions_delta_phi]). Here, asymptotic implies finding solutions for time τ longer than the correlation time of the fluctuation consumption ξ. We seek solutions that eliminate the complexity of the PDE of Eqs. ([\ref=density_delta], [\ref=momenta_delta],[\ref=compressor_delta],[\ref=conditions_delta_p],[\ref=conditions_delta_phi]) and that connect the nodal quantities by algebraic relationships.

Therefore, generalizing the solution proposed in the main text (see Eq. (10)), we look for a solution of Eqs. ([\ref=density_delta],[\ref=momenta_delta]) of the form

[formula]

where aij(t) only depends on time. Here in Eq. ([\ref=delta-p]) Zij(x) solves the following linear homogeneous equation

[formula]

where Zij(x) counts x from node i, i.e. reversing the direction of counting one gets, Zij(Lij) = Zji(0).

Assuming that τ is sufficiently large, we conjecture (which will be verified after the global asymptotic solution is found) that the major contribution to δpij in Eq. ([\ref=delta-p]) originates from the first "zero-mode" term aij(t)Zij(x) that (as will be seen below) grows in time compared to the second term that does not.

To find the leading (zero mode) term we proceed as follows. The integration of Eq. ([\ref=Z]) over the spatial dependence of the stationary profile ([\ref=p-phi-steady]), yields

[formula]

where the normalization constant is chosen to guarantee, [formula]. We solve for the time-dependent factor aij(t) by substituting δpij with aij(t)Zij(x) into Eq. ([\ref=density_delta]) and integrate the result over the entire spatial extent of the pipe {i,j} yielding

[formula]

In the asymptotic limit where δpij is approximated by aij(t)Zij(x) for every pipe (graph edge), Eqs. ([\ref=conditions_delta_p]) can only be satisfied if the aij(t) have the same functional dependence on time, i.e.,

[formula]

where cij = cji is an edge specific constant. To compute the global time-dependent factor a(t) in Eq. ([\ref=a]) we sum over all the nodes of the graph

[formula]

integrate over time, define

[formula]

and finally sum Eq. ([\ref=a]) overall edges:

[formula]

Therefore, [formula]

[formula]

The unknown edge constants cij are derived by substituting Eqs. ([\ref=delta_p_final]) into Eqs. ([\ref=compressor_delta], [\ref=a]) yielding

[formula]

Eqs. ([\ref=delta_p_final], [\ref=c-relations], [\ref=Z2]) express the complete asymptotic (zero mode) solution of the DGF problem.

Assuming that the random gas load fluctuations ξi(t) are zero-mean, temporarily homogeneous, and relatively short correlated in both time (the correlation time is less than τ) and space (the correlation length is less than the spatial extent of the network), and observing that δpij in Eq. ([\ref=delta_p_final]) is given by a time-integral and spatial-sum of the fluctuations, one concludes that according to the Large Deviation theory, the pressure fluctuations form a Gaussian random process which jitter diffusively in time, i.e. the Probability Distribution Function (PDF) of δpij(t,x) is

[formula]

where the correlation function on the right-hand-side does not depend on t' due to assumption of the statistical homogeneity of ξ.

Correction to the asymptotic solution

In the general analysis of the preceding Section of this SI, the pressure fluctuations are separated into homogeneous (zero mode) and inhomogeneous (forced) components, according to Eq. ([\ref=delta-p]). The formal separation in Eq. ([\ref=delta-p]) leads to a differential equation for the inhomogenous solution b(t;x) which, for the general formulation above, is fully defined by Eqs. ([\ref=b-eq],[\ref=delta-phi-eq]).

Once the leading, growing in time, contribution to δpij is found, one verifies that, bij(t,x), extracted from

[formula]

does not grow with time, and thus it is asymptotically smaller -- consistently with what was conjectured above to derive the leading contribution.

Let us discuss this asymptotic separation of the solution into dominant contribution and correction in more details for the simplified analysis/model of the main text. Repeating the solution separation on the (simplified) continuous-compression model, we find a differential equation for b(t;x) in terms of δφ, i.e.

[formula]

Fluctuations in δφ drive b(t;x), but unlike for the homogeneous solution, Eq. ([\ref=eq:b_eq]) shows that this effect is entirely local. Specifically, Eq. (14) of the main text shows that the homogeneous component responds to the global imbalance in gas loads while the response in Eq. ([\ref=eq:b_eq]) is to the local δφ. In addition, the response in Eq. ([\ref=eq:b_eq]) decays in space and does so quickly in areas of high compression for the stationary solution (see Eq. (5) of the main text). In contrast, the homogeneous solution grows more quickly in areas of high compression (see Eq. (12) of the main text). These two properties contribute to the dominance of the homogeneous solution over the inhomogeneous solution at longer times.