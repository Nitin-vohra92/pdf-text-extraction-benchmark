Reducing quasi-ergodicity in a double well potential by Tsallis Monte Carlo simulation

and Yutaka Okabe[formula] *Department of Computer Engineering, Hiroshima City University Hiroshima 731-3194, Japan and [formula]Department of Physics, Tokyo Metropolitan University Hachioji, Tokyo 192-0397, Japan

Introduction

The ergodic hypothesis is fundamental to statistical mechanics. This hypothesis states that the time average of an observable event equals the phase-space average. In practical application, however, problems can arise in various types of simulations if the system must overcome high energy barriers to reach other regions of phase space. In that case, the length of a simulation needed in order to obtain enough statistical samples of all regions of phase space may be extremely long. In the Monte Carlo simulation, the errors arise as a consequence of the finite length of the Monte Carlo walk. This error can be serious in canonical Monte Carlo sampling, especially at low temperatures. This problem, referred as "quasi-ergodicity" by Valleau and Whittington [\cite=VW], appears even in the simplest double well problem, where the two wells are separated by a large barrier [\cite=FFD].

Recently several authors [\cite=Pe] [\cite=TS] [\cite=AS1] have proposed a generalized simulated annealing method to locate the global minimum based on the generalized statistical mechanics proposed by Tsallis [\cite=Ts], which can overcome the slow convergence of the traditional simulated annealing method [\cite=KGV] based on the standard Monte Carlo scheme. Subsequently, Andricioaei and Straub have pointed out that their generalized Monte Carlo (Tsallis Monte Carlo) [\cite=AS2] method may be used to overcome the quasi-ergodicity appearing in the canonical average at constant temperatures.

In this short note we use a new Monte Carlo scheme [\cite=AS2] [\cite=AS3] [\cite=SA] based on Tsallis's generalized statistical mechanics [\cite=TS] for the calculation of the thermal average of the potential energy of a simple double well potential at constant temperatures. We examine the performance of this new algorithm designed to overcome the quasi-ergodicity.

A generalized Monte Carlo scheme

In the generalized statistical mechanics proposed by Tsallis [\cite=Ts], a crucial role is played by the generalized entropy Sq defined as

[formula]

where q is a real number which characterizes the statistical mechanics, and pi is the probability of states i. This entropy Sq becomes the usual Gibbs-Shannon entropy [formula] when q  →  1. By maximizing the generalized entropy with the constraints

[formula]

where εi is the energy spectrum, the statistical weight for the generalized canonical ensemble characterized by the parameter q is given by the Tsallis weight

[formula]

with

[formula]

where [formula] is the generalized energy and [formula] is the Lagrange multiplier, which plays the role of the generalized temperature in the Tsallis statistical mechanics. We should note here that the statistical weight is not given by the probability distribution pi but rather by pqi in order to calculate thermal averages, as can be seen in ([\ref=eq:2]). The generalized canonical partition function Zq in ([\ref=eq:3]) is given by

[formula]

In the limit q  →  1, [formula] and [formula] where T is the usual temperature [\cite=CT], then the Tsallis weight ([\ref=eq:3]) becomes the Boltamann weight pi  =   exp ( - βεi) / Z1 of the usual canonical ensemble.

In this generalized statistical mechanics, Andricioaei and Straub [\cite=AS1] have noted that since the average of an observable O is defined by

[formula]

the detailed balance condition should be written as

[formula]

where Wij is the element of the transition matrix. Based on this observation, they [\cite=AS1] pointed out that the generalized Monte Carlo algorithm [\cite=TS] originally proposed by Penna [\cite=Pe] in his generalized simulated annealing method cannot satisfy the detailed balance. They [\cite=AS1] then proposed a new generalized Monte Carlo scheme, where the acceptance probability p of the Monte Carlo move is given by

[formula]

which has a similar form to the familiar Metropolis algorithm [\cite=MRRTT]

[formula]

where [formula] is the increase of the generalized energy ([\ref=eq:4]) while Δε is that of the usual energy. Andricioaei and Straub [\cite=AS1] combined this Monte Carlo algorithm with the usual simulated annealing technique [\cite=KGV] to optimize the conformation of tetrapeptides. They showed that their algorithm is more effective than the standard simulated annealing based on the usual molecular dynamics or Monte Carlo methods.

Recently, Andricioaei and Straub [\cite=AS2] [\cite=AS3] pointed out that their generalized Monte Carlo scheme [\cite=AS1] for simulated annealing can also be used to calculate the standard canonical ensemble averages at constant temperatures

[formula]

using the general rule of the importance sampling [\cite=VW]

[formula]

Then, equation ([\ref=eq:9]) can be calculated using the generalized Monte Carlo scheme from

[formula]

where the generalized average <  > q is defined by ([\ref=eq:6]). In practice, the equilibrium thermal average in the standard canonical ensemble can be calculated by conducting these "generalized" Monte Carlo steps and accumulating the samples by

[formula]

where the sum j runs over to the generalized Tsallis Monte Carlo steps produced by eq.([\ref=eq:7]) instead of the usual Metropolis algorithm ([\ref=eq:8]). The equation ([\ref=eq:12]) is a generalized expression, and we may choose [formula]. Then, the equation ([\ref=eq:12]) reduces to

[formula]

which has been used in [\cite=AS2] [\cite=AS3]. From now on, the actual calculation will be done by choosing [formula].

We would like to point out here that a similar reweighting technique is used in the histogram method [\cite=FS] and the multicanonical ensemble method [\cite=BN]. Andricioaei and Straub applied this Tsallis Monte Carlo algorithm to the two-dimensional Ising system [\cite=AS2], a classical one-dimensional potential and a 13-atom Lennard-Jones cluster [\cite=AS3], and showed that this new Monte Carlo algorithm is more effective than the standard Metropolis algorithm. They also proposed the generalized molecular dynamics based on Tsallis generalized statistical mechanics [\cite=AS3] [\cite=SA]

Application to a classical double well potential

In order to check the performance of this new Monte Carlo algorithm [\cite=AS2] [\cite=AS3] in a classical system such as molecules and liquids, we look at the problem of a classical particle in a one-dimensional double well potential defined by

[formula]

where

[formula]

which was examined by Frantz et al. [\cite=FFD] to demonstrate the quasi-ergodicity of the standard Metropolis algorithm. The potential given by ([\ref=eq:13]) has the double minimum at x = 1 and x =  - α; therefore, it represents a symmetrical double well when α = 1 and a single well when α = 0. This potential is more conveniently characterized by the parameter γ [\cite=FFD]

[formula]

In figure 1, we show the asymmetric double well potential V(x) when γ = 0.9 as well as the equilibrium Tsallis weight [formula], which is renormalized, and Boltzmann weight pB  =   exp ( - βV(x)) / Z1. It is obvious that the statistical weight pT of the Tsallis generalized statistical mechanics has a greater chance of crossing the barrier and, therefore, a greater possibility of avoiding quasi-ergodicity.

Alternatively this Tsallis's statistical mechanics can be regarded as a search-space smoothing method which deforms the rugged potential landscape by a smoother one. In figure 2, we show the smoothed potential [formula] calculated from ([\ref=eq:4]), which has a smoother landscape and a lower energy barrier than the original landscape V(x).

We use this double well potential to look at the quasi-ergodicity of the standard as well as the generalized Monte Carlo scheme by examining the classical average potential energy [\cite=FFD]

[formula]

which can be calculated rigorously by numerical quadrature as a function of the temperature β and the asymmetry parameter γ. We employ the same Monte Carlo procedure of Frantz et al. [\cite=FFD] and use the uniform sampling distribution from previous position x to new position x' given by

[formula]

The step size Δ can be chosen to be large enough for the one-dimensional problem so that the quasi-ergodicity can be reduced [\cite=FFD]. However, we follow Frantz et al. [\cite=FFD] and use the scaling [formula], which maintains an approximately 50% acceptance rate at all temperatures β, by considering the application to multidimensional systems. This 50% acceptance is commonly employed in the classical Monte Carlo community [\cite=AT].

Since the error caused by the quasi-ergodicity depends upon the walk initialization, we start the Monte Carlo walk at the global minimum x = 1 and at the metastable minimum x =  - α. If the walk starts at the global minimum, then the average potential < V >  will be low if the walk is quasi-ergodic, as the distribution associated with the higher energy well around α-minimum will be insufficiently sampled. While the walk is initialized at -  α, the walk may be trapped at this metastable α-well and the average potential < V >  will be too high.

In figure 3, we show the average potential energy < V >  calculated from (i) the standard Metropolis Monte Carlo and (ii~  iv) the generalized Tsallis Monte Carlo algorithm as a function of temperature β. Similar curves can be found in figure 2 of reference [\cite=FFD]; however, those authors plotted the results from the usual Metropolis algorithm initialized at the global minimum x = 1 and at the random positions. In order to check the quasi-ergodicity of the walk, we instead show two curves initialized at the global minimum x = 1 and the metastable α-minimum at x =  - α for each scheme. The average potential < V >  is obtained from 100 independently initialized walks, each consisting of 500 warm-up steps followed by 104 steps with data accumulation. The average energy < V >  calculated from the standard Metropolis algorithm shows large errors due to the quasi-ergodicity. In particular, the walk initialized at the metastable α-minimum greatly overestimates the potential energy. The walk starting from the global minimum also shows noticeable error and underestimates the average energy, as expected.

In contrast to the results from the standard Metropolis algorithm, the results from the generalized Monte Carlo algorithm [\cite=AS2] [\cite=AS3] show excellent agreement with the numerically exact result. The walks started from the global minimum x = 1 produce the average energy which is almost indistinguishable from the exact result up to the lowest temperature (high β) examined. Even the walk started from the metastable α minimum produces the energies that are fairly accurate up to rather low temperature β  ~  15 for q = 1.5, which shows that this generalized algorithm does a much better job than the standard Monte Carlo scheme. The agreement with the exact result is further improved if we increase the value of parameter q from 1.5 (see Figure 3). It should be noted that the probability distribution associated with the parameter q = 2 is given by the Cauchy distribution and with q > 5 / 3 by the super-diffusive Lévy distribution [\cite=TS]. The theoretical upper boundary is q = 3. The quasi-ergodicity can be largely circumvented by the use of Tsallis's generalized statistical mechanics with q > 1, as shown in figure 3.

In order to overcome the quasi-ergodicity, the Monte Carlo walk has to pass many times through the energy barrier. Figure 4 compares the time series of the Monte Carlo walk generated by the standard Monte Carlo scheme (q = 1) and that of the generalized Monte Carlo scheme. Similar diagrams can be found in reference  [\cite=AS3]. Although the trajectory of the standard Monte Carlo scheme is mostly confined within the metastable α minimum, the number of barrier crossing of the Tsallis Monte Carlo scheme is significantly greater. This barrier crossing occurs more often when the parameter q is larger. The quasi-ergodicity can be removed by Tsallis's generalized Monte Carlo scheme by increasing the magnitude of the parameter q from 1.

In figure 5, we show the average energy < V >  as a function of the asymmetry parameter γ. Again a similar diagram can be found in reference [\cite=FFD]. Here again we can clearly observe a large error for the initialization at the metastable α minimum when the standard Monte Carlo procedure is used. In this case, the superiority of Tsallis's generalized Monte Carlo scheme over the traditional one is also obvious.

In table 1 we showed the effect of quasi-ergodicity in the convergence when γ = 0.9 and β = 10 for both the standard Monte Carlo and the generalized Monte Carlo algorithms with q = 1.5, each originating at the metastable α-minimum. We show the average energy < V >  and the standard deviation (STD) obtained from 100 independently initialized walks. We found that the problem of quasi-ergodicity obtained with the standard Metropolis algorithm is still present, even if we increase the number of Monte Carol steps. On the other hand the result from the generalized Monte Carlo simulation is significantly improved by increasing the number of Monte Carlo steps, and ergodicity can be recovered. Furthermore, STD decreases as [formula] when the Monte Carlo step N is increased for the generalized Monte Carlo simulation, while such a systemic decrease is not observed for the standard Monte Carlo simulation.

This convergence can be clearly visualized by plotting the visiting probability P(x) of the Monte Carlo walks, which should be given by the Boltzmann weight for the standard Monte Carlo scheme and by the Tsallis weight ([\ref=eq:3]) for the generalized Monte Carlo scheme. In figure 6, we compare P(x) generated by the standard and generalized Monte Carlo walks with the Boltzmann and the Tsallis weights. The visiting probability P(x) converges rapidly to the Tsallis weight as the number of the Mone Carlo walks is increased for the generalized Monte Carlo scheme. On the other hand, P(x) recovers the Boltzmann weight only when the Monte Carlo steps are increased upto ~  106 in the standard Monte Carlo scheme.

It is also interesting to discuss the convergence in the context of the "generalized ergodic measure" of Thirumalai, Mountain, and Kirkpatrick [\cite=TMK] [\cite=AS3]. Using the energy metric, the ergodic measure dV(n) is defined by

[formula]

where Va(n) and Vb(n) are the move average of the potential energy V along the trajectories a and b, which are defined from ([\ref=eq:12x]) by

[formula]

for the generalized Tsallis Monte Carlo scheme, and

[formula]

for the standard Monte Carlo scheme. For an ergodic system, Thirumalai et al. [\cite=TMK] suggested that the ergodic measure converges as dV(n)  →    ∞   if n  →    ∞  . They found that

[formula]

where the "diffusion" constant DV depends on temperature. In figure 7, we show dV(0) / dV(n) for γ = 0.9 potential obtained from 100 independent pairs (a, b) of Monte Carlo walks as a function of Monte Carlo steps n. We chose the trajectory starting from the metastable minimum x =  - α (=-0.9163) and that from the stable minimum x = 1, respectively, as the two independent trajectories a and b. It is clear from figure 7 that the normalized inverse of the ergodic measure dV(0) / dV(n) grows linearly with the Monte Carlo steps n. Therefore, the ergodic measure dV(n) decreases according to ([\ref=eq:20]), and the diffusion constant DV can be determined.

Figure 8 shows the diffusion constant DV as a function of temperature β. The diffusion constant is a decreasing function of the inverse temperature β; it is more difficult to recover the ergodicity when the temperature is lowered. However, at lower temperatures β > 20 with βΔV > 1 where ΔV = V( - α) - V(1) = 0.1, the diffusion constant starts to increase again for the Tsallis Monte Carlo walks (q  ≠  1). This is due to the fact that the equilibrium thermal distribution around the metastable minimum at x =  - α becomes negligibly small at such low temperatures, and the ergodicity of the trajectory among the stable and the metastable minima is irrelevant once trajectories a and b both fall into the stable minimum around x = 1.

It is apparent from figure 8 that the diffusion constant DV obtained from the standard Monte Carlo algorithm obeys the usual activation form

[formula]

where the activation energy Eb is estimated to be Eb≃0.4, which is the same order of magnitude as the barrier height (~  1) between two wells, as shown in figure 1. On the other hand, the diffusion constant DV obtained from the Tsallis generalized Monte Carlo scheme is characterized by a power-law form

[formula]

with the exponent η. This result is conceivable, based on the acceptance probability ([\ref=eq:7]) using the Tsallis weight, because

[formula]

and DV  ~  β- q / (q - 1). We note in figure 8 that η  ~  1.6 for q = 1.5 and η  ~  0.85 for q = 2.5. These values are close to q / (q - 1) = 3 for q = 1.5 and q / (q - 1) = 1.66 if q = 2.5. Therefore, the diffusion constant decreases more slowly as a function of the inverse temperature β as β-  η for the generalized Monte Carlo scheme, though it decreases exponentially faster for the standard Monte Carlo scheme. The exponent η becomes smaller as q is increased and the diffusion is possible even at low temperatures. This result can be anticipated based on data presented in figures 3 and 6. This power-law temperature dependence of the diffusion constant DV for q  ≠  1 has been pointed out by Straub and Andricioaei [\cite=SA2].

Concluding remarks

In conclusion, we found that the so-called "quasi-ergodicity" in a double well potential encountered in the standard Metropolis Monte Carlo algorithm is largely circumvented by the use of the generalized Monte Carlo algorithm of Andricioaei and Straub [\cite=AS2] [\cite=AS3] based on Tsallis's [\cite=TS] generalized statistical mechanics. Therefore this algorithm will be useful in the Monte Carlo study of any system, in particular, when the first order phase transition occurs. We believe that this algorithm will be useful, for example, in the study of the melting transition of clusters for which the J-walk algorithm [\cite=FFD] and the multiple histrogram method [\cite=WA] have been utilized. It is also interesting to apply this new algorithm to the problems where the slow dynamics due to randomness or frustration is serious, for example, the spin-glass problems. This generalized Monte Carlo algorithm based on Tsallis's statistical mechanics use the reweighting technique similar to the multicanonical method [\cite=BN]. But this algorithm is much simpler than the multicanonical methods and appears to be more promising because it does not require an iterative determination of the weighting factor by preliminary Monte Carlo runs.

Recently, a new formulation of the Tsallis statistics has been proposed [\cite=TMP]. With a new choice of energy constraint, unfamiliar consequences in the previous formulation have been erased. However, the Lagrange parameter used in the new formulation can be related to that in the previous formulation. Therefore, in performing Monte Carlo simulations with reweighting technique, we may use the previous formulation of the Tsallis statistics.

Acknowlegement

Authors are grateful to the reviewer for several useful comments which were incorporated into the final version of the manuscript. M. I. acknowledges support from the Hiroshima City University Grant for Special Academic Research. He is also grateful to the Department of Physics, Tokyo Metropolitan University, where this work was initiated, for its hospitality to him.