Lemma Proposition Corollary Assumption

Enumerating simple paths from connected induced subgraphs

Keywords: Directed graph; self-avoiding walks; simple cycles; Hamiltonian paths; dominating sets; trace monoid; labeled adjacency matrix;

MSC: 05C22, 05C30, 05C38, 05E99

Introduction

Counting simple paths, that is trajectories on a graph that do not visit any vertex more than once, is a problem of fundamental importance in enumerative combinatorics [\cite=madras2013self] with numerous applications, e.g. in sociology [\cite=Ross1952] [\cite=Cartwright1956]. Several exact formulas for counting simple paths have been discovered over the last 60 years. They make use of a variety of tools such as the inclusion-exclusion principle [\cite=bax1993inclusion] [\cite=Bjorklund2010] [\cite=karp1982dynamic], recursive expressions of the adjacency matrix [\cite=Khomenko1972], sieves [\cite=bax1996finite] or immanantal equations [\cite=cash2007number].

Maybe one of the most elegant result of this sort comes from a recent unpublished work by Perepechko and Voropaev [\cite=Perepechko2009], who obtained an exact formula for the number of simple cycles of a given length in the graph, involving a sum over all induced subgraphs. While the result only applies to cycles, we show that it can be extended to count simple paths with any specified end points. This leads to a unification of several known formulas for counting simple paths into a single matrix equation. In spite of its higher level of generality, our proof relies on a simple binomial expansion.

The generalization of Perepechko and Voropaev's result leads to an important simplification that makes use of the additivity of adjacency matrices of disjoint graphs. Thanks to this property, the generalized formula can be reduced to connected induced subgraphs. From a computational point of view, this reduction is particularly effective for sparse graphs where connected induced subgraphs. A remarkable consequence is an expression that links the Hamiltonian paths of a graph to its connected dominating sets.

Although the original version of Perepechko and Voropaev's result applies to undirected graphs only, all the results presented in this paper are proven for directed graphs and remain valid on weighted graphs. The proofs are surprisingly simple, owing to the use of a particular trace monoid formalism, that induces some desirable algebraic properties to paths, treated as algebraic objects [\cite=GiscardRochet2016]. In this particular setting, a path is defined as a word whose letters are the oriented edges of the graph, endowed with a partially commutative structure. This formalism, developed by Cartier and Foata in 1969 in their seminal work [\cite=cartier1969], has managed to remain inexplicably unnoticed in the graph literature, in spite of its generality and inherent simplicity.

The trace monoid setting used to define paths on the graph is described in Section [\ref=sec:trace]. The matrix generating series [formula] of simple paths in a directed graph G is introduced in Section [\ref=sec:gen], along with our first result, expressing [formula] in function of the adjacency matrix of the induced subgraphs of G. We discuss some implications and how the result stands out in the literature. Finally, we present in Section [\ref=sec:connected] a simplified expression of [formula] and the resulting relation linking the Hamiltonian paths of the graph to its connected dominating sets. Proofs of the results are postponed to the Appendix.

The trace monoid structure of paths

We start by presenting the algebraic structure on paths that was introduced in [\cite=cartier1969]. We argue that this setting is very natural as it coincides with the standard views on paths, cycles or similar typical objects commonly used in graph theory. The objective is to offer a rigorous algebraic formalism that is both general and perfectly suited to describe the objects obtained from analytical manipulations of the adjacency matrix.

Let G  =  (V,E) be a directed graph with vertex set V  =  {1,...,N} and edge set E  ⊆  V2, which may contain self-loops. Each edge (i,j)∈E of the digraph is identified with a letter ωij and endowed with the following commutation rule: two different edges ωij,ωi'j' commute if and only if they originate from different vertices, i.e. if i  ≠  i'. The resulting partially commutative monoid, or trace monoid, is defined as the sets M of finite sequences of letters ωij, called words, obeying this commutation rule. Formally, M is the trace monoid with alphabet ΣM  =  {ωij,(i,j)∈E} and independence relation

[formula]

The multiplication on M is defined naturally as the concatenation: m.m'  =  mm'. Remark that this operation is not commutative in general.

In this setting, a path on the digraph G can be viewed as a word with a contiguous representation. Precisely, a path p of length [formula] is a word composed of [formula] edges that can be rearranged (following to the commutation rule) so that each new edge starts where the previous ends, e.g. [formula]. Paths appear naturally through analytical transformations of the labeled adjacency matrix [formula], with general term [formula] if (i,j)∈E and [formula] otherwise. In this partially commutative framework, paths of a given length k  ≥  1 are enumerated in the k-th power of [formula]:

[formula]

where the sum runs over all paths p of length [formula] from i to j on G. Here, the matrix multiplication uses the multiplication of words, i.e. the concatenation, which is not commutative. Thus, the trace monoid formalism provides a natural way to distinguish paths composed of the same edges but in different orders.

The standard terminology applies to paths, defined as elements of the trace monoid M. A path [formula] is open if its end vertices i,j are different and closed otherwise. A closed path is also called a cycle. An edge ωij is a path of length one from i to j while self-loops ωii and backtracks ωijωji are cycles of length one and two respectively. By convention, the empty path 1 is considered a cycle of zero length.

A non-empty path is simple if it does not visit the same vertex twice, or equivalently, if all its edges commute and are different. This is another important consequence of the trace monoid structure of paths: their definition do not require specifying end vertices. For an open path, the end vertices are inherent to the contiguous representation, which is unique in this case. Indeed, one shows easily that rearranging the edges of an open path into a different contiguous sequence would require to break the commutation rule. Cycles, on the other hand, may have several contiguous representations, each one with a different starting point. For instance, the length 2 cycle ωijωji from i to itself has another contiguous representation, namely ωjiωij, which starts from j. We refer to [\cite=espinasse2016relations] [\cite=GiscardRochet2016] for a more comprehensive description of the framework.

The generating series of simple paths

Expressions for counting simple cycles of small lengths on undirected graphs from traces of the adjacency matrix have been discovered by various authors since the 1950's [\cite=Ross1952] [\cite=Harary1971] [\cite=Alon1997]. In 1972, two Ukrainian mathematicians, Khomenko and Golovko, published an exact formula for counting simple cycles of arbitrary length on any graph [\cite=Khomenko1972]. The formula results from an elaborate use of the inclusion-exclusion principle and involves a function defined through a complicated recursion. Possibly owing to its inherent difficulty and lengthy proof, Khomenko and Golovko's result has remained largely unnoticed. In 2009, the Russian mathematicians Sergey Perepechko and Anton Voropaev managed to greatly simplify the formula of Khomenko-Golovko [\cite=Perepechko2009], likely by solving the difficult recursion equation involved in it. The formula obtained by Perepechko and Voropaev was only announced in a conference talk and, to the best of our knowledge, never published.

Let S be the set of non-empty subsets of V, including V itself. The cardinality of S∈S is denoted by |S|. For a matrix [formula] indexed by the vertices of the graph (typically, the adjacency matrix [formula] or the labeled version [formula]), define the restriction [formula] of [formula] to S∈S by

[formula]

Perepechko and Voropaev's result can be stated as follows.

Let G = (E,V) be an undirected graph on N vertices with adjacency matrix [formula]. The number [formula] of simple (unoriented) cycles of length [formula] is given by

[formula]

where the inner sum runs over all non-empty subsets S  ⊆  V of size i.

Equation [\eqref=eq:PV], which we shall now refer to the Perepechko-Voropaev formula, seems to have had little more impact than Khomenko-Golovko's result so far in spite of its deep elegance. This is possibly because it involves a sum over subgraphs, thus producing [formula] in [formula] operations [\cite=Perepechko2009]. Since the formula was devised primarily within and for a numerical computing community, its value may have been gauged from its sole computational cost.

The alternating signs in the Perepechko-Voropaev formula bears similarities with Bax's approach for counting Hamiltonian paths [\cite=bax1993inclusion], based on the inclusion-exclusion principle. In fact, applying the trace operator to the matrix Hn defined in [\cite=bax1993inclusion] recovers exactly the Perepechko-Voropaev formula for [formula]. In the following, we show how these two results, among others, can be summarized into a single matrix equation. Consider the matrix [formula] whose (i,j)-entry is defined to be the ordinary generating function of simple paths from i to j, i.e.

[formula]

for z a formal variable. The information relative to simple paths and simple cycles on the digraph is entirely summarized in [formula], making it a natural object of interest. Our first result gives an expression of [formula] in function of the labeled adjacency matrices of the induced subgraphs of G. For clarity, we distinguish between open and closed paths, by writing

[formula]

where

[formula] is the matrix generating series of simple cycles. Its i-th diagonal entry is the generating function of the simple cycles visiting i, while the entries outside the diagonal are zero.

[formula] is the generating matrix of open simple paths. For i  ≠  j, its (i,j)-entry is the generating function of simple paths from i to j, and its diagonal is zero.

For a square matrix [formula], we denote by [formula] the diagonal matrix obtained by setting to zero all non-diagonal entries in [formula]. We are now in position to state our first result.

It holds

[formula]

[formula]

where |S| denotes the cardinality of S.

We recover Perepechko-Voropaev's formula by attributing the value ωij = 1 to all directed edges, thus replacing [formula] by [formula], and taking the trace of [formula] in Theorem [\ref=th:matrix]:

[formula]

On the other hand, it follows from the definition of [formula],

[formula]

and identifying the coefficients of degree [formula] in [formula] recovers Eq. [\eqref=eq:PV], up to a factor 1 / 2 . This provides a simple proof of the Perepechko-Voropaev formula, which otherwise only follows from Khomenko and Golovko's difficult approach. It shows furthermore that the formula is valid on directed graphs and for cycles of length [formula].

Counting simple paths from weakly connected sets

A digraph is said to be weakly connected if replacing all its directed edges by undirected edges produces a connected undirected graph. The expression of [formula] can be reduced to a sum over weakly connected subgraphs of G owing to the simple property that the adjacency matrix of a digraph with more than one weakly connected component is block diagonal. In particular, letting [formula] be the decomposition of G(S) into weakly connected components, we have for all n  ≥  1,

[formula]

Let C  ⊆  S denote the non-empty subsets of V for which the resulting induced subgraph is weakly connected. For C∈C, the weak neighborhood N(C) of C in G is the set of vertices in [formula] that can reach and/or be reached from C in one step. Formally,

[formula]

Of course, this definition recovers the classical definition of neighborhood in undirected graphs.

The matrix generating series of open and closed simple paths verify:

[formula],

[formula].

From a computational point of view, the restriction to weakly connected subgraphs provides a clear improvement for counting simple paths, especially for sparse graphs for which connected induced subgraphs are relatively rare.

A direct application concerns Hamiltonian paths, i.e. simple paths of maximal length, which appear in the terms of maximal degrees in the expressions of [formula] and [formula]. From the formulas in Theorem [\ref=th:matrix_connected], the terms of maximal degrees correspond to connected subsets C such that [formula], i.e. dominating sets. This leads to an expression of the number of Hamiltonian paths that only involves the connected dominating sets of G.

For the next result, we denote by [formula] the Hamiltonian path counting matrix, whose (i,j)-entry gives the number of Hamiltonian paths from i to j.

Let D be the set of weakly connected dominating sets in G,

[formula]

The number of (oriented) Hamiltonian cycles appears in any diagonal entry of [formula],

[formula]

where N  -  |D| can be replaced by |N(D)| due to the dominating property. This expression improves on Bax's and Khomenko and Golovko's (Theorem 4 in [\cite=Khomenko1972]) results for Hamiltonian cycles in that the sum is restricted to connected dominating sets. Similarly, the total number of open Hamiltonian paths follows by summing all non-diagonal entries of [formula].

A quick inspection of the proof reveals that, similarly as for [formula], open and closed Hamiltonian paths can be dealt with separately yielding a slightly stronger version of the result, namely

[formula]

From a computational point of view, Proposition [\ref=cor:hamil] shows that the problem of counting Hamiltonian paths in a digraph can be polynomially reduced to enumerating the weakly connected dominating sets. For undirected graphs, the later issue has received some attention in the literature [\cite=haynes1998fundamentals], although the algorithms developed in this purpose mainly focus on minimal connected dominating sets [\cite=kante2011enumeration]. Nevertheless, connected dominating sets are easily tractable from the minimal ones by adding arbitrary vertices. We believe that this simplification may suffice to reduce the time complexity of some of the algorithms mentioned in [\cite=Bjorklund2010] for counting Hamiltonian paths, although further work is necessary at this point.

Acknowledgements

P.-L. Giscard is grateful for the financial support from the Royal Commission for the Exhibition of 1851.

Appendix

Proof of Theorem [\ref=th:matrix].

For a path p, V(p) denotes the set of vertices visited by p (its support). To prove the first part, write

[formula]

We exploit the fact that a path p is both simple and open if, and only if, [formula]. For a path p from i to j to appear in the (i,j)-entry of [formula], one needs that V(p)  ⊆  S and [formula]. Thus, the coefficient of [formula] in the right-hand side of the above equation is given by

[formula]

It is now only a matter of simplification to show that this coefficient equals 1 if [formula] (i.e. if p is a simple open path) and 0 otherwise. For the second part, the matrix

[formula]

is diagonal by construction and thus only involves cycles. To prove that it is the generating matrix of simple cycles, we rely on the same trick to notice that a cycle c is simple if, and only if, [formula]. Using the same argument as for the first part, the coefficient of a cycle c in the above expression follows by

[formula]

which ends the proof. [formula]

Proof of Theorem [\ref=th:matrix_connected]

We prove the result for [formula], the argument is similar for [formula]. We have, from Theorem [\ref=th:matrix]

[formula]

Let C  ⊆  V such that G(C) is weakly connected (i.e. C∈C). We regroup the terms of the sum involving [formula] which correspond to subsets S containing C as a weakly connected component. These subsets are of the form [formula] for [formula]. We have

[formula]

Let k  =  N  -  |C|  -  |N(C)|, remark that

[formula]

Thus,

[formula]

The proof for [formula] is identical. [formula]

Proof of Proposition [\ref=cor:hamil].

Take [formula] in Theorem [\ref=th:matrix_connected] and isolate the term of maximal degree. In [formula], this term writes

[formula]

where we used that |N(D)| = N - |D| due to the dominating property. This provides the off-diagonal part of [formula]. Its diagonal part follows from noting that simple cycles of length N appear in every term of maximal degree in [formula]. [formula]