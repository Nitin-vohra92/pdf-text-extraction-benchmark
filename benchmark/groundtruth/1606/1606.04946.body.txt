The number and size of subhalo-induced gaps in stellar streams

, Vasily Belokurov1

, Jo Bovy2

, and Jason L. Sanders1

1Institute of Astronomy, Madingley Road, Cambridge, CB3 0HA, UK 2 Department of Astronomy and Astrophysics, University of Toronto, 50 St. George Street, Toronto, ON M5S 3H4, Canada

Introduction

To date, only two promising techniques have been put forward to detect individual low-mass dark matter (DM) clumps devoid of stars. The presence of these so-called DM subhaloes may be betrayed by small perturbations in the images of cosmological gravitational lenses [\citep=Mao1998] [\citep=Dalal2002] [\citep=Hezaveh2013], or, alternatively, be revealed by gaps in the stellar streams around the Milky Way (MW) galaxy [\citep=ibata_et_al_2002] [\citep=johnston_et_al_2002] [\citep=siegal_valluri_2008] [\citep=carlberg_2009]. In principle, through gravitational lensing it might be possible to detect subhaloes with masses as low as [formula], and, encouragingly, measurements have already been reported of DM subhaloes with [formula] [\citep=Vegetti2010] [\citep=Vegetti2012] [\citep=Hezaveh2016]. This is reassuring, as many dwarf galaxies have been shown to exist around the Milky Way with masses similar to that or lower [\citep=belokurov2013]. Moving forward, gaps in stellar streams offer the possibility to pin down the DM mass spectrum below the dwarf galaxy threshold, in other words in the completely dark regime [\citep=subhalo_properties]. The importance of such a direct observational tool is difficult to overestimate, as ΛCDM expects any MW-size galaxy to be bathed in a plethora of DM subhaloes, with an overwhelming prevalence of low-mass objects [\citep=springel_et_al_2008].

Over the last decade, detection of DM subhaloes via gaps in stellar streams has evolved from a plausible idea into an imminent measurement. This is because the haul of cold stellar streams (the prime contender to carry marks of an interaction with low-mass DM subhalos) has risen to at least a dozen structures [\citep=stream_book_grillmair_carlin] thanks to high-quality data from all-sky imaging surveys like SDSS [\citep=sdssdr9], VST ATLAS [\citep=shanks2015] and DES [\citep=des_survey]. While the original survey data is clearly deep enough to identify the streams, it is likely too shallow to warrant an unambiguous detection of low-amplitude density fluctuations caused by DM subhalo flybys. Nonetheless, candidate gaps have been reported in Pal 5 [\citep=pal5disc] and GD-1 [\citep=gd1disc] streams using the SDSS photometry alone [\citep=carlberg_pal5_2012] [\citep=carlberg_gd1_2013]. Curiously, the majority of these gaps are smaller than [formula] in size, seemingly in agreement with ΛCDM-inspired predictions [\citep=yoon_etal_2011] [\citep=carlberg_2012] [\citep=ngan2014]. The consensus in the literature is that the cosmological structure-formation predictions can be tested by measuring the shape and the normalisation of the gap size spectrum. Thus, the intuition is that the incidence of gaps encodes the sub-halo volume density in the vicinity of the stream, and the gap size is linked to the mass of the dark perturber. Recently, [\cite=ibata_et_al_pal5] measured the stellar density along the Pal 5 stream to a significantly fainter magnitude limit. Interestingly, they found no evidence for gaps on small scales.

It appears, therefore, that the preliminary studies of the density fluctuations in the SDSS stellar streams might have erred on the side of risk, when considering the possible false positives. This is perhaps unsurprising as the interplay between the survey systematics and the stellar halo density field at faint magnitudes has not been studied in detail. The number of stars entering a particular color-magnitude box (used to trace the stream) will depend on the weather conditions at the epoch of observation. More precisely, sky brightness and seeing will determine the object detectability and the efficiency of star-galaxy classification. Unfortunately, only global estimates of the SDSS completeness exist [\citep=sdss_edr] [\citep=sdss_dr2]. Temporal changes in completeness and star-galaxy separation efficiency may therefore be reflected in spatial variations of the faint star counts. For example, in Figure 1 of [\citet=koposov_2012], a stripy "patchwork" appearance of the SDSS stellar density distribution can be observed, which remains visible - albeit slightly subsided - even after application of the "uber-calibration" procedure to the SDSS photometry [\citep=sdss_ubercal]. Coupled with weather conditions, SDSS survey geometry can potentially induce spurious variations in the density field of faint stars on a variety of angular scales. The SDSS footprint consists of [formula]-wide stripes, each comprising of [formula]-wide strips. Thus, spurious power may be added on scales of [formula] degrees and down to a small fraction of a degree, the latter due to the fact that individual stripes can overlap by different amounts depending on the distance from the survey poles. Worse still, because only a portion of a strip can be completed during one night (an SDSS "run"), bogus density fluctuations may exist on scales of several to tens of degrees due to changes in epoch (and hence weather conditions) along the individual stripe. Furthermore, various other sources of spurious density fluctuations are expected to exist, such as those associated with large scale structure and saturated stars. Naturally, many authors attempt to mitigate against the above problems by limiting their stellar samples to brighter magnitudes, e.g. r < 22. However, some of the issues discussed may unfortunately be exacerbated by the breakdown of the star-galaxy separation even at brighter magnitudes. While, globally, the SDSS completeness is 95% at r = 22.2, the star-galaxy separation is 95% correct at only r = 21. This deteriorates to 90% at r = 21.6 [\citep=annis2014]. This erroneous morphological classification can lead to spurious clumping in stellar density maps induced by the leakage of power from galaxy distributions as illustrated, for example, in Figure 4 of [\cite=koposov2008].

Deeper follow-up imaging with better seeing and under a darker sky, additionally conforming to a different mosaic geometry, would naturally do away with most of the artifacts discussed above. But if the number and size of gaps reported earlier were in agreement with ΛCDM, does it mean that the null detection reported by [\citet=ibata_et_al_pal5] is in tension with the predictions of cosmological structure formation theory? Motivated by this conundrum, we re-visit the expectations for the frequency and the scale of gap creation. The first comprehensive attempt to describe the spectrum of stream gaps due to interactions with DM subhaloes can be found in [\cite=yoon_etal_2011] who lay out a simple framework to count the number of subhalo flybys near a stream. For example, for the Pal 5 stream, they estimated ~  5 close flybys for subhaloes with masses in the range of [formula]. Exactly how large and deep a gap these flybys would create, and hence how detectable they would be, depends on the flyby geometry and the flyby velocity. [\cite=carlberg_2012] made the first attempt to answer this question by combining a similar flyby counting technique as [\cite=yoon_etal_2011] with fits to the properties of gaps created by subhalo flybys.

In this work, we will build on the approaches of [\cite=yoon_etal_2011] and [\cite=carlberg_2012] by using a similar estimate for the number of subhalo encounters, while determining the effect of each flyby based on the results of [\cite=three_phases]. Theirs is an analytic model of the gap properties for density perturbations induced in streams on circular orbit. The advantage of this approach is that the analytic model works for any flyby geometry. This allows us to sample a wide range of encounters and determine the distribution of gap properties expected for a given stream and subhalo distribution. The assumptions of this method, both the flyby rates and their properties, as well as the gap properties, are tested against numerical simulations. Our predictions also account for the expected depletion of subhaloes by the Milky Way disk in the inner regions of the Milky Way [\citep=donghia_et_al_2010]. With this approach we find that dramatically fewer gaps are expected than the results of [\cite=yoon_etal_2011] and [\cite=carlberg_2012] suggested. In addition, we present predictions for the distribution of gap sizes expected from a ΛCDM spectrum of subhaloes and find that the characteristic size is rarely lower than several degrees, i.e. typically, an order of magnitude larger than that searched for by [\citet=ibata_et_al_pal5]. Thus this paper will demonstrate that the lack of small-scale gaps in Pal 5 is not in tension with ΛCDM.

The paper is organized as follows. In Section := the rate and properties of the subhalo flybys are derived. Next, in Section := we review and test the model of gap growth which translates the flybys into gap properties. In Section := we use this formalism to examine how the distribution of gap sizes and depths changes for various subhalo masses and stream ages. We also give the distribution of gap sizes expected from a ΛCDM population of subhaloes. In Section := we predict the number of gaps in six cold streams around the Milky Way and find significantly fewer gaps than was previously expected. The model of the rate and properties of the flybys, as well as the gaps they produce, is tested with N-body simulations in Section :=. We discuss implications of this work for gap searches, possible contamination from giant molecular clouds, and limitations of the method in Section :=. Finally, we conclude in Section :=.

Setting up subhalo-stream encounters

In order to compute the expected number of stream gaps, we must first compute the expected number of subhalo flybys, as well as their velocity distribution relative to the stream. The expected number of flybys is controlled by the velocity distribution of the subhaloes as well as their number density. Our approach is similar to that in [\cite=yoon_etal_2011] with several amendments. First, we will present a modified version of their derivation which correctly accounts for the velocity distribution of subhaloes. Second, we will use a lower number density of subhaloes since the presence of a baryonic disk in the Milky Way will deplete substructure by a factor of 2-3 [\citep=donghia_et_al_2010]. Finally, we will use a higher subhalo velocity dispersion motivated by models of the Milky Way and cosmological simulations. Below, we will assume that the subhaloes are uniformly distributed and that each component of their velocity follows a normal distribution with a mean of zero and a dispersion of σ. This is sometimes referred to as an isotropic Maxwellian distribution. We will also neglect the size of the stream, treating it as a line, and assume that each star in the stream is just moving along this line, thus neglecting the velocity dispersion in the stream.

Expected number of flybys

The effect of each subhalo flyby depends on the impact parameter to the stream. Both [\cite=yoon_etal_2011] and [\cite=carlberg_2012] set up a straightforward scheme to count the number of subhaloes which pass within a given distance, b max, of the stream. We will now present a slightly modified version of their calculation and explain the difference with their result.

We consider a cylinder of radius b max around the stream, as shown in Figure :=. The number of subhaloes piercing this cylinder in some time interval, dt, is given by

[formula]

where l is the length of the stream and vr is the cylindrical radial velocity in the stream coordinates, i.e. perpendicular to the motion of the stream. If we only consider the side of the cylinder and not the end caps, the flyby rate only depends on vr. Since the radial velocity is just a projection of the cartesian velocities, P(vr) is also a Gaussian with a mean of zero and a dispersion of σ.

Integrating over the negative radial velocities, i.e. those that are about to enter the cylinder, we get

[formula]

We can also compute the total number of encounters the stream will have by accounting for the growth of the stream in time. Assuming that the stream growth is linear in time, [formula], if we integrate the encounter rate until the present time, when the stream has a length of lobs, we get

[formula]

A similar result is presented in [\cite=yoon_etal_2011], who used lobs = 4(t / Tψ)RcircΔΨ where ΔΨ is the angular growth per orbit, Tψ is the angular period, and Rcirc is the orbital radius of the stream. Plugging this value of lobs into Equation (:=), we get

[formula]

This can be now compared with equation 15 of [\cite=yoon_etal_2011] in the limit that their encounter velocity, venc, is taken to infinity, where we find that the number of encounters in this work is [formula] smaller. The difference is due to what is assumed about the radial velocity distribution, P(vr), which is used in Equation (:=). While we have argued that this distribution should be a Gaussian, [\cite=yoon_etal_2011] instead used the relative speed distribution between two particles drawn from an isotropic Maxwellian distribution. This overestimates the radial velocity and hence the flux into the cylinder. We also note that our rate of flybys agrees with the rate per length derived in equation 3 of [\cite=carlberg_2012].

To confirm that this rate is correct, we perform a simple numerical test. We take a cloud of particles with positions drawn from a uniform distribution. Each particle is assigned a velocity drawn from a normal distribution with σ  =  100 km/s in each component. The particles are stepped forwards in time and we count the number of particles entering a cylinder, representing the region near a stream, which had a height of 20 and a radius of 1 in arbitrary units. We show the comparison in Figure := as a function of the stream velocity, vs. We see that our simple model in Equation (:=) captures the bulk of the numerical encounter rate. We also see that the numerical rate has a slight dependence on the stream velocity which is due to subhaloes passing through the end caps of the cylinder. In Appendix := we derive the rate of subhaloes entering through the end caps which is presented in Equation (:=). We show this model in Figure := as the dashed red line and we find that it matches the numerical result.

Velocity Distribution of Flybys

The distribution of flyby velocities is critical for understanding the gaps which subhaloes create since the encounter geometry and velocity affects the gap properties [\citep=three_phases]. While the velocity distribution of subhaloes in the galaxy is given by a Gaussian in each direction, the distribution of the subhaloes that interact with the stream, i.e. those that pass within b max, is not. First, the stream is moving in a given direction. The relative velocity in this direction, [formula], is given by

[formula]

where vs is the velocity of the stream. The distribution of the velocity perpendicular to the stream's motion, [formula], can be derived by considering the distribution of the radial and tangential velocity relative to the stream. As subhaloes enter a cylinder with radius b max around the stream, they have a radial velocity, vr, and a tangential velocity, vθ. As we saw in Section :=, the rate at which particles enter this cylinder is proportional to their radial velocity, e.g. Equation (:=). Thus, the radial velocity distribution of subhaloes is given by

[formula]

Note that this distribution is only nonzero for negative vr, i.e. for the subhaloes heading towards the stream. The velocity distribution in the tangential direction, P(vθ|b max), is Gaussian with a mean of zero and a dispersion of σ. By combining these two velocities into [formula], we find

[formula]

Equation (:=) and Equation (:=) give us the velocity distribution of the subhaloes which have passed near the stream. The dispersion of the flyby speed, [formula], is given by

[formula]

From Equation (:=) and Equation (:=) we see that the distribution of relative speeds is not simply the relative speed distribution of two particles drawn from an isotropic Maxwellian distribution. This is because the radial velocity distribution is biased since subhaloes with higher radial velocities towards the stream are more likely to enter a region near the stream, i.e. Equation (:=). As in Section :=, we can check these velocity distributions against a numerical example of subhaloes distributed uniformly in position with an isotropic Maxwellian velocity distribution and look at the properties of subhaloes which enter a cylinder around the stream. In Figure := we compare the numerically derived velocity distribution against our model and find excellent agreement. For contrast, we also show the velocity distribution of particles inside the cylinder and the relative speed distribution assumed in [\cite=yoon_etal_2011]. We also show the velocity distribution of the particles which were initially in the cylinder to emphasize that it is different from those entering the cylinder. For this example we used a velocity dispersion of σ  =  100 km/s, a cylinder with an aspect ratio of 1:10, and a stream velocity of vs  =  200 km/s.

Impact parameter distribution

Now that we have the velocity distribution of particles which enter a cylinder with radius b max around the stream, we can compute the distribution of impact parameters. A particle which enters the cylinder with a radial velocity of vr and a tangential velocity of vθ will have an impact parameter of

[formula]

We can then determine P(b|b max), the distribution of the impact parameters for the flybys within b max, by integrating the velocity distributions over all vr,vθ which have an impact parameter of b, i.e.

[formula]

Thus we see that the impact parameters are distributed uniformly from 0 to b max. At first sight, this result may seem counterintuitive since if we looked at the subhaloes near the stream at any particular time, the distribution of their distances would increase linearly with distance from the stream. However, the impact parameter is the minimum distance between the subhalo's path and the stream track. As such, the impact parameter distribution is really the distribution of distances between two lines in three dimensions, which is independent of distance. Both [\cite=yoon_etal_2011] and [\cite=carlberg_2012] also used a uniform distribution of impact parameters.

Number density of subhaloes

Next, we need an estimate of the number density of subhaloes. [\cite=springel_et_al_2008] studied the number density profile of subhaloes around a Milky Way-like analogue and found that it is well described by an Einasto profile:

[formula]

with α  =  0.678 and r- 2  =  0.81r200  =  199 kpc. They found that this fit worked for all mass ranges of subhaloes they explored, i.e. those from [formula] to [formula]. The host halo they simulated had a mass of [formula]. We will scale this down to a mass of [formula], reducing r200 by [formula] and assume that the scaled down halo has the same concentration and same α. Thus we would expect the same fit with r- 2  =  162.4 kpc. Next we have the spectrum and normalization of the subhaloes. As in [\cite=springel_et_al_2008], we express the subhalo mass function as

[formula]

with [formula], [formula], and n =  - 1.9. Note that this was for the total number within r50  =  433 kpc. Scaling down to a MW mass of [formula] (i.e. scaling the virial radius by M1 / 3 and the number of subhaloes within the virial radius by M), we would get [formula] within 353 kpc. This can now be combined with the density profile to get the correctly normalized subhalo profile

[formula]

with [formula]. Using Equation (:=), the number density of subhaloes in any mass range and location can be computed. We note that we found broadly similar results in the public catalogues of Via Lactea II [\citep=Diemand2008] when we looked at the number of subhaloes within 50 kpc.

This estimate of the number density of subhaloes from the Aquarius simulations [\citep=springel_et_al_2008] is based on a collisionless N-body simulation which neglects baryonic effects. [\cite=donghia_et_al_2010] found that the presence of a disk with a mass of 10% of that of the host galaxy decreases the number of subhaloes at [formula] by a factor of 3. Similar reductions are found over a wide range of masses so we will assume that the disk decreases the abundance of all subhaloes in the inner region by a factor of 3. Furthermore, we assume that the presence of the disk only changes the normalization of the number density of subhaloes but not its shape. As such, we account for the disk's presence by simply dividing the right-hand side of Equation (:=) by 3.

For the properties of individual subhaloes, we make fits to the Mtidal-v max relation to the subhaloes in VLII [\citep=Diemand2008]. If we model the subhaloes as Plummer spheres, where we take the Plummer sphere mass to be Mtidal, this gives a scale radius of

[formula]

If the fit is instead made for a Hernquist profile, the relation would be

[formula]

Velocity distribution of subhaloes

In addition to the number density, we must also specify the velocity distribution of subhaloes. As described above, we assume that the velocity distribution of each component is a Gaussian with a mean of zero and a dispersion of σ. This simplification neglects the velocity anisotropy of subhaloes seen in simulations, as well as the fact that the velocity distributions in simulations are not Gaussian [\citep=diemand_et_al_2004]. In order to make a prediction for the gap properties in streams around our Galaxy, we need an estimate of this dispersion for the inner region, r < 30 kpc, of the Milky Way.

Observationally, the radial velocity dispersion has been measured for a collection of stars, globular clusters, and satellite galaxies and a value of σ  ~  120 km/s within 30 kpc was found [\citep=battaglia_et_al_2005]. This value was also used as the fiducial subhalo velocity dispersion by both [\cite=yoon_etal_2011] and [\cite=carlberg_2012]. However, the velocity dispersion of subhaloes appears to be substantially higher than this. [\cite=piffl_et_al_2015] constructed self-consistent equilibrium models for the Milky Way and found that the dark matter had velocity dispersions of 150-205 km/s near the location of the Sun. [\cite=diemand_et_al_2004] compared the velocity dispersions of dark matter particles and subhaloes in cosmological simulations and found that the subhaloes had a velocity dispersion which is ~  10% higher. The velocity dispersion can also be computed from cosmological simulations of Milky Way-like galaxies. Using the public catalogues of VLII [\citep=Diemand2008], we find velocity dispersions of 160-200 km/s in the three cartesian velocity components for subhaloes within 30 kpc of the Milky Way-analogue, although we note that those simulations do not include the effect of the disk and the halo is more massive than the Milky Way. With these results in mind we take σ  =  180 km/s as our velocity dispersion for each velocity component. It is not immediately clear what this increased velocity dispersion means for the number of gaps since while it will result in a larger number of flybys, i.e. Equation (:=), it will also increase the relative speed of the flybys, i.e. Equation (:=), which results in smaller perturbations to the stream and less pronounced gaps. However, the effect of the velocity dispersion was investigated in [\cite=bovy_erkal_sanders] where they found that the main effect is from the number of flybys and the change in the gap properties is subdominant.

Evolution of the number density of subhaloes

Streams are sensitive to the number density of subhaloes they encounter starting from the epoch of the onset of the progenitor's disruption to present day. However, they only interact with subhaloes in the radial range which the stream explores. [\cite=diemand_et_al_2007] studied the number of subhaloes within a fixed mass aperture in a Milky Way analogue. Their Figure 6 demonstrates that the number of subhaloes within a shell containing the mass fraction M / M200  <  1 / 6 decreases by a factor of almost 3 from z = 1 to z = 0. They show that this mass shell has stabilized between z = 3 and z = 2 so this estimate of the subhalo disruption can also be thought of as for a given radial range. Many of the streams in the Milky Way have been disrupting for a period of time similar to this, and, thus, the change of the subhalo number density with redshift should be taken in account. Although not shown in this work, our numerical experiments indicated that the effect on a stream like Pal 5 is not very significant, likely due to the relatively young age of 3.4 Gyr we assume [\citep=kuepper_et_al_pal5], and thus currently we choose to ignore it. However the older streams like GD-1 might be more affected. We will come back to the importance of the subhalo number density evolution with redshift in future work.

Stream Gap Fabrication

Now that we have computed the rate of flybys, we need a model for the effect of each encounter to determine the detectability of the gap it produces, and hence the number of gaps expected. [\cite=three_phases] presented an analytic model for the evolution of a stream gap after a flyby with an arbitrary geometry, and provided analytic expressions for the width and depth of the gap. As in that work, we define the gap depth as [formula] where ρ and ρ0 are the minimum perturbed density and the unperturbed density respectively. By combining this analytic model with the rate and properties of the flybys described in the previous Section, we can make a prediction for the properties of the gaps. We will provide a forecast for the expected number of gaps deeper than some density threshold, f  <  fcut . A similar approach was taken in [\cite=carlberg_2012] where a rate calculation was combined with fits to the gaps created by N-body simulations of flybys. We note that the gap widths and depths we consider are for an observer at the center of the Galaxy.

Review of gap evolution

[\cite=three_phases] found that the gap growth proceeds in three phases. The first phase, the compression stage, is short-lived and leads to a minor increase in the density near the point of closest approach. We ignore this short-lived phase and instead focus on the second and third phases, the expansion and the caustic phase respectively, where the gap is created and then becomes wider and deeper.

During both the expansion and the caustic phase, the gap depth, is given by

[formula]

where γ is related to the host's gravitational potential, ψ(r):

[formula]

During the expansion phase, the size of the gap is given by

[formula]

The expansion phase continues until the caustic timescale,

[formula]

after which the caustic phase begins and the gap size is given by

[formula]

These expressions describe the average time evolution of the gap density and size. Thus, given any impact, we can rapidly compute the density and size of the gap. By integrating over the impact parameter, subhalo velocity, and impact time, we can determine the distribution of gaps that are created. In this work we will assume that the rotation curve is locally flat and hence that γ2  =  2.

These expressions were derived assuming that the unperturbed stream is on a circular orbit and neglect both the eccentricity of the stream's orbit, and the energy and angular momentum dispersion in the stream. These effects were studied in [\cite=sanders_bovy_erkal_2015] which found that while the picture in [\cite=three_phases] is mostly correct, the dispersion in the stream can cause the density in gaps to plateau and that gaps can grow at slightly different rates depending on their location along the stream due to energy sorting of debris.

Effective N-body Simulation

In order to test the limits of the analytic picture above, we need to compare it against simulations. Since an N-body disruption of a globular cluster progenitor can take several tens of CPU hours to run, it is not feasible to investigate a large number of flybys. Instead, we have developed an effective N-body simulation where we first run a disruption of a progenitor to produce a stream. We then take an earlier snapshot of the simulation and compute the velocity kicks from a single subhalo flyby using the impulse approximation, accounting for the stream curvature as in [\cite=sanders_bovy_erkal_2015]. The particles whose fractional energy change due to the kick is larger than some threshold are then evolved to the final time as tracers in the host potential. The particles within the progenitor do not receive a kick since they will be affected by the gravitational field of the progenitor and cannot be treated as tracers. At the final time, the perturbed particles are combined with the unperturbed particles from the final snapshot to give all particles in the stream. This method allows us to rapidly evaluate the gap profile from a variety of impacts.

For the N-body simulation, we simulate a Pal 5-like stream whose progenitor matches the measured line-of-sight velocity and proper motions in [\cite=kuepper_et_al_pal5] at the present time. These simulations are performed with the N-body part of gadget-3 which is similar to gadget-2 [\citep=springel_2005]. The progenitor is modelled as a King profile with a mass of [formula], a scale radius of 15 pc, w = 2, and is modelled with 105 equal mass particles and a softening of 1 pc. The progenitor is evolved in the MWPotential2014 potential given in [\cite=bovy_galpy] with the bulge replaced with a Hernquist profile with [formula] and a scale radius of 0.5 kpc. The simulation is run for 5 Gyr and snapshots are stored every 10 Myr.

We considered a wide range of impactors from 105 to [formula] and found that evolving the particles whose change in energy exceeded a threshold of ΔE / E  ≥  0.1 was sufficient to reproduce the effect of the flyby. These simulations allow us to gauge when our simple analytic model begins to break down, i.e. when the velocity kicks become sufficiently small that the velocity dispersion in the stream becomes important, as well as when particles begin to fill in the gap. Specifically, we consider a [formula] subhalo and sample a grid of subhalo velocities in each direction, - 500 to 400 km/s in steps of 100 km/s, a grid of impact parameters, from 0 to 1 kpc in steps of 0.1 kpc, and four different impact times of 1,2,2.08, and 3 Gyr ago. We find that the flybys which have a maximum velocity kick of Δv  ~  0.1 km/s can still produce an appreciable gap depth as shown in Figure := where we compare the maximum velocity kicks for gaps of different ages. Somewhat surprisingly, this is substantially smaller than the velocity dispersion in the stream, σ  ~  1 km/s. We note that this cutoff to produce appreciable gaps will depend on the mass of the progenitor.

The same simulations can be used to test the density formula given in Equation (:=). We use the same grid as described above for the impacts 1 Gyr ago. For each flyby, the expected density using Equation (:=) is also computed. These are compared in Figure := which demonstrates that while the gaps do get filled in (the numerical density is slightly higher than the analytic approximation), the agreement is rather good. We note that the level of agreement depends on the phase at which the gap is observed and that the numerical gap depth oscillates between being deeper and shallower than our analytic prediction depending on this phase. Thus our analytic model should be thought of as giving the average evolution of the gap depth.

Expected Properties of stream gaps

With the method now in place, the properties of gaps created by a distribution of subhaloes can be explored. First, we consider a single subhalo and find the properties of the gaps it creates. It turns out that the stream gaps produced by a single DM clump have a characteristic size which depends on the age of the stream. Then, we consider subhaloes with masses drawn from the ΛCDM distribution and examine the properties of the gaps thus created. In this section, the properties of the fiducial stream model, i.e. its age, velocity dispersion, and orbital properties, are chosen to be similar to those of the Pal 5 stream given in [\cite=kuepper_et_al_pal5], namely we assume the age of the stream is 3.4 Gyr and that it is on a circular orbit with a radius of 13 kpc and a velocity of 220 km/s [\citep=bovy_et_al_2012].

Gap density threshold and minimum gap size

When discussing observable gaps, we must introduce a density threshold below which the gap can be detected. As we saw in Section :=, subhalo flybys can produce arbitrarily shallow gaps which evidently will not be observable. However, since the gap size and gap depth both grow with time, in order for a gap to be deeper than some threshold, the gap must have grown to a certain extent. Thus, gap density and gap width are closely linked, and a gap density threshold gives a corresponding minimum gap size. Expressions for the gap size are given in Equation (:=) and Equation (:=). If the gap has a depth of f = ρ  /  ρ0, this gives a gap size of

[formula]

in the expansion phase and

[formula]

in the caustic phase, where

[formula]

Thus we see that a deep gap with f  ~  0.5 will have a gap size of several B as seen from the center of the galaxy. The value of B is the smallest for a direct impact where the relative velocity is perpendicular to the stream's motion. In this case, [formula]. For example, if the stream is located at a typical Galactocentric distance we assume for Pal 5, r0  ~  13 kpc, a modest impactor with a mass of [formula] with a scale radius of rs  ~  500 pc will have [formula]. Likewise, a smaller subhalo with a mass of [formula] and a scale radius of rs  =  100 pc will have [formula]. Therefore, it is clear that the smallest gap size will be at least [formula] and likely larger since most of the impacts will not be direct and will have velocity components which are aligned with the stream's motion. As a result, it is required that deep gaps should be fairly large, at least several degrees, or, in other words, deep gaps smaller than this size are not expected.

Figure := shows how the minimum gap size depends on the gap density threshold, fcut. As evidenced by the Figure, even for a [formula] subhalo, the minimum gap size is larger than [formula], while an object with a mass of [formula] will produce gaps in excess of [formula].

Gap size distribution for single subhalo population

Let us now explore the gap size distribution created by a homogenous population of subhaloes with a single mass and scale radius. This can be achieved by sampling the distribution of flyby velocities and impact parameters. In practice, we randomly draw the parallel and perpendicular flyby velocities from Equation (:=) and Equation (:=) respectively, and the impact parameter from a uniform distribution between 0 and b max = 5rs. Finally, we draw the impact epoch from a linear distribution since the stream grows roughly linearly in time [\citep=bovy_erkal_sanders].

Figure := shows the gap size distribution for three different density thresholds, fc. The dashed vertical lines show the minimum gap size given by Equation (:=). We use a Plummer sphere subhalo with [formula] and a size of rs  =  512 pc. We see that as we decrease the density threshold, i.e. as we require deeper gaps, the gap size increases since in the time it takes the gap to achieve such a depth, it will also have grown to a substantial size.

In Figure := we examine how the gap size varies as we change the subhalo properties. We consider three different subhaloes with masses of [formula] and [formula] with scale radii of 162 pc, 512 pc, and 1.62 kpc respectively. As the Figure demonstrates, each subhalo creates gaps with a characteristic scale and this scale increases with the mass of the perturber. Thus, rather intuitively, the gap size is related to the mass of the subhalo which created the gap as was first pointed out in [\cite=yoon_etal_2011]. We also see that even for low mass subhaloes with [formula], the characteristic gap size is [formula], while for those with [formula], the typical width is of order of [formula].

Next, we consider the effect of changing the age of the stream. In Figure :=, we show the distribution of gap sizes created by subhaloes of the same mass, but with three different stream ages. We see that as the stream grows in age, so too do the sizes of the gaps in the stream. This is simply because the gaps in these streams had more time to expand.

Finally, we explore how the gap size depends on the velocity cutoff we use. This cutoff specifies what the maximum velocity of a subhalo kick must be in order to be included. As we discussed in Section :=, our effective N-body simulations suggest that detectable density depletions exist for kicks with Δv  >  0.1 km/s. In Figure := we show the gap size distributions for various Δv thresholds. We see that requiring Δv  >  0.1 km/s captures almost all of the visible kicks so our model is not missing very much in this example. We note that the gaps used in this figure were required to have f < 0.5 and that for shallower gaps, a larger fraction of the kicks would be below the velocity kick threshold.

As we will discuss in Section :=, our approach is based on circular orbits and does not account for the eccentricity of the stream. This eccentricity causes the gap size to oscillate with the galactocentric distance as r- 2, e.g. Fig. 13 of [\cite=sanders_bovy_erkal_2015]. As a result, the distribution of gap sizes will depend on the exact phase at which the stream is measured and our results should be thought of as giving the average behavior of the gap size. These effects are beyond the scope of this work but are included in the recent work of [\cite=bovy_erkal_sanders] who find broadly similar results by studying the power spectrum of the perturbed stream density and find the the majority of the power is on scales larger than 10[formula].

Gap depth for single subhalo population

The detectability of the stream gap depends not only on its size, but also on the density contrast between the center of the gap and the unperturbed stream. This Section therefore looks at the gap depth distribution. We repeat the same procedure as in Section := and sample the appropriate distributions for velocity components, impact parameter, and impact time. Figure := shows the distribution of gap depths imparted by three different mass subhaloes. As the mass of the perturber is decreased, the number of shallow gaps decreases but the number of deep gaps is unchanged. The decrease at the shallow end is due to the imposition of a minimal velocity kick, which affects the lower mass subhaloes more. The convergence for deep gaps is due to the fact that for direct impacts, and hence the deepest gaps, the gap depth itself (i.e. Equation (:=)) does not depend on mass for the scaling between mass and scale radius used here.

In Figure := we show the effect of changing the age of the stream on the distribution of gap depths. As expected, younger streams in which gaps have less time to grow have shallower gaps and older streams have deeper gaps.

Gap size distribution from ΛCDM background

Having looked at the individual facets of the stream gap behaviour, we combine the intuition gained in the previous sub-sections to analyse the gap properties expected from a population of ΛCDM subhaloes. We consider subhaloes with masses in the range [formula]. Subhaloes below this mass range create too small of a velocity kick to cause a significant density depletion. We repeat the same procedure as in Section :=, marginalizing over the flyby velocities, impact parameter, and impact time, as well as marginalizing over the subhalo mass assuming cosmologically motivated halo mass function described above. Figure := gives the expected distribution of gap sizes these subhaloes would create for various gap density thresholds. We see that the peak of the distribution depends on what density threshold is used but for a feasible depth of f < 0.75, the characteristic scale is on the order of several degrees.

In Figure := we show the two dimensional distribution of gap sizes and depths created from a ΛCDM spectrum of subhaloes with masses between [formula]. For shallow gaps, there are a wide range of gap sizes with the larger gap sizes dominating. However, as we proceed to deeper gaps, the lower mass subhaloes become more important which leads to smaller gaps. This somewhat counterintuitive result is due to the requirement of a minimum velocity kick. For deep gaps, this is satisfied for both low and high mass subhaloes and the gap size is dominated by the low mass subhaloes since they are more numerous. However, for shallow gaps, many of the low mass flybys will produce a negligible kick (e.g. Fig. :=) so the shallow gaps have a larger contribution from larger subhaloes and hence larger gaps.

Number of gaps expected in observed MW streams

Now that we have explored the properties of gaps from a realistic population of subhaloes, we can compute these quantities for the stellar streams observed in the Milky Way. Here, we will focus on globular cluster streams since these have the smallest velocity dispersion and hence should be sensitive to the widest range of subhalo masses [\citep=subhalo_properties]. There are at least 13 claimed globular cluster streams to date [\citep=stream_book_grillmair_carlin]. In Table := we give the properties of 6 of these streams. These stream characteristics can be used to make a prediction for the expected number of gaps in each case. To proceed, the estimate of the progenitor mass is obtained from the model of the stream width described in [\cite=stream_width]. Finally, the stream's age can be gleaned using a simple model for the stream growth rate which we will present below. Note that the fiducial stream used in Section := was based on Pal 5 so Figure := shows the distribution of gap sizes expected in Pal 5.

Estimating the age of a stream

As we saw in Section := and Section :=, the properties of gaps depend on the age of the stream. This is because gaps will have had more time to grow in older streams. In addition to changing the properties of the gaps, the age of the stream also determines how many interactions there will have been, as prescribed in Equation (:=). As such, in order to estimate the number of gaps in a stream we need to know the age of the stream. For some of the streams we consider here, dynamical modelling has already been performed using Lagrange point stripping methods, e.g. [\cite=kuepper_et_al_pal5] for Pal 5 and [\cite=bowden_et_al_gd1] for GD-1. This modelling gives an estimate of the age for both of these streams. However, for the other four streams there are no such estimates yet.

Estimating the progenitor mass

Let us use the observed width of the stream to estimate the mass of the progenitor. The evolution of the width of the stream perpendicular to the orbital plane was studied in [\cite=stream_width] for both axisymmetric and triaxial potentials. Here, we will just use the result for spherical potentials that the stream width is given by

[formula]

where m is the mass of the progenitor, rtidal is the tidal radius, and vperi is the velocity of the progenitor at pericenter. For the streams whose orbits we do not know, we will assume they are on circular orbits and the orbital velocity is given by

[formula]

where M( < r) is the mass of the host potential enclosed within a radius of r. For a progenitor on a circular orbit, the tidal radius is given by

[formula]

where γ is given by Equation (:=). For a host galaxy with a flat rotation curve, i.e. a logarithmic potential, we get γ2  =  2. Plugging these into the formula for the width we see

[formula]

Finally, this can be arranged to give

[formula]

Using the widths of these streams reported in [\cite=stream_width] we give the estimates of their progenitor masses in Table :=.

For Pal 5, we assume a circular velocity of 220 km/s at a radius of 13 kpc, as measured in [\cite=bovy_et_al_2012], and get a progenitor mass of [formula], very similar to that reported in [\cite=kuepper_et_al_pal5]. For GD-1, we assume a circular velocity of 220 km/s at a radius of 19 kpc and get a mass of [formula], which is below the range of masses considered in [\cite=bowden_et_al_gd1] although they have broad broad posteriors. Instead of this estimate, we use the central value from [\cite=bowden_et_al_gd1] of [formula] but we will also discuss the gap predictions if GD-1 is as low mass as our method suggests. For Styx, we assume a circular velocity of 190 km/s at a radius of 45 kpc, as measured by [\cite=deason_et_al_2012], and get a mass of [formula]. For Tri/Psc, we assume a circular velocity of 190 km/s at a radius of 40 kpc and get a mass of [formula]. For ATLAS, we assume a circular velocity of 220 km/s at a radius of 22 kpc and get a mass of [formula]. Finally, for Phoenix we assume a circular velocity of 220 km/s a radius of 19 kpc and get a mass of [formula].

Estimating the stream age

With the progenitor mass in hand, we can now estimate the age of a stream. Once again, the stream is assumed to follow a circular orbit. The length of a stream can be estimated by considering small perturbations to the circular orbit of the progenitor and determining how quickly these stars move away from the release point. This is similar to the analysis presented in [\cite=three_phases], where the effect of changing the velocity is considered. However, we must also include the fact that stripped material will be offset from the progenitor in radius, i.e. it is released from the Lagrange points. Thus, we find that the stream length in radians grows as

[formula]

where v is the circular velocity at the radius r. We note that similar expressions have been derived in [\cite=amorisco_2014] (see their equation 20). Equation (:=) can then be re-arranged to give an estimate for the age of the stream in terms of its length and mass, as well as the mass of the host enclosed within that radius. As above, we assume that the potential has a flat rotation curve so γ2  =  2, and turn Equation (:=) into

[formula]

For each of the streams, we give an estimate of their age in Table :=. For Pal 5 we get an age of 3.4 Gyr which matches [\cite=kuepper_et_al_pal5]. For GD-1, if we use a mass of [formula] we get an age of 3.8 Gyr, in the center of the range found in [\cite=bowden_et_al_gd1]. We will use a value of 4 Gyr but we note that if we instead use our inferred mass, we would get an age of 7.7 Gyr, making GD-1 substantially older than previous fits have suggested. We note that the estimates of the progenitor mass and stream age in this section relied on results from circular orbits, however stream modelling for more realistic streams on eccentric orbits can also be used to estimate these quantities more robustly [\citep=gibbons_et_al_2014] [\citep=bovy_2014] [\citep=sanders2014] [\citep=kuepper_et_al_pal5] [\citep=fardal2015] [\citep=bowden_et_al_gd1]. With these ages, we can now estimate the number and properties of the gaps in these streams.

Pal 5

We can now make tailor-made predictions for each of the six streams reported in Table [\ref=tab:obs_streams], starting with Pal 5. Based on Table :=, we will model Pal 5 as being on a circular orbit with a radius of 13 kpc. The number density of subhaloes between [formula] at this radius is 1.01  ×  10- 3kpc- 3. Assuming a flat rotation curve with a circular velocity of 220 km/s found in [\citep=bovy_et_al_2012], we get an orbital period of 360 Myr. Figure := shows the distribution of gap sizes in Pal 5 from subhaloes with a mass in the range [formula]. It predicts that Pal 5 should have a characteristic gap size of [formula] for deep gaps with f < 0.5 but the distribution is quite broad. This also guides the scales on which one should be looking for gaps in Pal 5.

In addition to the distribution of gap sizes, we can also compute the expected number of gaps. We do this by performing the same marginalization over the flyby velocities, impact parameter, impact time, and subhalo mass described in Section :=. We include all flybys within 5 kpc of the stream and only find a 1-2% change in the number of gaps if we extend this to 10 kpc, suggesting that our results have converged. In Figure := we show the expected number of gaps in Pal 5 deeper than a given threshold. We see that over a range of gap density thresholds, the subhaloes from [formula] produce the dominant contribution. Above a gap density threshold of fcut  ~  0.75, gaps from the subhaloes with a mass of [formula] outnumber those from the [formula] range. We see that if we take fcut  =  0.5 we expect to find 0.3 gaps in Pal 5. However, if we take fcut  =  0.75, we would expect almost 0.7 gaps. Thus, the null detection reported in [\cite=ibata_et_al_pal5] is not be very surprising although as noted above, the search was performed on scales significantly smaller than described here. The prediction for the number of gaps in Pal 5, and the other five streams, is given in Table :=.

GD-1

GD-1 is modeled as being on a circular orbit with a radius of 19 kpc. The number density of subhaloes between [formula] at this radius is 8.66  ×  10- 4kpc- 3. Assuming a circular velocity of 220 km/s, we get an orbital period of 530 Myr. Performing the same sampling as for Pal 5, we find 0.3 and 0.6 gaps in GD-1 for f < 0.5 and f < 0.75 respectively. This is roughly the same as the prediction for Pal 5. Since the age and length of GD-1 and Pal 5 are similar, the distribution of gap depths will look very similar to Figure :=. However, if we instead use the age of 7.7 Gyr we found in Section :=, we would expect 0.9 and 1.7 gaps for f < 0.5 and f < 0.75 respectively.

Tri/Psc

Next we model the Tri/Psc stream. We take it to be on a circular orbit at 40 kpc. The number density of subhaloes between [formula] at this radius is 5.51  ×  10- 4kpc- 3. Taking a circular velocity of 190 km/s [\citep=deason_et_al_2012], we get an orbital period of 1.3 Gyr. The number of gaps in Tri/Psc is 0.9 and 1.6 for f < 0.5 and f < 0.75 respectively. Thus, Tri/Psc is a better candidate in the search for gaps than GD-1 or Pal 5. Furthermore, Tri/Psc is sufficiently far away from the disk that the factor of 3 depletion may be an overestimate. [\cite=donghia_et_al_2010] found that the depletion is the strongest near the disk and decreases as we move away from the disk.

Figure := presents the cumulative distribution of gap depths for Tri/Psc. This can be compared against Figure := where we show the distribution for Pal 5. Since Tri/Psc is both longer and older than Pal 5, there are more gaps. In addition, the increased age of Tri/Psc gives the gaps more time to grow and hence it has a larger fraction of deep gaps. This can also be seen in Figure := where the effect of the stream age on the distribution of gap depths was examined and the same result was found.

ATLAS

We model the ATLAS stream as being on a circular orbit with a radius of 22 kpc. The number density of subhaloes between [formula] at this radius is 8.06  ×  10- 4kpc- 3. Taking a circular velocity of 220 km/s, we get an orbital period of 610 Myr. The expected number of gaps in the ATLAS stream is 0.02 and 0.1 for f < 0.5 and f < 0.75 respectively. This small number of gaps is due to the young age of ATLAS and the fact that the currently observed stream is quite short. Due to its young age, ATLAS will have shallower distribution of gaps than Pal 5.

Phoenix

Phoenix is modelled as being on a circular orbit with a radius of 19 kpc. The number density of subhaloes between [formula] at this radius is 8.66  ×  10- 4kpc- 3. Assuming a circular velocity of 220 km/s, we get an orbital period of 530 Myr. The number of gaps in Phoenix is 0.01 and 0.06 for f < 0.5 and f < 0.75 respectively. As with ATLAS, this is due to the young age of Phoenix and its short length. As a result, neither Phoenix nor ATLAS appear to be good candidates for detecting gaps.

However, we note that [\cite=grillmair_carlberg_2016] have recently suggested that the Phoenix stream may be part of a significantly longer stream which includes the Hermus stream [\citep=grillmair_hermus_hyllus]. The purported length of 76 kpc would make it the longest cold stream in the Milky Way and hence an ideal candidate for studying gaps. Since the increased length of a stream also increases its estimated age, the expected number of gaps increases roughly quadratically with the stream's length. Thus, if the estimated length is correct, the combined stream would have approximately 20 gaps deeper than f < 0.75.

Styx

The Styx stream [\citep=g_acheron_styx_cocytos_lethe] is substantially longer than the other streams. If the stream is indeed a cold stream, then it is one of the best candidates for detecting subhaloes. We model Styx as being on a circular orbit with a radius of 45 kpc and take its age to be 13 Gyr, younger that the estimate in Table := but consistent with the age of the universe. The number density of subhaloes between [formula] at this radius is 5.01  ×  10- 4kpc- 3. Assuming a circular velocity of 190 km/s, we get an orbital period of 1.46 Gyr. Sampling over the flybys we find 6 and 9 gaps expected with f < 0.5 and f < 0.75 respectively. Thus, Styx could have an order of magnitude more gaps than the second best stream, Tri/Psc. However, [\citep=g_acheron_styx_cocytos_lethe] argued that Styx is a dwarf galaxy stream. If this is correct, the number of gaps will decrease since the stream is younger and the stream from a dwarf galaxy is substantially hotter which will mask out many of the expected gaps.

Numerical Testing

The framework we have discussed here has mostly been based on analytic methods, using the gap size formulae from [\cite=three_phases] and the number of properties of the flybys as derived in Section :=. In this section we will test these assumptions and see how well they work.

Flyby properties

First we compare the properties of the subhalo flybys. We take the N-body simulation of Pal 5 described in Section := and include three times the expected subhalo population between [formula] using the fits from the number density profiles in Aquarius [\citep=springel_et_al_2008] as described in Section :=. We include three times the expected population to improve the statistics since the total number of flybys is not that large. Note that we also have not decreased the number density of subhaloes by a factor of 3 due to the effect of the MW disk so in reality, this example has roughly 9 times the expected subhaloes. These subhaloes are included as tracer particles which are sourcing the force expected if they were Hernquist profiles with their given mass and scale radius. The simulation is run for 3.4 Gyr which is the best fit age from [\cite=kuepper_et_al_pal5]. Despite including significantly more substructure than expected, we see only a minor effect in the density from these low mass subhaloes.

While the simulation is running, at each timestep we record whenever a subhalo passes within 2 kpc of a stream particle and record the position and velocity of both the subhalo and stream particle. During the simulation 2668 subhaloes passed within 2 kpc. We repeat our analysis above based on the stream length in the simulation at the present time and estimate that 2320 subhaloes should pass within 2 kpc of the stream in this time. Thus even though the model was based on circular orbits, it gives a good estimate for the number of flybys for a realistic stream on an eccentric orbit.

In Figure := we examine the distribution of relative flyby velocities for subhaloes which pass within 2 kpc. For each flyby in the simulation, we find the stream particle which has the smallest impact parameter and use the relative velocity to the subhalo. The figure also shows the prediction of our model and the relative velocity distribution from [\cite=yoon_etal_2011]. We see that our model is a better match than using the relative velocity in a Maxwellian distribution. However, our model is not a perfect match because it does not account for the eccentricity of the stream.

Distribution of gap depths and sizes

In addition to testing our assumptions about the flyby properties, we can also test how well our formalism works for determining the gap depths. We take the stream described in Section := and use the effective N-body formalism described in Section := to simulate a large number of impacts. The properties of these impacts were chosen to cover a large range in the parameter space as follows: each component of the subhalo velocity was chosen uniformly from -500 to 400 km/s in steps of 100 km/s relative to the host potential, the impact parameter was chosen uniformly from 0 to 1 kpc in steps of 100 pc, five different impact times are chosen as 0.5, 0.85, 1, 1.13, 2 Gyr, and finally the subhalo mass is chosen uniformly in log space from [formula] to [formula] in steps of log 10(2). The position of the impact along the stream was chosen to be halfway between the progenitor and the end of the stream. Each subhalo is modelled as a Plummer sphere with a scale radius given by Equation (:=). For each of these samples the effective N-body simulation is run, resulting in 500,000 simulated flybys. For each flyby, the particles are binned into [formula] bins and the density is saved for the region within 20[formula] of the gap center. This density is then divided by the unperturbed density to get the gap depth and size. In addition, we use our model to make a prediction of the gap depth. For the model, we assume the stream is on a circular orbit at 15 kpc and compute the gap properties described in Section :=. In Figure := we compare the distribution of gap depths between the effective N-body simulation with that of our analytic model and find a good match. There is a slight discrepancy in that the model predicts deeper gaps and in Section := we will discuss the limitations of our model which are likely responsible for these differences. However, the match in Figure := suggests that for a wide range of subhalo flybys, the analytic model used in this work produces a reasonable estimate of the actual gap depth.

Similarly, we can compute the distribution of gap sizes using the effective N-body simulations. Using the same distribution of flybys above, we show the distribution of gap sizes in Figure :=. As with the gap depths, we get a similar distribution suggesting that our model is reproducing the gap size for a larger range of parameters. We also see that in the effective N-body simulation, the characteristic gap size is on the order of a few degrees. For this comparison we only considered flybys in the effective N-body simulation which created gaps less than 10[formula] in size. This is because we only record the density profile within 20[formula] of the gap center and the tails of the unperturbed stream only have lengths of roughly 20[formula]. Since we define the gap size by dividing the perturbed density by the unperturbed density and finding the size of the underdense region, we cannot find gaps which are longer than the length of the stream.

Discussion

Searching for gaps

The results of this work can be used to guide targeted searches for stream gaps. In Section :=, the gap size distribution was explored for various mass subhaloes, and in Figure := the distribution of gap sizes was shown for a ΛCDM population. The characteristic size of the gaps in known streams will depend on the age of the stream, but as we can see from Figure :=, it peaks between [formula] for a wide range of density thresholds, with a large number of gaps with sizes of order [formula] and above. In addition, the distribution drops off as we proceed to smaller gaps so gap searches should be performed on a scale of at least [formula]. In recent work, [\cite=ibata_et_al_pal5] searched for gaps in Pal 5 on the scale of [formula] and found none. The results of this work suggest that future searches will be more fruitful if they are made on larger scales. However, we stress that the gap sizes we found are as viewed from the center of the Galaxy. A heliocentric observer may see smaller or larger gaps depending on their distance to the stream. In addition, the gap may appear foreshortened if it is not oriented perpendicular to the line of sight. Thus while we have identified a characteristic size of gaps, these observational effects, as well as the stretching and compressing of gaps due to eccentric orbits discussed in Section :=, can modify the distribution of sizes depending on the exact orientation of the stream and its orbital phase.

In Section := we explored the number of gaps expected in known streams around the Milky Way. The majority of these gaps are quite shallow, with ρ  /  ρ0  >  0.5. Thus, searches for gaps should be looking for shallow gaps over the scales of several degrees. This will require an accurate measurement of the stream density on fairly large scales. The detection of a wide and shallow gap will also require a careful modeling of the unperturbed stream density since changes in the stripping rate can also create features in the stream density profile.

In Table := we give the expected number of gaps for six cold streams around the Milky Way. We find that if Styx is a genuine cold stream (i.e. originating from a globular cluster), it is by far the best candidate with 6 gaps expected with gaps deeper than f < 0.5. After this, Tri/Psc is the best candidate with ~  0.9 gaps expected at this depth. Next, Pal 5 and GD-1 have a similar number of gaps with ~ 0.3 expected. Finally, Phoenix and ATLAS both appear to be poor candidates for detecting subhaloes with 0.02 and 0.01 gaps at this depth. We note that these predictions rely on the assumed properties in Table :=. As a result, these predictions represent a lower bound on the number of gaps since we have assumed that we have observed the full stream length. If these streams are found to be longer than currently observed, the number of gaps would naively increase quadratically with the length of the stream since the number of flybys is proportional to the age of the stream times its length (i.e. Equation (:=)) and the age itself is proportional to the length. However, the increased age of the stream would also give the gaps more time to grow, potentially making the scaling even stronger. Thus, deep observations of the streams to determine their full length and characterise their densities are critical.

Lastly, we emphasize that this work has only focused on the basic properties of the gaps, such as depth and width. As discussed in [\cite=subhalo_properties] [\cite=bovy_erkal_sanders], a flyby will also create wiggles in the track of the stream which can be seen in the debris centroid on the sky, the distance to the stream, and the velocities in the stream. An underdensity alone is not sufficient to show a gap is present since other mechanisms like a variable stripping rate can create density variations in the stream. Thus, searches for gaps should also aim to identify these oscillations which will be crucial for constraining the properties of the perturbing subhalo.

Extension to dwarf galaxy streams

We note that the results of this work cannot be immediately extended to dwarf galaxy streams like Sagittarius [\citep=ibata_et_al_2001] or Orphan [\citep=orphan] which are substantially longer than the cold streams discussed here. While the flyby rates are still applicable, we would need to determine which flybys can create appreciable gaps. Since streams from disrupting dwarf galaxies have substantially higher velocity dispersions, a larger velocity kick will be needed to form a gap and these streams will not be sensitive to low mass substructure. We expect that the minimum velocity kick needed will likely scale as m1 / 3prog, where mprog is the progenitor mass, just like the stream width and length (e.g. Equation (:=) and Equation (:=)). Since the fraction of velocity kicks above some threshold drops rapidly as the threshold is increased, e.g. Figure :=, it appears unlikely that dwarf galaxy streams will have more gaps than cold streams.

Comparison with other works

Let us compare the results of this work against those already reported in the literature. [\cite=yoon_etal_2011] and [\cite=carlberg_2012] both made similar assumptions as in this work to compute the number of flybys, as well as their relative velocity distribution. As discussed in Section :=, our derivation for the number of flybys differs slightly from [\cite=yoon_etal_2011] but matches [\cite=carlberg_2012]. [\cite=carlberg_2012] also made predictions for the number of observable gaps which gives significantly more gaps than our model expects. Part of this difference is due to our decreasing the number of subhaloes due to the presence of the Milky Way disk [\citep=donghia_et_al_2010].

[\cite=ngan2014] consider the distribution of gap sizes in N-body simulations and find that the ΛCDM spectrum of subhaloes primarily create gaps larger than [formula] [\citep=ngan2014], qualitatively agreeing with the results of this work. [\cite=carlberg_2016] simulate a stream on an orbit similar to GD-1 in the presence of subhaloes and find substantially more gaps than expected here. However, their stream age is 10.67 Gyr, significantly older than what we assume for GD-1, and they also perform the gap search over a stream which is ~   2 radians long, significantly longer than what is observed for GD-1. We note that if we naively scale up our predictions to the age and length of their GD-1, we would get ~  5 gaps deeper than f < 0.9, in agreement with Figure 7 of [\cite=carlberg_2016].

Baryonic effects

In this work we have characterized the frequency of gaps due to dark matter subhaloes. However, as was recently shown in [\cite=amorisco_gmcs], clumps of baryons such as giant molecular clouds (GMCs) can also create gaps in streams. The mass spectrum of GMCs in the Milky Way [\citep=rosolowsky_2005] [\citep=rice_et_al_2016] shows that within the solar circle, the mass function is a power-law with an index of γ =  - 1.6 (not too different from that of the subhaloes) and there are no GMCs above [formula]. Outside the solar circle, the mass spectrum is steeper, with γ  =   - 2.1, and the upper mass drops to [formula]. Thus, streams whose pericenters are outside the solar circle should not be strongly affected by GMCs since, as we have shown, the effect from flybys of objects with masses below [formula] will not produce a noticeable gap in the stream. However, for streams which pass within the solar circle (i.e. the Pal 5 stream), the most massive GMCs could impart noticeable density fluctuations in the stream. [\cite=amorisco_gmcs] evolved N-body realizations of Pal 5 and GD-1 like streams in the presence of the expected distribution of GMCs and reached a similar conclusion with GMCs producing notable gaps in Pal 5 but very few gaps in GD-1. Their analysis also accounted for whether the streams were on a prograde or retrograde with respect to the GMCs and found that prograde orbits produce more substantial gaps since the smaller relative velocities increases the size of the kick from the GMC. Now we can attempt to estimate the importance of GMCs within the framework developed for subhaloes in this work.

In order to determine the relative importance of these GMCs in the inner part of the Milky Way, we can compare their number density with that of the subhaloes, taking into account what fraction of the stream's orbit is within the disk. Figure 21 of [\cite=rice_et_al_2016] shows that their survey found ~ 40 GMCs with masses between [formula] within the solar circle. They estimate their completeness by comparing the total mass of the GMCs they found to the total molecular hydrogen mass in the Milky Way and find they are 28% complete. Thus, we can estimate that there are ~  140 GMCs in this mass range within the solar circle. If we further assume that the number density of GMCs is constant within the solar circle and that the GMCs are confined to the region within a scale-height of the Milky Way disk, ~  250 pc, we find an average number density of 2.6 kpc- 3. In order to compare the effect of the GMCs against the subhaloes, we must estimate the relative number of interactions for a segment of the stream. If a segment travels a length l through a region where perturbers have a number density of n and affect the stream if they pass within a distance b, the number of impacts is proportional to nlb. If we only consider the effect of the subhaloes within the same mass range as the GMCs considered here, i.e. [formula], then we can assume that b is the same. Thus, we only need to compare the quantity nl. The stream is sensitive to subhaloes for its entire orbit, however it is only sensitive to the GMCs when it passes through the disk. For a Pal 5-like stream, if we take the average radius to be 13 kpc and use nsub  =  1.01  ×  10- 3kpc- 3, we get nsublsub  =  0.08kpc- 2 where lsub is the length of the orbit. For the GMCs, if we assume that the orbit passes straight through the disk we get nGMClGMC  =  1.3kpc- 2 where lGMC is twice the disk scale height. Therefore, even though the stream only spends a fraction of its orbit within the disk, the GMCs will have an order of magnitude more interactions and we must consider the effect of GMCs as suggested by [\cite=amorisco_gmcs]. Increasing the mass range of the subhaloes we consider does not change this conclusion since the number of gaps created by subhaloes with masses between [formula] is similar to those created by subhaloes between [formula].

This simple analysis has many caveats. First, the number density of GMCs is not constant within the solar circle. In [\cite=roman-duval_et_al_2010] the surface density of molecular gas in the Milky Way is shown to peak around 4 kpc and then drop-off: by 7 kpc, the surface density has dropped by an order of magnitude. Thus the relative importance of GMCs depends sensitively on the stream's pericenter. The pericenter of Pal 5 is between ~  6 - 8 kpc (see Table :=) so if the number density of GMCs were 10 times lower, the effect of GMCs and subhaloes would be comparable. Indeed, [\cite=amorisco_gmcs] who assumed a pericenter of 8 kpc found that GMCs should produce 0.5 gaps with ρ  /  ρ0 < 0.71 in the observed section of Pal 5, similar to our prediction in Table :=. Second, this analysis only considered the number of flybys and not the gaps they created. This will be controlled by the relative velocity of the GMCs as compared to the subhaloes and warrants further study [\citep=amorisco_gmcs]. Third, we did not account for the increased path length of a stream through the disk if it is not on a polar orbit, however Pal 5 is relatively close to polar with an orbital inclination of [formula] relative to the disk [\citep=stream_width]. Fourth, this analysis does not account for the time evolution of GMCs. If the star-formation was stronger in the past, this could increase the number density of GMCs. Finally, this analysis does not account for the finite lifetime of GMCs which are expected to only survive a few free-fall times [\citep=murray_2011]. For the GMCs we consider here that only corresponds to a ~  10 - 20 Myr and at the typical speeds within the disk, the GMCs will only move a few kpc before dispersing. This can be compared to the timescales over which the GMC would deliver a substantial kick: the region where the accelerations are the largest is on the order of the scale radius for a direct impact so the timescale where the kick is important is on the order of a Myr. Thus, it appears that the disruption of the GMC can safely be neglected.

Finally we note that in [\cite=subhalo_properties] it was shown that given measurements of the density profile of the stream, and two other observables such as the stream track on the sky and the radial velocity along the stream, it is possible to recover the mass and scale radius of the perturber, as well as the time since impact. Thus, in principle, it should be possible to distinguish an impact from a globular cluster from that of a subhalo by the gap properties and by the time since impact. If the interaction occurred within the disk plane, this will lend additional credence to a GMC while if the impact can be convincingly be shown to have occurred far from the disk plane, a subhalo impact will be preferred.

Limitations of the method

The method used in this work is based on the perturbation of streams on circular orbits [\citep=three_phases]. In this approximation, the stream is treated as being arbitrarily thin and having no velocity dispersion. This neglects the energy and angular momentum dispersion in the stream which can cause the gap depth to plateau as described in [\cite=sanders_bovy_erkal_2015]. [\cite=sanders_bovy_erkal_2015] also found that the evolution of the gap size depends on where along the stream the impact occurs, with flybys far from the progenitor giving rise to more rapidly growing gaps due to the stretching of the stream itself. Thus, the analysis in this work may be slightly overestimating the depth of the gaps and understimating their size. We have attempted to test this in Figure := where we compared the flyby of a [formula] in this formalism with the flyby in an effective N-body simulation. This showed a fairly good match indicating that our method is robust. However, if anything our method will over-estimate the depth of gaps and so the number of gaps should be even less than reported in Table :=.

In addition, our method does not account for the change in gap size along the orbit. We have treated the streams as being on circular orbits but naturally a large fraction of them are on orbits with substantial eccentricity. This eccentricity causes the gap size and depth to oscillate as seen in Figures 4,5 of [\cite=three_phases] and Figure 13 of [\cite=sanders_bovy_erkal_2015]. If we neglect the growth of the gap during an orbit, conservation of angular momentum tells us that the gap sizes goes as r- 2, e.g. Fig. 13 of [\cite=sanders_bovy_erkal_2015]. The gap depth relative to the unperturbed stream exhibits a weaker oscillation but the gaps are deepest at pericenter and shallowest at apocenter. Thus, the predictions in Table := should be seen as an average of the number of gaps expected. At pericenter these gaps will be easier to detect and at apocenter they will be more difficult to spot. We note that both of these limitations are addressed in [\cite=bovy_erkal_sanders] where they find broadly similar conclusions.

Finally, this method does not account for the ongoing disruption of subhaloes. In the regions of the potential where a globular cluster can be tidally stripped, the subhaloes should be disrupting much more vigorously due to their lower density, resulting in dark matter streams as discussed in [\cite=bovy_2016]. Including the effect of these partially disrupted subhaloes will create shallower gaps, further lowering the expected number of gaps.

Conclusion

In this work we have made a prediction for the expected number of stream gaps created by subhaloes and found far fewer gaps than previously expected. This prediction is based on counting the number of subhalo flybys near the stream, similar to the approaches of [\cite=yoon_etal_2011] and [\cite=carlberg_2012], and a model for the growth of the resulting gap created by each flyby from [\cite=three_phases]. The model for the rate and properties of the flybys in Section := is broadly similar to that in [\cite=yoon_etal_2011] and [\cite=carlberg_2012] but we expect significantly fewer flybys with a hotter relative velocity distribution. This is partially due to an updated derivation, and partially due to accounting for the depletion of subhaloes by the Milky Way disk [\citep=donghia_et_al_2010].

The rate and properties of the flybys are then combined with the analytic model for gap growth described in Section :=. While this analytic prescription is based on perturbations of streams on circular orbits and neglects the dispersion in a real stream, the tests performed in Section := indicate that it is relatively robust. Using the Pal 5 stream as an example, the distribution of gap sizes and depths is examined in Section := and we find several interesting results. First, the gap sizes are larger than previously expected with the majority of the gaps in Pal 5 having typical size of [formula] and many as large as [formula] and above (see Fig. :=). As a result, any searches for gaps in Pal 5 should focus on sizes larger than [formula]. Second, for a given age of the stream, each perturber mass gives rise to a characteristic gap size (see Fig. :=). This can be used to roughly estimate a perturber mass from the size of a gap. Third, we find that the typical gap size is larger for older streams since these gaps have had more time to grow (see Fig. :=).

This formalism was also used to make predictions for the number of gaps in six cold streams around the Milky Way. These predictions are summarised in Table := where it is clear that most streams will have very few gaps. Pal 5 is expected to have 0.3 and 0.7 gaps deeper than f < 0.5 and f < 0.75 respectively. As a result, the null detection reported in [\cite=ibata_et_al_pal5] is not surprising. This should be contrasted with the 6 gaps detected in [\cite=carlberg_pal5_2012]. Indeed, [\cite=thomas_et_al_2016] argue that the claimed detections are due to a combination of variation in the Milky Way background with a smooth stream density. The six streams are ranked by the expected number of gaps and the Tri/Psc stream appears to be the most promising candidate with 0.9 and 1.6 gaps deeper than f < 0.5 and f < 0.75 respectively. GD-1 is also a promising candidate with a similar number of gaps to Pal 5. Substantially fewer gaps are expected in the ATLAS and Phoenix stream due to their short length and young age. Finally, if the Styx stream is a cold stream with the reported length then it would have the most gaps.

In addition to the total number of gaps, we also investigate the contribution from each mass decade of subhaloes for Pal 5 and Tri/Psc in Figure := respectively. This shows that the vast majority of gaps are due to subhaloes with masses in the range [formula]. This is a previously unexplored mass range and the detection of even a single confirmed subhalo in this range would be an important test of ΛCDM and would improve constraints on the mass of a warm dark matter particle. In Section := we estimate the number of gaps created by GMCs and find that for streams which enter the solar circle, they will be comparable to the number from subhaloes, in agreement with [\cite=amorisco_gmcs].

While these predictions may appear to dampen the prospects of using cold streams to detect subhaloes, they should instead be thought of as setting realistic expectations for the number of gaps and their properties. With exquisite observations of streams now possible as demonstrated in [\cite=ibata_et_al_pal5], these predictions show that a lack of gaps in Pal 5 is unsurprising but also imply that the search for gaps should be performed on larger scales. Our results suggest that in the near future, deep observations of GD-1 and Tri/Psc, combined with the existing observations of Pal 5, should allow us to begin to uncover the presence of dark subhaloes expected in ΛCDM.

Acknowledgements

We thank the anonymous referee for their helpful comments. We thank the Streams club at Cambridge for valuable discussions and in particular Sergey Koposov and Thomas de Boer. The research leading to these results has received funding from the European Research Council under the European Union's Seventh Framework Programme (FP/2007-2013)/ERC Grant Agreement no. 308024. J.B. received financial support from the Natural Sciences and Engineering Research Council of Canada. JLS acknowledges the support of the Science and Technology Facilities Council (STFC).

Number of subhaloes entering cylinder

It is also possible to come up with a simple expression for the number of subhaloes entering the caps of the stream. From the end caps on the left and right side of the cylinder in Figure :=, we would expect

[formula]

subhaloes to enter the region within b of the stream in time dt. Both of these must be integrated over the subhaloes which enter the stream, i.e. on the left side we consider vz  <  vs and on the right side we consider vz  >  vs. Performing these integrals over vz for both endcaps and summing the result, we get

[formula]