Agreement-based Learning of Parallel Lexicons and Phrases from Non-Parallel Corpora

, Huanbo Luan[formula], Maosong Sun[formula], Heng Yu[formula] [formula] State Key Laboratory of Intelligent Technology and Systems Tsinghua National Laboratory for Information Science and Technology Department of Computer Science and Technology, Tsinghua University, Beijing 100084, China # Jiangsu Collaborative Innovation Center for Language Competence, Jiangsu, China [formula] Samsung R&D Institute of China, Beijing 100028, China

Introduction

Parallel corpora, which are large collections of parallel texts, serve as an important resource for inducing translation correspondences, either at the level of words [\cite=Brown:93] [\cite=Smadja:94] [\cite=Wu:94] or phrases [\cite=Kupiec:93] [\cite=Melamed:97] [\cite=Marcu:02] [\cite=Koehn:03]. However, the availability of large-scale, wide-coverage corpora still remains a challenge even in the era of big data: parallel corpora are usually only existent for resource-rich languages and restricted to limited domains such as government documents and news articles.

Therefore, intensive attention has been drawn to exploiting non-parallel corpora for acquiring translation correspondences. Most previous efforts have concentrated on learning parallel lexicons from non-parallel corpora, including parallel sentence and lexicon extraction via bootstrapping [\cite=Fung:04], inducing parallel lexicons via canonical correlation analysis [\cite=Haghighi:08], training IBM models on monolingual corpora as decipherment [\cite=Ravi:11] [\cite=Nuhn:12] [\cite=Dou:14], and deriving parallel lexicons from bilingual word embeddings [\cite=Vulic:13] [\cite=Mikolov:13] [\cite=Vulic:15].

Recently, a number of authors have turned to a more challenging task: learning parallel phrases from non-parallel corpora [\cite=Zhang:13] [\cite=Dong:15]. Zhang and Zong present a method for retrieving parallel phrases from non-parallel corpora using a seed parallel lexicon. Dong et al. continue this line of research to further introduce an iterative approach to joint learning of parallel lexicons and phrases. They introduce a corpus-level latent-variable translation model in a non-parallel scenario and develop a training algorithm that alternates between (1) using a parallel lexicon to extract parallel phrases from non-parallel corpora and (2) using the extracted parallel phrases to enlarge the parallel lexicon. They show that starting from a small seed lexicon, their approach is capable of learning both new words and phrases gradually over time.

However, due to the structural divergence between natural languages as well as the presence of noisy data, only using asymmetric translation models might be insufficient to accurately identify parallel lexicons and phrases from non-parallel corpora. Dong et al. report that the accuracy on Chinese-English dataset is only around 40% after running for 70 iterations. In addition, their approach seems prone to be affected by noisy data in non-parallel corpora as the accuracy drops significantly with the increase of noise.

Since asymmetric word alignment and phrase alignment models are usually complementary, it is natural to combine them to make more accurate predictions. In this work, we propose to introduce agreement-based learning [\cite=Liang:06] [\cite=Liang:08] into extracting parallel lexicons and phrases from non-parallel corpora. Based on the latent-variable model proposed by Dong et al. , we propose two kinds of loss functions to take into account the agreement between both phrase alignment and word alignment in two directions. As the inference is intractable, we resort to a Viterbi EM algorithm to train the two models efficiently. Experiments on the Chinese-English dataset show that agreement-based learning is more robust to noisy data and leads to substantial improvements in phrase alignment and machine translation evaluations.

Background

Given a monolingual corpus of source language phrases [formula] and a monolingual corpus of target language phrases [formula], we assume there exists a parallel corpus [formula], where [formula] denotes that [formula] and [formula] are translations of each other.

As a long sentence in E is usually unlikely to have an translation in F and vise versa, most previous efforts build on the assumption that phrases are more likely to have translational equivalents on the other side [\cite=Munteanu:06] [\cite=Cettolo:10] [\cite=Zhang:13] [\cite=Dong:15]. Such a set of phrases can be constructed by collecting either constituents of parsed sentences or strings with hyperlinks on webpages (e.g., Wikipedia). Therefore, we assume the two monolingual corpora are readily available and focus on how to extract D from E and F.

To address this problem, Dong et al. introduce a corpus-level latent-variable translation model in a non-parallel scenario:

[formula]

where [formula] is phrase alignment and [formula] is a set of model parameters. Each target phrase [formula] is restricted to connect to exactly one source phrase: [formula], where [formula]. For example, [formula] denotes that [formula] is aligned to [formula]. Note that [formula] represents an empty source phrase.

They follow IBM Model 1 [\cite=Brown:93] to further decompose the model as

[formula]

where [formula] is a phrase translation model that can be further defined as

[formula]

Dong et al. distinguish between empty and non-empty phrase translations. If a target phrase [formula] is aligned to the empty source phrase [formula] (i.e., [formula]), they set the phrase translation probability to a fixed number ε. Otherwise, conventional word alignment models such as IBM Model 1 can be used for non-empty phrase translation:

[formula]

where p(J|I) is a length model and p(f|e) is a translation model. We use J(t) to denote the length of [formula].

Therefore, the latent-variable model involves two kinds of latent structures: (1) phrase alignment [formula] between source and target phrases, (2) word alignment [formula] between source and target words within phrases.

Given the two monolingual corpora E and F, the training objective is to maximize the likelihood of the training data:

[formula]

where

[formula]

Note that [formula] is a small seed parallel lexicon for initializing training and [formula] checks whether an entry 〈f,e〉 exists in [formula].

Given the monolingual corpora and the optimized model parameters, the Viterbi phrase alignment is calculated as

[formula]

Finally, parallel lexicons can be derived from the translation probability table of IBM model 1 [formula] and parallel phrases can be collected from the Viterbi phrase alignment [formula]. This process iterates and enlarges parallel lexicons and phrases gradually over time.

As it is very challenging to extract parallel phrases from non-parallel corpora, unidirectional models might only capture partial aspects of translation modeling on non-parallel corpora. Indeed, Dong et al. find that the accuracy of phrase alignment is only around 50% on the Chinese-English dataset. More importantly, their approach seems to be vulnerable to noise as the accuracy drops significantly with the increase of noise. As source-to-target and target-to-source translation models are usually complementary [\cite=Och:03] [\cite=Koehn:03] [\cite=Liang:06], it is appealing to combine them to improve alignment accuracy.

Approach

Agreement-based Learning

The basic idea of our work is to encourage the source-to-target and target-to-source translation models to agree on both phrase and word alignments.

For example, Figure [\ref=fig_phrase_align] shows two example Chinese-to-English and English-to-Chinese phrase alignments on the same non-parallel data. As each model only captures partial aspects of translation modeling, our intuition is that the links on which two models agree (highlighted in red) are more likely to be correct.

More formally, let [formula] be a source-to-target translation model and [formula] be a target-to-source model, where [formula] and [formula] are corresponding model parameters. We use [formula] to denote source-to-target phrase alignment. Likewise, the target-to-source phrase alignment is denoted by [formula].

To ease the comparison between [formula] and [formula], we represent them as sets of non-empty links equivalently:

[formula]

For example, suppose the source-to-target and target-to-source phrase alignments are [formula] and [formula]. The equivalent link sets are [formula] and [formula]. Therefore, [formula] is said to be equal to [formula] (i.e., [formula]).

Following Liang et al. , we introduce a new training objective that favors the agreement between two unidirectional models:

[formula]

where the posterior probabilities in two directions are defined as

[formula]

The loss function [formula] measures the disagreement between the two models.

Outer Agreement

Definition

A straightforward loss function is to force the two models to generate identical phrase alignments:

[formula]

We refer to Eq. ([\ref=eq:outer]) as outer agreement since it only considers phrase alignment and ignores the word alignment within aligned phrases.

Training Objective

Since the outer agreement forces two models to generate identical phrase alignments, the training objective can be written as

[formula]

where [formula] is a phrase alignment on which two models agree.

The partial derivatives of the training objective with respect to source-to-target model parameters [formula] are given by

[formula]

The partial derivatives with respect to [formula] are defined likewise.

Training Algorithm

As the expectation in Eq. ([\ref=eq:outer_derivative]) is usually intractable to calculate due to the exponential search space of phrase alignment, we follow Dong et al. to use a Viterbi EM algorithm instead.

As shown in Figure [\ref=fig:viterbi_em], the algorithm takes a set of source phrases E, a set of target phrases F, and a seed parallel lexicon [formula] as input (line 1). After initializing model parameters [formula] (line 2), the algorithm calls the procedure [formula] to compute the Viterbi phrase alignment between E and F on which two models agree. Then, the algorithm updates the two models by normalizing counts collected from the Viterbi phrase alignment. The process iterates for K iterations and returns the final Viterbi phrase alignment and model parameters.

Computing Viterbi Phrase Alignments

The procedure [formula] computes the Viterbi phrase alignment [formula] between E and F on which two models agree as follows:

[formula]

Unfortunately, due to the exponential search space of phrase alignment, computing [formula] is also intractable. As a result, we approximate it as the intersection of two unidirectional Viterbi phrase alignments:

[formula]

where the unidirectional Viterbi phrase alignments are calculated as

[formula]

The source-to-target Viterbi phrase alignment is calculated as

[formula]

Dong et al. indicate that computing the Viterbi alignment for individual target phrases is independent and only need to focus on finding the most probable source phrase for each target phrase:

[formula]

This can be cast as a translation retrieval problem [\cite=Zhang:13] [\cite=Dong:14]. Please refer to [\cite=Dong:15] for more details. The target-to-source Viterbi phrase alignment can be calculated similarly.

Updating Model Parameters

Following Liang et al. , we collect counts of model parameters only from the agreement term.

Given the agreed Viterbi phrase alignment [formula], the count of the source-to-target length model p(J|I) is given by

[formula]

The new length probabilities can be obtained by

[formula]

The count of the source-to-target translation model p(f|e) is given by

[formula]

The new translation probabilities can be obtained by

[formula]

Counts of target-to-source length and translation models can be calculated in a similar way.

Inner Agreement

Definition

As the outer agreement only considers the phrase alignment, the inner agreement takes both phrase alignment and word alignment into consideration:

[formula]

For example, Figure [\ref=fig_example_inner] shows two examples of Chinese-to-English and English-to-Chinese word alignments. The shared links are highlighted in red. Our intuition is that a source phrase and a target phrase are more likely to be translations of each other if the two translation models also agree on word alignment within aligned phrases.

Training Objective and Algorithm

The training objective for inner agreement is given by

[formula]

We still use the Viterbi EM algorithm as shown in Figure [\ref=fig:viterbi_em] for training the two models.

Computing Viterbi Phrase Alignments

The agreed Viterbi phrase alignment is defined as

[formula]

As computing [formula] is intractable, we still approximate it using the intersection of two unidirectional Viterbi phrase alignments (see Eq. ([\ref=eq:intersection])). The source-to-target Viterbi phrase alignment is calculated as

[formula]

where [formula] is source-to-target link posterior probability of the link 〈i,j〉 being present (or absent) in the word alignment according to the source-to-target model, [formula] is target-to-source link posterior probability. We follow Liang et al. to use the product of link posteriors to encourage the agreement at the level of word alignment.

We use a coarse-to-fine approach [\cite=Dong:15] to compute the Viterbi alignment: first retrieving a coarse set of candidate source phrases using translation probabilities and then selecting the candidate with the highest score according to Eq. ([\ref=eq:inner_viterbi]). The target-to-source Viterbi phrase alignment can be calculated similarly.

Updating Model Parameters

Given the agreed Viterbi phrase alignment [formula], the count of the source-to-target length model p(J|I) is still given by Eq. ([\ref=eq:length_count]). The count of the translation model p(f|e) is calculated as

[formula]

Counts of target-to-source length and translation models can be calculated in a similar way.

Experiments

In this section, we evaluate our approach in two tasks: phrase alignment (Section 4.1) and machine translation (Section 4.2).

Alignment Evaluation

Evaluation Metrics

Given two monolingual corpora E and F, we suppose there exists a ground truth parallel corpus G and denote an extracted parallel corpus as D. The quality of an extracted parallel corpus can be measured by [formula].

Data Preparation

Although it is appealing to apply our approach to dealing with real-world non-parallel corpora, it is time-consuming and labor-intensive to manually construct a ground truth parallel corpus. Therefore, we follow Dong et al. to build synthetic E, F, and G to facilitate the evaluation.

We first extract a set of parallel phrases from a sentence-level parallel corpus using the state-of-the-art phrase-based translation system Moses [\cite=Koehn:07] and discard low-probability parallel phrases. Then, E and F can be constructed by corrupting the parallel phrase set by adding irrelevant source and target phrases randomly. Note that the parallel phrase set can serve as the ground truth parallel corpus G. We refer to the non-parallel phrases in E and F as noise.

From LDC Chinese-English parallel corpora, we constructed a development set and a test set. The development set contains 20K parallel phrases, 20K noisy Chinese phrases, and 20K noisy English phrases. The test test contains 20K parallel phrases, 180K noisy Chinese phrases, and 180K noisy English phrases. The seed parallel lexicon contains 1K entries.

Comparison of Agreement Ratios

We introduce agreement ratio to measure to what extent two unidirectional models agree on phrase alignment:

[formula]

Figure [\ref=fig_ratio] shows the agreement ratios of independent training ("no agreement"), joint training with the outer agreement ("outer"), and joint training with the inner agreement ("inner"). We find that independently trained unidirectional models hardly agree on phrase alignment, suggesting that each model can only capture partial aspects of translation modeling on non-parallel corpora. In contrast, imposing the agreement term significantly increases the agreement ratios: after 10 iterations, about 40% of phrase alignment links are shared by two models.

Effect of Seed Lexicon Size

Table [\ref=table:seed] shows the F1 scores of the Chinese-to-English model ("C →   E"), the English-to-Chinese model ("E →   C"), joint learning based on the outer agreement ("outer"), and jointing learning based on the inner agreement ("inner") over various sizes of seed lexicons on the development set.

We find that agreement-based learning obtains substantial improvements over independent learning across all sizes. More importantly, even with a seed lexicon containing only 50 entries, agreement-based learning is able to achieve F1 scores above 60%. The inner agreement performs better than the outer agreement by taking the consensus at the word level into account.

Effect of Noise

Table [\ref=fig_noises] demonstrates the effect of noise on the development set. In row 1, "0+0" denotes there is no noise, which can be seen as an upper bound. Adding noise, either on the Chinese side or on the English side, deteriorates the F1 scores for all methods. Adding noise on the English side makes predicting phrase alignment in the C →   E direction more challenging due to the enlarged search space. The situation is similar in the reverse direction. It is clear that agreement-based learning is more robust to noise: while independent training suffers from a reduction of 40% in terms of F1 for the "20K + 20K" setting, agreement-based learning still achieves F1 scores over 70%.

Results

Figure [\ref=fig_alignment_result] gives the final results on the test set. We find that agreement-based training achieves significant improvements over independent training. By considering the consensus on both phrase and word alignments, the inner agreement significantly outperforms the outer agreement. Notice that only add noise on one side while we add noisy phrases on both sides, which makes phrase alignment more challenging.

Table [\ref=table:sample] shows example learned parallel words and phrases. The lexicon is built from the translation table by retaining high-probability word pairs. Therefore, our approach is capable of learning both new words and new phrases unseen in the seed lexicon.

Translation Evaluation

Following and , we evaluate our approach on domain adaptation for machine translation.

The data set consists of two in-domain non-parallel corpora and an out-domain parallel corpus. The in-domain non-parallel corpora consists of 2.65M Chinese phrases and 3.67M English phrases extracted from LDC news articles. We use a small out-domain parallel corpus extracted from financial news of FTChina which contains 10K phrase pairs. The task is to extract a parallel corpus from in-domain non-parallel corpora starting from a small out-domain parallel corpus.

We use the state-of-the-art translation system Moses [\cite=Koehn:07] and evaluate the performance on Chinese-English NIST datasets. The development set is NIST 2006 and the test set is NIST 2005. The evaluation metric is case-insensitive BLEU4 [\cite=Papineni:02]. We use the SRILM toolkit [\cite=Stolcke:02] to train a 4-gram English language model on a monolingual corpus with 399M English words.

Table [\ref=table_translation] shows the results. At iteration 0, only the out-domain corpus is used and the BLEU score is 5.61. All methods iteratively extract parallel phrases from non-parallel corpora and enlarge the extracted parallel corpus. We find that agreement-based learning achieves much higher BLEU scores while obtains a smaller parallel corpus as compared with independent learning. One possible reason is that the agreement-based learning rules out most unlikely phrase pairs by encouraging consensus between two models.

Conclusion

We have presented agreement-based training for learning parallel lexicons and phrases from non-parallel corpora. By modeling the agreement on both phrase alignment and word alignment, our approach achieves significant improvements in both alignment and translation evaluations.

In the future, we plan to apply our approach to real-world non-parallel corpora to further verify its effectiveness. It is also interesting to extend the phrase translation model to more sophisticated models such as IBM models 2-5 [\cite=Brown:93] and HMM [\cite=Vogel:96].

Acknowledgments

We sincerely thank the reviewers for their valuable suggestions. We also thank Meng Zhang, Yankai Lin, Shiqi Shen and Meiping Dong for their insightful discussions. Yang Liu is supported by the National Natural Science Foundation of China (No. 61522204), the 863 Program (2015AA011808), and Samsung R&D Institute of China. Huanbo Luan is supported by the National Natural Science Foundation of China (No. 61303075). Maosong Sun is supported by the Major Project of the National Social Science Foundation of China (13&ZD190).