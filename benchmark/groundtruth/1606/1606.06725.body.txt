Technical Considerations in Magnetic Analogue Models

Introduction

For many years scientific enquiry could only be pursued by theoretical analysis or by direct experimentation. Simulation has emerged in recent years as powerful, although indirect, new mode of enquiry. In particular, the advent of computers and computational methods is allowing researchers to make progress in the study of problems in Fluid Dynamics, Magnetohydrodynamics (MHD), Turbulence and Astrophysics, thereby leading to better understanding of the properties of the substance being analysed. With the improvement in technology over the years and the coming-of-age of high-performance computing, many problems in these areas that were previously deemed intractable have now become tractable, with much time being spend on developing efficient computer codes for specialised applications in these fields.

Some of these codes are specially designed to run on a variety of computer architectures, ranging from a single machine perhaps possessing a multi-core CPU or several GPUs, to larger, more complicated architectures which are the case for cluster- or supercomputers which typically possess thousands of GPU units and CPU cores. Many of these codes are freely available, for example the popular ZEUS code which was presented in a series of test problems considered in a series of papers by Stone et al [\cite=stone1992a] [\cite=stone1992b] [\cite=stone1992c], and the Pencil Code, which is used to obtain the results presented in this paper and whose design are rationale are described in [\cite=brandenburg2001] [\cite=brandenburgdobler2002] [\cite=pencilman]. With the advent of general-purpose computing on graphics processing units (GPGPU), many codes similar to ZEUS and Pencil such as GPUPEGAS, which is used to simulate interacting galaxies through MHD [\cite=igor2013], FARGO3D [\cite=benitezmasset2016], which is used mainly for applications planetary-disk interactions in forming stellar systems, and RAMSES-GPU [\cite=kestener2010] which was ported to the GPU from the popular RAMSES MHD code [\cite=teyssier2002].

Hydromagnetic turbulence is an example of an area that has benefitted greatly from advances in computing. The study of turbulence by Kolmogorov [\cite=kolmogorov1991a] [\cite=kolmogorov1991b] [\cite=kolmogorov1991c] and others and its application in turbulent dynamo theory is another. The gradients of the various slopes observed in the energy spectrum of a magnetic field amplified by a turbulent dynamo has been the subject of study for many authors (e.g. [\cite=haugenea2004] [\cite=brandenburgdobler2002] [\cite=brandenburg2001] [\cite=brandenburg2005rev] [\cite=haugen2003] and others). In particular, in [\cite=haugenea2004], discussed the importance of a fine enough mesh resolution in order to correctly capture important features in the magnetic energy spectrum. Though we do not consider turbulence in this paper, the discussion of mesh resolution is key when assessing the quality of solutions obtained so as to avoid any arti-facts that are solely due to a mesh that is possibly too coarse.

The search for a theory of analogue magnetism, that links Fluid Dynamics to Electromagnetism, is entering a new phase that stands to benefit from strides already made in computing and computer technology. Such a theory will allow the indirect study of many more complicated aspects of Electromagnetism than is currently possible. Today, however, such a theory is rudimentary and references made to any possible physical analogy between the two fields are only made in passing. In this paper, we aim to further discuss the analogy between the magnetic field present in a charged fluid, and the vorticity field present in a neutral fluid with an emphasis on technical aspects of simulations. A specific case of this has already been discussed in a prior work [\cite=osanoadams2016-1], where we examined the analogy between the magnetic and vorticity field where the magnetic diffusion and kinetic viscosity were kept equal, and where source terms in the relevant equations were neglected. This paper extends the work in [\cite=osanoadams2016-1] and examines a bigger range of diffusion and viscosity values; in particular, we do not demand that these two values be equal. Physically, this is akin to testing for an analogy between magnetic field and vorticity in different types of fluids. The case involving the consideration of source terms in the relevant equations is explored elsewhere [\cite=osanoadams2016-2].

The idea of a possible analogy between Electromagnetism and Fluid Dynamics is not new, in fact Maxwell himself noticed similarities between the magnetic vector potential [formula] and the velocity field [formula], describing the flow of a fluid in which magnetic field lines are embedded [\cite=maxwell1861] [\cite=siegel2002]. Indeed, an analogy is even drawn between the Biermann battery term in the two-fluid Induction Equations and the baroclinic term in the evolution equations for fluid vorticity [\cite=brandenburg2005rev] [\cite=kulsrud1996]. In recent times, many authors have gone further and have attempted to analyse similarities in physical behaviours between these two fields [\cite=arbab2011] [\cite=kulsrud1996] [\cite=martins2009] [\cite=martins2012], which is a key step in developing the theory of analogy. In particular, [\cite=kulsrud1996] discusses the analogy between the magnetic field and vorticity, noting that their root mean square (rms) strengths appear to saturate around the same time, as well as with the same strength in the case for a turbulent dynamo acting on the magnetic field.

This work considers more technical aspects of the simulations. In the following sections, we first introduce the governing equations of MHD in the forms in which they will be solved for our purposes, and spend some time discussing the analogous system consisting of the Induction and Vorticity equations. A brief description of the Pencil Code is then given and its solution strategy is discussed. We then turn to discussing the issue of mesh resolution selection before presenting our main results which focus on the conditions under which an analogy between the magnetic field and vorticity would hold. For our purposes, we discuss the results obtained in terms of the magnetic Prandtl number, [formula], particular to that run in order to ascertain the conditions under which the analogy will hold, given known values of magnetic diffusivity and kinematic viscosity. The behaviour observed in the results of our simulations is then discussed in relation to physical behaviour that has already been reported in literature thus far.

Governing Equations

In this section we collect all equations relevant to the two systems we intend to analyse and compare.

The Magnetohydrodynamics Equations

The hydrodynamics of a charged fluid are governed by the equations of Magnetohydrodynamics (MHD). These include the fluid continuity equation, the Navier-Stokes equations and the magnetic Induction Equations. These are listed below in units of μ0 = 1, where μ0 is the permiability of free space.

Here, ρ is the fluid density, [formula] is the veloctiy field, p is the fluid pressure, [formula] the magnetic vector potential, [formula] the magnetic flux density (related to [formula] via [formula] and hereafter simply referred to as the magnetic field), ν the fluid viscosity and η the magnetic diffusivity. Equations ([\ref=eq:ind]) are traditionally written in terms of and solved for [formula]; writing them in terms of and solving for [formula] automatically fulfills the divergenceless condition on [formula]. This set of equations would also normally include an evolution equation for the internal energy, U, or entropy, s, of the system; however, we do not consider the effects of entropy in this paper. Equations ([\ref=eq:cont]) -- ([\ref=eq:ind]) in their given forms are solved numerically in the results presented. We now consider the relevant analogous equations that are the primary theme in this paper.

The Relevant Analogous System

The equations we consider are the following:

It can be shown that equations ([\ref=eq:indb]) and ([\ref=eq:vort]) are simply the curled versions of equations ([\ref=eq:ns]) and ([\ref=eq:ind]) given above. The form of eqn ([\ref=eq:vort]) demands that [formula] is necessarily solenoidal. As with the case for the magnetic vector potential, [formula], [formula] may be recovered similarly from [formula] through integration. Written in this form, it is clear that the two equations are structurally identical. When a Biermann battery term is added to eqn ([\ref=eq:indb]), which arises naturally when considering a fluid consisting of both protons and electrons, the system takes the form: where the speed of light in vacuo c has been set to 1 in eqn ([\ref=eq:indbatt]). Using the rescaling for [formula] in [\cite=osanoadams2016-2], and where the subscripts (nf) and (cf) denote a neutral and charged fluid respectively. Note that the appearance of the corresponding "battery term" in eqn ([\ref=eq:vortbatt]) is due to the presence of the pressure term in the Navier-Stokes equations (eqns ([\ref=eq:ns])). Eqns ([\ref=eq:vortbatt]) and ([\ref=eq:indbatt]) are still structurally identical and may be written in a unified form as [\cite=osanoadams2016-2]:

[formula]

where [formula] or -  B, d  =  ν or η and ([formula]f) refers to either a neutral or charged fluid. Though we do not consider the effects of the Biermann battery term in this paper, we shall still compare the root mean square (rms) strengths of [formula] and [formula] when presenting and discussing the results of our simulations in the following section.

The Pencil Code

The Pencil Code is a publicly-available high-order finite differences MHD code that is well-suited to the study of various problems in MHD, including forced MHD turbulence, studies of dynamos, weakly-compressible flows and convection problems [\cite=pencilman], it may be extended to study limits of MHD approximations and even predictions resulting from new extensions to Maxwells equations such as in [\cite=osano2016], and its accompanying MHD extension [\cite=genmaxwmhd]. Many MHD codes often make use of spectral schemes in solving the equations of MHD due to their high accuracy, but are often limited to only a small subsection of MHD applications due to their complexity. High-order finite difference codes are becoming increasingly popular due to their ease of implementation, parallelization and suitability for the study of a larger number of MHD problems.

As mentioned before, the Pencil Code comes from the latter family of MHD codes. The code itself is modular, in the sense that different variables and physical processes are consolidated into modules which can be included or excluded from any particular run as the need arises [\cite=pencilman]. As an example: it is possible to simulate both MHD and normal hydrodynamics by including or excluding the code's Magnetic module which what we have done in this study. The Pencil Code solves eqns ([\ref=eq:cont]) - ([\ref=eq:ind]) in their given forms.

The Pencil Code is itself a non-conservative code, solving the the MHD equations in their so-called non-conservative form [\cite=brandenburgdobler2002] [\cite=pencilman]. Thus, the quality of solutions can be checked by monitoring how well certain conserved quantities (such as entropy, mass and momentum) are conserved for the duration of a partiular run. These conserved quantities are thus only conserved up to the discretisation error of the numerical scheme, rather than up to machine accuracy [\cite=pencilman]. For more details on the code's technical aspects, the reader is referred to [\cite=brandenburg2001] [\cite=pencilman].

Simulation Results and Discussion

We now present the results of our simulations.

Selecting Mesh Size

We first present the results of initial simulations in which we compare the different mesh size and their suitability for our purposes, after which we present the main results. For these simulations, we consider a neutral fluid which evolved according to a simplified system consisting only of eqns ([\ref=eq:cont]) and ([\ref=eq:ns]) and having different values of ν. Simulation boxes of sizes 323, 643 and 1283 are used and the temporal evolution of [formula] and [formula] observed. A summary of simulation parameters are listed in table [\ref=tab:simpars1]. The run results are in general similar, and hence we only present those of runs 1 and 3 in this section for illustration.

In run 1, we set ν  =  0, corresponding to an inviscid fluid (thereby eliminating the diffusive term in eqn ([\ref=eq:ns])). The evolutions of [formula] and [formula] are presented in figures [\ref=fig:unutestrun0] and [\ref=fig:onutestrun0]. All three of the considered meshes indicate that [formula] experiences marginal decay, which could be approximated using a straight flat line ( consistent with a constant terrm). The magnitude of [formula] remains constant for the duration of the run. It should be noted here that the 1283 box which produced a slightly weaker [formula] produces the strongest [formula] and vice versa for the case of the 323 box. This is to be expected due to the fact that the 1283 box's [formula] solution shows the most pronounced decay over the duration of the run, thus producing a stronger [formula].

For run 3 we set set ν  =  10- 3, corresponding to a viscous fluid where the corresponding eqn ([\ref=eq:ns]) has a non-vanishing diffusive term. We observe more pronounced decay patterns for [formula] for all the boxes under consideration, the effect of non vanishing diffusion. Unlike in the previous case, we also note that [formula] is now also decaying due to the presence of a non-vanishing diffusive term in its evolution equation. For the same reasons given previously, the 1283 box produces the strongest initial [formula] which then decays sharply, whilst the 323 box produces the weakest initial [formula] which then decays slowly when compared to the other two boxes.

Disregarding the differences in strengths of [formula] and [formula] produced by the three boxes under consideration, we note that the results obtained are qualitatively identical. Due to fineness of mesh, computation times for the 643 and 1283 boxes are also very much longer than compared to the 323 box; the former two stopping at an earlier value of the simulation time t when compared to the 323 box. In addition, the nature of the simulations conduced in this paper do not require very fine mesh. For these reasons, we choose to use the 323 box as our preferred mesh for simulation. We now turn to main results of the simulations.

Main Results

As mentioned above, a 323 periodic box of dimensions [formula] was utilized for these simulations. All initial conditions were set to Gaussian noise of small amplitude, and the temporal growth of the rms strengths of the relevant quantities (i.e. [formula], [formula], [formula] and [formula]) observed and compared.

The values of η and ν were adjusted in each run in such a way that three specific cases of the magnetic Prandtl number (defined as [formula]) are investigated: [formula], [formula] and [formula]. The special cases of [formula] and [formula] were also investigated. Of particular interest to us are the cases where [formula], where the analogy between the evolution equations for [formula] and [formula], and thus also for [formula] and [formula], breaks down. Simulation parameters together with the associated magnetic Reynolds number, [formula], for that run are summarized in table [\ref=tab:simpars2].

In all of the simulations conducted, the aim was to determine under which conditions the analogy between the magnetic field and vorticity field would hold true. As suggested in our previous work [\cite=osanoadams2016-1] as well as [\cite=kulsrud1996], the analogy should hold true for the case where [formula]; though the other cases are also of interest in observing the behaviour of the fluids under consideration.

Evolution of the velocity and vorticity fields

We first consider the temporal evolution of [formula] and [formula] with respect to different values of ν. In particular, we are interested in conditions that we would lead to growing field strengths for both quantities. For simplicity, the Lorentz Force term was dropped from the Navier-Stokes Equations, meaning that there is essentially no way in which the magnetic field can interact with the fluid. Physically, we are then considering a system in which the back-reaction by the magnetic field on the fluid plays is essentially negligible. In light of this it is more sensible to discuss the temporal evolution of [formula] (and hence [formula]) with respect to different values of ν.

Note, however, that the fluid naturally interacts with the magnetic field via the induction term in eqns ([\ref=eq:ind]). Cases involving the consideration of the back-reaction and other non-linear effects will be considered in an upcoming work [\cite=turbonset].

Examining the temporal evolution behaviour displayed by the velocity and vorticity fields in figures [\ref=fig:uvst] and [\ref=fig:ovst], it is clear that as [formula], the exponential decay in the rms strengths observed becomes visibly slower until eventually the value of ν = 0 is reached, producing exponentially-growing rms field strengths. From the point-of-view of eqns ([\ref=eq:ns]), this behaviour is expected, as ν essentially amplifies the effect of the diffusive term in a particular way.

As have chosen to examine the case of eqns ([\ref=eq:indbatt]) without the Biermann battery term, effectively also dropping the pressure term from eqns ([\ref=eq:ns]), and thus the corresponding "battery term" from eqns ([\ref=eq:vortbatt]), we also observe no accelerated decay in [formula] and [formula] which may be attributed to the presence of these terms.

Evolution of the magnetic vector potential and magnetic flux density

Results of simulating [formula] and [formula] for different values of [formula] are displayed in figures [\ref=fig:avst] and [\ref=fig:bvst]. From the temporal evolution behaviour of both [formula] and [formula], it appears that as [formula] increases, the rate of the exponential decay observed in the rms strengths for both fields becomes progressively slower until a turning point is reached beyond which the fields begin to grow.

The cases for [formula] and [formula] are particularly interesting: initially the rms strengths of [formula] and [formula] for the case of [formula] are somewhat greater than the rms strengths of these quantities for the case of [formula]. However, after a finite amount of time (around 97s-98s for [formula] and 154s - 155s for [formula]) there is a cross-over and [formula] and [formula] for the case of [formula] end up being somewhat stronger for the remainder of the run. This cross-over is not seen in figures [\ref=fig:avst] and [\ref=fig:bvst] due to the fact that the difference between the strengths of [formula] and [formula] for these fields is very small; the lines describing their temporal evolution thus appear to be superimposed on each other.

This crossover and final difference in strength can explain the apparent contradiction by recalling that we had observed exponentially-growing field strengths for [formula] and [formula] for the case of ν = 0 (and hence [formula]). As the velocity field interacts with the magnetic field, we would expect to see a slightly stronger magnetic field rms strength for the case of [formula] after some time, as the velocity field rms strength is growing exponentially, despite the exponential decay in rms strength of the former field.

The analogy between the vorticity and magnetic fields

We now turn to discussing the analogy between eqns ([\ref=eq:vort]) and ([\ref=eq:indb]), as well as their counterparts, eqns ([\ref=eq:ns]) and ([\ref=eq:ind]). The simulation results discussed in this section are presented in figures [\ref=fig:uvsa] and [\ref=fig:ovsb].

As was noted in our previous work [\cite=osanoadams2016-2], the analogy between the vorticity and magnetic fields ( and the velocity and magnetic vector potential fields by extension) appeared to hold true when [formula] (where ν  =  η = 10- 10; weak dissipation). As can be seen in figures [\ref=fig:uvsa] and [\ref=fig:ovsb], this is still the case for ν  =  η  ≠  10- 10 ( of course [formula]). It can also be seen that as [formula], [formula], indicating a correlation between the growth or decay of the rms strength of the vorticity field and the rms strength of the magnetic field. Although the linear relationship breaks down for the cases where [formula], the aforementioned correlation indeed still holds. This non-linear relationship may be explained simply by noting that by having ν  ≠  η, there is the opportunity that one quantity would grow or decay faster than the other.

Presented in figures [\ref=fig:uvsaallprm] and [\ref=fig:ovsballprm] are the cases of [formula] versus [formula] and [formula] versus [formula] for all of the simulations that were conducted. Again, it can be seen that as [formula] and [formula], the linear relationships seen for the case of [formula] vanish. It clear that as [formula] approaches the bounds at zero and infinity, these non-linear relationships appear to form an "envelope" around the cases for the various [formula]. The cases of [formula] and [formula] deserve to be examined in some more detail; we brief comment on them.

The Special Cases of [formula] and [formula]

In order to investigate the behaviour of the fluids for [formula] and [formula], we present plots of [formula] versus [formula] for these cases in figures [\ref=fig:uvsaprm0], [\ref=fig:ovsbprm0], [\ref=fig:uvsaprminf] and [\ref=fig:ovsbprminf].

For the case of [formula] it is suggested from figures [\ref=fig:uvsaprm0] and [\ref=fig:ovsbprm0] that [formula] versus [formula] and [formula] versus [formula] do not form an upper-enclosing "envelope", with the curves for all the simulated values of η growing in a direction opposite to what is presented for the case of [formula]. This behaviour could possibly be due to systemic effects within the code itself, or could be physically movtivated from the point-of-view of the equations that because of the lack of a diffusive term in eqn ([\ref=eq:ns]), the velocity and vorticity field strengths continue to grow very slowly, thus not being able to aid the magnetic vector potential and magnetic field strengths in growing whose equations do have a non-vanishing diffusive term in them. On the side of the magnetic field, diffusion prevails and causes the field and potential strengths to decay overall.

For the case of [formula], an argument similar to the case of [formula] holds. From figures [\ref=fig:uvsaprminf] and [\ref=fig:ovsbprminf], it is suggested that only the case of ν = 10- 5 will not form part of the lower-enclosing "envelope" to which the shape of the curves for [formula] appear to tend towards, whilst the other cases of non-zero ν do in fact form part of this "envelope". Again, we could attribute the behaviour seen in these plots to systemic effects within the code, but arguing from the point-of-view of the equations once more, we suggest that even these other cases of non-zero ν will not form part of this "envelope". This is due to the fact that whilst both of the Induction Equations do not possess a diffusive term, allowing for a slowly-growing magnetic field, the Navier-Stokes and Vorticity equations do, which causes the velocity and vorticity rms strengths to decay at a faster rate than that of the growth of the magnetic field and magnetic vector potential rms strengths. We suggest then that over time, the magnetic field and magnetic vector potential rms strengths would also begin decaying due to the decaying contribution of the velocity field strength in the induction term of the Induction Equations. Once more, this would cause the curves for the case of [formula] to grow in a different direction to that of the other curves and thus not form part of the "envelope".

It should be noted in figures [\ref=fig:uvsaprminf] and [\ref=fig:ovsbprminf] that the case for ν = 0 is special, as it represents a magnetic Prandtl number of 0 / 0, which is undefined. This case is itself degenerate and is only included for completeness.

Even though we have provided a physical explanation from the point-of-view of the equations for the results obtained above for the special cases of [formula] and [formula], further study is still needed. Physically, a neutral fluid having zero viscosity is often referred to as a superfluid. These superfluids are known for not behaving in the standard ways described by Fluid Dynamics, meaning that care should be taken when simulating them numerically. A similar argument can be made for charged fluids with zero and infinite magnetic diffusion. We thus conclude that the results obtained for these cases should be treated with utmost care and not readily be attributed to any physical behaviour.

Conclusion

In this paper we have presented simulations exploring the analogy between vorticity and magnetic fields, with a strong focus on technical details, and have found strong evidence in support of an analogy between the two fields. The results in this article (i) reaffirms what is known from previous analysis and (ii) extends the analysis to a full spectrum of fluids. It is clear that both the evolution equations and the corresponding simulations indicate that the two fluids are analogues. For simplicity, we had neglected the effects of any "battery terms" in the relevant equations, as well as the Lorentz Force term in the Navier-Stokes equations, deferring these considerations to later works. We also investigated the conditions under which we could achieve exponential growth in the rms field strengths of the velocity, vorticity, magnetic vector potential and magnetic flux density fields and found that when ν = 0, exponential growth was achieved for the velocity and vorticity fields' rms strengths, and when [formula], exponential growth was achieved for the magnetic vector potential and flux density fields' rms strengths. As expected, the magnetic Prandtl number ([formula]) played no role in seeking exponentially-growing strengths for the velocity and vorticity fields due to the absence of the Lorentz Force term in the Navier-Stokes equations. Further investigation into the exact nature of [formula] and the conditions under which these fields would achieve exponential growth is needed in order to confirm any definite relationship. In addition, further investigation into the nature of the relationship between [formula] and the analogy between the vorticity and magnetic fields in the presence of a battery term is also needed and will be investigated in a later work.

Acknowledgements

Patrick W. M. Adams acknowledges funding support from the National Research Foundation (NRF) of South Africa, as well as funding from the University of Cape Town, both administered by the Postgraduate Funding Office (PGFO) of the University of Cape Town. Bob Osano acknowledges URC funding support administered by the University of Cape Town. A special vote of thanks also goes to the members of the pencil-code-discuss group for technical advice on the Pencil Code.