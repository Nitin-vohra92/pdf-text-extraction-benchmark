Simulating generic spin-boson models with matrix product states

Introduction

The coupling of spins to bosonic modes provides a paradigmatic setting for various important phenomena in many-body physics, such as decoherence, thermalization, virtually mediated long-range spin-spin interactions, and large-scale entanglement generation [\cite=PhysRevLett.104.073602] [\cite=bohnet2014reduced] [\cite=KasevichSqueezing]. The study of spin-boson models has historically belonged to the domain of condensed matter theory [\cite=caldeira1983quantum]. However, experimental setups available to atomic, molecular and optical (AMO) physics provide versatile, clean, and controllable realizations of such models. In particular, spin-boson models can be engineered in trapped ion systems by coupling the discrete phonon modes of the ion crystal to the ion spins [\cite=PhysRevLett.82.1971] [\cite=PhysRevLett.92.207901] [\cite=PhysRevLett.103.120502] [\cite=britton2012engineered] [\cite=PhysRevA.78.010101] and in cavities via cold atoms [\cite=RevModPhys.85.553] [\cite=PhysRevLett.104.073602] or artificial atoms built from superconducting qubits [\cite=niemczyk2010circuit] [\cite=hur2015many] coupled to quantized cavity modes; similar models can also be achieved in optomechanical setups [\cite=RevModPhys.86.1391]. While these AMO platforms differ from the most common condensed matter spin-boson analog-a two-state version of the Caldeira-Leggett model of a particle interacting with a continuum of harmonic oscillators-due to their discrete boson mode spectra, they offer clean systems in which one can observe out-of-equilibrium dynamics.

The long history of spin-boson models has led to the development of a range of theoretical approaches. The most prevalent one is to adiabatically eliminate the bosons, keeping only their virtual effect on the spins in the form of long-range spin-spin couplings [\cite=PhysRevLett.92.207901]. While this approach is useful in contexts where there is a very large separation of energy scales between the bosons and spins, in many experimental realizations and applications such an approach is invalid. An additional powerful approach, valid in the case that only uniform, collective spin operators appear in the Hamiltonian, uses the permutational symmetry of the density matrix to reduce the computational scaling of direct numerical diagonalization from exponential to polynomial in the number of spins [\cite=Carmichael] [\cite=hartmann2012generalized] [\cite=PhysRevB.91.035306]. Outside of the uniform coupling regime, analytical results have recently been obtained in a special case in which the coupling Hamiltonian is linear in boson operators and commutes with the spin Hamiltonian [\cite=Dylewsky]. However, in spite of the importance of the many-spin, many boson problem to myriad fields of physics, a general, systematic approach to study their quantum dynamics has yet to be developed.

In what follows, we show that spin-boson models with global coupling can be systematically treated with well-characterized error using the framework of matrix product states (MPSs). Our methodology consists of two complementary methods for treating the out-of-equilibrium dynamics. The first, using the technology of swap gates [\cite=TTN] to deform the MPS topology dynamically, is most efficient in the case of few bosons or at weak coupling, but has a rigorously bounded, systematically correctable error. The second uses an exact matrix product operator (MPO) representation of the spin-boson Hamiltonian, and time-evolves under this Hamiltonian using recently developed techniques for time evolution with long-range couplings [\cite=Zaletel], together with safeguards against variational metastability. This latter method is most efficient when the number of bosonic modes is equal to the number of spins, relevant for trapped ion quantum simulators in certain cases.

This paper is organized as follows: Sec. [\ref=sec:Form] presents our numerical formalism, which includes a brief review of matrix product states (MPSs) and operators as well as our new MPS-based methodologies for spin-boson systems; Sec. [\ref=sec:Benchmark] discusses benchmark calculations of our methods for 1D and 2D systems of trapped ions in the parameter regimes of recent experiments [\cite=richerme2014non] [\cite=bohnet2015quantum]; Sec. [\ref=sec:QT] extends our formalism to open quantum systems through the technique of quantum trajectories; and Sec. [\ref=sec:Impure] presents simulations of trapped ion systems in the presence of impurity ions where decoherence and spatially non-uniform spin-boson couplings invalidate many other approaches; Finally, in Sec. [\ref=sec:Concl] we conclude and give an outlook on broad applications of our methods. Some technical results are given as appendices.

Formalism

We consider a collection of [formula] spins localized on a lattice and coupled globally to [formula] bosonic modes, shown schematically in Fig. [\ref=fig:Snake!]. We take the Hamiltonian to have the generic form

[formula]

where [formula] acts only on the spins, [formula] only on the bosons, and the spin-boson coupling has the form

[formula]

Here and throughout, roman letters i refer to spin indices and greek letters μ to boson indices. The operators [formula] and [formula] can be taken to be Hermitian, and act on bosons and spins, respectively. The index α counts the number of such pairs of Hermitian operators, e.g., [formula] has n = 1 while [formula] has n = 2. While we will continually refer to our degrees of freedom as being spins, our approach can be straightforwardly generalized from spins to mobile particles with any quantum statistics. A key feature of this general model is that the coupling between bosons and spins is arbitrary, i.e. each boson mode μ can be coupled to each spin i with an arbitrary amplitude and operator pairs [formula]. In contrast to approaches based on permutational symmetry of the density matrix [\cite=Carmichael] [\cite=hartmann2012generalized] [\cite=PhysRevB.91.035306], we do not require that this coupling is uniform; our approach applies for any amplitudes [formula] and operators [formula] and [formula]. Many iconic models can be cast in the form Eq. [\eqref=eq:HFull], including the Rabi [\cite=gardas2011exact] [\cite=Braak], Jaynes-Cummings [\cite=JC] [\cite=Eberly], and Tavis-Cummings [\cite=Agarwal] models of quantum optics and optomechanics [\cite=RevModPhys.86.1391] and the Holstein-Hubbard [\cite=Jeckelmann] model of condensed matter physics. Also, we point out that our setting is more general than previous spin-boson approaches using related density-matrix renormalization group (DMRG) methods, in which each spin was coupled locally to a single boson [\cite=Jeckelmann] [\cite=Bursill] [\cite=Brockt], a single spin was coupled to many bosons [\cite=Guo] [\cite=Frenzel] [\cite=schroder2015simulating], or a single collective boson mode was coupled to many spins [\cite=Gammelmark].

Matrix product states and operators

Before proceeding to the details of how we simulate the out-of-equilibrium dynamics of Eq. [\eqref=eq:HFull], we remind the reader a few basic facts about matrix product states (MPSs) and matrix product operators (MPOs); a more detailed discussion can be found in, e.g., [\cite=Schollwoeck] [\cite=Orus]. The natural setting of MPSs is a 1D chain with L sites, where lattice site i can be in one of the di states |ji〉. An MPS is a representation of a many-body quantum state on such a lattice, defined as

[formula]

Here, [formula] is a χi - 1  ×  χi dimensional matrix, and the maximum value of any of the χk is called the bond dimension χ of the MPS. MPSs are exact ground states of 1D gapped models with short-range interactions [\cite=hastings2007area]. In addition, MPSs have proven to be a useful variational ansatz for long-range interacting systems [\cite=PhysRevB.78.035116] [\cite=PhysRevX.3.031015] [\cite=Wall_Carr_12], gapless systems, e.g., quantum critical points [\cite=Pollmann] [\cite=rams2014truncating], and quasi-higher-dimensional systems [\cite=Mishmash] [\cite=Stoudenmire_2D] [\cite=Depenbrock] by "snaking" a 1D line across the sites of the higher-dimensional lattice.

A matrix product operator (MPO) is the natural operator-valued extension of the MPS definition [\cite=mcculloch2007density] [\cite=PhysRevLett.93.207204]. It is a representation of a many-body operator acting on the same space defined for the MPS above, and has the form

[formula]

MPOs are of interest because (1) they take MPSs to MPSs (with, in general, larger bond dimension), (2) most many-body operators of interest, e.g. Hamiltonians, can be represented as MPOs with constant bond dimension by using a small set of MPO construction "rules" [\cite=PhysRevA.78.012356] [\cite=PhysRevA.81.062337] [\cite=pirvu2010matrix] [\cite=Wall_Carr_12], and (3) many MPS algorithms, such as variational search for the ground state and time evolution, can be formulated generically given that all many-body operators of interest have a known MPO form [\cite=Wall_Carr_12]. It is useful to re-write Eq. [\eqref=eq:MPOdef1] as

[formula]

where each one of the [formula] is an operator-valued matrix of the form, e. g.,

[formula]

The matrix indices are the fictitious "bond" indices contracted in the trace of Eq. [\eqref=eq:MPOdef2], and the indices of the individual operators, e.g., Â, run over the di states of the local physical Hilbert space. For simplicity, we have given a bond dimension two MPO matrix as an example, but any dimensionality is possible (see Eq. [\eqref=eq:HMPO]). A useful means of displaying MPSs, MPOs, and their operations is the Penrose tensor network diagram notation exemplified in Fig. [\ref=fig:TND]. In this notation, a tensor is an object with lines extending from it, with the number of lines equal to the rank of the tensor. A line connecting two tensors denotes that index is summed, or "contracted," between the two tensors.

Swap operator decomposition of the spin-boson state and propagator

In this section, we propose a method for simulating the out-of-equilibrium dynamics of Eq. [\eqref=eq:HFull] which is based on Trotter-Suzuki decompositions. First, we use a Trotter-Suzuki decomposition to isolate the action of [formula] from [formula] and [formula]. The simplest non-trivial such decomposition is ([formula] unless otherwise specified throughout)

[formula]

which is valid to order [formula]. While this is written in a form appropriate for time-independent Ĥ, a time-ordered version of this formula also exists [\cite=Huyghebaert_DeRaedt], as well as higher order decompositions in δt [\cite=omelyan2002optimized]. Since [formula] and [formula] commute by construction, the evolutions associated with these operators can be performed in any order. In the examples given in this paper both [formula] and [formula] are sums of single-site operators and so their exponentials are product operators which are trivial to apply to an MPS. Alternatively, in the most commonly encountered case that they are short-ranged, this propagation can be performed with ordinary t-DMRG [\cite=PhysRevLett.93.040502] [\cite=daley2004time].

We now turn to the application of [formula] to an MPS. We do so by using another Trotter-Suzuki decomposition to write this exponential as a product of two-site unitaries, each acting on a single spin and boson pair. The simplest such decomposition is

[formula]

and, as before, higher-order decompositions can be devised [\cite=Sornborger_Stewart]. In this expression, [formula] means the product [formula]. For a fixed ordering of MPS sites, the application of Eq. [\eqref=eq:STsb] requires coupling of sites which are not contiguous. While this can be done with a variety of available long-range time evolution methods for MPSs [\cite=Manmana] [\cite=GarciaRipoll] [\cite=Wall_Carr_12] [\cite=Zaletel] [\cite=haegeman2014unifying], such an approach can suffer from numerical issues, e.g. getting stuck far from the variational optimum. In contrast, applying an operator which couples neighboring sites in the 1D MPS representation can be performed efficiently, without issues of variational metastability, and with a precisely controlled error [\cite=PhysRevLett.93.040502].

We can apply the decomposed operator Eq. [\eqref=eq:STsb] to an MPS using only operations on neighboring sites by inserting swap gates Ŝμi which interchange the positions of boson μ and spin i in the MPS representation between different terms appearing in the product [\cite=TTN]. Swap gates have been previously used to implement MPS algorithms for periodic boundary conditions [\cite=Ippei], as well as for generic long-range time evolution [\cite=Stoudenmire_Metts]. In the latter case, long-range time evolution requires [formula] swaps per time step, where L is the total number of lattice sites; this can be prohibitively costly. In our case, only [formula] swaps are required, which is more favorable in the often realized case that Ns  ≫  Nb as well as the case Nb  ≫  Ns.

To see how the swapping works in practice, we show the tensor network diagram for a full application of [formula] for Ns = 3 and Nb = 2 in Fig. [\ref=fig:Swapping]. Here, the tensors in the initial MPS are circles (squares) for boson (spin) sites, [formula], and crossed lines indicate the application of a swap gate. Motivated by the form of the decomposition Eq. [\eqref=eq:STsb], a natural 1D chain ordering of the spins and bosons is to begin with all of the bosons left of the spins. In order to keep track of the position of the boson sites in the MPS representation, we draw a circle containing the mode index next to index lines corresponding to bosons, showing that each boson is moved past all of the spins using the swap gates. From the diagram it is clear that the combination of Trotter-Suzuki decomposition and swap gates leads to a propagator which involves only operations on nearest-neighbor sites.

Exact MPO representation of the spin-boson Hamiltonian

As the number of bosons approaches the number of spins, the scaling of the swapping method described in the last section approaches [formula], which can be prohibitively expensive. However, as we will discuss below, in this situation a direct simulation of the dynamics of the spin-boson system using a representation of the Hamiltonian with long-range couplings between spins and bosons can be efficient. Here, the ordering of the spins and bosons in the MPS representation can be chosen to minimize issues of variational metastability that can pose problems for long-range time evolution with MPSs. Before we discuss how to choose this ordering, we first show that Eq. [\eqref=eq:HFull] has an exact, compact MPO representation for spin-boson couplings of the form Eq. [\eqref=eq:HSB], irrespective of how the spins and bosons are ordered in the 1D array. For simplicity, we will write down the MPO in the case that [formula] and [formula] do not couple multiple sites and the sum over α in Eq. [\eqref=eq:HSB] contains a single term; this is the form of the Hamiltonian relevant for trapped ion experiments, as shown in Sec. [\ref=sec:Benchmark]. More complex spin and boson Hamiltonians can be formulated using known MPO constructions in the literature [\cite=PhysRevA.78.012356] [\cite=PhysRevA.81.062337] [\cite=pirvu2010matrix] [\cite=Wall_Carr_12], and more terms in the α summation can be included by matrix direct sums [\cite=mcculloch2007density]. Additionally, for compactness, we consider the case of two boson modes; the MPO for many modes is also a straightforward generalization.

To begin, we write the collection of Ns spins and 2 bosons as a 1D chain with (Ns + 2) sites, and let the boson modes μ = 1 and 2 be placed at sites j1 and j2, respectively, with j1 < j2. Then, the MPO matrices representing Eq. [\eqref=eq:HFull] take the form

[formula]

[formula]

Here, Îs (Îb) is the identity operator in the spin (boson) space, ij is the spin index for lattice site j, and the first (last) MPO matrix for open boundary conditions is the last row (first column) of the associated MPO matrix W. Remarkably, in spite of the generality and complexity of the model, Eq. [\eqref=eq:HFull], the Hamiltonian admits a very simple and compact representation. This MPO is useful not only for the out-of-equilibrium dynamics we discuss in the next section, but can also be used to find eigenstates variationally [\cite=Schollwoeck].

Long-range time evolution with Ns  =  Nb

Many methods for time evolution of MPSs exist which are applicable to general Hamiltonians in MPO form, such as the Krylov [\cite=Manmana] [\cite=GarciaRipoll] [\cite=Wall_Carr_12] and the local Runge-Kutta [\cite=Zaletel] methods, which require some form of variational optimization of an MPS, and the time-dependent variational principle [\cite=haegeman2014unifying], which has an additional error associated with projection of the Hamiltonian onto a local subspace. While such methods are useful in many cases, the error analysis and convergence behavior of these algorithms can be complex. Of particular concern when applying these algorithms to our Hamiltonian [\eqref=eq:HFull] via the exact MPO representation Eq. [\eqref=eq:HMPO] is that the effectiveness will depend strongly on the ordering of the spin and boson modes in the 1D MPS representation. This is especially true when many strongly coupled boson modes are present, as this situation can lead to glassy spin physics [\cite=gopalakrishnan2009emergent] [\cite=grass2015controlled] which may pose problems for variational optimization.

The main issue of variational metastability for systems with long-range interactions is that efficient MPS algorithms use an iterative local variational optimization to search for the global optimum [\cite=Schollwoeck], where local means that two neighboring sites are optimized at a time. Hence, MPS algorithms build up entanglement and correlations locally, two sites at a time, and then build up longer-ranged correlations and entanglement by repeated "sweeping," in which each pair of neighboring sites are optimized in a round-robin fashion. If there are long-ranged (farther than nearest-neighbor) terms in the Hamiltonian, entanglement resulting from these terms is not directly built in by the optimization, and so we must either build in the proper entanglement structure by hand or it must be incorporated in by other short-range terms in the Hamiltonian upon repeated sweeping.

For the system at hand and in the case Ns  =  Nb, we can ensure that all spins and bosons have a least some short-range entanglement built in during the optimization by alternating the spins and bosons in the 1D representation, see Fig. [\ref=fig:IIdia]. In this representation, each spin i neighbors boson μ = (i - 1) and μ = i, and hence entanglement between this spin and these bosons is directly generated as part of a two-site variational optimization procedure. The fluctuations of these boson modes can then couple to the fluctuations of further away spins, improving convergence to the global optimum. A further safeguard against variational metastability, in which a state with long-range coherence between spins and bosons far-separated in the MPS representation is explicitly mixed in during optimization to speed convergence, is described in Appendix [\ref=sec:VM]. Our method of choice for long-range time evolution is the second-order local Runge-Kutta method of Ref. [\cite=Zaletel].

Observables and fidelities

While the computation of observables with MPSs, e.g. single-spin expectations or two-point spin-spin correlation functions, is standard and discussed in review articles [\cite=Schollwoeck] [\cite=Orus], here we point out the measurement of two quantities which are non-standard. The first is the measurement of the full probability distribution of outcomes for a collective spin measurement along direction [formula], i.e. the full counting statistics (FCS) [formula] for m spins to be aligned along [formula]. To compute the FCS directly involves the computation of all correlation functions of any order, which in general scales poorly with the number of spins [\cite=Dylewsky]. However, the FCS can be computed efficiently given an MPS representation for the state of the spins by measuring the Fourier transform of this distribution, known as the characteristic function

[formula]

[formula], and then inverse Fourier transforming. Noting that

[formula]

the characteristic function for each k is the expectation of an MPO with bond dimension 1, which can be performed at the same [formula] cost as taking the overlap of two MPSs, see Fig. [\ref=fig:FCS]. The FCS is useful in trapped ion quantum simulators because it is readily accessible thanks to near single-ion resolution, and it provides detailed information about the structure of the state beyond low-order correlation functions [\cite=bohnet2015quantum].

Often, rather than simulating a complex model of spins coupled to bosons, one would like to integrate out the bosons and keep only their virtual effect in the form of an effective model acting only on the spins. The most stringent test of the faithfulness of this spin-only description is the fidelity between the reduced density matrix of the spin-boson system obtained by tracing out the bosons with that of a pure spin state evolving under an effective spin Hamiltonian. This fidelity is defined as

[formula]

where [formula] is the density matrix obtained from tracing the bosons out from the pure spin-boson state |ψ〉 and ρ = |Ψ〉〈Ψ| is the density matrix of pure state |Ψ〉 containing only spins. As ρ is pure, we find that

[formula]

As we intend to trace out the bosons, it is useful to separate the bosons and spins spatially in the MPS representation. Such a representation naturally appears in our swapping dynamics protocol, see Fig. [\ref=fig:Swapping], and can be obtained straightforwardly from any representation using swap gates. With this ordering, the fidelity has a simple tensor network representation as the norm of a vector L, provided both |ψ〉 and |Ψ〉 have known MPS representations and the boson tensors are in left-canonical form [\cite=Schollwoeck], as shown in Fig. [\ref=fig:Fidelity]. The restriction on canonical form, which involves no loss of generality, simply uses the freedom inherent in the MPS ansatz to transform the contraction over boson states into the identity, making the trace over bosonic degrees of freedom particularly simple.

Benchmark calculations for 1D and 2D trapped ion systems

As an application of the above methods, we will consider crystals of trapped ions subject to a spin-dependent force. Such systems have been a topic of great recent interest due to their capability of performing high-fidelity quantum simulation of long-range interacting quantum spin models [\cite=PhysRevLett.92.207901]. In these systems, a competition between the Coulomb repulsion of the ions and external trapping from electromagnetic potentials leads to a crystalline structure for the ions in equilibrium. The normal modes of these equilibrium crystal structures comprise a set of global boson (phonon) modes, which are then coupled to the spin of the ions using lasers in a Raman scheme with characteristic wavevector kR to impart a spin-dependent force along the direction perpendicular to the crystal structure [\cite=leibfried2003experimental] [\cite=milburn2000ion] [\cite=PhysRevA.62.022311] [\cite=PhysRevLett.82.1971] [\cite=islam2013emergence]. After performing a frame transformation on the spins, the Hamiltonian is expanded to lowest order in the Lamb-Dicke parameters [formula], where M is the mass of an ion and {ωμ} are the phonon normal mode frequencies. In addition, we will transform the phonons to a frame rotating with ωR, the Raman beatnote frequency of the beams creating the spin-dependent force, and enact a rotating wave approximation. While this approximation will fail for very large detunings, we have verified that it is an excellent approximation for the parameter regimes explored in this work, and it leads to time-independent Hamiltonians which are more amenable to numerical computation. Following these steps, the Hamiltonian takes the form of Eq. [\eqref=eq:HFull] with [formula], [formula], and

[formula]

Here, δμ  =  ωR  -  ωμ is the detuning of mode μ from the Raman beatnote frequency, Ωμ = Fημ / kR, with F the magnitude of the spin-dependent force, quantifies the strength of the spin-dependent force for mode μ, and [formula] is the normal mode amplitude vector of phonon μ.

The effective Hamiltonian describing the time-dependent dynamics of Eq. [\eqref=eq:Hions] can be found by moving to an interaction picture which rotates with [formula] and using the Magnus series [\cite=Magnus_54] [\cite=Blanes_Casas_09]. Due to the fact that all spin operators in [formula] commute and the boson operators form [formula] copies of the Heisenberg algebra, the Magnus series truncates exactly at second order, and the propagator may be written exactly within the rotating wave approximation as

[formula]

with the spin-phonon coupling propagator

[formula]

and the spin-spin coupling propagator

[formula]

In these expressions, we have defined

[formula]

and

[formula]

Noting that the last term in the braces of Eq. [\eqref=eq:SpinSpinTD] is bounded while the first grows without bound, [formula] is commonly approximated as [formula], where

[formula]

In this approximation, [formula] is the propagator of a long-range Ising model [formula].

Trapped ion quantum spin simulator experiments can be divided into two regimes parameterized by their hierarchy of energy scales. This categorization also currently coincides with the effective dimensionality of the ion crystal in present experiments, with 1D crystals corresponding to linear Paul traps [\cite=PhysRevLett.103.120502], and 2D systems forming in Penning traps [\cite=britton2012engineered]. Experiments in 1D Paul traps typically operate in the regime δμ  ≫  Ωμ, in which all modes of the ion crystal participate in the dynamics. In contrast, current experiments in the 2D Penning trap operate in the regime where δμ  ≫  Ωμ for all modes except for the center of mass mode [formula], for which [formula]. Hence, the center of mass mode dominates the dynamics in these experiments. We stress that both types of traps can operate in both parameters regimes in principle, and our grouping of parameter regimes with dimensionality refers only to current experiments.

We numerically find the equilibrium positions of the ions following Ref. [\cite=james1998quantum] for the Paul trap and Ref. [\cite=PhysRevA.87.013422] for the Penning trap; typical equilibrium structures and effective spin-spin couplings are shown in Fig. [\ref=fig:modesandJs]. The spin-spin interactions in the 2D array with detuning close to the center of mass, shown in Fig. [\ref=fig:modesandJs](d), are well-approximated by a uniform, all-to-all interaction. In contrast, the effective range of the interactions for typical parameters in linear Paul traps, modeled as a power law decay Jij  ~  1 / |ri - rj|α [\cite=britton2012engineered] [\cite=PhysRevA.92.043405], depends on the detuning, see Fig. [\ref=fig:modesandJs](b)-(c).

Remarkably, an exact solution for the dynamics of Eq. [\eqref=eq:Hions] exists when starting from an uncorrelated product state of phonons and spins [\cite=Dylewsky]. We will use this exact solution to numerically benchmark our methodologies in both the 2D case, where we keep only a single boson mode and use the swapping method described in Sec. [\ref=sec:MI], and in the 1D case, where we keep all modes and use the methods of Sec. [\ref=sec:MII]. In particular, we will compare the one- and two-point correlation functions

[formula]

[formula]

[formula]

where a,b∈{ + , - } and we have taken the initial state in which all phonons start in the vacuum state and all spins initial point along the + x direction. In general, the phonon temperature in trapped ion experiments is nonzero. Our methods as presented here, as well as the exact solution, can be readily extended to any phonon pure state, and hence be used to generate thermal expectations by summing over Fock state expectations. The effects of finite phonon temperature have been analyzed using the exact solution in Ref. [\cite=Dylewsky]. A more efficient method for large numbers of phonons may be to use MPS methods specifically designed for finite-temperature systems [\cite=feiguin_white_05] [\cite=white_09].

In what follows, we also use an MPS ansatz which explicitly conserves the [formula] symmetry of Eq. [\eqref=eq:Hions] associated with the parity operators [formula] and [formula] for spin-boson and spin systems, respectively, as conservation of symmetries leads to significant computational gains in MPS algorithms [\cite=PhysRevA.82.050301] [\cite=PhysRevB.83.115125]. For the MPS calculations on pure spin models, we calculate the dynamics by fitting a long-range spin model with time-independent spin-spin couplings determined by Eq. [\eqref=eq:SSapprx] to an MPO, and then time-evolve using the local Runge-Kutta method of Ref. [\cite=Zaletel]. As these spin-spin couplings are not translationally invariant, we use the non-uniform exponential MPO fitting method developed in Refs. [\cite=koller2016dynamics] [\cite=Wallinprep].

We begin our benchmarking by looking at the 1D case, in which the drive of the spin-dependent force is far detuned above the center of mass mode and so all phonon modes contribute to the dynamics. In particular, we consider the detunings above the center of mass mode δ / h = 80kHz and δ / h = 150kHz, employed in Ref. [\cite=richerme2014non], and which results in the effective spin-spin couplings shown in Fig. [\ref=fig:modesandJs](c). When the spin-dependent force is turned on, the effective Ising interactions will cause a coherent depolarization of the collective spin length [formula] concurrent with the development of collective spin-spin correlations [formula]. In addition, spin-phonon entanglement resulting from spin-dependent displacements of the phonon modes will cause oscillations in collective spin observables. Both effects are seen in Fig. [\ref=fig:1DContrast], which compares the numerically computed collective spin expectations (red symbols) with the exact, analytic expressions Eq. [\eqref=eq:exb]-[\eqref=eq:exe] (blue lines). Panel (a) shows the depolarization of the collective spin for the δ / h = 80kHz detuning, with the inset showing the small amplitude oscillations due to dynamical phonons which are perfectly captured within our numerical approach. Panel (b) shows the development of collective spin-spin correlations for the δ / h = 150kHz detuned situation. Here, the numerical points are indistinguishable from the analytical curves on the scale of the plot, again demonstrating excellent agreement.

As mentioned above, the most stringent test of the fidelity of quantum simulation of a pure spin model can be obtained by measuring the fidelity of the spin reduced density matrix obtained from the wavefunction of the full spin-boson dynamics |ψ〉 by tracing out the bosons, [formula], with the pure spin density matrix ρ obtained from evolution under the time-independent Ising model, Eq. [\eqref=eq:SSapprx]. We compute this quantity using the methods of Sec. [\ref=sec:OaF]; the results are shown in Fig. [\ref=fig:1DFidelity] for the two detunings we consider. We see rapid oscillations at many frequencies, corresponding to the generation of spin-phonon entanglement with all phonon modes. However, throughout the course of reasonable experimental timescales, the fidelity remains quite high, [formula]. We stress that the computation of this fidelity in the multimode case using the exact solution of the spin-boson dynamics [\cite=Dylewsky] scales poorly with the number of spins; in contrast, this quantity is easily calculated within our numerical framework

We now turn to the 2D case, in which only the center of mass mode participates in the dynamics and we use the swapping method (Sec. [\ref=sec:MI]) to compute the dynamics. We use the parameters of Fig. [\ref=fig:modesandJs], which are similar to recent experiments [\cite=bohnet2015quantum]. A key observable in these experiments is the Ramsey squeezing parameter, defined as [\cite=PhysRevA.47.5138]

[formula]

with ΔS2θ  =  〈Ŝ2θ〉  -  〈Ŝθ〉2 and Ŝθ  =   cos θŜz  +   sin θŜy. The squeezing parameter is of interest because the condition ξ2 < 1 witnesses entanglement in the system [\cite=PhysRevLett.86.4431], and ξ2 also quantifies the signal to noise enhancement of the spin state for performing Ramsey spectroscopy compared to an uncorrelated spin state [\cite=PhysRevA.46.R6797]. Fig. [\ref=fig:2DSqueezing] displays the squeezing as a function of time starting from all spins aligned along x, and compares this with the results of simulating the time-independent Ising model Eq. [\eqref=eq:SSapprx]. While the pure spin approach predicts a smooth buildup of squeezing to a maximal point followed by monotonic destruction of squeezing, the spin-boson dynamics displays oscillations resulting from the development of spin-phonon entanglement, which tends to antisqueeze the spin distribution, as well as from the time dependence of the spin-spin couplings [formula]( see Eq. [\eqref=eq:SpinSpinTD]). However, the two results agree at the decoupling times td = 2πδ, n an integer, where the spin-phonon entanglement vanishes. While we do not show it here, we again find excellent agreement between our computed values and the exact solution, validating the swapping approach to dynamics.

The modification of spin observables due to spin-phonon entanglement is strikingly seen by comparing the full counting statistics (FCS) of collective spin observables between the spin-boson and pure spin approaches. The computation of these quantities from the analytical solution scale polynomially in the number of spins in the case that only the center of mass mode participates in the dynamics [\cite=bohnet2015quantum], but also requires high-precision arithmetic to avoid catastrophic cancellation. In the general case, the computation of these quantities scales exponentially in [formula]. However, as discussed in Sec. [\ref=sec:OaF], the computation of the FCS is particularly straightforward within our MPS-based approach. Fig. [\ref=fig:2DFCS] displays the FCS along the antisqueezed quadrature [formula] as well as the squeezed quadrature [formula] such that [formula] minimizes the spin variance ΔS2. The upper panels (a)-(b) display the squeezed quadrature, which show the development of a narrow feature which is useful for sub-shot-noise spectroscopy, with panel (a) corresponding to the coupled spin-boson dynamics and panel (b) to the pure spin dynamics. The pure spin dynamics shows a monotonic development of this narrow feature, while this feature is periodically broadened and its height modulated in the spin-boson dynamics due to spin-phonon entanglement. The antisqueezed quadratures, shown in panels (c)-(d), initially broaden with respect to the initial uncorrelated state before developing fine-scale features whose usefulness for metrology are not witnessed by spin squeezing but can be captured via other measures, such as the quantum Fisher information [\cite=PhysRevLett.102.100401] [\cite=bohnet2015quantum]. A comparison between the pure spin and spin-boson calculations again shows periodic differences driven by spin-phonon entanglement, but the differences are more slight compared to the squeezed quadrature.

Including decoherence: Quantum Trajectories

An important component of many AMO experiments is losses and other forms of dissipation, which are usually thought to degrade coherence and destroy quantum correlations, but can also lead to the production of entangled steady states [\cite=PhysRevLett.107.080503] [\cite=PhysRevLett.109.230501] [\cite=lin2013dissipative]. A major source of decoherence in trapped ion systems arises from scattering of the light used to create the spin-dependent force [\cite=PhysRevLett.105.200401]. A full description of the system including losses is found by solving the master equation

[formula]

where [formula] is the system density matrix and the action of the Lindbladian superoperator accounting for spontaneous emission from the Raman beams is given as

[formula]

Here, the terms proportional to [formula] and [formula] correspond to spontaneous excitation and de-excitation, respectively, from Raman scattering, and the term proportional to [formula] represents elastic dephasing.

It is possible to apply MPS-based approaches to directly simulate master equations by replacing states by operators ("superkets") and operators by superoperators, in which the local dimension of superket i is d2i, the square of the physical on-site Hilbert space [\cite=PhysRevLett.93.207205] [\cite=PhysRevLett.93.207204]. Here, we instead use the method of quantum trajectories, in its first-order incarnation [\cite=RevModPhys.70.101] [\cite=doi:10.1080/00018732.2014.933502]. To do so, it is useful to re-write the master equation as

[formula]

where the non-Hermitian effective Hamiltonian is

[formula]

and the recycling term is

[formula]

In these expressions, the "jump operators" {Ĵμ} are a basis in which the Lindbladian may be written as

[formula]

In the present case, we take the basis of jump operators to be the [formula] operators [formula] for [formula]. Now, at each time step, we evolve [formula] under [formula] to obtain [formula]. Because the effective Hamiltonian is non-Hermitian, the norm of this state, call it [formula], will be less than 1. At first order in δt, δp is comprised of a sum of terms [formula], where

[formula]

We now stochastically choose whether to use this state at the next time step, or undergo a "quantum jump" by applying the recycling term. Namely, we choose a random number [formula], and select the state at the next time step to be

[formula]

and then renormalizing the state. The equally weighted average of the expectation of an operator 〈Ô〉 taken with [formula] such stochastically generated trajectories converges to the dynamics of this same observable generated by the master equation with an error εÔ that is asymptotically statistical, [formula]. In closing, we note that the quantum trajectories method may be trivially parallelized.

Application: Trapped ion spin-boson simulators in the presence of molecular impurities

For a pure spin Ising model (i.e., without dynamical phonons), the summation over all quantum trajectories can be performed analytically, leading to an exact solution of arbitrary Ising models in the presence of decoherence [\cite=PhysRevA.87.042101] [\cite=1367-2630-15-11-113008]. When the dynamical motion of the phonons is included, however, no closed-form summation over quantum trajectories exists, and the dynamics must be obtained numerically. In what follows, we will consider the dynamics in the presence of decoherence as parameterized above in the 2D Penning trap where only the center of mass mode is relevant. In principle, these dynamics can be calculated efficiently, even in the presence of decoherence, for a spatially uniform initial state by restricting the Hilbert space to the space of permutationally symmetric density matrices [\cite=Carmichael] [\cite=hartmann2012generalized] [\cite=PhysRevB.91.035306]. In order to exemplify the power and generality of our approach compared to these other methods, we thus consider a case in which the center of mass mode is no longer spatially uniform. In particular, we simulate the case of an ion crystal in which some atomic ions have converted to heavier mass molecular ions through collisions with background gas, focusing on a crystal of Be+ ions with BeH+ impurities as a particular example [\cite=PhysRevA.91.011401].

Impurity molecular ions have a heavier mass than the atomic ions, and so move to the edge of the rotating crystal due to centrifugal forces. We compute the equilibrium positions and axial normal modes of the ion crystal in the presence of these impurities using the methods of Ref. [\cite=PhysRevA.88.043434]; results for a crystal of 37 Be+ ions and 44 BeH+ impurities are shown in Fig. [\ref=fig:DC]. Panel (a) shows the equilibrium crystal structure for trapping parameters similar to current experiments [\cite=bohnet2015quantum], with filled (empty) circles denoting molecular impurities (atomic ions). The highest frequency axial mode, analogous to the center of mass mode in a crystal with no impurities, is shown in in panel (b). The impurity ions have a greatly reduced amplitude of oscillation due to their heavier mass, and, more importantly for our purposes, the amplitudes of the center of mass mode on the atomic ions are non-uniform. The spread in amplitudes is roughly 10% of the mean for the particular parameters we consider. Only the atomic ions respond to the light-induced spin-dependent force that generate effective Ising spin-spin interactions, and so the effective number of spins in the quantum spin simulator is the number of atomic ions: 37 in our example case. Still, the molecular ions influence the spin-phonon and spin-spin dynamics through their modification of the center of mass mode amplitudes on the atomic ions.

Our calculations of the spin dynamics for a spatially non-uniform center of mass mode with decoherence are shown in Fig. [\ref=fig:DCDyn]. We take decoherence rates of [formula]s- 1, [formula]s- 1, and [formula]s- 1, comparable to current experiments, and average over [formula] trajectories. Panel (a) shows collective spin correlations such as the normalized total magnetization 〈σx〉 and its square 〈(σx)2〉. The black dashed line is the mean-field prediction of the decay of magnetization, which occurs solely due to decoherence at a rate [formula]. Strong deviations from this curve indicate the decay of magnetization due to the build-up of higher-order spin correlations. The blue dashed lines for the spin correlations use the actual inhomogeneous analog of the center of mass mode shown in Fig. [\ref=fig:DC](b). In contrast, the solid red lines use its nearest uniform approximation, in which the amplitude of the mode at each position is replaced by the average of the amplitude vector. Almost no difference between the exact and approximate predictions can be seen in the decay of the magnetization, whereas a slight difference can be seen in the squared collective magnetization at late times. In contrast, the effect of the mode inhomogeneity is clearly seen in the spatially resolved magnetization shown in Fig. [\ref=fig:DCDyn](b). Here, the size of the circles are proportional to 〈σx(x,y)〉 and the red solid (blue dashed) circles are for the uniform approximation and the true inhomogeneous mode, respectively. Our results demonstrate that, even in the presence of a relatively large number of impurity ions, the inhomogeneities in the analog of the center of mass mode have only a slight impact on low-order collective spin correlations over experimentally relevant timescales, whereas inhomogeneities in the spatial distribution of the magnetization can be quite sizable.

Conclusions and outlook

We have developed a generic approach to the out-of equilibrium dynamics of spins globally coupled to bosonic modes, which encompasses many paradigmatic models from all areas of quantum science, based on matrix product states (MPSs). In contrast to existing methods, our framework applies for any spatial and operator dependence of the spin-boson coupling, and places no restrictions on relative energy scales. In the regime of many fewer bosons than spins, Ns  ≫  Nb, an efficient approach is to use a Trotter-Suzuki decomposition of the spin-boson coupling propagator and dynamically deform the MPS topology using swap gates, resulting in a method with rigorously controlled error. Alternatively, for equal numbers of spins and bosons, Ns  =  Nb, we propose to perform direct time evolution using an exact matrix product operator (MPO) representation of the spin-boson Hamiltonian with long-ranged couplings, and provide techniques to safeguard against variational metastability. This exact MPO representation of the Hamiltonian can also be employed to find eigenstates and static properties of spin-boson systems.

Using our newly developed approach, we calculated the dynamics of 1D and 2D trapped ion quantum simulators in experimentally relevant parameter regimes, fully accounting for the dynamics of the phonons that mediate effective spin dynamics between ions. We first benchmarked our numerical results against a recent exact analytical solution for a particular spin-phonon coupling, finding excellent agreement. Beyond comparing low-order correlation functions which are straightforward and efficient to compute with the exact solution, we also demonstrated the power of our approach for computing detailed properties of the quantum state which are difficult to obtain through other means, such as the full counting statistics of collective spin observables and the fidelity of the spin-phonon system as a pure spin quantum simulator.

We showed that Markovian decoherence, which is an important component of trapped ions and many other AMO platforms, can be incorporated within our approach by solving the associated master equation using the method of quantum trajectories. Within this framework, we simulated the dynamics of a 2D ion crystal in the presence of realistic decoherence. In order to evince the power of our approach beyond those that require spatial uniformity of the spin-boson coupling, we treated the case of a non-uniform spin-boson coupling, physically motivated by the presence of impurity molecular ions in an atomic ion quantum spin simulator.

While our results show that MPSs are a powerful framework for studying spin-boson models, there are certain regimes which remain difficult or impossible to simulate efficiently with MPSs. In particular, 2D systems with many boson modes and finite-range interactions are challenging, and it is known that the scaling of MPSs for finding equilibrium states in 2D is exponential in the system size. Even in one dimension, simulations in which spins are strongly entangled with many bosons in a spatially inhomogeneous fashion are difficult, and particularly subject to variational metastability. An additional source of difficulty from a numerical point of view is that there is often a large separation of timescales between the dynamics of direct spin-boson coupling and boson-mediated spin-spin interactions, with the former limiting the size of the time step. Here, applying multiscale methods [\cite=KevorkianJK1996] is a promising avenue for improving numerical performance.

Myriad future research directions are available based on the framework developed in this paper. For one, our approach is able to treat several competing interaction scales, as well as decoherence, on the same footing, and so provide a rigorous means for justifying effective models of driven spin-boson systems in various parameter regimes. This is especially important for trapped ion quantum spin simulators in effective transverse fields, where the presence of non-commuting interactions with comparable energy scales can fundamentally change the effective spin physics in ways not captured by a perturbative approach [\cite=Wallinprep2]. Additionally, while we focused on applications to trapped ion systems, our techniques can be applied to many other platforms, including quantum optics and optomechanics, and provide a scalable means for studying strongly correlated physics in these diverse systems. Our framework also applies to higher-dimensional spin representations, such as spin-1, which can also be realized with trapped ion systems [\cite=PhysRevLett.112.040503] [\cite=PhysRevX.5.021026] and can shed light on fundamental questions such as the nature of topological phases with long-range interactions [\cite=PhysRevB.93.041102]. A generalization from discrete boson spectra to continuous boson spectra is possible, given a single global coupling operator between spins and bosons, using techniques based on orthogonal polynomials [\cite=PhysRevLett.105.050404] [\cite=Chin.Plenio_10] while keeping well-defined error [\cite=PhysRevLett.115.130401]. This can lead to new insights into quantum phases of correlated spins which are coupled to an external bath.

Acknowledgements

We would like to acknowledge useful discussions with Justin Bohnet, John Bollinger, Johannes Schachenmayer, Zhexuan Gong, and Phil Richerme, and support from NSF-PHY 1521080, JILA-NSF-PFC-1125844, ARO, MURI-AFOSR and AFOSR. MLW thanks the NRC postdoctoral program for support.

Improving the convergence of long-range time evolution

In this appendix, we discuss additional safeguards against variational metastability when using the long-range time evolution methods of Sec. [\ref=sec:MII]. Time evolution proceeds by optimization of the functional min |φ〉||φ〉  -  Û|ψ〉|2, with Û an MPO representation of the propagator over a small time step δt [\cite=Zaletel] and |ψ〉 an MPS representation of the state at time t, over all MPSs |φ〉 with fixed resources. The optimal MPS |φ〉 then becomes the new state at time (t + δt). The global optimization over the entire MPS cannot be performed efficiently, and so optimization is performed over the tensors of two neighboring sites in the MPS representation (see Eq. [\eqref=eq:MPSdef]) with all other tensors held fixed [\cite=Schollwoeck]. A complete optimization cycle over all neighboring pairs of sites is referred to as a sweep. In this local optimization scheme, the main cause of metastability is that entanglement is only built up between neighboring sites in a single step, and longer-ranged entanglement must be built up by repeated sweeping.

In some cases, the algorithm is not able to properly build up the appropriate entanglement structure for a long-ranged Hamiltonian, especially when starting from an unentangled state of spins and bosons. Our idea to improve the convergence is to also endow our initial variational guess |φ〉 with long-range coherence between spins and bosons which are far-separated in the MPS representation. We do so by generating a state |φ'〉 which contains long-range coherence between all spins and all bosons and mixing in a small amount α of this state to the optimal state obtained from local variational minimization, with the mixing parameter α taken to zero towards the end of the sweeping optimization. More precisely, the mixing is done by projecting the state |φ'〉 onto the orthonormal basis formed by holding all tensors except two in the MPS representation fixed, and then adding this projected two-site wavefunction directly to the wavefunction obtained from the optimization procedure.

This approach is similar in spirit to the modified single-site DMRG algorithm by White [\cite=PhysRevB.72.180403], which also builds fluctuations on top of the local variational optimum to accelerate convergence. While a detailed study of the optimal states |φ'〉 and mixing parameters α is outside of the scope of this work, we find that choosing |φ'〉 to be the ground state of Ĥ and [formula] to perform well. Note that the ground state can be efficiently found using ordinary two-site DMRG with the MPO representation of Fig. [\ref=fig:IIdia], as entanglement which is directly built up between neighboring spins and bosons propagates to farther separated spins and bosons by repeated sweeping. We also note that an accurate representation of the ground state is not essential-only non-vanishing long-range coherence is required-and so relatively coarse tolerances can be used in obtaining the ground state.