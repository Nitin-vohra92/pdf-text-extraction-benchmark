Evidential Label Propagation Algorithm for Graphs

Introduction

With the development of computer and Internet technologies, networks are everywhere in our common life. Graph models are useful in describing and analyzing many different kinds of relationships and interdependencies. In order to have a better understanding of organizations and functions in real-world networked systems, community structure of graphs is a primary feature that should be taken into consideration. Communities, also called clusters or modules, are groups of nodes (vertices) which probably share common properties and/or play similar roles within the graph. They can extract specific structures from complex networks, and consequently community detection has attracted considerable attention crossing many areas from physics, biology, and economics to sociology, where systems are often represented as graphs.

Recently, significant progress has been achieved in this research field and several popular algorithms for community detection have been devised. One of the most popular type of classical methods partitions networks by optimizing some criteria such as the modularity measure (usually denoted by Q) [\cite=newman2004finding]. But recent researches have found that the modularity based algorithms could not detect communities smaller than a certain size. This problem is famously known as the resolution limit [\cite=fortunato2007resolution]. Another family of approaches considers hierarchical clustering techniques. It merges or splits clusters according to a topological measure of similarity between the nodes and tries to build a hierarchical tree of partitions [\cite=kim2015detecting]. Some other popular community detection approaches using spectral clustering [\cite=newman2013spectral] or partitional clustering methods [\cite=zhou2015similarity] can be found.

As the size of analyzed networks grows rapidly, the complexity of community detection algorithms needs to be kept close to linear. The Label Propagation Algorithm (LPA), which was first investigated in [\cite=raghavan2007near], has the benefits of nearly-linear running time and easy implementation, thus it forms a good basis for efficient community detection methods. It only uses the network structure and requires neither optimization of a predefined objective function nor prior information about the communities. In this model every node is initialized with a unique label. Afterwards each node adopts the label that most of its neighbors currently have at every step. In this iterative process densely connected groups of nodes form a consensus on a unique label to form communities.

The behavior of LPA is not stable because of the randomness. Different communities may be detected in different runs over the same network. Moreover, by assuming that a node always adopts the label of the majority of its neighbors, LPA ignores any other structural information existing in the neighborhood of this node. Another drawback for LPA is that it can only handle disjoint and non-overlapping communities. However, in real cases, one member in a network might span multiple communities. For instance, one may naturally belong to several social groups like friends, families, and schoolmates.

Although most of the nodes in a graph follow a common community distribution pattern, some certain objects may deviate significantly from the pattern. It is of great value to detect such outliers in networks for de-noising data thereby improving the quality of the detected community structure and also for further analysis. Finding community outliers is an important problem but has not received enough attention in the field of social network analysis.

The theory of belief functions, also called Dempster-Shafer Theory (DST), offers a mathematical framework for modeling uncertainty and imprecise information [\cite=ds2]. It has been widely employed in various fields, such as data classification [\cite=denoeux1995k] [\cite=liu2015new], data clustering [\cite=masson2008ecm] [\cite=zhou2015evidential] [\cite=zhou2016ecmdd], social network analysis [\cite=wei2013identifying] [\cite=zhou2014evidential] [\cite=zhou2015median] and statistical estimation [\cite=denoeux2013maximum] [\cite=zhou2014evidentialem]. Belief functions are defined on the power set of the frame which greatly enriches the expression power. The compound sets of the frame can be used to describe the uncertain information and our ignorance.

In this paper, we enhance the original LPA by introducing new update and propagation strategies. A novel Evidential Label Propagation (ELP) algorithm is presented to detect communities. The main contribution of this work can be summarized as:

The influence of each node to a target is defined considering both the similarities and local densities. The larger the influence of one node to the target node is, the easier its label can be propagated to the target.

Based on the node influence, a new label propagation algorithm, named ELP, is proposed for graphs. The method for determining the update order of nodes is devised to improve the robustness of ELP.

The Basic Belief Assignments (bbas) of nodes are defined for each detected communities in the framework of belief functions. The overlapping nodes and outliers can be detected simultaneously through the obtained bbas.

The remainder of this paper is organized as follows. In Section [\ref=background], some basic knowledge is briefly introduced. The ELP algorithm is presented in detail in Section [\ref=ELPpresent]. In order to show the effectiveness of the proposed community detection approach, in Section [\ref=secexp] we test the ELP algorithm on different graph data sets and make comparisons with related methods. Conclusions are drawn in the final section.

Background

In this section some related preliminary knowledge will be presented. Some basis of belief function theory will be recalled first, then two existing algorithms related to the proposed method will be briefly described.

Theory of belief functions

Let [formula] be the finite domain of X, called the discernment frame. The belief functions are defined on the power set 2Ω  =  {A:A  ⊆  Ω}.

The function m:2Ω  →  [0,1] is said to be the Basic Belief Assignment (bba) on 2Ω, if it satisfies:

[formula]

Every [formula] such that m(A) > 0 is called a focal element. The credibility and plausibility functions are defined in Eqs.[formula] and [formula] respectively:

[formula]

[formula]

Each quantity Bel(A) measures the total support given to A, while Pl(A) represents potential amount of support to A. The two functions are linked by the following relation:

[formula]

where [formula] denotes the complementary set of A in Ω. The function pl:Ω  →  [0,1] that maps each element ωi in Ω to its plausibility pl(ωi) = Pl({ωi}) is called the contour function associated to m.

A belief function on the credal level can be transformed into a probability function by Smets method [\cite=smets2005decision], where the mass m(A) is equally distributed among the elements of A. This leads to the concept of pignistic probability, BetP, defined by

[formula]

where |A| is the number of elements of Ω in A.

How to combine efficiently several bbas coming from distinct sources is a major information fusion problem in the belief function framework. Many rules have been proposed for such a task. When the information sources are reliable, several distinct bodies of evidence characterized by different bbas can be combined using Dempster-Shafer (DS) rule [\cite=ds2]. If bbas [formula] describing S distinct items of evidence on Ω, the DS rule of combination of S bbas can be mathematically defined as

[formula]

EK-NNclus clustering

Recently, a new decision-directed clustering algorithm for relational data sets is put forward based on the evidential K nearest-neighbor (EK-NN) rule [\cite=denoeux2015ek]. Starting from an initial partition, the algorithm, called EK-NNclus, iteratively reassigns objects to clusters using the EK-NN rule [\cite=denoeux1995k], until a stable partition is obtained. After convergence, the cluster membership of each object is described by a Dempster–-Shafer mass function assigning a mass to each specific cluster and to the whole set of clusters.

Label propagation

Let G(V,E) be an undirected network, V is the set of N nodes, E is the set of edges. Each node v(v∈V) has a label cv. Denote by Nv the set of neighbors of node v. The Label Propagation Algorithm (LPA) uses the network structure alone to guide its process. It starts from an initial configuration where every node has a unique label. Then at every step one node (in asynchronous version) or each node (in a synchronous version) updates its current label to the label shared by the maximum number of its neighbors. For node v, its new label can be updated to ωj with

[formula]

where |X| is the cardinality of set X, and Nv is the set of node v's neighbors. When there are multiple maximal labels among the neighbors’ labels, the new label is picked randomly from them. By this iterative process densely connected groups of nodes form consensus on one label to form communities, and each node has more neighbors in its own community than in any of other community. Communities are identified as a group of nodes sharing the same label.

Approach

Inspired from LPA and EK-NNclus, we propose here the ELP algorithm for community detection. After an introduction of the concept of node influence, the whole ELP algorithm will be presented in detail. Consider the network G(V,E). Let the degree of node i be di, and [formula] denote the adjacency matrix, where aij = 1 indicates that there is a direct edge between nodes i and j.

The influence of nodes

Definition .  The local density of node i in graph G can be defined as

[formula]

where N  =  |V| is the number of nodes in the graph.

The value of ρi describes the importance of node i to some extent. The nodes that are playing central roles in the network have relatively large local densities.

Definition .  Denote the influence of the node v to its neighbor node u by δuv.

[formula]

where sim(u,v) denotes the similarity between nodes u and v. Parameter η is adjustable and it can be set to 1 by default. Many similarity measures can be adopted here. In this paper, the simple Jaccard Index is adopted:

[formula]

where [formula] denotes the set of vertices that are adjacent to node x.

It should be noticed that the value of δuv is not equal to δvu. In fact, we want to model the label propagation process according to δuv. The larger the influence of node v to node u is, the larger possibility that node u will adopt the label of node v. It is similar to the information propagation on social networks, where we are more likely to believe an authority who is usually a center or an important member in the community.

Evidential label propagation

In the original LPA, when updating the label of node i, the number of neighbors belonging to each class is counted, and the label with maximal frequency is adopted. In this case, the importance of each node in the neighborhood is considered equal in the updating process. In our view, the propagation of labels is similar to information spreading. The more similar the two nodes are, the larger possibility that they share the same opinion (label). In addition, the information is much easier to be propagated from experts to common people, and not vice versa. That is to say, the label of an important node which may play a central role in the network should be more likely to be retained in the updating process. Here we assume that community centers are surrounded by neighbors with lower local densities and they have a relatively low similarity with centers of other communities. Then the node influence can be used to guide the propagation.

If the influence of node j to i, δij, is large, the mass given to the position that "node i adopts the labels of node j" should be large. Suppose the set of neighbors of node i is Ni, we then compute

[formula]

where φ is a non-decreasing mapping from

[formula]

. We suggest to choose φ as

[formula]

where α0 and γ are constants. Parameter α0 is a weight factor, and it can be set 1 by default. Coefficient γ can be fixed as follows [\cite=denoeux2015ek]:

[formula]

If node j is a member of community ωj, then node j's influence to node i is a piece of evidence that can be represented by the following mass function on Ω:

[formula]

Let the number of elements in Ni be qi, and assume the influence from the qi nodes in the graph as independent pieces of evidence, the qi mass function mj can be then combined using the DS rule:

[formula]

The fused mass m is a credal membership of node i. The difference between this kind of membership and fuzzy membership is that there is a mass assigned to the ignorant set Ω in bba m. It is used to describe the probability that the node is an outlier of the graph. The domain label of node i can be defined as

[formula]

Since the focal elements of the bbas here are the singletons and set Ω, Eq. [\eqref=domain1] is equal to

[formula]

where pl is the contour function associative with m.

As explained in [\cite=denoeux2015ek], to obtain the domain label of each node, it is not necessary to compute the combined mass function m explicitly. For each node i, we first compute the logarithms of the plausibilities that node i belongs to cluster ωk∈Ω (up to an additive constant) as

[formula]

where

[formula]

and sik is a logical variable indicating whether the domain label of node i is ωk. Especially, if a node has more than one dominant label, we randomly choose a label from them as its dominant label. The domain label of node i can be set to ωk* with

[formula]

Then the variables sik can be updated as

[formula]

The labels of each node are updated iteratively in ELP until the maximum iteration number is reached or all labels are stable. Finally, the overlapping and non-overlapping communities are returned. The ELP algorithm can be summarized in Algorithm [\ref=alg:method].

Update order

In ELP, the labels of nodes are updated in a random order σ. Therefore, we may detect different communities with different arrangements of nodes ( i.e., different σs), which leads to a stability concern. Like LPA, ELP updates nodes' labels asynchronously. Benefiting from the asynchronous strategy, nodes which update labels earlier with stable labels will have a positive impact on the ones updated later [\cite=liu2015label].

In order to find a good update order, we first introduce the concept of influence variance as

[formula]

where abs(x) is the absolute value of x, |Ni| is the number of elements in set Ni, and

[formula]

We call δ*ij the normalized influence.

From the definition of influence variance, it can be seen that Vi is small if the influence values of node i's neighbors do not spread out very much from the average. Hence, we can conclude that if node i's influence variance Vi is large, there must be some neighbors with very large values of normalized influence. According to the label propagation strategy, the label of node i is more likely to updated to the same one as the most influential neighbor. Therefore, the larger the influence variance of a node is, the easier the node updates its label.

In the label propagation strategy of ELP, the labels of central nodes will be easily adopted by border nodes. Thus if we set the labels of the border nodes as the same one with the nearest centers first and the central nodes are updated later, the result of label propagation will be the same as the natural community of the network. The central nodes generally have large local densities. That is to day, the nodes with small local density should be updated first.

Based on the above analysis, in order to identify the correct community structure, the nodes can be ordered based on β index which can be defined as

[formula]

We arrange nodes in a descending order of value β, and denote this order by σ*.

Experiments

In this section, several experiments will be conducted on graphs. The results will be compared with LPA and EK-NNclus. It should be noted that EK-NNclus is for relational data sets with given dissimilarities. To apply EK-NNclus on graph data sets, the following distance measure associative with the similarity in Eq. [\eqref=siminf] is considered:

[formula]

We adopt the Normalized Mutual Information (NMI) [\cite=danon2005comparing] to evaluate the quality of detected communities. The NMI of two partitions A and B of the graph, [formula], can be calculated by

[formula]

where CA and CB denote the numbers of communities in partitions A and B respectively. The notation Nij denotes the element of matrix [formula], representing the number of nodes in the ith community of A that appear in the jth community of B. The sum over row i of matrix [formula] is denoted by Ni  · and that over column j by N·  j. If A and B are the same partitions, the NMI value is equal to one, i.e.,

[formula]

Example .  The network displayed in Fig. [\ref=example1]-a contains ten nodes belonging to two communities. Node 1 serves as a bridge between the nodes of two groups.

Let η  =  1. We run ELP 50 times with different update order σs. By partitioning each node to the community with maximal plausibility value, the hard partition of all the nodes in the network can be got. Nodes 2, 3, 4, 5 and nodes 6, 7, 8, 9 are correctly divided into two groups all the time. But the community labels for nodes 1 and 10 are different using different update order. It indicates that it is difficult to determine the specific labels of nodes 1 and 10 based on the simple topological graph structure.

The optimal update order of nodes by Eq. [\eqref=updateorder] is

[formula]

The iterative update process of ELP with σ* is illustrated in Table [\ref=elpupdate]. Initially, each node is assigned with a unique label which is the same as its ID. And then the nodes update their own labels orderly. The [formula] column of the table shows the label of each node after the [formula] update step. The bold element of each column in the table indicates the node whose label is updated in this step. As can be seen, the nodes located in the border are updated first. Based on the definition of node influence and the label propagation strategy, the labels of central nodes are more easily adopted by the border nodes. If the update order is set to be σ*, the obtained hard partition is as that shown in Fig. [\ref=example1]-b. The corresponding basic belief assignments for each node are shown in Fig. [\ref=example1_bba]-a. As can be seen from the figure, the masses of node 1 assigned to the two communities are equal, indicating that node 1 serves as a bridge in the network. For node 10, the maximum mass is given to the ignorant set Ω. Here Ω is the set for outliers which are very different from their neighbors. From the original graph, we can see that node 10 has two neighbors, nodes 4 and 8. But neither of them shares a common neighbor with node 10. Therefore, node 10 can be regarded as an outlier of the graph. From the mass assignments, it is easy to see that the plausibilities of nodes 1 and 10 for two communities are equal. Consequently it is difficult to determine their specific domain labels.

In ELP, pignistic probabilities can also be obtained as a by-product, which can be regarded as fuzzy memberships of nodes. From Fig. [\ref=example1_bba]-b we can see that both node 1 and node 10 have similar memberships for the two communities. But the positions of the two nodes in the graph are different. Node 1 is in the central part while node 10 is in the border. This is the deficiency brought by the restriction that the probabilities over the frame should be sum to 1. Consequently, it could not distinguish outliers from overlapping nodes. Although the mass values assigned to the two communities are also equal, but those to set Ω are different. The mass given to Ω for node 1 is almost 0 while for node 10 it is approaching to 1. It illustrates one of the advantages of ELP that the overlapping nodes and outliers can be detected simultaneously with the help of bbas. For one node, if the maximal mass is given to the ignorant set Ω, it is likely to be an outlier. On the contrary, when a node has large equal mass assignments for more than one community, it probably locates in the overlap.

We evoke LPA many times on this simple graph. Nodes 1 and 10 are divided into different communities in different runs. LPA could detect neither the overlapping nodes nor the outliers. Before applying EK-NNclus algorithm, the number of nearest neighbors, K, should be fixed. The results by EK-NNclus with K  =  3 and K = 4 are shown in Tables [\ref=eknnclusk3] and [\ref=eknnclusk4] respectively. It can be seen that five communities are detected by EK-NNclus. Nodes 10 and 6 are specially partitioned into two special small groups respectively. Node 1 is regarded as an outlier when K = 3, while no outlier is detected when K = 4. In graphs, different nodes have different number of neighbors, thus it is not reasonable to use the same K for all the nodes. This may be the reason that the performance of EK-NNclus is not as good as that of ELP. The NMI values are not listed in this experiment as there is no ground-truth for this illustrative graph.

Example .  Here we test on a widely used benchmark in detecting community structures, "Karate Club", studied by Wayne Zachary [\cite=ucidatasets]. The network consists of 34 nodes and 78 edges representing the friendship among the members of the club (see Fig. [\ref=karate]). During the development, a dispute arose between the club's administrator and instructor, which eventually resulted in the club split into two smaller clubs (one marked with pink squares, and the other marked with yellow circles), centered around the administrator and the instructor respectively.

Let η  =  1, and evoke ELP many times with different update order σs. We find that we can get two different results. Most of the time, ELP could detect two communities and find two outliers. The bbas of nodes in the two groups are illustrated in Figs. [\ref=karate_bba]-a and [\ref=karate_bba]-b respectively. It is showed in the figures that this network has strong class structures, since for each node the mass values assigned to different classes are significantly different. Nodes 10 and 12 are two outliers in their own communities. From the original graph, node 12 only connects with node 1. For node 10, it has two neighbors, nodes 3 and 34, but it has no connection with the neighbors of the two nodes. Neither node 10 nor node 12 has close relationship with other nodes in the network. Therefore, it is very intuitive that they are detected as outliers. It is noted here that with update order σ*, we can get the above clustering result with two communities and two outliers.

With some σs, a special small community can been found by ELP. As shown in Fig. [\ref=karateELP]-b, a group containing nodes 5, 6, 7, 11, 17 has been separated from community ω1. This seems reasonable as these nodes have no connections with other nodes in class ω1 except the central node (node 1). The bbas of these five nodes are illustrated in Fig. [\ref=karate_cluster3_bba]. It can be seen that nodes 5 and 11 have large mass values for community ω1 and ω3, which can be regarded as bridges of the two communities. Nodes 10 and 12 are still regarded as outliers in this case.

To compare the accuracy and robustness of different methods, each algorithm (ELP, LPA and EK-NNclus with K = 3, 4, 5, 6) is repeated 50 times with a random update order each time. The minimum, maximum, average and the standard deviation of NMI values are listed in Table [\ref=karate_nmi]. To get NMI values of the detected results of ELP, we should get the domain label of each node by assigning each node to the community with maximum plausibility. It should be noted that node 10 has a equal plausibility for community ω1 and ω2, that is,

[formula]

We randomly set a label as its dominant label. From the table we can find that ELP has good robustness as well as accuracy. EK-NNclus is stable when K is relatively large, but the accuracy is not as good as that in ELP. The performance of LPA is worst in terms of stability and average accuracy.

Example .  The network we investigate in this experiment is the world of American college football games between Division IA colleges during regular season Fall 2000. The vertices in the network represent 115 teams, while the links denote 613 regular-season games between the two teams they connect. The teams are divided into 12 conferences containing around 8-12 teams each and generally games are more frequent between members from the same conference than between those from different conferences. The original network is displayed in Fig. [\ref=footballELP]-a.

Each of the algorithms ELP, LPA, and EK-NNclus is repeated 50 times with different update order σs, the statistical properties of the corresponding NMI values are listed in Table [\ref=football_nmi]. As can be seen, the maximal value of NMI is almost the same by LPA and ELP. However, the minimum and average by ELP are significantly larger than those by LPA. These results further demonstrate the robustness of ELP.

Now we fix the update order and let σ  =  σ*. The NMI value of the detected communities is 0.9102. It is very close to the maximum 0.9269. The clustering result of ELP with σ* is presented in Fig. [\ref=footballELP]-b. As shown in the figure, six conferences are exactly identified.

Example .  In this experiment, we will test on three other real-world graphs: Dolphins network, Lesmis network and Political books network [\cite=ucidatasets]. For one data set, each algorithm is evoked 50 times with a random σ each time. The statistical characteristics of the evaluation results in terms of NMI on the three data sets are illustrated in Tables [\ref=dolphin_nmi] - [\ref=books_nmi] respectively. As shown in the tables, ELP is much more stable than other approaches as the standard deviation is quite small. The average performance of ELP is best among all the methods.

Conclusion

In this paper, a new community detection approach, named ELP, is presented. The proposed approach is inspired from the conventional LPA and EK-NNclus clustering algorithm. By the introduction of node influence, a new evidential label propagation strategy is devised. After the propagation process, the domain label of each node is determined according to its plausibilities. The experimental results illustrate the advantages of ELP. It can be used to detect the overlapping nodes and outliers at the same time. To define the influence of each node, different similarity measures can be adopted. Specially, if there are some attributes describing the features of nodes, a similarity index considering both the topological graph structure and the attribute information is a better choice. Therefore, we intend to discuss the effects of different similarity measures on ELP and the application of ELP on graphs with attribute information in our future research work.

Acknowledgements

This work was supported by the National Natural Science Foundation of China (Nos.61135001, 61403310).