Coupled-Beam and Coupled-Bunch Instabilities

Introduction

Slip-stacking is a method to increase beam intensity in a synchrotron by merging of two beams. When the first beam is moving along its orbit, the second one is injected at slightly different energy, so that it slips along the first beam while its RF buckets are gradually filled. As soon as that injection is over, when bunches of the first and second beams line up with each other, a sufficiently high RF captures these bunch pairs in the same buckets. Schematically, such slipping motion is shown in Fig.[\ref=fig:SlippingBeams]. This method is successfully used at the RR [\cite=Kourbanis:2014iza] [\cite=prebys2016long], with a plan to have about 500 bunches in each beam. Such a high number of bunches makes coupled-bunch interaction a powerful source of collective instabilities. However, the relative motion of the two beams prevents a straightforward application of the existing theory, requiring a certain modification. The content of this paper is constituted by a general solution of this coupled-beam problem as well as by some details of distribution of the inter-bunch tune shifts between the intra-bunch modes, with an application of all that to the Recycler Ring.

Main Equations

To begin, let us consider every bunch as a macroparticle. Then, the equations of motion for the bunch offsets x+k,x-k of the +   and -   beams can be presented as follows:

[formula]

Here t is time, ωb is the betatron frequency, and meanings of time values τ and τ0 should be clear from Fig.[\ref=fig:SlippingBeams]; W(s) is a conveniently normalized wake function, T is time required for the slippage per bucket (i.e. per τ0), and M is the number of bunches per beam, so the total number of bunches in the machine is 2M. Thanks to spacial periodicity, the offsets can be expanded over Fourier components, so that for each spacial coupled-bunch harmonic x±k(t) = x±0(t) exp (iφk), with φ = 2πμ / M, μ = 0,  ±  1,...,  ±  M / 2. The next convenient step is a transfer to slow amplitudes, which is conventionally represented as x±0(t) = a±(t) exp ( - iωbt). However, such representation of the coupled-beam oscillations is yet not quite satisfactory for slipping beams, since it associates mode amplitudes with specific (zero) bunches. It is important that these bunches do not remain at the same distance from each other. If at t = 0 the bunches (+,0) and (-,0) exactly align, after time T the bunch (+,0) aligns with the bunch (-,1), while the bunch (-,0) aligns with (+,-1). Thus, the association of the mode amplitudes with specific reference bunches is not adequate to the problem of coupled oscillations of slipping beams. Two-beam collective motion requires such amplitudes that a time shift by t = T, when τ  →  τ  +  τ0, would not change relative phases of the neighbor +   and -   bunches. This goal is achieved with the following modified amplitudes:

[formula]

For the amplitudes b±, the relative phases of the aligned bunches are fully determined by the relative phases of the amplitudes, without any time-dependent explicit factors. For instance, at t = T, when τ  =  τ0, the offset of the bunch (-,0) is x-0(T) = b-e- iφ / 2 (the common factor e- iωbT is omitted). At this moment, this bunch is aligned with the one numbered (+,-1), which offset is x+- 1(T) = b+eiφ / 2e- iφ = b+e- iφ / 2, so their relative phases are equal to those of b- and b+, as it is the case for any aligned pair of bunches any time the beams are aligned.

In terms of the slipping-beam amplitudes b±, the equations of motion can be written,

[formula]

Here wake Fourier series [formula] and [formula] describe actions of the same ([formula]) and other ([formula]) beams. For a given wake function, they can be computed and tabulated as certain functions of the coupled-bunch mode, represented by the mode parameter ψ, and the slippage phase   =  τ  /  τ0, 0 <   ≤  1. This pair of linear ordinary differential equations can be additionally simplified with a substitution [formula], which eliminates the time-independent same-beam factor [formula]. With time measured in the units of the slipping period T, these equations are written,

[formula]

Thereby, the problem is reduced to the pair of ordinary linear homogeneous differential equations with time-dependent coefficients. Its periodical map P can be obtained by numerical integration:

[formula]

Slipping-beam collective modes are described by the eigensystem of the matrix P. Its eigenvalues λ1,2 give the growth rates r1,2 and phase shifts ΔΦ1,2,

[formula]

Equations ([\ref=MainEqFourierc]) have a symmetry with respect to reflection of time: this pair of equations does not change after the following transformation:

[formula]

This symmetry entails that the eigenvalues λ1,2 are mutually inverse and that the eigenvectors [formula] are orthogonal:

[formula]

Strictly speaking, this circumstance does not necessarily mean that only one of the two slipping-beam modes is unstable, since on top of these eigenvalues the same-beam factor [formula] contributes to the growth rate as well. However, the mode with |λ| > 1 is more unstable, so it is reasonable to limit our attention by this mode only.

Resistive Wall

In this section the described method is applied to the case of a thick resistive wall, [formula]. Real and imaginary parts of the function

[formula]

are presented in Figs. [\ref=fig:ReO] and [\ref=fig:ImO]; the same-beam growth factor [formula] is shown in Fig.[\ref=fig:Spsi]. At |ψ|  ≪  1 the following approximations can be useful:

[formula]

This approximation for the function [formula] is especially remarkable: for all |ψ|  ≤  π / 2 it is valid within the accuracy of 1% or better. For the function [formula], the same accuracy is reached only at |ψ|  ≤  0.1.

For a round vacuum chamber with the circumference C, aperture radius d, conductivity σ, the transverse wake function is [\cite=chao1993physics]:

[formula]

For a flat chamber, the thick-wall wake is reduced by the Yokoya factors π2 / 12 vertically and π2 / 24 horizontally. The dimensionless slipping-beam intensity parameter w0 can be written,

[formula]

Here Nb is the bunch population, M is the number of bunches, η is the slippage factor, δp / p is the relative momentum separation of the two beams (center-to-center), r0 is the classical radius, β is the average beta-function, and γ is the relativistic factor.

In general, the spectrum of slipping-beam modes is determined by two dimensionless values: the intensity parameter w0 and the bunch-to-bunch phase advance φbb  =  ωbτ0. If the latter is small enough, φbb  ≪  1, the results are almost the same as for its zero value, so only one parameter, w0, remains.

If during the growth time the beams slip by distances that are small compared with the wavelength 2πτ0 / |φ| slipping does not play a role. In this case, the growth rate caused by the other beam must be close to the same-beam one; in other words, the total growth rate approximately doubles; the same is true for the tune shift. To quantify the condition of this approximation for the resistive wall wake, the asymptotic Eq.([\ref=Oasympt]) for the same-beam rate can be used, which implies w0  ≪  1. We may expect that the other-beam growth rate is getting to be suppressed by its slippage when for the growth time the beam slips by the coupled-bunch phase ~  π. Equating for this critical phase ψc the same-beam growth time [formula] and the half-wavelength slipping time π / |ψc| yields

[formula]

For |ψ|  >  |ψc|, the growth rate driven by the other beam should be suppressed compared with the same-beam one, [formula].

Slipping-Beam Modes at the Recycler Ring

For the RR with C = 3.3km, γ = 9.5, β = 22m, η =  - 0.0087, δp / p = 0.0027, and with Proton Improvement Plan II values Nb = 7.6  ·  1010 and M = 504, the slipping-beam intensity parameter w0 comes out as w0 = 0.12. For that number of bunches and the betatron tune Qy = 24.4, the bunch-to-bunch phase advance φbb  =  0.30 and bunch-to-bunch slipping time T / T0 = (M|ηδp / p|)- 1 = 90 revolutions. The growth rate versus the negated coupled-bunch phase is shown in Fig.[\ref=fig:RateLog]. Equation ([\ref=psi_c]) gives the critical phase ψc≃0.2π, which is in a reasonable agreement with this plot. Generally, the conventional coupled-bunch growth rate is exactly zero for |ψ| = π and any sort of wake. As one can see in Fig.[\ref=fig:RateLog], this is not the case for the slipping beams: although at |ψ| = π the growth rate is low compared with its values at small coupled-bunch phases, it is still not zero. For w0  ≪  1, this rate is well approximated by r  ≈  0.5w20. Figure [\ref=fig:dPhaseAdvanceLog] demonstrates the phase advance shift of the unstable mode, which may play a role for Landau damping if the phase advance shift exceeds the growth rate, or is at least comparable to it. The parametric plot presented in Fig.[\ref=fig:RatePhaseParPlot3] can be used to determine whether or not that is the case. While for small phases |ψ|  ≤  1 the entire phase advance shift [formula] is comparable with the total growth rate [formula], closer to |ψ| = π the phase advance shift may dominate over the growth rate.

Two plots for the eigenvectors are given in Figs. [\ref=fig:VNPPlot] and [\ref=fig:APNPlot].

Distribution of Coupled-Bunch Rates over the Head-Tail Modes

All the computations above assumed zero chromaticity, so the question is how to modify the results for an arbitrary chromaticity. In those cases when the wakes of preceding bunches can be considered flat along the given bunch, the problem is reduced to a single-bunch dynamic equation where the coupled-bunch forces are taken into account as a constant wake, see e.g. [\cite=burov2009head] [\cite=PhysRevSTAB.15.054403] [\cite=Burov:2013nb] [\cite=burov2014nested]. In general, the coupled-bunch growth rates and tune shifts are distributed between the intra-bunch, or head-tail, modes according to a dipole moment of the latter. This problem can be considered in details for two limit cases: for zero space charge (ZSC) and for the strong space charge (SSC). In both cases, only coupled-bunch wake forces will be taken into account, and they will be assumed flat on the bunch length.

For the ZSC case, following Ref.[\cite=burov2014nested], the intra-bunch pattern of a mode can be expanded over the nested head-tail basis in the synchrotron phase space

[formula]

where l = 0,  ±  1,  ±  2,..., φ is the synchrotron phase, χα is the chromatic head-tail phase at the radial position α. Components of that expansion Xlα satisfy the following equation:

[formula]

where ωs is the synchrotron tune, Δω  =  ΔΦ  +  ir is the complex tune shift of the coupled-bunch wake and point-like bunches, nr is the number of the radial rings representing the bunch in the longitudinal phase space (ideally nr  →    ∞  ),

[formula]

is the Bessel function as the dipole moment of the basis function Ψlα and ν is the sought-for eigenvalue. Note that for a rigid-bunch motion, when the bunch moves as a whole with the amplitude X̄,

[formula]

From Eq.([\ref=NHTEq]), a dispersion equation on the eigenvalues ν follows:

[formula]

where f(r) is the normalized longitudinal phase space density, and the values Fl(ζ) will be called the head-tail or dipole formfactors. Note that

[formula]

for any chromatic factor ζ and any distribution function f(r). For the Gaussian distribution, f(r) = e- r2 / 2, the formfactor integrals can be analytically taken:

[formula]

where [formula] is the modified Bessel function and ζ  =  ξσp / Qs is the head-tail phase with ξ standing for the conventional unnormalized chromaticity, σp for the relative rms momentum spread and Qs for the synchrotron tune. Some of these formfactors are shown in Fig.[\ref=fig:NHTFormFactor]. Roughly speaking, if the chromaticity |ζ|  >  1, the ZZC formfactors up to |l|≃|ζ| are close to their common asymptotical value (2πζ2)- 1 / 2, while those of the higher modes could be neglected.

The eigenvalues ν are easily found in two opposite limit cases, for small and large values of the coupled-bunch tune shift Δω. If it is small compared with the synchrotron tune, |Δω|  ≪  ωs, all the unperturbed tunes lωs just slightly shift, sharing the total coherent shift according to their form-factors Fl:

[formula]

In the opposite limit, when |Δω|  ≫  ωs|k - m| for all k,m with non-negligible form-factors F, i.e. for |Δω|  ≫  ωs|ζ|, Eq.([\ref=DispEqGen]) shows that a single eigenvector essentially takes the entire tune shift Δω. This dominant mode is nothing but the rigid-bunch motion, while all other eigenvectors are of very small dipole moment. Thus, the high coupled-bunch tune shift gives rise to the rigid-bunch motion; note that notwithstanding the chromaticity, there is no chromatic traveling wave in that powerful mode. As to the other eigenvectors, for such a high coupled-bunch tune shift, each of them becomes of almost zero dipole moment. Thus, growth of |Δω| from very small to very high values first leads to the proportional growth of all the head-tail tune shifts, but as soon as the |Δω| becomes comparable with the band of the participating harmonics, the common rigid-bunch mode is formed, which takes all the tune shift.

Although that lies outside the scope of this paper, it is still worthy to note that in the limit of very high number of terms in Eq.([\ref=DispEqGen]), its sum can be substituted by an integral, and the equation transforms into conventional dispersion equation of a medium, consisting of many harmonic oscillators affected by a collective force proportional to their common dipole moment. In that case the transfer from the perturbed intrabunch modes to the powerful rigid-bunch mode, which happens at |Δω|≃|ζ|ωs, can be treated as the appearance of a discrete common mode under a continuous incoherent van Kampen spectrum and the loss of Landau damping [\cite=van1957dispersion] [\cite=Burov:2011zza]. The same equation may describe the beam shielding responsible for reduction of a cooling rate at the stochastic cooling.

Now let us see how the coupled-bunch modes are shared between the intra-bunch modes in the case of the strong space charge, SSC. For the RR, the space charge is strong: the maximal space charge tune shift [formula] exceeds both the synchrotron tune ωs and the coherent tune shifts Δω by about an order of magnitude. For the strong space charge, the head-tail degree of freedom becomes one-dimensional; its eigensystem can be found from the ordinary integro-differential equation of Ref.[\cite=burov2009head]. Being expanded over the orthonormal basis of the space charge harmonics y0k, k = 0,1,2..., this equation is reduced into the standard algebraical eigensystem problem. When the wake fields are dominated by flat coupled-bunch (and possibly feedback) terms, this set of linear homogeneous equations on the eigenfunction components Bk can be written,

[formula]

where ρ(s) is the bunch normalized line density, [formula], ν is the eigenvalue to be found and ν0k≃k2ω2s is its k-th no-wake value. The italicized symbol Ik for the dipole moments of the basis functions is not to be confused with the straight one used for the Bessel functions [formula].

Eq.([\ref=BurovSCE]) can be solved similarly to the zero space charge case; a dispersion equation for the sought-for eigenvalues ν follows:

[formula]

Formally, this equation is of the same type as its counter-part for the ZSC case, Eq.([\ref=DispEqGen]). The dipole formfactors now are Fl = |Il|2 since the dipole moments of the basis functions are Il(ζ) for SSC, instead of [formula] for ZSC. Thanks to orthonormalization of the basis,

[formula]

it is true that

[formula]

For a Gaussian bunch, these functions are presented in Fig.[\ref=fig:Ik2_vs_zeta]. Similarly to the ZSC case, SSC formfactor of k-th mode reaches its maximum at the head-tail phase |ζ|≃k, being insignificant even a few units below that value. However, the SSC formfactor behaves differently above its maximum. While for ZCS all the non-negligible formfactors are following the same asymptotic [formula], the SSC ones exponentially decay soon after reaching their maxima, so for any chromaticity there are not more than 2-4 SSC harmonics, which are sufficient to be taken into account. One more important difference is that for SSC the distance between the neighbor unperturbed lines, ν0k and ν0k + 1, grows [formula], while for ZSC this distance is constant. As a result, the threshold of the rigid-bunch mode in both cases is proportional to the chromaticity. While for the ZSC case this threshold is |Δω|≃|ζ|ωs, for the SSC one it is [formula].

Another stabilizing effect of the chromaticity relates to Landau damping. The higher the chromaticity, the larger are the numbers of the head-tail harmonics constituting the rigid-bunch motion, k≃|ζ|. A consequence of that is a fast growth of the intrinsic Landau damping for the SSC case: according to [\cite=burov2009head] [\cite=PhysRevSTAB.18.074401] the damping is as fast as [formula], so a sufficiently high chromaticity should suppress the instability. For ZSC, the higher harmonics are prone to a larger contribution to Landau damping from the longitudinal degree of freedom.

Both for the ZSC and SSC cases, i.e both for Eq.([\ref=NHTEq]) and Eq.([\ref=BurovSCE]), the following general theorems can be proven (see the Appendix):

The sum of the head-tail tune shifts driven by the coupled-bunch interaction is equal to the total coupled-bunch tune shift, [formula] For the ZSC case, ν0k  =  kωs, and [formula], while for SSC [formula], and k = 0,1,2,....

The sign of each head-tail growth rate caused by the coupled-bunch interaction is the same as the sign of the total coupled-bunch growth rate, [formula] This theorem limits maximal growth rate of each head-tail mode and denies a possibility for a resistive damper to cause an instability of any of them; as soon as [formula], for all partial growth rates [formula] as well. In particular, it shows that no TMCI can be driven by the coupled-bunch interaction only.

For a purely reactive damper, when [formula], the head-tail eigenvectors are real and orthogonal, [formula], and similar for [formula]; otherwise they are generally neither real nor orthogonal. This theorem may be useful for analysis of perturbations of the head-tail modes formed by a strong reactive damper.

Now let's come back to the Recycler Ring. For its parameters, ζ  ≈  0.1ξ, so at a maximally available chromaticity, ξ =  - 20, the rms head-tail phase ζ  ≈   - 2.0. In this situation, according to Fig.[\ref=fig:Ik2_vs_zeta], the coupled-beam growth rates and tune shifts are shared mostly between the head-tail modes 1, 2 and 3. The coupled-beam instability is fastest at the lowest possible inter-bunch phase

[formula]

For such a small phase, the coasting beam asymptotic of Eq.([\ref=Oasympt]) is well justified, yielding the growth rate

[formula]

where ω0 is the revolution frequency. This growth rate is more than an order of magnitude higher than any of the separations between the SSC head-tail tunes [formula], so it should entirely go to the rigid-bunch mode. A growth rate so high is hardly possible to suppress by means of Landau damping only. Due to the high space charge parameter for the RR, [formula], the intrinsic Landau damping [\cite=burov2009head] [\cite=PhysRevSTAB.18.074401] is too small for the head-tail modes 1-3.

In case of slipping beams, bunch-by-bunch dampers look highly problematic. However, with sufficiently low frequency of the feedback low-pass filter, the slipping motion should not play a role, so a coasting-beam-like low-frequency damper should work for the slipping bunches as well. If that sort of damper works from the lowest RR frequency of fmin = |ψmin| / (2πτ0) = 55kHz to, say, fmax = 5.5MHz, this would reduce the coupled-beam growth rate to [formula]. This growth rate looks sufficiently small to be suppressible by Landau damping driven either by octupoles or, preferably, by an electron lens, even at zero chromaticity.

Summary

Coupled-bunch modes are described for two slipping beams in a storage ring, as it is the case in the Fermilab Recycler Ring. Distribution of the inter-bunch growth rates between the intra-bunch head-tail modes is considered. Possibilities to stabilize the beams by means of chromaticity, feedback and Landau damping are shown.

I am thankful to S. Nagaitsev for his encouraging interest to this problem and to T. Zolkin for useful discussions and technical help.

FNAL is operated by Fermi Research Alliance, LLC under Contract No. DE-AC02-07CH11359 with the United States Department of Energy.

Theorems on distribution of the coupled-bunch tune shift over the intra-bunch modes

Here the three theorems mentioned in Section [\ref=sec:Distribution] are proved. Since the proofs are similar for ZSC and SSC, only the latter case is presented.

Theorem on the sum of the tune shifts

The dispersion equation ([\ref=EValsEq]) can be transformed into a polynomial one by multiplication on the product [formula]. The leading coefficient of the resulted polynomial equation is 1 and the next one is equal to [formula]. Thanks to a general property of polynomial equations, the negated value of the latter is the sum of the roots νk. Thus, the sum of the head-tail tune shifts νk  -  ν0k is equal to the total tune shift:

[formula]

Since the unperturbed tunes are all real, it follows that sum of all the head-tail growth rates is the coupled-bunch growth rate

[formula]

Theorem on the growth rate signs

Let's prove that all the growth rates [formula] have the same sign; in other words, the intra-bunch modes are either all stable or all unstable, depending on sign of the total growth rate [formula]. First, let's slightly rewrite Eq.([\ref=BurovSCE]):

[formula]

Then, this equation can be multiplied by B*k and summed over all the components k, resulting in,

[formula]

where

[formula]

is the dipole moment associated with the normalized eigenvector [formula],

[formula]

and [formula]. Taking the imaginary part of Eq.([\ref=HTTune]) leads to

[formula]

which proves the theorem. Thanks to the Cauchy inequality,

[formula]

By virtue of Eq.([\ref=RateSum]), the sum of the dipole formfactors ||2 over all the eigenvectors (distinguished by the superscript (p)) is equal to 1:

[formula]

Thus, a single intra-bunch mode can take the entire tune shift Δω if and only if its eigenvector is identical to the dipole moment vector, [formula], which means the mode has to be the rigid-bunch one. That happens when the value of the total tune shift exceeds the bandwidth of the harmonics involved. In that case, all other modes have a negligibly small dipole moment and share almost no growth or damping rate from the coupled-bunch interaction.

Theorem on the eigenvectors orthogonality

In this subsection we will formulate a sufficient condition for the eigenvectors orthogonality. To do that, we have to deal simultaneously with two different eigenvectors; to distinguish them, the bracketed superscripts will be used. Let us write Eq.([\ref=nuBk]) for an eigenvector [formula] and multiply it, left to right, by the eigenvector [formula]:

[formula]

with [formula] as the dipole moment of the eigenvector [formula]. The same equation ([\ref=nuBk]) can be written for the eigenvector [formula], which can then be multiplied, right to left, by the eigenvector [formula]. After that, the second equation can be subtracted from the first, yielding,

[formula]

Therefore, as soon as the coupled-bunch tune shift is real, [formula], all the eigenvectors are orthogonal and their eigenvalues are real as well. If the eigenvectors are normalized, then

[formula]

Although the inter-bunch tune shift is not real for typical wake fields, it is for a purely reactive damper. In the latter case this theorem might be useful.