.def .tex

On additive bases of sets with small product set

Introduction

The duality between the additive and multiplicative structure of an arithmetic set, now called 'sum-product phenomena' has been extensively studied since the seminal paper of Erds and Szemerédi [\cite=ErdosSzemeredi]. In its classical formulation the duality is expressed in the fact that for a finite set of integers or reals A either the set of pairwise sums A + A or pairwise products AA is significantly larger then the original set, unless A is close to a subring of the ambient ring, see [\cite=TaoVu] for details.

In the current paper we consider an intrinsic version of the sum-product phenomenon in the following setting. Assume that a set [formula] has small multiplicative doubling, so that |AA|  ≤  |A|1 + ε for some small ε  >  0 (we assume that |A| is large and ε is fixed).

Recall that a set B is called a basis for A if each element in A can be represented as a sum of two elements in B or simply A  ⊆  B + B.

First, we show that if A is multiplicatively structured in the above sense, then it does not admit small additive bases of order |A|1 / 2 + c for an explicit constant c  >  0.

There is an ε  >  0 such that if B is an additive basis for [formula] with |AA|  ≤  |A|1 + ε. Then holds

[formula]

Theorem [\ref=thm:smalldoubling] implies a 'power-saving' estimate for the multiplicative energy E× of a sumset or a difference set, significantly improving on the sub-exponential bound of [\cite=RocheNewtonZhelezov].

In fact, we prove an even stronger statement then that of Theorem [\ref=thm:smalldoubling], replacing the condition A  ⊆  B  +  B by a weaker assumption that the number of pairs (b1,b2)∈B  ×  B:b1  +  b2∈A is large, see the upcoming Lemma [\ref=lm:convolutions] for details. While slightly more technical, such a reformulation may be useful if one wishes to take into account the number of ways an element in A can be represented as a sum b1  +  b2, see Remark [\ref=r:sigma].

Second, we show that A is additively irreducible, i.e. it cannot be written as a set of sums B + C unless one of the sets consists of a single element.

There is an ε  >  0 such that for all sufficiently large [formula] with |AA|  ≤  |A|1 + ε there is no decomposition A  =  B  +  C with |B|,|C|  ≥  2.

Both theorems substantially extend the results of Roche-Newton and the second author [\cite=RocheNewtonZhelezov], where a much more restrictive condition |AA|  ≤  K|A| with K fixed, was assumed. In particular, in the case at hand deep structural results such as the Freiman-type theorem of Sanders (see e.g. [\cite=SandersExp]) and the Subspace theorem of Evertse, Schlickewei and Schmidt [\cite=evertse2002linear] are no longer available. Instead, we rely solely on techniques of additive combinatorics, which we see as the main innovation of the present paper. On the other hand, Theorem [\ref=thm:irreducibility] extends the result of the first author [\cite=ShkredovSmallProductIrreducibility], which is the specialisation of Theorem [\ref=thm:irreducibility] to the case C  =   - B.

Clearly, Theorem [\ref=thm:irreducibility] has the following sum-product result as a corollary.

Both questions considered in the paper arise as a natural extension of classical problems concerning thin additive bases and additive reducibility of integer sequences to the finite setting.

One of the basic questions, posed by Erds and Newman [\cite=ErdosNewman] in '76, is to estimate the minimal basis size for a given set A and, in particular, to decide if there is a very thin basis for A of size of order |A|1 / 2. They noted that while for a randomly picked set A one should expect that no such basis exists, it is in general hard to prove such a claim for a specific set A.

The question of additive irreducibility of integer sequences was posed by Ostmann [\cite=Ostmann] back in '56. Perhaps the most notable conjecture of Ostmann, still wide open, is that the set of prime numbers cannot be written as a non-trivial set of sums B + C even if one allows to discard a finite number of elements, see [\cite=elsholtz2006additive] for details. Sárközy [\cite=SarkozyDecompositions] (see also [\cite=gyarmati2013reducible] and references therein) extended such problems to the finite field setting, perhaps for the first time suggesting that in general 'multiplicatively structured' sets should be additively irreducible. As a special case of his program, Sárközy conjectured that multiplicative subgroups of finite fields of prime order are additively irreducible, in particular the set of quadratic residues modulo a prime. Despite some progress (see e.g. [\cite=ShkredovQuadraticResidues] and references therein), the conjecture of Sárközy is an important open problem with rich connections (to e.g. multiplicative character sums).

From this point of view, Theorem [\ref=thm:irreducibility] can be seen as a real analog of Sárközy's conjecture for small subgroups, and in fact the proof can be transferred to the finite field setting except a certain sum-product-type estimate not currently available in finite fields. We discuss this matter in more detail at the end of the paper.

The notation is briefly explained in the next section and is relatively standard in additive combinatorics. We recommend the reader to consult [\cite=TaoVu] for further details when needed.

Notation

The following notation is used throughout the paper. The expressions X  ≫  Y, Y  ≪  X, Y  =  O(X), X  =  Ω(Y) all have the same meaning that there is an absolute constant c  >  0 such that |Y|  ≤  c|X|. The expressions [formula] and [formula] both mean that |Y|  =  O(|X| log C|X|) for some absolute constant C  >  0.

For a graph G, E(G) denotes the set of edges and V(G) denotes the set of vertices. If X is a set then |X| denotes its cardinality.

For sets of numbers A and B the sumset A  +  A is the set of all pairwise sums {a  +  a':a,a'∈A}, and similarly AA, A - A denotes the set of products and differences, respectively. If G is some graph with the vertex set identified with A then [formula] denotes the set of sums {a  +  a':(a,a')∈E(G)} (with the obvious generalisation to all arithmetic operations).

For a bipartite graph G with parts (V1,V2) we will occasionally use the term bipartite density for the quantity [formula]. For a general graph, the edge density is defined as the quotient [formula], where the standard notation E(G),V(G) is used for the set of edges and vertices, respectively. For a vertex v∈V(G), N(v) denotes the set of neighbours of v.

The additive energy E+(A), see [\cite=TaoVu] denotes the number of additive quadruples (a1,a2,a3,a4) such that a1  +  a2  =  a3  +  a4. The multiplicative energy E× is defined similarly as the number of multiplicative quadruples.

Proof of Theorem [\ref=thm:smalldoubling]

In what follows we will always assume that 0∉A but 1∈A which one can do without loss of generality.

We will use the following result of the first author (Theorem 5.4 in [\cite=shkredov2013]).

Let [formula] be such that |AA|  =  M|A|. Then

[formula]

Combining with the Plünnecke-Ruzsa inequality [\cite=TaoVu], we have the following corollary.

Recall the following graph-theoretic lemma of Gowers (see e.g. [\cite=TaoVu]).

Let G be a bipartite graph on (B1,B2) where |B1|  =  |B2|  =  n and 0  <  α  =  E(B1,B2) / n2. Let 0  <  ε  <  1 be fixed. Then there is a subset B'1  ⊆  B1 with |B'1|  ≥  αn / 2 such that for at least (1 - ε)|B'1|2 of the ordered pairs of vertices (v1,v2)∈B'1  ×  B'1 the following holds:

[formula]

In what follows, we use a weaker definition of a basis, merely assuming that the number of pairs (b1,b2)∈B  ×  B:b1  +  b2∈A is large. First, it allows one to take into account 'multiplicities', i.e. elements in A which have many representations as a sum. Second, it gives additional flexibility by relaxing the condition that B + B contains all elements in A.

For this matter, let us call a set B an (L,K)-basis for A, with K,L  ≥  1, if |B|  =  K|A|1 / 2 and

[formula]

In what follows, we will make a heavy use of the containment graph G, which is a bipartite graph G on (B,B) such that (b1,b2)∈E(G) iff b1  +  b2∈A. In particular, if B is an (L,K)-basis, one has |E(G)|  =  L- 1|A|  =  |B|2 / LK2, so the bipartite edge density of G is L- 1K- 2.

Let B be an (L,K)-basis for A. Then there is B'  ⊂  B with |B'|  ≫  L- 1K- 2|B| such that for at least 0.99|B'|2 of the ordered pairs (b1,b2)∈B'  ×  B' the equation

[formula]

has at least Ω(L- 2K- 3|A|1 / 2) solutions (a,a')∈A  ×  A.

Applying Lemma [\ref=lm:pairs] to the containment graph G we obtain a set B' of size Ω(L- 1K- 2|B|) such that for 0.99|B'|2 of the ordered pairs (b1,b2)∈B'  ×  B' holds

[formula]

On the other side, if [formula] then by construction b  +  b1  =  a and b  +  b2  =  a' for some a,a'∈A, which after rearranging gives

[formula]

Since, b  +  b1 are all distinct as b varies, we obtain at least [formula] distinct solutions of ([\ref=eq:representations]) for a fixed pair (b1,b2) (and (b2,b1) as well). The result follows.

Another ingredient is a beautiful incidence result, originally proved by Jones [\cite=Jones] with a shorter proof discovered by Roche-Newton [\cite=roche2015short].

Let [formula]. Then the number of solutions to

[formula]

such that a,a',b,b',c,c'∈A is O(|A|4 log |A|).

The following lemma is crucial for the proof.

Let B be an (L,K)-basis for A. Then there is a set R such that the following holds.

R  ⊆  A / A.

[formula].

For any x∈R, the equation

[formula]

has at least Ω(L- 2K- 3|A|1 / 2) distinct solutions (α1,α2) with α1,α2∈A / A.

Let B' be the set given by Lemma [\ref=lm:convolutions]. Let us call a pair (b1,b2)∈B'  ×  B' rich if [formula] in the containment graph G, so that at least 99% of pairs are rich. Take

[formula]

The first claim follows from the construction of the containment graph, so it remains to prove (ii) and (iii).

For x∈R, define

[formula]

and

[formula]

We get by the Cauchy-Schwartz inequality

[formula]

But by Lemma [\ref=thm:RN] we have Q  ≪  |B|4 log |B| and combining with the bound |B'|  ≫  L- 1K- 1|A|1 / 2 we obtain

[formula]

For the third bullet, for an x∈R fix (b1,b2,b) such that x  =  (b2  +  b) / (b1  +  b) and observe that

[formula]

If we vary over [formula], the pairs (b1  +  b') / (b1  +  b),(b2  +  b') / (b1  +  b)) are all distinct, and the claim follows since b1  +  b',b2  +  b',b1  +  b are all in A by construction.

The next lemma is simple but powerful.

Assume 1∈X. Let R  ⊂  X such that for any x∈R the equation

[formula]

has at least N solutions (α1,α2)∈X  ×  X. Then for any set Y holds

[formula]

By definition, E+(YX) is the number of additive quadruples (y1,y2,y3,y4) such that yi∈YX and y1  -  y2  =  y3  -  y4. If 1  -  x  =  α1  -  α2 with x,α1,α2∈X, then clearly (y,yx,yα1,yα2) is an additive quadruple with elements in YX (remember that 1∈X so y∈YX). It remains to check that such quadruples are all distinct. But if

[formula]

then y  =  y' and (x,α1,α2)  =  (x',α'1,α'2), therefore the number of additive quadruples is at least |Y| times the number of distinct triples (x,α1,α2), which is at least N|R|.

It remains to put everything together.

Let B be an (L,K)-basis. Applying Lemma [\ref=lm:popular_diff] and then Lemma [\ref=lm:more_popular_diff] with Y  =  A and X  =  R from Lemma [\ref=lm:popular_diff] we obtain

[formula]

On the other hand, by Corollary [\ref=corr:energy_bound_upper]

[formula]

provided |AA| / |A| is small enough. We then have

[formula]

In particular, if B is a basis for A then

[formula]

The proof of Corollary [\ref=corr:energy] is a simple application of the Balog-Szemerédi-Gowers theorem (BSG) (see [\cite=TaoVu]) so we present it in a sketchy manner. Let X  =  B  ±  B. Since trivialy E×(X)  ≪  |X|3 we may assume that |X|  ≫  |B|2  -  ε with ε to be defined in due course.

If now one assumes that

[formula]

then by BSG there is X'  ⊂  X such that |X'X'|  ≤  |X'|1 + ε' and |X'|  ≫  |X|1 - ε' with ε' depending polynomially on ε. But X'  ⊂  X  =  B  ±  B and whence [formula] is a basis for X' of size O(|X'|1 / 2  +  ε'') with polynomial dependence of ε'' on ε. Taking ε small enough, we contradict Theorem [\ref=thm:smalldoubling] and the claim follows.

The following question was posed in [\cite=ShkredovSmallProductIrreducibility]. Assume that A  ⊆  B - B, |AA|  ≤  |A|1 + ε, where ε  >  0 is small. Is it true that there is δ  =  δ(ε) such that

[formula]

It is easy to see that our methods allow one to resolve the problem in the affirmative. Indeed, put σ  =  σA(B) and consider the graph with B as the vertex set and two vertices x,y adjacent iff x - y∈A. Then the edge density of the graph is α: = σ  /  |B|2. Next, repeat the arguments of Section [\ref=sec:proof_smd] and obtain that for a sufficiently small ε holds

[formula]

and hence since A  ⊆  B - B

[formula]

The asymmetric case with two different sets B,C is considered in the next section. In this case one can obtain an analog of the upper bound ([\ref=tmp:06.06.2016]) of the form

[formula]

It is highly probable that the exponent 1 / 2 + 1 / 442 in Theorem [\ref=thm:smalldoubling] can be improved, perhaps even to 1 - o(1). We pose a much more modest question, which however does not seem to follow from the results of the present paper.

Is it true that there exists c,ε  >  0 such that for all sufficiently large real sets B such that A  ⊂  B + B with |AA|  ≤  |A|1 + ε holds

[formula]

Additive irreducibility of multiplicative sets

In this section we prove Theorem [\ref=thm:irreducibility]. From now on we assume for the sake of contradiction that A  =  B + C with |B|  ≥  |C|  ≥  2 and |AA|  ≤  |A|1 + ε with ε small enough.

First, note that it follows from Lemma 29 of [\cite=ShkredovSmallProductIrreducibility] that for α  ≠  0 and A such that |AA|  ≤  M|A| holds

[formula]

For any c1  ≠  c2∈C one has [formula], and thus by ([\ref=eq:convolution_bound]) and the trivial bound |B||C|  ≥  |A| holds |B|,|C|  ≫  |A|1 / 3  -  ε, say. Hence, we can safely assume that both |B|,|C| are large.

An inspection of the proof of Theorem [\ref=thm:smalldoubling] reveals that if we denote

[formula]

and

[formula]

then one has

[formula]

and

[formula]

for some explicit c  >  0.

However, sufficiently good lower bounds for |X| and |Y| are not readily available. Indeed, by the Cauchy-Schwarz inequality, we have

[formula]

and

[formula]

where T(X,Y,Z) denotes the number of collinear triples of distinct points (x,y,z) with x∈X  ×  X, y∈Y  ×  Y, z∈Z  ×  Z.

We prove the following estimate with |C|  ≤  |B| which improves on Lemma [\ref=thm:RN] when |B| is significantly larger than |C|.

For sets C  ×  C and B  ×  B with |B|  ≥  |C| holds

[formula]

Write Li,j, i,j  ≥  0 for the set of lines [formula] such that [formula] and [formula]. Then

[formula]

Since the number of summands is at most log 2|B| it is enough to bound each term by max (|B||C|3,|B|4 / 3|C|8 / 3). For the sake of notation, denote k  =  2i and l  =  2j, L  =  Li,j so that out task is to estimate |L|k2l where L is the set of lines intersecting C  ×  C in k (up to a factor of two) points and B  ×  B in l points (again, up to a factor of two).

By the Szemerédi-Trotter theorem [\cite=TaoVu], for k  ≥  2,l  ≥  2 holds

[formula]

so

[formula]

Before we proceed, let us rule out the cases not covered by the Szemerédi-Trotter theorem as stated above. Since each line contains at least two points in C  ×  C, only the case l  =  1 should be considered separately. In this case we have

[formula]

which is the desired bound.

Next, since always k  ≤  |C|, l  ≤  |B|, we obtain that [formula] dominates in the first sum and [formula] dominates in the second sum of the considered minimum. Thus

[formula]

or

[formula]

This finishes the proof.

Combining Lemma [\ref=lm:T_CCB], estimate ([\ref=eq:bound_Y]) and the trivial bounds |B||C|  ≥  |A|,|B|  ≥  |A|1 / 2, we have [formula] and

[formula]

which contradicts ([\ref=eq:energy_C]) if |A| is large enough. Thus, A is additively irreducible.

Instead of using the graph approach as it was done in Sections [\ref=sec:proof_smd] and [\ref=sec:decomposition] one can apply in the proof of Theorem [\ref=thm:irreducibility] the following analog of the formula ([\ref=f:1-x])

[formula]

which holds for any b1,b2∈B and all c,c'∈C. It means in particular, in the notation of Section [\ref=sec:decomposition], that taking an arbitrary x∈X, we have at least |C| solutions to the equation

[formula]

where y∈Y and x*∈X are fixed. Of course, one can replace X and Y in the last formula. It immediately gives that E+(AA / A)  ≥  |X||C||A| and E+(AA / A)  ≥  |Y||B||A|.

Discussion

First, let us note the only feature of the reals we used which is not available in an arbitrary field is the Szemerédi-Trotter theorem (which is also used in the proof of Theorem [\ref=thm:ShkredovEnergyBound]). Thus, our results can be readily extended to sets of complex numbers thanks to the extensions of the Szemerédi-Trotter theorem to the complex plane due to Zahl [\cite=MR3392965] and Toth [\cite=toth2015szemeredi].

However, when we replace A with a sufficiently small multiplicative subgroup of [formula], the situation becomes more subtle. For multiplicative subgroups Theorem [\ref=thm:ShkredovEnergyBound] can be substituted with a similar energy bound, beating the exponent 5 / 2, as was shown by the first author [\cite=Sh_ineq]. Next, it follows from the result of Shkredov and Vyugin [\cite=MR2984656] (see also the paper [\cite=ShparlinskiGroupDecomposition] by Shparlinski) that if a multiplicative subgroup G is written as a non-trivial sumset B + C, then necessarily |G|1 / 2 + o(1)  ≪  |B|,|C|  ≪  |G|1 / 2 + o(1). Further, a slightly weaker form of the Szemerédi-Trotter bound for the number of incidences for Cartesian products in [formula] is now available, see [\cite=AMRS]. Thus, the only remaining obstacle for translating Theorem [\ref=thm:irreducibility] to subgroups is to find a substitute for Lemma [\ref=thm:RN], which we were unable to do. However, as was shown in [\cite=AMRS], see also [\cite=RudnevRocheShkredov] the bound O(|A|4 log |A|) of Lemma 4 can indeed be replaced with O(|A|9 / 2), which only barely falls short of the desired bound.

Finally, let us mention that similarly to Section [\ref=sec:proof_smd] one can slightly weaken the hypothesis of Theorem [\ref=thm:irreducibility] and assume only that the number of pairs (b,c)∈B  ×  C:b  +  c∈A is large. We leave the details for the interested reader.

Acknowledgements

The authors would like to thank Tomasz Schoen, Misha Rudnev and Oliver Roche-Newton for useful discussions. The second author would like to acknowledge the hospitality of Adam Mickiewicz University in Poznan at which the work on the present paper was partially conducted.