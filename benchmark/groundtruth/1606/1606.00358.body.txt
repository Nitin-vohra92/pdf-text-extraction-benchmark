Lemma

Sums of multiplicative characters with additive convolutions

Annotation.

In the paper we obtain new estimates for binary and ternary sums of multiplicative characters with additive convolutions of characteristic functions of sets, having small additive doubling. In particular, we improve a result of M.-C. Chang. The proof uses Croot-Sisask almost periodicity lemma.

Introduction

Let p be a prime number, [formula] be the prime field and χ be a nontrivial multiplicative character modulo p. In the paper we consider a problem of obtaining good upper bounds for the exponential sum

[formula]

where A,B are arbitrary subsets of the field [formula]. Exponential sums of such a type were studied by various authors, see e.g. [\cite=Chang], [\cite=DE1], [\cite=Kar]-[\cite=Kar2]. There is a well-known hypothesis on sums ([\ref=f:def_sum]) which is called the graph Paley conjecture, see the history of the question in [\cite=Chang] or [\cite=Shkr_res], for example.

Let us say a few words about the name of the hypothesis. The Paley graph is the graph G(V,E) with the vertex set [formula] and the set of edges E such that (a,b)∈E iff a - b is a quadratic residue. To make the graph non-oriented we assume that [formula]. Under these conditions if one put B =  - A in ([\ref=Paley]) and take χ equals the Legendre symbol then an interesting statement would follow: the size of the maximal clique in the Paley graph (as well as its independent number) grows slowly than pδ for any positive δ.

Unfortunately, at the moment we know few facts about the hypothesis. An affirmative answer was obtained just in the situation [formula], [formula], see [\cite=Kar]--[\cite=Kar2]. Even in the case [formula] inequality ([\ref=Paley]) is unknown, see [\cite=Kar2]. However, nontrivial bounds of sum ([\ref=f:def_sum]) can be obtained for structural sets A and B with weaker restrictions for the sizes of the sets, see [\cite=Chang], [\cite=FI], [\cite=Kar]. Thus, in paper [\cite=Chang] Mei-Chu Chang proved such an estimate provided one of the sets A or B has small sumset. Recall that the sumset of two sets [formula] is the set

[formula]

In our paper we refine Chang's assumption [formula] and prove the following theorem.

Of course our result is not a direct improvement of Chang's theorem because of the additional assumption [formula]. However it is applicable in the case B =  - A and hence in terms of the Paley graph our result is better. On the other hand, the Plünnecke-Ruzsa triangle inequality (see Theorem [\ref=t:Ruzsa_triangle] below) implies that the restriction [formula] gives us [formula] and hence if A and B have comparable sizes then it is enough to assume condition ([\ref=cond:last]) in Theorem [\ref=main_theorem]. Nevertheless the dependence on K and L in formula ([\ref=f:main_theorem]) is asymmetric and thus the formulation of our results in terms of these two parameters is reasonable.

Our approach uses a remarkable Croot-Sisask lemma [\cite=Croot-Sisask] on almost periodicity of convolutions of the characteristic functions of sets. Thanks to the result we reduce sum ([\ref=f:main_theorem]) to a sum with more variables. It seems like that it is the first application of the lemma in Analytical Number Theory.

In paper [\cite=Hanson] B. Hanson obtained a bound for so-called ternary sum.

Using the method of the proof of Theorem [\ref=t:Chang] as well as some last results from sum--product theory [\cite=Shkr2], we obtain an upper bound for the ternary sum in the case of sets with small additive doubling.

From the proof of Theorem [\ref=ternarnic] it follows that a nontrivial upper bound in formula ([\ref=f:Hanson]) requires the restriction ζ  ≫   exp ( - ( log p)α), where α > 0 is an absolute constant.

Definitions and notation

Recall that the (Minkowski) sumset of two sets A and B from the field [formula] is the set

[formula]

In a similar way one can define the difference, the product and the quotient set of two sets A and B as

[formula]

[formula]

[formula]

Also for an arbitrary [formula] by g + A and gA denote the sumset [formula] and the product set [formula], correspondingly. We need the remarkable Plünnecke-Ruzsa triangle inequality (see [\cite=TV], p.79 and section 6.5 here).

Besides, we denote

[formula]

Let A be an arbitrary set. We write A(x) for the characteristic function of A. In other words

[formula]

We need in the notion of the convolution of two functions [formula]

[formula]

Lp-norm of a function [formula] is given by

[formula]

Also we will use the multiplicative energy of a set A, see [\cite=TV]

[formula]

and the additive energy of A [\cite=TV]

[formula]

A generalized arithmetic progression of dimension d is a set [formula] of the form

[formula]

where [formula] are some elements from [formula]; P is said to be proper if all of the sums in ([\ref=representation]) are distinct (in the case [formula]).

It is known that the constant C(K) can be taken equal C(K)  =  ( log 2K)3 + o(1), see [\cite=Sanders_survey].

Also let us remind that a multiplicative character χ modulo p is a homomorphism from [formula] into the unit circle of the complex plane. The character [formula] is called trivial and the conjugate to a character χ(x) is the character [formula]. The order of a character χ is the least positive integer d such that χd  =  χ0. One can read about properties of multiplicative characters in [\cite=Stepanov] or [\cite=IK].

We need a variant of André Weil's result (see Theorem 11.23 in [\cite=IK]).

Also we will use the Hölder inequality.

For any positive p and q such that [formula] one has

[formula]

In particular, we have the Cauchy-Schwarz inequality

[formula]

As we said in the introduction our proof relies on the Croot-Sisask lemma, see [\cite=Croot-Sisask] and [\cite=Sanders_survey].

Let [formula], [formula], [formula] be real numbers, A and S be subsets of an abelian group G such that [formula] and let f∈Lq(G) be an arbitrary function. Then there is s∈S and a set T  ⊂  S - s, [formula] such that for all t∈T the following holds

Some preliminary lemmas

In paper [\cite=Shkr2] the following two important results were proved.

The results above imply two consequences.

For any set [formula] such that [formula] and |A|3K  =  O(p2) one has [formula].

Let S = A + A (the case A - A is similar). We have

[formula]

Using Theorem [\ref=energy], we get as required.

Suppose that [formula] are any sets and K,L, [formula] are positive numbers such that Then the system of equations

[formula]

has

[formula]

solutions in the variables (a,a',b1,b1',b2,b2',c1,c1',c2,c2')∈A2  ×  B4  ×  C4.

Clearly, the number of trivial solutions b1 =  - c1, b'1 =  - c'1, b2 =  - c2, b'2 =  - c'2 and a1,a2∈A are any numbers does not exceed

[formula]

and this gives us the second term in ([\ref=f:bound_E^t_3]). Below we will assume that all numerators in ([\ref=system]) are nonzero.

Let S  =  B + C and for any [formula] put Obviously, each element s of the set S has at most [formula] representations of the form s = b + c, where b∈B and c∈C and, hence, for any λ one has

[formula]

Let ω2  =  |C|4 / 3|B|3 / 2|S|4 / 3|A|- 3 / 4K3 / 4. Consider two sets

[formula]

Since

[formula]

it follows that

[formula]

Indeed the last inequality is equivalent to

[formula]

which is true because of the conditions [formula] and [formula].

Further, the systems of the equations ([\ref=system]) can be rewritten in an equivalent form, namely,

[formula]

Whence the number of its solutions equals

[formula]

Foremost let us estimate the first sum in ([\ref=answer])

[formula]

Further using the Cauchy-Schwarz inequality, we get for the second sum in ([\ref=answer])

[formula]

By the assumption [formula] and hence |A|3K  =  O(p2). Thus by Lemma [\ref=energy_esteem], we obtain

[formula]

[formula]

For any [formula] consider the set

[formula]

Take the set of points P = Wτ  ×  B in [formula] and the set of lines

[formula]

Because [formula] it follows that the number of incidences between the points P and the lines L can be estimated by Theorem [\ref=lines] as

[formula]

Further, using a trivial bound [formula], we see that the inequality

[formula]

is followed from

[formula]

Let us prove that the last bound takes place. Indeed, the number of the solutions of equation ([\ref=system]) can be estimated by Theorem [\ref=energy] and formulas ([\ref=g<f]), ([\ref=answer]) as

[formula]

because of [formula]. Hence, in the light of the required estimate ([\ref=f:bound_E^t_3]), we can assume that

[formula]

But then we have [formula] and thus inequality ([\ref=tmp:16.05.2016_2]) holds immediately.

Further if

[formula]

then the number of incidences ([\ref=incidents]) equals

[formula]

Finally, in view of

[formula]

we get

[formula]

But if ([\ref=tmp:16.05.2016_1]) does not hold then because of, trivially, [formula] one can check bound ([\ref=Wtau]) directly. So, inequality ([\ref=Wtau]) takes place.

As we noted before the maximal value of f(λ) is at most [formula]. Using the fact and inequality ([\ref=Wtau]), we see that

[formula]

Applying simple bound ([\ref=g<f]), we obtain

[formula]

Combining inequalities ([\ref=after_kbsh]), ([\ref=h_esteem]) and ([\ref=g_esteem]), we get

[formula]

Altogether from ([\ref=answer]), ([\ref=first_sum]), ([\ref=second_sum]) and our choice of the parameter ω, we have

[formula]

[formula]

This completes the proof of the lemma.

Weil's Theorem implies the following result.

For any nontrivial character χ, an arbitrary set [formula] and a positive integer r one has

[formula]

We have

[formula]

Consider a polynomial

[formula]

Then

[formula]

The polynomial f(x) has at most 2r distinct roots. The order d of the character χ is a divisor of p - 1 and hence it is coprime with p - 2. Thus if there exists an element tk (let us call it a <<unique>> element) among the numbers [formula] with [formula], tj  ≠  tk then the polynomial f(x) satisfies all conditions of Weil's Theorem and in the case, we have

[formula]

Clearly, the number of tuples with a <<unique>> element does not exceed the total number of tuples [formula], i.e. [formula]. Now let us estimate the number of tuples [formula] having no a <<unique>> element. Then, obviously, any element of such a tuple appears in it at least twice. Hence each of these tuples contains at most r different elements and thus the number of such sequences can be bounded as [formula]. For any tuple without a <<unique>> element we estimate the sum [formula] by p. Whence we obtain a final bound

[formula]

This completes the proof.

The proofs of statements which are similar to Lemma [\ref=davenport] can be found in [\cite=Chang] and in book [\cite=IK], see Corollary 11.24.

The proofs of the main results

First of all, we prove Theorem [\ref=ternarnic] and after that show how it implies Theorem [\ref=main_theorem].

We will assume that [formula]. Clearly, one can suppose that the inequality [formula] takes place otherwise it is nothing to prove (see Remark [\ref=p(d] [\ref=K] [\ref=L)] below about the dependence of the quantity p(δ,K,L) on L or just the current proof). According the Freiman theorem on sets with small doubling there is a generalized arithmetic progression [formula] of the dimension d, where

[formula]

such that

[formula]

[formula]

[formula]

Put

[formula]

Take the interval [formula] and the generalized progression A0 of the dimension d defined as

[formula]

Clearly,

[formula]

and

[formula]

Because of [formula] and hence

[formula]

we, clearly, get

[formula]

Let us fix x∈A0,y∈I and estimate the sum

[formula]

The numbers x∈A0, y∈I can be taken in such a way that the last sum in ([\ref=9]) does not exceed the mean, whence

[formula]

Now having any fixed a∈A - A0I, let us estimate the sum

[formula]

Here we have denoted Ba = a + B. By the Cauchy-Schwarz inequality, we get

[formula]

For any pair [formula] put

[formula]

Then for any x  ≠  0, we have

[formula]

The inequality in ([\ref=main_esteem]) follows from the Hölder inequality and the Cauchy-Schwarz inequality. By Lemma [\ref=davenport]

[formula]

The last inequality takes place because [formula] and [formula]. Further note that

[formula]

and by Lemma [\ref=system_solution], combining with inequalities ([\ref=0]), ([\ref=-1]), ([\ref=2]), ([\ref=A0+A0]) and condition ([\ref=cond:first]), we obtain

[formula]

Using estimates ([\ref=kbsh])--([\ref=3.20]), we see that Because [formula] and hence [formula], we obtain further

[formula]

Bound ([\ref=3.24]) takes place for any a and thus inequalities ([\ref=A-A_0I]), ([\ref=rand]) imply

[formula]

The theorem follows from ([\ref=final_inequality]) if one takes [formula], for example.

From inequality ([\ref=final_inequality]) it is easy to find the quantity p(δ,K,L) in a concrete form. Indeed, it is enough to choose p such that [formula] and [formula]. It shows that we have subexponential dependence of the constants K,L on p in our theorem.

Let M > 0 be a real parameter which we will choose later. Put [formula]. Using Lemma [\ref=Croot-Sisask] of Croot and Sissak with q = 2 and S = A, f = B, we find a∈A and a set T  ⊂  A - a such that [formula] and for any t∈T one has Clearly, the cardinality of the support of the function [formula] does not exceed [formula] and hence by the Hölder inequality the following holds

[formula]

The constant M in the definition of ε can be chosen in such a way that [formula]. Besides by the Plünnecke-Ruzsa triangle inequality, we get

[formula]

Thus the sets A, B and - T satisfy all conditions of Theorem [\ref=ternarnic] with A = A, B = B and C =  - T. Taking p > p(δ,K,L), we obtain where τ  =  τ(δ,K) = δ2( log 2K)- 3 + o(1). Whence for all sufficiently large p, namely, for

[formula]

the inequality takes place and thus

[formula]

Now, using bounds ([\ref=main1]), ([\ref=main2]) and the triangle inequality, we get

[formula]

hence

[formula]

This completes the proof of the theorem.

In the beginning of writing the text we planed to use Burgess inclusion ([\ref=f:Bergess]) in the form

[formula]

where the set of almost periods T is given by the Croot-Sisask lemma. Nevertheless it turns out that the arguments above are more effective.

We finish the paper showing how our Theorem [\ref=ternarnic] implies Theorem [\ref=t:Hanson].

We almost repeat the arguments from [\cite=Hanson]. Assuming

[formula]

one can easily derive from it that

[formula]

and

[formula]

After that we use the Balog-Szemerédi-Gowers Theorem, see e.g. [\cite=TV] and find subsets A'  ⊆  A, B'  ⊆  B, C'  ⊆  C such that |A' + A'|  ≪  (εζ)- M|A'|, |B' + C'|  ≪  (εζ)- M(|B'||C'|)1 / 2 and |A'|  ≫  (εζ)M|A|, |B'|  ≫  (εζ)M|B|, |C'|  ≫  (εζ)M|C|. Here M > 0 is an absolute constant. Applying Theorem [\ref=ternarnic] to the obtained sets and using simple average arguments (see [\cite=Hanson]), we arrive to a contradiction.

It is easy to count (see, e.g. condition ([\ref=f:cond_p] [\ref=K_t4]) from the proof of Theorem [\ref=ternarnic] or Remark [\ref=p(d] [\ref=K] [\ref=L)]) that a nontrivial estimate in formula ([\ref=f:Hanson]) requires the restriction of the form ζ  ≫   exp ( - ( log p)α), where α > 0 is an absolute constant.

A.S. Volostnov Moscow Institute of Physics and Technology (State University), 9 Institutskiy per., Dolgoprudny, Moscow Region, 141700, Russian Federation gyololo@rambler.ru

I.D. Shkredov Steklov Mathematical Institute of Russian Academy of Sciences, ul. Gubkina, 8, Moscow, Russia, 119991 ilya.shkredov@gmail.com