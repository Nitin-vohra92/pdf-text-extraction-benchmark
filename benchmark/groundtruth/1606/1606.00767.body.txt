The small-scale turbulent dynamo in smoothed particle magnetohydrodynamics

Introduction

There are three broad classes of methods used to simulate astrophysical hydrodynamics. Generally speaking, these are:

Eulerian, grid-based methods which discretise the volume the fluid occupies into a collection of cells. The cells keep their location fixed in space, calculating the transfer of fluid between adjacent cells. Examples of such codes include Pluto [\cite=pluto1] [\cite=pluto2], Athena [\cite=athena], Ramses [\cite=ramses], and Flash [\cite=fryxelletal00] [\cite=dubeyetal08].

Lagrangian, particle-based methods that discretise the fluid into a set of particles. The particles move according to the fluid flow, mimicing fluid behaviour. The most common approach is smoothed particle hydrodynamics (SPH), with codes such as Gadget2 [\cite=gadget2] [\cite=ds09], Gasoline [\cite=gasoline] and Phantom [\cite=pf10].

Methods that combine elements of Eulerian and Lagrangian methods, for example, the moving-mesh code Arepo [\cite=arepo], the mesh-free method Gizmo [\cite=hopkins15], and the Lagrangian-Eulerian re-map code Lare3d [\cite=arberetal01].

In this work, we use the second approach, employing smoothed particle magnetohydrodynamics (SPMHD). Right from the beginning when SPH was first formulated in 1977, there was optimism that magnetic fields could be included as part of the method, " magnetic fields may be included without difficulty " [\citep=gm77]. However, this turned out not to be quite so easy in practice - the conservative SPMHD method is unstable when the magnetic pressure exceeds the thermodynamic pressure [\cite=pm85]. This was investigated further over the next 20 years by [\citep=morris96] [\citep=mwd95] [\citep=bot01] and others, with the modern SPMHD method given in the series of papers by Price & Monaghan [\citep=pm04a] [\citep=pm04b] [\citep=pm05].

Nowadays, SPMHD has achieved a level of maturity that allows for practical simulations, for example, the study of jets & outflows during protostar formation [\cite=ptb12] [\cite=btp14] [\cite=lbp15] [\cite=wpb16]. A significant development has been the constrained hyperbolic divergence cleaning method to handle the divergence-free constraint of the magnetic field [\cite=tp12].

In this work, we apply SPMHD to the study of small-scale dynamo amplification of magnetic fields in supersonic turbulence, the first time such a regime has been explored with SPMHD. Purely hydrodynamic supersonic turbulence has been studied with SPH by [\cite=pf10], who compared the statistics of driven, supersonic turbulence between SPH and grid-based methods. They found excellent agreement on the qualitative behaviour and statistics of the turbulence. Our current work extends that comparison to include magnetic fields, thus we can be confident that the hydrodynamics are well-modelled and we can focus on differences introduced by magnetic fields.

Recent developments in smoothed particle magnetohydrodynamics

The set of simulations performed in this work solve the magnetohydrodynamics (MHD) equations, given by which, since we will solve them using a Lagrangian scheme, are written using the Lagrangian time derivative, [formula]. The variables have their usual meaning: ρ is the density, [formula] is the velocity, [formula] is the magnetic field, P is the thermodynamic pressure and μ0 the permeability of free space. In SPMHD, the density is obtained by summation and solved iteratively with the smoothing length [\cite=pm07]. The magnetic tension force is implemented using the approach of [\cite=bot01]. A full review of SPMHD is given by [\cite=price12] [\cite=tricco15].

'Constrained' hyperbolic/parabolic divergence cleaning

The problem with the induction equation (Eq. [\ref=eq:induction]) is that it makes no guarantee to preserve the divergence-free nature of the magnetic field ([formula]). Numerical errors will introduce monopoles into the magnetic field, which may then grow over the long-term and lead to unphysical results.

We use the 'constrained' hyperbolic/parabolic divergence cleaning method [\cite=tp12] to remove divergence errors in the magnetic field. The method is an SPMHD adaptation of the method by [\cite=dedneretal02], and cleans the magnetic field by coupling a scalar field, ψ, to the magnetic field according to Together, they propagate the divergence of the magnetic field as a damped wave with characteristic speed ch set equal to the local fast MHD wave speed. The damping timescale is τ  =  h  /  σch, where h is the smoothing length and σ = 1.0 in 3D is a dimensionless constant. The third term in Eq. [\ref=eq:psievo] was introduced to account for changes in ψ due to compression and rarefaction of the gas [\cite=tp12].

The method is 'constrained' in that it is built using the energy conserving formalism of SPH. Defining the specific energy content of the ψ field to be eψ  =  ψ2  /  2μ0ρc2h, the discretised hyperbolic cleaning equations may be obtained such that the total energy (eψ plus magnetic) is constrained to stay constant. This remedies problems that would otherwise occur at sharp density contrasts and free boundaries when the same differential operator is used for [formula] and [formula] [\cite=tp12], and when coupled with parabolic diffusion, means the divergence cleaning can only ever lead to reductions in divergence error.

Aritificial resistivity switch

Discontinuities in the magnetic field are captured by adding an artificial resistivity [\cite=pm04a] [\cite=pm05]. This smooths the magnetic field on the resolution scale so that it remains single-valued. However, it is equivalent to adding diffusion in the form of [formula] with coefficient ηAR  ~  αBvsigh, where αB is a dimensionless constant of order unity and vsig is the characteristic speed of the shock. Such diffusion is only meant to treat discontinuities, and the trick is to detect where those discontinuities are located so that artificial resistivity can be switched off when not needed in order to minimise numerical dissipation.

Price & Monaghan [\cite=pm05] used a switch to detect discontinuities, evolving αB using a differential equation with a source term proportional to [formula]. However, this approach fails for strong shocks with very weak magnetic fields, not setting αB to sufficient levels to keep the magnetic field single-valued [\cite=tp13].

Our new approach [\cite=tp13] is to directly set [formula]. This measures the relative size of the jump in the magnetic field compared to the absolute value of the field strength, giving a measure which works for any magnetic field strength. This is particularly relevant for the magnetised, supersonic turbulence comparison on which this paper is focused, allowing shocks to be detected during magnetic field amplification [\cite=tp13].

Enhancing the divergence cleaning

The divergence cleaning method can be enhanced in two ways. One is by explicitly increasing the cleaning wave speed. Increasing the wave speed by an over-cleaning factor of 10 would set ch  →  10  ×  ch. This approach is easy to implement and has found some use in practice [\cite=btp14], but is computationally expensive because it directly reduces the timestep due to the Courant condition. The second approach is to sub-cycle the cleaning equations between timesteps, pausing the rest of the simulation and holding the particles fixed while the cleaning equations are solved for a number of sub-steps. This is much more computationally efficient than over-cleaning, however is more complicated to implement in code, particularly when dealing with individual timesteps.

We have tested over-cleaning and sub-cycling of the divergence cleaning equations using the Orszag-Tang vortex [\cite=ot79]. In general, we find that over-cleaning and sub-cycling yield similar results for equivalent over-cleaning factors and numbers of sub-cycles (Fig. [\ref=fig:ovcitc]). That is, an over-cleaning factor of 10 produces results on par with performing 10 sub-cycles every timestep. Each factor of 10 increase in over-cleaning factor and number of sub-cycles produced half an order of magnitude reduction in average [formula] divergence error.

An advantage that sub-cycling offers is tolerance based divergence cleaning. Instead of prescribing a fixed number of iterations, the cleaning equations may be sub-cycled until a particular criterion is met, such as a threshold on average level of divergence error. The left panel of Fig. [\ref=fig:itvtol] shows the average [formula] divergence error with tolerances set to 0.1%, 0.05% and 0.02%, showing that tolerance based divergence cleaning with sub-cycling is possible. It is also possible to set the tolerance level as strict as desired, and in the right panel of Fig. [\ref=fig:itvzero] we show that 'constrained' hyperbolic divergence cleaning may be used to reduce the divergence of the magnetic field all the way to zero, formally achieving [formula]. That is not really feasible in practice though, as the number of sub-cycles required to achieve this is prohibitively expensive on the order of tens of thousands of sub-steps (right panel, Fig. [\ref=fig:itvzero]).

Small-scale turbulent dynamo: SPH compared to Grid

Molecular clouds are supersonically turbulent, generating dense filaments that become the birth sites of protostars [\cite=mk04] [\cite=mo07] [\cite=fk12] [\cite=padoanetal14]. We have performed simulations of molecular cloud turbulence involving magnetic fields to test our SPMHD methods. The key piece of physics studied is the small-scale dynamo, an example of a fast dynamo that amplifies magnetic energy at an exponential rate [\cite=bs05]. By stretching, twisting and winding magnetic fields near the dissipation scale (hence 'small-scale'), kinetic energy is converted into magnetic energy.

The growth of the magnetic field due to small-scale dynamo undergoes three phases. First is the steady, exponential amplification of magnetic energy. Second, once the magnetic energy has saturated on the smallest scale, the dynamo enters a slow linear or quadratic growth phase while the medium and large scale magnetic fields continue to be amplified [\cite=choetal09] [\cite=federrathetal11] [\cite=schleicheretal13]. The third phase is the fully saturated phase once the magnetic field is saturated at all spatial scales.

The simulations are performed using the SPMHD code Phantom, and the grid-based code Flash [\cite=fryxelletal00] [\cite=dubeyetal08], comparing results between the two distinct methods.

Magnetised turbulence-in-a-box

The simulations use a periodic box of length L = 1. The initial density is ρ = 1, velocity [formula] and an isothermal equation of state is used, P = c2sρ, with cs = 1. The initial magnetic field is Bz  =  10- 5 such that the plasma beta is β  =  1010. These simple initial conditions ensure that both codes start from identical states. The turbulence is driven by stirring the gas at large scales (1  <  k  <  3 peaked at k = 2) through an added solenoidal force generated through an Ornstein-Uhlenbeck procedure [\cite=ep88] [\cite=schmidtetal09] [\cite=federrathetal10]. This keeps the rms velocity of the gas steady at Mach 10 (M = 10), and maintains the reservoir of kinetic energy for the dynamo to draw upon. The simulation is run for 100 turbulent crossing times, defined as tc  =  L  /  2Mcs, capturing the full dynamo amplification phase and the statistical steady-state of the saturated phase. The simulations are performed for resolutions of 1283, 2563, and 5123 particles and grid cells.

Results

The evolution of the kinetic and magnetic energy for all calculations at all resolutions is shown in Fig. [\ref=fig:en_mag]. In all cases, the kinetic energy saturates within one crossing time (Ek  ~  50), and is maintained it at a near constant level by the driving routine. The three phases of dynamo amplification of magnetic energy are evident: the steady, exponential amplification of magnetic energy, transitioning to the slow growth of magnetic energy ([formula]), followed by the fully saturated magnetic field with a constant energy level (Em  ~  100). The exponential growth rate has little variation for the Flash calculations, yet exhibits an increasingly higher growth rate for higher resolution with Phantom. This can be traced to the differing shock capturing techniques used between the methods, as the numerical dissipation of the shock capturing is the primary factor in setting the growth rate of the dynamo for these simulations. All simulations saturate the magnetic energy at a similar level (2-4% of the mean kinetic energy).

Fig. [\ref=fig:column-integrated] shows the column density and column integrated magnetic field strength for the 2563 resolution calculations. At early times, both codes have similar density fields, but diverge at later times due to the non-linearity of the turbulence. The densest regions contain the strongest magnetic fields, yet the magnetic field throughout the whole domain is growing in strength.

The growth of the magnetic field at different spatial scales can be quantified by looking at the power spectra of magnetic energy. As shown in Fig. [\ref=fig:growthspectra], both codes exhibit the same behaviour for all resolutions, with the magnetic energy initially increasing uniformly at all spatial scales with little change in shape. This corresponds to the exponential growth phase, and is characteristic for the small-scale dynamo [\cite=bs05] [\cite=federrathetal14]. The power spectra converge first on the smallest spatial scales, at which point the dynamo enters the slow growth phase [\cite=federrathetal14]. This may be seen by the time delay for the larger scales of the power spectra to converge.

Fig. [\ref=fig:bsqpdf] shows the probability distribution function (PDF) of B2, with each curve representing a single snapshot in time and the red line the time-averaged PDF in the saturation phase. At early times, during the exponential growth phase, both Phantom and Flash have log-normal distributions of similar widths. The distributions maintain their width and shape as the magnetic field is amplified, with the mean increasing at a steady rate. As the dynamo nears saturation, the strongest magnetic fields no longer are amplified and the high-end tail of the distribution anchors in place. However, the low-end tail continues to be amplified (the slow growth phase), and the distribution takes on a lop-sided shape. Both codes exhibit this behaviour, consistent with previous numerical studies [\cite=schekochihinetal04b] [\cite=schekochihinetal04c], and have similar maximum magnetic field strengths.

Summary

We have performed simulations of the small-scale dynamo amplification of magnetic fields in supersonic turbulence, comparing results between SPMHD and grid-based methods. The latest developments in SPMHD are utilised, namely the 'constrained' hyperbolic divergence cleaning method to handle the divergence-free constraint of the magnetic field and a new switch to reduce numerical dissipation from artificial resistivity. The simulations are performed for 100 turbulent crossing times, allowing study of the full growth and saturation of magnetic energy due to dynamo amplification. Excellent agreement is found on the qualitative behaviour and properties of the magnetic field between SPMHD and the grid code. The exponential growth rate of magnetic energy has different resolution dependence, with SPMHD yielding faster growth rates for higher resolution, caused by the different approaches used to treat shocks. Overall, we conclude that SPMHD can correctly model the small-scale dynamo amplification of magnetic fields in supersonic turbulence.

TST is supported by a CITA Post-doctoral Research Fellowship. The majority of this work was carried out while TST was still a PhD student, during which he was supported by an Australian Postgraduate Award and Endeavour International Postgraduate Research Scholarship. DJP is supported by ARC Future Fellowship FTI130100034, and acknowledges funding provided by the ARC�s Discovery Projects (grant no. DP130102078). CF acknowledges funding provided by the Australian Research Council�s Discovery Projects (grants DP130102078 and DP150104329). This research was undertaken with the assistance of resources provided at the Multi-modal Australian ScienceS Imaging and Visualisation Environment (MASSIVE) through the National Computational Merit Allocation Scheme supported by the Australian Government. We gratefully acknowledge the Jülich Supercomputing Centre (grant hhd20), the Leibniz Rechenzentrum and the Gauss Centre for Supercomputing (grant pr32lo), the Partnership for Advanced Computing in Europe (PRACE grant pr89mu), and the Australian National Computing Infrastructure (grant ek9). Some figures were created using the interactive SPH visualisation tool Splash [\cite=splash].