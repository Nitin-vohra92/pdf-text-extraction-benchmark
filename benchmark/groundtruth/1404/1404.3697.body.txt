The configuration multi-edge model: Assessing the effect of fixing node strengths on weighted network magnitudes

Introduction

Modern complex networks theory has found many applications since its dawn. In particular, the explosion of information technologies has given rise to large-scale, high-dimensional data sets, in which hidden relations might now be uncovered. This has fostered data-driven studies in a wide spectrum of fields ranging from biology [\cite=serrano2009extracting] to social sciences [\cite=Stehle2013604], including transportation studies [\cite=Barthelemy2011], genomics [\cite=Uhlmann2012], ecology or bibliometrics [\cite=camacho2002robust]. The repertoire of available networks for data modeling has thus grown accordingly: binary or weighted [\cite=Zlati2010] [\cite=Newman2004b], directed or undirected, and also simple or multilayer [\cite=Gomez2013a] [\cite=DeDomenico2013] structures have been used. However, extending some of the most basic concepts and tools, such as clustering coefficient, centrality measures, and even finding suitable null models in each case has proven harder than expected [\cite=Saramaki2007], giving rise to multiple definitions in some cases and, consequently, to some controversy.

In fact, the need to distinguish different types of so-called weighted networks according to the nature of the events being represented has been pointed out recently [\cite=Sagarra2013c]. If nodes accept multiple distinguishable connections, then one can speak of multi-edge networks, and it is in this scenario where we propose a flexible, general theory for null-model generation. Our results allow to compute exact analytical expressions for network observables generated under random conditions but preserving some given properties or constraints from the original data [\cite=Squartini2011c] [\cite=Annibale2009a]. This allows to quantify the relevance of the observed features, which given the high-dimensionality of the studied data sets in real complex networks might not be trivial to detect otherwise [\cite=Bianconi2009a]. A classical example where this circumstance is important are Origin-Destination matrices (OD), where the mobility of agents between departure and arrival nodes is represented as weighted networks: usually the average total flow incoming or outgoing from each site, which corresponds to the strength of a node, is constrained by several factors such as population or density of commercial areas. This fact needs to be assessed on the observed data as it can generate complicated spatial patterns that can produce spatial correlations such as the so-called gravity laws of transportation [\cite=Barthelemy2011].

In this letter, the effect of fixing an arbitrary strengths sequence on several network observables is thoroughly studied. The obtained results serve as a complement to its binary counterpart, the classical configurational model for arbitrary degree sequences [\cite=Molloy1995a]. We develop the full edge and node statistics as well as first order correlations using an application of a general ensemble approach developed in [\cite=Sagarra2013c], providing not only average expected values for the observables but also precise bounds for its fluctuations and we compare the obtained results with simulations, yielding excellent agreement. By particularizing our general results to the case of power law distributed strengths, commonly found in real data [\cite=Colizza2006a] [\cite=Kaluza2010a] [\cite=Roth2011] [\cite=DeMontis2005] [\cite=Barrat2013a], we demonstrate how the null-model expectations of some widely used weighted network metrics, which are generally considered a sign of relevant correlations (see [\cite=Popovic2012] and references therein), can instead be seen as just a consequence of the particular form of the imposed strength sequence, and hence may not represent any unexpected property of the network under study.

Theoretical Framework

We start by considering a multi-edge undirected network with a fixed number of nodes N and hence a total of L = N(N + 1) / 2 possible edges. Each edge has an associated integer weight [formula], and the strength of a node i is defined as [formula]. We further consider a fixed strength sequence {i}  ;i∈1,N, so that we have a total of [formula] distinguishable events to be randomly allocated among L edges. Note that the difference between distinguishable and non-distinguishable events is crucial, as it happens usually in statistical mechanics, because the resulting statistics of the ensembles one can consider depend on this property (see [\cite=Garlaschelli2009z] [\cite=Sagarra2013c] for an extended discussion). As for the notation, note also that in general we will use x̂ to denote the value to which a variable x is being constrained

To clarify the elements of our system, we can specify them for the case of an OD study as an illustrative example: Nodes correspond to different locations, events to individual trips between locations, the strengths of nodes to the fixed amount of travelers departing/entering each location and the weights correspond to the observed flows between locations. In this work we consider the case where self-loops are allowed for simplicity but the methodology can be easily extended to the case where no-self-loops are accepted or even to directed networks.

Under the circumstances described, in analogy to statistical mechanics for classical systems, one can consider the Grand-Canonical (GC) ensemble of graphs (see [\cite=Bianconi2009b] [\cite=Squartini2011a] for different examples of other network ensembles) fulfilling on average the proposed constraints, i.e. [formula] (throughout this letter 〈x〉 will refer to the ensemble average of random variable x whereas x̄ will refer to the graph average of variable x over a single realization). This means that both the occupation numbers or weights tij and the node strengths [formula] are integer random variables, and that each network belonging to the ensemble corresponds to a different realization of such variables. However, relative fluctuations around the constraints [formula] vanish in the large event limit [\cite=Sagarra2013c]. The GC ensemble yields independent Poisson statistics for the occupation numbers tij with mean 〈tij〉  =  βxixj, where {xi} can be considered as node-specific hidden variables [\cite=Goh2001] [\cite=Caldarelli2002] [\cite=Boguna2003]. The values of {xi} can be obtained by solving the N saddle point equations [formula] that define the constraints of the system, which correspond to fixing the (ensemble) average strength of each node in the network. This set of equations is easily solvable analytically yielding [formula] and β  =  T̂- 1. In this way the expression [formula] is reached: the left-hand side is the ensemble average of a random variable, while the right-hand side is a result expressed in term of the constraints. In our case the {i} are the only fixed quantities and hence we must take them as the basic variables from which to derive the rest of weighted network properties: All nodes sharing the same strength value i  =   are statistically equivalent, and possess self-averaging properties (likewise all edges connecting nodes with the same pair of strength values). In what follows, we show how to proceed to obtain some particular network metrics, although the procedure is fully general and permits to obtain any desired property.

General methodology

Many network metrics widely used in the literature can be written as a quotient of functions of the edge weights M = x(tij) / y(tij). In our framework, {tij} are random variables and computing [formula] is not straightforward. We thus need to rely on approximations, expanding the expressions in Taylor series around their mean values and then taking the ensemble average of the first terms of the sum. These expressions can be used to compute expected values and and fluctuations of any network metric expressed as a ratio of functions of the occupation numbers x(tij),y(tij) provided that the moments ([formula]) in the right-hand side can be evaluated. This is usually the case when x(tij),y(tij) are algebraic expressions of {tij} (which are uncorrelated random variables). For most metrics M considered in this Letter, the calculations of the moments of x(tij) and y(tij) are lengthly, but follow from a general methodology without further difficulty. We thus subsume them in the Appendix also explaining the general strategy used in their calculation, stating here only the key results.

Distribution of weights

We start by computing the distribution of occupation numbers or weights

[formula]

([formula] refers to the total number of existing edges), which has been reported to have broad forms on empirical data for airport flow [\cite=Colizza2006a], cargo ship transport [\cite=Kaluza2010a], public transport in cities [\cite=Roth2011], commuting [\cite=DeMontis2005] or face to face interactions [\cite=Barrat2013a] among others.

Applying Eq. [\eqref=eq:taylor] to the case of P(t) yields,

[formula]

being Θ(x) the Heaviside step function. Figure [\ref=fig:occnums_ks] shows the distribution of occupation numbers for existing edges and its associated standard deviation (see Eq. [\eqref=eq:poft_sigma] in the appendix) for three networks generated using power law distributed strength sequences (γ = 1.5,2.5) and different graph-average strength s̄  =  T̂ / N. We can see that the form of the resulting distribution is broad due to the imposed form of the strength sequence, and hence is not a sign per se of any interesting property of the multi-edge network being studied. Moreover, its shape strongly depends on the total number of observed events T̂.

Degrees and strengths

Having tackled the occupation number statistics of the network, in what follows we consider its node-related properties. We have that the strengths [formula] will also be Poisson distributed random variables, being sums of independent occupation numbers. Moreover, since the binary projection of occupation numbers Θ(tij) are Bernoulli distributed variables with parameter P(tij  >  0)  =  1 - e-  〈tij〉 [\cite=Sagarra2013c] one can can also compute the associated degrees ki of the nodes, which will be sums of independent Bernoulli random variables . We have that,

[formula]

which constitutes an extremely accurate prediction (see Fig. [\ref=fig:occnums_ks] lower panel). The asymptotic cases for the ensemble averages are easy to asses: For small strengths we have that [formula] which leads expression [\eqref=eq:ks] to 〈k()〉  ~   (converging to a Poisson distribution for degrees due to the properties of the Poisson Bernoulli distribution), while for large strengths one has [formula] which leads to fully connected nodes 〈k()〉  ~  N with vanishing variance.

Results comparing simulations and equation [\eqref=eq:ks] are shown in Fig. [\ref=fig:occnums_ks] (lower panel), where an interesting transition is observed for γ < 2: The degrees are exactly equal to the strengths for small values of [formula] (as expected by conservation of the edges) and evolve to a scaling of the type k()  ~  γ - 1 that finally leads to a saturation due to the bounded nature of the observables (k()  ≤  N).

The important result to take home here is that a scaling relation of the kind k(s)  ~  sβ is not always a reliable trace of correlations. More concretely, we have seen that in our framework, and for the case of power-law distributed strength sequences in particular, it is solely a consequence of the imposed constraints. In other cases, it might or might not be an indicator of correlations, but one cannot assume either case a priori: Since this metric heavilly depends on the strength sequence, it always requires comparison with a null model.

Disparity, Average neighbor properties and general metrics

In recent times, efforts have been devoted to extend well-known magnitudes on binary graphs to weighted graphs: Having appropriate null-models for multi-edge graphs permits to assess the applicability of such weighted extensions [\cite=Ahnert2007]. To this end, one can use the results of the GC ensemble to compute with high accuracy any network metric expressed in terms of tij: As an example we consider widely used magnitudes such as the disparity [formula] [\cite=Serrano2006] and weighted neighbor average strength [formula] [\cite=Barrat2004b]. Using again Eq. [\eqref=eq:taylor], and the fact that {tij} are a set of Poisson-distributed, independent random variables, one reaches after some algebra the following expressions

[formula]

where [formula]. The average values and their fluctuations are in excellent agreement with the simulations, as can be seen from Fig. [\ref=fig:corrs] panels A,B,E,F. The expressions corresponding to σ2swnn and σ2Y2, and some details on how to compute them, can be found on the Appendix.

The results show several interesting features: On the one hand, the expectation for the disparity is not Y2()  ~  k- 1i as assumed under a total random allocation of edge weights [\cite=Serrano2006], but rather decays as Y2  ~  - 1i and rapidly converges to a plateau, independent of the chosen strength distribution. The weighted average neighbor strength displays an almost flat behavior which is a correct indicator of absence of correlations at the node level. On the other hand, the fluctuations of both magnitudes decay in a power law form as the strength of the node increases: This fact can be easily understood as increased connectedness imply higher availability of sampling.

Simulations

To quantify the precision of our predictions, we computed the histograms of the relative error generated per node when calculating a given property z, [formula], where the subindices si stand for the Micro-Canonical (MC) simulations and th for the (GC) theoretical predictions in equations [\eqref=eq:y2_pred] and [\eqref=eq:swnn_pred]. The histograms in Fig. [\ref=fig:corrs] panels C,D,G,H show the accuracy of the obtained results, providing numerical evidence for the equivalence between the MC simulations and the GC predictions, which is expected in the thermodynamic limit when an infinite sampling of events T̂  →    ∞   is available. Even when this requisite is not met, the use of the theory presented here constitutes an excellent approximation as shown in Fig. [\ref=fig:scaling], where the relative error averaged over all nodes between ensemble expected GC magnitudes and simulations is shown for the different metrics considered for a wide range of values of sampling.

Conclusions

In the present letter, we have provided a theoretical framework for multi-edge networks with a fixed strength sequence that can be used to assess the impact of this structural constraint on the observables of real networks. We provide closed statistical forms for the edge and node statistics by means of a GC ensemble formalism, which coincide with great accuracy with simulations in the Micro-Canonical ensemble, for which we additionally provide the software in [\cite=Sagarra2014a].

The general results for any given strength sequence have been studied, and precise analytical closed forms of both the average expected values and fluctuations of some widely used network metrics such as the existing occupation number distribution, node degree and strength, disparity and first order neighbor correlations have been obtained. We have further used the case of power law distributed sequences as an example to show that the effect of the skewness of this distribution over some widely used network metrics can explain some of the correlations detected in real weighted complex networks.

The effects of the strength sequences are remarkable in all the metrics considered, which stresses the need for real data to be tested against appropriate null models to assess the relevance of observed properties. Interestingly, second order neighbor correlation properties such as clustering coefficients and its different weighted versions [\cite=Saramaki2007] could be similarly computed with the methodology presented, albeit they lead to more complicated expressions. We leave this to future research.

The blessing of big data may also be its dearest danger: High dimensionality data sets require sophisticated null-models to detect the effects of the system constraints on the given observables and hence comparison with a null model to assess the relevance of observed features in real data is always needed. The present application of ensemble theory to networks yielding exact results for both average values and fluctuations aims to draw attention to this problem and to close this gap for the case of multi-edge networks.

Appendix

We gather here the expressions for the standard deviation of all the metrics considered.

where E is the number of present edges and we have defined the following notation:

with [formula]. The calculations leading to these results are admitedly tedious, but follow directly from Eqs. [\eqref=eq:taylor] and [\eqref=eq:taylor2] and are of no particular difficulty beyond algebraic manipulation and carefull reordering of the sums. As an illustrative example, consider the disparity Y2(si) for node i, defined as

[formula]

Identifying [formula] and [formula], Eq. [\eqref=eq:taylor] can be readily applied. In order to approximate [formula] and σY2, we need to compute [formula] and [formula]. Let us show in full detail, as an illustrative example, how to compute [formula] in this case. First, we expand x2 as follows,

[formula]

so that when the ensemble average is taken, all products factorize (they correspond to different pairs of values ij, which are independent),

[formula]

Finally, since the variables tij are Poisson-distributed, we can compute their moments ([formula]), and using that [formula], and after some algebra, we get to

[formula]

The rest of the terms can be computed in a similar vein, leading to Finally, inserting Eqs. ([\ref=y2x2]-[\ref=y2y2]) into Eq. [\eqref=eq:taylor] and some simplification leads to the desired result, Eqs. [\eqref=eq:y2_pred] and [\eqref=eq:y2_sigma].