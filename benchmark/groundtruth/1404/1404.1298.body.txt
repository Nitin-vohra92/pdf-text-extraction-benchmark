Lemma Proposition Corollary Problem

[formula]

Density of Range Capturing Hypergraphs

Keywords: Hypergraph density, geometric hypergraph, range-capturing hypergraph, homothets, convex distance function, Delaunay graph.

Introduction

Let S and X be two subsets of the Euclidean plane [formula] and k be a positive integer. In this paper, S is a convex compact set containing the origin and X is a finite set. An S-range is a homothetic copy of S, i.e., a set obtained from S by scaling with a positive factor with respect to the origin and an arbitrary translation. In other words, an S-range is obtained from S by first contraction or dilation and then translation, where two S-ranges are contractions/dilations of one-another if in their corresponding mappings the origin is mapped to the same point.

We say that an S-range S' captures a subset Y of X if [formula]. An S-capturing hypergraph is a hypergraph H  =  (X,E) with vertex set X and edge set E  ⊆  2X such that for every Y∈E there is an S-range S' that captures E.

In this paper we consider k-uniform S-capturing hypergraphs, that is, those hypergraphs H  =  H(X,S,k) with vertex set X and hyperedge set consisting of all k-element subsets of X captured by S. I.e., the hyperedges correspond to S-ranges containing exactly k elements from X. These hypergraphs are often referred to as range-capturing hypergraphs or range spaces. The importance of studying k-uniform S-capturing hypergraphs was emphasized by their connection to epsilon nets and covering problems of the plane [\cite=PT11] [\cite=Pa86] [\cite=Mat]. See also some related literature for geometric hypergraphs, [\cite=KNPS06] [\cite=KKN04] [\cite=BuPiRo13] [\cite=wood2013hypergraph] [\cite=PaSh09] [\cite=BMP] [\cite=KP12] [\cite=FP84] [\cite=PT10] [\cite=P13] [\cite=PT10b] [\cite=CPST09] [\cite=TT07] [\cite=CKMU12] [\cite=PW90] [\cite=Smo].

The first non-trivial case k = 2, i.e., when H(X,S,k) is an ordinary graph, was first considered by Chew and Dyrsdale in 1985 [\cite=CD85]. They showed that if S is convex and compact, then H(X,S,2) is a planar graph, called the Delaunay graph of X for the convex distance function defined by S. In particular, H(X,S,2) has at most 3|X| - 6 edges and this bound can be achieved. We remark that it follows from Schnyder's realizer [\cite=S90] that every maximally planar graph can be written as H(X,S,2) for some X and S being any triangle.

Related work.

Recently, Buzaglo, Pinchasi and Rote [\cite=BuPiRo13] considered the maximum number of hyperedges of size k or less in a pseudodisc topological hypergraph on n vertices. Here, a family of pseudodiscs is a set of closed Jordan curves such that any two of these curves either do not intersect or intersect in exactly two points. A hypergraph is called pseudodisc topological hypergraph if its vertex set X is a set of points in the plane and for every hyperedge Y there is a closed Jordan curve such that the bounded region of the plane obtained by deleting the curve contains Y and no point from [formula], and the set of all these Jordan curves is a family of pseudodiscs.

The authors of [\cite=BuPiRo13] observed that pseudodisc topological hypergraphs have VC-dimension [\cite=VC] at most 3, and that using this fact the number of hyperedges can be bounded from above. For this, a version of the Perles-Sauer-Shelah theorem [\cite=Sa] [\cite=Shelah] is applied. Let, for a set A and a positive integer d, [formula] denote the set of all subsets of A of size at most d.

Let [formula] be a family of distinct subsets of [formula] and let F have VC-dimension at most d. Then [formula]

Applying this theorem to the family of hyperedges in a pseudodisc topological hypergraph, one can see that the number of hyperedges in such a hypergraph is at most O(n3). In fact, if one considers only hyperedges of size k or less, a much stronger bound could be obtained.

Every pseudodisc topological hypergraph on n vertices has O(k2n) hyperedges of size k or less.

However, the methods used to prove Theorem [\ref=thm:topological-density] do not seem to give any non-trivial bound on the number of hyperedges of size exactly k. Tight bounds are only known is case k = 2. Indeed, every 2-uniform S-capturing hypergraph is a planar graph [\cite=CD85], called the convex distance function Delaunay graph, and thus has at most 3n - 6 edges.

Our results.

In this paper, we consider the case when every hyperedge has exactly k points. In particular, we consider k-uniform S-capturing hypergraphs, for convex and compact sets S. One can show that these hypergraphs are pseudodisc topological hypergraphs. Indeed, the family of all homothetic copies of a fixed convex set S is surely the most important example of a family of pseudodiscs. For a finite point set X of the plane, a subset Y of X can be separated with a straight line if there exists a line [formula] such that one halfplane defined by [formula] contains all points in Y and the other contains all points in X  -  Y. For a positive integer i, let ai denote the number of i-subsets of X that can be separated with a straight line.

Let S be a convex compact set, X be a finite point set and k be a positive integer. Any k-uniform S-capturing hypergraph on vertex set X has at most [formula] hyperedges. Moreover, equality holds whenever S is nice and X is in general position with respect to S.

Here a set S is called nice if S has "no corners" and "no straight segments on its boundary". We define such nice shapes formally later. Moreover, X is in general position with respect to S if no three points of X are collinear and no four points of X lie on the boundary of any S-range.

Note that for k = 2 the bound in Theorem [\ref=thm:main] amounts for at most 3|X| - 3 - t edges, where t  =  a1 is the number of corners of the convex hull of X. We obtain the following refinement of Theorem [\ref=thm:topological-density].

Let S be a convex compact set and k,n be positive integers. Any S-capturing hypergraph on n vertices has at most k2n  +  O(k3) hyperedges of size k or less.

The paper is organized as follows. Section [\ref=sec:notation] provides general definitions. Here we also show how to reduce the general case of an arbitrary capturing hypergraph to one with a nice shape S and a point set X in general position with respect to S. Section [\ref=sec:types] introduces different types of ranges. The number of ranges of Type I is determined exactly in Section [\ref=sec:type-I]. Section [\ref=sec:exact-bound] gives an identity involving the number of ranges of both types in X. Finally, Theorem [\ref=thm:main] is proven in Section [\ref=sec:upper-bound].

Nice shapes, general position and next range

In this section we introduce nice shapes, the concepts of the next range and state their basic properties. For the ease of reading, the proofs of some results in this section are provided in the appendix because they are quite straightforward but also technical. We denote the boundary of a set S by ∂S. We denote the line through distinct points p and q by [formula]. A halfplane defined by a line [formula] is a connected component of the plane after the removal of [formula]. In particular, such halfplanes are open sets. A closed halfplane is the closure of a halfplane, i.e., the union of the halfplane and its defining line. Typically we denote the two halfplanes defined by a line by L and R (standing for "left" and "right").

For a set X of n points in the plane and any i∈[n] an i-set of X is a subset Y of X on i elements that can be separated with a straight line. In other words, Y is an i-set if it is captured by a closed halfplane. The number of i-sets of X is denoted by ai. Note that some (but in general not all) i-sets can be captured by a halfplane that has two points of X on its boundary. Such halfplanes are called representative halfplanes and we denote the set of all representative halfplanes of i-sets of X by Ai. Note that (even if i  ≥  2) the number of representative halfplanes for a fixed i-set might be anything, including 0.

For any set X of n points in the plane, no three on a line, and any [formula] we have ai  =  |Ai + 1|.

Let X be a finite point set with no three points in X on a line, |X|  =  n and [formula]. We shall give a bijection between the set Xi of i-sets of X and Ai + 1.

Let Y∈Xi be an i-set. Assume (by rotating the plane if needed) that Y is separated from X  -  Y by a vertical line, such that Y is contained in the corresponding right halfplane. Consider all closed halfplanes that contain all points in Y and whose interior does not contain any point in X  -  Y. Among all lines defining such halfplane let [formula] be one with smallest slope. Then [formula] contains a point p∈X  -  Y and a point q∈Y and going from p to q along [formula] we have the corresponding halfplane that contains X on the right. In particular this right halfplane of [formula] is in Ai + 1.

On the other hand, for any closed halfplane H∈Ai + 1 consider the line [formula] defining H and the two points [formula] so that going from p to q along [formula] we have H on the right. Then rotating [formula] slightly counterclockwise around any point on [formula] between p and q shows that [formula] is an i-set of X.

The above bijection shows that ai  =  |Xi|  =  |Ai + 1|, as desired.

Nice shapes and general position of a point set.

A convex compact set S is called a nice shape if

for each point in ∂S there is exactly one line that intersects S only in this point and

the boundary of S contains no non-trivial straight line segment.

For example, a disc is a nice shape, but a rectangle is not. A nice shape has no "corners" and we depict nice shapes as discs in most of the illustrations.

If S is a nice shape, S1 and S2 are distinct S-ranges, then each of the following holds.

[formula] is a set of at most two points.

If [formula] and L and R are the two open halfplanes defined by [formula], then

[formula] and [formula] or

[formula] and [formula].

Any three non-collinear points lie on the boundary of a unique S-range.

For a subset of points [formula] and any Y  ⊂  X, |Y|  ≥  2, that is captured by some S-range there exists at least one S-range S' with [formula] and [formula].

The proof of Lemma [\ref=lem:small-facts] is provided in the Appendix. We remark that only the last item of Lemma [\ref=lem:small-facts] remains true if S is convex compact but not nice. For example, if S is an axis-aligned square, then no three points with strictly monotone x- and y-coordinates lie on the boundary of any S-range, whereas three points, two of which have the same x- or y-coordinate lie on the boundary of infinitely many S-ranges.

For sets [formula] we say that X is in general position with respect to S if

no two points of X are on a vertical line,

no three points of X are collinear,

no four points of X lie on the boundary of any S-range.

For any point set X, positive integer k and a convex compact set S, there is a nice shape S' and a point set X' in general position with respect to S', such that |X'| = |X| and the number of edges in H(X',S',k) is at least as large as the number of edges in H(X,S,k).

To prove Lemma [\ref=lem:general-position], we show that one can move the points of X slightly and modify S slightly to obtain the desired property. See the Appendix for a detailed account of the argument. From now on we will always assume that S is a nice shape and X is a finite point set in general position with respect to S.

Next Range.

For two distinct points p,q in the plane, we define Spq to be the set of all S-ranges S1 with p,q∈∂S1. The symmetric difference of two sets A and B is given by [formula].

Let p,q be two points such that no four points in [formula] lie on the boundary of an S-range. Let L be a halfplane defined by [formula]. Then the following holds.

The S-ranges in Spq are linearly ordered, denoted by [formula], by inclusion of their intersection with L:

[formula]

For each S1∈Spq there exists a [formula]-minimal S2∈Spq with

[formula]

if and only if [formula] contains a point from X in its interior.

The proof of Lemma [\ref=lem:next-S-range] is provided in the Appendix.

Whenever no four points in [formula] lie on the boundary of an S-range, L is a halfplane defined by [formula] and S1∈Spq, we define [formula], called the next range of S1 in L, as follows.

If the interior of [formula] contains a point from X, then [formula] for the S-range S2∈Spq in Lemma [\ref=lem:next-S-range] [\ref=enum:next-exists].

If the interior of [formula] contains no point from X, then [formula].

Informally, we can imagine continuously transforming S1 into a new S-range containing p and q on its boundary and containing [formula] and all points of [formula]. As soon as this new S-range contains a point from [formula] on its boundary, we choose it as the next range of S1 in L. Note that if [formula] and ∂S1 contains a point from [formula], then [formula], where R denotes the other halfplane defined by [formula].

As no four points in [formula] lie on the boundary of an S-range, we have [formula] for each S1∈Spq. This implies that if S1 captures k elements of X then [formula] captures k - 1, k or k + 1 elements of X. Indeed, if [formula], then [formula] and if [formula], then the following holds.

[formula]

See Figure [\ref=fig:next-range] for the three possible case scenarios.

Representative S-ranges and Types I and II

Let X be a set in a general position and S be a nice shape. Let Y be any hyperedge in H(X,S,k). An S-range S' is a representative S-range for Y if [formula] and among all such S-ranges S' has the maximum number of points from Y on its boundary. From Lemma [\ref=lem:small-facts] [\ref=enum:two-on-boundary] it follows that each hyperedge has a representative range and if S' is a representative S-range for Y, then S' has two or three points of X on its boundary.

We say that S' is of Type I if [formula] and of Type II if [formula].

We say that Y is of Type I if it has a representative range of Type I, otherwise it is of Type II. Note that in total we have at most [formula] many Type I ranges representing a Type I hyperedge since by Lemma [\ref=lem:small-facts] [\ref=enum:unique-range] any three points of X are on the boundary of only one S-range. On the other hand, every Type II hyperedge has infinitely many representative ranges, see Figure [\ref=fig:representative-ranges]. The representative set of Y contains all representative ranges for a Type I set Y and it contains one arbitrarily chosen representative range for a Type II set Y. We denote a representative set of Y by R(Y).

We define

[formula]

All Type II representative S-ranges for the same hyperedge have the same pair of X in their boundary.

Consider a representative range S1 for a Type II hyperedge Y with [formula]. Assume for the sake of contraction that there is another representative range, S2 for Y with [formula] and {p2,q2}  ≠  {p1,q1}. We have that p2,q2∈S1, p1,q1∈S2. Assume, without loss of generality that [formula] and [formula]. Then q2∈S1  -  ∂S1 and q1∈S2  -  ∂S2.

We need to distinguish the following cases: segments p2q2 and p1q1 cross properly, p2q2 and p1q1 share a vertex, i.e., p2 = p1, and finally p1q1 is to the left of p2q2. The first case does not occur by the argument presented in the previous item. In the other two cases, let L and R be the halfplanes defined by [formula] not containing q2 and containing q2, respectively. Consider the S-range [formula], which exists by Lemma [\ref=lem:next-S-range] as S1ΔL contains q2. We see that R contains at least one point in [formula], see Figure [\ref=fig:same-boundary-pair]. Moreover, S3 must contain a point [formula] because it is a next range and Y is not of Type I. It follows that [formula], which implies that the closure of L contains two points in [formula], a contradiction to Lemma [\ref=lem:small-facts] [\ref=enum:pseudodisc].

From Lemma [\ref=lem:same-boundary-pair] and the definitions above we immediately get the following.

[formula]

For a Type I hyperedge Y, let Y'  ⊆  Y be the subset of vertices that are on the boundary of at least one representative range for Y. We define the graph G(Y)  =  (Y',EY) with vertex set Y' and edge set EY  =  {{p,q}|p,q∈∂S', ~ S'∈R(Y)}. Then G(Y) is the union of triangles, one for each representative range of Y. We call an edge of G(Y) inner edge if it is contained in at least two triangles.

For every Type I hyperedge Y the graph G(Y) is a maximally outerplanar graph. In particular, G(Y) has exactly |R(Y)| - 1 inner edges.

We shall show that G  =  G(Y) is maximally outerplanar by finding a planar embedding of G in which every vertex lies on the outer face, every inner edge lies in two triangles and every outer edge lies in one triangle. To this end draw every vertex of G at the position of its corresponding point in Y' and every edge as a straight-line segment.

First observe that every point in Y' lies on the convex hull of Y'. Hence, if G is drawn crossing-free, then every vertex of G lies on the outer face of G.

Second, assume for the sake of contraction that two edges x1y1,x2y2∈E(G) cross. Without loss of generality these four vertices appear on the convex hull of Y' in the clockwise order x1,x2,y1,y2. But then the S-ranges S1 and S2 with Y  ⊂  Si and [formula] for i = 1,2 have at least four intersections on their boundaries. See Figure [\ref=fig:outerplanar-2] for an illustration. This is a contradiction to Lemma [\ref=lem:small-facts] [\ref=enum:pseudodisc], i.e., that [formula].

Finally, for any edge xy in G we shall show that x and y are consecutive points on the convex hull of Y', or xy is contained in two triangles. Note that this proves that G is maximally outerplanar.

As xy is an edge in G, there is a representative range S1∈R(Y) with x,y∈∂S1. Let L,R be the two open halfplanes defined by [formula]. Assume without loss of generality that the third point in [formula] lies in L. We distinguish two cases.

If [formula], then x and y are consecutive on the convex hull of Y' and the edge xy is an outer edge of G. Otherwise, there exists some point [formula] and we shall show that the edge xy lies in two triangles. Let S2∈R(Y) be a representative range with t∈∂S2, which exists as t∈Y'. Also consider [formula]. By [\eqref=eq:capture-plus-1] we have Y  ⊂  S3 and [formula]. If S2  =  S3, then the edge xy lies in two triangles, one for S1 and one for S2  =  S3. Otherwise the situation is illustrated in Figure [\ref=fig:outerplanar-3]. We have x,y∈S2 and t∈S3  -  ∂S3. It follows that ∂S2 and ∂S3 intersect (at least) twice in the closure of R. By Lemma [\ref=lem:small-facts] [\ref=enum:pseudodisc],[\ref=enum:subset-halfplane], we have [formula]. Thus, [formula], which implies that [formula], i.e., S3∈R(Y) and the edge xy lies in two triangles of G, as desired.

To summarize, G is drawn crossing-free with all vertices on the outer face, and every edge of G lies on the convex hull of Y' or in two triangles. This implies that G is maximally outerplanar.

The number of Type I ranges.

Recall that for [formula] we denote by Ai the set of representative halfplanes for i-sets of X. In the next two proofs we treat representative halfplanes similarly to S-ranges. Indeed, one can think of a halfplane as a homothet of S with infinitely large dilation and at the same time infinitely large translation (however, formally this is incorrect!). In the light of Lemma [\ref=lem:next-S-range], a halfplane defined by [formula] arises as a kind of limit object of a sequences of S-ranges in Spq. Accordingly, we defined [formula] if [formula].

For k  ≥  3 we have

[formula]

For a point p∈X and a set S' that is either a Type I S-range or a representative halfplane, we say that p is the second point of S' if

[formula] and the x-coordinate of p lies strictly between the x-coordinates of q and r, or

[formula] and S' is on the right when going from p to q along [formula].

Clearly, every representative halfplane has a unique second point. Note that also every Type I S-range has a unique second point, because no two points in X have the same x-coordinate. Moreover, if p is the second point of S' and [formula] denotes the vertical line through p, then [formula] is a vertical segment (if S' is an S-range) or ray (if S' is a halfplane) with an endpoint p. We say that p is a lower, respectively upper, second point of S' if [formula] has p as its lower, respectively upper endpoint.

Now, fix p∈X and the vertical line [formula] through p. Let L and R denote the left and right open halfplanes defined by [formula], respectively. We want to show that roughly k - 2 S-ranges in Rk1 have the lower second point p. We say [formula] has property (a,b) if

S' has the lower second point p,

[formula] contains exactly a points from X, one on ∂S' if a  ≥  1, and

[formula] contains exactly b points from X.

Let m  ≥  0 be the number of points in X whose x-coordinate is smaller than the x-coordinate of p. Then for each [formula] there exists [formula] with property (a,b), so that

either a  +  b  ≤  k - 2 and Sa,p is a halfplane,

or a  +  b  =  k - 1 and Sa,p is a Type I range.

Note that for every [formula] we have S'  =  Sa,p for at most one pair (a,p) of a number [formula] and a point p∈X. The above claim states that for given (a,p) we find Sa,p, unless fewer than a points in X have smaller x-coordinate than p. This rules out [formula] of the (k - 2)|X| pairs (a,p) and we conclude that

[formula]

where [formula], respectively [formula] ([formula]), are the subsets of Type I ranges, respectively representative halfplanes, with a lower second point.

By symmetry, we obtain an analogous inequality for the Type I ranges [formula] and representative halfplanes [formula] with an upper second point. Together with [formula] and [formula] for i  ≥  2 this shows that

[formula]

In order to finish the proof of Proposition [\ref=prop:type-I] it remains to prove that [\eqref=eq:lower-middle-point] (and hence also [\eqref=eq:lower-and-upper]) holds with equality. For this, we show that for every point p∈X and every [formula] there is at most one S-range in Rk1 with property (a,b) for a + b  =  k - 1 and at most one halfplane in [formula] with property (a,b) for a  +  b  ≤  k - 2. If S1,S2∈Rk1 are two distinct S-ranges with the same lower second point p, then by Lemma [\ref=lem:small-facts] [\ref=enum:subset-halfplane] [formula] or [formula]. Observe that, if [formula] are distinct closed halfplanes with the same lower second point p, then we also have [formula] or [formula]. So in either case we may assume that [formula]. Now, if S2 has property (a,b), then [formula] and hence [formula]. Thus S1 and S2 can not both have property (a,b) for the same a.

We conclude that inequality [\eqref=eq:lower-middle-point] holds with equality. Thus [\eqref=eq:lower-and-upper] also holds with equality, which is the statement of Proposition [\ref=prop:type-I].

Relation between the number of Type I and Type II ranges.

Recall that for a fixed Type I hyperedge Y in H(X,S,k) we denote by R(Y) the set of representative ranges for Y.

For k  ≥  3 we have

[formula]

Consider the set P of all ordered pairs (S1,S2) of an S-range S1 and an S-range or representative halfplane S2, such that

[formula].

[formula] is a pair p,q of points in X.

[formula], where L is one of the halfplanes defined by [formula].

[formula].

For a pair (S1,S2)∈P we say that S2 is an image of S1 and S1 is a preimage of S2. Note that, if S2 is an image of S1, then S1 contains k points from X and thus by [\eqref=eq:capture-minus-1],[\eqref=eq:capture-plus-1] S2 contains either k or k + 1 points from X. In the former case, S1 and S2 are either distinct representative S-ranges for the same Type I hyperedge in H(X,S,k) or S2 is a halfplane, see Figure [\ref=fig:type-I-extensions], while in the latter case S2 is a Type I range in H(X,S,k + 1), see Figure [\ref=fig:type-I-extensions] and .

We partition P in two different ways; once with respect to the possibilities for preimages and once with respect to the possibilities for preimages. Firstly, [formula], where P1 and P2 contain all pairs (S1,S2) with S1∈Rk1 and S1∈Rk2, respectively. Secondly, [formula], where P3, P4 and P5 contain all pairs (S1,S2) with S2∈Rk + 11, S2∈Ak and S2∈Rk1, respectively. We summarize:

[formula]

We shall show that, on one hand, |P1| = 3|Rk1| and |P2|  =  2|Rk2|, while on the other hand, |P3|  =  3|Rk + 11|, |P4|  =  |Ak| and [formula]. Together with |P1|  +  |P2|  =  |P|  =  |P3|  +  |P4|  +  |P5| this will conclude the proof.

To prove that |P1| = 3|Rk1|, consider S1∈Rk1 and let [formula]. For i = 0,1,2 let Hi be the halfplane defined by [formula] containing pi, where indices are taken modulo 3. By [\ref=enum:boundary-points],[\ref=enum:next] and [\ref=enum:subset], every image S2 of S1 is the next S-range of S1 in Hi for some i∈{0,1,2}, whose existence and uniqueness is given by Lemma [\ref=lem:next-S-range] [\ref=enum:next-exists]. As every such next S-range contains [formula], S1 has exactly three images.

To prove that |P2|  =  2|Rk2|, consider S1∈Rk2 and let [formula]. If S2 is an image of S1, then by [\ref=enum:boundary-points],[\ref=enum:next] [formula], where H is a halfplane defined by [formula]. As [formula], the next S-range in either halfplane contains [formula], i.e., [\ref=enum:subset] is satisfied. Hence S1 has two images, one for each halfplane.

To prove that |P3|  =  3|Rk + 11|, consider any S2∈Rk + 11 and let [formula]. Let Hi and i be the halfplanes defined by [formula] containing pi and not containing pi, respectively, where indices are taken modulo 3 again. By [\ref=enum:boundary-points], [\ref=enum:next] and [\ref=enum:subset] every preimage S1 of S2 corresponds to a point pi∈{p0,p1,p2} with [formula], such that [formula]. Indeed, if [formula] captures k points from X, then (S',S2)∈P1. Whereas, if S' captures k + 1 points from X, then [formula] is a Type II hyperedge and for its representative range S'' we have (S'',S2)∈P2. Finally, S' can not capture k + 2 points since [formula]. Hence S2 has exactly three preimages.

To prove that |P4|  =  |Ak|, we need to show that every halfplane H∈Ak is the image of exactly one S-range in [formula]. In fact, if [formula] and [formula], then consider S-ranges defined by p,q and a third point from Y. By Lemma [\ref=lem:small-facts] these S-ranges are well-defined and by Lemma [\ref=lem:next-S-range] they are linearly ordered by inclusion in H. For the S-range S' with [formula] being inclusion-maximal we have (S',H)∈P4, as desired.

Finally, we prove that [formula]. Consider any hyperedge Y∈Ek1 and the graph G(Y) defined above, whose edges are all pairs {p,q}  ⊆  Y such that p,q∈∂S' for a representative S-range S'∈R(Y)  ⊂  Rk1. By Lemma [\ref=lem:outerplanar-graph], connecting any two points in Y that are adjacent in G(Y) with a straight line segment gives a maximally outerplanar drawing of G(Y). Now if (S1,S2)∈P5, then [formula] is an inner edge of G(Y), see Figure [\ref=fig:same-hyperedge]. Moreover, exactly two S-ranges in R(Y) have p and q on their boundary, because S-ranges in R(Y) correspond to triangles in G(Y) and G(Y) is maximally outerplanar.

Thus, every pair (S1,S2)∈P5 with S2∈Rk1 gives rise to an inner edge of G(Y) and every inner edge {p,q} of G(Y) gives exactly two such ordered pairs in P5. Because a maximally outerplanar graph with |R(Y)| triangles has |R(Y)| - 1 inner edges, we have the desired equality.

Now we conclude that |P|  =  |P1| + |P2|  =  3|Rk1|  +  2|Rk2|, whereas [formula]. Together this gives the claimed equality.

Proof of Theorem [\ref=thm:main].

For k  =  1 and any X, the hypergraph H(X,S,k) clearly has [formula] hyperedges. For k  =  2 and any X, H(X,S,k) is the well-known Delaunay triangulation DS with respect to the convex distance function defined by S. In particular, every inner face of DS is a triangle and the outer face is the convex hull of X, i.e., has length a1. Thus, by Euler's formula the number of hyperedges of H(X,S,2) (edges of DS) is given by [formula]. So we may assume that k  ≥  3. Moreover, by Lemma [\ref=lem:general-position] we may assume that S is nice and X is in general position with respect to S.

By Proposition [\ref=prop:extensions] we have

[formula]

By Proposition [\ref=prop:type-I] we have

[formula]

Putting [\eqref=eq:clearly-1], [\eqref=eq:clearly-2], [\eqref=eq:extensions], [\eqref=eq:typeI-UB] and [\eqref=eq:typeI-LB] together, we conclude that

[formula]

Thus we have with Lemma [\ref=lem:halfplanes] that [formula], as desired.

Conclusions and remarks

In this paper we investigated k-uniform hypergraphs whose vertex set X is a set of points in the plane and whose hyperedges are exactly those k-subsets of X that can be captured by a homothetic copy of a fixed convex compact set S. These are so called k-uniform S-capturing hypergraphs. We have shown that every such hypergraph has at most [formula] hyperedges and that this is tight for every nice shape S. Here ai denotes the number of i-subsets of X that can be separated with a straight line.

As an immediate corollary we obtain that if S is nice, then the total number of subsets of X captured by some homothet of S is given by the cake number [formula]. Moreover, we obtain a bound on the number of hyperedges of size at most k: For every point set X, every convex set S and every k  ≥  1 at most k2|X| different non-empty subsets of X of size at most k can be captured by a homothetic copy of S. This refines the recent O(k2|X|) bound by Buzaglo, Pinchasi and Rote [\cite=BuPiRo13].

Another interesting open problem concerns topological hypergraphs defined by a family of pseudodiscs. Here, the vertex set X is again a finite point set in the plane and every hyperedge is a subset of X surrounded by a closed Jordan curve such that any two such curves have at most two points in common. Buzaglo, Pinchasi and Rote [\cite=BuPiRo13] prove that every pseudodisc topological hypergraph has at most O(k2|X|) hyperedges of size at most k.

What is the maximum number of hyperedges of size exactly k in a pseudodisc topological hypergraph?

As we learned after submission, Chevallier et al. [\cite=CFSS14] [\cite=CFSS15] have an unpublished manuscript in which they prove that every inclusion-maximal k-uniform convex pseudodisc topological hypergraph with n vertices has exactly [formula] hyperedges. This independent result implies our Theorem [\ref=thm:main]. However, their proof is 40 pages long and involves higher-order Voronoi diagrams and higher-order centroid Delaunay triangulations. Our proof uses a completely different technique; it is short and completely self-contained, and hence is of independent interest.

Acknowledgments

We would like to thank Günter Rote and János Pach for helpful remarks and referring us first to [\cite=BuPiRo13] and later on to [\cite=CFSS14].

Appendix

For a set S, we call a line [formula] touching S if [formula] intersects S in exactly one point. So, S is nice if and only if for each point on its boundary there is exactly one touching line touching S at this point.

If S is a nice shape, S1 and S2 are distinct S-ranges, then each of the following holds.

[formula] is a set of at most two points.

If [formula] and L and R are the two open halfplanes defined by [formula], then

[formula] and [formula] or

[formula] and [formula].

Any three non-collinear points lie on the boundary of a unique S-range.

For a subset of points [formula] and any Y  ⊂  X, |Y|  ≥  2, that is captured by some S-range there exists at least one S-range S' with [formula] and [formula].

We show that for any two S-ranges S1, S2 such that [formula], for distinct p,q,r, S1 coincides with S2. Assume not, and consider homothetic maps f1, f2 from S1, S2 to S, respectively. Let pi,qi,ri be the images of p,q,r under fi, i = 1,2. Then we have that p1,q1,r1 and p2,q2,r2 form congruent triangles T1, T2 with vertices on ∂S. If these two triangles coincide, then S1 = S2. Otherwise consider two cases: a corner of one triangle is contained in the interior of the other triangle or not. If, without loss of generality, a corner of T1 is in the interior of T2, then by convexity, this corner can not be on ∂S. Otherwise, T1 and T2 are either disjoint or share a point on the corresponding side. In either case, one of the sides of T1 is on the same line as the corresponding side of T2, otherwise convexity of S is violated. Then, the boundary of S contains 3 collinear points, a contradiction to the fact that S is a nice shape.

We have, without loss of generality that [formula]. If [formula], we are done. Otherwise, we have that [formula], and, in particular S1  ⊆  S2. Note that at p and q the S-ranges S1 and S2 have the same touching lines. Indeed, these lines are unique since S is nice. Consider maps f1 and f2 as before. We see that p,q are mapped into the same pair of points under both maps. Thus S1  =  S2, a contradiction.

The remaining two items can be proven by considering two points p,q in the plane and the set Spq of all S-ranges S' with p,q∈∂S'. Indeed, given fixed p and q there is a bijection φ between the S-ranges in S(p,q) and the set [formula] of lines whose intersection with S is a non-trivial line segment parallel to the line [formula]. We refer to Figure [\ref=fig:lines-to-ranges] for an illustration.

We verify that this bijection exists: For a line [formula] such that [formula], let S' be an S-range obtained by contracting and translating S such that p1 and q1 are mapped into p and q, respectively. Let [formula]. Given an S'-range with p,q∈∂S, consider a translation and contraction that maps S' to S. Let p1 and q1 be the images of p and q under this transform, then let [formula], where [formula] is a line through p1 and q1. See again Figure [\ref=fig:lines-to-ranges] for an illustration.

Consider any three non-collinear points p,q,r in the plane. We shall first show that there is an S-range with p,q,r on its boundary. Let S1 be an S-range of smallest area containing all three points. Clearly, [formula] is either 2 or 3. In the latter case we are done. So assume without loss of generality that [formula].

Now, we claim that there is another S-range S2 that contains p and q but not r, with p,q∈∂S2. To find S2, containing p,q on its boundary and not containing r, consider the triangle p,q,r and a line [formula] that goes through q having p and r on the different sides. Assume without loss of generality that q is the lowest point among p,q,r, and that [formula] and [formula] have positive slopes. Next, let q2 be a point on ∂S whose touching line is parallel to [formula] and such that S is above this touching line. See Figure [\ref=fig:small-facts-1]. Let [formula] be the line parallel to [formula] and containing q2 and let p2 be the unique point in [formula] different from q2. Note that [formula] follows from the fact that S is a nice shape and [formula] and [formula] have different slopes. Let [formula]. We see that S2 is above [formula], but r is below [formula]. So, r∉S2.

Since φ is continuous and any two lines in [formula] can be continuously transformed into each other within [formula], we conclude that S1 can be continuously transformed into S2 within Spq. Thus, there is an S-range S'∈Spq such that r∈∂S'. This proves that any three non-collinear points p,q,r lie on the boundary of some S-range. The uniqueness of such a range follows from [\ref=enum:pseudodisc].

Let Y be a hyperedge in H(X,S,k) and S1 be an S-range capturing Y. Contract S1 until the resulting range S2 contains at least one point, p of Y, on its boundary. If [formula], we are done. Otherwise, consider a small S-range S3 containing p on its boundary and not containing any other points of X. Let q be the second point in [formula]. Similarly to the previous argumentation, S2 can be continuously transformed into S3 within Spq. Each intermediate S-range is contained in [formula] and thus contains no points of [formula]. One of the intermediate S-ranges will contain another point of Y on its boundary.

For any point set X, positive integer k and a convex compact set S, there is a nice shape S' and a point set X' in general position with respect to S', such that |X'| = |X| and the number of edges in H(X',S',k) is at least as large as the number of edges in H(X,S,k).

First, we shall modify S slightly. Consider all hyperedges of H(X,S,k) and for each of them choose a single capturing S-range. Recall that two S-ranges are contraction/dilation of one-another if in their corresponding homothetic maps the origin is mapped to the same point. For each hyperedge consider two distinct capturing S-ranges S1,S2 with S2 being a dilation of S1. Among all hyperedges, consider the one for which these two S-ranges, S1  ⊂  S2 are such that the stretching factor between S1 and S2 is the smallest.

Let S' be a nice shape, S1  ⊂  S'  ⊂  S2. Replace each of the other capturing ranges with an appropriate S'-range. Now, we have that H(X,S',k) has at least at many hyperedges as H(X,S,k). Next, we shall move the points from X slightly so that the new set X' is in a general position with respect to S' and contains as many hyperedges as H(X,S',k).

Observe first that since X is a finite point set, we can move each point of X by some small distance, call it ε in any direction such that the resulting hypergraph has the same set of hyperedges as H(X,S',k).

Call a point x∈X bad if either x is on a vertical line together with some other point of X, x is on a line with two other points of X, or x is on the boundary of an S'-range together with at least three other vertices of X.

We shall move a bad x such that a new point set has smaller number of bad points and such that the resulting hypergraph has at least as many edges as H(X,S',k). From a ball B(x,ε) delete all vertical lines passing through a point of X, delete all lines that pass through at least two points of X and delete all boundaries of all S'-ranges containing at least 3 points of X. All together we have deleted at most [formula], where n  =  |X|, curves because there is one vertical line passing through each point, at most [formula] lines passing through some two points of X and at most [formula] S'-ranges having some three points of X on their boundary. So, there are points left in B(x,ε) after this deletion. Replace x with an available point x' in B(x,ε). Observe that x' is no longer bad in a new set [formula]. Moreover, if z∈X, z  ≠  x was not a bad point, it is not a bad point in a new set [formula]. Indeed, since x' is not on a vertical line with any other point of X and not on any line containing two points of X, z is not on a bad line with x'. Moreover, since x' is not on the boundary of an S'-range together with at least three other points of X, z can not be together with x' on the boundary of an S'-range containing more than 3 points of X on its boundary.

Let p,q be two points such that no four points in [formula] lie on the boundary of an S-range. Let L be a halfplane defined by [formula]. Then the following holds.

The S-ranges in Spq are linearly ordered, denoted by [formula], by inclusion of their intersection with L:

[formula]

For each S1∈Spq there exists a [formula]-minimal S2∈Spq with

[formula]

if and only if [formula] contains a point from X in its interior.

This follows immediately from Lemma [\ref=lem:small-facts] [\ref=enum:subset-halfplane].

First assume that [formula]. For each point [formula] consider the S-range Sr with {p,q,r}  ⊂  ∂Sr. The existence and uniqueness of Sr is given by Lemma [\ref=lem:small-facts] [\ref=enum:unique-range]. By the first item, the S-ranges in [formula] are linearly ordered by inclusion of their intersection with L. Hence there exists an S-range S2 in this set, which is [formula]-minimal.

Let r be the point in ∂S2 different from p and q. If r∈L, then r∉S1 and thus [formula]. If r∉L, then [formula] and thus [formula], where R is the other halfplane defined by [formula]. In any case we have [formula]. Moreover, [formula] and hence S2 is the desired S-range.

Now assume that S2 is a [formula]-minimal S-range in Spq with [formula] and [formula]. We claim that the point r in [formula] lies in the interior of [formula]. If r∈R, then r∈S1, because [formula]. On the other hand, if r∈L, then r∉S1, because [formula]. Hence r lies in the interior of [formula], as desired.