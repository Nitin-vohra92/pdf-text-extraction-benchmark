Theorem Lemma Corollary Observation

Theta-3 is connected

Sang Won Bae

Luis Barba

Prosenjit Bose Matias Korman

André van Renssen Perouz Taslakian

Sander Verdonschot

Introduction

Introduced independently by Clarkson [\cite=clarkson1987approximation] in 1987 and Keil [\cite=keil1988approximating] in 1988, the θ-graph of a set P of points in the plane is constructed as follows. We consider each point p∈P and partition the plane into m  ≥  2 cones (regions in the plane between two rays originating from the same point) with apex p, each defined by two rays at consecutive multiples of 2π / m radians from the negative y-axis; see Figure [\ref=fig:Construction_of_Theta_3] for an illustration. We label the cones C0 through Cm - 1, in clockwise order around p, starting from the cone whose angular bisector aligns with the positive y-axis from p if m is odd, or having this axis as its left boundary if m is even. If the apex is not clear from the context, we use Cpi to denote the cone Ci with apex p. We sometimes refer to Cpi as the i-cone of p. To build the θ-graph, we consider each point p and connect it by an edge with the closest point in each of its cones. However, instead of using the Euclidean distance, we measure distance by orthogonally projecting each point onto the angle-bisector of that cone. The closest point to p in its i-cone is then the point in Cpi whose projection has the smallest Euclidean distance to p.

We use this definition of distance in the remainder of the paper, except for Section [\ref=sec:Yao], which deals with Yao graphs. For simplicity, we assume that no two points of P lie on a line parallel to the boundary of a cone or perpendicular to the angular bisector of a cone, guaranteeing that each point connects to at most one point in each cone. We call the θ-graph with m cones the θm-graph.

For θ-graphs with an even number of cones, proving connectedness is easy. As the first m / 2 cones cover exactly the right half-plane, each point will have an edge to a point to its right, if such a point exists. Thus, we can find a path from any point to the rightmost point and, by concatenating these, a path between every pair of points. Unfortunately, if m is odd this property does not hold, as no set of cones covers exactly the right half-plane. Therefore, a point is not guaranteed to have an edge to a point to its right, even if such a point exists.

The fact that θ-graphs with more than 6 cones are connected has been known for a long time. In fact, they even guarantee the existence of a short path between every pair of points. The length of this path is bounded by a constant times the straight-line Euclidean distance between the two points [\cite=bose2012optimal] [\cite=bose2013spanning] [\cite=clarkson1987approximation] [\cite=keil1988approximating] [\cite=ruppert1991approximating]. Graphs that have this property are called geometric spanners. For more information on geometric spanners, see the book by Narasimhan and Smid [\cite=NS06].

For a long time, very little was known about θ-graphs with fewer than 7 cones. Bonichon et al. [\cite=bonichon2010connections] broke ground in this area in 2010, by showing that the θ6-graph is a geometric spanner. Subsequently, both the θ4- and θ5-graphs have been shown to be geometric spanners [\cite=barba2013stretch] [\cite=bose2013theta5]. El Molla [\cite=el2009yao] already showed that the θ2- and θ3-graphs are not geometric spanners. It is straightforward to verify that the θ2-graph is connected which leaves the θ3-graph as the only θ-graph for which connectedness has not been proven. In this paper, we settle this question by showing that the θ3-graph is always connected.

The question of connectedness about the θ3-graph is interesting because the θ3-graph has some unique properties that cause standard proof techniques for θ-graphs to fail. As such, we hope that the techniques we develop here will lead to more insight into the structure of other θ-graphs. As an example, most proofs for a larger number of cones show that the θ-routing algorithm (always follow the edge to the closest vertex in the cone that contains the destination) returns a short path between any two points. But in the θ3-graph, θ-routing is not guaranteed to ever reach the destination. The smallest point set that exhibits this behavior has three points, such that for each point, both other points lie in the same cone; see Figure [\ref=fig:notstrong]. In fact, this example shows not only that this exact routing strategy fails; it shows that if we consider the edges to be directed (from the point that added them, to the closest point in its cone), the graph is not strongly connected. Therefore, our proof requires more global methods than previous proofs on θ-graphs.

Most proofs for a larger number of cones use induction on the distance between points or on the size of the empty triangle between a point and its closest point. In the θ3-graph however, both of these measures can increase when we follow an edge. Thus, applying induction on these distances seems a difficult task. An induction on the number of points similarly fails, as inserting a new point may remove edges that were present before, and it is not obvious that the endpoints of those edges are still connected in the new graph.

The θ3-graph is strongly related to the -graph, where each point also connects to the closest point in each cone, but the distance measure is the standard Euclidean distance. This graph was shown to be connected by Damian and Kumbhar [\cite=damian2011undirected]. Their proof uses induction on a rhomboid distance-measure that was tailored specifically for the -graph. Since the 'closest' point for the θ3-graph can be much further away than in the -graph, this method of induction does not translate to the θ3-graph, either. Conversely, we show that our proof extends to the -graph, providing an alternative proof for its connectivity.

Properties of the [formula]-graph

For i∈{0,1,2}, the edge connecting a point with its closest point in cone Ci is called an i-edge. Note that an edge can have one or two roles depending on the position of its endpoints. An example is depicted in Figure [\ref=fig:notstrong], where edge ab is both the 0-edge of a and the 1-edge of b.

For all i∈{0,1,2}, no two i-edges of the θ3-graph can cross.

We consider only 0-edges of P; the proof is analogous for 1- and 2-edges. For a contradiction, assume that there are two 0-edges that cross at a point s. Call these edges u1v1 and u2v2, such that v1 is in the 0-cone of u1 and v2 in the 0-cone of u2. Assume without loss of generality that the y-coordinate of v1 is smaller than that of v2; see Figure [\ref=fig:Edges_cannot_cross] for an illustration. Because s lies on segments u1v1 and u2v2, s lies in the 0-cones of both u1 and u2. Therefore, the 0-cone of s is contained in the intersection of the 0-cones of u1 and u2. As v1 lies in cone C0 of s, point v1 lies in cone C0 of u2 as well. Because we assumed that the y-coordinate of v1 is less than that of v2, we conclude that v1 is closer to u2 than v2. Thus, the edge u2v2 is not a 0-edge, yielding a contradiction.

We say that a cone is empty if it contains no point of P in its interior. A point having an empty i-cone is called an i-sink.

Given a point p of P, the i-path from p is defined recursively as follows: If the i-cone of p is empty, the i-path from p consists of the single point p. Otherwise, let q be the closest point to p in its i-cone. The i-path from p is defined as the union of edge pq with the i-path from q.

Every i-path of the θ3-graph is well-defined and has an i-sink at one of its endpoints.

We consider only 0-paths; the proof is analogous for the other paths. A 0-path from a point p is well defined because the closest point in the 0-cone of p always lies above p. Therefore, the y-coordinates of the points in the 0-path from p form a monotonically increasing sequence. As P is a finite set, the recursion must end at a point having an empty 0-cone.

If a cone of a point is empty, then no edge of the θ3-graph can cross this cone.

We consider only 0-cones for this proof; analogous arguments hold for the other cones. Let u be a point of P with an empty 0-cone. For a contradiction, assume that there exists an edge xy that crosses Cu0. For this to happen, x and y have to lie in opposite sectors of the double wedge obtained by extending the boundary segments of Cu0; see Figure [\ref=fig:Empty_Cones_Cannot_be_crossed]. Assume without loss of generality that x lies in the left wedge. Then x lies in Cu2 while y lies in Cu1. In particular, this implies that both u and y lie in Cx1.

Let [formula] be the line through u perpendicular to the bisector of Cx1. For the edge xy to exist, the projection of y on the bisector of Cx1 must be closer to x than the projection of u. In other words, y must lie to the left of [formula]. However, all points lying to the left of [formula] are contained in [formula], yielding a contradiction as y∈Cu1.

As a consequence of Lemmas [\ref=lemma:Planar] and [\ref=lemma:Empty_cones_cannot_be_crossed], two sinks connected by an i-path partition the remaining points into two sets such that no i-path can connect a point in one set to a point in the other set, as any such path would cross either the i-path between the sinks, or the empty cone of one of the sinks. Such a construction is called an i-barrier; see Figure [\ref=fig:Barriers] for an illustration.

Proving connectedness

In this section we prove that the θ3-graph of any given point set is connected. We start by proving that three given 0-sinks in a specific configuration are always connected. We then prove that if the θ3-graph has at least two disjoint connected components, there exist three 0-sinks that are in this configuration and are not all in the same component, leading to a contradiction. Although the edges of the θ3-graph are not directed, by Lemma [\ref=lemma:Forest] we can think of an i-path as oriented towards the i-sink it reaches. An i-path from a that ends at an i-sink b is denoted by [formula]. The following lemma is depicted in Figure [\ref=fig:Zero_Sink_configuration].

Let a, b, and c be three 0-sinks such that (i) a lies to the left of b and b lies to the left of c, and (ii) the 1-path from a ends at a 1-sink a' whose 0-path ends at c (a' may be equal to c). Then, a, b, and c belong to the same connected component.

Because there is a path from a to c via a', a and c must be in the same component. We show that b belongs to this same connected component.

The proof proceeds by induction on the number of 0-sinks to the right of c. In the base case, there are no 0-sinks to the right of c. Consider the 1-sink b' at the end of the 1-path from b; see Figure [\ref=fig:Zero_Sink_configuration] (right). Because the 1-path [formula] forms a 1-barrier, b' cannot lie to the left of a'.

If a'  =  c, then a' is both a 1-sink and a 0-sink. This means that there can be no points to the right of a'. Therefore b' must also be equal to a'. But then b is in the same connected component as a and we are done. So assume that this is not the case, that is, a'  ≠  c and b' lies to the right of a'.

Then the 1-path [formula] also has to cross the 0-path [formula], as otherwise [formula] crosses the empty cone of b', which is impossible by Lemma [\ref=lemma:Empty_cones_cannot_be_crossed], or b' lies on [formula] and we are done. Moreover, because [formula] forms a 0-barrier, the 0-path from b' cannot end to the left of c. However, since there are no 0-sinks to the right of c, the 0-path from b' must end at c. Thus, there is a path connecting b and c, which proves the lemma in the base case.

For the inductive step, let k be the number of 0-sinks to the right of c and assume that the lemma holds for any triple of 0-sinks with fewer than k 0-sinks to their right. By the same argument as in the base case, we have a 1-path from b to a 1-sink b' that lies to the right of a'. Now consider the 0-sink d at the end of the 0-path from b'; see Figure [\ref=fig:ZeroSink_Inductive_step]. Note that b' and d could be the same vertex.

Since the 0-path [formula] forms a 0-barrier, d cannot lie to the left of c. If d and c are the same point, we have a path connecting b and c as in the base case, so assume that this is not the case. Thus d lies to the right of c. Now b, c, and d form a triple of 0-sinks that satisfy criteria (i) and (ii). And since d is a 0-sink to the right of c, there are fewer than k 0-sinks to the right of d. Thus, by induction, we have that b is in the same connected component as c, which proves the lemma.

The θ3-graph is connected.

Assume for a contradiction that there exists a point set P whose θ3-graph G is not connected. From each point, we can follow its 0-path to a 0-sink. Therefore, G must contain at least one 0-sink for each connected component. Let a be the leftmost 0-sink, and let A be the connected component of G that contains a. Now let b be the leftmost 0-sink that does not belong to A.

We use Lemma [\ref=lemma:0-sink_configuration] to show that, in fact, b must belong to A as well. Before we can do this, we need to define two barriers. The first barrier is formed by the 2-path from b, ending at a 2-sink b'. Because a lies in Cb2, point b does not have an empty 2-cone and hence, b' differs from b. The second barrier is formed by the 0-path from b', which ends at a 0-sink c; see Figure [\ref=fig:Connectedness]. Since b is the leftmost 0-sink that does not belong to A, either c and b are the same point, or c lies to the right of b.

Now consider the 1-sink a' at the end of the 1-path from a. This point has to lie to the right of both barriers [formula] and [formula], as otherwise these paths would cross the empty cone C1 of a', which is not allowed by Lemma [\ref=lemma:Empty_cones_cannot_be_crossed]. Because the path [formula] is a 1-path and the barriers in question consist of 0- and 2-edges, these crossings are possible. Now let d be the 0-sink at the end of the 0-path from a'. Since this path cannot cross the 0-barrier [formula], d cannot lie to the left of c.

Because d belongs to component A, if c and d are the same point, c belongs to component A. Otherwise, if c and d are distinct points, then a, b, and d jointly satisfy the criteria of Lemma [\ref=lemma:0-sink_configuration], which gives us that b belongs to component A as well--a contradiction since b is the leftmost 0-sink that does not belong to A. This contradiction comes from our assumption that G is not connected. Therefore, the θ3-graph of any point set is connected.

The [formula]-graph

The construction of the -graph is very similar to that of the θ3-graph. The only difference is the way distance is measured: the θ-graph uses the length of the projection onto the bisector, whereas the Yao graph uses the Euclidean distance. Therefore, in every cone a point is connected to its closest Euclidean neighbor. We denote by |pq| the Euclidean distance between two points p and q.

We show that, like the θ3-graph, the -graph is connected. To this end, we re-introduce the three basic lemmas we had for the θ3-graph and show that the same properties hold for the -graph. We first prove a geometric auxiliary lemma depicted in Figure [\ref=fig:Yao3Aux].

Given a non-vertical line b and a circle C centered at a point u on b, let v and z be two points on C such that b bisects the segment vz. Let x be a point on b and let D be the circle centered at x with radius |xv|. If x lies to the left of u, then the right-side arc of D between v and z is enclosed by C; otherwise, the left-side arc of D between v and z is enclosed by C.

Assume that x lies to the left of u; the proof of the other case is analogous. Let r and r' be the respective right intersections of C and D with line b; see Figure [\ref=fig:Yao3Aux]. Hence, arcs vr' and r'z lie either entirely inside C or entirely outside C. Therefore, it suffices to show that r' lies inside C, i.e., |ur'|  ≤  |ur|. Since x lies to the left of u, we can rewrite |ur'| as |xr'|  -  |xu|. Since |xr'|  =  |xv| and |ur|  =  |uv|, we thus need to show that |xv|  ≤  |xu|  +  |uv|. This follows from the triangle inequality.

The proof of the following lemma is similar to that of Lemma [\ref=lemma:Planar].

For all i∈{0,1,2}, no two i-edges of the -graph can cross.

We look at the 0-edges. The cases for the other edges are analogous. Let uv be a 0-edge such that v∈Cu0 and assume without loss of generality that v lies to the right of u. We prove the lemma by contradiction, so assume that some 0-edge xy crosses uv and let y∈Cx0. Note that for xy to cross uv, Cx0 must contain some part of uv. Hence v lies in Cx0.

Let k be the line through the right boundary of Cu0 and let l be the line through u, perpendicular to k. We consider four cases, depending on the location of x with respect to u; see Figure [\ref=fig:Yao3PlanarForestsA] (left): (a) x∈Cu0 to the left of the line uv, (b) x∈Cu2 above k, (c) x∈Cu2 below k or x∈Cu1 below l, (d) x∈Cu1 above l or x∈Cu0 to the right of the line uv.

Case (a): x∈Cu0 to the left of the line uv. Since v lies inside Cx0 and v lies to the right of u, x lies in the circle centered at u having radius |uv|. Thus, x lies closer to u than v, contradicting the existence of edge uv.

Case (b): x∈Cu2 above k. We apply Lemma [\ref=lemma:Yao3Aux] as follows, see Figure [\ref=fig:Yao3PlanarForestsA] (right): Let C be the circle centered at u having radius |uv|. Let b be the line through u and x, and let z be the reflection of v in b. Note that this implies that z lies outside Cu0. Let D be the circle centered at x having radius |xv|. Since x lies to the left of u, Lemma [\ref=lemma:Yao3Aux] gives us that the right arc vz of circle D is enclosed by circle C. Since the area in which y must lie for xy to cross uv is bounded by the right boundary of Cx0, edge uv, and the right arc vz of circle D, it is enclosed by C. Therefore, any such point would lie in Cu0 and be closer to u than v, contradicting the existence of edge uv.

Case (c): x∈Cu2 below k or x∈Cu1 below l; see Figure [\ref=fig:Yao3PlanarForestsB] (left). Since u lies in Cx0, y needs to be closer to x than u for edge xy to exist. Hence it must lie inside the circle C centered at x with radius |xu|. Look at the lower half-plane defined by the line tangent to C at u and note that C is contained in this half-plane. However, the half-plane does not intersect Cu0 to the right of u and hence no point y inside the half-plane can be used to form an edge xy that crosses uv.

Case (d): x∈Cu1 above l or x∈Cu0 to the right of the line uv. We apply Lemma [\ref=lemma:Yao3Aux] as follows, see Figure [\ref=fig:Yao3PlanarForestsB] (right): Let C be the circle centered at u having radius |uv|. Let b be the line through u and x, and let z be the reflection of v in b. Note that z lies outside Cx0. Let D be the circle centered at x having radius |xv|. Since x lies to the right of u, Lemma [\ref=lemma:Yao3Aux] gives us that the left arc vz of circle D is enclosed by circle C. Since the area in which y must lie for xy to cross uv is bounded by edge uv, the left arc vz of circle D, and either the left boundary of Cx0 (if u∉Cx0) or the line ux (if u∈Cx0), it is enclosed by C. Therefore, there does not exist a point y∈Cx0 such that xy intersects uv.

Every i-path of the -graph is well-defined and has an i-sink as one of its endpoints.

The proof of this lemma is analogous to Lemma [\ref=lemma:Forest] for the θ3-graph.

If a cone of a point is empty, then no edge in the -graph can cross this cone.

We assume without loss of generality that Cu0 does not contain any points. We prove the lemma by contradiction, so assume that there exists an edge xy that crosses Cu0. Since no edge between two points in the same cone can cross another cone, let x∈Cu2 and y∈Cu1.

Point y cannot lie in Cx0, since either Cx0 does not intersect Cu1 (if u∉Cx0) or the line segment between x and y does not intersect Cu0 (if u∈Cx0). Hence y must lie in Cx1.

If u∈Cx0, Cx1 does not intersect Cu0 and thus the line segment between x and y cannot intersect Cu0 either. Therefore both u and y lie in Cx1. Let C be the circle centered at x with radius |xu|. For the edge xy to exist, y must be closer to x than u, which means that y must lie in C. Note that C is contained in the half-plane to the left of the tangent to C at u.

If x lies on or above the horizontal line through u, the half-plane does not intersect Cu1. If x lies below the horizontal line through u, the half-plane does not intersect Cu1 above u and thus xy would not cross Cu0. Since y is enclosed by C, C is contained in the half-plane, and there is no point p in the half-plane such that p∈Cu1 and px crosses Cu0, xy cannot cross Cu0 either.

Using Lemmas [\ref=lemma:Yao3Planar], [\ref=lemma:Yao3Forest] and [\ref=lemma:Yao3Empty], the proof of Theorem [\ref=thm:Theta_3_is_connected] translates directly to the -graph yielding the following result.

The -graph is connected.

Acknowledgments.

This problem was introduced during the 2012 Fields Workshop on Discrete and Computational Geometry held at Carleton University in Ottawa, Canada. The research of Oswin Aichholzer was partially supported by the ESF EUROCORES programme EuroGIGA - CRP 'ComPoSe', Austrian Science Fund (FWF): I648-N18. Work by Sang Won Bae was supported by the Contents Convergence Software Research Center funded by the GRRC Program of Gyeonggi Province, South Korea. The research of Luis Barba, Prosenjit Bose, André van Renssen, and Sander Verdonschot was supported in part by NSERC. Matias Korman received support from the Secretary for Universities and Research of the Ministry of Economy and Knowledge of the Government of Catalonia, the European Union, and projects MINECO MTM2012-30951, Gen. Cat. DGR2009SGR1040, ESF EUROCORES programme EuroGIGA - CRP 'ComPoSe': MICINN Project EUI-EURC-2011-4306.