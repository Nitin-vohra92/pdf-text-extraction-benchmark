A new look at the trailing zeroes of N!

AMS 2000 Mathematics Subject Classification

Introduction

It is a usual exercise in Elementary Number Theory to compute the number of trailing zeroes in the base 10 expansion of the factorial of any integer. In fact, given any base b and any integer n, it is easy to compute the number of trailing zeroes of the base b expansion of n!. Namely, if we denote such number by Zb(n), we have.

[formula], where σp(n) is the sum of the digits of the base p expansion of n.

[formula] for every r  ≥  1.

If [formula], then [formula].

It is also easy to see that the function [formula] is non-decreasing and not surjective. Thus, there exist integers n such that Zb(n + 1) > Zb(n). In this situation we will say that Zb has a "jump" at n.

The previous lemma suggests the organization of the paper. The first section will be devoted to the prime case, the simplest one. We will characterize the points where Zp "jumps" and compute the amplitude of those "jumps". As an application we will give some families of integers not lying in the image of Zp and will study, in some sense, the density of  Zp. In the second section we will turn to the prime power case, where the results of the first section will be crucial. Lemma 1(3) shows that no further work is needed.

The prime case

During this section p will be a prime. Given an integer n, let [formula] and [formula] be the base p expansions of n and n + 1 respectively. Also, let us define tn,p  =   min {j | aj < p - 1}. In other words, [formula] and atn,p < p - 1, being careful if tn - p = 0. If there is no risk of ambiguity we will just write t instead of tn,p.

In the following lemma, the relation between the digits of n in base p and tose of n + 1 is studied. The proof is elementary and we omit.

[formula]

As a direct consequence we have the following proposition, which will be useful in the sequel.

σp(n + 1) - σp(n) = 1 - (p - 1)tn,p.

Zp(n + 1) - Zp(n) = tn,p.

Part (1) follows directly from Lemma 2, while part (2) is a consequence of (1) together with Lemma 1(1).

In the next result we characterize the points where Zp has a jump and we compute their amplitudes.

Zp(n + 1)  ≠  Zp(n) if and only if p divides n + 1. Moreover, Zp(n + 1) - Zp(n) = m if and only if n + 1 = pma with (p,a) = 1.

It is enough to proof the second assertion. We will apply Proposition 1(2). Observe that t = m if and only if [formula] which happens if and only if [formula]. This latter assertion is clearly equivalent to the fact that pm the greatest power of p dividing n + 1, and the proof is complete.

Now, as an application of Proposition 2, we will give some families of integers not lying in  Zp. A first partial, but nevertheless interesting, result in this direction is the following.

The prime p does not lie in  Zp; i.e., there is no [formula] such that the base p expansion of m! ends with p zeroes.

By Lemma 1(1), Zp(p2) = p + 1. Now, by Proposition 2, Zp(p2 - 1) = p - 1 and the monotony of Zp completes the proof.

In order to give a more general result in the style of the previous corollary, we will first need the following lemma which is a consequence of Lemma 1(1).

[formula].

The following families of integers do not belong to  Zp:

[formula].

[formula].

Apply the previous Lemma with l = 1 and pk - 1 respectively, together with the monotony of Zp.

Now we will study the density of  Zp. Given [formula], let us define Ap(N) = {n  ≤  N | n∈Zp} and put ap(N) = card(Ap(N)). In the following proposition we study the asymptotic behavior of [formula].

[formula]

Put N = pk - 1 and observe that N  →    ∞   if and only if k  →    ∞  . We have that Zp((p - 1)pk) = N and, due to Proposition 2, until (p - 1)pk they will take place p - 1 "jumps" with amplitudes [formula]. Consequently, [formula] and

[formula]

as desired.

The prime power case

During this section p will be a prime and r  ≥  2 will be an integer. Recall that [formula], this fact will be crucial during this section.

Let [formula] and put Zp(n) = αr + β. Then, Zpr(n + 1) = Zpr(n) if and only if n + 1 = pma with (p,a) = 1 and 0  ≤  m < r - β.

Let us suppose that n + 1 = pma with (p,a) = 1 and 0  ≤  m < r - β. Then, by Proposition 2, we have that Zp(n + 1) = Zp(n) + m. Thus, [formula].

Conversely, assume that Zpr(n + 1) = Zpr(n). For some m  ≥  0 it must be Zp(n + 1) = Zp(n) + m and thus, [formula]. From this, it follows that [formula]. So 0  ≤  β + m < r and it is enough to recall Proposition 2 again to complete the proof.

Now we will refine the previous result in order to compute the amplitude of the "jumps". It is interesting to compare the following result with Proposition 2.

Let [formula] and put Zp(n) = αr + β. Then, Zpr(n + 1) - Zpr(n) = k if and only if n + 1 = pma with (p,a) = 1 and kr  ≤  m + β < (k + 1)r.

Let us suppose that Zpr(n + 1) - Zpr(n) = k. In such case, Zp(n + 1) = Zp(n) + m for some m  ≥  0 and [formula].

Conversely, if n + 1 = pma with (p,a) = 1 and kr  ≤  m + β < (k + 1)r, due to Proposition 2 we have that Zp(n + 1) = Zp(n) + m, and consequently [formula].

The rest of the section will be devoted to present families of integers not lying in Zpr for various p and r.

Let p be a prime and r  ≥  2 be an integer such that r divides [formula] for some k > 1. Then, [formula] for every 1  ≤  h < k.

We have, p, k and r being like in the statement; that [formula]. Again, the monotony of Zpr completes the proof.

The previous result can be slightly reformulated if either r = 2 or p = 2.

Let p be an odd prime and let k > 1 be an integer. Then, for every 1  ≤  h < k, [formula].

It is enough to observe that [formula] is even and apply the previous proposition.

Let q be an odd prime. Then, for every 1  ≤  h < q - 1, 2q(q - 1) - 1 - h∉Z2q.

By Fermat's little theorem q divides 2q(q - 1) - 1, so we can take k = q - 1 in Proposition 7 with p = 2 and r = q.

We will conclude the section and the paper with a new result in the style of the previous ones.

Let p be a prime, r  ≥  2 an integer and l < p a multiple of r. Then, for every k > 1 and 1  ≤  h < k, [formula]

It is clear that [formula], while Zpr(lpkr - 1) = Zpr(lpkr) - k so it is enough to apply again the monotony of Zpr.