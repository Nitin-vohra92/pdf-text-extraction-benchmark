=1

Hierarchical image simplification and segmentation based on Mumford-Shah-salient level line selection

Introduction

In natural images, meaningful contours are usually smooth and well-contrasted. Many authors (e.g., [\cite=caselles.99.ijcv] [\cite=cao.05.jmiv]) claim that significant contours of objects in images coincide with segments of the image level lines. The level lines are the boundaries of the connected components described by the tree of shapes proposed in [\cite=monasse.00.itip], and also known as topographic map in [\cite=caselles.99.ijcv]. Image simplification or segmentation can then be obtained by selecting meaningful level lines in that tree. This subject has been investigated in the past by [\cite=pardo.02.icip] [\cite=cao.05.jmiv] [\cite=cardelino.06.icip]. In [\cite=lu.07.itip], the authors have proposed a tree simplification method for image simplification purpose based on the binary partition tree.

Classically, finding relevant contours is often tackled using an energy-based approach. It involves minimizing a two-term-based energy functional of the form Eλs  =  λsC  +  D, where C is the regularization term controlling the regularity of contours, D is a data fidelity term, and λs is a parameter. A popular example is the seminal work of [\cite=mumford.89.cpam]. Curve evolution methods are usually used to solve this minimization problem. They have solid theoretical foundations, yet they are often computational expensive.

Current trends in image simplification and segmentation are to find a multiscale representation of the image rather than a unique partition. There exist many works about hierarchical segmentations such as the geodesic saliency of watershed contours proposed in [\cite=najman.96.pami] and gpb-owt-ucm proposed by [\cite=arbelaez.11.pami] and references therein. Some authors propose to minimize a two-term-based energy functional subordinated to a given input hierarchy of segmentations, in order to find an optimal hierarchical image segmentations in the sense of energy minimization. Examples are the works of [\cite=guigues.06.ijcv] [\cite=kiran.14.pr]. Yet, the choice or the construction of the input hierarchy of segmentations for these methods is an interesting problem in itself. [\cite=perret.15.ismm] compared different choices of morphological hierarchies for supervised segmentation.

In this paper we propose a novel hierarchical image simplification and segmentation based on minimization of an energy functional (e.g., the piecewise-constant Mumford-shah functional). The minimization is performed subordinated to the shape space given by the tree of shapes, a unique and equivalent image representation. The basis of our proposal was exposed in our previous study in [\cite=xu.13.icip], in which we proposed an efficient greedy algorithm computing a meaningfully locally optimal solution of the energy minimization problem. The basic idea is to take into account the meaningfulness of the set of level lines so that we very quickly get a "good" (in the sense of getting a well-simplified image while preserving the salient structures) locally optimal solution. The current paper extends this idea to hierarchical simplification and segmentation. More precisely, following the same principle but without fixing the parameter λs in the two-term-based energy, we compute an attribute function that characterizes the persistence of each shape under the energy minimization. Then we compute a saliency map, a single image presenting the complete hierarchical simplifications or segmentations. To do so, we rely on the idea of hierarchy transformation via extinction value proposed by [\cite=vachier.95.nlsp] and on the framework of tree-based shape space introduced in [\cite=xu.14.filter]. This scheme of hierarchy transformation has been first used in [\cite=xu.13.ismm] for a different input hierarchy and attribute function. Related algorithms were presented in [\cite=xu.15.ismm]. The present paper extends on these ideas, focusing on the computation of an attribute function related to energy minimization.

Note that although the tree of shapes (see Section [\ref=subsec:tos]) is also a hierarchical image representation, it is very different from a hierarchy of segmentations (see Section [\ref=subsec:hos]). Each cut of the tree of shapes is a subset of the image domain, while each cut of the later one forms a partition of the image domain (see [\cite=ronse.14.jmiv]). This basic difference prohibits the direct use of the classical works of finding optimal hierarchical segmentations by energy minimization to the tree of shapes. In this sense, our approach can be seen as an extension of the scale-set theory proposed in [\cite=guigues.06.ijcv] to the tree of shapes.

The main contributions of this current paper are: 1) A novel hierarchical image simplification and segmentation method based on energy minimization subordinated to the tree of shapes; This extends the scale-set theory proposed by [\cite=guigues.06.ijcv] to the tree of shapes. Note that the current work is quite different from our previous work in [\cite=xu.13.ismm] in terms of input hierarchy and attribute function. In [\cite=xu.13.ismm], the input hierarchy is a hierarchy of segmentations, and the attribute, inspired by [\cite=felzenszwalb.04.ijcv], is a local measure of the interest of merging two regions. 2) A detailed discussion of the method compared with some related works. 3) Some illustrations of the proposed method on color images, as well as a quantitative evaluation of the method on a public segmentation dataset. Note that our proposal is a general framework. We have tested it with a very simple segmentation model in this paper. Despite its simplicity, we obtain results that are competitive with the ones of some state-of-the-art methods on the classical segmentation dataset from [\cite=alpert.12.pami]. In particular, they are on par with Gpb-owt-ucm proposed in [\cite=arbelaez.11.pami].

The rest of this paper is organized as follows: Some background information is provided in Section [\ref=sec:background]. Section [\ref=sec:method] is dedicated to depict the proposed method, followed by some illustrations and experimental results in Section [\ref=sec:illustration]. Section [\ref=sec:relatedwork] compares the proposed method with some similar works. We then conclude in Section [\ref=sec:conclusion].

Background

The Tree of shapes

For any [formula], the upper level sets [formula] and lower level sets [formula] of an image [formula] are respectively defined by [formula] and [formula] Both upper and lower level sets have a natural inclusion structure: [formula] which leads to two distinct and dual representations of an image, the Max-tree and the Min-tree.

Another tree has been introduced in [\cite=monasse.00.itip] via the notion of shapes. A shape is defined as a connected component of an upper or lower level set where its holes have been filled in. Thanks to the inclusion relationship of both kinds of level sets, the set of shapes gives a unique tree, called tree of shapes. This tree is a self-dual, non-redundant, and complete representation of an image. It is equivalent to the input image in the sense that the image can be reconstructed from the tree. And it is invariant to affine contrast changes. Such a tree also inherently embeds a morphological scale-space (the parent of a node/shape is a larger shape). An example on a synthetic image is depicted in Fig. [\ref=fig:tree]. Recently, an extension of the tree of shapes for color images has been proposed by [\cite=carlinet.15.itip] through the inclusion relationship between the shapes of its three grayscale channels.

Hierarchy of image segmentations or saliency maps

A hierarchy of image segmentation H is a multiscale representation that consists of a set of nesting partitions from fine to coarse: [formula] where Pn is the partition {Ω} of Ω into a single region, and P0 represents the finest partition of the image f. [formula] implies that the partition Pj is finer than Pk, which means [formula] such that R  ⊆  R'.

As a multiscale representation, a hierarchy of segmentation satisfies the most fundamental principle for multiscale analysis: the causality principle presented by [\cite=koenderink.84.bc]. From this principle, for any couple of scales λs2  >  λs1, the "structures" found at scale λs2 should find a "cause" at scale λs1. In the case of a hierarchy of segmentation, following the work of [\cite=guigues.06.ijcv], the causality principle is applied to the edges associated to the set of partitions spanned by H: for any pair of scales λs2  >  λs1, the boundaries of partition Pλs2 are in a one-to-one mapping with a subset of the boundaries of Pλs1 (their "cause"). The pair (H,λs) is called an indexed hierarchy.

A useful representation of hierarchical image segmentations was originally introduced in [\cite=najman.96.pami] under the name of saliency map. A saliency map is obtained by stacking a family of hierarchical contours. This representation was then rediscovered independently by [\cite=guigues.06.ijcv] through the notion of scale-set theory for visualization purposes, and it is then popularized by [\cite=arbelaez.11.pami] under the name of ultrametric contour map for boundary extraction and comparing hierarchies. It has been proved theoretically in [\cite=najman.11.jmiv] that a hierarchy of segmentations is equivalent to a saliency map. Roughly speaking, for a given indexed hierarchy (H,λ), the corresponding saliency map can be obtained by weighing each contour of the image domain with the highest value λs such that it appears in the boundaries of some partition represented by the hierarchy H. The low level (resp. upper level) of a hierarchy corresponds to weak (resp. strong) contours, and thus an over-segmentation (resp. under-segmentation) can be obtained by thresholding the saliency map with low (resp. high) value.

From shape-space filtering to hierarchy of segmentations

The three morphological trees reviewed in Section [\ref=subsec:tos] and the hierarchies of segmentations reviewed in Section [\ref=subsec:hos] have a tree structure. Each representation is composed of a set of connected components [formula]. Any two different elements [formula] are either disjoint or nested: [formula]. This property leads to the definition of tree-based shape space in [\cite=xu.14.filter]: a graph representation [formula], where each node of the graph represents a connected component in the tree, and the edges [formula] are given by the inclusion relationship between connected components in [formula]. In [\cite=xu.14.filter], we have proposed to filter this shape space by applying some classical operators, notably connected operators on [formula]. We have shown that this shape-space filtering encompasses some classical connected operators, and introduces two families of novel connected operators: shape-based lower/upper leveling and shaping.

Energy-based simplification and segmentation

There exist several works of hierarchical image segmentations based on energy minimization (see [\cite=guigues.06.ijcv] and [\cite=kiran.14.pr]). A general formulation of these methods involves minimizing a two term-based energy functional of the form Eλs  =  λsC  +  D. C is a regularization term, D is data fidelity term, and λs is a parameter. Let [formula] be a partition of the image domain. If the energy functional can be written by [formula], then Eλs is called an affine separable energy functional. Furthermore, if either the regularization term C decreases or the data fidelity term D increases, the energy Eλs is multiscale affine separable. A popular instance of such an energy functional that we will use as an example through this paper is the piecewise-constant Mumford-Shah functional proposed by [\cite=mumford.89.cpam]. For an image f, it is given by

[formula]

where [formula] inside each region [formula], [formula] is the set of contour, and |  ·  | denotes the cardinality.

Hierarchical image simplification and segmentation via level line selection

Main idea

The current proposal extends the method of image simplification by selecting salient level lines based on Mumford-Shah energy functional minimization, which has been presented in a preliminary version of this study in [\cite=xu.13.icip]. We review this non-hierarchical version in Section [\ref=subsec:llselection], using a more general multiscale affine separable energy. It has been shown in [\cite=xu.13.icip] that the non-hierarchical version of the proposed method belongs to the class of morphological shapings in the framework of shape-space filtering. In this current paper, we compute for each level line an attribute function related to the energy's regularization parameter λs, and use the idea of hierarchy transformation based on extinction values and on a tree-based shape space to achieve hierarchical image simplification and segmentation. This is detailed in Section [\ref=subsec:hslls]. Section [\ref=subsec:algorithm] provide algorithms for the whole process.

Image simplification by salient level line selection

For a given tree of shapes [formula] composed of a set of shapes {τi}, any two successive shapes of [formula] are related by an edge reflecting the inclusion relationship, also known as the parenthood between nodes of the tree. This tree structure [formula] provides an associated partition of the image [formula], where [formula] with [formula] representing all the children of the shape τ. We denote by [formula] the energy functional (see Section [\ref=subsec:mumford]) subordinated to the tree by considering its associated partition [formula]. This energy minimization is given by:

[formula]

where [formula] is a simplified version of [formula] by removing some shapes from [formula] and by updating the parenthood relationship.

The basic operation of the energy minimization problem given by Eq. [\eqref=eq:solution] is to remove the contours of some shapes {τ} included in their corresponding parents {τp}, which triggers the update of [formula] for each shape τ. The parent of its children [formula] should also be updated to the τp. Fig. [\ref=fig:merging] shows an example of a such merging operation.

Observe that the minimization problem of Eq. ([\ref=eq:solution]) is a combinatorial optimization. The computation of the optimum has an exponential complexity. Hence a greedy algorithm is usually applied to compute a local optimum instead of a global optimum (see also [\cite=ballester.07.jmiv]). It iteratively removes the shapes to decrease the energy functional. The greedy algorithm stops when no other shape can be removed that favors a decrease of the energy. The removability of a shape τ is decided by the sign of the energy variation ΔEτλs while τ is suppressed. For the multiscale affine separable energy described in Section [\ref=subsec:mumford], ΔEτλs is given by:

[formula]

Taking the piecewise-constant Mumford-Shah functional given by Eq. [\eqref=eq:simplemumford] as an energy example, and let S(f,Ri) be the sum of value of all the pixels inside Ri, Then the functional variation ΔEτλs is given by:

[formula]

If ΔEτλs is negative, which means the suppression of τ decreases the functional, then we remove τ. According to Eq. [\eqref=eq:variation], the removability of a shape τ depends only on Rτ and Rτp. As the suppression of the shape τ triggers the update of Rτp, the removal of τ impacts also the removability of its parent, its children and siblings. So the order of level line removal is critical. In [\cite=xu.13.icip], we proposed to fix the order by sorting the level lines in increasing order of a quantitative meaningfulness attribute [formula] (e.g., average of gradient's magnitude along the level line [formula]).

Meaningful contours in natural images are usually well-contrasted and smooth. Indeed, the minimization of energy functional in Eq ([\ref=eq:simplemumford]) favors the removal of level lines having small contrast (by data fidelity term) or being complex (by regularization term). So the shapes having small (resp. great) meaningfulness attribute [formula] are easier (resp. more difficult) to filter out under the energy minimization process of Eq. [\eqref=eq:solution]. Consequently, the level line sorting based on meaningfulness attribute [formula] provides a reasonable order to perform the level lines suppression that makes the energy functional decrease. Indeed, initially, each region Rτ has only several pixels. At the beginning, many "meaningless" regions are removed, which forms more proper regions in Eq. [\eqref=eq:variation] for the "meaningful" regions. The removal decisions for these "meaningful" regions based on the sign of Eq. [\eqref=eq:variation] are more robust.

Hierarchical salient level line selection

The parameter λs, in the multiscale affine separable energy, controls the simplification/segmentation degree for the method described in Section [\ref=subsec:llselection], which is however not hierarchical. Because some level line τ may be removed with a parameter λs1, but preserved for a bigger λs2  >  λs1. This contradicts the causality principle for hierarchical image simplification/segmentation described in Section [\ref=subsec:hos]. An example is given in Fig. [\ref=fig:causality]. Note that the simplification algorithm of [\cite=ballester.07.jmiv] is not hierarchical either.

Instead of fixing the parameter λs in the energy functional (e.g., λs in Eq ([\ref=eq:simplemumford])), we propose to compute an individual λs for each shape of the tree following the same principle of the energy minimization. For a given λs, the removability of a shape τ is based on the sign of energy variation ΔEτλs in Eq. [\eqref=eq:variation], which is a linear decreasing function w.r.t. λs (e.g., the Eq ([\ref=eq:variationmumford]) for the piecewise-constant Mumford-Shah functional). When λs is bigger than some value λsmin, ΔEτλs will be negative, which implies the removal of this shape decreases the energy functional. Thus λsmin is a value of the transition for the removal decision of the underlying shape. Let us denote this value of transition as the attribute function [formula], which is given by:

[formula]

For the piecewise-constant energy functional in Eq. [\eqref=eq:simplemumford], it is given by:

[formula]

Note that for a given shape τ, the attribute function [formula] defined in Eq ([\ref=eq:lambda]) depends on Rτ and Rτp, which means [formula] is decided by the shape τ itself, its parent, its siblings, and its children. Because the attribute function [formula] is computed under the hypothesis that the shape τ under scrutiny is suppressed, we also need to update Rτp, and update the parenthood relationship for its children to its parent. These update operations will also affect the computation of [formula] for the parent, children and siblings of τ. So the computation order is again important. We follow the same principle as described in Section [\ref=subsec:llselection] to compute [formula], which is detailed as below:

step 1: Compute [formula] for each shape [formula] supposing that only the shape under scrutiny is removed, and sort the set of shapes [formula] in increasing order of shape meaningfulness indicated by an attribute [formula] (e.g., [formula]).

step 2: Propagate the sorted shapes in increasing order, and remove the shape one by one. Compute the new value [formula] for the underlying shape τ, and update it if the value is greater than the older one. Update also the parenthood relationship and the corresponding information for Rτp.

This attribute function [formula] is related to the minimization of the energy functional. It measures the persistence of a shape to be removed under the minimization problem of Eq ([\ref=eq:solution]). A bigger [formula] means that it is more difficult to remove the shape τ. Thus the attribute function [formula] is also some kind of quantitative meaningfulness deduced from the energy minimization.

This saliency map ME represents hierarchical result of level line selections. Each thresholding of this map ME selects salient (of certain degree) level lines from which a simplified image can be reconstructed.

Implementation

The proposed method is composed of four main steps: 1) Construction of tree of shapes; 2) Computation of attribute function [formula]; 3) Computation of extinction values [formula]; 4) Computation of saliency map [formula].

For the tree construction, we use an immersion algorithm based on the union-find process proposed by [\cite=tarjan.75.jacm]. The algorithm starts by sorting the pixels in root-to-leaf order. Then a union-find process propagates the pixels in leaf-to-root order to construct the tree, followed by a second propagation in root-to-leaf order to canonize the tree. For further details, we refer the reader to [\cite=najman.06.itip] [\cite=berger.07.icip] [\cite=carlinet.14.itip]. During the tree construction, some useful information [formula] for computing the attribute function [formula] can be updated incrementally: 1) Information accumulated on region, such as the area A and the sum of gray levels Sf; 2) Information accumulated on contour, such as the contour length L and the sum of gradient's magnitude along the contour [formula]. Note that the computation of information on contour relies on the use of Khalimsky's grid proposed by [\cite=khalimsky.90.tia]. A region boundary is composed of a set of elements materialized by 1-faces and 0-faces that lie between pixels (2-faces). An example is depicted in Fig. [\ref=fig:interpolation]. We refer the reader to [\cite=xu.15.ismm] for more details about these efficient information computations.

Once we have the tree structure [formula] represented by the parenthood image parent, and the corresponding information [formula] (e.g., A, Sf, L, and [formula]) for each node of the tree, we are able to compute the attribute function [formula]. The computation of this attribute function [formula] is detailed in Algorithm [\ref=algo:attribute]. We start by computing the initial values of attribute [formula] according to Eq [\eqref=eq:lambdamumford] by considering that only the underlying shape is removed (see line 11). Then we sort the shapes by increasing order of the average of gradient's magnitude along the shape contour [formula]. We process the shapes in this order. For each underlying shape τ, we compute a new value according to Eq [\eqref=eq:lambdamumford] (see line 15), and update the value [formula] if the new value is greater. Then we remove the shape τ from the tree and update the tree structure as well as the corresponding information.

The third step is to compute the extinction values [formula] for the local minima of the tree-based shape space weighted by the attribute [formula]. This is achieved thanks to a Min-tree representation [formula] constructed on the tree-based shape space. The algorithm is described in Algorithm [\ref=algo:extinction]. The image original_ min  tracks the smallest local minimum inside a lower level connected component CC of the tree-based shape space. For each local minimum shape τ, the lowest CC that contains τ and a smaller minimum is the lowest ancestor node whose smallest local minimum shape is different from τ.

To compute the final saliency map [formula] based on the extinction value, we weigh the boundaries (composed of 1-faces and 0-faces in the Khalimsky's grid) of each shape by the corresponding extinction value [formula]. More precisely, we weigh each 1-face e (resp. 0-face o) by the maximal extinction value of the shapes whose boundaries contain e (resp. o). The algorithm is given in Algorithm [\ref=algo:saliency]. It relies on two images [formula] and [formula] defined on the 1-faces that are computed during the tree construction. The value [formula] encodes the smallest region Na in the tree whose boundary contains the 1-face e, while [formula] denotes the smallest region Nv that contains the 1-face e inside it.

Illustrations and experiments

In this section, we illustrate our proposed general framework with a simple segmentation model: piecewise-constant Mumford-Shah model. Using some more evolved energy functional will be one of our future work. For generic natural images, contours of significant objects usually coincide with segments of level lines. Our proposed method yields a hierarchical simplification rather than a hierarchical segmentation. So only qualitative illustrations are depicted in Section [\ref=subsec:hierarchy] for some images taken from the BSDS500 dataset introduced in [\cite=arbelaez.11.pami]. For the Weizmann segmentation database proposed by [\cite=alpert.12.pami], the objects' contours coincide with almost full level lines. Our method provides a hierarchical segmentation. Quantitative results using the associated evaluation framework are depicted in Section [\ref=subsec:segmentation].

Hierarchical color image pre-segmentation

In Fig. [\ref=fig:simpcolor], we test our method on color images in the segmentation evaluation database proposed in [\cite=alpert.12.pami]. Each image contains two objects to be segmented. We use the color tree of shapes proposed by [\cite=carlinet.15.itip] A high parameter value λs  =  8000 is used, and the grain filter proposed in [\cite=monasse.00.itip] is applied to get rid of too tiny shapes (e.g., smaller than 10 pixels). Less than 100 level lines are selected, which results in a ratio of level line selection around 1157. These selected level lines form less than 200 regions in each image. The simplified images illustrated in Fig. [\ref=fig:simpcolor] are obtained by taking the average color inside each region, where the boundaries between salient regions remain intact. Finding an actual segmentation becomes a lot easier with such a pre-segmentation. The extinction-based saliency maps [formula] using the attribute [formula] are depicted on the bottom of this figure. They represent hierarchical pre-segmentations.

Some illustrations of the extinction-based saliency map [formula] applied on images in the dataset of BSDS500 [\cite=arbelaez.11.pami] are also shown in Fig. [\ref=fig:hierarchicalsimplify]. Again, the input image f is a color image, and the color tree of shapes is used. As shown in Fig. [\ref=fig:hierarchicalsimplify], meaningful level lines are highlighted in [formula] employing the attribute [formula]. Hierarchical image simplification results can then be obtained by thresholding [formula]. The saliency maps for all the images in the dataset of BSDS500 is available on .

We have also tested our method on some cellular images, where the method is applied on the color input image f. As illustrated in Fig. [\ref=fig:cellular], the cellular image is strongly simplified, which almost leads to a uniform background. Finding an actual cellular segmentation result would become much easier.

Evaluation in context of segmentation

We have also evaluated our hierarchical image simplifications in context of segmentation on Weizmann segmentation evaluation database in [\cite=alpert.12.pami]. For the 100 images containing 2 objects in this database (See Fig. [\ref=fig:simpcolor] for several examples), the saliency maps are thresholded with a fixed thresholding value to yield a partition result. And we filter out the regions whose area is less than 100 pixels. Note that, in order to perform a fair comparison with the state-of-the art, the saliency maps are constructed using grayscale tree of shapes computed by [\cite=geraud.13.ismm]. We performed two tests as presented in [\cite=alpert.12.pami]

In the first test, for each foreground object, we select the segment that fits it the best based on F-measure score. The results of this single segment coverage test is depicted in Table [\ref=tab:singlesegment] (See  [\cite=alpert.12.pami] for implementation details on the settings for the other methods). In this test, our method achieves F-measure score on par with the state-of-the-art methods, especially when replacing, in the attribute [formula], the classical grayscale gradient with the (learned) gradient computed (on the grayscale input image f) by [\cite=dollar.15.pami] (see "Our2"). By using another gradient, we change the order in which the nodes of the tree are processed; thus this result highlights the importance of the sorting step in our algorithm. In Table [\ref=tab:singlesegment], note that Gpb-owt-ucm without texture denotes the method of Gpb-owt-ucm computed without taking into account the texture information in the Gpb part. More precisely, in this case, the Gpb is computed using only brightness and color gradients. Note also that our method does not explicitely use any texture information either.

In the second test, a combination of segments whose area overlaps considerably the foreground objects is utilized to assess the performance. For each union of segments, we measure the F-measure score and the number of segments composing it. This test is a compromise between good F-measure and low number of fragments. The results of this fragmentation test is given in Table [\ref=tab:multisegment]. In this test the averaged F-measure of different methods is fairly similar. However, our method, as a pre-segmentation method without using any texture information has a relatively high number of fragments.

The saliency maps for these images containing two objects in the Weizmann dataset is available on .

Comparison with similar works

The tree of shapes has been widely used in connected operators, filtering tools that act by merging flat zones for image simplification and segmentation. The simplification and segmentation relies on relevant shapes extraction (i.e., salient level lines), usually achieved by tree filtering based on some attribute function. A detailed review of tree filtering strategies can be found in [\cite=salembier.09.spm]. In all these strategies, the attribute function [formula] characterizing each node plays a very important role in connected filtering. The classical connected operators make filtering decisions based only on attribute function itself or the inclusion relationship of the tree (e.g., [\cite=xu.14.filter]). They are usually performed by removing the nodes whose attributes are lower than a given threshold. The method we propose in this paper combines this idea of classical connected operators with the energy minimization problem of Eq ([\ref=eq:solution]). It also makes use of the spatial information of the original image from which the tree is constructed. This might give more robust filtering decision.

In this paper, we focus particularly on hierarchical relevant shapes selection by minimizing some multiscale affine separable energy functional (e.g., piecewise-constant Mumford-Shah functional). The closely related work is the one in [\cite=guigues.06.ijcv], where the authors proposed the scale-set theory, including an efficient greedy algorithm to minimize this kind of energy on a hierarchy of segmentations. More precisely, the authors use dynamic programming to efficiently compute two scale parameters λ+s and λ-s for each region R of the input hierarchy H, where λ+s (resp., λ-s) corresponds to the smallest parameter λs such that the region R∈H belongs (resp.. does not belong) to the optimal solution of segmentation by minimizing Eλs, we have [formula]. There may exist some regions R such that λ-s(R)  ≤  λ+s(R), which implies that the region R∈H does not belong to any optimal cut of H by minimizing the energy Eλs. One removes these regions from the hierarchy H and updates the parenthood relationship which yields a hierarchy H', a hierarchy of global optimal segmentations on the input hierarchy. This work has been continued and extended by [\cite=kiran.14.pr]. These methods work on an input hierarchy of segmentations, which is very different from the tree of shapes (a natural and equivalent image representation). In this sense, our method can be seen as the extension of scale-set theory to the tree of shapes.

Another related work is the one in [\cite=ballester.07.jmiv]. It also selects meaningful level lines for image simplification and segmentation by minimizing the piecewise-constant Mumford-Shah functional. For this method, at each step the level line is selected which inflicts the largest decrease of functional. As a consequence, the iterative process of [\cite=ballester.07.jmiv] requires not only computing a lot of information to be able to update the functional after each level line suppression, but also to find at each step, among all remaining level lines, the one candidate to the next removal. Consequently, the optimization process has a [formula] time complexity w.r.t. the number of nodes [formula] of the tree. A heap-based implementation may improve the time complexity, but since at each removal, one has to update the corresponding energy variation for its children, parent, siblings, maintaining the heap structure is a costly process. In practice, the gain using heap-based implementation is relatively insignificant. Hence [\cite=ballester.07.jmiv] is computationally expensive. We propose to fix that issue thanks to a reasonable ordering of level lines based on their quantitative meaningfulness measurement [formula]. The time complexity of our optimization process is linear w.r.t. the number of nodes [formula]. We have implemented the method of [\cite=ballester.07.jmiv] using the same tree construction algorithm and the same data structure based on heap. We have compared the running time on 7 classic images on a regular PC station. The comparison is detailed in Table. [\ref=tab:comparison]. Our proposal is significantly faster than that of [\cite=ballester.07.jmiv]. Our approach is almost linear w.r.t. the number of nodes in the tree. Yet, the method of [\cite=ballester.07.jmiv] seems to depend also on the depth of the tree. In [\cite=ballester.07.jmiv], the authors proposed applying the simplification scheme successively with a set of augmenting parameters λs so that to construct the input hierarchy. Then they employed the scheme of scale-set theory proposed by [\cite=guigues.06.ijcv] on the obtained hierarchy to achieve a final hierarchy of optimal segmentations. In our case, rather than using a fixed parameter λs or a set of fixed parameters, we propose to assign a measure related to λs to each shape as an attribute function. Then we use the hierarchy transformation (reviewed in Section [\ref=subsec:ssf]) based on extinction values and on a tree-based shape space to compute a hierarchical salient level lines selection.

Conclusion

In this paper, we have presented an efficient approach of hierarchical image simplification and segmentation based on minimizing some multiscale separable energy functional on the tree of shapes, a unique and equivalent image representation. It relies on the idea of hierarchy transformation based on extinction values and on a tree-based shape space to compute a saliency map representing the final hierarchical image simplification and segmentation. The salient structures in images are highlighted in this saliency map. A simplified image with preservation of salient structures can be obtained by thresholding the saliency map. Some qualitative illustrations and quantitative evaluation in context of image segmentation on a public segmentation dataset demonstrate the efficiency of the proposed method. A binary executable of the proposed approach is available on .

In the future, we would like to explore some applications employing a strongly simplified image as pre-processing step. We believe that this could be useful for analyzing high-resolution satellite images and images with texts, where the contours of meaningful objects in images usually coincide with full level lines. Besides, as advocated in Table [\ref=tab:singlesegment] for Gpb-owt-ucm, the texture provides important information for image segmentation. An interesting perspective is to incorporate texture information in our proposed framework. Since the tree of shapes is a natural representation of the input image, a possible way to integrate texture information might consist in replacing the original image with a new grayscale image incorporating texture features. Although this is not directly appicable to our case, probability map incorporating region features, such as proposed in [\cite=bai2009geodesic], are worth exploring. Computing the tree of shapes of such probability maps has already been proved valuable (see  [\cite=dubrovina.14.icip]). In another direction, it would be interesting to investigate some other energy functionals for some specific tasks. Examples are the rate distortion optimization used in image or video compression coding system (see [\cite=salembier.00.itip] [\cite=ballester.07.jmiv]) and the energy based on spectral unmixing used for hyperspectral image segmentation in [\cite=veganzones.14.itip]. The energy functionals in these works are affine separable, which straightforwardly allows to use them in our proposed framework. Last, but not the least, given that using a learned gradient improves the results, a major research avenue is to combine our approach with learning techniques.