On the k-regularity of the k-adic valuation of Lucas sequences

Lemma

=0

Introduction

For integers k  ≥  2 and n  ≠  0, let νk(n) denotes the greatest nonnegative integer e such that ke divides n. In particular, if k  =  p is a prime number then νp(  ·  ) is the usual p-adic valuation. We shall refer to νk(  ·  ) as the k-adic valuation, although, strictly speaking, for composite k this is not a "valuation" in the algebraic sense of the term, since it is not true that νk(mn)  =  νk(m)  +  νk(n) for all integers m,n  ≠  0.

Valuations of sequences with combinatorial meanings have been studied by several authors (see, e.g., [\cite=AMM08] [\cite=Coh99] [\cite=HZZ12] [\cite=Len95] [\cite=Len14] [\cite=ML14] [\cite=PS07] [\cite=San16bis] [\cite=San16] [\cite=SM09]). To this end, an important role is played by the family of k-regular sequences, which were first introduced and studied by Allouche and Shallit [\cite=AS92] [\cite=AS03b] [\cite=AS03] with the aim of generalizing the concept of automatic sequences.

Given a sequence of integers s(n)n  ≥  0, its k-kernel is defined as the set of subsequences Then s(n)n  ≥  0 is said to be k-regular if the [formula]-module 〈 ker k(s(n)n  ≥  0)〉 generated by its k-kernel is finitely generated. In such a case, the rank of s(n)n  ≥  0 is the rank of this [formula]-module.

Allouche and Shallit provided many examples of regular sequences. In particular, they showed that the sequence of p-adic valuations of factorials νp(n!)n  ≥  0 is p-regular [\cite=AS92], and that the sequence of 3-adic valuations of sums of central binomial coefficients is 3-regular [\cite=AS92]. Furthermore, for any polynomial [formula] with no roots in the natural numbers, Bell [\cite=Bell07] proved that the sequence νp(f(n))n  ≥  0 is p-regular if and only if f(x) factors as a product of linear polynomials in [formula] times a polynomial with no root in the p-adic integers.

Fix two integers a and b, and let (un)n  ≥  0 be the Lucas sequence of characteristic polynomial f(x)  =  x2  -  ax  -  b, i.e., (un)n  ≥  0 is the integral sequence satisfying u0  =  0, u1  =  1, and un  +  2  =  aun  +  1  +  bun, for each integer n  ≥  0. Assume also that (un)n  ≥  0 is nondegenerate, i.e., b  ≠  0 and the ratio α  /  β of the two roots [formula] of f(x) is not a root of unity.

Using p-adic analysis, Shu and Yao [\cite=SY11] proved the following result.

For each prime number p, the sequence νp(un + 1)n  ≥  0 is p-regular.

In the special case a  =  b  =  1, i.e., when (un)n  ≥  0 is the sequence of Fibonacci numbers (Fn)n  ≥  0, Medina and Rowland [\cite=MR15] gave an algebraic proof of Theorem [\ref=thm:shu_yao] and also determined the rank of νp(Fn + 1)n  ≥  0. Their result is the following.

For each prime number p the sequence νp(Fn + 1)n  ≥  0 is p-regular. Precisely, for p  ≠  2,5 the rank of νp(Fn + 1)n  ≥  0 is α(p)  +  1, where α(p) is the least positive integer such that p|Fα(p), while for p  =  2 the rank is 5, and for p  =  5 the rank is 2.

In this paper, we extend both Theorem [\ref=thm:shu_yao] and Theorem [\ref=thm:med_row] to k-adic valuations with k relatively prime to b. Let Δ: = a2  +  4b be the discriminant of f(x). Also, for each positive integer m relatively prime to b let τ(m) denotes the rank of apparition of m in (un)n  ≥  0, i.e., the least positive integer n such that m|un (which is well-defined, see, e.g., [\cite=Ren13]).

Our first two results are the following.

If k  ≥  2 is an integer relatively prime to b, then the sequence νk(un + 1)n  ≥  0 is k-regular.

Let p be a prime number not dividing b, and let r be the rank of νp(un + 1)n  ≥  0.

If p|Δ then:

r  =  2 if p∈{2,3} and νp(up)  =  1, or if p  ≥  5;

r  =  3 if p∈{2,3} and νp(up)  ≠  1.

If [formula] then:

r  =  5 if p  =  2 and ν2(u6)  ≠  ν2(u3)  +  1;

r  =  τ(p)  +  1 if p  >  2, or if p  =  2 and ν2(u6)  =  ν2(u3)  +  1.

Note that Theorem [\ref=thm:med_row] follows easily from our Theorem [\ref=thm:rank], since in the case of Fibonacci numbers b  =  1, Δ  =  5, ν2(F3)  =  1, ν2(F6)  =  3, and τ(p)  =  α(p).

As a preliminary step in the proof of Theorem [\ref=thm:is_kreg], we obtain some formulas for the k-adic valuation νk(un), which generalize a previous result of the second author. Precisely, Sanna [\cite=San16] proved the following formulas for the p-adic valuation of un.

If p is a prime number such that [formula], then for each positive integer n, where and for p  ≥  3.

Actually, Sanna's result [\cite=San16] is slightly different but it quickly turns out to be equivalent to Theorem [\ref=thm:un_padic] using [\cite=San16]. Furthermore, in Sanna's paper it is assumed gcd (a,b)  =  1, but the proof of [\cite=San16] works exactly in the same way also for gcd (a,b)  ≠  1.

From now on, let [formula] be the prime factorization of k, where [formula] are prime numbers and [formula] are positive integers.

We prove the following generalization of Theorem [\ref=thm:un_padic].

If k  ≥  2 is an integer relatively prime to b, then for any positive integer n, where

Note that Theorem [\ref=thm:un_kadic] is indeed a generalization of Theorem [\ref=thm:un_padic]. In fact, if k  =  p is a prime number then obviously for each positive integer n.

Preliminaries

In this section we collect some preliminary facts needed to prove the results of this paper. We begin with some lemmas on k-regular sequences.

If s(n)n  ≥  0 and t(n)n  ≥  0 are two k-regular sequences, then (s(n)  +  t(n))n  ≥  0 and s(n)t(n)n  ≥  0 are k-regular too. Precisely, if A is a finite set of generators of 〈 ker k(s(n)n  ≥  0)〉 and B is a finite set of generators of 〈 ker k(t(n)n  ≥  0)〉, then [formula] is a set of generators of 〈 ker k((s(n)  +  t(n))n  ≥  0)〉.

See [\cite=AS92].

If s(n)n  ≥  0 is a k-regular sequence, then for any integers c  ≥  1 and d  ≥  0 the subsequence s(cn  +  d)n  ≥  0 is k-regular.

See [\cite=AS92].

Any periodic sequence is k-regular.

An ultimately periodic sequence is k-automatic for all k  ≥  2, see [\cite=AS03b]. A k-automatic sequence is k-regular, see [\cite=AS92].

Let s(n)n  ≥  0 be a sequence of integers. If there exist some

[formula]

such that the sequences sj(kn  +  i)n  ≥  0, with 0  ≤  i  <  k and 1  ≤  j  ≤  r, are [formula]-linear combinations of [formula], then s(n)n  ≥  0 is k-regular and 〈 ker k(s(n)n  ≥  0)〉 is generated by [formula].

It is sufficient to prove that [formula] for all integers e  ≥  0 and 0  ≤  i  <  ke. In fact, this claim implies that [formula], while by ([\ref=equ:srinkker]) we have [formula], hence [formula] and so s(n)n  ≥  0 is k-regular. We proceed by induction on e. For e  =  0 the claim is obvious since s  =  s1. Suppose e  ≥  1 and that the claim holds for e  -  1. We have [formula], for some integers 0  ≤  j  <  k and [formula]. Therefore, by the induction hypothesis,

[formula]

and the claim follows.

The next lemma is well-known, we give the proof just for completeness.

The sequence νk(n  +  1)n  ≥  0 is k-regular of rank 2. Indeed, 〈 ker k(νk(n  +  1)n  ≥  0)〉 is generated by νk(n + 1)n  ≥  0 and the constant sequence (1)n  ≥  0.

For all nonnegative integers n and i  <  k we have Therefore, putting s1  =  νk(n  +  1)n  ≥  0 and s2  =  (1  +  νk(n  +  1))n  ≥  0 in Lemma [\ref=lem:kreg_sr], we obtain that 〈 ker k(νk(n  +  1)n  ≥  0)〉 is generated by νk(n + 1)n  ≥  0 and (1  +  νk(n  +  1))n  ≥  0, hence it is also generated by νk(n + 1)n  ≥  0 and (1)n  ≥  0, which are obviously linearly independent. Thus νk(n  +  1)n  ≥  0 is k-regular of rank 2.

Now we state a lemma that relates the k-adic valuation of an integer with its pi-adic valuations. The proof is quite straightforward and we leave it to the reader.

We have for any integer m  ≠  0.

We conclude this section with two lemmas on the rank of apparition τ(n).

For each prime number p not dividing b, where [formula] denotes the Legendre symbol. In particular, if p|Δ then τ(p)  =  p.

The case p  =  2 is easy. For p  >  2 see [\cite=Som80].

If m and n are two positive integers relatively prime to b, then

See [\cite=Ren13].

Proof of Theorem [\ref=thm:un_kadic]

Thanks to Lemma [\ref=lem:kadic_min], we know that

[formula]

Moreover, from Lemma [\ref=lem:tau_lcm] it follows that Therefore, on the one hand, if [formula] then [formula] for some [formula], so that by Theorem [\ref=thm:un_padic] we have νpi(un)  =  0, which together with ([\ref=equ:un_min]) implies νk(un)  =  0, as claimed.

On the other hand, if [formula] then τ(pi)|n for [formula]. Hence, from ([\ref=equ:un_min]), Theorem [\ref=thm:un_padic], and Lemma [\ref=lem:kadic_min], we obtain so that the proof is complete.

Proof of Theorem [\ref=thm:is_kreg]

Clearly, if k is fixed, then ck(n) depends only of the parity of n. Thus it follows easily from Theorem [\ref=thm:un_kadic] that

[formula]

for each integer n  ≥  0, where the sequences s(n)n  ≥  0 and t(n)n  ≥  0 are defined by and On the one hand, by Lemma [\ref=lem:kreg_lin] and Lemma [\ref=lem:kreg_linsub], we know that both νk(ck(1)(n + 1))n  ≥  0 and νk(ck(2)(n + 1))n  ≥  0 are k-regular sequences. On the other hand, by Lemma [\ref=lem:kreg_periodic], also the sequences s(n)n  ≥  0 and t(n)n  ≥  0 are k-regular, since obviously they are periodic.

In conclusion, thanks to ([\ref=equ:un_kadic_sum]) and Lemma [\ref=lem:kreg_ring], we obtain that νk(un + 1)n  ≥  0 is a k-regular sequence.

Proof of Theorem [\ref=thm:rank]

First, suppose that p|Δ. By Lemma [\ref=lem:tau_div] we have τ(p)  =  p. Moreover, it is clear that ϱp(n)  =  ϱp does not depend on n. As a consequence, from Theorem [\ref=thm:un_padic] it follows easily that

[formula]

for any integer n  ≥  0, where the sequence s(n)n  ≥  0 is defined by On the one hand, if p∈{2,3} and νp(up)  =  1, or if p  ≥  5, then ϱp  =  0. Thus s(n)n  ≥  0 is identically zero and it follows by ([\ref=equ:sum1]) and Lemma [\ref=lem:kreg_lin] that r  =  2. On the other hand, if p∈{2,3} and νp(up)  ≠  1, then ϱp  ≠  0. Moreover, for [formula] we have hence from Lemma [\ref=lem:kreg_sr] it follows that s(n)n  ≥  0 is p-regular and that 〈 ker p(s(n)n  ≥  0)〉 is generated by s(n)n  ≥  0 and (ϱp)n  ≥  0. Therefore, by ([\ref=equ:sum1]), Lemma [\ref=lem:kreg_lin], and Lemma [\ref=lem:kreg_ring], we obtain that νp(un + 1)n  ≥  0 is a p-regular sequence and that 〈 ker p(νp(un + 1)n  ≥  0)〉 is generated by νp(n + 1)n  ≥  0, s(n)n  ≥  0, and (1)n  ≥  0, which are clearly linearly independent, hence r  =  3.

Now suppose [formula]. By Lemma [\ref=lem:tau_div], we know that [formula], for some ε∈{ - 1, + 1}. Furthermore, if p  =  2 then it follows easily that τ(2)  =  3. As a consequence, from Theorem [\ref=thm:un_padic] we obtain that

[formula]

for any integer n  ≥  0, where the sequences s(n)n  ≥  0 and t(n)n  ≥  0 are defined by with v: = νp(uτ(p)), and

We shall show that s(n)n  ≥  0 is a p-regular sequence of rank τ(p)  +  1. Let us define the sequences sj(n)n  ≥  0, for [formula], by On the one hand, for [formula] we have

[formula]

since [formula] and consequently νp(pn  +  i + 1)  =  0.

On the other hand,

[formula]

since νp(pn  +  p)  =  νp(n  +  1)  +  1 and gcd (p,τ(p))  =  1.

Furthermore, for [formula] and [formula],

[formula]

Summarizing, the sequences s(pn + i)n  ≥  0 and sj(pn + i)n  ≥  0, for [formula] and [formula], are [formula]-linear combinations of s(n)n  ≥  0 and sj(n)n  ≥  0.

Moreover, for [formula] we have

[formula]

hence, by ([\ref=equ:s0p2]) and ([\ref=equ:ss0]), it follows that

[formula]

Since τ(p)|p  -  ε, we have hence by ([\ref=equ:sitaup]) we get that sj(n)n  ≥  0∈〈 ker p(s(n)n  ≥  0)〉, for each [formula].

Therefore, in light of Lemma [\ref=lem:kreg_sr], we obtain that s(n)n  ≥  0 is a p-regular sequence and that 〈 ker p(s(n)n  ≥  0)〉 is generated by s(n)n  ≥  0 and sj(n)n  ≥  0, with [formula]. It is straightforward to see that these last sequences are linearly independent, hence s(n)n  ≥  0 has rank τ(p)  +  1.

If p  >  2, or if p  =  2 and ν2(u6)  =  ν2(u3)  +  1, then t(n)n  ≥  0 is identically zero, thus from ([\ref=equ:sum2]) and the previous result on s(n) we find that r  =  τ(p)  +  1.

So it remains only to consider the case p  =  2 and ν2(u6)  ≠  ν2(u3)  +  1. Recall that in such a case τ(2)  =  3, and put d: = ν2(u6)  -  ν2(u3)  -  1. Obviously, the sequence t(2n)n  ≥  0 is identically zero, while

[formula]

Thus, again from Lemma [\ref=lem:kreg_sr], we have that t(n) is a 2-regular sequence and that 〈 ker p(t(n)n  ≥  0)〉 is generated by t(n)n  ≥  0 and d  ·  sj(n)n  ≥  0, for j = 0,1,2.

In conclusion, by ([\ref=equ:sum2]) and Lemma [\ref=lem:kreg_ring], we obtain that νp(un + 1)n  ≥  0 is a 2-regular sequence and that 〈 ker p(νp(un + 1)n  ≥  0)〉 is generated by s(n), t(n), and sj(n), for j = 0,1,2, which are linearly independent, hence r  =  5. The proof is complete.

Concluding remarks

It might be interesting to understand if, actually, νk(un  +  1)n  ≥  0 is k-regular for every integer k  ≥  2, so that Theorem [\ref=thm:is_kreg] holds even by dropping the assumption that k and b are relatively prime. A trivial observation is that if k and b have a common prime factor p such that [formula], then [formula] for all integers n  ≥  1, and consequently νk(un  +  1)n  ≥  0 is k-regular simple because it is identically zero. Thus the nontrivial case occurs when each of the prime factors of gcd (b,k) divides a.

Another natural question is if it is possible to generalize Theorem [\ref=thm:rank] in order to say something about the rank of νk(un  +  1)n  ≥  0 when k is composite. Probably, the easier cases are those when k is squarefree, or when k is a power of a prime number.

We leave these as open questions to the reader.