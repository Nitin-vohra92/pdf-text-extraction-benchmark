Friction from Reflectance: Deep Reflectance Codes for Predicting Physical Surface Properties from One-Shot In-Field Reflectance

Introduction

Reflectance describes the characteristics of light interaction with a surface, which is uniquely determined by how the surface is made up at a microscopic (e.g., pigments in the surface medium) and mescopic scale (e.g., geometric 3D texture). Naturally, reflectance provides an invaluable clue about the surface, including what it is made of (i.e., material), and how it is shaped (i.e., surface roughness). Reflectance has recently been used to classify surfaces based on the underlying materials [\cite=Zhang15] [\cite=Liu_2013_CVPR]. and to recover fine-grained geometry [\cite=Dana04] [\cite=Wang06] Reflectance, however, encodes richer information about the surface than just the material category and surface geometry.

In this paper, we show that reflectance can be used to estimate tactile properties of the surface: determine the touch from appearance. We, in particular, build the first approach for friction-from-reflectance. An image-based friction estimation method has important implications in many applications. For example, robotics can plan how to grasp an object easily with an estimated friction coefficient. A mobile robot or autonomous automobile can use friction information to select an optimized driving mode. For this, we introduce a novel representation of reflectance patterns using a state-of-the-art texture representation that builds on key aspects of deep learning and binary embedding. We demonstrate the power of our approach deep reflectance codes first in conventional material recognition and then on predicting friction from one-shot measurements.

Reflectance measurements encode rich information that raw images do not. Recognizing materials using ordinary internet-mined photographs has shown great promise [\cite=bell15minc] [\cite=Sharan13] [\cite=Cimpoi14]. Reflectance information provides a different, complementary approach [\cite=Zhang15] based on the measurement of the material characteristics, instead of phenomenological appearance. As first introduced by Zhang et al.[\cite=Zhang15], reflectance disks are a sampling of a surface BRDF without requiring a lab based dome-like measurement system. The disk images are acquired using a concave parabolic mirror positioned over a surface. Due to the mirror geometry, each pixel corresponds to the reflected surface light from a different viewing direction.

Computational models of reflectance disks need to be sufficiently descriptive and yet have invariance to illumination and surface tilt. The measured appearance of a surface changes under multiple illumination angles. The illumination direction affects the position of the specular peak within the reflectance disk, necessitating translation invariance within the representation. The distribution of patterns in the reflectance disk also necessitates a shift-invariant representation similar to desired properties of texture representations. Prior work in representing reflectance disks [\cite=Zhang15] used hashing to create a binary code for fast recognition and retrieval in high dimensional spaces. Classic methods of texton histograms and texton maps have been replaced in recent years with deep representations for texture such as deep filter banks [\cite=Cimpoi15]. We introduce a novel material representation, which we refer to as deep reflectance codes (DRC), that builds on these two concepts. Deep reflectance codes achieve necessary descriptive power and invariance by applying binary embedding to fisher vector convolutional neural nets (FV-CNN) [\cite=Cimpoi15]. To demonstrate the general discriminatory power of this new material representation, we test it in both image-based and reflectance disk-based material recognition and show that their performance surpasses past representations on several existing material datasets. Figure [\ref=fig:diskexample] shows an overview of our approach.

Deep reflectance codes provide a compact binary representation of the intrinsic phyiscal characteristics of the underlying material. We demonstrate this by showing, for the first time, that reflectance can be used to estimate the friction coefficient of a surface. For this, we collect a first-of-its-kind database of friction coefficients and reflectance disks measured for 137 surfaces that can be grouped into 21 classes (shown in Figure [\ref=fig:database]). For exploratory analysis of how reflectance disks encode surface friction, we find a manifold showing the proximal layout of deep reflectance codes using t-SNE [\cite=van2008visualizing] as well as a corresponding friction map in t-SNE space. The experimental results show that the reflectance disks and their deep codes encode sufficient information to accurately predict the friction of a surface from its one-shot in-field reflectance measurements. The practical implications of this novel vision-based friction estimation is significant. Current friction sensors are tactile such as tire sensors that measure slip [\cite=Erdogan11] [\cite=Gustafsson97] [\cite=Matsuzakia05]. Appearance modeling in a fine-grained precise manner allows non-contact friction estimation (e.g. before the tire hits the road patch), which would be useful for various applications such as road surface ice detection, robot locomotion control, and the integration of haptics and graphics.

In summary, there are three main novel contributions: 1) deep reflectance codes for material representation, 2) friction estimation from reflectance, 3) and a database of friction coefficients and reflectance disks.

Related Work

Friction from reflectance is an entirely new area. Prior work in friction measurement requires surface contact. These contact friction sensors have been used for real-world friction estimates in applications such as haptics for textiles [\cite=ramkumar2003developing] [\cite=bertaux2007relationship], automobile tire sensors [\cite=Erdogan11] [\cite=Gustafsson97] [\cite=Matsuzakia05], and sheet metal rolling in manufacturing [\cite=nyahumwa1991friction]. The ability to estimate friction with vision-based methods will have significant impact on these application areas and many others. Non-contact enables higher speeds and larger distances. Furthermore, material characterization based on friction does not depend on a semantic label and may have greater utility in applications that interact with surfaces.

In prior work [\cite=Zhang15], reflectance disks have been used for material recognition. Their work combines material descriptor of textons distribution with similarity preserving binary embedding methods such as circulant binary embedding (CBE) [\cite=Yu14], bilinear embedding [\cite=Gong13a], iterative quantization (ITQ) [\cite=Gong13b], angular quantization-based binary codes (AQBC) [\cite=Gong12], spectral hashing (SH) [\cite=Weiss09], locality-sensitive binary codes from shift-invariant kernels (SKLSH) [\cite=Raginsky09], and locality sensitive hash (LSH) [\cite=Charikar02]. Traditional methods of texton histograms [\cite=Cula01a] [\cite=Cula01b] [\cite=Leung01] [\cite=Varma02] have a weakness in their discriminatory power.

Fisher Vector pooling as part of deep learning frameworks has been shown to have excellent performance in texture recognition problems [\cite=Cimpoi15]. Binary embedding combined with Fisher Vector pooling [\cite=perronnin2010large] has been explored for image retrieval. Deep learning is known for discovering discriminant and robust feature representations. The combination of deep learning and binary compact hash codes is an interesting path that combines the efficiency of binary codes (hamming distance is fast) with the robust performance of deep learning. Semantic hashing [\cite=salakhutdinov2009semantic] [\cite=torralba2008small] builds a deep binary model by quantizing a pre-trained and fine-tuned stack of Restricted Boltzmann Machines (RBMs). Deep hashing [\cite=erin2015deep] develops a neural network to learn multiple hierarchical non-linear transformations mapping raw images to compact binary hash codes. However, these hashing techniques rely on hand-crafted visual features as input.

Recent work shows that deep convolutional neural network trained on a sufficiently large dataset such as ImageNet [\cite=ILSVRC15] can be transferred to other computer vision tasks [\cite=gong2014multi] [\cite=Cimpoi15] [\cite=donahue2013decaf] [\cite=razavian2014cnn]. Lower convolutional layers remain similar on different datasets [\cite=zhou2014learning]. CNN activations are still sensitive to translation, rotation and scale [\cite=gong2014multi]. Recognizing reflectance disks from unknown illumination and surface tilts is very similar to texture recognition. It is the distribution of features and visual structures, not their particular spatial location, that is most important. Therefore, dense pooling methods are essential. Multi-scale orderless pooling [\cite=gong2014multi] and deep filter banks [\cite=Cimpoi15] using VLAD pooling [\cite=jegou2010aggregating] and Fisher Vector pooling of CNN activations achieve state-of-the-art results on texture, material and scene recognition tasks. We leverage Fisher vector pooling of CNN activations for exploring compact hash codes as binary representations of data.

One-Shot In-Field Reflectance Disks

We follow Zhang et al.[\cite=Zhang15] and use a mirror-based camera [\cite=Dana01] [\cite=Dana04] to measure reflectance of surface points. The camera components are an off-axis parabolic mirror, a CCD camera, a movable aperture and a beam splitter (as shown in Figure [\ref=fig:cameraschematic]). The parabolic mirror is fixed so that its focus is at the surface point to be measured. The illumination source is a collimated beam of light parallel to the global plane of the surface passing through a movable aperture. The angle of the incident ray at the surface is determined by the intersection point with the mirror. Therefore, the illumination direction can be controlled by planar translations of the aperture. Similarly, light reflected from the surface point is reflected by the mirror to a set of parallel rays directed through a beam splitter to the camera. Each pixel of this camera image corresponds to a viewing direction of the surface point. Therefore, the recorded image, referred to as a reflectance disk, is an observation of a single point on the surface but from a dense sampling of viewing directions.

Deep Reflectance Codes

Reflectance naturally encodes the intrinsic physical properties of the surface, but its measurement is sensitive to illumination changes. For reflectance disks, the illumination changes correspond to translational shifts of image features; e.g. the specularity position shifts. We explore translation invariant representation to extract the physical information. Pre-trained CNN features have been applied to a number of computer vision tasks with great success [\cite=krizhevsky2012imagenet] [\cite=jia2014caffe] [\cite=Lecun15], but CNN features are fairly sensitive to translation and rotation. Dense pooling of CNN activations removes the globally spatial information and therefore is robust to pattern translation and rotation. VLAD-CNN and FV-CNN achieved the state-of-the-art results in scene understanding and material recognition [\cite=gong2014multi] [\cite=Cimpoi15]. We leverage the shift-invariance representation of dense pooling CNN for exploring compact hash codes. The resulting hash codes potentially preserve the similarities of surface physical characteristics, which we refer to as deep reflectance codes. A key difference from Cimpoi et al. [\cite=Cimpoi15] is that we introduce a unsupervised hashing approach rather than a material descriptor for supervised SVM material classification.

Visualizing the effect of the FV-CNN representation can be done with t-SNE [\cite=van2008visualizing]. Figure [\ref=fig:embedding] shows reflectance disk representations using (a) raw reflectance disk data and (b) texton maps. The representation of FV-CNN in Figure [\ref=fig:embedding] (c) shows significantly better class discrimination. This figure depicts many material instances under multiple illumination directions and we can see that our reflectance descriptor provides sufficient invariance and allows grouping of similar materials.

The challenge of using FV-CNN for retrieval is the high dimensionality of the Fisher vector representation (64K dimensions for our implementation described in Section [\ref=sec:ex:hashing]). To achieve a more compact representation, we integrate a binary embedding strategy which preserves the similarity of the Fisher vectors. The resulting hash codes are suitable for both material recognition and friction estimation. In this work, the recognition experiments are used to evaluate the quality of the representation in order to use it for friction estimation.

DRC

For binary embedding, projection to a lower dimensional subspace that preserves the similarity is a key component. The Johnson-Lindenstrauss (J-L) Lemma implies that with high probability, the relative distances between all pair of points are approximately preserved under random projection [\cite=arriaga1999algorithmic]. Therefore, by randomly projecting the high-dimensional data into lower dimension, we can still achieve a comparative results with a linear classifier. Additionally, learning a kernel classifier using Fisher kernel is equivalent to learning a linear classifier on the Fisher vector [\cite=perronnin2010improving]. By quantizing the randomly projected Fisher vector to binary hash codes, we are able to approximate the behavior of linear classifier using Fisher Vectors, approximating a kernel classifier using Fisher Kernel. The dot product has been shown as a good measurement of similarity for Fisher vectors and we can use Local Sensitivity Hashing (LSH) [\cite=Charikar02] to binarize the Fisher Vector as in [\cite=perronnin2010large] quantizing the randomly projected data using the hyper-planes across the origin. The cosine similarities of all pairs of data are preserved under random projection [\cite=shi2012margin]. Therefore the hamming distance of generated hash codes preserves the similarity of Fisher vectors. We use quantized random projection of Fisher representation in one variation of our approach, and we refer to this method as DRC - Deep Reflectance Codes.

DRC-opt

LSH directly quantizes the randomly projected data into hash codes. Let [formula] represent a projected data point and the hash function [formula] maps the data to the vertex of the hyper-cube { - 1,1}d. The quantization error can be written as [formula]. Following the iterative quantization method [\cite=Gong13b], in order to preserve the local similarity of the data, a better hash code can be learned by rotating the data to minimize the quantization error:

[formula]

where N is the number of training data, the binary code is given by [formula], [formula] is a rotation matrix. We use this combination of fisher vector CNN with this optimized binary embedding and we refer to it as DRC-opt optimized Deep Reflectance Codes.

Friction from Reflectance

Deep reflectance codes give us a compact representation that encodes the reflectance disks which we expect to encode rich information about the physical properties of the material itself. We are particularly interested in probing tactile properties of a surface from its reflectance appearance. For this, we focus on estimating friction from reflectance disks. In this section, we introduce the first-of-its-kind friction-reflectance database and then apply deep reflectance codes to estimate friction from one-shot in-field reflectance disks.

Friction-Reflectance database

We collect 137 different materials (shown in Figure [\ref=fig:database]) and group them into 21 categories: aluminum sheet, artificial leather, artificial marble, asphalt, automotive paint, composite flooring, concrete, cotton, leather, linen, marble, metallic paint panel, mother of pearl, nylon, painted wood flooring, plastic paint panel, sand paper, smooth ceramic tile, velvet, waterproof fabric, wood panel. Our database includes 5-10 different material samples (instances) per category, and we measure 2 different surface spots per sample with 7 illumination directions [formula] along axis and [formula] off axis, where [formula] is frontal illumination aligned with the surface normal. Additionally, images with 3 exposure settings are collected for high dynamic range imaging. The total number of reflectance disks are 5754.

Friction of a surface is an intrinsic physical property of a surface that can readily be measured non-visually with a contact device. The coefficient of kinetic friction multiplied by the force normal (due to gravity) is the force of friction which act to hold an object in place on a surface. We adopt a simple approach for measuring kinetic friction coefficient by using an inclined plane. In the experiments, we hold the object just above the surface of the inclined plane and release it. At low angles, the object should does not move. As the angle increases, the object begins to slide down at a constant velocity. The angle θ is recorded, and the kinetic friction coefficient is calculated as μ  =   tan θ. For a thin material such as cloth, we attach it to a solid object for the friction measurement. The measured kinetic friction coefficients for all 137 surfaces and the inclined plane friction measurement device are shown in the Table [\ref=fig:frictionsensor]. The measured kinetic friction coefficients are shown in Table [\ref=fig:frictionsensor].

Hashing for Friction Prediction

Deep reflectance codes encode rich information of physical properties of material surface from reflectance disks. The similarities of material physical properties are preserved in Hamming distance by compact hash codes. Figure [\ref=fig:embedding] (c,d) visualizes the correspondence between the friction distribution and the representation using t-SNE, and we are able to see the material surfaces with similar friction coefficients are likely to have small distance. Therefore, our approach of deep reflectance codes can be used for friction estimation. We build a binary hash table with the DRC as the key and the corresponding surface friction coefficient as the hash value. The binary representations are compact and amenable for fast nearest neighbor retrieval. The predicted friction coefficient of a sample is given by the average of friction coefficients of retrieved samples.

Experimental Results

To evaluate the proposed approach of deep reflectance codes in spatial invariance representation and friction prediction, we conduct two groups of experiments. We first apply deep reflectance codes on retrieval for material recognition as a litmus test of the representation and then evaluate the performance of friction prediction from one-shot measurements.

Hashing for Material Recognition

Material and texture are typically modeled by orderless pooling of visual patterns, i.e. texton distributions, as the shape and spatial information are not important. We apply deep reflectance codes on image retrieval for material recognition to demonstrate the discriminative power and the spatial invariance of our representation.

Additional Datasets

We also consider three other material datasets to evaluate our DRC approach for general material recognition. The first one is Flickr Material Dataset (FMD) [\cite=Sharan13], which contains 10 material classes. The second one is the Describable Texture Datasets (DTD) [\cite=Cimpoi14], containing texture images labeled with 47 describable attributes. The third texture dataset is KTH-TIPS-2b (KTH) [\cite=caputo2005class], which contains 11 material categories with 4 samples per category and a number of example images for each sample. For this unsupervised hashing for material recognition experiments, the training set means the retrieval set for nearest neighbor search. For the DTD and FMD, the test set are given by randomly selected 20% images, and the rest are for training. The test set of reflectance database and KTH-TIPS are given by randomly selecting one sample of each material category, and the remaining samples are used for training. The experimental results are averaged in 10 runs.

Baseline Methods

For general evaluation of our DRC in material recognition, we compare it with the following methods and settings: FV-SIFT-Hash [\cite=perronnin2010large], CNN-ITQ [\cite=Gong13b], VLAD-CNN-KBE [\cite=zhangfast], FV-CNN-KBE. FV-SIFT-Hash is binarized fisher vector pooling of SIFT feature as in [\cite=perronnin2010large]. CNN-ITQ is iterative quantization binary hashing [\cite=Gong13b] on 4096-dimensional CNN activations, which is typically compared as a baseline for deep hashing algorithm. KBE represents a latest work Kronecker Binary Embedding [\cite=zhangfast] (randomized orthogonal version with order 2 is used in this experiment, which is good for high-dimension data). We define ground truth as the given class label of material, and use the mode of labels from 10 retrieved nearest neighbors of hash codes in Hamming Distance as the predicted label. The mean recognition precision is computed over all inquiries from test set averaged over 10 runs.

In our experiments, a pre-trained VGG-M model [\cite=chatfield2014return] is used for computing CNN activations. CNN activations for VLAD are taken by the output on the first fully connected layer (full6) with a 4096 dimension. We extract activations for 128  ×  128 paches sampled with a stride of 32 pixels, and use PCA to reduce them to 512 dimensions [\cite=gong2014multi]. We use 64 k-means centers for computing VLAD pooling, the vector is given by assigning each patch to its nearest clustering center and aggregating the residuals of patches minus the center. Hence, the dimension of VLAD pooling CNN is 32K. The CNN activations for FV pooling are taken from the output of the first convolutional layer with 512 dimensions (conv5 of VGG-M). We use 64 Gaussian components for the FV representation, resulting in 65K dimensions FV-CNN descriptors. The implementations are based on MatConvNet [\cite=vedaldi15matconvnet] and VLFeat [\cite=vedaldi08vlfeat].

Table [\ref=tab:hash] shows material recognition results comparing different encodings and hashing methods. We can see the randomized and optimized version of DRC hashing outperform the other methods in FTD, DTD and KTH datasets. Note that our compact unsupervised binary hashing methods can achieve comparable results with training SVM on FV-CNN as reported in [\cite=Cimpoi14]. FV pooling provides domain transfer of CNN activations and we have found it make the use of the property that FV pooling essentially discarding the influence the CNN activations corresponding to frequent background structures that are often domain specific. DRC-opt (60.2%) is much better than directly using CNN activations (CNN-ITQ 51.9%) for the reflectance dataset. The methods using CNN features are slightly worse than hashing with FV pooling SIFT feature, since the reflectance disks dataset is very different from the CNN pre-trained dataset, ImageNet, which consists real world images. Reflectance Hashing with textons [\cite=Zhang15] has an overall recognition precision of 56.69% on this reflectance dataset. We test this method on the reflectance dataset only since it is specifically developed for reflectance disks. Our evaluation indicates the utility of this binary code representation both for general material recognition and specifically for reflectance disk representation.

Friction Prediction

For friction prediction experiments, we use 1024-bit deep reflectance codes to estimate the surface friction from one-shot in-field reflectance disks. For reflectance-friction dataset, each surface instance (from same or different material class) can have a different friction coefficient, as shown in Table [\ref=fig:frictionsensor]. We use leave-one-out cross-validation as training test splits. Each time the disks of one surface is selected as test set and the disks of the rest 136 surfaces are used for training (retrieval). The predicted friction coefficient is given by calculating the average of retrieved 10 neighbors.

Baseline Method

To evaluate our hash codes on friction prediction, we use a regression network as a baseline method. The feedforward network takes the material reflectance representation to directly predict the friction coefficients by fitting a parameterized functional form using FV-CNN representation as input (projected into 1024 dimension). Each neuron in the network nonlinearly transforms the weighted received inputs into outputs. Our regression net has two hidden layers with 16 and 8 neurons respectively and apply a sigmoid function as activation function. The optimal values for parameters are learned by minimizing the sum of the square errors between measured friction coefficients and those predicted by the network.

Figure [\ref=fig:scatter] shows the prediction results of DRC and the baseline method. The scatter plot (top-left) is color coded and the colors represent the local density around each point. The plot shows the largest density of points have low prediction error. The top-right figure shows a histogram of the error percentage. The predicted data mainly fall into small error bins and the overall mean percentage error is 11.15%. The results of baseline method are shown at the bottom and the overall mean percentage error is 14.74%.

Figure [\ref=fig:density] provides a more detailed view of the friction-from-reflectance prediction by showing the per-class recognition performance. The red line is the ground truth of friction coefficients, and the points are predicted values colored by the local density of points. Our DRC approach outperforms the baseline method. However, the DRC as a hashing approach has the limitation for predicting the surface with extremely high or low friction due to absence of certain data from retrieval set.

Conclusions

We have presented the first-of-its kind friction-from-reflectance framework. Using a unique method for capturing one-shot reflectance, we obtain a simple snapshot of local reflectance. We implement a representation of reflectance with the goal of using this representation for physical property inference. As an evaluation of the quality of the representation, we consider its use in retrieval of reflectance disks and also in general image retrieval; a representation that is sufficiently descriptive for recognition is a good candidate for input to our novel image-based friction prediction. Friction-from-prediction will have good practical value in applications including automated assessment of road conditions prior to vehicular contact, planning robotic grasping of unknown objects, attribute tagging in scene analysis. The paradigm of inferring physical surface properties from image data is the major contribution of the work. The database of reflectance disks, surface images, and corresponding friction measurements will be made publicly available for future research.

Acknowledgment

This work was fully supported by the National Science Foundation award IIS-1421134.