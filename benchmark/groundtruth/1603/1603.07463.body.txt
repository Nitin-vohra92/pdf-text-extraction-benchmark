Use of 3D classified topographic data with FullSWOF for high resolution simulation of a river flood event over a dense urban area

Introduction

The severity and frequency of urban flooding can be reduced by better planning policies [\cite=Djordjevic11]. Numerical modeling tools are commonly used as supporting tools for decision makers willing to assess flood mitigation process [\cite=Gourbesville09]. At coarse scale, overview of extend and behavior of flood event can be estimated by different categories of numerical approaches. These approaches can be based on simplified 2D shallow water equations (SWE) such as diffusive wave or multiple porosity shallow water approaches [\cite=Guinot12]. Indeed, the cost of these types of numerical approaches, in terms of computational time and requirement of topographical information, is interesting compared to methods relying on fully resolved 2D SWE models. Nevertheless, urbanized areas create complex environment for overland flow locally introducing changes in flow properties and impacting flow behavior. Therefore, if one objective is to provide a detailed relative comparison of flood hazard at suburbs and building scale, the use of a fine environment description becomes necessary [\cite=Sampson12]. For accurate maximal water depth and maximal flow velocity estimations, fully resolved 2D SWE based mathematical model, taking into consideration inertial effects is a more reasonable approach. Moreover, the choice of a numerical approach implemented with modern hydrostatic reconstruction and well balanced properties will reinforce robustness and accuracy of the computation. FullSWOF_2D, which relies on finite volume and regular mesh has such types of mathematical and numerical properties [\cite=Delestre14]. Aerial gathered High Resolution (HR) topographic data is becoming commonly available through specific flight campaign or unmanned aerial vehicle use (see [\cite=Remondino11]). LiDAR and Photogrametry are the most frequently employed technologies for this purpose. They allow producing highly accurate DSM, finely describing complex urban environments. LiDAR born HR DSM are already commonly used for HR hydraulic modeling. Photogrametry allow through photo-interpretation procedure to get accurate and more specifically discriminated (classified) data which allow producing HR DSM adaptable to a given hydraulic modeling purpose [\cite=Abily14]. The Novelty of using classified data and the integration of large amount of data within 2D hydraulic models are challenging and remain at an experimental stage in terms of methodology to optimize HR 3D classified data use. Feasibility of High Resolution 3D (HR 3D) classified topographic data use, for hydraulic modeling purpose has been tested at industrial scale for flood event locally generated by intense rainfall events [\cite=Abily13] [\cite=Abily14]. The use of such type of data is revealed to be both promising and challenging for hydraulic modeling communities. Objectives of this study are (i) to assess workability of HR 3D classified topographic data use for river overland flow modeling and (ii) to take advantage of FullSWOF_2D code properties for overland flow simulations in urban environment. Both FullSWOF_2D and HR 3D classified data use for flood river event modeling are tested in this study. A specific approach has been elaborated, for a medium scale HR DSM creation (5000 m per 3500 m), based on the use of HR 3D classified data. Selected area of interest is the low part of the Var river valley. This area has faced, in November 1994 a flood event. This area has been covered by a high accuracy photogrammetric data gathering campaign conducted by Nice Municipality (DIGNCA). Overland flow influencing structures such as concrete walls, road gutter, sidewalks, etc. are photo-interpreted. These structures are included in the dataset and their elevation properties will be a part of the topographic information included in the HR DSM specifically created for the hydraulic model. Modifications to FullSWOF_2D code have been effectuated to model river flow scenarios.

Material and methods

High Resolution 3D classified data of the low Var river valley

The photogrammetric data set has been gathered by Nice Municipality Geographic Information Services (DIGNCA) in 2010-2011. Combination of (i) a low altitude flight, (ii) a pixel resolution of 0.1 m at the ground level, (iii) a high level of overlapping among aerial pictures (80%) and (iv) the use of an important number of markers for georeferencing (about 200), lead to a high level of accuracy over the urban area of the city. Photo-interpretation allows creation of vectorial information based on photogrammetric dataset [\cite=Egels04] [\cite=Linder06]. A photo-interpreted dataset is composed of classes of points, polylines and polygons digitalized based on photogrammetric data. Important aspects in the photo-interpretation process are (i) classes definition and (ii) techniques and dataset quality used for photo-interpretation. Both will impact the design of the output classified dataset [\cite=Lu07]. Class definition step has to be elaborated prior to the photo-interpretation step. The number, the nature and criteria for classes’ definition will depend on the objectives of the photo-interpretation campaign. Photo-interpretation techniques can be made (i) automatically by algorithm use, (ii) manually by a human operator on a Digital Photogrammetric Workstation (DPW) or (iii) by a combination of the two methods. The level of accuracy is higher when the photo-interpretation is done by a human operator on a DPW, but is much more resources and time consuming [\cite=Lafarge10]. Principle of Nice city 3D HR classified dataset created from photogrammetry is explained in [\cite=Andres12]. The mean accuracy of the photo-interpreted data over the low Var valley area is 0.15 - 0.2 m in both vertical and horizontal dimensions. Error in photo-interpretation is estimated to be around 5%. These levels of errors and accuracy have been checked through terrestrial topographic measurements effectuated by DIGNCA over 10% of the domain covered by the photogrammetric campaign. The number of class of elements created as vectorialized features is about 50. The high level of accuracy has allowed to photo-interpret thin above ground features as narrow as concrete walls and road gutters. Over the part of the low Var river area selected for the study, total number of polyline features represents more than 1  100  000 objects introduced under vector form.

FullSWOF

FullSWOF stands for Full Shallow Water equations for Overland Flow (for more details see [\cite=Delestre14]). It is a set of open source C++ (ANSI) codes, freely available to the community from the website . It is distributed under a GPL like free software license. The structure of the code is made to facilitate the development of new evolutions. This software resolves the shallow water equations thanks to a well-balanced finite volume method based on the hydrostatic reconstruction (introduced in [\cite=Audusse04c]). This numerical method has good properties: water mass conservation, well-balancedness (at least preservation of lake at rest equilibrium) and positivity water height preservation. The shallow water system in 2D (SW2D) writes:

[formula]

where the unknowns are the velocities u(x,y,t)) and v(x,y,t) [formula] and the water height h(x,y,t) [formula]. The subscript x (respectively y) stands for the x-direction (resp. the y-direction): -  S0x  =  ∂xz(x,y) and -  S0y  =  ∂yz(x,y) are the ground slopes and Sfx and Sfy the friction terms. In FullSWOF, we have chosen to solve the SW2D on a structured grid. So we have chosen a numerical method adapted to the shallow water system in 1D (SW1D) and then it is generalized to 2D thanks to the method of lines. So in what follows, we describe the numerical method for the SW1D. The SW1D writes:

[formula]

in what follows, we consider Manning's friction law

[formula]

with q = hu the discharge in [formula]. The hydrostatic reconstruction is based on a general principle of reconstruction. We begin with a first order finite volume scheme for the form of SW1D (without source terms): choosing a positive and consistent numerical flux [formula] (e.g. Rusanov, HLL, kinetic, ...), a finite volume scheme writes under the general form

[formula]

where Δt is the time step and Δx the space step. The idea is to modify this scheme by applying the flux to reconstructed variables. Reconstruction can be used to get higher order schemes (MUSCL, ENO, ...), in that case higher order in time is obtained through TVD-Runge-Kutta methods. And the aim of the hydrostatic reconstruction is to be well-balanced. It is designed to preserve at least steady states at rest (u = 0). When it is directly applied on the initial scheme, it leads to a order one scheme, while coupling it with high order reconstruction increases the order and the accuracy. We describe now the implementation of this method for high order accuracy. The first step consists in performing a high order reconstruction (MUSCL, ENO, ...). To treat properly the topography source term ∂xz, this reconstruction is applied on u, h and h + z. This gives us the reconstructed variables (U-,z-) and (U+,z+), on which the hydrostatic reconstruction is applied

[formula]

The finite volume scheme is modified as follows

[formula]

where

[formula]

are left (resp. right) modifications of the numerical flux for the homogeneous system. In this formula, the flux is now applied with reconstructed variables [formula] and we take

[formula]

Finally, for consistency and well-balancing, a centered source term is added

[formula]

The chosen numerical strategy consists in the HLL flux (see [\cite=Delestre10b], not detailed here) and a modified MUSCL reconstruction. It has shown to be the best compromise between accuracy, stability and CPU time cost (in [\cite=Delestre10b]). The MUSCL reconstruction of a scalar variable [formula] writes

[formula]

with the minmod slope limiter

[formula]

with

[formula]

In order to keep the discharge conservation, the reconstruction of the velocity has to be modified as

[formula]

If we take Dsi = 0, we recover the first order scheme in space. The friction term is taken into account by a fractional step, with the following system

[formula]

This system is solved thanks to a semi-implicit method (as in [\cite=Delestre10b])

[formula]

This method allows to preserve stability (under a classical CFL condition) and steady states at rest. Finally a TVD-Runge Kutta method is applied to get second order in time. For the generalization to 2D, we use the HLLC flux introduced in combined with the method of lines. Concerning boundary conditions, we have modified the code, in order to have the discharge only in the riverbed, it is based on Riemann invariants. Finally, as we aim at simulating with big data, we have used a parallel version of FullSWOF based on a domain decomposition and the MPI library [\cite=Cordier13].

Method for HR 3D classified data use for hydraulic modeling

To create the HR DSM, the following approach has been carried out. First, a DTM using multiple ground level information sources: points, polygons and polylines is created and provided at a 0.5 m resolution by DIGNCA. Then, a selection procedure among classified data is performed. This selection is achieved by considering concrete elements which can influence overland flow drainage path only. It includes dikes, buildings, walls and “concrete” above ground elements (such as sidewalks, road gutters, roundabound, doors steps, etc.). 12 classes are selected among the 50 classes of the 3D photo-interpreted dataset (figure [\ref=fig1]). During this step, polylines giving information on elevated roads and bridges, which might block overland flow paths, are removed. The remaining total number of polylines is 52  600 after these two selection steps.

Final step of HR DSM elaboration consists in extruding elevation information of selected polylines on the DTM. To proceed, features represented by closed lines are converted to polygons (e.g. buildings, round abound, sidewalks). Polylignes and polygons are then converted to raster at desired resolution (here 1 m resolution) for extrusion over the DTM. Eventually, HR DSM which has elevation information of selected 3D classified features is produced (figure [\ref=fig2]). The HR DSM resolution is here 1 m. This choice of resolution is explained as follow: it will allow to integrate directly the HR DSM at desired regular mesh resolution in FullSWOF_2D. At this resolution the number of mesh cells is above 17.8 millions. The previously described method has allowed inclusion of thin elements impacting flow behavior of infra-metric dimension, oversized to metric size, in the 1 m resolution regular mesh.

Site and river flood event scenario

The [formula] to the [formula] of November 1994, an important flood event has occurred in the low part of the Var catchment. This historical flood event had severe consequences. The flood scenario for our tests is based on estimated hydrogram of this event [\cite=Guinot03]. Through our tests, we want to produce a HR map of maximal water depths reached in the low Var valley, using the produced HR DSM with FullSWOF code. Objective here is not to reproduce the flood event. Indeed, the site changed a lot since 1994: levees, dikes and urban structures have been intensively constructed in this area. To shorten the simulation length, we chose to simulate a 9 hours scenario. First, a constant discharge of [formula] is run for 3 hours to reach a steady state. Then the overtopping part of the hydrogram is run, reaching the estimated pic discharge ([formula]) and then decreasing long enough to observe a diminution of the overland flow water depth. The Manning-Strickler n coefficient is spatially uniform in overland flow areas. No energy loss properties have been included in the hydraulic model to represent the bridges piers effects.

Results and discussion

An overview of produced overland flow calculated maximal water depths is given in figure [\ref=fig3]. High resolution modeling of flood river event in an urban environment is of a great interest for urban planners as it allows producing detailed maps of maximal water elevations and maximal velocities maps for a given flood scenario. A proof of concept of 3D HR classified data use for river flood modeling is given here. Advantages of such an approach rely: (i) possibility to include detailed surface elements influencing overland flow, and (ii) in automatization and modularity of class selection for HR DSM production.

Two limits, in our HR DSM created for our test study, have to be emphasized. (i) The riverbed section itself was filled by 0.1 m to 0.2 m of water at the time of the photogrammetric campaign. Therefore the sections of the river are here underestimated, not without standing uncertainties the fact that changes in riverbed occur during a flood event. (ii) Bridges piers, reducing river section are not included in the HR DSM for our workability test. More generally speaking, several categories recommendation and limits deserved to be put to the light for practical engineering applications using such type of data. Even though HR DSM has a high level of accuracy, HR 3D data have different types of inherent errors. It includes white noise, biased, and punctual errors in measurement. Second type of errors is related to photo-interpretation. It can be omission, addition or misclassification of elements. These types of errors can lead to important changes in overland flow path in the hydraulic calculation. Moreover, criteria for photo-interpretation have to be checked as well as they can highly influence HR DSM. For instance a criteria (for human operators or algorithm) might be to close a polyligne, if distance between two points is below a certain threshold. This will block entrance of water in a given area. Moreover classification criteria for a given photo-interpreted data set might not have been created specifically for water modeling purpose. For instance what will be classified, as concrete wall, not be based on material criteria but on structure width/elevation ratio. In that case permeable structures, such as fences, can be classified as walls. Finally, a limitation appears regarding bridges piers where information is not given by aerial techniques. The 3D HR classified data are heavy and their manipulation for pre- and post-process is computational resources demanding. HR DSM use, with fully resolved 2D SWE codes at this scale, requires use of intensive calculation resources.

Conclusions

A proof of concept of High Resolution (HR) 3D classified data use, to produce a HR DSM for river flood simulation in complex environment has been presented in this study. Hydraulic modeling has been performed by adapting and using FullSWOF which is a code relying on fully resolved 2D Shallow Water Equations. Interest has been keen on FullSWOF as his numerical properties of mass conservation, well-balancedness and positivity preservation are relevant for HR overland flow modeling in urban areas. A Method to design a HR DSM including elements influencing overland flow has been presented. For such a purpose, workability of HR 3D classified topographic data use is relevant at this scale sub-city scale. Existing limits in this approach are put to the light. These limits mainly consists in (i) difficulty to handle this important amount of data, (ii) existence of unavoidable errors of classification in photo-interpretation, (iii) classification procedure which might not have been specifically designed criteria for hydraulic purpose.

Acknowledgments

Photogrametric and photo-interpreted dataset used for this study have been kindly provided by DIGNCA for research purpose. Technical expertise on DIGNCA dataset has been provided by G. Tacet and F. Largeron. Computations have been performed at the Mésocentre d'Aix-Marseille Université as well as IDRIS resources. Technical support for codes adaptation on high performance computation centers has been provided by F. Lebas, H. Coullon and P. Navarro.