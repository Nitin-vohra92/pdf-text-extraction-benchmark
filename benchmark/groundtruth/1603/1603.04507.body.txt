FOTOMCAp: a new quasi-automatic code for high-precision photometry

Introduction

To date, more than 1900 extrasolar planets have been discovered using different detection methods. Almost 50 per cent of these new worlds were found by the Kepler satellite [\citep=borucki] through the techniques of transit [\citep=charbo] [\citep=henry] and Transit Timing Variations or TTV [\citep=holman]. The analysis of data provided by the mission has revealed a wide variety of planetary systems. Some of the most amazing discoveries include the existence of Earth-like planets located in the habitable zone of their stars [\citep=quintana] [\citep=jenkins2015], multi-planetary systems with more than one transiting planet [\citep=masuda] [\citep=becker], or disintegrating minor planets orbiting a white dwarf [\citep=croll].

For ground-based observatories, the detection of light curves with shallow minima caused by small transiting planets represents an enormous challenge. Besides the precautions taken to acquire the best possible data, it is highly desirable that the procedure to obtain differential magnitudes ensures the determination of the most precise light curves. In this sense, almost all the groups carrying out systematic photometric follow-ups to find planets have developed their own pipelines to analyse the photometric data. However, most of these codes are not publicly available.

In this contribution we present the quasi-automatic program FOTOMCAp, written in IRAF language, developed to determine precise instrumental magnitudes. In Section 2, we describe the code. In Section 3, we examine possible differences between the results obtained with FOTOMCAp and those with our previous code FOTOMCC. In Section 4 we compare several algorithms to determine the stellar centre and flux, and the sky level value. Finally, in Section 5 we present our conclusions.

The FOTOMCAp code

The aim of this program is to automatically measure instrumental magnitudes of several stars that belong to a same field for which a large number of images is available, which is the usual scenario in the study of planetary transits or variable stars. As input, this code requires: a) all the images of the field under study, b) the values of different parameters that characterize the employed CCD (i.e. readout noise, gain, and saturation level) and the telescope (i.e. primary mirror diameter and the elevation of the observatory above sea level), c) a file with information provided by the daofind task of an i-number of previously selected bright and isolated field stars, and d) a reference image. This reference image is chosen by the user considering that it contains all the stars of interest and where each one presents an optimum level of ADUs. As last requirement, FOTOMCAp needs a shift estimation (in pixels) of the positions of the stellar objects with respect to those of the reference image. Once the centres of all the stars in all the images are identified, the code carries out a sequence of fully automatic steps to measure the instrumental magnitude of each star in each image by applying the method of aperture correction [\citep=howell] [\citep=stetson]. This method is performed by the program as follows:

1) Magnitudes of the selected bright and isolated stars are computed in two different ways:

Growth curves: it consists in measuring different magnitudes for the same star by applying larger and larger apertures each time. The final magnitude adopted for the star, m[formula], will be the one that remains unchanged in spite of the fact that the aperture size continues to increase.

Signal-to-noise ratio (SN) curves: it consists in determining the value of SN (see Section 2.1) for the same star by applying larger and larger apertures each time. The final magnitude adopted for the star, m[formula], will be that calculated considering the aperture size for which SN is maximum.

For the determination of both, m[formula] and m[formula], the code employs the phot task within the DAOPHOT package. The values of sky used to determine the stellar centre and full-width-half-maximum (FWHM) required by phot, are automatically measured by FOTOMCAp in the surrounding area of each star and considering the brightest stars in the field, respectively. The sky ring inner radius (annulus) is computed as the selected aperture size plus 5 pixels, its thickness (dannulus) is fixed in 5 pixels and the sky level value inside it is calculated by the algorithm MODE (see Section 4).

2) For each one of these i-stars, the program computes the [formula]m[formula]=(m[formula] -  m[formula])[formula] difference, and for every image obtains a [formula]m value calculated as the median of the [formula]m[formula]. The [formula]m value determined for a given image constitutes the aperture correction for that image.

3) Finally, the instrumental magnitude, m[formula], of every star in the field is obtained as m[formula]=m[formula]+[formula]m for each image, where m[formula] is computed as we mentioned in 1). The adopted errors are those computed by the phot task.

Once FOTOMCAp stops running, it creates three files: one containing relevant information, including the instrumental magnitudes and errors of all the stars in each image, and the other two with the sky level and FWHM values measured for all the images.

Determination of SN

The code automatically computes the SN through the expression given by [\cite=merline],

where [formula] is the total number of photons collected from the star inside the [formula] pixels that constitute the used aperture. NS, ND and NR are the photons per pixel coming from the sky, the dark current, and the readout noise, respectively. In this equation it is assumed that the sky has been estimated over an annulus covering nB pixels. The ÏƒS term represents the contribution from the atmospheric scintillation given by [\cite=dravins],

where X is the airmass, h the observatory altitude in km, D the diameter of the telescope in cm, and [formula] is the exposure time in seconds.

Comparison with the FOTOMCC code

FOTOMCC [\citep=petrucci2013] [\citep=petrucci2015] is a program written in IRAF language, developed to obtain high-precision light curves. Unlike FOTOMCAp, FOTOMCC determines instrumental magnitudes only employing the technique of growth curves. In Figure 1, we show the light curve of the same planetary transit obtained with the FOTOMCAp (circles) and FOTOMCC (squares) codes. It is important to mention that the differential magnitudes were determined, in both cases, following the procedure described in [\cite=petrucci2013].

In Table 1, we present the standard deviation ([formula]), useful number of images (N[formula]), and computer time employed to carry out the photometry (T[formula]) of the planetary transit obtained with the two codes. The comparison between these values indicates that, in several important aspects, FOTOMCAp considerably improves the results that are obtained with FOTOMCC. For example we can mention an increase in the number of useful images to construct the light curve and a significant decrease in the standard deviation. The only drawback is that the FOTOMCAp code requires up to four times more computing time than FOTOMCC.

Comparison between the algorithms to determine the stellar centre and flux, and the sky level value

The phot task, used to measure instrumental magnitudes, has different algorithms to accurately determine the stellar centre location, to compute the star's flux, and to calculate the background sky value. To establish the most precise algorithm, we compared in each case the standard deviations ([formula]) of the resulting light curves for a bright star and for a faint one (Table 2). Both objects belong to the same field that the star presenting the planetary transit shown in Figure 1.

As it can be seen, the differences between the values of [formula] are at most ~   0.2 mmag for the brightest stars and as much as ~   7 mmag for the faintest ones. However, it is important to notice that for the faint stellar objects these differences appear when the sky value is fitted by the CONSTANT algorithm. If we exclude the results obtained with this algorithm, the differences between the values of [formula] are at most ~   3 mmag. Taking into account that what the CONSTANT option does is to fix the sky to a value given by the user, which in this case is the mean of the values of sky automatically measured by FOTOMCAp, this result points out the need of using more complex methods to fit the background level when precise light curves are expected for faint stars.

These results would indicate that, except for the CONSTANT algorithm to determine the sky value, the rest of the algorithms used to center the star, to calculate the stellar flux, and to measure the sky background level would not have a significant influence on the computed instrumental magnitudes.

Conclusions

In this contribution we present a new quasi-automatic code, FOTOMCAp, developed in IRAF language. The purpose of this code is to measure instrumental magnitudes of several stars that belong to the same field, by using the method of aperture correction. Our results indicate that FOTOMCAp not only allows to compute light curves with standard deviations smaller than the ones obtained with the FOTOMCC program, but also permits to employ a larger number of images than the one used in our previous code. The only noticeable drawback is that the computation time used by FOTOMCAp is ~   4 times larger than the one used by FOTOMCC. However, about this last point, we are currently working to improve the code efficiency and, in that way, significantly reduce the internal calculation time.