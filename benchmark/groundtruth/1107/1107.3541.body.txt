Evaluation of servo, geometric and dynamic error sources on five axis high-speed machine tool.

Introduction

High speed machining is known to reduce machining time and improve surface quality, due to its particular cutting process [\cite=lave:2008]. The ability to control the tool orientation with respect to the workpiece also leads to productivity improvements.

The manufacturing process includes several steps. First, the part to machine, generally described by a digital model, is used to generate the appropriate tool path for machining via a computer-aided machining software. This step generally comes with approximations in the part geometry: a complex shape can be interpolated and discretized, leading to differences between the generated tool path and the numerical model of the part.

The post processing of the computer-aided machining file is required to convert the tool path into CNC commands. The tool path, originally described in the workpiece coordinate system (WCS) must be transformed in the joint coordinate system (JCS). This inverse kinematic transformation is most often performed during the post processing or sometime directly calculated by the NC-unit, but in any case, approximations may occur [\cite=lave:2008] [\cite=lave-tofo:2008].

Then, the NC-unit interpolates the given tool path expressed in the JCS to provide synchronous and dynamically admissible input for the machine drives. Each machine axis is subject to follow-up errors, leading to orientation and position errors of the tool [\cite=lave:2008].

The machine structure, in its quasi-static state, suffers from link and motion errors causing position and orientation errors of the tool [\cite=abba:2002] [\cite=knap:2009] [\cite=zarg:2009]. Moreover, thermal variations of the machine is another source of errors [\cite=schm:2008].

When programmed feed rate and actual velocity increase, as is usual during the high-speed machining process, the dynamic solicitations of the structure become higher because of the acceleration of the different parts of the machine. This may result in some alterations of the machine geometry, causing further tool position and orientation errors [\cite=alti:2005] [\cite=cano:2008].

Finally, the forces appearing during the cutting process lead to tool deflection, causing another source of machined surface location error [\cite=schm:2008].

Schmitz et al. compared the contributions of the geometric, thermal, controller and cutting forces errors to inaccuracies on a three-axis geometry, using different methods and instruments to measure and evaluate the respective contributions at different programmed feed rates [\cite=schm:2008]. Zhu et al. identified the repeatable errors of machine tool using B-spline models using a cross-grid scale system [\cite=Zhu2010]. Ibaraki et al. identified kinematic errors of a five axis machine tool from geometric errors of finished workpieces and compared the results to ball bar measurements [\cite=Ibaraki2010]. Bringmann and Knapp measured the relative tool center point (TCP) deviations between a sphere and a nest of four linear probes to calibrate a five axis machine tool [\cite=knap:2006]. Erkan and Mayer used the machine own touch trigger probe to measure a set of sphere of uncalibrated relative position to calibrate the machine and assess its positioning performance [\cite=Erkan2010]. Finally, Schwenke et al. provide a comprehensive overview of other measurement method to identify machine tool error in [\cite=Schwenke2008].

A method to evaluate the contributions of error sources to the Cartesian volumetric errors at the tool center point of a five axis machine tool at different programmed feed rates is described in this paper. The Cartesian volumetric errors are defined as the three components of the vector from the theoretical position of the TCP relative to the workpiece frame to its actual position. They are decomposed into the contribution of three error sources:

the effect of follow-up errors of the axis drives, later called contouring errors and written [formula];

the quasi-static geometric errors of the machine, which include link and motion errors and thermal drift, written [formula];

the dynamic geometric errors, resulting from the machine structure deflection under dynamic load, and written [formula].

The evaluation of those three error sources can help quantifying the relative impact of dynamic errors to the total volumetric errors, and the relevance of an associated model for corrective actions.

The paper begins with a presentation of the principle of the method is presented. Then, the mathematical models and the hypothesis drawn to evaluate each error source is developed. The experimental setup is described and finally, the results gathered from low to high speed motion are given and discussed.

Principle of the method

The nominal position of the tool center point relative to the workpiece is evaluated with the nominal direct kinematic transformation (DKT) of the machine fed with the controller inputs of the machine.

The actual position of the tool relative to the workpiece is measured with a non-contact sensor called CapBall, developed in house [\cite=zarg:2009], which provides the position of a ball mounted on the machine table relative to the TCP.

The difference between the nominal and the actual position of the tool relative to the workpiece, pictured on Fig. [\ref=fig:figure_machine], is due to the servo-errors of each axis of the machine and to all the geometric defects of the machine structure. This difference corresponds to the sum of [formula], [formula] and [formula], respectively the contouring error, the quasi-static geometric error and the dynamic geometric error.

The contouring error [formula] can be evaluated by recording the machine controller inputs and encoder actual values and comparing the relative position of the tool and the workpiece from the two points of view.

At low velocity, the dynamic geometric errors [formula] can be considered negligible because the dynamic load is low with respect to the usual high stiffness of machines. Thus, once contouring errors have been accounted for, the remaining errors measured at a low programmed feed rate can be defined as the quasi-static geometric errors [formula].

Finally when the programmed feed rate and the machine velocity increase, alterations of the machine structure under dynamic load cause the dynamic geometric errors [formula]. They can be evaluated by measuring the total geometric errors along a single trajectory at different programmed feed rates and removing the contouring error and quasi-static geometric error contributions.

Model for error contributions

Decomposition of the total errors

During a measurement sequence, n points, equally distributed, are recorded on each of the three channels of the CapBall.

The CapBall readings provide the values of the 3 components of the measured difference between Pt - the actual tool center point - and Pw - the actual center of the master ball mounted on the machine table -, written [formula] for each of the n recorded points (see Fig. [\ref=fig:figure_machine]):

[formula]

The results are gathered in a n  ×  3 matrix written [formula], as shown in eq.[\eqref=eq:delta_chi]:

[formula]

where [formula] is the CapBall reading for k-th point of the trajectory. The effect of the master ball and sensing head set-up positioning errors on volumetric errors are previously identified with the method described in [\cite=zarg:2009] [\cite=ando:2011] and removed from [formula].

The direct kinematic transformation (DKT) associated with the nominal machine geometry and the five axis controller inputs allows to calculate:

the position of Pt,nom - the nominal TCP - relative to the machine frame, considering the machine at its nominal geometry;

the position of Pw,nom - the nominal master ball center - also relative to the machine frame and also considering the machine with no geometric defect.

The difference of position between those two points can be expressed as [formula] calculated with the axis controller inputs (see Fig. [\ref=fig:figure_machine] and eq.[\eqref=eq:def_tau_nom]).

[formula]

[formula]

The nominal difference matrix [formula] - calculated from the controller inputs - is formed as described in eq.[\eqref=eq:chi_nom].

[formula]

Then, the difference between [formula] and [formula] expresses the effect of the contouring error, the quasi-static geometric error and the dynamic geometric error, as explicited in Fig. [\ref=fig:figure_principe] and eq.[\eqref=eq:contributions_delta_chi]:

[formula]

Contouring error

The actual effect of follow-up errors on Cartesian volumetric errors is defined by the contouring error ε, which is the orthogonal deviation of the actual tool path with respect to the controller inputs tool path in the part coordinate system [\cite=senc:2009-1]. The difference between Cartesian follow-up error and contouring error is schematically depicted in Fig. [\ref=fig:figure_contouring]: in case 1, the follow-up errors along x and y are smaller than in case 2, but the resulting contouring error ε1 is higher than ε2.

The difference [formula] is calculated for each point, considering the direct kinematic transform of the machine at its nominal geometry and the encoder values:

[formula]

[formula]

The encoder actual values volumetric difference matrix is built by the same process as in eq.[\eqref=eq:chi_nom]:

[formula]

The contouring error is evaluated by computing the difference between the nominal volumetric difference matrix [formula] and the encoder actual values volumetric difference matrix [formula].

The controller input signals must be synchronised with the encoders actual values to evaluate the effect of the follow-up errors on the volumetric errors at the tool tip without taking into account the delay introduced by the recording process of the axis controllers signals. The recordings performed show that the delay between encoder signals and controller inputs signals was 18  ms regardless of the programmed feed rate F. The encoder volumetric difference matrix [formula] is obtained by bringing backward the encoder values by 18  ms. The synchronised controller inputs and encoders volumetric errors are plotted on Fig. [\ref=fig:synchro_delta_f].

The contouring error along the experimental trajectory is given by eq.[\eqref=eq:delta_f]:

[formula]

where [formula] has a n  ×  3 size, representing the contouring error expressed in the machine frame.

Combining eqs.[\eqref=eq:contributions_delta_chi] and [\eqref=eq:delta_f] allows to express the quasi-static geometric error and the dynamic geometric error as the difference of the recorded signals using eq.[\eqref=eq:contrib_geo]:

[formula]

Quasi-static geometric errors

Definition

The quasi-static geometric error [formula] is defined as the geometric error independent of the machine velocity. It is decomposed into three sources:

the link errors that represents the axis to axis location errors of the machine;

the motion errors of each axis;

the thermal drift of the machine.

Consequently, the quasi-static geometric error is written as:

[formula]

where [formula], [formula] and [formula] are respectively the contribution of the link errors, the motion errors and the thermal drift.

Link errors

Mir et al. proposed a model to express the effect of axis-to-axis link errors on volumetric errors [\cite=abba:2002]. In this model, the link errors for a five axis machine tool are described by a set of eight geometric errors of the machine structure. For the example in Fig. [\ref=fig:schema_defauts_machine], the link errors are:

δγY, the out-of-squareness between X and Y;

δαZ, the out-of-squareness between Y and Z;

δβZ, the out-of-squareness between X and Z;

δβA, the tilt of A around y;

δγA, the tilt of A around z;

δαC, the tilt of C around x;

δβC, the tilt of C around y;

δyC, the offset of A relative to C in y.

They are gathered in an array written [formula]:

[formula]

The model is based on a Jacobian principle. The volumetric errors due to the eight link errors of the machine at a pose k, written as a three components column vector [formula], is given by eq.[\eqref=eq:machine_error]:

[formula]

where [formula] is the link errors Jacobian matrix expressed at a pose k. More details are available in [\cite=abba:2002] [\cite=zarg:2009]. Zargarbashi and Mayer described a method using CapBall data to identify the eight machine errors [\cite=zarg:2009] [\cite=ando:2011]. This method is also used here to identify the eight parameters of the model.

Then, for each known pose of the machine, corresponding to the encoder actual values, the link errors Jacobian matrix [formula] and then [formula] are calculated, leading to the expression for the contributions of the link errors [formula] (eq.[\eqref=eq:def_delta_chi_l]):

[formula]

where [formula] has a n  ×  3 size, representing the three Cartesian components of the modelled contribution of the link errors to the volumetric errors at each point along the trajectory.

Motion errors

A reference thermal state of the machine, in which the value of the drift is considered to be zero, must be chosen for a test at low programmed feed rate. Then, the portion of measured errors during this test not explained by the link errors is calculated by eq.[\eqref=eq:residus] and is attributed to the motion errors and local dynamic errors.

[formula]

In [\cite=knap:2009], Bringmann and Knapp proposed a Fourier series to model the motion errors of a link. Slamani et al. proposed a polynomial model for motion errors in [\cite=slam:2009]. In both cases the effects of motion errors are defined by continuous and smooth mathematical functions.

In order to evaluate the volumetric contribution of motion errors, a polynomial model is used. The only aim of this model is to locally predict the effect of the five axes motion errors on volumetric errors along the experimental trajectory to subtract it from the measured volumetric errors. The polynomial method proved to be easier to implement while providing satisfactory results.

The dynamic geometric error proved to be negligible at a low programmed feed rate (compared to link and motion errors), and they are visible only locally along the trajectory, as depicted in Fig. [\ref=fig:delta_chi_p].

A normalised path parameter [formula] is created to describe the experimental trajectory. It has n linearly distributed components, from 0 for the first point to 1 for the last point. The residual errors matrix is curve-fitted with polynomial functions of [formula]. The approximation leads to 3 identified polynomials [formula], [formula] and [formula]. The applied polynomial curve fitting leads to a filtering of local dynamic errors and measurement noise.

Experimental results show that, for the machine tested, 20 was a suitable value for the degree of the polynomial. Below 20, the curve fitting did not represent the residual errors well, and above 20, some unexpected oscillations appeared. The model predicted contribution of motion errors is compared to actual measurement in Fig. [\ref=fig:delta_chi_p].

The contributions of motion errors to volumetric errors [formula] are modelled in eq.[\eqref=eq:delta_chi_m]:

[formula]

where tn,k is the k-th component of the normalised path parameter.

The main weakness of this method is to compute motion error contributions based on the time instead of the actual pose of the machine at each point. However, the small differential rate of the contributions of the motion errors reduces the effect of the approximation used.

Thermal drift

Even if a warm-up is performed and care is taken to favour the thermal stability of the machine, a small thermal drift can be present.

As the execution of an experimental trajectory can take less than 15  s, it can be considered as instantaneous compared to the movement of the sensing head due to thermal drift. From that point of view, the effect of the thermal drift on the volumetric errors can be modelled as an offset from the reference thermal state on the measured volumetric errors. For each test, this offset is given by the mean value of the difference between the measured deviation [formula] and the encoder only prediction with a nominal model, the modelled link errors and the motion errors contributions, as expressed in eq.[\eqref=eq:offset]:

[formula]

where [formula] is the i-th line of the matrix [formula].

Finally, the drift, defined as constant for all the measurement point of a test is expressed by a n  ×  3 matrix [formula], composed of n lines equal to [formula]:

[formula]

Dynamic geometric errors

The dynamic geometric errors are here defined as the additional errors occurring when programmed feed rate, and so dynamic forces on the machine structure, increases. The dynamic errors result from varying alterations of the machine components under dynamic forces such as deflection of the machine structure.

Eqs.[\eqref=eq:contributions_delta_chi] and [\eqref=eq:delta_{qs}] allow to express the dynamic geometric errors [formula] as the contribution that does not show at low speed, in eq.[\eqref=eq:delta_d]:

[formula]

Experimental setup and conditions

Machine tool

This study was carried out on a Huron KX8-five five axis machine tool depicted in Fig. [\ref=vue_machine]. This machine has a WCAYFXZT structure, with a 45-degree-tilted A rotary axis. It is equipped with a Siemens Sinumerik 840D Powerline numerical command unit. The NC unit allows the recording of system variables such as axis controller inputs and encoder actual values for each axis (X,Y,Z,A and C). The machine documentation specifies that both axis controller inputs and encoder actual values already include backlash compensations [\cite=doconweb-variables], so this potential source of error is not included in this study.

Previous tests show that the axis controller inputs remain the same for each execution of a program. Thus, the recording of controller inputs can be performed separately.

The encoder actual position and the CapBall measurements are recorded together during the execution of trajectory .

Finally, all 10 channels (5 for the controller input and 5 for the encoder actual values) are gathered.

The NC cycle time is 3  ms and the sampling frequency of the CapBall is 10  kHz. To accurately synchronise and compare all the signals, the 10 NC signals are linearly interpolated at 10  kHz. A point is added at the beginning of the experimental trajectory to provide a tag dedicated to synchronisation of all signals together. More details are given at the end of subsection [\ref=par:trajectory].

External measuring instrument

The CapBall consists of a precision master ball mounted on the table and a sensing head fitted with three capacitive sensors, mounted in a tool holder in the spindle (see Fig. [\ref=vue_machine]).

The three capacitive sensors axes are nominally orthogonal to each other and intersecting in one point called Pt, chosen as the virtual TCP. This forms an orthogonal measurement frame.

The capacitive sensors are pre-calibrated for the spherical target using a set of three high precision linear stages. The response non-linearity is kept under 0.5% as long as the eccentricity is kept within ±  300  μm and the distance between the sensor and the ball is in a ±  300  μm range centred on the position at which the sensor gives a 0 Volt signal. The machine is programmed to keep the center of the master ball Pw close to Pt to avoid exceeding the measurement range of the sensors. In this range, standard type A uncertainty on the sensors output has been evaluated below 0.4  μm [\cite=ando:2011].

The spindle orientation is regulated to keep the sensing head orientation constant relative to the machine coordinate system - or machine frame - [formula] (Fig. [\ref=vue_machine]).

To express the position of Pt relative to Pw in the machine tool frame, the orientation of the sensors axes are calibrated. Then, the position of Pt relatively to Pw can be projected in the machine tool frame, to express [formula].

The sensing head described in [\cite=zarg:2009] was completely re-designed to significantly increase its stiffness and to ensure negligible displacement of the sensors during a measurement under dynamic solicitations in the maximum operating range of the machine tool. The master ball base is a 40  mm diameter steel bar screwed to the machine table via a solid post (Fig. [\ref=vue_machine]).

The sensors readings are acquired trough a LABView application. All the computation are implemented in MATLAB programs.

Experimental trajectory

To evaluate the contributions of the contouring, quasi-static and dynamic errors at different feed rates, an experimental trajectory is chosen to provide several characteristics.

It must not last longer than 15 seconds when executed at the lowest programmed feed rate (i.e. 1000  mm / min), in order to avoid exceeding the NC unit recording buffer size. This constraint reduces the maximum length of the trajectory, forbidding performing standard tests as Schmitz et al. did in [\cite=schm:2008].

The motion of the master ball results from the rotary axis motion so its path is a complex curve. As the sensing head motion was programmed with linear interpolation, a resulting programmed difference of position between Pw and Pt appears. The maximum admissible difference was chosen as 100  μm in each direction of the machine frame.

The experimental trajectory - with a nearly square corner - was chosen to provide sizeable geometric discontinuities which require accelerations of several axes. This is the solution chosen to generate a large range of dynamic loads while the programmed feed rate varies. The chosen experimental trajectory is described for each axis as a function of a normalised parameter u varying from 0 to 1 in Fig. [\ref=trajectoire_5x]. This parameter represents the linearly scaled curvilinear abscissa along the trajectory. The trajectory, as perceived in the coordinate system attached to the Y-stage, is also depicted. The trajectory is described by 17 linear segments (programmed with G01 blocks). The linear interpolation format leads to acceleration peaks at the transition between each segment, as shown in Fig. [\ref=fig:essai6].

The motion of each axis is programmed with linear interpolation, and all the axes are synchronised (FGROUP(X, Y, Z, A, C)). The machine is commanded in joint space (TRAFOOF option)to provide the sought dynamic solicitations. To avoid critical speed decreasing at the corner formed by the nominal path at each block transition, a contouring option is used, allowing rounding the corners with an axial tolerance set at 10  μm.

The trajectory is run at six different programmed feed rates F, geometrically distributed from 1  000  mm / min to 18  896  mm / min.

Results

Mean value of the norm

The mean percentage value of the norm along the experimental trajectory, called δk,% for the source k, is used to compare the contributions of each source of error and is calculated as follows:

[formula]

where [formula] is the i-th line of the matrix [formula], and k can be c for contouring errors, qs for quasi-static geometric errors and d for dynamic errors. Thus, δk,% gives the mean proportion of the total error due to the source k along the trajectory. The repartition of the error sources for the six tests is given in Table 1.

For the geometric errors, the distinction is made between the three identified sources. The experiments were carried out with deactivated compensation tables, avoiding any effect of software compensation of the link and motion errors. In an industrial context, the effect of link errors can be compensated, as it is a model-based calculated contribution.

The increasing relative impact of the thermal drift errors (see Table 1) may not be related to the increasing feed rate, but the drift is slowly increasing from test to test while the thermal condition are getting away of the reference thermal state. Moreover, the effect of the thermal drift observed during this series of tests is not reflecting actual machining conditions because the spindle is not running but only regulating its angular position. More sizeable errors can be expected under heavier spindle use.

Table 1 also shows the relative importance of the quasi-static geometric errors, compared to the two other sources for the small feed rates. As expected, the summed contributions of the contouring errors and the dynamic errors are increasing from 1.7  % to 14.3  % for programmed feed rate of 1  000  mm / min and 18  896  mm / min respectively.

Maximum errors

The ISO standards on geometric specifications [\cite=iso_gps] generally define tolerance zones in which all the machined surface must be located. Considering this, the most penalising errors are the maximum errors.

The maximum errors |δ|max of a contribution [formula] are defined by the maximum absolute value among the terms of each column [formula], [formula] and [formula] of [formula] (eq.[\eqref=eq:definition_max]).

[formula]

Table 2 gives the maximum errors for the quasi-static geometric errors along the experimental trajectory. The maximum drift errors given are the maximum observed during the seven tests. Also, the effect of link errors depends on the pose of the machine, and the maximum error can be calculated offline for any tool path, and can be higher than the one observed in this study for other points in the working volume of the machine.

Table 3 shows the evolution of the contributions of the contouring and dynamic errors with the programmed feed rate. The dynamic errors are not negligible, particularly when the programmed feed rate is over 10  000  mm / min. Even for the first test at F = 1  000  mm / min, dynamic errors occurred, but as shown in Fig. [\ref=fig:essai1], only locally at the sharp corner of the experimental trajectory. The higher the feed rate, the higher the dynamic errors magnitude. As the feed-rate increases Fig. [\ref=fig:essai6] shows that the dynamic errors also increase.

Contributions along the trajectory

Fig. [\ref=fig:essai1] and Fig. [\ref=fig:essai6] are two examples of the calculated contributions of [formula], [formula] and [formula] along the experimental trajectory, respectively for the first and the sixth test. The acceleration of each axis is plotted to show that the contouring errors and dynamic errors can, up to a certain point, be related to the acceleration.

The block transition extracted from the NC unit is also plotted. The 17 linearly interpolated segments of the trajectory, previously mentioned in §[\ref=par:trajectory], are visible on those figures. The expected acceleration peaks, which are related to the block transitions, are visible in Fig. [\ref=fig:essai6]. Those acceleration peaks are responsible for the sudden appearance of dynamic loads, themselves related to dynamic errors. In the conditions of those experiments, it shows that the machine geometry is affected by accelerations mainly due to the linear interpolation format. The peak-to-peak magnitude of the resulting dynamic errors is higher than 5  μm along the [formula] direction.

The corner visible near the middle of the trajectory in Fig. [\ref=trajectoire_5x] requires high acceleration of several axes, visible in Fig. [\ref=fig:essai1] and Fig. [\ref=fig:essai6]. The high dynamic load generated on purpose results in visible dynamic geometric errors. Therefore, Fig. [\ref=fig:essai6] shows that the machine accuracy is not equally affected in all directions. For instance, high acceleration of the X-axis seems to have little effect on dynamic errors according to Fig. [\ref=fig:essai6].

Root mean square of the dynamic errors

The root mean square value of the dynamic errors along the trajectory in each Cartesian direction are given in Table 4. Fig. [\ref=fig:rms_deltad] shows the evolution of δd,rms as a function of F on a logarithmic plot. The dashed lines have equations of the form given by eq.[\eqref=eq:model_rms].

[formula]

The values of κ and N are obtained by curve fitting for each error and each direction. The aim of the curve fitting is not to propose a general model for dynamic RMS errors evolution, but only to notice a particular result for the experimental conditions of this work. As the κ and N values depend on the experimental trajectory, those results can not lead to general conclusion about the performance of the machine in terms of dynamic stiffness, but it suggests a new performance indicator under dynamic load with a standard trajectory designed for this purpose.

Conclusion

The high-speed machining context requires high accelerations from the machine. Under those dynamic loads, the machine structure may no longer follow a rigid body behaviour. The new method presented in this paper allows to measure the volumetric error at the tool tip, and to evaluate the contribution of the dynamic geometric errors.

The experiments at high programmed feed rates have been made possible by the use of a non-contact measuring instrument: the CapBall. The CapBall was re-designed to increase its stiffness for more reliable measurement under high dynamic loads.

The evaluation of the respective magnitude of the contouring errors, the quasi-static geometric errors and the dynamic geometric errors, using the mean values of the norm or the maximum errors, quantifies the relative impact of the dynamic errors, which can reach nearly 5% of the total volumetric error, considering the mean value of the norm.

Furthermore, the study of the root mean square values of the errors shows that in this particular case, the evolution of the RMS errors with respect to the programmed feed rate can be approximated by a logarithmic law.

Finally, the main interest of this experimental work is to propose a method to evaluate dynamic errors directly at the tool tip. Even if the method can only be applied on five - or more - axis machine tool, due to the close kinematic chain principle, it can be a powerful mean to validate models for the dynamic behaviour of the structure with in-situ measurement. It has been shown that the linear interpolation generates acceleration and dynamic errors peaks. The influence of the NC interpolation and controller command law on dynamic errors can also be investigated with this method.

Acknowledgements

This work was partially funded with a Discovery Grant from the National Science and Engineering Research Council of Canada and conducted on equipment purchased with a grant from the Canadian Foundation for Innovation.