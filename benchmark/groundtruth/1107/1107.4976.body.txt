Generalized Beta Mixtures of Gaussians

Introduction

Penalized likelihood estimation has evolved into a major area of research, with [formula][\cite=tibshirani1996] and other regularization penalties now used routinely in a rich variety of domains. Often minimizing a loss function subject to a regularization penalty leads to an estimator that has a Bayesian interpretation as the mode of a posterior distribution [\cite=figo03] [\cite=griffin2007] [\cite=armagan09a] [\cite=armagan11barxiv], with different prior distributions inducing different penalties. For example, it is well known that Gaussian priors induce [formula] penalties, while double exponential priors induce [formula] penalties [\cite=figo03] [\cite=park2008] [\cite=hans2009] [\cite=armagan09a]. Viewing massive-dimensional parameter learning and prediction problems from a Bayesian perspective naturally leads one to design new priors that have substantial advantages over the simple normal or double exponential choices and that induce rich new families of penalties. For example, in high-dimensional settings it is often appealing to have a prior that is concentrated at zero, favoring strong shrinkage of small signals and potentially a sparse estimator, while having heavy tails to avoid over-shrinkage of the larger signals. The Gaussian and double exponential priors are insufficiently flexible in having a single scale parameter and relatively light tails; in order to shrink many small signals strongly towards zero, the double exponential must be concentrated near zero and hence will over-shrink signals not close to zero. This phenomenon has motivated a rich variety of new priors such as the normal-exponential-gamma, the horseshoe and the generalized double Pareto [\cite=griffin2007] [\cite=hoggart08] [\cite=armagan09a] [\cite=Carvalho2009] [\cite=polson2009] [\cite=carvalho2010] [\cite=griffin2010] [\cite=armagan11barxiv].

An alternative and widely applied Bayesian framework relies on variable selection priors and Bayesian model selection/averaging [\cite=mitchell1988] [\cite=george93] [\cite=johnstone2004] [\cite=ishwaran2005]. Under such approaches the prior is a mixture of a mass at zero, corresponding to the coefficients to be set equal to zero and hence excluded from the model, and a continuous distribution, providing a prior for the size of the non-zero signals. This paradigm is very appealing in fully accounting for uncertainty in parameter learning and the unknown sparsity structure through a probabilistic framework. One obtains a posterior distribution over the model space corresponding to all possible subsets of predictors, and one can use this posterior for model-averaged predictions that take into account uncertainty in subset selection and to obtain marginal inclusion probabilities for each predictor providing a weight of evidence that a specific signal is non-zero allowing for uncertainty in the other signals to be included. Unfortunately, the computational complexity is exponential in the number of candidate predictors (2p with p the number of predictors).

Some recently proposed continuous shrinkage priors may be considered competitors to the conventional mixture priors [\cite=ishwaran2005] [\cite=Carvalho2009] [\cite=carvalho2010] [\cite=griffin2010] yielding computationally attractive alternatives to Bayesian model averaging. Continuous shrinkage priors lead to several advantages. The ones represented as scale mixtures of Gaussians allow conjugate block updating of the regression coefficients in linear models and hence lead to substantial improvements in Markov chain Monte Carlo (MCMC) efficiency through more rapid mixing and convergence rates. Under certain conditions these will also yield sparse estimates, if desired, via maximum a posteriori ([formula]) estimation and approximate inferences via variational approaches [\cite=jordan99] [\cite=tipping01] [\cite=bishop01] [\cite=figo03] [\cite=griffin2007] [\cite=armagan09a] [\cite=armagan11barxiv].

The class of priors that we consider in this paper encompasses many interesting priors as special cases and reveals interesting connections among different hierarchical formulations. Exploiting an equivalent conjugate hierarchy of this class of priors, we develop a class of variational Bayes approximations that can scale up to truly massive data sets. This conjugate hierarchy also allows for conjugate modeling of some previously proposed priors which have some rather complex yet advantageous forms and facilitates straightforward computation via Gibbs sampling. We also argue intuitively that by adjusting a global shrinkage parameter that controls the overall sparsity level, we may control the number of non-zero parameters to be estimated, enhancing results, if there is an underlying sparse structure. This global shrinkage parameter is inherent to the structure of the priors we discuss as in [\cite=Carvalho2009] [\cite=carvalho2010] with close connections to the conventional variable selection priors.

Background

We provide a brief background on shrinkage priors focusing primarily on the priors studied by [\cite=Carvalho2009] [\cite=carvalho2010] and [\cite=griffin2007] [\cite=griffin2010] as well as the Strawderman-Berger (SB) prior [\cite=carvalho2010]. These priors possess some very appealing properties in contrast to the double exponential prior which leads to the Bayesian lasso [\cite=park2008] [\cite=hans2009]. They may be much heavier-tailed, biasing large signals less drastically while shrinking noise-like signals heavily towards zero. In particular, the priors by [\cite=Carvalho2009] [\cite=carvalho2010], along with the Strawderman-Berger prior [\cite=carvalho2010], have a very interesting and intuitive representation later given in ([\ref=horseshoe2]), yet, are not formed in a conjugate manner potentially leading to analytical and computational complexity.

[\cite=Carvalho2009] [\cite=carvalho2010] propose a useful class of priors for the estimation of multiple means. Suppose a p-dimensional vector [formula] is observed. The independent hierarchical prior for θj is given by

[formula]

for [formula], where N(μ,ν) denotes a normal distribution with mean μ and variance ν and C+(0,s) denotes a half-Cauchy distribution on [formula] with scale parameter s. With an appropriate transformation ρj = 1 / (1 + τj), this hierarchy also can be represented as

[formula]

A special case where φ = 1 leads to ρj  ~  B(1 / 2,1 / 2) (beta distribution) where the name of the prior arises, horseshoe (HS) [\cite=Carvalho2009] [\cite=carvalho2010]. Here ρjs are referred to as the shrinkage coefficients as they determine the magnitude with which θjs are pulled toward zero. A prior of the form ρj  ~  B(1 / 2,1 / 2) is natural to consider in the estimation of a signal θj as this yields a very desirable behavior both at the tails and in the neighborhood of zero. That is, the resulting prior has heavy-tails as well as being unbounded at zero which creates a strong pull towards zero for those values close to zero. [\cite=carvalho2010] further discuss priors of the form ρj  ~  B(a,b) for a > 0, b > 0 to elaborate more on their focus on the choice a = b = 1 / 2. A similar formulation dates back to [\cite=strawderman1971]. [\cite=carvalho2010] refer to the prior of the form ρj  ~  B(1,1 / 2) as the Strawderman-Berger prior due to [\cite=strawderman1971] and [\cite=berger1980]. The same hierarchical prior is also referred to as the quasi-Cauchy prior in [\cite=johnstone2004]. Hence, the tail behavior of the Strawderman-Berger prior remains similar to the horseshoe (when φ = 1), while the behavior around the origin changes. The hierarchy in ([\ref=horseshoe2]) is much more intuitive than the one in ([\ref=horseshoe1]) as it explicitly reveals the behavior of the resulting marginal prior on θj. This intuitive representation makes these hierarchical priors interesting despite their relatively complex forms. On the other hand, what the prior in ([\ref=horseshoe1]) or ([\ref=horseshoe2]) lacks is a more trivial hierarchy that yields recognizable conditional posteriors in linear models.

[\cite=griffin2007] [\cite=griffin2010] consider the normal-exponential-gamma (NEG) and normal-gamma (NG) priors respectively which are formed in a conjugate manner yet lack the intuition the Strawderman-Berger and horseshoe priors provide in terms of the behavior of the density around the origin and at the tails. Hence the implementation of these priors may be more user-friendly but they are very implicit in how they behave. In what follows we will see that these two forms are not far from one another. In fact, we may unite these two distinct hierarchical formulations under the same class of priors through a generalized beta distribution and the proposed equivalence of hierarchies in the following section. This is rather important to be able to compare the behavior of priors emerging from different hierarchical formulations. Furthermore, this equivalence in the hierarchies will allow for a straightforward Gibbs sampling update in posterior inference, as well as making variational approximations possible in linear models.

Equivalence of Hierarchies via a Generalized Beta Distribution

In this section we propose a generalization of the beta distribution to form a flexible class of scale mixtures of normals with very appealing behavior. We then formulate our hierarchical prior in a conjugate manner and reveal similarities and connections to the priors given in [\cite=johnstone2004] [\cite=griffin2007] [\cite=griffin2010] [\cite=Carvalho2009] [\cite=carvalho2010]. As the name generalized beta has previously been used, we refer to our generalization as the three-parameter beta (TPB) distribution.

In the forthcoming text Γ(.) denotes the gamma function, G(μ,ν) denotes a gamma distribution with shape and rate parameters μ and ν, W(ν,S) denotes a Wishart distribution with ν degrees of freedom and scale matrix S, U(α1,α2) denotes a uniform distribution over (α1,α2), (μ,ν,ξ) denotes a generalized inverse Gaussian distribution with density function [formula], and μ(.) is a modified Bessel function of the second kind.

The three-parameter beta (TPB) distribution for a random variable X is defined by the density function

[formula]

for 0 < x < 1, a > 0, b > 0 and φ > 0 and is denoted by (a,b,φ).

It can be easily shown by a change of variable x = 1 / (y + 1) that the above density integrates to 1. The kth moment of the TPB distribution is given by

[formula]

where [formula] denotes the hypergeometric function. In fact it can be shown that TPB is a subclass of Gauss hypergeometric (GH) distribution proposed in [\cite=armero94] and the compound confluent hypergeometric (CCH) distribution proposed in [\cite=gordy98].

The density functions of GH and CCH distributions are given by

[formula]

for 0 < x < 1 and 0 < x < 1 / ν, respectively, where (b,a) = Γ(a)Γ(b) / Γ(a + b) denotes the beta function and Φ1 is the degenerate hypergeometric function of two variables [\cite=gordy98]. Letting ζ  =  φ - 1, r = a + b and noting that [formula], ([\ref=gh]) becomes a TPB density. Also note that ([\ref=cch]) becomes ([\ref=gh]) for s = 1, ν = 1 and ζ = (1 - θ) / θ [\cite=gordy98].

[\cite=polson2009] considered an alternative special case of the CCH distribution for the shrinkage coefficients, ρj, by letting ν = r = 1 in ([\ref=cch]). [\cite=polson2009] refer to this special case as the hypergeometric-beta (HB) distribution. TPB and HB generalize the beta distribution in two distinct directions, with one practical advantage of the TPB being that it allows for a straightforward conjugate hierarchy leading to potentially substantial analytical and computational gains.

Now we move onto the hierarchical modeling of a flexible class of shrinkage priors for the estimation of a potentially sparse p-vector. Suppose a p-dimensional vector [formula] is observed where [formula] is of interest. Now we define a shrinkage prior that is obtained by mixing a normal distribution over its scale parameter with the TPB distribution.

The TPB normal scale mixture representation for the distribution of random variable θj is given by

[formula]

where a > 0, b > 0 and φ > 0. The resulting marginal distribution on θj is denoted by (a,b,φ).

Figure [\ref=fig1] illustrates the density on ρj for varying values of a, b and φ. Note that the special case for a = b = 1 / 2 in Figure [\ref=fig1](a) gives the horseshoe prior. Also when a = φ = 1 and b = 1 / 2, this representation yields the Strawderman-Berger prior. For a fixed value of φ, smaller a values yield a density on θj that is more peaked at zero, while smaller values of b yield a density on θj that is heavier tailed. For fixed values of a and b, decreasing φ shifts the mass of the density on ρj from left to right, suggesting more support for stronger shrinkage. That said, the density assigned in the neighborhood of θj = 0 increases while making the overall density lighter-tailed. We next propose the equivalence of three hierarchical representations revealing a wide class of priors encompassing many of those mentioned earlier.

If θj  ~  (a,b,φ), then 1) θj  ~  N(0,τj), τj  ~  G(a,λj) and λj  ~  G(b,φ). 2) θj  ~  N(0,τj), [formula] which implies that τj  /  φ  ~  β'(a,b), the inverted beta distribution with parameters a and b.

The equivalence given in Proposition 1 is significant as it makes the work in Section 4 possible under the TPB normal scale mixtures as well as further revealing connections among previously proposed shrinkage priors. It provides a rich class of priors leading to great flexibility in terms of the induced shrinkage and makes it clear that this new class of priors can be considered simultaneous extensions to the work by [\cite=griffin2007] [\cite=griffin2010] and [\cite=Carvalho2009] [\cite=carvalho2010]. It is worth mentioning that the hierarchical prior(s) given in Proposition 1 are different than the approach taken by [\cite=griffin2010] in how we handle the mixing. In particular, the first hierarchy presented in Proposition 1 is identical to the NG prior up to the first stage mixing. While fixing the values of a and b, we further mix over λj (rather than a global λ) and further over φ if desired as will be discussed later. φ acts as a global shrinkage parameter in the hierarchy. On the other hand, [\cite=griffin2010] choose to further mix over a and a global λ while fixing the values of b and φ. By doing so, they forfeit a complete conjugate structure and an explicit control over the tail behavior of π(θj).

As a direct corollary to Proposition 1, we observe a possible equivalence between the SB and the NEG priors.

If a = 1 in Proposition 1, then [formula]. If (a,b,φ) = (1,1 / 2,1) in Proposition 1, then [formula].

An interesting, yet expected, observation on Proposition 1 is that a half-Cauchy prior can be represented as a scale mixture of gamma distributions, i.e. if τj  ~  G(1 / 2,λj) and λj  ~  G(1 / 2,φ), then τ1 / 2j  ~  C+(0,φ1 / 2). This makes sense as τ1 / 2|λj has a half-Normal distribution and the mixing distribution on the precision parameter is gamma with shape parameter 1 / 2.

[\cite=carvalho2010] further place a half-Cauchy prior on φ1 / 2 to complete the hierarchy. The aforementioned observation helps us formulate the complete hierarchy proposed in [\cite=carvalho2010] in a conjugate manner. This should bring analytical and computational advantages as well as making the application of the procedure much easier for the average user without the need for a relatively more complex sampling scheme.

If θj  ~  N(0,τj), τ1 / 2j  ~  C+(0,φ1 / 2) and φ1 / 2  ~  C+(0,1), then θj  ~  (1 / 2,1 / 2,φ), φ  ~  G(1 / 2,ω) and ω  ~  G(1 / 2,1).

Hence disregarding the different treatments of the higher-level hyper-parameters, we have shown that the class of priors given in Definition 2 unites the priors in [\cite=johnstone2004] [\cite=griffin2007] [\cite=Carvalho2009] [\cite=carvalho2010] under one family and reveals their close connections through the equivalence of hierarchies given in Proposition 1. The first hierarchy in Proposition 1 makes much of the work possible in the following sections.

Estimation and Posterior Inference in Regression Models

Fully Bayes and Approximate Inference

Consider the linear regression model, [formula], where [formula] is an n-dimensional vector of responses, [formula] is the n  ×  p design matrix and [formula] is an n-dimensional vector of independent residuals which are normally distributed, [formula] with variance σ2.

We place the hierarchical prior given in Proposition 1 on each βj, i.e. βj  ~  N(0,σ2τj), τj  ~  G(a,λj), λj  ~  G(b,φ). φ is used as a global shrinkage parameter common to all βj, and may be inferred using the data. Thus we follow the hierarchy by letting φ  ~  G(1 / 2,ω), ω  ~  G(1 / 2,1) which implies φ1 / 2  ~  C+(0,1) that is identical to what was used in [\cite=carvalho2010] at this level of the hierarchy. However, we do not believe at this level in the hierarchy the choice of the prior will have a huge impact on the results. Although treating φ as unknown may be reasonable, when there exists some prior knowledge, it is appropriate to fix a φ value to reflect our prior belief in terms of underlying sparsity of the coefficient vector. This sounds rather natural as soon as one starts seeing φ as a parameter that governs the multiplicity adjustment as discussed in [\cite=carvalho2010]. Note also that here we form the dependence on the error variance at a lower level of hierarchy rather than forming it in the prior of φ as done in [\cite=carvalho2010]. If we let a = b = 1 / 2, we will have formulated the hierarchical prior given in [\cite=carvalho2010] in a completely conjugate manner. We also let σ- 2  ~  G(c0 / 2,d0 / 2). Under a normal likelihood, an efficient Gibbs sampler may be obtained as the fully conditional posteriors can be extracted: [formula], [formula], τj|βj,σ2,λj  ~  (a - 1 / 2,2λj,β2j  /  σ2), λj|τj,φ  ~  G(a + b,τj  +  φ), [formula], ω|φ  ~  G(1,φ + 1), where [formula], [formula], c* = (n + p + c0) / 2, [formula], [formula].

As an alternative to MCMC and Laplace approximations [\cite=tierney1986], a lower-bound on marginal likelihoods may be obtained via variational methods [\cite=jordan99] yielding approximate posterior distributions on the model parameters. Using a similar approach to [\cite=bishop01] [\cite=armagan09a], the approximate marginal posterior distributions of the parameters are given by [formula], [formula], τj  ~  (a - 1 / 2,2〈λj〉,〈σ- 2〉〈β2j〉), λj  ~  G(a + b,〈τj〉  +  〈φ〉), [formula], ω  ~  (1,〈φ〉 + 1), where [formula], [formula], [formula], c*  =  (n + p + c0) / 2, [formula], [formula], 〈σ- 2〉  =  c* / d*, 〈λj〉 = (a + b) / (〈τj〉  +  〈φ〉), [formula], 〈ω〉 = 1 / (〈φ〉 + 1) and

[formula]

This procedure consists of initializing the moments and iterating through them until some convergence criterion is reached. The deterministic nature of these approximations make them attractive as a quick alternative to MCMC.

This conjugate modeling approach we have taken allows for a very straightforward implementation of Strawderman-Berger and horseshoe priors or, more generally, TPB normal scale mixture priors in regression models without the need for a more sophisticated sampling scheme which may ultimately attract more audiences towards the use of these more flexible and carefully defined normal scale mixture priors.

Sparse Maximum a Posteriori Estimation

Although not our main focus, many readers are interested in sparse solutions, hence we give the following brief discussion. Given a, b and φ, maximum a posteriori (MAP) estimation is rather straightforward via a simple expectation-maximization (EM) procedure. This is accomplished in a similar manner to [\cite=figo03] by obtaining the joint MAP estimates of the error variance and the regression coefficients having taken the expectation with respect to the conditional posterior distribution of τ- 1j using the second hierarchy given in Proposition 1. The kth expectation step then would consist of calculating

[formula]

where β2(k - 1)j and σ2(k - 1) denote the modal estimates of the jth component of [formula] and the error variance σ2 at iteration (k - 1). The solution to ([\ref=expectation]) may be expressed in terms of some special function(s) for changing values of a, b and φ. b < 1 is a good choice as it will keep the tails of the marginal density on βj heavy. A careful choice of a, on the other hand, is essential to sparse estimation. Admissible values of a for sparse estimation is apparent by the representation in Definition 2, noting that for any a > 1, π(ρj = 1) = 0, i.e. βj may never be shrunk exactly to zero. Hence for sparse estimation, it is essential that [formula]. Figure [\ref=fig2] (a) and (b) give the prior densities on ρj for b = 1 / 2, φ = 1 and a = {1 / 2,1,3 / 2} and the resulting marginal prior densities on βj. These marginal densities are given by

[formula]

where (.) denotes the error function and [formula] is the incomplete gamma function. Figure [\ref=fig2] clearly illustrates that while all three cases have very similar tail behavior, their behavior around the origin differ drastically.

Experiments

Throughout this section we use the Jeffreys' prior on the error precision by setting c0 = d0 = 0. We generate data for two cases, (n,p) = {(50,20),(250,100)}, from [formula], for [formula] where [formula] is a p-vector that on average contains 20q non-zero elements which are indexed by the set A  =  {j:β*j  ≠  0} for some random q∈(0,1). We randomize the procedure in the following manner: (i) [formula], (ii) [formula], (iii) q  ~  B(1,1) for the first and q  ~  B(1,4) for the second cases, (iv) I(j∈A)  ~  (q) for [formula] where I(.) denotes the indicator function, (v) for j∈A, βj  ~  U(0,6) and for j∉A, βj = 0 and finally (vi) εi  ~  N(0,σ2) where σ  ~  U(0,6). We generated 1000 data sets for each case resulting in a median signal-to-noise ratio of approximately 3.3 and 4.5. We obtain the estimate of the regression coefficients, [formula], using the variational Bayes procedure and measure the performance by model error which is calculated as [formula]. Figure [\ref=fig3](a) and (b) display the median relative model error (RME) values (with their distributions obtained via bootstrapping) which is obtained by dividing the model error observed from our procedures by that of [formula] regularization (lasso) tuned by 10-fold cross-validation. The boxplots in Figure [\ref=fig3](a) and (b) correspond to different (a,b,φ) values where + signifies that φ is treated as unknown with a half-Cauchy prior as given earlier in Section 4.1. It is worth mentioning that we attain a clearly superior performance compared to the lasso, particularly in the second case, despite the fact that the estimator resulting from the variational Bayes procedure is not a thresholding rule. Note that b = 1 choice leads to much better performance under Case 2 than Case 1. This is due to the fact that Case 2 involves a much sparser underlying setup on average than Case 1 and that the lighter tails attained by setting b = 1 leads to stronger shrinkage.

To give a high dimensional example, we also generate a data set from the model [formula], for [formula], where [formula] is a 10000-dimensional very sparse vector with 10 randomly chosen components set to be 3, εi  ~  N(0,32) and xij  ~  N(0,1) for [formula]. This [formula] choice leads to a signal-to-noise ratios of 3.16. For the particular data set we generated, the randomly chosen components of [formula] to be non-zero were indexed by 1263, 2199, 2421, 4809, 5530, 7483, 7638, 7741, 7891 and 8187. We set (a,b,φ) = (1,1 / 2,10- 4) which implies that a priori [formula] placing much more density in the neighborhood of ρj = 1 (total shrinkage). This choice is due to the fact that n / p = 0.01 and to roughly reflect that we do not want any more than 100 predictors in the resulting model. Hence φ is used, a priori, to limit the number of predictors in the model in relation to the sample size. Also note that with a = 1, the conditional posterior distribution of τ- 1j is reduced to an inverse Gaussian. Since we are adjusting the global shrinkage parameter, φ, a priori, and it is chosen such that [formula], whether a = 1 / 2 or a = 1 should not matter. We first run the Gibbs sampler for 100000 iterations (2.4 hours on a computer with a 2.8 GHz CPU and 12 Gb of RAM using Matlab), discard the first 20000, thin the rest by picking every 5th sample to obtain the posteriors of the parameters. We observed that the chain converged by the 10000th iteration. For comparison purposes, we also ran the variational Bayes procedure using the values from the converged chain as the initial points (80 seconds). Figure [\ref=fig4] gives the posterior means attained by sampling and the variational approximation. The estimates corresponding to the zero elements of [formula] are plotted with smaller shapes to prevent clutter. We see that in both cases the procedure is able to pick up the larger signals and shrink a significantly large portion of the rest towards zero. The approximate inference results are in accordance with the results from the Gibbs sampler. It should be noted that using a good informed guess on φ, rather than treating it as an unknown in this high dimensional setting, improves the performance drastically.

Discussion

We conclude that the proposed hierarchical prior formulation constitutes a useful encompassing framework in understanding the behavior of different scale mixtures of normals and connecting them under a broader family of hierarchical priors. While [formula] regularization, or namely lasso, arising from a double exponential prior in the Bayesian framework yields certain computational advantages, it demonstrates much inferior estimation performance relative to the more carefully formulated scale mixtures of normals. The proposed equivalence of the hierarchies in Proposition 1 makes computation much easier for the [formula] scale mixtures of normals. As per different choices of hyper-parameters, we recommend that a∈(0,1] and b∈(0,1); in particular (a,b) = {(1 / 2,1 / 2),(1,1 / 2)}. These choices guarantee that the resulting prior has a kink at zero, which is essential for sparse estimation, and leads to heavy tails to avoid unnecessary bias in large signals (recall that a choice of b = 1 / 2 will yield Cauchy-like tails). In problems where oracle knowledge on sparsity exists or when p >  > n, we recommend that φ is fixed at a reasonable quantity to reflect an appropriate sparsity constraint as mentioned in Section 5.