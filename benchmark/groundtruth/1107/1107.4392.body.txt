Proposition Conjecture Corollary Lemma Definition Example

232D

Lower bounds for sumsets of multisets in [formula]

Introduction

Determining the number of elements in a particular abelian group that can be written as sums of given sets of elements is a topic that goes back at least two centuries. The most famous result of this type, involving the cyclic group [formula] of prime order p, was established by Cauchy in 1813 [\cite=Cauchy] and rediscovered by Davenport in 1935 [\cite=Dav1] [\cite=Dav2]:

Let A and B be subsets of [formula], and define A + B to be the set of all elements of the form a + b with a∈A and b∈B. Then #  (A + B)  ≥   min {p,  #  A  +    #  B  -  1}.

The lower bound is easily seen to be best possible by taking A and B to be intervals, for example. It is also easy to see that the lower bound of #  A  +    #  B  -  1 does not hold for general abelian groups [formula] (take A and B to be the same nontrivial subgroup of [formula]). There is, however, a well-known generalization obtained by Kneser in 1953 [\cite=Kne], which we state in a slightly simplified form that will be quite useful for our purposes (see [\cite=Nat] for an elementary proof):

Let A and B be subsets of a finite abelian group [formula], and let m be the largest cardinality of a proper subgroup of [formula]. Then [formula].

Given a sequence [formula] of (not necessarily distinct) elements of an abelian group [formula], a related result involves its sumset ΣA, which is the set of all sums of any number of elements chosen from A (not to be confused with A + A, which it contains but usually properly):

[formula]

(Note that we allow J to be empty, so that the group's identity element is always an element of ΣA.) When [formula], one can prove the following result by writing [formula] and applying the Cauchy-Davenport theorem inductively:

Let [formula] be a sequence of nonzero elements of [formula]. Then #  ΣA  ≥   min {p,k  +  1}.

This result can also be proved directly by induction on k, and in fact such a proof will discover why the order p of the cyclic group must be prime (intuitively, the sequence A could lie completely within a nontrivial subgroup). For a formal proof, see [\cite=DEF]. Again the lower bound is easily seen to be best possible, by taking [formula].

It is a bit misleading to phrase such results in terms of sequences, since the actual order of the elements in the sequence is irrelevant (given that we are considering only abelian groups). We prefer to use multisets, which are simply sets that are allowed to contain their elements with multiplicity. If we let mx denote the multiplicity with which the element x occurs in the multiset A, then the definition of ΣA can be written in the form

[formula]

where δxx denotes the group element [formula] obtained by adding δx summands all equal to x.

When using multisets, we should choose our notation with care: the hypotheses of such results tend to involve the total number of elements of the multiset A counting multiplicity, while the conclusions involve the number of distinct elements of ΣA. Consequently, throughout this paper, we use the following notational conventions:

|S| denotes the total number of elements of the multiset S, counted with multiplicity;

#  S denotes the number of distinct elements of the multiset S, or equivalently the number of elements of S considered as a (mere) set.

In this notation, Lemma [\ref=CD_pre_lemma] can be restated as:

Let A be a multiset contained in [formula] such that 0∉A. Then #  ΣA  ≥   min {p,|A|  +  1}.

The purpose of this paper is to improve, as far as possible, this lower bound for multisets contained in the larger abelian group [formula]. We cannot make any progress without some restriction upon our multisets: if a multiset is contained within a nontrivial subgroup of [formula] (of cardinality p), then so is its sumset, in which case the lower bound min {p,|A|  +  1} from Lemma [\ref=CD_lemma] is the best we can do. Therefore we restrict to the following class of multisets. We use the symbol [formula] to denote the identity element of [formula].

A multiset A contained in [formula] is called valid if:

[formula]; and

every nontrivial subgroup contains fewer than p points of A, counting multiplicity.

The exact number p in the second condition has been carefully chosen: any nontrivial subgroup of [formula] is isomorphic to [formula], and so Lemma [\ref=CD_lemma] applies to these nontrivial subgroups. In particular, any multiset A containing p - 1 nonzero elements of a nontrivial subgroup will automatically have that entire subgroup contained in its sumset ΣA, so allowing p nonzero elements in a nontrivial subgroup would always be "wasteful".

We believe that the following lower bound should hold for sumsets of valid multisets:

Let A be a valid multiset contained in [formula] such that p  ≤  |A|  ≤  2p - 3. Then #  ΣA  ≥  (|A| + 2 - p)p. In other words, if |A|  =  p + k with 0  ≤  k  ≤  p - 3, then #  ΣA  ≥  (k + 2)p.

It is easy to see that this conjectured lower bound would be best possible: if A is the multiset that contains the point (1,0) with multiplicity p - 1 and the point (0,1) with multiplicity k + 1, then the set ΣA is precisely [formula], which has (k + 2)p distinct elements. Conjecture [\ref=2d_conjecture] is actually part of a larger assertion (see Conjecture [\ref=any_d_conjecture]) concerning lower bounds for sumsets in [formula].

One of our results completely resolves the first two cases of this conjecture:

Let p be a prime.

If A is any valid multiset contained in [formula] with |A|  =  p, then #  ΣA  ≥  2p.

Suppose that [formula]. If A is any valid multiset contained in [formula] with |A|  =  p + 1, then #  ΣA  ≥  3p.

It turns out that proving part (b) of the theorem requires a certain amount of computation for a finite number of primes (see the remarks following the proof of the theorem in Section [\ref=thm_proofs_section]). Extending the conjecture to larger values of k would require, by our methods, more and more computation to take care of small primes p as k grows. However, we are able to establish the conjecture when p is large enough with respect to k, or equivalently when k is small enough with respect to p:

Let p be a prime, and let [formula] be an integer. If A is any valid multiset contained in [formula] with |A|  =  p + k, then #  ΣA  ≥  (k + 2)p.

A contrapositive version of Theorem [\ref=conjecture_true_for_k_small_in_terms_of_p] is also enlightening:

Let p be a prime, and let [formula] be an integer. Let A be a multiset contained in [formula] with |A|  =  p + k. If #  ΣA  <  (k + 2)p, then there exists a nontrivial subgroup of [formula] that contains at least p points of A, counting multiplicity.

Our methods of proof stem from two main ideas. First, we will obviously exploit the structure of [formula] as a direct sum of cyclic groups of prime order, within which we can apply the known Lemma [\ref=CD_lemma] after using projections. Section [\ref=direct_projects_section] contains several elementary lemmas in this vein (see in particular Lemma [\ref=sweep_to_the_left_lemma]). It is important for us to utilize the flexibility coming from the fact that [formula] can be decomposed as the direct sum of two subgroups in many different ways. Second, our methods work best when there exists a single subgroup that contains many elements of the given multiset; however, by selectively replacing pairs of elements with their sums, we can increase the number of elements in a subgroup in a way that improves our lower bounds upon the sumset (see Lemma [\ref=any_j_lemma]). These methods, which appear in Section [\ref=thm_proofs_section], combine to provide the proofs of Theorems [\ref=conjecture_true_for_k_tiny] and [\ref=conjecture_true_for_k_small_in_terms_of_p]. Finally, Section [\ref=conjecture_section] contains a generalization of Conjecture [\ref=2d_conjecture] to higher-dimensional direct sums of [formula], together with examples demonstrating that the conjecture would be best possible.

Sumsets in abelian groups and direct products

All of the results in this section are valid for general finite abelian groups and have correspondingly elementary proofs, although the last two lemmas seem rather less standard than the first few. In this section, [formula], [formula], and [formula] denote finite abelian groups, and e denotes a group's identity element.

Let [formula] be multisets in [formula], and set [formula]. For each 1  ≤  i  ≤  j, specify an element xi∈ΣBi, and set [formula]. Then ΣC  ⊆  ΣA.

For each 1  ≤  i  ≤  j, choose a submultiset Di  ⊆  Bi such that the sum of the elements of Di equals xi. By definition, every element y of ΣC equals the sum of the elements of some subset E of B0, plus [formula] for some [formula]. But then y equals the sum of the elements of [formula], which is an element of ΣA since [formula].

Let [formula] be multisets in [formula], and set [formula]. If m is the largest cardinality of a proper subgroup of [formula], then either [formula] or [formula].

Since [formula] (viewed as ordinary sets), this follows immediately by inductive application of Kneser's theorem.

For the remainder of this section, we will be dealing with groups that can be decomposed into a direct sum.

A subgroup [formula] of [formula] is called an internal direct summand if there exists a subgroup [formula] of [formula] such that [formula] is the internal direct sum of [formula] and [formula], or in other words, such that [formula] and [formula]. Equivalently, [formula] is an internal direct summand of [formula] if there exists a projection homomorphism [formula] that is the identity on [formula]. Note that this projection homorphism does depend on the choice of [formula] but is uniquely determined by [formula].

For any homomorphism [formula], and any subset X of [formula], we have f(ΣX)  =  Σ(f(X)). In particular, if [formula] is an internal direct summand of [formula], then [formula] for any subset X of [formula].

Given y∈f(ΣX), there exists x∈ΣX such that f(x) = y. Hence we can find [formula] such that [formula], and so [formula]. But f is a homomorphism, and so [formula], so that y∈Σ(f(X)). This shows that f(ΣX)  ⊆  Σ(f(X)); the proof of the reverse inclusion is similar.

Let [formula], and let D and E be multisets contained in [formula] and [formula], respectively. For any [formula],

[formula]

Since [formula], the "if" direction is obvious. For the converse, note that

[formula]

by Lemma [\ref=pi_commutes_with_Sigma_lemma]. On the other hand, [formula] and [formula], and so

[formula]

(since the sumset is not affected by whether e is an allowed summand). A similar argument shows that [formula], which completes the proof of the lemma.

Let [formula] and [formula] be subgroups of [formula] satisfying [formula]. Let D and E be multisets contained in [formula] and [formula], respectively. Then [formula].

Notice that every element of [formula] is contained in [formula]; therefore we may assume without loss of generality that [formula]. In particular, we may assume that [formula] and [formula] are internal direct summands of [formula], so that the projection maps [formula] and [formula] exist and every element [formula] has a unique representation z = x + y where [formula] and [formula]; note that [formula] and [formula] in this representation.

To establish the lemma, it therefore suffices to show that [formula] if and only if [formula]; but this is exactly the statement of Lemma [\ref=pi_split_lemma].

The next lemma is a bit less standard yet still straightforward: in a direct product of two abelian groups, it characterizes the elements of a sumset that lie in a given coset of one of the direct summands.

Let [formula] and [formula] be subgroups of [formula] satisfying [formula]. Let D and E be multisets contained in [formula] and [formula], respectively. For any [formula]:

if y∈ΣE, then [formula];

if y∉ΣE, then [formula].

As in the proof of Lemma [\ref=direct_product_lemma], we may assume without loss of generality that [formula]. Suppose that z is an element of [formula]. Since [formula], we may write z = x + y for some [formula], whence [formula]. On the other hand, since [formula], we see that y∈ΣE by Lemma [\ref=pi_split_lemma]. In other words, the presence of any element [formula] forces y∈ΣE, which establishes part (b) of the lemma.

We continue under the assumption y∈ΣE to prove part (a). The inclusions [formula] and [formula] are both obvious, and so [formula]. As for the reverse inclusion, let [formula] as above; then [formula] by Lemma [\ref=pi_split_lemma], whence [formula] as required.

Finally we can establish the lemma that we will make the most use of when we return to the setting [formula] in the next section.

Let [formula], and let C be a multiset contained in [formula]. Let [formula], let [formula], and let [formula]. Then #  ΣC  ≥    #  ΣD  ·    #  ΣE.

Lemma [\ref=direct_product_lemma] tells us that [formula], and so it suffices to show that [formula]. We accomplish this by showing that

[formula]

for all [formula].

For any [formula], Lemma [\ref=orthogonal_structure_lemma] tells us that [formula], in which case the inequality [\eqref=one_line_at_a_time] holds trivially. For any y∈ΣE, Lemma [\ref=orthogonal_structure_lemma] tells us that [formula], and so the right-hand side of the inequality [\eqref=one_line_at_a_time] equals #  ΣD.

On the other hand, since [formula] by Lemma [\ref=pi_commutes_with_Sigma_lemma], there exists at least one element z∈ΣF satisfying [formula]; as [formula], this is equivalent to saying that [formula]. Since [formula], we have [formula] as well. But the inclusion ΣD  +  {z}  ⊆  ΣD  +  ΣF  =  ΣC is trivial, and therefore [formula]; in particular, the left-hand side of the inequality [\eqref=one_line_at_a_time] is at least #  ΣD. Combined with the observation that the right-hand side equals #  ΣD, this lower bound establishes the inequality [\eqref=one_line_at_a_time] and hence the lemma.

These lemmas might be valuable for studying sumsets in more general abelian groups. They will prove to be particularly useful for studying sumsets in [formula], however, essentially because there are many ways of writing [formula] as an internal direct sum of two subgroups (which are simply lines through [formula]).

Lower bounds for sumsets

In this section we establish Theorems [\ref=conjecture_true_for_k_tiny] and [\ref=conjecture_true_for_k_small_in_terms_of_p]; the proofs employ two combinatorial propositions which we defer to the next section. It would be possible to prove these two theorems at the same time, at the expense of a bit of clarity; however, we find it illuminating to give complete proofs of Theorem [\ref=conjecture_true_for_k_tiny] (the cases |A| = p and |A| = p + 1) first, as the proofs will illustrate the methods used to prove the more general Theorem [\ref=conjecture_true_for_k_small_in_terms_of_p]. Seeing the limitations of the proof of Theorem [\ref=conjecture_true_for_k_tiny] will also motivate the formulation of our main technical tool, Lemma [\ref=any_j_lemma].

Throughout this section, A will denote a valid multiset contained in [formula]. For any [formula], we let 〈〉x denotes the subgroup of [formula] generated by x (that is, the line passing through both the origin [formula] and x), and we let mx denote the multiplicity with which x appears in A, so that [formula]. The fact that A is valid means that [formula] and [formula] for every [formula].

Our first lemma quantifies the notion that we can establish sufficiently good lower bounds for the cardinality of ΣA if we know that there are enough elements of A lying in one subgroup of [formula]. Naturally, the method of proof is to partition A into the elements lying in that subgroup and all remaining elements, project the remaining elements onto a complementary subgroup, and then use Lemma [\ref=CD_lemma] in each subgroup separately.

Let A be any valid multiset contained in [formula]. Suppose that for some [formula],

[formula]

Then #  ΣA  ≥  (|A| + 2 - p)p.

The conclusion is worse than trivial if |A|  <  p - 1; also, the fact that A is valid means that the left-hand side of equation [\eqref=symmetric_bound] is at most p - 1, and so the lemma is vacuous if |A|  >  2p - 2. Therefore in practice the lemma will be applied only to multisets A satisfying p - 1  ≤  |A|  ≤  2p - 2.

Let [formula]; note that |D|  ≤  p - 1 since A is a valid multiset, and note also that [formula] by assumption. Set [formula]. Choose any nontrivial subgroup [formula] of [formula] other than 〈〉x, and set [formula]. Then by Lemma [\ref=sweep_to_the_left_lemma], we know that #  ΣA  ≥    #  ΣD  ·    #  ΣE. By Lemma [\ref=CD_lemma] and the fact that [formula], we obtain

[formula]

since |E|  =  |F|  =  |A| - |D|. The inequalities |D|  ≤  p - 1 and |A|  -  |D|  ≤  p - 1 ensure that p is the larger element in both minima, and so we have simply

[formula]

The pair of inequalities |D|  ≤  p - 1 and |A|  -  |D|  ≤  p - 1 is equivalent to the inequality [formula]; therefore

[formula]

as claimed.

This lemma alone is sufficient to establish Theorem [\ref=conjecture_true_for_k_tiny].

When |A| = p, the right-hand side of the inequality [\eqref=symmetric_bound] equals 1, and so the inequality holds for any x∈A. Therefore Lemma [\ref=conjecture_true_if_enough_on_line_lemma] automatically applies, yielding #  ΣA  ≥  (|A| + 2 - p)p  =  2p as desired. (In fact essentially the same proof gives the more general statement: if A is a multiset contained in [formula] but not contained in any proper subgroup, and |A|  ≥  p, then #  ΣA  ≥  2|A|.)

We are assuming that |A|  =  p + 1. Suppose first that there exists a nontrivial subgroup of [formula] that contains at least two points of A (including possibly two copies of the same point). Choosing any nonzero element x in that subgroup, we see that the inequality [\eqref=symmetric_bound] is satisfied, and so Lemma [\ref=conjecture_true_if_enough_on_line_lemma] yields #  ΣA  ≥  (|A| + 2 - p)p  =  3p as desired.

From now on we may assume that there does not exist a nontrivial subgroup of [formula] that contains at least two points of A. Since there are only p + 1 nontrivial subgroups of [formula], it must be the case that A consists of exactly one point from each of these p + 1 subgroups; in particular, the elements of A are distinct. We can verify the assertion for [formula] by exhaustive computation (see the remarks after the end of this proof), so from now on we may assume that [formula].

Suppose first that all sums of pairs of distinct elements from A are distinct. All these sums are elements of ΣA, and thus [formula] since [formula].

The only remaining case is when two pairs of distinct elements from A sum to the same point of [formula]. Specifically, suppose that there exist x1,y1,x2,y2∈A such that x1 + y1 = x2 + y2. Partition [formula] where B1  =  {x1,y1} and B2  =  {x2,y2} and hence [formula]; note that this really is a partition of A, as the fact that x1 + y1 = x2 + y2 forces all four elements to be distinct. Moreover, if we define z = x1 + y1 = x2 + y2, then we know that [formula] since x1 and y1 are in different subgroups.

Define C to be the multiset [formula]; by Lemma [\ref=a_la_carte_lemma], we know that #  ΣA  ≥    #  ΣC. Define [formula]; we claim that |D|  =  3. To see this, note that A has exactly one point in every nontrivial subgroup, and in particular A has exactly one point in 〈〉z. Furthermore, that point cannot be x1 for example, since then y1  =  z - x1 would also be in that subgroup; similarly that point cannot be x2, y1, or y2. We conclude that B0 has exactly one point in 〈〉z, whence C has exactly three points in 〈〉z.

Now define [formula], so that |F|  =  |C|  -  |D|  =  (|B0| + 2) - 3  =  (|A| - 4 + 2) - 3  =  p - 4. Let [formula] be any nontrivial subgroup other than 〈〉z, and set [formula]. The lower bounds #  ΣD  ≥  4 and #  ΣE  ≥  p - 3 then follow from Lemma [\ref=CD_lemma]. By Lemma [\ref=sweep_to_the_left_lemma], we conclude that #  ΣC  ≥    #  ΣD  ·    #  ΣE  =  4(p - 3)  >  3p since [formula].

The computation that verifies Theorem [\ref=conjecture_true_for_k_tiny](b) for [formula] should be done a little bit intelligently, since there are 1012 subsets A of [formula] (for example) consisting of exactly one nonzero element from each nontrivial subgroup. We describe the computation in the hardest case p = 11. Let us write the elements of [formula] as ordered pairs (s,t) with s and t considered modulo 11. By separately dilating the two coordinates of [formula] (which does not alter the cardinality of ΣA), we may assume without loss of generality that A contains both (1,0) and (0,1). We also know every such A contains a subset of the form [formula] for some integers [formula]. Therefore the cardinality of every such ΣA is at least as large as the cardinality of one of the subsumsets [formula].

There are 104 such subsumsets, and direct computation shows that all of them have more than 33 distinct elements except for the sixteen cases [formula], which each contain 32 distinct elements. It is then easily checked that any subsumset of the form [formula] with [formula] contains more than 33 distinct elements. This concludes the verification of Theorem [\ref=conjecture_true_for_k_tiny](b) for p = 11, and the cases [formula] are verified even more quickly.

We now foreshadow the proof of Theorem [\ref=conjecture_true_for_k_small_in_terms_of_p] by reviewing the structure of the proof of Theorem [\ref=conjecture_true_for_k_tiny](b). In that proof, we quickly showed that the desired lower bound held if there were enough elements of A in the same subgroup. Also, the desired lower bound certainly held if there were enough distinct sums of pairs of elements of A. If however no subgroup contained enough elements of A and there were only a few distinct sums of pairs of elements of A, then we showed that we could find multiple pairs of elements summing to the same point in [formula]. Replacing those elements in A with multiple copies of their joint sum, we found that the corresponding subgroup now contained enough elements to carry the argument through.

The following lemma quantifies the final part of this strategy, where we replace j pairs of elements of A with their joint sum and then use our earlier ideas to bound the cardinality of the sumset from below.

Let A be any valid multiset contained in [formula], and let [formula]. For any integer j satisfying

[formula]

we have

[formula]

This can be seen as a generalization of Lemma [\ref=conjecture_true_if_enough_on_line_lemma], as equation [\eqref=actually_special_case] is the special case j = 0 of this lemma.

Partition [formula], where for each 1  ≤  i  ≤  j, the multiset Bi has exactly two elements, neither contained in 〈〉z, that sum to z (the complimentary submultiset B0 is unrestricted). The upper bound [\eqref=allows_choosing_pairs] for j is exactly what is required for such a partition to be possible; the factor of [formula] arises because the sum on the right-hand side of [\eqref=allows_choosing_pairs] double-counts the pairs (t,z - t) and (z - t,t). Then set C equal to B0 with j additional copies of z inserted. By Lemma [\ref=a_la_carte_lemma], we know that #  ΣA  ≥    #  ΣC.

Now let D be the intersection of C with the subgroup 〈〉z, and let [formula]. Let [formula] be any nontrivial subgroup other than 〈〉z, and set [formula]. By Lemma [\ref=sweep_to_the_left_lemma], we know that #  ΣC  ≥    #  ΣD  ·    #  ΣE. However, the number of elements of D (counting multiplicity) is j more than the number of elements of [formula]; this is the same as j more than the number of elements of [formula] (since no elements of [formula] lie on 〈〉z), or in other words [formula]. Similarly, the number of elements of E (equivalently, of F) is equal to the number of elements of [formula]; this is the same as 2j less than the number of elements of [formula], or in other words [formula]. The lower bounds [formula] and [formula] then follow from Lemma [\ref=CD_lemma]; the chain of inequalities #  ΣA  ≥    #  ΣC  ≥    #  ΣD  ·    #  ΣE establishes the lemma.

We are now ready to use Lemma [\ref=any_j_lemma] to establish Conjecture [\ref=2d_conjecture] when |A| = p + k, for all but finitely many primes p depending on k. Let [formula] denote the kth harmonic number.

Let [formula] be any integer, and let A be any valid multiset contained in [formula] such that |A|  =  p + k. If p  ≥  4(k + 1)2Hk  -  2k, then #  ΣA  ≥  (k + 2)p.

Using the elementary bound Hk  ≤  γ  +   log (k + 1), where γ denotes the Euler-Mascheroni constant, we see that Theorem [\ref=conjecture_true_for_p_large_in_terms_of_k] holds as long as p  ≥  4(k + 1)2(γ  +   log (k + 1)). Theorem [\ref=conjecture_true_for_k_small_in_terms_of_p] can thus be readily deduced from Theorem [\ref=conjecture_true_for_p_large_in_terms_of_k] as follows: If [formula] then [formula]. In this case we certainly have p  ≥  (1  +  2 log 2)(k + 1)2, whence [formula] and [formula].

If there are k + 1 elements of A in some nontrivial subgroup, then we are done by Lemma [\ref=conjecture_true_if_enough_on_line_lemma]. Therefore we may assume that there are at most k points in each subgroup; in particular, mx  ≤  k for all [formula]. We now argue that if ΣA is small, then there must be lots of pairs of elements of A that add to the same element of [formula], at which point we will be able to invoke Lemma [\ref=any_j_lemma]. We may assume that [formula], for otherwise we are done immediately.

For each 1  ≤  i  ≤  k, we define the level set [formula]. Notice that A can be written precisely as the multiset union [formula], and so [formula]. Let Bi be the multiset formed by the sums of pairs of elements of Ai not in the same subgroup:

[formula]

Note that [formula] (the restriction 〈〉x  ≠  〈〉y ensures that x  ≠   - y) and that every element of Bi occurs with even multiplicity (the restriction 〈〉x  ≠  〈〉y ensures that x  ≠  y). It is not hard to estimate the relative sizes of #  Ai and |Bi|: for each x∈Ai there are at most k elements of A lying in the subgroup 〈〉x. Since each such x occurs with multiplicity at least i in A, there are at most k / i distinct values of y excluded by the condition 〈〉x  ≠  〈〉y. Hence |Bi|  ≥    #  Ai(  #  Ai  -  k / i), which implies that

[formula]

Since [formula] is fixed, this shows that |Bi| cannot be very small on average. At the same time, #  Bi cannot get very large: if [formula], then (under our assumption that [formula]) Lemma [\ref=kneser_bound] already yields

[formula]

where the middle inequality holds because Bi  ⊆  ΣAi. We may therefore assume henceforth that

[formula]

Let us now introduce the weighted height parameter

[formula]

We shall show shortly that η  >  k + 1. Assuming so, then for some 1  ≤  i  ≤  k, we have

[formula]

so by the pigeonhole principle, there exists some z∈Bi (in particular [formula]) occurring with multiplicity greater than 2(k + 1) / i; since this multiplicity is an even integer, it must be at least 2(k + 2) / i. For each solution x + y  =  z corresponding to an occurrence of z in Bi, we have by construction that x,y∉〈〉z and mx,my  ≥  i, so for this particular choice of z,

[formula]

Furthermore, [formula] by assumption. Therefore we are free to apply Lemma [\ref=any_j_lemma] with [formula] which gives the lower bound

[formula]

(the last step used the inequality p  ≥  (k + 3)2, which certainly holds under the hypotheses of the theorem).

It remains only to verify that η  >  k + 1. Summing the inequality [\eqref=bound_on_a_i] over all 1  ≤  i  ≤  k yields

[formula]

using the definition [\eqref=eta_def] of η. We estimate the rightmost sum using Cauchy-Schwarz together with the inequality [\eqref=bound_on_b_i]:

[formula]

Combining the previous two inequalities gives [formula], so that

[formula]

by the hypothesis on the size of p. In other words,

[formula]

which completes the proof of the theorem.

A wider conjecture

As mentioned earlier, Conjecture [\ref=2d_conjecture] is just one part of a more far-reaching conjecture concerning sumsets of multisets in [formula]. Before formulating that wider conjecture, we must expand the definition of a valid multiset to [formula].

Let p be an odd prime, and let m be a positive integer. A multiset A contained in [formula] is valid if:

[formula]; and

for each 1  ≤  d  ≤  m, every subgroup of [formula] that is isomorphic to [formula] contains fewer than dp points of A, counting multiplicity.

When m = 1, a multiset contained in [formula] is valid precisely when it does not contain 0; when m = 2 and |A|  <  2p, this definition of valid agrees with Definition [\ref=valid_definition] for multisets contained in [formula]. Note that in particular, Definition [\ref=more_valid_definition](b) implies that every valid multiset contained in [formula] has at most mp - 1 elements, counting multiplicity. We now give an example showing that this upper bound mp - 1 can in fact be achieved. Throughout this section, let [formula] denote a generating set for [formula], and let [formula] denote the subgroup of [formula] generated by [formula], so that [formula].

Let A1 be the multiset consisting of p - 1 copies of x1; for 2  ≤  j  ≤  m let Aj  =  {xj  +  ax1:0  ≤  a  ≤  p - 1}; and define [formula]. Then |Bm|  =  (p - 1)  +  (m - 1)p  =  mp - 1 and [formula]. To verify that Bm is a valid subset of [formula], let [formula] be any subgroup of [formula] that is isomorphic to [formula]; we need to show that Bm contains fewer than dp points of [formula].

First suppose that [formula], which implies that [formula] for every nonzero multiple bx1 of x1. Then for each 2  ≤  j  ≤  m, at most one of the elements of Aj can be in [formula], since the difference of any two such elements is a nonzero multiple of x1. Therefore [formula] for some [formula], and in fact all [formula] of these elements are of the form xj + ax1 for [formula] distinct values of j. Since no such element is in the subgroup spanned by the others, we conclude that [formula], and so the necessary inequality [formula] is amply satisfied.

Now suppose that [formula]. Then for each 2  ≤  j  ≤  m, either all or none of the elements of Aj are in [formula]. By reindexing the xi, we may choose an integer [formula] such that [formula] contains [formula] and is disjoint from [formula]. In particular, [formula]. But [formula] contains [formula] and hence [formula], so that [formula] as required.

We may now state our wider conjecture; Conjecture [\ref=2d_conjecture] is the special case q = 1 of part (a) of this conjecture.

Let p be an odd prime. Let m be a positive integer, and let A be a valid multiset of [formula] with |A|  ≥  p. Write |A|  =  qp + k with 0  ≤  k  ≤  p - 1.

If 0  ≤  k  ≤  p - 3, then #  ΣA  ≥  (k + 2)pq.

If k = p - 2, then #  ΣA  ≥  pq + 1 - 1.

If k = p - 1, then #  ΣA  ≥  pq + 1.

In particular, if |A|  =  mp - 1 then [formula].

We remark that the quantity dp in Definition [\ref=more_valid_definition], bounding the number of elements in a valid multiset that can lie in a rank-d subgroup, has been carefully chosen in light of this conjecture: by Conjecture [\ref=any_d_conjecture](c), any valid multiset A with at least dp - 1 elements counting multiplicity must satisfy #  ΣA  ≥  pd. In particular, if A is a valid multiset contained in a subgroup [formula] that is isomorphic to [formula], then |A|  ≥  dp - 1 implies that [formula]. Therefore allowing dp elements in such a subgroup would always be "wasteful". Of course, the validity of Definition [\ref=more_valid_definition] for rank-d subgroups depends crucially upon the truth of Conjecture [\ref=any_d_conjecture](c) for q = d - 1.

The conjecture is restricted to multisets A with |A|  ≥  p because we already know the truth for smaller multisets, for which the definition of "valid" is simply the condition that [formula]: when |A|  ≤  p - 1, the best possible lower bound is #  ΣA  ≥  |A| + 1 as in Lemma [\ref=CD_lemma]. We remark that Peng [\cite=P1] has proved Conjecture [\ref=any_d_conjecture](c) in the case m = 2 and q = 1, under even a slightly weaker hypothesis; in other words, he has shown that if A is a valid multiset contained in [formula] with |A|  =  2p - 1, then [formula]. (We remark that Mann and Wou [\cite=MW] have proved in the case that A is actually a set--that is, a multiset with distinct elements--that #  A  =  2p - 2 suffices to force [formula].) Peng considers the higher-rank groups [formula] as well, but the multisets he allows (see [\cite=P2]) form a much wider class than our valid multisets, and so his conclusions are much weaker than Conjecture [\ref=any_d_conjecture] for [formula]. Finally, we mention that we have completely verified Conjecture [\ref=any_d_conjecture] by exhaustive computation for the groups [formula] with p  ≤  7 and also for the group [formula].

It is easy to see that all of the lower bounds in Conjecture [\ref=any_d_conjecture](a), if true, would be best possible. Given [formula] and 0  ≤  k  ≤  p - 3, let A' be any valid multiset contained in [formula] with |A'|  =  qp - 1 (such as the one given in Example [\ref=valid_example] with m = q), and let A be the union of A' with k + 1 copies of xq + 1. Then ΣA  =  {y  +  axq + 1:y∈ΣA',  0  ≤  a  ≤  k + 1} and thus #  ΣA'  =  (k + 2)  #  ΣA  ≤  (k + 2)pq since ΣA is contained in [formula]. Similarly, the fact that there exists a valid multiset contained in [formula] with qp + (q - 1) = (q + 1)p - 1 elements (such as the one given in Example [\ref=valid_example] with m = q + 1) shows that the lower bound in Conjecture [\ref=any_d_conjecture](c) would be best possible, since the sumset of this multiset would still be contained in [formula] and thus would have at most pq + 1 distinct elements.

The lower bound in Conjecture [\ref=any_d_conjecture](b) might seem counterintuitive, especially in comparison with the pattern established in Conjecture [\ref=any_d_conjecture](a). However, we can give an explicit example showing that the lower bound pq + 1 - 1 for #  ΣA cannot be increased:

When p is an odd prime, define B'm to be the set Bm from Example [\ref=valid_example] with one copy of x1 removed, so that B'm contains x1 with multiplicity only p - 2. Since Bm is a valid multiset contained in [formula], so is B'm. We have |B'm|  =  |Bm| - 1  =  (mp - 1) - 1  =  (m - 1)p  +  (m - 2), and we claim that - x1∉ΣB'm; this will imply that #  ΣB'm  ≤  pm - 1, and so the lower bound for #  ΣA in Conjecture [\ref=any_d_conjecture](b) cannot be increased. (In fact it is not hard to show that every other element of [formula] is in ΣB'm, and so #  ΣB'm is exactly equal to pm - 1.)

Suppose for the sake of contradition that - x1∈ΣB'm, and let C be a submultiset of B'm such that [formula]. For each 2  ≤  j  ≤  m, define [formula]. Then

[formula]

for some integer t. It follows from this equation that each [formula] must equal either 0 or p. However, if [formula] then

[formula]

(since p is odd). So in either case, if [formula] is the multiplicity with which x1 appears in C, then

[formula]

This is a contradiction, however, since s must lie between 0 and p - 2. Therefore - x1 is indeed not an element of ΣB'm, as claimed.

The line of questioning in this section turns out to be uninteresting when p = 2: when the multiset A does not contain [formula], the condition that no rank-1 subgroup of [formula] contain 2 points of A is simply equivalent to A not containing any element with multiplicity greater than 1. It is easy to check that if A consists of any q points in [formula] that do not lie in any subgroup isomorphic to [formula], then ΣA fills out the entire rank-q subgroup generated by A. In other words, the analogous definition of "valid" for multisets in [formula] would simply be a set of q points that generate a rank-q subgroup of [formula], and we would always have #  ΣA  =  2|A|  =  2#  A for valid (multi)sets in [formula].

Acknowledgments

The collaboration leading to this paper was made possible thanks to Jean-Jacques Risler, Richard Kenyon, and especially Ivar Ekeland; the authors also thank the University of British Columbia and the Institut d'Études Politiques de Paris for their undergraduate exchange program. The first author thanks Andrew Granville for conversations that explored this topic and eventually led to the formulation of the conjectures herein.