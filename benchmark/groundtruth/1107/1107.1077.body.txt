Unit Distances in Three Dimensions

Work by Haim Kaplan has been supported by Grant 2006/204 from the U.S.-Israel Binational Science Foundation, and by grant 822/10 from the Israel Science Fund. Work by Jií Matouek has been partially supported by the ERC Advanced Grant No. 267165. Work by Zuzana Safernová has been supported by the Charles University grant GAUK 421511. Work by Micha Sharir has been supported by NSF Grant CCF-08-30272, by Grant 2006/194 from the U.S.-Israel Binational Science Foundation, by Grant 338/09 from the Israel Science Fund, and by the Hermann Minkowski-MINERVA Center for Geometry at Tel Aviv University.

Lemma

Introduction

Let P be a set of n points in Euclidean d-dimensional space [formula]. What is the maximum possible number of pairs of points in P with distance exactly 1? A standard construction, attributed to Lenz [\cite=Le55], shows that this number can be Θ(n2) in d  ≥  4 dimensions, so the only interesting cases are d = 2,3. The planar version is the classical unit distances problem of Erd os [\cite=E46], posed in 1946, for which we refer to the literature (in particular, see [\cite=CEGSW] [\cite=SST] [\cite=Sz] [\cite=Va]). Here we focus on the case d = 3. This has been studied, back in 1990, by Clarkson et al. [\cite=CEGSW], who have established the upper bound O(n3 / 22O(α2(n))), where α(  ·  ) is the inverse Ackermann function.

In this paper we get rid of the small factor 2O(α2(n)), and obtain the upper bound O(n3 / 2). Admittedly, the improvement is not large, and achieves only a slight narrowing of the gap from the best known lower bound, which is Ω(n4 / 3 log  log n) [\cite=E60], but is nevertheless the first improvement of the bound of [\cite=CEGSW], more than 20 years after its establishment.

The proof of the new bound is based on the recently introduced polynomial partitioning technique of Guth and Katz [\cite=GK2] (also see Kaplan et al. [\cite=KMS] for an expository introduction). An additional goal of the present paper is to highlight certain technical issues (specifically, multi-level polynomial partitions) that might arise in the application of the new approach. These issues are relatively simple to handle for the problem at hand, but treating them in full generality is still an open issue.

Zahl's work. After we finished a draft of this paper, in early 2011, we learned that Zahl [\cite=Za] had independently obtained the same bound on unit distances in [formula] (and, actually, a more general result concerning incidences of points with suitable surfaces in [formula]), using the same general approach. We believe that our treatment may still be of some interest: First, the details of our arguments differ from those of Zahl at some points, and since the general problem of the multi-level decomposition alluded to above remains unresolved, even slight differences in the approaches may become important in attacking the general question. Second, our treatment is more pedestrian and assumes less background in algebraic geometry than Zahl's, and thus it may be more accessible for the community at large of researchers in discrete geometry. So, while we respect (and clearly acknowledge) the priority of Zahl's preprint, we have still decided to make our manuscript publicly available.

Analysis

Let P be a set of n points in [formula]. For each p∈P let σp denote the unit sphere centered at p, and let Σ denote the collection of these spheres. Clearly, the number of unit distances between pairs of points of P is half the number of incidences I(P,Σ) of the points of P with the spheres of Σ. Our main result is the following theorem.

I(P,Σ)  =  O(n3 / 2). In particular, the number of unit distances in any set of n points in [formula] is O(n3 / 2).

We first review the main algebraic ingredient of the analysis.

Polynomial partitions: A quick review. For the sake of completeness, and also for the second partitioning step in our analysis, we provide a brief review of the polynomial partitioning technique of Guth and Katz [\cite=GK2]; see also [\cite=KMS]. This technique is based on the polynomial ham sandwich theorem of Stone and Tukey [\cite=ST]. Specifically, fix an integer D and put [formula]. Let [formula] be M arbitrary finite point sets in [formula] (the theorem holds for more general sets, and in any dimension, but this version suffices for our purposes). Apply the Veronese map [formula], which maps a point [formula] to the M-tuple of the values at (x,y,z) of all the M nonconstant trivariate monomials of degree at most D. Consider the images [formula] of our sets, and apply the standard ham sandwich theorem (see [\cite=ST] and [\cite=Ma]) to these M sets in [formula], to obtain a hyperplane h that bisects each set Ui, in the sense that, for each [formula], at most |Ui| / 2 points of Ui lie on one side of h and at most |Ui| / 2 points lie on the other side (the remaining points of Ui lie on h; their number can be anything between 0 and |Ui|). Consider the trivariate polynomial [formula] (here h = 0 is the linear equation of our hyperplane). Then f is a trivariate polynomial (a linear combination of monomials) of degree at most D that bisects each of the sets [formula], in the sense that, for each i,

[formula]

Guth and Katz construct a sequence of such polynomial ham sandwich cuts, to partition the given point set P into a specified number t of subsets, each consisting of at most O(n / t) points. This technique first bisects the original point set P into two halves, using a polynomial f1. It then bisects each of these two sets into two halves, using a second polynomial f2, bisects each of the four resulting subsets using a third polynomial f3, and so on, until the desired number t of subsets is obtained (or exceeded). The product [formula] of these bisecting polynomials is the desired partitioning polynomial, and, as shown in [\cite=GK2] [\cite=KMS], its degree is D = O(t1 / 3). The resulting partition is not exhaustive, as some points of P may lie in the zero set Z(f) of f. Note that in general it makes sense to take t  ≤  n. If t > n we can, following the technique used in [\cite=EKS] [\cite=GK], find a polynomial f of degree O(n1 / 3)  =  O(t1 / 3) that vanishes at all the points of P. In this case all the subsets in the resulting partition of P are empty, except for [formula].

First partition. For the proof of Theorem [\ref=th:main], we set t = n3 / 4, so the degree of the resulting partitioning polynomial f is D = O(n1 / 4). Denote the resulting subsets of the above partition of P by [formula]. Each of these subsets is of size at most O(n / t), and we also have a remainder subset P0, contained in the zero set Z = Z(f) of f. We may also assume that, for each i  ≥  1, Pi lies in a distinct connected component Ci of [formula]. (More specifically, the construction of Guth and Katz ensures that no connected component of [formula] meets more than one of the sets Pi. Some of these sets, though, may lie in several components, in which case we further split each such set into subsets, one for each component that it meets.)

We note that the degree D could conceivably be much smaller. For example, if P, or most of it, lies on an algebraic surface of small degree (say, a plane or a quadric) then f could be the polynomial defining that surface, resulting in a trivial partitioning in which all or most of the points of P belong to P0 and the degree of f is very small. This potential variability of D will enter the analysis later on.

We first bound the number of incidences between [formula] and Σ. For this, we need to show that no sphere crosses too many cells of the partition (that is, components of [formula]). This can be argued as follows.

Let us fix a sphere σ  =  σa∈Σ. The number of cells Ci crossed by σ is bounded from above by the number of components of [formula].

For bounding the latter quantity, as well as in some arguments in the sequel, it is technically convenient to use a rational parameterization of σ. Specifically, we let [formula] be the inverse stereographic projection given by ψ(u,v) = (ψx(u,v),ψy(u,v),ψz(u,v)), where

[formula]

and (x0,y0,z0) is the center of σ. Then ψ is a homeomorphism between the uv-plane and the sphere σ "punctured" at its north pole. This missing point will not affect our analysis if we choose a generic coordinate frame, in which no pair of points of P are co-vertical. (Since the center of each ball is a point in P, no point can reside at the north pole of a ball in such a generic coordinate frame.)

Let us consider the composition [formula] (i.e., [formula]); this is a rational function, which we can write as a quotient [formula] of two polynomials (with no common factor). For analyzing the zero set, it suffices to consider the numerator f*(u,v), which is a polynomial of degree O(D).

If f* vanishes identically then σ  ⊂  Z(f) and thus σ does not cross any cell Ci of the partition. Otherwise, the number of components of [formula] is no larger than the number of components of [formula], and for these, we use the d = 2 case of the following result.

Let f be a real polynomial of degree D in d variables. Then the number of connected components of [formula] is at most 6(2D)d.

This lemma follows, for example, from Warren [\cite=Wa] (also see [\cite=BPR] for an exposition, and [\cite=Akama-al] for a neatly simplified proof).

From Lemma [\ref=l:cpts] we get that the number of connected components of [formula] is O( deg(f*)2)  =  O(D2). We thus conclude that each sphere σ  =  σa∈Σ crosses at most O(D2)  =  O(n1 / 2) cells Ci of the partition.

Hence the overall number of sphere-cell crossings is O(nD2)  =  O(n3 / 2). Situations in which a sphere σ crosses a cell Ci and is incident to at most two points of the corresponding subset [formula] generate a total of O(n3 / 2) incidences within this subset. Otherwise, for a cell Ci, its corresponding subset Pi, and a fixed point p∈Pi, the number of spheres that are incident to p and contain at least two other points of Pi, is at most [formula], because any pair of points [formula] determine at most two unit spheres that are incident to p,q,r. Hence the number of incidences of the points of Pi with spheres that are incident to at least three points of Pi is at most |Pi|3  ≤  (n / t)3  =  O(n3 / 4). Summing over all subsets Pi, we get a total of O(n3 / 2) such incidences.

Remark. (Although the full significance of this remark will become clearer later on, we nevertheless make it early in the game.) There are well-known papers in real algebraic geometry estimating the number of components of algebraic varieties in [formula], or more generally, the complexity of an arrangement of zero sets of polynomials in [formula] (Oleinik and Petrovski, Milnor, Thom, and Warren--see, e.g., [\cite=BPR] for references). In the arguments used so far, and also in the sequel, we need bounds in a somewhat different setting, namely, when the arrangement is not in [formula], but within some algebraic variety. This setting was considered by Basu, Pollack, and Roy [\cite=bpr-ncdfp]; however, their bound is not sufficiently sharp for us either, since it assumes the same upper bound both on the degree of the polynomials defining the arrangement and those defining the variety. Prompted by our question, Barone and Basu [\cite=BB] proved a bound in this setting involving two degree parameters: they consider a k-dimensional variety V in [formula] defined by polynomials of degree at most D, and an arrangement of n zero sets of polynomials of degree at most E within V, and they bound the number of cells, of all dimensions, in the arrangement by O(1)dDd - k(nE)k. A weaker bound of a similar kind was also derived independently by Solymosi and Tao [\cite=SoTa]. However, in our proof, we will eventually need three different degree parameters (involving spheres intersecting a variety defined by two polynomials of two potentially different degrees; in this case one of the degrees is 2, the degree of the polynomial equation of a sphere), and thus we cannot refer to [\cite=BB] [\cite=SoTa] directly. We provide elementary ad-hoc arguments instead (aimed mainly at readers not familiar with the techniques employed in [\cite=BB] [\cite=SoTa]). If the multi-level polynomial partition method should be used in dimensions higher than 3, a more systematic approach will be needed to bound the appropriate number of components. We believe that the approach of [\cite=BB] should generalize to an arbitrary number of different degree parameters, but there are several other obstacles to be overcome along the way; see Section [\ref=sec:conc] for a discusssion.

Bounding I(P0,Σ). It therefore remains to bound I(P0,Σ). Here is an informal overview of this second step of the analysis. We apply the polynomial partitioning procedure to P0, using a second polynomial g (which again is the product of logarithmically many bisecting polynomials). For a good choice of g, we will obtain various subsets of P0 of roughly equal sizes, lying in distinct components of [formula], and a remainder subset [formula]. Again, for a good choice of g, [formula] will be a 1-dimensional curve, and it will be reasonably easy to bound I(P00,Σ). The situation that we want to avoid is one in which f and g have a common factor, whose 2-dimensional zero set contains most of P0, in which case the dimension reduction that we are after (from a 2-dimensional surface to a 1-dimensional curve) will not work.

To overcome this potential problem, we first factor f into irreducible factors [formula] (recall that in the construction of [\cite=GK2] f is the product of logarithmically many factors, some of which may themselves be reducible). Denote the degree of fi by Di, so [formula]. By removing repeated factors from f, if any exist, we may assume that f is square-free; this does not affect the partition induced by f, nor its zero set. Put

[formula]

This is a partition of P0 into r pairwise disjoint subsets. Put mi  =  |P0i| for [formula]; thus, [formula]. We will bound I(P0i,Σ) for each i separately and then add up the resulting bounds to get the desired bound on I(P0,Σ).

Second partition. We will bound the number of incidences between P0i and Σ using the following lemma, which is the core of (this step of) our analysis.

Let f be an irreducible trivariate polynomial of degree D, let Q be a set of m points contained in Z(f), and let Σ be a set of n  ≥  m unit spheres in [formula]. Then

[formula]

Remark. When D = 1 (all the points of Q are co-planar), the bound in the lemma becomes O(m3 / 5n4 / 5  +  n), a special case (when m  ≤  n) of the bound O(m3 / 5n4 / 5  +  n  +  m), which is a well known upper bound on the number of incidences between m points and n circles in the plane (see, e.g., [\cite=CEGSW] [\cite=PS]). In our case, the circles are the intersections of the spheres of Σ with the plane (where each resulting circle has multiplicity at most 2).

The main technical step in proving Lemma [\ref=lem:2nd] is expressed by the following lemma.

Given an irreducible trivariate polynomial f of degree D, a parameter E  ≥  D, and a finite point set Q in [formula], there is a polynomial g of degree at most E, co-prime with f, which partitions Q into subsets Q0  ⊆  Z(g) and [formula], for t = Θ(DE2), so that each Qi, for [formula], lies in a distinct component of [formula], and |Qi| = O(|Q| / t).

Note the similarity of this lemma to the standard polynomial partitioning result, as used in the first partitioning step. The difference is that, to ensure that g be co-prime with f, we pay the price of having only Θ(DE2) parts in the resulting partition, instead of Θ(E3).

Proof of Lemma [\ref=lem:fg]. As in the standard polynomial partitioning technique, we obtain g as the product of logarithmically many bisecting polynomials, each obtained by applying a variant of the polynomial ham sandwich theorem to a current collection of subsets of Q. The difference, though, is that we want to ensure that each of the bisecting polynomials is not divisible by f; since f is irreducible, this ensures co-primality of g with f. Reviewing the construction of polynomial ham sandwich cuts, as outlined above, we see that all that is needed is to come up with some sufficiently large finite set of monomials, of an appropriate maximum degree, so that no nontrivial linear combination of these monomials can be divisible by f. We then use a restriction of the Veronese map defined by this subset of monomials, and the standard ham-sandwich theorem in the resulting high-dimensional space, to obtain the desired polynomial.

Let xiyjzk be the leading term of f, in the sense that i + j + k = D and (i,j,k) is largest in the lexicographical order among all the triples of exponents of the monomials of f of degree D. Let s be the desired number of sets that we want a single partitioning polynomial to bisect. For that we need a space of s monomials whose degrees are not too large and which span only polynomials not divisible by f. If, say, [formula] then we can use all monomials xiyjzk such that i,j,k  ≤  s1 / 3  <  D / 3. Clearly, any nontrivial linear combination of these monomials cannot be divisible by f. In this case the degree of the resulting partitioning polynomial is Θ(s1 / 3). If [formula] then we take the set of all monomials xi'yj'zk' that satisfy i' < i or j' < j or k' < k, and max {i',j',k'}  ≤   for a suitable integer [formula], which we specify below (the actual degree of the bisecting polynomial under construction will then be at most 3). Any nontrivial polynomial h which is a linear combination of these monomials cannot be divisible by f. Indeed, if h = fh1 for some polynomial h1 then the product of the leading terms of f and of h1 cannot be canceled out by the other monomials of the product, and, by construction, h cannot contain this monomial. The number of monomials in this set is Θ(i2 + j2 + k2)  =  Θ(D2). We thus pick   =  Θ((s  /  D)1 / 2) so that we indeed get s monomials. As noted above, the degree of the resulting bisecting polynomial in this case is O((s / D)1 / 2).

We now proceed to construct the required partitioning of Q into t sets, by a sequence of about log t polynomials [formula], where gj bisects 2j subsets of Q, each of size at most |Q| / 2j. For every j such that [formula] we construct, as shown above, a polynomial of degree O(s1 / 3)  =  O(2j / 3). For the indices j with [formula] we construct a polynomial of degree [formula]. Since the upper bounds on the degrees of the partitioning polynomials increase exponentially with j, and since the number of parts that we want is Ω(D3), it follows that the degree of the product of the sequence is [formula]. If we require this degree bound to be no larger than E then it follows that the size of the partition that we get is t = Θ(DE2). Clearly, f does not divide the product g of the polynomials gj, so g satisfies all the properties asserted in the lemma. [formula]

Remarks. (1) The analysis given above can be interpreted as being applied to the quotient ring [formula], where I = 〈f〉 is the ideal generated by f. General quotient rings are described in detail in, e.g., [\cite=CLO1] [\cite=CLO2], but the special case where I is generated by a single polynomial is much simpler, and can be handled in the simple manner described above, bypassing (or rather simplifying considerably) the general machinery of quotient rings. As a matter of fact, an appropriate extension of Lemma [\ref=lem:fg] to quotient rings defined by two or more polynomials is still an open issue; see Section [\ref=sec:conc].

(2) The set Q is in fact contained in Z(f), and the subset Q0 is contained in [formula]. However, except for the effect of this property on the specific choice of monomials for g, the construction considers Q as an arbitrary set of points in [formula], and does not exploit the fact that Q  ⊂  Z(f).

Back to the proof of Lemma [\ref=lem:2nd]. We apply Lemma [\ref=lem:fg] to Q, now assumed to be contained in Z(f), and obtain the desired partitioning polynomial g. We now proceed, based on the resulting partition of Q, to bound I(Q,Σ).

We need the following technical lemma, a variant of which has been established and exploited in [\cite=GK] and in [\cite=EKS]. For the sake of completeness we include a brief sketch of its proof, and refer the reader to the aforementioned papers for further details.

(a) Let f and g be two trivariate polynomials of respective degrees D and E. Let Π be an infinite collection of parallel planes such that, for each π∈Π, the restrictions of f and g to Π have more than DE common roots. Then f and g have a (nonconstant) common factor.

(b) Let f and g be as in (a). If the intersection [formula] of their zero sets contains a 2-dimensional surface patch then f and g have a (nonconstant) common factor.

Proof sketch. (a) Assume without loss of generality that the planes in Π are horizontal and that, if the number of common roots in a plane is finite then these roots have different x-coordinates; both assumptions can be enforced by an appropriate rotation of the coordinate frame. Consider the y-resultant r(x,z) = Resy(f(x,y,z),g(x,y,z)) of f(x,y,z) and g(x,y,z). This is a polynomial in x and z of degree at most DE. If the plane z = c contains more than DE common roots then r(x,c), which is a polynomial in x, has more than DE roots, and therefore it must be identically zero. It follows that r(x,z) is identically zero on infinitely many planes z = c, and therefore, it must be identically zero. (Its restriction to an arbitrary non-horizontal line [formula] has infinitely many roots and therefore it must be identically zero on [formula].) It follows that f(x,y,z) and g(x,y,z) have a common factor (see [\cite=CLO1]).

(b) This follows from (a), since if Z(f) and Z(g) contain a 2-dimensional surface patch, then they must have infinitely many zeros on infinitely many parallel planes. [formula]

Incidences outside Z(g). To prove Lemma [\ref=lem:2nd], we first bound the number of incidences of the points of a fixed subset Qj, for j  ≥  1, with Σ, using the same approach as in the first partition. That is, let nj denote the number of spheres of Σ that cross the corresponding cell Cj effectively, in the sense that [formula]. Then we have O(nj) incidences of the points of Qj with spheres that are incident to at most two points of Qj, and O((m / t)3) incidences with spheres that are incident to at least three points. Summing over all sets, we get

[formula]

We estimate [formula] by bounding the number of cells Cj that a single sphere σ∈Σ can cross effectively, which we do as follows.

Take the same rational parametrization ψ of σ used in the analysis of the first partitioning step. Let f*(u,v) and g*(u,v) be the polynomials obtained from [formula] and [formula] by removing the common denominator of these rational functions. The degrees of f* and g* are O(D) and O(E), respectively.

If f* vanishes identically on the uv-plane, then σ  ⊆  Z(f); this is an easy situation that we will handle later on. Otherwise, [formula] is a 1-dimensional curve γ in the uv-plane (possibly degenerate, e.g., empty or consisting of isolated points), and [formula] is contained in ψ(γ).

By construction, the number of cells Cj that σ crosses effectively (so that it is incident to points of Qj) is no larger than the number of components of [formula]. This is because each such cell Cj contains at least one connected component of [formula].

Now each component of [formula] is either a full component of Z(f*), or a relatively open connected portion of Z(f*) whose closure meets Z(g*).

Since f* is a bivariate polynomial, Harnack's theorem [\cite=Harnack] asserts that the number of (arcwise) connected components of Z(f*) is at most [formula].

For the other kind of components, choose a generic sufficiently small value ε > 0, so that f* and g*  ±  ε do not have a common factor. Then each component of [formula] of the second kind must contain a point at which g*  +  ε = 0 or g*  -  ε = 0. Hence, the number of such components is at most the number of such common roots, which, by Bézout's theorem (see, e.g., [\cite=CLO2]) is O( deg(f*) deg(g*))  =  O(DE).

Since E  ≥  D, we conclude that the number of cells Cj crossed effectively by σ is O(DE), which in turn implies that [formula]. Substituting this in ([\ref=eq:nj]) and recalling that t = Θ(DE2), we get

[formula]

We have left aside the case where σ  ⊆  Z(f). Since f is irreducible, and so is σ, we must have σ = Z(f) in this case (recall Lemma [\ref=lem:x](b)). The analysis proceeds as above for every sphere [formula], and the number of incidences with σ itself is at most m, a bound that is subsumed by the bound asserted in the lemma (recall that m  ≤  n).

We note that in the ongoing analysis D is the actual degree of the irreducible factor of f under consideration, but E is only a chosen upper bound for  deg(g), whose actual value may be smaller (as may have been the case with f).

To optimize the bound in ([\ref=eq:inc1]), we choose

[formula]

and observe that the first term dominates when D  ≤  m3 / 8 / n1 / 8. Assuming that this is indeed the case, we get

[formula]

If D  >  m3 / 8 / n1 / 8 then we have E  =  D, and the bound ([\ref=eq:inc1]) becomes

[formula]

Thus, [formula] satisfies the bound asserted in the lemma, and it remains to bound I(Q0,Σ).

Incidences within [formula]. Recall that Q0 is contained in the curve [formula], which by Lemma [\ref=lem:x](b) is (at most) 1-dimensional.

Fix a sphere σ∈Σ that does not coincide with Z(f), let ψσ be the corresponding rational parameterization of σ, and let f*σ and g*σ be as defined in the preceding analysis.

If g*σ is identically 0, then we have σ  ⊆  Z(g), and the irreducible polynomial defining σ is a factor of g by Lemma [\ref=lem:x]. Thus, the number of such σ's is O(E), and together they can contribute at most O(mE) incidences, which is bounded from above by the right-hand side of ([\ref=eq:inc1]).

Now we assume that both f*σ and g*σ are nonzero, we let let h*σ denote the greatest common divisor of f*σ and g*σ, and put f*σ = f*1σh*σ and g*σ = g*1σh*σ. Then [formula] is the union of Z(h*σ) and of [formula]. Using Bézout's theorem as above, we have [formula]; summing this bound over all spheres, we get at most O(nDE) incidences, a bound already subsumed by ([\ref=eq:inc1]).

It remains to account for incidences of the following kind (call them h*-incidences): a point [formula] lying in ψσ(Z(h*σ)). Let us call such a point q isolated in σ if it is an isolated point of ψσ(Z(h*σ)); i.e., there is a neighborhood of q in σ intersecting ψσ(Z(h*σ)) only at q.

The homeomorphism ψ- 1σ maps the isolated points q on σ to isolated zeros of h*σ in the uv-plane, in a one-to-one fashion. Since deg (h*σ) = O(D), Z(h*σ) has at most O(D2) components (Harnack's theorem again), and thus the overall number of isolated incidences is O(nD2).

Finally, to account for non-isolated h*-incidences, let us fix a point q∈Q0, and consider the collection q consisting of all spheres σ∈Σ that contain q such that q forms a non-isolated h*-incidence with σ. We claim that |q| = O(DE).

For σ∈q, the set ψσ(Z(h*σ)) contains a curve segment βq,σ ending at q. Let us call βq,σ and βq,σ' equivalent if they coincide in some neighborhood of q. If βq,σ and βq,σ' are not equivalent, then in a sufficiently small neighborhood of q they intersect only at q (since they are arcs of algebraic curves).

We also note that a given βq,σ can be equivalent to βq,σ' for at most one σ'  ≠  σ; this is because the common portion [formula] of the considered curve segments has to be contained in the intersection circle [formula], and that circle intersects any other sphere σ''∈Σ in at most two points. Thus, |q| is at most twice the number of equivalence classes of the curve segments βq,σ.

Let us fix an auxiliary sphere S of a sufficiently small radius ρ around q, so that each βq,σ intersects S at some point xσ. Let S' be the sphere around q of radius ρ / 10, say; we choose a point y∈S' uniformly at random, and let π be the plane tangent to S' at y. Then, for each σ∈q, π separates xσ from q with probability at least [formula], say, and thus, by continuity, it intersects βq,σ. Hence there is a specific y0∈S' such that the corresponding tangent plane π0 intersects βq,σ for at least a third of the spheres σ∈q.

Moreover, we can assume that such a π0 intersects each βq,σ in such a way that all planes π parallel to π0 and sufficiently close to it intersect βq,σ as well. Then an application of Lemma [\ref=lem:x](a) allows us to assume that the restrictions of f and g to some π as above are bivariate polynomials, with at most DE common roots. Hence π intersects at most O(DE) of the curves βq,σ, and so |q| = O(DE).

Altogether, we can bound the number of h*-incidences by O(nD2 + mDE), which does not exceed the earlier estimate O(nDE). Hence choosing E as in ([\ref=eq:E]), the incidences within δ do not affect either of the asymptotic bounds ([\ref=eqn:1x]), ([\ref=eq:inc2]).

This completes the proof of Lemma [\ref=lem:2nd]. [formula]

Finishing the proof of Theorem [\ref=th:main]. We recall that in the first partitioning step, the set [formula] has been partitioned into the subsets [formula]. Each P0i consists of mi points, and it is contained in Z(fi), where fi is an irreducible factor of f, with deg (fi) = Di. By Lemma [\ref=lem:2nd] we have

[formula]

For the first term on the right-hand side we use Hölder's inequality and the inequalities [formula] and [formula]. Thus,

[formula]

For the remaining term we have

[formula]

We thus get a total of O(n3 / 2) incidences, thereby completing the proof of the theorem. [formula]

Discussion

The main technical ingredient in the analysis, on top of the standard polynomial partitioning technique of Guth and Katz, is the recursion on the dimension of the ambient manifold containing the points of P. This required a more careful construction of the second partitioning polynomial g to make sure that it is co-prime with the first polynomial f. It is reasonably easy to perform the first such recursive step, as done here and also independently by Zahl [\cite=Za], but successive recursive steps become trickier. In such cases we have several co-prime polynomials, and we need to construct, in the quotient ring of their ideal, a polynomial ham sandwich cut of some specified maximum degree with sufficiently many monomials. Such higher recursive steps will be needed when we analyze incidences between points and surfaces in higher dimensions. At the moment there does not seem to be an efficient procedure for this task. Another recent paper where similar issues arise is by Solymosi and Tao [\cite=SoTa].

We also note that Zahl's study extends Theorem [\ref=th:main] to incidences between points and more general surfaces in three dimensions. The analysis in our study can also be similarly extended (at the price of making some of the arguments more complicated), but, since our goal had been to improve the bound on unit distances, we have focused on the case of unit spheres.