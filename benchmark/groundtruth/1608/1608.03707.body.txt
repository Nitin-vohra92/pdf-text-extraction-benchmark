ABS: an Analytical method of Blind Separation of CMB B-mode from foregrounds

Introduction.-- Searching for inflationary gravitational waves through the induced CMB B-mode polarization [\cite=1997PhRvL..78.2054S] [\cite=1997ApJ...482....6S] [\cite=1997PhRvL..78.2058K] is a major endeavour of cosmology [\cite=PIXIE11] [\cite=ACTpol] [\cite=SPTpol] [\cite=POLARBEAR2] [\cite=PRISM] [\cite=BICEP2] [\cite=BICEP3] [\cite=2015PhRvL.114j1301B] [\cite=PIPER]. It will open a window into the very beginning of our universe. A major challenge is to accurately remove polarized galactic foregrounds [\cite=2015arXiv150201588P] [\cite=2015arXiv150205956P] [\cite=2015arXiv150606660P]. At CMB frequency of ~  100 GHz, a major foreground is the galactic thermal dust, which likely dominates over CMB B-mode at [formula] GHz, even for the cleanest sky areas [\cite=2015PhRvL.114j1301B]. Synchrotron emission may also be non-negligible, especially at lower frequency. Usually CMB experiments rely on multi-frequency information to remove foregrounds (e.g. [\cite=2015arXiv150201588P] [\cite=2015arXiv150205956P] [\cite=2015arXiv150606660P] [\cite=PIXIE11] [\cite=PRISM]). This kind of approaches faces two challenges. First, the exact frequency dependences of foregrounds are unknown. Even worse, recently Planck found that dust foregrounds at 217 and 353 GHz bands are decorrelated at a few percent level, which may lead to a significant bias in r (tensor-to-scalar ratio) [\cite=2016arXiv160607335P]. To avoid such potential bias, alternative methods have been constructed (e.g. [\cite=Tegmark03] [\cite=2003MNRAS.346.1089D] [\cite=SMICA]) and applied (e.g. [\cite=2015arXiv150205956P]). For example, SMICA [\cite=2003MNRAS.346.1089D] [\cite=SMICA] simultaneously fits many unknowns of CMB and foregrounds against the power spectrum measurements of all frequency bands and multipole bins.

Here we report ABS, an Analytical method of Blind Separation of CMB from foregrounds. It can be treated as post-processing on the matrix of cross bandpower between frequency bands, which are heavily compressed products of original (noisy) maps. It works on any single multipole bin. Due to the fact that CMB B-mode has a known (blackbody) frequency dependence, a set of specific linear algebra operations on this measured matrix automatically returns the bandpower [formula], the most important B-mode statistics. The measurement procedure is completely fixed by the measured matrix and survey specifications, with no assumptions on foregrounds. Since it does not rely on fitting procedures, it is numerically stable and superfast. All these are made possible by the analytical solution (Eq. [\ref=eqn:analyticalsolution]) that we discover.

The ABS Method.-- Our method works on [formula], the Nf  ×  Nf matrix of cross bandpower between the i-th and j-th frequency bands. Here [formula] and Nf is the number of frequencies. In thermodynamic units,

[formula]

Since we use the thermodynamic units, fB = 1. Dforeij is the cross bandpower matrix of foreground. It has order Nf, but its rank M depends on the number of independent foreground components. Our task is to solve Eq. [\ref=eqn:Dij] for [formula] of a single multipole [formula] bin, without assumptions of Dforeij. This may appear as a mission impossible. However, due to two facts that Nf  ×  Nf matrix Dij has only M + 1 eigenvectors and that fB(ν) is known, we are able to prove the following two key results.

The solution to DB is unique, as long as M < Nf.

The analytical solution exists, given by

[formula]

Here, the μ-th eigenvector of Dij is [formula], which has eigenvalue λμ and normalization [formula]. The eigenmodes are always ranked with decreasing order in |λμ|. Since Dij is positive definite, λμ > 0. [formula]. We show the derivation of Eq. [\ref=eqn:analyticalsolution] in the appendix. It also proves the uniqueness of the solution.

Instrument noise adds random noise δDinstij on the observed bandpower,

[formula]

Surprisingly, Eq. [\ref=eqn:analyticalsolution] can still be implemented in the data analysis, with straightforward modification to account for instrument noise.

Step 1. We compute all Nf eigenmodes of Dobsij.

Step 2. We measure DB from Eq. [\ref=eqn:analyticalsolution], but only using eigenmodes with λμ  >  σinstD.

Here σinstD is the r.m.s. of instrument noise in the bandpower. For brevity, we assume that all frequency bands have identical σinstD. Instrument noise not only affects physical eigenmodes, but also induces unphysical eigenmodes with eigenvalues of typical amplitude σinstD. Therefore we exclude eigenmodes with λμ  ≤  σinstD. This selection criteria may not be optimal, but it already works well.

The above method of measuring DB, even including the determination of M, is completely fixed by the data, and relies on no priors of foregrounds. Next we test it against simulated data with a variety of foregrounds, instrument noise and survey frequency configurations.

Simulated observations.-- To generate simulated Dobsij, we approximate δDinstij as Gaussian distributed with dispersion σinstD. σinstD is a key factor in CMB B-mode search. BICEP2/Keck has reached σinstD  ~  10- 3μK2 [\cite=2015PhRvL.114j1301B]. Future experiments can go well below 10- 4μK2. Therefore we consider σinstD∈(10- 5,10- 2)μK2.

Frequency configuration is crucial for foreground removal. We consider five configurations (S0-S4). S0 is the fiducial one, with 6 bands centered at 30, 70, 100, 150, 217 & 353 GHz (Planck-like). S1 has 4 bands at 95, 150, 220 & 270 GHz (Keck array-like, [\cite=BICEP3]). S2 adds a 35 GHz bands to S1 (BICEP array-like, [\cite=BICEP3]). S3 further adds a 353 GHz band to S2. S4 has 16 bands between 30 GHz and 320 GHz (PRISM-like [\cite=PRISM]).

Simulating Dobsij also requires Dij. For the signal, we focus on [formula] around the recombination bump. The fiducial DB = 5  ×  10- 3μK2, corresponding to the sum of r = 0.05 and the lensing B-mode. We also consider DB = 2  ×  10- 3μK2 in which the lensing B-mode dominates. Tests around [formula] of the reionization bump shows equally excellent performance.

For foregrounds, we specify [formula]. [formula] is the frequency dependence of the α-th foreground component and Dα is the bandpower amplitude. Throughout the paper, we include two polarized foregrounds (galactic dust and galactic synchrotron). When we consider decorrelation between galactic dust at different frequency, we need at least two fα(ν) to describe dust alone. Therefore M = 2 if no decorrelation and M  ≥  3 when decorrelation exists.

We consider four foreground models (case A, B, C, D, Fig. [\ref=fig:f]). They all share the same radio synchrotron foreground, but different dust foregrounds. For radio,

[formula]

Here βR = 3.3 is the frequency index and [formula]. The bandpower is normalized as 3  ×  10- 4μK2, at ν = 150GHz and [formula]. This is the observationally allowed upper limit in the BICEP2 sky [\cite=2015PhRvL.114j1301B].

For the galactic dust foreground, we adopt [\cite=2016A&A...586A.133P]

[formula]

To account for the recently detected decorrelation between different Planck frequency bands [\cite=2016arXiv160607335P], we adopt a simple model of spatially stochastic variation in the dust index βd [\cite=2015PhRvL.114j1301B]. It induces a new component in [formula],

[formula]

Here we adopt ν0 = 353 GHz. [formula] is a free parameter to control the level of decorrelation. When this stochastic component is subdominant, the cross correlation coefficient between dust in i-th and j-th bands is [formula]. The overall bandpower is normalized as 3.5μK2 at [formula] and 353 GHz [\cite=2015PhRvL.114j1301B].

We adopt 4 cases of dust parameters, (βd,Td,AS) = (1.59,19.6,0.0), (0.5,10,0.0), (1.59,19.6,0.42), (1.59,19.6,0.84). Case A is the best fit of Planck [\cite=2016A&A...586A.133P]. Case B has a factor of 10 more dust contamination at 100-150 GHz than case A, and also a much flatter spectrum. Case C has dust decorrelation between frequency bands, reproducing the Planck finding of RBB353,217 = 0.95 [\cite=2016arXiv160607335P]. Case D has unrealistically large decorrelation (e.g. RBB353,150 = 0.7). Both case B and D serve as extreme tests of our method.

Test results.-- For the S0 frequency configuration, our method faithfully extracts the input B-mode, as long as the instrumental noise is sufficiently low (Fig. [\ref=fig:ABCD80]). It is insensitive to the overall amplitude and spectral shape of galactic foregrounds. Case B has a factor of ~  10 larger dust contamination at ~  150 GHz band than case A. It also has a much flatter spectrum. Both would severely degrade the CMB extraction. However, the performance is almost as good as case A, with statistical error just 40% larger. This insensitivity of the overall foreground amplitude is also confirmed against tests at [formula] around the reionization bump (not shown in this paper), where the B-mode to foreground ratio is a factor of [formula] smaller than at [formula]. Our method also works when decorrelation of foregrounds at different frequencies exists (case C & D, Fig. [\ref=fig:ABCD80]). The price to pay is a factor of ~  4 larger statistical error (e.g. case C vs. case A).

Each error-bar shown in Fig. [\ref=fig:ABCD80] is estimated using 100 realizations of δDinstij. They agree well with the approximate result of perturbing Eq. [\ref=eqn:analyticalsolution],

[formula]

This agreement further shows the numerical stability of our method against instrument noise, even though the 1 / λμ operation in Eq. [\ref=eqn:analyticalsolution] may look scary.

Towards unbiased measurement.-- Nevertheless, we find that when instrument noise exceeds certain threshold, systematic bias develops in the extracted DB. For the S0 frequency configuration, the situation is most significant when decorrelation exists (case C and D, when [formula]). For S1, the situation worsens severely. Even for instrument noise as low as σinstD = 10- 4μK2, a systematic error of 40% of the signal and 5 times of the statistical error shows up (Fig. [\ref=fig:S1234], for case C). Adding a 35 GHz band (the S2 configuration) can significantly reduce this systematic error. But it again reaches ~  2σ when [formula]. Further adding a 353 band (the S3 configuration), the systematic error disappears until [formula]. The S0 configuration shares similar behavior as S3 (Fig. [\ref=fig:ABCD80]). Adding more frequency bands (S4) further reduces the systematic error.

These systematic errors do not reflect flaws in our method, since they are caused by the survey limitation of foreground removal. Our methodology provides a specific diagnostic for this survey limitation. Eq. [\ref=eqn:analyticalsolution] defines the contribution of each eigenmode to the measurement of DB,

[formula]

The necessary condition of unbiased DB measurement by a given survey is that all eigenmodes of significant cα must be robustly identified (λα  ≫  σinstD). Missing the α-th eigenmode, for which both large instrument noise and incomplete frequency coverage can be responsible, will bias the extracted DB high by a fraction ~  cα / (1 - cα). Instrument noise messes up physical eigenmodes with [formula]. Incomplete frequency coverage has poor capability of separating foregrounds and CMB in frequency space. It causes the existence of some eigenmodes with significant cα but tiny λα.

Fig. [\ref=fig:ev] shows λα-cα in the S0-S4 configurations, for case C and DB = 5  ×  10- 3μK2. Dij of case C has M + 1 = 4 physical eigenmodes. The first two are usually dominated by foregrounds and therefore have large eigenvalues. But due to the 1 / λμ weighting in Eq. [\ref=eqn:analyticalsolution], their impacts on the B-mode extraction are automatically suppressed to a level negligible (cα  ≪  1) . Usually both the third and fourth eigenmodes have significant cα, and therefore are important for B-mode extraction. The problem of S1 is that the fourth eigenmode has a large c4 = 0.33 but a tiny λ4 = 4.3  ×  10- 5μK2. Missing it biases DB high by ~  c4 / (1 - c4) = 50%. This explains the large bias found in S1, where [formula] (Fig. [\ref=fig:S1234]). Adding the 35 GHz band (S2) pushes λ4 = 2.4  ×  10- 4μK2, with c4 = 0.2. This significantly improves the situation, until [formula], where a bias of ~  25% = c4 / (1 - c4) develops. Adding more frequency bands further reduces the bias (S1→  S4), for fixed σinstD.

Stage-IV experiments such as PRISM and PIXIE [\cite=PIXIE11] will have dozens or more frequency bands, and low instrument noise ([formula]). Such high degree of redundancy would make them safe for even more complicated foregrounds. We expect them to achieve unbiased and precise measurement of DB (e.g. S4, Fig. [\ref=fig:S1234]).

Conclusion and discussion.-- We then conclude that our method is applicable to general case of foregrounds for blind, yet accurate, extraction of CMB B-mode. It is also numerically stable against various instrument noise. Furthermore, it can deal with other survey complexities. For example, it also applies when survey windows/masks exist, as long as we pre-process each map to have identical windows/masks. It further provides a quantitative requirement (Eq. [\ref=eqn:contribution]) for unbiased B-mode measurement, useful for design of future CMB experiments.

Our method is distinctively different to SMICA, other than sharing an identical goal to solve Eq. [\ref=eqn:Dij] for DB. (1) To our best knowledge, this is the first time that the analytical solution (Eq. [\ref=eqn:analyticalsolution]) is derived and the analytical B-mode extraction method based on it is constructed. It avoids the delicate multi-parameter fitting in SMICA, which is time consuming and is often numerically challenging. (2) The SMICA algorithm is based on the Gaussian assumption for all components and noise, which may be invalid in the real-world circumstance. In contrast, our method makes no such assumption, making it unbiased to lensing B-mode. (3) A key requirement of SMICA is constant f(α) over [formula] bins. In contrast, our method works on individual [formula] bin. It does not need such assumption at all and therefore is applicable to more general foregrounds.

Our method also works for blind measurements of CMB spectra distortion, E-mode polarization and the thermal SZ effect. Furthermore, it has important applications even in totally different areas. For example, it may serve as the ultimate solution to the original proposal of extracting cosmic magnification by counting galaxies [\cite=Zhang05]. Given its excellent performance, other potential applications should be explored too.

Acknowledgment.-- We thank Xuelei Chen, Xinjuan Yang and Yu Yu for useful discussions. This work was supported by the National Science Foundation of China (11273018, 11433001, 11320101002) and National Basic Research Program of China (2015CB857001, 2013CB834900).

Appendix: Analytical Solution of DB

From Eq. [\ref=eqn:Dij], we obtain Eμν = GμGνDB + Fμν. Here, [formula] and [formula]. Eμν is diagonal (Eμν  =  λμδμν), with order M + 1 and rank M + 1. Moving GμGνDB to the l.h.s., we obtain

[formula]

The rank of F is M, smaller than its order M + 1. As a result,

[formula]

The Sylvester's determinant theorem states that for matrices A (m  ×  n), B(n  ×  m), X(m  ×  m) and unitary matrix In (n  ×  n),

[formula]

Eq. [\ref=eqn:det] then becomes

[formula]

Since det[formula], we prove Eq. [\ref=eqn:analyticalsolution]. It also proves the uniqueness of the solution for DB from Eq. [\ref=eqn:Dij].