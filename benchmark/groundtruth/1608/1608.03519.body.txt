Lemma Corollary Remark Proposition Example Definition

Monochromatic factorisations of words and periodicity

Introduction

Give a non-empty (not necessarily finite) set [formula] let [formula] denote the free semigroup generated by [formula] consisting of all finite words [formula] with [formula] and let [formula] denote the set of all infinite words [formula] with [formula] We say [formula] is periodic if [formula] for some [formula] The following question was independently posed by T. Brown in [\cite=BTC] and by the second author in [\cite=LQZ]:

Let [formula] be non-periodic. Does there exist a finite colouring [formula] relative to which x does not admit a φ-monochromatic factorisation, i.e., a factorisation of the form [formula] with φ(ui) = φ(uj) for all i,j  ≥  1?

A finite colouring [formula] is called a separating colouring for x (or a separating |C|-colouring for x) if for all factorisations [formula] there exist i,j  ≥  1 such that φ(ui)  ≠  φ(uj). While T. Brown originally stated it as a question, Question [\ref=conj] has evolved into a conjecture which states that every non-periodic word admits a separating colouring. We begin by illustrating Question [\ref=conj] with an example: Consider the Thue-Morse infinite word

[formula]

where the nth term of x (starting from n = 0) is defined as the sum modulo 2 of the digits in the binary expansion of n. The origins of this word go back to the beginning of the last century with the works of A. Thue [\cite=Th1] [\cite=Th2] in which he proves amongst other things that x is overlap-free i.e., x contains no factor of the form uuu' where u' is a non-empty prefix of u.

Consider the 3 colouring φ:{0,1}+  →  {0,1,2} defined by

[formula]

We claim that no factorisation of x is φ-monochromatic. In fact, suppose to the contrary that [formula] is a φ-monochromatic factorisation of x. Since u1 is a prefix of x, it follows that φ(u1)∈{0,1}, i.e., there exists a∈{0,1} such that each ui is a prefix of x terminating with a. Pick i  ≥  2 such that |ui|  ≤  |ui + 1|. Then as each ui is a prefix of x, it follows that ui is a prefix of ui + 1and hence auiui is a factor of x. Writing ui = va, (with v empty or in {0,1}+), we have auiui = avava which is an overlap, contradicting that x is overlap-free. This proves that there exists a separating 3-colouring for the Thue-Morse word. Recently S. Avgustinovich and O. Parshina [\cite=AP] proved that it is possible to colour {0,1}+ using only 2 colours in such a way that no factorisation of the Thue-Morse word is monochromatic.

Let us remark in the example above that since the Thue-Morse word x is not periodic, it follows that each proper suffix x' of x begins in some factor u which is not a prefix of x. This means that x' may be written as an infinite concatenation [formula] where φ(ui) = 2 for all i  ≥  1. So while x itself does not admit a φ-monochromatic factorisation, where φ is the 3-colouring of {0,1}+ defined above, it turns out that every proper suffix of x does admit a φ-monochromatic factorisation. Moreover, this monochromatic factorisation of x' has an even stronger monochromatic property: The set {un:n  ≥  1}+ is φ-monochromatic (each element has φ colour equal to 2). This is because each element of {un:n  ≥  1} is a non-prefix of x and hence the same is true of any concatenation formed by elements from this set. It turns out that a weaker version of this phenomenon is true in greater generality: Given any [formula] and any finite colouring [formula] one can always find a suffix x' of x which admits a factorisation [formula] where [formula] for all 1  ≤  i  ≤  j. This fact may be obtained via a straightforward application of the infinite Ramsey theorem [\cite=Ram] (see [\cite=BTC] [\cite=DZ1] or see [\cite=schutz] for a proof by M. P. Schützenberger which does not use Ramsey's theorem).

Thus Question [\ref=conj] belongs to the class of Ramsey type problems in which one tries to show that some abstract form of Ramsey's theorem does not hold in certain settings. For instance, the infinite version of Ramsey's theorem [\cite=Ram] (for colouring of pairs) states that whenever the set [formula] of all 2-element subsets of [formula] is finitely coloured, there exists an infinite set [formula] with Σ2(X) monochromatic. Hence the same applies when [formula] is replaced by [formula] On the other hand, W. Sierpiski [\cite=Serp] showed that there exists a finite colouring of [formula] such that there does not exist an uncountable set X with Σ2(X) monochromatic. In other words, Ramsey's theorem does not extend to the uncountable setting in [formula] Similarly, by a straightforward application of Ramsey's theorem, one deduces that given any finite colouring of [formula] there exists an infinite [formula] all of whose pairwise sums {n + m:n,m∈X,n  ≠  m} is monochromatic. Again it follows the same is true with [formula] replaced by [formula] On the other hand, N. Hindman, I. Leader and D. Strauss [\cite=HLS] recently exhibited (using the Continuum Hypothesis CH) the existence of a finite colouring of [formula] such that there does not exist an uncountable set with all its pairwise sums monochromatic. In other words, this additive formulation of Ramsey's Theorem also fails in the uncountable setting in [formula] A related question in these sorts of problems concerns the least number of colours necessary to avoid the presence of monochromatic subsets of a certain kind. For instance N. Hindman [\cite=H] showed that there exists a 3-colouring of [formula] such that there does not exist an infinite subset X with X + X monochromatic, and it is an open question of Owings [\cite=Ow] whether the same result may be obtained with only 2 colours. Again, using CH and a few more colours (288 to be precise), it is possible to extend Hindman's result to the reals (see Theorem 2.8 in [\cite=HLS]). But again it is not known whether the same result can be obtained with only 2 colours [\cite=Leader]. Thus a stronger version of Question [\ref=conj] would read: Does every non-periodic word admit a separating 2-colouring?

Various partial results in support of an affirmative answer to Question [\ref=conj] were obtained in [\cite=BPS] [\cite=DPZ] [\cite=DZ1] [\cite=DZ2] [\cite=ST]. For instance, in [\cite=DPZ], it is shown that Question [\ref=conj] admits an affirmative answer for all non-uniformly recurrent words and various classes of uniformly recurrent words including Sturmian words. In [\cite=ST], V. Salo and I. Törmä prove that for every aperiodic linearly recurrent word [formula] there exists a finite colouring of [formula] relative to which x does not admit a monochromatic factorisation into factors of increasing lengths. And recently A. Bernardino, R. Pacheco and M. Silva [\cite=BPS] prove that Question [\ref=conj] admits an affirmative answer for all fixed points of primitive strongly recognizable substitutions. In addition to the fact that these partial results concern only restricted classes of non-periodic words (e.g., Sturmian words or certain fixed points of primitive substitutions), in most cases the number of colours required to colour [formula] in order to avoid a monochromatic factorisation of x is found to be quite high. For instance in [\cite=ST], the authors prove that if [formula] is an aperiodic linearly recurrent word, then there exists a constant K  ≥  2 and a colouring [formula] with [formula] such that no factorisation of [formula] verifying the additional constraint that |ui|  ≤  |ui + 1| for each i  ≥  1, is φ-monochromatic. The constant K above is chosen such that for every factor u of x, every first return w to u satisfies |w|  ≤  K|u| (see for instance [\cite=DHS]). A similar large bound depending on the recognizability index of a substitution is obtained in [\cite=BPS] in the context of fixed points of strongly recognizable substitutions. In contrast, it is shown in [\cite=DPZ] that every Sturmian word admits a separating 3-colouring.

In this paper we give a complete and optimal affirmative answer to Question [\ref=conj] by showing that for every non-periodic word [formula] there exists a 2-colouring [formula] relative to which no factorisation of x is φ-monochromatic. Moreover, this is a characterization of periodicity of infinite words:

Let [formula] be an infinite word. Then x is periodic if and only if for every 2-colouring [formula] there exists a φ-monochromatic factorisation of x, i.e., a factorisation [formula] such that φ(ui) = φ(uj) for all i,j  ≥  1.

Theorem [\ref=M] has several nice immediate consequences: For instance, fix a symbol [formula] and suppose an infinite word [formula] admits a factorisation [formula] where each ui is a prefix of x rich in the symbol [formula] meaning that for each i  ≥  1 and for each factor v of x with |v| = |ui| we have fa(ui)  ≥  fa(v) where fa(ui) denotes the frequency of a in ui. Then [formula] is a finite union of arithmetic progressions. As another application of Theorem [\ref=M] we show that if [formula] (with k a positive integer), then any [formula] belonging to [formula] is periodic.

Theorem [\ref=M] may be reformulated in the language of ultrafilters as follows: Let [formula] denote the Stone- Cech compactification of the discrete semigroup [formula] which we regard as the set of all ultrafilters on [formula], identifying the points of [formula] with the principal ultrafilters. As is well known, the operation of concatenation on [formula] extends uniquely to [formula] making [formula] a compact right topological semigroup with [formula] contained in its topological center (see for instance [\cite=HS]). In particular by the Ellis-Numakura lemma, [formula] contains an idempotent element i.e., an element p verifying p  ·  p = p. We show that an infinite word [formula] is periodic if and only if there exists [formula] such that for each A∈p there exists a factorisation [formula] with each ui∈A. Moreover p can be taken to be an idempotent element of [formula]

Proof of Theorem [\ref=M] & Applications

Before embarking on the proof of Theorem [\ref=M], we introduce some notation which will be relevant in what follows. Let [formula] be a non-empty set (the alphabet). We do not assume that the cardinality of [formula] is finite. Let [formula] denote the set of all finite words [formula] with [formula]. We call n the length of u and denote it |u|. The empty word is denoted ε and by convention |ε| = 0. We put [formula]. For [formula] and [formula] we let |u|a denote the number of occurrences of a in u. Let [formula] denote the set of all right sided infinite words [formula] with values in [formula] More generally, for [formula] and [formula] we write [formula] if [formula] with ui∈A for all i  ≥  1, that is in case x factors over the set A. We say x is periodic if [formula] for some [formula]

First assume [formula] is periodic, i.e., [formula] for some [formula] Then the factorisation [formula] with each ui = u is φ-monochromatic for any choice of [formula] Next assume x is not periodic and we will define a 2-colouring [formula] with the property that no factorisation of x is φ-monochromatic. Pick any total order on the set [formula] and let [formula] denote the induced lexicographic order on [formula] and [formula] For [formula] with |u| = |v|, we write [formula] if either [formula] or u = v. For each n  ≥  1, let Px(n) denote the prefix of x of length n, and for each [formula] let [formula] denote the longest common prefix of x and y.

For u∈A+, set

[formula]

As x is not periodic, for every proper suffix y of x we have either [formula] or [formula] whence [formula] is well defined.

We claim that no factorisation of x is φ-monochromatic. To see this, fix a factorisation [formula] For each k  ≥  0 put [formula] and let [formula] We note that y0 = x = w0. For each k  ≥  0 let

[formula]

so that S0 = |w0| =  +   ∞  . Clearly Sk  ≥  k for each k  ≥  0 and hence lim Sk =  +   ∞  .

Assume that φ(ui) = 0 for all i  ≥  1. Then [formula] for all k  ≥  1.

We proceed by induction on k. The result is clear for k = 1 since φ(u1) = 0. For the inductive step, fix k  ≥  1 and suppose [formula] As [formula] is a prefix of x and [formula] we can write x = wkay' and [formula] for some [formula] and [formula] with [formula] It follows that |uk + 1|  ≤  |wk| for otherwise wkb is a prefix of uk + 1 and we would have [formula] whence φ(uk + 1) = 1, a contradiction. Thus we can write wk = uk + 1v for some [formula] so that x = uk + 1vay' and [formula] Since uk + 1 is a prefix of x and φ(uk + 1) = 0, it follows that [formula] which combined with the fact that [formula] is a prefix of x implies that [formula] as required.

Assume that φ(ui) = 0 for all i  ≥  1. Then Sk  ≤  Sk - 1 for all k  ≥  1.

We first note that S1  ≤  S0 since S0 =  +   ∞  . Now fix k  ≥  1; we will show that Sk + 1  ≤  Sk. By the previous lemma we have that [formula] As in the proof of the previous lemma, we can write x = uk + 1vay' and [formula] for some [formula] [formula] and [formula] with [formula] We claim that |wk + 1|  ≤  |v|. In fact, if |wk + 1| > |v|, then vb would be a prefix of x, and hence [formula] which in turn implies that φ(uk + 1) = 1, a contradiction. Thus |wk + 1|  ≤  |v| = |wk| - |uk + 1| or equivalently |uk + 1|  +  |wk + 1|  ≤  |wk| from which it follows that Sk + 1  ≤  Sk as required.

Returning to the proof of Theorem [\ref=M], we must show that the factorisation [formula] is not φ-monochromatic. Suppose to the contrary that φ(ui) = φ(uj) for all i,j  ≥  0. If φ(ui) = 0 for all i  ≥  1, then by the previous lemma we have that Sk  ≤  Sk - 1 for all k  ≥  1 contradicting that lim Sk =  +   ∞  . If on the other hand φ(ui) = 1 for all i  ≥  1, then by replacing the original order on A by the reverse order we would have φ(ui) = 0 for all i  ≥  1, and hence as above the previous lemma yields the desired contradiction. This concludes our proof of Theorem [\ref=M].

We end this section with some applications of Theorem [\ref=M] or its proof. An infinite word [formula] is called Lyndon if there exists an order on [formula] relative to which x is strictly smaller than each of its proper suffixes. Our first application is the following result originally proved in [\cite=DPZ]:

A Lyndon word [formula] does not admit a prefixal factorisation, i.e., a factorisation of the form [formula] where each ui is a prefix of x.

Suppose to the contrary that [formula] is a prefixal factorisation of x. Let [formula] be the separating 2-colouring for x defined in ([\ref=E]). Note that x being Lyndon is not-periodic. Since x is Lyndon we have that φ(ui) = 0 for all i  ≥  1, contradicting that φ is a separating 2-colouring for x.

Let [formula] and [formula] A factor u of x is said to be rich in a if |u|a  ≥  |v|a for all factors v of x with |v| = |u|. Theorem 6.7 in [\cite=DPZ] states that a Sturmian word [formula] does not admit a factorisation of the form [formula] where each ui is a prefix of x rich in the same letter a∈{0,1}. The following generalises this result to all binary non-periodic words:

Let [formula] and a∈{0,1}. Suppose x admits a prefixal factorisation [formula] with each ui rich in a. Then x is periodic.

Suppose to the contrary that x is not periodic. Let φ:{0,1}+  →  {0,1} be the separating 2-colouring for x defined in ([\ref=E]) relative to the order on {0,1} where a is taken to be the least element. For each i  ≥  1, writing x = uiyi with [formula] we claim that [formula] Otherwise if [formula] then we can write x = zbx' = uizay' for some z∈{0,1}*, [formula] and where {a,b}  =  {0,1}. But then the factor ui' of length |ui| immediately preceding the suffix y' of x would contain one more occurrence of the symbol a than ui, contradicting that ui was rich in a. Having established that [formula] it follows that φ(ui) = 0 for all i  ≥  1 contradicting that φ is a separating 2-colouring for x.

Let [formula] be an arbitrary non-empty set, [formula] and [formula] Suppose x admits a prefixal factorisation [formula] with each ui rich in a. Then [formula] is a finite union of (infinite) arithmetic progressions.

Consider the morphism [formula] given by φ(a) = 1 and φ(b) = 0 for all [formula] Then applying φ to the prefixal factorisation [formula] gives a prefixal factorisation of φ(x) in which each φ(ui) is rich in 1. Hence by Corollary [\ref=C2] we have that φ(x) is periodic and hence the set of occurrences of 1 in φ(x), which is equal to the set of occurrences of a in x, is a finite union of arithmetic progressions.

Let [formula] and k be a positive integer. Let [formula] with Card(B)  ≥  2k - 1. Suppose that [formula] for every k-element subset A of B. Then x is periodic.

Let us assume to the contrary that x is not periodic. By Theorem [\ref=M] there exists a 2-colouring [formula] relative to which no factorisation of x is φ-monochromatic. Let Σk(B) denote the set of all k-element subsets of B. By assumption x factors over each A∈Σk(B). On the other hand, since Card(B)  ≥  2k - 1, it follows that there exists a φ-monochromatic subset A∈Σk(B). This gives rise to a φ-monochromatic factorisation of x, a contradiction.

Let [formula] and k be a positive integer. Let [formula] and suppose [formula] Then x is periodic.

Suppose to the contrary that x is not periodic. Pick any separating 2-colouring [formula] for x. Then φ(1) = φ(2i + 1) for each 1  ≤  i  ≤  k. Thus [formula] a contradiction.

A reformulation of Theorem [\ref=M] in the language of ultrafilters

In this section give an equivalent reformulation of Theorem [\ref=M] in terms of ultrafilters and the Stone- Cech compactification of the discrete semigroup [formula] We begin by recalling some basic facts. For more information we refer the reader to [\cite=HS]. Let S be a non-empty set and let [formula] denote the set of all subsets of S. A set [formula] is called a filter on S if

S∈p and [formula]

If A∈p and B∈p then [formula]

If A  ⊆  B and A∈p then B∈p.

A filter p on S is called an ultrafilter if for all [formula] either A∈p or Ac∈p where Ac denotes the complement of A, i.e., [formula] Equivalently, a filter p is an ultrafilter if for each A∈p whenever [formula] we have that at least one Ai∈p. Each x∈S determines an ultrafilter e(x) on S defined by e(x) = {A  ⊆  S:x∈A}. An ultrafilter p on S is called principal if p = e(x) for some x∈S. Otherwise p is said to be free. Let βS denote the collection of all ultrafilters p on S. By identifying each x∈S with the principal ultrafilter e(x), we regard S  ⊆  βS. If S is infinite, then a straightforward application of Zorn's lemma guarantees the existence of free ultrafilters on S.

Given A  ⊆  S, we put [formula]. Then [formula] defines a basis for a topology on βS relative to which βS is both compact and Hausdorff and the mapping x  ↦  e(x) defines an injection [formula] whose image is dense in βS. In fact, if S is given the discrete topology, then βS is identified with the Stone- Cech compactification of S: Any continuous mapping from f:S  →  K, where K is a compact Hausdorff space, lifts uniquely to a continuous mapping βf:βS  →  K. Of special interest is the case in which S is a discrete semigroup. In this case the operation on S extends uniquely to βS making βS a right topological semigroup with S contained in its topological center. This means that ρp:βS  →  βS, defined by ρp(q) = q  ·  p, is continuous for each p∈βS and λs:βS  →  βS, defined by λs(q) = s  ·  q, is continuous for each s∈S. The operation ·   on βS is defined as follows: For p,q∈βS

[formula]

where s- 1A = {t∈S:st∈A}. As a consequence of the Ellis-Numakura lemma, βS contains an idempotent element i.e., an element p verifying p  ·  p = p (see for instance [\cite=HS]). Subsets A  ⊆  S belonging to idempotents in βS have rich combinatorial structures: Let [formula] denote the set of all finite subsets of [formula] Given an infinite sequence [formula] in S, let

[formula]

where for each [formula] the product [formula] is taken in increasing order of indices. A subset A of S is called an IP-set if A contains [formula] for some infinite sequence [formula] in S. IP-sets are characterised as belonging to idempotent elements: A  ⊆  S is an IP-set if and only if A belongs to some idempotent element of βS (see for instance Theorem 5.12 in [\cite=HS]).

The following is a reformulation of Theorem [\ref=M] in the language of ultrafilters:

Let [formula] be an infinite word. Then x is periodic if and only if there exists [formula] such that for each A∈p there exists a factorisation [formula] with each ui∈A.

Suppose x is periodic, i.e., [formula] for some [formula] Then the principal ultrafilter [formula] obviously verifies the required condition of Theorem [\ref=UF]. Conversely, suppose there exists [formula] such that for each A∈p there exists a factorisation [formula] with each ui∈A. Let [formula] be any 2-colouring of [formula] We will show that x admits a φ-monochromatic factorisation. The result then follows from Theorem [\ref=M]. Consider the partition [formula] Since [formula] it follows that φ- 1(a)∈p for some a∈{0,1}. Thus there exists a factorisation [formula] with each ui∈φ- 1(a). In other words, x admits a φ-monochromatic factorisation.

We next show that p in Theorem [\ref=UF] may be taken to be an idempotent element of [formula] For [formula] we set

[formula]

and

[formula]

Thus p∈U(x) if and only if x factors over every [formula] belonging to p. Thus Theorem [\ref=UF] states that [formula] if and only if x is periodic.

Let [formula] Then the following are equivalent:

x is periodic.

U(x) is a closed sub-semigroup of [formula]

U(x) contains an idempotent element.

The set (x) consisting of all prefixes of x is an IP-set

We first note that for each infinite word x, we have that U(x) is a closed subset of [formula] In fact, suppose [formula] then there exists A∈p with [formula] Then [formula] is an open neighbourhood of p and any [formula] contains the set A and hence is not in U(x). To see that [formula] suppose that x is periodic. Pick the shortest [formula] such that [formula] Then the principal ultrafilter [formula] clearly belongs to U(x). Thus [formula] We note that if x is periodic, then U(x) also contains free ultrafilters. In fact, for each i  ≥  1, let Ai  =  {uj:j  ≥  i}. Then p∈U(x) if and only if A1∈p and any [formula] containing {Ai:i  ≥  1} is a free ultrafilter belonging to U(x). It remains to show that p  ·  q∈U(x) whenever p,q∈U(x). Let A∈p  ·  q with p,q∈U(x). Then [formula] and since p∈U(x) it follows that [formula] for some [formula] Thus [formula] and since q∈U(x) it follows that [formula] for some [formula] In other words un + m∈A and hence x factors over A. Thus p  ·  q∈U(x). The implication [formula] follows from the Ellis-Numakura lemma. To see [formula] pick an idempotent element p∈U(x). We note that (x) belongs to every q∈U(x). In fact, suppose that (x)∉q, for some q∈U(x). Then [formula] which implies that x factors over [formula] But this is a contradiction since in any factorisation of x, the first term occurring in the factorisation belongs to (x). Thus in particular (x)∈p. Since p is an idempotent, it follows that (x) is an IP-set. Finally, to see that [formula] assume that (x) is an IP-set. Then (x) contains [formula] for some infinite sequence [formula] of prefixes of x. This means that for each n  ≥  2, both [formula] and [formula] are prefixes of x. Thus x = s1x which implies that x is periodic.