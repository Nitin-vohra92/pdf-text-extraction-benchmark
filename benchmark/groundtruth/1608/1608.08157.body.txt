=4

Projecting light beams with 3D waveguide arrays

Introduction

The ability to shape the wavefront of a light beam, producing non-trivial intensity or phase patterns, is of interest for several applications. In particular, the possibility to exploit the spatial degrees of freedom of a multi-mode field to encode information has attracted increasing research in the recent years, with special interest in orbital angular momentum, both of classical and quantum light states, for free-space [\cite=wang2012] [\cite=vallone2014] [\cite=milione2015] or fiber-based communications [\cite=bozinovic2013] [\cite=vanuden2014]. Mode beams with angular momentum [\cite=rotationOT] as well as structured light [\cite=Dholakia2003] [\cite=HRD2015] are also exploited to trap and manipulate micro and nanoparticles, or even living cells, through optical forces [\cite=Padgett2013] [\cite=cellrotator2008]. In fact, the possibility to draw complex interference patterns in the propagation provides enhanced control on the particle position, rotation or movement, capabilities of former importance when dealing with the analysis and sorting of single cells.

Bulk optics components, such as phase or intensity masks [\cite=wang2012] [\cite=vallone2014] [\cite=rotationOT], as well as dynamic spatial light modulators [\cite=milione2015] [\cite=bozinovic2013] [\cite=HRD2015], are the almost exclusive choice to shape the wavefront of such free-space propagating beams. Therefore, the interfacing with fiber networks, integrated optical circuits, or fluidic lab-on-a-chips can pose stability or alignment problems, and limit the effective exploitation of the advantages of these beam shaping methods.

On the other hand, three-dimensional waveguide lattices [\cite=szameit2006] [\cite=szameit2007] [\cite=rechtsman2012] [\cite=corrielli2013] [\cite=crespi2015] [\cite=caruso2016] have emerged in the last decade as powerful devices to investigate engineered multi-mode fields. Due to the high level of control that can be achieved in such structures, they have been employed to observe fundamental effects such as spatial solitons [\cite=szameit2007] or edge states in topological insulators [\cite=rechtsman2012], as well as to simulate a variety of quantum physics phenomena[\cite=corrielli2013] [\cite=crespi2015] [\cite=caruso2016].

While waveguide lattices with a simple structure may be induced by external optical fields in photorefractive materials [\cite=fleischer2003], it was the three-dimensional fabrication capability of femtosecond laser waveguide writing [\cite=osellame2012] that fostered much of the work in this field. In fact, this micromachining technique is based on the non-linear absorption of femtosecond pulses, focused in the bulk of a dielectric material: judiciously chosen irradiation parameters result in a permanent refractive index increase, localized in the focus region. Translation of the substrate with respect to the laser beam allows to inscribe with full three-dimensional freedom the desired waveguiding paths. However, up to now, the research was mainly focused on the propagation properties of the light within the waveguide arrays and the far-field emission properties were not specifically considered.

Here, we explore the possibility to use properly engineered waveguide lattices to project free-space light beams with controlled wavefront. We numerically and theoretically investigate, also by using relevant examples, the properties of the emitted light from a pattern of waveguide modes, distributed on a two-dimensional cross-section, as it can be achieved with three-dimensional waveguide arrays. In particular we study the possibility to produce peculiar far-field distributions, and one or multiple phase singularity points. We will also show how to obtain a certain degree of control on the propagation properties of the emitted beam, including focusing.

Models and approximations

This work investigates the properties of the output emission from waveguide arrays, in which identical single-mode optical waveguides are placed in arbitrary position on a two-dimensional cross-section. We will assume that it is possible to produce arrays maintaining full control on the intensity of the different modes, as well on their relative phase. While we will not go into details of the design and engineering of the arrays, we will discuss their effective feasibility in general terms in .

We will consider the arrays as illuminated with linearly polarized light, with a fixed polarization direction. Of course, including also the polarization degree of freedom would open even wider possibilities on the achievable output light states, but this would be out of the scope of this preliminary study. We will further restrict our study to the paraxial condition.

In this framework, it is common to treat the electromagnetic field as scalar and the calculation of the field distribution during the propagation be achieved in terms of scalar diffraction theory [\cite=svelto4th] [\cite=goodman2005]. Considering our case in more detail, the output of an array of identical single-mode optical waveguides may be conveniently modelled with an array of Gaussian modes. If we drop uniform phase terms, the field of a Gaussian mode at a certain propagation coordinate z, and as a function of the transverse position [formula], reads:

[formula]

where the beam radius w and the wavefront curvature radius R depends on z as follows:

[formula]

Now, the Gaussian modes in the array are assumed to be all identical with regard to w0 (which is placed at the output facet of the array, where we can put the origin z=0), but they may have different intensity and phase terms. If [formula] are the positions of the waveguides in the transverse plane, In their intensity and αn their phase terms, the scalar field configuration of the output of an array of N waveguides can be written as:

[formula]

The above expression can be used to calculate the field distribution at an arbitrary coordinate z within the paraxial approximation, and all numerical simulations shown in this work are based on that.

Polygonal arrays and angular momentum

Optical beams possessing angular momentum have attracted increasing interest in the recent years, for diverse applications: on the one hand orbital angular momentum is a powerful degree of freedom for encoding information, both classical and quantum [\cite=wang2012] [\cite=vallone2014]; on the other hand the possibility to exert torque on trapped microparticles opens novel possibilities in optical micromanipulation [\cite=hong2015]. In this scenario it can be important to produce such vortex beams directly from optical fibers and waveguides, with reduced or no use of bulk optical components, which require critical alignment. Different approaches have been proposed, from ring resonators [\cite=cai2012] to circular gratings [\cite=doerr2011] [\cite=su2012], to hybrid plasmonic waveguides [\cite=liang2014].

Three-dimensional waveguide arrays have been also recently investigated to this purpose. Markin and coauthors proposed to directly excite supermodes of a triangular array of coupled waveguides, having cyclical phase distribution, by means of a phase-matched nonlinear process [\cite=markin2013]. Guan et al. showed the possibility to encode 15 different states with cyclical phase distribution in a set of 16 non-coupled waveguides, placed on the vertices of a regular polygon: this was achieved by splitting the light in the different waveguides with an integrated-optics star coupler and by using thermo-optic phase shifters for fine adjustment of the phase terms [\cite=guan2014]. However, these previous works were limited to the study of the propagating field within the array or to the near field distribution, while the far-field distribution was not studied or employed.

As a matter of fact, one could show that a single linearly-polarized mode or supermode,or a set of separated linearly-polarized waveguide modes has in each point a transverse component of the Poynting vector with vanishing time average (see [\ref=appendixVanishingOAM]). This prevents light propagating on that mode or those modes to have a physical, non-vanishing, longitudinal angular momentum within the array, even in limited regions. However, this does not hold for overlapped optical modes in free space propagation, and thus stimulates the investigation of the free-space beams emitted at the output of this kind of waveguide arrays.

Namely, we study the far-field distribution produced by the output of an array of N waveguides, placed (in the cross-section) at the vertices of a regular polygon, with a cyclical phase distribution, similar to the one demonstrated in Ref. [\cite=guan2014]. As discussed in , the near field of the output of such an array can be described with good approximation as a set of Gaussian optical modes, that we place in the positions:

[formula]

where R0 is the radius of the polygon, and we consider the phases of the different modes to be arranged as:

[formula]

shows some examples of near-field and far-field distributions for some of the simplest cases in which l = 1 (phases make a 2π round-trip around the polygon), and polygons with N = 4, 6, 8. We consider mode size (2 ~ w0 = 15 μm) and wavelength (λ = 633 nm) commonly employed in three-dimensional waveguide arrays fabricated by femtosecond laser writing [\cite=szameit2006]. The far-field distribution is calculated by directly evaluating for z = 15 mm. The presence of a phase singularity in the center of the far-field distribution is easily observed in all cases, associated with an intensity distribution that closely resembles the typical doughnut shape of the Laguerre-Gauss modes, i.e. the archetypical examples of beams with non-vanishing angular momentum [\cite=allen1992].

The presence of a phase singularity in the center of these field distributions is shown analytically in [\ref=appendixLaguerreGauss]; in particular, it is shown that , which describes the field of the array, converges to

[formula]

for small r and for large z (r, φ and z are the radial, azimuthal and longitudinal coordinates respectively). Indeed, this same expression can be found as a limit for small r in the case of Laguerre-Gauss beams [\cite=allen1992] or Bessel beams [\cite=mcgloin2005] of order l, which are well-known examples of beams carrying orbital angular momentum. Thus, this ensures that the beam is carrying orbital angular momentum proportional to l in its central region.

In fact, field distributions with different angular momentum values can be produced as shown in , which reports the far-field distribution of a polygonal waveguide array with N = 10 waveguides, and phases arranged cyclically for different values of l in . Different phase vortices can be realized with both clockwise and counter-clockwise orientation, depending on the sign of l. On the other hand, for l = 0 the far-field distribution converges to a pattern with a single peak in the middle. The doughnut shape of the intensity distribution is less defined for increasing |l|; in fact, the doughnut would extend farther from the center, where the approximations of [\ref=appendixLaguerreGauss] become less accurate. We can further observe that the periodicity of the phase cycle needs not to be commensurate with the number of waveguides composing the array; for instance it is possible in our case to achieve l = 3. Finally, we should of course note that it is not possible to effectively produce vortices with l equal or higher than N / 2: from the sampling theorem it is clear that in N distinct phase values (as available in N waveguides) there would not be enough information to produce such vortices.

Towards more complex field configurations

We shall now discuss the potentials of our approach in producing more complex far-field distributions.

The first case we consider is illustrated in . Eight waveguides are placed on the vertices of an octagon, and are divided into two series (say, the odd waveguides and the even waveguides). All waveguide modes carry the same intensity. The odd modes have cyclic phases arranged in counter-clockwise direction, while the even modes have cyclic phases arranged in clockwise direction. A phase shift Δ is further added to the phases of the even modes. This produces the two-lobes far-field distributions, whose orientation depends on Δ, that can be seen in (b) and (c).

If only the odd or even waveguides were present, we would observe in the far-field a vortex beam distribution such as those in , with an asymptotic similarity (in the central part) to the Laguerre-Gauss modes with l = ±  1, as shown in [\ref=appendixLaguerreGauss]. However, here we have the linear combination of two vortices with opposite direction. It is known that the equally weighted combination of two Laguerre-Gauss modes with l = ±  1 produces a two-lobe Hermite-Gauss mode, oriented along an axis which depends on the phase delay between the two Laguerre-Gauss modes. Indeed, we observe an analogous behaviour in .

We find this example interesting because it shows the possibility to change profoundly both the phase and the intensity profile of the far-field just by acting on the phase terms of the modes in the array, starting from the same balanced intensity distribution. In fact, from the same eight waveguides arranged on the vertices of an octagon, one could produce phase vortices with different orientation or vorticity such as the ones in , or other configurations with zero angular momentum such as the ones in , just by acting on those phases. In waveguide devices, one may think of accurately controlling such phase terms even in a dynamic fashion, by e.g. thermo-optic phase shifters [\cite=guan2014] [\cite=flamini2015].

To guide the design process of waveguide arrays that produce phase and intensity patterns in the far-field with even richer features, it can be useful to go back to a more general picture of the involved diffraction phenomena. In fact, in the Fraunhofer diffraction condition, i.e. for sufficiently large z, it is well known that the far-field can be approximated by the Fourier transform of the near-field [\cite=goodman2005]. More precisely, by dropping common phase terms, one can write in our case:

[formula]

where the transform F is defined as:

[formula]

and indeed consists in a properly scaled two-dimensional Fourier transform. Practically, the far-field distribution in our case is given by an interference pattern, which is the Fourier transform of the position of the modes, modulated by the diffraction pattern of a single waveguide mode [formula].

One can think, as a consequence, to devise the structure of a waveguide array by, first, anti-transforming a certain desired far-field distribution, and then trying to approximate with a pattern of Gaussian modes (with identical shape but different phases or intensities) the result of this anti-transformation. Naturally, knowledge of the fundamental properties of the Fourier transform is of great help. In particular, it may be useful to remind that the transform of a regular lattice of peaks is again a regular lattice (the reciprocal lattice). Far-field configurations showing regular lattice structure may thus be easier to reproduce by means of the far-field emission of a waveguide array (with a certain amount of regularity).

shows two peculiar examples, that have been engineered following the above described procedure, i.e. by approximating with the waveguide position, intensity and phases, the anti-transform of a certain desired far-field. The first one (pictures on the top row) was designed looking for an "eyeglass" shape, with two counter-rotating and neighbouring phase vortices. The starting point to devise the second one (pictures on the bottom row) was a 2×  2 matrix of phase singularities, two encircled by a clockwise phase orientation, two encircled by phases rotating in the opposite direction. It can be observed that the achieved far field configurations, that show two or four main points of phase singularity, can be produced by very simple dispositions of few Gaussian modes, provided that the relative phases and intensities are set with sufficient accuracy. It may also worth noting that the spiralling phase structure, which is easily observed around the phase singularity points in figures [\ref=fig:DifferentPolygons] or [\ref=fig:DifferentAngularMomentum] here is not apparent, because it is dominated by the radial phase variation due to the curvature of the wavefront.

Propagation of the projected beam

Having shown the possibility to engineer the intensity and phase distributions in the far-field, it can be interesting to analyse the intensity pattern of the projected beams during their propagation. In fact, as we will show, by properly designing the waveguide position and phases it is possible to influence relevant properties of the propagating beam, such as the focus position.

We can start our analysis from the case of the polygonal arrays, already discussed in for what concerns the far-field. As already observed (see ), if the waveguide phases are all equal to each other, the projected beam shows in the far-field an intensity pattern with a single peak in the middle, surrounded by a less intense ring, a distribution that is similar to that of a zero-order Bessel beam. A Bessel beam is usually realized by illuminating an axicon with a Gaussian beam or by placing an annular aperture in the back focal plane of a focusing lens [\cite=mcgloin2005]. A similar configuration can be easily achieved through the use of few waveguides positioned on the vertices of a polygon. A field distribution with a spatial profile approaching that of a Bessel beam can indeed be obtained, as shown in , by exploiting an array with N = 8 waveguides placed on the vertices of a regular octagon of radius R0 = 25 μm. Bessel beams are ideally supposed to be non-diffracting beams, a peculiar property that can be of interest in many application. However in practical cases they show this behaviour only in a limited region, the so-called Bessel zone, which can be estimated by calculating the propagation length where the intensity of the central peak is higher or equal to half of the maximum intensity.

In (a) we report the evolution of the intensity of the central peak along the propagation direction. From the analysis of the curve we can estimate the length of the Bessel zone, which is approximately 2 mm long, i.e. much longer than the Rayleigh range of a Gaussian beam with the same wavelength and waist as the waveguides of the array, which is about zR = 0.28 mm. In (b) we also report the transverse intensity pattern at specific propagation distances, that is, in the near-field at z = 0 mm, at the coordinates where the axial intensity is equal to the maximum value, to its half and finally at a large distance, which can be considered in the far-field. It can be observed that in the first part of the propagation a reshaping of the intensity pattern of the array occurs, reaching a Bessel-like distribution with a central peak surrounded by rings where the intensity is maximum. Afterwards, the beam conserves its shape during the propagation, showing only a diffraction of the pattern. We calculated also the spot size parameter of the beam [\cite=svelto4th] at various distances, defined as wx,y(z)  =  2σx,y(z) where σ2x,y is evaluated along the x or y coordinate as:

[formula]

The result is shown in , and confirms the beam divergence during the propagation. We can thus conclude that the near-field configuration considered in this example experiences a reshaping of the spatial intensity pattern with a sort of focusing after ~  1.3 mm of propagation.

It is well known in diffractive optics that, by governing the phase front in the near field, it is possible to control the intensity pattern along the propagation, e.g. to achieve focusing or to engineer the shape of the focus itself. As an example, phase shaping has also been used to make the peak intensity evolution of a Bessel-gauss beam uniform within the Bessel zone [\cite=Moloney2013].

Here, we can think of moving the focus position by properly adjusting the position and phases of the waveguides in polygonal arrays, in particular considering the propagation of the field emitted by waveguides positioned on annuli with different radii and phase shifts. This configuration can be assimilated to that of a Fresnel lens, which is made of a series of concentric rings with different radii, each designed to diffract light so as to obtain constructive interference in the position where the focus is desired. This condition can be achieved by adjusting the phases of the waveguides in each ring according to the following equation:

[formula]

where f is the desired focal distance and [formula] the radial coordinate of the waveguide position. As an example, we consider a near-field pattern where the waveguides are distributed over two concentric rings with radii R1 = 25 μm and R2 = 45 μm. By adjusting the phases in such a way that the condition of constructive interference is satisfied for a focal distance of 2 mm, we obtain the translation of the propagation distance at which the intensity is maximum from z = 1.3 mm, as obtained with only one ring, to z = 2 mm. The results are shown in the top row of , where we report the transverse intensity pattern at different propagation distances. Finally it is worth noting that, if one can separately act on the phase terms of a large number of waveguides, an efficient focusing can be obtained also when starting from a random distribution of the waveguides in the array, provided that the phases are properly set by the relation . An example of the intensity pattern that can be achieved at different propagation distances is reported in , where, starting from a near-field configuration of 16 waveguides randomly distributed in a 50 μm radius circular area, a focal zone is obtained after 2 mm of propagation. To evaluate the focusing efficiency we calculated the spot dimension at 1/e2 and the ratio between the fraction of power confined in this region for the configuration in analysis, and for a Gaussian beam. The random configuration shown in yields a focusing efficiency of 50%, higher than the efficiency of 28% that we achieved in the two-rings case.

Feasibility considerations and conclusions

Before concluding, we should consider whether the devices and waveguide configurations presented in the previous sections can be effectively fabricated, or our essay has to be considered a mere speculation. The three-dimensional capabilities of femtosecond laser writing technology certainly enables to produce arrays of waveguides with arbitrary positions in the cross-section [\cite=szameit2006] [\cite=rechtsman2012] [\cite=caruso2016]. However, it may be more difficult to divide the input light, e.g. from an optical fiber, into the waveguides of the array with the required different amplitude ratios and phases.

To this purpose, a very general scheme may be a generalisation of the one adopted in Ref. [\cite=guan2014], where the integrated circuit is divided into three sections. The first section consists in a power dividing device, such as a star coupler or a cascade of directional couplers, to split the input light from the fiber into different branches with the required amplitude ratios. The second section consists in an array of phase shifters (e.g. thermo-optic devices) that allow to tune the phase terms of each waveguide. These sections may be fabricated in the plane and possibly with lithographic technologies. A third section transforms the waveguides from a planar arrangement to the required two-dimensional cross-section, bringing each waveguide to its final position. This needs to be realized by femtosecond laser writing due to the three-dimensionality of the layout. To minimise unwanted parasitic coupling between the waveguides, in the region where they are brought close together to produce the final setting, one might fabricate neighbouring waveguides with sufficiently different propagation constants, so that evanescent field coupling is quenched. With a higher technological effort, the first two sections may be integrated in a single fully-reconfigurable multiport interferometer that enables realising arbitrary unitary transformations between the input and the output waveguides [\cite=carolan2015]. This would also permit to associate to each different input waveguide a different output configurations, provided that the chosen alternative output configurations are orthogonal supermodes.

As a matter of fact, the capabilities of femtosecond laser waveguide writing could allow reducing the three sections to a single three-dimensional interferometer, at least for specific applications. Let us consider, as an example, a possible way to produce different vortex configurations, as in , with the same physical array of N waveguides. The different vortex configurations have all the waveguides excited with the same amplitude; the phase terms however are arranged cyclically, with different periodicity. These field configurations may be produced with a N-inputs-N-outputs device that implements the Fourier transform of the input modes [\cite=barak2007]: by exciting a different input of the device, a different phase arrangement of the output would be produced. Compact integrated optical circuits performing this operation have been indeed recently demonstrated experimentally [\cite=crespi2016]. In the light of these considerations, our approach looks reasonably at reach of current technology. In particular, we have shown that it is possible to design waveguide arrays emitting at the output light beams with one or more phase singularity points, possibly carrying non-zero angular momentum. Focusing beams can also be produced, by adequately controlling the phase terms. In addition, the investigation of the far-field distribution here presented is immediately applicable to the distribution in the focal plane of a lens.

This work paves the way to other investigations that could deepen many aspects here just mentioned. For instance, for free-space communication purposes it will be required to understand how to optimize the array design to minimize cross-talks between the emitted modes [\cite=zhao2015]. The capability to build multi-mode interferometric circuits that associate to each different input a different emitted supermode (e.g. with a different value of angular momentum), could be conveniently used as angular momentum or space division multiplexer/demultiplexer from a fiber optics networks [\cite=su2012] [\cite=cai2012] [\cite=guan2014]. In quantum optics applications, this would also allow to transfer entanglement from the waveguide path to the angular momentum or other spatial degree of freedom of the photons [\cite=fickler2014].

Benefits are also envisaged in optofluidics where lab-on-a-chips are used for single cell manipulation through optical forces [\cite=yang2016]. Indeed the integration of engineered waveguide arrays in optofluidic lab-on-a-chips could allow to implement tweezing or manipulation functionalities, as the control of the particle rotation in the optical trap for imaging and analysis purposes, which nowadays require bulk optics equipment. Unexpected applications might also be found in beam shaping for structured illumination, optical filtering or imaging tasks.

Vanishing angular momentum within the array

We will show here that light propagating in a set of linearly-polarized and spatially separated guided optical modes cannot carry longitudinal angular momentum. The supporting dielectric structure and refractive index distribution will be considered as uniform along the z axis, so that such axis is a well defined propagation direction and the optical mode profiles extend in the xy plane.

The propagating electromagnetic field of each mode, in each point, decomposed into its transverse and longitudinal components, takes the form:

[formula]

The transverse Poynting vector, responsible for the longitudinal angular momentum, can be written as:

[formula]

and its time average is:

[formula]

If [formula] and [formula] are taken as real, it naturally holds that [formula] and [formula]. It is then easy to observe that, in each point [formula]. Since the transverse component of the angular momentum density, with respect to an arbitrary point O, is [formula], in each point of the mode field its time average will be vanishing:

[formula]

The overall angular momentum of the n-th mode field would be [formula], where the integration is performed over all the volume of the space and only the contribution of the n-th waveguide field has been considered. It is clear from that also the time average of the overall angular momentum is vanishing.

If we consider a set of well-separated modes, the overall angular momentum of the field is just [formula], which has also vanishing time-average. The field of an array of well separated, linearly polarized, optical guided modes, thus possesses no angular momentum. Excitation of several overlapped modes is a necessary condition to have angular momentum within the array: in fact, in that case, since the modes are overlapped, the Poynting vector of the resulting field is not in general equal to the sum of the Poynting vector of the modes.

Phase singularity in the far-field of a polygonal waveguide array

We derive here an asymptotic expression for the center of the far-field distribution of a polygonal waveguide array, as those described in , valid in the limits of large propagation coordinate z and small distances r from the center.

We consider N Gaussian modes, monochromatic and linearly polarized, all having their waist at z = 0 coordinate, and centered on the vertices of a regular polygon: [formula]. All the Gaussian modes have the same intensity, but different phase terms, arranged in a cyclical configuration [formula]. The scalar field, at a certain plane z, has the form :

[formula]

where [formula], k  =  2π  /  λ, [formula] and ρ(z) is the curvature radius of the wavefront. It can be assumed ρ(z)≃z for z sufficiently large. u0(z) is a normalization factor which includes common z-dependent phase terms.

We start by expanding the squares in the arguments of the exponentials in , as [formula], so that:

[formula]

In the far field, i.e. for z sufficiently large, [formula], thus:

[formula]

where all the constant terms have been included in u'(z).

We shall now focus on the central part of the beam and we seek for a power series limit of , valid for small r. In particular, we consider: We note that in the same limit, since [formula] we have also (and with much better approximation) r  ≪  w(z).

This allows to substitute the last exponential in the sum with its power series expansion, and to approximate [formula], i.e.:

[formula]

We should now try to understand which is the first relevant power of r, at which we can truncate the power-series expansion. It is known that, in general, [formula] where several Cp,m may be vanishing, but Cm,m  ≠  0. This means:

[formula]

where:

[formula]

It is easy to show that [formula] is vanishing except in the case l =   ∓  p. Therefore:

[formula]

In conclusion, the first relevant power of m in , i.e. the smallest one that is multiplied by a nonvanishing coefficient, is m = |l|. In fact, it is for that power of m that first appear a sum of the kind with l =   ∓  p. Hence, by collecting all constants in u''0, we can write:

[formula]

References