= = =

Lemma Claim Corollary Proposition Open Question

On Curves over Finite Fields with Jacobians of Small Exponent

Keywords:

Jacobian, group structure, distribution of divisors

2000 Mathematics Subject Classification:

11G20, 11N25, 14H40

Introduction

Let [formula] denote the Jacobian of a curve C defined over a finite field I Fq of q elements. We denote by [formula] the exponent of [formula] (that is, [formula] is the largest order of elements of the Abelian group [formula]) and by g the genus of C. We start with recalling two well know facts.

The Weil bound implies that

[formula]

see Corollary 5.70, Theorem 5.76 and Corollary 5.80 of [\cite=ACDFLNV]. In particular, for fixed g,

[formula]

The Jacobian [formula] is an Abelian group with at most 2g generators, that is, for some positive integers [formula] we have

[formula]

(in particular [formula] if the rank of [formula] is 2g  -  j) and also

[formula]

see Proposition 5.78 of [\cite=ACDFLNV].

Thus we see [formula] where m2g is defined by the representation [\eqref=eq:Jac_Struct], which together with [\eqref=eq:Jac_Card] implies the following trivial bound

[formula]

For elliptic curves C  =  E over finite fields the exponent [formula] has been studied in a number of works, see [\cite=Duke] [\cite=LuMcKSh] [\cite=LuSh] [\cite=Schoof] [\cite=Shp], with a variety of results, each of them indicating that in a "typical case" [formula] tends to be substantially larger than the bound [\eqref=eq:Exp_Trivial] guarantees. However for general curves the behavior of [formula] has not been studied. Let π(x) denote the number of primes p  ≤  x. W. Duke [\cite=Duke], among other results, has proved that for a sufficiently large x and all but o(π(x)) of prime powers q  ≤  x, the bound

[formula]

holds for all elliptic curves E defined over I Fq (the paper [\cite=Duke] considers only primes, but including all prime powers in the statement is trivial of course).

We provide a generalization and some improvement of [\eqref=eq:Duke's_bound] for curves of arbitrary genus.

Fix g  ≥  1 and let ε(x) be a positive, decreasing function of x with ε(x)  →  0 as x  →    ∞  . For all but o(π(x)) of the prime powers q  ≤  x, the bound

[formula]

holds for all curves C of genus g defined over I Fq.

The method of proof of [\eqref=eq:Duke's_bound], used in [\cite=Duke], is somewhat specific to elliptic curves, so here we use a slightly different approach to counting fields I Fq that may contain a "bad" curve.

We show that Theorem [\ref=thm:Exp_Large] is best possible for g = 1 and g = 2. In particular, the bound [\eqref=eq:Duke's_bound] of W. Duke [\cite=Duke] is quite sharp.

For any fixed ε  >  0 there exists α  >  0 such that for sufficiently large x, there are at least απ(x) primes q  ≤  x such that for some nonsupersingular elliptic curve E and some nonsupersingular curve C of genus g = 2 defined over I Fq, the bounds

[formula]

hold.

The proof is based on a special case of a certain lower bound on the number of shifted primes p - 1 having a divisor in a given interval. In full generality this bound is given in Theorem 7 of [\cite=Ford]. Such results have been applied to study the order of a given integer a > 1 modulo almost all primes p, see [\cite=ErdMur] [\cite=IndlTim] [\cite=Papp], and now they have turned out to be useful for studying exponents of Jacobians. This argument also immediately implies the following result which applies to all curves over I Fq of all possible genera.

Let ε(x) be a positive, decreasing function of x with ε(x)  →  0 as x  →    ∞  . For all but o(π(x)) of the prime powers q  ≤  x, the bound

[formula]

holds for all curves C of arbitrary genus defined over I Fq.

Throughout the paper, the implied constants in the symbols 'O', '≪  ' and '≫  ' do not depend on any parameter unless indicated by a subscript, that is, Og, ≪  g or ≫  g (we recall that the notations U  =  O(V), U  ≪  V, and V  ≫  U are all equivalent to the assertion that the inequality |U|  ≤  cV holds for some constant c > 0).

Acknowledgments. The authors would like to thank Bjorn Poonen for a number of very helpful discussions. During the preparation of this paper, K. F. was supported by NSF grants DMS-0301083 and DMS-0555367 and I. S. was supported in part by ARC grant DP0556431.

Preliminaries

We have already mentioned that our results are based on some estimates from [\cite=Ford] on shifted primes having a divisor in a given interval. Here we give a brief guide to these estimates.

As in [\cite=Ford] we use H(x,y,z) to denote the number of positive integers n  ≤  x having a divisor d with y  <  d  ≤  z. Theorem 1 of [\cite=Ford] gives the right order of magnitude of H(x,y,z) in the full range of parameters. However for our purposes we need only the estimate

[formula]

where

[formula]

and u is defined by the equation y1  +  u  =  z, which holds uniformly in the range 2y  ≤  z  ≤  y2, [formula].

Furthermore, we need the upper bound on H(x,y,z) only as tool of estimating H(x,y,z,Pλ) which is the number of primes p  ≤  x such that p + λ has a divisor d with y  <  d  ≤  z. Theorem 6 of [\cite=Ford] gives the upper bound

[formula]

which holds for every fixed non-zero integer λ in the range z  ≥  y  +  ( log y)2 / 3 and [formula], which is much wider than is necessary for the purposes of this paper.

We also need Theorem 7 of [\cite=Ford] which gives a lower bound on H(x,y,z,Pλ) in a certain range of x,y,z. However, since its proof is quite short, we give an independent derivation in Section [\ref=sec:Thm_2].

Proof of Theorem [\ref=thm:Exp_Large]

The number of prime powers q = pa  ≤  x with a  ≥  2 is O(x1 / 2). Thus, it suffices to show that for all but o(x /  log x) of the primes q with x / 2  <  q  ≤  x, the bound

[formula]

holds for all curves C of genus g defined over I Fq.

For a (2g - 1) - tuple [formula] of positive integers, we consider the set [formula] of primes x / 2  ≤  q  ≤  x for which there exists a curve C of genus g  ≥  1 over I Fq such that m1  =  k1, mi  =  mi - 1ki, where mi is as in [\eqref=eq:Jac_Struct] and [\eqref=mgq1], [formula]. In particular, if such a curve C exists, then

[formula]

Since

[formula]

we see by [\eqref=eq:Jac_Card] that there are at most

[formula]

possibilities for the cardinality [formula].

For each of such values N, we see by [\eqref=eq:Jac_Card] that

[formula]

Recalling [\eqref=eq:_q-1_congr] we deduce that for each possible cardinality N the prime powers q may take at most

[formula]

values. Therefore, combining [\eqref=eq:Set_N'] and [\eqref=eq:Set_q'], we derive

[formula]

When g = 1, we interpret the right side as 5(x1 / 2 + 1)3k- 31  +  (x1 / 2 + 1)2k- 21.

For any curve C of genus g  ≥  1 over I Fq and any positive integer s  ≤  2g - 1, we have

[formula]

In fact, we only need [\eqref=eq:m2g_lower] for s = g and s = 2g - 1.

Suppose without loss of generality that ε(x)  ≥  ( log x)- 1 / 2 and write η  =  ε(x / 2). Assume x is large, in particular so large that

[formula]

Let I be the interval (x1 / 4 - 3η,x1 / 4 + 3η]. Let K denote the set of [formula] satisfying

[formula]

Partition the primes q∈(x / 2,x] into three sets: T1 is the set of such primes for which q - 1 has a divisor in I, T2 is the set of such primes lying in a set [formula] with [formula], and T3 is the set of remaining primes. By Theorems 1 and 6 of [\cite=Ford], that is, by a combination of [\eqref=eq:Hxyz] and [\eqref=eq:HxyzP], we have

[formula]

Now consider q∈T2. By [\eqref=eq:k2],

[formula]

hence [formula] by [\eqref=eq:k1]. Combined with [\eqref=eq:Qki], [\eqref=eq:k3], and the inequality ki  ≤  (x1 / 2 + 1)2g for each i, we obtain

[formula]

Together with [\eqref=eq:T1], we see that all but o(x /  log x) primes q∈(x / 2,x] lie in T3. For q∈T3, the condition [\eqref=eq:k1] holds, thus either [\eqref=eq:k2] is false or [\eqref=eq:k3] is false. In either case, the bound [\eqref=eq:m2g_lower] implies that [formula], and hence for large x

[formula]

for any curve C of genus g defined over I Fq.

Proof of Theorem [\ref=thm:Duke's_bound]

We start with the case g = 1.

Without loss of generality we can assume that ε  <  1 / 20. Put

[formula]

Since y > x1 / 5, an integer k  ≤  x can have at most 4 prime factors p with y < p  ≤  z. Hence, the set P of primes x /  log x  ≤  q  ≤  x such that q - 1 has a prime divisor p with y < p  ≤  z, is of cardinally least

[formula]

where, as usual, π(x;k,a) is the number of primes q  ≤  x with [formula].

By the Bombieri-Vinogradov theorem (see, for example, Section 28 of [\cite=Dav]),

[formula]

Therefore

[formula]

By the Mertens theorem (see Theorem 4.1 of Chapter 1 in [\cite=Prach]),

[formula]

thus for large x we have #  P  ≥  απ(x) for a positive α depending on ε. This result is a special case of Theorem 7 of [\cite=Ford], but we include the proof because it is short.

For a sufficiently large x and for any q∈P, there are at least 2q1 / 2z- 2  -  1  ≥  qε integers k∈[q  +  1  -  2q1  /  2,q] with p2|k for some prime p|q - 1 with y  <  p  ≤  z. For any such k, by [\cite=Ruck] [\cite=TsfVlad] [\cite=Voloch] one can always find an elliptic curve E over I Fq with E(I Fq)  =  k of I Fq-rational points and the exponent [formula]. This concludes the proof in the case g = 1.

For g = 2, Proposition 5.4 in Section 5 of Chapter X of [\cite=Silv] implies that the cardinalities of elliptic curves E over I Fq with j-invariant j(E) = 0,1728 take O(1) values. Therefore we can choose k and an elliptic curve E over I Fq of exponent [formula] as in the above with the additional condition j(E)  ≠  0,1728. By Corollary 6 of [\cite=HLP] we see that there is a curve C of genus g = 2 such that the Jacobian [formula] is isogenous to E(I Fq)  ×  E(I Fq). Moreover, there exists an isogeny from E(I Fq)  ×  E(I Fq) to [formula], whose kernel (over an algebraic closure of I Fq) is isomorphic to [formula]. So [formula], which concludes the proof for g = 2.

Proof of Theorem [\ref=thm:Exp_Large_Any_g]

The desired bound follows immediately from Theorems 1 and 6 of [\cite=Ford], that is, from [\eqref=eq:Hxyz] and [\eqref=eq:HxyzP], and the congruence [formula], where mi, [formula], are as in [\eqref=eq:Jac_Struct]. Again without loss of generality assume that ε(x)  ≥  ( log x)- 1 / 2. For η = 2ε(x / 2), similarly to [\eqref=eq:T1], we see that the set R of primes q  ≤  x such that q - 1 has a divisor m∈[x1  /  2   -   2η,x1  /  2   +   2η], is of cardinality #  R  =  o(x /  log x). Consider a prime q∈(2x1 - η,x] which does not lie in R, and any curve C of genus g over I Fq. If mg > x1 / 2 + η then

[formula]

Otherwise, by [\eqref=mgq1], mg  ≤  x1 / 2 - 2η and by [\eqref=eq:Jac_Card] we obtain

[formula]

for large x.

Remarks

It is interesting to note that using [\eqref=eq:m2g_lower] for other values of s (besides s = g and s = 2g - 1 as in the proof of Theorem [\ref=thm:Exp_Large]) and thus corresponding sets K, does not lead to any improvements.

Open Question. Is the exponent in Theorem [\ref=thm:Exp_Large] sharp for arbitrary g  ≥  3, as it is for g = 1,2?

Unfortunately the lack of knowledge about the distribution of possible cardinalities of Jacobians of curves of genus g  ≥  2 prevents are from deriving an analogue of Theorem [\ref=thm:Duke's_bound] for g  ≥  2.