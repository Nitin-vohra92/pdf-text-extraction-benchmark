Determination of the large scale volume weighted halo velocity bias in simulations

Introduction

Large scale peculiar velocity is maturing as a powerful probe of cosmology. Peculiar velocity directly responds to the gravitational pull of all clustered matter and energy, making it a precious tool to study dark matter (DM), dark energy, and the nature of gravity (e.g. [\cite=Peacock01] [\cite=Zhang07c] [\cite=Guzzo08] [\cite=Jain08] [\cite=Li13]). Measuring peculiar velocity at cosmological distances with the conventional method of distance indicators is challenging, albeit improving (e.g., [\cite=Johnson14] [\cite=Watkins14]). Alternatively, redshift space distortion (RSD) provides a way of measuring peculiar velocity at cosmological distances, free of the otherwise overwhelming contamination of Hubble flow. It enables ~  1% accuracy in the velocity power spectrum measurement at z  ~  1 (e.g. Fig. 2.3, [\cite=BigBOSS]), through stage IV dark energy surveys such as DESI and Euclid.

A profound assumption in cosmology based on peculiar velocity is that the velocity bias bv of galaxies vanishes at large scales (bv = 1), namely, that the galaxy velocity field is statistically identical to that of the matter velocity field at large scales. The strong equivalence principle predicts that galaxies sense the same acceleration as ambient DM particles. Hence, one would naturally expect statistically identical velocity for galaxies and DM particles, at [formula] scales where the only operating force is gravity. However, a loop hole in this argument is that galaxies and their host halos only reside in special regions (local density peaks). The same environmental difference is known to cause bv < 1 in proto-halos [\cite=BBKS] [\cite=DesjacquesI] [\cite=DesjacquesII] [\cite=Elia12] [\cite=Baldauf14] [\cite=Biagetti14]. However, due to the stochastic relation between proto-halos and real halos [\cite=Colberg00], it is non-trivial to extrapolate this prediction to real halos where galaxies reside. Since [formula] at large scale, uncertainties in bv lead to systematic error in all existing fD measurements [\cite=Chuang13],

[formula]

Here [formula] and D is the linear density growth factor. Therefore we have to understand bv to 1% or better to make the peculiar velocity competitive with other dark energy probes.

A key intermediate step to understand the galaxy velocity bias is to understand the halo velocity bias . N-body simulations are ideal to robustly clarify this issue. What is most relevant for cosmology, in particular RSD cosmology, is the volume weighted halo velocity bias at large scales . Unfortunately, measuring the volume weighted velocity statistics through inhomogeneously and sparsely distributed particles/halos is highly challenging, due to a sampling artifact [\cite=DTFE96] [\cite=Pueblas09] [\cite=paperII] [\cite=Zhang14] [\cite=Zheng14a] [\cite=Jennings14].

This sampling artifact arises from the fact that we only have information of velocities at positions of particles/halos. Therefore the sampling of the volume weighted velocity field is incomplete. Even worse, since the particle/halo velocity field is correlated with the particle/halo distribution, the sampling of volume weighted velocity field is imperfect. Such completeness and imperfection leads to inaccurate measurement of velocity statistics, which we call the "sampling artifact". For sparse populations, it can cause ~  10% systematic underestimation of the velocity power spectrum at k = 0.1h / Mpc [\cite=Zhang14] [\cite=Zheng14a] [\cite=Jennings14]. Even worse, it also depends on the intrinsic LSS (large scale structure) fluctuation in the particle distribution and its correlation with velocity [\cite=Zheng14a]. This sampling artifact is by itself unphysical, in the sense that it solely arises from the limitation of robustly measuring the volume weighted velocity statistics given the inhomogeneously and sparsely distributed velocity data. Given its existence, the rawly measured velocity bias from simulation is a mixture of the real velocity bias and the sampling artifact in the following form:

[formula]

Namely, the raw bias measurement v is wrong by a multiplicative factor caused by the sampling artifact. Without rigorous correction, the sampling artifact can be misinterpreted as a significant velocity bias and mislead the peculiar velocity cosmology.

Therefore, robustly understanding the sampling artifact is a prerequisite for reliably measuring the true velocity bias. For this purpose, we developed the theory of the sampling artifact in [\cite=Zhang14] and rigorously confirmed the existence of the sampling artifact in simulations [\cite=Zheng14a]. We further tested the theory against simulations and improved it to 1% accuracy at k = 0.1h / Mpc for populations with number density [formula][\cite=Zheng14a]. In particular, [\cite=Zheng14a] demonstrates the sharp distinction between a real velocity bias and the sampling artifact, for DM samples. It first constructs samples with a fraction of the simulation DM particles randomly selected from all the simulation particles. By construction, the velocity statistics of the random samples shall be statistically identical to those of the sample including all simulation DM particles. Namely bv(DM) = 1. However, the raw measurement shows v(DM)  ≠  1 of high significance [\cite=Zheng14a]. The fake v(DM)  ≠  1 then clearly demonstrates the sampling artifact (Eq. [\ref=eqn:SA]).

In the current paper, we applied this improved understanding of the sampling artifact [\cite=Zhang14] [\cite=Zheng14a] to robustly eliminate it in velocity measurement and correctly determine the true volume weighted halo velocity bias for the first time. This differs from existing numerical works on measuring velocity bias [\cite=Colin00] [\cite=Elia12] [\cite=Baldauf14] [\cite=Jennings14], which either focus on proto-halos, the density weighted halo velocity statistics, or the volume weighted halo velocity mixed with the sampling artifact.

Simulation specifications

We analyze the same J1200 N-body simulation in [\cite=Zheng14a], run with a particle-particle-particle-mesh (P3M) code [\cite=Jing07]. It adopts a ΛCDM cosmology with Ωm = 0.268, ΩΛ = 0.732, Ωb = 0.045, σ8 = 0.85, ns = 1 and h = 0.71. It has 1200Mpc / h box size, 10243 particles and mass resolution of [formula]. The halo catalogue is constructed by Friends-of-Friends (FOF) method with a linking length b = 0.2. Gravitationally unbound "halos" have been excluded from the catalogue. In total we have [formula] halos with at least 10 simulation particles, at z = 0. We choose the mass weighted center as the halo center and the velocity averaged over all member particles as the halo velocity. We try three mass bins detailed in table [\ref=Table:massbin].

Correcting the sampling artifact

We aim to measure the halo velocity bias defined in Fourier space,

[formula]

The subscript "E" denotes the gradient (irrotational) part of the velocity, which is most relevant for peculiar velocity cosmology. The subscripts"h" and "DM" refer to halos and DM simulation particles respectively. Throughout this paper, we restrict ourself to the volume weighted power spectrum. We adopt the NP (Nearest Particle) method [\cite=paperII] to sample the velocity field on 2563 uniform grids. Before correcting the sampling artifact, the measured velocity power spectrum P̂E(k) differs from its true value by a factor [formula]. We found that [\cite=Zheng14a]

[formula]

Here, [formula] is the deflection field pointing from a particle used for velocity assignment to the corresponding grid point to which the velocity is assigned. Reference [\cite=Zhang14] showed that [formula] fully captures the sampling artifact. ξD is the spatial correlation of [formula]. For α = 1 / 2 and n̄P  ~  10- 3(Mpc / h)- 3, CT(k) agrees with the actual C(k) to ~  1% at k  ≤  0.1h / Mpc [\cite=Zheng14a]. The subscript "T" denotes that it is our theory prediction. We caution that the theoretically predicted CT(k) may deviate from the true C(k) since the theory prediction is not exact. Furthermore, C (or CT) of dark matter particles can differ from that of dark matter halos.

We take two steps to correct for the sampling artifact. Step one. We use Eq. [\ref=eqn:CT] to correct for the bulk of the sampling artifact. Step two. There are residual sampling artifact since our theory is not perfect (CT  ≠  C). We further correct this residual sampling artifact with the aid of DM control samples (DMCs). They are constructed by randomly selecting simulation DM particles from the full simulation sample with the requirement σD(DMC) = σD(halo) . [formula] is the dominant factor determining the sampling artifact [\cite=Zhang14] [\cite=Zheng14a]. The halo sample and DMCs have identical sampling artifact at the k  →  0 limit and similar sampling artifact elsewhere. Hence to greater accuracy than Eq. [\ref=eqn:CT], we expect Ch,T / Ch≃CDMC,T / CDMC. The subscripts "h" and"DMC" denote properties of halos and DM control samples, respectively. We then obtain

[formula]

The terms on the r.h.s. are, respectively, the raw velocity bias measurement without correcting the sampling artifact, the step one correction, and the step two correction. PvDM,E is measured from the full J1200 simulation sample, which is essentially free of sampling artifact due to its high n̄P [\cite=paperII]. All the correction terms (Ch,T, CDMC,T and CDMC) are directly calculated from the J1200 simulation.

The inaccuracy of Eq. [\ref=eqn:c2] increases with k. For peculiar velocity cosmology to be competitive, at least we shall utilize measurement at k  ≤  0.1h / Mpc. So we choose k = 0.1h / Mpc as the pivot scale for quoting the accuracy. Overall we expect ~  1% accuracy , extrapolating from the DM cases. We caution the readers on this ~  1% uncertainty in the measured bv(k) (Figs. [\ref=fig:bva] & [\ref=fig:bvb]). Somewhat arbitrary, we quote the systematic error in the measured bv as 2% at k < 0.1h / Mpc. Therefore, only if |bv - 1| > 0.02 at k < 0.1h / Mpc, are we capable of detecting a non-unity velocity bias. More accurate measurement of velocity bias requires better correction of the sampling artifact to below 1%, either by improved modelling of the sampling artifact, or by improved velocity assignment method (e.g. [\cite=yukriging]).

No velocity bias at [formula]

Figs. [\ref=fig:bva] & [\ref=fig:bvb] show bv for all mass bins listed in Table 1. The raw measurements suggest an "anti-bias", unanimous for all mass bins at all redshifts. This is most significant for the more massive bin A1, reaching bv  ~  0.9 at k = 0.1h / Mpc (Fig. [\ref=fig:bva]). Possibly by coincidence, this "anti-bias" agrees well with theoretical predictions of proto-halos based on linear/Gaussian statistics. However, we have solid evidences that it is essentially an illusion caused by the sampling artifact. The sampling artifact causes systematic suppression of Pv [\cite=Zhang14] [\cite=Zheng14a] [\cite=Jennings14], mimicking an anti-bias. In another word, the apparent "anti-bias" is unreal in the sense that is unrelated to the true velocity statistics of halos and is irrelevant for cosmology.

Theoretically, we expect the sampling artifact to exist for any populations of inhomogeneously distributed objects, and its impact to be significant for sparse populations [\cite=Zhang14]. It has been robustly detected for the case of DM simulation particles [\cite=paperII] [\cite=Zheng14a]. Therefore, it must also exist for DM halos [\cite=Zhang14]. Fig. [\ref=fig:sa] further consolidates this theoretical prediction. It shows that the DM control samples containing a fraction of DM simulation particles have smaller Pv than the full DM sample at [formula]. Furthermore, Pv decreases with decreasing number density. If the number densities of these DM control samples match those of halo samples, their Pv match each other closely, especially at k < 0.1h / Mpc. This behavior holds for all three mass bins and four redshifts investigated. The DM control samples are constructed by randomly selecting DM simulation particles, so by construction the difference in Pv to the full DM sample should not exist and any difference must be caused by the sampling artifact. The similarities between DM control samples and halo samples then strongly suggest that the "anti-bias" implied by the raw measurement is merely the sampling artifact and is therefore unrealistic. The bin A1 with [formula] is a factor of ~  10 more sparse than A2 with [formula], so it suffers from a larger sampling artifact, ~  10% at k = 0.1h / Mpc.

Hence, it is essential to correct for the sampling artifact. After applying the two step corrections (Eq. [\ref=eqn:c2]), the "anti-bias" disappears and we find bv(k  ≤  0.1h / Mpc) = 1 within 2σ statistical uncertainty, for the A1 bin at all redshifts. Taking the extra 2% systematic uncertainty into account, we find no evidence on a non-unity velocity bias at k  ≤  0.1h / Mpc for halos bigger than [formula]. At k  ≤  0.1h / Mpc, bv of bin A2 after correcting the sampling artifact shows statistically significant evidence for bv > 1, opposite to the "anti bias" that raw measurement suggests. However, once the 2% systematic uncertainty is taken into account, again we find no evidence for bv  ≠  1 at k  ≤  0.1h / Mpc (perhaps except z = 2).

How solid are these results? To check it, we construct a mass bin B with [formula]. It has identical large scale LSS fluctuation as DMCs, so we can better handle its sampling artifact by comparing with DMCs. Thus we treat the bv measurement of bin B as the most accurate halo velocity bias measurement that we can achieve. Again we find bv = 1 at k  ≤  0.1h / Mpc. Therefore we conclude that bv = 1 at k < 0.1h / Mpc within 2% model uncertainty. Settling the issue of whether bv = 1 at greater accuracy requires further improvement over existing understanding of the sampling artifact [\cite=Zheng14a] or better velocity assignment method.

The vanishing velocity bias (bv = 1) within 2% model uncertainty at k < 0.1h / Mpc verifies a fundamental assumption in peculiar velocity cosmology. However, from the theoretical viewpoint, this result is quite surprising, as linear theory predicts bv(k = 0.1h / Mpc)≃0.9 for [formula] proto-halos (peaks in initial/linearly evolved density field)[\cite=BBKS] [\cite=DesjacquesI] [\cite=DesjacquesII] [\cite=Baldauf14] [\cite=Biagetti14]. The predicted bv < 1 arises from correlation between density gradient and velocity at initial density peaks. A number of processes may weaken/destroy this correlation and hence make the velocity bias disappear. First is the stochasticity in proto halo-halo relation. A fraction of halos today do not correspond to initial density peaks and a fraction of initial density peaks do not evolve into halos today (e.g. [\cite=Colberg00]). Second, halos move from their initial positions. They tend to move towards each other and, hence, modify their velocity correlation. Third, the density and velocity evolution has non-negligible nonlinearity (e.g. [\cite=Colberg00] [\cite=paperII]), and, hence, non-Gaussianity. This alters the predicted velocity bias based on Gaussian statistics.

Velocity bias bv  ≠  1 at [formula]?

On the other hand, at [formula] there are signs of bv  ≠  1 and signs of mass and redshift dependences. (1) For mass bin A2, the data suggest that bv > 1 and bv - 1 increases with increasing k and z. The excess is statistically significant at z = 2 and k  ≥  0.1h / Mpc. (2) In contrast, bin A1 ([formula]) has bv(k > 0.1h / Mpc) < 1 at the 1% to 10% level, which is also statistically significant.

Due to the opposite signs of bv - 1 for more and less massive halos, an even more significant behavior is that smaller halos seem to move faster at k > 0.1h / Mpc and the difference reaches 10% at k  ~  0.15h / Mpc. If this difference is indeed intrinsic, instead of a residual sampling artifact, it could be caused by different environments where different halos reside. Small halos tend to live in filaments and have extra infall velocity with respect to large halos. The infall velocity has a correlation length of typical filament length of tens of Mpc, and, hence, shows up at [formula]. Unfortunately, our understanding of the sampling artifact at k > 0.1h / Mpc is considerably poorer [\cite=Zheng14a]. Therefore we are not able to draw decisive conclusions, other than that cosmology based on the peculiar velocity at [formula] must keep caution on this potential velocity bias.

Conclusions and discussions

This paper presents the first determination of volume weighted halo velocity bias through N-body simulations. The raw measurements suffer from a severe sampling artifact which could be misinterpreted as a significant "velocity bias." We are able to appropriately correct the sampling artifact following our previous works [\cite=Zhang14] [\cite=Zheng14a] and measure the physical velocity bias. Two major findings are as follows:

bv = 1 at k  ≤  0.1h / Mpc within 2% model uncertainty. It consolidates the peculiar velocity cosmology;

Signs of bv  ≠  1 at [formula] and signs that bv - 1 depends on redshifts, scales and halo mass. Although we are not able to robustly rule out the possibility of a residual sampling artifact, it raises the alarm of using [formula] velocity data to constrain cosmology.

Accurate measurement of the velocity bias in simulations heavily relies on robust correction of the sampling artifact. The sampling artifact depends on not only the halo number density, but also on the intrinsic LSS fluctuation of the halo distribution and its correlation with the halo velocity field [\cite=Zheng14a]. It is for this reason that our understanding of the sampling artifact at k  ~  0.1h / Mpc so far is no better than 1%. Therefore, we caution the readers that the measured velocity bias has ~  1% (or somewhat arbitrarily 2%) model uncertainty (systematic error). For a similar reason, we cannot fully quantify the accuracy of Eq. [\ref=eqn:c2] and the accuracy in the sampling artifact corrected bv . We know it is more accurate than Eq. [\ref=eqn:CT] and have estimated its accuracy by extrapolating from the DM cases [\cite=Zheng14a]. Nevertheless, this ambiguity prevents us from drawing an unambiguous conclusion on whether the found bv  ≠  1 at k > 0.1h / Mpc is real, or whether bv deviates from unity by less than 1% at k < 0.1h / Mpc. Therefore a major future work will be to improve understanding of the sampling artifact (e.g., discussions in the Appendix of [\cite=Zheng14a]). Furthermore, we will explore other velocity assignment methods which may alleviate the problem of the sampling artifact. We will also extend to galaxy velocity bias with mock galaxy catalogues, where the sampling artifact should also be corrected.

Finally, we address that the RSD determines velocity indirectly through the galaxy number density distribution and, therefore, the RSD inferred velocity statistics can be free of the sampling artifact. This is another advantage of RSD over conventional velocity measurement methods. It is only when comparing the RSD determined velocity power spectrum with that measured in simulations that we must worry about the sampling artifact in the simulation part.

Acknowledgement.-- We thank Cris Sabiu's for his help in proofreading this paper. This work was supported by the National Science Foundation of China (Grants No. 11025316, No. 11121062, No. 11033006, No. 11320101002, and No. 11433001), the National Basic Research Program of China (973 Program 2015CB857001), the Strategic Priority Research Program "The Emergence of Cosmological Structures" of the Chinese Academy of Sciences (Grant No. XDB09000000), and the key laboratory grant from the Office of Science and Technology, Shanghai Municipal Government (No. 11DZ2260700).