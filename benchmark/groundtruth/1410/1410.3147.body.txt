Lemma Corollary Remark

Linear bounds on matrix extremal functions using visibility hypergraphs

Lilly Shen Department of Mathematics MIT Massachusetts, U.S.A. geneson@math.mit.edu lshen01@college.harvard.edu

Introduction

For a collection S of 0 - 1 matrices, let the weight extremal function exs(n,S) denote the maximum number of ones in an n  ×  n 0 - 1 matrix which avoids every matrix in S, and let the column extremal function exsk(m,S) denote the maximum number of columns in a 0 - 1 matrix with m rows which avoids every matrix in S and has at least k ones in every column.

The 0 - 1 matrix weight extremal function was used to bound the complexity of an algorithm for minimizing rectilinear path distance while avoiding obstacles [\cite=Mit]. Weight extremal functions of 0 - 1 matrices have also been used to bound the maximum number of unit distances in a convex n-gon [\cite=Fure], the number of edges in ordered graphs on n vertices avoiding fixed ordered subgraphs [\cite=KM] [\cite=PT], and the maximum length of sequences which avoid fixed subsequences [\cite=Pet].

The column extremal function of matrices is the analogue of a sequence extremal function, the maximum number of letters in a sequence with m contiguous blocks of distinct letters that avoids a fixed subsequence (or collection of subsequences) and has at least k occurrences of each letter. This sequence extremal function was bounded for alternations and collections of sequences called (r,s)-formations in [\cite=Niv]. The column extremal functions for collections of matrices called doubled (r,s)-formations were bounded in [\cite=CK]. Both the weight and the column extremal functions of permutation matrices were used in [\cite=Fox] to improve upper bounds on the Stanley-Wilf limits of forbidden permutations.

Since an n  ×  n matrix has n2 entries, then exs(n,S)  ≤  n2 for every collection S of 0 - 1 matrices. If S contains only one matrix M, then we write exs(n,S)  =  ex(n,M) and exsk(m,S)  =  exk(m,M). If M has at least two ones, then ex(n,M)  ≥  n since a matrix with ones only in a single column or a matrix with ones only in a single row avoids M.

Furedi and Hajnal asked for a characterization of all 0 - 1 matrices P such that ex(n,P)  =  O(n) [\cite=FH]. A corresponding problem for the column extremal function is to characterize all 0 - 1 matrices P with j rows such that for every fixed k  ≥  j, exk(m,P)  =  O(m). Another related problem is to characterize all 0 - 1 matrices P for which [formula].

Fulek [\cite=Ful] found bounds on the extremal functions of the patterns L1 and L2 (Figure [\ref=Lpatt]) using visibility representations constructed by treating rows of a given n  ×  n matrix as vertices and projections of ones on lower rows as edges. He bounded the number of ones in the matrix by limiting the multiplicity of edges in the visibility representation based on the forbidden 0 - 1 matrices.

In Section [\ref=prelim] we prove some general facts about exs(n,S) and exsk(m,S). In Section [\ref=bar] we define bar visibility hypergraphs, bound their number of edges, and use these bounds to show that ex(n,L3)  =  O(n) and [formula] (Figure [\ref=Lpatt1]). We also bound the extremal functions of forbidden collections of 0 - 1 matrices corresponding to bar visibility hypergraphs.

Facts about exs(n,S) and exsk(m,S)

If k  >  m, then exsk(m,S)  =  0 for any collection S. If k  ≤  m and every matrix in S has at least k rows with ones, then exsj(m,S)  =    ∞   for j  <  k since a matrix with m rows, any number of columns, and ones in every entry in the first j rows avoids every matrix in S.

If some matrix in S has k rows and c columns, then [formula] for all j  ≥  k. This is because a matrix A with [formula] columns, in which every column contains at least j ones, must contain c columns with ones in the same k rows by the pigeonhole principle, so A contains the matrix in S with k rows and c columns.

Let ex(m,n,P) (resp. exs(m,n,S)) be the maximum weight of an m  ×  n matrix which avoids the 0 - 1 matrix P (resp. collection S), so that ex(n,P)  =  ex(n,n,P). For every column of P, draw a segment connecting the topmost and bottommost ones. Call P range-overlapping if, for every pair of columns of P, there exists a horizontal line passing through the corresponding segments of both columns.

For any range-overlapping P, ex(m,n,P)  ≤  k(exk(m,P) + n).

Let A be a 0 - 1 matrix with m rows, n columns, and ex(m,n,P) ones which avoids P. Consider column c in A. Starting from the top of c, divide its ones into clusters of size k, deleting the at most k - 1 remaining ones in the column. Move each cluster g after the first cluster horizontally to a new column immediately to the right of the column containing the cluster which was above g in the original column. Delete any columns with no ones. Call the newly formed matrix A', and suppose that A' has n' columns.

Suppose for contradiction that A' contains P, and consider two cases. If the copy of P in A' contained at least two columns that originated from the same column c, then P could not be range-overlapping because the construction separated columns of A into clusters with non-range-overlapping row indices to obtain A'. If the copy of P in A' only contained columns derived from different original columns, then the original matrix A also contained P, a contradiction.

Therefore, A' cannot contain P. In our construction, we deleted a maximum of n(k - 1) ones. Each column of A' contains k ones, so ex(m,n,P)  ≤  k(n' + n)  ≤  k(exk(m,P) + n).

If S is a collection of 0 - 1 matrices, c is a constant, and g is a function such that exs(m,n,S)  ≤  g(m) + cn for all m and n, then [formula] for k  >  c.

Fix k  >  c. Any matrix with m rows, exsk(m,S) columns, and k ones per column which avoids S has at most exs(m,exsk(m,S),S)  ≤  g(m)  +  exsk(m,S)c ones. Therefore exsk(m,S)k  ≤  g(m) + exsk(m,S)c, so [formula] for all m.

If S is a collection of 0 - 1 matrices such that exs(n,S)  =  O(n) and every matrix in S contains the 2  ×  2 identity matrix or two ones in the same row, then [formula].

Since [formula], the upper bound follows from Lemma [\ref=reverse]. For the lower bound, let K be the matrix with m rows and [formula] columns obtained from an [formula] identity matrix by replacing every row r in the identity matrix with the [formula] submatrix consisting of k adjacent copies of r and then adding rows full of zeroes at the bottom until K has m rows. Let K' be obtained from K by reflecting over a vertical line. Then [formula] since K' avoids S.

Marcus and Tardos [\cite=MT] showed that ex(n,P)  =  O(n) for any permutation matrix P, solving the Stanley-Wilf conjecture. Call a 0 - 1 matrix light if it has no pair of ones in the same column. The Marcus Tardos theorem was generalized in [\cite=G] to show that ex(n,Q)  =  O(n) for any light 0 - 1 matrix Q such that for every two columns c0 and c1 in Q with ones in the same row r, all columns between c0 and c1 also contain ones in row r. Corollary [\ref=linear] can be applied to the matrices Q to show that [formula], as well as to the matrices L1 and L2 in [\cite=Ful].

Let Pr,c denote the r  ×  c matrix filled with ones. We find the exact value of exk(m,Pk,c) using a simple counting argument, and then bound exk(m,Pr,c) for all k  ≥  r.

[formula].

There exist [formula] possible configurations of k ones in columns of height m. By the pigeonhole principle, a matrix with [formula] columns must have a configuration of k ones that occurs in at least c columns. Therefore, [formula]. We can obtain the same lower bound by constructing a matrix with every possible configuration c - 1 times; this matrix avoids Pk,c. Hence, [formula].

For all fixed k  ≥  r, exk(m,Pr,2)  =  θ(mr).

First observe that exr(m,Pr,2)  =  O(mr), according to the last lemma. Since exk(m,P) is decreasing in k for every P, exk(m,Pr,2)  =  O(mr) for k  ≥  r.

For any 0 - 1 matrix M, let GM be the graph obtained from M by letting every column of M be a vertex and adding an edge between two vertices if and only if their corresponding columns have ones in exactly r - 1 common rows. Note that r - 1 is the maximum number of rows a pair of columns may share without containing Pr,2. We proceed by induction on k to prove that exk(m,Pr,2)  =  Ω(mr).

The first case is k  =  r. The last lemma implies that [formula]. Observe that if M is a 0 - 1 matrix with m rows and r ones in each column which avoids Pr,2, then the maximum degree of any vertex of GM, Δ(GM), is at most r(m - r).

Fix k  >  r. Let M be the matrix obtained in the last inductive step avoiding Pr,2 with m'  ≤  xm rows, [formula] columns, and k - 1 ones in each column, such that Δ(GM)  ≤  ym for some constants x and y that depend only on r and k.

Using a greedy algorithm, color the vertices in GM using Δ(GM) + 1 colors so that no two vertices with a common edge have the same color. Let [formula] be the coloring function. Construct a new matrix M' from M by adding Δ(GM) + 1 new rows to the bottom of M with a one in row m' + r of column b if and only if C(b) = r. Since Δ(GM)  ≤  ym, the resulting matrix M' has at most xm + ym + 1 rows.

Fix a column b of M'. A column c is a neighbor of b in GM' but not in GM only if there are exactly r - 2 rows in M which have ones in both b and c, and b and c were assigned the same number in the coloring of GM. Since b has k - 1 rows with ones in M, there are [formula] ways to choose r - 2 rows that contain ones in column b of M. For every set of r - 2 rows in which column b has ones in M, there are at most [formula] possible new neighbors c of b in M' with ones in those rows, since every pair of new neighbors of b in GM' with ones in those r - 2 rows get the same color in GM and thus have no common rows in M containing ones besides the r - 2 rows each neighbor shares with b. Then [formula], completing the induction.

We proved that for each k  ≥  r, there exists a constant ar,k such that [formula]. To generalize the bounds for all integral values of m, let n satisfy ar,kn  ≤  m  ≤  ar,k(n + 1) and observe that [formula]. Hence exk(m,Pr,2)  =  θ(mr) for all fixed k  ≥  r.

For all fixed k  ≥  r and c  ≥  2, exk(m,Pr,c)  =  θ(mr).

For c  ≥  2, exk(m,Pr,c)  ≥  exk(m,Pr,2) since Pr,c contains Pr,2. Therfore exk(m,Pr,c) = Ω(mr) for all k  ≥  r. Since [formula], then exk(m,Pr,c)  =  O(mr) for all k  ≥  r. This shows that exk(m,Pr,c) = θ(mr) for all fixed k  ≥  r and c  ≥  2.

If P is a 0 - 1 matrix with r rows which contains Pr,2, then exk(m,P)  =  θ(mr) for all fixed k  ≥  r.

Bar s-visibility hypergraphs and 0 - 1 matrices

A bar s-visibility hypergraph's vertices are finite, disjoint, horizontal bars in the plane and its edges are subsets of vertices of size s + 2 for which a vertical segment exists which intersects only the vertices in the edge. Using the fact that every bar visibility graph (i.e. bar 0-visibility hypergraph) is a planar graph, Fulek converted 0 - 1 matrices into bar 0-visibility hypergraphs to prove linear bounds on the extremal functions of patterns L1 and L2 [\cite=Ful].

For r,s  ≥  0, define Tr,s to be the collection of matrices M which have r + s + 2 rows and r + 2s + 2 columns such that M restricted to the first s + 1 columns and rows [formula] is a (s + 1)  ×  (s + 1) permutation matrix, M restricted to the last s + 1 columns and rows [formula] is a (s + 1)  ×  (s + 1) permutation matrix, M restricted to the middle r columns and the last r rows is an r  ×  r permutation matrix, and M has ones in the middle r columns in row 1. For example T1,0 contains a single 3  ×  3 matrix with four ones in a diamond formation. One of the patterns in T4,1 appears in Figure [\ref=trs], with black squares representing ones and white squares representing zeroes.

We extend the method from [\cite=Ful] to show that exs(n,Tr,s)  =  O(n) and [formula] for all r,s  ≥  0. The first step is to prove a linear bound on the number of edges in a bar s-visibility hypergraph with n vertices. This proof is similar to the proof of the maximum number of edges in bar s-visibility graphs with n vertices in [\cite=Dean]. We assume that all bar endpoints have distinct coordinates since this does not decrease the maximum number of edges.

All bar s-visibility hypergraphs with n vertices have at most (2s + 3)n edges.

Scan any representation of the given bar s-visibility hypergraph in the plane from left to right, making a list of distinct edges. Add an edge to the list whenever the scan for the first time shows part of the representation in which a vertical segment can be drawn which intersects each of the vertices in the edge. Then edges will only be added to the list whenever the scan passes the left or right end of some bar.

For each bar B, the maximum possible number of edges added to the list when the scan passes the left end of B is s + 2 since there are at most s + 2 vertical segments representing different edges which pass through the left end of B and through s + 1 other bars. The maximum possible number of edges added to the list when the scan passes the right endpoint of B is s + 1, since at the right endpoint of B there are at most s + 1 vertical segments representing different edges which pass through s + 2 bars other than B, at least one of which is below B and at least one of which is above B. Then there are at most (2s + 3)n edges on the list since the representation contains n bars.

In the next lemma, we change 0 - 1 matrices avoiding Tr,s into bar s-visibility hypergraphs, and then show that the resulting hypergraphs have edge multiplicity at most r - 1.

For all r  ≥  0 and s  ≥  0, exs(n,Tr,s)  =  θ(n).

Let M be an n  ×  n matrix which avoids Tr,s. Define M' to be the matrix obtained from M by deleting the first s + 1 and last s + 1 ones in every row, and the last r ones in every column. Construct a representation of a bar s-visibility hypergraph H from M' by drawing a bar in each row that contains a one in M' with left end at the first one of M' in the row and right end at the last one of M' in the row. For each one in M' with at least s + 1 ones below it in M', draw a vertical line segment representing an edge starting from the one and extending through s bars until reaching the (s + 1)st bar below the one.

Suppose for contradiction that H contains some edge e with multiplicity at least r. Let [formula], in order from top to bottom, be the rows of M' which contain the vertices in the edge e, and let [formula] be columns of M' which contain r vertical segments representing the copies of e. Let [formula] be distinct rows of M such that vi contains one of the bottommost r ones of ci for each [formula]; let [formula] be distinct columns of M such that di contains one of the s + 1 leftmost ones of ui for each [formula]; and let [formula] be distinct columns of M such that ei contains one of the s + 1 rightmost ones of ui for each [formula]. Then the submatrix of M consisting of rows [formula] and columns [formula] contains a matrix in Tr,s, a contradiction.

Then every edge of H has multiplicity less than r, so the number of ones in M is at most (3s + 3 + r)n + (r - 1)(2s + 3)(n - r).

Observe that every element of Tr,s contains the pattern L3 for r  ≥  3 and s  ≥  1, which implies the following corollary.

ex(n,L3)  =  θ(n).

The next two corollaries follow from Corollary [\ref=linear].

[formula].

[formula].

Acknowledgments

The authors thank the Research Science Institute, the MIT math department, Tanya Khovanova, Pavel Etingof, and Slava Gerovitch for supporting this research.