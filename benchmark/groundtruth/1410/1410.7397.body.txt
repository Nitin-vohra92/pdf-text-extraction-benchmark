WISE photometry for 400 million SDSS sources

Introduction

In astronomical survey projects, it is common practice to produce a catalog of detected and measured sources, using only data from the survey itself. This approach has the benefit that the survey can be thought of as an independent experiment, but the disadvantage that it ignores the huge amount of information we already have about astronomical sources measured in previous surveys covering the same part of the sky. While new surveys typically bring some new capability that previous surveys lacked (eg, depth, resolution, or wavelength coverage), it is seldom the case that a new survey surpasses all previous data in all regards; there is usually some complementary information that could be of value.

This approach of compiling "independent" catalogs has two shortcomings, in particular when it comes to comparing the new survey with existing surveys. First, when the new survey has lower resolution, there will be some nearby sets of sources that are blended together (detected and measured as a single source) in the new catalog, but resolved in existing data. Second, when the new survey has lower sensitivity (at least to some types of sources), sources known from previous surveys will not be detected in the new survey and will not appear in its catalog. When investigators attempt to cross-match the new catalog with existing catalogs (usually via astrometric cross-matching), the first problem (blended sources) typically results in either failed matches (because the blended source has a different centroid), or very strange inferred properties (for example, bizarre colors because the new survey matches the sum of a set of sources to a single source in the existing survey; or unexpected non-matching sources). The second problem (non-detections) means that fewer sources are available to cross-match; a catalog cross-match is limited by the weaknesses of both catalogs.

In contrast, in this paper we perform "forced photometry" of a new survey (WISE) given a great deal of knowledge from an existing survey (SDSS). While WISE has comparable depth to SDSS for many sources, its resolution is significantly lower. We therefore get significant benefit from using SDSS detections to decide where to look in the WISE data.

The Wide-Field Infrared Survey Explorer (WISE; [\citealt=wright]) measured the full sky in four mid-infrared bands centered on 3.4 μm, 4.6 μm, 12 μm, and 22 μm, known as W1 through W4. During its primary mission, it scanned the full sky in all four bands. After its solid hydrogen cryogen ran out and W4 became unusable, it continued another half-sky scan in W1, W2, and W3. During the "NEOWISE post-cryo" continuation ([\citealt=mainzer]), it continued to scan another half-sky in W1 and W2. Over 99% of the sky has 11 or more exposures in W3 and W4, and 23 or more exposures in W1 and W2. Median coverage is 33 exposures in W1 and W2, 24 in W3, and 16 in W4. In December 2013, WISE was reactivated and is expected to complete several more full scans of the sky in W1 and W2 ([\citealt=mainzer2014]).

The WISE team have made a series of high-quality data releases, the most recent of which is the AllWISE Data Release. The AllWISE Release includes a source catalog of nearly 750 million sources, a database of photometry in the individual frames at each source position, and "Atlas Images": coadded matched-filtered images. The AllWISE Atlas Images were intentionally convolved by the point-spread function (PSF), making it challenging to use them for forced photometry. Instead, we use the "unWISE" coadds from [\citet=unwise], which preserve the resolution of the original WISE images.

The Sloan Digital Sky Survey (SDSS; [\citealt=york]) imaged over 14, 000 square degrees of sky in five bands (u, g, r, i, z), detecting and measuring over 400 million sources. We use the imaging catalogs from SDSS-III Data Release 10 ([\citealt=sdss3] [\citealt=dr10]). These catalogs contain the outputs of the Photo pipeline ([\citealt=lupton]), and include star/galaxy separation and galaxy shape measurements using either exponential, de Vaucouleurs, or composite (sum of exponential and de Vaucouleurs) profiles.

The combination of data from SDSS and WISE has proven to be very powerful for a variety of studies. [\citet=yan] give a survey of the properties of extragalactic sources, showing that SDSS-WISE colors and morphology can be used to select type-2 dust-obscured quasars and ultra-luminous infrared galaxies at redshift [formula]. The SDSS-III BOSS survey ([\citealt=boss]) includes quasars targeted using SDSS color cuts and WISE detection in the W1, W2, and W3 bands, to select z > 2 quasars.

The work described here was motivated by the need to select targets for the SDSS-III SEQUELS and SDSS-IV eBOSS programs. Myers et al. (in prep.) describe the use of our results to select quasars, while Prakash et al. (in prep.) describe the selection of luminous red galaxy (LRG) targets. The LRG targets are fairly bright in WISE, so a catalog match produces satisfactory results. However, due to the lower resolution of the WISE images, nearby sources that are resolved in SDSS may be blended in WISE, resulting either in missed astrometric matches (because the WISE centroid is shifted), or incorrect colors (because the WISE catalog source includes flux from multiple SDSS sources). Using our results improves this situation, since we photometer a consistent set of sources. For the quasar targets, the often few-sigma flux measurements we make are of considerable utility. In the redshift range of interest, the quasar and stellar loci are significantly separated in SDSS-WISE colors, so even a noisy measurement of the WISE flux can effectively eliminate stellar contamination.

In similar work, the "extreme deconvolution" quasar target selection and redshift-estimation method (XDQSOz; [\citealt=bovy]) makes effective use of forced photometry of GALEX UV ([\citealt=martin]) and UKIDSS near-IR ([\citealt=lawrence]) images, based on SDSS source positions. While often low-signal-to-noise, these measurements nevertheless can be very effective in eliminating degeneracies in quasar classification and redshift determination. Indeed, the XDQSOz method has been extended to incorporate the measurements we present here by DiPompeo et al. (in prep).

Method

We use the Tractor code (Lang et al., in prep.) in "forced photometry" mode. In general, the Tractor optimizes or samples from a full generative model that includes parameters of the image calibration and all the parameters of the sources in the images (positions, shapes, and fluxes). In forced photometry mode, the image calibration parameters are frozen (held fixed), as are all properties of the sources except for their fluxes in the bands of interest. In this case, the photometry task becomes linear: We know what each source should look like in the WISE images, and we must compute the linear sum of the sources that best matches the observed image.

The image calibration parameters include the astrometric calibration, described by a World Coordinate System (WCS); the photometric calibration, described by a zeropoint; a point-spread function model; a noise model (per-pixel error estimates); and a "sky" or background model. We are photometering the "unWISE" coadds, which are tiles of roughly [formula] in extent. The tiles use a gnomonic projection (tangent plane; WCS code "TAN"), are sky-subtracted, and have a photometric zeropoint of 22.5 in the Vega system. In turn, these coadds use the "level 1b" calibrated individual exposures from the WISE All-Sky Data Release. We use the WISE PSF models from the WISE All-Sky Release, averaged over the focal plane and approximated by a mixture of three isotropic concentric Gaussian components. We have been impressed by the quality of the WISE PSF models from [\citet=meisner], but have opted to use the WISE team's models here for consistency.  [\ref=#1] shows the AllWISE PSF models and our Gaussian approximations.  [\ref=#1] lists the parameters of our PSF models.

For an example of the forced photometry results, see  [\ref=fig:demo].

We photometer sources in the SDSS DR10 imaging catalog. We select "survey primary" sources (those detected in the "best" imaging scan covering each part of the sky) from the photoObj catalog files. We drop the "parent" sources in blends, keeping the deblended children. We use the r-band galaxy shape measurements. We find that many faint sources classified as galaxies have poorly constrained galaxy shape measurements. We treat these as point sources rather than galaxies in our photometry. Specifically, we treat as a point source any galaxy whose effective radius is measured at a signal-to-noise of less than 3; or with stated axis ratio error of zero; or with the maximum effective radius considered by the Photo software; or with stated effective radius signal-to-noise significantly greater than expected given its flux; or with magnitude r  <  12.5 (bright stars whose PSF wings are mistakenly identified as galaxies). Examples of sources we treat as point sources are shown in  [\ref=fig:ptsrc].

For each WISE tile, we keep SDSS sources that are within the tile plus a margin of 20 WISE pixels (55 arcseconds). We also include in the fitting sources that are detected in the AllWISE Release catalog but not SDSS; we keep WISE catalog sources that have no SDSS match within 4 arcseconds.

The Tractor code proceeds by rendering the galaxy or point source models convolved by the image PSF model. The galaxy profiles are represented as mixtures of Gaussians, as described in [\citet=profiles], and we fit a mixture of Gaussians to the PSF model. The convolution is then analytic and rendering PSF-convolved galaxy profiles becomes a matter of evaluating a large number of Gaussians. In principle these Gaussian profiles have infinite extent, but we clip them when the surface brightness drops below approximately 10% of the per-pixel noise. Once the profile of each source has been rendered, forced photometry requires performing a linear least-squares fit for source fluxes such that their sum is closest to the actual image pixels, with respect to the noise model. This least-squares problem is very sparse (most sources touch only dozens of pixels); the Tractor uses Ceres Solver ([\citealt=agarwal]), which handles this case well, as its optimization engine for forced photometry.

We photometer each WISE tile and each WISE band separately. Since the WISE tiles overlap slightly, this means we photometer some SDSS sources in multiple tiles. We resolve these multiple measurements after processing all tiles, keeping only the measurement closest to the center of its tile. We then write out files that are row-by-row parallel to the SDSS photoObj input files. The contents of our catalogs are described in Appendix [\ref=sec:catalog].

Results

We photometered a total of 7,989 WISE tiles, covering roughly 14,900 square degrees and containing roughly 469 million SDSS sources. The AllWISE catalog contains roughly 240 million sources in the same area. Of the 469 million sources photometered, we treated 430 million as point sources and 34 million as galaxies. Photometry took roughly 1500 CPU-hours total.

Comparison to WISE catalog

Comparisons between our results and the "official" WISE catalog are shown in s [\ref=fig:comp], [\ref=fig:comp2], [\ref=fig:maghists], [\ref=fig:snhists], and [\ref=fig:maps]. For isolated point sources, our results are consistent to within about 0.03 mag. A slight tilt is evident, similar to the tilt seen in the comparison of the All-Sky and AllWISE releases. We expect this is due to photometric calibration differences between the All-Sky and AllWISE releases. Unfortunately, the AllWISE "level 1b" calibrated exposures have not been released, so improving this effect is beyond the scope of this work.

Sources undetected in the WISE catalog

[\ref=#1] shows a comparison between our forced-photometry results as compared to a traditional approach of astrometric matching between the SDSS and WISE catalogs. The traditional approach demands that all sources be detected in both catalogs, while our approach allows few-sigma WISE sources to be measured. For some science cases, these few-sigma measurements can be very useful, either individually or in stacking analyses. In addition, we photometer more source overall, since often SDSS resolves nearby sources that are blended in WISE.

Artifacts

[\ref=#1] shows a comparison of the artifacts around bright stars in our forced-photometry results and the AllWISE catalog. The most notable effect is a significant halo: sources in the SDSS catalog that we report as being bright. This occurs because our PSF models (as shown in  [\ref=fig:psf]) focus on the core, largely ignoring the wings of the PSF. In our forced photometry approach, when this unexplained flux coincides with a source, the least-squares fitter will try to "explain" the extra flux by making the source brighter. As a result, any source near a bright star will appear too bright in our results. The examples shown in  [\ref=fig:bright] are among the brightest stars in our footprint, and for these stars the halo can be 10 arcminutes or larger.

Discussion

Forced photometry is one approach for applying information learned in one survey to data gathered in a second survey. It is rigid, in the sense that we only photometer the images at locations containing a source in the input catalog. As such, forced photometry is most useful when the survey providing the catalog of sources to photometer has at least the depth and resolution of the images being photometered. In addition, forced photometry demands that the images being photometered are well calibrated. While it is possible to fit for the PSF model, astrometric solution and sky level using the Tractor, this incurs additional computational cost and is not necessarily the most efficient approach for recalibrating images. We are fortunate that the WISE team have produced superbly calibrated images so that image recalibration has been unnecessary.

A more holistic approach than forced photometry would be to do simultaneous fitting. We could, for instance, fit all parameters of the sources (galaxy shapes and positions as well as fluxes), and include both the SDSS and WISE images in the fitting. This would extract additional information from both surveys, yielding stronger constraints on the source properties. It would also allow fitting for proper motions and parallaxes of nearby stars. In addition, we could detect sources that are below the individual survey detection thresholds but are significant when the surveys are combined. This approach would, however, be significantly more computationally expensive: To start, SDSS images have roughly 50 times more pixels per area than WISE. Further, this would require non-linear optimization, in contrast to the much cheaper linear optimization required by forced photometry. Since we do not expect the WISE images (with their lower resolution) to have much constraining power on the positions or shapes of galaxies, an alternative approach would be first to re-fit the SDSS catalog to the SDSS images using the Tractor, and then repeat our forced photometry with that improved catalog. For moving sources, we could search for regions of the WISE images that are poorly fit by the SDSS catalog and allow the sources in these regions to shift their positions slightly. This post-processing approach would allow us to improve upon the forced photometry results without increasing the computational cost excessively.

In this work, we have used coadds of the WISE imaging, rather than the individual frames. While in general it would be preferable to photometer the individual frames (at least in principle), the WISE images have a stable and approximately isotropic PSF with little variation over the focal plane, so little information is lost in the coadding process. The computational time and memory requirements scale roughly with the number of pixels being fit, so photometering the individual frames would have cost roughly 30 times more.

Forced photometry assumes that the profile of a galaxy is the same between bands. This does not describe the (typically small) color gradients across galaxies, although the WISE images lack the resolution to inform any such gradients in the infrared colors. Our forced photometry of the WISE fluxes is equivalent to a weighted-aperture flux that has the property of being well-defined and consistently applied to all objects. Therefore, any biases in the inferred infrared fluxes would be consistent between galaxies that have the same intrinsic properties.

In this paper, we used the SDSS r-band galaxy shape measurements as the galaxy profiles for forced photometry. One might expect the z-band shapes to be closer to the WISE shapes, but the SDSS z-band images are generally of significantly lower signal-to-noise. Since we use the same galaxy profiles as used in the r-band "cModelMag" measurements, our measurements can be used consistently with those mags. When the "fracDev" deVaucoulers-to-total fraction is zero or one, our measuments are also consistent with the SDSS "modelMag" measurements for all bands.

Description of our catalog contents

Our output files are row-by-row parallel to the SDSS photoObj files, and are named photoWiseForced. For example, the SDSS photoObj file containing objects observed in run 1000, camera column 1, field 100, in data reduction version 301, is found in the file +photoObj/301/1000/1/photoObj-001000-1-0100.fits+ and our results are found in the file +301/1000/1/photoWiseForced-001000-1-0100.fits+ where both of these files contains 368 rows, describing row-by-row the same objects.

The photoWiseForced files include the following columns:

plus corresponding columns for w2, w3, and w4.