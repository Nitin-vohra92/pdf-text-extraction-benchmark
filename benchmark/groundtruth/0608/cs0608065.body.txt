Proposition Corollary Theorem Definition FactRemark Example Claim Proposition Corollary Observation

cm cm cm cm in

Combinatorial and Arithmetical Properties of Infinite Words Associated with Non-simple Quadratic Parry Numbers

Doppler Institute for Mathematical Physics and Applied Mathematics and Department of Mathematics, FNSPE, Czech Technical University, Trojanova 13, 120 00 Praha 2, Czech Republic

Introduction

In this paper, we focus on study of arithmetical and combinatorial properties of β-integers for β being a quadratic algebraic integer with positive norm. The notion of β-integer is related to greedy algorithm searching for the expansion of a real number x in base β > 1; this algorithm has been introduced in [\cite=Renyi] by Rényi. The real number x is called β-integer if its β-expansion has the form [formula], i.e. if all of its coefficients at powers β- k vanish for k > 0. The set of β-integers (denoted by [formula]) equals in case of [formula] to the set of integers [formula]. If β is not an integer, the set [formula] has much more interesting properties:

[formula] is not invariant under translation.

[formula] has no accumulation points.

[formula] is relatively dense (= distances between successive elements of [formula] are bounded).

[formula] is self-similar, i.e. [formula].

After the discovery of quasicrystals in 1982 [\cite=Shechtman], it has turned out that the set [formula], where [formula] is the golden mean, serves as a model describing coordinates of atoms in these materials with long-range orientational order and sharp diffraction images of non-crystallographic 5-fold symmetry. Later on, quasicrystals with other non-crystallographic symmetries have been found. In order to serve as a convenient model for quasicrystals, the set [formula] must satisfy together with conditions 1. - 4. also another natural property, the so-called finite local complexity. In one-dimensional case, it means that there exist only a finite number of types of distances between successive elements of [formula]. From results [\cite=Thurston] [\cite=Parry], it follows that [formula] has this property if and only if the Rényi expansion of unity in base β is eventually periodic. Such numbers β are called Parry numbers. It can be easily shown that every Parry number β is an algebraic integer, i.e. it is a root of a monic polynomial having integer coefficients. The task to describe which algebraic integers are Parry numbers has not been solved yet. It is known that each Pisot number is as well Parry. Let us remind that an algebraic integer β is a Pisot number if all of its conjugates have modulus less than 1. In case of β being a Pisot number, β-integers form the Meyer set, i.e. it holds

[formula]

for a finite set [formula]. Thus, the notion of Meyer set generalizes the notion of lattice, which is crucial for description of crystals. As we have already mentioned, in case of β being a Parry number, the set [formula] disposes with a finite number of distances between neighbors. If we associate to different gaps different letters, it is possible to encode the set [formula] as an infinite word uβ over a finite alphabet. Combinatorial properties of words uβ have been studied in several papers: [\cite=FrMaPe1] [\cite=FrMaPe2] is devoted to description of factor complexity of uβ, palindromes of uβ are described in papers [\cite=AmFrMaPe1] [\cite=Ba]. So far the least studied problem is the balance of uβ, i.e. the maximal difference in numbers of different letters in factors of the same length. Balance is clearly known for [formula] which corresponds to sturmian words, i.e. for β being a quadratic unit. In [\cite=Tu], the balance property for uβ, where β is the larger root of the quadratic polynomial x2 - mx - n, [formula] m  ≥  n  ≥  1, has been studied. For other types of irrationalities, the balance property has not been described yet.

The sets of ordinary integers and β-integers are very different also from the arithmetical point of view. [formula] is not closed under addition and multiplication for any [formula]. Sum of two β-integers may even not have a finite β-expansion. So far unsolved and likely very difficult is the question of characterization of those β for which this pathological situation does not appear. Mathematically expressed it means to describe β for which the set Fin(β), i.e. the set of numbers with finite β-expansion, is a subring of [formula]. Frougny and Solomyak have shown in [\cite=FrSo] that the necessary condition for this so-called finiteness property is that β is a Pisot number. Some sufficient conditions can be found in [\cite=Akiyama] [\cite=FrSo] [\cite=Hollander]. If sum or product of two β-integers has a finite β-expansion, there arises a question how long is the β-fractional part of the sum or product. This problem has been investigated in [\cite=AmFrMaPe2] [\cite=Bernat] [\cite=BuFrGaKr] [\cite=GuMaPe] [\cite=Messaoudi].

Here, the main attention is devoted to investigation of arithmetics of β-integers for a non-simple quadratic Parry number β, i.e. for β being the root of the equation [formula]. We determine with the accuracy of ±  1 the maximal number of β-fractional positions [formula], which may arise as a result of addition of two β-integers. So we improve considerably the estimate from the paper [\cite=GuMaPe]. We determine accurately also the balance of uβ. On this easiest non-sturmian example, we illustrate how closely the arithmetical and combinatorial properties of [formula] are related. Particulary, we show the relation between [formula] and the balance property. Our method might be applied also for determination of the balance property for words coding β-integers with irrationalities of a higher degree.

Preliminaries

An alphabet A is a finite set of symbols called letters. A concatenation of letters is a  word. The set A* of all finite words (including the empty word ε) provided with the operation of concatenation is a free monoid. The length of a word [formula] is denoted by |w| = n. We will deal also with infinite words [formula]. A finite word w is called a  factor of the word u (finite or infinite) if there exist a finite word w(1) and a word w(2) (finite or infinite) such that u = w(1)ww(2). The word w is a  prefix of u if w(1)  =  ε. Analogically, w is a  suffix of u if w(2)  =  ε. A concatenation of k words w will be denoted by wk, a concatenation of infinitely many finite words w by wω. An infinite word u is said to be eventually periodic if there exist words v,w such that u = vwω. A word which is not eventually periodic is called aperiodic. We will denote by L(u) (language on u) the set of all factors of the word u. Ln(u) denotes the set of all factors of length n of the word u, clearly

[formula]

The measure of variability of local configurations in u is expressed by the factor complexity function [formula], which associates with [formula] the number Cu(n): =   #  Ln(u). Obviously, a word u is eventually periodic if and only if Cu(n) is bounded by a constant. On the other hand, one can show that a word u is aperiodic if and only if Cu(n)  ≥  n + 1 for all [formula]. Infinite aperiodic words with the minimal complexity Cu(n) = n + 1 for all [formula] are called sturmian words. These words are studied intensively, several different definitions of sturmian words can be found in [\cite=Berstel].

Another way how to measure the degree of variability in the infinite word u is the balance property. Let us denote the number of letters a∈A in the word w by |w|a. We say that an infinite word u is c-balanced, if for every a∈A and for every pair of factors w, ŵ of u, with the same length |w| = |ŵ|, we have [formula]. Note that in the case of binary alphabet A  =  {A,B}, this condition may be written in the simpler way as [formula]. Sturmian words are characterized by the property that they are 1-balanced (or simply balanced)[\cite=Morse]. To determine the minimal constant c for which the infinite word is c-balanced is a difficult task. Adamczewski gives an upper bound on c for a certain class of infinite words. To describe his result, we must introduce the notion of morphism. A mapping φ on the free monoid A* is called a morphism if φ(vw) = φ(v)φ(w) for all v,w∈A*. Obviously, for determining the morphism it suffices to give φ(a) for all a∈A. The action of the morphism can be naturally extended on right-sided infinite words by the prescription

[formula]

A non-erasing morphism φ, for which there exists a letter a∈A such that φ(a) = aw for some non-empty word w∈A*, is called a substitution. An infinite word u such that φ(u) = u is called a fixed point of the substitution φ. Obviously, every substitution has at least one fixed point, namely

[formula]

To any substitution φ on the k-letter alphabet A  =  {a1,a2,...,ak}, one can associate the so-called incident matrix M of size k  ×  k defined by

[formula]

The result of Adamczewski concerns infinite words u being fixed points of primitive substitutions. Recall that a substitution φ is primitive if there exists a power k of φ such that each pair of letters a,b∈A satisfies |φk(a)|b  ≥  1. In accordance with the Perron-Frobenius theorem, the incident matrix of a primitive substitution has one real eigenvalue greater than one, which is moreover greater than the modulus of all the other eigenvalues. This eigenvalue, say Λ, is called the Perron eigenvalue of the substitution. In [\cite=Adamczewski] it has been proved that if u is the fixed point of a primitive substitution with the incidence matrix M, then u is c-balanced for some constant c if and only if |λ|  <  1 for all eigenvalues λ of M, [formula].

Beta-expansions and beta-integers

Let β > 1 be a real number and let x be a positive real number. Any convergent series of the form:

[formula]

where [formula], is called a  β-representation of x. As well as it is usual for the decimal system, we will denote the β-representation of x by

[formula]

and

[formula]

If a β-representation ends with infinitely many zeros, it is said to be finite and the ending zeros are omitted. If [formula], for a given x there can exist more β-representations.

Any positive number x has at least one representation. This representation can be obtained by the following greedy algorithm:

Find [formula] such that βk  ≤  x  <  βk + 1 and put [formula] and [formula], where ⌊x⌋ denotes the lower integer part and {x} = x - ⌊x⌋ denotes the fractional part of x.

For i < k, put xi: = ⌊βri + 1⌋ and ri: = {βri + 1}.

The representation obtained by the greedy algorithm is called β-expansion of x and the coefficients of a β-expansion clearly satisfy: [formula] and [formula] for all i < k, where ⌈x⌉ denotes the upper integer part of x. We will use for β-expansion of x the notation 〈x〉β. If [formula] is the β-expansion of a nonnegative number x, then [formula] is called the β-fractional part of x. Let us introduce some important notions connected with β-expansions:

The set of nonnegative numbers with vanishing β-fractional part are called nonnegative β-integers, formally

[formula]

The set of β-integers is then defined by

[formula]

All the real numbers with a finite β-expansion of |x| form the set Fin(β), formally

[formula]

For any x∈Fin(β), we denote by fpβ(x) the length of its fractional part, i.e.

[formula]

The sets [formula] and Fin(β) are generally not closed under addition and multiplication. The following notion is important for studying of lengths of the fractional parts which may appear as a result of addition and multiplication.

[formula].

[formula].

If such [formula] does not exist, we set [formula] or [formula].

The Rényi expansion of unity simplifies description of elements of [formula] and Fin(β). For its definition, we introduce the transformation Tβ(x): = {βx} for [formula]. The Rényi expansion of unity in base β is defined as

[formula]

Every number β > 1 is characterized by its Rényi expansion of unity. Note that [formula]. Not every sequence of nonnegative integers is equal to dβ(1) for some β. Parry studied this problem in his paper [\cite=Parry]: A sequence (ti)i  ≥  1, [formula], is the Rényi expansion of unity for some number β if and only if the sequence satisfies

[formula]

where [formula] denotes strictly lexicographically smaller.

The Rényi expansion of unity enables us to decide whether a given β-representation of x is the β-expansion or not. For this purpose, we define the infinite Rényi expansion of unity

[formula]

Parry has proved also the following proposition.

Let d*β(1) be an infinite Rényi expansion of unity. Let [formula] be a β-representation of a positive number x. Then [formula] is a β-expansion of x if and only if [formula] for all i  ≤  k.

Infinite words associated with β-integers

If β is an integer, then clearly [formula] and the distance between neighboring elements of [formula] for a fixed β is always 1. The situation changes dramatically if [formula]. In this case, the number of different distances between neighboring elements of [formula] is at least 2. In [\cite=Thurston], it is shown that the distances occurring between neighbors of [formula] form the set [formula], where

[formula]

It is evident that the set [formula] is finite if and only if dβ(1) is eventually periodic.

When dβ(1) is eventually periodic, we will call β a  Parry number. When dβ(1) is finite, it is said to be a  simple Parry number. Every Pisot number, i.e. a real algebraic integer greater than 1, all of whose conjugates are of modulus strictly less than 1, is a Parry number [\cite=Bertrand].

From now on, we will restrict our considerations to the quadratic Parry numbers. The Rényi expansion of unity for a simple quadratic Pisot number β is equal to dβ(1) = pq, where p  ≥  q. Hence, β is exactly the positive root of the polynomial x2 - px - q. Whereas the Rényi expansion of unity for a non-simple quadratic Pisot number β is equal to dβ(1) = pqω, where p > q  ≥  1. Consequently, β is the greater root of the polynomial x2 - (p + 1)x + p - q. Drawn on the real line, there are only two distances between neighboring points of [formula]. The longer distance is always Δ0 = 1, the smaller one is Δ1. Conversely, if there are exactly two types of distances between neighboring points of [formula] for β > 1, then β is a quadratic Pisot number.

If we assign letters A, B to the two types of distances Δ0 and Δ1, respectively, and write down the order of distances in [formula] on the real line, we naturally obtain an infinite word; we will denote this word by uβ. Since [formula], it can be shown easily that the word uβ is a fixed point of a certain substitution φ (see [\cite=Fabre]); in particular, for the simple quadratic Pisot number β, the generating substitution is

[formula]

for the non-simple quadratic Pisot number β, the generating substitution is

[formula]

Let us remark that the matrices of these substitutions are [formula] and [formula], respectively, i.e. both substitutions are primitive. Therefore it follows from result [\cite=Adamczewski] that there exists c such that uβ is c-balanced.

In the case of β being the root of x2 - px - q, i.e. β quadratic simple Parry number, the smallest possible constant c was found: In [\cite=Tu] it is shown that the infinite word generated by substitution ([\ref=subst1]) is [formula]-balanced. Also the values of [formula] have been quite precisely estimated in [\cite=GuMaPe]:

[formula]

[formula]

In this paper, we consider therefore the arithmetical properties of [formula] and associated infinite words uβ for β being the larger root of the equation x2 - (p + 1)x + p - q.

Beta-arithmetics for non-simple quadratic Parry number

The aim of this section is to improve the upper bound on the number [formula] for β having the Rényi expansion of unity equal to dβ(1) = pqω for q  ≤  p - 1. In the case of q = p - 1, β is the larger root of the equation x2 - (p + 1)x + 1 = 0, thus β is a quadratic unit. For quadratic units in [\cite=BuFrGaKr], it is shown that [formula]. Let us focus on the case of q < p - 1. In [\cite=GuMaPe], one can find the following estimates:

[formula]

Here, the estimate on [formula] will be improved. In [\cite=FrSo] and in [\cite=AmFrMaPe2], it is shown that if [formula] and [formula], then Fin(β) is closed under addition of positive elements. This fact implies that if a number x has a certain finite β-representation, then x has as well finite β-expansion. It follows from the definition of greedy algorithm that if [formula] is the β-expansion of x > 0 and [formula] is a β-representation of x, then

[formula]

Thus, the β-expansion of x is the lexicographically greatest β-representation of x.

Let us limit our considerations to the special case of dβ(1) = pqω. The shortest and lexicographically smallest words that do not fulfill the Parry condition are the words

[formula]

Using the equation β2 = (p + 1)β - (p - q), one can easily obtain:

[formula]

[formula]

Let us remark that on the right-hand side of the equations, there are already β-expansions.

Repeating the rules ([\ref=1]) and ([\ref=2]), it is possible to transform any finite β-representation of a number x into the β-expansion of x. As we reduce the sum of digits in the β-representation by applying rules ([\ref=1]) and ([\ref=2]), after a finite number of steps we get the β-expansion.

[formula]

On the other hand, the rules ([\ref=1]) and ([\ref=2]) raise the sum of digits on the right-hand side of the fractional point [formula]. It means that the number of digits in the β-expansion of x on the right-hand side of [formula] is greater or equal to the number of digits in any β-representation of x.

Therefore, the following fact holds true.

If x,y  ≥  0 and x,y∈Fin(β), then fpβ(x + y)  ≥  fpβ(x).

The following lemma is the most important tool to estimate [formula].

Let [formula] be the β-expansion of a positive β-integer x and let [formula]. Then [formula] or there exists s  ≥  l such that

for l = 0,

[formula]

for l  ≥  1,

[formula]

For l = 0. Let us suppose that [formula]. Then [formula] is not a β-expansion of x + 1. Therefore the suffix has the form (p + 1) or pqs - 1(q + 1), where s  ≥  1. Applying the rule ([\ref=1]), resp. ([\ref=2]), the β-representation of x + 1 can be rewritten as

[formula]

or

[formula]

Now, it suffices to show that the expressions on the right-hand side are already β-expansions, or, equivalently, they fulfill the Parry condition. It follows immediately from the fact that if [formula] and [formula] fulfill the Parry condition, then [formula] and [formula] fulfill this condition, too.

For l  ≥  1. Let us suppose that [formula]. Then

[formula]

does not fulfill the Parry condition. There can be three reasons for that.

xl = q - 1,

xl = p,

xl = q.

Let xl = q - 1. Denote [formula]. Obviously, xi = q for all i, s > i > l. Necessarily, xs + 1 < p. If we knew that for all i < l it holds xi  ≥  q and x0  ≥  q + 1, then we could apply the rule ([\ref=2]) for rearranging the β-representation of x + βl in the following way:

[formula]

[formula]

[formula]

[formula]

Since the last expression fulfills the Parry condition, we have obtained the β-expansion of x + βl. Let us show that the conditions x0  ≥  q + 1 and xi  ≥  q for all i < l are always true. Firstly, we prove that xi  ≥  q for all i < l. Let us prove it by contradiction. Let us denote by i0 the maximal index < l such that xi0  ≤  q - 1. Then, let us denote by j0 the minimal index > i0 such that xj0  ≥  q + 1. Such an index exists because ([\ref=l1]) does not fulfill the Parry condition. Hence, the chain ([\ref=l1]) has the following form:

[formula]

Using the rule ([\ref=2]), we get the β-representation of x + βl in the form: if j0 > i0 + 1,

[formula]

if j0 = i0 + 1,

[formula]

In both cases, these β-representations are already the β-expansions, thus we get a contradiction with the fact that [formula]. Secondly, we show that x0  ≥  q + 1. Let us prove it again by contradiction. Let us suppose that x0 = q, then there exists t  ≥  1 such that qt is the suffix of the chain [formula]. Let us consider the maximal such t. Then the β-representation of x + βl has the following form:

[formula]

where xi  ≥  q for all [formula] and xt  ≥  q + 1. Applying the rule ([\ref=2]), we can rewrite the β-representation as

[formula]

which is a contradiction with [formula].

Let xl = p. Then xl + 1 < p and xl - 1  ≤  q. Using the rule ([\ref=1]), we obtain

[formula]

Since [formula], we have [formula], and, consequently, [formula]. Thus, the expression on the right-hand side of ([\ref=p]) is already the β-expansion of x + βl, which is a contradiction with [formula].

Let xl = q, then there exists t  ≥  l such that [formula]. The β-representation of x + βl equal to [formula] can be rewritten, using the rule ([\ref=2]), as

[formula]

which is already the β-expansion of x + βl. Thus, we arrive again at a contradiction with [formula]

Let [formula], x  ≥  y  ≥  0, and let all digits in the β-expansion of y be ≤  q. Then the β-fractional part of x + y is either 0 or [formula].

We will proceed by induction on the positive elements of [formula]. For y = 1, the statement follows from Lemma [\ref=essential], as well as for [formula]. Let y  ≥  q + 1, [formula] where yl  ≥  1 and yi  ≤  q for all [formula]. If [formula], then x + y =   +  , where  = x + βl and  = y - βl, and the statement follows by applying the induction assumption on  = y - βl  <  y. If [formula], then using Lemma [\ref=essential], we get

[formula]

According to Lemma [\ref=essential], [formula] is the β-expansion of x + βl. Moreover, yl - 1  ≤  q - 1 and [formula]. Consequently, the right-hand side of ([\ref=3]) is already the β-expansion of x + y.

It is known that if dβ(1) is eventually periodic, then the set Fin(β) is not closed under subtraction of positive elements. In our case, we have for instance: [formula].

Let x  ≥  y  ≥  0, [formula], then [formula] or [formula].

To prove this statement by contradiction one assumes that [formula], i.e. fpβ(x - y)  ≥  1. Observation [\ref=obs] implies that fpβ(x) = fpβ(x - y + y)  ≥  fpβ(x - y)  ≥  1 and it is a contradiction with [formula].

Let dβ(1) = pqω. Then [formula]

Let [formula] and x,y  ≥  0. If x - y∈Fin(β), then necessarily fpβ(x - y) = 0, as we have mentioned in Observation [\ref=obs2]. Consequently, it suffices to consider the addition x + y. Without loss of generality, we can limit to the case x  ≥  y. Apparently, y can be written as:

[formula]

where [formula] and the digits of y(i) are ≤  q for all [formula]. According to Proposition [\ref=q], if we add to a number of Fin(β) a β-integer with small digits, the length of fractional part increases at most by 1. This proves the statement.

As an immediate consequence of the previous proof, we have the following corollary.

Let [formula] and x,y  ≥  0. Then there exists [formula] such that

[formula]

An upper bound on the constant c in the balance property of uβ

Corollary [\ref=plus] allows us to derive an upper bound on the balance function of uβ. Let us remind that uβ arises if we associate with the longer gap between neighboring β-integers the letter A and with the shorter one the letter B. The length of the longer gap is ΔA = 1 and of the shorter one [formula].

uβ is [formula]-balanced. Moreover, any prefix of uβ contains at least the same number of letters A as any other factor of uβ of the same length.

Let w be a factor of uβ of the length n and ŵ be the prefix of uβ of the same length. Find β-integers x and y, x < y, such that the sequence of distances between neighboring β-integers in the segment of [formula] from x to y corresponds to the factor w. Clearly,

[formula]

The prefix ŵ corresponds to the β-integer

[formula]

Corollary [\ref=plus] implies that there exists [formula] such that

[formula]

Since [formula], it is possible to express the distance between y and ẑ as a combination of the lengths of gaps ΔA and ΔB, i.e. there exist [formula] such that

[formula]

Using ([\ref=A]), ([\ref=B]), and ([\ref=C]), we get

[formula]

[formula]

[formula]

In the last equation, we have used the fact that the factors w and ŵ have the same lengths, and, consequently, |ŵ|A - |w|A = |w|B - |ŵ|B. As ΔA = 1 and [formula] are linearly independent over [formula], the expression of ẑ - y in ([\ref=E]) as an integer combination of the lengths of gaps is unique. Since L,M are nonnegative, from ([\ref=D]) and ([\ref=E]) it follows that |ŵ|A - |w|A  -  ε = 0, i.e.

[formula]

where [formula] which is exactly the statement of the proposition.

Balance property of uβ

In the previous section, we have proved, using arithmetical properties of β-integers, that the infinite word uβ is [formula]-balanced. In this section, we will even show that uβ is [formula]-balanced, which is a better estimate in the case when q divides p - 1. We will as well prove that this estimate cannot be improved. As a consequence, this result will be used to obtain a lower bound on [formula]

At first, we state without any proof some trivial properties of the fixed point uβ of the substitution. Let us recall it:

[formula]

Let BAkB be a factor of uβ. Then k = p or k = q. In particular, if Ak is a factor of uβ, then k  ≤  p.

If v is a finite factor of uβ, then Bφ(v) is also a factor of uβ.

Let BvB be a factor of uβ. Then there exists a unique factor w of uβ such that vB = φ(w).

Now we describe two sequences of factors of uβ denoted by [formula] and [formula], whose behaviour fully determines the balance properties of uβ.

Let us define a sequence [formula] recursively by

[formula]

According to Observation [\ref=exist_w] the words w(n)β are factors of uβ. Note that the sequence [formula] is strictly increasing.

Furthermore, we define sequence [formula] by

[formula]

For all [formula],

[formula]

where û(n) is a prefix of uβ.

By induction on n:

For n = 1, we have w(2)β = Bφ(w(1)β) = Bφ(B) = BAqB = w(1)βAqB;  û(1) = Aq.

Suppose that w(n)β = w(n - 1)βû(n - 1)B and û(n - 1) is a prefix of uβ. Then

[formula]

where û(n)  =  φ(û(n - 1))Aq is a prefix of uβ according to Observation [\ref=o3].

Observation [\ref=w] allows us to define an infinite word wβ in A as

[formula]

It follows from the definition of w(n)β that this infinite word fulfils

[formula]

Consequently, using Observation [\ref=vzor] we get the following observation.

Let w'B be a prefix of wβ. Then the unique factor w'' of uβ satisfying w'B = Bφ(w'') is a prefix of wβ.

We know already from Proposition [\ref=u_beta_max_A] that prefixes of uβ are factors with the largest number of letters A. The infinite word wβ plays the same role for letters B.

Any prefix of wβ contains at least the same number of letters B as any other factor of the same length.

We will prove the statement by contradiction. Let us assume that there exist a [formula] and a factor [formula] of uβ such that |w|B < |v|B, where [formula] is a prefix of wβ. We choose the minimal k with this property. Then

[formula]

Minimality of k implies that v0 = B, vk - 1 = B and wk - 1 = A. The fact that w is a prefix of wβ which satisfies [\eqref=nekonecne], implies w0  =  B. Thus [formula] according to Observation [\ref=o3], hence [formula] by virtue of minimality of k. Observation [\ref=o3] together with the fact wk - 1 = A imply that there is a uniquely determined integer j satisfying 0  ≤  j  ≤  p - q - 1 such that wAjB is a factor of uβ. Since v0 = B, w0 = B and vk - 1 = B, we may use Observation [\ref=vzor] to deduce that there are unique factors v' and w' of uβ such that [formula] and [formula]. Since φ(v') and φ(w') contain the same number of letters B, clearly |v'|  =  |w'|  <  k. Moreover, it follows from Observation [\ref=vzorw] that the factor w' is a prefix of wβ. As φ(v') is shorter than φ(w'), the word v' contains more letters B than w', which is a prefix of wβ. It is a contradiction with the minimality of k.

Let v, v' be factors of uβ of the same length k, let n be such a positive integer that |w(n)β|  ≤  k < |w(n + 1)β|. Then

[formula]

Propositions [\ref=u_beta_max_A] and [\ref=w_max_B] imply

[formula]

where u' and w' are prefixes of uβ and wβ, respectively, of length k. Observation [\ref=w] together with the assumption k < |w(n + 1)β| implies that w' = w(n)βû for some prefix û of uβ. Let us write the factor u' in the form u' = u(n)β. Using Proposition [\ref=u_beta_max_A], we get

[formula]

which concludes the proof of the statement.

Lemma [\ref=zjednoduseni] will be very useful in the investigation of balance properties, since it enables us to find out the optimal balance bound of the word u from examining the sequence (Dn)∞n = 1, where

[formula]

In the sequel, we will show that the sequence (Dn) has the form depicted in Figure  [\ref=sequenceDn], which shows that uβ is [formula]-balanced and that this bound cannot be diminished.

To determine the value of Dn + 1 using the value of Dn = |w(n)β|B  -  |u(n)β|B, it is important to take in account that:

Since the number of letters A in the word u(n)β is by Dn greater than in w(n)β, the length of φ(u(n)β) is by (p - q)Dn letters longer than the length of φ(w(n)β).

w(n + 1)β = Bφ(w(n)β).

u(n + 1)β is a prefix of uβ chosen so that |u(n + 1)β| = |w(n + 1)β|.

Since uβ is the fixed point of the substitution, φ(u(n)β) is a prefix of uβ as well.

u(n + 1)β can be obtained from φ(u(n)β) by erasing of its suffix of length (p - q)Dn - 1.

As the lengths of w(n)β and u(n)β are the same, φ(w(n)β) and φ(u(n)β) contain the same number of letters B.

These six simple facts imply the following recurrence relation for the sequence (Dn):

[formula]

Consequently, to determine the value of Dn + 1, one needs to know the form of the suffix of φ(u(n)β), hence the form of the suffix of u(n)β.

Let us denote by [formula] and [formula].

If n  ≤  t, then Dn = n and u(n)β has the suffix A(n - 1)q + n.

If t + 1  ≤  n  ≤  T + 1, then Dn = n - 1 and the suffix of u(n)β is ApBA(n - 1)(q + 1) - p.

If T + 1  ≤  n, then Dn = T and u(n)β has the suffix AT - 1.

Let us show how the statement 3. follows from 2. For n = T + 1 the statement 2. implies that

[formula]

Let us use the rule ([\ref=Dn]) to calculate Dn + 1. The word φ(u(n)β) has the suffix

[formula]

We erase from this word the suffix of length (p - q)T - 1. Let us show that in this procedure we have erased all the letters B, i.e. T - 1 letters B. To verify this statement, it suffices to prove the inequality

[formula]

In order to prove that by erasing of the suffix of length (p - q)T - 1, there are still at least T - 1 letters left in the word φ(AT - 1), one has to show

[formula]

Consequently, if we verify the equations ([\ref=1inequality]) and ([\ref=2inequality]), it will be proved that Dn + 1 = T and u(n + 1)β has the suffix AT - 1. It means by virtue of ([\ref=0inequality]) for index n, we have shown the virtue for index n + 1, thus, using induction, for all n  ≥  T + 1.

Equation ([\ref=2inequality]) is equivalent to [formula], which is evidently true for the choice of [formula]. Equation ([\ref=1inequality]) is equivalent to [formula]. By means of the fact which holds for positive integers a,b

[formula]

we get

[formula]

It is enough to verify that [formula], which is equivalent with (q + 1)(q - 2)  ≤  p(q - 1). This equation holds because in our substitution p  ≥  q + 1.

The validity of 1. and 2. can be shown analogically by induction on n.

As an immediate consequence of the recently proven proposition, we have the following essential theorem.

The infinite word uβ is c-balanced, where [formula]. This value c is the smallest possible.

A lower bound on [formula]

To derive a lower bound on [formula], we will use the fact that there exist a factor w and a prefix ŵ of uβ such that [formula] Let [formula], x < y, such that the gaps in the segment of [formula] from x to y correspond to the word w. And, let [formula] be the β-integer corresponding to the prefix ŵ. Then

[formula]

From Observation [\ref=obs], it follows that

[formula]

Now, it suffices to show that [formula]

For [formula], the β-expansion of the number [formula] is

[formula]

where a1: = p - q and ai: = (p - 1) - iq for [formula].

The numbers ai are defined so that ai  ≥  0 and [formula]. Thus, the expression [formula] is the β-expansion of a positive number. Now, we have to show that

[formula]

which can be done easily by mathematical induction on j.

Lemma [\ref=F] confirms that [formula] in other words, it implies the announced lower bound on [formula]. To sum up, we have derived the following theorem.

Let dβ(1) = pqω. Then

[formula]

Let us mention that difference between the upper bound [formula] and the lower bound [formula] is always 1. Our computer experiments support the conjecture [formula].

Acknowledgements

The authors acknowledge financial support by Czech Science Foundation GA R 201/05/0169, by the grant LC06002 of the Ministry of Education, Youth, and Sports of the Czech Republic.