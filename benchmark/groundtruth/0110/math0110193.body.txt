Lemma Proposition

The Vanishing of the Theta Function in the KP Direction: a Geometric Approach

Introduction

The fundamental paper [\cite=segalwilson] by Segal and Wilson on soliton equations leads to an explicit formula for computing the vanishing of the Riemann theta function in a direction which is natural from the geometric point of view. In order to present this formula, let C be a compact Riemann surface (of genus g > 1), let p∈C and let Θ denote the theta divisor [formula]. Also let ϑ denote Riemann's theta function, for which (ϑ) = Θ. For a point L∈Θ, consider the embedding [formula]. The natural direction alluded to above is the tangent space Xp to this embedded curve at L. Following [\cite=segalwilson] the vanishing of ϑ at L in the direction of Xp, denoted [formula] is obtained by considering the infinite subset of [formula], defined by

[formula]

In fact, the sections of L over [formula] define an infinite-dimensional plane W, which is an element of the Sato Grassmannian and the vanishing of the tau function in the KP-direction is, according to [\cite=segalwilson], given by the codimension of W, which is explicitly given by the finite sum [formula], upon writing [formula]. The tau function coincides, up to an exponential factor, with the Riemann theta function of C ([\cite=segalwilson]) and the tangent direction Xp coincides with the KP-direction (see [\cite=shiota]). Therefore, the order of vanishing is given by

[formula]

The purpose of this paper is to give an algebraic-geometric proof of this result. Our proof uses (only) the classical theory of linear systems on Riemann surfaces and it highlights the geometric meaning of the order of vanishing. As is pointed out in [\cite=segalwilson] an independent (analytical) proof of this formula has also been given by John Fay (see [\cite=fay]), by using the theory of theta functions.

The first step of our approach consists of an interpretation of the order of vanishing as the intersection multiplicity of the theta divisor with a copy of C, properly embedded (at least around L) in [formula]. If we pull back the theta divisor using this embedding we find a divisor R on C which is the sum of the ramification divisors of the maps which are the natural generalizations of the morphisms [formula] defined by the linear system |L| (assumed here base point free). It follows that the order of vanishing is given by the multiplicity of p in R, leading to where [formula] is the gap sequence Gp(L(np)) of L(np) at p. This formula is independent of n, which is assumed sufficiently large (e.g. n = g will do). Noticing that for n = g one has si = g - mg - i (for [formula]) from which Formula [\eqref=SWintro] follows at once.

Notice that the Segal-Wilson formula for the vanishing of the tau function may also be applied in the case of tau functions that come from singular curves. It would be interesting to adapt our geometric arguments to this case, leading to a formula for the vanishing of the theta functions for singular curves, as proposed in [\cite=segalwilson].

The structure of this paper is as follows. In Section 2 we fix the notation and we recall the notions of gap numbers for arbitrary line bundles. In Section 3 we translate the order of vanishing of the theta function in terms of intersection theory and we show that this order is given as an inflectionary weight. This is used in Section 5 to obtain an explicit formula, which we show to be equivalent to the formula by Segal and Wilson.

Preliminaries

In this section we introduce the notation and collect some results on curve theory. Throughout the whole paper C denotes a compact Riemann surface of genus g and p∈C a marked point.

For a divisor D on C we denote by OC(D) the corresponding line bundle and for a line bundle L on C its linear system is denoted by |L|. We use the standard abbreviations h0(L) for dim H0(C,L) and L(D) for [formula], where L is any line bundle and D is any divisor on C. We will use the Riemann-Roch theorem in the form where L is any line bundle on C and ωC is the canonical bundle of C.

We now recall the notions of gap numbers and inflectionary weights. For proofs and details we refer to [\cite=miranda] and to [\cite=acgh].

Let L be a line bundle on C of positive degree and let q∈C. An integer [formula] is called a gap number for L at q if and the set Gq(L) of gap numbers for L at q is called the gap sequence of L at q; its cardinality is r = h0(L) and no gap number is larger than deg L + 1. Writing we have that m1 > 1 if and only if q is a base point of L and that mr  =   deg L + 1 if and only if L  =  OC( deg L  ·  q). For a general point q∈C the gap sequence of L at q is [formula]; a point q for which the gap sequence of L at q is not of this form is called an inflection point for L. Notice that q is an inflection point if and only if [formula], where r = h0(L).

If the linear system |L| is base point free the inflection points have the following geometric interpretation. Consider the morphism [formula] defined by the linear system |L|. For a generic q∈C there is a unique k-dimensional osculating plane to φL(C) at φL(q), yielding a well-defined morphism

[formula]

called the k-th associated map. This way one arrives at h0(L) - 1 associated maps [formula] (φ0L  =  φL). In these terms a point q is an inflection point if and only if q is a ramification point of one of the maps φkL. We denote the ramification divisor of φkL by Rk(L) and we define The multiplicity wq(L) of q in R(L) is called the inflectionary weight of q with respect to L and is given by

[formula]

When L is not base point free we define the inflectionary weights wq(L) by [\eqref=inflec_weight] and the ramification divisor R(L) by [formula]. This divisor admits an alternative description as the zero divisor of [formula] where z is a local coordinate, n = h0(L) and [formula] is the Wronskian with respect to any basis [formula] of H0(L). In particular W is a holomorphic section of the line bundle [formula].

Taking L  =  ωC one recovers the well-known notion of the gap sequence of q∈C, denoted by Gq, and the above definition of the inflectionary points and weights reduces, by a simple application of Riemann-Roch, to the standard definition of Weierstraß points and their weights.

Finally let us fix our conventions about the Jacobian J(C) of C. By definiton [formula], so that the vector space H0(ωC)* is canonically identified with the tangent space of J(C) at every point. By the Abel-Jacobi theorem there is a canonical isomorphism [formula]. Moreover every line bundle L on C of degree g - 1 induces an isomorphism [formula]. For our purposes it is convenient to work with [formula] rather than [formula]. So in the sequel we identify J(C) with [formula] without further noticing, the underlying isomorphism (respectively line bundle defining the isomorphism) will always be evident from the context. The main advantage working with [formula] is, that we have a canonical theta divisor Θ  =  {L∈J(C)|h0(L) > 0}. By Riemann-Roch, Θ is invariant with respect to the natural involution

[formula]

More precisely we have h0(L) = h0(ι(L)) for any L∈Θ.

We denote by ϑ the Riemann theta function on H0(ωC)* for which π*Θ is the zero divisor of ϑ, where π is the natural projection H0(ωC)*  →  J(C).

For any L∈J(C) we have an embedding αL,p of C into J(C), given by αL,p(q) = L(q - p). Clearly for different L and p the maps αL,p only differ by a translation on J(C).

Geometric description of the order of vanishing

Let L∈J(C) and let X be a one-dimensional subvector space of the tangent space H0(ωC)* at L. Choose any point l in the fiber of π over L and consider the affine line l + X which passes through l and which has direction X. The order of vanishing of ϑ|l + X at the point l is independent of the choice of l∈π- 1(L). So define the order of vanishing of ϑ at L in the direction of X, denoted [formula], as [formula]. If Θ does not contain the straight line X̄  =  π(l + X) then there exists a small neighborhood U of l in l + X such that [formula] and [formula], the intersection multiplicity of Θ with π(U) at L.

Let Xp denote the tangent space to αL,p(C) at L. Notice that, as a subvector space of H0(ωC)*, Xp does not depend on L but only on the point p∈C. We wish to compute [formula] for an arbitrary L∈Θ; if L∉Θ then this order is trivially zero. It can be shown that for all C, L and p that X̄p is not contained in Θ, which is clearly true as soon as C, L or p is generic. For this the idea is to replace π(U) by a a complete curve which, around L, looks like π(U). Notice that if L∈Θ we cannot use αL,p(C) because the latter does not necessarily intersect Θ properly. Consider for any integer n  ≠  0 the morphism

[formula]

Notice that αL,p,n(p) = L and that for a small neighborhood V of p in C the tangent space to αL,p,n(V) at L is precisely Xp.

For all L∈J(C) and n > 0 we have

αL,p,n(C) and Θ intersect properly if and only if h0(L( - np)) = 0;

αL,p, - n(C) and Θ intersect properly if and only if h0(ι(L)( - np)) = 0.

We prove (1), the proof of (2) is similar. Recall that an irreducible curve intersects a divisor properly precisely when the curve is not contained in the support of the divisor. So αL,p,n(C) and Θ do not intersect properly if and only if h0(L(nq - np)) > 0 for all q∈C. We claim that this is equivalent to h0(L( - np)) > 0. Indeed, by Riemann-Roch

[formula]

So h0(L(np - nq)) > 0 for all q∈C if and only if h0(ι(L)(np)) > n, leading to our claim.

In particular, when |n|  ≥  g then where V is a small neighborhood of p in C. Pulling this intersection back to C we get that for any |n|  ≥  g This multiplicity will be computed in the next section.

The divisor α*L,p, - nΘ

The aim of this section is to prove the following

For all L∈J(C), p∈C, and n > 0 with h0(ι(L)( - np)) = 0

[formula]

For the proof we need the following

For all L∈J(C),p∈C and n > 0

[formula]

Step I: The case n = 1 follows exactly from [\cite=cav] Lemma 11.3.4 with x = 0,κ  =  L, and c = p.

Step II: For n  ≥  1 consider the difference map and denote by πni:C2n  →  C the i-th projection. We show by induction on n that for all n  ≥  1 and all L∈J(C)

[formula]

where Δ denotes the diagonal in C2.

For n = 1 we have to show that for all [formula]. According to the Seesaw Principle (see [\cite=cav] A.9) it suffices to show that the restrictions to C  ×  {q} and {q}  ×  C of both sides of the equation coincide for all q∈C. But since the composition of δ1L with the natural embedding C≃C  ×  {q}  →  C  ×  C is the map [formula] and ι*Θ  =  Θ we have, using Step I,

[formula]

and similarly for the restriction to {q}  ×  C.

Now suppose n > 1 and equation [\eqref=eqn411] holds for all n' < n. Restricting both sides of equation [\eqref=eqn411] to C2n - 2  ×  {p,q} and [formula] for all [formula], and using the induction hypothesis for n' = n - 1 and n' = 1 respectively, the Seesaw Principle implies that also equation [\eqref=eqn411] holds. Step III: Consider the embedding [formula] and notice that [formula], so that It follows that α*L,p, - nOJ(C)(Θ) can be computed from [\eqref=eqn411]. Since we have that It follows that the pull back by [formula] of the right hand side of [\eqref=eqn411] equals [formula]. This completes the proof.

By the choice of n we have h0(L(np)) = n and the curve αL,p, - n(C) intersects the divisor Θ properly. The line bundle [formula] has two distinguished divisors, namely α*L,p, - nΘ (according to Proposition [\ref=prop411]) and R(L(np)) (according to Section [\ref=prel]). Moreover these divisors have the same support, since by definition q∈α*L,p, - nΘ if and only if αL,p, - n(q)∈Θ, i.e., h0(L(np - nq)) > 0, and this is the case if and only if q is an inflection point for the line bundle L(np). For generic L and p the line bundle L(np) admits only normal inflection points, so [formula] with pairwise different points qi, and hence R(L(np)) = α*L,p, - nΘ. This equality extends to all L and p for which α*L,p, - nΘ exists and by Lemma [\ref=lem31] this is exactly the set {(L,p)∈J(C)  ×  C  |  h0(ι(L)( - np)) = 0}.

Similarly one can show that if αL,p,n(C) intersects Θ properly, then α*L,p,nΘ = R(ι(L)(np)).

Formula(s) for the order of vanishing

In this section we prove the following theorem:

For every L∈Θ

[formula]

where the sum runs over the g integers m satisfying h0(L((g - m)p)) = h0(L((g - m + 1)p)) - 1.

We will obtain it as a direct consequence of the following proposition.

With n chosen such that αL,p, - n(C) intersects Θ properly (e.g., n = g), the order of vanishing of ϑ at L in the direction Xp is the inflectionary weight of p with respect to L(np). Therefore,

[formula]

where [formula] is the gap sequence Gp(L(np)) of L(np) at p.

According to Section 3 and Theorem [\ref=thm42] we have that

By definition the sum in equation [\eqref=eqn41] runs over the set [formula] of gap numbers of L(gp) at p. An immediate computation shows that h0(L((g - mi)p)) = g - i for [formula]. So the assertion follows from Proposition [\ref=prop43] with n = g.

We now relate Theorem [\ref=thm41] to the Formula [\eqref=SW_intro], given by Segal and Wilson. Recall from the introduction the infinite set

[formula]

Denote [formula]. Then

[formula]

Note first that s0  ≥    -   deg L - 1 =  - g. For - g  ≤  s  ≤  g - 1 we have that s∈SL if and only if [formula], so that si = g - mg - i for [formula]. On the other hand n∈SL for any n  ≥  g so that sn = n for any n  ≥  g. Summing up we find Hence Formula [\eqref=SW_intro] follows from Proposition [\ref=prop43].