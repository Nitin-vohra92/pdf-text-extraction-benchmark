Proposition Theorem Corollary Claim

Metaplectic Demazure operators and Whittaker functions

Introduction

The Casselman-Shalika formula is an explicit formula for the values of the spherical Whittaker functions associated to an unramified principal series representation of a reductive group over a non-archimedian local field F [\cite=casselman-shalika-cs2], generalizing earlier work of Shintani [\cite=shintani]. This has proven to be an important tool in the study of automorphic forms, and in particular, in the construction of L-functions. Similarly, the metaplectic Casselman-Shalika formula is relevant to the study of certain Dirichlet series in several complex variables that are expected to be the global Whittaker functions of Eisenstein series on metaplectic covers of reductive groups.

Three related but distinct approaches to generalizing the Casselman-Shalika formula to the nonlinear setting have recently emerged. The first is found in work of Brubaker-Bump-Friedberg [\cite=bbf-annals]. Working over a global field and building on earlier work with Hoffstein [\cite=bbfh-wmd3], these authors compute the Whittaker functions of the Borel Eisenstein series on a metaplectic cover of [formula]. A recursion relating Whittaker functions on a cover of [formula] to those on [formula] plays a key role in their proof. They show that though the Whittaker functions are not Euler products, they do satisfy a certain twisted multiplicativity that reduces their specification to a description of their p-parts, for p a prime. These p-parts are then shown to be expressible in terms of sums over a crystal base.

Second, the work of McNamara [\cite=mcnamara] treats metaplectic covers [formula] of a simply-connected Chevalley group G over a local field. He directly computes the spherical Whittaker function by integrating the spherical vector φK over the (opposite) unipotent subgroup U-. McNamara defines a decomposition of U- into a collection of disjoint subsets in bijection with the (infinite) crystal graph B( -   ∞  ); on each subset the integrand φK is constant. This proves that the Whittaker function can be realized as a sum over a crystal base. When [formula], he recovers the formulas of Brubaker-Bump-Friedberg-Hoffstein.

Finally, a third approach appears in the work of Chinta-Offen [\cite=co-cs]. This expresses the p-adic Whittaker functions on a metaplectic cover of [formula] over a p-adic field as a sum over the Weyl group. This approach has since been generalized by McNamara [\cite=mcnamara2] to the context of tame covers of unramified reductive groups over a local field. The formulas in these works involve a "metaplectic" action of the Weyl group on rational functions. This action, which has its origins in Kazhdan-Patterson's seminal investigation of automorphic forms on metaplectic covers of [formula] [\cite=MR743816], was used by two of us (GC and PG) to construct Weyl group multiple Dirichlet series [\cite=cg-quadratic] [\cite=cg-jams]. These are infinite series in several complex variables analogous to the classical Dirichlet series in one variable, such as the Riemann ζ function and Dirichlet L-functions. They satisfy a group of functional equations isomorphic to the Weyl group that intermixes the variables. A consequence of the works [\cite=co-cs] [\cite=mcnamara2] is that the p-adic metaplectic Whittaker functions coincide with the local factors of these series (cf. §[\ref=sec:whittaker]).

It is the formulas arising in the third approach that concern us in this article, which is partially motivated by connections between Whittaker functions and the geometry and combinatorics of Schubert varieties. In the nonmetaplectic case, that Whittaker functions on G / F are related to the geometry of the flag variety X attached to the complex dual group [formula] has been recently elucidated by Brubaker-Bump-Licata [\cite=bbl-demazure], following earlier work of Reeder [\cite=reeder]. In particular, recall that if S  ⊂  X is a Schubert variety and L is a line bundle on X with global sections, then the space H0(S,L) is a [formula]-module, where [formula] is a maximal torus. The character of such a module is called a Demazure character, and can be computed by applying Demazure operators to a highest weight monomial [\cite=demazure] [\cite=andersen]. Then Brubaker-Bump-Licata prove (among other results) that the Iwahori Whittaker functions become Demazure characters when q- 1  →  0, where q is the cardinality of the residue field.

To generalize results of [\cite=bbl-demazure] to the metaplectic case, a first step is developing a metaplectic analogue of the Demazure character formula. (Demazure's version of the Weyl character formula appears in [\cite=Fulton_Young].) This is accomplished in the present paper. We define metaplectic Demazure and Demazure-Lusztig operators using the metaplectic Weyl group action found in [\cite=cg-jams] [\cite=cg-quadratic]. We prove that these operators satisfy the same relations as their classical counterparts. We also prove an analogue of Demazure's version of the Weyl character formula (corresponding to the case S = X above) (Theorem [\ref=thm:long_word]), as well as a companion identity for the Demazure-Lustig operators (Theorem [\ref=thm:T_sum]) and show how they can be used to compute spherical Whittaker functions on metaplectic covers (Theorem [\ref=thm:demazure_whittaker]).

Acknowledgments. We thank Dan Bump, Cristian Lenart and Peter McNamara for helpful conversations. We thank the NSF for partially supporting this work through grants DMS 0847586 (GC) and DMS 1101640 (PG).

Notation

We begin by setting up notation. For unexplained notions about root systems and Coxeter groups, we refer to [\cite=bourbaki].

Let Φ be an irreducible reduced root system of rank r with Weyl group W. Choose an ordering of the roots and let [formula] be the decomposition into positive and negative roots. Let [formula] be the set of simple roots, and let σi be the Weyl group element corresponding to the reflection through the hyperplane perpendicular to αi. Define

[formula]

Let Λ be a lattice containing Φ as a subset. Later (Section [\ref=sec:whittaker]) we will assume that Λ is the coweight lattice of a split reductive algebraic group G defined over the non-archimedean field F, and Φ is its coroots, but at the moment this is not necessary. Right now all we require is that the Weyl group W acts on Λ, and that there is a W-invariant [formula]-valued quadratic form Q defined on Λ. Define a bilinear form B(α,β) by Q(α  +  β)  -  Q(α) - Q(β).

We fix a positive integer n. The integer n determines a collection of integers {m(α):α∈Φ} by

[formula]

and a sublattice Λ0  ⊂  Λ by

[formula]

With these definitions, one can easily prove the following:

For any simple root α, we have m(α)α∈Λ0.

Let [formula] be the ring of Laurent polynomials on Λ and K its field of fractions. The action of W on the lattice Λ induces an action of W on K: we put

[formula]

and then extend linearly and multiplicatively to all of K. We will always denote this action using the lower dot

[formula]

to distinguish it from the metaplectic W-action on K constructed below in [\eqref=eq:metaWnotation].

Let λ  ↦  λ̄ be the projection Λ  →  Λ  /  Λ0 and (Λ  /  Λ0)* be the group of characters of the quotient lattice. Any ξ∈(Λ  /  Λ0)* induces a field isomorphism of [formula] by setting ξ(xλ) = ξ(λ̄)  ·  xλ for λ∈Λ. This leads to the direct sum decomposition

[formula]

where Kλ̄  =  {f∈K:ξ(f) = ξ(λ̄)  ·  f}

Next choose nonzero complex parameters [formula] satisfying

[formula]

for all other j we define gj: = grn(j), where 0  ≤  rn(j) < n - 1 denotes the remainder upon dividing j by n. Introduce the following deformation of the Weyl denominator: If v = 1 we write more simply Δv  =  Δ.

We now define an action of the Weyl group W on K as follows. For f∈Kλ̄ and σα∈W the generator corresponding to a simple root α, define

[formula]

where λ is any lift of λ̄ to Λ. It is easy to see that the quantity in brackets depends only on λ̄. We extend the definition of σα to K by additivity. One can check that with this definition, σ2α(f) = f for all f∈K. Furthermore it is proven in [\cite=cg-jams] (see also [\cite=mcnamara2]) that this action satisfies the defining relations of W: if (mi,j) is the Coxeter matrix for Φ, then

[formula]

Therefore ([\ref=def:action]) extends to an action of the full Weyl group W on K, which we denote

[formula]

We remark that if n = 1, the action [\eqref=def:action] collapses to the usual action [\eqref=eq:W_on_K] of W on K. That the quantity in brackets in [\eqref=def:action] depends only on λ̄ and not λ translates to the following lemma:

Let f∈K and h∈K0. Then for any w∈W,

[formula]

Here w.h means the action of [\eqref=eq:W_on_K], whereas ·   denotes multiplication in K.

Lemma [\ref=lemma:h_exchange] is used repeatedly in the proofs below. It is important to note that the action of W on K defined by [\eqref=def:action] is [formula]-linear, but is by endomorphisms of that ring, i.e. it is not in general multiplicative. The point of Lemma [\ref=lemma:h_exchange] is that if we have a product of two terms hf, the first of which satisfies h∈K0, then in [\eqref=def:action] we can apply w to the product hf by performing the usual permutation action on h and then acting on f by the twisted W-action.

Next we use this Weyl group action to define certain divided difference operators. For 1  ≤  i  ≤  r and f∈K define the Demazure operators by

[formula]

and the Demazure-Lusztig operators by

[formula]

When there is no danger of confusion, we write more simply that is, a rational function h in the above equations is interpreted to mean the "multiplication by h" operator. The rational functions here are in K0.

We prove in the following section that the operators Di and Ti satisfy the same braid relations as the σi. Consequently, we can define Dw and Tw for any w∈W as follows. Let [formula] be a reduced expression for w in terms of simple reflections. Then we define

[formula]

In the first two theorems below, both sides of the equalities are to be understood as identities of operators on K.

For the long element w0 of the Weyl group W we have

[formula]

We have

[formula]

We prove Theorem 3 in Section [\ref=sec:pf_long] and Theorem 4 in Section [\ref=sec:pf_T_sum].

In Section [\ref=sec:whittaker] we use the work of McNamara [\cite=mcnamara2] to express Whittaker functions over a local p-adic field in terms of the operators introduced above. In this section the parameteters will be specialized: v will be set to equal q- 1 (for q the cardinality of the residue field) and the gi will be Gauss sums. For now, we only need these parameters to satisfy the relations ([\ref=eq:qt]).

Basic properties of the operators

In this section we prove the quadratic relations (Proposition [\ref=prop:quadratic_properties]) and braid relations (Proposition [\ref=prop:demazbraid]) satisfied by the Demazure and Demazure-Lusztig operators.

The operators Di and Ti (1  ≤  i  ≤  r) satisfy the following quadratic relations:

D2i  =  Di;

T2i = (v - 1)Ti + v.

We prove (i) in detail and leave (ii) to the reader. To simplify the notation, we drop the subscripts and write D,α, and σ, and abbreviate m(α) to m. Using the definition of D and Lemma [\ref=lemma:h_exchange], we have

[formula]

Since

[formula]

we obtain D2  =  D.

We pause to point out the key role played by Lemma [\ref=lemma:h_exchange] in the proof of Proposition [\ref=prop:quadratic_properties]: the action of σi on an arbitrary rational function is given by the complicated formula [\eqref=def:action], but thanks to Lemma [\ref=lemma:h_exchange] we can pass the operator σ past the monomial xm(α)α, after acting on this monomial by the usual permutation action. This fact will be used repeatedly throughout the paper.

We have Dixm(αi)αiDi =  - Di.

We use the same notation as in the proof of Proposition [\ref=prop:quadratic_properties] and compute directly:

[formula]

Suppose (σiσj)mi,j = 1 is a defining relation for W. Then

[formula]

where there are mi,j factors on both sides of [\eqref=eq:db1]-[\eqref=eq:db2].

Both statements boil down to explicit computations with rank 2 root systems, and in fact are special cases of Theorems [\ref=thm:long_word] and [\ref=thm:T_sum]. We explain what happens in detail with [\eqref=eq:db1] in A2, which is typical of all the computations. Since all roots have the same length, we lighten notation by putting m = m(α).

By definition,

[formula]

Next we apply D2 and use σ2(α1) = α1  +  α2:

[formula]

Finally we apply D1 to obtain

[formula]

which simplifies to

[formula]

where Δ  =  (1 - xmα1)(1 - xmα2)(1 - xm(α1  +  α2)). The final formula [\eqref=eq:final] clearly depends only on the longest word in the Weyl group for A2 and not on the reduced expression used to define it, which proves [\eqref=eq:db1]. (Note that this computation also checks Theorem [\ref=thm:long_word] for Φ  =  A2.)

Proof of Theorem [\ref=thm:long_word]

We now turn to the proof of Theorem [\ref=thm:long_word]. Before we can begin, we require more notation. The following is [\cite=Bump_LieGroups], applied to Φ(w- 1) instead of Φ(w):

Let [formula] be a reduced expression for w∈W. Then the set

[formula]

consists of the elements

[formula]

where the αi are the simple roots.

Let p:Φ  →  K0 be a map. We say p is W-intertwining if for any β∈Φ and w∈W, we have

[formula]

Proposition [\ref=prop:phi(w)description] has the following corollary, useful for the proof of Theorems [\ref=thm:long_word] and [\ref=thm:T_sum]:

Assume p:Φ  →  K0 is W-intertwining, and suppose w∈W has a reduced expression [formula]. Then we have the following equality of operators on K:

[formula]

Making repeated use of Lemma [\ref=lemma:h_exchange], we can re-order the operators on the left of [\eqref=eq:lhs] by passing all the σijs to the right and all elements of K0 to the left. After this, the left of [\eqref=eq:lhs] becomes

[formula]

Here [formula] is a reduced expression for w. Moreover, by Proposition [\ref=prop:phi(w)description],

[formula]

enumerates Φ(w- 1). As a consequence the corresponding elements of K0, namely

[formula]

have product [formula] Since the map p is W-intertwining, these are exactly the factors appearing on the left of [\eqref=eq:lhs].

We now begin the proof of Theorem [\ref=thm:long_word]. First notice that by Lemma , any composition of the operators Di can be written as a K0-linear combination of the operators w∈W. Hence we can write

[formula]

for some choice of rational functions Rw∈K0.

Let [formula] denote the length function on W. It is a standard fact about finite Coxeter groups that for any 1  ≤  j  ≤  r, we can find a reduced expression [formula] for the longest word w0 with i1 = j. By Proposition [\ref=prop:demazbraid], we have Dw0  =  DjDwj for [formula]. Since D2j  =  Dj (Proposition [\ref=prop:quadratic_properties]), we have DjDw0  =  Dw0. In other words,

[formula]

It follows that σjDw0  =  Dw0. Now apply σj to both sides of ([\ref=eq:del_long]). Since each Rw∈K0, Lemma [\ref=lemma:h_exchange] implies

[formula]

Comparing coefficients in [\eqref=eq:del_long] and [\eqref=eq:del_long2] and using the fact that the elements of W are linearly independent as operators on K, we obtain σj.Rw = Rσjw. Thus

[formula]

To finish the proof of Theorem [\ref=thm:long_word], it suffices to compute Rw0; the remaining coefficients can then be computed using [\eqref=eq:v_modify]. In fact we shall prove the following:

For w∈W, we have

[formula]

To start, assume the statement is true for w = w0:

[formula]

By [\eqref=eq:v_modify], we have

[formula]

Let u = ww0. Then [formula] Hence

[formula]

Thus the proof will be complete if we show [\eqref=eq:Rw_0].

Begin by writing where p1,p2:Φ  →  K0 are defined by Given a reduced expression [formula], it is easy to see that

[formula]

Since the map p2 is readily shown to be W-intertwining, it follows from the above equality and Corollary [\ref=corollary:rearrangepolys] that

[formula]

This completes the proof of the lemma, and thus of Theorem [\ref=thm:long_word].

Proof of Theorem [\ref=thm:T_sum]

In this section we prove Theorem [\ref=thm:T_sum]: Let [formula] We begin with some lemmas.

For any 1  ≤  i  ≤  r we have

[formula]

Since the simple reflection σi permutes the elements of [formula] the operator Di commutes with

[formula]

Consequently,

[formula]

Take a reduced expression for the long element, [formula] satisfying i1 = i. Thus Dw0  =  DiDwi for [formula] Using this and ([\ref=eq:3a]),

[formula]

The idempotency of Di (Proposition [\ref=prop:quadratic_properties]) and Lemma [\ref=lemma:quadratic] imply

[formula]

Putting everything together, we conclude that (Ti + 1)  ·  (ΔvDw0)  =  (1 + v)  ·  (ΔvDw0).

For any 1  ≤  i  ≤  r we have

[formula]

Recall that [formula] is the length function on W. Then for any element w∈W and any simple reflection σi, we have l(σiw) = l(w)  ±  1. Partition W into [formula], where

[formula]

Then the map w  ↦  σiw defines a bijection between C1 and C2. We compute

[formula]

The second sum above is simply [formula] In the first, we use the quadratic relation T2i = (v - 1)Ti + v of Proposition [\ref=prop:quadratic_properties] to write Thus [formula]

Let

[formula]

be an operator on K that is a linear combination of the Weyl group elements with coefficients Rw∈K0. Assume [formula] is an eigenclass for Ti with eigenvalue v: Then for every w∈W, we have

The proof is a straightforward computation. Begin with with q1,q2 defined by

[formula]

Summing over w∈W, we get But we also have [formula], so comparing coefficients yields Solving for Rw completes the proof.

Lemma [\ref=coeff_rel_for_eigenvectors] has the following easy and useful corollary.

Let

[formula]

be two operators on K that are linear combinations of the Weyl-group elements with coefficients Rw,Sw∈K0. Assume that

We show that Rw = Sw for every w∈W. This can be seen by descending induction on the length of w. For l(w) maximal we have Rw0 = Sw0 by assumption. Now assume l(σiw) = l(w) + 1, and Rσiw = Sσiw. It follows from Lemma [\ref=coeff_rel_for_eigenvectors] that

[formula]

thus Rw = Sw. This completes the proof.

We now turn to the proof of Theorem [\ref=thm:T_sum]. Applying Lemmas [\ref=WW_eigenvalue] and [\ref=Ts_eigenvalue] to the operators ΔvDw0 and [formula], we have

[formula]

for every 1  ≤  i  ≤  r. It follows from the definitions that as operators on K, both ΔvDw0 and [formula] can be written as a linear combination of elements of W with coefficients in K0. Let us write

[formula]

for some Rw,Sw∈K. We shall show that if w0∈W is the long element of the Weyl group, then Rw0 = Sw0. By Corollary [\ref=longword_eigenvect_determines], this suffices to prove the theorem.

The long coefficient Rw0 of ΔvDw0 is easily read off from Theorem [\ref=thm:long_word]:

[formula]

To determine the coefficient Sw0 we again use the property of W-intertwining maps from Corollary [\ref=corollary:rearrangepolys] and argue as in the proof of Lemma [\ref=lemma:Rw]. First, note that the only term in [formula] that contributes to the coefficient Sw0 is Tw0. (All the other Tw have fewer than l(w0) simple reflections appearing in them.) To examine Tw0, fix a reduced expression for the long element: [formula]. Let us again write where q1,q2:Φ  →  K0 are defined in ([\ref=def:q1q2]). It is clear that the map q2 is W-intertwining. The only contribution to Sw0 from [formula] is from

[formula]

Using Corollary [\ref=corollary:rearrangepolys], we conclude

[formula]

Comparing [\eqref=eq:R_{w_0}formula] and [\eqref=eq:S_{w_0}formula] we see that indeed Rw0 = Sw0, as desired. This completes the proof of Theorem [\ref=thm:T_sum].

Whittaker functions

We conclude this paper by showing how to compute Whittaker functions on certain metaplectic groups using the Demazure and Demazure-Lusztig operators. This follows from results in [\cite=mcnamara2], which relate Whittaker functions to the local factors of Weyl group multiple Dirichlet series constructed in [\cite=cg-jams]. Since these factors can be constructed using Theorems [\ref=thm:long_word] or [\ref=thm:T_sum], we obtain an alternative description of the Whittaker functions in the spirit of Demazure's character formula.

Before we can define the Whittaker function of interest, we must introduce notation and quickly recall the construction of unramified principal series presentations on metaplectic groups. Our presentation is taken from [\cite=mcnamara] [\cite=mcnamara2], and the reader should look there for more details.

Let F be a local field containing the nth roots of unity, μn. We choose once and for all an identification of μn with the complex nth roots of unity. Let O denote the ring of integers and [formula] the maximal ideal of O with uniformizer ϖ. Let q denote the order of the residue field [formula] We assume that [formula], so that in fact F contains the 2n-th roots of unity.

In order to define Gauss sums, we introduce ψF be an additive character on F with conductor O. Further let (  ,  ) = (  ,  )F,n:F×  ×  F×  →  μn(F) be the nth order Hilbert symbol. It is a bilinear form on F× that defines a nondegenerate bilinear form on F× / F×  n and satisfies

[formula]

Our assumption that - 1 is an nth root of unity further implies that (ϖ, - 1) = 1. Then we define

[formula]

In particular gi depends only on the residue class of i mod n, g0 =  - 1 and gign - i = q.

Now let G be a connected reductive group over F. We assume that G is split and unramified and arises as the special fiber of a group scheme [formula] defined over [formula]. Let [formula] be a maximal compact subgroup. Let T be a maximal split torus and let Λ be its group of cocharacters. Let B be a Borel subgroup containing T, let U be the unipotent radical of B, and let U- be the opposite subgroup to U. Let Φ be the roots of T in G, and let Δ  ⊂  Φ be the simple roots. The Weyl group W of Φ acts on Λ, and as in Section [\ref=sec:notation] we fix a W-invariant integer-valued quadratic form on Λ, and use it to define the sublattice Λ0  ⊂  Λ as in [\eqref=eqn:defoflambda0].

Let [formula] be an n-fold metaplectic cover of G, as defined in [\cite=mcnamara2]. Thus we have an exact sequence

[formula]

where μn is the group of nth roots of unity. We choose an identification of μn with the complex nth roots of unity. Denote the inverse image of any subgroup J  ⊂  G with a tilde: [formula]. It is known that [\eqref=eq:cover] splits canonically over U and U-. In general [\eqref=eq:cover] does not split over K, but our assumption on q implies that it does. We therefore fix a splitting [formula] and identify K with its image in [formula]. Let H be the centralizer in [formula] of [formula]. The lattice Λ (respectively Λ0) can be identified with [formula] (resp., [formula]). Our assumptions on G imply that H is abelian, and in fact [formula] (although not canonically). Moreover, we may choose a lift of Λ into [formula]; we denote this lift by λ  ↦  ϖλ.

The unramified principal series representations are parametrized by complex-valued characters χ of Λ0. Given such a character, we obtain a character of H using the surjection H  →  μn  ×  Λ0, where we let the roots of unity act faithfully. We induce this character to [formula] and obtain a representation (πχ,i(χ)). The unramfied principal series representation (πχ,I(χ)) is formed using normalized induction of this representation to [formula]. More precisely, we have

[formula]

where δ is the modular quasicharacter of [formula], and where [formula] acts on I(χ) by right translation. One proves that I(χ)K is one-dimensional; a nonzero element φK in this space of invariants is called a spherical vector.

Let [formula] be an unramified character. By definition this means that the restriction of ψ to each of the root subgroups U-  α, α∈Δ is a character of U-  α≃F with conductor O. Then the function [formula] defined by

[formula]

is the i(χ)-valued Whittaker function with character ψ. We will obtain a complex-valued Whittaker function by applying a linear functional ξ∈i(χ)* to the right of [\eqref=eq:ichiwhit]. We now explain how to construct certain functionals so that we can arrive at a very explict formula. To do this we must be very careful about normalizations.

Recall that φK∈I(χ)K is our spherical vector. It turns out that we have an isomorphism [formula] given by f  ↦  f(1). Let v0  =  φK(1). Let A be a set of coset representatives for [formula]; our assumptions imply that we can assume they each have the form ϖλ for some λ∈Λ. The vectors {πχ(a)v0:a∈A} give a basis of i(χ).

Now let [formula] be an extension of χ to [formula] satisfying [formula] for all [formula]. Such an extension determines a functional [formula] by

[formula]

Since each a has the form ϖλ for λ∈Λ, we may write instead [formula] for [formula]. Then the complex-valued Whittaker function we want to compute is

[formula]

The fact that W satisfies

[formula]

together with the Iwasawa decomposition G = UTK implies that it suffices to compute W on [formula].

We are almost ready to evaluate W on [formula] in terms of our Demazure operators. Set v = q- 1 in the group action ([\ref=def:action]) and interpret the Weyl group action on Λ as acting on [formula] via the identification [formula]. Further define

[formula]

Then we have the following formula of McNamara:

[\cite=mcnamara2] Let λ be a dominant coweight. Then

[formula]

where w acts on xλ as in [\eqref=def:action].

Actually [\cite=mcnamara2] is written in terms of a slightly different group action introduced in [\cite=cg-jams], but relating the two actions leads to the statement above. Combining the previous result with Theorems [\ref=thm:long_word] and [\ref=thm:T_sum] we arrive at our objective of expressing the Whittaker function in terms of the Demazure and Demazure-Lusztig operators.

For λ a dominant coweight,

[formula]