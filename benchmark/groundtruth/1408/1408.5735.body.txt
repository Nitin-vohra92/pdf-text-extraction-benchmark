Benford Analysis: A useful paradigm for spectroscopic analysis

Introduction :

Benford's law is an empirical law, which applies to many of the naturally occurring numerical datasets [\cite=benford]. It predicts the frequency of various digits in the most significant place in such datasets. It is natural to expect that the frequency of digits 1 to 9 in the most significant place is nearly uniform, unless the entries in the dataset are biased to one or more digits due to a constrained range of the entries. For example, in a typical NMR spectrum normalized between 0 and 1, one might expect a uniform distribution of digits 1 to 9 in the most significant place. On the contrary, the Benford's law predicts a higher occurrence of the digit '1' in the most significant place, compared to other higher digits, whose occurrence decreases progressively. This non-uniform occurrence of digits in the most significant place was first observed by Simon Newcomb [\cite=newcomb] in 1881. However, Newcomb's article failed to gain recognition due to a lack of mathematical structure. This empirical law was rediscovered by Frank Benford [\cite=benford] in 1938, who presented it with a mathematical formulation, which states that in a given dataset, the probability PB(d) of the first significant digit 'd' is given by :

[formula]

This probability distribution, known as Benford's law, predicts an occurrence as high as 30.1% for the digit '1' in the most significant place, whereas a mere 4.6% for the digit 9.

Benford's law arises from the fact that the numbering-system (be it decimal, octal, or hexadecimal) consists of mere ratios whereas many processes occurring in nature behave like a geometric progression [\cite=benford]. The linear numbering-system may have its own advantages, but various natural phenomena such as the Maxwell-Boltzmann distribution of thermal energy, pH values of solutions, charging/discharging of capacitor, Newton's law of cooling, decay of a radioactive nuclei - all occur in exponents. In order to provide a simple illustration of Benford's law, we consider an exponentially decaying signal. Such signals are versatile, including the time-domain free-induction decay (FID) of a single NMR transition. Figure [\ref=fgr:demoben](a) displays such a digitized signal, and also marks the time-intervals at which digits 1 to 9 occur in the most significant place. The percentage of the total occurrence of each digit is also shown in the figure. This distribution is in excellent agreement with the expression [\ref=eq1]. Let us now consider the frequency-domain signal which is frequently used in spectroscopic analysis. Figure [\ref=fgr:demoben](b) displays the real part of the Fourier transform of the time-domain signal shown in Figure [\ref=fgr:demoben](a). Such an absorptive Lorentzian line-shape is commonly found in high-resolution NMR spectroscopy. We again notice an overall agreement of the distribution of most significant digits with the Benford's law.

Such datasets following Benford's law also emerge from a plethora of sources ranging from astrophysical [\cite=Astrophysical1], geographical [\cite=geographical], biological [\cite=neural] [\cite=biology2] [\cite=aerobiological], seismographic [\cite=seismic], to financial topics [\cite=stockmarket] [\cite=financial1]. In the past, inspecting violations of Benford's law have proven to be useful in detecting the cases of tax fraud [\cite=taxfruad] and election fraud [\cite=electionfraud]. Benford's law has also been applied to study phase transitions in quantum many-body systems [\cite=ujjwal1] [\cite=ujjwal2]. Recently in another study, the possibility of distinguishing a genuine NMR spectrum from a simulated one using Benford analysis has also been investigated [\cite=gaurav].

In this article, we explore the use of Benford's law for various spectroscopic applications, specifically in NMR. In particular, we present some useful techniques pertaining to spectroscopic peak detection, phase correction, and baseline correction. Firstly, we describe the methodology of Benford analysis. Then in the next section, we demonstrate three applications in NMR spectral analysis (i) the detection of weak solute peaks which are overridden by strong solvent peaks in 1D and 2D NMR, (ii) simultaneous correction of zeroth order and first order phase errors in NMR spectra, and (iii) a technique for baseline correction. Moreover, we show that the Benford analysis of an MRI image might be helpful in highlighting its key areas. Finally we conclude in the last section.

Methodology of Benford Analysis

We shall describe here the general procedure adopted for performing Benford analysis. Firstly, the signs of the data entries {xi} are removed by taking their absolutes. To remove a bias towards any particular digit(s) arising from a limited data-range

[formula]

Applications in NMR Spectroscopy:

Detection of weak peaks

As previously mentioned, BGP values are not dependent on the relative intensities of the spectral lines. This is advantageous for detecting weak solute peaks overridden by a strong solvent peak. To illustrate this fact, we chose a two-spin system (4-Hydroxybenzoic acid, 9.5 mg) dissolved in D2O (500 μl) and H2O (50 μl). The 1H NMR signal obtained with 1 degree pulse-angle is shown in Figure [\ref=fgr:scan1d](a). As is evident, the strong water signal easily dominates over the solute signals. Here the intensities of the solute peaks are about 1.7% of that of the solvent peak, and therefore are hardly visible in the lower trace of Figure [\ref=fgr:scan1d](a). The SBA curve for this NMR spectrum is also shown in Figure [\ref=fgr:scan1d](b). The SBA curve was calculated from the frequency domain signal using bins each with 1000 data points shifted by 100 points throughout the spectrum. For simplicity, we have truncated the SBA curve for BGP values below 50. Interestingly, the positions of the peaks in the SBA plot matches fairly well with those in the NMR spectrum. Further, the relative intensities of the solute peaks compared to the solvent peak have also improved by about two orders of magnitude. The fine splitting of the solvent peak in the SBA plot is mainly due to the non-Lorentzian line-shape of the solvent peak (as can be observed in Figure [\ref=fgr:scan1d](a)). While the resolution of the SBA curve is limited, the sensitivity has improved significantly. This way, SBA curves can help in identifying weak peaks in the presence of strong peaks.

We also illustrate the usefulness of the above procedure in multidimensional NMR using a two-dimensional gradient COSY (G-COSY) spectrum of the same sample (4-Hydroxybenzoic acid). The 1H-1H 2D spectrum and its projections are shown in Figure [\ref=fgr:scan2d](a). The intensities of the solute diagonal-peaks are about 1% of that of the solvent peak. We perform a 2D-SBA of the frequency-domain spectrum by using square bins each containing 32  ×  32 data points. The resulting 2D-SBA plot and its projections on either axis are shown in Figure [\ref=fgr:scan2d](b). Again, we clearly see that the Benford analysis has given significant emphasis to the weak solute peaks such that they appear comparable to the solvent peak and even the cross-peaks are also clearly visible in the SBA plot. However, the fine structures in both the solvent and the solute peaks are artefacts of SBA and may not carry spectroscopic information.

Correction of Phase Errors

The mismatch between the phase of the observed magnetization and the receiver phase may lead to zeroth-order phase errors resulting in non-absorptive lineshapes. Further, the unavoidable delay (dead-time) introduced while switching a spectrometer from transmitter mode to receiver mode, or certain deliberate delays after the detection pulse result in first-order phase errors. In such cases, it is necessary to carry out a post-processing to rectify all the phase errors. The sensitivity of BGP for the phase errors illustrated in Figure [\ref=fgr:benbasis](a) may be exploited for phase correction of NMR spectrum. The procedure involves carrying out SBA of the distorted spectrum and computing the mean BGP over all the bins. The phase correction is modelled in the form exp (iφ0  +  νφ1), where ν is the frequency coordinate, and the optimum values of zeroth-order (φ0) and first-order (φ1) corrections can be determined by maximizing the mean BGP. Figure [\ref=fgr:phaabs](a) illustrates the successful simultaneous correction of both zeroth and first order phase errors using an automated procedure described above.

Correction of Baseline Errors

Often the sharp high-resolution NMR spectra of solute molecules appear mounted on broad background spectrum arising either from solid impurities or from the sample tube itself. The broad humps can have arbitrary shapes and may interfere with quantitative spectral analysis. In such cases, it is desirable to suppress the broad features using post-processing. The standard way of correcting the baseline involves modelling the baseline using a suitable model function (polynomial or Fourier series), and subtracting the model function from the distorted spectrum to obtain a flat baseline. The challenging part in this method is distinguishing the genuine NMR peaks from the baseline features. Here, we describe a procedure for the baseline correction of an NMR spectrum using Benford analysis. The method is based on the sensitivity of BGP on the baseline shape as illustrated in Figure [\ref=fgr:benbasis](b). The procedure involves generating a set of spline model-functions (in-built in MATLAB) corresponding to different number of sampling points on the spectrum. After subtracting these model-functions from the distorted spectrum, we obtain a set of candidate spectra. Performing SBA of each of the candidate spectra, and then choosing the one with maximum mean-BGP, we obtain the spectrum corresponding to the best baseline. Figure [\ref=fgr:phaabs](b) illustrates the baseline correction using an automated procedure as described above. The main advantage of this method over certain other methods is in omitting the requirement of manual identification of baseline.

Benford Analysis of 2D Images

The SBA methods introduced for processing 2D-NMR spectra can also be applied to process other 2D images. To study the effect of 2D-SBA processing, we use a noisy chess-board image shown in Figure [\ref=fgr:mri](a). The corresponding 2D-SBA plot of this image, obtained with a bin-size of 15  ×  15 data-points, is shown in Figure [\ref=fgr:mri](b). Here we can notice two important aspects of 2D-SBA profiles. Firstly, the Benford analysis clearly identifies the outlines in the image and can therefore be used for edge-detection. Secondly, the weak internal features, like a faint pawn, can become significantly prominent in the 2D-SBA plot. This is analogous to the detection of weak NMR peaks in 1D-SBA and 2D-SBA described in the previous section. These properties of 2D-SBA can be exploited in processing many types of images including MRI. Figure [\ref=fgr:mri](c) displays the MRI of human brain before (left) and after (right) introducing a contrast agent [\cite=wiki]. The corresponding 2D-SBA profiles are displayed in Figure [\ref=fgr:mri](d). As expected, the latter images show clear outlines of all the features in (c) as well as clearly mark-out the part highlighted by the contrast agent. Such complementary images may prove helpful in diagnosis.

Conclusions

The Benford's law predicts the distribution of digits 1 to 9 in the most significant place in a numerical database. Although it is hard to conceptualize the role of this distribution in such a wide variety of databases, it brings out several interesting applications. In this work we explored some potential applications in the analysis of spectroscopic data, particularly NMR data. We found that by using a scanning Benford analysis it is possible to detect weak peaks subdued by neighbouring strong peaks. We demonstrated this fact by applying the Benford analysis on both 1D and 2D NMR spectra. The resolution of the scanning analysis is limited by the size of the bins, and the resulting data also lacks the quantitative information on the relative intensities. Nevertheless, such analysis may be useful for high-throughput scanning of solutes with low-concentration. We also demonstrated that the sensitivity of the Benford goodness parameter on the Lorentzian line-shape can be exploited in phase-correction as well as baseline correction. In principle, the same property can also be used in NMR spectrometers for automated field homogenization. Then we extended the Benford analysis to 2D images including an MRI image. We found that the Benford analysis is not only capable of detecting outlines of various features in an image but also is capable of highlighting faint portions of an image. We believe that the Benford analysis can open-up new vistas in spectroscopic analysis.

Acknowledgements

The authors acknowledge Ujjwal Sen and Aditi Sen, of HRI, Allahabad, and Anil Kumar of IISc, Bangalore, for suggesting to carry out Benford analysis of NMR databases. This work was partly supported by DST project SR/S2/LOP-0017/2009.