Example Example Definition Exercise Proposition Note Lemma Corollary Open Problem Question Project Problem Conjecture

Restricted Permutations Related to Fibonacci Numbers and k-Generalized Fibonacci Numbers

Introduction

Let Sn denote the set of permutations of [formula], written in one-line notation, and suppose π∈Sn and σ∈Sk. We say π avoids σ whenever π contains no subsequence with all of the same pairwise comparisons as σ. For example, the permutation 23481756 avoids 4213, but it has 4156 as a subsequence so it does not avoid 2134. If π avoids σ then σ is sometimes called a pattern or a forbidden subsequence and π is sometimes called a restricted permutation or a pattern-avoiding permutation.

One important and often difficult problem in the study of restricted permutations is the enumeration problem: given a set R of permutations, enumerate the set Sn(R) consisting of those permutations in Sn which avoid every element of R. The earliest solution to an instance of this problem seems to be MacMahon's enumeration of Sn(123), which is implicit in chapter V of [\cite=MacMahon]. The first explicit solution seems to be Hammersley's enumeration of Sn(321) in [\cite=Hammersley]. In [\cite=KnuthVol1] and [\cite=KnuthVol3] Knuth shows that for any pattern σ of length three, Sn(σ)  =  Cn, the nth Catalan number. Other authors considered restricted permutations in the 1970s and early 1980s (see, for instance, [\cite=Rogers], [\cite=Rotem1], and [\cite=Rotem2]) but the first systematic study was not undertaken until 1985, when Simion and Schmidt [\cite=SimionSchmidt] solved the enumeration problem for every subset of S3. More recent work on various instances of the enumeration problem may be found in [\cite=Atkinson], [\cite=BonaExact], [\cite=BonaSmooth], [\cite=Kremer1], [\cite=KremerShiu], [\cite=Mansour33k], [\cite=MansourVainshtein], [\cite=MansourVainshtein2], [\cite=Stankova1], [\cite=Stankova2], [\cite=StankovaWestHex], [\cite=WestCatalanSchroder], and [\cite=WestGenTrees].

In this paper we are concerned with instances of the enumeration problem whose solutions involve the Fibonacci numbers or the k-generalized Fibonacci numbers. The earliest example of such a result is Simion and Schmidt's proof [\cite=SimionSchmidt] that

[formula]

Somewhat later West showed [\cite=WestGenTrees] that for many sets R consisting of one pattern of length three and one of length four, |Sn(R)|  =  F2n - 1. More recently Mansour showed [\cite=Mansour33k] that

[formula]

[formula]

and

[formula]

Here Tn is the nth Tribonacci number, defined by T0  =  0, T1  =  T2  =  1, and Tn  =  Tn - 1  +  Tn - 2  +  Tn - 3 for n  ≥  3. In this paper we first generalize ([\ref=eqn:SimionSchmidtintro]) and ([\ref=eqn:MansourintroTrib]) by showing that for all n and all k  ≥  2,

[formula]

and

[formula]

Here Fk,n is the k-generalized Fibonacci number defined by setting Fk,n  =  0 for n  ≤  0, Fk,1  =  1, and [formula] for n  ≥  2. We give bijective proofs of ([\ref=eqn:usintro1]) and ([\ref=eqn:usintro2]). We then generalize ([\ref=eqn:MansourintroFib2]) by showing that for all k  ≥  4, the set [formula] is enumerated by a linear combination of two Fibonacci numbers plus a polynomial of degree k  -  2. We give explicit enumerations for k  =  4, k  =  5, and k  =  6. Here it is the k - 3rd differences for the sequence [formula] which satisfy the Fibonacci recurrence. We go on to generalize ([\ref=eqn:MansourintroFib2]) in another direction by showing that for all k  ≥  2 and all n  ≥  1,

[formula]

In this case the first differences for the sequence [formula] satisfy the k - 2-generalized Fibonacci recurrence. We conclude with some open problems and conjectures, which include conjectured generalizations of ([\ref=eqn:MansourintroFib1]).

Background and Notation

In this paper, a permutation of [formula] is a sequence in which each element of

[formula]

. We say a permutation π avoids a permutation σ whenever π contains no subsequence with all of the same pairwise comparisons as σ. For example, the permutation 23481756 avoids 4213, but it has 4156 as a subsequence so it does not avoid 2134. We make this idea precise in the following definition.

For any permutation π∈Sn and any i (1  ≤  i  ≤  n), we write π(i) to denote the element of π in position i. We say a permutation π∈Sn avoids a permutation σ∈Sk whenever there is no sequence [formula] such that [formula].

If π avoids σ then π is sometimes called a restricted permutation or a pattern-avoiding permutation and σ is sometimes called a forbidden subsequence. In this paper we will be interested in permutations which avoid several patterns, so for any set R of permutations we write Sn(R) to denote the elements of Sn which avoid every element of R. For any set R of permutations we take Sn(R) to be the empty set whenever n  <  0 and we take S0(R) to be the set containing only the empty permutation. When [formula] we often write [formula].

For all integers k  ≥  1, the k-generalized Fibonacci number Fk,n satisfies the recurrence obtained by adding more terms to the recurrence for the Fibonacci numbers. More specifically, we set Fk,n  =  0 for all n  ≤  0 and we set Fk,1  =  1. For all n  ≥  2 we define Fk,n recursively by setting

[formula]

The term "k-generalized Fibonacci number" alludes to the fact that F2,n  =  Fn for all n. We also observe that F3,n  =  Tn, the nth Tribonacci number, for all n. We will make use of the following combinatorial interpretation of Fk,n.

The number of tilings of a 1  ×  n rectangle with tiles of size 1  ×  1, 1  ×  2, , 1  ×  k is the k-generalized Fibonacci number Fk,n + 1.

The result is immediate for n  ≤  1, so it suffices to show that the number of such tilings satisfies ([\ref=eqn:kgenrecurrence]). To do this, observe there is a one-to-one correspondence between tilings of a 1  ×  (n  -  i) rectangle and tilings of a 1  ×  n rectangle in which the right-most tile has length i. Therefore, if we count tilings of a 1  ×  n rectangle according to the length of the right-most tile, we find the number of such tilings satisfies ([\ref=eqn:kgenrecurrence]), as desired.

For more information concerning the k-generalized Fibonacci numbers, see [\cite=Flores], [\cite=Gabai], [\cite=Lynch], [\cite=Miles], and [\cite=Miller].

Two Families of Restricted Permutations Counted by the k-Generalized Fibonacci Numbers

In [\cite=SimionSchmidt] Simion and Schmidt show that for all integers n,

[formula]

Generalizing this result, Mansour shows in [\cite=Mansour33k] that for all integers n, Here Tn is the Tribonacci number, defined by T0  =  0,T1  =  T2  =  1, and Tn  =  Tn - 1  +  Tn - 2  +  Tn - 3 for n  ≥  3. In this section we generalize these results by lengthening one of the subsequences which is forbidden in ([\ref=eqn:SimionSchmidt]). There are three natural ways to do this: replace 123 with [formula], replace 132 with [formula], or replace 213 with [formula]. With this in mind, we wish to enumerate [formula], [formula], and [formula].

Our first step is to observe that enumerating [formula] is equivalent to enumerating [formula]. To see this, suppose π∈Sn and let πrc denote the reverse complement of π, which is the permutation of

[formula]

π(i) = n + 1 - π(n + 1 - i) (1 ≤ i ≤ n).

[formula]

f(x) = |S(12 k, 132, 213)| x

[formula]

|S(12 k, 132, 213)| = |S(12 k, 132, 213)|.

[formula]

n-1, n-2, , n - π(n) + 1, n, σ

[formula]

f(x) = |S(123, 132, k-1 k-2  1 k)| x

[formula]

|S(123, 132, k-1 k-2  1 k)| = |S(123, 132, k-1 k-2  1 k)|.

[formula]

A Family of Restricted Permutations Counted by a Fibonacci Number Plus a Polynomial

In [\cite=Mansour33k] Mansour shows that

[formula]

In this section we generalize this result by extending the permutation 213 to permutations of the form [formula]. We show that for any k  ≥  4, the set [formula] is enumerated by a linear combination of two Fibonacci numbers plus a polynomial of degree k - 2. We give explicit enumerations for k  =  4, k  =  5, and k  =  6. We begin by considering the form of a permutation in [formula].

Fix n  ≥  1, fix k  ≥  4, and suppose [formula]. Then the following hold.

If π- 1(n)  =  1 and n  >  1 then π has the form

[formula]

for some [formula].

If π- 1(n)  =  2 and n  >  2 then π has the form

[formula]

for some [formula].

If 3  ≤  π- 1(n)  ≤  k - 3 and π- 1(n)  <  n then π has the form

[formula]

for some [formula].

If k - 2  ≤  π- 1(n)  ≤  n - 1 then π has the form

[formula]

for some σ∈Sn - π- 1(n)(132,213,2341).

If π- 1(n)  =  n then π has the form

[formula]

for some [formula].

(i) Observe it is sufficient to show σ avoids [formula]. Suppose by way of contradiction that σ contains a pattern of this type. Combining this pattern with n gives a pattern of type [formula] in π, contradicting the fact that π avoids [formula]. Therefore [formula], as desired.

(ii) Since π avoids 132, the element to the left of n is greater than every element to the right of n, so it must be n - 1. Therefore π has the form in ([\ref=eqn:kk-1form2]) for some σ∈Sn - 2. Arguing as in the proof of (i), we now find [formula].

(iii) Since π avoids 132, the elements to the left of n are all greater than every element to the right of n. Since π avoids 2341 and π- 1(n)  <  n, the elements to the left of n form a decreasing subsequence. Therefore π has the form in ([\ref=eqn:kk-1form3k-3]) for some σ∈Sn  -  π- 1(n). To show [formula] it is sufficient to show π avoids [formula]. Suppose by way of contradiction that σ contains a pattern of this type. Combining this pattern with [formula] gives a pattern of type [formula] in π, contradicting the fact that π avoids [formula]. Therefore [formula].

(iv) This is similar to the proof of (iii).

(v) This is immediate.

Digressing for a moment, we now use Lemma [\ref=lem:kk-1form] to give a bijective proof of Mansour's result.

For all n  ≥  1, there exists a constructive bijection between [formula] and the set of tilings of a 1  ×  (n + 1) rectangle with tiles of size 1  ×  1 and 1  ×  2 using at least one 1  ×  2 tile. In particular, for all n  ≥  1,

[formula]

Suppose we are given such a tiling. We construct its corresponding permutation as follows. Replace the right-most 1  ×  2 tile with a 1, and fill the (necessarily 1  ×  1) tiles to the right of the 1 with [formula] from left to right. Now fill the right-most empty tile with the smallest numbers available, placing them in the tile from left to right in increasing order. Repeat this process until every tile is filled. It is routine using Lemma [\ref=lem:kk-1form] to verify that this map is invertible, and that the permutation constructed avoids 132, 213, and 2341, as desired.

Under the bijection given in the proof of Proposition [\ref=prop:Mansourfn+2-1], the permutation 87564123 corresponds to the tiling [formula] and the permutation 86745321 corresponds to the tiling [formula].

We now return to our study of the permutations in [formula].

The following hold for all n  ≥  1 and all k  ≥  4.

For all [formula], the permutation

[formula]

is in [formula].

For all [formula], the permutation

[formula]

is in [formula].

Suppose 3  ≤  i  ≤  k - 3 and i  <  n. Then for all [formula], the permutation

[formula]

is in [formula].

Suppose k - 2  ≤  i  ≤  n  -  1. Then for all σ∈Sn - i(132,213,2341), the permutation

[formula]

is in [formula].

For all [formula], the permutation

[formula]

is in [formula].

This is similar to the proof of Lemma [\ref=lem:kk1inversemap].

The following hold for all n  ≥  1 and all k  ≥  4.

The map from [formula] to [formula] given by

[formula]

is a bijection between [formula] and the elements of [formula] which satisfy π- 1(n)  =  1.

The map from [formula] to [formula] given by

[formula]

is a bijection between [formula] and the elements of [formula] which satisfy π- 1(n)  =  2.

Suppose 3  ≤  i  ≤  k - 3 and i  ≤  n  -  1. Then the map from [formula] to [formula] given by

[formula]

is a bijection between [formula] and the elements of [formula] which satisfy π- 1(n)  =  i.

Suppose k - 2  ≤  i  <  n. Then the map from Sn - i(132,213,2341) to [formula] given by

[formula]

is a bijection between Sn - i(132,213,2341) and the elements of [formula] which satisfy π- 1(n)  =  i.

The map from [formula] to [formula] given by

[formula]

is a bijection between [formula] and the elements of [formula] which satisfy π- 1(n)  =  n.

These maps are clearly injective. Their ranges are contained in the correct sets by Lemma [\ref=lem:kk-1inverse]. They are surjective by Lemma [\ref=lem:kk-1form].

Using the last lemma, we obtain a recurrence for [formula].

For all n  ≥  1 and all k  ≥  4,

[formula]

Count the elements of [formula] according to the value of π- 1(n) and use Lemma [\ref=lem:kk-1bijection].

Using Proposition [\ref=prop:kk-1recurrence] we can now enumerate Sn(132,4213,2341). To do so, we will need the following results concerning various sums of Fibonacci numbers, generating functions for certain subsequences of the Fibonacci numbers, and generating functions for certain sequences of binomial coefficients. We omit the proofs, which are routine.

For all k  ≥  1 and all n  ≥  k,

[formula]

For all k  ≥  2, the generating function

[formula]

is given by

[formula]

For all k  ≥  0, the generating function

[formula]

is given by

[formula]

.

We now enumerate Sn(132,4213,2341).

For all n  ≥  1,

[formula]

Moreover, the generating function

[formula]

is given by

[formula]

The result is immediate for n  =  1,2, and 3 so we assume n  ≥  4. Setting k  =  4 in Proposition [\ref=prop:kk-1recurrence] and simplifying the result, we find

[formula]

Using Proposition [\ref=prop:Mansourfn+2-1] and ([\ref=eqn:FibSums]) to simplify the right side we find

[formula]

Applying the last line to itself repeatedly and using ([\ref=eqn:FibSums]) to simplify the result, we find

[formula]

as desired. It is routine using this and Propositions [\ref=prop:Fibgens] and [\ref=prop:binomialgens] to obtain ([\ref=eqn:Mansourk=4gf]).

Using the same approach, we now enumerate Sn(132,54213,2341).

For all n  ≥  2,

[formula]

Moreover, the generating function

[formula]

is given by

[formula]

The result is immediate for n  =  2,3, and 4 so we assume n  ≥  5. Setting k  =  5 in Proposition [\ref=prop:kk-1recurrence] and simplifying the result, we find

[formula]

Using Proposition [\ref=prop:Mansourfn+2-1], Theorem [\ref=thm:Mansourk=4], and ([\ref=eqn:FibSums]) to simplify the terms on the right side we find

[formula]

Applying this to itself repeatedly and using ([\ref=eqn:FibSums]) again, we find

[formula]

as desired. It is routine using this and Propositions [\ref=prop:Fibgens] and [\ref=prop:binomialgens] to obtain ([\ref=eqn:Mansourk=5gf]).

Finally, we enumerate Sn(132,654213,2341).

For all n  ≥  2,

[formula]

Moreover, the generating function

[formula]

is given by

[formula]

The result is immediate for n  =  2,3, and 4 so we assume n  ≥  5. Setting k  =  6 in Proposition [\ref=prop:kk-1recurrence] and simplifying the result, we find

[formula]

Using Proposition [\ref=prop:Mansourfn+2-1], Theorems [\ref=thm:Mansourk=4] and [\ref=thm:Mansourk=5], and ([\ref=eqn:FibSums]) to simplify the terms on the right side we find

[formula]

Applying this to itself repeatedly and using ([\ref=eqn:FibSums]) again, we find

[formula]

as desired. It is routine using this and Propositions [\ref=prop:Fibgens] and [\ref=prop:binomialgens] to obtain ([\ref=eqn:Mansourk=6gf]).

Using the same approach, one can (with enough patience and computational power) enumerate [formula] for any k  ≥  4. Rather than give explicit enumerations for larger values of k, we content ourselves with the following result concerning the form these enumerations will take.

For all n and k such that n  ≥  k  ≥  4, the set [formula] is enumerated by a linear combination of two Fibonacci numbers plus a polynomial of degree k  -  2.

Assume n  ≥  k; we argue by induction on k. The cases k = 4, k = 5, and k = 6 are done in Theorems [\ref=thm:Mansourk=4], [\ref=thm:Mansourk=5], and [\ref=thm:Mansourk=6], respectively. Therefore we assume k  ≥  7 and that the result holds for all k'  <  k. Inspecting the recurrence in Proposition [\ref=prop:kk-1recurrence], we find by induction that with the exception of [formula], each term on the right side may be written as a linear combination of two Fibonacci numbers plus a polynomial of degree at most k  -  3. In particular, we find

[formula]

for some polynomial pk - 3(n) of degree k  -  3 and constants a, b, r, and s. Applying this to itself repeatedly we find

[formula]

Using ([\ref=eqn:FibSums]) to simplify the right side of this equation, we find [formula] may be written as a linear combination of two Fibonacci numbers plus a polynomial of degree k  -  2, as desired.

We can use Theorem [\ref=thm:FibPolyFamily] to give a simple description of the connection between the sequence [formula] and the Fibonacci numbers. For a given sequence [formula] we refer to the sequence [formula] as the first difference sequence for [formula]. Similarly, we refer to the sequence obtained from [formula] by taking differences i times as the ith difference sequence for [formula]. Although the exact enumeration of Sn(132,k k - 1 4213,2341) seems to be quite complicated, we have the following result concerning the k - 3rd differences for the sequence |Sn(132,k k - 1 4213,2341)|.

For all k  ≥  4, the k - 3rd differences for [formula] satisfy the Fibonacci recurrence.

Observe that if [formula] satisfies the Fibonacci recurrence then so do all of its difference sequences. Also observe that if ai is a polynomial of degree n in i then the n + 1st difference sequence for [formula] consists entirely of zeroes. The result follows by combining these two observations with Theorem [\ref=thm:FibPolyFamily].

A Family of Restricted Permutations Counted by Sums of k-Generalized Fibonacci Numbers

In [\cite=Mansour33k] Mansour shows that

[formula]

In this section we generalize this result by lengthening the permutation 2341 to permutations of the form [formula]. We show that for all k  ≥  4,

[formula]

This complements Proposition [\ref=prop:k-3differences] in that it implies that the first differences of the sequence [formula] are the k - 2-generalized Fibonacci numbers. We begin by considering the form of a permutation in [formula].

Fix n  ≥  1, fix k  ≥  2, and suppose [formula]. Then π has the form

[formula]

for some [formula].

This is similar to the proof of Lemma [\ref=lem:12kform].

We now consider the permutations in [formula] according to the position of the largest element. We observe that for π∈Sn this position is given by π- 1(n).

Fix n  ≥  1, fix k  ≥  2, and suppose [formula]. If π- 1(n)  ≥  k - 1 then [formula].

Suppose [formula] and π- 1(n)  ≥  k - 1. If π- 1(n)  <  n then by Lemma [\ref=lem:23k1form] any k - 2 entries of π to the left of n, combined with n and any entry to the right of n, form a pattern of type [formula]. Therefore π- 1(n)  =  n and [formula] by the form of ([\ref=eqn:23k1form]).

Fix n  ≥  1, fix k  ≥  2, and fix i (1  ≤  i  ≤  min(k - 2,n - 1)). For all [formula], the permutation

[formula]

is in [formula].

Suppose [formula] and let π denote the permutation in ([\ref=eqn:23k1inversemap]); we show [formula]. Clearly π∈Sn, so it is sufficient to show π avoids 132, 213, and [formula]. Beginning with [formula], suppose by way of contradiction that π contains a subsequence of type [formula]. Since σ avoids [formula], any pattern of this type in π must use one of [formula] as the 2. Since i  ≤  k - 1, this pattern must also use an element of σ as the k, contradicting the form of ([\ref=eqn:23k1form]). Arguing in a similar fashion, it is routine to show π avoids 132 and 213.

For all n  ≥  1, all k  ≥  2, and all i (1  ≤  i  ≤  min(k - 2,n - 1)), the map from [formula] to [formula] given by

[formula]

is a bijection between [formula] and the elements of [formula] which satisfy π- 1(n)  =  i.

The map in ([\ref=eqn:23k1bijection]) is clearly injective. Its range is contained in the correct set by Lemma [\ref=lem:23k1inversemap]. It is surjective by Lemma [\ref=lem:23k1form].

Using the Lemmas [\ref=lem:23k1positionbound] and [\ref=lem:23k1bijection] we obtain a recurrence for [formula].

Fix k  ≥  3. For all n  ≥  k - 1 we have

[formula]

Count the elements of [formula] according to the value of π- 1(n) and use Lemmas [\ref=lem:23k1positionbound] and [\ref=lem:23k1bijection].

Using ([\ref=eqn:fibrecurrenceplusone]) we now show that the first differences for the sequence [formula] are the k - 2-generalized Fibonacci numbers. To do this we will need the following result of Simion and Schmidt.

[\cite=SimionSchmidt] For all n  ≥  1,

[formula]

For all k  ≥  3 and all n  ≥  1,

[formula]

Suppose 1  <  n  <  k. In this case [formula], so by ([\ref=eqn:SS2n-1]) we have [formula]. Now suppose n  ≥  k. In this case by ([\ref=eqn:fibrecurrenceplusone]) we have

[formula]

and

[formula]

Subtract the second line from the first to find that

[formula]

Comparing this with ([\ref=eqn:kgenrecurrence]) we find that [formula] and Fk - 2,n satisfy the same recurrence. Since they also have the same initial conditions, they are equal.

For all k  ≥  2 and all n  ≥  1,

[formula]

Moreover, the generating function

[formula]

is given by

[formula]

By ([\ref=eqn:kgendifference]) we have

[formula]

Applying this to itself repeatedly gives ([\ref=eqn:secondtolast]). It is now routine using ([\ref=eqn:fibrecurrenceplusone]) and Proposition [\ref=prop:SS2n-1] to obtain ([\ref=eqn:last]).

Open Problems and Conjectures

We conclude with some open problems and conjectures suggested by the results in this paper.

In [\cite=Mansour33k] Mansour shows that for all n  ≥  1,

[formula]

Based on numerical evidence, we conjecture that the following also hold.

[formula]

[formula]

One ought to be able to prove these conjectures using generating trees. (See [\cite=WestGenTrees] for more information on generating trees.)

Generalize ([\ref=eqn:op1]) and ([\ref=eqn:op2]) to an infinite family [formula] of sets of forbidden subsequences such that |Sn(Ri)| is given by a linear combination of two Fibonacci numbers plus a polynomial for all i  ≥  3.

In section [\ref=sec:fibpolyfamily] we show that the k - 3rd difference sequence for the sequence [formula] satisfies the Fibonacci recurrence. In section [\ref=sec:kgendiff] we show that the first difference sequence for [formula] satisfies the k - 2-generalized Fibonacci recurrence. For all i  ≥  2 and all k  ≥  3, find a set Ri,k such that the ith difference sequence for |Sn(Ri,k)| satisfies the k-generalized Fibonacci recurrence.

Give bijective proofs of Theorems [\ref=thm:Mansourk=4], [\ref=thm:Mansourk=5], and [\ref=thm:Mansourk=6].

Give an explicit enumeration of [formula] for all k  ≥  4.

The author would like to thank Darla Kremer for many helpful comments, suggestions, and conversations.