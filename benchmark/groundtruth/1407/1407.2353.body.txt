Non-Ergodicity of Nose-Hoover chain thermostat in computationally achievable time

Ergodicity of dynamics is a pre-requisite for obtaining statistical-mechanical properties of a system from a single dynamical trajectory, generated, for example, through molecular dynamics simulations [\cite=ref18]. The ergodic hypothesis in this context may be stated as: given sufficiently long time, a single phase space trajectory of the system must visit all regions of the accessible phase space with the same relative frequency as in the phase space distribution. For a physical system, S, in equilibrium and in contact with a reservoir at constant temperature, T, the equations of motion must result in a trajectory consistent with the canonical distribution [formula]. Here, [formula] where kB is the Boltzmann constant, and E is the instantaneous energy of S. In this case, ergodicity can also be interpreted as space-filling dynamics (quasi-ergodicity). Amongst the several temperature control algorithms available (velocity rescaling [\cite=Woodcock_rescale_thermostat] [\cite=Hoover_GIK_thermostat] [\cite=Evans_GIK_thermostat_2] [\cite=Evans_GIK], deterministic [\cite=Nose_Originial] [\cite=Nose_Hoover] [\cite=MKT_Thermostat] [\cite=Hamilton_Modified_NH] [\cite=Winkler_Thermostat] [\cite=HH_thermostat] [\cite=Bond_Leimkuhler_thermostat] [\cite=BT_thermostat] [\cite=Samoletov_Config_thermostat] [\cite=PB_thermostat] and stochastic [\cite=Andersen_thermostat] [\cite=Grest_stochastic_thermostat] [\cite=Langevin_thermostat]), the deterministic thermostats possess the appeal of having autonomous and time reversible dynamics. However, our current understanding on ergodic characteristics of most deterministic thermostats remains primitive. For example unlike previously thought, not all two parameter thermostats are ergodic [\cite=Hoover_mutifractal_dissipation_coexistence]. Possibly the simplest and most commonly used deterministic thermostat, the Nose-Hoover (NH) thermostat [\cite=Nose_Hoover] [\cite=Hoover_csm_book] also suffers from poor ergodicity in systems with small degrees of freedom [\cite=Legoll_NH_non_ergodicity] [\cite=Kusnezov_thermostat_scheme] [\cite=Kusnezov_thermostat_scheme_v2] [\cite=Hoover_mutifractal_dissipation_coexistence] [\cite=Posch_Hoover_Vesely_NH_non_ergodicity]. If and only if the extended system (physical system + reservoir) is ergodic with respect to the invariant measure of system dynamics, S has a canonical distribution [\cite=Cho_ergodicity] [\cite=Nose_MD_thermostat_review] with its dynamics being phase-space filling.

The Nose-Hoover chain (NHC) and Hoover-Holian thermostats have generally been considered to resolve the ergodicity issues of NH thermostat in equilibrium [\cite=Hoover_mutifractal_dissipation_coexistence] [\cite=ref18] [\cite=Watanabe_NH_ergodicity] [\cite=HH_thermostat]. In this work, we focus only on NHC thermostat. NHC controls the fluctuations of thermostat η by coupling it with a new thermostat variable, ξ [\cite=MKT_Thermostat] [\cite=ref18]. Fluctuations of the second thermostat (ξ) can likewise be controlled with a third and so on thus forming a chain. The dynamics with two chains NHC thermostat for a single harmonic oscillator with unit mass and spring constant becomes:

[formula]

However, no conclusive proof of its ergodicity has been put forward so far [\cite=Watanabe_NH_ergodicity] and all previous attempts have involved proving that the marginal distributions of position (x) and velocity (p) [\cite=MKT_Thermostat] [\cite=Tuckerman_JPCB_2000] are Gaussian.

In this work, we show conclusive evidence that (i) NHC dynamics is not ergodic (ii) the physical system does not follow the canonical distribution at every Poincare section, and (iii) when the difference in thermostat masses is large, the dynamics due to NHC reduces to NH dynamics. We also conjecture how previous studies might have missed these points. We limit the scope of this work to two chain NHC thermostat.

It can be easily shown that the invariant measure of NHC phase space is:

[formula]

where, Z is the normalizing constant. Due to the statistical independence of all the variables, their marginal densities are Gaussian. Further, the conditional density function, f(x,p|η  =  η0,ξ  =  ξ0), at fixed values of ξ  =  ξ0 and η  =  η0 is uncorrelated bivariate normal:

[formula]

([\ref=eq:bivar_cond_dist]) must hold true for all Poincare sections for NHC to sample from canonical distribution and any deviation of joint probability distribution function (JPDF) from bivariate Gaussian indicates non-canonical nature of the dynamics. If such non-canonical dynamics exist, then the overall dynamics must be non-ergodic with holes present in the phase-space. Similar argument holds true for conditional distribution of f(η,ξ|x = x0,p = p0). Similar argument holds true for univariate conditional distribution function: [formula].

We simulated the extended system involving the harmonic oscillator ([\ref=eq:six]) at β = 1 using four thermostat mass pairs: Qη,Qξ  =  (1,1),(10,0.1),(50,0.02) and (100,0.01). Since the fluctuations of reservoir η are controlled by the second reservoir ξ, effective thermostatting of η can occur only if Qξ  ≪  Qη. Equations of motion ([\ref=eq:six]) were integrated using Runge-Kutta-Fehlberg method and run for 200 billion time steps each of 0.001. Various initial conditions were chosen. The canonical nature of the physical system, or equivalently, the ergodic nature of the extended system, was investigated on various Poincare sections of the 4-D phase space through joint moments, Kullback-Leibler distance, Hellinger distance and presence of holes of non-zero measure.

When initial conditions were chosen far from fixed points (given by [formula]), the trajectories never came close to the fixed point during the simulation duration. Four such Poincare sections initialized at x = 1.1,p = 1.1,η = 0,ξ = 0 are shown in Figure [\ref=fig:plot1]. In each case there is a significant deviation from bivariate normal near the origin (x = 0,p = 0): the JPDF is in fact zero in Figures [\ref=fig:plot1](a) and (c). This deviation would be missed if instead, the JPDF of x - p is obtained by projecting the dynamics from the 4d space onto the x - p plane. The deviation from Gaussian becomes even more apparant when one studies the Poincare section defined at x = 0 and p = 0. In fact, one can conclude just by looking at the JPDFs of η,ξ(see Figure [\ref=fig:plot3]) that they are not bivariate Gaussian.

We checked the convergence in distribution of the JPDF (f1) of x,p (RHS of [\ref=eq:bivar_cond_dist]) to the uncorrelated standard bivariate normal (f2) with the help of Hellinger [\cite=Hellinger_distance] and symmetrical form of Kullback-Leibler (KL) [\citep=KLD_Paper] distances:

[formula]

[formula]

The evolution of the Hellinger and KL distances between the uncorrelated standard bivariate normal and the JPDF of (x,p) at each of the Poincare sections of Figure [\ref=fig:plot1] is shown in Figure [\ref=fig:plot2]. Despite long simulations, the distributions do not converge. We also looked at the first 6 even joint moments of x,p:〈x2np2n〉 (n varying from 1 to 6) and found that deviations were as high as 43%, 75%, 40% and 226% respectively in the four cases from those of standard uncorrelated bivariate normal. Previous studies have used marginal distributions as a basis to argue that NHC generates canonical dynamics. We too found that non-Gaussian features are overlooked if one looks only at the marginal distributions, or JPDFs obtained through projections on a plane. Examples where marginal Gaussian variables do not produce the joint Gaussian distribution may be found in standard probability texts(for example [\cite=Feller_book]).

The non-ergodic nature of the dynamics is further revealed by the phase-space plots in Figures [\ref=fig:plot4] and [\ref=fig:plot5] (corresponding to Figures [\ref=fig:plot1] and [\ref=fig:plot3], respectively). Holes are clearly present in the phase space. As the difference of the thermostat masses decreases, the holes rotate in the plane. Due to the complexity of the dynamics in 4-dimensional space, attempts to find stable periodic orbits were unsuccessful. We therefore take an alternate route to confirm that the holes are of non-zero measure. We focused around one of the possible locations of holes because of anti-symmetry of Figure [\ref=fig:plot5]. Instead of working with Poincare sections, we took a splice of much larger width in x - p. We looked at the region -   λ   ≤   x   ≤   λ; -   λ   ≤   p   ≤   λ and kept increasing λ until η   -   ξ plot showed no existence of sparesely populated region. If the unoccupied regions in Figures [\ref=fig:plot4] and [\ref=fig:plot5] were limited to just one hyperplane, i.e. λ  ≈  0 when sparsely populated regions disappear, then the measure of the holes present in the system would be zero and the dynamics would still be ergodic. The corresponding JPDFs would have been uncorrelated bivariate standard normal. Figure [\ref=fig:plot6] shows the presence of very small unpopulated regions when λ   =   0.1. This confirms that there is a hole whose x - p boundary is given by |x|   ≈   0.1 and |p|   ≈   0.1 . Further, unlike other cases, the hole for the case of Qη = 100,Qξ = 0.01 was found to be a through hole. The size of the hole progressively decreases and reaches a minimum value when both thermostat masses are set at 1 (but does not remain confined to one hyperplane and hence, is of non-zero measure).

Theoretically, it is possible to understand why NHC shows through holes for large difference in masses. Using the transformation η'  =  η  /  Qη and ξ'  =  ξ  /  Qξ, ([\ref=eq:six]) can be written in terms of η' and ξ'. Choosing x  =  r sin θ and p  =  r cos θ, and rearranging in terms of [formula] and [formula], ([\ref=eq:six]) can be rewritten as:

[formula]

Under the scenario Qξ   ≤   Qη, the fluctuations of ξ' occur at a much faster rate than other variables. As a result, ξ' may be replaced by its average. Once the steady state is reached, ξ' fluctuates around the mean and consequently, its average is zero. ([\ref=eq:na]) can be written in terms of three variables:

[formula]

([\ref=eq:na1]) is same as the standard Nose-Hoover dynamics [\cite=Watanabe_NH_ergodicity] and hence shows similar features (as well as problems) as the NH thermostat. The Hoover-Holian thermostat, on the other hand, does not show problems highlighted before.

To summarize, we used numerical simulations to demonstrate that in the rather long time duration considered, Nose-Hoover chain thermostat is unable to generate a canonical distribution in certain Poincare sections, despite the overall projection being quite close to canonical. This occurs due to the presence of two 4-dimensional holes of non-zero measure. Merely showing the Gaussian nature of marginal distributions of position and velocity, as has been done in the past, is not sufficient to prove ergodicity. Since the trajectories of x,p,η and ξ each constitutes a stochastic process, it can also be argued that the EOMs ([\ref=eq:six]) do not support the assumption of ergodicity ([\ref=eq:measure_NHC]) which implies each of the four processes is stationary Gaussian. For if p is a Gaussian process, so is its derivative [formula], and if p is stationary Gaussian, it is also independent of [formula] at the same instant - both of which are violated by ([\ref=eq:six]) (and likewise for η and ξ). We however do not probe this stochastic process angle further in this letter.