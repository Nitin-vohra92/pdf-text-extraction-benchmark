Piecewise linear periodic maps of the plane with integer coefficients

Introduction

In 1993, Morton Brown published an interesting piecewise linear, periodic map of the plane with integer coefficients, stating that it had found applications in dynamics, topology and combinatorics [\cite=Mort2]. The Zentralblatt review [\cite=Ch] of the paper reported: Brown had posed the problem of proving its periodicity 10 years earlier in [\cite=Mort1], wherein the problem was expressed in terms of the recurrence relation hn + 1 = |hn| - hn - 1. In [\cite=Mort2], Brown gave his own geometric proof and a combinatorial proof due to Donald Knuth. He quotes Knuth: The aim of this paper is to revisit Brown's intriguing map. We give four other maps, of order 5, 7, 8 and 12, which are very similar to Brown's map in that they are piecewise linear in two pieces, the right half plane and the left half plane. We show that there are no other possible orders for such maps. We then show that every integer n > 1 appears as the period of a piecewise linear, periodic map of the plane with integer coefficients, provided we allow enough piecewise linear pieces. Finally, we explain how the collection of these maps can be classified in terms of rooted binary tress of fixed height.

Background remarks

In its simplest incarnation, the crystallographic restriction says that if A is a 2  ×  2 matrix with integer coefficients and [formula] for some natural number n, then n = 1,2,3,4 or 6. For more information and related results, see [\cite=KP] [\cite=BCK]. Here is a proof of the crystallographic restriction (we will need similar ideas shortly). Let A be such a matrix. As [formula], we have [formula]. Similarly, if A has a complex eigenvalue λ, with complex eigenvector z, then Anz = z gives λn = 1, so λ is a root of unity. So if λ is real, then [formula]. In this case, A2 has determinant 1, and it has 1 as an eigenvalue, so its Jordan canonical form is [formula], for some w. Then as A2 has finite order, one obtains w = 0 and thus [formula]. If λ is not real, then as λ satisfies the characteristic polynomial, [formula], it has real part [formula]. In this case, as [formula] is an integer and λ is a root of unity, we have [formula]. In this case, as A has two distinct eigenvalues, A is diagonalizable over [formula]; if [formula], then λ  =    ±  i and A has order 4. If [formula], then [formula] and A has order 3 or 6. This proves the crystallographic restriction.

Note that when A has nonreal eigenvalues, they are complex conjugates, so their product, which is det (A), is positive. So det (A) = 1. Choosing an arbitrary nonzero vector z in [formula], we can then consider the basis { - Az,z}, relative to which A is conjugate to the matrix [formula]. This gives the following examples of matrices of order 3,4,6 respectively:

[formula]

The periodicity of these matrices has a nice geometric description. In Figure [\ref=F:lin], the respective matrices map region i to region i + 1, modulo the order of the matrix.

Brown's order 9 map,

[formula]

is composed of two parts, one using the order 3 map α and the other using the order 6 map γ. It can be written explicitly as follows:

[formula]

The picture for Brown's map is shown in Figure [\ref=F:MB]. The periodicity of the map is established simply by verifying that the vertices of the polygon are mapped to each other in the fashion indicated in the figure. This is Brown's geometric proof.

Similar examples

Brown's map combines the matrices α,γ. Similar maps can be constructed by combining α,β and β,γ, as we now show. First consider the map G of the plane defined by

[formula]

The map G has order 5; the corresponding picture is shown in Figure [\ref=F:o5]. Like Brown's map, G can be written succinctly using the absolute value function: [formula]. And in the same way that Brown's map encodes the recurrence relation hn + 1 = |hn| - hn - 1, the map G has a related recurrence relation [formula].

Now consider the map F defined by

[formula]

The map F has order 7; the corresponding picture is shown in Figure [\ref=F:o7]. One has [formula], and F has a related recurrence relation [formula].

The maps we have seen so far have used the matrices α,β,γ, which are all elliptic matrices; that is, their trace has absolute value < 2. Some investigation reveals other piecewise linear maps involving parabolic matrices (i.e., those whose trace has absolute value 2) or hyperbolic matrices (i.e., those whose trace has absolute value > 2). Let us introduce the matrices

[formula]

Now consider the maps E,D defined by

[formula]

The map E has order 8; the corresponding picture is shown in Figure [\ref=F:mu]. The map D has order 12; the corresponding picture is shown in Figure [\ref=F:nu]. Of course, these maps can also be expressed in formulas using the absolute value function, and they also encode second order recurrence relations.

Maps with half-plane piecewise linear pieces

The aim of this section is to show that the maps we have seen so far effectively exhaust all the possible immediate generalisations of Brown's map.

Suppose that f is a periodic continuous map of the plane that is linear with integer coefficients in each half plane [formula] and x < 0. Then f has period 1,2,3,4,5,6,7,8,9 or 12.

Before presenting the proof of this theorem, we make a remark about general piecewise linear maps, not just maps that are linear in each half plane. We will use this remark in the proof of the theorem, and again later in the paper.

Suppose that f is a piecewise linear map of the plane with period n defined by matrices [formula] on respective open cones [formula]. So the complement of the union of these cones is a union of closed rays [formula] say. Consider the union R of the images of these rays:

[formula]

The set R is a finite union of the rays, and the restriction of each power of f to each connected component of the complement to R is a linear map, which is a certain product of the Ai (which may depend on the component). As these components are open sets, it follows that the corresponding matrix products for fn are all identity matrices. In particular, since the Ai are integer matrices, det Ai  =    ±  1 for all i. If f is orientation preserving, then det Ai = 1 for each i, while if f is orientation reversing, det Ai =  - 1 for each i.

Note that via the central projection, f induces (and is determined by) a periodic homeomorphism of the unit circle. It follows from well known results (see [\cite=CK]) that if f is orientation reversing, then [formula], while if f is orientation preserving, then f is topologically conjugate to a rotation by the angle of 2πk / n, for some k and n are coprime. There are infinitely many orientation reversing maps of period two. For example, consider the map defined by the matrix A1 (resp. A2) in the right (resp. left) half plane, where

[formula]

In the orientation preserving case, the number k / n is called the rotation number of f. Such an f has no fixed points on the unit circle. In particular, none of the corresponding matrices Ai has a positive eigenvalue.

Suppose that f is a piecewise linear map of period n defined by two integer matrices A1,A2 say, with

[formula]

From the above remark, we may assume that det A1  =   det A2 = 1. The continuity of f means that [formula]; that is, A1,A2 have the same second column. By a global conjugation by a matrix of the form [formula] with [formula], we may assume that

[formula]

for some [formula]. From the above remark, neither A1 nor A2 has a positive eigenvalue. So we have a,b  ≤  1. Furthermore, by a global conjugation by the matrix [formula] if necessary, we may assume that a  ≥  b. If a = b, then f is itself linear, in which case its order is 1,2,3,4 or 6 by the crystallographic restriction. So we may assume that 1  ≥  a > b.

If b  ≥   - 1, there are only three possibilities:

(a,b) = (1, - 1), in which case A1  =  γ,A2  =  α and f = H.

(a,b) = (1,0), in which case A1  =  γ,A2  =  β and f = G.

(a,b) = (0, - 1), in which case A1  =  β,A2  =  α and f = F.

We may assume that a  ≥   - 1. To see this, suppose that a  ≤   - 2, so that a,b  ≤   - 2. Consider the sequence [formula] defined by (xm + 1,xm)t  =  fm(1,0)t for all [formula]. We will show by induction that xm + 1 / xm <  - 1 for all m. We have x2 / x1 = a <  - 1. If xm + 1 / xm <  - 1, then

[formula]

where c = a or b, depending of m. But if xm + 1 / xm <  - 1 for all m, then f cannot be periodic. So a∈{ - 1,0,1}.

Note that there are no cases with a = 0 and b <  - 2. Indeed, suppose that a = 0 and b <  - 2. The matrix A2 has eigenvalues [formula] and corresponding eigenvectors X± = (λ±,1)t, which lie in the second quadrant. So f(X±) = A2X± is in the fourth quadrant. Then f3(X±) = A21A2(X±) =  - λ±X±, since A1  =  β, which is a rotation through π / 2. But this is impossible as [formula] and f is periodic. When a = 0 and b =  - 2, the matrix A2 has the eigenvector X = ( - 1,1)t with eigenvalue - 1, and the same argument shows that f3(X) = A21A2(X) = X. So if f is periodic it must have period 3. But for example, f3(0, - 1)t = ( - 1,0)t. So the cases a = 0 and b <  - 1 cannot appear.

Similarly, there are no cases with a = 1 and b <  - 2. Indeed, suppose that a = 1 and b <  - 2 and let X± be as in the previous paragraph. So as before, f(X±) = A2X± is in the fourth quadrant. Then f4(X±) = A31A2(X±) =  - λ±X±, since A1  =  γ and [formula] (see the right hand diagram in Figure [\ref=F:lin]). But once again, this is impossible as [formula] and f is periodic. When a = 1 and b =  - 2, the matrix A2 has the eigenvector X = ( - 1,1)t and the same argument shows that f4(X) = A31A2(X) = X. So if f is periodic it must have period 4. But for example, f4(0, - 1)t = ( - 1,0)t. So the cases a = 1 and b <  - 1 cannot appear.

When a =  - 1,b =  - 2, we have f = E and when a =  - 1,b =  - 3, we have f = D, where E and D are the periodic maps defined at the end of the previous section.

It remains to show that the cases a =  - 1,b <  - 3 cannot occur. Suppose that a =  - 1,b  ≤   - 4 and let [formula] and consider the vector [formula]. Note that λ > 0 and so [formula]. It follows that f(X) = A1(X) is in the second quadrant. So f2(X) = A2A1(X). But

[formula]

and λ has been chosen so that it is an eigenvalue of A2A1 with eigenvector X. So f2(X) = λX. When b <  - 4, we have λ > 1, and so f cannot be periodic. When b =  - 4, we have λ = 1 and so f can only have periodic two. But f2(1,0)t = A2A1(1,0)t = (3, - 1)t, so b =  - 4 is also impossible.

Brown's map H and the map F of order 7 each wrap twice around the origin, so they have rotation number [formula] and [formula] respectively, while α,β,G,γ have rotation numbers [formula] respectively, and the maps E,D have rotation numbers [formula] respectively. The 5th iterate H5 has rotation number [formula]. It takes region i to region i + 5 mod 9 in Figure [\ref=F:MB]. Similarly, the maps E3 and D5 have rotation numbers [formula] respectively. In general, if a map f has rotation number [formula], where k,n are coprime, then fj has rotation number [formula], where j is the multiplicative inverse of k in [formula]. Notice that the maps H5,E3,D5 are not like the maps considered in this section. They are not composed of maps that are linear on two half planes. Instead they are piecewise linear with 9,8,12 piecewise linear parts respectively.

The general situation

When one allows piecewise linear maps with more than two pieces, periods other than the ones we saw above are possible. In fact, any period is possible, as we will show below.

Consider n distinct nonzero vectors [formula] in the plane, with integer coordinates, arranged in anti-clockwise order, so that the angle between each pair of successive vectors is less than π. Let Ci denote the closed cone between the rays [formula] and [formula], where here and below, the subscripts are taken modulo n. Suppose we have a map f of the plane such that for each [formula], the restriction fi: = f|Ci is defined by a matrix [formula]. Suppose furthermore that fi(ei - 1) = ei, fi(ei) = ei + 1 and fi(Ci - 1) = Ci for all i. So f is periodic with order n and rotation number [formula]. Notice that since the matrices Ai have determinant 1, the maps fi are area preserving. Thus, for each i, we have ei - 1  ×  ei = fi(ei - 1)  ×  fi(ei) = ei  ×  ei + 1, where ×   denotes the vector cross product. Hence ei  ×  (ei - 1 + ei + 1) = 0, and so ei - 1 + ei + 1 = miei for some [formula]. Note that relative to the basis {ei - 1,ei}, the map fi has matrix representation [formula]. So, as fi has integer trace, we have [formula].

The sequence [formula] encodes much of the nature of the map. For the maps considered above, with the vertices of the polygons taken as our vectors ei, the corresponding sequences are shown in Table [\ref=Table]. Note that using the sequence [formula], the vectors ei can all be determined from e0,e1 by the recurrence relation ei - 1 + ei + 1 = miei, and the maps f1 are also determined as their matrix representation [formula] relative to the basis {ei - 1,ei}. So, up to a global linear conjugacy, the map is completely determined by the sequence. Indeed, as we will explain below, we can fix e0 = (1,0)t and e1 = (0,1)t, and then the map is determined by the sequence.

Not all integer sequences appear as the sequence of some piecewise linear map. For n = 3, there is essentially only one map. Indeed, for e0 = (1,0)t and e1 = (0,1)t, we have m2e2 = e0 + e1 = (1,1)t and then

[formula]

It follows that m0 = m1 = m2 =  - 1. So the map is (conjugate to) the globally linear map defined by the matrix α. Notice that in this case, the sum e0 + e1 + e2 is zero. This observation will be useful later on.

For each n > 3, there are infinitely many piecewise linear maps of order n, even up to global linear conjugacy. For n = 4, examples are furnished by the polygons with vertices e0 = (1,0)t,e1 = (0,1)t,e2 = ( - 1,0)t,e3 = (m, - 1)t, and matrices

[formula]

The corresponding sequence is 0, - m,0,m. The case m = 0 is the globally linear map determined by the matrix β. The polygons for the values m = 1,2,3 are shown in Figure [\ref=F:o4].

We will exhibit maps with n > 5 below. But first we give a useful simplification, that will obviate the need to give explicit matrices Ai. The observation is two-fold. Firstly, notice that without loss of generality we may assume that the triangles 0,ei,ei + 1 all have area [formula]. Indeed, conjugating by an element of [formula] we may assume that e0 = (x,0)t and that e1 = (0,y)t for some [formula]. Since e1 = A1e0 and [formula], we have [formula] for some [formula], and so y = x since A has determinant 1. Then using the recurrence relation ei + 1 = miei - ei - 1, the coordinates of the vectors ei are all multiples of x. So we may replace the ei by [formula]. Then e0 = (1,0)t and e1 = (0,1)t, so the triangle 0,e0,e1 has area [formula]. Then as the maps fi are area preserving, all the triangles 0,ei,ei + 1 have area [formula].

Given a piecewise linear map f of period n and rotation number [formula], we will say that the polygon determined by the vertices [formula], as described above, is the fundamental polygon of f.

By Pick's theorem [\cite=GS], a closed planar triangle T having its vertices on the integer lattice has area [formula] if and only if the only lattice points in T are its three vertices. So in a fundamental polygon of order n, the only lattice points are the origin and the n vertices.

The second observation, and this is the useful part, is that every star shaped polygon with vertices [formula], listed counter-clockwise, with integer coordinates, for which the triangles 0,ei,ei + 1 all have area [formula], occurs as the fundamental polygon of a piecewise linear map f. Indeed, we uniquely define f by imposing the requirements that the linear restrictions fi satisfy fi(ei - 1) = ei and fi(ei) = ei + 1. This guarantees the continuity of f. It remains to see that the maps fi belong to [formula]. Notice that the assumption that the triangles 0,ei,ei + 1 have area [formula] means that the matrix

[formula]

Admissible sequences

We have seen that up to conjugacy, a piecewise linear map is determined by its fundamental polygon [formula], or equivalently, by its sequence [formula], where ei - 1 + ei + 1 = miei. Let us say that a sequence of integers is admissible if it appear as the sequence of some map. As we saw in the previous section, the only admissible sequence of length 3 is - 1, - 1, - 1.

Note that if we insert a vertex êi = ei + ei + 1 between ei and ei + 1 in a fundamental polygon [formula], then ei - 1  +  êi = (mi + 1)ei and êi + ei + 2 = (mi + 1 + 1)ei + 1. Thus the sequence [formula] changes to [formula]. For example, applying edge insertion to the sequence - 1, - 1, - 1 gives the sequence 0, - 1,0,1.

By Theorem [\ref=T:vi], the admissible sequences of length ≥  4 are the sequences that can be obtained by vertex insertion, as described in the previous paragraph, starting with the sequence 0, - m,0,m, where m  ≥  0. Notice that for the sequence - 1, - 1, - 1 and the sequences 0, - m,0,m, the sequence sum is 3n - 12, where n is the length of the sequence. Since vertex insertion increases the length by 1 and the sequence sum by 3, we have that all admissible sequences of length n have sum 3n - 12. In a sequence [formula], the entry mi is the trace of the map fi, as described in the previous section. So fi is elliptic (resp. parabolic, resp. hyperbolic) if |mi| < 2 (resp. |mi| = 2, resp. |mi| > 2). The sequence sum, [formula], is the sum of the traces of the maps fi. So the average trace is [formula]. Thus Theorem [\ref=T:vi] has the following corollary.

Consider a piecewise linear map of the plane of period n and rotation number [formula], composed of linear parts fi for [formula]. Then the average trace of the fi is [formula]. In particular, as n tends to infinity the average of the traces tends to 3.

Although vertex insertion gives an algorithm for producing all admissible sequences, there is no simple formula giving the admissible sequences of a particular length. The combinatorial difficulties involved should become apparent in the next section.

Fundamental polygons

Because fundamental polygons with 4 vertices have two collinear vectors, and since the fundamental polygons of higher order are built by vertex insertion, it follows that all fundamental polygons with at least 4 vertices have two collinear vectors, which we may take to be e0 = (1,0)t and ek = ( - 1,0)t. So in order to describe all fundamental polygons P it suffices to describe the intersection of P with the upper and lower half planes. Such a half plane is formed by k + 1 distinct nonzero vectors [formula] arranged in the plane in anti-clockwise order, with integer coordinates with nonnegative x-coordinate, such that the triangles 0,ei,ei + 1 all have area [formula]. But as we explained above, up to an integer shear in the x-direction, we may take e0 = (1,0)t and e1 = (0,1)t. So we actually only need to describe the k - 2 vectors [formula] of a fundamental polygon in the second quadrant. These structures are in a one to one correspondence with rooted binary trees having k - 2 nodes. To avoid making this too notationally cumbersome, we will simply describe this correspondence with an example.

As we have described in the previous section, the fundamental polygon is given by a number of vertex insertions. Each vertex insertion opens up the possibility of two further vertex insertions. This produces a binary tree whose nodes are labelled by the vertices that are inserted. Figure [\ref=F:tree] shows the complete tree of possible insertions of height 4. A particular fundamental polygon is given by a subtree commencing at the root. For example, the fundamental polygon shown in Figure [\ref=F:up] corresponds to the tree shown in Figure [\ref=F:treeEx]. Note that the tree appears naturally inside the fundamental polygon, as depicted in Figure [\ref=F:up].

A general fundamental polygon is determined, up to a global linear conjugation, by two rooted binary trees and an integer: one rooted binary tree for the fundamental polygon in the upper half plane, one rooted binary tree for the fundamental polygon in the lower half plane, and an integer m determining a horizontal shear [formula] of the lower half plane. Finally, to uniquely determine the fundamental polygon, one needs to take account of the fact that one fundamental polygon might be obtained from another by the map (x,y)  ↦  ( - x, - y).