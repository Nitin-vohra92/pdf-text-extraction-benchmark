Lemma Proposition Corollary Conjecture Claim Observation Question Definition Example

On r-dynamic Coloring of Grids

, Tobias Müller

, and Douglas B. West

Introduction

When proper graph colorings represent assignment of vertices to categories, in some applications it is desirable for vertices to have neighbors in many categories. This increases the number of colors needed.

An r-dynamic k-coloring is a proper k-coloring f of G such that |f(N(v))|  ≥   min {r,d(v)} for each vertex v in V(G), where N(v) is the neighborhood of v and f(U)  =  {f(v):  v∈U} for a vertex subset U. The r-dynamic chromatic number, introduced by Montgomery [\cite=M] and written as χr(G), is the least k such that G has an r-dynamic k-coloring.

Note that χ1(G) = χ(G), where χ(G) is the ordinary chromatic number of G. Montgomery called the 2-dynamic chromatic number simply the dynamic chromatic number. Many results were motivated by Montgomery's conjecture that χ2(G)  ≤  χ(G) + 2 when G is regular, which remains open. Bounds on χr and further references for work on χr and its variations appear in [\cite=JKOW].

In this note we complete the solution of a problem in [\cite=JKOW]. For [formula], let [formula]. The m-by-n grid Gm,n is the graph with vertex set ×  [n] such that (i,j) and (i',j') are adjacent if and only if [formula]. (In more general language, Gm,n is the cartesian product of paths with m and n vertices.) The problem of computing χr(Gm,n) for all r,m,n was proposed in [\cite=JKOW].

The following observations are immediate from the definition.

To avoid trivialities, assume [formula]. Akbari, Ghanbari, and Jahanbekam [\cite=ACJ2] proved χ2(Gm,n) = 4. Jahanbekam, Kim, O, and West [\cite=JKOW] then determined most of the other values. Since Δ(Gm,n)  ≤  4, by Observation [\ref=easy] we need only consider [formula].

If m and n are at least 2, then

[formula]

The upper bounds in Theorem [\ref=oldvalue] are by explicit construction. Setting f(i,j) = i + 2j mod 5 yields a 4-dynamic 5-coloring of Gm,n. Constructions for χr(Gm,n)  ≤  4 are obtained by repeating (and truncating when m or n is twice an odd number) the block below.

[formula]

The lower bounds in Theorem [\ref=oldvalue] are from Observation [\ref=easy2], except when m or n is odd and the other is not twice an odd number. In that case, the lower bound follows from the discussion in Lemma [\ref=ring]. A statement similar to Lemma [\ref=ring] is used in [\cite=JKOW] to prove Theorem [\ref=oldvalue]. We include a more explicit version of their observations, because we will use them in proving our main result. The discussion also shows why the remaining case is harder, and it restricts the configurations that need to be considered in that case. For [formula] with [formula], the authors in [\cite=JKOW] proved that five colors suffice and conjectured that five colors are needed. The proof of this conjecture is the content of this note.

If [formula] and [formula], then χ3(Gm,n) = 5.

Preliminary Lemmas

We henceforth assume [formula], with m odd. We represent a coloring of Gm,n by a matrix X, with xi,j = f(i,j). We use the four colors a,b,c,d; their names may be permuted as needed, often invoked by saying "by symmetry".

In the statements of the lemmas, we choose m to be a smallest odd integer such that a 3-dynamic 4-coloring of Gm,n exists for some n, and we restrict the properties of such a coloring. We say that a position sees a color if it has a neighbor with that color; each position other than the four corners must see three colors. The border vertices are the vertices with degree less than 4.

The necessity of [formula] was obtained in [\cite=JKOW]. We give a more explicit description of the coloring than they did, since we continue on to obtain a contradiction. As we have mentioned, the discussion in the proof of Lemma [\ref=ring] is similar to [\cite=JKOW].

A portion of a row or column is periodic if vertices having the same color are separated by a multiple of four positions.

The color sequences on the first two rows and first two columns are periodic. Letting a = x1,1, b = x1,2, c = x2,1, and d = x2,2, the four colors are distinct. The cycle of colors is (a,b,c,d) in the first row, (c,d,a,b) in the second row, (a,c,b,d) in the first column, and (b,d,a,c) in the second column. Furthermore, [formula] is necessary (given that m is odd), and columns n - 1 and n are copies of columns 1 and 2, respectively.

Since border vertices have degree at most 3, the colors x1,1,x1,2,x2,1,x2,2 are distinct. Each noncorner border vertex must see three colors. Repeatedly using this observation determines the first two rows and first two columns as claimed. Once the argument for the first two rows or first two columns reaches their ends, the same argument determines the last two columns and last two rows.

We have restricted m to be odd. The diagram below, in the two cases [formula] and [formula], incorporates all the cases for (m,n). In the bottom row the first two elements agree with the top row when [formula] and reverse those two elements when [formula]. By symmetry, the last two columns must exhibit the same behavior.

[formula]

The numbers below the grid designate where the rows end when n is congruent to 1, 4, 3, or 2, respectively. In the first three cases, the relationship between the top row and bottom row is not what we have observed is necessary for the last two columns, so the rows cannot end there. Hence in those congruence classes for n no 3-dynamic 4-coloring exists.

Thus we henceforth also assume [formula], with [formula].

In the upper left corner, x3,2 = x2,3, and similarly in the other corners. Furthermore, [formula].

The cycling of colors as observed in Lemma [\ref=ring] implies the first claim. We then observe that when m∈{3,5}, position (3,3) cannot see three colors.

Additional lemmas will restrict the coloring of the interior.

Every 3-by-2 or 2-by-3 subgrid has vertices of all four colors.

By symmetry, it suffices to consider a 2-by-3 subgrid. Suppose that some 2-by-3 subgrid contains at most three colors in a 3-dynamic 4-coloring of Gm,n. Since the 6-vertex subgraph is bipartite, a color appearing three times would give a vertex three neighbors with the same color, which is forbidden since each vertex has degree at most 4. Hence each of the three colors appears twice. By symmetry, we may assume that it appears as follows.

[formula]

Since border vertices have degree at most 3, such a subgrid cannot include a border vertex. Now the fourth color must appear above and below the middle, but it also must appear adjacent to each corner of the rectangle, which puts it on adjacent vertices.

We next prove another completely local implication.

If xi - 1,j = xi,j - 1 and xi,j  ≠  xi - 1,j + 1, then xi + 1,j = xi - 1,j + 1 and xi + 1,j + 1 = xi - 1,j (given i < m and j < n). The same implication holds with rows and columns exchanged.

By symmetry, we may assume a = xi - 1,j = xi,j - 1. Since (i,j) and (i - 1,j + 1) both see color a and are assumed to have different colors, by symmetry we may let b = xi - 1,j + 1 and d = xi,j, as shown below. Now xi,j + 1∉{a,b,d}, so xi,j + 1 = c, which in turn yields xi + 1,j = b.

[formula]

Now xi + 1,j + 1∈{a,d}. If xi + 1,j + 1 = d, then having (i,j + 1) and (i + 1,j) both see a requires xi + 2,j and xi,j + 2 to exist and equal a, but then (i + 1,j + 1) cannot see a.

Suppose that row r is periodic from columns s to t. If xr + 1,s = xr,s + 1 and xr + 1,s + 1 = xr,s + 2, then xr + 1,j = xr,j + 1 for s  ≤  j < t (similarly for columns). This situation cannot occur when r = 2 or s = 2, or for any r when xr + 1,t - 1  ≠  xr,t is known.

By symmetry, we may assume that this periodic portion in row r begins d,a,b,c. There is nothing to prove unless t  ≥  s + 3. In that case (shown below), xr,s  ≠  xr,s + 3. Lemma [\ref=2by3] then implies xr + 1,s + 2 = xr,s + 3. This establishes the same conditions for the next pair of columns. Continuing to apply Lemma [\ref=2by3] copies row r through column t into row r + 1, shifted by one column.

[formula]

Because (3,n) has only three neighbors, x3,n - 1  ≠  x2,n. Also row 2 is periodic up to t = n, as shown in Lemma [\ref=ring]. Hence the given fact that xr,t does not copy into position (r + 1,t - 1) (in row 2 or later) prevents row r + 1 from having two consecutive positions copied from the periodic portion of row r (shifted back by one position). The statement and proof are symmetric for columns.

A 4-coloring of Gm,n is coherent if the colors on the 4-by-4 grid in the upper left have the form of the matrix below (under any permutation of the four colors).

[formula]

Any 3-dynamic 4-coloring of Gm,n is coherent.

So far we have the pattern of the border positions and their neighbors, as indicated in Lemma [\ref=ring]. Applying Lemma [\ref=prop] to row 3 yields x3,3  ≠  b, and applying it to column 3 yields x3,3  ≠  c, so x3,3 = d. Now Lemma [\ref=zigzag] yields x4,3 = b and x4,4 = a, and then x3,4 = c.

[formula]

Proof of Theorem [\ref=main]

We have seen that the colors cycle in the first two rows and in the first two columns. Since the columns have odd length, the third and fourth columns cannot cycle all the way to the bottom. When the first row starts (a,b,c,d), such cycling would leave the bottom row starting (a,b,c,d) if [formula] or (b,a,d,c) if [formula]. This would contradict the patterns in Lemma [\ref=ring], which showed that these colors are (a,b,d,c) or (b,a,c,d), respectively. Hence cycling must stop somewhere in column 3 or 4.

Cycling also cannot continue all the way across rows 3 and 4. If it did, then we could delete rows 1 and 2 to obtain a 3-dynamic 4-coloring of Gm - 2,n, contradicting the minimality of m and thereby completing the proof.

We introduce definitions to facilitate study of where cycling of colors breaks down.

Given (i,j)∈[m]  ×  [n], define (p,q)∈[4]  ×  [4] by [formula] and [formula]. A position (i,j) is correct if xi,j = xp,q. For i > 4, positions (i,j) and (i + 1,j) are flipped if they are incorrect but xi,j = xp + 1,q and xi + 1,j = xp,q. Similarly, for j > 4, positions (i,j) and (i,j + 1) are flipped if xi,j = xp,q + 1 and xi,j + 1 = xp,q.

We observed at the beginning of this section that neither rows 3 and 4 nor columns 3 and 4 are completely correct. Hence there is a first column having an incorrect position in row 3 or 4, and there is a first row having an incorrect position in column 3 or 4. We next show that these first incorrect positions are in row 3 and column 3, respectively. Note that correctness requires x3,j = x2,j + 1 when j is even, but these positions have different colors when j is odd. We also show that the first violation of correctness leads to flipped positions.

Given [formula], suppose that row 2r is periodic through column t such that t > 2s and x2r + 1,t - 1  ≠  x2r,t. If rows 2r + 1 and 2r + 2 are correct through column 2s, then either they are both correct through column 2s + 2, or positions (2r + 2,2s + 1) and (2r + 2,2s + 2) are correct while positions (2r + 1,2s + 1) and (2r + 1,2s + 2) are flipped. The same statement holds with the roles of rows and columns switched.

Let the cycle of colors in row 2r have (a,b,c,d) ending at column 2s.

[formula]

Since (2r + 1,2s) is correct and t > 2s, we have x2r + 1,2s = x2r,2s + 1 = a and x2r,2s + 2 = b. By Lemma [\ref=prop], x2r + 1,2s + 1  ≠  b. Whether (2r + 1,2s + 1) is correct or not, Lemma [\ref=zigzag] now yields x2r + 2,2s + 1 = b and x2r + 2,2s + 2 = a, which makes (2r + 2,2s + 1) and (2r + 2,2s + 2) correct.

If x2r + 1,2s + 1 = d, then (2r + 1,2s + 2) sees {a,b,d}. Hence x2r + 1,2s + 2 = c, making (2r + 1,2s + 1) and (2r + 1,2s + 2) also correct.

Otherwise, x2r + 1,2s + 1 = c. Now (2r + 1,2s + 1) sees {a,b,c}, so x2r + 1,2s + 1 = d and positions (2r + 1,2s + 1) and (2r + 1,2s + 2) are flipped.

Applying Lemma [\ref=extend] with r = 1 yields a value s (with [formula]) such that row 3 is correct through column 2s with (3,2s + 1) and (3,2s + 2) flipped, and row 4 is correct through column 2s + 2. Applying the column version with s = 1 also yields a value r (with r  ≥  2) such that column 3 is correct through row 2r with (2r + 1,3) and (2r + 2,3) flipped, and column 4 is correct through row 2r + 2.

With respect to a coherent block in the upper left, an (r,s)-partial coloring of a grid is a vertex 4-coloring that flips positions (3,2s + 1) and (3,2s + 2) and flips positions (2r + 1,3) and (2r + 2,3), but is correct on all of the following: the first three rows through column 2s, row 4 through column 2s + 2, the first three columns through row 2r, and column 4 through row 2r + 2.

We remarked before Definition [\ref=dfpartial] that every 3-dynamic 4-coloring of Gm,n is an (r,s)-partial coloring for some (r,s). Hence our next lemma completes the proof of the theorem.

For [formula], an (r,s)-partial coloring of a grid cannot be completed to a 3-dynamic 4-coloring.

We use induction on r + s. For r = s = 2, we have the coloring shown below. It cannot be completed, because (5,4) requires x5,5 = c, but (4,5) requires x5,5 = b.

[formula]

Now suppose r + s > 4. Since (3,2s + 1) and (3,2s + 2) are flipped, x4,2s = x3,2s + 1. Since (4,2s + 1) and (4,2s + 2) are correct, x4,2s + 1  ≠  x3,2s + 2. Hence Lemma [\ref=zigzag] yields x5,2s + 1 = x3,2s + 2 and x5,2s + 2 = x3,2s + 1, which means that (5,2s + 1) and (5,2s + 2) are flipped. Similarly, (2r + 1,5) and (2r + 2,5) are flipped.

[formula]

In the matrix above, we have applied a permutation of the colors to illustrate the smaller instance of the problem to which we will apply the induction hypothesis. Assume these labels. If x5,5 = b, then Lemma [\ref=prop] applies in row 5 to contradict x5,2s + 1  ≠  x4,2s + 2. If x5,5 = c, then Lemma [\ref=prop] applies in column 5 to contradict x2r + 1,5  ≠  x2r + 2,4. Hence x5,5 = d. Now Lemma [\ref=zigzag] yields x6,5 = b, x6,6 = a, and x5,6 = c. Furthermore, the positions in {5,6}  ×  {5,6} are correct. (This argument also implies that r > 2 if and only if s > 2.)

We now build a smaller instance of the problem. Since positions (5,2s + 1) and (5,2s + 2) are flipped and x5,2s + 1  ≠  x4,2s + 2, Lemma [\ref=extend] implies that for some s' with s'  ≤  s, rows 5 and 6 are correct through column 2s', with positions (6,2s' + 1) and (6,2s' + 2) correct while (5,2s' + 1) and (5,2s' + 2) are flipped. The same discussion applies to columns 5 and 6, yielding r' with r'  ≤  r. Note that [formula].

Let M be the matrix obtained by deleting the first two rows and first two columns of the given coloring. Since the positions in {5,6}  ×  {5,6} are correct, M is coherent. Hence M is an (r' - 2,s' - 2)-partial coloring of a grid. By the induction hypothesis, it cannot be extended to a 3-dynamic 4-coloring. Since M extends to row m and column n of the original coloring, we conclude that the original coloring also does not extend to a 3-dynamic 4-coloring.