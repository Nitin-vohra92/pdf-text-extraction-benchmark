The Peano-Baker series

Introduction

Consider the inhomogeneous linear initial value (or Cauchy) problem

[formula]

on some interval [formula] that contains t0, with time-dependent quantities x, A and b. Here, A(t) denotes a family of matrices and b(t) a vector-valued function, both of dimension d over [formula] (or over [formula]). For simplicity, we assume A and b to be continuous on I. When = 0 for all t,s∈I (where we use the notation = AB  -  BA), the unique solution of [\eqref=Cauchy] is

[formula]

which simplifies to [formula] for the homogeneous case; see [\cite=KP]. Also, when A(t) = A is constant, one has [formula] as usual; we refer to [\cite=A] for a general exposition.

The solution of [\eqref=Cauchy] is still unique when ≠  0 for t  ≠  s, but the solution is then given by the Peano-Baker series (PBS); see [\cite=I], [\cite=FDC] or [\cite=B] for background. This approach goes back to Peano (1888; see [\cite=P]), and was further developed by Baker (1905; see [\cite=Baker]). Baker's paper also contains a more detailed account of the history of this approach. The PBS is well-known in principle, but not widely known, and appears mainly in engineering textbooks; compare [\cite=B] [\cite=K] [\cite=FH] for examples. Quite frequently, it is used in a purely formal manner (without convergence considerations), and it is also sometimes claimed [\cite=R] that it is of little practical use for the solution. However, as one can learn from the biographical sketches of Delone in [\cite=Del], one should neither discard analytical tools nor believe repeated claims without evidence. In fact, when new problems surface, many (old) tools turn out to be more useful than expected.

It is thus the purpose of this short note to summarise the elementary properties of the Peano-Baker series and to give a simple and self-contained account. In particular, we do not restrict ourselves to the abstract fundamental system (or matrix solution), but discuss its explicit series expansion with convergence. The need for it came up in the context of a problem in mathematical population genetics; see [\cite=US] for details. We add two little examples to demonstrate that it can be used explicitly as well.

Homogeneous case: Volterra equation and convergence

Let [formula] denote the fundamental system of the homogeneous part of [\eqref=Cauchy], which is also the flow of the linear system. It satisfies the Volterra integral equation

[formula]

By means of a formal Picard iteration, this leads to

[formula]

where

[formula]

For convenience, we set [formula]. By construction, we then have the recursion

[formula]

for [formula]. Clearly, [formula], in line with [formula]. Eq. [\eqref=PBS] is known as the Peano-Baker series (PBS) in control theory [\cite=FH], see also [\cite=Gant], or as the series expansion in the context of the time-ordered exponential in physics [\cite=Hoek]. The PBS was recently also extended to the setting of time scales [\cite=Dac].

Let us consider the individual terms of the PBS more closely.

When A is continuous on I, the matrix functions In are differentiable and satisfy [formula], for all t∈I and [formula].

By definition [\eqref=recursion], each matrix function In is (component-wise) continuous, and hence so is the product AIn for every n. Applying the fundamental theorem of calculus separately to each component of the matrix equation [\eqref=recursion] proves the lemma.

Let us show next (in modern terminology) that the PBS is nicely convergent in our finite-dimensional setting; compare [\cite=I] or [\cite=FDC] for a slighlty different account, [\cite=PDV] for further results in this direction, and [\cite=H] for background on matrix Taylor series. We begin by establishing a link to the usual exponential series. In the one-dimensional case, this is [\cite=B].

If A is continuous on the interval I, with = 0 for all t,s∈I, one has

[formula]

for all t∈I and [formula]. In particular, this applies when A is one-dimensional.

The claim is obviously true for n = 0 and n = 1. We can now employ induction via the recursion [\eqref=recursion], assuming the validity for some [formula]. This gives

[formula]

where the integrand on the right hand side can be rewritten as

[formula]

This step employs the general chain rule, where the assumed commutativity is used. Inserting this expression into the previous formula completes the induction step by an application of the fundamental theorem of calculus.

When = 0 on I, the PBS [\eqref=PBS] reduces to the well-known formula

[formula]

as a consequence of Lemma [\ref=dim-reduce]; see [\cite=KP] for a detailed exposition of this case. This reduction is also mentioned in most of the sources cited so far; compare [\cite=B].

A closer look at the proof of Lemma [\ref=dim-reduce] shows that the condition = 0 may be replaced by the slightly weaker assumption that, for all t∈I, the matrix A(t) commutes with the integral [formula].

Also, it should be mentioned that Lemma [\ref=dim-reduce] can alternatively be proved by direct calculations based on permutations of the integration variables followed by a suitable rearrangement to cover the integration region n. When combined with an induction argument, it suffices to consider the permutations [formula]. This approach is slightly more general. As it is also less transparent, we skip further details.

Let now [formula] denote any norm on [formula] (or on [formula]), and define the compatible matrix norm as usual by [formula]. This implies the relations [formula] and, more importantly, [formula].

If [formula] is locally integrable on the interval I, the series representation [\eqref=PBS] of [formula] is compactly convergent on I in the chosen matrix norm.

Let J  ⊂  I be compact, with t0∈J. We show that the sequence of partial sums is Cauchy on J. So, let [formula] with n  >  m and consider

[formula]

Since [formula], where all [formula] are non-negative real numbers, Lemma [\ref=dim-reduce] implies that the last sum is majorised by

[formula]

which is the corresponding Cauchy estimate for the Taylor series of the ordinary exponential function on [formula], evaluated at [formula], which exists for all t∈J by assumption. Since this series converges compactly, our claim follows.

Solution of the inhomogeneous problem

It is now obvious that [formula] solves the homogeneous initial value problem [\eqref=FUSY]. This follows from a term-wise application of Lemma [\ref=I-diffbar] to the PBS, which is fully justified by Theorem [\ref=PBS-converges]. The determinant of [formula], which is a Wronskian and thus satisfies Liouville's theorem, reads

[formula]

which never vanishes; see [\cite=A] or [\cite=KP] for details. This means that [formula] has full rank and thus indeed constitutes a fundamental system of the homogeneous linear system.

Since [formula] is the unique solution of [\eqref=FUSY], the flow property implies the relation

[formula]

which, due to [formula], also implies [formula]. With the usual 'variation of constants' calculation, compare [\cite=A], one can now easily derive the following result.

Let I be an interval, with [formula]. Suppose A is a continuous matrix function on I, and b is also continuous on I. Then, the Cauchy problem [\eqref=Cauchy] has the unique solution

[formula]

with [formula] given by the PBS [\eqref=PBS]. When = 0 for all t,s∈I, the formula simplifies to the explicit expression [\eqref=commuting-case] with ordinary exponentials.

Examples

Let us demonstrate the explicit applicability of the PBS with two simple examples. Both can also be solved by other means, but are perhaps still instructive.

Consider the matrix family [formula] with t∈I, [formula], and fixed parameter a. The matrices commute for a = 1, but not otherwise. One finds

[formula]

so that the PBS gives

[formula]

Note that f(t) simplifies to [formula] for a = 1, in line with the then simpler ODE system. For general t0, one determine [formula] from a similar calculation. The PBS differs both from the matrix exponential and from the Mathias formula for upper triangular matrices; compare [\cite=H].

As a second example, consider the ODE system

[formula]

which leads to the Airy function via the 2nd order ODE [formula]; see [\cite=AS] for details. With α: = a1 / 3, the PBS leads to the formula

[formula]

with

[formula]

from [\cite=AS]. Here, [formula] as usual; see [\cite=AS]. Note that

[formula]

in line with the trivially solvable system for a = 0.

Acknowledgements

It is a pleasure to thank Peter Jarvis for discussions, and Wolf-Jürgen Beyn and Nikolai Dolbilin for useful suggestions.