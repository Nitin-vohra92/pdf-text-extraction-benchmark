The Computational Challenge of Enumerating High-Dimensional Rook Walks

Introduction

Consider a rook placed on the lower left corner (0,0) of a chess board. On how many paths can the rook reach the upper right corner (n,n) if in a single step it may move an arbitrary number of fields upwards or to the right (but not downwards or to the left)? For rectangular chess boards of size n  ×  m, the number of paths is given by the coefficient an,m in the rational series expansion

[formula]

The case of square chess boards is consequently the diagonal series of this rational function, which happens to be

[formula]

From here, all sorts of information about the numbers an,n can be easily extracted by means of computer algebra, for instance the initial terms

[formula]

or recurrence equation

[formula]

or the asymptotic formula [formula] (n  →    ∞  ). Computer algebra can also find the algebraic representation of the diagonal series given the bivariate rational series as input, so there is altogether no need to do any calculation by hand.

At a marvelous meeting at Nankai University in August 2010 on the occasion of the second author's 60th birthday, Frédéric Chyzak reported that he and his colleagues had succeeded in doing the analogous computation for 3D [\cite=bostan10a], i.e., they determined the number of paths a rook can take on a 3D chessboard from (0,0,0) to (n,n,n) moving in each step an arbitrary positive integer distance into one of the three directions, i.e., moving either by (i,0,0) or by (0,i,0) or by (0,0,i) for some positive integer i. Denoting now the number of this kind of walks by an, they found the initial terms

[formula]

the recurrence equation and the asymptotic formula [formula] (n  →    ∞  ), all fully rigorous, including so-called certificates which allow for an independent formal verification of the obtained results. While it is clear in theory that computer algebra is able to obtain this information, it is remarkable that it is possible to actually carry out these calculations in practice, because the 3D case requires far more computational power than the 2D case.

If we don't insist on a fully rigorous formal verification, the diagonal recurrence can be obtained with much less effort: it suffices to compute some 25 terms of the sequence and use automated guessing to find a recurrence which matches them. See [\cite=bostan09] [\cite=rubey07] for recent developments of this technique and the references given there for classical versions. For the present paper we applied this technique to empirically find recurrence equations for rook paths in dimensions greater than three, and we pose it as a challenge to provide rigorous certificates for them. While at least for the very high dimensions this seems totally hopeless for now, we do expect that the coming years (or decades?) will see not only faster and bigger computers but also more advanced algorithms which can certify our claims within a reasonable amount of computing time. At least we intend to encourage progress in this direction. We see no other reason to ask for a certification. The question cannot be whether our claims are correct--the empirical evidence is way too strong to leave any reasonable doubt about that. Nor can the question be whether there actually exist certificates for our claims--it is clear by theory that recurrences of diagonal sequences of multivariate rational series can always be certified. Nor can the question be whether a proof may provide some insight or understanding--certificates are usually just messy polynomials. The interesting questions instead are: how big are the certificates, what is the computational cost for constructing them, and who will be the first to get the computation done.

An Alternative Route for Turning our Semi-rigorous proofs to Full-Fledged Rigorous Proofs

We know a priori that there is a recurrence, this follows from general holonomic nonsense. But by the work of Moa Apagodu and Zeilberger [\cite=az06] one can derive a priori upper bounds for the promised recurrences. The recurrences for d-dimensional rook walks turn out (empirically) to have order d (for 2  ≤  d  ≤  12). It is very possible that it won't be too hard to prove this sharp upper bound in general, or even a weaker--but still realistic--one. This may enable one to give a "soft" proof that the empirically "guessed" recurrences are indeed rigorously proved.

If one would be able to find (realistic!) a priori bounds for the degrees of the coefficients as well, then by plain linear algebra the "guessed" recurrences would be rigorously proved.

A short interlude: Why is this problem So important?

The harsh and/or sceptical critic may say: Who cares? Not that many people (or machines) play 12-dimensional chess, and even the vast majority of the many people that do play traditional 2D, 8  ×  8 chess, couldn't care less about the number of ways a rook can walk.

But everyone owes money, and usually to many creditors! The number of ways a rook can walk, in the d-dimensional cubic lattice, from the origin to

[formula]

Fast Computation of Sufficiently Many Sequence Terms

As the dimension increases, so does the order of the diagonal recurrence and the degree of the polynomials appearing in it. The larger a recurrence is in terms of order and degree, the more sequence terms are needed to recover it from sequence data. For instance, in dimension d = 12, we needed 1600 diagonal terms in order to find the recurrence. To modern guessing software (we used code written by the first author [\cite=kauers09a]), this is still a moderate problem size. Much harder than guessing the recurrence is the computation of sufficiently many terms on the diagonals, which are needed as input for the guesser. The naive way is to start from the rational function

[formula]

Its denominator [formula] gives rise to a multivariate linear recurrence with constant coefficients, which can be used to compute the [formula] recursively. For example, for d = 2, the rational function

[formula]

implies the recurrence

[formula]

Together with suitable boundary conditions, this allows the computation of an,m for arbitrary n,m, and hence for an,n for arbitrary n.

But this is very costly. In dimension d, in order to compute the nth diagonal term, the recurrence forces us to compute all terms [formula] with [formula], altogether more than nd terms. If n = 1000, a computer won't mind doing this for d = 2, but for d = 3 it is already getting painful, and for d > 3 either the memory requirements will exceed the computer's capacity or the runtime will exceed the user's patience. Or both. For [formula] the naive method will not even suffice for computing the first n = 10 diagonal terms within a reasonable amount of time.

Fortunately, there are more efficient recurrence equations. For arbitrary dimension d, we have Note that any application of this recurrence leaves the indices [formula] fixed, increases nd - 1 and decreases nd. This special form breaks the exponential complexity. It can be shown that computing the first n diagonal terms via this recurrence requires only [formula] operations. For [formula], this method was efficient enough to produce enough terms to obtain the recurrence for the diagonal.

For [formula], an additional improvement was needed. Here instead of directly computing the terms on the main diagonal, we first used the previous method for computing the terms of the bivariate auxiliary sequence

[formula]

up to [formula] or so. Then we used a multivariate guesser to discover some bivariate recurrences in n and m for bn,m and used these to compute the diagonal terms [formula] for n as far as needed.

Recurrence Equations

Most of the recurrences we found are too big to be reproduced here. We make them available online at

|http://www.risc.jku.at/people/mkauers/walks/|.

Here we only give a table with some statistics on their order, the maximal degree of their polynomial coefficients, and the length of the longest integer appearing in them, measured in decimal digits (dd).

Queens

We have also computed recurrences for the analogous problem of Queen walks, but so far we were only able to go up to dimension 5. The relevant output can be found in the above-mentioned webpage.

Higher Order Asymptotics

The leading-term asymptotics for diagonals of rook walks has been derived by Martin Erickson, Suren Fernando, and Khang Tran [\cite=eft10] using the powerful analytical method of Robin Pemantle and Mark C. Wilson [\cite=pw04]. It turns out to be:

[formula]

where αd is given by:

[formula]

This result matches well with the numbers produced by the recurrences we discovered. For instance, for d = 12 and n = 500000 we find

[formula]

And this not all. Thanks to the Maple package AsyRec available from

|http://www.math.rutgers.edu/ zeilberg/tokhniot/AsyRec|

(see [\cite=z08]) one can get, very easily, from the recurrences, higher-order asymptotics, using the Birkhoff-Trjitznisky method.

The order-10 asymptotic formulas for the sequences for 2  ≤  d  ≤  9 can be gotten from

|http://www.math.rutgers.edu/ zeilberg/tokhniot/oRookAsymptotics|

that is based on the input file

|http://www.math.rutgers.edu/ zeilberg/tokhniot/inRookAsymptotics|

that uses AsyRec and of course, the recurrences obtained by the first-named author's computer.

A cross check with d = 12 and n = 500000 now yields the very convincing quotient where the [formula] symbol suppresses some explicit rational numbers which are too lengthy to be reproduced here but which can be also found on the website above.

And this is still not all. By looking at the output of AsyRec for the sequences for specific d, it appears that we have the more refined asymptotic expression for the number of rook-walks from

[formula]

for fixed, but arbitrary (symbolic!) d

We leave the rigorous proof of this as another challenge to the reader.

Fixed n, variable dimension

Let wn(d) be the number of ways a rook can positively walk from

[formula]

. So far, we fixed d and let n vary. But what if we fix n and let d vary? Of course [formula] and w1(d) = d!, Sloane's A000142. The sequence w2(d) is of more recent vintage, it is Bob Proctor's sequence A105749. But a search on Nov. 19, 2010, did not find w3(d) in Sloane, or elsewhere.

The Maple package RookWalks available from

|http://www.math.rutgers.edu/ zeilberg/tokhniot/RookWalks|

handles these sequences, and the webpage

|http://www.math.rutgers.edu/ zeilberg/tokhniot/oRookWalks|

lists the first 150 terms of wn(d) for 1  ≤  n  ≤  4, as well as guessed recurrences and implied asymptotics. The asymptotic formulas for the individual n (for 1  ≤  n  ≤  4) lead one to conjecture that the leading asymptotics for wn(d) as d  →    ∞   is

[formula]

We leave the rigorous proof of this as yet another challenge to the reader.