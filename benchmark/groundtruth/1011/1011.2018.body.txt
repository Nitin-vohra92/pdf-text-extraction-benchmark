Proof of .

Piecewise linear Hamiltonian flows associated to zero-sum games: transition combinatorics and questions on ergodicity

Keywords: Hamiltonian systems, non-smooth dynamics, Filippov systems, piecewise affine, Arnol'd diffusion, fictitious play, best-response dynamics, learning process 2000 MSC: 37J, 37N40, 37G, 34A36, 34A60, 91A20.

Introduction

Traditionally, the motivation for studying Hamiltonian systems comes either from classical mechanics or from partial differential equations. In this paper we study a particular class of Hamiltonian systems which are motivated in a completely different way: they arise from dynamical systems associated to game theory. This class of Hamiltonian systems was proposed in [\cite=VanStrien2009a] and corresponds to Hamiltonians which are piecewise affine. In this paper we study several properties of such dynamical systems.

For general smooth functions [formula] for which H- 1(1) is (topologically) a 2n - 1 sphere, very little is known about the global dynamics of the corresponding Hamiltonian vector field, even if we make convexity assumptions on the level sets. If H is a quadratic function, the system is completely integrable and the flow is extremely simple. So instead, in this paper we consider Hamiltonians H which are piecewise affine and investigate whether the following analogy holds:

This analogy would suggest that one might gain insight about smooth Hamiltonian systems by looking at piecewise affine ones, in the same way as circle diffeomorphisms can be modelled by circle rotations. Much of the complexity of the dynamics may well persist in the piecewise affine case, and even though these systems are not smooth they still may be easier to study.

This paper consists of two parts. In the first part we prove a classification theorem for the case when n = 2 which goes towards a description of the global dynamics in terms of coding, while in the second part we give numerical results which show that much richness of the dynamics in the smooth case persists.

Let us be more precise. We say that [formula] is a piecewise affine function if

(i) H is continuous and

(ii) there exists a finite number of hyper-planes [formula] in [formula] so that H is affine on each component of [formula].

Since H is piecewise affine, [formula] are piecewise constant outside the hyper-planes Zi and there the derivatives are multivalued. Consider the Hamiltonian system

[formula]

or more generally the Hamiltonian vector field XH associated to H and the symplectic 2-form [formula] (where (ωij) are the (real) coefficients of some constant non-singular n  ×  n matrix Ω) and the corresponding differential inclusion

[formula]

(Here XH is defined by requiring that ω(XH,Y) = dH(Y) for each vector field Y.) In other words,

[formula]

where Ω' stands for the transpose of the matrix Ω. The reason we write ∈ rather than =   in the above equations is because [formula] are multivalued. In this generality, there is no reason to assume that the flow of these differential inclusions is continuous.

Instead we will consider the special case of [formula] defined by

[formula]

where p' stands for the transpose of p, (  M  q)i and (p'  M  )j stand for the i-th and j-th component of the vectors   M  q respectively p'  M   and Σ consists of the set of probability vectors in [formula]. Here we consider the corresponding Hamiltonian system defined on the space Σ  ×  Σ. To ensure that level sets are simple, we make the following assumption on   M  : there exist [formula] so that all its components are strictly positive and so that [formula] and [formula] for some [formula] where [formula]. A motivation for this assumption and an interpretation of [formula] is given in the paragraph above equation ([\ref=eq:pi_proj]). As was shown in [\cite=VanStrien2009a], one then has the following properties:

For an open set of full Lebesgue measure of n  ×  n matrices   M  , each level set H- 1(ϱ), ϱ > 0 is topologically a (2n - 3)-dimensional sphere and [formula] (note that dim (Σ  ×  Σ) = 2n - 2). In fact, H- 1(ϱ) bounds a convex ball.

For an open set of full Lebesgue measure of n  ×  n matrices Ω and   M  , there exists a unique solution of ([\ref=eq0]) for all initial conditions and the corresponding flow (p,q,t)  ↦  φt(p,q) is continuous, which is not generally true for differential inclusions.

The flow (p,q,t)  ↦  φt(p,q) is piecewise a translation flow, and first return maps to hyperplanes in H- 1(ϱ) are piecewise affine maps.

In the second part of this paper we will present some numerical studies of examples of such systems when n = 3, i.e., when each energy level H- 1(ϱ), ϱ > 0, is topologically a three-sphere. Let us single out one of these examples: there exists an open set of 3  ×  3 matrices   M   and Ω with the following property. For each ϱ > 0 there exists a topological disc D  ⊂  H- 1(ϱ) which is made up of 4 triangles in Σ  ×  Σ so that

the first return map R to D is continuous and extends continuously to the closure of D;

R|∂D = id (in fact ∂D corresponds to a periodic orbit of the flow, whose Floquet multipliers are undefined);

R:D  →  D is area-preserving and piecewise affine;

each orbit in H- 1(ϱ) intersects D infinitely often.

Moreover, R:D  →  D contains hyperbolic horseshoes and also an elliptic periodic orbit, surrounded by an elliptical disk consisting of quasi-periodic orbits on invariant ellipses, see [\cite=VanStrien2009a] [\cite=VanStrien2009b]. Numerical simulations for these systems suggest that all orbits outside this elliptical disk in D are dense in this set, see Example 2 in Part 2 of this paper. This first return map could be a piecewise affine model for general smooth area preserving maps of the disk.

As mentioned, one motivation for looking at Hamiltonians as in ([\ref=defH]) and the corresponding systems ([\ref=eq0]) comes from game theory. Indeed, these correspond to certain differential inclusions which are naturally associated to so-called zero-sum games in game theory. For this, let A,B be n  ×  n matrices and define [formula] and [formula] and consider the differential inclusion:

[formula]

The zeros of this equation, i.e. the set of points [formula] for which [formula], are called Nash equilibria. The differential inclusion ([\ref=eqBR]) is called the Best Response Dynamics and the corresponding time-rescaled the Fictitious Play Dynamics associated to the game with matrices A and B. In game theory and economics these are often used to model learning, i.e. to describe how people learn to play a game. It turns out that in the case of zero-sum games, i.e. when A =  - B, all orbits of ([\ref=eqBR]) converge to the set of Nash equilibria, see [\cite=Robinson1951] and for a short proof see [\cite=Hofbauer1995].

Note that if we define   M  : = A =  - B then the existence of [formula] for which all coordinates are strictly positive and for which [formula] and [formula] (as assumed just below ([\ref=defH])) implies that [formula] and [formula]. So such a point [formula] is a Nash equilibrium. To see this, notice that [formula] is the convex hull of all the unit vectors corresponding to the largest component(s) of [formula]. So if all components of [formula] are strictly positive, then [formula] holds iff all coordinates of [formula] are equal.

We should note that p and q have a different connotation here from the usual one in classical mechanics: p corresponds to the position (the probablity vector describing past play) of the first player and q the corresponding object for the second player. Although the equation ([\ref=eqBR]) itself is not Hamiltonian at all, it is closely related to the Hamiltonian system ([\ref=eq0]). Indeed, for [formula], let l(p,q) be the half-line from [formula] containing (p,q) and define

[formula]

where π(p,q)∈H- 1(1) is the intersection of l(p,q) with the 2n - 3-dimensional sphere H- 1(1). It turns out that the projection of the flow on H- 1(1) corresponds to the solution of a Hamiltonian system as above. In other words, the Hamiltonian dynamics describes the spherical coordinates. So we will think of the dynamics of ([\ref=eqBR]) as inducing Hamiltonian dynamics. For more details see Section [\ref=sec:ham_br_dynamics].

In this paper we will study Hamiltonian dynamics coming from Best Response dynamics as in ([\ref=eqBR]) in the case where n = 3. The aim of this paper is the following:

Because of the special nature of the Hamiltonian systems we consider in this paper, one can associate in a natural way itineraries to each orbit. In the Main Theorem of this paper we will show that not all itineraries are possible and we will give a full classification of all possible transition diagrams.

The Hamiltonian dynamics appearing in this paper is much simpler than usual: the first return maps to planes are piecewise translations. In the second part of this paper we will show numerical simulations concerning a number of examples of such systems. The four examples which we show here, display (conjecturally):

fully ergodic behaviour;

elliptic behaviour of a very simple type (which we can prove rigorously, see [\cite=VanStrien2009a]);

elliptic behaviour of a composite type;

Arnol'd diffusion, and intertwining of various elliptic regions.

We believe that the elliptic behaviour occuring in our systems satisfies a huge amount of regularity, and we will formulate several questions and conjectures formalizing this.

In the first part of the paper we introduce the Best Response and Fictitious Play Dynamics inducing a special case of the Hamiltonian Dynamics presented above. We introduce a combinatorial description of the BR dynamics and provide a combinatorial characterisation of the dynamics for zero-sum games for n  =  3 (inducing Hamiltonian dynamics with two degrees of freedom).

Hamiltonian and Best Response Dynamics

We define ΣA to be the simplex of probability row vectors in [formula] and ΣB the simplex of probability column vectors in [formula]:

[formula]

We denote Σ  =  ΣA  ×  ΣB.

We consider a bimatrix (A,B), where [formula]. With a slight abuse of notation we identify the standard unit vector ek with the integer k and define the following correspondences:

[formula]

These correspondences are singlevalued almost everywhere, except on a finite number of hyperplanes. On these hyperplanes (also called indifference planes) at least one of the B R  correspondences has as its values the set of convex combinations of two (ore more) unit vectors.

We can now define the Fictitious Play Dynamics as a continuous time dynamical system in Σ:

[formula]

for t  >  1 and some given initial value (p(1),q(1))∈Σ. Note that the right hand side is singlevalued almost everywhere.

Although ([\ref=eq:fp_dynamics]) is more common in game theory, where it serves as a model of myopic learning, we prefer to consider the following time reparametrisation, referred to as the Best Response Dynamics:

[formula]

The orbits of both systems coincide (differing only in time parametrisation) but ([\ref=eq:br_dynamics]) has the advantage of being autonomous. The existence of solutions for any initial conditions follows from upper semicontinuity of B R A and B R B, see [\cite=Aubin1984].

The classical learning processes ([\ref=eq:fp_dynamics]) and ([\ref=eq:br_dynamics]) are naturally related to Hamiltonian Dynamics via the following construction. Let [formula] be defined as

[formula]

Further let Ω  =  (ωij) be some non-singular n  ×  n matrix. Consider a Hamiltonian vector field XH associated to H and the symplectic 2-form [formula]. The corresponding differential inclusion is

[formula]

Let us denote [formula], and let Ω',A' be the transpose of the matrices Ω and A. Further let [formula] be the parallel projections to TΣA and TΣB along the vectors Ω'- 1 and Ω- 1 respectively (where [formula]). Then a simple calculation (see [\cite=VanStrien2009a]) shows that the above inclusion ([\ref=eq3]) takes the form

[formula]

The projections PA,PB appear in these equations because H is considered as a function on Σ  =  ΣA  ×  ΣB and so the dynamics is constrained to this affine subspace. The Hamiltonian differential inclusion ([\ref=eq:ham_eq]) is closely related to the BR dynamics if we take Ω = A. In this case the dynamics defined on H- 1(1) by ([\ref=eq:ham_eq]) equals the BR-dynamics projected via π (defined in equation ([\ref=eq:pi_proj])) to this level set of H (for details see [\cite=VanStrien2009a]). In other words, if we compute an orbit under the BR-dynamics then the image under π of this orbit is an orbit under the Hamiltonian dynamics ([\ref=eq:ham_eq]).

For this reason, for the rest of this paper we will assume Ω  =  A, where [formula] is non-singular.

For later use, let us make some simple observations. ΣB can be divided into n convex regions RAi  =  B R - 1A(ei), where [formula] and analogously RBj  =  B R - 1B(ej)  ⊂  ΣA, [formula].

Since B R A  ×  B R B is constant on Rij  =  RBj  ×  RAi, ([\ref=eq:fp_dynamics]) and ([\ref=eq:br_dynamics]) have continuous orbits which are piecewise straight lines heading for vertices (ek,el)∈Σ whenever (p(t),q(t))∈Rkl. The orbits only change direction at a finite number of hyperplanes, namely whenever B R A or B R B (or both) become multivalued. More precisely, p(t) changes direction whenever q(t) passes from RAi to RAi' for some i  ≠  i', and vice versa. See Fig.[\ref=fig:fp_example] for an example with n  =  3.

Combinatorial Description for the Case n  =  3

In this section and later on we restrict our attention to the case of dimension n  =  3. The partition of Σ into the convex blocks Rij quite naturally gives rise to coding of orbits of ([\ref=eq:br_dynamics]) and ([\ref=eq:fp_dynamics]). We codify an orbit (p(t),q(t)) by a (finite or infinite, one-sided) itinerary [formula] indicating that there exists a sequence of times (tk), such that (p(t),q(t))∈Rik,jk for tk  <  t  <  tk + 1. To simplify notation we will often write (i,j) instead of Rij.

Abstractly we have a graph of nine vertices (i,j), ~ i,j = 1,2,3 with directed edges between them (see Fig.[\ref=fig:markov]).

It is not difficult to see that for an orbit of BR dynamics for a fixed bimatrix (A,B), such itinerary can then contain (i,j)  →  (i',j'), i  ≠  i' (or j  ≠  j') if and only if ai'j  ≥  aij (bij'  ≥  bij). Note that for almost all initial conditions in the corresponding orbits p and q never switch directions simultaneously, i.e. the itinerary only contains transitions of the form (i,j)  →  (i',j) and (i,j)  →  (i,j'), i  ≠  i', j  ≠  j' (see [\cite=Sparrow2007]).

Further we want to make sure that for any i  ≠  i' (j  ≠  j') there is only one possible transition direction between (i,j) and (i',j) ((i,j) and (i,j')). Therefore we introduce the following non-degeneracy assumption on the bimatrix (A,B):

Clearly the set of bimatrices satisfying this assumption is open dense with full Lebesgue measure in the space of bimatrices.

The possible transitions can be expressed in a transition diagram as in Fig.[\ref=fig:diag_intro](a). The three rows and three columns of the diagram represent the regions RAi, ~ i = 1,2,3 and RBj, ~ j = 1,2,3, respectively. The arrows indicate the possible transitions between the regions, which by Assumption [\ref=as:non_deg] always have a unique direction. For example, the itinerary of an orbit of the BR dynamics for a given bimatrix can contain (1,2)  →  (1,3) if and only if in the first row of its transition diagram an arrow points from the second into the third column. Opposite sides of the diagram should be thought of as identified, so that possible transitions between the first and third rows and columns are indicated by arrows on the boundary of the diagram. It is important to note that this partition does not have the nice properties of a Markov partition: there is no claim that every itinerary that can be obtained from the transition diagram can actually be realised by an orbit of the BR dynamics.

One may now ask whether a given transition diagram is realisable as the transition diagram of BR dynamics for a bimatrix game (A,B), and how properties of a game relate to the combinatorial information given by its transition diagram.

A simple first observation is that no row of a transition diagram can have three horizonal arrows pointing in the same direction, as this would imply ai,j  >  ai,j'  >  ai,j''  >  ai,j. Analogously no column of such diagram can have three vertical arrows pointing in the same direction.

It is easy to see that apart from this restriction, any transition diagram can be realised by appropriate choice of (A,B). However, our interest lies in bimatrix games whose BR dynamics displays 'non-trivial' behaviour. For this we introduce the following assumption:

Zero-Sum Games

In game theory, an important class of (bimatrix) games are the zero-sum games, i.e. games (A,B), such that A + B  =  0. However, our analysis remains valid for a larger class, namely games that are linearly equivalent to a zero-sum game.

Two 3  ×  3 bimatrix games (A,B) and (C,D) are linearly equivalent, if there exist e > 0,fj,j = 1,2,3 and g > 0,hi,i  =  1,2,3 such that

It can be checked that for linearly equivalent bimatrix games (A,B) and (C,D), the respective best-response correspondences coincide: B R A  =  B R C and B R B  =  B R D. From the definitions it immediately follows that linearly equivalent bimatrix games induce the same dynamics ([\ref=eq:fp_dynamics]) and ([\ref=eq:br_dynamics]). Since our main focus lies on these dynamical processes, in the rest of this text we call a game (A,B) zero-sum, if there exists a linearly equivalent game (C,D), such that C + D  =  0.

A point [formula] is called Nash Equilibrium if [formula] and [formula].

By the definition, Nash Equilibria are precisely the fixed points of ([\ref=eq:fp_dynamics]) and ([\ref=eq:br_dynamics]). It has been proved by John Nash, that every game with finitely many players and strategies has got a Nash Equilibrium (see [\cite=NashJohnForbes1951]). A very important classical result is the following:

For a zero-sum game, every orbit of the ([\ref=eq:br_dynamics]) and ([\ref=eq:fp_dynamics]) converges to the set of Nash Equilibria.

A short proof using an explicitly given Lyapunov function can be found in [\cite=Hofbauer1995]. In the same paper, Hofbauer states the converse conjecture, which still remains open:

A bimatrix game with a unique Nash Equilibrium point in [formula] that is stable under the BR (or FP) dynamics must be a zero-sum game.

As the above indicates, zero-sum games are of great interest in the study of BR and FP dynamics. A natural question to ask is now, which combinatorial configurations (transition diagrams) can be realised by zero-sum games. In this paper we will restrict our attention to zero-sum games with a unique Nash Equilibrium in the interior of Σ:

For every bimatrix game (A,B), Assumption [\ref=as:int_ne] implies Assumption [\ref=as:dom_strat].

If Assumption [\ref=as:dom_strat] does not hold, there is a row (column) in the transition diagram for (A,B) which is dominated by another row (column), say i dominated by i'. It follows that RAi (RBi) is empty.

On the other hand, Assumption [\ref=as:int_ne] implies that for all k,l, Rkl  =  RBl  ×  RAk has non-empty intersection with every neighbourhood of the Nash Equilibrium.

For later use, we make the following definitions:

A sequence [formula] is called alternating cycle for (A,B), if after reversing either all downward and upward pointing or all right and left pointing arrows in the transition diagram of (A,B), it forms a directed loop. Examples of alternating cycles are shown in Fig.[\ref=fig:diag_intro](d) and (e). More formally, either

(ik,jk)  →  (ik + 1,jk + 1) whenever ik  ≠  ik + 1 and (ik + 1,jk + 1)  →  (ik,jk) whenever jk  ≠  jk + 1, or

(ik + 1,jk + 1)  →  (ik,jk) whenever ik  ≠  ik + 1 and (ik,jk)  →  (ik + 1,jk + 1) whenever jk  ≠  jk + 1.

We call (i,j) a sink, if it can be entered but not left by trajectories of the BR dynamics (i.e. (i',j)  →  (i,j) and (i,j')  →  (i,j) for i'  ≠  i and j'  ≠  j). Conversely we call it a source, if it can be left but not entered.

We can now formulate several consequences for the transition diagram of a zero-sum game (A,B):

Let (A,B) be zero-sum and satisfy Assumptions [\ref=as:non_deg] and [\ref=as:int_ne]. Then:

The transition diagram does not have alternating cycles.

The transition diagram does not have sinks.

The transition diagram does not have sources.

One can see that in (1) without loss of generality we can only consider cycles in which the i- and j-component change alternatingly, which justifies the notion of alternating cycle. In fact in 3  ×  3 games (1) reduces to saying that there are no alternating cycles of the two kinds depicted in Fig.[\ref=fig:diag_intro](d) and (e).

For statement (1) assume that A + B  =  0 (otherwise choose linearly equivalent matrices such that this holds and note that this does not change the arrows in the transition diagram). Now note first that (i,j)  →  (i',j) iff ai'j  >  aij. Further, (i,j)  →  (i,j') iff bij'  >  bij, which is equivalent to aij  >  aij'. It follows that an alternating cycle leads to a chain of inequalities [formula] and therefore cannot exist.

To prove statement (2), we use Theorem [\ref=thm:zs_conv]. It follows from this theorem and Assumption [\ref=as:int_ne] that orbits of ([\ref=eq:br_dynamics]) converge to a single isolated point in the interior of Σ. A sink in the transition diagram however would imply that orbits of ([\ref=eq:br_dynamics]) that start in Rij (for some i,j) stay in it for all times. Since orbits do not change direction while in Rij, this can only be the case if they converge (in straight line segments) towards a vertex on ∂Σ.

At last, to show statement (3) of the lemma let us assume for a contradiction that such a zero-sum game satisfying the assumptions and with a source in its transition diagram exists. After possibly permuting rows and columns and swapping the roles of the two players we can assume that the source is (2,2) and we have the (incomplete) diagram as seen in Fig.[\ref=fig:diag_source](a). Let us now consider all four possible cases for the vertical arrows in (2,3):

Case 1: (2,3)  →  (i,3), ~ i = 1,2, i.e. both arrows pointing out of (2,3): Either row 2 dominates row 1 or 3, or (2,1) is a sink, see Fig.[\ref=fig:diag_source](b).

Case 2: (i,3)  →  (2,3), ~ i = 1,2, i.e. both arrows pointing into (2,3): Either column 2 dominates column 3 or there is an alternating cycle, see Fig.[\ref=fig:diag_source](c).

Case 3: (3,3)  →  (2,3), (2,3)  →  (1,3), both arrows point upward (Fig.[\ref=fig:diag_source](d)): In order to avoid an alternating cycle and a dominated column, one necessarily has (3,2)  →  (3,3) and (1,3)  →  (1,2). Further, since row 2 may not dominate row 1 and alternating cycles cannot happen in a zero-sum game, one gets (1,1)  →  (2,1) and (1,2)  →  (1,1), also (2,1)  →  (3,1) is necessary to avoid a source in (2,1), see Fig.[\ref=fig:diag_source](e). With some further deductions of the same kind one can show that the only possible transition diagram is the one shown in Fig.[\ref=fig:diag_source](f). We can now deduce that ΣA and ΣB are partitioned into the regions RAi and RBj as shown in Fig.[\ref=fig:diag_source2]. Consider the point on ∂Σ denoted by (N,M) and note that B R A(M) cotains e2 and e3, hence all their convex combinations. Therefore N∈B R A(M). Analogously, M∈B R B(N). Therefore (N,M) is a Nash Equilibrium contradicting our assumption that the interior Nash Equilibrium is unique.

(In fact it also follows from this configuration that there exist initial conditions arbitrarily close to the interior Nash Equilibrium whose trajectories spiral off towards (N,M) and therefore the interior Nash Equilibrium cannot be stable for the dynamics.)

Case 4: (1,3)  →  (2,3) and (2,3)  →  (3,3), i.e. both arrows point downward: This case is analogous to the previous one.

To conclude, we have shown that a source in the diagram contradicts our assumption of a zero-sum game with unique interior Nash Equilibrium, which finishes the proof of statement (3).

Main Result

The next hope is of course to get a full characterization of all combinatorial configurations that can be realised by zero-sum games. This indeed can be done after defining a suitable notion of combinatorially equivalent games.

We call two bimatrix games (A,B) and (C,D) combinatorially identical, if they induce the same transition relation, i.e. (i,j)  →  (i',j') for (A,B) iff (i,j)  →  (i',j') for (C,D).

We call two bimatrix games (A,B) and (C,D) combinatorially equivalent, if there exist permutation matrices P,Q such that (A,B) and (PCQ,PDQ) are combinatorially identical or (B',A') and (PCQ,PDQ) are combinatorially identical.

The definition expresses the idea, that games are combinatorially equivalent if they have the same transition diagram up to permutation of rows and columns and transposition. The main result is the following:

The types of transition diagram (combinatorial equivalence classes) that can be realised by a zero-sum game satisfying Assumptions [\ref=as:non_deg] and [\ref=as:int_ne] are precisely all those that satisfy the following (combinatorial) conditions:

No row of the diagram has three horizonal arrows pointing in the same direction and no column has three vertical arrows pointing in the same direction.

No three horizontal arrows between two columns point in the same direction and no three vertical arrows between two rows point in the same direction.

The diagram has no sinks.

The diagram has no sources.

The diagram has no alternating cycles.

This gives precisely 23 different types of transition diagrams (up to combinatorial equivalence). These are listed in Appendix [\ref=ap:types].

Throughout the proof of the theorem we will make use of the following notion:

We call an oriented loop of length four (formed by the arrows in the diagram) a short loop, see Fig.[\ref=fig:main_proof](a). A short loop always has the form (i,j)  →  (i',j)  →  (i',j')  →  (i,j')  →  (i,j) and we indicate the vertex in the diagram encircled by such loop by a [formula].

By the above discussion we know that (1) is true for any transition diagram of a game and (2) corresponds to Assumption [\ref=as:dom_strat] (which is implied by Assumption [\ref=as:int_ne]), so the only conditions that are left to check are (3)-(5). By Lemma [\ref=lem:zs_impl], we already know that (3)-(5) are necessary conditions for a diagram to be realisable by a zero-sum game.

To show that (1)-(5) are also sufficient, we will proceed in two steps: we will show that combinatorially these conditions give rise to precisely 23 types of diagrams (up to permutation of rows and columns and transposition) and then we will give examples of zero-sum games realising these types. Because of the initially large number of possible transition diagrams, we will group them by the number of short loops contained in them.

Let us introduce the notion of rows (or columns) coinciding or differing at a position. Two rows, say i and i', coincide at a position, say between columns j and j', if (i,j)  →  (i,j') if and only if (i',j)  →  (i',j'), and they differ at this position otherwise. E.g. in Fig.[\ref=fig:main_proof](b) rows 1 and 2 coincide at all positions, whereas in Fig.[\ref=fig:main_proof](c) they coincide at one and differ at two positions.

We now introduce a few very helpful lemmas about the transition diagrams of zero-sum games satisfying our assumptions:

Two columns (or rows) can have at most two short loops between them.

If two rows (columns) differ at two positions, then there is a short loop between these rows (columns).

If two rows (columns) differ at all three positions, then there are precisely two short loops between them.

If two rows (columns) coincide at two positions, then there is a short loop between each of these rows (columns) and the third row (column). In particular the diagram has at least two short loop.

If two rows (columns) coincide at all three positions, then there are precisely two short loops between each of these rows (columns) and the third row (column). Then the diagram has precisely four short loops.

For (1), note that every 2  ×  2 block obtained by deleting one row and one column from a transition diagram has got either two arrows pointing in the same direction or contains and alternating cycle or a short loop. Assume that two rows (columns) differ at two positions (Fig.[\ref=fig:main_proof](c)). Since we don't allow alternating cycles, the only way a short loop between the two rows (columns) can be avoided is by having all arrows between them pointing in the same direction (Fig.[\ref=fig:main_proof](d)). But this case is ruled out by hypothesis (2) of the theorem. Hence there is a short loop between them.

Essentially the same argument shows that statement (2) of the lemma holds.

If two rows (columns) coincide at two positions, then since no column (row) is allowed to be dominated, each of these rows differs at two positions from the third row (column). Statement (3) then follows from statement (1).

The same argument proves statement (4). The fact that the diagram then has precisely four short loops follows from Lemma [\ref=lem:comb0] and the fact that there cannot be any short loops between the two rows (columns) that coincide at all positions.

We can now proceed to grouping all possible transition diagrams by the number of short loops contained in them:

The transition diagram of a game as in Theorem [\ref=thm:main] can only have between three and six short loops.

Note first that for any pair of rows (or columns) of a transition diagram at least one of the cases of Lemma [\ref=lem:rc_lem] applies and we can make the following list of cases for two rows (columns), say i and j:

i and j coincide at 0 positions, then they have precisely 2 short loops between them.

i and j coincide at 1 position, then they have 1 or 2 short loops between them.

i and j coincide at 2 positions, then there is at most 1 short loop between them, and there is at least 1 short loop between each of them and the third row (column).

i and j coincide at 3 positions, then they have no short loops between them, and there are precisely 2 short loops between each of them and the third row (column).

It is clear from these that there cannot be a diagram without any short loops: pick any two rows and whichever of the above cases applies, it follows that the diagram has at least one short loop.

Similarly, the transition diagram cannot have precisely one short loop. Assume for contradiction that (without loss of generality) there is a single short loop between rows 1 and 2. Now consider rows 2 and 3, which do not have a short loop between them. Then they must have at least 2 coinciding positions. But having 2 or more coinciding positions implies that there is also a short loop between rows 3 and 1, which contradicts the assumption.

Now let us show that there is no transition diagram with precisely two short loops. Assume first, such diagram exists and both short loops are between the same two rows (or columns), say rows 1 and 2. Applying the above rules to rows 2 and 3 we see that either there have to be more short loops between rows 2 and 3 or between rows 3 and 1, both a contradiction. So the only left possibility is that the two short loops are neither between the same two rows nor columns.

Here there are two cases to check: either both short loops run clockwise or one run clockwise and one runs anti-clockwise (any other configuration leads to a combinatorially equivalent diagram). Assume the short loops have different orientation. Without loss of generality we have the configuration shown in Fig.[\ref=fig:main_proof](e). By Lemma [\ref=lem:rc_lem](2) applied to columns 1,2 and 2,3 we get that (1,1)  →  (2,1) and (2,3)  →  (3,3) (Fig.[\ref=fig:main_proof](f)). But now Lemma [\ref=lem:rc_lem](1) applied to columns 1,3 implies that there is a third short loop. A similar chain of deductions shows that the case with both short loops having the same orientation also cannot happen. Hence a transition diagram with two short loops is not possible.

At last, the upper bound of six short loops follows directly from Lemma [\ref=lem:comb0], which finishes the proof of the lemma.

We can now state the final lemma of the proof of the main theorem. The proof of the lemma consists of easy (but somewhat tedious) deductions of the only possible combinatorial configurations for the transition diagrams and we do not provide complete details. Lemma [\ref=lem:rc_lem] is very useful to reduce the number of diagrams that have to be checked.

Up to combinatorial equivalence, there are precisely

two non-equivalent transition diagrams with precisely three short loops,

fifteen non-equivalent transition diagrams with precisely four short loops,

five non-equivalent transition diagrams with precisely five short loops,

one transition diagram with precisely six short loops,

that satisfy conditions (1)-(5) of the main theorem.

Up to combinatorial equivalence, there are three ways in which three short loops can be positioned, see Fig.[\ref=fig:sloop_pos](a)-(c). It can be checked that only the first of these can give a transition diagram that satisfies (1)-(5), and there are two non-equivalent such diagrams.

Further, there are four ways to position four short loops (Fig.[\ref=fig:sloop_pos](d)-(g)), the first three of which admit five non-equivalent transition diagrams each, whereas the last one contradicts (1)-(5).

The two ways to position five short loops (Fig.[\ref=fig:sloop_pos](h)-(i)) admit two and three non-equivalent transition diagrams satisfying (1)-(5). At last, applying Lemma [\ref=lem:comb0] it is obvious that up to combinatorial equivalence the only way to position six short loops is the one shown in Fig.[\ref=fig:sloop_pos](j) and it is straightforward to check that there is only one possible transition diagram of this type.

Together with Lemma [\ref=lem:num_sloops], this shows that there are precisely 23 transition diagram types satisfying (1)-(5). A list of the 23 diagram types and zero-sum game bimatrices realising them can be found in Appendix [\ref=ap:types], which finishes the proof of Theorem [\ref=thm:main].

Quasi-Periodic Orbits

In this last section of the analytic part of the paper we introduce the game-theoretic notion of quasi-periodicity and investigate the relation to its usual mathematical definition. This notion was first introduced in [\cite=Rosenmuller1971]:

We say that an orbit of BR dynamics is quasi-periodic (in the game-theoretic sense), if its itinerary is periodic.

Note that a priori this notion of quasi-periodicity of an orbit is different from the usual mathematical definition (of an orbit which is dense in an invariant torus). However, we will show that the two notions are closely related.

We consider the Hamiltonian dynamics on S3 corresponding to a zero-sum game and its first return maps to the (two-dimensional) planes on which either p(t) or q(t) changes direction, i.e. where one of the B R -correspondences is multivalued.

Let S be such a plane, let x∈S have a quasi-periodic orbit with (infinite) periodic itinerary I  =  I(x), and let T̂ be the first return map to S (defined on the non-empty subset of S of points whose orbits return to S). Note that T̂ acts as a shift by a finite number of symbols on the itinerary of x. In particular there exists n  ≥  1, such that T̂n(x) has the same itinerary as x. Let us denote T  =  T̂n so that each point in the T-orbit of x has the same periodic itinerary I.

Let [formula] be the set of points in S with itinerary I. Then U is convex and T(U)  =  U. Moreover the restriction of T to U, T:U  →  U, is affine.

Convexity follows from the convexity of the surfaces on which p(t) or q(t) change direction and the fact that the flow in each region Rij follows the 'rays' of a central projection. By the definition of T we have that T(U)  ⊆  U. We know ([\cite=VanStrien2009a]) that T is area-preserving and piecewise affine on S, so that T(U)  =  U. Since all points in U have the same itinerary, it follows that T:U  →  U is indeed affine.

Let x∈S correspond to a quasi-periodic orbit (in the game theoretical sense) of the Hamiltonian dynamics of a 3  ×  3 zero-sum bimatrix game, where S is an indifference plane and T is the return map to S, such that I(T(x))  =  I(x). Then one of the following holds:

The orbit of x is periodic and Tn(x)  =  x for some n  ≥  1.

The T-orbit of x lies on a T-invariant circle (more generally, depending on coordinates: an ellipse) and x corresponds to a quasi-invariant orbit of the Hamiltonian dynamics (in the usual sense), i.e. its orbit under the flow is dense in an invariant torus.

In the second case [formula] is a disk and T:U  →  U is a rotation by an irrational angle (in suitable linear coordinates). Therefore in this case holds for every z∈U.

Assume that x is not periodic. We already know that T:U  →  U is a planar affine transformation of U. Since it is also an isometry and T(U)  =  U, the only possibility is that T restricted to U is a rotation by an irrational angle (any other kind of planar affine transformation satisfying these conditions would have x as a periodic point). The result immediately follows.

The theorem shows that every quasi-periodic orbit (in the game-theoretic sense) is actually quasi-periodic in the usual sense. Conversely, every quasi-periodic orbit in the usual sense, which lies on a torus that only intersects the indifference surfaces along whole circles (and never just partially along an arc) is clearly quasi-periodic in the game theoretic sense. Throughout the rest of this paper, we will always refer to the game-theoretic definition, when using the notion of quasi-periodicity.

From the argument above we can also immediately conclude:

If a Hamiltonian system induced by a 3  ×  3 zero-sum bimatrix game has got an orbit with periodic itinerary, then it also has an actual periodic orbit.

In the second part of this paper we investigate the Hamiltonian dynamics induced by the BR dynamics numerically. We explore which types of orbit occur in these systems and how the combinatorial description given in the first part relates to these observations.

Numerical Observations

In this section we present some of our observations on the behaviour of BR dynamics for zero-sum games, mostly obtained from numerical experiments. The aspects we investigate are:

The time fraction that different orbits spend in each of the regions Rij.

The frequencies with which different orbits visit the regions Rij and the transition probabilities for transitions between regions.

The different types of orbits that can occur and their itineraries (periodic, quasi-periodic, space-filling).

The systems we consider are randomly generated examples of zero-sum games of different combinatorial types, for which we look at the induced Hamiltonian dynamics on level sets of H. For randomly chosen initial points we compute the orbits of the BR dynamics (more precisely, its induced Hamiltonian analogue) and study the time fractions spent in each region Rij and the frequencies, with which the orbits visit the regions. Especially with respect to the presented types of orbit we do not claim to give an exhaustive account of occuring types but rather a list of examples illustrating a few key concepts.

Formally, for an orbit of the BR dynamics (p(t),q(t)), ~ t  >  0 with itinerary [formula] and switching times (tn) we define where χij is the characteristic function of the region Rij.

Alternatively we record the number of times, that each region is being visited by an orbit and compute the frequencies: We write [formula] and [formula].

Moreover throughout the following examples we look at orbits of the first return maps for the BR dynamics to certain surfaces of section. A convenient choice of such surface is a hyperplane on which either p(t) or q(t) changes direction, i.e. where one of the B R -correspondences is multivalued. We will mostly use the surfaces where q(t) changes direction:

Let us now look at some examples:

Let the zero-sum bimatrix game (A,B) be given by

We numerically calculate orbits with itineraries of 104 transitions for several hundreds of randomly chosen initial conditions. For all of these orbits, the evolution of PBR(n) and Q(n) indicates a convergence to

In Fig.[\ref=fig:ex1_evolution], the evolution of some of the PBRij(n) and Qij(n) along an orbit is shown. This or very similar statistical behaviour is observed for all sampled initial conditions. It seems to suggest that initial conditions with quasi-periodic orbits have zero or very small Lebesgue measure in the phase space of BR dynamics for this bimatrix game, as quasi-periodicity in all our experiments leads to very rapid convergence to certain frequencies. Most of the space seems to be filled with orbits that statistically resemble each other in the sense that they all visit certain portions of the space (the regions Rij) with asymptotically equal (or very close) frequencies. The same seems to hold for the fraction of time spent in each region by the orbits.

Fig.[\ref=fig:ex1_section] shows the intersections of an orbit of ([\ref=eq:br_dynamics]) for this game with S12, S23 and S31 (the hypersurfaces where q(t) changes direction), i.e. the orbit of the first return map to these surfaces. Each Sii' consists of three triangular pieces, corresponding to the three pieces of hypersurface between regions (i,j) and (i',j) for j = 1,2,3. Inside each of these triangles, the orbit seems to rather uniformly fill the space, suggesting ergodicity (of Lebesgue measure). If the BR dynamics had invariant tori, these would appear on all or some of these sections as invariant circles whose interior cannot be entered by orbits starting outside. Judging from the above observations, in this example they either don't exist or have very small radius.

In this example we consider a bimatrix game, which is an element in a family of bimatrix games thoroughly studied in [\cite=Sparrow2007] and [\cite=VanStrien2009b]. Let the zero-sum bimatrix game (A,B) be given by where [formula] is the golden mean.

Two types of orbit can be (numerically) observed for the BR dynamics of this game. The first type resembles the orbits in the previous example. The empirical frequencies PBRij(n) and Qij(n) along such orbits initially behave erratically but seem to suggest convergence to certain values or narrow ranges of values, which are the same for all such orbits:

It can be observed that the values of Q(n) are perhaps less erratic and in most of our experiments they seem to converge faster than those of PBR(n). As an example, the evolution of PBR32(n) and Q32(n) along a typical orbit can be seen in Fig.[\ref=fig:ex2_p32_erg].

As in the previous example, in Fig.[\ref=fig:ex2_section] we show the intersection of one such orbit with the surfaces Sii'. Once again the orbit points have a certain seemingly uniform density inside each region, but here they leave out an elliptical region on each of the hypersurfaces. This invariant region consists of invariant circles, formed by quasi-periodic orbits of the system (the second type of observed orbits). The center of the circles corresponds to an actual periodic orbit, i.e. an elliptic fixed point of the return map to one of these surfaces. See [\cite=VanStrien2009b] for an explicit analytic investigation of this (which is made possible by the high symmetry of this particular bimatrix game).

The invariant circles in the elliptical region correspond to invariant tori in the BR dynamics. Their itinerary is periodic with period 6:

Fig.[\ref=fig:type6_orbits](a) shows the transition diagram for this bimatrix game. The periodic itinerary is indicated by a dashed line as a loop in the transition diagram. The empirical frequencies along such quasi-periodic orbits converge to

Fig.[\ref=fig:ex2_section] suggests that there are no other invariant tori for this system, i.e. no open set of initial conditions outside of the visible elliptical regions, whose orbits are all quasi-periodic.

A question that arises naturally from the above example is the following: does an invariant torus of quasi-periodic orbits always have a 'simple' periodic itinerary as the above? Are the periods of such elliptic islands necessarily equal to 6? As the next example shows, the situation can indeed be more complicated and less simple paths through the transition diagram are possible candidates for the periodic itinerary of quasi-periodic orbits in an invariant torus.

Consider the bimatrix game (A,B) with

Generally, the observations here coincide with Example [\ref=ex:erg]. However, one can detect a (quite thin) invariant torus. Fig.[\ref=fig:erg_qp_orbits] shows a typical orbit stochastically filling most of the space. In the bottom row of the same figure, the regions marked by rectangles are enlarged to reveal a thin invariant torus. These quasi-periodic orbits intersect S12 once, S23 and S31 three times each. The orbits look essentially like the quasi-periodic orbits in the previous example, but with an extra loop added. The itineraries are periodic with period 13, where each period is of the form

[formula]

In Fig.[\ref=fig:type6_orbits](b), this itinerary is shown as a loop in the transition diagram. The example demonstrates that combinatorially more complicated quasi-periodic orbits are possible for open sets of initial conditions in the BR dynamics of zero-sum games.

The next example shows an even more complex quasi-periodic structure and gives numerical evidence for more subtle and involved effects than those observed above:

Let us now consider the bimatrix game (A,B) with

As in all the previous examples, the largest part of the phase space of the BR dynamics seems to be filled with orbits which stochastically fill most of the space and along which the frequency distributions PBR(n) and Q(n) seem to converge to certain (orbit-independent) values. Again, an invariant torus can be found. It is more complicated than those observed in the other examples (see Fig.[\ref=fig:type12_qp_orbit]). The orbits forming this invariant torus are quasi-periodic and have an itinerary of period 60. Its structure suggests a generalisation of the type of itinerary observed in Example [\ref=ex:qp_loop]. It consists of a sequence of blocks of the following two forms:

[formula]

The two blocks are shown as pathes in the transition diagram in Fig.[\ref=fig:type12_blocktypes]. Each period of the itinerary of orbits in the invariant torus then has the form As in the previous example the two blocks are the same except for one element (in the previous example the itinerary consisted of two blocks concatenated alternatingly).

In Fig.[\ref=fig:type12_erg_orbit] the intersection of an orbit outside of the invariant torus with one of the hypersurfaces is shown together with a quasi-periodic orbit. The orbit seems to have essentially the same property of filling the space outside the invariant torus, as in the previous examples. However, a closer look at a neighbourhood of the invariant circles (see the right part of Fig.[\ref=fig:type12_erg_orbit]) reveals that the orbit not only misses out the invariant circles but also a certain 'heart-shaped' region surrounding these. The investigation of orbits with initial conditions in this set shows a range of effects not observed in any of the previous examples.

Several different orbits with initial conditions in this region can be seen in Fig.[\ref=fig:type12_orbit_examples]. The orbit points show complicated structures, revealing a large number of 'stochastic' regions as well as invariant regions of periodic orbits of high periods and corresponding quasi-periodic orbits (Fig.[\ref=fig:type12_per_orbits] shows some examples of such quasi-periodic orbits of different higher periods). Some of these orbits spend very long times (itineraries of length 106 and more) in the heart-shaped region before diffusing into the much larger 'stochastic' rest of the space. On the other hand we observe orbits that stochastically fill (heart-shaped) annuli leaving out islands of quasi-periodic orbits. These annuli seem to be invariant for the dynamics (see Fig.[\ref=fig:type12_restricted_orbit]).

Altogether the observations described above strongly indicate the occurrence of Arnol'd diffusion: the coexistence of a family of invariant annuli, which contain regions of stochastic (space-filling) motion and islands of further periodic orbits and invariant circles (quasi-periodic orbits).

Conclusion and Discussion

We would like to propose some open questions for further investigation.

Does the Hamiltonian system induced by a 3  ×  3 zero-sum bimatrix game always have quasi-periodic orbits / invariant tori? Example [\ref=ex:erg] suggests that it is possible to have topological mixing and that the Lebesgue measure is ergodic. However, this might be due to the limited resolution of our numerical simulations and images.

Are there orbits which are dense outside of the elliptic regions? Are almost all orbits outside of the elliptic regions dense?

Example [\ref=ex:arnold_diff] suggests that the system has infinitely many elliptic islands corresponding to quasi-periodic orbits of different periods. The pictures of orbits (e.g. Fig.[\ref=fig:type12_orbit_examples] and Fig. [\ref=fig:type12_restricted_orbit]) show many regions that could potentially contain such elliptic islands of quasi-periodic orbits of different periods. All regions that we investigated for this property actually revealed quasi-periodic orbits.

Given a specific bimatrix example, are there a finite number of blocks, so that the itinerary of any orbit on an elliptic island is periodic with each period being a (finite) concatenation of these blocks? The examples we looked at suggest the answer to be positive.

In Part 1 of this paper we assigned to a Hamiltonian system a transition diagram, giving a necessary condition on the itinerary of orbits. If we were able to develop some kind of 'admissibility condition' (i.e. a sufficiency condition), we could perhaps obtain results such as 'density of periodic orbits', in the same way as was done for quadratic maps of the interval.

In Part 2 we demonstrated that this class of dynamics is sufficiently rich to mimic many of the intricacies of smooth Hamiltonian systems. In spite of the many open questions that still remain, it appears that these piecewise affine Hamiltonian systems could provide a new way of gaining insight into global dynamics of Hamiltonian systems.

The 23 transition diagram types

We list all 23 transition diagram types as in Theorem [\ref=thm:main] sorted by the number of short loops contained in them, together with the respective matrices A, such that the bimatrix games (A, - A) realise the given diagram types.