Compounding approach for univariate time series with non-stationary variances

Introduction

Due to the central limit theorem a great deal of phenomena can be described by Gaussian statistics. This also guides our perception of the risks of large deviations from an expectation value. Consequently, the occurence of any aggravated probability of extreme events is always cause for concern and subject of intense research interest. In a large variety of systems where heavy-tailed distributions are observed, Gaussian statistics holds only locally -- the parameters of the distribution are changing, either in time or in space. Thus, to describe the sample statistics for the whole system, one has to average the parametric distribution over the distribution of the (shape) parameter. This construction is known as compounding or mixture [\cite=dubey1970compound] [\cite=Barndorff-Nielsen1982] [\cite=Doulgeris2010] in the mathematics and as superstatistics [\cite=Beck03] in the physics literature.

An important example for parameter distribution functions is the K-distribution mentioned 1978 for the first time by Jakeman and Pusey [\cite=jak78]. It was introduced in the context of intensity distributions, and their significance for scattering processes of a wide range of length scales was stressed. Moreover the distribution is known to be an equilibrium solution for the population in a simple birth-death-immigration process which was already applied in the description of eddy evolution in a turbulent medium. The underlying picture of turbulence assumes that large eddies are spontaneously created and then "give birth" to generations of children eddies, which terminates when the smallest eddies die out due to viscous dissipation. In [\cite=jak76] Jakeman and Pusey use the K-distribution for fitting data of microwave sea echo, which turned out to be highly non-Rayleigh. The K-distribution is also found as a special case of a full statistical-mechanical formulation for non-Gaussian compound Markov process, developed in [\cite=jak88]. Field and Tough find K-distributed noise for the diffusion process in electromagnetic scattering [\cite=fie03] [\cite=fie03b]. Experimentally the K-distribution appeared in the contexts of irradiance fluctuations of a multipass laser beam propagating through atmospheric turbulence [\cite=maj82], synthetic aperture radar data [\cite=lee94], ultrasonic scattering from tissues [\cite=sha95] [\cite=wen91] and mesoscopic systems [\cite=arn09]. Also in our study we will encounter the K-distribution for one of the systems under consideration.

Compounded distributions can be applied to very different empirical situations: They can describe aggregated statistics for many time series, where each time series obeys stationary Gaussian statistics, the parameters of which vary only between time series. In this case it is straightforward to estimate the parameter distribution. The situation is more difficult when we consider the statistics of single long time series with time-varying parameters. In this non-stationary case, one often makes an ad hoc assumption about the analytical form of the parameter distribution, and only the compounded distribution is compared to empirical findings.

In this paper we address the problem of determining the parameter distribution empirically for univariate non-stationary time series. Specifically we consider the case of Gaussian statistics with time-varying variance. In this endeavor we encounter several problems: If the variance for each time point is purely random, as the compouding ansatz would suggest, we have no way of determining the variance distribution from empirical data. A prerequisite for an empirical approach to the parameter distribution is a time series which is quasi-stationary on short time intervals. In other words, the variance should vary only slowly compared to the time scale of fluctuations in the signal. The estimation noise for the local variances competes with the variance distribution itself. Therefore the time interval on which quasi-stationarity holds, should not be too short. Furthermore, we have to heed possible autocorrelations in the time series themselves, since they might lead to an estimation bias for the local variances. Our aim is to test the validity of the compounding approach on two different data sets.

The paper is organized as follows: In section [\ref=sec2] we give a short summary of the compounding approach and present two recent applications where the K-distribution comes into play. In section [\ref=sec3] we introduce the two systems we are going to analyse, a table top experiment on air turbulence and the empirical time series of exchange rates between US dollar and Euro. In section [\ref=sec4] we address the problem of estimating non-stationary variances in univariate time series. Our empirical results are presented in section [\ref=sec5].

Theoretical considerations

We consider a distribution p(x|α) of d random variables, ordered in the vector x. It is also a function of a parameter α that determines the shape or other features of the distribution, e.g. the variance of a Gaussian. If, in a given data set, the parameter α varies in an interval A, one can try to construct the distribution of x as the linear superposition

[formula]

of all distributions p(x|α) with α∈A. Here, f(α) is the weight function determining the contribution of each value of α in the superposition. Since α itself typically is a random variable, we assume that the function f(α) is a proper distribution. In particular, it is positive semidefinite. As each p(x|α) and the resulting 〈p〉(x) have to be normalized with respect to the random vector x, Eq. ([\ref=comp1]) implies the normalization

[formula]

The physics reasons for the variation of the parameter α can be very different. In non-equilibrium thermodynamics, α might be the locally fluctuating temperature. Although our systems are not of a thermodynamic kind, we also have in mind non-stationarities. In recent experiments [\cite=hoeh10] [\cite=bar13c] we studied the propagation of microwaves through an arrangement of disordered scatterers in a cavity. The distribution of the electric fields was measured at fixed frequencies as a function of position. Then time-dependent wave fields were generated by superposition of N = 150 patterns,

[formula]

Here ψi(x,y) is the wave pattern at frequency fi, and φi is a random phase. For fixed positions, always a Rayleigh distribution was found in the time sequence ψ(x,y,t) for the distribution of intensities I,

[formula]

This is nothing but a manifestation of the central limit theorem. The variance, i.e., the averaged [formula] depends on the position. The large amount of data made it possible to extract the distribution of the parameter [formula]. In good approximation, it turned out to be a χ2ν distribution, see Fig. [\ref=fig:freak]. The number ν of degrees of freedom was related to the number of independent field components and took a value of ν = 30. The authors of Refs. [\cite=hoeh10] [\cite=bar13c] then used the compounding ansatz Eq. ([\ref=comp1]) in the form

[formula]

The integral can be done and yields

[formula]

where Kμ is the modified Bessel function of degree μ. This is the K-distribution introduced in the introduction. Omitting local regions with extremely high amplitudes, so-called "hot spots", the intensity distributions could be perfectly well interpreted in terms of K-distributions, see Fig. [\ref=fig:freak].

We briefly sketch another example which stems from finance. Details can be found in Ref. [\cite=Schmitt2013a]. The conceptual difference to the previous example is that the compounding formula ([\ref=comp1]) appears as an intermediate result, not as an ansatz. We consider a selection of K stocks with prices [formula] belonging to the same market. One is interested in the distribution of the relative price changes over a fixed time interval Δt, also referred to as returns

[formula]

As the companies operate on the same market, there are correlations between the stocks which have to be measured over a time window T much larger than Δt. The corresponding covariances form the K  ×  K matrix Σt. The business relations between the companies as well as the market expectations of the stock market traders change in time. Thus, the market is non-stationary and the correlation coefficients fluctuate in time. Only for time windows T of a month or less, Σt is approximately constant. The multivariate distribution of the returns rk = rk(t) ordered in the K component vector r at a given time t is well described by the Gaussian

[formula]

The non-stationarity over longer time windows T can be modeled by observing that the ensemble of the fluctuating covariance matrices Σt can be approximated by an ensemble of random matrices. In Ref. [\cite=Schmitt2013a] a Wishart distribution was assumed for this ensemble. The ensemble average of the distribution ([\ref=multivar]) over the Wishart ensemble yields

[formula]

where Σ is the sample-averaged covariance matrix over the entire time window T. As Σ is fixed, this result has the form of the compounding ansatz ([\ref=comp1]). Furthermore, it closely matches the result ([\ref=comp3]) found in the context of microwave scattering. The number N of degrees of freedom in the χ2N distribution determines the variance in the distribution of the random covariance matrices. The role of the locally averaged intensity [formula] is now played by an effective parameter z which fully accounts for the ensemble average. Again, a K-distribution follows,

[formula]

in which the bilinear form [formula] takes the place of the intensity I in Eq. ([\ref=eq:kbess]). In both examples, averages over fluctuating quantities produce heavy-tailed distributions which describe the vast majority of the large events.

Data acquisition

Turbulent air flow

The first data set is obtained by measuring the noise generated by a turbulent air flow. For the turbulence generation we used a standard fan with a rotor frequency of 18.44 Hz. We restricted ourselves to standard audio technique handling frequencies up to 20 kHz and standard sampling rates of 48 kHz offering reliable quality at an attractive price. The microphone for the sound recording is a E 614 by Sennheiser with a frequency response of 40 Hz - 20 kHz, a good directional characteristic and a small diameter of 20 mm. It guarantees a broadband frequency resolution and a point-like measuring position. An external sound card with matching properties was necessary to use the full capacity of the quality of microphone and to minimize the influence of the intrinsic noise of the PC. Fig. [\ref=fig:sound] shows a photograph or the used setup.

A microphone has been placed in front of a fan running continuously and generating a highly turbulent air flow. The microphone records the time signal of the sound waves excited by the turbulence. The details about the analysed time series will be discussed in section [\ref=sec4].

Foreign exchange rates

The foreign exchange markets have the peculiar feature of all-day continuous trading. This is in contrast to stock markets, where the trading hours of different stock exchanges vary due to time zones, with partial overlap of different markets and very peculiar trading behavior at the beginning and the end of each trading day. Therefore foreign exchange rates are particularly suited for the study of long time series.

We consider the time series of hourly exchange rates between Euro and US dollar in the time period from January 2001 to May 2013. The empirical data were obtained from www.fxhistoricaldata.com . We denote the time series of exchange rates by S(t). From these we calculate the time series of returns, i.e., the relative changes in the exchange rates on time intervals Δt,

[formula]

Since we work with hourly data, the smallest possible value for Δt is one hour. However, as we will see later on, a return interval of one trading day, [formula], is preferable for the variance estimation. Note that foreign exchange rates are typically modeled by a multiplicative random process, such as a geometric Brownian motion, see, e.g., [\cite=biger1983valuation]. Therefore we consider the relative changes of the exchange rates instead of the exchange rates themselves. While the latter resemble - at least locally - a lognormal distribution, the returns are approximately Gaussian, conditioned on the local variance, that is.

Non-stationary variances in univariate time series

We consider the problem of univariate time series with time-dependent variance. More specifically, we consider time series where the variance is changing, but exhibits a slowly decaying autocorrelation function. This point is crucial, because otherwise it is not possible to make meaningful estimates of the local variances. Time series with this feature show extended periods of large fluctuations interupted by periods with moderate or small fluctuations. This is illustrated in Fig. [\ref=fig:signal] for the two data sets we are studying in this paper. In the top plot of Fig. [\ref=fig:signal], we show the sound signal for the ventilator measurement. In the bottom plot, the time series of daily returns for the foreign exchange data is plotted. In both cases we observe the same qualitative behavior, which is well-known in the finance literature as volatility clustering.

The compounding ansatz for univariate time series assumes a normal distribution on short time horizons, where the local variance is nearly stationary. However, we wish to determine the distribution of the local variances empirically, since it is a critical part in the compounding ansatz. If the variances were fluctuating without a noticable time-lagged correlation, this would not be feasible. Still, we need to establish the right time horizon on which to estimate the local variances. Ref. [\cite=SchaeferGuhr2010] introduced a method to locally normalize time series with autocorrelated variances. To this end, a local average was subtracted from the data and the result was divided by a local standard deviation. In this spirit, we determine the time horizon on which this local normalization yields normal distributed values and analyse the corresponding local variances.

Another aspect we need to take into account is a possible bias in the variance estimation which occurs for correlated events. In Fig. [\ref=fig:acf] we show the autocorrelation function (ACF) of the measured sound signal, as well as the autocorrelation function of the absolute value of hourly returns. Both plots hint at possible problems for the variance estimation. Due to the high sampling frequency, the sound signal is highly correlated. In other words, the sampling time scale is much shorter than the time scale on which the turbulent air flow changes. After 2500 data points, or about 52 ms, the autocorrelation function has decayed to zero. Consequently, we consider only every 2500th data point for our local variance estimation. To improve statistics, we repeat the variance estimation starting with an offset of 1 to 2499. The results are presented in the following section.

In the case of the foreign exchange data we are confronted with a different problem. The consecutive hourly returns are not correlated. While local trends may always exist, it is unpredictable when a positive trend switches to a negative one, and vice versa, see Ref. [\cite=preis2011switching]. However, the autocorrelation of the absolute values shows a rich structure which is due to characteristic intraday variability. This would lead to a biased variance estimation and, consequently, to a distortion of the variance distribution. Therefore we consider returns between consecutive trading days at the same hour of the day. Put differently, we consider [formula] for the returns and get 24 different time series, one for each hour of the day as starting point.

Empirical results

We first discuss the results for the turbulent air flow. As described in the previous section, we sliced the single measurement time series into 2500 time series with lower sampling rate, taking only every 2500th measurement point. This is necessary to avoid a bias in the estimation of the local variances. Before proceeding, each of these time series is globally normalized to mean zero and standard deviation one. Figure [\ref=fig:venti] shows the empirical results for the distribution of local variances and the compounded distribution. The local variances are rather well described by a χ2 distribution with N degrees of freedom. We find N = 10 to provide the best fit to the data. The distribution of the empirical sound amplitudes is well described by a K-distribution with the same N which fits the variance distribution. Hence, we arrive at a consistent picture, which supports our compounding ansatz for this measurement.

The results for the daily returns of EUR-USD foreign exchange rates are shown in Fig. [\ref=fig:forex]. As outlined in section [\ref=sec4], we calculated the daily returns as the relative changes of the exchange rate between consecutive trading days with respect to the same hour of each day. This procedure yields 24 time series of daily returns. We normalize each time series to mean zero and standard deviation one. This allows us to produce a single aggregated statistics. In the top plot of Fig. [\ref=fig:forex] we show the histogram of local variances, i.e. the variances estimated on 13-day intervals. In accordance with the finance literature, the empirical variances follow a lognormal distribution over almost three orders of magnitude, with only some deviations in the tail. The histogram of the daily returns is shown in the bottom plot of Fig. [\ref=fig:forex]. The empirical result agrees rather well with the normal-lognormal compounded distribution. It is important to note, however, that we only achieve this consistent picture of variance and compounded return distribution because we have taken into account all the pitfalls of variance estimation, which we described in section [\ref=sec4].

Conclusions

We applied the compounding approach to two different systems, a ventilator setup generating turbulent air flow and foreign exchange rates. Both systems are characterized by univariate time series with non-stationary variances. Our main objective was to empirically determine the distribution of variances and thus arrive at a consistent picture. The estimation of variances from a single, non-stationary time series presents several pitfalls, which have to be taken into account carefully. First of all, we have to avoid serial correlations in the signal itself. These might otherwise lead to an estimation bias. For the sound measurement, we had to reduce the sampling rate of the data to achieve this. The foreign exchange data presented another obstacle for variance estimation: We observed a characteristic intraday variability which had to be taken into account. Last but not least, it is a prerequisite that the non-stationary variances are not purely stochastic, but exhibit a slowly decaying autocorrelation. Otherwise we would not be able to determine a reasonable variance distribution for the compounding ansatz. When we take all these aspects into account, we arrive at the correct variance distribution. In good approximation we found a χ2 distribution in the case of ventilator turbulence, which leads to a K-distribution for the compounded statistics. For the foreign exchange returns we observe lognormal distributed variances; and the normal-lognormal compounded distribution fit the return histogram well. A central assumption in the compounding ansatz is the stationarity of the variance distribution. This assumption might not always be satisfied and lead to deviations from the compounded distribution.

Acknowledgments

The sound measurements have been supported by the Deutsche Forschungsgemeinschaft via the Forschergruppe 760 "Scattering Systems with Complex Dynamics".