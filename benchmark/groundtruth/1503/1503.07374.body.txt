Discrete unified gas kinetic scheme on unstructured meshes

Introduction

Gas flows can be classified into different regimes based on the Knudsen number (Kn), which is defined as the ratio of the mean free path of the gas to the physical characteristic length. For flows with [formula], non-equilibrium effects become important and the classical Navier-Stokes-Fourier (NSF) equations fail to describe such effects [\cite=bird94]. The Boltzmann equation can serve as a fundamental equation that is valid for the whole range of Knudsen number.

There are mainly two types of numerical approaches for solving the Boltzmann equation. The first one is the widely used direct simulation Monte Carlo (DSMC) method [\cite=bird94], which is the prevailing technique for simulation of high-speed rarefied gas flows. However, in DSMC the particle transport and collision processes are decoupled, and the cell size and time step are required to be smaller than the mean free path and the particle collision time, respectively. For flows in near continuum or continuum flow regime, this requirement will lead to enormous computational costs. Another undesired feature of the DSMC is the statistical noise that must be reduced with time consuming sampling and averaging, which will lead to even larger computational costs for low speed flows and transient problems [\cite=bird94]. It is noted that some efforts have been devoted to reduce statistical noise of the DSMC methods [\cite=fanj01] [\cite=homolle2007low]. The second approach is to solve the Boltzmann equation directly using deterministic numerical schemes. The most popular one of this type is the Discrete Velocity Method (DVM) or Discrete Ordinate Method (DOM) [\cite=yangjy95] [\cite=mieussens00] [\cite=lizhh09], in which the velocity space is discretized into a finite set of discrete velocities and the same operator splitting technique as DSMC is employed to solve the discrete-velocity kinetic equation [\cite=yangjy95] [\cite=mieussens00] [\cite=toro2009]. Therefore, these methods face the same constraints on time-step and cell-size as the DSMC for the continuum and near-continuum flows. Recently, some asymptotic preserving (AP) schemes have been proposed in order to overcome these disadvantages (e.g., [\cite=] [\cite=bennoune08] [\cite=filbet10]). These schemes have been shown to be able to recover the Euler solutions in the continuum limit, but it is still not clear whether the Navier-Stokes solutions can be obtained.

Recently, a unified gas kinetic scheme (UGKS) in finite-volume formulation was constructed for all Knudsen number flows [\cite=xuk10] [\cite=xuk11] [\cite=huangjc12] [\cite=huangjc13]. Unlike the traditional DOM or DVM, the particle transport and collision are considered simultaneously in UGKS in the update of the discrete distribution function. Consequently, the restriction on the cell size and time step is avoided. Therefore, UGKS can be used to simulate entire Knudsen number flows efficiently [\cite=chensz13].

A novel discrete unified gas kinetic scheme (DUGKS) for multi-regime flows was proposed recently [\cite=guozl13] [\cite=guozl14], which shares the same modeling mechanism as the original UGKS [\cite=guozl13]. The main difference lies in the reconstruction of the discrete distribution function at cell-interface. In UGKS, the time-dependent interface distribution function is determined from the local integral solution of the kinetic equation, while in DUGKS, the distribution function at the half time step is determined from a characteristic solution of kinetic equation. This reconstruction includes the coupled effects of particle transport and collision, and makes the updating rule much simplified in comparison with the UGKS.

In previous works [\cite=guozl13] [\cite=guozl14], the DUGKS has been applied to both low speed and high speed non-equilibrium flows based on structured meshes. To further demonstrate the potential applications of the DUGKS for practical problems involving complex geometrics or large flow gradients, in this work we will extend the DUGKS to arbitrary unstructured meshes.

The rest of the paper is organized as following. In Sec. 2 the general procedure of the DUGKS on unstructured meshes is presented. In Sec. 3, several numerical examples, including the micro cavity flow, an expansion flow between two connected cavities, and the rarefied gas flow past a circular cylinder, are provided to demonstrate the applicability of the current method in simulating flows at or covering different regimes. A brief summary is given in the last section.

Discrete unified gas kinetic scheme

Shakhov model

The DUGKS is based on the Boltzmann model equation in which the collision operator is approximated by the Shakhov model [\cite=shakhov68] for monatomic gases. In D dimensional space, the model equation is

[formula]

where [formula] is the velocity distribution function of particles with velocity [formula] in D dimensional velocity space at position [formula] and time t. Here [formula] is a vector in a space with dimensionality L = 3 - D, consisting of the rest components of the particle velocity (ξ1,ξ2,ξ3) in 3-dimensional space; fS is the Shakhov equilibrium distribution function given by the Maxwellian distribution function feq, plus a heat flux correction term as

[formula]

where [formula] is the Prandtl number and [formula] is the peculiar velocity with [formula] being the macroscopic fluid velocity; [formula] is the heat flux vector, R is the specific gas constant, and T is the temperature. The collision time τ in Eq. [\eqref=eq:shak] is related to the dynamic viscosity μ and pressure p by τ  =  μ / p. The Maxwellian distribution function feq is given by

[formula]

where ρ is the macroscopic gas density. The conservative macroscopic flow variables [formula] are calculated as velocity moments of the distribution function,

[formula]

where [formula] and [formula] is the total energy with [formula] being the heat capacity at constant volume. The heat flux [formula] is defined by

[formula]

The distribution function f depends only on [formula] in D dimensional velocity space and is irrelevant to [formula]. To remove the dependence on [formula] , two reduced distribution functions can be introduced [\cite=yangjy95] The macroscopic variables can be computed from these reduced distribution function as

[formula]

and the heat flux can be computed as

[formula]

The evolution equations for the reduced distribution functions can be deduced from Eq. [\eqref=eq:shak] as where the reduced equilibrium distribution functions gS and hS can be deduced from the original equilibrium distribution as with

Discrete unified gas kinetic scheme on unstructured meshes

Updating of the cell-averaged distribution function

The updating rules for g and h in Eq. [\eqref=eq:gh_evo] have the same structure,

[formula]

where φ = g or h. The generic symbol φ will be used to denote g and h in the following. The DUGKS is an explicit finite volume scheme for solving the kinetic equation [\eqref=eq:phi_evo]. The computation domain is firstly divided into some control volumes (cells). By integrating Eq. [\eqref=eq:phi_evo] in each cell from time tn to tn + 1, we have

[formula]

Here φj and Ωj is the cell averaged φ and Ω in cell j; |Vj| is the cell volume and Δt  =  tn + 1 - tn is the time step. Note that the trapezoidal and middle-point rules are used for the collision and convection terms in Eq. [\eqref=eq:phi_evo_d], respectively. The term Fn + 1 / 2j in Eq. [\eqref=eq:phi_evo_d] is the flux of φ across the interface of cell j and is evaluated as

[formula]

where [formula] is the outward normal vector of the kth face of cell j with face area [formula], and [formula] is the center of the face. Equation[\eqref=eq:phi_evo_d] can be rewritten in an explicit form by introducing the transformed distribution functions [\cite=guozl13] [\cite=guozl14], φ̃ and φ̃+

[formula]

where Due to the conservative property of the collision term, the conservative variables can also be calculated from the transformed distribution functions φ̃ as [\cite=guozl14]

[formula]

and

[formula]

Therefore, in actual implementation, the evolution of transformed distribution functions φ̃ is tracked according to Eq. [\eqref=eq:phi_tilde_evo], instead of the original distribution functions φ in order to avoid implicit computations. This is one of the major differences between the DUGKS and the UGKS methods.

Flux evaluation on unstructured mesh

To update φ̃j according to Eq. [\eqref=eq:phi_tilde_evo], the flux Fn + 1 / 2j is required. From the definition of Fn + 1 / 2j given by Eq. [\eqref=eq:flux], the original distribution functions at middle time step at cell interfaces, i.e., [formula] is needed. This is done by solving the kinetic equation[\eqref=eq:phi_evo] locally around the cell interface. To this end, Eq. [\eqref=eq:phi_evo] is integrated from time tn to tn + 1 / 2 along a characteristic line which ends at the face center [formula],

[formula]

where s = tn + 1 / 2  -  tn is the half time step. Here the trapezoidal rule is used again for the collision term. Similar to the treatment of Eq. [\eqref=eq:phi_evo_d], another two transformed distribution functions are introduced as then Eq. [\eqref=eq:phi_half_evo] can be expressed explicitly as

[formula]

Piecewise linear reconstruction in the upstream neighboring cells are employed to interpolate [formula] from the cell centered + ,n, where the neighboring cells are identified by the direction of the particle velocity [formula]. To demonstrate this procedure, here we consider a general case as illustrated in Fig. [\ref=fig:face]. AB is a cell interface with its center locating at [formula] and the unit normal vector [formula] pointing from cell P to cell N. The distribution function [formula] is evaluated as

[formula]

where C stands for P if [formula], or N otherwise. The gradient [formula] at the cell center is determined using the least square method. For instance, the gradient of cell P is evaluated as

[formula]

where the tensor [formula] is defined as

[formula]

with [formula] being the spatial vector from P to its ith adjacent cell center Ni, and ωi  =  1 / |di| being the weighting factor. The function [formula] in Eq. [\eqref=eq:upwind] denotes the gradient limiter which is used to suppress numerical oscillations in regions with discontinuities, such as the shock layer in continuum regime. In this work, we adopt the Venkatakrishnan limiter [\cite=venkatakrishnan95] which is a typical one for flow computations on unstructured meshes.

The time step in the DUGKS is determined by the Courant-Friedrichs-Lewy (CFL) condition,

[formula]

where 0  <  α  <  1 is the CFL number. Δx is the distance between the centers of two neighboring cells that share an interface.

After getting [formula] at face centers according to Eqs. [\eqref=eq:phi_bar_evo_d] and[\eqref=eq:upwind], the original distribution functions φ can be recovered from Eq. [\eqref=eq:phi_bar]. The macro variables at time tn + 1 / 2 that used to evaluate the equilibrium distribution functions φS are calculated from [formula] as

[formula]

and

[formula]

Then the flux across each cell interface can be evaluated according to Eq. [\eqref=eq:flux]. Finally, the cell centered φ̃ can be advanced to the new time level according to Eq. [\eqref=eq:phi_tilde_evo].

The updating procedures presented above are all based on continuous velocity space for convenience. In actual implementation, the continuous velocity space is discretized into a finite discrete velocity set [formula] like the DVM [\cite=yangjy95], and the distribution functions such as [formula] and h̃ are defined at these discrete velocity points as i and h̃i. Proper quadrature rule such as the Newton-Cotes and Gauss-Hermite, is used to approximate the moments,

[formula]

where the ϖi are the weight coefficients for the corresponding quadrature rule.

Numerical examples

We will apply the proposed DUGKS on unstructured meshes to two internal and one external flows to demonstrate its performance in multiscale flow simulations. The first one is the two dimensional lid driven cavity flow at different flow regimes. The second one is a multiscale unsteady gas expansion problem in which the Knudsen number ranges from 10- 3 to 10. The last one is a supersonic rarefied gas flow with Mach number [formula] passing through a circular cylinder at [formula] and 1.

As the DUGKS is an explicit scheme, the simulations start from an equilibrium state based on given initial macro fields. For steady problems, such as the first or the last test case, the flow fields evolve into the final steady states, which is defined as the average relative change of the temperature field in two successive steps being less than 10- 8, i.e.,

[formula]

where the summations are taken over all of the cells.

In all of the tests the simulated gas is argon, with molecular mass [formula] and molecular diameter [formula]. The viscosity of the gas is assumed to depend on temperature following a power-law,

[formula]

where μref is the viscosity at the reference temperature Tref. Here we choose ω = 0.81, and the referenced viscosity is set to be that of a hard-sphere gas, as used in DSMC [\cite=bird94].

Cavity flow

The two dimensional lid driven cavity flow is a standard benchmark problem for the validation of classical CFD methods in continuum regime. This problem has also been studied recently by Benziet al. [\cite=john11] using a parallel DSMC code at Knudsen numbers [formula] and was later used as an benchmark test case to validate the UGKS and DUGKS in a wide range of flow regimes [\cite=huangjc13] [\cite=chensz13] [\cite=guozl13] [\cite=wangp15]. To demonstrate that the DUGKS can recover the Navier-Stokes limit without resolving the mean free path scale in the continuum regime, we also simulate this case in full range of Knudsen numbers.

The flow domain is a square cavity with length [formula]. The upper wall moves with a constant velocity [formula], while other walls are kept fixed. The temperature at the four walls is fixed at [formula] and is used as the referenced temperature. The walls are assumed to be fully diffusive and the boundary conditions are realized following the method presented in Refs. [\cite=guozl13] [\cite=guozl14]. The Knudsen number is defined as [formula], where λ is the mean-free-path of the gas. Different Knudsen number can be achieved by adjusting the initial density ρref.

Both rarefied and continuum flows are simulated. In rarefied regimes, three values of the Knudsen number, [formula] and 0.075, are considered. The velocity of the upper wall is set to be [formula], which is the same configuration as used in the DSMC and UGKS simulations [\cite=john11] [\cite=huangjc13]. For continuum flows, two Reynolds numbers are considered, i.e., [formula] and 1000. Here the Reynolds number is defined as   =  ρrefLUw  /  μref, and the corresponding Knudsen numbers are 3.7763  ×  10- 4 and 1.5105  ×  10- 4, respectively. Furthermore, the Mach number [formula], so that the flow is nearly incompressible and we can compare our results with the benchmark solutions [\cite=ghia82] based on the incompressible Navier-Stokes equations.

In previous work [\cite=guozl13], the DUGKS with structured meshes has been employed to simulate the cavity flow at different flow regimes. Here we choose unstructured meshes to demonstrate the performance of the proposed method. Figure [\ref=fig:cavity_meshes] presents the meshes used for flows with finite Knudsen numbers and continuum flows, respectively. Note that the mesh in Fig. [\ref=fig:cavity_meshes](b) is a hybrid mesh with quadrilateral cells near the walls, which performs better than a pure triangular mesh in capturing the boundary layer effect that is important in continuum flows.

The discretization of velocity space and quadrature rules are chosen dependent on the Knudsen number. For highly rarefied flows, (i.e., [formula]), We will use the Newton-Cotes rule with [formula] velocity points distributed uniformly in the range of   ×  [null]. For the case of [formula], we will adopt the half-range Gauss-Hermit quadrature with [formula] velocity points. For continuum flows, we will employ the half-range Gauss-Hermit quadrature rule with 16  ×  16 velocity points. The CFL number is fixed at 0.8 in all simulations.

Figures [\ref=fig:Kn10]-[\ref=fig:Kn0.075] present the temperature field, heat flux, and velocity (U,V) on the vertical and horizontal center lines, together with the DSMC solutions for the cases of [formula] and 0.075, respectively. It can be seen that the present results agree well with DSMC results. It is interesting to note that the direction of the heat flux is inconsistent with the temperature gradient in each case, suggesting that the Fourier law breaks down, even at the Knudsen number as small as 0.075.

Figures [\ref=fig:Re400] and [\ref=fig:Re1000] show the streamline and velocity profiles for the cases of [formula] and 1000 respectively. The benchmark solutions [\cite=ghia82] are also included for comparison. We can see that even though the cell size is much larger than the mean free path in these cases,the DUGKS results are still in very close agreement with the benchmark data. So the DUGKS recovers the Navier-Stokes solutions in the continuum limit. We would also like to point out that for most traditional DVM methods, the numerical dissipation is proportional to cell size due to the splitting treatment of particle transport and collision processes. This may lead to significant errors for unstructured meshes as the cell size changes dramatically. The above results indicate that the DUGKS can avoid this difficulty with the coupled treatment of particle transport and collision.

Multiscale expansion flow between two connected cavities

In the above subsection, the cavity flow at specific regimes have been simulated. Now we consider a gas expansion flow between two connected cavities with different initial pressures. This flow is an unsteady multiscale problem where different flow regimes appear in a single run. The flow configuration is sketched in Fig. [\ref=fig:expansion]. Two square cavities A and B connected by a channel are initially maintained at different pressure and separated by a diaphragm at the middle of the channel. The height of the cavity is L = 1m, and the length and width of channel are L and H with H = L / 8. Initially, the temperature of the gas in the system and that of the solid walls are maintained at 273K, which is used as the reference temperature. The initial Knudsen numbers at cavity A and cavity B are [formula] and [formula], and the corresponding pressures are [formula] and [formula], respectively. At time t = 0, the diaphragm is removed suddenly, and then the gas starts to expand from the left cavity to the right one. We are interested in the dynamic behavior of the gas during the expansion process.

The mesh for this case is shown in Fig. [\ref=fig:mesh_expansion]. As significant flow variations can take place in cavity B, the mesh is much finer there. While in cavity A, the flow changes slowly and the mesh is relatively coarser. Note that like the continuum cavity flow, the cell size in cavity A is much larger than the mean free path there. The correctness of using such a coarser mesh in cavity A is granted by the AP property of the DUGKS. To account for the highly non-equilibrium effect in cavity B at the early stage, we use a [formula] mesh distributed uniformly in the range of ×  [null] for the velocity space discretization, and the Newton-Cotes quadrature rule is used for the numerical integration. Note that a wider bound is used for the discrete velocity than that used in the cavity flow simulations to account for the supersonic flow behavior in the channel and cavity B in the early stage of expansion. In our simulations, the CFL number is set to be 0.8.

We first define a characteristic time of the system as [formula], and the flow fields at different times are measured. The local Mach number, pressure, and streamlines at times t / tc = 1 and 4 are presented in Figures [\ref=fig:ex_ma_t1]-[\ref=fig:ex_P_t4]. From Fig. [\ref=fig:ex_ma_t1] and Fig. [\ref=fig:ex_P_t1] we can see that the shock wave just reaches the center of cavity B at time t / tc = 1. At this time the gas is still very rarefied there, such that the viscous effect can be neglected without vortex formation. As the gas flows into cavity B gradually, the pressure in cavity B grows up with time, but the pressure ratio between the two cavities is still high enough to form a supersonic nozzle flow in the channel, and the initial shock wave disappears and two symmetry vortexes appear in cavity B at a later time.

To get a detail information of the evolution process of the expansion, we show the temperature, U-velocity and pressure profiles along the horizontal center line of the cavities and the channel at times t / tc = 0.013,0.1,1,2,3 and 4 in Fig. [\ref=fig:ex_time]. It can be seen that at the early stage (t / tc = 0.013 and 0.1), the shock wave propagates in the channel, and the flow variables change sharply across the shock. With time advancing, the pressure difference between the two cavities decreases, and the shock becomes weaker, and the flow rate decreases gradually.

To quantify the results, the temperature, velocity and pressure profiles along the vertical center lines of the two cavities at different times are presented in Fig. [\ref=fig:ex_xB_time] and Fig. [\ref=fig:ex_xA_time], respectively. Here only the results at the upper half ( 0  <  y  <  L / 2 ) of the domain are shown owing to the symmetry of the flow. From Fig. [\ref=fig:ex_xB_time](b), we can see that a counterclockwise vortex develops in the upper half of cavity B, which enhances heat convection in the gas. Consequently, the temperature field becomes uniform gradually, as indicated in Fig. [\ref=fig:ex_xB_time](a).

On the other hand, the flow in cavity A changes only slightly. The temperature and pressure are almost uniform at each time. With the decreasing of pressure in the cavity, the temperature reduces as the internal energy being converted to the kinetic energy.

Supersonic flow passing through a circular cylinder

To further demonstrate the performance of the DUGKS on unstructured meshes for high speed non-equilibrium external flows, we simulate the rarefied gas flows passing through a circular cylinder. It is noted that this problem was also studied by Huang et al. [\cite=huangjc12] using the UGKS method. We here adopt the same configuration and parameters as in their simulations. The free-stream Mach number is [formula], and the radius of the cylinder which is r = 0.01m. Two Knudsen numbers are considered ([formula] and 1). The free-stream gas temperature is [formula] and is used as the referenced temperature. The surface of the cylinder maintains a constant temperature at [formula], and full diffusive boundary condition is assumed. The outer boundary of the computational domain is a circle with a diameter Do  =  22r, and forms a concentric annular with the surface of the cylinder. The distribution functions coming to the computational domain from the outer boundary are set to the equilibrium state based on the free-stream flow condition.

Hybrid meshes are adopted again for this test case (see Fig. [\ref=fig:cylinder_mesh]). Locally refined quadrilateral cells are used near the cylinder to resolve the boundary layer. We note that the mesh resolution in the normal direction of the cylinder wall should be fine enough near the cylinder to capture the large gradients correctly in the boundary layer. For the case of [formula], the mesh spacing around the cylinder wall is finer than that for [formula] (see Fig. [\ref=fig:cylinder_mesh](b)) since the boundary layer become thinner as Kn goes down. It should be pointed out that the fine resolutions around the cylinder wall are only used to capture the large gradients of the flow field but not to resolve the mean free path scale. Actually, based on the posterior estimation, the mesh spacing around the stagnation point for the case of [formula] is about 2 times that of the mean free path there.

In our computations, the velocity space is discretized into a set of uniform spaced 89  ×  89 points in the range of   ×  [null], and the Newton-Cotes quadrature rule is used for the numerical integration. To validate our simulation results, we use the open source dsmcFoam solver [\cite=scanlon10] to obtain the DSMC results under the same flow conditions and computational domain. For the case of [formula], the total number of DSMC particles is about 0.58 million and the time step is [formula]. For the case of [formula], the total number of DSMC particles is about 1.11 million and the time step is [formula].

The contours of temperature and Mach number for the case of [formula] are shown in Fig. [\ref=fig:contour_Kn0d1], also included are the DSMC solutions. The temperature and U-velocity profile along the stagnation line are shown in Fig. [\ref=fig:line_Kn0d1]. Clearly we can see that both the temperature and Mach number distributions of the DUGKS results agree with those of the DSMC results perfectly. However, there are some discrepancies in the front of the bow shock, which can be seen more clearly in the temperature profile. This is due to the intrinsic defect of the Shakhov model used in the current DUGKS [\cite=bird94] [\cite=xuk11], where the collision frequency is independent of particle velocities. Despite of the small deviations, the temperature agrees well with the DSMC results downstream the shock, and the heat flux, normal pressure and shear stress distribution along the cylinder's surface predicted by the DUGKS agree with the DSMC results quite well, as shown in Fig. [\ref=fig:wall_Kn0d1].

For the case of [formula], the temperature and Mach number distributions are presented in Fig. [\ref=fig:contour_Kn1]. The temperature, U-velocity and density profile along the stagnation line are shown in Fig. [\ref=fig:line_Kn1]. These results show that the DUGKS results agree with the DSMC results as well. The discrepancies in the front of the bow shock are slightly more obvious. This is because with the increasing of Kn, the non-equilibrium effects get stronger, thus the Shakhov model deviates more from the full Boltzmann collision kernel. However, the heat flux, normal pressure and shear stress along surface of cylinder predicted by DUGKS are still quite satisfactory in comparison with the DSMC results as shown in Fig. [\ref=fig:wall_Kn1]. These results demonstrate that although the Shakhov model has some intrinsic defects, the DUGKS based on it can still give rather satisfactory predictions, particularly the flow behaviors near the body. The DUGKS can be a very useful engineering tool for hypersonic rarefied flow applications, especially in the regime [formula].

Concluding remarks

In this paper, the DUGKS based on the Shakhov model developed recently [\cite=guozl14] is extended to unstructured meshes. The key feature of DUGKS is that the discrete characteristic solution of the kinetic equation is used in the modeling of the distribution function at a cell interface. Due to the coupled treatment of the particle collision and transport processes, the method has the asymptotic preserving (AP) properties for the capturing NS solutions in the continuum flow regime. Linear reconstruction and gradient limiter are employed in the reconstruction to attain the second-order accuracy.

The performance of the DUGKS on unstructured meshes has been explored by several examples covering different flow regimes from low speed microflows to hypersonic rarefied flows. In the transitional and slip regimes, good agreements between the results of current scheme and the DSMC solutions are observed; In the continuum regime, the DUGKS results obtained on a coarse mesh without resolving the mean free path agree with the benchmark solution based on the Navier-Stokes equations very well. Thus the AP property of the DUGKS for the Navier-Stokes limit is demonstrated. The merit of this property is important for a multicale unsteady gas expansion problem that involves both continuum and rarefied regions. As the mesh size in the continuum region can be much larger than the mean free path scale, the overall computational cost for DUGKS can be largely reduced in comparison with the DSMC method and the traditional DVM. Since the DUGKS is a direct modeling multiscale method [\cite=xuk15] method, with the mesh size and time step being a few times of particle mean free path and collision, the physical solutions are not sensitive to individual particle collision. The DUGKS based on kinetic model equation can be faithfully used in real engineering applications.

Acknowledgments

We would like to thank Dr. Pubing Yu for helpful discussions.This study is financially supported by National Science Foundation of China (Grant No. 51125024) and Fundamental Research Funds for the Central Universities (Grant No. 2014TS119). K. Xu was supported by Hong Kong Research Grant Council with grants (621011, 620813, 16211014).

References