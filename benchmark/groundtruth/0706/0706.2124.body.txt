Independent transversals in locally sparse graphs

Benny Sudakov

40pt 10pt

Lemma Proposition Corollary Conjecture Remark Proposition Claim Definition

Introduction

Let G  =  (V,E) be a graph with maximum degree Δ, whose vertices have been partitioned into r disjoint sets [formula]. An independent transversal of G with respect to {Vi}ri = 1 is an independent set in G which contains exactly one vertex from each Vi. The problem of finding sufficient conditions for the existence of an independent transversal dates back to 1975, when it was raised by Bollobás, Erds, and Szemerédi [\cite=BES]. Since then, much work has been done [\cite=ABZ] [\cite=AH] [\cite=Al-problems-results] [\cite=Al-linear-arboricity] [\cite=Al-strong-chromatic] [\cite=Ha-note] [\cite=Ha-strong-chromatic] [\cite=HS] [\cite=Ji] [\cite=Me] [\cite=RS] [\cite=ST] [\cite=Yu], and this basic concept has also appeared in the study of other combinatorial problems, such as linear arboricity, strong chromatic number and list coloring. In particular, as part of his result on the linear arboricity of graphs, Alon [\cite=Al-linear-arboricity] used the Lovász Local Lemma to show that an independent transversal exists as long as all |Vi|  ≥  2eΔ. Haxell [\cite=Ha-note] later improved his constant from 2e to 2. In the other direction, Jin [\cite=Ji] and Yuster [\cite=Yu] constructed graphs with parts of size |Vi|  =  2Δ  -  1 and maximum degree Δ, with no independent transversals, but required that Δ was a power of 2. Szabó and Tardos [\cite=ST] recently produced constructions with the same properties for all Δ, so the constant 2 is tight.

However, in all of the above constructions, the graphs are disjoint unions of 2Δ  -  1 complete bipartite subgraphs KΔ,Δ and the the partition into {Vi} is done in such a way that the parts {Vi} separate the sides of each KΔ,Δ. This creates many pairs of disjoint parts (Vi,Vj) which have complete bipartite subgraphs of linear size going between them. Note that the number of edges between such a pair (Vi,Vj) is quadratic in Δ. In this paper we show that the constant 2 can be significantly improved if one prohibits such phenomena. One way to accomplish this is to introduce a constraint on the local degree, which is the maximum number of neighbors of a vertex v in a part Vi, where Vi ranges over all parts and v ranges over all vertices [formula]. This constraint arises naturally in several contexts, one of which is vertex list coloring.

Given a graph H  =  (V,E) and a set of lists {Cv} of available colors, one for each vertex v∈V, it is a natural question to determine when we can properly color H from these lists. Suppose that in addition we know that every color c appears in the lists of at most Δ neighbors of each vertex v; then, what minimum size lists will guarantee a proper coloring? This question, which was proposed by Reed [\cite=Re], can be recast as an independent transversal problem as follows. Consider a |V|-partite graph G such that for each v∈V, G has a part with |Cv| vertices labeled by ordered pairs {(v,c):c∈Cv}. Let two vertices (v,c) and (w,c) be adjacent whenever v is adjacent to w in H and [formula]. Then G has maximum degree ≤  Δ and local degree ≤  1, and an independent transversal in G corresponds to a proper list coloring of H. (Note that not every G with local degree 1 has a corresponding list coloring problem, so this association is not reversible.) Haxell's result immediately implies that if all |Cv|  ≥  2Δ, a proper list coloring exists. However, this is not tight, since the local degree condition prohibits the constructions we mentioned earlier. Indeed, for the list coloring problem Reed and Sudakov [\cite=RS] showed that in fact lists of size (1 + o(1))Δ will suffice.

Aharoni and Holzman [\cite=AH] adapted arguments from [\cite=RS] to prove the existence of an independent transversal in multipartite graphs with maximum degree Δ, parts of size (1 + o(1))Δ, and the property that any two distinct vertices in the same part are at distance greater than 4 from each other. Their result has the following nice application. For any collection of n  ≥  (1 + o(1))Δ graphs {Hi}ni = 1 with maximum degree Δ, all sharing the same vertex set V, there exists a partition [formula] such that for each i, Ii is an independent set in Hi. To see this, create a multipartite graph G by making n copies of each vertex, and connect the i-th copy of vertex v to the i-th copy of vertex w if v is adjacent to w in Hi. Then in G there are no paths at all between any pair of distinct vertices in a given part. Thus we can find an independent transversal of G, which gives the required partition.

Aharoni and Holzman [\cite=AH] conjectured that their condition on distances could be replaced by the weaker condition that the local degree is 1. In this paper, we prove the following stronger theorem, which implies their conjecture. Our proof combines arguments from [\cite=Al-strong-chromatic] and [\cite=RS], together with some additional ideas.

For every ε > 0 there exists γ > 0 such that the following holds. If G is a graph with maximum degree at most Δ whose vertex set is partitioned into parts [formula] of size |Vi|  ≥  (1 + ε)Δ, and the local degree of G is at most γΔ, then G has an independent transversal.

Note that the constant of 1 is optimal because of the following example: a disjoint union of Δ cliques of order Δ + 1, where each clique has exactly one vertex per part.

An independent transversal is a set with one vertex from each part Vi that induces no cliques of size 2. Therefore, a natural generalization of this concept is the Ks-free transversal, which is a transversal inducing no cliques of size s. Such transversals were recently studied by Szabó and Tardos [\cite=ST], who posed the problem of finding p(Δ,Ks), which is defined to be the smallest integer n that guarantees the existence of a Ks-free transversal in any graph with maximum degree Δ and part sizes at least n. They provided a construction that bounds [formula], and conjectured that their construction was optimal.

However, this construction also contains complete bipartite subgraphs of linear size, with sides separated by the partition. In light of our previous result, one may ask what can be said when we impose a local degree restriction. We find that we can solve that problem asymptotically, and prove the following generalization of Theorem [\ref=main]:

For every ε > 0 and integer s  ≥  2, there exists γ > 0 such that the following holds. If G is a graph with maximum degree at most Δ whose vertex set is partitioned into parts [formula] of size [formula], and the local degree of G is at most γΔ, then G has a Ks-free transversal.

This is asymptotically tight via a simple construction that we will give later. Furthermore, a slight adaptation of our method proves that even without the local degree condition, [formula], which differs from Szabó and Tardos's conjecture by a factor of at most 2. For s = 3, this matches their best known upper bound for p(Δ,K3), and even is better by 1 when Δ is odd.

The rest of this paper is organized as follows. The next section reviews some basic probabilistic tools we use in our proof. In Section [\ref=sec:reduce-loc-degree] we show how to reduce Theorem [\ref=main] to the special case when local degrees are bounded by a constant. We solve this case in Section [\ref=sec:const-loc-degree]. In Section [\ref=sec:generalize], we prove the generalization of our main result to Ks-free transversals. The final section contains some concluding remarks and open problems. Throughout this paper we will assume wherever needed that γ is sufficiently small. Since, by definition, every non-trivial r-partite graph has local degree at least one, this implies that Δ  ≥  γ- 1 is sufficiently large. We will also systematically omit floor and ceiling signs for the sake of clarity of presentation.

Probabilistic tools

In this section we describe some classical results which we will use in our proof. We begin with several large-deviation inequalities.

(Hoeffding [\cite=HMRR], Chernoff [\cite=AS]) Let [formula] be a sum of bounded independent random variables ai  ≤  Xi  ≤  bi. Then if we let [formula], In particular, when Xi are indicator variables we have Also, for any ε  >  0, there exists [formula] such that

To state the next concentration result, we need to introduce two concepts. Let [formula] be a probability space, and let [formula] be a random variable.

Suppose that there is a constant C such that changing ω in any single coordinate affects the value of X(ω) by at most C. Then we say that X is C-Lipschitz.

Suppose that for every s and ω such that X(ω)  ≥  s, there exists a set [formula] of size |I|  ≤  rs such that every ω' that agrees with ω on the coordinates indexed by I also has X(ω')  ≥  s. Then we say that X is r-certifiable.

(Talagrand [\cite=MR]) Suppose that X is a C-Lipschitz and r-certifiable random variable on [formula] as above. Then,

[formula]

Finally we need the symmetric version of the Lovász Local Lemma, which is typically used to show that with positive probability, no "bad" events happen.

(Lovász Local Lemma [\cite=AS]) Let [formula] be events in a probability space. Suppose that there exist constants p and d such that all [formula], and each event Aj is mutually independent of all of the other events {Ai} except at most d of them. If ep(d + 1)  ≤  1, where e is the base of the natural logarithm, then [formula].

The following result can be deduced quickly from this lemma. We record it here for later use, and sketch the proof for the sake of completeness.

(Alon [\cite=Al-linear-arboricity]) Let G be a multipartite graph with maximum degree Δ, whose parts [formula] all have size |Vi|  ≥  2eΔ. Then G has an independent transversal.

The proof follows by applying the Local Lemma to the probability space where we independently and uniformly select one vertex from each Vi. For each edge e of G, let the "bad" event Ae be when both endpoints of e are selected. The dependency is bounded by 2(2eΔ)Δ - 1, and the probability of each Ae is at most (2eΔ)- 2, so the Local Lemma implies this statement immediately.

Reducing local degrees

In this section, we show that it is enough to prove Theorem [\ref=main] only in the case when the local degree is bounded by a constant. This will be an immediate consequence of the following claim.

For any ε  >  0, there exists γ0  >  0 such that for all γ  <  γ0 and all Δ, the following holds. Let G be a multipartite graph with maximum degree ≤  Δ, parts [formula] of size |Vi|  ≥  (1 + ε)Δ, and local degree ≤  γΔ. Then there exist subsets Wi  ⊂  Vi,1  ≤  i  ≤  r such that the r-partite subgraph G' of G induced by the set [formula] has the following properties. The maximum degree of G' is at most some Δ'  >  γ- 1 / 3, each Wi has size ≥  (1 + ε / 8)Δ' and the local degree of G' is less than 10.

We first prove the following special case of the above theorem, when Δ2 / 3  ≤  γ- 1.

For any 0  <  ε  <  1, there exists Δ0 such that the following holds for all Δ  >  Δ0. Let G be a multipartite graph with maximum degree ≤  Δ, parts [formula] of size |Vi|  ≥  (1 + ε)Δ, and local degree ≤  Δ1 / 3. Then there exist subsets Wi  ⊂  Vi,1  ≤  i  ≤  r such that the r-partite subgraph G' of G induced by the set [formula] has the following properties. The maximum degree of G' is at most Δ'  =  (1 + ε / 3)Δ1 / 3, each Wi has size at least (1 + ε / 4)Δ' and the local degree of G' is less than 10.

Proof.  By discarding vertices, we may assume that all |Vi|  =  (1 + ε)Δ. For every 1  ≤  i  ≤  r, create Wi by choosing each vertex of Vi randomly and independently with probability p = Δ- 2 / 3. Define the following three types of bad events. For each vertex v, let Av be the event that the number of neighbors of v in [formula] exceeds (1 + ε / 3)Δ1 / 3. For each vertex v and part Vi in which v has at least one neighbor, let Bv,i be the event that the number of neighbors of v in Wi is at least 10. Finally, for every 1  ≤  i  ≤  r, let Ci be the event that |Wi|  <  (1 + 2ε / 3)Δ1 / 3. Note that [formula], which exceeds (1 + ε / 4)Δ' if ε  <  1 (which we assumed). We use the symmetric version of the Local Lemma to show that with positive probability, no bad events happen.

To bound the dependency, observe that each of the events Av, Bv,i is completely determined by the choices on all vertices within distance one from v, and Ck is completely determined by the choices on all vertices in Vk. Since degrees are bounded by O(Δ) and all |Vk|  ≤  O(Δ), each event is mutually independent of all but O(Δ2) events.

Now we compute the probabilities of bad events. Since the number of neighbors of a vertex v in W is binomially distributed with mean at most Δp  =  Δ1 / 3, the standard Chernoff estimate (Theorem [\ref=thm:chernoff]) implies that the probability that it exceeds (1 + ε / 3)Δ1 / 3 is at most e-  Ω(Δ1 / 3)  ≪  Δ- 3. Similarly, the size of the set Wi is binomially distributed with mean at least (1 + ε)Δ1 / 3. Hence, using the Chernoff estimate again, we conclude that [formula]. Finally, since the number of neighbors of v in Vi is bounded by Δ1 / 3, we have Thus, by the Local Lemma, with positive probability none of the events Av, Bv,i and Ci happen and we obtain an induced subgraph G' of G which has all the desired properties. [formula]

The general case of Theorem [\ref=t21] cannot be proved using the above arguments, since if γ- 1 were much smaller than log Δ, the number of dependencies would overwhelm the probabilities in the application of the Local Lemma. To overcome this difficulty, we follow an approach similar to the one used in [\cite=Al-strong-chromatic] and construct the desired subgraph by a sequence of random halving steps. This is done via the following lemma.

Let G be a multipartite graph with maximum degree at most Δ, parts [formula] each of size 2s, and local degree at most d. Suppose that Δ is sufficiently large and d >  log 4Δ. Then there exist subsets Ui  ⊂  Vi, each of size s, such that the subgraph of G induced by [formula] has maximum degree at most Δ / 2  +  Δ2 / 3, and local degree at most d / 2  +  d2 / 3.

Proof.  Within each Vi, arbitrarily pair up the vertices so that each vertex v has a mate M(v). Note that this pairing doesn't need to have any correlation with the original edges of G. For each pair of vertices {v,M(v)}, randomly and independently designate one of the vertices to be in Ui. Clearly all Ui will have size s. For each vertex v, let Av be the event that the number of neighbors of v in [formula] exceeds Δ / 2  +  Δ2 / 3. Also for every part Vk and vertex [formula], let Bv,k be the event that the number of neighbors of v in Uk exceeds d / 2  +  d2 / 3. We will use the Local Lemma again to prove that with positive probability none of these events occurs.

Fix a vertex v and consider the event Av. Note that if two neighbors of v are paired with each other by M, then exactly one of them will be in U. Let T be the set of all neighbors of v which are paired by M to vertices which are not neighbors of v. Then the number of neighbors of v in U is at most (Δ - |T|) / 2 plus the number of members of T that belong to U. The second number is binomially distributed with parameters |T|  ≤  Δ and 1 / 2. Therefore by the Chernoff bound (Theorem [\ref=thm:chernoff]), we have that the probability that it deviates from its mean by at least Δ2 / 3 is bounded by 2e- 2(Δ2 / 3)2 / |T|  ≪  Δ- 3. Using similar arguments, together with the assumption that d >  log 4Δ, we can bound [formula].

To bound the dependency, observe that we can argue exactly as in the proof of the previous lemma to show that every bad event depends on at most [formula] other such events. Thus, by the Local Lemma we have that with positive probability none of the events Av, Bv,k happen. [formula]

Proof of Theorem [\ref=t21].  Let G be a multipartite graph with maximum degree ≤  Δ, local degree ≤  d = γΔ, and parts [formula] of size (1 + ε)Δ. First consider the case when γ- 4 / 3  ≥  Δ. Then d  ≤  Δ1 / 4, and the result of the theorem follows from Lemma [\ref=l21] because Δ'  >  Δ1 / 3  ≥  γ- 1 / 3, since Δ  ≥  γ- 1 as was noted at the end of the introduction.

It remains to consider the case γ- 4 / 3  <  Δ. (We choose - 4 / 3 because then our argument will give Δ'  >  γ- 1 / 3.) Let j  ≥  1 be the integer for which 2j - 1  <  γ4 / 3Δ  ≤  2j. By deleting at most 2j vertices from each Vi, we may assume that the size n  >  (1 + ε)Δ - 2j of every part is divisible by 2j. Define the sequences {Δt} and {dt} by setting Δ0  =  Δ, d0 = d = γΔ, and We claim that:

[formula]

Suppose this is true. By (iii), we can apply Lemma [\ref=alon] to split each part Vi in half and obtain a new r-partite graph G1 with maximum degree at most Δ1 and local degree at most d1. Continuing in this manner for j iterations, applying Lemma [\ref=alon] to split the graph in half each time, we obtain a sequence of r-partite graphs [formula]. Note that Δt and dt are upper bounds on the maximum and local degrees of each Gt, respectively. Moreover, all parts in each Gt have size nt = n / 2t.

By the lower bound of (i), we can make Δj as large as necessary by decreasing γ, so the upper bound of (i) yields [formula] (assume ε  <  1). By (ii), dj  ≪  Δ1 / 3j. Applying Lemma [\ref=l21] to Gj with ε / 2 instead of ε, we obtain a new subgraph G' with maximum degree at most Δ'  =  (1 + ε / 6)Δ1 / 3j  >  (γ- 4 / 3 / 2)1 / 3  ≫  γ- 1 / 3, part sizes at least (1 + ε / 8)Δ', and local degree less than 10. This completes the proof of the theorem.

To finish we need to prove our claim. The lower bound of (i) follows immediately from the definition of j, because Δj  ≥  Δ / 2j  >  γ- 4 / 3 / 2. For the upper bound, [formula], so taking cubic roots and subtracting 1 / (21 / 3 - 1) from both sides, we obtain Therefore, and since Δ0  =  Δ and 21 / 3 - 1 > 1 / 4, The last inequality follows from our assumption that γ is small and hence Δ / 2j  >  γ- 4 / 3 / 2 is large enough. Therefore Δj  ≤  (1 + ε / 4)Δ / 2j. Note that since Δj  ≥  Δt / 2j - t, we have Δt  ≤  (1 + ε / 4)Δ / 2t for all t < j (we will use this in the proof of (iii)).

For (ii), the same argument as above (just substitute dt for Δt) shows that where the last inequality used that d / 2j  =  γΔ / 2j  >  γ- 1 / 3 / 2 is large. Hence dj  ≤  8d / 2j  =  8γΔ / 2j. By definition of j and {Δt}, γ4 / 3Δ  ≤  2j, so [formula].

Finally, to prove (iii), note that by definition of j, γ > (Δ / 2t)- 3 / 4 for all t < j. Thus and we are done. [formula]

Transversals in graphs with constant local degree

In this section we obtain the following result, which completes the proof of our main theorem.

For any ε  >  0 and constant C, the following holds for all sufficiently large Δ. Let G be a multipartite graph with maximum degree ≤  Δ, parts [formula] of size |Vi|  ≥  (1 + ε)Δ, and local degree ≤  C. Then G has an independent transversal.

The proof of this result is based on the approach from [\cite=RS] together with some additional ideas. We use the semi-random method, which constructs an independent transversal in several iterations. Each iteration is a random procedure, for which we prove that there is a choice of random bits which give desirable output. We then fix that choice and assume it as the state of affairs for the next iteration. Consider the following random process, which will provide us with one iteration of our algorithm.

Activate (for this iteration) each remaining part independently with probability 1 /  log Δ.

Uniformly at random select a vertex from each activated part and denote by T the set of all selected vertices.

For each i and [formula], if v is not adjacent to any [formula] with j  <  i, then add v to the independent transversal.

For each vertex v added to the independent transversal in Step 3, delete the entire part containing it from G. Also delete all neighbors of all vertices in T from G.

Observe that the deletions ensure that after each iteration, the partial independent transversal constructed so far has no adjacencies among the remaining vertices. Our objective will be to show that after performing several iterations, the remaining graph will have maximum degree ≤  Δ' and parts of size ≥  2eΔ', for some Δ'. Then, we will abort the algorithm, and apply Proposition [\ref=prop:2e] to complete the construction of our independent transversal in a single step.

Setting the stage

In our study of the evolution of degrees and part sizes, the following definitions are useful. For each part Vi, let st(i) be its size at the start of iteration t. For each vertex v, let Nt(v) be the set of v's neighbors at the start of iteration t, and let dt(v)  =  |Nt(v)|.

Next, define the sequences {St} and {Dt} by setting S1  =  (1 + ε)Δ, D1  =  Δ, and Let [formula] be the property that at the start of iteration t, all remaining parts have size at least St, and all remaining vertices v have dt(v)  ≤  Dt. (Completely ignore deleted parts and vertices.) We will prove by induction that there is always a choice of random bits such that we can perform iterations with property [formula] holding for every [formula]. Then at the end of iteration [formula], all remaining parts have size at least St' + 1 and all remaining vertices have degree at most Dt' + 1. A routine calculation reveals that

[formula]

Therefore, by Proposition [\ref=prop:2e] there is an independent transversal through the remaining parts, as promised above. This will have no adjacencies with the partial independent transversal constructed by the first t' iterations, so the union of the two partial transversals will be a full independent transversal. Note that if [formula], then St  =  Θ(Δ) and Dt  =  Θ(Δ). We will use this fact throughout the rest of the proof.

It remains to show that if at the beginning of iteration t we have a graph with property [formula], then with positive probability the graph obtained at the end of this round satisfies [formula]. Define the following family of bad events. Let Ai be the event that st + 1(i)  <  St + 1 and let Bv be the event that dt + 1(v)  >  Dt + 1. The dependencies among these events are polynomial in Δ. To see this consider the auxiliary graph H obtained by adding edges such that every part Vi becomes a clique. If we know the algorithm's choices on the "patch" consisting of all vertices within distance (with respect to edges in H) 4 from v, then Bv is completely determined. This is because a neighbor w of v can only be deleted in two ways: either a neighbor of w is selected in Step 2, or the entire part containing w is deleted because a vertex x in that part is selected, but none of x's neighbors in lower-indexed parts are selected. So, each event Bv is mutually independent from all other events Bw whose patches are disjoint from its own. Since the part sizes are O(Δ), the degrees in H are also O(Δ), so the dependency is bounded by O(Δ8). Events of type Ai are determined by even smaller patches, so the total dependency is also O(Δ8). Therefore if we prove that for every part Vi and vertex v

[formula]

then we can apply the Local Lemma to show that with positive probability none of the events Ai, Bv occur. This corresponds precisely to property [formula], completing the induction step. Thus it remains to establish the two probability bounds above.

Parts remain large enough

Suppose that our graph has property [formula], and let Vi be some part of this graph. In this section we bound the probability that the size of Vi at the end of iteration t is less than St + 1.

For every vertex v and part Vk, define dt(v,k) to be the number of neighbors of v in part Vk at the start of iteration t. Since Dt / St  <  D1 / S1  =  1 / (1 + ε), by linearity of expectation we have

[formula]

Instead of proving concentration of st + 1(i) directly, we consider the number of vertices we deleted from the part Vi in the t-th iteration and prove that this random variable R  =  st(i)  -  st + 1(i) is concentrated. Since the local degree is bounded by C, changing the assignment of any vertex can change R by at most C. Also, if R  ≥  s, there are at most s vertices in T, each with neighbor(s) in Vi, such that their selection certifies that R  ≥  s. Therefore R is C-Lipschitz and 1-certifiable. Note that R  ≤  st(i)  =  Θ(Δ) and [formula]. Thus, using Talagrand's inequality (Theorem [\ref=thm:talagrand]), we obtain

Now for sufficiently large Δ,

[formula]

Note that since we fixed the output of the (t - 1)-st iteration, the value of st(i) in the definition of R is fixed as well. Thus by linearity of expectation, [formula], so

[formula]

which implies (i).

Degrees shrink quickly enough

In this section we prove that if our graph has property [formula] then for every vertex v the probability that its degree at the end of iteration t is greater than Dt + 1 is ≪  e-   log Δ log  log Δ. Fix a vertex v. If we have dt(v)  ≤  Dt + 1, then we are already done, so suppose that is not the case. Then Δ  ≥  dt(v)  >  Dt + 1  =  Θ(Δ). For each vertex v, let zt(v) be the number of neighbors of v whose entire part was deleted in Step 4 of iteration t. Clearly dt + 1(v)  ≤  dt(v)  -  zt(v), so if [formula], then for sufficiently large Δ we have

[formula]

Thus to prove (ii) it is enough to show

[formula]

Recall our notation that for a vertex v and a part Vk, dt(v,k) is the number of neighbors of v in Vk. Call a part Vk relevant for v if dt(v,k)  ≥  1, i.e., v has at least one neighbor in Vk. To analyze the behavior of zt(v), we divide the t-th iteration of the algorithm into 2 independent phases.

Phase I.  Activate each part relevant for v independently with probability 1 /  log Δ, and define the random variable where the indicator I1(k) = 1 if part Vk was activated and zero otherwise. Randomly select a vertex from each of these activated parts, and collect the selected vertices in a set T1. Define the subset S  ⊆  T1 as follows. For every i and [formula], we put it in S iff x is not adjacent to any [formula] with j  <  i. Let I2(k) be an indicator random variable which equals one iff [formula], and define

Phase II.  Activate the rest of the parts (i.e., parts that are not relevant for v) independently, each with probability 1 /  log Δ, and randomly select a vertex from each of them. Let T2 be the set of vertices selected in this phase. For each i and [formula], if u is adjacent to some [formula] with j  <  i, then remove u from S. Define the random variable where the indicator I3(k) = 1 iff part Vk still has at least one vertex in S.

Observe that, by definition, the parts relevant for v which we delete entirely during iteration t are exactly the ones with I3(k) = 1. Therefore zt(v)  =  X3  ≤  X2  ≤  X1. Our strategy will be to bound zt(v) by starting from X1 and working towards X3. By linearity of expectation, [formula]. Also, since dt(v)  =  Θ(Δ) (see the beginning of this section), local degrees are ≤  C, and the number of nonzero dt(v,k) is at most Δ, we can apply Hoeffding's inequality (Theorem [\ref=thm:hoeffding]) to the sum of the terms in X1 with dt(v,k)  ≠  0 and conclude that

[formula]

Next, let us estimate X2 by studying the difference X1  -  X2. Reveal the random selections in the parts activated in Phase I in order of part number (i.e. if i < j and Vi and Vj were activated, reveal the vertex selection in Vi first). For each activated part Vi, the difference X1  -  X2 will gain dt(v,i) precisely when the selected vertex [formula] is adjacent to some selected vertex [formula] with j  <  i. Call such an event a conflict. Its probability is at most [formula], because there are at most X1 activated parts with j  <  i, each of their selected vertices has degree at most C into Vi, and |Vi|  ≥  St by property [formula]. Now condition on [formula]. If N  ≤  X1 is the number of parts activated in Phase I, the probability that there are [formula] conflicts is bounded by

[formula]

Here we used that St  ≥  dt(v) and Δ is sufficiently large. Since all dt(v,i)  ≤  C, each conflict can account for a value gain of at most C in X1 - X2. Therefore, we proved that conditioned on [formula],

[formula]

To estimate X3, we will use Talagrand's Inequality (Theorem [\ref=thm:talagrand]) to show that the difference X2 - X3 is strongly concentrated. This requires a Lipschitz condition, so let us first ensure that we have a good Lipschitz constant. Let W be the set of vertices which have at least one neighbor in some part relevant for v. Since there are at most Dt parts relevant for v, it is easy to see that |W|  ≤  D2tSt  ≤  (1 + ε)Δ3. For w∈W, let Bw be the event that at least log Δ neighbors of w are selected for T1 in Phase I. The number of neighbors of w in a given part is at most C, so the probability that one of them appears in T1 is [formula], and this happens independently for distinct parts. Since w has neighbors in at most Δ parts and St  =  Θ(Δ), we obtain

[formula]

This implies that

[formula]

Combining inequalities [\eqref=x1], [\eqref=x2], and [\eqref=lipschitz], we see that

[formula]

Crucially, the high probability event in [\eqref=ready-for-x3] is entirely determined by Phase I, so all of the choices in Phase II are still independent of it. Now condition on Phase I (i.e., X2 and I2(k) are fixed), and also on the event in [\eqref=ready-for-x3]. Perform Phase II. We will show that with high probability the random variable R  =  X2 - X3 is small. Observe that since I2  ≥  I3, and we conditioned on Phase I, Now given that I2(k)  =  1, the difference I2(k)  -  I3(k) will be 1 precisely when the vertex [formula] has one of its (at most Dt) neighbors w selected in Phase II. For each such neighbor w, the probability of its selection in Phase II is ≤  1 / (St log Δ), so a simple union bound gives [formula]. Therefore

[formula]

since we conditioned on a range for X2. Next we show that R is concentrated. We conditioned on [formula], so changing any choice in Phase II can affect R by at most C log Δ. Therefore, R is Lipschitz with constant C log Δ. It is also clear that R is 1-certifiable. Since dt(v)  =  Θ(Δ) and R  ≤  X2  ≤  Δ, by Talagrand's Inequality (Theorem [\ref=thm:talagrand]) we have

[formula]

In particular, Therefore, with probability [formula],

[formula]

This establishes [\eqref=z-goal] and completes the proof. [formula]

Clique-free transversals

In this section, we study sufficient conditions for the existence of a Ks-free transversal in graphs G with maximum degree Δ. Consider s to be a fixed parameter, and let Δ grow. We will prove that if the local degree is o(Δ), then parts of size [formula] are sufficient.

First, let us show that this bound is asymptotically tight via the following construction. Fix any positive integer [formula], and let G be a graph with vertex set [formula]. Let the parts be defined as Vi  =  {(i,j):1  ≤  j  ≤  n}, and let (i,j) and (i',j) be adjacent for all 1  ≤  i,i'  ≤  Δ + 1. It is clear that G has maximum degree Δ and local degree 1. We show by contradiction that this graph has no Ks-free transversal. Indeed, if there is such a transversal T, then for each j, the set of vertices (i,j)∈T forms a clique and hence has cardinality at most s - 1. Yet there are only n possibilities for j, so |T|  ≤  n(s - 1)  <  Δ + 1. This is a contradiction, since T must have one vertex in each of the Δ + 1 parts. Therefore, parts of size [formula] do not guarantee a Ks-free transversal.

Proof of Theorem [\ref=generalize].  Fix ε  >  0 and s  ≥  3. Let G = (V,E) be a graph with maximum degree at most Δ whose vertex set is partitioned into r parts [formula] of size [formula]. Color the vertices of G with s - 1 colors such that the number of monochromatic edges is minimal. Note that for every vertex v, there must be a color c such that the number of neighbors of v which are colored c is at most [formula]. Hence the minimality of the coloring implies that v has at most that many neighbors in its own color, or else one could obtain a better coloring by changing the color of v to c. Now delete all edges whose endpoints have different colors, and call the resulting graph G'. By the above argument, the maximum degree in G' is at most [formula], so G' has an independent transversal T by Theorem [\ref=main]. However, T is an (s - 1)-colorable transversal in G, and so must be Ks-free. [formula]

Observe that we did not need the local degree condition until we invoked Theorem [\ref=main]. If we do not have a local degree condition, we can apply Haxell's result [\cite=Ha-note] instead, which says that parts of size 2Δ guarantee an independent transversal in graphs with maximum degree Δ. This immediately implies:

Let G be a graph with maximum degree at most Δ whose vertex set is partitioned into r parts [formula] of size [formula]. Then G has a Ks-free transversal.

Phrased in terms of the function p(Δ,Ks) defined in the introduction, we have which is at most twice Szabó and Tardos's lower bound (which they conjectured to be tight) Note that for s = 3, it matches their best upper bound, p(Δ,K3)  ≤  Δ, which they obtain as a consequence of a result on acyclic transversals, i.e., transversals which have no cycles. So, this simple approach provides an alternate proof of that upper bound. For s > 3, as far as we know, this proposition gives the current best upper bound.

Concluding Remarks

We proved that if G is a multipartite graph with maximum degree Δ and local degree o(Δ), then parts of size (1 + o(1))Δ will guarantee an independent transversal. It is interesting to decide if it is possible to achieve the same result under the weaker condition that the number of edges between any pair of distinct parts is o(Δ2).

Let M = M(Δ) be the smallest integer such that if G is a multipartite graph with maximum degree Δ, local degree 1, and parts of size Δ + M, then it has an independent transversal. We showed that M = o(Δ) (in fact, this can be sharpened to Δ1 - ε using our method) and it remains an interesting problem to better estimate the function M(Δ). In particular, an intriguing open question is to determine if M(Δ) is bounded by absolute constant. Note that a list coloring construction of Bohman and Holzman from [\cite=BH] implies that M would have to be at least 2, because as mentioned in the introduction, an instance of the list coloring problem corresponds to an independent transversal problem with local degree 1.

Let G be a graph with maximum degree Δ whose vertex set is partitioned into r equal parts [formula] of size n. How large should n be to ensure that we can partition the entire graph into a disjoint union of n independent transversals? This question is related to the notion of strong chromatic number, see, e.g., [\cite=ABZ] [\cite=Al-strong-chromatic] [\cite=Ha-strong-chromatic]. Alon [\cite=Al-strong-chromatic] proved that for a (large) constant c, parts of size n = cΔ are enough. Haxell [\cite=Ha-strong-chromatic] reduced the constant to 3, and recently even to 3 - ε, where ε can be as large as 1 / 4 [\cite=Ha-private-comm]. It would be very interesting to determine the correct value of c, which should be at least 2 because of the construction of Szabó and Tardos mentioned in the introduction.

However, if we impose a local degree restriction on G, our result suggests that one does not need parts of size 2Δ. We believe that if G has maximum degree Δ and local degree o(Δ) then parts as small as n = (1 + o(1))Δ will guarantee the existence of n disjoint independent transversals. So far we can only prove the much weaker statement that parts of size at least (2 + o(1))Δ are sufficient. This claim follows immediately from our main result together with an argument of Aharoni, Berger, and Ziv. In [\cite=ABZ] (see Theorem 5.3) they implicitly proved that if parts of size at least f(Δ) imply that every vertex v of G is contained in some independent transversal, then parts of size at least Δ + f(Δ) guarantee the existence of a partition of G into independent transversals. Our result certainly implies the former statement with f(Δ)  =  (1 + ε)Δ. Indeed, for any given vertex v, the local degree is o(Δ), so we can delete o(Δ) neighbors of v from every part. Then v becomes isolated from rest of the graph. However, the part sizes are still at least (1 + ε - o(1))Δ so by Theorem [\ref=main] we can find an independent transversal among the parts not containing v, and then add v.

Acknowledgment.  The authors would like to thank Noga Alon, whose suggestion simplified their original proofs of Theorem [\ref=generalize] and Proposition [\ref=noga], and the referees for careful reading of this manuscript.