Lemma Corollary Proposition Conjecture Remark

On the critical pair theory in abelian groups : Beyond Chowla's Theorem

Oriol Serra

Gilles Zémor

Introduction

Let S and T be nonempty subsets of [formula]. The Cauchy-Davenport Theorem [\cite=CAU] [\cite=DAV] states that

[formula]

The Cauchy-Davenport Theorem was generalized to abelian groups by several authors including Mann [\cite=MANA] and Kneser [\cite=KN3]. The first generalization to cyclic groups is due to Chowla [\cite=CHO]: it states

Let S,T be nonempty subsets of [formula] such 0∈S. Assume that every element of [formula] has order exactly n. Then |T + S|  ≥   min (n,|S| + |T| - 1).

Subsets achieving equality in an additive theorem are known as critical pairs of the theorem. One may easily check that the only interesting critical pairs for the Cauchy-Davenport Theorem arise when |S|,|T|  ≥  2 and |S + T|  ≤  p - 2. Under these assumptions Vosper's Theorem [\cite=VOS] states that |S + T| = |S| + |T| unless both S and T are arithmetic progressions with a common difference. This statement determines the critical pairs of the Cauchy-Davenport Theorem.

Generalizing Vosper's Theorem to arbitrary abelian groups requires a lot of care. The importance of this question was mentioned by Kneser in [\cite=KN3]. Motivated by Kneser's work, Kemperman proposed in [\cite=KEM] a recursive procedure which generalizes Vosper's Theorem to abelian groups. The main tools used by Kemperman are basic transformations introduced by Cauchy, Davenport and Dyson [\cite=Nat]. One of the results obtained by Kemperman is the following:

Let G be an finite abelian group and let S,T be subsets of G such that |S|  ≥  2, |T|  ≥  2 and |S + T| = |S| + |T| - 1  ≤  p - 2, where p is the smallest prime divisor of |G|. Then S and T are arithmetic progressions with the same difference.

Note that the existence of a short direct proof for this result is unlikely since the statement contains Vosper's Theorem. This result has been recently extended to non abelian groups by Károlyi [\cite=karolyi] and independently by one of the authors [\cite=HALG].

By using the additive transformations mentioned above, Rødseth and one of the authors recently characterized the critical pairs of Vosper's Theorem [\cite=HR] :

Let S,T be subsets of a group of prime order [formula], with |T|  ≥  3 and |S|  ≥  4 such that

[formula]

Then S and T are included in arithmetic progressions with the same difference and of respective lengths |S| + 1 and |T| + 1.

There are several methods currently available in additive theory. One of them is based on Fourier analysis. Examples of applications of this method can be found the monographs of Freiman [\cite=FRE] and Tao and Vu [\cite=TV], or in the papers by Deshouillers and Freiman [\cite=DF], and by Green and Ruzsa [\cite=GR]. Another powerful tool is the polynomial method introduced by Alon, Nathanson and Ruzsa [\cite=ANR]. Károlyi recently [\cite=KAR] used this method to obtain a remarkable critical pair theorem for restricted sums.

In this paper we obtain improvements of some of the above results using the isoperimetric method. This method has been used to generalize addition theorems to non abelian groups in some papers including [\cite=ZEM] [\cite=HAST] [\cite=HALG] [\cite=AOY]. It also derives additive inequalities, mainly from the structure of the k-atoms of a set. If S is a generating subset containing 0 of an abelian group G, a set A is called a k-atom of S if it is of minimum cardinality among subsets X such that |X|  ≥  k, |X + S|  ≤  |G| - k, and |X + S| - |X| is of minimum possible cardinality (see Section [\ref=isop] for detailed definitions). It is proved in [\cite=HCAY] that any 1-atom containing 0 is a subgroup. This result implies easily Mann's generalization of the Cauchy-Davenport Theorem. The structure of 2-atoms has proved more difficult to describe but potentially gives stronger results: 2-atoms have been used in [\cite=HA00] [\cite=HP] to derive critical pair results. In groups of prime order, the description of 2-atoms was completed by two of the present authors in [\cite=SZ]. Atoms of higher order were used in [\cite=GOY] to classify sets [formula] with |S + T|  ≤  |S| + |T| + 1.

In the present paper we first study the structure of 2-atoms in general abelian groups. Our main result in the first part of this paper is Theorem [\ref=th:main]: broadly speaking it states that, under some technical conditions that will be shown to be quite tight, 2-atoms have cardinality 2 or are subgroups. In the rest of the paper we apply this fact to obtain critical pair results.

We shall first obtain a critical pair result for Chowla's Theorem [\ref=th:chowla] which reduces to Vosper's Theorem if n is a prime. To be precise, we will actually be dealing with a strengthened version of Theorem [\ref=th:chowla] (Corollary [\ref=chowla]) that only requires the order of every element of [formula] to exceed |S| - 1 rather than to equal n. We call this requirement a weak Chowla condition. The description of the corresponding sets S and T are obtained in Theorem [\ref=th:kempermannis] and Corollary [\ref=th:kemperman+0].

We then move on to give a description of subsets S,T, with |S + T|  ≤  |S| + |T|, in arbitrary abelian groups provided S contains no element of order less than |S| + 1 (another weak Chowla condition). We show that, if the abelian group has no subgroups of order 2 or 3, then S and T are made up of arithmetic progressions with at most one missing element and periodic subsets with at most one missing element, see Theorems [\ref=th:kempermannis+1] and [\ref=th:kemperman+1]. This last result is a generalization to abelian groups of Theorem [\ref=th:HR] of Rødseth and one of the authors, since it reduces to it when the group is of prime order.

The paper is organized as follows: Section [\ref=isop] gives some preliminary results and Section [\ref=sec:chowla] uses them to derive a solution to the critical pair problem for Chowla's Theorem and its strengthened version. Section [\ref=sec:fainting] works out some tools necessary to Section [\ref=sec:2atoms] which is devoted to the description of 2-atoms. Sections [\ref=sec:small] and [\ref=sec:quasi] make up more preliminary material for section [\ref=sec:chowlavosper] which derives the generalization to abelian groups of Theorem [\ref=th:HR].

Isoperimetric tools

In this section we recall known results on isoperimetric numbers of subsets in finite abelian groups and derive some consequences relevant to us later on. Our prime objects of concern are the 2-atoms of a subset: we shall see that they are either subgroups or Sidon sets and, in the last case, they have the largest possible isoperimetric numbers.

Let S be a subset of a finite abelian group such that 0∈S. Denote by 〈S〉 the subgroup generated by S. For a positive integer k, we shall say that S is k- separable if there exists X  ⊂  〈S〉 such that |X|  ≥  k and |X + S|  ≤  |〈S〉| - k.

Suppose that S is k-separable. The k-th isoperimetric number of S is then defined by

[formula]

For a k-separable set S, a subset X achieving the above minimum is called a k- fragment of S. A k-fragment with minimal cardinality is called a k- atom.

The following easy facts will be used regularly throughout the paper:

if S is k-separable then 1  ≤  κk - 1(S)  ≤  κk(S).

The translate A + g of a k-atom A is also a k-atom.

Remark. Let 0∈S be a k-separable subset of a finite abelian group such that |S|  ≥  k. Then κk(S)  ≤  k|S| - 2k + 1.

Assume the contrary. Let G = 〈S〉. Then we must have clearly |G|  ≥  2k + κk(S)  ≥  k|S| + 2. Hence k|S| - k + 1  ≤  |G| - k - 1. Let X be a k-subset of S such that 0∈X.

We have [formula]

Therefore, by ([\ref=eq:kappa]), we have κk(S)  ≤  |S + X| - |X|  ≤  k|S| - 2k + 1, a contradiction.

If S is not k-separable, we shall put by convention κk(S) = k|S| - 2k + 1 so as to have, for all |S|  ≥  k,

[formula]

The definition of a k-atom implies the following lemma:

Let 0∈S be a k-separable subset of a finite abelian group. Let A be a k-atom and suppose that |A| > k. Then, for each a∈A and s∈S we have

[formula]

Let [formula] and suppose that |A' + S| < |A + S|. Then |A' + S| - |A'|  ≤  |A + S| - 1 - |A'| = |A + S| - |A| contradicting the minimality of A. In other words, no element x in S + A can be uniquely written as x = s + a, s∈S and a∈A. This means that [formula] for each s∈S.

Next we recall:

Let 0∈S be a k-separable subset of a finite abelian group G. Let F be a k-fragment of S and g∈〈S〉. Then g - F and [formula] are k-fragments of - S. Moreover κk( - S) = κk(S).

The following is a particularly useful property of k-atoms.

Let 0∈S be a k-separable subset of a finite abelian group G. Let A be a k-atom of S. Let F be a k-fragment of S such that [formula]. Then [formula]

The intersection property implies easily the following description of 1-atoms.

Let 0∈S  ≠  〈S〉 be a subset of a finite abelian group G. Let A be a 1-atom of S such that 0∈A. Then A is the subgroup generated by [formula]. In particular κ1(S) is a multiple of |A|.

From these early results we can derive the following generalization of Chowla's Theorem:

Let 0∈S be a generating subset of a finite abelian group G such that the order of every element of [formula] is at least |S| - 1. Then κ1(S) = |S| - 1.

In particular, for every nonempty subset X  ⊂  G, we have

[formula]

If S is not 1-separable, then by definition we have S = 〈S〉 and by the convention preceding [\eqref=eq:maxkappa] we have κ1(S) = |S| - 1. Suppose therefore that S is 1-separable. Let A be a 1-atom of S containing 0. By Corollary [\ref=Cay], A is the subgroup of G generated by [formula] and κ1(S) is a multiple of |A|. If [formula] then it follows that A is the null subgroup and we have κ1(S) = |S + A| - |A| = |S| - 1. If [formula] then by the hypothesis on the order of the elements of S we have κ1(S)  ≥  |A|  ≥  |S| - 1 which implies κ1(S) = |S| - 1 by [\eqref=eq:maxkappa].

The last inequality in the statement is a direct consequence of the definition of κ1.

Recall that a subset X of an abelian group is a Sidon set if no two pairs of (not necessarily distinct) elements in X have the same sum. In particular [formula] for each x.

Let 0∈S be a k-separable subset of a finite abelian group G. Let A be a k-atom of S such that 0∈A, and suppose that p  ≥  k where p is the smallest prime divisor of |G|. Then either A is a subgroup of G or [formula] for every x∈G, x  ≠  0. In particular a 2-atom of a 2-separable set is either a subgroup or a Sidon set.

Without loss of generality we may suppose 〈S〉 = G. The double inequality [formula] is forbidden by Lemma [\ref=lem:intersection] because x + A is also a k-atom of S. Suppose that there is x∈G, x  ≠  0, such that A = A + x. Then we have A  =  A + 〈x〉: hence [formula] for every a∈A. Since |〈x〉|  ≥  p  ≥  k, Lemma [\ref=lem:intersection] implies that we have A = a + A for every a∈A and A is a subgroup.

Let 0∈S be a generating set of a finite abelian group G of cardinality |S|  ≥  3. Assume that [formula] for all [formula]. Then κ1(S) = |S| - 1. In particular κ1(X) = |X| - 1, if X is a Sidon set containing 0.

Suppose on the contrary that κ1(S)  ≤  |S| - 2. Then S is 1-separable. Let 0∈A be a 1-atom of S. Then A is a nonnull subgroup of G and κ1(S) is a multiple of |A|.

Let [formula]. We have [formula] which implies |S|  ≤  |A|  ≤  κ1(S), contradicting [\eqref=eq:maxkappa].

The next result determines the second isoperimetric number of Sidon sets. In what follows we use the following notation. Given a subgroup H of G, by the decomposition of a subset S  ⊂  G modulo H we mean the minimal partition of S into nonempty subsets, each one contained in a single coset of H.

Let 0∈S be a subset of a finite abelian group with |S|  ≥  3. If S is a Sidon set then κ2(S) = 2|S| - 3.

Let G = 〈S〉. Suppose S is 2-separable, otherwise the result follows by the convention preceding [\eqref=eq:maxkappa].

Suppose against the lemma that κ2(S)  ≤  2|S| - 4. Let A be a 2-atom of S containing 0. We have |A|  ≥  3, since otherwise 2 + κ2(S) = |S + A|  ≥  |S| + (|S| - 1), a contradiction. By Corollary [\ref=cor:2atom], A is either a Sidon set or a subgroup. We have

[formula]

which gives |A|  ≥  |S| + 1  ≥  4.

If A is a Sidon set, then

[formula]

a contradiction.

Suppose that A is a subgroup. Then κ2(S) is a multiple of |A|. In particular, |A|  ≤  2|S| - 4. But then, since |A|  ≥  4,

[formula]

again a contradiction.

The following corollary is a result obtained in a more general context in [\cite=HA00]. The simple proof given here is similar to a proof given in [\cite=SZ].

Let S be a generating set of the finite abelian group G with 0∈S, |S|  ≥  3 and κ2(S) = |S| + m, m  ≥   - 1. Let 0∈A be a 2-atom of S which is not a subgroup of G. Then |A|  ≤  m + 3.

Suppose on the contrary that |A|  ≥  m + 4. By Corollary [\ref=cor:2atom], A is a Sidon set of G. By Lemmas [\ref=Sidon0] and [\ref=lem:sidon], we have κ1(A)  =  |A| - 1 and κ2(A) = 2|A| - 3.

If A generates G then 2|A| - 3 = κ2(A)  ≤  |S + A| - |S| = |A| + m, a contradiction. Therefore we may assume that A generates a proper subgroup Q of G. Let [formula], where j  ≥  2, be the decomposition of S modulo Q. We may assume that [formula] and, by translating S, that 0∈S1.

If |S2 + A|  ≤  |Q| - 1 then,

[formula]

against our assumption. Therefore we may assume that S' + A = S' + Q where [formula].

If |S1| = 1 then, for each 2-subset X of Q, we have [formula] contradicting that A is a 2-atom of S with |A|  ≥  3. Hence |S1|  ≥  2. Now if |S1 + A|  ≤  |Q| - 2 then 2|A| - 3 = κ2(A)  ≤  |S1 + A| - |S1|  ≤  |S + A| - |S| = |A| + m. Hence we may assume |S1 + A|  ≥  |Q| - 1.

Since |S + Q| - 1  ≤  |S' + Q| + |A + S1| = |A + S|  ≤  |G| - 2, we must have S + Q  ≠  G. But in this case,

[formula]

It follows that |A|  ≥  |Q| - 1, which is impossible since A is a Sidon set.

Finally, the following lemma will be useful to us in ruling out the possibility that a 2-atom is a subgroup.

Let 0∈S be a 2-separable subset of a finite abelian group G. Suppose A is a 2-atom of S which is a subgroup of cardinality at least 3. Then there exists s∈S, s  ≠  0, such that the order of s is not more than κ2(S).

Note that if A is a subgroup then κ2(S) is a multiple of |A|. By Lemma [\ref=lem:2surjk] we have [formula] which implies [formula]. Therefore there is a non-zero element s of S in A, and its order is not more than |A|  ≤  κ2(S).

Critical pairs under the weak Chowla condition.

With the previous results we can already prove a critical pair theorem improving on the theorems of Chowla and Vosper. We first state its isoperimetric version. Recall that a subset S of an abelian group G is periodic if there is a nonnull subgroup H of G such that S + H = S. In other words, S is a union of cosets of H.

Let 0∈S be a generating 2-separable subset of a finite abelian group G such that κ2(S)  ≤  |S| - 1. Also assume that every element of [formula] has order at least |S|. Then either S is an arithmetic progression or [formula] is periodic.

By Corollary [\ref=chowla] we have κ1(S) = |S| - 1. Let 0∈A be a 2-atom of S. Assume |S|  ≥  3 otherwise there is nothing to prove. By Lemma [\ref=lem:order], the condition on the order of elements of S implies that A is not a subgroup. But then Corollary [\ref=cor:m+3] implies that we have |A| = 2, say A = {0,r}. Assume first that r generates G. This forces S to be an arithmetic progression with difference r. Assume now that r generates a proper subgroup H. Let [formula], j  ≥  2 be the decomposition of S modulo H. We have [formula], which implies |Si| = |H| for all but one subscript. In particular [formula] since otherwise S contains a nonzero element with order at most |H|  ≤  |S| - 1.

The above theorem will translate into a Chowla-type characterization of sets S and T with small sumset, this will be Corollary [\ref=th:kemperman+0]. The next result is a generalization of Theorem [\ref=th:KK].

By the stabilizer of a subset X of an abelian group G, we mean the set of group elements x∈G such that X + x = X.

Let 0∈S be a generating subset of a finite abelian group G and let 0∈T be a subset of G. Let Q denote the stabilizer of [formula]. Suppose that

[formula]

Also assume that every element of [formula] has order ≥  |S|. Let σ:G  →  G / Q denote the canonical projection. One of the following holds:

either T  ⊂  Q,

or σ(S) and σ(T) are arithmetic progressions with the same difference. Moreover, at most one member of the decomposition of T modulo Q is not a complete coset modulo Q.

Either T = {0} and thus T  ⊂  Q or the conditions on S imply that S is 2-separable and κ2(S)  ≤  |S| - 1. Assume first Q = {0}. By Theorem [\ref=th:kempermannis], S is an arithmetic progression. It follows easily that T is an arithmetic progression with the same difference. Assume now Q  ≠  {0}.

We have |σ(T) + σ(S)|  ≤  |σ(T)| + |σ(S)| - 1. Otherwise there are |σ(S)| cosets in σ(T) + σ(S) not present in σ(T). But all these cosets are saturated in T + S (notice that S* is Q-periodic). It follows that |T + S|  ≥  |T| + |σ(S)||Q| = |T| + |S| + |Q| - 1, a contradiction.

Moreover, the order of every element [formula] is at least ⌈|S| / |Q|⌉ = |σ(S)|. Since the stabilizer of σ(S)*  =  σ(S*) must be {0}, either σ(T) = 0 and T  ⊂  Q or Theorem [\ref=th:kempermannis] in G / Q implies that σ(S) is an arithmetic progression. It follows now that σ(T) is an arithmetic progression with the same difference. Since σ(T) contains at most a single element that is not expressible in G / Q in two different ways as a sum of one element of σ(S) and one element of σ(T), we deduce that at most one coset modulo Q that intersects T is not included in T.

Let 0∈S and T be non-empty subsets of a finite abelian group G. Suppose that

[formula]

where Q denotes the stabilizer of [formula] and H is the subgroup of G generated by S. Also assume that every element of [formula] has order at least |S|. Let [formula] be a decomposition of T modulo H such that

[formula]

Then |Ti| = |H| for all i  ≥  2. Moreover one of the following conditions holds:

T1 - T1  ⊂  Q.

σ(S) and σ(T1) are arithmetic progressions with the same difference, where σ:G  →  G / Q denotes the canonical projection.

By Corollary [\ref=chowla] we have κ1(S) = |S| - 1. If j  ≥  2 we have |T2 + S| = |H| since otherwise,

[formula]

a contradiction. Assume first that 0∈T1. Since |S + T| < |H + T| - |Q|, we have |S + T1| < |H| - |Q|. We have clearly

[formula]

By Proposition [\ref=fragments], either T1  ⊂  Q or σ(S) and σ(T1) are arithmetic progressions with the same difference. Now, if [formula] then the same argument gives T1 - T1  ⊂  Q.

At the heart of the proof of Theorem [\ref=th:kempermannis] was the claim that, under the right conditions, a 2-atom containing the zero element is of cardinality 2 or is a subgroup. In Section [\ref=sec:2atoms] we shall find more general conditions under which we can make the same claim. Before that we need some more tools.

The fainting technique

In this section we use a method developed in [\cite=SZ]. The idea is to consider the sequence of subsets [formula], [formula] and to claim that if A is a 2-atom of S of cardinality |A| > 2, then this sequence must decrease and faint, implying that S is a "large" subset of G.

Let X and Y be subsets of an abelian group G. For each integer i  ≥  0 we denote by

[formula]

where [formula].

In what follows we use the notation [formula]. We start with the two following lemmas.

Let G be an abelian group and let X,Y  ⊂  G with [formula]. If Nr(X,Y) - Y*  ⊂  Nr - 1(X,Y) for some r  ≥  1, then Ni(X,Y) - Y*  ⊂  Ni - 1(X,Y), for all i  ≥  r.

Suppose that the statement holds for all i, r  ≤  i  ≤  j, for some j  ≥  r, and let x∈Nj + 1(X,Y) (if [formula] there is nothing to prove.) By the definition of Nj + 1(X,Y), there is z∈Y* such that x - z∈Nj(X,Y). Now, for every y∈Y*, x - y - z = (x - z) - y∈Nj - 1(X,Y) which implies x - y∈Nj(X,Y). The result follows by induction.

Let 0∈S be a 2-separable subset of a finite abelian group G and let 0∈A be a 2-atom of S with cardinality |A|  ≥  3 which is not a subgroup of G. Then, denoting [formula],

[formula]

Without loss of generality S generates G. The first part of the result is just Lemma [\ref=lem:2surjk]. Now, since A is not a subgroup, we have S + 〈A〉  ≠  S + A, otherwise we would have |S + 〈A〉| - |〈A〉| < |S + A| - |A| in contradiction with A being a 2-atom. Therefore there exists [formula]. Recall that, by Lemma [\ref=lem:dual], the subset x - A is a 2-atom of- S and [formula] is a 2-fragment. Observe that [formula] and that x∈N2(S,A) means x - A is not contained in [formula]: the intersection property of 2-atoms (Lemma [\ref=lem:intersection]) implies therefore that [formula], but this means x - A*  ⊂  N1(S,A).

The following Lemma is a key tool for the proof of the main result of the next section. It says that, under some conditions, a set X verifying the statement of Lemma [\ref=lem:surj] with some other set must be a large subset of the ground group.

Let G be a finite abelian group and let X,Y  ⊂  G with [formula] and set m = |X + Y| - |X| - |Y|. Assume that Y generates G and that

3  ≤  |Y|  ≤  m + 3 and κ1(Y* - y) = |Y*| - 1  ≥  1 for some y∈Y*.

[formula] for each z∈Y and N2(X,Y) - Y*  ⊂  N1(X,Y).

Then

[formula]

Since [formula] for any y∈Y, we have X + Y = X + Y* and X + (Y - y) = X + (Y* - y). By induction on i it is seen that X + i(Y - y) = X + (Y* - y) + (i - 1)(Y - y) = X + i(Y* - y) for each i  ≥  1. Since 0∈Y generates G, we have G = X + n(Y - y) = X + n(Y* - y) where n = |G|. Let H be the subgroup of G generated by Y* - y. One can verify easily that H = n(Y* - y), and hence

[formula]

By Lemma [\ref=commutativity], N2(X,Y) - Y*  ⊂  N1(X,Y) implies

[formula]

Fix y∈Y* satisfying (i). Suppose that there is i  ≥  1 such that [formula] and

[formula]

Since κ1(Y* - y) = |Y*| - 1, the inequality ([\ref=eq:cannot]) means that Ni + 1(X,Y) - (Y* - y) is a union of cosets of the subgroup H generated by Y* - y. In particular H  ≠  G and, by ([\ref=eq:f2]), Ni(X,Y)  ⊃  (Ni + 1(X,Y) - (Y* - y)) + y contains a full coset of this subgroup. However, we have [formula] and, by ([\ref=eq:f1]), X + H = G, a contradiction. Let [formula] be the largest integer for which [formula]. We have just shown that, for each i, [formula],

[formula]

Therefore,

[formula]

Since |N1(X,Y)| = |Y| + m we have |N2(X,Y)|  ≤  m + 2. Hence, since 3  ≤  |Y|  ≤  m + 3, the largest possible value in the right hand side of inequality ([\ref=eq:bm+4]) is taken if |Y| = 3 and [formula] giving

[formula]

as claimed.

We finish this set of preliminary results with the following Lemma.

Let A and S be subsets of a finite abelian group Q. Assume that |A| = 3 and that for each a∈A we have [formula]. Then 3|S|  ≥  2|S + A|.

Write A = {x,y,z}. We have [formula]. It follows that [formula]. Furthermore we must have [formula], therefore [formula]. The result now follows.

Description of 2-atoms

The next theorem gives the structure of the 2-atoms for not too large subsets of an abelian group.

Let G be a finite abelian group and let 0∈S be a generating 2-separable subset of G such that |S|  ≥  3 and

[formula]

Let A be a 2-atom of S containing 0. If [formula] then either |A| = 2 or A is a subgroup of G.

Suppose that the conclusion of the theorem does not hold, so that 0∈A is a 2-atom of S with |A|  ≥  3 which is not a subgroup. Then it follows from Corollary [\ref=cor:2atom] that S is a Sidon set and then, by Lemma [\ref=lem:sidon], κ2(S) = 2|S| - 3  ≥  |S|. In particular m  ≥  0.

By Corollary [\ref=cor:m+3] we have |A|  ≤  m + 3. Moreover, A* - a is also a Sidon set, and Lemma [\ref=Sidon0] implies that A satisfies condition (i) of the Fainting Lemma. By Lemma [\ref=lem:surj], S and A satisfy condition (ii) of the Fainting Lemma: therefore if A generates G its conclusion must hold. In that case we have [formula] against the hypothesis of the Theorem. Therefore A must generate a proper subgroup Q of G. Let [formula] be the decomposition of S modulo Q and [formula]. Put

[formula]

Since |S + A| = |S| + |A| + m, the decomposition of S + A modulo Q gives

[formula]

Now, as mentioned above, A is a Sidon set and by Lemma [\ref=Sidon0], we have κ1(A) = |A| - 1. Therefore |Si + A| - |Si|  ≥  |A| - 1 for i∈V. Notice furthermore that Lemma [\ref=lem:2surjk] implies Si + A = Si + A*, so that |Si|  ≥  2 for each i∈I. Therefore, since by Lemma [\ref=lem:sidon] we have κ2(A) = 2|A| - 3, we have |Si + A| - |Si|  ≥  2|A| - 3 for i∈W. Inequality [\eqref=eq:|S|+|A|+m] gives us

[formula]

In particular we have

[formula]

Now for any i∈I let us write

[formula]

and, for J  ⊂  I, put [formula]. Notice that δ(I) = |S + Q| - |S + A|, δ(U) = 0, δ(V) = v and that we have shown that mi  ≥  |A| - 3  ≥  0 for i∈W. We consider two cases.

Case 1. S + Q  ≠  G.

It follows that, by the minimality in the definition of a 2-atom, |S + Q| - |Q|  ≥  |S + A| - |A|. Therefore,

[formula]

Since A is a Sidon set we have |Q| - |A|  ≥  4 (for example use |Q|  ≥  |A|(|A| + 1) / 2 and rule out the case |A| = 3 and |Q| = 6 by exhaustive search.) By [\eqref=eq:m2] and since δ(V) = v  ≤  3 we have w  ≥  1 which in turn implies v  ≤  2. Now, by the definition of mi and δ(i), we have |Q| = |Si| + |A| + mi  +  δ(i) for all i and inequality [\eqref=eq:|Q|-|A|] can be rewritten as

[formula]

Let i∈W. If |A|  ≥  4 then mi  ≥  |A| - 3  ≥  1 so that |Si| + mi  ≥  3 and, if |A| = 3, then Lemma [\ref=BigS] and mi  ≥  0 give 3|Si|  ≥  2(|Si + A|)  ≥  2(|Si| + |A|) meaning |Si|  ≥  6. In both cases inequality [\eqref=eq:delta(i)] gives δ(W) > δ(i), which implies w  ≥  2.

Returning to ([\ref=eq:m2]) it follows that v = 0, w = 2, |A| = 3 and [\eqref=eq:|S|+|A|+m] gives [formula] We may assume W = {1,2}. Since |Si|  ≥  4 for i∈W, inequality  [\eqref=eq:delta(i)] gives

[formula]

Hence δ(i)  ≥  4 for i = 1,2. Now since m1 + m2  ≤  1 we have, for example, m1 = 0. But the Fainting Lemma applied to S1 and A gives [formula] contradicting |Q| - |S1| = |A| + δ(1)  ≥  7.

Case 2. S + Q = G.

Now |G| = |S + A| + δ(V) + δ(W) and the hypothesis of the theorem reads

[formula]

Since |A|  ≤  m + 3 (Corollary [\ref=cor:m+3]), inequality [\eqref=eq:hypothesis] implies δ(V) + δ(W)  ≥  4, giving w  ≥  1 since δ(V)  ≤  3.

If w = 1, say W = {1}, then [\eqref=eq:hypothesis] translates to

[formula]

If m = m1 then we must have δ(V) = 0 and the right hand side of [\eqref=eq:hypothesis2] equals [formula]. If m1 < m then δ(V) = v  ≤  3 and m1  ≥  0 imply that the right hand side of[\eqref=eq:hypothesis2] is again [formula]. In both cases this contradicts the Fainting Lemma applied to S1 and A.

If w = 2, say W = {1,2}, then ([\ref=eq:m2]) implies |A| = 3, v = 0, 0  ≤  m1 + m2  ≤  1 and m  ≥  3. Then, the Fainting Lemma applied to Si and A, i = 1,2, gives [formula]. By adding up the two inequalities we get

[formula]

But the right hand side is at most 16 while, by [\eqref=eq:hypothesis], the left hand side is at least [formula] a contradiction. This completes the proof.

The following example shows that the result of Theorem [\ref=th:main] does not hold anymore if m = 5.

Take [formula] where q > 7 is a prime. Consider the sets

S = {0,1,2,4}  ×  X where |X| = 4 and X is a Sidon set in [formula] and

A = {0,1,3}  ×  {0}.

Then |S + A| = |S| + |A| + 5. The group G has only two proper subgroups [formula] and [formula] and

[formula]

On the other hand, if B = {0,x} we have

[formula]

The last inequality being because, for any y  ≠  0, [formula] in [formula] since X is a Sidon set. Therefore subgroups and subsets of size 2 are not 2-atoms of S. Furthermore we have κ2(S)  ≥  |S| + 5 since otherwise Theorem [\ref=th:main] would apply: therefore A is a 2-atom of S and κ2(S) = |S| + 5.

Finally, note that Theorem [\ref=th:main] together with Lemma [\ref=lem:order] give a sufficient condition to rule out the possibility of a 2-atom being a subgroup.

Let G be a finite abelian group and let 0∈S be a generating 2-separable subset of G such that |S|  ≥  3 and

[formula]

Also assume that every non zero element of S has order at least |S| + m + 1.

If [formula] then the 2-atoms of S have cardinality 2.

Atoms of small sets

We next show some results about k-atoms of small sets.

Let S be a 4-separable generating subset of a finite abelian group such that 0∈S and κ4(S) = |S| = 3. Let 0∈A be a 4-atom of S. Then |A| = 4.

Let G = 〈S〉. Suppose that |A| > 4. We shall apply the Fainting Lemma to A and S.

We have κ1(S* - z) = 1, for all z∈S*, since κ1(S* - z) > 0.

Take z∈S*. By Lemma [\ref=lem:2surjk] we have [formula] Therefore [formula]. Therefore N1(A,S) - z  ⊂  A = N0(A,S). It follows that

[formula]

By Lemma [\ref=commutativity] we have N2(A,S) - S*  ⊂  N1(A,S).

Now we may apply the Fainting Lemma and obtain |A|  ≥  |G| - 6. But then |A + S|  ≥  |G| - 3 contradicting that A is a 4-fragment of S.

Let 0∈S be a 3-separable generating subset of a finite abelian group G such that κ3(S) = |S| = 4. Assume gcd (|G|,6) = 1. Let A be a 3-atom of S such that 0∈A. Then |A| = 3.

Suppose on the contrary that |A|  ≥  4. Then A is not a subgroup since otherwise |S + A| and κ3(A) are multiples of |A|, so that |A|  ≤  κ3(S)  ≤  4 contradicts gcd (|G|,6) = 1. By Corollary [\ref=cor:2atom] we have

[formula]

In particular,

[formula]

which implies |A|  ≤  5.

Suppose that A generates a proper subgroup H of G and let [formula] be the decomposition of S modulo H. By Lemma [\ref=Sidon0],

[formula]

Choose [formula]. Since |Si|  ≤  3,

[formula]

Therefore, [formula], a contradiction. Hence 〈A〉 = G.

In particular, |S + A| = |S| + |A|  ≤  |G| - 3 implies κ2(A)  ≤  κ3(A)  ≤  |A|. Let 0∈B be a 2-atom of A. Since |A|  ≤  |G| - 7, Theorem [\ref=th:main] implies that B is a subgroup or |B| = 2.

Suppose that B is a subgroup. Then |B|  ≥  5. Let [formula] be the decomposition of A modulo B. We have (j - 1)|B| = |A + B| - |B|  ≤  |A|  ≤  5 which implies j = 2, |A| = |B| = 5 and κ2(A) = |A|. But then S is a set with smaller cardinality than B with |S + A| - |S| = |A|, contradicting the minimality of the 2-atom.

Therefore |B| = 2. Then, using [\eqref=eq:2int1], |A| + |B|  ≥  |A + B|  ≥  |A| + (|A| - 2) = 2|A| - 2 which implies |A| = 4.

Since S is 3-separable, we have [formula]. But we must have [formula] since otherwise, by Lemma [\ref=lem:dual], - S has a 3-atom T with size |T| = 3. This would imply that - T is a 3-atom of S, a contradiction. Since gcd (|G|,6) = 1, we must have [formula]

S* is an arithmetic progression.

Let us write Ni = Ni(A,S), i  ≥  0. Note that |N1| = |S + A| - |A| = κ3(S) = |S| = 4. For each subset X  ⊂  S and for each i  ≥  1, let us denote by NXi the set of elements u∈Ni such that u - X  ⊂  Ni - 1 and X is a maximal subset of S with this property. By the definition, [formula] whenever 0∈X. Moreover, for two different subsets X,Y, we have [formula].

Let X  ⊂  S*, i  ≥  2, and u∈NXi, so that v = u - x∈Ni - 1 for each x∈X. Let Y be the subset of S* such that v∈NYi - 1, implying v - y∈Ni - 2 for each y∈Y. Then u - y = (v - y) + x∈Ni - 1 implies that y∈X. We have just shown that:

[formula]

By Lemma [\ref=lem:2surjk], for each x∈S*, we have [formula], which implies [formula]. By [\eqref=eq:nx1], we have [formula] for each i  ≥  1 as well.

On the other hand, for each x∈S*, inequality [\eqref=eq:2int1] implies

[formula]

so that [formula].

Let us now estimate |NX2| and |NX3| for X  ⊂  S*. Note that by Corollary [\ref=chowla] as κ1(Z) = |Z| - 1 for each subset 0∈Z  ⊂  G with |Z|  ≤  3, since the order of any nonzero element in G is at least 5. Therefore, using [\eqref=eq:nx1], we have

[formula]

Since there are at most two 2-subsets of S* for which |NX1| = 2, we have

[formula]

Since |N1| = 4, then NS*2 - S* cannot be a coset. Therefore, since κ1(S* - s) = |S*| - 1, we have

[formula]

This implies that |NS*2|  ≤  2.

Suppose that |NS*2|  ≤  1. Then [formula] and, by applying [\eqref=eq:nx1] with i = 3 and 4, we get |N3| = |NS*3|  ≤  1 and |N4| = 0. Therefore |N2| + |N3|  ≤  4 < |G| - |S + A|. This means that [formula] and Y + S = Y, which contradicts that S generates G.

Suppose now that |NS*2| = 2. Then |NS*2 - S*| = |S*| + 1 which implies that S* is an arithmetic progression. This proves the claim. Now we have S = {0,a,a + d,a + 2d} for some d∈G. By repeating the argument of the claim to S - a - d we get that { - a - d, - d,d} is an arithmetic progression as well. We cannot have - a - d = 0. Then either - a - d - d = 2d or - a =  - 2d. Hence either S = { - 4d, - 3d, - 2d,0} or S = {0,2d,3d,4d}. But then {0,d,2d} is a 3-atom of S. This contradiction concludes the proof.

Quasi-progressions

A subset S of an abelian group G will be called a quasi-progression of difference r if S is not a progression with difference r and if S can be obtained by deleting an element of an arithmetic progression of difference r.

Let 0∈S be a quasi-progression with difference r in the cyclic group [formula]. Suppose that S generates [formula] and |S|  ≥  3. Let [formula] be such that |T|  ≥  3 and

[formula]

Then one of the following conditions holds:

(i) T is either a quasi-progression with difference r or a progression with difference r.

(ii) n = 12 and T is a coset of order 4.

Put [formula] Observe that S  ⊂  〈d〉 + a. Since 0∈S, we have a∈〈d〉. Then [formula]. Hence without loss of generality we may assume that j  ≥  ⌈|S| / 2⌉ and a = 0. Since d is invertible we can assume it to equal 1. Then we have

[formula]

For a subset [formula] let us call connected components of X the maximal arithmetic progressions with difference 1 contained in X.

Case 1. There is a connected component C1 of [formula] such that |C1|  ≥  |S|.

Then we clearly have [formula]. Furthermore, since {0,1}  ⊂  S, we have [formula] for every connected component C of [formula]. Therefore [formula], and hence T, has at most two connected components. If [formula] we are done. Suppose that [formula] where C2 is the other component of [formula]. Since |T|  ≥  3, one of the two components of T, say T1, has cardinality |T1|  ≥  2. Since S is a quasi-progression, S + T1 is an arithmetic progression of length |S| + |T1|. If |C2|  ≥  2 then we must have either [formula] or [formula], a contradiction. Therefore we must have |C2| = 1, which proves the result.

Case 2. For every connected component C of [formula], |C|  <  |S|.

It follows that every connected component C of [formula] has size 1. Then [formula] is the number of connected components of [formula]. Then |S + T|  ≥  |T|  +  q(j - 1)  ≥  |T|  +  q(⌈|S| / 2⌉ - 1). Since q  ≥  4, we must have q = 4, |S| = 4 and j = 2, i.e. S = {0,1,3,4}.

If [formula] is a connected component of T, then [formula]. Since |S + T|  ≤  |S| + 4, it follows that T has exactly 4 components, and for each such component U, v + 2∉S + T but v + 3∈T. Thus v - 1∉U, and each component of T has exactly one element. This shows that |T| = 4 and hence n = 12.

S = {0,1,3,4}  =  {0,1}  +  {0,3}. Now [formula] consists of 4 single-element components. It follows that [formula] Therefore [formula]. It follows that [formula] is a union of cosets modulo the subgroup H generated by 3. Therefore [formula] is an H-coset.

Let S and T be subsets of [formula] such that |S| = 3, |T| = 4 and |S + T| = 7. Then S is either a progression or a quasi-progression.

The proof is an easy exercise.

Let S be a 4-separable generating subset of an abelian group G of order n such that 0∈S, |S|  =  3 and κ4(S) = |S| = 3. Assume moreover that gcd (n,6) = 1. Then G is a cyclic group and S is a quasi-progression.

Improving both the Theorems of Chowla and of Vosper

Next we shall generalize Theorem [\ref=th:kempermannis] to the case when |S + T|  ≤  |S| + |T|. Our result is also a generalization to abelian groups of Theorem [\ref=th:HR], i.e. the main result of [\cite=HR]. Let us state it first under an isoperimetric formulation. Let us call a set quasi-periodic if it can be obtained by deleting one element from a periodic set.

Let 0∈S be a generating subset of a finite abelian group G with gcd (|G|,6) = 1 and 4  ≤  |S|  ≤  |G| - 7. Assume S to be 3-separable and κ3(S) = |S|.

If every element of [formula] has order at least |S| + 1, then either S is a quasi-progression or [formula] is quasi-periodic.

Denote by [formula]. Let 0∈A be a 3-atom of S.

The result holds if A generates a proper subgroup K of G.

Assume first that A = K. In this case κ3(S) is a multiple of |A| and hence |S|  ≥  |A|. It follows that [formula], since otherwise A would contain an element of order at least |S| + 1. Now S + A is the disjoint union [formula]. Hence |S* + A| = |S*| + 1 so that S* is quasi-periodic and the result holds.

Therefore we may assume that A  ≠  K. Decompose [formula], j  ≥  2, modulo the subgroup K. We may assume 0∈S1 and [formula] By Corollary [\ref=cor:2atom] and Lemma [\ref=Sidon0],

[formula]

It follows that |Si + A| = |K| for each i  ≥  2. If K + S = G then |S + A|  ≤  |K + S| - 3 so that |S1 + A| < |K|. If K + S  ≠  G then, by the definition of κ3, |S + K|  ≥  |S| + |K| > |S| + |A| = |S + A| and we also have also have |S1 + A| < |K|. It follows from [\eqref=eq:|S_i+A|] that [formula], which implies that [formula] is quasi-periodic. In particular we have |S|  ≥  |K|, which implies that S1  =  {0} and S* is quasi-periodic. This completes the proof of the claim.

We may therefore assume that A generates G. We now consider three cases.

Case 1. |A| = 3.

In that case A is 4-separable and κ4(A)  ≤  |A|. If κ4(A) < 3, then Theorem [\ref=th:kempermannis] implies that A is a progression and thus S is a quasi-progression. If κ4(A) = 3, then by Lemma [\ref=lem:|T|=3], A is a quasi-progression. By Lemma [\ref=lem:transfer], S is a quasi-progression.

Case 2. |A| = 4.

In that case A is 3-separable and κ3(A)  ≤  |A|. If κ3(A) < 4, then Theorem [\ref=th:kempermannis] implies that A is a progression and thus S is a quasi-progression. If κ3(A) = 4 then consider a 3-atom B of A containing 0. By Lemma [\ref=lem:|A|<=3], |B| = 3. Observe that B generates G, otherwise gcd (|G|,6) = 1 implies |A + B|  ≥  |A| + 4 > |A| + |B|. The set B is 4-separable and κ4(B)  ≤  |B|. If κ4(B) < 3 then B is a progression by Theorem [\ref=th:kempermannis], thus A, and hence also S are quasi-progressions. If κ4(B) = 3, then by Lemma [\ref=lem:|T|=3], B is a quasi-progression. By Lemma [\ref=lem:transfer] applied twice we conclude that A and S are quasi-progressions.

Case 3. |A|  ≥  5.

By Corollary [\ref=cor:2atom], for every [formula] we have

[formula]

Let B be a 2-atom of A containing 0. If |B| = 2 then |A| + |B|  ≥  |A + B|  ≥  |A| + (|A| - 2) which implies |A|  ≤  4. Hence we have |B|  ≥  3. By Theorem [\ref=th:main], B is a subgroup of G. We have

[formula]

and hence |A|  ≥  κ2(A)  ≥  |B|  ≥  2|A| - 6. Since gcd (|G|,6) = 1, these inequalities force |A| = |B| = 5. It follows that |A + B| = 2|B| and A has a B-decomposition [formula] We have |Ai|  ≤  3, since otherwise [formula] for each [formula], a contradiction. Without loss of generality , we may assume 0∈A0, |A0| = 3 and |A1| = 2.

Decompose [formula] modulo the subgroup B.

Assume first S + B = G. Let [formula] By Corollary [\ref=chowla], we have

[formula]

In particular |V|  ≤  2. Note that |A + S|  ≤  |G| - 5 since otherwise [formula] is a 3-fragment of - S and - C a 3-fragment of S with |C| < |A|. Since |Si + B| - |Si + A0|  ≤  2, we have |V|  ≥  3, a contradiction.

Assume now S + B  ≠  G. Since |A| > 3, Lemma [\ref=lem:|A|<=3] implies |S|  ≥  5 = |B|. Therefore [formula] since every element of S* has order at least |S| + 1.

Since A generates G we have [formula]. Therefore, there is an i such that [formula] Now [formula] contains the disjoint union [formula] But |W|  ≥  |A| - 1. It follows easily that [formula] is periodic or quasi-periodic. The first possibility is excluded by the condition κ3(S) = |S|.

Theorem [\ref=th:kempermannis+1] translates into a characterization of subsets S and T such that |S + T|  ≤  |S| + |T| under some Chowla-type conditions. This was our final goal in this paper.

Let G be a finite abelian group with gcd (|G|,6) = 1.

Let 0∈S be a generating subset of G such that |S|  ≥  4 and every element in S* has order at least |S| + 1. Let Q be a maximal subgroup such that |S* + Q| - |S*|  ≤  1 and let σ:G  →  G / Q denotes the canonical projection.

Let T be a subset of G such that |T|  ≥  3 and suppose that |S + T| = |S| + |T|  ≤  |G| - 4. Then the following holds:

If Q = {0} then S and T are progressions or quasi-progressions with the same difference.

If Q  ≠  {0}, |σ(T)|  ≥  2, and |σ(S + T)| < |G| / |Q| - 1 then σ(S) and σ(T) are arithmetic progressions with the same difference. Moreover we have [formula] where T1 is a subset of T such that σ(T1) is a single, extremal element of the progression σ(T). Furthermore if 0 is not an extremal element of the progression σ(S), then |T + Q|  ≤  |T| + 1.

Case 1: Q = {0}. The conditions |S| + |T| = |S + T|  ≤  |G| - 4 and |T|  ≥  3 imply that S is 3-separable and that κ3(S)  ≤  |S|. By Theorems [\ref=th:kempermannis] and [\ref=th:kempermannis+1], S is an arithmetic progression or quasi-progression. By Lemma [\ref=lem:transfer] it follows that T is an arithmetic progression or quasi-progression with the same difference.

Case 2: Q  ≠  {0}. Since |S|  ≥  q = |Q| and each element in S has order at least |S| + 1, we have [formula]. In particular, σ(S)*  =  σ(S*). Note that each element in σ(S)* has order at least (|S| + 1) / q  ≥  |σ(S)| - 1 + 1 / q.

Corollary [\ref=chowla] implies

[formula]

First notice that

[formula]

This holds clearly if S* is Q-periodic. So we may assume |S* + Q| - |S*| = 1. Let us then denote by S1 the unique subset of S of size |Q| - 1 in the decomposition of S modulo Q. If Σ is not Q-periodic then some Q-coset must have a trace U of size |Q| - 1 on the set Σ, and we have U = S1 + T' where [formula], for some a. Since |S1| = |Q| - 1 we must have |T'| = 1. Note also that σ(S1) + σ(T') cannot be obtained in any other way as a sum of an element of σ(S) and of an element of σ(T), therefore [formula], hence [formula], but this contradicts κ1(S) = |S| - 1 (Corollary [\ref=chowla]) and proves [\eqref=eq:Qperiodic].

We therefore have:

[formula]

otherwise [\eqref=eq:withcor8] implies |S + T|  ≥  |T|  +  |σ(S)||Q| > |T| + |S| a contradiction.

By our assumptions, Q is a maximal subgroup such that |S* + Q| - |S*|  ≤  1. This is easily seen to imply that σ(S*) is not periodic. Moreover, each element in σ(S)* has order at least (|S| + 1) / q  ≥  |σ(S)| - 1 + 1 / q. Then, by Proposition [\ref=fragments], σ(S) and σ(T) are arithmetic progressions with the same common difference d. Since - d is also a difference of σ(S) and σ(T), we may assume without loss of generality that the terminal element u of σ(S) is not 0. Therefore if we set [formula] we have |S'|  ≥  |Q| - 1. Let us suppose, without loss of generality, that the initial element of σ(T) is 0.

To conclude we prove the following:

Let B  ⊂  G be such that σ(B) is an arithmetic progression of difference d and initial element 0, and with |σ(B)|  ≤  |σ(T)|. Let [formula] and set [formula]. Suppose that |S + B| = |S| + |B| - ε where ε equals 0 or 1. Then |B2 + Q|  ≤  |B2| + 1 - ε.

The claim is proved by induction on t = |σ(B)|. If |σ(B)| = 1 then [formula] and there is nothing to prove. If |σ(B)|  ≥  2, then let b be the terminal element of σ(B) and set [formula]. Then, since κ1(S) = |S| - 1:

[formula]

From [\eqref=eqFINAL] we obtain, since |S'|  ≥  |Q| - 1, |B'|  ≥  |S' + B'| - 1  ≥  |Q| - 2  ≥  5 - 2 = 3. Hence, since |S'| + |B'| > |Q|, we have S' + B' = Q. Applying [\eqref=eqFINAL] again we also have |S' + B'|  ≤  |B'| + 1 - ε, hence

[formula]

By [\eqref=eqFINAL] we have

[formula]

Now either |B'| - |S' + B'| = 0 and the result holds by the induction hypothesis applied to [formula]: or |B'| - |S' + B'| =  - 1. But in this case [\eqref=eq:new] implies ε = 0, and the result again holds by applying the induction hypothesis to [formula] with [formula]. This proves the claim and the theorem with [formula].

To complete the proof, consider the case when 0 is not an extremity of σ(S). Then the claim applied to S and T by permuting initial and terminal elements of σ(S) and σ(T) gives |T1|  ≥  |Q| - 1, so that every non-empty intersection of T with a coset of Q has cardinality at least |Q| - 1. In particular, S* + T is Q-periodic. Since 0 is not an extremal element of σ(S) and |σ(T)|  ≥  2 we obtain σ(S*) + σ(T) = σ(S) + σ(T) so that S + T is also Q-periodic. By [\eqref=eq:noname] we have |T + Q|  ≤  |T| + 1.

Remark. One may wonder what happens if we remove from Theorem [\ref=th:kemperman+1] the hypothesis |σ(S + T)| < |G| / |Q| - 1. Then the sets σ(S) and σ(T) are not necessarily arithmetic progressions any more. However, one may show that there again exists T1  ⊂  T, such that |σ(T1)|  ≤  1 and [formula] is Q-periodic or Q-quasi-periodic. We leave out the details.

Acknowledgements

The authors are grateful to an anonymous referee for his/her careful reading and very valuable suggestions and remarks.