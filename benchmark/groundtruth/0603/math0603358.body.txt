On the Representation of integers by quadratic forms

Introduction

Let [formula] and let [formula] be a non-singular quadratic form, with discriminant ΔQ. Given a non-negative integer k, this paper is concerned with the locus of points

[formula]

Our basic motivation is the problem of deciding whether or not [formula] is empty, for given k and Q. We shall address this question in two rather different contexts: firstly when Q is indefinite and k = 0, and secondly, when k is large and Q is positive definite. Throughout this paper we shall work with classically integral quadratic forms Q. Thus there is a symmetric matrix [formula], with coefficients in [formula], such that

[formula]

and [formula]. We shall write

[formula]

for the height of the quadratic form Q. We are now ready to discuss the decidability question for [formula], for which we distinguish between the indefinite and positive definite cases.

Indefinite forms

In this section we consider the problem of deciding when a given indefinite quadratic form represents zero. Now it is well-known that the Hasse-Minkowski theorem gives a finite procedure for determining whether or not the set

[formula]

is empty. An alternative procedure arises from providing an effective upper bound for the maximum modulus of the smallest element of [formula], in terms of the coefficients of Q.

Let Λn(Q) be minimal with the property that when [formula] is non-empty, it contains an element with [formula]. Here, as throughout our work, we take [formula] to be the norm [formula], for any [formula]. In this context there is a rather old result due to Cassels [\cite=cassels], which shows that

[formula]

with [formula] A simpler proof of [\eqref=55] has been given by Davenport [\cite=dav-hermite], with the sharper value [formula] for the constant cn. Here, γm is Hermite's constant, defined as the upper bound of the minima of all positive definite quadratic forms in m variables, of determinant 1. While the precise value of the constant cn in [\eqref=55] is perhaps unimportant, the exponent of [formula] has much more significance. In fact it was shown to be best possible by Kneser [\cite=cassels'], via the ingenious example

[formula]

for any integer [formula]. It is self-evident that Q0 is a non-singular indefinite quadratic form, with height [formula]. Moreover we clearly have [formula], where

[formula]

A little thought reveals that [formula] is the unique solution to the equation Q0 = 0, with least norm and positive first component. On noting that [formula], since [formula], we therefore conclude that the exponent of [formula] in [\eqref=55] is, in general, best possible.

The first goal of this paper is to show that Cassels' exponent can be sharpened substantially when suitable assumptions are made about the form Q. That such improvements are available already follows from the work of Schlickewei [\cite=schl]. Given a positive integer [formula], it is shown in this work that there is a constant n > 0 depending only on n, such that

[formula]

provided that Q vanishes on a d-dimensional subspace of [formula]. One retrieves [\eqref=55] by taking d = 1 in this inequality. In our present work we shall derive alternative hypotheses under which the exponent of Cassels can be beaten. Suppose for the moment that Q is diagonal, with ΔQ  ≠  0, so that

[formula]

for non-zero [formula] not all of the same sign. In particular we now have [formula] and [formula]. In this setting it is worth drawing attention to the work of Ou and Williams [\cite=ou], who have shown that if the equation Q = 0 is non-trivially soluble in integers [formula], then there is a solution satisfying

[formula]

In view of the fact that [formula], for [formula], this result implies that

[formula]

for any indefinite quadratic form of the shape [\eqref=Q]. Thus not only do we get an improvement over [\eqref=55] in the value of the constant, but we also get an improvement over the term [formula], if the coefficients of Q don't all have the same order of magnitude. It seems to be an open question whether or not there exists a version of [\eqref=55], for arbitrary indefinite quadratic forms, in which the constant cn is actually independent of n.

One obvious way of beating Cassels' bound for large values of n arises through setting n - 5 of the variables equal to zero, and then applying [\eqref=55] to the resulting form. In view of Meyer's theorem this form is guaranteed to have at least one non-trivial solution provided that it is indefinite, so that Cassels' inequality is applicable. Note that a quinary quadratic form of rank at most 4 trivially represents zero. That the procedure of eliminating n - 5 of the variables is not always available, is demonstrated by Kneser's example above. The form [formula] is negative definite for any choice of [formula]. It is not hard to see, however, that this procedure will always be successful for diagonal indefinite quadratic forms. Thus, given any quadratic form of the shape [\eqref=Q], with [formula] and [formula] non-zero and not all of the same sign, it is always possible to set n - 5 of the variables equal to zero in such a way that the resulting quinary form is indefinite. This rather simple observation, that was drawn to the authors' attention by Professor Heath-Brown, leads to the following improvement of [\eqref=55] for diagonal quadratic forms in at least five variables.

Let [formula] and assume that [formula] is a diagonal indefinite quadratic form. Then we have

[formula]

Here, rather than applying [\eqref=55] in the case n = 5, we have instead employed the inequality [\eqref=o-w] of Ou and Williams to get an even sharper result. Returning to the general case, let [formula] and let [formula] be a non-singular indefinite quadratic form, with underlying matrix [formula]. There does not appear to be a very clean description of the general class [formula], say, of all quadratic forms for which one may set n - 5 of the variables equal to zero in such a way that the resulting quinary form is indefinite. This is unfortunate, since it is clear from our argument above that [formula], for any Q∈. We shall say no more about the class [formula] here, save to observe that a necessary condition for the form Q to be contained in [formula] is that the set of all principal minors of [formula], with [formula] removed, should contain elements of opposite sign. Instead, we shall adopt a rather different approach.

Let us define [formula] to have the property that when there is a vector [formula] for which [formula] and x1  ≠  0, then there exists such a vector with [formula]. In particular it is plain that we always have [formula]. Let [formula] denote the eigenvalues of [formula], and define

[formula]

to be the minimum modulus of these eigenvalues. We shall occasionally appeal to the well-known inequality

[formula]

from which it follows that [formula]. The following result is our main contribution to the theory of indefinite quadratic forms.

Let [formula] and assume that [formula] is an indefinite quadratic form, with discriminant ΔQ  ≠  0. Then we have

[formula]

for any ε > 0, where

[formula]

and

[formula]

All of the implied constants that appear in our work are effectively computable. They will be permitted to depend at most upon n. Any further dependence will be explicitly indicated by appropriate parameters in subscript. As will become apparent at the close of § [\ref=2], one may actually take βQ = 0 in the theorem for a rather less restrictive class of quadratic forms.

It is interesting to place Theorem [\ref=c] in the context of our discussion of Kneser's quadratic form Q0. This form has discriminant of modulus 1, and height [formula]. Moreover, it turns out that m(Q0)  ≫  c2 - 2n, in the notation of [\eqref=min-Q]. To see this we follow an argument suggested to us by Professor Heath-Brown. It begins with the observation that Q0 has underlying matrix [formula], where [formula], [formula], and [formula] is the matrix with c's just below the diagonal and zero everywhere else. But then [formula], and it is not hard to see that the maximum modulus of any element of the matrix [formula] is O(c2n - 2). Thus, if [formula] are the eigenvalues of [formula], it follows from [\eqref=eigen] that [formula]. This establishes the claim that m(Q0)  ≫  c2 - 2n, and we may now put all of this together to deduce from Theorem [\ref=c] that

[formula]

This is, as was to be expected, weaker than the inequality implied by [\eqref=55].

At first glance, it is perhaps not obvious that Theorem [\ref=c] ever improves upon Cassels' result. To see that it does, it will be convenient to derive a weaker version of Theorem [\ref=c], in which the term m(Q) does not appear. It follows from [\eqref=eigen] that [formula]. Once inserted into Theorem [\ref=c], this yields the following result.

Let [formula] and assume that [formula] is an indefinite quadratic form, with discriminant ΔQ  ≠  0. Then we have

[formula]

for any ε > 0, where αn is given by [\eqref=parity] and βQ is given by [\eqref=8-q].

Suppose for the moment that [formula] is chosen so that [formula], and that ΔQ is odd and square-free. Then it follows from Corollary [\ref=cor2] that we get a saving over Cassels' bound for Λn(Q) as soon as

[formula]

In particular we must have [formula], since [formula]. As is well-known, the discriminant of a generic quadratic form has the same order of magnitude as the nth power of its height. Thus, for typical indefinite quadratic forms, one should be able to take θ = n in the above analysis. In this favourable setting we get a decent saving over the bound of Cassels as soon as [formula].

Whereas we have so far only been interested in Theorem [\ref=c] on the grounds that [formula], the quantity [formula] has actually received significant attention in its own right. Thus Masser [\cite=masser] has drawn upon the proof of [\eqref=55] to show that

[formula]

for arbitrary indefinite quadratic forms Q. By adapting Kneser's example, Masser also shows that the exponent n / 2 is best possible. It is somewhat surprising that the condition x1  ≠  0 inflates the corresponding exponent of Cassels by 1 / 2. In this setting, our estimates for [formula] have rather more currency than those for Λn(Q) did, since there is now no analogue of the argument that was used to prove Theorem [\ref=diag]. In particular we can show that Masser's estimate is not best possible for diagonal indefinite quadratic forms, as given by [\eqref=Q]. For such forms, the set of eigenvalues [formula] coincides precisely with the set of coefficients [formula]. We may therefore employ the lower bound [formula], together with the fact that [formula], in order to deduce the following trivial consequence of Theorem [\ref=c].

Let [formula] and assume that [formula] is a diagonal indefinite quadratic form, with discriminant ΔQ  ≠  0. Then we have

[formula]

for any ε > 0, where αn is given by [\eqref=parity] and βQ is given by [\eqref=8-q].

It is not hard to check that Corollary [\ref=cor1] improves upon Masser's bound [\eqref=98] when [formula] if ΔQ is odd and square-free, and when [formula] in general. In fact the improvement is quite substantial, suggesting a limiting exponent of 2 as n gets large.

Positive definite forms

In this section we turn to the second major theme of this paper. Given a positive definite quadratic form [formula], we are now interested in determining whether or not [formula] is empty, when k is large. An obvious necessary condition for [formula] to be non-empty is that the congruence

[formula]

should be soluble for every prime power pt. Let us say that the pair k,Q satisfies the "weak local solubility condition" if this occurs. We shall usually just write "(k,Q) satisfies weak LSC", for short. It is natural to question whether [formula] is automatically non-empty for any pair k,Q satisfying the weak local solubility condition. The answer to this is negative, as demonstrated by the quadratic form

[formula]

This example is due to Watson [\cite=W']. It is not hard to check that (k,Q1) satisfies weak LSC, but that the equation [formula] is insoluble for large odd values of k. It is at this point that the work of Tartakowsky [\cite=tart] enters the picture. Define

[formula]

and

[formula]

Then under the assumption that [formula], he has shown that [formula] is finite.

Tartakowsky's argument does not lead to any estimate for the cardinality of [formula], and the problem of finding an effective upper bound for this quantity has since been considered by several authors. One of the most impressive results in this direction is due to Watson [\cite=W], giving that

[formula]

Note that a positive definite quadratic form is automatically non-singular, and furthermore, we trivially have [formula]. It should be clear from [\eqref=eg1] that Watson's bound is best possible for [formula], as we have k  ≫  ΔQ1 here. Hsia and Icaza [\cite=h-i] have since provided the estimate

[formula]

for [formula], in which the implied constant is made completely explicit. This is sharper than [\eqref=8-watson] when n = 5 or n = 6.

In the intermediate case [formula], Watson obtains sharper bounds in the special case of diagonal quadratic forms. In fact his approach to the problem is to first handle the case of diagonal forms through a classical application of the circle method, before then combining these results with a diagonalisation process to handle the general case. This is somewhat wasteful and our approach to the problem will involve handling the case of general quadratic forms directly. It transpires that our method is most effective when the height [formula] of Q is small compared to ΔQ, whereas Watson's method is best when [formula] is large compared to ΔQ. By merging the two approaches we shall succeed in beating Watson's bound when [formula].

Let [formula] and assume that [formula] is a positive definite quadratic form. Then we have

[formula]

for any ε > 0, where

[formula]

In order to facilitate comparison between Theorem [\ref=iterate] and the bounds in [\eqref=8-watson] and [\eqref=8-hi], we have calculated approximate values for the exponents in the following table:

One easily checks that both of the exponents 5 / (n - 4) + 1 / n and φ(n) are strictly less than 1 for [formula]. Moreover the bound of Hsia and Icaza is the best available for n = 5 and n = 6, but is weaker than Theorem [\ref=iterate] for [formula]. Inspired by our results in the previous section, it might be expected that sharper bounds are available for [formula] when the height of Q is not too large compared to the discriminant. The following result shows that this is indeed the case.

Let [formula] and assume that [formula] is a positive definite quadratic form. Then we have

[formula]

for any ε > 0.

Let [formula] denote the n successive minima of Q. If Q is Minkowski reduced, in the sense of Watson [\cite=W'], for example, then it follows that

[formula]

In view of the fact that the set [formula] is left invariant under any unimodular transformation, it is not hard to see that the statement of Theorem [\ref=8-w'] remains true with [formula] replaced by Σn. This gives a version of the result that is independent of the particular choice of coordinates. For a typical quadratic form Q one expects Σn to have order of magnitude |ΔQ|1 / n. This yields

[formula]

in Theorem [\ref=8-w']. Not only does this improve on [\eqref=8-watson] for every [formula], it does so by quite an ample margin.

It is natural to ask about the corresponding situation for smaller values of n. When n = 3, Duke [\cite=duke] has used the theory of weight [formula] modular forms to tackle the problem. Specifically, he has shown that there exists an absolute constant c > 0 such that if k is square-free, with k > c|ΔQ|337, then the equation Q(X1,X2,X3) = k has an integral solution provided that (k,Q) satisfies weak LSC. Here, the constant c is ineffective, since it arises out of an application of Siegel's lower bound for L(1,χ).

When n = 4, it turns out that stronger assumptions are needed to ensure the solubility of Q(X1,X2,X3,X4) = k. Consider the positive definite quadratic form

[formula]

Watson [\cite=W'] has observed that by taking k = 3  ×  72u, for [formula], one can show that the set [formula] is infinite. Hence a stronger local solubility condition is needed to treat the case n = 4. Let

[formula]

and let [formula] be a positive definite quadratic form. Then we shall say that the pair k,Q satisfies the "strong local solubility condition", usually written "(k,Q) satisfies strong LSC" for short, if for every prime p there exists [formula] such that

[formula]

We shall occasionally say that "(k,Q) satisfies strong LSC modulo p" if this congruence has a solution for that particular choice of prime p. We now define the set

[formula]

and the corresponding quantity

[formula]

Clearly [formula] is finite for [formula], since [formula]. The corresponding result for n = 4 is due to Fomenko [\cite=fom] and uses the theory of modular forms. Schulze-Pillot [\cite=s-p] has since refined the argument, obtaining

[formula]

for a quantity [formula] similar to [formula], where N denotes the level of Q. It should be noted that Schulze-Pillot's bound is completely explicit, and that he achieves finer estimates under the assumption that N is square-free. The essential difference between [formula] and [formula] is that there should be primitive local solutions everywhere. This is implied by our strong local solubility conditions [\eqref=ganga], whence [formula]. Hanke [\cite=hanke] has also used a modular forms interpretation to examine a quantity similar to [formula], but the estimate he arrives at is too complicated to state here. Again, an alternative local solubility condition is employed, which differs from both Schulze-Pillot's and ours. It corresponds to assuming weak LSC, together with an extra local condition on k for those primes p such that Q is anisotropic modulo p. Our approach leads us to the following result.

Let [formula] and assume that [formula] is a positive definite quadratic form. Then we have

[formula]

for any ε > 0.

Take n = 4 in the statement of Theorem [\ref=w]. Then, using the fact that the set [formula] is left invariant under any unimodular transformation, together with the basic property [formula] satisfied by any Minkowski reduced quadratic form Q, we deduce the following result.

Let [formula] be a positive definite quadratic form. Then we have

[formula]

for any ε > 0.

Returning to the generic setting, for which [formula], it follows from Theorem [\ref=w] that [formula] for typical positive definite quadratic forms in [formula] variables. In particular we have the sharper bound [formula] for generic quaternary forms Q.

Outline of the paper

The underlying tool in this paper is a modern form of the Hardy-Littlewood circle method, due to Heath-Brown [\cite=HB']. This will be discussed in more detail in the following section. In § [\ref=pf-iterate], which is essentially independent of the circle method, we shall undertake the proof of Theorem [\ref=iterate]. This part of the paper involves a delicate reduction argument which allows one to study the equation Q = k under stronger local solubility assumptions, thereby permitting an application of Theorem [\ref=w], rather than the obvious application of Theorem [\ref=8-w']. Once combined with Watson's proof of [\eqref=8-watson], this will be enough to furnish the statement of Theorem [\ref=iterate].

Our use of the circle method begins in earnest in § [\ref=act]. In fact we shall use it to establish an asymptotic formula for the number of [formula] such that [formula] which are constrained to lie in a certain expanding region. A crucial feature of our asymptotic formula is that its dependence upon the coefficients of Q needs to be made completely explicit. Indeed, we will then be able to determine precise conditions on the size of the region (resp. the size of k) needed to ensure that [formula] is non-empty, as required for Theorem [\ref=c] (resp. Theorems [\ref=8-w'] and [\ref=w]). This requires an appreciable amount of work, since the formulation of the method given by Heath-Brown [\cite=HB'] pays no attention to the question of uniformity in the coefficients of the quadratic form.

A further obstacle that we'll need to deal with, and which marks another departure from the usual applications of the circle method, emerges in the treatment of the singular series [formula]. Thus we will need to bound [formula] away from zero uniformly in terms of k and the coefficients of Q. While the obvious approach for doing this would undoubtedly give something here, we have adopted a rather more sophisticated argument in § [\ref=ss], and the bounds obtained are actually quite sharp.

Throughout this paper we shall write [formula] for the n-fold repeated integral of [formula] over [formula]. Given [formula], a sum with a condition of the form [formula] will mean a sum taken over [formula] such that the components of [formula] run from 0 to q - 1. Finally, for any [formula] we shall write e(α): = e2πiα and eq(α): = e2πiα / q.

Preliminaries

In this section we shall collect together the main ingredients in the proofs of Theorems [\ref=c], [\ref=8-w'] and [\ref=w]. Let [formula] and let [formula] be a non-singular quadratic form of discriminant ΔQ, with underlying matrix [formula]. Let [formula] be an orthogonal matrix that diagonalises [formula], which we regard as being fixed throughout this paper. Then there exist [formula], such that

[formula]

and [formula]. In particular, we have [formula], and since [formula] are merely the eigenvalues of [formula], [\eqref=eigen] clearly holds.

Given an arbitrary polynomial [formula], and a bounded function [formula] of compact support, we define the weighted counting function

[formula]

for any [formula]. Here, the summation is taken over all [formula] for which [formula]. Our proof of Theorem [\ref=c] is based upon an analysis of the asymptotic behaviour of Nw(Q;B), as B  →    ∞  , for a suitable w. Likewise, to prove Theorems [\ref=8-w'] and [\ref=w] we shall study the counting function Nw(Q - k;k1 / 2), as k  →    ∞  . The quantities Nw(Q;B) and Nw(Q - k;k1 / 2) have received considerable attention over the years, and several methods have been developed to study them. The method that we shall employ is based upon the new form of the Hardy-Littlewood circle method, due to Heath-Brown [\cite=HB']. Using this version of the circle method, Heath-Brown has established the existence of a non-negative constant cw(k,Q) such that

[formula]

provided that [formula] and w belongs to a certain class of weight functions. Similarly, for [formula] and the same class of weights w, he shows that there is a non-negative constant cw(Q) such that

[formula]

In order to discuss the two cases simultaneously, it will be convenient to think of the case k = 0 as corresponding to a study of Nw(Q;B), as B  →    ∞  , and the case k > 0 as corresponding to a study of Nw(Q - k;k1 / 2), as k  →    ∞  . In either case we may therefore refer to the counting function Nw(Q - k;B), for [formula], with the understanding that B = k1 / 2 when we are in the case k > 0. On assuming that [formula] in the case k = 0, we may combine Heath-Brown's estimates to deduce that

[formula]

for a suitable constant [formula], where

[formula]

As indicated above, the central component in our work is a finer version of [\eqref=hb], in which the dependence upon the coefficients of Q is made completely explicit. On establishing a suitable lower bound for the constant cw(k,Q), it will then be possible to determine precise information about the size of B that is needed to ensure that Nw(Q - k;B) > 0.

The constant cw(k,Q) may be interpreted as a product of local densities, and we proceed to discuss it in more detail. For any prime p, the p-adic density of solutions is defined to be

[formula]

where

[formula]

When this limit exists, the singular series is given by

[formula]

We shall set [formula]. It transpires that [formula] is always convergent for the quadratic forms considered here. Let us write

[formula]

for any prime power pt. It follows from a simple application of Hensel's lemma that

[formula]

for any [formula], where τp is given by [\eqref=sangram]. We shall make use of this inequality at several points of our argument.

In order to introduce the singular integral, it will be convenient to define the polynomial [formula] according to the rule

[formula]

In particular we clearly have [formula], whether or not k is zero. Then for any infinitely differentiable function [formula] of compact support [formula], such that [formula] on the closure of [formula], the corresponding singular integral is defined to be

[formula]

This limit exists, and moreover is positive if w takes a positive value for some real solution [formula] of [formula], by the first part of [\cite=HB']. One should think of σ∞(w;PQ) as giving the real density of solutions, weighted by w. With these definitions in mind, we then have [formula] in [\eqref=hb].

Before revealing our uniform version of [\eqref=hb], we must first decide upon the choice of weight function that we shall work with. Consider the function [formula], given by

[formula]

Then w0 is infinitely differentiable with compact support

[formula]

N(Q-k;B) = B+ O QB,

[formula]

(k,Q) ≫ |Δ|,

[formula]

(k,Q) ≫ k|Δ|.

[formula]

B≫ |Δ| Q.

[formula]

≫ max{|λ|} |Δ| Q.

[formula]

k ≫ |Δ| Q,

[formula]

A hybrid approach to Theorem [\ref=iterate]

The purpose of this section is to deduce the statement of Theorem [\ref=iterate] from Theorem [\ref=w]. Throughout this section let [formula], and let [formula] be a positive definite quadratic form of discriminant ΔQ. As we have already mentioned, the sets [formula] and [formula] are left invariant under any unimodular transformation, since [formula] is non-empty if and only if [formula] is non-empty, for any Q' that is equivalent to Q.

We begin by recording a simple calculation for the number of solutions to a quadratic congruence modulo an odd prime p. Given integers [formula], and any odd prime p, we define

[formula]

where [formula] The following result ought to be well-known, but we have included our own proof for the sake of completeness.

Suppose that [formula]. Then we have

[formula]

where [formula] and

[formula]

In order to study Mr(p), we write

[formula]

Since [formula], the innermost sum is a Gauss sum and so takes the value [formula]. Thus we obtain

[formula]

Once combined with the well-known equalities

[formula]

we easily conclude the proof of Lemma [\ref=mr].

We are now ready to commence the proof of Theorem [\ref=iterate]. Our first step is a certain reduction argument that will render it sufficient to examine the solubility of the equation Q = k under stronger local solubility assumptions. Recall the statement [\eqref=ganga] of strong LSC modulo a prime p, and the definition [\eqref=sig-p] of σp(k,Q). Then we have the following result.

Assume that [formula] and (k,Q) satisfies weak LSC. Then there exists a positive integer [formula] and a positive definite quadratic form [formula], such that the following hold:

(k',Q') satisfies strong LSC modulo every p > 2, and σ2(k',Q')  ≫  1.

[formula] if and only if [formula].

[formula] and [formula].

If (k,Q) satisfies strong LSC, then we may set Q' = Q and k' = k. Indeed, it follows from [\eqref=sig-p] and [\eqref=hensel] that

[formula]

if (k,Q) satisfies strong LSC modulo 2. Otherwise, if (k,Q) fails to satisfy strong LSC, then our goal will be to derive the existence of a positive integer k' < k, and a positive definite quadratic form [formula] such that (k',Q') satisfies weak LSC, and conditions (ii), (iii) are satisfied. Once this is achieved it is clear how to complete the proof of Lemma [\ref=reduction]: either we can show that the pair k',Q' satisfies condition (i), in which case we are done, or else we may iterate the argument to produce a new pair k'',Q''. That this process must terminate after a finite number of steps is obvious from the fact that [formula].

Let us begin by supposing that the pair (k,Q) does not satisfy strong LSC modulo p, for an odd prime p. In this setting it is well known that Q can be diagonalised over the ring [formula] of p-adic integers (see [\cite=W'], for example). Since this process does not alter whether or not the pair k,Q satisfies strong LSC, we may assume that [formula]. After a change of variables we may further assume that

[formula]

for some [formula], with [formula]. If [formula] then Lemma [\ref=mr] implies that the congruence [formula] has a solution with [formula] for some [formula]. This gives a solution of [\eqref=ganga], which is contrary to our assumption. Thus we may assume that [formula] in [\eqref=change]. We claim that the only possibility is κp = 1, where κp is given by [\eqref=28-kappa]. This is obvious when r = 0. Next we suppose that r = 1 and κp = 0. Then since (k,Q) satisfies weak LSC, so there is a solution to the congruence [formula]. Thus one must have [formula], which again gives an impossible solution of [\eqref=ganga]. Finally, if r = 2 and κp = 0, then Lemma [\ref=mr] implies that M2(p) > 0, which is again contrary to our assumption. We may therefore assume that in any solution to the congruence [formula], one has [formula], and there are at most two indices i,j such that [formula] and [formula].

On returning to the diagonalisation process modulo p, we deduce that there are linear forms [formula], such that [formula] when [formula]. Let

[formula]

and recall that [formula]. Then we see that [formula] forms a lattice of determinant [formula]. In particular, there is a basis [formula] of [formula] such that the matrix [formula] formed with [formula] as column vectors has [formula]. We define [formula], and note that by construction all coefficients of [formula] are divisible by p. Thus we may write [formula], where [formula] is a positive definite quadratic form. Since p|k, we may also write k = pk' for some positive integer k', and can proceed to consider the solubility of the equation [formula] in integers. Clearly [formula] if and only if [formula]. Furthermore it is trivial to see that

[formula]

and [formula], since [formula]. It remains to observe that (k',Q') satisfies weak LSC, since (k,Q) does. Indeed, in view of the fact that [formula] whenever [formula], we see that k' is represented by Q' modulo pt for every [formula].

We now consider the problem of 2-adic solubility. We shall show that either σ2(k,Q)  ≫  1, or else we can replace the pair (k,Q) by (k',Q'), with k' < k, in such a way that (k',Q') satisfies both weak LSC and the conditions (ii) and (iii) of the lemma. Quadratic forms are generally no longer diagonalizable over [formula]. However they are "almost-diagonalizable" (see Cassels [\cite=C], for example), in the sense that they can be written as a sum of forms of the type aX2, bXY and c(X2 + XY + Y2), where b and c are even. We may therefore proceed under the assumption that

[formula]

where m + 2n1 + 2n2 = n, and all bi and ci are even. We now distinguish several cases.

Suppose first that no coefficient ai, bi or ci is divisible by 8. We split our argument according to whether or not 27 divides k. Let us deal with the case [formula] first. By weak LSC there must be a solution of [formula] in which some xj is not divisible by 24. Thus [formula], by the hypothesis that none of ai,bi,ci are divisible by 8. Lifting this solution (see [\cite=dav32], for example), we conclude that σ2(k,Q)  ≫  1. Suppose next that 27|k. Now clearly there is a solution of [formula] where some xj is odd. Indeed, since [formula], the equation Q = 0 is non-trivially soluble in [formula], and thus also has a primitive solution. As above, we conclude that [formula], and so deduce that σ2(k,Q)  ≫  1 by a lifting argument.

We must now deal with the case in which at least one coefficient ai, bi or ci is divisible by 8. There are two subcases to consider, the first being that [formula] has a solution [formula], such that there is an index [formula] for which both [formula] and [formula], where dj is the coefficient out of ai, bi, ci that corresponds to xj. But here a lifting argument again leads to the conclusion that σ2(k,Q)  ≫  1. Finally, we consider the possibility that every solution of [formula] has 2|xj or 8|dj, in the above notation, for each [formula]. In particular k must be divisible by 4. Set [formula] equal to 0 or Xj, according to whether or not 8|dj, respectively. Then the congruence [formula] forces [formula] for [formula]. Moreover, by our hypothesis at least one of the Lj must be identically zero. Hence the lattice

[formula]

has determinant [formula]. The pair (k,Q) can now be reduced to (k',Q') where k' = k / 4 and [formula], with [formula]. It follows that [formula], whence

[formula]

Furthermore, (k',Q') clearly satisfies weak LSC. This completes the proof of Lemma [\ref=reduction].

Let [formula] be a positive definite quadratic form and let cn > 0 be a fixed parameter that depends only upon n. We proceed to introduce a quantity [formula], that is defined to be the maximal [formula] such that [formula], [formula], and (k,Q) satisfies strong [formula] modulo every odd prime p. It is not hard to see that the statement of Theorem [\ref=w] remains valid when [formula] is replaced by [formula], with the implied constant now depending additionally on the choice of cn. We claim that it will suffice to establish the upper bound in Theorem [\ref=iterate], with [formula] replaced by [formula], for a suitable absolute constant cn > 0. To see this, let [formula]. Then Lemma [\ref=reduction] implies that there is a pair (k',Q') satisfying condition (i), such that k' and ΔQ' satisfy the inequalities in part (iii) of the lemma, and the equation Q' = k' has no solution in integers. Suppose for the moment that we have shown [formula] to be O(|ΔR|φ(n)), for [formula] and arbitrary positive definite quadratic forms [formula]. Then we deduce that

[formula]

This therefore establishes the claim.

Let us henceforth suppose that we have a positive integer k such that [formula], where cn > 0 is the absolute constant that emerges from the application of Lemma [\ref=reduction] above. Our aim is to provide an upper bound for the size of k in terms of the discriminant of Q. It will suffice to replace Q by any quadratic form Q' that is equivalent to it. We may therefore proceed under the assumption that Q is Minkowski reduced. Thus, if

[formula]

for appropriate integers qij = qji, then we may assume without loss of generality that

[formula]

with [formula]. Let us write min (Q) for the minimum non-zero value Q. Then these inequalities imply that

[formula]

We now deduce from the statement of Theorem [\ref=w], with [formula] replaced by [formula], that

[formula]

This estimate is clearly at its sharpest when [formula] is small compared to |ΔQ|. It turns out that Watson's approach produces a bound for k that is best when [formula] is large. Our plan is to combine the two bounds, in order to get an overall improvement. At this point it is convenient to introduce a parameter [formula], chosen so that

[formula]

for appropriate constants [formula] that depend only on n. It is clear that this is always possible, and that α may be taken to lie in the interval

[formula]

aaaa ≪ (a|Δ|).

[formula]

α:=.

[formula]

Activation of the circle method

The purpose of this section is to establish Proposition [\ref=main']. During the course of this we shall occasionally arrive at estimates involving arbitrary parameters M,N. These will typically be non-negative or positive, but will always be assumed to take integer values. We proceed to review the technical apparatus behind Heath-Brown's version of the circle method [\cite=HB']. Recall the weight function [formula], as given by [\eqref=w0], and set

[formula]

Let ω(x): = 4c- 10w0(4x - 3), and define the function [formula] by

[formula]

It is shown in [\cite=HB'] that h(x,y) is infinitely differentiable for [formula], and that h(x,y) is non-zero only for [formula]. Let [formula] be given by [\eqref=wQ], where [formula] is a non-singular quadratic form, as above. The kernel of our work is [\cite=HB']. For any [formula], and any [formula], we define the sum

[formula]

and the integral

[formula]

Then there exists a positive constant cB, satisfying

[formula]

for any integer N > 0, such that

[formula]

Our proof of Proposition [\ref=main'] now has two major components: the estimation of the exponential sum [\eqref=Sq] and that of the integral [\eqref=Iq]. We shall treat these separately, in § [\ref=sommes] and § [\ref=integrales], respectively. Finally, we shall deduce the statement of Proposition [\ref=main'] in § [\ref=eichel].

Estimating [formula]

In this section we investigate the exponential sums [formula], as given by [\eqref=Sq]. We begin by recording the following basic multiplicativity property [\cite=HB'].

If [formula] then

[formula]

where [formula] and [formula]

The primary goal of this section is to obtain good upper bounds for [formula], in which the implied constant is independent of the coefficients of Q. The following simple estimate is valid for any choice of [formula].

We have

[formula]

We draw on the work of the second author [\cite=dietmann]. Let us write q = 2eq' and ΔQ = 2dΔQ', where [formula] and d,e are non-negative integers. Then it follows from Lemma [\ref=mult] that

[formula]

say. Now [\cite=dietmann] immediately yields

[formula]

whereas on combining [\cite=dietmann] with the trivial estimate [formula], we see that

[formula]

We therefore conclude that

[formula]

which thereby completes the proof of the lemma.

We shall be able to achieve sharper bounds for [formula] when q is square-free. Define the quadratic form

[formula]

with coefficients in [formula]. When p is a prime such that [formula] we may think of [formula] as being defined modulo p. We now consider the sum [formula] for any odd prime p. By mimicking the argument of [\cite=HB'], we establish the following result.

Let p be an odd prime. Then we have

[formula]

where

[formula]

Since p is an odd prime there exists an integer valued matrix [formula] such that [formula] and [formula] is diagonal modulo p. In our estimation of [formula] it therefore suffices to assume that [formula], for integers [formula] such that [formula]. Suppose first that [formula]. In this setting it is not hard to see that

[formula]

One easily completes the treatment of the case [formula] by recycling the arguments involving Gauss sums from the proof of Lemma [\ref=mr], together with the well-known bounds

[formula]

Here, Kn(a,b;p) is the Kloosterman sum for n even, and the Salié sum for n odd.

Next we suppose that p|ΔQ. On assuming that Q has rank ν < n modulo p, the same sort of argument leads to the conclusion that

[formula]

for some subset I  ⊂  [1,n] of cardinality ν, such that [formula] for i∈I. But then it is easy to deduce that

[formula]

Here, we have used the fact that pn - ν|ΔQ, since F has rank ν modulo p, whence [formula]. This completes the proof of Lemma [\ref=s-p].

We may now combine Lemma [\ref=mult] and Lemma [\ref=s-p] to provide an estimate for [formula] in the case that q is square-free.

Let [formula] be square-free. Then we have

[formula]

where δn is given by [\eqref=eta].

Since q is square-free we may write [formula], with [formula] distinct odd primes and e∈{0,1}. Then it follows from Lemma [\ref=mult], together with the trivial bound [formula], that

[formula]

Here, qj = q / pj for [formula], and [formula] is defined by [formula] But then Lemma [\ref=s-p] implies that

[formula]

for each [formula]. On combining these two inequalities we easily deduce the statement of Lemma [\ref=expsumm-sfree].

We are now ready to investigate the average order of the sum [formula] for [formula]. To begin with we note that an application of Lemma [\ref=expsumm] immediately yields

[formula]

In fact we can do rather better than this in most circumstances. Write q = uv for coprime u and v, such that u is square-free and v is square-full. Then we may combine Lemmas [\ref=mult], [\ref=expsumm] and [\ref=expsumm-sfree] to deduce that

[formula]

where δn is given by [\eqref=eta]. Now for any non-zero integer a, and any [formula], it is easy to see that

[formula]

where d(a) denotes the usual divisor function. Let [formula]. Then C is a non-zero integer, unless k = 0 and n is even. Assuming this not to be the case, we employ the trivial estimate [formula] in order to deduce that

[formula]

On noting that there are only O(V1 / 2) square-full values of [formula], we have therefore established that

[formula]

unless k = 0 and n is even. We may now combine this with [\eqref=hoo] in order to deduce the following result.

For any [formula] we have

[formula]

where γn is given by [\eqref=even-odd].

We end this section by considering the average order of the sum [formula] in the special case [formula]. But in this setting Lemma [\ref=exp-av-q] clearly yields

[formula]

which implies that the infinite sum in this formula is absolutely convergent. Lemma [\ref=mult] implies that the function [formula] is multiplicative. Thus the usual analysis of the singular series yields

[formula]

where σp is given by [\eqref=sig-p]. On recalling the definition [\eqref=singseries] of [formula], we have therefore shown that

[formula]

where γn is given by [\eqref=even-odd].

Estimating [formula]

The goal of this section is to provide good upper bounds for the integral [formula], for given [formula] and [formula]. Recall the orthogonal matrix [formula] that was fixed at the outset. Thus there exist non-zero [formula] such that [\eqref=choice-R] holds, with [formula]. It will be convenient to introduce the matrix

[formula]

Recall now the definitions [\eqref=w1], [\eqref=wQ] and [\eqref=tW] of the weight functions w1,wQ and w̃, respectively. Finally, recall the definition [\eqref=Iq] of the integral [formula], and also that of the polynomial PQ, given by [\eqref=P]. Then it follows from a simple change of variables that

[formula]

But then the change of variables [formula] easily yields

[formula]

where [formula] and [formula] is given by [\eqref=R-sig]. In particular we have [formula], so that [formula] for any [formula]. Once taken together with the properties of the function h mentioned in § [\ref=2], we deduce that [formula] unless q  ≪  B. Moreover, in view of the fact that [formula] is orthogonal, it easily follows from [\eqref=eigen] that

[formula]

where [formula] denotes the height of Q, as usual.

Now let [formula] be any infinitely differentiable function, with compact support, and let [formula] be any quadratic form. Much of this section will be based on an analysis of the integral

[formula]

for any [formula] and [formula]. Here, PG is given by [\eqref=P] as usual, and so takes the form [formula] or [formula], according to whether we are interested in the case k = 0 or k > 0 in our proof of Proposition [\ref=main']. The connection with [formula] is given by

[formula]

with r = B- 1q and [formula]. In order to establish upper bounds for [formula], it will therefore suffice to do so for [formula], for any quadratic form [formula], and a rather general class C1(S) of functions w, that depend only upon parameters from a set S.

The class of functions C1(S) that we shall work with is very similar to that employed by Heath-Brown [\cite=HB']. We shall use weights [formula], which are infinitely differentiable and have compact support, and which take non-negative real values. Given such a weight w, we let n(w) = n and set [formula] to be the smallest R such that w is supported in the hypercube n. Moreover for every integer [formula] we let

[formula]

Let S be any collection of parameters. Then we shall define C(S) to be the set of infinitely differentiable functions [formula] of compact support, such that [formula] are all bounded by corresponding quantities [formula] depending only on parameters from the set S. This much is in complete accordance with Heath-Brown [\cite=HB']. Given a quadratic form [formula], we now specify the set of functions C1(S)  ⊂  C(S), where we now assume that S contains among its parameters the form G. Given w∈C(S), we shall say that w∈C1(S) if

[formula]

on [formula]. In particular, when [formula] is given by [\eqref=R-sig], it is not hard to see that [formula].

We are now ready to commence our study of the integral [formula], for an arbitrary quadratic form [formula] and a general weight function w∈C1(S), where as above S is assumed to contain G among its parameters. Phrasing things in this degree of generality allows us to apply the work of Heath-Brown more or less directly, since we have a direct correspondence between [\eqref=I*] and the integral [formula] in [\cite=HB'], defined for any quadratic form G and weight w∈C1(S). There is a slight abuse of notation here, in that the polynomial G appearing in Heath-Brown's definition of [formula] corresponds precisely to what we have called PG, for a quadratic form G. Moreover, it should be highlighted that whereas his work is phrased in terms of the more restrictive class of weight functions C0(S)  ⊂  C1(S), defined at the start of [\cite=HB'], an inspection of the contents of [\cite=HB'] reveals that all of the estimates there extend to C1(S).

Bearing this in mind, our first task is to record a preliminary estimate for [formula]. The following will be used to show that large values of [formula] make a negligible contribution in our analysis.

Let [formula] with [formula]. Then for any [formula] we have

[formula]

Let [formula] be a quadratic form and let w∈C1(S). Then on combining [\cite=HB'] and [\cite=HB'], we deduce that

[formula]

for any [formula] and any [formula] such that [formula]. But then we may insert this into [\eqref=I^*], and combine it with [\eqref=jonny], in order to complete the proof.

We shall need a finer estimate for [formula] when [formula] has small modulus. The following result also follows rather easily from Heath-Brown's analysis.

Let [formula] with [formula]. Then we have

[formula]

For an arbitrary quadratic form [formula], the Hessian condition of [\cite=HB'] automatically holds for any w∈C1(S). Thus for any such G and w, we may combine [\cite=HB'] with [\cite=HB'] to deduce that

[formula]

for any [formula] such that [formula]. On inserting this into [\eqref=I^*], and combining it with [\eqref=jonny], we therefore complete the proof of Lemma [\ref=c>0:2].

We end this section by considering [formula] in [\eqref=I^*], with r = B- 1q. Let [formula] be an arbitrary quadratic form, and let [formula] be the corresponding polynomial [\eqref=P]. Then it follows from [\cite=HB'] that

[formula]

for any N > 0, where σ∞(w;PG) is given by [\eqref=singint-1], and we have assumed that r  ≪  S1. On inserting this into [\eqref=I^*], and recalling the identity [\eqref=sig-inf], we therefore obtain the following result.

We have

[formula]

for any N > 0.

Derivation of Proposition [\ref=main']

In this section we are going to complete the proof of Proposition [\ref=main']. Our starting point is [\eqref=asym1]. Let ε > 0 and let [formula]. Then, whether we are in the case k = 0 or k > 0, we always have [formula] in Lemma [\ref=exp-av-q]. On combining this result with Lemma [\ref=c>0:1], and the fact that [formula] unless q  ≪  B, we therefore see that the contribution to the right hand side of [\eqref=asym1] from [formula] is

[formula]

for any N > n. But this is clearly

[formula]

for any M > 0. Turning to the contribution from [formula], we combine Lemmas [\ref=exp-av-q] and [\ref=c>0:2] to deduce that

[formula]

where γn is given by [\eqref=even-odd]. On summing over values of [formula] such that [formula], we therefore deduce that the contribution to the right hand side of [\eqref=asym1] from such [formula] is

[formula]

Once combined with [\eqref=fri=1], we see that the overall contribution from [formula] is

[formula]

for any M > 0. Taking M = ⌈n / (2ε)⌉ and [formula] we therefore see that there is a contribution of

[formula]

to the right hand side of [\eqref=asym1] from those [formula].

It remains to handle the contribution from the case [formula]. Recall the definition [\eqref=sig-inf] of σ∞, and the inequality σ∞  ≪  1 that it satisfies. Then an application of Lemma [\ref=c=0], together with [\eqref=singseries1], reveals that the contribution from [formula] is

[formula]

for any N > 0. On selecting N = (n - 3 - γn) / 2, it follows from Lemma [\ref=exp-av-q] that the error terms in this estimate are bounded by Oε(B(n - 1 + γn) / 2 + ε). We may now combine this with [\eqref=water] in [\eqref=asym1], in order to complete the proof of Proposition [\ref=main'].

The singular series

In this section we establish Proposition [\ref=ss']. Let [formula] be a non-singular quadratic form of discriminant ΔQ, and let k be a non-negative integer. As usual we assume that [formula] when k = 0. Under suitable local solubility assumptions, our task is to establish a uniform lower bound for the singular series [formula], where σp  =  σp(k,Q) is given by [\eqref=sig-p] and [\eqref=N]. We shall obtain a better lower bound by assuming stronger local solubility conditions. Note that when [formula] it already follows that σp  ≠  0 under weak LSC. Similarly, when n = 4 and k > 0, it follows from strong LSC that σp  ≠  0.

Let us begin by handling the factors σp, for which [formula]. In this setting we shall use the identity

[formula]

that follows from [\eqref=yemuna]. But then an application of Lemma [\ref=expsumm] reveals that

[formula]

when [formula] When n = 4 and k > 0, an application of Lemmas [\ref=expsumm] and [\ref=s-p] also yields σp  =  1 + Oε(p- 3 / 2 + ε), provided that [formula]. Hence we have

[formula]

and

[formula]

We now turn to the size of σp for the remaining primes p. For this we recall the definitions [\eqref=N] and [\eqref=N*] of N(pt) and N*(pt), respectively. When p is odd, we may diagonalise Q modulo pt, without changing the values of N(pt) or N*(pt). In our analysis of the quantities N(pt) or N*(pt) for odd p, it therefore suffices to proceed under the assumption that

[formula]

with [formula] Now it is easy to deduce from [\eqref=sig-p] and [\eqref=hensel] that in the case n = 4 and k > 0 we have

[formula]

When p = 2, therefore, we immediately obtain [formula], since the pair (k,Q) is assumed to satisfy strong LSC modulo 2. Suppose next that p > 2, with p|kΔQ. We may therefore assume that Q takes the shape [\eqref=7-diag], with [formula]. On combining Lemma [\ref=mr] with the fact that (k,Q) satisfies strong LSC, one may deduce that N*(p) = 2p3 if [formula] for precisely two indices [formula], and N*(p) = p3 + O(p2) otherwise. We shall revisit this line of argument in greater detail when we deal with the case [formula] below. On inserting this into [\eqref=new-house] and combining it with [\eqref=mendip2] and our lower bound for σ2, we therefore deduce that there is an absolute constant c > 0 such that

[formula]

for any ε > 0. This is satisfactory for the statement of Proposition [\ref=ss'] when n = 4 and k > 0.

We may assume henceforth that [formula]. Suppose first that p is odd with p|ΔQ. Then we may assume that Q takes the shape [\eqref=7-diag], with [formula] We shall say that the pair (k,Q) is "p-reduced" if any of the following occur:

p divides at most n - 3 of the coefficients [formula].

p divides k and precisely n - 2 of the coefficients [formula], with the remaining two coefficients satisfying [formula].

p divides all but one of the coefficients [formula], with the remaining coefficient satisfying [formula].

We shall be able to establish a good lower bound for N(pt) when the pair (k,Q) is p-reduced. When (k,Q) is not p-reduced, we will be able to make a certain change of variables that ultimately leads us to estimate N(pt) for a p-reduced pair (k',Q'). Observe that any pair (k,Q) satisfying strong LSC, is automatically p-reduced, since then N*(p) > 0. Suppose for the moment that (k,Q) satisfies weak LSC, but is not p-reduced. We claim that there exists an integer [formula] and a p-reduced pair (k',Q') such that

[formula]

with

[formula]

To see this we note that after a possible relabelling of the indices we have

[formula]

where (r,s) = (0,n),(1,n - 1) or (2,n - 2), and

[formula]

If r = 0 then we may write k = pk' in N(pt), since N(p) > 0 by assumption. This gives

[formula]

where [formula]. If r = 1 and [formula], then we may write x1 = px1' and k = pk' in N(pt), again since N(p) > 0. This gives

[formula]

where [formula]. Alternatively, if r = 2 and [formula], then we may write x1 = px1',x2 = px2' and k = pk' in N(pt). This gives

[formula]

where [formula]. In particular it is clear that

[formula]

Now either (k',Qi) is p-reduced, or we can repeat the procedure. This procedure must eventually terminate, since at each step the p-adic valuation of the forms determinant is reduced by [formula], and we can stop when the forms determinant has p-adic valuation [formula]. More precisely, after the jth step one finds that the p-adic valuation of the resulting form is [formula], whence there at most

[formula]

steps in this procedure. The bounds in [\eqref=31-pred] and [\eqref=31-theta] are now obvious. We note that in the alternative case, where (k,Q) satisfies strong LSC, we take θ = 0 and (k',Q') = (k,Q) in [\eqref=31-pred].

Still under the assumption that p > 2, with [formula] and p|ΔQ, we proceed to derive a lower bound for N(pt) for any [formula], under the assumption that the pair (k,Q) is p-reduced. Moreover we shall suppose that

[formula]

with [formula] such that r + s = n, and [\eqref=1-aibi] holding. It follows from [\eqref=hensel] that

[formula]

for any t  >  1. Observe that

[formula]

Hence N*(p) = psMr(p), in the notation of [\eqref=mr-def]. By combining this fact with Lemma [\ref=mr] we deduce that

[formula]

Let t be large and suppose that (k,Q) satisfies weak LSC. Then on combining [\eqref=31-pred] and [\eqref=1-food] with [\eqref=7-lower], we may conclude that

[formula]

for some [formula] such that [\eqref=31-theta] holds. Thus we deduce that

[formula]

in this case. Alternatively, if (k,Q) satisfies strong LSC, so that one may take θ = 0 in [\eqref=31-pred], it follows from [\eqref=1-food] and [\eqref=7-lower] that

[formula]

for some constant cn > 0 depending at most upon n.

We now turn to the case p = 2, which will be handled by an iterative method similar to that used above. If k is not divisible by 32 then we claim that

[formula]

This clearly implies that σ2  ≫  1. To see the claim we note that [formula] cannot be divisible by 16 for any 2-adic solution of [formula], and such a 2-adic solution must exist by weak LSC. A lifting argument therefore establishes the claim. We proceed under the assumption that k is divisible by 32. We may assume that Q takes the shape [\eqref=8-2adic] for certain integers ai,bi,ci such that bi and ci are even. Suppose that there is at least one coefficient among the bi,ci that is not divisible by 8, and write F(X,Y) for the binary quadratic form that corresponds to this coefficient. Then it is not hard to see that there is a solution of

[formula]

with [formula]. Thus we may find a solution of [formula] in which [formula] is not divisible by 8. This solution can be lifted, which thereby shows that [\eqref=N2] holds in this case also. We may henceforth assume that every coefficient bi,ci in [\eqref=8-2adic] is divisible by 8. In particular they may be divided by 4 and still leave terms that are classically integral.

We now repeat the argument that we used to treat the case p > 2, although extra care needs to be taken to obtain a result of the same strength. If in the course of the reduction only one or two variables are forced to be even in order that [formula], then we may proceed analogously to p > 2, obtaining (k',Q') in place of (k,Q), such that [\eqref=31-pred] holds with p = 2 and θ = 1. We then enter the next iteration step, repeating our argument for p > 2, but now with (k',Q'). In the alternative case, the congruence [formula] forces more than two variables to be even. But then our quadratic form Q splits off a diagonal form

[formula]

where [formula] and [formula], and [formula] are forced to be even in any solution to the congruence [formula]. Note that no non-diagonal terms appear here, by our preparations above. Clearly we may assume that [formula], since for [formula] all k could be represented by [formula] not all even. Thus another lifting argument would yield [\eqref=N2]. We shall also need to note that if any other coefficients associated to [formula] were divisible by 2, but not by 4, then we could solve the congruence

[formula]

with [formula] not divisible by 4. Once again, a lifting argument would show that [\eqref=N2] holds. We may therefore suppose that apart from [formula], all of the coefficients of Q are divisible by 4. Let us suppose that m = 4, which is the worst case. Since x1,x2,x3,x4 are forced to be even in any 2-adic solution, we may make the substitution xi = 2xi' for [formula]. Moreover, we can carry out two reduction steps at this first stage, in the sense that after making these substitutions we get a new form Q' which has all of its coefficients divisible by 4. Thus we may divide everything through by 4. In this way we can replace the pair (k,Q) by a pair (k',Q'), for which [\eqref=31-pred] holds with p = 2 and θ = 2. This iterative process clearly terminates after a finite number of steps, and produces a pair (k',Q') for which [\eqref=31-pred] and [\eqref=31-theta] holds, where the right-most term in [\eqref=31-pred] can be bounded below as N(2t - θ)  ≫  2(t - θ)(n - 1).

On combining all of the findings above with [\eqref=mendip1], we have therefore shown that

[formula]

when [formula] and (k,Q) satisfies weak LSC. Alternatively, when [formula] and (k,Q) satisfies strong LSC, we find that

[formula]

for any ε > 0. These bounds are clearly satisfactory for Proposition [\ref=ss'].