Algorithm Lemma Proposition Corollary Remark

Notation Definition

On the frequency of permutations containing a long cycle

Introduction

This paper is concerned with the proportions of permutations in the symmetric and alternating groups on n points satisfying an equation xm  =  1 for various values of m  =  O(n), that is, for m  ≤  kn for some constant k. Our interest in such permutations stems from their use in 'black-box algorithms' to recognise finite symmetric and alternating groups. We give a detailed analysis of the proportion of elements in Sn of order dividing m for large values of n, where m = O(n) and m  ≥  n in [\cite=NiemeyerPraeger05b]. These results provide asymptotic bounds for n sufficiently large. The focus of this paper is to find explicit probability bounds for all n. A shortened version of this paper will be published [\cite=NiemeyerPraeger05c] in the Journal of Algebra. Such bounds are useful in algorithmic applications: the bounds obtained in this paper are significant improvements on explicit estimates given in [\cite=Bealsetal03] for the proportions of elements in Sn or An satisfying certain equations, and the associated conditional probabilities needed for the algorithms. To explain the relevance of these equations in the design of the algorithms we make some general remarks about these black-box algorithms in Section [\ref=sec:appl].

Statement of results

The purpose of this paper is first to prove in Theorem [\ref=first] a general upper bound for the proportion P(n,m) of elements in Sn of order dividing m, where m = O(n). It has applications beyond those of this paper, see [\cite=NiemeyerPraeger05]. We then obtain in Theorem [\ref=melbounds_sn] explicit lower bounds for the conditional probabilities that an element of Sn or An has a relevant cycle structure, given that it satisfies a certain equation.

The statement of Theorem [\ref=first] uses the following integer function:

Let n,m be positive integers such that m  ≥  n - 1. Then the proportion P(n,m) of elements of Sn of order dividing m satisfies

[formula]

If m is very much larger than n then the upper bound is greater than 1 and hence of no use. However, if, say, 360  <  m  ≤  cn for some constant c, then Theorem [\ref=first] implies that P(n,m)  ≤  (2c + 1) / n. It is difficult to give lower bounds for P(m,n) that hold for all m and n. However, for example for a non-negative integer k, if n - k divides m then [formula], while if n is even and n / 2 - k divides m then [formula]

Table 1 lists the kinds of elements g the algorithms in [\cite=Bealsetal03] seek in Sn or An with n as given in the second column. The fourth column headed CycType lists the cycle type of the element g in terms of a parameter r which is defined in the third column. The fifth column records the order of gr and the last column records the group, either An or Sn, containing g. Note that we omit fixed points in the cycle notation. Thus, for example a permutation in Sn with cycle type 21(n - 3)1 has one fixed point. In Section [\ref=sec:appl] we give a brief account of the role of these elements in recognition algorithms for Sn and An.

Table 1  Relevant cycle types

Theorem [\ref=melbounds_sn] gives our improvements to the estimates in [\cite=Bealsetal03] on conditional probabilities for finding such elements in Sn or An. Recall the integer function γ(m) defined in Definition [\ref=def:gamma].

Let [formula], let G and r be as in Table 1, and let g be a uniformly distributed random element of G. Then

In cases 1,4 or 5 of Table 1 let [formula] Then

[formula]

In cases 2 or 3 of Table 1 let n  ≥  8 and [formula] Then

[formula]

In cases 6 - 10 of Table 1 let n  ≥  8 and [formula] Then

[formula]

Moreover, the lower bounds on P given in Table 2 hold.

P ≥   Case (n,r) 3 / 10 9 (31,25) 3 / 10 10 (185,80) 3 / 20 10 (13,8) or (25,20) 1 / 3

Table 2  Lower bounds

Note that in [\cite=NiemeyerPraeger05b] we prove better asymptotic bounds, namely [formula] for sufficiently large n (where the constant c depends on the case), for the conditional probabilities in Theorem [\ref=melbounds_sn] in the case where G  =  Sn. However these bounds are valid only for n "sufficiently large", whereas explicit lower bounds are required for each value of n for the algorithms.

Brief comments on our approach

The key ingredient that enabled us to achieve our results was our two stage approach to the analysis. In the first stage we obtained in Theorem [\ref=first] a uniform upper bound for the proportion P(n,m) of permutations in Sn of order dividing m for all n,m with n - 1  ≤  m. Although rather weak if m is much larger than n this result enabled us, in the second stage of our analysis, to obtain in Theorem [\ref=melbounds_sn] explicit and improved bounds when applied to the families of permutations needed for the algorithms in [\cite=Bealsetal03]. One reason for this success was the precision we achieved in estimating the parameter γ(m) in Theorem [\ref=first]. The idea behind the proof of Theorem [\ref=first] is a refinement of the approach of Beals and Seress in the proof of [\cite=Bealsetal03] to study the cycles of elements of Sn containing three specified points.

In Section [\ref=sect:divisors] we collect some well-known or sharpened versions of well-known upper bounds on the number of divisors of an integer. Section [\ref=sec:proportions] is devoted to elementary properties of P(n,m) and the proof of Theorem [\ref=first]. In Section [\ref=sec:longcycle] we derive the practical upper bounds on the conditional probability that a random element g∈Sn or An of order dividing a certain number has cycle type CycType as specified in one of the rows of Table 1 (with |gr| as in the last entry of that row).

Black-box algorithms for recognising Sn and An

Black-box algorithms make few assumptions about how groups are represented: group elements may be multiplied, inverted, and tested for equality. These three operations are called black-box operations, and no other operations are permitted. Elements of a black-box group are represented as strings of zeros and ones, and the lengths of these strings for a finite group G can therefore be taken as approximately log 2(|G|). Black-box algorithms are then regarded as efficient if the number of black-box operations they require is polynomial in log 2(|G|), that is, at most O(( log |G|)c) for some constant c. For example, if G is the finite symmetric group Sn or the alternating group An, then log |G| = O(n log n), so efficient black-box computations in these groups should take O(nc) black-box operations, for some constant c.

In particular in a black-box group G  =  Sn it is impossible to determine conclusively by black-box operations the cycle structure of an arbitrary element. Furthermore, computing the order of a random element g is too expensive since the average value for log |g| is (1 / 2) log 2n, and g might have order as large as e(1 + o(1))(n log n)1 / 2 (see [\cite=ETa] [\cite=ETb] and [\cite=Landau09]). It is however feasible to check whether an element satisfies an equation of the form xm = 1 with less than 2 log 2m black-box operations (by the method of repeated squaring) and this cost is acceptable provided that the number of elements to be considered is not too great.

The Sn-recognition algorithm in [\cite=Bealsetal03] has several components and its analysis is based on the availability of independent uniformly distributed random elements of the input group. It takes as input a black-box group G. If G is isomorphic to Sn then with high probability it returns an isomorphism λ:G  →  Sn. In the first two steps elements x and y are constructed such that λ(x) is an n-cycle and λ(y) is a transposition. Next, a random conjugate y' of y is sought such that, if G is isomorphic to Sn, with high probability x,y' satisfy a standard presentation for Sn. Checking the presentation guarantees that the subgroup 〈x,y'〉 generated by x and y' is isomorphic to Sn. A further algorithm tests that each generator of the input group G lies in the subgroup 〈x,y'〉 completing the proof that [formula]. A recognition algorithm for An proceeds in a similar way using black-box elements corresponding to n-cycles or (n - 1)-cycles and 3-cycles.

Thus the elements we wish to construct correspond to m-cycles with m∈{2,3,n - 1,n}. Such elements g satisfy the equation gm = 1. For t = 2 or t = 3 the proportion of t-cycles in Sn or An is very small. Typically the algorithms construct elements g whose cycle structure consists of a t-cycle and a single additional non-trivial cycle of length r, where r is not divisible by t (as in Table 1), and g satisfies gtr = 1 and [formula]. For such an element we construct a t-cycle by forming the power gr. We note that, in the case where [formula] and n  ≥  13, we may utilise elements in both cases 9 and 10 of Table 1 to construct a 3-cycle (although if n = 13, some additional care is needed).

It turns out that most elements in Sn or An satisfying an equation of the form gm = 1 are m-cycles if m∈{n,n - 1}. Also most elements for which gtr = 1 and [formula] consist of a t-cycle and an r-cycle if t = 2 or 3. The crucial probabilistic result underpinning the algorithms in [\cite=Bealsetal03] shows that the conditional probability that a random element g has one of these desired cycle types, given that g satisfies an appropriate equation, is 1 - o(1) for large n, and at least 1 / 180 for all n. In an algorithmic context this means that a random element of Sn satisfying one of these equations has a good chance of having the desired cycle structure and the lower bounds in [\cite=Bealsetal03] were sufficient for the purpose of estimating the complexity of the algorithms. However, for an efficient practical implementation of these algorithms a more realistic lower bound is desirable, since the lower bound is reciprocally proportional to an upper bound for the number of random elements that need to be tested. In particular, if the algorithm is called with an input group G not isomorphic to An or Sn then the number of random elements considered will be equal to the upper bound.

On Divisors of Integers

In this section we cite some results from Number Theory which we require throughout. In particular we investigate properties of divisors of a given integer and sums of powers of these divisors. For a positive integer n let d(n) denote the number of divisors of n. Niven et al. [\cite=NivenZuckermanetal91] prove the following result:

For every δ  >  0 there is a constant cδ such that d(n)  ≤  cδnδ for all [formula] In particular, we may take [formula] and c1 / 3 = (1536 / 35)1 / 3  ~  3.53.

In the following two lemmas we revisit and refine the proof given in [\cite=NivenZuckermanetal91] to obtain certain constants c0  <  c1 / 3 such that d(n)  ≤  c0n1 / 3 for most integers n.

Let [formula].

Let [formula], where the product is over all odd primes p and each αp  ≥  0. Then, arguing as in [\cite=NivenZuckermanetal91], we have that

[formula]

where [formula]. It is shown in [\cite=NivenZuckermanetal91] that the function fp(α) of an integer variable α attains its maximum at [formula] In particular, if p  >  8 then α0(p)  =  0 and thus fp(α)  ≤  1, for all α. Also α0(5)  =  α0(7)  =  1, α0(3)  =  2, and α0(2)  =  3.

If n is odd, then α0(2) = 0 and hence by taking c  =  f3(2)f5(1)f7(1)  =  4(3 / 35)(1 / 3) we have that d(n)  ≤  cn1 / 3. This proves (a).

If n is not divisible by 9, then α0(3)  ≤  1 and hence by taking c  =  f2(3)f3(1)f5(1)f7(1)  =  16 / (105)(1 / 3) we have that d(n)  ≤  cn1 / 3. This proves (b).

Finally, if n is odd and not divisible by 9 then by taking [formula] we have that d(n)  ≤  cn1 / 3. This proves (c).

Let [formula]. Then for [formula] either d(n)  ≤  c0  n1 / 3, or n  =  2a3b5c7dm, where 1  ≤  a  ≤  6, 0  ≤  b  ≤  4, 0  ≤  c  ≤  2, 0  ≤  d  ≤  1, and m∈{1,11,13}. In particular, if n  >  11,793,600 then d(n)  ≤  c0n1 / 3.

Let [formula], and let fp,αp and α0(p) be as in the proof of Lemma [\ref=lem:oddnrdiv]. Note that α0(2)  =  3, α0(3)  =  2, and α0(5)  =  α0(7)  =  1. Let [formula] so that d(n)  =  c(n)n1 / 3. Let n0  =  27  ·  32  ·  5  ·  7. Then

[formula]

and if c(n)  ≤  c0 then we obtain d(n)  ≤  c0n1 / 3.

Now suppose n is such that c0  <  c(n). Write n as n  =  2a3b5c7dm, where gcd (m,2  ·  3  ·  5  ·  7)  =  1. Now c(n)  =  f2(a)f3(b)f5(c)f7(d)c(m), and c(m)  ≤  1 with c(m)  <  1 if m  >  1. The condition c0  <  c(n), and our knowledge of the maximum values for the fp(α) give

[formula]

and hence f2(7)  <  f2(a) which implies a  ≤  6.

Next, it is easy to see that fp(α)  <  fq(α) for p  >  q and any positive integer α. Also for any p  >  8 the function fp(α) is decreasing for α  ≥  0.

Suppose that one of the following holds:

m is divisible by some prime p with p  ≥  17;

m is divisible by 112 or 132 or 11  ·  13.

We show that in either case f2(3)c(m)  <  f2(7). In case (i), f2(3)c(m)  ≤  f2(3)f17(1)  <  f2(7). In case (ii), since f13(2)  <  f11(2), we have either f2(3)c(m)  ≤  f2(3)f11(2)  <  f2(7) or

[formula]

Thus if (i) or (ii) holds, then f2(3)c(m)  <  f2(7) and we have

[formula]

which is a contradiction. Thus m∈{1,11,13}. Also f2(3)f7(2)  <  f2(7)f7(1), and a similar argument yields d  ≤  1; and f2(3)f5(3)  <  f2(7)f5(1) and we obtain c  ≤  2; and f2(3)f3(5)  <  f2(7)f3(2) and so b  ≤  4. Finally [formula] and it follows that a  ≥  1.

The following lemma yields some elementary approximations.

Let n,a,b be positive integers with a  ≤  b  ≤  n. Let D denote the set of all divisors d of n for which a  ≤  d  ≤  b. Then

[formula]

A divisor d∈D is of the form d  =  n / t for some integer t. As a  ≤  d  ≤  b it follows that n / b  ≤  t  ≤  n / a. Thus

[formula]

Estimating Proportions of elements

Let m and n be positive integers with m  ≥  n - 1. We estimate the proportion P(n,m) of elements in the symmetric group Sn whose order divides m. Note that the order |g| of a permutation g∈Sn divides m if and only if the length of each cycle of g divides m. Thus P(n,m) is the proportion of elements in Sn all of whose cycle lengths divide m. As indicated in the introduction, we obtain estimates for proportions of elements in Sn whose order divides m in various ways. We begin by defining different proportions of elements which play a key role in our analysis.

Let P(1)(n,m) denote the proportion of elements g∈Sn of order dividing m for which 1,2,3 lie in the same g-cycle, let P(2)(n,m) denote the proportion of elements g∈Sn of order dividing m for which 1,2,3 lie in exactly two g-cycles and let P(3)(n,m) denote the proportion of elements g∈Sn of order dividing m for which 1,2,3 lie in three different g-cycles.

Note that

[formula]

and that by convention we take P(r,m)  =  1 if r  ≤  0.

We begin by deriving expressions for P(i)(n,m) for i = 1,2,3.

Let n and m be positive integers with m  ≥  n - 1. Then the following all hold, where we take P(0,m)  =  1.

7pt

[formula]

[formula]

[formula]

[formula]

We first compute P(1)(n,m), the proportion of those permutations in Sn for which the points 1,2,3 are contained in one g-cycle, C say, of length d with d|m and 3  ≤  d. Also d  ≤  n since g∈Sn.

We can choose the remainder of the support set of C in [formula] ways and then the cycle C in (d - 1)! ways. The rest of the permutation g can be chosen in P(n - d,m)(n - d)! ways. Thus, for a given d, the number of such elements is (n - 3)!(d - 1)(d - 2)P(n - d,m). We obtain the proportion P(1)(n,m) by summing over all divisors d of m which are at most n, and dividing the sum by n!, that is

[formula]

Hence part (a) follows. Parts (b) and (c) are derived in a similar fashion. For a detailed proof of a very similar result see the proof of Lemma 2.2 of [\cite=NiemeyerPraeger05b].

Also part (d) follows by enumerating the elements g∈Sn of order dividing m according to the length d of the g-cycle containing the point 1.

We now prove Theorem [\ref=first].

Let γ denote γ(m) as in Definition [\ref=def:gamma]. The result is immediate if [formula] since P(n,m)  ≤  1, so we may assume that [formula] whence [formula] In particular n  ≥  4 and if n  =  4 then m  =  3. However [formula]. Thus we may assume that n  ≥  5. Let D denote the set of all divisors of m which are at most n.

Using the fact that P(t,m)  ≤  1 for t  <  n in Lemma [\ref=lem:theps](1) we obtain

[formula]

By applying Lemma [\ref=lem:sumdiv] we obtain, if m  ≥  n:

[formula]

and similarly

[formula]

Now let D2  =  {(d1,d2):d1,d2∈D,  2  ≤  d2,  d1  +  d2  ≤  n}. Then, using the fact that P(t,m)  ≤  1 for t  <  n in Lemma [\ref=lem:theps](2) we obtain

[formula]

Since d1  +  d2  ≤  n and 1  ≤  d1 it follows that d2 - 1  ≤  n  -  d1  -  1  ≤  n - 2. Set c(m)  =  d(m) / m1 / 3, where d(m) is the number of divisors of m. Then

[formula]

Using the fact that P(t,m)  ≤  1 for t  <  n in Lemma [\ref=lem:theps](3) we obtain

[formula]

Now using the inequality [formula] in the upper bounds for the Pi(n,m) gives

[formula]

Consider the function

[formula]

If c(m)  ≤  c then

[formula]

Thus, to prove Theorem [\ref=first] for any given value of m (and for all n with n - 1  ≤  m), it is sufficient to prove that f(m,c)  ≤  γ(m) - 1 for some c  ≥  c(m). This is the way we shall obtain our result for large m.

Recall that c(m)  =  d(m) / m1 / 3 and as in Lemma [\ref=lem:bignrdiv], we set c0  =  (768 / 35)1 / 3. It is easy to see that, for fixed c, the function f(m,c) is strictly decreasing as m increases over any interval on which γ  =  γ(m) is constant. Moreover, we can check that f(19020,c0)  ≤  1. Thus if both m  ≥  19020 and c(m)  ≤  c0, then f(m,c0)  ≤  1  =  γ  -  1 and hence f(m,c)  ≤  γ  -  1, so the theorem is proved in this case.

The remaining values are all m  <  19020 and those m  ≥  19020 for which c(m)  >  c0. Note that Lemma [\ref=lem:bignrdiv] identified explicitly a finite set of integers that contains all integers m such that c(m)  >  c0. For each of these remaining m we need to consider all n such that [formula]. We define

[formula]

Then Equations ([formula]),([formula]) and ([formula]) imply that [formula] Thus to prove [formula] it is sufficient to prove that [formula] (for each given m and all n  ≤  m + 1).

Next we define

[formula]

where D2  =  {(d1,d2):di  ≤  n,  di | m,  2  ≤  d2,  d1  +  d2  ≤  m} and D3  =  {(d1,d2,d3):di  ≤  n,  di|m,  d1  +  d2  +  d3  ≤  m}. Then S(n,m)  ≤  Ŝ(n,m), so it suffices to prove that

[formula]

(for each given m and all n  ≤  m + 1). Note that for fixed m the right hand side of Inequality ([formula]) is increasing in n. Thus suppose d divides m and [formula] If d  <  n  ≤  m + 1 and there is no divisor of m in the interval (d,n] then every divisor di of m that satisfies di  ≤  n also satisfies di  ≤  d, and hence

[formula]

Hence, if for all d with d|m and [formula] we have [formula] then [formula] for all n  ≤  m  +  1.

For all m  ≤  19020 and for all m  ≥  19020 for which c(m) > c0 = (768 / 35)1 / 3 is possible as given by Lemma [\ref=lem:bignrdiv], we tested in GAP [\cite=GAP4] whether, for all divisors d of m, the inequality [formula] holds, where γ  =  γ(m) is as in Definition [formula]. This was the case for all values of m we tested, except for m  =  72 and m = 120. In these two exceptional cases we proved directly that S(n,m)  ≤  (n - 1)(n - 2)(1  +  γm / n) holds for all n with [formula] Thus the theorem is proved.

Proof of Theorem [\ref=melbounds_sn]

In this section we give a full proof of the probability bounds in Theorem [\ref=melbounds_sn].

We repeatedly use the following arithmetic fact which holds for all x,y > 0

[formula]

Our next result refines the upper bound for P(n,m) in Theorem [\ref=first] for the special case where m is n or n - 1. It deals with cases 1,4,5 of Table 1.

Suppose that n,m are positive integers and m∈{n - 1,n} such that one of the cases 1,4, or 5 of Table 1 holds with m  =  r. Let g be a uniformly distributed random element from Sn (for case 1), or An (for cases 4 and 5). Let A,B denote the events that g is an m-cycle, or g has order dividing m, respectively. Let γ(m) be defined as in Definition [formula]. Then

[formula] and

3pt [formula]. Moreover, for all cases, P(A|B)  ≥  1 / 2 except for the cases in case 1 of Table 1 where m  =  n divides 24, and in these exceptional cases P(A|B)  ≥  2 / 7.

(a)   By Lemma 3.2 (d), [formula]. The values of d in the summation satisfy either d = m or d  ≤  m / 2. Since P(0,m) = P(1,m) = 1, it follows that

[formula]

As d  ≤  m / 2  ≤  n / 2 we have that n - d  ≥  n / 2. Thus by Theorem [\ref=first] we obtain that

[formula]

This proves part (a).

(b)  As A  ⊆  B the conditional probability P(A|B) satisfies [formula]. For case 1 of Table 1, where g is chosen from Sn, we have P(B) = P(n,m). For cases 4 and 5 of Table 1 where g is chosen from An, we have P(B)  ≤  2P(n,m) since the number of elements g∈An satisfying gm  =  1 is at most equal to the number of such elements in Sn.

Further, in the case of Sn (case 1 of Table 1), P(A) is the proportion of m-cycles in Sn, which is 1 / m  ≥  1 / n, since m  =  n or m = n - 1. In the case of An (cases 4 and 5 of Table 1), m is odd, and P(A)  =  2 / m  ≤  2 / n. Hence in all three cases, using part (a), P(A|B) satisfies By ([\ref=eq:fact]) it follows that

[formula]

For n  ≥  362 we have m  ≥  n - 1  >  360 and hence γ(m) = 2 and by Lemma [\ref=lem:nrdiv] we get

[formula]

We used the approximation [formula] and computed P(n,m) precisely (using Lemma [\ref=lem:theps](d)) , to verify by computation in GAP that the conditional probability P(A|B)  ≥  1 / 2 for all values of n,m as in the statement. For the remaining cases, that is those in case 1 of Table 1 where m = n divides 24, we computed that the lower bound (nP(n,m))- 1 for P(A|B) is greater than 2/7.

Now we turn to determining the conditional probability that an element g∈Sn has cycle structure 21r1, given that g has order dividing 2r and |gr| = 2, where r∈{n - 2,n - 3} and r is odd.

Let n and r be positive integers such that n  ≥  7, r∈{n - 2,n - 3}, and r is odd. If d is a divisor of 2r with d  ≤  n then either d  =  r, or d  =  2r / 3, or d  ≤  2r / 5.

Let n, r and CycType be as in case 2 or 3 of Table 1, with [formula]. Let g be a uniformly distributed random element from Sn, and let A,B denote the events that g has cycle structure 21r1, or g has order dividing 2r and |gr| = 2, respectively. Let γ(2r) be as in Definition [formula]. Then

[formula], and

[formula] For [formula], P(A|B) is at least 1 / 3 while for n∈{11,17,18} it is at least 1 / 4.

(a)  If g∈Sn has order dividing 2r, then the length d of any g-cycle divides 2r and d  ≤  n. By Remark [\ref=lem:divmttw], d  =  r or d  =  2r / 3 or d  ≤  2r / 5. We divide B into two disjoint events B1 and B2, where B1 is the event that g contains an r-cycle and B2 is the event that it does not. Then P(B)  =  P(B1)  +  P(B2).

If g has a cycle of length r and if |gr| = 2 then |g| divides 2r and g has cycle type 21r1. Hence B1 is equal to the event A, and the probability that a random element of Sn has cycle structure 21r1 is

[formula]

Let D' denote the set of all divisors of 2r which are at most 2r / 3. Let P'(n,2r) denote the proportion of elements of Sn all of whose cycle lengths lie in D'. Then by Remark [\ref=lem:divmttw], for any element g∈Sn such that B2 holds, the g-cycle containing the point 1 has length d for some d∈D'. For a given d∈D', we estimate the number of possible g as follows.

We have [formula] choices of d-cycles containing 1 and at most P'(n - d,2r)(n - d)! choices for the rest of the permutation. Summing over all divisors d∈D' yields

[formula]

By Theorem [\ref=first] we obtain

[formula]

If d  =  2r / 3 then [formula], while if d  ≤  2r / 5 then [formula] Hence we obtain

[formula]

Adding this bound to P(B1) yields part (a).

(b)   Since A  ⊆  B it follows that P(A|B)  =  P(A) / P(B). We showed in the proof of part (a) that P(A)  =  1 / (2r). Thus, using part (a) we obtain

[formula]

Finally, by Inequality ([\ref=eq:fact]),

[formula]

This proves the first assertion of part (b).

Since r is odd we obtain by Lemma [\ref=lem:oddnrdiv] that [formula]. Thus ([\ref=eq:x]) yields

[formula]

If n  ≥  360, then γ(2r)  =  2 and this lower bound on the conditional probability is at least 0.3335  >  1 / 3. For smaller values of n we proceed as follows. Note that P(A|B)  =  P(A) / P(B) and P(B) is the proportion of elements of order dividing 2r but not of order dividing r. Thus [formula]. By computation in GAP we verified, by computing P(n,2r) and P(n,r) precisely (using Lemma [\ref=lem:theps](d)), that the conditional probability P(A|B) satisfies the lower bounds given in the statement.

Proof of Theorem [\ref=melbounds_sn] (a) and (b).   (a) It follows immediately from Theorem [\ref=the:prac](b), and Lemma [\ref=lem:nrdiv], that for the events A and B as defined in Theorem [\ref=the:prac], [formula] (since γ(m)  ≤  γ(n)). The absolute lower bounds for this probability were proved in Theorem [\ref=the:prac](b).

(b) Since r is odd, d(2r)  =  2d(r), and so by Lemma [\ref=lem:oddnrdiv], [formula]. Then, by Theorem [\ref=the:melpractw], with A and B the events defined there, [formula] The absolute lower bounds for this probability were proved in Theorem  [\ref=the:melpractw](b). [formula]

It remains to determine the conditional probability that an element g of Sn or An has cycle structure CycType as in one of the cases 6-10 of Table 1, given that g has order dividing 3r with n,r and |gr| as in that case of Table 1. We will deduce Theorem [\ref=melbounds_sn](c) from the following result.

Let n,r and CycType be as in one of the cases 6 - 10 of Table 1, and let n  ≥  8. Let g be a uniformly distributed random element g in Sn (for cases 6 - 9) or An (for case 10). Let A denote the event that g has cycle type CycType as given in the relevant case of Table 1, and let B denote the event that g3r = 1 and |gr| = 3. Let γ  =  γ(3r) (see Definition ) so that γ satisfies

[formula]

Then

[formula]

[formula]

For cases 6 - 9,

[formula]

where a  =  1 for cases 6 - 8 and a = 1 / 2 for case 9, and c is as in (a). Also, if in the events A and B the random element is restricted to lie in An, then P(A|B) is unchanged from its value in Sn.

For case 10,

[formula]

Moreover, the lower bounds on P: = P(A|B) given in Table 2 hold.

The following technical result, used in the proof of Theorem [\ref=the:melpracthree] can be proved using similar techniques to those used in the proof of Theorem [\ref=the:melpractw].

Let n,r be as in one of the cases 6 - 10 of Table 1 with n  ≥  8. Let d be a divisor of 3r such that d  ≤  n. Then for cases 6 - 9 one of d = r, or d  ≤  r / 5, or d  =  3r / y with y∈{5,7,11,13}, and for case 10, one of d = r, or d  =  3r / 4, or d  ≤  3r / 5, or (n,r,d) = (13,8,12).

Suppose d is a divisor of 3r and d  ≤  n, say d  =  3r / c. Then 3(n - 6)  ≤  3r  ≤  cn. We claim that c  ≥  2. Suppose to the contrary that c = 1. Then n  ≤  9, so n is 8 or 9 and in either case r = 5. Thus 9  ≥  d = 3r = 15, which is a contradiction. So c  ≥  2.

In cases 6-9, [formula] and hence c is odd and c  ≥  3; the values c  =  3,5,7,11,13 give possibilities listed. Since [formula] we know [formula] and hence [formula] This leaves c  ≥  15 which implies d  ≤  r / 5.

Finally in case 10, [formula] and c  ≥  2. The values c = 3,4 and c  ≥  5 give the possibilities listed. The remaining value c  =  2 corresponds to d = 3(n - 5)  ≤  n which implies n  =  13, r = 8, and d = 12.

Proof of Theorem [\ref=the:melpracthree].   (a)  If g∈Sn has order dividing 3r, then the length d of any g-cycle divides 3r and d  ≤  n. By Lemma [\ref=lem:divmt], either d  ≤  r, or we have case 10 with (n,r,d) = (13,8,12). However in this exceptional case, the element g would be a 12-cycle, contradicting the fact that g is an even permutation. Thus in all cases d  ≤  r. Note that r  >  1 as n  ≥  8. We divide B into two disjoint events B1 and B2, where B1 is the event that g contains an r-cycle and B2 is the event that it does not. Then P(B)  =  P(B1)  +  P(B2).

If g has a cycle of length r and |gr|  =  3 then |g| divides 3r and g has cycle type 31r1 (for cases 6-8), 31r1 or 32r1 (for case 9), or 2131r1 (for case 10). Hence P(B1) is the proportion of such elements in Sn (for cases 6-9) or An (for case 10), namely

[formula]

Let D' denote the set of all divisors of 3r which are less than r. Then by Lemma [\ref=lem:divmt], for cases 6-9, [formula], where D1  =  {d∈D'|d  ≤  r / 5} and [formula], and for case 10, D' is the set of all divisors d of 3r with d  ≤  3r / 4. Then P(B2) is the proportion of elements g in Sn (for cases 6-9) or An (for case 10), all of whose cycle lengths lie in D' and for which |gr|  =  3. Let P'(n,3r) denote the proportion of elements in Sn of order dividing 3r and not containing an r-cycle. Then P(B2)  ≤  P'(n,3r) (for cases 6-9) and P(B2)  ≤  2P'(n,3r) (for case 10).

We shall now estimate P'(n,3r). This is the proportion of elements of Sn with all cycle lengths in D'. Considering the elements g∈Sn with all cycle lengths in D' according to the length d of the g-cycle containing the point 1, we have

[formula]

Suppose first that n,r are as in one of the cases 6-9, so [formula]. If d∈D1, then n - d  ≥  n - r / 5  >  4n / 5. Note also that n - d  ≤  n - 1  ≤  r  +  5  ≤  3r (since r  >  1 and r is odd). Then by Theorem [\ref=first],

[formula]

where γ is as in the statement. Next we consider the divisors in D2. In this case d  =  3r / y where y∈{5,7,11,13}. Then n - d  =  n - 3r / y  >  (y - 3)n / y. Hence applying Theorem [\ref=first] we have, with γ as in the statement,

[formula]

Thus, for cases 6-9,

[formula]

This proves (a) for cases 6-9, since P(B)  ≤  P(B1)  +  P'(n,3r).

Now consider case 10. Here r  =  n - 5 and for d∈D' either d  =  3r / 4 and n - d  >  n / 4, or d  ≤  3r / 5 and n - d  >  2n / 5. Also n - d  ≤  n - 1  ≤  r  +  4  ≤  3r and hence by Theorem [\ref=first],

[formula]

Hence

[formula]

This proves (a) for case 10.

(b)   For cases 6-9 let P'(A),P'(B) denote the probabilities of the events A and B respectively in the case where the random element is chosen only from An. Since 3r is odd, all elements of order dividing 3r lie in An and so P'(A)  =  2P(A), and P'(B)  =  2P(B). Consequently, the conditional probability P(A|B) remains the same for these cases if we restrict the elements to lie in An. Hence we only need to consider random elements in Sn for cases 6 - 9.

First we consider the case where A is the event that a uniformly distributed random element g in Sn (for cases 6-9) or An (for case 10) has cycle type 31r1 (for cases 6-9) or 2131r1 (for case 10). In this case we see from the discussion above that P(A)  =  aP(B1), where a  =  1 for cases 6,7,8 and 10, and a = 1 / 2 for case 9. Note P(B1) is given by (), so P(B1)  =  c / (3r)  >  c / (3n) with c as in part (b) for cases 6 - 9 and c = 1 for case 10. Since A  ⊆  B, the conditional probability satisfies

[formula]

For cases 6-9 the general assertions of (c) follow immediately from this, the fact that r  ≤  n, and from ([\ref=eq:melprac1]). For case 10, the assertion follows from this, the fact that r  ≤  n and from ([\ref=eq:lastline]).

Finally we have to show that the conditional probabilities are at least 1 / 3 for all cases except (n,r)  =  (31,25).

For cases 6-9, [formula] so that 3r is odd and not divisible by 9. Thus by Lemma [\ref=lem:oddnrdiv],

[formula]

so by ([\ref=eq:melprac1]),

[formula]

For n  ≥  124 we have γ  =  2 and so

[formula]

By Equations () and (), the conditional probability P(A|B) is at least

[formula]

In cases 6 and 7 we obtain

[formula]

For n  ≥  420 this is at least 1 / 3.

In case 8 we obtain

[formula]

For n  ≥  1050 this is at least 1 / 3.

In case 9 we obtain

[formula]

For n  ≥  12400 this is at least 1 / 3.

In case 10 since [formula] it follows that 3r is not divisible by 9. By Lemma [\ref=lem:oddnrdiv], [formula] and hence by ([\ref=eq:lastline])

[formula]

If n  ≥  124 we have γ = 2 and hence Therefore, by ([formula])

[formula]

For n  ≥  14700 this is at least 1 / 3.

For the remaining values of n we showed that the statement holds by computation in GAP. For sufficiently large n we computed all divisors of 3r and evaluated ([\ref=eq:first]) directly for cases 6 - 9, to obtain a better upper bound for P(B2) than that in ([formula]), and similarly for case 10. For some values of n this was not sufficient to show that P(A|B)  ≥  1 / 3. For these values of n we computed the proportions precisely to obtain the lower bounds given in the statement. [formula]

Finally we prove Theorem [\ref=melbounds_sn](c) using the results proved in Theorem [\ref=the:melpracthree].

Proof of Theorem [\ref=melbounds_sn] (c).   Note first that the absolute lower bounds for the conditional probability in Table 2 are proved in Theorem [\ref=the:melpracthree](b).

For cases 6 - 8, 3r is odd and not divisible by 9, so by Lemma [\ref=lem:oddnrdiv], [formula]. Also, for these cases, in Theorem [\ref=the:melpracthree](b) we have a = 1 and c  ≥  1 / 2, so

[formula]

which is greater than [formula]

For case 9 again we have d(3r)  ≤  8 / (35)(1 / 3)n1 / 3 but this time the parameters a and c of Theorem [\ref=the:melpracthree](b) have the values a  =  1 / 2 and c = 1 / 3. Thus

[formula]

Finally, for case 10, [formula] so 3r is not divisible by 9. Hence by Lemma [\ref=lem:oddnrdiv](b), d(3r)  ≤  16 / 105(1 / 3)(3r)1 / 3  <  16 / 35(1 / 3)n1 / 3. Thus

[formula]

[formula]

Acknowledgements

The authors acknowledge the support of ARC Discovery Project DP0557587.