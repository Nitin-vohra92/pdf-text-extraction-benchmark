A proof of Jarzynski's non-equilibrium work theorem for dynamical systems that conserve the canonical distribution

Introduction

During the past decade our understanding of the thermodynamics of non-equilibrium systems was considerably extended. Two relations have been derived which are valid for systems arbitrarily far away from equilibrium: a family of relations which are collectively called the fluctuation theorems [\cite=fluctEvans] [\cite=fluctGallavotti] [\cite=Adv] and Jarzynski's non-equilibrium work theorem [\cite=JarPRL]. The latter theorem relates the equilibrium free energy difference ΔF to the statistics of work W carried out on a system during a non-equilibrium transformation:

[formula]

Here the overbar indicates an average over many realizations of the transformation process which is driven by switching an external parameter from an initial to a final value. The maximum work theorem, which states that the average work performed on the system during such a transformation is bounded from below by the free energy difference, i.e. [formula], is a direct consequence of the Jarzynski relation. Besides providing new insight into the statistical mechanics of non-equilibrium processes, the Jarzynski identity has also been applied to extract equilibrium free energy differences from computer simulations [\cite=JarPRE] [\cite=Hummersim] [\cite=Oberhofer] [\cite=Lechner] [\cite=Kofke] and experiments [\cite=Bustamante] [\cite=Ciliberto] [\cite=Wang]. In particular, Liphardt et al. [\cite=Bustamante]� have determined the free energy required to unfold a single RNA chain from non-equilibrium work measurements and Douarche et al. [\cite=Ciliberto] have verified the Jarzynski equality for a mechanical oscillator that is driven out of equilibrium by an external force. Another experimental test of the Jarzynski equality was provided by Wang et al. [\cite=Wang] who considered a colloidal particle pulled through liquid water by an optical trap [\cite=Reid].

Jarzynski's theorem has been derived by various means. While the original proof [\cite=JarPRL] applies to systems evolving deterministically with and without coupling to a heat bath, in subsequent work [\cite=JarPRE] the proof was generalized to stochastic systems governed by a master equation. The latter approach comprised systems evolving under Hamiltonian dynamics, Langevin dynamics, isothermal dynamics and Monte Carlo dynamics. Alternative proofs for Markovian stochastic dynamics that satisfies detailed balance were given by Crooks [\cite=Crooks] and later by Lechner et al. [\cite=Lechner]. Another elegant derivation of the non-equilibrium work relation based on the Feynman-Kac theorem is due to Hummer and Szabo [\cite=Hummer], who also discussed how one can reconstruct free energies from non-equilibrium single-molecule pulling experiments. Crooks [\cite=CrooksPRE] also derived a generalized version of a transient fluctuation theorem [\cite=Adv] - in the following called the Crooks fluctuation theorem - for Markovian stochastic dynamics that is microscopically reversible. He showed in subsequent work [\cite=CrooksPRE2] that the Crooks fluctuation theorem and the Jarzynski equality can be regarded as special cases of a single theorem that follows if the system is microscopically reversible. This condition holds for Markovian dynamics that preserves the equilibrium distribution if left unperturbed [\cite=CrooksPRE2]. Jarzynski [\cite=Jarjstatp] and Evans [\cite=Evans] derived the Crooks fluctuation theorem also for deterministic, thermostatted systems. The transient fluctuation theorems [\cite=Adv] and Jarzynski's non-equilibrium work relation [\cite=JarPRL] are closely related, as highlighted in a recent paper [\cite=Reid].

In this paper we present an alternative proof of the Jarzynski identity under rather general assumptions: we consider a system evolving according to deterministic equations of motion that conserve the canonical distribution. The system, which is initially equilibrated at a given temperature, can either be decoupled from the heat bath during the switching process or remains coupled to the heat bath. In the latter case the influence of the heat bath is described by introducing one or more variables in an extended phase space and the time evolution of the system is non-Hamiltonian with equations of motion that do not conserve phase space volume. In contrast to prior derivations, we highlight in our proof the relation between the change in the phase space volume and the heat absorbed by the system during the non-equilibrium process. We show that this relation is strictly valid for systems that conserve the canonical distribution when the external control parameter is held fixed. Various dynamical systems obey the condition mentioned above, i.e. they leave the canonical distribution invariant under the time evolution: this is the case for Nose-Hoover dynamics, Nose-Hoover chains, Gaussian isokinetic dynamics and Hamiltonian dynamics and the proof presented here is valid for all these systems. A recent derivation of the Jarzynski identity by Cuendet [\cite=Cuendet] can be regarded as a special case of our proof.

The paper is organized as follows. The proof of the Jarzynski identity is the subject of section II. In section III we derive the Crooks fluctuation theorem using the same formalism. In section IV we discuss a few examples of dynamical systems for which the proof is valid.

Jarzynski's theorem

Consider a classical system with Hamiltonian H(x,λ) depending on the internal variables x (such as the positions and momenta of some particles in a box or the magnetic moments of a spin system) and an external parameter λ (such as the volume of the box confining the particles or an external magnetic field applied to the spin system). For a given value of the external parameter λ the canonical partition function is given by

[formula]

where β = 1 / kBT, T is the temperature and kB the Boltzmann constant. The Helmholtz free energy of the system is then given by

[formula]

Here we have neglected the prefactor of the partition function which is irrelevant for the present discussion.

We now consider a process where the external parameter λ is switched in a finite amount of time τ from some initial value λA to some final value λB starting from a system that is initially equilibrated with a heat bath of temperature T. The time dependence of λ, {λ(t),0  ≤  t  ≤  τ}, is completely arbitrary and in general the system will be driven out of equilibrium during the process. For a given realization of the process the time evolution of the system is given by the trajectory {x(t),0  ≤  t  ≤  τ} that can be either deterministic or stochastic and determines the amount of work W that is performed on the system during that realization. We repeat this process infinitely many times where the external parameter is always varied in the same manner and consider the ensemble of such non-equilibrium processes. Jarzynski has shown that the average of the work exponential e-  βW in the ensemble of non-equilibrium processes can be related to the free energy difference between the equilibrium states corresponding to the initial and final values of the external parameter, ΔF = FB - FA, via

[formula]

Here the overbar denotes an average over all realizations of the non-equilibrium process starting from canonically distributed initial conditions. Equation ([\ref=eq:jartheorem]) is Jarzynski's non-equilibrium work theorem. In the following, we will prove this relation for a system evolving deterministically in time. That is either the case for Hamiltonian dynamics where the system is decoupled from the heat bath during the switching process or for non-Hamiltonian isothermal molecular dynamics like Nose-Hoover dynamics, Nose-Hoover chains or Gaussian isokinetic dynamics where the system remains coupled to the heat bath. In the latter cases the coupling of the heat bath is purely through the equations of motion and there is no interaction energy between system and bath. The deterministic evolution in the phase space of the system and bath is given through some equations of motion

[formula]

where Γ  =  {x,y} includes the variables x describing the system and possibly some variables y describing the bath. The configuration Γ0 at time t = 0 determines uniquely the configuration Γt a time t later generating an invertible and differentiable mapping φt that describes the phase flow,

[formula]

For simplicity we denote φt by φ in the case t = τ. We assume that the (normalized) equilibrium distribution g(y) of the bath variables does not depend on the external parameter λ and we define the function ψ(y) =  - kBT ln g(y). Thus, we can construct an extended Hamiltonian as the sum of the total energy of the system, H(x,λ) and ψ(y):

[formula]

The equilibrium distribution of the combined system for a particular value of λ then is

[formula]

where we have used the fact that the distribution e-  βψ(y) is normalized in the y-subspace. For a switch of the parameter λ from λA to λB the free energy difference ΔF = FB - FA is given by

[formula]

where in the first step we have switched from the Hamiltonian of the subsystem to the extended Hamiltonian and in the second step we have multiplied and divided the integrand by e-  βH(φ- 1(Γτ),λA). Changing the integration variables from Γτ to Γ0  =  φ- 1(Γτ) yields

[formula]

where we have introduced the Jacobian [formula] of the mapping φ which is also called the phase space compression factor. If we define a 'work function' Wφ [\cite=Lechner] [\cite=Evans] [\cite=JarPRE2] as

[formula]

then Eq. ([\ref=eq:deltaF2]) can be rewritten as

[formula]

where the overbar denotes an average over the distribution of initial conditions, i.e. a canonical distribution in the x-subspace, and the distribution e-  βψ(y0) in the y-subspace. Equation ([\ref=eq:deltaF3]) looks already quite similar to the Jarzynski identity ([\ref=eq:jartheorem]), but what remains is to show that Wφ is indeed equal to the work W. The last term of the work function is the Jacobian determinant, while the other terms describe the change of the extended Hamiltonian along the trajectory starting in Γ0. Using Def. ([\ref=eq:extendedH]) the work function Wφ can be written as:

[formula]

where

[formula]

is the change of the total energy of the subsystem during the switching process. In the last part of Eq. ([\ref=eq:deltaH]) we have indicated that the energy H(x,λ) can change due to two different reasons. One contribution arises from changes in x:

[formula]

Q is the heat transferred from the heat bath to the system during the switching process. The other contribution originates from the change in λ:

[formula]

W is the work performed on the system by changing the external parameter.

In the following we will show that if the distribution [formula] is a stationary solution of the Liouville equation

[formula]

for fixed λ, then the work function Wφ equals the physical work W and thus Jarzynski's theorem is valid.

If a phase space density ρ is a stationary solution of the continuity equation ([\ref=eq:Liouville]), (i.e., [formula]=0), it must obey [formula]. In the case of ρ  =  e-  β(H(x,λ) + ψ(y)) / Zλ this reduces to

[formula]

or

[formula]

Using Euler's expansion formula [\cite=Euler] for the time derivative of the Jacobian,

[formula]

we finally obtain

[formula]

The first term of the above equation is just the time derivative of the heat [formula]. The second term is the rate of change of the function ψ(y):

[formula]

Integrating Eq. ([\ref=eq:dqdt2]) from 0 to τ yields

[formula]

which expresses the fact that the heat transfer to the extended system, [formula], exactly cancels the term including the phase space compression factor. Inserting this result into Eq. ([\ref=eq:deltacalH]) we obtain W = Wφ. With Eq. ([\ref=eq:deltaF3]) this completes the proof of Jarzynski's theorem:

[formula]

We stress, that the physical work ([\ref=eq:W]) depends only on the trajectory of the subsystem, however in Eq. ([\ref=eq:jarzynsikidentity]) we have to average the work exponential e-  βW over all degrees of freedom of the extended system, since the time evolution of the subsystem depends on the configuration of the extended system at t = 0.

Crooks Fluctuation theorem

With some additional assumptions the formalism presented in Sec. [\ref=proof] can also be used to derive the Crooks fluctuation theorem [\cite=CrooksPRE] [\cite=Evans] for dynamics conserving the canonical distribution. The Crooks theorem relates the probability that for the forward process the work W takes a value C to the probability that along the reverse process it takes a value - C. To derive this expression we note that for each forward path {(Γ(t),λ(t)),0 < t < τ} we have a reverse path {(ΓT(τ - t),λT(τ - t)),0 < t < τ} where the superscript T indicates that quantities that are odd under time reversal (such as momenta) have changed their sign. The work, heat, and energy difference along the reverse path are defined as above for the forward direction and take the negative of the respective forward values.

We assume in the following that the extended Hamiltonian H is invariant under time reversal and that both the forward and the reverse path start from equilibrium distributions, i.e. ρA(Γ0) = eβFAe-  βHA(Γ0) and ρB(ΓTτ) = eβFBe-  βHB(ΓTτ). Then

[formula]

Since the Jacobian of the time reversal mapping is unity, i.e. [formula], and the extended Hamiltonian is invariant under time reversal we obtain

[formula]

Inserting the relation

[formula]

into Eq. ([\ref=eq:FT2]) yields

[formula]

where we have used the fact that the work is odd under time reversal, i.e. WR =  - WF. Changing the integration variables in the denominator from Γτ to Γ0  =  φ- 1(Γτ) one obtains

[formula]

Thus, the Crooks fluctuation theorem is valid provided the dynamics conserves the extended canonical distribution and the extended Hamiltonian is invariant under time reversal.

Discussion

We have shown that the Jarzynski identity is valid for deterministic dynamics that conserves an extended canonical distribution of the form of Eq. ([\ref=eq:equilibrium]). Let us now consider a few examples of such dynamical systems.

Hamiltonian dynamics

For Hamiltonian dynamics the proof of Section II simplifies considerably since we do not need to consider the y-subspace. Furthermore, the phase space volume is conserved, i.e. [formula], and no heat Q is absorbed by the isolated system. Thus the work function Wφ trivially equals the physical work W and the Jarzynski relation holds.

One can also consider the case when the system of interest and the heat bath form a large Hamiltonian system and the coupling between them is weak. In this case, ψ(y) is just the Hamiltonian of the heat bath and the phase space compression factor in Eq. ([\ref=eq:heateq]) is identically zero. So, Eq. ([\ref=eq:heateq]) states that the heat Q absorbed by the system is just equal to the negative change of the internal energy of the heat bath, [formula].

Nose-Hoover dynamics and Nose-Hoover chain dynamics

In the case of Nose-Hoover dynamics [\cite=Nose] [\cite=Hoover] the heat bath is represented by an additional degree of freedom ζ and effective mass Q and the equilibrium distribution function is the extended canonical distribution [\cite=Hoover]

[formula]

where H is the Hamiltonian of the system and (q,p) are the positions and momenta of the particles. Thus relation ([\ref=eq:equilibrium]) is fulfilled if one identifies x with (p,q), y with ζ and sets [formula] and the Jarzynski identity holds. In order to enhance ergodic sampling, the Nose-Hoover approach is often augmented with chains of Nose-Hoover thermostats [\cite=Martyna]. The corresponding equations of motion preserve the phase space distribution

[formula]

that has the form of Eq. ([\ref=eq:equilibrium]) which is required for the validity of the Jarzynski identity and the Crooks fluctuation theorem.

Gaussian-isokinetic dynamics

In contrast to the Nose-Hoover dynamics that fixes the temperature of the system the Gaussian isokinetic equations fix the kinetic energy [\cite=isoEvans] [\cite=isoHoover]. In the thermodynamic limit the corresponding equilibrium distribution [\cite=EvansMoriss] is the so called isokinetic distribution

[formula]

This distribution is canonical in configuration space and microcanonical in momentum space. If the kinetic energy of the system is independent of the external parameter, i.e.

[formula]

the work performed on the system can be rewritten as

[formula]

Thus

[formula]

implying that the heat transfer to the system is given by

[formula]

The equilibrium distribution ([\ref=eq:isokineticdist]) takes the form of Eq. ([\ref=eq:equilibrium]) if one identifies [formula], [formula], [formula] and replaces H(x;λ) by V(q;λ). Since the definition of work and heat remain valid if one replaces the Hamiltonian function by the potential energy, the Jarzynski theorem and the Crooks fluctuation theorem are valid for Gaussian isokinetic dynamics.

Conclusion

We have presented a proof of the Jarzynski theorem and the Crooks fluctuation theorem. This proof is valid for systems evolving under deterministic equations of motion that conserve an extended factorizing canonical distribution of the form of Eq.([\ref=eq:equilibrium]). Several dynamical systems that meet the latter condition have been discussed. The crucial part of the derivation is a relation between the heat transferred to the extended system during the switching process and the phase space compression factor of the dynamics which was established using Euler's expansion formula.

Acknowledgments

We thank C. Jarzynski for useful discussions. This work was supported by the Austrian Science Fund (FWF) under Grant No. P17178-N02.