plus1pt

Two-term recurrence formulae for indefinite algebraic integrals

Introduction

To be maximally useful in science and engineering applications, the symbolic evaluation of an indefinite integral should be expressed as compactly as possible and in a form suitable for verification by differentiation, and hold in the entire complex plane whenever feasible. With free parameters in the integrand taken to be real, it should further be continuous on the real line where the integrand is integrable along it, and preferably be real on this line if the integrand is real everywhere on it, and also not explicitly involve the imaginary unit unless the integrand does too. When these goals are in partial conflict, the resolution should be sought by sacrificing compactness first, absence of imaginary offset and imaginary unit next, and continuity at integrable poles last.

These principles will find, if not adoption, then ready approval. Indeed, the vast majority of the integrands arising in practice do not involve the imaginary unit or complex parameters (or else they easily separate into real and imaginary parts) and their antiderivatives are needed for real values of the integration variable only, where the absence of unexpected, symbolically often hard to localize discontinuities ensures that definite integrals calculated according to Newton and Leibniz will be correct. By default, an integrator should therefore place the unavoidable branch cuts such in an antiderivative that they do not traverse the real line, employing to this end functional equations for the logarithmic and related functions implicated in those cases. Note that the details may depend on the actual function implementation.

To the recurrent chagrin of countless users, the automated integrators of today's computer-algebra systems do not systematically respect these principles. Consider the parameterless example of

[formula]

in which the integrand is analytic everywhere on the real line. The first reduction step invokes a recurrence formula to raise the exponent - 2 in the integrand to - 1, while the second step employs transformations and evaluations chosen for compliance with the principles stated. The major commercial contenders, (version 16) and (version 8), here produce discontinuous antiderivatives of about ten times this size; is able to correct for the discontinuity (an imaginary step at x  =  1), whereas bungles definite integrals that straddle the discontinuity (a real jump near x  =   - 0.493).

The short example already illustrates the potential of combining suitable recurrence relations with carefully chosen terminal evaluations to achieve fast and strong automated symbolic integration in accordance with the above principles. This approach is currently being explored in the rule-based integrator [\cite=JR], for instance. The purpose of the present publication is to furnish efficient recurrence formulae for the reduction of algebraic integrals that are regularly encountered in practice; recipes for a properly principled evaluation of the terminal instances of the integrals are to be published separately.

Being two-term relations, the recurrence formulae presented here replace an algebraic integrand with a simpler one while liberating a corresponding algebraic part of the antiderivative. Specifically, they apply to integrands that involve products of arbitrary powers of linear or quadratic polynomials, or isolated arbitrary powers of cubic or quartic polynomials; this naturally includes integer positive and negative powers. The relations increment or decrement the exponents in steps of unity, either separately or in up-down pairs, and leave the form of an integrand unchanged. Accordingly, they should lend themselves especially to the automated symbolic integration of algebraic functions in which polynomials are raised to high positive or negative powers.

Also covered are integrands containing the exponential factor exp (a  +  bx) along with such powers of polynomials; this exponential derives from the power of a linear polynomial via Euler's famous limit: exp (a  +  bx)  =   lim n  →    ∞(1  +  a / n  +  b / n  x)n. Insofar as simple analog formulae for the trigonometric factors cos (a  +  bx) and sin (a  +  bx) exist, they are supplied as well; otherwise these integrands should be split such that the integrals involve either exp [  i  (a   +   bx)] or exp [ -  i  (a   +   bx)], where ±  ia and ±  ib replace the parameters a and b. Note that the exponential factors cannot be recurred on because their parameters are unrelated to the exponent of the linear polynomial.

Quite generally, indefinite integrals of the present kind with generic exponents evaluate to special cases of those hypergeometric functions that admit one-dimensional Euler-type integral representations. With the sum of polynomial degrees in the algebraic integrands ranging from two to four, the Gauss function 2F1, the Appell function F1, and the Lauricella function FD of three variables result, and where an exponential factor accompanies polynomials with a combined degree of one or two, the incomplete gamma function (which is a special case of Kummer's confluent hypergeometric function) and the Humbert function [formula] appear. The recurrence relations for the integrals are thus equivalent to relations among contiguous instances of these hypergeometric functions, and they are of interest mainly for integrals whose evaluation reduces to elementary functions or to the canonical elliptic integrals.

Recurrence formulae for integrands that include the power of a linear polynomial, say (a  +  bx)m, admit profitable transformations once this factor is specialized to the monomial xm by setting a  =  0 and b  =  1. Relation [\eqref=9A1] from Section [\ref=9A] below, for example, can thus be specialized to

[formula]

The substitution [formula], [formula] now yields

[formula]

where λ  =  (m   +   1) / q. In the new kind of integrand, the monomial exponent can be changed only in steps of size q, and in the present relation the monomial can be eliminated altogether from the integrands by setting m  =  0. Recurrence formulae of this type are needed for the reduction of elliptic integrals in particular, for which q  =  2.

In a further step, the monomial power may be split by substituting [formula], and then xrn and xsp be merged with the respective other factors:

[formula]

where μ  =  (m  +  rn  +  sp  +  1) / q. The monomial exponent has now clearly lost its independence. Note that recurrence relations transformed in these ways hold for integrands involving arbitrary fractional exponents because possible branch-cut crossings affect all terms of a relation equally; thus m, n, p, q, r and s in the above are unrestricted apart from the proviso that q  ≠  0. The same transformations can obviously be applied to relations in which the integrand includes an exponential factor. The conversion of the formulae presented below, however, is left to the fortunate reader since this is a fairly straightforward task whose combined results would have consumed an unwarranted amount of space here.

The present formula collection is kept at a comfortable size by limiting the sum of polynomial degrees in the algebraic integrands at four; to just include, in the notation of the Abstract, the degree-five product P1m  Q4n in the same way would roughly double the size already. Among the degree-four integrands, no combination is omitted but P1m  Q3n, as it could aid a systematic handling of elliptic integrals (for integer m and odd integer 2n) alongside its cousin P1m  Q4n only. The combined degree of powers that accompany an exponential (or trigonometric) factor of linear argument is even limited at two: the degree-three products E1P3n, E1P1m  Q2n, and E1P1m  Q1n  S1p already appear to be of no interest in practice, and their integrals do not relate to one of the established hypergeometric functions either. Exponential factors with higher-degree arguments are ignored for the same reason.

Still, when adapted relations are applied to suitably transformed integrals, the present formulae suffice to handle any elliptic integrand. Relations for the integrand factors xm  Q2n and xm  Q1n  S2p with the substitution [formula] in particular encompass two-term equivalents of the multiterm recurrence formulae traditionally employed to reduce general elliptic integrals after the x1 and x3 terms of the radicand have been annihilated by a Möbius transformation and the even part of the rational cofactor has been expanded into partial fractions with respect to x2. Note that the Möbius transformation generates an ugly piecewise-constant prefactor and that the expansion step may introduce complex coefficients, but these effects beset any reduction to canonical elliptic integrals.

Recurrence relations for rational integrands multiplied by a power P3n or P4n are actually made redundant for any integer 4n in this way; the direct reduction being much easier and more general, however, it is supported here for the isolated powers, although the terminal evaluation may still require a Möbius transformation. Moreover, a piecewise-constant prefactor would arise for odd 2n even if an isolated radicand has repeated roots, but is then better avoided, as it is rarely a natural part of the elementary antiderivative that results. The other degree-three and degree-four combinations of powers covered below must be regarded as indispensable anyway; so the elliptic cases among them are best reduced like the elementary ones, and the fractional powers just collected into a single factor prior to the terminal evaluation, introducing a piecewise constant which fuses with that from a subsequent Möbius transformation.

For each integrand, some of the recurrence relations will fail if certain polynomial roots coincide, because the discriminants or resultants appear as factors in front of the integrals. Such confluent roots can be fused, and thereby made harmless, through a rational refactorization of the integrand, which lowers the total degree, but introduces ugly piecewise-constant prefactors in general. Dedicated formulae are therefore provided here for all cases of degeneracy from confluent polynomial roots, whereby the need for refactorization is avoided, or at least deferred until the terminal integral is evaluated. In formulating mutually exclusive conditions for the various cases of degeneracy below, the polynomial factors have been assumed to possess nonzero leading coefficients. The conditions and associated recurrence formulae are most easily verified on polynomials having symbolic roots of the various possible confluence patterns.

The two-term recurrence relations have been derived by the method of undetermined coefficients and can be checked simply by differentiation. To facilitate their use in computer-algebra systems, they are listed here in a linear functional notation without subscripts or superscripts, which should be self-explaining. Extensive abbreviation of repeated subexpressions on both the integrand and the formula level serves to condense the listing and to expose the structure of the relations. While two-term formulae for the simplemost integrands (a  +  bx  +  cx2)n, (a  +  bx)m(c  +  dx)n and exp (a  +  bx)(c  +  dx)n can be found in standard tables of integrals (so in Gradshteyn-Ryzhik [\cite=GR] as item 2.260.2; as items 2.151, 2.153, 2.155; and for a  =  c  =  0, d  =  1 as items 2.321.1, 2.324.1), they are included below for convenience.

The state of the art prior to the present publication is reflected in a 1948 book by Timofeyev [\cite=Ti] (there is no evidence for the 1933 edition cited in [\cite=GR]) and a recent communication by Barnett [\cite=Ba].

theequation thesection # 22

Integrands involving

To exclude integrands with confluent roots, the following recurrence should be applied only if the quadratic discriminant does not vanish: 22. Note that the relation can be used backwards for its own inverse. .

# 22

Integrands involving

Abbreviations used with these integrands: , 22, 22.

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the cubic discriminant does not vanish: 22. , where 22, 22.

, where 22, 22.

theequation thesubsection

Singly degenerate integrands

Here the cubic polynomial is required to possess a double root whence its discriminant must vanish: 22. To exclude doubly degenerate cubics, the recurrence should be applied only if additionally 22. Note that the relation can be used backwards for its own inverse. , where 22.

# 22

Integrands involving

Abbreviations used with these integrands: , 22, 22, , 22, 22. , 22, 22, , 22.

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the quartic discriminant does not vanish: 22. , where 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

Singly degenerate integrands

Here the quartic polynomial is required to possess one double root whence its discriminant must vanish: 22. To exclude doubly degenerate quartics, the recurrences should be applied only if additionally 22. , where 22, 22, 22, 22.

, where 22, 22, 22.

Doubly degenerate integrands

Now the quartic polynomial is required to possess a triple root whence the following must vanish: 22. To exclude triply degenerate quartics, the recurrence should be applied only if additionally 22. Note that the relation can be used backwards for its own inverse. , where 22, 22.

Now the quartic polynomial is required to possess two double roots whence the following must vanish: 22. To exclude triply degenerate quartics, the recurrence should be applied only if additionally 22. Note that the relation can be used backwards for its own inverse. , where 22.

# 22

Integrands involving

To exclude integrands with confluent roots, the following recurrences should be applied only if the resultant of the linear polynomials does not vanish: 22. Note that each relation can be used backwards for its own inverse. . .

# 22

Integrands involving

Note that each recurrence can be used backwards for its own (or its partner's) inverse. . . .

# 22

Integrands involving

Abbreviations used with these integrands: , 22.

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the overall discriminant does not vanish: 22. , where 22, 22.

, where 22, 22.

, where 22, 22, 22.

, where 22, 22, 22.

, where 22, 22, 22.

, where 22, 22, 22.

Singly degenerate integrands

Now the root of the linear factor is required to coincide with one root of the quadratic whence the corresponding resultant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. . , where 22, 22.

.

Now the quadratic polynomial is required to possess a double root whence its discriminant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. . , where 22.

.

# 22

Integrands involving

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the quadratic discriminant does not vanish: 22. , where 22, 22.

, where 22.

Degenerate integrands

Now the quadratic polynomial is required to possess a double root whence its discriminant must vanish: 22. Note that each recurrence can be used backwards for its own inverse. . . .

# 22

Integrands involving

Abbreviations used with these integrands: , 22, 22. , 22, 22, , 22.

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the overall discriminant does not vanish: 22. , where 22, 22, 22, 22.

, where 22, 22, 22, 22.

, where 22, 22, 22, 22.

Integrands with a single cross-degeneracy

Here the two quadratics are required to have one root in common whence their resultant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. , where 22, 22, 22, 22.

, where 22, 22, 22.

, where 22, 22.

Integrands with a single self-degeneracy

Here the first quadratic polynomial is required to possess a double root whence its discriminant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. , where 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22.

, where 22, 22.

, where 22, 22, 22.

Doubly degenerate integrands

Now the two quadratics are required to have two roots in common whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also a*f - b*e + 2*c*d 0. Note that each relation can be used backwards for its own inverse. , where 22.

.

Now the first quadratic is required to possess a double root which coincides with one root of the second quadratic whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. , where 22, 22.

, where 22.

.

Now both quadratics are required to possess a double root whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. , where 22, 22.

.

# 22

Integrands involving

Abbreviations used with these integrands: , 22.

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the overall discriminant does not vanish: 22. , where 22.

, where 22.

, where 22, 22, 22.

Singly degenerate integrands

Now the roots of the first two linear factors are required to coincide whence the corresponding resultant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. . . . .

# 22

Integrands involving

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the resultant of the linear polynomials does not vanish: 22. , where 22, 22.

, where 22.

, where 22, 22.

Degenerate integrands

Now the roots of the two linear factors are required to coincide whence the corresponding resultant must vanish: 22. Note that each recurrence can be used backwards for its own (or its partner's) inverse. . . . . . .

# 22

Integrands involving

Abbreviations used with these integrands: , 22, 22, 22. , 22, 22. , 22, 22.

Nondegenerate integrands

To exclude integrands with confluent roots, the following recurrences should be applied only if the overall discriminant does not vanish: 22. , where 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

Integrands with linear-linear cross-degeneracy

Here the roots of the two linear factors are required to coincide whence the corresponding resultant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. , where 22, 22, 22.

, where 22, 22, 22.

, where 22, 22, 22.

, where 22, 22, 22.

. , where 22, 22, 22.

, where 22, 22, 22.

Integrands with linear-quadratic cross-degeneracy

, where 22, 22, 22.

, where 22, 22, 22, 22.

, where 22, 22.

, where 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22.

, where 22, 22, 22.

, where 22, 22.

, where 22, 22, 22, 22.

, where 22, 22, 22.

, where 22, 22, 22, 22.

Integrands with a self-degenerate quadratic

Here the quadratic polynomial is required to possess a double root whence its discriminant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. , where 22, 22, 22.

, where 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22, 22, 22, 22.

, where 22, 22, 22.

, where 22, 22, 22, 22, 22.

, where 22, 22, 22.

Doubly degenerate integrands

Now the roots of both linear factors and one root of the quadratic are required to coincide whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. , where 22.

, where 22.

. .

Now the roots of the two linear factors are required to coincide while the quadratic is required to possess a double root whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. . , where 22.

. , where 22.

Now the roots of the two linear factors are required to coincide with different roots of the quadratic whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. . , where 22, 22.

. .

Now the quadratic is required to possess a double root which coincides with the root of the first linear factor whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. , where 22.

. , where 22, 22.

. , where 22.

, where 22, 22.

# 22

Integrands involving

Abbreviations used with these integrands: , 22, 22, 22. , 22, 22.

Nondegenerate integrands

, where 22.

, where 22, 22, 22.

, where 22, 22, 22, 22.

Singly degenerate integrands

Here the roots of the first two linear factors are required to coincide whence the corresponding resultant must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. , where 22, 22.

, where 22, 22.

, where 22.

, where 22.

. , where 22, 22, 22.

, where 22, 22, 22.

, where 22, 22, 22.

Doubly degenerate integrands

Now the roots of the first three linear factors are required to coincide whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. , where 22.

. . .

Now the roots of the first two linear factors are required to coincide as are the roots of the last two linear factors whence the following must vanish: 22. To exclude additional degeneracies, the recurrences should be applied only if also 22. Note that each relation can be used backwards for its own inverse. . . .

Acknowledgments

The computational advantage and systematic feasibility of the two-term recurrences occured to the author in the course of transoceanic discussions with Albert D. Rich about the development of his rule-based integrator . Corresponding formulae for trigonometric integrands from the book by Timofeyev and from a table of indefinite integrals by W. Gröbner et al. (Integraltafel, 1. Teil: Unbestimmte Integrale, 1944), reproduced in Gradshteyn-Ryzhik as items 2.551.1 and 2.554.1 and as item 2.558.1, provided seminal inspiration. and results for the example integral were supplied by denizens of the newsgroup.