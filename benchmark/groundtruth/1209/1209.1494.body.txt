CorollaryLemmaTheoremDefinition

Time to a single hybridization event in a group of species with unknown ancestral history

Introduction

Hybridization has an important role in the evolution of new species [\cite=Arnold] [\cite=Mallet]. In phylogenetic analysis, there is an increasing interest in dealing with this issue [\cite=Kubatko] [\cite=JSO] [\cite=YDN]. The usual phylogenetic tree is replaced by a phylogenetic network [\cite=HRS], and in a Bayesian approach, a prior for the network is needed [\cite=JSO]. Very little is known about suitable prior distributions for the topology and node times for such networks. This paper represents an attempt to understand the situation better, and provides some justification for using an exponential distribution as a prior for the hybridization time.

The particular biological motivation for this study originates from a theoretical question on the evolution of polyploidy in plants. Polyploids can arise from within a single species (autoployploids) or via hybridization between two species (allopolyploids) in which the genomes of the two parental species are both present in the hybrid. For example, suppose it is known that a tetraploid species of interest resulted from a hybridization between a pair of diploid species which are ancestral to a clade of n extant species. The following question arises: what can we say about the time of the hybridization event prior to a phylogenetic analysis of the genetic data?

The same question can be applied to homoploid hybridization, in which there is a hybridization but no change in ploidy. However we will refer to the allopolyploid case above, since the species produced by the Yule process and the hybrids can be conveniently called diploids and tetraploids.

We assume a Yule model with the speciation rate λ conditioned on n extant species and model the hybridization events by a Poisson process with intensity β giving the number of hybridizations per pair of coexisting diploid species per unit of time calibrated by λ. This means that if there are k coexisting diploid species during a time period t, then the number of hybridizations Nk(t) during this period has a Poisson distribution

[formula]

with expectation

[formula]

Counting time backwards, let Tk stand for the time between two consecutive speciation events during which the Yule tree had k branches, [formula], see Fig. [\ref=fig0]. In the conditioned Yule model setting (a random phylogeny for n extant species under the assumption of an improper uniform prior for the time of origin [\cite=GT]) the times [formula] are independent and exponentially distributed random variables with parameters [formula] respectively. Replacing t by Tk in formula [\eqref=Poim] and writing Nk = Nk(Tk) gives

[formula]

where the compound parameter [formula] can be understood as a relative hybridization rate. Thus averaging over possible species trees results in the mean total number of hybridizations [formula] being

[formula]

The main finding of this paper is that the distribution of the time τn to a single hybridization event can be approximated by an exponential distribution with parameter 2λ. This obtained by showing, see Corollary [\ref=cor], that r-th moment of 2λτn converges to r! which is the r-th moment of an exponential distribution with parameter 1. Our simulations show that even for moderate values of n and reasonable values of γ the exponential approximation for the time to hybridization seem to be satisfactory.

The single hybridization condition

Given that there was exactly one hybridization event, N = 1, we denote by τn the time to hybridization counted backwards from the time of observation. If N = 0 or [formula], we put τn  =    ∞  . In this section we show among other things that the single hybridization condition has probability

[formula]

where [formula]. Observe that if τn  <    ∞  , then for some [formula] hybridization occured during the period when there were κn ancestral species.

For any 2  ≤  k  ≤  n <   ∞

[formula]

Proof of Lemma [\ref=le1]. Replacing t by Tk in the right hand side of [\eqref=Poi] yields

[formula]

and since

[formula]

we obtain

[formula]

and therefore

[formula]

Summing over [formula] we arrive at [\eqref=prob], then the assertion of Lemma [\ref=le1] follows by dividing the last expression by [\eqref=prob].

If we assume that n diploids and a single hybridization have been observed, then we can apply two basic methods of estimation for the plausible value of the key parameter γ. The method of moments estimate [formula] is immediately obtained from [\eqref=Poit] by substituting the observed value N = 1 for E(N). We can also treat the expression for P(τn  <    ∞  ) in [\eqref=prob] as a likelihood function for γ

[formula]

and from it find a maximum likelihood estimate n. It turns out that for large n the two estimates are close in value

[formula]

To show [\eqref=mle] we observe first that the equation L'() = 0 for n takes the form

[formula]

where

[formula]

By the Cauchy-Schwarz inequality we have

[formula]

which together with [\eqref=ml] yields [formula]. On the other hand, since for [formula]

[formula]

it follows from [\eqref=ml] that [formula] and [formula].

Exact formula for any moment of τn

For any [formula]

[formula]

where dj = (1 + j)- 1(1 + γj)- 1.

Proof of Lemma [\ref=rth]. Under the Poisson model for the flow of hybridization events

[formula]

where X is a random variable uniformly distributed on

[formula]

Convergence to an exponential distribution

For 2  ≤  k  ≤  n <   ∞   and any natural number r define ηγ,k,n and ζγ,n,r by

[formula]

For 2  ≤  k  ≤  n <   ∞   and [formula] the following bounds are valid

[formula]

The discussion in the end of Section [\ref=Ssh] concerning [\eqref=mle] showed that it is important to consider the values of γ close to [formula]. In Figure [\ref=fig10] we plotted the upper bounds in [\eqref=wok] with [formula] as functions of n for the first three moments r = 1,2,3.

Uniformly over all (k,n) such that 2  ≤  k  ≤  n <   ∞

[formula]

Moreover, as nγ  →  0 for any fixed natural number r

[formula]

uniformly over λ∈(0,  ∞  ).

Corollary [\ref=cor] is a straightforward consequence of Theorem [\ref=the] proved next. Note that in the case [formula] the condition nγ  →  0 is equivalent to n  →    ∞  .

Proof of Theorem [\ref=the]. According to Lemma [\ref=le1]

[formula]

and [\eqref=wk] follows from

[formula]

To prove [\eqref=wok] observe first that

[formula]

Clearly, for any [formula] we have

[formula]

Thus Lemma [\ref=rth] yields

[formula]

and applying [\eqref=gin] we get inequalities

[formula]

resulting in [\eqref=wok].

Simulation results and discussion

We have checked and illustrated our analytical results using simulations. Our simulation algorithm is based on the following steps to obtain a single hybridization time:

In Figure [\ref=fig1] the mean and variance of τn as functions [\eqref=exp] and [\eqref=var] of the number n of candidate species are drawn against the values obtained from simulations. Here λ = 1 and [formula] with n ranging from 2 to 200.

Figure [\ref=fig2] shows simulated conditional distributions of τn. We can see how the observed distribution profile approaches the exponential curve as n increases from 2 to 20.

The Yule model for the unknown species tree is not very realistic but it is a very convenient tool for phylogenetic calculations, see for example [\cite=BS]. Therefore, the presented here results should be viewed as just a starting point for the issues raised in this paper. More biologically relevant extensions of the model studied here should take into account the possibility of hybridization between a pair of ancestral species of which either one or both have no direct descendants at present. To include extinct species in the analysis one can use the so-called conditioned birth-death processes developed in [\cite=AP] [\cite=GT] and successfully used as species tree models for various purposes, see for example [\cite=SB]. An important additional parameter arising in this more general setting is the extinction rate μ for the ancestral species. An crucial biological feature missing in the classical birth-death processes modeling species trees is geographical structure. Obviously, the probability of hybridization is conditional on geographical proximity. This could presumably be taken into account by combining our model with some statistical biogeography model [\cite=LRDS] [\cite=R]. Another desirable feature missing in the current analysis is the decaying hybridization rate: the more divergent two species become, the less probable hybridization between them will be. Of course, one should not limit oneself only to one hybridization event allowing for multiple hybridizations. Furthermore, hybrids can speciate via ordinary speciation, and hybridizations between hybrids also occur, so these processes should be included in a general model.

Acknowledgments

KB and GJ were supported by Centre for Theoretical Biology at the University of Gothenburg. BO and SS were supported by Swedish Research Council grants 2009-5202 and 621-2010-5623. KB was supported by Stiftelsen för Vetenskaplig Forskning och Utbildning i Matematik, Knut and Alice Wallenbergs travel fund, Paul and Marie Berghaus fund, Royal Swedish Academy of Sciences, Wilhelm and Martina Lundgrens research fund.