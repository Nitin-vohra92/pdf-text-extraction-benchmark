Corollary Lemma

On balanced incomplete block designs with specified weak chromatic number

Introduction

A balanced incomplete block design of order v, block size k and index λ, denoted a (v,k,λ)-BIBD, is a pair (V,B) such that V is a set of v elements (called points) and B is a collection of k element subsets of V (called blocks) such that each unordered pair of points in V is contained in exactly λ blocks in B. A partial (v,k,λ)-BIBD is defined similarly except that each pair of points in V must be contained in at most λ blocks in B.

For a positive integer c, a weak c-colouring of a (partial) (v,k,λ)-BIBD is a colouring of the points of the design with c colours in such a way that no block of the design has all of its points receive the same colour. A (partial) (v,k,λ)-BIBD is said to be weakly c-chromatic, or to have weak chromatic number c, if c is the smallest number of colours with which the design can be weakly coloured. Since weak colourings are the only colourings of designs we will consider in this paper, we will often omit the adjectives 'weak' and 'weakly' in what follows.

It is obvious that if there exists a (v,k,λ)-BIBD then

[formula]; and

[formula].

Wilson [\cite=Wi] famously proved that (i) and (ii) are asymptotically sufficient for the existence of a (v,k,λ)-BIBD. That is, for any positive integers k and λ with k  ≥  3, there exists an integer N'(k,λ) such that if v  ≥  N'(k,λ) then (i) and (ii) are sufficient for the existence of a (v,k,λ)-BIBD. In this paper, we will extend Wilson's result to c-chromatic BIBDs by showing that, for any positive integers c, k and λ, such that c  ≥  2, k  ≥  3 and (k,c)  ≠  (3,2), (i) and (ii) are asymptotically sufficient for the existence of a c-chromatic (v,k,λ)-BIBD. For the sake of brevity, we will call positive integers v which satisfy (i) and (ii) (k,λ)-admissible. Note that if an integer v is (k,λ)-admissible then so is every positive integer congruent to v modulo k(k - 1).

Weak colourings were first introduced in the context of hypergraphs, and this naturally led to the study of weak colourings of block designs. A simple counting argument [\cite=Ro] shows that 2-chromatic (v,3,λ)-BIBDs exist only for v  ≤  4. For a positive integer λ it is known that a 2-chromatic (v,4,λ)-BIBD exists for each (4,λ)-admissible integer v, with almost all of the problem solved in [\cite=HoLiPh1] and [\cite=HoLiPh2] and the outstanding cases resolved in [\cite=RoCo] and [\cite=FrGrLiRo]. Ling [\cite=Li] has proved that a 2-chromatic (v,5,1)-BIBD exists for each (5,1)-admissible integer v. It has been shown by de Brandes, Phelps and Rödl [\cite=DePhRo] that for all integers c  ≥  3 there is an integer N(c,3,1) such that for all (3,1)-admissible integers v  ≥  N(c,3,1) there is a c-chromatic (v,3,1)-BIBD. The analogous result for (v,4,1)-BIBDs has been proved by Linek and Wantland [\cite=LiWa]. For a survey of colourings of block designs see [\cite=RoCo]. The main result of this paper is as follows.

Let c, k and λ be positive integers such that c  ≥  2, k  ≥  3 and (c,k)  ≠  (2,3). Then there is an integer N(c,k,λ) such that there exists a weakly c-chromatic (v,k,λ)-BIBD for all (k,λ)-admissible integers v  ≥  N(c,k,λ).

In Section 2 we give some definitions that we will require throughout the paper and prove a number of preliminary results. Sections 3, 4 and 5 deal with BIBDs with block size at least 4. In Section 3 we find various examples of 2-chromatic BIBDs, and these are then used in Section 4 to obtain various examples of c-chromatic BIBDs for each c  ≥  2. In Section 5 we are then able to use results from Sections 2, 3 and 4 to demonstrate the asymptotic existence of c-chromatic BIBDs for each c  ≥  2. Finally, in Section 6, we deal with the case of BIBDs with block size 3 (that is, triple systems) and thus complete the proof of Theorem [\ref=MainTheorem].

Preliminary definitions and results

Let v and λ be positive integers and let K be a set of positive integers. A group divisible design of order v and index λ with block sizes from K, denoted a (K,λ)-GDD, is a triple (V,G,B) such that V is a set of v elements (called points), G is a partition of V into parts (called groups) and B is a collection of subsets of V (called blocks) such that |B|∈K for all B∈B, each unordered pair of points in different groups is contained in exactly λ blocks, and no unordered pair of points in the same group is contained in any block. If, for integers [formula] and [formula], G contains ai groups of size gi for [formula] and G contains no groups of any other size then we say that (V,G,B) is of type [formula]. We will abbreviate ({k},λ)-GDD to (k,λ)-GDD. A (k,1)-GDD of type gk is more commonly referred to as a transversal design with group size g and block size k.

We say that a partial BIBD (V1,B1) is embedded in a partial BIBD (V2,B2) if V1  ⊆  V2 and B1  ⊆  B2. A decomposition of a graph G is a collection [formula] of subgraphs of G whose edge sets partition the edge set of G. We extend this definition to edge-coloured digraphs in the obvious way. A (v,k,λ)-BIBD can be considered as a decomposition of the λ-fold complete graph with v vertices into copies of the complete graph with k vertices.

To simplify the presentation of many of our results, we will introduce a generalisation of the well-known concept of a blocking set. We will say that a collection [formula] of pairwise disjoint subsets of the point set of a design is a blocking system for that design if each block of the design has a non-empty intersection with at least two of the sets in [formula]. We will also refer to such a blocking system as a c-blocking system if we wish to specify the number of sets in the system or as an [formula]-blocking system, where si  =  |Si| for each [formula], if we wish to specify the sizes of the sets in the system. Obviously the existence of a c-blocking system for a design implies the existence of a c-colouring for that design. Note that if a design on v points has an [formula]-blocking system for integers [formula] then it has an [formula]-blocking system for all integers [formula] such that [formula] and s'i  ≥  si for each [formula]. We will often use this fact tacitly in what follows.

Finally, we will require a result from [\cite=LaWi] on decompositions of edge-coloured graphs. To state the result we need some additional definitions and notation. For full details of the framework we refer the reader to [\cite=LaWi]. We will denote by [formula] the n-dimensional vector all of whose components are 1. Let C be a set of colours, let r = |C|, and let λK(C)v denote the edge-coloured digraph on v vertices in which there are exactly λ edges of each colour in C directed from x to y for any ordered pair (x,y) of distinct vertices. Let H be a family of edge-coloured digraphs whose edges are coloured with colours from C. An H-decomposition of an edge-coloured digraph K is a decomposition D of K such that each edge-coloured digraph G∈D is isomorphic to some graph in H. For a graph H∈H and a vertex x∈V(H), we define τ(H,x) to be the 2r-dimensional vector indexed by C  ×  {1,2}, whose (c,1) component is the number of edges coloured c which are directed to x and whose (c,2) component is the number of edges coloured c which are directed from x. Let α(H) denote the greatest common divisor of the integers m such that [formula] is an integral linear combination of the vectors in {τ(H,x):H∈H,x∈V(H)}. For a graph H∈H, we define μ(H) to be the r-dimensional vector indexed by C whose c component is the number of directed edges in H which are coloured c. Let β(H) denote the greatest common divisor of the integers m such that [formula] is an integral linear combination of the vectors in {μ(H):H∈H}. We say that H is allowable if [formula] can be expressed as a linear combination of the vectors in {μ(H):H∈H} with strictly positive rational coefficients. Note that in [\cite=LaWi] families with this last property were called admissible but we rename it here to avoid confusion with our separate definition of admissibility. Also note that in [\cite=LaWi] this property is defined in a different way, but it is also shown that the above definition is equivalent. The following result is given as Corollary 13.3 of [\cite=LaWi].

The graph λK(C)v admits a H-decomposition for all sufficiently large integers v satisfying

[formula]; and

[formula];

provided that H is allowable.

Our main goal in this section will be to prove Lemmas [\ref=ManyGroupGDD] and [\ref=ManyGroupGDDk=4]. Our proofs use techniques from [\cite=LaWi] and closely follow the proof of Theorem 8.1 of that paper, although we must be careful at times to ensure that the GDD we obtain has the required blocking system. We will require the following well-known result (see [\cite=Sc], for example).

Let r be a positive integer. Given a set of r-dimensional rational vectors U, an r-dimensional rational vector [formula] can be written as an integral combination of the vectors in U if and only if, for every r-dimensional rational vector [formula] such that the dot product [formula] is an integer for each [formula], the dot product [formula] is an integer.

Let k, λ and g be positive integers such that k  ≥  5 and either g = k - 1 or g  ≥  2k - 2. Then for each sufficiently large integer t satisfying

[formula]; and

[formula];

there exists a (k,λ)-GDD of type gt which has a 2-blocking system such that each set of the blocking system intersects each group of the GDD in exactly [formula] points.

Throughout this proof, we will adopt the convention that if [formula] is an n-dimensional vector then, unless otherwise specified, [formula] is indexed by [formula] and component i of [formula] is represented by ui. For rational numbers x and y we shall use the notation [formula] to indicate that x - y is an integer.

Let [formula], let [formula], let [formula]. Let R = G  ×  G be a set of colours. Let F be the set of all g-dimensional integral vectors [formula] such that

fi  ≥  0 for each [formula];

[formula]; and

[formula] and [formula].

For each vector [formula] let [formula] be the edge-coloured digraph with k vertices such that

[formula] has an ordered partition [formula] such that |Vi| = fi for each [formula]; and

for any ordered pair of distinct vertices (x,y) from [formula] there is exactly one directed edge from x to y and it has colour (i,j), where i and j are the unique elements of G such that x∈Vi and y∈Vj.

Let [formula].

It can be seen that an H-decomposition of λK(R)t will yield a (k,λ)-GDD of type gt (see [\cite=LaWi] for details) and furthermore that this (k,λ)-GDD will have a 2-blocking system such that each set of the blocking system intersects each group of the GDD in exactly [formula] points. (The two sets of this blocking system will be formed by those points of the GDD which correspond to a colour in G1 and those points of the GDD which correspond to a colour in G2, and the fact that [formula] and [formula] for each [formula] will guarantee that each block of the GDD intersects each set in the blocking system in at at least one point.) So it suffices to show that for each sufficiently large integer t satisfying (i) and (ii), there is a decomposition of λK(R)t into copies of graphs in H.

Then by Theorem [\ref=LamWilTheorem] it suffices to prove that, for each sufficiently large integer t satisfying (i) and (ii),

[formula] is an integral linear combination of vectors in {μ(H):H∈H};

[formula] is an integral linear combination of vectors in [formula]; and

[formula] can be expressed as a linear combination of the vectors in {μ(H):H∈H} with strictly positive rational coefficients.

This suffices because (a) guarantees that [formula], (b) guarantees that [formula], and (c) guarantees that H is allowable. Let t be a positive integer satisfying (i) and (ii). We will prove (a), (b) and (c) separately.

Proof of (a). For each [formula], the (i,i) component of [formula] is fi(fi - 1) for all [formula] and the (i,j) component of [formula] is fifj for all [formula] such that i  ≠  j. Thus by Lemma [\ref=IntLC] it suffices to prove that for any list of g2 rational numbers [formula] satisfying

[formula]

we have that

[formula]

Let a and b be distinct elements of G. Let c be an element of [formula] such that [formula] and [formula]. Let [formula] be the vector in F such that f'a  =  k - 2, and f'b  =  f'c  =  1. Let [formula] be the vector in F such that f''a = k - 3, f''b = 2 and f''c  =  1. Let [formula] be the vector in F such that f'''a  =  k - 4, f'''b  =  3 and f'''c  =  1. Subtracting twice the congruence implied by ([\ref=MainACong]) when [formula] from the sum of the two congruences implied by ([\ref=MainACong]) when [formula] and [formula] we see that

[formula]

Thus,

[formula]

noting that the congruence is true trivially if i = j.

Let [formula] and let [formula]. If k is odd, let [formula] be the vector in F such that [formula], [formula] and f†b  =  2, and let [formula] be the vector in F such that [formula], [formula] and f‡b  =  2. If k is even, let [formula] be the vector in F such that [formula], [formula] and f†b  =  1, and let [formula] be the vector in F such that [formula], [formula] and f‡b  =  1. Subtracting the congruence implied by ([\ref=MainACong]) when [formula] from the congruence implied by ([\ref=MainACong]) when [formula], doubling the resulting congruence if k is even, and then using ([\ref=CrossToPureACong]) we see that

[formula]

Thus,

[formula]

Let a∈G2 and let [formula] be the vector in F such that f*1  =  k - 2 and f*a  =  2. Using both ([\ref=CrossToPureACong]) and ([\ref=PureACongs]), it is easy to see from the congruence implied by ([\ref=MainACong]) when [formula] that [formula] and thus, since t satisfies (ii), we have

[formula]

So, using ([\ref=CrossToPureACong]), ([\ref=PureACongs]) and ([\ref=OnesACong]), noting that λt(t - 1) is a multiple of 2, that λgt(t - 1) is a multiple of k - 1 if k is odd (by (i)), and that λgt(t - 1) is a multiple of 2(k - 1) if k is even (by (i)), we have

[formula]

as required.

Proof of (b). Let [formula] be a vector in F, let x be a vertex of [formula] and let [formula] be the element of G such that [formula] (where [formula] is the ordered partition of [formula] in the definition of [formula]). Then the [formula] and [formula] components of [formula] are [formula], the [formula] and [formula] components of [formula] are fi for all [formula], and all the other components of [formula] are 0. Thus by Lemma [\ref=IntLC] it suffices to prove that for any list of 2g2 rational numbers [formula] satisfying

[formula]

we have that

[formula]

Let a and b be distinct elements of G. Let c be an element of [formula] such that [formula] and [formula]. Let [formula] be the vector in F such that f'a  =  k - 2, and f'b  =  f'c  =  1. Let [formula] be the vector in F such that f''a = k - 3, f''b = 2 and f''c  =  1. Subtracting the congruence implied by ([\ref=MainBCong]) when [formula] and [formula] from the congruence implied by ([\ref=MainBCong]) when [formula] and [formula] we see that

[formula]

Thus,

[formula]

Using ([\ref=CrossToPureBCong]), it is easy to see from the congruence implied by ([\ref=MainBCong]) when [formula] and [formula] that [formula]. Thus, we have

[formula]

So, using ([\ref=CrossToPureBCong]) and ([\ref=PureBCong]), noting that λg(t - 1) is a multiple of k - 1 (by (i)), we have

[formula]

as required.

Proof of (c). Let [formula]. Clearly [formula] is a positive rational linear combination of the vectors in {μ(H):H∈H} for any positive rational ε. Thus, it suffices to show that, for some small positive rational number ε, [formula] is a non-negative rational combination of the vectors in [formula].

The case g is odd. Let [formula] be the integer such that [formula]. We will say that a vector indexed by G  ×  G is of type (z1,z2,z3,z4,z5), provided that for all (i,j)∈G  ×  G its (i,j) component is uij where

[formula]

It can be seen that [formula] is of type (p1,p2,p3,p4,p5) for some non-negative integers p1,p2,p3,p4,p5.

The case g is odd and g  ≥  2k - 1. Note that [formula] in this case. We define F1, F2, F3, F4 and F5 to be subsets of F, as follows.

[formula]

Through routine but tedious counting it can be calculated that [formula] is of type [formula] if i = 1, [formula] if i = 2, [formula] if i = 3, [formula] if i = 4, and [formula] if i = 5, where

[formula]

To show that [formula] is a non-negative rational linear combination of vectors in {μ(H):H∈H} it suffices to show that (1 - εp1,1 - εp2,1 - εp3,1 - εp4,1 - εp5) is a non-negative rational combination of [formula], [formula], [formula], [formula] and [formula].

Simple calculations give us that

[formula]

[formula]

So it suffices to show that (0,1 - εp2 - y2,1 - εp3 - y3,0,0) is a non-negative rational combination of [formula] and [formula] and hence, since b2, 1 - εp2 - y2 and c2 are all positive for sufficiently small positive values of ε, it suffices to show that

[formula]

Now lim ε  →  01 - εp2 - y2 = 1 - x2 and lim ε  →  01 - εp3 - y3 = 1 - x3, so it suffices to show that

[formula]

Let Δ1 = b2(1 - x3) - b3(1 - x2) and Δ2 = c3(1 - x2) - c2(1 - x3). We will show that Δ1 and Δ2 are both positive. Substituting in for b2, b3, c2, c3, x2 and x3 and simplifying yields that when k is even

[formula]

and when k is odd

[formula]

Given that k  ≥  5 and that [formula], it is now routine to confirm that Δ1 and Δ2 are positive, as required.

The case g is odd and g  =  k - 1. Note that k  ≥  6 and [formula] in this case. We first deal with the case where [formula]. Define F1, F2, F3, F4 and F5 to be subsets of F, as follows.

[formula]

Through routine but tedious counting it can be calculated that [formula] is of type [formula] if i = 1, [formula] if i = 2, [formula] if i = 3, [formula] if i = 4, and [formula] if i = 5, where

[formula]

Again, to show that [formula] is a non-negative rational linear combination of vectors in {μ(H):H∈H} it suffices to show that (1 - εp1,1 - εp2,1 - εp3,1 - εp4,1 - εp5) is a non-negative rational combination of [formula], [formula], [formula], [formula] and [formula].

Simple calculations give us that

[formula]

is equal to (y1,1 - εp2,y3,1 - εp4,1 - εp5) where

[formula]

So it suffices to show that (1 - εp1 - y1,0,1 - εp3 - y3,0,0) is a non-negative rational combination of [formula] and [formula]. For [formula], this can be shown in a similar manner to that used in the case where g  ≥  2k - 1.

The case [formula] can be dealt with similarly, except that we also define

[formula]

note that [formula] is of type [formula] where [formula], and include [formula] in our linear combination rather than [formula].

The case g is even. The arguments in this case are similar to, but less complicated than, those made in the case where g is odd. Let [formula] be the integer such that [formula]. We will say that a vector indexed by G  ×  G is of type (z1,z2,z3), provided that for all (i,j)∈G  ×  G its (i,j) component is uij where

[formula]

It can be seen that [formula] is of type (p1,p2,p3) for some non-negative integers p1,p2,p3.

The case g is even and g  ≥  2k - 2. Note that [formula] in this case. We define F1, F2 and F3 as follows.

[formula]

The proof proceeds along similar lines to the cases where g is odd (though it is less complicated).

The case g is even and g = k - 1. Note that [formula] in this case. We define F1, F2 and F3 as follows.

[formula]

When [formula], the proof proceeds along similar lines to the cases where g is odd (though it is less complicated). When [formula], we proceed similarly except that we also make use of

[formula]

With more work, the restriction that either g = k - 1 or g  ≥  2k - 2 in Lemma [\ref=ManyGroupGDD] could certainly be loosened. The above result suffices for our purposes here, however.

Let λ and g be positive integers such that g  ≥  6 and g is even. Then for each sufficiently large integer t satisfying [formula]; there exists a (4,λ)-GDD of type gt which has a 2-blocking system such that each set of the blocking system intersects each group of the GDD in exactly [formula] points.

The proof proceeds along similar lines to the proof of Lemma [\ref=ManyGroupGDD], so we highlight only the points of difference. Let F be the set of all g-dimensional integral vectors [formula] such that

fi  ≥  0 for each [formula];

[formula]; and

[formula].

Proof of (a). Let a, b, c and d be distinct elements of G such that either a,b,c∈G1 and d∈G2 or d∈G1 and a,b,c∈G2. Let [formula], [formula], [formula], [formula] and [formula] be the vectors in F such that (f'a,f'b,f'd)  =  (2,1,1), (f''a,f''b,f''d)  =  (1,2,1), (f'''b,f'''d)  =  (3,1), (f†b,f†d)  =  (1,3) and (f*a,f*b,f*c,f*d) = (1,1,1,1). The congruence implied by ([\ref=MainACong]) when [formula] yields [formula]. Thus,

[formula]

Subtracting the congruence implied by ([\ref=MainACong]) when [formula] from the the congruence implied by ([\ref=MainACong]) when [formula] we see that [formula]. Thus,

[formula]

Subtracting twice the congruence implied by ([\ref=MainACong]) when [formula] from the sum of the two congruences implied by ([\ref=MainACong]) when [formula] and [formula] we see that [formula]. Thus,

[formula]

Finally, applying ([\ref=IntCrossToPureACong]) to twice the congruence implied by ([\ref=MainACong]) when [formula] yields [formula]. Thus,

[formula]

Combining these facts we see that

[formula]

In the above we apply ([\ref=ExtCrossToPureACong]) when 3 does not divide g and hence 3 divides λ(t - 1) by our hypotheses and we apply ([\ref=Mess]) when 3 divides g and hence 3 divides [formula].

Proof of (b). Let a, b and c be distinct elements of G such that either a,b∈G1 and c∈G2 or c∈G1 and a,b∈G2. Let [formula], [formula] and [formula] be the vectors in F such that (f'a,f'b,f'c)  =  (2,1,1), (f''a,f''b,f''c)  =  (1,2,1) and (f'''b,f'''c)  =  (3,1). Subtracting the congruence implied by ([\ref=MainBCong]) when [formula] and [formula] from the congruence implied by ([\ref=MainBCong]) when [formula] and [formula] we see that [formula]. Thus,

[formula]

The congruence implied by ([\ref=MainBCong]) when [formula] and [formula] yields [formula]. Thus,

[formula]

Using ([\ref=ExtCrossToPureBCong]), it is easy to see from the congruence implied by ([\ref=MainBCong]) when [formula] and [formula] that [formula]. Thus,

[formula]

Combining these facts we see that

[formula]

In the above, applying ([\ref=PureBCongk=4]) requires noting that [formula] is a multiple of 6 which follows from the hypotheses of the lemma.

Proof of (c). Let [formula] be the integer such that [formula]. We define F1, F2 and F3 as follows.

[formula]

Routine calculation yields that

[formula]

Furthermore, [formula], which means that the left hand side of the above equation is a linear combination of the vectors in {μ(H):H∈H} with strictly positive rational coefficients.

Lemma [\ref=ManyGroupGDDk=4] is an analogue of Lemma [\ref=ManyGroupGDD] with the additional restrictions that g is even and [formula]. To see that these conditions are necessary in the case k = 4, suppose there exists a (4,λ)-GDD of type gt which has a 2-blocking system {S1,S2} such that S1 and S2 each intersect each group of the GDD in exactly [formula] points. Every block of this GDD contains at least three pairs of points which intersect S1 in exactly one point, and thus at least half of the pairs of points which appear in blocks of the GDD must intersect S1 in exactly one point. It follows that g is even and that every block in the GDD intersects S1 in one or three points. Thus, for a fixed point x∈S1 there are [formula] pairs of points including x and a point in S1 in a different group to x and each block of the GDD contains zero or two of these pairs. It follows that [formula].

By combining Lemmas [\ref=ManyGroupGDD] and [\ref=ManyGroupGDDk=4] with some standard "group filling" constructions, we can obtain the following two results.

Let y, k and λ be positive integers such that k  ≥  4, either y = k or y  ≥  2k - 1, and if k = 4 then y is odd. If there exists a (y,k,λ)-BIBD which has a [formula]-blocking system, then, for each sufficiently large integer x such that x(y - 1) + 1 is (k,λ)-admissible,

there exists an (x(y - 1) + 1,k,λ)-BIBD which has an [formula]-blocking system; and

there exists a (k,λ)-GDD of type y11(x - 1)(y - 1) which has an [formula]-blocking system such that each set of the blocking system intersects the group of size y in exactly [formula] points.

Since y is (k,λ)-admissible, it is easy to check that, for a sufficiently large integer x such that x(y - 1) + 1 is (k,λ)-admissible, Lemma [\ref=ManyGroupGDD] or Lemma [\ref=ManyGroupGDDk=4] implies that there exists a (k,λ)-GDD (V,G,A) of type (y - 1)x which has a 2-blocking system {S1,S2} such that [formula] for each G∈G (note that if k = 4 then y is odd and so the fact that y is (4,λ)-admissible implies [formula]). Now let ∞   be a point not in V, let G*∈G and for each G∈G let AG be a collection of blocks such that [formula] is a (y,k,λ)-BIBD for which [formula] is a blocking system. Let

[formula]

Then [formula] is the required BIBD, [formula] is the required GDD, and in both cases {S1,S2} is the required blocking system.

Let y, k and λ be positive integers such that k  ≥  4, y  ≥  2k - 2 and if k = 4 then y is even. If there exists a (y,k,λ)-BIBD which has a [formula]-blocking system then, for each sufficiently large integer x such that xy is (k,λ)-admissible,

there exists an (xy,k,λ)-BIBD which has an [formula]-blocking system; and

there exists a (k,λ)-GDD of type y11(x - 1)y which has an [formula]-blocking system such that each set of the blocking system intersects the group of size y in exactly [formula] points.

This is proved very similarly to Lemma [\ref=BasicConstructionsInfinity], except that we take a base GDD of type yx and we do not add the point ∞  .

Examples of 2-chromatic BIBDs

In this section we will use Lemmas [\ref=BasicConstructionsInfinity] and [\ref=BasicConstructionsNoInfinity] to find various examples of 2-chromatic BIBDs. In Lemma [\ref=2Chromatic1ModThing] we establish, for all positive integers k and λ with k  ≥  5, the asymptotic existence of 2-chromatic BIBDs with block size k, index λ and order congruent to 1 modulo k - 1. We then construct, for all positive integers k and λ with k  ≥  4, 2-chromatic BIBDs with block size k and index λ whose orders fall in each admissible congruence class modulo k(k - 1). This is accomplished in Lemma [\ref=2ChromaticInEachCongClass] for k  ≥  5 and in Lemma [\ref=2ChromaticBlockSize4] for k = 4.

Let k and λ be positive integers such that k  ≥  5. For each sufficiently large (k,λ)-admissible integer v such that [formula], there exists a (v,k,λ)-BIBD which has a [formula]-blocking system.

The trivial (k,k,λ)-BIBD obviously has a [formula]-blocking system. Thus, by Lemma [\ref=BasicConstructionsInfinity] (a), it can be seen that, for each sufficiently large integer x such that x(k - 1) + 1 is (k,λ)-admissible, there exists an (x(k - 1) + 1,k,λ)-BIBD with an [formula]-blocking system. Since [formula] for all positive integers x, the proof is complete.

Note that, for any integer k  ≥  5, the above lemma implies that a 2-chromatic (v,k,1)-BIBD exists for each sufficiently large (k,1)-admissible integer v.

Let k and λ be positive integers such that k  ≥  5. For each (k,λ)-admissible integer [formula], there is a positive integer z such that z  ≥  2k - 1, [formula], and there exists a (z,k,λ)-BIBD which has a [formula]-blocking system.

Let m be a (k,λ)-admissible element of [formula]. By Lemma [\ref=2Chromatic1ModThing] there exists an integer [formula] such that y'  ≥  2k - 1 and there is a (y',k,λ)-BIBD which has a [formula]-blocking system (note that y' is odd since k(k - 1) is even). Thus, since any positive integer congruent to m modulo k(k - 1) is itself (k,λ)-admissible, by Lemma [\ref=BasicConstructionsNoInfinity] (a) it can be seen that there is a positive integer x such that [formula] and there exists an (xy',k,λ)-BIBD which has an [formula]-blocking system. Since xy'  ≥  2k - 1, [formula] and [formula], the proof is complete.

Let z and λ be positive integers such that [formula] and z is (4,λ)-admissible. Then there exists a (z,4,λ)-BIBD with a [formula]-blocking system.

Let λmin be the smallest positive integer such that z is (4,λmin)-admissible, and note that [formula]. It suffices to find a (z,4,λmin)-BIBD with a [formula]-blocking system (since we can take [formula] copies of every block in this design).

For each [formula], a (z,4,λmin)-BIBD with a [formula]-blocking system is given explicitly in [\cite=HoLiPh1] or [\cite=HoLiPh2]. If z is even this gives us the required result immediately, and in each of the cases z∈{7,9,11,13,15,17} it is routine to check that the given design in fact admits a [formula]-blocking system as required.

Examples of c-chromatic BIBDs

In this section we will construct, for all positive integers c, k and λ with c  ≥  2, k  ≥  4 and (c,k)  ≠  (2,4), c-chromatic BIBDs with block size k and index λ whose orders satisfy various congruence conditions (see Lemma [\ref=CChromaticExample]). The reason for these particular congruence conditions will become apparent when we employ these examples in Section 5 to establish the asymptotic existence of c-chromatic BIBDs for each c  ≥  2. Our approach in this section is inspired by a technique used in [\cite=DePhRo], and also bears similarities to methods used in [\cite=HoPi]. Before proving Lemma [\ref=CChromaticExample], we require three preliminary lemmas.

Let c and k be integers such that k  ≥  3 and c  ≥  2. Then there exists a c-chromatic partial BIBD with block size k and index 1.

It was shown in [\cite=ErHa] (and later proved constructively in [\cite=Lo]) that for any integers k'  ≥  3 and c'  ≥  1 there is a partial BIBD with block size k' and index 1 which has chromatic number at least c'. Let (U,A) be a partial BIBD with block size k and index 1 which has chromatic number at least c.

Let [formula]. We will show that there is an [formula] such that the partial BIBD [formula] is c-chromatic. We claim that, for each [formula], if [formula] has chromatic number c† then [formula] has chromatic number c† or c† + 1. To see this, observe that we can obtain a (c† + 1)-colouring of [formula] by taking a (c†)-colouring of [formula] and recolouring an arbitrary vertex of Ai + 1 with a colour which is not used in the original colouring. Thus, since (U,{A1}) has chromatic number 2 and [formula] has chromatic number at least c, it follows that there is indeed an [formula] such that [formula] is c-chromatic.

Let k be an integer such that k  ≥  5 and let p be a prime such that p  ≥  k and if k = 5 then [formula]. Then there exists a transversal design with group size p and block size k, (V,G,B), such that

(V,B) has a 2-blocking system such that each set of the blocking system intersects each group in G in exactly [formula] points; and

there is a block B*∈B such that [formula] has a 2-blocking system such that each set of the blocking system is disjoint from B* and intersects each group in G in exactly [formula] points.

Let [formula] and let [formula]. Let [formula]. For all i∈I and [formula] let

[formula]

where the second coordinates are considered modulo p (here, we could equally say for all [formula], but it will help later to consider i as an element of I). Let [formula]. We claim that (V,G,B) is a transversal design.

It is easy to see that B contains exactly p2 blocks of size k. Also, if a pair of points in different groups appears in the blocks Bi,j and Bi',j' for some i,i'∈I and [formula] then it is clear that [formula] for some [formula]. So, since k  ≤  p, it follows that i = i' and hence j = j'. Thus, (V,G,B) is indeed a transversal design. We will complete the proof by finding a 2-blocking system for (V,B) such that each set of the blocking system intersects each group in G in exactly [formula] points, and a 2-blocking system for [formula] such that each set of the blocking system is disjoint from B0,0 and intersects each group in G in exactly [formula] points.

Let

[formula]

We claim that {S1,S2} is a 2-blocking system for (V,B). Suppose for a contradiction that there exist a∈I and [formula] such that [formula]. Then

[formula];

[formula];

[formula]; and

[formula].

From (1) and (2) it can be seen that [formula], unless [formula], b = 0 and k = 5 in which case (3) is violated. Thus, if k  ≥  6 then [formula] since p  ≥  k, and, if k = 5 then [formula] since [formula] in this case. So in all cases [formula] and it follows from (1), (2) and (3) that [formula], a contradiction to (4). It can be similarly shown that no block in B is disjoint from S1.

Let

[formula]

We claim that {T1,T2} is a 2-blocking system for [formula]. Suppose for a contradiction that there exist a∈I and [formula] such that (a,b)  ≠  (0,0) and [formula]. Then

[formula];

[formula]; and

[formula].

From (1) it can be seen that [formula]. Thus, since k  ≥  5, [formula]. So [formula] and it follows from (1) and (2) that [formula], a contradiction to (3). It can be similarly shown that no block in [formula] is disjoint from T1.

There exists a transversal design with group size 13 and block size 4, (V,G,B), such that

(V,B) has a 3-blocking system, each set of which intersects each group in G in exactly 4 points; and

there exists a block B*∈B such that [formula] has a 3-blocking system each set of which is disjoint from B* and intersects each group in G in exactly 4 points.

Also, for each positive integer λ, there exists a (13,4,λ)-BIBD with a (4,4,4)-blocking system.

Let [formula] and [formula]. For all [formula] let

[formula]

and let [formula]. Then (V,G,B) is a transversal design with group size 13 and block size 4. Let

[formula]

Then {S1,S2,S3} is a blocking system for (V,B), each set of which intersects each group in G in exactly 4 points. Let

[formula]

Then {T1,T2,T3} is a blocking system for [formula] each set of which is disjoint from B1,1 and intersects each group in G in exactly 4 points.

We saw in the proof of Lemma [\ref=2ChromaticBlockSize4] that there exists a (13,4,1)-BIBD, and it is easy to show that any such design must have a (4,4,4)-blocking system. By taking λ copies of each block in this design, we can obtain the required (13,4,λ)-BIBD.

The blocking systems {S1,S2,S3} and {T1,T2,T3} in the above proof were found by computer search.

Let c, k, λ and m be positive integers such that c  ≥  2, k  ≥  4 and [formula]. Further suppose that if k = 4, then c  ≥  3 and [formula]. For each (k,λ)-admissible integer [formula] there is an integer w such that w  >  m, [formula] and there exists a c-chromatic (w,k,λ)-BIBD with an [formula]-blocking system for some integers [formula] satisfying [formula] for each [formula].

Let [formula] be a (k,λ)-admissible element of [formula]. We will first deal with the case k  ≥  5. The special case k = 4 will be dealt with later.

By Dirichlet's Theorem there are infinitely many primes congruent to 1 modulo k(k - 1). Thus, by Lemma [\ref=2Chromatic1ModThing], we can choose p to be an odd prime such that [formula], gcd (p,m) = 1 and there exists a (p,k,λ)-BIBD with a [formula]-blocking system (note that any integer congruent to 1 modulo k(k - 1) is (k,λ)-admissible).

By Lemma [\ref=CChromaticPartialBIBD] there is a c-chromatic partial BIBD with block size k and index 1. Clearly, by adding points and blocks to this design in such a way that each new block is disjoint from each other block of the design, we can produce, for some positive integer u, a c-chromatic partial (u,k,1)-BIBD (U,A1) such that gcd (|A1|,m) = 1 and there is a point in U which is in exactly one block in A1. Let b = |A1| and let [formula] be a blocking system for (U,A1).

Let G be the graph on vertex set U in which two vertices are adjacent if and only if the corresponding pair of points is contained in a block in A1. We claim that Theorem [\ref=LamWilTheorem] implies there is a decomposition of the λ-fold complete graph of order v into copies of G for all sufficiently large integers v such that [formula] and [formula]. To see this we take C in Theorem [\ref=LamWilTheorem] as a set containing a single colour, let H be G considered as a symmetric digraph of this colour, and observe that we have μ(H) = 2|E(G)| = bk(k - 1) and, for each x∈U, τ(H,x) = ( degG(x), degG(x)). So β({H}) = bk(k - 1) and α({H})  =   gcd ({ degG(x):x∈V(G)}) = k - 1 (note that, for each x∈U,  degG(x) = rx(k - 1) where rx is the number of blocks in A1 which contain x, and that we have seen that ry = 1 for some y∈U). Thus our claim does indeed follow from Theorem [\ref=LamWilTheorem].

Since gcd (p,m) = 1 and gcd (b,m) = 1, by the Chinese Remainder Theorem there are infinitely many positive integers which are congruent to 1 modulo b and whose product with p is congruent to [formula] modulo m. Thus, there is an integer y such that y  ≥  2u, py  >  m, [formula], [formula] and there is a decomposition of the λ-fold complete graph of order y into copies of G (note that since [formula] is (k,λ)-admissible, since [formula], since [formula], and since gcd (b,m) = 1, the congruences imply that [formula] and [formula]). Clearly then, there is an embedding of (U,A1) in a (y,k,λ)-BIBD [formula].

Let Z be a set such that |Z| = p. Let z*∈Z and let {Z1,Z2} be a partition of [formula] such that [formula]. Let V = Y  ×  Z be a point set. Let [formula], [formula], and Si = Ri  ×  {z*} for each [formula]. Note that [formula] are pairwise disjoint and that, since y  ≥  2u, [formula] for each [formula]. We will construct a collection of blocks C such that (V,C) is a (py,k,λ)-BIBD for which [formula] is a blocking system, and such that C contains an isomorphic copy of A1. This will complete the proof since py > m, since [formula] and since the fact that C contains an isomorphic copy of A1 implies that (V,C) has chromatic number at least c.

For each A∈A1, let BA be a collection of blocks such that (A  ×  Z,{{x}  ×  Z:x∈A},BA) is a transversal design with group size p and block size k such that A  ×  {z*}∈BA and {A  ×  Z1,A  ×  Z2} is a blocking system for [formula] (such a collection exists by Lemma [\ref=TwoTDs], noting that if k = 5 then [formula] since [formula]). For each A∈A2, let B†A be a collection of blocks such that (A  ×  Z,{{x}  ×  Z:x∈A},B†A) is a transversal design with group size p and block size k for which {A  ×  Z1,A  ×  Z2} is a blocking system (such a collection exists by Lemma [\ref=TwoTDs], noting that if k = 5 then [formula] since [formula]). For each x∈Y, let Bx be a collection of blocks such that ({x}  ×  Z,Bx) is a (p,k,λ)-BIBD for which {{x}  ×  Z1,{x}  ×  Z2} is a blocking system (such a collection exists by the definition of p).

Let

[formula]

We claim that (V,C) is a (py,k,λ)-BIBD for which [formula] is a blocking system and that C contains an isomorphic copy of (U,A1) (on the point set U  ×  {z*}), which will suffice to complete the proof in the case k = 5. Here, we will verify this claim in some detail, but later in the paper we will leave similar verifications to the reader.

Routine case analysis shows that each pair of points in V is in exactly λ blocks in C and hence that (V,C) is a (py,k,λ)-BIBD. For each A∈A1, we have that A  ×  {z*}∈BA, and it follows that C contains an isomorphic copy of (U,A1) on the point set U  ×  {z*}. Furthermore, because [formula] is a blocking system for (U,A1), each block in this copy of (U,A1) intersects at least two sets in [formula] and hence at least two sets in [formula] (note Ri  ×  {z*}  ⊆  Si for each [formula]). Finally, because of the blocking systems possessed by the designs in [formula], {(A  ×  Z,{{x}  ×  Z:x∈A},B†A):A∈A2}, and {({x}  ×  Z,Bx):x∈Y}, every block in C which is not in the copy of (U,A1) intersects both Y  ×  Z1 and Y  ×  Z2 and hence both S1 and S2 (note that Y  ×  Z1  ⊆  S1 and Y  ×  Z2  ⊆  S2). So (V,C) is indeed a (py,k,λ)-BIBD for which [formula] is a blocking system and C does contain an isomorphic copy of (U,A1), as required.

In the case k = 4 note that c  ≥  3 and choose p = 13. Note that [formula], that gcd (p,m) = 1 since [formula], and that there is a (p,k,λ)-BIBD with a (4,4,4)-blocking system by Lemma [\ref=TwoTDsBlockSize4]. Also by Lemma [\ref=TwoTDsBlockSize4], there exists a transversal design with group size 13 and block size 4, (V,G,B), such that

(V,B) has a 3-blocking system, each set of which intersects each group in G in exactly 4 points; and

there exists a block B*∈B such that [formula] has a 3-blocking system each set of which is disjoint from B* and intersects each group in G in exactly 4 points.

By using a similar argument to that used in the case k  ≥  5 we can obtain the required block design.

Asymptotic existence of c-chromatic BIBDs

We are now almost ready to prove Theorem [\ref=MainTheorem] in the case k  ≥  4. The final preliminary result we require uses Wilson's fundamental construction to obtain GDDs with a large number of groups of large size which possess 2-blocking systems with certain properties.

Let k and λ be positive integers such that k  ≥  4. Then there exist positive integers t and a0 such that if a, a† and a‡ are integers such that a  ≥  a0, a†  ≤  a, a‡  ≤  a and [formula], then there exists a (k,λ)-GDD of type at(a†)1(a‡)1 which has a 2-blocking system such that each set of the blocking system intersects each group G of the GDD in exactly [formula] points.

By Lemma [\ref=ManyGroupGDD] or Lemma [\ref=ManyGroupGDDk=4], it is easy to see that there is a positive integer t such that for each s∈{t,t + 1,t + 2} there exists a (k,λ)-GDD of type (k(k - 1))s with a 2-blocking system such that each set of the blocking system intersects each group of the design in exactly [formula] points. The main result of [\cite=ChErSt] implies that, for a given positive integer k', there exists a transversal design with group size g' and block size k' for all sufficiently large integers g'. Thus, there is an integer g0 such that for any integer g  ≥  g0 there exists a transversal design with group size g and block size t + 2. Let a, a† and a‡ be integers such that a  ≥  g0k(k - 1), a†  ≤  a, a‡  ≤  a and [formula]. Then there exists a transversal design with group size [formula] and block size t + 2. By deleting some points from this transversal design we can obtain a ({t,t + 1,t + 2},1)-GDD (V,F,A) of type [formula].

Let Z be a set with |Z| = k(k - 1) and let {Z1,Z2} be a partition of Z with [formula]. Let G  =  {F  ×  Z:F∈F}. For each block A∈A, let BA be a collection of blocks such that (A  ×  Z,{{x}  ×  Z:x∈A},BA) is a (k,λ)-GDD of type (k(k - 1))|A| for which {A  ×  Z1,A  ×  Z2} is a blocking system (such a collection exists since |A|∈{t,t + 1,t + 2} and [formula]). Let

[formula]

It is routine to check that (V  ×  Z,G,B) is a (k,λ)-GDD of type at(a†)1(a‡)1 for which {V  ×  Z1,V  ×  Z2} is a blocking system. Since [formula] for each G∈G, the proof is complete.

It is known that for any positive integer λ, a 2-chromatic (v,4,λ)-BIBD exists for each (4,λ)-admissible integer v (see [\cite=FrGrLiRo] [\cite=HoLiPh1] [\cite=HoLiPh2] [\cite=RoCo]), so we may assume that if k = 4 then c  ≥  3. Since there are only finitely many congruence classes modulo k(k - 1) it suffices to show that, for each (k,λ)-admissible integer [formula], there is a c-chromatic (v,k,λ)-BIBD for each sufficiently large integer v such that [formula].

Let [formula] be a (k,λ)-admissible integer. We will first deal with the case where k  ≥  5 or where k = 4 and [formula] is odd. The special case where k = 4 and [formula] is even will be dealt with later. By Lemma [\ref=2ChromaticInEachCongClass] or Lemma [\ref=2ChromaticBlockSize4] there is a positive integer u such that [formula], if k  ≥  5 then u  ≥  2k - 1, if k = 4 then u∈{7,9,11,13,15,17}, and there exists a (u,k,λ)-BIBD with a [formula]-blocking system. Let m = lcm(k(k - 1),u - 1). Now, since there are only finitely many congruence classes modulo m it suffices to show that, for each (k,λ)-admissible integer [formula] for which [formula], there is a c-chromatic (v,k,λ)-BIBD for each sufficiently large integer v such that [formula].

Let [formula] be a (k,λ)-admissible integer for which [formula]. Note the following facts.

By Lemma [\ref=TwoDifferentGDD] there are positive integers t and a0 such that for any integers x, x† and x‡ such that x  ≥  a0, x†  ≤  x, x‡  ≤  x and [formula] there exists a (k,λ)-GDD of type xt(x†)1(x‡)1 which has a 2-blocking system such that each set of the blocking system intersects each group G of the GDD in exactly [formula] points.

Since there exists a (u,k,λ)-BIBD with a [formula]-blocking system, by Lemma [\ref=BasicConstructionsInfinity] (b) there is a positive integer n0 such that, for each integer n  ≥  n0 with [formula], there exists a (k,λ)-GDD of type u11n which has an [formula]-blocking system such that each set of the blocking system intersects the group of size u in exactly [formula] points (note that n + u is (k,λ)-admissible since [formula], that [formula], and that [formula]).

By Lemma [\ref=CChromaticExample] there is an integer w  >  m such that [formula] and there exists a c-chromatic (w,k,λ)-BIBD with an [formula]-blocking system for some integers [formula] satisfying [formula] for each [formula] (if k = 4 then u∈{7,9,11,13,15,17} which implies that [formula]).

Let N be the smallest integer such that [formula] and N  ≥   max {a0,n0 + m(t - 1),w - u}. Let v  ≥  Nt + n0 + m(t - 1) + w be an integer such that [formula]. We will construct a c-chromatic (v,k,λ)-BIBD to complete the proof.

It can be seen that there are unique integers a and a† such that [formula], v - w = at + a† and n0  ≤  a†  ≤  n0 + m(t - 1) (note that [formula]). Now since v  ≥  Nt + n0 + m(t - 1) + w, we have that at + a†  ≥  Nt + n0 + m(t - 1) and thus, since a†  ≤  n0 + m(t - 1), we have that a  ≥  N. Note that N  ≥  a0, that N  ≥  n0 + m(t - 1)  ≥  a†, that N  ≥  w - u and, since [formula], that [formula]. Thus, by (i) there exists a (k,λ)-GDD [formula] of type at(a†)1(w - u)1, where |F| = a for all F∈F, |F†| = a† and |F‡|  =  w - u, which has a 2-blocking system {R1,R2} such that [formula] for each group [formula].

Let U be a set disjoint from V such that |U| = u and let U1 and U2 be disjoint subsets of U with [formula]. We will now construct a c-chromatic (v,k,λ)-BIBD on the point set [formula].

For each group F∈F, let BF be a collection of blocks such that [formula] is a (k,λ)-GDD of type u11a for which [formula] is a blocking system. Such collections exist by (ii) since a  ≥  n0, [formula], [formula] for all F∈F, and [formula].

Let B† be a collection of blocks such that [formula] is a (k,λ)-GDD of type u11a† for which [formula] is a blocking system. Such a collection exists by (ii) since a†  ≥  n0, [formula], [formula], and [formula].

Let B‡ be a collection of blocks such that [formula] is a c-chromatic (w,k,λ)-BIBD which has a blocking system [formula] such that [formula], [formula], and [formula] is a partition of [formula]. Such a collection exists by (iii) since [formula].

Let [formula], [formula], and Si = R‡i for each [formula]. Note that [formula] is a partition of [formula]. Let

[formula]

It is routine to check that [formula] is a c-chromatic (v,k,λ)-BIBD for which [formula] is a blocking system (note that no block in [formula] has more than one point in [formula] and hence no such block can be a subset of any set in [formula]).

We now consider the special case where k = 4 and [formula] is even. We proceed exactly as we did in the main case, with four exceptions. Firstly we note that by Lemma [\ref=2ChromaticBlockSize4] there is an integer u such that [formula], u∈{6,8,10,12,14,16}, and there exists a (u,k,λ)-BIBD with a [formula]-blocking system. Secondly, we define m = lcm(12,u). Thirdly, instead of (ii) we instead observe the following.

Since there exists a (u,k,λ)-BIBD with a [formula]-blocking system, by Lemma [\ref=BasicConstructionsNoInfinity] (b) there is a positive integer n0 such that, for all integers n for which n  ≥  n0 and [formula], there exists a (k,λ)-GDD of type u11n which has a [formula]-blocking system such that each set of the blocking system intersects the group of size u in exactly [formula] points (note that n + u is (k,λ)-admissible since [formula]).

Lastly, in our justification of (iii) we must note that [formula] since u∈{6,8,10,12,14,16}.

Except as noted, the arguments given in the main case hold without any alteration.

The case of block size 3

It only remains for us to prove Theorem [\ref=MainTheorem] in the case k = 3. When λ = 1 this has already been achieved by de Brandes, Phelps and Rödl [\cite=DePhRo]. In this final section we generalise their result to cover all values of λ. The methods we employ are similar, but not identical, to theirs.

There exist two transversal designs (V,G,B†) and (V,G,B) with group size 3 and block size 3 having the same point set and the same group set such that

there are two distinct points x,y∈V such that every block which is in B but not in B† contains either x or y; and

there is a partition {S1,S2,S3} of V such that

[formula] for all i∈{1,2,3} and G∈G;

{S1,S2,S3} is a blocking set for (V,B†); and

S1∈B.

Let [formula] and let [formula]. Let ρ be the permutation (0 1) of [formula]. Let [formula] and let [formula], where the addition is considered modulo 3. It is easy to check that B† and B satisfy the required conditions (take {x,y}  =  {(2,0),(2,1)} and [formula] for each i∈{1,2,3}).

Let w and λ be positive integers such that w  ≥  5 and w is (3,λ)-admissible. Then there exists a (w,3,λ)-BIBD with a 3-blocking system such that the sets of the system partition the point set of the BIBD and the sizes of any two sets of the system differ by at most 1.

In Theorem 18.4 of [\cite=CoRo], it is proved that, for each positive integer λ and each (3,λ)-admissible integer w, there exists a 3-colourable (w,3,λ)-BIBD. In the proof, for each positive integer λ and each (3,λ)-admissible integer w such that w  ≥  5 and w∉{6,8}, a (w,3,λ)-BIBD is explicitly constructed, on a point set explicitly given as V  ×  {0,1,2}, [formula] or [formula] for some set V, in such a way that each block of the BIBD contains two points with different second coordinates. Thus, the partition of the point set suggested by the second coordinates gives a suitable blocking system. For each positive integer λ such that 6 is (3,λ)-admissible, any partition of the point set of a (6,3,λ)-BIBD into parts of size 2 will form a suitable blocking system for the BIBD. Finally, for each positive integer λ such that 8 is (3,λ)-admissible, the proof exhibits an (8,3,λ)-BIBD whose point set contains two disjoint subsets of size 3 which are not blocks of the BIBD. Clearly, these two sets along with a third containing the remaining points form a suitable blocking system for this BIBD.

Let h∈{0,1,2,3,4,5} and let λ be a positive integer such that λ is even if h is even. Then there exists a (3,λ)-GDD (V,G,B) of type h116 with a 3-blocking system such that the sets of the system partition the point set of the GDD, each set of the system contains at least two points which are in groups of size 1, and the sizes of any two sets of the system differ by at most 1.

The result follows directly from Lemma [\ref=BIBDBlockSize3] if h∈{0,1}, so assume that h∈{2,3,4,5}. Let λmin = 1 if h is odd and λmin = 2 if h is even. It suffices to find a (3,λmin)-GDD of type h116 with a 3-blocking system such that the sets of the system partition the point set of the GDD, each set of the system contains at least two points which are in groups of size 1, and the sizes of any two sets of the system differ by at most 1 (since we can take [formula] copies of every block in this design). Below, we give the blocks of such designs along with the sets of the required blocking systems. In the interests of space we give the blocks in columns. In each case the point set of the design is taken to be [formula] where [formula] is the group of size h. The existence of such designs (not considering blocking systems) was first established in [\cite=St].

The leave of a partial BIBD (V,B) with index 1 is the graph with vertex set V in which a pair of vertices is adjacent if and only if the pair is not contained in any block in B. The next lemma is very similar to a result in [\cite=FuLiRo1] and is used only in the proof of Lemma [\ref=AtLeastCChromaticMPT].

Let v and m be positive integers such that [formula], [formula], and 24  ≤  m  <  v. There exists a partial (v,3,1)-BIBD whose leave has a decomposition into m perfect matchings on v vertices, and the vertex-disjoint union of a complete graph of order 4 and a perfect matching on v - 4 vertices.

The statement of Lemma 6.5 of [\cite=FuLiRo1] gives a decomposition of a complete graph of order v into triangles, m perfect matchings on v vertices, and the vertex-disjoint union of a copy of K1,3 and a perfect matching on v - 4 vertices. Furthermore, in each case the construction given in the proof contains a triangle whose vertices are the vertices of degree 1 in the copy of K1,3 (this arises through the use of Lemma 6.3 of [\cite=FuLiRo1], and the copy of K1,3 and the triangle are given explicitly in the proof of that result). Taking this decomposition and removing the perfect matchings, the copy of K1,3 and the special triangle gives the required BIBD.

Let c be a positive integer such that c  ≥  3. For all sufficiently large even integers v there exists a partial (v,3,1)-BIBD which has chromatic number at least c and whose leave is

a perfect matching on v vertices if [formula]; and

the vertex-disjoint union of a complete graph of order 4 and a perfect matching on v - 4 vertices if [formula].

It follows from Lemma [\ref=CChromaticPartialBIBD] that for some positive integer u there is a partial (u,3,1)-BIBD (U,A) which has chromatic number c. We can assume that u  ≥  12 by adding points to this BIBD, if necessary. By the main result of [\cite=BrHo], we can embed (U,A) in a (u',3,1)-BIBD (U',A') for some positive integer u' such that 2u + 1  ≤  u'  ≤  2u + 5 and [formula].

Let v be an even integer such that v  ≥  2u' + 2. If [formula], the main result of [\cite=FuLiRo2] then guarantees that this design can in turn be embedded in a partial (v,3,1)-BIBD whose leave is a perfect matching on v, so we may assume that [formula]. Let [formula] and let W be a set of size v - u' which is disjoint from U'. By Lemma [\ref=NotTripoleDecomp] there is a partial (v - u' + 1,3,1)-BIBD [formula] whose leave has a decomposition into u' - 1 perfect matchings [formula] on v - u' + 1 vertices, and the vertex-disjoint union of a complete graph of order 4 and a perfect matching on v - u' - 3 vertices. Then [formula], where

[formula]

can be seen to be a (v,3,1)-BIBD which has chromatic number at least c and whose leave is the vertex-disjoint union of a complete graph of order 4 and a perfect matching on v - 4 vertices.

Let N be the smallest even integer such that for each even integer u'  ≥  N there exists a partial (u',3,1)-BIBD which has chromatic number at least c and whose leave satisfies the conditions of Lemma [\ref=AtLeastCChromaticMPT].

Let v be a (3,λ)-admissible integer such that v  ≥  3N. We will show that there exists a c-chromatic (v,3,λ)-BIBD. Let u and h be the integers such that v = 3u + h, u is even, and 0  ≤  h  ≤  5. Then u  ≥  N and there is a partial (u,3,1)-BIBD (U,A) which has chromatic number at least c and whose leave satisfies the conditions of Lemma [\ref=AtLeastCChromaticMPT]. Let [formula]. If [formula], then let P* be a pair of points in U which are adjacent in the leave of (U,A). If [formula], then let P* be the set of the four points in U which are mutually adjacent in the leave of (U,A). In either case, let P be a partition of [formula] into pairs of points such that each pair is adjacent in the leave of (U,A).

Let Z = {z1,z2,z3} be a set and let H be a set such that |H| = h. Let {H1,H2,H3} be a partition of H such that any two of |H1|, |H2| and |H3| differ by at most 1. Let [formula] be a point set. Let [formula] for each i∈{1,2,3}. We will construct collections of blocks [formula] such that

(V,Ci) is a (v,3,λ)-BIBD for each [formula];

{S1,S2,S3} is a blocking system for (V,C0);

(V,Ct) contains an isomorphic copy of (U,A);

the chromatic number of (V,Ci + 1) is at most one more than the chromatic number of (V,Ci) for each [formula].

From (ii) it will follow that (V,C0) has chromatic number at most 3, and from (iii) it will follow that (V,Ct) has chromatic number at least c. Thus, from (iv) it will follow that (V,Cj) has chromatic number c for some [formula]. So it suffices to find such collections of blocks.

For each A∈A, let B†A and BA be collections of blocks such that (A  ×  Z,{{x}  ×  Z:x∈A},B†A) and (A  ×  Z,{{x}  ×  Z:x∈A},BA) are (3,λ)-GDDs of type 33 such that

(A  ×  {z1},A  ×  {z2},A  ×  {z3}) is a blocking system for (A  ×  Z,B†A);

A  ×  {z1}∈BA; and

there are two distinct points x,y∈A  ×  Z such that every block which is in BA but not in B†A contains either x or y;

(such collections exists by Lemma [\ref=TwoTDsBlockSize3], taking λ copies of every block of the transversal designs). For each P∈P, let BP be a collection of blocks such that [formula] is a (3,λ)-GDD of type h116 for which [formula] is a blocking system (such a collection exists by Lemma [\ref=HoleyBIBDBlockSize3]). Let BP* be a collection of blocks such that [formula] is a (3|P*| + h,3,λ)-BIBD for which [formula] is a blocking system (such a collection exists by Lemma [\ref=BIBDBlockSize3] since v is (3,λ)-admissible and [formula]).

For each [formula], let

[formula]

It only remains to show that (i), (ii), (iii) and (iv) hold.

It is routine to check that (i), (ii) and (iii) hold (for (iii), the isomorphic copy of (U,A) is on the point set U  ×  {z1}). To see that (iv) holds, let [formula] and let ci be the chromatic number of (V,Ci). There are two points x and y of V such that every block which is in BAi + 1 but not in B†Ai + 1 contains either x or y. This implies that every block which is in Ci + 1 but not in Ci contains either x or y. Thus, we can obtain a (ci + 1)-colouring of (V,Ci + 1) by taking a ci-colouring of (V,Ci) and recolouring the vertices x and y with a colour which is not used in the original colouring.

Acknowledgements

The first author was supported by an AARMS postdoctoral fellowship and by Australian Research Council grants DE120100040 and DP120103067. The second author was supported by research grants from NSERC, CFI and IRIF. The authors would like to thank the referees, whose comments substantially improved this paper.