Affine LPV systems: realization theory, input-output equations and relationship with linear switched systems

Introduction

The paper presents a Kalman-style realization theory for discrete-time affine LPV systems. An affine LPV system (abbreviated by ALPV) is linear parameter-varying systems whose matrices are affine functions of the scheduling parameters. By the input-output behavior of an ALPV  we will mean the input-output map induced by the zero initial state. The paper aims at answering the following questions.

How can we characterize those input-output maps which can be described ALPVs  ? What is the role of Hankel-matrices in this characterization ?

What can be said about minimal ALPVs  realizing the given input-output map ? What is the relationship between minimal ALPVs, and reachability and observability of such systems ? Are all minimal ALPV  realizations of the same input-output map isomorphic ?

How can we characterize the input-output equations solutions of which correspond to input-output maps of ALPVs  ?

In this paper we will show the following.

We prove that reachability and observability of ALPVs  is equivalent to minimality and that minimal realizations of the same input-output map are isomorphic. Note that isomorphism in this setting means a linear state-space transformation which does not depend on the scheduling parameter.

We also show that any ALPV  can be transformed into a minimal one while preserving its input-output map.

In addition, we characterize reachability and observability in terms of rank conditions for extended reachability and observability matrices.

We define the Markov-parameters as functions of the input-output map. We then show that the Hankel-matrix constructed from the Markov-parameters has a finite rank if and only if the corresponding input-output map has a realization by an ALPV. We show that the Kalman-Ho algorithm of [\cite=RolandAbbas] can be used to compute an ALPV  realization from the Hankel-matrix, and we provide a bound on the size of the Hankel sub-matrices which guarantees correctness of the algorithm.

We also present a class of input-output equations which characterize ALPVs  precisely: an input-output map is a solution of such an input-output equation if and only if it admits a realization by an ALPV .

Finally, as a secondary result, we establish a formal equivalence between the realization problems for ALPVs  and for linear switched systems. The solution of the latter problem is known [\cite=MPLBJH:Real] [\cite=MP:BigArticlePartI] [\cite=MP:RealForm] and it is equivalent to that of recognizable formal power series and state-affine systems [\cite=Reut:Book] [\cite=Son:Real] [\cite=MFliessHank]. We then use realization theory of linear switched systems to derive a Kalman-style realization theory for ALPVs.

Note that in this paper we consider ALPVs  with a fixed initial state. Just as in the linear switched case [\cite=MP:RealForm] [\cite=MP:BigArticlePartI] it is possible to extend these results to the case of an arbitrary set of initial states.

Motivation and novelty To the best of our knowledge, the paper is new. Many of the concepts (Hankel-matrix, Markov-parameters, extended reachability/observability matrix, etc.) used in the paper have already appeared before. However, what is truly novel in this paper is that it formulates a Kalman-style realization theory for ALPVs, while using the existing concepts from the literature. In addition, the equivalence between ALPV  realizations and input-output equations is also new, to the best of our knowledge.

A Kalman-like realization theory offers several benefits for system identification. It allows the characterization of identifiability and equivalence of state-space representations. The latter is important for model validation. Kalman-like realization theory also provides a tool for finding identifiable canonical parameterizations and characterizing the manifold structure of systems, including hybrid and nonlinear systems, [\cite=MP:MTNSSpaces] [\cite=MR0429197] [\cite=GW74] [\cite=RalfPeeters] [\cite=HanzonBook] [\cite=Hazewinkel1] [\cite=MercereBako]. In turn, this knowledge could be used for deriving new parametric identification algorithms, see [\cite=RalfPeeters] [\cite=HanzonBook] for the linear case. Realization theory also leads to model reduction techniques, such as balanced truncation and moment matching [\cite=ModRed1]. This is also true for linear switched systems [\cite=MP:ADHS2012] [\cite=MP:PartReal] and ALPVs  [\cite=RolandAbbas].

Finally, the paper formulates the precise relationship between the realization problems for ALPVs  and linear switched systems. While this relationship is part of the folklore, it has not been stated formally yet.

Relationship with existing work The field of identification of LPV systems is a mature one with a vast literature and several applications, without claiming completeness, we mention [\cite=VerdultPhd] [\cite=Verhaegen:Automatica] [\cite=Verhaegen09] [\cite=Verhaegen:INJC] [\cite=Lal11] [\cite=TothTac1] [\cite=Toth1] [\cite=THH09] [\cite=Kal09] [\cite=CCS11] [\cite=CL08] [\cite=BDG05] [\cite=BG02] [\cite=FWV07]. As it was mentioned before, many of the concepts used in this paper were published before. In particular, the idea of Hankel-matrix appeared in [\cite=RolandAbbas] [\cite=VerdultPhd] [\cite=Verhaegen:Automatica] [\cite=Verhaegen09] [\cite=Verhaegen:INJC]. However, [\cite=RolandAbbas] [\cite=VerdultPhd] [\cite=Verhaegen:Automatica] [\cite=Verhaegen09] [\cite=Verhaegen:INJC] focuses on the identification problem, which is related to, but different from the realization problem studied in this paper. The Markov-parameters were already described in [\cite=RolandAbbas] [\cite=Verhaegen09]. In contrast to the existing work, in this paper the Markov-parameters and Hankel-matrix are defined directly for input-output maps, without assuming the existence of a finite dimensional ALPV  realization. In fact, the finite rank of the Hankel-matrix represents the necessary and sufficient condition for the existence of an ALPV  realization. The Kalman-Ho realization algorithm was discussed in [\cite=RolandAbbas], but it was formulated with the assumption that an ALPV  realization exists. Moreover, the conditions under which the algorithm yields a true realization of the input-output map were not discussed in detail in [\cite=RolandAbbas]. Extended observability and reachability matrices were presented in [\cite=Verhaegen09] [\cite=RolandAbbas]. However, their system-theoretic interpretation and relationship with minimality were not explored.

Realization theory of more general linear parameter-varying systems was already developed in [\cite=Toth1]. In [\cite=Toth1] the system matrices are allowed to depend on the scheduling parameter in a non-linear way. Moreover, in [\cite=Toth1] no conditions involving the rank of the Hankel-matrix were formulated for the existence of a state-space realization. Hence, the results of [\cite=Toth1] do not always imply the ones presented in this paper. The minimality conditions of [\cite=Toth1] imply those of this paper. However, an ALPV  may be minimal in the sense of this paper, and may fail to be minimal in the sense of [\cite=Toth1]. Intuitively this is not at all surprising, since it is conceivable that by allowing more complicated dependence on the scheduling parameter we can get rid of some states.

In particular, minimal ALPVs  in the sense of this paper are related by constant state-space isomorphism. This is in contrast to [\cite=Toth1], where the isomorphism relating state-space representations may depend on the scheduling parameter. Note that a minimal ALPVs  in the sense of this paper need not be minimal in the sense of [\cite=Toth1]. Hence, there might exist several state-space isomorphisms between ALPVs  which are minimal in the sense of this paper. Some of these isomorphisms might depend on the scheduling parameters. However, the results of this paper imply that there will be a constant state-space isomorphism. This is also consistent with [\cite=TothKulcsar].

Although realization theory of ALPVs  is quite similar to that of linear switched systems, there are important differences. In particular, there exist no parallel for linear switched systems of the equivalence between realizability and existence of input-output equations. In fact, ALPVs  seem to behave more like state-affine systems [\cite=Son:Resp] [\cite=Son:Real] for which an analogous result exists.

It is well known that there is a correspondence between LPVs and LFT representations [\cite=VerdultPhd] [\cite=Toth2]. In [\cite=ball:1474] [\cite=Beck1] [\cite=Beck2] the theory of recognizable formal power series was used to develop realization theory for LFT representations. In this paper we reduce the realization problem of ALPVs  to that of for linear switched systems. The latter problem can also be solved by using recognizable formal power series [\cite=MP:RealForm] [\cite=MP:BigArticlePartI] [\cite=MPLBJH:Real]. Hence, there is an analogy between our approach and that of [\cite=ball:1474] [\cite=Beck1] [\cite=Beck2]. Note that the transformations between ALPVs  and LFT representations involve non-trivial transformations of the system matrices. Moreover, the resulting class of LFT representations seem to differ from the one in [\cite=ball:1474] [\cite=Beck1] [\cite=Beck2]. For this reason, it is unclear how the results of this paper could be derived directly from [\cite=ball:1474] [\cite=Beck1] [\cite=Beck2] and whether such an approach would be simpler than the current one.

Outline In § [\ref=sect:switch] we review the definition of ALPVs  and the related system-theoretic concepts. In § [\ref=lpv_real:pf] we establish the formal relationship between ALPVs  and linear switched systems. In § [\ref=lpv_real] we present a Kalman-style realization theory for ALPVs. Finally, in § [\ref=sect:io_eq] we present the input-output equations describing the behavior of ALPVs.

Notation Denote by [formula] the set of natural numbers including 0. The notation described below is standard in automata theory, see [\cite=AutoEilen]. Consider a (possibly infinite) set X. Denote by X+ the set of finite non-empty sequences of elements of X, i.e. each w∈X+ is of the form [formula], [formula], k  >  0. The length of the sequence w above is denoted by |w|. We denote by wv the concatenation of the sequences w,v∈X+, i.e. if [formula] and [formula], [formula], then [formula]. We denote by ε the empty sequence. We define [formula] as the set of all finite sequences of elements of X, including the empty sequence. By convention, |ε| = 0, and the concatenation is extended to X* as follows: for all w∈X*, wε  =  εw = w. For each [formula], ej is the jth unit vector of [formula], i.e. [formula], δi,j is the Kronecker symbol. If Z is a subset of a vector space, then [formula] denotes the vector space spanned by the elements of Z.

Discrete-time LPV systems

In this section we present the formal definition of ALPVs  along with a number of relevant system-theoretic concepts for ALPVs.

A discrete-time affine linear parameter-varying system (abbreviated by ALPV) is of the form

[formula]

Here [formula] is the space of scheduling parameters, D is a positive integer, [formula] is the scheduling signal, [formula] is the input, [formula] is the output and [formula], [formula], [formula], [formula] are the system matrices. We will use the following short notation.

[formula]

In the sequel, [formula].

The definition above also allows for affine dependence on the scheduling parameters. To this end, choose P to be of the form [formula] for some set [formula]. Moreover, if the affine hull of [formula] equals [formula], then the linear span of P will be equal to [formula]. The latter property is important, because in the sequel we often use the technical assumption that P contains a basis of [formula].

Note that in our definition the output yt at time t does not depend on the input at time t. This restriction is made in order to simplify notation and most of the results can be easily extended to include direct dependence of yt on ut.

Throughout the section, Σ denotes an ALPV of the form [\eqref=lin_switch0]. The dynamics of Σ is driven by the inputs {u(t)}∞t = 0 and the scheduling parameters {p(t)}∞t = 0. The state of the system at time t is x(t). If [formula], where ei denotes the ith standard basis vector, [formula], then the ALPV  Σ can be viewed as a linear switched system with the set of discrete modes being equal to [formula].

In order to enable formal discussion, we define a number of standard concepts such as input-output maps, reachability, etc. for ALPVs.

Denote [formula].

We denote by U* (resp. U+) the set of all finite (resp. non-empty and finite) sequences of elements of U. A sequence

[formula]

describes the scenario, when the scheduling parameter p(i) and the input u(i) are fed to Σ at time i, for [formula].

Let [formula] be a state of Σ. Define the input-to-state map [formula] and input-output map [formula] of Σ as follows. For any w∈U+ of the form ([\ref=inp_seq]), define xΣ,x(w) as the state x(t) of Σ at time t, and define yΣ,x(w) as the output y(t) of Σ at time t, if the initial state x(0) of Σ equals x, and the inputs {u(i)}ti = 0 and the scheduling signal {p(i)}ti = 0 are fed to Σ. Note that for t = 0, xΣ,x(w) = x.

The definition above implies that the potential input-output behavior of an ALPV  can be formalized as a map

[formula]

The value f(w) for w of the form [\eqref=inp_seq] represents the output of the underlying black-box system at time t, if the inputs {u(i)}ti = 0 and the scheduling parameters {p(i)}ti = 0 are fed to the system. This black-box system may or may not admit a description by a ALPV. Next, we define when an ALPV  describes (realizes) f.

The ALPV  Σ of the form [\eqref=lin_switch0] is a realization of an input-output map f of the form [\eqref=io_map], if f equals the input-output map of Σ which corresponds to the zero initial state, i.e. f = yΣ,0. The map yΣ,0 will be referred to as the input-output map of Σ and it will be denoted by yΣ.

Similarly to [\cite=MP:BigArticlePartI] [\cite=MP:RealForm], the results of this paper could be extended to families of input-output maps and multiple initial states. However, in order to keep the notation simple, we deal only with the case when the initial state is zero.

Two ALPVs  Σ1 and Σ2 are said to be input-output equivalent, if yΣ1 = yΣ2.

Let Σ be an ALPV  of the form [\eqref=lin_switch0]. We say that Σ is reachable, if the linear span of all the states of Σ which are reachable from the zero initial state yields the whole space [formula].

The ALPV  Σ is called observable if for any two states [formula], yΣ,x1 = yΣ,x2 implies x1 = x2.

That is, observability means that if we pick any two distinct states of the system, then for some input and scheduling signal, the resulting outputs will be different.

Note that the concepts of reachability and observability presented above are strongly related to extended controllability and observability matrices from subspace identification of ALPVs  [\cite=Verhaegen09]. Later on, we will show that the ALPV  is reachable if and only if the extended controllability matrix is full rank, and the ALPV  is observable if and only if the extended observability matrix is full rank.

Finally, we recall the notion of isomorphism for ALPVs.

Consider a ALPV  Σ1 of the form ([\ref=lin_switch0]) and a ALPV  Σ2 of the form

[formula]

with na = n. A nonsingular matrix [formula] is said to be an ALPV  isomorphism from Σ1 to Σ2, if

Note that in the definition of an ALPV  isomorphism, the state-space transformation S does not depend on the scheduling parameter. Finally, below we define what we mean by the dimension minimality of a ALPV.

The dimension of Σ, denoted by dim Σ, is the dimension n of its state-space.

Let f be an input-output map. An ALPV  Σ is a minimal realization of f, if Σ is a realization of f, and for any ALPV  [formula] which is a realization of f, dim Σ  ≤   dim . We say that Σ is minimal, if Σ is a minimal realization of its own input-output map yΣ.

Relationship between linear switched systems and ALPVs

In this section we establish a formal relationship between ALPVs  and linear switched systems. We start by stating the following assumption. Note that the assumption above is not restrictive. Indeed, if P belongs to a [formula] dimensional proper linear subspace X of [formula], then we can define a linear map [formula] such that [formula] is injective on X and replace the set of scheduling parameters by [formula]. Since [formula] is linear, the parameters of the resulting new LPV system will depend on the parameters in an affine way.

Next, we introduce the concept of generalized convolution representation for input-output maps. This concept will allow us to concentrate on input-output maps for which there is a hope that they can be realized by ALPVs.

Let [formula] be a sequence of scheduling parameters and let [formula], [formula]. Then [formula].

Let f be an input-output map of the form [\eqref=io_map]. The map f has a generalized convolution representation (abbreviated as GCR), if there exists a map [formula] such that for each w∈U+ of the form [\eqref=inp_seq],

[formula]

where [formula].

The convolution representation states that f(w) is linear in control input and that it is a homogeneous polynomial of degree one in the scheduling parameters. The values of the map Sf play the role of the coefficients of this polynomial. Note that the concept of GCR above is a special case of impulse response representation (IRR) in [\cite=Toth1]. Note that since in the ALPVs  of interest the output at time t does not depend on the input at time t, the summation in [\eqref=sect:io:def1:eq1] goes only up to t - 1. Below we show that Sf is uniquely determined by f and that the existence of a GCR implies that without loss of generality we can assume that [formula].

If f has a GCR, then the map Sf is uniquely determined by f. Moreover, there exists a unique extension fext of f to U+ext, where [formula], such that fext also admits a GCR and Sf = Sfext.

The fact that fext exists relies on the fact that [\eqref=sect:io:def1:eq1] is defined for any values of [formula], and by noticing that the right-hand side of [\eqref=sect:io:def1:eq1] is a sum of terms, each of which multilinear in [formula], [formula]. Recall that function [formula] is multi-linear, if for each [formula], if we fix [formula] and we vary only zi, then g is a linear function of zi. Then set fext as the value of the right-hand side of [\eqref=sect:io:def1:eq1]. If the value of f(w) is known for [formula] where [formula] run through a bases of [formula], then these values uniquely determine the value of the right-hand side of [\eqref=sect:io:def1:eq1], and thus fext exists and it is unique and Sfext = Sf. Finally, the uniqueness of Sf follow by noticing that [formula] for [formula], [formula], [formula].

In the sequel, we will restrict attention to input-output maps which admit a GCR. This is not a strong restriction, since the input-output maps of ALPVs  always admits a GCR.

The ALPV  Σ of the form [\eqref=lin_switch0] is a realization of an input-output map f if and only if f has a GCR and for all [formula], [formula], t  >  0

[formula]

If t = 1, then [formula] is interpreted as the identity matrix.

Now we are ready to state the relationship between ALPVs  and linear switched systems. To this end, we introduce the following notation.

Denote [formula] and [formula].

Recall that we can view linear switched systems as a subclass of ALPVs, such that the space of scheduling parameters equals Psw. Potential input-output maps of linear switched systems are maps of the form [formula] such that f admits a GCR. Linear switched systems and their input-output maps in the sense of [\cite=MPLBJH:Real] correspond to linear switched systems and their input-output maps in the above sense, if one identifies the scheduling parameter eq with the discrete mode q∈Q. We refer the reader to [\cite=MPLBJH:Real] for the notion of realization, minimality, observability, span-reachability, isomorphism. Alternatively, all these notions are special cases of the corresponding concepts for ALPVs, if one identifies linear switched systems as a subclass of ALPVs . Note that the concept of span-reachability from [\cite=MPLBJH:Real] corresponds to the concept of reachability as defined in Definition [\ref=def:reach].

For each [formula] admitting a GCR, define the associated switched input-output map [formula] as follows. Let fext be the extension of f to U+ext as described in Lemma [\ref=lpv:lemma1] and define [formula] as the restriction of fext to U+sw  ⊆  U+ext.

By noticing that [formula] we can in fact conclude that the correspondence between f and [formula] is one-to-one. Next we will establish a correspondence between ALPVs  and linear switched systems.

Let Σ be a ALPV  of the form [\eqref=lin_switch0]. Define the linear switched systems [formula] associated with Σ as the linear switched system [formula].

The following theorem collects the properties of the correspondence between linear switched systems and ALPVs.

An ALPV  Σ is a realization of the input-output map f, if and only if [formula] is a realization of [formula].

For any ALPV  Σ, [formula].

Two ALPVs  Σ1 and Σ2 are isomorphic if and only if [formula] is isomorphic to [formula].

The ALPV  Σ is reachable, observable, minimal if and only if [formula] is respectively reachable, observable, or minimal.

The only non-trivial statement is that [formula] preserves reachability and observability. Let Σ be an ALPV  of the form [\eqref=lin_switch0]. First we show that Σ is reachable if and only if [formula] is reachable. To this end, consider the map input-to-state map [formula] of Σ. Notice that xΣ,0 can be extended to act on U+ext and that for any input w∈U+ext of the form [\eqref=inp_seq], xΣ,0 is a sum of terms, each of which is multilinear in [formula]. Hence, the linear span of the values of xΣ,0(w), w∈U+ext equals the linear span of values of xΣ,0(w), [formula], where [formula] is a basis of [formula]. Since by Assumption [\ref=assum1] P contains such a basis of [formula] and Psw is a basis of [formula], it follows that the linear span of xΣ,0(w), w∈U+ equals the linear span of xΣ,0(w), w∈U+sw. Finally, notice that [formula] for all w∈U+sw. Hence, Σ is reachable if and only if [formula] is reachable.

Next, we show that Σ is observable if and only if [formula] is observable. To this end, notice that yΣ,x can be extended to U+ext and that for any w∈U+ext of the form [\eqref=inp_seq], yΣ,x(w) is a sum of terms, each of which is multilinear in [formula]. Hence, yΣ,x1 and yΣ,x2 agree on U+, if they agree on any set [formula], where [formula] is a basis of [formula]. Since Psw is a basis of [formula] and by Assumption [\ref=assum1] P contains a basis of [formula], it then follows that yΣ,x1 and yΣ,x2 are equal on U+ if and only if they are equal on U+sw. Notice that for i = 1,2, [formula] coincides with the restriction of yΣ,xi to the set U+sw. This then implies that Σ is observable if and only if [formula] is observable.

Kalman-style realization theory

In this section we exploit Section [\ref=lpv_real:pf] and realization theory of linear switched systems [\cite=MP:RealForm] [\cite=MP:BigArticlePartI] [\cite=MP:PartReal] [\cite=MPLBJH:Real] to formulate a Kalman-style realization theory for ALPVs.

We start with presenting a characterization of minimality.

An ALPV  is minimal, if and only if it is reachable and observable. If two minimal ALPVs  are equivalent, then they are isomorphic.

The theorem above is a direct consequence of Theorem [\ref=lpv:theo1] and [\cite=MPLBJH:Real].

Similarly to linear switched systems [\cite=MPLBJH:Real], one can construct example of an ALPV  Σ which is minimal (reachable, observable), while none of the linear subsystems (Aq,Bq,Cq), q∈Q is minimal (resp. reachable, observable).

Next, we present rank conditions for observability and reachability. To this end, recall from [\cite=RolandAbbas] [\cite=Verhaegen09] the definition of extended reachability and observability matrices for ALPVs. That is, let Σ be of the form [\eqref=lin_switch0]. We define the extended reachability matrices Ri, [formula] for Σ as follows: [formula] and for all [formula], let

[formula]

Similarly, we define the extended observability matrices Oi for Σ recursively as follows: [formula] and for all [formula],

[formula]

Notice that Rn - 1 equals the reachability matrix of the switched system [formula] and On - 1 equals the observability matrix of [formula]. For the definition of reachability and observability matrices for linear switched systems see [\cite=MPLBJH:Real]. Hence, Theorem [\ref=lpv:theo1] and [\cite=MPLBJH:Real] yield the following rank conditions.

The ALPV  Σ is reachable if and only if [formula], and Σ is observable if and only if [formula].

Theorem [\ref=sect:real:lemma1] yields algorithms for reachability, observability and minimality reduction of ALPVs. These algorithms are the same as those for linear switched systems [\cite=MPLBJH:Real].

Next, we present the necessary and sufficient conditions for the existence of a ALPV realization for an input-output map. To this end, we need the notion of the Hankel-matrix and Markov-parameters of an input-output map. In the sequel, f denotes a map of the form [\eqref=io_map], and we assume that f has a GCR.

The Markov-parameter Mf(v) of f indexed by the sequence v∈Q* is the following rD  ×  Dm matrix

[formula]

That is, Mf(v) can be viewed as a D  ×  D block matrix, such that the (i,j)th entry of Mf(v) equals Sf(jvi), j,i∈Q.

If f has an ALPV  realization Σ, then from Lemma [\ref=lpv:col0] it follows that Mf(v) can be expressed as product of matrices of Σ: if Σ is as in [\eqref=lin_switch0], then [formula] and for all [formula], k  >  0,

[formula]

where [formula], [formula].

Note that the values of the map Sf, and hence the Markov-parameters {Mf(v)}v∈Q* can be obtained from the values of f. A naive way to compute Sf is to compute the derivatives of f with respect to the scheduling parameter. It is easy to see that the Markov-parameters f and [formula] coincide, i.e. [formula], v∈Q*. Moreover, when applied to linear switched systems, the Markov-parameters from Definition [\ref=sect:io:def0] coincide with the ones in [\cite=MPLBJH:Real].

Note that the definition of Markov-parameters does not assume the existence of an ALPV  realization of f. In fact, even if f does not admit a finite dimensional state realization, its Markov-parameters remain well-defined. The reason for this choice is that we want to use the Markov-parameters to characterize the existence of a finite dimensional ALPV  realization of f. This will be achieved by constructing a Hankel-matrix from the Markov-parameters and by proving that f has an ALPV  realization if and only if the rank of that Hankel-matrix is finite. Of course, for this to make sense, we have to define the Markov-parameters and the Hankel-matrix as objects which are well-defined even in the absence of a finite dimensional state-space representation.

In order to define the Hankel-matrix of f, we will introduce a lexicographic ordering on the set Q*.

Recall that [formula]. We define a lexicographic ordering [formula] on Q* as follows. For any v,s∈Q*, [formula] holds if either (a) |v|  <  |s|, or (b) 0  <  |v| = |s| = k, v  ≠  s and the following holds: [formula], [formula], [formula], and for some [formula], ql  <  sl with the usual ordering of integers and qi = si for [formula]. Note that [formula] is a complete ordering and

[formula]

with [formula]. Note that v1  =  ε and for all [formula], q∈Q, [formula].

Define the Hankel-matrix Hf of f as the following infinite matrix

[formula]

i.e. the rD  ×  mD block of Hf in the block row i and block column j equals the Markov-parameter Mf(s), where the word s = vjvi∈Q* is the concatenation of the words vj and vi from [\eqref=rem:lex:eq1].

Note that [formula] and the definition of the Hankel-matrix coincides with the one for linear switched systems [\cite=MPLBJH:Real].

The map f has a realization by an ALPV  if and only if f has a GCR  and [formula]. Any minimal ALPV  realization of f has dimension equal to [formula].

The theorem above is a direct consequence of Theorem [\ref=lpv:theo1] and [\cite=MPLBJH:Real].

Finally, we prove the correctness of the Kalman-Ho-like realization algorithm for ALPVs  from [\cite=RolandAbbas]. A similar algorithm was formulated for linear switched systems in [\cite=MP:PartReal] [\cite=MPLBJH:Real]. To this end, we need the following definition. For every [formula], denote by [formula] the number such all the sequences v∈Q* of length at most L. Due to the properties of lexicographic ordering, it follows that [formula].

Denote by Hf,L,M the [formula] upper-left sub-matrix of Hf.

If f is realized by an ALPV  Σ, then Hf,L,M  =  OLRM, where OL is the Kth extended observability matrix and RM is the Mth extended reachability matrix of Σ. In this case Hf,L,M coincides with the Hankel-matrix defined in [\cite=RolandAbbas]. The Kalman-Ho algorithm goes as follows. Compute the factorization

[formula]

such [formula], [formula] and [formula] for [formula]. One way to compute this factorization is by SVD decomposition as in [\cite=RolandAbbas], i.e. if Hf,L,L + 1 = USVT is the SVD decomposition of Hf,L,L + 1 where S is the diagonal part, then set [formula] and [formula]. Let [formula] be the matrix formed by the first [formula] columns of [formula]. For each q∈Q, let [formula] be the [formula] matrix, such that the jth n  ×  mD block column of [formula] equals to the kth n  ×  mD block column of [formula], where k is such that vjq = vk. Here vk and vj are the jth and kth elements of the lexicographic ordering [\eqref=rem:lex:eq1]. Construct Σ of the form ([\ref=lin_switch0]) such that [formula] equals the first mD columns of [formula], [formula] equals the first rD rows of [formula] and [formula], where [formula] is the Moore-Penrose pseudoinverse of [formula].

If [formula], then Σ computed by the algorithm above is a minimal realization of f. The condition [formula] holds, if there exists an ALPV  realization Σ of f such that dim Σ  ≤  L + 1.

The theorem above is a direct consequence of Theorem [\ref=lpv:theo1] and [\cite=MPLBJH:Real].

Input-output equations for ALPVs

In this section we use the results of realization theory to establish a relationship between ALPVs  and input-output equations. In the sequel, f is assumed to be an input-output map [formula] and it is assumed that f admits a GCR. In order to avoid excessive notation, in this section we assume that r = 1. However, all the results can easily be extended to several outputs.

An affine polynomial equation [formula] of order n is a polynomial in variables [formula], [formula], [formula] such that

[formula]

where [formula], [formula], [formula] are polynomials, [formula], [formula] and [formula].

Assume that E is an affine polynomial equation of the form [\eqref=sect:io_eq:eq1]. Then the input-output map f is said to satisfy the equation E, if for each w of the form [\eqref=inp_seq] wit t  >  n, E(f,w) = 0, where E(f,w) denotes the value of [formula] with the following substitution Pi,j = pj(t - i), Ui,l = ul(t - i) [formula] for j∈Q, [formula], [formula].

Assume that the set of scheduling parameters P is an open subset of [formula]. The input-output map f has a realization by an ALPV  if and only if f satisfies an affine polynomial equation of the form [\eqref=sect:io_eq:eq1].

In [\cite=Toth1] it was shown that input-output maps of LPV systems with a meromorphic dependence on parameters correspond to input-output maps which satisfy linear autoregressive equations with respect to outputs and inputs. The coefficients of these autoregressive equations were meromorphic functions of the time-shifted scheduling parameters. Affine polynomial input-output equations represent a special case of the autoregressive equations of [\cite=Toth1]. Theorem [\ref=lpv:io_eq:theo1] says that input-output maps described by these type of equations (and which, in addition, admit a GCR) correspond precisely to input-output maps realizable by ALPVs.

The proof of Theorem [\ref=lpv:io_eq:theo1] is an adaptation of the proof of the analogous statement for state-affine systems [\cite=Son:Resp] [\cite=Son:Real]. The proof is divided into several lemmas, proofs of which are presented in the appendix.

If the interior of P not empty, then f satisfies the input-output equation [\eqref=sect:io_eq:eq1] if and only if its extension fext from Lemma [\ref=lpv:lemma1] satisfies [\eqref=sect:io_eq:eq1].

From Lemma [\ref=lpv:io_eq:lemma-1] it follows that without loss of generality, we can assume [formula].

For any sequence [formula], [formula], k  >  0 define the map [formula] as follows:

[formula]

Recall that [formula] denotes the concatenation of the sequence w with the sequence [formula]. Intuitively, [formula] equals the response of f, if first we feed in the inputs and scheduling parameters prescribed by w and then for the last k time steps we feed in the zero input and the scheduling parameters [formula].

There exists an affine polynomial input-output equation E of the form [\eqref=sect:io_eq:eq1] such that f satisfies E, if and only if there exists polynomials [formula], [formula] such that Q0  ≠  0, and for any [formula],

[formula]

Before formulating the next statement, recall the set of all maps [formula] forms a vector space with respect to point-wise addition and multiplication by scalar.

The map f satisfies [\eqref=sect:io_eq:eq2] for some Qj, [formula] if and only if [formula] is finite dimensional.

The input-output map f has a realization by a ALPV  if and only if [formula] is finite dimensional.

The proof of Lemma [\ref=lpv:io_seq:lemma5] boils down to showing that there is a linear isomorphism between Wf and the linear space spanned by the rows of the Hankel-matrix Hf of f. Hence, Wf is finite dimensional if and only if [formula]. By Theorem [\ref=sect:real:theo2], the latter is equivalent to the existence of an ALPV  realization of f. Theorem [\ref=lpv:io_eq:theo1] follows from the lemmas above as follows. From Lemma [\ref=lpv:io_seq:lemma5], f has a realization by a ALPV  if and only if Wf is finite dimensional. By Lemma [\ref=lpv:io_seq:lemma4] and Lemma [\ref=lpv:io_eq:lemma1], the latter is equivalent to existence of an affine polynomial equation of the form [\eqref=sect:io_eq:eq1] such that f satisfies E.

Conclusion

We have presented realization theory for the class of affine LPV systems. In addition, we have shown that realization theory of this class of LPV systems is equivalent to that of for linear switched systems. We have also presented an equivalent input-output representation for affine LPV systems.

Technical proofs

Note that E(fext,w) is a polynomial expression in [formula] for each w of the form [\eqref=inp_seq]. Since E(fext,w) = 0 for all w∈U+ and U is an open subset of Uext, it then follows that E(fext,w) = 0 for all w∈Uext.

By substitution it is clear that if [\eqref=sect:io_eq:eq1] holds, then [\eqref=sect:io_eq:eq2] holds. Conversely assume that [\eqref=sect:io_eq:eq2] holds. With the notation of [\eqref=sect:io_eq:eq1], notice that for [formula], [formula],

[formula]

where [formula], and Rj,i, [formula] are suitable polynomials. Consider the expression [formula]. By grouping together the terms [formula] in a suitable way, we can obtain polynomials Lj,l, [formula] and [formula] such that then [\eqref=sect:io_eq:eq1] holds.

Assume that f satisfies [\eqref=sect:io_eq:eq2]. It then follows from [formula], [formula], w∈U+ that for any [formula], r  ≥  0,

[formula]

Define [formula]. Note that as P contains an open set, there exists a finite subset E of P such that the elements of E span [formula]. Since [formula] is multi-linear in [formula], [formula] is a linear combination of [formula], [formula]. Since Ek is a finite set. it then follows that Wf,k is finite dimensional.

Since Q0  ≠  0, there exists an open and dense subset Z  ⊆  Pr + n + 1 such that for any [formula], [formula], [formula]. By dividing [\eqref=sect:io_eq:eq22] with [formula], and using induction on r, it then follows that [formula]. Since Z is dense, it then follows that for any [formula], there exist [formula], [formula], [formula], such that lim j  →    ∞pji  =  pi, [formula]. As [formula] is polynomial (multi-linear) in the entries of [formula], it then follows [formula] for all w∈U+, i.e. fj∈Wf,n converges to [formula] point-wise. Since Wf,n is finite dimensional vector space, it then follows that [formula].

Indeed, let [formula] be a basis of Wf,n. Then there exist [formula] and such that the matrix [formula], [formula], is invertible. Define [formula], and [formula], It then follows that [formula], where [formula] satisfies αj = S- 1vj. We claim that if [formula], then [formula]. Assume the contrary. Then for some w∈U+, [formula]. Notice that lim j  →    ∞vj = v and hence α  =  S- 1v  =   lim j  →    ∞S- 1vj  =   lim j  →    ∞αj. Hence, [formula], which is a contradiction.

Hence, [formula], for all ∈P+, || = n + r + 1, and thus Wf,n = Wf, i.e. Wf is finite dimensional.

Conversely, assume that Wf is finite dimensional. For each [formula], [formula], denote by fv the map [formula]. As it was noted above, [formula] is multilinear in [formula] and hence Wf equals the linear span of [formula] for some [formula]. Notice that for any [formula], || = k, [formula]. Since for every v∈Q+, fv is a linear combination of fzi, [formula], there exist polynomials Pi,k is kD variables, such that [formula] for any [formula].

Consider now the d  ×  (d + 1) polynomial matrix [formula] in variables [formula], [formula] such that (i,j)the entry of [formula] equals [formula], Let's view [formula] as a matrix with elements in [formula]. Here, [formula] is the quotient field of the polynomial ring [formula]. Since [formula] has only d rows and d + 1 columns, the columns of [formula] must be linearly dependent. It then follows that there exist polynomials [formula], Nj  ≠  0, [formula], such that Dk *  ≠  0 and [formula]. By multiplying the equation above by the product of [formula] we get that

[formula]

for some polynomial [formula], Rk*  ≠  0. Notice that the polynomial Pi,j depend only on the variables [formula], hence [formula] can be chosen to be polynomials only in [formula]. If k* = 1, then Pi,1 = 0 and hence fp = 0 for all p∈P. Hence, [formula] for for all w∈U+, [formula], k  >  0. Then [\eqref=sect:io_eq:eq2] holds for n = 1 with any choice of Q1 and Q0. If k*  >  1, then set n = k*, Qi = Rk* - i, [formula]. Using the fact that [formula] and [\eqref=lpv:io_seq:lemma4:eq2], it then follows that [\eqref=sect:io_eq:eq2] holds for all [formula].

Denote by H the linear span of the rows of the Hankel-matrix Hf. Notice that each element of H can be viewed as a sequence of 1  ×  Dm matrices. We define the linear map Φ:Wf  →  H as follows: [formula], such that for each v∈Q*,

[formula]

In other words, [formula], where [formula]. Moreover, for any w of form [\eqref=inp_seq],

[formula]

Hence, it is clear that Φ is an injective linear map. Moreover, the row of Hf indexed by the integer l = (i - 1)D + q, q∈Q, [formula] equals Φ(feq) if i = 1, or [formula], if i  >  1 and [formula] are such that [formula], where vi is ith sequence of the lexicographic ordering [\eqref=rem:lex:eq1]. Hence, Φ is a linear isomorphism from Wf to the space spanned by the rows of Hf. The rest of follows from Theorem [\ref=sect:real:theo2].