Corollary Lemma

Proposition

Definition Example Remark Note

The sliding-sum method for short exponential sums

Introduction

A basic idea in analytic number theory, with countless applications, is the completion technique, which gives estimates for sums over short intervals of integers in terms of longer sums by means of Fourier techniques. If we denote by [formula] the discrete Fourier transform of a function defined on [formula], [formula], normalized by defining

[formula]

then the basic inequality for sums of values of φ over an interval I of length < m projected modulo m is

[formula]

for some absolute constant [formula], where Î the Fourier transform of the characteristic function of I, which satisfies

[formula]

A very classical application arises when m = p is prime and

[formula]

where χ is a Dirichlet character modulo p and [formula] are fixed rational functions, since one can then build on Weil's theory of exponential sums in one variable over finite fields to estimate the L∞-norm of the Fourier transform of φ. To give a precise statement, assume f = f1 / f2, g = g1 / g2 with [formula], [formula] monic polynomials. Then we have

[formula]

where the implied constant is absolute, for all primes p such that at least one of the following conditions holds:

- the character χ is of order [formula] and f modulo p is not proportional to an h-th power in [formula];

- the rational function g modulo p is not proportional to a polynomial of degree at most 1.

In the special case where χ is non-trivial, f = X and g = 0, this result is the classical Polya-Vinogradov inequality (for prime moduli). In all cases, it is clear that such an estimate is non-trivial as long as I is of length at least [formula].

In this generality, the result is almost best possible, since for

[formula]

the sum over [formula] exhibits no significant cancellation. Although the gap between p1 / 2 and p1 / 2( log p) is small, it is natural to ask whether it should exist or not. We will show in this note that, for many natural functions φ, including those above, one gets some cancellation as long as p1 / 2 = o(|I|). The functions we use are, as in our previous works, the trace functions modulo primes (see Section [\ref=alggeo] for reminders and examples; these functions satisfy a general form of ([\ref=eq-polya-vino-chars]), see Remark [\ref=rm-general].) A special case is the following:

Let p be a prime number, [formula], and let φ be an isotypic Fourier trace function modulo p, of conductor [formula] (for instance

[formula]

where f, [formula] satisfy one of the two conditions above with [formula]).

Then, for any interval I in [formula] with [formula], we have

[formula]

where the implied constant is absolute.

We will derive this from a rather simple general inequality which offers wider possibilities for applications (e.g., we apply it in Section [\ref=sec-mult] to sums of trace functions over geometric progressions in a finite field.) We then apply these bounds to derive equidistribution results which, again, bridge the gap between [formula] and [formula].

Let β be any function defined on positive integers such that [formula] as p  →    +    ∞  , and for all p prime, let Ip be an interval in [formula] of length [formula].

(1) Let f1, [formula] be monic polynomials such that [formula] is not a polynomial of degree [formula]. Then for p prime, the set of fractional parts

[formula]

becomes equidistributed in

[formula]

= e()=2cosθ(n).

[formula]

with respect to the Sato-Tate measure 2π- 1 sin 2θdθ.

For β(p) / ( log p)  →    +    ∞  , this follows from the Polya-Vinogradov bound and Weil's method (for the first part) or the extension by Michel [\cite=michel] of the equidistribution results of Katz [\cite=katz-gskm] for angles of Kloosterman sums (for the second), but as far as we know, this extension was not previously known in general. The first result cannot be improved in general since f(n) = n2 is a counterexample when β is a bounded function. We will also give another similar application to the distribution of "polynomial residues" (see Proposition [\ref=pr-pol-residues]).

We recall that in many cases, one does expect non-trivial estimates for much shorter sums, but only relatively little progress has been made concerning this problem. We only recall two of the most classical results: when φ(m)  =  χ(m) is a non-trivial multiplicative character modulo p, the Burgess bound (see, e.g., [\cite=IK]) is non-trivial for intervals of length [formula] for any ε > 0; for φ(m) = e(mk / p), where [formula] is an an integer, Weyl's method gives non-trivial estimates for intervals of length [formula] for any ε > 0 (see, e.g. [\cite=IK].)

The sliding sum method

Our basic inequality is very simple, and vaguely reminiscent of van der Corput's shift inequality (see, e.g., [\cite=IK]).

We will use the following notation. Let A be a finite abelian group. For any subset B  ⊂  A and any function

[formula]

we denote

[formula]

We also define

[formula]

and the additive correlations of φ given by

[formula]

for a∈A. We note that, by the Cauchy-Schwarz inequality, we have

[formula]

for all a∈A.

When [formula] is a finite cyclic group, we define an interval in A to be a subset B which is the reduction modulo m of an interval of consecutive integers, such that the reduction is injective.

With notation as above, for any [formula], any function φ on [formula], any interval I in A, and any subset D  ⊂  A, we have

[formula]

We write this bound in terms of exact constants but it might be easier to understand asymptotically as m  →    +    ∞  , thinking of the size of D and of the L∞-norm of φ as quantities which remain bounded by absolute constants while m  →    +    ∞  , and viewing the last term as of smaller order of magnitude than the second (which is almost universally true). Estimating the L2-norm in terms of the L∞-norm, the bound becomes roughly of order of magnitude

[formula]

where one can see already that the first term is o(|I|) provided p1 / 2 = o(|I|); see Sections [\ref=sec-abstract] and [\ref=alggeo] for discussion of the estimate of the second term, and for instances where the asymptotic assumptions we described are reasonable.

We now prove Theorem [\ref=central], but first we isolate the property of the interval I that is used: given [formula] and an interval I, we have

[formula]

for all [formula], where

[formula]

with [formula] denoting the symmetric difference. This is a statement of "almost" invariance under additive shifts.

Indeed, for any integer [formula], we have

[formula]

For an integer s with [formula], the integers a with [formula] are distinct modulo m, and thus we get

[formula]

This remark concerning intervals has some interest, because the property involved applies to at least another example.

Let H  ⊂  A be a subgroup of A. Then for a∈A, we have

[formula]

since both H and a + H are H-cosets. Thus we have

[formula]

and hence, for [formula], we have

[formula]

which is very close to ([\ref=eq-almost-invariant]). Thus, the proof below shows that the estimate of Theorem [\ref=central] applies, up to a multiplicative factor, when I is replaced by an arbitrary subgroup of a finite abelian group A. This may be useful when A is far from cyclic, e.g., for the multiplicative group [formula] when p - 1 has many prime factors.

We can assume [formula]. We will then compare upper and lower bounds for the average

[formula]

For the upper-bound, we expand the square and exchange the order of summation, obtaining

[formula]

We split the sum according to whether y - x is in D or not. The contribution of the x and y such that y - x∉D satisfies

[formula]

while, using ([\ref=eq-bound-correlations]), we have

[formula]

Hence we get the upper-bound

[formula]

For the lower-bound, let

[formula]

and use positivity to restrict the sum to a∈Ts(B). For any a∈Ts(B), the set defined in ([\ref=eq-tsb]), we have

[formula]

so that [formula]. Therefore we get

[formula]

by ([\ref=eq-almost-invariant]). Finally, combining the two bounds, we obtain

[formula]

which gives the result.

By the Plancherel formula, the correlations sums C(φ,a) have a dual formulation in terms of the Fourier transform

[formula]

defined on the dual group Â of A: we have

[formula]

This remark may be useful for special functions φ for which ||2 is well understood (see Section [\ref=sec-special-case]). It is also interesting (dually) when trying to apply the method to the dual group Â which is (non-canonically) isomorphic to A, since it reduces the correlation sums to sums over A.

(1) We call the method "sliding sum" because of the intuitive picture where we shift the graph of φ by additive translations, and observe that the sums small shifts of I do not differ too much from the original one.

(2) The set D is meant as containing the "diagonal" contributions. It will contain 0, but might in some cases be a bit larger. In extending the method to higher dimensions, for instance, the dichotomy introduced between shifts by a∈D and a∉D might not be sufficient to obtain a good bound. It might then be necessary to use a finer "stratification" of the possible estimates for C(φ,a). We will not pursue such situations here, but we hope to come back to it later, in contexts involving trace functions in more than one variable.

Abstract application

We continue in a rather general setting before restricting our attention to trace functions modulo primes. We define:

Let A be a finite abelian group and let [formula] be a function on A. For a real number [formula], we say that φ satisfies H(c) if

(i) We have [formula];

(ii) There exists a subset D  ⊂  A with [formula] such that

[formula]

for a∉D.

The idea of this definition is that, except for special values of a (the "diagonal"), φ should not correlate significantly with its additive translate by a; of course D should contain 0, but one can allow some more exceptional shifts. Note that this is a property of φ only, and not of any subset of A on which we might want to sum its values.

The main estimate of Theorem [\ref=central] gives immediately:

Let [formula] for some [formula], and let [formula] be a parameter. For any interval I  ⊂  A and any function φ on A satisfying H(c), we have

[formula]

and if [formula], we have

[formula]

In comparison with ([\ref=eq-fourier]) (with m = p), the bound ([\ref=eq-better-1]) replaces an estimate in terms of the supremum of the Fourier transform with one for an "almost" supremum of the additive correlation sums C(φ,a). It is interesting to note that, in contrast with the Fourier technique, our method is non-linear in terms of the function φ (a similar feature appears in the correlation sums in [\cite=FKM1]).

For fixed c, the estimate ([\ref=eq-better-1]) is non-trivial as long as

[formula]

where the implied constant depends on c, and the point of the result is that this range of uniformity goes beyond that of the classical completion estimates.

On the other hand, if we consider functions φ such that [formula], the Fourier estimate ([\ref=eq-fourier]) is stronger than ([\ref=eq-better-1]) as soon as [formula].

Sums over generalized arithmetic progressions

This section is essentially independent of the remainder of the paper and may be skipped in a first reading.

Let A be a finite abelian group. For a fixed integer [formula], recall (see [\cite=tao-vu]) that a k-dimensional (proper) generalized arithmetic progression B  ⊂  A is a set of elements of the form

[formula]

where [formula] and ni is in some interval Ii of integers of length [formula], and if furthermore (this is the meaning of being "proper") this representation of any b∈B is unique.

If [formula] is a proper k-dimensional generalized arithmetic progression, Shao [\cite=shao] has shown that the L1-norm of the Fourier transform of the characteristic function of B is ≪  ( log m)k, where the implied constant depends only on k. Thus, the completion estimate ([\ref=eq-fourier]) gives a generalized Polya-Vinogradov estimate of the type

[formula]

where the implied constant depends only on k, which is non-trivial as soon as [formula], for functions with bounded Fourier transforms (see Remark [\ref=rm-general] for examples.)

We will adapt the sliding-sum method to prove an estimate for sums over generalized arithmetic progressions which is non-trivial in many cases when the size of B is slightly larger than [formula], thus bridging the gap between this range and the completion range. For simplicity, we only consider the problem for functions satisfying Condition H(c) for some [formula].

Let [formula] be an integer and let [formula] be a real parameter. For [formula] an integer, let [formula], and let B  ⊂  A be a proper generalized arithmetic progression of dimension k such that [formula].

Then, for any [formula] satisfying Condition H(c), we have

[formula]

where the implied constant depends only on k and c.

As in the case of Theorem [\ref=central], the estimate is non-trivial as soon as [formula] for some α depending on k and c.

We will use induction on [formula], but we begin by a general argument to derive the base case k = 1 from scratch instead of appealing to the previous result.

Let [formula] be a proper generalized arithmetic progression of dimension k, formed with integers ([\ref=eq-gap]), where ni∈Ii. It will be convenient to write

[formula]

so that [formula], and we may write β  =  β(B) when the set under consideration changes.

Let [formula]. We distinguish two cases in trying to bound |S(φ;B)|.

(1) If

[formula]

we will just use this estimate (and thus T should be chosen to ensure that it gives the required result, but we do not fix its value immediately in order to clarify the argument).

(2) Otherwise, we have

[formula]

and we proceed by sliding sums, comparing upper and lower bounds for

[formula]

as before. We obtain immediately the upper-bound

[formula]

since φ satisfies H(c) and [formula], where the implied constant depends only on c.

On the other hand, for an element

[formula]

with [formula] for all i, we see that

[formula]

We now distinguish two possibilities concerning the size of the intervals defining B. We select T = (|B| / m1 / 2)1 / (k + 2)  =  β1 / (k + 2), and we assume first that, for all i, we have

[formula]

Note that, if k = 1, there is only one interval involved and [formula], so this assumption is always valid when k = 1.

Taking all

[formula]

for [formula], we obtain [formula] distinct shifts for which

[formula]

by ([\ref=eq-large-sum]) and ([\ref=**]). Hence we have the lower bound

[formula]

where the implied constant depends only on k. Comparing with ([\ref=!]), we obtain

[formula]

where the implied constant depends on k and c.

With our choice of T, we have

[formula]

and therefore, by ([\ref=x]),

[formula]

in this case, as claimed. In particular, this establishes the result when k = 1.

We now proceed to conclude using induction on k. Since the case k = 1 is established, we may assume that we consider [formula], and that the estimate of the theorem is valid for progressions of dimension [formula].

We consider again T = β1 / (k + 2), and we assume that the intervals are ordered in such a way that

[formula]

and we are now assuming that for some j with [formula], we have

[formula]

Note that

[formula]

and therefore

[formula]

which implies in particular that L < |B|, i.e., that j < k, for m sufficiently large in terms of k.

The set B decomposes into a disjoint union of L proper generalized arithmetic progressions (noted Ba) of dimension k - j < k, each of size [formula]. Over each of these, the function φ satisfies the Condition H(c).

By induction, over each subprogression Ba, we have

[formula]

where the implied constant depends only on k and c. By ([\ref=eq-beta]), since |Ba| = |B| / L, we have [formula] (where β  =  β(B)) so that

[formula]

and hence

[formula]

for each subprogression. Summing over the L progressions Ba of dimension k - j, we get

[formula]

as desired.

Trace functions: the additive case

The trace functions of suitable [formula]-adic sheaves modulo primes, which we have studied, and used in applications, in a number of recent works ([\cite=FKM1] [\cite=FKM2] [\cite=FKM3] [\cite=counting-sheaves] [\cite=gowers-norms]), provide many examples of functions on [formula] satisfying H(c) for c bounded independently of p.

To state this fact in a precise way, we recall some standard conventions. For any prime [formula], we fix an isomorphism [formula], and we use it implicitly as an identification for any [formula]-adic number. An isotypic Fourier sheaf modulo a prime p is defined to be a constructible middle-extension [formula]-adic sheaf [formula] on [formula] for some [formula], which is pointwise pure of weight 0, geometrically isotypic, and of Fourier type in the sense of Katz, i.e., its geometric irreducible component is not an Artin-Schreier sheaf ψ for some additive character ψ.

The conductor of a middle-extension [formula]-adic sheaf on [formula] is defined to be

[formula]

where [formula] is the set of singularities of [formula], n() is the cardinality of S and [formula] denotes the Swan conductor at such a singularity. Thus [formula] is a positive integer measuring the complexity of [formula].

Let

[formula]

where χ is a Dirichlet character modulo p and [formula] are fixed rational functions. Then, for all primes p such that f and g modulo p satisfy one of the conditions described in the introduction, the function φ is a trace function associated to a middle-extension sheaf [formula] with

[formula]

where the implied constant is absolute.

Given a middle-extension [formula] modulo p, we denote by [formula] its trace function, which is the function

[formula]

defined by

[formula]

the trace of the action of the Frobenius of [formula] acting on the stalk at [formula] of [formula]. It is known that

[formula]

for all [formula] (for x not a singularity of the sheaf, this follows from the fact that the trace is the sum of [formula] complex numbers of modulus [formula], and for singularities, it is a consequence of the fact that [formula] is a middle-extension and a result of Deligne.)

The crucial fact we use to control correlations is the following version of Deligne's Riemann Hypothesis:

Let p be a prime number, [formula], and let 1 and 2 be two isotypic Fourier sheaves modulo p with conductor [formula]. If the geometric irreducible components of 1 and 2 are not isomorphic, then we have

Let U be a non-empty open set of [formula] where 1 and 2 are both lisse; one can find such a U with [formula], which we assume to be true. We then have

[formula]

since [formula] for i = 1, 2 and all [formula].

By the quasi-orthonormality result of [\cite=counting-sheaves] (or its obvious extension to geometrically isotypic sheaves), which follows from the Riemann Hypothesis over finite fields, we have

[formula]

and the first bound follows.

For the sum over [formula], we just write

[formula]

We can now apply the sliding sum method to trace functions:

Let p be a prime number, and let [formula] be an isotypic Fourier sheaf modulo p with conductor c. Then the trace function [formula] satisfies H(5c3). In particular, we have

[formula]

for any interval [formula], and

[formula]

for any interval I in [formula] with [formula].

This proposition is a more precise form of Theorem [\ref=th-slide], and completes the proof of that result.

Since [formula] for all [formula], the first condition in H(5c3) certainly holds, and we need to consider the correlation sums. For [formula], the function [formula] is the trace function of the sheaf *, which is also an isotypic Fourier sheaf, and which has the same conductor as [formula]. By Theorem [\ref=th-rh], we have

[formula]

unless the geometrically irreducible component of [formula] (say [formula]) is geometrically isomorphic to that of *, which is easily seen to be *. Now suppose this is the case for some [formula]. Then it follows from [\cite=gowers-norms] (applied to [formula], with d = 0) that [formula]. But in that case we have the trivial bound

[formula]

This means that we always have

[formula]

for all [formula], and hence we can take D = {0} in checking H(5c3). The final estimates are then just the applications of Corollary [\ref=cor-concrete], since [formula] and [formula].

As already mentioned in the introduction, trace functions also satisfy a very general analogue of the Polya-Vinogradov bound ([\ref=eq-polya-vino-chars]). More precisely, recall (see [\cite=FKM1]) that if [formula] is an isotypic Fourier sheaf, there exists a Fourier transform sheaf [formula], defined by Deligne, such that

[formula]

for all [formula]. This sheaf is still an isotypic Fourier sheaf and has conductor [formula], and therefore, for such a sheaf [formula], we have

[formula]

so that ([\ref=eq-fourier]) gives

[formula]

for any interval I in [formula], where the implied constant is absolute. (The first cases of such bounds for sheaves which are not of rank 1 are found in [\cite=michel].)

Similarly (see ([\ref=eq-pv-gap])), Shao's result [\cite=shao] gives a bound

[formula]

if [formula] is a proper k-dimensional generalized arithmetic progression.

We can now prove our equidistribution corollary.

(1) We can certainly assume that β(n) < n1 / 2 for all n. By the Weyl criterion, we must show that, for any fixed integer [formula], and for the interval Ip, the sums

[formula]

tend to 0 as p  →    +    ∞  . For a given p, and a suitable [formula]-adic non-trivial additive character ψ of [formula], we consider the rank 1 sheaf

[formula]

which has trace function

[formula]

for all [formula]. This is a middle-extension sheaf modulo p, geometrically irreducible, pointwise pure of weight 0. For p large enough so that hf(X) is not a polynomial of degree [formula], this sheaf is a Fourier sheaf. Its conductor satisfies

[formula]

for all p large enough (the first 1 is the rank, the singularities are at most at poles of f2 and at ∞  , the Swan conductor at a pole of f2 is at most the order of the pole, and at infinity it is at most the order of the pole of f at infinity, which is at most the degree of f1). Hence, by Proposition [\ref=pr-no-correlation], for some [formula] independent of p, the trace function [formula] satisfies H(c) for all p large enough. By Corollary [\ref=cor-concrete], we get

[formula]

by assumption.

(2) Using the Weyl criterion, and keeping some notation from (1), it is enough to show that for any fixed [formula], we have

[formula]

where [formula] is the Chebychev polynomial such that

[formula]

By the theory of Deligne and Katz of Kloosterman sheaves [\cite=katz-gskm], the function

[formula]

is the trace function of a geometrically irreducible sheaf (the symmetric d-th power of the rank 2 Kloosterman sheaf) of rank [formula] on the affine line over [formula], and this sheaf has conductor bounded by a constant depending only on d, and not on p. It is therefore a Fourier sheaf with trace function satisfying H(c) for some c depending only on d, and hence the desired limit holds again by a direct application of Proposition [\ref=pr-no-correlation]. (See also, e.g., [\cite=FKM1] for such facts about Kloosterman sheaves.)

A somewhat similar application is the following:

Let β be a function defined on integers such that [formula] as n  →    +    ∞  . Let [formula] be a non-constant monic polynomial. For all primes p large enough, depending on f and β, and for any interval Ip modulo p of size [formula], there exists x∈Ip such that x = f(y) for some [formula]. In fact, denoting by P the set [formula] of values of f, the number of such x is ~  δf|Ip| as p  →    +    ∞  , where δf = |P| / p.

Here again, the interest of the result is when β(n) is smaller than log n. However, it seems likely that this distribution property should be true for much shorter intervals.

Let φ be the characteristic function of the set P of values f(y) for [formula]. We must show that, for p large enough, we have

[formula]

(which in particular implies that the left-hand side is > 0 for p large enough.)

By [\cite=FKM2], if p is larger than deg (f), there exists a decomposition

[formula]

where the number of terms in the sum and the ci are bounded in terms of deg (f) only, and where φi is the trace function of a tame isotypic sheaf i with conductor bounded in terms of deg (f) only. Moreover, 1 is the trivial sheaf with trace function equal to 1, all others are geometrically non-trivial, and

[formula]

where δf = |P| / p and the implied constant depends only on deg (f). Note that δf  ≫  1 for primes p >  deg (f).

From this, we obtain

[formula]

Since the i, for [formula], are tame and non-trivial, they are isotypic Fourier sheaves, and hence by Proposition [\ref=pr-no-correlation], we get

[formula]

for each [formula], where the implied constant depends only on deg (f). Hence we obtain

[formula]

uniformly for p >  deg (f), since β(p)  →    +    ∞  , which gives the result.

Combining the first part of Proposition [\ref=pr-no-correlation] with Theorem [\ref=th-gap] (instead of Corollary [\ref=cor-concrete]), we obtain an analogue of Theorem [\ref=th-slide] where the interval I is replaced by a k-dimensional generalized arithmetic progressions [formula], with k fixed, namely

[formula]

where the implied constant depends on c and k.

Then, we derive immediately the analogues of Corollary [\ref=cor-rational] and Proposition [\ref=pr-pol-residues] where the intervals are replaced by k-dimensional generalized arithmetic progressions [formula] such that |B| = p1 / 2β(p), where again k is fixed.

Trace functions: the multiplicative case

We consider now a different application of the result of Section [\ref=sec-abstract]: for a prime p, we look at the values of trace functions modulo p on the multiplicative group [formula]. Fixing a generator g of A, we are now looking at sums over geometric progressions xgn for n in some interval I in [formula]. Such sums are considered in [\cite=korobov].

We will use the notation and terminology of the previous section, but to avoid confusion we write [formula] for the restriction of the trace function of a sheaf [formula] to [formula]. The multiplicative analogue of Proposition [\ref=pr-no-correlation] is then:

Let p be a prime number, and let [formula] be an isotypic sheaf modulo p with conductor c with geometric irreducible component not isomorphic to a Kummer sheaf χ for some multiplicative character χ. Then the trace function [formula] satisfies H(6c3) for the group [formula]. In particular, if g is a generator of [formula], we have

[formula]

for any interval I in [formula] with [formula].

Fix as above a generator g of [formula]. For [formula], the correlation sums are now given by

[formula]

where y = ga. The function [formula] is then the restriction to [formula] of the trace function of the sheaf *, which is again an isotypic sheaf, and which has the same conductor as [formula]. By the second bound in Theorem [\ref=th-rh], we get

[formula]

unless the geometrically irreducible component [formula] of [formula] is geometrically isomorphic to *. Now let

[formula]

(where ≃ means geometric isomorphism.) This is a subgroup of ×p, and in fact, by [\cite=FKM2], it is an algebraic subgroup of the multiplicative group. Furthermore, by [\cite=FKM2], it is a finite subgroup under our assumption that [formula] is not a Kummer sheaf. Let then D be the intersection of D̃ with [formula], which is a subgroup of [formula], such that [formula] satisfies ([\ref=eq-good]) for all a∉D. Now we distinguish two cases (the argument is implicit in the proof of [\cite=FKM2]): (1) if [formula] is not lisse on [formula], then all points of the D-orbit of a singularity [formula] are singularities, and hence

[formula]

in which case H(6c3) is true; (2) if [formula] is lisse on [formula], then it is not tamely ramified (since a tamely ramified lisse sheaf on [formula] is geometrically a direct sum of Kummer sheaves) but then [\cite=FKM2] shows that [formula], hence [formula] once more.

Finally, since [formula], we see that ([\ref=eq-better-1]) gives the bound we claim for sums over geometric progressions.

Special improvements

The general argument leading to Theorem [\ref=central] can be improved very slightly in special cases, both with respect to the summation set B, and with respect to the function φ. These tweaks affect separately the upper and lower bounds for the sum

[formula]

We begin with the lower bound, which we can improve when B = I is an interval in [formula].

Let [formula] be an integer and let φ be a function on [formula]. For any ε > 0, and any interval I in A, we have

[formula]

provided [formula] is large enough in terms of ε.

The factor 1 / 3 improves here the factor 1 / 8 of the general inequality ([\ref=eq-basic-eighth]).

Let S = |S(φ;I)| and [formula]. For an integer [formula], we have already noted that [formula], and

[formula]

so we obtain

[formula]

as long as [formula]. The right-hand side is equal to

[formula]

Provided S / (2ν) is large enough, the inner sum is a Riemann sum for

[formula]

and the result follows.

We next consider special cases of functions φ for which the correlations C(φ,a) are known exactly, in which case the upper-bound for Σ can be improved.

One example was already mentioned in the introduction, and is the function on [formula], for [formula], defined by

[formula]

More generally, for p prime, let f, [formula] be rational functions, let χ be a multiplicative character of [formula] and define

[formula]

(with the usual conventions when x is a pole of g or a zero or pole of f). Now let φ be the (opposite of the) Fourier transform of ψ, i.e.

[formula]

so that φ defines a family of one-variable character sums.

Note that, by a classical computation, if [formula], [formula] and [formula], we have

[formula]

where

[formula]

is a normalized Gauss sum, and hence has modulus 1. This shows that ([\ref=quadratic]) is, up to a constant factor of modulus 1 independent of x, a special case of this definition.

The main point is the following lemma:

Let p be a prime number and let

[formula]

where [formula] and [formula] are polynomials. Assume that f is a polynomial with no zero in [formula] (for instance f = 1 or an irreducible polynomial of degree [formula].)

We then have C(φ,a) = 0 for all [formula] and C(φ,0) = p. In particular, we have

[formula]

for any subset [formula].

Note that this lemma does apply to ([\ref=quadratic]) with g = X2 (and f = 1.)

By the Plancherel formula (see ([\ref=eq-plancherel])), we have

[formula]

(where ψ is the function ([\ref=eq-special])), and under the assumptions of the lemma, we see that |ψ(t)|2 = 1 for all [formula], hence the result.

We can use either Lemma [\ref=lm-interval] or Lemma [\ref=lm-special] to derive variants of Theorem [\ref=central]. We just state the combination of the two:

Let p be a prime number, and let φ be a function defined on [formula] by ([\ref=eq-special]) such that f is a polynomial in [formula], and that g is a polynomial with no zero in [formula]. Then, for every ε > 0 and every interval [formula] such that |I| is large enough in terms of ε, we have

[formula]

In particular, for [formula] and [formula], we have

[formula]

provided |I| is large enough in terms of ε.

We just combine the upper and lower bounds for the sum Σ given by Lemmas [\ref=lm-interval] and [\ref=lm-special], observing that if [formula] is too small for Lemma [\ref=lm-interval] to apply, the resulting bound

[formula]

is stronger than ([\ref=in1]) if |I| is large enough.

The exponent 2 / 3 appearing in ([\ref=in1]) improves the exponent 1 / 3 appearing in ([\ref=eq-better-1]) for instance. This is due to the absence of non-diagonal terms. This result implies that the classical bound ([\ref=eq-fourier]) is better than ([\ref=in1]) when [formula], always in the particular case where φ is defined by ([\ref=quadratic])

The result of Theorem [\ref=paticular1] gives a non-trivial bound of |S(φ;I)| as soon as [formula], which is rather close to the critical length p1 / 2.

The conditions described in Lemma [\ref=lm-special] are not the only ones for which we can prove Theorem [\ref=paticular1]. For instance, suppose f (resp. g) has at worse a pole at 0 (resp. at worse a pole or zero at 0), which is the case for instance when

[formula]

for [formula] and ψ(0) = 0, in which case [formula] (the normalized Kloosterman sum) for all [formula]. Then we find that

[formula]

which means that the sum ([\ref=defSigma]) is now equal to

[formula]

from which we see that the result of Theorem [\ref=paticular1] holds. If I is an interval in [formula], we get for instance

[formula]

when |I| is large enough in terms of ε.

We will finish with a multiplicative special case one, as in § [\ref=sec-mult], inspired by [\cite=korobov]. We let

[formula]

where [formula] and [formula] is a primitive root modulo p. The bound ([\ref=eq-good]) is now replaced by

[formula]

when [formula]. We then get:

Let [formula] be a prime, [formula] and let φ be the function defined on [formula] by ([\ref=korobov]). Then, for every ε > 0 and every interval I in [formula], we have

[formula]

if |I| is large enough in terms of ε.

The sum Σ is now given by

[formula]

Expanding the square and appealing to ([\ref=-1]), we obtain

[formula]

which, as in Remark [\ref=rm-kloos], allows us to finish the proof.