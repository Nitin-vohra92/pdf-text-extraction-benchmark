GeFRO: a New Charge Sensitive Amplifier Design with a Minimal Number of Front-end Components

Introduction

detectors are used since a long time to detect ionizing radiation. Among these, Germanium detectors are extensively used for gamma spectroscopy, which requires full absorption of incoming radiation and high energy resolution. Other semiconductor materials exist which can be used for the same purpose. As well known, such detectors are generally readout with charge amplifiers, which convert the charge signals from the detector to voltage signals whose amplitude depends on the value of a known feedback capacitor [\cite=chargeamp1] [\cite=chargeamp2] [\cite=chargeamp3]. A charge amplifier for the readout of semiconductor detectors is generally made of an input JFET (or MOSFET) selected for low noise, a second amplification stage, and the parallel combination of a capacitor and a large value resistor as the feedback elements. For the best noise performance the capacitance at the input node must be minimized, and thus the input JFET and the feedback components should ideally be placed very close to the detector.

For some applications the classic configuration may present some drawbacks. If the detector is operated in a cryogenic environment (as happens with Germanium detectors) and the circuit is placed close to the detector, then the circuit must operate at low temperature. While this is not generally a problem for the input JFET and the feedback components, provided that they are selected accordingly, it can complicate the design of the second stage, possibly preventing the use of some operational amplifiers. If several detectors are placed close to each other and the readout circuits have wide bandwidth, the power dissipation in the cryostat may be large. Moreover, large power supply bypass capacitors may be required at cold to prevent disturbances or crosstalk from being injected through the supply voltages, especially in the case where the connecting cables are long and have a non negligible series resistance. High levels of radiation near the detectors may also require the electronic components to be radiation tolerant, and may prevent the operators from accessing the circuits for optimization or maintenance. In some cases it can thus be beneficial to separate the first stage, made of the JFET and the feedback components, from the second stage, with the aim of placing it in a less hostile environment. In the case of the classic charge sensitive amplifier this results in a bandwidth upper limit, since the cables connecting the first and second stage add capacitance to the feedback loop. Even if the effect of cable capacitance is minimized by connecting the first and second stage with properly terminated transmission lines, the rise time of the signals cannot be shorter than a few times the propagation delay along the cables, as will be discussed in the following.

If the first and second stage of the charge amplifier are separated by a large distance but the high frequency signal components must be retained, a dual readout approach can be used. The "slow" output of a classic charge amplifier (anyway optimized for the maximum achievable closed-loop bandwidth) can be used to measure the total deposited charge, while a "fast" open loop output provides the complementary information at high frequency. The core ideas behind the "fast" output were already described in previous publications [\cite=gefro1] [\cite=gefro2]. In this paper several circuit improvements were introduced to overcome open issues related to small variations of the capacitance at the input node, which could be caused by variations in the counting rate or by mechanical vibrations. The improved circuit design is explained in this paper in thorough detail, and the results obtained with a prototype coupled to a small anode Germanium detector, a Canberra BEGe, are presented.

The field which may benefit most from this circuit solution is that of rare event searches with Germanium detectors, and particularly neutrinoless double beta decay search experiments such as GERDA [\cite=gerda1] and MAJORANA [\cite=majorana1]. The readout approach described in this paper was in fact developed in the framework of the R&D for the phase II of the GERDA experiment, and is then particularly tailored for such application. These experiments need extremely low background coming from the environment, including the detectors themselves and their readout electronics, in order to achieve the necessary sensitivity to the rare nuclear decays of interest. Particular care must be taken in realizing a radiopure readout chain, and a means to this is to minimize the number of components close to the detectors by placing the second stage outside the cryostat, several meters away, while keeping the input JFET and the feedback components close to the detectors to satisfy the low noise requirements. At the same time, the small anode Germanium detectors which these experiments plan to deploy allow to discriminate between different types of particle interactions by pulse shape analysis on the rise time of the signals, reducing the background in the energy region of interest [\cite=psa1] [\cite=psa2] [\cite=psa3]. The readout circuit should then provide the necessary bandwidth of a few tens of MHz in order to preserve the charge collection profile in the detectors. Anyway, as already mentioned, the design approach described in this paper can be applied in other fields, whenever a no-compromise solution with a minimal number of front-end components close to the detector may be of interest.

The GeFRO Circuit

The schematic of the proposed circuit solution is shown in figure [\ref=fig:GeFROSchematic]. It consists of a small front-end stage located close to the detector and a remote second stage located several meters away and connected to the first stage through terminated transmission lines. As already mentioned, the circuit was proposed for the phase II of GERDA, which employs Germanium detectors operated in a cryogenic environment with low radioactive background, to which the readout electronics must comply. Due to the dimensions of the cryostat, the distance between the detectors and the room where the second stage electronics could be placed is about ten meters.

The front-end stage is composed of a JFET Q1 and the feedback elements RF and CF. The input JFET is operated in common source configuration and is located close to the detector to minimize the stray input capacitance, so it should be chosen to have low noise at cryogenic temperature. Several devices are commercially available for such purpose from many manufacturers. Due to the radiopurity constraints of our application, our choice was narrowed to the devices which could be purchased in bare Silicon die. At a few mA of bias current, most of the JFETs tested at low temperature have a transconductance of about 2 mA/V per pF of input capacitance. In order to have a transconductance larger than 20 mA/V, necessary to drive the signal on a terminated 50 Ω transmission line without significant gain loss, the resulting input capacitance from Q1 is at least 10 pF. In the case where the detector capacitance is much smaller, it would then be convenient to work in mismatch conditions, with the input capacitance dominated by Q1. In the measurements presented in the following sections a SF291 JFET from Semefab was used as Q1, featuring a transconductance gm  =   33 mA/V at ID  =   10 mA and VDS  =   2 V, measured at 77 K with a Keithley 4200 semiconductor analyzer. Its gate capacitance of 16 pF was instead evaluated from the amplitude of the "fast" GeFRO signal, as will be described in section [\ref=sec:SigOsc]. In the measurements with the BEGe detector presented in this paper, the total input capacitance CI was close to 26 pF, mainly contributed by the input JFET and parasitics.

At DC, assuming RP  ≫  RQ, the drain of Q1 is held at VR by the feedback loop through A2, and its bias current is given by [formula]. In our case VB  =   12 V, VR  =   2 V, then RB  =   1 kΩ gives for Q1 a bias current of 10 mA. Notably, the bias voltage and current of the input transistor can be tuned by acting on the second stage, without direct access to the front-end. The DC voltage on the feedback line is VG  -  iLRF, where VG is the gate voltage of the polarized JFET and iL is the total current flowing through RF, given by the sum of the leakage currents from the detector and from the JFET. In our measurements iL was contributed by the current in the detector, a few pA at low event rates, and by the gate current of the JFET at 77 K, much less than 1 pA.

Concerning the feedback components, the values chosen for our prototype are RF  =   500 MΩ, CF  =   0.9 pF (CF already includes the parasitic contributions due to RF and layout). In the first version of the GeFRO, as reported in [\cite=gefro1] [\cite=gefro2], only a Schottky diode was used as the feedback element, which served at the same time as the (non linear) large value resistor and capacitor. It was then found difficult to find a Schottky diode with a high degree of radiopurity, while on the contrary Silicon resistors in bare die of high radiopurity were found to be commercially available, with values ranging up to 150 MΩ (MSTF 6SS-15005 J-E from Mini-Systems, Inc.). Three of such resistors can be used in series to obtain a feedback resistor of the required value. If a resistor is used for RF then the Schottky diode is no longer necessary.

A normal Silicon diode of low capacitance, which can be easily found in bare die, can be used at the input to protect the JFET against negative overvoltages which may occur if the high voltage bias of the detector is decreased too fast. If VG  <   0 V the diode needs a negative reference voltage, which would require an additional cable to the front-end stage. As an alternative, the protection diode can be connected in parallel with RF (and biased with 0 V in this case), but in that case the capacitance of the diode should be considered in parallel with CF in the following evaluations. Anyway, if the capacitance of the detector is negligible with respect to the input capacitance due to the JFET and parasitics, as happens with small anode detectors such as the Canberra BEGe, then accidental negative overvoltages at the input are strongly attenuated, and the diode can be omitted. For this reason it will not be considered in the rest of this paper.

The schematic of figure [\ref=fig:GeFROSchematic] also shows the line used to inject a test signal through the test capacitance CT located close to the input node, whose value was 0.5 pF. If the test signal is a voltage step of amplitude VT, a current pulse carrying a known charge Q  =  CTVT is generated.

A signal from the detector is a current pulse carrying a given amount of charge Q. The feedback loop has a finite bandwidth, and has no effect on the first part of the signals. On the fast transient, the current signal is integrated on the input capacitance CI and becomes a voltage step at the input of Q1. The JFET converts this voltage step at the input to a current step at its output, which is driven into a terminated signal line of characteristic impedance RT to avoid reflections. If the drain of the JFET can be approximated as an ideal current source (which is true if its drain-source resistance and gate-drain capacitance can be neglected) then the output signal is insensitive to the series resistance of the output line, which can be as high as a few Ω/m if coaxial cables of small section are used. The line termination RT is AC coupled through CC. Its value is expected to be 50-100 Ω, depending on the choice of cables. In the rest of the paper a characteristic impedance of 50 Ω will be considered. The signal across RT is amplified by the fast voltage amplifier A1 and constitutes the "fast" signal, expressed by

[formula]

where G1 is the gain of A1, gm is the transconductance of Q1, and τL  -  τD is the time constant related to the discharge of the input node after each event, which gives the fall time constant of the "fast" signal. The value of τL is determined by the bandwidth of the feedback loop, while the value of τD is determined by the length of the cables connecting the first and second stage, as will be calculated in the following sections. For stability constraints it will be shown that τL must always be a few times larger than τD. The rise time of the "fast" signal is determined by the bandwidth of the signal cables and of A1. In our prototype A1 was based on a LT6230-10 operational amplifier from Linear, chosen for low voltage noise and large bandwidth, operated at a gain of 21 V/V (RL  =   1 kΩ, RM  =   50 Ω) and externally compensated with CL  =   10 pF to obtain a bandwidth of about 20 MHz. The output of the LT6230-10 was amplified by a AD811 operational amplifier from Analog Devices with a gain of 6.4 V/V (RN  =   270 Ω, RO  =   50 Ω), so that the "fast" signal at the output of the second stage could be driven over a terminated 50 Ω transmission line (RK  =   50 Ω) with an overall gain G1  =   67 V/V.

On a longer time scale the feedback loop becomes effective, forcing the discharge of the input node through the feedback components CF and RF. To do this the feedback amplifier A2 injects a charge through CF which counterbalances the input charge Q. When the input node is discharged, a voltage - Q  /  CF is found across CF, which then discharges through RF with time constant CFRF. The gain and bandwidth of A2 are determined by CP, RP and RQ. Acting on their values allows to tune τL to assure the stability of the feedback loop. The fall time of the "fast" signal V1 coincides with the rise time of the feedback signal V2, which constitutes the "slow" signal. The feedback amplifier in our prototype was a AD797 operational amplifier from Analog Devices, chosen for low voltage noise, low DC offset and relatively large bandwidth. The resistor RS is used to terminate the feedback line on its characteristic impedance at one end, avoiding reflections which may impact stability. If the signal and feedback cables have the same characteristic impedance, then RS  =  RT. Neglecting the DC voltage on the feedback line, the "slow" signal in response to a charge Q is given by

[formula]

where τF  =  CFRF, that is the signal of a classic charge amplifier with bandwidth limited to 1 / 2π(τL  -  τD). It should be noted that the gain of the "slow" signal depends mainly on the value of CF. The input capacitance CI affects the value of τL, as will be shown, but the effect on the signal amplitude is a second order contribution if τF  ≫  τL and the shaping is slow enough with respect to τL. So, even if its bandwidth is smaller with respect to the "fast" signal, the "slow" signal can give a more precise and reliable estimate of the input charge Q in the case where the capacitance CI fluctuates.

The "fast" and "slow" signals are schematically depicted in figure [\ref=fig:GeFROExpectedSignals] for input pulses carrying a positive charge Q. In a general application, both waveforms can be acquired at the same time. The "fast" signal can be used to resolve the charge collection profile in the detector, while the "slow" signal can be used for energy measurement. In the following sections the conditions for the stability of the loop gain will be considered and the validity of equations ([\ref=eq:V1(t)1]) and ([\ref=eq:V2(t)1]) will be demonstrated.

Loop Gain and Stability

Let us first consider the transfer function of the amplifier A2 with its feedback components CP, RP and RQ. In the domain of the complex frequency s the transfer function of the open loop operational amplifier with a dominant pole can be modeled as

[formula]

where A is the open loop gain at DC and 1 / 2πτ2 is the frequency of the dominant pole. As well known, the gain-bandwidth product of the amplifier is ωT  /  2π, where ωT  =  A / τ2. The closed loop transfer function is then

[formula]

Equation ([\ref=eq:G2(s)1]) was obtained by approximating for RP  ≫  RQ and is valid in the range of frequencies f where

[formula]

Since the dominant pole of the operational amplifier is at very low frequency, the second inequality in ([\ref=eq:1/CPRQgg]) is easily satisfied. The first inequality in ([\ref=eq:1/CPRQgg]) will instead be verified once the values for CP and RQ will be chosen.

Let us now consider the entire feedback loop between the first and second stage. The loop gain T(s) is given by

[formula]

The first term is due to RF, which forms a pole with the total input capacitance to ground CI and a zero with the feedback capacitance CF. The expression was approximated for CI  ≫  CF, which is certainly true with the values given in the previous section. The second term is due to the gain of the JFET on the total impedance it sees at its output. This term contributes with a pole at CCRB and a zero at CCRT. This term was approximated for RB  ≫  RT, which is allowed if RB  =   1 kΩ and RT  =   50 Ω as in our case. The third term is due to the feedback amplifier A2, as calculated above. The last exponential term represents the phase shift introduced by the propagation delay τD along the signal and feedback lines. Assuming both lines to have length L, the propagation delay is given by

[formula]

where tP is the propagation delay per unit length. If L =  10 m and tP  =   5 ns/m then τD  =   100 ns.

The components whose values at this point are not fixed by other constraints are CC, RP, CP and RQ. Let us choose CC to be very large, say 1000 μF. With the values given above CCRB  =   1 s, CCRT  =   50 ms, CIRF  =   13 ms, CFRF  =   450 μs. Above a few hundred Hz the loop gain can then be approximated as

[formula]

We can now choose RP so that

[formula]

With such choice equation ([\ref=eq:T(s)2]) simplifies to

[formula]

If we now define

[formula]

the loop gain ([\ref=eq:T(s)3]) can then be written as

[formula]

The loop gain clearly shows a dominant pole at low frequency, and a phase shift term related to the propagation delay along the transmission lines which connect the first and the second stage. This simplified expression is valid in the range of frequencies shown in figure [\ref=fig:GeFROPolesAndZeroes].

As an alternative condition, the loop gain expressed by ([\ref=eq:T(s)2]) can be approximated by letting RP  →    ∞  . In this case, at frequencies larger than 1 / 2πCFRF (that is, above a few kHz) the loop gain can still be written as ([\ref=eq:T(s)4]) where τL is now defined as

[formula]

In most of the measurements presented in this paper the first case will be preferred, that is RP satisfying ([\ref=eq:CFRF]), but the following evaluations on the stability of the loop gain apply also to the case where RP  →    ∞  . As can be clearly seen, in both cases τL can be tuned by changing the values of CP and RQ.

Let us now consider the stability of the loop gain. At DC the loop gain as given by ([\ref=eq:T(s)2]) is a negative real number, or in other words the phase of - T(s) is 0[formula]. The critical frequency to determine the stability of the feedback loop is that for which [formula] 1, that is

[formula]

The closed loop transfer function is proportional to [formula]. If the phase of - T(s) at [formula] becomes too close to 180[formula], the overall loop gain turns positive and instability occurs. The difference between π and the phase of - T(s) at [formula] gives the phase margin, that is

[formula]

In case of short signal and feedback lines the last term in ([\ref=eq:PhiT1]) is negligible. The phase margin is close to 90[formula] and stability is assured. If the signal and feedback lines are long, then the additional phase shift due to the propagation delay on both lines can affect stability. Assuming the distance L between the first and second stage to be fixed, the condition for a phase margin ΦPM larger than 60[formula] leads to a lower value for τL, that is

[formula]

The loop gain is then stable provided that the condition ([\ref=eq:tauL3]) is satisfied. This can be achieved by properly choosing the value of τL by tuning the values of CP and RQ according to equation ([\ref=eq:tauL1]) or ([\ref=eq:tauL2]).

The evaluation of the phase shift introduced by the propagation delay along the cables is correct as long as both the signal and feedback lines are terminated at least at one end, in order to avoid multiple reflections. In the schematic of figure [\ref=fig:GeFROSchematic] both lines are terminated at the second stage, which seems the most convenient thing to do. If either one of the lines were not terminated, the reflections back and forth would bear a larger phase shift than that given by the exponential term in T(s), and the phase margin would be reduced, resulting in a more stringent lower limit for τL.

The "Fast" Signal

Let us now derive the "fast" signal shape, as expressed by equation ([\ref=eq:V1(t)1]). Neglecting the feedback, and by approximating for frequencies above 1 / 2πCIRF, the open loop signal at the "fast" output in response to an instantaneous current pulse carrying a charge Q in the complex frequency domain is given by

[formula]

where, as already discussed, CI is the total input capacitance and gm is the transconductance of Q1. Equation ([\ref=eq:V1OL(s)1]) was obtained by approximating for RB  ≫  RT, and by considering the drain of the JFET as an ideal current source. In the real case the output impedance of the JFET, contributed by its drain-source resistance and gate-drain capacitance, should be included in the calculations. Its effect on the overall gain is a second order contribution and will not be considered here. Equation ([\ref=eq:V1OL(s)1]) also neglects the propagation delay due to the signal line length, which is a simple time shift of τD / 2.

As well known from feedback theory, the open loop signal VOL1 expressed by equation ([\ref=eq:V1OL(s)1]) is modified by the presence of the feedback loop according to the relation

[formula]

Since the feedback loop is ineffective for frequencies above 1  /  2πτL, and τL  >  τD for stability, the denominator of ([\ref=eq:V1(s)2]) can be approximated as

[formula]

The first term derives from a first order expansion of the exponential at frequencies smaller than 1  /  2πτD. The second term was introduced in order to satisfy the condition

[formula]

that is required since the feedback loop is ineffective at frequencies larger than 1 / 2πτL. Equation ([\ref=eq:V1(s)2]) then becomes

[formula]

By taking the inverse Laplace transform of the above, one obtains the "fast" output signal expressed by equation ([\ref=eq:V1(t)1]). This first order approximation loses accuracy when τL is small and comparable to τD. In this case a second order expansion improves the accuracy, as shown in the appendix.

The "Slow" Signal

Let us now derive equation ([\ref=eq:V2(t)1]), which gives the shape of the feedback signal or "slow" output. If we consider the loop gain to be infinite, the input node is held at virtual ground and all the charge flows into CF. The signal in this case would then be given by

[formula]

Again, the time shift due to the propagation delay along the cable was neglected. Its effect on bandwidth is considered through the feedback loop gain T(s). Since the feedback loop has a finite gain and bandwidth, the actual closed loop signal differs from ([\ref=eq:V2IL(s)]). As well known from feedback theory it can be calculated as

[formula]

By using equation ([\ref=eq:T(s)4]) for T(s) we have that

[formula]

where again the exponential was approximated at first order for frequencies below 1  /  2πτD, but a term -  sτD at the numerator was dropped in order to satisfy the condition

[formula]

that is required since the "slow" signal does not contain high frequencies above the bandwidth of the feedback loop. Equation ([\ref=eq:V2(s)1]) then becomes

[formula]

where τF  =  CFRF. By taking the inverse Laplace transform we obtain the "slow" output signal as expressed by equation ([\ref=eq:V2(t)1]). Again, a second order approximation can be considered to improve the accuracy for τL close to τD, and is presented in the appendix.

Signals at the Oscilloscope

As a first test of the validity of the above evaluations, the circuit was operated with the smallest possible value for τL. The input capacitance was 16 pF due mainly to the input JFET. The length of the cables between the first and second stage was L =  10 m, so τD  =   100 ns. In this measurement the values RP  =    ∞  , CP  =   470 pF, RP  =   33 Ω were chosen. The gain-bandwidth product of the AD797 chosen for A2 is ωT  /  2π≃ 100 MHz. With such choices 1  /  ωTRQ≃ 48 pF, which makes its contribution negligible with respect to CP in ([\ref=eq:tauL2]). It is clear that with these values RP  ≫  RQ, as used in the above calculations, and CPRQ  =   15 ns, which makes the frequency of the zero fall outside the bandwidth of the feedback loop. The value of τL which results from ([\ref=eq:tauL2]) is τL  =   184 ns, which corresponds to a phase margin close to 60[formula]. The expected 90% to 10% fall time of the "fast" signal (equal to the 10% to 90% rise of the "slow" signal) is 2.2 [formula] 185 ns.

Figure [\ref=fig:GeFROScopePulser] shows the outputs of the GeFRO as seen at the oscilloscope. The image also shows the pulser signal used to simulate a charge pulse of 460 e-. The rise time of the "fast" output is limited to a few tens of ns mainly by the bandwidth of the amplifier A1. The fall time of the "fast" output is about 180 ns, and clearly coincides with the rise time of the "slow" output. In figure [\ref=fig:GeFROScopePulser] the fall of the "slow" signal cannot be seen in this time scale, since the 90% to 10% fall time 2.2 CFRF is close to 1 ms. From the peak amplitude of the "fast" signal, knowing the values of G1, Q, gm and RT, the input capacitance CI can be measured with the oscilloscope. As can be seen in figure [\ref=fig:GeFROScopePulser], the amplitude of the "fast" output in response to a test pulse of 460 ke- was 390 mV. By adding at the input a known 10 pF capacitor to ground, and adjusting RQ by hand to obtain the same value for τL, the amplitude of the "fast" signal decreased to about 240 mV. From this it is possible to estimate the input capacitance in the previous case as CJ  =   16 pF, mainly given by the JFET.

The known 10 pF capacitor was then disconnected, and a Canberra BEGe detector was connected at the input of the circuit with a short wire. In these conditions the amplitude of the "fast" signal was again close to 240 mV. From this it is possible to infer that the capacitance added by the BEGe detector (and connection parasitics) is CD  =   10 pF. The total capacitance at the input with the GeFRO circuit coupled to the detector was then CI  =  CJ  +  CD  =   26 pF, that is the value which was already considered in the previous calculations. The values of RP and RS were then changed to RP  =   820 kΩ and RQ  =   100 Ω in order to obtain the optimal working conditions with the BEGe detector. These values satisfy the condition ([\ref=eq:CFRF]) and result in τL≃ 950 ns, as calculated from ([\ref=eq:tauL1]). By acting on the amplifier A1, the gain of the "fast" signal G1 was then doubled with respect to the previous case.

Figure [\ref=fig:GeFROScopeSignal] shows the signals seen with the oscilloscope when the detector was illuminated with a 228Th gamma source. The figure shows the "fast" and "slow" signals in yellow and green respectively for a given event of energy close to 2 MeV. The upper image in figure [\ref=fig:GeFROScopeSignal] was taken with a time scale of 20 μs/div. The lower image shows the same event on a time scale of 500 ns/div. The 90% to 10% fall time of the "fast" signal is about 1.8 μs with the values chosen above for CP, RP and RQ. A larger value for the fall time was chosen with respect to the previous case, since as reported in [\cite=psa1] [\cite=psa2] the charge collection time in BEGe detectors is relatively slow, ranging up to a few hundred nanoseconds. As can be seen in the lower image, the high timing resolution of the "fast" signal faithfully reproduces the charge collection profile in the BEGe detector. The event in the figure is clearly a multi-site event, showing separate steps in the charge collection profile. Figure [\ref=fig:GeFROScopeSignal] also shows the "slow" signal after Gaussian shaping at 10 μs, obtained with an Ortec 672 shaper, which was used to measure the energy spectra with an Ortec 919 multichannel analyzer. A more detailed discussion of noise and energy resolution will be given in the following sections.

Noise

The "slow" output of the GeFRO can be shaped with proper filters and used for energy measurements. The most common case in analog processing is Gaussian shaping, already shown in figure [\ref=fig:GeFROScopeSignal]. The amplitude of the Gaussian signal is proportional to the deposited charge, which is in turn proportional to the total energy deposited in the detector by a particle event. The RMS noise of the circuit adds in quadrature to the intrinsic resolution of the detector, and the result gives the expected energy resolution of the system. The noise at the "slow" output of the GeFRO circuit after a Gaussian shaper with time constant τ can be evaluated from the well known equivalent noise charge formula

[formula]

where in is the white current noise spectral density, CI is the total input capacitance, Af is the 1/f voltage noise coefficient and en is the white voltage noise spectral density. In the case of Gaussian shaping the coefficients α, β and γ take the values α≃ 0.44, β≃ 0.89, γ≃ 3.14.

Let us first consider the current noise sources. At 10 μs shaping a detector leakage current of 1 pA gives a shot noise of 0.6 fA/[formula] and contributes to σQ with about 10 e- RMS. The feedback resistor RF, whose value is 500 MΩ and is held at 77 K, gives a thermal noise of 2.9 fA/[formula], and thus contributes with 55 e- RMS. The total current noise at the input at 10 μs is then just below 60 e- RMS, dominated by RF. As expressed by ([\ref=eq:sigmaQ]) the weight of the current noise decreases at shorter shaping times.

If the gain of the cold stage were much larger than one, the noise sources at the second stage could be neglected, and all the series noise would be given by the input transistor Q1. This was directly measured by terminating the signal line with a resistor RT  =   200 Ω, obtaining a gain of 6.6 between the first and second stage. The value of τL was adjusted to a few hundred ns, allowing to shape the "slow" signal with the gaussian shaper with time constant from 1 μs to 10 μs. The equivalent noise charge was evaluated by dividing the RMS noise at the output, measured with a Rohde&Schwartz URE3 RMS voltmeter, by the peak amplitude of the Gaussian shaped signal in response to a known test pulse. The resulting values for the noise of the first stage with CI  =   16 pF are shown in figure [\ref=fig:GeFRONoiseVSTau], blue curve. From this measurement, the series white noise of the input transistor can be evaluated at 1 μs, obtaining a white noise density of 2.5 nV/[formula]. The noise at 10 μs is instead dominated by the 1/f contribution, together with the current noise from RF. After substracting the latter we are left with about 100 e- RMS, that is compatible with a value for the 1/f noise coefficient of Af  =   3·  10- 13 V2.

When the gain of the first stage is brought back to the original value with RT  =   50 Ω, the noise from the second stage must be considered. In our case gmRT≃ 1.7, so the noise from the termination resistor RT, of the resistor RQ and of the second stage amplifier should be considered at the input divided by gmRT and summed in quadrature to the noise contribution of the JFET in the evaluation of the overall series noise. The resistor RQ contributes with 0.8 nV/[formula] at the input, while RT contributes with 0.5 nV/[formula]. The white voltage noise from A2 referred to the input of Q1 is about 0.5 nV/[formula]. The current noise of A1 and A2, about 2 pA/[formula] in both cases, would also add to the series noise, but their contribution is negligible since the impedance RT seen at their inputs is small. The total white voltage noise at the input is then close to 1 nV/[formula], which at 10 μs with an input capacitance of 16 pF gives about 20 e- RMS. With a proper choice of the amplifier A2, its 1/f voltage and current noise can be neglected. The same is true for the current noise contribution from A1. Even if the gain of the first stage is only 1.7, the contribution of the second stage is then small compared to that of the first stage, as can be clearly seen from the green curve of figure [\ref=fig:GeFRONoiseVSTau], which is only slightly above the blue curve.

Finally, a 10 pF capacitor was added at the input to simulate the detector, obtaining the red curve in figure [\ref=fig:GeFRONoiseVSTau]. From the comparison of this curve with the others in the same figure, it is clearly evident that with a total input capacitance of 26 pF at 10 μs shaping time the equivalent noise charge of the shaped "slow" signal is dominated by the 1/f series noise of the input JFET, and is close to 160 e- RMS.

Energy spectra

The equivalent noise charge of 160 e- RMS, as results from the previous section, corresponds in Germanium to a FWHM resolution of about 1.1 keV FWHM. This can be verified in the spectrum shown in figure [\ref=fig:GeFROSpectrum], taken by facing the BEGe detector with a 228Th gamma source. The resolution of the pulser line set at 1370 keV is 1.37 keV FWHM, higher than expected, most likely due to some small disturbance injected through the high voltage power supply for the detector. The result is anyway remarkable. The resolution of the 583 keV and 2615 keV lines is 1.68 keV and 2.78 keV respectively, as expected from the Poisson statistics compensated by the Fano factor in Germanium, summed in quadrature with the electronic noise. The spectrum was taken over an hour with an overall event rate of about 800 counts per second.

The drift in the position of the 583 keV and 2615 keV lines versus time is shown in figure [\ref=fig:GeFRODrift]. The figure shows a continuous drift for both lines close to 4 ppm/h, likely related with the evaporation of liquid Nitrogen in the dewar housing the detector, which was not refilled in 44 hours, and a daily periodic trend, related with small temperature and humidity variations at the second stage. Curiously the daily variations for the two lines are not in phase. In any case, the measurement shows a very good overall stability in the position of the peaks, better than about 10 ppm/h over 44 hours of measurement.

Conclusions

The readout chain for semiconductor detectors presented in this paper provides a novel way to solve the trade-off between wide bandwidth, high energy resolution and the requirement of a minimal number of front-end components close to the detector. By acquiring both the "fast" and the "slow" outputs of the GeFRO all the relevant information from the detector signals can be retrieved. The design approach of the GeFRO circuit was described in detail, together with the criteria for component selection and the trade-offs involved.

The circuit was tested with a Canberra BEGe detector demonstrating a high timing resolution at the "fast" output, enough to clearly resolve the charge collection profiles in the detector for single-site and multi-site events. At the same time the spectra measured from the shaped "slow" output provided high resolution and very reliable operation, with a negligible drift in peak position over several hours. These features make the GeFRO circuit particularly suitable for rare event searches with semiconductor detectors, and in particular for the neutrinoless double beta decay search experiments GERDA and MAJORANA.

Here the calculations for the shape of the "fast" output will be carried out to a second order approximation in τD  /  τL. By approximating the loop gain ([\ref=eq:T(s)4]) at the second order in τD  /  τL, and without introducing normalization factors, we obtain

[formula]

By plugging this into ([\ref=eq:V1(s)2]), the "fast" signal takes the form

[formula]

Let us now consider the limit case which satisfies ([\ref=eq:tauL3]), that is τL  =  2τD. The above equation becomes

[formula]

The inverse Laplace transform gives

[formula]

The signal expressed by ([\ref=eq:V1(t)2]) reaches its maximum value at tM  =  τDπ  /  4, that is about 80 ns if τD  =   100 ns. Its amplitude at tM is

[formula]

Its 10% to 90% rise time is 46 ns, its 90% to 10% fall time is 152 ns. The signal in ([\ref=eq:V1(t)2]) has a small undershoot below ground, less than 5% of the total amplitude. Concerning the "slow" signal, from ([\ref=eq:V2(s)1]) and ([\ref=eq:T(s)5]) we find

[formula]

Again, the expression can be evaluated for the limit case τL  =  2τD, obtaining

[formula]

and by calculating the inverse Laplace transform one obtains

[formula]

Its amplitude is Q  /  CF, its 10% to 90% rise time is 152 ns and its 90% to 10% fall time is 2.2 τF. Some of the features of the "fast" and "slow" signals as given by equations ([\ref=eq:V1(t)2]) and ([\ref=eq:V2(t)2]) can be directly seen in figure [\ref=fig:GeFROScopePulser], which was taken for τL≃ 2τD.