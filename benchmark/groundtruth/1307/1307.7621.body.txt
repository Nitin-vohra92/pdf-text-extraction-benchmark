Lemma Corollary Proposition Observation Definition Conjecture Problem

Packing Steiner Trees

Jessica McDonald

Irene Pivotto

Introduction

Graphs in this paper are permitted to have multiple edges and loops (although loops will have no effect on our problem). A classic theorem due to Nash-Williams and Tutte gives a necessary and sufficient condition for a graph to have k pairwise edge-disjoint spanning trees. Before stating their theorem, let us introduce some notation. Given a graph or hypergraph H with F  ⊆  E(H) and P a partition of V(H), we let

[formula]

and [formula] with λinP(F)  =  |ΛinP(F)| and λoutP(F)  =  |ΛoutP(F)|.

A graph G  =  (V,E) has k pairwise edge disjoint spanning trees if and only if every partition P of V satisfies

[formula]

Let us remark that the "only if" direction of this theorem is obvious since each spanning tree must contain at least |P|  -  1 edges from ΛoutP(E). This result has a natural generalization to matroids and this is, in some sense, why we have such a nice characterization for it. One immediate and appealing corollary of this result is the following.

Every 2k-edge-connected graph contains k pairwise edge-disjoint spanning trees.

Let G  =  (V,E) be a graph and fix a subset T  ⊆  V of vertices. A T-Steiner tree is a subgraph of G which is a tree that spans T. In this paper we are interested in packing (i.e. finding edge disjoint) T-Steiner trees. If G is a graph with a nontrivial edge cut of size less than k, then G cannot contain k edge-disjoint spanning trees (since every spanning tree meets every nontrivial edge cut); However, such a graph may still contain k edge-disjoint T-Steiner trees, so long as this edge cut does not have vertices of T on either side. Assuming G is connected, we say that an edge-cut C separates T if there are at least two components of [formula] which contain vertices of T. The following conjecture is a natural generalization of Corollary [\ref=nwt_cor] to T-Steiner trees.

Let G be a connected graph and let T  ⊆  V(G). If every edge-cut of G separating T has size at least 2k then G contains k pairwise edge-disjoint T-Steiner trees.

In contrast to spanning trees, T-Steiner trees are not the bases of any matroid, and hence the problem of packing them efficiently appears to be considerably more difficult. Next we give a quick summary of partial results toward the above conjecture. All of these results will be discussed in greater detail in the following section, where we describe the arguments used in proving our new theorem.

In the original article where his conjecture is posed, Kriesell shows that his conjecture is true in the special case when every vertex in [formula] has even degree. Frank, Király and Kriesell [\cite=FKK] have proved that there exist k edge-disjoint T-Steiner trees whenever all edge cuts separating T have size ≥  3k and [formula] is independent. The first approximation to Kriesell's Conjecture without any added assumptions beyond edge-connectivity is due to Lau [\cite=La] who proved that the conjecture holds true if the "2k" term is replaced by "24k". More recently, West and Wu [\cite=WW] have made a significant improvement on this, showing that the conjecture still holds when the "2k" is replaced by ``6.5k". Our main theorem gives a further improvement on this bound.

Let G be a graph and let T  ⊆  V(G). If every edge-cut in G separating T has size ≥  5k + 4 then G contains k pairwise edge-disjoint T-Steiner trees.

For a pair of edges e = uv, and e'  =  uv' we split e and e' from u by deleting the e and e' and adding a new edge vv'. West and Wu also introduced the following structure which is closely related to T-Steiner trees: a T-connector is a subgraph of G which may be turned into a connected subgraph with vertex set T by splitting pairs of edges. This requirement means that, for example, a T-connector cannot have a vertex of odd degree unless it is in T. They make the following conjecture concerning the packing of T-connectors.

Let G be a connected graph and let T  ⊆  V(G). If every edge-cut of G separating T has size ≥  3k then G contains k pairwise edge-disjoint T-connectors.

To see that this conjecture (if true) is essentially tight, consider the extreme circumstance where G = (V,E) is a bipartite graph with bipartition [formula] and every vertex in [formula] has degree three. If |T|  =  n, then each T-connector must contain at least n - 1 vertices in [formula] which do not appear in any other connector. So in order for G to contain k edge-disjoint T-connectors we must have [formula]. In this case |E|  ≥  3k(n - 1) and the average degree of a vertex in T must be at least [formula].

West and Wu proved their conjecture holds if the "3k" term is replaced by 10k. We show the following improvement.

Let G be a graph and let T  ⊆  V(G). If every edge-cut in G separating T has size ≥  6k + 6 then G contains k pairwise edge-disjoint T-connectors.

-

Proof Discussion

The proof of our main theorem is rather involved, but most of the essential ingredients can be traced back to previous works on Kriesell's Conjecture. Accordingly, in this section we shall describe some of these earlier results, and indicate how we will utilize them. The first key tool in our proof is the following famous theorem of Mader (in fact Mader's theorem assumes the stronger condition that u is not a cut vertex, but the theorem stated here follows from this).

Let G be a graph, let u∈V(G), and assume that [formula] and that u is not incident with a cut-edge. Then there exists a pair of edges that can be split off from u so that for all [formula], the size of the smallest edge-cut separating x and x' does not change.

In [\cite=Kr1] Kriesell observes that Mader's Splitting Theorem can be used to verify his conjecture in the special case when every vertex in [formula] has even degree. Indeed, for such a graph, we may repeatedly apply Theorem [\ref=mader_split] to each vertex in [formula] until all such vertices have become isolated. Deleting these vertices from the graph results in a 2k-edge-connected graph with vertex set T which has k edge-disjoint spanning trees by Corollary [\ref=nwt_cor]. It is straightforward to verify that this yields k edge-disjoint T-Steiner trees in the original graph.

Frank, Király and Kriesell [\cite=FKK] proved that Kriesell's Conjecture holds under the stronger assumptions that every edge-cut separating T has size at least 3k and [formula] is an independent set. Since we will exploit these ideas further, let us sketch their argument. Suppose that we are in this setting, and observe that we may repeatedly apply Mader's Splitting Theorem to reduce to the case when all vertices in [formula] have degree 3. Since we may assume that a T-Steiner tree has no leaf vertex in [formula], at this point, each vertex in [formula] need only appear in one of the T-Steiner trees. To model this, we now form a hypergraph H with vertex set T from our graph G by replacing each [formula] by a single hyperedge on the three neighbours of v. Now to solve the original problem, it suffices to find k edge-disjoint spanning connected subhypergraphs of H. Although spanning connected subhypergraphs of H do not form a matroid, there is a matroid called the hypergraphic matroid which is of use. This is a matroid introduced by Lorea and defined on the edges of a hypergraph which we discuss in detail in the following section. Assuming a hypergraph is suitably rich, any basis of the hypergraphic matroid will be a spanning connected subhypergraph. Frank, Király and Kriesell show that this hypergraph H is suitably rich, and moreover it contains k disjoint bases, and this gives them the desired Steiner Tree packing.

Lau found a way to reduce the general problem down to one in which [formula] is independent, and thus take advantage of the hypergraphic matroid. To motivate his approach, suppose that we have a graph G  =  (V,E) with a set T  ⊆  V for which every edge-cut separating T has size at least f(k), in which we hope to prove the existence of k edge-disjoint T-Steiner trees. Let e∈E and assume that e is not incident with any vertex in T. If e is not in any edge-cut separating T of size f(k) then we may simply delete it. So, let us assume that δ(X) is an edge-cut of G separating T with e∈S. Since both X and its complement contain a point in T and an end of e, we have [formula]. So, a natural approach is to reduce this problem to smaller problems on the two graphs obtained from G by identifying either X or its complement to a single vertex which is placed in T (note that each such graph still has the property that any edge cut separating its vertices in T has size at least f(k)).

There are a number of difficulties with this approach. First off we must arrange that the behaviour of our two solutions agree on δ(X); second, we need to be sure that the resulting subgraphs we obtain are still connected. A natural way to arrange this is to prove a stronger result where the behaviour of the packing is predetermined at a particular vertex. So, let us now fix a distinguished vertex w∈T of degree f(k) and a function [formula] and consider the problem of finding k edge-disjoint connected subgraphs [formula] with the following properties:

Every Gi spans T

[formula] for every 1  ≤  i  ≤  k.

Gi  -  w remains connected for every 1  ≤  i  ≤  k.

These assumptions do allow us to naturally reduce any edge-cut δ(X) of size f(k) with [formula] as suggested. Unfortunately, there exist functions φ for which this problem has no solution, even when f(k) is large. One such case is indicated in Figure [\ref=figblanks].

In some sense, the difficulty in the example from Figure [\ref=figblanks] is the fact that too many of the precoloured edges have the same label. To get around this, Lau moves to yet another problem. He considers the same problem as before with G and w and φ, however he now attempts to pack k edge-disjoint connected subgraphs [formula] so that each spans T and so that every vertex in T has degree at least two in every Gi. This permits him the additional assumption that |φ- 1(i)|  ≥  2 for every 1  ≤  i  ≤  k, and Lau shows that for f(k)  =  26k this approach can be made to work.

Recently West and Wu extended these ideas further to prove that Kriesell's Conjecture holds true under the weaker assumption that all edge-cuts separating T have size at least 6.5k. In fact, these authors prove a somewhat stronger statement which involves a more complicated simultaneous packing. Their argument has some similarities to that of Lau in the sense that it features a special vertex at which the packing has been predetermined. However, instead of insisting that each Gi have minimum degree ≥  2, these authors try to pack the graphs Gi so that every vertex in T has degree at least k in the graph [formula] (i.e. the packing leaves k unused edges at each vertex in T). This allows them to assume that the function φ satisfies |φ- 1(0)|  ≥  k and this gets around the obstruction in Figure [\ref=figblanks].

Our approach will follow a very similar line to that of West and Wu to reduce to a problem concerning finding many disjoint bases in a certain hypergraphic matroid. The main new novelty in our argument is that we pass to the fractional setting to find a packing, and then use the following pretty theorem to round this fractional solution to an integral one (which avoids using too many edges at any vertex in T)

Let M be a matroid on E, let [formula] be a fractional basis, and let F be a collection of subsets of E so that every e∈E is contained in at most d members of F. Then there exists a basis B so that every F∈F satisfies

[formula]

The main advantage of passing to a fractional basis packing problem is that it permits us to take advantage of LP-duality (more precisely the Farkas Lemma), and this serves as the final ingredient in our proof.

Matroid Preliminaries

We shall require a couple of results concerning matroids. The main matroid of interest to us will be the hypergraphic matroid associated with a hypergraph. The essential properties of hypergraphic matroids we require appear already in Frank-Király-Kriesell [\cite=FKK], but we have a slightly different approach toward the proofs which we feel has its own merit.

For every set S we let 2S denote the collection of all subsets of S. A function [formula] is monotone increasing if f(X)  ≤  f(Y) whenever X  ⊆  Y  ⊆  S and is intersecting submodular if

[formula]

whenever X,Y  ⊆  S satisfy [formula]. Edmonds and Rota [\cite=ER] proved the following fundamental result stating that every function f with these two properties gives rise to a matroid on S.

Let [formula] be nonnegative with [formula], and assume f is monotone increasing and intersecting submodular. Then there is a matroid M on S whose independent sets are

[formula]

and has rank function r given by the rule

[formula]

Rado [\cite=Rado] proved a fundamental theorem which reveals how a bipartite graph with bipartition (X,Y) together with a matroid on Y induces the structure of a matroid on X. His result may be deduced in quite general form from that of Edmonds above. To do so, let [formula] with k  ≥  1 and define the set function [formula] by the rule f(S)  =   max {0,kr(N(S))  +  b}. Then f is monotone increasing and intersecting submodular, so it gives rise to a matroid on X by Theorem [\ref=int_sub] whose nonempty independent sets are all [formula] which satisfy

[formula]

We call this matroid the Rado matroid on X (though the reader should note that every matroid L may be obtained in this manner by taking both X and Y to be copies of E(L) and letting the graph be the matching where x  ~  y if x and y are copies of the same element in E(L)). The standard Rado matroid has k = 1 and b = 0 and these matroids are especially nice. Notably, transversal matroids are the standard Rado matroids where the matroid on Y is free (i.e. all sets are independent), and the bicircular matroid of a graph G = (V,E) is the transversal matroid coming from the associated bipartite graph with bipartition (E,V) (where ev is an edge if e is incident with v). Using this same bipartite graph with bipartition (E,V) associated with the graph G but taking b  =   - 1 gives us the usual cycle matroid of the graph G. More generally, if H  =  (V,F) is a hypergraph and we take the bipartite graph with bipartition (F,V) (where fv is an edge if v∈f) the free matroid on V and the parameters k = 1 and b =  - 1, we get the hypergraphic matroid of the hypergraph H, first discovered by Lorea [\cite=Lorea]. However, this matroid has an alternate representation as a standard Rado matroid. Namely, we define E to be the edge set of a complete graph on V, define the bipartite graph with bipartition (F,E) by the rule that each e∈F is adjacent to every edge of the form uv where u,v are contained in e, and use the parameters k = 1 and b = 0 with the standard cycle matroid of the graph (V,E) as the matroid on E. Indeed, this representation may be viewed as a halfway step between F and V by constructing a tripartite graph on [formula] with the natural adjacencies.

The alternate representation has some advantages for us. Perhaps the main advantage is that it gives us a representation of the hypergraphic matroid of H as a standard Rado matroid. For standard Rado matroids, Rado proved that a subset of X is independent if and only if it can be matched to an independent set in Y and this immediately yields the following result.

If H  =  (V,F) is a hypergraph and A  ⊆  F then A is independent in the hypergraphic matroid if and only if we can replace every e∈A with an edge uv where u,v∈e so that the resulting graph is a forest.

Next let us turn our attention to the rank function of a hypergraphic matroid on H  =  (V,E). Here it is convenient to work in the language of partitions. For every partition P of V we define the rank of P to be r(P)  =  |V|  -  |P|. The following result gives a nice form for the rank function of the hypergraphic matroid. This can be proved rather easily using either of the two Rado representations of this matroid. To deduce it from the representation as a standard Rado matroid on (F,E), note that for every A  ⊆  F we have r(N(A)) is equal to r(P) where P is the partition of V induced by the connected components of A. Since we have [formula], the next result follows from the rank formula in Theorem [\ref=int_sub].

In the hypergraphic matroid on a hypergraph H  =  (V,F) we have for every set A  ⊆  F that the rank of A is equal to the minimum over all partitions P of V of the function

[formula]

Another convenience of the present development is that matroid union is very easy to deal with as indicated by the following observation. For every matroid M we let kM denote the matroid union of k copies of M.

Let L be a Rado matroid associated with the bipartite graph on (X,Y), the matroid M on Y, and the parameters m,b. Then kL is the same Rado matroid as L except with the parameters km and kb in place of m and b.

Proof: Using the formula for matroid union yields that for every A  ⊆  E(M)

[formula]

[formula]

Accordingly, we obtain the following formula for the rank function in a union of k copies of a hypergraphic matroid.

In the union of k copies of the hypergraphic matroid on a hypergraph H  =  (V,F), we have for every set A  ⊆  F that the rank of A is equal to the minimum over all partitions P of V of the function

[formula]

There are two important polyhedra associated with a matroid and we shall require some basic properties of these as well. For any matroid M on E consider the following three linear constraints on vectors [formula].

0  ≤  x(e)  ≤  1 for every e∈E.

x(S)  ≤  r(S) for every S  ⊆  E.

x(E)  =  r(E).

Edmonds [\cite=Edmonds] proved that a vector [formula] satisfies (L1) and (L2) above if and only if x can be expressed as a convex combination of incidence vectors of independent sets, and we call this polyhedron I(M) the independent set polytope of M. It follows from this that x satisfies (L1), (L2), and (L3) if and only if x can be expressed as a convex combination of incidence vectors of bases, and we call this polyhedron B(M) the basis polytope of M. We call an element of B(M) a fractional basis of M. The key property we will require in the following sections is the following.

Let M be a hypergraphic matroid associated with a hypergraph on V and suppose that [formula] satisfies the following

0  ≤  x(e)  ≤  1 for every e∈E.

x(ΛinP(E))  ≤  kr(P) for every partition P of V.

x(E)  =  k(|V|  -  1).

Then kM has rank kr(M) and x is a fractional basis of kM.

Proof: Let A  ⊆  E and choose a partition P in accordance with Theorem [\ref=union_rank]. This gives us

[formula]

Therefore, x may be expressed as a convex combination of incidence vectors of independent sets. Since x(E)  =  k(|V|  -  1) and r(M)  ≤  |V| - 1 it follows that kM must have rank kr(M)  =  k(|V|  -  1) and x is a fractional basis of kM as desired.[formula]

We require just one additional result which will permit us to arrange a small number of edges as desired within a matroid union.

Let M be a matroid, let B be independent in kM, let D  ⊆  B and let [formula] be an injection. Then there exist pairwise disjoint sets [formula] satisfying

[formula].

Every Bi is independent in M.

μ- 1({i})  ⊆  Bi for 1  ≤  i  ≤  k.

Proof: Since B is independent in kM we may choose pairwise disjoint sets [formula] so that each Bi is independent in M and [formula]. We shall now show how to modify these sets so that they satisfy the last condition. If there exists 1  ≤  i  ≤  k with μ- 1({i}) not contained in Bi then we must have μ- 1({i})  =  {e} and e∈Bj for some j  ≠  i. If [formula] is independent in M then we make this set our new Bi and set [formula]. Otherwise, we may choose f∈Bi so that both [formula] and [formula] are independent in M and we define Bi and Bj respectively to be these new independent sets. It follows easily that this modification increases the number of indices 1  ≤  i  ≤  k with μ- 1({i})  ⊆  Bi so it will terminate with a solution.[formula]

Packing Steiner Trees

The goal of this section is to establish Theorem [\ref=steiner_thm]. In order to do so, we will prove the following stronger result which features a distinguished vertex whose incident edges have been precoloured. This lemma involves the function [formula] which we define as follows:

[formula]

Let G be a graph and let T  ⊆  V(G) satisfy |T|  ≥  2 and have the property that every edge cut separating T has size ≥  f(k). Let w∈T be a distinguished vertex with [formula] and let [formula] be onto and satisfy |φ- 1(0)|  ≥  k. Then there exist k edge-disjoint connected subgraphs [formula] that satisfy all of the following conditions:

Gi spans T for 1  ≤  i  ≤  k.

[formula] for 1  ≤  i  ≤  k.

w is not a cut vertex of Gi for 1  ≤  i  ≤  k.

Every v∈T satisfies [formula].

Lemma [\ref=steiner_lem] immediately implies Theorem [\ref=steiner_thm], as follows.

Proof of Theorem [\ref=steiner_thm]: We in fact prove the stronger result that the same conclusion holds under the assumption that all edge-cuts separating T have size at least f(k). We may assume that |T|  ≥  2 as otherwise the result holds trivially. By possibly deleting edges, we may assume that there exists an edge-cut D in G which separates T and has size f(k). Now, choose a function [formula] which is onto and satisfies |φ- 1(0)|  ≥  k. Let {X1,X2} be the vertex partition associated with D and form two new graphs as follows: form G1 from G by identifying X2 to a new vertex called x2 and form G2 from G by identifying X1 to a new vertex called x1. Now apply Lemma [\ref=steiner_lem] to the graph G1 with [formula], the distinguished vertex x2 and the function φ, to get k-edge-disjoint subgraphs [formula] of G1 satisfying (C1)-(C4) for the given parameters. Similarly, apply Lemma [\ref=steiner_lem] to G2 for [formula], the vertex x1 and the function φ to get k-edge-disjoint subgraphs [formula] of G2 satisfying (C1)-(C4) for the given parameters. Combine G1i and G2i in the obvious way to get a subgraph Gi of G, for all [formula]. By (C1) and (C3), and since φ is onto, we get that each such Gi is connected and spans T. Hence each such Gi contains a T-Steiner tree. [formula]

Note that for the purposes of the above proof, outcome (C4) and the assumption of φ- 1(0)  ≥  k in Lemma [\ref=steiner_lem] are extraneous. This idea of leaving at least k edges at each vertex of T which are not used in the Steiner trees will however be key in establishing Lemma [\ref=steiner_lem]. Our proof of Lemma [\ref=steiner_lem] will involve investigating a minimal counterexample, and we shall instantiate this here.

For the remainder of this section, assume that G together with T  ⊆  V(G), w∈T and φ is a counterexample to Lemma [\ref=steiner_lem] which is extreme in the following sense:

[formula] is minimum.

|V(G)|  +  |E(G)| is minimum (subject X1).

|φ- 1(0)| is minimum (subject to X2).

Our first goal will be to establish the following regularity and independence properties of the graph G.

The graph G satisfies the following properties:

|φ- 1(0)|  =  k.

Every [formula] has degree 3 and has |N(v)|  =  3.

Every v∈T has degree f(k).

[formula] is an independent set.

Proof: We shall establish the desired properties in a series of claims.

0. |φ- 1(0)|  =  k.

By assumption we must have |φ- 1(0)|  ≥  k. If this set were larger, then we could obtain a smaller counterexample (via (X3)) by choosing e∈δ(w) with φ(e) = 0 and instead setting φ(e)  =  1.

1. G is connected and has no cut-edge.

Suppose (for a contradiction) that G is disconnected. Then one component of G must contain all of T, and this component forms a smaller counterexample (via (X2)), giving us a contradiction. Now suppose (for a contradiction) that e∈E(G) is a cut-edge. Then one component of G - e must contain all of T, and it follows that e cannot be in any edge-cut of size f(k) which separates T. However, then the component of G - e containing T forms a smaller counterexample (via (X1) or (X2)), giving us a contradiction.

2. Every [formula] has degree 3.

Let [formula] and note that by (1) we must have [formula]. If [formula], then splitting off the two edges at v and suppressing v gives a smaller counterexample (via (X2)), so we must have [formula]. If [formula] then by applying Mader's Splitting Theorem we obtain a new graph G' which will again be a smaller counterexample (via (X2)). It follows that [formula] as desired.

3. Every [formula] has |N(v)|  =  3.

If this property were false, then by (2) there would be a (parallel) edge e incident with v which is not contained in any edge-cut separating T of size f(k). However, then G - e is a smaller counterexample (via (X1) or (X2)).

4. If D is an edge-cut separating T and |D|  =  f(k) then D  =  δ(v) for some v∈T.

Suppose (for a contradiction) that D partitions V(G) into two sets X1,X2 with |Xi|  ≥  2 for i = 1,2. We may assume without loss that w∈X1. We now form two new graphs, G1 and G2, exactly as described in the proof of Theorem [\ref=steiner_thm] above, and also define T1 and T2 as in this proof. We now apply induction to G1, T1, φ and distinguished vertex w; our induction is via (X1) or (X2). This application yields subgraphs [formula] of G1 satisfying (C1)-(C4) for the given parameters.

Now let the map [formula] be defined by the rule that [formula] for 1  ≤  i  ≤  k, and [formula]. Since x2∈T1 it must be that φ2 is onto and further (by (C4)) that |φ- 12(0)|  ≥  k. Now we apply induction to G2, T2, the distinguished vertex x1, and the map φ2; our induction is via (X1) or (X2). This application yields subgraphs [formula] of G2 satisfying (C1)-(C4) for the given parameters. Combine G1i and G2i in the obvious way to get a subgraph Gi of G, for all [formula]. These subgraphs now satisfy (C1)-(C4) for the original parameters of our problem, contradicting the fact that G is a counterexample to Lemma [\ref=steiner_lem].

5. Every v∈T has degree f(k).

Suppose (for a contradiction) that v∈T satisfies [formula] and note that v  ≠  w by assumption. Now apply Mader's Splitting Theorem to choose two edges uv and u'v incident with v so that the graph G' obtained from G by splitting these edges at v preserves edge-connectivity between pairs of vertices not including v. Then, we let G'' be the graph obtained from G  -  {uv,u'v} by adding a new vertex x and adding the edges vx,ux,u'x. We will show that every edge-cut in G'' separating T has size ≥  f(k), which implies that G'' (together with T,w,φ) is a smaller counterexample (via (X1)), thus giving a contradiction. To this end, first note that every edge-cut of G' which separates [formula] has size ≥  f(k), so this property also holds for the graph G''. By (3) and the fact that G is a counterexample we know that |T|  ≥  3. By (4) we know that in the original graph G, every edge-cut which separates {v} from [formula] must have size >  f(k). Hence, in G', every edge-cut which separates {v} from [formula] will have size ≥  f(k), and this property also holds for G''. This yields the desired contradiction.

6. [formula] is an independent set.

If e is an edge with both ends in [formula] then it follows from (4) that e is not in any edge-cut separating T with size f(k). But then the graph G - e (together with T, w, and φ) is a smaller counterexample (via (X2)).[formula]

The function φ has specified the behaviour of any solution at the distinguished vertex w, and we next introduce some notation to help us to deal with the many possibilities for this map. Define [formula] to be the set of edges in φ- 1(0) which have both ends in T and let [formula]. Since φ is onto, we may choose disjoint subsets W*t and W*n of [formula] so that φ maps [formula] bijectively to [formula] and so that every edge in W*t has both ends in T and every edge in W*n has one end in [formula]. Let [formula] denote the set of edges incident with w and another vertex in T which are not contained in [formula] and similarly, let [formula] denote the set of edges incident with w and with a vertex in [formula] which are not contained in [formula].

Next we construct three sets of auxiliary edges [formula], D*, and [formula] which will play somewhat different roles in our proof. For each choice of [formula] we construct [formula] from [formula] as follows. For each edge [formula] let v',v'' denote the neighbours of v other than w and add a new edge with ends v' and v'' to [formula]. Note that this construction yields a natural correspondence between [formula] and [formula]. See Figure [\ref=figSpecialVertex]. Note that in this figure, and in later figures, we use squares to denote vertices in T, and circles to denote vertices not in T.

Our next step will be to define an extension φ' of our precolouring φ, by defining φ'(e) = φ(e) for all e∈δ(w), but also defining φ' on all edges of δ(v) where v is a vertex for which [formula]. First, for every wv∈W*n with N(v)  =  {w,v',v''} we define φ'(vv')  =  φ'(vv'')  =  φ(wv). In order to extend our precolouring in the case when [formula] we need to be a little careful. Define [formula] to be the graph [formula] and then choose an orientation of [formula] so that every vertex v satisfies

[formula]

(such an orientation may be found greedily as follows: repeatedly choose a cycle of unoriented edges and orient them cyclicly until the remaining unoriented edges form a forest, and then repeatedly orienting leaf edges of the forest of unoriented edges in the direction of the leaf vertex). Now, for each edge [formula] let v',v'' be the neighbours of v other than w and consider the edge [formula]. If this edge is oriented from v' to v'' then we define

[formula]

In proving Lemma [\ref=steiner_lem], we will reduce our original problem to a new one on a smaller graph which is obtained from the original by removing the vertex w and edges precoloured by φ' and making some further modifications. In preparation for this, we now introduce a couple functions which will keep track of the number of edges in the domain of φ' which are incident with a given vertex. For every [formula] we define the following

[formula]

So, [formula] is the number of edges that are precoloured with a nonzero value and are incident with v, while u1(v) + u2(v) is the number of edges which are precoloured 0 which are incident with v. Note that [formula] and [formula], so by our choice of orientation of [formula], i.e., by ([\ref=orientation1]), we have

[formula]

The following two lemmas also provide useful inequalities involving p1(v) and p2(v).

Every v∈T' satisfies [formula].

Proof: First observe that if |T|  =  2 then (P2) (in Lemma [\ref=minimal_counter]) implies that V(G)  =  T. However, it is easy to check that there is no counterexample to Lemma [\ref=steiner_lem] with |V(G)|  =  2. It follows that we must have |T|  ≥  3. Let v∈T', and consider the cut in G induced by w,v, and all common neighbours v' of w and v such that [formula] (there are p2(v) + u2(v) of these). Since |T|  ≥  3, this cut must have size at least f(k). There are p1(v) + u1(v) edges between w and v, and both these vertices have degree f(k), so the induced cut has size

[formula]

Rearranging, and applying ([\ref=p2u]), we get

[formula]

which implies that [formula].[formula]

Every v∈T' satisfies p1(v)  ≤  k - 1.

Proof: By the same argument at the start of Lemma [\ref=p1plusp2] we must have |T|  ≥  3.

Now, we suppose (for a contradiction) that p1(v)  ≥  k. So we may choose [formula] so that |A1|  =  k. Set [formula].

Let Ĝ be the graph obtained from G by applying Mader's Splitting Theorem repeatedly to split the vertex v completely (this is possible since deg G(v) = f(k) by (P3), and f(k) is always even). If two edges in [formula] were split off together, the resulting graph would have a loop at w and this is impossible since there exists a vertex [formula] (as |T|  ≥  3), deg G(w) = f(k), and Mader's Splitting Theorem guarantees that no edge cut between w and u has size less than f(k).

For i = 1,2 we let Âi denote the set of edges in Ĝ which were formed by a split at v involving an edge in Ai (by above we know that |Âi| = |Ai|). We now construct a function [formula] as follows. We let (e)  =  φ(e) for every edge [formula], we let (e)  =  0 for every e∈Â2 and we choose values for (e) for those e∈Â1 so that [formula]. We may now apply induction (via (X1)) to the graph Ĝ, the vertex subset [formula], the distinguished vertex w, and the map [formula]. This yields a family of edge-disjoint connected subgraphs [formula] of Ĝ satisfying (C1)-(C4) for the given parameters.

We shall now start from Ĝ and form G by reversing our splitting operations one at a time, and modify the graphs Ĝi along the way to obtain a solution [formula] for G. We begin by adding v back as an isolated vertex to Ĝ, and setting Gi  =  Ĝi for all i.

For every edge e∈A1 we note that e was split off with some other edge f to form an edge ê∈Â1 (see Figure [\ref=figBA1Ghat]). We modify Ĝ by deleting the edge ê and adding back the edges e and f. By assumption ê is contained in some Ĝj and we modify Gj by deleting ê and adding back f. Finally, we add the edge e to the graph Gi for i  =  φ(e).

At this point in the process, the vertex v has degree 2|A1| = 2k in our modified Ĝ and our choices have guaranteed that, for every j, Gj spans [formula] and w is not a cut vertex of Gj. However, we have not yet arranged for any edges incident with v to be not contained in [formula], and we need to additionally satisfy (C2) (namely on the edges of A2) and get rid of any edges in the Gi that are not in G. Fortunately, we can fix all this with our remaining operations.

For every edge e∈A2, note that e was split off with some other edge f to form an edge ê∈Â2 (see Figure [\ref=figBA1Ghat]). By construction ê will not be contained in any Ĝj and we now modify Ĝ by deleting ê, and adding back the edges e and f. We add the edge e to the graph Ĝi for φ(e)  =  i. We do not add the edge f to any Ĝi. With this choice condition (C2) is satisfied. Moreover, we also have both conditions (C1) and (C3), and we have ensured that there are at least |A2| unused edges at v. For each of our remaining split reversals, we do not use at least one of the two edges which arise from each reversal. This way, in the end there will be at least (f(k) - 2k) / 2  ≥  k edges incident to v not in any of [formula]. Our task is to do this while maintaining the connectivity of each Gi, as well as condition (C3).

Every remaining edge ê which is in our modified Ĝ but not G was formed by splitting off a pair of edges e,e' incident with v. We reverse this operation by deleting ê and adding back the edges e and e' (see Figure [\ref=figBA1Ghat]). If ê was not contained in any of the Ĝi graphs then we do not modify the Gi. However, if ê was contained in Ĝj then we claim that we may modify Gj by deleting the edge ê and adding back one of e or e' (say e) so that the new [formula] is still connected and w is not a cut vertex of the new Gj. If our claim fails, then either [formula] is disconnected or w is a cut vertex of [formula] (and these two cases cannot happen simultaneously). In the first case, let H1 and H2 be the two components of [formula] and, for i = 1,2, let xi be the end of ê in Hi. Since Gj spans v, we may assume that v∈V(H1). Then deleting ê from Gj and adding back the edge vx2 yields a new graph Gj which is connected, as desired. Now suppose that w is a cut vertex of [formula]. Let H1 and H2 be the two subgraphs of [formula] such that [formula] and [formula]. Again, for i = 1,2, let xi be the end of ê in Hi and we may assume that v∈V(H1). Then deleting ê from Gj and adding back the edge vx2 yields a new graph Gj of which w is not a cut vertex, as desired.

When this process terminates, we have arranged that Ĝ  =  G and that the graphs [formula] give a solution to the original problem. This contradicts the assumption that G is a counterexample, and thus completes the proof. [formula]

Now we shall, as promised, reduce our original problem for Lemma [\ref=steiner_lem] to a new one on a smaller graph. To this end, we define the graph G' to be the graph obtained from G by deleting w and every neighbour of w contained in [formula] and then adding the edge set [formula] (see Figure [\ref=figSpecialVertex]). The edges [formula] shall, in a way, represent the edges of [formula] that we removed. While we won't add any edges to G' to represent the other edges we deleted, we keep track of those from W*n by defining a set D*i for every 1  ≤  i  ≤  k as follows. If there exists wv∈W*n with φ(wv)  =  i then we let D*i  =  {v'v''} where v'v''∈D* is the edge corresponding to wv (so N(v)  =  {w,v',v''}) and otherwise we set [formula]. So unless D* is empty, the collection of all nonempty sets D*i forms a partition of D*. Further, in G', we will use the values p1(v),p2(v),u1(v),u2(v) as defined above to keep track of the number of deleted edges coloured [formula] and coloured 0, respectively, at each vertex v∈T'. In terms of the formulation of our new problem, a key quantity to keep track of, for each v∈T', will be

[formula]

Note that by Lemma [\ref=p1plusp2], this quantity will always be positive. Its significance is made apparent in our reformulation below (and the reason for including the - 2 will be made apparent in our main proof).

There do not exist edge-disjoint subgraphs [formula] of G' satisfying all of the following conditions:

Gi' spans T' for every 1  ≤  i  ≤  k.

[formula] is connected for every 1  ≤  i  ≤  k.

Every v∈T' satisfies [formula].

Proof: Suppose (for a contradiction) that there exist such graphs [formula]. Then we modify each Gi' to obtain a subgraph Gi of G as follows. For every edge [formula] let wv be the corresponding edge of [formula] and add the vertex v and the edges vv' and vv'' to Gi. Then, add all edges in φ'- 1(i) together with their endpoints (recall our definition of φ' from earlier). The resulting graphs [formula] clearly satisfy (C1) and (C2). They satisfy (C3) because any edge in [formula] is replaced by a 2-path of colour i in Gi, and because we have (D2) and any edge in D*i is replaced by a 2-path of colour i in Gi (by definition of φ'). Condition (C4) holds because of (D3) and the fact that φ' colours p1(v)  +  p2(v) edges incident to any given v∈T'. [formula]

Next we will introduce some hypergraphs so as to take advantage of the matroidal properties of spanning hypertrees. To do this, we define H to be the hypergraph obtained from G by replacing each vertex [formula] with an edge of size 3 containing N(v). Similarly, we let H' denote the hypergraph obtained from G' by replacing each [formula] with an edge of size 3 containing N(v). For simplicity of notation, let E = E(H) and E' = E(H'). It follows from the connectivity properties of G that the hypergraph H will be f(k)-edge-connected, so H' will not have too many small edge-cuts.

If P' is a partition of T' then

[formula]

and if |P'|  =  2 this may be improved by [formula] to

[formula]

Proof: Extend P' to a partition P of T by adding {w} as a block. Then P is a partition of V(H) and since H is f(k)-edge-connected, we have that every B∈P satisfies dH(B) = |δH(B)|  ≥  f(k). Let W* be the set of hyperedges in H associated with an edge in [formula] and similarly let [formula] be the set of hyperedges in H associated with an edge in [formula]. For i = 2,3 let W*i [formula] denote the set of hyperedges in W* [formula] that have ends in exactly i different blocks of P. Similarly, for i = 2,3, we define Ei to be the set of all edges not in [formula] which have ends in exactly i different blocks of P. Now every edge in [formula] corresponds to an edge in [formula] which has ends in distinct blocks of P and similarly every edge in W*3 corresponds to an edge in ΛoutP'(D*). We now have

[formula]

Note in the second line that [formula] counts hyperedges with ends in 3 blocks of P three times, and those with ends in 2 blocks of P only twice. Now, using |W*2| + |W*3| = k and [formula] (by (P1)), this gives us

[formula]

as desired. If |P'|  =  2 then we set F to be the set of edges in H which do not contain w but do intersect both blocks of P' (note that F  ⊆  E2, but E2 could contain edges coloured by φ incident to w.) We now repeat the same calculation.

[formula]

Rearranging the final inequality we get that [formula] as desired. [formula]

With this, we are finally ready to prove Lemma [\ref=steiner_lem].

Proof of Lemma [\ref=steiner_lem]: We will establish this lemma by contradicting Lemma [\ref=prime], thus contradicting the assumption that G is a counterexample. As suggested earlier, our proof will make use of hypergraphic matroids. We have already defined the hypergraph H' and E'  =  E(H'). We further define H'' to be the hypergraph obtained from H' by adding the edges D*, and set E''  =  E(H''). Finally, we let M be the hypergraphic matroid on H'', and let r be the rank function of M.

We claim that there cannot exist a vector [formula] satisfying all of the following properties:

x(e)  ≤  1 for every e∈E'

x(ΛinP(E'))  ≤  kr(P)  -  λinP(D*) for every partition P of T'

- x(E')  ≤    -  kr(M)  +  |D*|

[formula] for every v∈T'.

To establish the claim, suppose, for a contradiction, that such an x does exist. Define the vector [formula] by the rule that x̄(e)  =  x(e) for every e∈E' and x̄(e)  =  1 for every e∈D*. For every partition P of T',

[formula]

When P is the partition with only one block, the second condition becomes

[formula]

This, together with the third condition, gives

[formula]

Therefore Lemma [\ref=partition_rank] tells us that x̄ is a fractional basis of kM and kM has rank k  r(M).

Since x̄(e)  =  1 for every e∈D*, the vector x is a fractional basis of the matroid L  =  (kM) / D* on E'. We apply Theorem [\ref=kls] to the matroid L, the vector x, and the family of subsets of E' given by {δH'(v)|v∈T'}. Since every edge is contained in at most three of these sets, the theorem gives us a basis B of L for which

[formula]

holds for every v∈T'. Since [formula] is a basis of kM and |D*|  ≤  k, Lemma [\ref=adjust_union] says that we may choose a partition of [formula] into bases [formula] of M so that D*i  ⊆  Bi for every 1  ≤  i  ≤  k. Now, for each 1  ≤  i  ≤  k we let Gi' denote the subgraph of G' which is constructed as follows. We begin with Gi' containing the vertex set T' and no edges. Then we add to Gi' all edges of size 2 in [formula], and then for every edge of size 3 in [formula] containing {v,v',v''} this edge corresponds to a vertex [formula] in G' and we add to G'i the vertex x and the edges xv,xv',xv''. Since Bi is a basis of L, Gi' is connected and spans T'. Therefore each Gi' satisfies (D1), (D2), and (D3). Thus, these graphs contradict Lemma [\ref=prime], and our claim has been established.

Since we know that x cannot exist, Farkas' Lemma tells us that there must exist nonnegative {ye}e∈E' and yG and {yv}v∈T' and {yP} for every partition P of T', that satisfy the following properties

[formula]

[formula]

We claim that we may assume yG = 1. To this end, it suffices to show that yG > 0, as in this case we may scale y by a positive constant. We have already noted that cost(v) is positive for all v∈T'. Since λinP(D*)  ≤  |D*|  ≤  k for every partition, we also know that the coefficient of yP in ([\ref=eqa1]) is also nonnegative. Since |D*|  ≤  k and |T'|  ≥  2 (by the same argument that appears at the start of Lemma [\ref=p1plusp2]), we must indeed have yG > 0, and hence can assume yG = 1.

Now, over all vectors y which satisfy equations ([\ref=eqa1]), ([\ref=eqb1]), and yG = 1 we may assume that y is extreme in the following sense

[formula] is minimum.

[formula] is maximum (subject to T1).

We'll show that this implies that if P1 and P2 are partitions with yP1,yP2  ≥  ε  >  0 then it must be that they are nested, i.e., either P1  ≤  P2 or P2  ≤  P1. Suppose not. Then consider modifying our vector y by decreasing yP1 and yP2 by ε and then increasing [formula] and [formula] by ε. It follows immediately that this new y still satisfies equation ([\ref=eqb1]). Similarly, note that

[formula]

so the effect of modifying y increases the right-hand side of ([\ref=eqa1]) by

[formula]

and by submodularity of the rank function r, this is nonpositive. This operation will strictly improve y with respect to our first optimization criteria unless [formula]. However, in this case the second induction criteria is affected by an increase of

[formula]

Therefore, we conclude that the only partitions P with yP  >  0 are nested.

Next we claim we may assume that for the trivial partition {T'}, y{T'}  =  0. To see this, suppose that y{T'}  =  δ  >  0 and consider modifying y by decreasing both yG and y{T'} by δ. Then the modified y is still nonnegative and still satisfies ([\ref=eqb1]). Moreover, it also still satisfies ([\ref=eqa1]) because k  r({T'})  -  λin{T'}(D*) = k(|T'| - 1)  -  |D*|. Hence (T1) implies that y{T'}  =  0.

Since the trivial partition {T'} has zero weight, we may assume that there are partitions [formula] so that every partition [formula] has yQ  =  0 and so that P0 is the discrete partition and [formula] is a partition of size 2. For convenience of notation, we now set yi  =  yPi, Λouti(F)  =  ΛoutPi(F), Λini(F)  =  ΛinPi(F) and assign λouti and λini similarly for every [formula] and every subset of edges F. With this, we now restate equation ([\ref=eqb1]) as follows:

[formula]

If [formula] then let j be the minimum over all [formula] for which yj  >  0. Then, in equation [\ref=eqb2] every edge in Λinj(E') receives a total weight of at least [formula] from the partitions so none of these edges are tight with respect to this constraint, and then by decreasing yj by [formula] we improve the vector y with respect to (T1). Therefore, we must have [formula]. Now, the term y0 associated with the discrete partition has no effect on any of our equations. Therefore, we may choose y0 so that [formula]. This normalization is handy and we use it next to rewrite the following terms:

[formula]

Taking advantage of the above identities we may now rewrite equation ([\ref=eqa1]) as follows

[formula]

In the remainder of our proof we will use ([\ref=eqa2]) and ([\ref=eqb2]), along with some previous results, to achieve our desired contradiction. In the following calculation, the first inequality is obtained by summing ([\ref=eqb2]) over all edges, the second inequality uses Lemma [\ref=edge_count] (including the special case that [formula]), and the final inequality uses equation ([\ref=eqa2]):

[formula]

Rearranging brings us to the following inequality

[formula]

In the next calculation we consider any v∈T'. We use the identity (implied by (P3)) [formula], where u(v) = u1(v) + u2(v), the inequalities p2(v)  ≤  u2(v)  +  1 (equation ([\ref=p2u])), 5k + 3  ≤  f(k)  ≤  5k + 4 and p1(v)  ≤  k - 1 (Lemma [\ref=buzzer_beater]). Moreover, we use the fact that 6k - f(k)  ≥  0 for k  ≥  3 (our result is implied by the result of West and Wu [\cite=WW] for k  ≤  2).

[formula]

Combining this with ([\ref=eqfk2]) gives us the following:

[formula]

Setting [formula] it follows from ([\ref=fk2k]) that α  >  0. Furthermore, every edge [formula] must satisfy ye  ≥  α by ([\ref=eqb2]), since this edge is outer with respect to every partition Pi and [formula]. We are now able to derive a contradiction based on the value of [formula]. First suppose that [formula]. In this case ([\ref=fk2k]) gives us the following contradiction (here we have applied Lemma [\ref=edge_count] for the last inequality).

[formula]

It follows that [formula]. Now, every edge in [formula] must satisfy ye  ≥  β by ([\ref=eqb2]), since this edge receives a total contribution of at most 1 - α from the vertices and [formula] from the partitions. Hence ([\ref=fk2k]) gives us

[formula]

Splitting the left hand side into (f(k)  -  2k)(α  -  β)  +  (f(k)  -  2k)β and then rearranging gives:

[formula]

As in the previous case the term above with coefficient α  -  β must be ≥  0 by Lemma [\ref=edge_count]. Using the same lemma, we find that

[formula]

and since the coefficient of β in ([\ref=alphabeta]) must be negative we have

[formula]

and this final contradiction completes the proof. [formula]

Packing Connectors

The proof of Theorem [\ref=connector_thm] is very similar to that of Theorem [\ref=steiner_thm] so we shall not give this proof in full detail, but rather we step through the argument referring heavily to the previous section. Our main lemma will now involve the function g(k) = 6k + 6.

Let G be a graph and let T  ⊆  V(G) satisfy |T|  ≥  2 and have the property that every edge cut separating T has size ≥  g(k). Let w∈T be a distinguished vertex with [formula] and let [formula] be onto and satisfy |μ- 1(0)|  ≥  2k. Then there exist k edge-disjoint subgraphs [formula] which satisfy the following conditions:

Gi is a T-connector for 1  ≤  i  ≤  k.

[formula] for 1  ≤  i  ≤  k.

w is not a cut vertex of Gi for 1  ≤  i  ≤  k.

Every v∈T satisfies [formula].

The proof of Theorem [\ref=connector_thm] follows from Lemma [\ref=connector_lem] just as Theorem [\ref=steiner_thm] follows from Lemma [\ref=steiner_lem], and we therefore omit these details. To prove Lemma [\ref=connector_lem] we assume that G together with T, w and μ is a counterexample which is extreme in the following sense.

[formula] is minimum.

|V(G)|  +  |E(G)| is minimum (subject to Y1).

|μ- 1(0)| is minimum (subject to Y1 and Y2).

By arguments analogous to those in Lemma [\ref=minimal_counter] we have that G satisfies the following.

The graph G satisfies the following properties:

|μ- 1(0)|  =  2k.

Every [formula] has degree 3 and has |N(v)|  =  3.

Every v∈T has degree g(k).

[formula] is an independent set.

Condition (Q2) implies that our connectors will be connected subgraphs of G which span T and have the property that every vertex in [formula] has degree 0 or 2. The fact that we are not allowed to use all three edges incident with a vertex in [formula] is the main difference from dealing with Steiner trees. In particular now we will not have a set W* as in Section 3. However as in the previous case, we define [formula] to be the set of edges in μ- 1(0) with both ends in T and let [formula]. We set [formula] to be the set of edges in [formula] with both ends in T and set [formula]. We again construct two sets of auxiliary edges [formula] and [formula]. For each [formula] we construct [formula] from [formula] as follows: for each edge [formula] we let v',v'' denote the neighbours of v other than w and we add a new edge with ends v' and v'' to [formula]. As before this construction yields a natural correspondence between [formula] and [formula]. We again define an extension μ' of our precolouring. We define μ'(e) = μ(e) for all e∈δ(w) and also define μ' on all edges of δ(v) where v is a vertex for which [formula]. We define [formula] to be the graph [formula] and then choose an orientation of [formula] so that every vertex v satisfies

[formula]

Now, for each edge [formula] let v',v'' be the neighbours of v other than w and consider the edge [formula]. If this edge is oriented from v' to v'' then we define

[formula]

This choice for the extended precolouring has the property that every vertex in [formula] that is adjacent to w has either no edges with a non-zero a colour or exactly two edges precoloured with the same colour. Therefore the precolouring will not force us to use three edges incident to the same vertex in [formula] in a connector.

For every [formula] we define the following

[formula]

So, [formula] is the number of edges that are precoloured with a nonzero value and are incident with v, while u1(v) + u2(v) is the number of edges which are precoloured 0 which are incident with v. Note that [formula] and [formula], so by our choice of orientation of [formula], i.e., by ([\ref=orientation2]), we have

[formula]

The following two lemmas also provide useful inequalities involving p1(v) and p2(v) and are the analogous of Lemma [\ref=p1plusp2] and Lemma [\ref=buzzer_beater] for connectors (where we replace f(k) with g(k) = 6k + 6 in Lemma [\ref=p1plusp2conn]). The proofs are almost identical to those of Lemma [\ref=p1plusp2] and [\ref=buzzer_beater], so we don't rewrite them here. The only thing to notice for the proof of Lemma [\ref=buzzer_beaterconn] is that proceeding as in the proof of Lemma [\ref=buzzer_beater] we may create graphs [formula] with vertices in [formula] of degree one. If Gi has a vertex [formula] of degree one, then we remove u and the edge of Gi incident with u to obtain a connector (by (E3) this edge was not precoloured).

Every v∈T' satisfies p1(v) + p2(v)  ≤  3k + 3.

Every v∈T' satisfies p1(v)  ≤  k - 1.

We shall again reduce our original problem for Lemma [\ref=connector_lem] to a new one on a smaller graph. To this end, we define the graph G' to be the graph obtained from G by deleting w and every neighbour of w contained in [formula] and then adding the edge set [formula]. In terms of the formulation of our new problem, a key quantity to keep track of, for each v∈T', will be

[formula]

Note that by Lemma [\ref=p1plusp2conn], this quantity will always be positive. The next result is the analogous of Lemma [\ref=prime] for connectors. We omit the proof, as it is analogous to that of Lemma [\ref=prime] (with the omission of edges in D*).

There do not exist edge-disjoint subgraphs [formula] of G' satisfying all of the following conditions:

Gi' spans T' for every 1  ≤  i  ≤  k.

Gi' is connected for every 1  ≤  i  ≤  k.

Every [formula] has degree 0 or 2 in Gi', for every 1  ≤  i  ≤  k.

Every v∈T' satisfies [formula].

As in the Steiner tree case, we define H to be the hypergraph obtained from G by replacing each vertex [formula] with an edge of size 3 containing N(v). Similarly, we let H' denote the hypergraph obtained from G' by replacing each [formula] with an edge of size 3 containing N(v). For simplicity of notation, let E = E(H) and E' = E(H'). We set the quantity [formula].

If P' is a partition of T' then

[formula]

and if |P'|  =  2 this may be improved by [formula] to

[formula]

Proof: Extend P' to a partition P of T by adding {w} as a block. Then P is a partition of V(H) and since H is g(k)-edge-connected, we have that every B∈P satisfies dH(B) = |δH(B)|  ≥  g(k). Let [formula] be the set of hyperedges in H associated with an edge in [formula] (so [formula] by (Q1)). For i = 2,3 let [formula] denote the set of hyperedges in [formula] that have ends in exactly i different blocks of P. Similarly, for i = 2,3, we define Ei to be the set of all edges not in [formula] which have ends in exactly i different blocks of P. In particular, [formula] and [formula], so |E2|  ≥  p1. We now have

[formula]

Note in the second line that [formula] counts hyperedges with ends in 3 blocks of P three times, and those with ends in 2 blocks of P only twice. Now, using [formula] (by (Q1)) we obtain the desired inequality.

If |P'|  =  2 then we set F to be the set of edges in H which do not contain w but do intersect both blocks of P'. Note that [formula] so [formula]. We now repeat the same calculation.

[formula]

Rearranging the final inequality we get the desired result. [formula]

With this, we are finally ready to prove Lemma [\ref=connector_lem].

Proof of Lemma [\ref=connector_lem]: We will establish this lemma by contradicting Lemma [\ref=primeconn], thus contradicting the assumption that G is a counterexample. We let M be the hypergraphic matroid on H', and let r be the rank function of M.

We claim that there cannot exist a vector [formula] satisfying all of the following properties:

x(e)  ≤  1 for every e∈E'

x(ΛinP(E'))  ≤  kr(P) for every partition P of T'

- x(E')  ≤    -  kr(M)

[formula] for every v∈T'.

To establish the claim, suppose, for a contradiction, that such an x does exist. Lemma [\ref=partition_rank] tells us that x is a fractional basis of kM and kM has rank k  r(M). We apply Theorem [\ref=kls] to the matroid kM, the vector x, and the family of subsets of E' given by {δH'(v)|v∈T'}. Since every edge is contained in at most three of these sets, the theorem gives us a basis B of kM for which

[formula]

holds for every v∈T'. Since B is a basis of kM we may choose a partition of B into bases [formula] of M. Fix [formula]. By Theorem [\ref=thm22] we may replace every e∈Bi with an edge uv, where u,v∈e, so that the resulting graph Fi is a forest. Since |Bi| = r(M) = |T'| - 1, Fi is in fact a tree spanning T'. Now partition Bi into B2i and B3i, where Bji is the set of hyperedges in Bi of size j. Then B2i  ⊆  E(Fi) and every e∈B3i corresponds to an edge in Fi. Recall that e = {u1,u2,u3}∈B3i corresponds to a vertex [formula] with NG'(v) = {u1,u2,u3}. We construct a T'-connector Gi from Bi as follows. Start with Gi' = (T',B2i). For every e = {u1,u2,u3}∈B3i, add to Gi' the vertex v and the edges u1v and u2v, where u1u2 is the edge in Fi corresponding to e, and v is the vertex in [formula] with NG'(v) = {u1,u2,u3}. Since Fi is a tree spanning T', Gi' is connected and spans T'. Moreover every vertex in [formula] has degree 0 (if NG'(v)∉Bi) or 2 (if NG'(v)∈Bi) in Gi'. Therefore each Gi' satisfies (F1), (F2), (F3) and (F4). Thus, these graphs contradict Lemma [\ref=primeconn], and our claim has been established.

Since we know that x cannot exist, Farkas' Lemma tells us that there must exist nonnegative {ye}e∈E' and yG and {yv}v∈T' and {yP} for every partition P of T', that satisfy the following properties

[formula]

[formula]

As in the Steiner tree case, we may assume that for the trivial partition {T'}, y{T'}  =  0, that yG = 1 and that the only partitions P with yP  >  0 are nested. Since the trivial partition {T'} has zero weight, we may assume that there are partitions [formula] so that every partition [formula] has yQ  =  0 and so that P0 is the discrete partition and [formula] is a partition of size 2. For convenience of notation, we now set yi  =  yPi, Λouti(F)  =  ΛoutPi(F), Λini(F)  =  ΛinPi(F) and assign λouti and λini similarly for every [formula] and every subset of edges F. With this, we now restate equation ([\ref=eqb1conn]) as follows:

[formula]

As in Section 3, we may assume that [formula]. We use this normalization next to rewrite the following term:

[formula]

Taking advantage of this identity we may now rewrite equation ([\ref=eqa1conn]) as follows

[formula]

In the remainder of our proof we will use ([\ref=eqa2conn]) and ([\ref=eqb2conn]), along with some previous results, to achieve our desired contradiction. In the following calculation, the first inequality is obtained by summing ([\ref=eqb2conn]) over all edges, the second inequality uses Lemma [\ref=edge_countconn] (including the special case that [formula]), and the final inequality uses equation ([\ref=eqa2conn]):

[formula]

Rearranging we obtain

[formula]

Equation ([\ref=eqb2conn]) implies that yv never needs to be larger than 1, therefore we may assume that yv  ≤  1 for every v∈T' and [formula]. We use this fact for the first inequality in the next calculation, together with the definition of cost'(v) and the identity (implied by (Q3)) [formula]. For the other inequalities we use, in this order, the definition of g(k), and the inequalities p2(v)  -  u2(v)  ≤  1 (equation ([\ref=p2uconn])), p1(v) + p2(v)  ≤  3k + 3 (Lemma [\ref=p1plusp2conn]) and p1(v)  ≤  k - 1 (Lemma [\ref=buzzer_beaterconn]).

[formula]

Combining this with ([\ref=eqfk2conn]) gives us the following:

[formula]

Setting [formula] it follows from ([\ref=fk2kconn]) that α  >  0. Furthermore, every edge [formula] must satisfy ye  ≥  α by ([\ref=eqb2conn]), since this edge is outer with respect to every partition Pi and [formula]. We are now able to derive a contradiction based on the value of [formula]. First suppose that [formula]. In this case ([\ref=fk2kconn]) gives us the following contradiction (here we have applied Lemma [\ref=edge_countconn] for the last inequality).

[formula]

It follows that [formula]. Now, every edge in [formula] must satisfy ye  ≥  β by ([\ref=eqb2conn]), since this edge receives a total contribution of at most 1 - α from the vertices and [formula] from the partitions. Hence ([\ref=fk2kconn]) gives us

[formula]

Splitting the left hand side into (4k + 6)(α  -  β)  +  (4k + 6)β and then rearranging gives:

[formula]

As in the previous case the term above with coefficient α  -  β must be ≥  0 by Lemma [\ref=edge_countconn]. Using the same lemma, we find that

[formula]

and since the coefficient of β in ([\ref=alphabetaconn]) must be negative we have

[formula]

and this final contradiction completes the proof. [formula]

Conclusion

Our methods leave some room for improvement in the values of f(k) and g(k), but not by more than about k. To see this, consider a hypergraph R where all edges are of size three and where E(R) is an independent set in the associated hypergraphic matroid. The average degree of a vertex in the hypergraph is [formula]. Therefore, in our proof, when we look for a fractional basis x of a union of k hypergraphic matroids and examine a vertex v, we cannot hope that

[formula]

is really any smaller than 3k. However, in our LPs, we require

[formula]

and

[formula]

respectively. Hence we will have to have

[formula]

and

[formula]

which implies that f(k)  ≥  4k + 2 and g(k)  ≥  5k + 2. This would seem to be the limit of our current approach. Moreover, the fight for this extra k appears to require a great deal more case analysis than we are willing to do at this point.

Acknowledgement

The authors would like to thank the many adorable kittens who gave their lives to make this research possible. We will always love you Biscuit, Paco, Sunshine, Pookie, French Fry, Goober, Chicken Noodle, Buttons, Pancake, Snowball, Peaches, and friends.