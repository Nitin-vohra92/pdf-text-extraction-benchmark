Proposition Corollary Lemma

Non-monochromatic non-rainbow colourings of σ-hypergraphs

Introduction

A hypergraph H is a finite set V(H) of vertices together with a family E(H) of subsets of H called edges. When all the subsets are of the same size r we say that H is an r-uniform hypergraph or simply a uniform hypergraph. A k-non-monochromatic-non-rainbow (k-NMNR) colouring of a uniform hypergraph H is a colouring of the vertices of H using exactly k distinct colours such that no edge has all its vertices coloured with the same colour (a monochromatic edge)and no edge has all its vertices coloured with different colours (a rainbow edge).

These colourings are an important instance of what are sometimes called Voloshin colourings of mixed hypergraphs which is a generalisation of the classical colourings of hypergraphs [\cite=voloshin02]. In Voloshin's notation, the edges of a mixed hypergraph are defined to be of two types: the D-edges and the C-edges. In a colouring of a mixed hypergraph, the vertices of any D-edge cannot all be given the same colour (that is, some two vertices must have Different colours), while the vertices in a C-edge cannot all be given different colours, (that is, some two vertices must have Common colour). What we consider in this paper is the case of hypergraphs which, apart from being uniform, also have the property that every edge is both in class C and in class D. Such hypergraphs are usually called bihypergraphs [\cite=voloshin02] [\cite=gionfriddo04].

The definition of mixed hypergraphs and much of the early theory itself of colourings of mixed hypergraphs has been introduced and developed by Vitaly Voloshin. The book [\cite=voloshin02] gives an excellent picture of the situation up to 2002. The vitality of Voloshin's idea can be seen from the range of important papers published on the topic, such as the earlier ones, like [\cite=voloshin95] [\cite=voloshinurl] [\cite=colburn&99] [\cite=kundgen&00] [\cite=dvorak&kra01] [\cite=gionfriddo&02] [\cite=gionfriddo&02], or more recent examples [\cite=kral&03] [\cite=kral04] [\cite=gionfriddo04] [\cite=jiang&05] [\cite=gyori&08] and now even applications [\cite=tuza13] [\cite=zhang&13] [\cite=jaffe&12]. The regularly updated web site is an ideal source for up-to-date-material on colourings of mixed hypergraphs.

Unlike classical colourings of hypergraphs, it is possible for a hypergraph not to have a k-NMNR colouring for any k. Two examples would be hypergraphs all of whose edges have size 2 or complete r-uniform hypergraphs on n > (r - 1)2 vertices. We shall take these to be trivially non-NMNR-colourable hypergraphs--some non-trivial cases will be considered below.

But, if H does have a k-NMNR colouring for some k then, as in classical colourings of hypergraphs, there is a number χ  =  χ(H) such that H has a χ-NMNR colouring but it does not have a k-NMNR colouring for any k < χ. However, unlike classical colourings, there could be a number k < |V(H)| such that H does not have a k'-colouring for any k' > k. The largest such number k for which H does have a k-NMNR colouring is denoted by [formula]. We call χ and [formula] the lower and the upper NMNR chromatic numbers of H,respectively.

A property of NMNR colourings which we find very intriguing is that there could be a number k with [formula] such that H is not k-NMNR colourable. More specifically, we say (differring slightly from the notation in [\cite=voloshin02]) that the NMNR spectrum of a hypergraph H is the sequence, in increasing order, of all k such that H has a k-NMNR colouring. The first and last terms of this sequence are clearly χ  =  χ(H) and [formula], respectively. If the spectrum contains all integers between χ and [formula] we then say that it is continuous. Otherwise we say that H has a gap in its NMNR spectrum or has a broken NMNR spectrum. The theme of gaps in the NMNR spectrum will be the main topic of study in this paper.

Unless otherwise stated, all hypergraphs H considered will be uniform. Any graph theory terms not defined here can be found in [\cite=bondy&mur08] and any undefined terms on hypergraphs can be found in [\cite=voloshin02].

σ-hypergraphs

We now come to the definition of the main protagonists of this paper. There have been various instances in the literature where researchers have tried to generalise the idea of mixed colourings, and we shall be meeting an important one (colour-bounded hypergraphs) at the end of this paper. Perhaps the most ambitious attempt at defining hypergraphs on which a full generalisation of mixed colourings can be investigated is the idea of "pattern hypergraphs" as defined in [\cite=dvorak&10]. What we shall instead do here is present a simple model of a hypergraph which is very easy to define and which can give us different NMNR colouring properties by a simple adjustment of its parameters. These hypergraphs also have the nice property of integrating in a very interesting way with colour-bounded hypergraphs as we shall eventually see.

So, let n,r,q be positive integers, and let σ be a partition of the integer r. The σ-hypergraph H  =  H(n,r,q|σ) is defined as follows. It has nq vertices and these are partitioned into n subsets called classes each containing q vertices. If the classes are denoted by [formula] then a subset R of V(H) of size r is an edge if the partition of r formed by the non-zero cardinalities [formula] is σ. We shall assume, throughout, that [formula].

We shall denote by Δ(σ),δ(σ) and s(σ) the size of the largest part of the partition σ, the size of the smallest part of σ, and the number of parts (summands) of σ, respectively. For example, if r = 15 and σ = (1,1,2,3,3,5), every edge K will be a 15-subset of the vertices of the hypergraph which intersects exactly six of the classes giving intersections of sizes 1, 1, 2, 3, 3 and 5, respectively. In this case, Δ(σ) = 5, δ(σ) = 1 and s(σ) = 6.

We shall always assume that [formula] so that we avoid the possibility of an edge lying completely within one class. To simplify notation, when σ is the partition (1r - p,p) we denote H(n,r,q|σ) by H(n,r,q,p). Therefore the hypergraph above, H(2n,r), can also be denoted as the σ-hypergraph H(n,r,2,2)

We have found that σ-hypergraphs are very versatile indeed. They can give us families of hypergraphs which exhibit a variety of interesting colouring properties of mixed hypergraphs. For example, it is easy to construct families of hypergraphs which do not have any NMNR colouring. Recall that any edge of H(n,r,q,1) is any r-subset of vertices taken from r different classes.

Consider the σ-hypergraph H  =  H(n,r,q,1). If n  ≥  (r - 1)2 + 1 then there is no k-NMNR colouring for any value of k.

Proof. This is a simple application of the pigeonhole principle. Suppose that the vertices of H have been coloured using the k colours [formula], for any [formula]. Take a subset of vertices [formula] each one from a different class of H. Place them into subsets S1,...,Sk where each Si conatins all those vertices from [formula] coloured with colour i. Suppose H contains no monochromatic edge. Therefore each subset Si has size at most r - 1. But n  ≥  (r - 1)2 + 1, therefore there are at least r non-empty subsets Si. But then, r vertices taken from different non-empty subsets Si give a rainbow edge. Therefore H is not k-NMNR colourable. [formula]

The NMNR colouring properties of H(n,r,q,1) for n  ≤  (r - 1)2 are not difficult to analyse. Since our aim in this paper is to use σ-hypergraphs in order to study gaps in the NMNR spectrum, we merely invite the interested reader to look at this situation.

Gaps in the NMNR spectrum of σ-hypergraphs

In this section, using σ-hypergraphs we shall be constructing families of hypergraphs with various properties related to gaps in the NMNR spectrum. But first we shall give a simple example of this counter-intuitive phenomenon of gaps. This example will motivate our general construction. Following this, we shall show that, in general, σ-hypergraphs with Δ(σ) > δ(σ) = 1 can have broken NMNR spectrum. We shall then give a detailed analysis of such a family of hypergraphs. Finally, we shall show that a σ-hypergraph with δ(σ)  ≥  2 can never have a broken spectrum.

A simple example

Let us consider the following family of hypergraphs which we denote by H(2n,3). It has 2n vertices, [formula], which are partitioned into n pairs. A edge is defined to be a set of three vertices such that exacly two are in the same pair. Clearly, H(2n,3) is 2-NMNR colourable: just colour the two vertices in each pair with the colours 1 and 2. Also, H(2n,3) is clearly n-NMNR colourable: just give the two vertices in each pair the same colour, using a different colour for each pair. However, H(2n,3) is not k-NMNR colourable for any 3  ≤  k  ≤  n - 1. Because suppose it is. If two vertices in the same pair are given two different colours, say 1 and 2, then find a vertex with colour 3. These three vertices give a rainbow edge. On the other hand, if every two vertices in a pair are given the same colour then, by the pigeon-hole prionciple, there must be two pairs such that all their vertices are given the same colour. Taking two vertices from one of these pairs and the third from the other gives a monochromatic edge.

In fact, the full spectrum of H(2n,3) is {2,n}, because if we use more than n colours, then certainly one of the n pairs contains distinct colours, say 1 and 2. Since we are using at least [formula] colours, some other pair contains a vertex coloured 3. But then these three vertices form a rainbow edge.

Our σ-hypergraphs are a generalisation of this simple example. The hypergraph H(2n,3), which we have just defined, is the σ-hypergraph H(n,r,q|σ) with r = 3, q = 2 and σ = (1,2). This particular class of σ-hypergraphs can be extended as follows: let there still be n classes of two vertices each, but let the edges be all r-subsets which contain exactly two vertices coming from the same class. This therefore becomes the σ-hypergraph H(n,r,2|σ = (1r - 2,2)), which we denote, for short, by H(2n,r). We shall see below that this is a very interesting family of hypergraphs when we shall be discussing in detail its NMNR spectrum.

The monochromatic zone

We shall first note that, for any σ-hypergraph with Δ(σ) > 1 there is a range of consecutive integers k for which there is always a k-NMNR colouring. We shall refer to this range of integers as the monochromatic zone.

So, consider a σ-hypergraph H(n,r,q|σ), always with [formula]. We also assume here that Δ(σ) > 1. Colour all the vertices in each of the n classes of vertices with the same colour. How many colours can be used this way to give us an NMNR colouring? Suppose first that all classes are given different colours. Then, since no edge is contained in a single class, there can be no monochromatic edge. Also, since not all parts of the partition are equal to 1, because Δ(σ) > 1, there can be no rainbow edge. Therefore we have an n-NMNR colouring. At the other end, suppose, in this scheme, that no colour repeats in more than s - 1 classes. Then again, we have no monochromatic or rainbow edges, therefore giving us a [formula]-NMNR colouring. Clearly, this scheme gives us a k-NMNR colouring for all [formula] and we call this interval the monochromatic zone, which is therefore a gap-free region within the NMNR spectrum. Since we shall be using this result often, we record it here as a proposition.

Let H be a σ-hypergraph with Δ(σ) > 1 and [formula]. Then H is k-NMNR colourable for all k in the interval

[formula]

Gaps in the case Δ(σ) > δ(σ) = 1

We shall now show, by means of an example, that when Δ(σ) > δ(σ) = 1 a certain choice of the parameter q gives σ-hypergraphs with a gap in the spectrum. We recall that we write s = s(σ) for the number of parts of σ and that we always assume that [formula]. We shall also write Δ for Δ(σ).

Let n be greater than r(s - 1) + s, and let q = (r - 1)(Δ - 1). Let σ be a partition of r with δ(σ) = 1, and let H  =  H(n,r,q|σ). Then H has a gap in its spectrum between r - 1 and the monochromatic zone. More specifically, H is

not k-NMNR colourable for k  ≤  r - 2;

(r - 1)-NMNR colourable;

not r-NMNR colourable;

k-NMNR colourable in the monochromatic zone ⌈n / (s - 1)⌉  ≤  k  ≤  n.

Proof. Case 1: k  ≤  r - 2. So, suppose first that H has been coloured with k  ≤  r - 2 colours. Then, in every class, there is a colour which appears at least Δ times. This is because, if not, then the number of vertices in some class would be at most (Δ - 1)k  ≤  (Δ - 1)(r - 2)  <  (Δ - 1)(r - 1)  =  q, where q is the number of vertices in a class.

Hence, since n  ≥  r(s - 1)  +  s  >  k(s - 1) + 1, for k  ≤  r - 2, it follows by the pigeon-hole principle, that one colour appears at least Δ times in at least s = s(σ) classes. But this means that there is a monochromatic edge. Therefore H is not k-NMNR colourable for n  ≥  k(s - 1)  +  1 and k  ≤  r - 2, in particular for n  ≥  (r - 2)(s - 1) + 1.

Case 2: k = r - 1. Next we show that H is (r - 1)-colourable. Colour each class as

[formula]

that is, each colour [formula] is repeated exactly Δ - 1 times in each class. Then there can be no monochromatic edge since no colour appears more than r - 1 times in any class. Also, since only r - 1 colours are used, there cannot be any rainbow edge.

Case 3: k = r. We now have to prove now is that H is not r-NMNR colourable. For the rest of the proof, let the parts of the partition σ be denoted by [formula] in non-increasing order. Observe that [formula], a fact that will be needed later.

So, suppose we have the r colours [formula]. Observe first that the same colour can appear at least Δ times in at most s - 1 classes, otherwise we obtain a monochromatic edge. Also, since r colours are used, there are at most r(s - 1) classes which contain some colour repeated at least Δ times.

But the number of classes n is at least r(s - 1) + s. Therefore there are at least s classes in which no colour repeats more than Δ - 1 times. Let us call such classes "colourful". Since q, the size of each class, equals (r - 1)(Δ - 1), it follows that each colourful class contains either r - 1 or r distinct colours, which is why we call them colourful. We shall assume that these s colourful classes are listed as [formula] in some arbitrary order.

We now consider two cases. Firstly, suppose some colour x is missing from all the colourful classes. Therefore x must appear at least once in some other class. We may assume, by re-numbering, that x = r, and that therefore each colourful class contains the colours [formula]. In that case we can form a rainbow edge K as follows: K contains Δ = a1 distinct colours from V1, a2 new distinct colours from V2, all different from the ones previously chosen, and so on up to as - 1 new distinct colours from the Vs - 1. Note that this process of choosing greedily the distinct colours class after class is possible due to the above observation that [formula].

Finally, we take the colour r from whichever class it appears in (which is not colourful). And this gives us the rainbow edge K, which makes this case impossible.

We now consider the second case, that is, when each of the colours [formula] appears at least once in some colourful class. Again, we shall construct a rainbow edge K. The first r - 1 distinct colours in K are chosen by the previous greedy fashion: choose aj new distinct colours from the Vj, for [formula]. We just need to assign the last colour to K.

Note that K already contains all colours except one, call it x, say. If x appears in Vs then we assign it as the last colour to K. Otherwise, x must be in some Vj from which we have chosen aj distinct colours. But then these aj colours must all appear in Vs since Vs misses colour x and it can miss at most one colour. Therefore we re-assign to K the colour x from Vj instead of some colour y from the aj colours previously assigned, and then we assign to K the colour y from Vs. This, again, gives us the rainbow edge K, which is the final contradiction we required.

Case 4: ⌈n / (s - 1)  ≤  k  ≤  n. We already know that H is k-NMNR colourable for k in the monochromatic zone, so we have nothing to probe here. [formula]

The hypergraph H(2n,r): full calculation of a spectrum with a gap

In the previous subsection we have simply shown that a particular family of σ-hypergraphs does have a gap but we did not try to determine the exact extent of the gap. In this section we shall study the interesting and relatively simple σ-hypergraph H(2n,r), which is an extension of the elementray example we started with in order to introduce the notion of a broken NMNR spectrum, and we shall show that we can determine exactly its NMNR spectrum.

Recall that H(2n,r) = H(n,r,2|(1r - 2,2)), that is, it is the hypergraph on 2n vertices which are partitioned into n classes of size 2, and its edges are all r-subsets which contain two vertices from the same class and all the other r - 2 vertices from distinct classes.

We shall first deal with the case when [formula], following which we shall briefly treat the details which arise for smaller values of r.

Let H  =  H(2n,r) with [formula]. Suppose also that n  ≥  2(r - 2)(r - 1) + 1. Then,

H is not k-NMNR colourable for k > n;

H is k-NMNR colourable for ⌈n / (r - 2)⌉  ≤  k  ≤  n;

H is not k-NMNR colourable for 2r - 5  ≤  k  <  ⌈n / (r - 2)⌉;

H is k-NMNR colourable for 2  ≤  k  ≤  2r - 6;

Proof. We let the classes containing the vertices of H be [formula] in some arbitrary order. Recall that each Vi has size equal to 2.

Case 1: k > n We shall first show that, if the number of colours k used is more than n, then there will always be a rainbow edge. So, suppose k > n and H is coloured using k colours. Therefore there is at least one class which contains two different colours. We may assume, without loss of generality, that V1 contains the colours 1,2. We construct a rainbow edge K as follows. First let K contain the two vertices from V1 and another vertex coloured 3. We may assume, by renumbering, that this vertex is from V2. We keep choosing a vertex with a new colour from some new class until we obtain a rainbow r-edge. How do we know that this is certainly possible? Suppose not. Therefore suppose that we have reached a stage where K conatains j differently coloured vertices from the sets [formula] with j < r, and that we cannot find amongst the classes [formula] any vertex with a different colour from those already in K. But then, the number of colours used in the colouring is at most 2(j - 1). However, 2(j - 1)  <  2(r - 1)  <  (2r - 4)(r - 1)  ≤  n  <  k, which is a contradiction. Therefore we can always find a rainbow edge, which shows that H is not k-NMNR colourable for k > n.

Case 2: ⌈n / (r - 2)⌉  ≤  k  ≤  n We already know that H is k-NMNR colourable for ⌈n / (r - 2)⌉  ≤  k  ≤  n since this is the monochromatic zone, so we have nothing to prove here.

Case 3: 2r - 5  ≤  k  <  ⌈n / (r - 2)⌉ So we now have to show that H is not k-NMNR colourable for 2r - 5  ≤  k  <  ⌈n / (r - 2)⌉. We shall first tackle the interval 2r - 3  ≤  k  <  ⌈n / (r - 2)⌉. The cases k = 2r - 4 and k = 2r - 5 will then be treated separately below.

Firstly, if all the classes Vi were monochromatic, then, since no more than r - 2 classes can be monochromatic of the same colour (otherwise we get a monochromatic edge), the number of colours used would be at least ⌈n / (r - 2)⌉. But this is impossible since k  <  ⌈n / (r - 2)⌉. So there is some class, say V1, which is not monochromatic.

But we have k  ≥  2r - 3 colours. So it is not possible that the remaining 2r - 5 colours (the ones not in V1) are contained in only r - 3 classes, which between them would contain at most 2r - 6 vertices. Therefore there are r - 2 classes which, between them, certainly contain r - 2 distinct colours, one colour in each class. But then these classes, together with V1, give a rainbow edge. So H is not k-NMNR colourable for 2r - 3  ≤  k  <  ⌈n / (r - 2)⌉.

We now proceed to treat the remaining cases, k = 2r - 5 and k = 2r - 4. First we show that H is not (2r - 4)-NMNR colourable. Suppose the vertices of H have been coloured with 2r - 4 colours. First we shall show that there must be a non-monochromatic class. For, suppose all classes are monochromatic. Since there are n classes and n is at least (2r - 4)(r - 1) + 1, some colour must appear in at least r - 1 monochromatic classes. But then we have a monochromatic edge.

So, suppose that V1 is a non-monochromatic class of H, and suppose, without loss of generality, that the colours appearing in V1 are 1 and 2. We shall construct a rainbow edge in the now familiar manner. We start with the two vertices from V1. Then we look for another colour from a different class; we may assume, by re-numbering colours and classes, that we find a vertex with colour 3 from V2. In the next step we find, say, a vertex coloured 4 from V3, and so on. If we can do this up to colour r then we have a rainbow edge. So suppose we only manage to arrive up to some colour j  ≤  r - 1 from Vj - 1. Since we cannot proceed any further, no other new colour is available because it is found only in the classes V1 to Vj - 1. Therefore these classes between them contain all 2r - 4 colours, and therefore j = r - 1. We therefore have that each class Vi, for [formula], has two vertices coloured differently and all colours found in these classes are diffferent.

But then we can again get a rainbow edge as follows. Start with any vertex coloured x, say, from some class other than [formula]. Then, from each of the classes V1 to Vr - 2 pick one vertex, being careful not to pick the only vertex in these classes coloured x; and then choose one other vertex from these same first r - 2 classes (thereby repeating one of them once), again not choosing the one vertex coloured x. This gives a rainbow edge. Therefore H is not (2r - 4)-colourable.

Similarly, we now show that H is not (2r - 5)-NMNR colourable. Again, if all classes were monochromatic, then, since there are n classes and n is at least (2r - 5)(r - 1) + 1, some colour must appear in at least r - 1 monochromatic classes giving a monochromatic edge. Therefore we may assume that H has a non-monochromatic class V1 with vertices coloured 1 and 2, respectively. As above, we start with the two vertices in V1 and then construct a rainbow edge by choosing a sequence of vertices, each with a new colour and from a new class and we assume that we stop short of a rainbow edge when we have chosen a colour j from Vj - 1 for some 3  ≤  j < r. Again, the classes V1 to Vj - 1 must therefore contain all the 2r - 5 colours used in the colouring, therefore j = r - 1 and all these classes contain two differently coloured vertices, except possibly for one of them which might be monochromatic. If all these classes are non-monochromatic, we proceed as before. So suppose there is a monochromatic class from amongst [formula] which contains two vertices coloured y. If all the vertices in the classes Vr - 1 to Vn are coloured y then H contains a monochromatic edge. So, there is some vertex in these classes coloured [formula]. Now, as before, obtain a rainbow edge starting with this vertex coloured x and then using only vertices from the classes V1 to Vj - 1. Therefore H does not have a (2r - 5)-NMNR colouring.

Case 4: 2  ≤  k  ≤  2r - 6 Finally, we have to show that there is always a k-NMNR colouring for 2  ≤  k  ≤  2r - 6. Let t be a number such that 0  ≤  t  ≤  r - 4. Divide the classes in H into two categories: [formula] and [formula] (if t = 0 we assume that all the classes V1 to Vn are considered to be in the second category). We now colour the vertices of H as follows. Each class from [formula] is given the two colours 1,2. The vertices in the other classes are given distinct colours, all diferent from 1 or 2. Therefore this is a colouring which uses between 2 and 2  +  2(r - 4)  =  2r - 6 colours, depending on the value of t. With this colouring, an edge K cannot be monochromatic. Also, K can have at most r - 3 vertices from the classes [formula] (the maximum is attained if K includes a whole class from this list). Therefore at least three other vertices must share the colours 1 and 2 from the classes Vt + 1 to Vn, hence K is not rainbow. We have therefore shown that H is k-NMNR colourable for 2  ≤  k  ≤  2r - 6. [formula]

We are therefore left with the cases r = 3,4,5 which need some special treatment not covered by Theorem [\ref=thm:theMonster]. We shall consider these cases now.

Consider the hypergraph H(2n,r) for r = 3,4,5 and n  ≥  2(r - 2)(r - 1) + 1. Then,

H(2n,3) is k-NMNR colourable only for k = 2 and k = n.

H(2n,4) is k-NMNR colourable only for k = 2, k = 3 and for k in the monochromatic zone, that is, ⌈n / 2⌉  ≤  k  ≤  n.

H(2n,5) is k-NMNR colourable only for k = 2,3,4 and for k in the monochromatic zone, that is, ⌈n / 3⌉  ≤  k  ≤  n.

Proof. We have already shown in Section [\ref=sec:simpleExample] that H(2n,3) is k-NMNR colourable only for k = 2 and k = n.

Unlike the general case of Theorem [\ref=thm:theMonster], H(2n,4) is k-NMNR colourable for r = 2r - 5 = 3. The colouring with three colours for H(2n,4) is obtained by colouring all classes using the colours 1,2 except one class whose two vertices are both coloured 3.

The proof that H(2n,4) is not k-NMNR colourable for 4  ≤  k  <  ⌈n / 2⌉ is as that in Theorem [\ref=thm:theMonster] but it requires a special treatment for k = 4 (which corresponds to the case 2r - 4 in Theorem [\ref=thm:theMonster]).

Thus, suppose H(2n,4) is coloured using four colours. No colour can appear in three monochromatic classes, otherwise we would have a monochromatic edge. Therefore we can have at most eight monochromatic classes. But n  ≥  2(r - 2)(r - 1) + 1 > 8. Therefore there must be a non-monochromatic class, and we may take it to be V1 whose vertices are coloured 1 and 2, respectively. Now, there is some vertex coloured differently in some other class. By renumbering colours and classes, we may assume that a vertex coloured 3 is in class V2. If the colour 4 is found in some third class, then we have a rainbow edge. So we may suppose that colour 4 appears together with colour 3 in class V2 and nowhere else. But now, take a vertex in V3 coloured x∈{1,2,3,4}. We may assume, without loss of generality, that x = 1. Then this vertex, together with the vertex coloured 2 in V1 and the two vertices in V2 give a rainbow edge. Therefore H(2n,4) is not 4-NMNR colourable.

Finally, the result for the hypergraph H(2n,5) tells us that Theorem [\ref=thm:theMonster] holds here. But again, the colourings for small values of k need separate explaining. The 3-NMNR coloring is once more obtained by colouring all classes with the colours 1,2 except for one monochromatic class whose vertices are given the colour 3. The 4-NMNR colouring is obtained by colouring all classes except two with the colours 1,2. The remaining two classes are monochromatic: the vertices of one are both coloured 3 while the vertices of the other are both coloured 4.

The proof that H(2n,5) is not k-NMNR colourable for 5  ≤  k  <  ⌈n / 3⌉ is again similar to Theorem [\ref=thm:theMonster] but it requires special treatment for the cases k = 5,6 (corresponding to the cases 2r - 5 and 2r - 4, respectively, in Theorem [\ref=thm:theMonster]).

So, suppose first that H(2n,5) is coloured using six colours. No colour can appear in four monochromatic classes, otherwise we would have a monochromatic edge. Therefore we can have at most fifteen monochromatic classes. But n  ≥  2(r - 2)(r - 1) + 1 > 15. Therefore there must be a non-monochromatic class, and we may take it to be V1 whose vertices are coloured 1 and 2, respectively. We may assume, by renumbering, that there is a vertex coloured 3 in V2. We proceed this way, picking a vertex coloured with a new colour coming from a new class. If we can do this up to colour 5, then we have a rainbow edge. So the procedure must stop with colour j < 5 in class Vj - 1 (as usual, by renumbering of colours and classes). Since we cannot proceed further it follows that all colours greater than j are to be found only in the classes V1 to Vj - 1. But six colours must be used, therefore, for the classes V1 to Vj - 1 to accommodate six colours, j must be equal to 4. We may assume, again by renumbering, that the vertices of V1,V2,V3 are coloured, respectively, (1,2), (3,4) and (5,6). But then, take any vertex v from V4 coloured x, say. We may assume, without loss of generality, that x = 1. Therefore, taking the vertex v, the vertex coloured 2 from V1, the two vertices from V2 and any vertex from V3 give a rainbow 5-edge. So H(2n,5) is not 6-NMNR colourable.

Finally, we show that H(2n,5) is not 5-NMNR colourable. The proof is similar but at one point requires some more care. Suppose H(2n,5) has been coloured using five colours. As usual, we start by noting that there must be a non-monochromatic class which we take to be V1 with two vertices coloured 1 and 2, respectively. As above, we begin constucting a rainbow edge by picking a sequence of vertices each with a new colour and coming from a new class. If we can do this up to colour 5 we get a rainbow edge. So the procedure must stop with colour j < 5 in class Vj - 1. Since we cannot proceed further it follows that all colours greater than j are to be found only in the classes V1 to Vj - 1. But five colours must be used, therefore, for the classes V1 to Vj - 1 to accommodate five colours, j must be equal to 4. We now have to consider two cases. One case occurs when one of the classes V1,V2,V3 is monochromtic, and the other when none of them is monochromatic.

Let us start with the first case. We may assume, without loss of generality, that the vertices of V1,V2,V3 are coloured, respectively, (1,2), (3,5) and (4,4). It is clear that not all of the vertices in the classes V4 to Vn can be coloured 4, otherwise we would have a monochromatic edge. So suppose that some vertex v in these classes is coloured [formula]. We may assume, again without loos of generality, that x = 1. But then, choosing the vertex v, the vertex coloured 2 in V1, the two vertices in V2, and one vertex from V3, gives a rainbow 5-edge.

If, on the other hand, none of V1,V2,V3 is monochromatic, we may assume that their vertices are coloured, respectively, (1,2), (3,4) and (4,5). But then, let v be a vertex coloured x from V4. It is easily checked that, for any x, one can find four appropriate vertices from V1,V2,V3 which, together with v, form a rainbow 5-edge.

Therefore in any case, H(2n,5) is not 5-NMNR colourable. [formula]

The case [formula]: no gaps!

We shall now prove the general result that, when [formula], a σ-hypergraph cannot have gaps in its NMNR spectrum. We shall start with two technical lemmas which show how, under certain conditions, we can obtain a new NMNR colouring by re-colouring a given NMNR colouring.

Let H  =  H(n,r,q|σ) with [formula] and suppose we are given an NMNR colouring of H. Suppose V is a class of H and that all colours of V are changed into a new colour z. Then the new colouring of H is also an NMNR colouring.

Proof. Any edge of H which does not intersect V remains a NMNR edge in the new colouring. Let K be a edge which intersects V. Then, since [formula], K intersects some other class V'. Therefore K is non-monochromatic since it contains the colour z which is not found in V'. Also, since [formula], K contains the colour z at least twice therefore it is non-rainbow. [formula]

Let H  =  H(n,r,q|σ) with [formula] and suppose we are given an NMNR colouring of H. Suppose V is a class of H and that x,y are two different colours in V which do not appear in any other class of H. Suppose that all occurrences of the colours x and y in V are changed into a new colour z. Then the new colouring of H is also an NMNR colouring.

Proof. As usual, if K is a edge which does not interesect V, then it remains unchanged and therefore a NMNR edge in the new colouring. Therefore suppose that K interesects V. If it did not contain any of the colours x,y in the original colouring, it would again remain unchanged and therefore a NMNR edge in the new colouring. Therefore suppose first that K contains at least two vertices coloured x or y in the original colouring. Therefore K contains, in the new colouring, at least two vertices which are coloured z; therefore K is non-rainbow. Also, since z does not appear in any other class and [formula], K contains some other colour from another class which is not z. Therefore K is non-monochromatic.

Now suppose that K contains only one vertex which is coloured z in the new colouring. Then, as before, K is non-monochromatic, since [formula] and z is a new colour appearing only in V. Also, suppose, without loss of generality, that the vertex coloured z in K was coloured x in the original colouring--therefore only one vertex was coloured x in K. Recall that K was non-rainbow, therefore it had at least two vertices coloured some colour c, with c not equal to x since x does not appear in any class other than V. But this means that in the new colouring, these two vertices are still coloured c, therefore K is still non-rainbow. [formula]

The hypergraph H  =  H(n,r,q|σ) with [formula] cannot have a gap above the monochromatic zone in its NMNR spectrum.

Proof. Let us start with k0 being the largest integer for which H has a k0-NMNR colouring (k0 must be less than qn). If k0 = n or even if k0 = n + 1 then we are done. We may therefore assume that k0 > n + 1 and that therefore not all classes of H are monochromatic. Choose that k0-NMNR colouring of H which has the largest number m0 of monochromatic classes amongst all k0-NMNR colourings. Let V0 be a non-monochromatic class of H.

Suppose first that all colours in V0 appear in some other class of H. Replace all the colours in V0 with a new colour z. By Lemma [\ref=lem:firstSwitchOfColours], this gives an NMNR colouring of H. But this colouring uses k0 + 1 colours. This case is therefore impossible by the maximality of k0.

Therefore suppose that V0 contains just one colour x which is not in some other class. Again we change all colours in V0 to the colour z and again we obtain an NMNR colouring, this time with k0 colours but with one more monochromatic class. This is also impossible by the maximality of the number of monochromatic classes.

Lastly, we suppose that V0 contains at least two colours x and y which appear only in V0. We replace all occurrences of these two colours in V0 with the new colour z. By Lemma [\ref=lem:secondSwitchOfColours], we again have a NMNR colouring, but this time with k0 - 1 colours.

(It is important for later to observe here that the number of monochromatic classes of this (k0 - 1)-NMNR colourings is at least m0.)

We have therefore shown that H has a (k0 - 1)-NMNR colouring. If k0 - 1 = n + 1 then we are done. Otherwise we again proceed as above. In general, at the j-th step of this procedure, we start with a (k0 - j)-NMNR colouring such that k0 - j is still greater than n + 1. Therefore the colouring has some non-monochromatic class Vj. We start with a (k0 - j)-NMNR colouring which has a maximum number mj of monochromatic classes. By the above observation, mj  ≥  mj - 1. By re-colouring the vertices of Vj as we did before, we either obtain a (k0 - j + 1)-NMNR colouring with more than mj colourings, which is impossible since mj  ≥  mj - 1, or a (k0 - j - 1)-NMNR colouring, as required. We emphasise that the (k0 - j - 1)-NMNR colouring we end up with has at least as many monochromatic classes as the original (k0 - j)-NMNR colouring, ensuring that, at the next stage, mj + 1 will be at least mj.

Proceeding this way we eventually obtain that H has a k-NMNR colouring with k all the way from k0 down to n + 1, confirming that it has no gaps above the monochromatic zone. [formula]

We now show, using similar techniques, that, when [formula], a σ-hypergraph cannot have gaps below the monochromatic class interval.

Let H  =  H(n,r,q|σ) be a σ-hypergraph with [formula]. Then H(n,r,q|σ) cannot have a gap in its NMNR spectrum below the monochromatic zone.

Proof. We shall proceed very much as in Proposition [\ref=th:noUpperGap]. Recall that the monochromatic zone starts at [formula]. Start with a k0-NMNR colouring of H with the least value of k0. If [formula] then we are done. So suppose that [formula]. Therefore the colouring has a non-monochromatic class V0. Choose that k0-NMNR colouring with a maximal number m0 of monochromatic classes. By a suitable recolouring of the vertices of V0 we either obtain a colouring with more than the maximal number of monochromatic classes or a k0 + 1-colouring and then repeat the process. We shall describe the general case when we are at stage j.

In this case, we have a (k0 + j)-NMNR colouring where k0 + j is still less than [formula]. Therefore the colouring has a non-monochromatic class Vj. We choose a (k0 + j)-NMNR colouring with a maximal number mj of monochromatic classes, and we observe that mj > mj - 1. We then have these possibilities.

If Vj has at least two colours x,y which do not appear in any other class of H, we colour all the vertices of Vj with a new colour z. This gives a legitimate NMNR colouring, by Lemma [\ref=lem:firstSwitchOfColours] but with strictly less colours than k0 + j (say, k0 + i colours, i < j), and one more monochromatic class (that is, 1 + mj monochromatic classes). This is a contradiction since 1 + mj  >  mj  >  mi, for all i < j, therefore the new colouring has more monochromatic classes than the maximum possible for a (k0 + i)-NMNR colouring, which is mi.

So suppose that Vj has only one special colour x which does not appear in any other class of H. Again we re-colour all the vertices of Vj using the colour z, giving another (k0 + j)-NMNR colouring by Lemma [\ref=lem:firstSwitchOfColours] but with one more monochromatic class. Again, this gives a contradiction as in the previous case.

The last remaining case is therefore when every colour in Vj appears in some other class of H. We now replace all the colours in of the vertices in Vj by a new colour z. This gives us a (k0 + j + 1)-NMNR colouring, as required. Note that the number of monochromatic classes has also increased, insuring that, at the next step, mj + 1 will be larger than mj.

Proceeding this way we finally achieve a k-NMNR colouring with [formula], giving us the required result. [formula]

From Propositions [\ref=th:noUpperGap] and [\ref=th:noLowerGap] we conclude the following.

Let H(n,r,q|σ) be a σ-hypergraph with [formula]. Then H(n,r,q|σ) cannot have a gap in its NMNR spectrum.

A generalisation of NMNR colourings: colour-bounded hypergraphs

We have defined σ-hypergraphs and we have illustrated various cases of gaps when δ(σ) = 1. But as far as gaps go, the case for [formula] seems to be closed: there are no gaps. However, we believe that this is just the beginning of the story because the following generalisation of NMNR colourings allows gaps to re-appear when [formula].

In [\cite=bujtas&tuz09] we find a definition which generalises NMNR colourings. A colour-bounded hypergraph is a hypergraph together with two given integers 2  ≤  α  <  β such that any feasible colouring of the hypergraph is one for which every edge has at least α and at most β vertices given different colours. Since we consider only r-uniform hypergraphs, we also assume that β  ≤  r. We call such a colouring an (α,β)-colouring. An (α,β)-colouring using exactly k colours is called a k-(α,β)-colouring. The (α,β)-spectrum is analogously defined.

Therefore a classical colouring of an r-uniform hypergraph is a (2,r)-colouring and an NMNR colouring, which is an instance of Voloshin's extension of classical hypergraph colourings, is a (2,r - 1)-colouring.

The reappearance of gaps when δ(σ)  ≥  2!

Surprisingly, just as Voloshin colourings can produce gaps when there were none in classical colourings, (α,β)-colourings can produce gaps where there are none in Voloshin colourings, as the next simple result shows.

The hypergraph H  =  H(n,4,2|σ = (2,2)) with [formula] has a gap in its (2,2)-spectrum.

Proof. Colour the classes (each of size 2) of H with the colours 1,2. Then every edge has two vertices coloured 1 and two vertices coloured 2. Therefore we have a 2-(2,2)-colouring.

Next, colour the vertices in each class with the same colour, using a different colour for each class. Again, every edge contains two colours with two pairs of vertices coloured differently. This therefore gives an n-(2,2)-colouring.

But we now show that H does not have a 3-(2,2)-colouring. So, assume that H has been coloured with three colours. Suppose, first, that there is a non-monochromatic class. We may assume that its vertices are coloured 1 and 2, respectively. But colour 3 must also appear in some other class. But then, these two classes give us an edge with three colours, which is not allowed in a (2,2)-colouring.

However, since we are using three colours and there are more than three classes, not all classes can be monochromatic. Otherwise, by the pigeonhole principle, one colour must appear in at least two monochromatic classes, and these would give us a monochromatic edge. Therefore, since not all classes can be monochromatic, H must have a non-monochromatic class, and we therefore obtain the same contradiction as above. [formula]

Further work

Using similar agruments it can be shown that the hypergraph in the previous lemma does not have a k-(2,2)-colouring for any 3  ≤  k  ≤  n - 1. Therefore it has a gap from k = 3 to k = n - 1. But the point we want to make here is that while, in the world of NMNR colourings, we have a whole family of hypergraphs without gaps in their spectrum, but when considering (α,β)-colourings we see that gaps re-appear.

Perhaps the most spactacular examples of mixed hypergraphs with broken spectra has been given by Gionfriddo [\cite=gionfriddo04]. This paper presents hypergraphs which are non-colourable either for all the odd numbers or for all the even numbers between χ and [formula], but colourable for all the other numbers in this range. These hypergraphs, depending on designs for their construction, are, however, not easy to produce, they are all 3-uniform, and it does not seem at all evident that it is possible to extend their construction to r-uniform hypergraphs with r > 3.

Therefore, to facilitate our study of gaps we have introduced σ-hypergraphs which are very simple to describe and which, by an appropriate choice of parameters, readily give r-uniform hypergraphs with [formula], with or without broken spectra. This led us to the discovery that σ-hypergaphs do not have gaps when [formula]. Motivated by this result and the feeling that the phenomenon of broken spectra has not yet revealed all its secrets, we considered the (α,β)-colouring of σ-graphs. With this new definition of colourings of hypergraphs it turned out that σ-hypergraphs with [formula] can have gaps.

Our initial investigations seem to indicate that the relationship between the paramaters α and β and the parameters of σ-hypergraphs can be made to work together in order to control the existence of gaps. This interplay between parameters seems to be an area of study which might give very interesting results including also a fruitful context within which one can explain why gaps in the chromatic spectra of mixed hypergraphs appear. This is work which we intend to present in a further paper.