A Statistical Model for the Analysis of Beta Values in DNA Methylation Studies

Background

The analysis of DNA methylation has become of considerable interest in biomedical research, as epigenetic studies have shown numerous associations between methylation levels and diseases such as cancer and cardiovascular disease [\cite=bird] [\cite=shames] [\cite=Sarkar] [\cite=varley] [\cite=cancerPurity]. Today, most research focuses on the cytosine-guanine dinucleotide ("CpG") sites of the DNA, which are the locations where methylation is primarily found in humans [\cite=portela]. One of the most widely used techniques to measure DNA methylation is the Illumina Infinium HumanMethylation450 BeadChip array, which covers approximately 450,000 CpG sites. At each CpG site, methylation is quantified by the beta value b: = M  /  (M  +  U  +  a), where M  >  0 and U  >  0 denote the methylated and unmethylated signal intensities, respectively, measured by the Illumina 450k array. The offset a  ≥  0 is usually set equal to 100 and is added to M  +  U to stabilize beta values when both M and U are small.

An important goal of methylation analysis is to identify DNA regions where methylation is associated with disease status, lifestyle factors and other clinical or sociodemographic variables [\cite=dedeur] [\cite=Wahletal] [\cite=dolz] [\cite=singman]. This is often achieved by fitting site-wise regression models with dependent variable b and a vector of covariates [formula] that may also include potential confounders. After model fitting, a common strategy is to carry out downstream hypothesis tests to identify those CpG sites that show significant associations between methylation status and the variables of interest.

Because, by definition, b is bounded between 0 and 1, Gaussian regression with untransformed beta values is problematic in the context of DNA methylation analysis. In particular, the variance of b is usually smaller near the boundaries than near the middle of the interval (0,1), implying that the homoscedasticity assumption in Gaussian regression is violated [\cite=Duetal] [\cite=Laird] [\cite=boostedBeta]. To address this problem, several modeling strategies have been developed, including Gaussian regression with logit-transformed beta values ("M-values", [\cite=Duetal]) and generalized regression models for untransformed bounded responses, e.g. beta regression [\cite=ferrari]. Regarding the analysis of DNA methylation, both strategies are intrinsically problematic: In case of M-value regression, the assumptions of a Gaussian model are often not met despite the transformation of the data, and the interpretation of the coefficient estimates is only possible on the transformed scale but not on the original scale of b [\cite=ferrari] [\cite=bock]. Beta regression, on the other hand, requires the ratio M  /  (M  +  U  +  a) to follow a beta distribution, implicitly assuming that the variables M and U are independently gamma distributed [\cite=devroye]. While M and U can indeed be described by gamma distributed random variables [\cite=Laird2] [\cite=benner], the independence assumption for the two signal intensities is often not met in practice. For example, Laird [\cite=Laird] reported that the methylated and unmethylated signal intensities, as produced by the Illumina 450k array, are usually positively correlated. These issues, along with the results of two recent empirical studies [\cite=benner] [\cite=Wahletal], suggest that both M-value regression and beta regression need to be improved to describe the distribution of b in a statistically sound way.

To address this problem, we propose a novel analysis technique for beta values that relaxes the independence assumption between the signal intensities M and U. The idea is to start with a model for the bivariate distribution of M and U and to derive the probability density function of the ratio M  /  (M  +  U). This function is subsequently used to construct the log-likelihood function of a generalized regression model that relates beta values to linear functions of the covariates. Because estimation of the model parameters is based on the maximum likelihood principle, asymptotic confidence intervals and normally distributed test statistics can be derived by evaluating the inverse of the observed information matrix. This strategy allows for downstream hypothesis tests on the associations between a covariate of interest and the methylation status at individual CpG sites. For the rest of this paper, we will refer to the proposed model as "RCG" ( Ratio of Correlated Gammas) model.

Methods and Results

In Section [\ref=s21] we introduce basic notation and definitions. Section [\ref=s22] briefly reviews beta regression and M-value regression and discusses the limitations of the two methods. In Section [\ref=s23] the proposed RCG model for the analysis of beta values is derived. Section [\ref=s24] provides details on model fitting and on the construction of downstream hypothesis tests.

Notation and Definitions

At each CpG site, the Illumina 450k array produces a sample of methylated and unmethylated signal intensities [formula], where n is the number of analyzed persons. The corresponding set of beta values is calculated by bi  =  Mi  /  (Mi + Ui  +  a), [formula]. To facilitate the derivation of distributional results, we will set a  =  0 throughout this section. The predictor variable(s) of interest and the confounding variables are collected in vectors [formula], [formula]. For each CpG site, the aim is to analyze the associations between the variables in [formula] and the methylation status b.

Following [\cite=Laird2] and [\cite=benner], we assume that the stochastic behavior of the signal intensities M and U can be described by gamma distributed random variables with densities

[formula]

where αm,αu and λm,λu are the shape and rate parameters of fM and fU, respectively. From ([\ref=gammas]) it follows that the means and variances of M, U are given by αm  /  λm, αu  /  λu and αm  /  λ2m, αu  /  λ2u, respectively [\cite=contbivar].

Regression Models for the Analysis of Beta Values

Since the ratio b  =  M  /  (M  +  U) is bounded between 0 and 1, it has been argued that a linear regression model of the form

[formula]

is not appropriate to model DNA methylation. In particular, the variance of b is usually smaller near the boundaries than near the middle of the interval (0,1), implying that the homoscedasticity assumption [formula] is violated [\cite=Duetal].

In view of this problem, several statistical models for bounded response variables have been developed (see [\cite=boostedBeta] for an overview). A simple approach is to calculate logit-transformed beta values ("M-values", [\cite=Duetal]) and to fit a linear regression model of the form

[formula]

Although this strategy has become popular in the analysis of DNA methylation, it has the drawback that the methylation status (as quantified by the value of b) is not analyzed on its original scale but on a transformed scale [\cite=ferrari]. Furthermore, as shown by Wahl et al. [\cite=Wahletal], the empirical distribution of logit-transformed beta values usually deviates from normality.

An alternative approach that operates on the untransformed scale of b is beta regression, which is characterized by a beta distributed outcome variable with probability density function

[formula]

where μ and φ denote the mean and precision parameters, respectively, of the probability density function φ. The predictor-response relationship is usually defined by a monotone increasing link function g(  ·  ) and by the model equation [formula] [\cite=ferrari]. A common choice for g is the logit transformation log (μ  /  (1 - μ)). Since the variance of a beta distributed random variable is given by μ(1 - μ)  /  (1 + φ), beta regression accounts for heteroscedasticity and for small variances near the boundaries of the interval (0,1). On the other hand, a major shortcoming of ([\ref=betadensity]) in the context of DNA methylation analysis is that the signal intensities M and U are implicitly assumed to be independent and to share a common rate parameter. Under these assumptions, the ratio b  =  M  /  (M  +  U) can be shown to follow a beta distribution ([\cite=devroye], Chapter 9). The independence assumption, however, cannot be confirmed by empirical findings, which show that the signal intensities obtained from the Illumina 450k array are often positively correlated (see [\cite=Laird]).

A Statistical Model for the Ratio of Correlated Gamma Distributed Random Variables

To overcome the problems associated with M-value regression and beta regression, we propose a statistical model ("Ratio of Correlated Gammas (RCG) model") that is based on the bivariate distribution of the signal intensities M and U. In contrast to beta regression, we assume that M and U are not independent but can be described by a bivariate gamma distribution with probability density function

[formula]

where λm,λu,α > 0, 0  <  ρ < 1, and Iα - 1 is the modified Bessel function of the first kind of order α - 1. The distribution in ([\ref=kibble]) is due to Kibble [\cite=kibble] and is often referred to as "Wicksell-Kibble bivariate gamma distribution" [\cite=contbivar]. As stated in various articles and monographs (e.g. [\cite=mardia]), the marginal densities fM, fU of M and U, respectively, are given by

[formula]

The equations in ([\ref=marginaldensities]) and ([\ref=marginaldensities2]) imply that M and U are gamma distributed random variables with a common shape parameter α and with means and variances given by α  /  λm, α  /  λu and α  /  λ2m, α  /  λ2u, respectively. The restriction to a common shape parameter ensures that all measured signal intensities refer to probability density functions sharing the same basic form. On the other hand, the unequal rate parameters λm and λu guarantee sufficient flexibility in modeling the differences in the marginal densities of M and U (see ([\ref=prresp]) and ([\ref=prresp2])). It can further be shown that the Pearson correlation of M and U is equal to ρ, implying that ([\ref=kibble]) imposes a correlation structure on the two signal intensities (see [\cite=contbivar]).

In the next step, the distribution of the ratio b  =  M  /  (M  +  U) is derived:

Proposition 1. Let the distribution of (M,U) be defined by the probability density function in ([\ref=kibble]). Then the ratio b  =  M  /  (M  +  U) follows a univariate distribution with probability density function

[formula]

Proof: The proof of Proposition 1, which is related to the work of Nadarajah and Kotz [\cite=jscs], is given in the appendix.

The result stated in Proposition 1 can be used to derive the log-likelihood function of a sample of beta values [formula]:

Proposition 2. For independent sample values [formula], the log-likelihood function derived from ([\ref=ratiodensity]) is given by

[formula]

where θ: = λm  /  λu.

Proof: See appendix.

Proposition 2 implies that the log-likelihood function derived from ([\ref=ratiodensity]) is a function of the mean ratio [formula].

To quantify the associations between the covariates [formula] and the signal intensities M and U, we consider linear predictors [formula] and [formula], [formula], that relate the vector [formula] to the marginal means α  /  λm and α  /  λu, respectively. A convenient link function that guarantees the positivity of λm and λu is the logarithmic transformation, resulting in the predictor-response relationships

[formula]

with [formula] and [formula]. Note that the term log (α) can be incorporated into the intercept terms of the coefficient vectors [formula] and [formula]. The model equations in ([\ref=prresp]) and ([\ref=prresp2]) are therefore in line with traditional univariate gamma regression approaches that relate the log-transformed mean of the response variable to a linear function of the predictors.

Defining [formula], the mean ratio [formula] can be written as [formula], and the log-likelihood function of a sample [formula] becomes

[formula]

Equations ([\ref=prresp]) to ([\ref=LLboost]) define a statistical model in which the association between the methylation status b and the covariates [formula] is quantified by the coefficient vector γ. If γk  =  0, [formula], the predictor-response relationships in ([\ref=prresp]) and ([\ref=prresp2]) imply that ζkm  =  ζku and [formula] (provided that the values of the other covariates remain constant). Hence, if γk  =  0, the k-th covariate Xk has the same effect on both M and U, implying that Xk is not associated with the methylation status at the CpG site under consideration. On the other hand, large values of |γk| result from large differences in the coefficients ζkm and ζku, implying that DNA methylation varies greatly with the value of Xk. Assessing the hypotheses "H0:γk  =  0 vs. H1:γk  ≠  0" is therefore equivalent to a statistical test on the association between b and Xk.

Estimation and Hypothesis Tests

To obtain a consistent estimator of the coefficient vector γ, the log-likelihood function in ([\ref=LLboost]) needs to be maximized over both γ and the hyperparameters α and ρ. To this purpose, we propose the application of a gradient boosting algorithm with linear base-learning functions, as described in [\cite=bh]. For given data [formula], gradient boosting is a generic optimizer that minimizes a risk function [formula] over an unknown prediction function [formula], with the only requirement being the existence of the derivative ∂R  /  ∂f [\cite=hothornMiM]. Because the base-learning functions are chosen to be linear in [formula], the space of the prediction function f is restricted to the subspace defined by [formula], implying that estimation of f reduces to the estimation of the coefficient vector γ (see [\cite=mboost] for a detailed description of the algorithm). Furthermore, gradient boosting allows for the additional estimation of the hyperparameters α and ρ [\cite=schmid2010]. Maximum likelihood (ML) estimates of γ, α and ρ can therefore be obtained by setting R equal to the negative of the log-likelihood in ([\ref=LLboost]) and by running gradient boosting until convergence.

By standard maximum likelihood arguments, the hypotheses "H0:γk  =  0 vs. H1:γk  ≠  0" can be investigated by plugging the ML estimates [formula], [formula] and [formula] in the observed information matrix [formula] and by calculating the test statistic

[formula]

where J- 1kk denotes the k-th diagonal element of J- 1. Under the null hypothesis, Zk is asymptotically standard normally distributed as n  →    ∞  . Details on the calculation of J are given in the appendix.

Discussion

The development of statistical models to analyze DNA methylation is the subject of intense and ongoing research [\cite=park1] [\cite=zheng] [\cite=dolz] [\cite=bmc3]. In this paper, we proposed a likelihood-based approach to analyze and infer the associations between covariates and methylation levels in Illumina 450k data. In contrast to beta regression, the proposed RCG model accounts for possible correlations between methylated and unmethylated signal intensities, thereby increasing the flexibility of the model in describing the distribution of methylation levels at individual CpG sites.

The use of a gradient boosting algorithm to optimize the parameters of the RCG model lays the ground for a variety of additional modeling options. For example, it is straightforward to account for nonlinear covariate effects and to extend the linear predictor in ([\ref=LLboost]) by a set of spline functions. Furthermore, it is possible to embed the RCG model in the GAMLSS framework [\cite=gamlss2005] and to increase its flexibility by relating the parameters α and ρ to separate linear or additive predictors. For details, see [\cite=gamboostLSSMayr] and [\cite=gamboostLSSHofner].

Appendix

Proof of Proposition 1

We start with a lemma on the properties of the modified Bessel function of the first kind of order ν: = α - 1.

Lemma 1: For α̃  +  ν > 0 and p > c it holds that

[formula]

where [formula] is the Gauss hypergeometric function (see [\cite=jscs], p. 350). For a formal proof of Lemma 1, see [\cite=prudnikov].

The proof of Proposition 1 is obtained by deriving the joint density function fR,b of the random variables R: = M + U and b = M  /  (M + U) = M / R. Transforming (M,U)  =  (Rb,R(1 - b)) into (R,b) yields the Jacobian matrix

[formula]

with [formula]. It follows that, under the assumptions of Proposition 1,

[formula]

Defining

[formula]

the marginal density function fb(b) is derived by integrating fR,b over R:

[formula]

Setting

[formula]

and making use of the fact that

[formula]

one obtains by application of Lemma 1 that

[formula]

Combining ([\ref=Wdens1]) and ([\ref=proofProp2Zb]) yields the probability density function stated in Proposition 1.

Proof of Proposition 2

Defining θ: = λm  /  λu, the log-likelihood function derived from of Equation (9) of the manuscript becomes

[formula]

Derivation of the Observed Information Matrix

Defining [formula] and [formula], the first derivative of Equation (13) of the manuscript w.r.t. γ is given by

[formula]

It follows that the observed information matrix is given by

[formula]