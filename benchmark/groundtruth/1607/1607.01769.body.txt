=1

Detecting patchy reionization in the CMB

Introduction

On large angular scales ([formula]), anisotropy in the cosmic microwave background is mainly sourced by fluctuations at redshift z  ≈  1100. On smaller angular scales ([formula]), this "primary" anisotropy is exponentially suppressed, and CMB fluctuations are mainly a mixture of several "secondary" or late-time effects.

Among secondary effects with the same blackbody spectrum as the primary CMB, the largest are gravitational lensing, and the kinematic Sunyaev-Zel'dovich (kSZ) effect. The kSZ effect refers to Doppler shifting of CMB photons as they scatter on radially moving inhomogeneities in free electron density [\cite=Ostriker:1986fua] [\cite=Sunyaev:1980vz] [\cite=Sunyaev:1972eq]. The kSZ anisotropy can be roughly decomposed into a "late-time" contribution from redshifts [formula], when inhomogeneities are large due to gravitational growth of structure, and a "reionization" contribution from redshift z  ~  7, when the ionization fraction is expected to be inhomogeneous during "patchy" reionization [\cite=Battaglia:2012im] [\cite=McQuinn:2005ce] [\cite=Park:2013mv] [\cite=Alvarez:2015xzu] [\cite=Zahn:2011vp].

In Fig. [\ref=fig:cltt] we compare contributions to the temperature power spectrum CTTl from weak lensing of the CMB, late-time kSZ, and reionization kSZ, in a fiducial model to be described shortly. Individually, these three contributions are very interesting. Gravitational lensing depends on cosmological parameters such as neutrino mass [\cite=Lewis:2006fu], late-time kSZ probes the distribution of electrons in dark matter halos as well as the large-scale velocity field, and reionization kSZ may provide the first observational window on patchy reionization, which will shed light on the formation of first stars and other sources of ionizing photons. Although the total power spectrum will soon be measured very precisely at high l [\cite=Calabrese:2014gwa], it is unclear how well these signals can be disentangled, since all three components have large astrophysical modelling uncertainties, and the two kSZ contributions are essentially degenerate at the power spectrum level.

In this paper we will propose a higher-order statistic which isolates the kSZ signal, and moreover gives information about its source redshift dependence, allowing the late-time and reionization kSZ to be separated. This will complement measurements from future 21cm experiments [\cite=Furlanetto:2015apc] [\cite=Morales:2009gs]. We describe the intuitive idea here, with a more formal description in the next section.

We first recall that to a good approximation, the kSZ power spectrum may be written as an integral [\cite=Ma:2001xr]:

[formula]

where Pe(k,z) is the free electron power spectrum, 〈v2r〉  =  〈v2〉 / 3 is the mean squared radial velocity, and χ(z) is the comoving distance to redshift z. The radial weight function Q(z) is given by

[formula]

where d / dz is the optical depth per unit redshift.

Throughout the paper we will use the following notation frequently. Let q be the sky-averaged small-scale power spectrum in a fixed high-l band (say 3000  ≤  l  ≤  5000). For each direction [formula] on the sky, let [formula] be the locally measured small-scale power spectrum near sky location [formula]. The precise definitions of q and [formula] will be given in the next section.

It is intuitively clear that [formula] will be better approximated by using the actual realization of [formula] along the line of sight in direction [formula] in the integral in Eq. ([\ref=eq:clksz_integral]), rather than the cosmic average 〈v2r〉. This leads to anisotropy in [formula] on large angular scales.

To estimate the level of anisotropy, suppose we divide the line of sight into segments of size 50 Mpc (the coherence length of the velocity field), and roughly model the radial velocity vr as an independent Gaussian random number in every segment. Since the line of sight is 104 Mpc in length, [formula] can be roughly modelled as the sum of squares of N = 200 independent Gaussians. This suggests that fluctuations in [formula] between different lines of sight are of fractional size [formula]. Rephrasing, if we measure the CMB in two regions of sky separated by more than ~  1 degree, so that the lines of sight sample independent realizations of the velocity field, the kSZ power spectra will differ by ≈  10%. This is a large non-Gaussian effect which is not present for lensing and other secondaries, allowing statistical separation of the kSZ signal.

In fact we can go further by considering CKKL, the angular power spectrum of [formula]. Suppose we write CKKL as a sum of contributions from multiple source redshift bins. In the next section we will show (Fig. [\ref=fig:clkk_model]) that the contribution from redshift z has a broad peak at wavenumber L*  ~  k*χ(z), where k*  ≈  0.01 h Mpc- 1. Thus the shape of CKKL is source redshift dependent. In the general case where CKKL is a sum over redshift bins, we can "deconvolve" the observed CKKL to infer the contribution from each bin, thus separating the late-time and reionization kSZ signals. The main advantage of this method (compared to an analysis based on CTTl) is its robustness: we can make statements about reionization which do not depend on precise modelling of the other contributions.

Modelling the signal

We use the following fiducial model for the kSZ power spectrum and its source redshift distribution. We model the late-time kSZ using Eq. ([\ref=eq:clksz_integral]) with Pe(k,z)  =  W(k,z)2Pnl(k,z), where Pnl is the nonlinear matter power spectrum from CAMB [\cite=Lewis:1999bs], and we have defined

[formula]

where D(z) is the growth function normalized to D(z)  =  1 / (1 + z) at high z. This form of W(k,z) is a simple fitting function which gives approximate agreement with the "cooling + star formation" model from [\cite=Shaw:2011sy], for both CkSZl and dCkSZl  /  dz. The prefactor 0.85 assumes that at late times, 15% of electrons are in the neutral medium or stars [\cite=Fukugita:2004ee].

We model the reionization kSZ by assigning a Gaussian redshift distribution to the simulated kSZ power spectrum from Battaglia et al [\cite=Battaglia:2012im]:

[formula]

where (zre,σre)  =  (8.8,1.0).

We now give a formal definition of the quantities q and [formula] from the introduction. First fix a filter WS(l), and define a high-pass filtered CMB in Fourier space by [formula]. Unless otherwise specified, we choose [formula], where Ctotl is the total CMB power spectrum, including instrumental noise. We then define [formula] by squaring in real space, and define q to be the all-sky average q  =  〈K(n)〉. We note that

[formula]

so that q can be interpreted as average high-l power (with W2S-weighting) and [formula] can be interpreted as "locally measured high-l power near [formula]".

Our main statistic will be CKKL, the "power spectrum of the power spectrum". Note that there are two scales, a small scale [formula] selected by the filter WS where the CMB is measured, and a large scale [formula] where clustering in the small-scale power is measured. Viewed as a four-point estimator in the CMB, CKKL sums over quadruples [formula] which are "collapsed", in the sense that the CMB wavenumbers [formula] are large, but the intermediate wavenumber [formula] is small. This is similar to CMB lens reconstruction, where the lensing potential [formula] and its power spectrum CφφL are estimated on large scales using CMB temperature fluctuations on scales l  ≫  L.

Continuing the analogy with lens reconstruction, we define the reconstruction noise NKKL to be the value of CKKL that would be obtained if the small-scale temperature were a Gaussian field. A short calculation gives:

[formula]

In the regime L  ≪  l of interest, NKKL is nearly constant in L.

Now we would like to model the effect described in the previous section: large-scale non-Gaussian contributions to CKKL due to correlated radial velocities along the line of sight. We introduce a simple model, the "η-model", as follows.

We write the sky-averaged small-scale power spectrum qkSZ as an integral [formula], where

[formula]

and our fiducial model for dCkSZl / dz was given in Eqs. ([\ref=eq:clksz_integral]), ([\ref=eq:Wkz]), ([\ref=eq:dcltt_dz_rei]). The η-model is the ansatz that, in a fixed realization of the radial velocity field [formula], the locally measured small-scale power [formula] can be modelled as

[formula]

where [formula]. In other words, we assume that the locally generated kSZ power along the line of sight is proportional to v2r, but neglect additional non-Gaussian effects. Fully characterizing kSZ non-Gaussianity on all scales is outside the scope of this paper. Here we are simply claiming that at minimum, the non-Gaussian signal predicted by Eq. ([\ref=eq:K_eta]) must exist.

In the Limber approximation, the contribution to CKKL predicted by the η-model is

[formula]

where [formula] is the power spectrum of the field η evaluated at a wavenumber [formula] perpendicular to the line-of-sight direction. We will compute [formula] in linear theory, where it is independent of z, but depends on the direction of [formula] since η is an anisotropic field. By a short calculation using Wick's theorem, [formula] is given by

[formula]

where Pv is the linear velocity power spectrum and kr = 0 has been assumed.

In Fig. [\ref=fig:clkk_model] we show the contributions to CKKL from late-time and reionization kSZ, computed using the η-model. Note that the reionization kSZ makes a larger contribution to CKKL than the late-time kSZ, even though the two are comparable in the CMB power spectrum CTTl. This is because the late-time line-of-sight integral is more extended in comoving distance χ, so it samples more coherence lengths of the velocity field, making the signal more Gaussian.

A crucial property of the η-model is that the contribution to CKKL from source redshift z is proportional to [formula], with no additional L dependence. Thus the "shape" in L depends only on large-scale linear theory, but the overall amplitude depends on small-scale physics (via dq / dz).

This independence of small-scale physics means that we can test the η-model using simplified simulations. We construct an ensemble of 3D simulations neglecting baryonic physics and using the 2LPT approximation to the N-body equations of motion. Rather than using a lightcone geometry, we simply project a z = 2 snapshot onto the 2D periodic "sky" formed by one of the box faces. The agreement with the η-model is excellent (Fig. [\ref=fig:clkk_sims] top panel). We plan to extend this simulation pipeline in future work, but expect that more accurate simulations will simply change the overall amplitude, and capture small effects such as curved-sky corrections and deviations from the Limber approximation.

So far we have considered contributions to CKKL from the η-model (our signal), and from Gaussian mode-counting (the noise NKKL). In order to claim that the signal is robust, it is important to understand how other non-Gaussian effects may contribute to CKKL.

Some non-Gaussian signals do not cluster on large scales. For example, even after multifrequency analysis, the CMB maps will be contaminated by residual thermal SZ clusters at some level. This signal can be modelled very accurately as a sum of unclustered Poisson sources with angular profile Fl. On large scales L where the profile FL is nearly constant, a short calculation shows that the contribution to CKKL is nearly constant in L. We will account for this type of contribution by marginalizing an arbitrary constant δCKKL in our signal-to-noise forecasts.

Other non-Gaussian signals do cluster on large scales, most importantly gravitational lensing. In the middle panel of Fig. [\ref=fig:clkk_sims], we show the bias to CKKL obtained from simulated CMB lensing maps, using a pipeline similar to [\cite=BenoitLevy:2012va]. The lensing bias is comparable to the reconstruction noise and non-constant on large scales.

However, we have found that CKKL can be "lens-cleaned" as follows. Let us make the ansatz that on large scales, lensing produces terms in [formula] proportional to the local lensing convergence κ and squared CMB gradient [formula]:

[formula]

We lens-clean K on large scales by constructing template maps [formula] and κ, and subtracting best-fit multiples of the templates from [formula] before computing CKKL. Our template [formula] map is made by low-pass filtering to [formula] and squaring. We assume that a template map of κ is also available in the survey region from CMB polarization lens reconstruction (a detailed forecast shows that κ has high signal-to-noise for noise levels [formula] μK-arcmin).

Remarkably, this simple template-cleaning procedure removes nearly all lensing power in simulation (Fig. [\ref=fig:clkk_sims] middle panel). Furthermore the residual power is constant in L, so that it is removed by our previously mentioned marginalization. We therefore expect that CMB lensing bias to CKKL can be made negligible.

Next we would like to consider clustered secondaries. One type of non-Gaussian contribution is "δ-modulated power": power along the line of sight whose amplitude is linear in the local overdensity [formula]. Schematically, we write:

[formula]

where β(z) is a linear bias parameter which relates the small-scale CMB power along the line of sight to the local density. This type of model, in conjunction with the Poisson and Gaussian terms previously considered, is often used to model large-scale clustering of small-scale modes (e.g. [\cite=Takada:2013bfn] [\cite=Mohammed:2014lja] [\cite=Baldauf:2015vio]).

We will study δ-modulated power from three sources: the late-time kSZ, reionization kSZ, and residual CIB. The model predicts the following contribution to CKKL:

[formula]

so in each of the three cases, we will need to know the redshift distribution dq / dz of the small-scale power, and the bias-like parameter β. Considering dq / dz first, our fiducial model for the kSZ has already been described, and for the CIB we conservatively assume residual contamination with total power spectrum equal to the late-time kSZ, and Gaussian redshift distribution with (,σz)  =  (2,1).

Considering β next, assigning precise values would require dedicated simulations beyond the scope of this paper, but we will make rough estimates as follows. In the limit of high l, the kSZ power spectrum is 1-halo dominated (or during reionization, 1-bubble dominated). In this limit, the locally generated kSZ power is simply proportional to the number density of sources, and therefore the parameter β is equal to the usual linear bias b. For the late-time kSZ and CIB, we will take β  ≈  1.5 as a fiducial value. For the reionization kSZ, we will take β  ≈  6, a typical bubble bias from simulations [\cite=Alvarez:2005sa].

In Fig. [\ref=fig:clkk_sims], bottom panel, we show the clustering contributions to CKKL from δ-modulated late-time kSZ, reionization kSZ, and residual CIB. In all three cases, the modelling is approximate but should give a rough estimate for the size of the non-Gaussian clustering effect. We find that the clustering terms are small compared to our main signal plus reconstruction noise, and have fairly different L-dependence so that there is little degeneracy. This result makes intuitive sense: clustering terms proportional to Pv dominate on large scales, since terms proportional to Pδ are suppressed by positive powers of k. It is also consistent with the excellent agreement between the η-model and the 3D simulations seen in the top panel of Fig. [\ref=fig:clkk_sims].

In summary, the η-model predicts a large kSZ signal in CKKL, that this prediction agrees with simulations, and that it is robust to a wide range of possible contaminants.

Forecasts and discussion

In this section, we will present signal-to-noise forecasts. The first type of forecast we will consider is "single-bin detection": total signal-to-noise of the kSZ CKKL summed over all source redshifts, marginalized over an arbitrary constant δCKKL as previously described. In our fiducial model, a single-bin detection would get 86% of its signal-to-noise from reionization and 14% from the late-time kSZ. Therefore a single-bin detection of CKKL at the expected level would be strong evidence for patchy reionization in the CMB.

The next observational milestone would be a "two-bin detection", in which we fit for the overall amplitude of the high-z signal (z  ≥  4), marginalized over an arbitrary multiple of the low-z contribution (z  ≤  4). A two-bin detection would measure the amplitude of the patchy reionization signal without any assumptions on the low-z amplitude.

Finally, we consider a "three-bin detection": detection significance of the z  ≥  5 contribution, marginalized over independent redshift bins with 0  ≤  z  ≤  2.5 and 2.5  ≤  z  ≤  5. A three-bin detection would establish the bimodal redshift dependence of the kSZ sources, with peaks at late time and during reionization, and little or no power in between, which would also provide a powerful check on systematics.

The precise definitions are as follows: given N contributions (δCKKL)1, [formula], (δCKKL)N to CKKL such that [formula] (for example N redshift bins), we forecast signal-to-noise on the amplitudes Ai by computing the N-by-N Fisher matrix

[formula]

The signal-to-noise of (δCKKL)i, marginalizing over signals j  ≠  i, is given by S / N  =  (F- 1ii)- 1 / 2. The significance of our "N-bin detection", where N = 1,2,3, is defined to be the signal-to-noise of the highest redshift bin, taking (CKKL)tot to be the sum of contributions from the lower redshift bins plus reconstruction noise, and marginalized over the other redshift bins plus a contribution of the form δCKKL  =  . The maximum multipole L max in Eq. ([\ref=eq:fisher]) will depend in practice on the extent to which secondary contributions to CKKL can be modelled as L increases. As a fiducial value, we have used L max = 300 here.

In Fig. [\ref=fig:forecast] we show forecasted signal-to-noise as functions of instrumental noise level and beam size. These results include improvements from a generalization of the Fisher matrix in Eq. ([\ref=eq:fisher]) in which multiple K-fields are defined corresponding to bins in CMB wavenumber l. However, we find that the only case where this significantly improves signal-to-noise is the three-band detection with [formula].

It is seen that the signal-to-noise is a steep function of noise level, favoring a deep small-field observing strategy. However, for surveys smaller than a few hundred square degrees, there is a signal-to-noise penalty beyond the simple fsky scaling in Fig. [\ref=fig:forecast], since CKKL cannot be measured on super-survey scales L  ≤  L min  =  (2π  /  θsurv). This signal-to-noise penalty ranges from 5-10% for a 1000 deg2 survey, and 25-50% for a 100 deg2 survey, depending on the noise level and forecast chosen.

Including this penalty, some example surveys which achieve N-bin detections are as follows. A 3σ one-bin detection can be achieved by a survey with area A = 500 deg2, noise ΔT  =  4 μK-arcmin, and beam θFWHM = 1.4 arcmin. Likewise two-bin and three-bin 3σ detections can be achieved by surveys with (A,ΔT,θFWHM)  =  (900,3,1) and (2400,2,1) respectively. An ambitious future survey with 1 μK-arcmin noise, 1 arcmin beam, and fsky = 0.5 can achieve 1-bin, 2-bin, and 3-bin detections with significance 279σ, 44σ, and 16σ.

In this paper, we have identified a new non-Gaussian signal in the CMB which is a distinctive observational signature of the kSZ effect. It should soon be detectable, and an exciting milestone will be a "clean" detection of patchy reionization, with minimal assumptions on modelling of other CMB secondaries. Future experiments such as CMB-S4 will have sufficient signal-to-noise to measure the signal with more granularity and constrain the redshift and wavenumber dependence of the kSZ sources, opening up a qualitatively new observational window on the epoch of reionization.

Acknowledgements. We thank Joel Meyers and Alex van Engelen for discussions and initial collaboration. We are also grateful to Nick Battaglia, Emmanuel Schaan and David Spergel for discussion. KMS was supported by an NSERC Discovery Grant and an Ontario Early Researcher Award. SF was supported by the Miller Institute at the University of California, Berkeley. Some computations were done on the Scinet cluster at the University of Toronto. Research at Perimeter Institute is supported by the Government of Canada through Industry Canada and by the Province of Ontario through the Ministry of Research & Innovation.