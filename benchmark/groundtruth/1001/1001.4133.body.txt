Lemma

Remark

Lower bounds on the lengths of double-base representations

Introduction

A {2,3}-integer is a positive or negative integer with no prime divisors other than 2 or 3. A length-r double-base representation of an integer n is an expression [formula], where each summand is a {2,3}-integer. Double-base representations were introduced by Imbert, Mishra, and the first author  to help speed the calculation of large multiples of points on elliptic curves. (An earlier version of the double-base number system, using only positive summands, was used by Jullien, Miller, and the first author [\cite=DJM1998] for modular exponentiation.) In this paper we will be concerned not with the practical applications of double-base representations , but rather with number-theoretic questions arising from their study.

The span s(n) of an integer n is the smallest r such that n has a double-base representation of length r. Note that if an integer has a double-base representation of length r > 0, then it also has a double-base representation of length r + 1; to see this, simply replace a summand ni in a length-r representation with the expression 3ni  -  2ni. Thus, a positive integer has double-base representations of every length greater than or equal to its span.

It is already known  that s(n)  =  O( log n /  log  log n). Our first result gives a lower bound for the growth of s(n).

There is a constant c > 0 such that for infinitely many values of n we have

[formula]

For each i  >  0, let S(i) denote the smallest positive integer with span i. Clearly S(1)  =  1 and S(2)  =  5. The fact that S(3)  =  103, which can be proven through the use of a result of Ellison [\cite=Ellison], is stated in [\cite=DIM2008]. Furthermore, it is conjectured in [\cite=DIM2008] that S(4)  =  4985. Methods related to those we use in the proof of Theorem [\ref=T:growth] allow us to compute the values of S(i) for i  ≤  6.

We have

[formula]

The proofs of both theorems rely on finding integers m such that the reduction modulo m of the set of {2,3}-integers is a very small subset of [formula]. We make this notion precise and prove Theorem [\ref=T:growth] in Section [\ref=S:growth]. In Section [\ref=S:primitive] we introduce the idea of a doubly-primitive double-base representation and we show that the problem of determining whether an integer has a length-r double-base representation is equivalent to determining whether certain other related integers have doubly-primitive representations of various lengths. In Section [\ref=S:sparse] we find several moduli m that are useful in producing proofs that integers do not have doubly-primitive representations of lengths up to 5. Finally, in Section [\ref=S:spans] we use the moduli produced in Section [\ref=S:sparse] to prove Theorem [\ref=T:spans].

Our proof of Theorem [\ref=T:spans] depends on computer calculations. The programs we used, some written in Magma [\cite=magma] and some in C, can be found on the second author's web site: start at

and follow the links related to this paper.

In a recent paper [\cite=AHL2009], Ádám, Hajdu, and Luca study the set of integers that can be expressed in the form [formula], where k is fixed, the coefficients ai are integers taken from a fixed finite set A, and the si are integers that are S-units for some fixed finite set S of primes. In the special case where S  =  {2,3} and A  =  {1, - 1}, the set they study is exactly the set of integers of span at most k. They, like us, use a result of Erds, Pomerance, and Schmutz [\cite=EPS1991] to find auxiliary moduli m for which the image of the set of S-units in [formula] is small. However, their interest lies in computing upper bounds for the density of such sets, while ours lies in producing lower bounds on the spans of individual integers -- and, of course, in computing actual values of s(n) and S(n).

Proof of Theorem [\ref=T:growth]

For each positive integer m we let T(m) be the image in [formula] of the set of {2,3}-integers, and we let t(m) denote the cardinality of T(m). For every r  ≥  2 we define the expected degree-r density Dr(m) of m to be the smaller of 1 and

[formula]

Suppose r  ≥  2 and m is an integer whose expected degree-r density is less than 1. Then not every element of [formula] can be expressed as a sum of r elements of T(m).

There are [formula] ways of choosing r elements from T(m) with repetition, so there are at most this many sums of r elements of T(m). If Dr(m) is less than 1, then the number of such sums is less than m, so some element of [formula] is not such a sum.

Recall that the Carmichael function λ is the function that assigns to each integer m  ≥  1 the exponent of the multiplicative group [formula]. Using [\cite=APR1983]*Prop. 10, p. 201, Erds, Pomerance, and Schmutz show [\cite=EPS1991]* that there is a constant d > 0 such that there are infinitely many squarefree m such that

[formula]

We will prove Theorem [\ref=T:growth] with c  =  1 / (3d).

We note for future reference that the function log x  /  ( log  log x log  log  log x) is increasing for x  ≥  12006, and that every integer n  <  12006 has a double-base representation of length 4 or less (see Section [\ref=S:spans]).

Let m be one of the infinite number of squarefree integers that satisfy equation [\eqref=EQ:EPS] and for which we also have

[formula]

Since m is squarefree, there are at most λ(m)  +  1 distinct powers of 2 in [formula] and at most λ(m)  +  1 distinct powers of 3 in [formula]. It follows that

[formula]

Let r  =  ⌊c log m  /  ( log  log m log  log  log m)⌋, so that r  ≥  4. Then

[formula]

so by Lemma [\ref=L:density] there is a nonnegative integer n  <  m such that the image of n in [formula] cannot be written as the sum of r elements of T(m). It follows that

[formula]

(The final inequality depends on the fact that n  ≥  12006, but we know that n  ≥  12006 because the span of n is at least r + 1  ≥  5.)

Primitive representations

Let [formula] be a length-r double-base representation of an integer n. We say that the representation is primitive if the greatest common divisor of the ni is 1; we say that the representation is doubly primitive if one of the ni is not divisible by 2 and a different ni is not divisible by 3. Note that a representation that is primitive but not doubly primitive must have one summand equal to ±  1, and all of the other summands must be divisible by 6.

Let r  ≥  2. An integer n has a double-base representation of length r if and only if at least one of the following four statements holds:

n has a doubly primitive representation of length r.

n + 1 is divisible by 6 and (n + 1) / 6 has a representation of length r - 1.

n - 1 is divisible by 6 and (n - 1) / 6 has a representation of length r - 1.

There is a {2,3}-integer d  >  1 that divides n such that n / d has a primitive representation of length r.

Suppose n has a length-r representation [formula]. If the representation is doubly primitive, then statement (1) holds. If the representation is primitive but not doubly primitive, then either statement (2) or statement (3) holds. If the representation is not primitive, then statement (4) holds, where we take d to be the greatest common divisor of the ni.

The converse is clear.

It is easy, of course, to determine whether a positive integer has a length-1 double-base representation.

By recursion, we see that a proof that an integer n has no length-r representation can be constructed from proofs that a number of integers (no larger than n) have no doubly primitive representations of certain lengths. Thus, in the following sections we will mostly focus on doubly-primitive representations.

Low-density moduli

To show that an integer n has no double-base representations of length r, we can find a modulus m with Dr(m)  <  1 and hope that n reduces to one of the elements of [formula] that cannot be written as a sum of r elements of T(m). As a practical matter, however, it is easier to use Lemma [\ref=L:reps] to reduce the problem to finding proofs that certain integers have no doubly-primitive representations; as we shall see, this allows us to use smaller moduli m.

For each positive integer m, we let T2(m) and T3(m) denote the images in [formula] of the sets {  ±  2i : i  ≥  0} and {  ±  3i : i  ≥  0}, respectively, and we let t2(m) and t3(m) denote the cardinalities of these two sets. We have already defined what a doubly-primitive representation of an integer is; now we define a doubly-primitive length-r representation of an element n of [formula] to be an expression

[formula]

where n1 lies in T2(m), n2 lies in T3(m), and all ni lie in T(m). For every r  ≥  2 we define the expected doubly-primitive degree-r density dr(m) of m to be the smaller of 1 and

[formula]

We leave the proof of the following lemma to the reader; it is similar to that of Lemma [\ref=L:density].

Suppose r  ≥  2 and m is an integer whose expected doubly-primitive degree-r density is less than 1. Then not every element of [formula] has a doubly-primitive length-r representation.

Suppose we have found an integer m with dr(m) < 1, and suppose we would like to prove that an integer n has no doubly-primitive length-r representation by showing that its image in [formula] has no doubly-primitive length-r representation. The next lemma, whose simple proof we omit, suggests an efficient way of checking the latter condition.

Let m > 0 and r  ≥  2 be integers. Define two subsets S1 and S2 of [formula] as follows: If r is odd, say r  =  2u  +  1, take

[formula]

if r is even, say r  =  2u, take

[formula]

Then an element n of [formula] has no doubly-primitive length-r representation if and only if the intersection [formula] is empty.

The work (and the amount of memory) required to compute the set intersection mentioned in the lemma is a nearly linear function of the sum of the sizes of the two sets S1 and S2. We can work out reasonable approximations for the sizes of these sets. If r = 2u + 1 is odd, we have

[formula]

and

[formula]

while if r = 2u is even, then

[formula]

and

[formula]

Based on these upper bounds, we approximate #  S1  +    #  S2 by the function

[formula]

Here is one method of finding values of m with low densities and small work estimates. Given integers a,b > 0, we write 2a  -  1  =  3xu with [formula] and 3b  -  1  =  2yv with [formula], and we take m  =  2y3x gcd (u,v). Then we compute the sets T2(m), T3(m), and T(m), and compute dr(m) and wr(m) for the desired value of r. In Table [\ref=Tbl:densities] we list several useful values of m that we obtained in this way, together with their densities and work factors for r = 2,3,4, and 5.

Proof of Theorem [\ref=T:spans]

Using the values of m given in Table [\ref=Tbl:densities], it is a simple matter to use Lemmas [\ref=L:reps] and [\ref=L:algorithm] to construct proofs that certain integers have spans greater than 2, 3, and 4. Magma code for doing this can be found in the file DoubleBase.magma, available at the URL mentioned in the introduction. The file also contains Magma code that verifies that every positive integer less than 103 has span at most 2, that every positive integer less than 4985 has span at most 3, and that every positive integer less than 641687 has span at most 4. Together, these programs confirm the values for S(3), S(4), and S(5) given in Theorem [\ref=T:spans].

The proof that S(6)  =  326552783 also depends on machine computation, but the work involved is large enough that we move from Magma to C.

For the rest of this section, we set

[formula]

Let T be the set of all {2,3}-integers, and let T2 and T3 be the subsets of T consisting of the elements whose only prime divisors are 2 and 3, respectively. We set

[formula]

Any number that can be written as the difference of an element of P and an element of S has span at most 5. The program SumOf5.c, available at the URL mentioned in the introduction, shows that every positive integer less than n is contained in P - S. (In fact, the program only looks at elements of P and S that have absolute value at most 2n and that are obtained from summands of absolute value at most 261.)

To show that n cannot be written as the sum of five {2,3}-integers, we use Lemmas [\ref=L:reps] and [\ref=L:algorithm]. The programs found in DoubleBase.magma can carry out all the necessary computations, except for the largest one: showing that n has no doubly-primitive representations of length 5. To carry out this step of the proof, we would like to show that the image of n in [formula] has no doubly-primitive representations of length 5. This is a slightly awkward computation on current desktop computers, because the modulus m does not fit into a 64-bit word. Instead, we find all doubly-primitive length-5 representations of the image of n in [formula]. This computation is done by the program Check5.c. Then we take the resulting list of mod-m0 representations and use the Magma program found in the file Check5.magma to see whether any of them can be lifted up to a mod-m representation. We find that none of the mod-m0 representations can be lifted to a mod-m representation, so n has no doubly-primitive representations of length 5.

Acknowledgment

The authors are grateful to Igor Shparlinski for informing them of the paper of Ádám, Hajdu, and Luca [\cite=AHL2009].