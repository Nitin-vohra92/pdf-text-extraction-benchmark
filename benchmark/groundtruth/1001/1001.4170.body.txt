Corollary Lemma Proposition Definition Conjecture Example

The sum of digits of n and n2

Introduction

Let q  ≥  2 and denote by sq(n) the sum of digits in the q-ary representation of an integer n. Recently, considerable progress has been made towards understanding the interplay between the sum-of-digits of some algebraically defined sequences, such as primes [\cite=MR09-1] and polynomials [\cite=DT06] or, in particular, squares [\cite=MR09-2]. In the latter, C. Mauduit and J. Rivat proved an asymptotic expansion of the sum of digits of squares [\cite=MR09-2] in arithmetic progressions. Their proof heavily relies on good estimates of quadratic Gauss sums. For the case of general polynomials p(n) of degree h > 2 there is still a great lack of knowledge regarding their distribution with respect to digitally defined functionals [\cite=DT06].

Several authors studied the pointwise properties and relationships of sq(p(n)), e.g., K. Stolarsky [\cite=St78], B. Lindström [\cite=Li97], G. Melfi [\cite=Me05], and M. Drmota and J. Rivat [\cite=DR05]. In particular, a conjecture of Stolarsky [\cite=St78] about some extremal distribution properties of the ratio sq(p(n)) / sq(n) has been recently settled by the authors [\cite=HLS10]. Melfi [\cite=Me05] proposed to study the set of n's such that s2(n2) = s2(n), and he obtained that

[formula]

Using heuristic arguments, Melfi conjectured a much stronger result that

[formula]

with [formula], giving an explicit formula for β. The aim of the present paper is to provide a generalization to general p(n) and base q of Melfi's result as well as to use the method of proof to sharpen Melfi's exponent in ([\ref=melfi]). Moreover, we provide a local analogon, i.e., getting a lower bound for the number of n's such that sq(n2) = sq(n) = k for some fixed k.

This result is given in Section [\ref=sec:mtheo3]. In the general case of q-ary digits and polynomials p(x), the bound (q - 1) / 2 in ([\ref=thm3estim]) cannot be improved. This is easily seen by recalling the well-known fact

[formula]

Indeed, if we set p(x) = (q - 1)x2 + x + a for a∈ then we find that

[formula]

which could be any of [formula] depending only on the choice of a.

The method of proof of Theorem ([\ref=mtheo3]) allows to improve on Melfi's result ([\ref=melfi]).

Following on Melfi's paper [\cite=Me05], we examine the case when p(n)  =  n2 and q = 2 in more detail. We consider the set of all n's such that s2(n)  =  s2(n2), and partition the set into the subsets dependent upon the value of s2(n). By noticing that s2(n)  =  s2(2n) and s2(n2)  =  s2((2n)2) we see that we can restrict our attention to odd n. This was done by explicit computation of all such n which are given in Tables [\ref=tab:k=1..7] and [\ref=tab:k=8]. A discussion of how these computations were made is given in Section [\ref=sec:mtheo4].

Based on these initial small values of k, one might expect that this is always true. Let

[formula]

be written in base 2. Then s2(n)  =  s2(n2)  =  12 for all r  ≥  8. This is in fact a special case of a more general property. The proof of this result is given in Section [\ref=sec:mtheo5]. Despite of great effort we are not able to decide the finiteness problem in the remaining cases k∈{9,10,11,14,15}. However, we will comment on some heuristic evidence that it seems unlikely that there are infinitely many solutions in the cases k = 9 and k = 10, respectively, in Section [\ref=sec:comp2].

Somewhat surprisingly, a similar answer can be given if q  ≥  3.

We show this result in Section [\ref=sec:genqsquares].

Proof of Theorems [\ref=mtheo3] and [\ref=mtheo3+]

Following Lindström [\cite=Li97] we say that terms are noninterfering if we can use the following splitting formulæ:

For 1  ≤  b < qk and a,k  ≥  1,

[formula]

See [\cite=HLS10].

Proof of Theorem [\ref=mtheo3]: The proof uses a construction of a sequence with noninterfering terms which has already been used in [\cite=HLS10]. However, to obtain the bound Nγ in ([\ref=thm3estim]) instead of a logarithmic bound, we have to make a delicate refinement. To begin with, define the polynomial

[formula]

where m∈. Set m = ql - r with 1  ≤  r  ≤  ⌊qαl⌋, [formula] and 0 < α < 1. Obviously, for α < 1 there exists l0(α) such that for all l > l0(α) we have m  ≥  3. Furthermore let k be such that qk > m. By consecutively employing ([\ref=splitpos]) and ([\ref=splitneg]) we see that

[formula]

First consider the easier case of monomials p(n) = nh, h  ≥  2 where we can give a somewhat more direct proof. We have

[formula]

From [\cite=HLS10] we have that tm(x)h has only positive coefficients, which are bounded by (2mh)h. This means that sq(tm(qk)h) does not depend on k if k is sufficiently large (see ([\ref=splitpos])). More precisely, if qk > (2mh)h (note that a sufficient condition for this is k  ≥  (h + 1)l) then we get for sufficiently large l and a symmetry argument for the coefficients of tm(x)h,

[formula]

Consider the first summand sq(mh) in ([\ref=lowbound]). We have

[formula]

which shows that mh is a polynomial in ql with coefficients of alternating signs. Now there are exactly ⌊h / 2⌋ negative signs in this expansion. All coefficients in ([\ref=mhexpand]) are bounded in modulus by

[formula]

and in turn their q-ary sum of digits is less than sq(dj)  ≤  (q - 1)(αl + 1)h. Therefore, by ([\ref=splitneg]), we get that for fixed α < 1 / h and sufficiently large l we have

[formula]

A similar argument can be applied to the other three summands in ([\ref=lowbound]). This yields

[formula]

Therefore, for each sufficiently large l we can find k with

[formula]

provided that k  ≥  (h + 1)l and

[formula]

Note that these conditions allow to successively increase k (see ([\ref=crx])) in order that sq(tm(qk)) and sq(tm(qk)h) differ by at most (q - 1) / 2. For sufficiently large l these two conditions translate into

[formula]

Take α = 1 / (5h2) < 1 / h. It is then a direct calculation to verify that ([\ref=alphacond]) is true for all h and sufficiently large l. Summing up, we have obtained that for sufficiently large l we can find ≫  qαl values r where we in turn can provide a value k with ([\ref=thm3estimk]). In addition, each triple (l,r,k) gives rise to a different value of tm(qk). We thus have ([\ref=thm3estim]).

Now consider the case of a general polynomial [formula]. There exist positive integers s1 and s2, both only depending on the polynomial p(x) such that

[formula]

has only positive coefficients. With the notation of ([\ref=cdefin]) we obtain

[formula]

First suppose h  ≥  4. By choosing s1 sufficiently large (this choice again only depends on p(x)) we get that the coefficients of xj in p(qs1tm(x) + qs2 + 1) with 4h - 7  ≤  j  ≤  4h are polynomials in m of degree h since we can avoid unwanted cancellation for these coefficients. The coefficients of these terms (as polynomials in m) are alternating in sign, since for h  ≥  4 and [formula] we have

[formula]

where dj,i,hdj + 1,i,h < 0 for all j with h - ⌊i / 2⌋  ≤  j < h. Setting m = ql - r we therefore can choose s1, s2 in the way that a'hc4h - i,h(m) + a'h - 1c4h - i,h - 1(m) as a polynomial in ql has ⌈h / 2⌉ negative coefficients for each [formula]. Now, for qs2 + 1 < qs1, we get by ([\ref=crx]) that

[formula]

In ([\ref=8terms]) we have therefore found eight summands sharing the property of the eight summands in the monomial case (see ([\ref=lowbound])). From this we proceed as as in the case of monomials to get the statement.

It remains to deal with the cases of general quadratic and cubic polynomials, where we cannot directly resort to ([\ref=i4h-i]) (note that 8 > (2h - 1) + 1 for h = 2,3). We instead do a more direct calculation. Let h =  deg p = 2 which is the case of quadratic polynomials. By suitably shifting the argument x  ↦  qs1x + qs2 + 1 we can arrange for a polynomial p(qs1x + qs2 + 1) = a'2x2 + a'1x + a'0 with a'2,a'1,a'0 > 0 and 2a'2 > a'1. Each coefficient of xi in p(qs1tm(x) + qs2 + 1), 0  ≤  i  ≤  8, is a function of m and of a'2,a'1 and a'0. In a similar way as before (here we use 9 summands instead of the 8 in the case of h  ≥  4) we obtain for sufficiently large l,

[formula]

Now we can choose k suitably to get the assertion. Finally, for a cubic polynomial, we are able to achieve p(qs1x + qs2 + 1) = a'3x3 + a'2x2 + a'1x + a'0 with a'3,a'2,a'1,a'0 > 0 and 3a'3 > a'2. Then, each coefficient of xi in p(qs1tm(x) + qs2 + 1), 0  ≤  i  ≤  12, is a function of m and a'3,a'2,a'1,a'0, and thus we get for sufficiently large l,

[formula]

By choosing k suitably, we obtain the result. This completes the proof of Theorem [\ref=mtheo3].

Proof of Theorem [\ref=mtheo3+]: We apply the method of proof of Theorem [\ref=mtheo3] to the special case q  =  2 and p(n)  =  n2. Instead of using the rather crude bounds, we here use exact values to get our result. To begin with, we observe that the largest coefficient (as m  →    ∞  ) of tm(x)2 is the coefficient of x4, namely 4m2 + 1. Therefore we get noninterfering terms when 2k  ≥  4m2 + 1. A sufficient condition for this is 2k  ≥  4  ·  22l = 22l + 2, or equivalently,

[formula]

On the other hand, the coefficients of x8 and x7 (resp. x1 and x0) in tm(x)2 are m2 and 2m2 which have the same binary sum of digits. Now assume α < 1 / 2 and l > l0(α) be sufficiently large. We then use Proposition [\ref=propsplit] and set m = 2l - r with 1  ≤  r  ≤  ⌊2αl⌋ to obtain

[formula]

for any 0 < ε < 1 / 2. This means that for any α < 1 / 2 we have ≫  qαl values r where we in turn can provide a value k satisfying ([\ref=thm3estimk]) which is due to

[formula]

This yields

[formula]

Hence, letting N  =  q(9 + 5ε)l we note that we have

[formula]

solutions to ([\ref=thm3estimk]). This finishes the proof.

Proof of Theorem [\ref=mtheo4]

The proof that there is only a finite number of odd n such that s2(n2)  =  s2(n)  ≤  8 is a strictly computational one. We discuss how our algorithm works.

Consider

[formula]

with [formula]. We have

[formula]

We therefore need to examine the exponents

[formula]

and the possible iterations between these exponents by carry propagation.

Clearly, 2r1 is the strict minimum within these exponents. Other relationships between exponents are not as clear. For example, r1  +  r3  +  1 could be less than, equal to, or greater than 2r2 depending on the choices of r3 and r2. Each of these cases must be examined in turn. Numerous of these inequalities have implications for the order of other exponents in the binary expansion of n2. So, once we make an assumption in our case by case analysis, this might rule out future possibilities. For example, if we assume that 2r3  <  1  +  r1  +  r4, then we have as a consequence that 1  +  r2  +  r3  <  1  +  r1  +  r4 (by noticing that r2  <  r3). In the case of equality we "group" terms. For example, if we assumed that 2r3  =  1  +  r2  +  r4, then we could, first, replace all occurrences of r2 with 2r3  -  1  -  r4, and second replace 22r3  +  21  +  r2  +  r4 by 22r3  +  1.

Our algorithm occasionally finds a solution set with fractional or negative values for ri, which is a contradiction. On the other hand, it is possible for the algorithm to find a solution, even if all of the exponents cannot be explicitly determined. This would happen if there is an infinite family of n with s2(n2)  =  s2(n)  =  k with some nice structure, (as is the case for k  =  12, see ([\ref=casek12])). The algorithm will detect, and report this. We used the method for k up to 8. For each of these values, there was only a finite number of n, and all of them are enumerated in Tables 1 and 2.

Proof of Theorem [\ref=mtheo5]

For the proof of Theorem [\ref=mtheo5], we first state some auxiliary results. Denote by (n)2 the binary representation of n, and 1(k) a block of k binary 1. We begin with the following key observation.

If there exists u and v such that s2(u)  +  s2(v)  =  s2(u2)  +  s2(uv)  +  s2(v2)  =  k, then for i sufficiently large, the numbers of the form (n)2  =  u0iv satisfy s2(n2) = s2(n) = k.

This follows at once from Proposition [\ref=propsplit], relation ([\ref=splitpos]).

We use Proposition [\ref=prop:infinite] to prove the following lemma.

Let (u)2  =  1(k1)01(n1) and (v)2  =  1(k2)01(n2). Assume that n1  ≥  k1 + 2, n2  ≥  k2 + 2 and n1  ≥  n2. Then

[formula]

and

[formula]

Let (U)2 = 1(k)01(n) with n  ≥  k + 2. Then U = 2n - 1 + 2n + 1(2k - 1) and we calculate

[formula]

Hence s2(U2) = n and therefore s2(u2) = n1 and s2(v2) = n2.

Now, consider s2(uv). We have

[formula]

We may assume that k1  ≥  k2. Then

[formula]

has s2(W) = k1. We distinguish three cases to conclude:

Let n1 = n2 + k2 + 1 and n2 = k1 + 1. Then uv = 1 + 2n2 + W and hence s2(uv) = k1 + 2.

Let n1 = n2 + k2 + 1 and n2 > k1 + 1. Then uv = 1 + 2n2 + W + 2n1 + k1 + 1(2n2 - k1 - 1 - 1) and hence s2(uv) = 2 + k1 + n2 - k1 - 1 = n2 + 1.

Let k1 = k2 = k and n1 > n2. Then uv = 1 + 2n2 + 2n1 + W + 2n2 + k + 1(2n1 - k - 1 - 1) - 2n1 + k + 1 and hence s2(uv) = 3 + k + n1 - k - 2 = n1 + 1.

This finishes the proof.

Let n1,n2,k1,k2 be positive integers with n1  ≥  k1 + 2, n2  ≥  k2 + 2 and u,v be as in Lemma [\ref=n1n2]. Let (N)2 = u0Rv be the binary representation of N where R  ≥  n1 + n2 + k1 + k2. By Proposition [\ref=prop:infinite] and Lemma [\ref=n1n2] we have for any R  ≥  n1 + n2 + k1 + k2,

[formula]

Let k  ≥  2. Taking k1  =  k2  =  k and n1 = n2 = 2k, we find from Lemma [\ref=n1n2] and 2k  ≥  k + 2 that

[formula]

implying there are infinite families of n such that s2(n) = s2(n2) = s for s of the form 6k with k  ≥  2.

Let k2 = 2,k1  ≥  3,n2 = k1 + 2 and n1 = n2 + k2 + 1 = k1 + 4. Then s2(uv) = n2 + 1 by Lemma [\ref=n1n2] implying s2(N2) = s2(N) = 3(k1 + 2) + 1. Hence there are infinite families of n such that s2(n) = s2(n2) = s for s of the form 3k + 1 with k  ≥  5.

Let k1  ≥  k2  ≥  3 and n2 = k1 + k2 - 1,n1 = n2 + k2 + 1. Then s2(uv) = n2 + 1 = k1 + k2 from Lemma [\ref=n1n2] implying s2(N2) = s2(N) = 3k1 + 4k2 - 1. Let k2 = 3. Then s2(N2) = s2(N) = 3(k1 + 3) + 2 for k1  ≥  3 giving infinite families of n such that s2(n) = s2(n2) = s for s of the form 3k + 2 with k  ≥  6.

Let k2 = 4. Then s2(N2) = s2(N) = 3(k1 + 5) for k1  ≥  4 giving infinite families of n such that s2(n) = s2(n2) = s for s of the form 3k with k  ≥  27.

Summing up, we have infinite families of n with s(n2) = s(n) = s for all s  ≥  22, respectively, s∈{12,16,18,19,20}. For s∈{13,17,21}, we take (N)2 = u0Rv with

[formula]

This completes the proof of Theorem [\ref=mtheo5].

Evidence that s2(n2)  =  s2(n)  ≤  10 is finite

All examples of infinite families with s2(n2)  =  s2(n)  =  k have the form given from Lemma [\ref=prop:infinite]. We show that there do not exists u and v satisfying Proposition [\ref=prop:infinite], with k∈{9,10}. We illustrate this method for k  =  8, as it contains all of the key ideas without being overly cumbersome. The case of k  =  8 is actually proved to be finite by the techniques of Section [\ref=sec:mtheo4], but this does not detract from this example. The other two cases are similar.

Assume the contrary, that there exists u and v such that

[formula]

We easily see that s2(v),s2(u)  ≥  2. Furthermore, as s2(u),s2(v)  ≥  2, we see that s2(u2),s2(v2)  ≥  2. Also, we have that s2(uv)  ≥  2. Therefore, we have 2  ≤  s2(u2),s2(v2)  ≤  k  -  4. Lastly, we see that one of u or v must be "deficient", that s2(u2) < s2(u) or s2(v2) < s2(v).

Assume without loss of generality that s2(u2)  <  s2(u). Given the restrictions, we have that 2  ≤  s2(u)  ≤  6. Using the same algorithm as in Section [\ref=sec:mtheo4], we can find all u such that 2  ≤  s2(u)  ≤  6 and s2(u2)  <  s2(u), s2(u2)  ≤  4. These are the first three entries of Table 3.

Therefore, it suffices to show that there do not exists v for u  =  23,47 or 111 with s2(u)  +  s2(v)  =  s2(u2)  +  s2(v2)  +  s2(uv)  =  8.

Let u  =  23  =  10111. Given that s2(uv)  ≥  2 we have that s2(v)  =  4 and s2(v2)  ≤  3. The only possible solution by Table 3 is v  =  23  =  10111, but s2(uv)  =  3, a contradiction.

Let u  =  47  =  101111. Given that s2(uv)  ≥  2 we have that s2(v)  =  3 and s2(v2)  ≤  2. There are no solutions by Table 3 for this, a contradiction.

Let u  =  111  =  11101111. Given that s2(uv)  ≥  2 we have that s2(v)  =  2 and s2(v2)  ≤  2. There is one possible solution to this by Table 3, namely v  =  3  =  11. But then s2(uv)  =  5, a contradiction.

A similar, but more elaborate analysis can be done for k  =  9 and k  =  10 using the additional information in Table 3. Here we look at 2  ≤  s2(u)  ≤  7, s2(u2)  <  s2(u) and s2(u2)  ≤  5.

Proof of Theorem [\ref=genqsquares]

The proof uses the strategy adopted for the case q = 2 (see Section [\ref=sec:mtheo4]). However, in order to handle more possible digits in the case of q  ≥  3, the analysis is much more delicate. In the proof we will make frequent use of the fact ([\ref=wellknown]) and of the splitting formulae of Proposition [\ref=propsplit], which will apply if we have noninterfering terms at our disposal.

To begin with, the condition ([\ref=knec]) is necessary, since ([\ref=Dioeq]) implies

[formula]

For the construction of an infinite family, we first prove a crucial lemma.

Let

[formula]

with k  ≥  2, n  ≥  k + 2 and 0  ≤  e  ≤  q - 2. Then

[formula]

and

[formula]

where

[formula]

Since u = e + (qn - 1)q + (qk - 1)qn + 2, we get

[formula]

By assumption that n  ≥  k + 2 and n,k  ≥  2, the terms in ([\ref=u2exp]) are noninterfering. We therefore get

[formula]

The claimed value of sq(u2) now follows by observing that sq(q2 - 2q) = sq(q - 2) = q - 2 and sq(2q - 3) = sq(q + q - 3) = 1 + q - 3 = q - 2.

Now consider

[formula]

where we suppose k1,n1,k2,n2  ≥  2 and n1  ≥  k1 + 2, n2  ≥  k2 + 2. Since [formula] we further suppose that e  ≠  0. We want to construct an infinite family of solutions to ([\ref=Dioeq]) of the form n = (u0(i)v), where i is a sufficiently large integer, such that terms will be noninterfering. Our task is to find an admissible set of parameters k1,n1,k2,n2 such that for sufficiently large n1 + n2 + k1 + k2 we have

[formula]

First it is a straightforward calculation to show that 2uv = w1 + w2 with

[formula]

and

[formula]

Note that w1 and w2 are noninterfering because of k2  ≥  2. Now, set

[formula]

where we will later suitably choose α  =  α(q,e) only depending on q and e. Then terms in ([\ref=w1def]) are again noninterfering and we get

[formula]

Next, by ([\ref=crucialchoix]), we find that

[formula]

In order to have terms noninterfering in ([\ref=w2defdot]), we impose the following inequalities on the parameters,

[formula]

Then we get

[formula]

where

[formula]

Summing up, we have

[formula]

Combining with ([\ref=dioiden]) and ([\ref=crucialchoix]) we therefore have

[formula]

and

[formula]

Rule ([\ref=wellknown]) applied to ([\ref=fdefini]) and ([\ref=gdefini]) shows that the right hand side is indeed divisible by q - 1 since [formula] mod (q - 1) by assumption. Furthermore, we have by a crude estimation (using also ([\ref=wellknown])) that

[formula]

Suppose k2  ≥  17. Then ([\ref=ineq1]) and ([\ref=ineq4]) are satisfied. Rewriting ([\ref=ineq2]) and ([\ref=ineq3]) gives

[formula]

Note that k1  ≥  k2 + 2 is more restrictive than the first inequality in ([\ref=k1ineq]). On the other hand, since k2  ≥  2, the interval given for k1 in ([\ref=k1ineq]) has at least (2  ·  17 - α - 1) - (1 + 17 - α) + 1 = 16 terms. Therefore, 2k1 + 3k2 hits all integers ≥  2(1 + (k2 + 1) - α) + 3(k2 + 1) for k2  ≥  17. Thus, we find from ([\ref=egalite]) that all values

[formula]

can be achieved. This completes the proof of Theorem [\ref=genqsquares].

Misc

These are a bunch of results that I don't know where to put, (or if we want to put anywhere)

Given k, the following n satisfy s2(n) = s2(n2) = k.

[formula]

Let u = 1(k)0(l)1(m). Then

[formula]

Let n = 101(s)01(r) with r  ≥  s. Then

[formula]

Hence for r = s + 2, we have s2(n) = s2(n2) = r + s = 2s + 2.