Stable embeddedness and NIP

University of Leeds

Proposition Definition Remark Lemma Corollary Fact Example Question Problem

Introduction and preliminaries

The notion of "stable embeddedness" of a predicate (or definable set) in a theory (or structure) is rather important in model theory, and says roughly that no new structure is added by external parameters. The current paper is somewhat technical, and heavily influenced by [\cite=Hasson-Onshuus] on the stable embeddability of o-minimal structures, which we wanted to cast in a more general context.

Stable embeddedness usually refers to a structure M which is interpretable (without parameters) in another structure N, and says that any subset of Mn which is definable, with parameters, in N, is definable, with parameters in M. I prefer to think of the universe of M as simply an [formula]-definable set P in N, and to say that P is stably embedded in N if every subset of Pn which is definable (in N) with parameters, is definable (in N) with parameters from P. See below.

So our general framework is that of a complete theory T in language L and a distinguished predicate or formula or sort P(x). We work in a saturated model N of T, and let P also denote the interpretation of P in N. Unless we say otherwise, "definability" refers to definability with parameters in the ambient structure N. We will also discuss the notion "P is stable in N" just to clarify current notation and relationships.

(i) P is stable in T (or in N) if there do NOT exist a formula φ(x̄,y) (where x̄ is a tuple of variables each of which is of sort P, and y is an arbitrary tuple of variables) and āi  ⊂  P and bi∈Neq for i < ω such that [formula] iff i  ≤  j. (ii) P is NIP in T (or N) if there do NOT exist φ(x̄,y) (with same proviso as before) and āi  ⊂  P for i < ω and bs∈Neq for s  ⊆  ω such that [formula] iff i∈s. (iii) P is stably embedded in T (or N) if for all n every subset of Pn which is definable in N with parameters, is definable in N with parameters from P. (iv) P is 1-stably embedded, if (iii) holds for n = 1.

We let P denote the structure whose universe is P and whose basic relations are those which are [formula]-definable in N. Note that if P is NIP in N and P is the structure with universe P and relations all subsets of various Pn which are [formula]-definable in N, then Th(P) has NIP too. Of course if T (= Th(N)) has NIP then P has NIP in N, and even in this case there are situations where P is not stably embedded in N. For example when T is the theory of dense pairs of real closed fields and where P is the bottom model.

(i) For P to be stable in N it is enough that Definition 1.1(i) holds in the case where x̄ is a single variable x ranging over P. Likewise for P being NIP in N and Definition 1.1(ii). Also if P is stable in N then it is NIP in N. (ii) Suppose that <   is a distinguished [formula]-definable total ordering on P. Define P to be o-minimal in N if every definable (in N, with parameters) subset of P is a finite union of intervals (with endpoints in P together with plus or minus ∞  ) and points. Then IF P is o-minimal in N then it is 1-stably embedded in N AND has NIP in N. (iii) If P is stable in N then P is stably embedded in N.

Comments. (i) (for P being NIP in T) and (ii) were already mentioned in an earlier draft of [\cite=Hasson-Onshuus]. For (i) the point is that well-known results reducing stability and NIP to the case of formulas φ(x,y) where x ranges over elements rather than tuples, adapt to the current "relative" context. (iii) is also well-known.

We now discuss the finite thorn rank condition. There is an extensive theory in place around rosy theories and U-thorn-rank (e.g. [\cite=Onshuus]). From this point of view, a theory T' has "finite rank" if T' is rosy and there is a finite bound on the U-thorn-ranks of types in any given imaginary sort. If T' is 1-sorted it suffices to have a bound on the U-thorn-ranks of types of elements in the home sort. See [\cite=EKP] for more details on this point of view. We will now give an equivalent abstract definition which is the one we will work with and which does not need any acquaintance with rosy theories and/or thorn forking. In the following T' is a complete theory, a,b,c,.. range over possibly imaginary elements of a saturated model of T' and A,B,C,.. range over small sets of imaginaries from such a model.

We say that T' has finite rank if there is an assignement to every a,B of a nonnegative integer rk(a / B), depending only on tp(a,B) with the following properties: (i) rk(a,b / C)  =  rk(b,a / C)  =  rk(a / b,C)  +  rk(b / C), (ii) rk(a / B)  =  0 iff a∈acl(B), (iii) for any a and B  ⊆  C, there is a' such that tp(a' / B)  =  tp(a / B) and rk(a' / C)  =  rk(a / B), (iv) for any (imaginary) sort Z there is a finite bound on rk(a) for a∈Z.

If T' is a finite rank theory then we obtain a good notion of independence by defining a to be independent from B over C if rk(a / BC)  =  rk(a / C). Of course an o-minimal theory is an example.

We can now state our main result, reverting to our earlier notation (T,P,P, etc.).

Suppose that Th(P) is finite rank, P has NIP in T and P is 1-stably embedded in N. Then P is stably embedded in N.

Our previous discussion shows that if P is o-minimal in T then all the hypotheses of Theorem 1.4 are satisfied. Let us note immediately that Theorem 1.4 needs the "NIP in N" hypothesis on P. For example let N be the structure with two disjoint unary predicates P,Q, and a random bi-partite graph relation R between P(2) (unordered pairs from P) and Q. Then one checks that P is 1-stably embedded in N but not stably embedded.

Hrushovski suggested the following example showing that the finite rank hypothesis is needed. Let T be some completion of the theory of proper dense elementary pairs of algebraically closed valued fields F1  <  F2, which have the same residue field and value group. Then F1 is 1-stably embedded in F2. But if [formula], then the function taking x∈F1 to v(x - a) cannot be definable with parameters from F1.

Thanks to Ehud Hrushovski and Alf Onshuus for helpful comments, suggestions, and discussions.

Forking

In this section we fix a complete theory T and work in a saturated model [formula]. As usual A,B,.. denote small subsets of [formula]. Likewise for small elementary substructures M,M0 etc. a,b,.. usually denote elements of [formula] unless we say otherwise. Likewise for variables. Dividing and forking are meant in the sense of Shelah. Namely a formula φ(x,b) divides over A if some A-indiscernible sequence (φ(x,bi):i < ω) (with b0  =  b) is inconsistent. And a partial type forks over A if it implies a finite disjunction of formulas each of which divides over A. By a global type we mean a complete type over [formula] (or over a sufficiently saturated M). Note that for a global type p(x), p does not fork over A iff p does not divide over A (i.e. every formula in p does not divide over A). Also any partial type does not fork over A if and only if it has an extension to a global type which does not divide (fork) over A. Let M0 denote a small model (elementary substructure of [formula]).

(i) Suppose that T has NIP. Let p(x) be a global type. Then p does not fork over M0 if and only if p is [formula]-invariant. (ii) If the global type p(x) is [formula]-invariant, and (ai:i < ω) are such that an + 1 realizes p|(M0a0..an) for all n, then (ai:i < ω) is indiscerinible over M0 and its type over M0 depends only on p. (ai:i < ω) is called a Morley sequence in p over M0.

Comment. (i) appears explicitly in [\cite=Adler], and also in [\cite=NIPII] but is implicit in [\cite=Shelah783]. (ii) is well-known, but see Chapter 12 of [\cite=Poizat] for a nice account.

(i) Let p(x) be a global type (or complete type over a saturated model), realized by c. We say that p strictly does not fork over A if p does not fork over A and [formula] does not fork over A (namely for each small B containing A and realization c' of p|B, tp(B / Ac) does not fork over A). (ii) Let A  ⊆  B, and p(x)∈S(B). Then p strictly does not fork over A (or p is a strict nonforking extension of p|A) if p has an extension to a global complete type q(x) which strictly does not fork over A.

Assume that T has NIP and let M0 be a model. (i) For any formula φ(x,b), φ(x,b) divides over M0 iff φ(x,b) forks over M0. (ii) Any p(x)∈S(M0) has a global strict nonforking extension. (iii) Suppose p(x) is a global complete type which strictly does not fork over M0. Let (ci:i < ω) be a Morley sequence in p over M0. Suppose φ(x,c0) divides over M0 (where φ(x,y) is over M0). Then {φ(x,ci):i < ω} is inconsistent.

Proof. This is all contained in [\cite=Chernikov-Kaplan], where essentially only the property NTP2 (implied by NIP) is used. (i) is Theorem 1.2 there (as any model is an "extension base" for nonforking). (ii) is Theorem 3.29 there. And (iii) is Claim 3.14 there.

Suppose that T has NIP and M0 is a model of cardinality κ  ≥  |T|. Let q(y) be a global complete type which strictly does not fork over M0 and let (cα:α  <  κ+) be a Morley sequence in q over M0. Then for any (finite) tuple a, there is α  <  κ+ such that tp(a / M0cα) does not fork over M0.

Proof. Suppose not. So, using Fact 2.3(i), for each α there is some formula φα(x,y) with parameters from M0 such that [formula] and φα(x,cα) divides over M0. As M0 has cardinality κ  ≥  |T| there is φ(x,y) over M0 and α0  <  α1  <  α2  <  ...  <  κ+ such that φ(x,y)  =  φαi(x,y) for all i < ω. By Fact 2.3 (iii) {φ(x,cαi):i < ω} is inconsistent, which is a contradiction as this set of formulas is supposed to be realized by a.

Some remarks are in order concerning the notions introduced above and the last corollary. Strict nonforking in the NIP context was introduced by Shelah [\cite=Shelah783] (where the study of forking in NIP theories was also initiated) and all the results above are closely connected in one way or another with Shelah's work. A version of Corollary 2.4, which on the face of it is incorrect due possibly to typographical errors, appears in [\cite=Shelah783] as Claim 5.19. A better version of Corollary 2.4 appears in [\cite=Usvyatsov].

Proof of Theorem 1.4

We revert to the context of section 1, and Theorem 1.4. Namely T is an arbitrary theory, N a saturated model, and P a [formula]-definable set in N. As there P is the structure with universe P and relations subsets of various Pn which are [formula]-definable in N. So if for example a and b are tuples from P (or even from Peq) which have the same type in P then they have the same type in N. We will assume that Th(P) is finite rank, as in Definition 1.3. We assume that P has NIP in N (from which it follows that any sort in Peq has NIP in N and also the structure P has NIP in its own right). We also assume that P is 1-stably embedded in N. Note that any sort (or definable set) in Peq is also a sort (or definable set) in Neq. If S is a sort of Peq, and X is a subset of S which is definable (with parameters) in N, we will say, hopefully without ambiguity, that X is coded in P if X can be defined in N with parameters from P, which is equivalent to saying that a canonical parameter for X can be chosen in Peq, and is also of course equivalent to saying that X is definable with parameters in the structure P. Our aim is to prove that for any n, any subset of Pn definable in N is coded in P. The 1-stable embeddedness of P states that any subset of P definable with parameters in N is coded in P. We first aim towards the following key proposition, which extends this to definable functions on P.

Let Z be a sort in Peq. Let f:P  →  Z be a function definable in N. Then f is coded in P.

Proof of Proposition 3.1. This will go through a couple of steps. The first is an adaptation of ideas from [\cite=Hasson-Onshuus], using just the finite rank hypothesis on P:

(In the situation of Proposition 3.1) There is a relation R(x,z) which is definable in N with parameters from P, and some k < ω, such that [formula]

Proof. Note that we are free to add parameters from P to the language (but not, of course, from outside P). We try to construct ai∈P, bi∈Z for i < ω such that (i) an∉acl((ai,bi)i < n), (ii) bn  =  f(an), and (iii) bn∉acl((aibi)i < n,an).

If at stage n we cannot continue the construction it means that for all a∈P such that a∉acl((aibi)i < n, f(a)∈acl((aibi)i < n,a). Compactness will yield the required relation R(x,z) (defined with parameters from P). So we assume that the construction can be carried out and aim for a contradiction. We now work in the finite rank structure P. Note that rk(anbn / (aibi)i < n)  >  1 for all n and moreover there is a finite bound to rk(anbn) as n varies. Choose minimal s > 1 such that for some m, for infinitely many n  >  m, rk(anbn / (aibi)i  ≤  m)  =  s. It is then easy to find m  <  i0  <  ii  <  .. such that for all j, rk(aij,bij / a0,b0,..,am,bm,ai0,bi0,..,aij - 1,bij - 1)  =  rk(aij,bij / a0,b0,..,am,bm)  =  s. So after adding constants (in P) for a0,b0,..,am,bm, thinning the sequence, and relabelling, we have (iv) rk(an,bn)  =  rk(anbn / (aibi)i < n)  =  s  >  1 for all n, which means that (v) {(a0b0),(a1b1),(a2b2),....} is an "independent" set of tuples.

Of course we still have that [formula], bi∉acl(ai) for all i, as well as bi  =  f(ai) for all i. Now f is definable in N with some parameter e so let us write f as fe to exhibit the dependence on e. Claim. For each S  ⊆  ω there are bSi∈Z for i < ω such that (a) For i∈ω, i∈S iff bSi  =  bi. (b) tp((aibi)i < ω)  =  tp((aibSi)i < ω). Proof of claim. Fix n∉S. By (v) above, rk(bn / an,(aibi)i  ≠  n)  >  0, so let bSn be such that tp(bSn / an,(aibi)i  ≠  n)  =  tp(bn / an,(aibi)i  ≠  n) and rk(bSn / (aibi)i < ω)  >  0. So we see that tp((anbn),(aibi)i  ≠  n)  =  tp(anbSn),(aibi)i  ≠  n) and bSn  ≠  bn. Iterate this to obtain the claim.

By (b) of the claim, and automorphism, for each S  ⊆  ω, there is eS such that feS(an)  =  bSn for all n∈ω. By (a) of the claim, we have that feS(an)  =  bn iff n∈S. This contradicts P having NIP in T, and proves Lemma 3.2

Note that if Th(P) had Skolem functions, or even Skolem functions for "algebraic" formulas, we could quickly deduce Proposition 3.1 from Lemma 3.2. (And this is how it works in the o-minimal case.) Likewise if we can choose R in Lemma 3.2 such that k = 1, we would be finished. So let us choose R in Lemma 3.2 such that k is minimized, and work towards showing that k  =  1. Here we use nonforking in the NIP theory Th(P). Let us fix a small elementary substructure M0 of P which contains the parameters from R. So for any a∈P, f(a)∈acl(M0,a), and this will be used all the time.

There is a finite tuple c from Peq such that whenever a∈P and b  =  f(a) and tp(a / M0c) does not fork over M0 (in the structure P) then b∈dcl(M0,c,a) (in P or equivalently in N).

Proof. Let us suppose the lemma fails (and aim for a contradiction). We will first find inductively an,bn,dn for n < ω such that writing cn  =  (an,bn,dn) we have (i) an∈P, bn  ≠  dn are in Z and bn  =  f(an). (ii) tp(anbn / M0c0..cn - 1) does not fork over M0, and (iii) tp(anbn / M0c0...cn - 1)  =  tp(andn / M0c0...cn - 1).

Suppose have found ai,bi,di for i < n. Put c  =  c0...cn - 1 (so if n = 0, c is the empty tuple.) As the claim fails for c, we find a∈P, such that f(a)  =  b, tp(a / M0c) does not fork over M0, and b∉dcl(M0ca). Noting that b∈acl(M0,a) we also have that tp(ab / M0c) does not fork over M0. Let d realize the same type as b over M0ca with d  ≠  b. Put an  =  a, bn  =  b, dn  =  d. So the construction can be accomplished.

Claim. Let S  ⊆  ω. Define gn  =  bn if n∈S and gn  =  dn if n∉S. Then tp((aigi)i < ω / M0)  =  tp((aibi)i < ω / M0 (in P or equivalently in N). Proof of claim. Assume, by induction, that (*) tp((aigi)i < n / M0)  =  tp((aibi)i < n / M0), and we want the same thing with n + 1 in place of n. By (iii) above it suffices to prove that tp((aigi)i < n(anbn) / M0)  =  tp((aibi)i < n(anbn) / M0). This is true by (*) and Fact 2.1(i). (Namely as tp(anbn / M0c) does not fork over M0 it has a global complete extension q say which does not fork over M0 so by 2.1(i) q is fixed by automorphisms which fix M0 pointwise. So whether or not a formula φ(x,z,d) say is in q or not depends just on tp(d / M0), so the same is true for tp(anbn / M0c).) The claim is proved.

As earlier we write f as fe where e is a parameter in N over which f is defined. By the claim, and automorphism, for each S  ⊆  ω we can find eS in N such that feS(ai)  =  gi for all i < ω. In particular, as di  ≠  bi for all i, feS(ai)  =  bi if and only if i∈S, showing that P has the independence property in N, a contradiction. Lemma 3.3 is proved.

We now complete the proof of Proposition 3.1 by showing that k = 1. Let us assume k  >  1 and get a contradiction. Let c∈Peq be as given by the Lemma 3.3. Then, (by the previous two lemmas), whenever a∈P and tp(a / M0c) does not fork over M0, THEN there is d∈Z such that [formula] and d∈dcl(M0,a,c). Note that f is not mentioned here, so this statement is purely about P. Hence: (*) whenever c'∈P has the same type over M0 as c, then whenever a∈P and tp(a / M0c') does not fork over M0 then d∈dcl(M0,a,c) for some d∈Z such that [formula].

We work in P. By Fact 2.3 (ii) let q(y) be a global strict nonforking extension of tp(c / M0), and let (cα:i < |T|+) be a Morley sequence in q over M0. By Corollary 2.4, for any a∈P, there is α such that tp(a / M0cα) does not fork over M0, and hence by (*), there is d such that [formula] and d∈dcl(M0,a,cα). By compactness there is a partial function g( - ) defined over [formula] such that (**) for all a∈P, there is d∈Z such that [formula] and g(a)  =  d.

Now by our assumption that P is 1-stable embedded, {a∈P:g(a)  =  f(a)} is definable over parameters from P by some formula ψ(x) say. Let R'(x,z) be [formula]. Then clearly R' satisfies Lemma 3.2 with k - 1. This contradiction proves Proposition 3.1.

Proof of Theorem 1.4. There is no harm in adding a few constants for elements of P (so that we can do definition by cases). We will prove by induction on n that any subset of Pn which is definable in N with parameters, is coded in Peq. For n = 1 this is the 1-stable embeddednes hypothesis. Assume true for n and we'll prove for n + 1. Let φ(x1,..,xn,xn + 1,e) be a formula, with parameter e∈N defining the set X  ⊆  Pn + 1. For each a∈P, let Xa be the subset of Pn defined by φ(x1,x2,..,xn,a,e). By induction hypothesis Xa is coded in P, namely has a canonical parameter ca say in Peq. By compactness, we assume that there is a formula ψ(x1,..,xn,z) (of L), where z ranges over a sort Z of Peq, such that for each a∈P, Xa is defined by ψ(x1,..,xn,ca) (and ca is still a canonical parameter for Xa). The map taking a to ca is clearly an e-definable function f say from P to Z. By Proposition 3.1, f is coded in P (i.e. can be defined with parameters from P). As the original set X  ⊆  Pn + 1 is defined by the "formula" ψ(x1,..,xn,f(xn + 1)), it follows that X is also coded in P. The proof of Theorem 1.4 is complete.