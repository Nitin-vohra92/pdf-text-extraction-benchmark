true mm true mm

Capital process and optimality properties of a Bayesian Skeptic in coin-tossing games

Keywords and phrases:   Azuma-Hoeffding-Bennett inequality, beta-binomial distribution, exchangeability, game-theoretic probability, hypergeometric distribution, Kullback divergence, prior distribution.

Introduction

Coin tossing is the most basic object in the study of probability theory. This is also true in the new field of game-theoretic probability and finance established by Shafer and Vovk (2001). In fact they start with discussing the fair-coin game in Section 3.1 of their book. Recently Kumon and Takemura (2007)[\cite=kumon-takemura], motivated by Takeuchi's works ([\cite=takeuchi:2004], [\cite=takeuchi:2004b]), proved that a very simple single strategy, based only on the past average of Reality's moves, is weakly forcing SLLN with the convergence rate of [formula], which is a substantial improvement over the original strategy of Shafer and Vovk. Versions of SLLN for unbounded moves by Reality is obtained in Kumon, Takemura and Takeuchi (2007)[\cite=ktt-unbounded].

In this paper for general biased-coin games, we consider a class of Bayesian strategies for Skeptic. As in Kumon and Takemura (2007) we prove that Bayesian strategies in the class weakly force SLLN with the convergence rate of [formula]. Furthermore we establish the important fact that if Skeptic uses a Bayesian strategy and Reality violates SLLN, then the exponential growth rate of the Skeptic's capital process is very accurately described in terms of the Kullback divergence between the average of Reality's moves when she violates SLLN and the average when she observes SLLN.

In the protocol of the coin-tossing game of Shafer and Vovk (2001), there is no probabilistic assumption on the behavior of Reality. In the games, Skeptic tries to become rich and Reality tries to prevent it. However in the Bayesian strategy, Skeptic simply and naively assumes that Reality behaves probabilistically and for choosing his moves Skeptic uses the Bayesian prediction of Reality's moves. It is a remarkable fact that this naive Bayesian prediction by Skeptic actually works and forces SLLN even if Reality's moves are not probabilistic at all and Reality tries to beat Skeptic as an adversary. Furthermore Skeptic achieves an optimal growth rate if Reality violates SLLN in a way accounted for by the prior. As in the standard statistical decision theory (e.g. Berger [\cite=berger] and Robert [\cite=robert]), this optimality is inherent in Bayesian procedures. However in the setting of the present paper, only a very simple protocol of the game is assumed and no other modeling assumptions are made on Reality's moves. In this sense, we believe that the optimality considered in this paper has much broader conceptual implications than those offered by the standard statistical decision theory.

The organization of this paper is as follows. In Section [\ref=sec:preliminary] we formulate coin-tossing games and set up some notations. In Section [\ref=sec:bayesian] we formulate Bayesian strategy of Skeptic for a given probability distribution on the space of Reality's moves. In particular we consider Bayes procedures with respect to beta-binomial distribution and hypergeometric distribution. In Section [\ref=sec:process] we show that Skeptic's capital process is expressed in a closed form when he uses a Bayesian strategy of Section [\ref=sec:bayesian]. Then using Stirling's formula we prove that the exponential growth rate of the capital process is naturally described by means of the Kullback divergence. In Section [\ref=sec:one-sided] we consider the case that Skeptic is restricted to only buy the tickets in coin-tossing games. In Section [\ref=sec:numerical] some numerical examples are presented. We end the paper with some concluding remarks in Section [\ref=sec:remarks].

Notations on coin-tossing game

Here we prepare some notations on coin-tossing games. We consider a general biased-coin game between Skeptic and Reality in the following parametrization. In the protocol, the head and the tail of coin are coded as 1 and 0, respectively. Furthermore the probability of heads 0  <  ρ  <  1 is given.

Biased-Coin Game Protocol:

=6 K0: = 1. FOR [formula]: Skeptic announces [formula]. Reality announces xn∈{  -  ρ,1 - ρ}. Kn  =  Kn - 1  +  Mnxn. END FOR

Skeptic starts with the initial capital K0 = 1. For each round n, Skeptic first announces Mn, which is the number of tickets he buys. xn stands for a ticket which sells for the price of ρ and it pays the amount of one if Reality chooses heads and nothing if she chooses tails. ρ is called the risk neutral probability (e.g. Takemura and Suzuki (2007)). Except for Section [\ref=sec:one-sided] we consider the case that Skeptic is allowed to sell the tickets (Mn < 0). Mnxn is the increment of Skeptic's capital from round n - 1 to n. The case ρ  =  1 / 2 is the fair-coin game. Although most of our results can be presented in the fair-coin game, it is instructive to consider the biased-coin game for the additional asymmetry.

Let [formula] denote the sequence of Reality's moves up to time n. hn denotes the number of heads and tn = n - hn denotes the number of tails in ξn. Furthermore write

[formula]

Then sn  =  hn  -  ρn and

[formula]

In the above biased-coin game, as discussed below, Reality is forced to observe SLLN x̄n  →  0 or equivalently to follow the risk neutral probability hn / n  →  ρ.

In the following we write

[formula]

and express the recursive relation of the capital process in the multiplicative form Kn  =  Kn - 1(1 + νnxn). Then starting from the initial capital K0 = 1, the capital process is written as

[formula]

As in Shafer and Vovk (2001), we can think that Skeptic chooses his strategy P which specifies [formula] as a function of [formula]. Note that Skeptic has to choose

[formula]

if he has to avoid bankruptcy (Ki  ≤  0).

In the protocol above there is no probabilistic assumption on the behavior of Reality. Suppose however that Skeptic models Reality's moves [formula] by a probability distribution Q  =  Qn on {  -  ρ,1 - ρ}n. We denote the conditional expectation of xi under Q given [formula] by

[formula]

where

[formula]

is the conditional probability of heads.

Bayesian strategy and its optimality

In this section, we first discuss optimality inherent in a Bayesian strategy. It is not obvious how to formulate optimality of Skeptic's strategies. Allowing equalities in ([\ref=eq:restriction-on-nu]), for each fixed path of Reality's moves [formula] up to time n, the optimum moves of Skeptic are given as

[formula]

for [formula], with the resulting capital Kn  =  ρ- hn(1 - ρ)- tn. However this argument is clearly meaningless because in each round Skeptic has to choose νi first and Reality chooses xi after seeing νi. For Skeptic's strategy P and a path ξn, we denote his log capital by log KPn(ξn) and denote a weight of the path by w(ξn)  ≥  0. Then we consider the weighted average of log KPn(ξn) and evaluate Skeptic's strategy P by

[formula]

There is no loss of generality in assuming [formula]. Therefore {w(ξn)} is a probability measure Q and ([\ref=eq:weighted0]) can be written as

[formula]

For a given Q the optimum P  =  PQ maximizing ([\ref=eq:weighted1]) is given as follows by a standard backward induction argument of dynamic programming. We call PQ the Bayesian strategy for Q.

The optimum strategy P  =  PQ maximizing ([\ref=eq:weighted1]) is given by

[formula]

Consider the optimum move of Skeptic at the last round n, given all previous moves of the players. The terms of

[formula]

are all fixed except for the last term log (1 + νnxn). Consider maximizing the conditional expected value [formula]. g(ν) is a concave function of ν and under the convention 0 = 0 log 0, g(ν) is maximized by solving g'(ν) = 0 as long as this equation has a solution in

[formula]

In the beginning of this section we argued that ([\ref=eq:meaningless]) for a fixed sequence [formula] is meaningless. However Theorem [\ref=thm:bayes-optimum] reduces to ([\ref=eq:meaningless]) if Q is a point mass at a particular ξn. This shows that the optimality in Theorem [\ref=thm:bayes-optimum] for a given Q is in a sense a trivial inherent optimality of a Bayes procedure and the important question is the choice of the probability measure Q. In the following we consider various choices of Q, including those whose support is a proper subset of {  -  ρ,1 - ρ}n.

The obvious first candidate for Q is the Bernoulli model, where Reality is modeled to choose her move independently for each round as Q(xi = 1 - ρ) = p = 1 - Q(xi =  - ρ). Then

[formula]

where hn and tn are the numbers of heads and tails in [formula]. In this case [formula] for all i and νi  =  (p - ρ) / ρ(1 - ρ) is a constant. We see that the fixed ε-strategy of Chapter 3 in Shafer and Vovk (2001) corresponds to this case.

From Bayesian viewpoint it is natural to consider a mixture of the Bernoulli model with respect to a beta prior, which is the natural conjugate to the binomial distribution. Suppose that Skeptic has a prior beta distribution π on the success probability p of the Bernoulli model.

[formula]

We can think of α and β as prior numbers of heads and tails. Then

[formula]

is the beta-binomial distribution and we call this model "beta-binomial model" and call the Skeptic's associated strategy "beta-binomial strategy". In this model

[formula]

and it follows that

[formula]

Finally we consider a hypergeometric model, whose support may be a proper subset of {  -  ρ,1 - ρ}n. This is a somewhat artificial model, but it is useful as a benchmark in considering optimality of the beta-binomial strategy. As we see below the hypergeometric model has an opposite characteristic to the beta-binomial model. Let N  ≥  n and 0  ≤  M  ≤  N be positive integers.

Consider an urn containing M red balls and N - M black balls. Skeptic models Reality's behavior in such a way that Reality draws a ball from the urn one by one without replacement and she chooses heads if the ball is red in the i-th drawing. Therefore Skeptic is considering an initial part of a finite horizon game with N rounds. Under this model

[formula]

and

[formula]

Since the hypergeometric model holds for each i  ≤  n, it follows that

[formula]

Note the similarities between ([\ref=eq:beta-binomial-prob]) and ([\ref=eq:hypergeometric-prob]) and between ([\ref=eq:beta-binomial]) and ([\ref=eq:alpha-hypergeometric]). If we put

[formula]

then ([\ref=eq:beta-binomial]) coincides with ([\ref=eq:alpha-hypergeometric]).

In order to make the correspondence clearer, define

[formula]

for real a and non-negative integer m. For a > 0, (a)m  =  Γ(a + m) / Γ(a). Then with the correspondence ([\ref=eq:correspondence]), both ([\ref=eq:beta-binomial-prob]) and ([\ref=eq:hypergeometric-prob]) can be written as

[formula]

We see that the hypergeometric model is the "negative" of the beta-binomial model. In the beta-binomial model [formula] is an increasing function of hn - 1, whereas in the hypergeometric model [formula] is a decreasing function. Another way of understanding the connection is the Polya's urn model (e.g. Section V.2 of Feller (1968), Takemura and Suzuki (2005)). Hypergeometric model corresponds to sampling without replacement, Bernoulli model corresponds to sampling with replacement and beta-binomial model corresponds to Polya's urn model where a ball with the same color is added at each draw.

The extreme case of the hypergeometric model is the case N = n. Then Q is concentrated on ξn with the number of heads exactly equal to M. Among the exchangeable models, in the sense that they assign the same probability to all ξn with the same number of heads, this model is most "meaningless" as in the very first example of this section. Note that the support of the hypergeometric model is the whole sample space {  -  ρ,1 - ρ}n if and only if n  ≤   min (M,N - M). One way of justifying the hypergeometric model is to add a requirement in the protocol of the game, such that Reality has to choose her path in the support of Q. By this requirement Reality's move space is decreased and the game becomes more favorable to Skeptic. This implies that the hypergeometric case, in particular the extreme case N = n, can serve as an upper bound to Skeptic's capital process. We should also mention de Finetti's theorem ([\cite=diaconis-freedman], [\cite=takeuchi-takemura:1987]), which states that an infinite sequence of exchangeable 0-1 random variables has to be a mixture of infinite independent Bernoulli trials. We see that the hypergeometric model is naturally associated with a finite horizon game.

Capital precess of Bayesian strategy

In this section we investigate capital process when Skeptic uses a Bayesian strategy. We first give a general formula for Skeptic's capital as a ratio of the probabilities of Reality's path under the assumed distribution and under the risk neutral probability distribution. This gives us a closed form expression of the capital process for the beta-binomial model and the hypergeometric model of the previous section. Then for the beta-binomial model, we use Stirling's formula to describe the exponential growth rate of the capital process. It leads to the Kullback divergence and proves that the beta-binomial strategy weakly forces SLLN with the convergence rate of [formula]. Finally we consider optimality of the beta-binomial strategy in relation to the hypergeometric model.

The following theorem shows that the capital process for a Bayesian strategy can be written as the ratio of probabilities under the assumed model and under the risk neutral probability measure.

Let Q = Qn be a probability measure on the set of paths {ξn} of length n and let PQ denote the Bayesian strategy for Q. The value of the capital process KPQn for PQ is given by

[formula]

where 0  <  ρ  <  1 is the risk neutral probability.

We prove ([\ref=eq:thm-2]) by induction on n. Recall that νi = (p̂Qi  -  ρ) / ρ(1 - ρ). Consider n = 1. If x1 = 1 - ρ, then

[formula]

On the other hand if x1  =    -  ρ, then

[formula]

This proves ([\ref=eq:thm-2]) for n = 1.

Now suppose that ([\ref=eq:thm-2]) holds up to n - 1. Then

[formula]

As in the case of n = 1 it holds that

[formula]

Therefore ([\ref=eq:thm-2]) holds also for n.

For the beta-binomial model and the hypergeometric model

[formula]

Formulation of Theorem [\ref=thm:path] in the present form was suggested by Vladimir Vovk to one of the authors in a discussion during the 16th international conference on algorithmic learning theory. Theorem [\ref=thm:path] actually follows from some general facts, including the equivalence of game-theoretic martingales and measure-theoretic martingales (Section 8.2 of Shafer and Vovk (2001)), expressing positive martingales with expected value of 1 as likelihood ratios and the non-negativeness of the Kullback divergence.

We now use Stirling's formula to prove that the beta-binomial strategy weakly forces SLLN. Let α > 0,β > 0 in ([\ref=eq:thm-2a]). The log capital process is written as

[formula]

If both hn and tn are large, we can use Stirling's formula

[formula]

More precisely for all x > 0

[formula]

For notational simplicity write n' = α  +  β + n, hn' = α + hn, tn' = β  +  tn. Then

[formula]

For 0 < p,  q  <  1, let

[formula]

denote the Kullback divergence between p and q. Then log KPn is written as

[formula]

where

[formula]

By the Taylor expansion

[formula]

where ρ* is some value between ρ and ρ  +  δ. Recall that hn / n = ρ  +  x̄n. Then with δ  =  x̄n we have

[formula]

Hence we obtain the following result.

When Skeptic follows the beta-binomial strategy (α > 0, β > 0) given by ([\ref=eq:rho-beta-binomial]), if and only if A sufficient condition for lim sup nKPn  =    ∞   is and a necessary condition for lim sup nKPn  =    ∞   is

Note that lim KPn  =    ∞   if and only if lim inf KPn  =    ∞  . This theorem states that the Bayesian strategy ([\ref=eq:rho-beta-binomial]) weakly forces that x̄n converges to 0. The convergence rate is [formula] and the the convergence factor is [formula].

We also note that from the log expression ([\ref=eq:log_capital2]), the capital KPn behaves as

[formula]

Hence we know that, if SLLN holds (x̄n  →  0) with a convergence rate slower than [formula], then Skeptic's capital grows faster than any polynomial order of n.

As clarified by the above argument, the Bayesian strategy which is plain in itself, greatly simplifies the proof and derivation of the strong law of large numbers for coin-tossing games. Furthermore Skeptic has a wide choice of prior distributions on the behavior of Reality, although the question of optimal choice of prior distributions seems to be a difficult problem. Capital processes for various values of α,β are illustrated by numerical examples in Section [\ref=sec:numerical].

As discussed in Remark 2 of Kumon and Takemura [\cite=kumon-takemura], the convergence rate of [formula] in Theorem [\ref=thm:rate] is closely related to Azuma-Hoeffding-Bennett inequality, which is a large deviation type inequality for bounded martingale differences. See Azuma (1967), Dembo and Zeitouni (1998), and Appendix A.7 of Vovk, Gammerman and Shafer (2005).

We also point the importance of game-theoretic results that the question of the optimal growth rate of Skeptic's capital cannot even be asked in the standard measure-theoretic probability theory. This question can be asked in the algorithmic theory of randomness, see e.g.  Schnorr (1970) (1971), Vovk (1987). But game-theoretic probability theory does not suffer from the two serious disadvantages of the algorithmic theory of randomness: the arbitrary constants and the heavy restrictions on the allowed sample spaces caused by considerations of computability.

For the rest of this section we consider performance of the beta-binomial strategy compared to the hypergeometric model. As remarked at the end of Section [\ref=sec:bayesian], the extreme case N = n of the hypergeometric model can serve as an upper bound for the beta-binomial models. We first state this in the following proposition.

For every exchangeable probability Q on the set of paths {ξn} of length n, the following inequality holds for each ξn.

[formula]

The left-hand side is the value of the capital process for the hypergeometric prior with n = N. The prior is the uniform distribution over the set of paths {ξn} with the same number hn of heads. For exchangeable Q, the right-hand side is constant for each path ξn with the same number hn of heads. Then the inequality follows from the optimality of the left-hand side for the hypergeometric prior with n = N.

Write

[formula]

Conceptually we need to consider K*n for each n and the number of heads hn, separately. Let Kα,βn denote the capital process for the beta-binomial model. Then K*n(ξn)  /  Kα,βn(ξ) is written as

[formula]

Therefore

[formula]

Stirling's formula for log x! is written as

[formula]

Hence we have

[formula]

The right-hand side is further simplified as

[formula]

We summarize the above calculation in the following proposition, which states that K*n(ξn) surpasses Kα,βn(ξn) only by a polynomial factor of n.

[formula]

Considering the fact that Skeptic can achieve K*n(ξn) only in "hindsight" (i.e. after seeing the number of heads hn for each n) and the fact that K*n(ξn) and Kα,βn(ξn) grow exponentially when Reality violates SLLN, we see that the beta-binomial strategy is close to optimum.

Capital process for the one-sided case

In this section we assume the protocol as before, but now Skeptic is required to choose Mn  ≥  0. We consider Skeptic's strategy P+ with

[formula]

where νi is given by ([\ref=eq:rho-beta-binomial]). We can also consider the negative part strategy P- with ν-i  =   min (νi,0).

In the following, we investigate the relation between the behavior of the original capital process KPn and the one-sided capital process KP+n. If Mn or νn changes the sign only finite number of times, then the behavior of KP+n is fairly trivial. If νn is eventually all non-negative, then KPn and KP+n are asymptotically equivalent. On the other hand if νn is eventually negative, then KP+n stays constant, whereas the behavior of KPn is described in Theorem [\ref=thm:rate]. Therefore we will consider the case that νn changes the sign infinitely often. At first, by writing

[formula]

we can express

[formula]

Noting that at time n when s̃n changes the sign,

[formula]

we start at sufficiently large time n0 such that hn0 / n0≃ρ, and proceed to divide the sequence {s̃n} into the following two types of blocks. For n0  ≤  k  +  1  ≤  l, consider a block [formula]. We call it a non-negative block if

[formula]

Similarly we call it a negative block if

[formula]

By definition, negative and non-negative blocks are alternating.

We first consider a particularly simple case of the fair-coin game ρ  =  1 / 2 and symmetric prior α  =  β. In this case s̃n  =  sn = 0 when s̃n changes the sign, and the lengths of the blocks are always even numbers. Then for each block [formula] we have hk  =  tk, hl  =  tl and the capital ratio KPl  /  KPk is expressed as

[formula]

where l  -  k  =  2m is an even number. As for the one-sided capital ratio, KP+l  /  KP+k  =  KPl  /  KPk during a non-negative block, and KP+l  /  KP+k  =  1 during a negative block. Therefore KPn  <  KP+n holds for all n in the non-negative block.

Now we consider a general biased-coin game. When s̃n changes the sign, we have to consider overshoot of order O(1 / n). Therefore we need to carefully bound the capital ratio KPl  /  KPk of P and the capital ratio KP+l  /  KP+k of P+ from above and below for each negative or non-negative block. This is conducted based on the log capital formula given by ([\ref=eq:log_capital]), that is

[formula]

In the above, when n  =  k or l,

[formula]

and when δ is small, as was noted in Section [\ref=sec:process],

[formula]

Therefore with δ  =  x̄n  =  O(1 / n) we have

[formula]

Hence we get for n  =  k or l

[formula]

so that it follows

[formula]

which implies that there exists a constant C > 0 depending only on α,β, and ρ such that

[formula]

We apply this relation for successive non-negative and negative blocks by noting the approximation formula

[formula]

Then we obtain at an end point nl of any block,

[formula]

When we reach an end point nl after passing sufficiently many blocks, the one-sided capital ratios KP+l  /  KP+k behave in the same way as KPl  /  KPk during non-negative blocks and stay one during negative blocks, so that we can also bound log KP+nl  /  KP+n0 in the following manner.

[formula]

From the above two relations, it follows that at a sufficiently large end point nl, the one-sided log capital log KP+nl differs from the original log capital log KPnl at most O( log nl). This fact implies that the two log capitals log KP+n and log KPn behave similarly except for O( log n). Thus from Theorem [\ref=thm:rate], we obtain the following result.

The one-sided Bayesian strategy P+ given by ([\ref=eq:one-sided_strategy]) weakly forces the one-sided version of SLLN with the convergence rate [formula] and with the convergence factor [formula], that is

[formula]

Some numerical examples

In this section we illustrate capital processes of our strategies for two data sets. The first data set is based on the Nikkei 225 stock average index for 500 days starting January 2000. We set xn  >  0 if the opening price of the n + 1-st day was higher than the opening price of the n-th day. The second data set is based on the first 500 digits in the fractional part of π - 3 = 0.141592653589793.... We set xn  >  0 if the n-th digit is in [formula].

For the Nikkei data we have h500 = 221 heads and t500 = 279 tails for the 500 days. The values of log K500 for the hypergeometric model (HG) and the beta-binomial strategies for ρ = 1 / 2, 2 / 3, 2 / 5, α  =  β = 1, 100, 500, together with the positive-part (PP) and negative-part (NP) strategies, are tabulated in Table 1. We see the exponential growth of the capital process for ρ  =  2 / 3. For this example it seems to to be advantageous to take α  =  β = 100.

We plot the entire log capital processes of the beta-binomial strategy with its positive part and negative part for the case of ρ = 1 / 2, α  =  β = 100 in Figure [\ref=fig:nikkei]. The log capital process of the beta-binomial strategy is plotted with a solid line, that of the positive-part strategy is plotted with a dashed line, and that of the negative-part strategy is plotted with a dotted line. We see that for this example the beta-binomial strategy is close to the negative-part strategy. The log capital of the positive-part strategy stays constant after about n = 90.

For the digits of π, we have h500 = 239 heads and t500 = 261 tails. The number of heads and tails are more balanced for this data set than the Nikkei 225 case above. Table 2 gives the same information as in Table 1 for this data set. We see the same tendency in Table 2 as in Table 1, although α  =  β = 500 performs better than α  =  β = 100.

As in Figure 1, the log capital processes of the beta-binomial strategy with its positive part and negative part for the case of ρ = 1 / 2, α  =  β = 100 are plotted in Figure [\ref=fig:pi]. The log capital of the positive-part strategy stays constant after about n = 140.

Concluding remarks

In this paper we have shown that for general biased-coin games, some simple Bayesian models provide explicit strategies of Skeptic which weakly force the strong law of large numbers with the convergence rate of [formula] and whose capital processes can be analyzed in detail, leading naturally to the Kullback divergence.

We treated coin tossing and beta-binomial model for simplicity and for the sake of explicit computations. However we expect that many of the results of this paper can be generalized to multidimensional cases and more general prior distributions. Theorem [\ref=thm:path] should hold for games with unique risk neutral probability.

We have only considered exchangeable priors Q. Strategies based on exchangeable priors can not exploit some block patterns or Markov dependencies of Reality. For example in the fair-coin game, the beta-binomial prior can not exploit the following pattern of heads: [formula]. In order to exploit a variety of patterns in Reality's moves, we need to use a prior Q which contains hyperparameters corresponding to these patterns. One might consider mixtures of priors, corresponding to various block patterns, Markov dependence of various orders, etc. We can take priors covering various higher order patterns and can analyze optimalities with respect to such priors. Another interesting direction would be to extend our results to other limit theorems, such as the law of the iterated logarithm. These subjects will be treated in our subsequent works.