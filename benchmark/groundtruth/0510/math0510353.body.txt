Theorem

Proposition

Lemma Corollary Corollary Conjecture

Remark

Definition

Subgroups of direct products of two limit groups

Introduction

In [\cite=BHMS] Miller, Short and the present authors described the homological finiteness properties of subgroups of direct products of free and surface groups. This completed a programme of research that began with celebrated examples of Stallings [\cite=stall] and Bieri [\cite=bieri1] and took an unexpected turn when Baumslag and Roseblade [\cite=BR] showed that the only finitely presented subdirect products of two free groups are the obvious ones, namely free groups and subgroups of finite index.

This last theorem admits instructive proofs from several perspectives [\cite=BW], [\cite=short], [\cite=miller]; each of these proofs lends new insight and leads to an interesting generalisation, but each relies heavily on the fact that one is dealing with only two factors. The search for a higher-dimensional analogue culminated in the Main Theorem of [\cite=BHMS], which shows in particular that if S is a subgroup of a direct product of n free or surface groups and the homology of S (with trivial coefficients) is finitely generated up to dimension n, then S has a subgroup of finite index that is isomorphic to a direct product of free or surface groups.

Upon the successful completion of his project to characterise those finitely generated groups that have the same elementary or existential theories as free groups ([\cite=S1] to [\cite=S6]; cf. [\cite=KM1] [\cite=KM2]), Zlil Sela proposed a list of central questions concerning these limit groups [\cite=zlil:qu]. In particular he asked whether the results of [\cite=BHMS] could be extended to subdirect products of limit groups. In the first two papers in this series [\cite=bh1], [\cite=bh2], we established results concerning the subgroup structure of limit groups that enabled us to answer this question in the case where the limit groups have the same elementary theory as a free group. In the present article we turn our attention to the subdirect products of general limit groups. We use our previous results in tandem with calcuations in group homology and geometrical arguments based on Bass-Serre theory to prove the following analogue of the Baumslag-Roseblade theorem.

Let S  ⊂  Γ1  ×  Γ2 be a subdirect product of non-abelian limit groups. If S is of type [formula] and [formula] is non-trivial for i = 1,2, then S has finite index in Γ1  ×  Γ2.

Some simple reductions ([\ref=reduce]) yield:

Let Γ1 and Γ2 be limit groups. If S  ⊂  Γ1  ×  Γ2 is finitely presented then S has a subgroup of finite index that is a product of at most two limit groups.

This is a special case of the following result, which is proved in section [\ref=cor].

Let [formula] be limit groups, with [formula] abelian, and let [formula] be a subdirect product such that S is of type [formula], where m =  min (n,3). Then S is isomorphic to a subgroup of finite index in a product of at most m limit groups.

For simplicity of exposition, the homology of a group G in this paper will always be with coefficients in a [formula]-module - typically the trivial module [formula]. With minor modifications, our arguments also apply with other coefficient modules, giving corresponding results under the finiteness conditions [formula] for other suitable rings R.

The final section of this paper contains some speculation concerning the subgroups of the direct product of arbitrarily many limit groups.

Limit groups, their decomposition and subgroup structure

Since this is the third in a series of papers (following [\cite=bh1] [\cite=bh2]), we shall only recall the minimal necessary amount of information about limit groups. The reader unfamiliar with this fascinating class of groups can consult the seminal papers of Sela [\cite=S1] to [\cite=S6] or the excellent introduction [\cite=BF]. The papers of Kharlampovich and Myasnikov [\cite=KM1] [\cite=KM2] approach the subject from a perspective more in keeping with traditional combinatorial group theory, and a further perspective is developed in [\cite=CG].

Limit groups

A finitely generated group Γ is a limit group if for every finite set T  ⊂  Γ there exists a homomorphism φ from Γ to a free group so that φ|T is injective.

Our results rely on the fact that limit groups are the finitely generated subgroups of ω-residually free tower (ω-rft) groups [\cite=S2]. Such tower groups are the fundamental groups of tower spaces that are assembled from graphs, tori and surfaces in a hierarchical manner. The number of stages in the process of assembly is the of the tower. Each stage in the construction involves the attachment of a surface along its boundary, or the attachment of an n-torus T along an embedded circle representing a primitive element of π1T.

The of a limit group S is the minimal height of an ω-rft group that has a subgroup isomorphic to S. Limit groups of height 0 are free products of finitely many free abelian groups (each of finite rank) and surface groups of Euler characteristic at most - 2.

The splitting described in the following proposition is obtained as follows: embed Γ in an ω-rft group G, take the graph of groups decomposition that the Seifert-van Kampen Theorem associates to the addition of the final block in the tower, then apply Bass-Serre theory to get an induced graph of groups decomposition of Γ.

If Γ is a limit group of height h  ≥  1, then Γ is the fundamental group of a finite graph of groups with the following properties:

the vertex groups are limit groups of height ≤  h - 1;

the edge groups are trivial or infinite-cyclic;

each edge is adjacent to a vertex where the vertex-group is non-abelian.

Note also that any non-abelian limit group of height 0 splits as [formula] with C infinite-cyclic or trivial.

Homological finiteness implies finiteness

The following is proved in [\cite=bh1].

Let Γ be a limit group and S  ⊂  Γ a subgroup. If [formula] is finite dimensional then S is finitely generated (and hence is a limit group).

Normal subgroups

From [\cite=bh1] we need:

If Γ is a limit group and H  ⊂  Γ is a finitely generated subgroup, then either H has finite index in its normaliser or else the normaliser of H is abelian.

And from [\cite=bh2] we need:

Let Γ be a limit group that splits as an amalgamated free product or HNN extension with cyclic edge group C  ⊂  Γ.

If N  ⊂  Γ is a non-trivial normal subgroup then there exists a subgroup Γ0  ⊂  Γ of finite index and an element [formula] such that Γ0 is an HNN-extension with stable letter t and amalgamated subgroup [formula].

Double cosets

We also require the following Double Coset Lemma from [\cite=bh2].

Suppose that, for [formula], [formula] is an HNN extension with associated subgroup Ai and stable letter ti. Let [formula], [formula], and let S  ⊂  Γ be a subgroup containing [formula]. Then [formula] contains a subgroup isomorphic to

[formula]

a rational vector space with basis the set [formula] of double cosets SgA with g∈Γ.

In the proof of Theorem 1.1 we will need the above result in the case n = 2. In this case, if [formula] is finite dimensional then [formula]. Thus it is of interest to understand when a pair of subgroups in a group admit only finitely many double cosets. The following assertions are proved in [\cite=bh2], and are easily verified.

Let G be a group, A,B,C subgroups of G with A  ⊂  C and [formula], and f:G  →  H a homomorphism. Then

[formula], and

[formula].

Some homological algebra

In this section we gather the homological algebra that we shall need in the proof of the main theorem.

The LHS spectral sequence

Associated to any short exact sequence of groups 1  →  A  →  B  →  C  →  1 one has the Lyndon-Hochschild-Serre (LHS) spectral sequence in homology (see [\cite=brown], or [\cite=hs]). Given a [formula]-module M, the E2 page of the spectral sequence has (p,q)-entry Hp(C,  Hq(A,M)), and the spectral sequence converges to H*(B,M).

The computations in this article concern Hi(B) with trivial coefficients and i  ≤  2. The terms of relevance on the E2 page are

[formula]

In each of our calculations, the first and last of these terms will be finitely generated and we will be concerned with the issue of finite generation for H1(C,H1(A)). The only non-zero derivative hitting this group is d2:H3(C,H0(A))  →  H1(C,H1(A)). Since the terms E∞p,q with p + q = 2 are the composition factors of a filtration of H2(B), we see that H2(B) will be finitely generated only if the quotient of H1(C,H1(A)) by the image of d2 is finitely generated. But H3(C,H0(A)) will always be finitely generated in our setting, and hence H2(B) will be finitely generated only if H1(C,H1(A)) is finitely generated.

Fox calculus

Recall that a presentation 〈X|R〉 of a group G gives rise to a partial free [formula]-resolution

[formula]

of the trivial G-module [formula]. Here F1 and F2 are free modules with bases in one-to-one correspondence with X and R respectively.

The boundary maps ∂1 and ∂2 are easy to calculate. ∂1 is given by an X  ×  1-matrix where the x-entry is 1 - x, and ∂2 is given by an R  ×  X-matrix where the (r,x)-entry is the Fox derivative ∂r / ∂x, defined inductively on the length of r by the rules:

[formula]

[formula]

Let [formula] be an HNN extension with stable letter t, and let M be a [formula]-module on which t acts trivially. Then H1(Γ,  M) contains a subgroup that admits an epimorphism onto H0(C,  M).

Given a presentation 〈X|R〉 of G, and a set of generators Y for C (expressed as words in the alphabet X), we have a presentation for Γ of the form

[formula]

for Γ (where the uy are words in X).

We calculate H1(Γ,  M) by tensoring the resolution associated to this presentation with M and calculating ∂2 using Fox calculus. Specifically, we have

[formula]

With regard to the visible decompositions, ∂2 is given by a matrix of the form

[formula]

where [formula], while the restriction of ∂1 to the first factor is multiplication by (1 - t). But since t acts trivially on M, multiplication by (1 - t) is the zero-map on M. Therefore the first factor M in dimension 1 is contained in the group of 1-cycles. Let A denote the subgroup of H1(Γ,  M) generated by this group of 1-cycles.

Now the first coordinate of the image of ∂2 is contained in the submodule N of M generated by {(y - 1)M, ~ y∈Y}. It follows that the kernel of the natural epimorphism M  →  A is contained in N. Thus there is an epimorphism A  →  M / N, and since Y generates C, the quotient M / N is the group of coinvariants H0(C,  M).

A mapping cylinder argument

We are grateful to Peter Kropholler for a helpful conversation concerning the following lemma.

If G is of type [formula] and acts cocompactly on a tree with all edge-stabilisers of type [formula], then all vertex-stabilisers are also of type [formula].

If V, E are the vertex and edge sets of the tree, then the hypothesis on edge-stabilisers is equivalent to [formula] having a projective [formula]-resolution that is finitely generated in dimensions ≤  n, and the assertion of the lemma is that the analogous property for [formula] holds.

Since the action is cocompact, [formula] is finitely generated as a [formula]-module, so there is a projective [formula]-resolution F for [formula] that is finitely generated in dimension 0.

Suppose inductively that k < n and there is a projective [formula]-resolution F for [formula] that is finitely generated in dimensions ≤  k. Let P be a projective [formula]-resolution for [formula] that is finitely generated in dimensions ≤  n.

Let f:P  →  F be a chain-map lifting the boundary map [formula], and form the mapping cylinder resolution M  =  M(f) of [formula].

Thus [formula] is finitely generated in dimensions i  ≤  k. The boundary maps Di:Mi  →  Mi - 1 are defined by

[formula]

where dP and dF are the boundary maps in P and F respectively.

Since k < n and G is of type [formula], the kernel of the k-th boundary map Dk:Mk  →  Mk - 1 is finitely generated. Since also Pk + 1 is finitely generated, there is a finitely generated [formula]-direct summand L of Fk + 1 such that

[formula]; and

fk + 1(Pk + 1)  ⊂  L.

Now suppose that [formula]. Then [formula], so by (i) we can find b∈Pk and c∈L such that

[formula]

Then [formula], so we can find e∈Pk + 1 such that b  =  dk + 1(e). Then fk(b)  =  fk(dk + 1(e))  =  dk + 1(fk + 1(e)), and a  =  ( - 1)kfk(b)  +  dk + 1(c)  =  dk + 1(( - 1)kfk + 1(e)  +  c)∈dk + 1(L) (using (ii)).

Hence [formula] is finitely generated. It follows that there is a projective [formula]-resolution of [formula] that is finitely generated in dimensions ≤  k + 1.

By induction, there is a projective [formula]-resolution of [formula] that is finitely generated in dimensions ≤  n. In other words, the vertex stabilisers of the action are all of type [formula], as claimed

The main argument

In this section we prove Theorem 1.1 and Corollary 1.2.

Reduction to subdirect products

Let Γ1 and Γ2 be non-abelian limit groups. Let S  ⊂  Γ1  ×  Γ2 be a subgroup and let pi:S  →  Γi be the natural projection. If S is of type [formula], then [formula] is finite dimensional, so [formula] is finite dimensional for i = 1,2. By Theorem [\ref=1factor], pi(S)  ⊂  Γi is a limit group. Replacing Γi by pi(S), we reduce to the case where S projects onto each factor Γi.

Let [formula]. If L1 were trivial, then [formula] would be a limit group, satisfying the conclusion of Corollary [\ref=fpres]. Thus we may assume that Li is non-trivial for i = 1,2 (and Corollary [\ref=fpres] becomes a weak form of Theorem [\ref=main]).

Since pi(S) = Γi and Li is normal in S, we also have that Li = pi(Li) is normal in Γi.

Subgroups of finite index

Throughout the proof we shall repeatedly pass to subgroups of finite index in one or other of the Γi. When we do so, we shall be assuming that S is replaced with the inverse image of this subgroup under the projection pi:S  →  Γi and Γj (j  ≠  i) is replaced by pjp- 1i(Hi). This does not affect Lj.

It is because of the need to pass to subgroups of finite index that we have assumed that S is of type [formula] rather than simply that H2(S) is finitely generated: the former hypothesis passes to subgroups of finite index, whereas the latter does not necessarily.

Useful lemmas and special cases

Much of our proof will revolve around the LHS spectral sequences associated to the short exact sequences for the projections of S to the two factors 1  →  L2  →  S  →  Γ1  →  1 and 1  →  L1  →  S  →  Γ2  →  1. In particular, following the discussion in subsection [\ref=LHS], we shall use the hypothesis that S is of type [formula] by assuming that [formula] is finitely generated for j  ≠  i. In the ensuing argument we shall make several appeals to the following:

Let S be a subdirect product of two non-abelian limit groups Γ1 and Γ2, such that the intersections [formula] and [formula] are both non-trivial. If either [formula] or [formula] is finite dimensional, then S has finite index in Γ1  ×  Γ2.

Suppose that [formula] is finite dimensional. It follows from Theorem [\ref=1factor] that L1 is finitely generated, and from Theorem [\ref=norm] and Remark [\ref=normal] that L1 has finite index in Γ1. Therefore, after replacing Γ1 by L1, we can split 1  →  L2  →  S  →  Γ1  →  1 to obtain S = Γ1  ×  L2. Thus L2, being a retract of S, is finitely generated, so of finite index in Γ2.

Let G1 be a group and let Γ2 be a limit group. Let S  ⊂  G1  ×  Γ2 be a subgroup of type [formula] that projects onto Γ2, and that intersects Γ2 non-trivially. Suppose that Γ2 can be expressed as an amalgamated free product or HNN extension with cyclic edge-group C.

If [formula] has finite index in C, then [formula] is finite dimensional.

Let [formula] and let [formula]. Since the cyclic subgroups of Γ2 are closed in the profinite topology, we may pass to a subgroup of finite index which intersects C in [formula] and hence assume that C  ⊂  L2.

By appealing to Theorem [\ref=mh] and passing to a further subgroup of finite index, we may assume that Γ2 is an HNN extension [formula] with stable letter t∈L2.

Consider the Lyndon-Hochschild-Serre spectral sequence in [formula]-homology corresponding to the group extension

[formula]

The action of S by conjugation on L1 induces an action of Γ2 = S / L1 on [formula] in which L2 acts trivially. In particular t and C act trivially on the Γ2-module [formula], for each k.

The (1,1)-term E31,1 on the E3-page of this spectral sequence survives to infinity, and so is isomorphic to a subquotient of [formula], which is finite-dimensional, by hypothesis. Hence E31,1 is finite-dimensional. But E31,1 is the cokernel of the differential d:E23,0  →  E21,1 from the E2-page. Moreover, [formula] is finite-dimensional, since the limit group Γ2 has type [formula]. Hence [formula] is finite-dimensional.

Since t acts trivially on [formula], we may apply Lemma [\ref=foxy], with Γ  =  Γ2 and [formula]. It follows that [formula] is finite-dimensional. And [formula] since C acts trivially on [formula].

The spectral sequence argument ending with the penultimate paragraph of the preceding proof admits a straightforward generalisation as follows. If S is of type [formula], k  ≤  n - 1 and [formula] is finite dimensional for j  <  k, then [formula] is finite-dimensional. Taking [formula] in the final paragraph then implies [formula] is finite-dimensional.

To generalise further, recall that Theorem 2.4 is a weak form of what we actually proved in [\cite=bh2] concerning the existence of stable letters in normal subgroups. Correspondingly, we can weaken the hypotheses on Γ2 and C in the above proposition, and appeal to [\cite=bh2] instead of Theorem 2.4. These remarks lead to the following generalisation (which will not be needed in the sequel).

Let G1 and G2 be groups. Suppose G2 is of type [formula] and admits an l-acylindrical splitting (for some l > 0) over a subgroup C that is closed in the profinite topology.

Let S  ⊂  G1  ×  G2 be a subgroup of type [formula] that intersects G2 non-trivially and intersects C in a subgroup of finite index. Then [formula] is finite dimensional for i  ≤  n - 1.

In the light of Lemma 4.3, the following is an immediate consequence of Proposition [\ref=prop].

Let Γ1 and Γ2 be non-abelian limit groups. Let S  ⊂  Γ1  ×  Γ2 be a subdirect product of type [formula] that intersects each of the factors non-trivially. Suppose that Γ2 has a graph-of-groups decomposition with a cyclic edge-group C.

If [formula] has finite index in C, then S has finite index in Γ1  ×  Γ2.

In the case where C is trivial we have:

Let Γ1 and Γ2 be non-abelian limit groups and let S  ⊂  Γ1  ×  Γ2 be a subdirect product of type [formula] that intersects each of the factors non-trivially. If Γ2 is a nontrivial free product, then S has finite index in Γ1  ×  Γ2.

The remaining non-abelian limit groups of height 0 are covered by:

Let Γ1 and Γ2 be non-abelian limit groups with Γ2 the fundamental group of a compact surface. Let S  ⊂  Γ1  ×  Γ2 be a subdirect product that intersects each of the factors non-trivially.

If S is of type [formula], then S has finite index in Γ1  ×  Γ2.

Passing to an index 2 subgroup of Γ2 if necessary, we may assume that the surface in question is orientable, and by Corollary [\ref=freeprod] we may assume that it is closed.

Fix α  ≠  1 in L2. By a theorem of Scott [\cite=scott], there is a finite-sheeted cover of Σ in which α lifts to a simple closed curve. Replacing Γ2 by the corresponding subgroup of finite index, we may asume that Γ2 splits over the cyclic subgroup 〈α〉  ⊂  L2. The result then follows from Corollary [\ref=entriv].

The following observation will be used to control the way in which S intersects each non-abelian vertex group in the decomposition of Γ2 provided by Proposition [\ref=graph].

Let Γ1 and Γ2 be non-abelian limit groups and S  ⊂  Γ1  ×  Γ2 a subdirect product of type [formula] with [formula] non-trivial for i = 1,2. Consider a graph-of-groups decomposition G of Γ2 that has cyclic edge groups and a vertex group Γv that is a non-abelian limit group. Then [formula].

In G we fix an edge e incident to the vertex v and denote the corresponding edge group Γe  ⊂  Γ2. We also fix a graph-of-groups decomposition of Γ1 that has a cyclic edge group Γf (see Proposition [\ref=graph] and the remark following it).

Using Theorem [\ref=mh], we may replace Γ1 and Γ2 by subgroups of finite index and assume that they split as HNN extensions with amalgamated subgroups Γe,Γf and stable letters in L1 and L2, respectively. The Double Coset Lemma (Theorem [\ref=dcl]) then tells us that [formula] contains a subgroup isomorphic to

[formula]

Since [formula] is finitely generated, [formula]. So, by Proposition [\ref=p:dc], [formula]. Applying the projection p2:S  →  Γ2, we have [formula], by Proposition [\ref=p:dc]. Hence

[formula]

again by Proposition [\ref=p:dc]. Now, [formula] is generated by L2 = p2(L2) and a cyclic group, so if [formula] then [formula] would be a cyclic group.

But if C were cyclic, then in the non-abelian, residually-free group Γv we would have two cyclic subgroups, C and Γe, such that [formula]. But this is impossible, for there is an epimorphism, φ say, from Γv onto a non-abelian free group F, where the conclusion (from Proposition [\ref=p:dc]) that the cyclic subgroups φ(C) and φ(Γe) satisfy [formula] is absurd.

Completing the proof of Theorem [\ref=main]

We have non-abelian limit groups Γ1,Γ2 and a subdirect product S  ⊂  Γ1  ×  Γ2 of type [formula] such that [formula] and [formula] are non-trivial. We want to prove that S has finite index in Γ1  ×  Γ2. We shall do so by induction on

[formula]

where height is defined as in subsection 2.1. Let hi  =  (Γi) for i = 1,2.

Corollaries [\ref=freeprod] and [\ref=surface] cover the case where h2 = 0 and the case where Γ2 is freely decomposable. Thus, by Proposition [\ref=graph], we may assume that Γ2 has a graph-of-groups decomposition [formula] with infinite-cyclic edge groups such that each edge is incident at a vertex where the vertex group is a non-abelian limit group of height ≤  h2 - 1. Let Γv be such a vertex group and let Γe be an incident edge group. Lemma [\ref=l:vtriv] tells us that [formula]. Corollary [\ref=entriv] tells us that S has finite index in Γ1  ×  Γ2 unless [formula]. Thus we proceed with the assumption that [formula] for all edges e in the graph X. (This will ultimately lead to a contradiction.)

Let p2:S  →  Γ2 be the natural projection and let Se = p- 12(Γe).

Claim: Se is a limit group.

Since [formula] is trivial, the projection S  →  Γ1, which has kernel L2, restricts to an injection on Se. Thus Se is isomorphic to a subgroup of a limit group and the claim will follow from Theorem [\ref=1factor] if we prove that [formula] is finite dimensional.

By Theorem [\ref=mh], we may assume that Γ2 splits as an HNN extension with amalgamated subgroup Γe and stable letter t∈L2. (This reduction involves passing to a subgroup of finite index Se'  ⊂  Se, but if [formula] is finite dimensional, then [formula] is.)

Let [formula]. Analysing the LHS spectral sequence for

[formula]

exactly as in the proof of Proposition [\ref=prop], we see that since [formula] is finite dimensional, H1(Γ2,  M) is finite dimensional, and hence so is H0(Γe,  M), by Lemma [\ref=foxy].

We can now calculate [formula] using the LHS spectral sequence for

[formula]

The relevant terms on the E2 page are [formula] and H0(Γe,  M), which we have just argued is finitely generated. Thus [formula] is finite dimensional and our claim is proved.

The graph of groups decomposition [formula] pulls back to a graph of groups decomposition [formula] with the same underlying graph X. Here the vertex and edge groups have the form Sv = p- 12(Γv) and Se = p- 12(Γe) respectively, as v and e vary over the vertices and edges of X. We have just shown that the edge groups Se are all limit groups. In particular each Se has a finite classifying space [\cite=AB], and so is of type [formula].

We are assuming that S is of type [formula], so by Lemma [\ref=MV], we can now deduce that the vertex groups Sv are all of type [formula].

For the remainder of the proof we focus our attention on a single non-abelian vertex group V: = Γv in G and the corresponding vertex group Sv in S. Let Λ be the projection of Sv to Γ1. Since [formula] is finite dimensional, so is [formula]. By Theorem [\ref=1factor], Λ is a limit group (of height at most h1). Moreover, V is a limit group of height strictly less than h2 (see [\ref=graph]).

Thus we have a product of limit groups Λ  ×  V with the sum of heights < h, and a subgroup Sv  ⊂  Λ  ×  V that is of type [formula] and projects onto each factor. Moreover [formula], which is non-abelian since it is non-trivial and normal in the non-abelian limit group Γ1. Hence, in particular, Λ is non-abelian.

We also have, by hypothesis, that V is non-abelian and that [formula]. Thus we may apply our inductive hypothesis to conclude that Sv has finite index in Λ  ×  V. Since [formula], we conclude that L1 has finite index in Λ and hence is finitely generated. Lemma [\ref=ll] then implies that S has finite index in Γ1  ×  Γ2. This contradicts the fact that [formula] was assumed to be trivial for each of the infinite-cyclic edge groups Γe  ⊂  Γ2. [formula]

Abelian factors

Our main theorem concerns a subdirect product of two non-abelian limit groups. The result is false as stated in the case where one or both of the limit groups is allowed to be abelian.

An abelian limit group is just a free abelian group of finite rank. In particular, every subgroup of a direct product of two such groups is of type [formula]. More generally, one can easily construct counterexamples to the exact analologue of the main theorem in which one of the factors is allowed to be non-abelian, along the following lines.

Let Γ1 be a non-abelian limit group, and [formula] an epimorphism for some k  ≥  1. Let [formula] for some m > k, and let [formula] be an epimorphism. Let S  ⊂  Γ1  ×  Γ2 be the fibre product of f1 and f2. Then [formula] is a subdirect product of type [formula] and [formula] is non-trivial for i = 1,2, but S does not have finite index in Γ1  ×  Γ2.

It is not difficult to show that all counterexamples to the exact analogue of the main theorem are, up to finite index, isomorphic to one of the above types. In particular, in each case the group S under consideration is itself a direct product of limit groups, up to finite index.

This observation is a special case of Corollary [\ref=abfactors]. We are now ready to prove Corollary [\ref=abfactors], which we restate here as

Let [formula] be limit groups, with [formula] abelian, and let [formula] be a subdirect product such that S is of type [formula] (where m =  min (n,3)). Then S is isomorphic to a subgroup of finite index in a product of at most m limit groups.

If all the Γi are abelian, then S is a free abelian group of finite rank, and hence a limit group. If, on the other hand, none of the Γi are abelian, then the result follows from Corollary [\ref=fpres]. Hence we may assume that n  ≥  2, that Γ1 is non-abelian, and that Γn is abelian.

If Γn - 1 is abelian, let Gn - 1 be the image of S under the direct projection [formula]. The result for [formula] follows easily from the corresonding result for [formula].

Hence we may assume that there is precisely one abelian factor, namely Γn, and hence that n∈{2,3}. Let [formula]. Since Γn is abelian, we may assume (up to replacing Γn by a finite index subgroup) that Ln is a direct factor of Γn. Say [formula].

Let π:Γn  →  Ln be the projection with kernel M, and define [formula]. Then θ|S is a splitting of the inclusion map Ln  →  S, so [formula], where [formula].

Now [formula], and so T is isomorphic to a subgroup of [formula]. Moreover, T is of type [formula] since [formula] is of type [formula]. It follows from the main theorem that T has finite index in [formula].

Hence S is, up to finite index, a product of at most m limit groups, as claimed.

The natural conjecture for n factors

The results of this paper, and of [\cite=bh2], encourage us to make the following conjecture, which would give a positive answer to a question of Sela [\cite=zlil:qu].

Let [formula] be limit groups, and S a subgroup of [formula] such that S has type [formula]. Then S has a subgroup of finite index that is itself a direct product of n or fewer limit groups.

More precisely, we believe:

Let [formula] be non-abelian limit groups and [formula] a subdirect product that intersects each Γi non-trivially. If exactly k > 0 of the intersections [formula] are not finitely generated, then there exists a subgroup of finite index S0  ⊂  S such that [formula] is infinite dimensional.

The arguments in [\cite=bh1] and [\cite=bh2] prove these conjectures in the case where the Γi are subgroups of elementarily free groups. Those arguments used in a crucial way the fact that the top of the ω-residually free tower decomposition is a quadratic block. It does not seem plausible to extend the methods of [\cite=bh2] to the case where each of the Γi has an abelian block at the top of its ω-rft decomposition.

In the present paper, we addressed the case where at most 2 of the Γi are non-abelian, which reduces easily to the case of precisely two factors, each non-abelian. This more algebraic approach (which is closer to the argument we used with Miller and Short in the surface case [\cite=BHMS]) may eventually lead to a proof in the general case. However, there are considerable difficulties associated to the fact that one must repeatedly pass to subgroups of finite index. It seems possible that these may be overcome by converting many of our arguments based on the finiteness of various homology groups into arguments based on properties of corresponding homology functors, but we do not know how to do this at present.

Authors' addresses