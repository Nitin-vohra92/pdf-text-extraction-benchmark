Definition Lemma Corollary Example Remark

On the quantum hardness of solving isomorphism problems as nonabelian hidden shift problems

Introduction

One of the major challenges of quantum computing is to determine whether there exists an efficient quantum algorithm to decide if two graphs are isomorphic. It is well known that the graph isomorphism problem can be reduced to a hidden subgroup problem over the symmetric group . This approach seems to be promising since hidden subgroup problems over many groups, including arbitrary abelian groups and some nonabelian ones can be solved efficiently on a quantum computer. An efficient quantum algorithm for graph isomorphism would be interesting since no efficient classical algorithm for the problem is known; the best known classical algorithm for deciding isomorphism of n-vertex graphs runs in time [formula] for some constant c [\cite=BKL83].

Unfortunately, the only results so far on the quantum complexity of the graph isomorphism problem consist of evidence that the problem might be hard (with the notable exception of the result that the query complexity of the associated hidden subgroup problem is polynomial [\cite=EH99]). The graph isomorphism problem can be reduced to a hidden subgroup problem in S2n where the hidden subgroups are generated by full support involutions. Hallgren, Russell, and Ta-Shma showed that weak Fourier sampling, in which one performs a nonabelian Fourier transform but then only measures the name of an irreducible representation, is insufficient to solve the problem [\cite=HRT03]. Kempe and Shalev generalized their result to show that finding other subgroups of the symmetric group is also hard [\cite=KS04]. Finally, Moore, Russell, and Schulman have obtained results about the need to use multi-register measurements on the hidden subgroup states obtained by Fourier sampling. In particular, if one is restricted to single-register measurements (in the standard approach known as strong Fourier sampling), an exponential number of hidden subgroup states is required [\cite=MRS05]. Similarly, if one is restricted to two-register measurements, then a superpolynomial (though possibly subexponential) number of hidden subgroup states is required [\cite=MR05]. Strictly speaking, these results do not show that the hidden subgroup problem directly relevant to graph isomorphism is hard, since the possible subgroups resulting from the graph isomorphism reduction are not generated by arbitrary full support involutions, but by involutions having further properties (as we will discuss further in Section [\ref=sec:iso], in connection with the hidden subgroup problem over [formula]). However, concurrently with the present work, Moore, Russell, and Schulman have improved their result for single-register measurements to cover the special case directly relevant to graph isomorphism [\cite=MRS05comm].

In this paper, we study an alternative approach to solving graph isomorphism on a quantum computer, by viewing it as an instance of a nonabelian hidden shift problem. This approach is arguably more natural than viewing the problem as a hidden subgroup problem: every possible hidden shift corresponds to a possible isomorphism (whereas there are many subgroups of either S2n or [formula] that do not correspond to isomorphisms); and furthermore, viewed as black box problems, the hidden shift problem can be reduced to the hidden subgroup problem. The hidden shift problem can be tackled on a quantum computer using a standard method that closely parallels the standard approach to the hidden subgroup problem. We present two hardness results for this standard approach to the hidden shift problem over Sn.

First, we prove that Ω(n) copies of the hidden shift state are necessary to solve the problem (whereas O(n log n) copies are sufficient). The idea behind this bound is the simple observation that the hidden shift problem for the largest abelian subgroup of Sn is at least as hard as for the whole group Sn. In the case where the group G is abelian, the hidden shift problem for G is equivalent to the hidden subgroup problem over the generalized dihedral group [formula], and it is straightforward to obtain a reasonably tight bound for this case using a connection to the subset sum problem over G. Since Sn contains large abelian subgroups, the resulting bound for the nonabelian hidden shift problem is not too bad.

Second, we present a simple proof that single-register measurements are not sufficient to solve the hidden shift problem over Sn. In fact, this result holds for any group that has many irreducible representations of sufficiently high degree. In particular, the only property of Sn used in the proof is the fact that under the Plancherel distribution, an irreducible representation of Sn with degree larger than nΘ(n) occurs with probability at least 1 - n-  Ω(n).

The remainder of the paper is organized as follows. In Section [\ref=sec:shift] we define the nonabelian hidden shift problem and discuss the standard approach to solving it. In Section [\ref=sec:iso] we discuss how isomorphism problems (including, but not limited to, graph isomorphism) can be cast as hidden shift problems. In Section [\ref=sec:numcopies] we prove the linear lower bound on the required number of copies of hidden shift states. In Section [\ref=sec:structure] we examine the structure of the hidden shift states for arbitrary groups and obtain some results needed for Section [\ref=sec:single], where we show that single register measurements are insufficient. Finally, in the Appendix, we present some additional results on the rank of the hidden shift states.

Nonabelian hidden shift problem

The (nonabelian) hidden shift problem is the following. We are given black-box access to two functions f0:G  →  S and f1:G  →  S where G is a (nonabelian) group and S is a finite set. The functions are promised to satisfy two conditions:

Both f0 and f1 are injective.

Either there exists a fixed hidden shift s∈G such that f0(g) = f1(gs) for all g∈G, or the images of f0 and f1 are disjoint (in which case we say there is no hidden shift).

The goal is to determine whether there is a hidden shift s or not.

The case where G is an abelian group has received considerable attention . Since inversion is an automorphsim of any abelian group, the hidden shift problem in G is a hidden subgroup problem in the generalized dihedral group [formula] where [formula] acts by inversion. In particular, the case where G is cyclic is the well-known dihedral hidden subgroup problem. However, the case where G is nonabelian, in which case the hidden shift problem is not a hidden subgroup problem, seems not to have been studied extensively.

In this paper, we focus on a particular natural approach to solving the hidden shift problem on a quantum computer, paralleling the standard quantum approach to the hidden subgroup problem. First prepare a uniform superposition over [formula] and g∈G, and then compute the value of fi(g), giving the state

[formula]

Then measure the third register. If there is a hidden shift s, then we are left with the state

[formula]

for some uniformly random (unknown) g∈G. On the other hand, if there is no hidden shift, we obtain the state |i,g〉 for some uniformly random (unknown) [formula] and g∈G. Thus the density matrix obtained by applying the procedure is either γ(s) := |φ〉〈φ| γ := I if there is no hidden shift. Using the state thus obtained, we would like to decide whether there is a hidden shift or not.

In general, we can apply the above procedure k times to obtain k copies of the hidden shift state (or the maximally mixed state if there is no hidden shift). Clearly, these states become more distinguishable as k is increased. Suppose that in the case where there is a hidden shift s, it is equally likely to correspond to any element of G. Then the problem is to distinguish the two density operators γ := γ(s) γ := I  , where [formula].

A natural generalization of the nonabelian hidden shift problem involves the case of M injective functions, fj for [formula], satisfying fj(g) = fj + 1(gs) for a fixed s∈G for all [formula]. This problem becomes easier as M is increased, and is interesting in the case where G is cyclic, since it has an efficient quantum algorithm provided M is sufficiently large [\cite=CD05]. We will not consider the generalized nonabelian hidden shift problem further in this paper, although it is an interesting question whether this problem has an efficient quantum algorithm even for M sufficiently large.

Isomorphism problems

The nonabelian hidden shift problem for the symmetric group is especially interesting since an efficient quantum algorithm for this problem would yield an efficient algorithm for graph isomorphism (and more generally, for other related isomorphism problems). The usual quantum approach to graph isomorphism relies on a reduction to the hidden subgroup problem for the symmetric group, but the hidden shift problem for G = Sn presents an alternative approach that seems to be at least as natural, and is arguably more so.

We now describe a generalized isomorphism problem that reduces to the hidden shift problem. For each [formula], let Cn be a set of objects of size n. For example, Cn could be the set of graphs on n vertices. We assume that the objects can be uniquely represented using [formula] bits.

Let Gn be a family of (finite) groups such that each Gn acts on Cn. For g∈Gn and C∈Cn, let g(C) denote the element of Cn given by the action of g on C. We call two objects A,B∈Cn isomorphic if there is some g∈Gn such that g(A) = B. We call an object C∈Cn rigid if it has no automorphisms, i.e., if there is no g∈Gn  -  {1} such that g(C) = C.

The C-isomorphism problem is the following. Given two rigid objects C0,C1∈Cn, determine whether they are isomorphic or nonisomorphic. It is straightforward to reduce this isomorphism problem to a corresponding hidden shift problem: simply let fi(g): = g(Ci). (The assumption of rigidity is required to ensure that f0,f1 are injective.)

Graph isomorphism is the special case of the C-isomorphism problem for Gn = Sn where Cn is the set of graphs on n vertices, and the action of Gn is to permute the vertices. Thus, a solution to the generalized hidden shift problem for Gn = Sn would give an efficient algorithm for testing isomorphism of rigid graphs. But such an algorithm could also be applied to other isomorphism problems. For example, if we let Cn be the set of all binary linear codes of length n, where Gn = Sn acts to permute the bits of the code words, then we obtain the code equivalence problem discussed in [\cite=EH99], which is at least as hard as graph isomorphism [\cite=PR97].

As mentioned in the introduction, the usual approach to solving graph isomorphism on a quantum computer is based not on the hidden shift problem, but on the hidden subgroup problem. Graph isomorphism can be cast as a hidden subgroup problem over S2n where the hidden subgroups are generated by full support involutions. A more careful inspection of the hidden subgroups that occur in this reduction shows that it is sufficient work with a subgroup of S2n: as proposed by Ettinger and Høyer, one can cast graph isomorphism as a hidden subgroup problem over the wreath product [formula] where the hidden subgroups are generated by so-called involutive swaps [\cite=EH99].

How are the hidden subgroup and hidden shift approaches to graph isomorphism related? In general, one can show that the hidden shift problem in a group G can be reduced to the hidden subgroup problem in [formula]. In particular, the hidden shift problem in Sn reduces to the hidden subgroup problem in [formula] (and in fact, using the results of [\cite=WH05], one can also show that it reduces to the hidden subgroup problem in S2n). Since the hidden shift problem is no harder than the corresponding hidden subgroup problem, this suggests that the hidden shift problem might present a more natural quantum approach to graph isomorphism. However, we emphasize that our hardness results about measurements of hidden shift states do not imply corresponding results about hidden subgroup states, since the reduction does not necessarily still hold when we assume the use of the standard method to produce particular quantum states.

Lower bound on the number of copies

In this section, we show that Ω(n) copies of the hidden shift states are needed to successfully determine whether there is a hidden shift. We do this by showing that the optimal POVM is unlikely to produce the correct answer unless k = Ω(n).

Consider the general problem of distinguishing a pair of (possibly mixed, a priori equiprobable) quantum states. The optimal measurement for this problem (in the sense that it maximizes the probability of successfully identifying the state) was discovered by Helstrom [\cite=Hel76], and is as follows. Suppose we wish to distinguish the quantum states ρ1,ρ2. Then let E1 be the projector onto the eigenvectors of ρ1  -  ρ2 corresponding to positive eigenvalues, and let E2 be the projector onto the eigenvectors of ρ1  -  ρ2 corresponding to negative eigenvalues. (Eigenvectors in the nullspace of ρ1  -  ρ2 can be associated to either E1 or E2 without affecting the success probability.)

In principle, Helstrom's result tells us the optimal measurement to distinguish γ(k)1 and γ(k)2. Unfortunately, since we do not have a good understanding of the spectrum of γ(k)1 for nonabelian groups, we do not know how to estimate the success probability of the Helstrom measurement in such cases. However, we can obtain a good estimate of the success probability for abelian groups, and we can obtain a bound for arbitrary groups since a bound for a subgroup implies a bound for the full group. Specifically, we have

The number of copies needed to solve the hidden shift problem in the group G (with a probability of success bounded above 1 / 2 by a constant) is at least as great as the number of copies needed to solve the hidden shift problem in any subgroup H  ≤  G.

Clearly, if the possible hidden shifts are restricted to be from a subgroup H  ≤  G, the problem is at least as hard as when the hidden shift may be arbitrary. For a uniformly random hidden shift s∈H, the density matrix when there is a hidden shift is

[formula]

which can be written as the tensor product of the unrestricted hidden shift state in H and a maximally mixed state of dimension |G| / |H|. Since the maximally mixed state provides no information about the hidden shift, the restricted problem in G is equivalent to the hidden shift problem for H.

Now we give a general lower bound on the number of copies needed to solve an arbitrary abelian hidden shift problem. In the abelian case, we can give fairly tight bounds using the close connection between the hidden shift problem and the subset sum problem . Specifically, after performing a Fourier transform on the group register, we can write the abelian hidden shift states as

[formula]

where

[formula]

is the set of solutions of the subset sum problem over G, ηxw: = |Sxw| is the number of such solutions, and

[formula]

is the normalized uniform superposition over those solutions (where we define |Sxw〉: = 0 in the event that ηxw  =  0). Thus, with a uniformly random hidden shift, we have the state

[formula]

In the standard approach to the abelian hidden shift problem, our goal is to distinguish this state from the maximally mixed state. An optimal measurement for doing so is the measurement that projects onto the support of γ̃(k)1. Since the eigenvalues of γ̃(k)1 are integer multiples of 1 / (2|G|)k, the operator γ̃(k)1  -  γ̃(k)2 is nonnegative precisely on the support of γ̃(k)1. Therefore, the projection onto that support is a Helstrom measurement, and hence is optimal.

Having identified an optimal measurement, we can now show

For any abelian group G, k = Ω( log |G|) copies of the hidden shift states are needed to decide whether there is a hidden shift (with a probability of success bounded above 1 / 2 by a constant).

The success probability of the optimal measurement (in which E1 projects onto the support of γ̃(k)1 and E2 projects onto its complement) is Pr() := E γ̃ + E γ̃ = 1 -  . Now γ̃ = δ = |G| - δ  . (For the case [formula], the rank is given by the integer sequence [\cite=OEIS]*A098966. For a discussion of the rank in the general (not necessarily abelian) case, see the Appendix.) To evaluate this expression, we need to understand the typical behavior of ηxw. In particular, it is helpful to know the first and second moments of ηxw for uniformly random x∈Gk, w∈G. For an arbitrary group G, the first moment is

[formula]

For the second moment, we have (η) := (η) = ( δ) = μ + δ   δ = μ + δ = μ +  . Here in the final step we used the fact that for fixed b  ≠  c (with bk  ≠  ck without loss of generality), and for fixed [formula], there is exactly one xk∈G such that b  ·  x  =  c  ·  x. In terms of the variance [formula] we have the inequality  Pr (ηxw  =  0)  ≤  σ2 / (μ2  +  σ2) [\cite=AS00], giving γ ≥ |G| = |G| μ + 1 - ≥ (2|G|) - |G|  . Thus, we find

[formula]

For the success probability to be bounded above 1 / 2 by a constant, we need k = Ω( log |G|) as claimed.

Putting these lemmas together, we have

To solve the hidden shift problem in Sn, Ω(n) copies of the hidden shift states are necessary.

The largest abelian subgroup of Sn has size 3Θ(n) [\cite=BM67] (see also [\cite=OEIS]*A000792). Combining Lemmas [\ref=lem:subgroup] and [\ref=lem:abelian] gives the result.

This result is not too far from the best possible, since O( log |G|) copies are sufficient to solve the hidden shift problem for any group G. This follows easily from ([\ref=eq:prsuc]) and the fact that [formula], and is analogous to the well-known result that O( log |G|) copies of hidden subgroup states are sufficient to solve the hidden subgroup problem [\cite=EHK04]. However, there is a logarithmic gap between these lower and upper bounds. We suspect that the lower bound could be improved, since it only uses information about abelian subgroups, but without a better understanding of the structure of the hidden shift states for large k, it seems difficult to establish a bound.

Note that an analogous bound of Ω(n) has recently been independently established for the hidden subgroup problem over S2n where the hidden subgroup may be an arbitrary full-support involution, and a bound of Ω(n log n) has been established for the hidden subgroup problem over [formula] [\cite=HRS05].

It is worth noting that while the projection onto the support of γ(k)1 is an optimal measurement in the abelian case, it is not an optimal measurement in general. For example, for G = S4, γ(3)1 has eigenvalues between 0 and 1 / (2|G|)3, so that the projection onto the support is not a Helstrom measurement.

Structure of hidden shift states

To show that single-register measurements are not sufficient to solve the hidden shift problem, we need to understand the structure of the states γ(k)1(s), γ(k)1, and γ(k)2. Here we determine their block structure and use it to compute the spectrum of γ(k)1 for k = 1 and 2.

Observe that γ1(s) has the following form: γ(s) = |0,g〉,g| + |1,gs〉,gs| + |0,g〉,gs| + |1,gs〉,g| =  , where R is the right regular representation of G, defined by

[formula]

for all s,g∈G. Recall that the regular representation contains all irreducible representations of G with multiplicities given by their dimensions. More precisely, we have

[formula]

for all s∈G, where F is the Fourier transform over G and Ĝ is a complete set of irreducible representations of G. In other words, the Fourier transform decomposes the regular representation into its irreducible constituents.

Using the Fourier transform, the states γ(k)1(s), γ(k)1, and γ(k)2 can be simultaneously block diagonalized for any [formula]. The blocks are enumerated by k-tuples of irreducible representations. In particular, in the Fourier basis we have γ̃(s) = I B(s) γ̃ = I B γ̃ = I I where B(s) := ( ) B := B(s)  . Here the factor [formula] accounts for the multiplicity of [formula] in k copies of the regular representation of G.

It is straightforward to check that the blocks [formula] and [formula] can be expressed as B(s) = |x〉〈 y| A(s) B = |x〉〈 y| A , where A(s) := ρ(s) ρ(s) ρ(s) A := A(s) for all z∈{ - 1,0,1}k. Clearly, the matrices [formula] are hermitian, that is, [formula].

To understand the form of these matrices, we must carry out the sum in ([\ref=eq:blocksum]) for various choices of the irreducible representations [formula] and the indices [formula]. If all zj have the same sign, then such a calculation is straightforward, using the following well-known result:

Let π be any representation of the group G. Then the matrix

[formula]

is a projection operator whose rank is the number of times the trivial representation appears in π.

Decompose the representation π into irreducible representations. Let σ be any irreducible representation occurring in π. The sum [formula] is a multiple of the identity matrix because B commutes with all σ(h) for h∈G. The trace of B is the inner product of the trivial character and the character of σ. Therefore, B = 1 if σ is the trivial representation and B is the zero matrix if σ is not the trivial representation.

In general, we will have zj's of both signs. In this case we may say that A includes both representations and antirepresentations of G, since g  ↦  ρ(g- 1) is a group antihomomorphism. Fortunately, this case can be dealt with using the following:

Let ρ and σ be two irreducible representations of G. Then the entries of the matrix

[formula]

are given by

[formula]

where i,j are the row and column indices of the first tensor component and k,l are the row and column indices of the second tensor component.

The entries are given by

[formula]

then ([\ref=eq:twist]) follows directly from the Schur orthogonality relations.

Now we are ready to investigate the blocks Bρ for k = 1 and the blocks Bρ,ρ for k = 2.

The block [formula] has eigenvalues 2 and 0. For [formula], Bρ  =  I2dρ.

Since [formula] for all s,

[formula]

which has eigenvalues 2 and 0. For [formula], [formula] by the orthogonality of ρ and [formula], so that Bρ  =  I2dρ as claimed.

For any [formula], either Bρ,ρ has the spectrum 1 (multiplicity 2d2ρ) and 1  ±  1 / dρ (multiplicity d2ρ each); or the spectrum 2 (multiplicity 1), 0 (multiplicity 1), 1 (multiplicity 2d2ρ  -  2), and 1  ±  1 / dρ (multiplicity d2ρ each).

For simplicity, we omit the label ρ,ρ. The block of interest has the form

[formula]

Recall that the blocks of B are enumerated by x,y∈{0,1}2. The matrix at position (x,y) is given by Ay - x, where the A matrices are defined by

[formula]

for z∈{ - 1,0,1}2. We have simplified ([\ref=eq:M2]) to minimize the number of - 1's using the fact that Az is hermitian, so Az = A- z.

Since [formula] by assumption, A0,1 = A1,0 = 0 by the calculation in Lemma [\ref=lem:spect1]. Thus

[formula]

Hence it remains to understand the operators A1,1 and A1, - 1.

Since ρ (and hence also [formula]) is irreducible, the trivial representation appears at most once in [formula], so by Lemma [\ref=lem:averageRep], A1,1 is either zero or a projector of rank one. Hence the matrix

[formula]

is either the identity, or has the eigenvalues 2 and 0 with multiplicity 1, and 1 with multiplicity 2d2ρ  -  1. By Lemma [\ref=lem:averageRepAnti], A1, - 1 has eigenvalues ±  1 / dρ, so that

[formula]

has the eigenvalues 1  ±  1 / dρ each with multiplicity d2ρ.

Single-register measurements do not suffice

In this section we show that single-register measurements do not suffice to efficiently solve the hidden shift problem for G = Sn.

Let us first explain in more detail what is meant by an algorithm restricted to single-register measurements. A POVM E with a set of possible outcomes J is a collection of positive operators E  =  {Ej:j∈J} satisfying the completeness condition

[formula]

An efficient algorithm consists of a polynomial number of POVMs [formula], each acting on a single copy of the hidden shift state. After obtaining the measurement outcomes [formula], a final computation is performed to decide whether there is a hidden shift or not. Note that the individual outcomes ji need not directly correspond to one situation or the other. Also, let us stress out that the POVMs [formula] may be chosen adaptively, that is, Er may depend on all previous outcomes [formula] for 2  ≤  r  ≤  t.

To simplify the analysis, we can refine any POVM E so that each Ej = aj|ψj〉〈ψj| where each |ψj〉 is a unit vector and aj  >  0 without loss of generality. This is because any positive operator can be written as a weighted sum of projection operators, where the weights correspond to the eigenvalues and the projection operators to the eigenspaces. The result of this measurement on the state γ is a random variable, where we obtain j∈J with probability

[formula]

In our case, the POVM can be further simplified because the states γ(k)1(s), γ(k)1, and γ(k)2 can be simultaneously block-diagonalized as described in Section [\ref=sec:structure]. The blocks are labeled by irreducible representations of G. Therefore, as in the hidden subgroup problem, we may assume without loss of generality that we first perform a Fourier transform on the group register and then measure the representation name (so-called weak Fourier sampling). Next, we perform a measurement within the subspace corresponding to the observed representation.

From the block decomposition of the states described in Section [\ref=sec:structure], it is clear that the various irreducible representations of G occur independently according to the Plancherel distribution, i.e.,

[formula]

regardless of whether or not there is a hidden shift. This is analogous to the fact that weak Fourier sampling is insufficient to distinguish between the trivial subgroup and the subgroups generated by full support involutions in the symmetric group [\cite=HRT03].

Suppose we measure the representation name and observe a particular ρ∈Ĝ. Then consider an arbitrary POVM [formula] acting on the subspace of dimension 2dρ corresponding to the observed representation.

If there is no hidden shift (that is, if the state is γ(1)2), then the post-measurement state is I2dρ / (2dρ), and the probability of obtaining the outcome j is

[formula]

We denote this probability distribution by P2. On the other hand, if there is a hidden shift s, then the post-measurement state is Bρ(s) / (2dρ), and the probability of obtaining the outcome j is

[formula]

we denote this distribution by P1,s. We will also be interested in the distribution P1 obtained by averaging over s∈G, i.e., with the probabilities

[formula]

Following , the strategy for proving that single-register measurements are not sufficient is to show that with high probability (over the hidden shift s and the observed representation ρ), the statistics of the measurement results when there is a hidden shift s are close to those when there is no hidden shift. More precisely, we will prove

[formula]

To prove this theorem, we first show that with high probability (over a uniformly random choice of s∈G and the Plancherel distribution of irreducible representations ρ∈Ĝ), the distribution P1,s is close to the distribution P1. Then it suffices to show that P1 and P2 are typically close, which is straightforward (since in fact, they are typically identical).

Because P1 is the average of P1,s over s∈G, we can show that the distributions are likely to be close by showing that the variance of p1(j|s) is small (so that we can apply the Chebyshev inequality). More precisely, we will use the following:

Assume we have measured the irreducible representation [formula], and we perform an arbitrary measurement E  =  {aj|ψj〉〈ψj|:j∈J}. Then

[formula]

where σ2j is the variance of p1(j|s) when s is chosen uniformly from G.

For any fixed j the variance σ2j is given by

[formula]

Recall that we have p1(j) = aj / (2dρ) for all j. This is because we have Bρ = I2dρ for all [formula] as shown in Lemma [\ref=lem:spect1].

The second moment can be expressed in terms of the block Bρ,ρ. We have p(j|s) = 〈ψ|B(s)|ψ〉 = 〈ψ|〈ψ| B(s) B(s) |ψ〉|ψ〉 = 〈ψ|〈ψ|B(s)|ψ〉|ψ〉 = 〈ψ|〈ψ|B|ψ〉|ψ〉  . Set Δ: = |Bρ,ρ - I|. Then we have for the variance the upper bound

[formula]

The operator Δ has the eigenvalue 1 occurring with multiplicity either 0 or 2 and the eigenvalue 1 / dρ occurring with multiplicity 2d2ρ. This follows from Lemma [\ref=lem:spect2] where we have determined the spectrum of blocks of the form Bρ,ρ. Denote the spectral decomposition of Δ by

[formula]

where P,Q are projectors. We bound the sum of the weighted variances by looking at P and Q / dρ separately. We have

[formula]

We also have

[formula]

where the first inequality follows by Lemma 12 in [\cite=MRS05]. Putting these two bounds together and multiplying by 1 / (2dρ)2, we obtain the desired result.

Now we can use this result to show that P1,s and P1 are probably close:

[formula]

For any fixed representation ρ∈Ĝ, according to Chebyshev's inequality,

[formula]

for any c  >  0. Now define

[formula]

and define Jsgood: = J  -  Jsbad. The total variation distance can be decomposed into contributions from good and bad j's. For the good j's, we have |p(j|s)-p(j)| ≤ a c ≤ 2 d c  . Now for any j∈J (and in particular, for j∈Jsbad), we have |p(j|s) - p(j)| = |〈ψ|B(s) - B|ψ〉| ≤ B(s) - B ≤  . Thus it suffices to show that [formula] is small. The expectation of this quantity is a = a   δ = a Pr(j ∈ J) ≤ ≤ where in the last line we have used Lemma [\ref=lem:variance] (assuming [formula], which we will later ensure). Hence by Markov's inequality,

[formula]

for any c'  >  0. Conditioning on this event, we have P - P = |p(j|s)-p(j)| + |p(j|s)-p(j)| ≤ 2 d c + with probability at least

[formula]

Hence if we choose c = c' = e for some fixed α  >  0, we find

[formula]

with probability at least

[formula]

For P1,s and P1 to be close with high probability, it suffices that dρ is large with high probability, so that the second term of ([\ref=eq:distbound]) is small. Thus we condition on the event that dρ  >  nc''n for some constant c'', which occurs with probability at least 1 - n-  Ω(n) [\cite=MRS05]*Lemma 6. This completes the proof.

Finally, we must show that the probability distributions P1 and P2 are close in total variation distance:

For an arbitrary POVM acting on a single copy of the hidden shift state,

[formula]

for [formula] and

[formula]

for the trivial representation [formula].

Let B be the block corresponding to the measured representation. Let Δ: = |I - B|. Then we have P-P = a |〈 ψ|I|ψ〉 - 〈 ψ|B|ψ〉| ≤ a 〈 ψ|Δ|ψ〉 = (a|ψ〉〈 ψ|Δ) = (Δ)  . We have determined the spectrum of B in Lemma [\ref=lem:spect1], from which the lemma follows.

Putting these results together, we can now prove the main result:

Since the trivial representation only appears with probability 1 / n!, we can simply condition on not obtaining the trivial representation, and the result follows from Lemmas [\ref=lem:closetoavg] and [\ref=lem:avgclosetonatural].

Acknowledgments

We thank Dorit Aharonov, Sean Hallgren, Martin Rötteler, and Pranab Sen for helpful discussions about the relationship between the hidden shift and hidden subgroup problems. We thank Sergey Bravyi for a discussion about the decomposition of the product of a representation and an antirepresentation. And we thank David Wales for discussions about the rank of γ(k)1, and in particular, for correctly conjecturing the exact value of [formula] for an arbitrary group. This work was supported in part by the National Science Foundation under contract number PHY-0456720 and by the National Security Agency under Army Research Office contract number W9111NF-05-1-0294.

Rank calculations

Although the measurement that projects on the support of γ(k)1 need not be optimal in general, it is nevertheless a natural measurement to consider--for example, an analogous measurement was used in [\cite=EH99] to show that O(n log n) hidden subgroup states are sufficient to solve a hidden subgroup problem relevant to graph isomorphism. Since we are trying to distinguish γ(k)1 from the maximally mixed state, the success probability of the measurement that projects onto the support depends only on the rank of γ(k)1 (see ([\ref=eq:prsuc])). Here we summarize some results on the rank for k = 1 and 2.

For the case k = 1, Lemma [\ref=lem:spect1] immediately gives

[formula]

For the case k = 2, Lemma [\ref=lem:spect2] gives the contribution to the rank from the cases where the same irreducible representation [formula] occurs twice. It is straightforward to calculate the contribution from the other cases, giving the final result γ = 4|G| - 6 |G| + 3 + d = 4|G| - 5 |G| + 3 - |{ρ ∈ Ĝ: d = 1}|  . In particular, for G = Sn, we have |G| = n! and only two one-dimensional representations (the trivial and sign representations), so

[formula]

Calculations of the rank for larger k would seem to require a better understanding of the structure of γ(k)1.