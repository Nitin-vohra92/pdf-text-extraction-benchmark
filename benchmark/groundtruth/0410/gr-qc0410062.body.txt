Finite differencing second order systemsdescribing black hole spacetimes

Introduction

In recent years there has been a growing interest in discretizing the second order Einstein's equations, in the harmonic gauge or its generalization, without reducing the system to first order form [\cite=Gar] [\cite=SziWin] [\cite=Pre]. The reduction process requires the introduction of auxiliary variables approximating first derivatives of the fields and the introduction of additional constraints. Whereas there are clear advantages in keeping the system of equations in second order form, including the fact that local well-posedness of the continuum Cauchy problem has been shown [\cite=Bru] and the expectation that in general this would lead to smaller numerical errors [\cite=KPY], we point out difficulties that can arise when a standard discretization is used.

After analyzing a toy model problem that captures the essential difficulty, and pointing out its relevance to numerical relativity, we discuss different solutions to this problem. The first order reduction in time based on the introduction of "ADM" type variables seems to be the most attractive of these solutions.

The shifted wave equation

We start with the wave equation in one spatial dimension, [formula], and perform a Galilean change of coordinates, t  =  t̃, x  =    -  βt̃, where β is a constant. This leads to

[formula]

which we will refer to as the shifted wave equation. By performing a differential reduction to first order we see that the characteristic variables and speeds are φt  -  βφx  ±  φx, β  ±  1. The variable φ is also a characteristic variable, the speed of which is undetermined (it depends on the details of the reduction and one can choose what one pleases). The initial value problem for this system is well-posed for any value of β. In fact, an energy estimate can be obtained by noting that the quantity

[formula]

is positive definite in φt, φx and is conserved for any β.

We introduce the grid xj  =  jh, where h is the space step, and the grid-function φj(t) approximating φ(t,xj). Leaving time continuous, the standard second order accurate approximation of Eq. ([\ref=Eq:shiftedwave]) is

[formula]

where hD+uj  =  uj + 1 - uj, hD-uj  =  uj  -  uj - 1 and 2D0  =  D+ + D-. Consider the discrete quantity

[formula]

where [formula]. For |β|  <  1 this expression is positive definite in φt, D+φ and is conserved. As in the continuum case, the energy estimate follows. The semi-discrete system is stable.

On the other hand, if |β| > 1, there does not exist a positive definite quantity from which one can derive a discrete energy estimate. A closer look at Eq. ([\ref=Eq:semiwave]) reveals that there might be a problem with the highest frequency (and those nearby), due to the fact that D0 is unable to see it, D0( - 1)j  =  0. Consequently, at this frequency Eq. ([\ref=Eq:semiwave]) appears to be elliptic. It is not difficult to show that the semi-discrete problem admits solutions that grow exponentially without bound in h. Inserting φj(t)  =  estj into Eq. ([\ref=Eq:semiwave]) we obtain

[formula]

where s̃  =  sh. For j  =  ( - 1)j, we get s̃2  =  4(β2 - 1). Hence, the grid-function

[formula]

is a solution of Eq. ([\ref=Eq:semiwave]), the growth of which cannot be bounded independently of h. Notice that this analysis also applies to the first order in time, second order in space system

[formula]

In particular, this shows that schemes such as the forward Euler, backward Euler, Runge-Kutta, Crank-Nicholson and leap-frog methods applied to either Eq. ([\ref=Eq:semiwave]) or system ([\ref=Eq:semiwave2]) are unstable if |β| > 1. The scheme is also unstable for |β|  =  1. However, in this case the instability is less severe (the system admits linearly growing frequency dependent solutions).

A toy model problem similar to the shifted wave equation was considered by Alcubierre and Schutz [\cite=AlcSch], who proved instability for an implicit scheme and proposed using causal differencing [\cite=SeiSue] [\cite=Schetal] [\cite=GunWal] [\cite=LehHuqGar] to eliminate the instability. Our semi-discrete analysis leads to a more general result, namely that the instability is due to the spatial discretization and does not depend on the time integration. Furthermore, it is important to realize that this type of instability does not appear in fully first order systems. In these cases one can handle high values of the characteristic speeds by choosing a sufficiently small Courant factor (and possibly adding artificial dissipation in the variable coefficient case). Whenever causal differencing has been applied to first order systems, it has not brought substantial improvements [\cite=Schetal] [\cite=GunWal].

Before discussing how we propose to fix this problem, we show how it can arise in discretizations of second order systems of Einstein's equations. For concreteness, we consider formulations having principal part determined by a wave operator of the form gμν∂μ∂ν, where gμν is the inverse 4-metric of spacetime. Precisely this operator appears in the (generalized) harmonic gauge [\cite=Wal]. We keep the system in second order form and use the standard spatial discretization. Assuming that the coordinates are chosen such that the t = const. slices are space-like, i.e., gtt < 0, one can expect the instability to arise whenever the spatial coordinates are such that an xi  =  const. hyper-surface is also space-like, i.e., gii < 0 (no sum). Again, to the highest grid frequency this problem appears to be elliptic. Interestingly, the last condition, gii < 0, is a requirement for excision, a technique often used in numerical relativity to eliminate the black hole singularity from the computational domain. This shows that when discretizing second order systems describing spacetimes containing black holes, one has to ponder over the discretization.

Another instance in which this type of instability can arise is when rigidly co-rotating coordinates are used. These coordinates are introduced to attempt to keep a binary black hole system at a fixed coordinate location [\cite=Bruetal] [\cite=Dueetal]. At large distances the semi-discrete wave operator effectively becomes elliptic for the highest frequencies.

We now go back to the model equation ([\ref=Eq:semiwave]) and discuss several methods to overcome the instability that occurs for |β| > 1, without reducing the spatial derivative.

Method 1: We know that the addition of artificial dissipation can sometimes stabilize otherwise unstable schemes. If we modify system ([\ref=Eq:semiwave2]) as follows

[formula]

we see that the von Neumann condition, which is only a necessary condition for stability, is satisfied for sufficiently large values of the dissipation parameter (for example [formula] for |β|  =  2). However, such a great amount of dissipation demands high resolution to prevent excessive damping and requires a rather small Courant factor. For fourth order Runge-Kutta (4RK) in the |β| = 2 case we need [formula], where k is the time step.

Method 2: Perhaps the simplest solution is to replace the one sided operators D± in Eq. ([\ref=Eq:semiwave]) with the centered one, D0. This amounts to discretizing the second spatial derivatives with the D20 operator instead of D+D-, as suggested in [\cite=Bonetal] [\cite=BabSziWin], leading to a scheme with a five point stencil instead of three. With such discretization the discrete version of ([\ref=Eq:consenergy]), with the replacement ∂x  →  D0, is conserved and a von Neumann stability analysis gives a Courant limit of [formula] for 4RK.

At first glance this method appears to be very effective. It suppresses the exponentially growing mode ([\ref=Eq:growingmode]) and it allows for a rather large time step. However, the fact that D0 is blind to the highest frequency means that the discrete conserved quantity is unable to capture it and, as discussed in greater detail in [\cite=CHHR], the method is not robust in the sense that a perturbation of the equation by lower order terms can trigger (exponentially growing) numerical instabilities. Although it is possible that artificial dissipation may cure this problem, this needs to be explored. Whatever the case may be, a five point stencil is likely to unduly complicate the treatment of boundaries.

Method 3: Another alternative is to rewrite Eq. ([\ref=Eq:shiftedwave]) as

[formula]

where we have introduced the variable Π  =  ∂tφ  -  β∂xφ. The standard second order accurate discretization now gives

[formula]

Note that in terms of the original second order system this spatial discretization corresponds to

[formula]

which has a five point stencil. Incidentally, for large β it is not possible to construct a centered, second order accurate, three point stencil, stable approximation of the second order equation ([\ref=Eq:shiftedwave]), without performing a first order reduction in time. System ([\ref=Eq:adm1]) is stable for any value of β, as it conserves the discrete quantity

[formula]

With 4RK and for large β it has a Courant limit comparable to that of method 2. In particular, for |β| = 2 we get the condition [formula]. Furthermore, the numerical speeds of propagation associated with system ([\ref=Eq:adm1]) are closer to the exact ones than those of method 2.

Both the continuum system and approximation ([\ref=Eq:adm1]) are non-dissipative. They admit a conserved energy. If the advective terms (the terms multiplied by β) in the semi-discrete system ([\ref=Eq:adm1]) are approximated with second order accurate one-sided operators [formula] rather than D0, assuming β > 1, we are trading a conservative scheme with one which is dissipative. Although in the variable coefficient case this may be effective in obtaining stability, in this particular case, with 4RK and β = 2, the scheme requires [formula], which is less than half what is needed by the centered approximation.

Finally, we point out that in the fourth order accurate case, [formula], [formula], the results of this paper remain qualitatively unchanged. For |β|  >  1 the standard discretization of ([\ref=Eq:shiftedwave]) is unstable, unless copious amount of artificial dissipation is added to the scheme, whereas the discretization of ([\ref=Eq:adm1cont]) is stable for any value of the shift parameter.

Conclusion

Our analysis demonstrates that when using formulations which are second order in space one has to exercise caution, even in the absence of boundaries. We find that the instability discussed in [\cite=AlcSch], which motivated the introduction of causal differencing, is due to the mixing of the D0 and D+D- operators in the spatial discretization and therefore only appears with second order in space systems. The fact that it arises already at the semi-discrete level, as in Eq. ([\ref=Eq:semiwave]), shows that no time integrator can fix it, not even implicit ones. One can expect such instability to arise in numerical relativity simulations based on standard spatial discretization of fully second order systems near black holes and at large distances from the center of a rigidly rotating coordinate system.

We believe that a simple and effective method of eliminating the instability consists in rewriting the system in "ADM" form before discretizing it, as in ([\ref=Eq:adm1]). When this is done, the resulting approximation, which is still centered, is stable for any value of the parameter β. It is straightforward to prove stability using the discrete energy method and higher order accurate schemes can be easily constructed. Interestingly, the structure of system ([\ref=Eq:adm1cont]) is similar to commonly used first order in time, second order in space formulations of Einstein's equations, such as the Baumgarte-Shapiro-Shibata-Nakamura system [\cite=SN] [\cite=BS].