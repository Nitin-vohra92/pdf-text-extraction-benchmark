Finite, closed-form expressions for the partition function and for Euler, Bernoulli, and Stirling numbers

Lemma Lemma

Introduction and main result

Generating functions are often used as a compact way to define special number sequences and functions as the coefficients in a power-series expansion of more elementary functions. One example of this is the partition function p(n), (sequence A000041 in OEIS [\cite=integer]), the number of partitions of n into positive integers. It has the generating function [\cite=Partition]

[formula]

Some other examples of generating functions are those for the Bernoulli and the Euler numbers: The solutions of generating-function equations can often be found from recursion relations. Some of them can also be calculated directly by using various expressions, such as Laplace's determinental formula for the Bernoulli numbers [\cite=Korn], which we write in the form:

[formula]

Vella [\cite=Vella] has derived expressions for Bn and for En as sums over the partitions (or, alternatively, over the compositions) of n using a method based on the Faa di Bruno formula for the higher derivatives of composite functions. Concerning the partition function, Rademacher [\cite=Partition] [\cite=Rade] derived an exact formula, an improvement over the Hardy-Ramanujan asymptotic formula, which however involves an infinite sum of rather complicated, non-integer terms. More recently, Bruinier and Ono [\cite=Ono] have derived an explicit formula for the partition function as a finite sum of algebraic numbers that requires finding a sufficiently precise approximation to an auxiliary function.

In the following theorem, we present methods for solving generating-function equations for the case where the right-hand side is expressible in terms of a convergent, non-zero-near-the-origin power series. We will then apply this theorem to solve for the partition function and other objects which have the appropriate generating functions. In the following, the notations

[formula]

and

[formula]

will denote, respectively, multinomial coefficients and generalized binomial coefficients.

Our main result is: The proof of (II) requires some additional machinery and will be postponed to Section II. Proof ~ of ~ (): Since [formula], the coefficient of the zp term is the same in the two sums, so in determining the c(X)p coefficient we need deal only with the finite sum. Using the generalized binomial theorem, we write

[formula]

In the second line we've applied a multinomial expansion to [formula]. We now write [formula] and interchange the order of the sums:

[formula]

After the interchange, the kq's are fixed in the sum over N and only the [formula] term contributes. We are interested in the coefficient of zp in this sum, which is thus

[formula]

As stated above, this is also the coefficient of zp in the infinite sum. QED.

The Kroneker delta in eq.(6) restricts the sums over the k's to a sum over the partitions of p. The multinomial coefficient in this formula counts the number of unique ways the parts can be ordered. As a sum instead over compositions, eq.(6) becomes

[formula]

As a corollary, we have the multinomial identity: Proof: We set X =  - 1 and aq = 1 / q!, so that [formula] and so c( - 1)p  =  ( - 1)p / p!. Then, from eq, (7),

[formula]

Multiplying both sides by p! gives the result. QED

We now apply Part (I) of Theorem 1 to eq.(1) and use Euler's pentagonal theorem:

[formula]

where the exponents [formula] are generalized pentagonal numbers (sequence A001318): [formula] [\cite=Partition]. p(n) is then equal to a sum over the pentagonal partitions of n:

[formula]

where qM is the largest GPN ≤  n. Eq.(10) thus expresses p(n) as a finite sum of integers. The number of terms in the sum is the number of partitions of n into generalized pentagonal numbers, (sequence A095699). For example, 9 has 10 pentagonal partitions, ([formula]), and p(9) is

[formula]

From the as-yet-to-be-proven Part II of the theorem, p(n) is also expressible as a (k + 1)  ×  (k + 1) determinant, for any integer k  ≥  n;

[formula]

where, for 0  ≤  q  ≤  k,

[formula]

This reduces to the form stated in the theorem by successive expansions by minors along the top row. Form (11) will prove more useful in some of the following discussions, but it can be reduced (by expansions in minors) to the n  ×  n determinant,

[formula]

Matrix formalism

Matrices which are constant along all diagonals are Toeplitz matrices. We will be concerned in this section with lower-triangular Toeplitz (LTT) matrices. A nondegenerate LTT matrix is one with non-zero diagonal elements; if the diagonal elements are equal to 1, it is then a unit LTT matrix.

Infinite-dimensional LTT matrices have the form

[formula]

The determinant of a k-dimensional lower-triangular matrix is the product of it's diagonal elements; if the matrix is also Toeplitz, then its determinant is ak0.

We define the infinite-dimensional lower shift matrix J as

[formula]

The pth power of J has elements (Jp)ij  =  δp,i - j; these matrices obey the relations JpJq  =  JqJp  =  Jp + q. Any infinite-dimensional LTT matrix can be expanded out in non-negative powers of J:

[formula]

The product of two infinite-dimensional LTT matrices is

[formula]

A similar expression can be written for finite-dimensional LTT matrices, with the J's replaced by finite lower shift matrices. LTT matrices, whether finite- or infinite-dimensional, thus commute with one another.

Proof: We have

[formula]

But

[formula]

and therefore [formula]. QED

It is clear that this proof still holds if the J's are replaced by finite-dimensional lower shift matrices and the sums over q and s are finite. Thus, the coefficients of the inverse of a finite k-dimensional (nondegenerate) LTT matrix are given by the same formula, and we have the result:

I.e.,

[formula]

iff

[formula]

for all k.

Proof: As before, we first consider the finite-sum case. Let z be some nonzero complex number. We then define [formula] as the infinite row vector

[formula]

Multiplying Z by J on the right, we have [formula]. Therefore, [formula] and, by linearity, [formula]. Then, if F(z) is a holomorphic, nonzero function of z in a neighborhood U of the origin, [formula] for all z∈U, where F(J) is the LTT matrix obtained by replacing z by J in the Taylor series expansion of F(z). Since [formula] is such a function, we can write,

[formula]

z is otherwise arbitrary, so we have

[formula]

For fixed s  <  p, [formula] in the sums over the k's as a result of the restriction [formula]:

[formula]

The equality in the lemma is then demonstrated by letting p  →    ∞   in this equation. QED   We now have the necessary machinery to prove the second part of Theorem 1.   Proof ~ of ~ Thm ~ 1,(II): From the proof of Lemma 3, the coefficients in the expansion of [formula] in powers of J are the same as in the expansion of [formula] in powers of z; i.e.,

[formula]

We can therefore use Lemma 1, written in the form

[formula]

(taking k = p), with the replacement [formula] (and thus a0  →  1 / aX0), to solve for c(X)p as a determinant in the form (II) in the theorem. QED.

In a straightforward fashion, eq. (23) generalizes to

[formula]

The cp coefficients are then:

[formula]

Gradshteyn and Ryzhik [\cite=Grad] give an equivalent expression for these coefficients for the case n = 2, ~ X1 = 1, ~ X2 =  - 1.

Returning to the partition function: MacMahon's recurrence relation [\cite=Partition],

[formula]

follows directly from expression (11); setting k = n in that equation, the sum on the right in (27) is equal to the determinant

[formula]

which is zero since the first and last columns are equal.

Expressed in terms of the J matrices, expression (12) for p(n) is

[formula]

where JT is the transpose of J and the notation n  ×  n means the n  ×  n truncation of an infinite-dimensional matrix. And, by relation (23), we have the compact matrix equivalent of p(n)'s generating-function equation:

[formula]

The generating function for the number of partitions in which no part occurs more than D times is [\cite=Partition]

[formula]

We have then from (26), with X1 =  - X2 = 1,

[formula]

where

[formula]

By expanding this determinant by minors along the last column, and using the expression (11), we get the relation

[formula]

which is a generalization of (27), the D = 0 case. If we now take D = 1, [formula] = the number of partitions of n into distinct integers (A000009). This is also, from a result due to Euler [\cite=PartitionQ], the number of partitions of n into odd integers, and so we have for the odd partition function

[formula]

Application to Bernoulli, Euler and Stirling numbers

Vella's expression for the nth Bernoulli number, (eq.(a) in his Theorem 11) is, in my notation,

[formula]

Applying Part I of Theorem 1 to the generating function (2a) for Bernoulli numbers, we have to be compared to Vella's result above.

Another expression for the (even-numbered) Bernoulli numbers is obtained from the generating function

[formula]

From this we have while from the generating function for the Euler numbers (A000364), eq.(2b), we obtain the two expressions,

B2p and E2p can thus both be expressed as sums over the even compositions of 2p. Since there are no even compositions of odd numbers, these expressions can be extended to include all of the odd-numbered numbers except for B1. We then have, more generally,

[formula]

[formula]

This expression for En, in a different notation, was previously derived by Vella, (eq. (c) in Thm. 11 [\cite=Vella]). En can however also be expressed as a sum over the odd partitions/compositions of n - 1:   Proof. The sum is over all compositions of n - 1 that contain an odd number of odd parts, which is an empty set if n - 1 is even. Therefore En = 0 for odd n, and we only have to prove this equation for even n. The equality is trivially true for n = 2. We will show that both E2p and

[formula]

satisfy the same recursion relation

[formula]

Then the equality would, by induction, be valid for all p.

To prove this for E2p, consider the expression

[formula]

This is equal to zero as a result of the identity cosh 2z  =  2 cosh 2z - 1. Expanding out sinh z and 1 /  cosh z and performing the differentiation in the 1st and 3rd terms, we have, for each power of z,

[formula]

which can be rearranged into the form of the recursion relation (43) above.

On the other hand we have

[formula]

where we've separated off the N = 1 term and made the substitutions [formula]. We have then, with N  =  L + 1,

[formula]

Setting q = q1 + q2 - 1, this is

[formula]

The sum over q1 equals 22q - 1, evaluated by expanding (1 + 1)2q - (1 - 1)2q binomially. The remaining sum over L and [formula] is a2p - 2q, and we again get relation (43). QED

The sum-over-partitions form follows in a straightforward fashion:

[formula]

The sign of each term in this sum is [formula], while the sign in the sum-over-compositions form is ( - 1)N. To check that the signs agree, note that [formula]. But K is the number of factorials in the denominator of each term, which in the sum-over-compositions form is 2N - 1. So [formula] and [formula].

As an example of the even and the odd expansions for En, we have:

[formula]

In a similar fashion, Theorem 1 can be applied to the Euler and Bernoulli polynomials, using their generating functions: The results are straightforward and we omit writing out the explicit expressions.

Bell polynomials [\cite=Bell] are defined as

[formula]

Stirling numbers of the 2nd kind are equal to the values of these polynomials at [formula]:

[formula]

where we've set k = n - p and in the last line we've summed over k0. A similar expression for Stirling numbers of the 1st kind can be found using their relation to the n-th order Bernoulli numbers [\cite=Korn],

[formula]

which have the generating function

[formula]

Using Theorem 1, we get for s(n,n - p):

[formula]

Laplace's formula (3) for the Bernoulli numbers corresponds to expression (36a) and follows from equation (2a) and Part (II) of Theorem 1. Other matrix representations we can derive from this theorem are: Note that the size of the determinant for B2p in (56a) is (p + 1)  ×  (p + 1), (as is the one for E2p in (56b)), compared with (2p + 1)  ×  (2p + 1) using Laplace's formula.

Conclusion

We have derived compact, closed-form expressions for partition functions and for Bernoulli, Euler and Stirling numbers that contain only "simple" numbers and that require either finite summations or finding the determinants or inverses of matrices. In particular, the partition function p(n) is given directly by a sum of integers, the number of terms in the sum being the value at n of the pentagonal partition function.

p(5k + 4), ~ p(7k + 5), and p(25k + 24) determinants

For n = 5k + 4,7k + 5, or 25k + 24, the dimension of the matrix in eq.(12) can be reduced to k + 1 by using one of the identities below by Ramanujan [\cite=Partition] [\cite=Ram]: where [formula]. The first identity, combined with eq.(26), gives us (where we've used the Jacobi identity [formula]). The matrices above thus consist of an LTT "base" part and a "tower" part. The coefficients of the base matrix for p(5k + 4) correspond to sequence A000729, the coefficients in the expansion of [formula], while the coefficients of powers of J5 in the tower part is sequence A000728. Likewise, sequence A000731 gives the base matrix for p(7k + 5), while the tower part involves a combination of sequences A000727, A000730, and A010816.

From the 3rd identity, the coefficients for the base matrix for p(25k + 24) are given by the expansion

[formula]

(sequence A010836); the tower part is from the expansion

[formula]

and so we have, to this order,

[formula]

We list below some sample calculations of partition functions using these determinants:

[formula]

p(5k + a) and p(25k + a) determinants

One can ask if it's possible to fill in some of the gaps in equations (A2a), (A2b) and (A5) and to get expressions for p(5k + a), etc., for other values of a. In the following we will consider the problem of generalizing eqs. (A2a) and (A5). Ramanujan [\cite=Ram] derived the relation

[formula]

(his eq.(20.5)), where he defined the functions J1(q) and J2(q) by the equation

[formula]

J1 and J2 are series expansions in q with integer coefficients and exponents. Ramanujan then proved the identities

[formula]

(J1(q) and J2(q) are given by sequences A003823 and A007325, respectively.) From the first identity and from (B1) we have

[formula]

and so

[formula]

in addition to (A1a). Let

[formula]

Then, for a = 0,1,2,3,4,

[formula]

where Fn is the n-th Fibonacci number, with F0 = 0. We then have, making the replacement q  →  J,

[formula]

where the elements Xn( = X(a)n) in the tower matrix are determined for each value of a by the expansion

[formula]

The G's can be expressed in terms of the Ramanujan theta function:

[formula]

However, it is more convenient to write them as the series expansions

[formula]

which follow directly from (B5). (G1(q) corresponds to sequence A113681, and - G2(q) to sequence A116915.) In column-vector form, the first terms in the expansions from eq. (B8) are:

[formula]

with the coefficients for [formula] being given in (A2a).

We can generalize eq.(A5) to an expression for p(25k + a) for a = 4,9,14 and 19 following Ramanujan's derivation of the identity (A1c)[\cite=Ram]. We make the replacement q  →  q1 / 5 in eq. (A1a) and get

[formula]

To simplify the notation, we define [formula]. Then

[formula]

where [formula], the golden ratio. We have that

[formula]

Then

[formula]

The denominator in (B13) is

[formula]

The numerator in (B13) is to be raised to the sixth power in eq.(B10). We define the functions Hn(x) to be series expansions in x with integer coefficients and exponents such that

[formula]

Expanding the left side of this equation and collecting terms, we get

[formula]

Then, changing back to the variable q, eq.(B10) is

[formula]

and we have

[formula]

The expression on the right in the last equation above reduces to Ramanujan's result in (A1c) upon the substitutions

[formula]

where

[formula]

As before, the Zn coefficients in the p(25k + a) determinant

[formula]

are obtained by an expansion in powers of q of the numerators on the RHS 's of these generating-function equations. We have, for a = 4,9,14,19,

[formula]

[formula] determinants

Expression (11) for p(n) can be used to express finite sums of the form [formula] as determinants. We have

[formula]

The tower part of the matrix can be expressed as

[formula]

We now multiply the determinant in eq. (C1) by the determinant of (I - J / x), (which is equal to 1), and get

[formula]

where in the last line we've expanded the (k + 1)-dimensional determinant by minors along the final column and then taken the factor ( - 1)kxk inside the resulting k-dimensional determinant, multiplying each of the columns by - x. The final result can be written in a more compact notation as

[formula]

2000 Mathematics Subject Classification: Primary: 05A17; Secondary: 11Y35, 11B68. Keywords: partition function, Bernoulli numbers, Euler numbers, Sterling numbers. (Concerned with sequences A000009, A000041, A000364, A000728, A000729, A000730, A000731, A001318, A010815, A010816, A010836, A095699, A113681, and A116915)