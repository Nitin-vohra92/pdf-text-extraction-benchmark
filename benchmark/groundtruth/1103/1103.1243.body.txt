Randomizing world trade. I. A binary network analysis

Introduction

The network of import/export trade relationships among all world countries, known in the literature as the International Trade Network (ITN) or the World Trade Web (WTW), has received a renewed multidisciplinary interest in recent years [\cite=LiC03] [\cite=SeBo03] [\cite=Garla2004] [\cite=Garla2005] [\cite=serrc07] [\cite=Bhatta2007a] [\cite=Bhatta2007b] [\cite=Garla2007] [\cite=Tzekina2008] [\cite=Fagiolo2008physa] [\cite=Fagiolo2008acs] [\cite=Fagiolo2009pre] [\cite=BariFagiGarla2010], due to impressive advances in both empirical and theoretical approaches to the study of complex networks [\cite=guidosbook] [\cite=AlbertBarabasi2002] [\cite=DoroMendes2003]. A number of robust patterns in the structure of this network have been empirically observed, both in its binary (when only the presence of a trade interaction is considered, irrespective of its intensity) and weighted (when also the magnitude of trade flows is taken into account) description. These stylized facts include local properties as well as higher-order patterns. Local properties involve direct (first-order) interactions alone, resulting in simple quantities such as node degree (the number of trade partners of a country), node strength (total trade volume of a country), and their directed-network analogues (i.e., when these statistics are computed taking into account edge/trade directionality). Higher-order characteristics are more complicated structural properties that also involve indirect interactions, i.e. topological paths connecting a country to the neighbors of its neighbors, or to countries farther apart. Examples include degree-degree correlations, average nearest-neighbor indicators, and clustering coefficients, to name just a few of them.

In general, local and higher-order topological properties are not independent of each other. In particular, even if one assumes that the network is formed as the result of local constraints alone, with higher-order properties being only the mere outcome of a specification of these constraints, it turns out that so-called structural correlations are automatically generated. Structural correlations sometimes appear as complicated patterns that might be confused with genuine correlations involving higher-order statistics, and interpreted as the presence of an additional level of topological organization. Therefore, in any real network it is important to characterize structural correlations and filter them out in order to assess whether nontrivial effects due to indirect interactions are indeed present.

In the specific case of the ITN, this problem is particularly important to assess whether the network formalism is really conveying additional, nontrivial information with respect to traditional international-economics analyses, which instead explain the empirical properties of trade in terms of country-specific macroeconomic variables alone. Indeed, the standard economic approach to the empirics of international trade [\cite=Feenstra2004] has traditionally focused its analyses on the statistical properties of country-specific indicators like total trade, trade openness (ratio of total trade to GDP, i.e. Gross Domestic Product), number of trade partners, etc., that can be easily mapped to what, in the jargon of network analysis, one denotes as local properties or first-order node characteristics. Ultimately, understanding whether network analyses go a step beyond with respect to standard trade theory amounts to assess the effects of indirect interactions in the world trade system. Indeed, a wealth of results about the analysis of international trade have already been derived in the macroeconomics literature [\cite=Feenstra2004] without making explicit use of the network description, and focusing on the above country-specific quantities alone. Whether more recent analyses of trade, directly inspired by the network paradigm [\cite=LiC03] [\cite=SeBo03] [\cite=Garla2004] [\cite=Garla2005] [\cite=serrc07] [\cite=Bhatta2007a] [\cite=Bhatta2007b] [\cite=Garla2007] [\cite=Tzekina2008] [\cite=Fagiolo2008physa] [\cite=Fagiolo2008acs] [\cite=Fagiolo2009pre], are indeed conveying additional and nontrivial information about the structure of international import/export flows, crucially depends on the answer to the above question. Some network-inspired studies have already tried to address this problem, but with ambiguous results. In some cases, it was suggested that local properties are enough to explain higher-order patterns [\cite=Garla2004] [\cite=mylikelihood] [\cite=Bhatta2007a], while in others the opposite conclusion was reached [\cite=multipolarization]. However, previous analyses of the ITN focused on heterogeneous representations (either binary [\cite=SeBo03] [\cite=Garla2004] or weighted [\cite=Bhatta2007a] [\cite=Fagiolo2008physa] [\cite=multipolarization], either directed [\cite=Garla2005] [\cite=myreciprocity] [\cite=serrc07] or undirected [\cite=SeBo03] [\cite=Garla2004], either aggregated [\cite=SeBo03] [\cite=Garla2004] [\cite=Fagiolo2008physa] or disaggregated [\cite=BariFagiGarla2010] in separate commodities) and using different datasets, making consistent conclusions impossible.

In this and in a companion paper [\cite=part2], we explicitly address this problem and exploit a recently proposed analytical method [\cite=myrandomization] to obtain, for any given topological property of interest, the value of the corresponding quantity averaged over the family of all randomized variants of the ITN that preserve the observed local properties. This allows us to identify empirical deviations from locally-induced structural correlations. Null models are used in our exercises to uncover significant features of the network and to understand to which extent some network statistics are sufficient to explain other network statistics. Our analysis is not however involved in explaining the underlying causal mechanisms shaping the network. Therefore, throughout this and its companion paper, we shall use the term "explaining" in a weak sense. For example, finding that a local network statistics X "explains" a higher-order network statistics Y in our null model will signal the presence of a strong correlation between the two statistics, so that X can be sufficient to fully reproduce Y in the network. Of course, we do not aim at using our null model to identify subtle causal links between X and Y, which in the real-world may be caused e.g. by some omitted variables that cause in a proper way the high observed correlation between X and Y.

In this first paper, we focus on the ITN as a binary network. We find that higher-order patterns of all binary (either directed or undirected) projections of the ITN are remarkably well explained by local properties alone (the degree sequences). This result is robust to different levels of commodity aggregation: even if with an increasing scatter, the degree sequence preserves its complete informativeness as more disaggregated and sparser commodity-specific networks are considered. Moreover, we perform a temporal analysis and check the robustness of these results over time. Therefore we obtain, for the first time in this type of study, a detailed and homogeneous assessment of the role of local properties across different representations of the trade network, using various levels of commodity aggregation, and over several years. From an international-trade perspective, our results indicate that binary network descriptions of trade can be significantly simplified by considering the degree sequence(s) only. In other words, in any binary representation of the ITN, the degree sequence turns out to be maximally informative, since its knowledge conveys almost the entire information about the topology of the network.

In the companion paper [\cite=part2], we show that the picture changes completely when considering the ITN as a weighted network. We find that the ITN is an excellent example of a network whose local topological properties cannot be deduced from its local weighted properties. These results highlight an important limitation of current economic models of trade, that do not aim at explaining or reproducing the observed degree sequence but focus more on the structure of weights [\cite=GravityBook]. In other words, standard models of trade in economics have been focusing only on explaining the (positive) flow between any two countries, disregarding to a great extent theories that are able to account for the determinants of the creation of a link (i.e. the transition from a zero trade-flow to a positive trade flow). The observed extreme informativeness of the degree sequence leads us to conclude that such models should be substantially revised in order to explicitly include the degree sequence of the ITN among the key properties to reproduce.

Data and methods

This Section describes the data we use to construct the various representations of the network in this and in the following paper [\cite=part2], discusses how the country-specific properties that are usually considered in world-trade economics translate into local topological properties of the ITN, and discusses how these properties should be kept as constraints of our analysis using an appropriate network randomization method.

The International Trade Network

We use yearly bilateral data on exports and imports from the United Nations Commodity Trade Database (UN COMTRADE) from year 1992 to 2002. We have chosen this database because, despite its relatively short time interval (11 years), it contains trade data between countries disaggregated across commodity categories. This allows us to perform our analyses both at the aggregate level (total trade flows) and at the commodity-specific level, e.g. investigating whether local properties are sufficient to explain higher-order ones in commodity-specific networks of trade.

In order to perform a temporal analysis and allow comparisons across different years, we restrict ourselves to a balanced panel of N = 162 countries that are present in the data throughout the time interval considered. As to the level of disaggregation, we choose the classification of trade values into C = 97 possible commodities listed according to the Harmonized System 1996 (HS1996) . Accordingly, for a given year t we consider the trade value ecij(t) corresponding to exports of the particular commodity c ([formula]). Since, for every commodity, exports from country i to country j are reported twice (by both the importer and the exporter) and the two figures do not always match, we follow Ref. [\cite=BariFagiGarla2010] and only employ the flow as reported by the importer. Besides commodity-specific data, we also compute the total value e0ij(t) of exports from country i to country j as the sum over the exports of all C = 97 commodity classes:

[formula]

The particular aggregation procedure described above, which coincides with the one performed in Ref. [\cite=BariFagiGarla2010], allows us to compare our analysis of the C commodity-specific networks with a (C + 1)-th aggregate network, avoiding possible inconsistencies between aggregated and disaggregated trade data. We stress that the resulting aggregated network data are in general different from those used in other analyses [\cite=Garla2004] [\cite=Garla2005] [\cite=Fagiolo2009pre] of the same network. Nonetheless, as we show below, when we analyze network properties that have also been studied in previous studies of aggregate trade, we find perfect agreement.

The quantities {ecij(t)} (where [formula]) defined above are the fundamental data that allow us to obtain different possible representations of the trade network, as well as the corresponding randomized counterparts (see below for the units of measure we adopted). When we regard the ITN as a weighted directed network, we define the weight of the link from country i to country j in year t for commodity c as

[formula]

where [formula] denotes the nearest integer to the non-negative real number x. When we adopt a weighted but undirected (symmetrized) description, we define the weight of the link between countries i and j in year t for commodity c as

[formula]

Therefore, in both the directed and undirected case, wcij(t) is an integer quantity. Since in both cases we shall be interested in tracking the temporal evolution of most quantities, we also define rescaled weights (relative to the total yearly trade flow) as follows:

[formula]

where in the directed case wcij(t) is given by Eq. ([\ref=eq_wdir]) and [formula] (the double sum runs over all N(N - 1) ordered pairs of vertices), while in the undirected case wcij(t) is given by Eq. ([\ref=eq_wund]) and [formula] (the double sum runs over all the N(N - 1) / 2 unordered pairs). In such a way, trend effects are washed away and we obtain adimensional weights that are automatically deflated, allowing consistent comparisons across different years and different commodities.

In the binary representations of the network, we draw a link from i to j whenever the corresponding weight wcij is strictly positive. If Θ(x) denotes the step function (equal to 1 if x > 0 and 0 otherwise), the adjacency matrix of the binary projection of the network in year t for commodity c is

[formula]

where wcij(t) is given either by Eq. ([\ref=eq_wdir]) or by Eq. ([\ref=eq_wund]), depending on whether one is interested in a directed or undirected binary projection of the network respectively.

For each of the C + 1 commodity categories, we can consider four network representations (binary undirected, binary directed, weighted undirected, weighted directed). When reporting our results, we will first describe the aggregated networks (c = 0) and then the disaggregated (commodity-specific) ones. In particular, among the 97 commodity classes, we will focus on the 14 particularly relevant commodities identified in Ref. [\cite=BariFagiGarla2010], which are reported in table [\ref=table]. These 14 commodities include the 10 most traded commodities (c = 84,85,27,87,90,39,29,30,72,71 according to the HS1996) in terms of total trade value (following the ranking in year 2003 [\cite=BariFagiGarla2010]), plus 4 classes (c = 10,52,9,93 according to the HS1996) which are less traded but more relevant in economic terms. Taken together, the 10 most traded commodities account for 56% of total world trade in 2003; moreover, they also feature the largest values of trade value per link (also shown in the table). The 14 commodities considered account together for 57% of world trade in 2003. As an intermediate level of aggregation, we shall also consider the networks formed by the sum of these 14 commodities. The original data {ecij(t)} are available in current U.S. dollars (USD) for all commodities; however, due to the different trade volumes involved, we use different units of measure for different levels of aggregation .

Controlling for local properties

As we mentioned, our main interest in the present work is assessing whether higher-order properties of the ITN can be simply traced back to local properties, which are the main focus of traditional macroeconomic analyses of international trade. Such standard country-specific properties include: total exports, total imports, total trade (sum of total exports and total imports), trade openness (ratio of total trade to GDP), the number of countries whom a country exports to and imports from, the total number of trade partners (irrespective of whether they are importers or exporters, or both). All these quantities can be simply obtained as local sums over direct interactions (countries one step apart) in a suitable representation of the network.

For instance, the number of trade partners of country i is simply the number of neighbors of node i in the binary undirected projection, i.e. the degree

[formula]

In the above equation and in what follows, we drop the dependence of topological quantities on the particular year t for simplicity. We also drop the superscript c specifying a particular commodity, as all the formulas hold for any c. This means that, if the aggregated network of total trade is considered, then aij and wij represent the aggregate quantities a0ij and w0ij, where the commodity c = 0 formally represents the sum over all commodities, as in Eq. ([\ref=eq_e0]). Otherwise, if the commodity-specific network involving only the trade of the particular commodity c (with c > 0) is considered, then aij and wij represent the values acij and wcij for that commodity.

The number of countries whom a country exports to and imports from are simply the two directed analogues (the out-degree kouti and the in-degree kini respectively) of the above quantity in the binary directed description:

[formula]

Similarly, as evident from Eq. ([\ref=eq_wund]), country i's total trade coincides with twice the sum of weights reaching node i in the weighted undirected representation, i.e. the strength

[formula]

Finally, total exports (imports) of country i are simply the sum of out-going (in-coming) weights in the weighted directed representation of the ITN. These quantities are known as the out-strength souti and in-strength sini of node i:

[formula]

Another country-specific property which is widely used as an explanatory variable of trade patterns is the GDP or the per capita GDP (i.e. the ratio of GDP to population). This property is sometimes used to rescale trade values, as in the case of trade openness which is defined as a country's ratio of total trade to GDP. Unlike the quantities discussed above, the GDP is not a topological entity. Nonetheless, it is empirically observed to be positively (and strongly) correlated with the degree [\cite=Garla2004] and with node strength [\cite=Fagiolo2009pre] (we will comment more on this in Section [\ref=sec_bun]). Therefore, even if this is not the main aim of the present work, one should be aware that assessing the role of local topological properties also indirectly implies, to a large extent, assessing the role of the GDP of countries.

Rewiring the ITN

We showed that, in a network language, the standard country-specific properties used to characterize world trade translate into simple local topological properties of the ITN. This naturally implies that, in our analysis, it is important to consider a null model of the ITN where such properties are enforced as constraints, and the topology is otherwise maximally random. Different methods that produce randomized ensembles of networks with given constraints exist [\cite=Holland_Leinhardt_1976] [\cite=Kannan_etal_1999] [\cite=Katz_Powell_1957] [\cite=Rao_etal_1996] [\cite=Roberts_2000] [\cite=Shen-Orr_etal_2002] [\cite=Snijders_1991] [\cite=maslov] [\cite=msz] [\cite=chunglu] [\cite=myrandomization]. As we mentioned, we aim at studying many topological properties of several different representations and temporal snapshots of the ITN. Therefore, we need a fast method that can deal with many networks in a relatively short time, and treat binary, weighted, directed and undirected graphs in a consistent fashion. To this end, we employ the maximum-likelihood method introduced in ref. [\cite=myrandomization], which provides the expectation values (over the randomized ensemble) of the desired topological properties analytically, in contrast with alternative methods [\cite=maslov] [\cite=msz] which require to explicitly generate many randomized variants of the real network computationally. Moreover, the method is density-independent and works for both sparse and dense networks. By contrast, other (analytical or computational) approaches are density-dependent and not optimized for dense networks: the Chung-Lu (analytical) approach [\cite=chunglu] works only for sparse networks, and the Maslov-Sneppen (computational) algorithm [\cite=maslov] [\cite=msz] becomes too time consuming for dense networks. Since the ITN is an unusually dense network, the maximum-likelihood method is the natural choice that allows us to perform a detailed analysis, covering all possible representations across several years, which would otherwise require an impressive amount of time.

In the Appendix we describe the maximum-likelihood method in some detail, in particular its application to the topological properties of interest for the present case study. Given any topological property X, the method provides the average value 〈X〉 of X across the ensemble of random graphs with the same average (across the ensemble itself) constraints as the real network. For simplicity, in this and in the companion paper we sometimes denote 〈X〉 as a randomized property, and its value as the randomized value of X, even if technically no randomization process has been required (all the results have been obtained analytically). Similarly, we imagine the graph ensemble as a rewired version of the original network, even if no rewiring has taken place explicitly.

The ITN as a binary undirected network

As we mentioned in Section [\ref=sec_data], in its binary representation the ITN is defined as a graph whose edges report the presence of trade relationships among world countries, irrespective of the intensity of these relationships. The binary representation of the ITN can be either undirected or directed, depending on whether one is interested in specifying the orientation of trade flows. In both cases, the complete information about the topology of the network is encoded in the adjacency matrix [formula], whose entries {aij} are defined as in Eq. ([\ref=eq_a]).

In the simplest case, the presence of at least one of the two possible trade relationships between any two countries i and j (either from i to j or from j to i) is represented as one undirected edge between nodes i and j. Therefore aij = aji and [formula] is a symmetric matrix. In this binary undirected description, as shown in Eq. ([\ref=eq_controlk]), the local constraints {Ca} are the degrees of all vertices, i.e. the degree sequence {ki}. Therefore, the maximum-likelihood randomization method [\cite=myrandomization] (see Appendix) works by specifying the constraints [formula] and allows us to write down the probability of any graph [formula] in the grandcanonical ensemble, which is uniquely specified by its generic adjacency matrix [formula]. As summarized in Appendix [\ref=app_bun], this allows us to easily obtain the expectation value 〈X〉, formally defined in Eq. ([\ref=eq_X]), of any property X across the ensemble of binary undirected graphs whose expected degree sequence is equal to the empirical one. Note that, among the possible properties, the degree of vertices plays a special role, as its expectation value 〈ki〉 is exactly equal to the empirical value ki, as required by the method. Therefore the values {ki} are useful control parameters and can be efficiently used as independent variables in terms of which other properties X can be visualized.

For the sake of simplicity, in Sections [\ref=sec_bun_annd] and [\ref=sec_bun_clustering] we first report the results of this analysis on a single snapshot of the commodity-aggregated network (the last year in our temporal window, i.e. 2002). Then, we discuss the robustness of our results through time by tracking them backwards in Section [\ref=sec_bun_evolution]. We finally consider the disaggregated analysis of commodity-specific networks in Section [\ref=sec_bun_dis].

Average nearest neighbor degree

We start with the analysis of the aggregated version of the ITN, representing the trade of all commodities (c = 0 in our notation). In the following formulas, the matrix [formula] therefore denotes the aggregate matrix [formula], where we drop the superscript for brevity. As a first quantity, we consider the average nearest neighbor degree (ANND) of vertex i, defined as

[formula]

and measuring the average number of partners of the neighbors of a given node i. The above quantity involves indirect interactions of length two, as evidenced from the presence of terms of the type aijajk in the definition. Whether these 2-paths are a simple outcome of the concatenation of two independent edges can be inspected by considering the correlation structure of the network, and in particular by plotting knni versus ki. The result is shown in Fig. [\ref=fig_bun_knn]. We observe a decreasing trend, confirming what already found in previous studies employing different datasets [\cite=SeBo03] [\cite=Garla2005] [\cite=Fagiolo2009pre]. This means that countries trading with highly connected countries have a few trade partners, whereas countries trading with poorly connected countries have many trade partners. This correlation profile, known as disassortativity, might signal an interesting pattern in the trade network. However, if we compare this trend with the one followed by the corresponding randomized quantity 〈knni〉 (see Appendix [\ref=app_bun] for its expression), we find that the two behaviors coincide. This is an important effect of structural constraints in a dense network [\cite=newman_origin]: contrary to what naively expected [\cite=pastorvespignani], even in a network where links are drawn randomly between vertices with given heterogeneous degrees, the ANND is not constant. This means that the degree sequence constrains the correlation structure, and that it is impossible to have a flat profile (knni independent of ki) unless one forces the system to display it by introducing additional mechanisms (hence additional correlations of opposite sign).

Clustering coefficient

A similar result is found for the behavior of the clustering coefficient ci, representing the fraction of pairs of neighbors of vertex i which are also neighbors of each other:

[formula]

The clustering coefficient is a measure of the fraction of potential triangles attached to i that are actually realized. This means that indirect interactions of length three, corresponding to products of the type aijajkaki entering Eq. ([\ref=eq_bun_ck]), now come into play. Again, we find a decreasing trend of ci as a function of ki (see Fig. [\ref=fig_bun_ck]). This means that trade partners of highly connected countries are poorly interconnected, whereas partners of poorly connected countries are highly interconnected. However, if this trend is compared with the one displayed by the randomized quantity 〈ci〉 (see Appendix [\ref=app_bun]), we again find a very close agreement. This signals that in the ITN also the profile of the clustering coefficient is completely explained by the constraint on the degree sequence, and does not imply the presence of meaningful indirect interactions on top of a concatenation of direct interactions alone.

The above results show that the patterns observed in the binary undirected description of the ITN do not require, besides the fact that different countries have specific numbers of trade partners, the presence of higher-order mechanisms as an additional explanation. On the other hand, the fact that the degrees alone are enough to explain higher-order network properties means that the degree sequence is an important structural pattern in its own. This highlights the importance of reproducing the observed degree sequence in models of trade. We will comment more about this point later on.

Evolution of binary undirected properties

We now check the robustness of the previous results through time. This amounts to perform the same analysis on each of the 11 years in our time window ranging from 1992 to 2002. For each of these snapshots, we specify the degree sequence and evaluate the maximally random ensemble of binary undirected graphs. We then compare each observed property X with the corresponding average 〈X〉 (repeating the procedure described in Appendix [\ref=app_bun]) over the null model for that specific year. We systematically find the same results described above for each and every snapshot. For visual purposes, rather than replicating the same plots shown above for all the years considered, we choose a more compact description of the observed patterns and portray its temporal evolution in a simple way. As we now show, this also provides us with a characterization of various temporal trends displayed by each topological property, conveying more information than a fixed-year description of the trade system.

We first consider the average nearest neighbor degree. For a given year, we focus on the two lists of vertex-specific values {knni} and {〈knni〉} for the real and randomized network respectively. We compute the average (mknn and m〈knn〉) and the associated 95% confidence interval of both lists and plot them together as in Fig. [\ref=fig_bun_knn_t]a. We repeat this for all years and obtain a plot which informs us about the temporal evolution of the ANND in the real and randomized network separately. We find that the average value of the empirical ANND has been increasing steadily during the time period considered. However, the same is true for its randomized value, which is always consistent with the real one within the confidence intervals. This means that the null model completely reproduces the temporal trend of degree-degree correlations.

In principle, the increase of the ANND could be simply due to an overall increase in link density. To further study this possibility, we have compared the yearly growth rate (Xt / Xt - 1 - 1) of the average ANND and of the link density in the period considered. We found two regimes: initially (from 1993 to 1997) the density has a larger (but decreasing) growth rate than the ANND, while from 1998 to 2002 onwards the two rates converge. Therefore it is useful to keep in mind that the evolution of the average ANND, as well as that of other average properties we consider below, is in general not merely reflecting the evolution of the overall link density.

In Fig. [\ref=fig_bun_knn_t]b we also plot the temporal evolution of the standard deviations sknn and s〈knn〉 (with associated 95% confidence intervals) of the two lists of values {knni} and {〈knni〉}. We find that the variance of the empirical average nearest neighbor degree has been decreasing in time, but once more this behavior is completely reproduced by the null model and therefore fully explained by the evolution of the degree sequence alone. Moreover, in Fig. [\ref=fig_bun_knn_t]c we show the Pearson (product-moment) correlation coefficient rknn,k (with 95% confidence interval) between {knni} and {ki}, and similarly the correlation coefficient r〈knn〉,k between the randomized quantities {〈knni〉} and {ki} (recall that {〈ki〉}  =  {ki} by construction). This informs us in a compact way about the evolution of the dependence of the ANND on the degree, i.e. of the change in the structure of the scatter plot we showed previously in Fig. [\ref=fig_bun_knn]. We find that the disassortative character of the scatter plot results in a correlation coefficient close to - 1, which has remained remarkably stable in time across the interval considered, and always very close to the randomized value.

The complete accordance between the real and randomized ANND in each and every snapshot is confirmed by Fig. [\ref=fig_bun_knn_t]d, where we show the correlation coefficient rknn,〈knn〉 (with 95% confidence interval) between the empirical ANND, {knni}, and the randomized one, {〈knni〉}. We observe an approximately constant value close to 1, signaling perfect correlation between the two quantities. This exhaustively explains the accordance between the real and randomized ANND for all vertices, while the other three panels of Fig. [\ref=fig_bun_knn_t] also inform about various overall temporal trends of the ANND, as we discussed.

In Fig. [\ref=fig_bun_c_t] we show the same analysis for the values {ci} and {〈ci〉} of the clustering coefficient. In this case we observe an almost constant trend of the average clustering coefficient (Fig. [\ref=fig_bun_c_t]a), a decreasing standard deviation (Fig. [\ref=fig_bun_c_t]b), and a stable strong anticorrelation between clustering and degree (Fig. [\ref=fig_bun_c_t]c). Again, we find that the real and randomized values are always consistent with each other, so that the evolution of the empirical values is fully reproduced by the null model. This is confirmed by Fig. [\ref=fig_bun_c_t]d, which shows that the correlation between {ci} and {〈ci〉} is always very close to 1. As for the ANND, these results clearly indicate that the real and randomized values of the clustering coefficient of all vertices are always in perfect agreement, and that the temporal trends displayed by this quantity are completely explained by the evolution of the degree sequence.

Commodity-specific binary undirected networks

We complete our analysis of the ITN as a binary undirected network by studying whether the picture changes when one considers, rather than the network aggregating the trade of all types of commodities, the individual networks formed by imports and exports of single commodities. To this end, we focus on the disaggregated data described in Section [\ref=sec_data] and we repeat the analysis reported above, by identifying the matrix [formula] with various disaggregated matrices [formula] (with c > 0).

We find that the results obtained in our aggregated study also hold for individual commodities. For brevity, we only report the scatter plots of the average nearest neighbor degree (Fig.  [\ref=fig_bun_dis1]) and clustering coefficient (Fig.  [\ref=fig_bun_dis2]) for the 2002 snapshots of 6 commodity-specific networks. The 6 commodities are chosen among the top 14 reported in Table [\ref=table]. In particular, we select the two least traded commodities in the set (c = 93,9), two intermediate ones (c = 39,90), the most traded one (c = 84), plus the network formed by combining all the top 14 commodities, i.e. an intermediate level of aggregation between single commodities and the completely aggregated data (c = 0), which we already considered in the previous analysis (Figs. [\ref=fig_bun_knn] and [\ref=fig_bun_ck]). With the addition of the latter, the results shown span 7 different cases ordered by increasing trade intensity and level of commodity aggregation. Similar results hold also for the other commodities not shown.

If we compare Fig. [\ref=fig_bun_dis1] with Fig. [\ref=fig_bun_knn], we see that the trend displayed by ANND in the aggregated network is preserved, even if with a slightly increasing scatter, as sparser and less disaggregated commodity classes are considered. Importantly, the accordance between real and randomized values is also preserved. The same is true for the clustering coefficient, cf. Fig. [\ref=fig_bun_dis2] and its comparison with Fig. [\ref=fig_bun_ck]. These results indicate that the degree sequence maintains its complete informativeness across different levels of commodity resolution, and irrespective of the corresponding intensity of trade. Thus, remarkably, the knowledge of the number of trade partners involving only a specific commodity still allows to reproduce the properties of the corresponding commodity-specific network.

As a summary of our binary undirected analysis we conclude that, in order to explain the evolution of the ANND and clustering of the ITN, it is unnecessary to invoke additional mechanisms besides those accounting for the evolution of the degree sequence alone. Since the ANND and clustering already probe the effects of indirect interactions of length two and three respectively, and since higher-order correlations involving longer topological paths are built on these lower-level ones, the null model we considered here is very likely to fully reproduce the properties of the ITN at all orders. In other words, we found that in the binary undirected representation of the ITN the degree sequence is maximally informative, as its knowledge allows to predict the higher-order topological properties of the network that we have explored in this and in the companion paper. An interesting question is whether the degree sequence is also able to reproduce other higher-order network properties, such as path lengths, node centrality, etc.. Whereas this study does not explicitly address this question, we argue that the answer will be positive in the light of the very nature of the ITN. Its high density indeed implies that path lengths are almost never larger than 3. As a consequence, network properties of order larger than 3 are typically well proxied by local properties. An example is the extremely high correlation between country centrality (measured e.g. in terms of betweenness centrality) and node degree, typically found in previous studies. The robustness of this result across several years and different commodity classes strengthens our previous discussion about the importance of including the degree sequence among the focuses of theories and models of trade, which are instead currently oriented mainly at reproducing the weighted structure, rather than the topology of the ITN.

The ITN as a binary directed network

We now consider the binary directed description of the ITN, with an interest in understanding whether the introduction of directionality changes the picture we have described so far. In the directed binary case, a graph [formula] is completely specified by its adjacency matrix [formula] which is in general not symmetric, and whose entries are aij = 1 if a directed link from vertex i to vertex j is there, and aij = 0 otherwise. The local constraints {Ca} are now the two sets of out-degrees and in-degrees of all vertices defined in Eqs.([\ref=eq_controlkout]) and ([\ref=eq_controlkin]), i.e. the out-degree sequence {kouti} and the in-degree sequence {kini}. In Appendix [\ref=app_bdn] we show how the randomization method enables in this case to obtain the expectation value 〈X〉 of a property X across the maximally random ensemble of binary directed graphs with in-degree and out-degree sequences equal to the observed ones. When inspecting the properties of the ITN and its randomized variants, the useful independent variables are now the values {kouti} and {kini} (or combinations of them), since they are the special quantities X whose expected value 〈X〉 coincides with the observed one by construction. Again, we first consider the 2002 snapshot of the completely aggregated ITN (Sections [\ref=sec_bdn_annd] and [\ref=sec_bdn_clustering]), then track the temporal evolution of the results backwards (Section [\ref=sec_bdn_evolution]), and finally perform a disaggregated analysis in Section [\ref=sec_bdn_dis].

Directed average nearest neighbor degrees

We start with the analysis of the binary directed trade network aggregated over all commodities (c = 0). Therefore, in the following formulas, we set [formula]. The average nearest neighbor degree of a vertex in a directed graph can be generalized in four ways from its undirected analogue. We thus obtain the quantities

[formula]

In the above expressions, indirect interactions due to the concatenation of pairs of edges are taken into account according to their directionality, as clear from the presence of products of the type aijakl. A fifth possibility is an aggregated measure based on the total degree [formula] of vertices:

[formula]

The latter is a useful one to start with, as it provides a simpler analogue to the undirected quantity knni we have already studied. At the same time, it must be noted that the two quantities are not trivially related since the total directed properties ktoti and ktot / toti carry more information than the corresponding undirected ones ki and knni, the difference being the local reciprocity structure of the network [\cite=myreciprocity]. To see this, note that ktoti = ki + k↔i, where [formula] (if aij is the adjacency matrix of the directed network) is the reciprocated degree of vertex i, defined as the number of bidirectional links reaching i [\cite=myreciprocity] [\cite=ZL] [\cite=ZS]. This quantity represents the number of trade partners, acting simultaneously as importers and exporters, of country i. Therefore, studying total directed quantities also allows to assess whether the reciprocity structure of the directed network changes the results obtained in the undirected case (similar considerations apply to the directed clustering coefficients we introduce below).

In Fig. [\ref=fig_bdn_knn] we plot ktot / toti as a function of ktoti for the 2002 snapshot of the binary directed ITN. The trend shown does not differ substantially from its undirected counterpart we observed in Fig. [\ref=fig_bun_knn]. In particular, we obtain a similar disassortative character of the correlation profile. Importantly, we find again a good agreement between the empirical quantity and its expected value 〈ktot / toti〉 under the null model (obtained as in Appendix [\ref=app_bdn]). In Fig. [\ref=fig_bdn_knndir] we show a more refined analysis by considering all the four directed versions of the ANND defined in Eqs.([\ref=eq_bdn_kinin])-([\ref=eq_bdn_koutout]), as well as their expected values under the null model (see Appendix [\ref=app_bdn]). We immediately see that all quantities still display a disassortative trend, with some differences in the ranges of observed values. Again, all the four empirical behaviors are in striking accordance with the null model, as the randomized curves (obtained as in Appendix [\ref=app_bdn]) show. This means that both the decreasing trends and the ranges of values displayed by all quantities are well reproduced by a collection of random graphs with the same average in-degrees and out-degrees as the real network.

Directed clustering coefficients

We now consider the directed counterparts of the clustering coefficient defined in Eq. ([\ref=eq_bun_ck]). Again, there are four possible generalizations depending on whether the directed triangles involved are of the inward, outward, cyclic or middleman type [\cite=Fagiolo2007pre]:

[formula]

The directed clustering coefficients are determined by indirect interactions of length 3 according to their directionality, appearing as products of the type aijaklamn in the above formulas. At the same time, since they always focus on three vertices only, they capture the local occurrence of particular network motifs [\cite=motifs] of order 3. A fifth aggregated measure, based on all possible directions, is

[formula]

As for ktot / toti, the latter definition is a good starting point for a comparison with the undirected case. In Fig. [\ref=fig_bdn_ck] we show ctoti and 〈ctoti〉 (see Appendix [\ref=app_bdn]) as a function ktoti for our usual snapshot. We see no fundamental difference with respect to Fig. [\ref=fig_bun_ck]. Again, the randomized quantity does not deviate significantly from the empirical one.

We now turn to the four directed clustering coefficients defined in Eqs.([\ref=eq_bdn_cin])-([\ref=eq_bdn_cmid]). We show these quantities in Fig. [\ref=fig_bdn_cdir] as functions of different combinations of kini and kouti, depending on the particular definition. As for the directed ANND, we observe some variability in the range of observed clustering values. However, all the quantities are again in accordance with the expected ones under the null model (see Appendix [\ref=app_bdn]).

Evolution of binary directed properties

We now track the temporal evolution of the above results by performing, for each year in our time window, an analysis similar to that reported in sec.[\ref=sec_bun_evolution] for the undirected case.

We start by showing the evolution of the total average nearest neighbor degree ktot / toti in the four panels of Fig. [\ref=fig_bdn_ktot_t], where we plot the same properties considered previously for the undirected ANND in Fig. [\ref=fig_bun_knn_t]. We find that the temporal evolution of the average (Fig. [\ref=fig_bdn_ktot_t]a) and standard deviation (Fig. [\ref=fig_bdn_ktot_t]b) of ktot / toti is essentially the same as that of the undirected knni, apart from differences in the range of values. Similarly, the correlation coefficients between ktot / toti and ktoti (Fig. [\ref=fig_bdn_ktot_t]c), 〈ktot / toti〉 and 〈ktoti〉 = ktoti (Fig. [\ref=fig_bdn_ktot_t]c), ktot / toti and 〈ktot / toti〉 (Fig. [\ref=fig_bdn_ktot_t]d) mimic their undirected counterparts, confirming that the perfect accordance between ktot / toti and 〈ktot / toti〉 is stable over time, and that the disassortative trend of ktot / toti as a function of ktoti (Fig. [\ref=fig_bdn_knn]) is always completely explained by the null model.

We now consider the four directed variants kin / ini, kin / outi, kout / ini, kout / outi. For brevity, for these quantities we only show the evolution of the average values, which are reported in Fig. [\ref=fig_bdn_knndir_t]. We find that the overall behavior previously reported for the average of ktot / toti (Fig. [\ref=fig_bdn_ktot_t]a) is not reflected in the individual trends of the four directed versions of the ANND. In particular, the averages of kin / ini (Fig. [\ref=fig_bdn_knndir_t]a), kin / outi (Fig. [\ref=fig_bdn_knndir_t]b) and kout / outi (Fig. [\ref=fig_bdn_knndir_t]d) increase over a downward-shifted but wider range of values than that of ktot / toti, whereas the average of kout / ini (Fig. [\ref=fig_bdn_knndir_t]c) is almost constant in time. The moderately increasing average of ktot / toti is therefore the overall result of a combination of different trends followed by the underlying directed quantities, some of these trends being strongly increasing and some being almost constant. Therefore we find the important result that there is a substantial loss of information in passing from the inherently directed quantities to the undirected or symmetrized ones. Still, when we compare the empirical trends of the directed quantities with the randomized ones, we find an almost perfect agreement. This implies that even the finer structure of directed correlation profiles, as well as their evolution, is reproduced in great detail by controlling for the local directed topological properties alone.

The same analysis is shown for the total clustering coefficient ctoti in Fig. [\ref=fig_bdn_ctot_t], and for the four directed variants cini, couti, ccyci, cmidi in Fig. [\ref=fig_bdn_cdir_t]. Again, we find that the four temporal trends involving the overall quantity ctoti (Fig. [\ref=fig_bdn_ctot_t]) replicate what we have found for its undirected counterpart ci (shown previously in Fig. [\ref=fig_bun_c_t]). When we consider the four inherently directed quantities (Fig. [\ref=fig_bdn_cdir_t]), we find that the averages of cini (Fig. [\ref=fig_bdn_cdir_t]a) and ccyci (Fig. [\ref=fig_bdn_cdir_t]c) display an increasing trend, whereas the average of cmidi (Fig. [\ref=fig_bdn_cdir_t]d) is constant and that of couti (Fig. [\ref=fig_bdn_cdir_t]b) is even decreasing. When aggregated, these different trends give rise to the constant behavior of the average ctoti, which is therefore not representative of the four underlying directed quantities. This also means that, similarly to what we found for the ANND, there is a substantial loss of information in passing from the directed to the undirected description of the binary ITN. However, even the fine-level differences among the directed clustering patterns are still completely reproduced by the null model.

Commodity-specific binary directed networks

We now study the binary directed ITN when disaggregated (commodity-specific) representations are considered. We repeat the analysis described above by setting [formula] with c > 0. For brevity, we report our analysis of the 6 commodities described in Section [\ref=sec_bun_dis] and selected from the top 14 categories listed in table [\ref=table] (again, we found similar results for all commodities). Together with the aggregated binary directed ITN already described, these commodity classes form a set of 7 different cases ordered by increasing trade intensity and level of commodity aggregation.

In Figs. [\ref=fig_bdn_dis1] and [\ref=fig_bdn_dis2] we show the behavior of the total average nearest neighbor degree and total clustering coefficient for the 2002 snapshots of the 6 selected commodity-specific networks. When compared with Figs. [\ref=fig_bdn_knn] and [\ref=fig_bdn_ck], the plots confirm what we have found in Section [\ref=sec_bun_dis] for the binary undirected case. In particular, the behavior displayed by the ANND and clustering in the commodity-specific networks becomes less and less noisy as more intensely traded commodities, and higher levels of aggregation, are considered. Accordingly, the agreement between real and randomized networks increases, but the accordance is already remarkable in commodity-specific networks, even the sparsest and least aggregated ones. These results confirm that, irrespective of the level of commodity resolution and trade volume, the directed degree sequences completely characterize the topology of the binary directed representations of the ITN.

Conclusions

All the above results clearly imply that, in the undirected as well as the directed case, for all the years considered, and across different commodity classes, the disassortativity and clustering profiles observed in the real binary ITN arise as natural outcomes rather than genuine correlations, once the local topological properties are fixed to their observed values. Therefore we can conclude that the higher-order patterns observed in all the binary representations of the ITN, as well as their temporal evolution, are completely explained by local constraints alone. This means that the (undirected/directed) degree sequence of the ITN is maximally informative, since its knowledge systematically conveys a full picture of the binary topology of the network. These results have important consequences for economic models of trade. In particular, they suggest that the ITN topology should become one of the main focuses of international-trade theories. While most of the literature concerned with modeling international trade has focused on the problem of reproducing the magnitude of nonzero trade volumes (the most important example being gravity models [\cite=Fagiolo2010jeic]), much less emphasis has been put on correctly replicating the binary topology of the ITN, i.e. understanding the determinants of the process governing the creation of a link. However, our results clearly show that the purely topological structural properties (and in particular the degree sequence) of the ITN carry a significant amount of information.

A first step in reproducing the ITN topology is the model in Ref. [\cite=Garla2004], where the probability pij of a trade relationship between two countries i and j was modeled as a function of the GDP values of the countries themselves, and all the topological properties of the network were successfully replicated. Interestingly, the form of that function coincides with the connection probability of the null model considered here, shown in Appendix [\ref=app_bun] in Eq. ([\ref=eq_bun_pij]), where the role of the Lagrange multiplier xi associated with ki is played by the GDP of country i. Indeed, an approximately monotonic relationship between GDP and degree has been observed [\cite=Garla2004], providing a connection between these two results. From another perspective, the above remark also means that the accordance between the real ITN as a binary undirected network and its randomized counterpart is replicated under an alternative null model, that controls for the empirical values of the GDP rather than for the degree sequence. The importance of reproducing the binary topology of trade is reinforced by the analysis of the ITN as a weighted network with local constraints, as we show in the following paper [\cite=part2].

The randomization method

Given a real network with N vertices, there are various ways to generate a family of randomized variants of it [\cite=Holland_Leinhardt_1976] [\cite=Kannan_etal_1999] [\cite=Katz_Powell_1957] [\cite=Rao_etal_1996] [\cite=Roberts_2000] [\cite=Shen-Orr_etal_2002] [\cite=Snijders_1991] [\cite=maslov] [\cite=msz] [\cite=chunglu] [\cite=myrandomization]. The most popular one is the local rewiring algorithm proposed by Maslov and Sneppen [\cite=maslov] [\cite=msz]. In this method, one starts with the real network and generates a series of randomized graphs by iterating a fundamental rewiring step that preserves the desired properties. In the binary undirected case, where one wants to preserve the degree of every vertex, the steps are as follows: choose two edges, say (i,j) and (k,l); rewire these connections by swapping the end-point vertices and producing two new candidate edges, say (i,l) and (k,j); if these two new edges are not already present, accept them and delete the initial ones. After many iterations, this procedure generates a randomized variant of the original network, and by repeating this exercise a sufficiently large number of times, many randomized variants are obtained. By construction, all these variants have exactly the same degree sequence as the real-world network, but are otherwise random. In the directed and/or weighted case, extensions of the rewiring steps defined above can be introduced, even if with some caution [\cite=serrc07] [\cite=Opsahl_etal_2008]. Maslov and Sneppen's method allows one to check whether the enforced properties are partially responsible for the topological organization of the network. For instance, one can measure the degree correlations, or the clustering coefficient, across the randomized graphs and compare them with the empirical values measured on the real network. This method has been applied to various networks, including the Internet and protein networks [\cite=maslov] [\cite=msz]. Different webs have been found to be affected in very different ways by local constraints, making the problem interesting and not solvable a priori.

The main drawback of the local rewiring algorithm is its computational requirements. Since the method is entirely computational, and analytical expressions for its results are not available, one needs to explicitly generate several randomized graphs, measure the properties of interest on each of them (and store their values), and finally perform an average. This average is an approximation for the actual expectation value over the entire set of allowed graphs. In order to have a good approximation, one needs to generate a large number M of network variants. Thus, the time required to analyze the impact of local constraints on any structural property is M times the time required to measure that property on the original network, plus the time required to perform many rewiring steps producing each of the M randomized networks. The number of rewiring steps required to obtain a single randomized network is O(L) where L is the number of links [\cite=maslov] [\cite=msz] [\cite=myrandomization], and O(L) = O(N) for sparse networks while O(L) = O(N2) for dense networks . Thus, if the time required to measure a given topological property on the original network is O(Nτ), the time required to measure the randomized value of the same property is O(M  ·  L) + O(M  ·  Nτ), which is O(M  ·  Nτ) as soon as τ  ≥  2.

A recently proposed alternative method, which is remarkably faster due to its analytical character, is based on the maximum-likelihood estimation of maximum-entropy models of graphs [\cite=myrandomization]. In this method, one first specifies the desired set of local constraints {Ca}. Second, one writes down the analytical expression for the probability [formula] that, subject to the constraints {Ca}, maximizes the entropy

[formula]

where [formula] denotes a particular graph in the ensemble, and [formula] is the probability of occurrence of that graph. This probability defines the ensemble featuring the desired properties, and being maximally random otherwise. Depending on the particular description adopted, the graphs [formula] can be either binary or weighted, and either directed or undirected. Accordingly, the sum in Eq. ([\ref=eq_entropy]), and in similar expressions shown later on, runs over all graphs of the type specified. The formal solution to the entropy maximization problem can be written in terms of the so-called Hamiltonian [formula], representing the energy (or cost) associated to a given graph [formula]. The Hamiltonian is defined as a linear combination of the specified constraints {Ca}:

[formula]

where {θa} are free parameters, acting as Lagrange multipliers controlling the expected values {〈Ca〉} of the constraints across the ensemble. The notation [formula] denotes the particular value of the quantity Ca when the latter is measured on the graph [formula]. In terms of [formula], the maximum-entropy graph probability [formula] can be shown to be

[formula]

where the normalizing quantity Z is the partition function, defined as

[formula]

Third, one maximizes the likelihood [formula] to obtain the particular graph [formula], which is the real-world network that one wants to randomize. This steps fixes the values of the Lagrange multipliers that finally allow to obtain the numerical values of the expected topological properties averaged over the randomized ensemble of graphs. The particular values of the parameters {θa} that enforce the local constraints, as observed on the particular real network [formula], are found by maximizing the log-likelihood

[formula]

to obtain the real network [formula]. It can be shown [\cite=mylikelihood] that this is equivalent to the requirement that the ensemble average 〈Ca〉 of each constraint Ca equals the empirical value measured on the real network:

[formula]

Note that we generally adopted a simplified notation by writing C*a (or even only Ca) instead of [formula] for the empirically observed values of the constraints (see for instance Sections [\ref=sec_data] and [\ref=sec_controlling]). Once the parameter values are found, they are inserted into the formal expressions yielding the expected value

[formula]

of any (higher-order) property of interest X. The quantity 〈X〉 represents the average value of the property X across the ensemble of random graphs with the same average (across the ensemble itself) constraints as the real network. In what follows we provide a detailed account of the expressions for the randomized properties appearing in our analysis.

Technically, while the local rewiring algorithm generates a microcanonical ensemble of graphs, containing only those graphs for which the value of each constraint Ca is exactly equal to the observed value [formula], the maximum-likelihood method generates an expanded grandcanonical ensemble where all possible graphs with N vertices are present, but where the ensemble average of each constraint Ca is equal to the observed value [formula]. One can show that the microcanonical approach converges to the grandcanonical one as the number of microcanonical randomization steps increases [\cite=myrandomization]. However, the maximum-likelihood one is significantly faster. Importantly, enforcing only local constraints implies that [formula] factorizes as a simple product over pairs of vertices. This has the nice consequence that the expression for 〈X〉 is generally only as complicated as that for X. In other words, after the preliminary maximum-likelihood estimation of the parameters {θa}, in this method the time required to obtain the exact expectation value of an O(Nτ) property across the entire randomized graph ensemble is the same as that required to measure the same property on the original real network, i.e. still O(Nτ). Therefore, as compared to the local rewiring algorithm, which requires a time O(M  ·  Nτ), the maximum-likelihood method is O(M) times faster, for arbitrarily large M.

Binary undirected properties

In the binary undirected case, each graph [formula] is completely specified by its (symmetric) Boolean adjacency matrix [formula]. The randomization method described above proceeds by

specifying the degree sequence as the constraint: {Ca}  =  {ki}. The Hamiltonian therefore reads

[formula]

and one can show [\cite=newman_expo] that this allows to write the graph probability as

[formula]

where

[formula]

(with [formula]) is the probability that a link exists between vertices i and j in the maximum-entropy ensemble of binary undirected graphs, subject to specifying a given degree sequence as the constraint;

solving the maximum-likelihood equations, by setting the parameters {xi} to the values that maximize the likelihood [formula] to obtain the real network A* [\cite=myrandomization] [\cite=mylikelihood]. These values can be found as the solution to the following set of N coupled nonlinear equations [\cite=mylikelihood]:

[formula]

where [formula] is the empirical degree sequence of the real network [formula]. For a detailed analysis about solving such system see [\cite=fienberg] (for a discussion about the existence of solutions) and [\cite=myrandomization] (for a discussion about the convergence of the algorithm). In principle, dimensionality and memory problems can arise when N is too large (luckily, this is not the case of the ITN considered here). In such a case, the system can be re-written with a lower number of equation to solve. In fact, the hidden variables of the vertices with the same degree have the same value. So, one can straightforwardly solve the system only for them [\cite=mylikelihood];

computing the probability coefficients pij, by inserting the values {xi} into eq. ([\ref=eq_bun_pij]) which allows to easily compute the expectation value 〈X〉 of any topological property X analytically, without generating the randomized networks explicitly [\cite=myrandomization]. With this choice, eq. ([\ref=eq_bun_pij]) yields the exact value of the connection probability in the ensemble of randomized networks with the same average degree sequence as the empirical one. Note that pij is the probability of a link between vertex i and vertex j in the grandcanonical ensemble (which is directly obtained analytically), and not the frequency of such a link in the corresponding microcanonical ensemble (which would require the explicit generation of artificially rewired networks). In ref.[\cite=myrandomization], it was shown that the microcanonical frequency converges to pij asymptotically as the number of randomization steps in the microcanonical algorithm increases. Equation ([\ref=eq_meank]) shows that, by construction, the degrees of all vertices are special local quantities whose expected and empirical values are exactly equal: 〈ki〉 = ki. It follows that the pij coefficients can be calculated by using any of the networks in the corresponding microcanonical ensemble with constrained degree sequence: the expected values of the high-order properties will be the same;

computing the expectation values of higher-order topological properties, as in Table [\ref=tab_b]. The expressions are derived exploiting the fact that 〈aij〉 = pij, and that different pairs of vertices are statistically independent, which implies 〈aijakl〉 = pijpkl if (i - j) and (k - l) are distinct pairs of vertices, whereas 〈aijakl〉  =  〈a2ij〉  =  〈aij〉 = pij if (i - j) and (k - l) are the same pair of vertices. Also, the expected value of the ratio of two quantities is approximated with the ratio of the expected values: 〈n / d〉  ≈  〈n〉  /  〈d〉.

Binary directed properties

In the binary directed case, the above results can be generalized as follows. Each graph [formula] is completely specified by its Boolean adjacency matrix [formula], which now is in general not symmetric. The maximum-likelihood randomization method [\cite=myrandomization] proceeds in this case by

specifying both the in-degree and the out-degree sequences as the constraints: {Ca}  =  {kini,kouti}. The Hamiltonian takes the form

[formula]

The above choice leads to the graph probability [\cite=myrandomization]

[formula]

where

[formula]

(with [formula] and [formula]) is the probability that a link exists from vertex i to vertex j in the maximum-entropy ensemble of binary directed graphs with specified in- and out-degree sequences;

solving the maximum-likelihood equations, by setting the parameters {xi} and {yi} to the values that maximize the likelihood [formula] to obtain the real network A* [\cite=myrandomization] [\cite=mylikelihood]. These values can be found as the solution to the following set of 2N coupled nonlinear equations [\cite=mylikelihood]:

[formula]

where [formula] and [formula] are the empirical degree sequences of the real network [formula]. Again, for a detailed analysis about solving such system see [\cite=fienberg] [\cite=myrandomization];

computing the probability coefficients pij, by inserting the values {xi} and {yi} into Eq. ([\ref=eq_bdn_pij]) which allows to easily compute the expectation value 〈X〉 of any topological property X analytically, without generating the randomized networks explicitly [\cite=myrandomization]. So Eq. ([\ref=eq_bdn_pij]) yields the exact value of the connection probability in the ensemble of randomized directed graphs with the same average degree sequences as the empirical ones and Eqs. ([\ref=eq_meankout])-([\ref=eq_meankin]) show that, by construction, the in-degrees and out-degrees of all vertices are special local quantities whose expected and empirical values are exactly equal: 〈kini〉 = kini and 〈kouti〉 = kouti. It follows that the pij coefficients can be calculated by using any of the networks in the corresponding microcanonical ensemble with constrained in-degree and out-degree sequences: the expected values of the high-order properties will be the same;

computing the expectation values of the higher-order topological properties, as in Table [\ref=tab_b], by using the same prescription as in the undirected case plus the additional care that now (i - j) and (j - i) are different (and statistically independent) directed pairs of vertices. Therefore 〈aijaji〉 = pijpji.