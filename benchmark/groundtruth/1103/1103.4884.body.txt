Poly-Bernoulli numbers and lonesum matrices

Introduction

Kaneko [\cite=kaneko] [\cite=kaneko1] defined and studied the poly-Bernoulli numbers B(n)m of index [formula] by the generating function

[formula]

where Lin(z) denotes the formal power series [formula] (the nth polylogarithm when n > 0 and the rational function [formula] when n  ≤  0). By analyzing this generating function, Kaneko et al. proved formulas for the poly-Bernoulli numbers of negative indices [\cite=kaneko] [\cite=arakawa]:

[formula]

Here S(m,l) denotes the Stirling number of the second kind, which is the number of ways to partition an m-element set into l nonempty subsets. Sánchez-Peregrino also proved the equation ([\ref=equation3]) by a much simpler way [\cite=sanchez] [\cite=sanchez1]. The motivation of this research is combinatorial interpretations of Kaneko's formulas.

A binary matrix is a matrix each of whose entries is either 0 or 1 and a lonesum matrix is a matrix that can be uniquely reconstructed from its row and column sums. Ryser [\cite=ryser] proved that a binary matrix is a lonesum matrix if and only if each of its 2  ×  2-submatrices is not

[formula]

Brewbaker exploited this result and computed the number of binary lonesum m  ×  n-matrices by the principle of inclusion and exclusion [\cite=brewbaker1] [\cite=brewbaker]. This number coincides with the right hand side of the formula ([\ref=equation2]).

We investigate properties of binary lonesum matrices in Section [\ref=section2]. First of all, we present the second proof of Ryser's theorem. Brewbaker may have known this proof although he did not explicitly state it in [\cite=brewbaker1] [\cite=brewbaker]. The main idea of the second proof is to partition the set of binary lonesum m  ×  n-matrices. Computing the number of lonesum matrices in each set and summing them up, Brewbaker obtained the right hand side of the formula ([\ref=equation3]). Therefore we may regard that Kaneko's formulas ([\ref=equation2]) and ([\ref=equation3]) are computations of the number of binary lonesum m  ×  n-matrices, on one hand, by using the principle of inclusion and exclusion and, on the other hand, by partitioning the set of binary lonesum m  ×  n-matrices.

A q-ary matrix is a matrix each of whose entries is in [formula]. We consider q-ary lonesum matrices in Section [\ref=section3]. There are two types of lonesum matrices in q-ary matrices, namely, strong and weak lonesum matrices (see the definitions in Section [\ref=section3]). Throughout Subsection [\ref=subsection3.1] (resp. [\ref=subsection3.2]), a lonesum matrix means a strong (resp. weak) lonesum matrix.

We devote Subsection [\ref=subsection3.1] to strong lonesum matrices. We first generalize the second proof of Ryser's theorem to q-ary matrices. It turns out that every minimal q-ary non-lonesum matrix is of size 2  ×  2. We next compute the number of ternary lonesum m  ×  n-matrices and generalize this technique to q-ary lonesum matrices. We also give the formula for the number of q-ary symmetric lonesum n  ×  n-matrices. We finally compute the generating function for the number of q-ary lonesum matrices and generalize Kaneko's formulas ([\ref=equation1]) and ([\ref=equation4]).

We dedicate Subsection [\ref=subsection3.2] to weak lonesum matrices. After studying properties of weak lonesum matrix, we show that if q  ≥  5 then the number of q-ary weak non-lonesum matrices is infinite, and we construct some q-ary weak non-lonesum matrices when q∈{3,4}. We also suggest an open problem related with weak lonesum matrices.

Binary lonesum matrices

A binary matrix is a matrix each of whose entries is either 0 or 1. Throughout this section, every matrix is a binary matrix unless we specify otherwise. A lonesum matrix is a matrix that can be uniquely reconstructed it from its row and column sums. For example, a 3  ×  3 matrix with rows (1,1,0), (1,0,0), and (1,1,0) is a lonesum matrix because of the unique reconstruction:

[formula]

Brewbaker proved most results of this section [\cite=brewbaker1] [\cite=brewbaker]. For the convenience of the reader and the sake of completeness, we give a few properties of lonesum matrices with short proofs, which are useful in our discussion of q-ary lonesum matrices in Section [\ref=section3].

The criterion to distinguish lonesum matrices from non-lonesum ones is a theorem proved by Ryser [\cite=ryser].

A binary matrix is a lonesum matrix if and only if each of its 2  ×  2 submatrices is not

[formula]

Two matrices M and [formula] are said to be equivalent if M is changed into [formula] by a row or column permutations, that is, there are permutation matrices P and [formula] such that [formula]. A forbidden matrix is a non-lonesum matrix each of whose proper submatrices is a lonesum matrix, that is, a minimal non-lonesum matrix. Evidently, every matrix that contains a forbidden matrix is not a lonesum matrix. Hence we focus on forbidden matrices that are not equivalent to each other. Using these terminologies, we can rephrase Theorem [\ref=ryser] in the form that [formula] is the unique forbidden matrix.

Let M be a lonesum m  ×  n-matrix. Identifying a binary vector with the set of its nonzero coordinates, we regard a row of M as a subset of [formula]. Then Theorem 2.1 states that M is a lonesum matrix if and only if the rows of M form a chain in the inclusion lattice formed by the subsets of [formula]. Using this fact, Brewbaker proved that the right hand side of Kaneko's formula ([\ref=equation2]) gives the number of lonesum m  ×  n-matrices [\cite=brewbaker1] [\cite=brewbaker].

Using that the rows of a lonesum matrix form a chain, we consider another proof of Theorem [\ref=ryser]. This proof provides the main tool for constructing lonesum matrices and computing the number of lonesum m  ×  n-matrices.

The second proof of Theorem [\ref=ryser]. A stair matrix is a matrix whose ith row is (1ri,0n - ri) with [formula]. Figure [\ref=bstandard] is an example of stair matrix. It is sufficient to prove that a matrix has no submatrix equivalent to [formula] if and only if it is equivalent to a stair matrix.

The necessity is clear because every stair matrix is a lonesum matrix. For the sufficiency, let M be an m  ×  n-matrix that has no submatrix equivalent to [formula]. Permuting the rows of M suitably, we assume that [formula] where ri denotes the number of 1s in the ith row of M. By an appropriate column permutation, we further assume that the first row of M is (1r1,0n - r1). Then the last n - r1 entries of the second row of M should be all zeros. Now a suitable column permutation changes the second row of M into (1r2,0n - r2) with r1  ≥  r2. If we continue this process, then M becomes equivalent to a stair matrix.

Let M be a lonesum m  ×  n-matrix. The second proof of Theorem [\ref=ryser] implies that M is equivalent to a stair matrix, called the standard form of M. Hence an ordered partition pair

[formula]

where

[formula]

with |A0|  ≥  0, |B0|  ≥  0 and |Ai|  ≥  1 |Bi|  ≥  1 for i  ≥  1 determines the positions of 1 in M. Here [formula] denotes the disjoint union. For example, the matrix in Figure [\ref=bstandard] satisfies

[formula]

This means that the (a,b)-entry of M is 1 if and only if [formula] for some i. We call j + 1 the number of stairs in M. Since |A0|  ≥  0 and |B0|  ≥  0, the construction of ([\ref=partitionpair]) is equivalent to that of

[formula]

Therefore for a fixed j the number of ordered partition pairs of the form ([\ref=partitionpair]) is

[formula]

Summing ([\ref=lonesum1]) for 0  ≤  j  ≤  min(m,n) yields the number of binary lonesum m  ×  n-matrices

[formula]

which coincides with the formula ([\ref=equation3]).

This proves that Kaneko's formula ([\ref=equation3]) is nothing but computation of the number of lonesum m  ×  n-matrices by partitioning the set of lonesum m  ×  n-matrices according to the standard forms of its elements. Brewbaker may have known this fact [\cite=brewbaker1] [\cite=brewbaker]. We include this proof since we can directly generalize the idea of this proof to q-ary lonesum matrices in Section [\ref=section3].

Using quantum algebra, Launois [\cite=launois] [\cite=launois1] proved that the number of lonesum m  ×  n-matrices equals the number of permutations σ on [formula] satisfying - n  ≤  σ(i) - i  ≤  m for 1  ≤  i  ≤  m + n. We can construct a one-to-one correspondence between such permutations and lonesum m  ×  n-matrices as follows:

Let M = (Mji) be a lonesum m  ×  n-matrix with exactly k different nonzero rows and k different nonzero columns. The reason of denoting the entries of M by Mji is that we need to determine a position of a rook (defined later) in 2-dimensional space by an Mji. Assigning an order to the columns sums of M, we define a k-tuple [formula] of subsets of [formula] by the rule: i∈Ca if and only if the ith column has the ath column sum. Similarly, we define a k-tuple [formula] of subsets of [formula], which corresponds to the row sums of M. For example,

[formula]

Using the standard form of lonesum matrix, it is easy to understand that the mapping

[formula]

defines a one-to-one correspondence between the lonesum m  ×  n-matrices that have exactly k different column sums (equivalently, exactly k different row sums) and the pairs of k-tuples composed of mutually disjoint nonempty subsets of [formula] and [formula], respectively.

For convenience, we define two partition functions

[formula]

by

[formula]

where

[formula]

The inverse mapping is defined by

[formula]

Considering Step 1, we establish a one-to-one correspondence between the lonesum m  ×  n-matrices and the permutations σ on [formula] that satisfy

[formula]

for [formula].

We start with a permutation matrix P that corresponds to σ. We call the ones of the matrix P rooks. Assume that P satisfies the condition ([\ref=rcondition]). Let k be the number of rooks in the top-left n  ×  m-submatrix of P, and

[formula]

be the positions of these rooks where [formula].

Next, we define a partition function

[formula]

For [formula] we let C(ia) = a

[formula]

and if there is a rook in the positoin (i,m + 1) for some [formula], then we define C(i) = 0

[formula]

For any other rooks in the positions (i,j) for [formula], we apply the rule C(i) = C(j - m - 1)

[formula]

Since j - m - 1 < i, the function C is well-defined. Remark that the sets [formula] are nonempty while the set C0 can be empty.

Similarly, the m rooks with the m smallest values j in their position (i,j) of the matrix P define the function

[formula]

For this, we rotate the matrix P to the angle of [formula] and then apply the same algorithm, by exchanging the roles of m and n.

Now we describe the inverse transformation

[formula]

Assume that we have two partitions [formula] and [formula] of [formula] and [formula], respectively, where only C0 and R0 can be empty. For [formula] let

[formula]

satisfying [formula]. The positions of |Ci| rooks that correspond to the set Ci are

[formula]

where c0 = m + 1, [formula], and exact values of [formula] are still unknown. So, we already know the positions of the n - k rooks in the top-right n  ×  n-submatrix of P, and the first coordinates and the order (from the left to the right) of the positions of the k rooks in the top-left n  ×  m-submatrix of P.

Similarly (in a symmetrical way), the partition [formula] defines the positions of the n - k rooks in the bottom-left m  ×  m submatrix of P and the first coordinates and the order of the positions of the k rooks in the lower-right m  ×  n submatrix of P. Since no two rooks can not be in the same column of P, this information uniquely identifies the permutation matrix P.

Lovász gave a slightly weaker version of this correspondence [\cite=lovasz].

q-ary lonesum matrices

A q-ary matrix is a matrix each of whose entries is in [formula]. There are two types of lonesum matrices for q-ary matrices. For a q-ary vector [formula] the structure vector of [formula] is [formula] where aj is the number of entries in [formula] such that vi = j. A strong (resp. weak) lonesum matrix is a matrix that can be uniquely reconstructed from its row and column sums (resp. structure vectors). For binary matrices, the definition of strong lonesum matrix and that of weak one are identical, however, this is not true for nonbinary matrices.

A 3  ×  3-matrix with the rows (0,1,0), (1,2,1), and (0,1,0) is a strong lonesum matrix because we can uniquely reconstruct it from its row and column sums:

[formula]

A 3  ×  3-matrix with the rows (0,1,0), (1,2,1), and (0,1,1) is a weak lonesum matrix because we can uniquely reconstruct it from its row and column structure vectors: Notice that this matrix is not a strong lonesum matrix. In fact, we can construct two different matrices with the row sums 1, 4, 2 and the column sums 1, 4, 2:

[formula]

Strong lonesum matrices

It follows from Theorem [\ref=ryser] that every binary forbidden matrix is equivalent to [formula]. This means that every 2  ×  2-submatrix of a binary lonesum matrix is equivalent to one of where {b,c}  ⊆  {0,1}. By using this criterion, we have computed the number of binary lonesum m  ×  n-matrices. We consider a similar criterion for q-ary lonesum matrices and compute the number of q-ary lonesum m  ×  n-matrices by exploiting this new criterion.

The criterion for q-ary lonesum matrices

We first consider q-ary lonesum 2  ×  2-matrices. Let

[formula]

for [formula] be q-ary matrices. If M is a lonesum matrix, then M and M(α) have the same row and column sums if and only if α = 0. Without loss of generality, we assume that max {a,b,c,d} = a.

Suppose that a = q - 1. If either b = q - 1 or c = q - 1, then α = 0. We assume that b,  c < q - 1. Then α = 0 if and only if d = 0. Hence α = 0 if and only if M is one of Suppose that a < q - 1. Similarly, α = 0 if and only if M is one of Therefore α = 0 if and only if M is one of

[formula]

This implies that if a q-ary matrix is a lonesum matrix, then each of its 2  ×  2-submatrices is equivalent to one of the matrices ([\ref=forbidden2]). By using this, we show that this is also a sufficient condition for a q-ary matrix to be a lonesum matrix. Since we can easily generalize the criterion for ternary lonesum matrices to that for q-ary ones, we first consider the criterion for ternary lonesum matrices. Recall that a ternary matrix is a matrix each of whose entries is in {0,1,2}.

A ternary matrix is a lonesum matrix if and only if each of its 2  ×  2-submatrices is equivalent to one of

[formula]

where a,  b,  c,  d∈{0,1,2}.

Without proof, Brualdi stated this theorem [\cite=brualdi] .

Theorem [\ref=discriminantt] implies that every ternary forbidden matrix is equivalent to one of where {b,c}  ⊆  {0,1}.

Analyzing the proof of Theorem [\ref=discriminantt], we can construct a ternary lonesum matrix M as follows.

Permuting the rows and columns of M, we assume that [formula] if and only if [formula] and [formula].

Form stairs in M with 2.

Determine positions of both 0s and 1s by considering the 2  ×  2-matrices ([\ref=forbidden]) allowed in M.

In fact, we can apply the proof of Theorem [\ref=discriminantt] to q-ary matrices by substituting the role of q - 1 (resp. [formula]) for that of 2 (resp. {0,1}). This application yields the criterion for q-ary lonesum matrices.

A q-ary matrix is a lonesum matrix if and only if each of its 2  ×  2-submatrices is equivalent to one of

[formula]

where [formula].

Theorem [\ref=discriminantq] says that every non-lonesum matrix contains a 2  ×  2-matrix not equivalent to one of the matrices ([\ref=forbidden2]). Hence each q-ary forbidden matrix is of size 2  ×  2.

The number of q-ary lonesum m  ×  n-matrices

Using the second remark of Remark [\ref=remark3.2], we can construct ternary lonesum matrices, and comparing Theorems [\ref=discriminantt] and [\ref=discriminantq], we can apply construction of ternary lonesum matrices to that of q-ary ones. Hence, for simplicity, we first consider the case of ternary lonesum matrices.

Let M be a ternary lonesum m  ×  n-matrix. According to the criterion for ternary lonesum matrices, the positions 2 in M is determined by a partition pair

[formula]

where

[formula]

We define the ith block of M to be

[formula]

where 1  ≤  i  ≤  j. For example, the blocks of the matrix in Figure [\ref=tstair] are

[formula]

The criterion for ternary lonesum matrices implies that 1s can be in the blocks of M only.

For an r  ×  s-block the position set of 1s should be, by the criterion for ternary lonesum matrices,

[formula]

There are four cases:

[formula]

By a simple computation, the number of position sets of 1s in each case is the following:

[formula]

Summing the numbers in Cases 1-4 yields the number of position sets of 1s in the r  ×  s-block

[formula]

For a ternary m  ×  n-matrix the number of ways to form blocks of sizes [formula] is

[formula]

Therefore, denoting

[formula]

for j  ≥  1 and l  ≥  1, if we consider all of the standard forms and possible positions of 1s in blocks, then we obtain the number of ternary lonesum m  ×  n-matrices.

The number of ternary lonesum m  ×  n-matrices B( - n)m(3) is

[formula]

We now consider the case of q-ary lonesum matrices. Using Theorem [\ref=discriminantq] and generalizing the technique for ternary lonesum matrices, we can compute the number of q-ary lonesum m  ×  n-matrices. For this computation, we need only change f3(r,s) in the formula ([\ref=ternarylonesum]) into

[formula]

which is the number of position sets of 0s, 1s, , (q - 2)s in an r  ×  s-block.

The number of q-ary lonesum m  ×  n-matrices B( - k)n(q) is

[formula]

Symmetric lonesum matrices

We can uniquely reconstruct a symmetric lonesum matrix from its row or column sums. Hence both construction of symmetric lonesum matrices and computation of the number of those are simpler than those of ordinary ones.

To construct a q-ary symmetric lonesum n  ×  n-matrix, we need only choose an ordered partition [formula] of [formula] instead of an ordered partition pair. In addition, we may pair [formula] and [formula] for i  ≥  1 to form blocks. By the criterion for q-ary lonesum matrices, if the parity of j is even, then the block [formula] forms a diagonal matrix with at most one nonzero entry. Therefore, if we determine positions of 0s, 1s, , (q - 2)s by the criterion for q-ary lonesum matrices, then we obtain the number of q-ary symmetric lonesum n  ×  n-matrices.

The number of q-ary symmetric lonesum n  ×  n-matrices Bn(q) is

[formula]

For n∈{1,2,3,4,5} the number of q-ary symmetric lonesum n  ×  n-matrices is given in Table [\ref=table1]. It is known that Bn(2) is the number of necklaces of partitions of n + 2 labeled beads [\cite=sloane], however, we do not know any combinatorial meaning of the numbers Bn(q) for q  ≥  3. For example, the terms 3,18,149,1390,13377 for Bn(3) do not match any sequence in [\cite=sloane]. We think that it is a fascinating task to find a combinatorial object that explains a combinatorial meaning of the numbers Bn(q) for q  ≥  3.

Generating functions for the number of lonesum matrices and generalizations of Kaneko's formulas

Kaneko [\cite=kaneko] [\cite=kaneko1] defined the poly-Bernoulli numbers B(n)m by the generating function ([\ref=equation1]) and found out the formula ([\ref=equation4]). By q-ary lonesum matrices, we have generalized the poly-Bernoulli numbers of negative indices. We calculate generating functions for the number of q-ary lonesum matrices. This provides generalizations of Kaneko's formulas ([\ref=equation1]) and ([\ref=equation4]).

The exponential generating function for the number of ternary lonesum matrices is

[formula]

Let [formula]. By

[formula]

we gain

[formula]

Therefore the exponential generating function for the number of ternary lonesum matrices is

[formula]

Similarly, if we use

[formula]

then we obtain the exponential generating function for the number of q-ary lonesum matrices

[formula]

The formula ([\ref=generalization1]) is a generalization of Kaneko's formula ([\ref=equation4]).

For the case of symmetric lonesum matrices, if we apply the computation of the exponential generating function for the number of q-ary lonesum matrices and use

[formula]

then we obtain the exponential generating function for the number of symmetric q-ary lonesum matrices

[formula]

Now we consider a generalization of ([\ref=equation4]). By the definition of Fq(x,y),

[formula]

Hence the generating function ([\ref=generalization1]) becomes

[formula]

Computing the coefficient of [formula] in ([\ref=generalization2]) generalizes the generating function ([\ref=equation1]):

[formula]

Weak lonesum matrices

We have found out all the forbidden matrices for q-ary strong lonesum matrices and these are 2  ×  2-matrices. From this, we naturally wonder if there is a finite number of forbidden matrices for q-ary weak lonesum matrices. After studying properties of weak lonesum matrices, we show that if q  ≥  5 then the number of forbidden matrices for q-ary weak lonesum matrix is infinite. We also construct some nontrivial forbidden ternary and quarternary matrices. Recall that a quaternary matrix means a 4-ary matrix.

Let M be a q-ary matrix. A sequence [formula] of mutually different entries of M is called a path or an ab-path if it satisfies the following conditions:

For each [formula] either il = il + 1 or jl = jl + 1 is true.

For each [formula] both [formula] and [formula] are true.

There are two different numbers a, b in [formula] satisfying one of

[formula]

Denoting Mi1,j1 = Mik + 1,jk + 1 and Mi2,j2 = Mik + 2,jk + 2, if the sequence

[formula]

also holds Conditions 1-3, then we call the sequence S a cycle or an ab-cycle.

We may assume that a path S in M has at most two entries of M in each row and column. Otherwise, there is a subsequence of S that forms a cycle and does not contain Mi1,j1 and Mik,jk. Removing the entries of this subsequence from S forms a path shorter than S.

By the definition of cycle, a matrix with a cycle cannot be a weak lonesum matrix. In addition, we can construct an infinite family of forbidden matrices when q  ≥  5 by using cycles. Let Mn be a 5-ary n  ×  n-matrix defined by

[formula]

For example,

[formula]

For n  ≥  3 the matrix Mn is not a weak lonesum matrix, while each of its proper submatrices is a weakly lonesum matrix.

Proposition [\ref=iwlmatrix] implies that we can generate an infinite sequence of q-ary forbidden matrices when q  ≥  5. However, this is not true when q∈{3,4}.

Every quarternary matrix M with a cycle of length at least 6 contains a 2  ×  2, 2  ×  3, or 3  ×  2-matrices that are not weak lonesum matrices.

Every binary non-lonesum matrix contains a cycle, thus Theorem [\ref=iwlmatrix1] gives a third proof of Theorem [\ref=ryser].

In the rest of this subsection, we introduce some examples of forbidden ternary matrices and say some informal words about their structures.

Two examples of forbidden ternary matrices are

[formula]

The indices on entries in T (resp. [formula]) indicate the entires of an alternative matrix with the same row and column structure vectors of T (resp. [formula]). We can obtain more forbidden matrices by combining the following interchanges:

[formula]

We can observe that some rows and columns in T and [formula] contain triples of entries with values either 01, 12, 20 or 02, 10, 21 We call such triples 3-trades. Every entry of a 3-trade with the value ab is connected by an ab-path with an entry of another 3-trade, hence the value of the final entry is either ba (if the starting and finishing 3-trades are in the same row or column of a matrix) or ab (otherwise). Every such a path in T and [formula] has length 0, 1, or 2. If we define the parity of a 3-trade in such a way that each path connects an even or odd numbers of 3-trades, then the incidence between paths and 3-trades corresponds to the incidence between edges and vertices of a bipartite cubic graph. We can find a complete bipartite graph K3,3 in T or [formula] by this method.

For a every ternary weak non-lonesum matrix without cycles, we can find a similar structure corresponding to some other bipartite cubic graph (in general, multiedges are allowed). If there is an infinite sequence of ternary forbidden matrices, then it corresponds to a sequence of cubic graphs. We can easily show that the matrices with corresponding graphs having 2 or 4 vertices contain a forbidden 2  ×  2, 2  ×  3, or 3  ×  2-matrices. So, the matrices T and [formula] are the minimal possible ones in some sense. We also conjecture that the size 6  ×  6 is the smallest one for such matrices. A structure with six 3-trades can be replaced by a 5  ×  6-matrix of the form

[formula]

However, every way to fill the remaining entries of M forms a forbidden 2  ×  2 or 3  ×  2-submatrices (for this, it is sufficient to consider the values of a and b).

Using the concept of cycle, we have constructed an infinite sequence of 5-ary forbidden matrices, which are also suitable for any q-ary case with q  ≥  5. When q  ≤  4, we have shown that a cycle always forms a trivial forbidden submatrix. While nontrivial examples of ternary forbidden matrices exist, to verify that infinite sequence of ternary or quarternary forbidden matrices exist remains open.

Acknowledgements

We thank Prof. Kaneko for introduction of his results on poly-Bernoulli numbers and Sergey Avgustinovich for helpful discussions on weak lonesum matrices.