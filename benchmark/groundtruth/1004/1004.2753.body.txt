.def .tex

Conjecture Corollary Lemma Proposition Example Definition Exercise Remark Question Problem Claim Research Project

Effective equidistribution and the Sato-Tate law for families of elliptic curves

Introduction

Recently M. Ram Murty and K. Sinha [\cite=MS] proved effective equidistribution results showing the eigenvalues of Hecke operators on the space S(N,k) of cusp forms of weight k and level N agree with the Sato-Tate distribution. Our goal here is to use their framework to prove similar results for families of elliptic curves. We shall do this for the family of all elliptic curves and for one-parameter families of elliptic curves.

We first review notation and previous results. Let E:y2  =  x3  +  Ax  +  B with [formula] be an elliptic curve over [formula] with associated L-function

[formula]

where Δ =  - 16(4A3 + 27B2) is the discriminant of E, χ0 is the principal character modulo Δ, and

[formula]

By Hasse's bound we know [formula], so we may write [formula], where we may choose θE(p)∈[0,π]. See [\cite=Sil1] [\cite=Sil2] [\cite=ST] for more details and proofs of all the needed properties of elliptic curves.

How the aE(p)'s vary is of great interest. One reason for this is that they encode local data (the number of solutions modulo p), and are then combined to build the L-function, whose properties give global information about E. For example, the Birch and Swinnerton-Dyer conjecture [\cite=BS-D1] [\cite=BS-D2] states the order of the group of rational solutions of E equals the order of vanishing of L(E,s) at the central point. While we are far from being able to prove this, the evidence for the conjecture is compelling, especially in the case of complex multiplication and rank at most 1 [\cite=Bro] [\cite=CW] [\cite=GKZ] [\cite=GZ] [\cite=Kol1] [\cite=Kol2] [\cite=Ru]. In addition there is much suggestive numerical evidence for the conjecture; for example, for elliptic curves with modest geometric rank r, numerical approximations of the first r - 1 Taylor coefficients are consistent with these coefficients vanishing (see for instance the families studied in [\cite=Fe1] [\cite=Fe2] [\cite=Mil3]).

If E has complex multiplication then aE(p)  =  0 for half the primes; i.e., θE(p)  =  π / 2. The remaining angles θE(p) are uniformly distributed in

[formula]

with respect to the measure

[formula]

changing variables by setting x  =  2 cos θ this is equivalent to the measure [formula] on

[formula]

), we first study the angles modulo π and then divide by π. We thus consider the normalized angles xt  =  θt(p) / π and xt + Vp  =  1 - θt(p) / π for 1  ≤  t  ≤  Vp. Thus we study 2Vp normalized angles in

[formula]

given by

[formula]

and for n  ≤  Vp, [formula] is the number of solutions modulo p of the elliptic curve En:y2  =  x3  +  anx  +  bn. Equivalently, using the normalization xn  =  θn  /  π to obtain a distribution on

[formula]

). For the family of all elliptic curves, after some algebra we see this is equivalent to understanding [formula]; using a combinatorial identity (see [\cite=Mil4]) this is equivalent to a linear combination of sums of the form [formula]. These sums are essentially the 2r moments of the Fourier coefficients of the family of all elliptic curves modulo p. Birch [\cite=Bi] evaluated these, and showed the answers are the Catalan numbers plus lower order terms. Our equidistribution result then follows from a combinatorial identity of a sum of weighted Catalan numbers; our error term is poor due to the necessity of losing cancelation in bounding the contribution from the sums of the error terms.

The proof of Theorem [\ref=thm:oneparamellipticcurves] is easier, as now instead of inputting results on the moments we instead use a result of Michel [\cite=Mic] for the sum over the family of symk(θn) =  sin ((k + 1)θn)  /   sin θn. This is easily related to our quantity of interest, cos (2mθn), through identities of Chebyshev polynomials:

[formula]

The advantage of having a formula for the quantity we want and not a related quantity is that we avoid trivially estimating the errors in the combinatorial sums. These calculations increased the size of the error significantly, and this is why Theorem [\ref=thm:oneparamellipticcurves] is stronger than Theorem [\ref=thm:allellipticcurves], though the error term in Theorem [\ref=thm:allellipticcurves] is comparable to the error terms of the equivalent quantities in [\cite=MS] for the family of cuspidal newforms. Michel proves his result by using a cohomological interpretation, and this results in the error term being p- 1 / 2 smaller than the main term; it is this savings in the quantity we are directly interested in that leads to the superior error estimates.

The paper is organized as follows. After reviewing the needed results from Murty-Sinha [\cite=MS] in §[\ref=sec:preliminaries], we prove Theorem [\ref=thm:allellipticcurves] in §[\ref=sec:equidallcurves] and Theorem [\ref=thm:oneparamellipticcurves] in §[\ref=sec:effequidoneparam]. For completeness the needed combinatorial identities are proved in Appendix [\ref=sec:combidentities], and in Appendix [\ref=sec:momentsallcurves] we correct some errors in explicit formulas for moments in Birch's paper [\cite=Bi] (where he neglected to mention that his sums are normalized by dividing by p - 1).

Effective Equidistribution Preliminaries

We quickly review some needed results from Murty-Sinha [\cite=MS]; while our setting is similar to the problems they investigated, there are slight differences which require generalizations of some of their results. Assume μ  =  F( - x)dx with

[formula]

where e(z)  =   exp (2πiz). Theorem 8 from [\cite=MS] is

Let {xn} be a sequence of real numbers in

[formula]

Unfortunately, Theorem [\ref=thm:MSmain] is not directly applicable in our case. The reason is that there we have a limit as [formula] in the definition of the cm, where for us we fix a prime p and have [formula] for the family of all elliptic curves curves modulo p, or p  +  O(1) for a one-parameter family. Analyzing the proof of Theorem 8 from [\cite=MS], however, we see that the claim holds for any sequence cm (obviously if [formula] is not close to cm then the discrepancy is large). We thus obtain

Let {xn} be a sequence of real numbers in

[formula]

To simplify applying the results from [\cite=MS], we study the normalized angles xn. Under our normalization, the Sato-Tate measure becomes

[formula]

The Fourier coefficients of μst are readily calculated.

Let μst  =  F( - x)dx be the normalized Sato-Tate distribution on

[formula]

The proof is immediate from the expansion of F as a sum of exponentials, which follows from the identities cos (2θ)  =  1  -  2 sin 2(θ) and e(θ)  =   cos (2πθ)  +  i sin (2πθ).

Proof of Effective Equidistribution for All Curves

We use Birch's [\cite=Bi] results on the moments of the family of all elliptic curves modulo p (there are some typos in his explicit formulas; we correct these in Appendix [\ref=sec:momentsallcurves]); unfortunately, these are results for quantities such as [formula], and the quantity which naturally arises in our investigation is e(mxn) (with xn running over the normalized angles θa,b(p) / π), specifically

[formula]

By applying some combinatorial identities we are able to rewrite our sum in terms of the moments, which allows us to use Birch's results. The point of this section is not to obtain the best possible error term (which following [\cite=BS] [\cite=Sh1] [\cite=Sh2] could be obtained by replacing Birch's bounds with [\eqref=eq:resultfromKatz]) but rather to highlight how one may generalize and apply the framework from [\cite=MS].

We first set some notation. Let σk(Tp) denote the trace of the Hecke operator Tp acting on the space of cusp forms of dimension - 2k on the full modular group. We have σk + 1(Tp)  =  O(pk  +  c  +  ε), where from [\cite=Sel] we see we may take c  =  3 / 4 (there is no need to use the optimal c, as our final result, namely [\eqref=eq:Mgivenc], will yield the same order of magnitude result for c = 3 / 4 or c = 0). Let Mp(2R) denote the 2R moment of 2 cos (θn)  =  2 cos (πxn) (as we are concerned with the normalized values, we use slightly different notation than in [\cite=Bi]):

[formula]

Notation as above, we have

[formula]

we may take c  =  3 / 4 and thus there is a power saving.

The result follows from dividing the equation for [formula] on the bottom of page 59 of [\cite=Bi] by pR, as we are looking at the moments of the normalized Fourier coefficients of the elliptic curves, and then using the bound σk + 1(Tp)  =  O(pk + c + ε), with c  =  3 / 4 admissible by [\cite=Sel]. Recall [formula] is the cardinality of the family. We have

[formula]

since [formula].

A simple argument (see Remark [\ref=rek:matchinpairs]) shows that the normalized angles are symmetric about 1 / 2. This implies

[formula]

where the sine piece does not contribute as the angles are symmetric about 1 / 2, and we are denoting the [formula] non-normalized angles by θn.

Thus it suffices to show we have a power saving in

[formula]

By symmetry, it suffices to consider m  ≥  0.

Let c0  =  1, c±  1  =   - 1 / 2 and cm  =  0 otherwise. There is some c  <  1 such that

[formula]

by the work of Selberg [\cite=Sel] we may take c  =  3 / 4.

The case m = 0 is trivial. For m = 1 we use the trigonometric identity cos (2θn)  =  2 cos 2(θn)  -  1. As c±  1  =   - 1 / 2 we have

[formula]

Note the sum of [formula] is the second moment of the number of solutions modulo p. From [\cite=Bi] we have that this is p  +  O(1); the explicit formula given in [\cite=Bi] for the second moment is wrong; see Appendix [\ref=sec:momentsallcurves] for the correct statement. Substituting yields

[formula]

The proof is completed by showing that [formula] provided 2  ≤  m  ≤  M. In order to obtain the best possible results, it is important to understand the implied constants, as M will have to grow with [formula] (which is of size p2). While it is possible to analyze this sum for any m by brute force, we must have M growing with p, and thus we need an argument that works in general. As c±  1  ≠  0 but cm  =  0 for |m|  ≥  2, we expect (and we will see) that the argument below does break down when |m|  =  1.

There are many possible combinatorial identities we can use to express cos (2mθn) in terms of powers of cos (θn). We use the following (for a proof, see Definition 2 and equation (3.1) of [\cite=Mil4]):

[formula]

where c2r  =  (2r)! / 2, c0,0  =  0, c2m,0  =  ( - 1)m2 for m  ≥  1, and for 1  ≤  r  ≤  m set

[formula]

We now sum [\eqref=eq:sjmexpansiontwocos2mtheta] over n and divide by [formula], the cardinality of the family. In the argument below, at one point we replace 22r in an error term with [formula]; this allows us to pull the r Catalan number, [formula], out of the error term. Using Lemma [\ref=lem:birch] we find

[formula]

We first bound the error term. For our range of r, [formula]. The sum of [formula] over r is 2m, and we get to divide by at least m + r  ≥  m. Thus the error term is bounded by

[formula]

We now turn to the main term. It it just ( - 1)m2m times the sum in Lemma [\ref=keycombinatoriallemmaforsuns], which is shown in that lemma to equal 0 for any |m|  ≥  2.

We now prove the first of our two main theorems.

We must determine the optimal M to use in [\eqref=eq:definitiondiscdistanceUS]:

[formula]

as [formula] and [formula]. For all c  >  0 we find the minimum error by setting the two terms equal to each other, which yields

[formula]

which when equating yields

[formula]

which implies

[formula]

We thus see that we may find a constant C such that

[formula]

Proof of Effective Equidistribution for One-parameter families

Instead of studying the family of all elliptic curves, we can also investigate one-parameter families over [formula]. Thus, consider the family E:y2  =  x3  +  A(T)x  +  B(T), where A(T) and B(T) are in [formula]. We assume that j(T) is not constant for the family. Michel [\cite=Mic] proved a Sato-Tate law for such families. In particular, he proved

Consider a one-parameter family of elliptic curves over [formula] with non-constant j-invariant. Let cΔ denote the number of complex zeros of Δ(z)  =  0 (where Δ is the discriminant), ψp an additive character (and set δψp  =  0 if this character is trivial and 1 otherwise), and write at,p as [formula] with θt,p∈[0,π]. Let

[formula]

Then

[formula]

Additionally, we have

[formula]

for some C depending on the family. Finally, we may drop the additive character and drop the restriction that Δ(t)  ≠  0 at the cost of a bounded number of summands, each of which is at most (k + 1), which implies these relations still hold provided we multiply the bounds on the right hand side by some constant C'.

Theorem [\ref=thm:michel] is used by Michel to obtain good estimates for the average rank in these families, as well as (of course) proving Sato-Tate laws. Using our techniques above, we can convert Michel's bounds to a quantified equidistribution law.

We recall the notation for Theorem [\ref=thm:oneparamellipticcurves]. Consider a one-parameter family of elliptic curves over [formula] with non-constant j(T). Let there be Vp  =  p  +  O(1) reduced curves modulo p, and set [formula]. For each curve Et consider the angles θt,p and π  -  θt,p, with θt,p∈[0,1], and the normalized angles xn  =  θt,p  /  π and xn + Vp = 1 - θt,p  /  π (for 1  ≤  n  ≤  Vp).

We must show [formula] (where [formula]). As in the proof of Theorem [\ref=thm:allellipticcurves], it suffices to show

[formula]

with c0  =  1, c1  =   - 1 / 2 and all other cm  =  0. This is because we have enlarged our set of normalized angles to be symmetric about 1/2. Thus when we study e(mxn)  =   cos (2πmxn)  +  i sin (2πmxn), the sine sum vanishes. We are therefore left with the cosine sum, with the normalized angles xn and xn + Vp contributing equally. Thus we may replace the sum of the cosine piece over n with a sum over the angles θt,p, so long as we remember to multiply by 2 when computing the discrepancy later. While we should subtract cmVp and not cmp, as Vp  =  p + O(1) the error in doing this is dwarfed by the error of the piece we are studying.

The case of 2m = 0 is trivial. If 2m = 2, then we are studying [formula]. By Theorem [\ref=thm:michel], we thus find that

[formula]

For higher m, we use Chebyshev polynomials (see [\cite=Wi]). The Chebyshev polynomials of the first kind are given by [formula]; the Chebyshev polynomials of the second kind are [formula]. These polynomials are related by

[formula]

we use this with [formula]. Using Theorem [\ref=thm:michel] we see that for m  ≥  2,

[formula]

From [\eqref=eq:definitiondiscdistanceUS], the discrepancy satisfies

[formula]

Using our bounds, we have

[formula]

The two error terms are of the same order of magnitude when [formula], or M  =  p1 / 4. This leads to

[formula]

which should be compared to a discrepancy of order p; in other words, we have a power savings (much better than the logarithmic savings in the family of all elliptic curves).

Combinatorial Identities

We first state some needed properties of the binomial coefficients. For n,r non-negative integers we set [formula]. We generalize to real n and k a positive integer by setting

[formula]

which clearly agrees with our original definition for n a positive integer. Finally, we set [formula] and [formula] if k is a negative integer.

To prove our main result we need the following two lemmas; we follow the proofs in [\cite=Ward].

Let r,s be any two real numbers and k,m,n integers. Then

[formula]

It suffices to prove the claim when r,s are integers. The reason is that both sides are polynomials, and if the polynomials agree for an infinitude of integers then they must be identical. It suffices to consider the special case m = 0, in which case we are reduced to showing

[formula]

Consider the polynomial

[formula]

If we use the binomial theorem to expand the left hand side of [\eqref=eq:usefulpolyvandermondeconv], we get the coefficient of the xnyr + s - n is the left hand side of [\eqref=eq:ncrcombidentityvandermonde], while if we use the binomial theorem to find the coefficient of xnyr + s - n on the right hand side of [\eqref=eq:usefulpolyvandermondeconv] we get [\eqref=eq:ncrcombidentityvandermonde], which completes the proof.

Let [formula] be non-negative integers. Then

[formula]

Using [formula], we rewrite [formula] as [formula], and we then rewrite [formula] as [formula] by using the extension of the binomial coefficient, where we have pulled out all the negative signs in the numerators. The advantage of this simplification is that the summation index is now only in the denominator; further, the power of - 1 is now independent of k. Factoring out the sign, our quantity is equivalent to

[formula]

where we again use [formula]. By Vandermonde's Convolution, this equals ( - 1)s - n [formula]. Using [formula] and collecting powers of - 1 completes the proof (note [formula]).

Let m be an integer greater than or equal to 1. Then

[formula]

The case m = 1 follows by direct evaluation. Consider now m  ≥  2. We have

[formula]

We change variables and set u = r + 1; as r runs from 0 to m, u runs from 1 to m + 1. To have a complete sum, we want u to start at 0; thus we add in the u = 0 term, which is [formula]. As m  ≥  2, this is 0 from the extension of the binomial coefficient (this is the first of two places where we use m  ≥  2). Our sum Sm thus equals

[formula]

We now use Lemma [\ref=lem:neededlemcomb] with k = u, m = 0, [formula], s = m - 2 and n = m - 1; note the conditions of that lemma require s to be a non-negative integer, which translates to our m  ≥  2. We thus find

[formula]

which completes the proof.

We give another proof of Lemma [\ref=keycombinatoriallemmaforsuns] below using hypergeometric functions; we thank Frederick Strauch for showing us this approach.

Moments for the family of all curves

Birch [\cite=Bi] claims the following: Let

[formula]

Then for p  ≥  5,

[formula]

There are obviously typos here. We know the Legendre sum is at most [formula] in absolute value, thus we expect SR(p) to be on the order of [formula]; note the powers of p are too low (and they are too high for dividing SR(p) by the cardinality of the family).

Assuming SR(p) is a polynomial in p, from exploring the results for small p we are led to

[formula]

Note these are exactly the results from Birch multiplied by p - 1; we thank Andrew Granville for pointing this out to us. In other words, the formulas in Birch are what remains after dividing by the trivial multiplicative factor p - 1.

Let SR'(p) denote the same sum as SR(p), but with the additional restriction that 4a3  ≠  27b2. It is readily seen that SR'(p)  =  SR(p) + (p - 1); the reason is that if the discriminant equals zero, then x3 - ax - b = (x - c)2(x - d) for some c,d, and the sum of these Legendre symbols over all x modulo p is ±  1 (the sum is the same as [formula]). Explicitly, we find

[formula]

As the evaluation of these sums is central to this and other investigations, we provide two proofs of the formula for S1(p) in the hopes that these arguments will be of use to other researchers studying similar questions.

We first give the proof in [\cite=Mil1]. We have the following expansion of [formula]:

[formula]

where [formula] and [formula], which equals [formula] for [formula] and [formula] for [formula]. See, for example, [\cite=BEW].

For the curve y2  =  fE(x)  =  x3 - ax - b, [formula]. We use [\eqref=eq:formulafromBEW] to rewrite aE(p) as

[formula]

We take the complex conjugate, which on the RHS introduces a minus sign into the exponential and sends Gp to [formula], and has no effect on the LHS (which is real). The sum becomes

[formula]

The b-sum vanishes unless p|(c1  -  c2), which only happens if c1  =  c2  =  c. The a-sum vanishes unless p|(cx1  -  cx2). As [formula] (we have the factor [formula]) this forces x1  =  x2  =  x. As c is non-zero, [formula], the first exponential factor is 1, and the sums collapse to

[formula]