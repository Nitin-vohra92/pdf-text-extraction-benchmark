Definition Corollary Proposition Remark Claim Lemma

By Pavel Shvartsman

Department of Mathematics, Technion - Israel Institute of Technology,

32000 Haifa, Israel

e-mail: pshv@tx.technion.ac.il

Math Subject Classification 46E35 Key Words and Phrases  Calderón-Sobolev space, Hajłasz-Sobolev space, metric space, doubling condition, regular set, extension operator, sharp maximal function

Let (X,d,μ) be a metric space (X,d) equipped with a Borel measure μ, which is non-negative and outer regular, and is finite on every bounded subset. In this paper we describe the restrictions of first order Sobolev functions to measurable subsets of X which have a certain regularity property.

There are several known ways of defining Sobolev spaces on abstract metric spaces, where of course we cannot use the notion of derivatives. Of particular interest to us, among these definitions, is the one introduced by Hajłasz [\cite=H1]. But let us first consider a classical characterization of classical Sobolev spaces due to Calderón. Since it does not use derivatives, it can lead to yet another way of defining Sobolev spaces on metric spaces. In [\cite=C] (see also [\cite=CS]) Calderón characterizes the Sobolev spaces [formula] in terms of Lp-properties of sharp maximal functions. To generalize this characterization to the setting of a metric measure space (X,d,μ), let f be a locally integrable real valued function on X and let α be a positive number. Then the fractional sharp maximal function of f, is defined by

[formula]

Here B(x,r): = {y∈X:d(y,x) < r} denotes the open ball centered at x with radius r, and, for every Borel set A  ⊂  X with μ(A) <   ∞  , fA denotes the average value of f over A

[formula]

If [formula], we put fA: = 0.

In [\cite=C] Calderón proved that, for 1 < p  ≤    ∞  , the function u is in [formula], if and only if u and [formula] are both in [formula]. This result motivates us to introduce the space CW1,p(X,d,μ), which we will call the Calderón-Sobolev space. We define it to consist of all functions u defined on X such that [formula]. We equip this space with the Banach norm

[formula]

Let us now recall the details of the definition of Hajł asz mentioned above. Hajł asz [\cite=H1] introduced the Sobolev-type space on a metric space, M1,p(X,d,μ) for 1 < p  ≤    ∞  . It consists of all functions u∈Lp(X) for which there exists a function g∈Lp(X) (depending on u) such that the inequality

[formula]

holds μ-a.e. (This means that there is a set E  ⊂  X with μ(E) = 0 such that ([\ref=Pin]) holds for every [formula]). As in [\cite=HKin] we will refer to all functions g which satisfy the inequality ([\ref=Pin]) as generalized gradients of u.

M1,p(X,d,μ) is normed by

[formula]

where the infimum is taken over the family of all generalized gradients of u.

In the case where [formula] is an open bounded domain with a Lipschitz boundary, d is the Euclidean distance and μ is the n-dimensional Lebesgue measure on Ω, Hajł asz [\cite=H1] showed that the space M1,p(Ω,d,μ) coincides with the Sobolev space W1,p(Ω) and, moreover, that every function [formula] satisfies ([\ref=Pin]) with [formula]. Here M is the Hardy-Littlewood maximal operator and c = c(n). (For further development and application of this approach to Sobolev spaces on metric space see, e.g. [\cite=FHK] [\cite=FLW] [\cite=GT] [\cite=H1] [\cite=HKin] [\cite=HKos] [\cite=HM] [\cite=He] [\cite=KL] and references therein.)

It turns out that for a doubling measure μ, the Hajłasz-Sobolev space coincides with the Calderón-Sobolev space, i.e.,

[formula]

and, moreover, for every u∈M1,p(X,d,μ), the function [formula] (with some constant c = c(X)) is a generalized gradient of u. This is an immediate consequence of a result of Hajł asz and Kinnunen. (See [\cite=HKin], Theorem 3.4.)

We recall that a measure μ satisfies the doubling condition if there exists a constant Cd  ≥  1 such that, for every x∈X and r > 0,

[formula]

As usual, see [\cite=CW], we will call a metric measure space (X,d,μ) with a doubling measure μ a metric space of homogeneous type and Cd a doubling constant.

In this paper we will only consider such metric measure spaces, which also satisfy an additional condition, namely that there exists a constant Crd > 1 such that, for every x∈X and r > 0,

[formula]

We call this condition the reverse doubling condition and Crd a reverse doubling constant.

We will characterize the restrictions of Calderón-Sobolev and Hajłasz-Sobolev functions to regular subsets of a homogeneous metric space (X,d,μ).

A measurable set S  ⊂  X is said to be regular if there are constants θS  ≥  1 and δS > 0 such that for every x∈S and 0 < r  ≤  δS

[formula]

A Cantor-like set or a Sierpiski's type gasket (or carpet) of positive Lebesgue measure provide examples of non-trivial regular subsets of [formula]. (Regular subsets of [formula] are often called Ahlfors n-regular or n-sets [\cite=JW]). For properties of metric spaces supporting doubling measures and sets satisfying regularity conditions we refer to [\cite=BG] [\cite=J] [\cite=JW] [\cite=VK] and references therein.

Let us formulate the main result of the paper. Given a Borel set A  ⊂  X, a function f∈L1,loc(A) and α > 0 we let [formula] denote the fractional sharp maximal function of f on A,

[formula]

Thus, [formula] .

As usual for a Banach space [formula] of measurable functions defined on X and a Borel set S  ⊂  X we let A|S denote the restriction of A to S, i.e., a Banach space

[formula]

equipped with the standard quotient space norm

[formula]

Let (X,d,μ) be a metric space of homogeneous type satisfying the reverse doubling condition ([\ref=mreg]) and let S be a regular subset of X. Then a function u∈Lp(S), ~ 1 < p  ≤    ∞  , can be extended to a function ũ∈CW1,p(X,d,μ) if and only if [formula]. In addition,

[formula]

with constants of equivalence depending only on Cd,Crd,θS,δS and p. Moreover, there exist a linear continuous extension operator

[formula]

Its operator norm is bounded by a constant depending only on Cd,Crd,θS,δS and p.

Let us apply this result to [formula] with the Lebesgue measure (clearly, in this case ([\ref=mreg]) is satisfied with Crd = 2n). Then for every regular subset [formula] we have:

(i).   [formula];

(ii). There is a linear continuous extension operator from [formula] into [formula].

Observe that (ii) follows from a general result of Rychkov [\cite=R].

There is an extensive literature devoted to description of the restrictions of Sobolev functions to different classes of subsets of [formula]. We refer the reader to the books of Maz'ya [\cite=M], Maz'ya and Poborchi [\cite=MP], the article of Farkas and Jakob [\cite=FJ] and references therein for numerous results and technique in this direction. We also observe that the criterion (i) can be useful for description of Sobolev extension domains, i.e., domains [formula] such that [formula]. For instance, due to a result of Koskela [\cite=Kos], every Sobolev extension domain is a regular subset of [formula] whenever n - 1 < p <   ∞  .

The second main result of the paper is the following

Let (X,d,μ) be a homogeneous metric space satisfying condition ([\ref=mreg]). Then for every regular subset S of X

[formula]

Moreover, there exist a linear continuous extension operator

[formula]

such that [formula].

For a family of bounded domains in [formula] satisfying a certain plumpness condition (so-called A(c)-condition) Theorem [\ref=EXT2] was proved by Hajł asz and Martio [\cite=HM]. Harjulehto [\cite=Har] has generalized this result for the case of homogeneous metric spaces (X,d,μ) and domains Ω satisfying so-called A*(ε,δ)-condition. Observe that both A(c)- and A*(ε,δ)-sets are regular but a Cantor-type set of positive Lebesgue measure in [formula] provides an example of a regular subset which satisfies neither A(c)- nor A*(ε,δ)-condition.

Proofs of Theorems [\ref=EXT1] and [\ref=EXT2] are based on a modification of the Whitney extension method suggested in author's work [\cite=S], see also [\cite=S2], for the case of regular subsets of [formula].

A crucial step of this approach is presented in Section 2. Without loss of generality we may assume that S is closed (see Lemma [\ref=DENS]) so that [formula] is open. Since μ is doubling, [formula] admits a Whitney covering which we denote by WS.

We assign every ball B = B(xB,rB)∈WS a measurable subset HB  ⊂  S such that [formula], μ(B)  ≤  γ2μ(HB) whenever rB  ≤  δS, and the family

[formula]

has a finite covering multiplicity , i.e., every point x∈S belongs at most γ3 sets of the family HS. Here γ1,γ2,γ3 are positive constants depending only on Cd,Crd and θS. We call every set HB∈HS a "reflected quasi-ball" associated to the Whitney ball B. The existence of the family HS of reflected quasi-balls is proved in Theorem [\ref=HB].

The second step of the extension method and the proof of Theorem [\ref=EXT2] are presented in Section 3. We fix functions u∈M1,p(S,d,μ) and g∈Lp(S) satisfying on S inequality ([\ref=Pin]). Then we define an extension ũ of u by the formula

[formula]

Here {φB:B∈WS} is a partition of unity associated to the Whitney covering.

Finally, we define an extension [formula] of g by letting

[formula]

where [formula]. We show that ũ∈Lp(X), ∈Lp(X) and [formula] is a generalized gradient of ũ, i.e., the pair (ũ,) satisfies on X inequality ([\ref=Pin]). Since ũ|S = u, this proves that u∈M1,p(X,d,μ)|S so that [formula] provides a linear extension operator from M1,p(S,d,μ) into M1,p(X,d,μ).

Section 4 is devoted to estimates of the sharp maximal function of the extension [formula]. Given a function f defined on S we let [formula] denote its extension on all of X by zero. We show that for every α > 0 and x∈X

[formula]

see Theorem [\ref=pr]. Using this estimate and the Hardy-Littlewood maximal theorem we prove a slightly more general version of Theorem [\ref=EXT1] related to the space Cαp(X,d,μ). This space consists of all functions u defined on X such that [formula]. Cαp(X,d,μ) is normed by

[formula]

For the case [formula] with the Lebesgue measure this space was introduced and investigated by Devore and Sharpley [\cite=DS] and Christ [\cite=Ch]. Clearly, CW1,p(X,d,μ) = C1p(X,d,μ).

Let (X,d,μ) be a metric space of homogeneous type satisfying condition ([\ref=mreg]) and let S be a regular subset of X. A function u∈Lp(S), ~ 1 < p  ≤    ∞  , belongs to the trace space Cαp(X,d,μ)|S if and only if [formula]. In addition,

[formula]

and there exists a linear continuous extension operator

[formula]

whose operator norm is bounded by a constant depending only on Cd,Crd,θS,δS and p.

Observe that for [formula] and S to be a Lipschitz or an (ε,δ)-domain this result follows from extension theorems proved by Devore and Sharpley [\cite=DS], pp. 99-101, (Lipschitz domains), and Christ [\cite=Ch] ((ε,δ)-domains).

I am very grateful to M. Cwikel for helpful discussions and valuable advice.

We will use the following notation. Throughout the paper C,C1,C2,... will be generic positive constants which depend only on Cd,Crd,θS,δS and p. These constants can change even in a single string of estimates. We write A  ≈  B if there is a constant C such that A / C  ≤  B  ≤  CA. For a ball B = B(x,r) we let xB and rB denote center and radius of B. Given a constant λ  >  0 we let λB denote the ball B(x,λr). For A,B  ⊂  X and x∈X we put

[formula]

and [formula]. Finally, by [formula] we denote the closure of A in X.

For every regular subset S  ⊂  X

[formula]

Proof. Denote [formula] and fix y∈Y. Then for every r, ~ 0 < r  ≤  δ, there is a point ∈S such that [formula]. Clearly, B(,r / 4)  ⊂  B(y,r). Since S is regular and ∈S, we obtain

[formula]

On the other hand, B(y,r)  ⊂  B(,5r / 4) so that by the doubling condition

[formula]

Hence [formula]. We let DA denote the family of density points of the set [formula]. Then

[formula]

which implies [formula]. Thus [formula] so that by Lebesgue's theorem, see, e.g. [\cite=F], § 2.9, [formula].[formula]

In the remaining part of the paper we will assume that S is a closed regular subset of X.

Since μ is a doubling measure, there exists a constant M = M(Cd) such that in every ball B(x,r) there are at most M points xj satisfying the inequality [formula] (one can put M: = C4d). For every metric space with this property the following is true (see, e.g. [\cite=G], Theorem 2.3): For every open subset G  ⊂  X with a non-empty boundary there is a countable family of balls WG such that [formula], every point of G is covered by at most 9M sets from WG and [formula] for every B = B(x,r)∈WG.

Applying this result to the open set [formula] we obtain the following

There is a countable family of balls WS such that

(i). [formula];

(ii). For every ball B = B(x,r)∈WS

[formula]

(iii). Every point of [formula] is covered by at most N = N(Cd) balls from WS.

Using standard argument one can readily prove the following additional properties of Whitney's balls.

(1). For every B = B(xB,rB)∈WS there is a point yB∈S such that

[formula]

Moreover, μ(B(xB,rB))  ≈  μ(B(yB,rB)).

(2). If B,K∈WS and [formula], then

[formula]

(Recall that [formula].)

(3). For every ball K∈WS there are at most N balls from the family W*S: = {B*:B∈WS} which intersect K*.

(4). For every B∈WS and every x∈B*

[formula]

Here C and N are positive constants which depend only on Cd.

The next lemma easily follows from inequalities ([\ref=double]) and ([\ref=mreg]).

For every x∈X,r > 0,1  ≤  t <   ∞  ,

[formula]

and

[formula]

where α: =  log 2Crd and β: =  log 2Cd.

Let us formulate the main result of the section.

There is a family of Borel sets HS  =  {HB: ~ B∈WS} such that:

(i). [formula];

(ii). μ(B)  ≤  γ2μ(HB) whenever B∈WS and rB  ≤  δS;

(iii). [formula].

Here γ1,γ2,γ3 are positive constants depending only on Crd,Cd and θS.

Proof. Let K = B(xK,rK)∈WS and let yK be a point on S satisfying condition (1) of Lemma [\ref=Wadd]. Thus B(yK,rK)  ⊂  CK and K  ⊂  B(yK,CrK).

Given ε,0 < ε  ≤  1, we denote Kε: = B(yK,εrK). Let B = B(xB,rB) be a ball from WS with rB  ≤  δS. Set

[formula]

Recall that Bε: = B(yB,εrB). We define a "quasi-ball" HB by letting

[formula]

If rB  >  δS we put [formula].

Prove that for some ε: = ε(Crd,Cd,θ) small enough the family of subsets HS: = {HB: ~ B∈WS} satisfies conditions (i)-(iii). By ([\ref=dAB]) and ([\ref=inBY])

[formula]

In addition, by ([\ref=dAB]) HB  ⊂  S so that [formula] proving property (i).

Let us prove (ii). Suppose that B = B(xB,rB)∈WS and rB  ≤  δS. If K∈AB, then by ([\ref=2.13']) [formula] and rK  ≤  εrB. Hence

[formula]

so that [formula]. But [formula] and K  ⊂  B(yK,CrK) which implies [formula]. Thus

[formula]

By property (iii) of Theorem [\ref=Wcov]

[formula]

so that by ([\ref=2.**]) and ([\ref=muCd])

[formula]

On the other hand, for every K∈AB by ([\ref=muCr]) and by (1), Lemma [\ref=Wadd]

[formula]

Hence

[formula]

Since S is regular and [formula], [formula] so that

[formula]

By ([\ref=muCd]) and by property (1) of Lemma [\ref=Wadd]

[formula]

so that

[formula]

We define ε by setting [formula]. Then the inequality μ(B)  ≤  γ2μ(HB) holds with [formula] proving property (ii) of the theorem.

Let us prove (iii). Let B = B(xB,rB),B' = B(xB',rB')∈WS be Whitney's balls such that rB,rB'  ≤  δS and [formula]. Since [formula], we have [formula].

On the other hand, B∉AB' and B'∉AB, otherwise by ([\ref=2.13']) and ([\ref=dAB]) [formula]. Since [formula], by definition ([\ref=2.13']) rB  >  εrB' and rB'  >  εrB so that rB  ≈  rB'. By ([\ref=inBY])

[formula]

and similarly [formula]. But [formula] so that [formula] as well. Moreover, since rB  ≈  rB', we have B'  ⊂  C5B and B  ⊂  C5B'. This and the doubling condition imply μ(B')  ≈  μ(B).

We denote

[formula]

and [formula]. Thus we have proved that VB  ⊂  C5B and μ(B')  ≈  μ(B) for every B'∈TB.

Let [formula] be the cardinality of TB. Clearly, to prove (iii) it suffices to show that MB  ≤  γ3. We have

[formula]

By the property (iii) of Theorem [\ref=Wcov]

[formula]

so that

[formula]

proving the required inequality MB  ≤  γ3.[formula]

For every u∈M1,p(X,d,μ) and every generalized gradient g of u the restriction g|S is a generalized gradient of u|S so that M1,p(X,d,μ)|S  ⊂  M1,p(S,d,μ).

Let us prove that formula ([\ref=OE]) provides a linear continuous extension operator from M1,p(S,d,μ) into M1,p(X,d,μ). Obviously, this will imply the converse imbedding as well.

Recall that for every [formula] its generalized gradient g belongs to Lp(S) and satisfies the inequality

[formula]

where E is a subset of S of measure 0. We may suppose that g is almost optimal, i.e., [formula].

The extension operator [formula], see ([\ref=OE]), is determined by the family of Borel subsets HS  =  {HB: ~ B∈WS} introduced in the previous section. We recall that μ(HB) > 0 for every ball B∈WS with rB  ≤  δS and [formula] whenever rB  >  δS. Therefore according to our notation uHB is the average of u over HB whenever rB  ≤  δS and uHB: = 0 otherwise.

We let ΦS  =  {φB: ~ B∈WS} denote a partition of unity associated to the Whitney covering WS, see, e.g. [\cite=MS]. We recall that ΦS is a family of functions defined on X which have the following properties: For every ball B∈WS

(a). 0  ≤  φB  ≤  1; (b). [formula]; (c). [formula] on [formula]; (d). for some constant C = C(Cd)

[formula]

Recall that the extension operator [formula] is defined by the formula

[formula]

and ũ(x): = u(x), x∈S. We also define an extension [formula] of g by letting

[formula]

and (x): = g(x) for x∈S.

To prove that [formula] satisfies conditions of Theorem [\ref=EXT2] it suffices to show that

[formula]

and the inequality

[formula]

holds μ-a.e. on X. Then

[formula]

proving that [formula] and [formula].

Proofs of inequalities ([\ref=IN1]) and ([\ref=IN2]) are based on a series of auxiliary lemmas.

Let H,H'  ⊂  S and let 0 < μ(H),μ(H') <   ∞  . Then

[formula]

and for every y∈S

[formula]

Proof. We have

[formula]

so that by ([\ref=lipug])

[formula]

Since [formula] for every x∈H,y∈H', we have

[formula]

proving ([\ref=forall]). In a similar way we prove inequality ([\ref=fory]).[formula]

Let [formula] and let [formula]. Then for every [formula] and every ball B∈WS such that [formula] we have

[formula]

If y∈S, then for every B∈WS such that B*∋x

[formula]

Proof. First we prove ([\ref=difub]). Suppose that [formula] and consider the case [formula]. Since [formula], by ([\ref=forall])

[formula]

By ([\ref=drx]) rB  ≈  d(x,S) whenever x∈B* and by property (i) of Theorem [\ref=HB], HB  ⊂  γ1B so that HB  ⊂  B(x,Cd(x,S)). Since [formula], we also have [formula]. In a similar way we prove that HB  ⊂  B(y,C2d(y,S)) whenever y∈B*. Hence

[formula]

so that

[formula]

Since [formula] and x∈B* or y∈B*, by definition of [formula], see ([\ref=defG]), we have [formula], gHB  ≤  (x) (whenever x∈B*) or gHB  ≤  (y) (if y∈B*). Hence

[formula]

Combining this inequality with ([\ref=uB1]) and ([\ref=Dxy]) we obtain ([\ref=difub]) for the case [formula].

Let us prove ([\ref=difub]) for the case [formula]. By ([\ref=drx]) δS  ≤  rB  ≤  Cd(y,S) whenever y∈B* or δS  ≤  rB  ≤  Cd(x,S), if x∈B*. Hence

[formula]

Since [formula], by ([\ref=defG]) [formula], and since rB  >  δS, uHB: = 0. Hence

[formula]

proving ([\ref=difub]). In the same way we prove ([\ref=difub]) for the case [formula]. The remaining case [formula] is trivial because here [formula].

We prove ([\ref=difuy]) by a slight modification of the proof given above. Using estimate ([\ref=fory]) rather than ([\ref=forall]) we have

[formula]

But d(x,S)  ≤  d(x,y), and ([\ref=difuy]) follows.[formula]

Let [formula] and let [formula]. Then for every [formula] we have

[formula]

where [formula].

If y∈S, then

[formula]

Proof. By definition ([\ref=Extu]) and properties of the partition of unity we have

[formula]

so that by property (3) of Lemma [\ref=Wadd] for every [formula]

[formula]

Since 0  ≤  φB  ≤  1, this implies

[formula]

On the other hand, by property (d) of partition of unity we have

[formula]

Clearly, these inequalities imply ([\ref=i1]). Similarly to ([\ref=inq]), for y∈S we have

[formula]

proving ([\ref=Iny]).[formula]

We are in a position to prove C for some C is a generalized gradient of ũ.

The inequality

[formula]

holds μ-a.e. on X.

Proof. We will suppose that [formula] where E is a subset of S from inequality ([\ref=lipug]) (recall that μ(E) = 0). Clearly, for x,y∈S the result follows from ([\ref=lipug]) so we may assume that [formula]. We let [formula] denote a Whitney ball such that [formula].

Denote I: = |ũ(x)  -  ũ(y)| and consider two cases.

Since [formula], we have [formula] Moreover, by ([\ref=drx]) [formula] and by inequality ([\ref=i1])

[formula]

Since [formula], for every ball B∈WS such that [formula] we have [formula]. Therefore by ([\ref=eqvball]) [formula] In addition, by Lemma [\ref=uBB]

[formula]

so that

[formula]

Hence

[formula]

Since [formula], this implies [formula]. Recall that [formula] so that d(x,S)  ≤  Cd(x,y). Since the distance function d(  ·  ,S) satisfies the Lipschitz condition, we have

[formula]

Let y∉S. Then by ([\ref=i1])

[formula]

so that by ([\ref=difub])

[formula]

In the remaining case, i.e., for y∈S, the lemma follows from estimates ([\ref=difuy]) and ([\ref=Iny]).[formula]

Let f∈Lp(S),1  ≤  p  ≤    ∞  . We define an extension F of f by letting F(x): = f(x), ~ x∈S, and

[formula]

[formula]

Proof. We will prove the lemma for the case 1  ≤  p <   ∞  ; corresponding changes for p =   ∞   are obvious. By property (3) of Lemma [\ref=Wadd] for every [formula] at most N = N(Cd) terms of the sum in ([\ref=sum]) are not equal zero. Therefore

[formula]

This inequality and the doubling condition imply

[formula]

Recall that μ(HB)  ≈  μ(B) whenever rB  ≤  δ, see (i), (ii), Theorem [\ref=HB], so that

[formula]

Recall also that [formula] if rB  >  δ. Hence

[formula]

so that by property (iii) of Theorem [\ref=HB]

[formula]

It remains to note that F|S = f and the lemma follows.[formula]

Let us prove that

[formula]

Since 0  ≤  φB  ≤  1 for every B∈WS, and [formula] by ([\ref=Extu]) for every [formula] we have

[formula]

Hence |ũ|  ≤  |F| where F(x): = u(x) for x∈S and

[formula]

Thus [formula]. But by Lemma [\ref=LPH] [formula], and ([\ref=LPN]) follows.

It remains to estimate Lp-norm of [formula]. To this end we define a function G by letting G(x): = g(x), ~ x∈S and

[formula]

Then by ([\ref=defG]) ||  ≤  |G| + |F|. By Lemma [\ref=LPH] [formula] so that

[formula]

Theorem [\ref=EXT2] is completely proved.

Let us fix a ball K = B(z,r) such that [formula]. We denote two families of balls associated to K by letting [formula] and

[formula]

(i). For every [formula]

[formula]

(ii). For every ball B∈BK we have rB  ≤  η1r.

(iii). For every [formula]

[formula]

Here η1,η2 are constants depending only on the doubling constant Cd.

Proof. Let us prove property (i). Recall that [formula] for every [formula]. Then by definition ([\ref=Extu])

[formula]

Hence, by properties (a),(b) of the partition of unity and by the doubling condition

[formula]

Prove (ii). Let B∈BK and let [formula]. Then by ([\ref=drx]) [formula] so that y∉S. Therefore there is a ball B'∈WS which contains y. Since [formula] and [formula], we have [formula]. But by Theorem [\ref=Wcov] [formula] so that rB'  ≤  2r. In addition, [formula] so that by ([\ref=eqvball]) rB'  ≈  rB. This implies the required inequality rB  ≤  η1r with some constant η1  =  η1(Cd).

Prove (iii). We denote [formula] and

[formula]

Since |uHB - c|  ≤  |u - c|HB and μ(HB)  ≈  μ(B), see (ii), Theorem [\ref=HB],

[formula]

By property (i) of Theorem [\ref=HB] for every [formula] we have [formula]. Since [formula] and rB  ≤  η1r, we obtain

[formula]

so that [formula]. Thus [formula].

It remains to note that by property (iii) of Theorem [\ref=HB] mK  ≤  γ3 and the required property (iii) follows.[formula]

For every ball K = B(z,r) such that z∈S and r  ≤  δS  /  η1 we have

[formula]

Proof. We denote [formula] where η2 is the constant from inequality (iii) of Lemma [\ref=e0]. Let us prove that

[formula]

Since r  ≤  δS  /  η1, by (ii) of Lemma [\ref=e0] we have rB  ≤  δS for every ball B∈BK. Thus [formula] so that {HB: ~ B∈BK} is a subfamily of the family HS satisfying properties (i)-(iii) of Theorem [\ref=HB].

Applying property (i) of Lemma [\ref=e0] with c: = uD we obtain

[formula]

so that by (iii) of Lemma [\ref=e0]

[formula]

This implies

[formula]

so that

[formula]

proving ([\ref=ei]). Since μ(K)  ≈  μ(η2K), we finally obtain

[formula]

Recall that given a function u defined on S we let [formula] denote its extension by 0 to all of X. As usual given f∈L1,loc(X) we let Mf denote the Hardy-Littlewood maximal operator:

[formula]

Let K = B(z,r) be a ball such that z∈S and r > δS  /  η1. Then

[formula]

Proof. Applying property (i) of Lemma [\ref=e0] with c: = 0 we obtain

[formula]

Since uHB: = 0 whenever rB  >  δS, we have

[formula]

Applying (iii) of Lemma [\ref=e0] with c: = 0 we obtain

[formula]

Since r > δS  /  η1, this implies

[formula]

so that

[formula]

Since μ(K)  ≈  μ(η2K), we have

[formula]

Lemma [\ref=e1] and Lemma [\ref=e2] imply the following

For every z∈S

[formula]

Let us estimate the value of [formula] for [formula]. We will put [formula] whenever [formula] (recall that [formula] iff rQ  >  δS).

Let Q = B(xQ,rQ)∈WS and let z∈Q. Then for every ball K: = B(z,r) with [formula] we have

[formula]

Proof. We have to prove that for arbitrary s∈HQ

[formula]

Since [formula], the ball [formula]. By Lemma [\ref=fl] for every x,y∈K(  ⊂  Q*)

[formula]

Since x,y∈Q*, for every ball B∈WS such that [formula] we have [formula]. Therefore by ([\ref=eqvball])

[formula]

We denote [formula]. Then

[formula]

Hence

[formula]

Since [formula] and [formula], this implies

[formula]

Let us consider two cases.

rQ  ≤  δS / C1 where C1 is the constant from inequality ([\ref=BapQ]). Then for each B∈A we have rB  ≤  δS so that HB,HQ satisfy properties (i),(ii) of Theorem [\ref=HB]. Thus [formula],  [formula],  μ(HB)  ≈  μ(B), and μ(HQ)  ≈  μ(Q).

Since [formula] and rB  ≈  rQ, for some positive C2 = C2(γ1) we have

[formula]

(Recall that s is an arbitrary point of HQ.) These inequalities and the doubling condition imply μ(HB)  ≈  μ(HQ)  ≈  μ(D). Hence

[formula]

A similar estimate is true for HQ so that

[formula]

Applying this inequality to ([\ref=uKB]) we obtain

[formula]

where rD: = C2rQ is the radius of the ball D: = B(s,C2rQ). Hence by definition ([\ref=smfS]) we have [formula] proving ([\ref=sum1]).

rQ  >  δS / C1. By ([\ref=uKB]) I  ≤  C max {|uHB|: ~ B∈A}. Recall that uHB: = 0 if rB  >  δS so that

[formula]

By Theorem [\ref=HB] for every B∈A such that rB  ≤  δS we have [formula],  μ(HB)  ≈  μ(B). Since rB  ≈  rQ and z∈Q, for some positive C3 = C3(γ1) we have HB  ⊂  B(z,C3rQ). Put [formula]. Since [formula] and μ(B)  ≈  μ(Q), we have [formula]. Hence

[formula]

proving that [formula].[formula]

Inequality ([\ref=fin]) is true for every [formula].

Proof. We denote η3: = 8(γ1 + 10), : = η3r and [formula]. Recall that γ1 is the constant from Theorem [\ref=HB]. Prove that [formula]. In fact, let aQ∈Q and bQ∈S be points satisfying the inequality d(aQ,bQ)  ≤  2d(Q,S). Then by (ii), Theorem [\ref=Wcov], d(aQ,bQ)  ≤  2d(Q,S)  ≤  8rQ. But z∈Q so that

[formula]

Thus [formula] proving that [formula].

Let us consider two cases.

: = η3r > δS  /  η1. Since [formula] is the radius of the ball [formula],   >  δS  /  η1 and [formula], by Lemma [\ref=e2]

[formula]

By the doubling condition [formula] so that

[formula]

proving ([\ref=fin]).

: = η3r  ≤  δS  /  η1. Since 8r > rQ, we have

[formula]

Therefore by Theorem [\ref=HB] [formula], μ(HQ)  ≈  μ(Q) and [formula].

Take s∈HQ and put V: = B(s,η3r). Since HQ  ⊂  γ1Q, d(s,xQ)  ≤  γ1rQ so that for every a∈K = B(z,r)

[formula]

proving that K  ⊂  V. On the other hand, V  ⊂  2η3K so that by the doubling condition μ(V)  ≈  μ(K). Hence

[formula]

But rV: = η3r  ≤  δS  /  η1 so that by Lemma [\ref=e1] [formula]. This finishes the proof of ([\ref=fin]) and the lemma.[formula]

For every z∈X

[formula]

Proof. For z∈S this follows from Proposition [\ref=pr1].

Let Q∈WS and let z∈Q. Then by Lemmas [\ref=est1] and [\ref=est2]

[formula]

Recall that in this formula we put the infimum to be equal 0 whenever [formula], i.e., rQ  >  δS. Therefore in the remaining part of the proof we may assume that rQ  ≤  δS. Then by Theorem [\ref=HB] μ(HQ)  ≈  μ(Q) and [formula].

Let us denote B: = B(z,(γ1 + 1)rQ) and [formula]. Since z∈Q, we have HQ  ⊂  γ1Q  ⊂  B. In addition, by the doubling condition μ(HQ)  ≈  μ(B). Hence

[formula]

This inequality and ([\ref=A1]) imply the proposition.[formula]

Similar estimates and definition of ũ, see ([\ref=Extu]), easily imply that [formula] for every x∈X.

It can be easily shown that for any extension U of a function u∈Lp(S) to all of X we have [formula]. This immediately implies the inequality

[formula]

Now let [formula]. Prove that [formula]. By Theorem [\ref=pr]

[formula]

Recall that the operator M is bounded in Lp(X) whenever 1 < p  ≤    ∞   and (X,d,μ) is a metric space of a homogeneous type, see, e.g. [\cite=He], p. 10. Hence

[formula]

Since [formula], see ([\ref=LPN]), we finally obtain

[formula]

proving that ũ∈Cαp(X,d,μ) and equivalence ([\ref=Eq]) holds.

The proof of Theorem [\ref=EXT3] is complete.[formula]