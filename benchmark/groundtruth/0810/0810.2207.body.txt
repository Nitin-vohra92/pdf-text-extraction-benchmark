Corollary Lemma Proposition Definition Example Remark Algorithm

On the combinatorial classification of toric log del Pezzo surfaces

Introduction

Motivated by the algebro-geometric question of classifying toric log del Pezzo surfaces we investigate, from a purely combinatorial viewpoint, lattice polygons containing the origin in their interior.

A normal complex surface X is called a log del Pezzo surface if it has at worst log terminal singularities and if its anticanonical divisor - KX is a [formula]-Cartier ample divisor. The smallest positive multiple [formula] for which [formula] is Cartier is called the index of X. Such surfaces have been studied extensively: for example by Nukulin [\cite=Nik89a] [\cite=Nik88] [\cite=Nik89], Alexeev and Nukulin [\cite=AN06], and Nakayama [\cite=Nak07]. There has also been considerable emphasis on classification results in the rank one case (i.e. when the Picard number is one): see [\cite=Ye02] [\cite=Koj03].

If, in addition to being a log del Pezzo surface, X is also toric (i.e. X contains an algebraic torus as a dense open subset, together with an action of the torus on X which extends the natural action of the torus on itself) then we call X a toric log del Pezzo surface. There exists a bijective correspondence between toric log del Pezzo surfaces and certain convex lattice polygons: the LDP-polygons.

Fix a lattice [formula] and let [formula] be a lattice polygon; i.e. Q is the convex hull of finitely many lattice points, and has non-empty interior. We denote the vertices of Q by [formula] and the facets (also called edges) by [formula]. By the volume [formula] we mean the normalised volume, which equals twice the Euclidean volume. By ∂Q we mean the boundary of Q.

Q is called an IP-polygon if it contains the origin in its (strict) interior; we write [formula].

An IP-polygon Q is called an LDP-polygon if the vertices of Q are primitive lattice points, i.e. if no lattice point lies strictly between the origin and a vertex.

Let Q be an LDP-polygon and let XQ be the toric surface whose fan is generated by the faces of Q. Then XQ is a log del Pezzo surface. Furthermore any toric log del Pezzo surface can be derived in this fashion. Two toric log del Pezzo surfaces are isomorphic if and only if the corresponding polygons are unimoduar equivalent. The toric log del Pezzo surface has rank one if and only if the polygon is a triangle. For further details on toric varieties consult [\cite=Oda78] [\cite=Ful93]. For more information about LDP-polygons see [\cite=Dais06], [\cite=Dais07] and [\cite=DN08].

Let [formula] be the pairing between the lattice N and its dual [formula]. Let [formula] be a facet of Q. The unique primitive lattice point in the dual lattice defining an outer normal of F is denoted by ηF. The integer [formula] equals the integral distance between [formula] and F, and is called the local index of F (with respect to Q).

We now define three important invariants of Q:

The order is given by [formula];

The maximal local index is given by [formula];

The index is given by [formula].

Amongst these invariants is the following hierarchy:

[formula]

Figure [\ref=fig:strict_inequalities] gives an example of an LDP-polygon Q for which the inequalities are strict.

Whilst the second inequality is trivial, let us explain the first. Let k = oQ. Then there exists a lattice point [formula] in the interior of Q / (k - 1). This lattice point is contained in the cone [formula] over some facet F of Q. Therefore, [formula]. This implies that k - 1 < lF, and thus [formula].

It follows from a more general result of Lagarias and Ziegler [\cite=LZ91] that, up to unimodular equivalence, there are only finitely many IP-polygons Q of order oQ  ≤  k, for any positive integer k. Note that we do not yet know a sharp bound on the maximal volume in terms of the order (cf. [\cite=Pik01]), although there exist candidates (see Example [\ref=eg:triangles]).

In Section [\ref=sec:volume_bound] we provide asymptotically sharp upper bounds in terms of the maximal local index. It is unknown whether these bounds are also asymptotically optimal for LDP-polygons. Theorem [\ref=thm:bound_boundary] and Corollary [\ref=cor:bound_volume] are summarised in the following statement:

Let Q be an IP-polygon of maximal local index mQ  =  k  ≥  2. Then:

[formula]

As implied by the terminology, when Q is an LDP-polygon the index lQ of Q equals the index l of XQ. The dual polygon [formula] is defined as:

[formula]

[formula] is a polygon containing the origin in its interior, with:

[formula]

Hence the index [formula] equals the smallest positive integer k such that [formula] is a lattice polygon; i.e., the smallest positive multiple such that - kKQ is a Cartier divisor.

It is well-known that:

[formula]

Such polygons are called reflexive (and the corresponding varieties Gorenstein). There are exactly sixteen reflexive polygons, of which five are triangles. It is worth observing that the definitions generalise to higher dimensions; reflexive polytopes have been classified up to dimension four [\cite=KS98b] [\cite=KS00] and are of particular relevance to the study of Calabi-Yau hypersurfaces [\cite=Bat94]. It is conjectured that their maximal volume in fixed dimension is the same as the maximal volume for IP-polygons of order one, however effective bounds are still open (see [\cite=Nill04]).

In Section [\ref=sec:index_2_classify] we classify all LDP-polygons with lQ = 2: there are thirty cases. Of these, seven are known to be triangles [\cite=Dais06]; this should be contrasted with the non-toric results of [\cite=Koj03]. Dais has also classified all LDP-triangles with index three [\cite=Dais07], yielding eighteen cases.

In Sections [\ref=sec:first_classifiction_alg] and [\ref=sec:second_classification_alg] we present two independent methods for classifying all LDP-polygons. The first is inductive on the maximum local index mQ and uses Theorem [\ref=thm:summary_bounds]. The second fixes the index [formula] and employs the concept of special facets introduced in [\cite=Obr07]. A computer algorithm has been implemented which has classified all LDP-polygons with [formula]. The resulting classifications can be obtained via the Graded Rings Database [\cite=GRDb] at and are summarised below.

For each positive integer k let n(k) be the number of isomorphism classes of toric log del Pezzo surfaces with index [formula], and let m(k) be the number of rank one toric log del Pezzo surfaces with index [formula]. Then:

[formula]

The projection method

In this section we explain an elementary observation used in Section [\ref=sec:index_2_classify] to give a direct classification of all LDP-polygons of index two.

First we require a variant of the projection property of reflexive polytopes (see [\cite=Nill05]):

Let Q be an LDP-polygon and let [formula] be a facet with lF = mQ. Assume there exists a non-vertex lattice point [formula] with [formula]. If m is a lattice point in Q with m∉F then m + x is also a lattice point in Q.

We may assume that [formula]. Hence there exists a facet [formula] with [formula]. We have to show that [formula]. If G = F then [formula], since [formula] by assumption. Therefore G  ≠  F and it suffices to show that [formula].

Assume that [formula]. Since lFx∈F  ⊆  Q we see that [formula]. But lF was chosen to be maximal, so lF = lG. Hence [formula], and so lFx is a vertex (in particular, a primitive lattice point). This implies that lF = 1; a contradiction.

Here is our main application (the proof is illustrated in Figure [\ref=fig:proof_of_facetbound]):

Let Q be an LDP-polygon with maximal local index mQ = k  ≥  2, and suppose that [formula] has local index lF = k. Then:

[formula]

Assume that [formula], so F / k has lattice length b / k  ≥  2k. By a unimodular transformation we may assume that there exists [formula] and [formula], for some [formula], such that ( - 1,1)∉F / k and (g,1)∉F / k. This implies that g  ≥  ⌊b / k⌋  ≥  2k.

Let the vertices of F be (f,k) and (e,k), where f  ≤  0  ≤  e. We know that b = e - f. Let L1 be the line through (f,k) with direction vector - x and let L2 be the line through (e,k) with direction vector - x'. These intersect at the point p: = (f,k - b / (g - 1)). Lemma [\ref=lem:projection] applied to x and x' yields that Q is contained in the triangle [formula].

Since ( - k,k)∉F and (kg,k)∉F by assumption, - k + 1  ≤  f and e  ≤  kg - 1. Let L'1 and L'2 be the lines through ( - k + 1,k) with direction vector - x, and through (kg - 1,k) with direction vector - x', respectively. They intersect in the point p': = ( - k + 1,k - (kg + k - 2) / (g - 1)). Q must be contained in the triangle [formula].

This implies that k - (kg + k - 2) / (g - 1)  ≤   - 1, since [formula] is in the interior of Q, yielding that kg - k - kg - k + 2  ≤   - g + 1. Thus g + 1  ≤  2k; a contradiction.

The classification of LDP-polygons of index two

Using the results of the previous section we derive the following:

There are precisely thirty LDP-polygons of index two, up to unimodular equivalence.

Let Q be a LDP-polyon of index two. Let F be a facet of Q with lF = 2, chosen such that [formula] is maximal. By a unimodular transformation we may assume that [formula], where b  ≤   - 1 is an odd integer. By Proposition [\ref=prop:facetbound] we have that b  ≥   - 7. We define [formula], so | IF | = (1 - b) / 2. There are three cases to consider:

b =  - 1. Let IF  =  {x}. By Lemma [\ref=lem:projection] we may assume that Q lies between the two dashed lines:

There are three possibilities:

- x∉P:

- x∈∂P:

[formula]; i.e. - x∈IG for some facet G, so - 2x∈G:

Hence we obtain 24 LDP-polygons of index two, no pair of which are unimodularly equivalent.

b =  - 3. Let IF  =  {x',x}, where x is chosen to be to the right of x'. Lemma [\ref=lem:projection] implies that Q lies in the region defined by the dashed lines:

Now a simple enumeration yields the following list:

Of these, the first and fourth, second and fifth, and third and sixth are unimodularly equivalent. Hence we obtain five unimodular equivalence classes.

b =  - 5. Let x,x'∈IF, where x is chosen to be the right-most lattice point in Q, and x' to be the left-most. By Lemma [\ref=lem:projection] we have that Q lies in the region enclosed by the four dashed lines:

This yields the following LDP-polygon, which is unique up to unimodular equivalence:

Bounding the volume of IP-polygons

The main goal of this section is to present an upper bound on the volume of an LDP-polygon Q of fixed maximal local index mQ  =  k. In fact it is relatively easy to derive the following weak bound on the volume of an LDP-polygon in terms of the index [formula]:

[formula]

This can be seen as follows: [\cite=DN08] gives the quadratic bound [formula] on the number h of elements in the union of the Hilbert bases of the cones spanned by the faces of Q. These lattice points form a non-convex polygon P, where each facet has integral distance one from the origin. Therefore the volume of P equals h. By equation ([\ref=eq:hierarchy]) [formula] contains no non-zero interior lattice points, so [formula] is contained in P. This yields ([\ref=eq:easy_bound]).

In the remainder of this section we shall generalise and improve equation ([\ref=eq:easy_bound]) by bounding the number of boundary lattice points of an IP-polygon Q. This suffices by the following inequality, which stems directly from the definition of the maximal local index:

[formula]

First we give a sharp upper bound on the number of lattice points in facets of IP-polygons.

Let Q be an IP-polygon of order oQ  =  I. Let [formula] be a facet with local index lF. Then:

[formula]

where equality implies that lF  ≤  I and Q is unimodularly equivalent to the triangle with vertices ( - I(lF + 1),lF), (I(lF + 1),lF), and (0, - 1).

We may assume by an unimodular transformation that F is the convex hull of the vertices (a,lF),(b,lF)) with a  ≤  b. Let [formula] and assume that c  ≥  2I(lF + 1). Then [formula].

The line through (a,lF) and ( - I,0) intersects the line through (b,lF) and (I,0) at a point x with second coordinate x2 = 2IlF / (2I - c). Since Q is contained in the triangle with vertices (a,lF), (b,lF), and x, and since Q contains the origin in its interior, we obtain 2IlF / (2I - c)  ≤   - 1. This yields c  ≤  2I(lF + 1), and hence equality. Therefore Q has the vertices ( - I(lF + 1),lF), (I(lF + 1),lF), and (0, - 1). Since (  ±  I,0) and (0,lF) are boundary lattice points of Q, we see that [formula]. Hence, lF  ≤  I.

Let us consider the case of equality in Proposition [\ref=prop:first_IP_bound].

Let Q = Q(a,b) be the triangle with the facet F described in Proposition [\ref=prop:first_IP_bound] such that a = lF and b = I  ≥  a. The local indices of the facets are a, b, and b, so [formula]. We compute [formula] and [formula].

Suppose that [formula], so that [formula]. In the notation of [\cite=Pik01], [formula] equals the translated triangle [formula]; this is conjectured to have the maximal volume of all IP-polygons of order [formula]. This yields a family of IP-polygons with increasing indices [formula], whose number of boundary lattice points grow as [formula] and their volume grows as [formula]. Also note that [formula] (for [formula]) yields an unbounded family of rational triangles having only one interior lattice point and linearly increasing number of lattice points and volume.

Note that Q is an LDP-polygon if and only if [formula]. In this case, [formula]. By choosing a suitable family of increasing coprime integers a and b we obtain a family of LDP-polygons with increasing indices [formula] whose number of boundary lattice points grow as [formula] and their volume grows as [formula].

Since an LDP-polygon has primitive vertices, we obtain the following:

Let Q be an LDP-polygon with maximal local index mQ  ≥  2. Then for any [formula]:

[formula]

We now present the main result of this section. The proof implicitly uses the notion of a special facet, introduced in [\cite=Obr07].

Let Q be an IP-polygon of maximal local index mQ = k  ≥  2. Then:

[formula]

If Q is an LDP-polygon, then:

[formula]

If Q is an LDP-polygon and k  ≥  3 is prime, then:

[formula]

Let:

[formula]

and let [formula] be such that [formula]. Hence [formula]. Set l: = lF, [formula], [formula], and r: = | R |. We have that:

[formula]

Since f  ≤  2k(k + 1) + 1 and l  ≤  k we get:

[formula]

Let [formula]. The set of lattice points on the face of Q defined by -  ηF is therefore given by [formula]. Let g: = | G |  ≥  1 and s: = r - g  ≥  0. We distinguish the case when s is even and when s is odd.

First suppose that s = 2t is even. We obtain the lower bound:

[formula]

By equation ([\ref=eq:casa]) we are required to solve the quadratic inequality (t + 1)(t + g)  ≤  2k3 + 3k2 for t. This yields:

[formula]

Since g  ≤  2k(k + 1) + 1 we have that:

[formula]

Now suppose that s = 2t + 1 is odd. We use the lower bound:

[formula]

Proceeding as before we get:

[formula]

Comparing with ([\ref=eq:firstrrr]) we see that this inequality may be neglected.

Finally, if k  ≥  3 is a prime we may use the bound [formula]. If lF  =  k this follows from Proposition [\ref=prop:facetbound], otherwise, since k is prime, we have that lF = 1. Proposition [\ref=prop:first_IP_bound] yields [formula].

Applying equation ([\ref=eq:inequi]) gives the following corollary:

Let Q be an IP-polygon of maximal local index mQ = k  ≥  2. Then:

[formula]

If Q is an LDP-polygon, then:

[formula]

If Q is an LDP-polygon and k  ≥  3 is prime, then:

[formula]

The investigation of toric log del Pezzo surfaces is closely related to questions in number theory [\cite=Dais06] [\cite=Dais07] [\cite=DN08]. This is partially reflected by an improvement of the upper bound in Corollary [\ref=cor:bound_volume] when the index is prime, and also hinted at in Theorem [\ref=thm:classification_data] where the number of LDP-polygons appears to vary with respect to the number of distinct prime divisors in the index.

When Q is a centrally symmetric IP-polygon with oQ = I, Minkowski's lattice point theorem applied to Q / I yields a quadratic bound:

[formula]

We conclude this section with some open questions. The asmpytotic order of the bounds in Theorem [\ref=thm:bound_boundary] and Corollary [\ref=cor:bound_volume] is optimal for IP-polygons, as seen from Example [\ref=eg:triangles]. Is there also an upper polynomial bound on the volume of arbitrary IP-polygons that is cubic in the order I of the polygons? The best known bound in [\cite=LZ91] is O(I18); in [\cite=Pik01] it is claimed that in the case when Q is a simplex one can show O(I5). Example [\ref=eg:triangles] tells us that O(I3) is necessary.

Considering LDP-polygons of index [formula], we see from Example [\ref=eg:triangles] that at least [formula] is required. Does there exist a family of LDP-polygons whose volume grows cubically with respect to their indices, as is the case with IP-polygons? Unfortunately we do not know the answer.

Description of the first classification algorithm

In this section we describe an algorithm to classify, up to unimodular equivalence, all LDP-polygons Q with given maximal local index mQ  ≤  k. It relies on a more general approach to compute, up to unimodular equivalence, all LDP-polygons Q of given order oQ  ≤  I and with [formula]. By equation ([\ref=eq:hierarchy]) and Corollary [\ref=cor:bound_volume] we can bound from above the order and the volume in terms of the mQ, giving us an effective algorithm for the classification of LDP-polygons with bounded maximal local index.

Let us introduce some notation. An LDP-sub-polygon P of an LDP-polygon Q is the convex hull of a subset of the vertices of Q such that P contains the origin in its interior. The following lemma is the basis of the algorithm.

Let Q be an LDP-polygon.

Let T be an LDP-sub-triangle of Q. Then T is unimodularly equivalent to a triangle given by the vertices (1,0), (p,q), and (x,y), satisfying [formula], [formula], [formula], as well as - q  ≤  y < 0 and yp - q  ≤  xq < yp.

Let P be an LDP-sub-parallelogram of Q. Then P is unimodularly equivalent to a parallelogram given by the vertices ±  (1,0) and ±  (p,q), where 0  ≤  p < q  ≤  4o2Q - 1. Moreover, the triangle with vertices (1,0), (p,q), and ( - 1, - 1) is unimodularly equivalent to an LDP-sub-triangle of Q.

(1) Any LDP-sub-triangle T can be decomposed into three triangles with apex [formula] by intersecting T with the cones over the three faces. By a unimodular transformation we may assume that [formula], where [formula] has the maximum volume of the three triangles. Since the vertices are primitive, we may assume that v1 = (1,0) and that v2 = (p,q), where [formula]. Since [formula], we get that [formula]. Since the volume of C is maximal, we immediately see that v3 = (x,y) has to be contained in the parallelogram [formula]. This yields the restrictions on x and y.

(2) This follows as before, however we use central symmetry and the bound ([\ref=eq:mink]), since oP  ≤  oQ by definition.

Let us recall an upper bound on the number of vertices:

Let Q be an LDP-polygon with maximal local index mQ  ≥  2. Then:

[formula]

Using these two lemmas we can describe the four steps of the algorithm.

Classification of all possible LDP-sub-triangles T: According to Lemma [\ref=lem:classify_start] ([\ref=lem:classify_start_1]) we proceed as follows: first we list all (finitely many) possible (p,q) (with q  ≤  V - 2), and check whether [formula] contains no interior lattice points. Then for any such (p,q) we list all (finitely many) possible (x,y). Finally, for each such T (with [formula]) we check whether T / I contains non-zero interior lattice points.

Classification of all possible LDP-sub-parallelograms P: According to Lemma [\ref=lem:classify_start] ([\ref=lem:classify_start_2]) we go through the list of possible (p,q) obtained in Step 1, with the additional condition q  ≤  4I2 - 1, and check that the parallelogram [formula] has no non-zero interior lattice points, and that [formula].

Successively choosing new vertices: Assume that we have already constructed all possible LDP-sub-polygons with at most t - 1 vertices. We start with t = 3 in Step 1, and finish if t = 4I + 1 by Lemma [\ref=lem:ecken]. So let t  ≥  4. Since in Step 2 we have already classified all LDP-sub-parallelograms, we may assume that we can obtain an LDP-sub-polygon Q' with t vertices recursively from an LDP-sub-polygon Q'' with t - 1 vertices by adding a vertex w. Here we have that either w =  - v for a vertex v of Q'', or there exists an edge [formula] of Q'' such that w,v1,v2 forms an LDP-sub-triangle. This gives only finitely many possibilities for the choice of the new vertex w, according to the list in Step 1. Of course it is useful to immediately impose, for each new selection of a vertex, convexity of the resulting polytope.

Identifying unimodular equivalence: The redundancy of the construction can be reduced by starting with a maximal LDP-sub-triangle with respect to some fixed total ordering, i.e. by using only triangles that are smaller or equal to the initial triangle during the refinement process. The remaining redundancy of representatives of [formula] equivalence classes can be addressed, for example, by bringing the polygons to a normal form using PALP [\cite=KS04].

Description of the second classification algorithm

The aim of this section is to describe an algorithm for classifying all LDP-polygons with index [formula], for some fixed positive integer [formula]. This approach stem from an ingenious definition by Øbro: that of the special facet, put to impressive use in [\cite=Obr07]. A facet F of an IP-polygon Q is said to be special if:

[formula]

Clearly when [formula] there always exists at least one special facet.

Let Q be an LDP-polygon and let F be a special facet of Q with local index lF. Then:

[formula]

We partition the vertices of Q into two sets:

[formula]

Since F is a facet, for each vertex v of Q there exists some integer [formula] such that:

[formula]

Furthermore, since Q is two dimensional, for any such k there exist at most two vertices satisfying ([\ref=eq:vertex_height]). In particular we obtain:

[formula]

Since F is a special facet, we have that:

[formula]

Hence:

[formula]

The following corollary is little more than an application of Proposition [\ref=prop:first_IP_bound] (we refer the reader to Figure [\ref=fig:proof_of_first_IP_bound]):

Let Q be an LDP-polygon with index [formula], and let [formula] be a facet with local index lF. Then:

[formula]

In particular if we write [formula], where - lF < a  ≤  0 < b, then:

[formula]

Lemma [\ref=lem:vertical_bound] and Corollary [\ref=cor:bound_length] provide all the information required to classify the LDP-polygons with fixed index. The algorithm first fixes a special facet, and then attempts to complete that facet to an LDP-polygon via successive addition of vertices. This process is repeated for all possible choices of vertices and all possible initial special facets. A computer implementation of this algorithm was used to produce Theorem [\ref=thm:classification_data].

Choosing a special facet: We begin by fixing a special facet F. This facet must have [formula], and without loss of generality we may assume that [formula], where - lF < a  ≤  0 < b and (by Corollary [\ref=cor:bound_length]) [formula]. Furthermore, [formula] since vertices are primitive by definition.

Choosing a new vertex: Inductively, suppose that we have a collection of vertices v0, [formula] vk - 1, where v0: = (a,lF) and v1: = (b,lF), such that [formula] is a facet for [formula]. We wish to find a possible choice for vk: = (mk,nk), [formula], such that [formula] is a facet.

First consider the possibility vk = v0. If the resulting polygon is an LDP-polygon with index [formula] and F is a special facet, then add it to the list.

The remaining choices for vk are strictly finite. Lemma [\ref=lem:vertical_bound] places a lower bound on nk; we have that:

[formula]

Also, by Corollary�[\ref=cor:bound_length], vk must satisfy:

[formula]

We can reduce this (already finite) region still further. Since [formula] it must be that vk lies strictly on the opposite side of the hyperplane [formula] to vk - 2. It must also lie strictly within the region bounded by the existing facets: [formula] for all [formula]. Finally, the proposed facet Fk must have [formula].

By considering the proof of Lemma [\ref=lem:vertical_bound] we see that the lower bound nk  ≥   - lF(lF + 1) of equation ([\ref=eq:bounding_w]) can be improved upon at each step of the induction. Let b1 =  - lF(lF + 1) be the base case, and replace equation ([\ref=eq:bounding_w]) with bk - 1  ≤  nk < lF. Upon choosing a new vertex vk we can write down an improved bound bk as follows:

[formula]

Should bk become positive then F cannot be a special facet for any resulting polygon: a different choice of vertices should be tried.

Identifying unimodular equivalence: Finally, the issue of unimodular equivalence should be raised. The list obtained from performing the above algorithm should be checked for equivalent polygons; i.e. one need simply check for a transformation in [formula] sending the vertices of one LDP-polygon to the vertices of another. Obviously the list of possible candidates can be substantially reduced if data such as the lFi and [formula] are considered.