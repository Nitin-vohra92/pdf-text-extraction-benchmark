Detecting Orientational Order in Model Systems by X-ray Cross Correlation Methods

Introduction

The study of angular correlation functions in diffraction patterns promises to detect and quantify the usually hidden bond orientational order in amorphous materials [\cite=pnas] [\cite=clark] [\cite=gibson]. The use of angular correlation functions was originally proposed by Kam [\cite=kam] for the structure determination of single particles in dilute solutions. The idea was revived recently first for simulations of diffraction patterns [\cite=saldin_prb2010] [\cite=saldin_actacryst] [\cite=saldin_njp2010] [\cite=elser] [\cite=saldin_oe2011] and finally experimentally for nanorods [\cite=saldin_njp2010] [\cite=saldin_prl2011], dumbbells [\cite=chen] [\cite=starodub] and structures with triangular symmetry [\cite=pedrini]. In those studies, the diffraction pattern of a single particle is extracted from an ensemble of patterns from a dilute solution of randomly oriented identical particles via higher-order correlation functions. Phase retrieval algorithms finally allow the determination of the structure of a single particle.

By using coherent and ultrashort pulses of X-rays the inherent spatial and temporal averaging process of conventional (incoherent) X-ray scattering experiments can be avoided. Instead, snapshots of the instantaneous positions of all particles in the beam are reflected in the coherent diffraction patterns, the so called "speckle patterns". In order to uncover the hidden local symmetries in disordered matter such as liquids and glasses from the speckle patterns properly defined higher order correlation functions have to be devised and applied to the data[\cite=pnas] [\cite=wochner]. This method is called X-ray Cross Correlation Analysis (XCCA) and represents a promising tool for the study of disordered samples such as fast relaxing liquids at X-ray free-electron-laser facilities [\cite=emma]. Here, X-ray intensities, pulse lengths and coherence properties are achieved [\cite=gutt11] that in principle allow to measure speckle patterns even from molecular and atomic liquids which promises to reveal their bond-ordered structure.

In recent work [\cite=altarelli] [\cite=kurta] the potential of XCCA to yield information on the structure of single clusters has been challenged. It was claimed that the cross correlation analysis reflects the cross correlation of a single polygonal cluster only for very dilute systems whereas this is not the case for more realistic dense systems. Since many theoretical publications in XCCA are using simple 2D disordered structures[\cite=altarelli] [\cite=saldin_njp2010] [\cite=kurta] it is important to address the question to what extent the number of particles is compromising the access to single particle properties.

In this paper we show how structural information can be extracted from speckle patterns of polygonal model structures by using properly defined correlation functions. For simplicity and in order to enable the comparison to previous theoretical studies, we are focusing here on two-dimensional systems to demonstrate and discuss the XCCA method. The discussion of 2D systems is of particular relevance to recent experimental studies, that made use of quasi two dimensional samples such as nanorods [\cite=saldin_prl2011] or dumbbells [\cite=chen]. We start with the discussion of coherent scattering from a single pentagon. Various simple simulations of model structures are used to demonstrate the performance of the correlation functions with respect to particle number, q-dependence, and snapshots of various configurations. Here, the two-dimensional models used so far are expanded to new correlation functions and more complex structures. Finally, we discuss the potential impact of the simulations on experimental studies.

Scattering from two-dimensional samples

Scattering from a single pentagon

As a starting point we discuss the scattering from particles in a two dimensional pentagonal arrangement as a model for five-fold order. We assume particles arranged in a plane with fixed electron density forming the single pentagon. The incoming beam is orthogonal to the sample system. The scattering amplitude [formula] is described within the first Born approximation as the Fourier transform of the electron density [formula]

[formula]

where q denotes the scattering vector. The electron density of the pentagon is given by

[formula]

in polar coordinates, with R0 denoting the radius of the polygons, [formula], and ω denoting the absolute orientation of the pentagon with respect to a reference coordinate system. An expansion of the scattering amplitude in a Fourier series yields [\cite=baddour]

[formula]

where [formula]. The Fourier coefficients in Eq. [\ref=eq:ftseries] are

[formula]

with Jl denoting the Bessel functions of first kind. Because of the pentagonal symmetry, all coefficients with (l    5)  ≠  0 in Eq. [\ref=eq:ftseries] are zero. Odd terms cancel out pairwise (e.g. l = 5 and l =  - 5) and only terms with l being a integer multiple of 10 contribute to the scattering amplitude. Furthermore, because [formula], higher order terms (l > 10) become only observable at large q. The scattered intensity of such a cluster is given by I(q,θ) = A(q,θ)A*(q,θ), thus we obtain the well known result that the local pentagonal structure is directly accessible from the symmetry of the scattering pattern. One way to determine this symmetry is the calculation of the angular power spectrum of I(q,θ), resulting in contributions of [formula] depending on q for the example discussed.

Scattering from systems of randomly ordered polygons

In our model study we require that the clusters are uncorrelated in space. Orientational disorder is fulfilled with the polygonal clusters being randomly rotated with respect to the axis of the incoming photon beam. The requirement for positional disorder is more difficult to realize when increasing the number of particles and when overlap of particle clusters shall be avoided. Here special care has to be taken in order to avoid introducing artificial correlations via the computer model.

We have pursued two routes for the simulation. In model A we placed the clusters randomly in the computational box. This approach is working well for dilute systems but when increasing the number of particles overlap between clusters becomes more likely. In model B we used a tiling of the computational box with only one cluster allowed per tile (see Fig. [\ref=fig:cell]).

For both models the scattering amplitude can be calculated as follows. We start with a two dimensional lattice and allow arbitrary movements of the polygons around the lattice positions [formula]. The final distance to the initial lattice point is given by the displacement vectors [formula]. The two models basically differ in the size of the allowed displacement vectors [formula]. While model A accepts displacements as large as the computational box, model B limits the size of [formula] so that the position of each cluster is limited to the tile.

The scattering amplitude becomes

[formula]

with [formula]. This results in the scattering intensity

[formula]

The sample's orientational correlations are revealed by performing an orientational Fourier analysis of the intensity. The corresponding Fourier coefficients are given by

[formula]

with the orientational Fourier transforms of the clusters [formula] and of the positional part [formula]. For liquids and glasses the ensemble averaged positional part is the well known structure factor S(q) describing the typical short ranged positional correlations of particles. However, in the spirit of XCCA it can also contain information on higher order correlation functions and as such provide new insights into glasses and liquids.

Depending on the construction and properties of this positional correlator Ĝj,k(q,l) it is immediately clear that it can contribute additional Fourier components to the XCCA signal. Diluted systems imply large values of the displacement vectors uj yielding small values of the correlator Ĝj,k(q,l). When increasing the concentration uj usually gets smaller leading to an increase of Ĝj,k(q,l) which becomes maximized for cluster positions fixed on lattice points. Moreover it is also important to note that the positional correlator scales as N2 with N being the number of particles. Thus even when uj is large, as in our model A, an increasing number of particles will lead to an increase of the size of the positional correlator. If Ĝj,k(q,l) carries also angular Fourier components they will contribute to the XCCA signal depending on the size of the displacement vector uj and of the number of particles. Thus the effect of the positional correlator is of great importance when considering dense systems and we will show how it affects the XCCA signal and how to discriminate between the different XCCA signals in the analysis.

X-ray Cross Correlation Analysis

In order to detect a sample's orientational order, the power spectrum of the intensity is calculated with respect to φ for every single speckle pattern [\cite=altarelli] via

[formula]

where I denotes the scattered intensity on an annulus with scattering vector q and azimuthal position φ (see Fig. [\ref=fig:sim] for definitions), Il(q) denotes the Fourier coefficients of I(q,φ).

XCCA is based on measuring correlations within a single diffraction pattern. However, for sufficient statistical accuracy the correlation functions have to be calculated for many different diffraction patterns. Therefore we devise the correlation function

[formula]

as variance of the Fourier coefficients Il(q) of the intensity I(q,φ). Here 〈  ·  〉e denotes an ensemble average from different scattering patterns with Ψl(q) then being the variance over the ensemble of the Fourier coefficients Il(q). It is not affected by angular correlations from the positional correlator Ĝj,k(q,l) because Ĝj,k(q,l) is expected to be invariant to ensemble averaging and thus cancels out when calculating the variance in Eq. [\ref=eq:psi]. Hence, Ψl reflects the single cluster's orientational order only.

In literature the cross correlation function

[formula]

is discussed frequently [\cite=pnas] [\cite=saldin_njp2010] [\cite=saldin_prl2011] [\cite=kurta_pre]. Here the average 〈  ·  〉φ denotes the angular average around rings of constant q. The sample's orientational order is accessed by the Fourier coefficients Cl(q) of C(q,Δ). After replacing the intensity I(q,φ) by a normalized quantity

[formula]

the Fourier coefficients Cl of C(q,Δ) equal the power spectrum of IN(q,φ) (Wiener-Khinchin theorem)

[formula]

and thus [formula] for l  ≠  0 and Ψl(q)  =  〈Cl(q)〉e  -  〈INl(q)〉2e

The search for the orientational order of the clusters using Cl(q) requires 〈INl(q)〉e = 0, which is difficult to achieve in simulations due to the natural tiling of the real space. Hence, contributions from the positional correlations cannot be neglected. These constraints in fact can be overcome by using Ψl instead of C. For 〈INl(q)〉e = 0, it is simple to deduce [formula]. For the remaining part of the paper we will thus use Ψl(q) for studying the orientational order.

It is important to mention, that in simulations and theoretical studies the bond order of amorphous samples is expressed by locally defined order parameters [\cite=steinhardt] [\cite=kawasaki] [\cite=tanaka10]. Such order parameters reflect the orientational order of each particle's next-neighbour shell. In contrast, Ψl and [formula] are averaged over all particles in the diffraction volume (typically > 108 particles) and are thus a measure of the mean orientational order of the sample.

XCCA on model structures

Correlation functions were calculated for an ensemble of particles forming different polygonal structures that are placed into the two-dimensional computational box. To allow orientational disorder, each polygon is rotated by an arbitrary angle ωj within the interval

[formula]

Characterisation of increasing order

In scattering experiments on amorphous samples, various Fourier coefficients reflecting the diversity of orientational order are expected. Typical Fourier coefficients for such samples are shown in Fig. [\ref=fig:orderpsi] A. Both samples are made out of 2400 single particles. The upper example represents Ψl for a sample system that does not show any dominating order, while the bottom one shows dominating order, giving rise to a pronounced hexagonal order (maxima for l = 6,12). As discussed above, the absolute values of Ψl / n reflect the strength of the corresponding Fourier coefficients l and therefore represents an order parameter. However, in experimental situations the exact number of particles n is usually unknown. Therefore, we define an order parameter that is sensitive to appearence of dominating order via

[formula]

as the variance of a normalized Ψ with respect to l. Here 〈Ψl(q)〉l denotes the mean value of Ψl with respect to l, taking the all even terms between l = 4 and l = 24 into account. The examples in Fig. [\ref=fig:orderpsi] A exhibit [formula] and [formula], respectively. For the mixture of pentagons and heptagons (see Figs. [\ref=fig:sim] and [\ref=fig:pentahepta]), we find ξ5 + 7 = 2.6 at the typical next-neighbour distance, while a random arrangement of particles results in [formula]. Therefore, ξ is zero or close to zero in case of fully disordered samples, and increases with increasing order. Thus ξ provides a measure of the occurrence of order in the sample.

The question emerges, how many ordered particles are necessary so that the order can be detected via calculation of ξ. Therefore we calculated ξ for a mixture of polygons and randomly placed particles. The number of particles forming polygons p range from 0%, i.e. a completely random system, up to 100% consisting out of polygons only. Fig. [\ref=fig:orderpsi] B shows the result for such systems for pentagons, hexagons and heptagons, respectively. The q-range was chosen to fit the next-neighbour distance. In general, all systems show a similar shape with increasing p. Remarkably, a small number of ordered particles results already in a significant increase of ξ. For the pure polygon samples (p = 100%), we find ξ5 = 5.6, ξ6 = 4.2, and ξ7 = 6.7 for pentagons, hexagons, and heptagons, respectively. The lower value for hexagons and the slightly different curve shape can be understood as caused by the occurrence of more Fourier components (l = 6,12) compared to the other polygons (e.g. l = 10 for pentagons) and thus a reduced variance Ψl. The random system (p = 0%) shows no dominant order, thus [formula].

Experimental constraints

In order to test the cross correlation analysis discussed above, we performed a coherent scattering experiment on colloidal glasses (for more details see [\cite=lehmkuehler2013]). The coherent small-angle x-ray scattering experiment has been performed at beamline P10 of PETRA III at DESY (Hamburg, Germany). The beamsize was defined by slits to 10 [formula]m×   10 [formula]m and the x-ray energy was chosen to 7.9 keV. A Princeton Instruments CCD detector (1300×  1340 pixels, pixel size 20 [formula]m) was placed at a distance of 5 m to the sample. Speckle patterns were measured from a colloidal hard sphere glass consisting of a 1:1 mixture of polymethylmethacrylat (PMMA) particles in decalin with radii of 125 nm and 84 nm, respectively. A sample scattering pattern is shown in Fig. [\ref=fig_exp] A together with the azimuthally integrated intensity I(q) calculated from a pattern averaged over 1000 single frames. The grainy speckle structure is clearly visible in the pattern. In contrast to the simulation, the data were taken from a 3-dimensional sample (using capillary of 0.7 mm thickness).

In Fig. [\ref=fig_exp] B the results of the XCCA analysis for q = 0.03 nm- 1 is shown for two different ensemble sizes. In contrast to the simulation data odd coefficients can be observed with amplitudes similar to the even ones. Furthermore, the results seem to be clearly depending on the statistics, i.e. the number of patterns that were used for calculation of Ψl. Therefore, we need to study the statistical accuracy which is necessary for calculation of Ψl and potential other factors that may lead to the appearance of odd XCCA coefficients in the simulation model.

Statistical accuracy

To estimate how many single speckle patterns have to be measured to detect a preferred order by XCCA from the viewpoint of simulations, the evolution of Ψl with the number of arrangements can be studied. The results are presented in Fig. [\ref=fig:expconmerge] A for l = 6 exemplary for four systems consisting of a different number of hexagons ranging from 4 to 1600. Here, Ψ6 is calculated after each arrangement of hexagons and normalized to the final value, i.e. Ψ6(2000) after 2000 runs. Similar results can be found for all other Fourier coefficients as well as other runs and were also reported recently for Cl [\cite=kurta]. Obviously, the number of hexagons studied does not influence the deviation of the final value of the orientational order. This is in agreement with recent simulations [\cite=kirian], where the signal to noise ratio was found to be independent from the number of particles. After approximately 50 speckle patterns Ψ6 does not change significantly, after 200 patterns Ψ6 stays inside a range of ±   10% of the final value. To achieve statistics of less than 2% at on the order of 1000 patterns have to measured in such two-dimensional systems. These observations agree to the experimental results in Fig. [\ref=fig_exp] B. Similar results are achieved for other Fourier coefficients l and different sample systems, e.g. the two component system consisting of pentagons and heptagons.

Noise

As discussed above, only even symmetries are allowed in the speckle patterns from electron densities with vanishing imaginary part. This is in particular true for the results of simulations, where odd symmetries are typically three to four orders of magnitude weaker than the even ones. The fact that they are not zero can be understood as shortcoming of the numerical accuracy of the calculation of the Fourier transform. In experiments the amplitude of odd symmetries is usually larger (see Fig. [\ref=fig_exp] B), partially caused by noise effects from the photon counting process. To estimate the influence of such noise, we chose arrangements of 400 hexagons.

The counting noise was modeled by random noise which was added to the calculated speckle patterns. Its magnitude is described by the intensity to noise ratio INR. For instance, an INR value of 10 means that the mean value of the added noise is ten times smaller than the pure signal without noise. Afterwards, the patterns were normalized to their mean values and Ψl was calculated from the ensemble of patterns for a q-region that corresponds to the next-neighbor distance. To quantify the influence of the noise, the mean values 〈Ψ〉j were calculated for both odd and even symmetries, where 〈〉j denotes the average for either odd or even symmetries. The results are shown in Fig. [\ref=fig:expconmerge] B as function of the intensity to noise ratio INR.

At high INR values, the odd symmetries are almost zero. The computational accuracy of calculation of the Fourier coefficients is demonstrated by the finite and non zero value of the odd symmetries with increasing INR. Odd symmetries become observable for low INR with a simultaneous decrease of the magnitude of the even symmetries. In particular, for INR≤  5 [formula] starts to decrease while the odd coefficients increase. Finally, for INR≤  0.02 the magnitudes of even and off symmetries are comparable. Remarkably, XCCA allows still at very low INR values around and below 0.1 the observation of dominant order, which is usually not possible using other methods.

Non-planar wavefronts

Beside the photon noise, odd coefficients can be caused by non-planar x-ray wavefronts [\cite=rutishauser]. So far, our calculation were performed assuming ideal experimental setting, in particular a planar x-ray wavefront. Here we discuss the influence of a curved x-ray wavefront by replacing the modeled structure density [formula] with a so called Fresnel density [\cite=sinha]

[formula]

with [formula] having its origin in the center of the computational box. Assuming no influence of beam defining aperture, α can be calculated via [\cite=sinha]

[formula]

with the monochromacity of the beam [formula], k0 the absolute value of the incoming wave vector, and L the distance between sample and detector. For convenience, we substitute α by the dimensionless parameter β  =  αd2, with d denoting the particle size. A typical hard x-ray scattering experiment on colloidal particles in SAXS geometry (λ = 1.5 Å, sample-detector distance approx. 5 m, particle size d = 100-500 nm), results in typical values in the order of 10- 6  <  β < 10- 5. We studied the hexagon system at different values of β as shown in Fig. [\ref=fig:expconmerge] C. At low β values, no contribution of odd Fourier coefficients can be observed. This changes for β  ≥  10- 5 where odd coefficients increase accompanied by a decrease of the even coefficients. For β  ≥  10- 4 both are almost equal.

Fig. [\ref=fig:expconmerge] D shows Ψl for some β values. The increase of the magnitude of the odd coefficients is mainly limited to the contributions next to the dominant even coefficients, e.g. l = 5,7 at α = 6  ·  10- 5. At larger β values, other even components increase in addition, such as l = 8. Nevertheless, the maxima around l = 6,12 are still observable. Thus, the shape of the x-ray wavefront may influence the results of an XCCA experiments significantly. This is of particular importance, if the wavefront is unknown. The influence of non-planar wavefronts is further investigated for cross-correlation studies with visible light, see [\cite=schroerpre].

Summary

In summary, by introducing a new correlation function Ψl we demonstrated the feasibility of XCCA to detect the orientational order of a sample. We showed that additional Fourier coefficients of the cross correlation function C can originate from the tiling of the computational box and are not an intrinsic feature of XCCA in dense systems.

We note that such a correlation function is also important for experimental situations where background and slit scattering are often present and need to be taken into account. Furthermore we show that a particular orientational order can already be detected if only few particles exhibit such an order. The study of orientational order as a function of the number of speckle patterns and the influence of random noise and non-planar wavefronts suggest that on the one hand at least some 100 single patterns have to be measured to detect a preferred orientational order with sufficient accuracy and on the other hand that noise and non-planar wavefronts influence the amplitudes of Ψl significantly. The findings of this study will guide the way for application of the XCCA method in subsequent experiments on amorphous materials such as liquids and glasses. Naturally, further considerations have to be taken into account when three-dimensional systems are studied [\cite=kurta2013] which we will discussed in subsequent theoretical and experimental work [\cite=lehmkuehler2013] [\cite=schroerpre].

We thank Birgit Fischer for sample preparation and support during the beamtime. Michael Sprung is acknowledged for experimental support. We like to acknowledge the Excellence Cluster "Frontiers in Quantum Photon Science" and the "Hamburg Center for Ultrafast Imaging" (CUI) for financial support.