=4

Three-step estimation of latent Markov models with covariates

Introduction

In many applications involving longitudinal data, the interest is often focused on the evolution of a latent characteristic of a group of individuals over time, which is measured by one or more occasion-specific response variables. This characteristic may correspond, for instance, to the quality-of-life of subjects suffering from a certain disease, to a certain type of ability, or to the tendency to commit crimes.

The latent Markov (LM) models of [\cite=wigg:73] may be usefully applied in such a context; for a review see [\cite=bart:et:al:13]. The main assumption underlying these models, known as local independence, is that the response variables are conditionally independent given a latent process which follows a Markov chain with a finite number of states and which is typically homogeneous and of first order. The basic idea behind this assumption is that the latent process fully explains the observable behavior of a subject; moreover, the latent state to which a subject belongs at a certain occasion only depends on the latent state at the previous occasion. In the presence of multivariate outcomes (more response variables for each time occasion), the model allows for a dynamic clustering of subjects also depending on individual covariates.

LM models may be estimated by a Full Maximum Likelihood (FML) method based on the Expectation-Maximization (EM) algorithm [\citep=baum:et:al:70] [\citep=demp:lair:rubi:77] and recursions which are well known in the hidden Markov literature [\citep=baum:et:al:70] [\citep=zucc:macd:09]. However, especially in the presence of many response variables for each time occasion and individual covariates, the FML estimation may have some drawbacks, as illustrated in more detail in the following.

In this paper, we propose an estimation approach which may be seen as an extension of the three-step estimation method for the latent class (LC) model with covariates [\citep=vermunt:2010]. This new estimation method is based on a preliminary dynamic clustering of subjects on the basis of only the time-specific responses, and may be seen as a stable alternative to the full likelihood method, which also allows for fast estimation of the model parameters.

We recall that, when applied to the LC model with covariates, the three-step estimation approach consists of first fitting a basic LC model for the set of response variables ignoring the covariates. Then, the subjects are assigned to the latent classes on the basis of their posterior class membership probabilities. Finally, the association between class membership and individual covariates is investigated through the estimation of a suitable multinomial logit model [\citep=bolck:et:al:04] [\citep=lu:thomas:08] [\citep=bakk:et:al:13].

In the proposed version of the three-step approach, hereafter 3S, every sample unit is not strictly assigned to a latent state at each occasion and this latent state can change across time. In this way, even the parameters affecting the transition probabilities of the latent Markov chain may be estimated. We apply this estimation method to the basic LM model and to its extended version which includes individual covariates.

The performances of the proposed 3S estimation method are assessed through a Monte Carlo simulation study in comparison with those of the FML method. We also illustrate the approach by an application based on a real dataset which derives from a project, named ULISSE, on the health status of elderly people hosted in Italian nursing homes.

The paper is organized as follows. In Section [\ref=sec:lm] we outline the basic LM model and its extended version with individual covariates. Section [\ref=sec:EM] illustrates the estimation of the model on the basis of the standard FML method, whereas in Section [\ref=sec:three-step] we outline the proposed 3S estimation approach. In Section [\ref=sec:5] we illustrate the results of the simulation study, aimed at evaluating the performances of the proposed estimation approach, and in Section [\ref=sec:ulisse] we show the results of the application to real data. Section [\ref=sec:6] contains main conclusions.

Latent Markov model

In the following, we illustrate the basic latent Markov (LM) model and its extended version which includes individual covariates.

Basic LM for multivariate data

Let consider the multivariate case in which we observe a vector Y(t) of r categorical response variables, Y(t)j, with cj categories, from 0 to cj - 1, [formula], which are available at the t-th time occasion, [formula]. Let also Y be the vector made up of the union of the vectors Y(t), [formula].

The model assumes the existence of a latent process [formula] which affects the distribution of the response variables. Such a process is assumed to follow a first-order Markov chain with state space [formula], where k is the number of latent states. Under the local independence assumption, the response vectors [formula] are assumed to be conditional independent given the latent process U. Moreover, the elements Y(t)j within Y(t), [formula], are conditionally independent given U(t). This assumption leads to a strong simplification of the model but it can be relaxed by allowing conditional serial dependence or conditional contemporary dependence [\citep=bart:et:al:13]. Note also that the LM model may be seen as an extension of the latent class (LC) model [\citep=laza:50] [\citep=laza:henr:68] [\citep=good:74b], in which the assumption that each subject belongs to the same latent class throughout the survey is suitable relaxed.

The model formulation is based on the following conditional response probabilities:

[formula]

which are collected in the matrix Φj of dimension cj  ×  k. Moreover, parameters of the latent process are the initial probabilities

[formula]

collected in the vector π, and the transition probabilities

[formula]

collected in the matrix Π. Note that all these probabilities do not depend on the specific sample unit since, in its basic version, the LM model does not include individual covariates. Moreover, in this version the conditional response probabilities and the transition probabilities are time-homogeneous.

The above assumptions imply that the distribution of U may be expressed as

[formula]

where [formula] denotes a realization of U. Moreover, the conditional distribution of Y given U is defined as

[formula]

where y is made by the subvectors [formula], and, in general, due to the assumption of local independence, we define

[formula]

Finally for the manifest distribution of Y we have

[formula]

It is important to note that computing p(y) as expressed in ([\ref=eq:dist3]) involves a sum extended to all the possible kT configurations of the vector u; this typically requires a considerable computational effort. In order to efficiently compute such a probability, we can use the Baum-Welch forward recursion [\citep=baum:et:al:70] [\citep=welch:2003]; see [\cite=bart:et:al:13] for details.

Extended LM model with individual covariates

Let x(t) denote the vector of individual covariates which are available at the t-th time occasion, and let x denote the vector of all the individual covariates, which is obtained by stacking the vectors [formula]. In this paper, we consider the case in which the covariates are included in the latent model, so as to affect the initial and transition probabilities. In this situation, the assumption of local independence and the assumption that the latent process is of first order still hold. Moreover, the conditional response probabilities are again time-homogeneous and equal for all subjects as in ([\ref=eq:cond]). The initial and transition probabilities depend instead on the individual covariates through a multinomial logit model

[formula]

In the above expressions, [formula] and [formula] are parameter vectors to be estimated which are collected in the matrices β and Γ.

The manifest distribution of Y is now conditional to x and may be easily defined as an extension of ([\ref=eq:dist3]). The corresponding probability function is denoted by p(y|x).

Maximum likelihood estimation

Given a sample of n independent units that provides the response vectors [formula], and given the vectors of covariates [formula], the model log-likelihood assumes the following expression

[formula]

Note that in this case each vector yi is a realization of Yi which is made up of the subvectors y(t)i, [formula], that, in turn, have elements y(t)ij, [formula]. Moreover, xi may be decomposed into the time-specific subvectors of covariates [formula]. Note also that p(yi|xi) corresponds to the manifest probability of the responses provided by subject i, given the covariates, and θ is the vector of all free parameters affecting p(yi|xi). The likelihood function can be maximized by the EM algorithm [\citep=baum:et:al:70] [\citep=demp:lair:rubi:77], as described in the following section.

Expectation-Maximization algorithm

The EM algorithm is based on the complete data log-likelihood that we could compute if we knew the latent state of every subject at each occasion. The complete data are represented by the pairs (ui,yi), [formula], where [formula] is the sequence of latent states of subject i. The complete data log-likelihood has the following expression

[formula]

where a(t)ijuy is the indicator variable for subject i responding by y at occasion t to response variable j and belonging to latent state u at the same occasion, b(t)iu is the indicator variable for subject i being in latent state u at occasion t, whereas b(t)iuv is the indicator variable for the transition, of subject i, from state u at occasion t - 1 to state v at occasion t.

The EM algorithm alternates the following two steps until convergence:

E-step: it consists in computing the posterior expected value of each indicator variable involved in ([\ref=eq:comp_lk_cov]) by suitable forward-backward recursions [\citep=baum:et:al:70];

M-step: it consists in maximizing the complete data log-likelihood expressed as in ([\ref=eq:comp_lk_cov]), with each indicator variable substituted by the corresponding expected value. How to maximize this function depends on the specific formulation of the model and, in particular, on whether the covariates are included in the measurement model or in the latent model.

Even if the EM algorithm is typically used to estimate LM models, in real applications the FML estimators may have some drawback. In particular, it is not uncommon that the number of response variables for each time occasion is very large, as well as the number of estimated latent states. As an example, in the application illustrated in Section [\ref=sec:ulisse], the dataset consists of r = 75 polytomous items, with a different number of response categories, and 28 individual covariates, for which we estimate an LM model with k = 4 latent states. In similar circumstances, the model likelihood may present many local maxima, requiring then a very high number of random starting values to find the global maximum. Moreover, the EM algorithm may be particularly slow to converge, and may become unstable with complex LM models, which also include a large number of time-fixed or time-varying covariates. All these problems cannot be solved by a direct maximization algorithm, such as the Newton-Raphson algorithm which is known to have instability problems even in simpler cases [\citep=turner:08]. The proposed 3S estimation approach allows us to overcome some of these problems without being computationally intensive. Moreover, this strategy may also be useful to define suitable starting values for the EM algorithm to be used in the full-maximum likelihood approach.

Proposed three-step estimation approach

In the literature on LC models, the three-step approach [\citep=vermunt:2010] represents an alternative to the FML method to deal with the inclusion of individual covariates. The latter approach may indeed be impractical in some applications, especially when the number of covariates is large, as typically happens in exploratory studies. Moreover, the simultaneous modeling of covariates and latent variables may introduce additional complexity in selection and estimation of models, with a potentially large number of parameters [\citep=bakk:et:al:13].

In this section, we introduce a modified version of the three-step approach in order to estimate the basic LM model and its extended version with individual covariates. More in detail, the proposed 3S method is based on the following steps:

Step 1: Fit a basic LC model for the set of response variables in which the responses provided by the same sample unit at different occasions are considered as corresponding to separated units. On the basis of this preliminary fitting, performed via the EM algorithm, we obtain the final estimates of the conditional response probabilities, jy|u, and the "temporary" estimates of the marginal probabilities of the latent states u  =  p̂(U(t)i  =  u).

Step 2: For each subject i compute the posterior expected value of b(t)iu and b(t)iuv (see equation ([\ref=eq:comp_lk_cov])) only on the basis of the results of the first step as

[formula]

Step 3: Maximize the components of the complete data log-likelihood involving the latent structure parameters

[formula]

For the basic LM model, the third step simply consists in computing

[formula]

When we deal with the extended LM model with covariates, the last step consists of estimating β and Γ, defined in ([\ref=eq:be]) and ([\ref=eq:Ga]), by fitting multinomial logit models based on a weighed likelihood as defined in ([\ref=eq:lbe]) and ([\ref=eq:lGa]); the corresponding estimates are denoted by [formula] and [formula], respectively.

In order to overcome some limitations in the estimation of the parameters of the latent process, we also consider an improved version of the 3S approach, termed as 3S-IMP, in which the second and the third steps are iterated until convergence, while keeping the results from the first step fixed. More in detail, after an initial estimate of the latent structure parameters, each Step 2 is based on computing

[formula]

In the above expressions, the probabilities p̃(  ·  |  ·  ) are based on the estimates from the previous iteration. Finally, each Step 3 is performed in the same way as in the initial version of the algorithm.

As we shall see in more detail in the following section, the proposed 3S estimation algorithm produces consistent estimates of the conditional response probabilities jy|u, with easily interpretable results. Moreover, since the first step is based on fitting a basic LC model, several starting values may be easily tried and the global maximum of its likelihood may be found with a reasonable effort. Another advantage with respect to the full likelihood method is that estimation of πu and πv|u, or β and Γ when we include individual covariates, is fast and there are no problems of multiple solutions. Finally, it is worth noting that the behavior of the estimator of the parameters of the latent process is expected to improve as the number of response variables increases, since more information about clustering is provided by the response variables.

Properties of the three-step estimator

In the following we discuss the asymptotic properties of the 3S estimator that hold as the sample size and the number of response variables tend to infinity, keeping the number of latent states fixed.

When the sample size n tends to infinity, the three-step estimation method described in Section [\ref=sec:three-step] produces consistent estimates of the conditional response probabilities jy|u, provided that the data are generated from a LM model with a given number of states k.

Recall that, for the basic LM model for multivariate data, the manifest distribution of each vector of response variables Y(t) for the t-th time occasion may be written as follows:

[formula]

where

[formula]

Consider also an alternative data generating process in which, at the first step, we randomly choose the time occasion t and, at the second step, we obtain [formula] as the response configuration of the sample unit corresponding to the selected occasion t. Then, for an arbitrary t we have

[formula]

where [formula] may be interpreted as the average probability, overall the different time occasions, of being in state u. Therefore, by fitting the basic LC model for the set of response variables in which the responses provided by the same subject at different occasions are considered as separated sample units, corresponds to consider a likelihood for all vectors [formula], whose maximization allows us to obtain consistent estimates of the conditional response probabilities φjy|u.

When we deal with the extended LM model with individual covariates, expression ([\ref=eq:dist_proof]) becomes

[formula]

We then conclude that, even in the presence of individual covariates, as n goes to infinity, the 3S estimator of φjy|u is consistent.

When the sample size n and the number of response variables r tend to infinity, the three-step estimation method described in Section [\ref=sec:three-step] produces consistent estimates of the parameters of the latent process, provided that the data are generated from an LM model with a given number of states k, and that exists a fixed constant ε  >  0 such that [formula], [formula], [formula].

Consider that, at Step 2 of the proposed 3S estimation method, we can assign the subjects to the different latent states for each time occasion on the basis of the estimated posterior probabilities, that may be expressed as

[formula]

When the sample size n and the number of response variables r tend to infinity, provided that these variables are not independent of the latent variable defining the latent states, the allocation of the subject tends to the true one with probability which tends to 1 and, therefore, the parameters of the latent process are consistently estimated.

Simulation study

In the following, we rely on a Monte Carlo simulation study aimed at evaluating the behavior of the proposed 3S and 3S-IMP estimation algorithms, illustrated in Section [\ref=sec:three-step], in comparison with the FML method under a benchmark design and other possible scenarios. We consider both estimation of the basic LM model and of the extended LM model with individual covariates. In particular, we generate sample data with certain population parameters and we evaluate the performance of the two estimation methods in terms of bias, standard error, and root mean square error on the basis of 100 simulated samples.

Basic LM model

For the basic LM model, the benchmark design (Scenario 1) is based on the following setting:

sample size: n = 500;

number of time occasions: T = 5;

number of response variables: r = 5,10,20,50;

number of categories of the response variables: cj = 2, [formula];

number of latent states: k = 2,

conditional response probability matrix: [formula];

initial probability vector [formula];

transition probability matrix [formula].

All the algorithms have been implemented by means of a series of R functions with the recursions implemented in Fortran (gfortran compiler) and were run on a Intel Core i5 processor with 2.5 GHz.

In Table [\ref=tab:est_Phi] we report the estimation results of the conditional response probabilities obtained by the FML method and the 3S estimation method. The table only shows the scenario in which r = 5, because for r = 10,20,50 we obtained similar results.

These results are in agreement with Proposition [\ref=prop:1], according to which the conditional response probabilities are consistently estimated by the proposed approach, even if some loss of efficiency is observed.

Table [\ref=tab:est_pi] concerns estimators FML, 3S and 3S-IMP of the initial probabilities, whereas in Table [\ref=tab:est_PI] we display the estimation results of the transition probabilities obtained by the methods under comparison.

From the results above we observe that the bias of u is always negligible and its root mean square error decreases as the number of response variables increases. Moreover, very small differences are found between the two versions (3S and 3S-IMP) of the proposed estimator. Regarding the three-step estimator of the transition probabilities, we observe that its bias is higher with few response variables for each time occasion, especially in the standard version (3S), but it decreases with r. The same happens for the root mean square error. The 3S-IMP version has better performance, with a bias of v|u which becomes negligible when r  ≥  20. When r = 50 the results of both versions are very similar to those obtained by the FML estimator.

In the second scenario defined in our simulation study, we evaluate how a lower persistence of the Markov chain may influence the performance of the estimation algorithms under comparison. In fact, we consider the same parameters as in the benchmark design apart from the transition probability matrix, which is let equal to

[formula]

In this situation, the conditional response probabilities are again consistently estimated by both the FML and the 3S methods, with very similar results in terms of bias and root mean square error than Scenario 1. Very similar performances with respect to the benchmark design are also obtained by the estimators of the parameter πu. Therefore, we report here only the results about estimation of the transition probabilities.

From Table [\ref=tab:PI2] we observe that, with a lower level of persistence of the Markov chain, the behavior of v|u improves. In particular, we note smaller differences, in terms of bias, standard error, and root mean square error, between the FML and the 3S estimator and also between the 3S and the 3S-IMP estimator.

Under Scenario 3 we consider more separated latent states, with a parameter setting equal to the benchmark design, apart from the conditional response probability matrix, that is,

[formula]

In this context, all the estimators improve their performances, leading again to consistent estimates of the conditional response probabilities φjy|u; we also observe an improvement in estimating the initial probabilities πu. Focusing only on the transition probabilities, whose estimation is the most challenging, from Table [\ref=tab:PI3] we observe a great improvement of the 3S approach, with negligible differences in terms of bias and root mean square error of v|u, with respect to the FML method and between the two versions of the three-step method, especially when r  ≥  10.

The fourth scenario we consider for the basic LM model allows us to evaluate the influence of a larger number of latent states. We then apply the following setting:

number of latent states: k = 3;

conditional response probability matrix: [formula];

initial probability vector: [formula];

transition probability matrix: [formula].

The remaining parameters are left unchanged with respect to the benchmark design.

In such a context the performances of all estimators get worse, with higher bias and root mean square error; see Table [\ref=tab:PI4] which reports the results regarding the estimation of πv|u. As in the previous scenarios, the performance of the proposed estimator improves as the number of response variables increases.

We finally assess the influence of the sample size n and of the number of time occasions T on the estimation results by considering the same parameters setting as in Scenario 1 apart from n = 1000 and T = 8. When the sample size and/or the number of time occasion increase, we observe an expected improvement of all estimators; for example, the standard error of the estimators decreases, in general, with [formula]. We do not report here these results for reason of space.

In comparing the estimation approaches, it is relevant to take into account the computing time required to run the algorithms of interest. In particular, we observe that under the benchmark design (Scenario 1) the computing time required by the 3S approach is, in all samples, significantly lower than that required by the FML approach. On the other hand, the computational cost of the 3S-IMP version is higher, especially with a few response variables. The number of iterations required by the 3S-IMP version to reach the convergence goes, in average, from 27 (with r = 5) to 4 (with r = 50). Under Scenario 2, we observe an increase of the computational cost of the FML estimation algorithm. On the other hand, the computing time required by the two versions of the three-step algorithm is similar to that of Scenario 1, with a very similar number of iterations to reach the convergence (from 21 with r = 5, to 4 with r = 50). The third scenario shows a strong decrease of the computing time for all the algorithms, together with a reduction of the number of iterations to converge required by the 3S-IMP algorithm, which goes from 6 (with r = 5) to 1 (with r = 50). In this context the computational cost of the 3S algorithm remains always significantly lower than that of the FML algorithm, whereas, for the 3S-IMP algorithm, this happens only for r  ≥  20. Finally, when the number of latent states increases (Scenario 4), the computing time required by the FML algorithm becomes significantly higher. We also observe a strong increase of the number of iterations required by the 3S-IMP approach to reach the convergence, which goes from 95 (with r = 5) to 15 (with r = 50).

LM model with individual covariates

For the extended LM model with individual covariates illustrated in Section [\ref=sec:lmcov], the benchmark design, which corresponds to Scenario 1 of the basic LM model, is based on the following setting:

sample size: n = 500;

number of time occasions: T = 5;

number of response variables: r = 5,10,20,50;

number of categories of the response variables: cj = 2, [formula];

number of latent states: k = 2;

number of covariates affecting the initial probabilities: q1  =  2;

number of covariates affecting the transition probabilities: q2  =  2;

conditional response probability matrix: [formula];

[formula];

[formula].

As for the basic LM model, the estimation results are based on 100 simulated samples; moreover, the individual covariates have been generated from an AR(1) process with autoregressive parameters equal to 0.5 and a gaussian noise process with variance equal to 1.

Table [\ref=tab:Phicov], in which are reported the results of the FML and the 3S estimators of the probabilities φjy|u for r = 5, confirms that the proposed approach leads again to consistent estimates of the conditional response probabilities.

Table [\ref=tab:becov] shows the estimation results of parameters in β obtained by the two methods. From the table, we note that the 3S estimator has a low bias when r  ≥  20. Moreover, we observe a much lower bias of the 3S-IMP estimator, whose behavior is similar to that of the FML estimator. The standard error and the root mean square error decrease as the number of response variables increases.

Regarding the three-step estimation of parameters in Γ, we observe that the bias (and the root mean square error) may be large with a few response variables for each time occasion (see Table [\ref=tab:Gacov]), but it decreases with r and it is negligible for r = 50. Moreover, we note an improvement from the 3S to the 3S-IMP version of the algorithm. Scenario 2 of the Monte Carlo simulation study is based on a lower persistence of the Markov chain, that is obtained by letting the parameters in Γ to be equal to:

[formula]

As for the basic LM model, the estimation results of φjy|u and β do not differ much from those obtained in the benchmark design. We then report here only the results referred to the estimation of parameters in Γ; see Table [\ref=tab:Gacov2]. In particular, when the Markov chain presents a lower persistence, we observe an improvement of the performance of the proposed estimator, and smaller differences, in terms of bias and root mean square error, with respect to the FML estimation method, especially with a large number of response variables. We also observe smaller differences between the two versions of the three-step estimation approach, 3S and 3S-IMP.

Under the third scenario, we evaluate the performance of the estimation algorithms with more separated latent states. In particular, the parameters of the simulation study remain the same as in the benchmark design, apart from the conditional probability matrix, that is the same as in Scenario 3 of the basic LM model (Section [\ref=sec:5basic]). Even in this context, the conditional response probabilities are consistently estimated by the three-step approach. Moreover, we observe very small differences between the results obtained by the FML estimator and the 3S and 3S-IMP estimators of parameters in β. Even the 3S estimator of Γ is affected by the presence of more separated latent states, with a general improvement of its performances (Table [\ref=tab:Gacov3]), especially with large r.

Under Scenario 4 we assess the effect of a larger number of latent states on the performances of the estimators, by considering the following setting:

number of latent states: k = 3;

conditional response probability matrix: [formula];

[formula];

[formula].

The remaining parameters are left unchanged with respect to Scenario 1. Even under this scenario, we can get the same conclusion about estimation of φjy|u and β as in the previous scenarios. About estimation of parameters in Γ, from Table [\ref=tab:Gacov4], in which we report only the results for r = 5 and r = 50 for reason of space, we observe that the bias of the proposed estimator is quite high for r = 5 but it becomes negligible for larger r, even in the standard version (3S) of the estimator. The behavior of the 3S and 3S-IMP methods, in terms of standard error and root mean square error, is comparable with those of the FML approach.

As demonstrated in the context of LC models by [\cite=bolck:et:al:04] and, more recently, by [\cite=vermunt:2010] and [\cite=bakk:et:al:13], all the results above show a bias in the parameter estimates due to the classification error introduced in the second step, which confirms that, in general, the three-step approach underestimates the relationship between covariates and class membership. We note this bias in the estimates of the parameters affecting both the initial and transition probabilities. As already stated, this bias becomes negligible when the number of response variables increases; moreover, the proposed 3S-IMP version allows us to obtain an improvement of the behavior of the corresponding estimator, with a less evident bias.

Finally, the inclusion of individual covariates confirms the advantages, in term of computational cost, of the three-step estimation method with respect to the full likelihood method. In all scenarios, the computing time required by both 3S and 3S-IMP algorithms is significantly lower than that required by the FML algorithm. The number of iterations required by the 3S-IMP version for convergence goes from a maximum of 37 (with r = 5 in Scenario 4) to a minimum of 1 (with r = 50 in Scenario 3).

Empirical illustration

In order to illustrate the proposed estimation approach, we outline an application based on a real dataset which is derived from a project, named ULISSE ("Un Link Informatico sui Servizi Sanitari Esistenti per l'Anziano" - "A Computerized Network on Health Care Services for Older People") aimed at studying the health status of elderly patients who currently receive health care assistance in Italy; see [\cite=lattanzio2010]. In the analysis here presented, we consider only data referred to the health condition of patients hosted in 26 nursing homes, which cover n = 911 patients. The project is based on a longitudinal survey in which the patients were evaluated at admission and then re-evaluated at 6 and 12 month after the admission; therefore we consider T = 3 time occasions.

The original questionnaire is made of r = 75 polytomously-responded items, with categories ordered according to increasing difficulty levels in accomplishing a certain task or severeness of a specific aspect of the health conditions. These items are grouped into eight different sections of the questionnaire, concerning:

Cognitive Conditions (CC);

Auditory and View Fields (AVF);

Humor and Behavioral Disorders (HBD);

Activities of Daily Living (ADL);

Incontinence (I);

Nutritional Field (NF);

Dental Disorder (DD);

Skin Conditions (SC).

The complete list of items for each section, with the corresponding number of responses categories, is reported in Appendix. In this application, the missing responses to a given item are dealt with the missing at random assumption [\citep=rubin:76] [\citep=litl:rubin:1987].

The extended LM model allows us to consider time-constant and time-varying individual covariates. In particular, among time-constant covariates we include gender, and dummy variables for coding the nursing home to which the subject belongs, whereas among time-varying covariates we include age and time interval between occasions of administration of the questionnaire. Accordingly, we have p1 = 27 covariates affecting the logit for the initial probabilities and p2 = 28 covariates affecting the logit for the transition probabilities. In order to make the model more parsimonious, we rely on the following parameterization for the transition probabilities, that is, a multinomial logit based on the difference between two sets of parameters

[formula]

where γ11 = 0 to ensure model identifiability. The parameterization used for modeling the initial probabilities is again based on standard multinomial logit, as defined in ([\ref=eq:be]). For this illustration we consider a fixed number of latent classes, k = 4. Even considering the above parametrization, the number of free parameters to be estimated is very large and the computing time required by the full likelihood approach may become excessive, especially because the EM algorithm requires a large number of random initializations to increase the chance of the convergence to the global maximum of the model log-likelihood. In such a context, the computational cost of the three-step algorithm is significantly lower than that of the full likelihood approach, while reaching very similar performance in terms of parameter estimates.

In applying the three-step estimation method to this data, we first fit the basic LC model for the set of response variables, in which the responses provided by the same subject at different occasions are considered as corresponding to separate sample units. By using this approach, we can initialize the EM algorithm by a number of random starting values equal to 100(k - 1) and take the estimates corresponding to the highest log-likelihood at convergence of the algorithm.

From the first step of the proposed approach we obtain the final estimates of the conditional response probabilities. Since the items are categorical, with a different number of categories, we compute the following item mean score to make the interpretation of the results easier:

[formula]

In particular, a value of j|u close to 0 corresponds to a low probability of suffering from a certain pathology, whereas a value close to 1 corresponds to a high probability of suffering from the same pathology. To summarize these results, we also compute the section mean score d|u as the average of j|u for the items composing each section d of the questionnaire, with [formula].

In order to interpret the results we order the latent states on the basis of the values of d|u assumed in the section denoted by ADL (Activity of Daily Living) of the questionnaire, which is the section with the highest difference between the maximum and the minimum value of the section mean score across states. For each latent state, Table [\ref=tab:average] shows the values of d|u, together with the difference between the maximum and the minimum value of d|u for each section of the questionnaire.

As we can see, smaller differences are observed for sections DD, SC, NF, and HBD which, consequently, tend to discriminate less between subjects with respect to the other sections. The first state corresponds to the best health conditions with respect to all the pathologies measured by the sections of the questionnaire, apart from DD and SC. On the other hand, the fourth state corresponds to cases with the worst health conditions for almost all the pathologies. Intermediate states show a different case-mix depending on the section mean score pattern. In particular, the second state corresponds to patients with poor cognitive and auditory and view conditions (CC and AVF). The third state corresponds to patients with deteriorated physical conditions with respect to the pathologies measured by section ADL.

Once the conditional response probabilities are estimated by the first step of the proposed approach, we can estimate the parameters [formula], γ0uv and γ1u by fitting multinomial logit models with weights. In Table [\ref=tab:beGa] we report the results of this step. The same table also shows the significance of the estimates. The standard errors of the estimates has been obtained by a non-parametric bootstrap based on 99 samples. Note that, in this application, a bootstrap resampling procedure in which the parameters are estimated by means of the full likelihood approach is unfeasible, due to the considerable computational cost required by this approach.

From the table we note that gender has a significant effect on the logit of the initial probability, especially on the probability of being in the last state with respect to the first. The same can be said for age, which also shows a significant effect on the transition probabilities. Moreover, we note that certain nursing homes have a higher effect on both the initial and transition probabilities with respect to others. In such a context, it may be of interest to study the ability of the facilities to retain over time patients in the initial latent state.

For an easier interpretation of the results, we also report the estimated initial and transition probabilities of the latent Markov process. More in detail, Table [\ref=tab:init] shows the means of the estimated initial probabilities, u, [formula], with k = 4, for age classes and gender. The results show that, at the beginning of the study, males have a higher probability of being in the first state, which corresponds to the best health condition, with respect to females. This is reasonable, as the health status of women who require admission to nursing homes is likely worse than that of men of the same age. This because women are typically more able to take care of themselves. Moreover, it is obvious that older patients (both male and female) have a higher probability of being in in fifth state, corresponding to the worse health condition.

In Table [\ref=tab:trans_all] we report the overall means of the estimated transition probabilities, (t)v|u, for all subjects in the sample, whereas in Table [\ref=tab:trans_nh] we report the means of (t)v|u computed for two nursing homes with a similar number of patients but with different estimated transition matrices.

According to the tables, we observe a quite high persistence in the same state, especially for the first and the last state. Moreover, patients classified in the second state present an average transition probability toward the fourth state, corresponding to severe health conditions, of around 0.15. We also note a very low probability of transition from higher to lower states, meaning that it is quite unlikely an improvement of the patients health conditions. This probability drops to zero when we consider the transition from the fourth state to the first state, corresponding to the best health status. We finally observe that different nursing homes may have a very different behavior. As an example, nursing home nh3 presents a low persistence in the first latent state with a quite high probability of transition toward the second and the third latent states (between 0.2 and 0.3). On the other hand, nursing home nh25 presents very high persistence probabilities. Moreover, the transition probabilities toward latent states corresponding to deteriorated conditions are alway lower than 0.05.

Conclusions and further developments

In this paper, we propose an extended version of the three-step approach [\citep=vermunt:2010] to estimate LM models, which are typically used in applications involving longitudinal data. In such a context, it is not uncommon that the number of response variables for each time occasion is very large, and many latent states are specified. Moreover, time-constant and time-varying individual covariates may be included in the model.

The proposed estimation method may represent a valid alternative to the full maximum likelihood approach, which is typically based on the EM algorithm. More in detail, when applied to LM models, the proposed three-step estimation consists of a preliminary clustering of the subjects, on the basis of the time specific responses only, in which the responses provided by the same subject to different time occasions are considered as separated units. Moreover, every sample unit is not strictly assigned to a latent state at each occasion, and this state may change across time, so as to allow the estimation of the parameters of the latent Markov process. We also propose an improved version of the three-step estimator, in which the last two steps of the algorithm are iterated until convergence, while keeping fixed the results from the first step.

We provide a proof that this approach leads to consistent estimates of the conditional response probabilities. Moreover, when the number of response variables tends to infinity, even the parameters of the latent process are consistently estimated.

We perform a simulation study aimed at assessing the behavior of the proposed estimation algorithms under different scenarios, in comparison with that of the full maximum likelihood approach. On the basis of the results of this study, it is possible to conclude that the behavior, in terms of bias and root mean square error, of the three-step estimator improves with the number of response variables, with the separation between latent states, and as the level of persistence of the latent Markov chain decreases. Moreover, we observe that, under certain scenarios, the improved version of the three-step method outperforms the standard one, even significantly, with a reduction of the bias, already detected in the context of LC model, in the estimates of the relationship between class membership and covariates [\citep=bolck:et:al:04] [\citep=vermunt:2010] [\citep=bakk:et:al:13].

The potential of the proposed approach is also illustrated with an application to real data, involving a very large number of response variables and individual covariates. In such a complex study, we observe that the proposed three-step estimation method may overcome some of the typical drawbacks of the full likelihood estimation, first of all the slowness to converge and the presence of many local maxima. Moreover, a bootstrap resampling procedure aimed at computing the standard errors of the estimates may be performed with a reasonable effort. The advantage in terms of computational cost may also be exploited to perform cross-validation, so as to select the number of latent states [\citep=smyth:00]. Finally, the results of the three-step estimation method may be used to define sensible starting values of the EM algorithm in the full maximum likelihood approach, so as to prevent the problem of the multimodality of the model log-likelihood. All these advantages are obtained while having very similar results in terms of parameter estimates.

Finally, It is worth noting that, throughout the paper, we consider the case of categorical response variables because this is the typical case of application of LM models. However, we plan to extend the proposed estimation approach when the outcomes are all continuous, or in the case of mixed outcomes, and of latent variables with different state spaces. Moreover, further research is necessary to find a method for easily obtaining reliable standard errors for the parameter estimates, without the need of implementing a bootstrap procedure.

Appendix