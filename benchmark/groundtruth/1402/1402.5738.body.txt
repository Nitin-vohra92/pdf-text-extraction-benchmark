Lemma Corollary Proposition Remark

On the mean number of 2-torsion elements in the class groups, narrow class groups, and ideal groups of cubic orders and fields

Introduction

For an order O in a number field K, let Cl(O) and Cl+(O) denote the class group and the narrow class group of O respectively. If O is the maximal order of K, then one defines the class group and narrow class group of K by Cl(K): = Cl(O) and Cl+(K): = Cl+(O). Finally, for any prime p let Clp(O), Cl+p(O), Clp(K), and Cl+p(K) denote the p-torsion subgroups of Cl(O), Cl+(O), Cl(K), and Cl+(K), respectively.

In this article, we begin by proving:

When the set of isomorphism classes of cubic fields satisfying any specified set of local conditions at any finite set of primes are ordered by their absolute discriminants:

The average number of 2-torsion elements in the class groups of such totally real cubic fields is 5 / 4.

The average number of 2-torsion elements in the (narrow) class groups of such complex cubic fields is 3 / 2.

The average number of 2-torsion elements in the narrow class groups of such totally real cubic fields is 2.

Thus, the average number of 2-torsion elements in the class groups or narrow class groups of cubic fields of given real signature remains the same, regardless of which family of cubic fields we are averaging over.

In the case where no local specifications are made in Theorem [\ref=cgvsncg] (i.e., where we average over all cubic fields), parts (a) and (b) of Theorem [\ref=cgvsncg] were first proven in [\cite=density] by rather indirect methods, and confirmed a special case of the Cohen-Martinet-Malle heuristics (see [\cite=CM] [\cite=Malle]). In the current paper, we generalize these results using a more direct correspondence (see Theorem [\ref=potqfideal]), which additionally allows us to obtain Theorem [\ref=cgvsncg](c), and indeed Theorems [\ref=cgvsncg](a)-(c) for general families of cubic fields defined by local conditions at finitely many primes. Our current method is more direct in the sense that, not only does it yield a count of all the 2-torsion elements in class groups and narrow class groups in various families of cubic fields, but it in fact gives an explicit construction of these elements.

This direct correspondence also allows us to study on average how many ideal classes of order 2 in the class groups of cubic orders arise simply because there exists an ideal of order 2 representing it. Recall that the ideal group I(O) of an order O is the group of invertible fractional ideals of O, of which the class group Cl(O) is a quotient. If an order O is not maximal, then it is possible for an ideal I of O to have order 2, i.e., I can be a fractional ideal of O satisfying I2  =  O but I  ≠  O.

For an order O in a number field, let Ip(O) denote the p-torsion subgroup of the ideal group I(O) of O. In [\cite=clorders], we showed that the mean value of the difference |Cl3(O)|  -  |I3(O)| is always equal to 1, regardless of whether one averages over the maximal orders in complex quadratic fields, over all orders in such fields, or even over very general families of complex quadratic orders defined by local conditions. Similarly, for very general families of real quadratic orders defined by local conditions, we showed that the mean value of the difference [formula] is always equal to 1, independent of the family.

In this article, we prove the analogues of these results for the 2-torsion elements in the class groups and ideal groups of cubic orders. To state the result, we require just a bit of notation. For each prime p, let Σp be any set of isomorphism classes of orders in étale cubic algebras over [formula]. We say that the collection (Σp) of local specifications is acceptable if, for all sufficiently large p, the set Σp contains all maximal cubic rings over [formula], or at least all those maximal cubic rings over [formula] that are not totally ramified at p. Then we prove:

Let (Σp) be any acceptable collection of local specifications as above, and let Σ denote the set of all isomorphism classes of cubic orders O such that [formula] for all p. Then, when orders in Σ are ordered by their absolute discriminants:

The average size of [formula] for totally real cubic orders O in Σ is 1.

The average size of [formula] for complex cubic orders O in Σ is 1.

The average size of |Cl+2(O)| - |I2(O)| for totally real cubic orders O in Σ is 1.

It is rather intriguing that the mean values in Theorem [\ref=diff] remain the same regardless of the choice (Σp) of acceptable local specifications for the cubic orders being averaged over. If (Σp) is acceptable and each Σp consists only of maximal cubic rings over [formula], then we recover (a more general version of) Theorem [\ref=cgvsncg], since the only 2-torsion element of the ideal group of a maximal order is the trivial ideal.

Theorem [\ref=cgvsncg] immediately implies that most cubic fields have odd class number. More precisely:

A positive proportion (at least 75%) of totally real cubic fields have odd class number.

A positive proportion (at least 50%) of complex cubic fields have odd class number.

We now compare the class group with the narrow class group. For orders O in number fields with predominantly real places, such as totally real number fields, it is natural to expect the narrow class group to be strictly larger than the class group, since one is forming a quotient of IØ by principal ideals satisfying much more stringent conditions. In the quadratic case, this expectation is supported by:

When ordered by their discriminants, a density of 100% of real quadratic fields F satisfy Cl(F)  ≠  Cl+(F).

In fact, since in the real quadratic case the size of the narrow class group is either the same as or twice the size of the class group, it is natural to try and distinguish these two groups just based on the sizes of their 2-torsion subgroups. We have:

When ordered by their discriminants, a density of 100% of real quadratic fields F satisfy Cl2(F)  ≠  Cl+2(F).

Now recall that for any number field L with r distinct real embeddings, there is a signature homomorphism :O×L  →  {  ±  1}r that takes a unit of L--i.e., an invertible element of the ring of integers OL of L--to its sign (one sign for each of the real embeddings [formula]); a unit u has mixed signature if [formula], i.e., if there exist two real embeddings [formula] such that σ±(u)  =    ±  1. Then, in terms of units of quadratic fields, we have:

When ordered by their discriminants, a density of 0% of real quadratic fields have a unit of mixed signature.

Thus, at least asymptotically, we completely understand the question of how often the class group and narrow class group differ for real quadratic fields. Namely, 100% of the time, the narrow class group looks like the class group with one extra 2-torsion factor.

Theorems 4 and 5 are well-known and easily proven; they are true primarily because for most d there are local obstructions to having a solution to the negative norm unit equation x2 - dy2 =  - 4. Also, the 2-torsion elements in class groups and narrow class groups in the quadratic case are mostly governed by genus theory. One of the reasons Cohen and Lenstra did not formulate heuristics for narrow class groups in the quadratic case is that these groups differ from class groups of quadratic fields only in their 2-parts, which are related to genus theory. From this point of view, when computing narrow class groups vs. class groups, it is natural to try and investigate a case where 2 is unrelated to genus theory--for example, the case of cubic fields, to which we now turn.

A classical theorem of Armitage and Frohlich [\cite=AF] states that for cubic fields K. Thus Theorems [\ref=cgvsncg](a) and [\ref=cgvsncg](c), when taken together, immediately imply:

A positive proportion (at least 50%) of totally real cubic fields K satisfy Cl2(K)  ≠  Cl+2(K).

A positive proportion (at least 25%) of totally real cubic fields K satisfy Cl2(K) = Cl+2(K).

Note that Corollary [\ref=contrast] for cubic fields is in stark contrast to Theorem [\ref=quad2] for quadratic fields.

As far as the existence of units of mixed type in cubic fields, we have:

A positive proportion (at least 50%) of totally real cubic fields K do not possess units of every possible signature.

A positive proportion (at least 75%) of totally real cubic fields K possess units of mixed signature.

Note again the stark contrast between Corollary [\ref=mixed2] and the corresponding situation in Corollary [\ref=quadmixed] for quadratic fields. Corollaries [\ref=odd] and [\ref=nocontrast]-[\ref=mixed2] continue to hold, with the same percentages, even when one averages over just those cubic fields satisfying any desired set of local conditions at a finite set of primes, or more generally over any acceptable family of maximal cubic orders (allowing us to consider families of cubic fields satisfying suitable infinite sets of local conditions).

We prove Theorems [\ref=cgvsncg] and [\ref=diff] and their corollaries as an application of a composition law on a prehomogeneous vector space that was investigated in [\cite=Bhargava1]. We lay down the relevant preliminaries about this law of composition, defined on pairs of ternary quadratic forms, in Section 2; more precisely, we give a correspondence between pairs of ternary quadratic forms and 2-torsion elements in class groups of cubic rings over a principal ideal domain. This allows us to describe a composition law on certain integer-matrix pairs of ternary quadratic forms in Section 3, leading to groups that are closely related to both the class groups and (with some additional effort) the narrow class groups of orders in cubic fields. In Section 4, we focus on the composition law on reducible pairs of ternary quadratic forms, which leads to groups that are closely related to the ideal groups of orders in cubic fields. In Section 5, we describe how one can count the appropriate integer points in this prehomogeneous vector space using the results of [\cite=density]. By counting these configurations of points, we then complete the proofs of Theorems [\ref=cgvsncg] and [\ref=diff] in Section 6. Finally, we deduce Corollaries [\ref=odd] and [\ref=nocontrast]-[\ref=mixed2] in Section 7.

Parametrization of order 2 ideal classes in cubic orders

The key ingredient in the proof of Theorem [\ref=cgvsncg] is a parametrization of ideal classes of order 2 in cubic rings by means of equivalence classes of pairs of integer-matrix ternary quadratic forms, which was obtained in [\cite=Bhargava1]. We begin by describing this orbit space briefly.

If T is a principal ideal domain, then let [formula] denote the space of pairs (A,B) of ternary quadratic forms over T. We write an element (A,B)∈VT as a pair of 3  ×  3 symmetric matrices with coefficients in T as follows:

[formula]

In particular, the elements of [formula] are called pairs (A,B) of integer-matrix ternary quadratic forms.

The group GL2(T)  ×  GL3(T) acts naturally on the space VT. Namely, an element g2∈GL2(T) acts by changing the basis of the rank 2 T-module of forms spanned by (A,B); more precisely, if [formula], then we set g2  ·  (A,B) = (rA - sB, - tA + uB). Similarly, an element g3∈GL3(T) changes the basis of the rank 3 T-module on which the forms A and B take values; we have g3  ·  (A,B) = (g3Agt3,g3Bgt3). It is easy to see that these actions of g2 and g3 commute, leading to an action of GL2(T)  ×  GL3(T). However, this action is not faithful in general. If we let

[formula]

then for all principal ideal domains T, the group GT acts faithfully on VT.

The action of [formula] on [formula] turns out to have a unique polynomial invariant (see, e.g., Sato-Kimura [\cite=SatoKimura]); i.e., the ring of all polynomial functions on [formula] that are invariant under the action of [formula] is generated by one element. This generating element can be defined naturally over [formula], or indeed, over any principal ideal domain T.

To construct this fundamental invariant, we notice first that the action of [formula] on [formula] has four independent polynomial invariants, namely the coefficients a,b,c,d of the binary cubic form

[formula]

where [formula]. For an element (A,B)∈VT, we call f(x,y) as defined by ([\ref=fdef]) the binary cubic form invariant of (A,B). An element γ∈GL2(T) then acts on the binary cubic form invariant f(x,y) by γ  ·  f(x,y): = f((x,y)γ).

Now it is well-known that the action of [formula] on the space of complex binary cubic forms has a unique polynomial invariant (up to scaling), namely its discriminant Disc(f). The unique polynomial invariant for the action of [formula] on [formula] is then given by Disc(A,B): = Disc(Det(Ax  -  By)), which is an integer polynomial of degree 12 in the entries of A and B.

For (A,B)∈VT, we call this fundamental invariant Disc(A,B) the discriminant of (A,B). Note that for any (g2,g3)∈GL2(T)  ×  GL3(T) and (A,B)∈VT, we have

[formula]

and thus Disc(A,B) is also a relative invariant for the action of GT on VT. We say that (A,B)∈VT is nondegenerate if it has nonzero discriminant.

The orbits of GT on VT have an important arithmetic significance, namely they essentially parametrize order 2 ideal classes in cubic rings over T. Recall that a cubic ring over T is any ring with unit that is free of rank 3 as a T-module; for example, an order in a cubic number field is a cubic ring over [formula]. In 1964, Delone and Faddeev [\cite=DF] showed that orders in cubic fields are parametrized by irreducible integral binary cubic forms; this was recently extended to general cubic rings and general binary cubic forms by Gan, Gross, and Savin [\cite=GGS] (see also the work of Gross and Lucianovic [\cite=GL]).

We have observed above that a pair (A,B)∈VT of ternary quadratic forms yields a binary cubic form invariant f over T, and thus we naturally obtain a cubic ring R(f) over T from an element (A,B)∈VT via the Gan-Gross-Savin parametrization described above. We say that a cubic ring over T is nondegenerate if it has nonzero discriminant.

We now describe a precise correspondence between nondegenerate pairs of ternary quadratic forms in VT and ideal classes "of order 2" in the corresponding cubic rings over a principal ideal domain T. To simplify the statement, we assume that we have a set S of representatives in [formula] for the left action of T× on [formula]. For example, if [formula], then we will always take S to be the set of positive elements of [formula]; similarly, if [formula], then S will always be chosen to consist of the powers of p in [formula]; and if T is a field, then we will always take S = {1}. For an ideal I of a cubic ring R over T, we use NS(I) to denote the unique generator in S of the usual ideal norm of I viewed as a T-ideal. (When the choice of S is clear, as in the case of [formula], [formula], or a field, then we usually drop it from the notation.) Then we have the following generalization of [\cite=Bhargava1]:

Let T and S be as above. Then there is a bijection between the set of nondegenerate GT-orbits on the space [formula] and the set of equivalence classes of triples (R,I,δ), where R is a nondegenerate cubic ring over T,  I is an ideal of R having rank 3 as a T-module, and δ is an invertible element of [formula] such that I2  ⊆  (δ) and NS(I)2   =   N(δ). (Here two triples (R,I,δ) and (R',I',δ') are equivalent if there exists an isomorphism φ:R  →  R' and an element [formula] such that I' = κφ(I) and δ' = κ2φ(δ).)

The proof of Theorem [\ref=potqfideal] is identical to that given in [\cite=Bhargava1] (with a suitable change to the definition of orientation, described below). We briefly sketch the bijective map for general T.

Given a triple (R,I,δ) over T, we construct the corresponding pair of ternary quadratic forms over T as follows. First, we may write R  =  T  +  Tω  +  Tθ where 〈1,ω,θ〉 is a normal basis, i.e., ωθ∈T. Furthermore, we can write I  =  Tα1  +  Tα2  +  Tα3, where 〈α1,α2,α3〉 has the same orientation as 〈1,ω,θ〉, i.e., the change-of-basis matrix from 〈1,ω,θ〉 to 〈α1,α2,α3〉 has determinant lying in our fixed choice S of representatives in [formula] for the left action of T× on [formula]. Since I2  ⊆  δR, we have for all i,j∈{1,2,3} that

[formula]

where aij,bij,cij∈T. Then [formula] yields the desired pair of symmetric 3  ×  3 matrices over T. In basis-free terms, (A,B) corresponds to the symmetric bilinear map of T-modules

[formula]

On the other hand, if (A,B)∈VT is a pair of ternary quadratic forms over T, and f(A,B)(x,y)  =  Det(Ax  -  By)  =  ax3  +  bx2y  +  cxy2  +  dy3 is the associated binary cubic form with coefficients a,b,c,d∈T, then R  =  R(f(A,B)) is the cubic ring with basis 〈1,ω,θ〉 satisfying

[formula]

In order to describe I in terms of a basis 〈α1,α2,α3〉, it suffices to show that all cij and δ in ([\ref=above]) are uniquely determined by (A,B). First, one shows using Equation ([\ref=above]), together with the associative law on triple products (δ- 1αi)(δ- 1αj)(δ- 1αk), that the cij can be written explicitly as

[formula]

where [formula] denotes the sign of the permutation of (123) described by the top row. The system of equations given in ([\ref=above]) shows that for each j∈{1,2,3}, we have

[formula]

The ratios are independent of the choice of j, and so this determines 〈α1,α2,α3〉 uniquely up to a scalar factor in [formula]. Once we fix a choice of 〈α1,α2,α3〉, Equation ([\ref=above]) then uniquely determines [formula]. The R-ideal structure of the T-module I is given by [\cite=Bhargava1]. This completely and explicitly determines the triple (R,I,δ) from the pair (A,B) of ternary quadratic forms.

Finally, we describe the action of GL2(T)  ×  GL3(T) on the bases of R / T and I corresponding to the action of the same group on pairs (A,B) of ternary quadratic forms over T described previously. If g2∈GL2(T) is the matrix [formula], then it acts on the normal basis of R / T  =  〈ω,θ〉 and the T-basis 〈α1,α2,α3〉 of the ideal I by

[formula]

On the other hand, g3∈GL3(T) acts on the bases 〈ω,θ〉 and 〈α1,α2,α3〉 by

[formula]

One now easily checks that the equivalence defined on triples (R,I,δ) in the statement of the theorem exactly corresponds to GT-equivalence on pairs (A,B)∈VT of ternary quadratic forms over T.

The following corollary of Theorem [\ref=potqfideal] describes the stabilizer in GT of an element (A,B)∈VT:

The stabilizer in GT of a nondegenerate element (A,B)∈VT is given by the semidirect product

[formula]

where: (R,I,δ) is the triple corresponding to (A,B) as in Theorem [formula]; Aut(R;I,δ) is the group [formula]; R0  =  EndR(I) is the endomorphism ring of I; and U+2(R0) denotes the group of units of R0 having order dividing 2 and norm 1.

First, note that the elements of GL2(T)  ×  GL3(T) that preserve the bases of R / T and I under the action described by ([\ref=g2action]) and ([\ref=g3action]) are exactly the elements of

[formula]

That is, C(T) acts pointwise trivially on VT. This implies that if g∈GL2(T)  ×  GL3(T), then any element of the coset g  ·  C(T) acts on the bases of R / T and I in the same way that g acts. Furthermore, if the actions of g,g'∈GL2(T)  ×  GL3(T) are distinct on the bases of R / T and I, then g'∉g  ·  C(T). Thus, it suffices to compute the number of distinct actions on the bases of R / T and I by elements g∈GL2(T)  ×  GL3(T) that preserve A = (aij) and B = (bij) in ([\ref=above]), in order to compute the number of cosets g  ·  C(T) in the stabilizer in GL2(T)  ×  GL3(T) of an element (A,B)∈VT.

Now suppose g  =  (g2,g3)∈GL2(T)  ×  GL3(T) preserves a pair (A,B). In terms of the corresponding triple (R,I,δ), g acts on the basis of R / T as described in Equations ([\ref=g2action]) and ([\ref=g3action]), which induces an automorphism φ of R. As g must preserve the triple (R,I,δ) up to equivalence, we see that φ∈Aut(R;I,δ), i.e., there exists [formula] such that φ(I) = κI and φ(δ) = κ2δ. To preserve the structure coefficients bij and aij in ([\ref=above]), the change of basis of R / T corresponding to the element φ∈Aut(R;I,δ) then uniquely determines the change of basis for I (namely, α  ↦  κ- 1φ(α) for α∈I, assuming we keep δ the same in ([\ref=above])), up to transformations on the basis of I that act via multiplication by an element of U+2(EndR(I)). This is the desired conclusion.

Composition of pairs of integer-matrix forms and (narrow) 2-class groups

Let us now restrict ourselves to those cubic rings R over the base ring [formula] that are orders in S3-cubic fields. It is known that, when ordered by absolute discriminant, such S3-cubic orders constitute a proportion of 100% of all orders in cubic fields (since orders in abelian cubic fields are negligible in number,  in comparison). Note that the automorphism group Aut(R) of an S3-cubic order R is trivial.

Let us say that a triple (R,I,δ) is projective if I is projective as an R-module (i.e., if I is invertible as a fractional ideal of R); in such a case we have I2 = (δ). For a fixed S3-cubic order R, we therefore obtain a natural law of composition on equivalence classes of projective triples (R,I,δ), defined by

[formula]

The equivalence classes of projective triples (R,I,δ) then form a group under this composition law, which we denote by H(R).

Let us say that a pair [formula] is projective if the corresponding (R,I,δ), under the bijection of Theorem [\ref=potqfideal], is projective. We then also obtain a composition law on projective equivalence classes of pairs (A,B) of ternary quadratic forms having binary cubic form invariant equal to a given f, where [formula] (a higher degree analogue of Gauss composition). We denote the corresponding group on such equivalence classes of (A,B) also by H(R).

Fix an S3-cubic order R. Let U denote the unit group of R, and let [formula] denote the subgroup of those units having positive norm. Then we have an exact sequence

[formula]

where U2 denotes the subgroup of U consisting of square units.

If R is an order in a totally real cubic field, then the group [formula] has order 4. Meanwhile, if R is an order in a complex cubic field, then the latter group has order 2. We thus obtain:

We have |H(R)| = 4  ·  |Cl2(R)| when R is an order in a totally real S3-cubic field, and |H(R)| = 2  ·  |Cl2(R)| when R is an order in a complex cubic field.

Equation ([\ref=hr]) and Lemma [\ref=hr2] thus make precise the relationship between H(R) and Cl2(R).

If we further assume that R is an order in a totally real S3-cubic field, we can restrict to the group H+(R)  ⊂  H(R) consisting of those triples (R,I,δ) in which δ is totally positive. The group H+(R) turns out to be closely related to the group Cl+2(R); in particular, we find:

Let R be an order in a totally real S3-cubic field, and let H+(R) be the subgroup of H(R) = {(R,I,δ)} where δ is totally positive. Then |H+(R)|  =  |Cl+2(R)|.

Let U again denote the unit group of R, and let [formula] denote the subgroup of totally positive units. Let [formula] denote the signature homomorphism that takes a unit to its sign (one sign for each of the three real embeddings [formula]). Then we have the following commutative triangle of exact sequences:

Here [formula] denotes the group of all equivalence classes of ideals I of R for which there exists a totally positive δ∈R with I2 = (δ). Since [formula], we then also have [formula], and therefore |H+(R)| = |Cl+2(R)|, as desired.

Reducible pairs of ternary quadratic forms

The bijection given in Theorem [\ref=potqfideal] includes all pairs [formula] of integer-matrix ternary quadratic forms--even reducible, i.e., those that share a common rational zero in [formula]. The question then arises: which elements in H(R) correspond to reducible pairs (A,B) of ternary quadratic forms?

Let (A,B) be a projective element of [formula] whose binary cubic form invariant f(A,B) is irreducible over [formula], and let (R,I,δ) denote the corresponding triple as given by Theorem [formula]. Then (A,B) has a rational zero in [formula] if and only if δ is a square in [formula].

Suppose δ = r2 for some invertible [formula]. Then by replacing I by r- 1I and δ by r- 2δ if necessary, we may assume that δ = 1. Let α1 be the smallest positive element of [formula], and extend to a basis 〈α1,α2,α3〉 of I. By ([\ref=above]), we have that b11  =  0 and a11  =  0, which implies that the associated pair of ternary quadratic forms has a rational zero, namely (1:0:0), in [formula].

Conversely, suppose that A and B have a common rational zero in [formula]. If (R,I,δ) is the corresponding triple, then this means that there exists α∈I such that [formula], where φ is defined as in ([\ref=cf]). Setting α2  =  nδ for some [formula], and taking norms to [formula] on both sides, reveals that N(α)2 = n3N(δ) = n3N(I)2. Thus n = m2 is a square. This implies that δ must be a square in [formula], namely, δ = (α / m)2.

For a cubic order R, let Hred(R) be the subgroup of (equivalence classes of) projective triples (R,I,δ)∈H(R) where δ is a square in [formula]. By the previous lemma, Hred(R) is the subgroup of equivalence classes of projective pairs [formula] for which R(f(A,B))  =  R in their corresponding triple, and such that (A,B) has a rational zero in [formula]. As in the introduction, let I2(R) denote the 2-torsion subgroup of the ideal group of R, i.e., the subgroup of invertible fractional ideals I of R such that I2  =  R. We can then define a map

[formula]

It is evident that [formula]. We show that φ in fact defines an isomorphism between I2(R) and [formula]:

The map φ yields an isomorphism of I2(R) with [formula].

The preimage of the identity (R,R,1)∈H(R) can only contain 2-torsion ideals of the form κ  ·  R where [formula]. To be a 2-torsion ideal, we must have (κR)2  =  R; thus κ2∈R× and so κ∈R×. Therefore, the preimage of the identity is simply the ideal R and the map is injective. To show surjectivity, let [formula]. Since δ is a square by definition, let δ  =  ξ2 and recall that (R,I,δ)  ~  (R,ξ- 1I,1); thus ξ- 1I∈I2(R).

Assume that R is maximal. Then [formula] contains only the identity element of H(R), which can be represented by (R,R,1).

Since maximal orders are Dedekind domains, the only ideal that is 2-torsion in the ideal group of R is R.

Class numbers of pairs of ternary quadratic forms

To prove Theorem [\ref=cgvsncg], we would like to restrict the elements of [formula] under consideration to those that are "irreducible" in an appropriate sense. More precisely, we call a pair (A,B) of integral ternary quadratic forms in [formula] absolutely irreducible if

A and B do not possess a common [formula]-rational zero as conics in [formula]; and

the binary cubic form f(x,y) = Det(Ax - By) is irreducible over [formula].

Next, we note that a pair [formula] of real ternary quadratic forms gives a pair of conics in [formula] which, at least in nondegenerate cases, intersect in four points in [formula]. We call these four points the zeroes of (A,B). The action of [formula] on [formula] is seen to have three distinct orbits of nondegenerate elements, namely the orbits [formula] for i = 0,1,2, where V(i) consists of the elements in [formula] having 4 - 2i real zeroes and i pairs of complex zeroes in [formula].

Now let [formula] be any [formula]-invariant subset defined by finitely many congruence conditions. For each prime p, let Sp denote the p-adic closure of S in [formula], and let Mp(S) denote the "p-adic mass" of Sp in [formula], defined by

[formula]

where Discp(x) denotes the discriminant of [formula] as a power of p, and [formula] denotes the stabilizer of x in [formula].

Setting ni = 24,4,8 for i = 0,1,2 respectively, we may now state the following result counting the number of absolutely irreducible elements [formula], up to [formula]-equivalence, having absolute discriminant at most X.

For any [formula]-invariant subset [formula] defined by finitely many congruence conditions, let N(i)(S;X) denote the number of [formula]-equivalence classes of absolutely irreducible elements [formula] satisfying |Disc(A,B)| < X. Then

[formula]

Let μp(S) denote the p-adic density of the p-adic closure Sp of S in [formula], where we normalize the additive measure μ on [formula] so that [formula]. Then [\cite=density] implies

[formula]

Theorem [\ref=cna] is thus reduced to re-expressing the p-adic density μp(S) in terms of the p-adic mass Mp(S). This is accomplished by the following lemma:

We have

[formula]

We normalize the Haar measure dg on the p-adic group [formula] so that [formula] Since |Disc(x)|- 1p  ·  dx is a [formula]-invariant measure on [formula], we must have for any [formula] of nonzero discriminant that

[formula]

for some constant c. The constant c = c(v0) can be determined by calculating the Jacobian of the change of variable g  ↦  g  ·  v0 from [formula] to [formula]. Now this is an algebraic calculation, involving polynomials in the coordinates on [formula] and [formula]. Since any two choices of v0 are GK-equivalent for some finite extension K of [formula] (since [formula] is a prehomogeneous vector space [\cite=SatoKimura], there is one open orbit over the algebraic closure p of [formula]), and since the Haar measure dg naturally extends to a Haar measure on GK, we conclude that our constant c cannot depend on v0.

It thus suffices to compute the constant c for [formula] which corresponds to the triple [formula]. When p  ≠  2, it can be shown that [formula] is defined simply by conditions modulo p. Indeed, the only cubic ring over [formula] whose reduction modulo p is isomorphic to [formula] is [formula], and the only ideal class of [formula] having rank 3 over [formula] is [formula]. If [formula] reduces to 1 = (1,1,1) modulo p, then δ is in the same squareclass as [formula], and thus the triple [formula] is equivalent to [formula] for odd primes p. When p  =  2, if [formula] reduces to 1  =  (1,1,1) modulo p, then there are 16 choices for the squareclass of [formula]. The group [formula] acts on these 16 squareclasses, and the squareclass of δ = (1,1,1) lies in a single orbit. Furthermore, [formula], for δ in any one of these 16 squareclasses, is simply the stabilizer of that squareclass under this action of S3. It follows by Corollary [\ref=stabcor] and the orbit-stabilizer theorem that the 2-adic mass of [formula]--i.e., the 2-adic mass of the [formula]-orbit of all [formula] corresponding to the triple [formula]--is exactly 1 / 16 of the 2-adic mass of the set of all [formula] whose reduction modulo 2 corresponds to the triple [formula].

Now the cardinality of [formula] is p12. Therefore, if p  ≠  2, then we see that the measure of [formula] in [formula] is equal to p- 12 times the cardinality of [formula] in [formula], where 0 denotes the reduction of v0 modulo p; if p  =  2, then the measure of [formula] is equal to p- 12 times the cardinality of [formula] in [formula] times 1 / 16. Since for our choice of v0, we have [formula] for odd primes p, and [formula], we conclude using Corollary [\ref=stabcor] that [formula] when p  ≠  2, and [formula]. Thus, by the orbit-stabilizer theorem, we obtain

[formula]

since Discp(v0) = 1 for our choice of v0. Thus we must have [formula] for any choice of v0 satisfying Disc(v0)  ≠  0, and the lemma follows.

Returning to the proof of Theorem [\ref=cna], we observe that [formula], and so by Lemma [\ref=ramanujan11], we have

[formula]

yielding Theorem [\ref=cna].

To prove Theorems [\ref=cgvsncg] and [\ref=diff], we choose appropriate sets S on which to apply Theorem [\ref=cna]. This is carried out in the next section.

Proof of Theorems [\ref=cgvsncg] and  [\ref=diff]

Our goal is to count the [formula]-orbits of pairs of forms in [formula] of bounded absolute discriminant that correspond, under the bijection described in Theorem [\ref=potqfideal], to equivalence classes of triples (R,I,δ) where R lies in some acceptable family Σ of cubic orders and I is projective. More precisely, for each prime p, let Σp be a set of isomorphism classes of nondegenerate cubic rings over [formula]. We denote the collection (Σp) of these local specifications over all p by Σ. As in the introduction, we say that the collection Σ = (Σp) is acceptable if, for all sufficiently large p, the set Σp contains all maximal cubic rings over [formula] that are not totally ramified. Finally, for a cubic order R over [formula], we write "R∈Σ" (or say that "R is a Σ-order") if [formula] for all p.

Now fix any acceptable collection Σ = (Σp) of local specifications. Let S = S(Σ) denote the set of all absolutely irreducible elements [formula] such that, in the corresponding triple (R,I,δ), we have that R∈Σ and I is invertible as an ideal class of R (implying that [formula] is the trivial ideal class of [formula]). Then we wish to count N(i)(S(Σ);X), the number of [formula]-equivalence classes of absolutely irreducible elements [formula] satisfying |Disc(A,B)| < X.

Although S might be defined by infinitely many congruence conditions, the estimate provided in [\cite=density] and [\cite=geosieve] (and the fact that Σ is acceptable) implies that Equation ([\ref=ramanujan]) continues to hold for the set S (this follows from an identical argument as in [\cite=density] or [\cite=geosieve]). More precisely,

[formula]

We also have the following algebraic lemma which describes when a pair (A,B) lies in [formula] (i∈{0,1,2}) in terms of the associated triple (R,I,δ):

Let (A,B) be an element of [formula] whose binary cubic form invariant f is irreducible over [formula], and let (R,I,δ) be the corresponding triple as given by Theorem [formula].

If i = 0, then R is an order in a totally real cubic field, and δ is a totally positive element of [formula].

If i = 1, then R is an order in a complex cubic field.

If i = 2, then R is an order in a totally real cubic field, and [formula] is not a totally positive element.

If the binary cubic form invariant f of (A,B) is irreducible over [formula], then the cubic ring R = R(f) is a domain [\cite=DF] (see also [\cite=simple]), and thus an order in a cubic field. To check the assertions about δ, it suffices to base change to the real numbers [formula], where one can simply check the assertion at one point of each of the three orbits V(i) for i = 0, 1, and 2.

Combining Theorem [\ref=redthm] with Lemmas [\ref=hr2], [\ref=hrp], and [\ref=lemma1], we obtain

[formula]

By Theorem [\ref=potqfideal] and Corollary [\ref=stabcor], the p-adic masses of S = S(Σ) defined in ([\ref=massdef]) can be expressed as

[formula]

where the sum is over all equivalence classes of triples (R,I,δ) over [formula] represented in Sp. If R∈Σp is a nondegenerate cubic ring over [formula], then in a corresponding triple (R,I,δ) we can always choose I = R, since I is a principal ideal (recall that invertible means locally principal). The number of elements δ yielding distinct valid triples (R,R,δ) over [formula] (in the sense of Theorem [\ref=potqfideal]), up to equivalence, is equal to the number of Aut(R)-orbits on the set U+(R) / U + (R)×  2, where U+(R) denotes the group of units of R having norm 1. If δ∈U+(R) has image [formula], then the stabilizer of [formula] under this action of Aut(R) is given by Aut(R;R,δ) for any lift δ of [formula]. By the orbit-stabilizer theorem, we then obtain that

[formula]

where the sum is over all isomorphism classes of cubic rings R over [formula] lying in Σp.

Let R be a nondegenerate cubic ring over [formula]. Then

[formula]

is 1 if p  ≠  2, and 4 if p = 2.

The unit group of R, as a multiplicative group, is isomorphic to F'  ×  G', where F' is a finite abelian group and G' is torsion-free and may naturally be viewed as a free rank 3 [formula]-module. Hence the submodule U+(R), consisting of those units having norm 1, is isomorphic to F  ×  G, where F is a finite abelian group and G is free of rank 2 as a [formula]-module.

Let F2 denote the 2-torsion subgroup of F. Since F2 is the kernel of the multiplication-by-2 map on F, it is clear that |F / (2  ·  F)| / |F2| = 1. Therefore, it suffices to check the lemma on the "free" part G of U+(R), namely, on the [formula]-module [formula], where the result is clear. (The case p = 2 differs because, while [formula] for p  ≠  2, the [formula]-module [formula] has index 4 in [formula].)

Combining ([\ref=ramanujangen]), ([\ref=massdef3]), and Lemma [\ref=weird], we obtain

[formula]

Let cΣ denote the Euler product occurring in ([\ref=ramanujan2]), i.e., We now recall the following result from [\cite=simple]:

The number of totally real Σ-orders O with |Disc(O)| < X is [formula].

The number of complex Σ-orders O with |Disc(O)| < X is [formula].

Thus, we may conclude from ([\ref=irredcountgen]), ([\ref=ramanujan2]), and Lemma [\ref=dht] that

[formula]

This proves Theorem [\ref=diff]. Furthermore, when Σ is an acceptable collection of maximal cubic orders, then Theorem [\ref=diff] and Corollary [\ref=maxcase] imply Theorem [\ref=cgvsncg], since |I2(R)| = 1 when R is maximal.

Proofs of Corollaries

We conclude by proving Corollaries [\ref=odd], [\ref=nocontrast], [\ref=contrast], [\ref=mixed1], and [\ref=mixed2]. As remarked in the introduction, we in fact prove a generalization of each of these corollaries. Namely, let Σ be any acceptable collection of local specifications of maximal cubic orders (thus possibly defined by infinitely many local conditions). Then we prove that Corollaries [\ref=odd] and [\ref=nocontrast]-[\ref=mixed2] continue to hold, with the same percentages, for the family of maximal orders defined by any such Σ.

We begin by demonstrating that in the family of all real (resp. complex) cubic fields defined by Σ, a proportion of at least 75% (resp. 50%) have odd class number.

Proof of Corollary [\ref=odd]: Indeed, suppose a lower density of less than 75% (resp. 50%) of totally real (resp. complex) Σ-orders have odd class number. Then an upper density of more than 1/4 (resp. 1/2) of these Σ-orders R would satisfy |Cl2(R)|  ≥  2. Thus the limsup of the average size of |Cl2(R)| would be strictly larger than 1  +  (1 / 4)  =  5 / 4   (resp. 1 + (1 / 2)  =  3 / 2), contradicting Theorem 1(a) (resp. Theorem 1(b)). [formula]

Next, we show that at least 50% of real cubic fields K in the family of cubic fields defined by Σ satisfy Cl2(K)  ≠  Cl+2(K), and at least 25% of such K satisfy Cl2(K) = Cl+2(K).

Proof of Corollary [\ref=nocontrast]: By the theorem of Armitage and Frohlich, for a cubic field K we have either |Cl+2(K)| = |Cl2(K)| or |Cl+2(K)| = 2  ·  |Cl2(K)|. Suppose that a lower density of strictly less than 50% of the totally real cubic fields K defined by Σ satisfy |Cl+2(K)| = 2  ·  |Cl2(K)|. Then, since |Cl2(K)|  ≥  1 for all K, the liminf of the average size of |Cl+2(K)| would be strictly less than the average size of 2  ·  |Cl2(K)| - (1 / 2). However, the average size of 2  ·  |Cl2(K)| - (1 / 2) is 2 by Theorem 1(a), contradicting Theorem 1(c). [formula]

Proof of Corollary [\ref=contrast]: Suppose that an upper density of strictly more than 75% of totally real cubic fields K defined by Σ satisfy |Cl+2(K)|  ≥  2  ·  |Cl2(K)|  ≥  |Cl2(K)| + 1. Then the limsup of the average size of |Cl+2(K)| would be strictly larger than the average size of |Cl2(K)| + (3 / 4), which is 2. This again contradicts Theorem 1(c). [formula]

Finally, we prove that at least 50% of real cubic fields K in the family of cubic fields defined by Σ do not possess units of every possible signature; in addition, at least 75% of such cubic fields K possess units of mixed signature.

Proof of Corollary [\ref=mixed1]: We note that if the class group and narrow class group of a number field K are not isomorphic, then K cannot possess a unit of every possible real signature. Corollary [\ref=nocontrast] now implies the result. [formula]

Proof of Corollary [\ref=mixed2]: By Corollary [\ref=odd], a lower density of at least 75% of cubic fields K have odd class number. For any such cubic field K, the 2-Sylow subgroup of Cl+(K) / Cl(K) will be either trivial or a cyclic group of order 2, by Armitage and Frohlich's theorem. Thus any such cubic field K will contain a unit of mixed signature. [formula]

Acknowledgments

We are very grateful to Benedict Gross, Kiran Kedlaya, Jürgen Klüners, Hendrik Lenstra, Peter Sarnak, Arul Shankar, Christopher Skinner, and Melanie Wood for helpful discussions. The first author was supported by the Packard and Simons Foundations and NSF Grant DMS-1001828. The second author was supported by a National Defense Science & Engineering Fellowship and an NSF Graduate Research Fellowship.