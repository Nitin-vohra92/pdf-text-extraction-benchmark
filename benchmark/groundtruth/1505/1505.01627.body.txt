Bayesian Optimization for Synthetic Gene Design

Introduction

Synthetic biology concerns with the design and construction of new biological elements of living systems and the re-design of existing ones for useful purposes [\cite=Fremont2012]. In this context, there is a current interest in the development of new methods to engineer living cells in order to produce compounds of interest [\cite=export:79443]. A modern approach to this problem is the use of synthetic genes, which once 'inserted' in the cells can modify their natural behavior activating the production of proteins useful for further pharmaceutical purposes.

We present the first approach for gene design based on Bayesian optimization (BO) principles. The BO framework [\cite=68paper] [\cite=journals/corr/abs-1012-2599] [\cite=osborne2010] [\cite=HennigSchuler2012] allows us to explore the gene design space in order to provide rules to build genes with interesting properties, such as genes that are able to produce proteins of interest, or genes able to act on the cell lifespan. We use a Gaussian process [\cite=Rasmussen:2005:GPM:1162254] to emulate the complex behavior of the cell across the different gene designs. An acquisition function is optimized to deal with exploration-exploitation trade-off. To provide, not only rules for gene design, but current gene sequences candidates, we introduce the concept of evaluation function. The goal of this functions is to avoid the bottleneck of optimizing over the sequences by providing rules to rank biologically feasible genes coherent with the obtained gene design rules.

Although in this work we focus on the optimization of the translational efficiency of the cells, this framework can be generalized to multiple synthetic biology design problems, such as the optimization of media design, or the optimization of multiple gene knock-out strategies.

Rewriting the Genetic Code

Broadly speaking, in molecular biology it is assumed that a gene contains the information to encode a mRNA molecule. The production of such molecules is called transcription and takes place in the cell nucleus at certain rate yα. Later on, the mRNA molecules are used to produce proteins at a different rate yβ, in what is called the translation phase. A one-to-one correspondence between genes and proteins is assumed. Each gene, itself, is also made up of a sequence [formula] of several hundreds of bases (A,T,G,C), triplets of which, form the so-called codons. We can interpret the codons like the 'words' in which the genetic code is written. The 64 possible codons encode 20 amino acids, which are the fundamental elements that the cell uses to produce proteins. This means that the genetic code is redundant: the same aminoacid can be encoded by different codons and therefore there exist multiple ways of encoding the same protein. See Figure [\ref=fig1] (top and bottom left) for an illustration of this process. A fundamental of gene design is that redundant codons choices do not affect the type of protein that is being encoded but they may affect the rates yα, yβ, and therefore the efficiency at which it is produced.

Consider a p-dimensional representation ∈I Rp of a gene sequence [formula]. Such a representation will typically be the frequency of the different codons but it may also include other variables like the length of the sequence, or the times a certain pattern is repeated across the gene. Denote by fα,fβ:X  →  I R  ×  I R the functions representing the expected transcription and translation rates given a sequence with features ∈X. We want to solve the global optimization problem of finding the sequence that maximizes both rates. However, this requires optimization across the all possible sequences. This is infeasible due to the high dimensionality. Instead, we aim to solve the surrogate muti-objective problem of finding [formula], to later connect [formula] with a particular gene design.

Method used

Multi-output Gaussian Processes as Cell-behavior Surrogate Model

Let [formula] be a set of gene sequences. Consider a p-dimensional feature representation of the sequences given by [formula] where i∈I Rp. Let α,β∈I RN be the observed transcription and translation rates. Our first goal is to learn from a model of the combined data D  =  {Dα,Dβ}, where Dα  =  {i,yα,i}Ni = 1 and Dβ  =  {i,yβ,i}Ni = 1, how to predict the value of the output functions fα() and fβ() at any ∈I Rp. For simplicity we assume here that both rates are available for all the sequences, but this assumption can be easily relaxed.

A Gaussian process (GP) is a stochastic process with the property that each linear finite-dimensional restriction is multivariate Gaussian [\cite=Rasmussen:2005:GPM:1162254]. GPs are typically used as prior distribution over functions. In the simple output case, the random variables are associated to a single process f evaluated at different [formula] but, this can be easily generalized to multiple outputs, where the random variables are associated to different processes {fl}dl = 1. In our case we have d = 2, which correspond to the two rates of interest. We work therefore with the vector-value function : = (fα,fβ), which is assumed to follow a GP   ≈  (,) where [formula] is a 2-dimensional vector whose components are the mean functions mα, mβ of each output and [formula] is a positive matrix valued function that acts directly on input example and tasks indices. The entries ((,'))l,l' in (,') represent the covariance between fα() and fβ('). Under a Gaussian likelihood assumption, the predictive distribution for a new vector * is taken to be Gaussian such that p((*)|D,,*,φ)  =  N(*(*),*(*,*)) where *(*) and *(*,*) are close expressions that depend on the set of input [formula] and the kernel [formula]. See [\cite=Rasmussen:2005:GPM:1162254] [\cite=Alvarez:2012:KVF:2344402.2344403] for details. φ represents all the parameters of the kernel, which can be built following various strategies. In this work we use a combination of the linear and the intrinsic corregionalization models [\cite=Teh05] [\cite=Alvarez:2012:KVF:2344402.2344403]. We take [formula], where Klin is a linear kernel used to account for the different levels of the rates and Kse a square exponential kernel with a different lengthscale per dimension. lin, se are the corregionalization matrices, which are parametrized as lin  =  linTlin  +  κlin2 and se  =  seTse  +  κse2 for lin,se,κlin,κse∈I R2 and 2 is the identity matrix of dimension 2. [formula] represents the Hadamard product. See Figure [\ref=fig1] (bottom right) for a graphical description of the model.

Acquisition and Evaluation Functions

In multi-task optimization problems a typical issue is to deal with potential conflicting objectives, or tasks that cannot be optimized simultaneously; in our case this means that both rates cannot be optimized simultaneously using the same sequence. Following previous work in multi-task Bayesian optimization [\cite=NIPS2013_5086], here we focus on an acquisition function that maximizes the average of the tasks. The predictive mean and variance of the average objective are [formula], and [formula] Both () and 2(x) can be used in a standard way using any acquisition function acq(), such as the expected improvement (EI) [\cite=68paper].

Consider the optimal gene design given by [formula]. Assume that we are interested in the production of a certain protein whose sequence is k. To improve the sequence k according to the optimal design rules [formula] without changing the nature of the protein, we can interchange redundant codons, that is, codons encoding the same aminoacid. See Figure 1 (bottom right). Given a set of sequences satisfying this criteria, we introduce an evaluation function to rank them in terms of their coherence with the optimal design. In particular we choose [formula] where [formula] is a 'coherent' sequence, the j are the features of [formula], [formula] are the features of the optimal design and wj are weights that we choose to be the inverse lengthscales of the Kse. See Algorithm 1.

Gene Optimization in Mammalian Cells

In this experiment we use Bayesian Optimization to design genes able to optimize the transcription and translation rates of mammalian cells. We use the dataset in [\cite=citeulike:9312122] in which the rates of 3810 genes cells are available. The associated sequences were extracted from http://www.ensembl.org using the first ENSEBL identifier of the database. As features of the model, we used the frequency of appearance the 64 codons, together with the length of the gene, the GC-content, the AT-content, the GC-ratio and the AT-ratio. We randomly sampled 1500 genes that we used to train the model described in Section [\ref=seq:model]. We fit the hyper-parameters of the model by the standard method of maximizing training-set marginal likelihood, using L-BFGS [\cite=citeulike:1284223] for 1,000 iterations and selecting the best of ten random restarts. We select the optimal gene design by means of the expected improvement, which we optimize across all the available genes (both train and test sets) in order to have a way of evaluating the coherence of the result with real experimental data. In Figure [\ref=fig2] (bottom left) we show the scatter plot of the EI evaluated in all gene features vs. the true average of the ratios. The best possible design is selected by the EI criteria. Next, we select 10 difficult-to-express genes by selecting ten random genes among those whose average log ratio is smaller than 1.5. By taking their sequence as a reference we generated 1,000 random sequences (for each gene) able to encode the same protein. All across the sequences, we replace each codon with a redundant one, which is sampled uniformly from the set of codons encoding the same aminoacid. Using the evaluation function in Section ([\ref=sec:ev]) we ranked the sequences and selected the top rated. in Figure 2 (bottom right) we show the true performance of the sequence (experimental value) versus the predicted value of best recombinant sequences. In the ten cases the recombinant sequence outperforms the original one.

Conclusions and Challenges

We have shown that Bayesian optimization principles can be successfully used in the design of synthetic genes. One of the most important aspects in this process is to have a good surrogate model for the cell behavior able to lead to appropriate acquisition functions. Considering future models, the fact that the cell is a extremely complex system will be a key aspect to take into account. To optimize certain features of the cell, massive amounts of data will be required, which will require the used of sparse Gaussian processes. Regarding the optimization aspects of the problem, in this work we have worked with a set of features extracted from the gene sequences, which we have used to obtain gene design rules rather than optimal sequences. The use of more features will potentially lead to better and more specific gene design. This will require, however, the development of scalable Bayesian optimization methods able to work well in high dimensions in the line of some recent works [\cite=Wang:2013b] [\cite=AL] [\cite=Bergstra+al-NIPS2011] [\cite=Hutter:2011:SMO:2177360.2177404]. An alternative approach is to focus directly on the optimization on the sequences rather than on extracted features by omitting any previous biological knowledge. This seems feasible from the modeling point of view by means of the use of string or related kernels [\cite=Lodhi:2002:TCU:944790.944799] but the optimization of the acquisition functions derived from this models remains challenging.

Acknowledgments: The authors would like to thank BRIC-BBSRC for the support of this project (No BB/K011197/1).