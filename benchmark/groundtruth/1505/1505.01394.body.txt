=1

-0.25cm

Proposition Lemma Corollary Definition Example Assumption

William Kleiber

Introduction

The theory of univariate continuous stochastic processes has become well developed over nearly a century of research. The past quarter century or so has seen an increasing interest and development of models for multivariate spatial processes. The recent review by [\citet=genton2015] gives a relatively comprehensive treatment of the basic approaches that have been explored to build stochastic spatial models. In the discussion, [\citet=bevilacqua2015] pose the question, given the recent deluge of multivariate constructions, "which parametric model is more flexible?" Indeed, the relative strengths and weaknesses of multivariate models have been explored only empirically, that is, by testing a battery of different models on particular datasets, and comparing performance either by likelihood values or by predictive cross-validation (in the multivariate context, spatial prediction is known as co-kriging). Thus, a fundamental open question is: (1) to what extent can the flexibilities of model constructions be compared theoretically? Additionally, most models are motivated in the covariance domain, and the natural follow-up question is: (2) are there other approaches than covariance to measure and quantify spatial dependence?

We introduce the notion of spectral coherence, phase and gain for multidimensional and multivariate spatial random fields. We propose that these functions allow for natural partial answers to the critical open questions (1) and (2). We show that a number of previously proposed models lack sufficient practical flexibility in terms of prediction, and we suggest insights into well established models such as the multivariate Matérn, where parameters such as the cross-covariance smoothness and range have had elusive direct interpretations that relate to process behavior.

Let us illustrate the ideas developed in this manuscript by considering the time series case first. Suppose Zi(t),i = 1,2 is a bivariate complex-valued weakly stationary time series on [formula] with covariance functions Cov(Zk(t + h),Zk(t))  =  Ckk(h) and cross-covariance functions [formula] for [formula]. The corresponding spectral densities are [formula] for [formula]. Spectral modeling in time series is well developed; for example, traditional autoregressive moving average models imply processes with rational spectral densities. The function

[formula]

is known as the squared coherence function, and can be interpreted as a quantification of the linear relationship between Z1(t) and Z2(t) at frequency ω [\citep=brockwell2009].

We entertain two example datasets from the atmospheric sciences. Both are reforecast and reanalysis data products over the equatorial region based on a well established numerical weather prediction (NWP) model. Reanalysis forecasts are from a fixed version of a NWP model that are run retrospectively to generate a large database of model forecasts and analyses (in this context, an analysis can be considered a best estimate of the current state of the atmosphere). First we look at forecasted surfaces of sea level pressure at daily forecast horizons between 24 and 192 hours. We show that coherence can be used as a diagnostic to assess forecast quality, and additionally illustrate frequency bands at which forecasts improve over time. The second dataset involves geopotential heights at differing pressure levels. We show that coherence and phase extract and highlight qualities of the spatial relationship between different pressure levels that are difficult to model using extant multivariate covariance constructions, and indeed illustrate some fundamental limitations of existing popular constructions.

Spectra for Multivariate Random Fields

Suppose [formula] is a p-variate weakly stationary random field on [formula] admitting a matrix-valued covariance function [formula] where [formula]. For simplicity of exposition we suppose [formula] is a mean zero process. For complex-valued stationary processes, [formula], so that [formula]. The main obstacle to multivariate process modeling is developing flexible classes of matrix-valued covariance functions [formula] that are nonnegative definite. We say [formula] is nonnegative definite if, for any choices of [formula] and locations [formula] for [formula] and [formula] we have

[formula]

Note this reduces to the usual definition of nonnegative definiteness for a univariate covariance, p = 1.

For univariate processes, Bochner's Theorem states that [formula] is a valid (i.e., nonnegative definite) function if and only if it can be written

[formula]

where F is a positive finite measure [\citep=stein1999]. If F admits a density f with respect to the Lebesgue measure on [formula], we call it the spectral density for C. The multivariate extension of Bochner's fundamental result is given by [\citet=cramer1940], and is contained in the following theorem specialized to covariances admitting spectral densities.

A matrix-valued function [formula] is nonnegative definite if and only if

[formula]

for [formula] such that the matrix [formula] is nonnegative definite for all [formula].

The functions [formula] are the spectral and cross-spectral densities for the marginal and cross-covariance functions [formula]. Note that [formula]. When the spectral density exists, it can be solved for as the Fourier transform of the covariance function,

[formula]

Theorem [\ref=th:cramer] has primarily been used in practice to build multivariate covariance models, by specifying matrices of spectral densities that are nonnegative definite for all frequencies.

Coherence

In time series, the notion of frequency coherence is well developed, and can be used, for instance, to assess whether one time series is related to another by a time invariant linear filter. These notions carry over to the spatial case, and form the point of entry for our analyses.

If [formula] form a matrix-valued covariance function with associated spectral densities [formula], then define the coherence function (or coherency function)

[formula]

We might assume [formula] for all [formula] for i = 1,2, but can define [formula] if [formula]. The coherence function can be complex-valued, so in practice we examine the absolute coherence function, [formula]. The real-valued function [formula] is the squared coherence function, and by Theorem [\ref=th:cramer], [formula] for all [formula]. Values of [formula] near unity indicate a linear relationship between [formula] and [formula] at particular frequency bands.

The following theorem relates the coherence to optimal prediction of a random process based on another process. The predictive estimator is based on a kernel smoothed process which is a natural predictor given the interpretation of the univariate kriging weights as a kernel function [\citep=kleiber2015].

Suppose [formula] is a complex-valued mean zero weakly stationary bivariate field with matrix-valued covariance [formula] admitting a spectral density matrix [formula] that is everywhere nonzero. Then the continuous square integrable function [formula] that minimizes [formula] is

[formula]

Additionally, the spectral density of the predictor [formula] is

[formula]

for all [formula].

In particular, the relationship ([\ref=eq:k.pred.coh]) implies that the optimal weighting function is modulated by the coherence between the two processes, and indeed has greater spectral weight on frequencies with high coherence. An immediate corollary to Theorem [\ref=th:prediction] is

[formula]

Thus, the coherence has an attractive interpretation as the amount of variability that can be attributed to a linear relationship between two processes at a particular frequency. In the following development, we use the coherence function to illuminate fundamental limitations on some popular multivariate covariance constructions.

The coherence function can be used as a tool to compare proposed multivariate models, as an indicator of the amount of flexibility of bivariate relationships at differing frequencies. For example, a rather classic approach to specifying covariances is separability, setting [formula] where [formula] is a univariate covariance function and [formula] is a p  ×  p positive definite matrix [\citep=mardia1993] [\citep=helterbrand1994] [\citep=bhat2010]. This approach has been empirically shown to be insufficiently flexible, and the following lemma contributes to the empirical results.

If [formula] where [formula] is a covariance function and [formula] is a p  ×  p positive definite matrix with (i,j)th entry rij, then the squared coherence between the ith and jth process is constant, in particular [formula].

A more sophisticated method of generating multivariate covariance structures is to convolve univariate square integrable functions [\citep=gaspari1999] [\citep=oliver2003] [\citep=gaspari2006] [\citep=majumdar2007]. In particular, if [formula] are square integrable functions for [formula] then [formula] is a valid matrix-covariance function where [formula] denotes the convolution operator. This is sometimes known as covariance convolution (especially when ci are positive definite functions to begin with). The following proposition suggests this approach to model building is overly-restrictive, and indeed implies that the resulting coherence is necessarily constant over all frequencies.

If c1 and c2 are square integrable functions on [formula] and a matrix-valued covariance is defined via [formula] for i,j = 1,2 where [formula] denotes convolution, then [formula] for all [formula] such that the Fourier transforms of ci and cj are nonzero.

Multivariate processes can sometimes be modeled as being related by local averaging. For example, the relationship between column integrated ozone observations and local ozone might be plausibly modeled as observations being locally averaged over the true underlying field [\citep=cressie2008]. Wind observations are often time averaged over moving windows to produce smoother and more stable observation series [\citep=hering2015]. The following proposition characterizes the coherence in such situations, and serves to illustrate the intimate link between process relationship and coherence.

If [formula] is a weakly stationary stochastic process and [formula] for some continuous square integrable kernel function [formula] that is symmetric, then [formula] for all [formula] such that the Fourier transform of K is nonzero.

According to Proposition [\ref=prop:z.conv], estimated coherences near unity over all frequency bands may be indicative of a linear or local averaged relationship between processes, and this result may serve as the theoretical basis for testing such a hypothesis. [\citet=fuentes2006] uses a similar notion to develop a test for separability of space-time processes.

The kernel convolution method, introduced by [\citet=verhoef1998] and [\citet=verhoef2004], originally involved representing a process as a moving average against a white noise process. In simple cases this yields the covariance convolution model. This can be generalized to

[formula]

where [formula] is a mean zero stationary process with covariance [formula], and [formula] are square integrable symmetric kernel functions for [formula]. As with each previous construction, this approach also yields constant coherence.

If [formula] and [formula] are constructed as in ([\ref=eq:k.convolution]), then [formula] is constant for all [formula].

For all of these models, separable, covariance convolution and kernel convolution, the resulting multivariate structure is restricted to constant coherence. In light of Theorem [\ref=th:prediction], this suggests that none of these models can attain optimal prediction for any multivariate processes exhibiting nontrivial coherences. Indeed the examples below in Section [\ref=sec:example] exhibit nonconstant coherence, and call for more flexible modeling frameworks.

Phase and Gain

Similar notions to frequency coherence can be motivated by examining spectral density matrices. If [formula] is a stationary random vector with spectral density matrix [formula] then define [formula]. Note that [formula] is possibly complex-valued. We define the gain function [formula] which is sometimes referred to as the gain of [formula] on [formula] in time series [\citep=brockwell2009]. Additionally define the phase function at frequency [formula] as [formula], the complex argument of [formula]. Note that the phase function satisfies [formula] and [formula].

The interpretations of gain and phase are most clear when considering processes built by the relationship [formula] for some [formula] and [formula], i.e., Z1 is a shifted and rescaled version of Z2. Then it is straightforward to show that the phase function is

[formula]

[\citet=li2011] develop an approach to modeling this type of asymmetric cross-covariance behavior. This result shows that their construction will have phase shift function that depends on the angle [formula]. This result may be used as an exploratory data approach or as the basis for a statistical test to suggest whether a pair of spatial processes exhibit an asymmetric relationship; [\citet=li2011] use the empirical cross-correlation function to visually assess such asymmetric behavior. The gain function in this case is simply [formula]; all frequency components of Z2 are exaggerated by an amount α for Z1.

Below we consider some multivariate constructions that are particular to real-valued processes having real-valued spectral matrices. Any model with real-valued cross-spectral density has [formula], but a possibly non-trivial gain function. Thus, testing for [formula] can be viewed as a test for a real-valued cross-spectral density, which seems very relevant given most multivariate models are developed under this assumption.

Revisiting the Multivariate Matérn

The multivariate Matérn is a model for matrix-valued covariance functions such that each process is marginally described by a Matérn covariance function, and all cross-covariance functions also fall in the Matérn class [\citep=gneiting2010] [\citep=apanasovich2012]. Specifically, the multivariate Matérn imposes [formula] for i = j and [formula] for [formula]. Here, [formula] where Kν is a modified Bessel function of the second kind of order ν. [\citet=gneiting2010] and [\citet=apanasovich2012] discuss restrictions on the parameters νi,ai,νij,aij and ρij that result in a valid model.

The Matérn class is popular due to the smoothness parameters ν  >  0 which continuously index smoothnesses of the sample paths of the process. In particular, sample paths are m times differentiable if and only if ν  >  m, and there is an additional relationship between ν and the fractal dimension in that sample paths have dimension max (d,d + 1 - ν) [\citep=goff1988] [\citep=handcock1993]. These interpretations and implications also hold in the multivariate case, where νi indexes the smoothness of the ith component process [formula]. The parameters ai act as range parameters, and control the rate of decay of spatial correlation away from the origin.

A standing issue with the multivariate Matérn is that the cross-covariance parameters, νij and aij for [formula], do not have straightforward interpretations that are analogous to the marginal smoothness and range interpretations, and indeed nowhere in the literature have these parameters been linked directly to process behavior. We find that these parameters have direct interpretations when considering the coherence function between two processes.

The coherence function for a bivariate process with multivariate Matérn correlation is

[formula]

We explore in detail two simplified versions of this coherency function. First, consider the case where a1  =  a2  =  a12  =  a, all covariance and cross-covariance functions share a common range. Then

[formula]

The multivariate Matérn is a valid model only if ν12  ≥  (ν1  +  ν2) / 2, and thus by inspecting ([\ref=eq:coh.mm.nu]) we note some modeling implications resulting from these restrictions. First, if ν12  =  (ν1  +  ν2) / 2, the coherency is constant across all frequencies, implying a constant linear relationship between two processes at all frequency bands. Second, if ν12  >  (ν1  +  ν2) / 2, we have greater coherency at low frequencies, with [formula] as [formula]. This analysis seems to suggest a natural interpretation of the cross-covariance smoothness in that it controls the amount of cross-process dependence at various frequencies, but can only imply greater or equal coherence at low frequencies versus high frequencies. Figure [\ref=fig:coh.mm.nu] serves to illustrate these points, showing various coherence functions for common length scale parameters a11  =  a12  =  a22  =  1, varying ν12 and ρ.

Perhaps surprisingly, a similar analysis suggests the cross-covariance range parameter a12 induces potentially greater flexibility in the coherence function than the smoothness parameter ν12. In particular, if ν1  =  ν2  =  ν12  =  ν, the coherence function is

[formula]

Examining ([\ref=eq:coh.mm.a]), we see that, depending on whether a12  ≤   min (a1,a2) or a12  ≥   max (a1,a2) the coherence will have distinct behavior. For simplicity, set a1  =  a2  =  a. If a12  <  a, the coherence will be greater for small frequencies than high frequencies, similar to the behavior implied by ([\ref=eq:coh.mm.nu]) when ν12  >  (ν1  +  ν2) / 2. However, here [formula] as [formula], implying non-negligible coherence between processes at high frequencies, unlike that in ([\ref=eq:coh.mm.nu]). If a12  >  a, we have the complementary result that [formula] for [formula], that is, two processes share behavior at high frequencies rather than low. Figure [\ref=fig:coh.mm.a] illustrates these scenarios, and seems to suggest that, at least as far as coherence is concerned, the cross-covariance range parameter yields potentially greater flexibility than the cross-smoothness.

The so-called parsimonious Matérn model is defined by imposing common range parameters as well as ν12  =  (ν1  +  ν2) / 2 [\citep=gneiting2010]. This model has been empirically shown to produce inferior model fits to datasets as compared to more general versions of the multivariate Matérn as well as other multivariate classes [\citep=gneiting2010] [\citep=apanasovich2012]. The coherence function for a bivariate parsimonious Matérn model is constant, [formula], which suggests an inflexible model for the spectral behavior of spatial processes.

We close this section with an empirical illustration of the implications of cross-covariance parameter choice on random field realizations and the associated low and high frequency behavior. We simulate two bivariate Matérn models on an equally-spaced grid of 256  ×  256 in 2. In both cases we low-pass and high-pass filter the resulting bivariate field. The low-pass filter is a matrix of zeros except for a 3  ×  3 grid of 1 / 9, while the high-pass filter is similar with a 3  ×  3 grid of - 1 / 9 on the edge and 8 / 9 in the center. The effect of the filters is to remove high frequency behavior (low-pass filtering) or low frequency behavior (high-pass filtering).

Figure [\ref=fig:filt.mm] shows low-pass filtered realizations of two bivariate Gaussian processes with bivariate Matérn covariances. The top row is the case with equal ranges a11  =  a12  =  a22  =  1 but with a greater cross-smoothness ν11  =  ν22  =  0.5,ν12  =  1. According to Figure [\ref=fig:coh.mm.nu], we should expect the realizations to show similar low frequency behavior, but dissimilar high frequency behavior. Indeed, panels (a) and (b) show similar low frequency behavior, while the pairwise scatterplot of high-passed values, panel (c), suggests little correlation at high frequencies. Complementary, the second row is the case with equal smoothnesses, ν11  =  ν12  =  ν21  =  1 but a greater cross-range parameter, [formula]. Figure [\ref=fig:coh.mm.a] suggest we should expect less coherence at low frequencies while having greater correlation at high frequencies. Again, these theoretical results are reinforced: panels (d) and (e) are not suggestive of strong low frequency coherence, while panel (f) exhibits positively correlated high frequency characteristics (and indeed has an empirical correlation coefficient of approximately 0.25).

The Linear Model of Coregionalization

The linear model of coregionalization (LMC) is a competing framework for multivariate modeling, and is built by decomposing a multivariate process as linear combinations of uncorrelated, univariate processes [\citep=goulard1992] [\citep=royle1999] [\citep=wackernagel2003] [\citep=schmidt2003]. In particular, we entertain the following version,

[formula]

The matrix [formula] is known as the coregionalization matrix, and controls the strength of dependencies on the latent uncorrelated processes [formula]. For the following, suppose [formula] and [formula] are uncorrelated processes with spectral densities [formula] and [formula], respectively.

Given the number of parameters in the LMC, it is often useful to impose restrictions on the coregionalization matrix [formula], such as setting b11  =  b22  =  1 [\citep=berrocal2010]. The following Lemma is the unsurprising result that the LMC yields multivariate processes that are exactly coherent when the coregionalization matrix has zero determinant.

In the linear model of coregionalization ([\ref=eq:LMC]), if b11  =  b22  =  1 then the coherence function between [formula] and [formula] is unity if and only if b12b21  =  1.

Note that this result simply states that, under the LMC, two processes are exactly coherent when they differ only by a scalar multiplier.

Under the same working assumptions, b11  =  b22  =  1, we have the gain function of [formula] on [formula] is

[formula]

If, as is common in using the LMC, we set b12  =  0, we have the gain function is simply b21; that is, there is constant gain at all frequencies by the amount of coregionalization, b21. The complementary case where b21  =  0 yields the gain

[formula]

that is, the relative contribution of component [formula] to the combined spectrum of [formula]. As mentioned previously, if the latent processes have real-valued spectral densities, the phase function is exactly zero at all frequencies.

Estimation of Spectra

Suppose [formula] is a p-variate process that has been observed at a regular grid of points [formula], of marginal dimensions [formula] where [formula]. If grid spacing in the ith dimension is δi, define [formula]. Then the spatial periodogram matrix with [formula]th entry is defined as [formula] where

[formula]

is available at Fourier frequencies [formula] where [formula] for [formula]. Note that [formula].

Whereas in the time series literature it is natural to consider asymptotics as time t  →    ∞  , resulting in effectively uncorrelated blocks of a process, in the spatial realm there are two competing asymptotic frameworks. Increasing domain asymptotics is similar to the time series case where samples are taken on an ever-increasing domain in all axial directions, and typically asymptotic results here echo those in time series. The complementary version is infill asymptotics (sometimes called fixed-domain asymptotics) in which the domain boundary is fixed and points are sampled at an ever finer resolution within the domain [\citep=zhang2005]. Depending on the asymptotic framework under consideration, the large sample properties of the periodogram ([\ref=eq:I]) change.

Using infill asymptotics, [\citet=lim2008] show that the raw multivariate periodogram can exhibit bias at low frequencies, and suggest prewhitening the process to overcome this inadequacy (in the univariate case [\citet=stein1995] gives a simulated example where the bias is quite substantial). However, under a mixture of infill and increasing domain asymptotics, [\citet=fuentes2002] showed (for univariate processes) the analogous result to the time series case that the periodogram is asymptotically unbiased and is uncorrelated at differing Fourier frequencies. Additionally, in this latter case it is not a consistent estimator, but must be smoothed to gain consistency.

Analogous to the time series and univariate spatial field case, under certain assumptions the nonparametric periodogram ([\ref=eq:I]) is asymptotically unbiased, and generates asymptotically uncorrelated random variables between distinct Fourier frequencies. The following theorem illustrates this feature of the matrix-valued periodogram. We use the same assumptions to [\citet=fuentes2002], generalized to the multivariate setting.

The true spectral densities [formula] decay as [formula] as [formula], [formula].

The marginal and cross-covariances satisfy [formula].

δi  →  0, ni  →    ∞   and δini  →    ∞   for all [formula] such that ni / nj  →  λij > 0.

Under the assumptions A1-A3, we have

[formula],

[formula] and

[formula] for [formula].

The proof for Theorem [\ref=th:asymp] follows directly from [\citet=fuentes2002] and is not included here.

According to Theorem [\ref=th:asymp], the matrix-valued periodogram is not an asymptotically consistent estimator. To produce a consistent estimator of the spectral density at a particular frequency [formula], in practice we locally smooth adjacent periodogram values and appeal to property (iii) of Theorem [\ref=th:asymp]. In particular, the smoothed matrix-valued periodogram is

[formula]

where [formula] is the empirical cumulative distribution function of Fourier frequencies [formula]. Here, Kλ is some kernel function with bandwidth λ, where, as we have it written, the same kernel is applied to each process. Naturally, different kernels may be used for different processes if the scientific context calls for such an approach.

Note that we can't directly use the nonparametric periodogram fraction to estimate the coherence as [formula] at all Fourier frequencies. Thus, we estimate the coherence functions by using the smoothed periodograms,

[formula]

for [formula].

Illustrations

We examine two datasets from the atmospheric sciences, gridded reforecasts and reanalyses of sea level pressure and geopotential heights over the equatorial region. Reforecast data are produced retrospectively from a fixed version of a numerical weather prediction model, in this case the 2nd generation National Oceanic and Atmospheric Administration's (NOAA) Global Ensemble Forecast System Reforecast [\citep=hamill2013]. Forecasts are generated at 3 hour increments from 0 to 192 hours, with the 0h forecast being a reanalysis, that is, an estimate of the current state of the atmosphere. For the data below, the control initial conditions were produced using a hybrid ensemble Kalman filter-variational analysis system [\citep=hamill2011].

Sea Level Pressure

The first dataset we consider is a set of reforecast sea level pressures (SLP) over the equatorial region. Sea level pressures in this region are approximately stationary, and we compare forecast horizons in 24 hour increments from 0h to 192h (8 days out). The data consist of gridded reforecasts from the first 90 days of 2014 at [formula] increments over 360 longitude and 47 latitude bands between [formula] to [formula] defining the equatorial region.

One approach to examining the quality of forecasts is the coherence between the forecast with the corresponding reanalysis. For example, we might compare the 24h forecast of SLP generated on January 1, 2014 to the 0h reanalysis generated on January 2, 2014. It is well known that forecast skill decays with horizon, and we expect the short-term forecasts to share higher coherence with the reanalyses than the long-term forecasts.

We begin by standardizing each analysis and forecast horizon grid cell by subtracting the temporal average and diving by empirical standard standard deviation to produce forecast anomalies. Denote these anomalies by [formula] for forecast horizons [formula] corresponding to forecast horizons [formula] hours, spatial locations [formula] in the equatorial region D on days [formula], i.e., the first 90 days of 2014.

Each day's marginal process empirical periodogram ([\ref=eq:I]) is calculated for all forecast horizons k, yielding [formula]. The smoothed periodogram is a convolution with a simple low-pass filter, a matrix of zeros with a 3  ×  3 constant block of 1 / 9. Interest focuses on comparing various forecast horizons with the reanalysis at k = 0, so we calculate empirical cross-periodograms [formula] for all available days d allowing for forecast validation (e.g., the k = 1, 24h horizon, has 89 available days, [formula]). The cross-periodograms are smoothed using the same low-pass filter as the marginals. If [formula] denotes the smoothed cross-periodograms, we estimate the squared coherence function as

[formula]

for [formula], that is, the average over all available daily smoothed cross-periodograms.

Figure [\ref=fig:GEFS.pres.coh] shows estimated absolute coherence functions for horizons 168, 92 and 24h with the 0h analysis. Even at long lead lead times there is substantial coherence, which increases by a substantial margin at very low longitudinal frequencies. For any given longitude frequency band, the coherence appears to be relatively constant across latitudes, which is sensible given that there appears to be greater variability in the equatorial direction than in the north-south direction for sea level pressure in this region. As the forecast horizon decreases the coherence begins building between low-to-mid frequency bands in the latitudinal direction, suggesting that the statistical characteristics of short term forecasts are more similar to observed sea level pressure than the longer term forecasts. However, note that at the highest frequencies there is not a substantial improvement in forecast skill, bordering on no improvement, which suggests that small scale events are difficult to forecast even at one day out.

To quantify the differences in forecast horizon skill, we estimate a set of bivariate Matérn models. As each forecast and analysis arises from the same physical model, we assume that the marginal spectra follow the same statistical behavior, that is, we suppose the marginal spectral densities at equal at all horizons, [formula]. Suggested by Figure [\ref=fig:GEFS.pres.coh] and exploratory analysis for the marginal spectra, we additionally suppose the spectrum is constant across latitude frequencies. A Gaussianity assumption does not appear to be justifiable, based on empirical Q-Q plots. Thus, we follow the suggestion of [\citet=fuentes2002] and estimate marginal Matérn parameters by minimizing the squared difference between theoretical log spectral density and log average periodogram, having averaged over all days, forecast horizons and latitude bands. The resulting least squares estimates are a  =  0.074 and ν  =  0.94. Cross-covariance parameters are estimated by minimizing least squares distance to the average empirical coherence functions, estimated by averaging over days and latitude bands.

Table [\ref=tab:GEFS.pres.matern] contains the cross-covariance parameter estimates corresponding to all forecast horizons. As forecast horizon increases, all parameters decay; in fact, the decay is almost exactly linear for each variable beyond the 24h horizon. Fitting a linear model to the parameters as a function of forecast horizon suggests the cross-covariance smoothness will decay to the marginal value ν  =  0.94 after approximately 16 days, whereas the cross-covariance scale meets the marginal value between 3-4 days. Although these ideas can be used to generate scientific hypotheses, there is substantial extrapolation for nu12 that strongly depends on a linear assumption.

A word of caution is in order; the estimates in Table [\ref=tab:GEFS.pres.matern] do not always imply a valid multivariate covariance structure. However, on any given grid the estimated parameters may yield a valid model, it just cannot be guaranteed for all grids. One possibility is that the bivariate Matérn is not sufficiently flexible to describe the stochastic structure of these fields, which is a call for further research in this area.

Geopotential Height

Our second example is on the same spatial domain, but whose values are geopotential heights. Geopotential height is the height (in meters) above sea level at which the atmospheric pressure is a certain level. In the atmospheric sciences, it is common to examine geopotential heights as indicators of climatic regimes, for instance [\citet=knapp1996] examines the relationship between heights and temperature anomalies over a portion of the United States.

Three of the most common geopotential height maps are the 850hPa, 500hPa and 300hPa maps. The first, 850hPa, approximately defines the planetary boundary layer, which is the lowest level of the atmosphere that interacts with the surface of the Earth (note 1000hPa is approximately sea level). The 300hPa level is at the core of the jet stream, while the 500hPa approximately divides the atmosphere in half, and whose anomalies are used in part to assess climatological temperature variations. The vertical structure of geopotential heights is a focus of some interest within atmospheric sciences [\citep=blackmon1979].

We examine geopotential height reanalysis anomalies [formula] for k = 1,2,3 representing the 850hPa, 500hPa and 300hPa pressure levels on days [formula], the first 6 months of 2014. The anomalies are differences between the reanalysis height and a time-varying Nadaraya-Watson kernel smoothed estimate of the mean with a bandwidth of 5 days. Experiments suggest the results below are qualitatively robust against choices of the bandwidth and smoothing kernel.

Similar to the previous section, we smooth the marginal process periodogram ([\ref=eq:I]) using a low-pass filter, and calculate smoothed empirical cross-periodograms yielding [formula]. Then the squared coherence is estimated as the arithmetic average of each day's empirical squared coherence estimate,

[formula]

Figure [\ref=fig:GEFS.geoheight.coh] contains the three estimated pairwise absolute coherence functions. There is high coherence between the lower pressure levels at low frequencies, and some evidence of moderate coherence between all levels at low frequencies. We also note some strikingly different behavior than for the sea level pressure example. First, there is an apparent ridge in coherence at low frequencies (approximately [formula]) which may be indicative of equatorial planetary waves [\citep=wang1996] [\citep=xie1996] [\citep=kiladis2009]. Planetary waves can play crucial roles in the formation of tropical cyclones [\citep=molinari2007]. Additionally, note that there is high coherence at the highest Fourier frequencies for all coherence functions (capping out at approximately 0.62,0.54, and 0.70). This is evidence of a nonseparable relationship in the frequency domain, and we are unaware of any current multivariate models that can adequately capture such behavior. One possible explanation for this high coherence at high frequencies is artifacts in the data assimilation scheme, in particular aberrant observational data leading to unusually large anomalies in geopotential height. Indeed, variables such as sea level pressure are well constrained by a wealth of observational data, while geopotential heights are less constrained, usually being observed by sparsely released weather balloons.

Figure [\ref=fig:GEFS.geoheight.ph] shows pairwise plots for each pair of geopotential height anomalies. In particular there is strong evidence of a phase shift at a low frequency band between the 850hPa and both lower pressure heights. These frequencies indicate wavelengths of approximately 4000 - 6000km, which is a typical wavelength for planetary equatorial waves, or Rossby waves [\citep=wang1996] [\citep=xie1996] [\citep=kiladis2009]. On the other hand, there is not substantial evidence of phase shift between the pairs of heights at other frequencies. Most extant multivariate models utilize real-valued cross-spectral densities, and thus are insufficiently flexible to capture this type of phase shifted behavior at specific spectra.

Discussion

The notion of coherence, phase and gain are common in the time series literature, but have been yet unexplored for multivariate spatial processes. We casted these functions for multidimensional processes. The coherence between two variables can be interpreted as a measure of linear relationship at particular frequency bands, resulting in a complementary framework for comparing processes than the usual cross-covariance function. Phase and gain also yield straightforward interpretations as a physical space-shift and relative amplitude of frequency dependence when comparing two processes. We developed these ideas for stationary processes, and future research may be directed toward the analogous cases for nonstationary processes, perhaps extending the work of [\citet=fuentes2002].

Coherence, phase and gain can be estimated using smoothed cross-periodograms, and in our examples we showed that, as exploratory tools, these functions can be very useful in detecting structure that may not be readily captured using extant multivariate models. We additionally illustrated that the coherence function gives a natural interpretation to the multivariate Matérn cross-covariance parameters that have otherwise been uninterpretable, lending insight into an outstanding problem.

A number of future research directions may be considered, including the adaptation of coherence to multivariate space-time processes. This work can also be seen as a call to develop more flexible multivariate models, perhaps working directly in the spectral domain rather than the covariance domain, where most previous work has fallen, echoing the call of [\citet=simpson2015].

Appendix

The following Lemma is useful in proving some results of the manuscript.

Suppose [formula] is a stationary processes on [formula] with covariance function [formula] having spectral density [formula] and [formula] where K is continuous, symmetric and square integrable with Fourier transform [formula]. Then [formula] has covariance function [formula] with associated spectral density [formula]. Additionally, the cross-covariance function between Z1 and Z2 is [formula] with spectral density [formula].

The proof of this Lemma involves straightforward calculations involving convolutions and is not included here.

We recall the spectral representation for a stationary vector-valued process [formula] with matrix-valued covariance function [formula] having spectral measures [formula] defined on the Borel σ-algebra B on [formula]. There is a set of complex random measures [formula] on B such that if B,B1,B2∈B are disjoint, [formula] and [formula] for [formula]. Then [formula] has the spectral representation

[formula]

see [\citet=gihman1974] for details. If all Fij admit associated spectral densities fij, then in shorthand we write [formula].

The spectral representation implies

[formula]

for complex-valued random measures Mi, i = 1,2. Then if K has Fourier transform FK,

[formula]

by a change of variables. Then, using that [formula] and

[formula]

we have

[formula]

The integrand is minimized for each [formula] if

[formula]

That the density of [formula] is [formula] now follows by the convolution theorem for Fourier transforms.

If [formula] is the Fourier transform of ci,i = 1,2, the result immediately follows as the spectral density of [formula] is [formula].

This result follows directly from Lemma [\ref=lem:intKZ.relation].

This result follows from Lemma [\ref=lem:intKZ.relation] and that the spectral density for white noise is constant over all frequencies.

Acknowledgements

The author thanks Michael Scheuerer for many helpful discussions during the development of this research. This research was supported by National Science Foundation grants DMS-1417724 and DMS-1406536.