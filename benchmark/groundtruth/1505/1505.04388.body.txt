Proof sketch:

Simultaneous Visibility Representations of Plane st-graphs Using L-shapes

Research supported in part by the MIUR project AMANDA "Algorithmics for MAssive and Networked DAta", prot. 2012C4E3KT_001 and NSERC Canada.

Introduction

Let Gr and Gb be two plane graphs with the same vertex set. A simultaneous embedding (SE) of 〈Gr,Gb〉 consists of two planar drawings, Γr of Gr and Γb of Gb, such that every edge is a simple Jordan arc, and every vertex is the same point both in Γr and in Γb. The problem of computing SEs has received a lot of attention in the Graph Drawing literature, partly for its theoretical interest and partly for its application to the visual analysis of dynamically changing networks on a common (sub)set of vertices. For example, it is known that any two plane graphs with the same vertex set admit a SE where the edges are polylines with at most two bends, which are sometimes necessary [\cite=DBLP:journals/ijcga/GiacomoL07]. If the edges are straight-line segments, the representation is called a simultaneous geometric embedding (SGE), and many graph pairs do not have an SGE: a tree and a path [\cite=DBLP:journals/jgaa/AngeliniGKN12], a planar graph and a matching [\cite=DBLP:journals/jgaa/CabelloKLMSV11], and three paths [\cite=DBLP:journals/comgeo/BrassCDEEIKLM07]. On the positive side, the discovery of graph pairs that have an SGE is still a fertile research topic. The reader can refer to the survey by Bläsius, Kobourov and Rutter [\cite=Handbook] for references and open problems.

Only a few papers study simultaneous representations that adopt a drawing paradigm different from SE and SGE. A seminal paper by Jampani and Lubiw initiates the study of simultaneous intersection representations (SIR) [\cite=DBLP:journals/jgaa/JampaniL12]. In an intersection representation of a graph, each vertex is a geometric object and there is an edge between two vertices if and only if the corresponding objects intersect. Let 〈Gr,Gb〉 be two graphs that have a subgraph in common. A SIR of 〈Gr,Gb〉 is a pair of intersection representations where each vertex in [formula] is mapped to the same object in both realizations. Polynomial-time algorithms for testing the existence of SIRs for chordal, comparability, interval, and permutation graphs have been presented [\cite=DBLP:conf/soda/BlasiusR13] [\cite=DBLP:conf/isaac/JampaniL10] [\cite=DBLP:journals/jgaa/JampaniL12].

We introduce and study a different type of simultaneous representation, where each graph is realized as a bar visibility representation and two segments representing the same vertex share an end-point. A bar visibility representation of a plane graph G is an embedding preserving drawing Γ where the vertices of G are non-overlapping horizontal segments, and two segments are joined by a vertical visibility segment if and only if there exists an edge in G between the two corresponding vertices (see, e.g., [\cite=DBLP:journals/dcg/RosenstiehlT86] [\cite=TamassiaTollis86]). A visibility segment has thickness ε > 0 and does not intersect any other segment.

A simultaneous visibility representation with L-shapes of 〈Gr,Gb〉 is a pair of bar visibility representations 〈Γr,Γb〉 such that for every vertex v∈V, Γr(v) and Γb(v) are a horizontal and a vertical segment that share an end-point. In other words, every vertex is an L-shape, and every edge of Gr (resp., Gb) is a vertical (resp., horizontal) visibility segment. Also, no two L-shapes intersect. A simultaneous visibility representation with L-shapes of 〈Gr,Gb〉 where the rotation of the L-shape of each vertex in V is defined by a function Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }, is called a Φ-LSVR in the following. While this definition does not assume any particular direction on the edges of Gr (resp., Gb), the resulting representation does induce a bottom-to-top (resp., left-to-right) st-orientation. In this paper, we assume that Gr and Gb are directed and this direction must be preserved in the visibility representation. Also, the two graphs have been augmented with distinct (dummy) sources and sinks. More formally, Gr=[formula] and Gb=[formula] are two plane st-graphs with sources sr, sb, and sinks tr, tb.

In terms of readability, this kind of simultaneous representation has the following advantages: (i) The edges are depicted as straight-line segments (as in SGE) and the edge-crossings are rectilinear; (ii) The edges of the two graphs are easy to distinguish, since they consistently flow from bottom to top for one graph and from left to right for the other graph. Having rectilinear crossing edges is an important benefit in terms of readability, as shown in [\cite=DBLP:conf/apvis/HuangHE08], which motivated a relevant amount of research on right-angle crossing (RAC) drawings, see [\cite=dl-cargd-12] for a survey.

Our main contribution is summarized by the following theorem.

Let Gr and Gb be two plane st-graphs defined on the same set of n vertices V and with distinct sources and sinks. Let Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }. There exists an O(n3)-time algorithm to test whether 〈Gr,Gb〉 admits a Φ-LSVR. Also, in the positive case, a Φ-LSVR can be computed in O(n) time.

This result relates to previous studies on topological rectangle visibility graphs [\cite=StreinuWhitesides03] and transversal structures (see, e.g., [\cite=f-rsrpg-13] [\cite=DBLP:journals/dm/Fusy09] [\cite=DBLP:journals/tcs/KantH97] [\cite=DBLP:conf/soda/Schnyder90]). Also, starting from a Φ-LSVR of 〈Gr,Gb〉, we can compute a simultaneous RAC embedding (SRE) of the two graphs with at most two bends per edge, improving the general upper bound by Bekos et al. [\cite=DBLP:conf/walcom/BekosDKW15] for those pairs of graphs that can be directed and augmented to admit a Φ-LSVR. As an application of this result, in Section [\ref=se:wheel+matching] we show an alternative proof of another result by Bekos et al. that a wheel graph and a matching admit an SRE with at most two bends for each edge of the wheel, and no bends for the matching edges [\cite=DBLP:conf/walcom/BekosDKW15].

The proof of Theorem [\ref=th:mainth] is based on a characterization described in Section [\ref=se:characterization], which allows for an efficient testing algorithm presented in Section [\ref=se:test]. Section [\ref=se:preliminaries] contains preliminaries. In Section [\ref=se:discussion] we conclude with a discussion on possible research directions that arise from our research.

Preliminaries

A graph G = (V,E) is simple, if it contains neither loops nor multiple edges. We consider simple graphs, if not otherwise specified. A drawing Γ of G maps each vertex of V to a point of the plane and each edge of E to a Jordan arc between its two end-points. We only consider simple drawings, i.e., drawings such that the arcs representing two edges have at most one point in common, which is either a common end-vertex or a common interior point where the two arcs properly cross. A drawing is planar if no two arcs representing two edges cross. A planar drawing subdivides the plane into topologically connected regions, called faces. The unbounded region is called the outer face. A planar embedding of a graph is an equivalence class of planar drawings that define the same set of faces. A graph with a given planar embedding is a plane graph. For a non-planar drawing, we can still derive an embedding considering that the boundary of a face may consist also of edge segments between vertices and/or crossing points of edges. The unbounded region is still called the outer face.

A graph is biconnected if it remains connected after removing any one vertex. A directed graph (a digraph for short) is biconnected if its underlying undirected graph is biconnected. The dual graph D of a plane graph G is a plane multigraph whose vertices are the faces of G with an edge between two faces if and only if they share an edge. If G is a digraph, D is also a digraph whose dual edge e* for a primal edge e is conventionally directed from the face, [formula], on the left of e to the face, [formula], on the right of e. Since we also use the opposite convention, we let [formula] (resp., [formula]) be the dual whose edges cross the primal edges from left to right (resp., right to left).

A topological numbering of a digraph is an assignment, X, of numbers to its vertices such that X(u)  <  X(v) for every edge (u,v). A graph admits a topological numbering if and only if it is acyclic. An acyclic digraph with a single source s and a single sink t is called an st-graph. In such a graph, for every vertex v, there exists a directed path from s to t that contains v [\cite=TamassiaTollis86]. A plane st-graph is an st-graph that is planar and embedded such that s and t are on the boundary of the outer face. In any st-graph, the presence of the edge (s,t) guarantees that the graph is biconnected. In the following we consider st-graphs that contain the edge (s,t), as otherwise it can be added without violating planarity. Let G be a plane st-graph, then for each vertex v of G the incoming edges appear consecutively around v, and so do the outgoing edges. Vertex s only has outgoing edges, while vertex t only has incoming edges. This is a particular transversal structure (see Section [\ref=se:characterization]) known as a bipolar orientation [\cite=DBLP:journals/dcg/RosenstiehlT86] [\cite=TamassiaTollis86]. Each face f of G is bounded by two directed paths with a common origin and destination, called the left path and right path of f. For all vertices v and edges e on the left (resp., right) path of f, we let [formula] (resp., [formula]).

Tamassia and Tollis [\cite=TamassiaTollis86] proved the following lemma.

Let G be a plane st-graph and let [formula] be its dual graph. Let u and v be two vertices of G. Then exactly one of the following four conditions holds:

G has a path from u to v.

G has a path from v to u.

[formula] has a path from [formula] to [formula].

[formula] has a path from [formula] to [formula].

Let v be a vertex of G, then denote by B(v) (resp., T(v)) the set of vertices that can reach (resp., can be reached from) v. Also, denote by L(v) (resp., R(v)) the set of vertices that are to the left (resp., to the right) of every path from s to t through v. By Lemma [\ref=le:tt], these four sets partition the vertices of [formula]. In every planar drawing of G, they are contained in four distinct regions of the plane that share point v. The vertices of B(v) are in the region delimited by the leftmost and the rightmost paths from s to v, while the vertices of T(v) are in the region delimited by the leftmost and the rightmost paths from v to t. Edge (s,t) separates the two regions containing the vertices of L(v) and R(v), as in Fig. [\ref=fi:st-regions]. Refer to [\cite=dett-gd-99] for further details.

Characterization

A transversal structure of a plane graph G, is a coloring and an orientation of the inner edges (i.e., those edges that do not belong to the outer face) of the graph that obey some local and global conditions. Transversal structures have been widely studied and important applications have been found. Bipolar orientations (also known as st-orientations) of plane graphs have been used to compute bar visibility representations [\cite=DBLP:journals/dcg/RosenstiehlT86] [\cite=TamassiaTollis86]. Further applications can be found in [\cite=f-rsrpg-13] [\cite=DBLP:journals/dm/Fusy09] [\cite=DBLP:journals/tcs/KantH97] [\cite=DBLP:conf/soda/Schnyder90]. See also the survey by Eppstein [\cite=DBLP:conf/cccg/Eppstein10].

To characterize those pairs of graphs that admit a Φ-LSVR, we introduce a new transversal structure for the union of the two graphs (which may be non-planar) and show that it is in bijection with the desired representation. In what follows [formula] and [formula] are two plane st-graphs with duals [formula] and [formula], respectively.

Given Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }, a (4-polar) Φ-transversal is a drawing of a directed (multi)graph on the vertex set [formula] whose edges are partitioned into red edges, blue edges, and the four special edges (sr,sb), (sb,tr), (tr,tb), and (tb,sr) forming the outer face, in clockwise order. In addition, the Φ-transversal obeys the following conditions:

The red (resp., blue) edges induce an st-graph with source sr (resp., sb) and sink tr (resp., tb).

For every vertex u∈V, the clockwise order of the edges incident to u forms four non-empty blocks of monochromatic edges, such that all edges in the same block are either all incoming or all outgoing with respect to u. The four blocks are encountered around u depending on Φ(u) as in the following table.

[formula] [formula] [formula] [formula] [formula] [formula] [formula] [formula]

Only blue and red edges may cross and only if blue crosses red from left to right.

A pair of plane st-graphs 〈Gr,Gb〉 admits a Φ-transversal if there exists a Φ-transversal Grb such that restricting [formula] to the red edges realizes the planar embedding Gr and restricting [formula] to the blue edges realizes the planar embedding Gb.

Let u be a vertex of V, then the edges of a single color enter and leave u by the same face in the embedding of the other colored graph. In other words, as condition c2 indicates, Φ(u) defines the face of Gb (resp., Gr), denoted by [formula] (resp., [formula]), by which the edges of Gr (resp., Gb) incident to u enter and leave u, in the Φ-transversal. Also, condition c3 implies that edges {(sr,sb), (sb,tr), (tr,tb), (tb,sr)} are not crossed, because they are not colored.

In the remainder of this section we will prove the next theorem.

Let Gr and Gb be two plane st-graphs defined on the same set of vertices V and with distinct sources and sinks. Let Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }. Then 〈Gr,Gb〉 admits a Φ-LSVR if and only if it admits a Φ-transversal.

The necessity of the Φ-transversal is easily shown. Let 〈Γr,Γb〉 be a Φ-LSVR of 〈Gr,Gb〉 with two additional horizontal bars at the bottommost and topmost sides of the drawing that represent sr and tr, and two additional vertical bars at the leftmost and rightmost sides of the drawing that represent sb and tb. From such a drawing we can extract a Φ-transversal Grb as follows. Since the four vertices sr, tr, sb, and tb are represented by the extreme bars in the drawing, these four vertices belong to the outer face, and the four edges on the outer face can be added without crossings. Also, we color red all inner edges represented by vertical visibilities (directed from bottom to top), and blue all inner edges represented by horizontal visibilities (directed from left to right). To see that conditions c1, c2 and c3 are satisfied, let Grb be a polyline drawing of computed as follows. Let cu be the corner of the L-shape, [formula], representing vertex u. For every edge (u,v), replace its visibility segment by a polyline from cu to cv that has two bends, both contained in the visibility segment and each at distance δ from a different one of its endpoints, for an arbitrarily small, fixed δ  >  0. See Fig. [\ref=fi:necessity]. Finally, replace every L-shape [formula] with its corner cu. Since each bar visibility representation preserves the embedding of the input graph, c1 is respected. Also, c2 and c3 are clearly satisfied by the embedding derived from Grb. We remark that, by construction, each edge is represented by a polyline with two bends and two edges cross only at right angles; this observation will be used in Section [\ref=se:discussion].

To prove sufficiency, assume 〈Gr,Gb〉 admits a Φ-transversal Grb. We present an algorithm, ΦLSVRDrawer, that takes as input Grb and returns a Φ-LSVR 〈Γr,Γb〉 of 〈Gr,Gb〉. We first recall the algorithm by Tamassia and Tollis (TT in the following) to compute an embedding preserving bar visibility representation of a plane st-graph G, see [\cite=dett-gd-99] [\cite=TamassiaTollis86]:

Compute the dual [formula] of G.

Compute a pair of topological numberings Y of G and X of [formula].

Draw each vertex v as a horizontal bar with y-coordinate Y(v) and between x-coordinates [formula] and [formula].

Draw each edge e = (u,v) as a vertical segment at x-coordinate [formula], between y-coordinates Y(u) and Y(v), and with thickness ε.

We are now ready to describe algorithm ΦLSVRDrawer.

Lemma [\ref=le:validstxy] guarantees that Yr and Yb are valid topological numberings, and thus, that Γr and Γb are two bar visibility representations. Also, Lemma [\ref=le:lshapes] ensures the union of Γr and Γb is a Φ-LSVR. The shifts performed at the end of Steps 4-5 are to prevent the bars of two L-shapes from coinciding. The value δ  >  0 is chosen to be less than ε and less than the smallest difference between distinct numbers divided by the largest number from any topological numbering nr, nb, n*r, or n*b. This choice of δ guarantees that all visibilities are preserved after the shift, and that no new visibilities are introduced.

Yr is a valid topological numbering of Gr and Yb is a valid topological numbering of Gb.

Let (u,v) be a red edge from u to v. We know that nr(u)  <  nr(v). Let e0, e1, [formula], ek be the blue edges crossed by (u,v) in Grb. Due to conditions c2 and c3, there exists a path [formula], [formula], [formula], [formula], [formula] in [formula]. Thus, we also know that [formula]. Since [formula] and δ > 0, it follows that Yr(u)  <  Yr(v). A symmetric argument shows Yb(u)  <  Yb(v) if (u,v) is a blue edge.

Each vertex u of V is represented by an L-shape [formula] in 〈Γr,Γb〉 as defined by the function Φ. Also no two L-shapes intersect each other.

Suppose Φ(u)  =    ~  [figure]  ~  , as the other cases are similar. Then, [formula] and [formula]. The horizontal bar representing u in Γr is the segment

[formula]

, where the two points q0(u) and q1(u) are q0(u) = (Yb(u), [formula], and q1(u)  =  (Yb(u), [formula]. Note that, [formula]. Since [formula], the bottom coordinate of the vertical bar representing u matches the y-coordinate of the horizontal bar representing u. Since [formula], the left coordinate of the horizontal bar representing u matches the x-coordinate of the vertical bar representing u. Thus the two bars form the L-shape

.

We now show that no two L-shapes properly intersect each other. Suppose by contradiction that the vertical bar of a vertex u, properly intersects the horizontal bar of a vertex v. Based on Φ, the vertical bar of u involved in the intersection is either a left vertical bar or a right vertical bar, and it is drawn at x-coordinate [formula] or [formula], respectively. Suppose it is a left vertical bar, as the other case is symmetric. Since u's vertical bar properly intersects v's horizontal bar, we know by construction that [formula]. Proper intersection implies that these inequalities are strict, that there is a path in the red dual [formula] from [formula] to [formula] to [formula], and that the three faces are distinct. This implies that u belongs either to Br(v) or to Tr(v), and it lies in the corresponding regions of the plane, with [formula] (and hence the start/end of curves representing blue edges incident to u) inside the region. Similarly, by considering the blue dual [formula], [formula], we know that v belongs either to Bb(u), or to Tb(u), and it lies in the corresponding regions of the plane, with [formula] (and hence the start/end of curves representing red edges incident to v) inside the region. No matter which region, Br(v) or Tr(v), vertex u lies in, or which region, Bb(u) or Tb(u), vertex v lies in, the directed boundary of the blue region (Bb(u) or Tb(u)) containing v crosses the directed boundary of the red region (Br(v) or Tr(v)) containing u from right to left. This either violates condition c3 (if edges of the boundaries cross) or it violates condition c2 (if the boundaries share a vertex). See Fig. [\ref=fi:intersectingLshapes] for an illustration.

Let Gr and Gb be two plane st-graphs defined on the same set of n vertices V and with distinct sources and sinks. Let Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }. If 〈Gr,Gb〉 admits a Φ-transversal, then algorithm ΦLSVRDrawer computes a Φ-LSVR of 〈Gr,Gb〉 in O(n) time.

Lemmas [\ref=le:validstxy] and [\ref=le:lshapes] imply that ΦLSVRDrawer computes a Φ-LSVR of 〈Gr,Gb〉. Computing the dual graphs and the four topological numberings (Steps 1-3), as well as computing the two bar visibility representations and shifting each segment (Steps 4-5), can be done in O(n) time, as shown in [\cite=dett-gd-99] [\cite=TamassiaTollis86].

Testing Algorithm

In this section, we first show that there exists a pair of plane st-graphs 〈Gr,Gb〉 that does not admit an Φ-LSVR for any possible function Φ. This emphasizes the need for an efficient testing algorithm. Then, we show how to test whether two plane st-graphs with the same set of vertices admit a Φ-LSVR for a given function φ.

There exists a pair of plane st-graphs 〈Gr,Gb〉 that does not admit a Φ-LSVR for any possible function Φ.

Let Gr be the plane st-graph drawn red in Fig. [\ref=fi:negative-1] (observe that it is a series-parallel graph, i.e., a partial 2-tree). Also, let Gb be any plane st-graph containing the blue edge (u,v) in Fig. [\ref=fi:negative-1].

Edge (u,v) is incident to either [formula] or [formula] and to either [formula] or [formula], based on Φ. In any case edge (u,v) will cross a red edge from left to right and a red edge from right to left, which implies that 〈Gr,Gb〉 does not admit any Φ-transversal, since condition c3 cannot be respected. It follows that, by Theorem [\ref=th:4polar], 〈Gr,Gb〉 does not admit a Φ-LSVR.

Our testing algorithm exploits the interplay between the primal of the blue (red) graph and the dual of the red (blue) graph. Given the circular order of the edges around each vertex imposed by the function φ, we aim to compute a suitable path in the red dual for each blue edge. Such paths will then be used to route the blue edges. Finally, we check that no two blue edges cross.

We first introduce a few definitions. Let G and [formula] be a plane st-graph and its dual. Let f and g be two faces of G that share an edge e = (x,z) of G, such that e belongs to the right (resp., left) path of f (resp., g). Let e* be the dual edge in [formula] corresponding to e. Let w be a vertex on the right path of f (or, equivalently, on the left path of g). Then w is cut from above (resp., below) by e*, if w precedes z (resp., succeeds x) along the right path of f, i.e., all vertices that precede z (including x) are cut from above, while all vertices that succeed x (including z) are cut from below by e*.

Let Gr and Gb be a pair of plane st-graphs with the same vertex set V and with distinct sources and sinks. Let Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }. Recall that, for a given vertex u of Gb, with the notation Lb(u), Rb(u), Tb(u) and Bb(u) we represent the set of vertices to the left, to the right, that are reachable from, and that can reach u in Gb, respectively (see Section [\ref=se:preliminaries]). Then consider an edge e = (u,v) of Gb and a path [formula], e*0, f1, [formula], fk - 1, e*k - 1, [formula] in [formula], where fi (0  ≤  i  ≤  k) are the faces traversed by the path, and e*i (0  ≤  i  <  k) are the dual edges used by the path to go from fi to fi + 1. Path πe is a traversing path for e, if [formula], or for all 0  ≤  i  <  k and all vertices w in the right path of fi:

If w∈Lb(u) then w is cut from below by e*i. See Fig. [\ref=fi:p1].

If w∈Rb(u) then w is cut from above by e*i. See Fig. [\ref=fi:p2].

If w∈Bb(u) and Φ(w) = [figure]  ~   (resp., Φ(w) = [figure]  ~  ) then w is cut from above (resp., below) by e*i. See Fig. [\ref=fi:p3].

If w∈Tb(u) and Φ(w) = [figure]  ~   (resp., Φ(w) = [figure]  ~  ) then w is cut from above (resp., below) by e*i. See Fig. [\ref=fi:p4].

If w∈Bb(v) and Φ(w) = [figure]  ~   (resp., Φ(w) = [figure]  ~  ) then w is cut from above (resp., below) by e*i. See Fig. [\ref=fi:p5].

If w∈Tb(v) and Φ(w) = [figure]  ~   (resp., Φ(w) = [figure]  ~  ) then w is cut from above (resp., below) by e*i. See Fig. [\ref=fi:p6].

We now show that if 〈Gr,Gb〉 admits a Φ-transversal, then for each blue edge (the same argument would apply for red edges) there exists a unique traversing path.

Let Gr and Gb be two plane st-graphs with the same vertex set V and with distinct sources and sinks. Let Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }. If 〈Gr,Gb〉 admits a Φ-transversal, then for every edge e of Gb there is a unique traversing path πe in [formula].

If 〈Gr,Gb〉 admits a Φ-transversal Grb, then for every edge e = (u,v) of Gb there exists a path [formula], e*0, f1, [formula], fk - 1, e*k - 1, [formula] in [formula], which is the path used by e to go from [formula] to [formula] in Grb.

If f0 and fk coincide, then πe is a traversing path. Otherwise, we would have a cycle [formula], which is not possible since [formula] is acyclic, being the dual of a plane st-graph.

If f0 and fk do not coincide, let w be a vertex in the right path of fi. First, if w belongs to Lb(u), then it is cut from below. Otherwise, if w was cut from above, since edge e = (u,v) cannot cross the right path of fi twice (by condition c3), it would belong to Rb(u), a contradiction with the fact that the embedding of Gb is preserved. Thus p1 is respected by πe. With a symmetric argument we can also prove p2. Suppose now that w belongs to Bb(u), then [formula], otherwise if [formula], the blue path from w to u would violate c3. In other words, either Φ(w) = [figure]  ~   or Φ(w) = [figure]  ~  . Furthermore, if Φ(w) = [figure]  ~  , then w must be cut from above, while if Φ(w) = [figure]  ~  , then w must be cut from below, as otherwise the incoming blue edges to w must enter a region delimited by the blue path from w to u, the blue edge (u,v), and part of the (red) right path of fi, which violates the planarity of the embedding of Gb or condition c2 (see Fig. [\ref=fi:p3]). Thus p3 is respected by πe. With similar arguments one can prove p4 - p6. Hence, πe is a traversing set. To prove that πe is unique, note that any possible traversing set for e must start from f0 and leave this face. Hence, any vertex w on the right path of f0 must be cut from either above or below, according to properties p1 - p6 (which cover all possible cases for w). The only edge that can satisfy the cut condition for all vertices on the right path of f0, is an edge e*0 whose corresponding red primal edge, denoted by (x,z), is such that all vertices on the right path of f0 above x must be cut from below and all those below z must be cut from above. Clearly, this edge is unique. By repeatedly applying this argument for each face fi (0  ≤  i  <  k), the traversing path πe is uniquely identified.

The next theorem concludes the proof of Theorem [\ref=th:mainth].

Let Gr and Gb be two plane st-graphs with the same set of n vertices V and with distinct sources and sinks. Let Φ:V  →  H  =  {[figure] ~ ,[figure] ~ ,[figure] ~ ,[figure]  ~  }. There exists an O(n3)-time algorithm to test whether 〈Gr,Gb〉 admits a Φ-transversal.

Our testing algorithm aims to compute (if it exists) a Φ-transversal Grb for 〈Gr,Gb〉. We first fix the circular order of the edges restricted to the blue edges (resp., red edges) around each vertex u of Grb to satisfy c1 and to maintain the planar embedding of Gb (resp., Gr). We then fix the circular order of the blue edges with respect to the red edges around each vertex u of Grb to satisfy c2 (i.e., to obey Φ(u)). Then, we first check if for every blue edge e there exists a traversing path πe; if so, we verify that by routing every blue edge e through πe no two blue edges cross each other. If this procedure succeeds then 〈Gr,Gb〉 admits Φ-transversal Grb, because, by construction, the resulting embedding of Grb satisfies conditions c1, c2 and c3. Otherwise, either there exists a blue edge with no traversing path, or two traversing paths are such that the two corresponding edges of Gb cross if routed through them. In the first case 〈Gr,Gb〉 does not admit a Φ-transversal by Lemma [\ref=le:uniquetp]. In the second case, since the traversing paths are unique, condition c2 cannot be satisfied, and again 〈Gr,Gb〉 does not admit a Φ-transversal.

The testing algorithm works in two phases as follows.

Phase 1. For every edge e = (u,v)∈Eb. If [formula], we have found a traversing path. Otherwise, we label each vertex on the right path of [formula], by A if it must be cut from above or by B if it must be cut from below, according to properties p1 - p6. Then we check if the sequence of labels along the path is a nonzero number of A's followed by a nonzero number of B's. If so, then the dual edge of the traversing path is the one whose corresponding primal edge has the two end-vertices with different labels (which is unique). If this is not the case, then a traversing path for e does not exist. In the positive case, we add the dual edge we found and the next face we reach through this edge to πe and we iterate the algorithm until we reach either [formula] or the outer face of [formula]. In the former case πe is a traversing path for e, while in the latter case, since the edges of the outer face of Grb cannot be crossed by definition of Φ-transversal, we have that again no traversing path can be found.

Phase 2. We now check that by routing every edge e∈Eb through its corresponding traversing path πe, no two of these edges cross each other. Consider the dual graph [formula], which is a plane st-graph. Construct a planar drawing Γ of [formula]. Consider any two traversing paths πe and πe', which corresponds to two paths in Γ, and let e = (u,v) and e' = (w,z) be the two corresponding edges of Gb. Denote by [formula] and [formula] the two enriched paths. Enrich Γ by adding the four edges [formula], where x∈{u,v,w,z}, in a planar way respecting the original embedding of Gb. Consider now the subdrawing Γ' of Γ induced by [formula]. See Fig. [\ref=fi:crossingpaths] for an illustration. If e and e' cross each other, then [formula] cannot be empty. Moreover, the intersection [formula] must be a single subpath, as otherwise the two traversing paths would not be unique. Let f be the first face and let g be the last face in this subpath. Let eu be the incoming edge of f that belongs to the subpath of π̂e from u to f; and let ew be the incoming edge of f that belongs to the subpath of π̂e' from w to f. Also, let ev be the outgoing edge of g that belongs to the subpath of π̂e from g to v; and let ez be the outgoing edge of g that belongs to the subpath of π̂e' from g to z. Then e and e' cross if and only if walking clockwise along [formula] from f to g and back to f these four edges are encountered in the circular order eu, ez, ev, ew as shown in Fig. [\ref=fi:crossingpaths]. Note that, eu and ew may coincide if u = w, and similarly for ev and ez.

To conclude the proof we need to show that Phase 1 and Phase 2 can be implemented in O(n3) time. Checking if a traversing path exists for each edge in Eb (Phase 1) can be performed in O(n3) time. Namely, for each of these edges, we need to assign a label A or B to every vertex w on the right path of the traversed faces. This can be done by checking the existence of a path in the primal graph Gb or in the dual graph [formula], as by Lemma [\ref=le:tt], thus requiring O(n) time per vertex, O(n2) time per edge, and O(n3) time in total. Furthermore, checking if two of these edges would cross if routed through their traversing paths (Phase 2) can also be performed in O(n3) time. In fact, constructing a planar drawing of [formula] costs O(n) time [\cite=cp-ltadp-IPL95], while checking if two paths cross in the drawing costs O(n) time for each pair of paths, of which there are O(n2) in total. This concludes the proof.

Simultaneous RAC Embeddings via Simultaneous Visibility Representations with L-shapes

In this section, we show that Theorem [\ref=th:mainth] can be used to shed more light on the problem of computing a simultaneous RAC embedding [\cite=DBLP:journals/jgaa/ArgyriouBKS13] [\cite=DBLP:conf/walcom/BekosDKW15].

Given two planar graphs with the same vertex set, an SRE is a simultaneous embedding where crossings between edges of the two graphs occur at right angles. Argyriou et al. proved that it is always possible to construct an SRE with straight-line edges of a cycle and a matching, while there exist a wheel graph and a cycle that do not admit such a representation [\cite=DBLP:journals/jgaa/ArgyriouBKS13]. This motivated recent results about SRE with bends along the edges. Namely, Bekos et al. show that two planar graphs with the same vertex set admit an SRE with at most six bends per edge in both graphs [\cite=DBLP:conf/walcom/BekosDKW15].

We observe that any pair of graphs that admit a simultaneous visibility representation with L-shapes also admits an SRE with at most two bends per edge. This is obtained with the technique used in Section [\ref=se:characterization] to compute a Φ-transversal from a Φ-LSVR, see Fig. [\ref=fi:necessity]. Thus, a new approach to characterize graph pairs that have SREs with at most two bends per edge is as follows: Given two planar graphs with the same vertex set, add to each of them a unique source and a unique sink, and look for two st-orientations (one for each of the two graphs) and a function Φ such that the two graphs admit a Φ-LSVR.

As an application of this result, in what follows we show an alternative proof of another result by Bekos et al. that a wheel graph and a matching admit an SRE with at most two bends for each edge of the wheel, and no bends for the matching edges [\cite=DBLP:conf/walcom/BekosDKW15].

The wheel on n vertices, denoted by Wn, is an undirected graph with vertices [formula] and edges {(i,n):1  ≤  i  ≤  n - 1}, called spokes; and [formula], called rim edges. See Fig. [\ref=fi:W10M] for an illustration. A graph is a matching if no two of its edges share a common end-vertex and a complete matching if every vertex is the end-vertex of some edge.

We begin with the following observation, based on Theorem [\ref=th:4polar].

Let 〈Gr' = (V,Er'),Gb' = (V,Eb')〉 be a pair of undirected plane graphs. Let Φ:V  →  H  =  {[figure]  ~  }. Then 〈Gr',Gb'〉 admits a Φ-LSVR, if and only if Gr' and Gb' can be augmented and st-oriented to two plane st-graphs Gr and Gb, respectively, defined on the same set of vertices and with distinct sources and sinks, such that 〈Gr,Gb〉 admits a Φ-transversal.

We show that the wheel Wn and any matching M on the vertices of Wn has a Φ-LSVR  where Φ(v)  =  [figure]  ~   for all vertices v in Wn. To do this, we construct a Φ-transversal  for the pair 〈Gr,Gb〉, where Gr and Gb are plane st-graphs obtained from Wn and M, respectively.

We assume that n is even and M is a complete matching, though we will later see how to handle partial matchings. By symmetry, we may assume that vertex n is matched with vertex n - 1. Let [formula] be the edges in M where e1  =  (n - 1,n). Let the height, h(u), of a vertex u be the index of its edge in the matching, so if u∈ei then h(u)  =  i.

For all [formula], use the point (u,h(u)) to represent vertex u. Use the point (n / 2, - n2 / 2) to represent vertex n. Use the point (n / 2, - n2 / 2 - 1) to represent vertex n - 1. The drawing of Wn is straight-line planar because the spokes of the wheel do not intersect the rim edges since the slope of any rim edge (excluding (n - 2,n - 1) and (1,n - 1)) is in the range ( - n / 2, + n / 2).

To define Gr (the st-graph representing Wn), direct every rim edge (u,v) from smaller to larger height vertex. If both vertices have the same height (i.e., the edge is part of the matching), direct the edge from smaller to larger numbered vertex. Direct spoke edges (n,u) for 1  ≤  u  ≤  n - 2 from vertex n to vertex u. Direct spoke edge (n - 1,n) from vertex n - 1 to vertex n. Add the directed edge (sr,n - 1) and the directed edges (u,tr) for all 1  ≤  u  ≤  n - 1, where the points (n / 2, -   ∞  ) and (n / 2, +   ∞  ) represent sr and tr respectively. Finally, add the edge (sr,tr) on the outer face of Gr.

The drawing of M is also straight-line planar since its edges are all horizontal segments with different positive y-coordinates, except for (n - 1,n), which is vertical and spans only negative y-coordinates. To define Gb (the st-graph representing M), direct all edges from smaller to larger numbered end-point, so the edges are directed from left to right. Add the directed edge (sb,u) (resp., (u,tb)) for each vertex u that is the smaller (resp., larger) numbered end-point of an edge in M, where the points ( -   ∞  ,0) and ( +   ∞  ,0) represent sb and tb, respectively. Finally, add the edge (sb,tb) on the outer face of Gb.

To ensure condition c2 and preserve condition c3 of Theorem [\ref=th:4polar], we slightly modify the drawing of the edges in Gb (i.e., the blue edges). When drawn as straight-line segments, the head of every blue edge terminates in the left red face of its destination as desired, but the tail does not leave from the left red face of its origin, in general. This is easily fixed by drawing each blue edge (except those incident to sb) so that it leaves from the origin's left red face, heading to the left and slightly above the entering blue edge, and then loops to the right over the vertex to rejoin its original rightward horizontal path. See Fig. [\ref=fi:W10M].

All red edges (from Wn) are directed from bottom to top. Blue edges (from M), except for (n - 1,n) which is identical to the corresponding red edge (from Wn), intersect red edges only during the blue edges' rightward trajectories. Thus blue edges only cross red edges from left to right.

To represent a partial matching P, which is a complete matching M without some edges, for all edges [formula], we add edge (sb,v) and (u,tb) to Gb, routing the first slightly above and the second slightly below the existing blue path 〈sb,u,v,tb〉, and remove the edge (u,v) from Gb.

Final Remarks and Open Problems

In this paper we have introduced and studied the concept of simultaneous visibility representation with L-shapes of two plane st-graphs. We remark that it is possible to include in our theory the case when the vertices can also be drawn as rectangles. Nevertheless, this would not enlarge the class of representable pairs of graphs. In fact, for every vertex v drawn as a rectangle Rv, we can replace Rv with any L-shape by keeping only two adjacent sides of Rv in the drawing and prolonging the visibilites incident to the removed sides of Rv. The converse is not true. Indeed, roughly speaking, L-shapes can be nested, whereas rectangles cannot. To give an example, if a vertex v must see a vertex u both vertically and horizontally, this immediately implies that the two corresponding rectangles need to overlap, while two L-shapes could instead be nested. Several extensions of the model introduced in this paper can also be studied, e.g., the case where every edge is represented by a T-shape, or more generally by a +  -shape.

Three questions that stem from this paper are whether the time complexity of the testing algorithm in Section [\ref=se:test] can be improved; what is the complexity of deciding if two given plane st-graphs admit a Φ-LSVR for some function Φ, which is not part of the input; and what is the complexity of deciding if two undirected graphs admit a Φ-LSVR for some function Φ.