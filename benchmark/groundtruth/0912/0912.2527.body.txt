Feedback-Optimized Operations with Linear Ion Crystals

Introduction

Single trapped ions have been found as promising candidate system in quantum information processing. Quantum computing with up to 8 ions already has been successfully demonstrated[\cite=Haeffner2005]. However, the complexity of the control of an ion crystal in an electrostatic potential rapidly increases with the number of participating ions. Therefore, it is preferable to divide an ion trap in processing and storage regions where different actions like ion loading or ion addressing with specific laser pulses are performed [\cite=Haeffner2008] [\cite=Blatt2008]. A highly reliable method for the shuttling of ions in micro segmented traps [\cite=Schulz2007] is essential.

In current schemes, a predefined amount of ions has been shuttled between different areas of the trap, as required for a future quantum processor. The transport of single ions in a linear Paul trap and the symmetric separation of a two-ion crystal has been reported. Here a success probability exceeding 95% has been shown [\cite=Rowe2002]. Latest research in ion transport demonstrates shuttling through an X-junction[\cite=Blakestad2009]. Even optimal control theory has been used to evaluate best time-dependent potential alterations for fast non adiabatic transport of ions through the trap [\cite=Huber2008] and extended calculations [\cite=Reichle2006] are necessary to obtain proper results. However, the theoretical outcome of optimal control can't be directly transferred to the experiment because the calculated potentials are derived from a trap model which does not necessarily exactly match the real experimental situation. Fabrication imperfections cause aberrations between the real trap geometry and the theoretical model. Patch charges on the surface of the trap electrodes may even worsen the situation because voltage changes in the order of 10 μV can lead to a completely different potential for the ions. Similar problems may also occur for neutral atoms, where a deterministic transport has been accomplished by controlling the motion of a standing-wave in a dipole trap[\cite=Kuhr2001] and an optimal control scheme was proposed to improve the fidelity in a collisional gate [\cite=Grangier2009].

In our approach for controlling a multi-ion crystal our aim is to automate most of the operational building blocks. We are using the information from the observation of the ion crystal to feedback control the trap potentials in a robust way. Thus we have realized the transport of ions over 1 mm, the separation of single ions from a linear crystal and the re-joining of crystals in a realistic trap and without any prior knowledge of the potentials. Potential changes are sensed from ion locations and compensated automatically by the feedback system. Feedback techniques are commonly used with ion traps in situations such as feedback cooling of ions[\cite=BUSHEV], as well as error correction [\cite=Chiaverini2004] or teleportation [\cite=Barrett2004] [\cite=Riebe2004], as in all those cases the next steps of operation depend on the information read-out from the quantum system itself.

Photographic recording of a single ion was first realized in a radio frequency trap [\cite=Neu1980]. For single fluorescing neutral atoms in a magneto-optical or dipole trap, the discrete levels of fluorescence prove the trapping of zero or one atom [\cite=Grangier2001]. A sudden step is associated with the arrival and departure of individual trapped atoms[\cite=Hu1994] [\cite=Hau1996]. Sensitive CCD cameras allow for space and time resolved observation and imaging of single fluorescing atoms or ions which is essential for the work presented.

The paper is organized as follows: A description of the experimental setup as well as a short overview of the potential simulation is given in section [\ref=expsetup]. Automatic loading and detection of a certain number of ions is demonstrated in section [\ref=automaticloading]. In section [\ref=ionposition], we explain our method for estimating the position of trapped ions. Positioning ions via feedback-control and displacing them to a given position is shown in section [\ref=PIregulate]. We continue with the automatic separation of an ion crystal with an adaptive gain control and the splitting into separated potentials in section 6. We conclude with a discussion of future applications and improvements of our method.

Experimental setup

The segmented linear Paul trap consists of four blades, each featuring a total of 15 independent dc segments [\cite=Huber2008]. As the segments in the trap region are the most important, the middle electrode where the ion crystal is initially trapped is labeled as segment  M, wheras the segments to the left and to the right of the visual focus of the camera are labeled with increasing indices as {L1, L2,..} and {R1, R2,..}, respectively. The blades are assembled in a X-shaped manner. Each blade has an additional electrode on the edge facing to the ion. Two of those opposing segments are connected to the rf supply whereas the other two opposing are used for compensation (see Fig. [\ref=trap]).

Blade material is polyimide with a 18 μm copper plating on both sides, the strip lines are produced using standard lithography and etching techniques. The blades are electropolished to decrease surface roughness, additionally they are coated with gold in order to become a chemically inactive surface. The trap region we use consists of eight 700 μm wide segments separated by 100 μm wide strip lines. The radial distance between two trap electrodes equals 2 mm. The trap is housed in a stainless steel vacuum chamber. The base pressure is below 10- 12 mbar. The rf peak-peak voltage for the radial confinement equals Urf = 400 Vpp at Ω / 2π = 13.4 MHz resulting in a radial trappung potential with ωrad = 431.65 kHz/2π, exceeding the axial confinement. This ensures that up to ten ions arrange in a linear configuration. Fast dc-voltage control for each trap electrode is accomplished via a PC by an array of digital analog converters. Their voltages range from -10 V to 10 V with a resolution of 16 bit resulting in a smallest step-size of 300 μV. Each voltage supply is low-pass filtered (cutoff frequency 390 Hz).

The ionization of 40Ca atoms is accomplished with a two-photon process by laser light near 423 nm and 374 nm [\cite=Gulde2001]. For optical cooling and excitation, we illuminate the ion with laser light near 397 nm, 866 nm and 854 nm and observe continuous fluorescence. The detection system consists of a specifically designed lens with NA = 0.30 which is placed 61 mm from the trap center at an angle perpendicular to the trap axis, and an EMCCD camera featuring 1004 x 1002 pixels with a size of 8 x 8 μm2. A distance calibration with higher accuracy is obtained by measuring the axial frequency and the distance of two ions. By applying a rf voltage to segment L6, an ion oscillation in axial direction is stimulated. The currently chosen potential yields an axial frequency of 226.3  ±  0.2 kHz, the ions inter distance on the camera picture is 21.85  ±  0.02 pixel. This results in a distance calibration of 0.6908  ±  0.0005  μm/pixel [\cite=James1998]. The axial potential distribution may be simulated with the boundary element method using a three dimensional model of the trap [\cite=SingerRMP2009]. With given voltages on the individual segments, we extract the resulting axial potential.

Automatic ion loading and amount determination

For the determination of the amount of ions in the trap, images are taken by the EMCCD camera. These images contain the count distribution C(h,v) with {h, v} denoting the pixel position in horizontal and vertical direction, respectively. In the following, we describe a fast, real-time image analysis used to determine the number of ions and their positions. Compared to a standard off-line two dimensional Gaussian fit, our real time method allows for a fast feedback, with a slightly reduced position accuracy.

As the ion crystal only illuminates a small area on the EMCCD chip, we choose a region of interest of 60 ×   250 pixel from the full image of the camera. We sum the EMCCD counts over each column [formula] (see Fig. [\ref=locateIon] (b)). To get the amount of ions, we compute the maximum of C(h) and introduce a threshold parameter, which is varied between the average background noise B and Cmax. With this threshold parameter, it is possible to discriminate between closely spaced ions even if the fluorescence is overlapping and between unequally fluorescent ions stemming from the Gaussian profiled exciting laser beam. The background noise originates from stray light which is reflected back from the trap and readout noise of the EMCCD. In the next step, we set each value in C(h) which is below the threshold parameter to zero and get the array (h),see Fig. [\ref=locateIon] (c), containing regions with counts and regions with zeros, yielding the number of ions in the crystal. While continuously analyzing the current camera picture we load a predefined number of ions by opening and blocking the ionization light. The loading efficiency for any desired number between 1 and 10 ions is 100 % if the loading rate and the potential shape is chosen properly.

Ion position determination

For each ion, we determine the position h[formula] by utilising the following method

[formula]

where {C(h) - B} are pixel counts corrected by the noise level and h is chosen such that it covers the range of only one ion. On a recorded data set of 3000 images with an exposure time of τ=100ms, we made a comparison between our method for determining the position and the two dimensional Gaussian fit. Our method reached an accuracy of 170 nm, and the with a Gaussian fit yielded a 100 nm accuracy. Our method is preferable in situations where fast reaction time and robustness to variations of C(h) is crucial. As expected, the accuracy increases with [formula].

In the experiment, see Fig. [\ref=IonStringLong] we apply the location algorithm to an ion cyrstal consisting of eight ions, for a proper linear arrangement the rf amplitude is increased to 650 Vpp. Assuming a harmonic potential in the axial direction, the determined locations agree within about 1/7th of one pixel with theoretical values [\cite=James1998]. The automatically determined ion locations relative to the centered ion are (values in μm):

Feedback ion position regulation

To keep a single ion or an ion crystal fixed at one position in presence of external disturbances, we performed a feedback control. The trapping potential is created by a negative voltage on segment M and positive voltages on segment L1 and R1. We used a camera exposure time of 25 ms (maximum available gain). The feedback control was implemented by a digital proportional and integral (PI) controller which is fed with the position information [formula] from the ion position determination algorithm described above. Comparing the actual value with a target value [formula], the PI control regulates the ion position in axial direction by changing the voltage VL1 = [formula] - ΔVL1 of segment L1. The PI controlled voltage change ΔVL1 is calculated as

[formula]

where the integral term is updated in each step. It was found that a derivative term not improved the regulation. In the test routine, the ion was regulated alternating between the initial ion position and a position shifted 60 pixels to the left, which corresponds to a distance of 41.4 μm. The optimal PI gain is found for [formula] and I [formula] but the regulation works still if this values are set in between 0.5 and 2 of the optimum. Please note that the optimal gain depends on the trapping potential, see section [\ref=split].

In Fig. [\ref=PIDlong] the position of the ion is shown during the regulation at two distinct locations A and B as a function of the time. From a large number of transports, we determine a success probability of 99.8 % where the new position is achieved within a timespan of 600 ms. Interestingly, the required control voltage VL1 does barely show any variation for the consecutive transports, see also Fig. [\ref=PIVolt]. The algorithm has "learned" the way how to transport an ion. Only if external disturbances occur, the PI regulation will adapt the voltage ramp. Due to the robustness of our detection algorithm, the PI controller can handle strong disturbances of the trapping potential. It is only limited by the extension of the laser beam diameter with a FWHM of 76μm, as we need a sufficient number of fluorescence photons to gain an adequate signal-to-noise ratio for the PI regulator. A typical application for this kind of PI control may be a long time ion position regulator in ion traps where patch charges or other disturbances cause an axial ion drift in the time domain of the performed experiments.

Automatic splitting of an ion crystal

The separation is investigated in two different ways: Performing a symmetric separation, the ion crystal is divided such that two equal parts move equally far apart from the initial position into well separated axial potential wells. Typically, the initial position of the crystal is exactly above one trap control segment, whose voltage is ramped down [\cite=Rowe2002]. In the case of an asymmetric splitting, one or more ions may be kept at fixed positions while another part of the crystal is split off. Here, the position of the ion crystal is not limited to be exactly above a specific segment.

To split a two-ion crystal in the asymmetric mode, we start with a deep axial trapping potential created by a negative voltage on segment M and positive voltages on segment L1 and segment R1, respectively. This configuration results in a localization of the ion crystal above segment M. We reduce the potential depth by lowering the voltage supplied to segment M and control the axial position with segment L1, while segment R1 is held at a fixed value. The lowering of the potential is performed in such a way that the inter-ion distance increases linearly. With the relation between the minimal ion-ion distance in a harmonic potential and the axial frequency [formula] [\cite=James1998] and by using the relation [formula] between the axial trapping frequency ωax and the axial confinement voltage Vax, we find [formula]. In a segmented linear Paul trap with ions above segment M the axial voltage is given by : [formula], whereas the lower lateral voltage is taken. A linear increase of the ion-ion distance can be described by m  t + Δx0 where Δx0 denotes the initial distance and m the voltage alteration velocity. The voltage alteration on segment M for decreasing the potential depth is then given by:

[formula]

where the constant A is deduced from VM(t = 0). During the decrease of the trap depth, the minimum of the potential is also shifted but this is balanced with control segment L1 via the PI-control. However, the PI gain parameters need to be dynamically adapted for this task, contrary to the transport of ions in a potential with fixed axial trapping frequency. With a change of the axial trapping frequency, the system response changes accordingly. The spring constant in a harmonic potential is given by  =  - k with k = mω2ax. Changing k-values have to be compensated with the total PI-gain GPI acting as a multiplication factor on [formula]: [formula]. With the relation [formula] the gain is given by [formula]. By multiplying this total gain with the PI-values from equation([\ref=equ:PI]), the ion positioning is achieved for altering axial trapping frequencies. When the potential is deformed, the inter-ion distance increases. If the Coulomb repulsion energy exceeds the potential depth, then ions are leaving the trap, and the desired number of ions is kept in the crystal. In the experiment, we find an ion-ion distance of 60[formula] μm when only one ion is kept in the potential. The Coulomb energy reads [formula], which corresponds to a potential depth of Φ = E / e is 25[formula] μV. The loss of an ion can either be detected by a reduction of the fluorescence light on the EMCCD or from a sudden jump of the position of the remaining ion(s). Thus, we may even detect a non-fluorescing ion leaving the potential making this method applicable to ion crystals consisting of mixed ion species.

To show the high degree of automation, the separation algorithm has been repeated many times, see Fig. [\ref=splitIonsRepeat]. Both, the general shape of the voltage ramps and the control electrode voltages at the point when the ion crystal is splitted differ only slightly, here about 10 mV, from shot to shot.

We reach a success probability of 95 %. We have also realized the symmetric splitting of ion crystals which were positioned above segment M by starting with control voltages of 5 V, -2 V, -5 V, -2 V and 5 V for segment L2 to segment R2. When the potential depth is reduced by changing VM, the regulation of VL1 guarantees that the center of mass is not changed.

Automatic separation and reunification of ion crystals:

While in the previous section a part of the ion crystal was split off and lost, here we will describe a protocol to (i) separate crystals into different axial potential wells and (ii) recombine the parts again into one ion crystal. The scheme is illustrated in Fig. [\ref=splitpotential]. A confining potential is formed using the trap electrodes L4 to R1. When the voltage of electrode M is increased, the double well forms, and L1 is regulated according to the fluorescence position information. This way, a N-ion crystal is split in such a way that one ion is staying in its position while N-1 ions are shifted into a second potential well at the left hand side. If the protocol is reversed, the two ion crystals are recombined in the original potential.

In the experimental realization, we have used three and four-ion crystals, and kept the position of the outermost right ion fixed while the other part of the crystal was shifted into a separated potential well. The ion crystal may be recombined by merging the potential wells. Such a separation process can also be performed without the assistance of the camera. For that, the system has to learn the right voltage alterations. Therefore one successful separation process has to be accomplished during which the voltage alterations for the segments are recorded (see Fig.[\ref=splitIonsRepeat]). Higher separation velocities can be achieved by replaying the learned voltage sequence with a speed up factor of up to 20.

Conclusion and Outlook

We have presented an experimental realization of self-adapting and self-regulated algorithms for the automation of fundamental transport routines in a segmented linear Paul trap which are important for quantum information processing with trapped ions. A sensitive camera for the ion detection and a software control of each trap segment is used for building a feedback loop. We show the feedback controlled positioning of an ion to specific locations in the axial direction of the trap via a software PI regulator. By creating two trapping potentials in the axial direction and merging them into a single potential well, we have shown the separation and reunification of ion strings.

For the future, we envision several improvements of our method: The detection and the overall control loop can be sped up, when we use a faster EMCCD camera or only read out a subsection of the image. In our trap, a segment width of 700μm dictates large ion-ion distances, and therefore low trap frequencies when the splitting occurs. Thus, a major increase in speed is expected when we will apply the method to ion crystals which are stored in a segmented micro ion trap with segment dimensions as small as 125μm [\cite=Schulz2007], where the trap control segments are optimized for ion transport and splitting operations. Another improvement will be a more sophisticated feedback loop. Optimized gradient search may be helpful, especially when not only a single but multiple trap control parameters need to be adapted. Finally, we intend to apply feedback methods not only to the position of the ion crystals, but also to the internal electronic qubit states.

We acknowledge financial support by the Landesstiftung Baden-Württemberg in the framework of the excellence program, the European Commission EMALI (Contract No. MRTN-CT-2006-035369) and STREP MICROTRAP (Contract No. FP6-IST-517675) and the BMBF (06UL264I). We thank W. Schnitzler for proofreading and R. Maiwald for important contributions at an earlier stage of the experiment.