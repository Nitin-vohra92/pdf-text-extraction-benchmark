=10000 =10000

Theorem Lemma Proposition Corollary Definition Construction Notations Assumption Setting Remark Example

Remarks on Ekedahl-Oort stratifications

Abstract: This short paper is a continuation of the author's Ph.D thesis, where Ekedahl-Oort strata are defined and studied for Shimura varieties of Hodge type. The main results here are as follows.

1. The Ekedahl-Oort stratification is independent of the choices of symplectic embeddings.

2. Under certain reasonable assumptions, there is certain functoriality for Ekedahl-Oort stratifications with respect to morphisms of Shimura varieties.

Introduction

Let (G,X) be a Shimura datum of Hodge type, and [formula] be the Shimura variety attached to a compact open subgroup [formula]. We assume that K = KpKp, where Kp is hyperspecial, i.e. there is a reductive group [formula] such that [formula] and that [formula]. By works of Deligne, [formula] is defined over a number field E. Let v be a place of E over p, then Kisin proved in [\cite=CIMK] that [formula] has a smooth model [formula] over OE,(v). Moreover, [formula] is uniquely determined by the Shimura datum in the sense that [formula] satisfies a certern extension property (see [\cite=CIMK] 2.3.7 for a precise statement).

Ekedahl-Oort stratifications for good reductions of Shimura varieties of Hodge type were defined and studied in [\cite=EOZ] using [\cite=CIMK] and [\cite=zipaddi]. Let κ = OE,(v) / (v) and [formula] (resp. G0) be the special fiber of [formula] (resp. G). The Shimura datum determines a cocharacter [formula] which is unique up to G0(κ)-conjugacy. We constructed in [\cite=EOZ] a morphism [formula], where G0μκ is the stack of G0-zips of type μ (see [\cite=zipaddi] or § 1.2 of this paper). Fibers of ζ are Ekedahl-Oort strata. Note that to construct ζ, we need to fix a symplectic embedding.

There are many basic questions that were not solved in [\cite=EOZ]. Here we mention two of them.

1. Whether the Ekedahl-Oort stratification (namely, the morphism ζ) is independent of the choices of symplectic embeddings.

2. How to study behavior of stratifications under morphisms of Shimura varieties.

The motivation for the first question is the observation that both the reduction of the Shimura variety and the "list" of Ekedahl-Oort strata are independent of choices of symplectic embeddings. While the second one is a question that can not be more natural.

The first question is solved by the following theorem.

The morphism ζ is uniquely determined by (G,X) and μ, and hence independent of choices of symplectic embeddings.

The first section is devoted to a proof of the above result.

The second question is too general and too inexplicit to study, so we raise the following question. Let f:(G,X)  →  (G',X') be a morphism of Shimura data of Hodge type. Let E and E' be their reflex fields. Then E  ⊇  E'. Let [formula] and [formula] be such that Kp and K'p are hyperspecial. Assume that f(K)  ⊆  K', then there is a morphism [formula]. Let v' be a place of E' over p with residue field κ' and v be a place of E over v' with residue field κ, then there is a morphism [formula] extending f. Still write f for the morphism on special fibers [formula]. Let G0 (resp. G'0) be the reduction of G (resp. G'), and let μ (resp. μ') be the cocharacter unique up to conjugacy. Then there is a morphism [formula] (resp. [formula]) giving the Ekedahl-Oort strata on [formula] (resp. [formula]).

The question is, whether there is any compatibility between f, ζ and ζ'. We have the following result.

Assume that [formula] extends to a morphism of reductive group schemes over [formula], then there is a canonical commutative diagram

[formula]

The proof to the above result will be given in the second section.

As we have seen, the second question is not yet totally solved. More questions will be raised and studied in the author's future research.

Independence of symplectic embeddings

Let (G,X) be a Shimura datum of Hodge type with good reduction at a prime p > 2. Let E be the reflex field and v be a place of E over p. The residue field at v will be denoted by κ. Let [formula] be a hyperspecial subgroup, and [formula] be a compact open subgroup which is small enough. Let K be Kp  ×  Kp. Then by [\cite=CIMK], the Shimura varieties [formula] has an integral canonical model [formula] which is smooth over OE,(v).

Let [formula] be the special fiber of [formula]. By the main results of [\cite=EOZ], there is a theory of Ekedahl-Oort stratification on [formula]. To define the stratification, we need to fix a symplectic embedding, while the variety [formula] is independent of symplectic embeddings. A natural question is whether different symplectic embeddings give the same stratification.

The above question is not yet precise enough to work with. Let us first recall how Ekedahl-Oort stratifications are defined and raise precise questions.

Integral canonical models

Let Kp and G be as above, then by [\cite=INTV] Proposition 3.1.2.1 c) and e), [formula] extends uniquely to a reductive group [formula] such that [formula]. More precisely, for any two extensions [formula] and [formula] such that [formula] and [formula], there is an unique isomorphism f:1  →  2 such that [formula] and that [formula].

Let [formula] be a symplectic embedding. Then by [\cite=CIMK] Lemma 2.3.1, there exists a [formula]-lattice [formula], such that [formula] extends uniquely to a closed embedding [formula] So there is a [formula]-lattice L  ⊆  V such that G, the Zariski closure of G in [formula], is reductive, as the base change to [formula] of G is [formula]. Moreover, we can assume L is such that [formula]. Let [formula] and [formula], then the integral canonical model [formula] of [formula] is constructed as follows. We can choose [formula] small enough such that K'  ⊇  K and that [formula] affords a moduli interpretation. There is a finite morphism [formula]. Let [formula] be the moduli scheme of abelian schemes over [formula]-schemes with a polarization of degree d and level K' structure. Then [formula]. The integral canonical model [formula] is the normalization of the Zariski closure of [formula] in [formula]. Here the word "normalization" make sense. As [formula] is regular, and on each open affine, [formula] is obtain by taking elements in [formula] that is integral over [formula].

Note that we didn't assume that K' is such that the morphism f is a closed embedding. Because if we take K''  ⊆  K' small enough such that the induced morphism

[formula]

is a closed embedding, then f factors through g. The natural morphism [formula] is finite, so the normalization gives the same [formula]. The special fiber of [formula] will be denoted by [formula].

G-zips

Let G0 (resp. L0) be the special fiber of G (resp. [formula]). We remark that G0 is uniquely determined by (G,Kp), as it is also the special fiber [formula] which is uniquely determined by (G,Kp). But L0 is not unique, there might be many choices. By [\cite=EOZ], the Shimura datum (G,X) determines a cocharacter [formula] which is unique up to (W(κ))-conjugacy. The special fiber of μ will still be denoted by μ.

Let S be a scheme over κ. A G0-zip of type μ over S is a tuple  = (I,I+,I-,ι) consisting of a right Gκ-torsor I over S, a right P+-torsor I+  ⊆  I, a right P(p)--torsor I-  ⊆  I, and an isomorphism of L(p)-torsors ι:I(p)+ / U(p)+  →  I- / U(p)-.

A morphism (I,I+,I-,ι)  →  (I',I'+,I'-,ι') of G0-zips of type μ over S consists of equivariant morphisms I  →  I' and I±  →  I'± that are compatible with inclusions and the isomorphisms ι and ι'.

The category of G0-zips of type μ over a κ-scheme S will be denoted by G0μκ(S). They form a fibered category G0μκ over the category of κ-schemes if we only consider isomorphisms as morphisms.

Pink, Wedhorn and Ziegler proved the following result.

The fibered category G0μκ is a smooth algebraic stack over κ of dimension 0.

This is [\cite=zipaddi] Corollary 3.12.

Ekedahl-Oort strata

Now we will explain how to construct Ekedahl-Oort stratification follow [\cite=EOZ]. Note that we will NOT follow [\cite=EOZ] strictly, as it seems more natural to compare [formula] with cohomologies, see also [\cite=LRKisin] and [\cite=muordinary]. Our theory of Ekedahl-Oort stratification is base on the theory of G0-zips of type μ defined and studied by Pink, Wedhorn and Ziegler in [\cite=zipaddi].

Let A be the pull back to [formula] of the universal abelian scheme on [formula], and V be [formula]. Let L  ⊆  V and G be as in [\ref=intcanmod]. Then by [\cite=CIMK] Proposition 1.3.2, there is a tensor [formula] defining [formula] Corollary 2.3.9 of [\cite=CIMK] implies that the tensor [formula] induces a section [formula]. By [\cite=EOZ] Lemma 2.3.2 1), the scheme

[formula]

is a right G-torsor.

The first main result of [\cite=EOZ] is as follows.

1) Let I+  ⊆  I be the closed subscheme

[formula]

Then I+ is a P+-torsor over [formula].

2) Let I-  ⊆  I be the closed subscheme

[formula]

Then I- is a P(p)--torsor over [formula].

3) Let ι:I(p)+ / U(p)+  →  I- / U(p)- be the morphism induced by Then ι is an isomorphism of L(p)-torsors.

Hence the tuple (I,I+,I-,ι) is a G0-zip of type μ over [formula].

This is [\cite=EOZ] Theorem 2.4.1.

The G0-zip of type μ over [formula] constructed above induces a morphism [formula]. As we have seen, to construct ζ, we need to choose a [formula]-model G of G, a symplectic embedding [formula], a [formula]-lattice [formula], and a tensor [formula] defining G. So, by independence of symplectic embeddings, we mean that ζ is independent of the choices of G, i, [formula] and s.

Uniqueness of G

The [formula]-model G of G we obtained is actually unique.

Let V1 and V2 be two finite dimensional [formula]-vector spaces. Let [formula] and [formula] be two closed embeddings of reductive groups. Assume that there is a [formula]-lattice L1  ⊆  V1 (resp. L2  ⊆  V2) such that the Zariski closure G1 (resp. G2) of G in [formula] (resp. [formula]) is reductive. Then [formula]

Let [formula] be the direct sum of the two representations i1 and i2, let [formula]. The we have a sequence of closed embeddings [formula] Let [formula] be the reductive model of [formula] and G3 be the Zariski closure of G in [formula]. Then [formula]. Flat base-change implies that [formula] is the diagonal subgroup of [formula]. So G3 is reductive. Note that the morphism [formula] is an isomorphism, so [formula]. Similarly, [formula].

Let [formula] be a reductive model of G. Then there exists a free [formula]-module M of finite rank such that there is a closed embedding [formula]. The generic fiber of this embedding satisfies the condition of the above proposition. So two reductive models over [formula] of G must be isomorphic.

Comparing G0-zips (I)

We will first show that the morphism ζ does not depend on the choices of s, once G, i and [formula] are fixed. Let us recall our notations and constructions in [\ref=intcanmod].

For the symplectic embedding [formula] and a the chosen reductive model [formula] of G, there is a [formula]-lattice L  ⊆  V such that the Zariski closure of G in [formula] is G and that G is defined by a tensor [formula]. One can choose L such that [formula]. Let [formula], [formula], [formula] and K = KpKp with [formula] small enough. Then the integral canonical model [formula] of [formula] is constructed as follows. We can choose [formula] small enough such that K'  ⊇  K and that [formula] affords a moduli interpretation. There is a finite morphism [formula]. Let [formula] be the moduli scheme of abelian schemes over [formula]-schemes with a polarization of degree d and level K' structure. Then [formula], and the integral canonical model [formula] is the normalization of the Zariski closure of [formula] in [formula].

Let A be the pull back to [formula] of the universal abelian scheme on [formula], and V be [formula]. Then the tensor [formula] induces a section [formula]. For a different choice of [formula], we have another section [formula] We have two G-torsors

The two G-torsors I and I' are canonically isomorphic.

We will show that I and I' are the same closed subscheme of [formula]. Let

[formula]

Then it is a closed subscheme of both I and I'. But I'' is also a G-torsor over [formula], so I = I'' = I'.

Let [formula] (resp. G0) be the special fiber of [formula] (resp. G). The construction in [\ref=EOstrata], especially Theorem [\ref=G-zipES_0], gives a G0-zip of type μ (I,I+,I-,ι) on [formula], using [formula] and the F-zip structure on V. Similarly, there is a G0-zip (I',I'+,I'-,ι') attached to [formula].

The two G0-zips of type μ (I,I+,I-,ι) and (I',I'+,I'-,ι') on [formula] are canonically isomorphic.

By Lemma [\ref=torI], the torsors I and I' are canonically isomorphic. Noting that (I+,I-,ι) and (I'+,I'-,ι') are constructed using Frobenius and Verschiebung on V, the two G0-zips are canonically isomorphic.

Symplectic embeddings

Let [formula] and [formula] be two symplectic embeddings. We can construct another symplectic embedding as follows.

By definition of symplectic similitude groups, there is a character [formula], such that [formula] acts on ψ1 via χ1. Note that changing χ1 to a power of it will not change the symplectic similitude group. Similarly, we have [formula]. Let [formula] be the weight cocharacter of G. Then [formula] and [formula] are two characters [formula] of weights m1 and m2 respectively. After changing χ1 to χm21 and χ2 to χm12, we see that G acts on ψ1 and ψ2 via the same character.

Let [formula] and [formula] be such that

[formula]

Then [formula], and this embedding induces an embedding of Shimura data

[formula]

Comparing G0-zips (II)

Now we will show that the morphism [formula] is independent of choices of symplectic embeddings, reductive models and lattices. Note that ζ is independent of K. More precisely, for K  ⊆  K', there is a commutative diagram

[formula]

inducing a [formula]-equivariant morphism

[formula]

Here the [formula]-action on [formula] is the trivial action, and that on [formula] is the unique one induced by the action on [formula]. So, we can shrink Kp if necessary.

Let [formula] and [formula] be two symplectic embeddings. Let G be the reductive model of G over [formula] such that [formula] There are lattices Lt  ⊆  Vt, t = 1,2, such that 1. ψt takes integral value on Lt. 2. The Zariski closure of G in [formula] is G.

Let [formula], [formula], and n  ≥  3 be an integer such that (n,p) = 1. Let [formula] be the moduli scheme of abelian schemes over [formula]-schemes of relative dimension gt with a polarization λt of degree dt and a level n structure τt. We write (At,λt,τt) for the universal family on [formula]. Let [formula] be small enough such that there are natural morphisms [formula] and [formula]. Then by the construction of the integral canonical model, there are natural finite morphisms [formula] and [formula].

Let V be [formula], L be [formula] and [formula] be such that

[formula]

Then by [\ref=sum_of_ebd], there is an embedding of Shimura data [formula]. Consider the diagram

[formula]

The abelian scheme p*1(A1,λ1,τ1)  ×  p*2(A2,λ2,τ2) on [formula] is an abelian scheme of dimension g1 + g2 with a polarization of degree d1d2 and level n structure. There is a unique morphism

[formula]

such that

[formula]

where (A,λ,τ) is the universal family on [formula].

By the construction of [formula], we have a commutative diagram

[formula]

such that the generic fiber of [formula] is induced by i. We will write i for [formula]. The pull back via i of the universal family on [formula] is precisely i*1(A1,λ1,τ1)  ×  i*2(A2,λ2,τ2).

Let A1,A2,A be the pull back to [formula] of the universal abelian schemes on [formula], [formula] and [formula] respectively. Then A  =  A1  ×  A2. Let [formula], t = 1,2, and [formula]. Then [formula].

Let [formula] and [formula] be as before. Let [formula] be a tensor defining [formula], for t = 1,2. By our construction, we have a sequence of closed embeddings Here the first embedding is the diagonal embedding.

By [\cite=CIMK] Proposition 1.3.2, [formula] is defined by a tensor [formula] We need some explicit conditions that cut out [formula]. First note that [formula] is the subgroup of [formula] respecting the splitting [formula] So the group scheme G  ×  G is such that for any [formula]-algebra R,

[formula]

But then G will be the group scheme such that for any [formula]-algebra R,

[formula]

Clearly, if we remove the conditions on L2 and s2, we get the same group scheme.

Let [formula] (resp. [formula]) be the section corresponding to s1 (resp. s). Let

[formula]

where [formula] is given by taking dual of the surjection [formula].

The scheme I is a right G-torsor over [formula].

By [\cite=CIMK], the direct summand [formula] induces a direct summand [formula]. To prove the lemma, it suffices to prove that [formula]. But then it suffices to prove that

[formula]

As if we denote by Grass2g1V the [formula]-scheme of locally direct summands of V with rank 2g1. Then Grass2g1V is proper over [formula]. The sub-bundles [formula] and V1  ⊆  V induce an [formula]-morphism [formula]. That [formula] means that the restriction to [formula] of i factors through the diagonal. But the diagonal is closed and [formula] is reduced, so i factors through the diagonal, which means that [formula].

But [formula] follows from the construction of these two bundles. We will follow [\cite=CIMK] 2.2 and work with [formula] and [formula]. They are both closed subschemes of [formula], so to prove that they are equal, it suffices to prove that

[formula]

But then one can pass to [formula] and use descent. Let [formula] be the pull back to [formula] of [formula]. Then by the de Rham isomorphism, [formula] equals to the vector bundle attached to the variation of Hodge structures given by X and [formula]. Note that the quotient by [formula] of these two bundles give [formula] and [formula] on [formula] respectively, so [formula].

We write i1,i2,p1,p2,i for the morphisms of the special fibers. To prove that the Ekedahl-Oort stratifications are independent of choices of symplectic embedding, it suffices to prove that the stratifications induced by i1 and i coincide. By Corollary [\ref=inpe_of_tensors] and the proof of Lemma [\ref=I_is_torsor], the special fiber of I is precisely the G0-torsor in the G0-zip over [formula] constructed using i. Let us write I for this special fiber and (I,I+,I-,ι) for the G0-zip constructed using i. Let (I1,I1, +,I1, -,ι1) be the G0-zip over [formula] constructed using i1.

There is a natural morphism ε:I  →  I1 given by

[formula]

The morphism ε induces an isomorphism (I,I+,I-,ι)  →  (I1,I1, +,I1, -,ι1) of G0-zips. In particular, i1 and i give the same Ekedahl-Oort stratification.

The morphism ε:I  →  I1 is clearly G0-equivariant, and hence an isomorphism of G0-torsors. For any [formula], and any f∈I+(S)  ⊆  I(S), f maps the weight 1 subspace of [formula] to [formula], where F is the Frobenius on V. Let F1 be the Frobenius on V1, then [formula], as V1  ⊆  V is induced by a morphism of abelian schemes and hence compatible with Frobenius. So [formula] maps the weight 1 subspace of [formula] to [formula], and hence lies in I1, +(S). But then ε|I+ will automatically be an isomorphism of P+-torsors. Similarly, ε|I- is an isomorphism of P(p)--torsors.

Now we check the compatibility between ι and ι1. We first recall how ι and ι' are defined in Theorem [\ref=G-zipES_0] 3). Let φ0, φ1 be as in Setting [\ref=F-zip_attached_to_abs], and φ0, φ1 be as in Setting [\ref=phi_in_standard_G-zip]. Then ι:I(p)+ / U(p)+  →  I- / U(p)- is the morphism induced by

We apply the constructions in Setting [\ref=F-zip_attached_to_abs] and Setting [\ref=phi_in_standard_G-zip] to V1 and [formula] respectively, and denote the obtained morphisms by φ'0, φ'1, φ'0 and φ'1. Let [formula] (resp. [formula]) be the subspace of [formula] of weight 0 (resp. 1) with respect to μ, and [formula] (resp. [formula]) be the subspace of [formula] of weight 0 (resp. 1) with respect to μ(p). Then φ'0 and φ'1 are compatible with φ0 and φ1, in the sense that

[formula]

and

[formula]

Let F':V(p)1  →  V1 and V':V1  →  V(p)1 be the Frobenius and Verschiebung on V1 respectively. Then V and F are compatible with V' and F'. This implies that

[formula]

and

[formula]

Then [formula], we have This shows that ε is an isomorphism of G0-zips.

The Ekedahl-Oort stratification does not depend on the choices of symplectic embeddings. So in particular, the theory of ordinariness is independent of symplectic embeddings. This coincides with the expectation that the variety [formula] should have an interpretation as moduli space of "abelian motives with G-structure". This moduli interpretation should be intrinsically determined by the Shimura datum, and hence independent of symplectic embeddings.

A theory of Bruhat stratification has been defined and studied by Wedhorn in [\cite=BruhatandFzip] (actually, we need the morphism ζ to define the Bruhat stratification on [formula]). In the case of Siegel modular varieties, the Bruhat stratification is precisely the a-number stratification. Theorem [\ref=inpe_of_symp] also implies that the Bruhat stratification is independent of symplectic embeddings.

Functoriality

Let p be a prime bigger than 2, and (G,X) and (G',X') be two Shimura data of Hodge type such that they both have good reduction at p. Let E (resp. E') be the reflex field of (G,X) (resp. (G',X')). Let K (resp. K') be a compact open subgroup of [formula] (resp. [formula]) such that Kp (resp. K'p) is hyperspecial. Let f:(G,X)  →  (G',X') be a morphism of Shimura data, then E  ⊇  E'. If K and K' are such that f(K)  ⊆  K', then f induces a morphism of Shimura varieties [formula].

Let v' be a place of E' over p with residue field  κ' and v be a place of E over v' with residue field κ. Let [formula] (resp. [formula]) be the integral canonical model of [formula] (resp. [formula]). Then f extends uniquely to a morphism [formula] whose special fiber [formula] will still be denoted by f.

By "functoriality", we mean a certain kind of compatibility of Ekedahl-Oort stratifications with respect to f. But it seems that we need some extra assumptions. The reason is as follows. For a morphism [formula] such that f(Kp)  ⊆  K'p, it is NOT always possible to extend f to a morphism G1  →  G2 (see [\cite=INTV] Proposition 3.1.2.1 b)). So there is NO natural morphism G0  →  G'0, and hence there is NO direct way to compare G0-zips and G'0-zips.

Basic settings

Let [formula] (resp. [formula]) be the reductive model of G (resp. G') with special fiber G0 (resp. G'0). Let E, E', κ and κ' be as at the beginning of this section. Then by [\cite=EOZ] Proposition 2.2.4, the Shimura datum (G,X) (resp. (G',X')) determines a cocharacter μ (resp. μ') of GW(κ) (resp. G'W(κ')) which is unique up to conjugacy. The reduction of μ (resp. μ') will still be denoted by μ (resp. μ').

Besides the conditions stated at the beginning of this section, we make the following assumption on f:(G,X)  →  (G',X').

The morphism α

The morphism [formula] induces a natural morphism [formula] which we will now explain. Still write μ for the cocharacter [formula], then μ and μ' are G'0(κ)-conjugate.

There is a natural morphism [formula] as follows. The cocharacter μ induces homomorphisms P+  →  P'+, P-  →  P'- and L  →  L'. For any κ-scheme S and any S-point (I,I+,I-,ι) of [formula],

[formula]

where ?1  ×  ?2?3 is the quotient of ?1  ×  ?3 equalizing the ?2-action on ?1 given by the torsor structure and that on ?3 induced by [formula], and ι' is the composition of L'(p)-equivariant isomorphisms

Let [formula] be the base change to κ of the cocharacter μ', then by [\cite=muordinary] Remark 5.16 1), then there is an obvious isomorphism [formula] given by base change. Let g∈G'0(κ) be such that [formula], then g induces an isomorphism of algebraic stacks where rσ(g) and rσ(g)- 1 are the obvious morphisms I'(p)+ / U'(p)+≃I(p)+ / U(p)+ and I- / U(p)-≃I'- / U'(p)- given by multiplication with σ(g) and σ(g)- 1 on the right respectively.

The morphism αg3 is canonical, in the sense that it is uniquely determined by μ and [formula] and does not depend on the choices of g. For an h∈G'0(κ) such that [formula], there exists an l∈L'(κ), such that h = gl. Here L' is, as before, the centralizer in G'0,κ of μ'. Then The last equality is because of that I+ (resp. I-) is L' (resp. L'(p)) stable and that ι is L'(p)-equivariant. We will simply write α3 for αg3, as it is independent of g.

The morphism α is defined to be [formula]

Functoriality

We use the same notations as at the beginning of this section. Let [formula] and [formula]. Moreover, we assume that the morphism of Shimura data f:(G,X)  →  (G',X') satisfies Assumption [\ref=nece_asp].

By functoriality, we mean the following.

The diagram

[formula]

is commutative.

The proof, which is a variation of that of Theorem [\ref=inpe_of_symp], will be divided into several steps.

Step 1. Let [formula] and [formula] be symplectic embeddings. Note that we do NOT assume that there is any compatibility between f and the symplectic embeddings. The weight cocharacter [formula] induces a [formula]-action on V of weight 1, and the composition [formula] induces a [formula]-action on V' of weight 1. Let [formula] and [formula] be such that

[formula]

Then i and [formula] induce a faithful representation of G on V1. Moreover, the argument in [\ref=sum_of_ebd] shows that [formula] and this embedding induces an embedding of Shimura data

[formula]

Step 2. There is a [formula]-lattice L  ⊆  V (resp. L'  ⊆  V') such that the Zariski closure of G (resp. G') in [formula] (resp. [formula]) G (resp. G') is reductive and such that [formula] (resp. [formula]). Let L1 be [formula]. Consider the sequence of closed embedings Let G1 be the Zariski closure of G in [formula]. Then G1  ⊆  G  ×  G'. Flat base-change implies that [formula] is the graph of [formula]. So [formula] and [formula] is defined over [formula].

Step 3. Let [formula] (resp. [formula], [formula]) be a tensor defining [formula] (resp. [formula], [formula]). Then [formula] is such that for all [formula]-algebra R, But then G is the group scheme such that for any [formula]-algebra R,

Step 4. By our constructions in [\ref=Comparing_G_0-zips_(II)], the symplectic embeddings i, i' and i1 induce vector bundles V, V' and V1 on [formula]. The tensor s, s' and s1 induce tensors [formula], [formula] and [formula] respectively. Note that we have [formula]. Let (I,I+,I-,ι) be the G0-zip on [formula] constructed using i, and (I1,I1, +,I1, -,ι1) be the G0-zip over [formula] constructed using i1. Then by Theorem [\ref=inpe_of_symp], [formula] We twist (I1,I1, +,I1, -,ι1) by (G'0,κ,μ) using constructions at the beginning of [\ref=The_morphism_alpha], and get a G'0-zip of type μ over [formula] denoted by (I'1,I'1, +,I'1, -,ι'1).

Step 5. Let (I',I'+,I'-,ι') be the G'0-zip of type μ' over [formula] constructed using i'. Let (I',I'+,I'-,ι')κ be the pull back to [formula] of (I',I'+,I'-,ι'). The construction before Remark [\ref=unique_alpha_3], (I',I'+,I'-,ι')κ gives a G'0-zip of type μ over [formula] which will still be denoted by (I',I'+,I'-,ι')κ. Let ε:I'1  →  I' be the morphism given by restriction to [formula]. Then ε is an isomorphism of G'0-torsors. By the proof of Theorem [\ref=inpe_of_symp], ε induces an isomorphism of G'0-zips of type μ. But this means that the diagram

[formula]

is commutative.

Basic examples

Here we give some basic examples where Assumption [\ref=nece_asp] is satisfied.

Let [formula] be a symplectic embedding. There exists a [formula]-lattice L'  ⊆  V' such that the Zariski closure G of G in [formula] is reductive. The polarization ψ' is not necessarily perfect pairing on [formula]. But by Zarhin's trick, we can take [formula], then ψ' induces a perfect paring on L which will be denoted by ψ. Then the Zariski closure of G in [formula] lies in [formula], and hence there is an embedding [formula]. So there is a commutative diagram

[formula]

Let (G,X) be a Shimura datum of PEL type with good reduction at p. Let [formula] be the tautological symplectic embedding. Then there is again a commutative diagram

[formula]

Email: czhangmath.leidenuniv.nl or zhangchao1217gmail.com