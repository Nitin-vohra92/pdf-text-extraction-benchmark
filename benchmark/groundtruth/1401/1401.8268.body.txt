On the similarity of meshless discretizations of Peridynamics and Smooth-Particle Hydrodynamics

Introduction

The Peridynamic theory, originally devised by Silling [\cite=Silling:2000/a], is a nonlocal extension of classical continuum mechanics, which is based on partial differential equations. Since partial derivatives do not exist on crack surfaces and other singularities, the classical equations of continuum mechanics cannot be applied directly when such features are present. In contrast, the Peridynamic balance of linear momentum is formulated as an integral equation, which remains valid in the presence of material discontinuities. Therefore, the Peridynamic theory can be applied directly to modelling both bulk and interface properties, using the same mathematical model. Additionally, Peridynamics is readily implemented in a meshless formulation, which facilitates the simulation of large deformations when compared to the traditional mesh-based Finite-Element method used for simulating solid mechanics in the classical continuum theory [\cite=Bower:2011/a].

With these desirable features, Peridynamics has received considerable attention by researchers interested in numerically describing fundamental crack growth and failure effects in brittle materials [\cite=Silling:2010/a] [\cite=Ha:2010/a] [\cite=Ha:2011/a] [\cite=Agwai:2011/a]. However, the scope of the original Peridynamic formulation included only so-called bond-based models [\cite=Silling:2005/a] which were limited to a fixed Poisson ratio for linear isotropic materials and could not describe true plastic yielding. Further development of the theory led to state-based models [\cite=Silling:2007a], which can, in principle, describe all classic material behaviour. In particular, the state-based theory offers a route to approximating the classical deformation gradient, which can be used to obtain a classical stress tensor. The stress tensor can then be converted into nodal forces using a Peridynamic integral equation. This promising situation, i.e., the ability to use classical material models with a method that remains valid at material discontinuities, has prompted a number of studies where plastic yielding, damage, and failure was simulated using this new meshless method [\cite=Warren:2009/a] [\cite=Foster:2010/a].

However, there exists a demand for studies which compare Peridynamics to other meshless methods. While the theoretical correspondence of Peridynamics with classical elasticity theory has been established [\cite=Silling:2008/a], no information is available on the accuracy of the discretized Peridynamic expression suitable for computer implementation. Relevant questions that need to be addressed include, but are not limit to, whether linear fields can be exactly reproduced by the discretized theory, and what the the order of convergence is when Peridynamic solutions are compared against exact results. Little is known about how common problems encountered with other meshless methods, e.g., the tensile instability [\cite=Swegle:1995/a] or the rank deficiency problem [\cite=Belytschko:2000/a] affect Peridynamics. As an exception to this general observation, Bessa et al [\cite=Bessa:2014/a] have published a study which demonstrates the equivalence of state-based Peridynamics and the reproducing Kernel Particle Method (RKPM), if nodal integration is used. However, no published studies are available to the best of this author's knowledge, which compare Peridynamics to other meshless methods.

The goal of our paper is to elucidate on some properties of Peridynamics with respect to other meshless methods. In particular, we establish that the discrete equations of the Peridynamic formulation using classical material models is identical to a very well-known meshless technique: Smooth Particle Hydrodynamics (SPH) in the Total-Lagrangian formulation. This equivalence facilitates understanding of Peridynamics using the large body of literature already published for other meshless methods, see e.g. [\cite=Nguyen:2008/a] and [\cite=Rabczuk:2010/a]. The key observations of our work address two issues: (i) Discretizations of Peridynamics directly arrive at correct equations which conserve linear and angular momentum. These features can only be obtained in SPH by assuming ad hoc corrections such as explicict symmetrization. (ii) All of the problems that apply to collocation-type particle methods also apply to Peridynamics if this theory is discretized using nodal integration.

The remainder of this paper is organized as follows: we begin by deriving the fundamental expressions of the SPH approximation including the most important corrections for this method, which allow it to be used with the minimal level of accuracy required for solid mechanics simulations. Then, the essential Peridynamic expressions required for simulating classical material models are derived. Building on this foundation, the equivalence of SPH and this particular variant of Peridynamics is shown. Finally, the implications of this observation are discussed and Peridynamics (with classical material models) is characterized using the established terminology encountered in the SPH literature.

Total Lagrangian SPH

Smooth Particle Hydrodynamics [\cite=Lucy:1977/a] was originally devised as a Lagrangian particle method with the smoothing kernel moving with the particle, thus redefining the interaction neighbourhood for every new position the particle attains. In this sense, the kernel of the original SPH formulation has Eulerian character, as other particles move through the interaction neighbourhood. The tensile instability [\cite=Swegle:1995/a] encountered in SPH, where particles clump together under negative pressure conditions, has been found to be caused by the Eulerian kernel functions [\cite=Belytschko:2000/a]. Consequently, Total Lagrangian formulations were developed [\cite=Bonet:2002/a] [\cite=Rabczuk:2004a] [\cite=Vignjevic:2006a], which use a constant reference configuration for defining the interaction neighborhood of the particles. see Typically, the initial, undeformed configuration is taken for this purpose. In the following, this concept and the associated nomenclature is briefly explained with the limited scope of obtaining SPH expressions that are to be compared with the Peridynamic expressions. For a more detailed derivation, the reader is referred to the works cited above.

Total Lagrangian formulation

In the total Lagrangian formulation, conservation and constitutive equations are expressed in terms of the material coordinates [formula], which are taken to be the coordinates of the initial, undeformed reference configuration. A mapping between the current coordinates, and the reference coordinates describes the body motion at time t:

[formula]

Here, [formula] are the current, deformed coordinates and [formula] the reference (Lagrangian) coordinates. The displacement [formula] is given by

[formula]

The conservation equations for mass, impulse, and energy in the total Lagrangian formulation are given by

[formula]

where J and J0 are the current and initial Jacobian determinants. ρ is the current mass density and ρ0 is the initial mass density, [formula] is the nominal stress tensor (the transpose of the first Piola-Kirchhoff stress tensor), e is the internal energy, [formula] is the gradient or divergence operator expressed in the material coordinates, and [formula] denotes the deformation gradient,

[formula]

The SPH Approximation

The SPH approximation for a scalar function f in terms of the Lagrangian coordinates can be written as

[formula]

The sum extends over all particles within the range of a scalar weight function Wi, which is centered at position [formula] and depends on the distance between coordinates [formula] and [formula], [formula]. V0 is the volume associated with a particle in the reference configuration. The weight function is typically chosen to be radially symmetric and have compact support, i.e., it includes only neighbors within a certain radial distance. This domain of influence is denoted S.

The SPH approximation of a derivative of f is obtained by operating directly with the gradient operator on the kernel functions,

[formula]

where the gradient of the kernel function is defined as follows:

[formula]

The conditions for the zeroth- and first-order completeness of the SPH approximation are stated as follows:

[formula]

In the simple form as stated here, neither of the completeness conditions are fulfilled by the SPH approximation. An ad-hoc improvement consists in adding eqn. ([\ref=eqn:first_order_completeness]) to eqn. [\ref=eqn:sph_derivative_approximation], such that a symmetrized approximation for the derivative of a function is obtained,

[formula]

The symmetrization does not result in first-order completeness, however, it yields zeroth-order completeness for the derivatives of a function.

Restoring First-Order Completeness

In order to fulfill first-order completeness, the SPH approximation has to reproduce the constant gradient of a linear field. A number of correction techniques [\cite=Randles:1996a] [\cite=Bonet:1999a] [\cite=Vignjevic:2000a] exploit this condition as the basis for correcting the gradient of the SPH weight function,

[formula]

where [formula] is the diagonal unit matrix. Based on this expression, a corrected kernel gradient can be defined:

[formula]

which uses the correction matrix [formula], defined as:

[formula]

By construction, the corrected kernel gradient now satisfies eqn. ([\ref=eqn:first_order_completeness_vector]),

[formula]

Corrected SPH expressions for Solid Mechanics

For calculating the internal forces of a solid body subjected to a deformation, expressions are required for (i) the deformation gradient, (ii) a constitutive equation which provides a stress tensor as function of the deformation gradient, and (iii) an expression for transforming the stresses into forces acting on the nodes which serve as the discrete representation of the body.

The deformation gradient is obtained by calculating the derivative of the displacement field, i.e., by using the symmetrized SPH derivative approximation, eqn. ([\ref=eqn:sph_derivative_approximation_symmetrized]), for eqn. ([\ref=eqn:defgrad]):

[formula]

Note that in the above equation, the corrected kernel gradient has been introduced via the matrix [formula]. The SPH approximation of the stress divergence, eqn. ([\ref=eqn:divergence]), is not so clear. Depending on how it is performed, several different approximations can be obtained [\cite=Gingold:1982a]. The most frequently used form, which is variationally consistent with respect to an energy minimization principle [\cite=Bonet:1999a], is the following:

[formula]

For a radially symmetric kernel which depends only on distance, the antisymmetry property [formula] holds. Therefore, the above force expression will conserve linear momentum exactly, as [formula]. We use the antisymmetry property of the kernel gradient to rewrite the force approximation as follows:

[formula]

Replacing the uncorrected kernel gradient with the corrected gradient (c.f. eqn. ([\ref=eqn:correct_SPH_gradient]), the following expression is obtained:

[formula]

This corrected force evaluation conserves linear momentum due to its antisymmetry with respect to interchange of the particle indices i and j, i.e., [formula]. The here constructed antisymmetric force expression is usually not seen in the literature. In contrast, it seems to be customary [\cite=Randles:1996a] [\cite=Bonet:1999a] [\cite=Vignjevic:2000a] to directly insert the corrected kernel gradient into eqn. ([\ref=eqn:SPH_force_uncorrected]), which destroys the local conservation of linear momentum. We note that the above construction of the SPH expression that conserves linear momentum is arbitrary, and in similar spirit to the ad-hoc symmetrization procedure encountered in eqn. ([\ref=eqn:sph_derivative_approximation_symmetrized]).

Peridynamics for classical material models

This section provides a concise derivation of the Peridynamic approximation of the deformation gradient and the forces acting on particles. In contrast to the preceding section, where this quantities have been derived for SPH, we employ a different nomenclature here, which is consistent with the most relevant Peridynamic literature. In Peridynamics, each particle defines the origin of an influence domain, termed neighborhood H, of radius δ. Within this neighborhood, vectors [formula] from the origin to any point in H exist, see the following figure.

Vector states

Central to the state-based Peridynamic theory is the concept of states. States are functions that act on on vectors. This is written in the following way,

[formula]

where the state [formula] has acted on the vector [formula] to produce a different vector [formula]. Angular brackets indicate which vector the state acts upon. The mapping results produce tensors of different order, depending on the nature of the state. Vector states of order one map a vector to a different vector. Scalar states of order zero produce a scalar for every vector they act on. For the purpose of this paper we only need to be concerned with the following states:

The reference position vector state [formula] returns the original bond vector.

[formula]

The deformation state [formula] returns the deformed image of the original bond vector. Let the original vector go from [formula] to [formula], i.e., [formula]. Upon deformation, the coordinates of these two points change to [formula] and [formula]. The deformation state vector returns the deformed image of the original vector, i.e.,

[formula]

The influence function [formula] is a scalar state that returns a number w that depends only on the magnitude of [formula].

[formula]

Vector and scalar states can be combined using the usual mathematical operations addition, subtraction, multiplication, etc. The conventions are detailed in [\cite=Silling:2007a]. Here, we only need the definition of the tensor product between two vector states [formula] and [formula],

[formula]

This tensor product is required for the following Peridynamic concepts. Firstly, the shape tensor is defined:

[formula]

[formula] is symmetric and real and thus positive-definite, implying that it can be inverted. The shape tensor is then used in the concept of tensor reduction, which is an operation that produces a second order tensor from two vector states:

[formula]

Calculation of the deformation gradient tensor in Peridynamics

The deformation gradient tensor may be approximated as a tensor reduction of deformation vector state and reference position vector state according to eqn. (134) in [\cite=Silling:2007a]:

[formula]

The necessary Peridynamic calculus for evaluating this quantity has been presented above. We now make the transition from the continuum representation to a discrete nodal, or particle representation, converting integrals to sums. A piecewise constant discretization of the integrals defined above yields the discrete shape tensor as

[formula]

Here, the sum includes all particles j within the neighborhood Hi of i and V0j is the volume of particle j. The discrete expression for the approximate deformation gradient is obtained as:

[formula]

The Peridynamic force expression obtained from a classical stress tensor

The fundamental equation of Peridynamics is an integral equation of force densities (force per volume) which ensures local conservation of impulse, see eqn. (28). in [\cite=Silling:2007a]:

[formula]

Here, [formula] is a vector state, which operates on the bond [formula] in order to yield a contribution to the force density at [formula]. The antisymmetric counterpart [formula] ensures balance of linear momentum and [formula] is the volume associated with the coordinate [formula]. The vector state [formula] is related the classical stress tensor, which can be computed using the deformation gradient and a classical material model. Specifically, this relation is stated as follows, see eqn. (142). in [\cite=Silling:2007a]:

[formula]

The stress tensor [formula] above is the nominal stress tensor which applies here as the stress is expressed in the reference configuration. The dependence on [formula] signifies that both stress and shape tensor have to be evaluated at coordinate [formula]. Converting to a discrete particle expression, one obtains:

[formula]

The Correspondence between Peridynamic and SPH expressions for deformation gradient and particle forces

The discrete Peridynamic approximation of both the deformation gradient and the particle forces arising from a classical stress tensor are equal to the Total-Lagrangian SPH expressions with linear kernel gradient correction. In order to show this equivalence, we introduce some changes in nomenclature:

[formula]

Note that the postulated equivalence in the last line above states that the derivative of the SPH weight function has to equal the Peridynamic weight function. However, no implications arise from this requirement, as suitable weight functions can be chosen which fulfills this requirement.

Equality of shape tensor and first-order correction matrix

With these changes, the Peridynamic shape tensor becomes equal to the correction matrix required for first-order consistent SPH:

[formula]

Equality of the deformation gradient

In a similar manner, the Peridynamic expression of the deformation gradient can be shown to be equal to the SPH approximation:

[formula]

Thus, the Peridynamic concept of reduction leads to the approximation of a tensor field, which is correct to first order.

Equality of particle forces

Using the same rules for changing the Peridynamic notation into SPH notation, one obtains from the Peridynamic force expression:

[formula]

Implementation and numerical results

Implementation issues

The equality of Total-Lagrangian SPH and Peridynamic for classical material models with nodal integration raises some advantageous implementation issues. The first point concerns the weight function and its derivative, which is usually attributed great influence in SPH. In contrast, Peridynamic implementations typically use a constant unit weight function, i.e., [formula]. Using the Peridynamics to SPH translation, eqn. ([\ref=eqn:PD_SPH_weight_function]), this corresponds to a constant gradient for the SPH scheme. Such a constant implies that the associated weight function is apparently not a proper SPH weight function, i.e., it is certainly not normalized: [formula]. This apparent contradiction is solved by the first-order correction scheme used here: The ansatz used for deriving the corrected gradient, eqn. ([\ref=eqn:correct_SPH_gradient]) does not depend on any normalization factor as the multiplication the matrix inverse of [formula] cancels any constant factor in the weight function. In fact, it can be shown that this route to a corrected kernel gradient represents a Moving Least Squares formulation with a linear basis [\cite=Mueller:2004/a] [\cite=Lancaster:1981/a]. It can be concluded that the weight function (or indeed its derivative) can be chosen quite arbitrarily within this scheme. For the purpose of illustrating an implementation of the first-order corrected scheme, the uncorrected kernel gradient is simply defined as [formula]. Algorithm 1 outlines an efficient implementation which moves the multiplication with the shape matrix outside of the inner loop (loop over neighbors j of particle i), in order to save unnecessary calculations.

This algorithm exhibits two main features: A first loop over all pairs of interacting particles is required to define the shape matrix and deformation gradient. Naive implementations might split up this loop into two independent loops and first calculate only the shape matrix. However, as the kernel gradient correction depends only on the shape matrix of particle i, c.f. eqn. ([\ref=eqn:SPH_defgrad]), these operations can be combined and the correct deformation gradient obtained by post-multiplying with the shape matrix. With the corrected deformation gradient at hand, a stress tensor is computed using the constitutive law. Here, a finite-strain theory is employed, which provides a linear relationship between strain and stress, based on the Lamé parameters λ and μ. The stress measure obtained this way is the Second Piola-Kirchhoff stress, which is applicable to the reference configuration. This stress measure is pushed forward to the current configuration (First Piola-Kirchhoff stress), as forces are applied to the current particle positions. The calculation of the forces requires a second loop over all pairs of interacting particles. To avoid multiplication of the kernel gradients with the shape matrix inside the second loop, the shape matrices are multiplied with the stress tensors before entering this loop. Once the forces are computed, the particle positions can updated according to any chosen time-integration scheme.

Numerical examples

The aim of this work is to show the equivalence of first-order corrected Total-Lagrangian SPH and Peridynamics applied to classical material models in combination with nodal integration. While the equivalence has been mathematically proven in sec. ([\ref=sec:prove_equivalence]), it is also of interest to demonstrate the effects of the instability which emerges if nodal integrations used. To this end, the implementation according to Algorithm 1, in combination with a unit weight function and a leap-frog time integrator is used. For comparison purposes, reference solutions which do not suffer from rank-deficiency due to nodal integration are shown which are obtained using a meshfree code that employs a stabilization technique based on higher-order derivatives, similar to [\cite=Vidal:2007/a].

Patch test and stability

The patch test can be regarded as the most basic test for a solid mechanics simulation code. A strip of some material that is discretized using several elements (or SPH / Peridynamic particles) is subjected to a uniform strain field and the stress is computed. Regardless of the discretization, the stress should be uniform everywhere. SPH / Peridynamics with first-order corrected kernel gradients is well-known to pass this test. Here, however, we are interested in the subsequent time-integration following such an initial perturbation. To this end, a random initial particle configuration is obtained by discretizing a square patch of edge length 1 m and uniform area mass density [formula] into 444 quadliteral area elements using a stochastic algorithm based on triangular Voronoi tesselation and recombination of the triangles into quadliterals. Particle volumes and masses are obtained from the quadliteral area and the prescribed mass density. The kernel radius is adjusted individually for each particle such that approximately 12 neighbors are within the kernel range. While the patch test can be easily simulated with an ordered initial configuration of particles, a non-uniform particle configuration poses extreme stability challenges. Figure [\ref=fig:quad_mesh] shows the initial particle configuration. The material model is chosen as linear elastic with [formula] and ν = 0.3. The patch is uniformly stretched by 10% along both axes. After this initial perturbation, the system is integrated in time using a standard leap-frog algorithm with a CFL-stable timestep, resulting in a periodic contraction and expansion mode. Figure [\ref=fig:quad_patch_comparison] compares plain first-order corrected Total-Lagrangian SPH (equivalent to Peridynamics with nodal integration) with a meshfree solution that is stabilized against the effects of rank-deficiency. In the unstabilized system, particle motion is not coherent and particle disorder is observed already after the first contraction. After eight contractions, particle disorder is very pronounced and the motion of the patch is entirely dominated by numerical artifacts. In contrast, the stabilized simulation exhibits a completely coherent particle motion which can can be continued for hundreds of oscillations.

Bending of a beam

This example considers a large deflection of a simply supported 2d beam with dimensions [formula], see Fig. [\ref=fig:beam_sketch]. The material model of the beam is taken as linear elastic with Youngs modulus [formula] and ν = 0.3. A large boundary displacement of [formula] is applied, and plain Total-Lagrangian SPH results (equivalent to Peridynamics with nodal integration) are qualitatively compared against a stabilized simulation code. Snapshots of the simulations corresponding to the same boundary displacements, are shown in Fig. [\ref=fig:beam_comparison]. In the first snapshot at [formula], no obvious difference between both simulations can be observed. For the second snapshot at [formula], the unstabilized simulation shows a pattern where pairs of particles in the interior of the beam move together and do not follow the rotation of the beam's neutral line. Clearly, the unstabilized system tries to minimize its elastic energy by assuming a configuration which is not in agreement with a linear displacement field. This leads to an obviously wrong particle configuration for the last snapshot at [formula]. In contrast, the stabilized system shows particle displacements which appear very reasonable and exhibit no instability.

We conclude this test case by noting that Total-Lagrangian SPH, or - equivalently - Peridynamics for classical material models based on the deformation gradient and with nodal integration, can become unstable for certain loading conditions even with perfectly uniform reference particle configurations. Hence, stabilization techniques, e.g. based on higher-order derivatives [\cite=Vidal:2007/a] are required to stabilize the solution.

Discussion

This work shows that Peridynamics - when used with classical material models based on the deformation gradient tensor and nodal integration as discretization technique - is equivalent to Total Lagrangian SPH with corrected gradients. This result allows to characterize this flavour of Peridynamics using the large body of studies published for SPH. SPH is a collocation method with nodal integration that suffers from two major problems: (i) the tensile instability, i.e., a numerical instability which results in particle clumping under conditions of negative pressure, and (ii) susceptibility to zero-energy modes which are caused by rank-deficiency due to nodal integration. Of these problems, the tensile instability is resolved by the Total-Lagrangian formulation [\cite=Belytschko:2000/a] [\cite=Rabczuk:2004a], and the rank-deficiency can be eliminated by using additional integration points [\cite=Randles:1996a]. Peridynamics with classical material models as presented here is a Total-Lagrangian method and therefore shows no tensile instability. However, if due to the use of nodal integration, it is still a rank-deficient method.

The rank-deficiency does usually not manifest itself until the reference configuration is updated. Such an update can be required as the Total-Lagrangian nature imposes restrictions on the magnitude of deformations that can be handled with the approximate deformation gradient. Alternatively, features of the material model, e.g. plasticity or failure, may require updates of the reference configuration. These updates result in zero-energy modes which need to be treated with dissipative mechanisms [\cite=Vidal:2007/a].

With the equivalence demonstrated in this work, Peridynamics applied to classical material models and in combination with nodal integration does not result in a new numerical method, but is instead a new derivation of an existing meshless method that is not free of problems. What are the implications of these findings for the other Peridynamic theories? The bond-based theory [\cite=Silling:2005/a], which can be interpreted as an upscaling of the established meshless method Molecular Dynamics [\cite=Seleson:2009/a], does not require the calculation of a deformation gradient and thus does not suffer from the associated problems due to rank-deficiency. The state-based Peridynamic theory has also been formulated for some material models which are not based on the classical deformation gradient. If these unconventional material models, e.g., the linear Peridynamic solid [\cite=Silling:2007a], are discretized using nodal integration for computing dilatation and shear strain, rank deficiency problems are also likely to emerge.

Recently, work relating the reproducing Kernel Particle Method (RKPM) to state-based Peridynamics was published by Bessa et al [\cite=Bessa:2014/a]. In their work, the authors conclude that state-based Peridynamics is equivalent to RKPM if nodal integration, i.e., collocation, is used. These authors positively emphasize that the Peridynamic state-based approach is much faster compared to RKPM using more elaborate (cell based) integration techniques. These results are also understandable in light of this publication, because, it is known that RKPM with nodal integration is equivalent to Moving-Least-Squares SPH (MLSPH), which is known to be equivalent to SPH with corrected derivatives. For a comprehensive review on this equivalence, which also addresses the question as to how many really different meshless methods are known, see [\cite=Vidal:2004/a]. However, Bessa et al [\cite=Bessa:2014/a] disregard the unfortuitous implication of the equivalence of Peridynamics, SPH, and RKPM with nodal integration: we have learned from a number of SPH publications, that nodal integration causes problems, as it gives rise to zero-energy modes. Therefore the use of nodal integration for Peridynamics is a bad thing to do.

It is worthwhile to emphasize that the mathematical foundation of Peridynamics is clear and straightforward. Correct equations of motion emerge from this theory which conserve linear and angular momentum, and approximate linear fields accurately. All of these desirable features can only introduced into the SPH approximation by ad-hoc procedures. e.g. explicit symmetrization. Thus, if anything, the Peridynamic theory provides us with a better route to deriving meshless discretizations than the SPH method. If the simplest form of meshless discretization, namely nodal integration, is used, the advantages of Peridynamics over SPH vanish and the discrete expressions of both methods become equal. Stabilization schemes which address the rank-deficiency problem such as the scheme due to Vidal et al. [\cite=Vidal:2007/a] then need to be employed in order to keep the simulation stable. Future work should therefore address enhanced integration schemes for the Peridynamic theory.