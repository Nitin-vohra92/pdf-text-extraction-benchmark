Wind Turbine Model and Observer in Takagi-Sugeno Model Structure

Introduction

Takagi-Sugeno (TS) models provide a useful and uniform framework for nonlinear controller and observer design for dynamic systems. Originally introduced in the context of fuzzy systems [\cite=TakagiSugeno], TS models are weighted combinations of linear submodels and can either be derived from input-output data via system identification [\cite=TakagiSugeno] [\cite=SugenoKang:1988] or from mathematical models of nonlinear systems. Methods based on solving linear matrix inequalities (LMIs) allow for implicit stable controller and observer design for TS models [\cite=WangTanakaGriffin:1996] [\cite=Tanaka:2001] [\cite=Lendek:2010].

In this paper, a TS observer is designed as a disturbance observer to estimate the unknown effective wind speed from the available measurable system outputs. This observer is intended as a module for a fault-tolerant control scheme for wind turbines, where a reliable wind speed estimate is important, both as an input signal for fault-detection and isolation units (FDI) and as a redundant wind speed signal for the supervisory wind turbine control system.

Other methods have been applied to wind speed estimation in the literature. See for example [\cite=MaPoulsen_EstWind:1995], where Kalman filtering, extended Kalman filtering and the Newton-Raphson method are used and compared. Other dedicated algorithms have been applied, too. In [\cite=Ostergaard_v_est:2007], a state-observer for the rotor speed is combined with a PI controller to estimate the aerodynamic rotor torque. The effective wind speed is then reconstructed from the estimated torque signal via inversion of the aerodynamic model. While being able to yield good wind speed estimates, these methods also have certain detriments. The Kalman filter is only applicable to linear state-space models. Thus, estimating the wind speed for a wind turbine using a Kalman filter works only in the region of one operating point of a linearised wind turbine model. A possible remedy is provided by the extended Kalman filter, however, it is not possible to verify formal stability for the error dynamics, since the extended Kalman filter is an adaptive method. For observers in TS structure, however, the formal stability of the error dynamics can, at least in principle, be shown using linear matrix inequalities (LMI). The TS observer structure can also be extended to a TS sliding mode observer used for fault estimation [\cite=GerlandSchulte:2010]. This has been applied in [\cite=SchulteZajac:2012] for unknown load estimation and sensor fault reconstruction in pitch systems of wind turbines. For these reasons, and to achieve a certain level of uniformity within the design methods for different modules of a fault-tolerant control scheme, an observer in TS structure is used here for the estimation of the effective wind speed.

This paper is organised as follows. In section [\ref=Sec_WTModel], the reduced-order wind turbine model that serves as a basis for the observer is introduced. In section [\ref=Sec_TSObs], the TS model structure is introduced along with an illustrating example. The observer is derived in TS structure and the method to obtain the observer gain matrices is discussed. Simulation results are presented in section [\ref=Sec_Simulation].

Wind Turbine Model

For the purpose of model-based control design, reduced-order models like those in [\cite=Bindner:1999] [\cite=Bianchi:2007] are appropriate, since they capture only the dominant system dynamics that are directly influenced by the control action [\cite=Bianchi:2007]. A reduced-order model inspired from [\cite=Bianchi:2007], which was derived in TS structure in [\cite=Georg:Fuzz2012], is briefly introduced in this section and serves as a basis for the observer design in section [\ref=Sec_TSObs]. In order to test the observer with a more realistic wind turbine model, the aero-elastic code FAST by NREL [\cite=FASTUserGuide] is used for the simulation studies (see section [\ref=Sec_Simulation]). Four degrees of freedom are considered for the reduced-order model: rotor and generator rotation angles (θr, θg), fore-aft tower top deflection yT and flapwise blade tip deflection yB. The equations of motion, which describe the dynamics of the mechanical model, are obtained as

[formula]

where N denotes the number of rotor blades, R the rotor radius, mT and mB the effective tower and blade masses, kT and kB the effective stiffness coefficients for the tower top and blade tip deflection, dT and dB the damping coefficients for the respective tower and blade dynamics. θs  =  θr  -  θg denotes the shaft torsion angle, Ta the aerodynamic rotor torque and Tg the applied generator torque. An ideal gearbox is assumed, where the gearbox ratio is set to 1 for reasons of simplicity. Due to centrifugal forces acting on the rotor blades, the structural blade stiffness parameter can be modified by a term dependent on rotor angular velocity:

[formula]

where rB denotes the distance from the blade root to the blade centre of mass and α is a constant that needs to be adjusted to the simulated turbine. The inclusion of a centrifugal term is inspired from the FAST simulation software, where the correction is done for every blade section.

The pitch dynamics can be incorporated into the wind turbine model as a first-order delay model, [formula], where βd denotes the demanded pitch angle and τβ the delay time constant. Introducing the state vector [formula] and the input vector [formula] , the system of dynamic equations [\eqref=Eq_EOM_Mech1] to [\eqref=Eq_EOM_Mech4] including the centrifugal term [\eqref=Eq_kBEff] and the pitch dynamics can be transformed to state-space form:

[formula]

with system matrix [formula], input matrix [formula] and a nonlinear state vector [formula]. The aerodynamic rotor thrust and torque are given by [formula] and [formula], where R denotes the rotor radius, ρ the air density, v the wind speed and [formula] the tip speed ratio. CQ and CT are the aero maps for the rotor thrust and torque coefficients. Due to the expressions for FT and Ta, the state-space model [\eqref=Eqn_StateSpaceMdl] is nonlinear.

Model Parameters

The model parameters for the turbine model [\eqref=Eqn_StateSpaceMdl] are based on the NREL 5 MW reference turbine [\cite=Jonkman:2009]. The parameters are listed in [\ref=Sec_AppModelParameters], some of which can be directly taken from [\cite=Jonkman:2009] or example input and log files of FAST simulation runs of the 5 MW reference turbine.

Structural Parameters

The dynamics of fore-aft tower bending and flap-wise rotor blade bending are reduced to simple spring-mass-damper systems for the tower top and blade tip deflections. The respective tower stiffness coefficient kT is derived by means of a direct stiffness method common in structural mechanics calculations. The tower consisting of several segments is first transformed into an equivalent bending beam model. Afterwards, the bending stiffness of the effective beam model is transformed to an equivalent translational stiffness of the tower-nacelle dynamics (see Figure [\ref=Fig_TurmBalkenFeder] and [\ref=Sec_AppDirectStiffness]). While the tower stiffness parameter could be obtained and validated against the FAST simulation of the 5 MW reference turbine, there are still uncertainties about the determination of the blade parameter kB, which is therefore adjusted according to FAST simulation results [\cite=Georg:Fuzz2012].

The effective mass mT for the tower-nacelle motion in equations [\eqref=Eqn_SSMdl_4], [\eqref=Eqn_SSMdl_5]) is estimated as [formula], which has proven a reasonable assumption [\cite=Gasch_eng:2012]. Similarly, the effective blade mass for the blade tip motion is estimated as [formula].

Aerodynamic Damping

The aerodynamic rotor damping in fore-aft direction, which can be approximated as [formula] [\cite=Kaiser:2000], is taken as an estimate for the damping parameter dT of the tower-top motion in equations [\eqref=Eqn_SSMdl_4], [\eqref=Eqn_SSMdl_5]. The dimensionless parameter [formula] depends on the tip speed ratio and on the pitch angle and shows a similar behaviour for different turbine sizes [\cite=Kaiser:2000]. Estimating [formula] accordingly for different stationary points of the 5 MW reference turbine for the whole operating range of the turbine yields values between [formula] and [formula]. Here, the tower damping parameter is set to a constant value of [formula]. The blade damping parameter is set to [formula].

Aero Maps

The aero maps for the rotor thrust (CT) and torque coefficients (CQ) were extracted from FAST simulation runs of the 5 MW reference turbine. Alternatively, they can be approximated using nonlinear functions [\cite=Georg:Fuzz2012].

Observer in Takagi-Sugeno Model Structure

In this section, a state-observer based on the nonlinear model [\eqref=Eqn_StateSpaceMdl] is designed to reconstruct the unknown wind speed from the measurable system states. The standard Luenberg observer for linear systems is a state-space model including a feedback of the output error [formula], where [formula] is the reconstructed output signal:

[formula]

As the wind turbine model is nonlinear, a linear observer like [\eqref=Eqn_Luenberg_Obs] cannot be used in the whole operating range. Therefore, an observer in Takagi-Sugeno model structure is used. A state-space model in TS structure is of the form

[formula]

where [formula], [formula] and [formula] are constant matrices and hi are nonlinear functions of the premise variables [formula], which can depend on the system states and inputs and on external variables. Nr denotes the number of linear submodels. The membership functions hi fulfill the relation [formula]. The linear submodels can be derived from the original nonlinear model using local Taylor linearisation or by applying the sector nonlinearity approach [\cite=TanakaSano2:1994] [\cite=Tanaka:2001], whereby an exact representation of the nonlinear model is obtained. This approach is used in this paper for the derivation of the TS observer model.

Illustrating Example for a TS-Model

A simple example shall be considered in order to illustrate the derivation of a TS model using sector nonlinearities. Consider the dynamic equation of a pendulum of length l with a point mass m driven by an external torque signal M:

[formula]

where φ denotes the angular displacement of the pendulum and g the gravitational constant.

Introducing the state vector [formula] and the input signal u  =  M, equation [\eqref=Eqn_Pendulum] can be written in state-space form as

[formula]

Obviously, this is a nonlinear model due to the function [formula]. This function can be written as [formula] [formula] and [formula] denote the maximum and minimum values of the function f, i.e. the sector boundaries. However, any real constants c1, c2 could be used instead, as long as c1  ≠  c2. Using the sector boundaries is advantageous, since the matrices of the linear submodels, which are used for TS controller and observer design, thereby contain the domain of the nonlinear system.

From the definition of w1 and w2 it is obvious that w1  +  w2  =  1. Thus, the nonlinear matrix [formula] in [\eqref=Eqn_Pendulum_StateSpace] can be written as

[formula]

and the whole model in [\eqref=Eqn_Pendulum_StateSpace] as [formula]. The nonlinearity has thus been shifted from the system matrix into the membership functions, which in this case are equivalent to the weighting functions wi. In the same manner, systems with more than one nonlinearity can be transformed into a TS model structure by including all possible permutations of the wi-functions into the membership functions hi. The number Nr of linear submodels generally is Nr  =  2Nl, where Nl is the number of distinct nonlinear functions. However, if there occur several linear combinations of the same nonlinear function, Nl is not increased.

TS Observer

The state-space model [\eqref=Eqn_StateSpaceMdl] is used as a basis for the observer, where either the full model [\eqref=Eqn_StateSpaceMdl] or submodels of [\eqref=Eqn_StateSpaceMdl] can be used depending on the desired observer model order.

In this paper, only the rotational and torsional degrees of freedom are incorporated into the observer model but no tower and blade dynamics. This model configuration for the observer yields reasonable results while requiring relatively few measurement signals. In order to estimate the wind speed v with a state observer, v is included into the system state vector [formula] and a dynamic wind model is added to the system equations. The first-order delay model from [\cite=Ekelund:1994] is used, modified by the mean value [formula] of the wind speed, but without a white noise term:

[formula]

where the time constant is estimated as [formula]. The mean wind speed [formula] can be calculated over an appropriate time period (e.g. 10 min) from the anemometer wind measurement, which is sufficient for this purpose.

Since only the rotational and torsional degrees of freedom plus the estimated wind speed are considered for the observer model, the corresponding estimated state vector is [formula]. Since the first order pitch dynamics adds no information as to the reconstruction of the unknown states it is not considered in the observer model. This implies that the demanded pitch angle βd is not included in the input vector, because there is no linear dependence on βd but only a nonlinear dependence in [formula]. The mean wind speed [formula] can be included in the input vector: [formula]. The following states are assumed as measurable: θs, ωr, ωg. Measuring the rotor and generator speed signals is routinely done in wind turbines. For a real application of the observer, the rotor speed signal would have to measured with high resolution and both speed signals might need to be filtered. It is only an assumption at this stage that the torsion angle is measurable. However, it should be possible to measure the rotation angles before and after the coupling between gearbox and generator (using for example absolute encoders), and thereby the torsion angle θs  =  θr  -  θg, where the gearbox ratio can be taken into account simply as a factor.

From the system of nonlinear state-space equations for the wind turbine model [\eqref=Eqn_StateSpaceMdl], it is straightforward to obtain the nonlinear system matrix and the input matrix for the observer model:

[formula]

[formula]

The values for [formula] and [formula] were obtained by estimating the minimum and maximum values of the wind speed v and the torque coefficient CQ: [formula], [formula], [formula], [formula]. Though [formula] and [formula] are zero in theory, they are set to small positive values to avoid generating zero entries in one of the TS submatrices. The output vector and the output matrix are given by [formula] and [formula].

Employing the same procedure as in section [\ref=Sec_TSExample], the observer model can be obtained in TS structure:

[formula]

where the premise variable [formula] now depends on the reconstructed states: [formula].

Observer Gains and Stability

A common means to derive gain matrices for observers in TS structure is by applying the direct method of Lyapunov in form of linear matrix inequalities (LMI) [\cite=Lendek:2010].

In general, the global asymptotic stability of a nonlinear system [formula] is guaranteed if there exists a Lyapunov function [formula] satisfying the conditions [formula] and [formula] for all trajectories. In particular, the system is stable if it is quadratically stable, i.e., if a quadratic Lyapunov function [formula], with a symmetric, positive definite matrix [formula], exists. In that case, for a TS system without an external input ([formula]), the condition [formula] is equivalent to [formula]. Since this condition must hold for all [formula], the TS system without input is stable if there exists a common symmetric, positive definite matrix [formula], such that

[formula]

For the TS observer [\eqref=Eqn_TS_Obs], where the membership functions depend on unmeasurable states ([formula]), a modified form of the stability condition [\eqref=Eqn_LyapTS] with an additional LMI can be used to guarantee the stability of the error dynamics of the observer system [\cite=BergstenPalmDriankov:2001]:

[formula]

where [formula] is a symmetric, positive definite matrix and μ > 0 is a known constant satisfying [formula], with [formula] and [formula]. The first inequality of [\eqref=Eqn_LyapTSObs_est] is not an LMI but can be recast in LMI form by introducing [formula] [\cite=Tanaka:2001]. As condition [\eqref=Eqn_LyapTSObs_est] concerns quadratic stability, it is only a sufficient stability condition, i.e., if it is not fulfilled, no formal statement can be made about the stability or instability of the considered system [\cite=Lendek:2010].

Condition [\eqref=Eqn_LyapTSObs_est] was first used to calculate the observer gains. However, this observer hardly had any modifying effect on the wind speed compared to the mere wind model [\eqref=Eq_v_mdl]. A possible remedy is to modify the gain matrices with a weighting matrix, such that the gains influencing the wind speed [formula] are increased. A more systematic way is to make use of optimal fuzzy control concepts, where weighting matrices for the system states/outputs and inputs and a quadratic cost function can be included in the LMIs [\cite=TanakaTaniguchiWang1:1998]. For the observer design in this paper, theorem 5 from [\cite=TanakaTaniguchiWang1:1998], which is applicable for controller design, was modified to be used for the dual TS-systems [formula]. The observer gain matrices [formula] are then obtained from the resulting gain matrices [formula] as [formula]. The obtained gain matrices are given in [\ref=Sec_ObserverGains], [\eqref=Eqn_L_Matrices].

The formal stability of the error dynamics could not be verified with condition [\eqref=Eqn_LyapTSObs_est], which is a conservative condition due to the assumption of un unstructured uncertainty [\cite=Lendek:2010]. However, the observer shows a stable behaviour in the FAST simulation, even for large initial observer errors (see section [\ref=Sec_Simulation]).

Simulation Results

The observer was integrated in the FAST / Simulink model and simulated using an IEC wind gust as well as turbulent wind input. To control the rotor speed, a state-space controller in TS structure, based on Taylor-linearised models was used.

Simulation with IEC Wind Gust

As a first simulation test, an IEC wind gust with mean wind speed [formula] was used. Results are shown in figure [\ref=Figs_obs_FAST]. After the transient, the observer shows a stable behaviour and the wind gust is reconstructed with a phase offset of ≈  0.4  -  0.5 s. Almost perfect reconstruction is achieved for the rotor speed ωr.

Simulation with Turbulent Wind

A second simulation run in FAST was done using a 3D turbulent wind field with mean wind speed [formula]. Results are shown in figure [\ref=Figs_obs_FAST_turb]. When interpreting figure [\ref=Figs_obs_FAST_turb], it is important to remember that the observer estimates the rotor effective wind speed, i.e. a virtual single point wind speed that causes the same variations in wind torque as the corresponding 3D turbulent wind field [\cite=DOWECreport]. Although the calculations in FAST are based on the 3D wind field, the wind speed output from FAST ( curve in figure [\ref=Figs_obs_FAST_turb]) shows the nominal downwind component of the hub-height wind speed, so the two wind speed curves in figure [\ref=Figs_obs_FAST_turb] are not directly comparable. The FAST wind speed output is shown to give an idea of the observer performance.

In case the observer shall be tested in a real turbine, the estimated effective wind speed would not be directly comparable either to single point measurements on the nacelle or on meteorological towers. It would be interesting to compare the estimated wind speed to LIDAR measurements of the wind field measured in front of the rotor.

Conclusion and Outlook

In this paper, a nonlinear observer in Takagi-Sugeno structure was designed to estimate the effective wind speed from the measurable states of a dynamic wind turbine model. Although formal stability of the observer in terms of LMI conditions could not be obtained, the observer shows a stable behaviour when used with the aero-elastic simulation code FAST.

The TS observer for wind speed estimation is intended as one module of a fault-tolerant control scheme for wind turbines in future work.

This work was conducted within a research project funded by the German Federal Ministry of Education and Research under grant no. 17N1411.

Derivation of Effective Tower Stiffness

The direct stiffness method allows to calculate eigenfrequencies and eigenmodes of structures consisting of several segments of defined length, mass and bending stiffness. For each segment, the characteristic forces and displacements can be calculated from the previous segment by means of a transfer matrix depending on the frequency of the structure [\cite=GaschKnothe2]. Applying the total transfer matrix as the product of the individual transfer matrices, as well as the boundary conditions for the rigid and the free ends of the beam, yields a homogeneous system of equations for the displacements at the top of the total structure, which is fulfilled for the eigenfrequencies of the structure. In order to calculate the respective equivalent bending stiffness, it is sufficient to find the first eigenfrequency ω1. For the tower, it was calculated as [formula] and has been validated with the NREL-Software BModes [\cite=BModes] ([formula]). The connection to the equivalent bending stiffness Btotal is

[formula]

where κ1  =  1.423  ·  10- 2 is a factor that can be found in standard mechanics textbooks and μtotal is the total mass per length. Finally, the equivalent bending stiffness can be transferred into a translational spring stiffness with simple equations for the deflection w of the beam (with total length l) and spring, where the applied force F corresponds to the rotor thrust force FT:

[formula]

Model Parameters

N  =  3, R  =  63 m, [formula], [formula], [formula] [formula], [formula], [formula], [formula], [formula] [formula], [formula], [formula], [formula], [formula], [formula], [formula], [formula], [formula], [formula], [formula]

Observer Gain Matrices

The following weighting matrices ([formula] for the system states and [formula] for the system outputs) were used for the optimal LMI observer design: [formula], [formula] , with W1  =  0.25, W2  =  15.708, W3  =  1.5708, W4  =  60  ·  107, R1  =  0.05, R2  =  0.1571, R3  =  1.5708 and the estimated maximum values [formula], [formula], [formula] to normalise the chosen weights. For the optimal LMI design procedure, the initial observer error is needed, which was set to [formula]. This is of course an idealisation. However, as can be seen from the simulation results, the observer is stable also for [formula]. The following observer gain matrices were obtained:

[formula]

[formula] and [formula], displayed here with rounded values, are not equal but differ by less than 0.1 %.