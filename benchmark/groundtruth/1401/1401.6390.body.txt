Lemma Proposition Corollary

Definition Example Exercise Question Conjecture Problem

Remark

Følner sequences and sum-free sets

Introduction

Let [formula] be an integer. A subset A of an abelian group is called k-sum-free if there do not exist [formula] such that [formula]. In 1965 Erds [\cite=erdos1] proved with the following ingenious argument that every set A of n positive integers has a k-sum-free subset of size at least n / (k + 1). Since the open interval [formula] of length 1 / (k + 1) centred at 1 / (2k - 2) is k-sum-free, it follows that for each [formula] the set Ax of a∈A such that ax∈S is also k-sum-free. But if x is chosen uniformly at random from [formula] then for each a∈A the product ax also has the uniform distribution, so by linearity of expectation the expected size of Ax is n / (k + 1). In particular [formula] for some x.

Our main theorem is that the constant 1 / (k + 1) in this theorem cannot be improved: for every ε > 0 there is a set of n positive integers containing no k-sum-free subset of size greater than (1 / (k + 1) + ε)n. In fact, we can give explicit examples of sets with no large k-sum-free subsets. Call a sequence (Fm) of subsets [formula] a Følner sequence in [formula] if, for every fixed [formula],

[formula]

where [formula] denotes symmetric difference. For example, if

[formula]

where [formula] are the primes, then (Fm) is a Følner sequence in [formula]. For any such sequence, the sets Fm eventually have no large k-sum-free subsets.

We begin by giving a quick deduction of the case k = 2 of this theorem from previous work. We then give two proofs in the general case: one short, infinitary, and ineffective, the other longer, finitary, and effective, though with poor bounds. In both proofs we rely on the theorem of Luczak and Schoen [\cite=luczakschoen] that every maximal k-sum-free subset of [formula] of upper density greater than 1 / (k + 1) is periodic. In the first proof we use this theorem as a black box, while for the second we prove a finitary version by closely following [\cite=luczakschoen].

Ben Green, Freddie Manners, and I [\cite=EGM] recently proved that there is a set of n positive integers containing no 2-sum-free subset of size larger than (1 / 3 + o(1))n. The method we used extends to the case of 3-sum-free sets with a little work, but the method does not seem to extend easily to k-sum-free sets for k > 3. Until now, the best result known in the case k > 3 was the theorem of Bourgain [\cite=bourgain] that if δk is the largest constant such that every set of n positive integers contains a k-sum-free set of size at least δkn then δk  →  0 as k  →    ∞  .

Deduction of the case k = 2 from previous work

Fix a Følner sequence (Fm) in [formula]. The Følner property will be used in the following way: if x∈Fm is uniformly random and E(x) is some event depending on x, then for every fixed [formula] we have

[formula]

This allows us to imitate Erds's argument with (Fm) in place of [formula], as in the following lemma.

The following two statements are equivalent.

For infinitely many m, Fm has a k-sum-free subset of size at least δ|Fm|.

For every finite [formula], A has a k-sum-free subset of size at least δ|A|.

Of course (2) trivially implies (1), so it suffices to prove (1) implies (2). Suppose Fm has a k-sum-free subset Sm of size at least δ|Fm|. For x∈Fm, let Ax be the set of all a∈A such that ax∈Sm. Then Ax is k-sum-free, and if we choose x∈Fm uniformly at random then the expected size of Ax is

[formula]

Hence from the Følner property and the integrality of |Ax| it follows that for sufficiently large m there is some x∈Fm such that [formula].

By [\cite=EGM], for every ε > 0 there is a set A of n positive integers with no 2-sum-free subset of size greater than (1 / 3 + ε)n. From this and the above lemma we deduce the case k = 2 of Theorem [\ref=thm:main].

Infinitary proof of Theorem [\ref=thm:main]

In this section we assume basic familiarity with ultrafilters, and in particular Loeb measure. The reader needing an introduction might refer to Bergelson and Tao [\cite=bergelsontao].

Again fix a Følner sequence (Fm) in [formula], and assume for infinitely many m that Fm has a k-sum-free subset Sm of size at least δ|Fm|. By passing to a subsequence we may assume this holds for all m.

There is an abelian group X, a σ-algebra Σ of subsets of X, a probability measure μ on Σ, and a set S∈Σ such that (1) for every [formula] the map x  ↦  ax is Σ-measurable and μ-preserving, and (2) S is k-sum-free and [formula].

Let [formula] be a nonprincipal ultrafilter, let X be the ultraproduct [formula], and let Σ be the Loeb σ-algebra on X. Defining μm on subsets of [formula] by

[formula]

let μ be the Loeb measure induced by (μm). Let S be the internal set [formula].

To verify (1), note that x  ↦  ax sends internal sets to internal sets, so it is measurable. Moreover x  ↦  ax approximately preserves μm by the Følner property, so it exactly preserves the Loeb measure μ. For (2), it follows from the basic properties of ultrafilters that S is k-sum-free, and by definition of μ we have

[formula]

We define the upper density of a set [formula] by

[formula]

and we define its upper density on multiples by

[formula]

where [formula]. Equivalently,

[formula]

There is a k-sum-free subset A of [formula] such that [formula].

Let X, Σ, μ, and S be as in the previous lemma. For x∈X, let Ax be the set of all [formula] such that ax∈S. Then Ax is k-sum-free, [formula] is a Σ-measurable function of x, and if x is chosen randomly with law μ then, by Fatou's lemma,

[formula]

To complete the proof of Theorem [\ref=thm:main], it suffices to prove that there is no k-sum-free subset of [formula] of upper density on multiples larger than 1 / (k + 1). We use the following theorem of Luczak and Schoen.

Every k-sum-free subset of [formula] of upper density larger than 1 / (k + 1) is contained in a periodic k-sum-free set.

Every k-sum-free [formula] satisfies [formula].

If [formula] then for every N the set A / N! contains a multiple of every natural number. In particular A / N! is not contained in a periodic k-sum-free set, so, by the Luczak-Schoen theorem,

[formula]

A finitary Luczak-Schoen theorem

For a set [formula], let [formula], let dn(A)  =  |An| / n, and let

[formula]

Suppose that [formula] is k-sum-free, that An0 contains an arithmetic progression [formula], and that some d∈An0 - (k - 1)An0 satisfies [formula]. Then for every ε > 0 and every sequence [formula] of naturals such that [formula] for each [formula] there is some [formula] such that

[formula]

Assume first that d < x. Let

[formula]

Then the sets [formula] are pairwise disjoint, so

[formula]

For each [formula] let u(t) be the smallest element of A such that

[formula]

for some [formula]; if no such element exists let u(t) =   ∞  . Since [formula] and u(x + jm) =   ∞   for each [formula], and since [formula], we may find d' and [formula] such that [formula], [formula], and [formula] for each [formula].

Write [formula], where [formula]. Then the sets [formula] are pairwise disjoint when restricted to [formula]. Indeed, being k-sum-free certainly A is disjoint from the others, while if for some [formula] we have

[formula]

then there exists [formula] and a∈A such that

[formula]

whence

[formula]

But since b∈B there is some [formula] such that b + jm∈A, and so the above equation shows that [formula], contradicting [formula]. Thus

[formula]

and the lemma is proved by combining this inequality with [\eqref=|B_n|].

The case d > x is similar, but we consider

[formula]

and we find d' and [formula] such that [formula], [formula], and [formula] for each [formula].

For every [formula] and ε > 0 there exist natural numbers N = N(k,ε) and Q = Q(k,ε) such that if [formula] and A is k-sum-free such that

[formula]

then either An0 is contained in a Q-periodic k-sum-free set, or for every sequence [formula] of naturals such that [formula] for each [formula] there is some [formula] such that

[formula]

Choose i = i(k,ε) so that

[formula]

and then choose N = N(k,ε) and Q = Q(k,ε) so that if [formula] every subset of [formula] of size at least (ε / 2)n0 contains an arithmetic progression of length i and common difference dividing Q, and so that

[formula]

The existence of N and Q follows from Szemerédi's theorem.

Suppose [formula]. Let

[formula]

and

[formula]

If An0 is not contained in a Q-periodic k-sum-free set then R must not be k-sum-free. Suppose [formula] and [formula], where we may assume [formula]. Since D is k-sum-free the sets [formula] are disjoint, so

[formula]

whence

[formula]

It follows that [formula] contains an arithmetic progression [formula], where m divides Q. By definition of R and D there exists [formula] such that [formula]. But then [formula], so by the lemma there is some [formula] such that

[formula]

We may easily recover the original Luczak-Schoen theorem from the above finitary version. Indeed, for [formula] and ε > 0, let N and Q be as in the above theorem, and suppose A is k-sum-free and [formula] for each i, where ni  →    ∞  . By passing to a subsequence of (ni) we may assume [formula], [formula] for each [formula], and, if A is not contained in a Q-periodic k-sum-free set, An0 is not contained in a Q-periodic k-sum-free set. But then by the above theorem there is some [formula] such that [formula], a contradiction.

Finitary proof of Theorem [\ref=thm:main]

Fix ε > 0 and let N and Q be as in Theorem [\ref=thm:fLS]. Then for every [formula] there exists a finitely supported measure ν on [formula] such that if A is k-sum-free and An0 is not contained in a Q-periodic k-sum-free set then [formula].

Continue n0 to a sequence (ni) satisfying [formula] for each [formula], and let (is) be a sequence of indices such that i- 1 =  - 1, i0 = 0, and [formula] for each [formula]. Define measures νs by

[formula]

and define ν by

[formula]

where [formula].

Suppose that A is k-sum-free, and let s0 be the least s such that [formula]: if no such s exists then [formula], so we are done. Find i0 such that [formula] and [formula]. If Ani0 is not contained in a Q-periodic k-sum-free set then by Theorem [\ref=thm:fLS] there are at most kni0 indices i > is0 such that [formula]. Since [formula] we find that

[formula]

The next lemma uses an idea based on the contraction mapping theorem which also appeared in [\cite=EGM].

For every ε > 0 there is a finitely supported measure μ on [formula] such that every k-sum-free set A satisfies [formula].

Let νn0 be the measure constructed by the previous lemma for [formula], and let [formula] be the map x  ↦  Qx. Define measures μi inductively as follows. Start with μ1  =  νN, and thereafter if μi is supported on [formula] let

[formula]

If A is k-sum-free and νQMi(A) > 1 / (k + 1) + 2ε then by the previous lemma AQMi is contained in a Q-periodic k-sum-free set. In particular AQMi is disjoint from [formula], so [formula]. Hence in this case [formula].

If on the other hand [formula] then by induction we have

[formula]

Hence if i is chosen large enough that [formula] then [formula] for every k-sum-free [formula].

To finish the proof of Theorem [\ref=thm:main] we need a version of Lemma [\ref=lem:erdosfolner] for measures.

Suppose that F satisfies

[formula]

for every [formula], and that F has a k-sum-free subset S of size at least δ|F|. Then for every probability measure μ supported on [formula] there is a k-sum-free set A for which [formula].

For x∈F, let Ax be the set of all [formula] such that ax∈S. Then Ax is k-sum-free, and if we choose x∈F uniformly at random then the expected measure of Ax is

[formula]

Theorem [\ref=thm:main] follows from the previous two lemmas.

Final remarks

Luczak and Schoen [\cite=luczakschoen] also considered so-called strongly k-sum-free sets, sets which are [formula]-sum-free for each [formula]. They prove that every maximal strongly k-sum-free subset of [formula] of upper density larger than 1 / (2k - 1) is periodic. Using this theorem one may easily modify Section [\ref=sec:ineffproof] to verify that for any Følner sequence (Fm) in [formula] the sets Fm contain no strongly k-sum-free subset of size larger than (1 / (2k - 1)  +  o(1))|Fm|. One may also adapt the methods of Sections [\ref=sec:finitaryluczakschoen] and [\ref=sec:effproof] to give an effective proof of this theorem. We leave the details to the energetic reader.