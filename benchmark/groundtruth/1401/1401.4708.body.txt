Fermat test with gaussian base and Gaussian pseudoprimes

AMS 2000 Mathematics Subject Classification:

Introduction

Most of the classical primality tests are based on Fermat's little theorem: let p be a prime number and let a be an integer such that [formula], then [formula]. This theorem gives a possible way to detect non-primes: if for a certain a coprime to n, [formula], then n is not prime. The problem is that the converse is false and there exists composite numbers n such that [formula] for some a coprime to n. In this situation n is called pseudoprime with respect to base a (or a-pseudoprime). A composite integer n which is a pseudoprime to any base a such that gcd (a,n) = 1 is called a Carmichael number (or absolut pseudoprime).

Fermat theorem can be deduced from the fact that the units of [formula] form a subgroup of order n - 1 when n is prime. Associated to the subgroup [formula] we can define the well-know Euler's totient function and Carmichael's lambda function which are defined in the following way:

[formula]

It seems reasonable (and natural) to extend these ideas to other general groups Gn. This extension leads to composite/primality tests according to the following steps:

Compute f(n) = |Gn| under the assumption that n is prime.

Given n, if we can find g∈Gn such that [formula], then n is not prime.

This idea is present in tests based in lucasian sequences [\cite=WI] and elliptic curves [\cite=SIL]. Recent works have developed these concepts in other contexts. Pinch [\cite=PINCH] considers primality tests based on quadratic rings and discuss the absolute pseudoprimes for them. Shettler [\cite=JORDAN] studies analogues to Lehmer's Problem Totient and Carmichael numbers in a PID. Steele [\cite=ST] generalizes Carmichael numbers to number rings introducing Carmichael ideals in number rings and proving an analogue to Korselt's criterion for them.

Following these approaches, in this paper we consider the groups

[formula]

For these groups, we define the corresponding Euler and Carmichael functions and we study some of their properties. We also present the concepts of Gaussian pseudoprime and Gaussian Carmichael number presenting an explicit Korselt's criterion. Cyclic numbers, Lehmer's Totient Problem [\cite=BCF] and Giuga's conjecture [\cite=GIU] are also considered in this gaussian setting.

It is known that Carmichael numbers have at least three prime factors. We show that Gaussian Carmichael numbers with only two prime factors exist and we determine their form. Moreover, although there are gaussian pseudoprimes with respect to any base, if we combine our ideas with a classical Fermat test, we show that no number of the form 4k + 3 smaller that than 1018 passes both tests (for some particular bases). This strength is possible due to a relationship with 1-Williams numbers [\cite=WI] that we make explicit.

Preliminaries

In this section we determine the order and structure of the group Gn. We also show some elementary properties and relations between the Gaussian counterparts of Euler and Carmichael functions.

For any positive integer n we will denote by In the ring of gaussian integers modulo n; i.e.,

[formula]

Further, we will consider the group Gn defined by

[formula]

Once we have defined the group we can define the following arithmetic functions:

[formula]

Note that Φ and [formula] are the analogues to Euler's totient funtion and Carmichael's lambda functions, respectively.

It is quite clear that if [formula], then

[formula]

As a consequence, if gcd (m,n) = 1, Φ(mn) = Φ(m)Φ(n) and [formula]. Hence, in order to study the group Gn we can restrict ourselves to the case when n is a prime power.

Let p be a prime and let k > 0 be an integer. Then:

[formula]

We will focus only on the case [formula]. In this case, it is well-known that [formula]. Since Gp is a subgroup of [formula], it must be cyclic. Moreover, counting quadratic residues it can be seen that |Gp| = p + 1 and, consequently, [formula].

We can now apply the Fundamental Lemma in [\cite=GOL] to obtain that |Gpk| = pk - 1(p + 1). This means that, if Φ:Gpk  →  Gp is the mod p group homomorphism, then | Φ| = pk - 1. Finally, observe that  Φ is an abelian p-group with exactly p - 1 elements of order p, namely {1 + Bpk - 1i∈Gpk:1  ≤  B  ≤  p - 1}. Consequently it must be cyclic and the proof is complete in this case.

As a straightforward consequence we compute Φ(pk) and [formula].

Let p be a prime and let k > 0 be an integer. Then

[formula]

[formula]

For an odd prime number p, let us define [formula] and put β(2) = 0. With this notation the following result is straightforward.

[formula]

Recall that Φ(mn) = Φ(m)Φ(n) provided gcd (m,n) = 1. The following result describes the general situation.

Let [formula]. Then

[formula]

It is enough to consider the prime power decomposition of m and n.

In particular, if we put m = n we obtain the following.

Let [formula]. Then

[formula]

Let [formula]. If d = (m,n) and M = (m,n), then:

[formula]

Recall that [formula], where [formula] and we can assume, without loss of generality, that gcd (m,d) = 1. Then, Proposition [\ref=prod] leads to:

[formula]

and the result follows.

Recall that for the classical Euler and Carmichael functions, φ(n) = λ(n) if and only if n = 2, n = 4 or n = pr,2pr for some odd prime p and r > 0. Note that in all these cases the group [formula] is cyclic. For our recently defined functions Φ and [formula] we have the following:

[formula] if and only if n = 2 or n = pr for some odd prime p and r > 0.

Just apply Corollary [\ref=corla2] and recall that if gcd (m,n) = 1, then Φ(mn) = Φ(m)Φ(n) while [formula].

We end this section showing that the asymptotic behavior of Φ(n) is not exactly the same as that of his classical counterpart.

[formula]

[formula]

For the asymptotic growth of Euler φ function and its limits see [\cite=HW].

Now consider sequences {Sn} and {Ln} given by:

[formula]

We have that Φ(p) = p + 1 for every odd prime [formula], hence

[formula]

since [formula] and this series is divergent by the strong form of Dirichlet's theorem. On the other hand,

[formula]

Moreover,

[formula]

where the sum in the exponent is taken over the primes [formula]. Again, by the strong form of Dirichlet's theorem, this fuction tends to 0 and result holds.

Gaussian Fermat pseudoprimes

We start this section introducing the arithmetic function F, which will play the same role as n - 1 plays in the classical setting.

[formula]

Note that, if n is prime, F(n) = |Gn|.

We present the analogue to Fermat's little theorem in this gaussian setting.

Let p be a prime number and let z be a gaussian integer such that p is coprime with [formula]. Then:

[formula]

[formula]

Note that if [formula] is such that [formula], then [formula]. Hence, it is enough to apply Corollary [\ref=corla2].

Both conditions in Proposition [\ref=FermatGaussiano] are equivalent.

We can consider the above result as a compositeness test for integers: if for some integer n we find a gaussian integer z such that either condition i) or ii) does not hold, then n is a composite number. Nevertheless, like in the classical setting, the converse is not always true. This fact motivates the following definition:

In the classical setting the choice of different basis leads, in general, to different sets of associated Fermat pseudoprimes. In our case it is easy to describe a family of different basis leading to the same set of associated Gaussian Fermat pseudoprimes.

Let z,w be two gausian integers such that |z| = |w|. Then an integer n is a Gaussian Fermat pseudoprime with respect to z if and only if n is a Gaussian Fermat pseudoprimes with respect to w.

Assume that n is a GFP with respect to z. Then [formula] and [formula]. Now, since |w| = |z| we have that [formula]. Moreover, since [formula] and [formula] it follows that [formula]. Hence, [formula] because [formula]. The converse is clear since the roles of z and w are symmetric and the proof is complete.

Gaussian Carmichael and cyclic numbers

An integer n that is a Fermat pseudoprime for all bases coprime to n is called a Carmichael number [\cite=CARMI]. In the gaussian case there also exists composite numbers which are GFP with respect all bases.

An alternative and equivalent definition of Carmichael numbers is given by Korselt's criterion [\cite=KORSELT] which states that a positive composite integer n is a Carmichael number if and only if n is square-free, and for every prime divisor p of n, p - 1 divides n - 1. It follows from this characterization that all Carmichael numbers are odd. A similar characterization of G - Carmichael numbers can be given, showing that there are also even G - Carmichael numbers.

For every composite integer n the following are equivalent.

n is G - Carmichael number.

[formula] divides F(n).

For every prime divisor p of n, F(p) divides F(n) and one of the following conditions holds:

n is odd and square-free,

n is multiple of 4 and [formula] or not a prime number.

Since [formula] is the exponent of the group Gn, i) and ii) are clearly equivalent.

From Corollary [\ref=corla2] and the fact that [formula] if gcd (m,n) = 1, it is easy to see that iii) implies ii) when n is a number that satisfies a) or b).

Finally, assume now that [formula] divides F(n) and let be [formula]. We have that [formula], so [formula] and [formula] divides F(n). From Corollary [\ref=corla2], it is clear that for every prime p, [formula] divides [formula] with k  ≥  1 and F(p) also divides F(n) as claimed.

If n is odd (a = 0) and ri  ≥  2 for some [formula] we get that pi divides [formula] and, consequently, also F(n). Thus, pi divides n - 1 or n + 1 which is a contradiction and n must be square-free in this case.

We now turn to the even case. If a = 1 and n is divisible by an other prime p such that [formula], then p - 1 divides F(n) = n. Hence n is a multiple of 4, a contradiction. The same follows if there exist a prime [formula] dividing n so we conclude that if n  ≠  2 is even, it must be a multiple of 4.

Now, let be n = 4p with p a prime. If p = 2, then n = 8 and we are done. If [formula], it follows that p - 1 divides n; i.e., p - 1 divides 4 so p = 5 and n = 20. Finally, if [formula], it follows that p + 1 divides 4 so p = 3 and n = 12. Hence we have seen that if 4 divides n and n  ≠  8,12,20, then [formula] is not prime and the proof in complete.

In 1994 it was shown by Alford, Granville y Pomerance [\cite=ALF] that there exist infinitely many Carmichael numbers. It is easy to see that every power of 2 is a G - Carmichael number, hence there are also infinitely many of them. However, if we restrict to odd G - Carmichael numbers, the problem seems to have at least the same difficulty as the classical case.

Carmichael numbers have at least three prime factors. We know that 12 and 20 are only even G - Carmichael numbers with only two prime factors. The following result describes the family of odd G - Carmichael numbers with exactly two prime factors.

Let p < q be odd primes. Then n = pq is a gaussian Carmichael number if and only if p and q are twin primes such that 8 divides p + q.

Assume that n = pq with p < q odd primes is a G - Carmichael number.

If [formula] , F(n) = n - 1 = pq - 1. From proposition [\ref=car2], p - 1 divides pq - 1 = (p - 1)(q + 1) + q - p. Hence p - 1 divides q - p and also q - 1 = (q - p) + (p - 1). In the same way q - 1 divides p - 1. So p - 1 = q - 1 which is impossible. If [formula] we reach a similar contradiction using the same ideas. If [formula] and [formula] we obtain that p = q + 2 which is impossible because p < q.

Thus [formula] and [formula] and we have, whit similar reasoning that q = p + 2. Moreover, [formula].

The converse is trivially true and the proof is complete.

Recall that a positive integer n which is coprime to φ(n) is called a cyclic number (sequence A003277 in [\cite=OEIS]). This terminology comes from group theory since a number n is cyclic if and only if any group of order n is cyclic [\cite=SZ]. From Korselt's criterion it follows that any divisor of a Carmichael number is cyclic. In the gaussian setting we define Gaussian cyclic numbers in the following way.

The relationship between G-Carmichael and G-cyclic numbers is the same as in the setting, the proof being also quite similar.

Any divisor of a odd G - Carmichael number is G - cyclic.

Let n be an odd G - Carmichael number. Since n is square-free, [formula] and from proposition [\ref=Phin], [formula]. A divisor d of n is a product of some of these primes, that is, [formula], [formula]. If GCD(Φ(d),d) <  > 1,, then there exist two indices i  ≠  k in J such that pi divides pk  -  β(pk). As n is a Carmichael number, we also have pk  -  β(pk) divides n - β(n). Hence, pi divides n - β(n) which is absurd since n is divisible by pi and β(pi) =   ±  1.

Around 1980, G. Michon conjectured that all odd cyclic numbers have Carmichael multiples. This can be reasonably extended to G - cyclic numbers and we can ask if all odd G - cyclic numbers have G - Carmichael multiples.

Cyclic numbers can also be characterized in terms on congruences. A number n is cyclic if and only if it satisfies [formula] or [formula]. In our situation only one implication remains valid, namely.

If [formula] or [formula], then n is a G - cyclic number.

Let n be a positive integer such that [formula]. Then, for any prime divisor p of n it holds that [formula]. Now, if n is not a G - cyclic number, there exists a prime p with p| gcd (Φ(n),n). Thus, p divides Φ(n) and [formula], a contradiction.

On the other hand, let [formula] be a positive integer. If n is not a G - cyclic number then there exists a prime p which p| gcd (Φ(n),n). Since [formula], there exists 1  ≤  j  ≤  r with p|Φ(pejj). If pj = 2 then p = 2 and [formula] is even. Otherwise, [formula] and p divides [formula]. So [formula] and n do not satisfy the hypothesis.

The converse of the previous proposition is no true. In fact there are G - cyclic numbers n that do not satisfy any of the above conditions. The first of them being:

[formula]

G - Lehmer's totient problem and G - Giuga's conjecture

Lehmer's totient problem, named after D. H. Lehmer, asks whether there is any composite number n such that φ(n) divides n  -  1. This is true for every prime number, and Lehmer conjectured in 1932 [\cite=LE] that the answer to his question was negative. He showed that if any such n exists, it must be odd, square-free, and divisible by at least seven primes. This numbers, called Lehmer numbers, are clearly Carmichael numbers and, up to date, none has been found. It is known that these numbers have at least 15 prime factors and are greater than 1030. Moreover, if a Lehmer number is divisible by 3, the number of prime factors increases to 40000000 with more than 360000000 digits (see [\cite=BCF]). We now define our analogue concept.

It is clear that every G - Lehmer number is a G - Carmichal number. Besides, it is easy to note that G - Lehmer numbers exist.

Let p < q be odd primes. Then n = pq is a G - Lehmer number if and only if p and q are twin primes such that 8 divides p + q.

As n must be a G - Carmichael number, n = (4k - 1)(4k + 1) where 4k  ±  1 are both primes. From this numbers Φ(n) = F(n) = (4k)2, so n is a G - Lehmer number.

Note that, from Proposition [\ref=Prop2p] this result means that every odd G - Carmichael number with exactly 2 prime factors is a G - Lehmer number. Nevertheless, there are G - Lehmer numbers with more thatn 2 prime factors (A182221 in [\cite=OEIS]):

[formula]

This suggests an interesting question:

Furthermore, all known G - Lehmer numbers satisfy that F(n)  =  Φ(n). Hence, it is reasonable to propose the G - Lehmer's Totient problem:

In 1932, Giuga [\cite=GIU] proposed another conjecture about prime numbers. He postulated that a number p is prime if and only if [formula], where the sum is taken over all integers 1  ≤  i  ≤  p - 1. Giuga showed that there are no exceptions to his conjecture up to 101000. This was later improved to 1013800 [\cite=BOR]. A similar approach to Giugas's conjecture, replacing n - 1 by F(n), leads us to consider the following set, which contains all prime numbers.

[formula]

However, this set also contains lots of composite numbers. For example, every power of 2 is in [formula]. For odd integers we have the next result.

Let be n an odd integer. If Φ(n) = F(n), then [formula].

Since |Gn| = Φ(n), for all z∈Gn, [formula]. If Φ(n) = F(n) then

[formula]

and n is in [formula].

Thus, prime numbers and every known G - Lehmer numbers are in [formula]. Furthermore, no other odd composite integer is known to be in [formula]. So, we formulate the following conjecture regarding numbers in [formula].

For every odd n, [formula] if and only if Φ(n) = F(n).

Gaussian Fermat test for numbers of the form 4k + 3.

The use of gaussian integers to perform the equivalent of Fermat's little theorem to test primality is not just a mere theoretical speculation. Lucas pseudoprimes [\cite=WI] for some particular sequences can be also seen as gaussian pseudoprimes. However, Gaussian integers, and the corresponding definition of peudoprimes using powers, is more similar to the classical one than the concept of Lucas sequences.

As we have said before, we can take advantage of Proposition [\ref=FermatGaussiano] to test primality (more precisely compositeness) of a number. This is that we call the Gaussian Fermat Test with respect to the base z. Computational evidence reveals that this test, based on the structure of GN, is very powerful when it is combined with the classical one; i.e., there are very few common pseudoprimes. Furthermore, this combination is more stronger if we restrict to numbers of the form 4k + 3. From the William Galway list [\cite=GAL], we have checked that every Fermat pseudoprime number to base 2 less than 1018 and of the form 4k + 3 is not a Gaussian pseudoprime to base z = 1 + 2i.

Baillie-PSW primality test [\cite=PSW], used in a lot of computer algebra systems and software packages, is also a combination of two primality tests. More precisely it is a strong Fermat probable prime test to base 2 and a strong Lucas probable prime test. As the previous combination, no composite number below 1019 passes it, but it considers two strong type-test in contrast of our two basic Fermat type tests. On the other hand, there are integers of the form 4k + 3 which are both Fermat pseudoprimes to base 2 and Lucas pseudoprimes (see sequence A227905 in [\cite=OEIS]).

In general, combinations of two Fermat test with respect to two different prime basis (less than 30) present more than 10 (and a mean of 34) pseudoprimes lower than 4  ·  107 of the form 4k + 3. Even if we combine two basis to test if a number n is a prime using the Gaussian Fermat Test, there are more pseudoprimes. However, there is no composite number of the form 4k + 3 less than 4  ·  107 which is both a Gaussian pseudoprimes with respect to 1 + 2i and a Fermat pseudoprime with respect to a prime base less than 30. The lowest base to be used to find a Fermat pseudoprime with respect this base which is also a Gaussian Fermat pseudoprime to the base 1 + 2i is 10. Also with other Gaussian basis the combination with a Fermat test is very strong as it is shown in the following table, which presents the number of composite integers less than 4  ·  107 which are simultaneously Gaussian Fermat pseudoprimes with respect to a base z (horizontal) and Fermat pseudoprimes with respect to a base a (vertical).

[formula]

One of the reasons explaining this phenomenon is that Carmichael numbers, which always appear when combining two classical Fermat tests, are avoided when we combine a Fermat test and a Gaussian Fermat test, because Carmichael numbers are not necessarily G - Carmichael numbers and conversely. In fact, there are no Carmichael numbers of the form 4k + 3 smaller than 1018 which are also G - Carmichael numbers.

Recall that an integer n is called an r - Williams number [\cite=Ec] [\cite=WI] if

[formula]

The following result relates our previous discussion with 1 - Williams numbers.

An odd number [formula] is simultaneously a Carmichael number and a G - Carmichael number if and only if n is an 1 - Williams number and [formula] for every p dividing n.

Let [formula], then F(n) = n + 1. If n is both a Carmichael and a G - Carmichael number we have that, for every p dividing n:

[formula]

Now, if there exists a prime factor [formula] it follows that [formula], a contradiction. Hence, every prime factor is congruent with 3 modulo 4 and n is a 1 - Williams number.

On the other hand, if n is a 1 - Williams number, then for each prime factor p of n we have p - 1|n - 1 and p + 1|n + 1, so n is a Carmichael number. If n is to be a G - Carmichael it is also necessary that every factor [formula] satisfies p - 1|n + 1. But, by hypothesis, n does not have this kind of factors and the result follows.

Thus, the search for a number of the form [formula] which is both a G - Carmichael number and a Carmichael number is harder than to find a 1 - Williams number and, up to date, no 1 - Williams number is known