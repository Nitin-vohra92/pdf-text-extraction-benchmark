Lemma Corollary Example

Systems of Word Equations, Polynomials and Linear Algebra: A New Approach

Supported by the Academy of Finland under grant 257857

Introduction

Combinatorics on words is a part of discrete mathematics. It studies the properties of strings of symbols and has applications in many areas from pure mathematics to computer science. See, e.g., [\cite=Lo83] or [\cite=ChKa97] for a general reference on this subject.

Some of the most fundamental questions in combinatorics on words concern word equations. First such question is the complexity of the satisfiability problem, i.e., the problem of determining whether a given equation with constants has a solution. The satisfiability problem was proved to be decidable by Makanin [\cite=Ma77] and proved to be in PSPACE by Plandowski [\cite=Pl04], and it has been conjectured to be NP-complete.

A second question is how to represent all solutions of a constant-free equation. Hmelevskii proved that the solutions of an equation on three unknowns can be represented with parametric words, but this does not hold for four unknowns [\cite=Hm71]. The original proof has been simplified [\cite=KaSa08dlt] and used to study a special case of the satisfiability problem [\cite=Sa09dlt].

A third fundamental question, which is very important for this article, is the maximal size of an independent system of word equations. It was proved by Albert and Lawrence [\cite=AlLa85ehrenfeucht] and independently by Guba [\cite=Gu86] that an independent system cannot be infinite. However, it is still not known whether there are unboundedly large independent systems.

One of the basic results in the theory of word equations is that a nontrivial equation causes a defect effect. In other words, if n words satisfy a nontrivial relation, then they can be represented as products of n - 1 words. Not much is known about the additional restrictions caused by several independent relations [\cite=HaKa04].

In fact, even the following simple question, formulated already in [\cite=CuKa83], is still unanswered: How large can an independent system of word equations on three unknowns be? The largest known examples consist of three equations. This question can be obviously asked also in the case of n  >  3 unknowns. Then there are independent systems of size Θ(n4) [\cite=KaPl94]. Some results concerning independent systems on three unknowns can be found in [\cite=HaNo03], [\cite=CzKa07] and [\cite=CzPl09], but the open problem seems to be very difficult to approach with current techniques.

There are many variations of the above question: We may study it in the free semigroup, i.e., require that h(x)  ≠  ε for every solution h and unknown x, or examine only the systems having a solution of rank n - 1, or study chains of solution sets instead of independent systems. See, e.g., [\cite=HaKaPl02], [\cite=HaKa04], [\cite=Cz08] and [\cite=KaSa11adian].

In this article we will use polynomials to study some questions related to systems of word equations. Algebraic techniques have been used before, most notably in the proof of Ehrenfeucht's conjecture, which is based on Hilbert's basis theorem. However, the way in which we use polynomials is quite different and allows us to apply linear algebra to the problems.

The main contribution of this article is the development of new methods for attacking problems on word equations. This is done in Sections [\ref=sect:fixedlength] and [\ref=sect:solsets]. Other contributions include simplified proofs and generalizations for old results in Sections [\ref=sect:appl] and [\ref=sect:indsyst], and studying maximal sizes of independent systems of equations in Section [\ref=sect:indsyst]. Thus the connection between word equations and linear algebra is not only theoretically interesting, but is also shown to be very useful at establishing simple-looking results that have been previously unknown, or that have had only very complicated proofs. In addition to the results of the paper, we believe that the techniques may be useful in further analysis of word equations.

Next we give a brief overview of the paper. First, in Section [\ref=sect:basic] we define a way to transform words into polynomials and prove some basic results using these polynomials.

In Section [\ref=sect:fixedlength] we prove that if the lengths of the unknowns are fixed, then there is a connection between the ranks of solutions of a system of equations and the rank of a certain polynomial matrix. This theorem is very important for all the later results.

Section [\ref=sect:appl] contains small generalizations of two earlier results. These are nice examples of the methods developed in Section [\ref=sect:fixedlength] and have independent interest, but they are not important for the later sections.

In Section [\ref=sect:solsets] we analyze the results of Section [\ref=sect:fixedlength] when the lengths of the unknowns are not fixed. For every solution these lengths form an n-dimensional vector, called the length type of the solution. We prove that the length types of all solutions of rank n - 1 of a pair of equations are covered by a finite union of (n - 1)-dimensional subspaces if the equations are not equivalent on solutions of rank n - 1. This means that the solution sets of pairs of equations are in some sense more structured than the solution sets of single equations. This theorem is the key to proving the remaining results.

We begin Section [\ref=sect:indsyst] by proving a theorem about unbalanced equations. This gives a considerably simpler reproof and a generalization of a result in [\cite=HaNo03]. Finally, we return to the question about sizes of independent systems. There is a trivial bound for the size of a system depending on the length of the longest equation, because there are only exponentially many equations of a fixed length. We prove that if the system is independent even when considering only solutions of rank n - 1, then there is an upper bound for the size of the system depending quadratically on the length of the shortest equation. Even though it does not give a fixed bound even in the case of three unknowns, it is a first result of its type - hence opening, we hope, a new avenue for future research.

Basic Theorems

Let |w| be the length of a word w and |w|a be the number of occurrences of a letter a in w. The set of nonnegative integers is denoted by [formula] and the set of positive integers by [formula]. The empty word is denoted by ε.

In this section we give proofs for some well-known results. These serve as examples of the polynomial methods used. Even though the standard proofs of these are simple, we hope that the proofs given here illustrate how properties of words can be formulated and proved in terms of polynomials.

Let [formula] be an alphabet of numbers. For a word we define a polynomial and, if n  =  |w|  >  0, a rational function The mapping w  ↦  Pw is an injection from words to polynomials. Here the assumption 0∉Σ is needed; if injectivity of Pw would not be needed, then also 0 could be a letter. If [formula], then

[formula]

and if [formula], then

[formula]

If w∈Σ+ and [formula], then

The polynomial Pw can be viewed as a characteristic polynomial of the word w. A polynomial or formal power series obtained from a sequence in this way is sometimes known as the generating function or z-transform of the sequence. We could also replace X with a suitable number b and get a number whose reverse b-ary representation is w. Or we could let the coefficients of Pw be from some other commutative ring than [formula]. Similar ideas have been used to analyze words in many places, see, e.g., [\cite=Ku97] and [\cite=Sa85].

If w  =  1212, then and

A word w∈Σ+ is primitive if it is not of the form uk for any k  >  1. If w  =  uk and u is primitive, then u is a primitive root of w.

If w is primitive, then Pw is not divisible by any polynomial of the form where n  <  |w| is a divisor of |w|.

If Pw is divisible by (X|w|  -  1)  /  (Xn  -  1), then there are numbers [formula] such that so [formula].

The next two theorems are among the most basic and well-known results in combinatorics on words (except for item [\eqref=item:r] of Theorem [\ref=thm:commutation], which, however, appeared in [\cite=HoKo09] in a slightly different form).

Every nonempty word has a unique primitive root.

Let um  =  vn, where u and v are primitive. We need to show that u  =  v. We have Because m|u|  =  n|v|, we get If d  =   gcd (|u|,|v|), then gcd (X|u|  -  1,X|v|  -  1)  =  Xd  -  1. Thus Pu must be divisible by (X|u|  -  1)  /  (Xd  -  1) and Pv must be divisible by (X|v|  -  1)  /  (Xd  -  1). By Lemma [\ref=lem:primdiv], both u and v can be primitive only if |u|  =  d  =  |v|.

The primitive root of a word w∈Σ+ is denoted by ρ(w).

For u,v∈Σ+, the following are equivalent:

ρ(u)  =  ρ(v),

if U,V∈{u,v}* and |U|  =  |V|, then U  =  V,

u and v satisfy a nontrivial relation,

Ru  =  Rv.

([\ref=item:rho]) ⇒   ([\ref=item:all]):

([\ref=item:all]) ⇒   ([\ref=item:exists]): Clear.

([\ref=item:exists]) ⇒   ([\ref=item:r]): Let where ui,vj∈{u,v}. Then for some polynomial p. If m  ≠  n or ui  ≠  vi for some i, then p  ≠  0, and thus Ru  =  Rv.

([\ref=item:r]) ⇒   ([\ref=item:rho]): We have so u|v|  =  v|u| and

Similarly, polynomials can be used to give a simple proof for the theorem of Fine and Wilf. In fact, one of the original proofs in [\cite=FiWi65] uses power series. The proof given here is essentially this original proof formulated in terms of our polynomials. Algebraic techniques have also been used to prove variations of this theorem [\cite=MiShWa01].

If ui and vj have a common prefix of length then ρ(u)  =  ρ(v).

Let gcd (|u|,|v|)  =  d, [formula], m  /  |u|  =  r and m  /  |v|  =  s. If ρ(u)  ≠  ρ(v), then ur  ≠  vs, so ur and vs have a maximal common prefix of length k  <  m. This means that is divisible by Xk, but not by Xk + 1, so also the polynomial is divisible by Xk, but not by Xk + 1. Thus k can be at most the degree of this polynomial, which is at most |u|  +  |v|  -  d  -  1.

Solutions of Fixed Length

In this section we apply polynomial techniques to word equations. From now on, we will assume that there are n unknowns, they are ordered as [formula] and Ξ is the set of these unknowns.

A (coefficient-free) word equation u  =  v on n unknowns consists of two words u,v∈Ξ*. A solution of this equation is any morphism h:Ξ*  →  Σ* such that h(u)  =  h(v). The equation is trivial if u and v are the same word.

The (combinatorial) rank of a morphism h is the smallest number r for which there is a set A of r words such that h(x)∈A* for every unknown x. A morphism of rank at most one is periodic.

Let h:Ξ*  →  Σ* be a morphism. The length type of h is the vector This length type L determines a morphism It is important that [formula] depends only on L and not on h.

If E is a word equation, the set of its solutions is denoted by [formula], the set of solutions of rank r by [formula], the set of solutions of length type L by [formula] and the set of solutions of rank r and length type L by [formula]. These can be naturally generalized for systems of equations. For example, if E1 and E2 are word equations, then [formula].

For a word equation (where yi,zi∈Ξ), a variable x∈Ξ and a length type L, let Informally, this polynomial encodes the positions of x in the equation E.

A morphism h:Ξ*  →  Σ* of length type L is a solution of an equation E:u  =  v if and only if

Now h(u)  =  h(v) if and only if Ph(u)  =  Ph(v), and the polynomial Ph(u)  -  Ph(v) can be written as [formula] by [\eqref=eq:prodp].

Theorem [\ref=thm:weqpeq] means that if we fix a length type L, then we can turn a word equation into a linear equation where the polynomials QE,x,L are the coefficients. A solution for this linear equation is an n-dimensional vector over the field of rational functions, and [formula] corresponds to a solution of the linear equation.

Let Ξ  =  {x,y,z}, E:xyz  =  zxy and L  =  (1,1,2). Then If h is the morphism defined by h(x)  =  1, h(y)  =  2 and h(z)  =  12, then h is a solution of E and

At this point we start using linear algebra. We will do this over two fields: The field of rational numbers (for the first time in Lemma [\ref=lem:rdim]) and the field of rational functions (for the first time in Lemma [\ref=lem:rdim2]). We start with an example.

Consider the morphism h:{x1,x2,x3}*  →  {1,2}* of rank 2 defined by If h is a solution of an equation E, then so is [formula] for every morphism g:{1,2}*  →  {1,2}*. The length type of [formula] is Because the vectors (1,0,1) and (0,1,1) are linearly independent, these length types essentially form a two-dimensional space (of course |g(1)| and |g(2)| are nonnegative integers, so the length types don't form the whole space). This observation is formalized and generalized in Lemma [\ref=lem:rdim].

A morphism φ:Ξ*  →  Ξ* is an elementary transformation if there are two unknowns x,y∈Ξ so that φ(y)∈{xy,x} and φ(z)  =  z for [formula]. If φ(y)  =  xy, then φ is regular, and if φ(y)  =  x, then φ is singular. The next lemma follows immediately from results in [\cite=Lo83].

Every solution h of an equation E has a factorization where α(x)∈{x,ε} for all x∈Ξ, every φi is an elementary transformation, [formula] is a solution of E and θ(x)  ≠  ε for all x∈Ξ. If α(x)  =  ε for s unknowns x and t of the φi are singular, then the rank of [formula] is n  -  s  -  t.

Let E be an equation on n unknowns and let [formula]. There is an r-dimensional subspace V of [formula] containing L such that the set of those length types of morphisms in [formula] that are in V is not covered by any finite union of (r - 1)-dimensional spaces.

For arbitrary morphisms F:Ξ*  →  Ξ* and G:Ξ*  →  Σ*, let be the length type of G as a column vector and let be an n  ×  n matrix. Then More generally, if [formula] are morphisms Ξ*  →  Ξ*, then

Let as in Lemma [\ref=lem:elemtrans]. Let [formula]. The rank of f is n  -  s  -  t  ≥  r if s and t are as in Lemma [\ref=lem:elemtrans]. The morphism [formula] is a solution of E for every morphism g:Ξ*  →  Σ*. The length type of [formula] is where To prove the theorem, it needs to be shown that the rank of A is at least r. This can be done by determining the ranks of the matrices Aα and Aφk.

The matrix Aα is a diagonal matrix and the ith element on the diagonal is 0 if α(xi)  =  ε and 1 otherwise. Thus the rank of Aα is n  -  s.

If φ is the elementary transformation defined by φ(x1)  =  x2x1, then is a matrix of rank n (this is an identity matrix except for the second element on the first row). In general, the rank of Aφ is n for every regular elementary transformation φ.

If φ is the elementary transformation defined by φ(x1)  =  x2, then is a matrix of rank n  -  1 (this is an identity matrix except for the first two elements on the first row). In general, the rank of Aφ is n  -  1 for every singular elementary transformation φ.

The rank of Aα is n  -  s, t of the matrices Aφk have rank n  -  1 and the rest have rank n. Thus the rank of A is at least n  -  s  -  t, which is at least r.

Let E be an equation on n unknowns and let [formula]. There are morphisms f:Ξ*  →  Ξ* and θ:Ξ*  →  Σ* and polynomials pij such that the following conditions hold:

[formula],

f is a solution of E,

θ(x)  ≠  ε for every x∈Ξ,

[formula] for all i,j if g:Ξ*  →  Σ* is a morphism of the same length type as θ,

r of the vectors [formula], where [formula], are linearly independent.

The proof is quite similar to the proof of Lemma [\ref=lem:rdim].

For arbitrary morphisms F:Ξ*  →  Ξ* and G:Ξ*  →  Σ* and length type L, define an n-dimensional column vector and an n  ×  n polynomial matrix where If L is the length type of G, then More generally, if [formula] are morphisms Ξ*  →  Ξ* and Lk is the length type of [formula], then The matrices BF,L will be used to define the polynomials pij.

Let as in Lemma [\ref=lem:elemtrans]. Let [formula]. The first three conditions are satisfied by θ and f. The rank of f is n  -  s  -  t  ≥  r if s and t are as in Lemma [\ref=lem:elemtrans].

Let L be the length type of θ and let g be a morphism of length type L. Then where and Lk is the length type of [formula]. Let Then the fourth condition holds, because [formula].

To prove that the last condition holds, it must be proved that the rank of the matrix B is at least r. This can be done by determining the ranks of the matrices Bα,L and Bφk,L.

The matrix Bα,L is a diagonal matrix and the ith element on the diagonal is 0 if α(xi)  =  ε and 1 otherwise. Thus the rank of Bα,L is n  -  s.

If φ is the elementary transformation defined by φ(x1)  =  x2x1, then is a matrix of rank n (this is an identity matrix except for the first two elements on the first row). In general, the rank of Bφ,L is n for every regular elementary transformation φ.

If φ is the elementary transformation defined by φ(x1)  =  x2, then is a matrix of rank n  -  1 (again, this is an identity matrix except for the first two elements on the first row). In general, the rank of Bφ,L is n  -  1 for every singular elementary transformation φ.

The rank of Bα,L0 is n  -  s, t of the matrices Bφk,Lk have rank n  -  1 and the rest have rank n. Thus the rank of B is at least n  -  s  -  t, which is at least r.

With the help of these lemmas, we are going to analyze solutions of some fixed length type. Principal (or fundamental) solutions, which were implicitly present in the previous lemmas (see [\cite=Lo83]), have been used in connection with fixed lengths also in [\cite=Ho00] and [\cite=Ho01].

Let [formula] be a system of equations on n unknowns and let [formula]. Let If [formula], then the rank of the m  ×  n polynomial matrix (qij) is at most n  -  r. If the rank of the matrix is 1, at most one component of L is zero and the equations are nontrivial, then

Let [formula]. If r  =  1, the first claim follows from Theorem [\ref=thm:weqpeq], so assume that r  >  1. Let E be an equation that has the same nonperiodic solutions as the system. Lemma [\ref=lem:rdim2] will be used for this equation. Fix k and let g1:Ξ*  →  Σ* be the morphism determined by for all i and let g2:Ξ*  →  Σ* be the morphism determined by and for all i  ≠  k. Then [formula] and [formula] are solutions of every El, so for all l by Theorem [\ref=thm:weqpeq]. Because also and we get for all l. Thus the vectors [formula] are solutions of the linear system of equations determined by the matrix (qij). Because at least r of these vectors are linearly independent, the rank of the matrix is at most n  -  r.

If at most one component of L is zero and the equations are nontrivial, then all rows of the matrix are nonzero. If also the rank of the matrix is 1, then all rows are multiples of each other and the second claim follows by Theorem [\ref=thm:weqpeq].

Applications

Based on Theorem [\ref=thm:rank], the polynomial and linear algebraic methods will be developed further in Section [\ref=sect:solsets]. However, Theorem [\ref=thm:rank] is already strong enough to provide reproofs, generalizations and improvements of some results.

The graph of a system of word equations is the graph where Ξ is the set of vertices and there is an edge between x and y if one of the equations in the system is of the form [formula]. The following well-known theorem can be proved with the help of Theorem [\ref=thm:rank].

Consider a system of equations whose graph has r connected components. If h is a solution of this system and h(xi)  ≠  ε for all i, then the rank of h is at most r.

We can assume that the connected components are and the equations are where and kj  <  j. Let qij be as in Theorem [\ref=thm:rank]. If we remove the columns [formula] from the (n - r)  ×  n matrix (qij), we obtain a square matrix M where the diagonal elements are not divisible by X, but all elements above the diagonal are divisible by X. This means that det (M) is not divisible by X, so det (M)  ≠  0. Thus the rank of the matrix (qij) is n - r and h has rank at most r by Theorem [\ref=thm:rank].

The next theorem generalizes a result from [\cite=CzKa07] for more than three unknowns.

If a pair of nontrivial equations on n unknowns has a solution h of rank n - 1 where no two of the unknowns commute, then there is a number k  ≥  1 such that the equations are of the form

By Theorem [\ref=thm:graph], the equations must be of the form [formula]. Let them be where u,v,u',v'∈{x1,x2}* and [formula]. It can be assumed that z  =  x3 and If it were |h(x1u)|  =  |h(x2v)|, then h(x1) and h(x2) would commute, so |h(x1u)|  >  |h(x2v)|. If v would contain x1, then h(x1) and h(x2) would commute by Theorem [\ref=thm:finewilf], so v  =  xk - 12 for some k  ≥  1.

Let L be the length type of h and let qij be as in Theorem [\ref=thm:rank]. By Theorem [\ref=thm:rank], the rank of the matrix (qij) must be 1 and thus The term of of the lowest degree is X|h(xk2)|. The same must hold for and thus the term of q23 of the lowest degree must be - X|h(xk2)|. We know that x2v  =  xk2 and assumed that |h(x2v)|  ≤  |h(x2v')|. If it were |h(x2v)|  <  |h(x2v')|, then h(x3) would start in [formula] before the end of h(x2v'), which is not possible. This means that |h(x2v')|  =  |h(xk2)|  ≤  |h(x1u')| and z'  =  x3. As above, we conclude that |h(x2v')|  <  |h(x1u')|, v' cannot contain x1 and v'  =  xk - 12.

It was proved in [\cite=Ko98] that if holds for m + n + 3 consecutive values of i, then it holds for all i. By using similar ideas as in Theorem [\ref=thm:rank], we improve this bound to m + n and prove that the values do not need to be consecutive. In [\cite=Ko98] it was also stated that the arithmetization and matrix techniques in [\cite=Tu87] would give a simpler proof of a weaker result. Similar questions have been studied in [\cite=HoKo07] and there are relations to independent systems [\cite=Pl03].

Let m,n  ≥  1, sj,tj∈Σ* and uj,vj∈Σ+. Let If Ui  =  Vi holds for m + n values of i, then it holds for all i.

The equation Ui  =  Vi is equivalent to PUi  -  PVi  =  0. Because and PVi is of a similar form, this equation can be written as

[formula]

where yj,zk are some polynomials that do not depend on i and K is the set of those [formula] for which [formula] is not any of the numbers [formula] ([formula]). If Ui1  =  Vi1 and Ui2  =  Vi2, then Thus [formula] and the size of K is at most n - 1. If [\eqref=eq:1] holds for m  +  1  +    #  K  ≤  m + n values of i, it can be viewed as a system of equations where yj,zk are unknowns. The coefficients of this system form a generalized Vandermonde matrix whose determinant is nonzero, so the system has a unique solution yj  =  zk  =  0 for all j,k. This means that [\eqref=eq:1] holds for all i and Ui  =  Vi for all i.

Sets of Solutions

In this section we analyze how the polynomials behave when L is not fixed. Let be the additive monoid of linear homogeneous polynomials with nonnegative integer coefficients on the variables [formula]. The monoid ring of M over [formula] is the ring formed by expressions of the form where [formula] and pi∈M, and the addition and multiplication of these generalized polynomials is defined in a natural way. This ring is denoted by [formula]. If [formula], then the value of a polynomial p∈M at the point [formula] is denoted by p(L), and the polynomial we get by making this substitution in [formula] is denoted by s(L).

The ring [formula] is isomorphic to the ring [formula] of polynomials on n variables. The isomorphism is given by XXi  ↦  Yi. However, the generalized polynomials where the exponents are in M are suitable for our purposes.

If ai  ≤  bi for [formula], then we use the notation If p,q∈M and [formula], then p(L)  ≤  q(L) for all [formula].

For an equation [formula] we define Then SE,x(L)  =  QE,x,L. Theorem [\ref=thm:weqpeq] can be formulated in terms of these generalized polynomials.

A morphism h:Ξ*  →  Σ* of length type L is a solution of an equation E if and only if

Let E:x1x2x3  =  x3x1x2. Then

The length of an equation E:u  =  v is |E|  =  |uv|. The number of occurrences of an unknown x in E is |E|x  =  |uv|x.

Let E1,E2 be a pair of nontrivial equations on n unknowns. Let [formula]. For some unknowns xk,xl, the set of length types of solutions of the pair of rank n - 1 is covered by a union of (|E1|xk  +  |E1|xl)2 (n - 1)-dimensional subspaces of [formula]. If [formula] is a minimal such cover and L∈Vi for some i, then [formula].

Let for i  =  1,2 and [formula]. If all 2  ×  2 minors of the 2  ×  n matrix (sij) are zero, then for all length types L of solutions of rank n - 1 the rank of the matrix (qij) in Theorem [\ref=thm:rank] is 1 and E1 and E2 are equivalent, which is a contradiction. Thus there are k,l such that The generalized polynomial tkl can be written as where pi,qi∈M and pi  ≠  qj for all i,j. If L is a length type of a solution of rank n - 1, then M = N and L must be a solution of the system of equations

[formula]

for some permutation σ. For every σ the equations determine an at most (n - 1)-dimensional space.

Let the equations be E1:u1  =  v1 and E2:u2  =  v2. Let

[formula]

Then s1k,s2l,s1l,s2k can be written as where [formula], [formula], and so on. The polynomials pi form a subset of the polynomials ai  +  bj, a'i  +  b'j, ci  +  d'j and c'i  +  dj (the reason that they form just a subset is that we assumed pi  ≠  qj for all i,j). For any i, let ji be the smallest index j such that ai  +  bj  =  pm for some m. Then for every i,j,m such that ai  +  bj  =  pm we have [formula]. We can do a similar thing for the polynomials a'i,b'i and ci,d'i and c'i,di. In this way we obtain at most polynomials pi such that for any L the value of one of these polynomials is minimal among the values pi(L). Similarly we obtain at most "minimal" polynomials qi. If L satisfies one of the systems [\eqref=eq:ssyst], then the smallest of the values pi(L) must be the same as the smallest of the values qi(L). Thus L must satisfy some equation pi  =  qj, where pi and qj are some of the "minimal" polynomials. There are at most possible pairs of such polynomials, and each of them determines an (n - 1)-dimensional space.

Consider the second claim. Because the cover is minimal, there is a solution of rank n - 1 whose length type is in Vi, but not in any other Vj. By Lemma [\ref=lem:rdim], the set of length types of solutions of rank n - 1 in this space cannot be covered by a finite union of (n - 2)-dimensional spaces. Thus one of the systems [\eqref=eq:ssyst] must determine the space Vi. The same holds for systems coming from all other nonzero 2  ×  2 minors of the matrix (sij), so E1 and E2 have the same solutions of rank n - 1 and length type L for all L∈Vi by Theorem [\ref=thm:rank].

The following example illustrates the proof of Theorem [\ref=thm:cover]. It gives a pair of equations on three unknowns where the required number of subspaces is two. We do not know any example where more spaces would be necessary.

Consider the equations and the generalized polynomial If L is a length type of a nontrivial solution of the pair E1,E2, then s(L)  =  0. If s(L)  =  0, then L must satisfy an equation p  =  q, where The possible relations are If L satisfies one of the first three, then s(L)  =  0. If L satisfies the last one, then s(L)  ≠  0, except if L  =  0. So if h is a nonperiodic solution, then There are no nonperiodic solutions with h(x2)  =  ε, but every h with h(x3)  =  ε or h(x1x2)  =  h(x3) is a solution.

Independent Systems

A system of word equations [formula] is independent if it is not equivalent to any of its proper subsystems.

A sequence of nontrivial equations [formula] is a chain if

The question of the maximal size of an independent system is open. The only things that are known are that independent systems cannot be infinite [\cite=AlLa85ehrenfeucht] [\cite=Gu86] and there are systems of size Θ(n4), where n is the number of unknowns [\cite=KaPl94]. The question of the maximal size of a chain is similarly open. For a survey on these topics, see [\cite=KaSa11adian].

An equation u  =  v is balanced if |u|x  =  |v|x for every unknown x. Harju and Nowotka proved that if an independent pair of equations on three unknowns has a nonperiodic solution, then the equations must be balanced [\cite=HaNo03]. The proof is long and it is based on a theorem of Spehner [\cite=Sp86] (or alternatively a theorem of Budkina and Markov [\cite=BuMa73]), which also has only a very complicated proof. However, with the help of Theorem [\ref=thm:cover] we get a significantly simpler proof and a generalization for this result.

Let E1,E2 be a pair of equations on n unknowns having a solution of rank n - 1. If E1 is not balanced, then [formula].

If E1 is the equation u  =  v and h is a solution of E1, then and |u|xi  ≠  |v|xi for at least one i. Thus the set of length types of solutions of E1 is covered by a single (n - 1)-dimensional space V. Because the pair E1,E2 has a solution of rank n - 1, V is a minimal cover for the length types of the solutions of the pair of rank n - 1. By Theorem [\ref=thm:cover], E1 and E2 have the same solutions of length type L and rank n - 1 for all L∈V.

Another way to think of this result is that if E1 is not balanced but has a solution of rank n - 1 that is not a solution of E2, then the pair E1,E2 causes a larger than minimal defect effect.

If h:Ξ*  →  Σ* is a morphism, then the entire system generated by h is the set of all equations satisfied by h. It is denoted by Kh. As a consequence of Theorem [\ref=thm:balance], we get the following result about entire systems. The case of three unknowns was proved in [\cite=HaNo03].

If g,h:Ξ*  →  Σ* are morphisms of rank n - 1 and Kg  ≠  Kh, then [formula] contains only balanced equations.

It can be assumed that there is an equation [formula]. For any equation [formula], g is a solution of the pair E1,E2 and h is a solution of E1 but not of E2. By Theorem [\ref=thm:balance], E1 must be balanced.

As the main application of the tools developed in this article, the following variation of the question about maximal sizes of chains is studied: How long can a sequence of nontrivial equations [formula] be if We prove an upper bound depending quadratically on the length of the first equation. For three unknowns we get a similar bound for the size of independent systems and chains. Previously no bounds like those in Theorem [\ref=thm:chain] and Corollary [\ref=cor:chain] have been known.

Let [formula] be nontrivial equations on n unknowns and let If the set of length types of solutions of the pair E1,E2 of rank n - 1 is covered by a union of N (n - 1)-dimensional subspaces, then m  ≤  N  +  1. There are two unknowns x,y such that

It can be assumed that Ei is equivalent to the system [formula] for all [formula]. Let the set of length types of solutions of E2 of rank n - 1 be covered by the (n - 1)-dimensional spaces [formula]. Some subset of these spaces forms a minimal cover for the length types of solutions of E3 of rank n - 1. If this minimal cover would be the whole set, then E2 and E3 would have the same solutions of rank n - 1 by the second part of Theorem [\ref=thm:cover]. Thus the set of length types of solutions of E3 of rank n - 1 is covered by some N - 1 of these spaces. We conclude inductively that the set of length types of solutions of Ei of rank n  -  1 is covered by some N  -  i  +  2 of these spaces for all [formula]. It must be N  -  m  +  2  ≥  1, so m  ≤  N  +  1. The second claim follows by Theorem [\ref=thm:cover].

In the case of three unknowns, Theorem [\ref=thm:chain] gives an upper bound depending on the length of the shortest equation for the size of an independent system of equations, or an upper bound depending on the length of the first equation for the size of a chain of equations. A better bound in Theorem [\ref=thm:cover] would immediately give a better bound in the following corollary.

If [formula] is an independent system on three unknowns having a nonperiodic solution, then for some x,y∈Ξ. If [formula] is a chain of equations on three unknowns, then for some x,y∈Ξ.

Corollary [\ref=cor:chain] means that as soon as we take one equation on three unknowns, we get a fixed bound for the size of independent systems containing that equation.

It is worth noting that the bounds in Theorem [\ref=thm:chain] and Corollary [\ref=cor:chain] do not depend on the number of unknowns, only on the length of one equation.

Getting a similar bound for the sizes of independent systems or chains in the case of more than three unknowns remains an open problem. Such a bound would have to depend on the number of unknowns. Indeed, in Theorem [\ref=thm:chain] it is not enough to assume that the equations are independent and have a common solution of rank n  -  1. If the number of unknowns is not fixed, then there are arbitrarily large such systems where the length of every equation is 10 [\cite=KaPl94].