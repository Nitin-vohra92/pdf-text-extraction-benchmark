Lemma Proposition Corollary Claim Algorithm Definition Property Remark

On distinct distances in homogeneous sets in the Euclidean space

The research was supported by OTKA and NSERC grants.

Csaba D. Tóth

Introduction

The history of the distinct distance problem goes back to Erd os [\cite=e-osdnp-46] who asked the question: What is the minimal number gd(n) of distinct distances determined by n points in the d-dimensional Euclidean space [formula]? n points in the d-dimensional integer grid d show that gd(n) = O(n2 / d) for any d  ≥  2 and, in particular, [formula]. Erd os conjectured that these bounds are essentially optimal.

An initial lower bound of [formula] by Erd os [\cite=e-osdnp-46] was improved over the last almost 60 years by Moser, Beck, Chung, Szemerédi, Trotter, and Székely [\cite=Moser] [\cite=b-olpps-83] [\cite=Chung] [\cite=CST] [\cite=s-cnhep-97]. Research efforts have lead to several powerful methods (such as the crossing theory [\cite=s-cnhep-97] and the ε-cutting theory [\cite=ceg-ccbac-90]) which, in turn, found innumerable applications in discrete and computational geometry. An excellent survey by Pach and Sharir [\cite=ps-gi-04] elaborate on the history of the distinct distance problem and its connections to other fields of discrete mathematics. Determining the order of magnitude of g2(n) (and gd(n) for every [formula]) seems elusive. The currently known best lower bound in the plane, g2(n)  =  Ω(n.8641), is due to Katz and Tardos [\cite=kt-neied-04]. Their proof combines a method of Solymosi and Tóth [\cite=st-ddp-01] with results from entropy and additive number theory.

In higher dimensions, not much work has been done. After some initial results by Clarkson et al. [\cite=ceg-ccbac-90] and by Spencer et al. [\cite=Spencer], Aronov et al. [\cite=aps-ddthd-04] have showed recently that the number of distinct distances determined by a set of n points in three-dimensional space is g3(n) = Ω(n77 / 141  -  ε)  =  Ω(n.5460) for any ε  >  0. Solymosi and Vu [\cite=sv-nobed-05] proved a general lower bound of gd(n) = Ω(n2 / d - 2 / d(d + 2)) for any fixed d  ≥  4.

In this paper, we consider the minimum number hd(n) of distinct distances in homogeneous sets of n points in [formula]. A finite point set [formula] is homogeneous if the following two conditions hold: P lies in the interior of an axis-aligned d-dimensional cube C of volume |P|, and any unit cube in [formula] contains at most O(1) points of P. Homogeneous sets represent an important special case for the distinct distance problem because the best known upper bound constructions (the d-dimensional integer grids) are homogeneous, and because of numerous connections to harmonic analysis [\cite=b-sttsp-99] [\cite=hi-cafed-05] [\cite=ikp-fbedp-99] [\cite=kt-scbfc-01]. Iosevich [\cite=i-ccft-01] studied the distinct distance problem for homogeneous sets (with additional restrictions). He showed that hd(n) = Ω(n3 / 2d) for any fixed d  ≥  2. Solymosi and Vu [\cite=sv-ddhdh-04] proved a general bound of hd(n)  =  Ω(n2 / d - 1 / d2) for every dimension d  ≥  2. For d  =  3, they have also obtained a slightly better bound h3(n)  =  Ω(n.5794). In this paper, we improve all previous lower bounds on the number of distinct distances in homogeneous sets of n points in [formula].

For every [formula], there is a constant cd such that in every homogeneous set P of n points in [formula], there is a point p∈P from which there are at least

[formula]

distinct distances measured to other points of P. In particular, we have [formula].

For d = 3,4, and 5, our general lower bound is h3(n)  =  Ω(n.5999), h4(n)  =  Ω(n.4705), and h5(n)  =  Ω(n.3846). In three-dimensions, we slightly improve on this bound and prove the following.

In every homogeneous set P of n points in [formula], there is a point p∈P from which there are at least

[formula]

distinct distances measured to other points of P. In particular, we have [formula].

We prove Theorem [\ref=thm:main] in Section [\ref=sec:proof]. The proof of Theorem [\ref=thm:3D] can be found in Section [\ref=sec:3D]. In the next section, we present a key lemma on the number of k-flats incident to many points in a homogeneous point set in [formula], for 1  ≤  k  <  d.

Rich hyperplanes in homogeneous sets

Consider a set P of n points in [formula]. We say that a k-flat (a k-dimensional affine subspace) is m-rich if it is incident to at least m points of P. The celebrated Szemerédi-Trotter Theorem [\cite=st-epdg-83] states that for n points in the plane, the number of m-rich lines (1-flats) is at most O(n2 / m3  +  n / m), and this bound is tight in the worst case.

The number of m-rich k-flats in [formula] has been intensely studied. The Szemerédi-Trotter type results have widespread applications in discrete and combinatorial geometry. The Szemerédi-Trotter Theorem's multi-dimensional generalizations [\cite=aa-cfi-92] [\cite=es-hipac-90] [\cite=et-inh-05] always impose some kind of restriction on the point set or on the set of k-flats, otherwise m points on a line give rise to an infinitely many of m-rich k-flats for any 2  ≤  k  ≤  d.

We adopt the following terminology: A set of k + 1 points in [formula], k  ≤  d, is affine independent if it is contained in a unique k-flat, which is said to be spanned by the point set. A point set P determines all the k-flats spanned by some k + 1 affine independent points of P. For a constant α > 0, a finite point set [formula] that spans a k-flat is α-degenerate if any (k - 1)-flat contains at most α  ·  |P| points of P. For a finite point set [formula] and a constant α > 0, we say that a k-flat F is α-degenerate if the point set [formula] is α-degenerate. Note, for example, that all points of [formula] in a 1-degenerate k-flat F may lie on a (k - 1)-flat, but an α-degenerate k-flat for α < 1 must be spanned by points of P. We recall a result of Beck [\cite=b-olpps-83] on α-degenerate hyperplanes.

For every [formula], there are constants αk,βk > 0 with the following property: For every [formula] and every finite point set [formula], if a k-flat F is αk-degenerate, then [formula] spans at least [formula] distinct (k - 1)-flats.[formula]

Elekes and Tóth [\cite=et-inh-05] proved that for every dimension [formula], there is a constant γd > 0 such that the number of m-rich γd-degenerate hyperplanes for n points in [formula] is at most O(nd / md + 1  +  nd - 1 / md - 1). The first term, O(nd / md + 1), is dominant only if [formula]. We show below a much stronger upper bound for homogeneous sets: A homogeneous set of n points in [formula] determines at most O(nd / md + 1) distinct m-rich hyperplanes for every [formula], d  ≤  m  ≤  n.

We formulate our result for a slightly more general class of point sets, where n denotes the volume of the enclosing cube, rather than the number of points. We say that a point set P is well separated if any unit cube in [formula] contains at most O(1) points of P. By definition, every homogeneous set of n points in [formula] is well separated, and lies in a cube of volume n.

Let fd,k(P,m) denote the maximal number of m-rich k-flats in a well separated point set P contained in the interior of a d-dimensional cube of volume n in [formula], and let

[formula]

Solymosi and Vu [\cite=sv-ddhdh-04] established the following lemma for the number of m-rich lines in homogeneous sets of n points in [formula]. Their proof carries over verbatim for well separated sets of volume n.

For every [formula], there is a constant cd such that

[formula]

[formula]

We extend their result for arbitrary [formula], 1  ≤  k  ≤  d - 1.

For every [formula], 1  ≤  k  <  d, there is a constant cd,k such that

[formula]

The example of the d-dimensional integer grid d shows that this bound is best possible for every [formula], 1  ≤  m  ≤  nk / d.

For a fixed [formula], we prove that fd,k(n,m) = O(nk + 1 / md + 1). We proceed by induction on k, 1  ≤  k  ≤  d. The base case, k = 1, is equivalent to Lemma [\ref=lem:SV]. Let us assume that 1 < k  ≤  d and that fn0,k0(P,m) = O(nk0 + 10 / md + 1) for every k0, 1  ≤  k0 < k, and [formula].

Consider a well separated set P that lies in the interior of a d-dimensional cube C of volume n. Clearly, we have |P| = O(n). We may choose an orthogonal coordinate system such that all coordinates of every point of P are irrational and P lies in the interior of cube C, whose vertices have rational coordinates. This guarantees that for any subdivision of C into congruent subcubes, every point of P lies in the interior of a subcube. For [formula], let Ci denote the subdivision of the cube C into 2id congruent cubes. For instance, C0  =  {C}, C1 is a subdivision of C into 2d cubes, and C⌈( log n) / d⌉ is a subdivision into constant volume cubes. There is a constant δd > d such that every k-flat F intersects at most δd|Ci|k / d  =  δd2ik cubes of Ci. If we put

[formula]

then every m-rich k-flat F is incident to an average of at least m / (δd2μk)  ≥  4(k + 1) points in a cube Q∈Cμ. That is, at least m / 2 points of [formula] lie in subcubes Q∈Cμ where [formula].

Let αk and βk be the constants from Theorem [\ref=thm:Beck]. Let F denote the m-rich k-flats. We classify the k-flats in F as follows:

[formula] is not αk-degenerate},

F2  =  {F∈F: at least [formula] points of [formula] lie in cubes Q∈Cμ such that the point set [formula] is αk-degenerate},

[formula].

We show below that |Fq| = O(nk + 1 / md + 1), for q = 1, 2, and 3. Every F∈F1 contains an (αkm)-rich (k - 1)-flat. By induction, the number of (αkm)-rich (k - 1)-flats is O(nk / (αkm)d + 1)  =  O(nk / md + 1). Every (αkm)-rich (k - 1)-flat R can be extended to a m-rich k-flat in O(n) different ways: R together with a point of [formula] spans a k-flat. This gives an upper bound |F1| = O(nk + 1 / md + 1).

For an upper bound on |F2|, we consider the subdivision Cμ. Let K denote the affine independent (k + 1)-element subsets of P that determine some m-rich k-flat in F2 and lie in some cube Q∈Cμ. The volume of every cube Q∈Cμ is O(n / 2μd) = O(n / md / k). Since P is well separated, we have [formula]. A trivial upper bound for the number of affine independent (k + 1)-element sets in all cubes of Cμ is

[formula]

We obtain a lower bound for |K| by counting the affine independent sets in each F∈F2. At least m / 4 points of [formula] lie in cubes Q∈Cμ where the point set [formula] is αk-degenerate. By Theorem [\ref=thm:Beck], every αk-degenerate set [formula] determines at least [formula] affine independent (k + 1)-element sets. If we denote by K(F) the number of (k + 1)-element subsets of K that span F, then we have

[formula]

We conclude that [formula]. By contrasting the upper and lower bounds for |K|, we get |F2| = O(nk + 1 / md + 1).

Finally, we consider F3. For every m-rich k-flat F∈F3, we define a set S(F) of cubes from Ci, [formula]. A cube Q∈Ci is in S(F) if and only if the point set [formula] is not αk-degenerate, but [formula] is αk-degenerate for every i', 0  ≤  i' < i, where Q(i') is the (unique) cube Q(i')∈Ci' containing Q. If [formula] is not αk-degenerate, for example, then [formula] for. Observe that the cubes of S(F) are pairwise interior disjoint and they jointly cover [formula]. We denote by (X) the dimension of the affine subspace spanned by a finite point set X. For each F∈F3, we further classify the cubes in S(F) according to three parameters: For [formula], [formula], and [formula], let S(F,i,j,r) denote the set of cubes Q∈S(F) such that

Q∈Ci,

[formula],

[formula].

Some of the cubes Q∈S(F) are not included in any S(F,i,j,r,)  ⊂  S(F): This is the case for every [formula] for which [formula] or μ < i. The total of number points of [formula] in these cubes is less than

[formula]

Therefore, the cubes in S(F,i,j,r) for all i, j, r jointly contain at least m / 4 points of [formula]:

[formula]

For every Q∈S(F,i,j,r), there is an r-flat R  ⊂  F, such that [formula]. Let us denote by Q' the cube in Ci - 1 that contains Q∈Ci. Since [formula] is already αk-degenerate, we have [formula]. Let D(Q,R) be the set of all (k - r)-element affine independent sets [formula] such that R and u together span F. Since [formula] is αk-degenerate, there are [formula] sets in D(Q,R). Let D'(Q,R) be a a subset of D(Q,R) of size [formula].

Let T(F,i,j,r) denote the set of triples (Q,R,u) such that Q∈S(F,i,j,r), R is an r-flat with [formula], and u∈D'(Q,R). We have a lower bound

[formula]

Let us put

[formula]

and then Inequality ([\ref=eq:m4]) can be rewritten as

[formula]

By summing over all F∈F3, we get

[formula]

We also compute an upper bound for the quantity on the left side of Inequality ([\ref=eq:fijr]). First, we give an upper bound on the number of triples (Q,R,u)∈T(F,i,j,r) for all F∈F3. Recall that (Q,R,u)∈T(F,i,j,r) implies that Q∈Ci, and R is an r-flat incident to [formula] points of [formula]. Every cube Q∈Ci has volume n / 2ik and [formula] is well separated. By our induction hypothesis, the number of [formula]-rich r-flats in [formula] is [formula]. The cube Q'∈Ci - 1 contains [formula] points. So [formula] contains (O(n / 2ik))k - r distinct (k - r)-element subsets. For all Q∈Ci, we obtain an upper bound

[formula]

[formula]

After dividing by (m2j - ik)k - r - 1, we sum Inequality ([\ref=eq:T]) over all i, j, and r:

[formula]

[formula]

By contrasting Inequalities ([\ref=eq:fijr]) and ([\ref=eq:tau]), we conclude that |F3| = O(nk + 1 / md + 1). This completes the proof of Lemma [\ref=lem:inc]. [formula]

In any homogeneous point set of size n in [formula], the number of incidences of points and m-rich k-flats is bounded by

[formula]

[formula]

Proof of Theorem [\ref=thm:main]

We are given a homogeneous set P of n points in d-dimensions. We may choose an orthogonal coordinate system such that all coordinates of every point of P are irrational and P lies in the interior of cube C, whose vertices have rational coordinates. This guarantees that for any subdivision of C into congruent subcubes, every point of P lies in the interior of a subcube. Let t denote the maximum number of distinct distances measured from a point of P (including distance 0). There is a constant δd > d such that for any [formula], any hyperplane or sphere intersects the interior of at most δdsd - 1 cubes in the subdivision of C into sd congruent cubes. We subdivide C into sd congruent subcubes [formula], where

[formula]

Let T be a set of triples (p,q,c)∈P3 such that

p  ≠  q,

p and q lie in the same subcube Ci for some 1  ≤  i  ≤  sd,

p and q are equidistant from c.

All points are located on nt spheres centered at the n points of P. The cubes Ci, 1  ≤  i  ≤  sd, subdivide each sphere into patches. Since every sphere intersects at most δdsd - 1 subcubes Ci, there are at most δdntsd - 1 = n2 / 4 patches, where each patch lies entirely in a subcube Ci. There are n2 sphere-point incidences. The average number of points on a patch is at least 4. If x points lie on a sphere patch centered at c, then this patch contributes [formula] triples (p,q,c) to T. We conclude that the number of triples is |T|  ≥  Ω(n2).

For every [formula], let Tm denote the set of triples (p,q,c)∈T such that the bisector hyperplane of the segment pq is incident to at least m but less then 2m points of P. Since every bisector plane is incident to less than n points, we can partition T into log n subsets

[formula]

There is a value m = 2j for some 0  ≤  j  ≤   log n, such that |Tm|  ≥  |T| /  log n  ≥  Ω(n2  /   log n).

For a pair (p,q)∈P2, p  ≠  q, all points of the set M(p,q) = {c∈P:dist(p,c)  =  dist(q,c)} lie on the bisector hyperplane of the line segment pq. Every bisector hyperplane intersects at most δdsd - 1 subcubes, and in each subcube Ci it can bisect at most [formula] point pairs. So the number of pairs (p,q)∈P2 bisected by the same hyperplane is at most

[formula]

Let Bm denote the set of all bisector hyperplanes that bisect the pair (p,q) for some (p,q,c)∈Tm. By definition, any hyperplane in Bm is incident to at least m but less than 2m points of P. By Lemma [\ref=lem:inc], we have

[formula]

We can now give an upper bound for |Tm|. In a triple (p,q,c)∈Tm, point c lies on a bisector hyperplane of Bm. Each bisector hyperplane is incident to less than 2m points of P and bisects at most O(n / s) pairs (p,q). Therefore

[formula]

[formula]

[formula]

We obtain another upper bound for |Tm| by the following argument: In a triple (p,q,c)∈Tm, both p and q lie in the same subcube Ci  ⊂  C. There are sd subcubes, and each subcube contains (O(n / sd))2  ≤  O(n2 / s2d) point pairs. Hence, there are at most sd  ·  O(n2 / s2d)  =  O(n2  /  sd) such pairs (p,q). For each pair (p,q), where (p,q,c)∈Tm, there are at most 2m points c∈P on the bisector hyperplane of pq. We conclude that

[formula]

Using the upper bound for m from Inequality ([\ref=eq:plug]), we have

[formula]

[formula]

[formula]

[formula]

as required. This completes the proof of Theorem [\ref=thm:main] [formula]

Proof of Theorem [\ref=thm:3D]

Consider a homogeneous set P of n points in [formula]. Similarly to the previous section, we assume that all coordinates of every point in P are irrational, and the vertices of the bounding cube C have rational coordinates. Let t denote the maximum number of distinct distances measured from a point of P (including distance 0). We subdivide C into s3 congruent cubes [formula], for

[formula]

where γ > 0 is a constant to be specified later.

By Theorem [\ref=thm:Beck], [formula] contains Ω(n2) affine independent point pairs. This implies that there is a subset P0  ⊂  P such that |P0|  ≥  Ω(n) and every c∈P0 is incident to Ω(n) distinct lines spanned by P. For every c∈P0, let [formula] be a set of Ω(n) points such that the lines cp, p∈P(c), are distinct. For every point c∈P0, let Hc be a unit sphere centered at c. For every [formula], we denote by x̂ the projection of x to the unit sphere Hc. Points of P(c) have distinct images in Hc under this projection. The set of images of the projection is denoted by

[formula]

We partition the unit sphere Hc into 6s2 convex spherical regions S1(c), [formula] by 6s - 12 circular arcs: Consider an axis-parallel cube centered at c and subdivide each of its 6 faces into s2 congruent squares, then project these squares to the sphere Hc from c. The volume of each region is Θ(1 / s2) and each region is contained in a disk of volume Θ(1 / s2). Every circle on the sphere Hc intersects at most O(s) regions. We then subdivide [formula] into 6s2 regions Ri(c), [formula], such that

[formula]

For every c∈P0 and [formula], the region Rj(c) contains [formula] points because the region [formula] can be covered by O(n / s2) unit cubes. Note also that every plane incident to c intersects at most O(s) regions Rj(c), since every great circle of S intersects at most O(s) regions Sj. If F is a plane, then [formula] because [formula] can be covered by O(n2 / 3) unit cubes, and [formula].

For every c∈P0, consider the at most t spheres centered at c that contain all points of P(c). Every sphere S centered at c is partitioned into patches by the cubes Ci, 1  ≤  i  ≤  s3, and the regions Rj(c), 1  ≤  j  ≤  6s2. We can partition C into the subcubes Ci, 1  ≤  i  ≤  s3, by 3(s - 1) planes. These planes partition every sphere S along 3(s - 1) circles. Hence every sphere S is partitioned by O(s) circular arcs into O(s2) patches. We partition the points of P lying on a patch into disjoint triples, after deleting at most two points from each patch if necessary. This produces a set Q of quadruples (p,q,r,c)∈P3  ×  P0 such that,

the points p, q, and r are in P(c);

p,q, and r lie on a sphere centered at c;

p,q, and r lie in the same subcube Ci for some 1  ≤  i  ≤  s3;

p,q, and r lie in the same regions Rj(c), for some 1  ≤  j  ≤  6s2;

if (p1,q1,r1,c)∈Q and (p2,q2,r2,c)∈Q, then [formula] [formula].

We give a lower bound on the number of quadruples in Q. Let g(c) denote the number of patches on all O(t) spheres centered at c: We have g(c) = O(ts2)  =  O(n / γ). The average number of points on a patch centered at c is Ω(γn  /  g(c))  =  Ω(γ). We choose the constant γ > 0 such that a patch contains at least 6 points of P(c) on average. If the k-th patch contains a set of points Gk(c)  ⊂  P(c), then Q contains ⌊|Gk(c)| / 3⌋ quadruples (p,q,r,c). We conclude that the total number of quadruples is

[formula]

We define the multiplicity of a pair (p,q)∈P2 as

[formula]

We choose a parameter m to be specified later, and distinguish two types of quadruples in Q: A quadruple (p,q,r,c) is low if at least one edge of the triangle pqr have multiplicity at most m. A quadruple (p,q,r,c) is high if the multiplicity of all three edges of pqr are above m. Let Q- and Q+ denote the sets of low and high quadruples, respectively. We distinguish two cases: First we consider the case that |Q+|  ≤  |Q-|, then we proceed with the case |Q+| > |Q-|.

Case |Q+|  ≤  |Q-|. There are at least Ω(n2) low quadruples in Q. We define a set of triples

[formula]

We have extracted |T| = Ω(n2) triples from Q-. Similarly to the previous section, we compute an upper bound on |T|. Every pair (p,q) from a triple of T lies in one of the s3 subcubes of C, and for every pair (p,q) there are at most m centers c. Therefore, we have an upper bound

[formula]

Comparing this upper bound with the lower bound |T| = Ω(n2), we obtain

[formula]

[formula]

[formula]

Case |Q+| > |Q-|. At least half of the quadruples in Q are high, and so |Q+|  ≥  Ω(n2).

For every c∈P0, project the points of P(c) to the sphere Hc. If (p,q,r,c)∈Q, then the intersection of the bisector plane of pq and Hc is the bisector (great circle) of the segment p̂ in the sphere Hc. A (possibly degenerate) triangle p̂r̂ defines three distinct bisectors. The bisectors of a triangle p̂r̂ meet in two antipodal points on the sphere. The triangles that determine the same triple of bisectors are similar (the center of similarity is the intersection of the bisectors). Specifically, if the triangles [formula] determine the same triple of bisectors, then the points [formula] are collinear (the points [formula] and [formula] are also collinear). Every triple of bisectors determines a family of triangles. We define a family of quadruples to be a collection of quadruples (p,q,r,c)∈Q+ with a common center c such that the triangles p̂r̂ form a family.

For every c∈P0, we define a set of triangles in the sphere Hc by

[formula]

By construction, all these triangles have pairwise disjoint vertex sets. There is a set P1  ⊆  P0 of size Ω(n) such that for every c∈P1, we have |T(c)| = Ω(n) triangles. For a point c∈P1, let Bc denote the set of m-rich planes incident to c. We denote by B̂c the set of intersections of planes in Bc and the unit sphere Hc, which are great circles on Hc. Note that the bisector of every edge p̂ of a triangle of T(c) is in [formula].

For c∈P1, let us consider the partition of the sphere Hc into 6s2 regions Sj(c), 1  ≤  j  ≤  6s2, defined above. Each triangle of T(c) lies entirely in one of the regions. Let us denote by Tj(c) the set of triangles of T(c) in Sj(c) for every [formula]. Since the triangles have disjoint vertex sets, we have [formula]. But [formula], and so there are Ω(s2) indices j such that |Tj(c)| = Ω(n / s2)  =  Ω(t). Vertices of similar triangles lie on three main circles. We have shown that every region Rj(c) contains at most O(n2 / 3 / s)  =  O(n1 / 6t1 / 2) coplanar points. Hence, there are at least Ω(t1 / 2 / n1 / 6) families of triangles in Tj(c). Since each such family determines three distinct bisectors of B̂(c), the triangles in Tj(c) determine

[formula]

distinct bisectors in [formula]. A bisector crosses at most O(s) regions, and so we obtain the same bisector of [formula] from at most O(s) regions. We conclude that the number of bisectors determined by the Ω(n) triangles of T(c) is

[formula]

Each of the Ω(n) points of P1 is incident to Ω(n4 / 9 / t1 / 3) distinct m-rich planes. This gives Ω(n13 / 9 / t1 / 3) incidences on m-rich planes of P. By Corollary [\ref=cor:inc], we have

[formula]

[formula]

[formula]

In both cases, we have derived lower bounds for t in terms of n and m. We choose [formula] such that we obtain the same result in both cases. By comparing Inequalities ([\ref=eq:m1]) and ([\ref=eq:m2]), we have

[formula]

[formula]

The choice m = n17 / 29 establishes Inequality ([\ref=eq:t]) in both cases. This completes the proof. [formula]