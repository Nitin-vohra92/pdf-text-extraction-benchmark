Random walks on hypergroup of conics in finite fields

Mathematics Subject Classifications: 60D05, 11A99.

Keywoords: random walks, hypergroups, finite fields.

Introduction

Throughout this paper, q is an odd prime power, Fq  =  GF(q) is the finite field with q elements, [formula] is the multiplicative group of the non-zero elements of Fq and a,b,c are any three fixed numbers in [formula] such that ab  =  c2.

The weighted-quadrance Qa,b(A1,A2) between the points A1  =  (x1,y1), and A2  =  (x2,y2) is the number

[formula]

For a  =  b  =  1, we have the standard definition of quadrance which is introduced by Wildberger. The important of this notation is developed in [\cite=7].

A weighted-circle Ca,bk(A0) in a finite field Fq with center A0∈Fq  ×  Fq and quadrance k∈Fq is set of all points Xin Fq  ×  Fq such that

[formula]

Note that this notation generalizes those of ellipse and hyperbola in the classical setting and those of circle, quadrola and grammola in Wildberger's setting.

We define Ca,bi the weighted-circle centered at the origin and quadrance i∈Fq. Let Na,bi be the number of solutions of the equation ax2 + by2  =  i in the field Fq. Then Na,bi is the number of points in Ca,bi. Hence, we have a partition of the finite field space F2q into q set of points {Ca,bi}i∈Fq. If we start from O = (0,0), take a random step by translating by an element of Ca,bi, and then take another random step by translating by an element of Ca,bj, the final point will be an element of Ca,bk for some k. Counting over all possible such combinations, there are Nkij ways to reach to a point of Ca,bk by using steps from Ca,bi then Ca,bj randomly. We can write this relation as where Nkij are non-negative integers.

Let [formula] then this relation can be written as distribution form

[formula]

where [formula] and [formula] for any i,j.

We recall the formal definition of (general) hypergroup (see [\cite=6]).

A (finite) general hypergroup is a pair (K,A) where A is a *-algebra with unit c0 over [formula] and [formula] is a subset of A satisfying

K is a basis of A

[formula]

The struture constants [formula] defined by

[formula]

satisfy the conditions

[formula]

K is called hermitian if [formula] for all i, commutative if cicj  =  cjci for all i,j, real if nkij ∈R for all i,j,k, positive if [formula] for all i,j,k and normalized if [formula] for all i,j. A generalized hypergroup which is both positive and normalized will be called a hypergroup. There are board examples and applications of (generalized) hypergroups which can be found in [\cite=6].

In [\cite=3], we studied the random walk over hypergroup of circles (i.e. a  =  b  =  1) in a finite field of prime order p  =  4l  +  3 using comparison of Dirichlet Forms and geometric bound of eigenvalues for Markov chains. In this paper, we will study the random walk over hypergroup of weighted-circles (more general conics) in arbitrary finite field using the coupling method. In Section 2, we will show that the set C  =  {Ca,bi}i∈Fq with the relation [\ref=eq1] is a hypergroup. The structure of this hypergroup will also be given. In Section 3, we will study the random walk over the hypergroup of weighted-circles. The main result of this paper is that the random walk over hypergroup of weighted-circle tends to the stationary distribution in a linear time with respect to the size of the hypergroup.

Hypergroup of weighted-circles

Some Lemmas

Recall that a (multiplicative) character of Fq is a homomorphism from [formula], the multiplicative group of the non-zero elements of Fq, to the multiplicative group of complex numbers with modulus 1. The identically 1 function is the principal character of Fq and is denoted χ0. Since xq  -  1  =  1 for every [formula] we have χq  -  1  =  χ0 for every character χ. A character χ is of order d if χd  =  χ0 and d is the smallest positive integer with this property. By convention, we extend a character χ to the whole of Fq by putting χ(0)  =  0. The quadratic (residue) character is defined by χ(x)  =  x(q  -  1)  /  2. Equivalently, χ is 1 on square, 0 at 0 and -  1 otherwise.

The following lemma give us the number of points in any weighted-circle in F2q.

If [formula] then

[formula]

From Proposition 8.6.1 and Theorem 5 in [\cite=number_theory], we know that

[formula]

But ab  =  c2 so χ(a- 1)χ(b- 1)  =  1. This concludes the proof of the lemma.

The following lemma gives us the number of intersections between any two weighted-circles in F2q.

Let i,j  ≠  0 in Fq and let X,Y be two distinct points in F2q such that Qa,b(X,Y)  =  k  ≠  0. Then [formula] only depends on i,j and k. Precisely, let f(i,j,k)  =  ij  -  (i  -  j  -  k)2 / 4. Then the number of intersection points is pkij, where

[formula]

Suppose that X  =  (m,n) and Y  =  (m  +  x,n  +  y) for some m,n,x,y∈Fq then ax2  +  by2  =  k. Suppose that [formula] where Z  =  (m  +  x  +  u,n  +  y  +  v) for some u,v∈Fq. Then we have au2  +  bv2  =  j and a(x  +  u)2  +  b(y  +  v2)  =  i. This implies that axu  +  byv  =  (i  -  j  -  k) / 2. But we have (axu  +  byv)2  +  (cxv  -  cyu)2  =  (ax2  +  by2)(au2  +  bv2) so

[formula]

If f(i,j,k) is non-square number in Fq then it is clear that there does not exist such x,y,u,v, or pkij  =  0. Otherwise, let α  =  (i  -  j  -  k)  /  2 and f(i,j,k)  =  β2 for [formula] then

[formula]

Solving for (u,v) with respect to (x,y) we have

[formula]

If β  =  0 then we have only one (u,v) for each (x,y), but if β  ≠  0 then we have two pairs (u,v). This implies ([\ref=eq2]), completing the proof.

The first case

Suppose that [formula] (mod 4). From Lemma [\ref=number_points], we have

Since Na,b0 = 1 so Qa,b(X,Y) = 0 if and only if [formula]. Hence for any j∈Fq then Ca,b0Ca,bj = Ca,bj. The following theorem details the coefficients in ([\ref=eq1]).

Suppose that [formula] (mod 4), [formula] and k∈Fq. Then nkij (in ([\ref=eq1])) only depend on f(i,j,k). Precisely, we have

There are there cases.

Suppose that f(i,j,k) is non-square. From Lemma [\ref=khac_khong], for any (x,y) in Ca,bi, there does not exists (u,v) in Ca,bj such that if we go by (x,y) followed by (u,v), the destination is a point in Ca,bk. Hence Nki,j  =  0 and nki,j  =  0.

Suppose that f(i,j,k)  =  0. From Lemma [\ref=khac_khong], for any (x,y) in Ca,bi, there exists a unique (u,v) in Ca,bj such that if we go by (x,y) followed by (u,v), the destination is a point in Ca,bk. Hence Nki,j  =  |Ca,bi|  =  p  +  1 and nki,j  =  1 / (p + 1).

Suppose that f(i,j,k) is square. From Lemma [\ref=khac_khong], for any (x,y) in Ca,bi, there exists two points (u,v) in Ca,bj such that if we go by (x,y) followed by (u,v), the destination is a point in Ca,bk. Hence Nki,j  =  2|Ca,bi|  =  2(p  +  1) and nki,j  =  2 / (p + 1).

This concludes the proof of the theorem.

Now, we show that the set C  =  {Ca,bi}i∈Fq with the relation ([\ref=eq1]) is a hypergroup. It is clear that [formula], and [formula] for any i,j∈Fq. From Theorem [\ref=hyper_3], n0ij  ≠  0 if and only if f(i,j,0)  =    -  (i  -  j)2 / 4 is square. But [formula] (mod 4) so - 1 is not a square in Fq. Hence n0ij  ≠  0 if and only if i  =  j. Let [formula] then C is a hermitian commutative hypergroup (note that, nkij is symmetric with respect to i,j and k so C is commutative).

The second case

Suppose that [formula] (mod 4). From Lemma [\ref=number_points], we have

This case, however, is harder since the null-circle Ca,b0 contains more than one point and the set C  =  {Ca,bi}i∈Fq turns out to be not a (hermitian) hypergroup. To resolve this difficulty, we need to redefine the null-circle Ca,b0. We divide the null-circle into two parts

[formula]

We define [formula]. The following theorem is similar to Theorem [\ref=hyper_3]. The proof of this theorem is omitted as it is lengthly and repeated.

Suppose that [formula] (mod 4) and i,j,k∈Fq.

Suppose that i  =  0. Then

Suppose that [formula].

If [formula] then

If k  =  0 then

If k  =  q then

Suppose that i  =  q.

If [formula] then

If j  =  q then

From Theorem [\ref=hyper_1], it is clearly that n0ij  >  0 if and only if i  =  j. Hence the set C  =  {Ci}i∈F+q with the random walk multiplication is a hermitian commutative hypergroup.

Random walks over hypergroup of conics

Preliminary

In this section, we will consider the random walk by Ca,b1; that is we choose all steps from the weighted-circle Ca,b1. For convenient, we drop the superscripts a,b of weighted-circle and call this random walk C1. This random walk has the Markov kernel C1(Ci,Cj) = nji,1 for all i,j∈Fq (or F+q). In general, at [formula] step we have the relation

[formula]

where [formula] for j∈Fq and [formula] = 1.

Let K be a Markov kernel. The probability π is invariant or stationary for K if πK  =  π. A Markov kernel K is irreducible if for any two states x,y there exists an integer n  =  n(x,y) such that Kn(x,y)  >  0. A state x is called aperiodic if Kn(x,x)  >  0 for all sufficiently large n. If K is irreducible and has an aperiodic state then all states are aperiodic and K is erogodic.

The following definition gives us the total variation distance between two probability measures.

Let μ,ν be two probability measures on the set X. The total variation distance is defined by

[formula]

Ergodic Markov chains are useful algorithmic tools in which, regardless of their initial state, they eventually reach a unique stationary distribution. The following theorem, originally proved by Doeblin, details the essential property of ergodic Markov chains.

Let K be any ergodic Markov kernel on a finite state space X then K admits a unique stationary distribution π such that

[formula]

Let K be a Markov chain on the set X with the stationary distribution π. We define the mixing time τp(ε) as the time until the chain is within variation distance ε to the distribution π, start from the worst initial state. We give a formal definition for this concept.

The mixing time τp(ε) is defined by

[formula]

We can fix ε as any small constant. A popular choice is to set ε  =  1 / 2e. We then boost to arbitrary small variation distance by the following lemma.

([\cite=1]) [formula].

([\cite=1]) Let K be a Markov chain and π be a probability distribtution on X. Suppose that there exists an integer m and a constant c  >  0 such that for all x,y∈X, [formula]. Then [formula] for all integer n and x∈X.

Main results

The first case

Suppose that [formula] (mod 4). We have the following lemma.

If i,j  ≠  0 then there exists k such that nki1,njk1 > 0.

We start from a point in Ci, go a step from C1 then we have [formula] possible steps. From Theorem [\ref=hyper_3], there is no more than 2(q  +  1) steps that can reach the weighted-circle. Thus, we reach at least (q  +  1)2 / 2(q  +  1)  =  (q  +  1) / 2 weighted-circles. Applying the same argument, start from a point in Cl, go a step from C1 then we reach at least (q  +  1) / 2 weighted-circles. Since we have only q weighted-circles, by the pigeonhole principle, there exists a weighted-circle Ck which is reachable from both directions. The Lemma follows.

From Lemma [\ref=support_3], we can show that the random walk C1 is erogodic.

Let [formula] (mod 4) and π be the distribution on the set C  =  {Ci}i∈Fq with π(C0) = 1 / q2 and π(Ci)  =  (q + 1) / q2 for all [formula]. Then

[formula]

for all i,j∈Fq.

There are four cases.

Suppose that i  =  j  =  0. There are |C1|4  =  (q  +  1)4 possible ways to go by 4 steps. We first go by any 2 steps. In the last two, we just go backward then it is clear that we go back to the starting point. Therefore, at least |C1|2  =  (q  +  1)2 ways to go from C0 to C0. It implies that

[formula]

Suppose that i  =  0,j  ≠  0. We have

[formula]

From Lemma [\ref=support_3], for each l  ≠  0 then exists k  ≠  0 such that

[formula]

But nvu1  >  0 then [formula]. Moreover

[formula]

Hence

[formula]

Therefore, we have

[formula]

Suppose that i  ≠  0,j  =  0. Similar as in 2), we have

[formula]

Suppose that i,j  ≠  0. We have

[formula]

Similar as in 2), we have

[formula]

But

[formula]

So we have

[formula]

This concludes the proof of the claim.

From Lemma [\ref=important_3], we can determine the stationary distribution and the rate of convergence of the random walk C1.

Let [formula] (mod 4). Then

[formula]

Furthermore, the rate of convergence (i.e. the mixing time of the random walk) is linear with respect to q.

We create two copies of random walk C1. The first one starts from Ci for fixed i and the second one starts randomly in hypergroup of weighted-circles C with distribution π in Lemma [\ref=important_3]. In step [formula], suppose that we are in the weighted-circle Ct in the first walk and in the weighted-circle Cs in the second walk for some s and t. If t  =  s then in the next step, we choose the step of the second walk which is the same with the first's. Otherwise, let they walk by C1 independently. It is clearly that both random walks have the same Markov kernel C1 and the second one has the distribution π.

Set c  =  1  -  q2(q  -  1) / (q + 1)4. From Lemma [\ref=important_3], we have

[formula]

Applying Lemma [\ref=lap] we have

[formula]

Thus, if (1  -  c)n  <  1 / 2e then

[formula]

and [formula]. But, the inequality

[formula]

is equivalent to

[formula]

This implies that

[formula]

Thus, we can choose

[formula]

This conludes the proof of the theorem.

Note that |C0| = 1,|Ci| = q + 1 for [formula], and the space F2q has q2 points, so the distribution of Cn1 is, in some sense, close to uniform over the space F2q when n tends to infinite. Walking randomly by any Ci with [formula] we have the same results as for C1. In hypergroup language the limiting distribution is the Haar measure on the hypergroup.

The second case

Suppose that [formula] (mod 4). We have the following lemma.

Let [formula] (mod 4) [formula] and π be the distribution on the set C  =  {Ci}i∈F+q with π(C0) = 1 / q2, π(Cq) = (2q - 1) / q2 and π(Ci)  =  (q + 1) / q2 for all [formula]. Then

[formula]

for all i,j∈F+q.

We have

[formula]

For fixed k,h  ≠  0, we want to approximate

[formula]

From Theorem [\ref=hyper_1] , [formula] for all l so

[formula]

Similarly, we also have Pr[formula]. We fix l,t  ≠  1,0,q. By Theorem [\ref=hyper_1], we have

[formula]

Hence

[formula]

But [formula] so

[formula]

Therefore, if k,h  ≠  0 then

[formula]

This implies that

[formula]

Hence

[formula]

But from Theorem [\ref=hyper_1], [formula]. Thus, we have

[formula]

This implies that

[formula]

This concludes the proof of the lemma.

Similarly, from Lemma [\ref=important_1], we can determine the stationary distribution and the rate of convergence of the random walk C1.

Let [formula] (mod 4). Then

[formula]

Furthermore, the rate of convergence (i.e. the mixing time of the random walk) is linear with respect to q.

The proof of this theorem is omitted since it is the same as the proof of Theorem [\ref=rate_3]. Note that, walking randomly by any Ci with [formula] we have the same results as for C1 and the limiting distribution in Theorem [\ref=rate_1] is the Haar measure on the hypergroup.