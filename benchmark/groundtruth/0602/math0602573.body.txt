=4pt

The Forest Metric for Graph Vertices

Introduction

Proximity measures for graph vertices and related algebraic indices have a wide range of applications. These fall into information transmission, organic chemistry, crystallography, integrated circuit design, urban planning, transport networks, social networks, politology, aggregation of preferences, epidemiology, etc. (some references are given in [\cite=weAiT98a]). Let us also mention a few more fields of application, namely, cluster analysis (see, e.g., [\cite=Lenart98]), the theory of parallel computations [\cite=SiSoBi97], and optics [\cite=Lannes]. In all these areas, there is a need in proximity measures different from the classical geodesic distance [\cite=BucHar].

Let G be a weighted multigraph with vertex set [formula] and edge set E(G). Multiple edges are allowed, but loops are not; εpij is the weight of the pth edge between i and j; the weights of all edges are strictly positive.

In [\cite=weAiT97] we proposed the relative forest accessibility measure of vertex proximity. More exactly, this is a one-parametric family of indices: if a parameter α > 0 is chosen, then the matrix [formula] of vertex comparative proximities is given by

[formula]

where I is the identity matrix, [formula] is the Laplacian matrix of the weighted multigraph G (also termed as the Kirchhoff and the admittance matrix):

[formula]

and [formula] is the number of edges with terminal vertices i and j. The matrices [formula] are doubly stochastic, i.e.,

[formula]

and symmetric. The entry qαij can be interpreted as the relative share of the connections between i and j in the totality of all i's connections with the vertices of G. The parameter α determines the proportion of taking into account long and short routes between vertices.

In [\cite=weAiT97] we considered a metric defined by means of the relative forest accessibilities. The distance between vertices i and j of a (weighted) multigraph was defined as q1ii + q1jj  -  q1ij - q1ji. In the present paper, we study two parametric families of forest metrics of a graph. The elements of these families are proportional, but the properties of the families, taken as a whole, are different.

For a given parameter α > 0, the value

[formula]

will be called the forest distance between i and j; the value

[formula]

will be called the adjusted forest distance between i and j.

The fact that these functions are metrics follows from Proposition 1 in [\cite=weAiT97].

The multiplier 1 / 2 in ([\ref=metrad]) ensures the equality of scales for the relative forest accessibilities and the forest distances (see ([\ref=DtauDpi]) and the subsequent remark). If the vertices i and j belong to the same component of G, then Corollary 1 of [\cite=weAiT98a] implies lim α  →    ∞dαij = 0. The asymptotic behavior of the adjusted forest distances is studied below in Section [\ref=secresi]. In Section [\ref=seckt], we demonstrate that the reversed ραij can be used to measure the cumulative weight of connections between i and j.

One of the aims of this paper is to present and interpret formulas for the increments of forest distances and relative forest accessibilities under the basic multigraph transformations. These expressions are very simple and testify to the intrinsic nature of the forest metrics. Also, we will give a stochastic interpretation of the forest metric and establish some connections between the forest and resistance metrics.

Until the beginning of Section [\ref=secresi], α will be a fixed parameter, so a simplified notation such as [formula], [formula], [formula], and Q will be used instead of the complete notation, dαij, ραij, qαij, and Qα, respectively.

Some properties of the forest metric of a graph have been studied in [\cite=weAiT97] and [\cite=Merr98]. It follows from item 5 of Proposition 7 in [\cite=weAiT97] that if the total weight of all edges that have terminal vertices k and t gets an increment of [formula], then, provided that there are no other changes, the increments of the adjusted forest distances in G are

[formula]

Observe that for fixed [formula] and [formula], the increments [formula] are independent of α. Besides that, ([\ref=delra]) implies that the forest distances cannot increase as a result of the addition of a new edge.

The double stochastic property of Q yields the inequalities

[formula]

and, by proposition 5 from [\cite=weAiT97], the equalities in ([\ref=ine1]) and ([\ref=ine2]) are attained if and only if i and j are two isolated vertices.

Corollary 9 of [\cite=Merr97] provides a more accurate upper bound for [formula]:

[formula]

where a(G) is Fiedler's algebraic connectivity of the graph (which is the second minimal eigenvalue of L). Then (1 + αa(G))- 1 is, obviously, the second maximal eigenvalue of Q. Upper bounds for the algebraic connectivity of the graph can be obtained by transforming ([\ref=alco]) (see (14) in [\cite=Merr98]).

The diameter of a graph is the greatest distance between its vertices. This way, ([\ref=ine1]) and ([\ref=alco]) provide upper bounds for the forest diameter of a graph. Other bounds for the forest distances will be given below (equations ([\ref=ine3]) and ([\ref=ine4])).

How forest distances change when connections between vertices strengthen

An expression for the increments of relative forest accessibilities under basic graph transformations was given in [\cite=weAiT97], item 1 of Proposition 7 (see also related results in [\cite=Merr98] [\cite=Merr97] [\cite=So]). Now we formulate this property in a more general form.

We say that a weighted multigraph G' differs from G in a (k,t) edge only if for some [formula] G' can be obtained from G by increasing the weight of some edge εpkt by ε, or by adding a new edge between k and t with weight ε (ε > 0), or by removing an edge between k and t with weight -  ε (ε < 0).

While saying that G' differs from G in one edge only, by [formula] we will denote the weight (or the increment of weight) in the above definition; primed notation will relate G', nonprimed notation will relate G.

Suppose that weighted multigraph G' differs from G in a (k,t) edge only. Then for every i,j∈V(G),

[formula]

The results of this section rely on the following lemma, which follows from ([\ref=delra]) after substituting i = k and j = t.

Let G' differ from G in a (k,t) edge only. Then

[formula]

Proof of Proposition [\ref=prop1] is carried out by the same argument as the proof of item 1 of Proposition 7 in [\cite=weAiT97]. The only necessary addition is that the denominator on the right-hand side of ([\ref=delq]) cannot vanish even with a negative [formula]. Indeed, by Lemma [\ref=lem1], [formula]. As was demonstrated in [\cite=weAiT97], ρ'kt is nonzero (and exists!) at k  ≠  t for every multigraph G, consequently, [formula], therefore, [formula].

The connection of an inverse form between the distance and the increment of weight in ([\ref=DeltaD]) requires some explanation. Note that since [formula] can be arbitrarily large, whereas the distance between k and t should decrease with any increase of [formula], a linear connection between the distance and the [formula] cannot be expected. Taking into account that the equality [formula] is inevitable when [formula] and that additivity of distance increments and reciprocity principle (see below) should also be satisfied, it is difficult to expect for the distance increments a simpler form than ([\ref=DeltaD]). It should be also remarked that the inverse connection between the weight of an edge and its length is the most natural way of extending the geodesic distance to weighted graphs (cf. [\cite=KirNeuSha]).

The distance ([\ref=metrar]) for each pair of vertices generally depends on the graph as a whole, but if [formula] is fixed, then, by Lemma [\ref=lem1], ρ'kt is determined by [formula] only. In particular, for any unweighted multigraph, the addition of a new (k,t) edge yields

[formula]

which implies

[formula]

The form of ([\ref=DeltaD]) and ([\ref=DeltaD1]) suggests the consideration of inverted distances.

Let i and j  ≠  i be distinct vertices of G. The value [formula] will be called the cumulative weight of connections between i and j in G.

By Lemma [\ref=lem1], [formula], and [formula] for unweighted graphs. Successively applying Lemma [\ref=lem1] to all the edges with terminal vertices i and j and using ([\ref=ine2]) along with its equality condition, we obtain the following statement, which justifies the term "cumulative weight of connections."

Suppose that G is an arbitrary weighted multigraph, i and j are distinct vertices of G, and [formula] is the total weight of all edges with terminal vertices i and j. Then 1. [formula] where θ0ij is the cumulative weight of connections between i and j in the multigraph resulting from G by the removal of all edges with terminal vertices i and j. 2. [formula] 3. [formula] if and only if i and j are not connected with the other vertices (but can be connected to each other).

Item 2 of Proposition [\ref=prop1'5] and Definition [\ref=d_sila] provide the following upper bounds for the forest distances:

[formula]

where [formula] is the total weight of the edges with terminal vertices i and j in G. The equality condition is the same as in item 3 of Proposition [\ref=prop1'5].

Comparing the forest distances in two graphs that differ in one edge

In this section, we study how a modification on a (k,t) edge alters the whole profiles of forest distances and relative forest accessibilities. The alteration of the values

[formula]

will be of major interest here.

In particular, we have

[formula]

The simultaneous consideration of forest distances and relative forest accessibilities rises a question: what is the essential difference between them, except for the fact that a shorter distance usually corresponds to a greater accessibility? The main difference is in the very relative nature of the forest accessibility measure: as follows from Proposition 7 in [\cite=weAiT97], no distance can increase after the addition of a new edge, whereas the increments of a relative forest accessibility can have either sign. More specifically, if k is "more accessible" from i than t ([formula]), whereas t is "more accessible" from j than k ([formula]), then the addition of a new edge between k and t increases the accessibility of j from i ([formula]), because the new edge "widens a road" between i and j. Inversely, if from both i and j, k is "more accessible" than t ([formula]), then the addition of a (k,t) edge decreases the relative forest accessibility of j from i ([formula]). Here, the new edge connects i and j with t and with the vertices situated "beyond" t more intensively than this edge connects i with j (recall that the relative forest accessibilities of all vertices from a given vertex sums to 1). The diagonal entries of Q measure the "solitariness" of the vertices (which is substantiated by Theorem 3 in [\cite=Merr98]); no one of them can increase when a new edge is added.

There exists a one-to-one correspondence and a specific duality [\cite=weAiT98] between metrics and Σ-proximities (one of which is relative forest accessibility).

Definitions ([\ref=metrad]), ([\ref=tau]), and ([\ref=pi]) imply simple connections between [formula], [formula], and [formula]:

[formula]

Equation ([\ref=DtauDpi]) can be interpreted as the equality of scales of relative forest accessibilities [formula] and forest distances [formula] (see definitions ([\ref=tau]) and ([\ref=pi])). This equality of scales was attained by putting the coefficient 1/2 in ([\ref=metrad]).

The following statement provides simple expressions for the increments of all forest distances and accessibilities when one edge is altered.

Suppose that G' differs from G in a (k,t) edge only, [formula] and [formula]. Then the following equalities are true for all [formula]

[formula]

where [formula] is the weight of a new edge or the increment of the weight of an existing edge between k and t.

The first equalities in ([\ref=Dprox]) and ([\ref=Ddist]) are proved by the application of Lemma [\ref=lem1] to ([\ref=delq]) and ([\ref=delra]), respectively. The third equality in ([\ref=Ddist]) follows from ([\ref=DtauDpi]). The other connections can be derived by applying the following reciprocity principle:

Reciprocity principle. Suppose that a statement A is true for every pair of multigraphs (G,G') such that G' differs from G in a (k,t) edge only. Suppose that statement A' results from A by replacing all values relating to G with the corresponding values relating to G' and vice versa and interchanging [formula] with [formula]. Then A' is also true for every pair of multigraphs (G,G') such that G' differs from G in a (k,t) edge only.

This principle resembles the oriented duality principle, but its nature is different. The reciprocity principle follows immediately from the following obvious fact: if G' differs from G in a (k,t) edge only, then G also differs from G' in a (k,t) edge only, but with the reversed increment of weight. The reciprocity principle, in spite of its obviousness, can be used to obtain some nonobvious corollaries (for example, the equalities in Proposition [\ref=prop2]).

Let us specify now how the values [formula] [formula] change under the basic transformations of a multigraph.

Let weighted multigraph G' differ from G in a (k,t) edge only. Then for all [formula] the following equations hold:

[formula]

Equation ([\ref=proppi]) is a corollary from Proposition [\ref=prop1] and Lemma [\ref=lem1], but it can be alternatively obtained from the equations in ([\ref=Dprox]) and ([\ref=Ddist]) that are proved by means of reciprocity principle; ([\ref=proptau]) follows, say, from ([\ref=proppi]) and ([\ref=taupi]).

According to ([\ref=proptau]), the difference of distances [formula] reduces as k and t come closer, so as the proportion in ([\ref=proptau]) is preserved, which makes sense; according to ([\ref=proppi]), the same property holds true for the difference of accessibilities.

Observe also that, by ([\ref=proptau])-([\ref=proppi]) and Lemma [\ref=lem1], the ratio

[formula]

is the same for all [formula].

An interpretation of the forest metric

In this section, we give an interpretation of the forest distance between i and j in terms of spanning rooted forests that connect i and j.

Recall that a rooted forest is an acyclic graph with one vertex marked as a root in each its component. The components of a rooted forest are rooted trees.

Every spanning rooted forest of G where i is a root of a tree and j does not belong to this tree will be called an unsuccessful connection from i to j. A successful connection from i to j is a spanning rooted forest of G where j belongs to a tree rooted at i.

By [formula] we denote the weighted multigraph obtained from G by multiplying the weights of its edges by α.

Consider the following model of choosing a random connection.

A stochastic model of connecting vertices i and j. 1. Choose one of the two vertices, i or j, with probability 1 / 2 each. 2. Choose a spanning rooted forest of [formula] at random: the probability of choosing forest F is

[formula]

where [formula] is the set of all spanning rooted forests of [formula] and ε(F') is the weight of the forest F', which is defined as the product of the weights of its edges. 3. If the forest chosen at stage 2 is an unsuccessful connection from the vertex chosen at stage 1 to the remaining vertex of the pair (i,j), then we say that an unsuccessful connection between i and j is chosen.

The following statement is an interpretation of the forest distance between i and j.

The forest distance [formula] is equal to the probability of choosing an unsuccessful connection between i and j in the above model of connecting i and j.

Proposition [\ref=prop4] clarifies the concept of forest metric: two vertices are close to each other if the probability of choosing an unsuccessful connection between them is small; the distance is precisely equal to this probability.

Making use of Theorem 3 in [\cite=weAiT98a], an interpretation of this kind can be formulated for the resistance distance too. Connections between the resistance metric and the forest metrics will be considered in the following section.

Relations between the resistance metric and the forest metrics

According to item 3 of Proposition [\ref=prop1'5], the index [formula] referred to as a cumulative weight of connections between i and j has a rather strange property: if i and j belong to different components of G, but at least one of these vertices is not isolated, then [formula]. Which connections can be associated with such a pair of vertices? The following analysis of relations between the resistance metric and the forest metrics clarifies the point.

The resistance metric can be defined as the function that associates a nonnegative number on the extended real line [formula] with every pair of vertices i,j∈V(G): if i and j belong to different components of G, then [formula]; otherwise

[formula]

where [formula] are the entries of the Moore-Penrose generalized inverse [formula] of the Laplacian matrix L. An electrical interpretation and some properties of the resistance metric can be found in [\cite=KleRan] [\cite=Kle97] [\cite=Bapat99] [\cite=Patti00].

Consider the asymptotic behavior of the forest metrics dα and ρα. As a  →  0, the metric dα tends to the discrete metric:

[formula]

whereas ρα tends to the zero function.

Let [formula] be the vertex set of the component of G that contains vertex i. As has been mentioned in Section 1, if [formula], then [formula] as α  →    ∞  . The behavior of dα and ρα as α  →    ∞   is completely specified by the following statement, which follows from Corollary 1 and Proposition 9 of [\cite=weAiT98a].

The limits d∞ij  =   lim α  →    ∞dαij and ρ∞ij  =   lim α  →    ∞ραij always exist (in the latter case, on the extended real line), and

[formula]

Note that if [formula], then the limit of the cumulative weight of connections [formula] as α  →    ∞   is 0.

Another relationship between the forest metrics and the resistance metric is also interesting.

A weighted multigraph G' will be called the α-extension of the weighted multigraph G if (i) [formula], and (ii) the restriction of E(G') to V(G) coincides with E(G), and the ratio of the corresponding edge weights in G' and in G is α, and (iii) E(G') contains one edge (0,i) of weight 1 for each vertex i∈V(G).

For every weighted multigraph G and every i,j∈V(G), [formula] is true, where G' is the α-extension of G, [formula] is the resistance distance on G', and dαij(G) is the forest distance on G with parameter α.

We are now in position to discuss the above-mentioned property of the cumulative weight index [formula]: this weight can be positive when i and j belong to different components of G; on the other hand, its limit value corresponding to the resistance distance is zero.

The objects modeled by the vertices of the same graph usually have a specific similarity or a common derivation, which causes their a priori relationship. The forest metrics enable one to take such a relationship into account in the model and to control the strength of the a priory connections by the parameter α: an increase of α corresponds to a weakening of a priory connections. From this point of view, considering the value [formula], instead of [formula], as the cumulative weight of connections between i and j makes sense too. In accordance with Proposition [\ref=prop10], it is not additional connections between the objects that represent their a priori relations, but connections with the introduced "hidden source" vertex. This way, the input structure of connections between the objects remains intact.

The introduction of a "hidden source" frequently enables one to obtain simpler proofs for graph-theoretic statements. For instance, the set of spanning rooted forests of any multigraph G can be put into a one-to-one correspondence with the set of spanning trees of the 1-extension of G; the corresponding subgraphs have the same weight. This method makes it possible to reduce some theorems that involve rooted forests to theorems about trees.

In some models, varying the parameter α of α-extension enables one to specify the relative importance of short and long connections in a graph. For instance, this is the case for the linear regression analysis of paired comparisons, where the addition of a "hidden source" corresponds to the turn from the least squares estimates to the ridge estimates of the object effects. The matrix of the system of linear equations corresponding to the ridge estimates is nonsingular as distinct from the matrix of normal equations. In other words, a regularization procedure applied to the ill-posed least squares problem leads to the ridge estimates for the object effects. It turns out that ridge estimates are more adequate in some cases than the least squares estimates of the object effects in paired comparisons [\cite=Cheb94]. These ridge estimates can be represented via relative forest accessibilities [\cite=Sham94].

The simple facts and relationships presented in this paper contribute to the analysis of the resistance and forest metrics and provide some framework for the comparison of various graph metrics.