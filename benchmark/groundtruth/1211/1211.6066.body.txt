Long Cycle Factorizations : Bijective Computation in the General Case

Abstract.

This paper is devoted to the computation of the number of ordered factorizations of a long cycle in the symmetric group where the number of factors is arbitrary and the cycle structure of the factors is given. Jackson (1988) derived the first closed form expression for the generating series of these numbers using the theory of the irreducible characters of the symmetric group. Thanks to a direct bijection we compute a similar formula and provide the first purely combinatorial evaluation of these generating series.

Introduction

For integer n we note Sn the symmetric group on n elements and γn the permutation in Sn defined by [formula]. If r is an integer we call strictly increasing subsequence of [formula] any sequence of the form [formula] where [formula]. Given such a subsequence t containing i, we define succt(i) the index following i in t. If no such index exists succt(i) is the first index of the sequence or i itself if t = (i). This paper is devoted to the computation of the numbers [formula] of factorizations of γn as an ordered product of permutations [formula] such that for 1  ≤  i  ≤  r, αi belongs to Sn and is composed of exactly pi disjoint cycles. More precisely, we use a direct bijection to show the following formula:

[formula]

The last sum runs over sequences [formula] of 2r - 1 non-negative integers at with the index t being any non empty strictly increasing subsequence of integers of [formula] such that

[formula]

Furthermore, the multinomial coefficient is defined by

[formula]

Finally, [formula] is the determinant of the r  ×  r matrix with coefficients mi,j, 1  ≤  i,j  ≤  r, where

mi,i  =  pi (1  ≤  i  ≤  r), [formula] (1  ≤  i  ≤  r - 1), [formula], for j  ≠  i + 1 (modulo r), [formula]

(the subtractions on indices are modulo r).

Let [formula] an integer partition of n with [formula] parts sorted in decreasing order. We note Cλ the conjugacy class of Sn containing the permutations of cycle type λ and [formula] and [formula] the monomial and power sum symmetric functions respectively indexed by λ on indeterminate [formula]. Given r integer partitions [formula] of n, a more refined problem is to compute the numbers [formula] of ordered factorizations [formula] of γn such that for for 1  ≤  i  ≤  r, αi belongs to Cλi. As a corollary of Theorem [\ref=thm_:_main] we have:

[formula]

where [formula] is substituted to pi in the definition of [formula] in ([\ref=condmain]).

Background

Despite the attention the problem received over the past twenty years no closed formulas are known for the coefficients [formula] and [formula] except for very special cases. Using characters of the symmetric group and a combinatorial development, Goupil and Schaeffer [\cite=GS] derived an expression for knλ1,λ2 (r = 2) as a sum of positive terms. This work has been later generalized by Poulalhon and Schaeffer [\cite=PS] and Irving [\cite=JI] but, as a rule, the formulas obtained are rather complicated. Using the theory of the irreducible characters of the symmetric group, Jackson [\cite=DMJ] computed an elegant expression for the generating series in the LHS of ([\ref=eqmain]) for arbitrary r and an arbitrary permutation of Sn instead of γn. This later result shows that the coefficients in the expansion of this generating series in the basis of [formula] can be derived as closed form formulas but fails to provide a combinatorial interpretation. Schaeffer and Vassilieva in [\cite=SV], Vassilieva in [\cite=V] and Morales and Vassilieva in [\cite=MV] provided the first purely bijective computations of the generating series in ([\ref=eqmain]) and ([\ref=eqcorr]) for r = 2,3. In a recent paper, Bernardi and Morales [\cite=BM] addressed the problem of finding a general combinatorial proof of Jackson's formula for the factorizations of γn. Using an argument based on several successive bijections and a probabilistic puzzle, they provide a complete proof for the cases r = 2,3 and a sketch for r = 4. In the present paper we generalize and put together all the ideas developed in our previous articles ([\cite=SV], [\cite=V] and [\cite=MV]) and make them work in the general context of r-factorizations of γn. We prove theorems ([\ref=thm_:_main]) and ([\ref=thm_:_corro]) thanks to a direct (single step) bijection. The combinatorial ingredients we use and the bijection itself are described in sections [\ref=secing] and [\ref=secbij]. Section ([\ref=secproof]) proves that the bijection is indeed one-to-one. While ([\ref=eqmain]) is similar to Jackson's formula in [\cite=DMJ], the two expressions are different. We address their equivalence in section [\ref=seceq].

Cacti, partitioned cacti and cactus trees

Cacti

Factorizations of γn can be represented as r-cacti (short cacti), i.e 2 - cell decompositions of an oriented surface of arbitrary genus into a finite number of vertices (0 - cells), edges (1 - cells) and faces (2 - cells) homeomorphic to open discs, with n black and one white face such that all the black faces are r-gons and not adjacent to each other. They are defined up to an homeomorphism of the surface that preserves its orientation, the type of cells and incidences in the graph. We consider rooted cacti, i.e. cacti with a marked black face. We assume as well that within each r-gon the r vertices are colored with r distinct colors so that moving around the r-gons counter-clockwise the vertex of color i + 1 (modulo r) follows the vertex of color i. Each black r-gon is labeled with an index in [formula] such that the marked r-gon is labeled 1 and that moving around the white face starting from the edge linking the vertex of color 1 and the vertex of color r in this marked r-gon, the i-th edge connecting a vertex of color 1 and a vertex of color r belongs to the black r-gon of index i.

Cacti as defined above are in bijection with r-tuples of permutations [formula] such that [formula]. Each vertex of color i corresponds to a cycle of αi defined by the sequence of the indices of the r-gons incident to this vertex.

As a consequence, r-cacti with pi vertices of color i are counted by [formula].

Alternatively, a cactus can be seen as a set of n r-tuples of integers such that each integer of [formula] is used exactly once in the i-th positions of the r-tuples (1  ≤  i  ≤  r). Moving around the white face of the cactus according to the surface orientation and starting with the edge linking the vertices of color 1 and r of the root r-gon, we define a labeling of the edges. We assign label i to the i-th edge linking vertices of color 1 and r during the traversal. The j-th edge linking vertices of color r and r - 1 during the same traversal is indexed by j and so on for all the colors. The n r-tuples defined by the edge labeling of the n r-gons is an equivalent description of the initial cactus.

One can show that if the label of an r-gon of a cacti described by [formula] is i then the index (as defined in Remark [\ref=remcac]) of the edge linking the vertices of color l and l - 1 is [formula] for 2  ≤  l  ≤  r and i for l = 1.

Partitioned cacti

Cacti are non planar non recursive objects intractable to compute directly in the general case. Our bijective construction relies on the use of partitioned cacti that we define as follows:

Let [formula] be the set of couples composed of a cactus (as defined in Section [\ref=subseccacti]) and a r-tuple of partitions [formula] such that i is a partition with pi blocks on the set of vertices of color i.

Using Proposition [\ref=propcac], we state that partitioned cacti in [formula] are in bijection with the 2r-tuples [formula] where [formula] and πi is a partition on the set of integers 1..n composed of exactly pi blocks stable by αi. (As such the blocks of πi are unions of cycles of αi). Two vertices u and v of color i in the partitioned cactus belong to the same block if and only if the corresponding cycles of αi belong to the same block of πi.

Similarly to [\cite=V], the numbers [formula] and the cardinalities [formula] are linked by the relation:

[formula]

where [formula]. Partitioned cacti are actually one-to-one with decorated recursive tree structures that we define in the next section.

Cactus trees

We look at non classical tree-like structures with colored vertices and various types of children. More specifically we work with recursive non cyclic graphs rooted in a given vertex such that all the vertices are colored with [formula]. The ordered set of children of a given vertex v of color i may contain:

half edges (later called 1-gons) linking v to no other vertex.

full edges (later called 2-gons) linking v to a vertex of color i + 1 (modulo r). This later vertex is the root of a descending subtree.

j-gons linking v to j - 1 vertices [formula] of respective colors [formula] (modulo r). Each vk is the root of a descending subtree. When the size j of the j-gons is not determined, we simply call them polygons.

Now we are ready to give the full definition of the considered structure:

For any sequence [formula] of 2r - 1 non-negative integers at whith the index t being any non empty strictly increasing subsequence of integers of [formula], we define the set [formula] of cactus trees with vertices of r distinct colors as follows:

the root vertex of the cactus tree is of color 1,

the ordered set of children of a given vertex v of color i is composed of j-gons (1  ≤  j  ≤  r) linking v to j - 1 vertices (and subsequent subtrees) of respective colors [formula] (modulo r),

symbolic labels [formula] (where [formula]) are assigned to the polygons such that the set of polygons indexed with the same given label contains exactly one vertex of each color and that all the polygons in the tree are labelled,

for [formula] ([formula]), at is the number of those sets composed of a (i2 - i1)-gon child of a vertex of color i1, a (i3 - i2)-gon child of a vertex of color i2, [formula], a (il - il - 1)-gon child of a vertex of color il - 1 and a (r - il + i1)-gon child of a vertex of color il with the same symbolic label. (One can easily check that exactly one vertex of each color is contained in such sets.)

Point (iii) in Definition [\ref=defct] restricts the number of possible cactus trees. In this paper, we consider only the cactus trees for which such a labeling is possible.

If we note pi the number of vertices of color i (1  ≤  i  ≤  r) in a given cactus tree of [formula], we have [formula] for 2  ≤  l  ≤  r and [formula].

Let [formula], n, (pi)1  ≤  i  ≤  r be such that [formula] and [formula]. The number [formula] of cactus trees is given by:

[formula]

The proof of Proposition [\ref=cardcactree] can be obtained by using the Lagrange theorem in order to compute the number of cactus trees without the labeling and the 1-gons. Then, counting the number of ways to add the 1-gons and the symbolic labeling leads to the desired result. Combining Equations ([\ref=eqmain]), ([\ref=eqlink]) and ([\ref=eqct]), we notice that Theorem [\ref=thm_:_main] is equivalent to the following statement:

The set of partitioned cacti [formula] is in bijection with the union of sets of cactus trees [formula] with [formula] verifying the properties [formula] and [formula].

According to the symmetry property proved in [\cite=BM], Theorem [\ref=thm_:_corro] is implied by Theorem [\ref=thm_:_main]. As a result, Theorem [\ref=thm_:_corro] is also a consequence of Theorem [\ref=thm_:_equiv].

Bijection between partitioned cacti and cactus trees

We start with a partitioned cactus κ of [formula]. The edges of the black r-gons in κ are labeled according to Remark [\ref=remcac]. We note [formula] the partitions of the vertices in κ. Moreover, let [formula] be the 2r-tuple corresponding to κ within the bijection described in Remark [\ref=rempartcac]. We proceed with the following construction. First, we define a set containing pi tree-vertices (not to be confused with the vertices of κ) of color i (1  ≤  i  ≤  r) with an ordered set of children composed of labeled half edges. Each tree-vertex of color i is associated to a block of i (or equivalently πi). The children are indexed by the labels of the edges linking a vertex of color i belonging to the considered block of i in κ and a vertex of color i - 1 (modulo r) sorted in ascending order. We assume that for all tree-vertices, the resulting labels of the half edges are increasing when we traverse them from left to right. Then, we look at maximum length sequences of labels mi, mi + 1, [formula], mi + l (indices are taken modulo r) such that :

mt is the greatest label (and therefore the rightmost) of a half edge child of a tree-vertex of color t and

mt's for i  ≤  t  ≤  i + l are also the respective labels of the edges linking the vertices of color t and t - 1 in the same r-gon of κ. If such a sequence contains a label m1, maximum index around the tree-vertex of color 1 that is also parent of a half edge labeled by 1, we split the sequence into two subsequences mi, [formula], mr and m2, [formula], mi + l. If the initial sequence was the singleton m1, we simply remove it.

The maximum length of the sequences defined above is r - 1.

Next we build a cactus tree by connecting the tree-vertices using j-gons (j  ≥  2). The tree-vertex of color 1 connected to the half-edge labeled 1 is the root of the cactus tree. For any sequence mi, mi + 1, [formula], mi + l corresponding to the same r-gon in κ, let t be the label of the edge linking the vertex of colors i - 1 and i - 2 in this r-gon. By definition, t is not the maximum label around a tree-vertex of color i - 1. We connect the tree-vertices with maximum child labels mi, mi + 1, [formula], mi + l thanks to a l + 2-gon. We substitute this l + 2-gon to the half edge labeled t in the children set of the corresponding tree-vertex of color i - 1. We assign the labels mi, mi + 1, [formula], mi + l, t to it so that the edge linking the tree-vertices of colors i and i - 1 is labeled mi, the edge linking the tree-vertices of colors i + 1 and i is labeled mi + 1, and so on, the edge linking the tree-vertices of colors i + l and i + l - 1 is labeled mi + l and the edge linking the tree-vertices of colors i + l and i - 1 is labeled t. In what follows, we use the term u- color numeric label of the considered l + 2-gon for mu (i  ≤  u  ≤  i + l) and i - 1- color numeric label for t. Finally, we allocate a symbolic label from [formula] to each polygon and each of the remaining half edges (1-gons) such that all the j-gons (1  ≤  j  ≤  r) with numeric labels corresponding to the same r-gon of κ have the same symbolic label. At this stage, we remove all the numeric labels.

The construction above defines a cactus tree τ in [formula] for some [formula] verifying the properties [formula] and [formula].

Proof of the bijection

Injectivity

Assume τ is a cactus tree of [formula] obtained by the construction of Section [\ref=secbij]. We show that at most one 2r-tuple [formula] (or equivalently at most one partitioned cactus) is mapped to τ. To this purpose we show by induction that the numeric labels removed at the end of the procedure can be uniquely recovered. First step is to notice that 1 is necessarily (one of) the numeric label(s) of the leftmost child of the root of τ (of color 1). Now assume that the u-color (resp. 1-color) numeric labels [formula] (resp. [formula]) have been recovered for [formula] and i < n.

Let β be the symbolic label of the polygon in τ with recovered numeric 1-color label i (this polygon is by assumption connected to a vertex of color 1). Then, β is also the symbolic label of exactly one polygon (possibly the one with recovered numeric 1-color label i) connected to a vertex v of color r. But as noticed in Lemma [\ref=lemcac], if the 1-color numeric label is i, the r-color numeric label corresponding to the same r-gon in the initial partitioned cactus is α- 1r(i). As a result, α- 1r(i) is the numeric r-color label of the polygon connected to v. The blocks of πr are stable by αr so αr(i) belongs to the same block of πr. According to the order of the r-color labels around v, i = α- 1rαr(i) is necessarily the r-color numeric label of the leftmost polygon connected to v with non recovered r-color label.

Assume that we have recovered the polygon with u-color label i (2  <  u). The index of the corresponding black r-gon in the partitioned cactus is necessarily [formula]. Integers [formula] and [formula] belong to the same block of πu - 1. As the (u - 1)-color labels have been sorted according to [formula] around the vertices of color (u - 1), i is necessarily the (u - 1)-color numeric label of the leftmost polygon (for which such a label has not been recovered yet) around the vertex of color u - 1 incident to the polygon with the same symbolic label as the one incident to the polygon of u-color label i.

Finally assume that we have recovered the polygon with 2-color label i. The index of the corresponding black r-gon in the partitioned cactus is necessarily [formula]. We use the symbolic label to identify the vertex v of color 1 incident to the polygon of 1-color label [formula]. With a similar argument as above [formula] is necessarily the 1-color label of the leftmost polygon (with no recovered 1-color numeric label) incident to v.

The knowledge of τ uniquely determines the numeric labels of the polygons. But it is easy to see that combining symbolic and numeric labels uniquely determines [formula] and the αi themselves. Then the knowledge of the numeric labels around the same vertices of τ uniquely determines the partitions [formula]. As a result, the partitioned cactus is uniquely determined.

Surjectivity

We show that the reconstruction procedure defined in Section [\ref=secinj] always ends with a valid output. The procedure would be interrupted before the full recovery of the numeric labels if and only if no leftmost polygon around a vertex v of color i with non recovered i-color numeric label is available. Two cases are to be considered.

If v is not the root, this situation is clearly impossible. If the number of polygons incident to v is c, we traverse exactly c times the vertex v to allocate i-color labels (the symbolic labels link the polygons around v to exactly c polygons incident to vertices of color i + 1).

If v is the root, then an additional difficulty occurs as 1-color label 1 is recovered out of the main procedure. However for any vertex u of color j + 1 in the cactus tree, the rightmost polygon connecting it to a vertex w of color j is obviously the last one to be recovered. The symbolic label of this polygon naturally links u and w. As a result, all the j-color labels of w are recovered necessarily after all the j + 1 - labels are recovered around u. This extends to all the children of w and the vertex of color j + 1 in the rightmost polygon of w if any. Since v is the root all the 1-color labels of v are recovered necessarily after all the labels of all the other vertices in the cactus tree are recovered. Finally the procedure ends in the proper way.

Equivalence of the main theorem and Jackson's formula

A natural question is the equivalence between the formula of Theorem [\ref=thm_:_main] and Jackson's formula of [\cite=DMJ] addressing the factorizations of γn. The result of Jackson for the factorizations of the long cycle can be stated as follows:

[formula]

where φ is the mapping defined by [formula] and extended linearly. One can show that this formula is equivalent to:

[formula]

where the sequences [formula] of 2r - 1 non-negative integers (at) satisfy [formula]. For r = 2 the equivalence is obvious as in Equation ([\ref=eqmain]) the only sequence [formula] fitting the conditions is a1  =  p2, a2  =  p1 - 1, a1,2  =  n + 1 - p1 - p2 and [formula] in this case. The summand for indices p1 and p2 in our formula reads

[formula]

This shows that the two results are identical in this case. For r = 3, the determinant is [formula]. For given p1, p2 and p3 the equivalence between the two formulas can be shown in two steps. First we have:

[formula]

Then summing over a1, a2, a3 with the proper shifts of variable to get the same multinomial coefficient brings us to

[formula]

that proves the equivalence of the two formulas also in the case r = 3.