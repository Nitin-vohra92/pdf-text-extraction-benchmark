Hypergeometric solution to a gambler's ruin problem with a nonzero halting probability

Department of Physics, Faculty of Science and Engineering, Chuo University, Kasuga, Bunkyo, Tokyo 112-8551, Japan

E-mail:

PACS numbers: 05.40.Fb, 02.50.-r

Keywords: first-passage problem; gambler's ruin; hypergeometric function; asymptotic analysis

Introduction

The gambler's ruin problem is a classical subject of probability theory. Consider a random walker on a one-dimensional lattice hopping to the right with probability p→ and left with p←( = 1 - p→) in a single time step. The problem seeks statistical properties of duration Tx, the time at which the walker from x first hits the origin. (Of course, Tx is a random variable.) Not only a model of bankruptcy [\cite=Scott] and gambling [\cite=Maitra], but queuing theory [\cite=Keilson] and genetic algorithm [\cite=Harik] are concerned with the gambler's ruin problem.

A standard textbook of probability theory [\cite=Feller] gives detailed instructions on this problem. The central quantity is the probability P̃(x,t) that the walker at position x first hits the origin after time t. As the solution of the equation P̃(x,t + 1) = p→P̃(x + 1,t) + p←P̃(x - 1,t) with initial and boundary conditions P̃(0,0) = 1 and P̃(x,0) = P̃(0,t) = 0 ([formula]),

[formula]

The coefficient before p(t - x) / 2→p(t + x) / 2← is the number of different paths from x hitting the origin first at time t, and it is connected with the reflection principle of a random walk [\cite=Stanton]. Obviously, P̃(x,t) = 0 holds when t < x, because [formula].

In statistical physics, a similar problem is called the first passage problem [\cite=Redner]. This is a more general problem than the ruin problem, in that the state space of a random walker (or a diffusion particle) is not necessarily a one-dimensional lattice but higher-dimensional spaces and networks. Many fields in statistical physics, including reaction-rate theory [\cite=Hanggi], neuron dynamics [\cite=Verechtchaguina], and economic analysis [\cite=Sazuka], have been formulated and analyzed based on first-passage properties.

The present paper analyzes an extended form of the classical ruin problem; a random walker hops to the right with probability p→, to the left with p←, and it does not hop with probability p0 = 1 - p→ - p←. Figure [\ref=fig1] schematically shows the problem. The only difference from the original ruin problem is that the halting probability p0 is introduced. The difference seems very small, but the results become quite distinct. In fact, the solution [\eqref=eq:classic] of non halting case (p0 = 0) is superseded by a formula involving a Gauss hypergeometric function in halting case [formula]. Moreover, moment analysis and asymptotic (long-time) behavior are developed.

Hypergeometric solution

As in the classical problem described in the previous section, let P(x,t) be the probability that the walker starting from x has duration Tx = t. P(x,t) satisfies the equation P(x,t + 1) = p→P(x + 1,t) + p←P(x - 1,t) + p0P(x,t) with initial and boundary conditions P(0,0) = 1 and P(x,0) = P(0,t) = 0 ([formula]). However, it is hard to solve this equation directly, and we take an another way by employing a classical result [\eqref=eq:classic] effectively.

To calculate P(x,t), we classify the walker's paths according to the number of hopping. We count the paths consisting of j hops and t - j halts. First, the different patterns of putting t - j halts into t steps are given by [formula] in total, where 't - 1' (not t) comes from the fact that a halting step never comes to the last t-th step. Next, if we focus on only the hopping steps (and ignore the halting steps), the paths are reduced to those of classical ruin problem; the probability that the walker from x hits the origin after j hops is given by P̃(x,j). Thus the total occurring probability of a path with j hops and t - j halts is

[formula]

Summing up all j, we get

[formula]

In the third equality, the range of summation is changed; the terms corresponding to j > t have no contribution because [formula]. In the last equality we change the summation variable as j = x + 2k. This result can be also obtained by solving directly the equation P(x,t + 1) = p→P(x + 1,t) + p←P(x - 1,t) + p0P(x,t) with conditions P(0,0) = 1, and P(x,0) = P(0,t) = 0 ([formula], [formula]).

We further proceed with calculation; we rewrite factorials using gamma functions, which is a preparatory step toward a hypergeometric function. Employing some formulas of the gamma function, one obtains

[formula]

(See Appendix [\ref=apdx:A] for the calculation in detail.) The probability P(x,t) is expressed as

[formula]

where F(α,β;γ;z) is the Gauss hypergeometric function. This is an explicit form of the solution of our problem. This solution cannot be deduced from the non-halting solution [\eqref=eq:classic]. The hypergeometric function in Eq. [\eqref=eq:solution] is a genuine hypergeometric function, in the sense that it cannot be expressed using simpler functions. (It has been studied that some hypergeometric functions have tractable expressions, e.g., F(1 / 2,1;3 / 2; - z2) = z- 1 arctan z. [\cite=Abramowitz])

We comment here on the convergence of the sum in Eq. [\eqref=eq:solution]--at first sight, it seems to diverge when [formula]. By using the Pochhammer symbol [formula] instead of gamma functions,

[formula]

If x > t, P(x,t) = 0 holds automatically because 1 / (t - x)! = 0. On the other hand, if x  ≤  t, either [formula] or [formula] becomes zero for [formula]. (More precisely, the former becomes zero when x and t are of same parity, and the latter becomes zero otherwise.) The sum consists of a finite number of terms in reality, so one does not need to worry about the convergence.

The exact solution [\eqref=eq:solution] is difficult to understand intuitively. We show numerical evaluation of P(x,t) in Fig. [\ref=fig2]. The initial position of the walker is fixed as x = 50. We separate graphs according to the parameter [formula]; the panels (a), (b), and (c) respectively correspond to [formula], 0.1, and 0. ([formula] is a key parameter for the average duration, as discussed in the following section.) P(x,t) is a unimodal function of t for each parameter value. Power-law behavior [formula] is suggested in large t when [formula] (see (d)), which is further discussed in Sec. [\ref=sec:asymptotic].

Analysis of moment

In order to see properties of the random variable Tx, moment analysis is developed in this section.

First, we calculate the moment generating function of Tx, defined as

[formula]

Calculation process is summarized in Appendix [\ref=apdx:B], and the result is

[formula]

Mx(s) contains no special functions, so this is simpler than P(x,t) of Eq. [\eqref=eq:solution]. Remarkably, Mx(s) is described by elementary functions, though its definition [\eqref=eq:definitionM] is an infinite sum of which each term contains a genuine hypergeometric function Remarkably, Mx(s) contains no special functions, though the infinite summation in Eq. [\eqref=eq:definitionM] involves a genuine hypergeometric function via P(x,t).

Repeatedly differentiating Mx(s) and putting s = 0, we have the first and second moments of the duration Tx as

[formula]

The average and the other moments remain finite when p← > p→, and they diverge to infinity as [formula]. The variance of Tx is given by

[formula]

We can give a plain explanation for the average 〈Tx〉. The walker moves to the left by a length [formula] on average in a single hop. In other words, [formula] is a mean velocity of the walker toward the origin. Hence, it takes [formula] time steps on average to reach the origin.

The moment generating function [\eqref=eq:momentgenerating] looks too complicated to calculate higher moments by differentiation. Alternatively, we provide another calculation method for moments of the duration Tx.

We start from the difference equation for P(x,t):

[formula]

Multiply t and take summation for t to get

[formula]

The left-hand side can be expressed as

[formula]

The last equality uses [formula], which means that a random walker surely hits the origin. (This normalization breaks if p← < p→--see the discussion of total probability of ruin in Sec. [\ref=sec:discussion] in more detail.) We have a difference equation

[formula]

A particular solution is given by 〈Tx〉 = x / (p← - p→), and the characteristic equation p→λ2 - (p→ + p←)λ + p← = 0 admits the two roots 1 and p← / p→. Thus, the general solution is

[formula]

which has two constants A and B. In a limiting case [formula], the problem is still well-defined, and 〈Tx〉 should be finite, so B = 0. Also, it is obvious that 〈T0〉 = 0, so A = 0. The appropriate solution is therefore

[formula]

Next we calculate the second moment. Multiplying t2 and taking summation, we derive a difference equation

[formula]

where we use t2 = (t + 1)2 - 2(t + 1) + 1 for the calculation on the left-hand side. We assume a particular solution in the form 〈T2x〉 = C2x2 + C1x, and determine two constants as

[formula]

The second moment is

[formula]

The homogeneous-solution part vanishes for the same reason as the average.

In short, this 'bottom-up' method calculates higher moments inductively, and generally 〈Tkx〉 becomes a polynomial of degree k. For instance, the third moment is calculated as

[formula]

Asymptotic behavior

We look at long-time behavior of P(x,t) in this section. In particular, we confirm the power-law behavior [formula] mentioned in Sec. [\ref=sec:2] when p→ = p← (see Fig. [\ref=fig2] (d) for reference).

A summation and factorial, as well as a hypergeometric function, are not suitable to study limiting behavior, so we first reexpress the probability P(x,t) into a tractable form. (It may also be possible to estimate factorials directly by Stirling's formula.) According to Ref. [\cite=Feller], the solution [\eqref=eq:classic] of the classic ruin problem has another expression

[formula]

This form is convenient in that one does not need to care about the parities of x and t. In fact, the integral holds the information of parities:

[formula]

In Appendix [\ref=apdx:C] we prove this formula. Applying Eq. [\eqref=eq:integralclassic] to Eq. [\eqref=eq:P], we have the integral form of the probability P(x,t):

[formula]

Here we estimate the integral

[formula]

where the integral variable is changed as ν  =  πtφ in the second equality. For large t,

[formula]

Hence the integrand is a rapidly decreasing function of ν, and we can extend the upper limit of the integration to infinity. Together with the approximation sin (ν / t)≃ν / t, we can carry out the integration as

[formula]

Therefore, the asymptotic form is expressed as

[formula]

By the arithmetic mean-geometric mean inequality, we note

[formula]

with equality holding if and only if p→ = p← (or [formula] by the notation in Sec. [\ref=sec:2]). Thus, the long-time behavior of P(x,t) is completely different according to whether [formula] equals zero or not.

If [formula] (i.e., [formula]), [formula], and hence P(x,t) asymptotically exhibits exponential decay due to [formula].

If [formula] (i.e., p→ = p← = :p), a power law with exponent - 3 / 2

[formula]

is concluded (recall Fig. [\ref=fig2] (d)).

Concluding remarks and discussions

In the present paper, we have solved a gambler's ruin problem where a random walker hops to the right with probability p→, left with p←, and does not hop with p0. We have calculated exactly the probability P(x,t) that the walker starting from position x has duration Tx = t. The average and higher moments of Tx are calculated in two ways: by the moment generating function, and by the bottom-up calculation. The asymptotic form of P(x,t) is derived, and a power law P(x,t)  ~  t- 3 / 2 is obtained when p→ = p←.

We make a brief discussion on the continuum limit, which is an appropriate scaling limit where the step width and time interval of the walker tend to zero. Let the step width be δ and time interval be ε, and position and time are scaled as ξ  =  δx and τ  =  εt. In the continuum limit we take [formula], together with

[formula]

are both kept finite. v is the mean displacement per time unit, and D is the diffusioin coefficient corresponding to a non-halting (or formally called a simple) random walk. The probability density function

[formula]

is suitable in the continuum limit, rather than the probability distribution P(x,t). ('lim ' represents the continuum limit.) Carrying out calculation similar to that in Ref. [\cite=Feller],

[formula]

is obtained. The probability density ρ is called the inverse Gaussian distribution [\cite=Tweedie]. In the continuum limit, the halting effect p0 is reflected only upon the diffusion coefficient as (1 - p0)D. Comparing P(x,t) of a discrete problem in Eq. [\eqref=eq:solution] and above ρ(ξ,τ) of a continuum limit, we conclude that the discrete random walk is far more difficult than the continuous diffusion, and that the results about the discrete random walk in this paper cannot be attained from continuous diffuision problem.

Combining Eqs. [\eqref=eq:solution], [\eqref=eq:definitionM], and [\eqref=eq:momentgenerating], we get

[formula]

We have not used the condition p→ + p← + p0 = 1 in the derivation of Eqs. [\eqref=eq:solution] and [\eqref=eq:momentgenerating], so p→, p←, and p0 can take any value independently. Set p→ = z / 4 and p← = p0 = 1,

[formula]

Furthermore, set s =  -  ln 2 (i.e., e- s = 2),

[formula]

These formulas are nontrivial, but the author cannot tell whether they are useful in practice. We stress that an infinite series of which each term involves a genuine hypergeometric function is hardly known.

We comment on the total probability of ruin. For the discrete problem, putting s = 0 the moment generating function Mx(s),

[formula]

If p← > p→, the gambler surely comes to ruin, but If p← < p→, the gambler can manage to avoid running out of the bankroll with nonzero probability.

The equation P(x,t + 1) = p→P(x + 1,t) + p←P(x - 1,t) + p0P(x,t) describes a traffic jam, where P(x,t) stands for the probability distribution that the jam consists of x cars at time t, and p→ and p← are involved in the rates at which cars enter and leave the jam. The scaling behavior with exponent - 3 / 2 has been observed in the lifetime distribution of jams [\cite=Nagel]. We think that results obtained in this paper can become theoretical bases; in particular, our discrete problem is comparable to a microscopic description of traffic, where discreteness is not negligible.

Acknowledgment

The author is grateful to Dr. Yoshihiro Yamazaki and Dr. Jun-ichi Wakita for their beneficial comments.

Calculation of Eq. [\eqref=eq:gammaexpression]

Here we follow the calculation of Eq. [\eqref=eq:gammaexpression] in detail. Employing the duplication formula [formula], we rewrite

[formula]

By Euler's reflection formula Γ(z)Γ(1 - z) = π  /   sin πz,

[formula]

Note that [formula] because k is an integer. Similarly,

[formula]

is obtained. Substituting Eqs. [\eqref=eq:A2] and [\eqref=eq:A3] into Eq. [\eqref=eq:A1], then using the duplication formula again as

[formula]

we eventually come to the result

[formula]

Calculation of the moment generating function [\eqref=eq:momentgenerating]

We follow here the calculation of Eq. [\eqref=eq:momentgenerating]. Substituting Eq. [\eqref=eq:P] into Eq. [\eqref=eq:definitionM],

[formula]

where a summation variable is changed as τ = t - x - 2k in the last equality. Applying the negative binomial expansion

[formula]

with y = p0es and m = x + 2k, one obtains

[formula]

and simplifies Eq. [\eqref=eq:moment] into

[formula]

We can transform as follows using the duplication formula [formula],

[formula]

The moment generating function can be expressed by a Gauss hypergeometric function

[formula]

It can be expressed by an elementary function (see Ref. [\cite=Abramowitz]):

[formula]

This leads to the conclusion.

Proof of Eq. [\eqref=eq:integralform]

We calculate the integral to prove Eq. [\eqref=eq:integralform]. We first break up the product of circular functions into the sum.

[formula]

whose real part is

[formula]

This is just a Fourier series expansion of cos t - 1θ, and is associated with the Chebyshev polynomial Tn( cos θ): =  cos nθ [\cite=Gil]. Moreover, by formulas in trigonometry,

[formula]

Thus,

[formula]

Since t, x, and k are integers, the first term in the integral is

[formula]

which behaves like the Kronecker delta [formula]--a subscript fraction may be unreadable, so we use δ(i,j) instead of the standard symbol δi,j. The following terms in the integral are also substituted by [formula], [formula], and [formula], respectively.

If t and x have opposite parity (i.e., t + x and t - x are odd), each Kronecker delta vanishes for all integer k. Otherwise, if t and x have same parity, each Kronecker delta becomes nonzero at some k. By picking out such k,

[formula]

Therefore, Eq. [\eqref=eq:integralform] is derived.