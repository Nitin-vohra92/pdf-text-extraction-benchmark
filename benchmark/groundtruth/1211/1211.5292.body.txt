Impact of blood rheology on wall shear stress in a model of the middle cerebral artery

Introduction

Physiology and medicine are being revolutionized by the growing role of information technology. Our ability to acquire and manage data on both animals and humans allows us to develop increasingly detailed computational models of the biological processes sustaining life. These models, together with the relevant experimental data, are helping researchers to gain insight into the physiology and pathology of the systems under study, in many cases beyond what is possible with purely observational methods.

Cerebrovascular disorders, including intracranial aneurysms (ICA), which may rupture leading to subarachnoid haemorrhages, are one of the most prevalent and devastating diseases of adults, of worldwide concern. In the UK, the total burden has been estimated as £0.5 billion annually [\cite=rivero-arias10]. It is currently generally accepted that haemodynamics plays an important role in the appearance, evolution, and potential rupture of these type of vascular pathologies [\cite=stehbens89] [\cite=shojima04]. More precisely, perturbations in the homeostatic distribution of mechanical forces exerted by the blood on the endothelial layer have been correlated not only to aneurysm initiation and rupture but also to the development of other vascular pathologies such as atherosclerosis [\cite=chatzizisis08].

From a rheological point of view, blood is a shear-thinning fluid. This behaviour arises from the presence of red blood cells suspended in a medium known as blood plasma. Despite this fact, a large body of literature concerning computational haemodynamics characterises blood as a Newtonian fluid under the assumption that in large arteries the shear rate is large enough for the viscosity to be treated as effectively constant [\cite=mejia11].

There has been increasing interest during recent years in the comparison of blood rheology models using computational fluid dynamics (CFD) simulations in realistic computational domains reconstructed from medical image. These studies have been performed in both healthy vasculature (see e.g. [\cite=morbiducci11] [\cite=box05] [\cite=johnston04]) and in the presence of aneurysms (see e.g. [\cite=bernsdorf09] [\cite=cavazzuti11] [\cite=fisher09]). In particular, authors pay special attention to the influence of the choice of rheology model on the computational estimates of wall shear stress (WSS) as a proxy for aneurysm rupture risk. It has been suggested that, in ICAs, the Newtonian simplification overestimates WSS (see e.g. [\cite=bernsdorf09] [\cite=xiang12]) and may underestimate rupture risk. Furthermore, it has been argued that applications requiring accurate WSS estimates (e.g. those concerning vascular remodelling and biomechanics) will suffer from modelling inaccuracy unless the generalized Newtonian (GN) properties of blood are taken into account.

Different indices have been proposed as a way of integrating into CFD-based biomarkers of rupture risk the rich spatio-temporal structure of WSS induced by pulsatile flow in complex vascular networks. Minimal or maximal peak WSS, time-averaged WSS, and oscillatory shear index (OSI) [\cite=ku85] have been extensively used, among others. In many of the studies cited previously, comparisons are performed based on colour map plots, of one or more of these indices, on the surface of the original computational domain. Differences between WSS estimates produced by different rheology models are hence presented in a very qualitative way. Furthermore, the link to actual rupture risk is based on the currently accepted low shear stress biomarker, but with no actual correlation to experimentally determined WSS thresholds. Several authors [\cite=kallmes12] [\cite=cebral12] have recently criticised this approach to rupture risk quantification arguing that more quantitative methods are required in order to gain further insight into the problem.

In a recent publication, Gizzi et al. [\cite=gizzi11] proposed a new framework for the quantitative analysis of WSS: the so-called three-band diagram (TBD) analysis. The TBD analysis facilitates the evaluation of the WSS obtained at a given location over time (i.e. a WSS signal) against a range of WSS pathological thresholds (e.g. WSS magnitude lower than as reported in the case of atherosclerosis formation [\cite=chatzizisis08]). The analysis determines how likely a given WSS signal is to be considered risky for any given threshold. Furthermore, the results of the analysis can be easily compared against pathological values of WSS observed experimentally.

In the current work, we apply TBD analysis to assess the impact of the choice of blood rheology model on the WSS estimates of the HemeLB [\cite=mazzeo08] lattice-Boltzmann blood flow solver in a high resolution three-dimensional model of the right middle cerebral artery. The rest of the paper is structured as follows: introduces the computational and mathematical models used in this work as well as the simulation workflow implemented, presents the results of our simulation and their main implications, finally summarises the main conclusions of the work and outlines future research directions.

Methods

3D model of the middle cerebral artery

Geometry generation

The three-dimensional (3D) model of the middle cerebral artery used in this work (see figure [\ref=fig:3DMCA]) is a subset of a geometrical model of the intracranial vasculature reconstructed from rotational angiography scans. It corresponds to a section of the right middle cerebral artery (MCA) in the vicinity of the internal carotid artery. The main geometrical features of the model are: i) vessels of variable diameter, ii) two bifurcations, and iii) vessel bending. The National Hospital for Neurology and Neurosurgery, London (UK) provided the original images in the framework of the GENIUS project [\cite=mazzeo10] as part of a larger dataset library. The dataset used in this work was segmented and the surface mesh in figure [\ref=fig:3DMCA] generated with the open source package Vascular Modeling Toolkit (VMTK) [\cite=antiga08].

HemeLB

HemeLB [\cite=mazzeo08] is an open source software platform for modelling and simulation of blood flow in sparse vascular networks. It is comprised of tools for geometrical model preprocessing (i.e. regular grid volume meshing of surface meshes), simulation on massively parallel architectures, real-time visualization and steering, and data post-processing. To date, HemeLB has been successfully applied to the simulation of blood flow in healthy brain vasculature as well as in the presence of intracranial aneurysms. Particular attention has been paid to obtaining and presenting simulation results in a clinically meaningful way [\cite=mazzeo10]. HemeLB uses the lattice-Boltzmann method for fluid dynamics (see e.g. [\cite=chen98]) since it allows efficient implementations in large-scale high performance computing infrastructures. For this work, we have developed an extension of HemeLB's lattice Bhatnagar-Gross-Krook (LBGK) collision operator in order to accommodate both Newtonian and GN rheology models. We use the D3Q15 velocity set and the halfway bounce-back rule [\cite=chen98] to enforce the no-slip boundary condition at the walls. We have recently shown [\cite=carver12a] that this combination of collision operator, velocity set, and wall boundary condition performs well from both a numerical and a computational point of view in complex domains for typical blood flow Reynolds and Womersley numbers. Our results show that first-order convergence of the velocity field is achieved over a wide range of resolutions and Reynolds numbers.

Generalized Newtonian rheology

The Carreau-Yasuda (CY) model is widely used to describe the shear-thinning behaviour of blood [\cite=boyd07] [\cite=ashrafizaadeh09]. In this model, the dynamic viscosity η is related to the shear rate [formula] through the following expression:

[formula]

where a, n, and λ are empirically determined to fit a curve between regions of constant η∞ and η0. This model defines three different regimes: a Newtonian region with η0 for low shear rate, followed by a shear-thinning region where η decreases with [formula]; finally, once η∞ is reached a third Newtonian region with constant viscosity η∞ is defined for high shear rates. In this work, we will use the values provided in [\cite=boyd07]: η0 = 0.16 , η∞ = 0.0035 , λ  =  8.2 , a = 0.64, and n = 0.2128 (both are dimensionless).

Figure [\ref=fi:shear_viscosity] presents viscosity as a function of shear rate for the previous model and the Newtonian model considered in this work ([formula]). The Carreau-Yasuda model displays a smooth transition between η0 and η∞. Significant haemodynamic differences between the two rheology models are expected for simulations with [formula].

1D model of the human vascular system

In order to obtain inlet and outlet boundary conditions for our 3D model, we use a modified version of a one-dimensional (1D) model of the human vascular system previously published in [\cite=mulder11]. The original model includes a 1D representation of the main arteries in the upper body (including the circle of Willis and both MCAs) and a zero-dimensional representation of the peripheral vasculature. The geometry is available as part of the open source software package pyNS [\cite=manini12] which also implements a numerical solver for the 1D pulse propagation mathematical model presented in [\cite=huberts12].

The original 1D geometrical model does not include any detail about the vessels branching off the right MCA. Therefore, we modified it to include the two MCA side branches present in the 3D model (see figure [\ref=fig:3DMCA]). In order to achieve this a 1D characterisation of the 3D geometry was required. The open source software package VMTK was used to compute: a) the length of the centrelines associated with segments A-E in figure [\ref=fig:3DMCA], and b) the radii of the maximum inscribed spheres along the centrelines. Table [\ref=tab:length_radii] summarises the results and figure [\ref=fig:1DModel] shows a schematic of the 1D model including the more detailed representation of the right MCA. The reader is referred to [\cite=mulder11] or the pyNS tool for the names and characteristics (e.g. length, radius, connectivity) of each of the segments of the vascular system.

Three-band diagram analysis

The extraction of synthetic biomarkers of aneurysm rupture risk based on CFD analysis of patient-specific models is an active field of research. The three-band diagram analysis framework was recently proposed [\cite=gizzi11] as a way of generalising previously proposed indices (e.g. time-averaged WSS, OSI) and providing a quantitative way of comparing temporal WSS signals against specific risk factors.

Let [formula] be the instantaneous traction vector at an arbitrary surface point with associated surface unit normal [formula] such that

[formula]

where [formula] is the deviatoric part of the full stress tensor of a fluid computed from the mesoscopic LB simulation variables as described in [\cite=krueger09]. The relationship between [formula] and σ, the full stress tensor, is

[formula]

where P is the hydrodynamic pressure and δ is the usual Kronecker delta tensor. Furthermore, for a generalized Newtonian incompressible fluid, [formula] can be rewritten as

[formula]

where [formula] is the shear rate tensor

[formula]

η is the dynamic viscosity of a fluid as a function of shear rate [formula], see e.g. equation [\eqref=eq:cy_model], and [formula] is the velocity vector. In the case of Newtonian fluids, [formula]

In this work, we will consider the temporal evolution of the signed magnitude of the traction vector [formula] (which we will refer as the WSS signal), i.e.:

[formula]

where [formula] is the average traction vector over time, sgn  is the sign function, and |  ·  | is the magnitude of a given vector.

Given a WSS signal, S(t), and a scalar risk factor σ  ≥  0, the TBD analysis defines a triplet of functions

[formula]

where the Heaviside function H(x) is defined as H(x)  =  1 if x  >  0 and H(x)  =  0 if x  <  0. The closed support of the function S+ is a set of time intervals of cardinality N+(σ) (and similarly with S0 and S-). The main idea behind the method is to inspect the number of such intervals as a function of the variable threshold σ (i.e. the risk factor). It has been suggested that a WSS signal can be considered healthy if N+ ,0, -(σ) > 0 for a given risk factor σ. The reader is referred to [\cite=gizzi11] for a more detailed description of the method. A Python implementation of the algorithm is freely available as part of HemeLB's postprocessing tools.

Simulation workflow

Our simulation workflow is as follows. First, the original DICOM images were segmented, a region of interest was chosen, and a surface mesh was generated with the VMTK implementation of the marching cubes algorithm. A non-shrinking Taubin filter was then applied to smooth out imaging artifacts. Second, we loaded the resulting surface mesh in HemeLB's setup tool in order to choose the location of the inlet and the outlets and generate a regular grid discretisation of the volume enclosed by the surface (with a total of 4,161,046 grid points). Next, the pyNS solver was run to obtain pressure traces at inlet A and oulets C-E in figure [\ref=fig:3DMCA]. We then used these traces as inlet and outlet boundary conditions to run HemeLB simulations with both the Newtonian and Carreau-Yasuda rheology models for a total of three cardiac cycles. Note that for flow in a domain with open boundaries, one must decide whether to close the system with pressure or flow rate boundary conditions. The former case ensures that the same pressure drop occurs regardless of the rheology model chosen but sacrifices the Reynolds number parity as a mathematical necessity. The latter would ensure the same Reynolds number is recovered but different pressure drops occur. We chose to impose pressure boundary conditions as obtained from the 1D simulations.

The following configuration paremeters were used in this work: timestep [formula], spacestep [formula], maximum density difference in the domain Δρ  /  ρ0 = 0.019, Mach numbers (defined as the ratio between the largest velocity magnitude in the domain and lattice speed of sound [formula]) 0.31 and 0.244 for the Newtonian and CY rheology models respectively, and LBGK relaxation parameter τ = 0.522 for the Newtonian model and [formula] for the CY model (which becomes τ = 0.522 for η∞). Finally, we post-processed the simulation results to compute TBDs of the WSS signal at different geometrical locations over time. Table [\ref=ta:sampling_points] shows their location for reproducibility purposes.

The pyNS simulations were run on a single core of a 2 GHz Intel Core i7 laptop with 4GB of RAM and took on the order of minutes to run. The HemeLB simulations were run on 2048 cores of HECToR (UK's national supercomputer) and took and for the Newtonian and Carreau-Yasuda models respectively. The difference in computing time between the two rheology models is due to the cost associated with computing [formula] and evaluating equation [\eqref=eq:cy_model] at each lattice site every timestep. The choice of core count is based on the number of lattice sites and the scalability analysis presented in [\cite=groen12] in order to ensure efficient use of the computational resources.

All the files required to run the pyNS and HemeLB simulations are available as part of the supplementary material associated with this paper. Both software packages are open source and freely available to the public.

Results and discussion

Pressure profiles

Figure [\ref=fig:pressure_profiles] plots the pressure traces generated by pyNS at inlet A and outlets C-E of figure [\ref=fig:1DModel]. It can be seen how the typical pressure variations observed throughout the cardiac cycle are well recovered. First, the sudden increase in pressure following the opening of the aortic valve after approximately , which peaks at around and drops until approximately corresponds to the ventricular ejection phase. Secondly, the isovolumic relaxation phase happens between the previous time point and the mitral valve opening around . Finally, the ventricular filling phase occurs between the time the mitral valve opens and the end of the cycle at approximately (for a cardiac rate of roughly 66 beats per minute).

3D simulations and three-band diagram analysis

Figure [\ref=fig:3D_traction] plots the traction vector [formula] computed with HemeLB configured to use the CY rheology model at the end of diastole and at peak flow in systole (both in the third cardiac cycle simulated). The direction of [formula] (which is consistent with the flow direction at any given point) and its magnitude follow a complex distribution throughout the domain with notable changes during the cardiac cycle. The main characteristics are: i) areas with larger WSS can be found in the interior side of both branches leaving the bifurcation, ii) a zone of low WSS, or stagnation point, is found around the area where both branches meet, iii) there are substantial changes in the direction of [formula] throughout the cardiac cycle around the stagnation point area, leading to oscillatory WSS signals.

Figure [\ref=fig:tbds] presents the TBD analysis at points x3, x4, and x5. The analysis confirms the change of sign of the WSS signal (due to a change of direction in the traction field) occurring at x4 throughout the cardiac cycle (note the presence of a negative component in figures [\ref=fig:tbd_n4] and [\ref=fig:tbd_cy4]). Furthermore, the negative component covers a wider range of threshold values in the Newtonian case. According to the criteria outlined in [\cite=gizzi11], an oscillatory WSS signal is considered healthy when the TBD analysis displays all three components above a given critical threshold. In this case we observe a variation of just over between the predicted largest healthy threshold in the Newtonian and CY cases.

In the case of x3 and x5 no negative component appears in the analysis indicating that there is no oscillation in the WSS signal. This rules out one of the main factors correlated with vascular disorders: oscillatory flow [\cite=ku85]. Nevertheless, such signals could still be considered risky if their mean value was below a given threshold value [\cite=shojima04]. We can clearly see in figures [\ref=fig:tbd_n3]-[\ref=fig:tbd_cy3] and [\ref=fig:tbd_n5]-[\ref=fig:tbd_cy5] that the choice of rheology model would not have a significant impact on the assessment of risk since both diagrams are nearly identical.

The points listed in table [\ref=ta:sampling_points] which have not been analysed in figure [\ref=fig:tbds] fall within one of the two previous scenarios.

Conclusions

In this work, we present a complete workflow for the simulation of blood flow in a patient-specific 3D model of the right middle cerebral artery. The main features of the model are: i) the geometry is reconstructed from rotational angiography scans and discretised at high resolution ([formula]), ii) inlet and outlet boundary conditions are obtained with a 1D model of the complete vascular system, and iii) the rheological properties of the blood can be described with both Newtonian and generalized Newtonian models. Simulations run efficiently on the HECToR supercomputer taking for a domain comprising of 4,161,046 lattice sites.

The workflow is applied to the comparison of two blood rheology models: a Newtonian model ([formula]) and the Carreau-Yasuda (CY) model. This is done in a quantitative manner in conjunction with the recently proposed three-band diagram (TBD) analysis framework. In agreement with previous work (see e.g. [\cite=morbiducci11] [\cite=bernsdorf09]), our results show variations in the haemodynamics recovered with each of the rheology models studied. However, the evaluation of those results against a set of risk factors with TBD show little to no difference. In particular, a wall shear stress signal with strong oscillatory component was found to be risky for thresholds equal to or greater than 1.56 and for the Newtonian and CY models respectively. In the case of non-oscillatory signals the analysis returns almost identical results in both cases.

The main limitations of our study are: i) we have used a single geometry; in order to achieve statistical significance a larger number of other cases must be considered, and ii) the results presented may not hold in the presence of intracranial aneurysms (ICAs) or other vascular malformations where regions of much smaller shear rate may occur.

Our future lines of work include applying the analysis methodology presented in the current work to a set of ICAs reconstructed from rotational angiography images. We also plan to investigate the coupling of the current 1D-3D haemodynamics model with agent-based models of tissue remodelling using the multiscale modelling framework presented in [\cite=groen12b].

Acknowledgements

This work made use of HECToR, the UK's national high-performance computing service, funded by the Office of Science and Technology through EPSRC's High End Computing Programme. We also thank Dr Simone Manini for support using the pyNS software. This work was supported by the British Heart Foundation, EPSRC grants "Large Scale Lattice Boltzmann for Biocolloidal Systems" (EP/I034602/1) and 2020 Science (http://www.2020science.net/, EP/I017909/1), and the EC-FP7 projects CRESTA (http://www.cresta-project.eu/, grant no. 287703) and MAPPER (http://www.mapper-project.eu/, grant no. 261507).