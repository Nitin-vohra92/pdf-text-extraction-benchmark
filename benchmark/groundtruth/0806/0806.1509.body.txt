Bloch electrons interacting with an external electromagnetic field and Bloch electrons in interaction.

Introduction:

The properties of electrons in solids are usually described in the framework of Bloch theory of electrons in a periodic potential. In particular, the study of the dynamics and transport properties of Bloch electrons perturbated by external fields led to important results for the understanding of metals, semiconductors and insulators properties [\cite=MERMIN]. For weak fields such that interband transitions called Zener tunnelling are negligible, the dynamics of a Bloch electron in a given nth band is usually based on the following semiclassical equations of motion

[formula]

where [formula] and [formula] are the electric and magnetic fields respectively and [formula] is the energy of the band including a correction due to the orbital magnetic moment [formula]. In the band energy E0 of the unperturbated crystal, the electron momentum [formula] has been substituted by the gauge covariant momentum [formula]. This substitution has been first justified by Peierls in the context of the tight binding model and for this reason is called the Peierls substitution [\cite=PEIERLS]. A full justification was later given by Kohn [\cite=KOHN]. A simpler version of the proof was later provided by Blount, Roth and Wannier and Fredkin who could derived an approximate band energy operator as an asymptotic series expansion in the fields strength as well as general expressions for the first few terms in this series [\cite=Blount][\cite=ROTH][\cite=WANNIER]. Their methods, although different, are all based on some approximate unitary transformation of the initial Hamiltonian of Bloch electrons in an electromagnetic field which eliminates the interband matrix elements and leads to an effective diagonal-in-band energy operator. The principal advantage of the Blount's method is that it is an application of a general diagonalization scheme applicable to any kind of matrix valued Hamiltonian whereas the two other ones are specific to the solid states. In particular, Blount has also considered the case of a Dirac particle in an electromagnetic field whose Hamiltonian was diagonalized to the second order in the fields strength and first order in their first derivatives. Later on, Weigert and Littlejohn developer a systematic method to diagonalize general quantum Hamiltonian in a series expansion in [formula] [\cite=LITTLEJOHN] instead in fields strength. an obvious advantage of this kind of expansion is obviously that it can be valid for strong external field but also that the semiclassical limit is readily obtained. Unfortunately, the method [\cite=LITTLEJOHN] involves formal series expansion in terms of symbols of operators which makes the method very complicated for practical applications. It is worth mentioning that recently a variant of the Foldy Wouthuysen transformation valid for strong fields and based also on an expansion in [formula] of the Dirac Hamiltonian was presented [\cite=SILENKO].

This is not the end story with regards to the Bloch equations [formula]. Indeed, Karplus, Luttinger and Kohn [\cite=KARPLUS] predicted very early a spontaneous Hall effect in ferromagnetic materials due to a corrective term to the velocity in Eq. [formula], known as the anomalous velocity. Later, Adams and Blount [\cite=ADAMS], by interpreting this term as resulting from the noncommutativity of the intraband coordinate operators, derived new semiclassical equations of motion for Bloch electrons with an anomalous velocity. However these equations turn out to be correct only for external electric fields. It is only recently that the correct equations of motion of Bloch electrons in the presence of both electric and magnetic fields and including anomalous velocity were derived by Chang and Niu [\cite=NIU]. Indeed, using a time-dependent variational principle in a Lagrangian formulation and a description of the electron in terms of wave packets, they found the following new equations of motion in the presence of electromagnetic fields

[formula]

The correction term to the velocity [formula] is the anomalous velocity which is due to the presence of a Berry curvature [formula] of electronic Bloch state in the given nth band, associated to the electron motion in the nth energy band. For crystals with simultaneous time-reversal and spatial inversion symmetry, the Berry curvature and the magnetic moment vanish identically throughout the Brillouin zone. This is the case of most applications in solid state physics, but there are situations where these symmetries are not simultaneously present like in GaAs where inversion symmetry is broken or in ferromagnets which break time reversal symmetries. In the same way, the presence of a strong magnetic field, the magnetic bloch bands corresponding to the unperturbated system breaks the time inversion symmetries. In all these cases, the dynamical and transport properties must be described by the full equations of motion given by Eq. [formula]. Notice that even for crystals with simultaneous time-reversal and spatial inversion symmetry, energy bands degeneracies can lead to a non vanishing curvature and magnetization; a typical example is provided by the graphene [\cite=NIUGRAPHENE] This case is due to the presence of a topological Berry phase associated to bands degeneracies [\cite=BERRY]. This particular situation is not considered in this paper.

The method developed in [\cite=NIU] is by construction limited to the semiclassical level, but the description of phenomena such as the electromagnetic interaction of Bloch electrons, as will be discussed in this paper, requires a theory which goes beyond the semiclassical approximation. Recently we came back to the initial considerations of Blount and others with regards to the diagonalization procedure for an arbitrary matrix valued Hamiltonian H (applicable to any kind of quantum system which has an energy band spectrum) in the presence of external fields and a first original method based on a differential equation of the diagonal in-band energy operator with respect to Planck constant [formula] was proposed in [\cite=SERIESPIERRE]. In this approach, where [formula] is promoted as a (formal) running parameter noted α, one has to diagonalize H at the scale α where it is assumed that the canonical dynamical operators satisfy the algebra [formula]. Relating two diagonalization processes for close values of α, leads to a differential equation of the required diagonal Hamiltonian εα with respect to α. This differential equation has to be supplemented by an additional equation which is the consequence of the unitarity condition of the matrix Uα diagonalizing H at the scale α. The resolution of this differential equation can then be performed by a systematic series expansion in [formula], and in this way, at least in principle, an exact diagonalization of arbitrary Hamiltonians can be achieved. This approach reveals that the diagonal energy operator is most naturally expressible in terms of covariant (noncanonical ) coordinates [formula] and momentum operators [formula] which are both corrected by Berry connections terms [formula] and which satisfy a non-commutative algebra. Particle motion in this noncanonical phase space is obviously drastically modified (as in Eq. [formula]). Particularly interesting is the fact that, in the semiclassical limit, which is often enough to get physical insight to the problem considered, the diagonal Hamiltonian is obtained by a straightforward integration of this differential equation. In this limiting case, the differential approach turns out to be so powerful that the general diagonal representation for an arbitrary matrix valued Hamiltonian in terms of covariant operators and commutators between Berry connections could be given (actually, this general formula was first derived by a direct diagonalization procedure in [\cite=PIERRESEMIDIAG]). This result allowed us to deduce effective semiclassical Hamiltonians and to predict new phenomena in various physical situations. First, the study of Bloch electron in magnetic Bloch bands [\cite=PIERREEUROPHYS] showed that besides the position operator which get a Berry-phase contribution (as already shown by [\cite=NIU]), the momentum in the band energy [formula] also has to be replaced by a new Berry-dependent momentum operator [formula] instead of the Peierls substitution. It turns out that this result is essential for the correct derivation of the full equations of motion for Bloch electrons Eq. [formula]. Likewise, for electrons in graphene in a magnetic field, it was also observed that it is in terms of [formula] that the semiclassical quantification of the orbit has to be achieved [\cite=PIERREGRAPHENE].

At the semiclassical level other systems were also investigated, like Dirac electrons in electromagnetic [\cite=SERIESPIERRE] and gravitational fields [\cite=PIERREELECGRAVIT] with the discovery of a spin-magnetotorsion coupling. The study of the photon in a static gravitational field when polarization effect are taken into account predicts the gravitational birefringence phenomenon where an helicity dependent anomalous velocity deviates the photon from the usual Einsteinien geodesics [\cite=PIERREPHOTONGRAVIT]. This kind of polarization effects which are called spin Hall effect of light have been recently observed [\cite=SPINHALLSCIENCE]. Despite these results, the applicability of the differential approach beyond the semiclassical turns out to be very complicated. Even the deduction of the diagonal representation of a generic Hamiltonian at second order in [formula] is a prohibitively difficult problem, although a solution was found for simple practical applications like a photon in an homogeneous isotropic media and Bloch electron in uniform electric field [\cite=SERIESPIERRE]. But clearly, one can not expect to use this method in the case of several Bloch electrons in electromagnetic interaction, a problem we would like to consider in this paper.  However, very recently, a new general and powerful method for the diagonalization of an arbitrary matrix valued Hamiltonian has been proposed by Gosselin and Mohrbach (referred as GM) [\cite=DIAGOEXACT].It leads to a particularly compact and elegant exact expression for the required diagonal energy operator. This approach is therefore particularly well adapted to problems in solid state physics and to Dirac particles in external fields. This last case can be considered intuitively as a simple two bands versions (particles and anti-particles) of Bloch electrons in a crystal. The philosophy behind this approach consists in mapping the initial quantum system to a classical one which can be diagonalized and then to return to the full quantum system. This method is not based on a differential equation for the diagonal energy operator with respect to [formula], but it also requires the introduction of new mathematical objects like non-commuting operators which evolve with [formula] promoted as a running variable. This new mathematical construction leads us to define a differential calculus on a non-commutative space showing some similarities with the stochastic calculus as both stress the role of second order terms. This approach allows us to write both the diagonal Hamiltonian [formula] and the transforming matrix [formula] (where [formula] is the phase space of the covariant dynamical operators) as a result of the application of integro-differential operators on [formula] and [formula] respectively, i.e. [formula] and [formula]. Matrices with the subscribe 0 correspond to the operators replaced by classical commuting variables [formula] The only requirement of the method is the knowledge of [formula] at α = 0 which gives the diagonal form [formula] Generally, these equations do not allow to find directly [formula], [formula], however, they allow us to produce the solutions for [formula] and [formula] recursively in a series expansion in [formula] But contrary to the procedure in [\cite=SERIESPIERRE], it turns out that the expansion in a series of [formula] is much more easier to obtain than by the successive integration of the differential equation and therefore more convenient for getting higher order contributions. Remarkably, it was also found that the exact expression for [formula] is actually an exact solution of the differential equation of [\cite=SERIESPIERRE]. This result obviously places the present approach on a firm base[\cite=DIAGOEXACT]. Another interesting feature of this approach is the confirmation of the fundamental role played by Berry curvatures in these systems since the method results in an effective diagonal Hamiltonian with Berry phase corrections as well as noncommutative coordinates and momentum covariant operators as in previous approaches [\cite=SERIESPIERRE][\cite=PIERRESEMIDIAG]).

Although similar in spirit to Blount's method and in particular to Weigert and Littlejohn one [\cite=LITTLEJOHN], the approach proposed in [\cite=DIAGOEXACT] is essentially different as it is based on a very new mathematical formulation. (The general method of [\cite=LITTLEJOHN] leads also to a diagonal in-band energy representation as a formal series expansion written in terms of symbols of operators which makes the method very complicated for practical applications). In our opinion this new approach is more tractable for applications and, as an illustration of this statement, a general in-band energy for any arbitrary Hamiltonian to the second order in [formula] was achieved in [\cite=DIAGOEXACT] (higher order expressions becomes again very cumbersome but could in principle be computed). This expression will be the starting point for a straightforward study of a single Bloch electron in an external electromagnetic field. Another purpose of the present work is the adaptation of GM's results to the case of Bloch electrons in interaction. Note that both problems can be transposed to the case of Dirac electrons which are actually treated by the same method in the another paper [\cite=PIERREDIRAC]. It is obviously the Coulomb (electrostatic) interaction between Bloch (Dirac) electrons that dominates over the magnetic one, so that a first order diagonalization seems to be sufficient. But, in the presence of non vanishing electronic magnetic moments, other effects like moment-moment interactions mediated by the magnetic part of the full electromagnetic self-interaction are expected. This comes out by analogy with the spin-spin interaction in the Breit Hamiltonian of non-relativistic Dirac particles [\cite=BREIT] which is recover in the non-relativistic limit [\cite=PIERREDIRAC]. Obviously these kind of interactions are of second order in [formula] and a diagonalization procedure which goes to this order is necessary.

Before starting, two points are worth mentioning. As already noted in [\cite=LITTLEJOHN] but also in [\cite=PIERRESEMIDIAG][\cite=SERIESPIERRE], there is certain latitude in finding U which reflects a kind of gauge invariance of the method. Because of this freedom two equivalent diagonalizing operators leads to two different forms for the diagonal Hamiltonian but of course to the same eigenvalues. This is similar to the Schrodinger equation in a magnetic field where the Hamiltonian and the wave function gauge dependence combines itself to give gauge independent energy levels. In our case it turns out that this freedom is only present at the second order in [formula], because the first order diagonalization is performed with the zero order matrix [formula] which can be uniquely defined. Actually this gauge dependence can be included in the gauge covariant dynamical operator [formula]. Then the diagonal in-bands energy operator is uniquely defined when it is written in terms of [formula] instead of the canonical operators [formula] As a particular gauge choice can be made on the ground of simplicity and convenience, here as in previous works [\cite=SERIESPIERRE][\cite=DIAGOEXACT] the reality condition of diagonal elements (the anti-hermitian diagonal elements are setting to zero) of U is imposed.

The second point we would like to mention is that, in order to simplify the expressions, only time independent electromagnetic fields are considered, but results can be easily extended to include time dependent interactions. In addition, as the ultimate goal is to consider Bloch electrons in interaction through an internal electromagnetic field, the time dependence of the vector potential can be safely neglected as all retarded effects in the electromagnetic interaction are negligible owing to the fact that Bloch electrons are non-relativistic.

The paper is organized as follows. In the next section we give a reminder of the diagonalization procedure of [\cite=DIAGOEXACT] for an arbitrary matrix valued Hamiltonian. We provide some detailed formulas for the diagonalized energy operator at the second order in [formula] as well as for the Berry phases at this order. Section 3 applies this formalism to the case of a Bloch electron in an external electromagnetic field. The diagonalized Hamiltonian at the second order in [formula] is written in terms of the transformed dynamical variables and magnetization operators. In section 4, we consider the case of P Bloch electrons interacting through an internal electromagnetic field. Diagonalizing the matter part of the Hamiltonian to the second order in [formula] and solving for the electromagnetic field yields the P particles effective Hamiltonian. Last section is for the conclusion.

Diagonalization of an arbitrary matrix valued Hamiltonian

To start with, an outline of the approach developed by Gosselin and Mohrbach to diagonalize formally an arbitrary matrix valued Hamiltonian is given, with the notations of GM [\cite=DIAGOEXACT]. Let consider an arbitrary quantum mechanical system whose state space is a tensor product [formula] with V some internal space. In other words, the Hamiltonian of this system can be written as a matrix [formula] of size dim V whose elements are operators depending on a couple of canonical variables [formula] The archetype example is usually the Dirac Hamiltonian with V = C4, but as shown in [\cite=PIERRESEMIDIAG] the following set up fits with all system presenting an energy band spectrum, as for Bloch electron (where V correspond to the energy band indices), a system which is the main concern of the present paper.

In [\cite=DIAGOEXACT], a method to find an unitary matrix [formula] to diagonalize any arbitrary matrix-valued quantum Hamiltonian [formula] such that [formula] is the diagonal in-band energy operator was achieved.

As explained in the introduction, the principle of this method is to link continuously an Hamiltonian in which the variables are considered as classical (i.e. [formula]) to the true Hamiltonian we aim at diagonalizing (that is at scale [formula]). The idea is to diagonalize the Hamiltonian for [formula], which appears in general to be much easier, and then to come back to scale [formula] to obtain the required Band Hamiltonian. To perform this program, we have to proceed in an indirect way. Actually, we first need to introduce a family of canonical variables [formula] indexed by a continuous parameter [formula], such that the commutators are given by [formula] and then, to introduce for any arbitrary function [formula] both a notion of differentiation and integration describing the variation of [formula] as α varies. These notions have to take into account the fact that the commutation relations are depending on α. It leads us naturally to introduce the notion of infinitesimal non commutative canonical variables [formula] as well as a form of differential calculus presenting some formal analogy with the non commutative stochastic calculus. The introduction of these differentials notion, will allow to connect ultimately our Hamiltonian at scales 0 and [formula].

More precisely now, we introduce a space of non commuting infinitesimal operators [formula]  i = 1,2,3 indexed by a continuous parameter α, that satisfy the following infinitesimal Heisenberg algebra with a reversed sign [formula]and [formula] From it, we define a set of running coordinate and momentum operators by writing the following formal sums [formula], and [formula] with the choice of convention dRiα = Riα - Riα - dα and dPiα = Piα - Piα - dα, so that the running operators satisfy [formula] and [formula] For α  =   we recover the usual canonical operators [formula]and [formula] which evidently satisfy the canonical Heisenberg algebra. The differential of an arbitrary function [formula] where [formula] on this space is given by

[formula]

with i,j = 1..6. We also assume that [formula] for i = 1,2,3 and [formula] for i = 4,5,6 .The notation [formula] (which in [\cite=SERIESPIERRE] was corresponding to the operation [formula]) is defined as a specific procedure on a series expansion of F in the variables Riα, Piα in the following way : let F be a sum of monomials of the kind [formula] the Mi being arbitrary monomials in Rα or Pα alternatively. Let the operator [formula] acts on such an expression by deriving all combinations of one monomial in [formula] and one monomial in [formula]. For each of these combinations, insert a dRiα at the place where the derivative [formula] is acting and in a same manner a dPjα at the place where the derivative [formula] is acting. This leads to an expression with two kind of terms, one kind being proportional to the dRiαdPjα, and the second proportional to dPjαdRiα. Then rewrite this expression in terms of dRiαdPjα + dPjαdRiα and dRiαdPjα - dPjαdRiα =  - iδijdα. Then [formula] is defined as minus the contributions of terms proportional to - iδijdα in the computation in the procedure just considered. This definition implies a procedure which is clearly dependent of the symmetrization chosen for the expansion of F.

To make the definition of [formula] clearer, consider some important practical examples. If the function F has the following form [formula] which corresponds to a frequent choice of symmetrization in Rα and Pα, then [formula]. Another choice of symmetrization leads in general to a different result. For instance, if we rewrite the same function F in a fully symmetrized form in Rα and Pα (that is invariant by all permutations in Rα and Pα) which is also often used, we have now have a different result since [formula].

Nevertheless, this dependence of [formula] in the symmetrization choice is not astonishing at all.  Actually changing the symmetrization of a function [formula] introduces some explicit terms in α which changes also the term ∂αFdα present in the differential Eq. [formula]. As a consequence, neither the partial derivative with respect to α, nor the bracket are invariant by a change of form. But, what is invariant is the sum [formula]. This assertion is shown in [\cite=DIAGOEXACT].

Now, what really matters for us in Eq. [formula] is this invariant term proportional to dα this is why we define an expectation operation [formula] so that

[formula]

Combining the expectation operator as well as the differential allows to relate a function evaluated at the physical scale [formula], [formula] to that same function evaluated at the scale 0, [formula] that is when the canonical variables are considered as classical ones. Actually by integration of the previous relation one has:

[formula]

(we use a property that the expectation operator satisfies [formula]).

Here recall that we denote by [formula] the dynamical variables when [formula] and [formula] are considered as commuting classical variables that is when α. This last formula is the starting point of the method. Iterating this relation, by successive differentiations and integrations, one can relate a full quantum function [formula] to the same function evaluated with classical variables [formula]. This will prove very useful in a problem of diagonalization of a matricial Hamiltonian since in that case, the diagonalization when the canonical variables [formula] commute reduces to the diagonalization of an usual matrix of finite size. Thus diagonalizing our Hamiltonian at scale 0, that is finding an [formula] is in general an easier task.

However, this not the end of the story. Having found a way to relate [formula] to its classical counterpart is not enough since we want ultimately to recover expressions of interest evaluated at [formula] not at the [formula] scale. This kind of coming back process after a classical diagonalization is performed by an other operation defined in [\cite=DIAGOEXACT]. It allows in the previous integral relation to replace, inside the expectation, [formula] and [formula] by [formula] at the price of a modification of the expression inside the integral. Define the exponentiated Bracket plus Shift operator (EBS) between α2 and α1 as acting on any function [formula] to yield an other function depending on [formula], α1  >  α2 :

[formula]

where the Shift operation [formula] sets the dynamical variables [formula] to [formula] and satisfies [formula] whatever the values of α and β. Apart from the repeated application of the Bracket [formula] the EBS operation has the virtue to shift progressively the variables from [formula], the classical variables to [formula] the full quantum variables. Actually its main property is the following : so that it can of course be specialized to : These two formulas can be understood intuitively as follows. The EBS operation changes the function (by the action of the bracket defined above) but also changes progressively the variables from [formula] to [formula] (through the shift operator). As a consequence, and despite the appearances, the expression in the right hand side [formula] is a function of [formula]. Moreover, both the EBS operation and the shift of variable compensate each over to produce the equality with the left hand side.

With this mathematical construction in hand it was possible to write the solution of our diagonalization procedure for a general matrix valued Hamiltonian through an unitary transformation U as the solution of the following system of integro-differential equations. Introducing [formula] the diagonalization matrix when [formula], such that the classical energy matrix obtained as [formula] is a diagonal matrix, we could write :

[formula]

T is the notation for the time ordered product, the operator [formula] acts as explained above, and Oα and Nα act in the  following way :

The operation [formula] can also be written as [formula] with a translation operator T and a magnetization M operator (this terminology is explained in [\cite=SERIESPIERRE]) where

[formula]

These equations require some explanations. First, the operators [formula] are given by

[formula]

and P+ and P- are respectively the projectors on the diagonal and off-diagonal elements of matrices. From Eq. [formula] one can deduce the following relation where [formula] and [formula] and [formula] are new covariant coordinate and momentum operators defined in the following way :

[formula]

The Berry connections terms being defined as :

[formula]

and [formula] denotes the vector [formula]. In fact in [\cite=DIAGOEXACT] we show that [formula] and [formula] have to be corrected by a third order in [formula] terms [formula] and [formula] but these terms will always be neglected here.

Therefore, the operator T as a part of O naturally leads to the emergence of the covariant dynamical coordinates which turn out the be the physical dynamical variables of particles as shown in several situations [\cite=PIERRESEMIDIAG][\cite=SERIESPIERRE][\cite=PIERREPHOTONGRAVIT][\cite=PIERREELECGRAVIT].

Second, using the gauge setting to zero the anti-hermitian diagonal elements of Uα [\cite=DIAGOEXACT] we have

[formula]

where the inverse of the commutator operation [formula] has the following properties

[formula]

for an arbitrary matrix valued operator M. It means that the operator [formula] acts on the space of endomorphism of the state space in the following way : it is zero when acting on the kernel of the operator [formula] whose action is to compute the commutator with εα, and is the inverse of [formula] on the complementary subspace of the kernel.

Note that, as it will appear clearly later on, having both [formula] and [formula] at order n in [formula], and reinserting in the exponential of Eqs. [formula] allows us to find [formula] and [formula] at order n + 1 in [formula]. A needed assumption for this procedure to work is that the diagonalization [formula] is explicitly known when [formula], i.e. when [formula] and [formula] are treated as commuting variables.

We end up this section with a technical remark that will be important for the sequel. As shown in our formula [formula] the solutions for the diagonalization process depends on [formula], [formula]. While the final results do not depend on the way variables are symmetrized (that is the order we write the products of components of [formula], one has to start with an initial symmetrization for the diagonalized energy at the zeroth order as well as for [formula] or equivalently the Berry phase. Since this detail will be important only at the second order in [formula] while considering the Bloch electron in an electromagnetic field, we do not mention any choice for the moment.

Eqs. [formula] show that a diagonal Hamiltonian representation can be found to any desired order in [formula], and in the following we will carry it out until the second order. Let start first with the first order.

Covariant dynamical operator algebra

From equations Eq. [formula] we readily deduce the following non trivial algebra between the dynamical operators

[formula]

where the terms Θij are Berry curvatures definitions. Of course these non trivial commutation relations also give new contributions to the equations of motion and thus lead to new phenomena [\cite=PIERREEUROPHYS][\cite=PIERRESEMIDIAG][\cite=SERIESPIERRE][\cite=PIERREPHOTONGRAVIT][\cite=PIERREELECGRAVIT]. The commutation relations are valid to any order in [formula] but in practice we can compute them as well as the energy [formula] in a series expansion in [formula]

Diagonal representation at the first order in [formula]

In this section we derive by a straightforward application of Eq. [formula] the semiclassical effective diagonal in-bands Hamiltonian ε for one particle. Using the fact that at this level [formula] we have

[formula]

From the definition of T and M in Eq. [formula] we see that we must determine the quantities [formula] Eq. [formula] defined previously. At this level of the approximation and due to the factor [formula] in the previous equation it is enough to know this quantity at the zeroth order in [formula]. Skipping the [formula] index, they are thus simply given by

[formula]

where as before U0 is the matrix that would diagonalize the Hamiltonian if [formula] and [formula] where commuting variables (that is the matrix U0 which diagonalizes the classical energy when [formula]). It means that, interestingly, at this first order in [formula], the diagonalizing matrix U is the matrix defined at the order 0 in which the classical variables [formula] have been replaced by the quantum operator [formula] This is the clue of the method: at each order n we just need to know the matrix U at the order n - 1. Therefore, the semiclassical diagonalization is within the present approach simple to achieve (and simpler than any other method we are aware for) as it only requires the determination of the matrix diagonalizing the classical energy.

Introducing also the covariant dynamical operators [formula] with the Berry connection [formula], as well as the integrated non projected Berry connections [formula] at this order, the diagonal energy Eq. [formula] can be written as

[formula]

where summation over i is assumed. Here [formula] corresponds to the classical diagonal energy operators in which the classical variables [formula] have been replaced by the full noncomutative covariant operators which satisfy a non commutative algebra as we will see later when considering the practical examples. The second contribution which is of order [formula], gives for instance for Bloch electrons in a magnetic field [formula] as we shall see later, the coupling between [formula] and the magnetic moment operator .

Note also that this general diagonal energy for an arbitrary one particle system was already derived in previous works by different methods [\cite=PIERRESEMIDIAG][\cite=SERIESPIERRE] and turns out to be very useful for the study of several different physical systems [\cite=PIERREEUROPHYS][\cite=PIERREELECGRAVIT][\cite=PIERREPHOTONGRAVIT][\cite=PIERREGRAPHENE].

Diagonal representation at the second order in [formula]

The Hamiltonian diagonalization at this order requires the matrix U at the first order: [formula] where [formula] is determined from the relation [formula] as a consequence of Eq. [formula] With expression [formula] we readily obtain :

[formula]

At the same order the (non-diagonal) Berry connections [formula] are again given by

[formula]

where now [formula] is the transformation to the first order in α i.e. [formula] in which [formula] is replaced by the running operator [formula]. Using the hermiticity of [formula], so that one has [formula] we can expand [formula] as : (the [formula] factor reminds that in our definition of [formula] the Gradient with respect to [formula] is normalized, i.e. divided by α). After some recombinations, the previous expression can be written in a more convenient form :

[formula]

using now the fact that at the lowest order [formula], one has :

[formula]

decomposing [formula] into Hermitian and antihermitian part we are thus led to :

[formula]

where [formula] and [formula] denote the antihermitian and Hermitian part of an operator Z respectively. Now with Eq. [formula] and after the integration, we are led for [formula] to the following expression :

[formula]

where we introduced the notations

[formula]

and

[formula]

These formula, although abstruse will be useful in our next sections. Having found the matrices [formula] and [formula] at the required order we can now determine the series expansion for the diagonalized Hamiltonian to the second order in [formula]. From equation Eq. [formula] we can write

where the last contribution is given by The first contribution [formula] can be expanded as before as:

[formula]

where the Berry connections have to be expanded to the first order, whereas the second order contribution has to be expanded to the zeroth order in the Berry connections. Notice that due to the integration process, the squared terms in [formula], [formula] as well as the first order terms in the Berry phase get a [formula] factor.

The consequence is that these contributions can be recombined to yield :

[formula]

with :

[formula]

and where we have denoted again [formula]. Remark that the last term [formula] in the expression for [formula] is of order 2 since [formula] involves some commutators and is thus of order [formula]. As explained above, one can, at each order of the expansion, safely replace the canonical operators [formula] by the covariant ones [formula] which are given by the following expression to the second order (dropping once again the [formula] index) :

[formula]

with : [formula] and (as before we drop the index [formula]) [formula]:

[formula]

Remark ultimately, that had we chosen the variables [formula] rather than [formula] to express our Hamiltonian, we would have rather written at our order of approximation :

[formula]

However, as explained before, the transformed variables [formula] fit better to write the Hamiltonian since they enter directly in [formula].

Eq [formula] is the desired series expansion to the second order in [formula] of the diagonal Hamiltonian. In the next section it will be the angular stone for the computation of the effective in-bands Hamiltonian of a Bloch electron in an external electromagnetic field. Once this will be achieved the case of several Bloch electrons will be investigated.

Bloch electron in an electromagnetic field

To start, an outline of the first order diagonalization for the special case of an electron in an crystal lattice perturbated by the presence of an external electromagnetic field considered in refs. [\cite=PIERREEUROPHYS] and [\cite=PIERRESEMIDIAG] is given.

The Hamiltonian of an electron in an crystal lattice perturbated by the presence of an external electromagnetic field is (e < 0) where [formula] the periodic potential, [formula] and V the vector and scalar potential respectively. Our purpose is this section is to compute the diagonal in-bands energy Hamiltonian for this system to the second order in a series expansion in [formula] This can be done by using the general results of the previous section, in particular with Eqs. [formula]. The major difficulty to find the diagonal representation relies on the fact that in presence of an electromagnetic field, the lattice translation operators [formula] do not commute any more (see [\cite=NIU] and references therein). To deal with this problem it is convenient to express the total magnetic field as the sum of a constant field [formula] and small nonuniform part [formula]. The Hamiltonian can be written [formula], with H0 the magnetic contribution (V being the electric potential) which reads

[formula]

where [formula] and [formula] are the vectors potential of the homogeneous and inhomogeneous magnetic field, respectively. [formula] is the periodic potential. The large constant part [formula] is chosen such that the magnetic flux through a unit cell is a rational fraction of the flux quantum h / e. The advantage of such a decomposition is that for [formula] the magnetic translation operators are commuting quantities allowing to exactly diagonalize the Hamiltonian and to treat [formula] as a small perturbation. The state space of the Bloch electron is spanned by the basis vector [formula] with n corresponding to a band index and [formula] a common eigenvalue of the translation operators. In this representation [formula] and the position operator is [formula] which implies the canonical commutation relation [formula]. Note that here [formula] and [formula], rather than [formula] and [formula] will play the role of canonical variables.

The diagonalization of the Hamiltonian in Eq.[formula] is first derived for [formula] by diagonalizing simultaneously H0 and the magnetic translation operators [formula]. Start with an arbitrary basis of eigenvectors of [formula]. As explained in [\cite=PIERRESEMIDIAG], in this basis H0 can be seen as a square matrix with operators entries and is diagonalized through a unitary matrix [formula] which depends only on [formula] (since U should leave [formula] invariant, i.e., [formula]), such that in-bands energy matrix is [formula], where [formula] is the unperturbated ([formula]) diagonal energy matrix made of the magnetic bands elements [formula] with n the band index.

Now, to add a perturbation [formula] that breaks the translational symmetry, we have to replace [formula] in all expressions by

[formula]

the (band) electron momentum and as the flux [formula] on a plaquette is not a rational multiple of the flux quantum, we cannot diagonalize simultaneously its components Πi since they do not commute anymore. Actually

[formula]

To deal with this non-commutativity, we adapt our method to diagonalize the Hamiltonian perturbatively in [formula]. To start, an outline of the first order diagonalization for the special case of an electron in an crystal lattice perturbated by the presence of an external electromagnetic field considered in refs. [\cite=PIERREEUROPHYS] and [\cite=PIERRESEMIDIAG] is now given.

Semiclassical diagonalization: Generalized Peierls substitution

Following section II, the diagonalization at the lowest order is just obtained by replacing [formula] by [formula] This last matrix would actually diagonalize the Hamiltonian if [formula] in [formula] was a parameter commuting with [formula]). Note that a subtlety arises here (and that we will find again later) in the application in our method. We do not consider, at this level that [formula] and [formula] commute, but only that the [formula] in [formula] and [formula] commutes with [formula]. In other words we assume that [formula] has been replaced by a parameter in these potentials. The reason of this difference with our general set up comes from the fact that the initial diagonalization is not performed for a function of, say, [formula] alone, but both of [formula] and [formula] through the periodic potential. However this difference does not alter our method which allows to recover the contributions of the electromagnetic potential as a series of [formula].

As consequence of our procedure, the non projected Berry connections are [formula] and [formula]. However, it turns out be more relevant to replace [formula] by the covariant momentum [formula] in the physical expressions so that instead of AKl0 we better consider the quantity AΠl0 = eARk0Bmεkml. Remark that the Berry connections just defined are non diagonal and are matrices whose index correspond to interband transitions.

The physical dynamical variables for the n-th band dynamics to the first order in [formula] imply a projection on the n-th band. For the intraband coordinate operator [formula] we obtain

[formula]

and for covariant intraband momentum we obtain in the same manner [formula] which writes also

[formula]

with [formula] and Pn the projection on the n-th band. Remember that previously P+ was the projection on the diagonal elements of a matrix. Using now the general expression for the semiclassical Hamiltonian Eq. [formula], we obtain the desired semiclassical nth-band Hamiltonian (dropping the index n) [formula] as :

[formula]

where [formula] is the unperturbated nth-magnetic band energy in which [formula] has been replaced by [formula] a procedure that we can adequately call the generalized Peierls substitution and which was introduced for the first time in [\cite=PIERREEUROPHYS]. The second term in Eq. [formula] constitutes the electrostatic potential, and the third is the coupling between [formula] and the magnetic moment (or magnetization) which is given: It can explicitly check that this expression of the magnetization is the same than previous expression found with different approaches [\cite=NIU][\cite=Landau].

Dynamical operators algebra and equations of motion

From the dynamical operators a new algebra has to be considered . Indeed we have

[formula]

with [formula] the Berry curvature. Whereas the term of order δB2 in [formula] is usually negligible, it turns out that all terms in [formula] are essential for the correct computation of the semiclassical equations of motion which are

[formula]

where we have defined the vector Θi  =  εijkΘjk / 2. As shown in the following, the generalization Peierls substitution, not only is essential for the correct determination of the equations of motion, but also for the Bohr-Sommerfeld (BS) quantization condition.

Bohr-Sommerfeld quantization

To underline the relevance of the generalized Peierls substitution at the level of the semiclassical quantization of energy levels for an electron motion in an external uniform magnetic, we adapt the arguments of ref. [\cite=PIERREEBS]. For V = 0 the equations of motion Eq. [formula] become

[formula]

with [formula] For convenience [formula] is chosen in the z-direction [formula] the energy reads [formula] Consequently the orbits satisfies the conditions ε0  =  const and πz  =  const. The semiclassical quantization of energy levels can be done according to the Bohr-Sommerfeld quantization rule

[formula]

where [formula] is the canonical pseudo-momentum in the plane perpendicular to the axis πz = cte. The integration is taken over a period of the motion and n is a large integer. Now, it turns out to be convenient to choose the gauge [formula] [formula] In this gauge, one has πz = Pz = cte, and the usual covariant momentum [formula] In this case the BS condition reads [formula] Assuming that the physically relevant variables are instead the covariant ones, writing thus BX = B(x - x) the generalized covariant momentum defined as [formula] becomes

[formula]

which is formally the same relation as the one between the canonical variables, but now relating the new covariant generalized dynamical operators. This relation with the help of the equations of motion Eq. [formula] gives [formula] thus Ky is a constant of motion so that [formula] and Eq.[formula] becomes simply [formula] Now using the definition of the generalized momentum [formula] and the differential of the canonical position [formula] the Bohr-Sommerfeld condition Eq. [formula] becomes

[formula]

where the integral is now taken along a closed trajectory Γ in the π space and [formula] is the Berry phase for the orbit Γ. Integration in Eq. [formula] defines the cross-sectional area [formula] of the orbit Γ which is the intersection of the constant energy surface [formula]const and the plane πz = Kz  =  const. As shown in [\cite=PIERREEBS] S0(ε  =  ε0 - MzB,πz) can then be written as

[formula]

here [formula] is an elementary length of the π orbit. We have thus succeeded to deduce the required result Eq. [formula] (first found by Roth [\cite=ROTH] in a different way and without mentioning the Berry phase), as resulting from the generalized Peierls substitution in the BS condition. The importance in this expression of the Berry's phase for electrons in metal in connection to band degeneracy was later discussed by Mikitik and Sharlay [\cite=MIKITIK].  Eq. [formula] implicitly determines the energy levels [formula]. For instance for the case where the Fermi surface is an ellipsoid of revolution characterized by two effective masses, a transverse [formula] and a longitudinal ml one has

[formula]

and S(ε,Kz) is a disc of radius square [formula]. Therefore for Mz  =  const we have the following generalized relation for the Landau levels: which shows that both the magnetic moment and Berry's phase can influence the energy levels. A nice illustration of this result is provided by electrons in graphene with broken inversion symmetry [\cite=PIERREGRAPHENE].

Second order diagonalization

As explained in section 2, the Hamiltonian diagonalization at this order requires the computation of the Berry connections and the covariant dynamical variables. This will thus be our first task. Note that, from now on, for the sake on simplicity, we will keep the notation introduced in the previous section, [formula].

Computation of the Berry phases and dynamical variables to the second order

Starting from the general expressions for the non projected Berry phases at the second order Eqs. [\ref=Conn2][\ref=conn2A][\ref=conn2B] we have in the present case for [formula] :

[formula]

where now [formula] and the same for [formula]. We aim now at writing the connection [formula] in a more convenient form as an expansion in terms of the zero-order (actually first order in [formula]) [formula] To do so, we first start to express the crystal momentum Berry phase [formula] as a function of the position Berry phase [formula]. The computation of [formula] involves a commutator with [formula] that we compute first. Notice that the first order energy operator ε0 in Eq. [formula] and the Berry connections at the zeroth order depend on [formula] as well as on [formula], which allows us to write the commutator of Km  +  AKm0 with any such operator , e.g. [formula] in the following way : Let us stress that this formula is not valid for the electric potential term appearing in the Berry phase formula since it depends exclusively on [formula]. The action of [formula] on this term has thus to be computed independently. The additional contribution due to the electric field and the magnetic field to the momentum Berry phase is seen easily from the formula for the to be

Now the first term and the last term in the crystal momentum Berry phase can also be replaced as a function of the position Berry phase contribution. But at this point we need to go back to the technicality mentioned in the first section. While the final results do not depend on the way variables are symmetrized, one has to choose an initial symmetrization for the diagonalized energy at the zeroth order as well as for the Berry phase. For the diagonalized energy, we will choose to write it as a series of symmetric monomials in the momentum [formula]. Concerning the Berry phase for the crystal momentum the natural choice is to symmetrize initially the variables such that at the lowest order in [formula] one has [formula]. This will introduce some technical problem later, but it is the most simple choice for us. As a consequence, we obtain readily for the terms of interest :

[formula]

so that can now gather all these terms and compute AKm as a function of ARl :

[formula]

The potential Al being developer to the first order in [formula]. As expected, only the contribution due to the electric term is not rewritten as a function of ARl. The quantity [formula] can be computed on the bands as being equal to :

[formula]

so that we have for the (M,N) component :

[formula]

where we defined the notation MN = 1 - δMN,

As explained before, the relevant variables for the physical expressions are rather the momentum variables [formula]. Since at first order we already had [formula] we would expect a similar formula at the second order. However, since our method has been designed to deal with quantities symmetrized as functions of [formula] and [formula], it appears that the momentum variable does not appear directly in our Hamiltonian. We thus postpone its introduction till the computation of the diagonalized Hamiltonian.

We can now, as a second step, concentrate on the position Berry phase. We rewrite it as :

[formula]

We can also rewrite the third term [formula] component as :

[formula]

Using also, for quantities depending on [formula] and [formula] that [formula] at the lowest order in [formula] we now give an expanded formula for the  position Berry phase at the second order :

[formula]

and its projection on Band N.

[formula]

For later purpose we will need also the modified Berry phase [formula] appearing in the dynamical Band variable [formula]. A direct application of our general set up of the previous section yields.

[formula]

Ultimately, the projected dynamical variables follow directly from our general method of diagonalization. They are given by the canonical variables shifted by the modified projected Berry phases :

[formula]

Note that since [formula] has no diagonal element

[formula]

Band Hamiltonian

We now turn to the Problem of deriving the diagonalized Hamiltonian. As explained in section II, the effective diagonal Hamiltonian for the Nth band can be written (see Eq. [formula] )

[formula]

Where PN is the projection on this band. As explained in [\cite=DIAGOEXACT] this Hamiltonian can be rewritten in a more enlightening way as : Where the magnetization operator M acts on the following way : As consequence, the Hamiltonian is given by a series of magnetization terms acting on the classical Hamiltonian, that is the Hamiltonian obtained for classical commuting dynamical variables. We will more give detailed formula for the various terms as functions of the first order Berry phases, but we turn first to the problem of choice of variables in writing the energy operator.

Momentum variables. Second order generalized Peierls substitution

For the moment, the pair of canonical variables implied by our method are the non physical one [formula]

[formula]

One aims at replacing [formula] by a physical momentum variable which reduces to [formula] at the lowest order. To do so assume the electric potential is set to 0 since it plays no role here, and rewrite the quantity [formula] that arises in the diagonalized Hamiltonian as : so that one would be tempted to choose [formula] as the right momentum variable. However a computation of this quantity yields :

[formula]

While the first three terms are physical since they involve the momentum [formula] and the magnetic field, the last one is problematic since it will involve in the Hamiltonian some symmetric combinations of the vector potential of the kind [formula]. The appearance of such terms is non physical but has nothing surprising here since we ordered all our expressions in [formula] and [formula], not in [formula] and [formula]. As a consequence, we cannot expect in one individual expression to have only contributions of the momentum and magnetic field operators. An other way to understand this problem is to remember our choice of symmetrization for the crystal momentum Berry phase that was easy to handle but does not fit when aiming at rewriting the Hamiltonian in terms of [formula]. Actually, having let the derivatives of the electromagnetic potential half on the left and half on the right automatically induces commutators terms proportional to [formula]. However, we know that the overall process of diagonalization of the initial Hamiltonian has to depend only on [formula], [formula], [formula] so that we know that the symmetric contributions [formula] to the Hamiltonian have to cancel.

This assertion will be checked explicitly for the above problematic term whose contribution (developing [formula] to the required order) is [formula], when diagonalizing the Hamiltonian. Actually we will find a counterpart to it. However, it is unnecessary in general to check the cancellation. These have to vanish by construction, so that we can discard them directly. Their local appearance in individual terms will be discussed briefly while computing the Bracket term for [formula].

As a consequence of this discussion, our relevant variable for the momentum in the Hamiltonian will be : and in the sequel, the relevant couple of canonical variables will be : (the index N being understood).

Magnetization terms

At this order of approximation, and using our expressions for the Berry phases, one can directly develop the expression for [formula] to obtain the following decomposition :

[formula]

where the Darwin term refers to an expression which reveals to be of the same kind as the Darwin term in the Dirac Hamiltonian as we will see soon.

In this expression we have defined

[formula]

These expressions are directly obtained by expanding the magnetization term [formula] and computing the commutators that appear when letting the magnetic field half on the right and half of the left of the relevant expressions. Note at this point that, doing so, some contributions involving [formula] appear that cancel the corresponding contribution arising from the second order in [formula] development of [formula] as announced before.

More precisely, the derivation of [formula] and [formula] is as follows : starting with the term [formula] we have to put the magnetic field half to the left and half to the right in the following way

[formula]

Letting the gradient of the potential to the left or to the right yields the required contribution for [formula] and [formula] is obtained by computing the commutators involving the gauge field. These terms are (we skip PN for convenience and introduced a [formula] to take into account the integral over α) :

[formula]

the projection of the last term

[formula]

gives a contribution that cancel the one we have neglected in the momentum term as announced before. Moreover and this term does not contribute to the diagonal part at our order of approximation.

The last term we are left to compute is then :

[formula]

where we used twice the Jacobi in the last identity to rewrite [formula] and [formula]. While isolating the contribution in the magnetic field, that is proportional to [formula] and introducing PN only the first term in the last identity remains, which yields the first term in the magnetization kl. The contribution [formula] can be disgarded as discussed in the next subsection.

The two last contributions for kl arise from the term [formula] derived before in the expansion of Kl. Inserted in [formula] yields directly the terms announced.

Now, concerning the Darwin contribution, it is given by :

[formula]

Its derivation is straightforward and corresponds to isolate in [formula] the contribution of Kl involving the potential term (see above). At our order of approximation, the [formula] terms reduce to [formula].

The last important magnetization contribution in the Hamiltonian is due to the squared action of the magnetization operator M. This is of second order in field and can be written :

[formula]

Computation of [formula]

The form  for the diagonalized Hamiltonian given in (first equat) is taken from [\cite=DIAGOEXACT]. As explained in this paper the computation of the energy and in particular of the term [formula] has to be performed by assuming a certain kind of symmetrization for the various expressions, that is a way to order the powers of [formula] and [formula] in expressions as ε0. Its value is in fact the track of the initial choice of symmetrization in the diagonalization process. Let us remark first, that since at the lowest order (that is zeroth order in [formula]), only [formula] mixes [formula] and [formula], the term [formula] will reduce to [formula]. Second, and more importantly, let us stress that the final Hamiltonian is independent of this ordering, but this last one is necessary to give a precise meaning to each expression. The bracket term [formula] has in fact to counterbalance different choices of symmetrization and provide ultimately the same diagonalized Hamiltonian.

Concerning the choice of symmetrization between the canonical variables [formula] and [formula] a symmetric form in [formula] and [formula] is in general chosen, such as putting the powers of [formula] half on the left and half to the right. An other choice is a complete symmetrization in [formula] and [formula], that is permuting this to variables in all monomials, all permutations being equally weighted. However, both this type of symmetrization does not fit here since the relevant variable is [formula]. We thus have rather to consider a symmetrization in the gauge invariant variable [formula].  We will compute [formula] in two cases that might be relevant for the applications, depending on the problem at stake.

Assume first for [formula] a completely symmetrized form in the powers of components of [formula]. That is, we will consider [formula] written as a series of terms of the kind  Ψi1i2i3...Πi1Πi2Πi3... symmetrized in the indices ij. This form corresponds in fact to the most general one, not taking into account any spatial symmetry for the problem

The [formula] operation defined in [\cite=DIAGOEXACT] has been recalled in the first section and can be computed explicitly for 0, in the following way :

Start with Ψi1i2i3...inΠi1Πi2Πi3...Πin , Ψi1i2i3... being a completely symmetrized tensor.

Applying the rule given in the first section, the contribution of this term to [formula] is obtained by deriving (that is removing) by some momentum components Πik Πil and inserting [formula]. One gets for this contribution : where the hat recalls that the variable is omitted from the series. Let move the gradient of the potential half on the left and half on the right to gather them by pair. We thus have :

[formula]

the last equality is obtained since Ψi1i2...in is completely symmetric so that the contribution of [formula] vanishes.

As a consequence one has :

As a consequence, with our initial choice of symmetrization, [formula] contains only symmetric contributions. However, as we explained in the previous section, since by construction ultimately [formula] has to depend only on [formula] and [formula] (since [formula] appears as the commutators of the components of [formula]), this symmetric contribution has to find its counterpart in our  previous development of the energy operator. This counterpart is automatically the contributions we discarded before.

However, we can at this point explain a bit more how this works. Roughly, in the diagonalization process, the Bracket of the energy enters in two ways in our method since basically the trick to obtain the diagonalized Hamiltonian is to add and subtract [formula] (see [\cite=DIAGOEXACT], or more explicitly the differential equation in [\cite=SERIESPIERRE]) to two different quantities that do not contain any symmetric term .

The first way comes from developing

[formula]

This term, yields all the relevant contributions to the diagonalized Hamiltonian we derived before. However, due to our initial choice of canonical variables [formula], [formula], the series expansion of [formula] led us also to some contributions proportional to [formula]. They arise because the Bracket operation isolates non physical terms such [formula]. When we recombined them to get magnetic field contributions the [formula] appeared.

The second way comes from developing that will yield the contribution [formula] including its symmetric contributions. But since [formula] and [formula] can be written in terms including only physical variables [formula] and [formula] (both the energy operator and diagonalization process are assumed to depend on these variables), the symmetric contributions of these two terms come only from [formula], and as such cancel by construction.

As a check, one can see that, typically, the contribution arising from [formula] were proportional to [formula] which is exactly the kind of symmetric terms we were left with while computing the magnetization term. But precisely these contributions are by construction equal to those produced by [formula] (since [formula]). As a consequence, [formula] acts in fact as a compensation term, and the overall terms in [formula] is constrained to cancel whatever the form of the Hamiltonian or the Berry phases.

As a consequence of this discussion, we can neglect the symmetric term and keep definitely for the choice of full symmetrization on the momentum components : However, the choice of symmetrizing all powers of the momentum [formula] does not fit when the system presents some symmetries. The Basic example is the Dirac Hamiltonian satisfying rotational invariance, but one can also consider fermi surfaces having some ellipsoidal form. In that case a natural choice of symmetrization can be done with respect to some or several quadratic forms in the momentum of the kind ΠiAijΠj (typically for the Dirac case Aij  =  δij). To inspect this case, we will thus compute [formula]  when [formula] is written as a series expansion of products and powers of such quadratic forms ΠiAijΠj. To do so, we develop [formula] as a symmetrized series of monomial terms of the kind [formula]. The [formula] and [formula] being shortcut for ΠjAij and ΠiBij with Aij and Bij some quadratic forms arising in the expansion. C, D, [formula] are arbitrary. Note at this point that implicitly, [formula] has to be considered as part of a sum of four symmetric terms obtained by permuting [formula] and Πi, Πj and [formula], that is [formula]. For the sake of simplicity we only keep [formula], the symmetrization being implicit and we skip the terms C and D that play no role in the sequel. [formula] contributes to [formula] by deriving (that is removing) Πi Πj and inserting [formula] (the sums over the indices i,j is understood):

[formula]

We can gather the potential terms by putting them half to the left of Q and half to the right of Q. We can thus write this term at order 2 (which is enough for us here given our order of approximation)

[formula]

To the order 2, the terms [formula], once summed over the symmetric monomials, involve all the possible permutations of εjikBk inside the series expansion of the second derivative of 0. As a consequence, we can write : As explained just before, it is understood that Bk is inserted in a completely symmetric way inside the series expansion of [formula] (that is cyclically permuted inside the series).

Moreover, we can again discard the symmetric terms [formula].

We thus have with this choice of symmetrization :

We will conclude this section by obtaining a developer form for [formula]. It is performed by going back to its series expansion. Let us assume in a first time that 0 is a function of [formula] only (rotational invariance), so that we can choose a natural symmetrization to express [formula] as a power series of [formula].

The sum of monomials of the kind can be written (we now reintroduce our implicit permutations that let Bk to be half on the left and half on the right of [formula] and [formula]) :

[formula]

Letting move the magnetic field half to the left and half to the right yields to the order 2 yields :

[formula]

Concentrate on the first term. One has

[formula]

to the order 2. Now,

[formula]

Summing over the symmetric monomials of the series expansion of 0 , each of this commutator will yield a corresponding contribution to [formula]. The first commutator will yield the contribution :

[formula]

the global [formula] amounts for the fact that given our conventions the derivative with respect to Πi are always on the left of the derivatives with respect to Πj. This implies a [formula] factor each [formula] term. We have also used the fact that given the rotational invariance [formula] and [formula] can be replaced by [formula]. Actually the commutator [formula] amounts for taking twice the derivative with respect to Πi and Πj (times εijkBk) and twice the derivative with respect to Πi and Πj yield each a contribution proportional to [formula]. On the other hand the second commutator will lead to the contribution :

[formula]

with the implicit convention, recalled by the [formula], and implied by construction and the definitions of [formula], Πi, Πj), that a factor [formula] that has been derived by [formula] will not be derived again by [formula] (the same convention applying of course for [formula]). Similarly [formula] means that a power of [formula] is not derived twice by Πj.

The reason for the global [formula] factor is the same as before, the derivatives with respect to Πi being on the left of the derivatives with respect to Πj. A [formula] factor has also arisen from the fact that the derivative with respect to Πl has to be taken between the derivatives with respect to Πi and Πj. Due to the symmetrization of the variables, it amounts for only one third of the derivative with respect to Πl.

Similarly, the last term will give :

[formula]

with the same convention as before for the derivatives.

Ultimately, we compute similarly the contribution :

[formula]

Gathering all the relevant terms yields in the end :

[formula]

A direct computation shows that specializing to the case of the Dirac Hamiltonian in an electromagnetic field, will be given in [\cite=PIERREDIRAC].

The more general case can now be treated in a very similar way. Coming back to the general form for the monomials, leads to consider again the monomials [formula]. Here to alleviate the notation we assume again implicitly that Bk is put half on the left and half on the right of [formula] and [formula]). the contribution to move them on the left of [formula] and the right of [formula] leads to a similar contribution to [formula] as before : [formula] Concerning the other terms, we recombine the monomial [formula] with the corresponding contribution [formula] (the εjikBk being implicitly half on the left and half on the right of the expressions):

[formula]

As before, summing over the symmetric monomials of the series expansion of 0 , each of this commutator will yield a corresponding contribution in derivative of 0. The first commutator in [formula] is computed in the following way. The rotational invariance does not exist anymore now, but [formula] and [formula] are still functions of [formula]. As such they will yield the contribution :

[formula]

Once again, the global [formula] amounts for the fact that given our conventions the derivative with respect to Πi are always on the left of the derivatives with respect to Πj.

Similarly, the second and third commutators will lead to the contribution :

[formula]

with again the implicit convention, recalled by the [formula] and implied by construction and the definitions of [formula], [formula], [formula]), that the derivatives [formula] and [formula] are not applied on the same quadratic term ΠiAijΠj in the series expansion of 0. [formula] is a notation to recall that [formula] act both on the same quadratic term,

Gathering all the relevant terms yields ultimately for the general case :

[formula]

Final form for the Band Hamiltonian

Gathering all the previous terms, and writing [formula] as a completely symmetrized series in the powers of the momentum (in the lack of any a priory symmetry), we have ultimately the diagonalized Hamiltonian :

[formula]

The double scalar product [formula] meaning that the two index tensor [formula] being contracted twice with [formula].

Example : Darwin term for the Bloch electron

We now consider more specifically what we have called the Darwin term. Its interpretation turns out to be more transparent when B = 0, therefore we keep here only the electrostatic potential. In this case, we have and AKl0 = 0 as shown in [\cite=PIERREEUROPHYS] but at the second order we have the following contributions and showing that the non diagonal part of [formula] is non null. It will lead to a magnetization term : the Darwin term. We can write :

[formula]

and the projected variables :

[formula]

Therefore the Hamiltonian is :

[formula]

with : which reduces to

[formula]

This is an interaction in second derivative of the potential, Darwin type.

The effective in-bands Hamiltonian Eq. [formula] is the desired result concerning one Bloch electron in an external electromagnetic potential and will be very useful for the latter computation of the effective Hamiltonian of several Bloch electrons in self-interaction. But at this point it necessary to compare if it is possible with previous approaches in particular with Blount's one.

Comparison with previous results

In a powerful series of paper, Blount [\cite=Blount][\cite=Blount1] designed a method to derive the diagonalized Hamiltonian both for a Bloch electron in a constant magnetic field and the Dirac electron in an arbitrary magnetic field as series expansion in powers of the fields. In both cases, at the first order in [formula] our results coincide with his ones. At the second order, the direct comparison for the Bloch electron is difficult to do, since Blount's choice of variables (the canonical ones) differs from ours. However, the comparison in the particular case of the Dirac electron (2 bands Hamiltonian) can be performed and will be explained in detail in [\cite=PIERREDIRAC]. The result is that, despite some important similarities, our results differ slightly From Blount's ones.  Actually some mistake arise in his results due to his choice of variables, which induces wrong expressions for the Berry curvature, and as a consequence, in the Hamiltonian. As a consistency check we have shown in [\cite=PIERREDIRAC], that at order [formula], we recover the usual Foldy-Wouthuysen formula for diagonalized Hamiltonian of the Dirac electron in an electromagnetic field. This is apparently not the case in [\cite=Blount1] where the coefficient of the squared magnetic field is apparently incorrect.

Interacting Bloch electrons

Having found the diagonalized Hamiltonian of a one particle system, we can now focus on the multiparticles Bloch electrons in interaction. In this context we must consider the interaction mediated by the Coulomb interaction. Although this last one dominates the magnetic interactions, it is known that, for material whose electrons have a non vanishing magnetic moment, new effects such as interaction between the moments mediated by the magnetic field can have important effects. For this reason, we are now interested in investigating the diagonalization of the Hamiltonian of several electrons in self-interaction through the full electromagnetic field. However, for practical reasons and to deal with tractable formula, we will restrict ourselves to the case of relatively small interaction.

Derivation of the microscopic Hamiltonian

To start , we will derive the microscopic classical Hamiltonian for this system, before going to the quantum version. Note that the electromagnetic field will always be considered as classical and only the particles will be treated at the quantum level. Let us introduce the non relativistic Lagrangian of P particles self-interacting through the electromagnetic field and moving in a periodic potential Vp which is the only external potential: Here Fμν is a classical electromagnetic field whose potential is [formula], e are the particles charges. The current [formula] is given by [formula] and J0 is the density of charges, [formula].

Choosing a gauge for the electromagnetic field, for example the Coulomb gauge (see [\cite=Weinberg] ), some computations lead to write the particles and field Hamiltonian as

[formula]

with Πem the solenoidal part of the electromagnetic momentum defined by [formula] satisfying the constraint [formula] [\cite=Weinberg]. [formula] is the usual canonical particle momentum. Using also our definition for [formula], we are thus led to :

[formula]

Recall that [formula] stands for the periodic potential. Note also that, given that the particle density is a sum of delta function centered around the particles positions, the potential [formula] reduces to : However, we will not use this solved form right now and rather keep the electromagnetic field [formula] (see below).

The previous expression is desired Hamiltonian for P classical electrons in interaction and in a periodic potential. It will be the starting point for the quantification and for the computation of the effective in-bands Hamiltonian to the second order in [formula] This order is required to determine the magnetization-magnetization interaction in the same way that the spin-spin interaction in the Breit Hamiltonian for Dirac particles [\cite=BREIT]. The consideration of interacting electrons, each of them being constrained to be in a single band, will require the Hamiltonian diagonalization and the projection on each respective band. To do so we just have to apply the method developer for the one particle scheme.

Remark, at this point that the Hamiltonian could be further simplified by using the Coulomb gauge condition which allows to replace directly the potential A0. Actually, as a consequence of the Coulomb gauge constraint one has [formula]. However, for the sake of symmetry we aim at treating the electrostatic potential as an external field, as we do for the vector potential, and to replace it after transformation. We will explain later why this is in fact simpler and innocuous for the final result.

Diagonalization process

We will now diagonalize our Hamiltonian to the second order in [formula] as before. The space of states acting is the tensor product of P copies of the individual spaces [formula] with the Hamiltonian Eq. [formula] in which Vp is the periodic potential, [formula] is the potential created by the other charges on charge α and [formula] the electrostatic potential involving the particle α.

The Hamiltonian H is diagonalized at the second order in [formula] in a straightforward way. Using our previous experience with the one electron, consider : Where [formula] are the individual particle diagonalization matrix found in the previous section to the first order in [formula]. Note that this matrix do no act on the electromagnetic field, whose integration variable x is independent from the quantum mechanical operators [formula], [formula]. This is the usual procedure for this kind of system. We first diagonalize the part of the Hamiltonian which describes the particles dynamics and leave the electromagnetic field untouched (see for instance Feynman's book for this procedure [\cite=FEYNMANBOOK]). This is essential in order to have each particle living in a particular energy band. It means that we assume here an adiabatic process in which the electromagnetic interaction does not cause interband jump. If we were eliminating straight the electromagnetic field in the initial Hamiltonian Eq. [formula] with the help of the Maxwell equations, we would of course get an equivalent Hamiltonian for particles only, but it would automatically mix all the energy bands. Then the possibility to assume an adiabatic process and to project each individual particles Hamiltonian on a specific band would be lost.

Therefore we will choose the first route and after the diagonalization one will solve the Maxwell equations which will determine the exact form of the particle currents. These last ones will then be further injected into the Hamiltonian to get the final in-bands effective Hamiltonian of the particles. Let us show how this procedure works.

From Eqs. [formula] the Hamiltonian in the diagonal representation of the particles part is thus directly :

[formula]

The notations of the previous section have been kept, adding only the superscript [formula] to label the particles in Eq. [formula]. For example, [formula] is the couple of dynamical variables for the particle [formula], [formula] and the Berry phases [formula], [formula] involved in these operators have been computed in the single particle section. Notice also that N is a shorthand for the multi-index [formula] recalling that the Hamiltonian describes P particles respectively in the bands [formula]. Ultimately [formula] is the field acting on particle α.

Effective Hamiltonian for P particles and particles currents:

Our aim is now to  replace the electromagnetic field in the Hamiltonian as a function of the dynamical variables of the particles system. We first do so by solving the Hamiltonian equations for the electromagnetic field in the limit of relatively weak interactions.

Dynamics for the Electromagnetic Field

To get rid of the electromagnetic field and writing an interaction Hamiltonian for the particles, we first focus on the vector potential and start with the Hamiltonian equation for the electromagnetic field in the Coulomb gauge [\cite=Weinberg] :

[formula]

where Hmat denotes the matter part (that is excluding the free part of the electromagnetic field Hamiltonian). Using the gauge constraints : [formula]. we are led to : where [formula] stands for the functional derivative with respect to [formula] .

Explicit expression for the current

We aim now at writing a more explicit formula for the effective current [formula]. To do so, we decompose Hmat as :

[formula]

where [formula] stands for the Darwin term :

[formula]

The computation of [formula] has to be performed carefully since the dependence in the gauge field in Hmat is intricate. We aim at computing it as a function of the physical variables [formula], [formula] and not as a function of the initial microscopic canonical variables. However, the physical variables [formula], [formula] depend on the value of the fields evaluated at the microscopic positions and momentum.

[formula]

to turn this difficulty we reintroduce the variables [formula], [formula] recursively in our Berry phases.

Starting with [formula], at our order of approximation and using [formula] :

[formula]

(we have neglected the terms in [formula] that do not appear at order 2 and skipped the index N for the sake of simplicity). We do the same thing for the momentum by starting to write it as a function of [formula], [formula]. Given the definition of the momentum, we explained before that it was not given by [formula], but rather [formula]. It was explained that this variable had a physical meaning (the subtracted term was there to compensate a non gauge invariant term).  This last term cancels one term in the Berry phase for [formula]. As a consequence,

[formula]

Actually, as seen on their definition, the variables [formula] and [formula] depend on [formula]. Rather than solving these circular equations where the variables of interest appear on both side as functions of the canonical variables [formula], [formula] we rather unsolved the dependence of the variables in [formula] and keep this circularity to compute the derivatives of interest, since it will allow to express all the results as functions of the variables [formula], [formula].

Keeping this in mind, we start by considering a simple example that will allow to find some general rules for the computation of the functional derivatives with respect to the gauge potential. Let G be a function depending on a variable x (in our context [formula], [formula]) depending itself on a function a of x (here the gauge field) through the relation [formula].

We aim at computing first [formula] where y is an independent variable (i.e. the space parameter in our context).

Start first with [formula] : It would be wrong to conclude that [formula] reduces to [formula] because y is an independent variables but x is not and depends on a. One rather has to consider that [formula] is an infinite series of composition [formula] and so on. A slight functional variation of a propagates along all the series and has to be taken into account to write symbolically the infinite series :

[formula]

where the inserted δ acts solely on the a directly on its right. The variation [formula] can be rewritten as : where now x can be seen as a frozen variable (that is not depending on a) everywhere in the right hand side. A direct application of the chain rule yields directly : so that : and ultimately : Of course, this expansion is formal, and assumed to converge. Moreover, in the sequel the sum will always be truncated to a finite order.

We can now translate this results in our context to compute the derivative [formula] since it involves only a generalization to several variables. The formula are a bit more involved since the circularity depends on three variables. Actually [formula] depends on [formula] through the Berry phase, [formula] depends on [formula], that depends on [formula]. products like [formula] will be now replaced by products of three types of derivatives, [formula], [formula], [formula] [formula]. However, a simplification arises here. Actually, since the beginning, we have assumed that the magnetic part of the interaction between the particles is relatively weak with respect to the electrostatic potential. We will thus assume that the current is relatively weak, and the expansion will be performed only at the first order in the field. As a consequence, at this order of approximation, it is useful for the sequel to note that the composition series for [formula] reduces to [formula].

Introducing the needed indices, taking into account this approximation and going to the second order in [formula] we are led to the following results for the various terms involved in [formula] :

[formula]

and and also

[formula]

These expressions involve some derivatives that are computed as follows, as directly implied by our previous remarks. [formula], [formula] cover the dependence of the transformed dynamical variables in [formula]. Recall that they have to be computed such that in [formula], the [formula] is frozen, so that [formula] is seen as an ordinary, or independent variable.

Starting with [formula] the dependence in the field comes from the Berry phase of [formula], [formula][formula] which is a function of the two variables [formula] and [formula]. We can thus write : the second term in the right hand side is of order 3 since [formula] is of order 2 and [formula] is of order [formula]. At order 2 one thus has : Practically, the partial derivative [formula] with respect to the field is obtained by decomposing :

[formula]

and [formula] is carried by the following term computed previously in the one particle case :

[formula]

[formula] is a two tensor whose components [formula] is given by : [formula]

[formula]

and the gradient acts on [formula].

Having given some expanded formula for [formula] it thus remains to compute [formula]. To do so, recall again that the variable [formula] is frozen with respect to [formula], which is thus thought as an independent variable. We use also our previous result on the Berry phase :

[formula]

Define also [formula][formula][formula] so that one has :

[formula]

to our order of approximation.

We can rewrite the last equation as : which is solved to the second order in [formula] and first order in field by :

[formula]

the gradient appearing at the end of the right hand side has to be understood as acting on the delta function [formula] in the expression for [formula].

Solution for the Electromagnetic Field

With the current at hand, it is now possible to find the expression for the electromagnetic field as a function of the particles dynamical variables. However, note that in the expression for [formula] the electromagnetic field appears everywhere through the Berry phases and explicitly through the magnetic field. This means that in fact reinserting [formula] in the expression for [formula] allows only to compute this last potential perturbatively. Assuming, as before that the current is relatively weak, the right hand side can be expanded at the first order in the field. The expressions depending on the field can be put to the left of the Maxwell equation. which can be now written : with :

[formula]

The operator [formula] will in fact yields negligible contributions in our applications. We give nevertheless its form in the appendix for the sake of completeness. Note that the correction [formula] to the Dalembertian are of order 2 due to the definition of the terms involved.

As a consequence, we can thus write for the electromagnetic field : with :

[formula]

A more tractable for the effective Green function [formula] can be found if we move to the Fourier transform. Actually, one can write :

[formula]

and the operators [formula] δO,δG are given in Fourier components by :

[formula]

and the Fourier transform [formula] is given in the appendix.

Now that we have given the effective photon propagator, note that we can decompose the vector potential at order 2 at a point [formula] :

[formula]

where Mefl is the effective magnetization differential operator : and the current [formula] is given by :

[formula]

In [formula] recalls that the gradient is taken with respect to the variable [formula].

Electromagnetic part of the Hamiltonian

We can now compute the Hamiltonian for the electromagnetic field as :

[formula]

where the effective propagator [formula] is given through its Fourier transform : with :

[formula]

If we neglect the retardation effect, which is legitimate since we work in the non relativistic limit, we can discard the dependence in ω, so that : and :

Electric potential

Now, the case of the electrostatic potential is a bit peculiar. As we said before, we replace it through the potential equation in the Coulomb gauge : [formula], so that

[formula]

Considering [formula] alone, one has first :

[formula]

where [formula] is the usual Coulomb interaction. The same token is applied to the derivatives of [formula] appearing in the Hamiltonian, so that the part involving the electrostatic potential can be written :

[formula]

We can now come back to our previous remark about the replacing the electrostatic potential before or after diagonalization. Had we chosen to replace this potential before applying the diagonalization procedure would have in fact led to the same contribution to the Band Hamiltonian. Actually, it is straightforward to check that this early replacement would have led to consider the potential [formula] in the Hamiltonian (and no more the potential v). This expression mixing the particles at an early stage would have altered the diagonalization process. Actually, the diagonalization matrix wouldn't have been the simple tensor product of individual particles diagonalization matrices, but would have mixed the various spaces at first order in [formula]. The result would be, at the order 2, in crossed contributions in the Berry phase for [formula] (not for [formula] as can directly been checked). Namely, the Berry phase for [formula] would acquire a supplementary contribution proportional to [formula]. Given our generalized results for the Diagonalized Hamiltonian, this term will not contribute to the Band Hamiltonian nor to the dynamical operators at order 2. This is the reason why we choose to treat the electrostatic potential in a less rigorous, but symmetric with respect to the vector potential, way.

P particles Hamiltonian

We can now gather all our results to obtain the final form for the Hamiltonian

[formula]

Application : Hamiltonian at the lowest order

We have seen in the previous section that, due to the complexity to the Maxwell equation, the Full Hamiltonian to the order 2 cannot be computed exactly but has in fact to be computed as a power series in the current. The Formula we gave included first order corrections for the Green function. Here, to give an application of our method we will neglect these first order corrections and consider the Hamiltonian at the lowest order in current, that is quadratic in current. We will see that it will result in a kind of generalized Breit Hamiltonian, including magnetization-magnetization interaction. To do so, we divide our work in two steps. First computing the Hamiltonian without electromagnetic interaction and second including the electromagnetic corrections.

Coulombian interaction

If we neglect, the magnetic interactions, three simplifications arise. First, we can cancel all contributions to the magnetic field. Second, in the first order Berry phases, [formula] is null, except if α  =  β. As before, we will note [formula] the zeroth order Berry phase, keeping in mind there are no crossed terms. Third, the crystal momentum dynamical variables are unchanged through the transformation. Thus [formula]. The Hamiltonian reduces thus to :

[formula]

where the dynamical variables in that set up are given by :

[formula]

with

[formula]

Electromagnetic interaction at the lowest order and magnetization-magnetization interaction

We now turn to the electromagnetic part of the interaction in our Hamiltonian for P particles. It is found by isolating, at the second order in the current the interaction terms particles-electromagnetic field  plus the internal Field Hamiltonian.

In the non relativistic limit which is of interest for us, it takes the form :

[formula]

Moreover, in first approximation, [formula] can be approximated by [formula] so that

[formula]

As seen before, the current decomposes as : (we have used the fact that in the definition of the magnetization, the gradient of a delta acts as minus a derivative) where the magnetization Mefi and the current [formula] is given by :

[formula]

with [formula] is the particle α individual particle magnetization, and

[formula]

ultimately, as seen in the previous section [formula] can be replaced by [formula].

These formula allow to derive directly the potential and the magnetic field in our approximation :

[formula]

We can now compute the various terms appearing in [formula]. The first term, involving the magnetization is given by :

[formula]

The gradient, in all these expressions and in the sequel, is understood as acting on the first variable (here [formula]).

The second relevant term is the energy of the internal magnetic field :

[formula]

We gather these two contributions to get :

[formula]

The last term of interest for us, can be developer in the following way :

[formula]

The first equality is implied by construction of [formula] since this last quantity was precisely defined as [formula] .

We can now use the following facts :

[formula]

Reintroducing the effective individual magnetization operator as : one can rewrite ultimately at the order 2 :

[formula]

Note here that the double scalar product involving the 2 tensor [formula] is performed on each of its indices separately.

The interpretation of the various terms can done by comparison to the very similar  Breit Hamiltonian for the Dirac electron. Given the current is decomposed in two parts due to the velocity of the particles and their magnetization, the magnetic part of the Hamiltonian is mainly a current-current interaction. The first term is the usual current-current interaction involving [formula] only, whereas the second term mixing [formula] and the magnetization of other particles is a magnetization-orbit coupling between different particles. This interaction is formally similar to the spin-orbit interaction term, except that here we are here in a non relativistic context, and that the magnetization arise as a band phenomenon. The third term is for the magnetization-magnetization interaction term which is formally similar to the spin-spin interaction term. The two last terms are new with respect to the usual Breit Hamiltonian. The fourth one is again a magnetization orbit coupling but of higher order, since it involves triples of particles. The last term is a correction to the energy due to the development to the second order of the free energy. It is a shift of the individual particles energy operator due to the field created by other particles. It should be present in the Breit Hamiltonian but is in fact neglected while considering the quantum field derivation of this last one since it is of order higher than [formula] for the Dirac case ( [\cite=Landau1]).

Full Hamiltonian

Since our development was in the second order in the currents we can simply gather the magnetic part and the electric part of the Hamiltonian to obtain ultimately the full P particles Hamiltonian :

[formula]

with :

[formula]

Recall at that point that we have performed a development in currents (or field) to the lowest order. As such in all our expression the electromagnetic field is set to 0. As a consequence, the variables [formula], [formula] are computed with [formula].

The dynamical variables are thus given by :

[formula]

Apart from the magnetic part of the Hamiltonian, already discussed, we have included the usual electrostatic part, as well as the Darwin term, which is analogous to the eponymous term in the Breit Hamiltonian. Note however that this term in our context is not only a contact term (i.e. of Dirac delta type) since its form depends ultimately on the form of the Berry phases that depend on the structure of the system at stake.

Let us also remark ultimately that the expansion performed, is different from the one chosen in [\cite=Landau1] to derive the Breit Hamiltonian. Actually, the derivation of this last one through the context of quantum field involves a power expansion in [formula], which is in fact performed at the second order.

Conclusion

The diagonalization of the Hamiltonian for a Bloch electron in a magnetic field is an old problem is solid state physics initiated principally by Blount [\cite=Blount], who developed a general procedure for the removal of the interband matrix elements based on a asymptotic series expansion in the fields strength. In this way, the actual effective one-band Hamiltonian was obtained to the second order in the magnetic field. In this paper,we came back, in a way, to this old problem, but by trying instead to derive an in-band Hamiltonian as a series expansion in the Planck constant. A first attempt in this direction was done when we provided a procedure at order [formula] for an arbitrary matrix valued Hamiltonian [\cite=PIERRESEMIDIAG]. This method resulted in an effective diagonal Hamiltonian in terms of gauge-covariant but noncanonical, actually noncommutative, coordinates. It has also revealed  that a generalized Peierls substitution taking into account a Berry phase term must be considered for the semiclassical treatment of electrons in a magnetic field [\cite=PIERREEBS]. In particular, the Bohr-Sommerfeld quantization condition when reformulated in terms of the generalized Peierls substitution leads to a modification of the semiclassical quantization rules as well as to a generalization of the cross-sectional area derived by Roth [\cite=ROTH]. Soon later, the semiclassical diagonalization was extended to any order, when we developed another method of diagonalization where [formula] was considered as a running parameter. This method allowed us to solve formally the problem in terms of a differential equation for the diagonal Hamiltonian with respect to Planck constant [formula], which could, in principle, be solved recursively by a series expansion in [formula] [\cite=SERIESPIERRE]. As an example, the energy spectrum of a Bloch electron in an electric field was derived to all order in [formula] However, in the presence of a magnetic field, the differential approach beyond the semiclassical turned out to be very complicated.

In this paper, we solved the Hamiltonian diagonalization for a Bloch electron in an electromagnetic field to the second order in [formula] by applying a radically different procedure, which was recently developed and provides a general diagonal expression for any kind of matrix valued Hamiltonian [\cite=DIAGOEXACT] (this diagonal expression is also solution of the differential equation of [\cite=SERIESPIERRE]). The main advantage of our method with respect to Blount's procedure is obviously that our result is valid even in the presence of strong external electromagnetic fields. But a second important advantage with an expansion in [formula] is that it allows us to consider particles in interaction. Indeed, although the removal of the interband matrix elements to the second order in [formula] for a Bloch electron is important in itself, the principal objective of this paper was the determination of the effective Hamiltonian of interacting Bloch electrons living in different energy bands. As we have shown, even if the electrostatic interaction dominates the magnetic one, effects like magnetic moment-moment interaction mediated by the magnetic part of the full electromagnetic interaction requires a computation to second order in [formula]. Comparison with other methods is difficult because to our knowledge other results for interacting Bloch electrons do not exist. Nevertheless because of the strong analogy with the Dirac equation it is possible to try a comparison with the Breit Hamiltonian for the Dirac electrons [\cite=BREIT]. As for Breit, we found that the electronic current is made of two contributions: one comes from the velocity and the other is a magnetic moment current similar to the spin current for Dirac [\cite=PIERREDIRAC]. It is this last one which is responsible for the magnetic moment-moment interaction similar to the spin-spin interaction for Dirac. Another important interaction revealed by our approach is the moment-orbit coupling by analogy with the spin-orbit one. From the results of this paper, our goal in the future is to consider the physical relevance of interactions bringing into play magnetic moments.

Appendix

Since the right hand side of the Maxwell equation involves [formula] the operator [formula] acts on [formula] as : where the operator [formula] is obtained by isolating in [formula] the linear term in the electromagnetic potential. Collecting the relevant terms yields directly :

[formula]

The Fourier transform of this operator is straightforwardly obtained as being equal to :

[formula]