The rank-level duality for non-abelian theta functions

Introduction

Let C be a smooth complex projective curve of genus g  ≥  1. The Jacobian variety [formula], parametrizing degree 0 line bundles on the curve C, comes equipped with a Theta divisor, unique up to translation. For any line bundle M on C of degree [formula], the divisor Θ1,M is given set theoretically by

[formula]

The sections of higher tensor powers O(lΘ1,M) of the associated Theta line bundle are the well-studied theta functions of level l.

The non-abelian version of this setup replaces the Jacobian by the moduli space U(k,d) of semistable bundles of rank k and degree d. In the particular case when [formula], the moduli space [formula] carries a canonical Theta divisor Θk. On the stable part of the moduli space, Θk is supported on the jumping locus

[formula]

Since [formula] is locally factorial [\cite=DN], this divisor corresponds to a line bundle also denoted Θk. The context will unambiguously indicate throughout the paper whether we refer to the divisor or to the associated line bundle. To construct Theta divisors for arbitrary degree, consider first a vector bundle M of rank r on C with slope

[formula]

This numerical condition is equivalent to

[formula]

Letting

[formula]

be the tensor product map, we define the line bundle

[formula]

Θk,M has a canonical pullback section which, on the stable part of the moduli space, vanishes on the jumping locus

[formula]

For a generic choice of M, the vanishing locus [\eqref=thetam] is a divisor on U(k,d) [\cite=RT].

The same construction produces Theta divisors on the moduli space SU(k,Λ) of semistable bundles with fixed determinant Λ. The associated line bundles only depend on the rank of the bundle M used in the definition. When M has minimal possible rank, the corresponding line bundle θk is an ample generator for the Picard group of SU(k,Λ) [\cite=DN].

The generalized (i.e., non-abelian) theta functions (of rank k and level l) are the global sections of l-tensor powers Θlk of the Theta bundles Θk. They are conjectured to be related by a "strange duality" isomorphism which interchanges the rank and the level. The duality is defined via the tensor product map

[formula]

given by

[formula]

It is easy to prove using the see-saw principle that

[formula]

The canonical section of the line bundle Θkr determines by pullback an element of

[formula]

In turn, this induces the strange duality morphism [formula], well defined up to scalars,

[formula]

It has been conjectured that [formula] is an isomorphism. In the mathematics literature, the conjecture is stated in [\cite=Bea], [\cite=DT]. Its first supporting fact is that the dimensions of the two spaces, given by the Verlinde formula, can be explicitly seen to be the same. Proofs of the duality in particular cases can be found in [\cite=Bea1], [\cite=BNR], [\cite=l], [\cite=vGP], [\cite=P]. Most notably, P. Belkale [\cite=Bel] recently established the isomorphism [\eqref=sd] for generic curves. On the other hand, the physics literature - for instance [\cite=NS] and the references therein - places the discussion in the context of conformal blocks and the Wess-Zumino-Witten model. Indeed, the representation theory of affine Lie algebras seems to be a natural home for such rank-level dualities, and statements of related flavor have been formulated in [\cite=F].

In this paper, we prove first a more extended rank-level duality, which holds for all curves, and relates nonabelian theta functions on moduli spaces of bundles with varying determinant. We will show

Let L and M be any two line bundles of degree [formula] on C, and let K be the canonical bundle of C. Then there exists a rank-level duality isomorphism between the spaces of global sections

[formula]

Here

[formula]

are the morphisms taking bundles to their determinants.

The theorem, in conjunction with a restriction argument involving the geometry of the classical theta functions on the Jacobian [formula], gives the following important strengthening of the main result of [\cite=Bel].

The strange duality morphism [formula] is an isomorphism for all curves C. theorem

The morphism [formula] will be defined in Section 2. We briefly describe it here in the simplest case r  =  k  =  1. Let

[formula]

be the isogeny given by

[formula]

and let

[formula]

denote the multiplication by ( - 1) in the Jacobian. An immediate application of the see-saw principle proves the isomorphism

[formula]

Then, the canonical pullback section of [formula] determines the duality morphism

[formula]

Let us remark that [formula] can be explicitly diagonalized by a particular choice of a Theta-basis. While the general theory applies to arbitrary abelian varieties, hence to any Jacobian, we will assume here, for simplicity of notation, that C = Eτ is an elliptic curve with complex modulus τ, and that L and M coincide and correspond to the point [formula] of Eτ. In this case, Θ  =  Θ1,L has the canonical section

[formula]

The above discussion shows that [formula] is determined by the section

[formula]

Different explicit tensor product decompositions of this section in terms of various bases of level 2 theta functions are known as addition formulas ([\cite=LB], page 208). For instance, if we let

[formula]

be the scaled translate of θτ0,0(z), then

[formula]

form a basis for the level 2 theta functions. The corresponding addition formula is [\cite=M]:

[formula]

Therefore, [formula] is a multiple of the identity in the above theta basis. The reader is probably aware of the many companion addition formulas [\cite=M]; they determine different matrix representations for the duality map.

The setup of Theorems 1 and 2 easily generalizes to the case of arbitrary degree. Specifically, we let d and r be coprime integers, and h, k be any two non-negative integers. In addition, we fix a reference bundle Q of degree d and rank r. Then, imitating the construction leading to [\eqref=sd], we obtain a morphism

[formula]

The explicit definition of [formula] is contained in the last section of this paper. There, we describe first an extended duality morphism, showing

There is a rank-level duality isomorphism [formula] between the spaces of global sections

[formula]

[formula]

As a corollary, by restriction to the moduli space with fixed determinant, we confirm the following conjecture of Donagi-Tu [\cite=DT].

The rank-level duality map [\eqref=sdd] is an isomorphism.

Let us briefly outline the structure of our proofs. When the degree is 0, upon checking equality of dimensions for the two spaces of sections involved, the central part of the argument will show that the duality morphism [formula] of Theorem [\ref=main2] is surjective. The general strategy is similar to the approach taken in [\cite=Bel]. There, the analogous question for the original strange duality morphism is rephrased as a counting problem for bundles with certain numerical and cohomological properties. The enumerative problem is first set on a rational nodal curve, and its solution is then moved to neighboring smooth curves of genus g, hence the requirement that C be generic. The main observation of the current paper is that the study of the new duality morphism [formula] leads to an enumerative problem which can be effectively solved without specializing the curve. For any smooth C of genus g one relies instead on a strikingly simple interpretation of the Verlinde formula providing the dimension of the space of generalized theta functions

[formula]

in terms of counts of maps from C to the Grassmannian G(k,r + k). This recasting of the Verlinde formula is due to Witten [\cite=witten], who used physical arguments to relate the sigma model of the Grassmannian to Wess-Zumino-Witten theory. More precisely, the above Verlinde number is a top intersection product on the Grothendieck Quot scheme [formula] of rank k subsheaves of the trivial bundle of rank r + k. This intersection product is realized geometrically by points in the Quot scheme, corresponding to stable quotients with the numerical and cohomological properties needed to prove the surjectivity of the morphism [formula]. That the strange duality morphism [\eqref=sd] is an isomorphism will be shown by restricting [formula] to the moduli space of bundles with fixed determinant.

We follow a similar strategy to establish Theorems [\ref=arbdegree] and [\ref=arbsd]. We rely foremost on an explicit elementary expression for the Verlinde formula valid in arbitrary degree. Since this seems to be less known than its degree 0 analogue, found for instance in [\cite=Bea], we decided to record it in the last section of the paper.

The paper is organized as follows. In the next section, we define the modified duality morphism [formula] and prove that it is an isomorphism, thereby establishing Theorem 1. The argument uses the main enumerative result of Section 3. There, we realize the Verlinde number as a count of points in the Quot scheme. In the fourth section we prove Theorem 2, the original strange duality conjecture, via a general argument on the Jacobian. Finally, the last section discusses the strange duality isomorphism in arbitrary degree.

Acknowledgements. We are very grateful to Prakash Belkale for his interest in this work, and for enthusiastic and extensive email correspondence. This paper draws inspiration from his article [\cite=Bel]. We thank Mihnea Popa for helpful and stimulating conversations on the subject of strange dualities.

A new rank-level duality map

In this section we give a precise definition of our new rank-level duality morphism [formula] announced in the introduction. We further show that the main enumerative result of Section 3 implies that [formula] is an isomorphism.

To begin, fix two line bundles L and M of degree [formula] on C. We define the following divisor, denoted ΔL,M, on the product space U(r,0)  ×  U(k,0). On the stable part of the moduli space, ΔL,M is given set theoretically as

[formula]

Scheme-theoretically, if we let

[formula]

be the morphism

[formula]

then the line bundle

[formula]

has a natural section which vanishes along the jumping locus ΔL,M considered above.

The following equality holds on U(r,0)  ×  U(k,0):

[formula]

Proof. The lemma is a consequence of the see-saw principle. We will need the following general fact established in [\cite=DN], and which will be invoked several times in this paper. Fact. Assuming T1 and T2 are vector bundles with

[formula]

we have the following isomorphism of Theta bundles on U(r,0):

[formula]

Here, we regard the degree 0 line bundle [formula] on C as a line bundle on [formula] in the usual way.

Fixing E∈U(r,0), we evaluate the restriction O(ΔL,M) to {E}  ×  U(k,0):

[formula]

Next, write

[formula]

for the multiplication by ( - 1). As a consequence of (relative) Serre duality, we have

[formula]

for all line bundles P of degree [formula]. The restriction of O(ΔL,M) to U(r,0)   ×   {F} is then seen to be:

[formula]

This concludes the proof of the lemma.

Now the natural section ΔL,M of O(ΔL,M) gives the projectively well-defined duality map

[formula]

which is the subject of Theorem [\ref=main2]. We now give the proof of the theorem, invoking the enumerative conclusions of the next section.

Proof of Theorem [\ref=main2]. We will note in Section 3, by means of Corollary [\ref=sd2], that both the domain and the target of the duality map [formula] have the same dimension. Thus in order to establish Theorem [\ref=main2], it suffices to prove that [formula] is surjective. This will follow easily upon giving a suitable enumerative interpretation to the Verlinde number

[formula]

Indeed, Proposition [\ref=pairs] of the next section constructs q pairs (Ai,Bi),    1  ≤  i  ≤  q such that

[formula] are rank r degree 0 stable bundles

[formula] are rank k degree 0 stable bundles

and

[formula] if and only if i = j.

[formula]

The existence of these pairs of bundles implies the surjectivity of the duality map [formula].

Indeed, for each E∈U(r,0), define

[formula]

It is clear that the ΔEs are in the image of [formula]. The two properties (a) and (b) imply that for the pairs (Ai,Bi),    1  ≤  i  ≤  q, we have

[formula]

It follows that ΔAi,1  ≤  i  ≤  q are linearly independent divisors in the image of [formula], and for dimension reasons they must span

[formula]

Intersections on the Quot scheme and a formula of Witten

The main result of this section, Proposition [\ref=pairs], constructs the pairs of vector bundles [formula] which, as was just noted, render Theorem [\ref=main2] evident. These pairs are obtained as points in a suitable Quot scheme; they geometrically realize an intersection product on Quot whose explicit evaluation equals the Verlinde numbers.

The Verlinde numbers

To start, let [formula] be the Grothendieck Quot scheme parametrizing short exact sequences

[formula]

with E a subsheaf of rank k and degree - d. [formula] provides a compactification of the scheme [formula] of degree d morphisms from C to the Grassmannian G(k,r + k). The morphism space sits inside [formula] as the locus of locally-free quotients of Or + k. Throughout this paper we will assume that the degree d is sufficiently large to ensure that [formula] is irreducible [\cite=BDW] and of the expected dimension

[formula]

We will also assume that d is divisible by k, and we set

[formula]

As a fine moduli space, [formula] comes equipped with a universal sequence

[formula]

We define the cohomology class

[formula]

The intersection theory of the Chern classes of [formula] has been well studied for over a decade: top intersections are computed by the Vafa-Intriligator formula [\cite=bertram], [\cite=sieberttian], [\cite=mo], and have enumerative meaning [\cite=bertram], counting degree d maps from C to the Grassmannian G(k,r + k) under incidence conditions with special Schubert subvarieties at fixed domain points.

Crucially for the arguments of this paper, the Verlinde numbers can be easily linked to the intersection theory of the Quot scheme. This was observed and justified through physical arguments by Witten [\cite=witten], who argued that the Wess-Zumino-Witten model for GL(k) at level r was related to the sigma model of the Grassmannian G(k,r + k). More precisely, we have the following spectacular realization of the Verlinde formula as a top intersection of the ak classes on [formula]:

For d large enough,

[formula]

Proof. We use the elementary expression for the Verlinde formula (the left-hand side of the above equation) appearing in [\cite=bl], namely

[formula]

Now the Vafa-Intriligator formula [\cite=mo] expresses the intersection number on the Quot scheme as a sum over (ordered tuples of) roots [formula] of unity of order r + k:

[formula]

[formula]

The proposition follows easily by repeatedly applying the following trigonometric identity:

[formula]

Proposition [\ref=verl] allows for the interpretation of the intersection number

[formula]

itself, without prefactors, as a modified Verlinde number. Indeed, we have the following

Let [formula] denote the determinant morphism. For any two line bundles A and B of degree [formula],

[formula]

Proof. Let [formula] be the tensor product map

[formula]

Note that by the see-saw principle,

[formula]

Indeed, it is easy to see that the restriction of [formula] to [formula] is isomorphic to θr, while the restriction [formula] to [formula] is

[formula]

Therefore, letting

[formula]

denote multiplication by r, we have

[formula]

Since τ is an etale cover of degree r2g we conclude

[formula]

[formula]

It remains to observe that the higher cohomology vanishes. By the Leray spectral sequence, this can be checked after pulling back by the finite morphism τ. The statement follows using the Künneth decomposition, as the Theta bundles on SU(r,O) and the Jacobian have no higher cohomologies.

For any line bundles A,B,C,D of degree [formula], we have

[formula]

Proof. This follows from [\eqref=beauvilleverlinde] by interchanging S and T.

Transversality

We now set out to realize the intersection number [\eqref=intonquot] geometrically. We will represent the cohomology class ak in different ways as vanishing loci of sections of the dual universal bundle [formula]. To this end,

pick distinct points [formula] on C.

for each 1  ≤  i  ≤  s, let Li be a one-dimensional subspace of [formula]. This gives (by duality) a section

[formula]

on [formula].

consider the restricted morphisms

[formula]

on [formula], and further let Zi denote the zero locus of the section φi,pi on [formula]

As shown in [\cite=bertram], the schemes Zi are of the expected codimension k, and moreover

[formula]

We aim first to prove the following transversality statement, which is essentially contained in [\cite=bertram].

For generic choices of subspaces Li, 1  ≤  i  ≤  s, the subschemes [formula] representing the class ak intersect properly in reduced points, inside the locus of the Quot scheme consisting of stable vector bundle quotients.

Proof. According to [\cite=bertram], generic zero-locus representatives for the classes ak appearing in the intersection on the right-hand side of [\eqref=intonquot], do not intersect outside the open subscheme [formula] of locally-free quotients of [formula]. We consider the restriction of each section

[formula]

to [formula]. For any point p∈C, the evaluation of morphisms in the scheme [formula] gives a map

[formula]

The restriction of the zero locus Zi of φi,pi to [formula] is

[formula]

where Wi is the zero locus of the corresponding section

[formula]

for the dual tautological bundle [formula] on G(k,r + k).

For each i, the zero locus Wi of [formula] is a subGrassmannian G(k,r + k - 1) of G(k,r + k). By Kleiman transversality [\cite=kleiman], given a subscheme Y of [formula], a generic subGrassmannian G(k,r + k - 1) intersects each locus in the image evp(Y) over which evp has constant fiber dimension properly (i.e. in the correct codimension), hence Y intersects ev- 1p(G(k,r + k - 1)) properly. A top dimensional intersection of generic Zis therefore avoids the unstable locus of [formula], and lies in the stable locus [formula] consisting of short exact sequences

[formula]

with E and F stable.

Note now that for sufficiently large d, the restricted evaluation

[formula]

has smooth fibers for every p∈C. Indeed, the domain is smooth since the obstruction space is

[formula]

This follows by considering the long exact sequence in cohomology associated with [\eqref=ses] and noting that H1(F) = 0 when F is stable and d is large enough. The conclusion about evp is implied by generic smoothness and by the fact that the target is a homogeneous space.

Now, if Y is a generically smooth subscheme of [formula], then evp(Y) is generically smooth in G(k,r + k), and by Kleiman transversality we conclude that the intersection of evp(Y) with a generic subGrassmannian G(k,r + k - 1) is generically smooth, implying by the smoothness of the fibers of evp that the intersection of Y with ev- 1p(G(k,r + k - 1)) is generically smooth as well. Inductively then, the intersection of generic Zi,  1  ≤  i  ≤  s is a zero-dimensional generically smooth subscheme of [formula]. Therefore, this intersection is smooth. This establishes Proposition [\ref=inters0].

Considering all the sections

[formula]

at once, we obtain that

[formula]

is the smooth zero locus on [formula] of a section

[formula]

Therefore, we have an exact sequence on Z

[formula]

We would like to identify TZ in terms of the available universal structures.

Each of the sections [formula] on [formula] vanishes on Z  ×  {pi}. On Z  ×  C therefore, each φi factors as

[formula]

where πC denotes the projection

[formula]

Let S denote the pushout on C of the two maps

[formula]

and

[formula]

Note that

[formula]

and that for distinct pis, S is locally free. Considering the s conditions imposed by each one of the points pi, we arrive at the conclusion that the universal map

[formula]

factors as

[formula]

Let F' on Z  ×  C denote the ensuing kernel,

[formula]

Denoting by [formula] the induced inclusion of sheaves, we see that each exact sequence

[formula]

representing a point ζ in the intersection [formula] factors through ι. For each ζ∈Z there is thus an associated exact sequence

[formula]

The Zariski tangent space to Z at ζ is

[formula]

Proof. As a consequence of [\eqref=universal], [\eqref=kernel] and the five lemma, we obtain a natural exact sequence

[formula]

where the second morphism is given by pairing evaluations of sections of F at the points [formula] with [formula] respectively. Twisting the exact sequence [\eqref=newf] with [formula] and pushing forward to Z by the projection πZ:Z  ×  C  →  Z, we get

[formula]

Comparing [\eqref=tangent1] and [\eqref=push] we conclude that the sequence [\eqref=push] is exact on the right and that

[formula]

The smoothness and zero-dimensionality of [formula] established by Proposition [\ref=inters0] implies that in Lemma [\ref=zariski] we have

[formula]

After dropping the primes and duals on the Fs, our discussion ensures the existence of q exact sequences

[formula]

with

Ei is a stable bundle of degree - d and rank k,

Fi is a bundle of degree d - s and rank r,

[formula]

[formula]

The last assertion follows from [\eqref=zerots] and the observation that for i  ≠  j we have a non-zero map

[formula]

Property [formula] also proves the stability of the bundle Fi via lemma A.1 in [\cite=Bel], as the required hypothesis [formula] is satisfied.

The tangent space computation of Lemma [\ref=zariski] and the arguments preceding it identify Z as the Quot scheme [formula] of rank k and degree - d subsheaves of [formula]. The pairs (Ei,Fi) constructed above correspond to the closed points of this smooth zero dimensional Quot scheme of length equal to the Verlinde number [\eqref=corol1].

Finally, we construct the pairs of bundles that were used in the proof of Theorem [\ref=main2].

There exist q pairs of bundles [formula] with the following properties

[formula] are rank r degree 0 stable bundles

[formula] are rank k degree 0 stable bundles

[formula] iff i = j

[formula]

Proof. We only need to adjust the degrees of the bundles [\eqref=rightbun]. Pick a line bundle Q of degree [formula]. This ensures that the line bundle

[formula]

has degree [formula]. Moreover, we may assume that Q is chosen so that R avoids the theta divisor on [formula] i.e., so that it has no global sections. Setting

[formula]

we obtain, via Property (iv) above, that

[formula]

Moreover

[formula]

Therefore,

[formula]

This is what we set out to prove.

The argument on the Jacobian

In this section we prove Theorem [\ref=main]. We pass to the moduli spaces of semistable bundles with fixed determinant via the natural inclusion

[formula]

Restricting sections gives a morphism (well defined projectively)

[formula]

We show

For generic L and M the restriction ρ is surjective.

Proof. Set

[formula]

Recall from [\eqref=pullb] that the pullback of L under the tensor product map

[formula]

is given by

[formula]

Such an isomorphism will be fixed below.

Let [formula] be the group of r-torsion points in [formula]. Under the natural antidiagonal action of [formula] on [formula], the morphism τ is a Galois covering with Galois group [formula]. It follows that

[formula]

the right hand side being the space of [formula]-invariant sections. It suffices to show that given any section s of θkr on SU(r,O), there is a [formula]-invariant section s̃ of [formula] which restricts to s over SU(r,O)  ×  {O}.

First, we claim that for a generic choice of L, we can find a section u of [formula] which does not vanish at the origin, but vanishes at all other points of [formula]. This claim follows if we show that the sheaf [formula] is generated by the global sections of [formula] Equivalently we prove that the map

[formula]

is surjective. Since both [formula] and [formula] have dimension r2g, it suffices to explain that the morphism μ is injective. This is a consequence of the vanishing

[formula]

combined with the long exact sequence in cohomology associated with

[formula]

Here, [formula] is the ideal sheaf of [formula] in [formula] To prove [\eqref=vanish], we observe that since r is a finite morphism

[formula]

Now it is well known that

[formula]

where Ti are the r-torsion line bundles on [formula] [\cite=DT], under the standard identification of degree 0 line bundles on the Jacobian and on the curve. From the pushforward under r of the ideal sheaf sequence [\eqref=ideals], it easily follows that

[formula]

with I{O} being the ideal sheaf of the origin [formula]. Hence,

[formula]

The last equality follows provided the (canonical) section of [formula] does not vanish at the origin {O}. The nonvanishing is equivalent to [formula], which can be arranged if we pick L outside the Theta divisors Θ1,Ti for all i. This proves the existence of the section u.

Next, take a section v of Θkr1,M which does not vanish at the origin. Again, this can be arranged for generic M. The section [formula] of [formula] does not vanish at the origin, but vanishes at all the other points in [formula].

Finally, pick any section s of the line bundle θkr on SU(r,O). We extend s to a [formula]-invariant section s̃ by averaging over [formula]. First, consider the section [formula] of the line bundle

[formula]

For each [formula], the pullback [formula] is a section of [formula]. The average

[formula]

is then an invariant section of [formula]. By construction, the pullback section [formula] vanishes along SU(r,O)  ×  {O} if and only if [formula]. Thus the two sections [formula] and s differ by a nonzero constant, as wished.

As a consequence of the lemma, the dual restriction map

[formula]

is injective. This is important for the proof of Theorem [\ref=main], which we now give.

Proof of Theorem [\ref=main]. Consider the injection

[formula]

given by

[formula]

where [formula] now denotes the canonical section of the Theta line bundle. Note that via the identification [formula] given by tensoring bundles with M, we have

[formula]

Here [formula] is the strange duality morphism [\eqref=sd]. The above equality follows directly from the definitions. Indeed, we observe that the restriction of the divisor Δ to SU(r,O)  ×  U(k,0), which determines the morphism [formula], equals

[formula]

But this is also the divisor inducing the morphism [formula].

Finally, by Theorem [\ref=main2] and Proposition [\ref=inj], the composition

[formula]

is an isomorphism onto its image. Therefore, [\eqref=equality] implies that [formula] is injective. A well known symmetry of the Verlinde formula gives the equality of dimensions [\cite=Bea]

[formula]

Hence [formula] must be an isomorphism. This proves Theorem [\ref=main].

Strange duality in arbitrary degree

The arguments of this paper can be used to establish the strange duality conjecture for arbitrary rank and degree. In this section, we will indicate the relevant statements and their proofs.

Consider d and r two relatively prime integers, and h,k two non-negative integers. Without loss of generality assume that 0 < d < r. To start, we define an extended duality morphism involving the moduli spaces of bundles U(hr,hd) and U(kr, - kd). Fix a reference bundle Q of degree d and rank r, and fix two line bundles L and M of degree [formula]. The duality relates sections of the pluri-Theta bundles

[formula]

twisted by line bundles coming from the Jacobian via the determinant maps

[formula]

Consider the divisor

[formula]

It is easy to check, in complete analogy with the argument of Lemma [\ref=cross], that

[formula]

Note that we recover the divisor used in the previous sections, when the degree is 0, by taking Q to be trivial.

We will show

The divisor Δ induces a rank-level duality isomorphism between

[formula]

[formula]

The starting point of the argument is the following rewriting of the Verlinde formula, valid in arbitrary degree.

Let θhr denote the ample generator for the Picard group of SU(hr,hd). If [formula] is sufficiently large, then

[formula]

Proof. Theorem 9.4 in [\cite=bl] establishes an isomorphism between the space of global sections and a space of conformal blocks for the affine Lie algebra hr at level kr. The dimension of the space of conformal blocks is computed in corollary 9.8 of [\cite=Bea2]. Together, these two statements give the formula

[formula]

In the above summation [formula] is an element of the weight lattice of [formula] whose standard coordinates satisfy the property

[formula]

Also, the trace is computed in the representation of [formula] whose highest weight is the following combination of the standard coordinate forms

[formula]

The Weyl character formula expresses the trace of [formula] as

[formula]

with ρ being half the sum of the positive roots of [formula]. To simplify this formula, we compare the terms indexed by στ in the numerator with terms indexed by σ in the denominator, where τ is the permutation

[formula]

The explicit computation shows that all such terms are proportional by the factor

[formula]

We now apply the following change of variables, which can also be found in [\cite=zagier]. Setting

[formula]

the Verlinde formula becomes

[formula]

As in [\cite=zagier], we remove the condition 0∈T at the expense of including the prefactor [formula]. Further, we rewrite the expression in a form which is symmetric in T and its complement S, using the trigonometric identity [\eqref=trigid]. We arrive at the equality

[formula]

Finally, the Lemma follows from [\eqref=ver2] by a backward use of the Vafa-Intriligator formula, just as in Proposition [\ref=verl].

Proof of Theorem [\ref=main3]. The proof is similar to that of Theorem [\ref=main2], but the numerical details are slightly different. By Proposition [\ref=verl1], and the usual covering argument, we have

[formula]

It follows from [\eqref=ver2], after interchanging S and T, that

[formula]

is computed by the same intersection number on Quot. Let q denote this common value.

Finally, the reduced points representing the intersection number q give, after adjusting the degrees, q pairs of stable bundles

[formula]

such that ΔAi(Bj)  ≠  0 if and only if i  =  j. This is enough to complete the proof.

Theorem [\ref=main3] leads to the proof of the arbitrary degree strange duality conjecture, as stated in [\cite=DT]. As usual, let

[formula]

be the tensor product map

[formula]

Using the see-saw theorem, we compute

[formula]

The canonical pullback section of [formula] induces a morphism between the spaces of global sections:

[formula]

[formula] is an isomorphism.

Proof. Restrict the duality morphism of Theorem [\ref=main3] to

[formula]

and repeat the argument of Section 4.