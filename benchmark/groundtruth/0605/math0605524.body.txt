Theorem Proposition Lemma Corollary Conjecture

Rough Definition Definition Problem Example Question

Boolean functions with small spectral norm

Introduction

Let [formula] be the n-dimensional cube, and let f:G  →  {0,1} be a boolean function, or more generally a function from G to [formula]. In many works, particularly in theoretical computer science, the Fourier transform

[formula]

is considered. Here, r lies in the dual group Ĝ which we have identified with G by choosing the scalar product uTv.

It is natural to consider the [formula]-norms

[formula]

for [formula], as well as the [formula]-norm ||||∞: =  sup r|(r)|.

There are many tools available for analysing these norms when [formula], particularly when p is ∞   or an even integer. When [formula], however, the situation is in many ways rather mysterious. Of these cases, a very natural one is the endpoint p  =  1. In this case the norm ||||1 is called the algebra norm, Wiener norm or spectral norm; we shall denote it by ||f||A. It is quite easy to show, using an instance of Young's inequality for convolutions, that

[formula]

for any two functions [formula]. This explains the term algebra norm.

A basic question is the following.

Let M be a fixed positive real number and let f:G  →  {0,1} be a boolean function. When is [formula]?

A partial answer to this question will be the main business of this paper. By far the most important feature of the problem is that we are asking it for boolean functions, which take only the values 0 or 1. There is a ready supply of functions f with [formula] small: Take for instance any pair [formula]. Then [formula] has which is small if g and h are small in L2. It is rather hard, however, to construct a large supply of such functions which take only the values 0 and 1.

To get a feel for the question, we prove a simple folklore result concerning the case M  =  1. In fact, by choosing a suitable argument from among the many available, one can cover the case M  <  3 / 2.

Let f:G  →  {0,1} be a boolean function which does not vanish identically. Then either f  =  1t  +  H, where t  +  H is a coset of a subgroup of G, in which case ||f||A  =  1, or else [formula].

Proof. First note that since f is not identically zero we have [formula], and so [formula], by the simplest instance of the Hausdorff-Young inequality.

Now suppose that [formula]. The Fourier transform of 1t  +  H is supported on [formula], and it has modulus ||1H||1 there. It follows from this and the fact that [formula] that ||f||A  =  1 when f  =  1t  +  H.

To get the stronger statement claimed, we note that if f is not (the characteristic function of) a coset of a subgroup then there are four distinct points x,x + h,x + k,x + h + k forming a parallelogram in G such that f(x) = f(x + h) = f(x + k) = 1 but f(x  +  h  +  k) = 0 (this is actually an if and only if statement - we leave the proof of both directions to the reader). Let

[formula]

thus φ(x)  =  φ(x  +  h)  =  φ(x  +  k)  =  |G|, φ(x  +  h  +  k)  =   - |G| and φ(y)  =  0 for all other y. Now we can compute that

[formula]

and so it follows from Plancherel's theorem that

[formula]

which proves the result.

Remarks. We leave it to the reader to confirm that the constant 3 / 2 is best possible. The result (and proof) are inspired by two papers of Saeki [\cite=SSI] [\cite=SSII] in which the same question is addressed over all locally compact abelian groups G. In that more general setting the constant 3 / 2 should be reduced to [formula], and equality can occur in any group G with an element of order 4.

Returning to our main question, let us recall that ||  ·  ||A is an algebra norm. Thus if f1,f2:G  →  {0,1} are functions for which ||f1||A and ||f2||A are small then the functions [formula], [formula],1  -  f1 and 1 - f2 also have this property. Loosely speaking, we refer to functions which can be obtained by a small number of operations of this kind from the basic functions 1t  +  H as belonging to the coset ring of G. In fact, it is easy to see (ignoring quantitative issues for the time being) that all elements of the coset ring are in fact of the form

[formula]

for subgroups [formula] and some "small" L.

One trivially has the bound

[formula]

and so it is rather natural to ask whether something like the converse is true; this is the main result of our paper.

Suppose that f:G  →  {0,1} has [formula]. Then we may write

[formula]

where the Hj are subgroups of G and [formula] for some absolute constant C.

Remarks. The bound may seem unimpressive, and indeed in a sense it is. However it depends only on M, a feature which we believe is new to this paper. We do not dare to venture a guess as to the correct bound, and it seems to us that it would be difficult to use our method to reduce the number of exponentials below two. It may be possible to reduce the power 4 somewhat, although we have not attempted to do this.

The reader may wonder why we bothered to introduce the coset ring at all, when only the very natural functions [\eqref=eq0.3] are involved in our theorem. The answer is that the description of the coset ring in the form [\eqref=eq0.3] is specific to the case [formula], and the phenomenon described by Theorem [\ref=mainthm] is, in a sense, more general.

Indeed our entire approach was motivated by Cohen's celebrated idempotent theorem [\cite=PJC]. Suppose that G is a locally compact abelian group, and that M(G) is the Banach algebra of finite measures on G under convolution (see [\cite=WR] for details). We say that a measure μ∈M(G) is idempotent if [formula]. Cohen's theorem is that μ is idempotent if any only if [formula] lies in the coset ring of Γ  =  Ĝ.

In our setting, Cohen's result implies that if f:G  →  {0,1} has [formula] then there is a decomposition of the form of [\eqref=eq0.3] with L finite. This is, of course, a vacuous result. It was, however, natural to start with Cohen's argument (as described in Rudin [\cite=WR]) and try to make it effective. A naïve attempt along these lines fails at several points and there are even "softer" proofs of Cohen's theorem that we have not managed to interpret in a finite setting at all, cf. [\cite=BHJFMFP]. Nevertheless access to these classical results was crucial to our understanding and we could not have written this paper without them.

We also import some "modern" ingredients from additive combinatorics such as the Balog-Szemerédi theorem and Ruzsa's analogue of Freiman's theorem. It seems to the authors that it may be worth revisiting a number of classical results in the light of these developments.

It is possible that our methods, in combination with the ideas in [\cite=PJC], could lead to a fully quantitative proof of Cohen's idempotent theorem. We intend to pursue this direction in future work.

We conclude the introduction by remarking that the spectral norm of boolean functions is discussed in the computer science literature, but not in a great deal of detail. The papers [\cite=MB] [\cite=YM] show that functions which can be computed using a small binary decision tree have small spectral norm. Such functions are, however, rather special elements of the coset ring.

Notation

Much of the notation we will use is implicit in the introduction, but it may be helpful to clarify things here. When working with functions on G, we will always use Haar probability measure. Integration with respect to this measure will be denoted by [formula], or sometimes just [formula]. If [formula] is a function and [formula] then we define

[formula]

We also define ||f||∞: =  sup x|f(x)| as usual. If [formula] are two functions then we set

[formula]

and

[formula]

When working with the Fourier transforms of functions we will use counting measure. Integration with respect to this measure will be denoted by [formula] as usual. We defined the [formula] norms in the introduction. Note also Plancherel's identity, which implies that

[formula]

We will occasionally write, e.g., [formula] when taking the Fourier transform of a particularly complicated expression E.

Finally, a word concerning absolute constants. The letter C will always denote an absolute constant, but the exact value of this constant may change form expression to expression. If in doubt, the reader should recall that all instances of C could, if desired, be replaced by specific constants in such a way that all our proofs are correct.

Almost integer-valued functions and almost homomorphisms

A key feature of this paper is that we cannot work entirely within the "category" of boolean functions. We must also consider more general functions which are close to being integer-valued.

Let ε∈(0,1 / 2). We say that a function [formula] is ε-almost integer-valued if there is a function [formula] such that [formula].

We will need to study the behaviour of almost integer-valued functions under a certain class of map. Let H be a subgroup of G. For any function [formula], we define ψHf by

[formula]

where μH denotes the Haar probability measure on H. Equivalently, one may define ψH in terms of its Fourier transform by

[formula]

where the subgroup [formula] is the annihilator of H, defined by

[formula]

The following simple properties of ψH follow immediately from the above definitions.

The norm of ψH is at most 1 in both the operator norm induced by the spectral norm and in that induced by the L∞-norm. That is to say

[formula]

Let η  >  0 be a parameter, let [formula] be a function, and suppose that [formula]. Then we say that f is η-spectrally supported on H if

[formula]

Note that we do not assume that [formula] has substantial mass on [formula] itself.

Let [formula] be any subgroup, let η  >  0 be any parameter, and let [formula] be a function with [formula]. Then there is a subgroup [formula] with

[formula]

such that f is η-spectrally supported on H'.

Proof. Set H0: = H. We define a descending sequence [formula] of subgroups with [formula].

If, at some stage, f is η-spectrally supported on Hi then we stop. If not, there is some [formula] such that

[formula]

Define [formula] to be the subgroup of G generated by ri and [formula]. It is clear that for any j we have

[formula]

and so this inductive process must terminate after no more than M / η steps.

The purpose of Definition [\ref=def3.1] and Lemma [\ref=lem3.2] is to allow us to use the following approximate homomorphism property.

Suppose that [formula] are two functions, and that f is η-spectrally supported on H. Then

[formula]

Proof. We have

[formula]

However

[formula]

Now simply note that

[formula]

This completes the proof.

Our aim is to show that, provided the parameter η is suitably small, the map ψH preserves almost integer-valued functions.

Let [formula] be an integer, and write [formula]. Let [formula] be positive real parameters. Let [formula] be a function.

If f is ε-almost integer-valued and [formula] then [formula].

If [formula] then f is δ-almost integer-valued.

Proof. To prove the first statement, simply note that

[formula]

To prove the second, observe that

[formula]

for all [formula], where [formula] and lies in the interval ( - 1 / 2,1 / 2]. Furthermore one may easily confirm that

[formula]

for all t. It follows that for all x the distance from f(x) to the nearest integer is no more than δ.

Remark. We have normalised the polynomials Pd slightly arbitrarily, so that no factors were lost in (2). This makes no essential difference to the argument.

To apply this, we combine it with the rest of the results of this section to obtain the following corollary.

Suppose that [formula] is ε-almost integer-valued, and that [formula] for some [formula]. Suppose that [formula] for some suitably large C and that f is η-spectrally supported on H. Then both ψHf and f  -  ψHf are (2CMε)-almost integer-valued.

Proof. It clearly suffices to prove the result for ψHf, as the sum or difference of two almost integer-valued functions is almost integer-valued. Set d: = ⌈M⌉. Since [formula], Lemma [\ref=poly-lem] (1) implies that

[formula]

From Lemma [\ref=simple-prop] it follows that

[formula]

Now an easy induction based on Lemma [\ref=lem3.3] (and Lemma [\ref=simple-prop]) confirms that

[formula]

for any positive integer n. It follows from this that

[formula]

and hence in view of [\eqref=eq3-27] that

[formula]

The result is now an immediate consequence of Lemma [\ref=poly-lem] (2).

Ruzsa's analogue of Freiman's theorem

In the next two sections we use variants of a well-known sequence of arguments in additive combinatorics. The objective is to prove Proposition [\ref=concentrate-prop], which roughly speaking states that a function with small A(G)-norm concentrates on a subspace. We will supply original references for the results we use, but would also recommend the book [\cite=TCTVHV] as a general resource for this subject.

When we actually prove Proposition [\ref=concentrate-prop] we will find ourselves dealing with a set A  ⊆  G with small doubling, that is to say a set A with [formula] for some "not too large" K. There is a beautiful theorem of Imre Ruzsa [\cite=IZRArb] (see also [\cite=TSFT]) which states that in this case A is contained in a subgroup [formula] with density at most [formula]. This certainly implies that

[formula]

One could use this result as it is, and obtain a bound in Theorem [\ref=mainthm] with a three-fold iterated exponential. To reduce the number of exponentials to two, we need a different version of Ruzsa's result, in which we shall replace [\eqref=eq3-48] with A more precise version of the following proposition, which is the main result of the section, will be contained in a forthcoming paper of the first author and Terence Tao. The authors are grateful to the latter for useful discussions regarding this circle of ideas.

Suppose that A  ⊆  G is a set with [formula]. Then there is a subgroup [formula] such that

[formula]

Remark. It is an important unsolved problem to decide whether or not one may replace 2- CKC by a polynomial in the first bound. This is known as the Polynomial Freiman-Ruzsa conjecture (PFR); see for example [\cite=BJGFFM]. The truth of this conjecture, however, would not make an essential difference to the bound we obtain in Theorem [\ref=mainthm].

To prove Proposition [\ref=ruz-refinement] we need to set up a little notation. Write [formula] for the density of A in G. Put

[formula]

and for any parameter η  >  0 define

[formula]

For a parameter ρ∈(0,1), we write (as is becoming standard)

[formula]

We begin by recording a well-known argument of Bogolyubov [\cite=NNB] in this language.

Suppose that A  ⊂  G. Let δ,ε∈(0,1) be any parameters and set ρ: = (ε / 2)1 / 2 and [formula]. Then

[formula]

Proof. Suppose that x∈Sδ and that h∈H. Then we have

[formula]

Thus we only need observe, using Parseval's identity and the definition of [formula], that

[formula]

The next two lemmas are the vehicles by which we leverage the assumption that A has small doubling. The first states that A has large density on a translate of Sη, provided η is sufficiently small.

Suppose that A  ⊆  G, that [formula] and that [formula] is a parameter. Then [formula] and

Proof. Averaging ν(4) over x∈G, we get

[formula]

where the second inequality follows from the Plünnecke-Ruzsa inequalities [\cite=IZR], and the third from the condition on η. The first conclusion of the lemma follows immediately upon rearranging.

For the second part we use the first to see that

[formula]

The conclusion follows immediately since [formula].

Suppose that A  ⊆  G has density [formula] and that [formula]. Then there is a subgroup [formula] with [formula] and some η with [formula], such that Sη is a union of cosets of H together with an exceptional set X satisfying [formula].

Proof. Let η0: = 1 / 2K4 and set ε: = 1 / 64K12. Consider the nested sequence

[formula]

where L: = 1 / 4K4ε. By the Plünnecke-Ruzsa inequalities we have [\cite=IZR]

[formula]

for any η, and therefore by the pigeonhole principle there is some j with [formula] such that

[formula]

Now we apply Lemma [\ref=bog]. Writing [formula] where ρ: = 1 / 16K6, we know from that lemma that

[formula]

Thus Sη0  -  (j + 1)ε can be written as a union of cosets of H together with an exceptional set X of density at most α / 16K4.

It remains to establish the claimed lower bound on [formula]. By a lemma of Chang [\cite=MCC] (see also [\cite=BJGRKP] and [\cite=WR.TSG] [\cite=TCTVHV]) the set [formula] is contained in a subgroup of G with dimension O(ρ- 2(1 +  log (1 / α)))  =  O(K12 log α- 1). This concludes the proof.

Proof of Proposition [\ref=ruz-refinement]. It is sufficient to prove the proposition when G = 〈A〉 in which case, by Ruzsa's Theorem [\cite=IZRArb], we have [formula].

Apply Lemma [\ref=lem1.4] to get a subgroup H' with [formula] and some η with [formula], such that

[formula]

where [formula]. Writing [formula] for the Haar measure on H', we have for all x∈G that

[formula]

It follows from this, Lemma [\ref=lem1.3] and the assumption that [formula] that

[formula]

Furthermore by the Plünnecke-Ruzsa inequalities [\cite=IZR] we have

[formula]

Comparing with [\eqref=use-soon] leads immediately to

[formula]

We have found a coset of H' on which the relative density of A is at least 1 / 16K8; by adjoining the zero element to H' if necessary, one obtains a subgroup H on which the relative density of A is at least 1 / 32K8, that is to say

[formula]

To complete the proof of Proposition [\ref=ruz-refinement] it remains to note that

[formula]

Concentration on a subgroup

Suppose that [formula] is an ε-integer-valued function with [formula], where [formula] and [formula]. Then there is a subgroup [formula] with and

[formula]

Let m be a positive integer. Suppose that A  ⊆  G is a set with 0∉A. Then we say that A is m-arithmetically connected if, for any choice of distinct [formula], one of the following alternatives holds:

The vectors [formula] are linearly dependent;

The vectors [formula] are linearly independent but there exists a further a'∈A such that a' lies in the linear span of the ai.

The next lemma imports the tools we developed in §[\ref=sec4]. The result allows us to weaken the condition of small doubling in Proposition [\ref=ruz-refinement] to that of arithmetic connectedness.

Suppose that m is a positive integer and that A  ⊆  G is a set with 0∉A. Suppose that A is m-arithmetically connected. Then there is a subgroup [formula] such that

Proof. If |A|  <  m2 the result is trivial, so we stipulate that [formula]. Pick any m-tuple [formula] of distinct elements of A. With the stipulated lower bound on |A|, there are at least |A|m / 2 such m-tuples. We know that either the vectors [formula] are linearly dependent, or else there is a further a'∈A such that a' lies in the linear span of the ai. In either situation there is some linear relation

[formula]

where [formula] has elements in [formula] and, since 0∉A and the ais are distinct, at least three of the components of [formula] are nonzero. By the pigeonhole principle, it follows that there is some [formula] such that the linear equation

[formula]

has at least |A|m / 2m + 2 solutions with [formula]. Removing the zero coefficients, we may thus assert that there is some r, [formula], such that the equation

[formula]

has at least |A|r - 1 / 2m + 2 solutions with [formula]. Note that this is a strong structural statement about A, since the maximum possible number of solutions to such an equation is |A|r - 1.

We claim that there are at least 2- 2m - 4|A|3 solutions to x1  +  x2  =  x3  +  x4 with xi∈A. To see this, write Rl(x) for the number of l-tuples [formula] such that [formula], and note that

[formula]

Noting that [formula] for all x (here, of course, it is important that [formula]) we see from the Cauchy-Schwarz inequality that

[formula]

confirming the claim.

It now follows from the Balog-Szemerédi-Gowers theorem [\cite=WTG] that there is some set A'  ⊆  A, [formula], such that [formula]. By Proposition [\ref=ruz-refinement] there is a subgroup [formula] with

[formula]

The result follows since [formula].

Proof of Proposition [\ref=concentrate-prop]. We begin by decomposing f2 as g + h where [formula] and h = f2 - g. We have

[formula]

the latter inequality being a consequence of the fact that [formula] and that [formula].

Set m  =  ⌈(2M)4⌉ and suppose that [formula] is a subgroup of dimension m. We have

[formula]

In view of the trivial estimate

[formula]

it follows from the triangle inequality and the assumption on ε that

[formula]

Write [formula]. If A is all of G then the proposition follows trivially so we may assume that this is not the case. Hence by replacing f(x) by f(x  +  y) for some y∉A, we may assume without loss of generality that 0∉A. We claim that A is m-arithmetically connected in the sense of Definition [\ref=arith-connect-def]. If this is not the case then there are elements [formula] such that the vectors [formula] are linearly independent, and such that there is no a'∈A with a' in the linear span of the ai. Writing V for the subgroup of G spanned by the ai, this means that the support of g1V is precisely [formula].

Thus we have

[formula]

Now we may compute that

[formula]

and that

[formula]

the middle inequality following from the observation that ai1  +  ai2  =  ai3  +  ai4 only if i1 = i2 and i3 = i4, or i1 = i3 and i2 = i4, or i1 = i4 and i2 = i3. From Hölder's inequality we therefore obtain

[formula]

Since m  >  12M4, this is contrary to [\eqref=g-l1-bd], and this proves the claim.

Applying Lemma [\ref=additive-comb-lem] we obtain a subgroup H' such that

[formula]

Since [formula] we get [formula], but this does not quite imply Proposition [\ref=concentrate-prop]. By Plancherel's theorem, however, we do have

[formula]

which, since [formula], means that

[formula]

By the definition of the Fourier transform this yields an r such that

[formula]

Taking [formula], it is clear that

[formula]

Finally we note that

[formula]

and that

[formula]

two estimates which together imply the claimed lower bound on [formula].

The main argument

The basic strategy for proving Theorem [\ref=mainthm] is that of an induction on M. Our first lemma provides the main inductive step. The most noteworthy feature of this lemma is that, in order to make the induction work, one cannot restrict attention to boolean functions f:G  →  {0,1}. It is necessary to consider almost integer-valued functions as well.

Suppose that [formula] is ε-almost integer-valued with [formula], where [formula]. Then we may decompose f as f1  +  f2, where each fi is ε'-almost integer-valued for some [formula], and for i  =  1,2 one of the following two alternatives holds:

[formula] may be written as [formula], where each Hj is a subgroup of G and

[formula]

||fi||A is most [formula].

Proof. If [formula] then [formula], and so option (1) vacuously holds. Assume, then, that [formula]. We begin by applying Proposition [\ref=concentrate-prop]. This provides a subgroup [formula] such that

[formula]

Set

[formula]

for some large C, this choice being dictated by a later application of Proposition [\ref=prop3.4].

By Lemma [\ref=lem3.2] we may find a subgroup [formula] with

[formula]

such that f is η-spectrally supported on H'. By averaging we have

[formula]

we also have

Define f1: = ψH'f and f2: = f  -  ψH'f. Since f is η-spectrally supported on H', it is an immediate consequence of Proposition [\ref=prop3.4] that both f1 and f2 are ε'-almost integer-valued, for some [formula].

It turns out that for f2 alternative (2) always holds, that is to say [formula]. From the Fourier definition of ψH' one sees that the supports of 1 and 2 are disjoint, and hence that

[formula]

Thus we need only show that [formula]. To see this, note that from [\eqref=eq5.33] we have

[formula]

Since [formula] is integer-valued, this of course means that

[formula]

whence

[formula]

To conclude the proof, then, we need only show that if ||f2||A  <  1 / 2 then [formula] may be written as a ±  1 sum of not too many cosets of H'. The hypothesis on [formula] then ensures that [formula] which is certainly at most 1 / 10. Also f is 1 / 10-almost integer valued so

[formula]

Thus [formula] is within 1 / 5 of a function which is constant on cosets of H'. Since [formula] is integer-valued, this can only be the case if [formula] is itself constant on cosets of H', that is to say

[formula]

for some [formula] which are distinct modulo H' and some non-zero integers cj, [formula].

Recall that the subgroup H' is such that [formula], and since we obviously have

[formula]

it follows immediately that [formula]. The result follows upon noting that any coset in G is either a subgroup, or else its characteristic function can be expressed as 1H1  -  1H2 for two subgroups [formula].

Proof of Theorem [\ref=mainthm]. We apply Lemma [\ref=ind-step] iteratively, starting with the observation that if f:G  →  {0,1} is a boolean function then f is 0-almost integer-valued, and hence an ε0-almost integer-valued for any ε0  >  0. An appropriate choice of ε0 will be made later. Split

[formula]

according to Lemma [\ref=ind-step]. Each fi is ε1-almost integer-valued, where

[formula]

and is such that either [formula] is a sum of at most 22CM4  /  ε functions of the form ±  1H (in which case we say it is finished), or else we have [formula].

Now split any unfinished functions fi using Lemma [\ref=ind-step] again, and so on (we will discuss the admissibility of this shortly). This procedure will result in the definition of parameters [formula] satisfying

[formula]

for all j. After at most 2M  -  1 steps all functions will be either finished or will have ||  ·  ||A-norm at most 1 / 2, in which case they are finished for trivial reasons. Thus we have a decomposition

[formula]

where [formula], each function fk is ε2M-almost integer-valued and, for each k, [formula] may be written as a sum of at most 22CM4  /  ε0 functions ±  1H. Now if ε0 is chosen so that [formula] then

[formula]

However f only takes values in {0,1} so it follows that

[formula]

which means that f can be written as a sum of at most 22CM4  /  ε0 functions ±  1H.

The condition [formula] is not the strongest condition that we require on ε0. In the repeated applications of Lemma [\ref=ind-step] we must ensure that [formula] is always satisfied, and so we require

[formula]

In view of [\eqref=increment] it is clear, however, that we may choose [formula], for some suitably large C, so that this is indeed always satisfied. This concludes the proof of Theorem [\ref=mainthm].

Concluding remarks

Note that our proof of Theorem [\ref=mainthm] actually proves the following slightly stronger result.

Suppose that [formula] is a function with [formula], and which is ε-almost integer-valued for some [formula]. Then the function [formula] can be written as a combination of at most 22CM4 functions of the form ±  1H.

In the same way that Theorem [\ref=mainthm] can be seen as a quantitative version of Cohen's result, this proposition can be seen as a quantitative version of some results of Méla [\cite=BHJFMFP] [\cite=JFM]. An example in Méla's work [\cite=BHJFMFP] [\cite=JFM] shows that ε must be smaller than 2- cM for such a theorem to hold.

Acknowledgements

The authors are very grateful to Ryan O'Donnell for supplying the references [\cite=MB] and [\cite=YM].