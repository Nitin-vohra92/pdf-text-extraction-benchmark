Theorem Lemma Corollary Remark Example Conjecture Problem Note

Two linear transformations each tridiagonal with respect to an eigenbasis of the other; comments on the split decomposition

Dedicated to Tom Koornwinder on his 60th birthday

Leonard pairs and Leonard systems

We begin by recalling the notion of a Leonard pair [\cite=TD00], [\cite=TersubI], [\cite=LS99], [\cite=qSerre], [\cite=LS24], [\cite=conform], [\cite=lsint], [\cite=Terint]. We will use the following terms. Let X denote a square matrix. Then X is called tridiagonal whenever each nonzero entry lies on either the diagonal, the subdiagonal, or the superdiagonal. Assume X is tridiagonal. Then X is called irreducible whenever each entry on the subdiagonal is nonzero and each entry on the superdiagonal is nonzero.

We now define a Leonard pair. For the rest of this paper [formula] will denote a field.

[\cite=LS99] Let V denote a vector space over [formula] with finite positive dimension. By a Leonard pair on V, we mean an ordered pair of linear transformations A:V  →  V and A*:V  →  V which satisfy both (i), (ii) below.

There exists a basis for V with respect to which the matrix representing A is irreducible tridiagonal and the matrix representing A* is diagonal.

There exists a basis for V with respect to which the matrix representing A* is irreducible tridiagonal and the matrix representing A is diagonal.

According to a common notational convention A* denotes the conjugate-transpose of A. We emphasize we are not using this convention. In a Leonard pair A,A* the linear transformations A and A* are arbitrary subject to (i), (ii) above.

Our use of the name "Leonard pair" is motivated by a connection to a theorem of D. Leonard [\cite=BanIto], [\cite=Leon] which involves the q-Racah polynomials [\cite=AWil], [\cite=GR] and some related polynomials of the Askey scheme [\cite=KoeSwa]. This connection is discussed in [\cite=LS99] and [\cite=LS24]. See [\cite=Zhed], [\cite=Grun], [\cite=Koelink3], [\cite=Hjal], [\cite=Zhidd] for related topics.

When working with a Leonard pair, it is often convenient to consider a closely related and somewhat more abstract concept called a Leonard system. In order to define this we recall a few more terms. Let d denote a nonnegative integer. Let [formula] denote the [formula]-algebra consisting of all d + 1 by d + 1 matrices which have entries in [formula]. We index the rows and columns by [formula]. Let [formula] denote the [formula]-vector space consisting of all d + 1 by 1 matrices which have entries in [formula]. We index the rows by [formula]. We view [formula] as a left module for [formula] under matrix multiplication. We observe this module is irreducible. For the rest of this paper we let A denote a [formula]-algebra isomorphic to [formula]. When we refer to an A-module we mean a left A-module. Let V denote an irreducible A-module. We remark that V is unique up to isomorphism of A-modules and that V has dimension d + 1. Let [formula] denote a basis for V. For X∈A and for [formula], we say Y represents X with respect to [formula] whenever [formula] for 0  ≤  j  ≤  d. Let A denote an element of A. We say A is multiplicity-free whenever it has d + 1 distinct eigenvalues in [formula]. Assume A is multiplicity-free. Let [formula] denote an ordering of the eigenvalues of A, and for 0  ≤  i  ≤  d put

[formula]

where I denotes the identity of A. We observe (i) AEi  =  θiEi (0  ≤  i  ≤  d); (ii) EiEj  =  δijEi (0  ≤  i,j  ≤  d); (iii) [formula]; (iv) [formula]. Let D denote the subalgebra of A generated by A. Using (i)-(iv) we find [formula] is a basis for the [formula]-vector space D. We call Ei the primitive idempotent of A associated with θi. It is helpful to think of these primitive idempotents as follows. Observe

[formula]

For 0  ≤  i  ≤  d, EiV is the (one dimensional) eigenspace of A in V associated with the eigenvalue θi, and Ei acts on V as the projection onto this eigenspace. We remark that the sequence {Ai|0  ≤  i  ≤  d} is a basis for the [formula]-vector space D and that [formula]. By a Leonard pair in A we mean an ordered pair of elements taken from A which act on V as a Leonard pair in the sense of Definition [\ref=def:lp]. We now define a Leonard system.

[\cite=LS99] By a Leonard system in A, we mean a sequence (A;A*; {Ei}di = 0;{E*i}di = 0) which satisfies (i)-(v) below.

Each of A,A* is a multiplicity-free element of A.

[formula] is an ordering of the primitive idempotents of A.

[formula] is an ordering of the primitive idempotents of A*.

[formula]

[formula]

We comment on how Leonard pairs and Leonard systems are related. In the following discussion V denotes an irreducible A-module. Let (A;A*;{Ei}di = 0;{E*i}di = 0) denote a Leonard system in A. For 0  ≤  i  ≤  d let vi denote a nonzero vector in EiV. Then the sequence [formula] is a basis for V which satisfies Definition [\ref=def:lp](ii). For 0  ≤  i  ≤  d let v*i denote a nonzero vector in E*iV. Then the sequence [formula] is a basis for V which satisfies Definition [\ref=def:lp](i). By these comments the pair A,A* is a Leonard pair in A. Conversely let A,A* denote a Leonard pair in A. By [\cite=LS99] each of A,A* is multiplicity-free. Let [formula] denote a basis for V which satisfies Definition [\ref=def:lp](ii). For 0  ≤  i  ≤  d the vector vi is an eigenvector for A; let Ei denote the corresponding primitive idempotent. Let [formula] denote a basis for V which satisfies Definition [\ref=def:lp](i). For 0  ≤  i  ≤  d the vector v*i is an eigenvector for A*; let E*i denote the corresponding primitive idempotent. Then (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system in A. In summary we have the following.

Let A and A* denote elements in A. Then the pair A,A* is a Leonard pair in A if and only if the following (i), (ii) hold.

Each of A,A* is multiplicity-free.

There exists an ordering [formula] of the primitive idempotents of A and there exists an ordering [formula] of the primitive idempotents of A* such that (A;A*; {Ei}di = 0;{E*i}di = 0) is a Leonard system in A.

Later in this paper we will obtain two characterizations of a Leonard system. These characterizations are based on a concept which we call the split decomposition. This concept is explained in the next section.

The split decomposition

In [\cite=LS99] we introduced the split decomposition for Leonard systems and in [\cite=LS24] we discussed this decomposition in detail. For our present purposes it is useful to define the split decomposition in a more general context. We will refer to the following set-up.

Let A and A* denote multiplicity-free elements in A. Let [formula] denote an ordering of the primitive idempotents of A and for 0  ≤  i  ≤  d let θi denote the eigenvalue of A for Ei. Let [formula] denote an ordering of the primitive idempotents of A* and for 0  ≤  i  ≤  d let θ*i denote the eigenvalue of A* for E*i. We let D (resp. D*) denote the subalgebra of A generated by A (resp. A*.) We let V denote an irreducible A-module.

With reference to Definition [\ref=def:settup], by a decomposition of V we mean a sequence [formula] consisting of 1-dimensional subspaces of V such that

[formula]

We have a comment. Let [formula] denote a basis for V and for 0  ≤  i  ≤  d let Ui denote the subspace of V spanned by ui. Then the sequence [formula] is a decomposition of V. Conversely, let [formula] denote a decomposition of V. For 0  ≤  i  ≤  d let ui denote a nonzero vector in Ui. Then [formula] is a basis for V.

With reference to Definition [\ref=def:settup], let [formula] denote a decomposition of V. We say this decomposition is split (with respect to the orderings [formula] and [formula]) whenever both

[formula]

Later in this paper we will obtain two characterizations of a Leonard system which involve the split decomposition. For the time being we consider the existence and uniqueness of the split decomposition. We start with uniqueness.

With reference to Definition [\ref=def:settup], the following (i), (ii) hold.

Assume there exists a decomposition [formula] of V which is split with respect to the orderings [formula] Ed and [formula]. Then [formula] and [formula] for 0  ≤  i  ≤  d.

There exists at most one decomposition of V which is split with respect to the orderings [formula] and [formula].

Proof: (i) From the equation on the right in ([\ref=eq:split2]) we find U0 = E*0V. Using this and ([\ref=eq:split1]) we obtain [formula] for 0  ≤  i  ≤  d. From the equation on the right in ([\ref=eq:split1]) we find Ud = EdV. Using this and ([\ref=eq:split2]) we obtain [formula] for 0  ≤  i  ≤  d. (ii) Immediate from (i) above. [formula]

We turn our attention to the existence of the split decomposition. In Section 4 we will give a necessary and sufficient condition for this existence. We will use the following result.

With reference to Definition [\ref=def:settup], assume there exists a decomposition U0,U1, [formula] of V which is split with respect to the orderings [formula] Ed and [formula]. Then the following (i)-(v) hold for 0  ≤  i  ≤  d.

[formula]

[formula]

[formula]

[formula]

[formula]

Proof: (i) For 0  ≤  j  ≤  d we have [formula] by Lemma [\ref=lem:splitshape](i) so [formula]. Apparently [formula]. In this inclusion the sum on the left has dimension i + 1 since [formula] is a decomposition. The sum on the right has dimension at most i + 1. Therefore [formula]. (ii) For 0  ≤  j  ≤  d we have [formula] by ([\ref=eq:split2]) so [formula]. Apparently [formula]. In this inclusion each side has dimension i + 1 so equality holds. (iii) Similar to the proof of (i) above. (iv) Similar to the proof of (ii) above. (v) Combine (ii), (iv) above. [formula]

Some products

Our next goal is to display a necessary and sufficient condition for the existence of the split decomposition. With reference to Definition [\ref=def:settup], consider the products

[formula]

Our condition has to do with which of these products is 0. In order to motivate our result we initially consider just one of these products.

With reference to Definition [\ref=def:settup], for 0  ≤  i  ≤  d let v*i denote a nonzero vector in E*iV and observe [formula] is a basis for V. Let B denote the matrix in [formula] which represents A with respect to this basis, so that

[formula]

Then for 0  ≤  i,j  ≤  d the following are equivalent: (i) E*iAE*j = 0; (ii) Bij = 0.

Proof: Let the integers i,j be given. Observe E*rv*s  =  δrsv*s for 0  ≤  r,s  ≤  d. By this and ([\ref=eq:bac]) we find E*iAE*jV is spanned by Bijv*i. The result follows. [formula]

In the next lemma we consider a certain pattern of vanishing products among the E*iAE*j. We will use the following notation. Let λ denote an indeterminate and let [formula] denote the [formula]-algebra consisting of all polynomials in λ which have coefficients in [formula]. Let [formula] denote a sequence of polynomials taken from [formula]. We say this sequence is graded whenever fi has degree exactly i for 0  ≤  i  ≤  d.

With reference to Definition [\ref=def:settup], the following (i)-(iii) are equivalent.

[formula].

There exists a graded sequence of polynomials [formula] taken from [formula] such that E*iV  =  fi(A)E*0V for 0  ≤  i  ≤  d.

For 0  ≤  i  ≤  d,

[formula]

Proof: (i)  ⇒  (ii) For 0  ≤  i  ≤  d let v*i denote a nonzero vector in E*iV and observe [formula] is a basis for V. Let B denote the matrix in [formula] which represents A with respect to this basis. By Lemma [\ref=lem:Bmeaining],

[formula]

Let [formula] denote the polynomials in [formula] which satisfy f0 = 1 and

[formula]

We observe fi has degree exactly i for 0  ≤  i  ≤  d so the sequence [formula] is graded. Comparing ([\ref=eq:bac]) and ([\ref=eq:fcon]) in light of ([\ref=eq:bcon]) we find v*i = fi(A)v*0 for 0  ≤  i  ≤  d. It follows E*iV  =  fi(A)E*0V for 0  ≤  i  ≤  d. (ii)  ⇒  (iii) For 0  ≤  j  ≤  d we have E*jV = fj(A)E*0V. The degree of fj is j so [formula]. Apparently [formula]. In this inclusion the sum on the left has dimension i + 1 and the sum on the right has dimension at most i + 1. Therefore [formula]. (iii)  ⇒  (i) For 0  ≤  i  ≤  d let Vi denote the subspace on the left or right in ([\ref=eq:long]). From the right-hand side of ([\ref=eq:long]) we find Vi + AVi = Vi + 1 for 0  ≤  i  ≤  d - 1. From the left-hand side of ([\ref=eq:long]) we find E*rVs = 0 for 0  ≤  s < r  ≤  d. Let i,j denote integers (0  ≤  i,j  ≤  d) and first assume i - j > 1. We show E*iAE*j = 0. Observe E*jV  ⊆  Vj and AVj  ⊆  Vj + 1 so AE*jV  ⊆  Vj + 1. However E*iVj + 1 = 0 since i - j > 1 so E*iAE*jV = 0. It follows E*iAE*j = 0. Next we assume i - j = 1 and show [formula]. Suppose E*iAE*j = 0. Then by our previous remarks E*iAE*h = 0 for 0  ≤  h  ≤  j. By this and since [formula] we find E*iAVj = 0. However Vi = Vj + AVj and E*iVj = 0 so E*iVi = 0. This contradicts the construction so [formula]. [formula]

With reference to Definition [\ref=def:settup], let v*0 denote a nonzero vector in E*0V and consider the [formula]-linear transformation from D to V which sends X to Xv*0 for all X∈D. Assume the equivalent conditions (i)-(iii) hold in Lemma [\ref=thm:poly]. Then this linear transformation is an isomorphism.

Proof: Since the [formula]-vector spaces D and V have the same dimension it suffices to show the linear transformation is surjective. Setting i = d in ([\ref=eq:long]) we find V = Dv*0. Therefore the linear transformation is surjective. [formula]

Replacing (A;A*;{Ei}di = 0;{E*i}di = 0) by (A*;A;{E*d - i}di = 0;{Ed - i}di = 0) in Lemma [\ref=thm:poly] and Corollary [\ref=cor:iso] we routinely obtain the following results.

With reference to Definition [\ref=def:settup], the following (i)-(iii) are equivalent.

[formula].

There exists a graded sequence of polynomials [formula] taken from [formula] such that EiV  =  f*d - i(A*)EdV for 0  ≤  i  ≤  d.

For 0  ≤  i  ≤  d,

[formula]

With reference to Definition [\ref=def:settup], let vd denote a nonzero vector in EdV and consider the [formula]-linear transformation from D* to V which sends X to Xvd for all X∈D*. Assume the equivalent conditions (i)-(iii) hold in Lemma [\ref=thm:polydual]. Then this linear transformation is an isomorphism.

The existence of the split decomposition

We now display a necessary and sufficient condition for the existence of the split decomposition.

With reference to Definition [\ref=def:settup], the following (i), (ii) are equivalent.

There exists a decomposition of V which is split with respect to the orderings [formula] Ed and [formula].

Both

[formula]

Proof: (i)  ⇒  (ii) By assumption there exists a decomposition [formula] of V which is split with respect to the orderings [formula] and [formula]. For 0  ≤  i  ≤  d we have [formula] by Lemma [\ref=lem:lu](i) and [formula] by Lemma [\ref=lem:lu](ii) so [formula]. This gives Lemma [\ref=thm:poly](iii). Applying that lemma we obtain ([\ref=eq:cases1]). For 0  ≤  i  ≤  d we have [formula] by Lemma [\ref=lem:lu](iii) and [formula] by Lemma [\ref=lem:lu](iv) so [formula]. This gives Lemma [\ref=thm:polydual](iii). Applying that lemma we obtain ([\ref=eq:cases2]). (ii)  ⇒  (i) For 0  ≤  i  ≤  d we define [formula]. We observe [formula] is a basis for the [formula]-vector space D. Let v*0 denote a nonzero vector in E*0V. Observe Lemma [\ref=thm:poly](i) holds by ([\ref=eq:cases1]) so Corollary [\ref=cor:iso] applies; by that corollary τiv*0 (0  ≤  i  ≤  d) is a basis for V. We define [formula] for 0  ≤  i  ≤  d and observe [formula] is a decomposition of V. We show this decomposition is split with respect to [formula] and [formula]. To do this we show the sequence [formula] satisfies ([\ref=eq:split1]) and ([\ref=eq:split2]). Concerning ([\ref=eq:split1]), from the construction (A - θiI)τi  =  τi + 1 for 0  ≤  i  ≤  d - 1 and (A - θdI)τd = 0. Applying both sides of these equations to v*0 we find (A - θiI)Ui  =  Ui + 1 for 0  ≤  i  ≤  d - 1 and (A - θdI)Ud = 0. We have now shown ([\ref=eq:split1]). Concerning ([\ref=eq:split2]), this will follow if we can show (a) [formula] for 0  ≤  i  ≤  d; (b) [formula] for 1  ≤  i  ≤  d; (c) [formula] for 1  ≤  i  ≤  d. We begin with (a). For 0  ≤  j  ≤  d the elements {τh|0  ≤  h  ≤  j} and the elements {Ah|0  ≤  h  ≤  j} span the same subspace of D. Therefore [formula]. We mentioned Lemma [\ref=thm:poly](i) holds so Lemma [\ref=thm:poly](iii) holds; therefore [formula] so [formula]. Observe [formula] for 0  ≤  i  ≤  d. Combining these comments we find [formula] for 0  ≤  i  ≤  d. We now have (a). Next we prove (b). From the construction, for 0  ≤  j  ≤  d we have [formula] so [formula]. From this we find [formula]. Apparently [formula] for 0  ≤  i  ≤  d. By this and since [formula] is a decomposition we find [formula] for 0  ≤  i  ≤  d. From ([\ref=eq:cases2]) we find [formula] for 1  ≤  j  ≤  d. Therefore [formula] for 1  ≤  j  ≤  d. From these comments we find [formula] for 1  ≤  j  ≤  d. We now have (b). Next we show (c). Suppose there exists an integer i (1  ≤  i  ≤  d) such that (A*  -  θ*iI)Ui = 0. We assume i is maximal subject to this. We obtain a contradiction as follows. For i  <  j  ≤  d we find (A*  -  θ*jI)Uj  ⊆  Uj - 1 by (a), (b). In this inclusion the left-hand side is nonzero and the right-hand side has dimension 1 so we have equality. We mentioned earlier (A - θdI)Ud = 0 so Ud = EdV. Apparently [formula] for i  ≤  j  ≤  d. In particular [formula]. Combining this with (A*  -  θ*iI)Ui = 0 we obtain [formula]. Let vd denote a nonzero vector in EdV and observe [formula]. This is inconsistent with Corollary [\ref=cor:isodual] and the fact that [formula]. We now have a contradiction and (c) is proved. Combining (a)-(c) we obtain ([\ref=eq:split2]). We have shown the decomposition [formula] satisfies ([\ref=eq:split1]), ([\ref=eq:split2]). Applying Definition [\ref=def:sp] we find [formula] is split with respect to the orderings [formula] and [formula]. [formula]

Two characterizations of a Leonard system

In this section we obtain two characterizations of a Leonard system, both of which involve the split decomposition. We will first state the characterizations, then prove a few lemmas, and then prove the characterizations. Our first characterization is stated as follows.

With reference to Definition [\ref=def:settup], the sequence (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system if and only if both (i), (ii) hold below.

There exists a decomposition of V which is split with respect to the orderings [formula] Ed and [formula].

There exists a decomposition of V which is split with respect to the orderings Ed,Ed - 1, [formula] and [formula].

In order to state our second characterization we recall a definition. Let σ:A  →  A denote any map. We call σ an antiautomorphism of A whenever σ is an isomorphism of [formula]-vector spaces and (XY)σ  =  YσXσ for all X,Y∈A. For example assume [formula]. Then σ is an antiautomorphism of A if and only if there exists an invertible R∈A such that Xσ  =  R- 1XtR for all X∈A, where t denotes transpose. This follows from the Skolem-Noether Theorem [\cite=rotman].

We now state our second characterization of a Leonard system.

With reference to Definition [\ref=def:settup], the sequence (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system if and only if both (i), (ii) hold below.

There exists a decomposition of V which is split with respect to the orderings [formula] Ed and [formula].

There exists an antiautomorphism [formula] of A such that [formula] and [formula].

We now prove some lemmas which we will use to obtain Theorem [\ref=thm:char1] and Theorem [\ref=thm:char2]. We have a preliminary remark. With reference to Definition [\ref=def:settup], we consider the following four conditions:

[formula]

We observe (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system if and only if each of ([\ref=eq:fourth3])-([\ref=eq:fourth2]) holds.

With reference to Definition [\ref=def:settup], assume conditions ([\ref=eq:fourth3]) and ([\ref=eq:fourth4]) hold. Then A,E*0 together generate A. Moreover A,A* together generate A.

Proof: Examining the proof of [\cite=LS24] we find that the elements ArE*0As (0  ≤  r,s  ≤  d) form a basis for the [formula]-vector space A. It follows that A,E*0 together generate A. The elements A,A* together generate A since E*0 is a polynomial in A*. [formula]

With reference to Definition [\ref=def:settup], assume conditions ([\ref=eq:fourth3]) and ([\ref=eq:fourth4]) hold. Then there exists a unique antiautomorphism [formula] of A such that [formula] and [formula]. Moreover [formula] for all X∈A.

Proof: Concerning the existence of [formula], for 0  ≤  i  ≤  d let v*i denote a nonzero element of E*iV and recall [formula] is a basis for V. For X∈A let [formula] denote the matrix in [formula] which represents X with respect to the basis [formula]. We observe [formula] is an isomorphism of [formula]-algebras. We abbreviate [formula] and [formula]. We observe B is irreducible tridiagonal and [formula]. Let D denote the diagonal matrix in [formula] which has ii entry

[formula]

It is routine to verify D- 1BtD = B. Each of D,B* is diagonal so DB*  =  B*D; also B* t = B* so D- 1B* tD = B*. Let [formula] denote the map which satisfies Xσ  =  D- 1XtD for all [formula]. We observe σ is an antiautomorphism of [formula] such that Bσ = B and B*  σ = B*. We define the map [formula] to be the composition [formula]. We observe [formula] is an antiautomorphism of A such that [formula] and [formula]. We have now shown there exists an antiautomorphism [formula] of A such that [formula] and [formula]. This antiautomorphism is unique since A,A* together generate A. The map [formula] is an isomorphism of [formula]-algebras from A to itself. This map is the identity since [formula], [formula], and since A,A* together generate A. [formula]

With reference to Definition [\ref=def:settup], assume there exists an antiautomorphism [formula] of A such that [formula] and [formula]. Then [formula] and [formula] for 0  ≤  i  ≤  d.

Proof: Recall Ei (resp. E*i) is a polynomial in A (resp. A*) for 0  ≤  i  ≤  d. [formula]

With reference to Definition [\ref=def:settup], assume there exists an antiautomorphism [formula] of A such that [formula] and [formula]. Then for 0  ≤  i,j  ≤  d, (i) E*iAE*j = 0 if and only if E*jAE*i = 0; and (ii) EiA*Ej = 0 if and only if EjA*Ei = 0.

Proof: By Lemma [\ref=lem:eistab] and since [formula] is an antiautomorphism,

[formula]

Assertion (i) follows since [formula] is a bijection. To obtain (ii) interchange the roles of A and A* in the proof of (i). [formula]

With reference to Definition [\ref=def:settup], assume at least three of ([\ref=eq:fourth3])-([\ref=eq:fourth2]) hold. Then each of ([\ref=eq:fourth3])-([\ref=eq:fourth2]) hold; in other words (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system.

Proof: Interchanging A and A* if necessary, we may assume without loss of generality that ([\ref=eq:fourth3]) and ([\ref=eq:fourth4]) hold. By Lemma [\ref=lem:dagexist] there exists an antiautomorphism [formula] of A such that [formula] and [formula]. By assumption at least one of ([\ref=eq:fourth1]), ([\ref=eq:fourth2]) holds. Combining this with Lemma [\ref=lem:flip] we find ([\ref=eq:fourth1]), ([\ref=eq:fourth2]) both hold. The result follows. [formula]

We are now ready to prove Theorem [\ref=thm:char1].

Proof of Theorem [\ref=thm:char1]: By Theorem [\ref=thm:splitcond] we find (i) holds if and only if each of ([\ref=eq:fourth3]), ([\ref=eq:fourth2]) holds. Applying Theorem [\ref=thm:splitcond] again, this time with (A;A*;{Ei}di = 0;{E*i}di = 0) replaced by (A;A*;{Ed - i}di = 0;{E*i}di = 0), we find (ii) holds if and only if each of ([\ref=eq:fourth3]), ([\ref=eq:fourth1]) holds. Suppose (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. Then each of ([\ref=eq:fourth3])-([\ref=eq:fourth2]) holds. In particular each of ([\ref=eq:fourth3]), ([\ref=eq:fourth1]), ([\ref=eq:fourth2]) holds so (i), (ii) hold by our above remarks. Conversely suppose (i), (ii) hold. Then each of ([\ref=eq:fourth3]), ([\ref=eq:fourth1]), ([\ref=eq:fourth2]) holds. At least three of ([\ref=eq:fourth3])-([\ref=eq:fourth2]) hold so (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system by Lemma [\ref=lem:3gives4]. [formula]

We are now ready to prove Theorem [\ref=thm:char2].

Proof of Theorem [\ref=thm:char2]: First assume (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. Then (i) holds by Theorem [\ref=thm:char1] and (ii) holds by Lemma [\ref=lem:dagexist]. Conversely assume (i), (ii) hold. Combining (i) and Theorem [\ref=thm:splitcond] we obtain ([\ref=eq:fourth3]), ([\ref=eq:fourth2]). Combining this with (ii) and using Lemma [\ref=lem:flip] we obtain ([\ref=eq:fourth4]), ([\ref=eq:fourth1]). Now each of ([\ref=eq:fourth3])-([\ref=eq:fourth2]) holds so (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. [formula]

We would like to emphasize the following fact.

Let A,A* denote a Leonard pair in A. Then there exists a unique antiautomorphism [formula] of A such that [formula] and [formula]. Moreover [formula] for all X∈A.

Proof: Since A,A* is a Leonard pair there exists an ordering [formula] of the primitive idempotents of A and an ordering [formula] of the primitive idempotents of A* such that (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. These orderings satisfy ([\ref=eq:fourth3])-([\ref=eq:fourth2]). In particular ([\ref=eq:fourth3]), ([\ref=eq:fourth4]) are satisfied so the result follows by Lemma [\ref=lem:dagexist]. [formula]

We finish this section with a comment.

With reference to Definition [\ref=def:settup], assume there exists a decomposition of V which is split with respect to the orderings [formula] and [formula]. Then the following (i), (ii) are equivalent.

The pair A,A* is a Leonard pair.

The sequence (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system.

Proof: (i)  ⇒  (ii) We assume there exists a decomposition of V which is split with respect to the orderings [formula] and [formula]. Therefore each of ([\ref=eq:fourth3]), ([\ref=eq:fourth2]) holds by Theorem [\ref=thm:splitcond]. Since A,A* is a Leonard pair there exists an antiautomorphism [formula] of A such that [formula] and [formula]. Applying Lemma [\ref=lem:flip] we find each of ([\ref=eq:fourth4]), ([\ref=eq:fourth1]) holds. Now each of ([\ref=eq:fourth3])-([\ref=eq:fourth2]) holds so (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. (ii)  ⇒  (i) Clear. [formula]

The two characterizations in terms of matrices

In this section we restate Theorem [\ref=thm:char1] and Theorem [\ref=thm:char2] in terms of matrices. We first set some notation. With reference to Definition [\ref=def:settup], suppose there exists a decomposition [formula] of V which is split with respect to the orderings [formula] and [formula]. Pick an integer i (1  ≤  i  ≤  d). By ([\ref=eq:split2]) we find (A*  -  θ*iI)Ui  =  Ui - 1 and by ([\ref=eq:split1]) we find (A - θi - 1I)Ui - 1  =  Ui. Apparently Ui is an eigenspace for (A - θi - 1I)(A*  -  θ*iI) and the corresponding eigenvalue is a nonzero element of [formula]. Let us denote this eigenvalue by φi. We call [formula] the split sequence for A,A* with respect to the orderings [formula] and [formula]. The split sequence has the following interpretation. For 0  ≤  i  ≤  d let ui denote a nonzero vector in Ui and recall [formula] is a basis for V. We normalize the ui so that (A - θiI)ui  =  ui + 1 for 0  ≤  i  ≤  d - 1. With respect to the basis [formula] the matrices which represent A and A* are as follows.

[formula]

Motivated by this we consider the following set-up.

Let d denote a nonnegative integer. Let A and A* denote matrices in [formula] of the form

[formula]

where

[formula]

We observe A (resp. A*) is multiplicity-free, with eigenvalues [formula] (resp. [formula] θ*d.) For 0  ≤  i  ≤  d we let Ei (resp. E*i) denote the primitive idempotent for A (resp. A*) associated with θi (resp. θ*i.)

We have some comments. With reference to Definition [\ref=def:fset], for 0  ≤  i  ≤  d let ui denote the vector in [formula] which has ith entry 1 and all other entries 0. We observe [formula] is a basis for [formula]. From the form of A we have (A - θiI)ui = ui + 1 for 0  ≤  i  ≤  d - 1 and (A - θdI)ud = 0. From the form of A* we have (A*  -  θ*iI)ui  =  φiui - 1 for 1  ≤  i  ≤  d and (A*  -  θ*0I)u0 = 0. For 0  ≤  i  ≤  d let Ui denote the subspace of [formula] spanned by ui. Then [formula] is a decomposition of [formula]. This decomposition satisfies (A - θiI)Ui = Ui + 1 for 0  ≤  i  ≤  d - 1 and (A - θdI)Ud = 0. Similarly (A*  -  θ*iI)Ui = Ui - 1 for 1  ≤  i  ≤  d and (A*  -  θ*0I)U0 = 0. In other words the decomposition [formula] is split with respect to the orderings [formula] and [formula]. We observe [formula] is the corresponding split sequence for A,A*. We now consider when is the pair A,A* a Leonard pair. We begin with a remark.

With reference to Definition [\ref=def:fset], the following (i), (ii) are equivalent.

The pair A,A* is a Leonard pair.

The sequence (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system.

Proof: We mentioned there exists a decomposition of [formula] which is split with respect to the orderings [formula] and [formula]. Therefore Lemma [\ref=lem:lp] applies and the result follows. [formula]

We now give a matrix version of Theorem [\ref=thm:char1].

Referring to Definition [\ref=def:fset], the following (i), (ii) are equivalent.

The pair A,A* is a Leonard pair.

There exists an invertible [formula] and there exists nonzero [formula] (1  ≤  i  ≤  d) such that

[formula]

Suppose (i), (ii) hold. Then the sequence [formula] is the split sequence for A,A* associated with the orderings [formula] and [formula].

Proof: (i)  ⇒  (ii) The sequence (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system by Lemma [\ref=lem:mention]. By Theorem [\ref=thm:char1] there exists a decomposition of [formula] which is split with respect to the orderings Ed,Ed - 1, [formula] and [formula]. Let [formula] denote this decomposition. By the definition of a split decomposition we have (A - θd - iI)Vi  =  Vi + 1 for 0  ≤  i  ≤  d - 1 and (A - θ0I)Vd = 0. Moreover (A*  -  θ*iI)Vi  =  Vi - 1 for 1  ≤  i  ≤  d and (A*  -  θ*0I)V0 = 0. For 0  ≤  i  ≤  d let vi denote a nonzero vector in Vi and observe [formula] is a basis for [formula]. We normalize the vi so that (A - θd - iI)vi  =  vi + 1 for 0  ≤  i  ≤  d - 1. Let [formula] denote the split sequence for A,A* with respect to the orderings [formula] and [formula]. Then [formula] (1  ≤  i  ≤  d) and moreover (A*  -  θ*iI)vi  =  φivi - 1 (1  ≤  i  ≤  d), (A*  -  θ*0I)v0 = 0. Let G denote the matrix in [formula] which has column i equal to vi for 0  ≤  i  ≤  d. We observe G is invertible. Moreover the matrices G- 1AG and G- 1A*G have the form shown above. (ii)  ⇒  (i) We show (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. In order to do this we apply Theorem [\ref=thm:char1]. In the paragraph after Definition [\ref=def:fset] we mentioned there exists a decomposition of [formula] which is split with respect to the orderings [formula] and [formula]. Therefore Theorem [\ref=thm:char1](i) holds. We show Theorem [\ref=thm:char1](ii) holds. For 0  ≤  i  ≤  d let vi denote column i of G and observe [formula] is a basis for [formula]. From the form of G- 1AG we find (A - θd - iI)vi  =  vi + 1 for 0  ≤  i  ≤  d - 1 and (A - θ0I)vd = 0. From the form of G- 1A*G we find (A*  -  θ*iI)vi  =  φivi - 1 for 1  ≤  i  ≤  d and (A*  -  θ*0I)v0 = 0. For 0  ≤  i  ≤  d let Vi denote the subspace of [formula] spanned by vi. Then [formula] is a decomposition of [formula]. Also (A - θd - iI)Vi  =  Vi + 1 for 0  ≤  i  ≤  d - 1 and (A - θ0I)Vd = 0. Moreover (A*  -  θ*iI)Vi  =  Vi - 1 for 1  ≤  i  ≤  d and (A*  -  θ*0I)V0 = 0. Apparently [formula] is split with respect to the orderings [formula] and [formula]. Now Theorem [\ref=thm:char1](ii) holds; applying that theorem we find (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. In particular A,A* is a Leonard pair. Assume (i), (ii) both hold. From the proof of (ii)  ⇒  (i) we find that for 1  ≤  i  ≤  d, φi is the eigenvalue of (A - θd - i + 1I)(A*  -  θ*iI) associated with Vi. Therefore [formula] is the split sequence for A,A* associated with the orderings [formula] and [formula]. [formula]

We now give a matrix version of Theorem [\ref=thm:char2].

Referring to Definition [\ref=def:fset], the following (i), (ii) are equivalent.

The pair A,A* is a Leonard pair.

There exists an invertible [formula] such that

[formula]

Proof: (i)  ⇒  (ii) By Theorem [\ref=thm:lpdag] there exists an antiautomorphism [formula] of [formula] such that [formula] and [formula]. Since [formula] is an antiautomorphism there exists an invertible [formula] such that [formula] for all [formula]. Setting X = A we have H- 1AtH  =  A. Setting X = A* we have H- 1A* tH = A*. (ii)  ⇒  (i) We show (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. In order to do this we apply Theorem [\ref=thm:char2]. In the paragraph after Definition [\ref=def:fset] we mentioned there exists a decomposition of [formula] which is split with respect to the orderings [formula] and [formula]. Therefore Theorem [\ref=thm:char2](i) holds. Let [formula] denote the map which satisfies [formula] for all [formula]. Then [formula] is an antiautomorphism of [formula] such that [formula] and [formula]. Now Theorem [\ref=thm:char2](ii) holds; applying that theorem we find (A;A*;{Ei}di = 0;{E*i}di = 0) is a Leonard system. In particular A,A* is a Leonard pair. [formula]

Remarks

Referring to Definition [\ref=def:fset], presumably condition (ii) of Theorem [\ref=thm:bbcc] or Theorem [\ref=thm:char2m] can be translated into a condition on the entries of A and A*. We obtained such a condition in [\cite=LS99]; we cite it here for the sake of completeness.

[\cite=LS99] With reference to Definition [\ref=def:fset], the pair A,A* is a Leonard pair if and only if there exists nonzero [formula] (1  ≤  i  ≤  d) such that (i)-(iii) hold below.

[formula].

[formula].

The expressions

[formula]

are equal and independent of i for 2  ≤  i  ≤  d - 1.

Suppose (i)-(iii) hold. Then [formula] is the split sequence for A,A* with respect to the orderings [formula] and [formula].

Acknowledgement

The author would like to thank Brian Curtin, Eric Egge, Mark MacLean, Arlene Pascasio, and Chih-wen Weng for giving the manuscript a close reading and offering many valuable suggestions.

Paul Terwilliger Department of Mathematics University of Wisconsin 480 Lincoln Drive Madison, Wisconsin, 53706 USA email: terwilli@math.wisc.edu