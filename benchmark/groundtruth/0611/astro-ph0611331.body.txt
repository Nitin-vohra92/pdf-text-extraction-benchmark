A software baseband receiver for pulsar astronomy at GMRT

and   Sunil Ramakrishna2,3 1National Centre for Radio Astrophysics (TIFR), Pune 411 007, India 2International Institute of Information Technology (I2IT), Pune - 411 057, India 3Intoto Software(I) Pvt Ltd., Hyderabad 500 082, India

Introduction

High time resolution data are required in a variety of pulsar studies. Useful constraints on the location and size of emission region as well as the emission mechanism can be obtained by studies of narrow intense highly polarized Giant Pulses (GPs), such as those seen in PSRs B0531+21, B1937+21 and a few other pulsars . Further constraints on emission mechanism for pulsars are placed by high time resolution observations of micro-pulses, observed in pulsars such as PSRs B1133+16, B0950+08 and J0437-  4715 . Polarization observations for millisecond pulsars (MSPs) are being carried out increasingly with high time resolution instruments , primarily due to the short periods of these pulsars. These observations, which appear to show a flat polarization angle swing for MSPs as opposed to an S-Shaped curve for most normal pulsars, are needed to constrain a probably more complex magnetospheric physics of these stars. Such observations are also required to discriminate between the models explaining orthogonal polarization mode changes . High time resolution observations also provide high precision astrometric measurements as illustrated by the distance measurement of PSR J0437-  4715 system using annual-orbital parallax . In addition, such data are useful in experiments involving tests for general theory of relativity and the detection of primordial gravitational wave background . Few such observations at more than two frequencies, simultaneous or otherwise, are available, particularly for observation frequencies below 1 GHz.

Giant Meterwave Radio Telescope (GMRT) has the unique capability to provide such multi-frequency high quality pulsar data at observation frequencies ranging from 150 MHz to 1420 MHz . As pulsars exhibit a steep spectra with typical spectral index of -1.8 , the signal to noise ratio (SNR) of pulsar data increases with decreasing observation frequencies upto 235 MHz at GMRT. Large observation bandwidths (typically 300 MHz to 1 GHz) are employed at high frequencies as the data quality improves with the square root of observing bandwidth. Although the observation bandwidths are limited at GMRT due to smaller front-end design bandwidths as well as a much larger Radio Frequency Interference (RFI), GMRT is a multi-element telescope consisting of thirty 45-m diameter dishes, which can be phased to provide a single dish with effective collecting area ranging from 12000 m2 -   30000 m2. Thus, GMRT has the unique capability to trade-off number of antennas with observation bandwidth. Consequently, the data quality is comparable or better than most single dish telescopes operating at high frequencies despite the limited bandwidth.

The time resolution and quality of pulsar data is however limited due to dispersion in the interstellar medium (ISM), particularly at low frequencies of operation at GMRT. The effect of dispersion in ISM can be mitigated using a large filterbank. For example, the standard pulsar hardware at GMRT employs a 256 channel digital filterbank. Although this reduces the dispersion smear to about 114 μs per frequency channel across a 16 MHz bandpass for a pulsar with a Dispersion Measure ( DM - the integrated column electron density along the line of sight to the pulsar) of 50 pc  cm- 3 at a frequency of 610 MHz, the corresponding smear are very large at lower frequencies used at GMRT (750 μs, 2 ms and 8 ms for 325, 235 and 150 MHz respectively). This dispersion of pulsar signal due to ISM can be eliminated using a receiver which implements coherent dedispersion algorithms . As the pulsar hardware currently in use at GMRT does not provide data with sufficient time resolution, particularly for high DM short period pulsars at the lower operating frequencies, a new pulsar instrument with coherent dedispersion capability was required at GMRT to provide such data and to fill this gap in GMRT's capabilities.

Traditionally, the coherent dedispersion algorithms were employed in specialized hardware using Digital Signal Processing (DSP) or Field Programmable Gate Array (FPGA) chips. Although these designs are low cost, the functionality of such hardware is frozen at the time of design, making them inflexible to changing demands of pulsar astronomy. A new alternative is provided by the availability of cheap computer hardware in recent years. In this approach, the required signal processing is implemented in modular and portable software using commercially off-the-shelf available computing hardware. Since the functionality of the receiver is defined in software, such a receiver is more flexible. One of the first such pulsar backends was Coherent Baseband Receiver for Astronomy (COBRA) and similar backends have been made operational at Westerbok, Arecibo, Parkes and Green Bank Observatories recently . A new pulsar instrument for GMRT, based on this approach, is described in this paper. The salient features of this instrument are described in Section [\ref=sec2]. The results of test observations, demonstrating the high time resolution capability of the instrument, are discussed in Section [\ref=sec3]. Finally, the future development of this approach is outlined in Section [\ref=sec4].

Pulsar Software Baseband Receiver

Pulsar Software Baseband Receiver (PSBR) implements the signal processing, required for obtaining high time resolution high SNR pulsar data, using portable, open-system, flexible and upgradeable software. PSBR consists of a commodity high speed data acquisition card and a Beowulf cluster of 4 off-the-shelf commodity personal computers (PC) connected by a Gigabit Ethernet switch as shown in Figure [\ref=fig1]. The current configuration of PSBR uses PCs with single 2.3 GHz processor running open-source Linux, 1 GBytes random access memory (RAM), 200 GBytes disks and a motherboard with Peripheral Connect Interface (PCI) bus. A high speed acquisition card that supports a 32K words First In First Out (FIFO) buffer and data transfer to user RAM using scatter-gather Direct Memory Access (DMA) at 80 MBytes/s sustained data transfer rates on a typical PCI bus, is used to acquire digitized raw data.

The existing analog and digital data pipeline of GMRT is used to obtain baseband data for the two polarizations of the received radio frequency signal. A 512 point Fast Fourier Transform (FFT), followed by phase compensation for each antenna , is carried out by the GMRT correlator in this pipeline and these phased voltages from different antennas are added using GMRT Array combiner . These data are acquired in PSBR at a rate of 64 MBytes/s (corresponding to a bandwidth of 16 MHz) using the high speed acquisition board mounted in the server PC, which farms out data by either a Transmission Control Protocol (TCP) or Message passing interface (MPI) over the Gigabit switch to signal processing PCs.

The PSBR has three modes of operations : (1) high time resolution baseband recording mode, (2) Polarimeter and Incoherent array mode and (3) on-line coherent dedispersion mode. The acquired data are recorded to a local hard-disk or SDLT tape with a sampling time of 250 ns and 8 bit precision in the baseband recording mode for off-line coherent dedispersion. As the data acquisition rate is close to the maximum possible sustained bandwidth supported by the motherboard used, extensive caching is used in the software. The baseband recorder program is a multi-threaded program, which carries out acquisition, data sequence checks and disk write functions concurrently. Each concurrent stage has three to eight 16 MBytes cache buffers to maintain the continuity of the data. Figure [\ref=fig2] illustrates the typical time taken by the concurrent sections in a 30 minute 4 MHz observation. The available observation bandwidth is limited by the available motherboard bandwidth and disk write rate, which is probably the cause of the spiky behaviour in disk write times visible in Figure [\ref=fig2]. Tests have indicated a stable operation for a maximum observation bandwidth of 4 MHz, although data for a bandwidth of 8 MHz can also be acquired under ideal conditions. This translates to a typical data volume of 56.25 GBytes per hour for a bandwidth of 4 MHz. The data is backed up on an available SDLT tape drive after each observation.

The first mode was designed to make use of the GMRT Array Combiner to carry out simultaneous multi-frequency observations of pulsars and for observations of pulsars with uncertainties in known DM. GMRT Array Combiner provides a facility to selectively mask any of 256 frequency channels provided by the digital filterbank implemented in the GMRT correlator. This feature is used to group available antennas in two phased array groups operating at different observational radio frequency simultaneously. Such a configuration can be used with baseband recording mode of PSBR to carry out simultaneous multi-frequency observations of pulsars. This mode, exploiting the unique multi-element multi-frequency nature of GMRT, is very useful for spot DM determinations. An example of such observations is illustrated later. The estimated value of DM can then be used to get high quality folded profiles using the on-line coherent dedispersion mode later.

In the polarimeter mode, the acquisition software carries out the relevant complex multiplications of the two polarized voltages on-line to generate full stokes parameter time series, which can then be integrated upto a desired sampling time (in excess of 128 μs). This reduced data is then farmed over the Gigabit Ethernet to signal processing PCs using TCP/IP protocols, where different software modules carry out on-line incoherent dedispersion / folding and simultaneous display in one of three different formats - bandshapes, collapsed integrated profiles and full 256 channel integrated profiles. The integrated profiles display, shown as an illustration in Figure [\ref=fig3], shows the integrated profile for the initial and current sub-integrations, a grey scale plot of the dedispersed integrated pulsar data as a function of pulse phase and sub-integration number and a part of the dedispersed time series. Similar plots emphasizing the received intensity as a function of channel number are shown in the bandshapes and 256 channel integrated profiles displays. These different on-line displays provide an on-line feel of the different aspects of data to the observing astronomer and are useful in monitoring the quality of observations. The data for full bandwidth available from a GMRT sideband are written to a user specified disk file or an SDLT tape in the signal processing PC with 16 bits precision. The disk/tape write rate and the data volume depends on the integration time selected for this mode and is 15.26 MBytes per second and 53.6 GBytes per hour respectively for the fastest mode which has been tested for stable operation (sampling time -   128 μs ; observation bandwidth -   16 MHz). This mode was designed with a view to provide a backup backend in case of a hardware failure of the old GMRT pulsar backends and can support all current pulsar observations with GMRT.

In the on-line coherent dedispersion mode, the baseband data for 2 MHz bandwidth is dynamically farmed to one of the three signal processing nodes using MPI protocols for coherent dedispersion and for subsequent display and recording of reduced average pulse profiles. The MPI programs treat the entire Beowulf cluster as a single 4 processor system and implement data acquisition, inter-processor communications and signal processing in logically separated, concurrent and independent modules. The communication module keeps track of the availability of signal processing nodes and the processed data and accordingly allocates newly acquired buffers to idle nodes. It also collects processed data and integrates these into sub-integrations of user specified duration, which are written to disk as well as displayed on-line. The signal processing module carries out coherent dedispersion by convolving the raw data for both the polarizations with a filter, which implements a transfer function inverse to that of ISM . This is followed by a phase coherent folding of the pulsar time-series. The software is so organized that this module can be replaced by another module implementing alternative signal processing such as a software filterbank making the functionality of the receiver flexible. The typical data volume for this mode depends on the user specified sub-integration time and the desired number of bins across the integrated profile. It is typically less than a few MBytes per hour. This mode is intended for high precision timing of the pulsars with well determined DM on a routine basis.

The data acquisition is synchronized with the minute pulse from Global Positioning System (GPS) for generating time-stamps for all three modes of PSBR. The modes can be configured from user specified parameter files and can be controlled from Telescope control using simple commands.

The signal processing for each of this functionality is implemented in software in a modular form so as to allow modification / upgradation by replacement with new functional modules. The definition of functionality of the receiver in software makes it flexible as opposed to earlier hardware implementations. This is best illustrated by the three different modes of PSBR, which use the same general purpose hardware. Thus, the design of the receiver both in its hardware and software components resembles the concept of a Software Defined Radio (SDR), which is fast becoming popular in industry for similar reasons.

Results

The baseband recorder and the polarimeter mode of PSBR have been under test since October 2004 and have given a stable performance. The on-line coherent dedispersion mode is being tested currently and efforts are on to enhance bandwidth in this mode. The main objective of this receiver was to obtain high time resolution pulsar data for studies of the kind indicated in Section [\ref=sec1]. Hence, test observations of suitable pulsars were carried out and the results, highlighting the capabilities of the instrument, are discussed in this section.

A handful of pulsars show narrow micro-second scale intense single pulses, called Giant Pulses (GPs), with intensities exceeding the average intensity by a factor of 100. Coherently dedispersed observations of such pulses are required to resolve the structure in these pulses. Such observations provide a good test for the high time resolution capabilities of PSBR. Figure 4a shows the profile of a GP of PSR B0531+21 in data obtained at 610 MHz with 250 ns time resolution. The GP profile clearly shows the nano-pulses reported earlier and is consistent with their observations. Unique high quality data for single pulses from this 33 ms pulsar can be obtained using PSBR with GMRT as the phased array of GMRT is capable of resolving the strong radio emission from the surrounding nebula, thus allowing a probe into the weaker radio emission of the pulsar. This figure also shows uncalibrated linear and circular polarization profile suggesting that GPs are highly polarized.

Many pulsars show structure at micro-second scale in their single pulses, which is called micro-structure. Figure 4b shows high resolution observations of two single pulses of PSR B1133+16 in data obtained at 610 MHz with 500 ns time resolution. The pulses clearly show significant spikes, probably with a characteristic periodicity. These micro-pulses are consistent with previously reported observations . Such studies, particularly as a function of frequency of observation, will be useful in constraining the pulse emission mechanism.

PSR B1937+21, a millisecond pulsar with the second shortest known period (1.5 ms) and a high Dispersion Measure (DM ~   71 pc cm- 3), is another pulsar best suited to characterize the high time resolution capability of PSBR. The current GMRT backends give only 12 bins across its average profile at 610 MHz, which has a dispersion smear of about 2 bins. The dispersion smear is larger than the period, when this pulsar is observed with the current GMRT backends at 235 MHz. The upper plot of Figure 5a shows the coherently dedispersed average profile of this pulsar obtained at 610 MHz with a sampling time of 250 ns and folded to 512 bins with an effective bin-size of 3 μs. The corresponding profile at 235 MHz smoothed to 64 bins is shown in the lower panel of Figure 5a. Whereas the 610 MHz profile is consistent with similar observations at this frequency, the 235 MHz profile has been obtained for the first time to the best of our knowledge. The pulsar is not detected in observations with old backends, which provide incoherently dedispersed data. Such profiles will be useful to study the evolution of average profile components with observing frequency for a much larger sample of MSPs available now as compared to those reported earlier . Moreover, PSBR gives the full Stokes profile and this will be useful in polarization studies , particularly as a function of observation frequency.

The lower frequency profile in Figure 5a shows broadening of the pulse due to scattering in ISM. Assuming an exponential scattering tail, these two frequency measurements yield a scattering time scale of ~   300 μs. This estimate, together with previous measurements , indicates that scattering towards this pulsar scales as ν- 4, consistent with turbulent scattering. Thus, such multi-frequency profiles will be useful probes for studies of scattering in ISM. Although the scatter broadening seen for this MSP does substantially reduce the time resolution for MSPs at frequencies below 300 MHz, it should be noted that the scatter broadening is a function of Galactic longitude as well as Galactic latitude. Consequently, it is possible to get reasonable time resolution for many high latitude MSPs at low radio frequencies, particularly for the MSPs in the anti-center direction.

Simultaneous high time resolution multi-frequency observations are useful to obtain accurate estimates of DMs of pulsars. Figure 5b shows the averaged pulses for PSR B1642-  03 obtained using GMRT Array Combiner and PSBR in two frequency simultaneous baseband recording mode (explained in Section [\ref=sec2]) with GMRT antennas operating at 613 and 237 MHz. The smoothed time resolution of the two profiles is 50 μs and the pulsar was observed for 300 s. The difference in arrival time of the pulse in the upper panel of Figure 5b is due to the error in the assumed nominal DM for this pulsar and can be used to estimate the required correction to the nominal DM. The lower panel of Figure 5b shows the averaged pulse at the two frequencies after the estimated correction was applied. It is possible to obtain high SNR profiles with a time resolution of 10 μs in half an hour to two hour observations using GMRT phased array for most pulsars. With this time resolution, it is possible to measure DM offsets of the order of 0.0001 pc cm- 3, provided the pulsar exhibits an average profile with a sharp pulsed feature. Such observations over multiple epochs can also be used to study the fluctuations in electron column densities towards the pulsar.

As PSBR is likely to play an important role in high precision pulsar timing, test observations of PSR B1937+21 to characterize its timing accuracy were also carried out. Time of Arrival (TOA) data, acquired during these tests, were analyzed together with older low time resolution data on this pulsar using the pulsar timing package TEMPO to estimate the improvement in timing errors for MSPs. Figure [\ref=fig6] shows TOA residuals obtained with PSBR for this pulsar after a suitable pulsar model fit in comparison with low time resolution data. As is evident from the figure, residuals of the order of 1 μs are routinely possible, even at 610 MHz, for short observations.

Planned Improvements

As PSBR is implemented in software, a similar receiver for the second sideband of GMRT can be commissioned very rapidly and such a receiver is being planned. As the two sidebands are independent pipelines, this will enhance the capability for simultaneous two frequency observations. In addition, a new interface card, which will allow the data to be acquired from either the incoherent array output or the phased array output of GAC under full software control, is currently being commissioned. The above development will provide a complete backup of the existing pulsar backends and further underscores the flexibility of the software based instruments.

As has been known since the time COBRA was designed, the bottleneck in extending the bandwidth of such a system without multiple copies is the rate (~   32 MBytes/s) at which data can be transfered to PC RAM through PCI bus . Recently, PC manufacturers adopted a new standard for this bus, known as PCI Express (PCIe), which promises to push this bandwidth to beyond 16 GBytes/s. This bus has been adopted enthusiastically by the industry and an extension of PSBR using PCIe based data acquisition cards is planned.

Lastly, it is desirable to develop a wide-band (~   400 MHz) single antenna clone of PSBR with new high speed digitizers and a Beowulf cluster of PCs, reusing much of the software developed for PSBR. Single antenna operation eliminates the need for phasing and the variations introduced by the use of separate antenna sets from epoch to epoch. Consequently, a large number of pulsars can be observed in an automatic mode. Moreover, such observations can be carried out concurrently with other GMRT observations exploiting the GMRT sub-array mode, where one antenna can be used for pulsar observations concurrently with the other 29 observing a different (even a non-pulsar) source. Such a backend can be used with the existing 400 MHz wide 21 cm feed on GMRT and will also provide a digital backend for other wide-band feeds proposed in the GMRT upgrade. The prime motivation of such an instrument is regular monitoring of pulsars for high precision timing studies. The feasibility of various designs is being evaluated currently.

ACKNOWLEDGMENT

We thank the staff of the GMRT for their help during tests. GMRT is run by the National Centre for Radio Astrophysics of the Tata Institute of Fundamental Research.