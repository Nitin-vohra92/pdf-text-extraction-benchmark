Streams Going Notts: The tidal debris finder comparison project

, Jiaxin Han2,4, Hanni Lux3,9, Yago Ascasibar5, Peter Behroozi6,7,8, Alexander Knebe5, Stuart I. Muldrew3, Julian Onions3, Frazer Pearce3 1 Sydney Institute for Astronomy, University of Sydney, Sydney, NSW 2006, Australia 2 Key Laboratory for Research in Galaxies and Cosmology, Shanghai Astronomical Observatory, Shanghai, 200030, China 3 School of Physics & Astronomy, University of Nottingham, Nottingham, NG7 2RD, UK 4 Institute of Computational Cosmology, Department of Physics, University of Durham, Science Laboratories, South Road, Durham DH1 3LE, UK 5 Departamento de Fsica Teórica, Módulo C-15, Facultad de Ciencias, Universidad Autónoma de Madrid, 28049 Cantoblanco, Madrid, Spain 6 Kavli Institute for Particle Astrophysics and Cosmology, Stanford, CA 94309, USA 7 Physics Department, Stanford University, Stanford, CA 94305, USA 8 SLAC National Accelerator Laboratory, Menlo Park, CA 94025, USA 9 Department of Physics, University of Oxford, Denys Wilkinson Building, Keble Road, Oxford, OX1 3RH, UK

Introduction

A series of papers have been devoted to comparing the results of various (sub)halo finders on the same data sets [\citep=knebe2011] [\citep=onions2012] [\citep=knebe2012a] [\citep=knebe2013a]. As a first paper of its kind, this work introduces and compares systematic ways of finding tidal debris from disrupted subhaloes in fully cosmological simulations. The motivation for this study is quite simple: a wealth of information has been extracted from studies of subhaloes in cosmological simulations [\cite=moore1999] [\cite=gao2004] [\cite=gill2005] [\cite=springel2008] [\cite=diemand2008] [\cite=stadel2008] [\cite=elahi2009] [\cite=libeskind2010] [\cite=knebe2011b] [\cite=gao2012]. The growing need for reliable and fast analysis tools of N-body simulations has led to a surge in the number of (sub)halo finders available. Subhaloes, however, are not the only substructures present in haloes. A halo's tidal field will distort and destroy subhaloes. These disrupted substructures leave behind dynamically distinct tidal streams and shells, which may constitute a substantial fraction of the host's mass (e.g. [\citealp=helmi2003] [\citealp=knebe2005] [\citealp=warnick2008] [\citealp=cooper2010] [\citealp=libeskind2011] [\citealp=maciejewski2011]).

The properties and distribution of tidal debris from fully cosmological simulations offers a new window on the formation history of haloes. For instance, streams offer a way of sampling the underlying potential and possibly testing different theories of gravity (e.g. [\citealp=johnston2005] [\citealp=law2010] [\citealp=penarrubia2012]), although studies have typically focused on the evolution of disrupted satellites in idealised situations. Deep surveys, such as GAIA [\citep=gaia2008] [\citep=gomez2010], will allow observers to search for stellar streams, providing a new window with which to test the current paradigm of structure formation or 'Near-Field' cosmology [\citep=freeman2002]. Finally, the number, velocity profile and mass of these streams will have important ramifications for direct and indirect dark matter searches (e.g. [\citealp=stiff2001] [\citealp=vogelsberger2008] [\citealp=fairbairn2009] [\citealp=kuhlen2010] [\citealp=alhen2010] [\citealp=cdms2011]).

Tidally disrupted substructures present a special challenge for many substructure finders, as most identify substructures by searching for clustering in configuration-space. Tidal debris need not show up as an overdensity, consequently configuration-space finders are completely ill-suited to this task. In the past, the inability of these algorithms to detect tidal streams has mainly been addressed by tracking previously tagged particles of an accreted halo in time (e.g. [\citealp=bullock2005] [\citealp=warnick2008] [\citealp=cooper2010] [\citealp=helmi2011] [\citealp=rashkov2012] [\citealp=kuhlen2012]). However, requiring temporal information severely limits the search for streams, and such techniques cannot be directly applied to observational data sets, which only provide an instantaneous snapshot of "particle" (star) positions. Observational missions such as GAIA hope to measure the phase-space positions of millions of stars [\citep=gomez2010] [\citep=lindegren2012]. Searching through this data set for kinematic structures, such as stellar streams, in our Galaxy will require tools that can robustly identify these structures without the need to follow their evolution.

Furthermore, simply tracking particles tagged by a structure finder is not enough. An accreted substructure will begin to phase-mix as it orbits the host. After many orbital periods in an evolving potential, it is unlikely that a tidally disrupted substructure will still occupy a well-defined volume in phase-space, particularly since N-body codes do not explicitly conserve phase-space density. Additionally, an accreted halo does not stop growing simply because it has entered the virial radius of another host halo. In the low density environment at the outskirts of a host halo, these new subhaloes may accrete some mass (see for instance [\citealp=hbt]). Therefore, identifying coherent dynamical structures such as unbound tidal debris by a tracking algorithm necessitates the application of a dynamically motivated criterion when pruning particles. For subhaloes this takes the form of removing unbound particles. For tidal debris such as streams, one can make use of the fact that they are kinematically cold, physically extended substructures that are tightly distributed about integrals of motion in slowly varying potentials (e.g. [\citealp=helmi1999] [\citealp=penarrubia2006];[\citealp=mcmillan2008]).

However, one does not have to solely rely on tracking particles to identify streams. As streams should occupy specific volumes in phase-space and appear clustered in orbit space, algorithms which use velocity information should in principle be able to identify tidal debris (e.g. [\citealp=enlink] [\citealp=maciejewski2011] [\citealp=ascasibar2010] [\citealp=rockstar] [\citealp=elahi2011]). One of the goals of this work is to examine in a systematic fashion how well these non-tracking codes recover tidal streams by comparing them to a tracking method using fully cosmological simulations. To this end, we cross-correlate the substructures identified and examine the recovered properties of these substructures. We note that the performance of some of the codes mentioned have been tested using non-cosmological simulations, naively assuming that toy models of satellite disruption captures the full complexity of structure formation. Here we take a far more realistic approach and asses the ability of codes to recover tidal debris in fully cosmological simulations, where tidal debris can be heated by encounters with other substructures and can originate from (sub)haloes which contain their own (sub)substructure. These tools can, in principle, be applied to observational data to search for stellar structures. However, here we focus only on dark matter structures, which occupy larger phase-space volumes than stars and hence phase-mix quicker than stellar structures and are consequently harder to detect.

Our paper is organized as follows: in section [\ref=sec:data], we briefly summarize the data sets used and outline the common post-processing pipeline. We summarize the different algorithms used in §[\ref=sec:algorithms]. We present a detailed comparison in §[\ref=sec:results]. First, in §[\ref=sec:classification] we present several substructure properties used to determine whether a substructure is a subhalo or should be considered tidal debris. We give an overview of the general results and then present how well different types of substructures are recovered, focusing specifically on unbound substructures in §[\ref=sec:generalresults]-[\ref=sec:cross-matching]. The properties of the substructure distribution function are discussed in §[\ref=sec:substructureprop]. We summarize our results in §[\ref=sec:discussion], and conclude by outlining future studies and improvements in the search for and study of tidal debris in §[\ref=sec:conclusion].

Numerical Methods

Simulations

The data used in most of this comparison study comes from the Aquarius project [\citep=springel2008]. It consists of multiple dark matter only re-simulations of a Milky Way-like halo at a variety of resolutions performed using gadget3 (based on gadget2, [\citealp=gadget2]). We have used in the main the Aquarius-A halo dataset at z  =  0 for this project. The underlying cosmology for the Aquarius simulations is consistent with that used in [\cite=springel2005] and only mildly inconsistent with the latest WMAP data [\citep=wmap9]. Precise details on the setup and performance of these simulations can be found in [\cite=springel2008]. Here we focus on the level 4 resolution halo which is composed of [formula] particles.

Post-processing pipeline

As with the other studies in this series, all substructure finder results are subjected to the same post-processing pipeline. Each code representative was asked to return a list of substructures and the list of particle ID's belong to that substructure. Note that two of the finders used in this comparison, rockstar and hot6d, allow particles to belong to multiple substructures in the substructure hierarchy. For example, a particle residing within a subsubhalo is included in the list of particles for the subsubhalo, its host subhalo, and the halo itself. The two others only allow a particle to be associated with one substructure at the deepest level of the substructure hierarchy, which in the example given would be the subsubhalo composed on the fewest particles. Either of these approaches are acceptable. For the sake of clarity we prune the lists so that particles only belong to the substructure composed of the fewest number of particles.

We then calculate various properties for each substructure to quantify its dynamical state and phase-space morphology. We iterate to find a substructure's centre-of-mass till the radius encloses the inner most, densest 10% of the particles. It should be emphasized that for completely disrupted substructures, such a quantity does not have the same physical significance. The centre-of-mass velocity, [formula], is determined using the same region as the centre-of-mass.

To determine the dynamical state of a substructure we use it's energy distribution. The specific energy of the ith particle is

[formula]

where the potential is calculated only using the particles in the group. Studies of (sub)haloes often require that the substructure be "self-bound", that is all particles must have Ei < 0. Tidal debris, by its very nature, is not self-bound. Thus, we quantify the dynamical state of a substructure using the fraction of particles with negative energy, fE.

Next we determine how anisotropic the substructure is in both configuration- and velocity-space. To determine the physical morphology, we follow [\cite=dubinski1991] and [\cite=allgood2006] and diagonalize the weighted moments of the reduced inertia tensor

[formula]

The ellipsoidal distance between the subhalo's centre of mass and the nth particle is

[formula]

Here q2  =  λ2  /  λ1 & s2  =  λ3  /  λ1 are the intermediate and minor axis ratios respectively, λi are the ordered eigenvalues of Ĩi,j, and [formula] coordinates are in the eigenvector frame.

This method accurately recovers the orientation of an ellipsoid. However, due to the inverse radial weighting, the axis ratios tend to be systematically overestimated, making structures appear slightly more spherical than they really are [\citep=zemp2011]. The reason we use this tensor in spite of this bias is to ensure that the morphology is not severely skewed by the presence of a few very distant particles. We emphasize that the physical meaning of these eigenvalues for completely disrupted amorphous substructures is not obvious, unlike the case for ellipsoidal substructures. Tidal debris may be spread over several orbits with regions containing particles that are at different orbital phases, contain kinks and radial shells. However, most stream-like substructures will tend to have a small physical extent in directions normal to their orbital plane, i.e. s is small. Visually, we find stream like structures have [formula] (see Fig. [\ref=fig:phasespacemorph]). We emphasize that we do not use the inertia tensor to determine a substructure's shape but the deviation from a spherical distribution. Determining the shape of tidal debris, by using some combination of the inertia tensor and Minkowski functionals, is beyond the scope of this paper.

We characterize the velocity anisotropy in a similar fashion using [formula] and [formula], where σ21, σ22 & σ23, are the ordered eigenvalues of the global velocity dispersion tensor,

[formula]

For well virialized ellipsoidal substructures, σ1  ~  σ2  ~  σ3 (see for instance [\citealp=vogelsberger2009b] which shows that the velocity dispersion along the three main velocity eigenvectors of a halo do not differ significantly, though the halo's velocity distribution is still anisotropic). This tensor suffers from the same limitations as the inertia tensor. The physical interpretation of the eigenvalues for an ellipsoidal velocity distribution is clear whereas tidal debris need not be well characterized by a global velocity dispersion tensor. Again, as we do not attempt to characterize the velocity distribution of an entire substructure, this limitation is not an issue. We simply use the eigenvalues to quantify the anisotropy of the velocity distribution. As a substructure is stretched along its orbit, the inferred global dispersion along the direction of the orbit will appear to increase due to orbital gradients. In comparison, dispersions in directions orthogonal to the orbit should not evolve significantly [\citep=binneytremaine2008] [\citep=helmi1999] [\citep=johnston2001]. In fact, if phase-space density is conserved, the structure should become kinematically colder as it is stretched physically. However, phase-space density is not explicitly conserved in N-body simulations, though in N-body simulations with sufficient resolution it is conserved [\cite=helmi2003]. Moreover, the presence of other substructures will tidally heat the substructure and substructure will not be on a closed orbit in the evolving triaxial potential of the host halo. Regardless, we should expect substructures to appear comparatively cold in one direction, i.e. small sv.

The Substructure Finders

Identifying dynamically distinct tidal debris in cosmological N-body simulations poses many intriguing challenges. Despite the wealth of algorithms designed to identify haloes [\citep=knebe2011] and subhaloes [\citep=onions2012], many of these codes cannot be adapted to identify tidally disrupted substructures due to their need for an unbinding process [\cite=onions2012b]. Here we briefly outline the substructure finders used in this study which can detect tidal debris, and clearly state the differences in the methodologies used. We should emphasize that these codes do not pass their candidate substructures through a so-called "unbinding" routine to prune particle lists, as is often done for subhalo finders and these codes have been run "blind", using parameters the code authors deem reasonable. For readers who are not interested in the details of any particular finder, we summarize the key differences in §[\ref=sec:diffalgo].

S-Tracker

s-tracker is a tracing algorithm we have developed based on the Hierarchical Bound Tracing algorithm ( hbt) [\citep=hbt]. The algorithm works in the time domain to trace the evolution of all FOF haloes accreted by other larger FOF haloes. As the algorithm tracks particles, the substructures identified originate from a distinct FOF halo and therefore no particle is incorrectly associated to a substructure. The key difference between this code and hbt lies in the criterion used to prune particles in the substructure. hbt was concerned with correctly identifying the descendant self-bound subhaloes, thus only retained particles with negative energy Ei  =  φi + Ki < 0. One might naively assume that relaxing the energy criterion, e.g. by requiring αφ + Ki < 0 with α > 1, would be sufficient to recover unbound tidally disrupted substructures. However, this is not the case. As energy is measured relative to a reference frame, in this case the centre-of-mass velocity, different portions of a tidally disrupted object will have different relative energies. Setting a energy limit amounts to imposing a spherical velocity dispersion cut relative to the centre-of-mass velocity. Determining the optimal cut for any given tidally disrupted structure is not trivial. Consequently, such a criterion will never recover dynamically distinct shells or regions of a very physically elongated stream that lie a great distance from the centre-of-mass (for more discussions on unbinding see [\citealp=knebe2013a]).

However, if particles originating from the same progenitor and initially occupying the same region in phase-space should remain neighbours in phase-space. We therefore track particles originating from the same progenitor that remain linked using a similar criterion to the one used in [\cite=elahi2011], that is where [formula] is the physical linking length, Vr is the velocity ratio, and cos Θop is the cosine between the two particles velocities. The first criterion is the standard fof criterion, linking particles that are separated by a distance less than [formula] times the inter-particle spacing. The last two criteria ensure that particles have similar velocities. In this analysis we use [formula], Vr = 3, and cos Θop = 0.85. The algorithm also keeps track of substructure hierarchy. The hierarchy is ordered in accretion time akin to the hierarchy in a halo merger tree, that is if a halo is accreted by a larger halo, which is itself accreted at a later time, said halo resides at the 3rd level in the substructure hierarchy. Consequently, if a particle is removed from one (sub)substructure, it is added to the pool of the parent (sub)structure candidate particles. Thus, in this approach substructures can grow via the complete disruption of internal substructure.

The algorithm requires that the time domain be well sampled, roughly 50 or more snapshots are needed [\cite=hbt]. We use 128 snapshots, ensuring few substructures composed of [formula] particles are not tracked by the algorithm. As a consequence of the zero contamination and low loss, we use the output of this code as our reference. However, it should be noted that since this algorithm must process every output, it is by far the slowest algorithm of the four studied here.

VELOCIraptor (a.k.a STF)

velociraptor (formerly known as the STructure Finder, stf) [\citep=elahi2011] identifies substructures by utilising the fact that dynamically distinct substructures in a halo will have a local velocity distribution that differs significantly from the mean, i.e. smooth background halo. This method consists of two main steps, identifying particles that appear dynamically distinct and linking this outlier population using a Friends-of-Friends-like (FOF) approach. Specifically, outlier particles are identifying by estimating the mean velocity distribution function using a coarse grain approach and comparing the predicted distribution to that of a particle's local velocity distribution, which is calculated using a near-neighbour kernel technique. Specifically, the local velocity density is estimated using 32 nearest neighbours in velocity space drawn from a larger sample of 256 nearest neighbours in physical space. By taking the ratio of the local velocity distribution density relative to the expected mean velocity distribution density at a particle's phase-space position, the contrast of particles resident in substructure relative to those in the background are greatly enhanced. The scatter in this estimator is determined by examining the distribution of this ratio, L, which is characterised by a Gaussian distribution corresponding to the virialized background, and numerous secondary peaks located at large values of the ratio arising from particles resident in substructure. The variance about the central main peak is estimated and only outlier particles, which have ratios lying several nLσ away from the main peak, are searched. In this way, we quantify how dynamically different a particle is and the likelihood that a particle is resident in substructure. Particles are linked together if they satisfy the criteria outlined in Eq. ([\ref=eqn:stffof]). Initial candidates are found using an initial linking length, [formula] and then allowed to grow using a much larger linking length. In this analysis, we use nL = 2.5, [formula], [formula], Vr = 2, cos Θop = 0.95. The algorithm also determines if a substructure is significant if the substructure's average ratio is greater than the expected value from Poisson fluctuations.

ROCKSTAR

rockstar (Robust Overdensity Calculation using K-Space Topologically Adaptive Refinement) is a phase-space halo finder designed to maximize halo consistency across timesteps [\citep=rockstar]. The algorithm first selects particle groups with a 3D FOF variant with a very large linking length [formula]. For each main 3D FOF group, it then builds a hierarchy of 6D FOF subgroups in phase-space by progressively and adaptively reducing the linking lengths in configuration and velocity space, so that a tunable fraction (70%, for this analysis) of particles are captured at each subgroup as compared to the immediate parent group. The distance between two particles is

[formula]

where the configuration-space and velocity-space lengths defining the metric are proportional to the position and velocity dispersions, respectively, of the particles in the subgroup. Particles are linked if these distances are less than unity. When this is complete, rockstar converts these 6DFOF subgroups into seed haloes beginning at the deepest level of the hierarchy. If a subgroup only contains one seed group, all particles in it are assigned to that group. Otherwise, when a subgroup contains multiple seeds, particles are assigned based on their proximity to seeds in phase-space using the coarse grain metric determined for that level in the tree. This process is repeated at all levels of the hierarchy until all particles in the base FOF group have been assigned to either a substructure or to the main halo.

HOT6D

hot6d is a structure finder based on HOT+FiEstAS, which is a general-purpose clustering analysis tool still under development. This algorithm performs the unsupervised classification of a multidimensional data set by computing its Hierarchical Overdensity Tree (HOT), analogous to the Minimal Spanning Tree (MST) in Euclidean spaces, based on the density field returned by the Field Estimator for Arbitrary Spaces [\citep=fiestas] [\citep=ascasibar2010]. As explained in [\cite=knebe2011] in the context of halo finding, hot6d identifies substructures with density maxima in phase-space of particle positions and velocities. The boundary of a substructure is set by the isodensity contour crossing a saddle point, and its centre is defined as the density-weighted average of its constituent particles.

Key differences

Although all the finders here effectively define substructures as regions clustered in phase-space, there are differences in the details inbuilt in the approach taken by each algorithm.

s-tracker is a tracking code that applies phase-space criteria to a collection of particles originating from a distinct FOF-halo in order to prune the particle list and return substructure which occupies a specific region in phase-space.

velociraptor was designed to identify physically underdense streams. It estimates the local velocity density distribution relative to the expected mean velocity distribution to identify candidate particles and then links them using a phase-space criterion.

rockstar was designed to identify (sub)haloes, however, its use of phase-space information means that, in principle, it is capable of identifying tidally disrupted substructures. The algorithm uses a coarse grain phase-space metric and an adaptive 6D-FOF algorithm to link particles together.

hot6d was designed to identify clustering in arbitrary spaces. In the current version used here, it estimates the local phase-space density and uses density thresholds and saddle points to identify structures.

We see that s-tracker explicitly assumes substructures originate from FOF-haloes, whereas the others do not. Both s-tracker and velociraptor assume particles residing in a substructure will be physically close and on similar orbits. However the former prunes particles from a candidate substructure using phase-space criteria whereas the latter links particles together to identify candidates. Consequently, s-tracker uses more relaxed criteria when pruning particles. rockstar and hot6d weight configuration-space and velocity-space approximately equally whereas velociraptor is biased towards clustering in velocity-space.

Therefore, some of the differences seen in the following sections are a result of different definitions.

How do algorithms compare?

Identifying tidal debris

The substructure finders used in this study should, in principle, find all types of substructures from relatively compact, spherical, bound subhaloes to unbound shells and streams. Before we can examine how well substructure finders recovery tidal debris we first need to determine whether a substructure should be classified as tidal debris or a subhalo. We use the phase-space morphology, quantified using q, s, qv, sv, and the dynamical state, quantified by fE, discussed in §[\ref=sec:pipeline]. The distribution of these key properties is shown in Fig. [\ref=fig:phasespacemorph] for a subset of substructures in the reference s-tracker catalogue. Recall that all the particle tracked by s-tracker originated from a distinct FOF halo, thus fE is not affected by the inclusion of particles with high relative velocities, i.e. false positives.

This figure shows that there is a strong correlation between the inferred dynamical state and morphology and that substructures span the entire range of these quantities. Substructures with spherical phase-space morphologies, that is [formula], are generally self-bound with [formula], whereas highly anisotropic substructures typically have [formula]. There are a few substructures that appear to have spherical morphologies but are completely unbound. Visual inspection of these substructures show that these are shells or disrupted substructures that have filled quite a large region of their orbit space. We also see that most substructures have s  ~  q and that there are no substructures with [formula] and [formula]. The absence of pancake like substructures indicates subhaloes are generally only elongated along one particular axis as they are tidally stretched.

For simplicity, we use three classes: subhaloes; tidal debris; and the transition region in between. We visually inspect a sample of 40 visually classified tidally disrupted substructures and 40 visually classified intact subhaloes chosen at random from our reference catalogue to determine these limits. We define intact subhaloes, transition substructures, and tidal debris as as Tsub, Tsubtid, and Ttid substructures respectively. The classification criteria, in part based on the work of [\cite=elahi2011], are listed below, where the subscripts sub & tid correspond to subhalo and tidal stream limits respectively. We find that

[formula]

correctly classifies our test sample of substructures. This classification scheme is based primarily on the inferred dynamical state of the substructure, though we attempted to account the transition region using the phase-space morphology. These limits effectively state that if a substructure is generally a bound ellipsoid, its an intact subhalo. As the substructure becomes either more triaxial or less bound, the substructure should be considered a subhalo with tidal features. We consider even substructures that are dominated by an unbound component to be subhaloes with tidal features unless they have anisotropic phase-space morphologies, in which case they are considered tidal debris. Substructures that have very small bound mass fractions, [formula], are considered tidal debris.

An example of the substructures found and how they are classified is shown in Fig. [\ref=fig:morphclass], along with the relevant parameters. These objects are chosen at random from the S-Tracker catalogue as stereotypical representatives of each class of substructure, with the tidal debris chosen to represent a tidal stream, i.e. small s and sv values. We also require objects to be composed of > 1000 particles. The left panel shows a subhalo, the central panel a subhalo with tidal features, and the right panel shows a completely unbound tidal stream. We also show the best counterparts identified by velociraptor, rockstar, and hot6d, and differentiate between particles belonging to the reference substructure from the s-tracker shown and other particles deemed by s-tracker to either belong to a different substructure or the background.

Before we discuss the statistical analysis of this comparison, its informative to visually examine the counterparts found by the non-tracking codes plotted in lower panels of Fig. [\ref=fig:morphclass]. The first obvious issue is that both of the phase-space finders, rockstar & hot6d, have associated seemingly unrelated particles to S44, the subhalo, seen in the left column. These false positives occur because the separation between the two clusters of particles is effectively not significant with respect to the noise in the phase-space metric used, indicating the need for some post-processing. Subhalo candidates are pruned by removing "unbound" particles, which is not applicable here.

The subhalo with tidal features, S47 (middle column), is identified by all finders. However, this substructure contains several completely disrupted subsubstructures, which are not identified as separate substructures by any of the non-tracking codes (see discussion in §[\ref=sec:trackingnotracking]). As a result, the fraction of bound particles is higher in the three non-tracking codes, such that velociraptor classifies this object as a pure subhalo. rockstar & hot6d also incorrectly associate outlying particles.

The picture is far more complicated for the very diffuse stream. It is only partially identified by velociraptor & hot6d. velociraptor recovers a significant fraction of the stream, although the contamination appears high, having associated another substructure with this stream. hot6d only detects a small fraction. We also note that Fig. [\ref=fig:morphclass] indicates that a substructure's classification can change, i.e., [formula] or [formula], depending on the algorithm.

General results

The total number of each type of substructure found by each finder is listed in Table [\ref=tab:overallresults] along with the mass fraction in substructures. This table shows that the number of substructures identified varies greatly, by up to a factor of 1.6, though the total mass in substructures only differs by at most 20%. s-tracker finds the most distinct substructures, hot6d finds the least. We discuss the reasons for these discrepancies below.

We should emphasize that, despite the fact that s-tracker tracks particles, its catalogue is not necessarily complete. First, it relies on the standard FOF scheme to identify progenitor haloes. This scheme can artificially link haloes which are joined by bridges of particles. The two haloes in this FOF-structure will follow different orbits. Consequently, when s-tracker applies its phase-criterion it will find two groups, and as s-tracker only keeps the larger of the groups, only one will end up being tracked. Additionally, a subhalo can accrete mass from its host halo, especially while it still resides in the outskirts, though the amount of mass accreted is small [\citep=hbt]. These newly accreted particles are never tracked as we do not allow substructures to be accreted from the background. Substructures can also merge, though this is rare [\cite=klimentowski2010]. If two substructures occupy the same phase-space volume for a dynamical time, should they be considered two separate substructures even if at some much early stage they originated from two different FOF haloes? There is not a simple answer to this question, hence for simplicity we do not merge substructures in s-tracker. Finally, due to the coarse grain search in the time domain for progenitor haloes, if a halo forms and is accreted between snapshots, these particles will never be tracked. For the data sets presented here, this only becomes an issue for haloes composed of [formula] particles.

How well is tidal debris recovered?

Cross-matching

We quantify how well each finder does using three quantities, the merit, purity and recovery fraction. The merit of a cross match is

[formula]

where Nsh is the number of particles shared by the substructure in the comparison catalogue and with another substructure in the reference catalogue, and N1 and N2 are the number of particles in each substructure [\citep=klimentowski2010] [\citep=libeskind2010] [\citep=knebe2013a]. As a substructure may share particles with several other substructures in the reference catalogue, we are only concerned with the maximum merit of a given substructure. We also calculate the total purity, Ptot, of a substructure, which is the fraction of particles in a substructure that belongs to a substructure that originated from a distinct FOF-halo. Finally, we calculate fraction of a substructure in the reference catalogue recovered in any substructure in the comparison catalogue, R, allowing a substructure to be split into multiple groups. Together, these quantify an individual match, the fraction of false positives, and the total fraction of a real substructure recovered.

The results are plotted in Fig. [\ref=fig:merit]-[\ref=fig:recovery], where we have categorized substructures according to the morphological types outlined in §[\ref=sec:classification]. Note that substructures for Fig. [\ref=fig:merit] & [\ref=fig:purity] are classified according to the morphological type of the substructure found in the comparison catalogue, whereas in Fig. [\ref=fig:recovery] substructures are plotted according to their s-tracker morphological class.

In Fig. [\ref=fig:merit], we show the median and quantiles of the merit distribution in several particle number bins for the three categories of substructures. [\cite=libeskind2010] found that [formula] indicates a viable cross-match has been found. Here we deem any substructure with a merit of [formula] to be completely spurious. Substructures with [formula] can be viewed as substructures that are poorly identified, though this simple interpretation is not always the case for tidal debris (see following discussion on Fig. [\ref=fig:tidaldebris]). If we compare the average merit value between substructure types, we clearly see that for all finders, less tidally disrupted substructures have higher M. More importantly, this figure indicates that subhaloes with tidal features, even those that are predominantly unbound are well matched by an object in the reference catalogue. Only a very small fraction of transitional substructures near the particle limit have no counterpart.

Of greatest relevance for this study is the fact that tidal streams and other diffuse unbound substructures are found with [formula] for all three finders. It should be emphasized that due to the diffuse nature of streams and clouds, recovery can often be patchy, resulting in a stream being split into several different "substructures" resulting in a lower M. The greatest difference between the three comparison finders lie in the fraction of tidal streams not found in the reference catalogue. velociraptor has the fewest number of substructures not well cross-matched to an individual substructure in the reference catalogue. Generally only streams consisting of [formula] particles, near the number cutoff imposed, are not present in the reference catalogue, though there are some small fraction of spurious structures across a wide range of masses. rockstar shows a strong resolution dependence on the number of spurious substructures, with a very large fraction occurring near the 20 particle limit imposed. This is not the case for hot6d, where [formula] of all very diffuse loosely bound substructures are spurious regardless of the number of particles the substructure is composed of.

Not all extra substructures in the non-tracking catalogues need be truly spurious detections. One possible source is from the fragmentation of a s-tracker substructure. This tracking code applies a phase-space window to link particles originating from a progenitor halo. If a fragment of a substructure at a given snapshot lies outside this window, it will no longer be tracked. However, given the large phase-space window used and the fact that most of these objects do not have a viable cross match in the other catalogues, suggest they are truly spurious substructures. Another potential source for these excess substructures are mergers. [\cite=behroozi2012] found that particles can be excited to high kinetic energies and be ejected from the host halo during merger events. These particles do not constitute a coherent dynamical structure but due to their kinematic properties greatly differing from the background, they could be grouped together and identified by the non-tracking codes as a substructure.

The merit shows a mild inverse dependence with particle number, that is more massive substructures tend to have smaller merits. This trend is for Tsub & Tsubtid substructures is primarily due to the presence of tidally disrupted subsubstructures and relates to when a substructure should be considered to have phase-mixed with its host. There is no simple answer to this question. In such instances, the non-tracking finders may identify a single substructure, whereas s-tracker may continue to track each substructure separately. Larger subhaloes are more likely to have accreted other substructures and better resolved subhaloes will have contained more substructure as a halo prior to be accreted themselves, hence the observed trend. The case is different for tidally disrupted substructures, where lower merits can occur when a single tidally disrupted substructure is split into several groups. Another complication is that tidally disrupted substructures have a higher likelihood of occupying the same space as another substructure due to their extended volumes. Consequently, non-tracking codes might consider the enveloped substructure as part of the tidal debris.

The distribution of Ptot, plotted in Fig. [\ref=fig:purity], shows that subhaloes have very high purities. The mass dependence seen in Fig. [\ref=fig:merit] is no longer present, further indicating that part of the trend in M is due to the grouping together or splitting of substructures. The small amount of contamination seen in subhaloes can partly be accounted for by the fact that s-tracker does not allow substructures to accrete particles from the background. Even the purity for subhaloes dominated by tidal features remains quite high at [formula]. Substructures classified as tidal debris a show a greater number of false positives, with purities around [formula], though some tidal debris has purities as high as 0.8. Note that the distribution of substructures with [formula] is similar to that of substructures with no viable individual cross-match seen in Fig. [\ref=fig:merit].

The recovery fraction plotted in Fig. [\ref=fig:recovery] shows similar trends to the two previous figures. Intact subhaloes and subhaloes with strong tidal features are almost completely recovered regardless of mass (save in the lowest mass bin where particle noise becomes an issue and for the largest subhalo which is dominated by very extended tidal features). Of the three finders tested, hot6d has the strongest dependence on numerical resolution, even for subhaloes. The picture is not so clear when it comes to tidal debris, where several large Ttid substructures in the reference catalogue are missing in all the other catalogues.

"Missing" substructures and disruption

These findings initially suggest that, though the non-tracking codes are able to identify gravitationally unbound tidal debris with a reasonable amount of purity, the fraction recovered is surprisingly poor and does not depend on the size of the structure. However, a closer inspection reveals that these substructures are typically very diffuse clouds of particles that appear to have phase-mixed with the background.

For instance, the largest tidally disrupted substructure in the reference catalogue that is not recovered by the other finders is composed of [formula] particles and was accreted at z = 6.85. This substructure originated from an FOF halo was composed of ≈  105 and by z = 4.77 less than 0.1% of its original mass was self-bound. We plot the accretion and disruption redshift distribution of all missing substructures composed of more that 40 particles in velociraptor catalogue in Fig. [\ref=fig:zaccretenorecovery]. The distribution for rockstar and hot6d for the large missing tidal debris substructures are similar. Here we define the disruption redshift as the redshift at which less than 0.001 of a substructures original mass is self-bound. We see that the accretion and disruption redshifts for these substructures is [formula] and [formula] respectively. Only a few substructures composed of [formula] particles are not found and also not completely disrupted by z = 0. Most of these missing substructures typically have self-bound masses of [formula] times their initial infall FOF mass. We argue that these substructures should no longer be tracked.

Tracking vs Non-tracking codes

Let us now examine the details of the cross-matched examples in Fig. [\ref=fig:morphclass] listed in Table [\ref=tab:groupexample]. The cross-matched substructures for the subhalo and transition substructure in the reference catalogue, S44 & S47, all contain matches to other substructures in the reference catalogue. These "extra" substructures are in fact unbound clouds of particles that reside in the substructure, that is tidal debris of a subsubhalo residing in a subhalo, which appear to have phase-mixed with the background subhalo. Consequently, these substructures are not identified as distinct substructures, though they are completely recovered. A large fraction of the Ttid with large recovery fractions fall into this category. This is the reason that the merit seen in Fig. [\ref=fig:merit] has a dependence on particle number. We note that for S44, only three smaller substructures in the s-tracker catalogue appear to reside in the phase-space volume occupied by S44. The extra substructures associated by the two phase-space based codes, rockstar & hot6d, reside in the patch of unassociated particles seen in Fig. [\ref=fig:morphclass]. Only small fractions of these substructures are recovered, hence the low [formula].

These "extra" substructures raise a question for codes which track tidal debris: at what point should they be considered part of the background? Substructures that are indistinguishable from the halo background are typically disrupted at high z (see Fig. [\ref=fig:zaccretenorecovery]). This is not always the case for these structures, though they typically have [formula]. However, given that these substructures occupy similar phase-space volumes to their host (sub)halo and are loosely bound, it is an open question whether they should be considered separate substructures at all. The phase-mixed substructures account for a significant fraction of the differences in the number of substructures identified by s-tracker's and the non-tracking codes, if one accounts for the spurious Ttid substructures in non-tracking catalogues (see Table [\ref=tab:overallresults]).

Finally, we turn our attention to the stream S41 in Fig. [\ref=fig:morphclass], which appears to be the prototypical tidal stream in the reference catalogue. The velociraptor & hot6d counterparts to the diffuse stream, S41, highlight the difficulty identifying streams. Both finders associate small fractions ([formula]) of the particles s-tracker associates with this stream with other substructures. velociraptor and hot6d contaminant one substructure with these particles where these particles comprise a significant fraction of the substructure ([formula]). Only a small fraction is recovered by hot6d counterpart, but the purity is high, whereas velociraptor recovers a significant fraction but is contaminated by background halo particles and particles belonging to another completely disrupted substructures that intersects this stream. rockstar does not find a viable counterpart, possibly because the structure is very diffuse and elongated in configuration space. However, it does recover a very small fraction ([formula]) of this tidal debris but associates these particles with a Tsubtid substructure, which is an excellent cross-match to a different substructure in the s-tracker catalogue.

The tidal debris example in Fig. [\ref=fig:morphclass] and the trends seen in Fig. [\ref=fig:merit]-Fig. [\ref=fig:recovery] indicate that identifying almost completely disrupted substructures poses a special challenge. There appears to be tidal debris with low merits but high purities or low merits but high recovery fractions. To explore these issues we show a few tidal debris examples with a variety of M, Ptot and R values in Fig. [\ref=fig:tidaldebris]. We emphasize that this figure is not a representative sample of the population of tidally disrupted substructures found by the non-tracking codes. It merely highlights different scenarios.

The first row shows two examples where the non-tracking algorithms perform poorly, associating background particles in the region surrounding a small substructure, which is becoming tidally disrupted. These incorrectly associated particles cause the substructure to be considered Ttid instead of Tsubtid. These examples have low M, Ptot but the entire substructure is recovered.

The examples in the second row are of substructures which recover a small fraction of a tidally disrupted substructure in the s-tracker catalogue. In the example in the left column, both M & Ptot are low but this is not a spurious substructure. Most of the tidally disrupted reference substructure is recovered but has been split into several groups, each with low M. In the example in the right column, the substructure has a low merit as only a small fraction of the large tidally disrupted reference substructure has been recovered by this substructure. However, the substructure in the non-tracking catalogue is not severely contaminated by the background.

The last row shows two different cases. In the left column, the substructure is very pure but has a very low merit. In fact, the reference object with the highest merit is not the object that should be associated with this reference substructure. Most of the particles here originate from the tidal tails of a much larger subhalo composed of [formula] particles. The tidal tails of this large reference substructure happen to intersect this smaller substructure, which is in the process of being tidally disrupted. The right column shows tidal debris object with high merit (recall [formula] indicates a good counterpart has been identified), high purity but low recovery fraction. Here the reference substructure has been split in two, a trailing stream and a leading stream which contains the progenitor subhalo.

Summary of Comparison

In summary, all three non-tracking finders identify tidal debris. The statistics of each finder is listed in Table [\ref=tab:comparisonsummary], where the average M, Ptot, and R listed are calculated excluding the contribution from spurious objects and only for substructures composed of more than 40 particles in order to minimize the effects of poorly resolved substructures. First, we should emphasize that all finders perform remarkable well in identifying subhaloes with significant amounts of mass in unbound tidal features. However, the performance of these finders degrades as substructures become increasingly unbound. Focusing on the statistics of tidally disrupted substructures, we see all the non-tracking finders on average identify viable cross-matches, i.e. [formula], though they all also miss a small fraction of the tidally disrupted substructures present. rockstar has the highest recovery fraction and the highest average merit. velociraptor has the highest overall purity, the fewest completely missing objects and the fewest spurious objects. hot6d has the largest number of spurious unbound substructures and also suffers from numerical resolution issues at particle numbers of [formula], whereas the other two suffer from strong resolution effects for substructures composed of [formula] particles. All non-tracking codes unfortunately identify a non-negligible fraction of spurious objects. These spurious objects and the significantly lower purity suggest that some post-processing may be required, similar in purpose to the unbinding routines used for subhaloes. It is possible that his number can be reduced at the cost of decreasing R by using more conservative selection criteria [\cite=elahi2011].

We note that due to the particle number trends seen in Fig. [\ref=fig:merit]-[\ref=fig:recovery], particularly for M & Ptot, which decrease slightly with increasing particle number in large tidal debris, the exact values listed in the table should be treated with some caution. The increasing volume occupied by tidally disrupted substructures means that lower merits and purities are not unexpected. These structures are more likely to be split into several groups and may envelop other tidal debris, as illustrated in Fig. [\ref=fig:tidaldebris]. Nevertheless, these values are useful for gauging the performance of each code, the incompleteness of the catalogues and the contamination present.

The Substructure Distribution

Mass function

The simplest distribution to examine is the general substructure mass distribution, shown in Fig. [\ref=fig:massdistrib]. A subhalo's mass is not very well defined and the dynamical mass of a stream is even less well defined, especially since the recovery can be patchy. However, at least for s-tracker's catalogue, this distribution is effectively the mass distribution of progenitor haloes modified partially by a tidal field. Before we discuss this figure, it is important to recall some salient facts about the subhalo mass function. The differential subhalo mass function is well characterised by power-law, e.g.

[formula]

where [formula]. [\cite=onions2012] & [\cite=knebe2013a] found that different finders recover the same cumulative subhalo mass function with a scatter of 20 - 30% and individual substructures with a scatter of [formula].

This figure shows that, despite differences in how substructures are identified, these algorithms give similar mass functions. Nevertheless, there are some key differences. s-tracker identifies significantly more substructures but most of these structures are composed of [formula] particles. A careful visual inspection of these excess substructures indicates that most are best described as unbound collections of shells or clouds of particles, often residing in another subhalo as discussed previously. Both rockstar & hot6d find significantly more substructures than velociraptor at low particle numbers, but many of these structures appear to be numerical artefacts (see Fig. [\ref=fig:merit]).

There are also a few differences at the high mass end. Here subhaloes containing completely disrupted subsubstructures have larger masses in the non-tracking codes since these codes cannot separate the subsubstructure from the background substructure and we only allow particles to belong to one substructure (see discussion in §[\ref=sec:cross-matching]). There are also several tidal debris substructures in the s-tracker catalogue not recovered by the other finders as they have effectively phase-mixed with the background.

Finally, numerous studies show that the differential subhalo mass function has a power-law index that is α < 1 but what about the substructure mass function? A power-law of one is a special case where the mass in substructures is logarithmically divergent when extrapolated to arbitrarily small masses. The divergence cannot occur physically as a sharp cut-off in the halo mass spectrum is expected at the thermal dark matter free-streaming scale. Such an index would imply that there is in fact no smooth halo and all of the mass is contained in dynamically distinct substructures down to the free stream scale of dark matter, where structures are composed of the fundamental dark matter streams [\citep=vogelsberger2010] [\citep=abel2012].

In the lower panel of Fig. [\ref=fig:massdistrib], we plot the mass weighted differential specially to explore this issue. The data is too noisy to make conclusive statements but we do see that the s-tracker differential substructure mass function appears to be flatter than the differential subhalo mass function. Unfortunately, given the resolution of A-4, we cannot comment on the degree of change. These results, along with those of [\cite=maciejewski2011], indicate that mergers and tidal disruption modify the substructure distribution in such a fashion as to flatten the mass function.

Velocity dispersion and distinguishing between streams and clouds

The ambiguity of defining an edge for (sub)haloes means MS is not the ideal quantity for characterizing the the subhalo distribution. The situation is even worse when one includes tidal debris. The recovery of tidal debris is patchy. An excellent example is shown in in the bottom right panel of Fig. [\ref=fig:tidaldebris], where the subhalo undergoing tidal disruption in the s-tracker catalogue is split into two groups by a non-tracking code. For (sub)haloes, a more physically meaningful quantity commonly used is the maximum circular velocity, V2 max = GM / R max, which is observable and contains dynamical information. V max is also less prone to scatter ([formula] & [formula] for individual substructures and the full cumulative distribution respectively, see [\citealp=knebe2013a]). However, for completely disrupted, aspherical substructures, it is not a physically meaningful quantity. The velocity dispersion fortunately meets these criteria.

Structures in virial equilibrium have velocity dispersions which depend on the enclosed dynamical mass, i.e. [formula]. Specifically, one can show for a spherical system using the Jeans equation that the local radial velocity dispersion at a radius r is

[formula]

where Vc(r)2 = GM(r) / r is the circular velocity, [formula] is the pseudo-phase-space density [\cite=taylor2001] [\cite=ludlow2010] and [formula] is the anisotropy parameter. Assuming the physical and pseudo-phase-space density profiles are power laws, [formula] and [formula], with minimal dependence on r, one can show that the average velocity dispersion in a sphere of radius R is

[formula]

For spherical (sub)haloes with NFW density profiles, this is a reasonable approximation as [formula] and γ slowly increases monotonically from 1 in the inner regions to 3 in the outer regions. In this case this dispersion peaks at the same radius as the rotation curve, [formula], the NFW scale radius. This radius, R20, also encloses [formula] of the mass, assuming the (sub)halo is truncated at M200.

Unfortunately, we are not dealing with spherically symmetric subhaloes but triaxial subhaloes and physically extended tidal debris. We therefore calculate the velocity dispersion tensor using the inner 20% of the particles, the same region that is used to calculate the centre-of-mass, using a bi-weight estimator. By using a small volume centred on the densest and most bound part of a substructure, we minimize the contribution of orbital gradients and the tidally heated regions of the substructure. The bi-weight estimator also reduces the estimator's sensitivity to outliers. The dispersion tensor accounts for the triaxiality. Here we focus on the maximum & minimum dispersions σ2max & σ2min of the tensor within R20.

We explore the correlation of the central velocity dispersion with the dynamical mass of subhaloes, whether they are intact or they are dominated by tidal features in Fig. [\ref=fig:massveldispersion]. Note that here we plot these quantities for the s-tracker catalogue only. We see that σ2max & σ2min of Tsub and Tsubtid substructures are strongly correlated with the current dynamical mass, with Pearson coefficient of [formula]. A fit to the data, log σ2  =  A + α log (MS / MH), yields [formula] and [formula] for the largest and smallest velocity dispersions respectively. Even for substructures with [formula], that is predominantly unbound, the velocity dispersion is a useful proxy for the total dynamical mass. The scatter here arise in part due to the inherent scatter in triaxiality of velocity ellipsoid and the radius at which the rotation curve peaks relative to the substructures virial radius, which are related to the observed scatter in the density concentration parameter and the triaxiality of haloes [\cite=maccio2007] [\cite=neto2007].

The picture is more complicated for tidal debris. As a subhalo orbits its host, particles outside the tidal radius become unbound. The tidal radius of a subhalo with mass MS at a distance R from the host's centre-of-mass with a velocity V is [formula]. Unbound particles originating from a progenitor subhalo will be spread in configuration and velocity-space on scales of rtid and the dispersion at that radius, where the fractional spread of these particles is approximately equal in both space and velocity (see [\citealp=binneytremaine2008] [\citealp=helmi1999] [\citealp=tremaine1999] for discussion in spread in angle-action space, and [\citealp=knebe2005] for a discussion in the spread of integrals-of-motion space inferred from cosmological simulations). For elliptical orbits in a constant spherical potential, these particles will spread along the orbital plane of the subhalo while the width and dispersion orthogonal to the orbital plane remain roughly constant [\cite=helmi1999] [\cite=johnston2001]. The evolution of the physical and velocity dispersions parallel to the orbital plane within a region is not as clear as the measured dispersion will contain contributions from orbital gradients.

This picture is complicated by the fact that in our cosmological simulations, the potential is not constant, nor spherical and subhaloes have a variety of orbits, resulting in many forms of tidal debris, from shells or clouds (see for instance, [\citealp=johnston2008], who studied the properties in non-cosmological simulations of spherical subhaloes falling into a time-dependent potential containing a bulge, disk and spherical halo, and [\citealp=warnick2008], who examine tidal debris in fully cosmological simulations). Amorphous clouds of tidal debris will have high inferred velocity dispersions that are no longer correlated to their mass as these structures are phase-mixing with the background. However, stream-like substructures should have velocity dispersions orthogonal to their orbital plane that have not been significantly heated and lie near the line defined by subhaloes.

To examine whether streams follow the velocity dispersion relation of subhaloes but shells/clouds do not, we sub-classify tidal debris into stream-like and cloud-like morphologies. A substructure is considered to have a cloudy morphology if s  ≥  ssub or sv  ≥  sv,sub. Using this classification scheme, the s-tracker tidal debris substructures are split into 247 (27%) stream-like substructures and 667 (73%) cloud-like substructures.

The dispersions of this tidal debris are also plotted in Fig. [\ref=fig:massveldispersion]. This figure also shows that the dynamical state greatly affects this correlation. Tidal debris that does not appear stream like, i.e. well confined to an orbital plane with small s & sv values, are significantly hotter, exhibit greater scatter and do not follow the subhalo correlation. These high dispersions indicate that these structures have evolved under the influence of the host halo's tidal field for several dynamical times. Their amorphous morphologies and high dispersions is why it is difficult to recovery these substructures without using temporal information (see discussion in §[\ref=sec:missingobjects]).

However, stream-like substructures do follow the minimum dispersion correlation observed for subhaloes, indicating that this quantity is still a useful proxy for mass. The larger velocity dispersion shows significantly more scatter due to the stretching of the substructure along the orbital plane. There are several outliers that are classified using this scheme as stream-like substructures with dispersions that are a factor of 10 - 100 times higher than the subhalo prediction, indicating either that our classification scheme is not perfect or that these stream-like substructures have been in heated in some way, such as by a close encounter with another substructure.

Now we turn our attention to the prediction for the dispersion distribution from our cosmological simulation. We remove cloudy tidal debris, which has begun to phase mix with the background and does not a physically meaningful velocity dispersion, and plot the cumulative distribution in Fig. [\ref=fig:veldispdistrib] for all finders. This distribution like that of the mass function can be characterised by a power-law, specifically the differential distribution is

[formula]

where σ2min,H is the host's haloes central velocity dispersion. Based on the relation seen in Fig. [\ref=fig:massveldispersion] and the power-law of the mass function [formula], we expect [formula]. This prediction is in good agreement with the data. However, the scatter between the individual finders is quite large, of the order of 20%, with large differences at the high dispersion (or mass) end, similar to what is seen in Fig. [\ref=fig:massdistrib].

Radial distribution

Bound subhaloes are more likely to reside in the outskirts of a halo and, although the number density does increase towards the centre, it does so more slowly than the underlying dark matter density [\cite=ghigna1998] [\cite=gill2004] [\cite=gao2004] [\cite=diemand2004] [\cite=diemand2007] [\cite=springel2008]. This radial distribution does not depend strongly on the algorithm used to identify the subhalo [\cite=onions2012]. [\cite=springel2008] found that the differential number density of subhaloes is well characterised by an Einasto profile, that is

[formula]

where αEin is the shape parameter and r- 2 is the scale radius. We examine the radial substructure distribution via the number density in a spherical volume [formula], and the differences with respect to the subhalo distribution in Fig. [\ref=fig:raddistrib].

This figure shows that the substructure number density within a radius r decreases monotonically with increasing radius but does so at a slower rate than the subhalo distribution. The most pronounced difference between the substructure and subhalo distribution occurs within the central [formula] kpc, that is within [formula] times the radius at which the maximum circular velocity is reached. The subhalo distribution levels off, whereas the substructure distribution continues to increase and has a power-law form. The algorithms do not reproduce the same power-law index, s-tracker having the steepest slope and greatest number density followed by velociraptor, rockstar, and hot6d. Outside the central region, all the algorithms have the same shape though the normalisation differs by [formula] as shown by the fact that the residuals at r > 100 kpc are effectively flat. This outer region does not the same logarithmic slope as the subhalo number density. The large offset between s-tracker and the other algorithms can be account for by the presence of disrupted substructures with cloud-like morphologies that occupy the same phase-space volume as another bound subhalo in the s-tracker catalogue (see discussion on Fig. [\ref=fig:merit] and §[\ref=sec:veldispfunc]).

The significant spike in the substructure number density relative to the subhalo distribution in the central region is due to the increasing tidal disruption rate of substructures. Figure [\ref=fig:radfracEdistrib] clearly shows that the fraction of bound mass in a substructure relative to the mass that is dynamically associated with it, fE, jumps from about zero to [formula] outside a radius of 50 kpc for s-tracker, the catalogue containing no false positives, and velociraptor. Both of these algorithms have a pronounced power-law component in the central 50 kpc. rockstar also has a jump in fE going from the central most bin to the next but the change is not as pronounced as is the slope of the central power-law component in Fig. [\ref=fig:raddistrib]. hot6d is the only algorithm which displays counter-intuitive distribution, with fE decreasing with increasing radius, indicating that the algorithm in its current state becomes progressively worse at identifying tidal debris in the high density regions of a halo.

The agreement between s-tracker and velociraptor suggests that velociraptor has the highest efficiency in disentangling substructure in the dense central regions of a halo. However, the trends in Fig. [\ref=fig:raddistrib] are not necessarily a result of one algorithm being more conservative than another, the sensitivity of a finder to noise also plays a role. velociraptor probably performs the best here because it is by construction maximally sensitive to the velocity component, whereas rockstar and hot6d always attempt to use some spatial information, which has a lower signal-to-noise.

Summary

We set out to examine the full substructure distribution in a dark matter halo and analyse how well (sub)structure finders that use phase-space information compare with one that also uses temporal information. Recall that substructures includes subhaloes, which are a completely self-bound, along with unbound tidal debris. We find excellent agreement between finders regarding pure subhaloes and subhaloes with moderate tidal features, even down to substructures composed of a few tens of particles. Most importantly, all the non-tracking substructure finders are capable of identifying completely unbound tidal debris with a purity of [formula]. Few tidal debris substructures are missed, though all three non-tracking codes appear to identify spurious tidal debris substructures, comprising [formula] of all the tidal debris substructures found, with hot6d having highest fraction of 38% possibly due to the noise in the local phase-space metric used by this finder.

The algorithms also give similar substructure distributions. First, all algorithms show that, not surprisingly, most subhaloes have pronounced tidal features. The fraction of the host halo's mass in substructures is significantly higher that bound in subhaloes, increasing by almost a factor of two from [formula] to [formula], with many of these substructures being completely disrupted.

The mass function does not show any significant variations in shape depending on the algorithm used. The substructure mass function appears to be slightly steeper than the subhalo mass function, though at the resolution used in this study it is not possible to make any conclusive statements. However, combined with the results of [\cite=maciejewski2011], we argue that tidal disruption and mergers flattens the distribution. The slope of the substructure distribution suggests that the halo is composed of dynamically distinct substructures all the way down to the bottom of the Cold Dark Matter hierarchy.

The mass function, though often studied, does not lend itself to direct comparison with observations, thus we turn to the velocity dispersion, which is a good proxy for mass and is an observable quantity. The velocity dispersion distribution recovered by the finders are similar, differing by [formula]. Amongst the non-tracking codes, velociraptor's distribution has the smallest difference with prediction based on the substructure mass function and s-tracker's distribution.

The inclusion of tidal debris significantly alters the radial substructure distribution when compared the subhalo one. Outside the radius at which the halo's rotation curve peaks, the substructure number density is similar to Einasto profile describing the subhalo number density. Inside this radius the number density is dominated by an additional power-law component. Though all the finders have similar shapes for the radial distribution outside the centre, the slope of the power-law component differs greatly. The tracking code displays the steepest slope and the highest central number density, followed by velociraptor, rockstar, and hot6d. This drastic change in the radial distribution is mirrored by the significant drop in the self-bound mass of substructures. Subhaloes are efficiently tidally stripped in this region. This result does not contradict the findings of [\cite=onions2012], who found that phase-space finders did not fair significantly better than configuration-space finders at identifying subhaloes in the central regions. The "negligible" improvement observed is due to the fact that though there are substructures present, effectively none are self-bound at the resolution studied. With improving resolution and the cumulative effect of missing one subhalo in the centre will lead to completely different two-point correlation functions, making this bias quite significant in the end.

Discussion & Conclusion

In this paper, we set out to determine how well substructures finders can recover tidal debris without the need to track particles. This study is a follow-up to the Haloes Gone Mad [\citep=knebe2011], Subhaloes Going Notts [\citep=onions2012], and Galaxies Going Mad [\citep=knebe2012a] comparison projects. The motivation for this comparison study is two-fold. The hierarchical paradigm of structure formation predicts that dark matter haloes are littered with the remnants of disrupted subhaloes. Disrupted dark matter subhaloes may leave signatures that could be detected by direct dark matter detectors as these experiments are sensitive to the local velocity distribution. Though the subhalo distribution has been well studied, the full substructure distribution has not. Additionally, upcoming large simulations will include built-in finders and may not store enough snapshot to accurately track tidally disrupted objects, thus requiring finders capable of detecting unbound substructures.

Second, observations demonstrate that galaxies do not have quiet lives, as shown by disrupted satellite galaxies such as the Sagittarius stream [\cite=ibata2001b] [\cite=belokurov2006]. Upcoming missions like GAIA will find even more examples of murdered satellites. Yet the study of tidal debris in regards to Galactic Archaeology and Near Field Cosmology is still in its infancy. Searching for tidal debris in the GAIA data set requires the development of new tools as one cannot simply follow the orbital evolution of "stars" (particles) to identify tidal debris as is often done with numerical simulations. Hence an understanding of how well substructure finders which solely use phase-space information is sorely needed as these tools could be applied directly to observational data.

We conclude that several currently available substructure finders can correctly identify tidal debris and the tidal features associated with subhaloes in fully cosmological simulations without the need for temporal information. Based on the cross-matching of individual substructures and a comparison of the observed substructure distributions, we argue the most promising non-tracking methods tested here are velociraptor and rockstar. We find all non-tracking algorithms identify tidal features associated with tidally disrupted subhaloes with a high degree of purity, [formula]. The purity of completely unbound substructures is worse at [formula] and there also is a non-negligible fraction of spurious tidal debris substructures. Though our tests conclusively show that these algorithms work reasonably well given the difficult challenge of identifying completely unbound dark matter substructures, there are several shortcomings we do not address. The complex and diffuse nature of tidal debris means that non-tracking codes may split a single structure into several groups, biasing the number distribution. One possible method of accurately merging patches of a stream would be to estimate the elliptical orbit of each patch and determine the likelihood that two or more "streams" have the same orbit and similar velocity dispersions. Finally, the tracking code will continue to follow dark matter substructures that appear to have effectively phase-mixed with the background that are missed by the non-tracking finders. This may not be a serious limitation as many of these objects were completely disrupted more than several Gyrs ago. Whether these objects should be considered distinct substructures or not and determining the time-scale over which a substructure completely phase-mixes is an open question and is beyond the scope of this study.

We have also shown that a significant fraction of a halo's mass is in tidal debris, similar to the amount of mass in subhaloes. We have only scratched the surface of the information that can be retrieved from tidal debris and the tidal features surrounding subhaloes in this paper. For example, semi-analytic models of galaxy formation (SAM) use halo merger trees and the current mass of a (sub)halo to determine the galaxy that resides in said (sub)halo [\cite=benson2011] [\cite=guo2011]. Using the algorithms tested here would allow these models to include the dynamical state of the substructure to alter the galaxy residing in the substructure by accounting for for stellar and gas mass loss, and study the formation of the main galaxy's stellar halo. Currently, the few theoretical studies examining the formation of our Galaxy's stellar halo use semi-analytic models to "paint" stars on a dark matter only simulation and evolve this simulation forward in time [\cite=cooper2010] [\cite=helmi2011], which is significantly more computationally intensive that just using a SAM and certainly prone to limitations as shown by [\cite=libeskind2011].

Another application for these algorithms is in the study of tidally disrupted satellites like the Sagittarius stream and the Orphan stream. The properties of these stellar streams have been used to infer the potential of our Galaxy [\cite=penarrubia2005] [\cite=penarrubia2006] [\cite=law2010] [\cite=koposov2010] [\cite=deg2012] and could be used to test gravity [\cite=penarrubia2012] or search for unseen dark matter subhaloes [\cite=yoon2011]. Typically, these studies examine the velocities and positions of stars in the stream and compare them to simple numerical simulations or models which assume a constant or slowly evolving host potential and neglect the interactions between satellites or substructure in the satellite itself. In cases such as the GD-1 stream, satellite-satellite interactions are probably negligible since the stream is extremely narrow [\cite=koposov2010], though in general this will not be the case. Streams are not the only tidal debris which can be used to study either models of the Milky Way or different forms of gravity. [\cite=sanderson2012] showed that the radial density profiles of shell-like tidal debris in simple toy models can be used to infer the radial gravitational potential at the radial position of the shell. A more complete understanding of the distribution of tidal debris and the effects of satellite interactions on them from cosmological simulations would be invaluable to these studies.

We conclude that these algorithms will open up a new window on galaxy formation by allowing us to study a halo's merger history in more detail using the complete substructure distribution and directly search observational data from future missions such as GAIA for the remnants of tidally disrupted satellite galaxies.

Acknowledgements

The work in this paper was initiated at the Subhaloes going Notts workshop in Dovedale, UK, which was funded by the European Commissions Framework Programme 7, through the Marie Curie Initial Training Network Cosmo-Comp (PITN-GA-2009-238356). We basically thank all the participants of that meeting for all the stimulating discussions and the great time in general and thank the anonymous referee for useful comments on the manuscript.

PJE and JXH acknowledges financial support from the Chinese Academy of Sciences (CAS), from NSFC grants (No. 11121062, 10878001,11033006), by the CAS/SAFEA International Partnership Program for Creative Research Teams (KJCX2-YW-T23). JXH and HL acknowledge a fellowship from the European Commissions Framework Programme 7, through the Marie Curie Initial Training Network CosmoComp (PITN-GA-2009-238356). YA is supported by the Spanish Ministerio de Ciencia e Innovación (MICINN) through the Ramon y Cajal programme, as well as grant AYA 2010-21887-C04-03. also AK is supported by MICINN through the Ramon y Cajal programme as well as the grants AYA 2009-13875-C03-02, AYA2009-12792-C03-03, CSD2009-00064, and CAM S2009/ESP-1496 and the Ministerio de Economa y Competitividad (MINECO) through grant AYA2012-31101. He further thanks Serge Gainsbourg for the roller girl.