Lemma Corollary Proposition Conjecture Remark

Lemma Corollary

Large restricted sumsets in general Abelian groups

Soon after this work was started, the first-named author and main inspirator of this article passed away unexpectedly. The two other authors dedicate the paper to his memory.

Introduction

In this paper G be a finite Abelian group. Given two subsets A and B of G, the sumset and the restricted sumset of A and B are defined, respectively, by

[formula]

We shall write A + b or A - b instead of A + {b} and A  +  { - b}.

To give lower bounds for the cardinality of sumsets is probably the most central problem of additive number theory (see [\cite=Nat96] for a general overview). A historical result in this area is the famous Cauchy-Davenport theorem [\cite=Cauchy] [\cite=Davenport].

For restricted sumsets, the most famous result is due to Dias da Silva and Hamidoune [\cite=DiaHam94] who, in the beginning of the 1990s, solved an Erds-Heilbronn conjecture which remained open since 1964:

Several years later, Alon, Nathanson and Rusza [\cite=AloNatRus96] proposed an alternative proof using the so-called polynomial method, a powerful method which has then inspired a lot of new results in additive combinatorics.

Another important set of problems in the area is known under the name of Critical Pair Theory. Having found a general lower bound for the cardinality of sumsets, the problem is now to achieve the description of pairs of sets, the sum of which attains the lower bound. For instance, Vosper's Theorem describe precisely the pairs of subsets (A,B) in a group of prime order such that |A + B| = |A| + |B| - 1.

We now introduce some notation and tools needed in the sequel and formulate a few basic remarks.

Let G0 denote the subgroup of G composed of elements of order 2 or less, that is,

[formula]

We write L(G) = |G0|, the doubling constant introduced by Lev in [\cite=Lev00]. Notice that if |G| is odd, then L(G) = 1 whereas if |G| is even, L(G) is a power of 2. It is immediate to notice that L(G) is the maximal number of pairwise distinct elements of a group G that can share a common doubling, in other words

[formula]

If two sets A and B of G are given, we denote for any x∈G,

[formula]

the number of representations function. When the context will not make it obvious, we may denote νA,B instead of simply ν. Notice that if |A| + |B| > |G| + L(G), then for any x∈G we have

[formula]

whence [formula].

Finally, for a set A  ⊂  G and [formula], we shall denote

[formula]

and - A = ( - 1)  ·  A. We define the half of a set T  ⊂  G as H(T) = {g∈G: 2g∈T} and the subgroup of doubles in G as

[formula]

Notice that |2  ·  G| = |G| / L(G).

In a recent paper, Guo [\cite=Guo09] studied the problem of restricted sumsets in Abelian groups in the case when the cardinality of the sets is large and proved the following result.

In the same paper [\cite=Guo09], Guo also gave a complete description of the pairs of subsets (A,B) such that |A| + |B| = |G| + L(G) and [formula]. This is the content of the next theorem.

We want to point out that, as it was proved in [\cite=Guo09], if two sets A and B are of the form described in Theorem [\ref=Guo_theo_charac], then the two [formula]-exceptions - by which we mean elements of [formula] - are precisely 2a and 2b.

In this article, we deal with a generalization of restricted sumsets (introduced in [\cite=Sun]) in which a new set appears. Let A,B and S be non-empty subsets of G. The restricted sumset of A and B with respect to S is defined by

[formula]

Notice that, when S = {0}, this sumset corresponds to the classical restricted sumset of two sets. Partial results to the problem of estimating [formula] from below are given recently in [\cite=GuoSun09] [\cite=PanSun02] [\cite=PanSun06]. In particular, Pan and Sun used the polynomial method to study a conjecture of Lev. As a corollary they proved [\cite=PanSun06] the following result.

In [\cite=GuoSun09], Guo and Sun used a variation of Tao's method [\cite=Tao05] in harmonic analysis to prove the next theorem, which is a generalization of Theorem B.

In this paper, applying techniques similar to those used in [\cite=Chi02] [\cite=GalGre] and [\cite=Guo09], we study the restricted sumset of two large sets A and B with respect to a set S, in general finite Abelian groups. Given non-empty sets A,B and S, we first introduce a generalization of the doubling constant L(G) which depends on the set S, that we denote LS. It is easy to see that if |A| + |B| > |G| + LS then [formula] (Lemma [\ref=phS]) and as our first principal result we show that if |A| + |B| = |G| + LS then [formula] (Theorem [\ref=general]). We also characterize the triples of sets (A,B,S) such that |A| + |B| = |G| + LS and [formula] (Theorems [\ref=characterization_even] and [\ref=characterization_general]). Moreover, in this case, we also provide the structure of the set [formula].

The organization the paper is the following. In Section 2, we introduce the terminology and some preliminary results. The key-point in this section is Lemma [\ref=clau]. Section 3 is devoted to the proof of the lower bound. We also give some examples in order to show that our bound is tight. In Section 4, we characterize the critical sets in the important special case LS = |S| L(G). In particular, this gives the characterization the critical sets for Abelian groups of odd order. Finally, in Section 5, we extend the characterization to the case LS < |S| L(G), provided some restriction holds.

Terminology and preliminaries

We first start with two basic results. The first one was baptised Prehistorical lemma by the first-named author.

The second result we shall need is Kneser's Theorem [\cite=Kneser], see also [\cite=Nat96]. It has a lot of applications in additive and combinatorial number theory. We will use it as a key-tool in the characterization of critical sets in groups of even order.

Given z∈G and a non-empty subset S  ⊂  G, we define

[formula]

and

[formula]

The mean-value of LS(z) on G is easy to compute since

[formula]

Therefore, we must have LS  ≥  |S|  ≥  1.

The next lemma will be useful for further reference. Notice that LS(z) = |{y: z - 2y∈S}|.

Let S be a finite non-empty subset of an Abelian group G and let z∈G. Then

We have

[formula]

In particular, LS(z) is a multiple of L(G), less than or equal to |S|L(G).

In particular, [formula].

In particular,

[formula]

for some integer m satisfying 1  ≤  m  ≤  |S|.

If LS  =  |S| L(G), then S is included in a coset modulo 2  ·  G.

If LS(0) = LS  =  |S| L(G), then S is included in 2  ·  G.

The next result can be thought as a generalization of Lemma [\ref=ph]:

Let A,B and S be non-empty subsets of a finite Abelian group G. If |A| + |B| > |G| + LS then [formula].

For any z∈G we have

[formula]

Thus, by definition of LS, one at least among the ν(z) pairs (a,b)∈A  ×  B such that z = a + b must satisfy a - b∉S. Therefore [formula].

Similarly, we obtain the following:

Let A,B and S be non-empty subsets of a finite Abelian group G and assume that |A| + |B| = |G| + LS, in particular A + B = G. Then

For each z∈G, ν(z)  ≥  LS.

If [formula] then ν(z) = LS(z) = LS. That is, there are exactly LS pairs (a,b)∈A  ×  B such that z = a + b. Moreover, for each sum z = a + b with a∈A and b∈B we have a - b∈S.

For any z∈G we have [formula]. This proves (i).

For the proof of (ii), by definition, if z = a + b with a∈A and b∈B then a - b∈S. Thus, ν(z)  ≤  LS(z)  ≤  LS. Hence, by (i), we must have ν(z) = LS(z) = LS.

Generalizing an earlier notation, we say that z is an [formula]-exception if [formula].

A useful reduction is given by the following lemma.

Let A,B and S be non-empty subsets of a given Abelian group G. Let z be an [formula]-exception.

There exist s∈S and [formula] such that z = 2b + s.

For any s∈S and [formula] with z = 2b + s, letting A'  =  A - b - s, B' = B - b and S' = S - s, we have

[formula],

[formula], and

0 is an [formula]-exception.

If |A| + |B| = |G| + LS then

[formula]

If |A| + |B| = |G| + LS and LS  =  |S| L(G) both hold, then (i), (ii) and (iii) are valid for any s∈S.

Since z is in A + B, it can be written a + b for some a∈A and b∈B. But, being an [formula]-exception, we must have a - b∈S, say a - b = s, for an s∈S. It follows that b∈A - s and z = a + b = 2b + s. This proves (i).

To prove (ii), one first observes that A' = A - a and thus (a) is immediate. Assertion (b) follows from

[formula]

Finally (c) follows from the fact that if 0 (which belongs to A' + B') was not an [formula]-exception, then 0 = a' + b' with a'∈A', b'∈B' and [formula] from which we would derive that z is not an [formula]-exception, a contradiction.

Point (iii) is an immediate consequence of Lemma [\ref=exception] (ii) applied to the sets A',B' and S' and the [formula]-exception z = 0, on recalling that |A'| = |A|, |B'| = |B|, |S'| = |S| and LS' = LS.

For the proof of (iv), let us write k = |S|, [formula] and consider z an [formula]-exception. By Lemma [\ref=exception] (ii) again, we know that there are exactly LS pairs (a,b)∈A  ×  B such that z = a + b and, for each such sum, we have a - b∈S or, equivalently a - b = si for some i in [formula]. But for each 1  ≤  i  ≤  k, there are at most L(G) solutions to the system a + b = z, a - b = si, since it is equivalent to the equation z = 2b  +  si. Since LS  =  |S| L(G), the only possibility is that for all i in [formula], there are exactly L(G) corresponding solutions. In particular, this implies that there is at least one solution (a,b)∈A  ×  B to a + b = z and a - b = si, for each [formula].

Let A,B and S be non-empty subsets of a given Abelian group G. We assume that 0∈S and that both equalities |A| + |B| = |G| + LS and LS  =  |S| L(G) hold, then

[formula]

This follows from (iv) in the preceding lemma: one may therefore apply (i) with any prechosen element s in S. Selecting s = 0, it follows that any [formula]-exception z can be written 2b for some [formula].

The next lemma is a technical result which will be central to give a lower bound for [formula].

We shall use the standard notation

[formula]

for any set S of G. Notice that

[formula]

is a partition of [formula].

Suppose that A,B and S are subsets of a finite Abelian group such that |A| + |B| = |G| + LS, LS = |S| L(G) and [formula]. If [formula] and [formula], then for any x∈G we have

[formula]

We shall denote by LHS(x) and RHS(x), respectively, the left-hand side and the right-hand side of the equality to prove. From [formula] we easily get [formula], for any x∈G. On the other hand, if [formula] denotes the summation over all elements x∈G, with every value x with 2x = 0 attained twice, then

[formula]

Furthermore, by Lemma [\ref=L_S] (vi) we have [formula], implying:

[formula]

From Lemma [\ref=clau] we derive the following corollary.

Suppose that A,B and S are subsets of a finite Abelian group G such that |A| + |B| = |G| + LS, LS = |S| L(G), and [formula]. If [formula] and [formula], then there exist partitions

[formula]

and

[formula]

such that

[formula]

The lower bound

We start this section with a lemma that contains the central part of the main result.

Let A,B and S be subsets, containing 0, of a finite Abelian group G. Assume that |A| + |B| = |G| + LS, that 0 is an [formula]-exception and that LS = |S| L(G). Let z be an [formula]-exception not contained in [formula].

If z' is another [formula]-exception, then we have [formula],

Moreover, if [formula] then [formula].

By Corollary [\ref=coroxxl], we may assume that z = 2b and z' = 2b' for some [formula].

Clearly [formula], otherwise since [formula] and 2b is an [formula]-exception, we would have that either 2b∈S or - 2b∈S that is, [formula], a contradiction. Defining r = 2b - b', this can be reformulated as [formula]. Therefore, since 2b' is an [formula]-exception, by Lemma [\ref=clau], we must have [formula], or equivalently [formula]. This proves (i).

Suppose now that [formula]. By symmetry, applying what we just proved, we also have [formula].

But then, using the fact that 0 is an [formula]-exception, the equalities (giving two representations of 0 as an element of A + B)

[formula]

imply that both 4b - 4b' and 4b' - 4b are in S, that is [formula].

Now, Lemma [\ref=clau] implies that [formula]. Using this and b∈B, we deduce from 2b' = (2b' - b) + b∈A + B and the fact that 2b' is an [formula]-exception, that 2b' - 2b = (2b' - b) - b∈S. By symmetry, 2b - 2b'∈S, therefore [formula], which proves assertion (ii).

Let A,B and S be subsets, containing 0, of a finite Abelian group G. Assume that |A| + |B| = |G| + LS, that 0 is an [formula]-exception and that LS = |S| L(G). Then, for any [formula]-exception z not contained in [formula], we have

[formula]

In the special case S =  - S, we obtain [formula].

Since, by assumption, z is not in [formula], we may then apply the preceding lemma. Consider another [formula]-exception z'. By Lemma [\ref=PofTheorem7] (ii), it is either in [formula], or in [formula].

The next theorem gives us the lower bound for restricted sumsets with respect to a set S, in the case LS = |S| L(G). It is a direct application of Lemma [\ref=PofTheorem7].

Let A,B and S be non-empty subsets of a finite Abelian group G. If |A| + |B| = |G| + LS and LS = |S| L(G), then

[formula]

Since LS  ≥  1, Lemma [\ref=ph] implies that A + B = G. Assume that the set of exceptions [formula] is not empty, otherwise there is nothing to prove. Let z be an [formula]-exception.

Lemma [\ref=xxl] gives the existence of s∈S and [formula] such that z = 2b + s and if we put A' = A - b - s, B' = B - b and S' = S - s, we have that |A'| + |B'| = |G| + LS, [formula], 0 is an [formula]-exception and that LS = LS' = LS'(0).

If there is no [formula]-exception outside [formula], then

[formula]

and thus the result holds.

Suppose now that there is at least one [formula]-exception outside [formula]. By applying Corollary [\ref=CoroPofThm7], we obtain

[formula]

which proves the theorem.

We introduce another lemma.

Let A,B and S be subsets, containing 0, of a finite Abelian group G. Assume that |A| + |B| = |G| + LS and that 0 is an [formula]-exception. Let [formula]. Then

LS  =  |Σ| L(G) = LΣ(0) = LΣ,

[formula], and

the set of [formula]-exceptions can be partitioned as follows:

[formula]

By Lemmas [\ref=L_S] and [\ref=exception], since 0 is an [formula]-exception, we have that

[formula]

By applying Lemma [\ref=L_S] (iii), we check that LΣ(0) = |Σ| L(G) and by definition of LΣ and Lemma [\ref=L_S] (iv), we have LΣ(0)  ≤  LΣ  ≤  |Σ| L(G), therefore

[formula]

and (i) is proved.

In view of (i), Theorem [\ref=lower_2s] applied to the sets A,B and Σ implies that

[formula]

that is (ii).

To prove (iii), first notice that it is immediate that the right-hand side is included in the left-hand side. Let us see now that the other inclusion holds. Assume that z is an [formula]-exception. By Lemma [\ref=xxl] (i), there are s∈S and [formula] such that z = 2b + s. Assume that there exists a different s'∈S such that z = 2b' + s', where [formula]. Thus, we obtain that s = s' + 2(b' - b)∈s' + 2  ·  G. That is, if s∈2  ·  G then s'∈2  ·  G, and viceversa. Hence, s∈Σ if and only if, s'∈Σ. Therefore, if z is an [formula]-exception and there exist a,a'∈A and b,b'∈B such that z = a + b = a' + b' either a - b,a' - b'∈Σ or [formula].

We are now ready for our next theorem which is a generalization of Theorem [\ref=Guo_theo_bound].

Let A,B and S be non-empty subsets of a finite Abelian group G. If |A| + |B| = |G| + LS then [formula]

Notice that, for the sake of clarity, (the first step of the induction in) the forthcoming proof relies on Theorem C, but it would be no problem - to be more precise, the very same proof, but in a drastically simplified way - to keep the paper self-contained and prove Theorem [\ref=general] without invoking it.

We shall prove the result by (finite) induction on the cardinality of S.

If |S| = 1, then LS = L(G) and the result holds by Theorem C.

Assume now that the result is proved for any set of cardinality <  σ for some integer σ  ≤  |G| and let us consider a set S of cardinality σ.

We start by recalling that in the present situation, A + B = G. We may also assume that there is at least one [formula]-exception, say z, otherwise [formula] and there is nothing more to prove.

By Lemma [\ref=xxl] (i), we can assume that z = 2b + s for some s∈S and [formula]. By replacing A, B and S respectively by A' = A - b - s, B' = B - b and S' = S - s we have that [formula], 0 is an [formula]-exception and that LS = LS'(0) = LS'. Moreover we also have A'  +  B' = G.

We denote [formula] and notice that 0∈Σ. We distinguish three cases.

If Σ = S', then by Lemma [\ref=texnik] (i), we can apply Theorem [\ref=lower_2s], which gives the result. From now on, assume Σ  ≠  S'.

If [formula] then, by Lemma [\ref=texnik] (iii), we obtain that

[formula]

Lemmas [\ref=xxl] and [\ref=texnik] (ii) now yield

[formula]

and the result is proved.

Or, there exists an exception [formula]. We first check that

[formula]

Indeed, by Lemma [\ref=texnik] (iii) z' is an [formula]-exception, and by Lemma [\ref=exception] (ii), ν(z') = LS' = LS'(z'). But, since [formula], for any a∈A', b∈B' such that z' = a + b, we have [formula]. Thus [formula] which implies equality [\eqref=lesl].

By [\eqref=lesl], we have [formula]. Since [formula], we have [formula], and we may use the induction hypothesis which implies that

[formula]

Thus, using Lemma [\ref=texnik] (iii) and (ii), we obtain that

[formula]

which finishes the induction step and the proof.

Examples. From the characterization given in [\cite=Guo09], we construct the first example. By a slight modification we can then generate the two other examples, which show that the bound of Theorem [\ref=general] is tight.

Let [formula], we have that G0 = 0. If S = {0} then LS = L(G) = 1. Let us consider H = 〈5〉, [formula] and [formula], where A0 = B0  =  {0,5}. In particular, |A| + |B| = |G| + LS. Then

[formula]

Thus, the set of [formula]-exceptions is {0,10}.

Let [formula], we have that G0  =  {0,15}. If S = {0,15} then LS = L(G). Let us consider H = 〈5〉, [formula] and [formula], where A0 = B0  =  {0,5,15,20}. In particular, |A| + |B| = |G| + LS. Then νA + B(u) > LS for u∉H and

[formula]

Thus, the set of [formula]-exceptions is {0,10,15,25}.

Let [formula], we have that G0 = 0. If S = {0,15,30} then LS = 3|G0| (clearly, since 3|G0|  ≥  LS  ≥  LS(0) = 3). Let us consider H = 〈5〉, [formula] and [formula], where A0 = B0  =  {0,5,15,20,30,35}. In particular, |A| + |B| = |G| + LS. Then νA + B(u) > LS for u∉H and

[formula]

Thus, the set of [formula]-exceptions is {0,10,15,25,30,40}.

The critical sets for Abelian groups. Case LS = |S| L(G).

In what follows, instead of G0 we will write K(G). That is, K(G) = {g∈G: 2g = 0}. We start with a lemma.

Let A,B and S be subsets, containing 0, of a finite Abelian group G. Assume that |A| + |B| = |G| + LS, that 0 is an [formula]-exception and that LS = |S| L(G). Let z and z' be two [formula]-exceptions such that [formula], z'∈SΔ - S and [formula]. Then, [formula].

Slightly more precisely, we shall in fact prove that if ε =  - 1 or 1 and [formula], then [formula].

By Corollary [\ref=coroxxl], we may assume that z = 2b and z' = 2b' for some [formula]. Recall first that, by Lemma [\ref=PofTheorem7], we have

[formula]

For all this proof, we define r = 2b' - b.

We first prove that

[formula]

Indeed, suppose to the contrary that [formula], therefore since 2b is an [formula]-exception, Lemma [\ref=clau] implies that [formula]. But then, the equalities

[formula]

giving two ways to write 0 as an element of A + B, by using [\eqref=belle], imply, since 0 is an [formula]-exception, that 4b - 4b' and 4b' - 4b are in S, that is [formula]. Thus, by Lemma [\ref=clau], we obtain [formula]. This implies in turn, in view of the writing of the [formula]-exception 2b' as an element of A + B in the form (2b' - b) + b, that 2b' - 2b∈S. In a similar fashion, we obtain 2b - 2b'∈S. Therefore, [formula]. Since this is a contradiction with an assumption of our statement, [\eqref=deuxbprime] is proved.

We are now reduced to study two cases.

Case 1: z'∈A.

Writing 2b' = 2b' + 0∈A + B and since 2b' is an [formula]-exception, we obtain that 2b'∈S and thus

[formula]

(recall that in all this proof, we assume that z'∈SΔ - S). This implies that

[formula]

since otherwise it follows from the writing of the [formula]-exception 2b' = 0 + 2b'∈A + B that 2b'∈ - S, a contradiction to [formula].

By Lemma [\ref=clau],

[formula]

Note that, b - r  ≠  b + r since otherwise we would have b - r = b + r∉B and the left-hand side of the preceding formula would be equal to 1. In particular, by Lemma [\ref=clau], we obtain that

[formula]

We now prove that

[formula]

Indeed if, to the contrary, 2b - 2b'∈B then the writing 2b as the sum 2b' + (2b - 2b') in A + B implies, since 2b is an [formula]-exception, that 2r  =  4b' - 2b∈S. In view of [\eqref=ratty], we obtain that 2r = s for some [formula]. By Lemma [\ref=clau], we derive

[formula]

hence, since [formula], we obtain that [formula]. We are now back to the situation of the proof of assertion [\eqref=deuxbprime]. Proceeding in a similar way, we obtain consecutively that [formula], [formula], 2b'∈A + B and finally 2b' - 2b∈S. With 2b - 2b'∈S, which holds by symmetry, the contradiction [formula] follows and [\eqref=zz'] is proved.

Relation [\eqref=zz'] can be rewritten as b - r = 2b - 2b'∉B. Using [formula], we see that the left-hand side of [\eqref=eqeq] must be equal to 2 and we obtain, by Lemma [\ref=clau], that

[formula]

Thus, using this, [\eqref=belle] and the writing (2b - 2b') + (2b' - 2b) = 0 yields, since 0 is an [formula]-exception,

[formula]

Hence, we must have

[formula]

otherwise [formula], that is [formula]. Therefore, using that 0 is an [formula]-exception, Lemma [\ref=clau] implies that [formula], a contradiction with [\eqref=2B2B'].

Note that, in the present case, if 2z - 2z' is an [formula]-exception, then by Corollary [\ref=coroxxl], it is of the form 2b'' for some [formula]. Thus, using Lemma [\ref=clau], it follows that [formula], a contradiction.

Case 2: z'∈B. This case is analogous.

Finally, the study of these two cases implies the result.

The next proposition gives more information on the structure of S and the set of [formula]-exceptions when [formula].

Let A,B and S be non-empty subsets of a finite Abelian group G with |A| + |B| = |G| + LS and LS = |S| L(G). If [formula] then

S - S  ⊂  2  ·  G

Moreover, for any s in S,

we have - (S - s) = S - s and

the set of [formula]-exceptions can be partitioned in the form [formula], for some z1,z2∈G.

Let us choose an arbitrary s in S. Since A + B = G, the cardinality condition implies that there are exactly 2|S| [formula]-exceptions. Let w be one of them. By Lemma [\ref=xxl] (iv), w can be written as 2b + s for some [formula]. Let A' = A - b - s, B' = B - b and S' = S - s. By Lemma [\ref=xxl] (iii), LS = LS'(0) and since we are assuming that LS = |S| L(G), Lemma [\ref=L_S] (vi) implies that S - s = S'  ⊂  2  ·  G. Taking the union over all possible s implies (i).

In order to prove the equality (ii), notice first that the set of [formula]-exceptions cannot be included in [formula] since in this case its cardinality would be at most [formula], a contradiction.

Let z be an [formula]-exception outside [formula]. By Corollary [\ref=CoroPofThm7],

[formula]

But since the right-hand side has a cardinality at most [formula] we obtain, using the assumption on the cardinality of the set of [formula]-exceptions, the equality

[formula]

and that this union is disjoint. It follows that we can partition the set of [formula]-exceptions as

[formula]

If S'Δ - S' is empty then S' =  - S' and the result is proved. Otherwise let z'∈S'Δ - S'. By partition [\eqref=partitionzz], it is not in [formula] and we may apply Lemma [\ref=lemma_lower_2s] which implies that 2z - 2z' is an element of S'Δ - S' not in the set of [formula]-exceptions, contrarily to the partition [\eqref=partitionzz]. This proves (ii).

With (ii), Corollary [\ref=CoroPofThm7] and the assumption [formula] yield

[formula]

Thus

[formula]

on recalling that w = 2b + s.

The next lemma will be useful.

Let G be a finite Abelian group. Let S be a subset of G such that, for each s∈S, S - s =  - (S - s). Then one of the following happens:

S is a coset.

S - S is contained in K(G).

There exists a group H  ≤  G such that [formula] and for any [formula] we have 2(si - sj)∈H.

First, notice that the assumption is equivalent to the fact that for any s∈S, S =  - S + 2s, in other words

[formula]

Assume first that |2  ·  S| = |S|. In this case, [\eqref=Ss] implies for any s∈S, that - s + 2  ·  S  ⊂  S. By the assumption on the cardinalities of these two sets, we then obtain 2  ·  S  =  S + s and finally 2  ·  S = 2S. Choose any s in S and write S' = S - s so that 0 is in S', we get S' =  - S' and 2S'  =  2  ·  S'  =  S'. Therefore, S' is a subgroup of G and S is a coset.

Suppose now that |2  ·  S| < |S|, in particular K(G)  ≠  0. The trivial inequality |S|  ≤  |2  ·  S| + |S| - 1 implies, by Theorem [\ref=kneser], that there exists a group H (namely the stabilizer of S) such that

[formula]

In other words, the sum of two non-negative terms (|2  ·  S + H| - |H|) + (|S + H| - |S|) is equal to 0. Hence, we obtain that |2  ·  S + H| = |H| and |S + H| = |S|, in particular, this means that S is composed of (full) cosets modulo H.

If H = {0}, then for any s∈S, we get 2  ·  (S - s) = {0} and thus S - s  ⊂  K(G) which implies S - S  ⊂  K(G).

Suppose now H  ≠  {0}. Let [formula] be the decomposition of S into H-cosets (H-tiling). We have [formula]. Using now |2  ·  S + H| = |H|, we deduce that

[formula]

that is, 2(si - sj)∈H for any pair [formula].

The next example shows that a set S that verifies the hypothesis of Lemma [\ref=S_general] it is not necessarily a coset.

Example. Let [formula] with generators a,b and relations 4a = 2b = 0. Note that K(G) = {0,2a,b,2a + b}. Let us now consider the set [formula], where H0  =  〈2a〉  =  {0,2a}. Then we may check that, for each s∈S, we have - (S - s) = S - s (or, equivalently, S =  - S + 2  ·  S) while S is not a coset.

We are now ready to study the critical sets S of Theorem [\ref=lower_2s].

Let A,B and S be non-empty subsets of a finite Abelian group G. Assume that |A| + |B| = |G| + LS, where LS = |S| L(G) and that [formula]. Then

there exists a subgroup H of 2  ·  G such that S is a coset modulo H, and

[formula] is a union of two cosets modulo H.

Let z be an [formula]-exception, which exists since [formula]. By Lemma [\ref=xxl], for each s∈S we may find [formula] and define the sets A' = A - b - s, B' = B - b and S' = S - s. In particular, we have that [formula] and [formula].

Assume that we have proved that S - s is a subgroup H of G. Then H  ⊂  S - S  ⊂  2  ·  G by Proposition [\ref=proof_lower_2s] (i). Statement (i) of the Theorem follows. By Proposition [\ref=proof_lower_2s] (iii), we obtain that the set of [formula]-exceptions can be partitioned into two translates of S, that is, two H-cosets and (ii) is proved.

What remains to be proved is that S'  =  S - s is a group. Suppose the contrary. By Proposition [\ref=proof_lower_2s] (ii), we can apply Lemma [\ref=S_general]. Two cases may happen.

Case 1. S - S  ⊂  K(G).

Let s1',s2'∈S'. As shown in the course of the proof of Proposition [\ref=proof_lower_2s], in the present situation: [formula]. By Corollary [\ref=coroxxl], there exists [formula] such that s1' = 2y. Notice that since we have that S'  ⊂  S - S  ⊂  K(G) and K(G) is a group, we have that s'1 + s'2∈K(G).

Since 2y∈S' is an [formula]-exception, and [formula], Lemma [\ref=clau] implies [formula]. Therefore [formula]. Writing s'2 as the sum s'2  =  (y + s1' + s2') + y in A' + B', we deduce from the fact that s2' is an [formula]-exception that s1' + s2' = (y + s1' + s2') - y∈S'. This proves S' + S'  ⊂  S'.

This and the facts that 0∈S' and S' is finite implies that S' is a subgroup of G, a contradiction.

Case 2. We now suppose that there exists a group J such that [formula] and for each pair [formula] we have 2(si - sj)∈J.

Notice that J  ⊂  S - s1  ⊂  S - S  ⊂  2  ·  G which shows J  ⊂  2  ·  G.

Let π:G  →  G / J. We first prove that

[formula]

Indeed, since by Proposition [\ref=proof_lower_2s] (iii) the set of [formula]-exceptions can be partitioned into two translates of S and since S is a union of J-cosets, the equality [formula] implies that

[formula]

Thus, by Lemma [\ref=phS] and Lemma [\ref=L_S] (iv), we obtain that:

[formula]

Let us see now that |K(G / J)| = L(G). Since J is a subgroup of 2  ·  G, the set Y = {y∈G: 2y∈J} itself is a group. Moreover, we have that Y + K(G) = Y and Y + J = Y and we obtain that |K(G / J)| = |Y / J| = L(G). Hence, we should have |π(A')| + |π(B')| = |G / J| + |π(S')||K(G / J)|, otherwise, using [\eqref=hdr], we derive the inequalities

[formula]

which gives us a contradiction with |A| + |B| = |G| + |S| L(G). Clearly, the inclusion π(S')  ⊂  K(G / J) holds. This proves [\eqref=quocient].

Notice that, from [\eqref=quocient] we also conclude that π(S') - π(S')  ⊂  K(G / J). Therefore, by the same reasoning as in Case 1, applied to π(A'),π(B') and π(S'), we obtain that π(S') is a subgroup in G / J. Which implies, since S' is union of cosets modulo J, that S' is a subgroup of G, a contradiction.

Let A,B and S be non-empty subsets of a finite Abelian group G with |A| + |B| = |G| + LS and LS = |S| L(G). Let 2bs + s be an [formula]-exception, with s∈S, [formula]. Then, the following assertions are equivalent

[formula].

the set Σ  =  S - s is a subgroup of 2  ·  G,

if π:G  →  G / Σ denotes the natural projection, A' = π(A - bs - s), B' = π(B - bs),

[formula]

Suppose first that the equality [formula] holds. By Theorem [\ref=exceptions], Σ is a subgroup of 2  ·  G and the set of [formula]-exceptions is a union of two cosets modulo Σ. Hence, since [formula], we have that [formula]. This implies, by Lemma [\ref=phS], in case S = {0}, that |A'| + |B'|  ≤  |G / Σ| + L(G / Σ).

Let us see now that L(G / Σ) = L(G). Since Σ is a subgroup of 2  ·  G, the set Y = {y∈G: 2y∈Σ} itself is a group. Moreover, we have that Y + K(G) = Y and Y + Σ = Y. Thus we obtain that L(G / Σ) = |Y / Σ| = L(G). Hence, we should have |A'| + |B'| = |G / Σ| + L(G / Σ), otherwise

[formula]

a contradiction with |A| + |B| = |G| + |S| L(G). Note that, we also conclude that A and B are unions of cosets modulo Σ.

For the converse statement, assume that Σ is a subgroup of 2  ·  G and that the equalities |A'| + |B'| = |G / Σ| + L(G / Σ) and [formula] hold. The condition |A| + |B| = |G| + LS, with LS = |S| L(G) implies that A and B are unions of cosets modulo Σ, since, as it is easy to check, L(G / Σ) = L(G). Hence, the set of [formula]-exceptions is a union of two cosets modulo Σ. Therefore, we have [formula].

From the previous result together with Theorem [\ref=Guo_theo_charac] (in case a = 0) we obtain the characterization of the critical sets A,B and S of Theorem [\ref=lower_2s].

Let A,B and S be non-empty subsets of a finite Abelian group G with |A| + |B| = |G| + LS and LS = |S| L(G). Let 2bs + s be an [formula]-exception with s∈S and [formula]. Then, the equality [formula] holds, if and only if the following conditions hold true:

Σ  =  S - s is a subgroup.

Let π:G  →  G / Σ be the natural projection and let A' = π(A - bs - s) and B' = π(B - bs).

There exists [formula] such that H = 〈2b〉 is a subgroup in G / Σ of odd order d greater than 1.

There exists [formula], where m = (|G / Σ| / d - L(G / Σ)) / 2 and 0  ≤  k,l  ≤  m, such that

[formula]

And A = bs + s + π- 1(A') and B = bs  +  π- 1(B').

Note that, under the assumptions of the previous theorem, we can determine the set of [formula]-exceptions. Let Y = {y∈G: 2y∈Σ} then π- 1(K(G / Σ)) = Y and the set [formula], where b*∈G and π(b*) = b.

The critical sets for Abelian groups. Case LS < |S| L(G).

As an immediate consequence of Theorem [\ref=general], we obtain the following result.

Let A,B and S be non-empty subsets of a finite Abelian group G with |A| + |B| = |G| + LS. If the equality [formula] holds then there exists a decomposition [formula] of S modulo 2  ·  G such that

|Si| = LS / L(G) for each [formula],

[formula] and [formula] for each [formula]. Moreover, the set of [formula]-exceptions can be partitioned in the form:

[formula]

Let LS = mL(G), for some m  ≤  |S|. We will prove the result by induction on |S|. We have A + B = G. Let z be an [formula]-exception. We write z = 2b + s for some s∈S and [formula] and define A' = A - b - s, B' = B - b and S' = S - s. Again, [formula], [formula] (in particular, 0 is an [formula]-exception), LS = LS'(0) = LS' and A'  +  B' = G.

We denote [formula]. Notice that 0∈Σ, and also by Lemma [\ref=texnik] (i) that m = |Σ|. If |S'| = m then the result holds with k = 1. Suppose now that |S'| > m.

By Lemma [\ref=texnik] (iii), we obtain that the set of [formula]-exceptions can be partitioned as follows

[formula]

Now, using Lemma [\ref=texnik] (ii), we have that [formula]. In particular, since |S'| > |Σ|, there exists and exception [formula]. Thus, [\eqref=lesl] is still valid and we have [formula], hence [formula]. By Theorem [\ref=general], we obtain that [formula]. Therefore, using [formula] and the partition ([\ref=final]), we conclude that [formula] and [formula].

The inductive process applied to [formula] completes the result.

We now introduce some results that allow us to be more precise about the structure of the sets S and [formula] in the case LS < |S| L(G), provided some restriction holds.

Let A and B be subsets of a finite Abelian group G. Suppose that there exists an element [formula] such that:

The order d of the subgroup H = 〈2b〉 is an odd integer greater than 2L(G) - 1.

There exists a subset [formula], where m = (|G| / d - |K(G)|) / 2 and 0  ≤  k,l  ≤  m, such that

[formula]

Then, for each [formula] we have ν(z) > L(G). In particular, if ν(z) = L(G) then [formula]

Let P,Q and R be the subsets defined as follows:

[formula]

Then [formula], [formula] and [formula]. Notice that, since |H| = d is odd, we can prove that |H + K(G)| = dL(G) and thus |A| + |B| = |G| + L(G) (see [\cite=Guo09]). In particular, A + B = G. Let us see now how ν(z) is lower bounded according to which part of the sum it belongs to.

For the sum P + P, clearly, P + P  ⊂  K(G) + H and since d is odd, we have that db + K(G) = K(G). Thus, by a direct computation, it follows that ν(z) > L(G) unless [formula].

Concerning the sum P + R, we have that [formula]. Since [formula], it is clear that P + R is a union of (H + K(G))-cosets. Moreover, for each z∈P + R we have ν(z)  ≥  (d + 1) / 2. Hence, since we are assuming that (d + 1) / 2 > L(G), we conclude that ν(z) > L(G), for each z∈P + R.

The case of the sum P + Q is similar to the previous one. (Here we have that [formula]).

Finally, it follows that Q + R is a union of H cosets, none of which is H, hence 0,2b∉Q + R. Moreover, for each z∈Q + R, ν(z)  ≥  |H| > L(G).

With the notation and assumptions of the preceding proposition, we can state the following two corollaries:

Let z∈G. If ν(z) = L(G) then [formula]

Let A,B be non-empty subsets of a finite Abelian group G and T be a subgroup of 2  ·  G such that |A| + |B| = |G| + |T| L(G). Let π:G  →  G / T be the natural projection. Denote A' = π(A) and B' = π(B). Suppose that

there exists [formula] such that H = 〈2b〉 is a subgroup in G / T of odd order d greater than 2L(G / T) - 1,

there exists [formula], where m = (|G / T| / d - L(G / T)) / 2 and 0  ≤  k,l  ≤  m, such that

[formula]

Then, for each [formula] we have ν(z) > L(G) |T|. In particular, if ν(z) = L(G) |T| then [formula]

The next theorem gives a characterization of the critical sets of Theorem [\ref=general], provided a restriction holds.

Let A,B and S be non-empty subsets of a finite Abelian group G with |A| + |B| = |G| + LS. Assume that 0 is an [formula]-exception with [formula] and that [formula]. The following conditions hold true:

There exists a decomposition [formula] of S modulo 2  ·  G such that |Si| = LS / L(G) for each [formula] and [formula] for each [formula]. Moreover, the set of [formula]-exceptions can be partitioned in the form [formula]

Without loss of generality, we can assume that 0∈S1.

S1 is a group.

Let π:G  →  G / S1 be the natural projection and let A' = π(A) and B' = π(B).

There exists [formula] such that H = 〈2b〉 is a subgroup of G / S1 of odd order d greater than 1.

There exists [formula], where m = (|G / S1| / d - L(G / S1)) / 2 and 0  ≤  k,l  ≤  m, such that

[formula]

Moreover, if we suppose that (d + 1) / 2 > L(G / S1) then

Si = yi + S1, for each [formula], where Y = {y∈G:2y∈S1} and [formula], r  ≥  k, is a decomposition modulo S1. In particular, 2  ·  S  ⊂  S1,

The set of [formula]-exceptions is {0,2b*} + S, where b*∈π- 1(b), and

[formula], where [formula] and [formula].

(i) holds by Theorem [\ref=tretze]. Theorem [\ref=characterization_even] implies (ii), (iii) and (iv). Finally, by Proposition [\ref=catorze], Corollary [\ref=quinze] and Corollary [\ref=setze] we obtain (v), (vi) and (vii).

Acknowledgements

Research done when the second author was visiting Université Pierre et Marie Curie, E. Combinatoire, Paris, supported by the Ministry of Education, Spain, under the National Mobility Programme of Human Resources, Spanish National Programme I-D-I 2008-2011.