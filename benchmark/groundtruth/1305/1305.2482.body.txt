Corollary Proposition Proposition-Definition Lemma

Definition Question Example Remark

On the genus of birational maps between 3-folds

In this note we present two equivalent definitions for the genus of a birational map [formula] between smooth complex projective 3-folds. The first one is the definition introduced by M. A. Frumkin in [\cite=F], the second one was recently suggested to me by S. Cantat. By focusing first on proving that these two definitions are equivalent, one can obtain all the results in [\cite=F] in a much shorter way. In particular, the genus of an automorphism of [formula], view as a birational self-map of [formula], will easily be proved to be 0.

Preliminaries

By a n-fold we always mean a smooth projective variety of dimension n over [formula].

Let [formula] be a birational map between n-folds. We assume that a projective embedding of Y is fixed once and for all, hence φ corresponds to the linear system on X given by preimages by φ of hyperplane sections on Y.

We call base locus of φ the base locus of the linear system associated with φ: this is a subvariety of codimension at least 2 of X, which corresponds to the indeterminacy set of the map.

Another subvariety of X associated with φ is the exceptional set, which is defined as the complement of the maximal open subset where φ is a local isomorphism. If [formula] the exceptional set (given by the single equation Jacobian = 0) has pure codimension 1, but this not the case in general: consider for instance the case of a flop, or more generally of any isomorphism in codimension 1, where the exceptional set coincides with the base locus.

A regular resolution of φ is a morphism σ:Z  →  X which is a sequence of blow-ups [formula] along smooth irreducible centers, such that Z  →  Y is a birational morphism, and such that each center Bi of the blow-up σi:Zi  →  Zi - 1 is contained in the base locus of the induced map [formula]. Recall that as a standard consequence of resolution of singularities, a regular resolution always exists.

[formula]

We shall use the following basic observations about the exceptional set and the base locus of a birational map.

Let τ:X  →  Y be a birational morphism between 3-folds. Then through a general point of any component of the exceptional set of τ, there exists a rational curve contracted by τ.

Let [formula] be a birational map between 3-folds, and let E  ⊂  X be an irreducible divisor contracted by φ. Then E is birational to [formula] for a smooth curve C.

For the first assertion (which is in fact true in any dimension), see for instance [\cite=Deb]. When φ is a morphism, the second assertion is in fact what is first proved in [\cite=Deb]. Finally, when φ is not a morphism, we reduce to the previous case by considering a resolution of φ.

Let [formula] be a birational map between n-folds, and consider

[formula]

a regular resolution of φ. Then a point p∈X is in the base locus of φ if and only if the set τ(σ- 1(p)) has dimension at least 1.

If p is not in the base locus of φ then by regularity of the resolution σ- 1(p) is a single point, and thus τ(σ- 1(p)) as well.

Now suppose that p is in the base locus of φ, and consider HY a general hyperplane section of Y. Denote by HX, HZ the strict transform of HY on X and Z respectively. By definition of the base locus, we have p∈HX, hence

[formula]

This implies that τ(σ- 1(p)) has positive dimension.

We will consider blow-ups of smooth irreducible centers in 3-folds. If B is such a center, B is either a point or a smooth curve. We define the genus g(B) to be 0 if B is a point, and the usual genus if B is a curve. Similarly, if E is an irreducible divisor contracted by a birational map between 3-folds, then by Lemma [\ref=lem:E] E is birational to a product [formula] where C is a smooth curve, and we define the genus g(E) of the contracted divisor to be the genus of C.

The two definitions

Consider now a birational map [formula] between 3-folds, and let σ:Z  →  Y be a regular resolution of φ- 1.

Frumkin [\cite=F] defines the genus g(φ) of φ to be the maximum of the genus among the centers of the blow-ups in the resolution σ. Remark that this definition depends a priori from a choice of regular resolution, and Frumkin spends a few pages in order to show that in fact it does not.

During the social dinner of the conference Groups of Automorphisms in Birational and Affine Geometry, S. Cantat suggested to me another definition, which is certainly easier to handle in practice: define the genus of φ to be the maximum of the genus among the irreducible divisors in X contracted by φ.

Denote by [formula] the exceptional divisors of the sequence of blow-ups [formula], or more precisely their strict transforms on Z. On the other hand, denote by [formula] the strict transforms on Z of the irreducible divisors contracted by φ.

Note that if φ- 1 is a morphism, then both collections {Fi} and {Ei} are empty. In this case, by convention we say that the genus of φ is 0. In this section we prove:

Denote by Bi the center of the blow-up σi producing Fi. We define a partial order on the divisors Fi by saying that [formula] if one of the following conditions is verified:

j  =  k;

j  >  k, Bk is a point, and Bj is contained in the strict transform of Fk;

j  >  k, Bk is a curve, and Bj intersects the general fiber of the strict transform of the ruled surface Fk.

We say that Fi is essential if Fi is a maximal element for the order [formula].

The maximum max ig(Fi) is realized by an essential divisor.

We can assume that the maximum is not 0, otherwise there is nothing to prove. Consider Fk realizing the maximum, and [formula] with j  >  k. Then the centers Bj,Bk of σj and σk are curves, and Bj dominates Bk by a morphism. By the Riemann-Hurwitz formula, we get g(Fj)  ≥  g(Fk), and the claim follows.

The subset of the essential divisors Fi with g(Fi)  ≥  1 is contained in the set of the contracted divisors Ej.

Let Bi  ⊂  Zi - 1 be the center of a blow-up producing a non-rational essential divisor Fi, and consider the diagram:

[formula]

By applying Lemma [\ref=lem:basic] to [formula], we get dim τ(σ̃- 1(p))  ≥  1 for any point p∈Bi. Since Fi is essential, lp: = σ̃- 1(p) is a smooth rational curve contained in Fi for all except finitely many p∈Bi. So τ(lp) is also a curve. If τ(lp) varies with p, then τ(Fi) is a divisor, which is one of the Ei. Now suppose τ(lp) is a curve independent of p, that means that Fi is contracted to this curve by τ. Consider q a general point of Fi. By Lemma [\ref=lem:E] there is a rational curve C  ⊂  Fi passing through q and contracted by τ, but this curve should dominate the curve Bi of genus ≥  1: contradiction.

Observe that the strict transform of a divisor contracted by φ must be contracted by σ, hence we have the inclusion {Ei}  ⊂  {Fi}. This implies max ig(Ei)  ≤   max ig(Fi). If all Fi are rational, then the equality is obvious.

Suppose at least one of the Fi is non-rational. By Lemma [\ref=lem:essinEi] we have the inclusions

[formula]

Taking maximums, this yields the inequalities

[formula]

By Lemma [\ref=lem:ess] we conclude that these three maximums are equal.

Some consequences

The initial motivation for a reworking of the paper of Frumkin was to get a simple proof of the fact that a birational self-map of [formula] coming from an automorphisms of [formula] admits a resolution by blowing-up points and rational curves:

The genus of φ is zero in the following two situations:

[formula] is the completion of an automorphism of [formula];

[formula] is a pseudo-isomorphism (i.e. an isomorphism in codimension 1).

In particular for such a map φ any regular resolution only involves blow-ups of points and of smooth rational curves.

Both results are obvious using the definition via contracted divisors!

I mention the following result for the sake of completeness, even if I essentially follow the proof of Frumkin (with some slight simplifications).

We write [formula], where σi:Zi  →  Zi - 1 is the blow-up of a smooth center Bi. Note that Z0  =  X, and Zr  =  Z. Assume that the induced map [formula] has genus 0 (this is clearly the case for h0  =  τ'- 1), and let us prove the same for [formula]. We can assume that σi + 1 is the blow-up of a non-rational smooth curve Bi + 1, otherwise there is nothing to prove. Consider

[formula]

a regular resolution of h- 1i. Since Wi dominates Y via the morphism [formula], the curve Bi + 1 is in the base locus of p- 1i: otherwise Bi + 1 would not be in the base locus of [formula], contradicting the regularity of the resolution σ. Thus for any point x∈Bi + 1, p- 1i(x) is a curve, and there exists an open set U  ⊂  Zi such that [formula] is a non-empty divisor. By applying over U the universal property of blow-up (see [\cite=Har]), we get that there exists an irreducible divisor on Wi whose strict transform on Zi + 1 is the exceptional divisor Ei + 1 of σi + 1. Hence the birational map [formula] does not contract any divisor and so has genus 0. Composing by qi which also has genus 0 by hypothesis we obtain g(hi + 1)  =  0. By induction we obtain g(hr)  =  0, hence the result since hr  =  h.

In the setting of Proposition [\ref=2.2], even if σ' is also a regular resolution, there is no reason for [formula] to be a pseudo-isomorphism. For instance, if φ admits a curve C in its base locus, one could construct regular resolutions of φ starting blowing-up arbitrary many points on C, and so the Picard number of Z can be arbitrary large (thanks to the referee who pointed this fact out).

On the other hand, it is not clear if we could restrict the definition of a regular resolution (for instance allowing the blow-up of a point only if it is a singular point of the base locus), such that the regular resolutions σ and σ' would lead to 3-folds Z and Z' with the same Picard numbers, and with h a pseudo-isomorphism. In such a case, Proposition [\ref=2.2] would follow from Corollary [\ref=cor:C3&psauto].

The next result is less elementary.

For the proof, which relies on the use of intermediate Jacobians, I refer to the original paper of Frumkin [\cite=F], or to [\cite=LS] where it is proved that the exceptional loci of φ and φ- 1 are birational (and even more piecewise isomorphic). Note that Frumkin does not mention any restriction on the Hodge numbers of X, but it seems implicit since the proof uses the fact, through the reference to [\cite=CG], that the complex torus J(X) is a principally polarized abelian variety.

Let g  ≥  0 be an integer. The set of birational self-maps of [formula] of genus at most g is a subgroup of [formula].

Stability under taking inverse is Proposition [\ref=pro:inverse], and stability under composition comes from the fact that any divisor contracted by [formula] is contracted either by φ or by φ'.