On the cardinality of general h-fold sumsets

Introduction

Let [formula] denote the set of all nonnegative integers. For any finite set of integers A and any positive integer h  ≥  2, define

[formula]

and

[formula]

Sumsets are important in additive number theory (see [\cite=Kapoor] [\cite=lev1] [\cite=lev2] [\cite=Nathanson72] [\cite=Nathanson89] [\cite=Pan] [\cite=chen] [\cite=yang]).

Finding lower bounds for |hA| and [formula] in terms of h and |A| and determining the structure of sets A for which |hA| or [formula] are minimal are important problems in additive number theory.

Nathanson [\cite=Nathanson96] proved the following fundamental and important results.

Theorem A. (See [\cite=Nathanson96])   Let h  ≥  2 be an integer and A a finite set of integers with |A| = k. Then

[formula]

Theorem B. (See [\cite=Nathanson96])   Let h  ≥  2 be an integer and A a finite set of integers with |A| = k. Then

[formula]

if and only if A is a k-term arithmetic progression.

Theorem C. (See [\cite=Nathanson96] or [\cite=Nathanson95])   Let A be a finite set of integers with |A| = k and let 1  ≤  h  ≤  k. Then

[formula]

This lower bound is best possible.

Theorem D. (See [\cite=Nathanson96] or [\cite=Nathanson95])   Let k  ≥  5 and let 2  ≤  h  ≤  k - 2. If A is a set of k integers such that

[formula]

then A is a k-term arithmetic progression.

From now on, we assume that [formula] is a set of integers with [formula]. For two positive integers h and r, define

[formula]

Clearly, [formula] and h(h)A = hA. Recently, Mistri and Pandey generalized the above results.

Theorem E. (See [\cite=Pandey])   Let A be a set of k integers, r and h be two integers such that 1  ≤  r  ≤  h  ≤  rk. Then

[formula]

where m is the integer with h / r - 1 < m  ≤  h / r. This lower bound is best possible.

Theorem F. (See [\cite=Pandey])   Let k  ≥  3, r and h be integers with 1  ≤  r  ≤  h  ≤  rk - 2 and [formula]. If A is a set of k integers such that

[formula]

where m is the integer with h / r - 1 < m  ≤  h / r, then A is a k-term arithmetic progression.

For any ordered k-tuple of positive integers [formula] and any positive integer h, define

[formula]

Clearly, if [formula] is an ordered k-tuple of positive integers, then [formula].

Mistri and Pandey [\cite=Pandey] said that it is interesting to study the direct and inverse problems related to sumset [formula].

In this paper, we solve this problem.

For convenience, let [formula] if a > b. Let [formula] be the largest integer and [formula] be the least integer such that

[formula]

and let

[formula]

Let

[formula]

In this paper, we prove the following theorems.

Let [formula] be a set of integers with [formula], [formula] be an ordered k-tuple of positive integers and h be an integer with

[formula]

Then

[formula]

This lower bound is best possible.

Let k  ≥  5 be an integer, [formula] be an ordered k-tuple of positive integers and let h be an integer with

[formula]

If A is a set of k integers, then

[formula]

if and only if A is a k-term arithmetic progression.

For Theorem [\ref=thm2] with 1  ≤  k  ≤  4, we shall give complete results in Section [\ref=secx]. Since

[formula]

Theorem F is a corollary of Theorem [\ref=thm2] and Theorems [\ref=thm3] and [\ref=thm4] in Section [\ref=secx].

If h = 1, then [formula]. So [formula].

If

[formula]

then

[formula]

So [formula].

If

[formula]

then

[formula]

So [formula].

Proofs

For any k-tuple [formula], define the function

[formula]

For any ordered k-tuple of positive integers [formula] and any positive integer h, let [formula] be the set of all ordered k-tuple [formula] of [formula] such that

[formula]

Then

[formula]

For any positive integer k and any k-tuple [formula], define the weighted sum

[formula]

For two k-tuples [formula], we call U  →  W a step if there exists an index j  ≥  0 such that wj = uj - 1, wj + 1 = uj + 1 + 1 and wi = ui for all integers [formula]. We call [formula] a [formula]-path of length t, if [formula] and Xi + 1  →  Xi(1  ≤  i  ≤  t - 1) are steps. It is clear that if [formula] is a [formula]-path of length t, then

[formula]

Thus S(Xt) - S(X1) = t - 1.

Let

[formula]

and

[formula]

where [formula] are defined as in Section [\ref=b]. Then [formula].

We have [formula]. In particular, any [formula]-path from V to V' has length [formula].

Noting that

[formula]

we have

[formula]

Since a [formula]-path from V to V' has length S(V') - S(V) + 1, it follows that any [formula]-path from V to V' has length [formula].

Let [formula] and [formula] with [formula]. If

[formula]

then there exists a [formula]-path from X to Y.

Let [formula] be a [formula]-path of the maximal length such that

[formula]

where [formula]. Now we prove that Xg = Y. Suppose that [formula]. Let s be the maximal index with [formula]. Noting that [formula], we have

[formula]

Hence s  ≥  1. Since

[formula]

it follows from the definition of s that xg,s < ys. If xg,s - 1 > 0, let

[formula]

then Xg  →  Xg + 1 is a [formula]-path and Xg + 1 also satisfies [\eqref=condition]. This is a contradiction with the maximality of g. Hence xg,s - 1 = 0. If xg,j = 0 for all 0  ≤  j  ≤  s - 1, then

[formula]

a contradiction with [formula] (see the definition of [formula]-path). Thus there exists an index j with 0  ≤  j < s - 1 such that xg,j > 0. We assume that j is the largest such index. Let

[formula]

Then Xg  →  Xg + 1 is a [formula]-path. Since Xg satisfies [\eqref=condition], it follows that Xg + 1 also satisfies [\eqref=condition]. This is a contradiction with the maximality of g. Therefore, Xg = Y.

Let [formula] and [formula] be two different [formula]-paths from X1 to Xt. If A is a set of k integers such that [formula], then φA(Xi) = φA(Xi') for [formula].

By Lemma [\ref=lem1], there exists a [formula]-path from V to X1 and another [formula]-path from Xt to V'. Thus we have the following [formula]-path from V to V':

[formula]

By Lemma [\ref=lem0], the length of the [formula]-path [\eqref=path] is [formula]. Clearly,

[formula]

Since

[formula]

and

[formula]

it follows that

[formula]

Noting that

[formula]

and

[formula]

we have φA(Xi) = φA(Xi') for [formula].

Let ci and di(0  ≤  i  ≤  k - 1) be integers with ci  ≤  di(0  ≤  i  ≤  k - 1). If h is an integer with

[formula]

then there exist integers xi(0  ≤  i  ≤  k - 1) with ci  ≤  xi  ≤  di(0  ≤  i  ≤  k - 1) such that

[formula]

Proof is left to the reader.

By Lemma [\ref=lem1], there exists a [formula]-path [formula]. By Lemma [\ref=lem0], we have [formula]. Since [formula] and [formula], we have

[formula]

Next we show that this lower bound is optimal. Let [formula]. Then the smallest integer in [formula] is

[formula]

and the largest integer in [formula] is

[formula]

It follows that

[formula]

Thus, by Lemma [\ref=lem0], we have

[formula]

By [\eqref=w] and [\eqref=s], we have

[formula]

Suppose that [formula]. For any integer j with 0  ≤  j  ≤  k - 4, by

[formula]

and Lemma [\ref=lem3], there exists

[formula]

such that

[formula]

Then

[formula]

and

[formula]

are two different [formula]-paths. By Lemma [\ref=lem2], we have

[formula]

This implies that aj + 1 - aj = aj + 3 - aj + 2. Therefore,

[formula]

In order to prove that A is a k-term arithmetic progression, it suffices to prove a4 - a3 = a1 - a0.

By

[formula]

and Lemma [\ref=lem3], there exists

[formula]

such that

[formula]

Then

[formula]

and

[formula]

are two different [formula]-paths. By Lemma [\ref=lem2], we have

[formula]

This implies that a1 - a0 = a4 - a3.

Therefore, A is a k-term arithmetic progression.

Conversely, if A is a k-term arithmetic progression, without loss of generality, we may assume that [formula]. By the proof of Theorem [\ref=thm1], we have [formula].

Cases 1  ≤  k  ≤  4

For k = 1 and 1  ≤  h  ≤  r0, it is easy to see that [formula]. So [formula].

For k = 2 and 1  ≤  h  ≤  r0 + r1, we have

[formula]

So

[formula]

Now we deal with the cases k = 3 and k = 4.

Let A = {a0 < a1 < a2} be a set of integers and [formula] be an ordered 3-tuple of positive integers. Suppose that h is an integer with 2  ≤  h  ≤  r0 + r1 + r2 - 2. Then

(i) for r1 = 1, we have [formula];

(ii) for r1  ≥  2, we have [formula] if and only if A is a 3-term arithmetic progression.

We first prove (i). Suppose that r1 = 1. By Lemma [\ref=lem1], there exists a [formula]-path from V to V':

[formula]

Let X = (x0,x1,x2)  →  Y be a [formula]-path. If x1 = 0, then Y = (x0 - 1,1,x2). If x1 = 1, then Y = (x0,0,x2 + 1). That is, Y is uniquely determined by X. Hence, the [formula]-path [\eqref=xyz] is uniquely determined by V and V'. For any [formula], by Lemma [\ref=lem1], there exists a [formula]-path from V to W and a [formula]-path W to V'. Since [\eqref=xyz] is unique, we have [formula]. Thus, by the definition of [formula], φA(Vi)  <  φA(Vi + 1)(0  ≤  i  ≤  t - 1) and Lemma [\ref=lem0], we have

[formula]

Next we shall prove (ii). If A is a 3-term arithmetic progression, without loss of generality, we may assume that A = {0,1,2}. By the proof of Theorem [\ref=thm1], we have [formula].

Conversely, suppose that r1  ≥  2 and [formula].

Since 2  ≤  h  ≤  r0 + r1 + r2 - 2, there exists [formula] such that

[formula]

Then

[formula]

and

[formula]

are two different [formula]-paths. By Lemma [\ref=lem2], we have

[formula]

This implies that a1 - a0 = a2 - a1. Therefore, A is a 3-term arithmetic progression.

Let A = {a0 < a1 < a2 < a3} be a set of integers and [formula] be an ordered 4-tuple of positive integers. Suppose that h is an integer with 2  ≤  h  ≤  r0 + r1 + r2 + r3 - 2. Then

(i) for r1 = r2 = 1, we have [formula] if and only if a1 - a0 = a3 - a2;

(ii) for r1  ≥  2 or r2  ≥  2, we have [formula] if and only if A is a 4-term arithmetic progression.

Suppose that [formula].

Since 2  ≤  h  ≤  r0 + r1 + r2 + r3 - 2, there exists [formula] such that

[formula]

Then

[formula]

and

[formula]

are two different [formula]-paths. By Lemma [\ref=lem2], we have

[formula]

This implies that

[formula]

We first prove (i).

It is enough to prove that if r1 = r2 = 1 and a1 - a0 = a3 - a2, then [formula].

By Lemma [\ref=lem1], there exists a [formula]-path from V to V'

[formula]

Suppose that

[formula]

is also a [formula]-path from V to V'. By Lemma [\ref=lem0], we have s = t. Now we prove that φA(Vi) = φA(Wi)(0  ≤  i  ≤  s). In order to prove this, we prove the following stronger result: for 0  ≤  i < s, if Vi = Wi, then either Vi + 1 = Wi + 1 or Vi + 2  =  Wi + 2 and φA(Vi + 1) = φA(Wi + 1).

Suppose that 0  ≤  i < s and Vi = Wi  =  (vi,0,vi,1,vi,2,vi,3).

Case 1: vi,1 = vi,2 = 0. Then, by the definition of step, we have

[formula]

Case 2: vi,1 = vi,2 = 1. Then, by the definition of step and r1 = r2 = 1, we have

[formula]

Case 3: vi,1 = 1,vi,2 = 0. Then, by the definition of step and r1 = r2 = 1, we have

[formula]

Case 4: vi,1 = 0,vi,2 = 1. Then, by the definition of step and r1 = r2 = 1, we have

[formula]

Since

[formula]

we have φA(Vi + 1) = φA(Wi + 1). By [\eqref=u], the definition of adjacency and r1 = r2 = 1, we have

[formula]

Thus, we have proved that for 0  ≤  i < s, if Vi = Wi, then either Vi + 1 = Wi + 1 or Vi + 2  =  Wi + 2 and φA(Vi + 1) = φA(Wi + 1). It follows from V0 = W0 and Vs = Ws that φA(Vi) = φA(Wi)(0  ≤  i  ≤  s).

For any [formula], by Lemma [\ref=lem1], there exists a [formula]-path from V to W and a [formula]-path W to V'. By the above arguments, we have

[formula]

Hence

[formula]

Therefore, by Lemma [\ref=lem0],

[formula]

Now we prove (ii).

If A is a 4-term arithmetic progression, without loss of generality, we may assume that A = {0,1,2,3}. By the proof of Theorem [\ref=thm1], we have [formula].

Conversely, we suppose that [formula] and r1  ≥  2 or r2  ≥  2. By [\eqref=v], it is enough to prove that a2 - a1 = a1 - a0 or a2 - a1 = a3 - a2.

Case 1: r1  ≥  2. Since 2  ≤  h  ≤  r0 + r1 + r2 + r3 - 2, there exists [formula] such that

[formula]

Then

[formula]

and

[formula]

are two different [formula]-paths. By Lemma [\ref=lem2], we have

[formula]

This implies that a1 - a0 = a2 - a1.

Case 2: r2  ≥  2. Since 2  ≤  h  ≤  r0 + r1 + r2 + r3 - 2, there exists [formula] such that

[formula]

Then

[formula]

and

[formula]

are two different [formula]-paths. By Lemma [\ref=lem2], we have

[formula]

This implies that a2 - a1 = a3 - a2.

Therefore, A is a 4-term arithmetic progression.