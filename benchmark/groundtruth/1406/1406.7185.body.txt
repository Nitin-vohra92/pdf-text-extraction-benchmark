Efficacy of high frequency switched-mode stimulation in activating Purkinje cells

Introduction

Traditional functional electrical stimulation typically uses a current source with constant amplitude Istim and pulsewidth tpulse to recruit neurons in the target area. Early stimulator designs consisted of relatively simple programmable current source implementations. Over the years numerous modifications have been proposed to improve important aspects such as power efficiency, safety and size. Most stimulators however, still use constant current at the output.

Several implementations have investigated the use of alternative stimulation waveforms in an attempt to improve the performance. Some implementations focus on improving the efficiency of the activation mechanism in the neural tissue [\cite=sahin], [\cite=wongsarn]. Others focus on increasing the performance of the stimulator itself, of which several studies have proposed the use of high frequency stimulation waveforms. In [\cite=Liu] a pulsed waveform is used to decrease the size of the coupling capacitors. Two of these waveforms are subsequently added in antiphase to reconstruct a conventional stimulation waveform. In [\cite=arfin] a forward-buck and reverse-boost converter is used to increase the power efficiency of the stimulator by using inductive energy recycling. External capacitors are used to low-pass filter the switched signal and reconstruct a conventional waveform.

In [\cite=dongen] and [\cite=dongen2] it was hypothesized that it is possible to apply a high-frequency signal to the electrodes directly: it will be filtered by the tissue- and membrane properties. This gives rise to a new class of stimulator circuits that can benefit from the power and size advantages mentioned above, while the reconstruction step can be eliminated. In this paper the electrophysiological feasibility of such circuits is investigated both theoretically as well as experimentally by determining whether a high frequency stimulation signal can indeed induce neural recruitment in a similar fashion as during classical constant current stimulation.

The high frequency stimulation pattern that is used to stimulate the tissue is assumed to be square shaped. The schematic circuit diagrams of both voltage and current based stimulation are depicted in Figure [\ref=fig:switched]a. A fixed value for Vstim or Istim is used, while the stimulation intensity is controlled by driving the switch with a Pulse Width Modulated (PWM) signal; this is referred to as switched-mode operation. In Figure [\ref=fig:switched]b a sketch is given of the monophasic stimulation pulse resulting from either of the circuits. The switch is operated with duty cycle δ and switching period ts. This results in an average stimulation intensity Vavg  =  δVdd or Iavg  =  δIdd for voltage and current based stimulation respectively.

It is important to note that in this work the term 'high frequency' refers to the frequency of the pulses that make up a single stimulation waveform. It does not refer to the repetition rate at which the stimulation cycles are repeated. Furthermore, this work investigates the electro-physiological feasibility of switched-mode stimulator circuits; it does not aim to design a stimulation waveform that improves the activation mechanism itself with respect to classical constant current stimulation.

The organization of this paper is as follows. In Section [\ref=sec:theory] the tissue and the cell membrane are modeled with frequency dependent parameters. These models are used to analyse the response of the membrane voltage to the high frequency stimulation signal. In Section [\ref=sec:methods] the experimental setup is discussed, consisting of a prototype high frequency stimulator in combination with an in vitro patch clamp recording setup. Finally in Section [\ref=sec:results] and [\ref=sec:disc] the measurement results are presented and discussed.

Theory

A high frequency (switched) signal that is injected via the electrodes will be filtered by the tissue. First the tissue material properties influence the transient voltage over and current through the tissue. Subsequently the electric field in the tissue and the properties of the cell membrane will determine the transient shape of the membrane voltage, which is ultimately responsible for the actual activation or inhibition of the neurons. These two processes will be discussed separately.

Tissue material properties

In Figure [\ref=fig:switched]a the tissue is modeled with an interface impedance Zif and a tissue impedance Ztis. For current based stimulation Vtis = IstimZtis is independent of Zif. For voltage based stimulation Vtis  =  Vstim - Vif with Vif the voltage over Zif. In this study non polarizable Ag/AgCl electrodes will be used for which Zif  ≈  0 and therefore Vtis  ≈  Vstim [\cite=merrill].

The tissue voltage Vtis and current Itis are related to each other via the resistive and reactive properties of the tissue. In [\cite=gabriel] the capacitive and resistive properties of the tissue are measured for a wide range of frequencies and human tissue types. The resistivity and permittivity of grey matter as a function of the frequency are plotted in Figure [\ref=fig:tissueProp]a. This plot has been obtained by calculating the relative permittivity εr and conductivity σ based on the equation for the relative complex permittivity r(ω) from [\cite=gabriel]:

[formula]

Here ε0 is the permittivity of free space. As can be seen neural tissue shows strong dispersion for r(ω). To find the relation between the tissue voltage and current the values of εr and σ need to be converted to impedance. Given r the impedance Z is:

[formula]

Here C0 is a constant that sets the absolute value of the impedance, which depends among other things on the electrode geometry. It is possible to normalize the impedance, such that |Z(0)| = 1 by using:

[formula]

Here Equations [\ref=eq:epsr] and [\ref=eq:sigma] are substituted for r(ω) and σ(0) is the conductance of the tissue at ω = 0. From this it follows that C0  =  ε0  /  σ(0) to normalize the transfer such that |Z(0)| = 1. The Bode plots of this normalized impedance is given in Figure [\ref=fig:tissueProp]b.

This plot can now be used to obtain the shape for Itis and Vtis and, if the impedance of the tissue is known for a certain frequency, it can be scaled to obtain the correct absolute values.

As an example, a , , δ = 0.4 switched current signal iin(t) is supplied to an electrode system that has an impedance of [formula] at . The tissue voltage is now found by solving [formula], which is plotted in Figure [\ref=fig:tissueResp]a. Indeed the tissue voltage is filtered and in the next section it will be seen that this is important for determining the activation of the neurons.

Similary a , , δ = 0.4 switched voltage signal vin(t) can be applied. The tissue current follows from [formula] and is plotted in Figure [\ref=fig:tissueResp]b. The current spikes in Figure [\ref=fig:tissueResp]b are due to the rapid charging of the capacitive properties of the tissue that arise from εr(ω).

Tissue membrane properties

After the transient intensities of the tissue voltage and current have been determined by the stimulation protocol and the tissue impedance, it can be investigated how these quantities influence the neurons. Analogous to [\cite=Warman] the activation of the neurons is considered in the axons, for which the membrane voltage is determined using the cable equations. For these equations first the potential in the tissue as a function of the distance from the electrode is needed. When the electrode is considered to behave as a point source at the origin, the tissue potential has a 1 / r dependence assuming quasi-static conditions [\cite=Warman]: [formula], where r is the distance from the electrode.

In [\cite=bosseti] the influence on the tissue potential due to high frequency components in the stimulation signal was analyzed. It was found that the propagation effect was neglegible and that only the complex permittivity as discussed in the previous section was significant. To incorporate these properties, the potential Φ(r,jω) can be determined in the frequency domain by substituting σ with the complex permittivity, leading to:

[formula]

By transforming this potential back to the time domain, the transient of the potential [formula] at any distance r from the point source, is obtained. Since the current is divided by the complex permittivity and since there are no propagation effects, the transient shape of the potential is proportional to Vtis as obtained in Figure [\ref=fig:tissueResp]: it is just scaled as a function of the distance.

Next Φ(r,t) can be used as an input for an axon model to determine the response of the membrane voltage. The electrical parameters that are used for the axon model are summarized in Table I [\cite=Warman] [\cite=tai]. In the following section the response of both myelinated and unmyelinated axons is considered. In both sections the fiber diameter is chosen to be small ([formula]), based on the axon diameter of unmyelinated Purkinje cells, which will be used later in the in vitro experiments [\cite=Somogyi].

Myelinated axons

For a myelinated axon the model in Figure [\ref=fig:axonMod]a is used. The myelinated parts of the axon do not have ionic channels and are therefore modeled using the intracellular resistance Ri  =  ρil / (π(di / 2)2, in which l represents the internode spacing and di the axon diameter. At the nodes of Ranvier the membrane is characterized by the membrane capacitance Cm = cmπdiν, the rest potential [formula] and the nonlinear conductance GHH. The current through this conductance is given by the Hodgkin Huxley equations [\cite=hodgkin].

The membrane voltage Vm,n at node n can be found by solving the following equation that follows directly from Kirchhoff's laws [\cite=Warman]:

[formula]

Here Vo,n is the voltage due to the electric field at node n that follows from Equation [\ref=eq:Vr] and iHH is the current density given by the Hodgkin Huxley equations:

The conducances gNa, gK and gL as well as the voltage VNa, VK and VL are constants, while αx and βx depend on the membrane voltage V' = Vm - Vrest via:

The response of the membrane potential due to the high frequency electric field can now be found by solving the differential equations above. This is done in Matlab by using the classical Runge-Kutta method (RK4). A step size of is chosen during the high frequency stimulation interval, while after the stimulation pulse a step size of is used.

The switched-voltage stimulation scheme of Figure [\ref=fig:tissueResp]b was chosen first with [formula], [formula], δ = 0.5, [formula] and [formula]. An axon with the center node at a distance [formula] was considered. For this axon [formula], [formula], the nodes of Ranvier are spaced apart and a total of 9 nodes were simulated.

The resulting membrane voltage is depicted in Figure [\ref=fig:SimResults]a. First, the effect of the switched-mode stimulation can clearly be seen in the staircase transient shape of the membrane voltage. Furthermore it can be seen that the increase in the membrane voltage also leads to an action potential in the axon. This shows that according to the models, switched-mode stimulation can induce activation in the axons. Finally, this action potential is able to travel along the axon, as is shown by the response of the other nodes of Ranvier in the same Figure. A very similar result can be obtained when using switched-current stimulation.

In Figure [\ref=fig:SimResults]b the effect of the duty cycle δ is shown. The dark line shows the response for δ = 0.5 and the light line is the response for δ = 0.4. The latter setting is not able to induce an action potential anymore, which shows that δ is an effective way of controlling the stimulation intensity. The response is compared with a classical constant voltage stimulation with Vstim,classical  =  δVstim and is indicated with the dashed lines. Indeed an equivalent response is found.

Unmyelinated axons

For unmyelinated axons the model as depicted in Figure [\ref=fig:axonMod]b is used. The axon is now divided into segments of length Δx with each segment containing an intracellular resistance per unit length: ri = 4ρi / di, the capacitance per unit area cm, the resting potential [formula] and the ionic conductance per unit area gHH. Again a differential equation can be found that solves the membrane voltage Vm,n [\cite=rattay]:

[formula]

An unmyelinated axon is considered at a distance [formula]. The axon is divided into 501 segments of [formula] and has an outer diameter [formula]. For unmyelinated axons a higher stimulation intensity is needed in order to get effective stimulation. A voltage-mode stimulation signal with [formula] and δ = 0.5 is used.

The same solving strategy is chosen to solve Equation [\ref=eq:unmye]. The membrane potential is depicted in Figure [\ref=fig:SimResults]c and looks very similar to the myelinated response. Also in this case the action potential is able to travel along the axon as shown by the response of segments that are further down the axon. Note that the propagation speed is much lower than in the myelinated case, which is a well known property.

Figure [\ref=fig:SimResults]d shows the effect of varying fstim: frequencies of , and are used. As can be seen both the membrane voltage after the stimulation pulse and the response of the tissue do not depend on fstim.

The simulation results show that switched-mode stimulation is able to induce the same sort of activation as classical stimulation in both myelinated as well as unmyelinated axons. The duty cycle δ is used to control the stimulation intensity in exactly the same way as the amplitude for classical stimulation. Note that compared to the tissue material properties the membrane time constant is much larger and is therefore dominant in the filtering process.

Methods

In order to verify whether the proposed high frequency stimulation scheme is able to induce neuronal recruitment by using the tissue filtering properties, an in vitro experiment is performed.

Recording protocol

The in vitro recordings were performed in brain slices from the vermal cerebellum of C57Bl/6 inbred mice using a method similar to [\cite=Gao]. In short, mice were decapitated under isoflurance anesthesia and subsequently the cerebellum was removed and parasagittaly sliced to preserve the Purkinje cell dendritic trees ( thickness) using a Leica vibratome (VT1000S). Slices were kept for at least 1 hour in Artificial CerebroSpinal Fluid (ACSF) containing the following (in ): 124 NaCl, 5 KCl, 1.25 Na2HPO4, 2MgSO4, 2CaCl2, 26 NaHCO and 20D-glucose, bubbled with 95% O2 and 5% CO2 at 34[formula]C. picrotoxin was added to the ACSF to block the inhibitory synaptic transmission from the molecular layer interneurons. This allows recordings of post-synaptic responses in the Purkinje cells due to stimulation of the granular cell axons.

Experiments were carried out under a constant flow of oxygenated ACSF at a rate of approximately at 32±  1[formula]C. The Purkinje cells were visualized using an upright microscope (Axioskop 2 FS plus; Carl Zeiss) equipped with a 40x water-immersion objective.

The stimulus electrode is an Ag-AgCl electrode in a patchpipette pulled from borosilicate glass (outer diameter and inner diameter ) and is filled with ACSF. This electrode has an impedance [formula] and is stimulated using a monophasic cathodic stimulation protocol. The electrode is placed in the extracellular space of the molecular layer in the cerebellum lateral to where the dendritic tree of the Purkinje cells is assumed to be. We aimed to evoke neurotransmitter release from granule cell axons only and to avoid direct depolarization of the Purkinje cell dendritic tree. Although we cannot exclude that we completely avoided this latter confounding factor, this commonly used experimental approach is sufficient to compare the activation mechanisms of the classical and high frequency stimulation waveforms.

The response to the stimulus is recorded by whole cell patch-clamping Purkinje cells in the voltage-clamp mode using electrodes (same pipettes as the stimulus electrodes) filled with (in mM): 120 K-Gluconate, 9 KCl, 10 KOH, 3.48 MgCl2, 4 NaCl, 10 HEPES, 4 Na2ATP, 0.4 Na3GTP and 17.5 sucrose, pH 7.25. The membrane voltage is kept at with a holding current smaller than (recorded using an EPC 10 double patch clamp amplifier and Pulse 8.80 software, HEKA electronics).

Two different kinds of stimulation are performed and the responses of the Purkinje cell are compared to each other. First of all classical stimulation is applied using a monophasic constant current source. For this purpose a Cygnus Technology SIU90 isolated current source is used. The amplitude of the current is varied to see the effect of stimulation intensity on the response of the Purkinje cell. The stimulation protocol consisted of two consecutive stimulation pulses with a duration of [formula] each and an interpulse interval of .

Second, switched-mode stimulation is performed, also using two pulses with [formula] and an interpulse interval of . If the Purkinje cell shows a similar response for varying δ during switched mode as it does for varying amplitude during classical stimulation, it can be concluded that switched-mode stimulation is indeed able to mimic classical stimulation.

Stimulator design

The circuit used for switched-mode stimulation is depicted in Figure [\ref=fig:circuit]. As can be seen a switched-voltage stimulation scheme is applied: transistor M1 connects the electrode to the stimulation voltage [formula], [formula] or [formula] and is switched with a PWM signal of which the duty cycle δ determines the stimulation intensity.

The PWM signal is generated using the duty cycle generator circuit. Opamps OA1 and OA2 generate a triangular signal of which the frequency can be tuned using potentiometer P1. Subsequently the duty cycle δ is set using potentiometer P2 at the input of comparator OA3.

The circuit is controlled using an Arduino Uno microcontroller platform, which also supplies the circuit with a +5V supply voltage. The total circuit is isolated from ground by connecting the arduino using the USB of a laptop that is operated from its battery. Capacitor C2 and clamps D1 and D2 are used to level convert the 0-5V logic signal from the duty cycle generator to a Vstim to [formula] signal to drive the gate of M1. Resistor [formula] is used to discharge the gate of M1 to Vstim in steady state.

Because of the high electrode impedance, any parasitic capacitance that is connected to node N1 will prevent the electrode voltage to discharge during the 1 - δ interval of a switching period. This will influence the average voltage over the tissue and the relation between δ and the stimulation intensity. To prevent this effect, resistor [formula] is placed in parallel with the tissue, which allows the parasitic capacitance to discharge quickly. This resistor does consume power and reduces the power efficiency of the system dramatically. However, the power efficiency is not a design objective for this specific experiment: the only goal is to show the effectiveness of the high frequency stimulation. Without R5 the stimulation would still be effective, but the electrode voltage would not have the desired switched-mode shape. The whole circuit is implemented on a Printed Circuit Board (PCB).

Results

In Figure [\ref=fig:Meas]a the response of the Purkinje cell is shown for classical constant current stimulation for three different stimulus intensities. First there is a big positive spike corresponding to the stimulation artifact. After a small delay an excitatory postsynaptic current (EPSC) is clearly visible; during this interval the membrane current is decreased due to the opening of the postsynaptic channels of the cell.

After the second stimulus arrives and a second EPSC is generated. This EPSC is much bigger due to a process called paired pulse facilitation (PPF): due to the first depolarization the Ca2 + concentration in the activated axon terminals is higher when the second pulse arrives, leading to an increased release of neurotransmitter. From the same figure it is also clear that the EPSC becomes stronger for increasing stimulation amplitude.

In Figure [\ref=fig:Meas]b the voltage over the stimulation electrode is plotted for various stimulation settings during switched-mode stimulation: both duty cycle δ as well as the supply voltage are varied with a fixed PWM frequency of . Because of the voltage steered character the falling edge of the stimulation pulses is very sharp, while resistance R5 makes sure that it discharges reasonably fast.

In Figure [\ref=fig:Meas]c the response of the Purkinje cell is shown for switched-mode stimulation. For these plots [formula], [formula] and [formula]. An EPSC with the same shape as during classical stimulation is the result and also the PPF is clearly visible. It is also seen that by increasing the intensity of the stimulation using δ the EPSC is increased, similar to how it is increased for classical stimulation using the stimulation amplitude. These two points show that the switched-mode stimulation is able to induce similar activity in neural tissue as classical stimulation.

Discussion

In Figure [\ref=fig:Meas2]a the absolute value of the minimum in the EPSC | min (EPSC)| is given as function of the duty cycle δ ([formula], [formula]) for the three supply voltages available. Indeed for increasing supply voltage and/or increasing δ the response to the stimulation becomes stronger. This shows that both Vdd as well as δ are effective means of adjusting the stimulation intensity.

In Figure [\ref=fig:Meas2]b the cell is stimulated with [formula] and [formula], but the PWM frequency is varied from up to . As can be seen the stimulation intensity decreases for increasing frequency. This is an unexpected result, based on the simulations using the HH equations in Figure [\ref=fig:SimResults]d. However, the simulations assumed that all the energy from the voltage source was transfered to Ztis. In reality this is not possible.

In Figure [\ref=fig:tissueResp]b large current peaks can be seen due to the charging of the capacitive component in Ztis. Any resistive component in series with Ztis will reduce Vtis (the voltage over Ztis) during such a peak. Examples of these resistances could be a nonzero source impedance, the on resistance of the switch M1 and the faradaic interface resistance Zif of the electrode. For increasing fstim = 1 / ts the amount of current peaks is increasing, which also increases the losses.

This shows one of the disadvantages of using the switched-mode approach: losses can be expected due to the high frequency components in the stimulation waveform. Therefore, based on the measurement results, it can be concluded that switched-mode stimulation can lead to the same activation as classical stimulation, but care has to be taken to minimize additional losses that may arise due to the high frequency operation.

This conclusion confirms the electrophysiological feasibility for the design of stimulators that employ a high frequency output. These systems can improve on important aspects such as power efficiency [\cite=arfin] and size [\cite=Liu] of the stimulator. A trade-off needs to be made between the advantages that switched-mode operation can offer versus the additional losses.

This paper didn't address the consequences for tissue damage due to the use of the switched-mode approach. Most of the studies analyzing tissue damage [\cite=shannon] [\cite=butterwick] use a classic stimulation scheme only and therefore it is not known how their results translate to switched-mode operation. Furthermore, the losses due to the high frequency operation are not quantified, since the stimulator circuit that was used did not allow for that. It would be required to compare the EPSC with the total amount of charge injected in the tissue (and not R5) during the stimulation pulse. Further investigation is needed to address these issues.

Conclusions

In this paper a theoretical analysis and in vitro experiments were used to verify the efficacy of high frequency switched-mode stimulation. Using modeling that included the dynamic properties of both the tissue material as well as the axon membrane it was found that high frequency stimulation signals can recruit neurons in a similar fashion as classical constant current stimulation.

The response of Purkinje cells due to stimulation in the molecular layer was measured for both classical and switched-mode stimulation. The measurements confirmed the modeling in showing that switched-mode stimulation can induce neuronal activation and that both the duty cycle δ and the stimulation voltage Vstim are effective ways to control the intensity of the stimulation. This shows that from an electro-physiological point of view, it is feasible to use high frequency stimulation, which paves the way for the design of switched-mode stimulator circuits. Care has to be taken to avoid losses in the stimulation system that arise due to the use of a high frequency stimulation signal.

Acknowledgements

The authors would like to thank the SINs group (http://www.braininnovations.nl/) for the excellent collaboration.