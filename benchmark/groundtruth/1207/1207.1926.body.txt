Theorem

Corollary

Definition

Proposition

Phase transition and diffusion among socially interacting self-propelled agents

Alethea B.T. Barbaro

Department of Mathematics

Case Western Reserve University

10900 Euclic Avenue-Yost Hall Room 220

Cleveland, OH 44106-7058, USA.

alethea.barbaro@case.edu

Pierre Degond

Université de Toulouse; UPS, INSA, UT1, UTM

Institut de Mathématiques de Toulouse

31062 Toulouse, France.

and

CNRS; Institut de Mathématiques de Toulouse UMR 5219

31062 Toulouse, France.

pierre.degond@math.univ-toulouse.fr

Acknowledgements: This work has been supported by the french 'Agence Nationale pour la Recherche (ANR)' in the frame of the contracts 'MOTIMO' (ANR-11-MONU-009-01) and 'CBDif-Fr' (ANR-08-BLAN-0333-01).

Key words: Swarm, Cucker-Smale model, Vicsek model, self-propulsion, hydrodynamic model, diffusion, Chapman-Enskog expansion.

AMS subject classification: 35L60, 35K55, 35Q80, 82C05, 82C22, 82C70, 92D50.

Introduction

There is a considerable literature devoted to the observation and understanding of systems of swarming agents. Examples of such systems in nature are fish schools [\cite=Becco_etal_PhysicaA06] [\cite=Katz_etal_PNAS11], bird flocks [\cite=Ballerini_etal_PNAS08] [\cite=Lukeman_etal_PNAS10], insect swarms [\cite=Buhl_etal_Science2006] [\cite=Couzin_Franks_PRoySocB03] or migrating cell assemblies [\cite=Yamao_etal_PLOSone11] (see also the reviews [\cite=Couzin_Krause_03] [\cite=Vicsek_Zafeiris]). Some simple inanimate physical systems also exhibit collective behavior [\cite=Deseigne_etal_PRL10] [\cite=Suematsu_etal_PRE10]. Many of the models proposed in the literature are 'Individual-Based Models (IBM)'. They consist in following the dynamics of the agents and their interactions over the course of time. The 'three zone model' of Aoki [\cite=Aoki] [\cite=Couzin_etal_JTB02] postulates that interactions obey long-range attraction, short-range repulsion and medium-range alignment. Vicsek et al. [\cite=Vicsek_etal_PRL95] have proposed a simplified version of this model where particles move at a constant speed and interact through alignment only. In spite of its simplicity, the Vicsek model exhibits complex features which have triggered a large literature (see [\cite=Vicsek_Zafeiris] for a review and references). On the other hand, the Cucker-Smale model [\cite=Cucker_Smale_IEEE07] is based on a large-scale velocity consensus formation and does not impose any constraint on the particle speed. The Cucker-Smale model has triggered considerable mathematical activity [\cite=Carrillo_etal_SIMA10] [\cite=Cucker_Mordecki_JMPA08] [\cite=Ha_etal_CMS09] [\cite=Ha_Liu_CMS09] [\cite=Ha_Tadmor_KRM08] [\cite=Shen_SIAP07]. Many other kinds of IBM's of collective motion can be found and it is impossible to cite them all (see e.g. [\cite=Carrillo_etal_M3AS10] [\cite=Chuang_etal_PhysicaD07] [\cite=Dorsogna_etal_PRL06] [\cite=Mogilner_etal_JMB03] and the review [\cite=Vicsek_Zafeiris]). Additionally, comparisons of models with data can be found e.g. in [\cite=Barbaro_etal_MCS09] [\cite=Barbaro_etal_ICESJMS09] [\cite=Hemelrijk_Hildenbrandt_PLOSone11].

IBM's are very successful but become computationally intensive for large systems. For this reason, macroscopic models of fluid type have been proposed in the literature. Macroscopic models of collective motion have been derived from heuristic rules and symmetry considerations in [\cite=Toner_Tu_PRL95] [\cite=Toner_etal_AnnPhys05]. The rigorous derivation of continuum models usually starts from a statistical version of the IBM, the so-called kinetic model. Kinetic models of collective motion have been derived in [\cite=Bolley_etal_M3AS11] [\cite=Bolley_etal_AML12] [\cite=Carrillo_etal_SIMA10] for various versions of the Cucker-Smale and Vicsek models. The convergence of the kinetic Cucker-Smale model to the kinetic Vicsek model is shown in [\cite=Bostan_Carrillo]. In [\cite=Bertin_etal_PRE06] [\cite=Bertin_etal_JPA09], a Boltzmann type kinetic model has been proposed for binary collision processes which mimics the Vicsek alignment dynamics. In the same spirit, a Boltzmann-Povzner type approach which mimics the Cucker-Smale process and its fluid limit has been developed in [\cite=Fornasier_etal_PhysicaD11]. In [\cite=Bertin_etal_PRE06] [\cite=Bertin_etal_JPA09], a hydrodynamic model for the binary version of the Vicsek interaction is derived from the kinetic model under an assumption of weak anisotropy of the velocity distribution function. In [\cite=Ratushnaya_etal_PhysicaA07] a direct passage from the Vicsek IBM to a fluid model is attempted. The first derivation of hydrodynamic-like equations from the mean-field kinetic version of the Vicsek model has been performed in [\cite=Degond_Motsch_M3AS08]. Further elaboration of the model can be found in [\cite=Degond_etal_submitted1] [\cite=Degond_etal_submitted2] [\cite=Frouvelle_M3AS12] [\cite=Frouvelle_Liu_SIMA12]. Diffusive corrections to the model of [\cite=Degond_Motsch_M3AS08] have been derived in [\cite=Degond_Yang_M3AS10] and bear analogies with the model proposed in [\cite=Mishra_etal_PRE10]. Other kinds of macroscopic models can be found in [\cite=Bertozzi_etal_Nonlinearity09] [\cite=Eftimie_etal_PNAS07] [\cite=Mogilner_EK_JMB99] [\cite=Topaz_Bertozzi_SIAP04] [\cite=Topaz_etal_BMB06].

The aim of the present work is twofold. The first objective is to give evidence of a phase transition from disordered to ordered motion in a hydrodynamic model of socially interacting agents with self-propulsion. Specifically, we want to emphasize the role of the self-propulsion in the emergence of the phase transition. Such evidence has been given for the first time in [\cite=Toner_Tu_PRL95]. However, the model of [\cite=Toner_Tu_PRL95] is based on analogy with the Vicsek IBM, not on an actual derivation from it. In [\cite=Toner_Tu_PRL95], the techniques used to show the emergence of a phase transition are rather complex: they are based on stability analysis in the linear case and renormalization group theory in the nonlinear case. In the present work, the model we investigate is derived from a simple IBM of collective motion combining a noisy Cucker-Smale consensus force and self-propulsion. The phase transition appears simply when analyzing the behavior of the model in the limit of a large self-propulsion force. It manifests itself as a change in the type of limit model at the crossing of a critical noise intensity. Above the critical noise, the limit model is of diffusion type, while below the critical noise, it is of hyperbolic type. To the best of our knowledge, the present work is the first instance where phase transitions in particle swarms have been evidenced in this way from a hydrodynamic model. A similar approach, but at the level of the kinetic model, can be found in [\cite=Degond_etal_submitted1] [\cite=Frouvelle_Liu_SIMA12].

The second goal of this work is to discuss the relative merits of the Cucker-Smale and the Vicsek models for the derivation of hydrodynamic models of particle swarms. As mentioned above, the Vicsek kinetic model imposes that kinetic velocities be of constant norm, while no such constraint exists in the Cucker-Smale model. Instead, a self-propulsion force is imposed to force the particle speed to stay close to a 'comfort' velocity. In [\cite=Bostan_Carrillo], it is shown that the Cucker-Smale model relaxes to the Vicsek model when the intensity of the self-propulsion force tends to infinity. The derivation of hydrodynamic models from the Vicsek kinetic model is considerably complexified by the velocity norm constraint. Indeed, momentum conservation is lost and the use of conserved quantities (or collision invariants), which is the cornerstone of the derivation of hydrodynamic models, cannot be implemented. In [\cite=Degond_Motsch_M3AS08], this problem has been overcome by the introduction of a new concept of 'Generalized Collision Invariant'. But if the hydrodynamic limit could be performed equivalently on the Cucker-Smale model, these unpleasant technicalities would be proven unnecessary.

Unfortunately, performing the hydrodynamic limit on the Cucker-Smale model and then letting the self-propulsion force tend to infinity is not equivalent to performing the hydrodynamic limit on the Vicsek model. This is the second main result of the present work. Indeed, the type of the resulting model is the same, but the coefficients of the model are not the same. Specifically, the limit model has the form of a system of isothermal compressible Euler equations for the swarm density ρ and the mean velocity direction ω (also referred to as the polarization field, see e.g. [\cite=Mishra_etal_PRE10]). The velocity direction ω is a vector of norm one. To maintain this constraint, the model includes some non-conservative terms. Additionally, the convective derivatives involved in the mass and momentum transport are not the same, a signature of a loss of Galilean invariance (see e.g. [\cite=Tu_etal_PRL98]). This model has been referred to in [\cite=Degond_etal_submitted2] as the 'Self-Organized Hydrodynamic (SOH)' model. In the present work, we show that the SOH model derived from the Cucker-Smale kinetic equation necessarily involves the same convective derivatives in the density and in the velocity equations. Therefore, with the Cucker-Smale model, we cannot access the whole range of possible hydrodynamic limits that we can access with the Vicsek model. With the Cucker-Smale model, we only get a sub-class of these models, which limits its practical applications: having different convective derivatives for ρ and ω increases the likelihood of correctly reproducing emergent phenomena in swarms, such as cluster formation, waves, etc.

This restriction, which is a significant disadvantage of the Cucker-Smale approach, can be weakened, at least partially. Indeed, in the last part of the present work, we include small diffusive corrections to the hydrodynamic limit of the Cucker-Smale model, by means of a Chapman-Enskog method (see e.g. [\cite=Degond_Birkhauser04] for a review). If the self-propulsion is taken to infinity in the resulting compressible Navier-Stokes system, then a more general SOH model, in particular with possibly different convective derivatives for ρ and ω, can be derived. This approach is limited by the necessity to keep the diffusive corrections small; this limits the range of the coefficients of the SOH model which can be obtained. This paper shows that most SOH models can be realized in a fairly general context as hydrodynamic limits of either Cucker-Smale or Vicsek kinetic models. For these reasons, we conclude that the two approaches are somehow equivalent in the amount of technical work: while the Vicsek model made use of generalized collision invariants, starting from the Cucker-Smale model necessitates dealing with the complex diffusion terms.

The paper is organized as follows. The problem is set up in Section [\ref=sec:setting]. Then, some functional properties of the operators are recalled in Section [\ref=S:properties_Q]. The hydrodynamic and large self-propulsion limits are derived in Section [\ref=sec:hydro]. The diffusive corrections are dealt with in Section [\ref=sec:diffusive]. Finally, a conclusion and some perspectives are drawn in Section [\ref=sec_conclu]. Three appendices collect some of the more technical proofs.

Setting of the problem

Velocity consensus in self-propelled agent systems

We consider a system of agents with positions [formula] and velocity [formula], where d is the system dimension (in practice equal to 2 or 3), t  ≥  0 is the time and [formula] is the agent's label. These agents are subject to a self-propulsion force which tends to restore a comfort velocity a > 0, and to a social force which drives them to the average velocity of the neighboring agents. Addtionally, they are subject to random velocity fluctuations which account for potential misperceptions and their propensity to leave the swarm and explore a new environment. The equations of motion are given by

[formula]

with

[formula]

The social force Fi is written in ([\ref=eq:ibmF]) as a relaxation force towards the average velocity i in the neighborhood of particle i. The relaxation rate is σ- 1 (in other words, σ is the typical time needed for agent i to align with the velocity of his neighbors). The kernel K, supposed spherically symmetric for the sake of simplicity, describes how the various partner velocities vj are combined according to the distance of j to i. For instance, if K is the indicator function of the ball of radius R, it means that the agents adopt the mean velocity of the other agents within a distance R. The second term in the expression of dvi in ([\ref=eq:ibmxv]) is the self-propulsion force. It takes the form of a relaxation term driving |vi| towards a at rate τ- 1. In other words, it takes a time τ for the velocity |vi| to relax to the comfort speed a. Finally, the last term is the velocity fluctuation term, where Bit are independent normalized Brownian processes and D > 0 is the diffusion coefficient. The force Fi has been previously proposed by Cucker and Smale [\cite=Cucker_Smale_IEEE07] as a model for consensus formation in particle swarms. A noisy version of the Cucker-Smale model is proposed in [\cite=Cucker_Mordecki_JMPA08].

In the large particle limit N  →    ∞  , by adapting the arguments in [\cite=Bolley_etal_M3AS11], the empirical measure of the system

[formula]

where δ(xi(t),vi(t))(x,v) is the Dirac delta at (xi(t),vi(t)), can be approximated by a continuous distribution function f(x,v,t). It solves the following Fokker-Planck equation:

[formula]

with

[formula]

The left-hand side expresses particle displacement at velocity v. The right-hand side consists of three terms. The first one is the consensus force. The second term is the self-propulsion force. The last term takes into account the random velocity fluctuations.

Scaling

In order to understand the roles of the various terms, it is useful to introduce dimensionless quantities. We set x0 and t0 to be space and time units and deduce units of velocity v0  =  x0 / t0 and force F0  =  x0 / t20. We assume that the range of the interaction kernel K is R, meaning that we can write K(|x|)  =  (|x| / R) with [formula] having second moment of order 1 (i.e. [formula]; we assume that [formula] is normalized to 1, i.e. [formula]). We now introduce dimensionless variables   =  x / x0, t̃  =  t / t0, ṽ  =  v / v0 and the change of variables (,ṽ,t̃)  =  xd0  vd0  f(x0,v0ṽ,t0t̃). Finally, we introduce the dimensionless parameters:

[formula]

In this new system of coordinates, the system is written:

[formula]

where we have dropped the tildes for the sake of clarity. Now, by fixing the relations between the five dimensionless parameters ([\ref=eq:dimpar]), we define the regime we are interested in. We suppose that the diffusion and social forces are simultaneously large, while the range of the social force tends to zero. The parameters of the self-propulsion are kept of order 1. More specifically, we let ε  ≪  1 be a small parameter and we assume that   =  O(1 / ε) (large diffusion), σ̂- 1  =  O(1 / ε) (large social force), R̂  =  O(ε) (small range of social interaction), while τ̂- 1  =  O(1) and â  =  O(1) (parameters of the social force are order unity). In order to highlight these scaling assumptions, we define constants [formula], [formula], [formula], which are all O(1) and such that

[formula]

Then, with these new notations, and dropping all 'hats' and 'sharps', we get the following scaled system:

[formula]

We will investigate the limit as ε  →  0 of this system, while all other parameters (i.e. τ, a, D, σ and R) are kept fixed. Hence, we highlight the dependence of f upon ε.

We can simplify the problem by using Taylor's expansion. At leading order, we find:

[formula]

Then, we have

[formula]

which leads to:

[formula]

We will drop the O(ε2) terms, since, as a first step, we consider only the leading and first order terms. Then, problem ([\ref=E:ourPDE]) can be written as

[formula]

with the collision operator Q(f):

[formula]

Some remarks concerning scaling ([\ref=eq:parscaled]) can be made. The diffusion and social forces are supposed of the same order of magnitude and much larger than all other forces. They counterbalance each other. Indeed, the social force makes the agents adopt the same velocity while diffusion tends to spread the velocities out. This balance results in a Maxwellian velocity profile (i.e. Gaussian in velocity space), as shown later on. The choice which is made here is to assume that the self-propulsion force is weaker. Another choice would have been to make the self-propulsion force as large as the social force and the diffusion. In this case, the balance would involve three different effects and would result in more complicated equilibria. This investigation is in progress [\cite=Barbaro_etal_inprep]. The interaction range is supposed to tend to zero like the inverse of the interaction rate. It is no surprise that, at leading order, only spatially local interaction terms remain (which can be seen in ([\ref=E:collisionAlphaZero]) by the replacement of the non-local average velocity [formula] by the local mean velocity uf). Again, other choices can be made. In [\cite=Degond_etal_submitted2], in the case of the Vicsek model (which is the limit of ([\ref=E:ourPDE_1]) when τ  →  0), it is shown that the different choice [formula] leads to a different macroscopic limit when ε  →  0. This choice takes better care of the non-local character of the interaction. It will be investigated in future work.

Our plan is now to investigate the hydrodynamic limit ε  →  0 in this model. To this end, we first examine the properties of the collision operator Q.

Properties of Q

When ε  →  0 in ([\ref=E:ourPDE_1]), fε formally converges to an element of the null-space of Q, i.e. a function f such that Q(f)  =  0. In this limit, the dynamics are characterized by the projection of the left-hand side of ([\ref=E:ourPDE_1]) onto the space orthogonal to the range of Q. This space is spanned by the so-called 'collision invariants'. In this section, we successively determine the null-space of Q and its collision invariants.

Null-Space

We first define the Maxwellian with mean velocity [formula] and temperature T  =  σD > 0 as follows:

[formula]

Note that Mu satisfies [formula] and [formula].

To proceed, we need to determine a functional setting. Let [formula] and define a weighted L2-space Hu such that and a weighted H1-space Vu such that with the associated norms:

[formula]

and inner products (  ·  ,  ·  )Hu, (  ·  ,  ·  )Vu, and ((  ·  ,  ·  ))Vu respectively.

(i)The operator Q given by [\eqref=E:collisionAlphaZero] can be reformulated as:

[formula]

(ii) For any function f(v) such that f / Muf∈Vuf and for any function g∈Vuf, we have:

[formula]

In particular, we have:

[formula]

(iii) The null-space Ker  Q  =  {f(v)  |  f / Muf∈VufQ(f)  =  0} is given by:

[formula]

The proof of this lemma is postponed to Appendix [\ref=app_prop_Q]. An element ρMu of Ker(Q) is called a local thermodynamic equilibrium with density ρ and mean velocity u.

Collision invariants

A function ψ(v) is said to be a collision invariant (CI) if and only if

[formula]

for every f such that f / Muf∈Vuf and ψ∈Vuf. The set of CI's is denoted by C. It is a vector space.

We have the:

We have [formula]. In other words, ψ is a CI if and only if there exists [formula] and [formula] such that ψ(v)  =  a + b  ·  v.

The proof of this proposition is again postponed to Appendix [\ref=app_prop_Q].

Hydrodynamic limit and fast relaxation

The goal of this section is to investigate the formal limit ε  →  0 in ([\ref=E:ourPDE_1]) and to examine some of the properties of the limit system relative to the propulsion force. More precisely, we exhibit a phase transition when the intensity of the velocity fluctuations crosses a certain threshold dependent on the magnitude of the propulsion velocity.

Hydrodynamic limit

The goal of this section is to prove the following formal theorem:

Let [formula] be the solution of equation ([\ref=E:ourPDE_1]) associated to an initial datum fI(x,v). We suppose that fI is independent of ε for simplicity. We assume that solutions of ([\ref=E:ourPDE_1]) exist on any time interval

[formula]

ρ = f   dv,   ρ u= f   v   dv.

[formula]

Proof. First, we note from ([\ref=E:ourPDE_1]) that Q(fε)  =  O(ε). Therefore Q(f0)  =  0, which, because of ([\ref=eq:KerQ]), implies that f0 is of the form ([\ref=eq:f0]).

Next, using the CI's given by Proposition [\ref=prop:CI], we multiply ([\ref=E:ourPDE_1]) successively by 1 and v and use the fact that the right-hand side vanishes upon integration. Then, we get the following conservation relations, which are valid for any ε:

[formula]

with ρε, jε, Σε, the density, flux and pressure tensor associated to fε, given by:

[formula]

and right-hand side qε given by

[formula]

Now, letting ε  →  0, we can express j  =   lim jε, Σ  =   lim Σε and q  =   lim qε as functions of ρ and u:

[formula]

Inserting these expressions into the conservation equations leads to ([\ref=E:alpha1]), ([\ref=E:alpha2]). The statement about the initial conditions is obvious.

Dividing [\eqref=E:alpha2] by ρ and using [\eqref=E:alpha1], the momentum conservation equation can be written in non-conservative form:

[formula]

This model is nothing but the Euler system of isothermal compressible gas dynamics with a forcing term. The mass conservation equation ([\ref=E:alpha1]) (also known as the continuity equation) has a standard form. The momentum balance equation ([\ref=E:alpha2]) involves an isothermal pressure Tρ on the left-hand side and a self-propulsion force on the right-hand side. The temperature T  =  σD is proportional to the ratio of the intensities of the velocity fluctuations D and of the social force σ- 1. The self-propulsion force takes the form of a relaxation of the fluid velocity to a comfort fluid velocity [formula]. In comparison to the force acting on individual particles, the force acting on the fluid involves a term depending on the temperature. The temperature being a truly macroscopic quantity, this term cannot have any counterpart at the particle level. Here, at the fluid level, the comfort fluid velocity becomes a pure imaginary number when T is larger than a critical temperature Tc  =  a2 / (d + 2). When the temperature crosses Tc, a phase transition occurs. This phase transition is studied in the next section when the intensity τ- 1 of the self-propulsion force is taken to infinity, a limit which we refer to as the 'fast relaxation limit'.

Fast relaxation limit in the hydrodynamic model

We recall that, according to our notation, τ is the ratio of the physical relaxation time to the time unit t0 (see Section [\ref=subsec_scaling]) and is a dimensionless parameter. The goal of this section is to investigate the limit τ  →  0 in the hydrodynamic model ([\ref=E:alpha1]), ([\ref=E:alpha2]). We denote by (ρτ,uτ) the solution for finite τ and assume that its limit (ρ,u) as τ  →  0 exists and is as smooth as needed. We will use the non-conservative form of the model, which we recall here for the sake of convenience:

[formula]

Letting τ  →  0 formally in ([\ref=E:alpha2_del]) leads to |u|2  +  (d + 2)T  -  a2  =  0. Therefore, there are two cases according to whether the quantity (d + 2)T  -  a2 is positive or negative, i.e. according to the position of T with respect to the critical temperature Tc defined by

[formula]

Case T > Tc (large noise)

We let (d + 2)T  -  a2  =  (d + 2)(T  -  Tc): = s2 > 0. The constant s only depends on the problem data and not on the solution. In this case, equation [\eqref=E:alpha2_del] becomes

[formula]

To examine the limit τ  →  0, we need to find the equilibria of the right-hand side of ([\ref=eq:utau_strong]), i.e. the solutions u of u(|u|2  +  s2)  =  0. Obviously, the only solution is u = 0. Additionally, at least in the spatially homogeneous setting, this is a stable solution. Indeed, the unique solution of

[formula]

satisfies u(t)  →  0 as t  →    ∞  . So, in the spatially non-homogeneous case, we formally have uτ  →  0 as τ  →  0. Therefore, the formal limit of ([\ref=E:alpha1]), ([\ref=E:alpha2]) gives

[formula]

In order to get a more precise description of the limit τ  →  0, we need to rescale time and velocity.

With this aim, we let t'  =  τt and uτ(x,t)  =  τũτ(x,t'), ρτ(x,t)  =  τ(x,t'). Inserting this into ([\ref=E:alpha1]), ([\ref=E:alpha2]), we find (dropping the tildes):

[formula]

The behavior of this system when τ  →  0 is that of a diffusion. More precisely, we state:

Assume that the solution (ρτ,uτ) of system ([\ref=E:alpha1_til]), ([\ref=E:alpha2_til]) is smooth and converges smoothly towards a pair (ρ,u) as τ  →  0. Then, ρ satisfies the following diffusion equation:

[formula]

and [formula].

Proof. Taking τ  →  0 in equation ([\ref=E:alpha2_til]), we get [formula]. The limit model therefore follows from the continuity equation ([\ref=E:alpha1_til]) and is given by ([\ref=eq:heat]).

We note that [formula] when [formula]. Therefore, the time variation of ρ is faster as T - Tc gets smaller. We can rescale time to a faster time-scale by setting [formula]. Then, in the rescaled variables, the diffusion equation ([\ref=eq:heat]) becomes independent of T - Tc and gives the standard heat equation   ∂tρ  -  Δxρ  =  0   (omitting the primes for simplicity).

Case T < Tc (small noise)

Let us now consider the dynamics of the system in the case of smaller noise. In this section, we aim to prove the following:

Let T < Tc and define c2  =  a2 - (d + 2)T  =  (d + 2)(Tc  -  T) > 0. Assume that the solution (ρτ,uτ) of system ([\ref=E:alpha1_del]), ([\ref=E:alpha2_del]) is smooth and converges smoothly towards a pair (ρ,u) as τ  →  0. Assume additionally that (ρτ,uτ) is not identically equal to (ρ0,0) where ρ0 is constant in both space and time. Then, u  =  cω, where [formula] and the pair (ρ,ω) satisfies the following system:

[formula]

where [formula] is the orthogonal projection onto the hyperplane orthogonal to ω.

We easily see, taking the scalar product of ([\ref=E:alpha2_st]) with ω, that

[formula]

This implies that [formula] for all time provided that |ω(x,0)|  =  1 initially.

Proof. Equation [\eqref=E:alpha2_del] is now written as:

[formula]

We now look for the equilibria of the right-hand side of ([\ref=E:Z]), namely the solutions of

[formula]

There are two sets of equilibria. The first set reduces to the single point u = 0. The second set is the sphere |u|2  =  c2. We now show that in the spatially homogeneous setting, the first equilibrium is unstable, while the second class of equilibria is orbitally stable. Indeed, let us consider the solution u(t) of the differential equation

[formula]

Its solution can be analytically given by

[formula]

and is such that |u(t)|  →  c for all initial data u0 except u0  =  0. This shows that u0 = 0 is an unstable equilibrium. On the other hand, if one perturbs an equilibrium |u0|2  =  c2 by a small amount, the solution will relax to an element of the circle |u|2  =  c2 (where u may be different from u0).

Now, we let τ  →  0 in the non spatially homogeneous system ([\ref=E:alpha1_st]), ([\ref=E:Z]). Unless uτ is identically zero, which can only occur for a uniform density ρ0, uτ converges (at least formally) towards one of the stable equilibria. Therefore, we have uτ  →  u  =  cω with |ω|  =  1. In order to find the equation satisfied by ω, we introduce a polar decomposition of the solution uτ. We write uτ  =  cτωτ, with cτ  =  |uτ| and ωτ  =  uτ / cτ. Let Pτ the orthogonal projection of [formula] onto the hyperplane orthogonal to ωτ. The projection Pτ can be written tensorwise as [formula]. Inserting the polar decomposition of uτ in ([\ref=E:Z]) leads to:

[formula]

We note that, because |ωτ| = 1 and the operator [formula] is a derivative, the vector [formula] is orthogonal to ωτ. Furthermore, the first term of the left-hand side and the right-hand side are parallel to ωτ. Therefore, applying Pτ to the second term of the left-hand side leaves it unchanged, while it cancels the first term of the left-hand side and the right-hand side. Consequently, applying Pτ to ([\ref=E:Z2]) leads to:

[formula]

Now, taking the limit τ  →  0 formally leads to ([\ref=E:alpha2_st]).

System ([\ref=E:alpha1_st]), ([\ref=E:alpha2_st]) has been referred to in the literature as the Self-Organized Hydrodynamic (SOH) system [\cite=Degond_etal_submitted1] [\cite=Degond_etal_submitted2]. It has the form of a compressible gas dynamics system with isothermal equation-of-state and geometric constraint |ω| = 1. The projection operator P which multiplies the pressure term [formula] maintains the constraint over the course of time (see Remark [\ref=rem_omega_norm1]). It results in a non-conservative term (since P depends on ω). This type of system has been derived for the first time in [\cite=Degond_Motsch_M3AS08] and has been shown to be hyperbolic. Beyond this result, the mathematical study of such systems is in its infancy. A local existence result is given in [\cite=Degond_etal_submitted2] and some special solutions are given in [\cite=Motsch_Navoret_MMS11].

When [formula], we have c  →  0 and therefore, ρ becomes constant. To find a non-trivial dynamics, we must rescale time to a slower time-scale. By the time rescaling t'  =  ct, system ([\ref=E:alpha1_st]), ([\ref=E:alpha2_st]) can be written (dropping the primes):

[formula]

The parameter (Tc - T) / T plays the role of the squared Mach-number in the standard compressible Euler system. Therefore, the limit T  →  Tc, is similar to a small Mach-number limit. When [formula], we formally get ρ  →  ρ0 where ρ0 is a constant in space. With appropriate boundary conditions we can assume that ρ0 is also independent of time. Then, the limit system as [formula] is written as follows:

[formula]

where π is a hydrodystatic pressure defined by

[formula]

This system has been already proposed in [\cite=Degond_etal_JSP10] for modeling gregariousness. It is a system of incompressible Euler equations subject to the geometric constraint |ω| = 1.

The behavior of the (appropriately rescaled) SOH system ([\ref=E:alpha1_st]), ([\ref=E:alpha2_st]) when [formula] is very different from the behavior of the (appropriately rescaled) diffusion equation ([\ref=eq:heat]) when [formula]. The former is given by the incompressible Euler equations with geometric constraint |ω| = 1 while the latter is the standard diffusion equation (see Remark [\ref=rem_heat_fast]). This drastic change of type is the signature of a phase transition further elaborated on in Section [\ref=subsubsec:comments].

Comments

The fast relaxation limit of the compressible Euler system with self-propulsion ([\ref=E:alpha1]), ([\ref=E:alpha2]) exhibits two different regimes for temperatures below or above the critical temperature Tc. Above Tc, the behavior of the system is that of a diffusion, while below Tc, the system obeys a hyperbolic system, the Self-Organized Hydrodynamic (SOH) model ([\ref=E:alpha1_st]), ([\ref=E:alpha2_st]). Even when the temperature is close to the critical temperature, it is not possible to match the two types of models in a smooth way, as noticed in the previous section. This abrupt change in the type of the model as the temperature crosses a threshold is a manifestation of a phase transition. Since Tc depends on a, the phase transition originates from the self-propulsion force. Indeed, when a = 0 (i.e. no self-propulsion), Tc = 0 and there is no phase transition: the system is in the diffusion regime in all circumstances.

Phase transitions in self-propelled particle systems have already been evidenced [\cite=Vicsek_etal_PRL95] and an abundant literature has been devoted to them (see the review [\cite=Vicsek_Zafeiris]). Phase transition in hydrodynamic models of self-propelled particles have first been studied in [\cite=Toner_Tu_PRL95] (see also the review [\cite=Toner_etal_AnnPhys05]). However, the equations proposed in [\cite=Toner_Tu_PRL95] are more complicated than the ones seen here. They are derived solely on heuristic principles and invariance considerations. Their analysis is based on a combination of linear and nonlinear techniques. There is no link to the underlying particle models. The link between hydrodynamic and particle models of self-propeled particle systems has been made in [\cite=Bertin_etal_PRE06] [\cite=Bertin_etal_JPA09], but for binary interaction mechanisms instead of the mean-field interaction considered here. Here, the hydrodynamic model is derived from the underlying particle dynamics and is much simpler: it merely consists of the isothermal compressible Euler model complemented with the self-propulsion force. The phase transition manifests itself in the change of type of the PDE which describes the system under large self-propulsion.

The SOH model ([\ref=E:alpha1_st]), ([\ref=E:alpha2_st]) has previously been derived in [\cite=Degond_Motsch_M3AS08] from a system of self-propelled particles which have constant and uniform velocity. In [\cite=Bostan_Carrillo], it has been shown that the kinetic model with the velocity norm constraint of [\cite=Degond_Motsch_M3AS08] is the the fast relaxation limit τ  →  0 of ([\ref=E:ourPDE_1]). A natural question is then whether the imposition of the norm constraint at the particle and kinetic levels as in [\cite=Degond_Motsch_M3AS08] is necessary or useful. Indeed, there are now two ways of deriving the SOH model from ([\ref=E:ourPDE_1]), which are summarized in Fig. [\ref=fig:CD]. The first way is to follow the top horizontal and right vertical arrows successively. This is what is done in [\cite=Degond_Motsch_M3AS08] and [\cite=Bostan_Carrillo]. The second way is to follows the left vertical and bottom horizontal arrows successively. This is what is done here.

There is however one noticeable difference between the two strategies. In [\cite=Degond_Motsch_M3AS08], the system is written:

[formula]

where the constants c1 and c2 are such that 0  <  c2  ≤  c1. In [\cite=Frouvelle_M3AS12], it has even been shown that taking into account an anisotropic vision, (c1,c2) can be made arbitrary. We would recover ([\ref=E:alpha1_st]), ([\ref=E:alpha2_st]) if we could set c2  =  c1  =  c and δ  =  T / c. However, it is not possible since, in [\cite=Degond_Motsch_M3AS08], [formula]. Therefore, the diagram in Fig. [\ref=fig:CD] is not commutative. This shows how important it is to enforce the norm constraint at the kinetic level, in spite of the induced difficulties. Indeed, such constrained kinetic models do not exhibit momentum conservation and lack classical collision invariants such as those derived in Section [\ref=subsec:CI]. This makes the derivation of hydrodynamic models considerably more complex. In [\cite=Degond_Motsch_M3AS08], new concepts have been developed to bypass these difficulties. The fact that [formula] is a direct consequence of these features.

The question whether c1  =  c2 or not has important consequences. Indeed, the SOH system is Galilean invariant if and only if c1  =  c2 (which is the case here). However, in the generic case [formula], the SOH system is not Galilean invariant. This fact reflects a key feature of collective motion: the anisotropy of information flow. This is evidenced in car traffic, where perturbations of velocities (typically moving with speed c2 < c1) propagate upstream the flow (whose speed is c1). This phenomenon is a consequence of the fact that information propagates upstream from drivers ahead to drivers behind. When c1  =  c2, this property is lost and information spreads in an isotropic way just like usual gas dynamics. In such a case, the model is unable to correctly reproduce the complex emerging patterns (such as congestions and waves in car traffic). We refer to [\cite=Tu_etal_PRL98] for a discussion of the loss of Galilean invariance in biological swarms.

The approach of [\cite=Degond_Motsch_M3AS08] does not lead to phase transitions: whatever the values of the temperature T or self-propulsion velocity a, the limit system is of hydrodynamic type. The very large intensity of the self propulsion force which is needed to perform the τ  →  0 limit first (top horizontal arrow in diagram [\ref=fig:CD]) prevents any diffusion regime to establish. However, the emergence of a phase transition is a well-established experimental fact (see review in [\cite=Vicsek_Zafeiris]). The inability of [\cite=Degond_Motsch_M3AS08] to produce phase transitions can be seen as a major drawback. Fortunately, it has been proved in [\cite=Degond_etal_submitted1] that adding a dependence of the social force intensity σ- 1 upon the flux j restores the phase transition. It also brings density-dependent phase transition. More precisely, the parameter controling the phase transition is the ratio T / ρ. A natural question is to explore similar features here. This question will be investigated in future work.

Here, we choose a different direction: we explore whether the inclusion of diffusion terms can cure the deficiency of the SOH models derived here (i.e. the fact that c1 = c2). This is the goal of the next section.

Diffusive corrections to the hydrodynamic model

Setting of the problem

In this section, we derive O(ε) diffusive corrections to the compressible Euler model with self propulsion ([\ref=E:alpha1]), ([\ref=E:alpha2]). We show that these diffusive corrections lead to a system of isothermal compressible Navier-Stokes equations including self-propulsion. In a second step, we perform the fast relaxation limit τ  →  0 in the resulting Navier-Stokes model and compare it to the SOH model obtained in Proposition [\ref=prop_small_noise].

We now set up the problem. We define

[formula]

We assume that the observation kernel K(|ξ|) is such that [formula] and we denote by k > 0 the second moment of K, i.e.

[formula]

For instance, if K is the indicator function of the ball of radius 1, [formula], where [formula] is the (d - 1)-dimensional measure of [formula]. In the cases of d = 2 and d = 3, we respectively get k  =  π / 8 and k  =  2π  /  15.

We first give the expansion of Fεf up to the fourth order in ε.

We have:

[formula]

where

[formula]

and kR  =  kR2.

We give the proof of this very simple lemma in Appendix [\ref=app_expan]. The O(ε2) correction to the mean velocity uf takes into account the non-local character of the average ([\ref=vfeps]). This correction involves gradients of the local density and flux. They quantify how information spreads due to the fact that the agents observe their environment over a certain spatial extent. Because the observation is supposed isotropic, the correction only involves O(ε2) terms and second order derivatives. In the case of non-isotropic observation kernels, O(ε) corrections involving first order gradients would be obtained. The study of this effect is postponed to future work.

Now, up to terms of order ε4 (which are dropped), equation ([\ref=eq:rescaledkin]) is written:

[formula]

where again, Q is given by ([\ref=E:collisionAlphaZero]). Now, we look for a fluid model approximating ([\ref=E:ourPDE_10]) which includes the O(ε) terms. We will adopt Chapman-Enskog's method consisting in writing the O(ε) terms in terms of spatial derivatives only (see e.g. the review in [\cite=Degond_Birkhauser04]). The model is introduced and discussed in the next section.

Compressible Navier-Stokes equations with self-propulsion

The compressible Navier-Stokes system with self-propulsion is established in the following:

Let fε be the solution of ([\ref=E:ourPDE_10]) associated to a given initial condition fI, which is supposed independent of ε for simplicity. Let (ρfε,ρfεufε) be the moments of fε defined by ([\ref=eq:momf]). Then, we can formally write (ρfε,ρfεufε)  =  (ρε,ρεuε)  +  O(ε2), provided that (ρε,ρεuε) satisfy the following set of compressible Navier-Stokes-like equations (where we drop the superscripts ε upon ρε and uε for the sake of clarity):

[formula]

where

[formula]

The proof of this result is fairly technical. It is given in Appendix [\ref=app_NS_proof]. The coefficient μ is the fluid viscosity, while πε(ρ,u) is a velocity-dependent pressure.

We compare this Navier-Stokes model to the hydrodynamic model ([\ref=E:alpha1]), ([\ref=E:alpha2]) and provide a physical interpretation of the O(ε) correction terms. The mass conservation equation ([\ref=E:alpha1_NS]) is unchanged compared to ([\ref=E:alpha1]), as it should be. Indeed, the particle density is still a conservative variable transported by the fluid velocity. By contrast, there is a wealth of new terms in the momentum balance equation ([\ref=E:alpha2_NS]). We can identify the only term which come from classical fluid viscosity: this is [formula]. The present viscous term is different from that appearing in the full Navier-Stokes system, where the temperature is determined by the energy balance equation. Here, the viscous term involves the symmetrized velocity gradient tensor E(u) instead of the rate of strain tensor [formula]. This difference is solely due to the isothermal character of the model and not to self-propulsion.

Then, there are two terms which come from the non-locality of the interaction and which are proportional to kR. The first one contributes to adding more viscosity and is equal to [formula]. The second one contributes to convecting the velocity in the direction of the gradient of ρ. It is written [formula].

All other O(ε) terms originate from self-propulsion. The self-propulsion first contributes to a similar relaxation source term as in ([\ref=E:alpha2]): the term [formula]. However, both the relaxation rate [formula] and the bulk comfort velocity [formula] towards which this source term is relaxing are different from those of ([\ref=E:alpha2]), respectively equal to [formula] and [formula]. We notice that the former are O(ε) corrections of the latter, as they should be. However, there is a second source term, the term

[formula]

which describes a force comprising three terms. The first term is just a friction proportional to the compressibility [formula]. The second term is a force acting in the direction of the gradient of |u|2. Finally, the last term is a force acting in the direction of [formula].

The self-propulsion force also induces some changes in the convection terms. The first one is a change in the convection velocity of the momentum, which is not just u but λεu. The coefficient λε is close to one but not exactly equal to one, the difference being O(ε). This feature makes the model closer to the generic SOH model ([\ref=eq:SOH_rho]), ([\ref=eq:SOH_omega]), which has different convection velocities c1 and c2 for the density and velocity. The last contribution of the self-propulsion is a modification of the pressure. The isothermal pressure ρT is complemented by an O(ε) pressure correction επ(ρ,|u|) which depends on the norm of the velocity. This correction is positive or negative according to whether the speed is larger or smaller than the bulk comfort velocity [formula] of the non-viscous model.

We now discuss this model in view of the model proposed in [\cite=Toner_Tu_PRL95] [\cite=Toner_etal_AnnPhys05], which is considered as the 'paradigmatic' model of hydrodynamic type for flocking. In this model, the mass conservation equation is the same as ([\ref=E:alpha1_NS]) but the momentum balance equation takes the following form (in the absence of extrernal force):

[formula]

where α, β, DL, D1 and D2 are positive coefficients and P = P(ρ) is the pressure, which depends nonlinearly of ρ. This model has been derived on the basis of invariance considerations. In order to compare our model with ([\ref=eq:vel_TT]), we use the mass conservation equation ([\ref=E:alpha1_NS]) to write the momentum balance equation ([\ref=E:alpha2_NS]) as follows:

[formula]

There is one term in ([\ref=eq:vel_TT]) which is missing from ([\ref=eq:vel_BD]): the anisotropic velocity diffusion [formula]. By contrast, there are many terms appearing in ([\ref=eq:vel_BD]) which are not present in ([\ref=eq:vel_TT]): the third, fourth and fifth terms of the left-hand side and the third and fifth terms of the right-hand side. Additionally, among the terms which are common to both formulas (namely the first and second terms of the left-hand side and the first, second, fourth and sixth terms of the right-hand side of ([\ref=eq:vel_BD])), some of them assume different forms. Indeed, the second term (the convection term [formula]) is multiplied by the constant [formula] less than one in ([\ref=eq:vel_BD]), while this coefficient is exactly one in ([\ref=eq:vel_TT]). This difference is significant, in view of the previous discussion about mass and momentum convection velocities in swarming systems. Another difference is in the pressure term (second term at the right-hand side of ([\ref=eq:vel_BD])). In our model, the pressure depends on both the density and the norm of the velocity, while it depens on the density only in ([\ref=eq:vel_TT]). By contrast, the dependence upon the density is linear in our case, while it is nonlinear in ([\ref=eq:vel_TT]). This discussion illustrates that phenomenological models can differ significantly from first principle models when complex phenomena such as swarming behavior are concerned. The question whether these differences lead to perceivable changes in the qualitative behavior of the solution has not yet been investigated.

The mathematical properties of this system (such as e.g. the stability of this system for small perturbations of a homogeneous state) will be studied in future work. In this work, we investigate the fast relaxation limit τ  →  0. This is the goal of the next section.

The fast relaxation limit in the compressible Navier-Stokes equations with self-propulsion

In this section, we examine the limit τ  →  0 in the Navier-Stokes system ([\ref=E:alpha1_NS]), ([\ref=E:alpha2_NS]). Since this system was derived under the assumption that ε is small, ε needs to tend to 0 at least as fast as τ tends to 0. Here, we decide to make ε and τ proportional. This is the borderline case, because, to be consistent, we should have linked ε and τ in this way already at the kinetic level. However, as pointed out earlier, the analysis of this scaling limit is more complex and is still under scrutiny [\cite=Barbaro_etal_inprep]. Our conjecture is that the kind of model we get is the same in both limits. Therefore, investigating it at the level of the Navier-Stokes system is a preparation before performing the limit directly from the kinetic level.

Since λ is proportional to 1 / τ, we decide to relate ε and λ in such a way that ελ is a constant α, i.e.

[formula]

We need to keep in mind that, strictly speaking, α must be ≪  1 otherwise the derivation of the Navier-Stokes model in the previous section loses its valididty. We decide to express ε as a function of τ. We can write

[formula]

We also define

[formula]

We can introduce an α-dependent critical temperature Tc(α) by:

[formula]

where Tc(0) is the critical temperature ([\ref=eq:Tth]). Then, we can write the square of the comfort velocity in the Navier-Stokes model c1(α) as

[formula]

Since α must be small, we can limit its range in such a way that ξα > 0 and that the relaxation time τα remains positive. Therefore, we have α∈[null]. In this interval, Tc(α) is an increasing function of α with values in

[formula]

P λ · (ρ u u ) - ρ (u · ) u → (λ - ) ρ c(α) (ω · ) ω,

[formula]

Conclusion and perspectives

In this work, we have provided evidence of a phase transition from disordered to ordered motion in a hydrodynamic model of socially interacting agents with self-propulsion. The model we have investigated has been derived from a particle system combining a noisy Cucker-Smale consensus force and self-propulsion. We have shown that the phase transition appears in the limit of a large self-propulsion force and manifests itself as a change of type of the limit model (from hyperbolic to diffusive) at the crossing of a critical noise intensity. We have also shown that, in the hyperbolic regime, the resulting SOH (self-Organized Hydrodynamics) model suffers from unnecessary restrictions on the range of its coefficients. To remove these restrictions, we have computed diffusive correction to the model. With these diffusive corrections, the restrictions on the SOH model obtained in the limit of a large propulsion force disappear.

As pointed out in the core of the work, many points deserve further elucidation. A first one, currently under scrutiny, consists in performing the combined hydrodynamic and large self-propulsion force simultaneously at the level of the kinetic model. We anticipate that similar phase transitions will emerge and will be described by the same limit models, with possibly different coefficients. Other points would be worth being developed. The computation of diffusive corrections to the SOH model for instance would be of great practical use. Further investigations of quantities attached to the social force are also very promising, such as the role of a possible anisotropy of the observation kernels, or of a different scaling of its range. Finally, the understanding of the transition between the two phases and how the two different models can be matched at this transition is also crucial for applications.

Appendix: Properties of the collision operator Q

Proof of Lemma [\ref=lem:Q]: Observe:

[formula]

Then ([\ref=E:collision2]) follows. Formula ([\ref=eq:self]) is a consequence of Green's formula. Now, suppose that f∈  Q, then:

[formula]

This implies that there exists a constant C such that f  =  CMuf. In particular, f is of the form CMu for a given vector [formula]. Reciprocally, let [formula] and C a constant, and construct f  =  CMu. Then

[formula]

Then f  =  CMuf. So, by [\eqref=E:collision2], Q(f)  =  0 and thus [formula]. This ends the proof of Lemma [\ref=lem:Q].

Proof of Proposition [\ref=prop:CI]. We first show that there are d + 1 obvious linearly independent CI's. More precisely, suppose ψ(v) = 1 or ψ(v) = v. Then ψ is a collision invariant. Indeed, clearly, such ψ satisfies that ψ∈Vuf for all f such that f / Muf∈Vuf. The statement that ψ(v)  =  1 is a CI follows from applying ([\ref=eq:self0]) with g = 1. Let now [formula] and consider ψ(v)  =  vk. Then

[formula]

Using Green's Theorem, the first term disappears, and it follows, from the definition of uf, that

[formula]

which shows that ψ(v)  =  vk is also a CI. Thus, C contains a (d + 1)-dimensional linear space, namely [formula]. We now prove that C is identically equal to this space.

Let [formula]. Then, we define the operator R(u;f) as follows:

[formula]

for all f such that f / Mu∈Vu. We notice that for given [formula], R(u;f) is a linear operator with respect to f and that

[formula]

Then, ψ is a CI of Q if and only if

[formula]

or equivalently, if and only if:

[formula]

As a first step, we fix [formula] and find all ψ∈Vu which satisfy:

[formula]

Then, we will make u arbitrary. We note that any constant ψ is a solution of ([\ref=eq:condpsi]).

Saying that uf  =  u is equivalent to saying that [formula]. So ψ defined by ([\ref=eq:condpsi]) is such that the following implication holds:

[formula]

Since both sides of the implication of [\eqref=E:CI1] are linear forms of f, by a standard theorem [\cite=Brezis], there exists [formula] such that

[formula]

Using ([\ref=E:collision_u]) and Green's formula (see ([\ref=eq:self0])), and introducing the change of function g  =  f / Mu, it follows that ψ is a solution of the following problem:

[formula]

with β'u  =    -  βu  /  D. We will drop the primes in the following.

Let φ  =  βu  ·  (v - u). Then, problem ([\ref=eq:var]) for ψ can be equivalently written according to the variational formulation:

[formula]

Since any constant ψ is a solution of ([\ref=eq:condpsi]), we can subtract [formula] from ψ and assume, without loss of generality, that ψ is such that [formula]. Next, we have:

[formula]

by the definition of Mu. Therefore, if g is a constant, we have both (ψ,g)Vu  =  0 (by the definition ([\ref=eq:inner]) of (  ·  ,  ·  )Vu) and (φ,g)Hu  =  0 (by ([\ref=eq:intphi])). Therefore, it is possible to restrict ([\ref=E:VP]) to functions g such that (g,1)Hu = 0. Consequently, we define the following space:

[formula]

and variational formulation ([\ref=E:VP]) can be made precise as follows:

[formula]

The Poincaré inequality for Gaussian measures shows that for all φ∈Vu,

[formula]

Then following from ([\ref=E:grossIneq]), the bilinear form (  ·  ,  ·  )Vu is coercive on [formula]. By the Lax-Milgram theorem, we deduce that there exists a unique [formula] such that ([\ref=E:VP2]) holds. But on the other hand, obvious calculation shows that ψ(v)  =  Tβu  ·  (v - u) is a particular solution. Since it belongs to [formula], it is the only solution of the variational formulation ([\ref=E:VP2]).

Adding any constant, we have just shown that any solution of ([\ref=eq:condpsi]) is of the form ψ(v)  =  α  +  β  ·  v, where [formula] and [formula] are arbitrary. Since this form is independent of u, we deduce that such ψ's are solutions of ([\ref=eq:condpsi]) for all [formula] and are therefore the only CI's. This ends the proof of Proposition [\ref=prop:CI].

Appendix: Expansion of the force term

Proof of Lemma [\ref=lem:expanFf]. By the change of variables y  =  x  -  εR  ξ and Taylor's formula, we have

[formula]

We have used the definition of k and the evenness of K with respect to ξ in order to cancel the odd order terms of the expansion. We have denoted by D2xf the Hessian matrix of f with respect to x (i.e. the matrix of the second order derivatives) and the symbol ':' refers to the contracted product of tensors. In a similar way, we have:

[formula]

Therefore, by expanding the ratio of ([\ref=eq:Kj]) and ([\ref=Krho]) up to the fourth order and in view of ([\ref=vfeps]), we find ([\ref=eq:vfeps2]) with ([\ref=eq:uf1]). Formula ([\ref=eq:Ffeps2]) immediately follows from ([\ref=vfeps]).

Appendix: proof of Theorem [\ref=thm:NS]

Multiplying ([\ref=E:ourPDE_10]) by the collision invariants 1 and v, we are led to the conservation equations (in the same way as in Section [\ref=sec:hydro]):

[formula]

with [formula], [formula], [formula], qε given by ([\ref=eq:rhojSeps]) and ([\ref=eq:qeps]) and

[formula]

(since u1fε does not depend on v). We also note that we can write

[formula]

The Chapman-Enskog expansion consists in closing the expressions of Sε, qε and rε by a first order expansion of fε. To this end, we write the so-called macro-micro decomposition:

[formula]

By the definition of ρε and uε, we have

[formula]

Consequently

[formula]

The first term at the right-hand side of ([\ref=eq:macromicro]) is the macroscopic part, as it is proportional to a local thermodynamical equilibrium and carries all information about the moments of the solution. The second term is the microscopic part. It carries no information about the macroscopic moments but instead carries information about the discrepancy between fε and the local thermodynamical equilibrium. From Section [\ref=sec:hydro], we know that, provided that ρ and u satisfy the Euler equations, the microscopic part is small of order ε. This is why this microscopic part is multiplied by ε in ([\ref=eq:macromicro]). We stress the fact that there is no approximation involved (at this step) in ([\ref=eq:macromicro]): it is a mere definition of fε1.

Inserting ([\ref=eq:macromicro]) into the formulas providing the expressions of the quantities involved in the moment equations ([\ref=E:massConservation_CE]), ([\ref=E:conservationOfMomentum_CE]) (specifically equations ([\ref=eq:Sigmaeps]), ([\ref=eq:qeps]) and ([\ref=eq:reps])), we can write the moment equations as follows:

[formula]

with

[formula]

where we have used Green's formula for Bε1 and ([\ref=eq:uf1]), ([\ref=eq:reps]) for Bε2. Now, in order to compute Bε1 and Bε3, we need to evaluate fε1. But since we only look for O(ε) correction terms, and fε1 is multiplied by ε, we may compute fε1 up to terms of order O(ε).

Inserting ([\ref=eq:macromicro]) into ([\ref=E:collision2]), the collision operator Q can be written:

[formula]

Inserting it in ([\ref=E:ourPDE_10]), we get:

[formula]

But we can neglect all terms of order ε or more in ([\ref=E:ourPDE_11]). Therefore, we are led to the following equation for fε1:

[formula]

where

[formula]

The inversion of ([\ref=E:ourPDE_12]) will give us fε1. Once fε1 is obtained, we insert it into ([\ref=eq:B1])-([\ref=eq:B2]) and this leads us to the expressions of the Navier-Stokes terms. We first compute the right-hand side Rε:

We have (dropping the superscript ε for the sake of clarity):

[formula]

where b(w), c(w) are scalars, e(w), h(w) are tensors and g(w) is a vector, and are given by:

[formula]

By construction, these quantities are dimensionless.

Proof. We use the hydrodynamic equations ([\ref=E:alpha1_CE]), ([\ref=E:alpha2_CE]) (dropping the O(ε) terms), in order to replace the time derivatives by space derivatives in ([\ref=E:ourPDE_13]). This procedure is a classical step of any Chapman-Enskog expansion. For simplicity of notation, we omit the dependencies on ε. Concerning the first two terms of ([\ref=E:ourPDE_13]), we write:

[formula]

Now, using ([\ref=E:alpha1_CE]), ([\ref=E:alpha2_CE]) (dropping the O(ε) terms), we have:

[formula]

Inserting these expressions into the previous ones leads to:

[formula]

For the third term ([\ref=E:ourPDE_13]), we compute

[formula]

Collecting the second term at the right-hand side of ([\ref=terms12]) together with ([\ref=eq:third]) leads to an expression S which we can split in the following way:

[formula]

Collecting this expression with the first term at the right-hand side of ([\ref=terms12]) leads to ([\ref=eq:calR]).

In order to solve equation ([\ref=E:ourPDE_12]) for fε1, we need to solve equations of the type

[formula]

where u is an arbitrary vector of [formula] and g is a given function. We refer the reader to Section [\ref=subsec:CI] for the definitions of the spaces Hu, Vu and [formula]. We state the following lemma, whose proof is identical to that of proposition [\ref=prop:CI] and is left to the reader.

Let g be such that g / Mu∈Hu. Then, equation ([\ref=eq:elliptic]) has a solution if and only if g satisfies the solvability condition

[formula]

Under this condition, problem ([\ref=eq:elliptic]) has a unique solution f such that [formula], or in other words, such that f / Mu∈Vu and satisfies

[formula]

This unique solution f is denoted by f  =  L- 1ug and L- 1u is called the pseudo-inverse of Lu. The set of solutions to equation ([\ref=eq:elliptic]) is given by L- 1ug  +  (Mu). Additionally, if g is such that

[formula]

then, f  =  L- 1ug satisfies

[formula]

Now, we verify that each of the elementary functions b(v - u)Mu, c(v - u)Mu, e(v - u)Mu, h(v - u)Mu and g(v - u)Mu satisfy both ([\ref=eq:solv_g]) and ([\ref=eq:solv_gv]) and therefore, that the corresponding equation ([\ref=eq:elliptic]) is invertible. More precisely, we have:

The functions h(v - u)Mu, b(v - u)Mu, c(v - u)Mu, e(v - u)Mu and g(v - u)Mu satisfy ([\ref=eq:solv_g]) and ([\ref=eq:solv_gv]). We introduce H(v - u)Mu  =   - L- 1u(h(v - u)Mu) and similarly for B, C, E and G. We have:

[formula]

and H(v - u)Mu through G(v - u)Mu satisfy ([\ref=eq:solv_f]) and ([\ref=eq:solv_fv]). Then:

[formula]

Proof. The proof that h(v - u)Mu through g(v - u)Mu satisfy ([\ref=eq:solv_g]) and ([\ref=eq:solv_gv]) easily follows from classical formulas for moments of the Gaussian, which we leave to the reader. Then, we apply Lemma [\ref=lem:inversion_Lu], which gives the existence of L- 1u(h(v - u)Mu) through L- 1u(g(v - u)Mu) and the fact that they satisfy ([\ref=eq:solv_f]) and ([\ref=eq:solv_fv]). Formulas ([\ref=eq:HB]), ([\ref=eq:CEG]) follow from explicitly computing the action of L- 1u and using the uniqueness statement of Lemma [\ref=lem:inversion_Lu]. Finally, equation ([\ref=E:ourPDE_12]) for fε1, which can be written (up to order O(ε) terms) - Lufε1  =  R, can be solved by fε1  =    -  L- 1uR since according to the first equation of ([\ref=eq:macromicro_2]), fε1 satisfies ([\ref=eq:solv_f]). By the linearity of Lu and the decomposition ([\ref=eq:calR]) of R, we can write:

[formula]

Thanks to ([\ref=eq:HB]), ([\ref=eq:CEG]), equation ([\ref=eq:f10_2]) follows.

We are now in a position to calculate B1 and B3 (see ([\ref=eq:B1]), ([\ref=eq:B3])). We state:

We have:

[formula]

with E(u), μ, λ and π(ρ,u) are defined at theorem [\ref=thm:NS] and ν is given by:

[formula]

Proof. We first consider B1. Splitting v into (v - u)  =  u and using ([\ref=eq:macromicro_2]), we have

[formula]

J1 involves an integral of an odd power of v - u and only the g term in fε1 contributes to it. J2 and J3 involve integrals of even powers of v - u and therefore, only the h, b, c and e terms need to be taken into account. The computation of these terms rely on computing moments of the Gaussian which are left to the reader. We find:

[formula]

Now, adding up these three expressions leads to ([\ref=express_B1]).

We now turn our attention to B3. For this purpose, we compute the tensor

[formula]

Since the integral involves an even power of v - u, only the h, b, c and e terms of fε1 need to be taken into account. The computation leads to

[formula]

Inserting this expression into ([\ref=eq:B3]) leads to ([\ref=express_B3]).

Now, by adding the expressions of B1 through B3 found above into ([\ref=E:alpha2_CE]), we find the following momentum equation:

[formula]

Now, the second term at the left-hand side of ([\ref=E:alpha2_NS]) combines the second term at the left-hand side and the last term of the right-hand side of ([\ref=E:alpha2_CE12]); the third term at the left-hand side of ([\ref=E:alpha2_NS]) combines the third term at the left-hand side and the penultimate term of the right-hand side of ([\ref=E:alpha2_CE12]); the first term at the right-hand side of ([\ref=E:alpha2_NS]) combines the first term at the right-hand side and the last term of the second line of ([\ref=E:alpha2_CE12]); and the other terms are unchanged but merely re-ordered. This ends the proof of Theorem [\ref=thm:NS].