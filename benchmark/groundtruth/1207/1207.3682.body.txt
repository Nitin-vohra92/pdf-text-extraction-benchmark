Matching Games with Additive Externalities

Introduction

Matching games are an important theoretical abstraction which have been extensively studied in several fields, including economics, combinatorial optimization, and computer science. Matchings are often used to model markets, and examples include the classical marriage problem, firms and workers, schools and students, hospitals and medical interns [\cite=Burkard09:AssignmentProblems].

Previous matching literature focused primarily on one-to-one and one-to-many models  [\cite=RothSotomayor90:TwoSidedMatchings]. More recently, however, attention has been paid to more complex models of many-to-many matchings due to their relevance to real-world situations. For example, most labour markets involve at least a few many-to-many contracts [\cite=Echenique06:TheoryStability]. More realistic matching models should take into account the fact that in many settings the utility of an agent is influenced not only by their own choices, but also by the choices that other agents make. Such an influence is called an externality. For instance, companies care not only about the employers they hire themselves, but also about the employers hired by other companies. This aspect is crucial to how competitive a company is on the market, and so externalities must be considered to completely understand such situations. Modelling matchings with externalities is computationally challenging, as fully expressive representations require exponential space.

One of the central questions in matching games is stability. There exists a rich literature on the stability of matchings (see, e.g., [\cite=RothSotomayor90:TwoSidedMatchings]) which dates back to the classical stable marriage problem [\cite=GaleShapley62:StabilityOfMarriage]. In the presence of externalities, stability becomes much more complex and challenging phenomenon due to the fact that a deviation of some agents typically affects utilities of the residual agents -- thus, invoking a response from them that can change the worth of the deviation dramatically. This key issue has been heavily studied in the context of coalitional games. Indeed, already in the seminal work of Neumann and Morgenstern (1944) the characteristic function form of a coalitional game was defined using the minimax rule. This definition assumes absolute pessimism of deviators who expect that residual agents hurt them to the maximum possible extent. Since then this idea has been followed by many other authors in the literature on coalitional games (see [\cite=Koczy09:GEB]). This includes also Thrall and Lucas introductory paper on coalitional games with externalities [\cite=Lucas:Thrall63]. On the other hand, Shapley and Shubik, among others, considered a complementary optimistic assumption in which residual agents maximise the deviators' utility [\cite=ShapleyShubik1966]. Between these two extremes a neutral approach assumes no reaction from residual agents [\cite=Koczy07:Recursive].

Our contribution in this paper can be summarized as follows. We formulate a compact model of externalities for matchings, in which the influences of matches on the agents are computed additively. Additive functions are a natural tradeoff between expressivity and computational attractiveness, and have been used in other domains, such as additively separable hedonic games [\cite=Jackson02]. Second, we consider key stability concepts, namely setwise stability in the case of many-to-many matchings and setwise and pairwise stability in the case of one-to-one matchings, under optimistic, neutral and pessimistic reasoning, inspired by the game theoretic literature. We study the computational properties of these stable sets, provide both hardness results and polynomial algorithms where applicable, and show how the sets are related to each other.

The Model

Let [formula] be the set of agents, where [formula] and [formula] are disjoint. A match, (m,w) is an edge between two agents m∈M and w∈W. We let a matching, A, be a set of all matches. If the number of allowable matches any agent can participate in is unrestricted then we say we have a many-to-many matching problem, while if each agent can participate in at most one match then we have a one-to-one matching problem. We assume the formation of a match requires the consent of both parties, while severing a match can be done unilaterally by any of its endpoints. The empty matching contains no matches, while the complete matching contains all the possible matches. A matching game with externalities is defined as follows:

A matching game with externalities is represented as a tuple G  =  (M,W,Π), where (M,W) is the set of agents and Π is a real valued function such that Π(A|z) is the utility of agent z when matching A forms.

The model is related to the assignment game of Shapley and Shubik [\cite=ShapleyShubik1971], in which Π(m,w) represents the monetary gains when m and w are matched, amount which should be distributed among the agents. It is also related to the generalization of the assignment game to include externalities by Sasaki and Toda [\cite=SasakiToda96:MarriageExternalities], in which for each matching A and every (m,w)∈A, the amount Π(m,w|A) represents the gains from matching of the pair (m,w) at A.

The game belongs to the class of non-transferable utility (NTU) games in partition function form, where the valuation of each agent depends on the underlying coalition structure. Thus Definition [\ref=def:matching_game_externalities] gives the most general form of a matching game with externalities when utility is non-transferable. For a more detailed treatment of games in partition function form, we refer the reader to Chalkiadakis et al [\cite=coopbook], Myerson [\cite=Myerson:values_pfg], and Finus [\cite=Finus01]. In addition, there exists an entire literature about externalities in different coalition formation contexts (see, e.g. Bloch [\cite=Bloch96], Ray and Vohra [\cite=RayVohra], Maskin [\cite=Maskin], Michalak et al [\cite=Michalak]).

We are interested in settings where an agent's utility is formed by additive externalities.

A matching game with additive externalities is represented as a tuple G  =  (M,W,Π), where (M,W) is the set of agents and Π is a real valued function such that Π(m,w|z) is the value that agent z receives from the formation of match (m,w). Given a matching A over N, the utility of an agent z in A is: [formula].

Thus, in a matching game with additive externalities, an agent's utility is the sum of values it receives from matches it participates in, along with the sum of all externalities that arise due to the matchings of other agents. The additive representation for matching games with externalities is related to an important succinct representation of hedonic games (see Bogomolnaia and Jackson [\cite=Bogomolnaia], Aziz, Brandt, and Seedig [\cite=Aziz11:OptimalHedonic] [\cite=Aziz11:StableHedonic]). An additively separable hedonic game is represented by a weighted graph such that every node is an agent, and the value of an edge a(i,j) represents the value that agent i receives from j when the two agents are in the same coalition. There has been a recent surge of literature on the complexity of computing stable and optimal outcomes in additively separable hedonic games. However, we are not aware of any study regarding computational aspects of externalities in either matching games or additively separable hedonic games.

We are interested in whether matchings are stable, and whether there exist stable matchings given a particular matching game G. In general, a matching is stable if no subset of agents has any incentive to reorganize and form new matchings amongst themselves. We distinguish between three standard stability concepts which commonly appear in the matching literature. The first, setwise stability, is the most general and encompasses the other two (corewise stability and pairwise stability). Unless otherwise noted, the stability concept used in this paper is setwise stability, which we interchangeably refer to as set stability.

Given a matching game G = (M,W,Π), a matching A of G is setwise stable if there does not exist a set of agents B  ⊆  N, which can improve the utility of at least one member of B while not degrading the others by:

rearranging the matches among themselves

deleting a (possibly empty) subset of the matches with agents in [formula].

If such a coalition B, exists, then it is called a blocking coalition.

Given a matching game G = (M,W,Π), a matching A of G is corewise stable if there does not exist a set of agents B  ⊆  N, which can improve the utility of at least one member of B while not degrading the others by:

rearranging the matches among themselves

deleting all the matches with agents in [formula].

In matching games without externalities, the actions taken by other agents have only a limited effect on an agent - its utility depends solely on who the agent is matched with, and does not depend on matches involving others. However, if there are externalities then this is no longer true. The utility of agent m for example, may depend on the matches involving agent w even if [formula]. Therefore, we argue, the stability concepts need to account for the actions taken by agents in [formula] after a deviation by coalition B, since these actions will effect the final utility of the deviating agents in B. However, it may be hard to compute the possible reactions to a deviation since there are potentially an exponential number (i.e. all possible matchings amongst agents in [formula]). Instead, in this paper we consider several natural heuristics that deviating agents in B can use to reason about, and approximate, the reactions to their possible deviations.

Agents in blocking coalition B may take a neutral perspective. That is, they assume that agents in [formula] will not react to the deviation. All existing matches amongst non-deviating agents will remain and no new matches will form.

Agents in B may take an optimistic attitude and assume that any response to their deviation will be optimal. Such an idea has been studied in the literature in coalitional games [\cite=ShapleyShubik1966] [\cite=Koczy07:Recursive]. In our model, optimism translates to the following. When coalition B considers deviation A' from A, every agent i∈B evaluates the deviation assuming the agents in [formula] will organize themselves in the best possible way for i. That is, i hopes that [formula] will cut any matches with a negative influence on i and form all the matches with a positive influence on i, including initiating those with i as an endpoint. According to i's evaluation, this leads to matching A''. If i improves (or does not degrade) in A'' compared to A, then i agrees to participate in blocking.

Agents in B may take a pessimistic attitude and assume that the agents in [formula] will take actions so as to punish the members of B. That is, the non-deviators will cut matches with a positive influence on the deviators, and will form any new matches with a negative influence on them.

The idea of pessimism has also been studied in the coalitional game theory literature [\cite=Lucas:Thrall63] [\cite=Koczy09:GEB] [\cite=Koczy07:Recursive]. Note that with optimistic and pessimistic attitudes, there may be inconsistencies among the reactions that the members of B expect from [formula], and thus the best or worst possible outcome may not happen for each member of B.

It should be noted that the optimistic and pessimistic cases are in fact the best, and worst, possible reactions to the deviating agents, respectively. As such, these cases represent upper and lower bounds on the impact a reaction would have on the deviating agents. Based on this, we argue that the analysis of those two particular cases is essential when assessing the expected reward/risk associated with the deviation. Such bounds can also be very useful when designing optimization algorithms for matching games with externalities. In fact, the idea of computing bounds on externalities has already proven very useful for general partition function games with positive or negative externalities; this idea provided the corner stone for the currently-state-of-the-art algorithm for coalition structure generation for those games.

It is also important to note that each member of a blocking coalition B is required to perform at least one action, by severing a match with another agent in N, or by forming a new match with another agent in B. More realistic definitions of stability can incorporate different layers of deviators, such as agents who perform the deviation and agents who agree to it without actively participating. However, such definitions can be problematic, and require specifying which agents are identified as deviators and how they should be treated depending on their role. For this reason, in this paper we only consider one type of deviators, those who are required to perform at least one action.

Many-to-Many Matchings

In this section we analyze the stability of many-to-many matchings using the stable set as a solution concept. We provide hardness for computing stable outcomes, an FPT algorithm for the optimistic stable set, and describe the relationship between the stable sets.

Neutral Stability

The neutral set can be empty, as the following example illustrates.

Let M  =  {m}, W =   {w1, w2}, and Π as follows: Π(m,wi|m) =   0, Π(m,wi|wi) =   ε, and Π(m,w1|w2) =   Π(m,w2|w1) =   -  Δ, where Δ  >  ε  >  0. The empty matching is blocked by (m,w1), {(m,w1), (w2)} is blocked by (m,w2), {(m,w2),(w1)} is blocked by (m,w1), and {(m,w1),(m,w2)} is blocked by the empty matching, thus the neutral stable set is empty.

The next game contrasts the case where the empty matching belongs to the neutral stable set with the case where it does not.

Let G  =  (M,W,Π) be such that Π(m,w|m) = Π(m,w|w) =  - ε  <  0 for all m,w, and Π(m,w|z) = δ  >  0 for all z  ≠  m,w. If ε  ≫  δ, the only matching satisfying neutral set stability is the empty matching, since the formation of any match is very expensive for the participating agents and not compensated by the utility obtained from the externalities. Otherwise, if δ  ≫  ε, the grand coalition can block the empty matching through the complete matching, and so the neutral stable set is empty.

For neutral stability we have the following hardness results.

Checking nonemptiness of the neutral stable set is NP-hard.

We provide a reduction from the Knapsack problem. Let I  =  〈U,s,v,B,K〉, where [formula] is a finite set, [formula] the size of element u∈U, [formula] the value of element u∈U, [formula] a size constraint, and [formula] a value goal, such that U'  ⊆  U is a solution if [formula]. We construct a matching game G such that G has a nonempty stable set if and only if I has a solution. Let [formula], [formula], and Π with non-zero entries:

Π(xi,yi|m1)  =    -  s(ui) and Π(xi,yi|m2)  =  v(ui), [formula]

Π(m1,w|m1)  =    -  B

[formula]

Π(xj,w|xj)  =   - 1 and Π(mi,yj|yj)  =   - 1, [formula] and [formula]

Since the instances with [formula] are trivially solvable, we are interested in those cases where [formula], and so Π(m2,w|m2)  ≤  0. If I has a solution U', we claim the following matching belongs to the stable set: [formula]. First note that U' satisfies the knapsack conditions, and so the utilities of the agents in A are: [formula], [formula], and [formula].

All the agents, except possibly for m1 and m2, obtain their best possible utility in A. Thus any blocking coalition, B, would have to contain at least one of m1 and m2. Since blocking requires each member of B to perform an action, it follows that m1, m2 can only be involved in blocking A by forming a new match. Recall that Π(mi,yj|yj)  =   - 1, and so agents yj will never accept a match with either m1 or m2. Thus the only matches that m1 and m2 could form, if deviating, are (m1,w) and (m2,w), respectively.

The best utility that m1 can get when matched with w is attained in A1 =   {(m1,w), (x1), [formula], (xn), (y1), [formula], (yn), (m2)}: u(m1,A1)  =  Π(m1,w|m1)  =   - B  ≤  u(m1,A)  (2), where the candidate for the blocking coalition is B1  =  {m1,w} [formula] [formula].

The best utility that m2 can get when matched with w is attained in A2 =   {(m2,w), (x1,y1), [formula], (xn,yn), (m1)}: [formula] [formula], where the candidate for the blocking coalition is B2 =   {m2,w} [formula] [formula]. From inequalities (2) and (3), m1 and m2 cannot improve by deviating from A. Since the other agents have no incentive to deviate, it follows that A belongs to the stable set.

Conversely, if the stable set of G is non-empty, let A be a stable matching. First note that A must satisfy neutral individual rationality, and so it cannot contain any match with negative value for one of the endpoints. Thus the only non-zero matches that can be included in A are a subset of [formula]. In addition, any matches of the form (xi,yj), with i  ≠  j, can be removed from A without losing stability. Thus without loss of generality, A can be written as in Equation (1) for some U'  ⊆  U. From A stable, coalitions {(m1,w)} and {(m2,w)} are not blocking, thus Inequalities (2) and (3) hold. Equivalently, the knapsack conditions are satisfied, and so U' is a solution.

Checking neutral stable set membership is coNP-complete.

We show that the complementary problem, of deciding whether a matching does not belong to the stable set of a game, is NP-complete. Given matching A, one can nondeterministically guess pair 〈B,A'〉 such that matching A is blocked by coalition B through matching A'. To verify that 〈B,A'〉 is blocking for A, it is sufficient to compute, for each z∈B, its utility in A and A' (assuming that [formula] does not react to the deviation).

To prove hardness, we provide a reduction from Knapsack [\cite=GareyJohnson]. A Knapsack instance has the form I  =  〈U,s,v,B,K〉, where [formula] is a finite set, [formula] the size of element u∈U, [formula] the value of element u∈U, [formula] a size constraint, and [formula] a value goal. Let G  =  (M,W,Π) be a matching game with [formula], [formula], and Π with non-zero entries:

Π(xi,yi|m1)  =   - s(ui), Π(xi,yi|w1)  =  v(ui), [formula]

Π(m2,w2|m1)  =   - B  -  ε and Π(m2,w2|w1)  =  K  -  ε, for some 0  <  ε  <  1

Π(m1,w|w)  =  Π(m,w1|m) =  - 1, for all [formula] and [formula]

Let [formula], with utilities:

u(xi,A)  =  Π(m2,w2|xi)  =  0 and u(yi,A) =   Π(m2, w2|yi)  =  0, [formula]

u(m1,A)  =  Π(m2,w2|m1)  =   - B  -  ε

u(w1,A)  =  Π(m2,w2|w1)  =  K  -  ε

u(m2,A)  =  Π(m2,w2|m2)  =  0, u(w2,A) =   Π(m2,w2|w2)  =  0

All the agents except m1 and w1 obtain their maximum utility in A. In addition, m1 or w1 can only block by forming the match (m1,w1), since all other matches with one of these agents as an endpoint are unfeasible. We claim that I has a solution if and only if A has a blocking coalition. If I has a solution U'  ⊆  U, consider the grand coalition N and matching: [formula] [formula], where xn + 1  =  x1 and yn + 1 = y1. The utilities of the agents in A' are:

u(xi,A')  =  0 and u(yi,A')  =  0, [formula]

[formula]

[formula]

u(m2,A')  =  u(w2,A')  =  0

Thus the grand coalition is blocking under neutrality, since it can form matching A' and (weakly) improve the utilities of all its members by doing so.

Conversely, assume A is blocked by a coalition B through a matching A'. Note that all the agents except m1 and w1, obtain their maximum possible utility in A. Player m1 cannot block without agent w1, since all other matches (m1,w), for w  ≠  w1 are unfeasible; similarly for w1. Thus any blocking coalition must include agents m1,w1 and match (m1,w1). In addition, for one of m1, w1 to strictly improve after the deviation, the edge (m2,w2) must be removed from A'. The conditions for improvement in A' are: [formula] and [formula]. Since v(ui) and s(ui) are integers, Inequalities (4) and (5) are equivalent to [formula] and [formula] v(ui) ≥   K. Thus U'  =  {ui∈U  |  (xi,yi)∈A'} is a solution for the I instance.

Optimistic Stability

For optimistic stability we prove the following theorems.

Checking nonemptiness of the optimistic stable set is NP-complete.

First note that checking nonemptiness of the optimistic setwise-stable set is in NP. Given a matching A, the utility of each agent z∈N in A can be computed in O(n2). In addition, for every pair (m,w)∈(M,W), we can again compute in O(n2) the best case utilities of m and w when matched with each other. Verifying if A is stable can be done by iterating over all pairs (m,w) and checking in O(1) if both m and w can (weakly) improve by deviating under optimism, compared to their current utility in A. The reduction is similar to that in Theorem 1.

A problem is fixed parameter tractable (FPT) with respect to some parameter if there exists an algorithm which given an instance of size n and parameter value k, computes a solution in O(f(k)nO(1)), where f is a computable function. Non-emptiness of the optimistic stable set can be determined in polynomial time by imposing some constraints on the matches. We say that a match (m,w) is feasible controversial if Π(m,w|m)  =  Π(m,w|w) = 0, and there exist distinct agents i1 and i2 such that Π(m,w|i1)  >  0 and Π(m,w|i2)  <  0.

Checking non-emptiness of the optimistic stable set is FPT with respect to the number of feasible controversial matches.

Any matching, A, belonging to the optimistic stable set must include every match in the set: R  =  {(m,w):Π(m,w|m)  ≥  0,Π(m,w|w)  ≥  0, and Π(m,w|m)  +  Π(m,w|w)  >  0} and exclude every match in the set F  =  {(m,w):Π(m,w|m)  <  0 or Π(m,w|w)  <  0}. In addition, it is always safe to exclude matches from the set FN  =  {(m,w):Π(m,w|m)  =  Π(m,w|w)  =  0 and [formula] and the inequality is strict for some z}, and to include the set FP  =  {(m,w):Π(m,w|m)  =  Π(m,w|w)  =  0 and [formula]. Thus if the optimistic stable set is non-empty, it contains a matching with all the matches in R and FP, but none of FN or F. Parameterizing the remaining edges (i.e. feasible controversial), gives an FPT algorithm for checking non-emptiness of the optimistic stable set.

Checking membership to the optimistic stable set is in P.

Let A be a matching which can be blocked by a coalition B through some deviation A'. Assume there exists agent z∈B which can strictly improve the optimistic estimation of utility only by cutting matches in A'. Then z can deviate alone by cutting the same matches as in A' while expecting that the rest of the agents in B will perform deviation A' (including initiating matches with z as an endpoint). Otherwise, any deviator which strictly improves utility forms a new match. Let z be such an agent and (z,z') a new edge in A'. Then coalition {z,z'} can block by forming the edge (z,z'), since both agents z and z' expect that the edges in A' will form after the deviation.

We can characterize optimistic stable sets as follows.

Any matching in the optimistic stable set is a union of two disjoint matchings [formula], where [formula], [formula], and every agent in (M',W') obtains their highest possible utility, while (M'',W'') is the empty matching.

Let A be a matching in the optimistic setwise-stable set and z an agent . Since A is stable, z is not blocking. Thus it must be that z is either unmatched, case in which he cannot deviate, or z is matched but already obtains the highest possible utility, and so has no incentive to deviate. Thus N can be partitioned in two subsets, N', the agents that obtain in A their maximal utility, and N'', the unmatched agents.

Pessimistic Stability

Unlike the neutral stable set, the pessimistic stable set of Example [\ref=eg:paradoxical_matching] is nonempty when δ  ≫  ε. However, the pessimistic stable set can still be empty as can be seen from the following example.

Let G = (M,W,Π) with M  =  {x1, x2, m1, m2}, W  =  {y1, y2, w1, w2}, and Π(x1,y1|m1) =  - 3, Π(x2,y2|m1) =  - 5, Π(x1,y1|m2)  =  2, Π(x2,y2|m2)  =  10, Π(m1,w1|m1)  =   - 4, Π(m2,w2|m2)  =   - 7, and Π(mi,yj|yj)  =   - 1, Π(xi,wj|xi) =  - 1, [formula].

For pessimistic stability we have the following results with respect to the complexity of computing stable outcomes.

Checking nonemptiness of the pessimistic stable set is NP-hard.

Checking pessimistic stable set membership is coNP-complete.

Our results for many-to-many matchings are summarized in Table 1.

Relationship Between the Stability Concepts

In this section we analyze how the stable sets are related to each other. Given a many-to-many matching game G, denote by Oset(G),  Nset(G), and Pset(G) the optimistic, neutral, and pessimistic stable sets.

Given any matching game G, the following inclusions hold O(G)  ⊆  N(G)  ⊆  P(G).

Let B denote a potentially blocking coalition. If a matching belongs to the optimistic set, then B cannot hope to improve even when the rest of the agents organize themselves in the best possible way for B. Thus the optimistic set is included in all the other stable sets. If a matching belongs to the pessimistic set, then B cannot improve when the rest of the society will punish them maximally for the deviation. Under the other stability concepts, B assumes a potentially better reaction from [formula]. Thus if B's deviation is not profitable in the optimistic or neutral scenarios, it is also not profitable in the pessimistic scenario. Hence the pessimistic set contains all the other sets.

One-to-One Matchings

We analyze one-to-one matchings from a neutral, optimistic and pessimistic stand point just as was done with the many-to-many matchings. However, before we proceed we comment on the choice of stability concept used for one-to-one matchings. In particular, in one-to-one matchings, the setwise stable set coincides exactly with the core since agents in a deviating group must necessarily cut all matches with non-members of the deviating group due to the constraint on the number of allowable partners. Thus, while we continue to use the term stable set to mean the setwise stable set, readers more comfortable with the core solution concept can apply it in this section. We also investigate pairwise stability and explicitly state we are looking at pairwise stability when warranted.

Given a matching game G = (M,W,Π) and a matching A, A is pairwise stable if there does not exist a blocking coalition of size one or two.

In the context of one-to-one matchings, a blocking coalition of size one is equivalent to one agent that can improve utility by cutting some (or all) of his matches. A blocking coalition of size two is equivalent to two agents that can form a new match with each other while possibly cutting their previous match (if any), or who can coordinate to cut their existing matches without forming a new match with each other.

Neutral Stability

The hardness results in one-to-one matchings parallel the ones in the many-to-many setting.

Checking neutral stable set membership is coNP-complete.

Checking nonemptiness of the neutral stable set is NP-hard.

We also study pair-wise stability under the neutral assumption. We first note that there is a separation between the neutral pairwise stable set and the neutral setwise stable set.

Let G  =  (M,W, Π), where M  =  {m1,m2}, W  =  {w1,w2}, and Π(mi,wj|mi) =   Π(mi,wj|wj) =   -  ε, Π(mi,wj|z) =   W  ≫  ε  >  0, where [formula], [formula]. The neutral stable set of G is empty, while the "empty" matching is pairwise stable.

While the neutral pairwise stable set may be empty, under certain conditions we can compute such a stable matching in polynomial time.

A neutral pairwise stable matching can be computed in polynomial time when Π is non-negative.

Let A be the matching returned by running the Gale-Shapley algorithm by ignoring externalities, and assume by contradiction A is not stable. Then there exists deviation (m,w'), where m,w are matched in A with w',m', respectively. Let ext(m,A) denote the value obtained by m in A from externalities, and Em(w)  =  Π(m,w|m). From {m,w'} blocking, u(m,A)  =  Π(m,w|m)  +  ext(m,A)  <  Π(m,w'|m)  +  ext(m,A)  -  Π(m',w'|m) and u(w',A) = Π(m',w'|w')  +  ext(w',A)  <  Π(m,w'|w') + ext(w',A) - Π(m,w|w'). Equivalently, (i)  Π(m,w|m)  <  Π(m,w'|m)  -  Π(m',w'|m)  ≤  Π(m,w'|m) and (ii)  Π(m',w'|w')  <  Π(m,w'|w') - Π(m,w|w')  ≤  Π(m,w'|w'). From (i),(ii), Em(w)  <  Em(w') and Ew'(m')  <  Ew'(m), and so (m,w') is blocking under the preferences given by E. Contradiction, since A is stable on (M,W,E).

However, the neutral pairwise-stable set can be empty when Π can have negative entries (Example [\ref=eg:empty_neutral_pairwise]).

Let G  =  (M,W,Π), where M  =  {m1,m2}, W  =  {w1,w2}, and Π as follows: Π(mi,wj|mi)  =  Π(mi,wj|wj)  =  1, for all i,j∈{1,2}, and Π(mi,wj|z)  =   - 1, for all i,j∈{1,2} and z  ≠  mi,wj. All the edges have positive values for their endpoints, and so the only candidates for neutral pairwise stability are: A1  =  {(m1,w1),(m2,w2)} and A2  =  {(m1,w2),(m2,w1)}. However, matching A1 is blocked by the pair (m1,w2), and A2 is blocked by (m1,w1).

Optimistic Stability

Checking nonemptiness of the optimistic stable set is NP-complete, even when Π is non-negative.

First note that similarly to the optimistic setwise-stable set, checking nonemptiness of the optimistic stable set is in NP. Given a matching A, the utility of each agent z∈N in A can be computed in O(n2). In addition, for every pair (m,w)∈(M,W), we can again compute in O(n2) the best case utilities of m and w when matched with each other. Verifying if A is stable can be done by iterating over all pairs (m,w) and checking in O(1) if both m and w can (weakly) improve by deviating under optimism, compared to their current utility in A. The same reduction as in Theorem 1 applies, by noting that the weights are constructed such that any feasible matching (from the perspective of the xi and yi agents) is one-to-one.

For the next theorem, we consider the weak optimistic stable set. Weak stability requires that all members of a blocking coalition strictly improve their utility in order for the deviation to take place.

The optimistic pair-wise stable set is equivalent to the weak optimistic stable set.

Let A be a one-to-one matching. We show that if A has a blocking coalition B under optimism, then there exists a blocking singleton or pair. We consider two cases. If there exists z∈B which improves strictly in A' only by severing a match. Then agent z can deviate alone, by simply cutting the same match as in A', and expecting (optimistically) that the rest of the agents will react as in A'. Otherwise, there exists z∈B which improves strictly by forming a new match, say (z,z'), and possibly severing an existing match. Then coalition {z,z'} is blocking. Thus if A does not belong to the weak optimistic stable set, it is also not pairwise stable under optimism. The reverse direction is clear, and so the optimistic pairwise stable set is equivalent to the weak optimistic stable set.

Checking nonemptimess of the optimistic pairwise set is NP-complete, even when Π  ≥  0.

Pessimistic Stability

For pessimistic stability, we obtain similar results to the ones for neutrality, and in addition, we consider a relaxation of pairwise stability which is well-defined for non-negative Π.

Checking pessimistic stable set membership is coNP-complete.

Checking nonemptiness of the pessimistic stable set is NP-hard.

Pessimistic pairwise stable matchings can be computed in polynomial time when Π  ≥  0.

A pessimistic pairwise stable set can be computed in polynomial time when Π is non-negative.

A neutral pairwise stable matching can be computed in polynomial time when Π  ≥  0, and any matching satisfying neutral pairwise stability also satisfies pessimistic pairwise stability.

In one-to-one matchings with non-negative Π, we also consider a restricted notion of pessimism. Namely, any matching containing singletons (unmatched agents) can weakly improve everyone's utility by pairing the singletons with each other. Based on this observation, the pessimistic deviators can have a less extreme attitude, and assume that while the rest of the agents may punish them for the deviation, they will not stay unmatched in order to do so. In other words, a blocking coalition, B, assumes that the agents in [formula] form the worst possible matching for B, among all the matchings of size [formula].

A restricted pessimistic pairwise stable matching can be computed in polynomial time.

Let A be the matching returned by Algorithm 1 and assume by contradiction A is unstable under pessimistic pairwise stability. Then there exists deviating pair (m,w'), where m,w are matched in A with m',w', respectively. Then it must be the case that for any possible matching A'(m,w') that includes the pair (m,w'), both m and w' are better off in A'(m,w') than in A. Equivalently, E-m(w')  >  u(m,A)  ≥  E-m(w) and E-w'(m)  >  u(w',A)  ≥  E-w'(m'). However, A is stable under E-, and so for any [formula], either E-m(w')  ≤  E-m(w') or E-w'(m')  ≤  E-w'(m), contradiction. Thus A is stable.

Our results for one-to-one matchings are summarized in Table 2 and Table 3.

Related Work

Klaus et al [\cite=KlausWalzl09:StableManyToManyContracts] consider pairwise and setwise stability, with the weak and strong variants, in many-to-many matching markets. Echenique et al [\cite=Echenique06:TheoryStability] study several solution concepts, such as the setwise-stable set, the core, and the bargaining set in many-to-many matchings. These models do not consider externalities or the boundedness of the agents as they use exponential preference profiles. Externalities in the classical marriage problem have been introduced by Sasaki and Toda [\cite=SasakiToda96:MarriageExternalities], and in one-to-many models by Dutta and Masso [\cite=DuttaMasso97:MatchingsPreferencesColleagues], both for complete preference profiles. Hafalir [\cite=hafalir08] studied externalities in marriage problems, Weighted preferences have been introduced in matchings by Pini et al. [\cite=WalshWeighted], in which the agents rank each other using a numerical value. However, they study solution concepts different from ours, such as α-stability and link-additive stability, and do not consider externalities.

Discussion

In this work we introduced a compact model for matching problems with externalities. In many-to-many matchings, we considered neutral, optimistic, and pessimistic reasoning under the setwise-stable set solution concept. In one-to-one matchings, we considered neutral, optimistic, and pessimistic reasoning under the setwise-stable set and pairwise stability solution concepts. In both the many-to-many and one-to-one settings, we studied the computational complexity of finding stable outcomes and provided both hardness results and polynomial algorithms.

This work can be extended in several ways. A coherent theory of stability for matchings with externalities remains to be further developed. The existing work on the stability of matchings assumes complete preference profiles, which require exponential space and reasoning abilities on behalf of the agents. Such modelling is not realistic when dealing with bounded rational agents. Furthermore, externalities are important in many other domains, including network formation games. Effects due to externalities are known to appear in networks [\cite=Jackson08:SocialEconomicNetworks], however we are not aware of a theory of stability for network formation games that explicitly accounts for externalities. Since such games involve very large number of agents, a compact model of externalities is crucial.

Acknowledgements

Simina Brânzei was supported in part by the Sino-Danish Center for the Theory of Interactive Computation, funded by the Danish National Research Foundation and the National Science Foundation of China (under the grant 61061130540) and by the Center for research in the Foundations of Electronic Markets (CFEM), supported by the Danish Strategic Research Council.

Appendix

Checking nonemptiness of the pessimistic stable set is NP-hard.

The same reduction as in Theorem 1 applies, by noting that a coalition is blocking for the constructed matching under pessimistic reasoning if and only if it is blocking under neutral reasoning.

Checking pessimistic setwise-stable set membership is coNP-complete.

The reduction from Theorem 2 applies, by noting that in matching A of Theorem 2, a coalition is blocking under neutral reasoning if and only if it is blocking under pessimistic reasoning.

Checking neutral stable set membership is coNP-complete.

The same reduction as in Theorem 2 applies, by noting that the weights are set such that any feasible matching (from the perspective of the xi and yi agents) is one-to-one. In other words, a coalition can block the matching constructed in Theorem 2 if and only if it is a one-to-one matching.

Checking nonemptiness of the neutral stable set is NP-hard.

The same reduction as in Theorem 1 applies, by noting that the weights are set up such that any feasible matching (from the perspective of the xi and yi agents) is one-to-one, and so a matching of the game in Theorem 1 is stable if and only if it is a one-to-one matching.

Checking pessimistic stable set membership is coNP-complete.

The reduction is similar to that of Theorem 1, except for the addition of several dummy agents to ensure that the grand coalition can always block in the one-to-one setting when the Knapsack instance has a solution. Given I  =  〈U,s,v,B,K〉, let G  =  (M,W,Π) such that [formula], [formula], and Π with non-zero entries:

Π(xi,yi|m1)  =  Π(xi,yn + i|m1)  =   - s(ui) and Π(xi,yi|w)  =  Π(xi,yn + i|w)  =  v(ui), [formula]

Π(m1,w|m1)  =    -  B

[formula]

Π(xj,w|xj)  =   - 1 and Π(mi,yj|yj)  =   - 1, [formula] and [formula]

Let matching [formula], (y1),[formula]. Similarly to Theorem 1, A belongs to the pessimistic stable set if and only if the Knapsack instance has a solution.

Checking nonemptiness of the pessimistic stable set is NP-hard.

The same reduction as in Theorem 1 applies, by noting that the weights are set up such that any feasible matching (from the perspective of the xi and yi agents) is one-to-one, and so a matching of the game in Theorem 1 is stable if and only if it is a one-to-one matching.