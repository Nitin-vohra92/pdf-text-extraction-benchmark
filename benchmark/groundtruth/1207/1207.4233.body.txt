Lyndon words and Fibonacci numbers

Keywords: Lyndon word, Fibonacci word, Central word, Golden ratio, Sturmian word, Periodicity

Introduction

Lyndon words are primitive words that are the lexicographically smallest words in their conjugacy classes [\cite=Lothaire1997]. Originally defined in the context of free Lie algebras [\cite=CheFoxLyn1958], Lyndon words have shown to be a useful tool for a variety of problems in combinatorics ranging from the construction of de Bruijn sequences [\cite=FreMai1978] to proving the optimal lower bound for the size of uniform unavoidable sets [\cite=ChaHanPer2004]. One of the fundamental properties of Lyndon words is their recursive nature: if w is a non-letter Lyndon word, then there exist two shorter Lyndon words u and v such that w  =  uv [\cite=CheFoxLyn1958]. This implies that the number of different Lyndon factors of w is bounded below by [formula], but a little experimentation shows that this is hardly optimal. One of the results of this paper, Corollary [\ref=ti_17-07-2012:1504], is that a much better lower bound is [formula], where φ denotes the golden ratio [formula]. Here the base of the logarithm is optimal, because the Fibonacci Lyndon words attain the lower bound. This follows from Theorem [\ref=ti_10-07-2012:1247], in which we show that if w is a Lyndon word with [formula], where Fn is the [formula] Fibonacci number, then the number of distinct Lyndon factors in w is at least n with equality if and only if w equals one of the two Fibonacci Lyndon words of length Fn, up to renaming letters.

It also makes sense to count the number of Lyndon factors of infinite words, but here we have to use caution: if an infinite word is aperiodic, it will have infinitely many Lyndon factors, as we will show in Corollary [\ref=100620121216]. Thus we define a mapping [formula] for which [formula] is the number of distinct Lyndon words of length at most n occurring in a given infinite word [formula]. Of special importance is the Fibonacci infinite word [formula]. Our first main result in this setting, Theorem [\ref=020720120123], is that if [formula] is aperiodic, then [formula]. As Lyndon words are unbordered, this is an improvement of a classic result by Ehrenfeucht and Silberger [\cite=EhrSil1979] stating only that an aperiodic infinite word must have arbitrarily long unbordered factors. If we confine our realm to recurrent infinite words, then the above result can be improved as follows. In Theorem [\ref=060720122147] we show that a recurrent infinite word [formula] is aperiodic if and only if [formula] with equality if and only if [formula] is in the shift orbit closure of the Fibonacci word [formula], up to renaming letters.

Fibonacci words are sort of a universal optimality prover in that they possess a wide range of extremal properties, see e.g. [\cite=Cassaigne2008] [\cite=CroRyt1995] [\cite=DieHarNow2010] [\cite=MigResSal1998] [\cite=GatFlo2012]. The problem of the enumeration of Lyndon factors in automatic and linearly recurrent sequences has recently been studied in [\cite=GocSaaSha2012].

Preliminaries

In this section we establish the notation of this paper and present some preliminary results. We assume the reader is familiar with the usual terminology of words and languages as given in [\cite=AllSha2003] or [\cite=Lothaire2002].

Let [formula] be a finite, nonsingular alphabet totally ordered by <  ; thus every pair of distinct letters [formula] satisfy either [formula] or [formula], but not both. We use the same symbol '<  ' to denote the usual order relation among the integers, but this should not cause problems as the context always tells which order is meant. In what follows, we sometimes assume that [formula], sometimes [formula], and then their mutual order is implicitly assumed to be their "natural order," so that ø  <  ı and [formula].

The set of all finite words over [formula] is denoted by [formula] and the set of finite words excluding the empty word ε is denoted by [formula].

Let [formula] be a nonempty finite word with [formula] and n  ≥  1. The length of w is [formula]; we denote the cardinality of a set X by #  X. The reversal of w is the word [formula]. If wR  =  w, then w is a palindrome. The word w has period p  ≥  1 if ai + p  =  ai for all [formula]. According to this definition, any integer p  ≥  n is a period of w. If p  ≤  n, then p is a period of w if and only if there exist words [formula] such that w  =  xy  =  zx and [formula]. If w has no periods smaller than [formula], then it is called unbordered, otherwise w is bordered. Suppose that w  =  pfs with [formula]. Then p,f,s are called a prefix, factor, and suffix of w, respectively. In addition, p and s are proper prefix and suffix if they do not equal w. We say that a word [formula] is a periodic extension of w if z is a prefix of a word in w+. We abuse the word "extension" here in that we allow an "extension" to be a prefix of w. The word we get from w by deleting its last letter is denoted by [formula]; thus [formula]. Also if w  =  xy for some words x,y, we denote x- 1w  =  y and wy- 1  =  x. The word w is primitive if it cannot be written in the form w  =  uk for a word [formula] and an integer [formula]. If w  =  uv, then the word vu is called a conjugate of w. The set of all conjugates of w is called the conjugacy class of w.

Let [formula] be a word with periods p,q.

If [formula], then the prefix and suffix of w of length [formula] have periods q and p - q.

Let u and v be the prefix and suffix of w of length q, respectively. Then uw and wv have periods q and p + q.

In the property (ii) in the previous lemma, the indicated source [\cite=CasMigRes1999] only mentions and proves the claim for the periods of uw, but the case for the periods of wv can be proved similarly.

If a word [formula] has periods p and q, and

[formula]

then w has period [formula].

It is well-known that the above lemma is optimal. That is to say, if neither of p and q equals gcd (p,q), then there exists a word [formula] of length [formula] that has periods p and q, but does not have a period [formula]. Following [\cite=Lothaire2002], we call a word [formula] a central word over [formula] if there exist two coprime integers p,q such that [formula] and both p and q are periods of z. Equivalently, z is a central word over [formula] if either [formula] or there exist two coprime integers p,q  ≥  2 such that [formula], both p and q are periods of z, but z does not have period gcd (p,q)  =  1, that is, both letters [formula] and [formula] occur in z. These words are also known as extremal Fine and Wilf words [\cite=TijZam2009]. They are palindromes and unique up to renaming letters [\cite=Lothaire2002] [\cite=TijZam2009]. The latter fact implies that there are exactly two central words over [formula] with given periods p and q; if one is z, then the other one is c(z), where c is the morphism [formula], [formula].

Recall that the Fibonacci numbers are defined recursively as F0  =  0, F1  =  1, and Fn  =  Fn - 1  +  Fn - 2 for [formula], and that every two consecutive Fibonacci numbers are coprime. The two central words over [formula] for periods Fn - 2 and Fn - 1 can be obtained by means of finite Fibonacci words as follows. Let [formula] be distinct letters. Then define [formula], [formula], and

[formula]

We call the words fn finite Fibonacci words over [formula]. Note that we could also have defined [formula] and [formula]. This makes a difference in our considerations, and we will make this distinction when it matters. Let pn denote the word for which fn  =  pnxy with [formula] and [formula]. Thus

[formula]

Note that [formula] and thus [formula]. It can be shown that if n  ≥  5, then pn has periods Fn - 2 and Fn - 1, but it does not have period gcd (Fn - 2,Fn - 1)  =  1. Thus each pn is a central word over [formula]. The other central word with the same periods is c(pn), where c is the morphism [formula] and [formula]. We will give some further properties of the Fibonacci words in Lemmas [\ref=ma_16-07-2012:1521] and [\ref=ma_16-07-2012:1209], but let us stress here that a word over [formula] that is of length Fn - 2  ≥  2 is one of pn or c(pn) if and only if it has periods Fn - 1 and Fn - 2 but does not have period 1.

The order <   of [formula] is extended to [formula] as follows: For [formula] we have

[formula]

This is called the lexicographic ordering of [formula] with respect to <  .

A nonempty, primitive word [formula] is called a Lyndon word if it is the smallest word in its conjugacy class. In particular, letters are Lyndon words, but the empty word is not. For example, the Lyndon words [formula] with [formula] are

[formula]

If [formula] is a central word over [formula] and [formula], then [formula] is a Lyndon word.

According to Lemma [\ref=140720121241], the words [formula] and [formula] are Lyndon words; we call them Fibonacci Lyndon words of length Fn over [formula]. The first few ones are

[formula]

Here the upper row corresponds to words [formula] and the lower row to words [formula].

The properties of Lyndon words given in the next lemma are well-known [\cite=Lothaire1997] [\cite=Duval1983].

Lyndon words have the following properties.

Lyndon words are unbordered.

A word w is Lyndon if and only if w  <  y for all nonempty proper suffixes y of w.

If u and v are Lyndon words and u < v, then uv is a Lyndon word.

Let [formula] be a Lyndon word. Suppose that [formula] is a periodic extension of w for some [formula] and [formula] with [formula]. Then [formula] is a Lyndon word.

There exist an integer n  ≥  0 and words [formula] such that [formula] and z  =  wnx. We show that [formula] is a Lyndon word; this suffices because then Lemma [\ref=070820102200] implies that [formula] is a Lyndon word since [formula].

Contrary to what we want to show, suppose that [formula] is not a Lyndon word. Then Lemma [\ref=070820102200] implies that [formula] has a nonempty suffix v such that [formula]. Write [formula]. Then [formula] is a suffix of w, so that [formula] because w is a Lyndon word. Therefore [formula] implies that [formula] is not a prefix of w and thus not a prefix of x. Consequently [formula] implies that we can write v  =  tt' and [formula] for some words [formula] and letters [formula] with   <  . Since [formula], the word t is a prefix of x and thus a prefix of w. But then

[formula]

a contradiction. Thus [formula] is a Lyndon word, and the proof is complete.

Let [formula] be a Lyndon word with [formula]. Let λw be the longest proper prefix of w that is also a Lyndon word. Then [formula] is a periodic extension of λw. Furthermore, the word μw: = λ- 1ww is a Lyndon word.

Suppose that [formula] is not a periodic extension of λw. Then there exist a word u and different letters [formula] such that [formula] is a prefix of λw and [formula] is a prefix of [formula] for some integer k  ≥  1. If [formula], then [formula] is a Lyndon word by Lemma [\ref=100620121631], contradicting the maximality of [formula]. If [formula], then (λkw)- 1w  <  w because (λkw)- 1w begins with [formula] while w begins with [formula]. Thus w has a nonempty suffix that is smaller than w, contradicting Lemma [\ref=070820102200] because w is Lyndon. Therefore [formula] is a periodic extension of λw, and consequently there exist [formula] and letters [formula] such that [formula] is a prefix of λw and [formula] for some integer k  ≥  1. Furthermore, we must have [formula] because otherwise [formula], which is impossible because w is a Lyndon word and [formula] its suffix. Now [formula] is a Lyndon word by Lemma [\ref=100620121631].

Due to its importance in the upcoming considerations, let us restate Lemma [\ref=pe_15-06-2012:0726]: every non-letter Lyndon word [formula] can be written as w  =  λwμw, where λw and μw are Lyndon words and [formula] is a periodic extension of λw.

An infinite word is a sequence [formula] where [formula]. The set of infinite words over [formula] is denoted by [formula]. A tail of the infinite word [formula] is another infinite word [formula] such that [formula] for some [formula]. An infinite word is purely periodic if [formula] for some finite word [formula]; we also denote this by [formula]. The word [formula] is ultimately periodic if it has a purely periodic tail. Finally, [formula] is aperiodic if it is not ultimately periodic. A factor of [formula] is a finite word that occurs somewhere in [formula]. The set of all factors of [formula] is denoted by [formula]. The word [formula] is called recurrent if each of its factors occurs at least twice (and thus infinitely many times) in [formula]. If an infinite word is ultimately periodic and recurrent, then it can be shown to be purely periodic. The shift orbit closure of [formula] is the set of all infinite words [formula] such that [formula].

Let fn be the finite Fibonacci words over [formula] defined above with [formula] and [formula]. If [formula], then fn is a prefix of fn + 1. Thus there exists a unique infinite word [formula] such that fn is a prefix of [formula] for every n  ≥  2. The word [formula] is called a Fibonacci infinite word over [formula]. Note that there is another Fibonacci infinite word over [formula], which results from defining [formula] and [formula]. When we want to stress the definition of f1 and f2 when constructing [formula], we denote [formula]. The Fibonacci infinite words are easily seen to be recurrent, and it can be shown that they are even uniformly recurrent, which means that if w is a factor of [formula], then there exists an integer N  ≥  1 such that every factor of [formula] of length [formula] has a factor w. This implies that [formula] is in the shift orbit closure of [formula] if and only if [formula].

Let fn denote the Fibonacci words, pn the corresponding central words, and [formula].

The words pn are palindromes [\cite=deLuca1981].

The Lyndon factors of [formula] are precisely the Lyndon conjugates of fn [\cite=CurSaa2009].

If w is a conjugate of fn, then its reversal wR is a conjugate of fn [\cite=WenWen1994].

Let [formula] be a Fibonacci word for which [formula]. Write fn  =  pnxy with [formula] and suppose that [formula]. Then the Lyndon conjugate of fn is the word [formula] for all [formula]. Furthermore, every Lyndon factor of [formula] that is shorter than [formula] is either a prefix or a suffix of [formula].

First off, the word [formula] is a Lyndon word by Lemma [\ref=140720121241]. Thus the first claim is proved by showing that [formula] is a conjugate of fn. This is clear if [formula], so assume that [formula] instead. Then [formula] is a conjugate of fn. Since the reversal of a conjugate of fn is a conjugate of fn and since pn is a palindrome by Lemma [\ref=ma_16-07-2012:1521], it follows that [formula] is a conjugate of fn.

Next we show that if k  <  n, then the Lyndon conjugate of fk is a prefix or a suffix of [formula]. Since [formula], the claim is plainly true for k = 1,2. Furthermore, if [formula], then the Lyndon conjugate of f3, which is [formula], is a suffix of [formula]; and if [formula], then the Lyndon conjugate of f3 is a prefix of [formula]. Thus we may suppose that k  ≥  4. Then k  <  n implies that fk is a prefix of pn. Furthermore, since pn is a palindrome, the reversal fRk is a suffix of pn. Therefore if [formula], then its Lyndon conjugate [formula] is a prefix of [formula]; and if [formula], then its Lyndon conjugate [formula] is a suffix of [formula].

Lyndon factors of Lyndon words

Let [formula] be a Lyndon word. We denote the number of distinct Lyndon factors of w by [formula]. A trivial but useful observation is that if [formula], then

[formula]

where λw and μw are the Lyndon words provided by Lemma [\ref=pe_15-06-2012:0726]. If [formula], let pw denote the word such that [formula] for some letters [formula].

If [formula] is a Fibonacci Lyndon word of length Fn with n  ≥  3, then [formula].

The word w is the Lyndon conjugate of fn (for some choice of [formula]). Each of the Lyndon conjugates of fk with 1  ≤  k  ≤  n are either prefixes or suffixes of w by Lemma [\ref=ma_16-07-2012:1209], and these are the only Lyndon factors of w by Lemma [\ref=ma_16-07-2012:1521]. Thus [formula].

Let [formula] be a Lyndon word with [formula] for [formula] and let [formula] be the letters such that [formula]. Then w is a Fibonacci Lyndon word over [formula] of length Fn if and only if [formula] has period Fn - 1 and [formula] has period Fn - 2, or vice versa.

The claim is readily verified for n  ≤  4, so assume that n > 4.

Suppose first that w is a Fibonacci Lyndon word over [formula] of length Fn. Since n  ≥  5, the word pw  =  pn does not have period gcd (Fn - 2,Fn - 1)  =  1, but it has periods Fn - 2 and Fn - 1. We claim that the word [formula] has period Fn - 2 or Fn - 1. Indeed, if pw did not have either period, then [formula] would have both periods, contradicting Lemma [\ref=020720122145] because [formula] and [formula] does not have period 1. An analogous argument shows that [formula] must have period either Fn - 2 or Fn - 1. Finally, [formula] and [formula] cannot have the same period Fn - 2 or Fn - 1 because otherwise w would have the same period, which it does not since it is unbordered by Lemma [\ref=070820102200].

Conversely, suppose that [formula] has period Fn - 1 and [formula] has period Fn - 2, or vice versa. Then since n  ≥  5, we have [formula]. This implies that both [formula] and [formula] occur in pw, and thus gcd (Fn - 1,Fn - 2)  =  1 is not a period of pw. Since pw does have periods Fn - 2 and Fn - 1 and length ≥  Fn  -  2, it follows that actually [formula] and that pw is a central word. Thus w is a Fibonacci Lyndon word over [formula] of length Fn.

Let [formula] be a Lyndon word with [formula] for some n  ≥  3. Then we have [formula]. Furthermore if [formula], then w is a Fibonacci Lyndon word of length Fn.

Using the fact that letters are Lyndon words and that w is a product of two shorter Lyndon words, the reader readily verifies the claim for n  ≤  4. Hence we assume inductively that n  ≥  5 and the claim holds for all values < n. Since w is a Lyndon word, we have [formula] for some letters [formula] with [formula]. We split the proof in several cases depending on the length of λw.

Case (i). Suppose that [formula]. Since n - 1  ≥  4, we may apply the induction assumption to λw, which gives that [formula], and so

[formula]

Case (ii). Suppose that [formula]. Then [formula], and we have three subcases:

Case (ii-a). If μw is not a factor of λw, then the induction assumption implies

[formula]

Case (ii-b). Suppose that μw is a factor but not a suffix of λw. Then by denoting the longest Lyndon prefix of λw by λλw, we have [formula] because [formula] is a periodic extension of λλw by Lemma [\ref=pe_15-06-2012:0726] and μw is unbordered by Lemma [\ref=070820102200]. Therefore [formula]. Since n - 2  ≥  3, we may apply the induction assumption to λλw, obtaining

[formula]

where the last inequality is equality only if [formula]. This would imply that λλw and μw are conjugates, which would further imply that λλw  =  μw because both are Lyndon words. But then μw is both a prefix and a suffix of w, contradicting the fact that w is unbordered. Hence the third inequality in [\eqref=150620122237] is strict.

Case (ii-c). Suppose that μw is a suffix of λw. Then it is a suffix of [formula] because μw cannot equal λw. Since [formula], the induction assumption gives

[formula]

If [formula], we are done, so assume [formula]; then [formula]. We will show that [formula] has period Fn - 1 and [formula] period Fn - 2, which means that w is a Fibonacci Lyndon word by Lemma [\ref=la140720121644].

First, the word [formula] has period [formula] because [formula] is a periodic extension of λw by Lemma [\ref=pe_15-06-2012:0726]. Second, since [formula] and [formula], the induction assumption implies that λw is a Fibonacci Lyndon word and therefore Lemma [\ref=pe_15-06-2012:0726] implies that [formula] has period either Fn - 3 or Fn - 2. The period cannot be Fn - 3, however, because the unbordered word μw is a suffix of [formula] and [formula]. Thus [formula] has period Fn - 2, and furthermore [formula]. Now the fact that μw is a suffix of [formula] with [formula] and that [formula] has period Fn - 2 imply that [formula] has period Fn - 2 by Lemma [\ref=080720121124].

Case (iii). Suppose that [formula]. Then [formula] gives [formula], so λw is not a factor of μw. Furthermore, since n - 2  ≥  3, the induction assumption gives

[formula]

Case (iv). Suppose that [formula]. Then [formula] and thus μw is not a factor of λw because otherwise μw  =  λw and w would be bordered. Noting that [formula] because [formula], we therefore have by induction

[formula]

Case (v). Suppose that [formula]. Then [formula], and so μw is not a factor of λw. Since we also have n  -  2  ≥  3, the induction assumption gives

[formula]

Case (vi). Suppose that [formula]. Then [formula], so the induction assumption gives

[formula]

If [formula], we are done, so assume [formula]. Our goal is to show that [formula] has period Fn - 2 and [formula] has period Fn - 1, which means that w is a Fibonacci Lyndon word by Lemma [\ref=la140720121644]. The first objective is easy because [formula] is a periodic extension of λw by Lemma [\ref=pe_15-06-2012:0726], and thus [formula] has period [formula].

For the second objective, we take care of a special case first. If n = 5, then [formula], so that [formula]. Then [formula] because [formula] is a periodic extension of λw by Lemma [\ref=pe_15-06-2012:0726]. Consequently [formula] has period F4, as claimed. We may thus assume that n  ≥  6.

Now, note that since [formula] in Eq. [\eqref=150620122235], we have [formula]. Since also [formula], the induction assumption says that actually [formula] and that μw is a Fibonacci Lyndon word. Thus Lemma [\ref=pe_15-06-2012:0726] implies that one of [formula] and [formula] has period Fn - 3 and the other one has period Fn - 2. Since [formula] is a periodic extension of λw and [formula], we see that λw is a prefix of [formula]. Therefore [formula] cannot have period Fn - 3 because [formula] and λw is unbordered. Hence [formula] has period Fn - 2 and [formula] has period Fn - 3. Since n  ≥  6, we have [formula], and consequently since [formula] and pw has period Fn - 2 (because [formula] has period Fn - 2), it follows that [formula] is a prefix of pμw. Since pμw has periods Fn - 3 and Fn - 2, Lemma [\ref=080720121124] implies that pw has periods Fn - 2 and Fn - 2  +  Fn - 3  =  Fn - 1. Now, as we have reasoned before, [formula] must have period either Fn - 2 or Fn - 1 for otherwise [formula] would have both periods contradicting Lemma [\ref=020720122145]. Since [formula] has period Fn - 2 and w is unbordered, we conclude that [formula] must have period Fn - 1.

Case (vii). Suppose that [formula]. Then [formula], so that the induction assumption implies

[formula]

Let [formula] be a Lyndon word with [formula] for some n  ≥  3. Then [formula] with equality if and only if w is a Fibonacci Lyndon word of length Fn.

The claim is obtained by combining Lemmas [\ref=020720122029] and [\ref=160620121145].

Recall that φ denotes the golden ratio [formula].

If [formula] is a Lyndon word, then [formula] with equality if w is a Fibonacci Lyndon word.

The claim is trivial if [formula], so suppose that [formula], and let [formula] be the unique integer for which [formula].

It is well-known [\cite=Knuth] that φm - 1  <  Fm + 1  <  φm for all m  ≥  2, and this implies [formula]. Therefore, if w is a Fibonacci Lyndon word, then [formula] and [formula] by Theorem [\ref=ti_10-07-2012:1247]. If w is not a Fibonacci Lyndon word, then on the one hand, we have [formula] by Theorem [\ref=ti_10-07-2012:1247]. On the other hand, we have

[formula]

Combining these two inequalities gives [formula].

A noteworthy feature of Theorem [\ref=ti_10-07-2012:1247] is that the optimal words, the Fibonacci Lyndon words, are made of just two different letters. A priori it may seem "obvious" that this should always be the case for a Lyndon word having the smallest possible number of Lyndon factors, but this, in fact, is not true. For example, each Lyndon word of length 6 has at least 7 Lyndon factors. In this case the Lyndon words with the smallest number of Lyndon factors are, up to renaming the letters,

[formula]

three of which are made of three different letters. However, see Conjecture [\ref=020720121320].

Let us denote

[formula]

for all [formula]. We conjecture that if w is a Lyndon word with [formula] and [formula], then w is a Sturmian Lyndon word, i.e., we have [formula], [formula], and pw is a central word.

Lyndon factors of recurrent words

Our main goal in this section is to prove Theorem [\ref=060720122147], which gives a characterization for aperiodicity of recurrent words by means of its Lyndon factors using the Fibonacci infinite word. We begin with a few results that are interesting in their own right.

Every infinite word [formula] admits a unique factorization of the form either

[formula]

where each [formula] is a finite Lyndon word with wi  ≥  wi + 1 and [formula] begins with arbitrarily long Lyndon words.

Let [formula] be an infinite word. Then at least one of the following holds:

[formula] is ultimately periodic;

[formula] has a tail that begins with arbitrarily long Lyndon words;

[formula], where each [formula] is a Lyndon word and, for every [formula], there exists an index ik such that [formula] for all i  >  ik.

Let us suppose that [formula] is aperiodic and that it does not have a tail beginning with arbitrarily long Lyndon words; we will show that then [formula] satisfies property (iii). Let [formula]. Lemma [\ref=060720121742] implies that [formula] admits a factorization [formula] in which the [formula] are Lyndon words and wi  ≥  wi + 1. Denote [formula]; this word exists because our alphabet [formula] is finite. Observe that if wi  >  wi + 1, then wi  ≠  wj for all j  >  i. Furthermore, since [formula] is aperiodic, the sequence of words wi is not ultimately constant. Consequently, there exists an index

[formula]

Then [formula] whenever i  >  ik. Indeed, if i  >  ik, then the inequality wik  ≥  wi and the maximality of ik imply wik  >  wi. Because of the minimality of wik, we thus have [formula].

If an infinite word [formula] has only finitely many distinct Lyndon factors, then it is ultimately periodic.

If [formula] satisfies property (ii) or (iii) in Lemma [\ref=070720121709], then it clearly has infinitely many Lyndon factors. Thus [formula] satisfies property (i) and is ultimately periodic.

The sleek proof of Corollary [\ref=100620121216] was suggested by Tero Harju. The author's original proof was more intricate.

Recall that we denote the set of factors of an infinite word [formula] by [formula]. In what follows, we also denote the set of Lyndon factors of [formula] by [formula]. (Don't confuse this with the symbol [formula] defined in Section [\ref=to_15-11-2012_14:27_winnipeg].)

If [formula] and [formula] are recurrent infinite words and [formula], then [formula].

Suppose first that [formula] is ultimately periodic. Then, in fact, it is purely periodic because it is recurrent. Writing [formula], where u is a primitive word, it follows that [formula] has only one Lyndon factor of length [formula] --the Lyndon conjugate of u-- and none longer than [formula]. Thus [formula] has only finitely many Lyndon factors, so it is ultimately periodic by Corollary [\ref=100620121216], and hence purely periodic because it is recurrent. Write [formula] with v primitive. Since the Lyndon conjugate of u is a factor of [formula] and the Lyndon conjugate of v is a factor of [formula], it follows that v and u are conjugates, and thus [formula].

Suppose then that [formula] is aperiodic. We show that every [formula] is a factor of a Lyndon factor of [formula]. Since [formula] must be aperiodic as well, the analogous property clearly holds for [formula], implying that [formula]. If [formula] satisfies property (ii) of Lemma [\ref=070720121709], then some tail [formula] of [formula] begins with arbitrarily long Lyndon words. Since [formula] is recurrent, it follows that u is a factor of a Lyndon prefix of [formula]. Thus suppose that [formula] satisfies property (iii) of Lemma [\ref=070720121709]. Since [formula] is recurrent, there exists a word v such that [formula]. Let [formula] and let ik be the index provided by Lemma [\ref=070720121709]. Since [formula] is recurrent, the word uvu occurs in [formula]. Since [formula] for each j  ≥  1, it follows that u necessarily occurs in some wik  +  j.

For an infinite word [formula], we define a mapping [formula] such that [formula] is the number of Lyndon factors of [formula] of length at most n. Notice that the mapping [formula] is increasing, but not necessarily strictly increasing, as can be seen from Lemma [\ref=su_15-07-2012:2022]. Notice also that [formula] determines the number of Lyndon factors of any length k  ≥  1. Indeed, it it given by the expression [formula] for k  ≥  2.

Let [formula] be a Fibonacci infinite word. Then for all [formula], we have [formula], where k  ≥  2 is the unique integer such that Fk  ≤  n  <  Fk + 1.

Lemma [\ref=ma_16-07-2012:1209] implies that the Lyndon factors in [formula] are precisely the Lyndon conjugates of the finite Fibonacci words fk. Therefore if Fk  ≤  n  <  Fk + 1, the Lyndon factors of length at most n are the Lyndon conjugates of f1, f2, , fk, so that [formula].

If [formula] is aperiodic, then [formula].

Since [formula] is increasing, Lemma [\ref=su_15-07-2012:2022] implies that it suffices to show that [formula] for all k  ≥  2. This is clear for k = 2 because [formula] is aperiodic. Thus assume [formula], and let w be a shortest Lyndon factor of of length >  Fk; Corollary [\ref=100620121216] ensures that such a word w exists because [formula] is aperiodic. Theorem [\ref=ti_10-07-2012:1247] implies that [formula]. Since w is as short as possible, all of its proper Lyndon factors are of length at most Fk. Therefore

[formula]

A classic result by Ehrenfeucht and Silberger [\cite=EhrSil1979] states that if an infinite word has only finitely many unbordered factors, then it is ultimately periodic. Since Lyndon words are unbordered, Theorem [\ref=020720120123] is a quantitative formulation of this with an exact lower bound for the necessary number of unbordered factors.

Looking at Theorem [\ref=020720120123], one might be tempted to postulate that if [formula] is aperiodic, then for all n  ≥  1, the number of length-n Lyndon factors of [formula] must be at least as large as the number of length-n Lyndon factors of a Fibonacci infinite word, but this is not true. For example, let [formula] is the Fibonacci infinite word over [formula] with [formula] and [formula], and let [formula], where g is the morphism [formula], [formula]. Then it is easy to see that [formula] does not have any Lyndon factors of length 5, while [formula] has a Lyndon factor [formula].

Let [formula] be recurrent. Then [formula] is aperiodic if and only if [formula] with equality if and only if [formula] is in the shift orbit closure of a Fibonacci infinite word [formula].

We start by proving the first equivalence. Suppose [formula] is ultimately periodic. Then it is purely periodic because it is recurrent. Thus [formula] is ultimately constant, so [formula] for all sufficiently large n. Conversely, if [formula] for some n  ≥  1, then Theorem [\ref=020720120123] implies that [formula] is ultimately periodic.

Let us next prove the second equivalence. If [formula] is in the shift orbit closure of [formula], then [formula] because [formula] is uniformly recurrent. Therefore the identity [formula] holds. Let us prove the converse, and suppose that [formula] for some Fibonacci infinite word [formula]. Then in particular, [formula], so that [formula] consists of two distinct letters, say [formula] and [formula] with [formula]. Since [formula], exactly one of [formula] and [formula] occurs in [formula]. If [formula] is in [formula], we may assume that [formula] is the Fibonacci word with [formula] and [formula], so that [formula]. Similarly, if [formula] is in [formula], we may assume that [formula] is the Fibonacci word with [formula] and [formula], so that [formula]. Then a Lyndon word of length at most 3 is a factor of [formula] if and only if it is a factor of [formula]. We will show next that [formula]; then Theorem [\ref=060720122059] implies that [formula] because both [formula] and [formula] are recurrent.

If [formula], then the identity [formula] implies that there exist an integer k and distinct Lyndon words w,z with [formula] such that w is a factor of [formula] and z is a factor of [formula]. Let us assume that k is as small as possible. Since the Lyndon factors of length at most 3 in [formula] and [formula] coincide, we have [formula], and thus k  ≥  5. Recall that w can be written as w  =  λwμw where λw and μw are Lyndon words by Lemma [\ref=pe_15-06-2012:0726]. Furthermore, each of [formula] and [formula] is a Fibonacci number, and therefore [formula] yields [formula]. The same reasoning shows that z  =  λzμz and [formula]. But since [formula], we have [formula], which means that [formula] because the set of Lyndon factors of [formula] of length less than Fk coincides with the set of Lyndon factors of [formula] of length less than Fk and there is precisely one Lyndon factor of length Fk - 2 and precisely one Lyndon factor of length Fk - 1. Consequently, z is a product of λw and μw. However, if z  =  λwμw, then z  =  w, and if z = μwλw, then z is not a Lyndon word because it is a proper conjugate of the Lyndon word λwμw  =  w, both of which are contradictions.

Theorem [\ref=060720122147] shows that the shift orbit closure of a Fibonacci infinite word [formula] is characterized by the mapping [formula], up to renaming letters. But in general, the mapping [formula] does not characterize a recurrent word [formula]. For example, the identity [formula] holds for the two periodic words [formula] and [formula], but clearly [formula] and [formula], where c is the morphism ø  ↦  ı, ı  ↦  ø.

Acknowledgement

I thank Tero Harju for several useful discussions and for bringing the result of Siromoney et al. to my attention.