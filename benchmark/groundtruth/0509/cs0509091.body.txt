Lemma Corollary Proposition Conjecture Problem Remark Example

Minimum Cost Homomorphisms to Semicomplete Multipartite Digraphs

Arash Rafiey

Anders Yeo

Introduction

In our terminology and notation, we follow [\cite=bang2000]. In this paper, directed (undirected) graphs have no parallel arcs (edges) or loops. The vertex (arc) set of a digraph G is denoted by V(G) (A(G)). The vertex (edge) set of an undirected graph G is denoted by V(G) (E(G)). A digraph D obtained from a complete k-partite (undirected) graph G by replacing every edge xy of G with arc xy, arc yx, or both xy and yx, is called a semicomplete k-partite digraph (or, semicomplete multipartite digraph when k is immaterial). The partite sets of D are the partite sets of G. A semicomplete k-partite digraph D is semicomplete if each partite set of D consists of a unique vertex. A k-partite tournament is a semicomplete k-partite digraph with no directed cycle of length 2. Semicomplete k-partite digraphs and its subclasses mentioned above are well-studied in graph theory and algorithms, see, e.g., [\cite=bang2000].

For excellent introductions to homomorphisms in directed and undirected graphs, see [\cite=hell2003] [\cite=hell2004]. For digraphs D and H, a mapping f: V(D)V(H) is a homomorphism of D to H if uv∈A(D) implies f(u)f(v)∈A(H). A homomorphism f of D to H is also called an H-coloring of G, and f(x) is called a color of x for every x∈V(D). We denote the set of all homomorphisms from D to H by HOM(D,H).

For a fixed digraph H, the homomorphism problem HOMP(H) is to verify whether, for an input digraph D, there is a homomorphism of D to H (i.e., whether [formula]). The problem HOMP(H) has been studied for several families of directed and undirected graphs H, see, e.g., [\cite=hell2003] [\cite=hell2004]. The well-known result of Hell and Neetil [\cite=hellJCT48] asserts that HOMP(H) for undirected graphs is polynomial time solvable if H is bipartite and it is NP-complete, otherwise. Such a dichotomy classification for all digraphs is unknown and only partial classifications have been obtained; see [\cite=hell2004]. For example, Bang-Jensen, Hell and MacGillivray [\cite=bangSIAMJDM1] showed that HOMP(H) for semicomplete digraphs H is polynomial time solvable if H has at most one cycle and HOMP(H) is NP-complete, otherwise.

The authors of [\cite=gutinDAM] introduced an optimization problem on H-colorings for undirected graphs H, MinHOMP(H) (defined below). The problem is motivated by a problem in defence logistics. In our previous paper [\cite=gutinsd], we obtained a dichotomy classification for the time complexity of MinHOMP(H) for H being a semicomplete digraph. In this paper, we extend that classification to obtain a dichotomy classification for semicomplete k-partite digraphs H, k  ≥  3. We also obtain a classification of the complexity of MinHOMP(H) when H is a bipartite tournament. The case of arbitrary semicomplete bipartite digraphs appears to be significantly more complicated (see the last paragraph of Section [\ref=btsec]). Our main approach to proving polynomial time solvability and NP-hardness of special cases of MinHOMP(H) is the use of various reductions to/from the maximum weight independent set problem.

Suppose we are given a pair of digraphs D,H and a positive integral cost ci(u) for each u∈V(D) and i∈V(H). The cost of a homomorphism f of D to H is [formula]. For a fixed digraph H, the minimum cost homomorphism problem MinHOMP(H) is formulated as follows. For an input digraph D and costs ci(u) for each u∈V(D) and i∈V(H), verify whether [formula] and, if [formula], find a homomorphism in HOM(D,H) of minimum cost. The maximum cost homomorphism problem MaxHOMP(H) is the same problem as MinHOMP(H), but instead of minimization we consider maximization. Let M be an integral constant larger than any cost ci(u), u∈V(D), i∈V(H). Then the cost c'i(u) = M - ci(u) is positive for each u∈V(D), i∈V(H). Due to this transformation, the problems MinHOMP(H) and MaxHOMP(H) are equivalent.

For a digraph G, if xy∈A(G), we say that x dominates y and y is dominated by x (denoted by xy). The outdegee d+G(x) ( indegree d-G(x)) of a vertex x in G is the number of vertices dominated by x (that dominate x). For sets X,Y  ⊂  V(G), XY means that xy for each x∈X, y∈Y, but no vertex of Y dominates a vertex in X. A set X  ⊆  V(G) is independent if no vertex in X dominates a vertex in X. A k- cycle, denoted by [formula], is a directed simple cycle with k vertices. A digraph H is an extension of a digraph D if H can be obtained from D by replacing every vertex x of D with a set Sx of independent vertices such that if xy∈A(D) then uv∈A(H) for each u∈Sx, v∈Sy. For subsets X,Y of V(G), X  ×  Y = {xy:x∈X, y∈Y}.

The underlying graph U(G) of a digraph G is the undirected graph obtained from G by disregarding all orientations and deleting one edge in each pair of parallel edges. A digraph G is connected if U(G) is connected. The components of G are the subdigraphs of G induced by the vertices of components of U(G). A digraph G is strongly connected if there is a path from x to y for every ordered pair of vertices x,y∈V(G). A strong component of G is a maximal induced strongly connected subdigraph of G. A digraph G' is the dual of a digraph G if G' is obtained from G by changing orientations of all arcs.

The rest of the paper is organized as follows. In Section [\ref=homsec], we give all polynomial time solvable cases of MinHOMP(H) when H is semicomplete k-partite digraph, k  ≥  3, or a bipartite tournament. Section [\ref=smdsec] is devoted to a full dichotomy classification of the time complexity of MinHOMP(H) when H is a semicomplete k-partite digraph, k  ≥  3. A classification of the same problem for H being a bipartite tournament is proved in Section [\ref=btsec].

Polynomial Time Solvable Cases

The following definitions and theorem were given in [\cite=gutinsd]. The homomorphic product of digraphs D and H is an undirected graph [formula] defined as follows: [formula], [formula] Let μ  =   max {cj(v): v∈V(D), j∈V(H)}. We define the cost of ui, c(ui) = ci(u) + μ|V(D)|. For a set [formula], we define [formula]

Let D and H be digraphs. Then there is a homomorphism of D to H if and only if the number of vertices in a largest independent set of [formula] equals |V(D)|. If [formula], then a homomorphism h∈HOM(D,H) is of maximum cost if and only if I = {xh(x): x∈V(D)} is an independent set of maximum cost.

Let TTk denote the acyclic tournament on k vertices. In [\cite=gutinsd] we used Theorem [\ref=maint] in order to prove the following result:

MWHOMP(TTk) and MCHOMP(TTk) are polynomial time solvable.

Here we prove another, somewhat more involved, corollary of Theorem [\ref=maint]. A digraph D is transitive if xy,yz∈A(D) implies xz∈A(D) for all pairs xy,yz of arcs in D. A digraph D is the transitive closure of a digraph H if V(D) = V(H) and D is has the minimum number of arcs with respect to the following properties: D is transitive and A(H)  ⊆  A(D). It is easy to see the uniqueness of the transitive close of a digraph [\cite=bang2000]. A graph is a comparability graph if it has an orientation, which is transitive. Let k  ≥  3 and let TT-k be a digraph obtained from TTk by deleting the arc from the source to the sink.

MWHOMP(TT-k) and MCHOMP(TT-k) are polynomial time solvable.

Proof: Let [formula] and let A(TT-k) = {ij: 1  ≤  i < j  ≤  k j - i < k - 1}. Observe that [formula] unless D is acyclic. Since we can verify that D is acyclic in polynomial time (for example, by deleting vertices of indegree 0), we may assume that D is acyclic. We will furthermore assume that D has no isolated vertices as these can be assigned an optimal color greedily. Let S = {s: d-D(s) = 0} and let T = {t: d+D(t) = 0}. Let P(x,y) denote the set of paths from a vertex x to a vertex y in D. Let D' be a digraph obtained from D by adding the following set of arcs:

[formula]

Note that D' is the transitive closure of D, where we delete all arcs from S to T which are not present in D. One can find D' in polynomial time using the depth first search or breadth first search [\cite=cormen2001]. If h∈HOM(D,TT-k) and xy∈A(D') - A(D) then [formula] or [formula], which implies that [formula] or [formula], which again implies that h(x)h(y)∈A(TT-k). This implies that HOM(D,TT-k) = HOM(D',TT-k).

Observe that for every TT-k-coloring h of D and each [formula], we have h(s) < k, h(t) > 1 and 1 < h(z) < k. Consider

[formula]

By Theorem [\ref=maint] and the above observations, [formula] if and only if the number of vertices in a largest independent set of G equals |V(D)|. Moreover, a homomorphism h∈HOM(D',TT-k) is of maximum cost if and only if I = {xh(x): x∈V(D)} is an independent set of maximum cost.

If we prove that G is a comparability graph, we will be able to find a largest independent set in G and an independent set of G of maximum cost in polynomial time [\cite=grotschelADM21] [\cite=kagarisI27]. So, it remains to find an orientation of G, which is a transitive digraph.

Define an orientation G* of G as follows: [formula], where

[formula]

Let uivj,vjwl∈A(G*). We will prove that uiwl∈A(G*). Consider three cases covering all possibilities without loss of generality.

Case 1: u = v = w. Since uiuj,ujul∈A2, we have i > j > l and uiul∈A2.

Case 2: u = v  ≠  w. Then uiuj∈A2, ujwl∈A1 and, thus, i > j  ≥  l and uw∈A(D') implying uiwl∈A1.

Case 3: |{u,v,w}| = 3. Since uivj,vjwl∈A1, we have uv,vw∈A(D') and thus uw∈A(D'). Also, i  ≥  j  ≥  l. We conclude that uiwl∈A1. [formula]

Suppose that MinHOMP(H) is polynomial time solvable then, for each extension H' of H, MinHOMP(H') is also polynomial time solvable.

Proof: Recall that we can obtain H' from H by replacing every vertex i∈V(H) with a set Si of independent vertices. Consider an H'-coloring h' of an input digraph D. We can reduce h' into an H-coloring of D as follows: if h'(u)∈Si, then h(u) = i.

Let u∈V(D). Assign min {cj(u): j∈Si} to be a new cost ci(u) for each i∈V(H). Observe that we can find an optimal H-coloring h of D with the new costs in polynomial time and transform h into an optimal H'-coloring of D with the original costs using the obvious inverse of the reduction described above.[formula]

In [\cite=gutinsd], we proved that MinHOMP(H) is polynomial time solvable when [formula], k  ≥  2. Combining this results with Theorems [\ref=tt], [\ref=tt-] and Lemma [\ref=lemext], we immediately obtain the following:

If H is an extension of TTk, [formula] or TT-k (k  ≥  3), then MinHOMP(H) and MaxHOMP(H) are polynomial time solvable.

Let H be an acyclic bipartite tournament. Then MinHOMP(H) and MaxHOMP(H) are polynomial time solvable.

Proof: A pair of vertices in H is called similar if they have the same set of out-neighbors and the same set of in-neighbors; H is simple if it has no similar vertices. Let V1,V2 be the partite sets of H, let D be an input digraph and let ci(x) be the costs, i∈V(H), x∈V(D). Observe that if D is not bipartite, then [formula], so we may assume that D is bipartite. We can check whether D is bipartite in polynomial time using, e.g., the breadth first search [\cite=cormen2001]. Let U1,U2 be the partite sets of D.

To prove that we can find a minimum cost H-coloring of D in polynomial time, it suffices to show that we can find a minimum cost H-coloring f of D such that f(U1) = V1 and f(U2) = V2. Indeed, if D is connected, to find a minimum cost H-coloring of D we can choose from a minimum cost H-coloring f with f(U1) = V1 and f(U2) = V2 and a minimum cost H-coloring h of D with h(U1) = V2 and h(U2) = V1. If D is not connected, we can find a minimum cost H-coloring of each component of D separately.

To force f(U1) = V1 and f(U2) = V2 for each H-coloring f, it suffices to modify the costs such that it is too expensive to assign any color from Vj to a vertex in U3 - j, j = 1,2. Let M = |V(D)|  ·   max {ci(x): i∈V(H), x∈V(D)} + 1 and let ci(x): = ci(x) + M for each pair x∈Uj, i∈V3 - j, j = 1,2.

We consider the following two cases.

Case 1: H is simple. Observe that the vertices of H can be labeled [formula] such that ik is the only vertex of in-degree zero in [formula] Thus, H is a spanning subdigraph of TTp with vertices [formula] (isit∈A(TTp) if and only if s < t). Observe that

[formula]

Thus, to solve MinHOMP(H) with the modified costs it suffices to solve MinHOMP(TTp) with the same costs. We can solve the latter in polynomial time by Theorem [\ref=tt].

Case 2: H is not simple. Then H is an extension of an acyclic simple bipartite tournament. Thus, we are done by Case 1 and Lemma [\ref=lemext].[formula]

Classification for semicomplete k-partite digraphs, k  ≥  3

The following lemma allows us to prove that MaxHOMP(H) and MinHOMP(H) are NP-hard when MaxHOMP(H') and MinHOMP(H') are NP-hard for an induced subdigraph H' of H.

[\cite=gutinsd] Let H' be an induced subdigraph of a digraph H. If MaxHOMP(H') is NP-hard, then MaxHOMP(H) is also NP-hard.

The following lemma is the NP-hardness part of the main result in [\cite=gutinsd].

Let H be a semicomplete digraph containing a cycle and let [formula]. Then MinHOMP(H) and MaxHOMP(H) are NP-hard.

The following lemma was proved in [\cite=gutjahr1991].

Let H1 be a digraph obtained from [formula] by adding an extra vertex dominated by two vertices of the cycle and let H be H1 or its dual. Then HOMP(H) is NP-complete.

We need two more lemmas for our classification.

Let H' be given by V(H') = {1,2,3,4}, A(H') = {12,23,34,14,24} and let H be H' or its dual. Then MaxHOMP(H) and MinHOMP(H) are NP-hard.

Proof: We reduce the maximum independence set problem (MISP) to MinHOMP(H). Let G be an arbitrary graph. We construct a digraph D from G as follows: every vertex of G belongs to D and, for each pair x,y of non-adjacent vertices of G, we add to D new vertices u = u(x,y) and v = v(x,y) together with arcs ux,uv,vy. (No edge of G is in D.) Let n be the number of vertices in D. Let x,y be a non-adjacent pair of vertices in G and let u = u(x,y), v = v(x,y). We set c3(x) = c3(y) = ci(u) = ci(v) = 1 for i = 1,2,3, c4(x) = c4(y) = n + 1 and cj(x) = cj(y) = c4(u) = c4(v) = n2 + n + 1 for j = 1,2.

Consider a minimum cost H-coloring h of D. Let x,y be a pair of non-adjacent vertices in G and let u,v be the vertices added to D due to x,y such that ux,uv,vy are arcs of D. Due to the values of the costs, h can assign x,y only colors 3 and 4 and u,v only colors 1,2,3. The coloring can assign u either 1 or 2. If u is assigned 1, then v,y,x must be assigned 2,3 and 4, respectively. If u is assigned 2, then v,y,x must be assigned 3,4 and (3 or 4), respectively. In both cases, only one of the vertices x and y can receive color 3. Since h is optimal, the maximum number of vertices in D that it inherited from G must be assigned color 3. This number is the maximum number of independent vertices in G. Since MISP is NP-hard, so is MinHOMP(H).[formula]

Let H be given by V(H) = {1,2,3,4}, A(H) = {12,23,31,34,41}. Then MaxHOMP(H) and MinHOMP(H) are NP-hard.

Proof: We will reduce the maximum independent set problem to MinHOMP(H). However before we do this we consider a digraph Dgadget(u,v) defined as follows: [formula] and

[formula]

Observe that in any homomorphism f of Dgadget(u,v) to H we must have f(c1) = 1, by the existence of x and y. This implies that [formula] has to coincide with one of the following two sequences:

[formula]

If the first sequence is the actual one, then we have f(c6) = 3, f(u')∈{1,4}, f(u)∈{1,2},f(c11) = 2, f(v') = 3 and f(v)∈{1,4}. If the second sequence is the actual one, then we have f(c6) = 2, f(u') = 3, f(u)∈{1,4},f(c11) = 3, f(v')∈{1,4} and f(v)∈{1,2}. So in both cases we can assign both of u and v color 1. Furthermore by choosing the right sequence we can color one of u and v with color 2 and the other with color 1. However we cannot assign color 2 to both u and v in a homomorphism.

Let G be a graph. Construct a digraph D as follows. Start with V(D) = V(G) and, for each edge uv∈E(G), add a distinct copy of Dgadget(u,v) to D. Note that the vertices in V(G) form an independent set in D and that |V(D)| = |V(G)| + 16|E(G)|.

Let all costs ci(t) = 1 for t∈V(D) apart from c1(p) = 2 for all p∈V(G). Clearly, a minimum cost H-coloring h of D must aim at assigning as many vertices of V(G) in D a color different from 1. However, if pq is an edge in G, by the arguments above, h cannot assign colors different from 1 to both p and q. However, h can assign colors different from 1 to either p or q (or neither). Thus, a minimum cost homomorphism of D to H corresponds to a maximum independent set in G and vise versa (the vertices of a maximum independent set are assigned color 2 and all other vertices in V(G) are assigned color 1). [formula]

Let H be a semicomplete k-partite digraph, k  ≥  3. If H is an extension of TTk, [formula] or TT-p (p  ≥  4), then MinHOMP(H) and MaxHOMP(H) are polynomial time solvable. Otherwise, MinHOMP(H) and MaxHOMP(H) are NP-hard.

Proof: We assume that P≠  NP as otherwise this theorem is of no interest. Since H is a semicomplete k-partite digraph, k  ≥  3, if H has a cycle, then there can be three possibilities for the length of a shortest cycle in H: 2,3 or 4. Thus, we consider four cases, the above three cases and the case when H is acyclic.

Case 1: H has a 2-cycle C. Let i,j be vertices of C. The vertices i,j together with a vertex from a partite set different from those where i,j belong to form a semicomplete digraph with a 2-cycle. Thus, by Lemmas [\ref=red] and [\ref=sd], MinHOMP(H) and MaxHOMP(H) are NP-hard.

Case 2: A shortest cycle C of H has three vertices i,j,l (ij,jl,li∈A(C)). If H has at least four partite sets, then MinHOMP(H) and MaxHOMP(H) can be shown be be NP-hard similarly to Case 1. Assume that H has three partite sets and that MinHOMP(H) and MaxHOMP(H) are polynomial time solvable. Let V1, V2 and V3 be partite sets of H such that i∈V1, j∈V2 and l∈V3. Let s be a vertex outside C and let s∈V1. If s is dominated by j and l or dominates j and l, then MinHOMP(H) and MaxHOMP(H) are NP-hard by Lemmas [\ref=red] and [\ref=cycle++], a contradiction. If jsk, then MinHOMP(H) and MaxHOMP(H) are NP-hard by Lemmas [\ref=red] and [\ref=cycle+++], a contradiction. Thus, ksj. Similar arguments show that kV1j. Let p∈V2  -  {j}. Similar arguments show that pV1j and moreover V3V1j. Again, similarly we can prove that V3V1V2, i.e., H is an extension of [formula].

Case 3: A shortest cycle C of H has four vertices i,j,s,t (ijsti). Since C is a shortest cycle, i,s are belong to the same partite set, say V1, and j,t belong to the same partite set, say V2. Since H is not bipartite, there is a vertex l belonging to a partite set different from V1 and V2. Since H has no cycle of length 2 or 3, either l dominates V(C) or V(C) dominates l. Consider the first case (lV(C)) as the second one can be tackled similarly. Let H' is the subdigraph of H induced by the vertices l,i,j,s. Observe now that MinHOMP(H) and MaxHOMP(H) are NP-hard by Lemmas [\ref=red] and [\ref=ac].

Case 4: H has no cycle. Assume that MinHOMP(H) and MaxHOMP(H) are polynomial time solvable, but H is not an extension of an acyclic tournament. The last assumption implies that there is a pair of nonadjacent vertices i,j and a distinct vertex l such that ilj. Let s be vertex belonging to a partite set different from the partite sets where i and l belong to. Without loss of generality, assume that at least two vertices in the set {i,j,l} dominate s. If all three vertices dominate s, then by Lemmas [\ref=red] and [\ref=ac], MinHOMP(H) and MaxHOMP(H) are NP-hard, a contradiction. Since H is acyclic, we conclude that {i,l}sj. Let V1 be the partite set of i and j. Similar arguments show that for each vertex t∈V(H) - V1, itj. By considering a vertex p∈V1  -  {i,j} and using arguments similar to the once applied above, we can show that either p(V(H) - V1) or (V(H) - V1)p. This implies that we can partition V1 into V1' and V1'' such that V1'(V(H) - V1)V2''. This structure of H implies that there is no pair a,b of nonadjacent vertices in V(D) - V1 such that acb for some vertex c∈V(H). Thus, the subdigraph H - V1 is an extension of an acyclic tournament and, therefore, H is an extension of TT-k.[formula]

Classification for bipartite tournaments

The following lemma can be proved similarly to Lemma [\ref=cycle++].

Let H1 be given by V(H1) = {1,2,3,4,5}, A(H1) = {12,23,34,41,15,35} and let H be H1 or its dual. Then MaxHOMP(H) and MinHOMP(H) are NP-hard.

Now we can obtain a dichotomy classification for MaxHOMP(H) and MinHOMP(H) when H is a bipartite tournament.

Let H be a bipartite tournament. If H is acyclic or an extension of a 4-cycle, then MinHOMP(H) and MaxHOMP(H) are polynomial time solvable. Otherwise, MinHOMP(H) and MaxHOMP(H) are NP-hard.

Proof: If H is an acyclic bipartite tournament or an extension of a 4-cycle, then MinHOMP(H) is polynomial time solvable by Theorems [\ref=bt] and [\ref=poly]. We may thus assume that H has a cycle C, but H is not an extension of a cycle. We have to prove that MinHOMP(H) and MaxHOMP(H) are NP-hard.

Let C be a shortest cycle of H. Since H is a bipartite tournament, we note that |V(C)| = 4, so assume without loss of generality that C = w1w2w3w4w1, where w1,w3 belong to a partite set V1 of H and w2,w4 belong to the other partite set V2 of H.

Observe that any vertex in V1 must dominate either w2 or w4 and must be dominated by the other vertex in {w2,w4}, as otherwise we are done by Lemmas [\ref=cycleBT] and [\ref=red]. Analogously any vertex in V2 must dominate exactly one of the vertices in {w1,w3}. Therefore, we may partition the vertices in H into the following four sets.

[formula]

If q2q1∈A(H), where qj∈Wj for j = 1,2 then we are done by Lemma [\ref=cycleBT] (consider the cycle q1w2w3w4q1 and the vertex q2 which dominates both q1 and w3). Thus, W1W2 and analogously we obtain that W2W3W4W1, so H is an extension of a cycle, a contradiction. [formula]

To find a complete dichotomy for the case of semicomplete bipartite digraphs, one would need, among other things, to solve an open problem from [\cite=gutinDAM]: establish a dichotomy classification for the complexity of MinHOMP(H) when H is a bipartite (undirected) graph. Indeed, let B be a semicomplete bipartite digraph with partite sets U,V and arc set [formula], where A1 = U  ×  V and A2  ⊆  V  ×  U. Let B' be a bipartite graph with partite sets U,V and edge set E(B') = {uv: vu∈A2}. Observe that MinHOMP(B) is equivalent to MinHOMP(B').

Acknowledgement Research of Gutin and Rafiey was supported in part by the IST Programme of the European Community, under the PASCAL Network of Excellence, IST-2002-506778.