Proposition Lemma Definition Definitions Example Examples Corollary Escolium

44

On algebras admitting a complete set of near weights, evaluation codes and Goppa codes   Cícero Carvalho and Ercílio Silva

Abstract.

Index terms.

Introduction

In 1981 V.D. Goppa showed how to use algebraic curves to produce error correcting codes (v. [\cite=goppa]), and his construction opened a new area of research in coding theory. After a decade of studies, researchers started to wonder if it was possible to find a simpler way to produce these (so called) algebraic-geometric, or Goppa, codes, one of the earliest attempt being made by Blahut ([\cite=blahut]). In 1998 Hø holdt et al. (v. [\cite=h-vl-p]) presented a simple construction for error correcting codes, using an [formula]-algebra [formula] and what they called a weight function on [formula], their construction clearly producing algebraic-geometric codes supported on one point. The theory presented in [\cite=h-vl-p] was recently generalized (v. [\cite=silva] and [\cite=4a]) by replacing weight functions by other functions on [formula], called near weights. In the present work we study specially algebras that admit m near weight functions with the property of being "a complete set" (see Definition [\ref=completeset]). We will characterize them as being the ring of regular functions of an affine geometrically irreducible algebraic curve whose points at infinity have a total of m rational branches, from this we conclude that the codes obtained from such algebras using the complete set of near weight functions are exactly the algebraic-geometric codes supported on m points (thus generalizing results in [\cite=matsumoto] and [\cite=mun-tor]).

In what follows we will denote by [formula] the set of nonnegative integers. Let [formula] be a field and [formula] be a commutative ring that contains [formula], i.e. an [formula]-algebra. Given a function [formula] let [formula] and [formula].

A trivial way to define an n-order ρ on [formula] is to set ρ(0): =   -    ∞   and ρ(f)  =  1 for all [formula], f  ≠  0, then we have [formula] and [formula]. We want to avoid such functions, so we say that an n-order ρ is trivial if [formula] and from now on we work only with nontrivial n-order functions.

From (N3) it follows that [formula] does not have zero divisors, we also get the following results (cf. [\cite=4a]).

Let ρ be an n-order on [formula], then: i) the element λ in (N4) is uniquely determined; ii) if ρ(f)  ≠  ρ(g) then ρ(f  +  g)  =   max {ρ(f),ρ(g)}.

Notation. In the next sections we deal with subsets of [formula], and will use the following conventions: we denote by [formula] the m-tuple having all entries equal to zero; when we write [formula] it's to be understood that the entries of the m-tuple [formula] are [formula] (similarly for [formula]); we write sometimes [formula], being then understood that [formula]. Also, for [formula] we denote by [formula] the m-tuple that has all entries equal to zero, except the i-th entry, which is equal to 1. We add m-tuples and multiply them by nonnegative integers in the usual way.

Codes from near weights

In this section we show how to construct codes from algebras that admit a complete set of n-weight s, and give a lower bound for their minimum distance. We begin by introducing the concept of normalized n-order s.

Let ρ be an n-order function, we define the normalization ρ' of ρ as being the function [formula] defined by ρ'(0)  =    -    ∞  , ρ'(f): = 0 if [formula] and ρ'(f): = ρ(f) if [formula].

From the proof of [\cite=4a] we know that ρ' is an n-order, [formula] and [formula]. From now on we work only with normalized n-order s. If ρ is an n-weight then from (N5) we see that [formula] is a subalgebra of [formula].

In this section we will show how to construct linear codes from [formula]-algebras and a set of n-weight s which have a compatibility property which we define now. Let [formula] be a set of (nontrivial, normalized) n-weight s.

We say that [formula] is a complete set of n-weight s for [formula] if [formula] and for all [formula] we have that [formula] is a finite set.

Let [formula] be an [formula]-algebra that admits [formula] as a complete set of n-weight s. Given [formula] we define

[formula]

From (N0),(N1) and (N2) we get that L is an [formula]-vector subspace of [formula].

For any [formula] we get [formula]; moreover [formula].

Assume that [formula], from (N4) we know that there exists [formula] such that ρk(f  -  λg)  ≤  ak, and from (N1) and (N2) we get ρi(f  -  λg)  ≤  ai for all [formula]. Thus f  =  λg  +  h with [formula] hence [formula] as elements of [formula].

Since [formula] we get as a corollary of the above lemma that [formula] is an [formula]-vector space of finite dimension for any [formula].

For the remainder of this section, we will assume that [formula] is a finite field. Let [formula] be a surjective morphism of [formula]-algebras and let [formula]. We will denote by [formula] the code [formula] and we want to determine a lower bound for the minimum distance of [formula], in a way similar to that which has been done by Hø holdt et alli in the case where m  =  1 (cf. [\cite=h-vl-p]).

Let [formula], and define [formula] as a set of pairs of functions [formula] such that: a) [formula] for all [formula]; b) ρk(fk,i)  +  ρk(gk,i)  =  ak  +  1; c) [formula] (hence [formula]; d) given [formula] we have [formula] for all [formula]. We will write [formula].

Now, consider the matrices M and N, where the first [formula] rows of M are φ(fk,1), [formula] [formula], the first [formula] columns of N are [formula], and we complete the rows of M and the columns of N in a way such that rank(M)  =  rank(N)  =  n. Let [formula] and let [formula] where ai  j  =  0 if i  ≠  j and ai  i  =  yi for [formula]. Since rank(M)  =  rank(N)  =  n we get [formula]; moreover if [formula] then [formula], where ·   is the usual inner product in [formula] and *   is the usual componentwise product that makes [formula] an [formula]-algebra.

If [formula] then [formula].

We have already noted that [formula] for all [formula]. From definition [\ref=defna] (d) we get that the [formula] minor at the upper left corner of [formula] is a lower triangular matrix. Since [formula] from Lemma [\ref=lemma_dim] we get [formula] hence [formula] for all [formula].

Let [formula] be such that ai  ≤  bi for all [formula]. We call a path from [formula] to [formula] a finite sequence of m-tuples [formula], where [formula] for all [formula], [formula], [formula] and for any [formula] we have [formula] for some [formula] which is called the step place of [formula].

Let [formula], then there exists [formula] such that [formula] and ai  ≤  bi for all [formula].

Since φ is surjective there are [formula] such that [formula] is a basis for [formula], so it suffices to take [formula], where [formula] and set [formula].

As a consequence of the above results we have the following bound for the minimum distance of [formula].

Let [formula] and let [formula] be such that ai  ≤  bi for all [formula] and [formula]. Given a path [formula] from [formula] to [formula] the minimum distance of [formula] is bounded from below by [formula].

At first glance a major drawback of the above result is that it depends on finding [formula] such that [formula], while we would like a bound that does not depend on the knowledge of φ. The following considerations show that we do not have to find such [formula] in order to calculate a bound.

Let [formula], from (N5) we get that [formula] is a subsemigroup of [formula] and since [formula] is a complete set for [formula] we get [formula] (i.e. Sk is a numerical semigroup). Observe also that given [formula] and t1,t2∈Sk such that t1  +  t2  =  ak  +  1 then taking [formula] such that ti  =  ρk(fi), i  =  1,2, we get [formula] (of course also [formula], if t2  ≠  t1).

Let S be a numerical subsemigroup of [formula] of genus g, let c be the conductor of S and let [formula]. If [formula] then #  N  =  2(c  -  g)  +  u  -  1.

We have 2(c  -  1  -  g) pairs (a,b)∈N such that either 1  ≤  a  ≤  c  -  1 or 1  ≤  b  ≤  c  -  1. And we have u  +  1 pairs (a,b)∈N with c  ≤  a,b  ≤  c  +  u.

Let [formula] and let [formula] be a sequence of m-tuples such that [formula], [formula] for some [formula] and lim i  →    ∞aij  =    ∞  , for all [formula] and all [formula]. From (the proof of) Lemma [\ref=lemma_dim_n] we know that there exists [formula] such that [formula]. For [formula], let ck be the conductor of Sk, to calculate the bound indicated in Corollary [\ref=thm_bound] we should calculate [formula] for all i∈{0,r - 1}, but we observe that: a) if [formula] then set u: = h  -  2(ck  -  gk)  +  1; we shall calculate [formula] at most for m-tuples [formula] such that aik  ≤  2ck  +  u  -  1 (in fact, if ai  k  +  1  >  2ck  +  u we will get [formula]); b) if [formula] then we shall calculate [formula] at most for m-tuples [formula] such that ai  k  ≤  2ck  -  1 (in fact, if ai  k  +  1  >  2ck then [formula]).

Thus we do not have to know r to calculate the bound.

The next result shows that geometric Goppa codes supported in m points are instances of the codes we described above.

Let X be a nonsingular, geometrically irreducible, projective algebraic curve defined over [formula], and let [formula] and [formula] be divisors on X such that [formula] and Pi is a rational point, for all [formula] (hence the Goppa code CL(D,G) is the set of m-tuples [formula], where h∈L(G)). Then taking [formula], where OQ is the local ring at Q∈X, and defining [formula] there exists a complete set of m near weights on [formula] such that [formula], where [formula] .

Observe that [formula] is the [formula]-subalgebra of [formula] consisting of the functions regular on [formula]. Denoting by vk the discrete valuation of [formula] associated to Qk ([formula]), one easily checks that the function [formula] defined by ρk(0)  =    -    ∞  , ρk(f)  =  0 if vk(f)  ≥  0 and ρk(f)  =    -  vk(f) if vk(f)  <  0, for all [formula] is an n-weight for all [formula]. We have [formula] and [formula] for all [formula]. Moreover, since [formula] (because X is geometrically irreducible) and [formula] is the Weierstrass semigroup at Qk for all [formula] (hence it has finite genus) we get that [formula] is a complete set of n-weight s for [formula].

Denoting by MPi the maximal ideal of OPi we get that [formula] for all [formula] (see e.g. [\cite=sti]), hence [formula] and from the Chinese Remainder Theorem φ is an epimorphism. We also have [formula] hence [formula].

Now we present examples which show that when applied to a geometric Goppa code, the bound for the minimum distance found above may be better than the usual Goppa bound.

Let X be the hermitian curve given by Y3Z  +  YZ3  -  X4  =  0 and defined over the field [formula]. Take Q1, Q2 and Q3 to be three distinct rational points, say the points in the intersection of X, the open set Z  ≠  0 and the line X  =  0, let [formula] and denote by [formula] the geometric Goppa code associated to the divisors [formula] and [formula], where [formula] are distinct rational points, different from Q1, Q2 and Q3. The genus of X is 3 and the so-called Goppa bound for the code [formula] is [formula]. Note that Si is the semigroup generated by 3 and 4, so the conductor is 6, for all k  =  1,2,3. To find a bound as described in Corollary [\ref=thm_bound] it is useful to know the set [formula], which in this case is exactly the Weierstrass semigroup W associated to {Q1,Q2,Q3}, i.e. the set [formula], where ∞(f) denotes the pole divisor of f. Such semigroups have been much studied in the last decade (see e.g. [\cite=kim], [\cite=homma-kim], [\cite=gretchen], [\cite=car-tor]), and in [\cite=gretchen] we find an explicit description of a generating set for this semigroup, so that we may decide if an element of [formula] is or is not in S. Thus, given [formula] we proceed as follows. For k  =  1,2,3 we calculate [formula], if [formula] then set [formula], if [formula] the we set Ak: = 2  ·  6  -  1  =  11. Let [formula] and consider the path P from [formula] to (A1,A2,A3) given by [formula] where [formula], [formula], [formula], for [formula], [formula], for [formula], and [formula], for [formula]. From the considerations that precede these examples we get that [formula] is a bound for the minimum distance of [formula].

Let [formula], taking [formula] we have [formula] (with [formula] (3,0,0)),((3,0,0),(0,0,0))}), [formula] (with [formula] ((0,3,0),(0,0,0))}), and [formula] (with [formula] ((1,1,1),(1,1,1)),((0,2,2),(0,0,0))}).

Thus (A1,A2,A3)  =  (11,11,11) and inspecting W we get that [formula], while [formula]. In the table below we present results for this and other values of [formula].

We also present a similar table, containing examples of codes from the hermitian curve given by Y4Z  +  YZ4  -  X5  =  0 and defined over the field [formula]. Again, we take Q1, Q2 and Q3 to be three distinct rational points of the curve, now Si is the semigroup generated by 4 and 5, so the conductor is 12, for i  =  1,2,3; the genus of the curve is 6.

Algebras with near weights and algebraic curves

In this section we present a characterization for algebras which admit a complete set of n-weight s.

Let [formula] be an [formula]-algebra and ρ an n-weight. Let [formula] be such that ρ(f)  >  0, ρ(g)  =  0, [formula] and ρ(fg)  <  ρ(f). Then for any [formula] we have ρ(f(g  +  λ))  =  ρ(f) and ρ(g  +  λ)  =  0.

Let [formula], then ρ(f(g  +  λ))  =  ρ(fg  +  λf))  ≤   max {ρ(fg),ρ(f)}. Since ρ(fg)  <  ρ(f) we get ρ(f(g  +  λ))  =  ρ(f) . We also have [formula] since [formula] is an [formula]-subalgebra of [formula].

Let [formula] be an [formula]-algebra which admits a (not necessarily complete) set of n-weight s [formula]. Let [formula] be the map defined by [formula] and let [formula].

We will always assume that if the field [formula] is finite then [formula].

Let [formula], with [formula]. We define the least upper bound of [formula] as being the m-tuple [formula] where [formula] for all [formula].

Let [formula], then [formula]. Furthermore, if [formula] are such that [formula] for all [formula] then there exists [formula], [formula], where [formula] such that [formula].

Since [formula] for all [formula] it suffices to prove the case where r  =  2. Let [formula] be such that [formula] and [formula]. If [formula] then the result is trivial, so we will assume that [formula], a fortiori f  ≠  λg for all [formula]. If #  ({j  |  a1j  =  a2j})  =  m  -  1 then [formula], so we assume that #  ({j  |  a1j  =  a2j})  ≤  m  -  2. Let [formula], if ρi(f)  ≠  ρi(g) then ρi(f  +  λg)  =   max {ρi(f),ρi(g)} for all [formula]; if ρi(f)  =  ρi(g)  =  0 then for all [formula] we get ρi(f  +  λg)  =  0; if ρi(f)  =  ρi(g)  ≠  0 then there exists a unique [formula] such that ρi(f  -  λig)  <  ρi(f), hence for all [formula], λ  ≠    -  λi we get ρi(f  +  λg)  =  ρi(f). Since [formula] there exists [formula] such that ρi(f  +  λg)  =   max {ρi(f),ρi(g)} for all [formula].

Let [formula] and [formula] be distinct elements of S and suppose that aj  =  bj for some [formula]. Then there exists [formula] such that: i) ci  =   max {ai,bi} for i  ≠  j and ai  ≠  bi; ii) ci  ≤  ai for all i  ≠  j and ai  =  bi; iii) cj  =  aj  =  0 or cj  <  aj.

Let [formula] such that [formula] and [formula]. If aj  =  bj  =  0 then it suffices to take [formula]. If aj  =  bj  >  0 then f,g∈Mρj and there exists [formula] such that ρj(f  -  λg)  <  aj, so we take [formula].

Let [formula] be the (partial) ordering in [formula] given by the relation [formula] if ai  ≤  bi for all [formula].

Let [formula], then the following assertions are equivalent: i) [formula] is a minimal element of the set [formula] for some [formula] such that ak  >  0; ii) [formula] is a minimal element of the set [formula] for all [formula] such that ai  >  0.

Assume that [formula] is a minimal of the set [formula] for some [formula] and suppose that [formula] is not a minimal of the set [formula] for some [formula]. Then there exists [formula] such that [formula], [formula] and bj  =  aj, furthermore, from the hypothesis we must have bk  <  ak. From Lemma [\ref=lemma_dif] there exists [formula] such that ci  ≤   max {ai,bi} for all [formula], ck  =  ak and cj  <  aj, so [formula] is not a minimal of the set [formula], a contradiction.

If [formula] is a minimal element of the set [formula] for some [formula] we say that [formula] is a minimal of S (cf. [\cite=gretchen]). We will denote by Γ the set of all minimals.

Observe that [formula] and the points of S which have all entries but one equal to zero are minimals.

The set S is a subsemigroup of [formula].

Let [formula] and let [formula] be such that [formula] and [formula]. Set [formula], for [formula] we have ci  ≤  ai  +  bi and equality holds whenever ai  >  0 and bi  >  0, hence [formula].

We assume from now on that [formula] is a complete set of n-weight s for [formula]; the next result shows that Γ generates the semigroup S under the operation [formula].

Let [formula] and let r be the number of nonzero entries of [formula], then there exist [formula] such that [formula].

Let [formula] and let [formula] be the set of indexes i for which [formula]; from Proposition [\ref=minimal] [formula] is not a minimal in any set [formula] with i∈Λ, then for all i∈Λ there exists [formula] such that [formula] and bii  =  ai, so we have [formula].

Given [formula] let [formula] (i.e. a∈Hj if and only if there exists [formula] having all entries equal to zero, except the j-th entry, which is equal to a). Then Hj is a semigroup which has finite genus (since [formula] is a complete set of n-weight s).

Let [formula] and let [formula]. If #  Λ  ≥  2 then aj∉Hj for all j∈Λ.

Let j∈Λ and assume by means of absurd that aj∈Hj; let [formula] be the m-tuple having all entries equal to zero except the j-th, which is equal to aj. Then [formula], [formula] and [formula], hence [formula].

Let [formula], an easy but important consequence of the above lemma is the following.

The set Γ̃ is finite.

Let Gj be the set of gaps of Hj, then #  (Gj)  <    ∞   for all [formula] and from the lemma above [formula].

For each [formula] let [formula] be such that [formula], and let [formula].

The set B spans [formula] as an [formula]-vector space.

We want to show that any [formula] is a finite linear combination over [formula] of elements of B, and we do this by induction on the number of nonzero entries of [formula]. If this number is zero then [formula] and is a multiple of [formula]. Assume that [formula] has r nonzero entries, with r  ≥  1, and for simplicity, let's assume that these entries are [formula]. From Lemma [\ref=lemma_lub] there are [formula] such that [formula] and from Proposition [\ref=prop_lub] there are [formula] such that [formula] satisfies [formula]. Since ρ1(f)  =  ρ1(g)  =  a1  >  0 there is [formula] such that ρ1(f  -  λg)  <  a1, moreover ρj(f  -  λg)  ≤  aj for all [formula]. If f  =  λg we are done, otherwise we repeat the process, starting with f  -  λg this time, until we get either that f is a linear combination of finite elements of B or that the m-tuple obtained by applying the function [formula] to f minus a finite linear combination of elements of B has less than r nonzero elements (because the first entry is certainly zero); either way we're done.

[formula] is a finitely generated algebra over [formula].

Let [formula], we know that the semigroup [formula] has finite genus, hence it is finitely generated, so let [formula]. For each aij with [formula] and [formula] there is [formula] having all entries equal to zero, except the i-th entry which is equal to aij. Thus if [formula], i.e. if [formula] has only one positive entry, which is in the i-th position for some [formula], then for certain [formula] we have [formula] (recall that [formula] and are such that [formula] for all [formula]) and we can take [formula]. Since Γ̃ is a finite set, the result follows from the above proposition.

Let [formula], f  ≠  0, then [formula].

We may assume that [formula]. We also assume m  ≥  2 (for m  =  1 the proof is in [\cite=matsumoto]). From Proposition [\ref=prop_span] we have that the set [formula] spans [formula] as a vector space over [formula], and since Γ̃ is finite, it suffices to show that for all [formula], except maybe for a finite number, we may take [formula]. Thus, we will show that for any [formula] there exists [formula] such that for all n  ≥  ni with n∈Hi we may find s∈(f) such that ρi(s)  =  n and ρj(s)  =  0 for all [formula], j  ≠  i. For simplicity, let's take i  =  1; we will consider two cases. In the first case, we assume that ρj(f)  =  0 for all [formula], hence ρ1(f)  >  0 (since [formula]). Let [formula] be the largest gap of H1 and set d1: = ρ1(f), if [formula] are generators for H1, then using the notation of the preceding proof, for any [formula] we may find [formula] such that [formula] and [formula] for all [formula]. In the second case we assume that there exists [formula] such that ρj(f)  >  0. Let [formula] be such that ρ1(g)  >  0 and ρi(g)  =  0 for all [formula] (such g exists because the genus of H1 is finite, moreover [formula]), then ρj(fg)  ≤  ρj(f) and there exists [formula] such that ρj(fg  -  λf)  =  ρj(f(g  -  λ)  <  ρj)(f). We have g  -  λ∈Mρ1 but for all [formula], since g∈Uρi we have g  -  λ∈Uρi and ρi(f(g  -  λ))  ≤  ρi(f). By repeating this process we may find h∈Mρ1 such that ρi(hf)  ≤  ρi(f) for all [formula] and ρj(hf)  =  0; repeating even further we find t∈Mρ1 such that ρi(tf)  =  0 for all [formula] (observe that ρ1(tf)  >  0 since if ρ1(tf)  =  0 then [formula], and a fortiori [formula], a contradiction). Let [formula] be the largest gap in H1 and set d1: = ρ1(tf); given [formula] let u∈Mρ1 be such that ρ1(u)  =  n  -  d1 and ρi(u)  =  0 for all [formula], then ρ1(utf)  =  n and ρi(utf)  =  0 for all [formula]. This completes the proof.

We have already observed that [formula] is a domain, and we will denote by [formula] its field of fractions.

[formula] is an algebraic function field of one variable over [formula].

Let [formula], f  ≠  0, from Theorem [\ref=dim_finita] we know that [formula] is an [formula]-vector space of finite dimension, furthermore, all ideals of R / (f) are [formula]-subspaces hence [formula] is an artinian ring, so [formula]. Taking [formula], from [\cite=eisenbud] we have [formula]; on the other hand from [\cite=eisenbud] we get [formula].

The algebra [formula] is the affine coordinate ring of an (irreducible) algebraic curve.

It is an immediate consequence of Proposition [\ref=fin_gen_alg] and the above lemma.

Let [formula], from the proof of Theorem [\ref=dim_finita] we get that if [formula] then there exists g∈Mρi such that gf∈Mρi, hence if [formula] and g1a,g2b∈Mρi with g1,g2∈Mρi then (g1g2)a,(g1g2)b∈Mρi.

Let [formula] and let [formula] be the function defined by setting vi(0):  =    ∞   and vi(a / b): = ρi(gb)  -  ρi(ga), where [formula] and g∈Mρi is such that ga,gb∈Mρi.

Observe that vi(a / b) does not depend on the choice of g because if h∈Mρi is such that ha,hb∈Mρi then ρi(gb)  -  ρi(ga)  -  (ρi(hb)  -  ρi(ha))  =  ρi(gbha)  -  ρi(gahb)  =  0, for all [formula]; a similar reasoning shows that if a' / b' = a / b, with [formula] then vi(a / b)  =  vi(a' / b').

Let [formula]. a) The function [formula] is a discrete valuation of the function field [formula]; b) If [formula] then vi(f)  ≥  0 when f∈Uρi and vi(f)  =    -  ρi(f) when f∈Mρi.

Given [formula] it is easy to check that vi(fg)  =  vi(f)  +  vi(g) and that vi(f)  =  0 if [formula]. Since Hi has finite genus, we know that for a sufficiently large [formula] there are f,g∈Mρi such that ρi(f)  =  n, ρi(g)  =  n  +  1, hence vi(f  /  g)  =  1. Let [formula], with [formula] and [formula], and let h1,h2∈Mρi such that h1a,h1b,h2c,h2d∈Mρi, then vi(f  +  g)  =  vi((ad  +  bc) / bd)  =  ρi(h1h2bd)  -  ρi(h1h2ad  +  h1h2bc)  ≥   min {ρi(h1h2bd)  -  ρi(h1h2ad),ρi(h1h2bd)  -  ρi(h1h2bc)}  =   min {ρi(h1b)  -  ρi(h1a),ρi(h2d)  -  ρi(h2c)}  =  {vi(f),vi(g)}.

Now let [formula] and g∈Mρi be such that gf∈Mρi, if f∈Uρi then from (N5) and the fact that ρi is normalized we get vi(f / 1)  =  ρi(g)  -  ρi(gf)  ≥    -  ρi(f)  =  0; on the other hand, if f∈Mρi then vi(f / 1)  =  ρi(g)  -  ρi(gf)  =    -  ρi(f).

This shows that every n-weight ρi on [formula] defines a valuation vi of the function field [formula]. These are distinct valuations (e.g. for a sufficiently large [formula] we may find fi∈Mρi for all [formula] such that vi(fi)  =    -  n and vj(fi)  ≥  0 for all [formula]). We denote by Pi the place associated to the valuation vi and be OPi the corresponding valuation ring ([formula]).

For all [formula] the place Pi has degree one (a fortiori, [formula] is the full field of constants of [formula]).

Let [formula], we must prove that the inclusion map [formula] is surjective. Let f  =  a / b∈OPi, where [formula], let g∈Mρi such that ga,gb∈Mρi and assume that vi(f)  =  0. Then ρi(gb)  =  ρi(ga) and there exists a unique [formula] such that ρi(ga  -  λgb)  <  ρi(gb). Let h∈Mρi be such that h(a  -  λb),hb∈Mρi, then vi(a / b  -  λ)  =  ρi(hb)  -  ρi(h(a  -  λb))  =  ρi(hgb)  -  ρi(hg(a  -  λb)), so from ρi(gb)  -  ρi(ga  -  λgb)  >  0 and property (N3) we get ρi(hgb)  -  ρi(hg(a  -  λb))  >  0, which completes the proof.

We denote by [formula] the set of places of the function field [formula]. For [formula] we write OP for the corresponding valuation ring; let [formula].

[formula].

First we observe that, for all [formula] we have [formula], since [formula] would imply [formula], a contradiction with the fact that ρi is non-trivial. Suppose by means of absurd that [formula]. Then, from the Strong Approximation Theorem (see [\cite=sti]) we know that for all [formula] there exists [formula] such that vi(fj)  =  j, for all [formula] and fj∈OQ for all [formula], thus [formula], the integral closure of [formula] in [formula]. Let [formula], observe that W is an [formula]-vector space and also [formula]: in fact, if [formula] then ρi(g)  -  ρi(gx)  >  0 for some g∈Mρi, thus ρi(gx)  <  ρi(g) and from (N5) either ρi(x)  =  0 for all [formula] or x  =  0, since [formula] and x∈W we must have x  =  0. Thus [formula] and this last dimension is finite (see e.g. [\cite=matsumoto]), but [formula] is a linearly independent set over [formula] for all [formula].

[formula] is an [formula]-algebra admitting a complete set of m n-weight s  if and only if [formula] is the ring of regular functions of an affine geometrically irreducible algebraic curve, whose points in the closure have a total of r branches, all of them corresponding to rational places in the field of rational functions of the curve.

The "only if" part is a consequence of the above results. As for the "if" part let X be the affine curve and [formula] be its closure, if Y is the normalization of [formula] and [formula] is the normalization morphism then there are m rational points [formula] in the inverse image by η of the set [formula]. Now we proceed as in theorem [\ref=ida]; thus we observe that [formula], where OQ is the local ring at Q∈X and denoting by vk the discrete valuation of [formula] associated to Qk ([formula]) we define the function [formula] by setting ρk(0):  =    -    ∞  , ρk(f): = 0 if vk(f)  ≥  0 and ρk(f): =   -  vk(f) if vk(f)  <  0, for all [formula], one may check that ρk is an n-weight for all [formula]. From [formula] and the fact that [formula] is the Weierstrass semigroup at Qk for all [formula] we get that [formula] is a complete set of n-weight s for [formula].

Let [formula] be an [formula]-algebra that admits a complete set of m n-weight s, let [formula] be a surjective morphism of [formula]-algebras and [formula], then [formula] is an algebraic-geometric Goppa code CL(D,G) with G supported on m points.

From the hypothesis on [formula] we know that there is a geometrically irreducible, projective, nonsingular curve Y and points [formula] such that [formula]. For [formula] consider the [formula]-algebra surjective homomorphism [formula] defined by [formula], then [formula] is a maximal ideal of [formula]. Furtermore, for distinct [formula] we get Mi  ≠  Mj since φ is surjective and then exists [formula] such that [formula] and [formula]. From [\cite=sti] we get that there are [formula] such that [formula], [formula] (where MPi is the maximal ideal of OPi) for all [formula]. We also get [formula] for all [formula] hence [formula] are rational points of Y and we may rewrite φ as the morphism over [formula] defined by [formula]. Let [formula], then [formula] and

[formula]

hence [formula], where [formula].