Corollary Definition

The N-queens Problem on a symmetric Toeplitz matrix

The N-queens Problem, a generalization of the original 8-queens problem, asks whether n nonattacking queens can be placed on an n  ×  n chessboard in such a way that no queen can attack another, i.e., so that no two queens are placed in the same row or column or on the same diagonal. The problem has been extensively studied since the mid-1800s; for a brief summary of the history, see [\cite=HHS] [\cite=RVZ] [\cite=Wat]. A familiar extension of the problem (due to Polya) asks the same question for queens placed on a toroidal chessboard. Vardi also considers the toroidal semiqueens problem, in which a semiqueen may move "...like a rook or bishop, but only on positive broken diagonals." [\cite=Vardi] (See Figure [\ref=fig:Vardifig].) To clarify the phrase "positive broken diagonals" without reference to a figure, number the rows and columns of an n  ×  n chessboard from 1 to n, starting with the top left square. The kth positive broken diagonal then consists of all squares labeled (i,j) for i + j = k + 1 mod n.

In this paper we modify the chessboard again; now it corresponds to a symmetric Toeplitz matrix. A Toeplitz matrix has constant negative diagonals, i.e., entry (i1,j1) equals entry (i2,j2) whenever i1 - j1 = i2 - j2 [\cite=PFTV]. In a symmetric Toeplitz matrix, we further require that entry (i1,j1) equal entry (i2,j2) whenever |i1 - j1| = |i2 - j2|. Queens may attack each other if they share a row or a column, or if both are on squares belonging to a set of the form Dk  =  {(i,j)  |  |i - j|  =  k}. We then ask when n nonattacking queens can be placed on such an n  ×  n chessboard. We will show that n nonattacking queens can be placed on such a chessboard if and only if [formula].

To solve this problem we will consider the matrix Tn with entries given by tij = |i - j|, for [formula]. We say that Tn is solvable if and only if we can select n entries from Tn with values [formula] so that no two entries selected lie in the same row or the same column. Equivalently, Tn is solvable if and only if there exists a permutation [formula] such that |f(i) - i| assumes each of the values [formula] exactly once. (We will use both formulations throughout this paper.) A solution set for Tn is a set of pairs [formula] where f is a permutation demonstrating Tn's solvability. For example, as indicated in Figure [\ref=fig:toep], solution sets for T4 and T5 are, respectively, S4  =  {(1,3),(2,2),(3,4),(4,1)} and S5  =  {(1,4),(2,2),(3,5),(4,3),(5,1)}.

Tn is solvable if and only if [formula].

We use a counting argument to show that Tn is not solvable for [formula], then construct a solution set for Tn when [formula].

Suppose [formula] is a solution for Tn. As f is a permutation, it follows that

[formula]

As |f(i) - i| achieves each of the values [formula] exactly once, we have

[formula]

However, it is also the case that

[formula]

Simplifying, we obtain

[formula]

Using [\eqref=E:first] and [\eqref=E:second] gives

[formula]

or

[formula]

Simplifying the right-hand side and recognizing that the left-hand side is an integer yields

[formula]

Suppose first that [formula]. Since n is even, 2n2 + 9n + 1 is odd. But this together with [formula] implies [formula], a contradiction. Thus no solutions exist for [formula]. Now assume that [formula]. A short calculation shows that [formula], so [formula] (under the assumption that [formula]). But [formula] contradicts [formula]. Therefore there are no solutions when [formula].

It remains to show that Tn is solvable when [formula] mod 4. The proof will be done by induction on n.

We begin by defining two matrices that can be obtained from Tn.

T*n is the matrix obtained from Tn by deleting the first column and the last row of Tn.

T*  *n is obtained from Tn by deleting the first and last row as well as the first and the (n - 1)st column of Tn.

Figure [\ref=fig:derive] illustrates T*n and T*  *n. We will call T*n solvable if we can select entries with values [formula], one from each row and each column; likewise T*  *n will be called solvable if we can select entries with values [formula], one from each row and each column. Note that if T*n is solvable, then so is its transpose, (T*n)T, which is obtained from Tn by removing the first row and the last column. We will not distinguish between T*n and (T*n)T. The same holds for T*  *n and (T*  *n)T.

If Tn is solvable, without loss of generality we can assume that the (n,1) entry was selected as the entry of value n - 1, see Figure [\ref=fig:derive]. By symmetry we may assume that the (1,n - 1) entry was selected as the entry of value n - 2. It is easy to see that removing the (n,1) entry from the solution set of Tn gives a solution set for T*n and removing both the (n,1) and the (1,n - 1) entries gives a solution for T*  *n. Similarly adding one or both of these entries to the solution of T*  *n results in solutions for T*n and Tn respectively. We conclude that, for fixed n, either all three of Tn,T*n and T*  *n are solvable or none of them is.

Solutions for T4 and T5 are provided in Figure [\ref=fig:toep]. We assume the result for all k < n. The solution set depends on the remainder of n mod 3, so we write n = 3r + s, where s may be 0, 1, or 2. Cases 2 and 3 are similar to Case 1 and thus will be written out in less detail.

Case 1: n = 3r + 0. We build a solution set Sn as follows: Select entries [formula] which have values [formula] respectively. Also select entries [formula] which have values [formula] and finally select the entry (n - r,n) = (2r,n) with value r. Thus far Sn contains all values [formula] and no two selections are in the same row or column.

The entries that are still available to be selected (i.e., those lying in a row or column not yet selected) have indices (a,b) with r  ≤  a  ≤  2r - 1 and r + 1  ≤  b  ≤  2r. As each entry is equal to the difference between its row and column index, we can subtract r - 1 from each of the row and column indices and obtain the matrix with row labels 1 through r and column labels 2 through r + 1. The matrix we obtain is Tr + 1 with the last row and the first column deleted, i.e., it is T*r + 1. Thus if T*r + 1 has a solution set S*r + 1, adding this solution set to the entries we already selected completes Sn. By induction we know T*r + 1 is solvable as long as [formula]. However it is easy to check that [formula] if and only if [formula].

Case 2: n = 3r + 1. Select entries [formula] and [formula] and (n - r,n) = (2r + 1,n). So far we have selected values with entries [formula]. The entries that are still available to be selected have indices (a,b) such that r + 1  ≤  a  ≤  2r and r + 1  ≤  b  ≤  2r. By subtracting r from both the column and row labels, we see that the matrix that remains is Tr. Again, it is easy to check that [formula] if and only if [formula] or 1 mod 4. Thus, by the induction hypothesis, we can complete the solution set Sn.

Case 3: n = 3r + 2. Begin by selecting entries [formula] and [formula] and (n - (r + 1),n) = (2r + 1,n). The values we have selected so far are [formula]. The entries that are still available to be selected are those with indices (a,b) such that r + 1  ≤  a  ≤  2r or a = 2r + 2 and r + 1  ≤  b  ≤  2r + 1. By subtracting r - 1 from all row and column labels we see that these are the entries of the transpose of T*  *r + 3 which by the induction hypothesis is solvable as long as [formula]. Again we see that [formula] if and only if [formula], and thus we can complete the solution set Sn.

A symmetric Toeplitz chessboard is an n  ×  n chessboard in which the squares are labeled with numbers so that the labels along each descending diagonal are constant and the labeling is symmetric with respect to the main descending diagonal. A queen placed on the chessboard may attack other queens in the same row or column as well as those placed on a square with the same number value.

It is possible to place n queens on an n  ×  n symmetric Toeplitz chessboard so that no two queens may attack each other if and only if [formula].

Without loss of generality assume the squares of the chessboard are labeled with the entries of Tn. Then placing the nonattacking queens on the chessboard is equivalent to finding a solution for Tn. The result follows by Theorem [\ref=thm:solvable].

Corollary [\ref=thm:queencor] establishes the existence (and nonexistence) of solutions to the N-queens Problem on the particular modification of the chessboard discussed in this paper. However, variants of this problem analogous to those on other chessboards remain to be addressed. For instance:

What is the minimum number of queens necessary for each square of the board to either contain a queen or to be attacked by at least one queen? (What is the minimum cardinality of a dominating set, i.e., what is the domination number?)

When [formula], what is the maximum number of queens that can be placed on the board so that no queen can attack another? (What is the maximum cardinality of an independent dominating set?)

Substitute another type of chess piece for queens and ask analogous questions.

How many (fundamental) solutions exist for each question?

Theorem [\ref=thm:n-1] resolves the second question.

It is possible to place n - 1 nonattacking queens on an n  ×  n chessboard corresponding to a symmetric Toeplitz matrix.

We provide such a placement of n - 1 nonattacking queens as follows.

Place a queen on square (1,1).

For each i from 1 to [formula], place a queen on square (n + 1 - i,i + 1).

For each j from 3 to [formula], place a queen on square (j,n + 3 - j).

Figure [\ref=fig:n-1fig] indicates this placement. To facilitate detail-checking, we examine n even and n odd separately.

Case 1: n is even. Examine the rows occupied by queens. Step 1 places a queen in row 1; step 2 places queens in rows [formula]; step 3 places queens in rows [formula]. The n - 1 queens occur once in every row with the exception of row 2 only. Similarly, we have queens in column 1 (step 1), in columns [formula] (step 2), and in columns [formula] (step 3). Every column except column [formula] has exactly one queen. Calculating the differences of the row and column indices shows that there is exactly one queen in each of the diagonals indexed by 0 (step 1), by [formula] (step 2), and by [formula] (step 3). (The diagonal indexed by n - 1 has no queen.)

Case 2: n is odd. Rows occupied by a queen are row 1 (step 1), rows [formula] (step 2), and rows [formula] (step 3). Only row 2 has no queen, so the other rows have one queen each. Columns occupied by a queen are column 1 (step 1), columns [formula] (step 2), and columns [formula] (step 3). The only column with no queen is column [formula], so again we conclude that all the remaining columns contain exactly one queen. (Note that, as n is odd, [formula] may be written as [formula], and [formula] when n is even, so the expression [formula] identifies the column without a queen for all values of n.) Finally, we check the diagonals occupied by queens: diagonal 0 (step 1), diagonals [formula] (step 2), and diagonals [formula] (step 3). As before, only the diagonal indexed by n - 1 has no queen; the others have exactly one each.

Aknowledgements

The authors would like to thank the Department of Mathematics and Computer Science at Valparaiso University for hosting us while part of this research was carried out, as well as two referees whose helpful comments improved the final version. The third author also thanks CSU Channel Islands for the Mini-Grant which provided time to work on this project.