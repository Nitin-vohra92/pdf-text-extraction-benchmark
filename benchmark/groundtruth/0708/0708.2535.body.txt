A Remark on the Conjectures of Lang-Trotter and Sato-Tate on Average

Mathematics Subject Classification (2000): 11G05

Keywords: elliptic curves, Lang-Trotter conjecture, Sato-Tate conjecture, character sums

The conjectures of Sato-Tate and Lang-Trotter

Before we state our results, we first explain briefly the contents of the conjectures of Lang-Trotter and Sato-Tate on elliptic curves.

Let E be an elliptic curve over [formula]. For any prime number p of good reduction, let ap(E) be the trace of the Frobenius morphism of [formula]. Then the number of points on the reduced curve modulo p equals [formula]. Furthermore, by Hasse's theorem, [formula].

For the case that E does not have complex multiplication, Sato and Tate [\cite=Tate] formulated a conjecture on the distribution of angles associated to the numbers ap(E) which is equivalent to the following assertion on the distribution of the ap(E)'s. Sato-Tate Conjecture:

In [\cite=CHT], [\cite=HSBT] and [\cite=Tayl], L. Clozel, M. Harris, N. Shepherd-Barron and R. Taylor have proved the Sato-Tate conjecture for all elliptic curves E over totally real fields (in particular, over [formula]) satisfying the mild condition of having multiplicative reduction at some prime.

Lang and Trotter [\cite=LTr] considered the quantity

[formula]

where r is a fixed integer. If r = 0 and E has complex multiplication, Deuring [\cite=Deu] showed that

[formula]

For all other cases, Lang and Trotter [\cite=LTr] conjectured that the following asymptotic estimate holds. Lang-Trotter Conjecture: Here, as in the sequel,

[formula]

Lang and Trotter [\cite=LTr] used a probabilistic model to give an explicit description of the constant CE,r as an Euler product. The constant can be 0, and the asymptotic estimate is then interpreted to mean that there is only a finite number of primes such that ap(E) = r.

Main results

In the sequel, by E(a,b) we denote an elliptic curve given in Weierstrass form

[formula]

As in [\cite=Bai] and [\cite=DaP], we define a constant Cr by

[formula]

In particular, if r = 0, we have

[formula]

We shall establish the following average estimate of Lang-Trotter-type.

Let ε > 0 and C > 3 / 2 + ε be given. Fix an integer [formula]. Then, if

[formula]

we have, as x  →    ∞  ,

[formula]

If r = 0, then, under the conditions in [\eqref=cond1], we have, as x  →    ∞  ,

[formula]

In [\eqref=Coro], we have excluded the elliptic curves in the families E(a,0) and E(0,b) with [formula] because it turns out that

[formula]

which is much larger than [formula] if A,B are small compared to [formula]. This is due to the fact that the curves in the said families have complex multiplication in which case we have Deuring's result [\eqref=deu].

All other curves with complex multiplication are of the form E(αit2,βit3), where [formula], and (αi,βi) is in an explicit set of eleven pairs of integers (see [\cite=FMu], page 3, for example). Hence, if AB > x3 / 2 + ε, their contribution to [\eqref=Coro] is

[formula]

which is negligible compared to the main term.

In [\cite=Bai], we proved Theorem [\ref=LT] under the conditions

[formula]

in place of [\eqref=cond1]. Hence, unlike the corresponding Theorem 2 in [\cite=Bai], the above Theorem [\ref=LT] applies to situations when A and B are very small compared to x1 / 2. Our additional condition AB < xC in Theorem [\ref=LT] is not a real constraint since we are mainly interested in averages for small A's and B's, and it is likely that this condition can be removed by a refined treatment of a certain error term in section 3.

We further note that the above-mentioned Theorem 2 in [\cite=Bai] in turn was a generalization of an average result by E. Fouvry and M.R. Murty [\cite=FMu] on π0E(a,b)(x) and an improvement of a result of C. David and F. Pappalardi [\cite=DaP] who showed the asymptotic formula [\eqref=Cor] under the stronger condition A,B > x1 + ε.

Moreover, we shall prove the following average result on the Sato-Tate conjecture.

Let ε,c > 0 and C > 3 / 2 + 2ε be given. Further, let x  ≥  1 and 0 < α  <  β  ≤  1. Set

[formula]

Assume that xε - 5 / 12  ≤  γ  /  β  ≤  x-  ε and F(α,β)  ≥  x- 1 / 2 + ε. Then, if

[formula]

we have

[formula]

where the implied O-constant depends only on ε, c and C.

To avoid technical complications, we have excluded the cases when ab = 0. This makes sense because, as mentioned above, all elliptic curves E(a,0) and E(0,b) ([formula]) have complex multiplication, and the Sato-Tate conjecture is exclusively formulated for curves without complex multiplication (if E has complex multiplication, the distribution of the ap(E)'s is different from the Sato-Tate distribution).

We recall that the number of all remaining curves with complex multiplication is O( min {A1 / 2,B1 / 3}). Hence, if AB > x1 + ε / F(α,β), their contribution to [\eqref=stest] is, by a trivial estimation,

[formula]

which is majorized by the error term xF(α,β) /  log cx since we assume that F(α,β)  ≥  x- 1 / 2 + ε.

In [\cite=BaZh], L. Zhao and I proved Theorem [\ref=ST] (with the cases when ab = 0 included) under the conditions

[formula]

in place of [\eqref=cond3]. Again, Theorem [\ref=ST] in the present paper allows much more flexibility in the choice of A and B, and the condition AB < xC therein is not a real constraint.

From Theorem [\ref=ST], we derive the following corollary on the Sato-Tate conjecture on average for fixed α and β.

Let ε,c > 0 and C > 1 + ε be given, and let α, β be fixed real numbers with 0 < α  <  β  <  1. Define F(α,β) as in Theorem [\ref=ST]. Then, if

[formula]

we have, as x  →    ∞  ,

[formula]

where the implied O-constant depends only on α, β, ε, c and C.

If 0 < α  <  β  <  1 and x is sufficiently large, then it is possible to split the interval

[formula]

satisfying x- 2ε / 3  ≤  (β' - α') / β' = γ' / β'  ≤  x-  ε / 3 and F(α',β')  ≥  x- 2ε / 3. Now applying Theorem [\ref=ST] with ε replaced by ε / 3 to each of these subintervals, and summing up all contributions, we obtain the desired asymptotic estimate [\eqref=asy] under the conditions in [\eqref=cond2].

We note that Theorem 14 in the recent work [\cite=WDBIES] of W. Banks and I.E. Shparlinski implies the asymptotic estimate [\eqref=asy] as well (the contributions of a,b with ab = 0 is negligible), but they require the conditions

[formula]

which are stronger than our conditions in [\eqref=cond2].

On the other hand, their error term estimate is uniform with respect to α and β, unlike that in our Corollary [\ref=STcor], and their estimate is sharper than ours by a factor of x-  δ. Moreover, their result is valid for all α, β with - 1  ≤  α  <  β  ≤  1 (in fact, they consider angles corresponding to α and β, which lie in the interval

[formula]

containing - 1, 0 or 1.

We note that the work of L. Clozel, M. Harris, N. Shepherd-Barron and R. Taylor in [\cite=CHT], [\cite=HSBT] and [\cite=Tayl] on the Sato-Tate conjecture for individual elliptic curves does not imply any of the above average results due to the lack of uniformity of the error term with respect to a and b, and due to the lack of sufficiently strong zero density estimates for symmetric power L-functions. (Such zero density estimates would be required to establish a version of the Sato-Tate conjecture on individual elliptic curves for small intervals

[formula]

Proof of Theorem 1

In the following, let [formula]. We first estimate the contribution of all elliptic curves in the families E(a,0) and E(0,b) ([formula]). We again note that these curves have complex multiplication. Further, if E is an elliptic curve with complex multiplication, then, with an absolute ≪  -constant not depending on E or r, we have the bound

[formula]

This is due to the fact that if E has complex multiplication and [formula], then the primes p satisfying ap(E) = r are of the form p = fE,r(n) / 4, where n is an integer and fE,r is a certain quadratic polynomial with integer coefficients (see the equation and inequality before Theorem 9 in [\cite=Co]). It follows that if [formula], then

[formula]

It remains to estimate the sum

[formula]

where we now admit all integers r (including r = 0). Here we follow our method in [\cite=Bai], with the alteration that we use a result due to Banks, Shparlinski and Garaev instead of the Polya-Vinogradov estimate to bound a certain error term. We shall be brief at all places where we don't alter the method in [\cite=Bai].

Similarly as in equation (2.2) in [\cite=Bai], the quantity in question can be written in the form

[formula]

where B(r) =  max {3,r,r2 / 4}. In [\cite=Bai], we first estimated the contribution of a's and b's with p|ab by

[formula]

which turned out to be a small enough error term. We then evaluated the remaining term

[formula]

In the present note, the bound [\eqref=negl] is not sufficient due to the fact that we admit A's and B's that are much smaller than in [\cite=Bai]. In the following, we establish a refined estimate for the contribution in question. We observe that

[formula]

for every fixed ε0 > 0, where τ(n) is the number of divisors of n. By [\eqref=new] and our condition AB < xC in Theorem [\ref=ST], the above contribution is indeed negligible if C < 1 / (2ε0).

The remaining term is

[formula]

which we shall evaluate in the following. By Lemma 1 in [\cite=Bai] (see also Lemma 1 in [\cite=BaZh]) due to Deuring, the total number of [formula]-isomorphism classes of elliptic curves E(c,d) over [formula] with p + 1 - r points equals the Kronecker class number H(r2 - 4p). Let Ir,p be the number of [formula]-isomorphism classes of elliptic curves E(c,d) over [formula] with p + 1 - r points such that [formula]. Hence,

[formula]

Let (up,j,vp,j), j = 1,...,Ir,p be pairs of integers such that the curves [formula] form a system of representatives of these isomorphism classes, where [formula] denotes the reduction of an integer n modulo p. Let (  ·   / p)4 be the biquadratic residue symbol. Then, as observed in section 4 in [\cite=Bai], if [formula] mod 4, we have

[formula]

where

M(p) =  contribution of k,χ with (  ·   / p)k4χ3  =  χ0, χ2  =  χ0;

E1(p) =  contribution of k,χ with [formula], χ2  =  χ0 or (  ·   / p)k4χ3  =  χ0, [formula];

E2(p) =  contribution of k,χ with [formula], [formula]. As noted in [\cite=Bai], in the case [formula] mod 4, a similar representation of the term

[formula]

as a character sum is possible, and this expression can be treated in a similar way as the above expression in the case [formula] mod 4. Therefore, as in [\cite=Bai], we can confine ourselves to primes p with [formula] mod 4.

In [\cite=Bai] we used results in [\cite=DaP] to treat the the main term M(p). The error term E1(p) was estimated by using the Polya-Vinogradov inequality, and the error term E2(p) was handled by the Cauchy-Schwarz inequality and some mean value estimates for character sums. Our estimate for E1(p) gave rise to the condition A,B  ≥  x1 / 2 + ε in Theorem 2 in [\cite=Bai], and our estimate for E2(p) gave rise to the condition AB  ≥  x3 / 2 + ε in the same theorem.

In the following, we want to refine the estimation of

[formula]

by using the following variant of an almost-all result on character sums of Banks and Shparlinski [\cite=WDBIES] which is contained in a more general result, Theorem 10 in [\cite=gar], of Garaev.

Fix ε > 0 and η > 0. If x > 0 is sufficiently large, then for all M  ≥  xε, all primes with at most x3 / 4 + 4η + o(1) exceptions, and all non-principal multiplicative characters χ modulo p, we have

[formula]

where the function implied by o(1) depends only on ε and η.

This is Lemma 3 in [\cite=WDBIES], except that there the above sum is replaced by

[formula]

But

[formula]

and hence, the result follows.

We also need the following bound for Ir,p.

If [formula], then

[formula]

The inequality Ir,p  ≤  H(r2 - 4p) was stated in [\eqref=triv]. By Lemma 3 in [\cite=BaZh], for the Kronecker class number H(r2 - 4p) we have the formula

[formula]

where χd is a certain real character with conductor ≪  d (the above formula follows from a relation between the Kronecker and Dirichlet class numbers, and the Dirichlet class number formula). Now using the well-known bound

[formula]

the desired result follows by a quick computation.

As noted in [\cite=Bai], for each k the number of characters χ modulo p satisfying [formula], χ2  =  χ0 or (  ·   / p)k4χ3  =  χ0, [formula] is bounded. Therefore, Lemma [\ref=Ilemma] implies the bound

[formula]

From [\eqref=fir] and Lemma [\ref=gara] with η = 1 / 20, we now obtain

[formula]

Similarly, one can prove that

[formula]

Moreover, from the first equation after (4.3) in [\cite=Bai], Lemma 3 in [\cite=Bai], and Lemma [\ref=Ilemma] above, we deduce that

[formula]

for any given c > 0, and from the first inequality after (4.4) in [\cite=Bai] and Lemma [\ref=Ilemma] above, we deduce that

[formula]

Now, combining [\eqref=rew], [\eqref=new], [\eqref=char], [\eqref=E11], [\eqref=E12], [\eqref=M] and [\eqref=E2], we obtain the estimate

[formula]

From [\eqref=0] and [\eqref=LTfin], we deduce that the desired asymptotic estimates [\eqref=Cor] and [\eqref=Coro] hold under the conditions in [\eqref=cond1]. This completes the proof of Theorem 1.

Proof of Theorem 2

We follow our method in [\cite=BaZh], with the alteration that we again use Lemma [\ref=gara] instead of the Polya-Vinogradov estimate to bound a certain error term. Since we proceed similarly as in the previous section, we shall be very brief. Similarly as in [\cite=BaZh] and in the previous section, we first write the quantity

[formula]

in question as a character sum X plus some error term which can be bounded in a similar way as in [\eqref=new] and is negligible under the condition AB < xC with C > 3 / 2 + 2ε being arbitrarily given. We then split our character sum X into a main term of the form

[formula]

and two error terms E1, E2 of the form

[formula]

We don't change our treatments of the main term and the second error term in [\cite=BaZh] at all. To bound these terms, we required the conditions F(α,β)  ≥  x- 1 / 2 + ε, xε - 5 / 12  ≤  γ  /  β  ≤  x-  ε and AB > x1 + ε / F(α,β) in [\cite=BaZh]. The treatment of the first error term in [\cite=BaZh] led to the additional condition A,B > x1 / 2 + ε which we aim to replace by A,B > xε. To this end, we need to estimate this error term E1 by a different technique.

For the proof of Theorem [\ref=ST] it now suffices to establish that

[formula]

holds for every fixed c > 0 if A,B > xε. By the considerations in [\cite=BaZh], if [formula] mod 4, then E1(p) is of the form

[formula]

where the sum [formula] is taken over all characters such that [formula], χ2  =  χ0 or (  ·   / p)k4χ3  =  χ0, [formula], the number Ip satisfies the bound

[formula]

and up,j,vp,j are certain integers. By (5.4) in [\cite=BaZh] and our condition F(α,β)  ≥  x- 1 / 2 + ε, we have the bound

[formula]

for any fixed ε1 > 0, the implied ≪  -constant depending only on ε1. Using [\eqref=char2], [\eqref=Ip], [\eqref=Hp] and the fact that the number of summands of the sum [formula] is bounded, we deduce that

[formula]

Now using [\eqref=char22] and Lemma [\ref=gara] with η = 1 / 20, we obtain

[formula]

If [formula] mod 4, then the term E1(p) can be written as a character sum similar to [\eqref=char2] and be estimated by the same method. This leads to the same bound for [formula] as [\eqref=charbound]. Therefore, we obtain

[formula]

which is

[formula]

for every fixed c > 0 if A,B  ≥  xε, as desired. This completes the proof of Theorem 2. Acknowledgment. The author wishes to thank W. Banks and I.E. Shparlinski for bringing their paper [\cite=WDBIES] to my attention. He would further like to thank N.C. Jones and L. Zhao for useful discussions.

Stephan Baier School of Engineering and Science, Jacobs University Bremen P. O. Box 750561, Bremen 28725, Germany Email: s.baier@jacobs-university.de