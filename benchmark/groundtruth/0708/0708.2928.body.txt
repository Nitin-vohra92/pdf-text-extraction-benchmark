2em .5em .5em

48pt 10pt 10mm

Proposition Corollary Lemma Definition

The reciprocity law for the twisted second moment of Dirichlet L-functions

Introduction

For coprime integers h and p > 0, consider

[formula]

where the *   indicates the summation is over all primitive characters (we use similar notation with +   or -   to denote summation over all primitive, even or odd characters).

In a recent paper, Conrey [\cite=Conrey] proved a kind of reciprocity formula relating M(p,h) and M(h, - p) (with both p and h prime), and remarked that such formulas deserve further study. In this paper, we give a different, more direct, proof of the reciprocity formula that incidentally extends its range of uniformity. Conrey showed (see Theorem 10 of [\cite=Conrey]), for certain explicit constants A and B, that

[formula]

which provides an asymptotic formula for [formula] provided h  <  p2 / 3. In this paper we improve the error term above so that the asymptotic formula holds for h  <  p1  -  ε.

For prime p, the sum M(p,h) is related to sums of the type

[formula]

where f is a nice function, and a  =    ±  h. It turns out that S(p,h;f) itself is related to S(h, - p;f). Conrey's reciprocity formula is then a consequence of this relation. It is only for prime p and h that there is such a nice relation between the twisted second moments, but the reciprocity relation for S(p,h;f) and S(h, - p;f) holds for non-prime h and p. Precisely, we have Remarks.

This theorem gives an asymptotic formula for [formula] provided a  <  q1  -  ε.

The reciprocity relation is not self-dual, so it could potentially be used recursively to obtain a curious kind of asymptotic expansion of S(q,a;f).

The conditions on f are natural to require for the purpose of proving Corollary [\ref=coro:reciprocity] and can certainly be loosened.

Remark. We actually obtained a more precise formula with an error term of size [formula] where C  >  0 is arbitrary. See [\eqref=eq:moreprecise] below.

Selberg showed [\cite=Selberg] (for α,β  ≪  ( log q)- 1, α  +  β  ≠  0, say)

[formula]

where

[formula]

q is prime, and (h,k)  =  (hk,q)  =  1. This gives an asymptotic formula provided [formula] and hk max (h2,k2)  <  q1 - ε. In particular, if k = 1, then h can be as large as [formula]

Iwaniec and Sarnak [\cite=IS] showed

[formula]

where L(q) is defined by

[formula]

and

[formula]

where W is a smooth, bounded function of rapid decay. They also gave an average bound for β(h,k):

[formula]

Their application was to prove that 1 / 3 of Dirichlet L-functions do not vanish (nor are too small) at the central point.

I thank Brian Conrey for showing me preliminary versions of [\cite=Conrey] and for various conversations about his work.

Setup

Suppose χ is a primitive Dirichlet character of conductor q. The Dirichlet L-function is defined by

[formula]

The completed L-function

[formula]

satisfies the functional equation

[formula]

where

[formula]

and τ(χ) is the Gauss sum

[formula]

We need For a proof, see [\cite=Sound], Lemma 2. The point of having G vanish at half integers is to cancel the poles of the gamma functions. As an example of an allowable function G, take G(s)  =  es2 cos 2(πs).

To average over primitive characters, we require

Using the approximate functional equation and Lemma [\ref=prop:orthogonality], we obtain In case p is prime then we can simplify the above expression.

Using Lemma [\ref=lemma:avgAFE], we write

[formula]

where

[formula]

and

[formula]

First notice that S'(p,  ±  h;V±)  =  S(p,  ±  h;V±)  +  OC(p- C), since p is prime and V± has rapid decay.

The assumption that G has a double zero at [formula] implies that S'(1,1;V0,p) is small. Precisely, we have

[formula]

Write [formula] and correspondingly write S'(1,1;Vp,p) as the sum of three integrals. The first term is easily seen to be [formula] by moving s to the line - C. The third term is bounded by ≪  p- C by moving s to the right. The second term is

[formula]

It turns out that we can compute this term exactly because the integral is odd under s  →   - s, which can be seen by applying the functional equation

[formula]

Thus the integral is half the residue at s = 0, that is

[formula]

Thus

[formula]

The question presents itself to further analyze the sums S(q,a,x) defined by

[formula]

where (a,q)  =  1. To some extent the sum S(p,h,p) models S(p,h;V+), but better results can be obtained for the smoothed sums.

Upper bounds for S(q,a,x)

In this section we show a method for obtaining upper bounds for the sum S(q,a,x). As a first estimate, we have the following

By Dirichlet's trick,

[formula]

By breaking up the sum over n into arithmetic progressions mod q, we have for any x,y,r,q

[formula]

which upon insertion into [\eqref=eq:dirichlettrick] gives [\eqref=eq:sudoku]. The estimate for SM,N(q,a) is similar.

Remark. This result is essentially best-possible without using more information about a and q, since if a = 1 then there is a main term of size [formula], and of course [formula] is an obvious expected order of magnitude (being the number of terms times the probability of satisfying a congruence mod q.)

Lemma [\ref=lemma:simple] can be improved by further analysis.

We split the sum S(q,a,x) into three pieces depending on if n  =  am, n  >  am, or n  <  am. We have

[formula]

For n  >  am we write n  =  am  +  ql with l  >  0, obtaining

[formula]

For n  <  am we write n  =  am  -  ql, with l  >  0. Then we obtain

[formula]

Estimate [\eqref=eq:waterman] follows by applying Lemma [\ref=lemma:simple] to [formula].

The proof follows by simply noting that the diagonal terms (with n  =  am) contribute [formula].

Asymptotics for S(q,a,f)

In this section we show how to develop an asymptotic expansion for a smoothed sum analogous to S(q,a,x). To that end, define

[formula]

where f is a function satisfying the conditions of Theorem [\ref=thm:mainresult] and X  ≥  1 is a parameter (for the application of proving Theorem [\ref=thm:mainresult] we shall take X  =  q). Write

[formula]

where

[formula]

In the case that f(x)  =  V±(x) (that is the case for our primary application), we have

[formula]

where

[formula]

Note g-(0)  =  0 and g+(0)  =  1, so that [formula] is meromorphic on [formula] with a pole at s = 0 only in the +   case and is entire in the -   case.

The result is Taking X = q gives [\eqref=eq:mainresultplus].

As in the analysis of S(q,a,x), write [formula]. We have

[formula]

for any c  >  0. Moving the line of integration to - A (with A > 0), we obtain a main term from the pole at s = 0, and bounding the new integral trivially gives an error term of size

[formula]

To compute the main term, write

[formula]

Thus we obtain

[formula]

For n  >  am, we have

[formula]

Using the simple approximation

[formula]

(valid for [formula], say) and taking [formula] gives

[formula]

where recall k(y) is given by [\eqref=eq:kdef].

For the terms with n  <  am we again write n  =  am - ql with l  >  0 and [formula]. Thus it becomes

[formula]

Using the Mellin transform, we obtain

[formula]

Writing [formula] gives

[formula]

where

[formula]

and

[formula]

Note

[formula]

Now we bound E. If nl  ≥  q- 1aX(qX)ε then moving c arbitrarily far to the right shows that these terms contribute a negligible amount to E. For the remaining terms we move c to ε and use the approximation [\eqref=eq:MVI] again, obtaining

[formula]

Now break up the sums over n and l into dyadic segments N  <  n  ≤  2N, L  <  l  ≤  2L and apply Lemma [\ref=lemma:simple] to obtain

[formula]

The worst case is where [formula] and [formula], whence

[formula]

Combining [\eqref=eq:diag], [\eqref=eq:nbig], [\eqref=eq:MT] and [\eqref=eq:E] completes the proof.

Asymptotics for S(q, - a,f)

In this section we consider the problem of understanding

[formula]

for 0  <  a  <  q. The naïve idea of replacing - a by q - a and using Theorem [\ref=thm:reciprocityAF] does not give a good result for a  <  q1 - ε. Rather, we apply similar yet slightly different methods as in Section [\ref=section:asymptoticplus] to prove the following Taking X = q gives [\eqref=eq:mainresultminus].

Write n  +  am  =  ql and split the sum into two pieces, say S(q, - a;f,X)  =  S1(q, - a;f,X)  +  S2(q, - a;f,X), where S1 corresponds to the terms with n  <  am (that is, n  <  ql / 2) and S2 corresponds to the terms with n  ≥  am (that is, m  <  ql / (2a)). We treat each sum differently.

The sum S2(q, - a;f,X) is treated similarly as in the proof of Theorem [\ref=thm:reciprocityAF] so we shall be brief where the details are similar. We write n  =  ql - am and obtain

[formula]

Since [formula], we have [formula], for [formula]. Thus we obtain

[formula]

Extending the summation to all m  >  0 does not introduce a new error term, so we obtain

[formula]

Now we compute S1. Following the details of the computation of [formula] in the proof of Theorem [\ref=thm:reciprocityAF], we obtain

[formula]

where

[formula]

and E has the same bound as [\eqref=eq:E]. Extending the sum to n  ≥  ql / 2 introduces an error of size

[formula]

using Lemma [\ref=lemma:simple]. Thus

[formula]

Combining [\eqref=eq:S2] and [\eqref=eq:S1] completes the proof.

Deduction of Corollary [\ref=coro:reciprocity]

In this section we briefly deduce Corollary [\ref=coro:reciprocity] from Theorem [\ref=thm:mainresult]. By Lemma [\ref=lemma:summary], we write

[formula]

Then by Theorem [\ref=thm:mainresult], we have

[formula]

We compute

[formula]

[formula]

and

[formula]

the preceding integral having been computed in the proof of Lemma [\ref=lemma:summary]. Hence we obtain

[formula]

Applying Lemma [\ref=lemma:summary] again, we obtain

[formula]

Putting everything together, we obtain

[formula]

which simplifies slightly to

[formula]

By allowing an error term of size [formula], the formula becomes

[formula]

using the simple bound |M(h, - p)|  ≤  M(h,1)  ≪  h log h.