plus .25ex minus .25ex

Lemma Conjecture Proposition Definition Corollary Example Algorithm

=

On the Gröbner complexity of matrices

Introduction

In this paper we deal with Graver bases and universal Gröbner bases associated to a matrix. The Graver basis of [formula] is defined as the union

[formula]

of the inclusion-minimal Hilbert bases Hj of the pointed rational polyhedral cones

[formula]

as [formula] ranges over all 2n orthants of [formula] [\cite=Graver:75]. Moreover, we call

[formula]

the toric ideal associated to A, and for a given term ordering [formula], we call [formula] a minimal reduced Gröbner basis of A with respect to [formula], if [formula] is a minimal reduced Gröbner basis of IA with respect to [formula]. By U(A) we denote the universal Gröbner basis of A, being the union over all minimal reduced Gröbner bases of A. Note that one can show that the relation [formula] holds for any term ordering [formula]. In particular, U(A) is finite.

In [\cite=Santos+Sturmfels], Santos and Sturmfels dealt with the question of how complex or complicated the Graver bases of the matrices

[formula]

become as [formula] grows. For a vector [formula] with [formula] for [formula], we call [formula] the layers of x. Moreover, we call the number |{i:xi  ≠  0}| of nonzero layers of x the type of x. With these notions, Santos and Sturmfels showed that there is a constant g(A), depending only on A but not on N, such that the types of the Graver basis elements of A(N) are bounded by g(A) for all N. They coined the notion "Graver complexity" for this constant g(A). Moreover, they presented an algorithm to compute g(A), with which they computed the Graver complexity of the matrix [formula] defining the twisted cubic, which is 6, and the Graver complexity of the matrix A3  ×  3 defining the 3  ×  3 transportation polytope, which is 9. Already the next bigger case of 3  ×  4 transportation polytopes was left open.

In this paper, we consider the analogous notion of Gröbner complexity u(A) of A as the maximal type of an element in U(A(N)) for all N. By the results of [\cite=Aoki+Takemura] and [\cite=Santos+Sturmfels], we have 5  ≤  u(A3  ×  3)  ≤  9. Boffi and Rossi [\cite=Boffi+Rossi] proved that the maximal type of a vector appearing in any lexicographic Gröbner basis of A(N)3  ×  3, N  ≥  5, is 5. This left open the question whether there exist other term orderings such that the corresponding Gröbner bases contain a vector of type 6, 7, 8, or 9.

In Section [\ref=Section:_Proof_of_main_theorem], we prove our main result of this paper. In fact, with Lemma [\ref=Lemma:_Main_lemma], we even prove a deeper structural result on U(A(N)), from which Theorem [\ref=Theorem:_Main_theorem] follows by the results in [\cite=Santos+Sturmfels].

Let [formula]. If the universal Gröbner basis U(A) and the Graver basis G(A) coincide, then u(A) = g(A), that is, Gröbner complexity and Graver complexity of A are equal.

Note that we do not claim that the universal Gröbner bases and the Graver bases of A(N) are the same for each N. In fact, we leave this as an open question that remains to be clarified. Our theorem has a few nice consequences. For example, as U(A) = G(A) whenever A is a unimodular matrix, we get the following nice fact.

For unimodular matrices, Gröbner complexity and Graver complexity are equal.

In particular, this implies u(A3  ×  3) = g(A3  ×  3) = 9. In fact, in Section [\ref=Section:_3x3] below, we explicitly state elements in U(A(9)3  ×  3) of types 6, 7, 8, and 9, together with term orderings for which these elements appear in the corresponding Gröbner bases. It comes as a little surprise that there are indeed elements in U(A(9)3  ×  3) that are more complicated (= have a bigger type) than the elements in any lexicographic Gröbner basis of A(9)3  ×  3.

In Section [\ref=Section:_3x4], we consider the case of A3  ×  4 and show the following. Note that u(A3  ×  4) = g(A3  ×  4) already follows from Corollary [\ref=Corollary:_Unimodular_matrices], as A3  ×  4 is unimodular.

For A3  ×  4, we have u(A3  ×  4) = g(A3  ×  4)  ≥  27.

In fact, we conjecture this bound to be tight, that is, u(A3  ×  4) = g(A3  ×  4) = 27.

Finally, in Sections [\ref=Section:_A_a] [\ref=b] and [\ref=Section:_2c-conjecture], we show the following result.

Let [formula] and [formula]. Then u(Aa,b) = g(Aa,b) = 2(a + b) /  gcd (a,b).

Consequently, for a = 1 and b = 2, we conclude that Gröbner complexity and Graver complexity of the matrix defining the twisted cubic both equal 6. To prove Lemma [\ref=Lemma:_A_a] [\ref=b_lemma], we first show the inequality g(Aa,b)  ≥  u(Aa,b)  ≥  2(a + b) /  gcd (a,b) in Section [\ref=Section:_A_a] [\ref=b]. Then, in Section [\ref=Section:_2c-conjecture], we show that in fact g(Aa,b) = 2(a + b) /  gcd (a,b), finally settling an open problem from [\cite=Nairn:PhD-thesis].

Proof of main theorem

Let us now prove Theorem [\ref=Theorem:_Main_theorem]. In fact, we show a stronger result from which the statement of Theorem [\ref=Theorem:_Main_theorem] follows immediately by the results of [\cite=Santos+Sturmfels].

Let [formula] and let [formula] denote the elements in the universal Gröbner basis of A. We assume that U(A) is symmetric, that is, if g∈U(A) then also - g∈U(A).

Let [formula] be the coefficient vector of a minimal nonnegative integer relation among [formula], that is, [formula]. With [formula], the vector x∈ ker (A(s)) shall denote an arrangement of λ1 layers g1, λ2 layers g2, and so on, in any arbitrary but fixed order. Then each such vector x belongs to U(A(s)).

Proof. For each gi∈U(A), let Fi denote the polyhedron [formula]. For each gi∈U(A) there exists some vector [formula] and some number [formula] such that the inequality [formula] defines an egde of Fi with edge direction gi. In fact [formula], see [\cite=Sturmfels+Thomas:97].

Now consider the vector [formula] formed out of λ1 copies of c1, λ2 copies of c2, and so on, in the same order of indices as x was formed. Then, by construction, [formula] is a valid inequality of the polyhedron [formula] and hence defines a face F of it. Again by construction, any lattice point on this face F can only have λi layers (in total) of g+i and g-i for each [formula], as otherwise any strict (face defining) inequality for some layer would imply the relation [formula] for the whole vector.

Now assume that for a lattice point y of F, we choose μ1 layers g+1 and λ1  -  μ1 layers g-1, μ2 layers g+2 and λ2  -  μ2 layers g-2, and so on, in the same order of indices as in x. Thus, as y∈F, we have [formula]. Consequently, we get [formula]. This is a contradiction to the minimality of λ unless μ = 0 or μ  =  λ. Consequently, F contains only two lattice points, namely x+ (for μ  =  λ) and x- (for μ = 0). Thus, F is an edge of P with edge direction x. Therefore, x belongs to U(A(s)), see [\cite=Sturmfels+Thomas:97]. [formula]

Let now U(A) = G(A). Then, by the results of [\cite=Santos+Sturmfels], any element in G(A(g(A))) of maximal type corresponds to a vector x as described in Lemma [\ref=Lemma:_Main_lemma]. Thus, Theorem [\ref=Theorem:_Main_theorem] is proved, too.

Elements in [formula] of types 6,7,8, and 9

In this section, we present elements [formula] of types 6,7,8, and 9. The nonzero layers of the four elements [formula] are

[formula]

Note that due to the underlying symmetry of the problem matrix A(9)3  ×  3, any arrangement of these 6, 7, 8, or 9 layers together with sufficiently many zero layers gives an element in [formula]. Fix any such arrangement, for example first using the first layer type, then the second layer type, and so on, and call the resulting vectors x6, x7, x8, and x9. By Lemma [\ref=Lemma:_Main_lemma], x6, x7, x8, and x9 belong to [formula]. Valid inequalities defining the edges [formula] of [formula], j = 6,7,8,9, are given by [formula].

One may now ask what term ordering one has to choose to obtain x6, x7, x8, or x9 as a Gröbner basis element. For this, one may use [formula], j = 6,7,8,9, as cost vector and any term ordering to break ties. Herein, ei denotes as usual the i-th unit vector. For example, for j = 9, using the [formula] function of 4ti2 (version 1.3.1) and the default degrevlex ordering (of 4ti2) for tie-breaking, one obtains the 218,785 vectors in the corresponding Gröbner basis within 51 minutes on an AMD Opteron 2.4 GHz CPU running SuSE Linux 10.0.

Proof of u(A3  ×  4) = g(A3  ×  4)  ≥  27

In this section, we present an element [formula] and thus prove that u(A3  ×  4) = g(A3  ×  4)  ≥  27. The nonzero layers of [formula] are

[formula]

Again, due to symmetry, the actual arrangement of the 27 layers is not important. Thus, we may again assume that we first use the first layer type, then the second layer type, and so on, and call the resulting vector x27. To show that indeed [formula], one only has to check that x27 is given by a minimal relation among the elements in U(A3  ×  4) = G(A3  ×  4) as required by Lemma [\ref=Lemma:_Main_lemma]. This is a feasibility problem in only 7 integer variables, which can easily be solved using the zsolve function of 4ti2 or, with a bit more work, even by hand.

Proof of g(Aa,b)  ≥  u(Aa,b)  ≥  2(a + b)

In this section, we prove g(Aa,b)  ≥  u(Aa,b)  ≥  2(a + b) /  gcd (a,b). In the next section, we show that in fact equality holds, implying Lemma [\ref=Lemma:_A_a] [\ref=b_lemma]. Let us remind the reader that 1  ≤  a < b are positive integers and we consider the matrix [formula]. Note that we may divide the second row of Aa,b by gcd (a,b) without changing the integer kernel of the matrix. Thus, we may without loss of generality assume a and b to be coprime. In order to prove g(Aa,b)  ≥  u(Aa,b)  ≥  2(a + b) using Lemma [\ref=Lemma:_Main_lemma], we first prove that [formula], [formula], and [formula] belong to U(Aa,b).

Let us first consider [formula] and the face of [formula] defined by the valid inequality y3  ≥  0. The linear system defining this face reads

[formula]

with nonnegative integers [formula]. Eliminating y3 and subtracting a times the first equation from the second equation, we obtain the equivalent system

[formula]

As gcd (a,b) = 1 and since 0  ≤  y1,y4  ≤  a + b, by the first equation, we conclude that the second equation has only two solutions y1 = 0,y4 = 0 and y1 = b,y4 = a. In the first case, we obtain y2 = a + b and in the second case y2 = 0. Thus, the face under consideration is [formula] and hence x∈U(Aa,b).

For [formula], the arguments are similar (due to the symmetry in a and b). Hence again x∈U(Aa,b).

For [formula], the proof is a bit more complicated. Let us consider the face of [formula] defined by the valid inequality (a - 1)y3 - y4  ≥  0. Below, we will see that (a - 1)y3 - y4  ≥  0 is indeed valid. The defining linear systems reads

[formula]

with nonnegative integers [formula]. Subtracting a times the first equation from the second equation, we obtain the equivalent system

[formula]

As gcd (a,b) = 1, we conclude from the second equation that a(y1 + y3) and thus also y1 + y3 is divisible by b. Since a < b, we conclude from the first equation that either y1 + y3 = 0 or y1 + y3 = b. In the first case, we obtain y1 = y3 = y4 = 0,y2 = a + b - 1, and in the second case, we easily get [formula] as the solutions for [formula]. This proves that the inequality (a - 1)z3 - z4  ≥  0 is indeed valid for the fiber [formula]. Moreover, our discussion shows that it defines the face [formula]. Therefore, we conclude x∈U(Aa,b).

Finally, to prove g(Aa,b)  ≥  u(Aa,b)  ≥  2(a + b) using Lemma [\ref=Lemma:_Main_lemma], let us consider the vector x from [formula] given by the following 2(a + b) layers

[formula]

Again, the actual arrangement of these layers is not important due to the symmetry underlying A(2a + 2b)a,b.

One easily checks that this relation of three elements in U(Aa,b) is indeed minimal. Clearly, there is no relation among only two of the elements. Thus, [formula] has to be used once and therefore, looking at the third coordinate, [formula] has to be used a + b times. Consequently, the coefficient of the vector [formula] is a + b - 1, and we obtain the initial relation which is thus minimal. Therefore, by Lemma [\ref=Lemma:_Main_lemma], [formula] and hence g(Aa,b)  ≥  u(Aa,b)  ≥  2(a + b).

Proof of g(Aa,b) = 2(a + b)

In this section we show the following.

If 1  ≤  a < b are coprime integers, then g(Aa,b) = 2(a + b).

In order to compute g(Aa,b) via the construction from [\cite=Santos+Sturmfels], we need to first compute the Graver basis of Aa,b and write down its elements as the columns of a new matrix Ga,b. (Note that, as G(Aa,b) is symmetric, we only need to choose one vector out of each pair g, - g∈G(Aa,b). See [\cite=Santos+Sturmfels] for more details.) Then g(Aa,b) is equal to the maximum 1-norm of the vectors appearing in the Graver basis G(Ga,b). Let us start by presenting the Graver basis of Aa,b.

Let [formula] and [formula]. Then we have

[formula]

Proof. To show our claim, we only need to check the criteria of Lemma 2 in [\cite=Hemmecke:PSP]: v and h do indeed generate ker Z(Aa,b) over [formula], the set G(Aa,b) is indeed symmetric (that is g∈G(Aa,b) implies - g∈G(Aa,b)), and for each choice of g1,g2∈G(Aa,b), the vector g1 + g2 can be written as a sign-compatible positive integer linear combination of elements in G(Aa,b). Due to the simple structure of G(Aa,b), the latter requires only an easy case study on the possible sign patterns of g1 + g2. [formula]

Now we need to find the maximum 1-norm among the vectors in the Graver basis of the matrix [formula]. The following lemma tells us that we may consider the matrix [formula] instead.

If 1  ≤  a < b are coprime integers, then [formula].

Proof. First note that [formula]. Now let [formula]. Since v and h are linearly independent (they generate ker Z(Aa,b) over [formula]), we conclude

[formula]

[formula]

It remains to show the following fact. Our claim g(Aa,b) = 2(a + b) will then follow immediately. Note that this lemma proves the 2c-conjecture from [\cite=Nairn:PhD-thesis], Corollary [\ref=Corollary:_2c-conjecture].

The maximum 1-norm of a vector appearing in the Graver basis of the matrix [formula] is 2(n - 1).

Proof. Let x∈ ker (An) with xn + 1  ≥  0. Then we can translate x uniquely into a relation among the numbers [formula] of the form [formula], with ai  ≠  bj for [formula], where for [formula], xt counts the number of occurrences of ai = t minus the number of occurrences of bi = t, and where we have l = xn + 1. Vice-versa, we can translate any relation [formula] uniquely back into a vector x∈ ker (An) by simple counting.

Assume now that x∈G(An). This implies that there does not exisst a non-trivial sub-identity [formula] in [formula], as otherwise the corresponding vector of counts would contradict the minimality of x.

Without loss of generality, we may assume that [formula] and [formula]. Now define δi = ai - bi, [formula]. Note that there cannot exist a sub-identity [formula] of [formula], since then [formula] would contradict the minimality of [formula]. Thus, by bringing all negative values δi to the right-hand side of the relation, we obtain a primitive partition identity [formula]. By Corollary 1 in [\cite=Diaconis+Graham+Sturmfels], we obtain for our primitive partition identity the bound k + l  ≤  Δ+  +  Δ-, where Δ+  =   max {δi:δi > 0}  ≥  1 and Δ-  =   max {  -  δi:δi < 0}  ≥  1.

The remainder of our proof follows nearly literally the proof of Theorem 3 in [\cite=Diaconis+Graham+Sturmfels]. For the benefit of the reader, we include these few lines here. Let i0 and j0 be such that bi0 - ai0  =  Δ- and aj0 - bj0  =  Δ+. Now we distinguish two cases.

If i0 < j0, then

[formula]

If i0 > j0, then

[formula]

In both cases, we obtain Δ+  +  Δ-  ≤  n - 1. Consequently,

[formula]

Finally, we should mention that this upper bound is tight, since 1  ·  1 - (n - 1)  ·  (n - 1)  +  (n - 2)  ·  n = 0 corresponds to the minimal vector e1 - (n - 1)e(n - 1) + (n - 2)en in G(An). [formula]

The maximum 1-norm of a vector appearing in the Graver basis of the matrix [formula] is 2c.

Proof. Note that [formula] and thus [formula] Now apply Lemma [\ref=Lemma:_2n-2_bound]. [formula]

Applying this corollary to our matrix G(Aa,b), we conclude that g(Aa,b) = 2(a + b), and Lemma [\ref=Lemma:_g=2a+2b] is proved. Consequently, u(Aa,b) = g(Aa,b) = 2(a + b), as claimed in Lemma [\ref=Lemma:_A_a] [\ref=b_lemma].