=1

A subset solution to the sign problem in random matrix simulations

Introduction

Our knowledge about QCD at finite baryon density is scarce, mainly because dynamical simulations at nonzero chemical potential are severely hindered by the sign problem, see Ref. [\cite=deForcrand:2010ys] for a review. The problem arises because the fermion determinant becomes complex and can no longer be included in the probabilistic weight in importance sampling methods. At small chemical potential the problem is mild and can be circumvented with methods, like reweighting, Taylor expansions and analytic continuation from imaginary to real chemical potential [\cite=deForcrand:2010ys]. The cost of these methods typically grows exponentially with the volume and the chemical potential, such that they quickly become unusable. For some specific models, tailor-made approaches were proposed which weaken or sometimes even solve the sign problem [\cite=Chandrasekharan:2009wc] [\cite=Wenger:2008tq] [\cite=Aarts:2009uq] [\cite=Bringoltz:2010iy] [\cite=Mercado:2011ua].

Because of the equivalence between QCD in the ε-regime and the microscopic limit of chiral random matrix theory (RMT) [\cite=Osborn:1998qb] [\cite=Toublan:1999hx] [\cite=Basile:2007ki], useful spectral information about the Dirac operator in QCD can be gained from RMT, both at zero and nonzero chemical potential. RMT models for QCD at finite density where proposed by Stephanov [\cite=Stephanov:1996ki] and Osborn [\cite=Osborn:2004rf]. These models not only allow the computation of the densities of complex eigenvalues of the Dirac operator [\cite=Splittorff:2003cu] [\cite=Osborn:2004rf] [\cite=Akemann:2004dr], which were successfully verified in quenched lattice simulations [\cite=Akemann:2003wg] [\cite=Bloch:2006cd] [\cite=Akemann:2007yj], but they also enable the study of the average phase of the fermion determinant [\cite=Splittorff:2006fu] [\cite=Splittorff:2007ck] [\cite=Bloch:2008cf] [\cite=Lombardo:2009aw] [\cite=Bloch:2011jk], which characterizes the severity of the sign problem in dynamical simulations. Moreover, the relation between the strongly oscillating spectrum, the sign problem and the chiral condensate at nonzero chemical potential was investigated, and a new mechanism was proposed to explain chiral symmetry breaking at finite chemical potential, which fundamentally differs from the Banks-Casher solution at zero chemical potential [\cite=Osborn:2005cy] [\cite=*Osborn:2005ss] [\cite=Osborn:2008jp]. At the same time this mechanism solves the Silver Blaze puzzle [\cite=Cohen:2003kd] [\cite=*Cohen:2004qp], as subtle cancellations ensure that thermodynamic observables are independent of the chemical potential below the nuclear matter threshold.

The aim of our work was to develop an importance sampling Monte Carlo method to simulate the dynamical partition function of random matrices, without using additional analytical input. One of the motivations is to learn from numerical solutions to the sign problem in simpler models to make progress in the solution of the sign problem in QCD.

We herein give a detailed report of a subset solution to the sign problem in dynamical simulations of the two-matrix model of Osborn at nonzero chemical potential [\cite=Osborn:2004rf], which we first proposed in an earlier letter [\cite=Bloch:2011jx]. The principal feature of the method is the construction of subsets of matrices which have real and positive weights, but whose cardinality only grows linearly with the volume. This positivity was stated in the initial letter and its proof is given in full herein.

The positive weights allow the use of importance sampling to construct a Markov chain of subsets, distributed according to the random matrix partition function. These subset samples were used to compute observables, like the chiral condensate and the average quark number density. The errors on the measurements clearly show that the new method is free of sign problem. This strongly contrasts with the results of standard reweighting methods, where the exponential blowup of the errors clearly signals the existence of the sign problem and leads to the failure of these methods.

Interestingly, the statistical error on the average reweighting factors, which drives the sign problem in the reweighting methods, is a quantity that can also be computed using the subset method. This allowed for a quantitative determination of their exponential increase and for a comparison of various reweighting schemes.

We further illustrate that the subset method remains efficient in the parameter region where large oscillations in the Dirac spectrum are crucial to get the correct value for the chiral condensate [\cite=Osborn:2005cy] [\cite=*Osborn:2005ss] [\cite=Osborn:2008jp]. Moreover, we show how the subset method resolves the Silver Blaze puzzle in the microscopic limit of the RMT model, where it is equivalent to QCD in the ε-regime.

Other approaches based on partial integrations or summations were considered in Refs. [\cite=Gocksch:1988iz] [\cite=Kieu:1993gw] [\cite=Anagnostopoulos:2001yb] [\cite=Ambjorn:2002pz] [\cite=Fodor:2007vv].

This paper is composed as follows. In Sec [\ref=sec:rmt] we introduce the random matrix model. In Sec. [\ref=sec:subset] we present the subset method and give the positivity theorem, which allows for its use in Monte Carlo simulations. In Sec. [\ref=sec:results] we compare the numerical results for the chiral condensate and the quark number density obtained with the subset method and with standard reweighting methods, and explicitly compute the reweighting factors occurring in the latter. In Sec. [\ref=sec:discussion] we discuss some implications of the positivity relation and show how the subset method resolves the Silver Blaze puzzle in the microscopic limit of RMT. Finally, we conclude in Sec. [\ref=sec:Conclusions]. In the appendix we give a proof of the positivity theorem, details on the numerical implementation, an overview of reweighting and some analytical RMT formulae. We also show how the Silver Blaze can be realized away from the microscopic limit.

Random matrix model

In the two-matrix model of Osborn [\cite=Osborn:2004rf] the complex matrices φ1 and φ2 of dimension (N + ν)  ×  N are distributed according to the unquenched partition function

[formula]

where the integration is performed over the real and imaginary parts of all matrix entries. The weights consist of a Gaussian part and a fermionic part originating from the Nf dynamical quarks with masses mf. Each random matrix has a Gaussian weight

[formula]

where [formula] and we will adopt the convention γ = 1 to conform with the standard discussions of this random matrix model. An alternative choice for γ will be briefly discussed in Sec. [\ref=sec:discussion]. Each fermion flavor contributes to the partition function with the determinant of its Dirac operator, which in this two-matrix model is given by

[formula]

for a fermion of mass m at chemical potential μ (D has ν zero modes for m = 0, where ν  ≥  0 without loss of generality). In the presence of a chemical potential the fermion determinant becomes complex, such that the fermion weights can no longer be included in the probability distribution used in importance sampling Monte Carlo simulations. Standard solution methods used to circumvent this issue typically suffer from the sign problem, as the work needed to make reliable measurements on the statistical ensemble grows exponentially with the volume [\cite=deForcrand:2010ys].

Subset method

Below we present a method, first introduced in Ref. [\cite=Bloch:2011jx], which avoids the sign problem in dynamical simulations of random matrices. The main idea is to gather matrices into subsets which have net real and positive weights in the partition function [\eqref=partfun].

The subsets are constructed as follows: For any configuration Φ = (φ1,φ2) we consider a set of configurations

[formula]

where Ψ(Φ;θn) = (ψ1,ψ2) are orthogonal rotations of the seed configuration Φ defined as

[formula]

The initial motivation leading to the construction of the subsets using orthogonal rotations can be found in Ref. [\cite=Bloch:2011jx]. The product w(ψ1)w(ψ2) is independent of θ under the orthogonal rotation [\eqref=tphi], such that all the configurations in a subset Ω have the same Gaussian weight, which we denote as W(Ω).

The random matrix partition function [\eqref=partfun] can then be rewritten as an equivalent integral over subsets Ω defined in [\eqref=subset], such that

[formula]

where the fermionic subset weight, for Nf degenerate quarks of mass m, is given by the sum of complex determinants,

[formula]

with [formula]. The subset partition function [\eqref=Zsubset] is equivalent to the random matrix partition function [\eqref=partfun] as each configuration Φ = (φ1,φ2) of the random matrix ensemble can be used as seed of the corresponding subset Ω(Φ), defined in Eq. [\eqref=subset], and the set of all subsets forms an Ns-fold covering of the original random matrix ensemble.

The success of the method is based on the following positivity theorem: For any Ω constructed according to [\eqref=subset], and for arbitrary μ < 1 and mass m, the fermionic subset weight σΩ(μ,m) defined in [\eqref=sigma], i.e., the sum of fermionic determinants of the Ns configurations Ψ(Φ;θn), is real and positive if Ns  >  NfN.

This theorem immediately follows from the identity

[formula]

which holds for any μ and m if and relates the fermionic subset weight at chemical potential μ and mass m to the subset weight at zero chemical potential and effective mass [formula]. When looking at the right-hand side of Eq. [\eqref=conjectmneq0], we observe that for zero chemical potential and mass [formula] the Dirac matrix generically has ν real eigenvalues mμ and N complex conjugate pairs [formula] with [formula], such that its determinant is positive. Hence, this right-hand side is real and positive for μ  <  1, and so too will be the subset weight σΩ(μ,m) on the left-hand side. For μ > 1 the effective mass becomes imaginary and the subset weights are no longer guaranteed to be of definite sign altogether. In the limit m = 0 (and ν = 0 as the determinant is zero elsewise) the relation becomes

[formula]

for any μ, which is the equation given in Ref. [\cite=Bloch:2011jx]. In that first publication an inequality was given for the case m  ≠  0, which is now replaced by the general identity [\eqref=conjectmneq0].

Note that for μ  =  1 Eq. [\eqref=conject] yields σΩ(1,0) = 0, i.e., the sum of determinants exactly vanishes for μ = 1 and m = 0. This corresponds to maximal non-hermiticity, where the average phase factor and the partition function are exactly zero, and the sign problem is maximal when using traditional solution methods. For nonzero mass, the limit of Eq. [\eqref=conjectmneq0] for μ  →  1 is lim μ  →  1σΩ(μ,m)  =  NsmNf(2N + ν) and all the subsets in the partition function have identical fermionic weights, even though their Gaussian weights W(Ω) will vary.

The detailed proofs of the identities [\eqref=conjectmneq0] and [\eqref=conject] are given in Appendix [\ref=sec:proof].

The positivity implies that the subset weights W(Ω)σΩ(μ,m) can be used to generate subsets of random matrices using importance sampling methods like the Metropolis algorithm. As Ns has to be larger than NfN to ensure positivity, it will be set to its optimal, i.e. smallest possible, value in the simulations, Ns = NfN + 1.

Using a sample of [formula] subsets Ωk, [formula], the expectation value of an observable O in the RMT ensemble is approximated by the sample average

[formula]

where the subset measurement is defined as

[formula]

with Ψn∈Ω and 〈1〉Ω  =  1, and we omit the arguments μ and m from now on when no confusion is possible. The subset measurement is a modified subset average, which takes into account that the subsets are generated with a fermionic weight σΩ, while the individual matrices ought to be weighed by their respective Dirac determinants. In the simulations reported below, the subset weights and subset measurements were computed exhaustively, i.e., the determinants of all Ns configurations in the subset were evaluated numerically and used in Eqs. [\eqref=sigma] and [\eqref=subsetavg].

Numerical results

Chiral condensate and quark number density

We applied the subset method to compute the chiral condensate and the quark number density in the random matrix ensemble, which are given by

[formula]

and

[formula]

respectively, following the derivation in Appendix [\ref=sec:implementation].

Using the block structure of the Dirac matrix [\eqref=Ddef] more efficient formulae can be derived for the numerical evaluation of the fermion determinant, the chiral condensate and the quark number density, which are are given in Eqs. [\eqref=mdet], [\eqref=Simplem] and [\eqref=nimplem], respectively.

The simulations use the Metropolis algorithm to generate subsets Ω according to their statistical weights W(Ω)  σΩ. To compute the fermionic subset weights σΩ the determinants of the Ns matrices in the subset are evaluated numerically and accumulated. It is important to emphasize that, even though the complex determinants fluctuate strongly when the chemical potential and volume increase, there is no sign problem in the computation of the individual subset weights σΩ, as all Ns contributing determinants are added and no statistical sampling is used. The subset weights are computed in a numerical, but deterministic way.

The statistical sampling comes in when the successive subsets are generated in the Markov chain. This happens as follows: Start with a randomly chosen seed configuration and construct the corresponding set Ω0 using Eq. [\eqref=subset]. Assume now that the Markov chain has reached a subset Ωt at Monte Carlo time t, then randomly choose a configuration in the current subset, generate a new configuration by making a random step on each matrix entry, construct the subset corresponding to this new seed configuration, and apply an accept-reject step to the newly proposed subset to generate the subset Ωt + 1. This stepping procedure is repeated until we have generated a large enough sample to perform the desired measurement.

In our simulations, we generated [formula] subsets in each Markov chain, after equilibration was reached. The expectation value of an observable is evaluated by making a sample average of subset measurements, as prescribed in Eqs. [\eqref=avgY] and [\eqref=subsetavg]. Each individual subset measurement is computed as a deterministic sum over Ns contributions. The quantities that fluctuate statistically during the Monte Carlo sampling are the subset measurements [\eqref=subsetavg]. Successive measurements in the Markov chain are correlated and the number of independent measurements is smaller by a factor 2τ, where τ is the integrated autocorrelation time. The statistical errors on the measurements are determined using the standard error formula corrected for these autocorrelations.

To compare the subset method with standard reweighting methods, described in Appendix [\ref=sec:rew], the simulations were repeated using quenched, phase-quenched, μ-quenched and sign-quenched reweighting, which are all expected to suffer from the sign problem [\cite=Bloch:2011jk]. In reweighting methods observables are computed using the ratio [\eqref=reweight], where both numerator and denominator decrease exponentially with increasing volume. The exponential increase of the work comes from the need to compute these exponentially small numbers from a statistical sampling of largely canceling contributions. The reweighting factors, i.e., the denominators in Eq. [\eqref=reweight], will be discussed further in Sec. [\ref=sec:rewfac]. For the simulations with reweighting methods we used [formula] random matrices in the Markov chains, such that the total number of generated matrices is the same as in the subset method. For the sake of clarity, we only show the results of phase-quenched reweighting in the figures below, as its results are representative for the various reweighting schemes.

We performed simulations with one dynamical fermion, i.e., Nf = 1, of mass m = 0.1 / 2N and matrix sizes [formula]. The mass was chosen to be small with respect to the magnitude of the smallest eigenvalue, to ensure that dynamical effects are important.

We measured the chiral condensate given by Eq. [\eqref=eq:cc]. These results were first presented in Ref. [\cite=Bloch:2011jx]. In Fig. [\ref=fig-cc-vs-mu] the condensate is shown as a function of the chemical potential for matrices with sizes N = 2,4,8. We compare the results obtained using the subset method with those from phase-quenched reweighting and with the analytical results of Eq. [\eqref=Stheo]. The data, displayed in the top row, show that the reweighting method fails for smaller and smaller μ2 as the matrix size increases, due to the sign problem. This strongly contrasts with the results of the subset method which are reliable up to much larger values of μ2 and agree with the analytical predictions.

The corresponding relative statistical errors are shown in the bottom row. At very small μ, when the sign problem is not yet tangible, the error on the condensate is somewhat smaller for the reweighting method than for the subset method. This is easily explained by noting that at μ = 0 the determinants are all real and positive, such that importance sampling can be performed on the random matrices themselves. Sampling the partition function using subsets is then evidently somewhat less efficient. This feature persists for small, nonzero μ, but very quickly the exponential growth of the error in the reweighting method, caused by the sign problem, makes the method unusable. At some value of μ the error estimate becomes meaningless, as the reweighting method completely fails. However, for the subset method, the relative accuracy of the measurements is nearly independent of the chemical potential, which confirms the absence of a sign problem and underscores the usefulness of the method.

We also studied how the relative statistical error on the chiral condensate varies as a function of the matrix size N for fixed values of μ2, and show this N-dependence in Fig. [\ref=fig-cc-vs-N] for various values of μ2. For a fixed number of subsets the error in the subset method (top panel) increases approximately as [formula] and is independent of μ (the latter was already observed in Fig. [\ref=fig-cc-vs-mu]). If we fix the number of matrices, rather than the number of subsets, the error will increase with an additional factor [formula] (as the subset size itself grows with N + 1), such that the overall relative error will grow approximately linearly with N. Conversely, to achieve a constant error the number of subsets would have to grow proportionally to N, i.e., the total number of matrices should approximately grow as N2. The bottom plot shows the same quantity for phase-quenched reweighting (on semi-log scale). We observe that the error grows exponentially with N until the reweighting method fails and the error is no longer reliable. Note that for both methods the additional cost for the numerical computation of the determinants is proportional to N3.

Using the same Monte Carlo algorithm we also computed the quark number density given by Eq. [\eqref=eq:qn]. The variation of the number density and its relative statistical error as a function of the chemical potential are shown in Fig. [\ref=fig:qn-vs-mu]. The data in the top row confirm that the reweighting method badly suffers from the sign problem as μ and N increase, while the subset method very nicely reproduces the analytical predictions of Eq. [\eqref=ntheo]. In the bottom row we observe that, for the reweighting method, the magnitude and variation of the error are very similar to that on the chiral condensate and clearly signify a sign problem. However, for the subset method, the behavior of the statistical error not only confirms the absence of a sign problem, but we observe that the relative error is much smaller than in the case of the chiral condensate. Moreover, even at small μ the error of the subset method is three orders of magnitude smaller than for the reweighting method, which is a very different behavior than for the chiral condensate. This surprising feature is due to the small variance of the quark number density over the Markov chain. This small variance can be understood from the results derived later in Sec. [\ref=sec:miclim], where we show that the subset measurement [\eqref=subsetavg] of the number density in this matrix model consists of a constant term, which is identical for all subsets, and a smaller term proportional to the chiral condensate; see Eq. [\eqref=qnrelsubset]. The first term does not contribute to the variance, such that the error on the number density is solely driven by the error on the latter, which explains why it is so small. From this we conclude that the quark number density in this model is especially well sampled by the importance sampling of subsets. The existence of subsets with large constant contribution to the quark number density is an interesting feature that could point to a possible search direction in other theories suffering from the sign problem.

We also measured the quark number density as a function of the matrix size N using the subset method and show the relative error on these measurements in Fig. [\ref=fig:qn-vs-N], for fixed number of sampled subsets. Here again, we only observe a mild dependence of the error on the matrix size, which confirms that there is no sign problem in the subset method.

Spectral decomposition of the chiral condensate

The spectral decomposition of the chiral condensate at nonzero chemical potential is quite remarkable, and the ability of the subset method to cope with this intricacy and reproduce the correct results is yet another test for its viability.

For this investigation we computed the variation of the chiral condensate as a function of the quark mass for a fixed chemical potential, both in the dynamical case (Nf = 1), using the subset method, and in the quenched case. The results are shown in Fig. [\ref=fig:cc-vs-m]. As was shown in Refs. [\cite=Osborn:2005cy] [\cite=Osborn:2005ss] [\cite=Osborn:2008jp] the unquenched chiral condensate has a very different spectral decomposition depending whether the quark mass is outside or inside the cloud of complex eigenvalues of the Dirac operator, which has a width of about 2μ2 [\cite=Akemann:2004dr]. In Fig. [\ref=Fig:spectrum] we show typical spectral densities of the Dirac operator as the mass moves from outside to inside the eigenvalue spectrum. When the mass is outside this cloud, the dynamical spectrum of the Dirac operator is almost identical to that of the quenched case (see leftmost panel of Fig. [\ref=Fig:spectrum]) and the dynamical chiral condensate should be very close to its quenched value. This is confirmed in Fig. [\ref=fig:cc-vs-m], where we observe that both curves fall together when [formula]. When the quark mass enters the cloud of eigenvalues the quenched chiral condensate steadily drops to zero. However, as can be seen in Fig. [\ref=fig:cc-vs-m], the dynamical chiral condensate does not follow this trend and remains large all the way down to microscopically small masses. This peculiar behavior was explained in Ref. [\cite=Osborn:2008jp] by the very large oscillations which emerge in the unquenched eigenvalue spectrum at z =   ±  m when the mass enters the cloud of eigenvalues; see the spectral densities plotted in Fig. [\ref=Fig:spectrum]. Subtle cancellations in these large spectral fluctuations compensate for the decline in the quenched contribution such that the dynamical chiral condensate remains large when the quark mass is inside the cloud of eigenvalues.

Although these cancellations were computed analytically in Ref. [\cite=Osborn:2008jp], it seemed unlikely that the dynamical chiral condensate could be determined to a good accuracy through numerical simulations, at least not in the region where the cancellations are important, as this is exactly where simulations are hampered by the sign problem [\cite=Osborn:2005cy]. Nevertheless, Fig. [\ref=fig:cc-vs-m] clearly shows that the subset method is able to compute the chiral condensate accurately, even in this critical parameter region. The figure illustrates how the unquenched and quenched chiral condensates move apart when the mass enters the cloud of eigenvalues: The dynamical condensate remains large even though the quenched value steadily decreases. The efficiency of the subset method remains unaffected when the mass enters the cloud of eigenvalues and large spectral fluctuations are crucial to the determination of the chiral condensate. A similar mechanism relating the spectral oscillations of the baryon number Dirac operator to the quark number density was recently uncovered [\cite=Ipsen:2012ug].

Reweighting factors

Another quantity that is accessible to the subset method is the average reweighting factor occurring in the denominator of the reweighting formula [\eqref=reweight]. These reweighting factors are important quantities in the study of the sign problem in reweighting methods as they decrease exponentially with increasing volume and chemical potential, and give rise to the exponentially growing error on the measurements.

The average reweighting factor for a target ensemble with complex weight w simulated in an auxiliary ensemble w0 is given by the expectation value [formula], see Appendix [\ref=sec:rew]. The direct computation of this expectation value in the auxiliary ensemble is obviously plagued by the sign problem, as it is precisely at the origin of the problem. However, this expectation value can be rewritten as

[formula]

which means that the reweighting factor in the auxiliary ensemble can be computed as an inverse expectation value in the unquenched ensemble. Although this cannot be evaluated with standard methods, as the unquenched ensemble has complex weights, it can easily be done using the subset method.

The unquenched expectation value r- 1 is then computed as the sample average [\eqref=avgY] of subset measurements [\eqref=subsetavg] of the inverse reweighting factor given by (assuming that the auxiliary weight only modifies the fermionic part of the action)

[formula]

As the auxiliary weights w0 are real and positive, so are the subset measurements [\eqref=rewfacsubset]. Hence, the sample averages [\eqref=avgY] do not involve any cancellations and the average reweighting factor [\eqref=rewfac] can be efficiently determined by the subset method without encountering a sign problem, even though its value becomes exponentially small as the volume increases.

This enables us to compute and compare the reweighting factors for various reweighting schemes, which are summarized in Table [\ref=Table:rewschemes] and briefly described below:

quenched: the configurations are generated by direct sampling of the Gaussian weights; the average reweighting factor is the average fermion determinant in the quenched ensemble,

phase-quenched: the auxiliary ensemble is generated using the magnitude of the complex determinants; the average reweighting factor is the average phase in that ensemble,

μ-quenched or Glasgow scheme: the auxiliary ensemble is generated at zero chemical potential; the average reweighting factor is the average ratio of the determinants at μ and μ = 0 in that ensemble,

sign-quenched: the configurations are generated according to the absolute value of the real part of the determinant; the average reweighting factor is the average sign of this real part in that ensemble. This reweighting scheme minimizes the relative variance of the reweighting factors [\cite=deForcrand:2002pa]; see also [\cite=Bloch:2011jk] [\cite=Hsu:2010zza].

The aim of this measurement was to compute the reweighting factors for these four different schemes using the subset method, as described in Eqs. [\eqref=avgY] and [\eqref=rewfacsubset], in order to verify and compare their exponential decrease when the chemical potential and volume are increased.

First, we verified the accuracy of the method for two-flavor (Nf = 2) phase-quenched reweighting, by comparing the numerical data for the average reweighting factor with the analytical predictions given in Appendix [\ref=sec:averagephase]. The reweighting factor was computed using the subset method, as explained above, and also directly in the auxiliary ensemble. The agreement between the numerical and analytical data is illustrated in Fig. [\ref=fig:phase-Nf=2-vs-mu]. The very rapid decrease of the average phase factor is perfectly reproduced by the simulation data of the subset method, while the direct measurement in the phase-quenched ensemble fails because of the sign problem.

In general, the average reweighting factors in the various reweighting schemes cannot be computed analytically. However, the subset method allows us to access these quantities numerically to good accuracy. We computed the average reweighting factors [\eqref=rewfac] for the four schemes listed in Table [\ref=Table:rewschemes] for one flavor (Nf = 1) and compare the results in Fig. [\ref=fig:rewfac-vs-mu].

These data allow us to pinpoint the onset of the sign problem in the phase-quenched reweighting scheme by first locating the μ-values where the reweighting method breaks down for the chiral condensate and quark number density in Figs. [\ref=fig-cc-vs-mu] and [\ref=fig:qn-vs-mu], and then reading off the corresponding reweighting factors for these μ-values in Fig. [\ref=fig:rewfac-vs-mu]. We find that the breakdown of the reweighting method, due to the sign problem, occurs when the average reweighting factor drops below ≈  0.01.

When comparing the four schemes in Fig. [\ref=fig:rewfac-vs-mu], we observe that the Glasgow scheme has a somewhat larger reweighting factor than the other schemes. Although this could naively be interpreted as hinting at a weaker sign problem, it is in reality only due to the fact that the magnitude of the determinants increases with increasing μ, such that the values w / w0 sampled in the Glasgow scheme are larger in magnitude than those in the other schemes. However, the sign problem is not actually caused by the size of the reweighting factor, but by its relative error, as it is the latter which propagates to every observable through Eq. [\eqref=reweight]. The reweighting factor itself is only an indicator for the sign problem, because an exponentially small value tells us that huge cancellations must take place. To describe the exponential problem quantitatively one has to compute the relative error εr on the average reweighting factor,

[formula]

where

[formula]

is the variance of the reweighting factor in the auxiliary ensemble. The variance involves the second moment of (the real part of) the reweighting factor, which can either be computed directly in the auxiliary ensemble, without encountering a sign problem, or can be computed using the subset method after rewriting it as:

[formula]

In Fig. [\ref=fig:sigma] we show the standard deviation σr on the reweighting factor for the four reweighting schemes, where the second moment M2 is either computed using the subset method or directly in the auxiliary ensemble (the reweighting factor r is always computed with the subset method). We observe that the standard deviation is computed more accurately when M2 is directly calculated in the auxiliary ensemble, except for the μ-quenched ensemble where the subset method is much more accurate. Note that the latter ensemble is the only one where the standard deviation on the reweighting factor substantially grows with increasing chemical potential and volume.

We now merge the results of Figs. [\ref=fig:rewfac-vs-mu] and [\ref=fig:sigma] to compute the relative standard deviation σr / r, which is proportional to the standard error εr of Eq. [\eqref=stderr]. In Fig. [\ref=fig:rewerr-vs-mu] we compare σr / r for the four different reweighting schemes. The exponential problem becomes immediately clear, as the explosive growth of σr / r with increasing μ and N has to be compensated in simulations by sampling an exponentially large number of configurations to reach an acceptable accuracy for these reweighting schemes. The figure shows that, as expected, sign-quenched reweighting is doing slightly better than the other schemes [\cite=deForcrand:2002pa], even though it is closely followed by the phase-quenched scheme. For practical purposes the differences are however not really relevant as all reweighting schemes encounter the sign problem very early on. It is also interesting to note that the quenched reweighting scheme is not really outperformed, as we can generate uncorrelated random matrices by direct sampling of the Gaussian weights (this is specific to random matrices, as the matrix entries are distributed independently). For the other schemes we use the Metropolis algorithm to generate the configurations in the auxiliary ensemble such that autocorrelations have to be taken into account. The somewhat larger relative variance in the quenched scheme can then be compensated by the larger number of independent configurations generated for the same amount of work. On the other hand, the study shows that the Glasgow scheme performs worse than the other schemes.

The quantitative analysis in this section confirmed that the sign problem is strong in all four reweighting schemes, and reliable numerical results can much better be obtained with the subset method, as seen in Sec. [\ref=numsim].

Remark on the Markov chain construction

In our simulations we computed the fermionic subset weights σΩ(μ,m) by evaluating and adding up the Ns complex determinants at nonzero μ. As an alternative, the Markov chain of subsets can be constructed by using the analytic formula [\eqref=conjectmneq0] to compute the sampling weights σΩ(μ,m) from σΩ(0,mμ). In this case one evaluates and sums up the fermionic determinants at μ = 0 and effective mass [formula], and multiplies the sum with the suppression factor (1 - μ2)Nf(N + ν / 2). This sum only involves positive real numbers such that no cancellations take place. The exponential smallness of the weights at large μ and N comes entirely from the suppression factor, which is computed explicitly. As this factor is common to all subsets, it will drop out when taking ratios of probabilities in the Metropolis algorithm, such that it plays no role when generating the relevant subsets of the ensemble. This implies that the relevant subsets at chemical potential μ and mass m are the same as those at μ = 0, albeit at a different, effective mass mμ. Moreover, the relevant subsets are independent of μ in the massless case.

Note, that this only concerns the Markov chain construction. The subset measurements [\eqref=subsetavg] still require the determinants at the simulated μ and m, such that the simulation time will increase when using this alternative way to construct the Markov chain, as the Ns determinants have to be computed both at zero and nonzero chemical potential (the latter can be restricted to the independent subsets in the Markov chain if the autocorrelation times are known).

Discussion

Thermodynamic observables

In this section we will see that Eq. [\eqref=conjectmneq0] allows us to derive some interesting relations for the thermodynamical observables.

For this, we first observe that the relation [\eqref=conjectmneq0] for the subset weights percolates straightforwardly to the partition function, such that

[formula]

This relation agrees with the analytical expression for the partition functions derived using the method of orthogonal polynomials [\cite=Osborn:2008jp] [\cite=Akemann:2002vy].

Using Eq. [\eqref=Zrel] one can relate the chiral condensate at μ  ≠  0 and μ = 0. The chiral condensate for Nf = 1 is defined as

[formula]

and using Eq. [\eqref=Zrel] this can be rewritten as

[formula]

where we also used the chain rule and the definition of the effective mass mμ. This relation agrees with the analytical formula [\eqref=Stheo] for the chiral condensate.

A similar derivation can be performed for the average quark number density defined as (for Nf = 1)

[formula]

This can be rewritten using Eq. [\eqref=Zrel] as

[formula]

where we also used the definition of mμ, the chain rule, and Eqs. [\eqref=ccdef] and [\eqref=sigmarel]. The quark number density can thus be written as a sum of its massless value and a correction term proportional to the quark condensate. This agrees with the analytical formula [\eqref=ntheo] for the number density.

An interesting point is that the relations between the thermodynamic quantities at nonzero and zero chemical potential can also be derived at the subset level. For this, we note that for a thermodynamic observable 〈O〉  =   ∂ log Z  /  ∂q, with q a fermionic parameter, Eq. [\eqref=Zsubset] yields

[formula]

When the subsets are generated according to the sampling weights W(Ω)  σΩ, the subset measurements [\eqref=subsetavg], needed to compute the sample average Eq. [\eqref=avgY], are now being given by

[formula]

We apply this formula to compute the individual subset contributions to the chiral condensate (for Nf = 1), and find

[formula]

where the derivation is analogous to that of Eq. [\eqref=sigmarel]. Similarly we find that the contributions of the individual subsets to the quark number density (for Nf = 1) are given by,

[formula]

where we followed the same steps as in Eq. [\eqref=qnrel]. The subset relation [\eqref=qnrelsubset] is important in the analysis of the statistical error in Fig. [\ref=fig:qn-vs-mu]. All subsets give a large common contribution to the number density, which leads to a small relative variance of the quark number density. Moreover, for m = 0 all subsets give the same contribution to n, and the error on the measurement vanishes for the subset method, i.e., in the massless case a single subset would suffice to compute the correct number density. Note that the large constant contribution to the quark number density is a non-trivial feature of the subset construction, which cannot be identified in the contributions of the individual random matrices.

Microscopic limit and Silver Blaze puzzle

The equations derived above also show how the Silver Blaze puzzle is resolved in the subset method. To be equivalent to QCD the microscopic limit of RMT has to be considered, where   =  2Nm and 2 = 2Nμ2 are kept fixed when N  →    ∞  . In this limit Eqs. [\eqref=sigmarel] and [\eqref=qnrel] lead to

[formula]

where we introduced the microscopic limits

[formula]

The chiral condensate and the quark number density are thus independent of the chemical potential in the microscopic limit of RMT. Even more, following Eqs. [\eqref=sigmarelsubset] and [\eqref=qnrelsubset] we observe that the contribution from each individual subset to the thermodynamic quantities is independent of μ in the microscopic limit, such that the Silver Blaze puzzle is in fact already resolved at the subset level.

Note that the prefactor in [\eqref=conjectmneq0] generates an exponential factor in the microscopic limit of the RMT partition function, as

[formula]

Interestingly, this exponential factor is already generated within each subset individually as it originates from [\eqref=conjectmneq0]. In the RMT model the free energy density is defined as

[formula]

which also becomes independent of μ in the microscopic limit because

[formula]

where we used Eqs. [\eqref=Zrel] and [\eqref=expsup]. Although the factor [\eqref=expsup] does not occur in the partition function of chiral perturbation theory and is an artifact of the random matrix model, it is not relevant when discussing its universal properties, as it leaves the microscopic eigenvalue correlations unchanged [\cite=Halasz:1999gc] [\cite=Ipsen:2012ug].

The subset method also allows a numerical investigation of the convergence towards the microscopic limit, as N  →    ∞   with fixed microscopic parameters [formula] and [formula]. This is illustrated in Fig. [\ref=fig:miclim] where we plot the chiral condensate as a function of the microscopic chemical potential 2 for different values of N. As N increases the chiral condensate converges to its microscopic limit given by Eq. [\eqref=theomiclim].

It is interesting to note that choosing γ = 1 - μ2 (assuming μ  ≤  1) from the onset in the Gaussian weights [\eqref=rmtdis] not only gets rid of the spurious factor [\eqref=expsup], but makes the partition function independent of the chemical potential. This was proven using the method of orthogonal polynomials in Ref. [\cite=Osborn:2004rf], but it also directly follows from the subset relation [\eqref=conjectmneq0] as is shown in Appendix [\ref=app:gamma]. This modification has the salient feature that the Silver Blaze is then satisfied for any N, even away from the microscopic limit. The μ-independence of Z does not, however, alleviate the sign problem of the model, as the fermion determinants still exhibit huge fluctuations when the quark mass enters the cloud of eigenvalues. In fact, we know that these large oscillations are essential to resolve the Silver Blaze puzzle at large chemical potential. The efficacy of the subset method to solve the sign problem remains intact as this choice of γ merely cancels the prefactor in [\eqref=Zrel] and rescales the fermion mass (see Eq. [\eqref=Zgamma]). The results for this γ can easily be related to those previously computed with γ = 1, and therefore we will not present explicit numerical results for this alternative choice. One observation is that the constant contribution to the quark number density [\eqref=qnrelsubset], which becomes large far from the microscopic limit, will cancel out in this case. However, even though their results differ at finite N, both values of γ yield the same universal limit.

Conclusions

In this paper we have presented a solution to the sign problem in dynamical simulations of the two-matrix model of Osborn at finite chemical potential. The random matrices are gathered into subsets, which have real and positive fermionic weights while their cardinality only grows linearly with the matrix size. A detailed proof of the positivity theorem for the subset weights was given.

The positive subset weights make it possible to sample the partition function with an importance sampling Monte Carlo method and generate a Markov chain of relevant subsets. As the chemical potential and the matrix size increase, the weights of the subsets rapidly decrease, but without causing a sign problem in the simulations. In contrast to standard reweighting methods the large cancellations, inherent to simulations at real chemical potential, do not happen through statistical sampling of the ensemble but are confined inside the subsets, where the weights and measurements are computed in a deterministic way from a small number of contributions. The ensuing subset measurements, which are used to compute the sample averages, do not suffer from large statistical fluctuations so that the standard error on the simulation result is well under control.

The method was used to compute the chiral condensate and quark number density accurately over a large parameter range, showing that the subset method has no sign problem, even in regions where the reweighting methods are unusable. The method is especially well suited to compute the quark number density in this model, as the statistical error on this quantity is extremely small, which was understood from analytical considerations.

The subset method also enabled us to compute the reweighting factors, appearing in the standard reweighting methods, and their relative standard errors. This explicitly revealed the exponential increase in the work required by these reweighting methods, signaling the presence of the sign problem.

We also showed how the positivity relation resolves the Silver Blaze puzzle in the microscopic limit of the random matrix model, where it is equivalent with QCD, and how this mechanism already works at the subset level.

The important question whether the subset method can be applied to physical systems and ultimately to QCD itself has not yet been answered and is the focus of current research.

Proof of the positivity theorem

In this appendix we prove the positivity theorem for the subset weights, which is at the basis of the subset method. We first prove the massless relation [\eqref=conject] for a single fermion, before extending it to an arbitrary number of Nf massless fermions. Consequently we generalize the identity to the massive case and prove relation [\eqref=conjectmneq0], first for one massive fermion and finally for Nf fermions with degenerate mass m.

One massless fermion

Using its block structure, the determinant of the Dirac matrix [\eqref=Ddef] for a massless fermion, with ν = 0 or neglecting the zero modes, is given by (see Appendix [\ref=sec:implementation])

[formula]

where we introduce, for brevity, [formula] for a rotated configuration Ψ(Φ;θ) = (ψ1,ψ2) defined in Eq. [\eqref=tphi], and Qθ  =   - BA is an N  ×  N matrix with

[formula]

When expanding the product in Qθ we find

[formula]

and after substituting the definition [\eqref=tphi] this becomes

[formula]

with the N  ×  N matrices [formula], [formula] and [formula]. After gathering the terms in a, b and c this can be rewritten as

[formula]

with

[formula]

which, interestingly, can be further simplified to

[formula]

Using the Leibniz formula for determinants, Eq. [\eqref=detQ] can be written as

[formula]

where [formula] is the antisymmetric Levi-Civita symbol and Qij are the entries of Qθ. Each term in the sum is a product of N matrix components, which, according to Eq. [\eqref=gatherabc], can be written as Qij  =  faaij  +  fbbij  +  fccij. The coefficients fa, fb, and fc, given in [\eqref=fabc], are functions of μ and θ, which are independent of the indices i and j. After expanding all the products in [\eqref=Leibniz] and gathering terms with equal powers of fa, fb and fc, the determinant can be written as

[formula]

where

[formula]

and HNij(a,b,c) is a sum of signed products, each containing i, j and N - i - j components of the matrices a, b and c, respectively, which is implicitly defined by identifying Eqs. [\eqref=Leibniz] and [\eqref=tabc]. The μ and θ dependence of the determinant [\eqref=tabc] is completely contained in the coefficients tNij defined in Eq. [\eqref=t]. Using Eq. [\eqref=fabc] these coefficients can be simplified to

[formula]

where α = N - i + j and β = N + i - j, and thus α  +  β = 2N with 0  ≤  α,β  ≤  2N.

To prove the conjecture [\eqref=conject] it is sufficient to prove that the identity holds term by term in the formula [\eqref=tabc], i.e,

[formula]

for all 0  ≤  i,j  ≤  N, where we denoted the subset summation as

[formula]

with the subset Ω defined in Eq. [\eqref=subset].

To prove Eq. [\eqref=conjecture] we first convert the trigonometric functions in Eq. [\eqref=tij] into complex exponentials using

[formula]

which leads to

[formula]

We apply the binomial formula to expand both powers and find

[formula]

where we also used that α  +  β = 2N. The θ dependence of Eq. [\eqref=tijbinom] is completely contained in the exponential function and its subset sum [\eqref=subsetsum] is

[formula]

where [formula] is an integer ∈[ -  N,N]. SΩ is a sum over the q-th powers of all the Ns-th roots of unity. It can be computed by writing it as a geometric series,

[formula]

We distinguish two cases, depending whether q / Ns is integer or not. For [formula] we have [formula], and the sum of the geometric series is

[formula]

which vanishes as q is integer by definition. If [formula] then [formula] and the sum [\eqref=SOmega] can be computed explicitly,

[formula]

If we take Ns  >  N, the ratio q / Ns will be non-integer and SΩ zero for all q, except for q = 0, as q is an integer varying from - N to N. Hence, when summing Eq. [\eqref=tijbinom] over the subset, only terms for which [formula] will survive. After considering both cases [formula], the subset sum can be written as

[formula]

where

[formula]

with N± = N  ±  |Δ| and Δ = i - j.

As ωij is independent of μ, Eq. [\eqref=I9] immediately implies that

[formula]

Because this relation holds for any i and j in Eq. [\eqref=tabc], it also holds for the sum over these indices, which proves the conjecture [\eqref=conject] for Nf = 1, i.e.,

[formula]

[formula] massless fermions

To extend the theorem to Nf  >  1, the determinant [\eqref=tabc] has to be multiplied Nf times so that many more terms are generated. Nevertheless, after exponentiation the global structure of the fermionic weight remains similar to that of Eq. [\eqref=tabc] and can be written as the following linear combination

[formula]

where tNfNij is defined in Eq. [\eqref=t] and the implicitly defined function Ĥ only depends on the components of the matrices a, b and c, which were defined right after Eq. [\eqref=Dtheta]. The remainder of the proof is identical to that for Nf = 1 with N replaced by NfN, which eventually leads to

[formula]

Together with Eq. [\eqref=tabcNf] this proves the conjecture [\eqref=conject] for arbitrary Nf:

[formula]

One massive fermion

For the massive case we use the determinant block formula [\eqref=mdet],

[formula]

with Qθ  =  m2  -  BA, and A and B defined in Eq. [\eqref=AB]. To prove the conjecture [\eqref=conjectmneq0] for Nf = 1 we first study det Qθ. If we repeat the steps leading to Eq. [\eqref=gatherabc] we now find

[formula]

where fa, fb and fc are defined in [\eqref=fabc]. After using the Leibniz formula [\eqref=Leibniz] and expanding all the products, as we did before when deriving Eq. [\eqref=tabc] for the massless case, we now find

[formula]

where tN - hij is defined in [\eqref=t] and contains the full θ and μ dependence, while H̃ is implicitly defined by [\eqref=A27] and depends on the components of the matrices a, b and c. We can repeat the whole argument of Sec. [\ref=sec:conject_m=0] on the subset sum of the t-coefficients, after replacing N by N - h. In analogy to [\eqref=Tij] this leads to

[formula]

This identity still depends on the summation index h, and after substitution in the subset sum of [\eqref=A27] we find

[formula]

where the last equation is easily derived by inspection, after setting μ = 0 and replacing m by [formula] in Eq. [\eqref=A27]. After multiplying Eq. [\eqref=conjectmassive] with mν and using Eq. [\eqref=detDmum], we find

[formula]

This proves the conjecture [\eqref=conjectmneq0] for Nf = 1: In the massive case the fermionic subset weight at chemical potential μ and mass m is related to the weight at μ = 0 and effective mass [formula]. Note that for μ > 1 the effective mass on the right-hand side becomes imaginary, and the subset weights, although still real, can be either positive or negative, without having a definite sign. Therefore, importance sampling of subsets can only be used for μ  <  1, which is the relevant region when relating the random matrix model to QCD.

[formula] massive fermions

The proof in the previous section can be generalized to an arbitrary number of degenerate flavors, in exactly the same way as was done in Sec. [\ref=sec:Nfneq1] for the massless case. Equation [\eqref=conjectmassive] is then replaced by

[formula]

and after multiplying with mNfν and using Eq. [\eqref=detDmum], we finally find

[formula]

which proves the conjecture [\eqref=conjectmneq0] for arbitrary Nf.

Implementation

Below we describe the numerical implementation of the computation of the determinant, chiral condensate and quark number density. We write the Dirac matrix [\eqref=Ddef] as

[formula]

where [formula] is an (N + ν)  ×  N matrix, [formula] is N  ×  (N + ν) and [formula] is a diagonal N  ×  N matrix.

Determinant.

It is well-known that the determinant of such a block matrix can be computed as

[formula]

when m  ≠  0. Note that this product of determinants cannot be merged as their arguments have different dimensions. This can be simplified to

[formula]

where we defined

[formula]

Note that the factor mν is reminiscent of the ν exact zero modes of the massless Dirac matrix. In the massless case the determinant simplifies to

[formula]

for ν = 0 (or for ν  ≠  0 if we neglect the zero modes). Numerically, det Q was computed using an LU-factorization, as this is more efficient and accurate than using a full diagonalization.

Chiral condensate.

The chiral condensate is given by (for Nf = 1)

[formula]

where we denoted [formula]. The inverse of D can be computed efficiently using its block structure, which yields

[formula]

This formula is easily verified as DD- 1  =  1. When taking the trace of Eq. [\eqref=Dinv] to compute [\eqref=Strace] this can be further simplified as

[formula]

where we also used the definition [\eqref=Q] of Q. The term ν / 2Nm originates from the zero modes of the massless operator and is sometimes omitted. The inverse Q- 1 can be computed using the LU-factorization of Q, which is already available from the evaluation of det Q.

Quark number density.

The average quark number density is given by (for Nf = 1)

[formula]

Using the block-inverse [\eqref=Dinv] this simplifies to

[formula]

Reweighting

Reweighting methods can be used to perform Monte Carlo simulations when the weights are complex and the ensemble cannot be directly sampled with importance sampling.

The ensemble average of an observable y(x) in an ensemble with weights w(x) is defined by

[formula]

In the reweighting method one introduces an auxiliary ensemble with weights w0(x) and rewrites the previous equation as

[formula]

If the weights w0 are chosen to be real and positive, the auxiliary ensemble can be sampled using importance sampling methods and the ratio of expectation values in Eq. [\eqref=reweight] can be evaluated in a Monte Carlo simulation. Typical examples for w0 are the quenched, phase-quenched, μ-quenched and sign-quenched ensembles.

Reweighting methods typically suffer from an overlap problem, when the relevant configurations in the target and auxiliary ensembles do not coincide. More importantly, when the target weight is non-positive one encounters the sign problem, as the work needed to make reliable measurements on the statistical ensemble grows exponentially with volume and chemical potential because it involves the computation of exponentially small reweighting factors [formula] from a statistical sampling of largely canceling contributions [\cite=deForcrand:2010ys].

Some analytical results

In order to verify some of our simulation data, we quote a couple of known analytical results.

[formula] observables

The Nf = 1 partition function Z1 can be expressed in terms of orthogonal polynomials as [\cite=Osborn:2008jp] [\cite=Akemann:2002vy]

[formula]

where LνN are generalized Laguerre polynomials of order ν and degree N. Their derivatives are given by

[formula]

such that the chiral condensate [\eqref=ccdef] is given by [\cite=Osborn:2008jp]

[formula]

The quark number density [\eqref=qndef] can be computed analogously, yielding

[formula]

In the microscopic limit, where   =  2Nm and 2 = 2Nμ2 are kept fixed while taking N  →    ∞   the chiral condensate [\eqref=Stheo] and quark number density [\eqref=ntheo] become

[formula]

where Iν is a modified Bessel function.

Phase-quenched reweighting factor for [formula]

The reweighting factor, i.e. the denominator in the reweighting formula [\eqref=reweight], in the phase-quenched reweighting scheme is nothing but the average phase of the fermion determinant in the phase-quenched ensemble and can be computed analytically for Nf = 2. This average phase can be written as [\cite=Splittorff:2007ck]

[formula]

Both, numerator and denominator are quenched expectation values of products of characteristic polynomials and their complex conjugates, which can be computed analytically using the method of orthogonal polynomials [\cite=Akemann:2002vy]. For random matrices of size N and topology ν this yields,

[formula]

and

[formula]

with orthogonal polynomials

[formula]

and normalization factors

[formula]

Substitution of Eqs. [\eqref=Z2] and [\eqref=Z11*] in Eq. [\eqref=avgphase] yields the average phase in the phase-quenched ensemble.

Silver Blaze at finite N

Below we show that the partition function [\eqref=partfun] can be made independent of μ with a judicious choice of γ in the Gaussian weights [\eqref=rmtdis]. For arbitrary [formula] we rescale the matrices in [\eqref=partfun] using [formula], such that

[formula]

where [formula] and we also took into account the Jacobian of the transformation. The γ-dependence has thus been shifted from the Gaussian weights to the Dirac matrix, and the partition function now looks like a conventional γ = 1 partition function, albeit with a modified Dirac matrix. From the structure of the Dirac matrix [\eqref=Ddef] we see that the scaling of the fields can be shifted to the mass, as

[formula]

Recalling that the Dirac matrix has dimension 2N + ν, the partition function becomes,

[formula]

We now look at the subset sum [\eqref=sigma] of fermion determinants for Nf degenerate quarks in the partition function [\eqref=Zgamma]. Using the relation [\eqref=conjectmneq0] we find that these fermionic subset weights satisfy

[formula]

Clearly, if we choose γ = 1 - μ2 (assuming μ  ≤  1) the right-hand side of [\eqref=sigmagamma] is independent of μ. From Eq. [\eqref=Zgamma] we can then immediately conclude that Eq. [\eqref=Zrel] is now replaced by

[formula]

such that the Silver Blaze is not only satisfied in the microscopic limit, but also for any finite N away from it.