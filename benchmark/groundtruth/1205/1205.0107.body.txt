Lemma Corollary Remark

Areas of triangles and Beck's theorem in planes over finite fields

Introduction

The basic question of Erd os combinatorics is to determine whether a sufficiently large discrete set determines a configuration of a given type. See, for example, [\cite=AP95], [\cite=BMP], [\cite=TV10] and the references contained therein for a description of related problems and their consequences. Perhaps the most celebrated of these is Szemerédi's theorem's which says that a subset of the integers of positive density contains an arithmetic progression of any given length.

In the metric plane, interesting geometric configurations are congruent line segments or triangles. In this context, Guth and Katz ([\cite=GK]) recently resolved the long-standing Erd os distance conjecture ([\cite=E]) in [formula] by proving that a planar set E of n points determines [formula] distinct distances, or, equivalently, distinct congruence classes of line segments.

Another conjecture of Erd os, Purdy, and Strauss ([\cite=EPS]) suggested that a non-collinear set of n points in [formula] determines at least [formula] distinct nonzero triangle areas, the most economical configuration, for an even n, being two parallel copies of evenly distributed [formula] points lying on a line. It was resolved in 2008 by Pinchasi ([\cite=Pi]), yet a linear lower bound was known long before then. Pinchasi also showed that the triangles yielding distinct areas may be chosen to share a common base.

Roche-Newton with the first two listed authors of this paper ([\cite=IRR]) proved that a non-collinear n-point set [formula] generates [formula] distinct triangle areas for triangles OAB, where A,B∈E and O is any origin.

Similar questions have been asked in the higher dimension Euclidean space, and many are still open. See, for example, ([\cite=BMP]) and the references contained therein.

Geometric combinatorics in vector spaces over finite fields has also received much recent attention. Geometric problems in vector spaces over a finite field [formula] can often be effectively resolved using Fourier analysis, provided that the point sets in question are sufficiently large. See e.g. [\cite=G], [\cite=HI08], [\cite=V], [\cite=HIKR11], and the references contained therein.

Fourier techniques have not proven to be particularly efficient for sufficiently small subsets of finite fields, where the fundamental tools come from arithmetic combinatorics, as is demonstrated in a pioneering work of Bourgain, Katz, and Tao ([\cite=BKT]). Unfortunately, quantitative results involving small sets are still far behind their Euclidean prototypes. For instance, the celebrated Beck's theorem ([\cite=Be]), whose finite field version, Theorem [\ref=beckfinitefield] below, is developed in this paper, states that a set of n points in the Euclidean plane, with no more than cn collinear points, with some absolute c, determines Ω(n2) distinct lines drawn through pairs of distinct points. The best currently known exponents, for small sets, are due to Helfgott and the second listed author ([\cite=HR]), who proved that for any [formula] where q is a prime, and [formula], the number of distinct lines is [formula]. The power [formula], added to 1 in the latter estimate has since been improved a few times, implicit in the recent work of Jones ([\cite=J]), but would still remain very far from 1 as it is in Beck's theorem. In this paper we study the distribution of areas of triangles determined by subsets of the finite plane [formula] and draw some conclusions about volumes determined by subsets of [formula]. Here [formula] is the field with q elements and [formula] is the d-dimensional vector space over this field. More precisely, let [formula] denote a (d + 1)-tuple of vectors from [formula]. Given a set [formula], define

[formula]

as the set of d-dimensional nonzero volumes, defined by (d + 1)-simplices whose vertices are in E, as well as for some fixed z∈E, the set of pinned nonzero volumes

[formula]

Note that if [formula], the subscripts referring to the coordinates relative to the standard basis in [formula], an element of Vd(E), generated by the (d + 1)-tuple [formula] equals the determinant of the following d + 1 by d + 1 matrix:

[formula]

Statement of results:

The main result of this note is the following theorem on areas determined by finite subsets of two-dimensional vector spaces over finite fields.

Let [formula]. Then the following hold.

i) Suppose that |E| > q. Then [formula], and the triangles giving at least

[formula] distinct areas can be chosen such that they share the same base.

ii) Suppose that |E|  ≥  64q log 2(q), and q  ≥  C for some absolute C. Then there

exists z∈E such that

[formula]

The claim i) can be viewed as a slightly weaker finite field version of the aforementioned result of Pinchasi in [formula]. Namely, we are off by a constant in the sense that we do not know an example of a set with q + 1 points in [formula], which would not generate all possible q - 1 nonzero areas of triangles. The question of what is the minimum size of [formula] to yield all possible areas in [formula] is open. It seems reasonable to conjecture that |E| = q + 1 would be necessary and sufficient, for any q. The analog of the conjecture in higher dimensions would be that |E| = qd - 1 + 1, necessary and sufficient to yield all possible d-dimensional volumes. In this direction, Corollary [\ref=dveruki] below shows that if |E|  ≥  2qd - 1, then all the possible volumes are determined.

In the context of recent work on sufficiently large sets in [formula], Theorem [\ref=2d] is an improvement over the earlier results [\cite=HI08], [\cite=V1], which established the threshold [formula] in order for a general [formula] to determine Ω(q) distinct areas of triangles.

The claim ii) of Theorem [\ref=2d] follows from the following theorem, which can be regarded as a finite field version of the aforementioned theorem due to Beck ([\cite=Be]), for sufficiently large point sets.

(Beck's theorem in [formula]). Suppose that [formula] with q  ≥  C, for some absolute C, and

[formula]

Then pairs of distinct points of E generate at least [formula] distinct straight lines in [formula]. Moreover, there exists a point z∈E and at least [formula] straight lines incident to z, each supporting at least [formula] and fewer than [formula] points of E, other than z.

It is well known that Fourier analysis yields nearly optimal estimates over finite fields for sufficiently large sets. For instance, Garaev ([\cite=G]) proves an optimal sum-product lower bound for |A + A|    +    |A  ·  A|, when [formula] is such that [formula]. The first quantitative estimate in this direction was proved by Hart, the first listed author of this paper and Solymosi in [\cite=HIS07]. Similarly, in [formula] the "threshold" for what can be regarded as a sufficiently large set E = A  ×  A is usually [formula], and [formula] for general E. See, e.g., [\cite=HI08], [\cite=V1], [\cite=HIKR11], and the references contained therein. Theorem [\ref=beckfinitefield], however, delivers an optimal (up to a constant) estimate for [formula]. Note that the aforementioned estimate [formula] in [\cite=HR] for the number of lines generated by A  ×  A with [formula] (valid only when q is a prime) is strikingly weaker. In the same vein, sum-product results of [\cite=G], [\cite=HIS07], valid for sufficiently large sets are considerably stronger than what is known for small sets, where the best result so far in prime fields is due to the second listed author ([\cite=Ru]), generalised to [formula] by Li and Roche-Newton ([\cite=LRN]).

The construction in Corollary 2.4 in [\cite=HIKR11] implies that if [formula], then there exists z∈E such that |Vz2(E)| = o(q). In particular, this implies that part ii) of Theorem [\ref=2d] cannot be strengthened to say that one gets a positive proportion of the areas from any fixed vertex, which would be somewhat analogous to the above-mentioned Euclidean result of [\cite=IRR]. We do not know whether the logarithmic term in the assumption for part ii) is necessary. It is definitely needed for our proof.

The forthcoming proof of Theorem [\ref=beckfinitefield] is based on Vinh's ([\cite=V]) finite field variant, quoted as Theorem [\ref=vinhkrutoi] below, of the classical Szemerédi-Trotter ([\cite=ST]) theorem on the number of incidences I(E,L) of points in E and lines in L. Vinh's theorem becomes its equal in the strength of exponents only if the underlying sets E,L involved are rather large, that is if one takes |E||L|  ~  q3, which amounts to [formula] in the interesting case when |E|  ~  |L|. Indeed, this is the threshold when the first term in Vinh's incidence estimate ([\ref=vest]) dominates, giving [formula] for the number of incidences, as it is the case in the principal term of the celebrated Euclidean Szemerédi-Trotter estimate. Beck's theorem, however, does not require the full strength of the Szemeredi-Trotter incidence theorem and would already follow if the fact k3 in the denominator of the first term of ([\ref=stb]) below is replaced by k2 + ε for some ε > 0.

In the original paper ([\cite=Be]), Beck had [formula], rather than ε  =  1, provided by the Szemerédi-Trotter theorem as in the estimate ([\ref=stb]) below. In other words, Beck's theorem is weaker than the Szemerédi-Trotter theorem. This is precisely the reason why we can afford to use ([\ref=vest]) and succeed in obtaining a much better threshold |E| = Ω(q log 2q) in Theorem [\ref=beckfinitefield] (rather than [formula]) getting a nearly sharp (up to the endpoint term log 2q) variant of the Beck theorem in the finite plane [formula], as to the minimum size of a set E to generate Ω(q) distinct straight lines.

Theorem [\ref=2d] can be easily boot-strapped to higher dimensions, since if a set determines a certain number of (d - 1)-dimensional volumes when restricted to a (d - 1)-dimensional hyperplane, and on top of that contains at least one point outside of this hyperplane, then it automatically determines at least that many d-dimensional volumes. As a consequence of our method, we obtain the following improvement of a result of Vinh ([\cite=V2]) who proved that if |E|  ≥  (d - 1)qd - 1, d  ≥  3, then [formula].

Let [formula], d  ≥  3.

i) Suppose that |E| > qd - 1. Then [formula].

ii) Suppose that |E|  ≥  2qd - 1. Then [formula].

Proof of part i) of Theorem [\ref=2d]

The core of the forthcoming proof of claim i) follows the lines of Lemmas 2.1 and 2.2 in [\cite=GR], which in turn go back to the "statement about generic projection" in [\cite=BKT], Lemma 2.1.

Let us first show that any set [formula] with |E| > q, determines all possible directions. More precisely, every linear subspace [formula] contains a nonzero element of E - E. This is a finite field analogue of the well-known result of Ungar ([\cite=U]) that 2N non-collinear points in the Euclidean plane determine at least 2N distinct directions.

Let L be a one-dimensional linear subspace of [formula]. Consider the sum set

[formula]

Since [formula], there is an element s∈S with more than one representation as a sum. More precisely,

[formula]

Hence

[formula]

which implies that E determines all possible directions in the sense described above.

Now average the number of solutions of the equation ([\ref=diff]), with (e1,e2,l1,l2)∈E  ×  E  ×  L  ×  L, over the [formula] subspaces L. For each L, the pair (e1,e2), e1  ≠  e2 in ([\ref=diff]) determines the subspace L. Moreover, each l∈L can be represented as a difference l2 - l1 in exactly q different ways. Including the trivial solutions where e1 = e2, we have

[formula]

[formula]

It follows that there exists a subspace L, such that

[formula]

It follows, by the Cauchy-Schwartz inequality, that with this particular L,

[formula]

Indeed, if s∈E + L, and ν(s) is the number of realisations of s as a sum, then

[formula]

and by the Cauchy-Schwartz inequality

[formula]

We conclude from ([\ref=popularity]) that there are points of E in at least [formula] different parallel lines. Moreover one of these lines, as has been shown in the beginning of the proof, has at least two distinct points e1,e2∈E. It follows that E determines at least [formula] distinct triangles, with the same base e1e2 and distinct nonzero heights, that is the third vertex of the triangle lying on different lines parallel to the base. Thus, there are at least [formula] distinct nonzero triangle areas.

Proof of part ii) of Theorem [\ref=2d]

Fourier mechanism

We shall need the following Fourier-analytic result, which is an easy variant of the corresponding estimate from [\cite=HI08] and [\cite=HIKR11].

Let χ be a non-trivial additive character over [formula] and let F(x) for the characteristic function of a set [formula]. Define the Fourier transform [formula] of F(x) as

[formula]

Let [formula]. Suppose [formula]. Let, for [formula],

[formula]

where x  ·  y = x1y1 + x2y2.

Then

[formula]

where

[formula]

with [formula].

To prove the theorem, observe that for any [formula], one has, by the Cauchy-Schwartz inequality:

[formula]

Using the identity

[formula]

one has

[formula]

using the Plancherel identity as well as the fact the assumption that [formula]. This completes the proof of Theorem [\ref=L2].

Finite field variant of the Beck theorem

Here we prove Theorem [\ref=beckfinitefield], a variant of the Euclidean theorem due to Beck ([\cite=Be]) in the finite field context. Recall that Beck's theorem says that either a positive proportion of a set of n points in the Euclidean plane lie on single line, or there exists a constant multiple of n2 distinct lines each containing at least two points of E. Note that Beck's theorem follows easily from the following formulation of the celebrated Szemerédi-Trotter incidence theorem ([\cite=ST]).

Let E be a collection of points in [formula], and L(E) the set of lines determined by distinct pairs of points of E. For k  ≥  2, let Lk  ⊆  L(E) denote the lines supporting at least k points of E. Then there exists C > 0 such that

[formula]

We shall need the following finite field variant of the Szemerédi-Trotter theorem due to Vinh ([\cite=V]).

Let E be a collection of points and L a collection of lines in [formula]. Then

[formula]

Using Lk in place of L in Theorem [\ref=vinhkrutoi], we see that I(E,Lk)  ≥  k|Lk|. It then follows directly from ([\ref=vest]) that if [formula], then

[formula]

This leads us to the proof of Theorem [\ref=beckfinitefield].

Here q is treated as asymptotic parameter, to which the o(1) notation relates. In order to avoid messy notation, let us assume, for convenience, that the quantities q- 1|E|, as well as log 2q are integers. The reader shall see that we have more than enough flexibility with the constants to make this work. The key to our proof is the following assertion.

At least [formula] unordered pairs of distinct points of E are supported on the subset L  ⊆  L(E), defined as the set of all lines in L(E) containing between [formula] and [formula] points of E.

With a slight abuse of the notation, let Lj be the set of lines from L(E), supporting no fewer than q- 1|E|  ·  2j and no more than q- 1|E|  ·  2j + 1 points of E, where j is an integer ranging between 1 and log 2q. The maximum number of points on a line from Lj is q- 1|E|  ·  2j + 1, so the number of unordered pairs of distinct points is smaller than q- 2|E|2  ·  22j + 1. On the other hand, by ([\ref=stb1]),

[formula]

Hence, the number of unordered pairs of distinct points of E supported on any Lj, for j  ≥  2 is bounded by

[formula]

and by 8|E|q for j = 1. Then the number of unordered pairs of distinct points of E supported on the union of Lj, for j  ≥  1 is bounded by 4|E|q(1 +  log 2q). Then, if |E|  ≥  64q log 2q, and q is large enough, the latter bound constitutes only a small proportion of the total number [formula] of unordered pairs of distinct points of E. More precisely, it follows, with the above choice of constants (for q large enough and q = o(|E|)) that the number of unordered pairs of distinct points of E, supported on lines in L(E), each supporting at most 2q- 1|E| points, is at least [formula]

There are only q(q + 1) distinct lines in [formula], so lines from L(E) with fewer than [formula] points (for q large enough and q = o(|E|)) may support fewer than [formula] pairs of distinct points of E. This completes the proof of Lemma [\ref=alabeck].

To complete the proof of Theorem [\ref=beckfinitefield], let l∈L, the set L provided by Lemma [\ref=alabeck], and ν(l) is the number of points of E on l. It follows from Lemma [\ref=alabeck] that

[formula]

Dividing this by the maximum value of ν(l)  ≤  2q- 1|E|, we obtain for the total number of incidences

[formula]

dividing by 2q- 1|E| once more yields the desired bound

[formula]

Returning to ([\ref=ibd]), by the pigeonhole principle, there exists a point z∈E with at least [formula] lines of L passing through it. This completes the proof of Theorem [\ref=beckfinitefield].

Combining Fourier (section [\ref=fouriersubsection]) and Beck (section [\ref=becksubsection]) estimates

We now prove the claim ii) of Theorem [\ref=2d].

Let us refine the initial set E to the set E', containing z, provided by Theorem [\ref=beckfinitefield], and exactly 2q- 1|E| points of E other than z on exactly [formula] lines incident to z. The flexibility in the choice of constants in the proof of Theorem [\ref=beckfinitefield] enables one to treat [formula] as integer. It follows that

[formula]

Now place z to the origin: let E'z = E' - z an apply Theorem [\ref=L2]. More precisely, in the application of the Lemma let [formula] and [formula] Apply the estimate ([\ref=L2estimate]) to the sets F and G. In view of ([\ref=eprlb]) and by Lemma [\ref=alabeck], the quantity [formula], for any x  ≠  0, in the second term of the estimate ([\ref=L2estimate]) is bounded by [formula]. Thus, once more by ([\ref=eprlb]), the second term in the estimate ([\ref=L2estimate]) is dominated by the first one. Indeed, it follows by ([\ref=eprlb]) and the construction of |E'z| that the number of pairs (x,y)∈E'z  ×  E'z, such that x,y lie on the same line through the origin, which is O(q- 1|E|), is o(q- 2|E'z|2). Then the estimate ([\ref=L2estimate]) yields

[formula]

Now the claim ii) of Theorem ([\ref=2d]) follows by the Cauchy-Schwarz inequality in the following way. We have

[formula]

This completes the proof of part ii) of Theorem [\ref=2d].

Proof of Corollary [\ref=dveruki]

We proceed by induction on the dimension. Suppose that part i) holds for the dimension d - 1, d  ≥  3 and part ii) holds for dimension d - 1 with d  ≥  4. The base of the induction for part i) is Theorem [\ref=2d], and for part ii) it is the result of Vinh ([\cite=V2]) that [formula] for [formula] with |E|  ≥  2q2.

Consider now the intersections of [formula] with hyperplanes Hc  =  {x:xd  =  c}. By the pigeonhole principle, there exists c such that [formula] for part i), and [formula] for part ii) of Corollary [\ref=dveruki].

Since Vd(E) is invariant under translations, we may assume that c = 0. In addition, since [formula], there must be a point [formula], which means that [formula].

By the induction assumption the set [formula] satisfies the conclusion of Corollary [\ref=dveruki]. It follows that

[formula]

To verify the latter equality, since xjd = 0 for every [formula], the elements of Vzd(E) are determinants of size d + 1 of the form

[formula]

This completes the proof of Corollary [\ref=dveruki].