Claim Lemma Corollary Proposition Definition Remark

Improved bounds on the set A(A + 1)

Keywords

Sums-products, expander functions, additive combinatorics.

Introduction

Throughout this paper we use Y = O(X), X = Ω(Y) and Y  ≪  X all to mean that there is an absolute constant C with Y  ≤  CX. We also use [formula] to mean that there is an absolute constant c with Y  ≪   log (X)cX.

The well-known sum-product phenomenon says that for a set [formula], at least one of the sum set [formula] and the product set [formula] will be large. Here, 'large' means having cardinality [formula] for some absolute δ > 0. The best-known exponent when A is a subset of [formula] is δ = 1 / 3 - o(1), due to Solymosi [\cite=solymosi1], improving on previous work in [\cite=elekes] [\cite=erdosszemeredi] [\cite=ford] [\cite=nathanson] [\cite=solymosi2]. The best-known exponent when A is a subset of [formula] is δ = 1 / 11 - o(1), due to Rudnev [\cite=rudnev], improving on [\cite=BG] [\cite=BKT] [\cite=garaev] [\cite=ks] [\cite=li] [\cite=shen]. This bound was extended to the general finite field [formula] by by Li and the second-named author [\cite=LiORN1], following previous work of Katz and Shen [\cite=KSgeneral].

A variation on this theme is to find functions f of two variables with the property that for any set A, the set [formula] has cardinality [formula]. The study of such functions was initiated by Bourgain [\cite=bourgain] in a finite field setting. The strongest results are due to Garaev and Shen [\cite=GS], who proved three results about the size of the set A(A + 1), depending on the ambient field and the density of A within it:

[formula]

Result ([\ref=eq:gs2]) is sharp but ([\ref=eq:gs1]) and ([\ref=eq:gs3]) are not. This paper makes the following improvements on these cases:

For [formula] with |A| < p1 / 2 we have [formula].

For any finite set [formula] we have [formula]

In what follows, Section [\ref=section:finite] gives the proof of Theorem [\ref=theorem:mainfinite] and Section [\ref=section:real] gives the proof of Theorem [\ref=theorem:mainreal].

The finite field case

The overall strategy for proving Theorem [\ref=theorem:mainfinite] is similar to the finite-field case in [\cite=GS]. First, we bound a partial sumset from above in terms of A(A + 1). Second, we use the sum-product-type fact that if the partial sumset is small then A(A + 1) must be large. In combination, these show that A(A + 1) must always be large.

Our new bound follows from innovations in both parts of the strategy. In the first part, we find a more efficient upper bound on partial sumsets, via the Ruzsa-type observation that if ab = cd then (a - ab) - (c - cd) = a - c. For the second part, we incorporate partial sumsets more efficiently into the sum-product framework.

It is worth remarking that deploying the most recent innovation in sum-product techniques from [\cite=rudnev] should lead to a further slight improvement in the result - we estimate improving the exponent from 57 / 56 to 52 / 51. But we leave this for another time, since the purpose of this paper is to introduce some new technical ideas, and the 52/51 bound would introduce even more technicality and make the proof less accessible.

Section [\ref=section:partial] establishes a new upper bound on partial sumsets. Section [\ref=section:lemmata] records some triangle and covering lemmata from sumset calculus that we will need. Section [\ref=section:proof] then uses the results of the previous two sections to prove Theorem [\ref=theorem:mainfinite].

Bounding partial sumsets

We first recall the definition of a partial sumset.

Let A,B be sets and G  ⊆  A  ×  B. We define the partial sumset [formula].

This section proves the following upper bound for certain partial sumsets.

Let [formula], and let ε > 0. There exists G  ⊆  A  ×  B with |G|  ≥  (1 - ε)|A||B| such that

[formula]

Without loss of generality assume that 0∉A,B. Note that [formula] Let X be the set of x∈A / B for which [formula]. Then

[formula]

and so [formula]. Let [formula] so that

[formula]

For each [formula] pick a(ξ)∈A,b(ξ)∈B such that a(ξ) - b(ξ) = ξ. Let

[formula]

and note that

[formula]

since every element of [formula] occurs once as an abscissa of the set S, and each such abscissa has [formula] associated ordinates. We now show that [formula]. This will follow once we have shown that the map

[formula]

[formula]

is an injection. Indeed for given (t1,t2) in f(S) we know

[formula]

so we know ξ and therefore a(ξ) and b(ξ). We therefore also know (c,d) since t1 = a(ξ) + a(ξ)d and t2 = b(ξ) + b(ξ)c. There is therefore only one choice of (ξ,(c,d))∈S that can map to (t1,t2).

Combining all of the above we see that

[formula]

and so [formula] as required.

Triangle and covering results

We collect here a covering result and some variants of the Plünnecke-Ruzsa triangle inequalities from sumset calculus. Note that whilst these are recorded in their additive form, they can also be applied without further remark to product sets. We begin with the following lemma, which is useful when analysing particularly dense partial sumsets. Note that by the G-degree of a∈A we mean the number of b∈B such that (a,b)∈G.

Let G  ⊆  A  ×  B with |G|  ≥  (1 - ε)|A||B|. There exists A'  ⊆  A with [formula] such that the G-degree of every a∈A' is at least [formula].

Let A'  ⊆  A be the set of a∈A with G-degree at least [formula]. We will show that [formula]. For each a∈A let Ba be the set of b∈B such that (a,b)∈G. We have

[formula]

We therefore obtain

[formula]

and so [formula] as required.

The following covering result restates and slightly generalises one due to Shen [\cite=shen], showing that if [formula] is small for a large but not necessarily complete G, then much of A can be covered by few translates of B.

Let G  ⊆  A  ×  B and 0 < ε < 1 / 4. If |G|  ≥  (1 - ε)|A||B| then there exists A'  ⊆  A with [formula] such that A' is contained in the union of [formula] translates of B. Similarly, we can find a subset A''  ⊆  A with [formula] such that A'' in contained in the union of [formula] translates of - B.

We shall prove the case for covering with translates of B, and remark on the slight alteration needed to cover with translates of - B. Since |G|  ≥  (1 - ε)|A||B| there is by Lemma [\ref=theorem:denseG] a subset A1  ⊆  A with [formula] such that every element of A1 has G-degree at least [formula].

Now for any subset A*  ⊆  A1 let [formula] so that [formula]. Write E+(A*,B) for the additive energy of A* and B, i.e. the number of solutions to a + b = a' + b' with a,a'∈A* and b,b'∈B. This is the same as the number of solutions to a - b = a' - b', which is in turn at least the number of solutions for which (a,b) and (a',b') are both in G*.

By Cauchy-Schwarz and the lower bound on |G*| we therefore have

[formula]

Since

[formula]

this means that for any A*  ⊆  A1 there exists a∈A*, b∈B such that

[formula]

We apply the above discussion to a sequence of subsets of A. We begin by taking A* = A1 to find a1∈A1, b1∈B such that

[formula]

So the translate (a1 - b1) + B covers [formula] elements of A1. We discard [formula] from A1 and let A2 be the set of elements remaining, now taking A* = A2 and repeating the process. We iterate [formula] times until the set remaining is of cardinality no more than [formula]. We then take A' to be the set of elements discarded across all iterations, so that [formula]. Since [formula] we get [formula] as required, which completes the proof for covering with translates of B.

The proof for covering with translates of - B is identical, except that in place of ([\ref=eq:energydef]) we use [formula].

Our next result is the well-known Ruzsa triangle inequality, see e.g. [\cite=TV] for a proof.

For sets A,B,C we have

[formula]

We now prove an extension to Lemma [\ref=theorem:ruzsa] to high-density partial sumsets. This is set as Exercise 2.5.4 in the book of Tao and Vu [\cite=TV]. In the case ε = 0 it collapses to the statement of the Lemma [\ref=theorem:ruzsa].

Let 0 < ε < 1 / 4 and let G  ⊆  A  ×  B and H  ⊆  B  ×  C, such that |G|  ≥  (1 - ε)|A||B| and |H|  ≥  (1 - ε)|B||C|. Then there exist A'  ⊆  A and C'  ⊆  C with [formula] and [formula] such that

[formula]

Since |G|  ≥  (1 - ε)|A||B| there exists by Lemma [\ref=theorem:denseG] a set A'  ⊆  A with [formula] such that every a∈A' has G-degree at least [formula]. Similarly, there exists C'  ⊆  C with [formula] such that every c∈C' has H-degree at least [formula]. We shall show that |A' - C'| satisfies the required upper bound.

For each a∈A' let Ba be the set of b∈B such that (a,b)∈G. And for each c∈C' let Bc be the set of b∈B such that (b,c)∈H. For each a∈A',c∈C' we know that [formula] and so [formula].

For each x∈A' - C', fix a(x)∈A',c(x)∈C' such that a(x) - c(x) = x. Let

[formula]

We know that [formula]. And the injection

[formula]

from Y to [formula] shows that [formula]. Comparing the upper and lower bounds on Y, we are done.

We record a consequence that will be of use to us.

Let 0 < ε < 1 / 16 and let G  ⊆  A  ×  A with |G|  ≥  (1 - ε)|A|2. Then there exists A'  ⊆  A with |A'|  ≫  ε|A| such that

[formula]

Apply Lemma [\ref=theorem:semibsg] with A = B = C and H = G. There exist A1,A2  ⊆  A with [formula] such that [formula]. We then take [formula]. Since ε < 1 / 16 we know that [formula] and so |A'|  ≫  ε|A|. Moreover, [formula].

Our final triangle result is the Plünnecke-Ruzsa inequality. We use a variant due to Katz and Shen [\cite=ks].

For sets [formula], there exists A'  ⊆  A with |A'|  ≈  |A| such that

[formula]

Proving Theorem [\ref=theorem:mainfinite]

As a preliminary step we record two consequences of applying the results of Section [\ref=section:lemmata] to the partial sumset bound from Proposition [\ref=theorem:idea]. Our first consequence is the least-efficient, due to its use of Corollary [\ref=theorem:semibsgapp]. Because of this we will employ it only when compelled.

For any set [formula] there exists A'  ⊆  A with |A'|  ≫  |A| such that [formula]

Apply Proposition [\ref=theorem:idea] with A = B to find G  ⊆  A  ×  A with |G|  ≈  |A|2 such that [formula] By Corollary [\ref=theorem:semibsgapp] there exists A'  ⊆  A with |A'|  ≈  |A| such that [formula] By Lemma [\ref=theorem:ruzsa] applied multiplicatively we have [formula] and so obtain the result.

Our second consequence follows by applying Lemma [\ref=theorem:cover] to Proposition [\ref=theorem:idea]

Let [formula], and A,B  ⊆  xC + y for some [formula]. Let 0 < ε < 1 / 16. Then (1 - ε)|A| elements of A can be covered by

[formula]

translates of B. Similarly, (1 - ε)|A| elements of A can be covered by this many translates of - B.

Applying Proposition [\ref=theorem:idea] to the sets [formula] and [formula] we find Gxy  ⊆  Axy  ×  Bxy of cardinality at least (1 - ε2 / 4)|A||B| such that

[formula]

We then let [formula] to obtain [formula] By applying Lemma [\ref=theorem:cover] to G, the result follows.

We now begin the proof of Theorem [\ref=theorem:mainfinite]. By Corollary [\ref=theorem:horrific] and passing to a subset if necessary we may assume that

[formula]

By Lemma [\ref=theorem:pl] we may assume that

[formula]

Now, by Cauchy-Schwarz we know that

[formula]

So there exists b0∈A such that

[formula]

By dyadic pigeonholing we can find A1  ⊆  A and [formula] such that

[formula]

for all a∈A1 and

[formula]

Since |A1|  ≤  |A| we also have

[formula]

We now consider the set

[formula]

and break into two cases, according to whether or not [formula].

[formula]

Since [formula] we can find [formula] such that ξ - 1∉R(A1). Since ξ - 1∉R(A1), the set A1 + (ξ - 1)A1 has no repetitions and so for any subset A*  ⊆  A1 we have

[formula]

We now proceed to fix a particular choice of A*. Let ε > 0 be sufficiently small. Applying Corollary [\ref=theorem:energy] to the sets α(A1 + 1) and [formula] we see that there is a set Aα  ⊆  A1 with [formula] such that αAα is contained in the union of [formula] translates of b0A. Similarly, we can find sets Aβ,Aγ,Aδ  ⊆  A1 such that βAβ and γAγ are contained in the union of [formula] translates of b0A, and δAδ is contained in the union of [formula] translates of - b0A. We let

[formula]

so that |A2|  ≥  (1 - 4ε)|A1|. By Lemma [\ref=theorem:pl] there is a set A3  ⊆  A2 with |A3|  ≫  |A2|  ≫  |A1| and the property that

[formula]

We fix A* = A3 and so obtain from ([\ref=eq:finite7]):

[formula]

Since A2  ⊆  Aα,Aβ,Aγ,Aδ, and αAα,βAβ,γAγ are each contained in the union of [formula] translates of b0A, and δAδ is contained in the union of this many translates of - b0A, we have

[formula]

Then by ([\ref=eq:finite2]) we have

[formula]

Now by Lemma [\ref=theorem:ruzsa] applied multiplicatively we know

[formula]

Applying ([\ref=eq:finite1]) and ([\ref=eq:finite6]) to ([\ref=eq:finite5]) we get

[formula]

Rearranging and applying ([\ref=eq:finite3]) and ([\ref=eq:finite4]), we obtain

[formula]

and so [formula] as required.

[formula]

Let E be the number of solutions to

[formula]

with a,b,c,d∈A1 and ξ∈R(A1). Moreover, for each ξ∈R(A1) let E(A1,ξA1) denote additive energy of A1 and ξA1, i.e. the number of solutions to ([\ref=eq:energyeq]) with ξ fixed, so that [formula].

There are no more than |R(A1)||A1|2 = p|A1|2 solutions to ([\ref=eq:energyeq]) for which (a,b) = (c,d). And there are no more than |A1|4 solutions with (a,b)  ≠  (c,d). So we have

[formula]

Since |A1|  ≤  |A| < p1 / 2 this gives

[formula]

So there exists [formula] such that

[formula]

We then know that for any A*  ⊆  A1 with |A*|  ≈  |A1| we have also

[formula]

Now by Cauchy-Schwarz we know that [formula] and so we obtain

[formula]

As before we fix [formula], and find ourselves in the same position as in the previous case, but with one less factor of |A - A| to deal with. So we obtain (and in fact exceed) the required bound.

The real case

In order to prove Theorem [\ref=theorem:mainreal], we make use of recent innovations which have made use of bounds on additive energies of higher order. For sets A,B, we write

[formula]

Note that E2(A,B) is simply the multiplicative energy of A and B, i.e. the number of solutions to the equation ab = a'b' with a,a'∈A and b,b'∈B. In the case A = B we write Eα(A) = Eα(A,A).

Schoen and Shkredov [\cite=SS] made particular use of the case where α = 3 in order to establish a bound on the size of the sum set of a 'convex' set, improving an earlier result of Elekes, Nathanson and Ruzsa [\cite=ENR]. Subsequently, Li and the second-named author [\cite=LiORN2] improved on some other results from [\cite=ENR], including a proof that

[formula]

for any convex function f.

The upcoming proof follows a similar structure to the proof of ([\ref=convex]), essentially improving on an application of the Szemerédi-Trotter by considering third order energy. In the same spirit, Rudnev [\cite=mishaSP2] recently proved some improved sum-product estimates.

We make particular use of the following lemma of Li [\cite=Liconvex].

For any finite [formula] such that 0∉A,B,

[formula]

Note that the statement of Lemma [\ref=theorem:li] presented in [\cite=Liconvex] concerns additive rather than multiplicative energy, but the proof is identical after substituting multiplication for addition, taking care to avoid dividing by zero. Indeed, to avoid the problem of division by zero, we will assume throughout the proof of Theorem [\ref=theorem:mainreal] that - 1,0,1∉A.

Bounding the multiplicity of particular product sets

We shall exploit Lemma [\ref=theorem:li] for the sets A and A + 1. To this end we wish to control the multiplicities of several product sets in terms of the size of the set A(A + 1). For this we prove the following lemma:

Given finite [formula] and a parameter 1  ≤  t  ≤  |A|,|B|, write St(A,B) for the set of s∈AB such that [formula]. Then we have

[formula]

Before proving Lemma [\ref=theorem:control] we remark that it depends on the Szemerédi-Trotter [\cite=ST] incidence theorem for points and lines.

Let P and L be a set of points and lines respectively in [formula]. Then the number I(P,L) of incidences between points in P and lines in L is [formula].

This has the following standard consequence, which we shall make use of.

Let L be a set of lines in [formula]. Then the number of points incident to at least k lines in L is [formula].

Let P be the set of points incident to at least k lines in L. Then |P|k  ≤  I(P,L). Comparing to the upper bound in the Szemerédi-Trotter theorem shows that [formula] as required.

We now prove Lemma [\ref=theorem:control]. Let [formula], where lαb is the line given by y = (αx - 1)b. For each t  ≤  |A|,|B| we let Pt be the set of points incident to at least t lines in L. By the corollary to Szemerédi-Trotter we know that [formula]. Since t  ≤  |A|,|B| and |L| = |A(A + 1)||B| we therefore have

[formula]

We now bound |Pt| from below by [formula]. Suppose that (s,a)∈St(A,B)  ×  A. Since s∈St(A,B) there are at least t solutions to the equation s = ab with a∈A and b∈B. Index the solution pairs as (ai,bi) for [formula]. For any a∈A and any 1  ≤  i  ≤  t we have

[formula]

where α(i,a) = a(ai + 1). This is the same as saying that

[formula]

One can verify that the lines lα(i,a),bi are all distinct as i ranges from 1 to t. So we deduce that [formula] for each (s,a)∈St(A,B)  ×  A and conclude that

[formula]

Comparing ([\ref=eq:lower]) and ([\ref=eq:upper]) yields [formula] as required.

Consequences of bounded multiplicity

We now use our control of multiplicities, along with Lemma [\ref=theorem:li], to obtain bounds on various forms of multiplicative energy.

[formula].

By Cauchy-Schwarz we have

[formula]

Let Δ  ≥  1 be a parameter that will be fixed later. Write [formula]. Lemma [\ref=theorem:control] implies that

[formula]

We then set [formula] to obtain

[formula]

Applying ([\ref=eq:1]) to the set - A - 1 yields

[formula]

Combining ([\ref=eq:cs]),([\ref=eq:1]) and ([\ref=eq:2]) gives the required result.

[formula]

By Lemma [\ref=theorem:control] we have

[formula]

which gives the first bound. The proof of the second bound follows by applying this result to the set - A - 1.

[formula]

and

[formula]

Let Δ  ≥  1 be a parameter that will be fixed later. Write [formula] By Lemma [\ref=theorem:control] we have

[formula]

We then pick [formula] to obtain E2(A,A(A + 1))  ≪  |A(A + 1)|5 / 2. The second bound follows by applying this to the set - A - 1 and noting that E2( - A - 1,A(A + 1)) = E2(A + 1,A(A + 1)).

Completing the proof of Theorem [\ref=theorem:mainreal]

Combining Lemma [\ref=theorem:li] and Corollary [\ref=theorem:2to1.5] shows that

[formula]

Applying Corollaries [\ref=theorem:3to0] and [\ref=theorem:2to0] to bound E2(A,A(A + 1)), E2(A,A(A + 1)), E3(A) and E3(A + 1) then yields |A|24  ≪  |A(A + 1)|19 as required.

Acknowledgements

The authors are grateful to Misha Rudnev for encouragement and helpful conversations.