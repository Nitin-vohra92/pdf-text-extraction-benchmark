Fermi's Sibyl: Mining the gamma-ray sky for dark matter subhaloes

, V. Fras-Martinez3, T. Hassan2, and E. Fras-Martinez3 1Ramón y Cajal Fellow 2 Dpto. de Fsica Atómica, Molecular y Nuclear, Universidad Complutense de Madrid, Spain 3 Telefonica Research, Madrid, Spain

Introduction

The extraordinary success of the Fermi mission marks the beginning of the golden age for gamma-ray astrophysics. With 24 months of data, the Second Fermi-LAT catalogue (2FGL) lists 1873 sources in the 100 MeV to 100 GeV energy range, of which 886 are AGNs and 108 are pulsars. While Fermi has greatly mitigated issues inherent to source localisation in the gamma-ray regime, 269 sources in the 2FGL (15% of the total) remain without obvious counterparts at Galactic latitude [formula]. Such failure to associate the entire Fermi catalogue continues to fuel speculation about the existence of new types of gamma-ray source classes.

Probably the most intriguing potential sources of gamma ray emission are dark matter subhaloes [\citep=diemand] [\citep=springel]. Numerical cold dark matter (CDM) simulations suggest that galaxies like our own are surrounded by a wealth of small dark matter subhaloes that survived structure formation [\citep=klypin] [\citep=moore]. Massive subhaloes ([formula]) would correspond to "classical" dwarf galaxies. Less massive ones would be optically elusive and might only be revealed as gamma-ray point sources when weakly interacting massive particles (WIMPs) annihilate to gamma rays [\citep=kuhlen]. As a result, nearby dark matter subhaloes might be lurking among the unassociated Fermi sources at high Galactic latitudes. If found, an annihilation signal from Galactic subhaloes would clinch the first non-gravitational signature of dark matter.

The hunt for dark matter subhaloes in the Fermi catalogue is currently underway [\citep=nieto] [\citep=belikov] [\citep=zechlin] [\citep=acker12]. Most approaches involve the hypothesised sharp spectral cut-off or step expected at the WIMP mass [\citep=berg]. Assuming that the WIMP mass falls between 100 MeV and 50 GeV, a dark matter subhalo could be detectable in the Fermi MeV-GeV band, but would disappear in the GeV-TeV band, effectively creating a TeV dropout.

Here we investigate the possibility of identifying dark matter subhalo candidates using supervised machine learning algorithms. Rather than starting with an ad hoc theoretical dark matter spectrum we would like to exploit pattern recognition of known gamma-ray features in associated sources and use this information to locate outliers that might constitute novel emitters. Machine learning algorithms have already been used to study the First Fermi LAT Catalogue (1FGL). For example, [\citet=class] investigated classification trees and logistic regression to predict classes of unassociated sources in the 1FGL based on a set of gamma-ray features. K-means clustering was also applied to help distinguish individual counterparts within Fermi error contours [\citep=mirabal].

With an additional year of collected Fermi data, the gamma-ray features reported in the 2FGL have improved substantially. In this paper we train the Random Forest classifier [\citep=breiman] on identified/associated Fermi objects and build a set of decision trees that provide predictions for high-latitude unassociated Fermi objects in the 2FGL. The paper is organised as follows. In section [\ref=datasets] we describe the datasets and the Random Forest algorithm. Section [\ref=appli] describes the performance of the classifier on unassociated Fermi sources. Section [\ref=subhalos] details the search for potential outliers. Finally, we provide our conclusions and discuss future work in section [\ref=discuss].

Datasets and Random Forests

Random Forest is an ensemble classifier that grows a large forest of classification trees [\citep=breiman]. Decision trees are classification tools that have a tree structure, where each split is based on the information gained considering the elements of the feature space [\citep=quinlan]. To classify a new object, each tree in the forest votes on the class. The proportion of votes P that agree on a decision provides a measure of the accuracy of the classification. Random Forest then makes a prediction based on the majority of votes (P > 0.5). Random Forest also computes proximities between pairs of objects and produces scaling coordinates (1st and 2nd) that can be used to visualise datasets easily[\citep=cox]. In addition, a number of comparisons have shown that Random Forest is unexcelled in accuracy among current classifiers [\citep=svetnik03] [\citep=qi] [\citep=frias] [\citep=richards]. The analysis presented here uses the R randomForest package [\citep=liaw].

For our dataset, we collected the complete Fermi LAT 2FGL catalogue that consists of 1873 sources (100 MeV-100 GeV) of which 1300 are firmly identified/associated and 573 are unassociated sources [\citep=2lat] [\citep=2lac]. In total, we consider a list that includes 800 labelled AGNs (BL Lacs and flat-spectrum radio quasars only) and 108 pulsars. There are additional gamma-ray classes in the 2FGL, but AGNs and pulsars are the largest and most common at [formula]. Thereby we simply consider a bimodality of classes. Novelty detection will be discussed later on. For each of the 908 sources a total of 68 features are reported in the 2FGL. Features include Galactic latitude, Galactic longitude, spectral index (Index), variability, curvature index (Curve), and fluxes in five bands. In addition, we generate four derived features defined by flux ratios FRij  =  Fluxi  /  Fluxj between consecutive bands for 0.1-0.3 GeV (Band 1), 0.3-1 GeV (Band 2), 1-3 GeV (Band 3), 3-10 GeV (Band 4), and 10-100 GeV (Band 5) comparable to the features first introduced by [\citet=class].

To avoid working with too many features that could generate noise in the classifier, we first identify the subset of features that best discriminates what constitutes an AGN or a pulsar. For that purpose, we compute the relevance of each feature towards the target class, rank them by importance, and apply the classifier to a subset of the most relevant ones. Specifically, we use the measure of importance - MeanDecreasedAccuracy - implemented within randomForest [\citep=breiman] [\citep=svetnik]. Initially, the accuracy rate is computed for each tree as the Random Forest is constructed. The value of a particular feature is then permuted across all the objects while other features are left unchanged. and the accuracy rate is recorded again. The MeanDecreaseAccuracy is the overall percentage decrease in accuracy rate averaged over all trees. If the feature is important, there should be a greater decrease in the accuracy rate compared to the initial one. Figure [\ref=figure1] shows the top most important features ranked by importance. We found that the features that most clearly differentiate AGN and pulsar classes include: Index, Curve, Variability, and Flux Ratios (FR12, FR23, FR34, and FR45). This selection is in general agreement with [\citet=class] who chose similar features for supervised classification of the 1FGL. Additional features showed considerably smaller values in their importance (MeanDecreaseAccuracy) and are thus not considered in the analysis.

In order to construct and train Sibyl, we start with the 800 AGNs and 108 pulsars. However, given the highly imbalanced nature of the sets, we replicate the pulsar sample to attain a closer size as the AGN class [\citep=ling] [\citep=chawla]. Practically, the content of the datasets have not changed but the replication mechanism adds weight to the minority sample and achieves improved performance in the classifier.

After matching the AGNs and pulsar datasets, we generate 100 alternate training and testing sets built from randomly selected objects (2/3 and 1/3 of the sample respectively). We next produce Random Forest models with 500 trees for each training set. For validation, individual performance is evaluated at each of the 100 testing sets. Accuracy rates are computed directly by comparing the class predicted by Sibyl with the true class for each object in the testing sets. On average, Sibyl achieves an accuracy rate of 97.1% based on majority voting (97.7% for AGNs and 96.5% for pulsars). Inclusion of absolute Galactic latitude |b| in the classifier lowered AGN and pulsar accuracy rates slightly to 97.4% to 95.5% respectively. Since pulsars tend to be situated along the Galactic plane and AGN are more numerous at high Galactic latitude, it is possible that using Galactic latitude as a feature could introduce a tiny bias against AGN near the Galactic plane and pulsars away from it [\citep=class]. Generally, most of the misclassifications occur when less than 70% of the individual trees (P < 0.7) agree on a classification. Figure [\ref=figure2] displays the outstanding separation between AGNs and pulsars, which explains the high accuracy rates obtained by Sibyl.

Application to unassociated sources

The designation of 2FGL sources usually falls into three categories: identified, associated, and unassociated. A firm identification of a gamma-ray source can only be established through contemporaneous temporal variability, similar spatial morphology, or equivalent pulsation at other wavelengths. An association only requires positional correspondence of a possible counterpart with a 2FGL source. Unassociated sources lack a formal counterpart at other wavelengths.

Here, we consider a fourth category to designate 2FGL sources: "prediction". Our objective is twofold: to predict the class of high-latitude unassociated Fermi objects in the 2FGL; and to produce a list of outliers that could be explored as potential dark matter subhaloes. For each of the 269 unassociated Fermi sources at [formula], Sibyl provides a prediction that the object is an AGN (PAGN) or a pulsar (PPulsar) based on individual votes polled from all trees in the decision forest.

Since we want to isolate outliers that might constitute dark matter subhalo candidates, we only accept Sibyl predictions whenever P > 0.7 i.e., at least 70% of the trees agree on the final decision. Otherwise, the object remains without a prediction. Such threshold value is set based on the results explained in Section [\ref=datasets]. In total, Sibyl predicts 216 objects to be AGN and 16 to be pulsars. The resulting predictions and percentages of voting agreements are listed in Table [\ref=table1]. Finally, the remaining 37 objects left without a firm prediction are the focus of our outlier study in the next section. It is important to note that under some specific circumstances, dark matter subhaloes could mimic the spectral properties of certain pulsars [\citep=baltz] [\citep=zechlin], we discuss this possibility further in [\ref=discuss].

Search for dark matter subhaloes in the 2FGL

In order to better understand the nature of the remaining 37 objects we want compute their outlyingness, which is a measure of how far away an object is from its closest class. Apart for predicting an object's class, Random Forest computes the proximity of each predicted Fermi object n to every element k within each class [formula]. Formally, each individual proximity prox(n,k) is computed as the fraction of trees in which elements n and k fall in the same terminal node [\citep=breiman] [\citep=liaw]. The outlyingness of an element n is calculated as the reciprocal sum of the squared proximities to all objects within its class. This outlying measure is normalised by subtracting the median and dividing by the absolute deviation from the median [\citep=liaw]. Larger outlyingness values are common in objects that are extremely different from the average, which could correspond to dark matter subhaloes. Figure [\ref=figure3] shows the distribution of outlyingness for the 37 objects without firm predictions. For comparison, we also plot the outlyingness for the remaining 232 objects that were predicted by Sibyl in the previous section. Additionally, Table [\ref=table2] lists the five objects with the largest outlyingness.

Given that outlyingness values much greater than 10 usually indicate novel cases [\citep=breiman], there is no strong indication of novelties (significant outliers) among the 37 objects without firm predictions. We find that the top five outliers have an average flux of 1.1  ×  10- 9 ph cm- 2 s- 1 (1-100 GeV). Unassociated source fluxes at high latitudes range from 7.7  ×  10- 9 to 1.1  ×  10- 10 ph cm- 2 s- 1. Thus, they are not necessarily the faintest sources in the dataset. On the other hand, the mean photon index of sources in Table [\ref=table2] is 2.2  ±  0.3, while photon indices in the unassociated sample range from 1.1 to about 3.0. Inspection of individual features in this manner yields limited insight into what makes these outliers stand out from the rest of the sample. As mentioned before, the exploration of the entire feature space is precisely where the supervised learning algorithm excels. Unfortunately, Sibyl cannot assess by itself whether the outlyingness is due to an anomaly in the data taking process, a simple variation within known Fermi classes, or a true novel source class such as dark matter annihilation in Galactic subhaloes.

Discussion and Conclusions

We have presented the outcome of the Random Forest predictor Sibyl. The results show that machine learning algorithms provide a reasonable route not only to predict unassociated AGNs/pulsars in the 2FGL, but also to produce a list of sources with unusual features that could be explored as potential dark matter subhalo candidates. After training on 908 identified/associated Fermi objects, Sibyl has been applied to predict the class of unassociated Fermi sources in the 2FGL. Out of 269 unassociated sources at high latitudes, we have found that 216 are AGN candidates and 16 are considered potential pulsars with prediction accuracy rates greater than 96.5%. Sibyl has also produced a list of 37 outlier objects; however, none of these exhibits significant outlyingness that can be directly connected to new gamma-ray classes (including dark matter subhaloes) at this point. We emphasise again that our results are strict predictions based on pattern recognition and thus a rigourous source identification process will have to localise actual counterparts at other wavelengths.

The results leave some room, albeit very small, to accommodate dark matter subhaloes or alternative source classes in the 2FGL. These pockets could be targeted to exhaust all possibilities. Looking forward, zooming in on a reduced group of sources might be a wise observational strategy. For obvious reasons, the set of objects with the largest outlyingness could be a reasonable place to conduct a dedicated survey. If dark matter consists of particles with a mass below 60 GeV [\citep=hooper], dark matter subhaloes might also be camouflaging among the ranks of predicted pulsars as their spectral signature could be similar to the pronounced spectral cut-off predicted predicted by certain dark matter models. However, a number of these sources could be old radio-quiet pulsars which will complicate the search for a counterpart [\citep=kerr].

There are a number of issues that need further exploration. For instance, the predictions are heavily dependent on the robustness of the spectral parameters listed in the 2FGL. Most machine learning algorithms lack a proper treatment of uncertainties in each of the features considered [\citep=carroll] [\citep=morgan]. Inclusion of uncertainties as individual features in Sibyl did not yield improved performances in our predictions. With additional years of flight, Fermi will likely keep improving the accuracy of the gamma-ray features. However, attempts should be made to account for feature errors properly. In a forthcoming paper, we plan to explore a more refined breakdown into further Fermi subclasses [\citep=hassan]. There are at least four AGN subclasses in the 2FGL comprising BL Lacs, flat-spectrum radio quasars, misaligned AGNs, and Seyfert galaxies [\citep=2lac]. Pulsars can be further partitioned into radio-loud, radio-quiet, and millisecond pulsars [\citep=pulsars].

Ultimately, the main reason that a large Fermi fraction remains unassociated to begin with has to do with the quality of localisations in the gamma-ray band. At faint flux levels, it becomes ever more difficult to associate a Fermi source with a particular counterpart. The best association procedures rely on positional coincidences and correlations with flat-spectrum radio sources [\citep=2lac]. None the less, considering the results presented here and the scatter in gamma-ray flux it seems likely that many of the unassociated sources at high latitude are AGNs or mid-latitude pulsars with somewhat fainter radio fluxes than their brighter cousins.

Without a major breakthrough in localisations, the actual counterparts of most unassociated Fermi objects will be difficult to pinpoint in the short term. Machine learning algorithms can help narrow the options. Eventually, we will see significant improvement in localisations, particularly for Galactic sources, courtesy of the future Cherenkov Telescope Array (CTA) that will achieve enhanced angular resolution above 25 GeV [\citep=cta].

Acknowledgments

N.M. acknowledges support from the Spanish government through a Ramón y Cajal fellowship and the Consolider-Ingenio 2010 Programme under grant MultiDark CSD2009-00064. We thank Pablo Saz Parkinson for helpful conversations. We also thank the referee for useful suggestions and comments on the manuscript.