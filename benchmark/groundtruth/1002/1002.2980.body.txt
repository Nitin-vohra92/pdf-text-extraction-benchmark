The virial theorem and planetary atmospheres

In his widely discussed article, Miskolczi [\cite=Miskolczi2007] postulates that the virial theorem, which relates the average kinetic and average potential energies of a bound mechanical system (see [\cite=LL1972] for a thorough introduction), can be applied to a planetary atmosphere in equilibrium in the planet's gravitational field.

To investigate if Miskolczi's postulate is correct (whether or not the postulate was correctly applied in [\cite=Miskolczi2007] is a question beyond the scope of the present paper), let us first consider the case of a bouncing ball in an homogeneous gravitational field. (The gravitational field within the Earth's atmosphere, the thickness of which is small compared to the Earth's radius, is approximately homogeneous. However, the same results presented here could also be obtained using a Newtonian gravitational potential [\cite=Pacheco2003].)

Consider dropping the ball from a height hb above the surface, and assume that it falls without air resistance, and bounces back from the ground with no loss of kinetic energy. We wish to calculate its average kinetic and average potential energy. It is sufficient to compute these averages for the first part of the ball's motion, as it falls to the ground; the bounce-back is just a time-reversed copy of its initial drop, and afterwards, in the absence of dissipative losses, the ball repeats the same motion ad infinitum.

We presume that the ball was dropped at t = 0. At any other time t > 0 before the ball hits the ground, its height will be

[formula]

where g (≃9.81 m/s2 on the Earth) is the surface gravitational acceleration. From this,

[formula]

and notably, the time it takes to reach the ground (h = 0) is

[formula]

The velocity of the ball at time t (0  ≤  t  ≤  t0) is

[formula]

The kinetic energy K and potential energy U of the ball are calculated the usual way:

[formula]

According to the virial theorem, for a bound mechanical system with kinetic energy K,

[formula]

where 〈〉 denotes time averaging and [formula] and [formula] are the position of, and the force acting on, the a-th particle that constitutes the system. In the case of a system in which the potential energy is an homogeneous function of degree k of the coordinates, we get

[formula]

For ([\ref=eq:U]), k = 1. The time averages of the kinetic energy ([\ref=eq:K]) and potential energy ([\ref=eq:U]) between t = 0 and t = t0 can be calculated as

[formula]

Hence, 2〈K〉  =  〈U〉 and the virial theorem for the potential ([\ref=eq:U]) appears satisfied. This was made possible, in part, by referencing the height h to ground level; this allowed us to ignore the effects of the ground surface in ([\ref=eq:VT]), because at the ground, [formula], as observed also in [\cite=Pacheco2003].

How about a column of atmospheric gas? We assume a column of gas in hydrostatic equilibrium standing over a unit surface area in an homogeneous gravitational field. Its density will be a function of height h above ground:

[formula]

The pressure at h is equal to the weight of gas situated at heights above h:

[formula]

We assume that the gas is in thermal equilibrium (the real atmosphere isn't, but that's another story), so its temperature is constant:

[formula]

We also assume that the gas obeys the ideal gas law (this is a valid approximation for air at room temperature and sea level pressure), hence

[formula]

where V is the volume of n moles of gas, and R≃8.31 JK- 1mol- 1 is the ideal gas constant. The mass of n moles of gas is nMn where Mn (≃0.029 kg/mol for air) is the molar mass of the gas; its density is ρ = nMn / V, hence V = nMn  /  ρ. We can thus rewrite the ideal gas law in the form

[formula]

Using this in ([\ref=eq:prho]), we obtain

[formula]

or, in differential form,

[formula]

which can be solved trivially:

[formula]

or

[formula]

which we can also write in the form

[formula]

For air at T0 = 273 K, we get

[formula]

which agrees well with the observed properties of the atmosphere.

So what about the virial theorem? Going back to the bouncing ball for a moment, we can immediately spot a potential problem: what if the ball is moving horizontally as well? Indeed, it can move horizontally at an arbitrary velocity, yet its potential energy will be no different, hence the virial theorem fails. We must make sure that we only consider the vertical component of the ball's velocity before the theorem can be considered valid. The velocity of the ball can be written in rectilinear form as v2 = v2x + v2y + v2z, but we are only interested in the vertical component. In the specific case when the average velocities in the x, y, and z direction are the same, we get [formula]. Accordingly, the virial theorem in this case reads

[formula]

This result can also be obtained using another argument, presented in [\cite=Pacheco2003]: rather than allowing the coordinates to remain unbounded in the horizontal plane, we can consider confining the ball to within a cylinder of unit radius, integrating and time averaging the force acting on the ball as it hits the cylinder walls, in order to obtain the right-hand side of ([\ref=eq:VT]).

An atmosphere, unfortunately, is not made of bouncing balls, however appealing that picture might appear. Air, in particular, is composed mainly of diatomic gases (notably N2 and O2), which at room temperature have two rotational degrees of freedom in addition to the three translational degrees of freedom discussed above. (At higher temperatures, vibrational modes also play a role.) The kinetic energy of a column of gas is its internal thermal energy. The principle of equipartition of energy states that internal thermal energy is distributed equally between all degrees of freedom. Therefore, the virial theorem now reads

[formula]

This is our main result, valid for any diatomic atmosphere that obeys the ideal gas law in an homogeneous gravitational field at moderate temperatures.

For a column of gas over a unit surface area, the thermal kinetic energy is

[formula]

where cV is the specific heat of the atmosphere at constant volume. The potential energy is just the gravitational potential energy:

[formula]

The ratio of the two is

[formula]

Using ([\ref=eq:h0]), we obtain

[formula]

Given ([\ref=eq:virialair]) and ([\ref=eq:UK]), we can calculate the specific heat cV. For air, we obtain

[formula]

a value that agrees well with the known properties of air (cV = 718 JK- 1kg- 1).

In this derivation, we assumed that T = T0 is constant. Our result, however, remains valid even when T is not constant, so long as the gas is in "local thermodynamic equilibrium", which ensures that the principle of equipartition remains valid and that thermodynamic quantities, such as the temperature or specific heat, remain well-defined. To see this, we first rewrite the condition of hydrostatic equilibrium ([\ref=eq:prho]) in differential form:

[formula]

This allows us to write the potential energy of the gas ([\ref=eq:Ugas]) as

[formula]

where the last step was taken by integrating in parts and using p(  ∞  ) = 0. On the other hand, the thermal kinetic energy ([\ref=eq:Kgas]) can be rewritten as

[formula]

The ratio of ([\ref=eq:Up]) and ([\ref=eq:Kp]) remains the same constant ratio ([\ref=eq:UK]) that we obtained in the T = T0 case:

[formula]

even as T varies with altitude. Therefore, even as we allow T to be a function of h, ([\ref=eq:virialair]) remains satisfied.

Hence we were able to demonstrate without having to invoke concepts such as "hard core" potentials or intramolecular forces that the virial theorem is indeed applicable to the case of an atmosphere in hydrostatic equilibrium. However, it must be "handled with care": the nature of the atmosphere and the fact that the horizontal (translational) and internal (rotational) degrees of freedom of the gas molecules are unrelated to the gravitational potential cannot be ignored.