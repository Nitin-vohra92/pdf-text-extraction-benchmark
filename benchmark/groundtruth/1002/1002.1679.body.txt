On the intersections of Fibonacci, Pell, and Lucas numbers

In 1962 Stein [\cite=Stein1962] using elementary arguments proved that if two Fibonacci sequences (with different initial terms) share three terms then they are identical from some terms on. This result was later generalized by Revuz [\cite=Revuz1974] to arbitrary sequences satisfying the same second order linear recurrence. A similar problem is to determine the intersection of two sequences satisfying distinct linear recurrences. Mignotte, 1978 [\cite=Mignotte1978] proved that the intersection of two sequences is finite unless the roots of their characteristic polynomials are multiplicatively dependent. Mátyás, 1981 [\cite=Matyas1981] gave a criterion for determining whether two second order linear sequences have nonempty intersection. Posing the problem as a system of Pellian equations, Pinch, 1988 [\cite=Pinch1988] and Tzanakis, 2002 [\cite=Tzanakis02] proposed computational methods for solving such systems.

In the current paper we focus on the computational matters of finding the intersection and provide some explicit results for a class of Lucas sequences. While the general structure of such intersections is well known [\cite=Mignotte1978] [\cite=Matyas1981] [\cite=Pinch1988] [\cite=Tzanakis02], our approach (outlined in the proof of Theorem [\ref=Txyz]) is different from previous studies (see [\cite=Tzanakis02] for a review of various computational methods). In short, we reduce the problem to a finite number of Thue equations, each of which has a finite number of solutions. In practice the intersection of particular Lucas sequences can be computed with PARI/GP computer algebra system [\cite=PARI] providing a functionality for solving Thue equations, based on Bilu and Hanrot's improvement [\cite=Bilu1996] of Tzanakis and de Weger's method [\cite=Tzanakis1989]. We also characterize the cases when the intersection is infinite and show that it also forms a Lucas sequence.

While the current paper was under review, our attention was drawn to the paper of Szalay, 2007 [\cite=Szalay2007], which employs a similar approach for solving systems of Pellian equations. We therefore feel obliged to underline the differences between [\cite=Szalay2007] and our paper. In Theorem [\ref=Txyz] we consider a general system of two homogeneous quadratic equations in two indeterminants and formulate conditions under which such a system has a finite number of integer solutions. The systems of Pellian equations considered in [\cite=Szalay2007] represent a particular case of the system from our Theorem [\ref=Txyz], while the algorithm and the corresponding proof of solutions' finiteness in [\cite=Szalay2007] are flawed. In [\cite=Szalay2007] it is used the result from [\cite=Luca2006] that the denominator in the general solution to a Diophantine equation Ax2 + By2 + Cz2 = 0, derived from a particular solution (x0,y0,z0) with z0  ≠  0, divides 2A2BCz30. In Theorem [\ref=ThABC] we prove a stronger result that this denominator actually divides [formula], leading to a smaller number of Thue equations to solve. This result also corrects an error in Corollary 6.3.8 of [\cite=Cohen07]. We further focus on multiple issues specific to the intersections of Lucas sequences which are out of scope of [\cite=Szalay2007]. Said that, we refer to [\cite=Szalay2007] for many examples of systems of Pellian equations and a review of their applications and related literature.

The paper is organized as follows. In Section [\ref=SecBasic] we give definition and basic properties of Lucas sequences. We develop an algorithmic approach to solving systems of quadratic Diophantine equations in Section [\ref=SecQuad] and apply it to the problem of finding intersections of Lucas sequences in Section [\ref=SecInter]. Some numerical results are given and a number of open questions are posed in Section [\ref=SecComp]. Finally, we discuss generalizations of our approach to Lucas sequences with arbitrary initial terms in Section [\ref=SecArbit].

Basic properties of Lucas sequences

The pair of Lucas sequences Un(P,Q) and Vn(P,Q) are defined by the same linear recurrent relation with the coefficient [formula] but different initial terms:

[formula]

Some Lucas sequences have their own names:

Other examples include Jacobsthal numbers Un(1, - 2), Mersenne numbers Un(3,2) etc.

In the current paper we focus on the case of Q = 1 or Q =  - 1. We also notice that

[formula]

and restrict our attention to Lucas sequences with P  ≥  0. Similarly, we exclude from consideration terms with negative indices, noticing that they may deviate only in signs:

From further consideration we also exclude the following degenerate cases:

It is easy to see that under the described restrictions both Un(P,Q) and Vn(P,Q) are positive for n > 0.

The characteristic polynomial of Lucas sequences {Un(P,Q)} and {Vn(P,Q)} is λ2  -  Pλ  +  Q with the discriminant D = P2  -  4Q. For non-degenerate sequences, the discriminant D is a positive non-square integer.

Let [formula] and [formula] be the roots of the characteristic polynomial, then the following explicit (Binet-type) formulas take place

[formula]

In particular, these formulas imply that

[formula]

For |Q| = 1, it means that the pairs (Vn(P,Q),Un(P,Q)) form solutions to the equation:

[formula]

The converse statement can be used to prove that given positive integers belong to {Vn(P,Q)} or {Un(P,Q)} respectively (stated without a proof for Fibonacci numbers in [\cite=Posamentier07]):

We notice that D is congruent to 0 or 1 modulo 4, implying that the general solution to equation [\eqref=EqXDY] has the form (x,y) = (xk,yk), where

[formula]

and (x1,y1) is a solution with the smallest positive y1 (see Proposition 6.3.16 in [\cite=Cohen07]). Since there is a solution (x,y)  =  (P,1) with the smallest possible positive y  =  1, we can take (x1,y1)  =  (P,1).

Therefore, for some [formula]

[formula]

implying that

[formula]

Since u > 0 and v > 0, we have

[formula]

Quadratic Diophantine equations

While theorems in this section can be viewed as consequences of the fundamental results of Thue [\cite=Thue1909] and Siegel [\cite=Siegel1929], we focus on computational aspects and give independent self-contained proofs of algorithmic nature.

Without loss of generality assume that k1  ≠  0.

If m or n is zero, then the other indeterminate may take only up to two values satisfying the quadratic equation f1(0,n) = k1 or f1(m,0) = k1. For the rest assume that both m and n are non-zero.

The given system implies an equation g(m,n)  =  0 where g(m,n) = k2f1(m,n)  -  k1f2(m,n) is a homogeneous quadratic polynomial.

If g(m,n) = cmn for some coefficient c  ≠  0, then there are no non-zero solutions.

If g(m,n)  ≠  cmn, without loss of generality we assume that the coefficient of m2 in g(m,n) is non-zero, implying that g(m,n) = h(m / n)n2 where h(x) is a quadratic polynomial. In this case, we have a quadratic equation h(m / n) = 0 that determines up to two possible values of the ratio m / n. For a fixed value of m / n, the equation f1(m,n)  =  k1 has only a finite number of integer solutions.

Therefore, the given system of Diophantine equations has only a finite number of solutions.

Since the polynomial f(m,n) is homogeneous, it can be represented as f(m,n)  =  n4g(m / n) where g(x) is a univariate polynomial with integer coefficients. Consider a factorization of g(x) over [formula] that implies a factorization f(m,n) into irreducible homogeneous polynomials over [formula].

If f(m,n) has two linear factors a1m  +  b1n and a2m  +  b2n that are linearly independent, then the equation f(m,n) = k implies a finite number of systems of the form:

[formula]

where d1,d2 run over the divisors of k. Each of these systems has at most one solution, implying that the equation f(m,n) = k has only a finite number of solutions. For the rest we assume that f(m,n) has no two linearly independent linear factors. Then the polynomial f(m,n) is not of the form c  ·  g(m,n)2 only in the following four cases:

f(m,n) is irreducible

f(m,m)  =  g2(m,n)h2(m,n)

f(m,m)  =  g1(m,n)h3(m,n)

f(m,m)  =  g1(m,n)2h2(m,n)

where gi(m,n) and hi(m,n) are irreducible polynomials of degree i with integer coefficients; and g2(m,n) and h2(m,n) are linearly independent.

In the case 1, the polynomial f(m,n) is irreducible, implying that the Diophantine equation f(m,n) = k has a finite number of solutions due to the Thue theorem [\cite=Thue1909].

In the case 2, the equation f(m,n) = k is equivalent to the union of the following systems of equations:

[formula]

where d goes over the divisors of k. Each of these systems has only a finite number of solutions by Theorem [\ref=Tqsys]. Therefore, the total number of solutions is also finite in this case.

In the case 3, the solutions to f(m,n) = k must also satisfy a Thue equation h3(m,n)  =  d for some divisor d of k. Since for each such d there is only a finite number of solutions, the total number of solutions to f(m,n) = k is finite.

In the case 4, we let g2(m,n)  =  g1(m,n)2 and proceed as in the case 2 above.

According to Theorem [\ref=Tinfsol], the equation f(m,n) = k may have an infinite number of solutions only if

[formula]

for some integer coefficients c,u,v,w. In this case A  =  cr2, B = cvr, C = c(2uw + v2), D = u / r, E = w / r for some non-zero rational number r and thus

[formula]

The theorem below represents a correct version of Corollary 6.3.8 in [\cite=Cohen07] which appears seriously flawed.

The general solution [\eqref=SolSys] to the equation Ax2 + By2  =  Cz2 is given in Corollary 6.3.6 in [\cite=Cohen07]. It remains to prove that q divides [formula].

The values of x, y, and z in [\eqref=SolSys] are integer if and only if q divides each of Px(m,n), Py(m,n), and Pz(m,n). Then q also divides

[formula]

as well as

[formula]

Therefore, q divides

[formula]

which in turn divides

[formula]

It is clear that (d1,d2)  ≠  (0,0). Without loss of generality we assume that d1  ≠  0.

If x = 0 then the resulting system has a finite number of solutions due to Theorem [\ref=Tqsys]. For the rest of the proof assume that x  ≠  0.

Multiplying the first equation of [\eqref=Lxyzsys] by d2 and subtracting the second equation multiplied by d1, we get a homogeneous Diophantine equation:

[formula]

where A  =  a1d2  -  a2d1, B  =  b1d2  -  b2d1, and C  =  c1d2  -  c2d1 represent minors of the matrix M and thus are non-zero.

Let (x0,y0,z0) be a particular solution to equation [\eqref=Lxyzhom] (for general methods of finding particular solutions to quadratic homogeneous equations in three variables, see [\cite=Cremona03] [\cite=Cohen07]) with z0  ≠  0, i.e.,

[formula]

then by Theorem [\ref=ThABC] the general solution to equation [\eqref=Lxyzhom] is given by [\eqref=SolSys], where gcd (m,n) = 1, gcd (p,q) = 1, and q > 0 divides [formula].

Plugging the general solution [\eqref=SolSys] into the first equation of [\eqref=Lxyzsys], we have

[formula]

where

[formula]

We remark that equation [\eqref=Lf12] represents a collection of Diophantine equations indexed by coprime integers p and q ranging over the divisors of respectively [formula] and [formula], where d'1 is the square-free core of d1.

Theorem [\ref=Tcoeff] implies that equation [\eqref=Lf12] may have infinitely many solutions only if

[formula]

is zero. However, each factor in this product is non-zero. Therefore, equation [\eqref=Lf12] has only a finite number of integer solutions.

Intersection of two Lucas sequences

Intersection of two U-sequences

If an integer x belongs to the intersection {Un(P1,Q1)} and {Un(P2,Q2)}, where |Q1| = |Q2| = 1 and (P1,Q1)  ≠  (P2,Q2), then [\eqref=MainEq] implies that x satisfies a system of Diophantine equations:

[formula]

where D1  =  P21  -  4Q1 and D2  =  P22  -  4Q2. The matrix of its coefficients

[formula]

has all 2  ×  2 minors non-zero unless D1 = D2 and the signs of 4's are the same.

If D1  ≠  D2, then system [\eqref=MainSys] has only a finite number of solutions by Theorem [\ref=Txyz]. We note that it always has solutions (x,y,z) = (0,2,2) and (x,y,z) = (1,P1,P2) corresponding to common elements 0 = U0(P1,Q1) = U0(P2,Q2) and 1 = U1(P1,Q1) = U1(P2,Q2).

The case of D1  =  D2 is addressed by the following theorem.

As discussed above, the intersection of {Un(P1,Q1)} and {Un(P2,Q2)} can be infinite only if their discriminants are equal, i.e., P21  -  4Q1  =  P22  -  4Q2.

If Q1 = Q2 then P1  =  P2, which is not the case for distinct sequences.

If Q1 =  - Q2 then P21  -  P22  =    ±  8, implying that (P1,P2) = (3,1) or (P1,P2) = (1,3) and thus the sequences are {Un(1, - 1)} and {Un(3,1)}. Since Un(3,1) = U2n(1, - 1) for every integer n, {Un(3,1)} represents a subsequence of Un(1, - 1), implying that they have an infinite intersection:

[formula]

Intersection of a U-sequence and a V-sequence

If an integer x belongs to the intersection {Un(P1,Q1)} and {Vn(P2,Q2)}, where |Q1| = |Q2| = 1, then [\eqref=MainEq] implies that x satisfies a system of Diophantine equations:

[formula]

where D1  =  P21  -  4Q1 and D2  =  P22  -  4Q2. The matrix of its coefficients

[formula]

has all 2  ×  2 minors non-zero unless D1 = 1, which is not possible. By Theorem [\ref=Txyz], system [\eqref=UVSys] has only a finite number of solutions.

Intersection of two V-sequences

If an integer x belongs to the intersection {Vn(P1,Q1)} and {Vn(P2,Q2)}, where |Q1| = |Q2| = 1 and (P1,Q1)  ≠  (P2,Q2), then [\eqref=MainEq] implies that x satisfies a system of Diophantine equations:

[formula]

where D1  =  P21  -  4Q1 and D2  =  P22  -  4Q2. The matrix of its coefficients

[formula]

has all 2  ×  2 minors non-zero unless the signs of 4's in the r.h.s. are the same. In the case of distinct signs in the r.h.s. of system [\eqref=VSys], it has a finite number of solutions by Theorem [\ref=Txyz]. Below we address the case of the same signs, which leads to the following system of equation:

[formula]

The second equation of system [\eqref=VSys2] always has a solution y = z = 0 corresponding to the common element 2 of any two V-sequences. On the other hand, the system has nonzero solutions only if the product D1D2 is a square.

As shown above, the intersection of Vn(P1,Q1) and Vn(P2,Q2) can be infinite only if the product of their discriminants D1 = P21  -  4Q1 and D2 = P22 - 4Q2 is a square. To prove the converse, assume that D1D2 is a square, i.e., D1  =  cd21 and D2  =  cd22 for some integers d1, d2 with gcd (d1,d2) = 1, and non-square integer c.

We first note that in this case, system [\eqref=VSys] with opposite signs in the r.h.s. does not have a solution. Indeed, it implies that

[formula]

and hence

[formula]

whose the only solutions x  =    ±  2 do not satisfy the original system [\eqref=VSys]. Therefore, the intersection of {Vn(P1,Q1)} and {Vn(P2,Q2)} necessarily represents the solutions to [\eqref=VSys] with the same signs in the r.h.s., which is equivalent to [\eqref=VSys2].

The general solution to the second equation of [\eqref=VSys2] is [formula] for [formula], where the signs are independent of each other. Plugging it into the first equation of [\eqref=VSys2], we get a Pellian equation:

[formula]

where [formula]

Notice that both D1 and D2 are congruent to 0 or 1 modulo 4, and so is D. Therefore, it has infinitely many solutions (x,t) = (xk,tk) of the form:

[formula]

where (x1,t1) is a solution with the smallest positive t1 (see [\cite=Cohen07], Proposition 6.3.16). It follows that the sequence xk is simply [formula].

Therefore, the intersection of Lucas sequences Vn(P1,Q1) and Vn(P2,Q2) forms Lucas sequence [formula].

Computing intersections

We note that the theorems in Section [\ref=SecBasic] have constructive proofs that allow straightforward implementation. A bottleneck of our approach in practice is Thue equations that are somewhat hard to solve. Nevertheless, there exist algorithms for solving Thue equations [\cite=Tzanakis1989] [\cite=Bilu1996], while PARI/GP computer algebra system [\cite=PARI] provides an implementation of such an algorithm. Below we present some numerical results obtained with the help of PARI/GP.

Intersection of Fibonacci and Pell numbers

To find the intersection of Fibonacci numbers Un(1, - 1) and Pell numbers Un(2, - 1), we first compute their discriminants D1 = 5 and D2 = 8 and plug them into system [\eqref=MainSys]:

[formula]

As it was shown in Section [\ref=SecUU], this system has only a finite number of solutions. We will find them all, following the outline of the proof of Theorem [\ref=Txyz]. First we obtain a homogeneous equation (depending on the choice of signs of 4's in the r.h.s.), resulting in two possible systems of equations:

[formula]

that we solve below.

Using a particular solution (x0,y0,z0) = (0,1,1) to the equation 3x2  +  y2  -  z2  =  0, from [\eqref=SolSys] we obtain a general solution:

[formula]

where the integers m,n as well as p,q are coprime, and q > 0 divides 6. Plugging these expressions into the first equation of [\eqref=FPSys], we obtain equations

[formula]

where p divides 2. Since the polynomial in the l.h.s. is irreducible, these equations are Thue equations.

According to PARI/GP, they have the following coprime solutions (m,n) and corresponding triples (x,y,z) (up to signs):

Using a particular solution (x0,y0,z0) = (1,2,3) to the equation - 13x2  +  y2  +  z2  =  0, from [\eqref=SolSys] we obtain a general solution:

[formula]

where the integers m,n as well as p,q are coprime, and q > 0 divides 234. Plugging these expressions into the first equation of [\eqref=FPSys], we obtain equations

[formula]

where p divides 2. Since the polynomial in the l.h.s. is irreducible, these equations are Thue equations. According to PARI/GP, they have the following coprime solutions (m,n) (up to simultaneous change of signs) and corresponding triples (|x|,|y|,|z|):

Intersections of some Lucas sequences

In this section we lists some interesting numerical results and pose related open questions. As before, we consider only on non-degenerate sequence and in addition exclude the sequences with (P,Q) = (3,1) corresponding to bisections of those with (P,Q) = (1, - 1).

We call the intersection of sequences Un(P1,Q1) and Un(P2,Q2) non-trivial if it contains an integer m > 1 different from P1 and P2. Examples of non-trivial finite intersections are

[formula]

For an integer m > 1, we can find all values of P > 0 such that m∈{Un(P,Q)} for some Q =   ±  1 by solving the equation (followed from Theorem [\ref=Trecog])

[formula]

In particular, the only integers m  ≤  109 that belong to two distinct sequences Un(P1,Q1) and Un(P2,Q2) for some P1  ≠  m, P2  ≠  m, and |Q1| = |Q2| = 1, are 5, 360, 528, and 1189. Are there any integers m > 109 with the analogous property?

Another notable intersection is

[formula]

which is the only intersection of size four that we are aware about. Does there exist any other?

Similarly, we call the intersection of Un(P1,Q1) and Vn(P2,Q2) non-trivial if it contains an integer m > 2 different from P1, and P2. Examples of non-trivial intersections are

[formula]

[formula]

In particular, the only integers m, 2  <  m  ≤  109, that belong the intersection Un(P1,Q1) and Vn(P2,Q2) for some P1  ≠  m, P2  ≠  m, and |Q1| = |Q2| = 1, are 3, 29, 34, and 82. Are there any integers m > 109 with the analogous property?

The intersections

[formula]

[formula]

have size 3. Are there any other?

Again, we call the intersection of Vn(P1,Q1) and Vn(P2,Q2) non-trivial if it contains an integer different from m > 2, P1, and P2. Examples of non-trivial finite intersections are

[formula]

[formula]

Are there any other non-trivial finite intersections?

Table [\ref=TinfVV1] gives all parameters (P1,Q1) and (P2,Q2) such that P1 < P2  ≤  1000, |Q1| = |Q2| = 1 and [formula] is infinite.

Lucas sequences with arbitrary initial terms

For fixed [formula], |Q| = 1, consider a sequence that satisfy the same recurrent relation as Un(P,Q) but with initial terms [formula]:

[formula]

It is easy to see that it can be expressed in terms of conventional Lucas sequences as follows:

[formula]

This representation allows us to define a counterpart sequence:

[formula]

It is easy to see that the generalized Lucas sequences satisfy an identity similar to [\eqref=MainEq]:

[formula]

where D = P2 - 4Q. However, there is no general analog of Theorem [\ref=Trecog] and hence the identity

[formula]

can be used only as a necessary condition for testing membership of x in Ua,bn(P,Q). In particular, while (x,y) = (8,34) is a solution to equation [\eqref=EqPellAB] for (P,Q,a,b) = (1, - 1,1,15), 8 is not an element of U1,15n(1, - 1).

The quadratic equation [\eqref=EqPellAB] allows one to compute the intersection of Lucas sequences with arbitrary initial terms and prove its finiteness similarly to the case of classic Lucas sequences.

Acknowledgements

The author thanks Rustem Aydagulov for a number of insightful discussions.