=10000 =10000

Anick-type resolutions and consecutive pattern avoidance

Introduction

The purpose of this paper is to present a formula for the multiplicative inverse for the formal series enumerating permutations avoiding the given set of consecutive patterns. There are various formulas of that sort, one based on a version of inclusion-exclusion principle, namely the cluster method of Goulden and Jackson [\cite=GJ2] [\cite=NZ], and another more recent and much more compact, based on the symmetric functions method of Mendes and Remmel [\cite=MR]. Our formula should be thought of as a mixture of these two: on one hand, it is based on combinatorial data somewhat similar to Goulden-Jackson clusters, on the other hand, it takes care of most cancellations which more resembles what happens in [\cite=MR].

In the case of pattern avoidance in words, a similar result was obtained by Anick [\cite=Anick]; however, the emphasis of his paper was on applications to homological algebra, and it never attracted attention of specialists in enumerative combinatorics. Consequently, a rather straightforward generalization of his method to the case of consecutive patterns in permutations has never been discovered. We present such a generalisation in this paper. Our intuition here comes from homological algebra as well; our construction is based on free resolutions of Anick type for shuffle algebras [\cite=Ronco] defined by generators and relations. This approach extends without any changes to the case of coloured permutations avoiding the given set of consecutive patterns [\cite=Ma]. For the original Goulden-Jackson formula, a homological proof can also be obtained, using constructions in the spirit of [\cite=DKRes]; we do not intend to discuss it in detail.

This paper is organized as follows. In Section [\ref=cluster] we briefly recall the Goulden-Jackson cluster method, define "chains" (which give an improved version of Goulden-Jackson clusters), and prove the inversion formula. To make most of the text accessible to the general mathematical audience, we chose to present the proof in the most elementary way, and use a sign-reversing involution instead of talking about boundary maps and chain homotopies.

In Section [\ref=examples], we consider various applications. Even staying within the cluster method, it is possible to solve some problems on consecutive pattern avoidance. In particular, we deduce a result in theory of pattern avoidance that seems to be new: for a permutation τ of length k without self-overlaps, the number of permutations of given length with the given number of occurrences of τ depends only on k, τ(1), and τ(k). This was formulated as a conjecture by Sergi Elizalde [\cite=Elizalde]. We also show how our method applies to patterns of length 4 (obtaining some formulas that seem to be new), simultaneous avoidance of some patterns of length 3, and a well known result on rises in permutations..

In Appendix, we briefly explain the homological algebra behind the story, putting our proofs in the context of homological algebra for shuffle algebras [\cite=Ronco] and ideals of the associative operad [\cite=Lat1] [\cite=Lat2].

The authors wish to thank Sergi Elizalde and Sergey Kitaev for their remarks. The work on this paper started when the second author was visiting Dublin Institute for Advanced Studies; he expresses his gratitude to all the staff there for their hospitality.

Clusters and chains

Consecutive pattern avoidance

Let us recall some definitions and notation. A permutation of length n is a sequence containing each of the numbers 1,, n exactly once. To every sequence s of length k consisting of k distinct numbers, we assign a permutation [formula] of length k called the standardization of s; it is uniquely determined by the condition that si  <  sj if and only if [formula], for example, [formula]. In other words, [formula] is a permutation whose relative order of entries is the same as that of s. We say that a permutation σ avoids the given permutation τ as a consecutive pattern if for each i < j we have [formula], otherwise we say that σ contains τ as a consecutive pattern. Throughout this paper, we only deal with consecutive patterns, so the word "consecutive" will be omitted. For historical information on pattern avoidance in general and the state-of-art for consecutive patterns, we refer the reader to [\cite=KitHist] [\cite=Stein].

The central question arising in the theory of pattern avoidance is that of enumeration of permutations of given length that avoid the given set of forbidden patterns P or, more generally, contain the given number of occurrences of patterns from P. This question naturally leads to the following equivalence relations. Two sets of patterns P and P' are said to be Wilf equivalent (notation: P≃WP') if for every n, the number of P-avoiding permutations of length n is equal to the number of P'-avoiding permutations of length n. This notion (in the case of one pattern) is due to Wilf [\cite=Wilf]. More generally, P and P' are said to be equivalent (notation: P≃P') if for every n and every 0  ≤  k < n, the number of permutations of length n with k occurrences of patterns from P is equal to the number of permutations of length n with k occurrences of patterns from P'.

While studying the equivalence classes of patterns, sometimes it is possible to replace the set of forbidden patterns by an equivalent one with less patterns in it. Namely, we have a partial ordering on the set of all permutations (of all possible lengths), namely, τ  <  σ if σ contains τ as a consecutive pattern. Given a set P of "forbidden" patterns, to enumerate the permutations avoiding all patterns from P, we may assume that P is an antichain with respect to this partial ordering. Indeed, ignoring all patterns from P that contain a smaller forbidden subpattern does not change the set of P-avoiding permutations. Therefore, throughout the paper we shall assume that forbidden patterns do indeed form an antichain.

Cluster method

The cluster method of Goulden and Jackson [\cite=GJ2] [\cite=NZ] is a powerful method of enumeration of words and permutations according to the number of consecutive occurences of certain patterns. Informally, a cluster is a way to link together several patterns from the given set. More precisely in the case of permutations q-clusters relative to the given pattern set P are triples [formula] such that

for every [formula], [formula], where rk is the length of πk (ik marks the occurrence of the [formula] pattern πk);

lk + 1 > lk (patterns are listed from the left to the right) and lk + 1 < lk + rk (adjacent patterns are linked);

l1 = 1, and the length of σ is equal to lq + rq - 1 (σ is completely covered by patterns [formula]).

Let us denote by πn,k the number of permutations of length n with exactly k occurrences of patterns from P, and by [formula] -- the number of q-clusters where the permutation σ has length n. We also consider the generating functions [formula] and [formula]. The following enumeration theorem is an immediate consequence of the cluster method.

We have

[formula]

Consequently, the exponential generating function for permutations avoiding patterns from the set P is

[formula]

Chains and series inversion

In this section, we show how to improve the cluster method inversion formula for pattern avoidance [\eqref=avoid_cluster] for a general pattern set P. Basically, for patterns without self-overlaps, there is nothing to improve: no cancellations happen in the formulas written above. However, in general a permutation σ can occur in several different q-clusters for different q, which will result in cancellations in Cl(x, - 1). We shall explain what combinatorial objects correspond to coefficients after these obvious cancellations. We still assume that P is an antichain, that is, patterns from P are not contained in one another.

The main combinatorial concepts we need are q-chains and their tails. They are defined inductively as follows:

empty permutation is a 0-chain, it coincides with its tail;

the only permutation of one element is a 1-chain, it also coincides with its tail;

each q-chain is a permutation σ equal to the concatenation σ'τ, where τ is the tail of σ, and [formula] is a (q - 1)-chain;

if we denote by τ' the tail of σ' in the above decomposition, there exists a "factorization" τ' = αβ with [formula], and βτ is the only occurrence of a pattern from P in τ'τ.

The way we define the chains here is slightly different from the original approach of Anick [\cite=Anick]; the reader familiar with the excellent textbook of Ufnarovskii [\cite=Ufn] will rather notice similarities with the approach to Anick's resolution adopted there.

Basically, (q + 1)-chains are q-clusters with additional restrictions: only neighbours are linked, the first q patterns form an q-chain, and no proper beginning forms an (q + 1)-chain (to be precise, one should apply standardization for the last two properties to make sense).

Let us give some examples clarifying the notion of a chain. For example, if P = {12}, the only n-chain for each n is [formula], while if P = {123}, we can easily see that 123 is the only 1-chain, and 1234 is the only 2-chain, but 12345 is not a 2-chain because it starts from a 2-chain 1234, and is not a 3-chain because in the only tiling of this permutation by three copies of our pattern its first and third occurences overlap:

[formula]

If σ is an n-chain, the way to link patterns from P to one another to form σ is unique.

Assume that there are two ways to link n patterns to form σ. Obviously, for each m, the endpoints of the [formula] patterns in these two linkages should coincide, otherwise we shall find an m-chain whose proper beginning is an m-chain as well. Once we know that the endpoints of [formula] patterns are the same, the beginnings have to be the same because P is assumed to be an antichain (and so patterns from P cannot be contained in one another).

Let us denote by cn,k the number of k-chains in Σn; we put

[formula]

We also denote by an the number of permutations in Σn avoiding all patterns from P. Our main result here is that the corresponding exponential generation functions are multiplicative inverse to one another. Namely, let

[formula]

We have

[formula]

Let Mn,k be the set of all permutations γ∈Σn decomposed as a concatenation σλ where [formula] is a k-chain, and λ is avoiding all patterns from P. We put [formula]. We shall distinguish different factorisations of the same γ, so we adopt the notation σ|λ with a bar between the factors for elements of M.

We define an involution I:M  →  M as follows. We have σ  =  σ'τ, where τ is the tail of σ, and there are two possibilities: either τλ is avoiding all patterns from P, or τλ  =  τ'πλ', where [formula], and π is the leftmost occurrence of a pattern from P in τλ. In the first case, we put I(σ|λ) = σ'|τλ. In the second case, we put I(σ|λ) = σ'τ'π|λ'. Informally, if it is possible to move the tail of σ through the bar without creating occurrences of forbidden patterns, we do it, and otherwise we extend σ to a (k + 1)-chain using some elements in the beginning of λ. It is obvious that I is an involution. Also, it is clear that it changes the parity of the parameter k. Thus, for each [formula], the [formula] coefficient of A(t)C(t), that is

[formula]

is equal to 0 (which implies the formula [\eqref=master]). Indeed, the number [formula] is the number of elements in [formula] for which [formula] is a permutation of p elements. The above sum of these number with appropriate signs compute the difference between the number of such elements where k is even and the number of such γ's where k is odd. However, our involution establishes a bijection between these two subsets, so this difference is equal to 0, as required.

Examples

Before moving on to particular results, let us state a general remark. Our results suggest that the class of power series that contains all inverses of pattern avoidance enumerators is related to some nice combinatorics. Results of Elizalde and Noy [\cite=EN] that we re-prove in Section [\ref=app-cluster] describe some of these series as solutions to particular differential equations. Our formulas for other cases we considered can be rewritten as more complicated functional equations. What can be said about other series of that sort? From our approach it is always possible to derive recurrence relations, provided some additional statistics are taken into account. However, so far we were not able to describe a reasonable class of series that cover all of these. For example, a wild guess is that all these series satisfy algebraic differential equations, that is, if f(x) is such a series, then [formula] for some polynomial P.

Applications of the cluster method

Patterns without self-overlaps, unlabelled clusters, and posets

There are fairly many situations where clusters are the same as chains. In this section, we consider some of these situations, namely, the case of an arbitrary pattern without self-overlaps, the case of one pattern of length 4, and the pair of patterns (132,231).

A pattern τ∈Σm is said to have no self-overlaps if every permutation of length at most 2m - 2 has at most one occurrence of τ. (Clearly, there always exist permutations of length 2m - 1 with two occurrences of τ.)

For example, the pattern 132 is of that form: clearly, we can only link it with itself using the last entry. A more general example studied in [\cite=EN] is [formula], where a + 1 < n, and τ is an arbitrary permutation of the numbers [formula].

For a pattern τ without self-overlaps, there exists a simple way to reformulate the enumeration problem for clusters in terms of total orderings on posets. The first author used this method in [\cite=DVJ] in a similar setting, dealing with tree monomials in the free shuffle operad. Let form an "unlabelled cluster" of the shape that we expect, namely, replace temporarily each entry in the expected cluster by the symbol [formula] (a bullet). For example, for the pattern 1243 we get

[formula]

For such an unlabelled cluster γ, let us define a partial ordering on the set of bullets of γ as follows: for each j, we equip the [formula] bullet pattern with a total ordering inherited from the real pattern τ. Let us denote by Πγ the thus defined poset.

Let us take the bullet pattern above, and replace bullet by letters, to make it easier to distinguish between the different bullets:

[formula]

Then the orderings inherited from 1243 are a < b < d < c, d < e < g < f, and g < h < i < j, so we obtain the poset

[formula]

(the covering relation of the poset is, as usual, represented by edges; v is covered by w if w is the top vertex of the corresponding edge).

The following proposition is obvious.

The set of k-clusters for P = {τ}, where τ has no self-overlaps is in one-to-one correspondence with the set of all total orderings on posets Πγ for unlabelled k-clusters γ.

Now we shall see how this approach can be applied in some cases.

Case of the pattern [formula]

Let a < m, and let [formula] be a permutation in Σm + 1 which starts from the rise [formula], followed by some permutation τ of [formula], followed by the number (a + 1). Clearly, this pattern has no self-overlaps, so to enumerate clusters we may count total orderings of posets. Note that every k-cluster for [formula] is of length k(m + 1) - (k - 1) = km + 1.

For [formula], the number of k-clusters is equal to

[formula]

This proof serves us as a starting example of how to use posets to study clusters. The poset which we need to enumerate k-clusters in this case looks like a tree of height m + 1 with the only branch growing on the height a + 1, this branch being of length m + 1 and having a smaller branch growing at the distance a + 1 from the starting point etc. (An example of such a poset for the case of the permutation 1243 with a = 2, m = 3 is given above.) To extend such a partial ordering to a total ordering, we should make the lowest a + 1 elements for such a tree the smallest elements [formula] of the resulting ordering. Then, there are [formula] ways to choose m - a remaining elements forming the stem of our tree, and we are left with the same question for a smaller tree, where we may proceed by induction.

For a < m, the multiplicative inverse of the generating function Π counting occurrences of [formula] is given by the formula

[formula]

In particular, all these patterns, for different τ, are equivalent to each other.

Except for the case of the pattern 123≃321, this covers all patterns of length 3, because 132≃312≃231≃213. We shall deal with the pattern 123 and, more generally, [formula], in section [\ref=app-chain].

Case of one arbitrary pattern without self-overlaps

Generalizing the previous result, let us consider an arbitrary pattern τ∈Sm + 1 without self-overlaps. Then every k-cluster for [formula] is of length km + 1. The following result was conjectured in [\cite=Elizalde], where it was proved in some particular cases. Another proof in the general case was, as we were informed by Sergey Kitaev, obtained by Jeffrey Remmel, the proof being based on methods developed in [\cite=MR].

For a pattern τ∈Sm + 1 without nontrivial self-overlaps, the number of permutations of length n with k occurrences of τ depends only on m, τ(1), and τ(m + 1). In other words, two non-self-overlapping permutations in Sm + 1 are equivalent if their first and last entries are the same.

This result is also very easy to derive using posets. To make formulas compact, let us put a = τ(1) - 1 and b = τ(m + 1) - 1. The poset whose total orderings enumerate k-clusters is obtained from k totally ordered sets of cardinality m + 1 as follows: the element a + 1 of the second set is identified with the element b + 1 of the first set, the element a + 1 of the third set is identified with the element b + 1 of the second set, etc. Clearly, this poset depends only on m, a, and b.

The actual number of k-clusters in this case can be computed as follows. Let us denote by fk(p) the number of k-clusters σ with σ(1) = p + 1. Then it is easy to see that the following recurrence relation holds (here we assume, without the loss of generality, that a < b):

[formula]

Indeed, if we denote q + 1 = σ(m + 1), there are [formula] ways to choose elements less than σ(1) in the first pattern in the cluster, [formula] ways to choose elements greater than σ(m + 1) there, [formula] to fill the space between these elements, and fk - 1(q - b) ways to choose the remaining (k - 1)-cluster.

Theorem [\ref=wilf] shows that two patterns 23154 and 21534 are equivalent to each other. Computing the first ten cluster numbers and inverting the corresponding series, we get the first ten entries 1, 1, 2, 6, 24, 119, 708, 4914, 38976, 347776 of the sequence counting permutations that avoid either of them.

Clusters and chains for patterns of length 4

Let us now consider patterns of length 4. The equivalence classes of these are as follows (see [\cite=Elizalde]):

[formula]

[formula]

[formula]

[formula]

[formula]

[formula]

[formula]

The case I will be considered in Section [\ref=app-chain]. In each of the cases VI and VII, the pattern has no self-overlaps, so Corollary [\ref=1non] applies.

A very special feature of all patterns of length 4 (except for the case I) is that they only have self-overlaps of lengths 1 and 2, so patterns in a cluster overlap only if they are neighbours. Moreover, in this case chains actually coincide with clusters. Let us explain that. In fact, we shall show that even in the case of self-overlapping patterns, every labelling of an unlabelled chain that is compatible with ordering of each of the patterns gives a genuine chain. Let us show that for the pattern 1324, in other cases the proof is similar. Assume that there is a labelling of some unlabelled m-chain c for which its proper beginning is a linkage of m patterns as well, and that m is the smallest possible integer for which it happens. Then, clearly, the first (m - 1) patterns in both c and its beginning are the same, and the linkages of the [formula] pattern with the [formula] one differ. However, this would mean that the following unlabelled chain has a consistent labelling:

[formula]

but for each labelling the orders of fourth and the fifth bullet coming from the second and the third bullet pattern contradict one another, which is impossible.

Case of the pattern 1324

The cluster numbers [formula] for 1324 satisfy the recurrence relations

[formula]

with initial conditions c1,l  =  δ0,l, c2,l = 0, c3,l = 0. Consequently, the generating function for occurrences of 1324 is

[formula]

Counting clusters is reduced to counting total orderings of the corresponding posets. Let us assume that the first k + 1 patterns have two-element overlaps, and the following overlap involves just one element. For a cluster with [formula], this means that

[formula]

that [formula], and that [formula] is an (l - k)-cluster. To prove [\eqref=rec-catalan], we notice that the number of permutations [formula] of [formula] for which the conditions [\eqref=catalan] are satisfied is given by the number of standard Young tableaux of size 2  ×  k: clearly, a1 = 1, a2k + 2 = 2k + 2, and

[formula]

gives a bijection with standard Young tableaux. The number of such tableaux is equal to the Catalan number [formula] (see, for example [\cite=Stan]), and the recurrence relation [\eqref=rec-catalan] follows.

Computing the first ten cluster numbers and inverting the corresponding series, we get the first ten entries 1, 1, 2, 6, 23, 110, 632, 4229, 32337, 278204 of the sequence which is indeed counting permutations that avoid 1324 (A113228 in [\cite=oeis]).

Case of the pattern 1423

The cluster numbers [formula] for 1423 satisfy the recurrence relations

[formula]

with initial conditions c1,l  =  δ0,l, c2,l = 0, c3,l = 0. Consequently, the generating function for occurrences of 1423 is

[formula]

Similarly to the proof of Theorem [\ref=1324], counting clusters is reduced to counting total orderings of the corresponding posets. Let us assume that the first k + 1 patterns have two-element overlaps, and the following overlap involves just one element. For a cluster with [formula], this means that

[formula]

so

[formula]

[formula], a2k + 2 = k + 2, and [formula] is an (l - k)-cluster. To prove [\eqref=shuffling-rec], we notice that the number of way to distribute numbers between the increasing sequence [\eqref=shuffling] and the (l - k)-chain [formula] is equal to the number of way to choose the k numbers [formula]. The latter is clearly the binomial coefficient [formula], and the recurrence relation [\eqref=shuffling-rec] follows.

Computing the first ten cluster numbers and inverting the corresponding series, we get the first ten entries 1, 1, 2, 6, 23, 110, 631, 4218, 32221, 276896 of the sequence counting permutations that avoid 1423.

Case of the pattern 2143

The cluster numbers [formula] for 2143 are given by the formula

[formula]

where the numbers cn,l(p) satisfy the recurrence relations

[formula]

with initial conditions c1,l(p) = δ0,lδ1,p, c2,l(p) = 0, c3,l(p) = 0. Consequently, the generating function for occurrences of 2143 is

[formula]

Similarly to the proof of Theorem [\ref=1324], counting clusters is reduced to counting total orderings of the corresponding posets. Let cn,l(p) be the number of l-clusters for which σ is a permutation of length n with σ(1) = p. Let us assume that the first k + 1 patterns in our cluster have two-element overlaps, and the following overlap involves just one element. For a cluster with [formula], this means that

[formula]

so

[formula]

and [formula] is an (l - k)-cluster. Assume that a1 = p. To prove [\eqref=2143-rec], we notice that if a2k + 2 = q, then there are [formula] ways to pick the numbers [formula], p - 1 ways to pick a2, (n - q) ways to pick a2k + 1, and cn - 2k - 1,l - k ways to pick the remaining (l - k)-cluster (where the entry q is [formula] biggest). This completes the proof.

Computing the first ten cluster numbers and inverting the corresponding series, we get the first ten entries 1, 1, 2, 6, 23, 110, 631, 4223, 32301, 277962 of the sequence counting permutations that avoid 2143.

In the last remaining case (II in the list above), we have no trick like above that would simplify the computations, so we shall use the most general strategy for chain enumeration, which allows to compute the chain numbers rather fast (polynomially in n) for all sets of forbidden patterns. There is an obvious similarity with the approach of Kitaev and Mansour in [\cite=KitManMult].

Case of the pattern 2413

The cluster numbers [formula] for 2413 are given by the formula

[formula]

where the numbers cn,l(p,q) satisfy the recurrence relations

[formula]

with initial conditions c2,l(p,q) = 0, c3,l(p,q) = 0, c4,l(p,q) = δl,1δp,2δq,4. Consequently, the generating function for occurrences of 2143 is

[formula]

This statement is straightforward. Indeed, let us consider an n-cluster with [formula]. The first pattern in that cluster intersects with its neighbour by either two or one elements. In the first case, we have a3 < a2 < a4 < a1, so if we fix a1 and a2, and forget about them, we are left with an (n - 1)-cluster, and we should sum over all choices of a3 and a4 for its first entries. If, on the contrary the first overlap uses just one element, then there are (a1 - 1) choices for a3, and we should distinguish between the cases a5 > a2 and a5 < a2: in the first case a5 is the [formula] biggest in the remaining cluster, while in the second case it is the [formula] biggest.

Computing the first ten cluster numbers and inverting the corresponding series, we get the first ten entries 1, 1, 2, 6, 23, 110, 632, 4237, 32465, 279828 of the sequence counting permutations that avoid 2413.

Case of two patterns {132,231}

The following theorem is mentioned in [\cite=Elizalde].

The cluster number [formula] is not equal to zero only for n = 2l + 1, and in this case is equal to E2l + 1, the tangent number [\cite=Stan], so the generating function for occurrences of {132,231} is

[formula]

This pair of patterns has no self-overlaps at all (both for a pattern with itself, and two patterns with each other); clearly, clusters are nothing but "up-down" permutations, that is permutations [formula] for which [formula]. It is well known that the number of such permutations is equal to the tangent number. The square roots in [\eqref=tan] account for the fact that every up-down permutation of length 2l + 1 is an l-cluster.

Applications of the chain method

The cases we consider in this section are some of those where the number of k-chains is substantially smaller than the number of k-clusters. For example, this happens if the set of forbidden patterns contains the pattern [formula], which marks rises of length a in permutations.

Case of the pattern [formula]

The following result is well known.

The multiplicative inverse of the exponential generating function for patterns avoiding [formula] ("permutations without a consecutive rises") is given by the formula

[formula]

Indeed, k-chains for [formula] are as follows:

the only 2-chain is

[formula]

;

the only 4-chain is

[formula]

;

the only (2k)-chain is

[formula]

;

Our next result classifies chains for {123,132}. It is interesting to compare it with the result of Claesson [\cite=Claesson] stating that the number of permutations of length n avoiding {123,132} is equal to the number of involutions of length n.

Case of two patterns {123,132}

The numbers cn,l of l-chains of length n for {123,132} satisfy the recurrence relations

[formula]

with initial conditions c1,l  =  δ1,l, c2,l = 0. Consequently, the exponential generating function for permutations avoiding {123,132} is

[formula]

The permutation 132 has no self-overlaps with itself, and have one nontrivial overlap with 123. It is easy to see that every l-chain for this pair of permutations is either an l-chain for 123 or, for some k  ≤  l it starts from a (k - 1)-chain for 123 which overlaps with 132 (by one or two entries, depending on the parity of k, as for the single pattern [formula] in Theorem [\ref=rise]), which overlaps by its last entry with an (l - k)-chain. The only parameter here that varies is the entry in the place of 3 for 132. Taking that into account, we obtain the above recurrence relation. In it, the first summand counts chains for 123, while the two sums take care of the segment to the first occurrence of 132 for both possible parities.

Computing the first ten chain numbers and inverting the corresponding series, we recover the first ten entries 1, 1, 2, 4, 10, 26, 76, 232, 764, 2620 of the sequence counting involutions (A000085 in [\cite=oeis]).

Appendix: a homological interpretation of the main result

In this section, we discuss another interpretation of the formula [\eqref=master], putting our bijection I in the context of homological algebra for shuffle algebras [\cite=Ronco] and of modules over the associative operad [\cite=Lat1] [\cite=Lat2].

Shuffle algebras

A shuffle algebra, as defined in the paper of Maria Ronco [\cite=Ronco], is a graded vector space [formula] together with maps

[formula]

subject to certain associativity condition. Here Sh(n,m) denotes the set of all (n,m)-shuffles, that is permutations σ∈Sn + m for which [formula] and [formula].

One can slightly re-phrase this definitition. Define a new monoidal structure on graded vector spaces as follows: if [formula] and [formula] are two graded vector spaces, we put

[formula]

This defines a monoidal structure on graded vector spaces, and a shuffle algebra is a monoid in this category. The advantage of this approach is that arbitrary constructions and definitions available for monoidal categories (modules, homology, resolutions) enter our story for free.

Within the framework of shuffle algebras, our results of Section [\ref=chains] should be stated as follows. It is easy to see that the graded vector space [formula] is a shuffle algebra; moreover, this shuffle algebra is a free shuffle algebra with one generator of degree 1 [\cite=Ronco].

Let A be the graded vector space whose [formula] component An is spanned by all permutations avoiding permutations from the given set P. In other words, A is the quotient of the free shuffle algebra with one generator by the two-sided shuffle ideal generated by all permutations from P. We shall now exhibit a free right module resolution of it trivial right module. Let C be the graded vector space whose [formula] component Cn is spanned by n-chains. Using the involution I, one can endow the graded space [formula] with a structure of a chain complex. The differential d of this complex maps a basis element σ|λ (in the notation of Section [\ref=chains]) to 0, if I moves the bar in this element to the right, and to I(σ|λ) if I moves the bar to the left. Clearly, d2 = 0, and this complex is acyclic in positive degrees, so it is a resolution of the trivial module. Computing Euler characteristics of its graded components results in the equation [\eqref=master].

Modules over the associative operad

This last section is intended for those readers whose intuition, as it is for us, comes from the operad theory. Essentially, it re-tells the shuffle algebra approach in a slightly different way, explaining also the place for classical pattern avoidance in the story.

Studying varieties of algebras, that is, algebras satisfying certain identities, goes back to works of Specht [\cite=Specht]. The notions of T-ideals and T-spaces formalize the ways to derive identities from one another. One natural way to study identities is to define an analogue of a Gröbner basis for an ideal of identities. This approach is taken in works of Latyshev [\cite=Lat1] [\cite=Lat2] who suggested a combinatorial approach to study associative algebras with additional identities via standard bases of the corresponding T-spaces. His approach can be described as follows. For each "T-space" (in other words, right ideal in the associative operad), he defines a version of a Gröbner basis; such a basis would allow to study arbitrary relations via monomials avoiding certain patterns. Here, for once, by a pattern we mean a classical pattern (its occurrence does not have to be as a consecutive subword). This approach has a slight disadvantage. Namely, even though the actual Gröbner bases of relations are expected to be finite (at least, the famous result of Kemer [\cite=Kemer] states that in principle there exists a finite set of generating identities), they are difficult to compute, as there is no algorithm comparable to the one due to Buchberger in the associative algebra case [\cite=Ufn]. Somehow, this trouble disappears if we study left ideals in the associative operad. In terms of divisibility of monomials, left and right ideals lead to two very different combinatorial problems: right divisibility translates into occurrences of classical patterns, whereas left divisibility yields occurrences of consecutive ones! For consecutive patterns, the intuition of [\cite=DK] [\cite=DKRes] for Gröbner bases and resolutions applies directly, and our results can be interpreted in terms of appropriate free left module resolutions. Let us remark that the difference between chains and clusters is exactly the same as the difference between the Anick's resolution for associative algebras and the not-quite-minimal resolution constructed in [\cite=DKRes]; in this framework we managed to obtain an explicit canonical minimal resolution, unlike what happens in the general operadic case.