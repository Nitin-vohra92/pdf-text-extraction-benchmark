On the base b expansion of the number of trailing zeroes of bk!

Introduction

It is a classic topic in Elementary Number Theory to compute the number of trailing zeroes of the base 10 expansion of the factorial of an integer (see [\cite=GRI], [\cite=GUP] or [\cite=NIV] for instance). In fact, this question can be extended to arbitrary bases and in [\cite=OLL] the behavior of the function Zb was studied in detail.

In recent work (see [\cite=HAR], motivated by [\cite=SCH]), the following particularity about the number of trailing zeroes in the factorial of the powers of 10 was shown:

[formula]

Although the sequence of final 9's is broken for some values of the exponent, it seems clear that the number of 9's grows indefinitely. For instance:

[formula]

This behavior and the fact that the number of digits of Z10(10m) is m, motivated the study of the asymptotic behavior of [formula] in [\cite=TRE], where it was shown (as suggested by the previous examples) that: Also, in [\cite=TRE] was suggested (and was proved in [\cite=HAR]) that if [formula], then:

Now, it is natural to wonder about what will be the behavior of the digits of Zb(bk) for other values of b. Let us have a look at the case k = 20 for various values of b:

[formula]

In the light of this data, it may seem that the only interesting behavior takes place at the multiples of 10. Nevertheless, this is not the case, as can be seen having a look at the base b expansion of the considered number:

[formula]

Of course, the origin of these cyclic repetitions is closely related to the periodic expression of [formula] when expressed in base b. In this paper we study the relation between ϑ(b) and the base b expansion of Zb(bk). If b is a prime power, we will show the equality between the k digits of Zb(bk) and the first k digits in the fractional part of ϑ(b) (i. e., ⌊ϑ(b)bk⌋). In the general case this equality does not hold. We are then interested in investigating the number of final digits of Zb(bk) which break the previous coincidence. To do so, let us consider η(b,k): = ⌊ log b(⌊ϑ(b)bk⌋ - Zb(bk)) + 1⌋. This represents the number of digits of the base b expansion of ⌊ϑ(b)bk⌋ - Zb(bk) and observe that the number of unequal final digits between ⌊ϑ(b)bk⌋ and Zb(bk) is at most η(b,k) + 1. We will show that

[formula]

is the best possible upper bound for η(b,k). Nevertheless, we will improve this upper bound in the case when b is square-free and present some conjectures about this bound.

The paper is organized as follows, in the second section we present the basic facts and technical results that will be used in the rest of the paper. In the third section we study the prime-power case, establishing the equality between the k digits of Zb(bk) and the first k digits of the base b expansion of ϑ(b). Finally, in the fourth section, we study the general case, where the latter equality does not hold and give a bound to the number of unequal digits.

Technical results

In this section we present some technical results which will be very useful in the sequel. Some of them are well-known and are presented without proof. The section is divided into three parts, the first is devoted to results related to Zb(bk), the second mostly deals with the base b expansion of ϑ(b) when b is a prime-power and the third one is devoted to present the main lemma which will be crucial in the paper.

Some results about Zb(n)

We start this subsection with the following well-known lemma, which was first proved by Legendre (see [\cite=LEG]), that we present without proof.

[formula], where σp(n) is the sum of the digits of the base p expansion of n.

[formula] for every [formula].

If [formula], then [formula].

As a straightforward consequence of the preceding lemma we obtain:

Let l be any integer and p be a prime. Then:

[formula]

Recall that [formula]. In [\cite=HAR] and [\cite=TRE] an explicit expression for ϑ(b) was given. Namely:

If [formula], then:

[formula]

The sequence [formula] appears in The On-Line Encyclopedia of Integer Sequences as sequence A090624. It is interesting to observe that it was included in the Encyclopedia 5 years before the formula for ϑ(n) was found.

The following lemma will be of great importance in sections 3 and 4.

Let k  ≥  0 be an integer.

If b > 1 is an integer, then:

[formula]

If b is a prime power, then:

[formula]

Fist of all observe that k⌊x⌋  ≤  ⌊kx⌋ for all [formula], [formula] and that if [formula] and [formula] the inequality is strict. Now, for some prime divisor of b (with exponent r in the decomposition of b) we have that:

[formula]

since [formula] is not an integer, while [formula] is.

Put b = pn. Then, Corollary 1 implies that Zp(p(k + 1)n) = pnZp(pkn) + Zp(pn).

Now, if r is the reminder of the division between Zp(p(k + 1)n) and n and s is the reminder of the division between Zp(pkn) and n it follows that:

[formula]

[formula]

Thus, since 0  ≤  r,s  ≤  n - 1:

[formula]

The base pn expansion of ϑ(pn)

Let us start by introducing some notation. With [formula] we mean that the fractional part of q in base b consists of t digits followed by a periodic sequence of s digits (dt + i = dt + i + s for all i > 0). Clearly t can be arbitrarily large and the length of the period can be any multiple of s, so we will usually assume that t and s are minimal. We will say that q is exact in base b if there exists k  ≥  1 such that di = 0 for every i  ≥  k or di = b - 1 for every i  ≥  k; i.e.:

[formula]

Let p be a prime and [formula]. Then [formula] is exact in base pr if and only if p = 2 and r is a power of 2.

This is a straightforward consequence from the fact that [formula] is exact in base pr if and only if (n) = p; i. e., if and only if n is a power of p.

Now we will present some results about the base b expansion of ϑ(b) when b = pn is a prime-power.

Let p be a prime and b = pn with [formula]. Then:

[formula]

First of all observe that:

[formula]

Let us suppose that [formula]. Then we have that:

[formula]

and it is enough to substract both expressions to obtain that [formula].

Conversely, assume that [formula]. It is easy to see that there exists a sequence [formula], not eventually null, such that:

[formula]

Consequently:

[formula]

where

[formula]

[formula]

Since [formula] we have that:

[formula]

From this fact it readily follows that dt + i = dt + s + i and the proof is complete.

Let p be a prime, b = pn and [formula]. Then:

[formula]

Or, in other words:

[formula]

We can write n = prn' with r  ≥  0 and gcd (p,n') = 1. Then bk = pkn = pprn'k and observe that r < pr < prn' < prn'k.

Assume that [formula], then [formula] and, since gcd (p,n') = 1 it follows that [formula] and [formula]. But [formula] and we are done.

The converse is obvious.

The base pn expansion of ϑ(pn) is pure periodic or mixed periodic with only one non-periodic figure; i. e., either [formula] with ds + 1  ≠  d1 or [formula]

If [formula], then we have that [formula]. By the previous proposition this implies that [formula] and, consequently, [formula]. Finally, if ds + 1 = d1, then ϑ(pn) is pure periodic and this completes the proof.

The main lemma

The following lemma will be crucial in the next section.

Let [formula] be a sequence of integers and define Δ1: = S1 and Δn: = Sn + 1 - bSn. If 0 < Δn < b, for all [formula], then the following hold:

[formula].

[formula].

[formula].

If Δi = (b - 1) for all i > 1, then [formula] for every k > 1.

If [formula] is not exact in base b, then [formula] for every k.

If [formula], then there exists [formula] with s > 0 such that Δn + s  =  Δn (and Sn + s = Sn) for all n > t.

It follows from inductive arguments, since S1  =  Δ1.

Consequence of (1).

Observe that [formula] and take limits.

We must consider two cases.

If Δ1 < (b - 1), then [formula], [formula] and also:

[formula]

Now, if Δ1 = b - 1, then [formula] and:

[formula]

Observe that

[formula]

Now, if [formula] is not exact, it follows that [formula] and consequently:

[formula]

It is clear since the base b expansion of any rational number is periodic.

The prime power case

The next theorem establishes the equality between the digits of the base b expansion of Zb(bk) and the first k digits of the base b expansion of ϑ(b) if b is a prime power. In passing we will also prove some other interesting properties.

First of all observe that, due to Corollary 2, there exists an integer s such that [formula] or, equivalently, such that [formula]. Moreover, if [formula], then [formula]. Also, by Lemma 2, we have that 0 < ak < b so we are in the conditions of Lemma 5.

After these considerations we can proceed to the proof of the theorem.

Apply Lemma 5 (1).

Apply Lemma 5 (3).

Due to Corollary 2.

Idem.

Obvious by the minimality of s.

If [formula], then [formula]. This implies that [formula], so [formula] and, consequently,

[formula]

Now, if [formula] then [formula] so [formula] and it follows that:

[formula]

Consequently,

[formula]

If pn + 1 is not a Fermat number, then ϑ(pn) is not exact due to Lemma 4. Then, it is enough to apply Lemma 5 (5).

If pn + 1 is a Fermat number; then p = 2 and n is a power of 2. In this case ϑ(pn) is exact and Lemma 5 (4) applies.

Let us recall that a base-b repunit with k digits, R(b)k, is an integer whose base b expansion consists exactly of k ones; i. e.:

[formula]

In the same way, a base-b repdigit with k digits is a multiple of a base-b repunit with k digits, i. e., an integer of the form [formula] with 1  ≤  α  ≤  b - 1.

Let p be a prime. If [formula], then Zpn(pnk) is a base-pn repdigit with k digits for all [formula]. Namely:

[formula]

Theorem 1 implies that [formula], where [formula]. Consequently,

[formula]

It is interesting to particularize the previous result for n = 1,2.

Let p be a prime, then Zp(pk) is a base-p repunit with k digits for every integer k.

Follows immediately from the previous proposition, since [formula].

Let p be an odd prime, then Zp2(p2k) is a base-p2 repdigit.

If p is odd, then [formula].

If p is odd, the above corollary can be generalized for any power of 2. Namely, we have the following.

If p is an odd prime, then Zp2m(p2mk) is a base-p2mk repdigit.

[formula].

We have seen that [formula] for every prime p. Nevertheless, the set of pairs [formula] such that the base b1 expansion of ϑ(b1) and the base b2 expansion of ϑ(b2) coincide seems to be very small. In fact for [formula] there are only two such couples. Namely:

[formula]

The general case

If b is not a prime power, there is no equality between the k digits of Zb(bk) and the first k digits of the base b expansion of ϑ(b). As a consequence, Zb(bk) presents certain anomalies in its final digits. For instance:

[formula]

Or, in a different base:

[formula]

If ϑ(b) is not exact it is clear that any convergent sequence with limit ϑ(b) will share with this value an increasing number of digits. To prove that this is still true even if ϑ(b) is exact (like in the previous examples, where ϑ(10) = {0.25}10 and ϑ(6) = {0.3}6) we need to prove the following result.

The sequence [formula] is strictly increasing. As a consequence, [formula] for every k > 0.

[formula] due to Lemma 2 (1).

We have already seen in the previous section that if b is a prime power, then the number of digits of the base b expansion of Zb(bk) is exactly k. Now we will see that this is also true for a general b.

The number of digits of the base b expansion of Zb(bk) is exactly k; i. e.:

[formula]

By Lemma 2 (1), we know that bZb(bk) < Zb(b(k + 1)). Taking logarithms we have 1 +  log bZb(bk) <  log bZb(bk + 1), which clearly implies that [formula].

Thus, the number of digits of the base b expansion of Zb(bk + 1) is greater than that of Zb(bk). Since [formula], it follows that [formula].

Let us see now that the equality holds. Assume, on the contrary, that [formula] for certain k0. Then [formula] for every m  ≥  k0. This clearly implies that [formula] for every m > k0 and [formula], which is clearly a contradiction since by definition ϑ(b)  ≤  1, the equality only holds for b = 2 and [formula]

We have seen that in the general case the equality between the k digits of Zb(bk) and the first k digits of the base b expansion of ϑ(b) does not hold. It is then interesting to study how many digits differ.

To do so, let us introduce some notation:

[formula]

[formula]

Observe that the number of different digits that we are studying is, at most, η(b,k) + 1. Now we can give an upper bound for η(b,k).

If k = 1, then ⌊ϑ(b)b⌋ - Zb(b)  ≤  b, since [formula] and [formula]. This implies that [formula], as claimed.

Now, let k  ≥  2. Put [formula] and assume, without loss of generality, that p1 is such that [formula]. In that case [formula] and [formula]. Also observe that if [formula], then σp1(bk) = σp1(βk). Now:

[formula]

Consequently [formula].

The bound obtained in the previous theorem is the best possible one. In fact, there exists values of the pair (b,k) such that η(b,k) = ⌊ log bk + 2⌋. Namely, if k = b - 1 and b < 1000 the following values:

[formula]

satisfy that η(b,b - 1) = 2 = ⌊ log b(b - 1) + 2⌋.

The number of unequal digits between Zb(bk) and the first k digits of the base b expansion of ϑ(b) is smaller or equal than the number of digits of k plus 2.

The number of unequal digits is, at most, η(b,k) + 1 which, by the previous theorem, is smaller or equal than [formula].

It is interesting to observe that, as far as the authors have been able to test computationally, the inequality given in the preceding corollary is strict. Nevertheless we have not found a proof for this fact, so it remains a conjecture.

The number of unequal digits between Zb(bk) and the first k digits of the base b expansion of ϑ(b) is smaller or equal than the number of digits of k plus 1.

If b is square-free, we can improve the bound given in Theorem 2.

Let [formula] be a square-free integer (s  ≥  2). Then ϑ(b)bk - Zb(bk)  ≤  k(s - 1) for every k. As a consequence η(b,k)  ≤  ⌊ log bk +  log b(s - 1) + 1⌋  ≤  ⌊ log bk + 1.21⌋.

We can suppose, without loss of generality, that p1 is the greatest prime in the decomposition of b. Then [formula] and also Zb(bk) = Zp1(bk).

On the other hand, [formula], so we can find [formula] integers smaller that p1 such that

[formula]

As a consequence [formula] and recall that, by Corollary 1, [formula].

Finally, putting all together:

[formula]

To end the proof it is enough to recall the definition of η(b,k) and to observe that log b(s - 1) < 0.21.

The previous proposition can be refined in some special cases. For instance:

If b is the product of 2 distinct primes; i.e., if s = 2 is the proposition, then η(b,k)  ≤  ⌊ log bk + 1⌋.

If b is square-free and k is a power of b, then:

[formula]

This remark motivates this final conjecture, which remains open, that closes the paper.

If b is a square-free integer, then η(b,k)  ≤  ⌊ log bk + 1⌋.