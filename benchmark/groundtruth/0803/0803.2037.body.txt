Proposition Algorithm Theorem Conjecture Problem Properties Example Open Problem Hypothesis Construction Observation Corollary

Optimal spatial transportation networks where link-costs are sublinear in link-capacity

Department of Statistics 367 Evans Hall #  3860 U.C. Berkeley CA 94720 aldous@stat.berkeley.edu www.stat.berkeley.edu/users/aldous

Introduction

To design a transportation network linking specified points (visualized as cities) in the plane, one might specify a cost functional and a benefit functional on all possible networks, and then consider networks which are optimal in the sense of minimizing cost for a given level of benefit. This paper addresses one particular choice of functionals, but our broader purpose (see section [\ref=sec-methodology]) is to draw the attention of statistical physicists to this class of problem.

We study a simple model involving the "economy of scale" idea

One link of length [formula] and capacity 2c is less than twice as expensive as two links of length [formula] and capacity c.

We capture this idea by specifying that the cost of a link of length [formula] and capacity c scales as [formula] for some 0  <  β  <  1. In the real world, network designers do not know in advance what traffic demand will be. We simplify by assuming that traffic demand is known (and uniform over all source-destination pairs) and routes are controlled, so that the volume f(e) of flow across an edge (link) e can be determined by the designers, and the corresponding link-capacity built. (Visualize links as roads, and flow-volume f(e) as "number of vehicles per hour". We are ignoring stochastic fluctuations in traffic). Thus our cost structure is

[formula]

where [formula] length of link e.

To define the model carefully, write [formula] for a configuration of n vertices in the square 2 of area n. So xi is the position of vertex i. Create a connected network [formula] by adding links: links are line-segments with their natural Euclidean lengths, and links may meet at places not in the given vertex-set [formula]. To make the distinction clear let us refer to the given n vertices as cities and any meeting places (which depend on our choice of network) as junctions. Between each source-destination pair (i,j) of cities, flow of volume n- 3 / 2 (this scaling is explained below) is routed through the network. Define [formula], the cost of the network, via ([\ref=cost-def]). This setting specializes a setting considered by Gilbert [\cite=gilbert-MCCN], and we call the minimum-cost network the Gilbert network [formula]. See [\cite=thomas-weng] for general properties of, and heuristic algorithms for, Gilbert networks over deterministic points.

Gilbert networks may be optimal from a network operator viewpoint, but what about a network user? Write [formula] for route-length, and |xj  -  xi| for straight-line distance, between cities i and j. For a typical configuration, the average distance [formula] will be order n1 / 2. The kind of "benefit to users" we have in mind is that the network provides routes almost as short as possible. So we call the sequence of networks [formula] modestly efficient if

[formula]

The name reflects the remarkable fact [\cite=me116] that there exist extremely efficient networks for which this average is O( log n) while their length is only 1  +  o(1) times the minimum length of any connected network; such results pay no attention to flow-volumes or capacities, and so constitute the β  =  0 case of the present model. The problem we address in this paper is:

given the sequence [formula], how small can we make [formula] subject to the modestly efficient constraint ([\ref=modest])?

In the β  =  0 case just mentioned, we can make [formula] be asymptotically the length of the Steiner tree (minimum length connected network) on [formula], which is well known to be O(n) in the worst case and in the typical case. Recall that an  =  O(bn) means that an / bn is bounded as n  →    ∞  . It is often convenient to write the converse relationship bn  =  O(an) as an  =  Ω(bn); if both an  =  O(bn) and an  =  Ω(bn) then we write an  =  Θ(bn).

In the case β  =  1 there is no "economy of scale" and so the minimum-cost network is just the complete graph, that is a direct link between each pair of cities. The associated cost is

[formula]

which is O(n) in the worst case and in the typical case.

Recall that the Gilbert network [formula] is the minimum-cost network when there is no extra "modestly efficient" constraint. Theorem [\ref=T1] shows that imposing the "modestly efficient" constraint makes little difference in an order of magnitude sense: in either case the optimal cost grows roughly as order nα(β).

Fix 0  <  β  <  1. Define

[formula]

Let [formula] be a configuration of n cities in the square 2. (a) Case [formula]. There exist modestly efficient networks for which [formula] (except for β  =  1 / 2 the bound is O(n3 / 4 log n)). Under the technical assumption ([\ref=LB1]) there do not exist connected networks for which [formula]. So under ([\ref=LB1]) we have [formula] for [formula]. (b) Case [formula]. Here [formula]. Given ωn  →    ∞   arbitrarily slowly, there exist modestly efficient networks for which [formula]. Under the technical assumption ([\ref=LB2]), [formula], but there do not exist modestly efficient networks for which [formula].

Our discussion above of the cases β  =  0 and β  =  1 implies corresponding results in these cases with α(0)  =  1 and α(1)  =  1.

The transition at [formula] corresponds to the dominant cost contribution changing from short links to long links, as we will explain in section [\ref=sec-explain]. The technical regularity assumptions that we need to impose to obtain lower bounds reflect this transition: for β  <  1 / 2 we need to assume that nearest-neighbor distances are not atypically small, whereas for β  >  1 / 2 we assume a large-scale equidistribution of the city configuration. (We defer statements of these assumptions until the place they are actually used in the proof, to avoid interrupting the conceptual discussion here.) We show (section [\ref=sec-upper]) that the upper bounds arise in the following type of hierarchical networks, which are therefore optimal in an order of magnitude sense. On the large scale, use a sparse Poisson line process to provide long-range links. On the medium scale, use hierachical routing on the square lattice. On the small scale, link cities directly to medium-grid points. It is perhaps counter-intuitive that one can use the same network for the whole range of β; the point is that only the medium-small scale structure really matters for β  <  1 / 2 and only the large scale structure really matters for β  >  1 / 2. Our arguments implicitly imply some weak properties of the exactly optimal networks. Undestanding in detail the structure of the Gilbert network (or the asymptotically optimal modestly efficient network) over random points in the critical case β  =  1 / 2 is a challenging problem, interesting because one expects the network to have some scale-free stucture, in the (correct) sense of invariance under spatial and flow-volume rescaling.

One can imagine many variant models in which extra structure is incorporated. In section [\ref=sec-speed] we briefly discuss the case where links have designed speed s and where the cost of a link becomes [formula]; in this case an analog of Theorem [\ref=T1] remains true.

Optimal spatial network design methodology

This paper contributes to a general program concerning networks linking points in the plane:

for mathematically simple cost/benefit functionals, study the properties (geometry, cost and benefit values) of optimal networks as the number n of points tends to infinity.

Network design problems arise in many applied fields, but serious real-world modelling leads to more complicated functionals tuned to specific applications than we have in mind. As complementary work, [\cite=me116] gives a detailed treatment of the extremely efficient networks mentioned above that minimize average route length subject to total network length; and [\cite=me118] analyzes a model (for e.g. passenger air travel or package delivery) where there is a substantial cost to transfer from one link to another. In the latter model, theory predicts that hub-and-spoke networks (as seen in the real world) are near-optimal and that, constraining the average number of transfers to be say 2, the length of the shortest possible network scales as n13 / 10.

The methodological feature we want to emphasize concerns models for the position of n cities (assumed for simplicity in a square of area n). In each problem we have studied one gets the same order of magnitude for optimal network cost for worst-case positions as one gets for arbitrary positions (under mild assumptions) and in particular the same as for random positions or for regular (e.g. lattice) positions.

The bulk of statistical physics literature on spatial networks (surveyed in [\cite=hayashi-2006-47]) analyzes networks built according to some specific probability model which combines ingredients such as (a) geometric random graphs (link probability depends on inter-vertex distance); (b) proportional attachment probabilities for arriving vertices; (c) prescribed power law distribution of lattice vertex degrees; (d) networks based on recursive partitioning of space. This theoretical literature makes passing reference to optimality, but we have not seen analytic results demonstrating optimality over all possible networks in the spatial context (see [\cite=donetti06] for non-spatial results, and [\cite=bejan-book] [\cite=barth06] for assumptions under which optimal networks are trees). For interesting empirical work see [\cite=gastner-newman].

Our scaling conventions (a square of area n; flow-volume n- 3 / 2 between each source-destination pair) may seem arbitrary, but are chosen to fit the following standardizations: (i) cities have density 1 per unit area; (ii) flow volume across unit area is order 1.

The construction

A network satisfying the requirements of Theorem [\ref=T1] will be constructed in section [\ref=sec-tc] using mathematical ingredients described in sections [\ref=sec-hier] and [\ref=sec-PLP]. Figure 1 illustrates the construction.

Figure 1. Ingredients of the construction. Left: the hierarchical routing lattice, with higher-type edges indicated by thicker lines, and a typical route shown. Right: the large-scale grid and the Poisson line process.

Hierarchical routing on the square lattice

Fix M and consider the square grid on vertices [formula]. Declare lines (and their edges) to be of some type [formula] according to the rule:

the horizontal lines [formula] are type m

the boundary line {(x,0)} is type M;

and similarly for vertical lines. For each vertex (x,y), define a route from (x,y) to (0,0) using only downward and leftward edges as follows. First choose the edge at (x,y) of higher type (breaking ties arbitrarily). Then repeat the rule

Follow the current edge until it crosses an edge of strictly higher type, then transfer to that edge

until reaching (0,0). See Figure 1, left side.

It is elementary to verify

For each 0  ≤  m  ≤  M, the number of type-m edges traversed by the route is at most 2m + 1.

The Poisson line process

A line in the plane may be parametrized by the point z on the line which is closest to the origin (so the line segment from the origin to z is orthogonal to the line); then write z in radial coordinates as (r,θ). Recall [\cite=MR895588] the notion of a Poisson line process (PLP) of intensity η  >  0, which makes precise the notion of "completely random" lines in the plane. Parametrizing lines by by their closest points (r,θ), this PLP has intensity η with respect to Lebesgue measure on parameter space (0,  ∞  )  ×  (0,2π). The PLP distribution is invariant under Euclidean transformations, and for a fixed set A

[formula]

(We write [formula] for expectation and [formula] for probability). The next result shows how the PLP is useful in constructing spatial networks. See Figure 1, right side.

Let n1 / 2  /  σn be an integer. Construct a network as the superposition of the rectangular grid with cell side-length σn and the Poisson line process of intensity η, intersected with the square 2. Let vi,vj be vertices of the grid. Then

[formula]

for an absolute constant C2.

Lemma [\ref=med-large] is proved in [\cite=me116], Lemma 11, and we will not repeat the argument here. (In essence, one analyzes the natural routing algorithm: move to a nearby line of the PLP, move along that line in the direction closer to the direction of the destination city, and when encountering another line of the PLP, switch to that line if its direction is closer to the destination city direction). Using the PLP gives us random networks, but a typical realization will have costs and lengths of the same order as the expectations in our formulas.

Construction of the networks

We now describe how the ingredients above (hierarchical routing on the square lattice, the PLP) are used in a network construction. Recall [formula] denotes the given configuration of n cities. Take integers [formula] slowly and define

[formula]

Let Mn be the integer such that

[formula]

Define

[formula]

Construct a network [formula] as follows.

(i) Take the large-scale network in Lemma [\ref=med-large], with ηn  =  θnn- 1 / 2. This network contains large cells of side-length σn.

(ii) Inside each large cell put a copy of the hierarchical routing lattice of section [\ref=sec-hier], with M  =  Mn, and scaled so that the basic small cell of this lattice has side-length sn.

(iii) Link each city [formula] via a straight edge to the bottom left corner vertex v(x) of its small cell.

Figure 1 illustrates (i) and (ii). There is a natural way to define a route from xi to xj in this network. From xi take the link to v(xi), then follow the section [\ref=sec-hier] routing scheme to the lower left corner V(xi) of the large cell; navigate from V(xi) to V(xj) via the shortest route in the Lemma [\ref=med-large] graph.

Note that in addition to the given n cities, this network has several different kinds of junctions: the vertices of the grid, and places where lines of the PLP cross each other or cross the grid lines or cross the short stage (iii) links. In our model there is no cost associated with creating a junction or with routes using junctions; the costs involve only link lengths and route lengths. So the exact number of junctions is unimportant.

Analysis of the networks

Clearly

[formula]

and so by Lemma [\ref=med-large]

[formula]

From the definitions of σn,ηn we see

[formula]

establishing the modestly efficient property.

To analyze costs, we treat stages (i)-(iii) separately, and check that each stage cost is less than the bounds stated in Theorem [\ref=T1].

Stage (iii). There are n links of the form (x,v(x)), each carrying flow volume [formula], and each having length at most [formula], and so

[formula]

Stage (ii). Now let m be the set of type-m edges. The number of such edges is   #  m  =  O(n2- m). Recall that Hölder's inequality shows that for any edge-set [formula]

[formula]

Now

[formula]

using Lemma [\ref=LmM]. Thus

[formula]

Writing med for all edges in the copies of the hierarchical routing lattice, we find after summing over 0  ≤  m  ≤  M

[formula]

using 2M  <  n1 / 2. Because edge-lengths here are sn  <  2, these are bounds for the costs associated with stage (ii).

Stage (iii). Write large for the set of links of the large-scale network, that is the large-scale grid and the PLP lines. Flow along the route from V(xi) to V(xj) contributes [formula] to the "flow ×   distance" measure, and so

[formula]

where the left side denotes integrating along all links of the large-scale network. By the already-established modestly efficient property,

[formula]

and so

[formula]

The total length Ln of large is the sum of O(n1 / 2θn) (=   contribution from large-scale grid) and O(ηnn) (=   contribution from the PLP, using ([\ref=PLP-a])), and so Ln  =  O(n1 / 2θn). The integral form of Hölder's inequality now shows that the cost associated with large is :

[formula]

Examining the cost of each stage, we check that the modestly efficient network we have constructed has its cost bounded as stated in Theorem [\ref=T1]. Moreover, if we eliminate the "modestly efficient" constraint then we can eliminate Stage (iii) of the construction (take θn  =  1) and get the stated O(nα(β)) upper bound.

The transition at β  =  1 / 2

To summarize, the costs associated with the constructed networks arising from short, medium and large-scale links are bounded by expressions ([\ref=cost-small],[\ref=cost-med],[\ref=cost-large]) respectively. By examining the exponents of n we see that the transition at [formula] corresponds to the dominant cost contribution changing from short links to long links. The arguments we give below for the lower bound show this is a genuine effect (no alternate networks can do essentially better), not an artifact of the particular networks contructed above.

The lower bound

In the settings of [\cite=me116] [\cite=me118] the lower bounds require some effort to prove, but in the present setting the proofs are short.

The case 0  <  β  ≤  1 / 2

Consider first the case 0  <  β  ≤  1 / 2. Impose the condition: there exists some small δ  >  0 such that

[formula]

Consider a city [formula] satisfying this condition, and consider the link-segments of an arbitrary connected network within distance δ / 2 from x. Because flow of volume 2n- 1 / 2 must enter or leave x, the cost associated with these link-segments (which by concavity of f  →  fβ is minimized when there is a single link-segment) is at least δ / 2  ×  (2n- 1 / 2)β. Summing over all (there are at least δn) such cities x, noting the link-segments are distinct as x varies, the network cost is at least [formula].

The case 1 / 2  <  β  <  1

In the case 1 / 2  <  β  <  1 we impose the classical equidistribution property for the configuration [formula] rescaled back to the unit square:

[formula]

Our standardization conventions imply that the total volume of flow through the network is Θ(n1 / 2) and so assertion (a) below is obvious.

(a) In the Gilbert network [formula], the maximum edge-flow is bounded as

[formula]

(b) For any modestly efficient network [formula] on configurations satisfying the equidistribution condition ([\ref=LB2]), the maximum edge-flow is bounded as

[formula]

Granted this result, use the fact

[formula]

and the general inequality

[formula]

to deduce that [formula] grows strictly faster than n / n(1 - β) / 2  =  nα(β) for any modestly efficient network, and no slower than order nα(β) for the Gilbert network.

Proof of Lemma [\ref=Ln2](b). We first quote an easy fact from geometry.

Let Z1,Z2 be two independent uniform random points in the unit square 2. There exists a constant C such that for all x∈[0,1]2 and all δ  >  0

[formula]

Now fix δ  >  0. Write X1,X2 for two uniform random picks from the set [formula] of cities. The modestly efficient assumption implies

[formula]

Lemma [\ref=Lgeom] and the equidistribution assumption ([\ref=LB2]) imply

[formula]

In order for the route from X1 to X2 to pass through point x, one of the two inequalities above must hold, and so

[formula]

But δ is arbitrary, so this probability is o(1), and the flow volume is exactly n1 / 2 times this probability.

Associating speeds with links

The main feature of our model - that the cost of building a link is sublinear in link capacity - is just one of many realistic features one might want to incorporate into a model. By focussing on route lengths, we have implicitly assumed that users travel at constant speed. A notable feature of real road or rail networks is that different links permit different speeds. In this section we state and briefly discuss a variant model in which links can be designed to permit different speeds.

Suppose a link with length [formula], nominal capacity c0 and nominal speed s0 costs [formula], for fixed 0  <  γ  <    ∞  . On such a link, traffic moves with speed s0 provided the flow-volume f is at most c0; for larger flow-volumes, congestion causes the speed to drop, reaching speed zero (jammed) at volume σc0 for a constant σ. So σc0 is the maximum capacity. Precisely,

[formula]

where G(u)  =  1 for 0  ≤  u  ≤  1 and G(u) decreases from 1 to 0 as u increases from 1 to σ. Otherwise the model is the same as before: we are given a configuration of n cities in the square of area n, and we are required to route flow of volume n- 3 / 2 between each source-destination pair.

For any network and feasible routing, define average speed as

[formula]

where t(xi,xj) is the time taken to travel from xi to xj. For this model, we ask

What is the minimum cost for a network on a given configuration [formula] of cities that allows [formula]?

The answer is that, under the regularity assumptions of Theorem [\ref=T1] (which are needed only for lower bounds), and ignoring O( log n) terms.

[formula]

[formula]

Let us briefly indicate how the previous analysis is adapted to this setting. Because costs scale with design speed s0 as sγ0, it is enough to consider the case [formula], and show that minimum cost grows as order nα*(β,γ). To construct a network, use the networks constructed previously and assign design speeds as follows. For links of the large-scale network, which routes will use for a distance of order n1 / 2, design speed of order 1. For type m edges in the hierarchical routing lattice, which routes will use for a distance of order 2m, design speed of order 2mn- 1 / 2 log n. For the local links of the form (x,v(x)), which routes will use for distance O(1), design speed of order n- 1 / 2. This ensures the typical times t(xi,xj) are of order n1 / 2 as required. To calculate the cost, we simply combine the previous estimates ([\ref=cost-small],[\ref=cost-med],[\ref=cost-large]) of costs of providing flow-volumes of different links with the costs of the design speeds stipulated above; the total cost is of order

[formula]

and this works out to be of the form nα*(β,γ) stated.

References