Corollary Lemma Proposition Conjecture

There are k-uniform cubefree binary morphisms for all k  ≥  0

Introduction

A square is a non-empty word of the form xx, and a cube is a non-empty word of the form xxx. An overlap is a word of the form axaxa, where a is a letter and x is a word (possibly empty). A word is squarefree (resp. cubefree, overlap-free) if none of its factors are squares (resp. cubes, overlaps). The construction of infinite squarefree, cubefree, and overlap-free words is typically done by iterating a suitable morphism. Uniform morphisms have particularly nice properties. In this note we show that for all k  ≥  0 there exists a k-uniform cubefree binary morphism.

Let Σ* denote the set of all finite words over the alphabet Σ. A morphism h:Σ*  →  Σ* is k-uniform if h(a) has length k for all a∈Σ; it is uniform if it is k-uniform for some k. A morphism h:Σ*  →  Σ* is squarefree (resp. cubefree, overlap-free) if h(w) is squarefree (resp. cubefree, overlap-free) whenever w∈Σ* is squarefree (resp. cubefree, overlap-free). Squarefree, cubefree, and overlap-free morphisms have been studied extensively [\cite=BEM79] [\cite=BS93] [\cite=Bra83] [\cite=Cro82] [\cite=Kar83] [\cite=Ker84] [\cite=RS99] [\cite=RW02] [\cite=RW04] [\cite=RW07].

We denote the Thue-Morse morphism by θ:

[formula]

The Thue-Morse word is the infinite fixed point of θ:

[formula]

It is well-known that the Thue-Morse word is overlap-free [\cite=Thu12]. Moreover, the Thue-Morse morphism is both overlap-free and cubefree (see [\cite=Bra83] [\cite=Shu00] for even stronger results). Berstel and Séébold [\cite=BS93] gave a remarkable characterization of overlap-free binary morphisms: namely, that a binary morphism h is overlap-free if and only if h(01101001) is overlap-free. Furthermore, they showed that if h is an overlap-free binary morphism then h is a power of θ (or its complement). Thus any overlap-free binary morphism is k-uniform where k is a power of 2. It is natural to inquire if cubefree binary morphisms exhibit similar behaviour. In this case the answer is no, as we are able to construct uniform binary morphisms of every length.

For further background material concerning combinatorics on words we refer the reader to [\cite=AS03].

Main result

The main result of this note is that for all k  ≥  0 there exists a k-uniform cubefree binary morphism. We begin with some preliminary lemmas.

Let k  ≥  4 be an integer. Then the Thue-Morse word [formula] contains two distinct words of length k of the form 0y0 and two distinct words of length k of the form 0z1.

For k = 4,5,6 the following table gives the required pairs of subwords.

Suppose then that k  >  6. If k is even, let k = 2r; otherwise, let k = 2r - 1. Suppose inductively that [formula] contains two distinct words 0y0 and 0y'0 of length r and two distinct words 0z1 and 0z'1of length r.

If k is even then the words 01θ(y)01, 01θ(y')01, and 01θ(z)10, 01θ(z')10 are the desired words of length k. If k is odd then the words 01θ(y)0, 01θ(y')0, and 01θ(z)1, 01θ(z')1 are the desired words of length k.

The proof of the following lemma essentially follows that of [\cite=AC04].

Let k  ≥  7 be an integer. Then [formula] contains two distinct subwords of length k of the form 01x01 and two distinct subwords of length k of the form 01x10.

We only give the details for 01x01, the proof for 01x10 being analogous. If k is even, let k  =  2r. We have r  =  k / 2  ≥  4, so that [formula] contains distinct words u  =  0v0 and u'  =  0v'0 of length r by Lemma [\ref=lem1]. The words θ(u)  =  01θ(v)01 and θ(u')  =  01θ(v')01 are therefore words of the required form of length k.

If k is odd and k  ≥  23, we can write k as 8r  -  9, 8r  -  7, 8r  -  5 or 8r  -  3 for some r  ≥  4. Let u  =  0v0 and u'  =  0v'0 be distinct words of length r in [formula]. The word

[formula]

contains words 01x01 of lengths 8r  -  9 (including the first and second underlined 01's) and 8r  -  3 (including the first and third underlined 01's.) Similarly, the word

[formula]

contains words 01x'01 of lengths 8r  -  9 and 8r  -  3. Moreover, since v  ≠  v', these words are distinct from the corresponding subwords of θ3(u).

Let z  =  0v1 and z'  =  0v'1 be distinct words of length r in [formula]. The word

[formula]

contains words 01x01 of lengths 8r  -  7 (including the first and second underlined 01's) and 8r  -  5 (including the first and third underlined 01's.) Similarly, the word

[formula]

contains words 01x'01 of lengths 8r  -  7 and 8r  -  5. Moreover, since v  ≠  v', these words are distinct from the corresponding subwords of θ3(z).

For k odd, 7  ≤  k  ≤  21, the following table gives the required pairs of subwords.

Let k  ≥  9 be an integer. Then there exist two distinct cubefree words of length k of the form 00x11.

For 9  ≤  k  ≤  14, the following table gives the required pairs of subwords.

Suppose k  ≥  15. If k is even, let k = 2r - 2; otherwise, let k = 2r + 1. Note that r  ≥  7, so by Lemma [\ref=lem2], there are distinct subwords 01x10 and 01x'10 of [formula] of length r.

If k is even, then the complements of the words 0- 1θ(01x10)1- 1  =  110θ(x)100 and 0- 1θ(01x'10)1- 1  =  110θ(x')100 are cubefree words of the desired form of length k.

If k is odd, then let u  =  11θ(01x10)1- 1  =  110110θ(x)100 and u'  =  11θ(01x'10)1- 1  =  110110θ(x')100. We claim that u and u' are cubefree. Suppose to the contrary that u contains a cube. Since 0110θ(x)100 is overlap-free, any such cube would have to start with either the first or second 1, but in either case, by inspection the period of the cube is at least 3, which forces an overlap in 0110θ(x)100, a contradiction. Similarly, u' is cubefree. Taking the complements of u and u' gives cubefree words of the desired form of length k.

Let k  ≥  5 be an integer. Let w0, w1∈00{0,1}k11 be distinct cube-free words. The morphism φ:{0,1}*  →  {0,1}* given by

[formula]

is cube-free.

The existence of w0 and w1 is guaranteed by Lemma [\ref=lem3]. Suppose that v∈{0,1}* is cube-free, but φ(v) contains a cube xxx. Let p = |x|. For i = 0,1, since neither 000 nor 111 is a factor of wi, word φ(i) cannot have 10101 as a factor; for the same reason, word φ(i) has prefix 01011 and suffix 11. Thus 10101 occurs as a factor in φ(v) exactly at the boundaries between images of letters of v. It follows that the indices of any occurences of 10101 in φ(v) differ by multiples of |φ(0)|. Again, since 10101 always occurs in φ(v) in the context 1101011, no proper extension of 10101 in v has period 1, 2, 3 or 4.

Since wi and θ are cube-free, for i∈{0,1}, the word φ(i)010 = θ(wi) is cube-free. It follows that xxx spans the border between φ(i) and φ(j) for some i, j∈{0,1} and in fact xxx contains factor 10101. Since 10101 is cube-free, xxx is a proper extension of 10101, and thus has period at least 5. Note that any factor u of xxx with |u|  ≤  p occurs twice in xxx with indices differing by p. In particular, since |10101| = 5  ≤  p, two occurrences of 10101 in xxx have indices differing by p. We conclude that p is a multiple of |φ(0)|.

Write x = aφ(u)b where u∈{0,1}*, |ab| = |φ(0)|. We have xxx = aφ(u)baφ(u)baφ(u)b, and ba = φ(i0) for some i0∈{0,1}. However, since w1  ≠  w2, we also have φ(0)  ≠  φ(1) so that either

at most one of φ(0), φ(1) has b as a prefix OR

at most one of φ(0), φ(1) has a as a suffix.

Suppose that at most one of φ(0), φ(1) has b as a prefix. (The other case is similar.) Without loss of generality, say that φ(0) has b as a prefix. It follows that φ(v) contains φ(u0u0u0), and v contains u0u0u0 as a factor. This is a contradiction.

For every integer k  ≥  0, there exists a k-uniform cubefree binary morphism.

If k is odd and k  ≥  15, then Theorem [\ref=main_thm] gives a cubefree morphism of length k. For k∈{3,5,7,11,13}, the morphisms given in the table below are cubefree.

The cubefreeness of these morphisms can be established by a criterion of Keränen [\cite=Ker84], which states that to confirm that a uniform binary morphism is cubefree, it suffices to check that the images of all words of length at most 4 are cubefree.

For k = 1, the identity morphism is certainly cubefree, and for k = 9, clearly we may take φ23. This establishes the result for all odd k.

If k = 0, the morphism that maps every word to the empty word is trivially cubefree. If k is positive, even and not a power of 2, then k  =  2a(2r + 1) for some positive a,r. If φ is a (2r + 1)-uniform cubefree morphism, then the morphism [formula] is a k-uniform cubefree morphism. Similarly, if k  =  2a, then θa is a k-uniform cubefree morphism. This completes the proof.

Brandenburg [\cite=Bra83] gave an example of an 11-uniform squarefree ternary morphism and stated further that there are no smaller uniform squarefree ternary morphisms (excluding 0-uniform and 1-uniform morphisms). We therefore conclude by asking: