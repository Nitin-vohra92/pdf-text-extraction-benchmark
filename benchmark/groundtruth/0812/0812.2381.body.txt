Introduction

We consider integrable modules Lμ with the highest weight μ for affine Lie algebra [formula] and are especially interested in the properties of the string functions related to Lμ. String functions and branching coefficients of the affine Lie algebras arise in the computation of the local state probabilities for solvable models on square lattice [\cite=DJKMO]. Irreducible highest weight modules with dominant integral weights appear also in application of the quantum inverse scattering method [\cite=LD] where solvable spin chains are studied in the framework of the AdS/CFT correspondence conjecture of the super-string theory (see [\cite=KAZA] [\cite=BE] and references therein).

There are different ways to deal with string functions. One can use the BGG resolution [\cite=BGG] (for Kac-Moody algebras the algorithm is described in [\cite=Kac] [\cite=Wak1]), the Schur function series [\cite=FauKing], the BRST cohomology [\cite=Hwang], Kac-Peterson formulas [\cite=Kac] or the combinatorial methods applied in [\cite=FeigJimbo].

Here we want to develop a new description for string functions by applying the recursive formulas for weight multiplicities and branching coefficients obtained in [\cite=IKL-1].

It was proved in [\cite=Kac] that for simply laced or twisted affine Lie algebra and integrable module Lμ with the highest weight μ of level 1 the string function is unique: so that the corresponding formal character [formula] can be easily written down provided the set max (μ) of maximal weights for Lμ is known:

[formula]

with

[formula]

(see also Corollary 2.1.6 in [\cite=Wak2]). Comparing this expression with the Weyl-Kac formula

[formula]

where the character can be treated as generated by the denominator [formula] acting on the set of singular vectors [formula] of the module Lμ we see that in the relation ([\ref=kac-character-l-1]) both factors on the right hand side are simplified: singular weights are substituted by the maximal ones and instead of the factor [formula] the string function [formula] is applied.

In this paper we shall demonstrate that similar transformations can be defined when the level [formula] is arbitrary. To find these transformations we use the recursion properties of branching coefficients [formula] for the reduced module [formula] where the subalgebra[formula] has the same rank as [formula]: [formula]. These properties are formulated in [\cite=IKL-1] in terms of relations where [formula] is the projection to the weight space of [formula] and [formula] is the fan of the injection [formula], that is the set of vectors defined by the relation

[formula]

(with [formula]). In particular when [formula] is a Cartan subalgebra [formula] of [formula] the coefficients [formula] are just the multiplicities of the weights of Lμ and the corresponding fan [formula] coincides with [formula] - the set of singular weights ψ∈P for the module L0.

In Section [\ref=section3] we demonstrate that this set can be "folded"   →  FΨ so that the new shifts (the vectors of the folded fan) fψ∈FΨ connect only the weights in the closure of the fundamental Weyl chamber while the recursive property survives in a new form. Thus the recursive relations are obtained for the coefficients of the string functions for the modules Lξj whose highest weights ξj belong to the same congruence class Ξk;v. When these relations are applied simultaneously to the set of string functions located in the main Weyl chamber (Section [\ref=section4]) this results in the system of linear equations for the string function coefficients (collected in the vectors [formula]). This system can be written in a compact form [formula] where the operator [formula] is a matrix whose elements are composed by the multiplicities of weights in the folded fans FΨ. The set is solvable and the solution - the vector [formula] - defines the string functions for Lμ up to an arbitrary minimal grade u. In the Section [\ref=section5] some examples are presented where the string functions for modules of [formula] are explicitly constructed.

The set of folded fans provides a compact and effective method to construct the string functions.

Basic definitions and relations

Consider the affine Lie algebra [formula] with the underlying finite-dimensional subalgebra [formula].

The following notation will be used:

Lμ - the integrable module of [formula] with the highest weight μ;

r - the rank of the algebra [formula];

Δ - the root system;

Δ+ - the positive root system for [formula];

[formula] - the multiplicity of the root α in Δ;

[formula] - the finite root system of the subalgebra [formula];

Nμ - the weight diagram of Lμ;

W - the corresponding Weyl group;

[formula] - the fundamental Weyl chamber;

ρ - the Weyl vector;

[formula], w∈W;

αi - the i-th simple root for [formula], [formula];

δ - the imaginary root of [formula];

[formula] - the simple coroot for [formula], [formula];

[formula] - the finite (classical) part of the weight ξ∈P;

[formula] - the decomposition of an affine weight indicating the finite part [formula], level k and grade n;

[formula] - the intersection of the closure of the fundamental Weyl chamber [formula] with the plane with fixed level [formula];

P - the weight lattice;

Q - the root lattice;

[formula];

E - the group algebra of the group P;

[formula] - the classical theta-function;

[formula];

[formula]

[formula] - the singular weight element for the [formula]-module Lμ;

[formula] - the set of singular weights ψ∈P for the module Lμ with the coordinates [formula] (this set is similar to [formula] in [\cite=Wak1]);

[formula] - the multiplicity of the weight ξ∈P in the module Lμ;

[formula] - the formal character of Lμ;

[formula] - the Weyl-Kac formula;

[formula] - the denominator;

max (μ) - the set of maximal weights of Lμ;

[formula] - the string function through the maximal weight ξ.

Folding a fan

The generalized Racah formula for weight multiplicities [formula] (with ξ∈P) in integrable highest weight modules [formula] (see [\cite=Ful] for a finite dimensional variant),

[formula]

can be obtained as a special case of developed in [\cite=IKL-1] (see also [\cite=LDu]) branching algorithm for affine Lie algebras. To apply this formula ([\ref=gen-mult-form]) we must determine two sets of singular weights: [formula] for the module Lμ and [formula] for L0. (As it was indicated in the Introduction the set [formula] coincides with the fan [formula] of the injection [formula] of the Cartan subalgebra [formula] in the Lie algebra [formula].)

Our main idea is to contract the set [formula] (the fan [formula]) into the closure [formula] of the fundamental Weyl chamber [formula]. We shall use the set max (μ) of maximal weights of [formula] instead of [formula]. And as a result we shall find the possibility to solve the relations based on the recurrence properties of weight multiplicities, to obtain the explicit expressions for the string functions σμξ∈ max (μ) and thus to describe the module Lμ.

Consider the module [formula] of level k: [formula]. Let [formula] be the intersection of [formula] with the plane δ = 0, that is the "classical" part of the closure of the affine Weyl chamber at level k.

To each ξ∈P attribute a representative wξ∈W of the class of transformations

[formula]

bringing the weight ξ into the chamber [formula]

[formula]

Fix such representatives for each shifted vector [formula]. The set

[formula]

is in one-to-one correspondence with the set [formula] of shifted weights. The recursion relation ([\ref=gen-mult-form]) can be written as

[formula]

Consider the restriction to [formula]:

[formula]

In the r.h.s. the function [formula] has an argument [formula]:

[formula]

Thus the new ("folded") shifts are introduced: When the sum over [formula] in the expression ([\ref=intermed-rel]) is performed the shifted weight [formula] acquires the (finite) multiplicity [formula]:

[formula]

(the sum is over all the elements [formula] satisfying the relation [formula]) such that

[formula]

The main property of the multiplicities [formula] is that they do not depend directly on nξ.

Let [formula]; [formula]; [formula]; [formula]. Then the corresponding folded shifts [formula] and multiplicities [formula] depend only on k, [formula], and w.

As far as imaginary roots are W-stable we have: [formula]. Thus for both ξ and [formula] the representatives of the classes bringing [formula] and [formula] to the fundamental chamber [formula] can be taken equal: [formula]. In the shift [formula] decompose the element [formula] into the product of the classical reflection [formula] and the translation [formula]. Denote by [formula] the argument (belonging to M) of the translation [formula]. The direct computation demonstrates that the weight [formula] does not depend on nξ: Thus the shift [formula] can be considered as depending on k, [formula] and w: [formula]. The multiplicity [formula] (see ([\ref=mult-in-ffan])) depends only on the set of reflections w∈W connecting ξ and [formula] and does not depend on nξ neither: [formula].

Thus we have constructed the set of (nonzero) shifts [formula] with the multiplicities [formula] and obtained the possibility to formulate the recursion properties entirely defined in the closure [formula] of the fundamental Weyl chamber.

Let us return to the relation ([\ref=intermediate-2]), For simplicity from now on we shall omit some arguments and write down the shifts as [formula] and their multiplicities as [formula] (keeping in mind that we are at the level k and the weight [formula] depends on the initial reflection w). The set of vectors: plays here the role similar to that of the set [formula] of nontrivial singular weights for L0 in the relation ([\ref=gen-mult-form]) and is called the folded fan for [formula]. (The initial (unfolded) fan [formula] corresponds here to the injection of the Cartan subalgebra.)

Thus we have proved the following property:

Let Lμ be the integrable highest weight module of [formula], [formula], [formula], [formula] and let [formula] be the folded fan for [formula] then the multiplicity of the weight ξ is subject to the recursion relation

[formula]

Folded fans and string functions

For the highest weight module [formula] with [formula] of level k consider the set of maximal vectors belonging to [formula]

[formula]

Let π be a projection to the subset of P with level k and grade n = 0 and introduce the set: The cardinality

[formula]

is finite and we can enumerate the corresponding weights ξj:

[formula]

The string functions necessary and sufficient to construct the diagram Nμ (and correspondingly the character [formula]) are Let us consider these string functions as starting from the points ξj rather than from ζ's. (For ζ  =  ξs - lδ∈Zμk the expansion [formula] starts with string coefficients [formula].) Denote these extended string functions by σμ,kj and introduce the set

Let us apply the relation ([\ref=recursion-prop-weights]) to the weights of the string σμ,kj∈Σμk and put ξ  =  ξj + njδ, In the folded fan [formula] let us separate the summation over the grades nfψ and the classical parts [formula]  of the shifts [formula]. The overcrossing terms vanish because their multiplicities are zero. The first term in the r.h.s. of the recursion relation takes the form For the same reason we can spread the first summation over all the positive grades. It is sufficient to include the vector with zero coordinates into the folded fan and put the multiplicity [formula]. Introduce the set

[formula]

It is called the full folded fan or simply the folded fan when from the context it is clear what fan [formula] or [formula] is actually used. The set of multiplicities [formula] for the shifts in [formula] is thus fixed as follows:

[formula]

and the recursion property ([\ref=recursion-prop-weights]) is reformulated: For the string σμ,kj we can rewrite this relation separating the summations: The properties of Nμ for an integrable modules Lμ guarantee that for any finite nj the first sum is finite. It extends to n  ≤   - nj (remember that nj is negative). The second sum can also be augmented so that the vectors [formula] run over the set Ξμk. Now taking into account that nj,s does not depend on nj (Lemma [\ref=lemma1]) the notation can be simplified: and the recursion property for the string functions in [formula] can be stated:

Let Lμ be the integrable highest weight module of [formula], [formula], [formula] , [formula] , let [formula] be the full folded fan for [formula] and [formula] where the summation is over the elements w̃j,s of W satisfying the equation [formula] then for the string function coefficients [formula] the following relation holds:

[formula]

For a fixed nj  ≤  0 consider the sequence of the string weights

[formula]

and write down two [formula]-dimensional vectors: the coordinates of the first one are the coefficients of the s-th string [formula], the second indicates that the j-th string σμ,kj is starting at the highest weight μ,

[formula]

For the weights with n  ≥  nj we have the sequence of relations of the type ([\ref=recursion-prop-string]): Introduce the upper triangular [formula]-matrix The set of relations ([\ref=preliminary-set-equations]) reads:

[formula]

Perform the same procedure for the other weights ξj∈Ξμk putting the minimal values of grade equal: [formula], that is construct all the folded fans [formula] (till the grade u) and the corresponding sets of multiplicities [formula] (defined by relations ([\ref=full-fan-multiplicity])). For [formula] compose [formula] equations of the type ([\ref=preliminary-matrix-relations]): Form two [formula]-dimensional vectors: the first with the string coefficients, the second indicating that the string σμ,kj with number j starts at the highest weight μ,

[formula]

(here only in the j-th subsequence the last ([formula]-th) coordinate is not zero). Define the [formula]-matrix - the block-matrix with the blocks [formula]:

[formula]

In these terms the relations ([\ref=almost-final-set-relations]) have the following integral form:

[formula]

The matrix [formula] being invertible the equation ([\ref=final-equation]) can be solved. Thus we have demonstrated that the strings σμ,kj are determined by the matrix [formula] whose elements are the full folded fan weight multiplicities:

Let Lμ be an integrable highest weight module of [formula], [formula], [formula], [formula]; let [formula] be the full folded fan for [formula] and [formula] - the [formula]-matrix formed by the blocks [formula]

[formula]

where the elements [formula] are the multiplicities of the folded fan weights,

[formula]

with the summation over the elements w̃j,s∈W satisfying the equation

[formula]

Let the string function coefficients be the coordinates in the nj + 1-subsequences of the vector [formula]. Then for the coefficients of [formula] the following relation folds:

Thus the solution [formula] describes all the string functions relevant to the chosen module Lμ (with the grades no less than the preliminary fixed nj = u).

To describe the complete string functions it is sufficient to send u to the limit u  →    -    ∞   .

Examples

[formula]

Consider the fan [formula] (with [formula]): Here the first two coordinates are classical in the basis of simple roots [formula], next comes the level k = 0, the grade [formula] and the multiplicity [formula] of the weight [formula] (for the injection [formula] we have [formula]).

[formula]

The set [formula] contains three weights ([formula]): ωi are the fundamental weights.

The classical components [formula] of the folded fan shifts

[formula]

belong to the classical root lattice [formula]. For any weight [formula] these classical components are equal to zero, thus the folded fan has the form

[formula]

It is convenient to indicate the multiplicities

[formula]

as the additional coordinates of the shifts fψ:

[formula]

Thus any folded fan for the highest weight μ of level k = 1 contains only "one string". Moreover the fans [formula] do not depend on the choice of [formula]. The latter results are in full accord with the Proposition 12.6 in [\cite=Kac].

Using the fan [formula] we obtain the folded fan (only the shifts with nonzero multiplicities ηj,j are indicated, the maximal grade here is n = 20): The multiplicities form the unique nonzero matrix [formula] for j = 1,2,3:

[formula]

The matrix [formula] is block-diagonal and the equation ([\ref=finite-string-solution]) splits into three equivalent (for [formula]) relations [formula] determining the unique string function with coefficients [formula], The obtained expression coincides with the expansion of the square of the inverse Euler function (see Proposition 12.13 in [\cite=Kac] and the relation (12.13.4) there).

[formula]

The set [formula] contains six weights: This set is divided into 3 congruence classes. The fan shifts cannot connect vectors from different classes. Thus instead of the set Ξ2 we can consider three subsets separately:

Let us start with [formula] and [formula]. Here we have two folded fans [formula] and [formula].

Using the fan [formula] ([\ref=star-a2-1]) we obtain the folded fans (the maximal grade here is n = 9): The multiplicities ([formula]) form the matrices [formula] for s,t = 1,2:

[formula]

The block-matrix [formula] is

[formula]

The equation

[formula]

gives two string functions [formula] with the coefficients in the subsections of the vector [formula]:

In the second congruence class [formula] put [formula]. Again we have two folded fans [formula] and [formula].

The multiplicities ([formula]): form the matrices [formula] for s,t = 1,2 and the 22  ×  22 block-matrix [formula]

[formula]

The equation

[formula]

gives two string functions [formula] for the module [formula] with the coefficients in the subsections of the vector [formula]:

For the third congruence class [formula] the folded fans [formula] and [formula] are the same as for the second one. As a result the string functions also coincide: [formula] in accord with the A2 external automorphism.

[formula]

The set [formula] contains 15 projected maximal weights This set is divided into 3 congruence classes. Instead of the set Ξ4 we can consider separately three subsets:

Let us start with [formula] and [formula]. Here we have 5 folded fans [formula], [formula].

Using the fan [formula] ([\ref=star-a2-1]) we construct the folded fans (the maximal grade here is chosen to be n = 9): The fan [formula] is equal to [formula]

Their multiplicities (for [formula])

The matrices [formula] for [formula]:

[formula]

For example,

[formula]

Matrices [formula] form the block-matrix [formula]. With this matrix we can describe five modules of the level 4 with the highest weights [formula] [formula] . We construct five sets of string functions [formula] in terms of their coefficients obtained as ten dimensional subsections of the vector [formula]:

[formula]

The answer is as follows: The next set of string functions [formula] coincides with the previous one where the third and the fourth strings are interchanged: [formula] The last set describes the module Lμ5 where μ5 is the highest weight in Ξ4;I:

Notice that in the congruence class Ξ4;I we have only 17 different string functions.

Conclusions

The folded fans [formula] (for a fixed level k and the congruence class Ξk;v of weights in [formula]) were constructed by transporting to the fundamental Weyl chamber the standard set [formula] - the set of singular weights of module L0 supplied with the anomalous multiplicities. We have found out that the shifts [formula] (connecting ξj∈Ξk;v) together with their multiplicities ηj,s describe the recursive properties of the weights of modules Lξj with the highest weights ξj. Thus the set [formula] describes the recursive properties of the string functions [formula]. When for a fixed module Lμ these properties are simultaneously considered for [formula] they can be written in a form of the equation [formula]. In this equation [formula] is a matrix formed by the multiplicities ηj,s of the fan shifts, [formula] indicates what weight in the set Ξk;v is chosen to be the highest weight μ of the module and [formula] is a vector of string functions coefficients. As far as [formula] is invertible the solution [formula] can be explicitly written and the full set of string functions [formula] for Lμ is determined by this linear equation (at least for any common finite "length" of all the strings).

There are two points that we want to stress. The first is that in this algorithm the singular vectors ψ∈ of Lμ are not needed (except the highest weight μ). The second point is that the crossections [formula] form the parts of the classical folded fans for [formula]. It can be easily verified that the string starting vectors [formula] and their multiplicities present the diagram [formula] of the module [formula]. In general the crossections [formula] do not coincide with the classical folded fans because the chambers [formula] are infinite (contrary to [formula] for any finite k).

As it was demonstrated in the examples the folded fans provide an effective tool when studying the string functions for integrable highest weight modules of affine Lie algebras.

Acknowledgements

The authors appreciate helpful remarks made by the Referees. The work was supported in part by RFBR grants N 06-01-00451, N 08-01-00638 and the National Project RNP.2.1.1.1112.