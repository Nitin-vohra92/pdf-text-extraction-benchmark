The Evans-Krylov theorem for non local fully non linear equations

Proposition Corollary Lemma Definition Conjecture Question Example Problem Remark

Introduction

In 1982, L. Evans and N. Krylov proved independently ([\cite=MR649348] and [\cite=MR661144]) the following celebrated interior regularity result for elliptic partial differential equations: If u is a bounded solution to F(D2u) in B1, where F is uniformly elliptic and concave, then u∈C2,α(B1 / 2) for some α  >  0. In this paper we prove a nonlocal version of that theorem. We prove that solutions to concave integro-differential equations of order σ have regularity Cσ  +  α for some α > 0. This is enough regularity to consider the solutions to be classical.

The equations we study arise in stochastic control problems with jump processes (see for example [\cite=MR1355243], [\cite=MR1424785]). In [\cite=MR1355243] a C2,α regularity of the solutions of Bellman equations for Levy processes is obtained, but the equation is required to have a uniformly elliptic second order part which is ultimately the source of the regularity. In [\cite=abels2007aap] a purely integro-differential Bellman equation is studied. They only consider the case of the maximum of two linear operators. They obtain solutions in the fractional Sobolev space Hσ / 2 up to the boundary and Hσ in the interior of the domain. As they point out in their paper, the solutions to these equations are expected to be more regular in the interior of the domain.

In this paper we consider purely integro-differential equations and obtain an interior regularity result. Since we do not require our equations to have a second order part, our estimate comes only from the regularization effects of the integrals.

The constants in our estimates do not blow up as σ  →  2, so we can recover the usual Evans-Krylov theorem as a limit case. It is interesting to follow what the ideas of the proofs become as σ  →  2. Interestingly, the ideas we present in this paper provide a different proof of the Evans-Krylov theorem for second order elliptic equations.

We consider the equation

[formula]

As in [\cite=CS], we will choose each linear operator [formula] in some class L. Consequently, the operator I will be elliptic with respect to L in the sense described in [\cite=CS2].

We describe below the appropriate classes of linear operators that we will use in this paper.

We say that an operator L belongs to L0 if its corresponding kernel K satisfies the uniform ellipticity assumption.

[formula]

The ellipticity assumption [\eqref=e:ellipticity] is the essential assumption that leads to a local regularization. Our proofs, as usual, involve an improvement of oscillation of the solution to the equation (or an operator applied to it) in a decreasing sequence of balls around a point in the domain. Since the equations are nonlocal, every argument in our proofs will have to take into account the influence of the values of the solution at points outside those balls. We will often need to say that the part of the integral in [\eqref=e:main] outside a neighborhood of the origin is a smooth enough function. That is why we define the following classes of smooth kernels.

We say that L∈L1 if, in addition to [\eqref=e:ellipticity], the kernel K is C1 away from the origin and satisfies

[formula]

Finally, we say L∈L2 if the kernel is C2 away from the origin and satisfies

[formula]

We consider the corresponding maximal operators

[formula]

Recall that we write δu(x,y)  =  (u(x + y) + u(x - y)  -  2u(x)) as in [\cite=CS]. Naturally we have the inequalities [formula]. The minimal operators [formula] are defined likewise.

We do not know a closed form for [formula] or [formula]. Since L2  ⊂  L1  ⊂  L0, we have the relations [formula] and [formula].

Our main result states that under the hypothesis that all operators [formula] belong to L2, the solutions are classical in the sense that there is enough regularity so that all integrals are well defined and Hölder continuous.

Assume every [formula] in [\eqref=e:main] belongs to the class L2. If u is a bounded function in [formula] such that Iu = 0 in B1, then u∈Cσ  +  α(B1 / 2). Moreover

[formula]

The interested reader may verify, in following the arguments, that global boundedness of u may be substituted by an appropriate moderated growth at infinity (see remark at the end of this paper).

For values of σ less or equal to 1, this theorem does not provide any improvement with respect to the C1,α estimates in [\cite=CS2]. Thus, for the purpose of proving Theorem [\ref=t:main] we will assume σ to be strictly larger than 1 in this paper. The result becomes most interesting when σ is close to 2 and σ  +  α  >  2.

Note that the result of the theorem remains true if I is convex instead of concave (a sup  of linear operators instead of an inf ). Indeed, we can transform one situation in the other by considering the equation - I( - u) = 0.

In previous papers ([\cite=CS] and [\cite=CS2]) we started developing the regularity theory for nonlocal equations. In [\cite=CS] we obtained a nonlocal version of Krylov-Safonov theory with estimates that do not blow up as σ  →  2. This allowed us to obtain C1,α estimates for general fully nonlinear integro-differential equations that are translation invariant. In [\cite=CS2], we extended those results to variable coefficient equations using perturbative methods. In this paper, we use the results in our previous two papers extensively.

A regularization procedure

In this section we show a simple technique to approximate uniformly the solutions to the integro-differential equation [\eqref=e:main] by C2,α functions that solve an approximate equation with the same structure. This procedure works exclusively for integro-differential equations and cannot be done using only second order equations. It makes it unnecessary to use sup- or inf- convolutions and simplifies the technicalities of several proofs. Essentially the idea is that if we prove an estimate assuming the solutions u is C2,α (but the estimate does not depend on the C2,α norm), then we can pass to the limit using this approximation technique to extend the estimate to all viscosity solutions. In this respect, the technicalities in the integro-differential setting simplify very much compared to the second order counterpart.

Let u be a continuous function in [formula] solving [\eqref=e:main] with every [formula] belongs to the class L2 (resp. L1 or L0). There is a sequence of regularized equations in the same class

[formula]

so that the solutions [formula] are C2,α in the interior of B1 for every ε > 0 and [formula] uniformly in B1.

Let η be a smooth function such that

[formula]

and let [formula].

Let us consider the following regularized kernels

[formula]

Correspondingly, we define

[formula]

Note that if [formula] then also [formula] for i = 0,1,2.

Let [formula] be the solution of the following Dirichlet problem:

[formula]

The solution [formula] to this problem is C2,α by theorem 6.6 in [\cite=CS2].

It is clear that if v∈C2(x) and [formula] in B1, then

[formula]

so [formula] as ε  →  0 (recall σ < 2), where the norm [formula] is computed in the sense of definition 2.2 in [\cite=CS2]. Then, by lemma 4.9 in [\cite=CS2], [formula] converges to u uniformly in [formula] as ε  →  0.

The concavity of I is not used in Lemma [\ref=l:approximationByC2]. The exact same idea works for equations of the type

[formula]

Average of subsolutions is a subsolution

The main ingredient in the Evans-Krylov theorem is the fact that concavity of the equation makes second order incremental quotients subsolutions of the linearized equation. In order to prove that, one first observes that an average of solutions to a concave equation is a subsolution to the same equation.

In this section we prove that also in the non local case the average of subsolutions to a concave equation is a subsolution of the same equation. This is obvious from the equation if the solutions are classical. For viscosity solutions we can prove it quickly using the approximation technique of section [\ref=s:regularizationProcedure].

Let u and v be subsolutions of Iu = 0 and Iv = 0 in a domain Ω, u,v continuous in [formula], then I(u + v) / 2  ≥  0 in Ω.

The proposition is obvious if u,v∈C2 by the concavity of I. So we used the regularization procedure described in section [\ref=s:regularizationProcedure].

Let [formula] and [formula] be the approximate equations of Lemma [\ref=l:approximationByC2]. The functions [formula] and [formula] are C2 so [formula] in Ω. Since [formula] and [formula] uniformly in Ω and [formula], then I(u + v) / 2  ≥  0 in Ω by Lemma 4.9 in [\cite=CS2].

The same idea shows that any average of solutions is a subsolution. In particular we have the following proposition.

Let u be a solution of Iu  =  0 in B1 and η be a mollifier, i.e.

η  ≥  0

[formula].

[formula].

we have [formula] in B1 - δ.

The linear theory of integro-differential equations

In this section we present some regularity theorems for linear integro-differential equations with constant coefficients. Naturally in this simple case, we can easily obtain more powerful results than for the nonlinear case. The results we present in this section are just the ones that we will need in the rest of this paper.

Let L be an integro-differential operator in the class L1 with σ  ≥  σ0 > 1. Suppose that u is an integrable function in the weighted space [formula] that solves the equation Lu  =  0 in B1, then u∈C2,α(B1 / 2) and we have the estimates

[formula]

The value of the constant C and α depends on n, λ, Λ and σ0 but not on σ.

We will prove the apriori estimate. The regularity estimate for a weak or viscosity solution follows by mollifying the solution or using the regularization procedure of the previous section.

First we apply theorem 2.8 in [\cite=CS2] to obtain that u∈C1,α(B3 / 4) and obtain the estimate

[formula]

The idea is to apply the same C1,α estimate to every directional derivative ue. Since we do not have an L∞ estimate of ue outside of B3 / 4 we have to use our usual integration by parts trick. We know that

[formula]

Let η be a smooth cutoff function such that

[formula]

We compute

[formula]

Thus we can apply Theorem 6.1 in [\cite=CS2] to conclude that ue∈C1,α for every direction e and thus u∈C2,α (Note that we are using σ > 1 here).

In order to have better interior regularity estimates than C2,α, we would need to impose more regularity to the kernel K in L than C1 away from the origin.

Next theorem says that in L2 all linear operators have a comparable norm.

Let L0 and L1 be two linear integro-differential operators in the class L0. Suppose that [formula] then [formula].

Since we are dealing with L2 norms, and translation invariant linear operators, we will use the Fourier transform to prove this theorem.

Given a function u and [formula], we have   =  (u(. + y) + u(. - y) - 2u)  =  (eiy  ·  ξ  +  e- iy  ·  ξ  -  2)û(ξ)  =  2( cos (y  ·  ξ) - 1)û(ξ). We use this identity to compute the symbol s(ξ) of an operator - L as a pseudo differential operator.

[formula]

Note that for every ξ function (1 -  cos (y  ·  ξ)) is C2 and bounded, so the integral in the right hand side is well defined. Let us estimate it from above and below.

For any R > 0,

[formula]

so we obtain s(ξ)  ≤  C|ξ|σ by choosing R  =  |ξ|- 1.

On the other hand note that (1 -  cos (y  ·  ξ)) is nonnegative and so is K(y). So the integrand is nonnegative and we have

[formula]

So the symbol s(ξ) is comparable to |ξ|-  σ for any operator L in L0. Thus by classical Fourier analysis we have that L1L- 10 has a bounded symbol and maps L2 functions into L2.

The following theorem is a direct combination of Theorems [\ref=t:l1] and [\ref=t:l2].

Let L be an integro-differential operator in the class L1 with σ  ≥  σ0 > 1. Suppose that u is a function in the weighted space [formula] that solves the equation Lu  =  f in B1 for some f∈L2. Let L1 be an operator in L0, then L1u∈L2(B1 / 2) and

[formula]

for some constant C depending on n, λ, Λ and σ0.

Consider the function v that solves

[formula]

From Theorem [\ref=t:l2] we get that [formula]. Theorem [\ref=t:l2] can also be applied to [formula], thus v is in the homogeneous fractional Sobolev space [formula]. By Sobolev embedding [formula] where p  =  4n / (2n - σ). In particular [formula]

Now we apply theorem [\ref=t:l1] to [formula] to conclude the proof.

The ellipticity constants λ and Λ of L0 and L1 do not need to coincide. Indeed if each Li is elliptic with constants λi and Λi, then they would both be elliptic with respect to the constants min (λ0,λ1) and max (Λ0,Λ1).

Subsolutions in L1 are bounded above

The theorem below is a weak version of the mean value theorem. Its proof uses the same ideas as the proof of the Harnack inequality in [\cite=CS]. We include it here for completeness.

Let u be a function such that u is continuous in [formula], assume that

[formula]

then

[formula]

for every x∈B1 / 2, where C is a universal constant.

Dividing u by C0, we can assume without loss of generality that C0 = 1.

Let us consider the minimum value of t such that

[formula]

There must be an x0∈B1 such that u(x0)  =  ht(x0), otherwise we could make t smaller. Let d  =  (1 - |x0|) be the distance from x0 to ∂B1.

For r = d / 2, we want to estimate the portion of the ball Br(x0) covered by {u  <  u(x0) / 2} and by {u  >  u(x0) / 2}. We will show that t cannot be too large. In this way we obtain the result of the theorem, since the upper bound t < C implies that u(x)  <  C(1 - |x|)- n.

Let us first consider A: = {u  >  u(x0) / 2}. By assumption, we have u∈L1(B1), thus

[formula]

Whereas |Br|  =  Cdn, so if t is large, A can cover only a small portion of Br(x0) at most.

[formula]

In order to get a contradiction, we will show that [formula] for a positive constant α independent of t.

We estimate [formula] for θ > 0 small. For every x∈Bθr(x0) we have u(x)  ≤  ht(x)  ≤  (d - θd / 2)- n  ≤  u(x0)(1 - θ / 2)- n, with (1 - θ / 2)- n close to one.

Let us consider

[formula]

so that v  ≥  0 in Bθr, and also [formula] since [formula]. We would want to apply Theorem 10.4 in [\cite=CS] (the [formula] estimate) to v. The only problem is that v is not positive in the whole domain but only on Bθr. In order to apply such theorem we have to consider w = v+ instead, and estimate the change in the right hand side due to the truncation error.

We want to find an upper bound for [formula] instead of [formula]. We know that

[formula]

Therefore, if x∈Bθr / 2(x0),

[formula]

Now we can apply Theorem 10.4 from [\cite=CS] to w in Bθr / 2(x0). Recall w(x0) = ((1 - θ / 2)- n - 1)u(x0), we have

[formula]

Now let us choose θ > 0 so that the first term is small:

[formula]

Notice that the choice of θ is independent of t. For this fixed value of θ we observe that if t is large enough, we will also have

[formula]

and therefore

[formula]

which implies that for t large

[formula]

But this contradicts [\eqref=e:a0]. Therefore t cannot be large. Rescaling back, we obtain

[formula]

for any x in B1 / 2.

Each [formula] is bounded

The idea of this section is to show that averages of second order incremental quotients are subsolutions (of the maximal operator [formula]). In particular, each [formula] is a subsolution to

[formula]

Then we would estimate the integral of [formula] in B1 / 2 and use Theorem [\ref=t:weakharnack2] to prove that [formula] is bounded.

Assume u∈C2. Then for every kernel K corresponding to an operator L∈L0 and every bump function b such that

[formula]

we have

[formula]

Let φk be the L1 function [formula]. Since u∈C2, we can approximate the value of the integral uniformly by

[formula]

Applying Proposition [\ref=p:averageIsSubsolution], we have

[formula]

On the other hand, we know that Iu  =  0, then by Lemma 5.8 in [\cite=CS] and the fact that [formula] is homogeneous,

[formula]

Since we have [formula] for every k > 0. Then the result follows by Lemma 4.3 in [\cite=CS2] by taking limit as k  →    ∞  .

Assume u∈C2. Then there is a universal constant C such that for every operator L∈L2

[formula]

As in the proof of Lemma [\ref=l:truncatedLisSubsolution], we let φk be the L1 function [formula] and we approximate the value of the integral uniformly by

[formula]

Let b be a bump function such that

[formula]

As in the proof of Lemma [\ref=l:truncatedLisSubsolution],

[formula]

Therefore [formula].

On the other hand, we estimate [formula] in B1 / 2.

[formula]

Since by [\eqref=e:ellipticity], φk(1 - b)∈L1 and by [\eqref=e:kernelc2], D2φk(1 - b)∈L1 uniformly in k, then L(φk(1 - b)) is bounded in L1 uniformly for all L∈L0. Therefore,

[formula]

Using Lemma 5.8 in [\cite=CS] and the homogeneity of [formula],

[formula]

Therefore

[formula]

We finish the proof of the lemma by taking k  →    ∞   using Lemma 4.3 in [\cite=CS2].

Let u be a solution of [\eqref=e:main]. Assume [formula] for every a. Then for every a, [formula] in B1 / 8 for some universal constant C.

By Lemma [\ref=l:approximationByC2], we can assume the function u is C2. Indeed, for every ε  >  0 we can approximate u with a C2 function [formula] that satisfies the same kind of equation. If we can prove the estimate for [formula] with a universal constant C that does not depend on ε, then we would prove it for u by passing to the limit as ε  →  0. So we assume that u∈C2 and thus all the integrals are well defined.

From Lemma [\ref=l:fullLisSubsolution], we know that for each [formula],

[formula]

We would want to apply Theorem [\ref=t:weakharnack2] to [formula]. For that we still need an estimate at least in L1((1 + |y|)- n - σ). We can easily obtain an estimate in L1(B1 / 2) using the fact that [formula] in B1 because of the equation [\eqref=e:main].

Let b be a smooth cutoff function such that 0  ≤  b  ≤  1 in [formula], b = 1 in B1 / 2 and b = 0 outside B1. We multiply [formula] by b and integrate by parts.

[formula]

for some universal constant C. Since [formula] in B1, then it is in L1(B1 / 2).

We would still need some control on the values of [formula] away from B1 / 2 in order to apply theorem [\ref=t:weakharnack2]. We do not want to assume any regularity for u outside B1, so our only choice is to cut off again.

Let c(x): = b(2x) and [formula] We will estimate [formula] for x∈B1 / 4. For that, let us consider any operator L∈L2 and estimate

[formula]

For the last inequality it was used that [formula] is in L1 uniformly for x∈B1 / 4. This follows from the estimates [\eqref=e:ellipticity] and [\eqref=e:kernelc2] of the kernel K.

Now we can apply Theorem [\ref=t:weakharnack2] to w to obtain that [formula] in B1 / 8. but [formula] in B1 / 4, so we finish the proof.

Extremal operators are bounded

In this section we prove Theorem [\ref=t:MabsBounded]. We will achieve this result by showing that Lu(x) is bounded uniformly for all L∈L0. The ideas are very similar to section [\ref=s:eachLaBounded] but now we apply them to operators that are not a priori bounded below, so we use the L2 estimates from section [\ref=s:linearTheory] instead.

Assume u∈C2. Then for every kernel K corresponding to an operator L∈L0 and every bump function b such that

[formula]

then

[formula]

Let us call

[formula]

By Lemma [\ref=l:truncatedLisSubsolution], we have [formula]. Let L be any operator in L2, so we estimate

[formula]

where we used that Lt((1 - b(x +   ·  ))K) is bounded in L1 uniformly in x. This is due to the fact that [formula] because of [\eqref=e:kernelc2].

Let u be a solution of [\eqref=e:main] with all operators [formula] in L2. There is a constant C such that for every operator L in L0 we have

[formula]

As in the proof of Lemma [\ref=l:eachLaBounded], we can and will assume that u∈C2. We will write the proof assuming that [formula]. Moreover, we will prove the estimate in B1 / 64 instead of B1 / 2. The general estimate follows directly by scaling and a standard covering argument.

Let [formula] be one of the operators used in the infimum in [\eqref=e:main]. We know from Lemma [\ref=l:eachLaBounded] that [formula] is bounded in B1 / 2 by a constant C. In particular [formula]. From Theorem [\ref=t:linearL2estimate-local], we have an L2 estimate for every L∈L0,

[formula]

We split the integral of Lu into two domains

[formula]

The second integral is clearly bounded since K(y) is a function in [formula]. Thus we still have an estimate in L2 for the first term.

[formula]

On the other hand, from Lemma [\ref=l:truncatedLisSubsolution],

[formula]

For a bump function c(x) such that

[formula]

we define

[formula]

We know that [formula] and w  =  0 outside B1 / 4. In particular w is bounded in the weighted L1 space: L1((1 + |y|n + σ)- 1) needed for Theorem [\ref=t:weakharnack2].

We estimate [formula] in B1 / 16 now in the same way as in the proof of Lemma [\ref=l:eachLaBounded] (using assumption [\eqref=e:kernelc2]). Thus we can apply theorem [\ref=t:weakharnack2] to w to obtain that w  ≤  C in B1 / 32, which naturally implies Lku  ≤  C in B1 / 32. Passing to the limit we get that Lu  ≤  C for any L∈L0.

We got the desired bound from above only. In order to get the corresponding bound from below we must use the equation.

Recall that [formula] is bounded by Lemma [\ref=l:eachLaBounded], and the formulas of [formula] and L are given by

[formula]

where both K and [formula] are bounded below by (2 - s)λ / |y|n + σ and above by (2 - s)Λ / |y|n + σ.

Consider the kernel

[formula]

and the corresponding linear operator Ld. The kernel Kd satisfies the ellipticity conditions (2 - σ) / |y|n + σ  ≤  Kd  ≤  (2 - σ)(2Λ  /  λ  -  λ  /  Λ) / |y|n + σ, so Ld is in the class L0 with ellipticity constants 1 and (2Λ  /  λ  -  λ  /  Λ). The same proof as above tells us that Ldu  ≤  C in B1 / 32. But then since [formula] is bounded, then we obtain a bound below for L in B1 / 32.

[formula]

Thus, we have both bounds and we obtain [formula] in B1 / 32.

[formula] and [formula] are bounded in B1 / 2.

Since [formula] and for every L in L0 we have [formula] with C independent of the choice of L in L0, then also [formula] with the same constant C.

Now we are going to prove that all integrals in [\eqref=e:main] are absolutely convergent. This already implies that the solution is classical in some way.

Assume every [formula] in [\eqref=e:main] belongs to the class L2. If u is a bounded function in [formula] such that Iu = 0 in B1 in the viscosity sense, then we have the following estimate

[formula]

Applying Lemma [\ref=l:everyLisBounded] to [formula] we get

[formula]

On the other hand, applying Corollary [\ref=c:MpAndMmBounded] with any pair λ  <  Λ

[formula]

Subtracting, we obtain

[formula]

On the other hand, by subtracting [formula] we obtain the bound

[formula]

Combining the two estimates above, we finish the proof.

Outline of the strategy: the second order case.

Theorem [\ref=t:MabsBounded] provides an estimate slightly stronger than u∈Cσ. In the case σ  →  2 it becomes an estimate of the C1,1 norm of u. Comparing with the proof of Evans-Krylov theorem (as in [\cite=MR649348], [\cite=MR661144] or [\cite=CC]), the underlying strategy of the proof up to this point is essentially the same but adapted to the integro-differential setting using the ideas in our previous papers [\cite=CS] and [\cite=CS2].

The next step in the proof of our main result is to pass from this Cσ estimate to a Cσ  +  α estimate. In the second order case it corresponds to the apriori estimate [formula]. The presently known proofs of this apriori estimate seem difficult to adapt to the nonlocal setting. Thus we present a different strategy for the proof. The key tools that the proof is based on are similar, but in our approach they are organized differently and arguably more directly. We plan to publish a short note [\cite=cs-toappear] focusing only on this new proof for concave second order elliptic equations.

In order to better understand our proof in the next section, we first sketch its adaptation to the second order case.

We consider a C2 solution of a fully nonlinear equation F(D2u) = 0 with F concave and uniformly elliptic. We transform this into an integral equation by pointing out that a linear equation can be written as an integral on the unit sphere S1.

[formula]

with the weight w(σ)  =  1 / ( det {aij}aijσiσj) where {aij}  =  {aij}- 1. If the coefficients aij are uniformly elliptic, then w(σ) will be bounded away from zero.

We recall that F being concave implies that pure second derivatives are all subsolutions of the linearized operator. In particular, for any fixed set A  ⊂  S1, so is

[formula]

We also recall that for a (non necessarily concave) fully nonlinear equation

[formula]

a solution u satisfies (just because it is an inf  sup ) that for any two points x and y in the domain, there exists an operator Lab for which

[formula]

In our approach, this means that there is a weight w(σ), bounded below and above depending on the ellipticity constants, such that

[formula]

In particular, since there is another weight which gives the same inequality exchanging x and y, we must have that the following quantities are comparable:

[formula]

At this point we define

[formula]

for any set A  ⊂  S1. We will use only the properties above to show that

[formula]

The C2,α estimate for u follows easily from this estimate.

By [\eqref=e:2ndOrderComparable], we only need to prove that wA(x)  ≤  C|x|α for every set A, since

[formula]

In fact, by renormalization we only need to prove the following lemma.

Assume that for x in B1, for any set A  ⊂  S1, wA(x)  ≤  1. Then there is a universal constant θ > 0 such that

[formula]

for any A  ⊂  S1 and x∈B1 / 2.

Suppose that there exists an x∈B1 / 2 where wA  >  1 - θ for some set A  ⊂  S1. We will arrive to a contradiction if θ is too small.

Since wA  ≤  1 in B1 and wA is a subsolution of the linearized equation, we can apply Theorem 4.8(1) in [\cite=CC] (the [formula] estimate) to 1 - wA (this will correspond to Theorem 10.4 in [\cite=CS] in the nonlocal case). It follows that we can make

[formula]

cover almost all B1 / 4 if we choose t large (but independently of θ).

We will now obtain a contradiction by looking at wAc in B1 / 4.

For every x in Ω, the choice of the set A is almost maximal in the sense that

[formula]

On the other hand, since

[formula]

then also

[formula]

From [\eqref=e:2ndOrderComparable], we know that the integrals of h+ and h- are comparable. Thus in Ω we have

[formula]

for a constant C depending on λ and Λ. If we choose θ small, that means that wAc will be strictly negative in most of B1 / 4. But then applying Theorem 4.8(2) in [\cite=CC] (which corresponds to Theorem [\ref=t:weakharnack2] in the nonlocal case) we obtain that wAc(0)  ≤   - c for some universal constant c. This is a contradiction since clearly wAc(0) = 0.

In the integro-differential case, the proof will be slightly lengthier in part because we have to keep track of the truncation error we make every time we localize an integral. We cover the proof in detail in the next section.

Further regularity.

This section is devoted to fill the gap between Theorem [\ref=t:MabsBounded] and Theorem [\ref=t:main].

From Theorem [\ref=t:MabsBounded], we know that

[formula]

Our objective is to show that

[formula]

for some constant C and α > 0 and for every x∈B1 / 4. This estimate implies the Hölder continuity of the fractional laplacian [formula] from which the Cσ  +  α regularity of u follows.

We will consider all kernels K of the form

[formula]

where χA(y) is the characteristic function of an arbitrary set A.

Let b be a bump function as in Lemma [\ref=l:locallizedSubsolution]. For each set A, we write

[formula]

We know that wA is uniformly bounded from Lemma [\ref=l:everyLisBounded]. From Lemma [\ref=l:locallizedSubsolution], we have

[formula]

We define the following quantities

[formula]

Note that P(x) is realized by the set A  =  {x:δu(x,y)  >  δu(0,y)} and N(x) is realized by the complement of that set.

There is a constant C such that for x∈B1 / 4,

[formula]

For some x∈B1 / 4, let ux(z): = u(x + z). Since u solves the equation [\eqref=e:main] in a neighborhood of x, then both u and ux solve [\eqref=e:main] in a neighborhood of 0. Thus [formula] and [formula].

For every kernel K in the family L2 we have

[formula]

Let us analyze the second term in the right hand side.

[formula]

Therefore, for every kernel K in the family L2, we have

[formula]

Taking the supremum we obtain

[formula]

In particular, if we take the suppremum over all kernels K in L0 (a larger family), we still have

[formula]

which is the same as ΛP(x)  -  λN(x)  ≥   - C|x|.

The same computation with [formula] provides the other inequality.

It is important to notice the following relation,

[formula]

The strategy for proving our regularity result will be to prove that sup x∈BrP(x)  ≤  Crα. It is enough to prove it for |x| small enough, therefore we can consider a rescaled situation by taking [formula] where C is the constant from [\eqref=e:f1] and r is small enough so that our estimates become

[formula]

for ε1 arbitrarily small.

Assume σ∈(1,2). Let P(x) be the function defined above. There is a constant C and α > 0 such that

[formula]

As mentioned above, after an appropriate scaling, we can assume that [\eqref=e:wKbounded], [\eqref=e:wKsubsolution] and [\eqref=e:PandNcontrolled] hold with ε1 arbitrarily small. On the other hand, given the construction in Lemma [\ref=l:approximationByC2], we can assume u is C2 and thus wK, P and N are continuous. We will obtain the apriori estimates independently of the modulus of continuity of them, so the estimate holds when passing to the limit.

We will prove that there is r > 0 and θ > 0 such that

[formula]

This is clear for k = 0. Let us prove it is true for all values of k by induction. So let us assume it is true up to some value k.

Since [\eqref=a5] holds up to some value k, we have that,

[formula]

Consider the following rescaled functions

[formula]

The function P̃ satisfies the relations

[formula]

Moreover, from [\eqref=e:PandNcontrolled],

[formula]

We want to show that if θ and r are chosen small enough we will have P̃  ≤  (1 - θ) in Br. The proof is by contradiction. We will arrive to a contradiction if θ and r are small enough.

Let x0 be the point where the maximum of P̃ is achieved in [formula] for some r∈(0,1 / 2). We assume P̃(x0)  ≥  1 - θ to get a contradiction. Let A be the set such that P̃(x0)  =  w̃A(x0)  ≥  1 - θ.

Let vA  =  (1 - w̃A)+. We know that inf BrvA  ≥  θ. Moreover,

[formula]

since [formula] and (1 - w̃A)-  ≤  ((1 - θ)- 1|x|α  -  1)+.

By Theorem 10.4 in [\cite=CS], for some p > 0 and r  <  1 / 4 we have the estimate,

[formula]

Let us choose r (depending on θ to be chosen later) so that Crσ  <  θ. So that we have

[formula]

Thus, by choosing t large, we will be able to make the measure of the set [formula] a small factor of |B1| independently of θ. Note that vA  >  tθ is equivalent to wA  <  1  -  tθ.

Let [formula]. We know that |G|  ≥  (1 - ct- p)|Br|. The set G is also the set where w̃A  ≥  1 - tθ. On the other hand, since G  ⊂  B1, P̃  ≤  1 in G, then P̃  -  w̃A  ≤  tθ in G. This allows us to estimate the difference between - N(x) and wAc in G, where Ac is the complement of the set A.

Clearly wA  +  wAc  =  P  -  N, then N + wAc  =  P - wA  ≤  tθ in G. Since Ñ(x)  ≥  λ  /  ΛP̃(x)  -  ε1, we have that in G

[formula]

Consequently, [formula].

For some small κ > 0, we define [formula]. We know [formula] in B2, thus we can apply Theorem [\ref=t:weakharnack2] to vc(κrx) for some small R > 0 and get

[formula]

So we can choose κ and ε1 so that Cε1  +  Cκσ  <  λ  /  (8Λ) and then t such that Cκ- nt- p  <  λ  /  (8Λ). Therefore we got the following estimate

[formula]

But this means that [formula] which is a contradiction since w̃K(0) = 0.

The contradiction came from saying that P̃(x0)  ≥  (1 - θ) for some x0 in Br. Thus P̃  <  (1 - θ) in Br. In the original scale, this means that P  ≤  (1 - θ)k + 1 in Brk + 1, which finishes the inductive step and the proof.

Using Lemma [\ref=ultimateLemma], we can finally prove Theorem [\ref=t:main].

As it was mentioned before, the case σ  ≤  1 is already covered in [\cite=CS], so we prove the case σ∈(1,2) only.

Let us consider the fractional laplacian of order σ

[formula]

where the constant cσ remains bounded below and above for σ∈(1,2).

Let b be a bump function as in Lemma [\ref=l:locallizedSubsolution]. We rewrite the fractional laplacian as

[formula]

By Lemma [\ref=ultimateLemma], [formula] for some α > 0 and C universal constants.

Since u∈L∞, then g∈C∞. In particular g is Cα. For a universal constant C,

[formula]

Adding the two estimates above we get that

[formula]

Therefore by a standard translation of the estimate we obtained that [formula], with the estimate

[formula]

But if [formula]. It is a classical result that this implies a corresponding estimate for u∈Cσ  +  α (see for example [\cite=stein1970sia]). So we finish the proof.

We have not used the homogeneity of I in any proof in this paper. With the same proof we can obtain the same regularity result for equations of the form

[formula]

for a bounded family of real numbers [formula]. This is the general form of a concave uniformly elliptic nonlocal operator of order σ.

For the estimates, we would have to include the values of [formula] in the right hand side:

[formula]

The assumption [formula] is not sharp. It could easily be replaced in all estimates by [formula]. We kept the L∞ norm for simplicity of the exposition.

Acknowledgments

Both authors were partially supported by NSF grants.

Part of this work took place while both authors were visiting the Institute for Advanced Study during the special program in geometric PDE.