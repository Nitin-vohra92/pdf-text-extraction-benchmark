Pathwise Accuracy & Ergodicity of Metropolized Integrators for SDEs

Eric Vanden-Eijnden

Keywords

stochastic differential equations, Metropolis-Hastings algorithm, strong convergence, ergodicity, geometric ergodicity, variational integrators

AMS Subject Classification

65C30 (65C05, 60J05, 65P10)

Introduction

Purpose of the Paper.

This paper considers SDEs whose solution possesses a probability transition density that satisfies a detailed balance-type condition with respect to a known probability distribution. In this context the paper analyzes integrators for such SDEs that

Pure sampling methods can accomplish (i), but they typically do not approximate the solution to the SDE. Integrators for SDEs certainly satisfy (ii), but they often are divergent on infinite time intervals or ergodic with respect to a different equilibrium distribution [\cite=TaTu1990] [\cite=Ta1995] [\cite=MaStHi2002] [\cite=MiTr2004]. This paper shows that a Metropolized integrator can simultaneously accomplish these goals.

Motivation.

This paper is motivated by SDEs that arise in molecular dynamics (MD). Although the numerical analysis of general SDEs is well-studied (see, e.g., [\cite=Ta1995] [\cite=MiTr2004]), the relevance of this analysis to SDEs that arise in MD is limited. Indeed such SDEs are characterized by complex drift vector fields that have limited regularity, and one is typically interested in their solutions over long time intervals. Let us elaborate briefly on the consequences of these two observations.

The drift vector field of SDEs that arise in MD involve the gradient of an empirically derived potential energy function. Due to singularities in the potential energy, this drift vector field possesses limited regularity, e.g., it is nonglobally Lipschitz. The drift vector field is also computationally costly to evaluate because the potential force involves intricate short and long-range interactions between atoms. As a result implicit methods are typically too costly in this application area.

Moreover, the lack of regularity in the drift of SDEs that arise in MD causes explicit discretizations to be stochastically unstable in general. This implies that, in principle, such schemes cannot be used to sample the equilibrium distribution of the SDE. Some approaches to stabilize explicit discretizations of SDEs include

adaptive time-stepping [\cite=LaMaSt2007];

multiple time-stepping [\cite=TuBe1991];

method of rejecting exploding trajectories [\cite=MiTr2005]; and

using bounded random numbers instead of Gaussian ones.

These methods are often ergodic but typically introduce discretization errors in the sampling (i.e. the equilibrium distribution of the numerical scheme is not exactly the same as the distribution of the SDE). A standard way to remove these errors is to resort to a Monte-Carlo method designed for sampling, e.g., hybrid Monte-Carlo algorithms [\cite=DuKePeRo1987] [\cite=Ho1991] [\cite=AkRe2008]. This procedure, however, has the effect that the dynamics of the method becomes unrelated to that of the SDE. Indeed, in this context, the main question often becomes how to make the sampling as efficient as possible by accelerating the rate of convergence of the method.

Here we show that a Metropolis-adjusted explicit integrator can both be ergodic with respect to the known equilibrium distribution of the SDE and captures the dynamical behavior of the solutions of this SDE. To establish this second property, one needs to estimate the effect on the dynamics of the rejections in the Metropolis-Hasting method. The analysis of this effect in the context of a Metropolized integrator for SDEs with the special structure relevant to MD is one of the main objectives of this paper.

Organization of the Paper.

In § [\ref=sec:MainResults], the main results of the paper are presented without proofs and put into context. In § [\ref=sec:NumericalIllustration], numerical validation of the main results is provided. The proofs of the main results are organized according to the type of dynamic and discretization considered. In § [\ref=sec:OverdampedLangevin], the proofs pertaining to a forward Euler-Maruyama discretization of overdamped Langevin dynamics and its Metropolis-adjustment can be found. In § [\ref=sec:InertialLangevin], the proofs pertaining to a Störmer-Verlet based discretization of inertial Langevin dynamics and its Metropolis-adjustment can be found. We wrap up the paper with a conclusion in § [\ref=sec:Conclusion].

Main Results

Overdamped Langevin

In the first part of the paper, we shall focus on overdamped Langevin dynamics on a energy landscape defined by a potential energy function [formula]:

[formula]

Here [formula] denotes the gradient of the function U, [formula] is a standard n-dimensional Wiener process, or Brownian motion, and β > 0 is a parameter referred to as the inverse temperature. Under certain regularity conditions on the potential energy, the solution to [\eqref=SDE1] is geometrically ergodic with an invariant probability measure μ that possesses the following density [formula] with respect to Lebesgue measure[\cite=Ha1980] [\cite=RoTw1996A] [\cite=RoTw1996B]:

[formula]

where [formula]. Next we recall various integration strategies for [\eqref=SDE1] and summarize their properties.

Forward Euler-Maruyama.

Let N and h be given, set T = Nh and tk  =  hk for k = 0,...,N, and consider the following explicit Euler-Maruyama discretization of [\eqref=SDE1]:

[formula]

where [formula]. The iteration rule [\eqref=ULA] defines a Markov chain that possesses a transition kernel with the following smooth, strictly positive probability transition density:

[formula]

Hence, the chain is irreducible with respect to Lebesgue measure. To be consistent with the literature, the discrete-time Markov chain generated by Euler-Maruyama is called the unadjusted Langevin algorithm (ULA)[\cite=RoTw1996A].

If [formula] is globally Lipschitz and h is small enough, ULA [\eqref=ULA] can often be shown to be:

first-order strongly convergent to the solution orbits of [\eqref=SDE1] on finite time intervals;

geometrically ergodic on infinite-time intervals with respect to an invariant measure that is a first-order approximant to the invariant measure μ of [\eqref=SDE1].

The second property is typically established using a Talay-Tubaro expansion of the global weak error of ULA[\cite=TaTu1990].

On the other hand, when [formula] is nonglobally Lipschitz ULA becomes a transient Markov chain for any h > 0[\cite=Nu1984] [\cite=MeTw1996]. In fact, all moments of Euler-Maruyama are unbounded on long time-intervals for any initial condition [formula], i.e., for any integer [formula] and for any h > 0

[formula]

where [formula] denotes the expectation conditional on [formula]. See, e.g.,[\cite=MaStHi2002] [\cite=Ta2002]. As is well known in the literature, a Metropolis-Hastings method can stabilize ULA.

Metropolized Forward Euler-Maruyama.

A Metropolis-Hastings method is a quite general Monte-Carlo method for sampling from a known probability distribution [\cite=MeRoRoTeTe1953] [\cite=Ha1970]. The method generates a Markov chain from a given proposal Markov chain as follows. The algorithm computes a proposal move according to the proposal chain and accepts this proposal with a probability that ensures the Metropolized chain is ergodic with respect to the given probability distribution. Here we shall focus on the Metropolized Euler-Maruyama integrator defined in terms of the equilibrium density π [\eqref=IM] and the transition density qh [\eqref=ULAdensity].

Let ζk  ~  U(0,1) for k = 0,...,N - 1. Given h and [formula] the algorithm calculates a proposal move using the Euler-Maruyama updating scheme in [\eqref=ULA]:

[formula]

and accepts this proposal with a probability

[formula]

That is, the update is defined as:

[formula]

for k = 0,...,N - 1. To be consistent with the literature, we will refer to the Metropolized Euler-Maruyama integrator as the Metropolis-adjusted Langevin algorithm (MALA)[\cite=RoTw1996A]. By construction, MALA preserves the invariant measure μ of [\eqref=SDE1]. If [formula] is globally Lipschitz and h small enough, one can often show that MALA is geometrically ergodic[\cite=RoTw1996A]. See, e.g., Theorem 4.1 of[\cite=RoTw1996A]. However, if [formula] is nonglobally Lipschitz, MALA is often no longer geometrically ergodic. Still, for any [formula] with μ(g)  <    ∞  ,

[formula]

where [formula] denotes expectation conditioned on the initial distribution being the equilibrium distribution of [\eqref=SDE1], i.e.,

[formula]

The identity [\eqref=Xpreservesmu] is obviously a significant improvement to [\eqref=emunboundedmoments].

When [formula] is nonglobally Lipschitz, MALA is not geometrically ergodic because ULA is transient (see Theorem 4.2 of[\cite=RoTw1996A]). To correct this problem, Roberts and Tweedie proposed a modification of MALA which truncates the drift in regions where the underlying Euler method can be explosive. Specifically the proposal move [\eqref=MALAproposal] is modified to a MALA algorithm with bounded drift:

[formula]

When [formula], [\eqref=MALTAproposal] is the Euler-Maruyama update, and otherwise, the proposal drift in [\eqref=MALTAproposal] preserves the direction of the drift in ULA, but normalizes the amplitude in all degrees of freedom. The Metropolis-Hastings method with this modified proposal move will be referred to as the Metropolis-adjusted Langevin truncated algorithm (MALTA)[\cite=RoTw1996A]. By comparison to a random-walk-based Metropolis algorithm, one can often show that MALTA is geometrically ergodic[\cite=RoTw1996A] [\cite=At2005] [\cite=JaHa2000]. While this ad hoc correction to MALA makes MALTA geometrically ergodic, the relation of MALTA to the original diffusion [\eqref=SDE1] remains to be established.

Main Result I: Strong Convergence of MALA & MALTA.

In the paper we shall consider the situation where [formula] is nonglobally Lipschitz. Roughly speaking, MALTA corrupts Euler-Maruyama orbit by the random rejections in [\eqref=MALA] with the modified proposal [\eqref=MALTAproposal] and the ad hoc truncation of the drift. Yet, we show in the paper that MALTA still approximates pathwise the solution of [\eqref=SDE1]. The precise statement is:

Assume [\ref=sa]. Then for every E0 > 0 and T > 0, there exists hc(E0)  >  0 and C(T,E0) > 0 such that for all h < hc, for all [formula], and for all t∈[0,T],

[formula]

Assumption [\ref=sa] can be found in §[\ref=preliminaries]. This assumption remains valid for SDEs of the type [\eqref=SDE1] in which the drift is nonglobally Lipschitz. A key ingredient in the proof is geometric ergodicity of MALTA. This property implies bounds on moments of MALTA at finite times. The precise bounds can be found in Lemma [\ref=MALTAmomentbound].

Since MALA is not geometrically ergodic when [formula] is nonglobally Lipschitz, we are unable to obtain such bounds on moments of MALA at finite times. However, such bounds can be derived if MALA's initial condition is restricted to the equilibrium distribution of [\eqref=SDE1]. This is because MALA by design preserves this distribution. Hence, for MALA we are able to prove the following theorem. We stress that MALTA's strong accuracy does not require this restriction on initial conditions.

Assume [\ref=sa]. For all T > 0 there exists hc  >  0 and C(T) > 0 such that for all positive h < hc and for all t∈[0,T],

[formula]

The proofs of Theorems [\ref=MALTAaccuracy] and [\ref=MALAaccuracy] as well as the precise statement of Assumption [\ref=sa] on which they rely are presented in §[\ref=sec:OverdampedLangevin]. The proofs build on results of global accuracy for numerical methods applied to SDEs with uniformly Lipschitz drift[\cite=MiTr2004] and with one-sided Lipschitz drift[\cite=HiMaSt2002]. §[\ref=sec:NumericalIllustration] will illustrate these results on a simple but representative example with a nonglobally Lipschitz drift.

Inertial Langevin

Next, we shall consider Langevin equations defined in terms of a Hamiltonian function [formula]:

[formula]

where the following matrices have been introduced:

[formula]

Here [formula] is a standard 2n-dimensional Wiener process, or Brownian motion, β > 0 is a parameter referred to as the inverse temperature, and γ > 0 is referred to as the friction coefficient. Write [formula] where [formula] and [formula] represent the instantaneous configuration and momentum of the system, respectively. We shall assume:

[formula]

where [formula] is a symmetric positive definite mass matrix and U is a potential energy function. There are two main differences between the overdamped and inertial Langevin dynamics. First, the solution of [\eqref=SDE1] is a reversible stochastic process, whereas the solution of [\eqref=SDE2] is not. Second, the diffusion in [\eqref=SDE2] is only applied to momentum degrees of freedom, whereas the diffusion in [\eqref=SDE1] is applied to all degrees of freedom. The consequences of these differences to the discretization of [\eqref=SDE2] and its Metropolis-adjustment will be a main focus of § [\ref=sec:InertialLangevin].

Despite the degenerate diffusion in [\eqref=SDE2], under certain regularity conditions on U, the solution to this SDE is geometrically ergodic with respect to an invariant probability measure μ with the following density[\cite=Ta2002]:

[formula]

where [formula].

Geometric Langevin Algorithm.

Let N and h be given, set T = Nh and tk  =  hk for k = 0,...,N. We shall consider an integrator for [\eqref=SDE2] based on splitting the Langevin equations into Hamilton's equations for the Hamiltonian H:

[formula]

and Ornstein-Uhlenbeck equations

[formula]

The solution of Hamilton's equations will be approximated by a symplectic integrator; to be specific, the discrete Hamiltonian map of a self-adjoint variational integrator[\cite=MaWe2001]. While the exact flow will be used for the Ornstein-Uhlenbeck equations. These flows will be composed in a Strang-type splitting to obtain a pathwise approximant to the solution of inertial Langevin which we will refer to as the Geometric Langevin Algorithm (GLA).

This type of splitting of inertial Langevin equations is quite natural and has been recently used in simulations of molecular dynamics (see [\cite=VaCi2006] [\cite=BuPa2007]), dissipative particle dynamics (see [\cite=Sh2003] [\cite=SeFaEsCo2006]), and inertial particles (see [\cite=PaStZy2008]). This paper is geared towards applications in molecular dynamics where Langevin integrators (including the ones cited above) have been based on generalizations of the widely used Störmer-Verlet integrator. The Störmer-Verlet integrator is attractive for molecular dynamics because it is an explicit, symmetric, second-order accurate, variational integrator for Hamilton's equations. In molecular dynamics it was popularized by Loup Verlet in 1967. Other popular generalizations of the Störmer-Verlet integrator to Langevin equations include Brünger-Brooks-Karplus (BBK) [\cite=BrBrKa1984], van Gunsteren and Berendsen (vGB) [\cite=GuBe1982], and the Langevin-Impulse (LI) methods [\cite=SkIz2002]. The LI method is also based on a splitting of Langevin equations, but it is different from the splitting considered here. The long-time properties of GLA were recently analyzed in the context of uniformly Lipschitz potential forces in [\cite=BoOw2009].

An example of a GLA that will be analyzed in § [\ref=sec:InertialLangevin] is the Störmer-Verlet based scheme:

[formula]

It is straightforward to show [\eqref=SVGLA] possesses a smooth probability transition function with respect to Lebesgue measure even though the noise is only applied to momenta in [\eqref=OrnsteinUhlenbeck]. For globally Lipschitz potential forces, it is possible to show that [\eqref=SVGLA] is a first-order strongly accurate integrator for [\eqref=SDE2], and can be shown to be geometrically ergodic with respect to an invariant measure that is a first-order accurate approximation to the exact invariant measure of [\eqref=SDE2] [\cite=BoOw2009]. However, if the potential force is nonglobally Lipschitz, then this discretization is plagued with the same transient behavior as forward Euler-Maruyama applied to the reversible Langevin diffusion process. As before, a Metropolis-Hastings method is proposed to correct the discretization error in the invariant measure and stochastically stabilize this discretization.

MAGLA.

Let ζk  ~  U(0,1) for k = 0,...,N - 1. To Metropolize GLA [\eqref=GLA], we adopt the method of Metropolizing an inertial Langevin integrator introduced in [\cite=ScLeStCaCa2006]. In that paper, the authors present and test this Metropolization technique using a potpourri of integrators including the Ricci-Ciccotti algorithm as a proposal move [\cite=RiCi2003]. The method presented in Scemama et al. involves the involution [formula]:

[formula]

This involution is introduced since the stochastic process defined by composing the solution of [\eqref=SDE2] with φ is reversible with respect to μ.

The Metropolis-Adjusted Geometric Langevin Algorithm (MAGLA) will be based on the probability transition density of GLA which we will refer to as qh. An explicit formula for this transition density is derived in the body of the paper (See [\eqref=GLAdensity].). Given h and [formula], MAGLA computes a proposal move [formula] according to a step of GLA composed with a momentum flip. For example, for the Störmer-Verlet based GLA this proposal move is given explicitly by:

[formula]

The algorithm accepts this proposal move with probability:

[formula]

In other words, the MAGLA update is defined as:

[formula]

for k = 0,...,N - 1. Observe, when a proposal move is rejected, the momentum is "flipped"; and MAGLA involves a modified detailed balance condition [\eqref=MAGLAacceptreject] as opposed to the usual detailed balance condition used with MALA [\eqref=MALAacceptreject]. The reason MAGLA uses a modified detailed balance is related to the nonreversibility of the solution to [\eqref=SDE2]. In particular, the transition density of the solution to [\eqref=SDE2] does not satisfy detailed balance, but does satisfy a modified detailed balance condition. It is straightforward to show that MAGLA preserves μ, and hence, is not transient. In fact, it is often easy to classify MAGLA as an ergodic Markov chain even if the potential force is nonglobally Lipschitz. In the next paragraph, we quantify the strong convergence of MAGLA.

Main Result II: Strong Convergence of MAGLA.

It is straightforward to show GLA provides a first-order globally accurate integrator for [\eqref=SDE2] provided the potential force is globally Lipschitz [\cite=BoOw2009]. As discussed MAGLA involves a momentum flip whenever a proposal move is rejected. This momentum flip was introduced since the stochastic process defined by composing the solution of [\eqref=SDE2] with a momentum flip satisfies detailed balance with respect to π. Despite this momentum flip, MAGLA provides a pathwise approximant to [\eqref=SDE2] as summarized by the following theorem. As in Theorem [\ref=MALAaccuracy], we will restrict the initial conditions of MAGLA to be distributed according to the equilibrium distribution of [\eqref=SDE2]. As before this assumption implies bounds on relevant moments of MAGLA which follow from the fact that MAGLA preserves the measure μ.

Assume [\ref=sa] (C) and [\ref=sa] (E) on the potential energy and [\ref=sa2] on [\eqref=SDE2]. Then for every T > 0, there exists hc  >  0 and C(T) > 0 such that for all h < hc, for all [formula], and for all t∈[0,T],

[formula]

Assumptions [\ref=sa] (C) and [\ref=sa] (E) on the potential energy hold even if potential force is nonglobally Lipschitz. The assumption [\ref=sa2] on [\eqref=SDE2] ensures that the continuous process itself is globally Lipschitz. We stress that this regularity of the continuous process is different from assuming [formula] is globally Lipschitz, and is made for convenience.

Unlike the rejections in [\eqref=MALA], a rejection in [\eqref=MAGLA] leads to a momentum flip, and hence, a loss of local accuracy. Even though, MAGLA still approximates pathwise the solution to [\eqref=SDE2] because the probability of these rejections as a function of time-step size is small. These issues including a proof of Theorem [\ref=SVMAGLAaccuracy] and the lemmas on which it is based can be found in § [\ref=sec:InertialLangevin].

Numerical illustration

Overdamped Langevin

Here we illustrate the results above on the simple example of a particle diffusing in a quartic potential U(x) = x4 / 4 with inverse temperature β > 0. The overdamped dynamics of this system is given by:

[formula]

This SDE admits the following unique invariant measure

[formula]

Let N and h be given. Set T = Nh and tk  =  hk for k = 0,...,N. In terms of which consider the following forward Euler approximation to [\eqref=cosde]:

[formula]

The drift in [\eqref=coeuler] is destabilizing in the region:

[formula]

This property of Euler-Maruyama's discrete drift is the essential reason why Euler-Maruyama defines a transient Markov chain. Indeed, using this property [\eqref=emunboundedmoments] is proved in Lemma 6.3 of [\cite=MaStHi2002]. Despite this shortcoming Euler-Maruyama can be used as candidate dynamics in a Metropolis-Hastings method designed to sample from μ.

Figure [\ref=fig:explodingstagnatingcontracting] illustrates the difference between a given realization of the exact solution to [\eqref=cosde], the Euler-Maruyama integrator [\eqref=coeuler], and the Metropolized integrator when initiated at the edge of Bh and driven by the same realization of the Wiener process W. We empasize that in this figure the time-step is held fixed and chosen to be large. The figure shows the Euler-Maruyama orbit explodes, the solution orbit rapidly contracts to the origin, and the Metropolis-Hastings method initially stagnating, but eventually tracking the solution apparently better over time. We remark that the ability of the Metropolized orbit to track the solution better over time is not a generic property of Metropolized integrators. In this case it is a consequence of [\eqref=cosde] satisfying a "one force, one solution" principle (See [\cite=EKhMaSi2000].). That is, for every realization of the Wiener process, the solution possesses a random attractor that the Metropolized orbit is drawn to.

Figure [\ref=fig:longtimeorbit] shows a longer-time realization of the Metropolized integrator and the solution. The solution at this temperature frequently visits higher energy values. The proposal moves to higher energy values are less likely to be accepted by the Metropolized integrator. At the same time, ergodicity implies the Metropolized integrator must visit these higher energy values, and as often as the exact solution along this long time-interval, since both chains preserve π. Consequently, the Metropolized integrator intermittently stagnates as shown in the figure, and of course, loses pathwise accuracy.

This observation does not contradict Theorems [\ref=MALTAaccuracy] and [\ref=MALAaccuracy]. Keep in mind that the time-step size for this particular orbit is held fixed and chosen to be large. Such stagnations at high energy become less likely to occur along orbits on finite-time intervals as the time-step becomes smaller. Figures [\ref=fig:MALTAPathwiseAccuracy] and [\ref=fig:MALAPathwiseAccuracy] confirms this pathwise convergence. In particular, the figures show an O(h3 / 4) rate of strong convergence of the Metropolized integrator for this example using MALTA and an out of equilibrium initial condition, and MALA with an initial condition restricted to the equilibrium distribution of [\eqref=cosde].

Inertial Langevin

Consider a simple particle with Hamiltonian given by:

[formula]

where U(q) = q4 / 4. The inertial Langevin dynamics of this system is given by:

[formula]

with initial condition (Q(0),P(0))  =  (q0,p0). This SDE admits the following unique invariant measure

[formula]

Let N and h be given. Set T = Nh and tk  =  hk for k = 0,...,N. In terms of which consider the following Störmer-Verlet based GLA discretization of [\eqref=icosde]:

[formula]

with initial condition [formula]. The inertial Langevin integrator [\eqref=cogla] is plagued with the same transient behavior as forward Euler-Maruyama applied to the reversible cubic oscillator Langevin dynamics. This occurs at points in phase space where the underlying explicit Störmer-Verlet integrator in [\eqref=cogla] becomes linearly unstable.

A Metropolis-Hastings method can stochastically stabilize [\eqref=cogla]. At the same time, as stated in Theorem [\ref=SVMAGLAaccuracy], the method is also pathwise accurate with respect to the solution of [\eqref=icosde] when initiated from equilibrium. This accuracy is achieved despite the loss of local accuracy in momentum that occurs at every rejection.

Figure [\ref=fig:MAGLAPathwiseAccuracy] is consistent with the strong O(h) rate of convergence of MAGLA for this example. Assumption [\ref=sa2] is hard to check for this example, but we emphasize the assumption is not equivalent to the potential force being globally Lipschitz.

Overdamped Langevin

Preliminaries

Structural Assumptions.

For a function [formula] and an integer r > 1, let [formula] and DrG be the gradient and the rth-derivative of G, respectively. Let |  ·  | denote the Euclidean vector norm and [formula] the Frobenius norm. Let L denote the generator of [\eqref=SDE1] defined for any [formula] as

[formula]

We stress these structural assumptions hold even if the drift in [\eqref=SDE1] is nonglobally Lipschitz. These structural assumptions imply that the Markov process defined by the solution to [\eqref=SDE1] possesses a unique invariant probability measure explicitly given by:

[formula]

where [formula] with [formula]. These structural assumptions also imply the following estimates on higher moments of solutions to [\eqref=SDE1] which we state as a lemma.

Assume [\ref=sa]. For every integer [formula] we have the following estimates on higher moments of the solution to [\eqref=SDE1].

The proof of this lemma is presented in §[\ref=sec:prooflemma].

The structural assumptions on [\eqref=SDE1] also imply a Lipschitz condition on its solution which we state as another lemma.

Assume [\ref=sa]. For s  ≤  t, let [formula] denote the evolution operator of the solution to [\eqref=SDE1]: with [formula] and for r  ≤  s  ≤  t recall the Chapman-Kolmogorov identity [formula]. Set

[formula]

For all K > 0 there exists hc > 0, such that for all positive h < hc, for all [formula], and for all [formula],

The proof of this lemma is also given below in section [\ref=sec:prooflemma].

Explicit Integrator for the SDE.

Recall that the transition kernel for ULA (cf. [\eqref=ULA]) has a density [formula] with respect to the Lebesgue measure given by

[formula]

It is derived by a simple change of variables relating the probability density of the Euler-Maruyama update to the probability density of a multivariate Gaussian with zero mean and variance 2β- 1h. ULA is irreducible with respect to the Lebesgue measure because its transition density is smooth and strictly positive. However, as mentioned in the introduction, in Langevin diffusions with nonglobally Lipschitz drift, ULA is transient, i.e., stochastically unstable. Nevertheless under the assumptions on the drift, it is straightforward to obtain the following single-step accuracy for the forward Euler-Maruyama scheme.

Assume [\ref=sa]. For all K > 0 there exists a hc such that for all positive h < hc and for all [formula]

The above lemmas are proven in section [\ref=sec:prooflemma].

MALA and its Properties

Ergodicity.

MALA randomly rejects integration steps produced by Euler-Maruyama with a probability designed to ensure the composite chain preserves the equilibrium measure of [\eqref=SDE1]. Recall that this probability is given by:

[formula]

The off-diagonal transition probability kernel of the composite chain has density:

[formula]

The probability of remaining at the same point, or stagnation probability, is given by

[formula]

In sum, the Metropolis-Hastings transition kernel is

[formula]

where δ(  ·  ) denotes the Dirac-delta measure in [formula]. It is straightforward to show that this Ph is a well-defined probability transition kernel. Let [formula] denote the smallest σ-algebra containing all the open subsets of [formula]. For all [formula] and [formula], the k-step transition probability kernel is iteratively defined as

[formula]

with [formula] equal to the characteristic function of the subset A of [formula], i.e., [formula].

Under assumption [\ref=sa] on the potential energy, the k-step transition probability of MALA converges to μ in the following sense

[formula]

The following classification of MALA is quite standard. Since π and qh are strictly positive and smooth everywhere, MALA is irreducible with respect to Lebesgue measure and aperiodic; see, e.g., Lemma 1.2 of [\cite=MenTw1996] and references therein. By the design of the acceptance probability, MALA also preserves the probability measure μ. To confirm this statement observe from [\eqref=mhkernel] that for any [formula]

[formula]

However, since [formula] satisfies detailed balance the first term in the above vanishes, and hence,

[formula]

According to Corollary 2 of [\cite=Ti1994], a Metropolis-Hastings algorithm that is irreducible with respect to the same measure it is designed to preserve is positive Harris recurrent. Consequently, MALA is irreducible, aperiodic, and positive Harris recurrent. According to Proposition 6.3 of [\cite=Nu1984], these properties are equivalent to ergodicity of the chain.

This theorem shows that MALA is ergodic with respect to the equilibrium measure of [\eqref=SDE1]. However, the effect of rejections on the pathwise approximation of the solution remains to be quantified.

Equilibrium Strong Accuracy.

In order to prove equilibrium strong accuracy of MALA the following lemmas will be helpful.

Assume [\ref=sa]. For all integers [formula], there exists an hc > 0 and a constant [formula], such that for all positive h < hc and for all [formula],

[formula]

where

[formula]

and [formula].

Let [formula]. Then,

[formula]

Introduce the function [formula]

[formula]

Using the expressions for qh and π (cf. [\eqref=ULAqh] and [\eqref=pi], resp.) one can show

[formula]

Hence, [\eqref=spiny] can be written as:

[formula]

Introduce the map [formula]

[formula]

Set [formula]. A change of variables of [\eqref=spiny2] under [formula] yields,

[formula]

For h sufficiently small the latter integral can be well-approximated by a Taylor expansion as follows. A Taylor expansion of the function G about h = 0 yields,

[formula]

Substitute this expansion into [\eqref=spinxi] to obtain,

[formula]

An application of Laplace method to approximately evaluate integrals yields,

[formula]

The proof is completed by invoking Assumption [\ref=sa] (E).

Assume [\ref=sa]. For all h > 0 there exists a C > 0 such that

A) By definition of MALA,

[formula]

Hence,

[formula]

It is clear from this expression that the local mean-squared error of the Metropolis-Hastings integrator is due to the local mean-squared error of forward Euler-Maruyama and a term due to probable rejections in the Metropolis-Hastings step. By the Cauchy-Schwarz inequality this latter term can be bounded as follows,

[formula]

Lemma [\ref=sdemomentbound] implies there exists a constant K > 0 such that

[formula]

While Lemma [\ref=MALAstagnationprobability] implies that there exists a constant K > 0 such that

[formula]

Thus, there exists a constant K > 0 such that

[formula]

Observe that [\eqref=MALAsquaredmserror] is dominated by the error incurred when a proposal move is rejected, and not the O(h3) error incurred when a proposal move is accepted (cf. Lemma [\ref=ULAlocalaccuracy]). Hence, the local mean-squared accuracy of MALA is O(h5 / 4).

B) Similar to the proof of part (A)

[formula]

By the triangle inequality

[formula]

It is clear from this expression that the local mean deviation of the Metropolis-Hastings integrator is due to the local mean-deviation of forward Euler-Maruyama and a term due to probable rejections in the Metropolis-Hastings step. By the Cauchy-Schwarz and Jensen inequalities,

[formula]

As in part (A) of this proof, the local mean deviation of forward Euler-Maruyama Lemma [\ref=ULAlocalaccuracy] together with Lemma [\ref=sdemomentbound] and Lemma [\ref=MALAstagnationprobability] imply that,

[formula]

Assume [\ref=sa]. Then for all h > 0 and for all t > 0, there exists a real constant C > 0 such that

[formula]

This bound is a consequence of ergodicity of the solution to [\eqref=SDE1] and MALA with respect to the probability measure μ. That is, the ergodic property of the integrator and the solution of [\eqref=SDE1] imply that

[formula]

We are now in measure to prove Theorem [\ref=MALAaccuracy] which we restate.

Discretize the interval

[formula]

MALTA and its Properties

A necessary condition for geometric ergodicity of a Metropolis-Hastings method is that the rejection or stagnation probability is bounded away from unity (see proposition 5 of [\cite=RoTw1996B]). When the drift in [\eqref=ULA] is nonglobally Lipschitz, ULA is transient and MALA's stagnation probability cannot be globally bounded away from unity. Hence, MALA is not geometrically ergodic. MALTA corrects this problem by truncating the drift in the candidate dynamics in regions where the Euler-Maruyama integrator can be explosive. This modification enables a precise control of the moments of the integrator initiated from a nonequilibrium initial condition. With this control we are able to prove pathwise accuracy of MALTA on finite time-intervals.

The geometric ergodicity of MALTA for super-exponential target densities with non-degenerate level-sets was intuitively clear to the investigators who proposed the algorithm in[\cite=RoTw1996A]. Subsequently, it was proven in proposition 2.1 of[\cite=At2005] using techniques to prove geometric ergodicity for random walk Metropolis candidate dynamics given in[\cite=JaHa2000]. For the convenience of the reader, the theorem is restated.

Assume [\ref=sa]. For every h > 0, there exists a nonnegative function [formula], real constant ρ < 1, such that the k-step transition probability [formula] of MALTA converges to μ geometrically fast:

[formula]

where we have introduced a TV norm [formula] which is defined for a signed measure ν as:

[formula]

The main implication of geometric ergodicity for our purpose is the following crucial estimate on moments of MALTA. The proof of this lemma is a straightforward, but tedious consequence of the results in Proposition 2.1 and Lemma 6.2 of[\cite=At2005].

Assume [\ref=sa]. For every E0 > 0, for every [formula], there exists a hc > 0 and C(E0) > 0 such that for all positive h < hc, for all [formula], and for all t > 0,

[formula]

We are now in measure to prove Theorem [\ref=MALTAaccuracy].

The proof of this theorem is similar to the proof of Theorem [\ref=MALAaccuracy] with the following main differences.

The preservation of the moments of the solution to [\eqref=SDE1] and the Metropolis-Hastings method due to ergodicity are replaced by bounds on moments implied by Lemmas [\ref=sdemomentbound] and [\ref=MALTAmomentbound].

The k + 1-step error conditioned on knowing Fk is split into two parts:

[formula]

For the first part, the results of Theorem [\ref=MALAaccuracy] apply with the provision given in the first difference above. For the second term, Chebyshev's inequality implies:

[formula]

This inequality, Assumption [\ref=sa] (E), Lemma [\ref=sdemomentbound], and Lemma [\ref=MALTAmomentbound] imply that there exists a constant C(E0) > 0 such that,

[formula]

Inertial Langevin

Next we shall consider a Metropolized version of a discretization of [\eqref=SDE2] that extends variational integrators to inertial Langevin dynamics. We begin by introducing the so-called geometric Langevin algorithm and discuss its properties. The section then examines the properties of the Metropolis-Hastings adjusted geometric Langevin algorithm, including quantifying its accuracy in approximating inertial Langevin dynamics.

The arguments in this section are very closely related to those in § [\ref=sec:OverdampedLangevin]. However, there are two key differences. First, the solution to [\eqref=SDE2] is no longer a reversible stochastic process. Yet, the transition kernel of the solution process composed with a momentum flip does satisfy detailed balance. Second, the diffusion in [\eqref=SDE2] is only applied to momentum and not position. These differences motivate this section on Metropolizing discretizations of nonreversible processes. However, we will omit analysis that is redundant.

Geometric Langevin Algorithm

Let N and h be given, set T = Nh and tk  =  hk for k = 0,...,N. We shall consider an integrator for [\eqref=SDE2] based on splitting the Langevin equations into Hamilton's equations for the Hamiltonian H [\eqref=HamiltonsEquations] and and Ornstein-Uhlenbeck equations [\eqref=OrnsteinUhlenbeck]. The solution of Hamilton's equations will be approximated by the discrete Hamiltonian map of a variational integrator[\cite=MaWe2001]. While the exact flow will be used for the Ornstein-Uhlenbeck equations. These flows will be composed in a Strang-type fashion to obtain a pathwise approximant to Langevin's equations which we will call the Geometric Langevin Algorithm (GLA).

Variational Integrators.

Let [formula] denote the Lagrangian obtained from the Legendre transform of the Hamiltonian H, and given by:

[formula]

A variational integrator is defined by a discrete Lagrangian [formula] which is an approximation to the so-called exact discrete Lagrangian which is defined as:

[formula]

where [formula] solves the Euler-Lagrange equations for the Lagrangian L with endpoint conditions [formula] and [formula].

A discrete Lagrangian determines a symplectic integrator as follows. Given [formula], a variational integrator defines an update [formula] by the following system of equations:

[formula]

Denote this map by [formula], i.e.,

[formula]

where [formula] solve [\eqref=del]. One can show that θh preserves the canonical symplectic form on [formula], and hence, is Lebesgue measure preserving [\cite=MaWe2001]. By appropriately constructing Ld, the map θh can define an approximation to the flow of Hamilton's equations for the Hamiltonian H [\eqref=HamiltonsEquations].

A discrete Lagrangian is self-adjoint if:

[formula]

Some of the results that follow will be specific to the Störmer-Verlet integrator which can be derived from the following discrete Lagrangian:

[formula]

This discrete Lagrangian is clearly self-adjoint.

Ornstein-Uhlenbeck Equations.

The following stochastic evolution map [formula] defines the stochastic flow of [\eqref=OrnsteinUhlenbeck]:

[formula]

For the distribution of the solution, the stochastic flow will be denoted simply by ψh. Let oh denote the transition probability density of ψtk + h,tk. By a change of variables, it's transition density is given explicitly by:

[formula]

where

[formula]

Observe that this transition density does not depend on the initial or terminal position, since [\eqref=eq:psi] fixes position and the Hamiltonian is separable.

Strang-type Splitting.

GLA is defined as the following Strang-type splitting pathwise approximant to [\eqref=SDE2]:

[formula]

for k = 0,...,N - 1. For any [formula], the transition probability kernel for GLA is given by:

[formula]

Observe that the zero of the Dirac-delta measure is implicitly defined by To make it explicit, we perform a change of variables,

[formula]

From which it follows the transition density qh of GLA is given by:

[formula]

Observe that an explicit characterization of qh is available even when the variational integrator is implicit.

Störmer-Verlet Based GLA.

In this paragraph a local accuracy result is stated for the Störmer-Verlet based GLA [\eqref=SVGLA]. Let [formula]. Recall, that given [formula] at time zero and h > 0, the algorithm computes [formula] by the following explicit update rule: The proof of the following lemma is similar to Lemma [\ref=ULAlocalaccuracy], and hence, is omitted.

Assume [\ref=sa] (C) and [\ref=sa] (E) on the potential energy. For all h > 0 and [formula], there exists [formula] such that μ(C)  <    ∞   and

As has been demonstrated, the Markov chain defined by sampling [\eqref=SVGLA] every time-step possesses a smooth probability transition density with respect to Lebesgue measure. For globally Lipschitz potential forces, this discretization is a first-order strongly accurate integrator for [\eqref=SDE2]. However, if the potential force is nonglobally Lipschitz, the Störmer-Verlet based GLA is plagued with the same transient behavior as Euler-Maruyama for overdamped Langevin. As before, a Metropolis-Hastings method is proposed to stochastically stabilize this Markov chain.

MAGLA and its Properties

MAGLA is the Metropolis-adjusted GLA. Given h and [formula], MAGLA computes a proposal move according to a step of GLA:

[formula]

MAGLA accepts this proposal move with probability:

[formula]

Altogether, the MAGLA update is given by:

[formula]

for k = 0,...,N - 1. We stress the momentum flip in the acceptance probability and upon rejection is introduced because inertial Langevin dynamics is nonreversible. Yet, the exact transition density of the solution to inertial Langevin composed with a momentum is reversible, i.e., does satisfy detailed balance. We will see in the proof of Lemma [\ref=MAGLAstagnationprobability] that without this momentum flip, pathwise accuracy cannot be achieved with MAGLA.

MAGLA preserves μ, and hence, is not transient even when its underlying variational integrator is explicit. In fact, it is often straightforward to classify MAGLA as an ergodic Markov chain even if the potential force is nonglobally Lipschitz. However, with an explicit variational integrator MAGLA is often no longer geometrically ergodic even with momentum flips. To correct this problem, a modification of MAGLA can be implemented where the drift is truncated in regions where an explicit discretization of the drift causes high rejection rates. This modification which would be analogous to MALTA is not implemented here. Instead, we will concentrate on proving pathwise accuracy from an initial condition restricted to the equlibrium measure. This restriction enables us to obtain bounds on relevant moments of the Metropolized integrator. To prove pathwise accuracy the following lemmas will be useful.

The following lemma shows for an arbitrary symmetric variational integrator, the acceptance probability of MAGLA is related to the energy change in its variational integrator. This implies that the acceptance probability of MAGLA has mechanical and intrinsic meaning. It also simplifies the subsequent analysis of MAGLA.

Let qh denote the transition probability density of GLA. Let Ld denote the discrete Lagrangian associated with the variational integrator θh. Assume that Ld is self-adjoint (cf. [\ref=SelfAdjointLd]). Then, the acceptance probability of MAGLA satisfies:

[formula]

where we have introduced:

[formula]

Introduce the abbreviations: [formula] for i = 1,2, and [formula]. Expanding [\eqref=GLAdensity] yields,

[formula]

The self-adjoint property of the discrete Lagrangian implies that:

[formula]

Hence,

[formula]

From [\eqref=q0p0toq1p1] and [\eqref=q1p1toq0p0], it follows that

[formula]

And, finally,

[formula]

The following lemma is analogous to Lemma [\ref=MALAstagnationprobability], and roughly speaking, quantifies how often rejections occur in MAGLA.

Consider the Metropolized Störmer-Verlet based GLA [\eqref=SVGLA]. Assume [\ref=sa] (C) and [\ref=sa] (E) on the potential energy. For any integer [formula], there exists hc > 0 and [formula], such that for all positive h < hc and for all [formula],

[formula]

where

From Lemma [\ref=MAGLAacceptanceprobability] it is clear that,

[formula]

Substitute qh from [\eqref=GLAdensity] into the above to obtain,

[formula]

Integrate with respect to [formula] to obtain the following simplified expression,

[formula]

Let [formula]. Then,

[formula]

Let [formula] be the decomposition matrix arising from the Cholesky factorization of [formula], i.e., [formula]. Introduce the map [formula], with [formula], and defined implicitly by the following relation:

[formula]

Set [formula]. A change of variables of [\eqref=spinq1] under the map φ yields,

[formula]

Up to this point the argument has been for a general GLA. Now, the proof is specialized to the Störmer-Verlet based GLA. For the Störmer-Verlet discrete Lagrangian [\eqref=VerletLd]:

[formula]

Substitute these expressions into [\eqref=DeltaE] gives:

[formula]

Substitute the change of variables implicitly defined by [\eqref=q1toeta] into [\eqref=VerletDeltaE] and then Taylor expand ΔE about h = 0 to obtain,

[formula]

As in Lemma [\ref=MALAstagnationprobability], a standard application of Laplace's method together with Assumption [\ref=sa] (E) gives the desired result.

Using Lemma [\ref=MAGLAstagnationprobability], we are now in position to quantify the local accuracy of MAGLA.

Assume [\ref=sa] (C) and [\ref=sa] (E) on the potential energy. For all h > 0 and [formula], there exists [formula] such that μ(C)  <    ∞   and

A detailed proof is omitted since similar steps are taken in the proof of Lemma [\ref=MALAlocalaccuracy]. We remark that it follows from the definition of MAGLA [\eqref=MAGLA],

[formula]

This estimate reveals that the local mean-squared error of MAGLA is a sum of the local mean-squared error of GLA (cf. Lemma [\ref=GLAlocalaccuracy]) and the error that arises from a potential rejection weighted by the probability of rejection. This error is O(1) because when a rejection happens in [\eqref=MAGLA], the momentum is flipped. However, the probability of rejection is within the order of accuracy of the method according to Lemma [\ref=MAGLAstagnationprobability].

As discussed MAGLA involves a momentum flip whenever a proposal move is rejected. Despite this MAGLA provides a pathwise approximant to [\eqref=SDE2] as summarized by the following theorem.

A detailed proof is omitted as it is similar to the proof of Theorem [\ref=MALAaccuracy]. Recall, the main tools needed for that proof are local accuracy of MAGLA which follows from Lemma [\ref=MAGLAlocalaccuracy], and the invariance of μ under both the transition kernel of the solution to [\eqref=SDE2] and the Markov chain defined by Störmer-Verlet-based MAGLA.

Conclusion

This paper examined the pathwise accuracy of Metropolized integrators applied to overdamped and inertial Langevin dynamics. The paper primarily analyzed explicit discretizations of these ergodic SDEs. For explicit discretizations if the drift is nonglobally Lipschitz, discretization errors often lead to stochastically unstable Markov chains. A Metropolis-Hastings method was shown to stochastically stabilize these discretizations. The paper used this stochastic stability to quantify the error induced by the Metropolis-Hastings methods in approximating the solution to the SDE.

Although the paper restricted to specific discretizations of these SDEs as proposal moves, the strategy to prove the results is rather general. The strategy can be used to prove pathwise accuracy of Metropolized versions of higher order accurate, adaptive and multistep discretizations of overdamped or inertial Langevin dynamics (See, e.g., [\cite=MiTr2004] [\cite=VaCi2006].). In fact, this strategy applies to a larger class of SDEs, namely those which possess a transition density that satisfies detailed balance-type condition.

Our strategy relies on two main ingredients. First, that the local error induced by the Monte-Carlo method depends upon the time-step size in an algebraic fashion. For example, often we found that the local mean-squared error of the Metropolized Integrator can be decomposed as:

[formula]

where [formula] is a single step of the Metropolis-adjusted discretization, [formula] is the exact solution of the SDE after a single step, [formula] is the proposal move step (a single step of the unadjusted discretization), αh is the probability of accepting a proposal move, and φ is a deterministic map applied if a proposal move is rejected. The first term is bounded by [formula], i.e., the local order of accuracy of the discretization. The second term is bounded by using the Cauchy-Schwarz inequality, together with bounds on [formula] and [formula]. For MALA φ was the identity, so that a rejected proposal was nearby the solution. To be precise, [formula]. The likelihood of a rejection to occur turns out to be [formula]. Since the local mean-squared error of the unadjusted discretization was O(h3 / 2), the local mean-squared error of MALA was dominated by the error incurred by rejected proposal moves which was O(h5 / 4).

For MAGLA φ was not the identity, but involved a momentum flip. This momentum flip was imperative because the exact transition density of inertial Langevin dynamics does not satisfy detailed balance, but a modified detailed balance condition that is derived from composing the solution of inertial Langevin with a momentum flip. Consequently, a rejected proposal move for MAGLA loses local accuracy, i.e., [formula]. Nevertheless, the probability of rejection turns out to be within the order of accuracy of the SV-based GLA, i.e., [formula]. Thus, we found the error incurred by a rejected proposal move to be of the same order as that of an accepted proposal move. Hence, the local mean-squared accuracy of MAGLA was O(h3 / 2).

The second ingredient involves bounds on moments of the integrator that are uniform in the time-step size. These bounds enabled the local error estimates to be extended to global error estimates, and hence, pathwise convergence on finite time-intervals. These bounds are automatic if initial conditions are restricted to the known equilibrium distribution the Metropolis-adjusted integrator is designed to sample. To relax this restriction on initial conditions, geometric ergodicity played a key role to obtain such bounds. MALA is often ergodic, but because its proposal chain is often transient, is not geometrically ergodic. This transience is due to a numerical instability in forward Euler for large energy values. By suitably truncating the drift at high energy values, one can ensure the proposal dynamics is not transient. MALA with truncated drift, or MALTA is known to often be geometrically ergodic on infinite time-intervals where MALA is not. The paper used this property to prove MALTA is pathwise convergent on finite time-intervals without a restriction on its initial condition. We remark that MALTA can be generalized to explicit higher-order, multistep and adaptive integrators for overdamped and inertial Langevin equations.

Finally, we emphasize that GLA can be extended to non-flat configuration spaces and multiple time-steps. Indeed, its underlying variational integrator can incorporate holonomic constraints (via, e.g., Lagrange multipliers) [\cite=WeMa1997] and multiple time steps to obtain so-called asynchronous variational integrators [\cite=LeMaOrWe2003]. A natural choice for the variational integrator would be a SHAKE or RATTLE algorithm [\cite=WeMa1997] [\cite=MaWe2001]. The Ornstein-Uhlenbeck equations [\eqref=OrnsteinUhlenbeck] are defined on a flat vector space since the configuration is held fixed. Moreover, a review of the proof of Lemma [\ref=MAGLAacceptanceprobability] shows that the probability transition density of GLA can be explicitly characterized even if the configuration space is not flat. By inspection, this density is absolutely continuous with respect to the standard volume measure on that non-flat space. Consequently, GLA on manifolds can be used as proposal dynamics in a Metropolis-Hastings context, and MAGLA can be extended to non-flat configuration spaces to treat, e.g., inertial Langevin equations with holonomic constraints as in [\cite=VaCi2006]. Moreover, MAGLA on manifolds can readily classified as an ergodic Markov chain on that non-flat phase space.

Acknowledgements

We thank Christof Schütte for stimulating discussions. We thank Tony Lelievre, Sebastian Reich, and Gabriel Stoltz for suggestions on an earlier version of this paper.

Proof of Lemmas [\ref=sdemomentbound], [\ref=regularityofsolutions] and [\ref=ULAlocalaccuracy]

Proof of Lemma [\ref=sdemomentbound]

Assumption [\ref=sa] (B) on the generator of the (SDE) implies

From this expression it is clear that for all t > 0 and for all [formula]

Hence, the upper bound derived in the proof of Lemma [\ref=sdemomentbound] (A) on [formula] implies an upper bound on [formula].

The triangle inequality implies that,

Since the function [formula] is strictly convex,

Recall, that the higher order central moments of a normal random variable ξ  ~  N(0,t) are given by:

Since the function [formula] is convex for positive reals,

An application of Cauchy-Schwarz inequality yields,

According to Assumption [\ref=sa] (E), there exists a constant K > 0 such that

An application of Hölder's inequality and Lemma [\ref=sdemomentbound] (A) imply there exists a possibly different constant K > 0 such that

Hence,

Proof of Lemma [\ref=regularityofsolutions].

According to Assumption [\ref=sa] (D),

Gronwall's lemma implies that,

An application of the Cauchy-Schwarz inequality implies,

Assumption [\ref=sa] (C) implies,

Assumption [\ref=sa] (A) and the triangle inequality imply there exists a constant K > 0 such that

The Cauchy-Schwarz inequality implies that

Lemma [\ref=sdemomentbound] implies with a possibly different constant K > 0

While the first part of this lemma implies, again with a possibly different constant K > 0 that,

Proof of Lemma [\ref=ULAlocalaccuracy]

The Cauchy-Schwarz inequality implies

Assumption [\ref=sa] (C) implies that there is a constant K > 0 such that,

A second application of Cauchy-Schwarz yields,

Lemma [\ref=sdemomentbound] implies that there exists a constant K > 0 such that

Applying the Cauchy-Schwarz inequality twice gives,

Jensen's inequality implies that,

Assumption [\ref=sa] (E) implies the existence of a K > 0 such that

An application of Lemma [\ref=sdemomentbound] gives the required result.