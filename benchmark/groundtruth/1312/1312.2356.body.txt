Corollary Lemma Proposition Definition Remark Algorithm

Multi-material phase field approach to structural topology optimization

Introduction

The efficient use of material and related to that the optimization of shapes and topology is of high importance for the performance of structures. Many different methods have been introduced to solve shape and topology optimization problems and we refer to Bendsoe, Sigmund [\cite=Bendsoe], Sokolowski, Zolesio [\cite=SZ] and Allaire, Jouve, Toader [\cite=Allaire2] for details. In this paper we analyze a multi-phase field approach for shape and topology optimization problems. This approach is related to perimeter penalizing methods. However, instead of the perimeter the Ginzburg-Landau energy

[formula]

is added to the objective functional. In ([\ref=Ginzburg-Landau-Energy]) the set Ω is a given design domain, the function [formula] which takes values in [formula] is a phase field vector, Ψ is a potential function with absolute minima which describe the different materials and the void and ε > 0 is a small parameter related to the interface thickness. It can be shown that ([\ref=Ginzburg-Landau-Energy]) converges in the sense of Γ-limits to the perimeter functional, see Modica [\cite=Modica]. The phase field method has been introduced in topology optimization by Bourdin and Chambolle [\cite=BC1] and was subsequently used by Burger, Stainko [\cite=Burger], Wang, Zhou [\cite=WangZhou], Takezawa, Nishiwaki, Kitamura [\cite=Takezawa], Dedé, Borden, Hughes [\cite=Dedeetal], Blank et al [\cite=our] [\cite=BGSSSV] and Penzler, Rumpf, Wirth [\cite=Rumpfetal]. However, so far a rigorous derivation of first order conditions and an analysis of these conditions in the sharp interface limit ε  →  0 was missing. In this paper we not only discuss recent progress in this direction but also introduce and analyze a new efficient method to solve the constrained minimization problem.

Although in principle the phase field approach can as well be used for other shape and topology optimization problems we restrict ourselves to situations where we seek a domain ΩM and a displacement [formula] such that

[formula]

or an L2-error to a target displacement

[formula]

is minimized subject to the equations of linear elasticity. Here [formula] and [formula] are volume and surface forces and c  ≥  0 is a given weight function on Ω. The optimization problem ([\ref=meanc]) is a mean compliance minimization problem and ([\ref=compl]) is an example of a compliant mechanism problem, see [\cite=Allaire2] [\cite=Bendsoe] for details. In this contribution we will be brief and refer to [\cite=our] and to the forthcoming article [\cite=BlRu] for details.

Setting of the Problem

In this section we introduce how structural topology optimization problems can be formulated within the phase field approach.

The goal in multi-material shape and topology optimization is to partition a given bounded Lipschitz design domain [formula] into regions occupied by either void or by N - 1 different materials such that a given cost functional is minimized subject to given constraints. Within the phase field approach we describe the different material distributions with the help of a phase field vector [formula], where φN describes the fraction of void and [formula] describe the fractions of the N - 1 different materials. The phase field approach allows for a certain mixing between materials and between materials and void but the mixing will be restricted to a small interfacial region. In order to ensure that the phase field vector [formula] describes fractions we require that [formula] lies pointwise in the Gibbs simplex [formula]

In this work we prescribe the total spatial amount of the material fractions through [formula], where it is assumed that [formula] with mi∈(0,1), [formula], and where [formula] denotes the mean value on Ω. We remark that in principal inequality constraints for [formula] can also be dealt with.

The potential [formula] is assumed to have global minima at the unit vectors [formula], [formula], which correspond to the different materials and to the void.

In ([\ref=Ginzburg-Landau-Energy]) we choose an obstacle potential [formula] where Ψ0 is smooth and IG is the indicator function of the Gibbs-simplex [formula]. Introducing [formula] and [formula] we obtain

[formula]

and on [formula] we have [formula].

We describe the elastic deformation with the help of the displacement vector [formula] and with the strain tensor [formula]. The boundary ∂Ω is divided into a Dirichlet part ΓD, a non-homogeneous Neumann part Γg and a homogeneous Neumann part Γ0. Furthermore, [formula] is the elasticity tensor, [formula] is the volume force and [formula] are boundary forces.

The equations of linear elasticity which are the constraint in our optimization problem are given by

[formula]

where [formula] is the outer unit normal to ∂Ω. The elasticity tensor [formula] is assumed to depend smoothly on [formula], [formula] has to fulfill the usual symmetry condition of linear elasticity and has to be positive definite on symmetric tensors. More information and detailed literature on the theory of elasticity can be found in [\cite=our]. For the phase field approach the void is approximated by a very soft material with an elasticity tensor [formula] depending on the interface thickness, e.g. [formula] with a fixed tensor N. Discussions on how to interpolate the elasticity tensors [formula], for [formula], given in the pure materials onto the interface can also be found in Section [\ref=landc] and in [\cite=Bendsoe] [\cite=our].

Introducing the notation [formula], where for any matrices A and B the product is given as [formula], the elastic boundary value problem ([\ref=state]) can be written in the weak formulation: Given [formula] find [formula] such that

[formula]

which has to hold for all [formula]. The well-posedness of ([\ref=mean-compliance]) can be shown by using the Lax-Milgram lemma and Korn's inequality, for details see [\cite=our].

Summarized, the structural optimization problem can be formulated as: Given [formula] and measurable sets Si  ⊆  Ω, i∈{0,1}, with [formula], we want to solve

[formula]

where α,β  ≥  0,  γ,ε > 0, [formula] with [formula],

[formula]

and the functional for the compliant mechanism is given by

[formula]

with a given non-negative weighting factor c∈L∞(Ω) fulfilling [formula]. The existence of a minimizer to (Pε) is shown by classical techniques of the calculus of variations in [\cite=our].

From the applicational point of view it might be desirable to fix material or void in some regions of the design domain, so the condition [formula] makes sense. Moreover by choosing S0 such that [formula] we can ensure that it is not possible to choose only void on the support of c, i.e. in ([\ref=push-functional]) we ensure [formula].

Optimality system

In order to derive first-order necessary optimality conditions for the optimization problem (Pε), it is essential to show the differentiability of the control-to-state operator, which is well-defined because of the well-posedness of ([\ref=mean-compliance]).

The control-to-state operator [formula], defined by [formula], where [formula] solves ([\ref=mean-compliance]), is Fréchet differentiable. Its directional derivative at [formula] in the direction [formula] is given by [formula], where [formula] denotes the unique solution of the problem

[formula]

The expression ([\ref=linearized-problem]) formally can be derived by differentiating the implicit state equation [formula] with respect to [formula]. The proof of Theorem [\ref=Gateaux-diff] can be found in [\cite=our].

With Theorem [\ref=Gateaux-diff] at hand, we can now derive first order conditions. Indeed, it follows from the chain rule that the reduced cost functional [formula] is Fréchet differentiable at every [formula] with the Fréchet derivative [formula]. Here we have to assume that J0  ≠  0 in case of β  ≠  0. Owing to the convexity of [formula], we have for every minimizer [formula] of j in [formula] that [formula]. We can now state the complete optimality system, see [\cite=our] for a proof.

Let [formula] denote a minimizer of the problem (Pε) and [formula], [formula] are the corresponding state and adjoint variables, respectively. Then the functions [formula] fulfill the following optimality system consisting of the state equation

[formula]

the adjoint equation

[formula]

and the gradient inequality

[formula]

Sharp interface asymptotics

In this section we present the sharp interface limit of the optimality system given in Theorem [\ref=OPTSYS]; for a detailed derivation of the sharp interface limit using the method of formally matched asymptotic expansions we refer to [\cite=our]. We now consider a more concrete form of the [formula]-dependent elasticity tensor. We choose the elasticity tensor starting with constant elasticity tensors [formula] which are defined in the pure materials, i.e. when [formula], and model the void as a very soft material. As mentioned, a possible choice of the elasticity tensor in the void is [formula] where N is a fixed elasticity tensor. In order to model the elastic properties also in the interfacial region the elasticity tensor is assumed to be a tensor valued function [formula] which interpolate between [formula]. Furthermore we assume that the weighting factor c in the compliant mechanism functional J0 is a smooth function. The asymptotic analysis gives that the phase field functions converge as ε tends to zero to a limit function [formula] which only takes values in [formula]. This implies that the domain Ω is partitioned into N regions [formula], which are separated by interfaces Γij,  i < j. We choose a unit normal at Γij such that for δ > 0 small we have [formula] and [formula]. Moreover we define [formula]. We obtain in regions occupied by material, i.e. for [formula], that the state and the adjoint equation, respectively, have to hold

[formula]

In case of material-material interfaces, i.e. Γij, [formula] we have continuity in the variables [formula], [formula] and continuity for the normal stresses [formula] and [formula], i.e. for [formula] and [formula] we have [formula]. On ΓiN we get [formula]. Moreover we obtain for all i,j  ≠  N

[formula]

where κ is the mean curvature of Γij and [formula] are Lagrange multipliers. We remark that the terms involving [formula] and [formula] generalize the Eshelby traction known from materials science, see [\cite=our]. In addition for all i  ≠  N it holds

[formula]

Above the Lagrange multipliers [formula] sum up to zero and they are related to volume constraints [formula] which are obtained from the integral constraints [formula] in the sharp interface limit. In case that void and two or more materials appear junction points emerge, where e.g. void and two materials meet, see e.g. Figure [\ref=fig:Fig1], and it might be desirable in applications to influence the angles at the junctions. By an appropriate choice of the potential Ψ the angles at the junctions can be prescribed, see [\cite=our] for details.

In the case of one material we recover the classical first order conditions for the sharp interface structural optimization problem, see e.g. Allaire, Jouve, Toader [\cite=Allaire2]. The conditions we derived above generalize the first order conditions in [\cite=Allaire2] to the multi-phase case.

Numerical methods

Choice of the potential

In the previous section we studied the Ginzburg-Landau energy with an obstacle potential which leads to an optimization problem with inequality constraints. Using instead a smooth potential would lead to equality constraints only which are usually easier to handle. However, there is a subtle problem, namely, we can not prescribe the total spatial amount of the material by [formula] since the identification of pure i-th-material with φi = 1 does not hold any longer but the value attained in phase i depends on ε. Only in the limit for ε  →  0 there is a pure i-th phase at x∈Ω if φi(x) = 1. In Table [\ref=smoothy] the shift of one phase is presented for a numerical experiment. The listed values are the values in areas where the values stay nearly constant, reflecting a pure phase. Therefore, the i-th material does not have approximately volume mi by prescribing [formula]. Consequently one has to use the obstacle potential or the spatial amount has to be modelled in a different way.

Choice of the stiffness tensor on the interface

The choice of the stiffness tensor on the interface also has a quite severe influence on the solution. A rough explanation in the presence of one material is the following: The stiffest structure has material everywhere. The mass constraints prohibit this. However, since it is possible to choose φi∈(0,1) on the interface, it can happen that it is best to have a large mushy region with a mixture of void and material, i.e. a broad interface, which leads to a stiffer structure. Therefore the stiffness tensor on the interface should drop down fast but smoothly from the higher stiffness to the lower stiffness. We use an quadratic interpolation of the elasticity tensors [formula] and set the directional derivative in direction from the lower to the higher stiffness at the material with the lower stiffness to zero. One possibility for N-phases is:

[formula]

where the tensors are ordered from high to low stiffness. A similar kind of interpolation is used in the SIMP approach for one material and void [\cite=Bendsoe]. The choice of the elasticity tensor on the interface influences also the speed of the numerical algorithm.

Projected H1-gradient method

In this section we focus on the mean compliance problem, i.e. β  =  0 and we use the reduced problem formulation

[formula]

where [formula] is convex and closed and j[formula] is Fréchet-differentiable, where the directional derivatives are given by:

[formula]

The first-order condition of a general minimization problem [formula] s.t. [formula] where U is convex and closed can be rewritten as a fixed point equation: For any λ  >  0 the solution is given as [formula] where PH is the projection onto the convex feasible set U with respect to the scalar product in H, see [\cite=GruSa]. Based on this projected gradient methods have been developed. We propose to use the following new variant: This is not the more known search along the projected gradient path [formula] which requires in each line-search step an (expensive) projection. We can prove a global convergence result [\cite=BlRu] which can be found for convex functions in [\cite=GruSa].

Let H be a Hilbert space, U  ⊂  H be convex, closed and non-empty and [formula] be continuously Fréchet differentiable. Then, every accumulation point [formula] of [formula] generated by Algorithm [\ref=algo1] is first order critical if the Armijo step length rule is used.

The reduced cost functional j is differentiable in [formula], which is not a Hilbert-space. Nevertheless, we choose the Hilbert-space [formula] with the scalar product [formula]. The gradient does not exist in H1. However, since

[formula]

for some constant c, we do not need the H-gradient but only the directional derivatives for the projection. Hence, we define and use instead of the projection PH the projection type operator PH where [formula] is given by the solution of

[formula]

The existence and uniqueness of a solution [formula] of ([\ref=proj]) can be shown in our application, see [\cite=BlRu]. Moreover, under some regularity conditions on j which are fulfilled for our problem, we can show the same global convergence result as in Theorem [\ref=5.2], see [\cite=BlRu]. Numerically we solve the obstacle type problem ([\ref=proj]) with a primal-dual active set approach.

Scaling

In the following we address the choice of the parameter λ in the algorithm. It turned out the scaling of the employed norm is essential for efficiency and for iteration numbers independent of the interface thickness, i.e. of ε. One can motivate this by the fact that the perimeter is approximated by the Ginzburg-Landau energy, which roughly speaking entail [formula] for the minimizer [formula]. Hence we have [formula] and [formula]. This is confirmed also numerically. As a consequence we choose the [formula] metric. Since [formula] this leads to the use of a scaled H-gradient since [formula], respectively this emphasizes to use [formula]. However, the iterates φk fulfill ||φk||H  ≈  ||φε||H only when phases are separated and interfaces are present with thickness according to ε. In the first iterations this is in general not the case. Hence, it is more appropriate to adapt λ during the iterations. As a first approach we used the following updating strategy: Set [formula] and choose some 0 <  < 1, in the following set λk  =  λk - 1  /   if αk - 1 = 1 and λk  =  λk - 1 else. The changes in λ with respect to the iterations can be seen examplarily in Figure [\ref=lamm], where underneath the evolution of the phases can be seen. We remark that this is no line search with respect to λ. In the following algorithm we outline one iteration step and indicate with it the cost of the method.

Numerical experiments

The numerical experiments which underline the above statements are for the cantilever beam in two dimensions and with one material and void. The design domain is Ω  =  ( - 1,1)  ×  (0,1) and α  =  1. There is no volume force but a boundary force [formula] is acting on Γg  =  (0.75,1)  ×  {0}. The Dirichlet part is ΓD  =  { - 1}  ×  (0,1). For the stiffness tensor of the material we take [formula] with Lamé constants μ  =  λ = 5000. Moreover we use the constant γ  =  0.5 and prescribe the masses by 50% material and 50% void. Figure [\ref=clbeam] displays the setting and the result for ε  =  0.03.

All computations are done using the finite element toolbox FEniCS [\cite=LoggMardalEtAl2012a]. So far we only use equidistant meshes. The elasticity equation is discretized with P1-finite elements and the arising linear systems are solved directly. In the computations with one material the problem setting is reduced to one phase field only by working with φ: = φ2  -  φ1. In Figure [\ref=scaling] the upper five lines correspond to the results without scaling the gradient and shows the approximated error in the cost functional with respect to the iteration numbers. We clearly see a dependency on ε. The lower five lines correspond to the results with scaling and are nearly not distinguishable, independent of ε and lead to much better approximations for a lower number of iteration. In Figure [\ref=tens] the influence of the choice of the linear versus the quadratic interpolation of the stiffness tensor is depicted for ε  =  0.04.

In Table [\ref=comp] we study the dependency on the mesh size h and compare the approaches without scaled gradient and with linear interpolation of the elasticity tensors (called old in the table) to the approach using the scaled gradient and the quadratic interpolated elasticity tensor (called new in the table). In the last column we listed the result for the latter approach but using in addition nested iteration, i.e. using the result of the previous h as initial data for the next and solving with an decreasing tolerance tol. This leads to the expected speed up, here the nested approach needs roughly 15% of the CPU-time of the new approach. The more severe speed up of the old approach is obtained by the new ansatz, which leads to a reduction to 0.5% of the corresponding CPU-time of the old approach. Nevertheless, in any case the expected mesh independent number of iterations is confirmed. We do not list but would like to mention that in the above example the number of line search iterations stay also mesh independent and are between 1 and 3. The number of PDAS iterations are mildly mesh dependent but stay below 10 after the first few iterations.

As expected we can obtain different local minima if we start with different initial data as can be seen in Figure [\ref=locmin] for a cantilever beam with two materials and void. The first column shows the result where the initial data is a constant mixture of materials and void, the second started with separated material distribution and the third with random data. The last yields the lowest value of the cost functional.

The following three Figures [\ref=fig:longbeam]-[\ref=fig:Fig2] illustrate some results for a long cantilever beam with one material, for a case with three materials and void and an example for a cantilever beam in 3d with one material.

Numerical results for a compliant mechanism

In this section we present a compliant mechanism simulation, in particular we set α = 0 in (Pε). The configuration we consider is depicted in Figure [\ref=push_pic], where zero Dirichlet boundary conditions are posed on the left and right boundaries at the top and bottom and horizontal forces are applied at sections along the left and right boundaries.

In order to solve the gradient inequality (GI) in Theorem [\ref=OPTSYS], we use here as a first numerical approach a classical L2-gradient flow dynamic for the reduced cost functional. The gradient flow yields the following parabolic variational inequality for all [formula] and all t > 0:

[formula]

In addition, [formula] and [formula] have to solve the state equation (SE) and the adjoint equation (AE), see Theorem [\ref=OPTSYS]. The constraints φN = 0 on S0 and φN = 1 on S1 can be easily incorporated by imposing these conditions when a mesh point lies in [formula]. We replace [formula] in ([\ref=eq:gf]) by a time discrete approximation which corresponds to a pseudo time stepping approach. We then discretize the resulting inequality, the state equation (SE) and the adjoint equation (AE) using standard finite element approximations, see [\cite=our].

In the computation we present we take the weighting factor c = 2000 in Ω: = ( - 1,1)  ×  ( - 1,1) and [formula]. We set [formula] and [formula] with [formula]. We take [formula] on Γg± and [formula]. Since we wish to have material adjacent to the parts of the boundary that are fixed and where the forces are applied we set [formula]. We take N = 3 and use an isotropic elasticity tensor [formula] of the form [formula] with λ1  =  μ1 = 10 and we choose [formula] and [formula] in the void. The interfacial parameters we use are [formula] and γ  =  0.2 and we set β = 10. In addition, we choose the masses [formula].

In the Figure [\ref=push_rid] we display the optimized configuration (left hand plot) and the deformed optimal configuration together with the outline of the initial geometry (right hand plot), here hard material is shown in red and soft material in green. In Figure [\ref=push_rid_dsp] we display the displacement vector [formula].