A Bayesian approach to accounting for variability in mechanical properties in biomaterials

Introduction

Several continuum mechanics models have been proposed to characterize and predict the mechanical response of biomaterials such as blood vessels, the heart and bones [\cite=mollica_modeling_2007] [\cite=humphrey_cardiovascular_2002] [\cite=fung_biomechanics:_1993] [\cite=holzapfel_mechanics_2006]. The major challenge in the use of such models is to identify the model parameters to match experimental data. Conventionally, the least squares approach has been used to identify such model parameters. Unlike metallic/manufactured materials, it is not possible to enforce control in composition, the size and shape of test specimens when considering biomaterials. Neither is it possible to test a large number of samples of closely matching characteristics. Indeed, the variance observed in experiments across different samples reflects this lack of control (see, for example, the data reported in [\cite=van_andel_mechanical_2003] [\cite=vande_geest_effects_2006] [\cite=garcia-herrera_mechanical_2012] [\cite=carboni_passive_2007] [\cite=holzapfel_determination_2005]). Furthermore, the quality of available experimental data also limits the ability of models in accurately representing and predicting the behavior of biomaterials, i.e. there is substantial epistemic uncertainty in the models. Nevertheless such models are useful in characterizing the behavior of such materials. Given the uncertainties both due to lack of a perfect model as well as those due to the experiments and specimens, we propose to replace a deterministic idea of model parameters with a probability distribution for the model parameters. Before we proceed, we observe that a given continuum model with unknown parameters represents a parametrized class of models. Our approach is to characterize groups of samples as probability distributions on the space of model parameters. This poses two key questions that we seek to answer, especially with regards to nonlinear models. For example,

Given sample data and a putative model with certain model parameters, how does one find a probability distribution for model parameters? If one treats model parameters as being deterministic values, this question can be answered very easily by means of a least squares fit. However, such an approach may not represent any of the samples, nor does it capture the variability that is inherent in the samples.

When new samples are provided, how does one determine whether this sample belongs to the same model class as before or is it different? This is a fundamental question that needs to be answered in all diagnostic activities.

We answer these questions by a systematic use of a Bayesian inference approach to both questions (1) and (2). We will illustrate the approach by considering data for arteries reported in [\cite=paul_andersohn_modeling_2013]. The Bayesian approach utilized here also circumvents issues of non-uniqueness in least squares estimates (see [\cite=ogden_fitting_2004] for a discussion on non-uniqueness in least squares estimates for hyperelastic models). The method presented here comes with a cost however. Calculating probability distributions on parameter spaces requires the repeated solution of boundary value problems for different values of parameters as part of Markov Chain Monte Carlo scheme for sampling a probability distribution. Hence, the availability of exact solutions is of vital importance in carrying out efficient simulations.

Key results from this approach

We provide a methodology that allows us to find probability distributions for model parameters from experimental data. The results of the application of this approach to the characterization of sheep arteries based on cylindrical inflation data, shows the efficacy of the approach in identifying likely ranges of parameters.

We present a novel way of calculating the pressure vs. radius response, without the use of specific constitutive equations and the momentum balance equations. Instead, the pressure vs. radius response is obtained by a minimization process that allows us to postpone the choice of a specific constitutive equation. We are thus able to quickly and efficiently obtain the model predictions for both isotropic and orthotropic materials without having to re-solve a boundary value problem.

We also provide a methodology for probabilistic classification of samples that can be used to answer the question: What is the probability that a particular sample belongs to a particular model class? The results also highlight the importance of proper priors on the model parameters.

Organization of the paper

The paper is organized into the following 5 sections. Section [\eqref=sec:Experimental-Data] deals with the data from cylindrical inflation of sheep aorta samples. Section [\ref=sec:Model-for-artery] details the solution of the artery inflation problem based on the assumption that the response can be characterized by using an homogeneous, incompressible, hyperelastic, isotropic solid. An analytical solution is obtained for different nonlinear models, all of which are represented by two parameters. Thus we seek probability distributions over a two dimensional parameter space for each of these models. Section [\ref=sec:Probabilistic-Framework] introduces the Bayesian probabilistic framework used for obtaining the model parameter probability distributions. Section [\ref=sec:Results-and-Discussion] lists the details of the algorithm and simulations performed in order to obtain the probability distribution. Section [\ref=sec:Using-model-parameter] demonstrates how the probability that is obtained from the "training" data can be used to classify "new" measurements.

Experimental Data

The experiments used for demonstrating the classification algorithm presented in this work were recently conducted [\cite=paul_andersohn_modeling_2013] at Texas A&M University. Three inflation experiments were performed on 5 samples of sheep aorta at the axial stretch corresponding to in vivo axial stretch. The details of the experimental protocol can be found in[\cite=paul_andersohn_modeling_2013]. The data was reported as applied pressure (in mmHg) vs. volume (in mL). This data was reduced to pressure vs. internal radius (in mm). The data, in the reduced form is shown in figure [\ref=fig:Inflation-experimental-data]. The data reveals considerable amount of spread even in such controlled samples. Furthermore, a close look at the figure reveals that there appears to be two different responses among the samples. We will later use this preliminary observation as the basis for the classification problem in section[\ref=sec:Using-model-parameter] .

Model for artery inflation

For the purposes of this work the artery is modeled as a thick-walled tube made of a homogeneous, incompressible, and hyperelastic material. This choice is motivated by the fact that the exact geometry of the arteries that were tested is not reported, and furthermore the data is presented as (section [\eqref=sec:Experimental-Data]) the applied pressure vs. internal volume (and reduced to pressure vs. internal radius). The model that we develop is motivated towards obtaining the model predictions of the applied pressure [formula] as a function of the internal radius ri and the model parameters [formula] of the strain energy chosen. The problem statement for the inflation problem and the solution technique used for the solving this problem are explained below.

Problem statement

Consider a thick walled cylinder B that occupies the reference configuration kr(B) which in polar coordinates is represented by the region

[formula]

Let [formula] denote the position vector of a typical particle in the body. At time t, the body occupies a configuration kt(B) such that position of the same particle is now [formula]. The motion of the body can be described using the function [formula]

[formula]

The deformation gradient [formula] and the right Cauchy-Green stretch tensor are given respectively by

[formula]

Consider the inflation of this annular region under an applied pressure on the internal surface R = A. Under this applied pressure, the deformation of the cylinder is given by

[formula]

where it is assumed that the current radius of the cylinder is independent of θ and z.

Constitutive relation

For the deformation as stated in [\eqref=eq:Deformation] the components of the deformation gradient in polar coordinates is given by

[formula]

Enforcing the incompressibilty constraint in the form [formula], we obtain the well-known result,

[formula]

The function f(R) contains one constant of integration, c. Traditionally this constant is evaluated by using information from the geometry in reference and current configurations (e.g. [formula]). We will depart from this approach, and retain this constant of integration c. Note that the constant c controls the inflated radius of the cylinder and is consequently a function of the applied pressure.

For future reference, the principal stretches for this deformation are given by

and the invariants [formula] of the right Cauchy-Green stretch tensor are given as

In order to obtain a relationship between the applied pressure and the constant c we employ a strategy, that allows us to obtain a general expression without the necessity for specifying the constitutive equation yet. We do this by noting that the solution to the elastostatics problem, is an extremum of the total potential energy of the system. In other words, the principle of minimum potential energy states that admissible deformations are those that render the potential energy functional to be a extremum.

For the problem under consideration, the potential energy ψ is,

[formula]

[formula]

where W is the strain energy , P is the pressure applied to the surface R = A of the cylinder and ΔV is the change in volume enclosed by this surface.

Rewriting equation [\eqref=eq:PotentialEnergy],

[formula]

Since the strain energy is a function of the deformation gradient, which in this case is only a function of c, the integrand is a function of R and c only. Given that the experiments are all conducted at a constant axial stretch (λz = 1), the only variable in the above equation is c. Therefore, since the minimum of the potential energy is attained when the gradient is zero,

[formula]

Equation [\eqref=eq:PressureVsC] is the equation that relates the pressure p to the constant of integration c irrespective of the form of the strain energy function. The relation between the pressure and the (current) internal radius is sought since the data is also in this format. Since the relation between c and the internal radius is given by (with λz = 1)

[formula]

The above relation will allow us to calculate the relationship between the pressure and the internal radius as and when required. The specific form of equation [\eqref=eq:PressureVsC] depends on the choice of the strain energy function. In contrast to the approach presented in Ogden [\cite=ogden_non_1997] which is specific to isotropic materials, the result [\eqref=eq:PressureVsC] is valid for any form of the strain energy function, so long as the deformation gradient is acceptable. Thus we can use the expression [\eqref=eq:PressureVsC] for the case of an orthotropic material, as would be seen subsequently.

In the following section, three different strain energies will be used to get the corresponding pressure vs. c relations. Of these, the first two namely the power-law neo-Hookean model and the Ogden model are isotropic whereas the Criscione-type model is that for an orthotropic material.

Forms of constitutive relations for specific strain energies

The first model we choose for comparison with experimental data is the power-law neo-Hookean, which has been used in the literature for modeling biotissues (e.g. [\cite=raghavan_toward_2000]). The strain energy density for the incompressible power-law neo-Hookean model is given by

[formula]

where μ > 0 is the shear modulus and n is a positive number. Note that when n = 1, the strain energy reduces to that of neo-Hookean model. Substituting for W and [formula] in [\eqref=eq:PressureVsC] , we obtain the following equation for constant the pressure in terms of constant c, which in turn can be written in terms of the internal radius ri [\eqref=eq:ExprC].

[formula]

The model parameters for this strain energy are μ and n and we need to obtain a probability distribution on these two parameters.

The most widely implemented model in the computational literature for incompressible isotropic materials is the Ogden model. In our case, we will consider a two parameter Ogden model given by the strain energy density,

[formula]

where μ and α are material constants. The pressure vs. c relation using this strain energy is ,

[formula]

The above constitutive equations are based on assuming that the material is isotropic. On the other hand, there is compelling evidence to suggest that artery is orthotropic. However, conventional models of incompressible, orthotropic, hyperelastic materials, cannot be used to find parameters because they are a function of 6 variables that, for the cylinder inflation problem, vary with deformation. Thus, it is impossible to obtain any simple expression for the strain energy.

Recently however, Criscione [\cite=criscione_constitutive_2004] has a developed a modeling approach for orthotropic hyperelastic materials that considerably simplifies this problem by utilizing a set of non-polynomial invariants whose derivatives are almost transversal (see also [\cite=srinivasa_use_2012] in this regard). For the special case of cylindrical inflation Criscione has shown that it is possible to have an expression for the strain energy in which only one of the invariants varies with inflation thus allowing for the possibility of obtaining probability distributions for the parameters without full knowledge of the function.

The Criscione form of the strain energy function W(γ1,γ2,γ3,γ4,γ5,γ6) is a function of 6 strain invariants given by,

[formula]

where, J =  det   F, and φRZ, φΘZ, φΘR are the shear strains in the planes denoted by the corresponding subscripts.

Given the nature of the deformation, for the problem at hand, γ3 is the only nonzero attribute and so, the chosen form of W is

[formula]

The pressure, from [\eqref=eq:PressureVsC] is therefore,

[formula]

The model parameters in this model are a and b.

With the pressure p expressed as a function of the model parameters, the conventional approach to 'fit' the model to data would be to solve a non-linear least squares problem. In general, such an approach is not guaranteed to give a unique solution, because the cost function is not convex. Furthermore, no information about robustness of the solution can be obtained easily. We will depart from this approach and seek probability distributions for the reasons explained in section [\eqref=sec:Introduction].

Probabilistic Framework - Bayesian Inference

Bayesian inference is the method of using the Bayes' rule to update the state of information using observations. The state of information before the observations were made is known as the prior and the updated state of information is known as the posterior. The following notation is used in the remainder of the section: let [formula] be the vector of measured pressure values corresponding to the vector of internal radius values [formula]. Let [formula] be the vector of model predictions corresponding to [formula] as a function of the model parameters [formula]. We are interested in computing the probability distribution [formula]), i.e. the probability distribution on the model parameters [formula] given the data [formula].

Probability distribution of model parameters

As mentioned in the previous section, the classification problem requires the computation of the probability distribution of the model parameters for each of the classes. As mentioned in section [\ref=sec:Experimental-Data] the data is reported as pressure, [formula] vs internal radius [formula]. The probability distribution of the parameters [formula] , given the observations [formula] is computed using Bayes' rule:

[formula]

The prior probability distribution for the parameters [formula] may be chosen according to any available prior information on the value of the parameters. If there is no distinguishing prior information, then a non-informative prior may be chosen so as to not bias the inference process. For the work presented in this paper, a non-informative prior is assumed, resulting in this case a uniform distribution for [formula].

A standard way of choosing a likelihood function is to assume that it is a Gaussian distribution on the errors which are assumed to be uncorrelated. However, a careful look at the experimental data shows, that the deviations from the model are correlated deviations. Furthermore, we expect the model to capture not only the trend in the pressure, but also the trend in the derivative of the pressure with respect to the radius, since the latter is a measure of local wave speeds in the tissue. Since wave speeds are critical [\cite=gosling_terminology_2003] to inference problems based on elastography, it is important to represent the wave speeds accurately also in the model. To this end, let [formula] be the model prediction for parameter vector [formula], the absolute error between the data and the model is given by [formula]. The error between the tangent stiffnesses in the model and the data is given by [formula] where [formula] refers to the ith data point. The likelihood function proposed is given as

[formula]

where [formula] is the precision associated with the errors and β is the factor the controls the precision of the error in slope relative to the absolute error. The precision is inversely related to the tolerance in difference between model and data, i.e. lower tolerance for errors ⇒   higher precision.

Posterior distributions - Markov Chain Monte Carlo sampling

Thus our task becomes one of computing [formula] from equation [\eqref=eq:BayesRule_modelParams] given that the numerator on the right hand side is equation [\eqref=eq:LikelihoodFormAssumption].

The denominator of equation [\eqref=eq:BayesRule_modelParams] is known as the probability of the evidence, and is given by

[formula]

Since this integral is typically very hard to compute, we will use a Monte Carlo algorithm to compute the posterior distribution, without having to explicitly compute the above integral. The algorithm used is known as the Metropolis-Hastings algorithm [\cite=metropolis_equation_1953] [\cite=hastings_monte_1970] [\cite=gilks_markov_1995]which is used to compute the posterior distribution [formula] and is described in algorithm [\eqref=alg:MHalgo]. Further details of this algorithm may be found in [\cite=gilks_markov_1995].

Results

The probability distribution of the model parameters are presented for a subset of the data that is shown in figure [\ref=fig:Inflation-experimental-data]. This choice is in order to demonstrate an application of the probability distributions to a classification problem. Towards this, the samples are grouped into two classes - samples 1,2 and 3 into class C1 and samples 4 and 5 into class C2. For each of the classes, the data [formula] is chosen as two of the three experiments per sample. Therefore, for class C1, [formula] is the set of six experiments (shown in figure [\ref=fig:ExpData_Classes] (a)) and for class C2, [formula] is the set of four experiments (shown in figure [\ref=fig:ExpData_Classes](b)). The probability distribution for the parameters for the two classes corresponding to each of the strain energy functions from section [\eqref=sub:Forms-of-constitutive] are shown in figure [\ref=fig:ModelParams_ProbDist].

A cursory inspection of the probability distributions show that the regions of the parameter space with high probability are not the same for the two classes. Qualitatively, this observation shows that the two classes that we considered are 'different'. Indeed, a quantitative measure of this difference, as mentioned earlier, could be obtained by computing a distance such as the K-L divergence, between the probability distributions.

Another noteworthy feature in the model parameter probability distributions in figure [\ref=fig:ModelParams_ProbDist] is that, for the Ogden model and the Criscione-type model, the probability distributions are bimodal. For the Ogden model, this is due to the fact that in equation [\ref=eq:OgdenModel], the strain energy is symmetric with respect to the sign of the exponent parameter α. It can be seen that this symmetry is reflected in the two modes in each of the contour plots in figure [\ref=fig:ModelParams_ProbDist] (c) and (d). Similarly, for the Criscione-type model, the modes are due to the hyperbolic cosine function in the strain energy, since cosh  is an even function. This is reflected in the symmetry in parameter b in figure [\ref=fig:ModelParams_ProbDist] (e) and (f).[formula]

Thus, the experimental data is susceptible to two groups of explanations, given the particular choice of Ogden and Criscione-type models.

Using model parameter distributions for classification

An interesting application of the probability distributions for the model parameters is for classification problems. The techniques used for classification are typically of two types: deterministic or probabilistic. Deterministic algorithms describe hard boundaries between groups of observations, thus dividing the entire set of observations into clearly structured groups. Examples of such techniques are hypothesis testing, k -means clustering and computing separating hyperplanes using support vector machines. On the other hand, probabilistic algorithms relax such hard boundaries and instead assign the probability that a particular observation belonging to a certain class. Probabilistic techniques thus utilize a "fuzzy" classification approach. Examples of probabilistic algorithms for classification include logistic regression [\cite=hosmer_applied_2013] and neural networks [\cite=zhang_neural_2000]. Probabilistic classification allows for naturally incorporating any uncertainty thus allowing for making decision only if sufficiently confident. This feature is especially critical in medical applications and thus probabilistic techniques have been the favored approach for applications in medical diagnosis [\cite=croft_mathematical_1974] [\cite=kononenko_machine_2001] [\cite=ledley_reasoning_1959] [\cite=szolovits_categorical_1978] [\cite=warner_hr_mathematical_1961].

The Bayesian framework naturally allows for assigning probabilities to each of the classes considered using the probability distributions computed earlier in this paper. Classifying the data not used as part of [formula] into classes C1 and C2 (see figure [\ref=fig:ExpData_Classes]) is demonstrated as an example of the approach.

Class membership probabilities

Let classes [formula] be classes into which a newly obtained data set [formula] is to be classified. The classes Ci are each associated with a probability distribution for the model parameter [formula], [formula]. The probability distributions [formula] are obtained through a Bayesian inference procedure on the training data [formula] (see section [\ref=sub:Probability-distribution-of]).

For the classification problem, given a newly obtained data set [formula], the probability that it belongs to a class Ci, [formula] can be computed using the Bayes' rule as,

[formula]

In equation [\ref=eq:BayesRule_classification], the probability on the left hand side [formula] is the posterior probability, [formula] is called the likelihood function and P(Ci) is the prior probability.

The likelihood, [formula] is also known as the marginal likelihood due to the marginalization of [formula] over the parameter space [formula] (i.e.)

[formula]

where, [formula] is the likelihood associated with observing the data [formula] given that the model parameters are [formula] (which is the same as in equation [\eqref=eq:LikelihoodFormAssumption]) and [formula] is the probability distribution on the parameter [formula] associated with the class Ci.

Equation [\ref=eq:BayesRule_classification]

[formula]

Figure [\ref=fig:ClassProb_Hist] shows the results of this classification applied to the data set shown in figure [\ref=fig:NewData_Classes].

Summary

We have developed a method for representing the response of biomaterials in which the model parameters are themselves considered as probability distributions. This approach treats the distribution of responses of nominally similar biomaterials as a feature and not as something that can be eliminated by careful control of experiments. By a systematic use of Bayesian inference, the approach can be extended to situations in which model parameter distributions can be improved as and when more data is available. In other words, the approach allows the modeler to "learn" more about the parameters as additional data becomes available. Furthermore, we have also presented a new method for model based classification of data based on parameters that were obtained from training data.