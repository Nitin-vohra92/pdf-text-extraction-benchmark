Remark

A Hermite interpolatory subdivision scheme for C2-quintics on the Powell-Sabin 12-split

Introduction

For approximating functions on a given domain, a popular method is to triangulate the domain and consider an approximation in a space S of piece-wise polynomials over the triangulation. It is a hard problem to find a basis B of S that has all the usual properties of the univariate B-splines.

One desired property of B is that it is local, meaning that each spline in B has local support. One way to construct such a local basis is to first split each triangle into several subtriangles, and then construct a basis on the refined triangulation.

A popular split is the Powell-Sabin 12-split [\cite=Powell.Sabin77]; see Figure [\ref=fig:PS12-Labels12] and Section [\ref=sec:macroelement]. While the 12-split splits the triangle in a relatively large number of subtriangles, a major advantage over other well-known splits stems from the following property [\cite=Oswald92] [\cite=DynLyche98]. Let be given a triangle [figure][scale  =  0.3,bb   =   583933], its 12-split [figure][scale  =  0.3,bb   =   583933], and the split [figure][scale  =  0.3,bb   =   583933], where we subdivided [figure][scale  =  0.3,bb   =   583933] into four subtriangles by connecting the midpoints of the edges. If we replace each subtriangle in [figure][scale  =  0.3,bb   =   583933] by its 12-split, the space of splines over the resulting split contains the space of splines over [figure][scale  =  0.3,bb   =   583933]. This refinability property makes the 12-split suitable for multiresolution analysis.

Recently, a simplex spline basis for the C1-quadratics on the 12-split with all the usual properties of the univariate B-spline basis was discovered [\cite=Cohen.Lyche.Riesenfeld13]. Powell and Sabin originally constructed a nodal basis (see Section [\ref=sec:BernsteinBezier]) on the 12-split, which can be used to represent C1-smooth quadratic splines over arbitrary triangulations. Schumaker and Sorokina viewed the space of C1-quadratics on the 12-split as the first entry in a sequence of spline spaces of increasing smoothness and degree [\cite=Schumaker.Sorokina06]. The second entry is a space of C2-quintics, with C3-supersmoothness at the vertices and midpoints and satisfying some additional C3-conditions of type [\eqref=eq:smoothnessconditions] along some of the interior edges. On a single triangle this space has dimension 42, and the authors constructed a nodal macro-element for this space; see Figure [\ref=fig:PS12-0].

For a recent and similar construction see [\cite=Davydov.Yeo13]. A family of smooth spline spaces on the 6-split and corresponding normalized bases were presented in [\cite=Speleers13]. For other refinable C1-quadratic elements on 6-splits see [\cite=D.L.M.S:S00] [\cite=Maes.Bultheel06] and [\cite=Jia.Liu08]. In the latter a combination of 6- and 12-splits is used. For the FVS C1-cubic quadrangular macro element see [\cite=Davydov.Stevenson05] [\cite=Hong.Schumaker04], and for a survey of refinable multivariate spline functions see [\cite=Goodman.Hardin06].

The next section reviews some standard Bernstein-Bézier techniques. Section [\ref=sec:macroelement] introduces a new macro-element space for C2-quintics, with complete C3-smoothness within each macrotriangle and dimension only 39; see Figure [\ref=fig:PS12-1]. In the following two sections a Hermite subdivision scheme is derived, implemented, and tested in the computer algebra system Sage. The final section concludes the paper.

Bernstein-Bézier techniques

We follow the notation from [\cite=Lai.Schumaker07]. Any point [formula] in a nondegenerate triangle [formula] can be represented by its barycentric coordinates (b1,b2,b3), which are uniquely defined by [formula] and b1  +  b2  +  b3  =  1. Similarly, each vector [formula] is uniquely described by its directional coordinates, i.e., the triple (b1  -  b1',b2  -  b2',b3  -  b3') with (b1,b2,b3) and (b1',b2',b3') the barycentric coordinates of two points [formula] and [formula] such that [formula].

A polynomial p of degree d defined on T is conveniently represented by its Bézier form

[formula]

where the Bdijk are referred to as the Bernstein basis polynomials of degree d and the cijk are called the B-coefficients of p. We associate each B-coefficient cijk to the domain point [formula]. The disk of radius m around [formula] is [formula], and similarly for the other vertices.

For any differentiable function [formula] and a vector [formula] (not necessarily of unit length), we write

[formula]

for the directional derivative of f along [formula] at [formula]. If, more generally, f is k-times differentiable for some integer k  ≥  1, then, for any set of vectors [formula], we write

[formula]

for the k-th order directional derivative in the directions [formula] of f, and [formula] for its point evaluation at [formula]. We write

[formula]

if [formula]. We shall make use of the short-hand

[formula]

For any triangle [formula] there are some natural directions along which to consider directional derivatives. To any edge [formula] opposing the vertex [formula], one associates the inward unit normal vector [formula], tangential vector [formula] and the medial vector [formula]; see Figure [\ref=fig:PS12-LabelsVectors]. Since [formula] and [formula] are orthogonal,

[formula]

The corresponding directional derivatives obey similar relations.

A linear functional [formula] is called nodal if it maps any spline to a linear combination of values and derivatives at a given point called the carrier of λ. A set Λ of nodal functionals is called a nodal determining set for a spline space S, if λs  =  0 for all λ∈Λ implies [formula]. If there is no smaller nodal determining set, Λ is called minimal. We call S a macro-element space provided that there is a nodal minimal determining set Λ for S such that for each triangle T in the triangulation [figure][scale  =  0.3,bb   =   583933], s|T is uniquely determined from the values {λs}λ∈ΛT, with ΛT  ⊂  Λ the functionals with carrier in T. In this case Λ is a basis for the dual space of S, and the dual basis to Λ is called a nodal basis of S. The functionals in Λ are called degrees of freedom.

Suppose that [formula] and [formula] are triangles sharing the edge [formula], and let

[formula]

be polynomials defined on these triangles, where {Bijk} and {ijk} are the Bernstein basis polynomials associated with T and T̃, respectively. Imposing a smooth join of p and p̃ along e translates into the linear relations among the B-coefficients presented in the following theorem.

Suppose [formula] is any direction not parallel to e. Then

[formula]

if and only if

[formula]

where b1,b2,b3 are the barycentric coordinates of 1 with respect to T. Moreover, if [formula] are collinear then [\eqref=eq:smoothnessconditions] takes the form

[formula]

which can also be written

[formula]

where [formula] is the usual nth order forward difference of [formula], eν = cν,j,k + n - ν, and ẽν  =  n - ν,j,k + ν, [formula].

The equivalence of [\eqref=eq:smoothnessconditions0] and [\eqref=eq:smoothnessconditions] follows from [\cite=Lai.Schumaker07] by switching the order of the vertices [formula] and [formula] in T̃. If [formula] are collinear, then b2 = 0 and all terms with μ > 0 in [\eqref=eq:smoothnessconditions] are zero. We obtain [\eqref=eq:smoothnessconditions1] with b3 = 1 - b1. It can be shown by induction on n that [\eqref=eq:smoothnessconditions2] follows from [\eqref=eq:smoothnessconditions1]. Alternatively it follows from univariate Bernstein-Bézier theory.

Let us illustrate this theorem with several examples that will be used in the proof of Theorem [\ref=thm:Macro-Element12].

Let [formula] and [formula] as in Figure [\ref=fig:PS12-Labels12]. Then [formula] has barycentric coordinates [formula] with respect to T, and the coefficients in [\eqref=eq:smoothnessconditions] are, for n  =  1,2,3 and j  =  0, shown in Figure [\ref=fig:bivariateC1]-[\ref=fig:bivariateC3].

See Figure [\ref=fig:univariate1], [\ref=fig:univariate2] for the coefficients in univariate C1-, C2-, and C3-conditions across the edges [formula], [formula], and see Figure [\ref=fig:univariate3] for the coefficients of a univariate C3-condition along the line segment [formula]. We can use either [\eqref=eq:smoothnessconditions1] or [\eqref=eq:smoothnessconditions2] to show this. We use [\eqref=eq:smoothnessconditions2] with [formula] for (d) and [formula] for (f). For (e) we use [\eqref=eq:smoothnessconditions1] with b1 =  - 1 / 3.

Imposed values of the degrees of freedom translate into the linear relations among the B-coefficients presented in the following theorem; see e.g. [\cite=Lai.Schumaker07].

Let 1  ≤  m  ≤  d, and suppose we are given, for [formula], a vector [formula] with directional coordinates [formula]. Then

[formula]

where c(0)ijk  =  cijk and

[formula]

As a consequence, for any r  ≤  d, specifying all derivatives up to order r at some vertex [formula] is equivalent to specifying the B-coefficients in the disk [formula] [\cite=Lai.Schumaker07].

Macro-elements on Powell-Sabin splits

For the purpose of constructing approximations by piecewise quadratics, Powell and Sabin introduced two methods to split each triangle in a triangulation [figure][scale  =  0.3,bb   =   583933] [\cite=Powell.Sabin77]. For the first of these, one considers a new vertex [formula] in the interior of each triangle [formula] in such a way that, for any triangles T,T̃ sharing an edge e, the line segment [formula] intersects e in a new point [formula]. For any edge e on the boundary, one writes [formula] for the midpoint of e. Inserting, for any edge e and vertex [formula] of a triangle T, the new vertices [formula], [formula] and edges [formula] into Δ, one arrives at a refined triangulation [figure][scale  =  0.3,bb   =   583933] known as the Powell-Sabin 6-split of T; see Figure [\ref=fig:PS12-Labels6].

How should one choose the points [formula] so that each [formula] is well defined? If all triangles are acute one can choose [formula] to be the circumcenter of T, and in general one can choose [formula] to be the incenter of T [\cite=Lai.Schumaker03]. Alternatively, one can take the barycenter [formula] of each triangle T, but this is only possible if the line-segment joining the barycenters of two adjacent triangles intersect the common edge. Alfeld and Schumaker [\cite=Alfeld.Schumaker02] avoid this geometric constraint by, for any edge e shared by two adjacent triangles T,T̃, choosing [formula] freely, no longer requiring [formula] to be collinear. This has the additional advantage that the choice of [formula] no longer affects the geometry of the split in any neighbouring macrotriangle.

The latter advantage is shared by the second split introduced by Powell and Sabin, which is constructed as follows. Given a triangle [formula], write [formula], [formula], and [formula] for its edges. The midpoint of any edge [formula] is the average [formula] of its endpoints, and its quarterpoints are the averages [formula] and [formula] of the midpoint with the endpoints. We construct a 6-split by inserting a vertex [formula] at the barycenter, which we connect to the old vertices and the midpoints. Connecting the midpoints we arrive at the Powell-Sabin 12-split of T; see Figure [\ref=fig:PS12-Labels12].

Let [figure][scale  =  0.3,bb   =   583933] be a triangulation of some domain [formula]. Replacing every triangle in [figure][scale  =  0.3,bb   =   583933] by a 6-split (resp. 12-split) results in a finer triangulation [figure][scale  =  0.3,bb   =   583933] (resp. [figure][scale  =  0.3,bb   =   583933]). We write S6 (resp. S12) for the space of piecewise quintic polynomials with global C2-smoothness on [figure][scale  =  0.3,bb   =   583933] (resp. [figure][scale  =  0.3,bb   =   583933]) and C3-smoothness on each macrotriangle in [figure][scale  =  0.3,bb   =   583933]. We consider a set Λ6 of functionals on S6, comprising point evaluations and partial derivatives up to order three at any vertex v of [figure][scale  =  0.3,bb   =   583933]. We also consider the superset Λ12  ⊃  Λ6 of functionals on S12  ⊃  S6, which in addition contains, for each edge e in [figure][scale  =  0.3,bb   =   583933], a first-order cross-boundary derivative at the midpoint and a second-order cross-boundary derivative at each quarter point; see Figure [\ref=fig:PS12-1].

On a single triangle, one has dim (S12)  =  39 and dim (S6)  =  30, matching the cardinalities of Λ12 and Λ6. This can be computed numerically using a JAVA applet written by Peter Alfeld described in [\cite=Alfeld00] and available at §http://www.math.utah.edu/ pa/MDS/§. The dimension of the 6-split follows immediately from an "interior cell formula" [\cite=Lai.Schumaker07], while the dimension of the 12-split follows from a formula for the dimension for general degree d and smoothness r, which we plan on reporting elsewhere.

In Section [\ref=sec:subdivision] we derive a Hermite subdivision scheme for computing any spline s∈S12 from the initial data

[formula]

Along any edge e in Δ, a third-order cross-boundary derivative at the midpoint [formula] cannot be determined from just the functionals along e, as this would imply global C3-smoothness of s. Since any spline s∈S12 has global C2-smoothness and C3-smoothness within each macrotriangle, the subdivision rules for the other derivatives at [formula] can only involve initial data along e.

The following theorem shows that any spline s∈S12 is uniquely determined from the initial data [\eqref=eq:InitialData12].

The set Λ12 forms a nodal minimal determining set for S12.

For any vertex [formula] of [figure][scale  =  0.3,bb   =   583933], the derivatives up to order three at [formula] determine the disk [formula]. Along each edge [formula] of [figure][scale  =  0.3,bb   =   583933], we therefore know the initial and final four B-coefficients. Therefore, since the space of C3-smooth quintic univariate splines along e has dimension 8, the restriction of s to e is determined. Thus the nodal data at the corners determine the B-coefficients marked [formula] in Figure [\ref=fig:Proof-MDS12].

Let [formula] and [formula] be the medial and tangential directions associated to e. Since the space of C2-smooth quartic univariate splines along e has dimension 7, the restriction of the cross-boundary derivative [formula] to e is determined by its value at the mid-point [formula] and the 3 degrees of freedom [formula] at the corners [formula]. Specifying, in addition, a first-order cross-boundary derivative at each midpoint therefore determines the B-coefficients marked [formula] in Figure [\ref=fig:Proof-MDS12].

Similarly, since the space of C1-smooth cubic univariate splines along e has dimension 6, the restriction of [formula] to e is determined by its value at the 2 quarterpoints of e and the 2 degrees of freedom [formula] at the corners [formula]. Specifying second-order cross-boundary derivatives at the quarterpoints therefore determines the B-coefficients marked [formula] in Figure [\ref=fig:Proof-MDS12].

In order to show that these 39 conditions are independent, we need to determine the remaining B-coefficients from the smoothness conditions. For instance, using the smoothness conditions with coefficients shown in Figure [\ref=fig:univariate1], one determines the B-coefficients marked [formula] in Figure [\ref=fig:Proof-MDS12].

Let us refer to the coefficients thus far as known. The remaining unknown coefficients are numbered [formula] as in Figure [\ref=fig:Proof-MDS12]. By Theorem [\ref=thm:dirder], determining c1 is equivalent to determining a third-order cross-boundary derivative at the midpoint [formula]. By Remark [\ref=rem:C3], this derivative cannot be determined from only the initial data along the edge [formula]. For the time being, therefore, let us express [formula] in terms of c1,c2,c3 and the known coefficients, writing [formula] if a  -  b is a linear combination of known coefficients.

Using the univariate C3-condition from Figure [\ref=fig:univariate2] across the edge [formula], one expresses c4 in terms of c1. Similarly one expresses c8 in terms of c2. The univariate smoothness conditions from Figure [\ref=fig:univariate1] along [formula] determine the remaining B-coefficients c5,c6,c7 along this edge. Using the univariate smoothness conditions from Figure [\ref=fig:univariate2] across the edge [formula], and similar relations for [formula], one obtains

[formula]

Similar expressions hold for the other unknown B-coefficients outside of [formula]. Using the C1-condition from Figure [\ref=fig:bivariateC1] across [formula] (and similarly for [formula] and [formula]),

[formula]

and taking averages of these coefficients (as the C1-condition in Figure [\ref=fig:univariate1]),

[formula]

Using any C1-condition at [formula] (e.g. Figure [\ref=fig:bivariateC1]), we find [formula].

At this point all unknown B-coefficients are expressed in terms of c1,c2,c3. The univariate C3-condition along [formula] from Figure [\ref=fig:univariate3] (and similarly for [formula], [formula]) yield

[formula]

so that [formula]. Substituting [formula] in the C3-condition from Figure [\ref=fig:bivariateC3],

[formula]

determines the remaining degree of freedom c1 in terms of the known B-coefficients.

Finally, since the univariate splines [formula], and [formula] are determined from just the functionals along e, the values, first, and second derivatives of the splines on the adjacent triangles agree along e. It follows that Λ12 defines a spline s that is C2-smooth on [figure][scale  =  0.3,bb   =   583933] and C3-smooth on each macro-triangle in [figure][scale  =  0.3,bb   =   583933].

Similarly, any spline s∈S6 is uniquely determined from the initial data

[formula]

which follows from combining Theorem 2.18 and 7.9 in [\cite=Lai.Schumaker07]:

The set Λ6 forms a nodal minimal determining set for S6.

Derivation of a subdivision scheme

It has been observed by many (see e.g. [\cite=DynLyche98] [\cite=Oswald92]) that the geometry of the 12-split lends itself for subdivision into four subtriangles, namely [formula], [formula], [formula], and [formula] in Figure [\ref=fig:PS12-Labels12]. Each of these is (refinable to) a 6-split. Moreover, splitting the 6-split in Figure [\ref=fig:PS12-Labels6] into four subtriangles yields four new 6-splits, etc. Using this observation, one can derive a Hermite subdivision scheme to compute the C1-smooth quadratic splines from values and first derivatives at the corners and cross-boundary derivatives at the midpoints [\cite=DynLyche98].

In this section we derive a similar scheme for computing any spline s∈S12 from the initial data [\eqref=eq:InitialData12]. After computing the values and derivatives at the midpoints in the "initialization step" in Figure [\ref=fig:PS12-2], one obtains a refined description of s by repeatedly applying the "subdivision step" in Figure [\ref=fig:PS12-3].

For two adjacent triangles with common edge [formula], specifying cross-boundary derivatives in the normal direction [formula] at the midpoints and quarterpoints has the advantage of only depending on the common edge. However, since tangential derivatives at the midpoints and quarterpoints can easily be computed from the tangential derivatives at the corners [formula] (see [\eqref=eq:m-vs.-n] and the rules below), any other directional derivative can be computed by a simple change of basis.

To keep the rules as short as possible, we specify directional derivatives in the medial directions [formula] and tangential directions [formula]. Because the edges in the 12-split are divided at the midpoints, each of the four subdivided triangles in Figure [\ref=fig:PS12-3] will have the same tangential and medial vectors, albeit scaled by a factor [formula]. Thus directional derivatives computed on previous levels can be reused.

It follows from Theorem [\ref=thm:Macro-Element12] (resp. Theorem [\ref=thm:Macro-Element6]) that the B-coefficients of any spline in S12 (resp. S6) can be uniquely determined from the initial data [\eqref=eq:InitialData12] (resp. [\eqref=eq:InitialData6]). Moreover, Theorem [\ref=thm:dirder] implies that any directional derivative of any order of the spline at any point can be expressed in terms of the B-coefficients. It follows that there exist initialization rules and subdivision rules for evaluating the spline as described above. In the next two sections we derive these rules.

By Remark [\ref=rem:C3], the initialization and subdivision rule for the third-order cross-boundary derivative at the midpoint [formula] is expected to be complicated, involving functionals with carrier outside of e. Because of this, the formulas for the case of (locally) C3-quintics are considerably more complex than those for the C1-quadratics. As the computations are too large to carry out by hand, we made use of the computer algebra system Sage [\cite=Sage]. The resulting worksheet with implementation and examples can be downloaded from the website of the second author [\cite=WebsiteGeorg].

Initialization

On a single triangle [figure][scale  =  0.3,bb   =   583933], with the 252 unknown B-coefficients

[formula]

the initial conditions [\eqref=eq:InitialData12] and smoothness conditions [\eqref=eq:smoothnessconditions] for the 15 interior edges in [figure][scale  =  0.3,bb   =   583933] form a linear system with 39  +  15  ·  (6  +  5  +  4  +  3)  =  309 equations. By the linear independence of the functionals in Λ12, this system has a unique solution. Solving the system and applying Theorem [\ref=thm:dirder], we find initialization rules for computing the data in Figure [\ref=fig:PS12-2] from the initial data [\eqref=eq:InitialData12].

Given are, at the corners [formula], values and derivatives of f up to order three, first-order cross-boundary derivatives [formula] at the midpoints, and second-order cross-boundary derivatives

[formula]

at the quarter points as in Figure [\ref=fig:PS12-1]. With the short-hands [formula], and [\eqref=eq:shorthand], the value and derivatives at the midpoint [formula] are determined by the rules (see the worksheet)

[formula]

Note that only the third-order cross-boundary derivative [formula] involves functionals with carrier outside of [formula], as explained in Remark [\ref=rem:C3].

Subdivision

On a single triangle [figure][scale  =  0.3,bb   =   583933], with the 126 unknown B-coefficients

[formula]

the initial conditions [\eqref=eq:InitialData6] and smoothness conditions [\eqref=eq:smoothnessconditions] for the 6 interior edges in [figure][scale  =  0.3,bb   =   583933] form a linear system with 30  +  6  ·  (6  +  5  +  4  +  3)  =  138 equations. By the linear independence of the functionals in Λ6, this system has a unique solution. Solving the system and applying Theorem [\ref=thm:dirder], we find subdivision rules for computing the dashed data in Figure [\ref=fig:PS12-3] from the data in Figure [\ref=fig:PS12-2] (see the worksheet),

[formula]

Taking convex combinations of the rules for the C1-quadratic and C3-quintic schemes, one arrives at a family of Hermite interpolatory subdivision schemes. A general member of this family will produce limit functions that are not piecewise polynomial.

Implementation and experimentation

In this section we apply the scheme to compute some example splines in some example triangulations. For details we refer to the Sage worksheet.

Let [formula], with [formula], be the vertices of a regular hexagon centred at the origin [formula]. Consider the triangulation consisting of the triangles [formula], with [formula], and [formula]. We consider the spline on this triangulation defined by zero initial data in [\eqref=eq:InitialData12], except for the value 1 for the point evaluation at [formula].

After the initialization step, the first 5 iterations of the subdivision step are shown in the top row of Figure [\ref=fig:flatPhong]. However, in general we do not need this many iterations. Since the Hermite subdivision scheme also computes first derivatives, we know the surface normal at each vertex. Linearly interpolating these normals along each triangle and ray-tracing with a Phong shading model yields a seemingly flawless visualization after 2-3 iterations, while for flat shading 4-5 iterations are needed; see Figure [\ref=fig:flatPhong] for a comparison.

Consider the triangulation [figure][scale  =  0.3,bb   =   583933] with two triangles [formula] and [formula], with

[formula]

We consider the spline f∈S12 on this triangulation defined by zero initial data in [\eqref=eq:InitialData12], except for the value 1 for the point evaluation at [formula]. Since the Hermite scheme computes derivatives up to order three, it is easy to plot the third derivatives of f in Figure [\ref=fig:thirdderivatives]. Note that all third derivatives are continuous on [figure][scale  =  0.3,bb   =   583933], with the exception of the third-order cross-boundary derivative [formula], as expected.

Applying the scheme to data sampled from a random quintic polynomial on [figure][scale  =  0.3,bb   =   583933] reproduced this polynomial exactly in exact arithmetic, and up to machine accuracy in floating point arithmetic.

Conclusion and a final remark

We have introduced a nodal macro-element on the 12-split for the space of quintic splines that are locally C3 and globally C2. For quickly evaluating any such spline, a Hermite subdivision scheme is derived, implemented, and tested in the computer algebra system Sage. Using the available first derivatives for Phong shading, visually appealing plots can be generated after just a couple of refinements.

It would be natural to consider the macro-element introduced by Powell and Sabin and the macro-element in this paper as the first two entries in the following sequence. Let S2n - 1,n3n - 1 be the space of piecewise polynomials of degree 3n - 1 with global Cn-smoothness and C2n - 1-smoothness within each macro-triangle. We define a set Λn of functionals on S2n - 1,n3n - 1 as follows. For every vertex [formula] of [figure][scale  =  0.3,bb   =   583933], the set Λn contains point evaluations at [formula] of the spline and of its partial derivatives up to order 2n - 1. The remaining elements of Λn are, for each edge e in [figure][scale  =  0.3,bb   =   583933] and [formula], point evaluations of k cross-boundary derivatives of order k along e.

Although the cardinality of Λn matches dim S2n - 1,n3n - 1, which can be shown to be (15n2  +  9n) / 2, it unfortunately does not in general form a basis for the dual to S2n - 1,n3n - 1. The pattern breaks down first for n  =  3, for which S5,38 has dimension 81. While on each macro-triangle the 81 functionals in Λ3 are linearly independent in the space of C4-smooth octics, they are dependent in the space of C5-smooth octics, with corank three.

Acknowledgments

We wish to express our gratitude to the referees for their useful comments, which helped to improve the presentation of this paper. The second author was supported by a FRINATEK grant, project number 222335, from the Research Council of Norway.