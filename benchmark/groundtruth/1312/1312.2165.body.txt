Lemma Corollary Remark Conjecture

Estimating constellations among primes I - Uniformity

Introduction

We work with the prime numbers in ascending order, denoting the kth prime by pk. Accompanying the sequence of primes is the sequence of gaps between consecutive primes. We denote the gap between pk and pk + 1 by gk = pk + 1 - pk. These sequences begin

[formula]

A number d is the difference between prime numbers if there are two prime numbers, p and q, such that q - p = d. There are already many interesting results and open questions about differences between prime numbers; a seminal and inspirational work about differences between primes is Hardy and Littlewood's 1923 paper [\cite=HL].

A number g is a gap between prime numbers if it is the difference between consecutive primes; that is, p = pi and q = pi + 1 and q - p = g. Differences of length 2 or 4 are also gaps; so open questions like the Twin Prime Conjecture, that there are an infinite number of gaps gk = 2, can be formulated as questions about differences as well.

A constellation among primes [\cite=Riesel] is a sequence of consecutive gaps between prime numbers. Let [formula] be a sequence of k numbers. Then s is a constellation among primes if there exists a sequence of k + 1 consecutive prime numbers [formula] such that for each [formula], we have the gap pi + j - pi + j - 1 = aj. Equivalently, s is a constellation if for some i and all [formula], aj = gi + j.

We will write the constellations without marking a separation between single-digit gaps. For example, a constellation of 24 denotes a gap of gk = 2 followed immediately by a gap gk + 1 = 4. For the small primes we will consider explicitly, most of these gaps are single digits, and the separators introduce a lot of visual clutter. We use commas only to separate double-digit gaps in the cycle. For example, a constellation of 2,10,2 denotes a gap of 2 followed by a gap of 10, followed by another gap of 2.

In [\cite=FBHgaps] Holt introduced a recursion that works directly on the gaps among the generators in each stage of Eratosthenes sieve. These are the generators of Z mod p# in which p# is the product of the prime numbers up to p. For a constellation s, this recursion enables us to enumerate exactly how many copies of s occur in the kth stage of the sieve. We denote this number of copies of s as Ns(pk).

For example, after the primes 2, 3, and 5 and their multiples have been removed, we have the cycle of gaps G(5#)  =  64242462. This cycle of 8 gaps sums to 30. In this cycle, for the constellation s = 2, we have N2(5) = 3. For the constellation s = 242, we have N242(5) = 1. The cycle of gaps G(p#) has φ(p#) gaps that sum to p#.

In this paper we use the counts of constellations among the generators of Z mod p# to estimate the numbers of constellations that occur among prime numbers. For Z mod pk#, all the generators that lie between pk + 1 and p2k + 1 are actually prime numbers, so the corresponding constellations are actually constellations among prime numbers. For our estimates we assume uniform distributions of the various constellations in the cycle of gaps.

We make estimates for the single-gap constellations s = 2 (twin primes), s = 6, and s = 8. Our estimates exceed the true counts for these constellations by around 16% up to 1E + 12. Over this range, one of the estimates by Hardy and Littlewood [\cite=HL] for s = 2 underestimates the true counts for twin primes by around 8%. Regarding twin primes, we also make estimates for the constellations s = 242 (prime quadruplets [\cite=NicelyQuads]), s = 2,10,2, and s = 2,10,2,10,2. Finally, to explore arithmetic sequences of prime numbers, which have been visible in the recent work of Green and Tao [\cite=BGreen], we make estimates for s = 66 and s = 666. These correspond respectively to arithmetic progressions of three and four consecutive primes.

For the few constellations we have considered, our estimates appear to have the correct asymptotic behavior, but our estimates also seem to have a systematic error correlated with the number of gaps in the constellation. For a constellation s of j gaps, our estimates of how often s occurs as a constellation among prime numbers exceed the actual counts by approximately 9%  ×  (j + 1) when our computations reach 1.0E + 12.

The recursion itself is interesting, since it provides exact counts [\cite=FBHgaps] of constellations among the generators Z mod p#, as a representation of Eratosthenes sieve. In this paper, we use simple first-order statistics to make our estimates, and over the range of our computations, these estimates have the right asymptotic behavior. We believe that more sophisticated statistical models for the distributions of constellations in the cycle of gaps will produce more accurate estimates.

Related Results

There are of course several avenues of research into the distribution of primes. Much research into constellations has been motivated by two conjectures: the twin primes conjecture, and Hardy and Littlewood's broader k-tuple conjecture [\cite=HL] [\cite=Rib].

The twin primes conjecture asserts that the gap g = 2 occurs infinitely often. Work on this conjecture has included computer-based enumerations [\cite=IJ] [\cite=NicelyTwins] [\cite=PSZ] and investigations of Brun's constant [\cite=Sieves] [\cite=Riesel] [\cite=HL] [\cite=Rib]. Brun's constant is the sum of the reciprocals of twin primes. This series is known to converge, and the sharpest current estimate [\cite=Rib] is 1.902160577783278. One generalization of the twin primes conjecture is a conjecture by Polignac from 1849 [\cite=Rib] that for every even positive integer N there are an infinite number of gaps gk = N.

Most estimates for sequences of differences, e.g. [\cite=HL] [\cite=MV], are derived by treating probabilities on residues as independent probabilities. Computational confirmation of these estimates has been carried out by several researchers, notably in [\cite=Brent3] [\cite=NicelyTwins]. Some researchers have applied their investigations of differences among primes to study gaps and constellations. The general surveys [\cite=Rib] [\cite=Riesel] provide overviews of some of this work, and the estimate from the Hardy-Littlewood paper [\cite=HL] can be used for constellations consisting of 2's and 4's, e.g. 24, 42, 242, 424, etc. Brent [\cite=Brent] applied the principle of inclusion and exclusion to those estimates to obtain strong estimates for the gaps [formula]. Richards [\cite=Rich] conjectured that the constellation 24 occurs infinitely often. Clement [\cite=quads] and Nicely [\cite=NicelyQuads] have addressed the constellation 242, corresponding to prime quadruplets, pairs of twin primes separated by a gap of 4.

In contrast, the recursion identified in [\cite=FBHgaps] preserves the structure in the cycles of gaps at each stage of Eratosthenes sieve. The occurrence of constellations in stages of the sieve is entirely deterministic. We make estimates for complicated constellations based on assuming uniform distributions of the constellations for which we can obtain exact enumerations via the recursion.

Our results are not quite commensurate with the tables and examples previously published. The tables and examples of [\cite=Brent] [\cite=Brent3] [\cite=IJ] [\cite=NicelyTwins] provide estimates and counts of gaps with respect to large powers of ten. Since we work directly with Eratosthenes sieve, our estimates are given with respect to intervals

[formula]

Recursion on Cycle of Gaps

In the cycle of gaps, the first gap corresponds to the next prime. In G(5#) the first gap g1 = 6, which is the gap between 1 and the next prime, 7. The next several gaps are actually gaps between prime numbers. In the cycle of gaps G(pk#), the gaps between pk + 1 and p2k + 1 are in fact gaps between prime numbers.

There is a simple recursion which generates G(pk  +  1#) from G(pk#). This recursion and many of its properties are developed in [\cite=FBHgaps]. We include only the concepts and results we need for the estimates in this paper.

The recursion on the cycle of gaps consists of three steps.

The next prime pk + 1  =  g1 + 1, one more than the first gap;

Concatenate pk + 1 copies of G(pk#);

Add adjacent gaps as indicated by the elementwise product pk + 1  *  G(pk#): let i1 = 1 and add together gi1 + gi1 + 1; then for [formula], add gj + gj + 1 and let in + 1 = j if the running sum of the concatenated gaps from gin to gj is pk + 1 * gn.

Example: G(7#). To illustrate this recursion, we construct G(7#) from G(5#) = 64242462.

Identify the next prime, pk + 1  =  g1 + 1  =  7.

Concatenate seven copies of G(5#):

[formula]

Add together the gaps after the leading 6 and thereafter after differences of 7 * G(5#)  =  42,28,14,28,14,28,42,14:

[formula]

The final difference of 14 wraps around the end of the cycle, from the addition preceding the final 6 to the addition after the first 6.

Key properties of the recursion

We summarize a few properties of the cycle of gaps G(p#), as established in [\cite=FBHgaps]. The cycle of gaps ends in a 2, and except for this final 2, the cycle of gaps is symmetric. In constructing G(pk  +  1#), each possible addition of adjacent gaps in G(pk#) occurs exactly once.

For a constellation s of j gaps in G(pk#), if j  <  pk + 1 - 1, then in G(pk  +  1#) there will be at least pk + 1 - j - 1 copies corresponding to this particular constellation s. Since the additions in step R3 are spaced according to the element-wise product pk + 1  *  G(pk#), the minimal distance between additions is 2pk + 1. If the sum of the gaps in s, denoted σ(s), is less than 2pk + 1, then the j + 1 additions in step R3 that affect s will occur in distinct copies of s from step R2, and there will be exactly pk + 1 - j - 1 copies of s.

Numbers of constellations

The power of the recursion on the cycle of gaps is seen in the following theorem, which enables us to calculate the number of occurrences of a constellation s through successive stages of Eratosthenes sieve.

(from [\cite=FBHgaps]) Let s be a constellation of j gaps in G(pk#), such that j  <  pk + 1 - 1 and σ(s)  <  2pk + 1. Let S be the set of all constellations s̄ which would produce s upon one addition of differences. Then the number Ns(p) of occurrences of s in G(p#) satisfies the recurrence

[formula]

Figure [\ref=GrowthFig] illustrates the initial conditions for the constellations s = 66 and s = 666 and their driving terms. Note that the initial conditions are not predicated on when the constellations first appear but on the G(p#) for which the constellations satisfy the conditions of Theorem [\ref=CountThm].

Estimating constellations among prime numbers

Based on the recursion above, we conjecture that the copies of a constellation s are distributed approximately uniformly in the cycle of gaps G(p#). Under this assumption, we can estimate the number of copies that occur in the interval

[formula]

for primes q. We denote these counts as Cs(q).

Nearly Uniform Distributions

The recursion in [\cite=FBHgaps] suggests that if we track the images of some constellation s through several stages of Eratosthenes sieve, these images will be almost uniformly distributed in the cycle of gaps.

In G(pk#) pick any constellation s of length j, that satisfies the conditions of Theorem [\ref=CountThm]. Step R2 of the recursion creates pk + 1 copies of this constellation, and these copies are distributed uniformly in the interval

[formula]

. If the distribution for some particular constellation is forever biased strongly toward the middle of the cycle, then the distributions of some other constellations must compensate for this bias. That is, if some constellations fall below the expected number of occurrences, then other constellations must exceed the expectations.

Computational Results

Our computations for counting constellations among prime numbers are currently performed using a modified segmented Eratosthenes sieve. Constellation counts for multiple constellations of varied length can be computed concurrently in a single pass through the Eratosthenes sieve. Constellations are defined as a two dimensional array, an additional one dimensional array of pointers is used to track the match position of constellations as prime gaps are identified by the Eratosthenes sieve.

Constellation counts are stored in memory in a two dimensional array, one dimension for the counts and one dimension for each constellation being analyzed. When a constellation pattern is matched, counts for that constellation are incremented for all prime numbers from [formula] to p  -  σ where p is the prime number currently identified by the Eratosthenes sieve and σ is the sum of the gaps in the constellation. When the sieve process is complete, all results held in the two dimensional array of constellation counts are streamed to a plain text file.

Limits for these computations

Limits can be classified as memory limits, data type limits and execution time limits. Because the computation is using a segmented sieve, the process of identifying primes does not require significant memory, the algorithm allows configuration of the segment size (which directly correlates to memory usage) with the intention of optimizing interaction with L2 cache memory.

The current prime sieve code is limited to 9.0E15, which can easily be extended by altering data types. However if we are to extend these calculations, we need to employ a faster sieve. The current algorithm was chosen for its relative simplicity. Integration of the Sieve of Atkins, or an optimized version of an Eratosthenes Sieve is recommended.

The primary memory consideration is the two dimensional array which holds constellation counts. This array is currently of size N  ×  n where N is the number of integers being sieved and n is the number of constellations being analyzed. The data type being used defines memory requirements and the choice of data type is determined by the constellation count totals expected. With a standard double datatype (8 bytes, allowing constellation count totals up to 9.0E15) and analysis of n = 10 constellations concurrently to 1E12 results in approximately 80Mb of memory usage. With the same scenario run up to 1E15, approximately 2.4 GB of memory is required.

The current practical limit is execution time. Execution time is largely spent either sieving for primes, or incrementing constellation counts. The sieve time complexity is O(N log  log N). The time complexity for incrementing constellation counts is determined by the number of constellations being sieved and the number of matches for the constellations.

Comparison of estimates to counts

As a first application of this approach, we estimate the number of twin primes between p and p2. From the recursion in Theorem [\ref=CountThm] we derive a recursion for these estimates as well.

[formula]

In the figures that follow, we plot the percentage error of our estimates compared to the actual counts for various constellations.

[formula]

Here Cs(p) is the count of actual occurrences of the constellation s in the interval [formula].

Figure [\ref=LogErrFig] shows that after some initial noise, the errors settle down into trending curves. We notice that the curves seem to sort out primarily by the length j of the constellations. The magnitude and duration of the noise seem also to depend on the length j and the sum σ of the gaps in the constellation.

The trends of the errors seem to depend primarily on the length j of the constellation. We observe from our computations that the simple estimates appear to have the right asymptotic behavior but that there are systematic errors that correlate to the number j of gaps in the constellation. In Figure [\ref=LogErrFig] we note that our estimates for single-gap constellations are all off by around 16%. We have included only one constellation with j = 2 gaps, s = 66, and the error through 1E + 12 is around 24%. For the three constellations with j = 3 gaps, s = 242, s = 2,10,2, and s = 666, our simple estimates all have an error of around 34%. We have included no constellations with j = 4 symbols, and the single constellation with j = 5, s = 2,10,2,10,2 displays an error of 53%. So there appears to be a systematic error of around 9%  ×  (j + 1) at 1E + 12, and these errors appear to be growing logarithmically. We would like to find a model that accounts for this deviation between the simple estimate and the actual counts.

Observations on these estimates

Twin Primes

Our estimate for the number of twin primes must be contrasted with those estimates provided by Hardy and Littlewood, which are supported by vast computation [\cite=Brent] [\cite=NicelyTwins]:

[formula]

in which the twin prime constant c2 is given by the infinite product [\cite=HL] [\cite=Riesel] [formula]

In Figure [\ref=Pct268Fig] we plot the percentage errors between the estimates and the actual number of occurrences of the constellation s = 2, for both the Hardy-Littlewood estimate "HL 2" and our estimate E2(p). The comparisons are made over the intervals

[formula]

# { s = 242 : s ⊂ }   ~   c

[formula]

Primes in arithmetic progression

Recently, Green and Tao [\cite=BGreen] have offered a proof that there exist arbitrarily long sequences of primes in arithmetic progression. There are a number of researchers who oversee enumerations and searches for primes and consecutive primes in arithmetic progression. In line with this avenue of research, we include in our computations and estimates the constellations s = 66 and s = 666. These constellations correspond to three and four consecutive primes in arithmetic progression.

A sequence of k consecutive primes in arithmetic progression corresponds to a constellation s consisting of a single gap g repeated k - 1 times. For such a constellation s, the gap g must be divisible by all primes p  ≤  k. For example, for k = 3 the repeated gap must be divisible by 6, and s = 66 is the minimal constellation for k = 3 consecutive primes in arithmetic progression. Similarly, s = 666 is the minimal constellation for a k = 4 consecutive primes in arithmetic progression, and for k = 5 the minimal constellation is s = 30,30,30,30.

We can apply Theorem [\ref=CountThm] and the other structure in the recursion to these constellations. For this paper, we undertook enumerations and estimates for s = 66 and s = 666 up to 1E12. The constellation s = 66 first occurs in G(7#) and s = 666 in G(11#). The percentage errors for our simple estimates for s = 66 and s = 666 are shown in Figure [\ref=Pct666Fig].

Theorem [\ref=CountThm] provides conditions under which a constellation corresponding to an arithmetic progression among possible primes flourishes within the cycles of gaps. For k primes in an arithmetic progression, if the corresponding constellation s satisfies σ(s)  <  2p for any prime p such that the arithmetic progression falls in the interval

[formula]

covered by G(11#), fifteen additional copies of s = 66 are created from the driving terms of s = 66 (such as s̄  =  624).

The minimal constellation for 5 consecutive primes in arithmetic progression is s = 30,30,30,30. The sum σ(s)  =  120, so the conditions of Theorem [\ref=CountThm] are first satisfied for G(59#). The cycle G(59#) consists of roughly 2.57E + 20 gaps of total sum around 1.92E + 21. The constellation s = 30,30,30,30 first occurs among consecutive primes around ten million.

Critiquing the simple estimate

Based on our conjecture about uniformity, we have estimated the number of copies of a constellation s that fall between pk + 1 and p2k + 1 as

[formula]

For small primes we can improve these estimates by adjusting the intervals for the length of the constellation s or the symmetry of the cycle of gaps G(p#). These adjustments change the estimates significantly for small primes, but their impact fades rapidly in the face of factors of the form p - j. From our computations, it seems that the estimates simply need to be adjusted by some constant, which depends in part on the constellation s. While we could estimate the constant for the constellations we have enumerated, we do not yet have a theoretical basis for adjusting the estimate in this way.

To make real improvement on the estimates, we need better statistical models for the distribution of constellations in the cycle of gaps. Since correlations among copies of a constellation are largely preserved by the recursion, helpful second-order statistics may be tractable. Our conjecture [\ref=uniconj] does not take into account these correlations. For example, the constellation 2,10,2,10,2 occurs in G(7) and thereafter. This constellation contains two occurrences of 2,10,2 and will consequently introduce jumps in Ck(2,10,2).

The structure of G(p#) determines the constellations among primes for intervals

[formula]

. On the one hand, this interval is large enough for us to prove that the estimates for constellations of lengths 1 to 5 gaps will grow with p, but the interval is a vanishingly small sample in G(pk#) as the process continues. This interval is also not a random sample from the distribution. We are sampling from the start of the cycle of gaps, so the errors will be correlated (e.g.

[formula]

substantially overlap).

Along the lines of this critique, although we are using

[formula]

Conclusion

We start with the recursion on the cycle of gaps in the stages of Eratosthenes sieve. Based on the recursion, we conjecture that all constellations, which occur in G(p#) for some prime p and the sum of whose gaps is less than 2p, tend toward a uniform distribution in later stages of the sieve. From this conjecture, we estimate the number of occurrences of a constellation between p and p2 for the new prime p at each stage of the sieve; all constellations which occur before p2 actually occur as constellations between primes.

We compare our estimates with enumerations for a sample of interesting constellations with lengths from one gap to five gaps. Our simple estimates compare well with the enumerations so far. For single gaps or for constellations consisting only of 2's and 4's, other estimates are available [\cite=HL] [\cite=Brent] [\cite=Riesel] [\cite=NicelyQuads], and our estimates agree with these established estimates to first order.

Having compared our simple estimates to actual counts through 1E + 12, we observe a systematic error in the simple estimates, which depends on the length of the constellation. A focus of our continuing work in this area is to understand this error and thereby to improve our estimates.