Log-transforming the matter power spectrum

T.A. Enßlin

Introduction

In cosmology and astrophysics densities are often described as a combination of the mean density and fluctuations around it,

[formula]

where the density contrast field δ is often small and accurately described by a Gaussian random field. However, as soon as large overdensities occur (δ > 1) a description of δ by Gaussian statistics does not suffice, since δ cannot go below minus one. A prominent example of such a density is the large-scale structure, where the overdensity is accurately described by Gaussian statistics at early epochs, but becomes highly non-linear at later epochs and small scales. In these non-linear regimes the density is much more accurately described by log-normal statistics, i.e., log (1 + δ) following Gaussian statistics. This has already been noted by [\cite=Hubble-1934] and [\cite=Hamilton-1985] and theoretically investigated by [\cite=Coles-1991]. N-body simulations calculated by [\cite=Kayo-2001] are also in agreement with a log-normal distribution. However, as [\cite=Carron-2011] showed, correlation functions and spectra contain very limited information in the case of highly non-linear log-normal statistics as there are other distribution functions that would produce the same moments. For a perturbative treatment of the power spectrum of log (1 + δ) see [\cite=Wang-2011]. Another example is the density in turbulent and isothermal clouds, which is very accurately described by a log-normal distribution (seem e.g., [\cite=Passot-1998] or [\cite=Nordlund-1999]).

In many cases, however, only the linear power spectrum (the power spectrum of δ) is available (e.g., from observations or simulations). It is therefore useful to convert a linear power spectrum into a logarithmic power spectrum (and vice versa). In this work we derive such a conversion formula under the assumption that the power spectrum is the power spectrum of the underlying statistical process. This condition is not necessarily met if the power spectrum is calculated from observational data or simulations, but in most cases the formula works nevertheless. Formulas relating the correlation functions of Gaussian and log-normal fields are widely known throughout several fields. In cosmology we refer the reader to [\cite=Coles-1991], [\cite=Politzer-1984], and [\cite=Percival-2004]. The first goal of this paper is to provide a pedagogical introduction along with application examples enabling the reader to directly apply the derived formulas in a numerical setting while avoiding normalization and prefactor mistakes which can drastically influence the outcome due to the non-linearity of the exponential and logarithmic functions. The second goal is to apply the presented formalism to investigate how much a log-transformation of the large-scale density reduces the non-linear enhancement of small-scale power for decreasing redshifts.

The remainder of this paper is structured as follows. First, we go through the derivation of the conversion formalism in Sect. [\ref=sec:conversion] in which we state all definitions explicitly before the calculation. Second, we apply the conversion to the large-scale matter spectrum in Sect. [\ref=sec:matter_spectrum] to test the validity of the log-normal approximation of the cosmic matter density. Finally, we conclude this paper with a summary and outlook in Sect. [\ref=sec:conclusions].

In the Appendix, we describe how to generate log-normal random field following a given spectrum (Appendix [\ref=sec:generate_lognormal]). Furthermore, we present a consistent discretization of the conversion formulas (Appendix [\ref=sec:discrete]) their spherical harmonics equivalent (Appendix [\ref=sec:spherical]). We also discuss in greater detail a number of aspects from Sect. [\ref=sec:matter_spectrum] in Appendix. [\ref=sec:matter_appendix], e.g., how the choice of gridding affects the results.

The conversion

Notation and definitions

We denote the log-normal field at position [formula] by [formula] and the underlying Gaussian field by [formula],

[formula]

where s is dimensionless and the units of ρ as well as a proportionality constant are in ρ0 and [formula]. In this work, log  denotes the natural logarithm.

The field s is assumed to follow a Gaussian distribution with zero mean,

[formula]

with u being the dimensionality of space and [formula]. [formula] is the auto-correlation function of s. It is defined as

[formula]

Here, Ds denotes integration over the full phase space of s. The inverse of S is defined by the relation

[formula]

where [formula] is the u-dimensional Dirac delta distribution.

In Fourier space, we denote position vectors by [formula] or [formula]. Fourier transformed fields are denoted by their argument (e.g., [formula]). We define the Fourier transformations over continuous position space as

[formula]

If a field obeys statistical homogeneity its auto-correlation function depends only on the separation, [formula], and is therefore diagonal in Fourier space,

[formula]

The quantity [formula] is the statistical power spectrum of s.

The auto-correlation function and statistical power spectrum of ρ are defined analogously,

[formula]

In the second line we used that ρ obeys statistical homogeneity, too.

Converting the logarithmic power spectrum to the linear power spectrum - the forward conversion

Suppose the statistical power spectrum of s, [formula], and the mean m are known. We are looking for the statistical power spectrum of [formula]. The auto-correlation functions are related by

[formula]

since P(s) is Gaussian. Using the statistical homogeneity of Cρ and S, we write

[formula]

This relation between the correlation function of a Gaussian and log-normal field is well known in cosmology (see, e.g., [\cite=Coles-1991]). Combined with Eqs. [\eqref=eq:first_powspec] and [\eqref=eq:second_powspec] this yields

[formula]

and therefore

[formula]

Eq. [\eqref=eq:forward_conv] is our forward conversion formula.

If [formula] is isotropic, the equation can be simplified in spherical coordinates, since in that case the argument of the exponential function is isotropic in [formula], too. In the three-dimensional isotropic case, integration of the angular part yields

[formula]

where we denoted [formula]. While this equation only has one-dimensional integrals, its numerical evaluation involves some subtleties, which is why we perform the numerical calculations in this work using full-dimensional fast Fourier transforms, even if the power spectrum is isotropic. However, integration of the angular part can be performed for all of the following equations in a very similar manner.

Converting the linear power spectrum to the logarithmic power spectrum - the backward conversion

Suppose the statistical power spectrum of ρ, Pρ(k), is known and we want to know the power spectrum of s. We therefore need to solve Eq. [\eqref=eq:relation_between_spectra] for Ps(k),

[formula]

We invert the operation in front of Ps(k) using

[formula]

to arrive at

[formula]

The two correction terms on the right-hand-side do not affect modes with [formula],

[formula]

and there is a degeneracy between the monopole [formula] and the mean,

[formula]

where we have identified [formula] as the volume of the system. We recommend to set the monopole to zero to fix the mean. Eqs. [\eqref=eq:backward_no_mono] & [\eqref=eq:backward_mono] are our backward conversion formulas.

We note that knowledge about the monopole of ρ is crucial for this conversion to work. If the monopole is not supplied, one can estimate it from the mean of ρ as

[formula]

Using the assumption of statistical homogeneity the backward conversion formula can also be applied in real space to get [formula] from [formula],

[formula]

This relation can (in a different form) also be found in [\cite=Coles-1991] (Eq. (30) therein).

The matter power spectrum

In this section, we use Eqs. [\eqref=eq:forward_conv], [\eqref=eq:backward_no_mono], and [\eqref=eq:backward_mono] to test the range of validity of a log-normal approximation to the power spectrum of dark matter. In order to apply the formulas on a computer one needs to discretize them correctly, since global prefactors are important in a non-linear transformation such as the exponential and logarithmic functions. We present a consistent discretization in Appendix [\ref=sec:discrete].

The cosmic matter density ρ is typically parametrized as the mean density ρ0 and mass density contrast δ according to Eq .[\eqref=eq:contrast]. The three-dimensional isotropic power spectrum of these fluctuations, Pδ(k), is usually referred to as the matter power spectrum of the large-scale structure. At high redshifts the fluctuations are small, δ  ≪  1. With decreasing redshifts, the magnitude of the fluctuations increases. In linear theory, each Fourier mode of the fluctuations is enhanced by the same linear growth factor D(z), yielding a very simple relation between the matter power spectrum at different redshifts,

[formula]

where Pδ(k,z) denotes the power spectrum of δ at redshift z. The functional form of the linear growth factor is slightly different for different cosmologies. We use the cosmological parameters determined by [\cite=Planck-2013]. The prefactor of the power spectrum is determined by the σ8 normalization which is the variance of δ convolved with a spherical top hat function with an [formula] radius. Its value at redshift zero is determined by [\cite=Planck-2013] to be [formula]. Together with the growth factor this determines the linear power spectrum Pδ(k) at all redshifts, since in linear theory it retains its shape. However, the linear description of the redshift dependence of the matter power spectrum fails for low redshifts, where the fluctuations can be on the order of 1. This has been successfully treated up to redshift 1 by third order perturbation theory (henceforth 3PT) around the linearly evolved spectrum by [\cite=Jeong-2006]. For redshifts below 1, the non-linearities in the matter power spectrum can be modeled using the Cosmic emulator (henceforth CosmicEmu) based on [\cite=Heitmann-2009], [\cite=Heitmann-2010] and [\cite=Lawrence-2010].

Using the formalism presented in this paper we investigate whether some of the non-linearities resolved by third order perturbation theory and the Cosmic emulator arise naturally if linear growth is applied to the logarithmic density contrast instead of the density contrast itself. A similar question has been investigated by [\cite=Neyrinck-2009]. Using data from the Millennium Simulation by [\cite=Springel-2005] [\cite=Neyrinck-2009] compared the power spectrum of [formula] at different redshifts. They found a remarkable reduction of non-linearities in the power spectra up to [formula] at all redshifts. They also found a bias factor for large scales, which is not apparent in our figures. We discuss the origin of this factor in Appendix [\ref=sec:bias-factor].

Around redshift 7 the 3PT corrections by [\cite=Jeong-2006] start to become significant. [\cite=Jeong-2006] find a good agreement between the 3PT spectrum and N-body simulations for wavevectors up to [formula] and redshifts higher or equal to 1. For redshifts 1 to 0 we use matter spectra calculated using CosmicEmu. According to [\cite=Heitmann-2009], [\cite=Heitmann-2010] and [\cite=Lawrence-2010] these are accurate to 1% up to [formula]. We therefore assume, that they are also reasonably accurate up to [formula].

We denote the logarithmic density contrast as

[formula]

At high redshifts, where δ  ≪  1, we have s  ≈  δ. Therefore, at high redshifts applying the linear growth factor to s has the same effect as applying it to δ. We keep applying the growth factor to s instead of δ throughout the whole redshift spectrum in order to test whether some of the non-linearities appearing at lower redshifts arise naturally this way. Therefore we apply the forward conversion formula (Eq. [\eqref=eq:forward_conv]) to the linearly evolved spectrum at redshifts 0 to 7 and the backward conversion formulas (Eqs. [\eqref=eq:backward_no_mono] and [\eqref=eq:backward_mono]) to the 3PT spectra and the CosmicEmu spectra respectively.

To that end, we calculate the matter power spectrum at several redshifts between 1 and 7 by applying the 3PT code by [\cite=Jeong-2006] to the linear power spectrum calculated using CAMB (see, e.g., [\cite=Lewis-2000]) and between 0 and 1 using the CosmicEmu code.

The lowest spectral length covered is [formula] for the 3PT code and [formula] for the CosmicEmu code. Therefore, we let our numerical setup cover the region [formula]. There are several ways to resolve this spectral range and because of the non-linear nature of the exponential function the result of the conversion formulas is not independent of the choice. The smoothing onto a grid of a logarithmic function is thoroughly discussed by [\cite=Wang-2011]. We perform the calculation on four different grids to demonstrate this difference. We present the results of one grid here and discuss the differences between the grids in Appendix [\ref=sec:grids].

The mean of (1 + δ) is 1, the mean of es, however, is higher than 1, since the fluctuations are not symmetric. In order to properly compare the resulting spectra we therefore absorb a factor of [formula] into ρ0, i.e., in the following discussion we compare the power spectra of δ and [formula].

The mildly non-linear regime

For redshifts higher or equal to 1, the non-linear corrections (calculated using 3PT) are rather mild. In this regime the model of a linearly evolved log density contrast works rather well, as we depict in Fig. [\ref=fig:low_all]. For a more quantitative comparison we depict the forward converted spectra divided by the 3PT spectra and the backward converted spectra divided by the linear spectra in Fig. [\ref=fig:low_over_all]. For redshifts 1 to 7 and [formula] the maximal log-distance between the converted spectra and the 3PT spectra stays below 0.17. The distances are slightly lower for the backward conversion. As one can see in Fig. [\ref=fig:low_over_all], the distance is strongest around [formula]. For a full list of the log-distances see Appendix [\ref=sec:log-distances]. In the region where [formula] the results are susceptible to the choice of gridding. We discuss this in detail in Appendix [\ref=sec:grids].

The non-linear regime

For redshifts smaller than 1, the non-linear corrections add small-scale power which is comparable to the total linear power. On the grid we chose, the total power of the CosmicEmu spectrum is twice as high as the power of the linear spectrum at redshift 0.8. In this regime the agreement between the converted spectra and the CosmicEmu (or linear spectra, respectively) is much weaker. We depict the non-linearities generated by the forward conversion and the reduction of non-linearities in the backward conversion in Fig. [\ref=fig:high_all]. A more error focused comparison with the forward converted spectra divided by the CosmicEmu spectra and with the backward converted spectra divided by the linear spectra can be found in Fig. [\ref=fig:high_over_all]. The maximal log-distance for [formula] between the backward converted spectra and the CosmicEmu spectra ranges between 0.17 for z = 1 and 0.8 for z = 0. For the forward converted spectra it ranges from 0.2 at z = 1 to 1.5 z = 0. Clearly, a log-distance of 1.5(corresponding to a factor of 4.5) is not within an acceptable margin of error. Emulating the non-linear corrections from CosmicEmu by forward conversion breaks down in this regime. The backward conversion performs better than the forward conversion, but a log-distance of 0.8(corresponding to a factor of 2.2) is far from ideal. However, the backward conversion still reduces the magnitude of non-linear corrections significantly. See Table [\ref=table:log-distances] in Appendix [\ref=sec:log-distances] for a detailed comparison of the log-distances.

Smearing of baryon acoustic oscillations

Another important non-linear effect is the smearing of baryon acoustic oscillations (BAO). Towards lower redshifts the smallest scale wiggles in the matter power spectrum are erased while the large scale wiggles become increasingly damped as redshift decreases. This can be nicely seen in Fig. [\ref=fig:low_BAO], where we depict a comparison between 3PT spectra calculated on the basis of the CAMB power spectrum and 3PT spectra calculated on the basis of the "no wiggle" power spectrum by [\cite=Eisenstein-1998] in the left panel. The same comparison but using the forward converted linear spectra instead of the 3PT spectra can be seen in the right panel. It is evident that BAO smearing appears only very slightly in the forward converted power spectra, it is much weaker than the smearing calculated using 3PT. BAO smearing appears to be about 3 to 4 times weaker (see Appendix [\ref=sec:smear_strength]) in the forward converted spectra compared to the 3PT spectra, which exhibit a smearing in agreement with N-body simulations.

Discussion and conclusions

Starting from the assumption of Gaussian statistics for s we presented a formalism to calculate the power spectrum of s =  log (ρ) from the power spectrum of ρ and vice versa. This formalism can for example be used to compare theoretical considerations about logarithmic densities with theoretical or observed power spectra, which are calculated from the linear density. A numerical implementation of these formulas can be found in the NIFTy python package ([\cite=Selig-2013]). The formalism is also useful to generate log-normal fields with a given power spectrum, as one can simply convert the spectrum, use the resulting spectrum to generate Gaussian random fields, and then exponentiate them (see Appendix [\ref=sec:generate_lognormal]).

We used this formalism to investigate whether the non-linear corrections to the matter spectrum are reduced for the logarithmic density and whether the non-linearities can be emulated by applying the growth factor to the log-density instead of the density. To that end we compared emulated linear (CAMB) and non-linear (third-order perturbation theory and CosmicEmu) spectra with the in- and outputs of our formulas. For the mildly non-linear regime (redshift 1-7) we find that the log-transformed non-linear spectra agree with the linear spectra rather well (less than 20% difference between them up to [formula]). This enables one to easily generate a log-normal field, which follows the appropriate non-linear power spectrum, even for position dependent redshifts. We describe this procedure in detail in Appendix [\ref=sec:generate_matter]. For lower redshifts the agreement decreases but the non-linearities are still reduced significantly. The smearing of baryon acoustic oscillations can not be emulated by applying the growth factor to the log-density. There is some smearing due to mode coupling, but it is about 3 to 4 times weaker than in the more exact third-order perturbation theory.

We performed the calculation on four different grids leading to different but within the achieved precision comparable results. The differences between the results on different grids indicate that the agreement between our model and the non-linear spectra from literature decreases if the grid allows scales corresponding to [formula], since mode coupling to the small scales overestimates the non-linear corrections. This problem arises since the total power of the matter spectrum diverges as its spectral index is above - 3, which makes some sort of cut-off in power necessary in a non-linear transformation such as the exponential and logarithmic functions. Here, this cut-off is imposed by the resolution of the grid. Ultimately, one would have to find a physically justifiable way to regularize the integral in Eq. [\ref=eq:angles_integrated].

Generating log-normal fields from a given power spectrum

We can use the backward conversion (Eqs. [\eqref=eq:backward_no_mono] & [\eqref=eq:backward_mono]) to generate log-normal random fields that follow a given linear power spectrum. This method has already been presented by [\cite=Percival-2004] (see Sect. 3.2 therein). For illustrative purposes we demonstrate the procedure for an isotropic case, but the same procedure can be applied for an anisotropic power spectrum.

Suppose the power spectrum Pρ(k) is known within some range [formula] and the mean [formula] is also known. First, we set up a discretized space in which [formula] corresponds to the minimal non-zero mode and [formula] is the highest supported mode. We construct the monopole according to Eq. [\eqref=eq:fill_mono] and apply Eqs. [\eqref=eq:backward_no_mono] and [\eqref=eq:backward_mono] to the power spectrum. Setting Ps(k   =   0) = 0 in Eq. [\eqref=eq:backward_mono] we end up with a power spectrum Ps(k) and a mean m. We can now construct log-normal fields by generating Gaussian random fields from Ps(k) and exponentiating the sum of s and m. The resulting field ρ = es + m follows (in the statistical average) the power spectrum Pρ(k).

We illustrate this in Fig. [\ref=fig:mock_conv]. Starting with the power spectrum of ρ and [formula], we calculate the power spectrum and mean of s. The mean is - 0.76. With these quantities we can draw log-normal fields that follow the original power spectrum. One random field of that kind is plotted in Fig. [\ref=fig:mock_rho].

The discretized conversion formula

The discetized conversion formulas are implemented in the NIFTy python package by [\cite=Selig-2013] (version 0.8.4 or higher).

In discretizing the forward and backward conversion formulas from Sect. [\ref=sec:forward] and [\ref=sec:backward] one needs to pay careful attention to volume factors arising from the discretization of the integrals. We define the discrete Fourier transform as

[formula]

We note that the definition of the Fourier vector has changed with respect to the main text, [formula], as this is more common in a numerical setting. The vector [formula] can only take discrete values,

[formula]

where the dimension j is discretized into Nj pixels with edge length Δxj. Therefore, our discretized space consists of [formula] pixels that have the volume

[formula]

This defines a conjugate set of discrete values for [formula],

[formula]

where [formula]. Therefore, the conjugate space consists of N pixels that have the volume Vk  =  1 / (N  Vx). The power spectrum is defined analogously to Eq. [\eqref=eq:first_powspec] by

[formula]

where

[formula]

Defining [formula] one can derive the forward conversion formula as

[formula]

The backward conversion formula is

[formula]

and for the monopole

[formula]

The conversion for spherical harmonics

The spherical harmonics conversion formulas are implemented in the NIFTy python package by [\cite=Selig-2013] (version 0.8.4 or higher).

We define the spherical harmonics as

[formula]

where we will write Ω as a short-hand notation for θ,φ with Ω = 0 corresponding to θ = 0, φ  =  0. In the spherical harmonics basis we define the power spectrum as

[formula]

where we assumed statistical homogeneity and isotropy. In this section, δij denotes the Kronecker delta and * denotes complex conjugation. The covariance matrix in pixel space is related to the power spectrum by

[formula]

which in the case of Ω' = 0 is

[formula]

Because of statistical homogeneity and isotropy, this stays the same for all angles that are separated by Ω.

Following a similar calculation as in Sects. [\ref=sec:forward] and [\ref=sec:backward] we derive the forward conversion as

[formula]

and the backward conversion as

[formula]

and

[formula]

Supplements to Sect. [\ref=sec:matter_spectrum]

Log-distances

We calculate the maximal log-distance between two spectra as

[formula]

This distance gives a quantitative measure about the goodness of approximating the non-linear spectra by forward converted spectra and about the reduction of non-linearities in the backward converted spectra. In Sects. [\ref=sec:mid-non-linear] & [\ref=sec:non-linear] we give an overview over the log-distances for [formula]. Here, we list all of their values in Table [\ref=table:log-distances], which also shows the log-distances between the linear and non-linear spectra. As one can see the converted spectra always reduce the log-distance.

The effect of different grids

The calculation in Sect. [\ref=sec:matter_spectrum] is performed on four different grids which all cover the same physical volume, but with different resolution. The Figures in Sect. [\ref=sec:matter_spectrum] show the results of the second grid (grid B). The lowest non-zero mode we want to cover is [formula] for all grids. The highest mode is different for the three grids, the coarsest one having [formula]. The minimum spectral length covered by a three-dimensional Cartesian box with the origin in the middle is

[formula]

where Lx, Ly, and Lz are the total edge lengths of the box. The maximum spectral length is

[formula]

where Δx, Δy, and Δz are the edge lengths of one pixel. This leaves us with an infinite number of possible pixelizations. We restrict ourselves to cubic pixels and an equal number of pixels in each dimension leaving us with only two parameters: the number of pixels per dimension [formula] and the pixel edge length Δx.

The first grid (grid A) consists of 1523, the second grid (grid B) of 2143, the third grid (grid C) of 5223, and the fourth grid (grid D) of 7663 cubic pixels. The pixel edge lengths are chosen in a way that the lowest non-zeros value of k is [formula]. We summarize the properties of these grids in Table [\ref=table:grids]. The upper limit of the spectral range of grid D is higher than [formula]. To investigate the effect of the pixel size on the conversion we cut the power spectrum at [formula] setting all higher modes to zero before the conversion. Therefore, any difference in the results of grid B and D originates from the different choice of pixel sizes, and because grid D covers a sphere in Fourier space whereas grid B covers a cube, since no individual component of the wavevector in grid B can have a value above [formula] and wavevectors with a length above that can only be reached in the corners of the cube.

To see the effect of the grid on the conversion we plot a selection of forward converted spectra using all four grids divided by the corresponding emulated spectra in Fig. [\ref=fig:cut_comp_forward] and the backward converted spectra divided by the corresponding linear spectra in Fig. [\ref=fig:cut_comp_backward]. In grid D the power spectrum is only filled up to [formula] before the conversion, higher modes are set to zero. In the backward conversion the power spectra start to differ around [formula], where the result from grid D starts to overshoot the others. In the forward conversion the differences are much more prominent. For redshift 0 the spectrum from grid C exhibits a clear increase in broad-band power on all scales, because at z = 0 the region with [formula] contains more power than the region with [formula]. This additional power couples to all scales in the forward conversion. However, for redshifts greater than 1 the spectra appear to be consistent up to [formula] and grids A, B, and D appear to be consistent at all redshifts. Table [\ref=table:grid-log-distances] lists the log-distances up to [formula] for grids A, C, and D with respect to grid B. One can see, that the log-distances are comparable with the log-distances of grid B with respect to the emulated and linear spectra listed in Table [\ref=table:log-distances] in Appendix [\ref=sec:log-distances]. We therefore conclude that the calculation is consistent between the investigated grids within the precision of our model. There is however a systematic trend apparent in Fig. [\ref=fig:cut_comp_forward] that an increase in total power due to a greater covered k-range leads to an increase in broad-band power in the forward converted spectra. We therefore expect the validity of our model to break down for higher high dynamic ranges as the total power of the Cosmic matter spectrum diverges, since its spectral index towards high k is above - 3. The problem with a spectral index above - 3 can be seen best in the angle integrated conversion formula Eq. [\eqref=eq:angles_integrated].

Strength of the smearing of BAO

We estimate the strength of the smearing of baryon acoustic oscillations by comparing to a smoothing (with respect to log (k)) of the linear spectrum using a Gaussian kernel,

[formula]

where σg is the smoothing length in terms of e-folds. σg is a dimensionless distance in log (k). The smoothed spectrum is therefore

[formula]

We can compare [formula] with [formula] in order to find a σg where the smoothing appears to be similar. The higher σg, the stronger the smoothing. Here, [formula] denotes the non-linear power spectrum with BAO, [formula] the non-linear power spectrum without BAO, and [formula] the linear power spectrum without BAO. The best value for σg at each redshift is found by visual comparison in the absence of a more rigorous criterion. We list the best fit values for different redshifts for the 3PT spectra as well as the forward converted spectra in Table [\ref=table:smoothing]. The values for the CosmicEmu spectra are missing because the CosmicEmu code did not allow us to calculate non-linear power spectra without BAO.

Large-scale bias

[\cite=Neyrinck-2009] find a bias factor between the the power spectra of the density contrast and the logarithmic density, which they fit to [formula] with high accuracy up to [formula]. If the density field follows log-normal statistics the correlation functions of the density and log-density are related by

[formula]

which simplifies under the assumption of statistical homogeneity and a zero mean for s to

[formula]

where [formula]. This prefactor is the square of the expectation value of ρ,

[formula]

In Sect. [\ref=sec:matter_spectrum] of this work, we compared the spectra of the δ and [formula] since the density contrast is defined around a mean of 1. In the backward conversion, the mean of the resulting log-density field was not zero. Eq. [\ref=eq:backward_mono] determined it as

[formula]

for all redshifts (to 0.1% precision). However, this prefactor should not appear in the work of [\cite=Neyrinck-2009], since they compare the power spectra of δ and s  =   log (1 + δ), where δ  =  ρ  /  ρ0  -  1. This means that the prefactor in Eq. [\eqref=eq:bias_factor] is already divided out.

There is an additional bias apart from this factor, which can be seen best in the low redshift panels in the left part of Fig. [\ref=fig:high_over_all]. Here the forward converted power spectrum exceeds the original power spectrum even at the lowest k-bin. This is not due to the prefactor presented in the previous paragraph, but simply to mode coupling in the forward conversion. The inverse of this effect is present in the backward conversion, where the backward (i.e., log-transformed) power spectrum undershoots the linear power spectrum at the lowest k-bin. This factor is, however, much weaker than what [\cite=Neyrinck-2009] find. For completeness, we list the factors between the lowest k-bins, i.e., [formula], in Table [\ref=table:low_k_factors]. In conclusion, the log-normal model offers no insight to the bias factor found by [\cite=Neyrinck-2009].

Generating matter densities in spaces spanning in redshift

In Sect. [\ref=sec:matter_spectrum] we have established that the power spectra of the exponentiated linear density contrast agree with the emulated spectra to a reasonable accuracy down to redshift 1 and [formula]. Therefore, the log-density at different redshifts is (in a statistical average) related by a simple global prefactor. This enables us to formulate a local function which translates the density between different redshifts to better accuracy than linear theory. We let G(z;z0) be the growth factor between redshift z0 and redshift z and δ(z) the density contrast at a given redshift. Then we have

[formula]

where [formula] is the variance in one cell.

Using this formula one can easily generate a lognormal field that behaves like the matter density contrast to a good accuracy. One simply takes z0 to be sufficiently high so that [formula] and log (1 + δ(z0))  ≈  δ(z0). At such a redshift a Gaussian random field generated from the matter power spectrum desribes the statistics of δ(z0) very well. By applying Eq. [\eqref=eq:density_trafo] using a position dependent redshift [formula],

[formula]

one can now generate a log-normal matter density contrast that follows the appropriate non-linear matter power spectrum in each position (or redshift slice).