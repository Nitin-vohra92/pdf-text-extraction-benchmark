Statistical Post-Processing of Forecasts for Extremes Using Bivariate Brown-Resnick Processes with an Application to Wind Gusts

, Martin Schlather and Petra Friederichs

Keywords: bivariate random field, Matérn model, max-stable process, pseudo cross-variogram

Introduction

Spatial extremes may occur in various forms such us heavy rainfall, floods, heat waves or wind gusts. In view of their severe consequences, an adequate and precise forecast of these events is of great importance. However, the rareness of extreme events impedes any such task and, consequently, existing forecasts often lack accuracy. In meteorology, for example, forecasting extreme wind gusts, which are defined as peak wind speeds over a few seconds, is exacerbated by the short temporal and spatial ranges. Furthermore, numerical weather prediction (NWP) models provide estimates or diagnoses of wind gusts based on empirical knowledge only [\citep=brasseur-2001]. Although wind is a prognostic variable in NWP models, its values represents an average wind speed over a few minutes or longer depending on the grid spacing of the NWP model. Hence, post-processing procedures are needed that allow for an enhanced probabilistic forecast.

Occurring as limits of normalized pointwise maxima of stochastic processes, max-stable processes provide a suitable framework for the description of spatial extreme events, commonly used in environmental sciences [\citep=coles-1993] [\citep=coles-tawn-1996] [\citep=huser-davison-2013]. Of particular interest is the subclass formed by Brown-Resnick processes which arise as limits of rescaled maxima of Gaussian processes [\citep=brown-resnick-1977] [\citep=kab-etal-2009] [\citep=kabluchko-2011].

During the last years, max-stable processes have been frequently applied as models for spatial extremes in environmental sciences. For instance, [\citet=engelke-etal-2012] and [\citet=genton-etal-2014] recently used max-stable processes to model extreme wind speed observations. The model we propose will go one step further, also taking into account the forecasts in two different aspects: First and in contrast to [\citet=engelke-etal-2012] and [\citet=genton-etal-2014], we consider the mean forecast to get a normalized version of the extreme observations. Second, besides the observable variable of interest itself, the corresponding forecast is included as second variable yielding a bivariate max-stable process. Here, we will focus on the class of bivariate Brown-Resnick processes [\citep=molchanov-stucki-2013] [\citep=genton-etal-2014] to exploit the statistical relation between observable data and the corresponding forecast. Modeling the behavior of observational data, a sample from the distribution of the observations conditional on the forecast is supposed to provide more realistic results than the original forecast and thus will appear as an appropriate probabilistic post-processed forecast.

The paper is structured as follows: In Section [\ref=sec:univ], we present a univariate model for extreme observations, which may, in general, provide a first alternative to the original forecast. We introduce a model for the marginal distribution, i.e. the distribution of the observable variable of interest at a single location, motivating the normalization of its extremes by the mean forecast. The spatial dependence structure is incorporated into the model by the use of univariate Brown-Resnick processes. Section [\ref=sec:biv] is dedicated to the bivariate Brown-Resnick process which serves as a joint model for both the maximally observed and forecasted quantities. We deduce a necessary condition on the asymptotic behavior of the pseudo cross-variogram and provide a flexible cross-variogram model which leads to a stationary bivariate Brown-Resnick process. In Section [\ref=sec:fit], we describe how the model can be fitted to data. Based on this model, we propose a post-processing procedure which is presented in Section [\ref=sec:postproc]. Further, we provide tools to verify the procedure and the underlying models. Finally, the methods presented in Sections [\ref=sec:fit] and [\ref=sec:postproc] are applied to real observation and forecast data for extreme wind gusts provided by the German's National Meteorological Service, Deutscher Wetterdienst (DWD) (Section [\ref=sec:data]).

Modeling by a Univariate Random Field

In this section, we present a spatial model for the observed pointwise maximum [formula] within a specific time period. To this end, we assume that, for each location and time period, the maximum [formula] is based on observations at N equidistant instants of times per period, that is, we have [formula] for [formula] for some parameter ϑ. Here, the probability distributions Fϑ are supposed to form a location-scale family with finite second moments, i.e.  [formula] with [formula], [formula], and F(0,1) is standardized to mean zero and unit variance. We assume ϑ = (m,s) to be temporally constant at each location within the same time period, but allow the values to vary among different locations and different time periods. The values of m and s will essentially be estimated from the bulk of the distribution, not the tail, and thus, they can often be extracted accurately from forecasts. Within the same time period and at the same location, the observable variables [formula] are assumed to be subsequent N elements of a stationary time series [formula]. Furthermore, we assume that the standardized distribution F(0,1) belongs to the max-domain of attraction of some univariate extreme value distribution Gξ, [formula], i.e. there are sequences [formula], an > 0, and [formula], [formula], such that

[formula]

where for 1 + ξx > 0. As the second moment of F(0,1) is assumed to be finite, we have ξ < 0.5. Under some conditions on the regularity and the dependence of the stationary sequence [formula], we obtain that

[formula]

where [formula] and [formula] for some θ∈(0,1] called extremal index [\citep=coles-2001] [\citep=leadbetter-etal-1983].

Let m = m(l,p) and s = s(l,p) be the mean of the variable at location l and period p and its standard deviation, respectively. Let

[formula]

be the generalized extreme value distribution (GEV). Then, considering [formula] for large N, we have approximately that

[formula]

Here, the GEV parameters are assumed to be the same for every time period, which, in general, enables us to estimate the parameters for current and future time periods from past data. As common in many applications, the extreme value index ξ is also assumed to be constant in space, while [formula] and [formula] may depend on the location l. In contrast to [formula] and [formula], m(l,p) and s(l,p) vary in space and time and may be interpreted as normalizing constants that will be the same for observation and forcasts. As m(l,p) and s(l,p) are defined as mean and standard deviation of the variable of interest, the parameters [formula] and [formula] are uniquely determined. Marginal transformation yields that

[formula]

is standard Gumbel distributed for every location l and time period p.

Perceiving the set of locations as a subset of [formula] and the set of periods as a subset of [formula], the transformed observations can be regarded as realizations of a spatio-temporal random field [formula]. While we assume that the spatial random fields [formula], [formula], are independent and identically distributed, we allow for a non-trivial spatial dependence structure. Here, we use the class of Brown-Resnick processes that can be defined for arbitrary dimensions D [\citep=brown-resnick-1977] [\citep=kab-etal-2009]: Let [formula] be a Poisson point process on [formula] with intensity e- u  du and, independently of Π, let Wi, [formula], be independent copies of a zero-mean Gaussian random field [formula] with stationary increments and semi-variogram γ(  ·  ) defined by

[formula]

Then, the random field Z defined by

[formula]

and called Brown-Resnick process associated to the semi-variogram γ, is stationary and max-stable with standard Gumbel margins and its law only depends on the semi-variogram γ [\citep=kab-etal-2009]. For the application of the Brown-Resnick model to observed data with locations in [formula], we propose to restrict to semi-variograms from a flexible parametric subclass, such as semi-variograms of the type

[formula]

with ϑ  =  (s,b,ζ,α) for s,b  >  0, ζ∈( - π / 4,π / 4] and α∈(0,2]. Here, the matrix [formula] allows for geometric (elliptical) anisotropy, i.e.

[formula]

[\citep=chiles-delfiner-2012], and s is an overall scale factor.

Modeling by a Bivariate Random Field

In this section, we also take into account the dependence between the observed maximum [formula] and its forecast [formula]. As [formula] is a forecast for [formula], it seems reasonable to use a GEV model similar to the one described in Section [\ref=sec:univ] with possibly different parameters [formula], [formula] and [formula], i.e.

[formula]

(cf. Equation [\eqref=eq:single-loc-model-obs]). Marginally transforming [formula] analogously to [\eqref=eq:obs-gumbel] yields a random field [formula] with standard Gumbel margins. Thus, we end up with bivariate spatial random fields [formula] which are assumed to be independent and identically distributed for [formula].

A bivariate Brown-Resnick processes can be constructed in the following way [\citep=molchanov-stucki-2013] [\citep=genton-etal-2014]: Let [formula] be a Poisson point process on [formula] with intensity measure e- u  du. Further, let Wi, [formula], be independent copies of a bivariate zero mean Gaussian process [formula] such that the so-called pseudo cross-variogram [\citep=CBH89] [\citep=PKW93], γ(h)  =  (γij(h))i,j∈{1,2} defined by does not depend on [formula]. Analogously to the univariate Brown-Resnick process, it can be shown that the bivariate Brown-Resnick process [formula] defined by

[formula]

is max-stable and stationary and its law only depends on the pseudo cross-variogram γ.

The fact that (γij(h))i,j = 1,2 can be defined independently of [formula] implies that W is intrinsically stationary, i.e. the process [formula] is stationary for every [formula]. Both conditions, however, are not equivalent.

Indeed, [\cite=molchanov-stucki-2013] already gave necessary and sufficient conditions for a multivariate process of Brown-Resnick type to be stationary. For a fixed intensity e- u  du of the Poisson point process, the conditions on Gaussian processes given in Theorem 5.3 in [\cite=molchanov-stucki-2013] can be shown to be equivalent to the conditions on the process W stated above (if we additionally require Z to have standard Gumbel margins) by a straightforward computation. Thus, the Gaussian processes in the above definition of bivariate Brown-Resnick processes are essentially the only ones that yield a stationary max-stable process.

In the following, we investigate the structure and the asymptotic behavior of bivariate variograms that are translation invariant, refining the result by [\citet=PKW93] that lim h  →    ∞γ12(h)  /  γ11(h)  =  1 if γ11 is unbounded. This allows us to find valid models for bivariate Brown-Resnick processes. The following theorem, as well as the statements above, immediately extend to the general multivariate case. The proof is given in the Appendix.

Let [formula] be a bivariate second-order process on [formula] with pseudo cross-variogram (γij(h))i,j∈{1,2}, defined by [formula] which does not depend on [formula]. Then, we have for some univariate variogram γ0 and bounded functions [formula].

As the components of a translation invariant bivariate pseudo cross-variogram only differ by a function that may increase only with a rate of order [formula] (Theorem [\ref=thm:restriction]), a reasonable and not too restrictive model for the corresponding bivariate Gaussian random field [formula] is given by where V1 is a univariate Gaussian random field with stationary increments and semi-variogram γ0 and V2 is a bivariate stationary Gaussian random field with cross-covariance function C(h)  =  (Cij(h))i,j∈{1,2}, independent from V1. Then, the pseudo cross-variogram γ of W has the form

[formula]

Analogously to the univariate case, we propose to restrict to a parametric subclass of semi-variograms for γ0 such as

[formula]

where σ,κ  >  0 and β∈(0,1). Here, γ0 is a valid univariate variogram as [formula] is a variogram and λ  ↦  λ / (λ + 1)β is a Bernstein function [\citep=berg-etal-1984] [\citep=schilling-etal-2010]. Note that γ0 is a variogram of power law type modified to be smooth at the origin. For the bivariate cross-covariance C, we propose to use the parsimonious bivariate Matérn model [\citep=gneiting-etal-2010], which is a bivariate generalization of one of the most widely used models in geostatistics, the Matérn model [\citep=guttorp-gneiting-2006] [\citep=stein-1999]. To increase the flexibility of the model, we further add a spatially constant effect with variance c2 in the second component. Thus, C has the form

[formula]

where σ1,σ2,c  ≥  0, a > 0, ν1,ν2 > 0, ν12  =  (ν1  +  ν2) / 2 and |ρ|  ≤  2(ν1ν2)1 / 2 / (ν1  +  ν2). Note that as the common summand γ0 is smooth at the origin, the behavior of γii near the origin, i.e. the differentiability of W(i), depends only on the behavior of C which can be modeled flexibly by the smoothness parameters ν1 and ν2 of the bivariate Matérn model. In particular we have, as [formula] and for some k(ν) > 0, that [\citep=stein-1999]. Furthermore, the sample paths are m times differentiable if and only if ν  >  m [\citep=gelfand-etal-10]. The behavior of the γii as [formula], which has to be the same for all components by Theorem [\ref=thm:restriction], is parameterized by β as we have [formula] as [formula]. To increase the applicability of our model to real data located in [formula], we further allow for geometric anisotropy, replacing [formula] by [formula] where A(b,ζ) is the anisotropy matrix defined in [\eqref=eq:aniso]. Thus, we obtain the variogram model γ(ϑ;  ·  ) given by

[formula]

for i = 1,2 and [formula] where ϑ  =  (σ,κ,b,ζ,β,c,σ1,ν1,σ2,ν2,a,ρ).

Model Fitting

In the following, we will assume that data [formula] and [formula] for the maximal observed and forecasted variable of interest at stations li, [formula] and time period [formula] are available.

Fitting of the Univariate Model

Let henceforth be [formula]. We concentrate here on the estimation of the GEV and max-stable parameters assuming that the unknown mean m(li,d) and standard deviation s(li,p) of the underlying distribution F have already been estimated by (li,p) and (li,p), respectively. An example for the later estimates can be found in Section [\ref=sec:data].

Given the estimates (li,p) and (li,p), we obtain the standardized data

[formula]

which are assumed to be GEV distributed with parameters [formula], [formula] and [formula]. The parameters can be estimated via maximum likelihood separately for each station. As the the standardized data [formula] are assumed to be temporally independent, by [\cite=smith-1985], the maximum likelihood estimators [formula], 1  ≤  i  ≤  nl, are asymptotically normally distributed if [formula]. Thus, under the hypothesis that [formula] is the true shape parameter of the GEV at each station, the standardized residuals

[formula]

are approximately standard normally distributed, where [formula] is the variance of [formula] estimated via the Hesse matrix of the log-likelihood function. Thus, the three hypotheses that the shape parameter, the location and the scale parameter are spatially constant can be checked indirectly via one-sample Kolmogorov-Smirnov tests of the corresponding residuals for the standard normal distribution. Here, although the data for different locations may be dependent, we assume that the normalized estimated parameters are independent.

By transformation [\eqref=eq:obs-gumbel], the estimates [formula], [formula] and [formula] yield normalized data

[formula]

As a goodness-of-fit test of the marginal model, these can be compared to a standard Gumbel distribution via Kolmogorov-Smirnov tests separately for each station.

In order to capture the spatial dependence structure, a univariate Brown-Resnick process associated to a variogram [formula] as defined in [\eqref=eq:gamma-univ] is fitted to the transformed data [formula]. Note that there exist numerous methods of inference for Brown-Resnick processes, see, for example, [\citet=engelke-etal-2012] for a comparison of different estimators. The method we will use is based on the extremal coefficient function [\citep=schlather-tawn-2003]. For a stationary Brown-Resnick process associated to the semi-variogram [formula], the extremal coefficient function is given by

[formula]

where Φ denotes the standard normal distribution function [\citep=kab-etal-2009]. This relation can be used for fitting Brown-Resnick processes to real data as the extremal coefficients [formula] can be estimated well via the relation

[formula]

where the F-madogram νF,k(s1,s2) is defined by

[formula]

and F is the marginal distribution function of [formula] [\citep=cooley-etal-2006]. Thus, we obtain a plug-in estimator [formula] for the extremal coefficients [formula], by replacing νF,k in [\eqref=eq:fmado-theta] by an estimator F,k(li,lj), 1  ≤  i,j  ≤  nl. In order to avoid propagation of errors in marginal modeling, we choose the non-parametric estimator

[formula]

where Rp(x) denotes the rank of the p-th component of some vector x [\citep=ribatet-2013]. Then, the corresponding variogram parameter vector [formula] can be estimated by a weighted least squares fit of [formula] to [formula] as given in [\eqref=eq:theta-BR]. As proposed by [\citet=smith-1990], we choose weights that depend on the (estimated) variance [formula] of the estimator [formula]. Thus, we obtain the estimator

[formula]

We will further discuss the estimation of the variance of [formula] in Section [\ref=sec:data].

Fitting of the Bivariate Model

For fitting the bivariate Brown-Resnick process [formula] we consider the extremal coefficients θk1,k2(s,t) of Xk1(s) and Xk2(t) for [formula]. They can be estimated from the transformed data [formula] and [formula], 1  ≤  i  ≤  nl, 1  ≤  p  ≤  np, in the same way as in the univariate case. The resulting estimates k1,k2(li,lj), 1  ≤  i,j  ≤  nl, [formula] are compared to the corresponding extremal coefficients of a bivariate Brown-Resnick process associated to the variogram γ(ϑ;  ·  ) yielding the weighted least squares fit

The Post-Processing Procedure

As the bivariate Brown-Resnick process model developed in this paper describes the joint distribution of the observed and forecasted maxima of the variable of interest, it allows for some spatial post-processing of the original forecast. In this section, we will describe the resulting post-processing procedure in more detail and provide some tools to verify the procedure and the underlying model.

Post-Processing via Conditional Simulation

Let [formula], [formula], [formula], [formula], [formula], [formula] and [formula] be estimates for the GEV and variogram parameters derived from past training data. Further, assume that we have [formula], (li,p) and (li,p), [formula], based on forecasts for nl locations [formula] and a time period p in near future. Then, we obtain an arbitrary number K of realizations (vj(li))1  ≤  i  ≤  nl, [formula], of the modeled distribution of the maximal observation conditional on the forecast by the following three-step procedure:

Transform [formula] to standard Gumbel margins:

[formula]

where [formula] and [formula] are given by Equation [\eqref=eq:gev-gen-cond] for k = pred.

Conditional simulation of a bivariate Brown-Resnick process given its second component: Simulate K independent realizations [formula], [formula], of a bivariate Brown-Resnick process associated to the pseudo cross-variogram [formula] with standard Gumbel margins conditional on [formula].

Transform [formula] to GEV margins: For [formula], set

[formula]

where [formula] and [formula] are given by Equation [\eqref=eq:gev-gen-cond] for k = pred.

The random fields obtained by this three-step procedure can be interpreted as post-processed probabilistic forecasts for the maxima of the variable of interest. While the first and the third steps only consist of marginal transformations, the conditional simulation in the second step is the challenging part of the procedure. For this step, the algorithm by [\citet=dombry-etal-2013] can be used. Note that the algorithm, which has originally been designed for conditional simulation of univariate Brown-Resnick processes, can directly be transferred to the multivariate case by perceiving the multivariate processes as univariate processes on a larger index set. However, the computations will be computationally expensive, in particular if the number of conditioning locations gets large.

Verification

In practical applications, the proposed post-processing procedure and the underlying model need to be verified. Here, we do not only intend the full bivariate Brown-Resnick model which forms the base of the post-processing procedure, but also intermediate models such as the marginal GEV model and the univariate model. This allows us to evaluate the effect of incorporating the spatial dependence structure and the forecasted maxima, respectively.

For the evaluation and verification the different models, we choose the (negatively oriented) energy score [\citep=gneiting-raftery-2007]:

[formula]

where F is a [formula]-valued distribution, [formula] is an observation, χ∈(0,2) and [formula] denotes the Euclidean norm on [formula]. The energy score is a strictly proper scoring rule, i.e. [formula] for all distribution functions F and G with finite moments of order ξ and equality if and only if F = G. This indicates that the mean energy score for different observations is the smaller, the better the predicted distribution F fits to the true distribution of the observation data. Here, we will restrict ourselves to the case χ = 1. If F is additionally a univariate distribution, i.e. m = 1, the energy score is also called continuous ranked probability score (CRPS).

By fitting the GEV parameters according to Section [\ref=sec:fit], we obtain the following marginal model for the maximum at location li within time period p:

[formula]

First, we evaluate the improvement in predictive quality by fitting the GEV to the observations instead of the forecast, and thus compare [formula] and [formula] where

[formula]

for every station li, 1  ≤  i  ≤  nl, and [formula]. For the calculation, we employ the closed formula for the CRPS of a GEV provided by [\citet=friederichs-thorarinsdottir-2012]. For ξ  ≠  0, they obtain

[formula]

where Γl is the lower incomplete gamma function.

Furthermore, the CRPS for the GEV fitted to the observations can be compared with the CRPS of the original forecast

[formula]

where Forigli,p denotes the distribution of the original (probabilistic) forecast for the maximum of the variable of interest at location li within time period p. If this forecast is given by an ensemble of values, such as the output of a numerical weather prediction model, for example, Forigli,p corresponds to the empirical distribution function of this sample. If the forecast corresponds to a single value, CRPSorig(li) reduces to the mean absolute error.

For verification of the univariate Brown-Resnick model as a model for the spatial dependence structure, we propose to compare energy scores for the Brown-Resnick process with those of independent [formula] random variables. As we often do not have closed forms for the energy scores of the higher-dimensional marginal distributions, these cannot be calculated exactly but need to be approximated replacing the multivariate distribution F by an empirical distribution generated by simulations. We will denote the estimated energy scores belonging to the joint distribution at locations [formula] by [formula] for the Brown-Resnick process, and [formula] for the independence model, respectively.

Finally, the full bivariate model and, thus, the quality of the proposed post-processing procedure can be evaluated and verified by considering the CRPS where Fli,p|vpredmax denotes the distribution of the observed maximum at location li, 1  ≤  i  ≤  nl within time period p conditional on vpredmax, i.e. the distribution of the post-processed forecast, with the CRPS of the original forecast, CRPSorig(li).

Application to Real Data

In this section, we will apply the fitting and verification procedure described in Section [\ref=sec:fit] to real wind gust data consisting both of observation and forecast data. We will see that, even though the marginal distributions are fitted quite well, a forecast based on the single GEV for the observations is not able to outperform the forecast by the numerical weather prediction model. However, the results for the bivariate model indicate that the post-processing procedure proposed in Subsection [\ref=subsec:post] may improve the predictive quality.

The Data

We consider observed as well as forecasted wind speed data provided by Germany's National Meteorological Service, the Deutscher Wetterdienst (DWD). We use observations from 218 DWD weather stations over Germany at 360 days from March 2011 to February 2012. The weather stations register mean and maximum wind speed on an hourly basis. Due to the inertia of the measuring instruments, the maximum wind speed approximately corresponds to the highest 3-second average wind speed. Here, we use the maximum wind speed [formula] between 08 UTC and 18 UTC for each station l and each day d.

Furthermore, for each day, forecasts for the wind speed maxima and for the hourly mean wind speed both in 10m height above ground and for the 10-hour-period from 08 UTC to 18 UTC are available. The forecasts are provided by the COSMO-DE ensemble prediction system (EPS) operated by DWD. COSMO-DE [\citep=baldauf-etal-2011] is a non-hydrostatic limited-area numerical weather prediction model that gives forecasts for the next 21 hours on a horizontal grid with a width of 2.8km covering Germany and neighboring countries. For each variable of interest, the COSMO-DE EPS yields forecasts consisting of 20 ensemble members stemming from COSMO-DE runs with five different physical parameterizations and four different lateral boundary conditions provided by global model forecasts. For more details on the Consortium for Small-scale Modeling see http://www.cosmo-model.org/, and [\cite=gebhardt-etal-2011] and [\cite=peralta-etal-2012], for COSMO-DE EPS.

The COSMO-DE EPS is initialized every 3 hours. Here, we take the forecasts that are initialized at 00 UTC. If we use the forecasts for the nearest grid location of a station, we obtain the forecasts v(1)mean(l,d,τ), [formula], v(20)mean(l,d,τ), [formula], and [formula] for every weather station l and every day d. Here, v(j)mean(l,d,τ) and v(j)max(l,d) denote the forecast for the mean wind speed between (τ - 1) UTC and τ UTC and the maximal wind speed, respectively, at station l and day d, forecasted by the jth COSMO-DE ensemble member.

For the application of our model with a stationary spatial dependence structure, in the following, we will restrict ourselves to forecasted and observed data for 119 DWD stations north of [formula]N as the northern part of Germany has a much more homogeneous topography than the southern part. We will denote the locations of these stations by [formula].

Applying the Univariate Model

As the wind speed observations correspond to 3-second averages, the daily maximal wind gusts vobsmax can be perceived as the maximum of a long time series. Further, the distribution of a single wind speed is frequently modeled by a Weibull or a Gamma distribution [\citep=conradson-etal-1984] [\citep=pavia-etal-1986] [\citep=sloughter-etal-2007], that is, the single observations may be assumed to come from a location-scale family of distributions provided that the shape parameter is spatially and temporally constant. These considerations give support to the usage of the GEV model presented in Section [\ref=sec:univ] as a model for the maximal wind speed [formula], at station li, [formula], and day [formula]. For fitting a GEV distribution to the standardized wind speeds [formula] as defined in [\eqref=eq:std], we need the estimates (li,d) and (li,d) corresponding to the mean and the standard deviation of the underlying wind speed distribution. Here, instead of direct estimates for these characteristics, we use

[formula]

Even though not providing consistent estimates for mean and standard deviation, (li,d) and (li,d) ensure that [formula] is invariant under affine transformations of the underlying distribution as long as the transformation is reflected in the forecasts v(j)mean. This choice of (li,d) and (li,d) also ensures the identifiability of the GEV parameters [formula] and [formula]. Further, note that the choice of (li,d) as maximal mean of all the ensemble members is in complete accordance to the choice of [formula] in Equation [\eqref=eq:vmaxpred] below.

As described in Section [\ref=sec:fit], the GEV parameters for the standardized observations can be estimated via maximum likelihood and the hypotheses that these are spatially constant can be checked via Kolmogorov-Smirnov tests. For [formula], we obtain a p-value of 0.194. The analogous tests for [formula] and [formula] both yield p-values smaller than 2.2  ·  10- 16. Thus, the hypotheses that the residuals of the estimates of [formula] and [formula] follow a normal distribution both can be rejected and, consequently, we drop the assumption that the GEV has the same location and scale parameter at every station. In contrast, the shape parameter of the GEV will be assumed to be spatially constant in northern Germany with the value [formula]. Note, however, that the estimated shape parameter differs significantly (to a 5%-level) from the mean value in case of 20 stations. For six of these stations, it even differs highly significantly (to a 1%-level), and four of them even to a 0.1%-level. The parameter estimates (li) and σ̂(li), 1  ≤  i  ≤  119 for the location and scale parameters, respectively, obtained by maximum likelihood estimation with fixed shape parameter [formula] are depicted in Figure [\ref=fig:loc-scale-param]a. Note that the estimated vectors of location and scale parameters show a strong empirical correlation of 0.97. By [\eqref=eq:obs-gumbel], the data can be transformed to standard Gumbel margins. Kolmogorov-Smirnov tests performed separately for each station yield p-values of at least 0.098 with a mean value of 0.718 which indicates that the GEV model fits quite well for all the stations.

As a fit of the GEV distribution to the forecast is needed for both verification of the marginal model and the bivariate Brown-Resnick model, we repeat our analysis replacing the observed maximal wind speed [formula] by [formula], i.e. a forecast for the maximal wind speed at station li and day d. Here, we use the maximum over the 20 corresponding COSMO-DE ensemble members

[formula]

which ensures that the distribution of [formula] is close to a GEV distribution.

As the Kolmogorov-Smirnov test of the normalized estimates for [formula] yields a p-value of 0.53 and the estimates differ significantly from the mean for seven stations (for three of them very significantly), we may assume a shape parameter of [formula] at every station in Northern Germany. However, the hypotheses that the estimates for the location and the scale parameter follow a normal distribution have been both rejected. The maximum likelihood estimates [formula] and [formula], 1  ≤  i  ≤  119, with fixed shape parameter are shown in Figure [\ref=fig:loc-scale-param]b. Here, the empirical correlation of the vectors of estimated location and scale parameters is just as strong as in case of the observations. Kolmogorov-Smirnov tests of the transformed data [formula] for every station yield p-values of at least 0.142 with and equal 0.748 in average which also indicates an appropriate fit.

The spatial dependence is modeled by a univariate Brown-Resnick process which is obtained by a weighted least squares fit of the extremal coefficient function. Here, the weights depend on the variance of the estimators [formula] (see Section [\ref=sec:fit]) estimated by a jackknife procedure where the extremal coefficients are reestimated leaving out one month of data. The estimated extremal coefficients [formula] and the fitted extremal coefficient function

[formula]

are displayed in Figure [\ref=fig:obs-ecf]. Here, the estimated coefficients seem to be fitted quite well.

For verification, we first calculate the mean CRPS for each of the two models given by [\eqref=eq:gen-model], CRPSobs(li) and CRPSpred(li), for every station li, 1  ≤  i  ≤  119. Then, the improvement or deterioration by using the GEV distributions of the observations instead of the forecasts is expressed in terms of the skill score [\citep=gneiting-raftery-2007]

[formula]

which has the value 1 in case of an "optimal" model which equals [formula] a.s. and the value 0 if both models yield the same result. Here, Sli  >  0 for 115 of 119 stations. For the skill score corresponding to the mean CRPS averaged over all the stations, we obtain

[formula]

Note that, for simplicity, the reference model [\eqref=eq:gen-model] for the predictions is based on the maximal ensemble members [formula] only and further information given by the maximal wind speed forecasted by the other ensemble members are neglected. Thus, we further compare the CRPS of the GEV model for the observations, CRPSobs(li), with the CRPS of the original COSMO-DE ensemble, CRPSorig(li), taking the ensemble forecast as a probabilistic forecast with equal probability for each ensemble member. Here, the skill [formula] is positive for 37 of 119 only, with the skill of the averaged CRPS being [formula]. As the skill score is slightly negative, the COSMO-DE ensemble forecast seems to contain more information than our marginal model.

For the verification of the spatial model, for all pairs of locations (li,lj), 1  ≤  i  <  j  ≤  119, we estimate the energy scores BR(li,lj), based on 500 samples of a Brown-Resnick process, and compare them with the estimated scores ind(li,lj) for the independence model, based on 50 samples of each GEV distribution. We obtain a positive skill score for 5819 of 7002 pairs of stations (li,lj) with a skill score of 0.025 related to the mean energy score. Although this improvement by the univariate Brown-Resnick model compared to the independence model in terms of predictive skill seems negligible, realizations of gust fields look more realistic if spatial dependencies are respected.

Note that, for a fair comparison, we should avoid that training and validation of the model are based on the same data. Hence, we perform cross validation where the parameters are reestimated for every month, by leaving out the data for this month and using only the data for the other months for training. The GEV parameters estimated for different months in this way show very little variation corroborating the assumption that they are constant in time. Further, the verification results above are confirmed: We obtain skill scores of 0.285 in the CRPS case compared with the GEV model for the forecast, - 0.048 compared to the COSMO-DE ensemble and 0.035 in case of the bivariate energy scores.

Applying the Bivariate Model

A bivariate Brown-Resnick process is fitted to the transformed data according to Section [\ref=sec:fit]. The cross-variogram parameter estimate [formula] leads to the fitted extremal coefficient function

[formula]

Figure [\ref=fig:all-ecf] presents the estimated extremal coefficients k1,k2(li,lj), and the fitted extremal coefficient functions k1,k2(  ·  ,  ·  ) for [formula]. As illustrated, the fitted model seems to be appropriate with respect to the behavior of the extremal coefficient function. Figure [\ref=fig:biv-BR] depicts a simulated realization of the corresponding Brown-Resnick process associated to the variogram γ(;  ·  ) with standard Gumbel margins. The realization indicates a remarkable amount of positive correlation between [formula] and [formula] which emphasizes the gain of information by taking [formula] into account.

In order to verify the bivariate model, we apply the post-processing procedure proposed in Subsection [\ref=subsec:post]. However, due to the computational complexity of the conditional simulation, we do not simulate the observations at all stations simultaneously conditional on the forecast at all locations, but perform post-processing with sample size K = 100 at each location separately conditioning on the forecast at the same location and two neighboring grid cells only. We calculate the CRPS of the post-processed distribution, CRPSbiv(li), and compare it with CRPS(NWP)(li), i.e. the CRPS belonging to the empirical distribution of the original COSMO-DE ensemble, yielding a positive skill score for 103 of 119 stations where the skill score related to the mean CRPS equals 0.164 (0.148 cross-validated). Thus, we may conclude that the post-processing procedure based on the bivariate Brown-Resnick model is able to improve the forecast given by COSMO-DE ensemble.

Appendix: Proof of Theorem [\ref=thm:restriction]

For i,j∈{1,2}, and [formula], we obtain

[formula]

where we used the Cauchy-Schwarz inequality for both inequalities. Analogously, we get the assessment

[formula]

Thus, the assertion of the theorem follows with γ0  =  γ11.