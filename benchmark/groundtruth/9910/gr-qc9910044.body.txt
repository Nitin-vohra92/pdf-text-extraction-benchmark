Spherical Harmonic Decomposition on a Cubic Grid

UM PP-00-032; gr-qc/9910044

Introduction

Abrahams, Rezzola, Rupright, et al. [\cite=arr97] [\cite=rar98] [\cite=ram98] used spherical harmonics to interpolate between a 3D grid on which sources of gravitational radiation were modeled and a distant boundary on which outgoing wave boundary conditions were imposed.

While applying this method to a simplified model problem (scalar gravity [\cite=kwcm99]), we have developed an accurate and efficient method for extracting spherical harmonic amplitudes from the data on a rectangular grid. Spherical harmonic amplitudes are in principle defined as

[formula]

by integrating over a sphere of radius r. Here Φ is the scalar field whose spherical harmonic decomposition

[formula]

is desired.

Our method combines in one step the interpolation from the rectangular grid to the sphere and the integration over the sphere. It is motivated by the remark that a surface integral is the derivative of a volume integral

[formula]

Volume integrals are relatively straightforward on a rectangular grid. A finite difference approximation to ([\ref=eq:DVolIntegral]) gives an integral over a shell of finite thickness covering the sphere r =  constant. Our full implementation described below has some additional features.

Continuum Theory

In order to find spherical harmonic amplitudes Φlm(R,t) at a given fixed radius R, and also their radial derivatives ∂rΦlm(r)]r = R, we first consider a complete 3D "Fourier" decomposition of Φ(x,y,z,t) in a shell of thickness 2Δ around R. As a set of orthonormal functions on this shell we take the functions

[formula]

where the Rn are obtained from Legendre polynomials,

[formula]

which have the property

[formula]

as a consequence of the orthogonality of the Legendre polynomials

[formula]

Then the functions Ynlm are a complete orthonormal set of functions on the shell S  =  {R - Δ  ≤  r  ≤  R + Δ} using the inner product

[formula]

and its associated norm [formula]. When a function Φ(x,y,z) is smooth enough that the generalized Fourier series converges pointwise on the sphere r = R, one has

[formula]

so that the spherical harmonic amplitudes for Φ at r = R, i.e., the coefficients of Yml, are

[formula]

Since Rn(R)  =  0 for odd n, this sum in numerical applications will typically have only one or two terms, e.g., n = 0 and possibly n = 2.

The coefficients Φnlm are calculated from the volume integrals that are evaluated numerically on the rectangular grid:

[formula]

so

[formula]

Discretization

When the scalar function Φ(x,y,z) is known only at points x on a cubic grid G with spacing Δx  =  Δy  =  Δz  =  k, the inner product ([\ref=eq:InnerProduct]) for our generalized Fourier analysis is relaced by

[formula]

where each grid point must be given some weight wx. If a cube of volume k3 centered on the grid point lies entirely outside the shell S, the weight will be zero. If it lies entrely inside S, the weight will be its volume k3. For other grid points we found it overly complicated to calculate, for the associated cube, the volume which overlaps the shell R - Δ  ≤  r  ≤  R + Δ. We simply use the result for a grid point lying on one of the rectangular axes (i.e., we imagined the cube rotated so its edges were parallel or perpendicular to the radial direction). Thus we took

[formula]

where r is the Euclidean distance from the origin, and considered only the case k  <  2Δ.

With the inner product modified by this discretization, the function set ([\ref=eq:OrthoFunctions]) will no longer be orthonormal. One will find that

[formula]

is no longer a unit matrix. Here A and B are index groups (nlm) so that YA abbreviates the Ynlm(r,θ,φ) of ([\ref=eq:OrthoFunctions]). The mean square error (as measured by this new norm [\ref=eq:DiscreteInnerProduct]) in the representation

[formula]

is now minimized by the choice

[formula]

where GAB is the matrix inverse to GAB. This holds for any finite subset of the Ynlm one chooses to employ. Note that if one defines "adjoint" harmonics by

[formula]

then these coefficients in ([\ref=eq:PhiApproximation]) can be computed as

[formula]

Similarly, by defining

[formula]

in which the adjoint YA appear, not the original YA of equation ([\ref=eq:OrthoFunctions]), one calculates directly the spherical harmonic amplitudes of equation ([\ref=eq:PhiCoefficients]) by evaluating the sum

[formula]

It is important to notice that, in typical applications following the model of [\cite=arr97], the grid and the sphere r = R at which a spherical harmonic decomposition is used do not change while the function Φ or other fields are dynamically evolved or are relaxed toward a stationary state. Then a possible strategy is to store in memory the quantities Rlm(x)wx at each grid point within the integration shell so that the computation of spherical harmonic coefficients becomes

[formula]

where only Φ changes at each evolution or relaxation step and numerous other complications such as the GAB, the Rn(r), and the wx are buried in a large table which does not change at each iteration of the p.d.e., nor even at each run of the program.

Example

As a test to illustrate the application of these ideas, Mr. Keith Watt has run a test of the recovery of known spherical harmonic coefficients by these means. A cubic grid has each x,y,z coordinate varying at intervals of k = 0.2 in the range - 1.3  ≤  x,y,z  ≤   + 1.3. A known function Φ is evaluated at these 143  =  2744 grid points. The sphere on which the resolution into spherical harmonics was desired was specified by R = 1.0 and the thickness of the shell approximating this sphere was fixed by Δ  =  0.15 in the notations of equation ([\ref=eq:WeightingFunction]). Thus nonzero weight wg was assigned to grid points g at radii in the range 0.75  <  r  <  1.25, which includes about 800 points. The approximately 1720 points at r  >  1.25 and the approximately 220 points at r < 0.75 thus play no role in this anaylsis.

The choice Δ  =  (3 / 4)k was motivated by the fact that, in a one dimensional analogue of this analysis, this choice leads to Simpson's rule for the numerical integration and diagonalizes the [formula] matrix GAB when one uses only n  ≤  2.

The test problem used

[formula]

with 0  ≤  l  ≤  2 for a total of nine terms using real valued spherical harmonics. The input values Φlm and the recovered values Blm are shown in the table. The accuracy was less (0.1% rather than the typical 0.01% shown in the table) when the radial dependence was changed to (R / r)l + 1; but the function used for the table may be more like the behaviors expected in applications where the sphere in question is outside the strong source region but within a wavelength of the center.