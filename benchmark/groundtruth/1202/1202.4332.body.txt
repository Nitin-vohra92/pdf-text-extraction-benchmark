A parsimonious model for intraday European option pricing

Introduction

Market microstructure and high-frequency trading are fields experiencing an increase of interest within financial institutions and academic scholars (see [\cite=foresight11]). Therefore, models for tick-by-tick financial fluctuations, that might have been considered just a curiosity more than a decade ago (see the seminal paper by [\cite=engle98]), are becoming more and more important for practical purposes (see [\cite=scalas00] and [\cite=mainardi00] for early studies of the model presented below). The literature on high-frequency price modelling up to the middle of the last decade is reviewed in [\cite=hautsch04] and in [\cite=kokot04].

Along with interest in high-frequency trading comes the need for high-frequency hedging. In this work, we address the problem of determining the price for an intra-day European option written on a share traded in a stock exchange. It is assumed that the derivative position is opened at a time t after the start of continuous trading with maturity at a time TM before the end of continuous trading on the very same day. The fluctuations of the share price S(t) can be modeled by a suitable càdlàg (i.e. right-continuous with left limit) pure-jump process. One might be tempted to use a compound Poisson process for the logarithm of the price X(t)  =   log (S(t) / S(0)) and immediately apply the result of [\cite=merton1976] with the coefficients of drift and diffusion set to zero. For a vanishing risk-free interest rate (which is a reasonable assumption for intra-day data, see the discussion below), this would lead to the following formula for the plain-vanilla option price C(t)

[formula]

where λ is the activity of the Poisson process for trades, K is the strike price, μ and σ2 are, respectively, the expected value and the variance of the log-price jumps which are assumed to be normally distributed. One further has that

[formula]

where

[formula]

is the standard normal cumulative distribution function and, finally

[formula]

[formula]

Whereas Merton's jump diffusion model is still the object of active research and is discussed in a recent research paper by [\cite=cheang11], it has several unrealistic features. One of them is that unconditional inter-trade durations do not follow the exponential distribution (see [\cite=engle97] [\cite=engle98] [\cite=mainardi00] [\cite=raberto02] [\cite=scalas04a] [\cite=scalas06]). Semi-Markov models (described in [\cite=janssen07]) can take this fact into account as shown by [\cite=scalas04a] and [\cite=scalas11a]. In the following, we shall consider intra-day European options written on semi-Markov pure jump models which are compound renewal processes (see also [\cite=scalas11a] and [\cite=baleanu12]). Related papers are [\cite=montero08] and [\cite=cartea10]. In [\cite=montero08], the focus is on option prices for derivatives written on compound Poisson processes and in the presence on non-vanishing risk-free interest rate, whereas [\cite=cartea10] extends Lévy option prices to the semi-Markov case by developing suitable approximations. Finally, a recent paper by [\cite=shaw11] considers Laplace transform methods to deal with order and trade renewal flows in an agent-based model where the trade counting process is not necessarily Poisson.

The model proposed here has several distinctive advantages; for instance, each model entity has an immediate and clear translation into a microstructural quantity (there are no hidden variables of any kind); moreover, it is very parsimonious (leading to a many sound mathematical results); finally, the model is very flexible.

In what follows, section [\ref=tick] will present the model, section [\ref=option] will be devoted to pricing European options, and section [\ref=concl] will report a discussion of the results. We would like to stress that the derivations and computations below will involve only elementary probabilistic methods.

An Elementary but Comprehensive Model for Tick-by-tick Price Fluctuations

Let S(t) denote the price of an asset at time t and let X(t)  =   log (S(t) / S(0)) be the corresponding logarithmic price (or log-price), where S(0)  =  S(t = 0) will be assumed to be S(0)  =  1 without loss of generality. We can take as S(0) the opening price of the asset after the opening auction and before the beginning of continuous trading in a stock market. After continuous trading begins, trades will take place at specific epochs {Ti}Mi = 1 where M denotes the total number of trades within the day. We shall further assume that T0  =  0. The trading epochs can be seen as a point process (see [\cite=daley88]). Our first assumption is that these epochs are a renewal process (see [\cite=cox70]), meaning that the inter-trade durations Ji  =  Ti  -  Ti - 1 are independent and identically distributed (i.i.d.) positive random variables. Notice that, for the n-th epoch, one has

[formula]

even if the i.i.d. hypothesis is not satisfied. If the durations {Ji}∞i = 1 are i.i.d. random variables, there is a simple and convenient relationship between the distribution of durations and the distribution of epochs. Indeed, given two independent random variables U and V with respective cumulative distribution functions [formula] and [formula], one can compute the cumulative distribution function FW(w) of their sum W  =  U  +  V, which turns out to be the the measure convolution (a.k.a. Lebesgue-Stieltjes convolution) of the two distributions for U and V (see [\cite=bingham87]). Throughout this paper, we shall use the so-callled indicator-function method, a procedure allowing to write probabilities as expectations. Therefore, it is instructive to show in detail how the distribution of the sum of two independent random variables can be derived, even if this is a well-know result. The first step is to notice that the joint cumulative distribution function FU,V(u,v) is given by FU,V(u,v)  =  FU(u)FV(v) as a consequence of independence. The second step is to recall that the probability of an event A is given by the expected value of the indicator function IA, namely [formula] and that the indicator function of the intersection of two events A and B is the product of the parent indicator functions, i.e. we have [formula]. The last step is to notice that the event {W  ≤  w} is equivalent to [formula]. Therefore, one has the following chain of equalities

[formula]

To denote the convolution, which is an operation symmetric in U and V, we can introduce the symbol [formula]:

[formula]

This formula holds true also if U and V are positive random variables. In such a case one has that FU(u)  =  0 for u  <  0 and that FV(v)  =  0 for v < 0 (notice that FU(0) and FV(0) may be positive). Then equation [\eqref=convolutionsymbol] becomes

[formula]

Now, let FJ(x) denote the cumulative distribution function of the duration, i.e. [formula]; moreover, let FTn(t) denote the cumulative distribution function of the n-th epoch, i.e. [formula]. Then, FTn(t) is given by the n-fold convolution of FJ(t), that is by

[formula]

Equation [\eqref=measureconvolution] can be proved by means of the iterated application of equation [\eqref=convpos].

A price S(Ti) corresponds to each trading epoch Ti. Let Yi  =   log (S(Ti) / S(Ti - 1)) represent the tick-by-tick logarithmic return, then the log-price X(t) is given by

[formula]

where the counting process N(t) is defined as

[formula]

and counts the number of trades since the beginning of continuous trading. The relationship between the log-price and the price is

[formula]

We shall further assume that {Yi}N(t)i = 1 is a sequence of i.i.d. random variables such that [formula]. Let Ft denote the natural filtration of the process S(t) up to time t, this being the σ-field generated by the random variables [formula] and [formula].

In general, with the above hypotheses, S(t) given by equation [\eqref=priceequation] is not a martingale. In fact one has for s  <  t

[formula]

and the martingale condition is statisfied only if for every s,t such that s  <  t, one has

[formula]

this is the case if [formula]. However, one can always find an equivalent martingale measure (e.m.m.). One can replace Yi in equation [\eqref=logprice] with Yi  -  a defining the following processes, a modified log-price process

[formula]

as well as the corresponding modified price process

[formula]

Now, if [formula], one has that [formula] is a martingale. In fact, one can write

[formula]

Armed with this e.m.m., it is possible to move on and price options written on the process defined above using the martingale method.

Martingale Option Pricing

For an intra-day time horizon, we can safely assume that the risk-free interest rate is zero; even if such a return rate were rY  =  10% on a yearly time horizon, meaning that the institution or government issuing this instrument is close to default (so that, it would not be so riskless, after all) or that the inflation rate is quite high, the interest rate for one day would be rd  ≈  1 / (10  ·  200)  =  5  ·  10- 4 (200 is the typical number of working days in a year) and this number has still to be divided by 8 (number of trading hours) and then by 3600, if the goal is approximating the rate at the time scale of one second. This gives rs  ≈  1.7  ·  10- 8. On the other hand, typical tick-by-tick returns in a stock exchange are larger than the tick divided by the price of the share. Even if we assume that the share is worth 100 monetary units, with a 1/100 tick size (the minimum price difference allowed), we shall have a return r larger than 1  ·  10- 4 and much larger than rs; therefore, it is safe to assume a vanishing risk-free interest rate.

We shall focus on the price of an intra-day European call option assuming that the position is taken at a time t coinciding with or close to the beginning of the day and that it is closed at a later fixed time (the maturity) within the same day, which we shall denote by TM (not to be confused with the epochs Ti, in general TM is not an epoch). Notice that the condition t  <  TM must always be fulfilled.

Let [formula] represent the pay-off of a European call option at maturity. For instance, given the strike price K, the pay-off of a plain-vanilla European option is [formula]. Then, the option price C(t) at a time t  <  TM is given by the discounted conditional expected value of the pay-off at maturity with respect to the e.m.m., that is

[formula]

where r is the risk-free interest rate. In our case r = 0, so that equation [\eqref=optionprice] simplifies to

[formula]

In order to evaluate equation [\eqref=optionpriceour], we consider two cases:

t coincides with a renewal epoch;

t does not coincide with a renewal epoch,

with the second case being the only realistic one, but the first one is discussed in the recent literature as a starting point for developing approximations as in [\cite=cartea10].

If the option price is evaluated from a renewal epoch, we can assume that t = 0 without loss of generality and the option price is given by the following integral

[formula]

where [formula] is the cumulative distribution function of the random variable [formula]. In order to obtain this quantity, we can first define

[formula]

[formula] is the product of i.i.d. random variables and its cumulative distribution function is the n-fold Mellin convolution of [formula], the common cumulative distribution function of [formula]; the Mellin transform is discussed in [\cite=springer66] and in [\cite=lomnicki67]. We shall write

[formula]

Since the number of trades from 0 to TM can be an arbitrary integer, by purely probabilistic arguments, one can show that [formula] is given by

[formula]

as a consequence of the mutual independence of tick-by-tick log-returns and inter-trade durations. Notice that the zero-fold Mellin convolution is a cumulative distribution function which is 0 for u = 0 and 1 for u > 0. To see that this is the case, consider equation [\eqref=optionpriceatrenewal] when it is known that n = 0. Then S(TM)  =  S(0)  =  1 and the payoff is [formula]. However, the probability [formula] of the event N(TM)  =  0 decreases with increasing TM and the contribution to the conditional expectation [\eqref=optionpriceatrenewal] is [formula]. In order to use equation [\eqref=case1measure], we still need to compute the probabilities of the events {N(TM)  =  n}. This can be again done by means of the indicator-function method. In fact, one has that

[formula]

Therefore, the following chain of equalities holds true

[formula]

In the general case in which t is a generic observation time not coinciding with a renewal epoch, things become trickier, even if we are using a simplified and stylized model. At time t, both the price S(t) and the number of trades N(t)  =  nt are known. We can consider the random variable ΔX(t,TM)  =  X(TM)  -  X(t)  =   log (S(TM) / S(t)). If S(t) is used as numeraire (that is if we set S(t)  =  1), Equation [\eqref=optionpriceatrenewal] modifies to

[formula]

where the cumulative distribution function [formula] is given by

[formula]

Again, as in the case of equation [\eqref=optionpriceatrenewal], this equation can be justified by purely probabilistic arguments. However, one has to compute the conditional probability [formula]. As derived in [\cite=kaizoji11], this is given by

[formula]

where [formula] is given by equation [\eqref=countingdistribution] with TM replaced by TM  -  (t + u) and [formula] is the cumulative distribution function of the residual life-time at time t conditioned on the fact that there were nt trades up to time t which we denote by Jt,nt. The residual life time is the time interval from t to the next renewal epoch TN(t) + 1. As discussed in [\cite=kaizoji11], its distribution crucially depends on what is known of the previous history. In our specific case, as anticipated above, it is meaningful to assume that we do know the total number of trades up to time t, as this is usually public information. Before deriving FJt,nt(u), it is important to discuss the meaning of equation [\eqref=countingcond]. The right-hand side contains the probability of having n - 1 trades between the renewal epoch t + u and maturity TM. Since the value u of the residual life time Jt,nt is not known, this probability must be convolved with the probability of the event {Jt,nt  =  u}. It turns out that even the cumulative distribution function FJt,nt(u) can be found by direct elementary probabilistic tools without using Laplace-tranform methods. We can see that the event {Jt,nt  ≤  u} can be described in term of a conditional event (see [\cite=definetti95])

[formula]

Equation [\eqref=conditionalevent] can be written in terms of epochs using [\eqref=countingevent]

[formula]

One can now use the definition of conditional probability and the indicator-function method to compute FJt,nt(u) directly. First of all, one can write

[formula]

and the denominator is already given by equation [\eqref=countingdistribution], meaning that one has

[formula]

In order to compute the numerator, one can use the following equality between events

[formula]

and obtain that

[formula]

Combining equations [\eqref=denominator] and [\eqref=numerator1], one finally gets from equation [\eqref=residuallifetime]

[formula]

Equation [\eqref=residuallifetimefinal] is the last ingredient needed to determine the option price in the general case [\eqref=optionpricegeneral]. Finally, note that equation [\eqref=optionpricegeneral] yields equation [\eqref=mertonformula] when J  ~   exp (λ) and Y  ~  N(μ,σ2) (see [\cite=baleanu12], chapter 7).

Discussion and Outlook

Equation [\eqref=optionpricegeneral] is our main results and gives a martigale price for intraday European options when assuming the parsimonious model of section [\ref=tick]; we have been able to explicitly derive all the terms in that equation by repeated application of the indicator-function method. Even if such an equation may seem cumbersome, we already showed that it can be used in practice in [\cite=kaizoji11]. A more detailed numerical analysis will be the subject of future research.

However, some assumptions in section [\ref=tick] are unrealistic even if they ensure analytical tractability. For example, it is assumed that the durations {Ji}∞i = 1 and the tick-by-tick log-returns {Yi}∞i = 1 are i.i.d. random variables and that they are mutually independent. In [\cite=engle97]. [\cite=engle98], [\cite=raberto02] and [\cite=meerschaert06], as well as in many other empirical papers on financial econometrics (see [\cite=campbell96]), it is shown that this is not the case. There is heteroscedasticity and there is dependence between the activity and the volatility. Suitable mixture models based on the compound Poisson processes can take all that into account as discussed in [\cite=scalas07], but models using heteroscedastic procesess subordinated to Hawkes processes could be a viable alternative as well (see [\cite=munitoke11] and references therein).

This paper is the crowning achievement of an activity on modelling ultra-high frequency financial data by means of continuous time random walks that started back in 1998. Continuous time random walks is the name that physicists use for compound renewal processes, even if some authors reserve this name to more general processes with finite or infinite memory subordinated to counting processes. As briefly discussed above, these processes allow the derivation of many non-trivial analytical results, but they are not general enough to take into account all the features of high-frequency financial data. In 1998, the idea was to use these processes for intra-day option pricing, but only in 2011, with the results published in [\cite=kaizoji11], it became possible to present martingale option pricing in the simple way based on renewal theory outlined in this paper.

Acknowledgement

This work was partially funded by MIUR Italian grant PRIN 2009 on Finitary and non-Finitary Probabilistic Methods in Economics within the project The Growth of Firms and Countries: Distributional Properties and Economic Determinants. One of the authors (E.S.) gratefully acknowledges discussion with Giacomo Bormetti, Giacomo Livan and Fabio Rapallo.