The Frobenius Problem, Rational Polytopes, and Fourier-Dedekind Sums

Appeared in Journal of Number Theory (2002), 1-21. Parts of this work appeared in the first author's Ph.D. thesis.

Introduction

Let [formula] be positive integers, [formula] be the n-dimensional integer lattice, and

[formula]

a rational polytope with vertices

[formula]

For a positive integer [formula], let [formula] be the number of lattice points in the dilated polytope tP  =  {tx:x∈P}. Denote further the relative interior of P by [formula] and the number of lattice points in [formula] by [formula]. Then [formula] and [formula] are quasipolynomials in t of degree n [\cite=ehrhart], i.e. expressions

[formula]

where [formula] are periodic functions in t. In fact, if the ak's are pairwise relatively prime then [formula] are constants, so only c0 will show this periodic dependency on t.

Let [formula] be a set of relatively prime positive integers, and

[formula]

The function pA'(t) can be described as the number of restricted partitions of t with parts in A, where we require that each part is used at least once. (We reserve the name pA for the enumeration function of those partitions which do not have this restriction.) Geometrically, pA'(t) enumerates the lattice points on the skewed facet of P. Define [formula] to be the largest value of t for which

[formula]

In the 19th century, Frobenius inaugurated the study of [formula]. For n = 2, it is known (probably at least since Sylvester [\cite=sylvester]) that f(a1,a2)  =  a1a2. For n > 2, all attempts for explicit formulas have proved elusive. Here we focus on the study of pA'(t), and show that it has an explicit representation as a quasipolynomial. Through the discussion of pA'(t), we gain new insights into Frobenius's problem.

Another motivation to study pA'(t) is the following trivial reduction formula to lower dimensions:

[formula]

Here we use the convention that pA'(t)  =  0 if t  ≤  0. This identity can be easily verified by viewing pA'(t) as

[formula]

Hence, precise knowledge of the values of t for which pA'(t)  =  0 in lower dimensions sheds additional light on the Frobenius number in higher dimensions.

The number pA'(t) appears in the lattice point count of P. It is for this reason that we decided to focus on this particular rational polytope. We present two methods (Sections [\ref=mattSec] and [\ref=sinaiSec]) for computing the terms appearing in [formula] and [formula]. Both methods are refinements of concepts that were earlier introduced by the authors [\cite=beck] [\cite=diaz]. In contrast to the mostly algberaic-geometric and topological ways of computing [formula] and [formula] [\cite=barv] [\cite=bv] [\cite=cs] [\cite=guill] [\cite=kk] [\cite=kp], our methods are analytic. In passing, we recover the Ehrhart-Macdonald reciprocity law relating [formula] and [formula] [\cite=ehrhart] [\cite=macdonald]. Within the computations a Dedekind-like finite Fourier sum appears, which shares some properties with its classical siblings, discussed in Section [\ref=FDSum]. In particular, we prove two reciprocity laws for these sums: a rederivation of the reciprocity law for Zagier's higher-dimensional Dedekind sums [\cite=zagier], and a new reciprocity law that generalizes a theorem of Gessel [\cite=gessel]. Finally, in Section [\ref=lastsec] we give bounds on these generalized Dedekind sums and apply our results to give new bounds for the Frobenius number. The literature on such bounds is vast--see, for example, [\cite=shockley] [\cite=davison] [\cite=erdos] [\cite=kannan] [\cite=rodseth1] [\cite=rodseth2] [\cite=selmer] [\cite=vitek].

The residue method

In [\cite=beck], the first author used the residue theorem to count lattice points in a lattice polytope, that is, a polytope with integer vertices. Here we extend these methods to the case of rational vertices.

We are interested in the number of lattice points in the tetrahedron P defined by ([\ref=polytope]) and integral dilates of it. We can interpret

[formula]

as the Taylor coefficient of zt of the function

[formula]

Equivalently

[formula]

If this expression counts the number of lattice points in [formula], then the remaining task is to compute the other residues of

[formula]

and use the residue theorem for the sphere [formula]. F - t has poles at 0 and all [formula] roots of unity. It is particularly easy to get precise formulas if the poles at the nontrivial roots of unity are simple. For this reason, assume in the following that [formula] are pairwise relatively prime. Then the residues for the [formula] roots of unity are not hard to compute: Let [formula], then

[formula]

If we add up all the nontrivial [formula] roots of unity, we obtain

[formula]

where ξ is a primitive [formula] root of unity. This motivates the following

Let [formula] be relatively prime to [formula], and [formula]. Define the Fourier-Dedekind sum as

[formula]

Some properties of σt are discussed in Section [\ref=FDSum]. With this notation, we can now write

[formula]

We get similar residues for the [formula] roots of unity. Finally, note that Res(F- t,z =   ∞  ) = 0, so that the residue theorem allows us to rewrite ([\ref=LPbar]):

Let P be given by ([\ref=polytope]), with [formula] pairwise relatively prime. Then

[formula]

where [formula], and âj means we omit the term aj.

Remarks. 1. R - t can be easily calculated via

[formula]

To facilitate the computation in higher dimensions, one can use mathematics software such as Maple or Mathematica. It is easy to see that [formula] is a polynomial in t whose coefficients are rational expressions in [formula]. The first values for R - t are

[formula]

2. If [formula] are not pairwise relatively prime, we can get similar formulas for [formula]. In this case we do not have only simple poles, so that the computation of the residues gets slightly more complicated.

For the computation of [formula] (the number of lattice points in the interior of our tetrahedron tP), we similarly write

[formula]

So now we can interpret [formula] as the Taylor coefficient of zt of the function

[formula]

or equivalently as

[formula]

To be able to use the residue theorem, this time we have to consider the function

[formula]

The residues at the finite poles of Ft can be computed as before, with t replaced by - t, and the proof of the following theorem is completely analogous to Theorem [\ref=closure]:

Let P be given by ([\ref=polytope]), with [formula] pairwise relatively prime. Then

[formula]

As an immediate consequence we get the remarkable

[formula]

This result was conjectured for convex rational polytopes by Ehrhart [\cite=ehrhart], and first proved by Macdonald [\cite=macdonald].

Of particular interest is the number of lattice points on the boundary of tP. Besides computing [formula] and [formula] and taking differences, we can also adjust our method to this situation, especially if we are interested in only parts of the boundary. As an example, we will compute pA'(t) as defined in the introduction ([\ref=N_t]), which appears in the context of the Frobenius problem. Again, for reasons of simplicity we assume in the following that [formula] are pairwise coprime positive integers.

This time we interpret

[formula]

as the Taylor coefficient of zt of the function

[formula]

That is,

[formula]

Thus, we have to find the other residues of

[formula]

since

[formula]

Gt has its other poles at all [formula] roots of unity. Again, note that Gt has simple poles at all the nontrivial roots of unity. Let λ be a nontrivial [formula] root of unity, then

[formula]

Adding up all the nontrivial [formula] roots of unity, we obtain

[formula]

Together with the similar residues at the other roots of unity, ([\ref=N_tRes]) gives us

[formula]

where [formula].

R' is as easily computed as before, the first values are

[formula]

A general formula for [formula] was recently discovered in [\cite=bgk].

For generalizations, note that we can apply our method to any tetrahedron given in the form ([\ref=polytope]), with the ak's replaced by any rational numbers. Moreover, any convex rational polytope (that is, a convex polytope whose vertices have rational coordinates) can be described by a finite number of inequalities over the rationals. In other words, a convex lattice polytope P is an intersection of finitely many half-spaces. This description of the polytope leads to an integral in several complex variables, as discussed in [\cite=beck] for lattice polytopes.

The Fourier method

In this section we outline a Fourier-analytic method that achieves the same results. Although the theory is a little harder, the method is of independent interest. It draws connections to Brion's theorem on generating functions [\cite=brion] and to the basic results of [\cite=diaz].

To be concrete, we illustrate the general case with the 2-dimensional rational triangle P whose vertices are v0  =  (0,0), [formula], and [formula]. As before, the number of lattice points in the 1-dimensional hypotenuse of this right triangle is

[formula]

We denote the tangent cone to P at the vertex vi by Ki. We recall that the exponential sum attached to the cone K (with vertex v) is by definition

[formula]

where s is any complex vector that makes the infinite sum ([\ref=cone]) converge. An equivalent formulation of ([\ref=cone]) which appears more combinatorial is

[formula]

where [formula] and xj  =  e  -  2πsj.

In general dimension, let the vertices of the rational polytope P be [formula]. Let the corresponding tangent cone at vj be Kj. Finally, let the finite exponential sum over P be

[formula]

Then there is the basic result that each exponential sum ([\ref=cone2]) is a rational function of x, and the following theorem relates these rational functions [\cite=brion]:

For a generic value of [formula],

[formula]

This result allows us to transfer the enumeration of lattice points in P to the enumeration of lattice points in the tangent cones Ki at the vertices of P, an easier task. In the theorem above, 'generic value of s' means any [formula] for which these rational functions do not blow up to infinity.

To apply these results to our given rational triangle P, we first employ the methods of [\cite=diaz] to get an explicit formula for the exponential sum for each tangent cone of P. Then, by Brion's theorem on tangent cones, the sum of the three exponential sums attached to the tangent cones equals the exponential sum over P. Canceling the singularities arising from each tangent cone, and letting s  →  1, we get the explicit formula of the previous section for the number of lattice points in the rational triangle P.

In our case, K1 is generated by the two rational vectors  - v1 and v2  -  v1. We form the matrix

[formula]

whose columns are the vectors that generate the cone K1. Once we compute σK1(s), σK2(s) will follow by symmetry. The easiest exponential sum to compute is

[formula]

To compute σKi(s) ([formula]), we first translate the cone Ki by the vector   -  vi so that its new vertex is the origin. We therefore let K  =  Ki  -  vi, and the following elementary lemma illustrates how a translation affects the Fourier transform. Let

[formula]

denote the characteristic function of K.

Let

[formula]

for [formula]. Then

[formula]

[formula]

This lemma also shows why it is useful to study the Fourier transform of K at complex values of the variable; that is, at ξ  +  is. We study F(x) because ([\ref=cone]) can be rewritten as

[formula]

All of the lemmas of [\cite=diaz] remain true in this rational polytope context. The idea is to apply Poisson summation to [formula] and write formally

[formula]

The right-hand side diverges, though, and some smoothing completes the picture. Because the steps are identical to those in [\cite=diaz], we omit the ensuing details. Let [formula]. We get

[formula]

where

[formula]

and

[formula]

By ([\ref=brioneq]), we have

[formula]

Using the explicit description of σKi(s) in terms of cotangent functions, we can cancel their singularities at s = 0 and simply add the holomorphic contributions to σKi(s) at s = 0. The left-hand side of ([\ref=brioneq]) is holomorphic in s, so that we are guaranteed that the singularities on the right-hand side cancel each other.

The only term in the finite sum ([\ref=coth]) that contributes a singularity at s = 0 is the r = 0 term. We expand the three exponential sums σKi(s) into their Laurent expansions about s = 0. Here we only require the first 3 terms of their Laurent expansions. In dimension n we would require the first n + 1 terms; otherwise every step is the same in general dimension n.

We make use of the Laurent series

[formula]

near s = 0, as well as the Laurent series for  cot πs near s = 0. After expanding each cotangent in ([\ref=coth]) for σK0(s), σK1(s) and σK2(s) and letting s  →  0, we obtain Theorem [\ref=closure] above as

[formula]

Note that, as before, the periodic portion of [formula] is entirely contained in the "constant" t term. By Ehrhart's reciprocity law (Corollary [\ref=ehr], [\cite=ehrhart]), there is a similar expression for L(P,t), and taking

[formula]

gives us p{a,b}(t). The same analysis gives us Theorem [\ref=closure] in [formula].

The Fourier-Dedekind sum

In the derivation of the various lattice count formulas, we naturally arrived at the Fourier-Dedekind sum

[formula]

This expression is a generalization of the classical Dedekind sum [formula] [\cite=grosswald] and its various generalizations [\cite=dieter] [\cite=gessel] [\cite=meyer] [\cite=rademacher] [\cite=zagier]. In fact, an easy calculation shows

[formula]

In general, note that [formula] is a rational number: It is an element of the cyclotomic field of [formula] roots of unity, and invariant under all Galois transformations of this field.

Some obvious properties are

[formula]

We can get more familiar-looking formulas for σt in certain dimensions. For example, counting points in dimension 1, we find that

[formula]

so that Theorem [\ref=closure] implies

[formula]

Here, ((x))  =  x  -  ⌊x⌋  -  1 / 2 is a sawtooth function (differing slightly from the one appearing in the classical Dedekind sums). This restates the well-known finite Fourier expansion of the sawtooth function (see, e.g., [\cite=grosswald]).

As another example, we reformulate

[formula]

by means of finite Fourier series. Consider

[formula]

where ξ is a primitive [formula] root of unity and [formula] mod c; here, the last equality follows from ([\ref=fouriersingle]). We use the well-known convolution theorem for finite Fourier series:

Let [formula] and [formula], where ξ is a primitive [formula] root of unity. Then

[formula]

Hence by ([\ref=fourierhelp]),

[formula]

Here, [formula] mod c. The last equality follows from

[formula]

Furthermore, by the periodicity of ((x)),

[formula]

The expression on the right is, up to a trivial term, a special case of a Dedekind-Rademacher sum [\cite=dieter] [\cite=knuth] [\cite=meyer] [\cite=rademacher]. It is a curious fact that the function σt(a,b;c) is the nontrivial part of a multiplier system of a weight-0 modular form [\cite=robins].

We conlude this section by proving two reciprocity laws for Fourier-Dedekind sums. The first one is equivalent to Zagier's reciprocity law for his higher dimensional Dedekind sums [\cite=zagier]. They are essentially Fourier-Dedekind sums with t = 0, that is, trivial numerators.

For pairwise relatively prime integers [formula],

[formula]

where R't is the rational function given in Theorem [\ref=frobnr].

It is well known [\cite=ehrhart] that the constant term of a lattice polytope (that is, a polytope with integral vertices) equals the Euler characteristic of the polytope. Consider the polytope

[formula]

whose dilates correspond to the quantor pA'(t) of Theorem [\ref=frobnr]. If we dilate this polytope only by multiples of [formula], say [formula], we obtain the dilates of a lattice polytope. Theorem [\ref=frobnr] simplifies for these t to

[formula]

using the periodicity of σt ([\ref=period]). On the other hand, we know that the constant term (in terms of w) is the Euler characteristic of the polytope and hence equals 1, which yields the identity

[formula]

The second one is a new reciprocity law, which generalizes the following [\cite=gessel]

Let m and n be relatively prime and suppose that 0  ≤  r  <  m + n. Then

[formula]

It is not hard to see that Gessel's theorem follows as the two-dimensional case of

Let [formula] be pairwise relatively prime integers and [formula]. Then

[formula]

where R't is the rational function given in Theorem [\ref=frobnr].

By definition, pA'(t)  =  0 if [formula]. Hence Theorem [\ref=frobnr] yields an identiy for these values of t:

[formula]

It is worth noticing that both Theorems [\ref=zag] and [\ref=ges] imply the reciprocity law for the classical Dedekind sum [formula]. It should be finally mentioned that in special cases there are other reciprocity laws, for example, for the sum appearing on the right-hand side in ([\ref=fouriertriple]) [\cite=dieter] [\cite=rademacher]. We note that, as a consequence, we can compute σt(a,b;c) in polynomial time.

The Frobenius problem

In this last section we apply Theorem [\ref=frobnr] (the explicit formula for pA'(t)) to Frobenius's original problem. As an example, we will discuss the 3-dimensional case. Note that a bound for dimension 3 yields a bound for the general case: It can be easily verified that

[formula]

Furthermore, in dimension 3 it suffices to assume that a1,a2,a3 are pairwise coprime, due to Johnson's formula [\cite=johnson]: If g  =  (a1,a2), then

[formula]

Now assume a,b,c pairwise relatively prime, and recall ([\ref=fouriertriple]):

[formula]

where [formula] mod c. We will use the Cauchy-Schwartz inequality

[formula]

Here [formula], and π∈Sn is a permutation. Since (a- 1b,c)  =  1, we can use ([\ref=perm]) to obtain

[formula]

This also restates Rademacher's bound on the classical Dedekind sums [\cite=grosswald]. Using this in the formula for dimension 3 (remark after Theorem [\ref=frobnr]), we get

[formula]

The larger zero of the right-hand side is an upper bound for the solution of the Frobenius problem:

[formula]

For the last inequality, we used the fact that [formula]. This proves, using ([\ref=threegen]) and ([\ref=coprimegen]),

Let [formula] be relatively prime. Then

[formula]

Remarks. 1. Sometimes the Frobenius problem is stated in a slightly different form: Given relatively prime positive integers [formula], find the largest value of t such that [formula] has no solution in nonnegative integers [formula]. This number is denoted by [formula]. It is, however, easy to see that

[formula]

So we can restate Theorem [\ref=estimate] in a more compact form as

[formula]

2. Bounds on the Frobenius number in the literature include results by Erds and Graham [\cite=erdos]

[formula]

Selmer [\cite=selmer]

[formula]

and Vitek [\cite=vitek]

[formula]

Theorem [\ref=estimate] is certainly of the same order. What might be more interesting, however, is the fact that the bound in Theorem [\ref=estimate] is of a different nature than the bounds stated above: namely, it involves three variables, and is thus--especially in terms of estimating g(a1,a2,a3)--more symmetric.