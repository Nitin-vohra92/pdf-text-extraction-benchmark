Lemma Formula Conjecture Algorithm Definition Proposition Corollary Notation Remark Assumption Question

A generalisation of a congruence due to Vantieghem only holding for primes

The subject of primality testing has been in the mathematical and general news recently, with the announcement [\cite=AKS2002] that there exists a polynomial-time algorithm to determine whether an integer p is prime or not.

There are older deterministic primality tests which are less efficient; the classical example is Wilson's Theorem, that

[formula]

Although this is a deterministic algorithm, it does not provide a workable primality test because it requires much more calculation than trial division.

This note provides another congruence satisfied by primes and only by primes; it is a generalisation of previous work. In Guy [\cite=guy-unsolved], problem [formula], the following result due to Vantieghem [\cite=vantieghem] is quoted:

Let n be a natural number greater than 2. Then n is prime if and only if

[formula]

In this note, we will generalise this result to obtain the following theorem:

Let m and n be natural numbers greater than 2. Then n is prime if and only if

We follow the method of Vantieghem, using a congruence satisfied by cyclotomic polynomials.

Let m be a natural number greater than 1 and let Φm(X) be the mth cyclotomic polynomial. Then

[formula]

We can write

[formula]

where the fi are polynomials over [formula].

Let ζ be a primitive mth root of unity. Now, if Y = ζ then we see that the left hand side of this expression is identically 0 in X.

This implies that the fi are zero at every ζ and every i. Therefore, we have [formula], which is enough to prove the Lemma.

If p is prime, then we have that [formula]. Therefore, if we set m = p in the Lemma, we find that

[formula]

We now set X = 1 and Y = m, to get

[formula]

this proves that if p is prime then the congruence holds.

We now prove the converse, by supposing that the congruence [formula] holds, and that p is not prime. Therefore p is composite, and hence has a smallest prime factor q. We write p = q  ·  a; now q  ≤  a, and also p  ≤  a2.

Now we have that ma - 1 divides mp - 1 and ma - 1 divides the product [formula]. By combining this with the congruence [formula] in the Theorem, this implies that (ma - 1) / (m - 1) divides p. Therefore we have

[formula]

Now this is only possible, when m  ≥  3, for m = 3 and a = 2. It can be easily checked that the congruence does not hold in this case, so we have proved the Theorem.

Guy also asks if there is a relationship between the congruence given by Vantieghem and Wilson's Theorem. The following theorem gives an elementary congruence similar to that of Vantieghem between a product over integers and a cyclotomic polynomial. It is in fact equivalent to Wilson's Theorem.

Let m be a natural number greater than 2. Then m is prime if and only if

[formula]

Firstly, we prove that if m is not prime, the congruence [formula] in Theorem [\ref=wilson-equiv] does not hold.

Recall that φ(m) is defined to be Euler's totient function; the number of integers in the set [formula] which are coprime to m.

The coefficient of Xφ(m) - 1 on the right-hand side is given by the sum

[formula]

the final inequality holds because if (i,m) = 1 then ( - i,m) = 1 as well, and the case [formula] does not occur because then we have [formula] and therefore [formula] which is false because m is greater than 2.

We now use some theorems to be found in a paper by Gallot [\cite=gallot] (Theorem 1.1 and Theorem 1.4):

Let p be a prime and m be a natural number.

The following relations between cyclotomic polynomials hold:

[formula]

If m  >  1 then

[formula]

From these results, we see that if m is not a prime power then we have [formula], and the right hand side of the congruence [formula] when evaluated at X = 1 is

[formula]

We see that this is not congruent to 1 mod m because the product is over those i which are coprime to m, so the product does not vanish modulo m.

If m is a prime power pn, then we see from Theorem [\ref=gallot-theorem].1 that Φpn(x) = Φp(xpn - 1); in particular, we see that the coefficient of xφ(pn) - 1 is 0, which differs from the coefficient of xφ(pn) - 1 in F(X).

Therefore, if m is not prime then the congruence does not hold. We now show that if m is prime, the congruence holds.

If m is prime then [formula]. Let us consider the polynomials Φm(X + 1) and F(X + 1). Now, modulo m we have

[formula]

Now if x  ≠  0 mod m, then we see that [formula] and that [formula], because the product vanishes.

And if we have x = 0, then Φm(x) = 0 and, by Wilson's Theorem, [formula].

Therefore we have proved the Theorem.