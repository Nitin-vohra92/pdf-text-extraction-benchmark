Proposition Lemma Corollary Definition

Generalized de Bruijn Cycles

Generalized de Bruijn Cycles

Keywords: de Bruijn cycle, random construction, graph decomposition.

AMS Subject Classification Number: 94A55 (05C70).

Introduction

A de Bruijn cycle of order n is a q-ary sequence [formula] so that every q-ary n-word appears in a "window" [formula] for some j (indices taken modulo qn). A reduced de Bruijn cycle is a string of length qn - 1 which achieves every n-word in some window, except for the word 0n. In this paper, we are concerned with such objects when the notion of "window" is generalized.

Given a sequence [formula], we say that the map [formula] (resp., [formula]) is an I-cycle ([formula]-cycle) if, for every word W∈[q]n (resp., every word [formula]), there exists a [formula] (resp., [formula]) so that χ(ij + t)  =  W(j). If such a sequence exists for I, we say that I is q-valid (resp., [formula]-valid). We will often abuse notation by writing χ(I) for the n-word [formula]. Furthermore, we also use "cycle" to refer to sequences of edges in a directed graph each of whose tail is the head of the previous one, and which return to their starting point. It should always be clear from context which of these definitions we intend - though, often, the notions will coincide!

It is classical that an I-cycle and an [formula]-cycle exist for [formula]. In Section [\ref=sec:unreduced], we address the validity of other sets I. As it turns out, the question is rather difficult in general, and we solve the problem completely only for sets of cardinality 2. We present some general constructions and a number of computational results, and we discuss a graph-theoretic question whose solution is equivalent to the case of I being an arithmetic progression. In the next section, we discuss the existence of reduced de Bruijn cycles, and have a greater degree of success in characterizing the [formula]-valid sets. Then, in Section [\ref=sec:approx], the issue of "approximate" cycles is discussed, and we present a nearly optimal bound on their length. The following section contains a proof of a graph-theoretic decomposition result that is used in Section [\ref=sec:unreduced] and which solves a variant of a family of problems that has appeared recently in the literature. We finish with a number of open questions and suggestions for future investigation.

Unreduced Cycles

It is easy to see that, to determine the two-element q-valid sets, we need only examine the sets {0,d} with d|q2. Indeed, for any [formula], if there exists an I-cycle χ for {0,d}, then [formula] is an I-cycle for {0,kd}. In addition, it is clear that the validity of I is equivalent to the validity of I + b for any [formula]. The same arguments apply to sets I whose elements are in arithmetic progression: we need only examine the cases when the difference d divides qn.

Suppose, then, that d|qn, and consider Dnq, the [formula] q-ary de Bruijn digraph, i.e., the digraph whose vertices are the q-ary n-strings and which has an edge from x to y if the last n - 1 symbols of x are the same as the first n - 1 symbols of y. (Note that some edges have loops attached.) Then the set [formula] is q-valid iff there is a partition of the edges of Dn - 1q into d cycles each of length qn / d, because we may write χ(j) = Ca(b), where Ca is the [formula] such cycle and j  =  ad + b.

Using D1q, which is simply a complete directed graph with loops on q vertices, we may state a condition equivalent to the q-validity of {0,d}: that D1q is fully decomposable into cycles of length q2 / d. Theorem [\ref=trails], which appears Section [\ref=sec:trails], says that this is possible precisely when q2 / d  >  2. Therefore, we have

There exists an I-cycle for I  =  {0,d} if and only if q2 / d  ≠  2.

The situation for sets with |I|  >  2 appears significantly more complicated, even for arithmetic progressions. However, the above invalidity result for d  =  q2 / 2 has an immediate analogue for larger n:

For any r, q, with r|q, the set AP(r,qr / r) is q-invalid.

Suppose an I-cycle χ existed. Then, we may assume without loss of generality that [formula] is the all-zeroes vector. But, then [formula] is also, a contradiction.

On the other hand, we can construct a large family of AP(n,q)-cycles. Form the quotient graph G(n) from Dnq by identifying two vertices x and [formula] of Dnq if [formula] for some [formula], i.e., xi  -  x'i  =  k for 1  ≤  i  ≤  n.

G(n) is isomorphic to Dn - 1q.

For [formula], consider the map

[formula]

It is easy to check that λ is well-defined on G(n), invertible and preserves directed edges (i.e., (x,y) is an edge in Dnq if and only if (λ(x),λ(y)) is an edge in G(n)). Note that the inverse map λ- 1 doesn't necessarily preserve cycles, though. However, it is not hard to show the following. Suppose that [formula] is a cycle in [formula], i.e.,

[formula]

is an edge for all i, where the indices are reduced modulo r. Then this cycle "lifts" under λ- 1 to a cycle in Dnq if and only if [formula].

Observe that any Eulerian cycle C in Dn - 1q satisfies this sum condition. Hence, it lifts to a cycle C+ in Dnq going through exactly one of the q points in each equivalence class. In fact, we can form q disjoint cycles {C+j}qj = 1 from this cycle C+ by translating each point in it by some fixed constant [formula].

Finally, we can form a cyclic sequence S in Dnq containing all of its vertices by "splicing together" these q cycles C+j in the obvious way. Since C was in fact a de Bruijn cycle for (n - 1)-tuples, then it easily checked that S is an I-cycle with [formula].

As an example, consider the cycle 001122021 for n = 2,q = 3. We can lift this to 100021200 for n = 3,q = 3, form the two translates 211101011 and 022210122 and splice them together to get 021210210210102021102210210, which is a {0,3,6}-cycle.

In fact, since there are many ways of choosing the first de Bruijn cycle (qn - 1  ·  qqn - 2 - n + 1, to be precise), and many ways of splicing them together (q!), there quite a few ways of producing such cycles. Unfortunately, it is not possible to iterate this construction, since the cycles C+q do not themselves have the zero-sum property needed to lift them again.

AP(n,q) is q-valid for any n, q.

Suppose that {0,d,2d} is q-valid, where 8|k  =  q3  /  d. Then there exists a decomposition of the edges of D2q into cycles of length k. Write E for the set of even symbols in

[formula]

Reduced Cycles

Although the definition of [formula]-validity certainly makes sense when q is not a prime power, we restrict our attention to that case in this section. Therefore, consider q  ≥  2 a fixed prime power, and take our alphabet to be [formula]. Let α be a generator of the multiplicative group of the finite field [formula]. Denote by E the elementary basis for [formula] over [formula]. Given a basis [formula] of [formula] over [formula] and an element [formula], write fB(γ) for the element of [formula] whose [formula] coordinate is the coefficient of bj in the B-representation of γ. Then, given a nonzero vector [formula], define [formula] to be the string whose [formula] coordinate (i.e., [formula], 0  ≤  j  ≤  qn - 2) is [formula].

It is well known that, when B  =  {αj:0  ≤  j  ≤  n - 1} and [formula] has only one nonzero coordinate, [formula] is a reduced de Bruijn cycle of order n (e.g., [\cite=Fred82].) We generalize this result as follows.

Let I  =  {ij}nj = 1 be a sequence of distinct integers. Fix a basis B of [formula] over [formula], a generator [formula], and a vector [formula], and write Φ(t) for the vector

[formula]

with indices taken modulo qn - 2. If the minimal polynomial of α is not a divisor of [formula] for any nonzero [formula], then the map Ψ which sends 0 to 0 and αt to Φ(t) is an isomorphism from the additive group of [formula] to [formula].

First, we show that Ψ is linear. Write ej for the elementary n-vector whose coordinates are all zero except for a 1 in the [formula] coordinate. We denote by Mγ,B the matrix representing multiplication by [formula] in the B basis. It is easy to see that

[formula]

and therefore that

[formula]

which is obviously linear.

Now, suppose that Ψ(γ) = 0 and γ  =  αt. If we denote by S the subspace of [formula] orthogonal to [formula], then we have αij + t∈f- 1B(S) for each j. However, fB is linear and has a trivial kernel, so all the αij + t lie in a subspace of [formula] of dimension n - 1 and are therefore linearly dependent. Since Mα,B is nonsingular, this implies that {αij}nj = 1 is a dependent set. But then we have

[formula]

for some nonzero [formula], a contradiction.

The map γ  ↦  Mγ,B is actually an isomorphism of fields. The image is a set of matrices which form a field, i.e., a matrix field. These objects have been studied extensively and thoroughly characterized when the matrices take their entries from a finite field ([\cite=Beard86]).

If the minimal polynomial of α, a multiplicative generator of [formula], is not a divisor of [formula] for any nonzero [formula], then [formula] is an [formula]-cycle.

By the above argument, [formula] contains all nonzero n-strings in shifted copies of the index set I.

We require another definition.

The index set I  =  {ij}nj = 1 is called exceptional for q if, for every primitive polynomial [formula] of degree n, there exists a nonzero vector [formula] so that g divides

[formula]

Equivalently, if for every α a generator of [formula], the set {αij} is linearly dependent over [formula], then I is exceptional for q. An index set which is not exceptional is called ordinary for q.

Note that the exponents in ([\ref=rotation]) can be thought of as belonging to [formula].

I is [formula]-valid whenever I is ordinary for q.

If I  =  {ij}nj = 1 is not exceptional, then there exists a primitive polynomial [formula] of degree n so that, for all nonzero [formula], g is not a divisor of [formula]. Since x is not a root of [formula] in [formula], but it is a multiplicative generator of this field, [formula] is an [formula]-cycle for any B and [formula].

Which index sets are ordinary? We argue that if (qn - 1,d) = 1, then [formula] is ordinary. It is clear that, if I is ordinary, all of its translates are as well. We may therefore assume that a = 0. Then some irreducible polynomial g of degree n divides [formula] for each [formula]. Let α be a root of g, so αd is a root of [formula]. That this polynomial has degree less than n contradicts the fact that αd is a generator of [formula].

It is trivial that I is ordinary if it is a singleton. If I has two elements, then it is easy to see that I  =  {i,j} is ordinary if [formula], since then [formula]. Indeed, the copy of [formula] lying inside of [formula] is the set {αk(q + 1)}q - 1k = 1 for any generator α. Conversely, if q + 1|i - j, then, for every generator α, we have αi  =  cαj for some [formula]. Therefore, a two-element set is ordinary for q if and only if the difference of the elements is not a multiple of q + 1.

For a prime p and a positive integer n, define the Jacobi logarithm as follows: for a generator α of [formula], define [formula] by 1  +  αt  =  αLα(t), where s  =  (pn - 1) / 2 if p  >  2 and s = 0 otherwise.

A three-element set {i,j,k} is exceptional if and only if either:

Q|j - i,

Q|k - j,

Q|k - i,

or, for all m with (m,q3 - 1) = 1, there exists an a so that

[formula]

where Q  =  q2  +  q  +  1, and α is any (fixed) generator of [formula].

There are only two ways that αi, αj, and αk can be linearly dependent. Either one of them is an [formula]-multiple of another, or, for some triple {c1,c2,c3}, with ci  ≠  0 for all i,

[formula]

The former case is precisely the divisibility conditions stated above. To see that the latter situation is equivalent to condition [\ref=four], we may rewrite ([\ref=lindep]) without loss of generality as

[formula]

with [formula]. Suppose {i,j,k} falls into this case, i.e., ([\ref=lindep2]) has a solution in c4 and c5. Since we have assumed that neither c4 nor c5 is zero, we may express each of them in terms of α: respectively, αsQ and αtQ, for some s,t integers. Then we may rewrite ([\ref=lindep2]) as

[formula]

which is to say, that sQ + i - k + Lα(Q(t - s) + j - i)  =  0   mod q3 - 1. (Note that the fact that Lα is not defined on all of [formula] is not problematic, since the left hand side of ([\ref=lindep2]) cannot be zero.) This equation has a solution in s and t iff there exists an a so that Lα(aQ + j - i)  =  k - i   mod Q.

If we choose any other generator β of [formula], there is some m such that (m,q3 - 1) = 1 and αm  =  β. Then Lβ(a) = b iff Lα(am) = bm, so {i,j,k} is exceptional iff Q|j - i, Q|k - j, Q|k - i, or, for some m such that (m,q3 - 1) = 1, there exists an a so that

[formula]

Approximate Cycles

Since the question of whether an I-cycle exists appears difficult in general, we may ask instead whether it is possible to find an "approximate" I-cycle. This question comes in two forms for an index set [formula]:

What is the least N for which a [formula] exists so that, for every word W, there exists an m with W  =  χ(I + m)?

What is the least N for which there exists a χ so that all but o(qN) words appear as χ(I + m) for some m?

Call the former object a Type I approximate cycle and the latter a Type II approximate cycle. Then we can show:

Let F(n) be any function so that q- nF(n)  →    ∞   as n  →    ∞  . Then there exists a q-ary Type II approximate I-cycle of length F(n) when |I| = n.

We need a result of Janson to proceed. The following appears in [\cite=Jan98]. First, some notation. Let I be an index set for a set of events {Bi}i∈I. Define a graph ~   on I with the following property: Let J1 and J2 be two disjoint subsets of I such that there is no i1∈J1 and i2∈J2 with i1  ~  i2. Now, let A1 be any Boolean function of the events {Bi:i∈J1} and let A2 be any Boolean function of the events {Bi:i∈J2}. Then A1 and A2 are independent.

Let [formula], [formula], and [formula]. Then the following holds.

With the above notation,

[formula]

Fix an integer m. We wish to show that (for a suitable choice of m) the expected number of q-ary n-words which do not appear as χ(I + j) for any [formula] for a random function [formula] is o(qn). This quantity is qn times the probability that a single word - say, 0n - does not appear anywhere. So we need only show that this probability is o(1). Let Bj be the event that χ(I + j)  =  W. Then define a graph on the Bj as follows: Bj  ~  Bk iff [formula]. Note that deg (Bj)  ≤  n2 for all j, and [formula]. Therefore μ  =  mq- n,

[formula]

and δ  ≤  n2q- n. Plugging into the lemma, we find

[formula]

If we let m  =  F(n), then min (m2  /  8n2qn,m  /  2qn,m  /  6n2)  →    ∞  , completing the proof.

Now, we address the problem of constructing Type I approximate I-cycles. First, for a set of reals X  =  {xi}ni = 1, define

[formula]

where [formula] denotes the distance to the closest integer. It is proven in [\cite=KRS00] that, for any set X of cardinality n, μ(X)  ≥  n- 2. Then we have the following.

For any [formula] and collection of q-ary n-words [formula], there exists an integer p  =  n2S(1  +  o(1)) and a map χ:Zp  →  [q] so that every Wj appears as χ(I + t) for some t∈Zp.

Let p be the smallest prime greater than n2(S  +  3), and choose α achieving the bound μ(X)  ≥  n- 2. Then there exists a k∈Zp so that |α  -  k / p|  ≤  p- 1, and it follows that, for any j  ≠  k, kij and kik are separated by at least pn- 2  -  3  ≥  S integers modulo p. Write W(k) for the [formula] symbol of the word W. Then we may define [formula] by χ(kij  +  t)  =  Wt(j) for 1  ≤  t  ≤  S and 1  ≤  j  ≤  n, since the minimum gap between elements of kI is at least S. Define χ(s) arbitrarily for s  ≠  kij  +  t for any j and t. Then the map [formula] has the desired property.

We could use this result immediately to achieve a length n2qn(1 + o(1)) Type I approximate I-cycle, but it possible to do better using the random construction above. There is a trivial lower bound of qn on the length of any approximate cycle, and we can show an upper bound that is only slightly worse:

For any [formula], there exists a q-ary Type I approximate I-cycle of length p  =  (8 + o(1))qn log n.

The basic idea is to take a random sequence T1 that contains almost all words, then use Lemma [\ref=fixitup] to "tack on" the remaining ones. We use the notation of the proof of Theorem [\ref=TypeII]. If we let [formula], then, for sufficiently large n, the expected number of words which do not appear as χ(I + t) is at most

[formula]

Apply the lemma to find a sequence T2 in which each word missed by the random sequence occurs. Then, we concatenate two copies of T1 with two copies of T2 (two copies are used to avoid disturbing sequences which "wrap around"), and the result is a Type I approximate I-cycle of the stated length.

Decompositions into Directed Cycles

A number of recent papers (most notably [\cite=AGSV03],[\cite=B01], and [\cite=B03]) have addressed (and solved) the problem of decomposing a complete (possibly directed) graph into a set of cycles of prescribed length. Generally speaking, so long as the cycle lengths add up to the number of edges, there are very few impediments to the existence of such decompositions - although demonstrating this is far from simple. None of this work has dealt with graphs containing loops, however; in this section, we address this situation, in the case when all the cycles have the same length.

Let [formula] denote the complete directed graph with loops on n vertices, i.e., the vertex set is

[formula]

Conclusion

We wish to know, first and foremost, what distinguishes valid sets from invalid ones. The authors' attempts to find a simple way to separate these cases was met with frustration. A simpler problem is the case of index sets which are arithmetic progressions: the question of decomposing de Bruijn graphs into cycles is a natural one. We would also like to see corresponding lower bounds or improvements on the bounds of Section [\ref=sec:approx], particularly in the case of Type I approximate cycles.

Finally, the problem solved by Theorem [\ref=trails] has a natural generalization along the lines of other, similar work. Suppose that {mj} is such that [formula]. When is it possible to decompose [formula] into cycles of lengths {mj}? Clearly, there can be at most n 1's among the mj, and there must be at least n indices j for which mj  ≠  2. Are there additional restrictions?

Acknowledgements

Thank you to Paul Balister for the helpful suggestion concerning Theorem [\ref=trails].