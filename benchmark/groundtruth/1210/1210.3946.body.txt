Local Optima Networks and the Performance of Iterated Local Search

Introduction

One of the most conspicuous limitations of heuristic search methods in combinatorial optimization, is the ability to become trapped at a local optimum [\cite=glover1986future]. The number and distribution of local optima in a search space have, therefore, an important impact on the performance of heuristic search algorithms. A recently proposed model: Local Optima Networks [\cite=pre08] [\cite=verel2010local], provides an intermediate level of description for combinatorial fitness landscapes. The model has a higher descriptive power than a single statistical metric or set of metrics; but it also compresses the search space into a more manageable mathematical object. Specifically, a graph having as vertices the optima configurations of the problem and as edges the possible weighted transitions between these optima. This network representation allows the application of new analytical tools and metrics to study combinatorial landscapes, namely, those of complex networks analysis (e.g. degree distribution, clustering coefficient, assortativity, and community structure, to name a few). In previous work, alternative definitions of edges have been studied, and some of these metrics have been computed on the network extracted for two combinatorial problems: the NK family of landscapes [\cite=pre08] [\cite=gecco08] [\cite=ppsn10] [\cite=verel2010local] [\cite=verellocal], and the Quadratic Assignment problem [\cite=daolio2010local] [\cite=daolio2011communities]. Those studies have been mainly descriptive, although distinctive correlations between some network features and previous knowledge about search difficulty in these landscapes had been found. A previous related work [\cite=Pelikan:2010:NLP:1830483.1830606], explored the relationships between NK landscape features and the performance of a hybrid EA. The authors use standard landscape metrics, and conduct a study based mainly on scatter plots. They suggest that: "further work is necessary to gain better understanding of the escape rate on the actual problem difficulty". The present study, addresses exactly this point. The goal is to systematically explore correlations between local optima network features and the performance of a stochastic local search algorithm (Iterated Local Search) running on the underlying combinatorial optimization problem (in this study the NK family of landscapes). The 'escape rate' is a property related to the local optimum, and the LON could be considered as a new tool to better understand problem difficulty. The ultimate goal is to have predictive models of the performance of specific local search heuristics when solving a given combinatorial optimization problem. This paper proposes an initial predictive model of performance based on the most influential LON features.

Methods

The local optima network model of combinatorial landscapes, and the iterated local search metaheuristic are considered in this study. The relevant definitions and experimental setup are given below.

Local Optima Network

A fitness landscape [\cite=reidys2002combinatorial] is a triplet (S,V,f) where S is a set of potential solutions i.e. the search space, V:S  →  2S is a function that assigns to every s∈S a set of neighbors V(s) i.e the neighborhood structure, and [formula] is the evaluation of the corresponding solutions i.e. the fitness function.

The present study uses the well-known NK-landscapes [\cite=kauffman93] as a benchmark set. It is a problem-independent model for constructing combinatorial landscapes that are tunably rugged. In the model, N refers to the number of (binary) genes in the genotype, i.e. the string length, and K to their epistatic interaction, i.e. the number of other loci (chosen at random here) that influence the fitness contribution of a particular gene. Starting from this N-loci 2-allele additive model, by increasing the non-linearity K from 0 to N - 1, the landscapes can be tuned from smooth to rugged. Hence, S is the search space of all N-bit binary strings, and its size is [formula]. The neighborhood is defined by the minimum possible move on it, which is the single bit-flip operation, and the neighborhood size is [formula]. The fitness function evaluates each genotype s as [formula], where the values of loci contributions fi:{0,1}K + 1  →  [0,1] are drawn uniformly at random in

[formula]

Iterated Local Search

Iterated local search is a relatively simple but successful algorithm. It operates by iteratively alternating between applying a move operator to the incumbent solution and restarting local search from the perturbed solution. This search principle has been rediscovered multiple times, within different research communities and with different names [\cite=Baxter1981] [\cite=Martin1992]. The term iterated local search (ILS) was proposed in [\cite=lourenco:2002]. Algorithm [\ref=alg:ILS] outlines the procedure.

In the present study, the base LocalSearch heuristic is the same best-improvement hill-climber of Algorithm [\ref=alg:HC], which stops on a LO. This heuristic uses the single bit-flip move operator. Therefore, a 2-bit-flip mutation is chosen as a Perturbation operator. When a different LO is found after that, the search process accepts the move if its fitness is higher (we are assuming maximization). With these settings, ILS is performing a first-improvement hill-climbing in the configuration space of the LON with the escape-edges at distance D = 2, as defined in section [\ref=sec:LON].

The search terminates at the global optimum, which for benchmark problems is known a priori, or when reaching a pre-set limit of fitness evaluations FEmax.

Performance Evaluation

As the performance criterion, we selected the expected number of function evaluations to reach the global optimum (success) after independent restarts of the ILS algorithm (Algorithm [\ref=alg:ILS]) [\cite=auger2005performance]. This measure accounts for both the success rate (ps∈(0,1]) and the convergence speed. In theory, after (N - 1) unsuccessful runs stopped at Tus-steps and the final successful one running for Ts-steps, the total running time would be [formula]. Taking the expectation and considering that N follows a geometric distribution with parameter ps, it gives:

[formula]

where in the present case [formula], the ratio of successful to total runs is an estimator for ps, and [formula] can be estimated by the average running time of those successful runs.

The ILS variant detailed in Sec. [\ref=sec:ILS] is essentially incomplete, i.e. there are soluble problem instances for which the success probability is < 1 even in the limit of an infinite running time [\cite=hoos2005stochastic]. Given the chosen acceptance criterion, the search will eventually get stuck. Indeed, out of the test runs, 1 instance with K = 16 and 3 instances with K = 17 were not solved. This theoretical limitation could be overcome by performing as many random restart as to cover the whole search space, but such a solution is of limited practical interest for large problems. In the present study, the success performance has been estimated on all the instances that had been solved at least once.

The benchmark set consists of NK-landscapes with N  =  18 and K∈{2,4,6,8,10,12,14,16,17}. Those are the largest possible parameter combinations for which we could afford the exhaustive extraction of the local optima networks. In order to minimize the influence of the random generation of landscapes, 30 independent problem instances are considered for each combination of N and K, which accounts for a total of 270 instances in the problem set. The function-evaluations limit is set to 1 / 5 of [formula], i.e. FEmax≃5.2  ·  104, success rate ps and running time of successful runs Ts are estimated on 500 random restarts per instance.

Results

Descriptive Statistics

Table [\ref=tab:stat] summarises the LON metrics. Results are grouped according to the K value of the corresponding NK-landscapes, and present averages and standard deviations over 30 independent realizations per group. The number of local optima nv, is a metric familiar to any description of a rugged landscape. The other metrics are particular to the complex-network perspective provided by the LON model [\cite=newman2003structure].

From left to right in the table, lo represents the average length of the shortest paths that reach the global optimum starting from any other local optimum. The cost associated to an edge [formula] of the LON graph, is dij = 1 / wij. This measure can be interpreted as the expected number of random perturbations for escaping LOi and entering exactly the basin of LOj. lv gives the average path length for the whole graph, which accounts for the weighted network characteristic length. lo is intuitively more directly related to the search difficulty. Indeed, lo increases steadily with the landscape ruggedness K, whilst the trend with lv is less clear. As a possible explanation, the network growth in terms of nodes might be counteracted by a growth in nodes connectivity: the number of weighted outgoing transitions from a given LO, i.e. its out-degree in the LON, increases with K (cf. column zout in Tab. [\ref=tab:stat]).

Column fnn measures the correlation between the fitness of a node and the weighted average of the fitness of its nearest neighbors [\cite=barth2005characterization]. This is relevant as the ILS acceptance criterion takes the fitness values of LO into account. With respect to this metric, NK-landscapes behave at the LO level as they do at the solution level: they become the more and more uncorrelated with K approaching N - 1 (see column fnn). In general, it is expected that a high and positive fnn correlation would help the search process.

Column wii reports the average number of perturbations that remain in the same basin of attraction, which is a proxy for the basin size. The larger the basins, the more difficult it is to escape them. Table  [\ref=tab:stat] shows that average wii value decreases with the landscape ruggedness.

Column cc, reports the clustering coefficient [\cite=newman2003structure], which measures the ratio of connected triples in the LON graph. In a social network, this coefficient measures the probability for one's friends to be friends among each other. In the LO networks, it provides an index of topological locality for the transitions between local optima. Table  [\ref=tab:stat] suggest that cc values decrease steadily with increasing K, but so does the LON density [\cite=verellocal] and that might be the reason.

Column zout counts the number of transitions departing from a given LO. It is relevant to know whether all the transitions have the same rate, or if there is a preferred direction. To this aim, the disparity score y2 gauges the weight heterogeneity of out-going edges [\cite=barth2005characterization]. When all connections eij leaving a given LOi have the same probability wij, the disparity will be close to the inverse of the out-degree 1 / zouti otherwise it will be higher than this value. Column y2 shows that the disparity monotonically decreases with increasing K. From the point of view of a metaheuristic dynamic, a low disparity means that transitions are almost equiprobable. The LON topology does not preferentially guide the search trajectory, which makes the search process harder.

Column knn, reports the nearest-neighbors degree correlation or assortativity, a classical description of the mixing pattern of nodes in a network. The assortativity measures the affinity to connect with high or low-degree neighbors. The LONs of NK-landscapes are strongly disassortative, i.e. LO with few connections tend to link to others with many, and conversely. The implications of this observation on the search difficulty are worth further investigation.

The last column in Table [\ref=tab:stat] gives the values of the success performance indicator [formula] detailed in Sec [\ref=sec:perfeval], which we abbreviate to ets in the following. Clearly, the expected running time increases with the landscape ruggedness (problem non-linearity) K. In order to analyze the inter-correlations between all the studied metrics, Figure [\ref=fig:corgram] displays a correlogram of the whole data set. The figure depicts any possible pairing among the observed variables with a scatter plot in the panel below the diagonal, and the corresponding correlation coefficient in the upper panel. Table [\ref=tab:stat] corresponds to the first column of the correlation matrix, i.e. the one showing how the different network metrics shape against the epistasis K.

We are mostly interested in the correlations with the performance metric ets. Thus, the most relevant scatter plots are those in the last row of Figure [\ref=fig:corgram] together with the respective Pearson coefficients in the last column. By inspecting these values, the highest positive correlation is with the average length of the shortest path climbing to the global optimum ([formula]). and with the total number of LO ([formula]). This observation seems reasonable: the more rugged the landscape (i.e. the larger its LON), the higher the number of hops through the LON to reach the global optimum, and thus the longer the expected running time of a restarting local search. Conversely, the larger the LO basins, and the higher the nearest-neighbors fitness-fitness correlation, the shorter the running time ((r(ets,wii)≃r(ets,fnn)≃ - 0.40)). The catch here, is that those metrics are in turn correlated among themselves (e.g. [formula]), which prevents one from drawing relationships of causality from simple pair-wise correlations.

The last column plots also suggest a strong non-linearity of the performance estimator w.r.t. the LON metrics. In order to further analyze these relationships, Figure [\ref=fig:splots] zooms on the relevant scatter plots, and displays the logarithm of ets as a function of the considered landscape measures. The log-transformation allows to approach linearity, highlighting and confirming the results in the last column of . Namely, the relationships between ets and all the metrics but lv appear clearly. The picture suggests a positive exponential trend with lo and zout, and a negative exponential trend with fnn, wii, cc, and y2. In the case of nv, the relation could also be close to power-law.

Since data are far from being normal bivariate, a more robust measure of association would be the rank-based Spearman's ρ statistic, reported in Table [\ref=tab:rho]. These results complement the visual inspection of scatter plots and confirm the previous observations.

Statistical Modeling

, along with , address already some of the research questions asked in Section [\ref=sec:intro], but do not provide an explanatory model for the algorithm performance as a function of the landscape features. To this end, we perform a multiple linear regression on the data, which has the general form:

[formula]

where the response variable y in our case would be ets and p different predictors xj are to be chosen among the LON metrics; ε is the usual random noise term.

The least square regression produces estimates [formula] for the βj model coefficients; the difference between the predicted values and the actual, observed values, are the regression residuals: [formula].

The difficulty of this analysis is that there are several possible explanatory variables, which are in turn intercorrelated. In consequence, some of them could have a confounding effect on the regression. In general, when confounders are known, measurable, and measured, it is a good practice to include them in the model. We, therefore, start by fitting the following formula:

[formula]

where, w.r.t the general expression [\ref=eq:lm], the response and one of the predictors have been log-transformed in order to better approach linearity, as seen in . Moreover, the variable k is qualitative and enters the model as a fixed effect, which translates in one appropriate dummy variable for each class [formula].

The summary statistics for this model are reported in Table [\ref=tab:lm1]. In the table caption, the multiple R2 represents the proportion of variance explained by the linear regression. R2 would be equal to 1 if all observed data points were lying on the regression plane. When comparing models with a different number of predictors, the adjusted R2 should be used instead. The F statistic is the ratio of the variance explained by the parameters in the model, to the residual or unexplained variance. The p-value is the probability of achieving an F that large under the null hypothesis of no effect [\cite=chambers1992statistical].

The estimated coefficient [formula] and their estimated standard error [formula] are given in the 2nd and 3rd columns, respectively. Their ratio is the t-statistic (4th column) that is used to calculate a p-value for the significance of the estimation (last column).

In this initial model, the average length of paths to the global optimum lo is the only predictor with a regression coefficient that is statistically-significant at the 0.05 threshold (βlo = 0.04882, p-value = 2.37e - 19).

Therefore, we proceed to perform a step-wise model selection by backward elimination [\cite=mass]. From the initial formula, at each step we compute what change in the fit could be produced by dropping each predictor in turn, and then we eliminate the one that minimizes the AIC score of the resulting model [\cite=sakamoto1987akaike]. By iterating until all predictors become significant, we obtain the final model:

[formula]

which is detailed in Table [\ref=tab:lm2].

This final model is able to explain 84.94% of the variance observed in log (ets) with a linear regression on four variables that are all LON network metrics. Among these metrics, the length of the paths to the global optimum, and the weight disparity have the highest relative importance [\cite=relimpo].

Without a check on the model assumptions, this would remain an observational study and could not be used to make predictions. To this end, a combination of parametric tests (not reported for space reasons) provided a positive confirmation [\cite=gvlma]. However, a visual diagnostics is more informative. In particular, Figure [\ref=fig:resplot] helps to assess if the regression residuals follow a normal distribution with zero mean and homogeneous variance, whereas Figure [\ref=fig:compresplot] displays the contributions to the model of each predictor in turn, highlighting possible violations of the linearity hypothesis [\cite=car]. All assumptions seem acceptable. Therefore, formula [\ref=eq:lm2] could be used to make inferences. In other words, formula [\ref=eq:lm2] coefficients can be interpreted as conditional expectations for the average change in the response when one predictor undergoes a unitary change, and all the others remain fix. Since the dependent variable is log-transformed, this effect would be multiplicative.

The only important limitation of the proposed model is multicollinearity: due to the complex intercorrelations among LON metrics (cf. ), predictors are not really independent. This does not invalidate the multiple linear regression analysis, but it inflates the variance of its coefficients and makes it harder to disentangle their respective contributions [\cite=car].

Conclusions

This article explored correlations between local optima network features and the performance of a stochastic local search algorithm running on the underlying combinatorial optimization problem. The NK family of landscapes and the iterated local search meta-heuristic were considered. It has been shown in previous work e.g. [\cite=pre08] [\cite=verel2010local] that some features of the LON networks are related to the NK-landscapes ruggedness, and thus to problem difficulty. However, no statistically testable model was presented. The contribution of this study was to investigate, with a statistically-sound approach, which features of the LONs have a strong influence on the search performance, expressed as expected running times to success. The results obtained through the use of a multiple linear regression model show that some LON metrics are more important than others. These are: the average length of the shortest paths to the optimum, the average out-degree, the average disparity, and the degree assortativity. This study confirms and provides significant evidence that LON modeling is a compressed-but-relevant view of the fitness landscape, and can be used to understand and predict search difficulty.

It is worth noticing that some network metrics can be estimated without knowing the global optimum beforehand, such as the average out-degree, the fitness-fitness correlation, the average disparity and assortativity. Using these metrics and an adequate statistical model, as we have done in this work, opens up exciting possibilities. With standard sampling methods, larger search spaces could be studied. Thereafter, using the performance model based on the estimated LON metrics, the search heuristic parameters or its operators can be off-line tuned, or even on-line controlled. We plan to continue working in this direction and to extend this analysis to other combinatorial problems such as QAP.

Acknowledgments

Fabio Daolio and Marco Tomassini gratefully acknowledge the Swiss National Science Foundation for financial support under grant number 200021-124578.