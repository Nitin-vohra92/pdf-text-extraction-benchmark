Quantum circuits of T-depth one

Introduction

It is known that the gates of the Clifford group, together with the single-qubit non-Clifford gate

[formula]

form a good universal gate set for fault-tolerant quantum computation [\cite=Buhrman-Cleve-etal]. The decomposition of arbitrary gates into this Clifford+T set, either exactly or to within some given accuracy ε, is an important problem [\cite=Kliuchnikov-et-al]. It is often desirable to find decompositions that are optimal with respect to a given cost function. The exact cost function used is application dependent; some possibilities are: the total number of gates; the total number of T-gates; the circuit depth; and/or the number of ancillas used.

Amy et al. [\cite=AMMR12] recently proposed T-depth as a cost function. The idea is to count the number of T-stages in a circuit, rather than the number of T-gates. A T-stage is a group of one or more T- and/or [formula]-gates on distinct qubits that can be performed simultaneously. Note that, for the purpose of computing T-count or T-depth, the gates T and [formula] can be treated interchangeably, due to the identity [formula].

To illustrate the concept of T-depth, consider the standard decomposition of the Toffoli gate into the Clifford+T set, as given in [\cite=Nielsen-Chuang]:

[formula]

This decomposition has T-count 7, and in the exact form written, it has T-depth 6, because the fourth and fifth T-gates form a single T-stage. Using trivial commutations, the circuit ([\ref=eqn-nc]) can easily be reduced to T-depth 4:

[formula]

Amy et al. [\cite=AMMR12] further improved the T-depth of the Toffoli gate to 3, using the following circuit. They conjecture that for circuits without ancillas, this T-depth is optimal.

[formula]

The purpose of this note is to show that, with the use of ancillas, the T-depth of the Toffoli gate, and of many (but not all) other circuits, can be reduced to 1. This may be useful in quantum computing architectures where T-gates are expensive and ancillas are cheap.

A T-depth one representation of the Toffoli gate

Recall that the Clifford group for any number of qubits is generated by the Hadamard gate H, the phase gate S = T2, the controlled not-gate, and unit scalars. As usual, we write X, Y, and Z for the Pauli operators.

[formula]

[formula]

The Toffoli gate is a doubly-controlled not-gate. It is equivalent to a doubly-controlled Z-gate via a basis change:

[formula]

Now consider a computational basis state [formula], where [formula]. The effect of the doubly-controlled Z-gate is to map [formula] to [formula]. Let us write "[formula]" for modulo-2 addition in [formula], and "+  " and "-  " for the usual addition and subtraction of integers. We then have the following inclusion-exclusion style formula for [formula]:

[formula]

This is easy to prove by case distinction, or algebraically using [formula]. Now let ω = ( - 1)1 / 4 = eiπ / 4. From ([\ref=eqn-inc-exc]), we have

[formula]

Note that [formula], and therefore, the doubly-controlled Z-gate can be implemented by applying T-gates to qubits in states [formula], [formula], [formula], and [formula], and [formula]-gates to qubits in states [formula], [formula], and [formula]. This can be done in any order, or even in parallel, using four ancillas, as shown in Figure [\ref=fig-1]. Combining this with ([\ref=eqn-xhzh]), we obtain a representation of the Toffoli gate of T-depth 1 and overall depth 7.

It is interesting to note that the decompositions of Nielsen and Chuang ([\ref=eqn-nc]) and Amy et al. ([\ref=eqn-ammr]) follow precisely the same pattern, i.e., they can both be seen to be direct implementations of ([\ref=eqn-omega]). The only difference is that in each of the circuits, one of the T-gates has been needlessly decomposed into [formula] and S.

An application to multiply-controlled gates

Consider a doubly-controlled ( - iZ)-gate:

[formula]

The doubly-controlled Z-gate is a diagonal gate whose effect is given by ([\ref=eqn-omega]). The controlled [formula]-gate is a diagonal gate whose effect is given by [formula]. It follows that the combined effect of the two gates is

[formula]

which therefore requires a T-count of only 4. Using one ancilla, this can be achieved with T-depth 1 and overall depth 5:

[formula]

Alternatively, one can find an implementation that uses no ancilla. It uses fewer overall gates, but has T-depth 2 and overall depth 7:

[formula]

We also have

[formula]

Suppose we have a Clifford+T-representation of some controlled quantum gate G, and we wish to obtain an efficient Clifford+T-representation of a doubly-controlled G-gate. Using ([\ref=eqn-tri-z]), ([\ref=eqn-tri-not]), and ([\ref=eqn-ccg]), the cost of doing so is at most 8 additional T-gates, increasing the T-depth by at most 2, and the overall depth by at most 14, using 2 ancillas:

[formula]

Note that the cost of the additional control, in terms of the overall gate count, is 28 (2 times 12 gates from ([\ref=eqn-tri-z]) and 2 times 2 Hadamard gates from ([\ref=eqn-tri-not])). This can be reduced to 26 by leaving the ancilla in ([\ref=eqn-tri-z]) in state [formula] instead of [formula]; however, doing so requires carrying this ancilla during the computation of G, which may involve a tradeoff.

If ([\ref=eqn-tri-z-alt]) is used instead of ([\ref=eqn-tri-z]), the overall gate count cost of ([\ref=eqn-ccg]) decreases to 22, and the ancilla use to 1. However, the depth and T-depth cost increase to 18 and 4, respectively.

The above construction can be iterated to add n additional controls to a controlled gate at the cost of T-count 8n and T-depth [formula]. The logarithm in the expression for T-depth arises because a pair of T-stages is sufficient to double the number of controls, as shown here for n = 3:

[formula]

For example, this yields an implementation of a triply-controlled not-gate with T-count 15 and T-depth 3 (7 T-gates for the Toffoli gate, and 8 T-gates for the additional control); or a quintuply-controlled not-gate with T-count 31 and T-depth 5. It is not currently known whether any of these T-counts or depths are optimal.

Because the T-gate is diagonal with [formula], it can be regarded as a controlled gate, namely, a controlled global phase change. Therefore, we can use the above procedure to implement a controlled T-gate with T-count 9 as follows:

[formula]

Using ([\ref=eqn-tri-z]), we obtain T-depth 3, depth 15, and gate count 29 with two ancillas. As before, by leaving the ancilla of ([\ref=eqn-tri-z]) in state [formula] instead of [formula], the gate count can be reduced to 27. Alternatively, using ([\ref=eqn-tri-z-alt]), we obtain T-depth 5, depth 19, and gate count 27 with one ancilla. Except for slightly improved overall gate counts, these results are the same as those in [\cite=AMMR12].

T-depth one representation of almost classical circuits

It is straightforward to generalize the construction of Section [\ref=sec-toffoli] to circuits built up from T and almost classical gates.

A unitary operator is classical if it is given by a permutation of computational basis states, and diagonal if its matrix representation is diagonal in the computational basis. Let us call an operator almost classical if it can be written as a product of a classical operator and a diagonal operator.

The almost classical operators obviously form a group. Of the 24 single-qubit Clifford operators (taken modulo global phase), exactly 8 are almost classical; they form the subgroup generated by S and X.

Let [formula] be a set of gates. We say that a circuit is [formula]-representable if it can be built with gates from [formula] and their inverses. We say that such a circuit has T-depth n (relative to [formula]) if it can be written using only gates from [formula] and n T-stages.

Let [formula] be any set of almost classical gates, containing the controlled not-gate. Using ancillas, any [formula]-representable n-qubit circuit can be written of T-depth 1 (relative to [formula]).

The proof idea is simple. Each T-gate in the circuit is a π / 4 phase change conditioned on some boolean combination of the inputs. Intuitively, one may copy each such boolean condition to an ancilla, execute all T-gates in parallel, uncompute the ancillas, and finally re-compute the output.

The formal proof proceeds by induction on circuits. For each [formula]-representable n-qubit circuit A, we will by induction construct [formula]-representable circuits A1 and A2 such that A1 is diagonal and has T-depth at most 1, A2 has T-depth 0, and [formula].

The base case occurs when A = I is the identity circuit. In this case, we can let A1 = A2 = I, and there is nothing to show.

For the induction step, suppose A is of the form [formula], where G is a single gate. By induction hypothesis, there is a decomposition [formula] satisfying the above conditions.

Case 1: G is not equal to T or [formula]. In this case, we let [formula] and [formula]. Then trivially, [formula], and A1 and A2 have the required T-depths. Moreover, since G is almost classical, A1 is diagonal.

Case 2: G is T, applied to the ith qubit. In this case, we let

[formula]

and A2 = A'2. Since A'1 is diagonal, so is A1, and it follows that the ancilla is uncomputed correctly. Moreover, A1 is equivalent to [formula], and therefore, [formula]. Finally, since A'1 has T-depth at most 1, so does A1.

Case 3: G is [formula], applied to the ith qubit. This is entirely analogous to case 2.

A similar result appears in Section 6.4 of version 2 of [\cite=AMMR12], but with a proof that is quite different.

Note that the gate set [formula] in Theorem [\ref=thm-almost] is not necessarily assumed to consist of Clifford gates. For example, if on some hypothetical architecture, T-gates are expensive but Toffoli gates are cheap, one can include the Toffoli gate in the set [formula].

In general, the proof of Theorem [\ref=thm-almost] increases the size of the circuit, but only by a constant factor. In practice, it is often possible to find a much smaller circuit than the one constructed in the proof.

If we take [formula] and apply Theorem [\ref=thm-almost] to circuit ([\ref=eqn-nc]) (excluding the initial and final Hadamard gate), we obtain another T-depth one representation of the Toffoli gate.

We also note that there is a trade-off between T-depth and the number of ancillas. The procedure of the proof of Theorem [\ref=thm-almost] adds one ancilla for each T-gate. However, by splitting a circuit with T-count n into two circuits with T-count [formula] each, it is clear that one can approximately half the number of ancillas by doubling the T-depth, and so forth.

Some circuits cannot be written with T-depth one

The result of the previous section shows that any two T-stages can be combined into a single T-stage, provided that they are only separated by almost classical gates. One may wonder whether perhaps all Clifford+T circuits can be written of T-depth one, using a sufficient number of ancillas initialized to [formula]. We show that this cannot be done.

The single-qubit operator THT cannot be implemented as a Clifford+T circuit of T-depth 1, using an arbitrary number of ancillas initialized to [formula]. This is true even if the ancillas are not required to be returned to their initial state at the end of the computation.

Before proving the theorem, we start with a general observation about Clifford+T circuits of T-depth 1.

Let U be an n-qubit Clifford+T circuit of T-depth 1. Let [formula] be any single-qubit state, and consider

[formula]

Consider the [formula]-valued Pauli observable X applied to the first qubit of ψ; denote its expected value by [formula]. Suppose [formula] is non-zero. Then

[formula]

is a rational number.

The expected value of the observable X on the first qubit of [formula] is

[formula]

We analyze the structure of [formula]. Since U is of T-depth 1, it can be written as [formula], where U1 and U3 are Clifford circuits and [formula]. Since U1 is Clifford, we know that [formula] is a Pauli operator

[formula]

where each [formula]. Using the relations

[formula]

we find that

[formula]

where each Pj is an n-qubit Pauli operator. The key observation here is that the same factor λ occurs in front of each (possibly signed) summand, and λ is independent of [formula]. In fact, we have [formula], where k is the number of times the operators X and Y occur among [formula]. Let

[formula]

Since U3 is Clifford, this is again some Pauli operator, say

[formula]

Combining ([\ref=eqn-5.2]) through ([\ref=eqn-5.5]), we find

[formula]

Combining this with ([\ref=eqn-5.1]), we get

[formula]

Since each [formula] is a Pauli operator, it follows that [formula] is rational (indeed, an integer) for [formula]. The claim then immediately follows.

For U = THT, we compute

[formula]

and therefore

[formula]

and

[formula]

Since [formula] is irrational, the claim immediately follows from Proposition [\ref=prop-t1].

Conclusion

We found a class of circuits whose T-depth can be reduced to one, by using a sufficient number of ancillas. We also showed that there are circuits whose T-depth cannot be reduced to one, regardless of the number of ancillas used. It remains an open problem how to determine the minimal T-depth or T-count of any given Clifford+T circuit.

Acknowledgements

This research was supported by the Natural Sciences and Engineering Research Council of Canada (NSERC). This research was also supported by the Intelligence Advanced Research Projects Activity (IARPA) via Department of Interior National Business Center contract number D11PC20168. The U.S. Government is authorized to reproduce and distribute reprints for Governmental purposes notwithstanding any copyright annotation thereon. Disclaimer: The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of IARPA, DoI/NBC, or the U.S. Government.