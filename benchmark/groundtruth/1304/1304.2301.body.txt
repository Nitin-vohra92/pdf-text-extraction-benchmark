= 1

Mechanisms of Multi-strain Coexistence in Host-Phage Systems with Nested Infection Networks

Introduction

Bacteria and their viral parasites, i.e., phages, are found in natural environments from oceans, soils to the human gut. There are an estimated 1030 bacteria on Earth, with estimates of phages approximately 10-fold higher [\cite=Suttle2005] [\cite=Suttle2007]. Phages are not only abundant, but they are also key players in ecosystems. For example, phages can be responsible for a significant portion of microbial mortality, e.g., with estimates ranging from 20%-80% [\cite=Suttle1994] [\cite=Weinbauer2004] [\cite=Corinaldesi2010]. These estimates of lysis are at the community scale. However, individual phages infect a subset of bacteria in a community. A growing number of empirical studies have begun to investigate the nature of cross-infections between phages and bacteria [\cite=Wichels1998] [\cite=Holmfeldt2007] [\cite=Gomez2011] [\cite=Poisot2011]. These studies have the potential to help identify the basis for phage-induced mortality, by delineating the specific phage types capable of infecting and lysing specific host types and, potentially, the taxonomic and biogeographic drivers of cross-infection [\cite=Weitz2013]. Although predictive models of cross-infection remain elusive, it is evident that a single virus can infect multiple strains of a host [\cite=Poullain2008] [\cite=Stenholm2008], in some cases multiple species [\cite=Wichels1998] [\cite=Holmfeldt2007], and even hosts from different genera [\cite=Sullivan2003].

In an effort to identify cross-system trends and patterns in cross-infection, we (and collaborators) recently re-analyzed 38 phage-bacteria infection studies. This re-analysis identified a recurring pattern in these studies: viral strains have overlapping host ranges such that the overall network of infections is significantly nested [\cite=Flores2011]. In nested systems, there is a hierarchy for who can infect whom (see Figure 1A). In a perfectly nested system, the specialist virus can infect the most permissive host, the next most specialized virus infects the most permissive host and the second most permissive host, and so on (see Figure 1B). Hence, the host that is most difficult to infect is infected only by the most generalist virus. In systems that are nested but not perfectly so, this nesting of infection ranges occurs more frequently than expected by chance. It is important to note that some of the nested phage-host infection networks re-analyzed in [\cite=Flores2011] are derived from experimental evolution studies in which the hosts and phages do not coexist at the same time point, but rather the nested relationship is only observed when performing cross-infection experiments between time points (e.g. [\cite=Poullain2008]). However, some networks are derived from ecological studies where samples are taken from the environment (e.g., [\cite=Wichels1998] [\cite=Holmfeldt2007] [\cite=Stenholm2008]). In such cases the finding of overlapping infection ranges poses a dilemma for understanding coexistence. In particular, how can a specialist virus coexist when it only infects a single host, and indeed the host that is most susceptible to infection? Further, how can a permissive host coexist with other more resistant hosts when there is a nested relationship to infectivity? The consequences of such interaction networks on the structure and dynamics of microbes and their viral parasites have not yet been established. Here, we integrate empirical observations of complex infection networks into ecological models of host-phage dynamics.

Host-phage systems and their population dynamics have been studied mathematically for over 30 years [\cite=Levin1977] [\cite=Abedon2008]. The earliest models were meant to facilitate understanding of relatively low-diversity chemostat experiments, often involving the cross-infection of a single phage type with a single host type. These studies often found that mutants could arise and so simple models were often extended to include two hosts and one phage, two phages and one host, and so on [\cite=Levin1977] [\cite=Lenski1985]. However, host-phage models applied to natural environments require a greater diversity of bacteria and phage types. There are different types of approaches to integrate diversity into dynamic models. On the one hand, eco-evolutionary models have been developed that assume that new host and viral types can evolve as a result of ecological interactions. Despite their computational complexity, multiple examples of such eco-evolutionary approaches for phage-host dynamics are now available [\cite=Weitz2005] [\cite=Forde2008] [\cite=Weinberger2012] [\cite=Childs2012]. Alternatively, ecological models in which a fixed diversity of types are included from the outset can be used to study how certain features in a community may help maintain diversity. Examples of such approaches include spatial multi-strain models [\cite=Haerter2012], models of competition between hosts possessing different types of immune systems [\cite=Levin2010] and models that incorporate higher trophic levels [\cite=Thingstad2000].

The most prominent theory of phage-bacteria ecological dynamics in multi-species communities is of the latter type and is known as the Kill-the-Winner model [\cite=Thingstad2000] [\cite=Winter2010]. In this model, multiple species of bacteria and phage are considered, for which each virus is assumed to exclusively infect a single host type. The model's central conclusion is that each host type is controlled, in a top-down fashion, by a single viral type, with the exception of a single host type whose density is controlled by the total host biomass limit set by an additional generalist grazer. Moreover, the steady state densities of viral types are determined by relative differences in life history traits of the hosts (an issue we return to in the discussion). The model is meant to describe the dynamics of bacterial species, i.e., no strain level dynamics are considered, although its structure is general.

Here we extend the basic framework of the Kill-the-Winner (KTW) model to incorporate complex interaction networks and ask how nestedness mediates coexistence in multi-strain host-phage systems. We focus our attention on the idealized case of a perfectly nested interaction network, and show conditions on the life-history parameters necessary for coexistence. We find trade-off conditions necessary for coexistence and show that coexistence occurs even when the system is perturbed from the equilibrium. We examine the abundances of both hosts and viruses at steady state and their relationship to life history traits and to infection range. Finally we examine the existence of coexistence equilibria in the general case where the infection matrix is not perfectly nested. We close by discussing the relevance of the current study to the KTW model, empirical efforts to link infection patterns with life history traits, and recent attempts to establish a link between network structure and biodiversity.

Methods

We model a system of n bacterial strains (hosts) and n viral strains (phages). Bacteria compete for implicit resources while viruses infect different subsets of the bacterial community. We denote the density of host i by Hi and the density of virus j by Vj. Our model of the ecological dynamics of the different host and viral strains is,

[formula]

In the absence of viruses, hosts exhibit logistic growth with exponential growth rate ri and a community-wide carrying capacity K. To simplify the model we assume that for a given host, intrastrain and interstrain competition are the same. The parameters φj and βj are the adsorption rate and burst size (virion release per infection) of virus j (which we assume is independent of host i). Virus j decays outside the host at a rate mj. M denotes the infection matrix, where Mij  =  1 if virus j can infect host i and Mij  =  0 if virus j cannot infect host i. For analytical tractability, there are several characteristics of the life cycle of a viral infections that are not included in this model. For example, we assume there is no delay between infection and virion release. We also do not include the possibility of lysogeny, where viral genetic material is incorporated into the host chromosome and vertically transmitted to daughter cells for future activation and lysis.

Empirically measured phage-host infection networks are often statistically nested (for example, see Figure [\ref=infnets]a). Here, our main goal is to examine the ecological implications of nested interaction networks for host-phage dynamics. We start by studying the idealized case of a system where the infection network is perfectly nested; see Figure [\ref=infnets]b. In this representation of the network, viruses are numbered from the most specialist to the most generalist. We will refer to this number as the rank of a species. We see that virus 1 infects only one strain of host whereas virus j infects j different host strains. Note that, in the nested case, virus j + 1 can infect all strains of hosts that virus j can infect plus an additional one. Similarly, hosts are ordered by the number of viral strains that can infect them. Host i can be infected by i different viral strains. Again, note that in the perfectly nested case, host i can be infected by all viruses that can infect host i + 1. We relax these simplifying assumptions in section [\ref=deviation], where we consider the case of interaction networks that are not perfectly nested (as is the case in Figure [\ref=infnets]a).

Numerical simulations of the ecological dynamics were done using a Runge-–Kutta method (ode45 in MATLAB [\cite=MATLAB2010]). The parameters (life-history traits) used in all the simulations are shown in table [\ref=table:para] in [\ref=ap:para]. These parameters were chosen from a baseline of biologically realistic values found in the literature [\cite=Wommack2000] [\cite=Abedon2007].

Results

Equilibrium densities and conditions for coexistence

We start by examining the equilibrium densities of the host and phage strains. When the 2n equations of system [\eqref=odeSystem] are simultaneously zero, we find the equilibrium densities corresponding to strain coexistence:

[formula]

[formula]

where the superscript * denotes equilibrium densities and [formula]. The equilibrium densities of the hosts are expressed exclusively in terms of the life-history traits of the viruses (hj). This is due to the top-down control of the hosts by the viruses. In Figure [\ref=calc_hsteady] we show graphically how to construct the host steady states. We see that virus 1, which exclusively infects host n, determines the equilibrium density of that host. The value of this density is the ratio [formula]. This result is the same as in a system with just one host and one virus, and it can be interpreted as the host density necessary to support the virus infecting it (Figure [\ref=calc_hsteady]a). Virus 2, on the other hand, requires a host density of [formula] to persist in the system. This virus infects two hosts: one in common with virus 1 (host n), and an additional one (host n - 1). However, the density of host Hn is already set by virus 1, so the density of host n - 1 is the difference between the required density for virus 2 (h2) and the density of virus 1 (h1) (Figure [\ref=calc_hsteady]b). Similarly, virus 3 infects one more type of host than virus 2, and thus, the density of the additional host (Hn - 2) is the difference between the density required by virus 3 to survive (h3) and the density set by virus 2 (h2); see Figure [\ref=calc_hsteady]c. The densities of the remaining hosts are determined in an analogous way, Eq [\eqref=hSteady]. From this result we obtain that the total host biomass at steady state is [formula], i.e. it is set by the most generalist virus.

Coexistence of all strains at positive densities requires three conditions to be met:

[formula]

These conditions establish a connection between the life-history traits of the different viral and bacterial strains and the structure of the infection networks, specifically the rank of the strains. Equation [\eqref=vTradeoff] represents a tradeoff for the viruses and can also be written as [formula]. Larger values of hj imply a virus has a higher de-activation rate (higher mj) and/or produces fewer viruses per infection and/or is worse at attaching to the host (smaller βjφj). Thus, the inequalities in equation [\eqref=vTradeoff] provide the viral trade-offs necessary for coexistence: a virus with a broader host range has less advantageous life-history traits, as characterized by its ratio hj, compared to viruses with a narrower host range. Note that if two viral types infected a single host, the type with the lower ratio hj would out-compete the other. Here, coexistence is possible because the viral type with higher hj can infect more host strains than the viral types with lower hj. Equation [\eqref=hTradeoff] describes the trade-off between immunity and growth rate for the hosts. Specifically, coexistence is possible if a host that can be infected by more viral types has a higher growth rate compared to a host that can be infected by fewer viral types. Finally, equation [\eqref=Kcondition] specifies that the sum of the host densities at equilibrium needs to be less than the carrying capacity of the system.

Figure [\ref=2h2vStable] shows an example of the dynamics resulting from a system with 2 host and 2 viral strains which satisfies the conditions listed in equations [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition]. In contrast, Figure [\ref=2h2vDie] shows what happens when the conditions for coexistence are not satisfied. In this example, host 1 has a larger growth rate than host 2, which results in the extinction of host 2, and as a consequence, the extinction of virus 1.

Community dynamics and invasion

Conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] guarantee the existence of a coexistence equilibrium in system [\eqref=odeSystem]. In this section we address two issues related to the coexistence between host and viral strains when those conditions are satisfied. First, via numerical simulations we investigate if the species densities tend to the coexistence equilibrium or if cyclic coexistence is also possible. Second, boundary equilibria where one or more of the host and viral strains are extinct also exist in system [\eqref=odeSystem]. We ask if those boundary equilibria are unstable with respect to invasion by the extinct host and viral strains when conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] are satisfied.

As seen in Figures [\ref=2h2vStable], [\ref=2h2vOsc], and [\ref=5h5v], when conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] are satisfied, the host and viral densities can either tend to steady state or exhibit cyclic oscillations. In Figure [\ref=2h2vStable], the coexistence equilibrium point is stable, and the values of the densities tend to the equilibrium values after transient oscillations. For a different set of life-history traits, the coexistence equilibrium point is no longer stable, but cyclic coexistence is still possible (Figure [\ref=2h2vOsc]). Figure [\ref=5h5v] is an example of cyclic coexistence for 5 species of bacteria and 5 species of virus that satisfy the trade-off conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition]. In Figure [\ref=5h5v], coexistence is still possible because the coexistence equilibrium exists, even though the time series may be irregular. Note that due to the dimension of the model we do not have a closed form solution for when cyclic dynamics arise in our system.

In appendix A we show that conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] imply that all boundary equilibrium points of system [\eqref=odeSystem] are unstable with respect to invasion by at least one host or viral strain that is absent from that subsystem. This implies that if the dynamics in that subsystem tend to the boundary equilibrium point, then that subsystem can be invaded by one or more of the extinct host or viral strains. A stronger conclusion can be reached if system [\eqref=odeSystem] is permanent (i.e. densities are bounded above and, after some time, are bounded below by a finite value [\cite=Hofbauer1998]). Because the average long term invasability conditions along orbits in permanent Lotka-Volterra systems are equal to the invasability conditions at equilibrium points [\cite=Hofbauer1998], conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] imply that the extinct strains can always invade the subsystem when system [\eqref=odeSystem] is permanent. It is an open question whether system [\eqref=odeSystem] is permanent when conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] are satisfied.

Relationship between abundance and rank

Another relevant question is the connection between rank and density. Is there a way to infer information about the infection network from measurements of density or vice-versa? We find that, with the exception of host n, host densities are determined by the difference between consecutive hi values (eq. [\eqref=hSteady]). So, in our framework, measurements of density could inform us about the differences in the life-history traits of viruses with the most similar host range. If two viruses of consecutive rank are very similar (in terms of the aggregate life-history traits hi), then the corresponding host density is low. On the other hand, two very different values of hi for consecutive viruses imply high host density. The only exception to this analysis is the density of host n, which is determined uniquely by the ratio h1 of virus 1 and not by the difference between the ratios of viruses of consecutive rank.

Figure [\ref=dens_rank] shows examples of the connection between the life-history traits of the viruses and the density of the hosts. In the special case where the trade-off curve for the hi has a curvature with a constant sign, the values of hi translate into a simple (monotonic) rule for the host densities as a function of rank. For example, when the trade-off between hi and viral rank is concave up, the H*i increase with rank (Figure [\ref=dens_rank]a). When the trade-off is concave down, the H*i decrease with rank (Figure [\ref=dens_rank]b). In both cases, the density H*n of host n can be an exception. Figure [\ref=dens_rank]c shows the general case. The values of hi increase with rank following condition [\ref=vTradeoff] for coexistence, but the corresponding equilibrium densities need not be a monotonic function of rank.

The viral densities depend, in part, on how different the host strains are. Specifically, the equilibrium densities of the viruses depend on the differences between growth rates of host strains of consecutive rank. However, they don't depend uniquely on the traits of the host, they also depend on the adsorption rate of the focal virus (eq. [\eqref=vSteady]). Thus, information about the viral densities need not translate directly into information concerning differences in the life-history traits of hosts.

Deviation from a perfectly nested network and coexistence

We now return to our assumption about interaction networks and consider systems that are not perfectly nested. The examination of imperfect nestedness is biologically relevant. For example, a re-analysis of 38 observational studies of phage-host interaction networks found numerous instances of elevated nestedness, all of which included some departures from perfect nestedness [\cite=Flores2011]. The ecological dynamics follow system [\eqref=odeSystem], however the different structures of the infection network will be reflected in the matrix M, which includes information of who can infect whom.

The equilibrium densities can be expressed in a compact form as two matrix equations using the infection matrix M and its transpose [formula]:

[formula]

Here [formula] and [formula] are vectors of the equilibrium densities, [formula] is a vector whose elements are the hi, and [formula] is a vector whose elements are the ri. We also use the change of variable [formula]. We are interested in the solutions of system [\eqref=steadyMatrix] that are positive. We consider two cases: the infection matrix is invertible and the infection matrix is singular. An invertible infection matrix can be interpreted biologically as each viral strain having an unique niche, where the niche is defined by the host range. A singular infection network can be interpreted as the existence of niche overlap between two or more viral strains.

First consider the case where M is invertible, i.e., there is niche differentiation. In this case, there exists a unique solution to system [\eqref=steadyMatrix], and therefore a unique set of coexistence equilibrium densities. The equilibrium densities are expressed in terms of the life-history traits of the different viruses and bacteria and will, in general, involve differences between traits or combinations of traits (e.g. hi). Therefore, for every invertible infection network there exists a series of inequalities that are necessary to guarantee positive equilibrium densities (analogous to conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] for the perfectly nested case). In Figure [\ref=4by4]a we show an example of an infection network that corresponds to an invertible infection matrix that is not perfectly nested. We also show time series for a system with that specific interaction matrix where all the strains are present in the community (Figure [\ref=4by4]b). The relationship between network structure and equilibrium densities may be suitable for further numerical analysis.

If the matrix M is not invertible, i.e. there is niche overlap between viral strains, then there are two ways in which coexistence can occur. The first case occurs when the life-history traits of some viral strains are effectively equal. For example, in a system with two viral strains and one host strain, the viral strains can coexist if they have the same hi values. Biologically, this case is unlikely to occur given that we are describing strains in terms of function, and in this case, coexistence is possible only when strains are functionally identical.

The second case in which coexistence is possible occurs if we relax assumptions about the adsorption rate and the burst size for viral strains. In our formulation, a specific viral type infects all host strains with the same adsorption rate and burst size. However, if viruses exploit host strains at different rates, i.e., adsorption rate and burst size depend on both viral and host type, then coexistence is possible even with complete niche overlap. In this case, the steady states are solutions of two analogous systems of equations where the infection matrix M is a weighted matrix whose entries correspond to the adsorption rate and burst size for each host-viral interaction. A limited number of studies have shown that viral infection rates can differ significantly between host strains (e.g., see [\cite=Flores2011]). Hence, biologically, the use of quantitative information for host-phage infection assays represents an important target for future analysis and may shed light on the drivers of coexistence in natural communities.

Discussion

We studied the ecological dynamics of phages and hosts using a Lotka-Volterra framework that incorporated complex cross-infection networks. We found that coexistence is possible even when viruses exploit overlapping ranges of host. In the case of a perfectly nested infection network, Figure [\ref=infnets]b, we found trade-offs for both the hosts and the viral strains that are necessary to allow the coexistence of all the species. The trade-off for hosts implies that host growth rate decreases with defense (the larger the growth rate, the larger the viral range). The trade-off for viruses implies that viruses must be less efficient at utilizing host resources as they increase their host range. We also showed that the densities of the host strains at equilibrium are determined by how different the viruses are in terms of their aggregate life-history traits.

The idealized case of a perfectly nested network is mathematically tractable and may help to identify potential principles underlying coexistence in host-phage systems. On the other hand, real infection networks are rarely perfectly nested (see Figure 1 for an example, and the re-analysis of Flores et al [\cite=Flores2011]). We showed that coexistence is possible in the current framework if there exists a partitioning of niches. In those cases, the resulting tradeoffs between infection range and life history traits are not easily presented in a general way because each infection network results in different trade-off conditions. This, in turn, makes it difficult to study the stability for the general case. Nevertheless, we showed numerical examples of coexistence away from equilibrium for a infection matrix that is not perfectly nested.

The current model is similar in spirit to the Kill-the-Winner (KTW) model [\cite=Thingstad2000]. The KTW model also proposed mechanisms by which bacteria could coexist, stabilized by the presence of viruses. However, in the KTW model, infections are one-to-one, meaning that each bacterial strain can only be infected by one virus and likewise, each virus can only infect one bacteria. This would be equivalent to a diagonal infection network in our representation. In the KTW model, coexistence of different types of bacteria is achieved through what is known as a "killing the winner" mechanism, where "coexistence among bacteria is ensured by host-specific viruses that prevent the best bacterial competitors from building up" [\cite=Thingstad2000]. Hence, viruses enable coexistence in a system that would, in their absence, lead to a diversity collapse. The principle of top-down control also applies to the model presented here, despite the fact that we considered complex interaction networks with the possibility of overlapping host range.

However, the current model makes predictions not found in the KTW model. First, KTW assumes each bacterial strain is infected by a single viral type and so an ordering of bacterial growth rates is not necessary for coexistence. In the current model, an ordering of bacterial growth rates with respect to susceptibility to infection is required for coexistence and represents a prediction of the model. Second, whereas KTW assumes no difference in viral life history traits, we again predict that differences in life history traits are required for coexistence when viruses differ in their host range. Hence, altogether we predict that there should be an entanglement between network structure and bacterial/viral life history traits.

In light of the differences in predictions between our models and the KTW model, we suggest that studies of cross-infection from the enviornment should move beyond qualitative analysis (i.e., whether or not a phage infects a bacteria) to quantitative analysis (i.e., the lysis rate of bacteria by phages). Doing so would help identify costs of resistance and infectivity in natural populations as well as help understand the relative importance of network structure and trade-offs in shaping the structure of interactions in natural communities. We note that extensions of the current model will be required to consider the type of trade-offs that may coincide with findings of imperfectly nestedness infection networks.

In the past, the relationship between infection range and physiological costs has been studied experimentally, often in model organisms. For example, Lenski studied 20 E. coli mutant strains resistant to phage T4 [\cite=Lenski1988a]. All 20 strains were significantly less fit that the parental strain as measured via direct competition. Similarly, Bohannan and colleagues found strong growth costs to resistance for E. coli strains resistant to phage λ and to phage T4 [\cite=Bohannan2000]. The hypothesized mechanism is that resistance often requires modification to surface receptors that may alter the rate and effectiveness of nutrient uptake [\cite=Breitbart2012].

However, resistance mechanisms need not depend on surface changes and, moreover, in practice such trade-offs are not found universally. Indeed, two recent studies of putative trade-offs found more equivocal evidence. In one instance, Lennon et al [\cite=Lennon2007] studied Synechococcus hosts and associated myoviruses. They considered 22 different bacterial strains selected for viral resistance, based on four different ancestral strains. 11 out of the 22 strains showed a fitness cost compared to its ancestral strain either in the form of its maximum growth rate from growth curve data or through direct competition assays. Hence, 11 of the 22 strains showed no fitness cost to resistance. Similarly, Avrani et al [\cite=Avrani2011] studied the relationship between Prochlorococcus hosts and associated podoviruses. They found that 11 of 23 mutant strains that had evolved phage resistance grew significantly more slowly than did the ancestral wildtype. Hence, 12 of the 23 mutants strains did not show a growth cost to resistance. Instead, they found an alternative type of trade-off in which resistant mutants were susceptible to infection and lysis at a higher rate by other podoviruses and myoviruses with which they had not coevolved [\cite=Avrani2011]. Hence, it may be that the costs of resistance can not be fully understood without taking the community into account, as was considered in the model presented here.

There have also been a limited number of studies linking host range expansion to fitness cost within phages. For example, Duffy and colleagues showed that the fitness of evolved RNA-based phages, when grown on the ancestral host, declined significantly in 28 of 30 phages that had evolved an expanded host range [\cite=Duffy2006]. However, 2 of the phages had no significant fitness cost [\cite=Duffy2006]. Given the diversity of hosts and viruses in natural systems, it seems important to extend prior assays relating one-step range expansions to fitness. In particular, our work and the above suggest it is important to measure both host range and physiological costs in relationship to a broad range of potentially interacting strains.

The integration of life history trait variation into studies of community composition requires taking into account the coevolution of phages and bacteria. Previous studies have explored the coevolution of phage-host theoretically [\cite=Weitz2005] [\cite=Roswall2006] [\cite=Forde2008] [\cite=Rodriguez2009] [\cite=Weinberger2012] [\cite=Childs2012]. Experimental studies of co-evolving phage-host systems suggest that infection networks are not static, but rather are dynamic and reflect the changing identities of strains in a population [\cite=Buckling2002] [\cite=Stern2011] [\cite=Buckling2012]. Phage-bacteria coevolution is often described in terms of an arms race where the species' traits escalate over time [\cite=Stern2011] [\cite=Breitbart2012]. In such models it is common for better defended host types and phage types with better offenses to replace the respective resident type. However, coexistence of types is also possible if disruptive selection or evolutionary branching occurs. We have shown that ecological coexistence between multiple phage and bacterial types is possible if a series of trade-offs are satisfied (see Equations [\eqref=vTradeoff]-[\eqref=Kcondition]). Thus, if there is an appropriate trade-off between host defense and growth rate (e.g., resistance to infection) and an appropriate trade-off between phage replication and host range (e.g., ability to bypass host defense), evolutionary branching could yield phage-bacteria communities with nested patterns of infection. Thus, an arms race between phage and bacteria could result in the coexistence of one phage and bacteria pair that evolves over time or the coexistence of multiple phage and bacteria types that lie along their respective trade-offs.

We also point out that coevolution also occurs over spatially extended domains. Spatial structure is thought to stabilize diverse interactions amongst phage and bacteria (e.g. [\cite=Kerr2006] [\cite=Abedon2007] [\cite=Haerter2012]). Moreover, geographic structure can play a key role in affecting the outcome of coevolution [\cite=thompson2005geographic]. Further work is warranted to quantify how structure in infection networks are driven by and act as drivers of the spatial distributions of diverse communities of phages and bacteria [\cite=Flores2012] [\cite=green_2006] [\cite=angly2006].

Altogether, the current study predicts that phage-host coexistence in a given system depends on both network structure (e.g., nestedness) and life history traits. Other types of infection networks are possible including modular [\cite=Flores2011] and multi-scale [\cite=Flores2012], suggesting the need for further investigations into the relationship between cross-infection and life history traits. Extending the current model framework to include evolution, spatial dynamics, and quantitative information on infection will yield increased opportunities for theories of phage-host interactions to deepen our understanding of the mechanisms underlying the formation of complex phage-host interactions networks and their ecosystem-level consequences.

Acknowledgments

The authors thank two anonymous reviewers for their comments and suggestions. JSW holds a Career Award at the Scientiﬁc Interface from the Burroughs Wellcome Fund and acknowledges the support of a grant from the James S. McDonnell Foundation and NSF No. OCE-1233760. MHC was partially supported by the National Science Foundation under Award No. DMS-1204401.

Stability of the boundary fixed points for phage-host dynamics with a perfectly nested infection matrix

In this section we show that if conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] from the main text are satisfied, then all boundary equilibria of the system are unstable. As discussed in the main text, this implies that if the dynamics in the boundary subsystem tend to the boundary equilibrium, then the subsystem can be invaded by at least one of the extinct host or viral strains. If trajectories in the subsystem do not converge to the boundary equilibrium point, then our conclusions about invasability only apply if system [\eqref=odeSystem] is permanent (i.e. densities are bounded above and, after some time, are bounded below by a finite value, [\cite=Hofbauer1998]). When system [\eqref=odeSystem] is permanent, invasion at the equilibrium implies invasion along any orbit (over infinite time). This is because the average long term invasability conditions along orbits in permanent Lotka-Volterra systems are equal to the invasability conditions at equilibrium points [\cite=Hofbauer1998]. We are not aware of any proof that our system is or is not permanent.

For notational convenience, we make two changes to the way the system is presented. First, we don't use the matrix Mij to establish who can infect who. Instead we change the range of sums in accord with the nested pattern. Second, we reverse the order of the hosts (Hi  →  Hn - i + 1). In this numbering, host 1 can be infected by all viral strains, and host n can be infected by a single viral strain (Figure [\ref=infnet_nesA]). In this new notation the system takes the form:

[formula]

In this notation, conditions [\eqref=vTradeoff], [\eqref=hTradeoff], and [\eqref=Kcondition] from the main text become:

[formula]

Note that, as a consequence of reversing the order of the hosts, condition [\eqref=cond_r] on the growth rates (ri) is the reverse of condition [\eqref=hTradeoff].

We will show that all possible boundary fixed points are unstable with respect to invasion. Let [formula] denote the vector of all host and viral densities and let [formula] denote a fixed point of system [\eqref=eq:odeSumsH] and [\eqref=eq:odeSumsV], where H*i is the equilibrium density of host i and V*i is the equilibrium density of virus i. We will denote the Jacobian by J and the eigenvalues by λ. We will consider 4 properties of fixed points, such that every possible boundary fixed point has at least one (and possibly more) of these properties. We will show that any fixed points with any of these properties is unstable with respect to invasion by at least one of the host or viral strains. The 4 properties of fixed points are:

* where [formula].

* where [formula] with k < n and [formula].

* where [formula] for [formula] and [formula].

* where [formula] for i > 1, k < n, and [formula].

The first property corresponds to fixed points where none of the hosts are present. The second property corresponds to fixed points where hosts with low defense level are not present (i.e. hosts that can be infected by all or many viral types are not present). The third one corresponds to fixed points where hosts of high defense are not present (i.e. hosts that can be infected by one or only a few viral types are not present). The last property corresponds to fixed points where host of intermediate defense level are not present.

We will prove the instability of fixed points with properties 1,2,3, and 4 in lemmas 3, 4,5 and 6 respectively. Before that we will prove two more lemmas.

Let [formula] be a fixed point, then:

If H*i  =  0, then [formula] is an eigenvalue of the Jacobian evaluated at *.

If V*i = 0, then [formula] is an eigenvalue of the Jacobian evaluated at *.

a)

Assume H*i = 0. We can write the equation describing the dynamics of Hi as:

[formula]

where f(*) is a function of all the densities. Then, for any density X  ≠  Hi,

[formula]

Hence, the Jacobian will have the form:

[formula]

Note that all the elements in the ith row are zero, except for the diagonal term, which has the form [formula]. Thus, the characteristic equation can be written as:

[formula]

where P(λ) is a polynomial λ. Hence, [formula] is an eigenvalue of the Jacobian.

b) The proof for the case where V*i = 0 follows the same steps as proof a) for H*i = 0.

Let * be a fixed point where V*i = 0 for all i and H*i  ≠  0 for at least one i, then * is unstable with respect to invasion by at least one virus.

Assume [formula]. The equilibrium condition for Hi is:

[formula]

So, [formula].

Now, V*n = 0, so using lemma [\ref=l:eigenvalue] we know that one eigenvalue of the Jacobian is:

[formula]

where the inequality results from the condition of coexistence [\eqref=cond_K]. Equation [\eqref=eq:eigl2] implies that the fixed point * is unstable with respect to invasion by virus n.

Now, we will show that fixed points with any of these 4 properties are unstable.

Let * be a fixed point where H*i = 0 for all i∈[1,n], then * is unstable with respect to invasion of any of the hosts.

Assume H*i = 0 for all types of hosts in the system, then from equation [\eqref=eq:odeSumsH] it follows that also V*i = 0 for all types of viruses at equilibrium.

Using lemma [\ref=l:eigenvalue],

[formula]

is an eigenvalue. Thus * is unstable with respect to invasion of any of the hosts.

Let * be a fixed point where [formula] with k < n and [formula], then * is unstable with respect to invasion of hosts 1 through k .

Assume [formula] with k < n. The equilibrium condition for Vi for 1  ≤  i  ≤  k is:

[formula]

Note that V1,V2,...,Vk only infect hosts 1 through k (the upper limit of the sum is i and 1  ≤  i  ≤  k ). Thus if H*i = 0 for the first k viruses, then it must be the case that V*i = 0 for the first k viruses, i.e

[formula]

From lemma [\ref=l:eigenvalue] the eigenvalues for the first k hosts have the form :

[formula]

Note the lower limit in the sum as a result of equation [\eqref=eq:firstVzeros].

Now, assume Hk + 1  ≠  0. From the equilibrium condition for Hk + 1 we get:

[formula]

If V*i = 0 for all i in the sum, then V*i = 0 for all the viruses in the system. This case is already covered in lemma [\ref=l:allVzeros].

On the other hand if [formula] for at least one virus V*i we get,

[formula]

Plugging the result [\eqref=eq:case3] in equation [\eqref=eq:eigcase3], we get:

[formula]

where the inequality comes from the inequality [\eqref=eq:condPos] and the condition for coexistence [\eqref=cond_r]. Equation [\eqref=eq:eigl4] implies that the fixed point * is unstable with respect to invasion by host i where 1  ≤  i  ≤  k.

Let * be a fixed point where [formula] for [formula] and [formula], then * is unstable with respect to invasion of at least one species of host or virus.

Assume [formula]. The equilibrium condition for viruses i - 1 through n are:

[formula]

Note that all the sums in [\eqref=eq:equiVlast] are the same. Because [formula] for all [formula] in the system, the equations in [\eqref=eq:equiVlast] can only be satisfied if [formula] for at most one k∈[i  -  1,n].

To see that * is unstable, consider three possible cases:

* where [formula].

* where [formula] and [formula].

* where [formula] for one k∈[i  -  1,n  -  1] and [formula] for [formula], [formula].

Case [\ref=case:last1]:

Assume V*k = 0 for all k∈[i  -  1,n]. In this case V*k = 0 for all k∈[1,n]. Indeed, the equilibrium condition for Hi - 1 implies:

[formula]

Thus,

[formula]

From equation [\eqref=eq:odeSumsH] we see that equation [\eqref=eq:condllast] implies V*i = 0 for all i. This is the case covered in lemma [\eqref=l:allVzeros].

Case [\ref=case:last2]:

Assume [formula] and V*k = 0 for all k∈[i  -  1,n  -  1]. From lemma 1 we know that, because Vk = 0 for i - 1  ≤  k < n the corresponding eigenvalues have the form:

[formula]

From the equilibrium condition for Vn, we get:

[formula]

Note that the limits of the sums in [\eqref=eq:eiglast] and [\eqref=eq:Vequilast] are the same as a result of the H*i that are zero, substituting the last expression into [\eqref=eq:eiglast]:

[formula]

where the inequality results from [\eqref=cond_h], and consequently the steady state * is unstable with respect to invasion of any of the viruses i - 1 through n - 1.

Case [\ref=case:last3]:

[formula] for one k∈[i  -  1,n  -  1] and [formula] for [formula], [formula]. The only virus capable of infecting host n is virus n. Using lemma 1 we get that one eigenvalue is given by:

[formula]

where we used V*n = 0. At this fixed point the only virus infecting host i - 1 is virus k, so the equilibrium condition becomes:

[formula]

Thus,

[formula]

and

[formula]

So, the fixed point * is unstable with respect to invasion by host n.

Let * be a fixed point where [formula] for [formula], k < n, and [formula], then * is unstable with respect to invasion of at least one species of host or virus.

Proof:

Similarly to lemma [\ref=l:lastzeros] the equilibrium condition for viruses i - 1 through k are:

[formula]

To simultaneously satisfy all of the equations at most one [formula] for [formula] . To show that * is unstable, it is convenient to study two different cases.

* where V*k = 0

* where [formula] .

Case [\ref=case:middle1]:

Assume Vk = 0. Using lemma 1 we know that an eigenvalue of the Jacobian is:

[formula]

The equilibrium condition for Hk + 1 yields:

[formula]

Using this result the eigenvalue becomes:

[formula]

And as a consequence of condition [\eqref=cond_h], the eigenvalue is positive and the fixed point is unstable with respect to invasion by host k.

Case [\ref=case:middle2]:

Assume [formula]. The equilibrium condition for Vk is:

[formula]

So,

[formula]

From Lemma 1 follows that for any [formula], there exists an eigenvalue of the form:

[formula]

Substituting equation [\eqref=eq:case2eig], we get:

[formula]

where the inequality is a consequence of condition [\eqref=cond_h]. Thus, the fixed point is unstable with respect to invasion by viruses i - 1 through k - 1 .

Parameters values used in the numerical simulations