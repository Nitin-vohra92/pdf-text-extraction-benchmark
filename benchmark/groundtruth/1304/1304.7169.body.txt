Lemma Corollary Proposition

Definition Example Exercise

Remark

On the non-idealness of cyclotomic families of pairing-friendly elliptic curves

Introduction

In recent years, the Tate pairing and the Weil pairing on elliptic curves over finite fields have been used to construct many novel cryptographic systems for which no other practical implementation is known; see [\cite=Boneh2003] [\cite=Boneh2004] [\cite=Joux2000] [\cite=Sakai2000] for the pioneering work and see [\cite=Paterson2005] for a survey. The elliptic curves suitable for implementing pairing-based cryptographic systems are called pairing-friendly elliptic curves.

More precisely, a pairing-friendly elliptic curve E over a finite field [formula] contains a subgroup of large prime-order r such that for some k, r|qk - 1 and [formula] for 0 < i < k, and the parameters q,r and k should be chosen such that the discrete logarithm problem is infeasible both in an order-r subgroup of [formula] and in [formula], and the arithmetic in [formula] is feasible. Here, k is called the embedding degree of E with respect to r, and the ratio [formula] is called the ρ-value of E with respect to r.

Roughly speaking, pairing-friendly elliptic curves should have small embedding degree with respect to a large prime-order subgroup. But Balasubramanian and Koblitz [\cite=Koblitz1998] showed that, in general, the embedding degree k can be expected to be around r. This makes pairing-friendly elliptic curves rare; for example see [\cite=Shparlinski2012]. Thus, specific constructions are needed; see [\cite=Freeman2010] for an exhaustive survey .

The main known strategy to construct pairing-friendly elliptic curves is as follows. Fix k  ≥  1 and square-free D  ≥  1, and look for an integer t and two primes r and q satisfying

[formula]

where Φk(x) is the k-th cyclotomic polynomial, and D is the so-called CM discriminant. Then, the CM method (see [\cite=Cohen2005]) can produce an elliptic curve E over [formula] with [formula].

A well-known construction for the so-called complete families of pairing-friendly elliptic curves with k and D fixed is due to [\cite=Barreto2002] [\cite=Brezing2005] [\cite=Miyaji2001] [\cite=Scott2006]. Briefly speaking, the idea is to parameterize t,r,q,y as polynomials and then choose t(x),r(x),q(x), and y(x) satisfying ([\ref=condition]) and such that r(x) is irreducible and q(x) is a power of an irreducible polynomial p(x). If moreover r(x) and p(x) satisfy some extra conditions which conjecturably guarantee r(x) and p(x) to take infinitely many prime values simultaneously, then we say that the triple (t(x),r(x),q(x)) parameterizes a complete family of elliptic curves. For such a family, the ρ-value, denoted by ρ(t,r,q), is

[formula]

When furthermore r(x) is chosen to be Φn(x) with k|n, this yields the most popular family called cyclotomic family; see Section [\ref=family] for more details.

For practical considerations, neither k nor deg r(x) should be large. Following [\cite=Freeman2010], a practical complete family (t(x),r(x),q(x)) means that k  ≤  50 and deg r(x)  ≤  40.

In general, curves with small ρ-values are desirable in order to speed up arithmetic on the elliptic curves. The ideal case is ρ = 1. We call a complete family (t(x),r(x),q(x)) of elliptic curves an ideal family if ρ(t,r,q) = 1.

Okano [\cite=Okano2012] showed that for a cyclotomic family (t(x),r(x),q(x)) with embedding degree k and r(x) = Φk(x), where k = p or 2p for some odd prime (in this case, p should be equal to 3 modulo 4), one has ρ(t,r,q)  ≠  1. By using some methods different from those in [\cite=Okano2012] and based on the properties of cyclotomic polynomials, we can extend this result to more cases. In fact, we get much stronger results, that is, we obtain lower bounds or smallest possible values of ρ(t,r,q).

Let k = 2mpn for some odd prime p, and integers, m  ≥  0 and n  ≥  0, and D a square-free positive integer. Suppose that (t(x),r(x),q(x)) is a cyclotomic family of elliptic curves with r(x) = Φk(x), embedding degree k, and CM discriminant D. For the ρ-value ρ(t,r,q), we list all the cases as follows.

If k = 2m (in this case we must have m  ≥  3), we have D = 1 or D = 2. Then, the following hold.

If D = 1, then the smallest possible value of ρ(t,r,q) is [formula].

If D = 2, we have ρ(t,r,q)  ≥  1.5.

If k = pn or 2pn,n  ≥  1, we must have [formula] and D = p. Then, the following hold.

If p = 3 (in this case we must have n  ≥  2), then the smallest possible value of ρ(t,r,q) is [formula].

If p  ≥  7 , we have ρ(t,r,q) > 1.1.

If k = 2mpn,m  ≥  2,n  ≥  1, we have D = 1,2,p or 2p. Then, the following hold.

If D = 1, then the smallest possible value of ρ(t,r,q) is [formula].

If D = 2 (in this case we must have m  ≥  3), then ρ(t,r,q) > 1.5 for p > 3, and ρ(t,r,q)  ≥  1.25 for p = 3.

If D = p and [formula], we have ρ(t,r,q) > 1.4 for p > 5, and ρ(t,r,q)  ≥  1.75 for p = 5. If D = p, [formula] and p  ≥  7, we have ρ(t,r,q) > 1.1. If D = p and p = 3, then the smallest possible value of ρ(t,r,q) is [formula].

If D = 2p (in this case we must have m  ≥  3), we have ρ(t,r,q) > 1.5.

From Theorem [\ref=Thm1], we can see that for these cyclotomic families, small ρ-values can possibly occur only when k = 2m,D = 1; or k = 3n,2  ·  3n,D = 3; or k = 2mpn,D = 1; or k = 2m3n,D = 3. This suggests that small ρ-values may occur rare for cyclotomic families with large CM discriminant D.

In Theorem [\ref=Thm1], we say "smallest possible value", because on the one hand the claimed ρ-value is indeed a lower bound for the ρ-values of such cyclotomic families, on the other hand in Section [\ref=Proof1] we indeed get a polynomial triple (t(x),r(x),q(x)) with the claimed ρ-value following Theorem [\ref=Brezing-Weng], but one needs to check whether it is a complete family. Although it is not easy to get a general result, with the help of the computer algebra system PARI/GP [\cite=Pari], for k  ≤  82 we get Table [\ref=data] (see Section [\ref=Proof2]), which is compatible with Theorem [\ref=Thm1].

The computations for Table [\ref=data] suggest that some smallest possible ρ-values can be achieved, for example Theorem [\ref=Thm1] (2a) when k = 3n and (3c) when k = 3  ·  2m,m  ≥  2; but some cannot be achieved, for example Theorem [\ref=Thm1] (1a) and (3a). The reader can also check this in Table [\ref=data].

Comparing Table [\ref=data] with [\cite=Freeman2010], the cyclotomic families in Theorem [\ref=Thm1] (2a) when k = 9 or k = 27 may be comparable, since they have the same ρ-values as claimed in [\cite=Freeman2010] and they have a simpler form of t(x). We list them explicitly as follows.

k = 9,D = 3:

[formula]

k = 27,D = 3:

[formula]

The following theorem is a direct corollary of Theorem [\ref=Thm1], which says that all the cyclotomic families in Theorem [\ref=Thm1] are not ideal.

Let k = 2mpn for some odd prime p, and integers, m  ≥  0 and n  ≥  0, and D a square-free positive integer. Suppose that (t(x),r(x),q(x)) is a cyclotomic family of elliptic curves with r(x) = Φk(x), embedding degree k, and CM discriminant D. Then, we have

[formula]

Although Table 5 in [\cite=Freeman2010] suggests that there are no practical ideal cyclotomic families of pairing-friendly elliptic curves, there are few general results. Theorem [\ref=Thm2] gives evidence that there is no ideal cyclotomic family of pairing-friendly elliptic curves.

We want to indicate that the methods we use here rely heavily on simple expressions of the cyclotomic polynomials Φ2mpn(x). For a general cyclotomic family (t(x),r(x),q(x)) with embedding degree k, r(x) = Φkd(x) and d  ≥  2, it might be difficult to get a general result like Theorem [\ref=Thm1] or Theorem [\ref=Thm2].

Complete families of pairing-friendly elliptic curves

In this section, we will briefly introduce complete families of pairing-friendly elliptic curves; see [\cite=Freeman2010] for more details.

A famous conjecture of Buniakowski and Schinzel [\cite=Lang] asserts that a non-constant [formula] takes an infinite number of prime values if and only if f(x) is irreducible with positive leading coefficient, and [formula]. Furthermore, a conjecture by Bateman and Horn [\cite=Bateman1962] predicts the density of such prime values. In practice, we must also consider rational polynomials.

We say that a polynomial [formula] represents integers if [formula] for some [formula].

We say that [formula] represents primes if it satisfies the following conditions:

f(x) is non-constant and irreducible with positive leading coefficient;

f(x) represents integers;

[formula].

So, when a rational polynomial f(x) represents primes, it is likely to take infinitely many prime values. Now we are ready to define complete families of elliptic curves.

For a given positive integer k and a positive square-free integer D, the triple [formula] parameterizes a complete family of elliptic curves with embedding degree k and CM discriminant D if the following conditions are satisfied:

q(x) is a power of a polynomial which represents primes;

r(x) represents primes and t(x) represents integers;

r(x)|q(x) + 1 - t(x) and r(x)|Φk(t(x) - 1);

There exists some [formula] representing integers such that 4q(x) = t(x)2 + Dy(x)2.

Barreto, Lynn and Scott [\cite=Barreto2002] and (independently) Brezing and Weng [\cite=Brezing2005] both observed that we can generalize the Cocks-Pinch method (see [\cite=Freeman2010]) to produce complete families of elliptic curves. Brezing and Weng gave a construction in greatest generality. We describe it below as stated in [\cite=Freeman2010] with minor modifications.

Fix a positive integer k and a positive square-free integer D. Then execute the following steps.

Find an irreducible polynomial [formula] with positive leading coefficient such that a number field [formula] contains [formula] and the k-th cyclotomic field.

Choose a primitive k-th root of unity ηk∈K.

Let [formula] be a polynomial mapping to ηk + 1 in K such that deg t(x) <  deg r(x).

Let [formula] be a polynomial mapping to [formula] in K such that deg y(x) <  deg r(x).

Let [formula] be given by (t(x)2 + Dy(x)2) / 4.

Suppose that q(x) represents primes and both t(x) and y(x) represent integers. Then the triple (t(x),r(x),q(x)) parameterizes a complete family of elliptic curves with embedding degree k and CM discriminant D. The ρ-value of this family is

[formula]

The cyclotomic families of elliptic curves are exactly constructed by the Brezing-Weng method when r(x) is taken to be a cyclotomic polynomial Φn(x) in the above theorem (in this case, k|n).

Searching for ideal complete families of elliptic curves is still an important open problem in pairing-based cryptography. So far there is only one known ideal complete family, constructed by Barreto and Naehrig [\cite=Barreto2006] with k = 12 and D = 3. We state it as follows:

[formula]

Proof of Theorem [\ref=Thm1]

In this section, we will prove Theorem [\ref=Thm1] by cases.

First, under the assumptions of Theorem [\ref=Thm1] and then using Theorem [\ref=Brezing-Weng], we fix some notation.

Put [formula], where r(x) = Φk(x). Let [formula]. Notice that there is a canonical isomorphism between L and [formula], and x is a primitive k-th root of unity in L. From now on, we fix the isomorphism

[formula]

Then, t(x) maps to ζgk + 1 for some integer g such that 1  ≤  g  ≤  k and gcd (g,k) = 1, so

[formula]

Thus, y(x) maps to [formula]. Let y1(x) map to [formula] with degree less than deg r(x). If s(x) maps to [formula], we have

[formula]

Obviously, we have [formula] and deg y(x) =  deg y1(x). Then, for the ρ-value, we have

[formula]

where φ is Euler's totient function. Thus, for bounding ρ(t,r,q), we need to estimate deg t(x) or deg y1(x).

Here, we want to indicate a simple fact which will be used several times later on. Let [formula] be the conductor of the quadratic field [formula], and in fact [formula] is equal to the absolute value of its discriminant. By Kronecker-Weber theorem, [formula] is the smallest integer n such that the n-th cyclotomic field contains [formula]. Since [formula] and using the discriminant formula of quadratic fields, we have

[formula]

Let k = 2m for some integer m  ≥  0, then Theorem [formula] () is true.

If k = 1,2, by [\eqref=Dk], the cyclotomic family (t(x),r(x),q(x)) actually does not exist. So, we must have m  ≥  2. Later on, we will see that actually we must have m  ≥  3.

By [\eqref=Dk], if m = 2, then we must have D = 1; otherwise if m  ≥  3, then D = 1, or 2.

First, assume that D = 1. Notice that [formula]. Then [formula] (mod r(x)). Here, r(x) = x2m - 1 + 1. For m = 2, by direct calculations following Theorem [\ref=Brezing-Weng], we have [formula] if g = 1, and [formula] if g = 3, both of them do not represent primes, so the cyclotomic family (t(x),r(x),q(x)) actually does not exist. Thus, we must have m  ≥  3. Notice that g is an odd integer. It is straightforward to show that Thus, we always have max { deg t(x), deg y1(x)}  ≥  2m - 2 + 1, which implies that

[formula]

where the equality can possibly be achieved when g = 1, that is t(x) = x + 1.

Now assume that D = 2. In this case, we must have m  ≥  3. It is easy to see that [formula]. Then we have [formula] (mod r(x)). Notice that g is an odd integer and 2m - 2 + 2m - 3 < 2m - 1, then in view of the form of r(x), the term - x2m - 2 + 2m - 3 is always non-vanishing. So, deg y1(x)  ≥  2m - 2 + 2m - 3, which implies that

[formula]

Therefore, we complete the proof of Proposition [\ref=2^m].

For any odd prime p and integer n  ≥  1, Theorem [formula] () is true for k = pn.

If [formula] (mod 4), by [\eqref=Dk], we only possibly have D = 1 or k = p, both of which lead to 4|k. This is impossible, so the cyclotomic family (t(x),r(x),q(x)) actually does not exist. So, we must have [formula] (mod 4).

Since k = pn with [formula] (mod 4) and applying [\eqref=Dk], we must have D = p. It is well-known that

[formula]

where [formula] is the Legendre symbol, see [\cite=Shafarevich1966]. Thus,

[formula]

We first suppose that p = 3. Then we have

[formula]

where r(x) = x2  ·  3n - 1 + x3n - 1 + 1. For n = 1, that is k = 3, by direct calculations following Theorem [\ref=Brezing-Weng], we have q(x) = (x + 1)2 if g = 1, and q(x) = x2 if g = 2, both of them do not represent primes, so the cyclotomic family (t(x),r(x),q(x)) actually does not exist. So, when p = 3, we must have n  ≥  2. Notice that gcd (g,3) = 1 and n  ≥  2. It is straightforward to show that

[formula]

Thus, we always have max { deg t(x), deg y1(x)}  ≥  3n - 1 + 1, which implies that

[formula]

where the equality can possibly be achieved when g = 1, that is t(x) = x + 1.

Now we assume that p > 3 and n  ≥  2. By the choice of p, we have p  ≥  7. Put

[formula]

Since [formula] and n  ≥  2, every exponent of x appearing in r(x) is divisible by p. Notice that every apn - 1 + g is coprime to p. So

[formula]

Then it suffices to consider y2(x).

Since [formula], it is easy to see that

[formula]

Note that the degree of the above polynomial on the right hand side is less than deg r(x), we have [formula]. Note that, for p  ≥  7, there exists an integer b such that [formula]. Indeed, when p  ≥  17, we have [formula]; for other p  ≥  7, one can verify it by direct computation. Combining with [formula], we have

[formula]

Thus, deg y2(x)  ≥  b2pn - 1 > 11pn / 20, which implies that

[formula]

Finally, we assume that p > 3 and n = 1. Okano [\cite=Okano2012] showed that ρ(t,r,q)  ≠  1. Indeed, by combining [\eqref=Legendre] and the later part in [\cite=Okano2012], one can similarly deduce that ρ(t,r,q) > 1.1.

Therefore, Proposition [\ref=p^n] has been proved.

For any odd prime p and integer n  ≥  1, Theorem [formula] () is true for k = 2pn.

If [formula] (mod 4), similarly as before, the cyclotomic family (t(x),r(x),q(x)) does not exist. So, we must have [formula] (mod 4).

Since k = 2pn with [formula] (mod 4), by [\eqref=Dk], we must have D = p. Notice that ζk =  - ζpn, we have

[formula]

Then

[formula]

Notice that [formula]. If we put z =  - x, in view of [\eqref=p^ny_1], we almost reduce our proof to the case of Proposition [\ref=p^n] except that t(x) is congruent to - zg + 1 modulo [formula] after substitution. Thus, Proposition [\ref=2p^n] can be proved similarly when p = 3,n  ≥  1, or p > 3,n  ≥  2.

Now, we assume that p > 3 and n = 1. Okano [\cite=Okano2012] showed that ρ(t,r,q)  ≠  1. Indeed, by combining [\eqref=Legendre] and the later part in [\cite=Okano2012], one can also deduce that ρ(t,r,q) > 1.1.

Therefore, we complete the proof of Proposition [\ref=2p^n].

To handle more complicated cases, we need some preparations.

For an odd prime p, integers m  ≥  1 and n  ≥  1, it is well-known that

[formula]

For each integer i  ≥  1, define

[formula]

By definition, every fi(x) is well-defined and unique.

For integer i with 1  ≤  i < 2m - 1pn - 1(p - 1), we have fi(x) = xi .

For any odd prime p and positive integers j,m,n, let i = j  ·  2m - 1pn. Then, we have

[formula]

We prove this lemma by induction. For j = 1, it is straightforward to verify the desired formulas. Now for j  ≥  2, assume that the desired formulas are true for j - 1.

Put b = j  ·  2m - 1pn - 2m - 1pn - 1. Then all we need to do is to compute fb(x). Notice that b - 1 = (j - 1)2m - 1pn + 2m - 1pn - 1(p - 1) - 1, by the assumption we have fb - 1(x) = ( - 1)j - 1x2m - 1pn - 1(p - 1) - 1. Thus

[formula]

Then the other formulas follow easily.

For any odd prime p with [formula] (mod 4) and integers, m  ≥  2 and n  ≥  1, Theorem [formula] () is true for k = 2mpn.

By [\eqref=Dk], if m = 2, then D = 1 or D = p; otherwise if m  ≥  3, then D = 1,2,p, or 2p.

First, assume that D = 1. Since [formula], we have

[formula]

Here, [formula], which is also a polynomial with respect to x2. Since g is an odd integer, the two integers 2m - 2pn + g and 2m - 2pn have different parities. Note that 2m - 2pn  <   deg r(x). So, the term - x2m - 2pn does not vanish, and then we have deg y1(x)  ≥  2m - 2pn, which implies that

[formula]

We claim that the above equality can possibly be achieved. Indeed, if m = 2, we choose g = pn + 2 < k, then gcd (g,k) = 1, and by Lemma [\ref=fn], we have y1(x) =  - x2 - xpn, so we get the equality. Otherwise if m > 2, we choose g = 2m - 2pn + 1 < k, then gcd (g,k) = 1, and by Lemma [\ref=fn], we have y1(x) =  - x - x2m - 2pn, so we still get the equality.

Suppose that D = 2. Note that in this case we must have m  ≥  3. Since [formula], we have

[formula]

Notice that the two integers 3  ·  2m - 3pn + g and 2m - 3pn + g have the same parity, and the two integers 3  ·  2m - 3pn and 2m - 3pn have the same parity, but 2m - 3pn + g and 2m - 3pn have different parities. For p > 3, note that 3  ·  2m - 3pn  <   deg r(x), then the term - x3  ·  2m - 3pn does not vanish, so we have deg y1(x)  ≥  3  ·  2m - 3pn, which implies that

[formula]

If D = 2 and p = 3, we have

[formula]

where r(x) = x2m3n - 1 - x2m - 13n - 1 + 1. Then we obtain

[formula]

Notice that deg r(x) > 5  ·  2m - 33n - 1. As before, we have deg y1(x)  ≥  5  ·  2m - 33n - 1, which implies that

[formula]

Now suppose that D = p. Since [formula], we have

[formula]

Put

[formula]

Notice that r(x) is also a polynomial with respect to x2, and every a2mpn - 1 + g is an odd integer. So, the leading term of - y2(x) appears in y1(x). Thus, we have

[formula]

Then we only need to consider y2(x). Put z = x2m - 1pn - 1, then r(x) = Φ2p(z). Define

[formula]

Then deg y2(x) = 2m - 1pn - 1 deg y3(z).

Applying Lemma [\ref=fn] by setting m = 1 and n = 1, and noticing that [formula] for any integer a, we get

[formula]

As [\eqref=Legendre], for p  ≥  7, there exists an integer b such that

[formula]

So, deg y3(z)  ≥  b2, which implies that for p  ≥  7, we have

[formula]

For the case D = p and p = 3, we have

[formula]

where r(x) = x2m3n - 1 - x2m - 13n - 1 + 1. Let [formula] (mod r(x)) with deg w1(x) <  deg r(x), and denote d =  deg w1(x). Since g is an odd integer, d is also odd. If d < 2m - 13n - 1, then d + 2m - 13n - 1  <   deg r(x), so in view of the term 2x2m - 13n - 1 + g, we have deg y1(x) = d + 2m - 13n - 1. If d > 2m - 13n - 1, let [formula] (mod r(x)) with deg w2(x) <  deg r(x), by Lemma [\ref=fn] the coefficient of xd in w1(x) is ±  1, but the coefficients in w2(x) are ±  2, so the term xd does not vanish, then deg y1(x)  ≥  d. Thus, we always have deg y1(x)  ≥  2m - 13n - 1 + 1, which implies that

[formula]

where the equality can possibly be achieved when g = 1, that is t(x) = x + 1.

Now assume that D = 2p. In this case, we must have m  ≥  3. Since [formula], we have

[formula]

Then

[formula]

Put

[formula]

with deg y2(x) <  deg r(x). Similarly as before, we have

[formula]

Then we only need to consider y2(x). Set z = x2m - 3pn - 1, then r(x) = Φ8p(z). Define

[formula]

Obviously, we have

[formula]

Define

[formula]

Then y3(z) = y31(z) - y32(z). Since Φ8p(z) is a polynomial with respect to z4 and for any two integers a and b, 8a + 3p is not congruent to 8b + p modulo 4, we have

[formula]

Furthermore we suppose that [formula] (mod 8). Then we can define the following for non-negative integers α,β,u and v:

[formula]

Applying Lemma [\ref=fn] by setting m = 3 and n = 1, we obtain

[formula]

It is easy to see that in the above summation any integer power of z can appear at most two times. Let b be the integer [formula]. Note that β + 1  ≤  b  ≤  v, [formula], and 8b - 3p = 3p - 2. So there is one term [formula] in the above summation. In addition, since [formula], we have [formula]. Choose [formula], we have a  ≤  p - 2 and 4a + 3 = 3p - 2, note that a is odd by the choice of p, so there is another one term [formula] in the above summation. Thus, y32(z) has one term 2z3p - 2. So, we have deg y32(z)  ≥  3p - 2, then deg y3(z)  ≥  3p - 2, which implies that

[formula]

Finally we suppose that [formula] (mod 8) under the assumption D = 2p. As before, we define the following for non-negative integers α,β,u and v:

[formula]

Applying Lemma [\ref=fn] by setting m = 3 and n = 1, we obtain

[formula]

It is easy to see that in the above summation any integer power of z can appear at most two times. Let b be the integer [formula]. Note that 1  ≤  b  ≤  β, [formula], and 8b + p = 3p + 2. So there is one term [formula] in the above summation. In addition, since [formula], we have [formula]. Choose [formula], we have a  ≤  p - 2 and 4a + 3 = 3p + 2, note that a is odd by the choice of p, so there is another term [formula] in the above summation. Thus, y32(z) has one term 2z3p + 2. So, we have deg y32(z)  ≥  3p + 2, then deg y3(z)  ≥  3p + 2, which implies that

[formula]

Therefore, we complete the proof of Proposition [\ref=2^mp^n3].

For any odd prime p with [formula] (mod 4) and integers, m  ≥  2 and n  ≥  1, Theorem [formula] () is true for k = 2mpn.

By [\eqref=Dk], if m = 2, then D = 1 or D = p; otherwise if m  ≥  3, then D = 1,2,p, or 2p.

For the cases D = 1,2, we can apply the same argument as the proof of Proposition [\ref=2^mp^n3] to verify the desired result.

Now suppose that D = p. Since [formula] (mod 4), we have [formula], then

[formula]

Then

[formula]

Put

[formula]

Notice that r(x) is also a polynomial with respect to x2, and that every 2m - 2pn - 1(4a + p) + g and 2m - 2pn - 1(4b + p) have different parities for any two integers a,b. So as before, we have

[formula]

Then, we only need to consider y2(x). Put z = x2m - 2pn - 1, then r(x) = Φ4p(z). Define

[formula]

Clearly, we have

[formula]

Assume that p = 4b + 1. Applying Lemma [\ref=fn] by setting m = 2 and n = 1, and noticing that [formula] for any integer a, we have

[formula]

We first let p > 5. By the choice of p, we have p  ≥  13. Note that since [formula] (mod 4), we have [formula] for any integer a. Now we claim that there exists an integer [formula] such that [formula]. Indeed, assume that for any integer [formula], we have [formula], and thus [formula]. Using proof by contradiction, we can find that 2a + 1 is not congruent to - 2c - 1 modulo p for any [formula]. Then, the set [formula] is contained in some complete set S of representatives for {a:1  ≤  a  ≤  p - 1} (mod p) and its cardinality is [formula]. So, there exist [formula] elements a∈S with [formula]. However, we know that there are exactly [formula] elements a∈S with [formula]. So the claim is proved. Thus, y3(z) has one term ( - 1)a + 12z2a + 1 with [formula]. So, we have [formula], which implies that

[formula]

Now we let p = 5. Then we directly obtain y3(z) = 2z7 - z5 + 2z3, which implies that

[formula]

Now assume that D = 2p. Since [formula], we have

[formula]

Then

[formula]

Put

[formula]

with deg y2(x) <  deg r(x). Similarly as before, we have

[formula]

Then we only need to consider y2(x). Set z = x2m - 3pn - 1, then r(x) = Φ8p(z). Define

[formula]

Obviously, we have

[formula]

Moreover, define

[formula]

Then y3(z) = y31(z) + y32(z). Since Φ8p(z) is also a polynomial with respect to z4, and 8a + 3p is not congruent to 8b + p modulo 4 for any two integers a and b, we have

[formula]

Furthermore we suppose that [formula] (mod 8). Then we can define the following for non-negative integers α,β,u and v,

[formula]

Applying Lemma [\ref=fn] by setting m = 3 and n = 1, and noticing that [formula], we obtain

[formula]

By the choice of p, we find that [formula] is an even integer, c  ≤  p - 2, and 4c + 3 = 3p. So, there is one term ( - 1)c + 1z4c + 3 =  - z3p in the above summation. Notice that the three integers 8a + 3p,8a - p,8a - 5p are not equal to 3p for any 1  ≤  a  ≤  p - 1. Thus, y31(z) has one term - z3p. So, we have deg y31(z)  ≥  3p. Then deg y3(z)  ≥  3p, which implies that

[formula]

Finally we suppose that [formula] (mod 8) under the assumption D = 2p. As before we define the following for non-negative integers α,β,u and v:

[formula]

Applying Lemma [\ref=fn] by setting m = 3 and n = 1, and noticing that [formula], we obtain

[formula]

By the choice of p, we find that [formula] is an odd integer, c  ≤  p - 2, and 4c + 3 = 3p. So, there is one term ( - 1)c + 1z4c + 3 = z3p in the above summation. Notice that the three integers 8a + 3p,8a - p,8a - 5p are not equal to 3p for any 1  ≤  a  ≤  p - 1. Thus, y31(z) has one term z3p. So we have deg y31(z)  ≥  3p. Then deg y3(z)  ≥  3p, which implies that

[formula]

This completes the proof of Proposition [\ref=2^mp^n1].

Numerical data

In this section, we use PARI/GP to test the cyclotomic families in Theorem [\ref=Thm1] with embedding degree k  ≤  82. Without presenting the source codes, we want to explain briefly how we can achieve this.

Here, we use the notation at the beginning of Section [\ref=Proof1]. To construct the cyclotomic families with embedding degree k and CM discriminant D considered in Theorem [\ref=Thm1], first calculate r(x) = Φk(x), and then compute for 1  ≤  g  ≤  k and gcd (g,k) = 1. In our cases, if g is given, then s(x) has an explicit formula, see Section [\ref=Proof1]. But here we use a uniform way to obtain s(x), that is to find a root of X2 + D in the field [formula], which can be done in PARI/GP, see [\cite=Kang2007] for more details. So, for any given g, following Theorem [\ref=Brezing-Weng], we can construct polynomials t(x),y(x),q(x) explicitly. Note that t(x) automatically represents integers. To test whether (t(x),r(x),q(x)) is a cyclotomic family, we need to test whether q(x) represents primes and whether y(x) represents integers. Letting g run through all the possibilities, we obtain all the corresponding cyclotomic families, and then we can easily get the smallest ρ-value and determine whether the smallest possible ρ-value indicated in Theorem [\ref=Thm1] can be achieved.

Now, we explain how to test whether a given polynomial [formula] represents integers or represents primes, actually it is easy and it has also been discussed below Definition 2.5 of [\cite=Freeman2010].

For a given polynomial [formula], let N be the least common multiple of the denominators of its coefficients. To test whether it represents integers, we only need to calculate f(n) for 0  ≤  n < N.

Now, to test whether f(x) represents primes, by Definition [\ref=reprime], we only need to explain how to test [formula]. Assume that f(x) represents integers, compute [formula], and suppose that M  ≠  1. Then for every prime factor p of M, to determine whether [formula], we only need to test whether f(n) is divisible by p for all 0  ≤  n < pN when [formula]. If [formula] for every prime factor p of M, then we have [formula].

Using the above discussions, we can write some programs in PARI/GP to obtain Table [\ref=data]. Here, we omit the details.

For each k  ≤  82 with the form k = 2mpn, Table [\ref=data] gives the parameters (ρk,D,g, deg t(x)) of a cyclotomic family in Theorem [\ref=Thm1] with smallest ρ-value ρk. For example, given k and (ρk,D,g, deg t(x)), one can use the above discussions to construct a cyclotomic family (t(x),r(x),q(x)) with embedding degree k, CM discriminant D and ρ-value ρk. Notice that for a given k, there may exist several cyclotomic families with smallest ρ-value ρk, here among them we choose a family such that t(x) has smallest degree. We also want to indicate that for some k there are no such cyclotomic families with embedding degree k.

Acknowledgement

The author would like to thank Keiji Okano for sending us his recent work [\cite=Okano2012]. He also thanks the referee for careful reading and useful comments.