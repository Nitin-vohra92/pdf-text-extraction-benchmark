On the expected time a branching process has K individuals alive

Keywords: Branching process; splitting tree; insensitivity result.

AMS2010 Subject classification: 60J80

Introduction and main result

Consider a homogeneous time-continuous branching process X having life-length distribution Q, where we measure time in the unit of expected life-lengths, implying that E(Q) = 1. During their lives, individuals give birth according to independent Poisson processes with constant rate δ, where each birth consists of a single child. Let X(u) denote the number of individuals alive at time u, and assume that the process has one ancestor, i.e. that X(0) = 1.

Such branching processes have been studied extensively, see, for example, Jagers [\cite=J75] and are sometimes referred to as (binary) splitting trees, see, for example, Champagnat et al. [\cite=CLR] . It is well-known that the branching process is subcritical, critical or supercritical depending on whether δ is smaller than, equal to, or larger than 1, and that P(X(u)  →    ∞  ) > 0 if and only if δ > 1.

Let N denote the number of individuals ever born in the branching process and let [formula] denote the life-lengths of the individuals (for example, labelled according to time of birth). It then holds that

[formula]

where all three expressions equal infinity if the branching process grows beyond all limits. It is well-known that the expectation of ([\ref=tot-int]) is finite if and only if δ < 1, and, using Wald's lemma, that the mean then equals E(N)E(Q) = E(N) = 1 / (1 - δ).

In the current paper we are interested in the expectation of each of the terms on the right hand side of ([\ref=tot-int]). The factor K is just a constant, so we instead choose to state our result for

[formula]

the expected time the branching process has K living individuals, or the expected "K-occupation" time. We have the following result:

Consider a branching process with birth rate δ and life-length distribution Q, with E(Q) = 1 but otherwise arbitrary. Let X(u) denote the number of individuals alive at time u, and assume X(0) = 1. Then, for [formula] we have

[formula]

The proof of Theorem [\ref=th1] is given in Section [\ref=S:proof].

Remark 1. The statement of the theorem was conjectured by Neal [\cite=N13] who also proved it for the case that Q  ~  Exp(1) and δ < 1. In Neal [\cite=N13], it was shown that E(AK) is the key quantity for computing the asymptotic endemic equilibrium distribution for a subcritical branching process with immigration and a supercritical, homogeneously mixing SIS epidemic model.

Remark 2. Theorem [\ref=th1] is an example of an insensitivity result, in that, E(AK) only depends upon Q through its mean. Similar results have been observed for queueing networks, see Zachary [\cite=Z07], for an overview. Furthermore, Theorem [\ref=th1] follows straightforwardly from Zachary [\cite=Z07], Theorem 1 in the subcritical case δ < 1. However, Zachary [\cite=Z07], Theorem 1 does not appear to be easy to adapt to critical and supercritical branching processes.

The total time until extinction is given by [formula]. It is well-known that this time has infinite mean in the critical and supercritical case (δ  ≥  1). An immediate consequence of the theorem tells us what the mean equals in the subcritical case.

Under the same setting as Theorem [\ref=th1] and for the case that δ < 1 we have

[formula]

Remark. The case δ = 0 can be taken as a limit of ([\ref=Eq-cor]) and the mean is hence E(T) = 1 as it should.

Theorem [\ref=th1] and Corollary [\ref=E(T)] have direct implications for inference on δ when data consists of observing AK or [formula] (cf. Farrington and Grant [\cite=FG99]).

Let K  ≥  2 and suppose that AK = tK is observed for the branching process described above. If the process is known to be subcritical (δ < 1), then the moment estimator of δ is given by  = (KtK)(K - 1)- 1. If the process is super critical the moment estimator is given by  = 1 / (KtK). If instead T = t is observed and the process is known to be subcritical, then the moment estimator [formula] is the largest solution to 1 - δ = e-  δt.

Remark 1. It might seem unnatural to assume sub- or super-criticality to be known when making inference. It is however well-known that branching processes possess many non-standard inference features (cf. Guttorp [\cite=G91]).

Remark 2. In terms of applications, branching processes are common models for populations but also for epidemics, at least when the outbreaks are small. Corollary [\ref=est-delta] treating estimation problems is hence of interest in these situations, see, for example, Farrington and Grant [\cite=FG99], treating inference problems for a related discrete time version of epidemics.

Remark 3. The transcendental equation 1 - δ = e-  δt appears also in mathematical epidemiology, where t is a measure of infectiousness of the disease and δ is the ultimate fraction getting infected in the epidemic. From this theory (e.g. Diekmann et al. [\cite=DHB12]) it is known that there is a unique positive solution [formula] in (0,1) if and only if t > 1. If t  ≤  1 then the largest solution is  = 0.

Knowing that the expected K-occupation time, E(AK), is independent of the life-length distribution Q, subject to E(Q) = 1, raises the question if the result holds even under more general assumptions. The answer to this question is negative, at least if we generalize the current model, having constant birth rate during Q, to a model where the birth rate is inhomogeneous (time-varying) together with a random duration of the life-length distribution such that the expected number of births still equals δ. For this extended model the corresponding K-occupation time is no longer constant (and the same as in Theorem [\ref=th1]). A simple illustration of this is for example [formula] and δ large, e.g. 10, and K = 1 and we compare two time-varying birth rates. The first model is where nearly all of the birth intensity comes early in life and the second where it comes close to the end of the life period (i.e. close to 1). Since the process will probably never return to 1 (being "very" super critical), most of the expected time spent with K = 1 individual alive comes from before the first birth, which is clearly longer in the second model. Also the result no longer holds if we allow the possibility of multiple births at each point of Poisson point process with rate δ. It is straightforward to construct a counter example comparing [formula] and Q  ~  Exp(1) since for [formula] all individuals born at the same time will die at the same time.

Proof of Theorem [\ref=th1]

Introduction

The approach we take to prove Theorem [\ref=th1] is to consider phase-type distributions (Asmussen et al. [\cite=Asmussenetal.1996] ) for Q. Specifically, we take Q to be a finite mixture of hypoexponential distributions. That is, we assume that there exists [formula] such that Q is a mixture distribution of [formula] with P(Q  =  Qi) = pi [formula] and, for each i, there exists [formula] such that

[formula]

with [formula]. Therefore an individual has a lifetime distributed according to Qi with probability pi, where the lifetime Qi consists of ni stages each of which lasts an exponential length of time. Thus if we know the distribution from which each of the individual lifetimes come and the stage at which each individual is at in their lifetime, the branching process is Markovian. Any Coxian distribution (Asmussen et al. [\cite=Asmussenetal.1996]) can be expressed as a mixture of hypoexponential distributions, and therefore the above class of mixtures of hypoexponential distributions is dense, Asmussen et al. [\cite=Asmussenetal.1996]. Hence Theorem [\ref=th1] follows trivially if we can show that [formula] holds for the mixtures of hypoexponential distributions.

For [formula], let ki,j denote the total number of individuals with a lifetime distributed according to Qi who are currently in stage j of their lifetime with [formula] and [formula]. To consider the transitions to and from state [formula] it is helpful to define [formula] to be a vector of length [formula] whose (i,j)th ([formula]) element is 1 and all other elements are 0. Transitions from state [formula] occur as follows:-

[formula]

with [formula]. The Markov branching (birth-death) process defined by [\eqref=eq:trans] will almost surely go extinct in the subcritical and critical case. For the supercritical branching process, the branching process will either go extinct or grow exponentially large. In all three cases (subcritical, supercritical and critical branching processes) we study a modified process which results in an irreducible, aperiodic and positive recurrent Markov chain. The stationary distribution of the modified process is the key tool for computing E(AK). The details of the appropriate modified process differs between the three classes of branching process and we therefore consider each in turn. We use detailed balance to prove the stationary distribution of the modified process which is that same approach that is often used in queueing theory to prove insensitivity results, see, for example, Whittle [\cite=Whittle] and Zachary [\cite=Z07] and references therein.

Subcritical branching process: δ < 1

Theorem [\ref=th1] can be proved in the subcritical case using Zachary [\cite=Z07], Theorem 1. However, it is instructive for studying the supercritical case to outline a proof of the result. The branching process will almost surely go extinct and we modify [\eqref=eq:trans] by regenerating the branching process whenever it goes extinct by restarting the branching process with a new individual whose lifetime is distributed according to Ql with probability pl. This is the regeneration approach introduced in Hernández-Suárez and Castillo-Chavez [\cite=HSCC99] and extended in Ball and Lyne [\cite=BL02]. That is, for [formula] replace [formula] by [formula] with probability pl [formula]. The modified process is an irreducible, aperiodic and positive recurrent Markov chain and therefore has a unique stationary distribution. Let [formula] denote the stationary probability of the population being in state [formula].

For all [formula],

[formula]

where qi,j  =  pi  /  γi,j, C  =    -  δ  /   log (1 - δ) and [formula].

For K  ≥  1, let [formula] and

[formula]

Proof. To prove the Lemma it is sufficient to show that [formula] given by [\eqref=eq:stat1] satisfies detailed balance. That is,

[formula]

where [formula] is the rate at which transitions from state [formula] to state [formula] take place.

We start with the right hand side of [\eqref=eq:stat2] in the case, where [formula] and we do not need to consider the regeneration modifications.

The possible transitions to state [formula] are from [formula] [formula], [formula] and [formula]. We have the following three equalities. For [formula] and [formula],

[formula]

For [formula],

[formula]

and

[formula]

It follows from ([\ref=eq:qq1]-[\ref=eq:qq3]) that

[formula]

as required.

For [formula] and [formula], we have that

[formula]

as required.

Since [formula], [\ref=eq:stat1a] follows trivially from [\ref=eq:stat1] and C  =    -  δ  /   log (1 - δ) follows from [formula]. [formula]

The above tells us that in equilibrium the modified process spends a proportion φK of its time with K individuals alive. It does not tell us directly the mean amount of time, E(AK), that the branching process has K individuals. Each cycle, between regenerations, of the modified process corresponds to a single realisation of the branching process. As noted in that the mean total size of the subcritical branching process is 1 / (1 - δ). Thus the mean regeneration time, E(T), satisfies

[formula]

which gives E(T)  =  1 / C =   -   log (1 - δ) / δ cf. Corollary [\ref=E(T)]. Hence E(AK)  =  E(T)φK  =  δK - 1 / K is the mean time the original subcritical branching process with 1 initial ancestor spends with K individuals alive.

Supercritical case: δ  >  1

We modify the approach taken in Section [\ref=S:d<1] to obtain E(AK)  =  1 / (Kδ) when δ > 1. In this case the expected size of the branching process is infinite and there is a non-zero probability of never going extinct. This leads to key differences from the subcritical case which need to be resolved. Therefore we modify the branching (birth-death) process, defined by [\eqref=eq:trans], to create a population process, PN, which is restricted to [formula] individuals for some [formula]. The population process evolves as the branching process except for transitions which lead to 0 or N + 1 individuals in the branching process. In particular, any transition in the branching process which leads to N + 1 individuals (a birth when there are N individuals) leads to the population process restarting with 1 individual whose lifetime is distributed according to Q. (A catastrophic event killing all N individuals in the population combined with a regeneration event, the birth of a new individual.) Also extinction of the branching process (death of the only individual) is replaced by the population process moving to a state with N individuals alive. (This move does not have a natural interpretation.) The lifetime stages of the N individuals will be discussed below. The population process is rather different to the regeneration process used for the subcritical case in Section [\ref=S:d<1] but the resulting Markov chain has a finite state space and is aperiodic and irreducible and therefore has a unique stationary distribution.

For any [formula], the population process PN with stationary distribution [formula] satisfies the following.

For all [formula], with [formula],

[formula]

where [formula] and [formula] satisfies [formula],

[formula]

For 1  ≤  K  ≤  N, let [formula] then

[formula]

We comment briefly on the statement of Lemma [\ref=lemmab2] before embarking on the proof. Firstly, the form of [formula] given by [\eqref=eq:star1] is very similar to that for [formula] given by [\eqref=eq:stat1]. The key difference is that δ does not feature explicitly in [\eqref=eq:star1] and wi,j has a more complicated form than qi,j  =  pi  /  γi,j. For the subcritical case qi,j is the probability that an alive individual is in the jth stage of a lifetime distributed according to Qi and wi,j plays the same role for the supercritical case. In the supercritical case, the branching process is growing and we observe that wi,1  >  qi,1 and wi,ni  <  qi,ni. Fortunately it is not necessary to compute [formula], although for Q  ~  Gamma(2,2) it is straightforward to show that w1,1 = w and w1,2  =  1 - w, where [formula]. Secondly, [\eqref=eq:star1a] follows trivially from [\eqref=eq:star1] and gives us that [formula]. Therefore after proving Lemma [\ref=lemmab2], we show that the constant of proportionality is 1 / δ.

Proof of Lemma [\ref=lemmab2]. Fix [formula]. We follow Lemma [\ref=lemmab1] in proving the lemma using detailed balance. That is, showing that for all [formula], [formula] given by [\eqref=eq:star1] satisfies

[formula]

We start with the right hand side of [\eqref=eq:star2] in the case, where [formula] or K = N, that is, we do not need to worry about modifications.

The possible transitions to state [formula] are from [formula] [formula], [formula] and [formula]. We have the following three equalities which are similar to ([\ref=eq:qq1]-[\ref=eq:qq3]) in Lemma [\ref=lemmab1]. However, there are differences due to the different form of [formula] between the subcritical and supercritical case. For [formula] and [formula],

[formula]

For [formula],

[formula]

and

[formula]

The rate of transition out of state [formula] is [formula]. Hence, for [\eqref=eq:star2] to hold, it follows from ([\ref=eq:qr1]-[\ref=eq:qr3]) that we require that

[formula]

Equating the coefficients of the ki,j terms we get [formula] solving [\eqref=eq:star3a] and [\eqref=eq:star3b]. Therefore we need to check that this choice of [formula] is also consistent with the boundary cases.

For [formula] such that K = N, we have that

[formula]

where, with an abuse of notation, we take [formula] to satisfy [\eqref=eq:star1] with K = N + 1. That is, the transitions from a single individual to N individuals in the modified process mimic the transitions in the branching process from N + 1 individuals to N individuals. All other transitions in and out of state [formula] are identical to the branching process and it is straightforward to verify that [\eqref=eq:star2] holds.

For [formula], we have that the transitions into state [formula] are from [formula] and from any [formula] such that K = N. Using [formula], the rate of entry into state [formula] is

[formula]

The rate of exit from state [formula] is (γl,1  +  δ). Hence, from [\eqref=eq:star5] we require that

[formula]

However, [\eqref=eq:star6] is equivalent to [\eqref=eq:star3a]. (Simply multiply both sides of [\eqref=eq:star3a] by LNwl,1.) Therefore completing the proof that [formula] is indeed the stationary distribution of the modified population process. [formula]

We now show that E(AK)  =  1 / (δK) by studying the total amount of time, TN, that a supercritical branching process spends with between 1 and N individuals alive. In particular we study the asymptotic behaviour of TN as N  →    ∞  . The supercritical branching process either goes extinct with probability, z, or explodes (X(u)  →    ∞   as u  →    ∞  ) with probability, 1 - z. It is helpful to consider these two cases separately with Ext denoting the event that the branching process goes extinction. Firstly, it follows from Champagnat et al. [\cite=CLR], Proposition 2.1, that z = 1 - η  /  δ , (see also Lambert [\cite=Lambert], Section 5), where η is the Malthusian parameter of the branching process. Moreover, Lambert [\cite=Lambert], Proposition 5.7 gives the law of the supercritical process conditional upon extinction which is a subcritical branching process with a modified lifetime distribution and birth rate δ  -  η. Thus it is trivial to show that E(TN|Ext)  =  O(1). Conditional upon non-extinction, Champagnat et al. [\cite=CLR], Proposition 2.2 states, [formula] as u  →    ∞  , where Y is exponential random variable with mean dependent upon η and Q. (This is proved in Lambert [\cite=Lambert] and is a special case of Nerman [\cite=Nerman], Theorem 5.4.) Let TFN  =   min {u;X(u) = N + 1} and TLN  =   max {u;X(u) = N} denote the first time X(u) leaves [formula] and the last time X(u) belongs to [formula] with TFN  ≤  TN  ≤  TLN. Then conditional upon non-extinction, it is straightforward to show that [formula] as N  →    ∞   and consequently that [formula] as N  →    ∞  . Given the structure of the branching process it is straightforward to show that there exists 0  <  q < 1, such that for all [formula], P(T̃N  >  m)  ≤  qm, and hence, that E(T̃N|ExtC)  →  1 as N  →    ∞  . Therefore

[formula]

Since the above holds for all N, we have that

[formula]

as required.

Critical case: δ  =  1

For the critical case the expected duration of the branching process is infinite and the probability of non-extinction is 0, which makes studying this case particularly difficult. The modified population process defined in Section [\ref=S:d>1] can still be constructed in this case and Lemma [\ref=lemmab2] still holds with qi,j( = pi  /  γi,j)  =  wi,j. Thus it is straightforward to show that [formula] with [formula]. However, it is difficult to adapt the approach taken in Section [\ref=S:d>1] to show that E(AK) = 1 / K but to prove the result it suffices to fix Q and to show that E(A1) = 1.

We study the time that the branching process spends with one individual alive, which we term the local time process (of the branching process with one individual). Suppose that Q satisfies [\eqref=eq:qdist]. We say that the local time process is in state (i,j) if the individual is in the jth stage of lifetime Qi. The local time process regenerates with a new individual in state (i,1) with probability pi [formula] if the branching process goes extinct. Also since the branching process is critical it will almost surely go extinct. Therefore the branching process started from one individual will eventually return to one individual, although the mean waiting time is infinite. The transitions from state (i,j) in the local time process are given by:-

[formula]

where [formula] and r(i,j),(a,b) is the probability that following a birth to an individual in state (i,j) the next time the branching process returns to one individual, the sole individual will be in state (a,b). The matrix R  =  (r(i,j),(a,b)) is difficult to compute but we know the stationary distribution for the local time process from the stationary distribution of the branching process. Hence the probability of being in state (i,j) is qi,j  =  pi  /  γi,j. Therefore following Ball and Lyne [\cite=BL02], Section 2.2.3, we note that the overall intensity of regeneration of the local time process (extinction of the branching process) is [formula]. Thus the mean time between regenerations is E(A1) = 1- 1 = 1 as required.

Acknowledgements

The paper was written while T.B. spent a sabbatical semester at University of Florida. T.B. is grateful to Ira Longini and his group for their hospitality. We would like to thank Frank Ball for bringing Zachary [\cite=Z07] to our attention.