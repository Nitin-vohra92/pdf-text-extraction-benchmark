Theorem Proposition Lemma Corollary Conjecture Principle Definition Claim

Definition Problem Example Remark

Sum-product phenomena in [formula]: a brief introduction

introduction

If A and B are subsets of a ring then we write A  +  B: = {a  +  b:a∈A,b∈B} and A  ·  B: = {ab:a∈A,b∈B}.

The Bourgain-Katz-Tao theorem [\cite=bkt-paper] is a celebrated result roughly stating that there are no approximate subrings of [formula]. It has found a great many applications.

Suppose that δ  >  0 and that [formula] is a set of cardinality between pδ and p1  -  δ. Then there is some δ'  >  0 such that either A  ·  A or A  +  A has cardinality ≫  |A|1  +  δ'.

The requirement that [formula] was later dropped in work of Bourgain, Glibichuk and Konyagin. Shortly after the appearance of the Bourgain-Katz-Tao result, the following theorem was proved by Bourgain, Glibichuk and Konyagin.

Suppose that [formula] is a multiplicative subgroup of size at least pδ. Then uniformly in ξ  ≠  0 we have

[formula]

where δ'  =  δ'(δ)  >  0.

This states that multiplicative subgroups of [formula], even very small ones, have very little additive structure indeed: they are "additively pseudorandom". Theorem [\ref=bgk-theorem] is something of a triumph for additive combinatorics, for the question had previously been extensively studied by quite sophisticated number-theoretical arguments. The best result obtained with such methods applies only when δ  >  1 / 4; it is due to Konyagin [\cite=konyagin].

The first published proof of Theorem [\ref=bgk-theorem] utilised the Bourgain-Katz-Tao theorem, but subsequently it has been realised that Theorems [\ref=bkt] and the Bourgain-Katz-Tao theorem may be derived separately from some rather simpler considerations. We will partially follow a recent paper of Bourgain [\cite=bourgain-multi] as well as some unpublished notes of Elon Lindenstrauss, and give what seems to be about the simplest derivation of these two theorems. As in the original version, we shall only establish the Bourgain-Katz-Tao theorem under the assumption that [formula], and furthermore our method for proving Theorem [\ref=bgk-theorem] does not give the best known dependence of δ' on δ as δ  →  0.

Both theorems are manifestations of the sum-product phenomenon: additive and multiplicative structure find it hard to coexist.

Rough notation, Ruzsa calculus and Balog-Szemerédi-Gowers

One of my aims when giving the course [\cite=green-course] was to introduce various types of rough notation which, once comprehended, seem to make arguments easier to follow.

The most basic convention in force is that the letters c and C stand for absolute constants with 0  <  c  <  1  <  C, but that different instances of the notation, even on the same line, might refer to different constants. For all of the arguments in these notes each instance of one of these letters could be turned into a concrete constant by a keen reader. Occasionally we will use subscripts to denote dependence on other parameters; for example cα,β denotes a small positive absolute constant depending on α and β.

Rough notation at scale K. Let [formula] be a parameter. If X and Y are quantities then we write [formula] or [formula] to mean [formula], and X  ≈  Y if [formula] and [formula]. Different instances of the notation are allowed to involve different implied absolute constants C. The parameter K measures the "roughness" of this notation and it will be fixed for the duration of any given argument and referred to as the roughness parameter.

Ruzsa calculus. This is a notation for handling a number of inequalities for the size of sumsets discovered by Imre Ruzsa. Let [formula] be a roughness parameter. If A and B are finite sets in some abelian group then we write A  ~  B if [formula] in rough notation at scale K. Equivalently, A  ~  B if the Ruzsa distance between A and B, as introduced in [\cite=tao-vu], is O( log K). In the course [\cite=green-course] the following collection of statements was referred to as "Ruzsa calculus". In this proposition we write σ[A]: = |A + A| / |A| for the doubling constant of the set A.

Suppose that U,V and W are sets in some ambient abelian group. We use rough notation at some fixed scale K.

Suppose that U  ~  V. Then U  ~   - V, |U|  ≈  |V| and σ[U],σ[V]  ≈  1.

If U  ~  V and V  ~  W, then U  ~  W.

Suppose that U  ~  V , that σ[W]  ≈  1 and that there is some x such that [formula]. Then U  ~  V  ~  W.

Suppose that σ[U],σ[W]  ≈  1 and that there is some x such that [formula]. Then U  ~  W.

Suppose that U  ~  V  ~  W. Then U  ~  V  +  W.

Proofs of these statements may be found in [\cite=tao-vu] or in the second set of notes from my course [\cite=green-course].

Additive energy and Balog-Szemerédi-Gowers. If A and B are two finite sets in some abelian group then we write ω+(A,B) for |A|- 3 / 2|B|- 3 / 2 times the number of quadruples (a1,b1,a2,b2)∈A  ×  B  ×  A  ×  B with a1  +  b1  =  a2  +  b2. This quantity, called the additive energy, is easily seen to lie in the interval

[formula]

Simple instances of the sum-product phenomenon

The Bourgain-Katz-Tao theorem asserts that a set A must grow under either addition or multiplication. It is rather easier to establish that A grows under a small number of additions and multiplications, and for many applications results of this type suffice. Perhaps the simplest such result is due to Glibichuk and Konyagin. Before establishing it we prove a lemma.

Suppose that [formula] is a set. Then there is some [formula] such that [formula].

Remark. Here we have written ξ  ·  A: = {ξa:a∈A}.

Proof. There is one key idea, which is to use additive energy. The sum [formula] counts |A|- 3 times the number of solutions to a1  -  a2  =  ξ(a3  -  a4). For each of the |A|2(|A| - 1)2 quadruples (a1,a2,a3,a4) with a1  ≠  a2 and a3  ≠  a4 there is a unique choice of ξ  ≠  0 which satisfies this equation. If a1  =  a2 and a3  =  a4 then any choice of ξ works, and hence

[formula]

In particular there is some ξ for which

[formula]

The result follows immediately from the (simple direction of) the relationship between additive energy and sumsets, that is to say Proposition [\ref=bsg] (i).

Here is the promised result of Glibichuk and Konyagin, asserting that we have growth under addition and multiplication. Recall that if [formula] is an integer we write [formula] and [formula], where in each case there are k copies of the set A.

Suppose that [formula] is a set. Then we have [formula].

Proof. We begin with the observation that |A  +  ξ  ·  A|  =  |A|2 unless there are distinct pairs (a1,a2) and (a3,a4) with a1  +  ξa2  =  a3  +  ξa4, which means that [formula]. Suppose first of all that [formula] is not the whole of [formula]. Then there is some [formula] for which [formula] which, by the preceding remarks, implies that |A  +  (ξ  +  1)  ·  A|  =  |A|2. Supposing that [formula], we have

[formula]

This implies that |3A2  -  3A2|  =  |A|2. Alternatively, suppose that [formula]. Then by Lemma [\ref=lemma6.1] there is some ξ such that [formula]. Supposing that [formula] we may proceed much as before, observing now that

[formula]

This concludes the proof.

By repeated application of this theorem it is not hard to obtain the following corollary.

Let δ, 0  <  δ  <  1, be a parameter and suppose that [formula] is a set of cardinality at least pδ. Then there is some k  =  k(δ) such that [formula]. In particular if A is a multiplicative subgroup of [formula] then [formula].

Remark. The constant k(δ) could be taken to be eC / δC if desired.

Proof. By repeated application of Theorem [\ref=add-and-multiply] we can certainly find a k  =  k(δ) such that [formula]. The inequality is strict since p  >  2. It remains only to note that if [formula] has size greater than p / 2 then [formula]: indeed for any [formula] the sets X and t  -  X must intersect or else their union would have size greater that p.

In the above discussion we considered sumsets A  +  ξ  ·  A. For the next few paragraphs only let us write [formula]. Noting that [formula] if and only if A  ~  ξ  ·  A, the following collection of properties follow easily by Ruzsa calculus.

Let [formula]. We have the following statements.

If [formula] then [formula].

If [formula] then [formula].

If [formula] and ξ1  ≠    -  ξ2 then [formula].

If [formula] then [formula].

Proof. Only the last is not an absolutely immediate application of Ruzsa calculus. For it we need the additional observation that if A  ~  ξ2  ·  A then ξ1  ·  A  ~  ξ1ξ2  ·  A for any ξ1  ≠  0.

Using this, we can obtain the following rather pleasing expression of the sum-product phenomenon in [formula].

Let α and β, 0  <  α,β  <  1, be parameters. Suppose that [formula] are two sets with [formula] and [formula]. Then there is b∈B such that [formula].

Proof. Let k  =  k(β) be the number whose existence is guaranteed by Corollary [\ref=cor6.1], so that [formula]. Suppose that [formula] for all b∈B, that is to say suppose [formula]. Then by repeated applications of Lemma [\ref=alg-properties] we have

[formula]

where C depends only on k and hence, ultimately, on β. Thus

[formula]

for all [formula]. This, however, may be contrasted with Lemma [\ref=lemma6.1], which guarantees a ξ for which

[formula]

The corollary is immediate.

Additive-multiplicative Balog-Szemerédi-Gowers Theorem

Corollary [\ref=corollary6.2a] is particularly powerful in conjunction with the next result.

Suppose that [formula] is a roughness parameter and that [formula] and [formula] are sets. Suppose that ω+(A,b  ·  A)  ≈  1 for all b∈B. Then there is an x and subsets A'  ⊆  A and B'  ⊆  xB with |A'|  ≈  |A| and |B'|  ≈  |B| such that A'  ~  b'  ·  A' for all b'∈B'.

Proof. From the Balog-Szemerédi-Gowers theorem for each b∈B there are sets Xb,Yb  ⊆  A with |Xb|,|Yb|  ≈  |A| and |Xb  +  b  ·  Yb|  ≈  |A|. The task, of course, is to somehow remove the dependence of these sets on b.

We pause to observe a consequence of the Cauchy-Schwarz inequality which is useful in many situations.

Suppose that S is a finite set and that [formula] are subsets of S with [formula]. Then there is some i such that [formula] for at least δ2k / 2 values of j.

Proof. We have [formula]. By the Cauchy-Schwarz inequality this implies that [formula], that is to say [formula]. In particular there is some i for which [formula], and this easily implies the lemma.

Applying this with S  =  A  ×  A and the sets Si equal to Xb  ×  Yb, b∈B we see that there is some b0∈B and a set B' with |B'|  ≈  |B| such that

[formula]

Suppose that b∈B'. By assumption we have Xb  ~  b  ·  Yb and Xb0  ~  b0  ·  Yb0. In particular σ[Xb0],σ[Xb],σ[Yb0],σ[Yb]  ≈  1 and so by rule (iv) of Ruzsa calculus we have Xb0  ~  Xb and Yb0  ~  Yb, the second of which implies b  ·  Yb0  ~  b  ·  Yb. Comparing all of these equivalences we see that

[formula]

and hence Yb0  ~  (b / b0)  ·  Yb0. Redefining B' to be the set of b / b0 and setting A': = Yb0 concludes the proof of Proposition [\ref=ambsg].

Let us record the result of combining Proposition [\ref=ambsg] with Corollary [\ref=corollary6.2a].

Let α and β, 0  <  α,β  <  1, be parameters. Suppose that [formula] are two sets with [formula] and [formula]. Then there is b∈B such that [formula].

Proof. Suppose not: then there is some roughness parameter K  =  |A|o(1) such that ω+(A,b  ·  A)  ≈  1 for all b∈B. Using Proposition [\ref=ambsg] we may extract subsets A' and B' with [formula] and [formula] such that A'  ~  b'  ·  A' for all b'∈B'. This, however, is contrary to Corollary [\ref=corollary6.2].

The Bourgain-Katz-Tao theorem

In this section we prove Theorem [\ref=bkt], namely the lower bound on min (|A  +  A|,|A  ·  A|) under the assumption that [formula]. The key ingredient is the additive-multiplicative Balog-Szemerédi-Gowers theorem of Bourgain.

Suppose then that |A  +  A|,|A  ·  A|  ≈  |A|, where the underlying roughness parameter K has size po(1).

Consider first the sets a  ·  A, a∈A. An application of Lemma [\ref=cbs-sets] implies that there is some a0∈A such that

[formula]

for [formula] values of a∈A. Take such an a, and consider [formula]. Then the doubling σ[A'] is [formula], and hence the additive energy ω+(A',A') is ≈  1. It follows that [formula], this bound being uniform in a. This is contrary to the additive-multiplicative Balog-Szemerédi-Gowers theorem, applied with B equal to the set of these ratios a / a0.

As we remarked earlier the requirement that [formula] is not necessary. It may be removed by combining Theorem [\ref=add-and-multiply] with the Katz-Tao lemma, one instance of which is the following statement: if |A + A|  ≈  |A  ·  A|  ≈  |A| (using rough notation at some scale K) then there is a set A'  ⊆  A with |A'|  ≈  |A| and for which [formula]. We omit the proof, which involves a good deal of Ruzsa calculus as well as an application of the Balog-Szemerédi-Gowers theorem.

Additive structure of the large spectrum

We turn now to the proof of Theorem [\ref=bgk-theorem], the Bourgain-Glibichuk-Konyagin estimate for exponential sums or "Gauss sums" over multiplicative subgroups.

Suppose that [formula] is a set and that α, 0  <  α  <  1, is a parameter. Then we define

[formula]

This is manifestly a symmetric set containing zero. If A  =  H is a multiplicative subgroup of [formula] then it is very easy to see that [formula] is multiplicatively H-invariant: this follows from the fact that 1H(hx)  =  1H(x) for all h∈H and all [formula].

If the theorem is not true then [formula] contains a nonzero element for some η  =  p-  δ'. The strategy is then to consider various [formula], each of which will certainly be nonempty and H-invariant. The key additional observation is that [formula] has a certain amount of weak additive structure, too. We establish this fact, which does not depend on any multiplicative properties of H, in the following lemma.

Suppose that [formula] is any set and that α, 0  <  α  <  1, is a parameter. Suppose that B is a subset of [formula]. Then for a proportion at least [formula] of the pairs x,y∈B we have [formula].

Proof. Write [formula]. Then for each [formula] there is a unit modulus complex number ci such that

[formula]

Summing, we have

[formula]

By the Cauchy-Schwarz inequality this implies that

[formula]

By the triangle inequality we thus have

[formula]

Suppose that the conclusion of the lemma were false. Then, using the trivial bound [formula], the contribution to the left hand side from those pairs (i,j) for which [formula] would be less than α2k2|H| / 2. Furthermore the contribution from each pair (i,j) for which [formula] is, by definition, no more than α2|H| / 2, and so these terms contribute at most α2k2|H| / 2 in total. This contradiction establishes the lemma.

We will only use this lemma in the case when B is the whole of [formula], but for other applications it is as well to be aware of the "hereditary" version just stated. We will in fact only make use of the following corollary, specific to the case where H is a multiplicative subgroup of [formula].

Let α, 0  <  α  <  1 be a parameter, let [formula] be a multiplicative subgroup and set [formula], [formula]. Write L: = |A'| / |A|. Then for each h∈H the additive energy ω+(A,h  ·  A) is at least α4 / L.

Proof. For each [formula] write r(x) for the number of pairs a,a'∈A with a  -  a'  =  x. By Lemma [\ref=add-spec] we know that [formula]. It follows from the Cauchy-Schwarz inequality that

[formula]

The left-hand side is the number of solutions to a1  +  a2  =  a3  +  a4. However A is H-invariant, and so this is equal to the number of solutions to a1  +  ha2  =  a3  +  ha4.

The bound obtained here is of course strongest when [formula] is not a great deal larger than [formula]. The heart of the proof of Theorem [\ref=bgk-theorem], which we now present, consists of a pigeonholing argument which enables us to locate a scale α for which this happens.

Before doing that let us record the result of combining the last corollary with the additive-multiplicative Balog-Szemerédi-Gowers theorem.

Suppose that H is a multiplicative subgroup of [formula], α is a parameter with 0  <  α  <  1, [formula], [formula] and L  =  |A'| / |A|. Using approximate notation at scale L / α, there is a set X  ⊆  A, |X|  ≈  |A|, and a set H'  ⊆  H, |H'|  ≈  |H|, such that |X  +  h  ·  X|  ≈  |X| for all h∈H'.

Suppose then that [formula] is a subgroup of size at least pδ and that

[formula]

for some ξ  ≠  0, or in other words that [formula]. Our aim is to obtain an upper bound of the form η  ≪  p-  δ' for some positive δ' (depending on δ). Suppose for a contradiction that there is no such bound, thus η  =  p- o(1).

Let J be an integer to be specified later, set α0: = η and define αi + 1: = α2i / 2 for [formula]. We have the nesting

[formula]

and so by a trivial instance of the pigeonhole principle there is some i such that

[formula]

Set α: = αi, [formula] and [formula], and note that [formula]. Moreover it follows from Parseval's identity that [formula], which is less than p1  -  δ / 2 for large p. Since A is nonempty and H-invariant, we also have [formula].

Applying Proposition [\ref=add-spec-4], we obtain a set X  ⊆  A with [formula] and a set H'  ⊆  H with [formula] such that [formula] for all h∈H'. Using the bounds noted above, these inequalities may be written [formula], [formula] and [formula]. In particular if J is chosen large enough in terms of δ then we have [formula], [formula] and [formula], where f(δ) is any quantity depending on δ that might later prove convenient for us. By choosing f(δ) appropriately, we obtain a contradiction to Corollary [\ref=corollary6.2], thereby completing the proof of Theorem [\ref=bgk-theorem].

Acknowledgements

It is a pleasure to thank Jean Bourgain and Elon Lindenstrauss for helpful communications.