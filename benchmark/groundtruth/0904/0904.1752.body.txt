On polynomial growth functions of D0L-systems

Introduction

As usual, [formula] and [formula] denote the semiring of natural integers and the field of real numbers, respectively. For every a, [formula], [formula] denotes the set of all integers n such that a  ≤  n  ≤  b. The letter [formula] denotes the formal variable for the polynomials.

A word is a finite string of symbols. Word concatenation is denoted multiplicatively. For every word w, the length of w is denoted [formula]. The word of length zero, denoted ε, is called the empty word.

An alphabet is a finite set of symbols. Let A be an alphabet. The set of all words over A is denoted [formula]. A mapping [formula] is called a morphism if σ(xy)  =  σ(x)σ(y) for every x, [formula]. Clearly, σ is completely determined by its restriction to A. For every [formula], σn denotes the [formula] iterate of σ: for every [formula], σ0(w)  =  w, σ1(w)  =  σ(w), σ2(w)  =  σ(σ(w)), σ3(w)  =  σ(σ(σ(w))), etc.

A D0L-system is defined as a triple (A,σ,w) where A is an alphabet, σ a morphism from [formula] to itself, and w a word over A. The growth function of the D0L-system (A,σ,w) is defined as the function mapping each [formula] to the length of σn(w). By extension, we say that a (formal) real polynomial [formula] is the growth function of (A,σ,w) if [formula] for every [formula]. We say that a function [formula] (resp. a real polynomial [formula]) is a D0L-growth function if f (resp. [formula]) is the growth function of some D0L-system.

Define F as the set of all polynomials [formula] such that F(n) is a positive integer for every [formula].

Every polynomial with non-negative integer coefficients and non-zero constant term belongs to F: for instance, [formula] for every [formula]. Furthermore, some polynomials that admit negative and/or non-integer coefficients also belong to F: for each integer d  ≥  1, [formula] and [formula].

Prove that every polynomial in F has rational coefficients (hint: use Lagrange polynomials).

The aim of the paper is to prove:

Every polynomial in F is a D0L-growth function.

Clearly, every D0L-growth function is non-negative valued. Moreover, if a D0L-growth function vanishes then it is eventually zero because every morphism maps the empty word to itself. Therefore, if a non-zero polynomial is a D0L-growth function then it belongs to F: Theorem [\ref=th:D0L-polynomial] is optimal.

Proof of Theorem [\ref=th:D0L-polynomial]

The aim of this section is to prove that every polynomial in F is a D0L-growth function.

We say that a real polynomial [formula] is eventually positive if it satisfies the following four equivalent conditions.

The set [formula] is bounded from above.

The set [formula] is not bounded from above.

[formula] is non-zero and its leading coefficient is positive.

Either [formula] is a positive constant or [formula].

Check that conditions 1, 2, 3 and 4 of Definition [\ref=def:ev-pos] are equivalent.

Condition 1 is the natural definition of the notion: given an upper-bound t0 of [formula], F(t) is positive for every real number t  >  t0. Condition 2 ensures that every polynomial in F is eventually positive: for every [formula], [formula] is a subset of [formula]. Condition 3 is used in the proof of Lemma [\ref=lem:Fx-1-Fx] below. Condition 4 is given for the sake of completeness.

For each polynomial [formula], define [formula]. For each function [formula], define [formula] by: [formula] for each [formula].

Using a telescoping sum we obtain that

[formula]

for any function [formula] and any [formula].

Let [formula] be a non-constant real polynomial.

The degree of [formula] is one less than the degree of [formula].

[formula] is eventually positive if, and only if, [formula] is eventually positive.

Let d denote the degree of [formula] and let f0, f1, f2, , [formula] be such that:

[formula]

Clearly, [formula] can be written in the form

[formula]

Now, remark that for each integer k  ≥  1, the polynomial [formula] is of degree k  -  1. Hence, [formula] is of degree d  -  1. Furthermore, the leading coefficient of [formula] equals d, and thus the leading coefficient of [formula] equals dfd: d times the leading coefficient of [formula].

A polynomial [formula] is called integer-valued if F(n) is a rational integer for every rational integer n. Let [formula] be a non-zero real polynomial and let d denote the degree of [formula]. Prove that [formula] is integer-valued if, and only if, F(n) is a rational integer for every [formula].

It follows from Exercise [\ref=exo:integer-valued] that every polynomial in F is integer-valued.

Let f, [formula] be such that g(n)  =  f(n  +  1) for every [formula] and f(0) is a positive integer. Then, g is a D0L-growth function if, and only if, f is a D0L-growth function.

If f is the growth function of some D0L-system (A,σ,x) then g is the growth function of the D0L-system (A,σ,σ(x)).

Conversely, assume that g is the growth function of some D0L-system (B,τ,y). Let a and c be two letters such that a  ≠  c, a∉B and c∉B. Let [formula], let [formula] and let [formula] be the morphism defined by: [formula], [formula] for every b∈B and [formula]. It is easy to see that f is the growth function of the D0L-system (A,σ,x): σn(x)  =  σn  -  1(y)  =  τn  -  1(y) for every integer n  ≥  1.

Let [formula] be such that f(0) is a positive integer. If ∂f is a D0L-growth function then f is also a D0L-growth function.

Assume that ∂f is the growth function of some D0L-system (B,τ,y). Let a and c be two letters such that a  ≠  c, a∉B and c∉B. Let [formula], let [formula] and let [formula] be the morphism defined by: [formula], [formula] for every b∈B and [formula]. It is easy to see that [formula] and that

[formula]

for every [formula]. Now remark that the right-hand side of Equation [\eqref=eq:f-n-g] is exactly the length of the word on the right-hand side of Equation [\eqref=eq:sigma-n-a]: f is the growth function of the D0L-system (A,σ,x).

We can now prove the main result of the paper.

We proceed by induction on the degree of [formula].

If [formula] has degree zero then [formula] is identically equal to F(0), and thus [formula] is the growth function of the D0L-system (A,σ,x) where [formula], σ is the identity function on [formula] and [formula].

Let us now assume that the degree of [formula], denoted d, is positive. Clearly, ∂F(n) is an integer for every [formula]. Moreover, Lemma [\ref=lem:Fx-1-Fx] ensures that [formula] is of degree d  -  1 and eventually positive. Therefore, there exists [formula] such that [formula], and it follows from the induction hypothesis that [formula] is a D0L-growth function. Then, Lemma [\ref=lem:partialf] ensures that [formula] is also a D0L-growth function. Let us now repeatedly apply Lemma [\ref=lem:shift-D0L]: [formula] is a D0L-growth function for k  =  n0  -  1, n0  -  2, n0  -  3, , 1, 0. In particular, [formula] is a D0L-growth function.

Effectivity and examples

Let [formula]. Summarizing the previous section, we present a simple algorithm that computes a D0L-system with growth function [formula].

The degree of [formula] is denoted d. For each [formula], ∂i is understood as the [formula] iterate of the operator ∂: for every polynomial [formula], [formula], [formula], [formula], etc.

Prove that

[formula]

for every i, [formula] and every function [formula].

It is easy to see that ∂iF(n) is a rational integer for every i, [formula].

Let [formula] and let d denote the degree of [formula]. Prove that if ∂iF(0) is positive for each [formula] then [formula] belongs to F for each [formula].

Exercise [\ref=exo:partial-zero] motivates the introduction of the following restricted case of the problem.

Restricted case

For each [formula], let [formula]. We first focus on the case where fi is a positive integer for every [formula]. It follows from Lemma [\ref=lem:Fx-1-Fx] that the polynomial [formula] has degree d  -  i for each [formula]. In particular, [formula] is identically equal to the positive integer fd, and thus [formula] is a D0L-growth function. Then, applying d times Lemma [\ref=lem:partialf], we get that the polynomials [formula], , [formula], [formula], [formula] and [formula] are D0L-growth functions. Hence, to obtain a D0L-system with growth function [formula], it suffices to nest d copies of the gadget described in the proof of Lemma [\ref=lem:partialf]. Let a0, a1, a2, , ad be d  +  1 pairwise distinct letters and let [formula]. For each [formula], define [formula]. Let [formula] be the morphism defined by: [formula] and [formula] for each [formula]. The polynomial [formula] is the growth function of the D0L-system (A,σ,xd). More generally, the length of σn(xd  -  i) equals ∂iF(n) for every [formula] and every [formula].

For instance, consider [formula]:

d  =  3, [formula],

[formula], [formula], [formula],

[formula], [formula], [formula], [formula],

[formula], [formula], [formula], [formula],

[formula], [formula], [formula], [formula].

General case

Let us reduce the general case to the restricted case. It follows from Lemma [\ref=lem:Fx-1-Fx] that the polynomial [formula] is eventually positive for every [formula]. Hence, there exists [formula] such that ∂iF(k) is positive for every [formula]. Note that k is computable by exhaustive search.

Find an algorithm that, for any rational polynomial [formula] taken as input, decides whether [formula] belongs to F (hint: use Exercises [\ref=exo:integer-valued] and [\ref=exo:partial-zero]).

The method for the restricted case applies to [formula]: we can compute a D0L-system (B,τ,y) such that [formula] for every [formula]. To obtain a D0L-system with growth function [formula], it suffices to nest k copies of the gadget described in the proof of Lemma [\ref=lem:shift-D0L]. Let e, b1, b2, b3, , bk be k  +  1 pairwise distinct letters, let [formula], and let [formula] be the morphism defined by: [formula], [formula] for each [formula], [formula], and [formula] for every b∈B. The polynomial [formula] is the growth function of the D0L-system [formula].

For instance, consider [formula]: ∂F(0)  =    -  3. The polynomial [formula] is such that ∂iG(0)  >  0 for each i∈{0,1,2}: [formula], [formula] and [formula]. Let [formula] and let [formula] be the morphism defined by:

[formula], [formula], [formula],

[formula], [formula], [formula].

It is easy to see that [formula], [formula], [formula] [formula], and [formula] for every [formula]. The polynomial [formula] is the growth function of the D0L-system [formula].