Sequences related to convergents to square root of rationals

The Initial Results

This note has its source in [\cite=murthy], in a different setting. Consider the system of recurrences, with a0 = b0 = 1,

[formula]

[formula]

Later on we will generalize and show that the ratio [formula] is related to convergents to the square root of rationals.

We postpone the proof by induction of the following formulas ("summation formulas")

[formula]

[formula]

[formula]

[formula]

Let [formula]. Note that [formula]. Using Identities 1.87 and 1.95 in [\cite=gould] and Pascal's Identity (see [\cite=koshy]) we have the following closed form representations

[formula]

[formula]

[formula]

[formula]

Let w(r,  s) denote the recurrence

[formula]

Furthermore let dn = w(1,  k + 1),  un = w(0,  2k),  vn = w(0,  2). The closed forms are

[formula]

[formula]

[formula]

Note that

[formula]

Then

[formula]

[formula]

[formula]

[formula]

It follows that a2n = w(1,  3k + 1),  a2n + 1 = w(k + 1,  k2 + 6k + 1),  b2n = w(1,  k + 3),  b2n + 1 = w(2,  4k + 4). Finally

[formula]

[formula]

[formula]

[formula]

These fourth order recurrences can be transformed in second order recurrences in the following way. First of all note that

[formula]

The generating function of an is

[formula]

This can be simplified to

[formula]

so that we obtain

[formula]

Analogously, the generating function of bn is

[formula]

and this becomes

[formula]

so that we obtain

[formula]

Writing [formula] (so that [formula]) the closed forms are

[formula]

[formula]

Now it is easy to show that [formula]. Indeed

[formula]

Since [formula] converges to zero we have that [formula] converges to [formula].

Now we are ready to prove by induction the summation formulas. Assume that Equation [\ref=eq:uno1], Equation [\ref=eq:due2], Equation [\ref=eq:tre3] and Equation [\ref=eq:quattro4] hold for some integer n. This is tantamount to say that Equation [\ref=eq:unotris], Equation [\ref=eq:duetris], Equation [\ref=eq:tretris] and Equation [\ref=eq:quattrotris] hold for some integer n. For n = 0 they are satisfied since

[formula]

[formula]

[formula]

[formula]

Now

[formula]

where the third line is due to the induction hypothesis and we used Equation [\ref=eq:fondamentale]. Then Equation [\ref=eq:uno1] is satisfied through Equation [\ref=eq:unotris].

[formula]

Again the third line is due to the induction hypothesis. Then Equation [\ref=eq:tre3] is satisfied through Equation [\ref=eq:tretris].

[formula]

Here the third line is due to the fact that we already proved the formulas for a2n and b2n. Then Equation [\ref=eq:due2] is satisfied through Equation [\ref=eq:duetris]. For the last relationship consider first of all that

[formula]

Then

[formula]

Here again the third line is due to the formulas already proven. Then Equation [\ref=eq:quattro4] is satisfied through Equation [\ref=eq:quattrotris].

Other Initial Conditions

If we start out with a0 = 0,  b0 = 1 and we denote the resulting sequences by ãn and n we get

[formula]

[formula]

[formula]

[formula]

Then

[formula]

[formula]

It follows easily (n > 0)

[formula]

[formula]

so that [formula].

Generalization

The work done allows to analyze easily the following situation. Let us consider the sequences

[formula]

[formula]

with k and h positive integers, where we start with u0 = 1,  v0 = 0. Then we get the following summation formulas and closed forms (where [formula])

[formula]

[formula]

[formula]

[formula]

From this, using the same approach as before, we obtain

[formula]

[formula]

Using the closed forms given before we see that

[formula]

so that we can conclude

[formula]

Reduction

Returning to the initial case, if k is an odd number the fraction [formula] can be reduced and new sequences can be defined. More precisely, let [formula]. Then

[formula]

with [formula]. Analogously, with [formula], we have

[formula]

Note that [formula]. Now define

[formula]

[formula]

[formula]

[formula]

Then of course

[formula]

Let u(r,  s) denote the recurrence

[formula]

Then c2n = u(1,  3m + 2),  c2n + 1 = u(m + 1,  m2 + 4m + 2),  d2n = u(1,  m + 2),  d2n + 1 = u(1,  2(m + 1)). And finally

[formula]

[formula]

where the initial conditions are determined by the previous recurrences.

The generating function of cn is

[formula]

that of dn is

[formula]

Some Identities

We will work with the sequences

[formula]

and

[formula]

with closed forms

[formula]

[formula]

where [formula]. Using induction and Equations [\ref=eq:prima] and [\ref=eq:seconda] we get

[formula]

[formula]

[formula]

Using the closed forms (and the fact that εη = 1 - k) we get

[formula]

[formula]

[formula]

[formula]

Writing n = m - 1 the last two become

[formula]

[formula]

Using these identities we obtain

[formula]

[formula]

Now noting that a2n + 1 = a2  ·  2n, writing 2n instead of n we get recurrences for a2n and b2n

[formula]

[formula]

Newton's Iteration

The Newton's iteration algorithm (see [\cite=wolfram4]) to approximate the square root of integers is given by

[formula]

starting with x0 = 1. We assume k > 1. The limit of this recursion is the fixed point of the mapping

[formula]

which is [formula].

For n  ≥  0 let us write

[formula]

We extend the sequences an and bn setting a0 = b0 = 1. Then we have

[formula]

[formula]

We can generalize considering the recursion

[formula]

where h,  k are positive integers with [formula]. This produces an approximation to [formula]. In this case we have

[formula]

[formula]

We are going to prove using induction that, for n  ≥  2,

[formula]

Using Equation [\ref=eq:uno] and Equation [\ref=eq:due] we have a1 = k + 1,  b1 = 2,  a2 = (k + 1)2 + 4k = 1 + k2 + 6k. If we use Equation [\ref=eq:tre] we have a2 = 2a21 - (k - 1)2 = 1 + k2 + 6k, so that Equation [\ref=eq:tre] is true for n = 2. Now assume that it holds for some n. Coupled with Equation [\ref=eq:uno] we get

[formula]

that is

[formula]

where we wrote

[formula]

Now

[formula]

On the other hand

[formula]

Now using Equation [\ref=eq:quattro] we have

[formula]

Then

[formula]

since wn = w2n - 1. This concludes the proof.

Using Equation [\ref=eq:quattro] we get

[formula]

so that, through Equation [\ref=eq:due], we get a recurrence for bn

[formula]

Now we are going to prove, again by induction, the following closed forms

[formula]

[formula]

where [formula]. Note that α  +  β = 2,  αβ = 1 - k. Hence an and bn are doubly exponential sequences (see [\cite=sloane3]).

For n = 0 the closed form for a0 gives [formula]; for b0 gives [formula] so Equation [\ref=eq:cinque] and Equation [\ref=eq:sei] are satisfied. Now assume that Equation [\ref=eq:cinque] and Equation [\ref=eq:sei] hold for some n. Then

[formula]

This concludes the proof for an.

For bn we have

[formula]

This concludes the proof.

Incidentally we have proved, for n  ≥  1, that kb2n + wn is a perfect square. With k = 2, an is sequence A001601 and bn is sequence A051009 in [\cite=sloane].

Using Identities 1.87 and 1.95 in [\cite=gould], where n is replaced by 2n, we obtain the following summation formulas

[formula]

[formula]

From Equation [\ref=eq:due] we see that

[formula]

which implies that bn is divisible by 2n.

Related Sequences

Let us consider the sequence cn, with c0 = 1,  c1 = r, r > 1, such that for n  ≥  2

[formula]

From [\cite=shallit] we get the closed form

[formula]

where [formula]. Define the sequence dn by

[formula]

We set d0 = 1 and we obtain d1 = 1. Note that d2 = 2r. Then, for n  ≥  1,

[formula]

Then

[formula]

From this we can evaluate

[formula]

Indeed we have

[formula]

Using the closed forms of cn and dn it is easy to see that

[formula]

Hence

[formula]

The case r = 3 is considered in [\cite=wilf2].