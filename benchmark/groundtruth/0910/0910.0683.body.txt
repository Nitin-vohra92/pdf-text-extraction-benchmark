Lemma Corollary Fact

Grouplike minimal sets in ACFA and in TA.

Introduction

Background and History and Motivation.

This paper is a generalization of a part of the author's PhD thesis [\cite=mythesis]. A non-logician might find the exposition in the thesis more transparent, while the results in this paper are more general. In the thesis, we sought difference field analogs of the results that Hrushovski and Itai prove for differential fields in [\cite=hruit]. They show that for some classes C of strongly minimal sets definable in a differentially closed field, non-orthogonality to some type in C is a definable property on families of definable sets. This allows them to produce a new model complete theory of differential fields (one for each such class C) realizing all types in differentially closed fields except for those non-orthogonal to something in C. The situation in difference fields is much more complicated, and we only make a first step toward this goal. However, our explicit description of the structure of certain definable sets in ACFA has proved tremendously useful for algebraic dynamics [\cite=polydyn]. With those later results [\cite=polydyn] we show that non-orthogonality between two minimal sets of the form σ(x)  =  f(x) for a polynomial f in characteristic zero is often definable. We should say a little about difference fields before we give more details.

A difference field is a field K with a distinguished endomorphism σ; it is naturally a structure for the language of rings augmented by a unary function symbol σ denoting the endomorphism. This is a natural setting for studying functional equations, and it also turns out to be a useful formalism for studying algebraic dynamical systems, and for certain questions in arithmetic geometry.

Functional equations like f(x + 1)  =  xf(x) that have been studied by analysts for several centuries fit into this formalism by taking K to be, for example, the field of meromorphic functions on [formula], and σ(f(x))  =  f(x + 1). The name difference field comes from considering an automorphism σ(f(x))  =  f(x + δ) for a fixed δ on some field of functions, and working with equations in finite difference quotients [formula] as an approximation to differential equations. Difference algebra, the study of difference polynomial rings and their ideals, was first developed by Ritt and Cohn and can be found in Cohn's book [\cite=cohn]. There are several obstructions to developing difference-algebraic geometry as an analog to algebraic geometry. Cohn's book defines the correct analog of radical ideals, and proves that they satisfy the ascending chain condition. However, in contrast with plain algebraic geometry, it may be impossible to amalgamate two difference field extensions, which seems to preclude Weil-style universal domains. It is also unclear, from the algebraic point of view, how to define the dimension of a difference-closed set: for example, the natural Krull dimension fails to satisfy the fiber dimension theorem. Model theory offers solutions for both of these.

Several people, including Macintyre and van den Dries, noticed in mid-90s that the class of difference fields has a model companion, called ACFA. Its models serve as universal domains for difference algebra; for that reason, they are sometimes called difference-closed fields. ACFA has been studied extensively by Chatzidakis, Hrushovski, and others, especially in [\cite=ChaHru1] and [\cite=ChaHruPet]. In particular, Chatzidakis and Hrushovski show in [\cite=ChaHru1] that ACFA is a supersimple theory, so the Lascar rank provides a good notion of dimension. In [\cite=ChaHruPet], it is shown that the minimal (Lascar rank 1) types in ACFA satisfy a version of the Zilber trichotomy: each is exactly one of fieldlike (nonorthogonal to a fixed field of a definable field automorphism), grouplike (nonorthogonal to a generic type of a minimal modular definable group), or trivial. They also show that the only definable field automorphisms are powers of σ, powers of the Frobenius automorphism, and compositions of these.

Here is how model theory of difference fields, and specifically ACFA, is relevant to arithmetic. While each Frobenius endomorphism Φn(x)  =  x(pn) on a field of positive characteristic p is already defined in the language of rings, one needs the language of difference fields (and the formalism of first-order logic) to speak of the "limit theory" of these structures, that is of the theory of a nonprincipal ultraproduct of them. Hrushovski shows in [\cite=udifrob] that this limit theory is precisely ACFA. Hrushovski uses ACFA to give a new proof of the Manin-Mumford conjecture in [\cite=udimm], giving more explicit bounds for the number of torsion points of the Jacobian of an algebraic curve which lie on the curve. Indeed, the difference equations of the form σ(x)  =  f(x) for a rational function f, the focus of the author's thesis [\cite=mythesis], figure prominently in his work.

The author's thesis [\cite=mythesis] concerns minimal formulae in models of ACFA of the form [formula] for an algebraic curve A and a dominant rational function f:A  →  σ(A). We prove that these formulae are uniform in the Zilber trichotomy, that is, that all non-algebraic types containing a given formula fall into the same case of the trichotomy; and we characterize the pairs (A,f) that fall into each of the three cases. The fieldlike case is already characterized in [\cite=ChaHru1] as purely inseparable (including linear) f; we show that (A,f) gives a grouplike formula if and only if f is not purely inseparable and either (1) A is (birationally isomorphic to) an algebraic group curve (additive, multiplicative, or elliptic) and f is (skew-conjugate to) a group homomorphism; or (2) A is (birationally isomorphic to) [formula] and f is (skew-conjugate to) a generalized Lattès function. Here, f is skew-conjugate to g if there is a birational isomorphism L such that [formula]. A generalized Lattès function is a quotient of an isogeny of algebraic groups by a finite group of automorphisms of the algebraic group (see [\cite=aboutlattes] for a beautiful exposition on Lattès functions in characteristic 0 and [\cite=silverdyn] for more arithmetic dynamics). Precise definitions and details are given in the last section of this paper.

This paper covers approximately half of the thesis, namely those parts of it which can be made purely model-theoretic by moving from ACFA, the model companion of the class of algebraically closed fields with an endomorphism, to TA, the model companion of the class of models of an arbitrary totally-transcendental theory T with an injective endomorphism, if this model-companion exists. See section[\ref=meetta] below for details. With very recent work [\cite=amador] by Blossier, Martin-Pizarro, and Wagner, we also obtain a characterization of definable groups in this generality. Although there is no hope for the Zilber Trichotomy in this generality, it is useful to generalize the results from ACFA to TA for three reasons. We are pleased to give a more model-theoretic account. We hope that this could be useful in other theories, most notably DCFA. Back in ACFA, this exposition clarifies which parts of the proof rely on A being a curve (rather than a higher-dimensional variety), and which rely on f being a single-valued function rather than a finite-valued correspondence; we hope this will help us eliminate these hypotheses.

The author is most grateful to her thesis advisor, Thomas Scanlon; to Bjorn Poonen, who read the thesis and suggested several corrections and simplifications; and to Moshe Kamensky, whose interest in this generalization to TA inspired this paper, several drafts of which he read carefully. We thank the referee for the close reading and the detailed comments.

Please meet TA.

We take a stable theory T which eliminates quantifiers and imaginaries in a language L. We denote L-definable sets by A, B, etc. Sets denoted by non-italics might not be definable at all; occasionally they are definable in an expanded language Lσ, or type-definable in one of the languages.

Tσ asserts that σ is an injective L-endomorphism. This theory is called TAut in [\cite=bash], where Baldwin and Shelah give a necessary and sufficient condition for the existence of TA, a strengthening of "T does not have the finite cover property" that they call " T does not admit obstructions". Chatzidakis and Pillay first examined the theory Tσ in [\cite=chapi] and gave sufficient conditions (3.11.2, p. 85) for the existence of its model-companion TA when T is a theory of finite Morley rank. They prove the following:

([\cite=chapi]) If T is stable and has quantifier elimination, and TA exists, then

TA is simple, and supersimple if T is superstable. (Corollary 3.8, p. 84)

In a model of TA, [formula]. (Lemma 3.6, p. 82)

TA eliminates quantifiers down to formulas of the form [formula] where

z is a single variable,

θ is quantifier-free, and

[formula] for some [formula]

(follows from Proposition 3.5(2) by the usual methods.)

Forking independence in TA is given by the following: A and B are independent over E if and only if [formula] is independent in the sense of T from [formula] over [formula]. (Terminology and Theorem 3.7)

It follows that forking in TA is always witnessed by quantifier-free formulae. The theory of algebraically closed fields satisfies the sufficient conditions for the existence of TA given in [\cite=chapi] (3.11.2, p. 85), so the above fact applies to it. The model-companion ACFA of ACFσ is examined in great detail in [\cite=ChaHru1] [\cite=ChaHruPet].

It also follows from the characterization of [formula] and the characterization of independence that in the terminology of [\cite=amador] "TA is one-based over T with respect to [formula]", so their Theorem 2.15 applies, pinning down Lσ-definable groups in terms of L-definable ones. Although both theories are assumed stable in the statement of the theorem, the authors state on p.3 that it is sufficient for the larger theory to be simple and the smaller to be stable, as is the case in this paper.

( Theorem 2.15 in [\cite=amador]) In a model of TA, for any Lσ-definable group H there are a finite-index subgroup H' of H, an L-definable group A, and an Lσ-definable group homomorphism φ:H'  →  A with finite kernel.

A better understanding of the proof of this fact may allow us to remove "totally transcendental" from the following assumption, but at present we do not see how to do that.

We assume throughout this paper that T is a totally transcendental theory with quantifier elimination and elimination of imaginaries, and that TA exists.

While the Lascar rank is normally defined for complete types, it is common to abuse notation and write U(π) to mean [formula] when π is a partial type over A.

Outline of this paper

Sections [\ref=moshethmsection], [\ref=groupsection], and [\ref=chase] are the heart of the paper. Here, unlike in the author's thesis, there is no algebraic geometry, and no appeal to any special properties of ACFA as opposed to TA.

The language used in this paper is the language of algebraic geometry tweaked and twisted to work in an arbitrary theory, for definable sets that have a Morley rank and functions between them. Thus irreducible will mean Morley degree 1, a notion that is insensitive to subsets of lower Morley rank. As there is no way to tell one definable bijection (e.g. linear) from another (e.g. Frobenius), we cannot avoid pth roots, and our degree of a function is merely the number of points in a generic fiber, that is the separable degree. The beginning of section [\ref=moshethmsection] is devoted to developing this language. Most of section [\ref=forwref] is a translation from that language back to the usual algebraic geometry.

Sections [\ref=moshethmsection] and [\ref=groupsection] are of general interest in that they describe the structure of models of TA. Section [\ref=moshethmsection] develops the basic tools of ACFA for TA and culminates with Theorem [\ref=moshethm] characterizing Lσ-interalgebraicity in terms of L-definable sets and functions. Section [\ref=groupsection] is a sequence of exercises is ω-stable groups and simple groups that yields Theorem [\ref=classifygp] that characterizes groups definable in models of TA.

Here is an outline of how we obtain our characterization of grouplike minimal types. Section [\ref=moshethmsection] turns non-orthogonality between Lσ-types into a commutative diagram of L-definable sets and functions. Section [\ref=groupsection] uses the main result of section [\ref=moshethmsection] to obtain a commutative diagram with a group correspondence in it. Section [\ref=chase] improves the diagram obtained in section [\ref=groupsection] to the point where, in the special case of ACFA, it can be attacked with algebraic geometry. Then section [\ref=forwref] describes this algebra-geometric attack, postponing the proofs of the crucial algebra-geometric results to a later paper [\cite=secondpaper].

We use fairly naive and certainly well-known techniques, or close variants thereof: many, if not most, of our lemmas are there only to introduce the notation and tell the story. Nevertheless, some of the results (Theorem [\ref=moshethm], Lemma [\ref=groupwrap], Theorem [\ref=classifygp], and the final Theorem [\ref=endthm]) are not entirely obvious and somewhat cute. The last theorem in particular proved crucial in [\cite=polydyn] for classifying invariant subvarieties for certain algebraic dynamical systems.

Many definitions and a technical theorem.

Most of this section is definitions and basic facts that are well known for ACFA. Here, we generalize them for TA (when it exists) for an arbitrary totally transcendental theory T with quantifier elimination and elimination of imaginaries. We suspect that it should be possible to replace "totally transcendental" by "stable". We end this section with a technical, not terribly surprising, but quite useful Theorem [\ref=geninteralg].

Finite dominant rational functions in T.

The results from this section will be used for L-definable sets; in particular, "irreducible" and "rational" imply L-definable.

Before doing anything else, we explain our notation for germs of definable functions between types. If a formula defines a function on the set of realizations of a type p, then by compactness it also defines a function on some definable set D  ⊃  p. By shrinking D, we may assume that it has the same Morley rank as p, and Morley degree 1. Then for any other definable B  ⊃  p with [formula] and [formula] we have [formula]. Instead of fixing a type p and considering definable functions on its realization, we prefer to fix such a B and consider definable functions whose domains are "Zariski-dense " in B. This is a purely cosmetic and ideological difference. Our definitions are inspired by, and lifted from, algebraic geometry, but they are subtly different. We fix a language L and an L-theory T.

When we abuse notation and say "S  ⊂  A is Zariski-dense in A over B" even though A is not irreducible, we mean that S is Zariski-dense in any irreducible subset of A of full Morley rank. We now list a few trivial observations about these notions, in no particular order. If S is Zariski-dense in A over B, then it is also Zariski-dense in A over any B'  ⊂  B.

If S is Zariski-dense in A and T is Zariski-dense in C, then S  ×  T is Zariski-dense in A  ×  C.

Towards contradiction, suppose that S  ⊂  C for some C defined by φ(x,c) for some L-formula φ(x,y) and some c∈N, with [formula]. Let q(y) be the type of c over E and q1 be the type of c over the empty set. Now [formula] implies φ(x,y), so by compactness [formula] implies φ(x,y) for some finite q0  ⊂  q. By saturation, there is some c'∈E realizing [formula], and now C' defined by φ(x,c') contradicts the assumption that S(E) is Zariski-dense in A over E.

Because of this lemma we often abuse notation by saying "Zariski-dense " without specifying the parameter set.

If irreducible A and B have the same Morley rank, then a rational function from B to A is finite if and only if it is dominant. Somewhat conversely, if there is a finite dominant function between irreducible B and A, then they must have the same Morley rank.

We now prove three lemmas about compositional components of finite dominant rational functions.

Let h(x): = (f(x),g(x)).

By its universality, h is unique up to composing with bijections on the left.

Consider the binary relation R0 given by [formula] and start constructing its transitive closure: define inductively Rn + 1(a,c) to be given by [formula] and note that Rn + 1  ⊃  Rn. For any a, consider finite sets Sn(a) defined by

[formula]

On the definable subset E of the domain of H where H has uniformly finite fibers, the sizes of Sn(a) are bounded by the degree of H. So for each a there is some n such that Sn + 1(a)  =  Sn(a), and then Sm(a)  =  Sn(a) for all m  >  n. By compactness, some N works for all a, and then RN is an equivalence relation. Applying elimination of imaginaries to it yields the desired function h with domain E.

Although the least common extension of f and g produced in the lemma does not depend on the common extension H we start with, the existence of the least common extension very much depends on the existence of some finite common extension. For example, in algebraic geometry the vast majority of finite rational morphisms f and g do not admit a common finite extension. Even when f and g do admit a common extension, its degree may be much higher than the degrees of f and g. But in one special case we can get around this.

The product [formula] of the kernels of f and g is a normal subgroup of A of size at most deg (f)  ·   deg (g). Using elimination of imaginaries again, let h be the quotient by N

We now say a few words about finite-to-finite correspondences, the central object of this paper.

We often abuse notation and say that B is a correspondence from A to C; this is harmless. Finite-to-finite correspondences preserve many properties that definable bijections preserve. For example, two sets that admit a finite-to-finite correspondence between them must have the same Morley rank. It is often convenient to trim off the low Morley rank part of the correspondence where the projections do not have finite fibers.

Prolongations, Sharps, and very dense subsets.

Now we are back to the setting with two languages [formula] and two theories T and TA.

The second prolongation is not first prolongation of the first prolongation. If S is definable by an Lσ-formula with parameters a, then Sσ is defined by the same formula with parameters σ(a), as σ is an Lσ-automorphism of a model of TA. In particular, when S is L-definable, then so is Sσ. Since projection onto the first coordinate is a definable bijection from S+ to S, all Lσ-properties invariant under definable bijection, such as ranks, pass to prolongations. The natural bijection x  ↦  (x,σ(x)) from S to S+ is also called a prolongation.

We obtain B0 from Lemma [\ref=genericB0]. For any [formula], σ(a) and σ- 1(a) are already L-algebraic over a, and the conclusion follows from Fact [\ref=basicfacts](2).

In any model [formula], the definable set [formula] is very dense in itself over the whole model E.

We translate the proof of Theorem 1.1 in [\cite=ChaHru1] into our notation and note that it has nothing to do with fields.

Suppose A, B, and Aσ are L-definable over [formula].

First note that for any definable S, the statement "S is Zariski-dense in A" is a conjunction of a set of existential first-order formulae over E: for each L-definable low-Morley-rank C, we demand that there exist something in S but not in C. (Remember that TA is model-complete, so S is defined by an existential formula; and T eliminates quantifiers, so C is defined by a quantifier-free formula.)

Since models of TA are existentially closed in the class of models of Tσ, it is sufficient to find a model N of Tσ such that E embeds into N and [formula] is very dense in [formula] over E.

We start with a sufficiently saturated model M of T such that [formula] embeds into M. We find in M an element a realizing the (unique!) generic L-type [formula] of A. We find a' such that (a,a')∈B. Since B  ⊂  A  ×  Aσ, a' belongs to the L-definable set Aσ. The generic L-type of Aσ is [formula]. Since a and a' are L-interalgebraic over E, they have the same Morley rank, so a' realizes the generic L-type of Aσ. In other words, the map τ that takes E to itself by σ, and takes a to a' is a partial-L-elementary map from M to M. By the saturation of M, we can extend τ to make it an L-automorphism of an L-substructure N of M.

Now [formula] is the model we want, and [formula] is all by itself very dense in [formula] over E.

When [formula] and S is Lσ-definable over M and [formula] is defined over M, a similar argument show that S(M) is very dense in [formula] over M if and only if S(N) is very dense in [formula] over N. If S is only type-definable, the same holds for a slightly-saturated M. Thus, we often abuse notation by saying "very dense" without specifying the parameter set.

σ-degree.

The notion of σ-degree has been used in difference algebra for many decades, and translates naturally to our setting. However, the tight connection between σ-degree and U-rank in ACFA does not generalize to TA.

It is clear that deg σ(a / A) is the property of the quantifier-free Lσ-type of a over [formula]; as usual, we can extend the definition to partial types, including definable sets, by taking the supremum over realizations in a sufficiently large model. As with Morley rank, this supremum is attained in a sufficiently saturated model. It is also clear that for any B  ⊃  A we have deg σ(a / B)  ≤   deg σ(a / A), since on the left hand side the minimum is taken over a larger family of definable sets, and N also only decreases.

This comes down to obtaining the mth prolongation of the nth prolongation from the (m + n)th prolongation by adding new variables and carefully setting them equal to appropriate old ones.

Take the (N - 1)st prolongation of S for N from the definition of σ-degree, find some (irreducible for S a complete type over a model) A in which the (N - 1)st prolongation of S is Zariski-dense , and get B from the formula witnessing that [formula].

We need to show that if deg σ(a / C) is defined, then a is independent from B over C if and only if deg σ(a / BC)  =   deg σ(a / C).

We may assume without loss of generality that [formula] and [formula] and C  ⊂  B. Since deg σ(a / C) is defined, let N be such that [formula], and note that [formula].

From Fact [\ref=basicfacts].4, a is independent from B over C in the sense of TA if and only if [formula] is independent from B over C in the sense of T, which happens if and only if [formula], which happens if and only if deg σ(a / B)  =   deg σ(a / C), and we are done.

If follows immediately that

In ACFA, there is a partial converse to this: finite U-rank implies finite σ-degree (2.5 in [\cite=ChaHru1]). However, that proof relies on ACF having finite rank and on the whole model of ACF being a group. We expect that only the second of these is necessary.

Since B is a finite-to-finite correspondence between A and Aσ, Lemma [\ref=sharpacl] applies, and any [formula] has finite σ-degree over any set containing D, witnessed by N = 1. Also, deg σ(a / C)  ≤   deg σ(a / D)  ≤  RM(A) as A is D-definable and contains a. So it suffices to show that deg σ(S / C)  ≥  RM(A). But S is Zariski-dense in A over D (and if D is an ω-saturated model, then also over any C  ⊃  D by Lemma [\ref=defzdense]), so [formula] for any C-definable A' with [formula].

Lemma [\ref=prolongvdense] makes some prolongation of an Lσ-definable set with defined σ-degree Zariski-dense in some correspondence, and Lemma [\ref=sigdegprolong] asserts that its σ-degree is unaffected by the prolongation, so the last lemma is almost a defining property of σ-degree. This is used (and explained in more detail) in Corollary [\ref=a3] below.

We will be interested in complete Lσ-types whose realizations are very dense in [formula]. If A is a curve (that is, Morley rank 1), any non-algebraic type is very dense. More generally, the realizations of a type p are very dense in [formula] whenever [formula]. The relationship between the properties "p is very dense in [formula]" and [formula] is most intriguing.

The theorem.

There are hidden assumptions in the following theorem: don't forget the bold text at the end of Definition [\ref=findom].

Suppose that A, B, C, and D are L-definable sets, that S and T are defined by complete Lσ-types, and that θ is an Lσ-formula such that

S is a very dense subset of [formula];

T is a very dense subset of [formula];

θ(x;y) witnesses that S and T are uniformly interalgebraic.

Then then there is a (quantifier-free) formula ζ(x,x';y,y')∈L such that

[formula] implies ζ(x,σ(x);y,σ(y));

ζ(x,x',y,y') implies (x,x')∈B and (y,y')∈D, and

[formula]

is a finite-to-finite correspondence between B and D.

[formula] is a finite to finite correspondence between A and C, and [formula]

We may assume without loss of generality that [formula] and [formula] already satisfy the conclusion of Lemma [\ref=genericB0].

By compactness, we can find Lσ-definable S1 and T1 such that [formula] and [formula], with S1 and T1 still uniformly interalgebraic via θ; note that S1 and T1 are still very dense in [formula] and [formula], respectively.

By Lemma [\ref=sharpacl] and Fact [\ref=basicfacts](2) there are L-formulae φ(x,x',y,y') such that

[formula] implies φ(x,σ(x),y,σ(y)), and

there is a bound [formula] such that [formula] and [formula]

We take ζ0(x,x',y,y') to be one of these φ with the least possible Morley rank.

Now [formula] is an L-definable subset of B containing the first prolongation of S1, which is Zariski-dense in B, so [formula]. Define D1 the same way, and make the same observation.

Let [formula], and let F  ⊂  B  ×  D be defined by it. Note that the image of the projection F  →  B contains S1 and therefore has full Morley rank, and similarly for the image in D.

We have now shown that F is a finite-to-finite correspondence between B and D, so (2) is proved.

As for the first conclusion, we already have that

[formula]

Since S1  ⊃  S and T1  ⊃  T, it follows that

[formula]

Since B1  ⊂  B has full Morley rank, and the first prolongation of S is a complete type Zariski-dense in B, Lemma [\ref=ineverybig] shows that x∈S implies (x,σ(x))∈B1. The identical argument for T in D finishes the proof of (1).

To see that F projects dominantly onto A and C, note that a composition of finite dominant rational functions is itself finite dominant. So E is indeed a finite to finite correspondence between A and C. Since [formula] is Zariski-dense in F, its projections (S  ×  T) and (Sσ  ×  Tσ) are Zariski-dense in the two (finite!) projections of F, finishing the proof of (3).

It is worth noting that the conclusion of this theorem cannot be sharpened to make θ and ζ equivalent on S  ×  T: for example, θ may be the graph of σ.

We suppress parameters - either we must begin with a sufficiently saturated model as our parameter set, or we must allow the possibility that the new sets need new parameters. This permits us to equate orthogonality and almost-orthogonality.

Note that this does not make [formula] definably interalgebraic with [formula]: it may easily be that [formula] is a proper subset of [formula], witnessing the lack of full quantifier elimination in TA.

For the first part, let S0 and T0 be the uniformly interalgebraic Lσ-definable sets with defined σ-degree. Use Lemma [\ref=prolongvdense] to find prolongations S of S0 very dense in [formula], and T of T0 very dense in [formula]. By Lemma [\ref=sloganlemma], [formula] and [formula]. Clearly, S and T are still uniformly interalgebraic (witnessed by the same formula). By Theorem [\ref=moshethm], there is a finite-to-finite correspondence between A and C, so [formula]. By Lemma [\ref=sigdegprolong], deg σ(S0)  =   deg σ(S) and deg σ(T0)  =   deg σ(T).

For the second part, note as in the last corollary that non-orthogonal types of U-rank 1 are uniformly interalgebraic.

One special case of uniformly interalgebraicity is an Lσ-definable bijection. Clearly, a type with defined σ-degree cannot be interalgebraic with a type with undefined σ-degree.

Groups in TA.

We begin this section with Corollary [\ref=gpdiagthm], a statement about ACFA from the author's thesis (Theorem 3 in [\cite=mythesis]) that motivated this work. We then explain the correct statement in the general setting of TA and prove it.

Motivation from ACFA

Remember, U is the Lascar rank of Lσ-definable or Lσ-type-definable sets, and we write U(π) for a partial type π over A to mean [formula].

(Zilber Trichotomy for ACFA [\cite=ChaHruPet]) In ACFA, every minimal type is exactly one of the following:

non-orthogonal to a generic type of the fixed field of a definable automorphism (and therefore not locally modular);

grouplike and non-orthogonal to a generic type of a definable minimal modular group;

trivial.

The following statement about grouplike minimal types in ACFA (Theorem 3 in [\cite=mythesis]) was the original motivation for this work.

Corollary [\ref=moshediag] provides the diagram once we find a minimal type q nonorthogonal to p and very dense in [formula].

Since we do not get full interalgebraicity in Theorem [\ref=moshethm], we do not get all types in [formula] to be grouplike; but we do get a large, quantifierfully definable subset [formula] of [formula] to be interalgebraic with a chunk of a group. We hope to prove one day that all very dense types in [formula] must be grouplike if one is, at least if the difference ideal generated by [formula] is prime. For the case when B is the graph of a function, this is accomplished in the author's thesis [\cite=mythesis] and described in this paper.

It turns out that minimality, modularity, and the whole Zilber Trichotomy are irrelevant: Corollary [\ref=gpdiagthm] is an easy consequence of Corollary [\ref=gpdiagta] below. The correct hypothesis in the general setting is not that some very dense type in [formula] is grouplike, i.e. minimal and non-orthogonal to a generic type of an Lσ-definable minimal modular group, but only that this type is interalgebraic with a generic type of an Lσ-definable group. Minimality is replaced by defined σ-degree, automatic for a type in [formula]. While the relationship between U-rank and σ-degree is still unclear in the general setting, the natural test case of DCFA confirms that defined σ-degree is the correct hypothesis: when the original theory T does not have finite rank, assuming finite U-rank is far too restrictive.

We now set out to prove Corollary [\ref=gpdiagta]. Along the way, we obtain a characterization of Lσ-definable groups with defined σ-degree (Theorem [\ref=classifygp]), an analog of the characterization of groups of finite U-rank definable in ACFA. We do not return to ACFA until the very end of this section, where we prove Corollary [\ref=gpdiagthm].

The key technical proposition.

This section is devoted to the proof of Proposition [\ref=groupkey] via some elementary facts about ω-stable and simple groups.

The next three lemmas are all about an abstract subgroup H of an irreducible L-definable group A. Later, we will assume that H is Lσ-definable, but for the next three lemmas we work in one language L, inside a totally-transcendental group.

It is a standard fact about totally transcendental groups ([\cite=bigPillay] 1.6.16 and 1.6.21) that C is a definable subgroup of A. If h∈H, then H  =  hH is Zariski-dense in hB, so hB intersects B in a subset of full Morley rank, so hr  =  r. Therefore H  ⊂  C, so [formula] has the same Morley rank as B, so r is in C. Now r is a type in a stable group C with [formula], so C is connected and r is its unique generic ([\cite=bigPillay] 1.6.6.ii and 1.6.16.iii).

The next lemma eliminates one of the hypotheses from the previous lemma (the irreducibility of B), at the cost of passing from H to a finite-index subgroup.

For any h∈H, [formula] and so has the same Morley rank and degree as B. That is, translating by h permutes the r generic types of B, giving a homomorphism from H into a finite group Sr; let H' be the kernel of that homomorphism, a finite-index subgroup of H. Let B' be a least Morley rank and degree definable set containing H'. Now a finite union of translates of B' covers H, so B' has the same Morley rank as B. So all generic types of B' are also generic in B, and therefore fixed by all elements of H'. Write [formula] for disjoint irreducible Ci of full Morley rank, and let pi be the generic type of Ci, and let C0 contain the identity of the group. Since H' is Zariski-dense in B', there are [formula] for each i. Then on one hand, hi  ·  p0  =  p0 since H' fixes all generic types of B'; but on the other hand, hi  ·  p0  =  pi since it is inside Ci. So B' is irreducible.

The purpose of all that was

The last lemma gives a finite-index subgroup H' of H which is Zariski-dense in an irreducible definable subset B' of A of Morley rank α. The lemma before that then gives the irreducible subgroup C of A with H' Zariski-dense in C.

Now we turn to the case where H is Lσ-definable and, after three more intermediate results, prove Proposition [\ref=groupkey].

Suppose, towards contradiction, that there is some L(M)-definable C with q  ⊂  C  ⊂  E and [formula]. Since q is a complete type, we may and do assume that C is irreducible. For any h∈H, the type hq contains the formula (x∈hC) and is also generic in H, so hq does not fork over M. We find one h∈H such that (x∈hC) forks over M, obtaining the desired contradiction.

The formula (x∈C) is not in the global generic L-type [formula] of E, so some E-translate of it forks over M. To find an H-translate of (x∈C) that forks over M, we construct a Morley sequence < ei  >  i∈ω (in the sense of L) in [formula], with e0∈H. It is sufficient to find some e0∈H realizing p0. Since H is Zariski-dense in E over M, the formula defining H is consistent with p0. By the saturation of the monster model, we find a realization e0. We now show that the L-formula x∈e0C forks over M.

Let [formula] be the generic L-type of C, and let B be its stabilizer in E. Since [formula] is not generic in E (lower Morley Rank), its stabilizer is a proper subgroup of E of infinite index. In particular, e- 1iej∉B, so [formula] are all distinct, so [formula]. The following exercise completes the proof.

Claim: Suppose that M is a small model, φ(x;y) is M-definable (in this lemma, φ(x;y): = x∈yC), and {ei}i∈ω is an M-indiscernible sequence such that [formula] has strictly lower Morley rank than φ(x,ei). Then φ(x,e0) forks over M.

Proof of Claim: Suppose towards contradiction that φ(x,e0) does not fork over M. Let N be a bigger model, containing A and all the ei. Let p∈S(M) be the unique type in over M containing φ(x,e0) with RM(p)  =  RM(φ(x,e0)). Let q∈S(N) be the unique nonforking extension of p, that is to say the unique type over N containing φ(x,e0) with RM(q)  =  RM(φ(x,e0)). Since q does not fork over M, it is definable over M; let θ(y)∈L(M) be its definition with respect to φ(x;y). Since φ(x,e0)∈q, it follows that theta(e0) holds. Since {ei}i∈ω is M-indiscernible and theta is over M, this implies that θ(ei) holds for all ei. That means that φ(x,ei)∈q for all i, and then [formula] is also in q. But then [formula] gives the desired contradiction.

If H is very dense in [formula], then it is Zariski-dense in E, so the statement about q is an immediate corollary of the last lemma. The rest follows because every finite-index subgroup contains a generic type.

Suppose towards contradiction that H2 has infinite index in [formula]. Let M be a small model over which everything is defined, and let p be a generic Lσ-type of [formula] over M. Let [formula], and extend [formula] to a compete type q over Me, generic in eH2. By Lemma [\ref=fininddense], q is very dense in [formula] over Me and [formula]. But σ-degree witnesses forking, and q clearly forks over M, yielding the desired contradiction.

We are finally ready to prove the key proposition.

If H is an Lσ-definable subgroup of an L-definable group A with deg σ(H) defined, then there are

a finite-index subgroup K  ≤  H,

a group correspondence [formula],

and an injective Lσ-definable group homomorphism [formula] whose image has finite index in [formula].

Let E be a small, somewhat saturater model of TA over which everything is defined. Let p∈S(E) be a model-theoretically generic type in H with deg σ(p) defined. Then the σ-degree of all generic types of H over E is defined and equal to deg σ(p), since those types are H(E)-translates of p. The statement of the theorem is invariant under prolongations, so we may assume without loss of generality (up to replacing p and H by their (N - 1)st prolongations, and A by [formula] for N from the definition of σ-degree) that [formula] for any realization a of any generic type q∈S(E) of H. This prolongation is the "injective Lσ-definable group homomorphism" from the conclusion of the theorem. We now look for E and F.

We now apply lemma [\ref=groupwrap] to H inside A to get H1  ≤  E. So H1, an Lσ-definable finite index subgroup of H, is Zariski-dense in E, an irreducible, L-definable subgroup of A.

Then we apply lemma [\ref=groupwrap] to the first prolongation H+1 of H1 inside E  ×  Eσ to get [formula]. So [formula], an Lσ-definable finite index subgroup of H+1, is Zariski-dense in F, an irreducible, L-definable subgroup of E  ×  Eσ. Let [formula], the projection of [formula] into E. Since [formula] is a subset of H+1, for every [formula] we have b  =  σ(a); in other words, [formula] is the first prolongation of K. Since [formula] is a finite-index subgroup of H+1, it follows that K is a finite-index subgroup of H1. Now H1 is Zariski-dense in E, so by Corollary [\ref=fininddense], K is Zariski-dense in E.

Let q∈S(E) be a model-theoretically generic type in K. Since both inclusions K  ≤  H1  ≤  H have finite index, q is generic in H. So [formula] for any realization [formula]. Let φ(x,y) be the L-formula that witnesses this; that is, φ(x,σ(x))∈q and [formula] for any [formula]. Now the first prolongation q+ is a generic type of K+, therefore Zariski-dense in F by Lemma [\ref=genericzdense]. Since q+ contains the formula φ(x,y), this implies that [formula]. The purpose of φ is that the projection onto the first coordinate from [formula] to E has finite fibers, and the image of this projection contains q which is Zariski-dense in E. So this projection is a finite dominant function from [formula] to E , so [formula]. Thus, [formula] and the projection from F to E is finite dominant, so we may write [formula].

We already saw that K is a finite index subgroup of H, that K+  ≤  F, and that K is Zariski-dense in E; now Lemma [\ref=verydensegeneric] finishes the proof.

Without assuming that the σ-degree of H is defined, it is easy enough to find a monogeny from H to some (E,F)sh with the projections from F to E and Eσ dominant but not necessarily finite. In ACFA, it is also possible to make the image of the isogeny have finite index in (E,F)sh by prolonging far enough. However, this relies on the Noetherianity of perfect difference ideals, and we do not expect the generalization to TA to be straightforward, even if possible.

Characterizing groups and obtaining commutative diagrams.

To remove the assumption that H is a subgroup of an L-definable group, recall Fact [\ref=amadorfact] (Theorem 2.15 in [\cite=amador]).

We use this fact to characterize Lσ-definable groups with defined σ-degree.

For any Lσ-definable group H with a generic type p with defined deg σ(p), there are

a finite-index subgroup K  ≤  H,

a group correspondence [formula],

and an Lσ-definable group homomorphism [formula] whose image has finite index in [formula] and whose kernel is finite.

Let E be a small model of TA over which everything is defined. First, we use Fact [\ref=amadorfact] to obtain H' and A. Since E is a model, p specifies a coset of H' and E(H) contains an element b of that coset. Let p': = b- 1p, an H(E)-translate of p which is inside H'. Now deg σ(p') is defined: the same as deg σ(p), since by Corollary [\ref=a3] σ-degree is invariant under Lσ-definable bijections such as x  ↦  b- 1x. Also, p' is a generic of H, and therefore also a generic of H'. Thus, Proposition [\ref=groupkey] can be applied to p', H', and A. To finish the proof, observe that a composition of two Lσ-definable group homomorphisms with finite kernels and finite-index domains, called monogenies in [\cite=amador], is another monogeny.

The next corollary connects the conclusions of the last theorem to the hypotheses of the diagram-producing Corollary [\ref=moshediag].

As in the proof of the theorem, let p1' be a translate of p1 inside K, and let q1: = φ(p1'). Since p1' is generic in K and the kernel of φ is finite, it follows that q1 is generic in φ(K). Since φ(K) has finite index in [formula], it follows that q1 is generic in [formula]. Lemma [\ref=fininddense] finishes the proof.

Any type in [formula] has defined σ-degree, so by Lemma [\ref=a3] p also has defined σ-degree. Thus we can apply the last corollary to p and H to obtain the group correspondence [formula] and a very dense type q1 in it, interalgebraic with p and, therefore, also with r. Now Corollary [\ref=moshediag] applies to r in [formula] and q1 in [formula], providing the diagram.

We return briefly to ACFA to prove Corollary [\ref=gpdiagthm]; we repeat the statement here.

The hypothesis " p is grouplike", i.e. minimal and non-orthogonal to a generic type of an Lσ-definable modular group, is clearly stronger that the hypothesis " p is interalgebraic with a generic type of an Lσ-definable group" in the last corollary.

Chasing diagrams

In this section we make heavy use of the ideas in section [\ref=funnylemmas] to chase the diagram obtained in Corollary [\ref=gpdiagthm], or, to be more precise, to count the degrees of functions in that diagram. Halfway through this section we restrict our attention to correspondences [formula] where B is the graph of a function from A to Aσ. We do not know how to remove this restriction from the algebraic geometry arguments in the second half of the author's thesis (to be exposed in another paper) toward which we are building in this paper. However, even the restricted result has been very useful in [\cite=polydyn].

It seems that there should be a slicker proof of Proposition [\ref=firstchaseprop] that does not rely on the top row being a group correspondence, but I cannot make it work. In particular, I have neither proof nor counterexample to the following refinement of a special case of Theorem [\ref=moshethm]:

In the special case with a group correspondence in the top row of the diagram, we can make do without this wish, by means of a somewhat opaque diagram chase given below. It is given in rather more detail in the author's thesis [\cite=mythesis], in the language of algebraic geometry.

One diagram chase.

The purpose of this section is Proposition [\ref=firstchaseprop] which bounds the degrees of the functions in the middle row of the diagram in Corollary [\ref=gpdiagthm] by the degrees of the functions in the bottom row.

Given the commutative diagram of irreducible L-definable sets and finite dominant rational functions from Corollary [\ref=gpdiagthm]

where

the horizontal arrows are projections, so B  ⊂  A  ×  Aσ, D  ⊂  C  ×  Cσ, and F  ⊂  E  ×  Eσ;

[formula] is a group correspondence; and

the two middle vertical arrows are restrictions of π  ×  πσ and ρ  ×  ρσ to D;

we construct another diagram of the same shape, with the same properties and the same A, B, f and g, satisfying an additional assumption that deg (β)  ≤   deg (g).

The rest of this section is the proof of the proposition. If the original diagram already satisfies the additional assumption, we are done. Otherwise, we construct another diagram of the same shape with a lower-degree π, and induct on deg (π). Note that when deg (π)  =  1, the additional assumption is automatically true, so this induction has a base case. We begin the induction step by finding a non-trivial shared initial factor of α and [formula].

Consider the deg (π) deg (β) points in a generic fiber [formula]. If α and [formula] do not share any nontrivial initial factors, α(F) has the same size as F. By the commutativity of the diagram, [formula] which has at most deg (πσ) deg (g) many points, which is not enough if deg (β)  >   deg (g).

Since η and β share an extension [formula], Lemma [\ref=leastclosing] produces λ. Since α and β do not share nontrivial initial factors (D is a subset of C  ×  Cσ), it follows that η is not an initial factor of β, so λ is a proper extension of β, i.e. deg (π2)  ≠  1 and so [formula].

Now we use Lemma [\ref=groupclosing] to close the group correspondence in the top row:

Tracing ζ along the left side of the diagram, we see that it factors through β. Tracing it along the right side, we see that it factors through α and, therefore, η. Therefore, the least common extension λ of β and η is an initial factor of ζ.

Now C1, E1, π1, and ρ1 constitute the left column of the new diagram. Applying σ to them, we obtain the right column of the new diagram. To finish, we define

The new diagram clearly commutes. We only need to show that [formula] is a group correspondence.

It is sufficient to show that there is a group homomorphism γ:E  →  E1 such that [formula], because then F1  =  (γ  ×  γσ)(F), an image of a subgroup under a group homomorphism. Since ψ is an initial factor of θ, let γ be such that [formula]. Now [formula]. But also [formula] and [formula], so [formula]. So

[formula]

Since β is surjective, it can be canceled to give

[formula]

The lemma is now proved, the induction step of the proof of the proposition is competed, and we are done.

Another diagram chase.

We now throw up our hands and give up on correspondences; we restrict our attention to the case where B is the graph of a function f:A  →  Aσ. We have no idea how to get around this restriction, which is most vexing. For this special case, Proposition [\ref=firstchaseprop] becomes

This is precisely Proposition [\ref=firstchaseprop] with [formula]; the deg (β)  ≤   deg (g) implies that β is a bijection that can be absorbed into α.

The purpose of this section is to turn the top row of the diagram in Corollary [\ref=firstchasepropfuncinside] into a function as well. The following lemma provides an induction step for the induction on deg (ρ); the base case deg (ρ) = 1 is clear.

We put the fact that [formula] into the diagram and let

[formula]

This A is entirely unrelated to the A in the rest of the paper. Note that A is irreducible, being the image of an irreducible graph of α (isomorphic to the irreducible C) under a finite map (r  ×  rσ). So we get

Let B: = (ψ  ×  ψσ)- 1(F), a subgroup of F  ×  Fσ, and note that A  ⊂  B. It is possible that [formula]; let B0 be the connected component of (the ω-stable group) B. Since A and B have the same Morley rank and A is irreducible, A must be Zariski-dense in some coset B1 of B0. It follows from the fact that models of TA are existentially closed that translation by an appropriate element of F twists A to (being Zariski-dense in) B0, finishing the proof.

We have accomplished the purpose of this section:

What were we chasing after?

Here we combine the technical results of the last two sections with Corollaries [\ref=gpdiagthm] for ACFA and [\ref=gpdiagta] for a general TA.

Corollary [\ref=gpdiagta] and Proposition [\ref=firstchaseprop].

Corollary [\ref=gpdiagta] and [\ref=firstchasepropfunc].

In ACFA, the above applies when some minimal grouplike Lσ-type is very dense in [formula].

(ACFA) Given an L-definable A of Morley degree 1 and an L-definable finite (and, therefore, dominant) rational f:A  →  Aσ, suppose that some very dense type in [formula] is grouplike. Then there are an irreducible group E and a finite dominant rational group homomorphism φ:E  →  Eσ, an irreducible C and a finite dominant rational α:C  →  Cσ, and L-definable finite dominant rational π and ρ such that the following diagram commutes:

Characterization for curves in ACFA

Corollary [\ref=groupfuncdiagta] is the most we can prove for TA for an arbitrary T. Restricting to ACFA and to σ-degree 1 allows us to obtain a much stronger result, relying on jet spaces of varieties and on Hurwitz-Riemann equations for ramification loci of rational functions between curves. Before we can do that, however, we must translate the conclusion of the theorem into the language of algebraic geometry, which is not exactly the same as model theory of algebraically closed fields. In particular, we now pay for having redefined the notion of "rational function"; to distinguish them, we will write rational morphism for the notion from algebraic geometry. We end this paper with that translation. The algebraic geometry results that are needed for the final Theorem [\ref=endthm] belong to algebraic geometry and may be of independent interest, so they get a paper of their own [\cite=secondpaper].

here are the main ideas of the translation:

If (K,σ) is a model of ACFA and Φ is the Frobenius automorphism on K, then [formula] is also a model of ACFA, for any [formula] (Corollary 1.12 in [\cite=ChaHru1]).

By quantifier elimination in ACF, definable sets are constructible: up to subsets of lower Morley rank they are (classical affine) varieties.

Rational functions on curves are (equivalent to functions) of the form [formula] where f is a separable rational morphism, Φ is the Frobenius automorphism, and [formula].

Purely inseparable functions f are known to give rise to field-like [formula] ([\cite=ChaHru1]), so we may exclude them from our consideration. The rest are known not be fieldlike, so the diagram in Theorem [\ref=groupfuncdiagthm] is not only necessary but also sufficient for [formula] to be grouplike (Theorem 4.5 in [\cite=ChaHru1], but see also example 6.6 in [\cite=ChaHru1]).

The last two items are false for varieties of higher dimension.

With these ideas we attack the diagram in the conclusion of Theorem [\ref=groupfuncdiagthm]:

First, by taking Zariski closures and trimming lower-dimensional components (Morley degree is insensitive to them, so they may have snuck in), we may assume that A, C, and E are varieties. To do anything about the arrows, we must restrict to σ-degree 1, that is we must require A, C, and E to be curves. Writing [formula] and replacing the top half of the diagram by Φn(), we may assume that π is a separable rational morphism. Writing [formula] and replacing the top row by Φn - m(), we may assume that ρ is a separable rational morphism. Counting inseparable degrees, we may write [formula], [formula], and [formula] all with the same k, where [formula], turning the diagram into where all arrows in the left half of the diagram are separable rational morphisms. We apply the algebraic geometry theorems to the left half of the diagram characterizing fτ, and then add Φk into the characterization to describe f.

The next two theorems, the first easy and the second not so easy, are proved in the author's thesis [\cite=mythesis] and will appear in another paper [\cite=secondpaper].

[\cite=secondpaper] If (K,τ) is a model of ACFA, E is an algebraic group curve, φ':E  →  Eτ is an algebraic group homo- but not isomorphism and the following diagram of curves and finite separable rational morphisms commutes Then there is a birational isomorphism g:C  →  D to an algebraic group D and an isogeny ψ:D  →  Dτ such that [formula].

[\cite=secondpaper] If (K,τ) is a model of ACFA, D is an algebraic group curve, ψ:D  →  Dτ is an algebraic group homo- but not isomorphism, and the following diagram of curves and finite separable rational morphisms commutes Then there is another algebraic group [formula], an isogeny ψ̃:  →  σ, and a finite separable [formula] such that also commutes, and [formula] is the quotient of [formula] by a (finite) group of algebraic group automorphisms.

Since the (separable) degree of f' is at least 2, the genus of (the normalization of) A is at most 1. Since any definable function between elliptic curves is an isogeny composed on translation, it is easy to see (see [\cite=secondpaper]) that when A has genus 1, any f' of degree at least 2 gives rise to a grouplike [formula]. Thus, the interesting case is when A is (birational to) [formula]. Such rational functions f' have all kinds of remarkable properties and have been studied since the nineteenth century. When D is the multiplicative group, its only algebraic group automorphism of finite order is [formula], and the corresponding f' are the Chebyshev polynomials. When D is an elliptic curve, the degree of π is small (generically, 2, and at most 24 for the worst positive characteristic, complex multiplication case [\cite=silverell]) and f' is called a Lattès function; it is never a polynomial. In positive characteristic, D may also be the additive group (ψ̃ is then a separable additive polynomial such as xp + x). In that case, the degree of [formula] is bounded by the degree of ψ̃ (see [\cite=secondpaper]). Surely someone has called such f' additive Lattès functions, and that is our terminology. Which all adds up to the following theorem that was so useful in [\cite=polydyn].

If (K,σ) is a model of ACFA, A is an algebraic curve and f:A  →  Aσ is a definable finite rational function, the following are equivalent:

some type in [formula] is grouplike

all types in [formula] are grouplike

there is a birational morphism h:A  →  B and a separable f' with deg (f')  ≥  2 such that [formula] for some [formula] and either B is an elliptic curve, or [formula] and f' is a Chebyshev polynomial, a Lattès function, or an additive Lattès function.

Furthermore, this property of the pair (A,f) is first-order definable.