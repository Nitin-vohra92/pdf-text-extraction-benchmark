Lemma Conjecture

Putting Dots in Triangles

The problem

Consider a 'triangle' of squares in a grid whose sides are n squares long, as illustrated by the diagram in Figure [\ref=7.fig], for which n = 7. We call a southwest-to-northeast diagonal a standard diagonal. Note that our triangle consists of all the cells in an n  ×  n square that lie on or below the longest standard diagonal.

We denote by N(n) the maximum number of dots that can be placed into the cells of the triangle such that each row, each column, and each standard diagonal contains at most one dot. Determining N(n) is equivalent to solving the following problem: Suppose we have a chessboard made up of hexagonal cells arranged in the shape of an equilateral triangle of side n. Then N(n) is the maximum number of non-attacking queens that can be placed on such a board, where a queen can move in any one of the three directions allowed on a hexagonal grid. The following theorem was proven by Vaderlind, Guy and Larson [\cite=VGL] and independently by Nivasch and Lev [\cite=NL]:

[formula], where

[formula]

Note that the value of [formula] can be stated more succinctly as follows:

[formula]

In order to prove Theorem [\ref=main.thm], we require a construction to establish the lower bound [formula] as well as a proof of the upper bound [formula]. In [\cite=NL] [\cite=VGL], the upper bound was proven by elementary combinatorial arguments. In this note, we give a new proof of the upper bound using linear programming techniques. In the end, our proof is also combinatorial; the main contribution we make is to demonstrate the use of linear programming techniques in deriving the proof.

The lower bound

Before proving the upper bound, we give a construction to show that [formula]. This construction is essentially the same as the ones in [\cite=NL] [\cite=VGL].

[formula].

First, we show that N(3t + 1)  ≥  2t + 1:

Place a dot in the leftmost cell of the (2t + 1)st row (where we number rows from top to bottom).

Place t more dots, each two squares to the right and one square up from the previous dot.

Place a dot in the (t + 2)nd cell from the left in the bottom row.

Place t - 1 more dots, each two squares to the right and one square up from the previous dot.

It is easily verified that at most one dot is contained in each row, column, or standard diagonal.

Next, N(3t + 2)  ≥  N(3t + 1)  ≥  2t + 1 (it suffices to add a row of empty cells). Finally, N(3t)  ≥  N(3t + 1)  -  1  ≥  2t (delete the bottom row of cells from a triangle of side 3t + 1, noting that any row contains at most one dot).

A new proof of the upper bound

The computation of N(n) can be formulated as an integer linear program. Suppose we number the cells as indicated in the Figure [\ref=6.fig] (where n = 6):

Define xi,j  =  1 if the corresponding cell contains a dot; define xi,j  =  0 otherwise. The sum of the variables in each row, column, and standard diagonal is at most 1. This leads to constraints of the form

and Finally, xi,j∈{0,1} for all i,j. The objective function is to maximize [formula] subject to the above constraints. It is obvious that the optimal solution to this integer program is N(n).

It is possible to relax the integer program to obtain a linear program, replacing the condition xi,j∈{0,1} by 0  ≤  xi,j  ≤  1 for all i,j. In fact, we do not have to specify xi,j  ≤  1 as an explicit constraint since it is already implied by the other constraints; it suffices to require 0  ≤  xi,j for all i,j. Denoting the optimal solution to this linear program by [formula], we have that [formula].

Using Maple, it can be seen that [formula] (a solution to the LP having this value is presented in Figure [\ref=LP:n=6]).

Next, we tabulate some solutions to [formula] for small values of n in Table [\ref=tab1]. Based on the numerical data in Table [\ref=tab1], it is natural to formulate a conjecture about [formula]:

Define

[formula]

Then we conjecture that [formula].

It is easy to show the following:

If the LP Conjecture is true, then [formula].

First, the LP Conjecture asserts that

[formula]

Because N(n) is an integer and [formula], we have that

[formula]

Simple arithmetic establishes that

[formula]

Combining ([\ref=eq1]), ([\ref=eq2]) and ([\ref=eq3]), we have

[formula]

We showed in Theorem [\ref=thm:construction] that [formula]; hence [formula]

The optimal solution to the linear program for n = 6 that we presented in Figure [\ref=LP:n=6] does not seem to have much apparent structure that could be the basis of a mathematical proof. Indeed, most of the small optimal solutions that we obtained are quite irregular, which suggests that proving the LP conjecture could be difficult. We circumvent this problem by instead studying the dual LP and appealing to weak duality.

An LP in standard form is specified as:

This is often called the primal LP. Any vector x such that Ax  ≤  b, x  ≥  0 is called a feasible solution. The objective function is the value to be maximized, namely, cTx.

The corresponding dual LP is specified as:

Here, a feasible solution is any vector y such that ATy  ≥  c, y  ≥  0. The objective function is bTy.

We will use the following classic theorem.

The objective function value of the dual LP at any feasible solution is always greater than or equal to the objective function value of the primal LP at any feasible solution.

We now describe the dual LP for our problem. Suppose we label the rows of our triangle by [formula], such that ri is the row containing i squares, and we label the columns and diagonals similarly. The following simple lemma is very useful.

If a cell is in row ri, column cj and diagonal dk, then i + j + k = 2n + 1.

In fact, it is not hard to see that there is a bijection from the set of n(n + 1) / 2 cells to the set of triples

[formula]

In the dual LP, the variables are [formula], [formula], [formula]. There is a constraint for each cell C. If C is in row ri, column cj and diagonal dk, then the corresponding constraint is

[formula]

The objective function is to minimize [formula].

It turns out that there exist optimal solutions for the dual LP that have a very simple, regular structure. These were obtained by extrapolating solutions for small cases found by Maple.

When n  =  3t + 1, define

[formula]

When n  =  3t + 2, define

[formula]

When n  =  3t, define

[formula]

The values ri,ci and di defined in [\eqref=1.soln], [\eqref=2.soln] and [\eqref=0.soln] are feasible for the dual LP, and the value of the objective function for the dual LP at these solutions is [formula].

First we consider the case n  =  3t + 1. Consider any cell C, and suppose C is in row ri, column cj and diagonal dk. Then we have that

[formula]

Therefore all constraints are satisfied. The value of the objective function is

[formula]

The proofs for n  =  3t + 2 and n = 3t are very similar.

Our new proof of Theorem [\ref=main.thm] follows immediately from Lemma [\ref=feas.lem] by slightly modifying the proof of Theorem [\ref=LPproof.thm].

First, from weak duality and Lemma [\ref=feas.lem], we have Combining this inequality with ([\ref=eq2]) and ([\ref=eq3]), we have

[formula]

We showed in Theorem [\ref=thm:construction] that [formula]; hence [formula]

Discussion

We investigated the "dots in triangles problem" due to an application to honeycomb arrays (see [\cite=BPPS]). However, we did not realize that the dots in triangles problem had already been solved. Since we did not know the value of N(n), we adopted an "experimental" approach:

We used Maple to gather some numerical data.

We formulated (obvious) conjectures based on the numerical data.

Finally, we proved the conjectures mathematically.

Many problems in combinatorics are amenable to such an approach, but this particular problem serves as an ideal illustration of the usefulness of this methodology. Indeed, the problem seemed almost to "solve itself", with minimal thought or human ingenuity required!

It should also be emphasized that, in the end, the resulting proof is quite short and simple:

By a suitable direct construction, prove that [formula].

Show that the dual LP has a feasible solution whose objective function value is less than [formula].

The first conjecture we posed was the LP Conjecture, concerning the optimal solutions to the LP. In general, to prove a feasible solution to an LP is optimal, it is necessary to do the following:

Find a feasible solution to the primal LP and denote the value of the objective function by C.

Find a feasible solution to the dual LP and denote the value of the objective function by C*.

If C  =  C*, then the solution to the LP is optimal (this is often called strong duality).

When [formula], our work in fact proves the LP conjecture. This is because Theorem [\ref=thm:construction] yields a solution to the primal LP whose objective function value matches the solution we later found to the dual LP. However, when [formula], we do not have a general solution to the primal LP whose objective function value matches the solution to the dual LP. Although we are confident that the LP conjecture is also true for these values of n, proving it could get messy!

Acknowledgements

Research of SRB and MBP was supported by EPSRC grant EP/D053285/1 and research of DRS was supported by NSERC grant 203114-06. The authors would like to thank Tuvi Etzion for discussions, funded by a Royal Society International Travel Grant, which inspired this line of research. Many thanks also to Bill Martin, for comments on an earlier version of this paper.