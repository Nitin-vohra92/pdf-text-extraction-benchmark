An analytic approach to baryon acoustic oscillations

Introduction

Before recombination the Universe is dense and highly ionized, and baryons and photons are tightly coupled by Thomson scattering. The pressure of the Cosmic Microwave Background (CMB) photons opposes gravitational collapse and leads to acoustic oscillations. In fact, during this phase, the amplitude of perturbations in the baryon density cannot grow, but they oscillate with a slowly decaying amplitude. After recombination, baryons decouple from radiation and the oscillations are 'frozen in'. Because baryons represent a significant fraction of matter, cosmological perturbation theory [\citep=HS1996] predicts that these acoustic oscillations of the baryons (BAO's) are imprinted on the late-time matter power spectrum, leaving features analogous to the acoustic peaks in the CMB power spectrum. The BAO's have indeed been observed in the large scale galaxy distribution [\citep=eisenstein:2005] [\citep=tian] [\citep=arnalte-mur], and they are one of the main observational goals of recent and upcoming surveys.

Numerical calculations of the recombination history are available thanks to, e.g., the Rico [\cite=Fendt:2008uu] or the Recfast [\cite=Seager:1999New] codes for the recombination history. The latter, in particular, is the default model used in the Camb Boltzmann-solver code [\citep=Lewis:1999bs]. It does reproduce the results shown in [\cite=Seager:1999New] and is a fast approximation to the detailed calculations described in [\cite=Seager:1999km] with some updates discussed in [\cite=Wong:2007ym] and with the Compton coupling treatment of [\cite=Scott:2009]. The numerical calculation of the recombination history is much more time expensive than employing analytical approximations or fitting formulae, like the ones used by [\cite=EH98] which are an improvement of the fits presented in Appendix D of [\cite=HS1996]. Nevertheless, an accurate computation of the recombination history turns out to be a significant step for the evaluation of the location of troughs and peaks in the transfer function.

At early times, before recombination, baryons and photons behave as a single 'tightly coupled' fluid because Thomson scattering, which couples electrons and photons, is much more rapid than the expansion of the universe ts  ≪  H- 1, where ts = (σTne)- 1 is the photon scattering time scale (i.e. the mean time between Thomson scatterings) and H- 1 the expansion time scale of the universe. Here σT is the Thomson cross section and ne is the number density of free electrons. Since scattering is rapid compared with the travel time across a wavelength, we can expand the perturbation equations in powers of the Thomson mean free path [formula] over a wavelength [formula], i.e. [formula], where [formula] is the differential optical depth. To the lowest order we obtain the tight coupling approximation (TCA) [\citep=MaBert95]. A more rigorous definition and treatment of the TCA can be found in [\cite=pitrou], while [\cite=cyr-racine] analyzes the second-order approximation in the inverse Thomson opacity expansion. In [\cite=Blas:2011rf] formulas for the TCA to second-order are derived independently and tested. These results are implemented by the Class Boltzmann code.

It can be demonstrated that at large scales the transfer function is governed by density perturbations, which oscillate roughly like a [formula] where s is the sound horizon at decoupling, see e.g. [\cite=HS1995] and the Appendix D of [\cite=HS1996]. However, the corresponding velocity perturbation dominates in the small scale limit. When the oscillations are released at decoupling, baryons move kinematically according to their velocity and generate a new density perturbation [\citep=EH98]. This 'velocity overshoot' effect is responsible for the fact that the transfer function, for sufficiently large ks, actually behaves like [formula].

In this paper we derive a fitting formula for the location of the peaks and troughs in the matter power spectrum by matching the solutions for the matter density perturbation before and after decoupling. We obtain a form which is consistent with the one proposed in [\cite=EH98] for the position of the first peak. However, our fit is tested considering recent cosmological parameters and it uses an improved recombination history. The latter turns out to be an important amelioration which lets us achieve a significantly better accuracy than the previous fit. Even though one can compute the positions of these peaks numerically with the help e.g. of Camb-code, we believe that an analytical fit has its merits as it helps us to see immediately what effect a variation of cosmological parameters will have and since it gives us a better understanding of the physics involved.

The paper is organized as follows. In Section [\ref=s:BAO] we review the physics leading to BAO: the ionization history, the TCA and the velocity overshoot effect. In Section [\ref=s:1pk] we give the fitting formula and we compare the results with [\cite=EH98]. We state our conclusions in Section [\ref=s:concl]. Some details of the derivations are moved to an Appendix A.

Baryon Acoustic Oscillations

We review the physics leading to BAO, in order to highlight the main results that allow us to locate the peaks and troughs in the transfer function.

We use the notation of [\cite=durrerPT]. In particular, t denotes the cosmic time and η conformal time such that adη  =  dt, where a is the scale factor. An over-dot indicates a derivative w.r.t. the conformal time [formula]. We also use of the notation [formula], where the subscripts b and γ label the energy density of baryons and photons, respectively. Our reference model is a ΛCDM Universe.

Ionization history

In [\cite=Seager:1999New] a calculation of the recombination of H, He I, and He II in the early Universe is developed which is implemented in the publicly available code Recfast. The methodology is to calculate recombination with as few approximations as possible. One of the main improvements with respect to previous calculations is that it takes into account that the population of excited atomic level depart from an equilibrium distribution. Indeed, recombination is not an equilibrium process. Simplified analytical calculations or approximate fitting formulae for the recombination history are too crude to give good approximations for the location of peaks and troughs in the matter transfer function as we will discuss in §[\ref=s:1pk].

Recfast models hydrogen and helium atoms as effective three-level systems, including some artificial corrections via conveniently chosen fudge factors [\cite=Wong:2007ym]. An alternative approach is the Rico code [\cite=Fendt:2008uu], which smoothly interpolates the ionization fraction on a set of pre-computed recombination histories for different cosmologies. The inclusion of previously neglected physics leads to changes in the ionization fraction at the (2  -  3% level in some redshift regions. However, throughout this paper, we run the Camb code using Recfast version 1.5, which gives a sufficiently accurate recombination history for our purposes.

On the other hand, we treat the late-time reionization of hydrogen and helium via the fitting formulae proposed in the appendix of [\citep=Lewis:2008wr].

Tight Coupling Approximation

Here we derive an analytical solution for the baryon density perturbation in the tight coupling approximation (TCA) in first order perturbation theory using the WKB approximation valid for a slowly varying R, inside the sound horizon at decoupling given by s≃c(γb)sηdec. Here c(γb)s is the sound speed of the baryon-photons fluid (defined in appendix [\ref=app:TCA], Eq. ([\ref=eq:c2s_gr])), and ηdec is the decoupling time. Hence, we must keep in mind that this approximation is valid only for sufficiently large k. For the range of our interest this is fine since acoustic oscillations concern relatively small scales, of the order of 100h- 1 Mpc [\citep=eisenstein:2005].

We perform our calculation in the uniform curvature gauge, the differences between the variables calculated in different gauges is small on sub-horizon scales [\citep=durrer]. Furthermore, all the physical observables must be indeed gauge invariant. So, in terms of the density perturbation in the uniform curvature gauge, Dg [\citep=durrerPT], the general tight coupling solution for the baryon density perturbation is given by (see appendix [\ref=app:TCA] for a derivation) D(in)gb  =  (3 / 4)D(in)gγ is determined by the adiabatic initial condition and [formula] is the Bardeen potential [\citep=durrer]. We have introduced the (comoving) sound horizon [formula], i.e., the distance that a wave can travel in a time η. During the tight coupling phase the baryon density perturbations undergoes harmonic motion following roughly a cosine mode with an amplitude that decays in time as [formula].

To show that this solution follows a cosine mode, a simple analytical approximation of the Bardeen potential [formula] can be obtained by writing the Bardeen equation in the case of adiabatic perturbations for a mixture of perfect fluids (photons, baryons and CDM). On super-horizon and sub-horizon scales one finds [\citep=durrer], respectively, where the initial metric perturbation [formula] is constant in time and [formula]. To derive these relations, we also assume [formula]. Here [formula], where P and ρ denote the total pressure and energy density of the baryon-photon fluid, respectively. The latter approximation means that, since the WKB approximation requires slowly varying R, we suppose [formula] over an oscillation period. This implies that we are also approximating the equality epoch as roughly the decoupling epoch.

Computing the integral in Eq. ([\ref=eq:bar_an_int]) we obtain an analytical approximation for the baryon density perturbation in the tight coupling limit. Neglecting the small contribution from x < 1 in the integrand of Equation ([\ref=eq:bar_an_int]), using Equation ([\ref=eq:PsiSmall]) and R≃0, we obtain where [formula] and [formula] are the sine and cosine integral functions. Finally, we consider modes [formula] and use approximately the asymptotic form [formula] and [formula] valid for x  ≫  1, we obtain

[formula]

We summarize our result for the tight coupling approximation in the form Making use of the perturbed Einstein constraint equations and of the Friedmann equations to rewrite Ψ0, we obtain

[formula]

Deviations of D(t.c.)gb from the cosine mode decay like x- 2. In Fig. [\ref=fig:DbSmall] we compare the pure cosine mode with the full approximate solution given by Equation ([\ref=eq:DbSmall]). For [formula] the deviation from the cosine mode is negligible, and only for [formula] the integral term is dominant.

In conclusion, the peaks of the tight coupling solution for baryon density perturbations [formula] closely follow those of [formula] for small scales, say [formula], while the few first peaks may exhibit deviations due to the integral term. In particular we expect large deviations from the cosine mode for [formula]. This consideration allows us to find a formula to fit the position of the peaks and of the troughs of the matter power spectrum.

Velocity overshoot

The velocity overshoot effect can be explained by noting that decoupling is close to equality, [formula]. Before ηeq  ~  ηdec, baryons are tightly coupled to photons and their velocity is governed by the dynamics of photons, which are the dominant component. Indeed, [formula], where [formula] indicates 'oscillates as', is the tight coupling solution in the limit [formula] (see Appendix [\ref=app:TCA], Eq. ([\ref=eq:Vb_Vg_TC])). When η  >  ηeq, the energy density of photons ργ becomes smaller than the matter energy density ρm. Furthermore, for η  >  ηdec baryons are no longer coupled to radiation. This implies that for η  >  ηeq  ~  ηdec, baryons no longer follow the photon velocity. As we shall see, the baryon velocity after decoupling, [formula] is almost exactly out of phase with [formula].

This can be shown by matching the solutions for the baryon density perturbation before and after decoupling. As derived above, the adiabatic initial conditions for an inflationary model select the cosine mode for the baryon density perturbation tight coupling solution on small scales, which is given in Eq. ([\ref=eq:Db_tc_approx]) for [formula]. Let us indicate Dgb the solution after decoupling; we match it to the tight coupling solution, After decoupling baryons evolve like CDM. The evolution of Dgb can then be evaluated by considering the Bardeen equation for a mixture of non-interacting radiation and matter fluids in a matter dominated epoch that, neglecting the decaying mode, yields Ψ  =  Ψ(k,ηdec) constant in time. Using equations ([\ref=eq:match_D]) and ([\ref=eq:match_dD]) as initial conditions and denoting the present time by η0, on small scales [formula] we obtain

[formula]

The dominant term here is [formula] which comes from the baryons falling into the gravitational potential of dark matter. In addition, we have a growing function oscillating like [formula] plus a correction due to the Ψ0-term which slightly affects the period of the oscillations, see discussion below Eq. ([\ref=eq:DbSmall]).

To better understand the expression in square brackets, let us consider Equation ([\ref=gx]), which for [formula] shows that

[formula]

This suggests that the position of the troughs and peaks in the matter power spectrum may differ slightly from those of [formula] and this difference is proportional to Ψ0 which is in turn proportional to Ωmh2. Since the pre-factor is small, we can approximate ks sin (ks)  +  εks cos (ks) by ks sin (ks  +  ε)  +  O(ε2). With this, we expect that the positions of the troughs and the peaks in the matter power spectrum are approximately given by

[formula]

where [formula] for the troughs and [formula] for the peaks, and where βn is a parameter that takes into account the correction which affects mainly the lowest kn's and which can be fitted by comparing with numerical results. Since [formula] and [formula], we naively expect ε > 0 and hence βn < 0. We shall see, however, that the approximations made for the decoupling redshift actually lead to βn > 0.

Fit of the acoustic peak positions

Eq. ([\ref=eq:k_fit]) allows us to localize the troughs and the peaks in the matter power spectrum. We finally want to derive an explicit form for the sound horizon at decoupling s, defined as the comoving distance that a wave can travel prior to decoupling tdec:

[formula]

The sound speed of the photon-baryon plasma is given in appendix [\ref=app:TCA], Eq. ([\ref=eq:c2s_gr]).

This integral can be computed exactly if we neglect the contribution of dark energy to z, which is a very good approximation for the redshifts we are interested in. The subscripts b, c and m refers to baryons, CDM and non-relativistic matter (baryons plus CDM), respectively; we define the density parameter [formula] for the species X. The subscript γ refers to photons while the subscript r refers to the density in relativistic particles at the time of equal matter and radiation, which probably also comprises three types of neutrinos. We consider, ωc, h, ωm as independent cosmological parameters, keeping the first two fixed and varying the latter. We then write the remaining parameter as ωb  =  ωm  -  ωc. This yields

[formula]

H0 is the value of the Hubble parameter today and [formula] is the r-parameter defined in [\cite=Vonlanthen:2010cd]. It is worth stressing that here zdec denotes the baryon decoupling redshift. In fact, even if radiation decoupling epoch is z*≃1100, the scattering rate of electrons is sufficient to keep the matter temperature Tm equal to radiation temperature Tγ down to redshifts z  ~  100. Then, to extract BAO's information is necessary to integrate up to the baryon decoupling epoch, also known as drag epoch. However, for z < z* Equation ([\ref=eq:c2s_gr]), which gives c(γb)s during the tight coupling regime, no longer holds. Nevertheless, we note that in the Recfast code Tm is set to Tγ (plus a small correction) until a typical switching redshift z  ~  850, after which the full evolution equation for Tm are considered [\cite=Scott:2009]. We find convenient for the fit to artificially shift the baryon decoupling redshift to the Recfast 'switch' value, zdec = 850, still considering Equation ([\ref=eq:c2s_gr]) for c(γb)s. Furthermore, the zdec value is almost independent of the cosmological parameters within the range of our interest[\cite=mukhanov].

This approximate zdec treatment force us to reconsider the interpretation of Equation ([\ref=eq:k_fit]). In fact, we extrapolate this formula to correct also the uncertainties related to zdec. As we will see, this implies in particular that βn  >  0 in our fit.

In [\cite=EH98] a fitting formula for the matter transfer function of a CDM plus baryon Universe can be found. The curvature and also the cosmological constant are neglected. Since the latter do not contribute significantly to the sound horizon at decoupling, this approximation is still valid in a ΛCDM Universe. In Figure [\ref=k_kEH] we compare the first peak positions k1,pk  /  kE.H.1,pk evaluated approximatively as 5π  /  2s. The wavenumber k1,pk is calculated by using Eq. ([\ref=eq:s_develop]) with zdec in accordance to Recfast, while kE.H.1,pk is calculated according to the sound horizon at decoupling employed in Eisenstein and Hu (1998) [\cite=EH98]. The parametric formulas for s lead to an agreement within 1% for the first peak position when considering the same recombination redshift as used in [\cite=EH98]. Instead, if we use the value consistent with Recfast in Equation ([\ref=eq:s_develop]), we find that in [\cite=EH98] the position is systematically overestimated (in terms of k) by about 10%. Furthermore, the full fitting formula proposed in [\cite=EH98], accounting also for the Ωm-correction, yields disagreements up to 15% with respect to the numerical results obtained with Camb.

Fit of the acoustic peak positions

Let us discuss, for illustrative purpose, the fit of the first three troughs and peaks in the matter power spectrum, Figure [\ref=fig:Fit_k123]. As we are not now interested in precision, the fit is compared to a numerical code [\citep=FM] that agrees with Camb within about 5%.

It is clear that the form of the fit is adequate to reproduce the numerical results, but let us consider Table [\ref=tab:B_123], which reports the fit parameters obtained, to check our expectations. From Equation ([\ref=eq:k_fit]) we see that the relative importance of the β-correction is given by βnωm. As explained above, this correction is due to the fact that the first nodes of the transfer function slightly differ from those of sin (ks), also for [formula], because of the velocity overshoot effect; together with the approximation for zdec which is too high, hence an s which is too small, leads to βn  >  0. Indeed, as shown in Table [\ref=tab:B_123] a correction of about 25% is obtained for the first trough. This β-correction is larger than the other cases, for which is about 10%, and it is due to the fact that the corresponding ks = 3π / 2 is the closest to the critical value ks = π. Actually, we also note that the corrections for the troughs are larger than for the peaks; this is due to the method used to extrapolate the trough and peak positions, but here we neglect this detail.

The fitting formula for the first peak

The first peak position in the matter power spectrum is conveniently fitted by Note that the units are Mpc, not h- 1Mpc. With this, the fit ([\ref=eq:k1pk_final]) deviates by less than 5% from the numerical results of Camb for the range of cosmological parameters, around the values reported in [\cite=spergel], [formula], [formula] and [formula].

In Figure [\ref=fig:Contour_Om_ObOm] we show the location of the first peak k1,pk as a function of baryon and matter density parameters. As the baryon fraction Ωb  /  Ωm increases, the first peak is shifted to smaller scales, since the sound speed and with it s decrease. The value of k1,pk also increases with Ωm, due to the larger contribution of the Ωm-term in Equation ([\ref=eq:k1pk_final]).

Conclusions

Matching the tight coupling approximation, Eq. ([\ref=eq:DbSmall]), to the solutions after decoupling, allowed us to develop further the approach initiated in [\cite=HS1996]. This yields an analytical formula for the location of the peaks and troughs in the matter power spectrum, Eq. ([\ref=eq:k_fit]). The formula has the same form as the one given in [\cite=EH98].

Using the same approximation for the recombination history as [\cite=EH98], we obtained results compatible with  [\cite=EH98] within about 1%, even though we consider very different cosmological parameters, [formula] as compared to [formula] which was considered in [\cite=EH98]. This shows that the acoustic peak positions are not really sensitive to [formula] but only to ωm, ωb and of course Ωtotal. This corresponds also to the findings of [\cite=Vonlanthen:2010cd]. However, considering an improved recombination history, i.e., using Recfast, the fit proposed in [\cite=EH98] for the location of the first peak in the matter power spectrum no longer holds.

This leads us to propose an improved fitting formula for the position of the first peak obtained by running Camb, see equations ([\ref=eq:k1pk_final]), ([\ref=eq:s_final]) and Figure [\ref=fig:Contour_Om_ObOm]. The fit yields the location of the first peak in a convenient range of cosmological parameters around the values reported in [\cite=spergel], with an accuracy of about 5% with respect to the numerical results of Camb, whereas the fitting proposed in [\cite=EH98] disagrees by up to 15% with Camb within the range of parameters we explored. The 5% error estimation takes into account not only discrepancies with respect to Camb, but also minor contributions that may come, e.g., from neglected non-linear effects, or variations of 1% order in the ionization history. The latter might be improved by using a different recombination code like Rico and, as minor contribution, by improving treatment of reionization .

The fit may be improved on the one hand by better approximations of the baryon density Dbg and by improving the recombination history and on the other hand by improving the fitting formula ([\ref=eq:k1pk_final])-([\ref=eq:s_final]) itself. This may also imply a more accurate discussion of the baryon decoupling redshift, see Equation ([\ref=eq:s_develop]), which here has been artificially shifted to zdec = 850, based on the implementation of Recfast, independently of cosmological parameters. However, we expect that most of the individual effects will lead at best to a 1% improvement and recalling that on this level e.g. also the value of the scalar spectral index affects the peak position, we believe that a better fitting formula would be very complicated and to obtain significant improvements in the evaluation of the first peak position one has to resort numerical calculations which might need to go to second order in perturbation theory.

Our fitting formula is especially useful for a first estimate of the effects of changing cosmological parameters on the positions of the baryon acoustic peaks. Acknowledgments We thank Gianfranco de Zotti and Sabino Matarrese for discussions. This work is supported by the Swiss National Science Foundation.

Tight coupling approximation

In order to derive Eq. ([\ref=eq:bar_an]), we consider the evolution of baryon perturbations during the tight coupling regime. We follow [\cite=dodelson] and [\citep=durrer], where the evolution of photon perturbations is discussed in detail. Since baryons are coupled via Thomson scattering to photons, the evolution of baryon perturbations is related to that of photons by the differential optical depth [formula], where σT denotes the Thomson cross section and ne the electron number density. Indeed, the equations governing the baryon perturbations evolution read [\citep=durrer]: Since CDM does not interact other than gravitationally, we do not need to consider its evolution here.

If we take the limit [formula] in Equation ([\ref=eq:dVg]) we find

[formula]

This zero-order tight coupling solution leads to an important consideration: during the tight coupling phase, perturbations between baryons and photons are roughly adiabatic on all scales due to Thomson scattering.

Using this zero-order result (in [formula]) back in the l.h.s. of Equation ([\ref=eq:dVg]) we find the leading order equation:

[formula]

Using this in Eq. ([\ref=eq:dVb]) we obtain:

[formula]

Differentiating Eq. ([\ref=eq:dDb]) and using Eq. ([\ref=eq:dVb_2]) to replace [formula] we find:

[formula]

We use again Eq. ([\ref=eq:dDb]) to substitute kVb and the fact that until photons and baryons are tightly coupled, the adiabaticity condition [formula] holds [\cite=durrer]. Then, we have

[formula]

Using [formula], the comoving Hubble parameter writes [formula]. We write the sound speed of the photons plus baryons system as

[formula]

where we also used Pb = 0 and Pγ  =  ργ / 3 for the baryon and photon pressure, respectively.

We finally write the equation for the baryon density perturbations as

[formula]

where we have defined the forcing function

[formula]

Eq. ([\ref=eq:HarmOscil]) represents damped, driven oscillations of the baryon density perturbation. The second term on the left-hand side is the damping of oscillations due to the expansion of the universe. The third term on the left-hand side is the restoring force due to the pressure. The forcing function is governed by the gravitational potential perturbations. These oscillations are called 'acoustic oscillations' since, as in acoustic waves, the photon-baryon fluid cannot simply collapse under gravity because of the restoring force provided by the pressure which leads to oscillations.

To obtain an analytical solution to Eq. ([\ref=eq:HarmOscil]), we first find the solutions to the homogeneous equation through the WKB approximation [\cite=HS1995], valid for slow varying R, inside the sound horizon at decoupling given by s≃c(γb)sηdec. Then we obtain a particular solution by the standard Green's method imposing adiabatic initial conditions. This yields the general tight coupling solution for the baryon density perturbation

[formula]

where

[formula]