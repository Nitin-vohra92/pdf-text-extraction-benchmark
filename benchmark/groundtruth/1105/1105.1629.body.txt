Corollary Conjecture Lemma

On triangular billiards

In a recent paper[\cite=KS] on Billiards on rational-angled triangles, R. Kenyon and J. Smillie proved the following theorem:

They further showed, that the restricition on q may be dropped, if the following conjecture was true(see [\cite=KS], p. 94f):

In this note we will prove this conjecture:

Note that the classification of non-obtuse rational angled triangles with the lattice-property is complete, since the cases of isosceles and right angled triangles are completely solved in [\cite=KS], too.

By direct calculation, R. Kenyon and J. Smillie showed, that Theorem 3 is true for n  ≤  10000. We will use this fact at several steps in the proof.

The proof will depend on several facts concerning the distribution of relative prime residue classes, collected in the next Lemma. We write g(n) for the Jacobsthal function, given by the maximal difference of consecutive integers relatively prime to n, and ω(n) for the number of distinct prime factors of n.

Proof: The first statement was proven by Kanold[\cite=Kan]. To prove the second statement note first that it is trivial if (d,n) = 1, for if [formula], then the integers dd'ν + d'a are consecutive mod n, and none is coprime to n, contradicting the definition of g. Now we may without loss assume that n is squarefree. If (d,n)  =  e > 1, the integers dν + a are coprime to n if and only if they are coprime to n / e, thus using the case (n,d) = 1 we get that there is some ν∈[x,x  +  g(n  /  e)] such that (dν + a,n) = 1. The third statement follows for d > 30 from the first one, for 3  ≤  d  ≤  30 by direct inspection. The fourth statement was proven by Iwaniec[\cite=Iwa]. The fifth statement can be checked by direct computation.

Note that the fourth and fifth statement together greatly improve the first one for ω(n)  ≤  8.

Note further that the asymptotic behaviour of g is much better understood, using e.g. the result of Iwaniec[\cite=Iwa2], it is easy to show that there are at most finitely many exceptions to conjecture 2. The difficult part of the proof of Theorem 3 is to give an upper bound for n and find properties on the would-be-counterexample which makes it feasible to rule out these finitely many values.

To prove our Theorem, we first note that we may choose s = 1, since otherwise we replace p by [formula]. Then we have [formula]. In the first step we exclude odd values of n.

Assume that n is an odd counterexample to Theorem 3. Define the integer k by the relation [formula], and a: = t  -  (1 - 2- k)n. Since n is odd, 2k is relatively prime to n, hence we get [formula]. But we have 2kt  =  (2k - 1)n  +  2ka, hence [formula], i.e. [formula]. By the definition of k, we have [formula], thus [formula]. Write [formula].

Next we give an upper bound for 2k. Write t = n - b. The cases b = 1 and b = 2 are excluded, since we would have s + t = n resp. 2s + t = n. If [formula], we have [formula], thus if there is some p in this interval relatively prime to n, we are done. Thus we have

[formula]

The left hand side is decreasing with b, thus if [formula] the left hand side is at least [formula], and for n > 10000 this is [formula]. Hence we obtain the bound [formula]. By Lemma 4 this implies ω(n)  ≤  4, thus g(n)  ≤  10 and n < 300. Thus we may suppose [formula].

Let q < 2k + 1 be an odd prime, and define the integer l by the relation 2l < q < 2l + 1. Assume that [formula]. Then (q2k - l,n) = 1, thus we get [formula]. Using the relation [formula] with 0 < α < 1, this becomes

[formula]

Since q  ≥  2l + 1, this implies

[formula]

hence [formula]. Thus n is divisible by all odd primes [formula]. Using the elementary bound θ(n) > n / 2, where [formula], this implies [formula], which in turn implies n < 121. However, Theorem 3 is true for all n < 10000, thus we conclude that it is true for all odd n.

Thus assume that (n,t) is a counterexample to Theorem 3 with n even.

We show that t cannot be too close to n / 2 or to n. The proofs for these two cases run parallel, and we will only give the first one. Set [formula]. Let p be any integer relatively prime to n, in particular, p is odd. Then we have

[formula]

thus if n is a counterexample to our Theorem, we conclude that [formula], i.e. [formula]. The case b = 1 is excluded, thus the upper bound of this interval is [formula], thus in particular we have [formula]. But the only conditions imposed on p were that p is odd and coprime to n. Since all even integers are not coprime to n, we get that the interval [formula] contains no integer relatively prime to n. Hence [formula], thus [formula], i.e. [formula]. In the same way we have [formula].

Set w = (t,n). As p runs over all integers relatively prime to n, pt runs over all integers with (pt,n) = w, and pt mod n has period n / w. Hence there is some p < n / w, relatively prime to n with [formula]. But then pt mod n + p  ≤  w  +  n / w, and this is ≤  n / 2, unless w = 1,2,n / 2 or n. The last two cases are trivially excluded. Thus we are left with the cases w = 1,2. Now [formula] is a rational number with denominator [formula], thus applying Dirichlet's Theorem we find an integer [formula] and some e  ≤  d, such that [formula].

Assume that d = 1. Then [formula], and because n / 2 < t < n, we conclude [formula]. Together with the bound proved above we obtain the inequality [formula], i.e. [formula]. Using the first statement of Lemma 4, this yields ω(n)  ≤  4, thus n < 1156, but for n < 10000 the Theorem is already proven. In the same way we exclude the case d = 2. Now assume d > 2. Then by Lemma 4, statement 3, we find some a relatively prime to d with [formula]. Let p be an integer relatively prime to n which also satisfies [formula]. Note that the right hand side exists, since (e,d) = 1. Write p = kd  +  a'. Then we have

[formula]

where θ is some real number of absolute value < 1. But pt mod n is [formula], thus either the right hand side is [formula], which yields

[formula]

or the right hand side is negative, which yields

[formula]

From now on, we will only consider the first inequality, because the second one can be dealt with similarly, but gives a little stronger bounds. By the choice of a we have a / d  ≤  5 / 12, thus we get [formula]. By Lemma 4, statement 2, p can be chosen to be ≤  d(g(n) + 1). Thus we obtain the inequality [formula]. Since [formula], we finally conclude [formula]. The bound g(n) < 2ω(n) shows that this is only possible for ω(n)  ≤  9. Now the improved bound g(n)  ≤  ω(n)2 lowers the bound to 7, and we can use the fifth statement from Lemma 4 to conclude n < (24  ·  27)2, thus ω(n)  ≤  6 and n < (24  ·  23)2 = 304704.

Assume that p is some prime number, such that the least positive residue of ep mod d is in the interval

[formula]