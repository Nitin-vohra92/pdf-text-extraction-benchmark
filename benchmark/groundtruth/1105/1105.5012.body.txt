Spectral super-resolution in metamaterial composites

Introduction

This paper links themes evoked in two classic papers, one in mathematics [\cite=kac] and the other in physics [\cite=pendry2000]. The first of these poses the question as to whether the spectral content of the radiation from a body can reveal its shape. The second shows that the use of negatively-refracting metamaterials in a plane slab can lead to a super-resolving perfect lens, also known as a superlens. We will consider a two-dimensional composite material, composed of polygonal inclusions made of a metamaterial (by which we mean an artificial material with a dielectric contant which has a negative real part and a very small imaginary part) and placed in a positive dielectric matrix material. We will show that, in the spirit of Pendry, the metamaterial makes possible resolution of an important structural feature of the inclusions, irrespective of how much smaller than the wavelength they are. We will also show that, in the spirit of Kac, this feature relates to the shape of the inclusion, being in fact the corner angle of the polygon, and that it is deduced from spectral measurements on the composite. The fact that a spectral feature could be determined by corner shape, independent of (say) the area fraction of inclusions, was first suggested by Hetherington and Thorpe [\cite=handth], on the basis of an elegant argument and numerical evidence for dilute composites.

We will base our demonstration firstly on analytic results relating to the spectrum of the effective dielectric permittivity function εeff of the composite material, and secondly on remarkably accurate numerical results for this spectrum obtained using a new technique. Note here that we are using the word "spectrum" in two related, but slightly different senses. In the previous paragraph, its usage meant that the absorption of electromagnetic waves by the composite was being determined as a function of wavelength, ranging over an appropriately-wide band. In the first sentence of this paragraph we referred to the distribution of singularities of the function εeff, giving the effective permittivity of a composite having a specified geometry as a function of the ratio σ  =  ε1  /  ε2 of the permittivities of inclusions and matrix. The relation between these usages is that, as wavelength varies so does the ratio σ, so that measurements of (say) optical absorption by a composite over a suitable wavelength interval can reveal details of the singularities of the function εeff.

The numerical results for the singularity spectrum of εeff reveal that it has a continuous part which runs between upper and lower limits of σ which do not vary at all with the area fraction of the inclusions. It is complemented by a discrete spectrum of poles which does evolve with area fraction. This evolution is in fact necessary, since the continuous spectrum for touching square inclusions in a checkerboard arrangement occupies the entire negative real axis of σ, but for non-touching square inclusions is confined to the interval - 3  ≤  σ  ≤   - 1 / 3. The animations we give show how this transformation is achieved: the discrete spectrum becomes more and more dense as the touching configuration is approached, to supply the required spectral extension, as anticipated by one of the authors [\cite=miltbook].

The results we give here are interesting in the insights they give into the connection between metamaterials and super-resolution. They are also important in furthering our understanding of the connection between inclusion shape, geometrical arrangement and spectral properties of the effective permittivity function. This connection helps in the design of structures having enhanced absorption over a wide wavelength range for applications in photothermal or photovoltaic captors [\cite=mcpandp80] [\cite=pendry2010a] [\cite=pendry2010b] [\cite=pendry2010c], or offering strongly enhanced local fields for applications like sensing or nonlinear optical elements.

We give a brief overview in Section [\ref=sec:over] of some of the important properties of the function εeff(σ), including analytic results relating to the continuous part of the spectrum and some numerical investigations of both the discrete and continuous parts of the spectrum. In Section [\ref=sec:numer], we describe the method which enables accurate calculation of the spectrum of εeff, and give numerical results illustrating its convergence, even on the negative real axis of σ. In section [\ref=sec:anim], we discuss the animations which are given in the Supplementary Material to this paper, and the physical consequences of the behaviour they show. We give a discussion and concluding remarks in Section [\ref=sec:disc].

Properties of the effective permittivity function for composites

We will now give a concise review of what is known about the properties of the effective dielectric permittivity function εeff, for composites made of two materials with dielectric permittivities ε1 and ε2, with the former corresponding to a disconnected inclusion phase and the latter to a continuous matrix phase. We assume the geometry has cubic symmetry (in three dimensions) or square symmetry (in two dimensions) so that εeff is scalar valued, i.e. the effective dielectric tensor equals εeffI. This review builds on that given in Perrins and McPhedran [\cite=perrmcp2010].

The calculation of εeff for a given geometry is homogeneous of degree 1 in the variables ε1 and ε2, so we can rescale to make εeff a function of a single complex variable, the permittivity ratio σ  =  ε1  /  ε2:

[formula]

From now on we let εeff be an abbreviated notation for the effective dielectric permittivity function εeff(ε1,ε2) and we let εeff(σ) denote its scaled counterpart, the effective relative dielectric permittivity function, as defined via ([\ref=eq1]).

To determine εeff(σ) for a given geometry, we need to solve an electrostatic transport problem repeatedly for various σ. More precisely, we need to solve Laplace's equation for the potential V on a periodic domain with a periodic electric field [formula] having a prescribed average value, and boundary conditions of continuity of V and its normal flux ε∂V∂n at interfaces between materials. The theory of the function εeff(σ) becomes particularly elegant when we deal with two-dimensional problems, in which V = V(x,y) becomes a function in the plane. We may then apply the apparatus of complex-variable theory to the calculation of V, and thus to εeff(σ). For the case of a doubly-periodic array of inclusions C with unit cell U, and square symmetry, the effective permittivity may be defined as [\cite=berg78]

[formula]

where the integral in the numerator includes contributions E1 from the inclusion region and E2 from the matrix region. Except for occasional comments on effective permittivity in three-dimensions, we will concentrate on two dimensions, which corresponds to arrays of cylinders of arbitrary cross-section, with the average field aligned in the (x,y) plane. The area fractions of the two phases will be denoted p1 and p2.

Since the geometry has square symmetry, Keller's Theorem [\cite=keller] gives

[formula]

This equation then pairs zeros of εeff(σ) at values σ0 with poles at values σp = 1 / σ0. Of course, from ([\ref=eq2]), zeros of εeff(σ) require that the contributions E1 and E2 add up to zero. Since, with ε2 = 1, E2 is real and positive, this means E1 must be real and negative, and so ε2  =  σ must be real and negative at any zero of εeff(σ), and thus at any pole as well. Bergman [\cite=berg78] proved this property for both two-dimensional and three-dimensional composites. Bergman also recognized that even though the transport problem when the average electric field [formula] is prescribed does not have a solution at a pole, it should have a solution at a pole when instead the average displacement field [formula] is prescribed. Milton [\cite=milt79] proved that for the value σ =  - 1 the electrostatic problem of an array of circular cylinders, with either a prescribed value of the average electric field [formula] or a prescribed average value of the displacement field [formula], does not have a solution, compare with the discussion of ([\ref=eq:int1]) below. This suggests that σ =  - 1 is either an essential singularity or lies on a branch-cut of the function εeff(σ) for arrays of circular cylinders.

The fact that branch-cuts cannot be in the upper or lower half-planes, but must lie exactly on the negative real axis of σ was proved by one of the authors [\cite=milt1981a], using the relationship between composite materials and resistor networks. A rigorous justification of the spectral representation for εeff(σ) was given by Golden and Papanicolaou [\cite=goldpapa]. In general the function εeff(σ) has the representation

[formula]

where a1 and the spectral measure dμ(τ) are non-negative. The support of dμ(τ) is the spectrum. The spectral measure can be recovered from the values that the imaginary part of εeff(σ) takes near the negative real σ-axis since the integral of any smooth test function g(τ) with respect to the measure dμ(τ) is given by

[formula]

The discrete spectrum of εeff(σ) is readily exhibited numerically. This has been done for arrays of spheres by Bergman [\cite=berg79] and for arrays of circular cylinders by McPhedran and McKenzie [\cite=mandm80], with both studies showing that the poles and zeros of εeff(σ) converge to an essential singularity at σ =  - 1.

We focus now on what can be said about the continuous spectrum of εeff(σ). One simple geometry for which a result is immediately apparent is the checkerboard, for which Dykhne [\cite=dykhne] obtained from Keller's theorem ([\ref=eq2]) the exact result

[formula]

This then exhibits a branch cut along the entire negative real axis of σ.

An exact result can also be obtained for the polarizability α of a pair of touching cylinders [\cite=mcpandp80]. Using an inversion of coordinates about the contact point, the touching cylinders may be transformed into a slab of matrix material with permittivity ε2 = 1 surrounded by two half-planes filled with material with permittivity ε1  =  σ. Introducing the parameter

[formula]

it is easy to show using the method of images that the polarizability for a pair of touching cylinders of radius a for the case of the applied field parallel to the line connecting cylinder centres is

[formula]

We see that the series in ([\ref=dilog1]) converges provided |λ| < 1, i.e. for real σ, σ > 0. However, we can obtain a meaningful result even when this is not the case by the technique of analytic continuation, since the series in ([\ref=dilog1]) is a known transcendental function, called the dilogarithm, and denoted Li2. Thus, we can replace ([\ref=dilog1]) by

[formula]

The properties of the dilogarithm function are that it has a branch cut running from λ = 1 to λ  =    ∞  , across which the discontinuity in the imaginary part of Li2(λ) is 2π log [null]. The branch cut in the plane of relative permittivity runs from σ =  -   ∞   to σ =  - 1. If the direction of the applied field is perpendicular to the line of centres, the branch cut runs from σ =  - 1 to σ = 0.

We next consider arrays of square inclusions, for which we have already mentioned the Dykhne result ([\ref=dyk]). A generalization of this for an array in which the square unit cell was divided into four equal squares with dielectric permittivities ε1, ε2, ε3, and ε4, was conjectured by Mortola and Steffé [\cite=mortstef85]:

[formula]

This conjecture was proved independently by Milton [\cite=milt01] and Craster and Obnosov [\cite=crastob2001].

We will consider a particular sub-case of this result, due to Obnosov [\cite=obnos]: an array of square cylinders with area fractions p1 = 0.25 and p2 = 0.75, for which ([\ref=eq3a]) gives

[formula]

This formula yields a spectrum consisting solely of a branch-cut running from σ =  - 3 to σ =  - 1 / 3. We compare the result given by this formula for the real part of εeff(σ) with the result of a numerical mode matching procedure in Fig. [\ref=fig1]. This comparison reveals the difficulty of evincing details of the spectrum using numerical methods: the mode matching technique approximates the branch cut by a discrete set of poles, which becomes more dense as the number of modes increases. However, it is difficult to distinguish between branch cuts and sets of poles concentrating around an essential singularity by such methods. Furthermore, the mode matching method failed to give clear indications of the spectrum for area fractions of cylinders distinct from p1 = 0.25.

The behaviour of fields near corners of inclusions in a matrix of differing dielectric permittivity and magnetic permeability was treated in electromagnetism by J. Meixner [\cite=meixner]. As well as obtaining the exponents which characterize the singularity of the field components near the edge, Meixner pointed out that exactly the same formulae could be applied in electrostatics and magnetostatics. Hetherington and Thorpe [\cite=handth] analysed the behaviour of fields near corners in electrostatics and magnetostatics, apparently without knowledge of Meixner's paper. They however pointed out the link between field behaviour near corners and the nature of the singularity spectrum in composites containing inclusions with corners. Let us suppose that the electrostatic potential varies with distance r from a corner with an included angle 2ψ as rβ, and that the permittivity ratio inside the inclusion to that outside is σ. Then [\cite=meixner] [\cite=handth] β is found by solving a transcendental equation:

[formula]

or the same equation with σ replaced by 1 / σ. For σ real, the solution β of ([\ref=transeq]) is either pure real or pure imaginary.

To clarify the behaviour of fields, consider the case of ψ  =  π / 4, corresponding to a [formula] corner. Then ([\ref=transeq]) gives

[formula]

From this, we see that the right-hand side exceeds one in magnitude for σ lying between - 3 and - 1 / 3, and that β is then pure imaginary, corresponding to a solution for the potential which oscillates with r, and the oscillations become ever more rapid as r tends to zero. The electric field is given by the spatial derivative of the potential, and it diverges like 1 / r multiplied by the oscillating term as r  →  0. The branch cut region here is that where β is imaginary, i.e., between σ =  - 3 and σ =  - 1 / 3. Hetherington and Thorpe [\cite=handth] postulate that for an m sided regular polygon, there will be a branch cut running between σ = (2 + m) / (2 - m) and σ = (2 - m) / (2 + m). They made this assertion after recognizing that in this interval of σ the surface charge (rather that just the surface charge density) near the corner is infinite, which is unphysical.

Another argument for the position of this branch cut was put forward by one of the authors [\cite=miltbook]. In order that εeff have a significant imaginary part when ε has a very small imaginary part we see from ([\ref=epsdef]) that the electric field [formula] must be close to losing its square integrability. From the asymptotic form of V near the corner one finds that this happens when the imaginary part of σ is very small and real part of σ is between (2 + m) / (2 - m) and (2 - m) / (2 + m). To elucidate this further for the case of a [formula] corner we solve ([\ref=squcorn]) with β  =  β' + iβ'' and σ  =  σ' + iσ'' where β',β'',σ' and σ'' are real, - 3 < σ' <  - 1 / 3, and σ'' and β' are both very small and positive. This gives

[formula]

Using polar coordinates (r,θ) near the corner, the potential V scales as rβ as r  →  0, and so [formula] will be close to r2β' - 2|g(θ,σ')|2 for some function g(θ,σ'). It follows that with ε1  =  σ and ε2 = 1 the imaginary part of E1 (which is a measure of the power dissipation in the composite) has a contribution near the corner from inside the radius r = r0 of

[formula]

where the integral over θ is only over those angles in the inclusion. Thus, provided g(θ,σ') is non-zero, the contribution of the corner to the imaginary part of E1 remains non-zero even in the limit σ''  →  0 (and goes to zero when σ' <  - 3 or σ' >  - 1 / 3 since then σ'' / β'  →  0).

A corner is not the only geometric feature which can act as a significant energy absorber when the imaginary part of the dielectric constant goes to zero. The center of a sphere with a dielectric constant λ1 in the radial direction and dielectric constant λ2 in the tangential direction acts as an absorber when λ2  /  λ1 approaches real values less than - 1 / 8: see figure 4 in the paper of Qui and Luk’yanchuk [\cite=quiluk] (which shows that this energy absorbing feature extends beyond the quasistatic limit) and see also the related discussion on page 239 of [\cite=miltbook] (where there is an error as the limit δ  →   - 1 / 2 should have been taken rather than the limit δ  →  0).

Numerical method

We now describe a numerical method stable and accurate enough to verify the conjecture of Hetherington and Thorpe for the case m = 4, and to show the spectral evolution as a function of area fraction for composites with square inclusions.

Laplace's equation is to be solved on a doubly periodic domain C. The boundary conditions on the positively oriented interface Γ between the inclusion phase and the matrix phase are given in Section [\ref=sec:over]. An average electric field E0 of unit strength is applied. The permittivity of the matrix phase is set to ε2 = 1 so that the effective permittivity is equal to the effective relative permittivity. From the repeated solution to this problem for various ε1  =  σ we obtain εeff(σ). Two types of domains are investigated: the "square array of square cylinders" and the "staggered array of square cylinders" (a square array of cylinders with diamond-shaped cross-sections, as studied for example in [\cite=miltmcpedmcken] [\cite=Hels00]), see Fig. [\ref=fig:boards].

Boundary value problems on domains involving sharp corners may require extreme resolution close to corner vertices, even when the demands for overall accuracy are moderate. One has to be selective with the choice of numerical method. We chose an integral equation based scheme. Such schemes have the advantage that they can retain stability also in very difficult situations.

Our particular choice of integral equation is standard - a single-layer equation [\cite=Gree06]. For its solution we use a novel numerical method called recursive compressed inverse preconditioning. Conceptually this is a local multilevel technique which makes a change of basis and expresses the non-smooth solution to the single-layer equation in terms of a piecewise smooth transformed layer density which can be cheaply resolved by polynomials. Discretization leads to a block diagonal transformation matrix [formula] (an inverse preconditioner) where the columns of a particular block can be interpreted as special basis functions for the original density in the vicinity of a corner vertex multiplied with suitable quadrature weights. The blocks of [formula] are constructed in a fast recursion, [formula], where step i inverts and compresses contributions to [formula] involving the outermost quadrature panels on level i of a locally n-ply refined mesh. We emphasize that the method is strictly numerical and fully automatic. There is no separation of variables or eigenvalue analysis involved.

The recursive compressed inverse preconditioning method was originally described in Ref. [\cite=Hels08] and further developed in Refs. [\cite=Hels09a] [\cite=Hels09b] [\cite=Hels11a]. [\ref=sec:AppA] below highlights some of the method's features, relevant to the domain C. A fuller description will be included in a forthcoming paper [\cite=Hels11b].

Achievable accuracy

We first compute εeff(σ) for the square array of squares at p1 = 0.25 in the limit of σ approaching the negative real axis from the upper half-plane [formula], as in the example of Fig. 1. The exact result ([\ref=eq4]) is used as a benchmark. Fig. [\ref=fig:sqsq25] shows that the relative error is close to machine epsilon (the upper bound due to rounding in floating point arithmetic) except for in a neighbourhood of three points where it is higher: the ends of the branch cuts at σ =  - 3 and σ =  - 1 / 3, and at the singularity of the integral equation at σ =  - 1. This demonstrates that the problem of computing εeff(σ) for arrays of square cylinders is well conditioned in general and that our scheme is stable.

The staggered array of square cylinders at p1 = 0.49999999995 is a more challenging geometry than the square array of square cylinders at p1 = 0.25:

there are more length scales involved,

εeff(σ) varies more rapidly and has more poles and zeros,

there is no exact result to compare with.

The first problem is the least difficult. The multilevel property of our numerical method should enable the resolution of almost arbitrarily small separation distances between corner vertices. The second problem is more severe. For εeff(σ) close to zero, one can expect cancellation in ([\ref=eq:eff1]) and the relative accuracy should suffer. Furthermore, it is harder to resolve wildly varying functions in floating point arithmetic than slowly varying ones. The third problem is solved by using the extent to which ([\ref=eq2]) is satisfied as an indicator of the relative error. For this, since σ and 1 / σ lie on different sides of the real axis and our numerical method takes limits from [formula], we use ([\ref=eq2]) in the equivalent form

[formula]

where the '[formula]' symbol to denotes complex conjugation. Fig. [\ref=fig:stsqE] suggests that despite the difficulties, typically, only a few digits are lost compared to the square array at p1 = 0.25. The numerics seem to give a relative precision of at least 10- 8 even for the most extreme values of εeff(σ).

For the interpretation of various limits it might also be of interest to study εeff(σ) for σ some finite distance into [formula]. Fig. [\ref=fig:stsqI] shows again the staggered array of square cylinders at p1 = 0.49999999995, but unlike in Fig. [\ref=fig:stsqE] we have here interrupted the limit process at σ a relative distance of 10- 5 away from the real axis.

Animations of Spectral Evolution

This section discusses the evolution of the variation of εeff(σ) with permittivity ratio σ for the square array of square cylinders and the staggered array of square cylinders as the area fraction of squares, p1, varies. The discussion relates to two animations, called Animation 1 and Animation 2, which can be viewed at http://www.maths.lth.se/na/staff/helsing/animations.html. To facilitate viewing, each animation is available in four versions, denoted A, B, C, and D. The versions have the same content, but differ in image format and pixel resolution.

We first consider the evolution of the variation of εeff(σ) as p1 in the square array ranges from zero to unity. This evolution is shown in Animation 1, from which a typical frame is given in Fig. [\ref=fig4-1]. The most important feature of Animation 1 is quite clear: for σ real, and for all values of p1, and except at the poles, non-zero values of [formula] are confined to the interval - 3  ≤  σ  ≤   - 1 / 3, in accord with the suggestion of Hetherington and Thorpe [\cite=handth]. Of course, the value of this imaginary part is always positive, if we restrict ourselves to composites without gain (for which the imaginary part would be always negative).

Below the area fraction of 0.25, the real part of εeff(σ) is positive, and it develops its first pole at this area fraction. It is interesting to compare frames from Animation 1 and the left image of Fig. [\ref=fig:sqsq25] with Fig. [\ref=fig1]; the results of the mode-matching method clearly correspond to those of the new method, but are capable of a resolution limited by the number of terms employed in field expansions.

For p1 > 0.25, the real part is negative between σ =  - 3 and σ =  - 1 / 3, while the pole migrates to more negative values of σ. For area fractions near p1 = 0.75 (see Fig. [\ref=fig4-1]), "features" which we call quasipoles develop from near σ =  - 1, and one moves towards σ =  - 3, while the other moves towards σ =  - 1 / 3. When they reach these values, and then are not muted by the absorbing nature of the corners, they transform into actual poles, which move towards σ =  -   ∞   and σ = 0 respectively. At higher values of area fraction, more quasipoles evolve from σ =  - 1 and give rise to additional actual poles when they emerge from the branch-cut region. [formula] becomes small as p1  →  1, while [formula] tends towards σ, apart from the increasingly numerous but increasingly narrow pole regions.

For the staggered array of square prisms, Animation 2 illustrates the behaviour of εeff(σ) as a function of σ for area fractions ranging from zero to 0.5 (with the behaviour for p1 in the range 0.5 to 1.0 following from that in the lower range using Keller's Theorem ([\ref=eq2]). As has been commented in Section [\ref=sec:over], the interesting question is how the branch-cut location (from σ =  -   ∞   to σ = 0) for p1 = 1 / 2 of equation ([\ref=dyk]) can be reconciled with that (from σ =  - 3 to σ =  - 1 / 3) predicted by Hetherington and Thorpe [\cite=handth] for p1 arbitrarily near 1 / 2. A mechanism for this reconciliation was provided by one of the present authors [\cite=miltbook]: discrete sets of poles in -    ∞    ≤  σ  ≤   - 3 and [formula] were predicted to become denser and denser as p1 approached 1 / 2, thus extending the branch cut in the limit to that required by ([\ref=dyk]). The accuracy of this prediction is evident in Animation 2: poles develop from the quasipoles generated at σ =  - 1, and move left and right into the embryonic branch-cut regions -    ∞    ≤  σ  ≤   - 3 and [formula]. The left frame in Fig. 4 shows a stage in this evolution where p1 is very close to 1 / 2. Animation 2 makes the "nursery role" of the region around σ =  - 1 in the development of the spectrum much more evident (due to larger amplitudes of the quasipoles) than does Animation 1.

The sensitivity of the spectral details for the staggered array near the checkerboard configuration are very evident in Animation 2. As we have commented in Section [\ref=sec:over], the asymptotics of fields near corners are the same in electromagnetism as in electrostatics [\cite=meixner]. Thus, attempts such as that in [\cite=pbeamsplitter] to model the transition from electromagnetically reflecting structures to electromagnetically transmitting structures as p1 moves through 1/2 would require an adaptive and recursive method like that described in Section [\ref=sec:numer] to be able to achieve sufficient accuracy.

Discussion and Conclusions

In this paper we have brought together rigorous mathematical results with numerical investigations of unprecedented accuracy. The latter have revealed the generality of the former, and have substantiated a conjecture of Hetherington and Thorpe [\cite=handth] in a striking and conclusive way.

We conclude by commenting further on how the arguments and results we have presented can be implemented in a practical demonstration of morphological super-resolution, uniting the ideas of Kac [\cite=kac] and Pendry [\cite=pendry2000]. Such a demonstration would require the fabrication of a set of parallel cylinders with a square cross section (or polygonal cross section). The cylinders do not have to be arranged in a geometrically-perfect array, and they do not have to be densely packed. They have to be made of a material which is essentially non-absorbing and with a negative permittivity or permeability.

These requirements suggest the set of cylinders be made of metal, of size 10 μm or larger, and be probed with wavelengths far greater than the cylinder size in the far infrared or longer. Such cylinders are large by today's lithographic standards, and so it should be possible to accurately form their corners to achieve sub-wavelength accuracy. Going into the far infrared region diminishes metallic loss from its value in the visible and near-infrared [\cite=bandw]. It is crucial that the metallic loss be very low, since the experimental signature we suggest be probed is enhanced absorption by a set of such cylinders over a wavelength interval in which the metal's permittivity ranges from say -1/3 to -3 (scaled relative to the permittivity of a host dielectric in which the cylinders are embedded). Note that the enhanced absorption of incident radiation detected will increase as more lines of cylinders are added to the set.

The experimental result which would indicate morphological super-resolution is an enhanced absorption for wavelengths far in excess of the cylinder size, switching on and off at geometrically-determined limits described above, independent of the arrangement and area fraction of the cylinders. We stress however that such a demonstration would indicate the physical relevance of the ideas we have described for a particular system. The mathematical results we have described are of course rigorous, and the numerical examples of them we have given are highly accurate, so our demonstration of super-resolution for wavelengths arbitrarily larger than the size of the particles probed does not rely for its validity on experimental support. They may be applicable to governing equations other than the Helmholtz equation, for which the ideas of metamaterials and their applications are currently being explored [\cite=seb].

Ross McPhedran acknowledges support from the Australian Research Council's Discovery Projects and Centre of Excellence Schemes. Graeme Milton acknowledges support from the National Science Foundation through grant DMS-0707978.

Key features of the numerical method

To keep the notation short we make no distinction between points or vectors in a real plane [formula] and points in a complex plane [formula]. All points will be denoted z or τ.

The integral equation

The potential function V(z) in C is represented as a sum of a driving term and a single-layer potential with density ρ(z) [\cite=Gree94]. Enforcement of the boundary conditions on Γ leads to the Fredholm second kind integral equation

[formula]

Here nz is the outward unit normal of Γ at z, Γ0 denotes the restriction of Γ to U, and λ is as in ([\ref=eq:lmb]). Note that, as σ  →   - 1 we have λ  →    ±    ∞   and ([\ref=eq:int1]) is no longer a second kind equation, but a first kind equation whose (unique) solvability is by no means guaranteed. Therefore one can say that σ =  - 1 is a singularity of ([\ref=eq:int1]).

Once ([\ref=eq:int1]) is solved for ρ(z) and under the assumption that the inclusions do not overlap the unit cell boundary, the effective relative permittivity in the direction of the applied electric field can be computed from

[formula]

Depending on how the unit cell is chosen, the squares in the staggered array may overlap the unit cell boundary. With the choice in Fig. [\ref=fig:boards], they certainly do. But since ρ(z) is a periodic function and identical on all squares one can circumvent this problem by modifying ([\ref=eq:eff1]) so that it integrates ρ(z) twice on the square at the center of the unit cell and ignores ρ(z) on the other squares.

Discretization

We discretize ([\ref=eq:int1]) and ([\ref=eq:eff1]) using a Nyström method based on composite 16-point polynomial interpolatory quadrature and a parametrization z(t) of Γ. The parameter t is real. See Ref. [\cite=Atki97] for a review of Nyström methods including error analysis.

An initial coarse mesh that resolves the kernel of the integral operator in ([\ref=eq:int1]) away from the corner vertices is constructed on Γ, see Fig. [\ref=fig:boards]. The coarse mesh is refined by subdividing those panels that neighbour corner vertices. The subdivision is done n times in a direction towards the vertices. On quadrature panels which neighbour corner vertices we choose quadrature nodes according to the zeros of certain Jacobi polynomials. On remaining panels we choose quadrature nodes according to the zeros of Legendre polynomials. Upon discretization on the refined mesh ([\ref=eq:int1]) assumes the form

[formula]

where [formula] and [formula] are square matrices and [formula] and [formula] are column vectors. The vector [formula] corresponds to the discretization of the piecewise smooth right hand side.

Now the kernel K(τ,z) of the integral operator in ([\ref=eq:int1]) is split into two functions

[formula]

where [formula] takes care of corner interaction and [formula] can be viewed as the kernel of a compact integral operator. The kernel split ([\ref=eq:split]) corresponds to an operator split and the change of variables

[formula]

makes ([\ref=eq:gen1]) read

[formula]

This right-preconditioned equation corresponds to the discretization of a Fredholm second kind equation with compact operators. The solution fine is the discretization of a piecewise smooth function.

Compression

The matrix [formula], the density fine, and the right hand side [formula] in ([\ref=eq:gen2]) can be evaluated on the coarse mesh without the loss of precision. Only [formula] needs the refined mesh for its accurate evaluation. This enables a compression of ([\ref=eq:gen2]). We introduce the compressed weighted inverse

[formula]

Here [formula] is an unweighted prolongation operator that performs panelwise 15th-degree polynomial interpolation in the parameter t (which as we recall parameterizes Γ through z(t)) from points on the coarse mesh to points on the fine mesh when acting on column vectors from the left. [formula] is a weighted prolongation operator. See Section 5 of Ref. [\cite=Hels09b].

Substitution of ([\ref=eq:R0]) into ([\ref=eq:gen2]) and the use of some relations between prolongation operators make ([\ref=eq:gen2]) assume the form

[formula]

This equation, defined solely on the coarse mesh, will be used in our computations.

Fast recursion for [formula]

The construction of [formula] from its definition ([\ref=eq:R0]) may be a costly and unstable operation when the refined mesh has many panels. The number of subdivisions n needed to reach a given accuracy may grow without bounds due to the singularities in ρ(z) that arise as σ approaches certain values.

Fortunately, the construction of each block of [formula], associated with a corner of the square array or with a corner-meet of the staggered array, can be greatly sped up and also stabilized via a recursion. This recursion uses matrices [formula] on local meshes centered around corners or corner-meets. It would be going too far to describe all the fine details of this procedure, but Sections 3.2 and 3.3 of Ref. [\cite=Hels11a] give a fairly good idea of how the recursion is set up in the present context. A key step is the (partial) conversion of the recursion into a non-linear matrix equation. This equation is solved using a variant of Newton's method relying on numerical homotopy to approach purely negative σ from the upper half-plane [formula]. The ratio σ, which enters into [formula], is initially multiplied with a constant q = 1 - 0.01i. The imaginary part of q is reduced with a factor of ten after each of the first 14 Newton iterations. Then q is set to unity and the iterations are continued until either a sharp convergence criterion is met or a total of 30 iterations is reached. A full description is given in Ref. [\cite=Hels11b].

References