How common are Earth-Moon planetary systems?

Introduction

The evolution and survival of life on a terrestrial planet requires several conditions. A planet orbiting the central star in its habitable zone provides the temperature suitable for the existence of liquid water on the surface of the planet. In addition, a stable climate on timescales of more than a billion years may be essential to guarantee a suitable environment for life, particularly land-based life. Global climate is mostly influenced by the distribution of solar insolation [\citep=Milan41] [\citep=Berger84] [\citep=Berger89] [\citep=Atobe06]. The annual-averaged insolation on the surface at a given latitude is, beside the distance to the star, strongly related to the tilt of the rotation axis of the planet relative to the normal of its orbit around the star, the obliquity. If the obliquity is close to [formula], the poles become very cold due to negligible insolation and the direction of the heat flow is poleward. With increasing obliquity, the poles get more and more insolation during half of a year while the equatorial region becomes colder twice a year. If the obliquity is larger than [formula], the poles get more annual insolation than the equator and the heat flow changes. Therefore, the equatorial region can even be covered by seasonal ice [\citep=Ward00]. Thus, the obliquity has a strong influence on a planet's climate. The long-term evolution of the Earth's obliquity and the obliquity of the other terrestrial planets in the solar system, or planets in general, is controlled by spin-orbit resonances and the tidal dissipation due to the host star and satellites of the planet. Thus, the evolution of the planetary obliquity is unique for each planet.

Earth's obliquity fluctuates currently [formula] around [formula] with a period of [formula] years [\citep=Laskar93a] [\citep=Laskar96]. The existence of a massive (or close) satellite results in a higher precession frequency which avoids a spin-orbit resonance. Without the Moon, the obliquity of the Earth would suffer very large chaotic variations. The other terrestrial planets in the solar system have no massive satellites. Venus has a retrograde spin direction, whereas a possibly initial more prograde spin may have been influenced strongly by spin-orbit resonances and tidal effects [\citep=Goldreich70] [\citep=Laskar96]. Mars' obliquity oscillates [formula] degree around [formula] with a period of several 100,000 years [\citep=Ward74] [\citep=Ward91]. Mercury on the other hand is so close to the sun that its rotation period is in an exact 3:2 resonance with its orbital period. Mercury's spin axis is aligned with its orbit normal.

On larger timescales, the variation of the obliquity can be even more dramatic. It has been shown that the tilt of Mars' rotation axis ranges from [formula] to [formula] in less than 50 million years and [formula] to [formula] in the case of the obliquity of an Earth without the Moon [\citep=Laskar93a] [\citep=Laskar96].

The main purpose of this report is to explore the giant impact history of the planets in order to calculate the probability of having a giant Moon-like satellite companion, based on simulations done by [\citet=Morishima10]. A giant impact between a planetary embryo called Theia, the Greek titan that gave birth to the Moon goddess Selene, first named by [\citet=Halliday00], and the proto-Earth is the accepted model for the origin of our Moon [\citep=Hartmann75] [\citep=Cameron76] [\citep=Cameron91], an event which took place within about 100  Myr after the formation of calcium aluminum-rich inclusions in chondritic meteoroids, the oldest dated material in the solar system [\citep=Touboul07]. After its formation, the Moon was much closer and the Earth was rotating more rapidly. The large initial tidal forces created high tidal waves several times per day, possibly promoting the cyclic replication of early bio-molecules [\citep=Lathe04] and profoundly affecting the early evolution of life. Tidal energy dissipation has caused the Moon to slowly drift into its current position, but its exact orbital evolution is still part of an on-going debate [\citep=Varga06] [\citep=Lathe06]. Calculating the probability of life in the Universe [\citep=Ward00] as well as the search for life around nearby planets may take into account the likelihood of having a massive companion satellite.

This report is structured as follows: In section [\ref=sec:planetformation], we give a brief review on the evolution of simulating terrestrial planet formation with N-body codes during the last decades and present the method we used. In section [\ref=sec:satelliteformation], we study the different parameters of a protoplanet collision to identify potential satellite forming events. In section [\ref=sec:uncertainties], we summarize the different uncertainties from the simulations and our analysis that may affect the final results. Finally, we give a conclusion, we present our results and compare them with previous works in section [\ref=sec:results].

Simulating terrestrial planet formation

There are good observational data on extra-solar gas giant planets, but whilst statistics on extra-solar rocky planets will be gathered in the coming years, for constraints on the formation of the terrestrial planets we rely on our own solar system. The established scenario for the formation of the Earth and other rocky planets is that most of their masses were built up through the gravitational collisions and interactions of smaller bodies [\citep=Chamberlin05] [\citep=Safranov69] [\citep=Lissauer93]. [\citet=Wetherill89] observed the phase of run-away growth. This phase is characterized by the rapid growth of the largest bodies. While their mass increases, their gravitational cross section increases due to gravitational focusing. When a body reaches a certain mass, the velocities of close planetesimals are enhanced, the gravitational focusing decreases and so does the accretion efficiency. This is called the oligarchic growth phase, first described by [\citep=Kokubo98]. During this phase, the smaller embryos will grow faster than the larger ones. At the end, several bodies of comparable size are embedded in a planetesimal disk. These protoplanets merge via giant impacts to form the final planets. [\citet=Dones93] showed that most of a terrestrial planet's prograde spin is imparted by the last major impactor and can not be accumulated via the ordered accretion of small planetesimals. Giant impacts with a certain impact angle and velocity generate a disk of ejected material around the target which is a preliminary step in the formation of a satellite. Usually, the simulations assume perfect accretion in a collision. Tables of the collision outcome can help to improve the simulations or to estimate the errors in the planetary spin, [\citep=Kokubo10]. Until recently simulations were limited in the number of planetesimal bodies that could be self-consistently followed for time spans of up to billions of years, but recent algorithmic improvements by [\citet=Duncan98] in his SyMBA code and by [\citet=Chambers99] in his Mercury code have allowed them to follow over long time spans a relatively large number of bodies (O(1000)) with high precision, particularly during close encounters and mergers between the bodies, where individual orbits must be carefully integrated [\citep=Chambers98] [\citep=Agnor99] [\citep=Raymond04] [\citep=Kokubo06]. [\citet=Raymond09] have also recently conducted a series of simulations where they varied the initial conditions for the gas giant planets and also track the accretion of volatile-rich bodies from the outer asteroid belt, leading either to "dust bowl" terrestrial planets or "water worlds" and everything between these extremes. All prior simulation methods with full interaction among all particles have however been limited in number of particles since their force calculations scale as O(N2).

We have developed a new parallel gravity code that can follow the collisional growth of planetesimals and the subsequent long-term evolution and stability of the resulting planetary system. The simulation code is based on an O(N) fast multipole method to calculate the mutual gravitational interactions, while at the same time following nearby particles with a highly accurate mixed variable symplectic integrator, which is similar to the SyMBA [\citep=Duncan98] algorithm. Since this is completely integrated into the parallel code PKDGRAV2 [\citep=Stadel01], a large speed-up from parallel computation can also be achieved. We detect collisions self-consistently and also model all possible effects of gas in a laminar disk: aerodynamic gas drag, disk-planet interaction including Type-I migration, and the global disk potential which causes inward migration of secular resonances with gas dissipation. In contrast to previously mentioned studies, this code allows us to self-consistently integrate through the last two phases of planet formation with the same numerical method while using a large number of particles.

Using this new simulation code we have carried out 64 simulations which explore sensitivity to the initial conditions, including the timescale for the dissipation of the solar nebula, the initial mass and radial distribution of planetesimals and the orbits of Jupiter and Saturn [\citep=Morishima10]. All simulations start with 2000 equal-mass particles placed between 0.5 and 4  AU. The initial mass of the planetesimal disk md is 5 or [formula]. The surface density Σ of this disk and of the initial gas disk depends on the radius through [formula], where p is 1 or 2. The gas disk dissipates exponentially in time and uniformly in space with a gas dissipation time scale τgas = 1,2,3 or 5  Myr. After the disappearance of the gas disk (more precisely after time τgas from the beginning of the simulation), Jupiter and Saturn are introduced on their orbits, e.g. circular orbits or the current orbits with higher eccentricities.

Figure [\ref=fig:tree] shows two merger trees: a 1.8 [formula] planet formed in the simulation with (τgas,p,md)=(1 Myr,1,5[formula]) and gas giants on the present orbits and a 1.1 [formula] planet formed in the simulation with (τgas,p,md)=(1 Myr,2,10 [formula]) and gas giants on circular orbits. The red branches are satellite forming impactors both with a mass [formula] and represent two events of the final sample in figure [\ref=fig:masses]. These merger trees with their different morphologies reveal the variety of collision sequences in terrestrial planet formation. They show that a large set of impact histories is generated by these simulations despite the relatively narrow parameter space for the initial conditions.

Satellite formation

During the last phase of terrestrial planet formation, the giant impact phase, satellites form. Collisions between planetary embryos deposit a large amount of energy into the colliding bodies and large parts of them heat up to several 103  K, e.g. [\citet=Canup04]. Depending on the impact angle and velocity and the involved masses, hot molten material from the target and impactor can be ejected into an circumplanetary orbit. This forms a disk of ejecta, the disk material is in a partially vapor or partially molten state, around the target planet. The proto-satellite disk cools and solidifies. Solid debris form and subsequently agglomerate into a satellite [\citep=Ohtsuki93] [\citep=Canup96] [\citep=Kokubo00].

The giant impact which resulted in the Earth-Moon system is a very particular event [\citep=Cameron91] [\citep=Canup04]. The collision parameter space that describes a giant impact can by parametrized by γ = mi / mtot, the ratio of impactor mass mi to total mass in the collision mtot, by [formula], the impact velocity in units of the escape velocity [formula], where rt and ri are the radii of target and impactor. Furthermore, it is described by the scaled impact parameter b, where b = 0 indicates a head-on collision and b = 1 a grazing encounter, and the total angular momentum L. Recent numerical results [\citep=Canup08] obtained with smoothed particle hydrodynamic (SPH) simulations for the Moon-forming impact parameters require: [formula], [formula], [formula] and [formula], where LEM is the angular momentum of the present Earth-Moon system. These simulations also include the effect of the initial spins of the colliding bodies, but the explored parameter space is restricted to being close to the Moon-forming values given above.

If one does not focus on a strongly constrained system like the Earth-Moon system but just on terrestrial planets of arbitrary mass with satellites that tend to stabilize their spin axis, the parameter space is broadened. It becomes difficult to draw strict limits on the parameters because collision simulations for a wider range of impacts were not available for our study. Hence, based on published Moon-forming SPH simulations by Canup (2004, 2008), we use a semi-analytic expression to constrain the mass of a circumplanetary disk that can form a satellite. In addition, we include tidal evolution and study the ability of the satellite to stabilize the spin axis of the planet.

Satellite mass and collision parameters

We do not know the exact outcome of a protoplanet collision, but certainly the satellite mass is related to the collision parameters of the giant impact. Hence, we can draw a connection from these parameters to the mass of the final satellite. Based on the studies of the Earth's Moon formation, we can start with a simple scaling relation: a Mars-size impactor gives birth to a Moon-size satellite. Their mass ratio is mMars / mMoon  ~  10. Thus, to very first approximation, we can assume that an impactor mass is usually 10 times larger than the final mass of the satellite. Of course, this shows that only a small amount of material ends up in a satellite, but this statement is only valid for a certain combination of mass ratio, impact parameter and impact speed and usually gives an upper limit on the satellite mass.

In order to get a better estimation of the satellite mass, we use the method obtained in the appendix of [\citet=Canup08].

There, an expression is derived that describes the mass of the material that enters the orbit around the target after a giant impact:

[formula]

where the prefactor [formula] has been determined empirically from the SPH data. mpass / mtot is mass of the impactor that avoids direct collision with the target. It depends mainly on the impact parameter b and on the mass ratio γ and can be computed by studying the geometry of the collision. The total impactor volume that collides with the target is:

[formula]

with

[formula]

where ri and rt are impactor and target radius, D = b(ri + rt) gives the distance between the centers of the bodies and

[formula]

[formula]

Assuming a differentiated impactor with rcore  ~  0.5ri and repeating the above integration for this radius, the colliding volume of the impactor mantle is Vmantle = VT  -  Vcore. If we assume that the core is iron and the mantle dunite, the core density ρcore has roughly twice the density of the mantle ρmantle. The mass of the impactor that hits the target is mhit  =  ρcoreVcore  +  ρmantleVmantle. Therefore, the mass that passes the target is mpass = mi - mhit.

We use the full expression derived by [\citet=Canup08], equation ([\ref=eq:diskmass]), to estimate the disk mass resulting from the giant impacts in our simulation. Equation ([\ref=eq:diskmass]) is correct to within a factor 2, if v < 1.4 and 0.4 < b < 0.7 or if v < 1.1 and 0.4 < b < 0.8. Figure [\ref=fig:diskb] illustrates the amount of material that is transported into orbit for the parameter range 0.4 < b < 0.8 (see figure B2 in [\citet=Canup08] for more details). It shows that a small impact parameter b reduces the material ejected into orbit significantly. The same holds for a reduction of γ, because those collisions are more grazing. Based of simple arguments, we use the limits above to identify the moon forming collision in the (v,b)-plane. Details on how this assumption affects the result are given in section [\ref=sec:uncertainties].

[\citet=Ida97] and [\citet=Kokubo00] studied the formation of a moon in a circumplanetary disk through N-body simulations. They found that the final satellite mass scales linearly with the specific angular momentum of the disk. The fraction of the disk material that is finally incorporated into the satellite ranges form 10 to 55%. Thus, we assume that not more than half of the disk material is accumulated into a single satellite. The angular momentum of the disk is unknown and we can not use the more exact relationships.

Spin-orbit resonance

Spin-orbit resonance occurs when the spin precession frequency of a planet is close to one of the planet's orbital precession frequencies. It causes large variation in the obliquity [\citep=Laskar96], the angle between this spin axis and the normal of the planet's orbital plane. An obliquity stabilizing satellite increases the spin precession frequency to a non-resonant (spin-orbit) regime. To ensure this, one can set a rough limit on the system parameters [\citep=Atobe04] through

[formula]

where ms is the mass of the satellite, [formula] the mass of the central star and as the semi-major axis of the satellite's orbit and ap the semi-major axis of the planet.

If the left term of the inequality is much larger than the right one, the spin precession frequency of the planet should be high enough to ensure that it is over the upper limit of the orbital precession frequency so that spin-orbit resonance does not occur. Although this inequality is very simplified, we try to estimate the minimum mass of a satellite such that it is able to stabilize the obliquity of its planet.

The exact semi-major axis of a satellite after formation is unknown but the Roche limit is the lower bound of its semi major axis. The Roche limit aR of the planet is [\citep=Murray99]:

[formula]

where rs is the radius of the satellite and ms its mass and the mass of the planet is given by mp. [\citet=Ohtsuki93] and [\citet=Canup96] provided detailed analytic treatments of the accretion process of satellites in an impact-generated disk. Based on those studies, [\citet=Kokubo00] have shown that the true value of the radius of satellite accretion will not diverge much from the Roche radius in the case of the Earth-Moon system, a typical satellite orbit semi-major axis in their simulations was a≃1.3  aR. We used this approximation to estimate a lower bound on the satellite-planet mass ratio. We rewrite the Roche limit as

[formula]

where we used [formula] and the fact that ρp  =  ρs in our model. We insert this in equation ([\ref=eq:atobe04]) instead of as and get the condition

[formula]

Inserting a density of 2  g  cm- 2, the density of the bodies in the Morishima simulations, and planet semi-major axis of 1  AU, we get a mass ratio of   ~  10- 5, which is smaller than the minimum ratio of the smallest and largest particles in our simulations. This is a lower limit on the stabilizing satellite mass but the tidal evolution of the planet-satellite system can alter this limit dramatically.

The orbital precession frequencies of a planet depend on the neighbouring or massive planets in its system. In the case of the Earth, Venus, Jupiter and Saturn cause the most important effects. To keep the spin precession frequency high enough, a spin period below 12 h would have the same effect as the present day Moon [\citep=Laskar93a]. Hence, even without a massive satellite, obliquity stabilization is possible as long as the planet is spinning fast enough. However, the moon forming impact provides often a significant amount of angular momentum. A more sophisticated analysis including the precession frequencies of the all planets involved or formed in the simulations and a better treatment of the collisions to provide better estimates of the planetary spins would clearly be an improvement but this is out of the scope of this work.

Tidal evolution

After its formation, even a small satellite is stabilizing the planet's obliquity. Its fate is mainly controlled by the spin of the planet, the orientation of the spin axis of the planet relative to its orbit around the central star and relative to the orbital plane of the satellite and by possible spin-orbit resonance. Which satellites will continue to stabilize the obliquity as they recede from the planet? Orbital evolution is a complicated issue [\citep=Atobe06] and there is still an ongoing debate even in the case of the Earth-Moon system, as mentioned. To classify the different orbital evolutions, it is helpful to introduce the synchronous radius, at which a circular orbital period equals the rotation period of the planet. In the prograde case, a satellite outwards of the synchronous radius will recede from the planet as angular momentum is tidally transferred from the planet to the satellite and the spin frequency of the planet decreases. In this case the synchronous radius will grow till it equals the satellite orbit. Angular momentum is transferred faster if the mass of the satellite is large, since the tidal response in the planet due to the satellite is greater. Large mass satellites will quickly reach this final co-rotation radius, where their recession stops. Even though their orbital radius becomes larger, these moons are massive enough to satisfy inequality ([\ref=eq:atobe04]) and avoid spin-orbit resonances. Small satellites will recede very slowly compared to their heavy brothers and eventually fulfill the condition ([\ref=eq:atobe04]) within the host star's main sequence life time. In contrast, low mass satellites that form in situ far outside the Roche limit, should this be possible, will probably not stabilize the spin axis. Intermediate mass satellites with ms  ~  mMoon may recede fast enough so that they tend to lose their obliquity stabilizing effect during a main sequence life time. The Earth-Moon system shows that even in this intermediate mass regime, long term stability can occur, since the Moon has stabilized the Earth's obliquity for billion of years.

On the other hand, a satellite inside the synchronous orbit will start to spiral towards the planet, while its angular momentum is transferred to the planet. Soon, it is disrupted by tidal forces or will crash on the planet. How do we know if a satellite forms inside or outside the synchronous radius? The Roche limit ([\ref=eq:roche]) depends on the mass and size of the bodies while the synchronous radius rsync is a function of the planet mass mp and depends inversely proportional on its rotation frequency, which is obtained from equating the gravitational acceleration and the centripetal acceleration:

[formula]

Equating this formula with ([\ref=eq:roche]) gives:

[formula]

The planet mass drops out and we get an lower limit on the planet angular velocity to guarantee a satellite outside the Roche radius:

[formula]

which equals a rotation period of 4  h. The final planets of [\citet=Morishima10] have generally a high rotational speed, some of them rotating above break up speed. The rotation period after the moon forming collision is usually around 2-5 hours, see figure [\ref=fig:rotation]. A more exact particle growth model without the assumption of perfect sticking would lower the rotation frequency by roughly 30% [\citep=Kokubo10], where we can also include the loss of rotational angular momentum due to satellite formation (full circles). On the other hand, the mean distance of satellite formation is around 1.3  aR, and the maximum rotation period of the planet for a receding satellite changes to [formula] (dashed line). Hence, applying this to our final sample, 1/4 of all moon forming collisions are excluded.

Finally, for the remaining events, we assume that the planet spin is large enough so that the synchronous radius is initially smaller than the Roche radius. Satellites that form behind the Roche limit will start to recede from the planet. We can conclude that almost every satellite-planet system in our simulation will fulfill ([\ref=eq:atobe04]). A special outcome of the tidal evolution of a prograde planet-satellite system is described by [\citet=Atobe06]. If the initial obliquity θ of the planet after the moon forming impact is large, meaning that the angle between planet spin axis and planet orbit normal is close to [formula], results in a very rapid evolution when compared to the previously discussed case of a moon receding to the co-rotating radius and becoming tidally locked. The spin vectors of the protoplanets are isotropically distributed after the giant impact phase [\citep=Agnor99] and the obliquity distribution corresponds to [formula]. In the most extreme scenario, a massive prograde satellite will crash onto the planet in a timescale of order 10,000 years after formation, even though it initially recedes. Hence, without a favorable initial obliquity is an added requirement for the survivability of a close or massive moon. We include this by discarding massive and highly oblique impacts by an approximated inequality, based on area B in figure 13 in [\citet=Atobe06]:

[formula]

More exactly, this holds best for planets with [formula], and it has only to be taken into account if ms  /  mp < 0.05. The distribution of the ap of the simulated planets ranges for 0.1 to 4  AU. In the case of a smaller distance to the host star, angular momentum is removed faster from the planet-satellite system and the evolution timescales are shorter in general. To use this limit properly, a more general expression for different semi-major axes has to be derived, which is out of the scope of this work. Moreover, it depends linearly on the satellite mass which is overestimated in general. A smaller satellite mass would reduce the number of excluded events in general. However, when applying this constraint on the data, only one out of seven moon forming collisions are affected. Since it is over-simplified, we exclude it from our analysis.

For retrograde impacts, where the impactor hits in opposition to the target's spin, two cases result in differing evolution. If the angular momentum of the collision is much larger than the initial rotational angular momentum, the spin direction of the planet is reversed and any impact-generated disk will rotate in the same direction as the planet's spin. On the other hand, a retrograde collision with small angular momentum will not alter the spin direction of the planet significantly and it becomes possible to be left with a retrograde circumplanetary disk[\citep=Canup08]. After accretion of a satellite, tidal deceleration due to the retrograde protoplanet spin will reduce the orbital radius of the bodies continuously till they merge with the planet. Hence, a long-lived satellite can hardly form in this case.

In order to find a reasonable threshold between these two regimes based on the limited information we have, we assume that the sum of the initial angular momenta of the bodies [formula] and [formula] and of the collision [formula] equals the spin angular momentum of the planet and the satellite [formula] and [formula] after the collision plus the angular momentum of the orbiting satellite [formula] at 1.3  aR parallel to the collision angular momentum.

Comparing initial and final angular momenta gives:

[formula]

where [formula] is parallel to [formula]:

[formula]

We assume that [formula] and

[formula]

where n is the orbital mean motion of the satellite if its mass is much smaller than the planet mass, [formula], and G is the gravitational constant. With as = aR we get

[formula]

If

[formula]

the collision is retrograde. Hence,

[formula]

If [formula] and [formula], which is parallel to [formula], are retrograde,

[formula]

the satellite will be tidally decelerated. Those cases are excluded from being moon-forming events. Spin angular momenta are in general overestimated since material is lost during collisions in general, but as mentioned above, the simulations of [\citet=Morishima10] assume perfect accretion. We include this consideration by reducing the involved spins and the orbit angular momentum of the satellite by 30%, [\citep=Kokubo10].

Both scenarios described above, a large initial obliquity or a retrograde orbiting planet, might not become important until subsequent impactors hit the target. Giant impacts can change the spin state of the planet in such a way that the satellite's fate is to crash on the planet. This scenario is discussed in the next section.

Collisional history

We exclude all collisions from being satellite-forming impacts whose target is not one of the final planets of a simulation. A satellite orbiting an impact is lost through the collision with the larger target.

Multiple giant impacts occur during the formation process of a planet and it is useful to study the impact history in more detail. Subsequent collisions and accretion events on the planet after the satellite-forming event may have a large effect on the final outcome of the system. We choose a limit of 5mplanetesimal to distinguish between large impacts and impacts of small particles, which are responsible for the ordered accretion. To stay consistent, the same limit is used below to exclude small impactors from our analysis. We divide all identified moon forming events into four groups:

The moon forming event is the last major impact on the planet. Subsequent mass growth happens basically through planetesimal accretion (see merger tree at the bottom in figure [\ref=fig:tree]).

There are several moon forming impacts, in which the last impact is the last major impact on the planet.

The moon forming event is not the last giant impact on the planet. The satellite can be lost due to a disruptive near or head-on-collision [\citep=Stewart99] of an impactor and the satellite. A late giant impact on the planet can change the spin axis of the planet and the existing satellite can get lost due to tidal effects (see tree at the top in figure [\ref=fig:tree]).

There are several moon forming events in the impact history of the planet, followed by additional major impacts. As before, the moon forming collisions can remove previously formed satellites. On the other hand, and existing moon can have an influence on the circumplanetary disk formed by a giant impact and can suppress the formation of multiple satellites orbiting the planet.

The final states of the planet-satellite systems in group c are difficult to estimate, since such systems might change significantly by additional giant impacts. To a lesser extent, this holds for d, but those systems are probably more resilient to the loss of satellites by direct collisions. The number of events per group is shown in figure [\ref=fig:bars]. Group c and d include more then 2/3 of all collisions. Group c is the most uncertain and we use it to quantify the error on the final sample.

Furthermore, we exclude impactors and targets that have masses of the order of an initial planetesimal mass ([formula]) from producing satellite forming events since their masses are discretized and related to the resolution of the simulation. In addition, small impactors will probably not have enough energy to eject a significant amount of material into a stable orbit. Therefore, setting a lower limit on the target and impactor mass results in the exclusion of many collisions but not in a significant underestimation of the true number of satellites, see figure [\ref=fig:targimp].

Uncertainties

Our final result depends on several assumptions, limitations and approximations. In this section we want to quantify them as much as possible and summarize them.

The data of [\citet=Morishima10] we are using has two peculiarities worth mentioning: The focus on the Solar System and the small number of simulations per set of initial conditions.

The simulations were made in order to reproduce the terrestrial planets of the Solar System. The central star has 1 solar mass and the two gas giants that are introduced after the gas dissipation time scale have the mass of Jupiter and Saturn and the same or similar orbital elements. Although the initial conditions like initial disk mass or gas dissipation time scale are varied in a certain range, the simulated systems do not represent general systems with terrestrial planets. However, we assume that the range of impact histories is representative of the range that would be seen in other systems. Merger trees (figure [\ref=fig:tree]) reveal that those simulations cover a huge diversity of impact histories. But future work will need to investigate the full range of impact histories that could be relevant to the formation of terrestrial planets in other, possibly more exotic, extra-solar systems.

However, the set of simulation covers a broad range of initial conditions. But for every set of initial conditions, only one simulation exists since they are very time consuming (each simulation requires about 4 months of a quad-core CPU). Therefore, it is difficult to separate effects of the choice of certain initial parameters from effects of stochastic processes. We grouped our moon forming events with respect to the simulation parameter in question. The only parameter that reveals an effect on the final sample is the gas dissipation time scale τgas. Larger time scales lead to less moon forming collisions. This variation is correlated with mass and number of final planets. If the gas disk stays for several million years, the bodies are affected by the gas drag for a long time, spiral towards the sun and get destroyed. Therefore, there are less giant impacts and smaller planets. One would suppose that the initial mass of the gas disk should be correlated to the mass of the final planets and therefore to the number of giant impacts, but the two initial protoplanetary disk masses of [formula] and [formula] show no essential difference.

The approach we use to identify events and estimate the mass of the satellite is also based on various approximations and limitations.

Satellite mass

The method we use to calculate the mass of the circumplanetary disk is valid to better than a factor of 2 within the parameter range we use [\citep=Canup08]. Only 10-55% of the disk mass are embodied in the satellite [\citep=Kokubo00]. Therefore, the mass we use is just half of the estimated disk mass, and in the worst case, the satellite is ten times less massive than estimated. This uncertainty affects the number of massive satellites but not the number of satellites in general.

In the (v,b)-plane, we use the same restrictive limits to constrain the collision events. Figure [\ref=fig:vb] presents all moon forming events and this parameter range. Hence, this area gives just a lower bound. We see that it covers some of the most populated parts, but a significant amount of the collisions are situated outside this area. Equation ([\ref=eq:diskmass]) can help to constrain the outcome of the collisions close outside of the shaded region. A collision with a small impact parameter (b < 0.4) will bring very little material into orbit, whatever the impactor mass involved. In this regime, we have few events with high impact velocity and even with high velocity it might be very hard to eject a significant amount of material into orbit. Hence, we exclude them from being moon forming events. For intermediate impact parameter (0.4 < b < 0.8), there are high velocity events (v > 1.4). Above a certain velocity threshold, depending on b and γ, most material ejected by the impact will escape the system and the disk mass might be too small to form a satellite of interest. A large parameter (b > 0.8) describes a highly grazing collision. It is difficult to extent equation ([\ref=eq:diskmass]) for larger b, since these collisions will probably result in a hit-and-run events for high velocities. SPH simulations [\citep=Canup04] [\citep=Canup08] suggest that high relative impact velocities (v > 1.4) will increase rapidly the amount of material that escapes the system. Nevertheless, these sets of simulations focus not on general impacts and the multi-dimensional collision parameter space is not studied well enough to describe those collisions in more detail. Detailed studies of particle collisions will hopefully be published in the near future (e.g. [\citet=Kokubo10]). Based on the arguments above, the events inside of the shaded area form our final sample. Most of the collisions outside the area will not form a moon. The collisions with 0.4 < b < 0.8 and velocity slightly above v = 1.4 and with b > 0.8 and small velocity (v < 1.4) are events with unknown outcome. Including those events, the final number of possible moon forming events is increased by not more than a factor of 1.5.

Tidal evolution - Rotation period

In order to separate receding satellites from satellites which are decelerated after their formation, we check if the initial semi-major axis of the satellite is situated outside or inside of the synchronous radius of the planet. In figure [\ref=fig:rotation], the sample is plotted twice, once including a general correction for angular momentum loss due to realistic collisions and once without correction. Moreover, two thresholds for the synchronous radius are shown. We choose the threshold at 1.3aR (dashed line) and the corrected rotation period (full circles) to be the most justified case. There are two most extreme cases: the threshold situated at 1aR (dotted line) and a corrected rotation period (full circles) indicates that only one in five collisions lead to receding moons. On the other hand, the threshold situated at 1.3  aR and a rotation period directly obtained form the simulations (empty circles) indicates that only one in eight collisions lead to a non-receding moon.

Tidal evolution - Retrograde satellites

To exclude retrograde orbiting satellites, we use a simple relation between the angular momenta involved in a collision. Since we have no exact data of the angular momentum distribution after the collision, this limit is very approximate. To get an estimate of the quality of this angular momentum argument, we study the effect of this threshold on the final sample. First, roughly half of all moon-forming impacts are retrograde. But in almost every case, Lorbit is much smaller than the initial angular momentum. Only four of the retrograde collisions have not enough angular momentum to provide a significant change of the spin axis and those planet-satellite systems remain retrograde. Therefore, our final estimate is not very sensitive to this angular momentum argument. A larger set of particle collision simulations could provide better insight into the angular momentum distribution.

Collision history

Two issues affecting the collision history can change the final result. These being the mass cut we choose to avoid resolution effects, where we exclude small impactors and targets, and the uncertainty about the final state of the planet-satellite system because of multiple and subsequent major impacts. The first limit seems to be well justified. If we change the threshold mass or exclude the cut completely, we change mainly the number of very small, non-satellite forming, impacts since in these cases there is usually insufficient energy to bring a significant amount of material into orbit. The second issue has a significant effect on the final sample, however. Group c, the single moon forming collisions followed by large impacts, contains the most uncertain set of events: Neither all satellites survive the subsequent collisions nor is it likely that all satellites get lost. Hence, in the extreme case, almost half of all initially formed moons, all of Group c, could be lost and our final result reduced significantly.

An overview of the above uncertainties in given in table 1. Additional planet formation simulations are necessary to quantify a large part of existing uncertainties. Simulations of protoplanet collisions exploring the multi-dimensional collision parameter space are desirable and will hopefully be published soon and might help to constrain the parameters for moon formation better. A study of the effect of subsequent accretion of giant bodies after a moon forming impact might give better insight in the evolution of a planet-satellite system.

Discussion and results

Under these restrictive conditions we identify 88 moon forming events in 64 simulations, the masses of the resulting planet-satellite systems are shown in figure [\ref=fig:masses]. On average, every simulation gives three terrestrial planets with different masses and orbital characteristics and we have roughly 180 planets in total. Hence, almost one in two planets has an obliquity stabilizing satellite in its orbit. If we focus on Earth-Moon like systems, where we have a massive planet with a final mass larger than half of an Earth mass and a satellite larger than half a Lunar mass, we identify 15 moon forming collisions. Therefore, 1 in 12 terrestrial planets is hosting a massive moon. The main source of uncertainties results from the modelling of the collision outcomes and evolution of the planet-satellite system as well as the small number of simulation and the limited range of initial conditions. We do not include the latter in our estimate. Hence, we expect the total number of Earth-Moon like systems in all our simulations to be in a range from 4 to 45. This results in a low-end estimate of 1 in 45 and a high-end estimate of 1 in 4. In addition, taking into account the uncertainties on the estimation of the satellite mass, roughly 60 of those systems are formed in the best case or almost no such massive satellites are formed if the efficiency of the satellite accretion in the circumplanetary disk is very low.

There are several papers, where the authors performed N-body simulations and searched for moon-forming collisions. [\citet=Agnor99] started with 22-50 planetary embryos in a narrow disk centered at 1 AU. They estimated around 2 potentially moon-forming collisions per simulation, where the total angular momentum of the encounter exceeds the angular momentum of the Earth-Moon system. They pointed out that this number is somewhat sensitive to the number, spacing, and masses of the initial embryos. [\citet=Obrien06] performed simulations with 25 roughly Mars-mass embryos embedded in a disk of 1000 non-interacting (with each other) planetesimals in an annulus from 0.3 to 4.0 AU. They found that giant impact events which could form the Moon occur frequently in the simulations. These collisions include a roughly Earth-size target whose last large impactor has a mass of 0.11 - 0.14ME and a velocity, when taken at infinity, of 4 km/s, as found by [\citet=Canup04]. O'Brien et al. pointed out that their initial embryo mass is close to the impactor mass. [\citet=Raymond09] set up about 90 embryos with masses from 0.005 to 0.1ME in a disk of more than 1000 planetesimals, again with non-interaction of the latter. Assuming again Canup's requirements (v / vesc < 1.1, 0.67 <  sin θ < 0.76, 0.11 < γ < 0.15), only 4% of their late giant impacts fulfill the angle and velocity criteria. They concluded that Earth's Moon must be a cosmic rarity but a much larger range of late giant collisions would produce satellites with different properties than the Moon. The initial embryo size seems to play a role in those results. In contrast, the simulations of [\citet=Morishima10] start with 2000 fully interacting planetesimals and since embryos form self-consistently out of the planetesimals in these simulations, problems with how to seed embryos are completely avoided. To constrain the simulations, [\citet=Morishima10] were interested in the timing of the Moon-forming impact. To identify potentially events, they searched for a total mass of the impactor and the target [formula], a impactor mass [formula] and a impact angular momentum > LEM. They found almost 100 suitable impacts in the 64 simulations. Since their sample also includes high velocity or grazing impacts, although constrained through the more general angular momentum limit, and does not take into account collision history and tidal evolution, the difference to our result is not surprising.

Life on planets without a massive stabilizing moon would face sudden and drastic changes in climate, posing a survival challenge that has not existed for life on Earth. Our simulations show that Earth-like planets are common in the habitable zone, but planets with massive, obliquity stabilizing moons do occur only in 10% of these.

Acknowledgments

We thank David O'Brien and an anonymous reviewer for many helpful comments. We thank University of Zurich for the financial support. We thank Doug Potter for supporting the computations made on zBox at University of Zurich.