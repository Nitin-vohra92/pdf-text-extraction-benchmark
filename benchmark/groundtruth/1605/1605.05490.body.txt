Lemma Proposition Corollary Conjecture Remark

On pattern avoiding indecomposable permutations

Alice L.L. Gao1, Sergey Kitaev2, and Philip B. Zhang3

1Center for Combinatorics, LPMC-TJKLC Nankai University, Tianjin 300071, P. R. China

2 Department of Computer and Information Sciences University of Strathclyde, 26 Richmond Street, Glasgow G1 1XH, UK

3 College of Mathematical Science Tianjin Normal University, Tianjin 300387, P. R. China

Email: 1 gaolulublue@mail.nankai.edu.cn, 2 sergey.kitaev@cis.strath.ac.uk, 3 zhangbiaonk@163.com

Abstract. Comtet introduced the notion of indecomposable permutations in 1972. A permutation is indecomposable if and only if it has no proper prefix which is itself a permutation. Indecomposable permutations were studied in the literature in various contexts. In particular, this notion has been proven to be useful in obtaining non-trivial enumeration and equidistribution results on permutations.

In this paper, we give a complete classification of indecomposable permutations avoiding a classical pattern of length 3 or 4, and of indecomposable permutations avoiding a non-consecutive vincular pattern of length 3. Further, we provide a recursive formula for enumerating [formula]-avoiding indecomposable permutations for k  ≥  3. Several of our results involve the descent statistic. We also provide a bijective proof of a fact relevant to our studies.

Keywords: pattern avoiding permutations, irreducible permutations, indecomposable permutations, connected permutations, Catalan numbers, Bell numbers

AMS Subject Classifications: 05A05, 05A15

Introduction

Let [formula] and [formula] be the set of permutations of

[formula]

. If iπ = n then π is indecomposable; otherwise, π is decomposable. For example, 23514 is indecomposable, while 31254 is decomposable.

For a permutation π of a set [formula], the reduced form of π, denoted [formula], is the permutation of

[formula]

I x = 1-.

[formula]

Preliminaries

Let Aσn and Iσn be the number of σ-avoiding permutations of

[formula]

, respectively. For 0  ≤  i  ≤  n - 1, let Aσn,i and Iσn,i be the number of σ-avoiding permutations of

[formula]

with i descents, respectively. Thus, for n  ≥  1, we have

[formula]

Let Aσ(x), Aσ(x,q), Iσ(x) and Iσ(x,q) be the generating functions for Aσn, Aσn,i, Iσn and Iσn,i, respectively. That is,

[formula]

[formula]

If for patterns σ1 and σ2, Aσ1n = Aσ1n for all n  ≥  0 then σ1 and σ2 are Wilf-equivalent.

For a permutation [formula], its reverse is the permutation [formula] and its complement is the permutation [formula]. For example, if π = 32145 then r(π) = 54123 and c(π) = 34521. The reverse and complement operations are called trivial bijections. It is easy to see that for any pattern σ, this pattern is Wilf-equivalent to r(σ) and c(σ). Another useful property of trivial bijections is that their composition preserves the property of being decomposable (and thus the property of being indecomposable), which is easy to see.

One of concerns in this paper is to find interrelations between Iσ(x,q) and Aσ(x,q) for certain σs. We note that throughout this paper we implicitly use the fact that an occurrence of a descent cannot start in one component of a permutation and end in another one.

In the rest of this section we review a number of permutation pattern avoidance results relevant to this paper. These results come from [\cite=Kitaev2011Patterns], where references to the original sources can be found.

For [formula] and n  ≥  0, [formula], the n-th Catalan number. Thus,

[formula]

the generating function for the Catalan numbers satisfying xC(x)2 - C(x) + 1 = 0. For n  ≥  0, the Catalan numbers begin with [formula], which is the sequence A000108 in the OEIS [\cite=oeis].

Next result links the well-known Bell numbers to pattern avoiding permutations. The Bell numbers begin with [formula] for n  ≥  0, and this is the sequence A000110 in the OEIS [\cite=oeis].

When σ∈{1,1,3,3}, for n  ≥  0, we have

[formula]

where Bn is the n-th Bell number, which is the number of set partitions of

[formula]

A=C.

[formula]

We next turn our attention to classical patterns of length 4. Table [\ref=tab] presents three Wilf-equivalence classes in this case.

A1234n for n  ≥  0 begins with [formula] (this is the sequence [\cite=oeis]), and we have the following lemma.

For σ∈{1234,4321,1243,2134,3421,4312,1432,2341,3214,4123,2143,3412}, we have

[formula]

Moreover, for n  ≥  1, we have

[formula]

An exact enumeration for 1342-avoiding permutations and the corresponding generating function are given by Bóna [\cite=Bona1997Exact]. The corresponding sequence for n  ≥  0 begins with [formula] (A022558 in [\cite=oeis]) and the following lemma holds.

For σ∈{1342,2431,3124,4213,1423,2314,3241,4132,2413,3142}, we have

[formula]

Moreover, for n  ≥  1, we have

[formula]

However, no formula for A1324n is known, only a recurrence relation is discovered [\cite=Marinov2002/03Counting], and an algorithm for counting the number of 1324-avoiding permutations was given in [\cite=Conway20151324] [\cite=Johansson2014Using]. For recent developments on the bounds, see [\cite=Bevan2015Permutations] [\cite=Bona2015new]. The corresponding sequence for n  ≥  0 begins with [formula]; see A061552 in [\cite=oeis].

Indecomposable permutations avoiding classical patterns

Patterns are permutations, and we distinguish two cases according to whether or not they are decomposable. We start with an easier case.

Indecomposable patterns

Here we deal with the following patterns:

231, 312, 321,

2341, 2413, 2431, 3142, 3241, 3412, 3421, 4123, 4321, 4132, 4213, 4231, 4312.

We first establish a property holding for any indecomposable pattern σ.

If σ is an indecomposable pattern, then Iσ(x,q) satisfies

[formula]

For any permutation π, an occurrence of σ cannot start in one component and end in another one, which would contradict σ being irreducible. Similarly, a descent cannot start in one component and end in another one. Hence, the generating function for σ-avoiding permutations with k components is k and

[formula]

where "1+" corresponds to the empty permutation. This gives the desired result.

Combining Lemma [\ref=inde] (q = 1) and Lemma [\ref=catalan] we obtain the following theorem, which can also be derived, e.g. from considerations in [\cite=Claesson2008Classification].

For σ∈{312,321,231}, we have

[formula]

Thus, for n  ≥  1, Iσn = Cn - 1, the (n - 1)-th Catalan number.

Combining Lemma [\ref=inde] (q = 1) and Lemma [\ref=ge-1342] we obtain the following theorem essentially established in [\cite=Bona1997Exact].

For σ∈{2431,4213,3241,4132,2413,3142}, we have

[formula]

The initial values for Iσn in this case are [formula] for n  ≥  1, and this is the sequence A000257 in the OEIS [\cite=oeis].

Similarly, one can combine Lemma [\ref=inde] (q = 1) and Lemma [\ref=ge-1234] to obtain a formula for Iσ(x), where σ∈{4321,3421,4312,2341,4123,3412}. The initial values for Iσn in this case are [formula] for n  ≥  1, and this sequence is not in the OEIS [\cite=oeis].

However, we cannot obtain a formula for I4231(x) using Lemma [\ref=inde] because no formula is known for A4231(x). The initial values for I4231n are [formula] for n  ≥  1, and this sequence is not in the OEIS [\cite=oeis].

Decomposable patterns

The patterns here we deal with are

123, 132, 213,

1234, 1243, 1324, 1342, 1423, 1432, 2134, 2143, 2314, 3124, 3214.

Decomposable patterns of length 3

Pattern 123. We first give a description of 123-avoiding decomposable permutations.

Let [formula], where π(1) is the component in π formed by the elements in [formula]. Then π is a 123-avoiding decomposable permutation if and only if

[formula]

The backward direction is straightforward to see since no occurrence of the pattern 123 can start in π(1).

For the forward direction, since [formula] is decomposable, one must have 1  ≤  iπ  ≤  n - 1. If πi  <  πj for some 1  ≤  i < j  ≤  iπ then πiπjπn is an occurrence of the pattern 123; contradiction. If πi  <  πj for some iπ + 1  ≤  i < j  ≤  n then π1πiπj is an occurrence of the pattern 123; contradiction. Thus, we obtain the desired result.

Next we derive a relation between I123(x,q) and A123(x,q), which will give formulas for I123(x) and I123n. The initial values for I123n for n  ≥  1 begin with [formula]. This sequence does not appear in the OEIS [\cite=oeis].

We have that

[formula]

[formula]

and for n  ≥  1,

[formula]

By Lemma [\ref=123-decom], the generating function for all 123-avoiding decomposable permutations is [formula]. Since any 123-avoiding permutation is either indecomposable, or decomposable, or the empty permutation, we obtain the relation given by [\eqref=123-1]. Letting q = 1 in [\eqref=123-1] and using Lemma [\ref=catalan], we obtain [\eqref=123-11]. Finally, by Lemma [\ref=catalan] and the fact that [formula], we obtain [\eqref=123-111]. This completes the proof.

We note that ([\ref=123-111]) appears in Proposition 9 in [\cite=Disanto].

Patterns 132 and 213. We begin with a description of 132-avoiding decomposable permutations.

Let [formula], where π(1) is the component in π formed by the elements in [formula]. Then π is a 132-avoiding decomposable permutation if and only if π(1) is a 132-avoiding decomposable permutation, 1  ≤  iπ  ≤  n - 1, and [formula].

The backward direction is easy to see since an occurrence of the pattern 132 cannot start in π(1) in this case.

For the forward direction, since π is decomposable, we have 1  ≤  iπ  ≤  n - 1. Moreover, since π is 132-avoiding, π(1) must be 132-avoiding. Finally, if πi  >  πj for iπ + 1  ≤  i < j  ≤  n then π1πiπj is an occurrence of the pattern 132; contradiction.

Next we find a relation between Aσ(x,q) and Iσ(x,q) for σ∈{132,213}, which will give us formulas for Iσ(x) and Iσn. The initial values for I132n = I213n for n  ≥  1 begin with [formula], which is the sequence A000245 in [\cite=oeis].

For σ∈{132,213}, we have that

[formula]

[formula]

Iσ1 = 1, and for n  ≥  2,

[formula]

Let σ = 132. By Lemma [\ref=132-decom], the generating function for all 132-avoiding decomposable permutations is [formula]. Similarly to the proof of Theorem [\ref=thm-123], we have

[formula]

giving [\eqref=eq-132] for σ = 132. Letting q = 1 in [\eqref=eq-132] and using Lemma [\ref=catalan], we obtain

[formula]

giving [\eqref=132-11] for σ = 132. From [\eqref=132-11], I1321 = 1 and, for n  ≥  2 [\eqref=132-111] follows for σ = 132.

Finally, since the composition of reverse and complement preserves the property of being irreducible, and this composition applied to 132 gives 213, we have that [\eqref=eq-132], [\eqref=132-11] and [\eqref=132-111] hold for σ  =  213.

Note that [\eqref=132-111] follows directly from Lemma [\ref=132-decom]. Indeed, in a decomposable 132-avoiding permutation, the largest element n must be the rightmost element, and the number of such permutations is Cn - 1, while the number of all 132-avoiding permutations of length n is Cn. Also, note that ([\ref=132-111]) appears in Proposition 9 in [\cite=Disanto].

Decomposable patterns of length 4

Recall that applying the composition of reverse and complement, indecomposable permutations stay indecomposable, while applying that composition to the patterns we see that each of 2143, 1324 and 1234 goes to itself, while for the remaining eight decomposable patterns this operation gives

[formula]

[formula]

Thus, we only need to consider seven decomposable patterns of length 4.

Patterns 2314 and 3124. We start with a description of 2314-avoiding and 3124-avoiding decomposable permutations.

Let [formula], where π(1) is a permutation of [formula]. Then π is a 2314-avoiding (resp., 3124-avoiding) decomposable permutation if and only if π(1) is 231-avoiding (resp., 312-avoiding) and [formula] is 2314-avoiding (resp., 3124-avoiding).

For the backward direction, because π(1) is 231-avoiding (resp., 312-avoiding) at most two elements in a possible occurrence of the pattern 2314 (resp., 3124) can be in π(1). But then [formula] contains an element smaller than an element in π(1), which is impossible, and thus π is 2314-avoiding (resp., 3124-avoiding).

For the forward direction, since [formula] is decomposable, we have 1  ≤  iπ  ≤  n - 1. Also, clearly [formula] is 2314-avoiding (resp., 3124-avoiding). Now, if π(1) would contain an occurrence of the pattern 231 (resp., 312) then together with πn it would form an occurrence of the pattern 2314 (resp., 3124); contradiction. Thus π(1) is 231-avoiding (resp., 312-avoiding).

Both of the sequences I2314n and I3124n for n  ≥  1 begin with 1,1,3,13,65,350,1979, [formula], which does not appear in the OEIS [\cite=oeis].

We have

[formula]

[formula]

Further, for σ∈{2314,3124}, we have that

[formula]

Iσ1 = 1, and for n  ≥  2,

[formula]

where Fn is defined in Lemma [\ref=ge-1342].

By Lemma [\ref=2314-decom], the generating function for 2314-avoiding decomposable permutations is [formula], where "- 1" corresponds to excluding the empty permutation as a possibility for [formula]. Similarly, the generating function for 3124-avoiding decomposable permutations is [formula].

Note that each σ-avoiding permutation is either the empty permutation, or an indecomposable permutation or a decomposable ones. This observation shows [\eqref=2314-equ] and [\eqref=3124-equ].

Let q = 1 in [\eqref=2314-equ]. Combing with Lemma [\ref=ge-1342] and [\eqref=eq-catalan], we obtain

[formula]

Hence, by [\eqref=2314-2], we have that I23141 = 1 and for n  ≥  2,

[formula]

It is straightforward to provide essentially the same derivations for the case of 3124-avoiding indecomposable permutations, which completes the proof.

Pattern 3214. We begin with a description of 3214-avoiding decomposable permutations. Our proof of next lemma is similar to the proof of Lemma [\ref=2314-decom] and thus is omitted.

Let [formula], where π(1) is a permutation of [formula]. Then π is a 3214-avoiding decomposable permutation if and only if π(1) is 321-avoiding and [formula] is a 3214-avoiding.

The initial values I3214n for n  ≥  1 begin [formula] and this sequence is not in the OEIS [\cite=oeis].

We have

[formula]

Moreover, for E(x) and En defined in Lemma [\ref=ge-1234], we have

[formula]

I32141 = 1 and for n  ≥  2

[formula]

We can proceed similarly to the proof of Theorem [\ref=thm-2314] to prove [\eqref=3214-rel]. Further, assuming that q = 1 in [\eqref=3214-rel], one can apply Lemma [\ref=ge-1234] and [\eqref=eq-catalan], to obtain

[formula]

From the last derivation, the formula for I3214n holds.

Pattern 2143. We begin with a description of 2143-avoiding decomposable permutations.

Let [formula], where π(1) is a permutation of [formula]. Then π is a 2143-avoiding decomposable permutation if and only if one of the following two conditions holds:

π(1) = 1 and [formula] is 2143-avoiding.

2  ≤  iπ  ≤  n - 1, π(1) is 2143-avoiding and [formula] .

For the forward direction, since π is decomposable, we have 1  ≤  iπ  ≤  n - 1. There are two cases to consider:

iπ = 1. It is clear that π(1) = 1 in this case does not affect [formula], so [formula] must be a 2143-avoiding permutation of [formula].

2  ≤  iπ  ≤  n - 1. Since π(1) is indecomposable of length at least 2, there exist 1  ≤  j1 < j2  ≤  iπ such that πj1  >  πj2. But then to avoid an occurrence of the pattern 2143 involving πj1 and πj2, [formula] must be the increasing permutation [formula].

The backward direction is easy to see using similar considerations as above.

The initial values I2143n for n  ≥  1 are [formula], and this sequence is not in the OEIS [\cite=oeis].

We have

[formula]

Moreover, for E(x) and En defined in Lemma [\ref=ge-1234], we have

[formula]

I2143n = 1 and for n  ≥  2,

[formula]

By Lemma [\ref=2143-decom], [\eqref=eq-2142-case] follows. Further, letting q = 1 in [\eqref=eq-2142-case] and using Lemma [\ref=ge-1234], it follows that

[formula]

from which the formula for I2143n follows.

Pattern 2134. We first give a description of 2134-avoiding decomposable permutations.

Let [formula], where π(1) is a permutation of [formula]. Then π is a 2134-avoiding decomposable permutation if and only if one of the following two conditions holds:

π(1) = 1 and [formula] is 2134-avoiding.

2  ≤  iπ  ≤  n - 1, π(1) is 213-avoiding, and [formula].

For the forward direction, since [formula] is decomposable, we have 1  ≤  iπ  ≤  n - 1. There are two cases to consider:

iπ = 1. It is clear that π(1) does not affect the rest of the permutation, and [formula] must be a 2134-avoiding permutation of [formula].

2  ≤  iπ  ≤  n - 1. Then π(1) must be a 213-avoiding permutation, or else it would form an occurrence of the pattern 2134 with πn. Moreover, since π(1) is indecomposable, there exist 1  ≤  j1 < j2  ≤  iπ such that πj1  >  πj2. But then to avoiding an occurrence of the pattern 2134 involving πj1 and πj2, [formula] must be the increasing permutation [formula].

The backward direction is not difficult to see using considerations above.

Initial values for I2134n are [formula] for n  ≥  1, and this sequence is not in the OEIS [\cite=oeis].

We have

[formula]

Moreover, for E(x) and En defined in Lemma [\ref=ge-1234], we have

[formula]

I21341 = 1 and for n  ≥  2,

[formula]

The identity [\eqref=2134-case] follows from Lemma [\ref=2134-decom]. Further, setting q = 1 in [\eqref=2134-case], and applying Theorem [\ref=inde-length-3] and Lemma [\ref=ge-1234], one has

[formula]

From this, we have the desired formula for I2134n.

Pattern 1324. We first give a description of 1324-avoiding decomposable permutations.

Let [formula], where π(1) is a permutation of [formula]. Then π is a 1324-avoiding decomposable permutation if and only if π(1) is 132-avoiding and [formula] is 213-avoiding.

For the forward direction, since [formula] is decomposable, we have 1  ≤  iπ  ≤  n - 1. Moreover, π(1) is 132-avoiding, or else, along with πn an occurrence of the pattern 1324 would be formed. Also, [formula] is 213-avoiding or else, along with π1 an occurrence of the pattern 1324 would be formed. The backward direction is not difficult to see, which completes the proof.

Initial values for I1324n are [formula], and this sequence is not in the OEIS [\cite=oeis].

We have

[formula]

Also,

[formula]

Moreover, I13241 = 1 and for n  ≥  2,

[formula]

The identity [\eqref=1324-case] follows from Lemma [\ref=1324-decom]. Further, setting q = 1 in [\eqref=1324-case] and applying Lemma [\ref=catalan] and Theorem [\ref=thm-indecom-132], we obtain

[formula]

Hence, I13241 = 1 and for n  ≥  2,

[formula]

This completes the proof.

Pattern 1234. Decomposable 1234-avoiding permutations can be described as follows.

Let [formula], where π(1) is a permutation of [formula]. Then π is a 1234-avoiding decomposable permutation if and only if one of the following two conditions holds:

[formula], [formula] is 123-avoiding and 1  ≤  iπ  ≤  n - 1, or

[formula] is 123-avoiding, [formula], and 3  ≤  iπ  ≤  n - 1.

Since π is 1234-avoiding, then π(1) must be 123-avoiding, or else there would be an occurrence of the pattern 1234 involving an element in [formula]. Thus, the longest increasing sequence in π(1) is at most of length 2. There are two cases to consider.

[formula]. Then, clearly, [formula] must be 123-avoiding.

The longest increasing subsequence in π(1) is exactly of length 2. But then, since π(1) is indecomposable, we have iπ > 2 and [formula] must be 12-avoiding, that is, [formula].

This completes the proof.

Initial values for I1234n are [formula] for n  ≥  1, and this sequence is not in the OEIS [\cite=oeis].

We have

A1234(x,q)  =

[formula]

Also, for E(x) defined in Lemma [\ref=ge-1234],

[formula]

Moreover, I12341 = 1 and for n  ≥  2 and for En defined in Lemma [\ref=ge-1234],

[formula]

The identity ([\ref=1234-case]) follows from Lemma [\ref=1234-decom]. Further, setting q = 1 in [\eqref=1234-case], and applying Lemmas [\ref=catalan] and [\ref=ge-1234] and Theorem [\ref=thm-123], we have

[formula]

Hence, it follows that I12341 = 1 and for n  ≥  2

[formula]

This completes the proof.

Pattern with

Here we consider patterns of the form [formula], where k  ≥  3, which generalizes our considerations for patterns 123 and 1234. First, we give a description of [formula]-avoiding decomposable permutations in the following lemma, whose proof is trivial and thus is omitted.

If [formula] is a [formula]-avoiding decomposable permutation of length n, where π(1) is a permutation of [formula]. Then there exists m, 1  ≤  m  ≤  k - 2, such that the longest increasing subsequence in π(1) is exactly of length m and [formula] is [formula]-avoiding.

Now we can enumerate [formula]-avoiding indecomposable permutations.

We have

[formula]

By Lemma [\ref=aaa], we have

[formula]

from which the result follows.

For example, when k = 3, we have

[formula]

and hence

[formula]

which coincides with Theorem [\ref=thm-123]. Note that we used the facts that I(1)(x) = 0 and [formula].

When k = 4, we have

[formula]

and hence

[formula]

which coincides with Theorem [\ref=thm-1234]. Note that we used the fact that A123(x) = C(x).

Indecomposable permutations avoiding vincular non-consecutive patterns of length 3

For a pattern of the form a, its reverse complement gives a pattern of the form z. Thus, since the composition of reverse and complement preserves the property of being indecomposable, we only need to consider six cases of vincular patterns of length 3, which are 1, 1, 2, 2, 3, and 3. Two of these cases can be reduced to classical pattern-avoidance.

Indeed, it was shown in [\cite=Claesson2001Generalized] that a permutation avoids the pattern 2 if and only if it avoids the pattern 213. Applying the complement operation, this implies that a permutation avoids 2 if and only if it avoids 231. Thus, I2n = I213n and I2n = I231n and Theorems [\ref=thm-indecom-132] and [\ref=inde-length-3] can be applied, respectively.

Pattern 1. We first give a description of 1-avoiding decomposable permutations.

Let [formula], where π(1) is a permutation of [formula]. Then [formula] is a 1-avoiding decomposable permutation if and only if [formula] and [formula] for 1  ≤  iπ  ≤  n - 1, where [formula] is a 1-avoiding permutation of [formula].

Since π is decomposable, we have 1  ≤  iπ  ≤  n - 1. It is clear that π(1) is a 1-avoiding indecomposable permutation. We claim that πiπ = 1, since otherwise 1, πiπ and πiπ + 1 will form the pattern 1. Further, clearly [formula], or else there would be an occurrence of the pattern 1 involving 1.

On the other hand, it is easy to see that if π(1) and [formula] satisfy the conditions then π is 1-avoiding. This completes the proof.

Initial values for I1n for n  ≥  1 are [formula] and this sequence is not in the OEIS [\cite=oeis].

We have

[formula]

Also,

[formula]

where B(x) is the generating function for the Bell numbers.

Moreover, I11 = 1 and for n  ≥  2,

[formula]

By Lemma [\ref=lem-123], the generating function for 1-avoiding decomposable permutations is [formula], hence ([\ref=1-23-case]) follows.

Letting q = 1 in ([\ref=1-23-case]), we have

[formula]

Combing with Lemma [\ref=bell], we obtain that

[formula]

Together with the fact that [formula], we have I11 = 1 and for n  ≥  2,

[formula]

This completes the proof.

Pattern 1. We first give a description of 1-avoiding decomposable permutations.

Let [formula], where π(1) is a permutation of [formula]. Then [formula] is a 1-avoiding decomposable permutation if anf only if π(1) is 1-avoiding and [formula] for 1  ≤  iπ  ≤  n - 1.

If π is 1-avoiding, then clearly π(1) and [formula] are both 1-avoiding. Moreover, we must have [formula], or else there would be an occurrence of the pattern 1 involving 1.

On the other hand, it is clear that if π(1) and [formula] satisfy the given conditions then π is 1-avoiding, which completes the proof.

Initial values for I1n for n  ≥  1 are [formula], which are essentially the sequences A005493 and A138378 in the OEIS [\cite=oeis] that have several combinatorial interpretations. In particular, this sequence counts 1-avoiding permutations that end with a rise, that is, with an occurrence of the pattern [formula], which leads us to the following theorem.

For n  ≥  2, the number of 1-avoiding indecomposable permutations in [formula] is equal to that of 1-avoiding permutations in [formula] that end with a rise.

Let I and R be the first and the second sets, respectively, in the statement of the theorem. We provide a recursive bijection f from I to R proving the theorem with the base case f(21) = 12.

The set of 1-avoiding permutations can be subdivided into three disjoint subsets:

S1, all 1-avoiding permutations ending with 1;

S2, all 1-avoiding permutations ending with n;

S3, all other 1-avoiding permutations.

It is straightforward to see that to the right of 1 in a 1-avoiding permutation we must have an increasing order of elements. But then in S3, n must be to the left of 1. Thus, a permutation in S3 belongs to both I and R and we map it to itself. Further, it is easy to see that S1 is a subset of I but it is disjoint from R, while S2 is a subset of R but it is disjoint from I. For a permutation [formula] we define its image recursively as

[formula]

The map f described by us is easy to see to be a bijection.

Next we enumerate 1-avoiding indecomposable permutations.

We have

[formula]

Also,

[formula]

where B(x) is the generating function for the Bell numbers. Moreover, I1n = 1 and for n  ≥  2

[formula]

By Lemma [\ref=lem-132], the generating function for 1-avoiding decomposable permutations is [formula] from which ([\ref=1-32-case]) follows.

Letting q = 1 in ([\ref=1-32-case]) and combing with Lemma [\ref=bell], we obtain that

[formula]

Hence, it follows that

[formula]

for n  ≥  2. This completes the proof.

Patterns 3 and 3. We first give a description of 3-avoiding and 3-avoiding decomposable permutations.

Let [formula], where π(1) is a permutation of [formula]. Then π is 3- (resp., 3-)avoiding if and only if π(1) and π(2) are both 3- (resp., 3-)avoiding.

Initial values for I3n = I3n for n  ≥  1 are [formula], and this is the sequence A074664 in the OEIS [\cite=oeis] that have several combinatorial interpretations. In particular, this sequence counts the number of irreducible set partitions of

[formula]

I(x)=I(x)=1-.

[formula]

Concluding remarks

The notion of indecomposable permutations proved to be useful in various contexts, e.g. in obtaining non-trivial enumeration and equidistribution results on permutations [\cite=CKS].

In this paper, we gave a compete classification of indecomposable permutations avoiding a classical pattern of length 3 or 4, and of indecomposable permutations avoiding a non-consecutive vincular pattern of length 3. Also, we provided a recursive formula for enumerating [formula]-avoiding indecomposable permutations for k  ≥  3. The descent statistic is taken into account in several of our results.

A natural direction of further research is in extending our studies of indecomposable permutations to other patterns, e.g. vincular patterns of length 4. Also, one can look at avoiding more than one pattern at the same time. Other statistics can be included in enumerative results.

Finally, one can establish a number of bijective results linking pattern avoiding indecomposable permutations to other structures (Theorem [\ref=thm-bij] is one such example). For instance, the sequence A005493 in the OEIS [\cite=oeis] has many interesting combinatorial interpretations that one could try to link in a bijective way to 1-avoiding indecomposable permutations.

Acknowledgments

The work of the first and the third authors was supported by the 973 Project, the PCSIRT Project of the Ministry of Education and the National Science Foundation of China. The second author is grateful to the administration of the Center for Combinatorics at Nankai University for their hospitality during the author's stay in November - December 2015. Also, the authors are grateful to Filippo Disanto for brining to out attention the paper [\cite=Disanto].