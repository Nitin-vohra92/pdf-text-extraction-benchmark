Real-time shot-noise-limited differential photodetection for atomic quantum control

Feedback control of atomic quantum systems [\cite=Serafini2012] enables quantum information protocols including deterministic teleportation [\cite=sherson2006], stabilization of non-classical states [\cite=Sayrin2011], entanglement generation [\cite=TothNJP2010] [\cite=BehboodPRL2014] and quantum-enhanced sensing [\cite=Yonezawa2012] [\cite=InouePRL2013]. Efficient closed-loop control has been achieved by combining optical quantum non-demolition (QND) measurement [\cite=SewellNP2013] [\cite=hosten2016] with electromagnetic [\cite=StocktonThesis2007] or optical [\cite=BehboodPRL2013] feedback. Fidelity of these protocols requires speed, sensitivity and low disturbance in the QND measurement [\cite=DeutschOC2010]. Because advanced QND techniques such as two-color probing [\cite=AppelPNAS2009] and two-polarization probing [\cite=KoschorreckPRL2010a] address specific hyperfine transitions, this also requires small (~   GHz) detunings, and thus low photon numbers to achieve low disturbance. This combination of requirements in the measurement places multiple demands on the detectors used in the QND measurement.

Here we present a balanced differential photodetector (DPD) suitable for ~   pulsed Faraday rotation [\cite=TakanoPRL2009] and two-color [\cite=AppelPNAS2009] dispersive probing of atomic ensembles with sensitivity and dynamic range comparable to the best published differential detectors [\cite=HansenOL2001] [\cite=WindpassingerMST2009]. The DPD employs >  90% quantum efficiency photodiodes and charged-particle-detection amplifiers. Real time output is achieved with low-noise sample and hold amplifiers (SHAs) and a differential amplifier (DA). The system enables atomic quantum control in which feedback to an atomic system must be accomplished with a sub- loop time [\cite=MabuchiIJRNC2005] [\cite=BehboodPRL2013].

The electronics for the DPD and DA together with the test setup are shown schematically in Fig. [\ref=fig:Setup]. The detector consists of two PIN photo-diodes (PDs) (Hamamatsu S3883) connected in series and reverse biased by to improve their response time. The differential output current is DC coupled to the integrator, a very low noise charge-sensitive pre-amplifier (Cremat CR-110) with a capacitor Ci and a discharge resistor Ri in the feedback branch. Together these determine the relaxation time constant [formula] of the integrator. The rise-time of the circuit is limited by the capacitance of the photodiodes while the CR-100 itself has a nominal rise time of . Pulses longer than the rise time but shorter than the relaxation produce a step in the output voltage proportional to Ndiff, the difference of photon numbers on the two photodiodes. The output from the DPD is captured by a pair of sample and hold amplifiers (SHAs) (Analog Devices AD783), gated with TTL signals. The SHA1 captures the voltage of the DPD before the optical pulse arrives, and SHA2 captures it after the end of the pulse. A differential amplifier (DA) (Analog Devices AD8274) amplifies the difference of the two voltages held on the SHAs.

To characterize the noise performance of the DPD we send trains of pulses with a desired photon number N, pulse duration τ, and pulse repetition period Trep. We use a continuous-wave diode laser at , chopped by an acousto-optic modulator and balanced by means of a half waveplate and Wollaston prism, as shown in Fig.  [\ref=fig:Setup]. We record the reference detector (RD) and DPD output voltages on an 8-bit digital storage oscilloscope (LeCroy Waverunner 64Xi) at a sampling rate of 100 Msps which acquires samples continuously and asynchronously to the pulse generation. We define a single measurement for the DPD as [formula], where [formula] is the mean of [formula] voltage samples before (after) the optical pulse and C is a calibration factor. The number of photons Nphot in a pulse is estimated as [formula] where VRD is the voltage output of RD. The sum is taken over the duration of the pulse and CRD is a calibration factor obtained by comparison against a power meter. For a given set of conditions, we adjust the waveplate to give a balanced signal Ndiff  ≈  0 and record M pulses in a single pulse train, from which we extract M values for Ndiff and Nphot and compute statistics.

When source and detector fluctuations are taken into consideration, a linear detector will have an output signal variance given by a second-order polynomial in the average optical input energy [\cite=bachor2004Book],

[formula]

Here a0 is the "electronic noise" (EN) contribution, a2N2phot is the "technical noise" (TN) and the second term is the shot noise (SN) contribution with η the quantum efficiency of the detector. The different scalings with Nphot allow an unambiguous identification of the different noise contributions.

To estimate the coefficients of Eq.1 we collect data at a variety of Nphot in each case recording a train of 2500 pulses with repetition period [formula] and pulse duration [formula]. Our light source is not powerful enough to measure the turning point from SN-limited to TN-limited. In order to estimate when the TN becomes the dominant source of noise we construct "composite pulses" containing a larger total number of photons by summing the signals from multiple pulses [\cite=Koschorreck2010PRL]. The measured variances are fitted with Eq. ([\ref=eq:Polynomial]) to obtain a0, η and a2. We set [formula] to ensure that [formula] is measuring the voltage before the detection of the optical pulse and [formula] which is the minimum time to sample >  99% of the DPD signal, with Nsamp = 10 points. Typical results are shown in Fig.  [\ref=fig:VarNL] (a). The detector is shot-noise limited when a0  /  η < Nphot  <  η / a2. From the fit outputs, see Fig. [\ref=fig:VarNL] for details, we determine that the DPD is SN-limited from (4.06  ±  0.07)  ×  105 < Nphot  <  (3.97  ±  2.18)  ×  109 photons, i.e., its SN limited behavior extends over 4 orders of magnitude.

To characterize the noise properties of the DA we repeat the same procedure as for the DPD: we record on the oscilloscope the RD and DA output voltages. The SHA1 captures [formula] before the optical pulse arrives, and the SHA2 captures [formula] after the end of the pulse, analogous to [formula] and [formula], respectively. We define a single measurement as [formula], where [formula] is the mean of [formula] voltage samples a time [formula] after the end of the SHA2 and C' is a calibration factor obtained by comparison against a power meter. Under the same experimental conditions, [formula] and [formula], we record a train of 2500 pulses for each value of Nphot and fit [formula] with Eq. ([\ref=eq:Polynomial]) we obtain a0, η and a2. As before, we construct "composite pulses" to determine a2. The SHAs are gated for [formula] at times [formula] and [formula]. The analysis parameters are [formula] and [formula] points. Typical results are shown in Fig. [\ref=fig:VarNL] (b). From the fit outputs we determine that the DA is shot-noise limited from (7.43  ±  0.14)  ×  105 < Nphot  <  (3.67  ±  0.91)  ×  108 photons, i.e., over almost 3 orders of magnitude.

From the coefficients a0 we can deduce the noise-equivalent charge (NEC), the number of photo-electrons necessary to create a signal equivalent to the electronic noise [formula] for the DPD and for the DA. The quantum efficiency of the photo-diodes in the detector at 780nm is ηQ= 0.92, resulting in NEC[formula]= 600 electrons and NEC[formula]= 808 electrons. Since the two calibration experiments were taken under the same experimental conditions, i.e., [formula] and [formula], and comparable analysis conditions [formula] and [formula] points, we see that the capability of having the signal available in real time has the cost of increasing the electronic noise level by 1.3dB.

The electronic noise of DPD contains high-bandwidth noise, e.g. Johnson noise, that can be reduced by averaging the in-principle constant output over a time window, which could be longer than the pulse itself. On the other hand, longer windows will be more sensitive to drifts and "1 / f" noise. We investigate this trade-off by changing Nsamp used to obtain [formula] and [formula] and then fit [formula] with Eq.1 to get a0, η and a2. The experiment is done at [formula] and [formula], and the analysis with [formula] and [formula]. For each Nphot we record more than 300 pulses in a single pulse train. From these parameters we evaluate the SN limited region of the DPD as a function of the measurement bandwidth. We fit the EN (TN) limited region a0  /  η < Nphot (Nphot  >  η / a2) with the polynomial α1Nβ1samp  +  α2Nβ2samp (Eq.2), where the two terms are for the two noise time-scales.

In Fig. [\ref=fig:VarENTimeV] we observe a transition from [formula] [formula], where β1 < 0 for [formula] points, describing the effects of averaging, to a 1 / f regime for [formula] points, with [formula] [formula] where β2 > 0. The fit results are [formula] and [formula]. We also notice that Fig. [\ref=fig:VarENTimeV] shows that increasing Nsamp from 1 point to 400 we can reduce the electronic noise of the DPD by , and that at 400 samples the DPD electronic noise is minimal with a NEC of 242 electrons corresponding to a measurement bandwidth of [formula].

We repeat the measurement under the same scope settings to determine the electronic noise contribution of the scope itself terminating it with a 50 Ω terminator. Analogously, we vary Nsamp to obtain [formula] and [formula] and observe that the [formula] is negligible relative to [formula]. The fact that [formula] and not - 1 (as in the case of [formula]) means that there is some correlated noise in the DPD output signal. This is expected as the sampling frequency exceeds the oscilloscope input bandwidth at this setting. The measured oscilloscope bandwidth is .

Even though the EN increases for Nsamp > 400, the SN limited region i.e., the area between the EN and the TN curves, still increases with Nsamp as the reduction of the TN-limited region compensates the increase of the EN. We can observe that the TN is almost flat for [formula] but rapidly decreases for Nsamp  >  500. The DPD is SN-limited over measurements bandwidth running from [formula] to [formula].

The DPD presented here offers a significant improvement in speed compared to other state-of-the-art detectors, while also having somewhat lower noise [\cite=HansenOL2001] [\cite=WindpassingerMST2009] [\cite=Takeuchi2006]. In [\cite=WindpassingerMST2009] two detectors based on two different charge-sensitive pre-amplifier are described with minimal ENC=280 (Amptek-based detector) and ENC=340 (Cremat-based detector) operated at speeds [formula] (exact value not reported). Our DPD shows a minimal ENC=242 at [formula], representing a noise improvement of 0.63dB (Amptek-based detector) and 1.84dB (Cremat-based detector) while operating at similar measurement bandwidth. Similarly, in [\cite=Takeuchi2006] the maximum measurement speed is [formula] and SN limited starting from 106 photons/pulse (our DPD is SN limited from [formula]). Ref [\cite=HansenOL2001], working at a repetition rate of 1 MHz reports a NEC of 730 electrons, whereas our DPD has a NEC of 600 electrons at [formula], a reduction of 0.87 dB. Furthermore, our DPD has a minimum repetition period of T()rep = DPD rise time ([formula]) + [formula] ([formula]) + [formula] ([formula]) + 2 Nsamp ( [formula]) = [formula], or equivalently, a maximum detection bandwidth of [formula], which to our knowledge makes it the fastest quantum-noise limited differential photodetector for this energy regime, i.e., for pulses with as few as 6.8  ×  105 photons. Along with the speed, our DPD is SN limited over measurements bandwidth running from [formula] to kHz.

Atomic experiments have coherence times running from μs to seconds requiring a real time detector with low latency and large bandwidth to perform many manipulations of the atomic state before decoherence occur. The maximum measurement speed of our DA is determined by [formula], the sampling time of the SHAs to faithfully capture [formula], and [formula], the settling time of the SHA once the sampling has been done.

We investigate the effect of [formula] by measuring [formula] vs Nphot for different values of [formula] and compare the fit outputs. We obtain the same results for [formula], the manufacturer recommended value, as for [formula], with fit parameters comparable within the standard error, but not for [formula] where the DA-output is independent of Nphot, i.e., dominated by EN.

We study the effect of the settling time of the SHA2 by varying the samples used for [formula] with [formula] and fit [formula] to obtain the parameters a0, η and a2. From the fit outputs we determine the EN-limited and TN-limited regions. In Fig. [\ref=fig:TDA] we see that for values of [formula] where the noise of the SHA has not had time to settle the EN and the TN contributions are large, dominant over SN. We also observe that once [formula] is sufficient, the EN region is flat as expected from the output of a the DA. From the fit outputs η we determine that the minimum value to have > 99% of the signal corresponds to [formula].

The minimum time at which we can measure two consecutive pulses is given by T(DA)rep = DPD rise time ([formula]) + [formula] ([formula]) + [formula] ([formula]) + [formula] ([formula])= [formula], or equivalently, the maximum detection bandwidth in real time is [formula].

Comparing Fig. [\ref=fig:VarNL] and Fig. [\ref=fig:TDA] we see that the SN-limited region is a bit narrower in Fig. [\ref=fig:TDA], due to the different [formula] used in the analysis. This suggests that the output of the DA has fast frequency noise components that could be filtered to obtain the same noise performance as in Fig. [\ref=fig:VarNL].

In conclusion, we have demonstrated a pulsed differential photodetector (DPD) and a detection system to make the signal available in real time. The DPD has bandwidth up to [formula] which to our knowledge makes it the fastest quantum-noise limited differential photodetector for pulses with as few as 6.8  ×  105 photons per pulse. We make the signal available in real time by using a pair of sample and hold amplifiers (SHA) and a differential amplifier (DA). The DA is shot noise limited per input pulses varying from [formula] to 3.7  ×  108 photons per pulse and shows low latency, [formula]. The DPD together with the DA and can directly be employed in real time quantum control experiments with flexible measurement bandwidth varying from [formula] up to [formula].

We thank Patrick Windpassinger for help and insights in the detector design, and José Carlos Cifuentes for help with the electronics design and construction.

Work supported by the Spanish MINECO projects MAQRO (Ref. FIS2015-68039-P), EPEC (FIS2014-62181-EXP) and Severo Ochoa grant SEV-2015-0522, Catalan 2014-SGR-1295, by the European Research Council project AQUMET, Horizon 2020 FET Proactive project QUIC and by Fundació Privada CELLEX.