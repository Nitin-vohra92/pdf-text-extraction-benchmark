On Causality in Dynamical Systems

Introduction

Causality has no universally accepted definition. For a dynamical system consisting of mutually coupled parts the notion of causality is particularly problematic since in general the dynamics of the overall system cannot be decomposed into components but rather behave as a whole. This fact becomes particularly evident from Takens' theorem [\citep=Packard_1980] [\citep=Takens_1981] which proves that observables measured in any part of a system generically can be used to reconstruct the full state of the overall system. That is, the flow in each reconstruction space uniquely represents the global dynamics, and different reconstructions are therefore topologically equivalent.

For estimating directed dependencies among stochastic variables, Granger Causality [\citep=Granger_1969] is an extensively studied well established method. For dynamical systems, however, applications of Granger Causality for determining influences are conceptually questionable since state reconstructions from different observables of the system contain the identical information about the original state, meaning that the basic premise of separability is violated.

To quantify the strength of mutual influences among parts of dynamical systems, several methods were developed, based on information theory [\citep=Schreiber_2000] [\citep=Palus_2001] or properties of maps between state space reconstructions from different observables [\citep=Schiff_1996] [\citep=Chicarro_2009]. Recently, Convergent-Cross Mapping [\citep=Sugihara_2012] was proposed to establish a measure of causal interrelations in dynamical systems, which was shown to yield interesting results in a range of applications (e.g. [\citep=Sugihara_2012] [\citep=Wang_2014] [\citep=Tajima_2015]). This procedure proposes certain convergence properties of prediction errors, depending on the number of data points, of one observation from the reconstruction of another as a measure of causality. However, as noted before, predictability of one component system from another is theoretically always perfect since no information between reconstructions is lost, rendering the method analytically intransparent. Specifically, it does not address the effect of causal interactions on the interrelation of observables directly.

Here we show that causal interactions systematically influence the relation among reconstructions of the state of a dynamical system from two observables. Whereas topology preservation of the mapping from one reconstruction to the other might be used as an all or nothing criterion that would provide a binary measure of causality [\citep=Pawelzik_1991], we discovered that local distortions in this mapping in fact yield continuous values that can be used to determine the causal links among deterministic component systems.

For the intuition behind this idea consider a system composed of two mutually coupled dynamical components 1 and 2, both time continuous deterministic dynamical systems, where the coupling strength w1  →  2 (coupling from 1 to 2) is substantial while the other coupling w2  →  1 is weak. While according to Takens' Theorem state reconstructions rx1 from measurements x1 of system 1, lying in space Rx1, and reconstructions rx2 from measurements of system 2, lying in space Rx2, will both reveal the same global system attractor and are therefore topologically equivalent, the weak coupling from 2 to 1 implies that the homeomorphic map from rx1 to rx2, symbolized by M1  →  2, will provide a 'stretch'. Since we will in practice investigate the mappings locally, this statement translates to the local homeomorphic map Mt1  →  2 from a small area around a reference point rx1(t) onto rx2 being stretching for most reference time points t. This can be visualized as the compound manifold (rx1,rx2) lying 'steeply' over Rx1 at most reference points (FIG. [\ref=fig_idee] A)).

The fact that M1  →  2 is the more stretching the weaker the coupling w2  →  1 in the reverse direction might seem counter intuitive, but it becomes most clear in the limiting case where component system 2 has no influence on 1 (i.e. w2  →  1 = 0). Here Takens' Theorem still holds for reconstructions based on x2 such that knowledge of the state reconstruction rx2 fully determines rx1. However, reconstructions rx1 obviously cannot (fully) determine rx2, since the latter manifold contains contributions that due to the lack of backward coupling leave not trace in rx1. That is, the map M1  →  2 looses its uniqueness. This can schematically be illustrated by a manifold (rx1,rx2) in the joint space Rx1,x2 that now lies folded over Rx1. FIG. [\ref=fig_idee] B) illustrates the well defined mapping M2  →  1, while in the inverse direction the mapping M1  →  2 does not exist, at least not in the usual sense. In this case we define the stretching from rx1 to rx2 to be infinite since it necessarily diverges at the transition w2  →  1  →  0. Thus, a vanishing coupling w2  →  1 entails a divergent stretching from rx1 to rx2.

In practice the local stretching can be obtained by considering close neighbours to a reference point rx1(t) in Rx1. The time points of the k nearest neighbours to rx1(t) shall be given by {qx1,t1,...,qx1,tk}. Then the corresponding points on rx2, i.e. [formula], will span the whole dynamical range of rx2 and thus will not lie in local vicinity to rx2(t).

An even more extreme limit case occurs when both component systems are completely decoupled. Then they will behave independently and the density of the resulting manifold in joint space Rx1,x2 factorizes. Here, when observed from reference states rx1(t) and rx2(t), the mappings can also be considered infinitely stretching, now in both directions, since for most reference points close neighbours in the respective other space are found to be far away (FIG. [\ref=fig_idee] C)).

Taken together, these topological arguments suggest that the local stretchings of the mappings between reconstruction manifolds of two observables might serve as a viable measure of directed causal influence between component systems represented by these observables.

Topological Causality

The above considerations can be made fully explicit with two coupled time discrete dynamical components for which two-dimensional time-delay coordinates are guaranteed to be sufficient embeddings for the overall dynamics. As a concrete example consider a system of coupled logistic maps described by

[formula]

with n  =  2. Given the reconstruction states rx1(t)  =  (x1(t),x1(t + 1)) and rx2(t)  =  (x2(t),x2(t + 1)), the local maps Mt2  →  1 and Mt1  →  2, which project a small area around the reference point rx2(t) onto rx1 and vice versa, can be calculated. For small perturbations Δx2  =  (Δx2(t),Δx2(t + 1)) around rx2(t) one can see that with

[formula]

This linearised perturbation matrix is equal to Mt2  →  1 for Δx2  →  0 and we will use them interchangeably in the following. Equivalently Mt1  →  2 can be calculated. The maximal local stretching st2  →  1 imposed by Mt2  →  1 is determined by the eigenvalues of the covariance matrix Mt2  →  1(Mt2  →  1)T in the following way: where λmax(A) is the largest eigenvalue of A. While the closed form solutions of st2  →  1 and st1  →  2 are quite lengthy expressions it can be seen that for small couplings w1  →  2, st2  →  1 is dominated by 1 / w1   →   2 and vice versa. This becomes most apparent for w2  →  1  =  0, in which case st2  →  1 simplifies to

[formula]

It is obvious that lim w1  →  2  →  0st2  →  1  =    ∞  , confirming the intuition of infinite stretching for vanishing interaction. Additionally, since for small couplings w1  →  2, the stretching is approximated by [formula], we define a local measure of causality from rx1(t) to rx2(t) as This local property for every point on the reconstructed attractors can be turned into a global measure by averaging over the full set of available states: This definition, which we term Topological Causality, satisfies the following intuitions about causality: First, causality from component system 1 to 2 vanishes if there is no link via which it can act (w1  →  2  =  0) and secondly, for small couplings it is directly proportional to the coupling strength w1  →  2, at least in this simple example. However, causality, reflecting the strength of directed influence between the two component systems, is not merely a function of the coupling strength but also depends explicitly on the current state of the systems as well as on the internal dynamics of each component (dependency on x1(t), x2(t) and f() in Eg. ([\ref=eq:stretching])). FIG. [\ref=fig_linear_map] A) illustrates the state dependency of Ct1  →  2 for a system described by Eqs. ([\ref=eq:pawelzik]).

To especially address the asymmetry of causal influences between components 1 and 2, we furthermore define the local asymmetry index αt as and equivalently for the state-averaged values of C FIG. [\ref=fig_linear_map] B) displays α for a range of coupling parameters in the model described by Eq. ([\ref=eq:pawelzik]), showing that in this example the dominant influence is exerted along the stronger coupling weight. Note however that this is not necessarily the case, e.g. if the internal dynamics of x2 is generated by a different function f2() than the internal dynamics of x1.

Estimating Topological Causality

In cases where the dynamical system model does not allow for an analytical linearisation of the maps between the reconstructed spaces, or the model itself is not known, the stretching by the local maps, and indeed the local maps itself, can be estimated in a purely data-driven manner.

For this, one finds the time indices {qx1,t1,...,qx1,tk} of the k nearest neighbours on rx1 around a reference point rx1(t). Now the projection from {rx1(qx1,t1),...,rx1(qx1,tk)} to {rx2(qx1,t1),...,rx2(qx1,tk)} is approximately mediated by the linear map Mt1  →  2 if the neighbourhood size is sufficiently small compared to the full attractor size. It is then straightforward to estimate Mt1  →  2 by solving a simple optimization problem, where in the numerics some care has to be taken when the stretching becomes large. FIG. [\ref=fig_linear_map] C) and D) demonstrate that the estimates of Ct, C and α obtained in this manner are close to the theoretical values for the system given by Eq. ([\ref=eq:pawelzik]). A neighbourhood size of k  =  10 was used with a total data length of T  =  10000.

Dynamic Reversals of Causal Asymmetry

Since the influence of a component system onto another may be state dependent, as evident from Eq. ([\ref=eq:stretching]), so can the asymmetry index αt. This phenomenon can be investigated in coupled time-discrete maps that are non-linearly coupled. As an example consider the system given by

[formula]

Also in this case the maps Mt1  →  2 and Mt2  →  1 can be calculated analytically and for weak coupling weights w it turns out that [formula] and [formula]. Thus, the map Mt1  →  2 is extremely steep for low x1 values, and the map Mt2  →  1 for low values of x2. Consequently, as shown in FIG. [\ref=fig_sugihara] A) and B), although the coupling weights do not change over time, the asymmetry index αt fluctuates considerably as the system explores the attractor. FIG. [\ref=fig_sugihara] C) illustrates how this change of causal dominance over time gives rise to various dynamical regimes among the time courses of x1 and x2.

Divergence, Transitivity and Convergence

In order to serve as a satisfactory definition of causality in dynamical systems, Topological Causality must obey fundamental requirements that can be demonstrated by examining simple network motifs.

The first prerequisite is the ability to distinguish shared input from true interaction. Consider a system described by Eqs. ([\ref=eq:pawelzik]) with n = 3, where only w3  →  1  ≠  0 and w3  →  2  ≠  0, generating a divergent network motif. With moderate coupling from x3 to x1 and x2, the latter two do not become fully enslaved and, in particular, do not synchronize (which otherwise would represent an irrelevant singular case). Still the usual Pearson Correlation Coefficient (PCC) can reach substantial values which obviously do not represent the total absence of causal links among x1 and x2. In contradistinction, the proposed method yields values for the causal couplings that are low and relatively independent of the common drive, reflecting the actual causal influences (FIG. [\ref=fig_cause_require] A)). Intuitively this result is easily understood: in the respective reconstruction spaces the independent dynamics of the component systems explore independent directions which induces diverging stretching of the mappings among the respective manifolds. This results demonstrates that in dynamical systems Topological Causality can indeed separate causal links from common causes.

The second required property is transitivity, meaning that 'if 1 causes 2 and 2 causes 3, then 1 causes 3'. Since Mt3  →  1  =  Mt2  →  1Mt3  →  2, it can be shown by simple algebraic manipulation that

[formula]

meaning that transitivity is mathematically guaranteed. We illustrate this numerically in FIG. [\ref=fig_cause_require] B) for a system modelled by Eqs. ([\ref=eq:pawelzik]), with n = 3 and where w1  →  2 and w2  →  3 are the only existing links.

In addition, the measure should be able to deal with convergent influences. Unfortunately, if a network of three coupled maps given by Eqs. ([\ref=eq:pawelzik]) has a convergent motif such that x1 and x2 are independently influencing x3, a sufficient embedding is not possible with a low number of delay coordinates. Therefore, convergence needs to be investigated with time continuous component systems for which Takens' Theorem is guaranteed to hold. For this we use three coupled sets of Lorenz equations:

[formula]

A convergence motif is achieved when only the coupling weights w1  →  3 and w2  →  3 are nonzero. FIG. [\ref=fig_cause_require] C) shows that the causal influence of the driving component system with the stronger link to the receiving component system is consistently higher than the influence from the other, which is expected for three coupled systems whose internal dynamics are governed by the same model.

Noise Robustness

Lastly, we address the question of noise robustness. We investigate the noise dependency of the asymmetry index α for two coupled Lorenz systems described by Eqs. ([\ref=eq:lorenz]) with n = 2. FIG. [\ref=fig_noise] shows α for various combinations of w1  →  2 and w2  →  1 in a noise-free case and for 5% and 10% of additive Gaussian noise. Whereas the numerical values for the noiseless case are not faithfully reproduced, the directionality given by the sign of α is consistent and especially the case when w1  →  2  =  0 is correctly captured by a value of α  ≈   - 1.

Discussion

For the analysis of complex systems like the brain, the economy, the climate or the biosphere it is of huge interest to identify causal links among their components. Here, a definition of causality was proposed, termed Topological Causality, that provides an estimate of the sizes and, in particular, of the dominant direction of effective influence among parts of a dynamical system represented by observables of interest. The definition follows heuristic considerations of influence-induced distortions in the mappings between state space reconstructions of component variables.

It was shown that this 'Topological Causality' fulfills basic requirements that a measure of causality must obey, such as disentanglement of causal influence from common input and transitivity.

A prominent concept implied by the current definition is that the effective influence of one part of a system depends on the state of the whole system, meaning that in general Topological Causality is related but not identical to coupling. The latter entails the possibility of temporal variations of the mutual effective influences, which indeed can be captured by the proposed method.

The current work is related to the procedure of Convergent Cross-Mapping (CCM), introduced by [\citep=Sugihara_2012] to overcome the limitations of Granger Causality [\citep=Granger_1969]. CCM exploits the 'difficulty' of predicting one attractor reconstruction from another (i.e. the convergence time) as an indirect measure of the strength of causal influence. We hypothesize that this difficulty of prediction is a direct consequence of the stretching of the mapping, which Topological Causality measures directly: It seems reasonable that if a mapping between reconstructions is more stretching, the error of prediction in direction of this mapping tends to be larger, thus convergence of prediction error tends to be slower. A recent extension of the CCM method investigates the 'smoothness' of maps between reconstructions [\citep=Ma_2014], a concept reminiscent of the Wavering Product [\citep=Pawelzik_1991], which was introduced to detect violations of topological equivalence. But, whereas the smoothness of a map correlates to the stretching in a way that a strongly stretching, non-topology-preserving map will also be not smooth, an interpretation of the various levels of smoothness in terms of effective interactions among component systems is difficult.

While the notion of causality is problematic due to the known generic lack of separability of mutually coupled dynamical component systems, the definition of Topological Causality we put forward here allows for a surprisingly clear mathematical interpretation: in simple cases it was found to be fully analytically tractable and reflects the directed effective influences including their state (and time) dependence. The demonstrated robustness of this measure to noise added to observables from model systems holds promise that Topological Causality will yield useful results also when applied to real data which, however, remains to be explored.