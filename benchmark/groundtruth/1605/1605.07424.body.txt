On the p-adic valuation of Stirling numbers of the first kind

Lemma Corollary

=0

Introduction

It is well known that the n-th harmonic number [formula] is not an integer whenever n  ≥  2. Indeed, this result has been generalized in several ways (see, e.g., [\cite=MR2385421] [\cite=zbMATH03009590] [\cite=zbMATH02614460]). In particular, given integers n  ≥  k  ≥  1, Erds and Niven [\cite=MR0015401] proved that is an integer only for finitely many n and k. Precisely, Chen and Tang [\cite=MR2999589] showed that H(1,1) and H(3,2) are the only integral values. (See also [\cite=MR3267180] for a generalization to arithmetic progressions.)

A crucial step in both the proofs of Erds-Niven and Chen-Tang's results consists in showing that, when n and k are in an appropriate range, for some prime number p the p-adic valuation of H(n,k) is negative, so that H(n,k) cannot be an integer.

Moreover, a study of the p-adic valuation of the harmonic numbers was initiated by Eswarathasan and Levine [\cite=MR1129989]. They conjectured that for any prime number p the set Jp of all positive integers n such that νp(Hn)  >  0 is finite. Although Boyd [\cite=MR1341721] gave a probabilistic model predicting that #  Jp  =  O(p2( log  log p)2  +  ε), for any ε  >  0, and Sanna [\cite=MR3486261] proved that Jp has asymptotic density zero, the conjecture is still open. Another result of Sanna [\cite=MR3486261] is that νp(Hn)  =    -  ⌊ log pn⌋ for any n in a subset Sp of the positive integers with logarithmic density greater than 0.273.

In this paper, we study the p-adic valuation of H(n,k). Let s(n,k) denotes an unsigned Stirling number of the first kind [\cite=MR1397498], i.e., s(n,k) is the number of permutations of [formula] with exactly k disjoint cycles. Then H(n,k) and s(n,k) are related by the following easy identity.

For all integers n  ≥  k  ≥  1, we have H(n,k)  =  s(n + 1,k + 1) / n!.

In light of Lemma [\ref=lem:Hnksnk], and since the p-adic valuation of the factorial is given by the formula [\cite=MR1397498] where sp(n) is the sum of digits of the base p representation of n, it follows that

[formula]

hence the study of νp(H(n,k)) is equivalent to the study of νp(s(n  +  1,k  +  1)). That explains the title of this paper.

In this regard, p-adic valuations of sequences with combinatorial meanings have been studied by several authors (see, e.g., [\cite=MR1667454] [\cite=MR1337793] [\cite=MR3190001] [\cite=MR3275869] [\cite=MR2333145] [\cite=San16]). In particular, the p-adic valuation of Stirling numbers of the second kind have been extensively studied [\cite=MR2410117] [\cite=MR2192240] [\cite=MR2926560] [\cite=MR1285745] [\cite=MR2721543]. On the other hand, very few seems to be known about the p-adic valuation of Stirling numbers of the first kind. Indeed, up to our knowledge, the only systematic work on this topic is due to Lengyel [\cite=MR3283168]. Among several results, he showed (see the proof of [\cite=MR3283168]) that

[formula]

for all prime numbers p and all integers n  ≥  k  ≥  1.

The main aim of this article is to provide an upper bound for νp(H(n,k)). In this respect, we believe that inequality ([\ref=eq:Lengyel_lower_bound]) is nearly optimal, and our Theorem [\ref=thm:ubound] confirms this in the special case when the base p representation of n starts with the base p representation of k  -  1. We also formulate the following:

For any prime number p and any integer k  ≥  1, there exists a constant c  =  c(p,k)  >  0 such that νp(H(n,k))  <   - c log n for all sufficiently large integers n.

Notation and Main results

Before state our results, we need to introduce some notation and definition. For any prime number p, we write

[formula]

to denote a base p representation. In particular, hereafter, the restrictions of ([\ref=equ:theyaredigits]) on [formula] will be implicitly assumed any time we will write something like [formula].

We call p-tree of root [formula] a set of positive integers T such that:

[formula];

If [formula] then u  ≥  v and bi  =  ai for [formula];

If [formula] and u  >  v then [formula].

Moreover, [formula] is a leaf of T if u  >  v and [formula] but [formula]. The set of all leaves of T is denoted by [formula]. Finally, the girth of T is the greatest integer g such that for all [formula] we have [formula] for at least g values of [formula].

We are ready to state our results about the p-adic valuation of H(n,k).

Let p be a prime number and [formula]. Then there exist a p-tree Tp(k) of root k  -  1 and a nonnegative integer Wp(k) such that for any integers [formula] and r∈[t   +   1,s] we have:

If [formula] then νp(H(n,k))  ≥  Wp(k)  +  r  -  ks  +  1;

If [formula] then νp(H(n,k))  =  Wp(k)  +  r  -  ks.

Moreover, the girth of Tp(k) is less than p0.835. In particular, the girth of T2(k) is equal to 1.

Note that the case k = 1 has been excluded from the statement. (As mentioned in the introduction, see [\cite=MR1341721] [\cite=MR1129989] [\cite=MR3486261] for results on the p-adic valuation of H(n,1)  =  Hn.) Later, in Section [\ref=sec:computation], we explain a method to effectively compute the elements of Tp(k) for given p and k, and we also illustrate some examples of the results of these computations.

Lengyel [\cite=MR3283168] proved that for each integer m  ≥  2 it holds which, in light of identity ([\ref=equ:Hnksn1k1]), is in turn equivalent to

[formula]

As an application of Theorem [\ref=thm:tree], we give a corollary that generalizes ([\ref=equ:lengyelv2]) and provides a quite precise description of ν2(H(n,2)).

There exists a sequence [formula] such that for any integer [formula] we have:

If [formula], then ν2(H(n,2))  ≥  1  -  s;

If [formula], and dr  ≠  fr, for some positive integer r  ≤  s, then ν2(H(n,2))  =  r  -  2s.

Precisely, the sequence [formula] can be computed recursively by f0  =  1 and

[formula]

for any positive integer s. In particular, f0  =  1, f1  =  1, f2  =  0.

Note that ([\ref=equ:lengyelv2]) is indeed a consequence of Corollary [\ref=cor:2adic]. In fact, on the one hand, for m  =  2 the identity ([\ref=equ:lengyelv2]) can be checked quickly. On the other hand, for any integer m  ≥  3 we have [formula] with [formula], so that d0  =  f0, d1  =  f1, and d2  ≠  f2, hence ([\ref=equ:lengyelv2]) follows from Corollary [\ref=cor:2adic](ii), with s  =  m  -  1 and r  =  2.

Finally, we obtain the following upper bound for νp(H(n,k)).

Let p be a prime number, [formula], and x  ≥  (k  -  1)p. Then the inequality holds for all [formula], but at most 3x0.835 exceptions.

Preliminaries

Let us start by proving the identity claimed in Lemma [\ref=lem:Hnksnk].

By [\cite=MR1397498] and s(n + 1,0)  =  0, we have the polynomial identity hence and the claim follows.

From here later, let us fix a prime number p and let [formula] and [formula] be positive integers with s  ≥  t  +  1 and di  =  ei for [formula]. For any [formula], define where by convention [formula] if v  =  0, and also where [formula] denotes the sequence of all positive integers not divisible by p. Lastly, put for each integer v  ≥  0. The next lemma relates Ap(n,v) and [formula].

For each nonnegative integer v  ≤  s, we have In particular, [formula] and Ap(n,v) depends only on [formula].

For [formula], we have m∈Ap(n,v) if and only if ps - v|n but [formula]. Therefore,

[formula]

and

[formula]

as claimed.

Before stating the next lemma, we need to introduce some additional notation. First, we define where [formula] for any positive integer m. Note that, since di  =  ei for [formula], from Lemma [\ref=lem:Apnv] it follows easily that indeed Πp(k) depends only on p and k, and not on n. Then we put while, for [formula], with v  ≥  0 and ai  =  ei for [formula], we set and Note that [formula], this fact will be fundamental later.

The following lemma gives a kind of p-adic expansion for H(n,k). We use O(pv) to denote a rational number with p-adic valuation greater than or equal to v.

We have

Clearly, we can write where and for each nonnegative integer v  ≤  Vp(n,k).

We shall prove that Vp(n,k)  =  ks  -  Up(k). On the one hand, we have

[formula]

On the other hand, by ([\ref=equ:Bpkminus1]) and thanks to Lemma [\ref=lem:Apnv], we obtain

[formula]

Hence, in order to maximize [formula] for positive integers [formula], we have to choose [formula] by picking all the k  -  1 elements of Cp(n,k) and exactly one element from Ap(n,t  +  1). Therefore, using again ([\ref=equ:Bpkminus1]) and Lemma [\ref=lem:Apnv], we get

[formula]

as desired.

Similarly, if [formula], for some positive integers [formula] and some nonnegative integer v  ≤  s  -  t  -  1, then only two cases are possible: [formula]; or [formula] consist of all the k  -  1 elements of Cp(n,k) and one element of Ap(n,t  +  v  +  1). As a consequence,

[formula]

for all nonnegative integers v  ≤  s  -  t  -  1.

By putting [formula] and [formula] for [formula], the first sum of ([\ref=equ:Jpnkv]) can be rewritten as

[formula]

where we have also made use of ([\ref=equ:Vpnk]) and Lemma [\ref=lem:Apnv], hence

[formula]

for any nonnegative integer v  ≤  s  -  t  -  1.

At this point, being s  >  t, by ([\ref=equ:Vpnk]) it follows that Vp(n,k)  >  s  -  t  -  1, hence

[formula]

since clearly νp(Jp(n,k,v))  ≥  0 for any nonnegative integer v  ≤  Vp(n,k).

In conclusion, the claim follows from ([\ref=equ:JpnkvHp]) and ([\ref=equ:Hnkvst1]).

Finally, we need two lemmas about the number of solutions of some congruences. For rational numbers a and b, we write [formula] to mean that νp(a  -  b)  >  0.

Let r be a rational number and let x,y be positive integers with y  <  p. Then the number of integers v∈[x,x  +  y] such that [formula] is less than [formula].

The case r  =  0 is proved in [\cite=MR3486261] and the proof works exactly in the same way even for r  ≠  0.

Let q be a rational number and let a be a positive integer. Then the number of [formula] such that

[formula]

is less than p0.835.

It is easy to see that there exists some [formula] such that Therefore, by putting x: = cp(a), y: = h, and r: = q  +  Hx  -  1 in Lemma [\ref=lem:harm], we get that the number of d  ≤  h satisfying ([\ref=equ:cpqp]) is less than [formula]. Similarly, by putting x: = cp(a)  +  h  +  2, y: = p  -  h  -  2, and in Lemma [\ref=lem:harm], we get that the number of d∈[h   +   1,p   -   1] satisfying ([\ref=equ:cpqp]) is less than [formula]. Thus, letting N be the number of [formula] that satisfy ([\ref=equ:cpqp]), we have Furthermore, it is clear the d and d + 1 cannot both satisfy ([\ref=equ:cpqp]), hence [formula]. Finally, a little computation shows that the maximum of is obtained for p  =  59 and is less than 0.835, hence the claim follows.

Proof of Theorem [\ref=thm:tree]

Now we are ready to prove Theorem [\ref=thm:tree]. For any [formula], with u  ≥  0 and ai  =  ei for [formula], let Furthermore, define the sequence of sets [formula] as follows: [formula], and for any integer u  ≥  0 put [formula] if and only if [formula] and [formula]. At this point, setting it is straightforward to see that Tp(k) is a p-tree of root [formula]. Put Wp(k): = Up(k)  -  t  -  1.

If [formula] then, by the definition of Tp(k), we have [formula]. Therefore, by Lemma [\ref=lem:vpHnk] it follows that νp(H(n,k))  ≥  Wp(k)  +  r  -  ks  +  1, and this proves (i).

If [formula] then r  >  t and [formula] but [formula], so that

[formula]

Now we distinguish between two cases. If r  =  t  +  1, then [formula] and by Lemma [\ref=lem:vpHnk] we obtain νp(H(n,k))  =  Wp(k)  +  r  -  ks. If r  >  t  +  1 then by [formula] we get that [formula], which together with ([\ref=equ:vpSpd0]) and implies that [formula], hence by Lemma [\ref=lem:vpHnk] we get νp(H(n,k))  =  Wp(k)  +  r  -  ks, and also (ii) is proved.

It remains only to bound the girth of Tp(k). Let u be a nonnegative integer and pick [formula]. By the definition of T(u + 1)p(k), we have [formula] if and only if [formula], which in turn is equivalent to

[formula]

Using the definition of [formula] and the facts that and νp(Πp(k))  =  0, we get that ([\ref=equ:longcong1]) is equivalent to

[formula]

where Note that both a and the right-hand side of ([\ref=equ:longcong2]) do not depend on at  +  u  +  1. As a consequence, by Lemma [\ref=lem:cpicong] we get that [formula] for less than p0.835 values of [formula]. Thus the girth of Tp(k) is less than p0.835.

Finally, consider the case p  =  2. Obviously, [formula] for any positive integer i, while the right-hand side of ([\ref=equ:longcong2]) is equal to 0 or 1 (mod 2). Therefore, there exists one and only one choice of at + u + 1∈{0,1} such that ([\ref=equ:longcong2]) is satisfied. This means that the girth of T2(k) is exactly 1.

The proof is complete.

The computation of Tp(k)

Given p and k, it might be interesting to effectively compute the elements of Tp(k). Clearly, Tp(k) could be infinite -- and this is indeed the case when p  =  2, since by Theorem [\ref=thm:tree] we know that T2(k) has girth 1 -- hence the computation should proceed by first enumerating all the elements of T(0)p(k), then all the elements of T(1)p(k), and so on. An obvious way to do this is using the recursive definition of the T(u)p(k)'s. However, it is easy to see how this method is quite complicated and impractical. A better idea is noting that, taking r  =  s in Theorem [\ref=thm:tree], we have

[formula]

for all integers u  ≥  0. Therefore, starting from [formula], formula ([\ref=equ:Tprec]) gives a way to compute recursively all the elements of Tp(k). In particular, if Tp(k) is finite, then after sufficient computation one will get [formula] for some positive integer u, so the method actually proves that Tp(k) is finite.

The authors implemented this algorithm in SageMath, since it allows computations with arbitrary-precision p-adic numbers. In particular, they found that [formula] are all finite sets, with respectively 8,24,16,7,23 elements, while the cardinality of T3(7) is at least 43. Through these numerical experiments, it seems that, in general, Tp(k) does not exhibit any trivial structure (see Figures [\ref=fig:1], [\ref=fig:2], [\ref=fig:3]), hence the question of the finiteness of Tp(k) is probably a difficult one.

Proof of Corollary [\ref=cor:2adic]

Only for this section, let us focus on the case p  =  2 and k  =  2, so that t  =  0, e0  =  1, and W2(2)  =  0. Thanks to Theorem [\ref=thm:tree] we know that T2(2) has girth 1. Hence, it follows easily that there exists a sequence [formula] such that [formula] for all integers u  ≥  0. In particular, f0  =  e0  =  1. At this point, (i) and (ii) are direct consequences of Theorem [\ref=thm:tree], while the recursive formula ([\ref=equ:recf]) is just a special case of ([\ref=equ:Tprec]).

Proof of Theorem [\ref=thm:ubound]

It is easy to see that #  T(u)p(k)  <  p0.835u, for any positive integer u.

On the one hand, the number of [formula] such that [formula] for any integer r∈[t  +  1,s] is less than

On the other hand, if [formula] and [formula] for some integer r∈[t   +   1,s], then by Theorem [\ref=thm:tree](ii) we get that

[formula]

where we have made use of ([\ref=equ:Bpkminus1]) and the inequalities s  >   log pn  -  1 and t  ≤   log p(k  -  1).

Figures