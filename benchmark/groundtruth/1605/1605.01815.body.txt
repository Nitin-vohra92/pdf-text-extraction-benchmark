Discretization of Fractional Differential Equations by a Piecewise Constant Approximation

Introduction

There has been an increasing use of fractional calculus in models of physical systems, such as anomalous diffusion [\cite=MK2000] [\cite=MS2012] [\cite=ADH2013mmnp], viscoelasticity [\cite=M2010],and the spread of disease [\cite=AHM2016fiSIR] [\cite=AHM2016frSIR]. These models are often posed in the form of fractional differential equations (FDEs). Recently there have been attempts to construct a difference equation that captures the dynamical behaviour of a FDE by using a nonstandard piecewise approximation [\cite=el2013discretization] [\cite=Agarwal2013] [\cite=ismail2015generalized] [\cite=selvam2016dynamics] [\cite=el2014discretization] [\cite=EES2014discretization] [\cite=el2016fractional]. These attempts have resulted in the incorrect construction of first order difference equations that can not approximate the dynamics of FDEs. In the earliest of these works [\cite=el2013discretization] the first order difference equation is the result of the use of incorrect limits on an integral, (see Section 2 of [\cite=el2013discretization]). Later papers, such as [\cite=Agarwal2013], correct this mistake but introduce other, more subtle, errors that result in the same incorrect first order difference equations.

Traditional discretization methods for fractional differential operators, such as the Grünwald-Letnikov approximation and its generalizations [\cite=P1999] [\cite=BDST2012] [\cite=BKS2015] [\cite=Jacobs2015], result in sums over the entire history of the function. The memory effect of fractional order equations has been physically corroborated and is imperative that a numerical scheme capture this dynamic, as in the physically consistent numerical schemes derived in [\cite=ADHN2015] [\cite=angstmann2016stochastic]. This history dependent dynamics cannot be captured by a first order difference equation. This alone is enough to question the validity of a first order difference equation from a discretization scheme for a fractional differential equation.

Here we consider an initial value FDE of the form,

[formula]

where [formula] is a Caputo fractional derivative with 0 < α < 1 and f(x(t)) is potentially a nonlinear vector field. We show that the first order discretization given by El-Sayed and others [\cite=el2013discretization] [\cite=Agarwal2013] [\cite=ismail2015generalized] [\cite=selvam2016dynamics] [\cite=el2014discretization] [\cite=EES2014discretization] [\cite=el2016fractional] is incorrect. Further to this we correct the derivation of the difference equation resulting in an increasing order difference equation which captures the memory effect of the FDE. This is achieved by a piecewise constant approximation of the vector field. Resulting in a one parameter family of integrable FDEs that limit to the original FDE. The integrable FDEs have a closed form solution that can be discretised to provide a difference equation that approximates the solution of the original FDE. Furthermore, we show that this method may be implemented with an non-uniform time step. An example is presented that shows the difference equation correctly captures the dynamics of a specific FDE.

Fractional Derivatives

The properties of fractional derivatives have been widely explored in [\cite=OS1974] [\cite=P1999] and more recently in [\cite=LD2007]. There exist multiple types of fractional derivatives, here we will focus on FDEs involving Caputo derivatives. A Caputo fractional derivative is defined by [\cite=C1967],

[formula]

for 0 < α < 1. The Riemann-Liouiville fractional derivative is defined by,

[formula]

for 0 < α < 1. We can transform a Caputo derivative to a Riemann-Liouville through the following relation [\cite=LD2007];

[formula]

hence the two are equivalent when x(0) = 0.

Fractional derivatives can be easily expressed in Laplace space and we will make use of this form.

The Laplace transform of the Caputo fractional derivative is,

[formula]

The Grünwald-Letnikov derivative is defined by,

[formula]

If x(t)∈C0 and [formula], then this is equivalent to the Riemann-Liouville derivative. Grünwald-Letnikov derivatives have long been used as a basis of methods for discretising Riemann-Liouville FDEs [\cite=P1999] [\cite=BDST2012].

Comparison to El-Sayed and Salman

In general the approach taken by El-Sayed and others [\cite=el2013discretization] [\cite=Agarwal2013] [\cite=ismail2015generalized] [\cite=selvam2016dynamics] [\cite=el2014discretization] [\cite=EES2014discretization] [\cite=el2016fractional] can be generalised easily for an equation in the form of Eq. ([\ref=eq_f]). This gives a discrete equation of the form,

[formula]

This first order difference equation can not capture the dynamics of a fractional order differential equation.

Convergence

It is easy to see that Eq. ([\ref=eq_wrong]) does not have a well defined limit as [formula] such that t = nδt. We can rearrange Eq. ([\ref=eq_wrong]) to give,

[formula]

Taking [formula], this becomes,

[formula]

Finally taking the limit δt  →  0 gives f(x(t)) = 0, for 0 < α < 1. Hence we do not recover the original equation in the limit of small time steps. It should also be noted that the correct equation is recovered in the case α = 1.

Piecewise Constant Integrablization

Whilst the final result of the El-Sayed method [\cite=el2013discretization] [\cite=Agarwal2013] [\cite=ismail2015generalized] [\cite=selvam2016dynamics] [\cite=el2014discretization] [\cite=EES2014discretization] [\cite=el2016fractional] is incorrect, the initial approach that they undertake has some merit. Here we will consider the general Caputo initial value problem given in Eq. ([\ref=eq_f]). We will construct a family of equations, parametrized by δt such that in the limit δt  →  0 the family limits to Eq. ([\ref=eq_f]). Each member of the family is an integrable FDE with a closed form solution. We will refer to this process as an integrablization of Eq. ([\ref=eq_f]). Here this is achieved by replacing the right hand side of the FDE with a piecewise constant function. Choosing some time step δt, the FDE to solve would become,

[formula]

This is the same equation that El-Sayed and Salman [\cite=el2013discretization] attempt to solve. We show below that this is an integrable equation whose solution is trivially obtained. The piecewise constant function is chosen so that in the limit of small δt we recover the original equation, i.e.

[formula]

Using a unit step function, defined by

[formula]

we can rewrite the right-hand side Eq. ([\ref=eq_d]) as a sum, giving

[formula]

This can be expressed as a sum of single unit step functions,

[formula]

The solution of this equation can be found utilising Laplace transforms. The Laplace transform of Eq. ([\ref=eq_piececonstre]) yields,

[formula]

where x(0) = x0. Rearranging and inverting the Laplace transform gives,

[formula]

We note that this is a solution in continuous t. This can be simplified to an [formula] order difference equation by setting t = nδt,

[formula]

This difference equation incorporates the history of the function and as such the order of the difference equation grows with each time step.

Convergence

It is easy to confirm that the discretization given in Eq. ([\ref=eq_pwc]) will limit to the solution of Eq. ([\ref=eq_f]) in the limit as δt  →  0. Firstly we note that the solution of Eq. ([\ref=eq_f]) can be found by fractionally integrating both side of the equation giving,

[formula]

Integrating by parts leads to,

[formula]

Now considering Eq.([\ref=eq_pwc]), we can write,

[formula]

Taking the limit δt  →  0 such that t = nδt and t' = mδt are fixed then one recovers Eq. ([\ref=eq_sol]). This shows that the discretization given in Eq. ([\ref=eq_pwc]) converges to the solution of Eq. ([\ref=eq_f]) in the limit δt  →  0. This also shows that the discretization could have been derived from a quadrature of Eq. ([\ref=eq_sol]). This integral form representation of the method shows that this is related to a fractional order Adams method [\cite=ZM2016].

Non-uniform Time Step

One benefit of this approach is the ease of implementing a non-uniform time step. The approximation to Eq. ([\ref=eq_f]), can be formulated so that the time steps, [formula], are not uniformly sized. Let the sum of the first i time steps be represented as τi i.e.

[formula]

With the unit step notation the FDE approximation is,

[formula]

Again, the solution can be found using Laplace transform techniques. Following the same method as above this gives,

[formula]

This leads to a difference equation by setting t = τn,

[formula]

This difference equation reduces to Eq. ([\ref=eq_pwc]) when uniform time steps are taken.

Examples

Comparision to El-Sayed et. al.

In [\cite=el2013discretization] El-Sayed and Salman consider the fractional order Riccati equation of the form,

[formula]

with the initial condition x(0) = x0. The first order difference equation that they derive is then given as,

[formula]

Our discretization of Eq. ([\ref=eq_Riccati]) can be found from Eq. ([\ref=eq_pwcNon]),

[formula]

Taking τn = nδt leads to the fixed time step discretization. Figure [\ref=fig_Riccati] shows the results of these two discritization methods with ρ = 1, α = 0.8, and x0 = 0.5, for δt = 0.1,  0.01, and 0.001. From the figure it is not clear that Eq. ([\ref=eq_wrongRiccati]) is convergent as δt  →  0, this is in contrast to the results from Eq. ([\ref=eq_disRiccati]). We also see that the results from Eq. ([\ref=eq_disRiccati]) display a much slower approach to the equilibrium at x = 1 that is characteristic of fractional order differential equations.

Linear Fractional Differential Equation

To show that the discretization presented here correctly captures the dynamics of a fractional order differential equation we will consider a simple case with a known exact solution. Consider the Caputo FDE,

[formula]

with x(0)  =  x0. As this is a linear equation the solution is easily found by Laplace transform methods,

[formula]

where Eα(y) is a Mittag-Leffler function.

To check that the discretization correctly captures the dynamics we will compare the exact solution with discrete points generated by the piecewise constant integrablization. We will also compare against the standard Grünwald-Letnikov discretization of the same equation. The Grünwald-Letnikov discretization of Eq. ([\ref=eq_ex1]) is given by,

[formula]

The difference equation from a piecewise constant integrablization can be found from Eq. ([\ref=eq_pwcNon]),

[formula]

Taking τn = nδt leads to the fixed time step discretization. As well as a fixed time step we will consider two cases of non-uniform time steps. In the first case we will draw a set of τn's from a uniform distribution such that the expected value of τn  -  τn - 1 is δt. In the second case we deterministically chose the τn such that the difference between subsequent τ's is an increasing function. Again the time steps are chosen so that the average value is δt.

Figure [\ref=fig1] shows the results of these discretizations on the time interval

[formula]

Conclusion

We have shown that the discretization method, presented by El-Sayed and others, for a class of initial values problems involving Caputo derivatives results in an incorrect first order difference equation. This difference equation, being of first order, cannot capture the dynamics of the original FDE. We have presented a correct derivation of an increasing order difference equation based on a piecewise constant approximation for the vector field of the FDE. This discretization method is amenable to non-uniform time steps and can easily be implemented on nonlinear FDEs, including non-autonomous FDEs.

Acknowledgments

This work was supported by the Australian Commonwealth Government (ARC DP140101193). B.A.J. acknowledges the National Research Foundation of South Africa under grant number 94005. C.N.A. and B.A.J. thank the DST-NRF Centre of Excellence in Mathematical and Statistical Sciences (CoE-MaSS) for their support of C.N.A.'s visit to the University of the Witwatersrand. Opinions expressed and conclusions arrived at are those of the author and are not necessarily to be attributed to the CoE-MaSS.