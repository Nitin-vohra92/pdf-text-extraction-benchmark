The number of cycles in random permutations without long cycles is asymptotically Gaussian

Introduction

It is a classical result about random permutations proved by Goncharov ([\cite=goncharov1944some] [\cite=goncharov1944field]) that the number of cycles of a uniform random permutation is asymptotically Gaussian after suitable normalization. More precisely, for a permutation σ∈Sn, write cj(σ) for the number of cycles of length j in σ and [formula] for the total number of cycles. Let [formula] denote the uniform distribution on Sn, then for all [formula],

[formula]

where Φ is the distribution function of the standard normal distribution.

A particularly instructive proof of this result was given in [\cite=shepp1966ordered], where it is observed that the joint distribution of the cj, j  ≤  n, under [formula] is equal to the distribution of independent random variables j, j  <    ∞  , conditional on [formula], where j is Poisson distributed with parameter zj / j for arbitrary z∈(0,1). In the framework of statistical mechanics, z can thus be viewed as the chemical potential and the joint distribution of the j as the grand canonical ensemble corresponding to the measures [formula]. Noting that the limit n  →    ∞   corresponds to z  →  1, Equation [\eqref=clt_classical] is then easy to guess and not very hard to prove. Indeed, much more is true: Delaurentis and Pittel [\cite=DP85] show that for [formula], the joint distribution of (( log n)- 1 / 2(Cn,t  -  t log n))0  ≤  t  ≤  1 converges to standard Brownian motion on the time interval

[formula]

Results

Let [formula], and consider

[formula]

the set of permutations with n elements and all cycles shorter than α(n). Let [formula] denote the uniform distribution on Sn,α, and write

[formula]

for the sum of cycle counts cj(σ). For δ  >  0 and all w∈(1 - δ,1 + δ), let xn,α(w) be the unique positive solution of the equation

[formula]

Equivalently, xn,α is the unique root of the polynomial

[formula]

that is contained in the interval (1,  ∞  ). Let us further write

[formula]

where x'n,α denotes the derivative of xn,α. Our main result is

Assume that and

[formula]

Then for all [formula],

[formula]

Here, Φ is the distribution function of the standard normal distribution.

Note that there is an extra term in the variance in equation [\eqref=mean_and_variance]. So in contrast to the classical situation, asymptotic mean and variance need not be of the same order. Under some additional assumptions on the function α, we can derive asymptotic expressions for mn,α and vn,α and see that they are indeed of different order. For this, recall first the concept of asymptotic expansion. Let [formula] be a sequence of functions such that for all k

[formula]

as z  →    ∞  . We say that [formula] is an asymptotic expansion for the function [formula] as z  →    ∞  , and write

[formula]

if for all [formula]

[formula]

as z  →    ∞   (cf., e.g., [\cite=murray1992asymptotic]).

Let us write [formula] for the non-zero solution of

[formula]

with [formula]. Note that [formula] for u > 1.

Assume that there are α0,α1∈(0,1) with

[formula]

Then the quantities defined in [\eqref=mean_and_variance] have the asymptotic expansions

[formula]

and

[formula]

This result shows that the average cycle count is close to its theoretical minimum, or in other words the average cycle lengths are close to maximal. This supports observations made e.g. in [\cite=BUV] that 'entropy' is extremely strong in random permutations in the sense that it is very hard to 'force' many short cycles by modifying the uniform measure on permutations in natural ways, such as cycle weights or nontrivial conditioning.

Proofs: overview

We will use the following criterion for a central limit theorem:

[\cite=Sachkov1997] Let An be a sequence of integer-valued random variables and assume that, as n  →    ∞  , their probability generating functions Hn can be written as

[formula]

uniformly in the interval [formula] for some δ  >  0, where hn has the following properties: hn is thrice continuously differentiable in W, and

[formula]

Then the distribution of the random variable

[formula]

converges weakly to a standard normal distribution as n  →    ∞  .

For applying the above result, we need information on the generating function of the random cycle count C under [formula]. As is well known (see e.g. [\cite=Flajolet2009]), the cardinality of Sn,α is given by

[formula]

where γ is any closed curve around the origin in the complex plane. The probability generating function [formula] of C under [formula] can therefore be written as

[formula]

where cn,α is a normalization constant (which does not depend on w) (cf. [\cite=Flajolet2009] for both equations).

In [\cite=Sachkov1997], Proposition [\ref=prop:Sach] is applied to cases such as Equation ([\ref=eq:GenFunc]), and an approximation using the saddle point method is given. The difference to our situation however is that in the cited reference, there are fixed polynomials in the exponential, while in our case the upper limit α(n) of the sum will typically grow with n. To handle this situation, we use a very slight generalization of precise asymptotic estimates recently derived by Manstaviius and Petuchovas [\cite=manstavivcius2014local] [\cite=manstavivcius2015permutations].

Under the assumptions of Theorem [\ref=main_thm], the following asymptotic relation holds as n  →    ∞  , uniformly for [formula]:

[formula]

Here, [formula] is the unique positive solution of [\eqref=eq:saddle].

First note that because of the strict inequality in [\eqref=growth_condition], there exists δ  >  0 such that for all w∈(1 - δ,1 + δ) and all large enough n, we have

[formula]

The proposition is then an adaptation of Theorem 2 in [\cite=manstavivcius2014local]. The latter makes use of the saddle point method and treats the case w = 1. The proof given by Manstaviius and Petuchovas extends almost verbatim to the present situation when only large n are considered. The main difference is a maximization of the resulting constants in the error terms with respect to [formula], which does not affect their asymptotics.

Indeed, [\cite=manstavivcius2014local] proves the asymptotics in the case w = 1 without restrictions on α, but the generalization to w  ≠  1 is not as obvious without the growth restriction [\eqref=growth_condition], so we stick with it.

To connect Propositions [\ref=prop:Sach] and [\ref=prop:asymp] and prove the theorem, we thus need asymptotics of the derivatives of

[formula]

This is done in Lemmas [\ref=lem:h1Ableitung] to [\ref=lem:hStrichStrichStrichAs], where it is proved that

[formula]

and that hn,α'''(w)  =  O(n / α(n)). Since it turns out (see Lemma [\ref=h2strich_asymptotics] and the discussion thereafter) that the leading terms of both hn,α' and hn,α'' behave like n / α(n) for large n but have different signs, a very fine asymptotic analysis is necessary to ensure that [\eqref=sachkov_condition] holds. This is done in Propositions [\ref=prop:hStrich] and [\ref=prop:hStrichStrich]. After this, Proposition [\ref=prop:Sach] can be used to prove Theorem [\ref=main_thm].

The proof of Theorem [\ref=quantitative] refines the results of Propositions [\ref=prop:hStrich] and [\ref=prop:hStrichStrich] by adding information on the asymptotics of xn,α(1). These are given in Lemma [\ref=lem:xiEigensch], and are essentially due to [\cite=manstavivcius2014local].

Proofs: details

The following lemma presents an expression for the first derivative of hn,α.

Let [formula] and 0 < δ < 1. Then the following relation holds for all [formula] and [formula]:

[formula]

Since [formula] is strictly increasing on [formula], the saddle point function xn,α is infinitely often differentiable in w by the inverse mapping theorem and a bootstrapping argument. Due to Equation ([\ref=eq:saddle]), the derivative of the first three terms of Equation ([\ref=eq:kleinH]) is the first term of Equation ([\ref=eq:kleinHstrich]). For the last term of Equation ([\ref=eq:kleinH]), use the identity

[formula]

obtained by differentiating Equation ([\ref=eq:saddle]).

The ingredients necessary for the proof of the theorem are asymptotics for the derivatives of hn,α. A first step towards this goal is

Let [formula] and 0 < δ < 1 such that [formula] for large n and [formula]. Then

[formula]

if and only if

[formula]

[\cite=manstavivcius2014local] Comparing geometric and arithmetic means yields

[formula]

From Equation ([\ref=eq:saddle]),

[formula]

Hence,

[formula]

and, since the logarithm is increasing and [formula],

[formula]

The claim is a direct consequence.

More detailed asymptotics for [formula] and related quantities can be found in [\cite=manstavivcius2014local].

Let [formula] and 0 < δ < 1 such that [formula] for large n and [formula]. Moreover, let

[formula]

Then,

[formula]

Starting from Equation ([\ref=eq:saddle]), we have

[formula]

Differentiating Equation ([\ref=eq:ZuDiff]) with respect to w, solving for [formula], and applying once more Equation ([\ref=eq:saddle]) yields

[formula]

Hence,

[formula]

by Lemma [\ref=lem:Divergenz] and

[formula]

Let [formula] and 0 < δ < 1 as in Lemma [\ref=lem:asympXstrich]. Then the following relations hold uniformly in [formula] as n  →    ∞  :

[formula]

and

[formula]

Let

[formula]

then

[formula]

by Lemma [\ref=lem:asympXstrich] and

[formula]

which is a consequence of Equation ([\ref=eq:XstrichUndJ1]). Moreover,

[formula]

for all [formula]. Differentiating Equation ([\ref=eq:XstrichUndJ1]) yields

[formula]

Hence,

[formula]

uniformly in [formula] by Lemma [\ref=lem:asympXstrich]. Iterating this procedure, we obtain

[formula]

and

[formula]

Equation ([\ref=eq:11-1]) is now a direct consequence. Since it is easily shown that the derivatives of

[formula]

and

[formula]

are also [formula], Equation ([\ref=eq:11-2]) follows from Equations ([\ref=eq:11-1]) and ([\ref=eq:saddle]). Further differentiation yields Equation ([\ref=eq:11-3]).

Under the assumptions of Lemma [\ref=lem:asympXstrich],

[formula]

uniformly in [formula] as n  →    ∞  .

After the work done in the previous lemmata, this is an easy corollary. The dominating terms in Equation ([\ref=eq:11-3]) have the required property.

Under the assumptions of Lemma [\ref=lem:asympXstrich],

[formula]

The lemma follows from Equation ([\ref=eq:11-2]) and Lemma [\ref=lem:asympXstrich].

The asymptotic behaviour of [formula] is determined by

[formula]

which competes with [formula] due to the different sign. If the third derivative of hn,α is to be dominated by

[formula]

more careful estimates are needed. Such estimates will be provided by Propositions [\ref=prop:hStrich] and [\ref=prop:hStrichStrich].

The exponential integral ([\cite=NIST:DLMF]) is given by

[formula]

and has the asymptotic expansion

[formula]

as x  →    ∞  .

Let [formula] such that

[formula]

and [formula] for large n. Then

[formula]

Here, pα is a non-negative function satisfying [formula].

Lemma [\ref=lem:hAbleitungen] shows that only one term is relevant for the proof of the proposition.

[formula]

The second line follows from

[formula]

and the substitution [formula] ([\cite=manstavivcius2014local]). It is a well-known fact about the harmonic numbers that

[formula]

Let

[formula]

Then

[formula]

and

[formula]

Expanding the exponential functions in the numerator of [formula] shows that

[formula]

for all [formula]. Moreover, [formula] is bounded on [formula] since [formula] and [formula].

By expanding g about [formula], the integrand in Equation ([\ref=eq:SumToInt]) becomes

[formula]

where [formula] by Taylor's theorem. An easy calculation yields

[formula]

and, by substituting [formula] and applying Equation ([\ref=eq:ExpIntAsymp]),

[formula]

Due to Equations ([\ref=eq:saddle]) and ([\ref=eq:GeomReihe]),

[formula]

Applying Equations ([\ref=eq:Integral0]), ([\ref=eq:ExpIntegral]), and ([\ref=eq:SattelExakt]) to the integral in Equation ([\ref=eq:SumToInt]), we have

[formula]

with

[formula]

Since [formula] is bounded, a calculation similar to Equations ([\ref=eq:Integral0]) and ([\ref=eq:ExpIntegral]) yields

[formula]

Finally, since by Equation ([\ref=eq:alphaLogX])

[formula]

for [formula] and

[formula]

by Equation ([\ref=eq:saddle]), we have

[formula]

and the claim is proved.

Let [formula] such that

[formula]

Then

[formula]

as n  →    ∞  .

If also [formula] for large n, then

[formula]

According to Lemma [\ref=lem:hAbleitungen] and Equation ([\ref=eq:XstrichfuerProp]),

[formula]

The last line applies the geometric series and

[formula]

which follows easily from Lemma [\ref=lem:Divergenz].

From

[formula]

and

[formula]

by Equation ([\ref=eq:GeomArith]), one may conclude that

[formula]

if [formula]. The second claim then follows.

The tools needed to prove Theorem [\ref=main_thm] are now available.

Propositions [\ref=prop:hStrich] and [\ref=prop:hStrichStrich] yield

[formula]

Since

[formula]

for x > 1, we have

[formula]

By Lemma [\ref=lem:hStrichStrichStrichAs] and Equations ([\ref=eq:alphaLogX]), ([\ref=eq:alphaXgro]), and ([\ref=eq:alphaXklei]) as well as [formula],

[formula]

uniformly in w.

Therefore, Proposition [\ref=prop:Sach] may be applied and the theorem is proved.

Equations ([\ref=eq:Erwartungswert]) and ([\ref=eq:Varianz]) show that the behavior of mn,α and vn,α changes when [formula] surpasses [formula] and becomes the dominating term. This blends in nicely with the fact that the classical uniform model has asymptotic expectation and variance of [formula].

[\cite=manstavivcius2014local] Let [formula] such that [formula] for all n. Then

[formula]

[formula]

and

[formula]

as n  →    ∞  .

The first and second parts are reformulations of assertions in Lemmata 5 and 1 in [\cite=manstavivcius2014local] from which the third part follows. The third equation is already stated in the proof of Corollary 1 in [\cite=manstavivcius2014local], albeit for a smaller range of possible α.

[\cite=manstavivcius2014local] Let

[formula]

for K > 0. If 0  ≤  z  ≤  πK, then

[formula]

This is basically Lemma 6 in [\cite=manstavivcius2014local].

Theorem [\ref=quantitative] can now be proved.

We only need to verify the asymptotics of [formula] and [formula]. Concerning [formula], by Proposition [\ref=prop:hStrich] and a substitution, the important term is

[formula]

where

[formula]

Since [formula] for n large enough ([formula] for n  →    ∞   by Lemma [\ref=lem:xiEigensch]), we can apply Lemma [\ref=lem:Tabschaetzung]. The resulting terms

[formula]

and

[formula]

(by Lemma [\ref=lem:xiEigensch]) do not contribute to the asymptotic expansion.

The integrand

[formula]

in I is strictly increasing in v. This fact, [formula] (by Lemma [\ref=lem:xiEigensch]), and

[formula]

(by Equation ([\ref=eq:DefXi])) lead to

[formula]

where the error term is again of lower order. A calculation similar to Equation ([\ref=eq:ExpIntegral]) then leads to

[formula]

so that

[formula]

follows.

As to [formula], we have

[formula]

by Taylor's theorem and Lemma [\ref=lem:xiEigensch]. The order of the error term is such that applying Equation ([\ref=eq:LogXundXminus1]) to the result in Proposition [\ref=prop:hStrichStrich] yields

[formula]

The claim follows.