Chance Constrained Optimal Power Flow with Curtailment and Reserves from Wind Power Plants

Introduction

Over the last decade, electricity production from wind power plants has reached significant levels in several regions of Europe and the United States. The forecast errors and fluctuations inherent to wind power generation has lead transmission system operators (TSOs) to reassess their reserve dimensioning policies [\cite=CAISOreserves]. In systems with large wind penetrations, such as Denmark [\cite=EnergiNet] or Ireland [\cite=EirGrid], the grid codes now require wind power plants to be able to provide active power control. These control capabilities include droop control for frequency stabilization, down-regulation of the active power output for provision of spinning reserves, capability of following an active power set-point signal and enforcing a cap on the total wind power generation [\cite=EnergiNet], [\cite=Aho].

With the above mentioned capabilities, wind power plants are able to participate in ancillary service provision, system balancing and congestion management. While increased controllability is generally improving system performance, wind power plants still differ from conventional generators in that their generation output is fluctuating and their capacity is not fully known in day-ahead operational planning due to forecast uncertainty. Therefore, if ancillary service provision from wind power plants is not planned appropriately, the use wind power control might significantly increase operational risk. For example, wind power fluctuations can render the wind power plants unable to deliver the required reserve capacities in real-time.

In this paper, we address the question of how to optimally incorporate the use of wind power control in day-ahead planning. We account for wind power variability through the use of the weighted chance constraints (WCC) developed in [\cite=CDC]. The WCC-OPF in [\cite=CDC] is an alternative to the standard Chance-Constrained OPF (CC-OPF) that limits the probability of constraint violations [\cite=maria] [\cite=line] [\cite=12BCH]. Our reason for choosing the WCC-OPF is two-fold. First, the WCCs accounts for the magnitude of constraint violation via the use of a weight function that assigns higher risk values to larger overloads. The weight function can be motivated using similar arguments as risk functions applied in risk-based OPF (e.g., [\cite=Xiao2009] [\cite=14PSCC]), although the WCC limits the expected risk (as opposed to the risk of the forecasted operating point [\cite=Xiao2009] or the worst-case risk with a given probability [\cite=14PSCC]). Second, while wind power curtailment as a reduction of the mean wind power production can easily the incorporated in a CC-OPF formulation, the use of WCCs enables us to model caps on the actual wind power output (e.g., to only curtail wind when the fluctuations are large) while maintaining convexity of the OPF formulation. Convexity is crucial to design efficient optimization algorithms for the WCC-OPF that scale well.

We review the wind power control capabilities, formulate the control policies associated with them, and incorporate them as tractable extensions to the WCC-OPF. In this paper, we model two types of wind control capabilities, a droop control policy that enables the wind power plants to provide reserves, and a control policy that enforces a cap on the maximum wind power output, while also accounting for the effect of the remaining uncertainty in the system. Leveraging the convexity of the WCC-OPF, we implement an efficient successive cutting-plane algorithm, and test our formulation on a modified version of the IEEE 118 bus system with 25 wind power plants. We quantify the benefits of each type of wind power control in terms of operational cost, system security and the amount of wind power curtailed.

The remainder of the paper is structured as follows: Section [\ref=sec:actControl] reviews the relevant control capabilities of the wind power plants. In Section [\ref=sec:OPF], the full OPF formulation is presented, with particular focus on the mathematical modeling of wind power control. The definition and handling of the weighted chance constraint is described in Section [\ref=sec:WCC]. Section [\ref=sec:CaseStudy] presents the case study, and illustrates important aspects of the developed method, while Section [\ref=sec:Conclusion] summarizes and concludes the paper.

Notations

We denote vectors by lower case letters p,ω. The components of the vectors are denoted by using subscripts, i.e, the ith component of p is denoted by pi. Matrices are denoted by upper/lower bold case letters, [formula], and [formula] denote the ith row and column of [formula], respectively. Index i refers to generators, index j to wind power plants, and index ij refers to lines.

Active power control from wind turbines

Current grid-codes in countries with significant penetration of electrical energy from wind power [\cite=EnergiNet] [\cite=EirGrid] require new installations of wind power plants to provide a variety of active power controls to stabilize the grid frequency and balance the system. In this paper, we consider the situation where the wind turbine adjusts the active power output by changing the amount of energy extracted from the wind (e.g., through pitch control [\cite=Aho]) to follow a reference signal from the TSO. While wind power plants can provide reserves in different ways, we consider the following control mechanisms to be the most suitable for system balancing and congestion management: ΔP control: The wind power plants monitors the maximum available wind power (given by the current local wind condition) and keeps the output ΔMW below the maximum. The TSO can ask the wind power plant to implement this control to, e.g., curtail excess wind energy, relieve congestion, or to keep wind power capacity available for reserve provision. Output cap: The output cap is an absolute cap on the active power provided from a single wind power plant. The wind power plant produces at maximum as long as the maximum is below the output cap. If the maximum available power exceeds the output cap, the wind power output is kept constant at the cap. The TSO can use this policy to reduce the variability of the wind power output (with a low cap, the output will essentially be constant) or to handle local transmission constraints by decreasing the peak production.

The different types of control are shown schematically in Fig. 1. Notice that the power output (red line) is always less or equal to the maximum possible production (blue line) at any given point in time. In case of reserve provision, a nominal curtailment is necessary for the turbine to be able to increase the output power in reaction to a control signal from the TSO. In the case of an output cap, any production above the cap will be curtailed. In the following, we will present a mathematical model of the two types of control, and show how they can be incorporated in an OPF formulation.

Optimal Power Flow with Wind Power Control

In this section, we provide a mathematical model that includes modeling of the wind power control described in the previous section within an OPF probabilistic constraints using the Weighted Chance Constraints. The formulation extends those in [\cite=CDC] [\cite=12BCH] by introducing two new modeling elements:

the deterministic and probabilistic constraints are now modified using additional variables representing reserves from generator and wind power plants

the generation control policies are adapted to represent the two types of wind power control capabilities.

In what follows, we will first gradually build up the objective and constraints that describe the WCC-OPF and describe each step in detail.

Network Representation

We represent the power transmission network as an undirected graph [formula], where V is the set of nodes with |V|  =  m and E is the set of edges/transmission lines of the system with |E|  =  n. The set of wind generators is denoted by W  ⊆  V. The set of non-wind generators is denoted by G  ⊆  V, and are assumed to be controllable within their limits. To simplify notation, we assume that each node of the system has one controllable regular generator with power output p, one wind generator with power output w and one load with demand d. The nodes without generation or load can be handled by setting the respective entries to zero.

System Modeling with Uncertain Wind Power in-feeds

Modeling Controlled Wind Power in-feeds

The wind in-feeds wj of an uncontrolled wind power plant is modeled as the sum of the forecasted electricity production from wind, given by [formula], and a zero mean fluctuation around the mean, given by ωj, such that

[formula]

The total wind power fluctuation is denoted by [formula]. When we introduce wind power control, the output of the wind power plant changes depending on the control policy implemented. Both the mean μ and the (distribution of the) uncertain deviation ω can be affected by the control, and we denote the new values by v and [formula] respectively. The new total wind deviation from mean is given by [formula].

Wind Power Plants with ΔP control The TSO might use ΔP control to reduce the scheduled mean power from a wind power plant j∈W to a value vj  ≤  μ. The wind power output of such plants are given by

[formula]

We assume that the wind power fluctuations [formula] are balanced through the automatic generation control (AGC), with participation factors α. For wind power plants contributing to AGC, the resulting wind power output is thus given by

[formula]

We denote the set of wind power plants providing reserves by R  ⊂  C.

Wind power plants with Output Caps With output cap control, the TSO can enforce an upper limit on the power output of individual wind power plants. In this case, the power output is given by

[formula]

where vj  ≤  μj is the mean power output and the cap [formula] is the upper bound on the wind power fluctuation. We denote the set of wind power plants with output caps by C  ⊂  W, and assume that these wind power plants do not provide reserves, i.e., [formula].

Modeling Generation Output

We assume that the regular generators participate in reserve provision, and their power output is given by

[formula]

where pi is the nominal power output set point and αi is the participation factor in balancing the wind power fluctuations.

Modeling Power Flows

The power flows on each transmission line is computed according to the standard DC approximation [\cite=wollenberg],

[formula]

The matrix [formula] relates the line flows to the nodal power injections, which are expressed as the sum of controlled generation output p̃, controlled wind power production w̃ and demand - d. The matrix [formula] is defined as

[formula]

where Bf is the line susceptance matrix and [formula] the bus susceptance matrix (without the last column and row) [\cite=maria]. We have used [formula] as the row of [formula] related to the line (ij)∈E.

Objective function

The objective of the WCC-OPF is to minimize the sum of the generation and reserve cost. This is expressed as

[formula]

The vectors c, ~ c+, ~ c- denote the cost, i.e. bids, from the generators and wind power plants for energy, up- and down reserves. The up- and down-reserves r+, ~ r- are defined as non-negative,

[formula]

and r+max, ~ r-max are upper limits that define the ability or willingness of the generators and wind power plants to provide reserves.

Power Balance Constraints

To ensure power balance, we enforce the constraint

[formula]

Since quantities p̃i and w̃i are random quantities whose values depend on the random wind fluctuation ω, the above relation must hold for all possible realizations of ω. This can be enforced by separating the nominal part (when the fluctuation is zero) and the stochastic part of [\eqref=random_power_balance]. The nominal constraint is obtained by substituting ω  =  0 in Eqs. ([\ref=deltap_output]),([\ref=cap_output]),([\ref=gen_output]) and plugging in Eq. ([\ref=random_power_balance]),

[formula]

When the wind fluctuation ω is non-zero, we must have

[formula]

From the last line it follows that to ensure power balance for every value of random wind fluctuation, it is enough to enforce the constraint

[formula]

Constraints for Line Flow Limits, Generation Limits and Reserves

What remains is to enforce generation and transmission constraints. For quantities that are functions of fluctuating wind in-feeds, we use WCCs to ensure that (a) the risk of having procured too little generation capacity, (b) the risk of wind power plants not being able to provide the contracted reserves and (c) the risk of line power flows exceeding the transmission limits, are all small in a probabilistic sense. For the sake of readability, in this section we will suppress the details of the WCCs by using a short-hand notation, and describe them in detail in the next section. More specifically, whenever we need to enforce that the risk of the quantity y() (representing e.g. a line overload ) is small, we will denote it by

[formula]

where ε represents the risk limit.

Constraints for Conventional Generators

For a conventional generator, we enforce generation limits and constraints on reserve availability in the following way: Here, [\eqref=gen_max2], [\eqref=gen_min2] enforces that the generators do not commit to providing energy and reserves that will cause them to exceed their physical minimum and maximum generation limits. Constraints [\eqref=chance_gen_min2], [\eqref=chance_gen_max2] describe the activation of reserves in reaction to the wind fluctuation [formula].They use WCCs to enforce that the risk of not having enough reserves available to cover the fluctuations remains below the risk limit εi.

Constraints for Wind Power Plants with ΔP Control

The wind power plants use ΔP control to maintain constant capacities r+, ~ r- available for reserves, similar to a conventional generator. However, for the wind power plants, we also need to ensure that the risk of the wind power plant not being able to provide the promised reserves is small, since the power output of a wind power plant is dependent on the wind realization. This can be achieved by enforcing the following chance constraints: Eq. [\eqref=wind_max2] is the nominal constraint that ensures that the scheduled power generation v and the capacity allocated for up-reserves r+ remain below the forecasted power μ. This is a deterministic constraint, since both the actual produced power and the available power will vary by ω, and ω therefore cancels out. Eq. [\eqref=wind_min2] ensures that the actual produced power vj  +  ωj is high enough to provide the expected down-reserves r+. As above, this equation is formulated as a WCC, which limits the risk εr that the wind power plant will not be able to provide the allocated reserve capacity. Constraints [\eqref=chance_wind_min], [\eqref=chance_wind_max] have the same interpretation as the corresponding constraints for the conventional generators [\eqref=chance_gen_min2], [\eqref=chance_gen_max2].

Note that the wind power plants are contracted to provide a constant amount of up and down reserves r+, ~ r-, i.e., the amount of provided reserves is not allowed to change with the available wind power. To provide up-reserves r+, the wind power plants thus curtails a constant amount 1 MW wind power to provide 1 MW up-reserves.

Constraints for Line Flow Limits

To limit the risk of transmission line overloads, we enforce the power flow constraints using WCCs, i.e., where εij is the risk limit for line overloads and pmaxij is the maximum transmission capacity of line ij.

Weighted Chance Constraints

In this section we describe the specifics of the WCCs that should replace the constraints of the form [\eqref=eq:WCC_generalform] in the previous section. We will first give a general introduction to the WCCs and describe the physical interpretation of a WCC with a linear weight function, which is adopted here. We then present analytical expressions for the WCCs with ΔP and output cap control under assumption of a normal distribution.

General Weighted Chance Constraint

The general weighted chance constraint is a constraint of the form

[formula]

where P(ω) is the multivariate distribution function of the fluctuations. The quantity y(ω) denotes the magnitude of constraint violation, and is defined differently for each type of constraint, and f(.) is the risk weighting function. For a violation of the upper or lower reserve limits [\eqref=chance_gen_min2], [\eqref=chance_gen_max2], [\eqref=chance_wind_min] and [\eqref=chance_wind_max] the magnitude of constraint violation is given by

[formula]

Similarly, violations of the availability of down reserves [\eqref=wind_min2] are defined by

[formula]

and violations of the upper and lower line flow limits by

[formula]

Whenever we have y > 0, it indicates a violation of the limit, while y < 0 implies that we are in a safe operating region. The weighting function f(y(ω)), which is nonzero only if y > 0, describes the risk related to the overload, and can be chosen in different ways. For example, [\eqref=cvar_general_1] is equivalent to a standard chance constraint if f(y) is the unit step function, i.e., 0 for y < 0 and 1 for y  ≥  0. However, the step function is not convex, which means that the standard chance constraint will not always be a convex constraint. On the other hand, as proven in [\cite=CDC], the constraint ([\ref=cvar_general_1]) is a convex for general generation control policies and general probability distributions of the wind fluctuations whenever the weight function f(.) is convex.

Using a convex risk function, which assigns a higher risk to constraint violations of larger magnitude, also makes sense from an engineering point of view, and has been applied in risk-based OPF (e.g. [\cite=Xiao2009], [\cite=Gabi2012], [\cite=14PSCC]). Note that the choice of the risk function affects the interpretation of the risk limit ε. For a weighted chance constraint with a linear weight function, which is applied here, the risk limit can can be interpreted as an upper bound on the expected constraint violation. The unit of ε in Eq. ([\ref=cvar_general_1]) is the same as for the LHS of the constraint, i.e., we define ε as an acceptable expected magnitude of overload in MW.

One main advantage of using a convex weighting function f(y) in ([\ref=cvar_general_1]) is the ability to handle more general control policies while still maintaining convexity, as shown in [\cite=CDC]. This is especially important when modeling wind power control with generation cap, since the associated policy is inherently non-affine and breaks the convexity of the standard chance constraints.

Expressions for the Weighted Chance Constraints with Linear Weight Functions with and without Cap Control

The expressions we derive for the WCC with a linear weight function assume that the line flows and generation outputs (which are weighted sums of the wind fluctuations omega) are normally distributed. While this is a relatively strong assumption, it might be justified using the Central Limit Theorem [\cite=dasgupta] in systems with a large number of wind power plants. However, the WCC can also be computed even when the distribution is not normal, although this might require more complex numerical methods for evaluation of the integrals.

Without Cap Control

When the wind fluctuation ω is a multivariate Gaussian random variable and there are no wind power plants enforcing cap control, then for each of the probabilistic constraints, the overload random variable y(ω) is normally distributed. In this case, the linear weighted chance constraint can be computed by using the expression for the expectation of a truncated normal random variable:

[formula]

and μy and σy denote the mean and standard deviation of y.

With Cap Control

When some of the wind power plants are enforcing cap control, the distribution of y is no longer normal, since the standard deviation changes when an output cap is reached. The computation of the linear weighted chance constraint thus becomes more involved. Let [formula] denote the indices of the wind power plants implementing cap control. For each of these wind power plants, we split the integral over ωC in [\eqref=cvar_general_1] into two parts, one where the fluctuation in the wind power output is below the cap C, and one where the fluctuation is above the cap, by defining the sets [formula] for [formula] and b∈{0,1} as

[formula]

Then, the linear weighted chance constraints can be computed as

[formula]

where [formula]. In the above summation, whenever bk  =  1, the corresponding ωik is larger than ik and the power output is fixed at ik. The overload y is jointly distributed along with ωC according to a multivariate Gaussian distribution. One can evaluate the integrals using efficient numerical schemes for Gaussian integration [\cite=Genz95]. For smaller values of K, it is efficient to split ([\ref=wcc_plain]) into the summation in ([\ref=wcc_specific]) and evaluate each of the terms using Gaussian quadrature integration specialized to rectangular domains. When K is large, it is more appropriate to perform numerical integration directly on Eq. ([\ref=wcc_plain]) using Monte-Carlo sampling.

We remark here that the constraints in Eq. ([\ref=wcc_specific]) are convex w.r.t. the optimization variables in the WCC-OPF, namely p,α and r, whereas the same can be shown to be non-convex for the case of standard chance constraints.

Numerical Results

Implementation of the WCC-OPF with Wind Power Control

We leverage the convexity of the WCCs to devise an efficient outer-approximation-cutting-plane algorithm, similar to the one in [\cite=12BCH]. The algorithm is implemented it in Julia language [\cite=julia] using JuMP [\cite=jump]. At each step, a Linear Program (LP) corresponding to an outer approximation of the feasible set is solved. The outer approximation is progressively tightened by adding tangential cutting-planes to the convex WCCs that eliminate the current infeasible solution. Each successive Linear Program is warm started using the solution of the previous one.

Since the constraints and gradients for the WCC-OPF with cap control must be evaluated using numerical integration methods, it is desirable to reduce the number of function evaluations corresponding to these integrals. The cutting-planes algorithm accomplishes this by selectively evaluating the gradients only for the violated constraints, and shifting most of the computations over to the Linear Programming Solver.

Case Study

We base our study on the IEEE 118-bus system as provided with Matpower 4.1 [\cite=matpower], with a few modifications as follows. For the generator bids for energy and reserves c, ~ c+, ~ c-, we use the linear cost coefficients. For wind power plants, we assume zero marginal cost, and set cj = c+j = c-j = 0. Although the formulation could be extended to include unit commitment, it is not considered here. Therefore, the minimum generation output of the conventional generators is set to zero. To obtain a more stressed system state, we increase the load by a factor of 1.25 and descrease the transmission limits by 0.75. Wind power plants are located at 25 different buses throughout the system. Their locations, forecasted power output and correlation matrix can be found in [\cite=118BusWindData]. The standard deviation of each wind power plant is set to 10% of the forecasted power output. When considering different levels of wind power penetration, both the forecasted power output and the standard deviations are scaled by a factor of

[formula]

where X = {25, ~ 50, ~ 75, ~ 100, ~ 125} denotes the percentage of forecasted wind power relative to the total system load. The risk limits for all WCCs were set to ε = 0.1 MW. With the cutting-plane algorithm described above, a solution to the WCC-OPF for the 118 bus system is obtained within a couple of minutes on a laptop.

Impact of Reserve Provision from Wind Power Plants

We compare the cases when the wind power plants using ΔP control can (a) only curtail their mean as in Eq. [\eqref=wind_v] and (b) the curtailed energy can be used to provide reserves as in Eq. [\eqref=deltap_output]. Figure [\ref=fig_comparison_cost] shows the total cost, cost of generation and cost of reserves for the two cases without and with wind power reserves under various levels of wind penetration, and Figure [\ref=fig_comparison_wind] shows the total amount of generation and reserves provided by both conventional generators and wind power plants.

As one might expect, the total cost is lower when the wind power plants are providing reserves. This difference is especially amplified when the system has higher wind penetration, and a large fraction of the cost difference is attributed to a higher cost of reserves. With high wind penetration, there is significantly more uncertainty in the system, and without (zero cost) wind power reserves, a large amount of reserves must be bought from conventional generators to balance fluctuations.

Additionally, in the case without wind power reserves, the nominal generation cost is also higher. As observed in Figure [\ref=fig_comparison_wind], the generators must run at a higher nominal set-point p in order to be able to provide enough down reserve r-, particularly during high wind penetrations. Thus, the wind power nominal set points v must be lowered, leading to under-utilization of available cheap wind power.

The effect of wind power control through output caps

In this section, we investigate the benefits of output cap control on wind power plants. We enable output cap control for the wind power plants at bus 85 and bus 117, since these have particularly large values of means and standard deviation, and allow the rest of the wind power plants to provide reserves according to Eq. [\eqref=deltap_output]. We compare this with the case when no wind power plants have output caps, but all are able to provide reserves (including bus 85 and 117). Figure [\ref=fig_cost_with_cap] shows the cost with cap control relative to the case without cap control, for various values of the cap threshold i in Eq. ([\ref=cap_output]). Around the cap threshold values of ( - 45MW, - 45MW), the total cost is minimized, and is significantly lower (~   - 6%) than the case without caps but with reserves. The cost increases as we move away from this band.

To explain the trend in cost, we first investigate the effect of the cap threshold on the power output of the two wind power plants on bus 85 and 117. In Figure [\ref=fig_ExpCur_StdDev], the expected amount of wind power curtailment (left) and the standard deviation (right) for each power plant is shown as a function of the output cap on the left. Note that, while the output caps are the same for both wind power plants, their nominal standard deviations (without caps) are different, which leads to different values for the expected curtailment and the standard deviation. When the cap thresholds are lowered, the amount of utilized wind power drops due to higher expected curtailment. However, the standard deviation of the wind power output also drops significantly, which reduces wind power variability and thus the requirement for reserves.

To investigate how this trade-off influences the cost in more detail, we look at the total wind power used for generation, the total system reserves and the total wind energy curtailment (which includes both "wasted" energy and energy curtailed to provide reserves). These values are plotted for different pairs of output caps in Figure [\ref=fig_comparison].

With low output caps ( - 75, - 75), higher wind curtailment outweighs the benefits of reduced reserve requirements compared to case with the optimal output caps ( - 45, - 45). As the output caps increase, the total system reserve requirements also increase, and reaches the highest value for the case without output caps. At the same time, we observe a decrease in the use of wind power for nominal energy production, since more of it must be allocated for reserves.

Th lowest utilization of wind for energy production happens with output caps of ( + 75, + 75), which is observed to be the point with highest cost in Figure [\ref=fig_cost_with_cap]. In this case, high wind power variability and no possibility of procuring wind power reserves at buses 85 and 117 leads to an increased curtailment of the mean wind power v at those buses.

In the case with output caps ( + 45, + 45), the total wind power generation is lower than in the case without output caps. Still, the total cost of the solution is approximately 1% lower with caps ( + 45, + 45) than without caps as observed in Figure [\ref=fig_cost_with_cap]. This is because the output caps reduces variability and thus the risk of overload on some critical transmission lines, which allows for better utilization of the transmission capacity and dispatch of cheaper conventional generators.

Summary and conclusions

In this paper, we investigate two types of wind power control capabilities, ΔP control which reduces the mean power output by a constant value and allows the wind power plants to provide reserves, and output cap control which enforces a hard threshold on the total power output. The corresponding control and reserve models are developed and incorporated into an Optimal Power Flow formulation with Weighted Chance Constrains, which allows for controlling the risk of overloads due to wind fluctuations. Based on a case study on the IEEE 118 bus system, we observe that using ΔP control with wind reserves provides substantial cost benefits. For wind power plants with high variability, the output cap control is shown to outperform ΔP control with reserves.