A Unified Statistical Approach to Modeling the Shape of Human Hyoid Bones in CT Images

Introduction

For normally developing children, age and gender could be major factors that affect the functions and structures of growing hyoid bone. As in other developmental studies [\cite=chung.2003.ni] [\cite=vorperian.2011], we expect highly localized complex growth pattern to emerge between ages 0 and 20 in the hyoid bone. It is expected the growth to be outward with respect to the surface of the bone. However, it is unclear what specific parts of the hyoid bone are growing. This provides a biological motivation for a need to develop a local surface-based morphometric technique beyond simple volumetric techniques that cannot detect localized subtle anatomical changes along the hyoid bone surface.

The end results of existing surface-based morphometric studies in medical imaging are statistical parametric maps (SPM) that shows statistical significance of growth at each surface mesh vertex [\cite=chung.2003.ni] [\cite=qiu.2008] [\cite=xu.2008]. In order to obtain stable and robust SPM, various signal smoothing and filtering methods have been proposed. Among them, diffusion equations, kernel smoothing, and wavelet-based approaches are probably most popular. Diffusion equations have been widely used in image processing as a form of noise reduction starting with Perona and Malik in 1990's [\cite=perona.1990]. Although numerous techniques have been developed for performing diffusion along surfaces [\cite=chung.2003.cvpr] [\cite=andrade.2001] [\cite=tang.1999] [\cite=sochen.1998] [\cite=malladi.2002] [\cite=taubin.2000], most approaches are nonparametric and requires finite element or finite difference schemes which are known to suffer various numerical instabilities [\cite=chung.2005.IPMI].

Kernel smoothing based models have been also proposed for surface and manifolds data [\cite=belkin.2006] [\cite=chung.2005.IPMI]. The kernel methods basically smooth data as weighted average of neighboring mesh vertices using mostly a Gaussian kernel and its iterative application is supposed to approximates the diffusion process. Recently, wavelets have been popularized for surface and graph data. Spherical wavelets have been used on brain surface data that has been mapped onto a sphere [\cite=nain.2007] [\cite=bernal.2008]. Since wavelet basis functions have local supports in both space and scale, the wavelet coefficients from the scale-space decomposition using the spherical wavelets provides shape features that describe local shape variation at a variety of scales and spatial locations. However, spherical wavelets have an intrinsic problem that they require to establish a smooth mapping from the surface to a unit sphere, which introduces a serious metric distortion. The spherical mapping such as conformal mapping introduces serious metric distortion which usually compounds SPM. Furthermore, such basis functions defined on sphere seem to be suboptimal rather than those directly defined on anatomical surface, in detecting locations or scales of shape variations. To remedy the limitation of spherical wavelets, spectral graph wavelet transform defined on a graph has been applied to arbitrary surface meshes by treating surface meshes as graphs [\cite=antoine.2010] [\cite=hammond.2011] [\cite=kim.2012.NIPS]. Wavelet transform is a powerful tool decomposing a signal or function into a collection of components localized at both location and scale. Although all three methods (diffusion-, kernel- and wavelet-based) look different from each other, it is possible to develop a unified framework that relates all of them in a coherent statistical fashion.

Starting with a symmetric positive definite kernel, we propose a novel unified kernel regression framework within the Hilbert space theory. The proposed kernel regression works for any symmetric positive definite kernel, which behaves like weights between two functional data. We show how this facilitates a coherent statistical inference for functional signals defined on an arbitrary manifold. The outline of this paper is as follows. (i) First, we present a unified bivariate kernel regression that is related to diffusion-like equations. (ii) We establish the relationship between the kernel regression and recently popular spectral graph wavelets for manifolds. The proposed kernel regression is shown to be equivalent to the wavelet coefficients. This mathematical equivalence levitates a need for constructing wavelets using a complicated computational machinery as often done in previous diffusion wavelet constructions [\cite=antoine.2010] [\cite=hammond.2011] [\cite=kim.2012.NIPS]. (iii) A unified statistical inference framework is developed for neuroimaging applications by linking the kernel regression to the random field theory [\cite=taylor.2007] [\cite=worsley.2004]. (iv) Subsequently, we illustrate how the kernel regression procedure can be used to localize the hyoid bone growth pattern in human.

Preliminary

First, let us illustrate two statistical problems in an Euclidean space that motivate the development of the proposed kernel regression in manifolds. Consider measurements fi sampled at [formula]. The measurements are usually modeled as

[formula]

with some noise εi and unknown mean function h that has to be estimated. In the well known local polynomial or kernel regression frameworks [\cite=belkin.2006] [\cite=fan.1996] [\cite=oztireli.2009], a univariate kernel G(p) is introduced to minimize the weighted least squares of the form

[formula]

Often Gaussian kernels are used for G. In many related local polynomial or kernel regression frameworks, kernel G and polynomial basis pj are translated by the amount of pi in fitting the data locally. In this fashion, at each data point pi, exactly the same shape of kernel and distance are used. However, one immediately encounters a difficulty of directly generalizing the Euclidean formulation ([\ref=eq:localpolynomial2]) to an arbitrary surface since it is unclear how to translate the kernel and basis in a coherent fashion.

A similar problem is also encountered in wavelets in a Euclidean space. Consider a wavelet basis Wt,q(p) obtained from a mother wavelet W with scale and translation parameters t and q:

[formula]

Scaling a function on a surface is trivial. But the difficulty arises when one tries to define a mother wavelet and translate it on a surface. It is not straightforward to generalize the Euclidean formulation ([\ref=eq:Wtq]) to an arbitrary manifold. To remedy these two different but related problems, we propose to use a bivariate kernel and bypass the problem of translating a univariate kernel. By simply changing the second argument, it has the effect of translating the kernel.

Methods

In many anatomical studies in CT, measurements are sampled densely at the resolution 0.5mm or less so it is more practical to model the measurements as functions. Consider a functional measurement f defined on a manifold [formula]. We assume the following additive model:

[formula]

where h is the unknown signal and ε is a zero-mean random field, possibly Gaussian. The manifold M can be a single connected or multiple disjoint components as our hyoid bone application. We further assume f∈L2(M), the space of square integrable functions on M with the inner product

[formula]

where μ is the Lebesgue measure. Define a self-adjoint operator L satisfying

[formula]

for all g1,g2∈L2(M). Then L induces the eigenvalues λj and eigenfunctions ψj on M:

[formula]

Without loss of generality, we can order the eigenvalues [formula] The eigenfunctions ψj form an orthonormal basis in L2(M). Then from Mercer's theorem [\cite=conway.1990], any smooth symmetric positive definite kernel on manifold M can be written as

[formula]

for some τj. The constants τj are identified as follows. Apply the kernel convolution on the eigenfunction ψj:

[formula]

Substituting ([\ref=eq:Kpq11]) into ([\ref=eq:Kf1]), we have K * ψj(p)  =  τjψj(p) indicating τj and ψj must be the eigenvalues and eigenfunctions of the convolution ([\ref=eq:Kf1]). However, the relationship between the two different sets of eigenvalues λj and τj is not yet given but will be shown shortly afterward.

Proposed kernel regression

Consider subspace Hk  ⊂  L2(M) spanned by the orthonormal basis {ψj}, i.e.

[formula]

We estimate h by minimizing the weighted distance to the space Hk:

[formula]

Without loss of generality, we will assume the kernel to be a probability distribution so that

[formula]

for all p∈M. The solution of ([\ref=eq:HKregression]) has the following analytic expression:

[formula]

where fj  =  〈f,ψj〉 are Fourier coefficients.

Proof. See the Appendix. Theorem [\ref=theorem:kernel1] generalizes the spherical regression on a unit sphere to an arbitrary manifold [\cite=chung.2008.sinica]. Theorem [\ref=theorem:kernel1] implies that the kernel regression can be performed by simply computing the Fourier coefficients fj  =  〈f,ψj〉 without doing any numerical optimization. The numerically difficult optimization problem is reduced to the problem of computing Fourier coefficients. If the kernel K is a Dirac-delta function, the kernel regression simply collapses to the least squares estimation (LSE) which results in the standard Fourier series, i.e.

[formula]

It can be also shown that as k  →    ∞  , the kernel regression

[formula]

converges to convolution K * f establishing the connection to the manifold-based kernel smoothing framework [\cite=belkin.2002] [\cite=chung.2005.IPMI]. Hence, asymptotically the proposed kernel regression should inherit many statistical properties of kernel smoothing.

Properties

The kernel regression can be shown to be related to the following diffusion-like Cauchy problem.

For an arbitrary self-adjoint differential operator L, the unique solution of the following initial value problem

[formula]

is given by

[formula]

Proof. See the Appendix. For a particular choice of kernel K with τj  =  e-  λjt, the proposed kernel regression [formula] should converge to the solution of the diffusion-like equation. If we let L be the Laplace-Beltrami operator, ([\ref=eq:cauchy2]) becomes an isotropic diffusion equation as a special case and we are then dealing with heat kernel

[formula]

which is often explored mathematical objects in various fields [\cite=belkin.2002] [\cite=chung.2005.IPMI].

In order to construct wavelets on an arbitrary graph and mesh, diffusion wavelet transform has been proposed recently [\cite=antoine.2010] [\cite=hammond.2011] [\cite=kim.2012.NIPS]. The diffusion wavelet construction has been fairly involving so far. However, it can be shown to be a special case of the proposed kernel regression and the proposed method is substantially simpler to construct. Following the notations in [\cite=antoine.2010] [\cite=hammond.2011] [\cite=kim.2012.NIPS], diffusion wavelet Wt,p(p) at position p and scale t is given by

[formula]

for some scale function g. If we let τj  =  g(λjt), the diffusion wavelet transform is given by

[formula]

which is the exactly kernel regression we introduced. Hence, the diffusion wavelet transform can be simply obtained by doing the kernel regression without an additional wavelet machinery [\cite=kim.2012.NIPS]. Further, if we let g(λjt)  =  e-  λjt, we have

[formula]

which is a heat kernel. The bandwidth t of heat kernel controls resolution while the translation is done by shifting one argument in the kernel.

Although the kernel regression is constructed using global basis functions ψj, the kernel regression at each point p coincides with the diffusion wavelet transform at that point. Hence, just like wavelets, the kernel regression will have the localization property of wavelets. This is demonstrated in a toy example in Figure [\ref=fig:midus-gibbs] with a hat-shaped surface in 3D. The hat-shaped step function is simulated as z = 1 for x2  +  y2  <  1 and z = 0 for 1  ≤  x2  +  y2  ≤  2. Then the step function is reconstructed using the Fourier series expansion via LSE (top) and kernel regression (bottom). In the both cases, up to 7225 basis functions were used. For the kernel regression, the heat kernel with bandwidth t = 0.0001 is used. LSE clearly shows the visible Gibbs phenomenon, i.e., ringing artifact [\cite=chung.2007.TMI] [\cite=gelb.1997] compared to the kernel regression.

Numerical Implementation

The Laplace-Beltrami operator is chosen as the self-adjoint operators L of choice. The eigenfunctions of the Laplace-Beltrami operator on an arbitrary curved surface is analytically unknown. So it is necessary to discretize ([\ref=eq:eigen]) using the Cotan formulation as a generalized eigenvalue problem [\cite=zhang.2007] [\cite=qiu.2006]:

[formula]

where [formula] is the stiffness matrix, [formula] is the mass matrix and [formula] is the eigenfunction evaluated at n mesh vertices. Once we obtained the basis functions ψj, the corresponding Fourier coefficients βj are estimated as

[formula]

where [formula] and [formula] [\cite=zhang.2007]. Figure [\ref=fig:2_md_eigfs] shows few representative LB-eigenfunctions on the hyoid surface. For heat kernel regression, we used the bandwidth σ = 5 and 500 LB-eigenfunctions on the final template. The number of eigenfunctions used is more than sufficient to guarantee relative error less than 0.3% in our data.

Statistical Inference

We are interested in determining the significance of functional signals on a manifold [\ref=fig:agegrouping]. We borrow the statistical parametric mapping (SPM) framework for analyzing and visualizing statistical tests performed on the template surface that is often used in brain image analysis [\cite=andrade.2001] [\cite=lerch.2005.ni] [\cite=wang.2010] [\cite=worsley.1995] [\cite=yushkevich.2008]. Since test statistics are constructed over all mesh vertices on the surface, multiple comparisons need to be accounted. For continuous functional data, the random field theory [\cite=taylor.2007] [\cite=worsley.1995] [\cite=worsley.2004] is natural to use. The random field theory assumes the measurements to be smooth Gaussian random field. Heat kernel regression will make the data more smooth and Gaussian as well as increase the signal-to-noise ratio [\cite=chung.2005.ni].

Consider a functional measurements [formula] on manifold M. In the simplest statistical setting, the measurements can be modeled as

[formula]

where h is an unknown group level signal and εi is a zero-mean Gaussian random field [\cite=worsley.2004]. At each fixed point p, we are assuming εi  ~  N(0,σ2).

We are interested in determining the significance of h, i.e.

[formula]

Note that any point p0 that gives h(p0)  >  0 is considered as signal. The hypothsis ([\ref=eq:hypothesis]) is an infinite dimensional multiple comparisons problem for continuously indexed hypotheses over the manifold M. The underlying group level signal h is estimated using the proposed heat kernel regression. Subsequently, a test statistic is given by a T-field T(p) or a F-field, which is simply given by the square of the T-field [\cite=worsley.2004] [\cite=worsley.1995].

For sufficiently high threshold z, the corrected type-I error of testing hypothesis ([\ref=eq:hypothesis]) is given by

[formula]

where μd(M) is the j-th Minkowski functional or intrinsic volume of M and ρj is the j-th Euler characteristic (EC) density of T-field. Since the hyoid bone is compact with no boundary but has three disconnected components, the Minkowski functionals are simply

[formula]

The term μ1 is zero since there is no boundary and μ0 is simply the Euler characteristic of the template surface. Note that the Euler characteristic of a closed surface with no hole or handle is 2 and there are three such surfaces. The EC-densities of the T-field with ν degrees of freedom is given by

[formula]

The EC-density of the F-field is similarly given in [\cite=worsley.2004] [\cite=taylor.2007]. The EC-density has the kernel bandwidth 2t2 in the formulation so the inference is done at a particular smoothing scale. Figure [\ref=fig:powerplot] shows the type-I error plot over different bandwidth t of the kernel regression in our application. As the bandwidth t becomes zero, the type-I error increases. When t = 0, the kernel regression collapse to the usual Fourier series expansion. Note that the Fourier expansion with 500 LB-eigenfunctions is close to the original data without any smoothing. Hence, the proposed kernel regression can be viewed as having substantially smaller type-I error compared to the Fourier series expansion as well as the original data demonstrating a better statistical performance.

Type-II error and the statistical power can be also computed similarly.

The statistical power P of testing the hypotheses

[formula]

using the T random field T(p) is given by

[formula]

where t*α is the α-quantile given by

[formula]

Proof. See the Appendix.

Application

CT Imaging Data and Preprocessing

The study consists of high resolution CT images of 70 normal subjects ages between 0 and 20 years (mean age =   58.0 ±   11.3 years). CT scans were converted to DICOM format and Analyze 8.1 software package (AnalyzeDirect, Inc., Overland Park, KS) was then used in segmenting binary hyoid bone images by a trained individual rater in the native space by simple image intensity thresholding and careful manual editing. A nonlinear image registration using the diffeomorphic shape and intensity averaging technique with cross-correlation as similarity metric was performed through Advanced Normalization Tools (ANTS) [\cite=avants.2008]. A study-specific template was constructed. We have chosen a 12 year old subject identified as F155 as the initial template and aligned the remaining 69 hyoids to the initial template affinely to remove the overall size variability. Some subject may have larger hyoid than others so it is necessary to remove the global size differences in local shape modeling. From the affine transformed individual hyoid surfaces, we performed the diffeomorphic nonlinear image registration to the template using ANTS.

Then by averaging the inverse deformation fields from the initial template to individual hyoid, we obtain the yet another final template. Figure [\ref=fig:template] shows the initial and final templates. The isosurface of the final template volume is extracted using the marching cube algorithm [\cite=lorensen.1987]. Figure [\ref=fig:agegrouping] shows the mean displacement differences between the groups I and II (top) and II and III (bottom). Each row shows the group differences of the displacement: group II - group I (first row) and group III - group II (second row). The arrows are the growth direction given by the mean displacement differences and colors indicate their lengths in mm. We are interested in localizing the regions of hyoid bone growth between the age groups.

70 subjects are binned into three age categories: ages between 0 and 6 years (group I), between 7 and 12 years (group II), and between 13 and 19 years (group III). There are 26, 14 and 30 subjects in group I, II and III respectively. The main biological hypothesis of interest is if there is any localized hyoid bone growth spurts between these specific age groups.

Results

The displacement from the template to an individual surface is obtained at each mesh vertex. Since the length measurement provides a much easier biological interpretation, we used the length of displacement vector as a response variable among many other possible features. Since the length on the template surface is expected to be noisy due to image acquisition, segmentation and image registration errors, it is necessary perform the proposed kernel regression and subsequently reduce the type-I error and obtain more stable SPM. Figure [\ref=fig:wavelets] shows an example of kernel regression on our data. The kernel regression increases the signal-to-noise ratio (SNR) and improves the smoothness and Gaussianness of data. Subsequently, the heat kernel regression of the displacement length is taken as the response variable. We have chosen t = 5 as the bandwidth for the study since the bandwidth 5 is where the type-I error starts to flatten out in Figure [\ref=fig:powerplot]. Note that the Fourier expansion with 500 LB-eigenfunctions is close to the original data (relative error of less than 0.3%). Hence, performing the proposed kernel regression before the statistical analysis can substantially smaller type-I error demonstrating its effectiveness.

After the displacement lengths are smoothed, we constructed the F-field, or equivalently the T-field square, for testing the length difference between the age groups I and II, II and III, and I and III showing the regions of growth spurts between different age range (Figure [\ref=fig:surfGLM]). Since test statistics are constructed over all mesh vertices on the mandible, multiple comparisons were account using the random field theory [\cite=worsley.1995] [\cite=worsley.2004].

For testing the differences between the groups I and II, II and III, and I and III, they are based on F-field with 1 and 38, 1 and 42, and 1 and 54 degrees of freedom respectively. The result is displayed in Figure [\ref=fig:surfGLM], where the significant results were only found between the groups II and III (middle), and I and III (bottom) at 0.1 level. Between the groups II and III, we obtained the maximum F-statistic value of 9.36 (right hyoid), which corresponds to the p-value of 0.041 (corrected). Between the groups I and III, we obtained the maximum F-statistic value of 10.55 (middle hyoid), which corresponds to the p-value of 0.028 (corrected). In the F-statistic maps for middle and bottom rows, red regions are considered as exhibiting significant growth spurts.

Conclusion

We have developed a new kernel regression framework on a manifold that unifies bivariate kernel regression, heat diffusion and wavelets in a single coherent mathematical framework. The kernel regression is both global and local in a sense it uses global basis functions to perform regression but locally equivalent to diffusion wavelet transform. The proposed framework is demonstrated to reduce type-I error in modeling shape variations compared to the usual Fourier series expansion. The method is then used in developing a statistical inference procedure for functional signals on manifolds. The whole framework

Acknowledgment

This work was supported by NIH Research Grant R01 DC6282 (MRI and CT Studies of the Developing Vocal Tract), from the National Institute of Deafness and other Communicative Disorders (NIDCD); core grant P-30 HD03352 to the Waisman Center from the National Institute of Child Health and Human Development (NICHHD) and Clinical and Translational Science Award (CTSA) program, through the NIH National Center for Advancing Translational Sciences (NCATS) UL1TR000427

Appendix

Theorem 1

[formula]

Proof. Any function h∈Hk can be expressed as

[formula]

Then by plugging ([\ref=eq:hp]) into the inner integral I(p), it becomes

[formula]

Simplifying the expression, we obtain

[formula]

From Mercer's theorem [\cite=conway.1990], the kernel can be written as

[formula]

The convolution is then written as

[formula]

Since I is an unconstrained positive semidefinite quadratic program (QP) in βj, there is no unique global minimizer of I without additional linear constraints. Integrating I further with respect to dμ(p), we collapses ([\ref=eq:QP]) to a positive definite QP, which yields a unique global minimizer:

[formula]

The minimum of the above integral is obtained when all the partial derivatives with respect to βj vanish, i.e.

[formula]

for all j. Hence [formula] must be the unique minimizer. [formula]

Theorem 2. For an arbitrary self-adjoint differential operator L, the unique solution of the Cauchy problem

[formula]

is given by

[formula]

Proof. For each fixed t, g(p,t) can be written as

[formula]

Then

[formula]

Substituting ([\ref=eq:expansion]) and ([\ref=eq:expansion2]) into ([\ref=eq:cauchy1]), we obtain

[formula]

for all j. The solution of equation ([\ref=eq:ODE]) is given by cj(t)  =  bje-  λjt. So we have a solution

[formula]

At t = 0, we have

[formula]

The coefficients bj must be the Fourier coefficients, i.e.

[formula]

Theorem 3. The statistical power P of testing the hypotheses

[formula]

using the T random field T(p) is given by

[formula]

where t*α is the α-quantile given by

[formula]

Proof. In the region M0 corresponding to H0,

[formula]

In the region M1 corresponding to H1,

[formula]

Figure [\ref=fig:poweranalysisJ0] illustrates this setting.

Consider the test statistic

[formula]

where [formula] and S are the sample mean and standard deviation of the measurements [formula]. In M0, T(p) is a T random field with n - 1 degrees of freedom [\cite=adler.1981]. In M1, T(p) can be written as

[formula]

where T'(p) a T random field with n - 1 degrees of freedom. Since σ is usually estimated using the standard deviation, approximately we have S(p)  =  σ and the test statistic becomes

[formula]

At each fixed p, T(p) is no longer a T random field but a non-central T random field [\cite=hayasaka.2007]. Subsequently the power P at the given α-level is given by

[formula]

where t*α is the α-quantile of sup p∈MT(p) under H0, i.e.

[formula]

Although ([\ref=eq:Tdiff]) is intractable to directly compute, we will approximate ([\ref=eq:supP]) using the expected Euler characteristic (EC) method [\cite=worsley.1996] [\cite=worsley.2003]. The power ([\ref=eq:supP]) can be written as

[formula]

where μd(M) is the j-th Minkowski functional or intrinsic volume of M and ρj is the j-th EC-density of T-field [\cite=worsley.1998] [\cite=adler.1981] [\cite=taylor.2007] [\cite=worsley.2003]. The expansion only works for sufficiently large [formula]. For small threshold, the power may not be bounded between 0 and 1. So it is necessary to use the exponential transform used in [\cite=hayasaka.2007] to bound the power. For small P(n), using the Taylor expansion, we can write

[formula]

Equivalently, it is written as

[formula]

This transformation guarantees the power estimation to be bound between 0 and 1 [\cite=hayasaka.2007]. Subsequently, the power is given by

[formula]