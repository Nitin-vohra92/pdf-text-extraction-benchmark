Remark Lemma Theorem Corollary Conjecture Definition

Reinforcement learning in social networks

Introduction

We introduce and analyse a model of network formation, based on one hand on a reciprocity condition - we can talk to somebody only if he conversely wants to talk to us - and on the other hand on a reinforcement learning procedure - we want to talk more to the ones we already talked to frequently.

Start with a weighted graph [formula], where the vertices in [formula] represent people, and nonoriented edges in E represent links between them.

Let [formula] be a collection of nonnegative real numbers such that, for any [formula], aij = aji, and if aij > 0 then {i,j}∈E; aij represents the affinity between i and j. Let the network [formula] be the graph G with weights A.

Now consider the following game on the network GA, whose players are the vertices of G. The game is played in infinitely many rounds (one at each time step), and each of them consists in the following procedure:

each vertex [formula] chooses one, and only one, of its neighbours j  ~  i;

Nature independently picks a subset [formula] of vertices, allowed to communicate;

if i, j ∈V are neighbours, i.e. i  ~  j, and if i and j mutually choose each other, then a communication occurs between them and they both receive a payoff equal to their affinity aij.

We model the choice by Nature of the set of vertices which are allowed to communicate at each time step by random independent identical Bernoulli distributions on the set of subsets of [formula], denoted by [formula].

More precisely, we let [formula] be a family of nonnegative real numbers such that

[formula]

and assume that the sequence of subsets [formula] chosen by Nature at time [formula] is an i.i.d. sequence of Bernoulli random variables with probability [formula].

Note that, given any two adjacent vertices [formula], i  ~  j,

[formula]

is the probability that i and j are both allowed to communicate by Nature at any time step. By convention, we fix pij = 0 when [formula]. The numbers aijpij, i  ~  j, will be important in the results. In general the nonoriented edges {i,j} are not chosen independently of each other by Nature.

Let us describe three noticeable choices of [formula].

The most obvious one is [formula], and pV = 0 if [formula], where any adjacent pair of vertices is allowed to communicate together at any time.

Another natural choice is that of a sequence [formula], such that [formula] if and only if (iff) [formula] for some [formula]: at each time step only one particular (random) vertex i and its neighbours are allowed by Nature to communicate together.

The third choice is that of a signaling game, on which the same reinforcement learning procedure was studied in [\cite=HST]. Let S1 and S2 be two disjoint subsets spanning [formula], i.e. [formula], [formula]. Then assume [formula] iff [formula] for some i∈S1. Then pij > 0 only if i∈Sp, j∈Sq, p, q ∈{1,2}, p  ≠  q. In other words the graph on which communications occur is bipartite in this case, see Figure [\ref=bipartite]. In [\cite=HST], the bipartite graph is complete, and it is assumed that pVi = 1 / M1, where M1 is the number of vertices in S1, but the condition is not required in the current paper.

The game being defined, let us now describe how the individuals pick each other. The model we consider here is reinforcement learning, a trial-and-error procedure in which agents are more likely to use the strategies that have given more payoff before, which in our case means that, the more an agent has already talked to somebody, the more he will be likely to again talk to him. At each round, each vertex will choose one of its neighbours with a probability that is proportional to the payoff they shared together so far.

More precisely, for all [formula], let us define the cumulative payoff Vnij (resp. Vni) on the edge {i,j} (resp. vertex i) at time n by

[formula]

where v0ij is a nonnegative constant such that v0ij > 0 iff i  ~  j, and Nnij is the number of communications that succeeded between i and j at time n. If [formula], we set Vnij = 0 for all n. Note that we could have i  ~  j (so that v0ij > 0) but aij = 0, in which case Vnij = v0ij for all n.

Now we assume that, at each time step, any vertex [formula] chooses one of its neighbours j with probability

[formula]

By symmetry, j also chooses i among its neighbours with probability

[formula]

Let F: = (Fn)n be the filtration generated by the process, i.e

[formula]

Then, the probability of a communication through an edge ij∈E is

[formula]

and the communication is considered to be successful if Vn + 1ij = Vnij + aij and aij > 0.

We have now described our learning procedure of the network game. Observe that reinforcement learning is one of a number of models of strategic learning in games, in which players adapt their strategies, with the (possibly unconscious) aim to eventually maximize their payoffs, amongst for instance no-regret learning, fictitious play and its variants, and hypothesis testing, see [\cite=young:2005].

In the spectrum of adaptive procedures, reinforcement learning certainly does not provide an optimal strategy, and rather assumes that players have bounded rationality. In particular they do not need to know which game the other agents are playing, or which strategies they are playing. It is therefore attractive as a simple behavioral model, since it does not require the agents to be entirely devoted to their task and, in our setting, even to be aware that they are involved in the formation of a network, but on the contrary just to observe their effective payoffs. Moreover it accumulates inertia, since the relative increase in payoff decreases in time, which would make it more stable with respect to randomness of the payoffs for instance, and in general avoid instability of the strategies.

Models of network formation using reinforcement learning were already proposed by Pemantle and Skyrms [\cite=RPBS] as follows: each day, each individual chooses one of his neighbours and talks to him, the communication being always accepted by the neighbour; then both of them reinforce the probability to talk to each other. An important difference is that, in our model, a reciprocity assumption is made, in the sense that the communication is not necessarily accepted by the chosen neighbour. A similar model, with strong reinforcement, has been proposed by Van der Hofstad et al. in the context neural network formation, see [\cite=vdH].

Let us now summarize the results obtained in this paper, which are described in more detail in Section [\ref=sect_th]. As explained above, the network game model can be seen as a generalisation of the signaling game [\cite=Sky10], on which the same reinforcement learning procedure was analyzed by Hu, Skyrms and Tarrès [\cite=HST]. Our results are generalisations of the ones in [\cite=HST], and the proofs adapt their techniques to a more general setting.

The main tools are stochastic approximation techniques. In particular, we will approach the behavior of some stochastic process by a deterministic ordinary differential equation (ODE), with the difficulty that the function governing the ODE is not continuous on the boundary of the simplex on which it is defined. One could instead show that the process, with a different system of coordinates, approximates a smooth dynamics, but it would then take place in an unbounded domain, which would lead to other technical difficulties (see Section [\ref=sect_bord]).

First, we prove that there is a Lyapunov function for the deterministic ODE, which enables us to deduce in Theorem [\ref=th_pot] the a.s. convergence of the expected payoff of the random dynamics. Then we prove in Theorem [\ref=th_eq] that the occupation measure of the communications converges a.s. to the set of equilibria of the ODE.

In Proposition [\ref=Prop:unstable0], we show a property which characterizes the stable equilibria of the ODE: if we define the limit graph as the non-oriented subgraph on which edges are pairs of vertices communicating successfully infinitely often, the connected components of this limit graph are star-shaped components, in other words core and shell (see Figure [\ref=stab_conf]), satisfying furthermore a balance condition on the affinities aij and probabilities pij. In particular each connected component contains a nucleus vertex linked to (one or several) satellite vertices which are only linked to the nucleus.

In Theorem [\ref=th_posprob] we prove that any graph correspondence with the preceding property, such that no vertex is falling out of use (see Section [\ref=sect_th] for a precise definition), is a limit configuration with positive probability.

Main results

We let [formula] denote a positive constant depending only on a1, a2, [formula] ap, and let [formula] denote a universal positive constant.

Given two real functions f and g defined on a set D, we write f = O(g) iff there exists a constant C > 0 such that [formula] for all x∈D.

First, notice that if there is no [formula] such that aijpij > 0, then we are the trivial case where no successful communication can ever occur hence the system is just frozen in its initial configuration. Therefore, we assume that there exist [formula] such that aijpij > 0 for the rest of the paper.

For all [formula], define:

[formula]

Let [formula] be the occupation measure at time n. Note that [formula]. Moreover, it is straightforward to see that for all [formula], j  ~  i, with aijpij = 0, we have Vnij = v0ij a.s. for all [formula]. Hence, for any [formula],

[formula]

Moreover, h1 > 0 as we assumed that there exists some [formula] such that aijpij > 0, which implies v0ij > 0. Therefore, the occupation measure xn belongs to the simplex:

[formula]

Let us comment the restriction [formula] in the definition of Δ. This will be useful in the analysis of the equilibria and their stability done in Section [\ref=sect_eq]. Indeed, without this assumption, we could find some pathological equilibria which are of no interest for the random process we study.

For simplicity we assume that pij > 0 for any [formula] such that i  ~  j: if pij = 0 for some i, [formula], then i and j are not allowed to communicate together, so that removing the edge {i,j} does not change the process [formula].

In order to define the expected payoff, let us compute the conditional increment of Tn, for any [formula], recalling [\eqref=proba_succes],

[formula]

Let [formula] be the function defined, for all x∈Δ, by

[formula]

If x∈Δ, we call H(x) the expected payoff at x.

In this paper we use stochastic approximation techniques, namely we compare the evolution of the random process (xn) to the behavior of the deterministic dynamics driven by the mean-field ODE

[formula]

where F is a function from Δ to TΔ, tangent space of Δ, which maps x to

[formula]

with the convention that F(x)ij = 0 if xij = 0 and that aijpijx2ij / xixj = 0 whenever aijpij = 0. We will make the link between the ODE and the random process explicit in Section [\ref=sect_ode].

As we will see, H is a Lyapunov function for the ODE [\eqref=ode], which should imply that, up to a small error term, the random process (H(xn))n increases in average. We are indeed able to show the convergence of (H(xn))n, and hence the asymptotic linear growth of (Tn)n by conditional Borel-Cantelli Lemma, see Corollary [\ref=cor_Tn]. The proof is technical, since the function H is irregular on the boundary of the simplex.

The next Theorem [\ref=th_eq] shows the convergence of [formula] towards the set of equilibria of the ODE [\eqref=ode], defined by

[formula]

The equilibria are not isolated in general, and this result does not imply the a.s. convergence of [formula], which we could not prove in general. We call [formula] a stable equilibrium of the ODE  [\eqref=ode] iff x∈Γ and the maximum real part of the eigenvalues of the Jacobian matrix of F at x is nonpositive, see Definition [\ref=defstab]. This condition is close to the following one: if the solution of the ODE [\eqref=ode] starts near x, it will remain in its neighbourhood forever (see Section [\ref=sect_eq] for more detail).

Our next result provides necessary and sufficient conditions for the stability of equilibria of the ODE.

Let us first define the boundary of the simplex as

[formula]

Note that ∂Δ is not the topological boundary of Δ. If xn  →  ∂Δ, then one of the vertices falls out of use, in the sense that the frequency of its communications asymptotically goes to zero. Let us emphasize that we could have some vertex i falling out of use without making xn converging to ∂Δ: this happens if aijpij = 0 for all j  ~  i.

We characterize in Proposition [\ref=Prop:unstable0] the stable equilibria [formula] in terms of a graph structure associated to x.

Let us first introduce some definitions. For any x∈Δ, we define a subgraph Gx of G, with adjacency [formula], of possible communications between vertices associated to x. Then Definition [\ref=def_prop] will introduce the property corresponding to the stability of equilibria in [formula].

Given x∈Δ, let Gx be the subgraph of G with vertices in [formula] and adjacency [formula] such that [formula] if and only if xij > 0, for all [formula].

Consider a subgraph G of G, with adjacency [formula], and let C1,...,Cd be its connected components. Let PG be the following property:

[formula], i,j,k,l∈Cm, s.t. [formula] and [formula], aijpij = aklpkl > 0;

[formula], Cm contains at most one vertex with several neighbours;

a vertex [formula] has a corresponding edge within G if and only if aijpij > 0 for some j  ~  i.

Consider a subgraph G of G which satisfies PG. For each connected component C of G, we define the nucleus vertex of C as the single vertex i∈C which has several neighbours, chosen arbitrarily when C contains exactly two vertices, or as the single vertex in C when this component consists of an isolated vertex.

Condition (1) in Definition [\ref=def_Gx] is a balance condition on the affinities within a connected component, whereas Condition (2) means that each connected component is star-shaped: if PG holds then within each connected component, there exists a nucleus vertex i0 such that if [formula] is a satellite vertex, then [formula] for any i  ≠  i0, see Figure [\ref=stab_conf]. Finally, Condition (3) applied to G = Gx is equivalent to [formula].

Let G be a subgraph of G such that [formula] holds and let us denote N the set of its nucleus vertices. We define the set [formula] such that [formula] if

Gq  =  G and consequently [formula];

for any i∈N, [formula] where, for any j∈N, (ap)j = ajkpjk for some/any [formula];

for any i∈N, [formula] is any collection of positive numbers such that [formula].

In particular, [formula] and [formula].

The following result is a consequence of Proposition [\ref=Prop:unstable] and Proposition [\ref=prop:eqg].

Let [formula]. Then, the following assertions are equivalent:

x is a stable equilibrium;

x is an equilibrium and its associated subgraph Gx satisfies the property PGx;

x∈ΓG, for some subgraph G satisfying [formula].

This last result implies that, if PG holds for some subgraph G, then the set of stable equilibria x with Gx  =  G is a non-empty continuum .

Theorem [\ref=th_posprob] implies that any subgraph G of G such that [formula] holds, with positive probability xn converges to some stable equilibrium [formula] with Gx  =  G; and G is a limit graph in a strong sense, since after a (random) time communications will only occur within edges of this graph.

Theorems [\ref=th_pot], [\ref=th_eq] and [\ref=th_posprob], and Proposition [\ref=Prop:unstable0], are generalisations of results of Hu, Skyrms and Tarrès [\cite=HST], in the case of the so-called signaling game, see Section [\ref=sect_intro].

We believe but cannot prove that xn converges a.s. to some stable equilibrium in Δ. The difficulty arises from the fact that convergence towards ∂Δ is also possible. In Section [\ref=sect_bord], we explain how several sites can a.s. asymptotically fall out of use (i.e. [formula]) on a network, although all of them performs infinitely many successful communications. The behavior in the neighborhood of ∂Δ is difficult to analyse, since the functions F and H are not continuous on ∂Δ, and since the error in the stochastic approximation can be irregular.

The paper is organized as follows. In the following Section [\ref=sect_ode], we explicit the ODE associated to the dynamics of xn, and prove that H is a Lyapunov function for the deterministic dynamics. Section [\ref=sect_p1] and Section [\ref=sect_p2] are respectively dedicated to the proofs of Theorem [\ref=th_pot] and Theorem [\ref=th_eq]. Section [\ref=sect_bord] yields some explanation on the technical difficulties arising from the possible convergence to ∂Δ. Section [\ref=sect_eq] is devoted to the classification of equilibria and analysis of stability, and Section [\ref=sect_p3] concerns the proof of Theorem [\ref=th_posprob].

Stochastic Approximation

Let us first compute the conditional increment of the process (xn) and derive some mean-field ODE. Using stochastic approximation techniques, we will then study this ODE (in particular its equilibria in Section [\ref=sect_eq]), following the idea that the random process approximates the solutions of the ODE.

In order to compute the increment of [formula] at time n we define, for all [formula], i  ~  j, and for all [formula], the variables

[formula]

Now, for all ij∈E, we have

[formula]

where we define [formula] by

[formula]

[formula] is the increment of a bounded and almost surely converging process: indeed, [formula], [formula], so that, for all [formula],

[formula]

Taking the conditional expectation of [\eqref=firstap] and using [\eqref=proba_succes] and [\eqref=incr_T], we have

[formula]

where [formula], and F is defined in [\eqref=deff]. Note that [formula] a.s., using [\eqref=ubr] and a generalised version of Conditional Borel-Cantelli Lemma, see [\cite=DCD2].

The following Lemma [\ref=lem_StochApp] can be deduced from the estimates above; we use the L1 Euclidean norm |  ·  | on [formula].

There exists an adapted martingale increment process [formula] such that, for all n∈N,

[formula]

and, for all [formula],

[formula]

Note that

[formula]

which provides the upper bound on |ηn + 1|; the upper bound on [formula] is given by [\eqref=ubr].

Corollary [\ref=cor_Tn], which proves asymptotic linear growth of Tn, will in particular imply that the martingale [formula] converges a.s. by Doob's convergence theorem.

Equation ([formula]) is a stochastic approximation of (xn). We will show in Corollary [\ref=cor_Tn] that 1 / Tn is the step size and is of the order of 1 / n. Therefore it is reasonable to expect that (xn) converges to the set of equilibria of [\eqref=ode], which we show in Theorem [\ref=th_eq].

We first study the evolution of the deterministic process driven by [\eqref=ode]. Recall the definition [\eqref=def_Gamma] of Γ, the set of equilibria of the ODE [\eqref=ode].

Analysis of the mean-field ODE

In this section we show that the function H is a Lyapunov function for the ODE [\eqref=ode], i.e. that H is nondecreasing along the paths of the ODE. It is natural to expect that result, in the sense that the overall expected payoff of the network should indeed increase in average; see [\cite=HST] for more details.

We will then deduce that the random process H(xn) is a submartingale up to an error term (see Theorem [\ref=th_pot]). Recall that this stochastic result does not directly follow from the deterministic statements and classical results, since H is not continuous on the boundary ∂Δ.

Let, for all x∈Δ,

[formula]

where, given [formula] we let, for all [formula] such that i  ~  j,

[formula]

be the weighted efficiency of the pair ij.

H is a Lyapunov function on [formula] for the mean-field ODE [\eqref=ode], more precisely,

[formula]

where [formula].

Remark.

Note that, in the definition of [formula], xij and xji are independent variables. For any [formula], we have

[formula]

We used, in the third equality, that [formula] (and the same equality with j instead of i), and we also used relevant substitutions and permutations of the indices. In the last equality, we use definition [\eqref=def_y] of yij.

Given [formula], and [formula] such that i  ~  j, let

[formula]

be the weighted efficiency Ni(x) of i. Recall that yik is defined in [\eqref=def_y].

For any [formula]:

[formula]

Remark.

Fix [formula], and define a measure [formula] and a random variable Y such that, for all [formula], [formula]. We denote [formula] the expectation associated with [formula]. Recalling [\eqref=def_N], we have

[formula]

This implies that, for all j  ~  i,

[formula]

On the other hand,

[formula]

Therefore, for any [formula],

[formula]

switching labels of k and j on the last sum of the penultimate line.

Let us define

[formula]

where p, defined in [\eqref=def_p], is the derivative of H along a trajectory of the ODE [\eqref=ode]. The proof of the following Lemma [\ref=restpoint] is straightforward.

x∈Λ if and only if

[formula]

x∈Λ iff the weighted efficiencies on edges ye are constant over the connected components of [formula]. Now x∈Γ iff ye is equal to H(x) for any edge e of Gx. Therefore Γ  ⊆  Λ but Λ  ≠  Γ in general, and H is not a strict Lyapounov function.

Proof of Theorem [\ref=th_pot] and asymptotic linear growth of (Tn)

In order to compute the conditional expectation of the increment of (H(xn)), let us first estimate the increment

[formula]

By Taylor expansion,

[formula]

for all a, b, c > 0.

We use notation Δn + 1ij from [\eqref=def_del.ij], and also define [formula]. We have

[formula]

where |εijn + 1| and |ζijn + 1| are upper bounded by

[formula]

for some universal constant C > 0.

Note that, since the harmonic series converges we have, for all i, j [formula],

[formula]

Let [formula].

On the other hand, summing our estimate over i, j, we deduce that

[formula]

Recall that [formula], for all [formula]. Finally, taking the conditional expectation yields

[formula]

where p is defined in [\eqref=def_p]. We conclude by noting that (H(xn)) is the sum of a converging process and a bounded submartingale.

We have proved that the expected payoff process converges almost surely. We can now prove that the process (xn) converges to Λ, defined in [\eqref=def_Lam].

[formula] converges a.s. to Λ. More precisely, [formula] converges to 0 a.s.

Define for all ε > 0 the set

[formula]

This argument is similar to the proof of convergence to the set of equilibria in [\cite=APSV]. Let, for all [formula],

[formula]

We have proved that (H(xn) - ξn) is a bounded submartingale. Thanks to the Doob decomposition, we write it as the sum of a martingale (Mn) and an increasing predictable process (An). For all [formula], we have:

[formula]

(Mn) is an upper-bounded martingale, hence a.s. converges. On the other hand, using [\eqref=incr-error],

[formula]

Fix ε > 0 and define δ > 0 the distance between the sets Δε and Δcε / 2. First, notice that xn cannot stay in Δε for ever as 1 / Tn is not summable. Then, assume that xn∈Δε, [formula], then:

[formula]

Therefore, using [\eqref=eup] and Lemma [\ref=lem_StochApp], we have

[formula]

Then, if (xn) were infinitely often away from Λ, An, and consequently H(xn), would explode. This implies the conclusion.

We end this section by stating a result that implies that the process (Tn) has a linear asymptotic growth.

Define the constant

[formula]

Given x∈Δ, recall definition [\eqref=def_N] of Ni(x). Using that [formula], we have, by Cauchy-Schwarz inequality, if [formula],

[formula]

Note that, for all j  ~  i with aijpij = 0, we have Vnij = v0ij a.s. for all [formula]. Hence, almost surely

[formula]

Moreover, the last sum is lower bounded by some constant h0 > 0 as soon as there exists some j  ~  i such that aijpij > 0. This provides the lower-bound on Ni(x). Similarly, for any x∈Δ, defined in [\eqref=def_delta], we have, by Cauchy-Schwarz inequality and using that [formula],

[formula]

where h1 > 0 is defined in [\eqref=def_h1]. This gives us a lower-bound on lim inf nH(xn). The upper bound on H is trivial.

Finally, recall that

[formula]

and the result is now a direct consequence of Theorem [\ref=th_pot] and a generalised version of Conditional Borel-Cantelli Lemma, see [\cite=DCD2].

Proof of Theorem [\ref=th_eq]

In the previous section, we proved that the occupation measure (xn) converges a.s. to Λ, which is the set of points where the derivative of the Lyapunov function H vanishes. As we already mentioned in Remark [\ref=rem1], H is not a strict Lyapunov function, i.e. Γ  ⊆  Λ but Γ  ≠  Λ, where Γ is the set of equilibria of the ODE [\eqref=ode], defined in [\eqref=def_Gamma].

The aim of this section is to prove that the occupation measure converges a.s. to the set of equilibria of the ODE [\eqref=ode]. To that end we show the following Proposition [\ref=prop:setofequ] in Section [\ref=s:setofequ].

Let i, j [formula], i  ~  j. Then

[formula]

Proposition [\ref=prop:setofequ] will enable us to conclude. Indeed, for all [formula], we have

[formula]

Now, for all i, j [formula], Proposition [\ref=prop:setofequ] implies that lim n  →    ∞xnij(ynij - H(xn))- = 0. Subsequently, for all i, j [formula],

[formula]

so that F(xn) converges to 0 as n  →    ∞  .

Let us show that this implies convergence of [formula] to the set of equilibria Γ. Recall that |  ·  | denotes the L1-norm on [formula]. Let L be the limit-set of [formula], which is a non-empty subset of Δ by compactness. Fix ε > 0. Then there exists n0 such that |xn - L| < ε for any [formula] (otherwise there would be a limit-point at distance at least ε from L, by compactness). For any [formula], there exists z∈L (that may depend on n) such that |z - xn| < ε: let us prove that z∈Γ. By contradiction, assume that there exist i0,j0 such that zi0j0 > 0 and |ai0j0pi0j0zi0j0 / zi0zj0 - H(z)| = cz > 0. Fix δ∈(0, min {zij / 4:zij > 0}). Let [formula] be such that [formula] for any [formula]. As z∈L, there exists [formula] such that |xk - z| < δ which implies, using that δ  <   min {zij / 4:zij > 0}, that xkij  >  δ if and only if zij > 0, for any [formula]. In this case, it is straightforward to check that

[formula]

Besides, if [formula] then [formula], using that H is bounded and that [formula]. We deduce subsequently that [formula]. Finally, as soon as δ is small enough, we obtain a contradiction by noting that

[formula]

Therefore, z∈Γ.

Let us show that this implies convergence of [formula] to the set of equilibria Γ. Fix ε > 0 and let [formula] be defined as follows. For all [formula], i, j [formula], let

[formula]

and let znij = xnixnjhn if xnij  >  ε, znij = 0 otherwise.

It is easy to check that hn = H(zn) and zn∈Γ for all [formula]. We easily deduce from [\eqref=xyr] that [formula] and [formula] for large [formula].

Let us now sketch the proof of Proposition [\ref=prop:setofequ], given in Section [\ref=s:setofequ]. Define

[formula]

and recall the definitions of Δε and hmin respectively introduced in [\eqref=def_Delteps] and in Corollary [\ref=cor_Tn].

Proposition [\ref=prop:setofequ] will follow from Lemma [\ref=lem53], which implies that both xnij (resp. ynij) decreases (resp. increases) outside [formula].

Let i, j [formula], i  ~  j, with aijpij > 0. Let

[formula]

Assume [formula] and ε∈(0,1 / 9). Then

[formula] (resp. [formula]) is a submartingale (resp. supermartingale);

[formula].

Lemma [\ref=lem53] is shown is Section [\ref=p:lem53]. It follows from Lemma [\ref=lem_StochApp] for its part on xnij, and from the following two Lemmas [\ref=stochapp2] and [\ref=lem51] for its part on ynij.

Lemma [\ref=stochapp2] is proved in Section [\ref=p:stochapp2], and shows that the increment of ynij is driven by a differential equation of the type [formula], where, for all x∈Δ, we let

[formula]

Outside [formula], Lemma [\ref=lem51] implies that

[formula]

which indeed yields that ynij increases on average.

For all i, j [formula], the increment of (ynij)n expands as follows:

[formula]

where (rnij) is predictable, [formula] and

[formula]

where [formula].

Assume that ε∈(0,1 / 9), and that x∈Δcε4. Then, for all vertices i and j, i  ~  j, such that xij  >  ε, we have:

[formula]

Follows directly from Lemma [\ref=rec-dl].

Proof of Lemma [\ref=stochapp2]

Using (1 + c)- 1 = 1 - c + O(c2) for all [formula], we deduce that

[formula]

if t∈[null] and s, u, v ∈[0,η].

Now recall yij = aijpijTnVnij / (VniVnj): therefore,

[formula]

where

[formula]

Let

[formula]

Note that ζn + 1ij uniquely determines rn + 1ij from [\eqref=defy].

By definition of H, Ni and yij, we have

[formula]

so that

[formula]

On the other hand, sn + 1Tn, tn + 1Vnij, un + 1Vni and vn + 1Vnj are all upper bounded by [formula], which implies that

[formula]

Also, assume w.l.o.g. that [formula]; then it follows from [\eqref=dl4] that

[formula]

which enables us to conclude, noting that [formula].

Proof of Lemma [\ref=lem53]

Assume [formula].

Using that [formula] from [\eqref=def_R-net], Lemma [\ref=lem_StochApp] implies

[formula]

if [formula] and [formula], so that [formula] is a supermartingale.

Also, using Lemma [\ref=lem51],

[formula]

Hence, using now Lemma [\ref=stochapp2],

[formula]

if [formula] and [formula]. This concludes the proof of (1).

In order to prove (2), define Πn and Ξn as the martingale parts in the Doob decompositions of Yn and Sn:

[formula]

By Lemma [\ref=stochapp2], we have for all [formula],

[formula]

Therefore, using Corollary [\ref=cor_Tn], (Πn)n is bounded in [formula] and hence converges a.s. We conclude for (Ξn)n with similar computations, and (2) follows immediately.

Proof of Proposition [\ref=prop:setofequ]

Let us first prove the following auxilliary Lemma [\ref=2epsilon].

Let ε > 0, i, j [formula], i  ~  j, and assume [formula]. If ~  xn∈Uij(ε) and |H(xn + 1) - H(xn)| < ε / 2, then xn + 1∈Uij(2ε), where Uij(  ·  ) is defined in [\eqref=def_Uij].

Assume xn∈Uij(ε). Then either [formula] or [formula].

If [formula] then, using [\eqref=uber]-[\eqref=eup], we deduce [formula] if [formula], so that [formula].

If xnij  >  ε and [formula], then [formula] if [formula] by Lemma [\ref=stochapp2]. By assumption, |H(xn + 1) - H(xn)| < ε / 2, so that we conclude that [formula].

Let us now show Proposition [\ref=prop:setofequ]. We fix ε > 0 and [formula], and assume [formula], so that the assumptions of Lemmas [\ref=lem53] and [\ref=2epsilon] hold. Let τm0 be the stopping time

[formula]

We want to prove that either τm0  <    ∞  , or xn∈Uij(3ε) for all large n. Recall that Uij(  ·  ) is defined in [\eqref=def_Uij]. This will allow us to conclude, as Proposition [\ref=prop_p0] and Theorem [\ref=th_pot] imply that there exists almost surely [formula] s.t. τm0  =    ∞  .

Let σm0 be the stopping time

[formula]

Lemma [\ref=lem53] (2) implies that there exists a.s. a (random) [formula] such that, for all [formula],

[formula]

Therefore σm0  <    ∞  : indeed, otherwise ynij  →    ∞   asn  →    ∞   by Lemma [\ref=lem53] (recall τm0  =    ∞  , since [formula], so that [formula] for large n, which leads to a contradiction.

For all [formula], let ρn be the largest [formula] such that xk∈Uij(ε). By ([\ref=RSest]),

[formula]

By Lemma [\ref=2epsilon], xρn + 1∈Uij(2ε) : let us assume for instance that [formula]. Together with [formula], as τm0  =    ∞  , we deduce that

[formula]

With a similar argument, [formula] implies [formula]. These two arguments together imply that xn∈Uij(3ε) if [formula], which enables us to conclude.

Asymptotic behavior near the boundary

The results presented in Sections [\ref=sect_eq] and [\ref=sect_p3] concern respectively the characterisation of stable equilibria and convergence towards them on [formula].

However, as we mentioned at the end of Section [\ref=sect_th], a full analysis of the asymptotics of the process [formula] would require a better understanding of the behavior of the dynamics close to the boundary ∂Δ. This can be understood through the following simple example.

Let G be a star-shaped connected graph consisting of k + 1 vertices [formula], where v is the core adjacent to all vertices ul, [formula], and any two vertices ul and um, l  ≠  m, are not adjacent. Assume w.l.o.g. that the sequence avul, [formula], is nonincreasing in i, and consider the case where [formula].

Consider our process [formula] on G. Then, for all [formula], Vul,v = Vul, so that the probability to choose edge {ul,v} at time n is Vnul,v / Vnv and, in that case, Vn + 1ul,v = Vnul,v + avul.

This corresponds to the so-called Friedman's urn with k colors: when a ball of color l is chosen, then it is put back into the urn, along with avul other balls of the same color. Thus Vnul,v / navul / avu1 converges a.s. towards a positive r.v. (see for instance [\cite=freedman]).

Assuming for instance that avul < avu1 for all [formula], we deduce in particular that xnu2,...,xnuk converge a.s. to 0, and that xnu1,xnv converge to 1 / 2 a.s. Therefore xn converges to the boundary ∂Δ.

Note that, for any general graph [formula], and for all [formula] such that aijpij > 0 for some j  ~  i, the convergence to the boundary will occur at a rate at most nε - 1 for some ε > 0. In particular, this implies that any vertex [formula] such that aijpij > 0, for some j  ~  i, performs infinitely many successful communications almost surely. This is a consequence of [\eqref=lbni] in Corollary [\ref=cor_Tn]: the probability that i receives a positive payoff at time n + 1 will be at least

[formula]

If we let Lni = hminVni, then we can couple the process [formula] with a Friedman's urn with 2 colors (i and ic), so that when a ball of color i is chosen, then it is put back into the urn along with at least hminwmin other balls of color i, and such that in any case (either if i or ic is chosen), at most [formula] balls of color ic are added.

Now F is not continuous on the boundary ∂Δ, so that Lemma [\ref=lem_StochApp] is not useful on the event that the trajectory of xn has accumulation points in ∂Δ. However it is possible to write the evolution of our network as a stochastic approximation of solutions of a smooth ODE: if we let [formula], then the process [formula] can be seen as a Cauchy Euler approximation of the following ODE:

[formula]

However the perturbation in the evolution of ynij in Lemma [\ref=stochapp2] depends on xi and xj, and the state space of the ODE on z is not compact anymore.

Classification of equilibria and stability

In this section, we analyze the deterministic dynamics associated to the ODE [\eqref=ode]. In particular, we compute the Jacobian matrix of F and give a characterization of the stable equilibria in [formula]. Let us first do the following remark, which we will use several times.

For any x∈Δ, H(x) is lower bounded by some positive constant, using [\eqref=lbHx]. Recalling the definition [\eqref=def_Gamma] of Γ, this implies that, for any x∈Γ, if aijpij = 0 then xij = 0.

Properties of Lyapunov function

In this section, we show that H is constant on each connected component of Γ, defined in [\eqref=def_Gamma].

H is constant on each connected component of Γ.

We first prove in Lemma [\ref=samesupp] that H is constant on connected subsets of Γ with the same support (defined below) by a differentiability argument. Then we show in Lemma [\ref=lem:cont] that H is continuous on Γ (including [formula]), which enables us to conclude. Let Θ be the set of subsets of E. For any x∈Δ, we define its support

[formula]

Θ can be used as an index set to divide Δ or Γ into several subsets: for any θ∈Θ,

[formula]

For any θ  ∈  Θ, H is constant on each connected component of Γθ.

Given q∈Γθ, let us differentiate H at q with respect to xij = xji,  ij∈θ (i.e. qij > 0 and thus aijpij > 0 by Remark [\ref=remapx]) without the constraint x∈Δ:

[formula]

The penultimate equality comes from the fact that, for all r, s [formula], rs∈θ (hence qrs,arsprs > 0, since q∈Γθ), we have (arsprsqrs) / (qrqs) = H(q).

H is continuous on Γ.

Suppose that q∈Γ, and that x∈Γ is in the neighbourhood of q∈Γ within Δ, then Ex  ⊇  Eq and, using x∈Γ,

[formula]

so that

[formula]

and the conclusion follows.

Jacobian matrix

At any equilibrium [formula] (H and F are not differentiable on ∂Δ), we compute the Jacobian matrix

[formula]

where, by a slight abuse of notation,

[formula]

For all ij, kl ∈E, a simple extension of the calculation in the proof of Lemma [\ref=samesupp] yields [formula], so that

[formula]

Recalling Remark [\ref=remapx], note that the last computation holds for aijpij = 0 or aklpkl = 0.

Therefore, for [formula], we deduce

[formula]

For any ij∈E s.t. xij = 0, we have:

[formula]

Let [formula] be the connected components of the subgraph [formula], where Ex is defined in [\eqref=def_Ex]. Let

[formula]

Therefore, Jx can be written as follows, by putting first ij and kl coordinates such that [formula] and [formula] (in the same order, with increasing connected components [formula])

[formula]

Classification of equilibria based on stability

Let us introduce some definitions on stability for ordinary differential equations.

x is if for any neighbourhood of x, there exists a neighbourhood of x such that any solution starting in is such that remains in for all .

x is if it is and there exists a neighbourhood U1 such that any solution x(t) starting in U1 is such that x(t) converges to x.

An equilibrium that is Lyapunov stable but not asymptotically stable is sometimes called neutrally stable.

x is if all eigenvalues of the Jacobian matrix at x have nonpositive real part; otherwise, x is called .

Remark that, with these definitions, linear stability allows for eigenvalues to have zero real part, and therefore does not necessarily imply Lyapunov stability. However the dynamics considered here makes these stable equilibria indeed Lyapunov stable: as in [\cite=HST], as we will observe in Section [\ref=sect_p3] (in a stochastic version).

Let

[formula]

and let Γs (resp. Γu) be the set of linearly stable (resp. unstable) equilibria in Γ0 for the mean-field ODE.

For any x∈Γu, let

[formula]

where Ex is defined in [\eqref=def_Ex].

Recall Definition [\ref=def_Gx] of a graph Gx associated to some x∈Δ.

We have

[formula].

If x∈Γu, then there exists an eigenvector in Ex whose eigenvalue has positive real part.

We are first going to prove following Lemma [\ref=aij=aik] giving a necessary condition on the elements of Γs. Its proof is widely inspired by that of a similar result in [\cite=BenTarr].

If x is in Γs, then for all i,j,k and l in the same connected component of Gx such that [formula], [formula], we have:

[formula]

Let us denote Pa this last property.

Choose [formula]. It is sufficient to prove that, if xi0j0 > 0 and xi0k0 > 0, then ai0j0pi0j0 = ai0k0pi0k0.

Assume the contrary, for some i0, j0, k0. Then, in particular,

[formula]

Recall that the entries of the Jacobian matrix J(x), computed in Section [\ref=SEC:4:9], are such that, on the line corresponding to ij, we have:

[formula]

Recall also that J(x) is block upper triangular with on its diagonal sub-matrices Jmx, [formula]. Hence, the eigenvalues of Jmx, [formula], are eigenvalues of J(x). Moreover, each Jmx corresponds to the edges within the same connected component of the graph, where we called Cm this connected component. This means that for any coordinate kl of Jmx, we have kl∈Cm and xkl > 0. Let us first prove that the matrices Jmx can be written as the product of a diagonal matrix and a symmetric matrix. Define the diagonal matrix

[formula]

Besides, define the symmetric matrix Mm, with entries of the coordinates (ij,kl), ij,kl∈Cm, given by

[formula]

It is then straightforward to check that Jmx = DmMm.

Now, the eigenvalues of Jmx are all nonpositive if and only if the eigenvalues of Mm are all nonpositive. To have a proof of this fact, see the Claim in the proof of Lemma 1 in [\cite=BenTarr], p. 2199. Therefore, let us prove that Mm has a positive eigenvalue, which will enable us to conclude.

Let u be a vector in [formula], such that:

[formula]

Dropping the 0 of i0, j0 and k0 for simplicity, we have:

[formula]

hence

[formula]

Then, we chose uij = 1 and uik =  - 1. So, we have:

[formula]

Recall that [formula] and [formula], and notice that [formula] or [formula]. Indeed, if [formula], as [formula] (we are on the set of equilibria), then we would have aijpij = aikpik, which is not the case, by assumption. Hence uTMmu > 0 and therefore Mm has a positive eigenvalue, as this matrix is symmetric. Finally, this implies that J(x) has a positive eigenvalue and therefore x is not stable.

Lemma [\ref=aij=aik] implies that [formula]. To prove Proposition [\ref=Prop:unstable], we need the following Lemma [\ref=Pdnh] on the structure of Gx when x∈Γa0.

For all x∈Γa0 such that PGx does not hold, then there is at least one connected component on which every vertex has at least two edges.

Assume that x is in Γa0 and PGx does not hold. Assume by contradiction that, on any connected component, there exists a vertex j linked to only one vertex, say i. So, we have aijpij > 0 by Remark [\ref=remapx], and [formula]. Then, as x∈Γa0, for all k such that xik > 0, we have aikpik = aijpij and

[formula]

then k is only linked to i, and therefore each connected component of Gx is star-shaped, which contradicts the assumption that PGx does not hold, and allows us to conclude.

Proof of Proposition [\ref=Prop:unstable]. First, assume that x∈Γa0 and PGx does not hold. We want to prove that x∈Γu. Lemma [\ref=Pdnh] implies that Gx has a connected component on which each vertex is adjacent to at least two edges, which we assume w.l.o.g. to be C1. Let V(C1) (resp. E(C1)) be its set of vertices (resp. edges). Let us show that J1x has at least one eigenvalue with positive real part.

Compute the trace of J1x :

[formula]

The last inequality comes from the fact that each vertex has at least two edges. It is easy to check that (1,...,1)  ·  J1x =  - H(x)(1,...,1), hence - H(x) is an eigenvalue of J1x and - H(x) < 0 by Remark [\ref=remapx]. Subsequently, there exists an eigenvalue with positive real part. This implies part (a) of Proposition [\ref=Prop:unstable], using Lemma [\ref=aij=aik].

Now, assume that x∈Γa0 and that PGx holds. Then, each connected component of Gx is star-shaped. Let us assume for instance that C1 is composed of a nucleus v and satellite vertices 1,...,k. Then, for all i∈{1,..,k}, xiv = xi, and we have:

[formula]

The rank of J1x is 1, 0 and - H(x) < 0 are eigenvalues, as (1,...,1)  ·  J1x =  - H(x)(1,...,1), so all its eigenvalues are nonpositive, which completes the proof.

[formula]

Note that, in general, there may be no stable configuration on [formula]. Now, if the number of vertices is even, every equilibrium x such that Gx yields a one-to-one correspondence between vertices (i.e. each connected component has only two vertices and one edge) is asymptotically stable.

Finally, the following proposition implies the second part of Proposition [\ref=Prop:unstable0]. Recall Definition [\ref=def_Gx] of Gx for x∈Δ, Definition [\ref=def_prop] of the property [formula] and Definition [\ref=def_gammag] of the set [formula], for some subgraph G. Recall also the Definition [\ref=def_se] of the set Γs of stable equilibria outside the boundary.

Let G  ⊂  G be a subgraph such that [formula] holds and let q∈Δ be such that Gq  =  G. Then, q is an equilibrium if and only if [formula] and, in this case, q is stable. In other words, [formula].

Let q∈Δ be such that Gq  =  G. As [formula] holds, [formula] and if aijpij = 0 then qij = 0. Besides, each connected component of G is star-shaped and contains a single nucleus vertex (see Definition [\ref=def_nucleus]). We denote [formula] the set of nucleus vertices of G. Now, for any [formula], we have that aijpij = aikpik = :(ap)i as soon as qijqik > 0. If [formula] is such that aijpij = 0 for any [formula], then i is isolated in G and we let (ap)i: = 0. Moreover, for any [formula] and [formula] with qij > 0, we have qij / qj = 1. Using this, a simple computation yields

[formula]

and if q is an equilibrium, then, for any [formula], [formula], hence [formula] and q is stable by Proposition [\ref=Prop:unstable]. Conversely, it is straightforward to check that if [formula] then [formula], Gq  =  G and q∈Γ, hence q is a stable equilibrium by Proposition [\ref=Prop:unstable].

Proof of Theorem [\ref=th_posprob]

Assume that (G,(aij,pij)ij∈E) is such that [formula], where Γs is the set of stable equilibria in [formula] (see Definition [\ref=def_se]).

Theorem [\ref=th_posprob] is a consequence of the following Proposition [\ref=prop:posconv]. Before stating it, we need some definitions.

Let G  ⊆  G be a graph such that PG holds (see Definition [\ref=def_prop]) and let EG be the set of edges of G. Besides, let us denote VG the set of non-isolated vertices of G (in particular, as PG holds, i∈VG if and only if aijpij > 0 for some j  ~  i). Each connected component contains a single nucleus vertex i (see Definition [\ref=def_nucleus]) and is such that aijpij = aikpik > 0 as soon as ij,ik∈EG. Finally, we denote by NG the set of nucleus vertices of G. Let [formula] be a function mapping [formula] to the nucleus vertex of the connected component that i belongs to. In particular, note that, for any [formula], π(i) = i and π(j)  ≠  i for any j  ≠  i.

For all [formula], [formula] and ε > 0, let us define

[formula]

Obviously, all these definitions depend on the graph G, but for simplicity we do not write this dependency.

Let G be such that PG holds, and let π: = πG. For all ε∈(0,wmin), if H1n, H2n and H3n hold, and [formula], then, with lower bounded probability (only depending on ε, [formula], and [formula]), for all i, j [formula], [formula],

[formula]

Before proving this proposition, let us explain how it implies Theorem [\ref=th_posprob]. Firstly, by Proposition [\ref=Prop:unstable0], if q is a stable equilibrium with Gq  =  G, then [formula], where [formula] is defined in Definition [\ref=def_gammag]. Secondly, choose such a stable equilibrium [formula] and let us prove that (xn) converges to an equilibrium in a neighborhood of q with positive probability.

Let us work on a probability event A on which H1n0, H2n0 and H3n0 hold for some [formula], and [\eqref=verve1], [\eqref=verve2] and [\eqref=verve3] occur. Moreover, assume that, on A, αn0i∈((1 - ε)qi / qπ(i),(1 + ε)qi / qπ(i)) for any [formula].

Note that [\eqref=verve1] implies that, for any [formula], V∞i  <    ∞   and thus xni  →  0. Also, for [formula] and [formula] such that i  ≠  π(j), we have that V∞ij  <    ∞   and [formula], using [\eqref=verve1]. Besides, for any [formula], [formula] by [\eqref=verve3], [formula] for any j such that i = π(j) by [\eqref=verve1] and xnij / xni converges to some positive limit by [\eqref=verve2]. Therefore, as xn stays away from ∂Δ, it easily implies that [formula]. Additionally, as (xn) converge almost surely to Γ, we necessarily have that [formula] for any [formula] and where (ap)i: = aikpik for some/any k such that qik > 0.

Together with [\eqref=verve2], this implies that, on A, (xn) converges to some x∈Δ in a neighborhood of q, and A has positive probability as soon as n0 is large enough. Moreover, the limit x is such that Gx  =  G and, for any [formula], [formula] and xij > 0 iff i = π(j). Consequently, [formula] and is thus a stable equilibrium by Proposition [\ref=Prop:unstable0].

In the remainder of this section, we fix the graph [formula] (and thus π  =  πG and the events Hn's) and ε > 0. The proof of Proposition [\ref=prop:posconv] consists of the following Lemmas [\ref=claim4], [\ref=claim5] and [\ref=claim6].

Let, for all i, j [formula], [formula],

[formula]

and let

[formula]

If [formula], then

[formula]

Assuming [formula],

[formula]

If [formula] then, for all [formula],

[formula]

Moreover, given that H1n, H2n and H3n hold, [formula] converges almost surely as k goes to infinity.

Notice that if [formula] is such that i = π(i), then αni = 1 a.s. for any [formula] and consequently τ2,in  =    ∞   almost surely. Then, fix [formula], [formula], and assume that π(i)  ≠  i (in particular i∈VG).

Let, for all [formula] and [formula],

[formula]

which is equal to Vkj as long as k < τ1n.

Let, for all [formula],

[formula]

and let us consider the Doob decomposition of [formula]:

[formula]

In the following computation, we write [formula] if [formula], for all [formula]. Assume that H1n, H2n and H3n hold, and that k < τn: then, using that, for all [formula], piπ(i)aiπ(i) = pjπ(i)ajπ(i),

[formula]

where we use that, for all [formula],

[formula]

Therefore, for all [formula],

[formula]

which is less than ε / 4 as soon as n is large enough. Moreover [formula] converges a.s.

Let us now estimate the martingale increment: [formula] (since [formula]), so that [\cite=HST] (stated here as Lemma [\ref=martest]) implies

[formula]

Moreover, the martingale [formula] is bounded hence a.s. converges. This completes the proof.

Recall the definition [\eqref=singe] of wmin.

If ε∈(0,wmin) and [formula] then, for all i∈VG such that π(i) = i (i.e. i∈NG),

[formula]

Let [formula], assume that H1n, H2n and H3n hold, and fix i∈VG such that π(i) = i. Let us consider the Doob decomposition of [formula]:

[formula]

Now, for all η > 0, if [formula] and k < τn, [\eqref=estsm] implies

[formula]

if [formula].

Let us now estimate the martingale increment: let, for all [formula],

[formula]

Then, for all [formula],

[formula]

This implies, using [\cite=HST] (see Lemma [\ref=martest]) and [formula] for all [formula], that for all ε > 0

[formula]

we choose η  =   min (ε,wmin  -  ε), which completes the proof.

The following Lemma [\ref=martest] states an exponential inequality for martingales (see for instance [\cite=HST], Lemma 7.4 for a proof).

Let [formula] be a deterministic sequence of positive reals, let [formula] be a filtration, and let [formula] be a [formula]-adapted martingale such that [formula] for all [formula]. Then, for all [formula] and λ > 0,

[formula]