A new Bayesian regression model for counts in medicine

Introduction

Data in the form of counts appear in many application areas, from medicine, social and natural sciences to econometrics, finance and industry [\citep=cameron2013regression]. In medicine, two examples of this are the length of stay in hospital, commonly used as an indicator of the quality of care and planning capacity within a hospital [\citep=atienza08] [\citep=carter14], and the number of visits to a specialist [\citep=machado05], often taken as a measure of demand in healthcare. Other examples are high-throughput genomic data generated by next generation sequencing experiments [\citep=ozsolak11] [\citep=bao14] [\citep=robinson08] or lifetime data, such as the number of cycles before a machine breaks down [\citep=nakagawa75].

Similarly to Weibull regression, which is widely used in lifetime data analysis and survival analysis for continuous response variables, [\cite=kalktawi15] have recently proposed a regression model for a discrete response based on the discrete Weibull distribution. A number of studies have found a good fit of this distribution in comparison with other distributions for count data [\citep=bracquemond03] [\citep=englehardt11] [\citep=lai13]. In the context of regression, [\cite=kalktawi15] show two important features of a discrete Weibull distribution that make this a valuable alternative to the more traditional Poisson and Negative Binomial distributions and their extensions, such as Poisson mixtures [\citep=hougaard97], Poisson-Tweedie [\citep=esnaola13], zero-inflated regression[\citep=lam06] and COMPoisson [\citep=sellers10]: the ability to capture over and under-dispersion simultaneously and a closed-form analytical expression of the quantiles of the conditional distribution.

In [\cite=kalktawi15], maximum likelihood is used for the estimation of the parameters. This is in general the most common approach for parameter estimation in regression analysis of counts, due to a lack of simple and efficient algorithms for posterior computation [\citep=zhou12]. Among the contributions to Bayesian estimation of discrete regression models, [\cite=el1973bayesian] consider the case of Poisson regression, [\cite=zhou12] provide an efficient Bayesian implementation of negative Binomial regression, [\cite=mohebbi2014disease] develop Bayesian estimation for a Poisson and negative Binomial regression with a conditional autoregressive correlation structure whereas [\cite=angers2003bayesian] [\cite=ghosh2006bayesian] [\cite=neelon2010bayesian] [\cite=liu2012bayesian] study zero-inflated Poisson regression. In this paper, we contribute to this literature, by providing the first Bayesian approach for parameter estimation in discrete Weibull regression. For the choice of prior distributions, we consider both the case of non-informative priors and the case of Laplace priors with a hyper penalty parameter. The choice of Laplace priors induces parameter shrinkage [\citep=park2008bayesian] [\citep=kyung2010penalized], and, with the use of Bayesian credible intervals, leads to variable selection, similar to alternative approaches such as spike and slab priors [\citep=ishwaran2005spike].

The aim of this paper is two-fold. Firstly, we highlight the role that the discrete Weibull distribution has in modelling count data from a variety of applications, beyond its current limited use to lifetime data. We particularly emphasize applications in the medical domain, using several datasets of medical records. Secondly, we present a novel Bayesian regression model for counts based on the assumption of a discrete Weibull conditional distribution. The remainder of this paper is organized as follows. Section ([\ref=sec:regression]) describes the discrete Weibull regression model, with a more general parametrization as that presented in [\citep=kalktawi15]. Section ([\ref=dw-model-fitting]) describes Bayesian parameter estimation for a discrete Weibull regression model. Section ([\ref=DW:simulation]) presents an extensive simulation study, whereas Section ([\ref=empirical_data_in_medicine]) shows the analysis of real data via Bayesian discrete regression model and a comparison with existing approaches. Finally, we draw some conclusions in Section ([\ref=Conclusion_and_discussion]).

Discrete Weibull regression

Discrete Weibull distribution

The discrete Weibull distribution was introduced by [\cite=nakagawa75], as a discretized form of a continuous Weibull distribution, similarly to the geometric distribution, which is the discretized form of the exponential distribution, and the negative Binomial, which is the discrete alternative of a Gamma distribution. In some papers, this is referred to as a type I discrete Weibull, as two other distributions were subsequently defined. [\cite=bracquemond03] review the three different distributions and point out the advantages of using the type I distribution: it has an unbounded support, differently to the type II distribution, and it has a more straightforward interpretation, differently to the type III distribution.

If a random variable Y follows a (type I) discrete Weibull distribution, then the cumulative distribution function of Y is given by

[formula]

with 0 < q < 1 and β > 0 the shape parameters. A similar definition can be given on the support [formula]. In this case, F(y;q,β) = 1 - qyβ, for [formula]. Comparing this cdf with that of a continuous Weibull distribution with parameters α and γ, one can see that there is a direct correspondence between β and γ, whereas q in the discrete case corresponds to exp ( - α) in the continuous case [\citep=khan89].

Given the form of the cumulative distribution function, the discrete Weibull distribution has the following probability mass function:

[formula]

with q and β denoting the shape parameters. Throughout the paper, we will refer to this distribution as DW(q,β).

Inference for Discrete Weibull: Existing Approaches

[\cite=khan89] derive estimators of the parameters q and β using the method of moments and a new method which they call the method of proportions, and they find a good performance for the latter. Let [formula] be a random sample from a DW(q,β) distribution and denote [formula] and [formula]. Using the method of proportions, the following estimators of q and β are proposed:

[formula]

These estimators use only the zeros and ones in the sample. [\cite=santos13] derive an improved estimator of β, by taking all observations into account. In particular, let dm be the maximum observed value of Y and let k = dm - 1. If dm > 2, then the following improved estimator is proposed:

[formula]

where [formula] denotes the empirical cdf. When dm = 2, this estimator is equivalent to the one from [\cite=khan89]. Note that in both cases, no estimates of β can be obtained when  = 1, i.e. there are no zero counts in the observed data, or  = 0, i.e. all counts are zero. However, in other cases, the estimators perform relatively well, particularly in the case of small sample sizes, as we have checked with a simulation study (not shown here).

[\cite=kulasekera94] considers maximum likelihood for the estimation of q and β. The likelihood function for a discrete Weibull sample is given by:

[formula]

the maximum of which can be found numerically.

There is no explicit work in the literature for building confidence intervals for discrete Weibull parameters, although standard asymptotic likelihood and bootstrap approaches can be used. The Bayesian approach that we devise in this paper will lead naturally to credible intervals for the parameters.

Regression via a discrete Weibull

Let Y be the response variable with possible values [formula], and let [formula] be p covariates. We assume that the conditional distribution of Y given X follows a DW distribution with parameters q and β. There are a number of possible choices to link the parameters q and β to the covariates. In particular, we propose the following link functions:

q dependent on X via

[formula]

where [formula] and [formula].

β dependent on X via

[formula]

where [formula].

The first parametrization was proposed by [\citep=kalktawi15], in line with the link function used in continuous Weibull regression. In this paper, we consider one additional parametrization for q via a logit link function, which has proved to be rather effective for statistical inference, and a link also between the second parameter β and the covariates, in order to capture more complex dependencies.

Bayesian inference for discrete Weibull regression

In this section, we discuss Bayesian estimation of the regression parameters [formula] and [formula]. The advantage of choosing Bayesian approaches over classical maximum likelihood inference is two-fold. Firstly, the possibility of taking prior information into account and, secondly, the procedure returns automatically credible intervals for all parameters.

Given n observations yi and [formula], [formula], for the response Y and the covariates X, respectively, and letting xi be the row vector [formula], the likelihood for the most general case is given by

We consider different prior distributions on [formula] and [formula]. Unfortunately, in the context of discrete Weibull regression, there are no conjugate priors. However, we will show in the simulation study how an uninformative prior achieves an acceptable rate of mixing as well as comparable estimation to maximum likelihood. In addition, we consider a prior on the regression coefficients that encourages sparsity. In particular, we consider a Laplace prior for θ and γ, of the form

[formula]

For a given choice of λ and τ, maximising the posterior probability under these priors corresponds to maximising the L1 penalised log-likelihood

[formula]

as in the traditional lasso approach [\citep=park2008bayesian] [\citep=tibshirani1996regression]. We further assume a Gamma(a,b) hyper prior for both λ and τ, leading to the posterior distribution

[formula]

As Gibbs sampling is not possible, we choose a Metropolis-Hastings sampling [\citep=hastings1970monte] to draw samples from the full conditional posterior and we provide an implementation in the R package BDWreg. From the posterior distribution, the mode of the marginal densities can be used as point estimate of the parameters, whereas the whole distribution is used for building credible intervals. In the case of Laplace priors, the inclusion or not of zero in the Highest Posterior Density (HPD) interval is used for variable selection. MCMC samplers have been used before in the continuous Weibull regression context by [\cite=newcombe2014weibull], which utilizes a Reversible Jump MCMC, and [\cite=soliman2012modified] which uses a hybrid method consisting of Metropolis-Hastings and Gibbs sampler to estimate parameters in a three parameters continuous Weibull distribution. Moreover, [\citep=polpo2009statistical] make use of a Metropolis-Hasting sampler to make inference for a continuous two-parameters Weibull distribution in a censoring framework.

Simulations study

In this section, we perform a simulation study where we show the effectiveness of the Bayesian estimation procedure, both in the case of data drawn from a DW regression model and in the case of model misspecification, where the generating model is that of Poisson or Negative Binomial (NB). Finally, we test the use of Laplace priors in a variable selection scenario.

Simulation from a DW regression model

Table ([\ref=ch3:table1]) shows six configurations of parameters used in the simulation, where we consider the two link functions for q and the link function for β described in Section ([\ref=sec:regression]), i.e. imposing a linear model on [formula] or log ( -  log (q)), and on log (β). For cases 2 to 6, we generate the three predictors uniformly in the interval

[formula]

Simulation from a Poisson and NB regression model

The aim of this section is to test the fitting of a DW regression model to data generated from a Poisson and NB regression. To this end, we design two experiments using two explanatory variables, X = (X1,X2), and n = 500 data points. We simulate data for the predictors from uniform distributions, namely X1  ~  U(0,1) and X2  ~  U(0,1.5). We fix the intercept and the regression parameters to α = ( - 0.5,4.3, - 2.2), with values chosen to cover a wide range of shapes for the target distribution. Then, in the first experiment, we assume that the conditional distribution of Y given X is Poisson(eXα), whereas in the second experiment, we assume it to be a NB distribution with mean μ = eXα and variance μ  +  μ2  /  θ with θ  =  4.5. Figures ([\ref=fig:DW_SIM]) shows the conditional distribution fitted by DW(regQ,β) for a fixed value of x1 = 0.5 and sliding values of x2 in the

[formula]

Simulation on Variable Selection

In this simulation, we show the performance of DW regression for variable selection. To this end, we generate 50 parameters uniformly in the

[formula]

Analysis of counts in medicine

In this section, we show the performance of the Bayesian discrete Weibull regression model on real datasets from the medical domain. We compare the proposed model with the Bayesian Poisson (BPoisson) and Bayesian Negative Binomial (BNB) models on the basis of a number of commonly used criteria: Bayesian Information Criteria (BIC) [\citep=dayton2003model], Akaike Information Criteria (AIC) [\citep=dayton2003model], Deviance Information Criterion (DIC) [\citep=spiegelhalter2002bayesian], Quasi-likelihood Information Criteria (QIC) [\citep=pan2001akaike], Consistent AIC (CAIC) [\citep=bozdogan1987model], Bayesian Predictive Information Criterion (BPIC) [\citep=ando2007bayesian] and the Prior Predictive Density (PPD) used in the Bayes factor [\citep=kass1993bayes].

Comparison with Bayesian generalised linear models

To show the ability of BDW to estimate parameters in the presence of under-dispersion, over-dispersion and excessive zeros in count data, we choose the following three medical datasets:

The data on inhaler usage from [\cite=grunwald2011statistical], with 5209 observations. The response is the daily counts of inhalers usage, whereas the covariates are humidity, barometric pressure, daily temperature, air particles level. The data show under-dispersion [\citep=kalktawi15].

The German health survey dataset available in the R package COUNT under the name badhealth, with 1127 observations. The response is the number of visits to doctors and the predictors are whether the patient claims to be in bad health or not, and the age of the patient. The data show over-dispersion [\citep=kalktawi15].

The German health registry dataset available in the R package COUNT under the name rwm, with 27326 observations. The response is the number of visits to doctors and the predictors are age, years of education and household yearly income. The data show over-dispersion with a relatively large number of zeros (37%) [\citep=kalktawi15].

We fit a BDW model with an uninformative prior on the regression parameters, 35000 iterations for the Metropolis-Hastings algorithm and an acceptance rate in the (20,30)% interval. For the case of BPoisson and BNB regression, we make use of the MCMCpack R package [\citep=martin2011mcmcpack] with the same configurations. Table [\ref=tb:RealData-Uninformative] shows a comparison of the models on the three datasets. We only report the results of the BDW(regQ,β) models and, of these, the (q) link shows superior performance. In all cases, the BDW model has the same or better performance than both Poisson and negative Binomial. This was found also by [\citep=kalktawi15], where a frequentist approach was used and the comparison was made also with additional models such as COM-Poisson and hurdle/zero-inflated models.

Comparison with Bayesian penalised regression

In this section, we compare the performance of BDW to BPoisson and BNB regression for variable selection on a dataset with several variables. In particular, we consider the multivariate data of [\cite=machado05]. The data consist of 5096 observations from the 1985 wave of the German Socioeconomic Panel. As in [\cite=machado05], we measure the demand in healthcare by the number of visits to a specialist (except gynecology or pedriatics) in the last quarter. The 20 covariates are listed in full in Table A.1 of [\cite=machado05] and are the same considered in this paper. This is an extreme example of excessive zeros as the response variable contains 67.82% of zeros.

We fit a BDW model with a Laplace prior on the regression parameters and a Gamma(2,1) hyper-prior on the shrinkage parameters. We consider 175000 iterations for the MCMC routine and similar configurations for the Bayesian Poisson and NB models. We also extend the comparison by including frequentist L1 regularized models. In particular, we use the glmnet package [\citep=friedman2010regularization] to fit regularized Poisson regression and the glm.nb R function to fit regularized negative Binomial regression. In both cases, the penalty parameter is chosen by BIC. According to the results in Table ([\ref=ch3:table3]), DW(regQ,β) with the [formula] link achieves overall the best performance compared with the others BDW models and with NB and Poisson models.

Figure ([\ref=fig:Visiting_specialist_QregVsBreg]) shows the marginal densities of the parameters for the DW(regQ,β) with the [formula] link. Highlighted in red are those variables that are found to be significant based on the 95% HPD interval. The selection is overall in accordance with the results obtained by [\cite=machado05] using a jittering approach, with variables such as gender, chronic complaints, sick leave and disability found to be significant, and other variables like unemployment, private insurance and those related to job characteristics, such as heavy labor, stress, variety on job, self-determined and control found not to be significant. Figure [\ref=fig:CC_density_plot] shows the effect of the variable chronic complaints on the conditional distribution, suggesting that the probability of a large number of visits is higher for the case of chronic complaints than for the case of no complaints. Table ([\ref=significant_variables_in_TNVTS]) further compares the selection of variables with those selected by Poisson and NB regression models. Overall, there is high agreement between BDW and NB, with the exception of the variable control which is found significant by NB (both in the Bayesian and frequentist estimation) but not by DW. Poisson and BPoisson tend to select many more variables.

Conclusion

In this paper we have proposed a novel Bayesian regression model for count data, by assuming a discrete Weibull conditional distribution. We have shown the applicability of this method to count data from the medical domain. In particular, we analyse datasets on the number of visits to doctors/specialists, a quantity that is often used as an indicator of healthcare demand. The response variable in the examples considered is discrete and is characterized by a skewed distribution, making the whole conditional distribution of interest and not only the conditional mean.

We have tested the inference procedure on simulated and real data with various characteristics, such as under-dispersion, over-dispersion and excess of zeros. Overall, we have found a good performance of the method in comparison with Poisson and NB regression models, on the basis of a number of information criteria and of the selection of influential variables. The method is implemented in the R package BDWreg, which is available in CRAN. Future work will explore an extension of the approach proposed in this paper to more flexible DW regression models, such as zero-inflated, multilevel and mixture DW models, in a similar spirit to the existing models for continuous responses [\citep=dunson07].