Corollary Lemma Proposition Definition Remark

Eventual return probability in multidimensional random walks

Introduction

It is well-known that the simple symmetric random walk of dimension 1 or 2 is recurrent, i.e. being started from the origin, it returns to the original point infinitely many times. Simple symmetric random walks of dimension higher than 2 are not recurrent. That is, their eventual return probability is less than 1.

The proofs of these facts are well-known, and nowadays they can be found in many textbooks on probability (e.g. see [\cite=Gr], [\cite=Sp] etc). The known result on the eventual return probability is very formal. It is based on the well-known standard technique of the theory of Markov chains, hardly useful and actually enables us to only check whether or not the random walk is recurrent. In [\cite=Gr], page 478, the authors claim without any justification that the eventual return probability for the simple symmetric random walk in Z3 is approximately .65. We reckon that this conclusion could be made on the basis of rough numerical estimate. According to our analysis and numerical calculations, the eventual return probabilities for random walks in Z3 and Z4 both are close to 1 (see Section [\ref=S5] for the results of numerical analysis).

In fact, the problem of calculation of the eventual return probability is a difficult open problem, which could not be solved for the long time (the original version of Spitzer's book [\cite=Sp] was published in 1964) in the framework of well-known traditional methods of the theory of random walks.

In recent paper [\cite=Ab], the author suggests a new combinatorial approach to multidimensional random walks, where the most important issue is the connection between multidimensional random walks and birth-and-death processes with specifically defined birth and death parameters. In the present paper, developing the results of [\cite=Ab] we derive the recurrence relations for the eventual return probability of the simple symmetric random walk in Zd.

The definition of the simple symmetric random walk in Zd is as follows. The random walk [formula] [formula], S(2)t,, [formula], [formula], is characterized by the following equations:

[formula]

where [formula] is the d-dimensional vector of zeros, and the random vector [formula] is defined as follows. Let [formula] denote the vector the ith coordinate of which is 1 and the rest coordinates are zeros. Then, the vector [formula] is one of the 2d vectors [formula] randomly chosen with the equal probability 1 / (2d).

For any vector [formula] [formula], n(2),, [formula] ∈Zd, its norm is denoted by

[formula]

The approach of this paper is based on the methods of queueing theory. Without loss of generality we assume that in each of its states, the random walk spends exponentially distributed time with mean 1 prior moving to another (neighbor) state. Then, under this assumption we study the functional [formula]. The functional φt is a birth-and-death process with specifically defined birth and death parameters. The values of these parameters are found in [\cite=Ab]. The contribution of this paper is to study the number of customers served during a busy period of the state-dependent queueing system, the parameters of which (arrival and service rates) are the specifically modified parameters of the birth-and-death process φt. If the number of served customers during the busy period is finite with probability 1, then the eventual return probability of the random walk is equal to 1. Otherwise, if the distribution of the number of served customers is not proper, then the eventual return probability of the random walk must be the same as the probability that the number of served customers during the busy period is finite.

The rest of the paper is organized as follows. In Section [\ref=S2], the basic result of the paper is presented. In Section [\ref=S3], we recall the connection between the random walk in Zd and birth-and-death process. We also establish important properties of the number of served customers during the busy period. Specifically, we demonstrate that specifically defined transformation of the birth-and-death parameters (measure transform) do not change the probability distribution function of the number of customers served during a busy period. In Section [\ref=S4], we derive the asymptotic recurrence relations for the required generating functions and prove basic theorem of the paper. In Section [\ref=S5], we provide numerical calculations. In Section [\ref=S6] we formulate and discuss an open problem. In Appendix 1 we recall necessary results of [\cite=Ab] in order to make the paper self-contained. Appendix 2 contains the listing of the C/C++ program used for the numerical calculations of the paper.

Basic result

Preliminary comment and notation

The following preliminary comment and notation are used for formulation of the basic theorem.

1. The eventual return probability z0  =   lim n  →    ∞z0(n) is found on the basis of the series of sequences [formula] (initial value of n is large enough), where z0(n) is determined from the specifically defined backward recurrence relation:

[formula]

2. The following technical notation is used:

[formula]

Basic theorem

For the eventual return probability we have as follows.

The following limiting recurrence relation is true:

[formula]

The term zn - i(n) is presented in the both sides of relation [\eqref=eq-2.2]. However, it is easy to see that [\eqref=eq-2.2] can be explicitly rewritten in the form of [\eqref=eq-2.3].

Birth-and-death process associated with the random walk in Zd

Consider the functional [formula] It satisfies the recurrence relation

[formula]

where

[formula]

and for positive φt - 1,

[formula]

[formula]

The details of the proof are given in [\cite=Ab] and now is provided in Appendix 1. Following the assumption that, in each of its state the random walk spends exponentially distributed time with mean 1, we arrive at the conclusion that φt is the birth-and-death process with the parameters

[formula]

and

[formula]

[formula], where C(j) and C0(j) are gived by [\eqref=eq-3.1] and [\eqref=eq-3.2].

Hence, the eventual return probability for the random walk must coincide with the probability that the busy period of the state-dependent queueing system, with rate arrivals λj and service rates μj, is finite. In further consideration, it is more convenient to deal with the number of customers served during a busy period rather than with a busy period itself. The probability that the number of customers served during a busy period is finite is the same as the probability that a busy period is finite.

The reason that we are going to work with the number of customers served during a busy period rather than with a busy period itself is that the derivation of the Laplace-Stieltjes transform for a busy period of such the queueing system, in which both the interarrival and service times are state-dependent, is a hard problem. The derivation of the generating function for the number of served customers during a busy period is much easier. By using the measure transform the original problem can be reduced to a more particular one, in which the arrival process is homogeneous. Then the problem can be solved by known methods.

Let X denote the set of parameters

[formula]

of the original birth-and-death process.

By ν(X) let us denote the number of customers solved during a busy period of the state-dependent queueing system with the given set of parameters X. Let f(n,X) denote the number of times during a busy period of the state-dependent queueing system (defined by the set of parameters X) when an arriving customer meets n customers in the system. Apparently, [formula]. (If the busy period is not finite, then the both sides of the equality are infinite.)

Let c1, c2, be an arbitrary sequence of positive numbers, and let

[formula]

be another set of parameters, which is defined correspondingly to X. Then, the notation ν(Y) and f(n,Y) have the similar meaning like that is given for ν(X) and f(n,X), respectively.

For all [formula]

[formula]

The proof is based on the result of [\cite=Ab], Lemma 5.1. The aforementioned lemma was proved for the state-dependent queueing system with the finite number of waiting places (as it was required in [\cite=Ab]). It however holds true when the number of waiting places is infinite. Now, we reformulate Lemma 5.1 [\cite=Ab] for this case. (For the proof of the lemma see Appendix 1.)

For the distribution of f(n,X) we have as follows. For all [formula],

[formula]

where the nonnegative integer-valued random vector [formula] is the Markov chain, satisfying the following properties: R0 = 1,

[formula]

and

[formula]

[formula], [formula].

It follows from this lemma that for all [formula]

[formula]

Indeed, it follows from [\eqref=eq-3.3] that both f(n,X) and f(n,Y) are described by the same Markov chain Rn. Hence, being the functionals of f(n,X) and f(n,Y), respectively, ν(X) and ν(Y) have the same distribution as well.

Based on Lemma [\ref=l1], the constants c1, c2, can be chosen as cj = 1 / λj, [formula]. Then,

[formula]

This choice enables us to keep arrival process Poisson with rate 1. In our model, the parameters λj and μj are defined by [\eqref=eq-1.3] and [\eqref=eq-1.4]. Hence, the set Y in [\eqref=eq-3.4] is

[formula]

where C(j) and C0(j) are given by [\eqref=eq-3.1] and [\eqref=eq-3.2]. Let [formula] denote shift operator of the set Y in [\eqref=eq-3.5]. That is,

[formula]

Then [formula] denotes m-fold shift operator. So,

[formula]

For m = 0, [formula] is an identical operator, i.e. [formula].

For [formula] denote

[formula]

In particular, for m = 0 this notation yields

[formula]

Proof of Theorem [\ref=t1]

The proof of Theorem [\ref=t1] consists of three parts. In the first part we derive the infinite system of equations for Pm(z), [formula]. In the second part we represent the system of the obtained equations in the form of limiting relation for integer parameter (index) n increasing to infinity. In the final part we complete the proof of the theorem. As before, we use the notation: p(n) = (C(n  +  1)  +  C0(n  +  1)) / (2C(n  +  1)), q(n) = 1 - p(n), [formula]

Infinite system of equations

The result of this section is the following lemma.

The generating function P0(z) satisfies the following system:

[formula]

Notice, that [formula] is the distribution of the number of customers served during the m + 1st busy cycle, the time interval that starts when there are m + 1 customers in the system until the moment when there remain m customers, and Pm(z) is the corresponding generating function. Using the arguments similar to those in [\cite=Tak], we obtain as follows. If during the service time of a first (tagged) customer no arrivals occur, then the number of customers served during the m + 1st busy cycle is 1, and, hence, the corresponding conditional generating function is z. If during the service time of a tagged customer there are n arrivals, then the conditional generating function of the m + 1st busy cycle is [formula] Applying now the total probability formula, we arrive at [\eqref=eq-3.6].

Limiting recurrence relations

The aim of this section is to establish the limiting recurrence relations for the generation functions P0(z). Note first that

[formula]

Hence, the limiting distribution [formula] does exist and can be written in explicit form. This makes the possibility for sufficiently large n to consider the equation

[formula]

which can be obtained from the equation for Pn(z) in [\eqref=eq-3.6] by replacing Pn + j(z), [formula] all by Pn(z). Thus, Pn(z,n) is an approximation for Pn(z).

The formal solution of equation [\eqref=eq-4.5] is in which the only solution

[formula]

is true, because |Pn(z,n)| must be not greater than 1.

Consider now the system of recurrence relations

[formula]

The system of recurrence relations [\eqref=eq-4.2] is an approximate form of the basic recurrence relation in [\eqref=eq-3.6] with the finite number of terms. It is not difficult to show that the system of recurrence relations [\eqref=eq-4.2] is monotone increasing in n. Indeed, consider two systems. For the first system Pn(z,n) is defined by [\eqref=eq-4.5] and the following recurrence relations for Pn - i(z,n) are defined by [\eqref=eq-4.2]. For the comparison purposes, we add upper index (1), and now will write P(1)n - i(z,n) ([formula]) rather then Pn - i(z,n). For the second system, we first define Pn + 1(z,n + 1) satisfying the equation

[formula]

which is similar to [\eqref=eq-4.5], and then define recurrently P(2)n - i(z,n + 1) adding upper index (2). Since p(n) increases and q(n) decreases, then Pn + 1(z,n + 1) > P(1)n(z,n). Furthermore, P(2)n(z,n + 1) > P(1)n(z,n). Indeed, replacing in the representation for P(2)n(z,n + 1) the term Pn + 1(z,n + 1) by the smaller term P(1)n(z,n), we can easily see the truth of the desired inequality. The following use of induction enables us to easily prove the inequality P(2)n - i(z,n + 1) > P(1)n - i(z,n), [formula], by comparing the terms P(2)n - i + 1(z,n + 1) with the corresponding smaller terms P(1)n - i + 1(z,n).

Thus, P0(z,n) is monotone increasing, and hence the limit as n  →    ∞   of P0(z,n) is defined and coincides with P0(z).

Final part of the proof

In order to find the eventual return probability, we are to use the Tauberian theorem by letting z to tend to 1, that is, to find the limit [formula].

For the system of recurrence relations given by [\eqref=eq-4.7] and [\eqref=eq-4.2], the limits in n and in z are interchangeable, since double sequences are bounded and monotone increasing in n and z. Then we arrive at the following system:

[formula]

[formula]

which after changing the notation Pm(1,n) with zm(n) leads to the statement of theorem. The theorem is proved.

Numerical results

The numerical results for evaluation of eventual return probability are provided for n = 50,000 and for dimensions d = 2,3,4,5,6,7,8,9,10 and given in Table 1. The numerical calculations enable us to conclude that in dimensions 3 and 4 the eventual return probabilities are close to 1. This result is unexpected. It was believed that these probabilities should take some moderate value between 0 and 1.

Discussion and open problem

In this paper, on the basis of the connection between random walks and birth-and-death processes we found the recurrence relation for the eventual return probability of the simple symmetric random in Zd and provided numerical calculations for the eventual return probability. According to the known results of the random walk theory, the eventual return probability for random walk in Z2 is 1, while the eventually return probability for the dimensions higher than 2 the eventual return probability is less than.

To understand this phenomenon let us derive asymptotic expression for Pn(1,n) when n is large. The explicit relation for Pn(z,n) is given by [\eqref=eq-4.5], and that expression can be written in the form of infinite series. Writing the large number of terms of this series, say n, and setting z = 1, we have the following asymptotic expansion

[formula]

Taking into account the explicit values of C(n + 1) and C0(n + 1) given in [\eqref=eq-3.1] and [\eqref=eq-3.2], we obtain

[formula]

and hence, from [\eqref=eq-6.1] we obtain The term

[formula]

in this expansion is crucial, and it affects on the fact whether or not a period of the birth-and-death process (or busy period in the queueing terminology) has a proper distribution. When d = 2, the value (d2 - 1) / 4 = 3 / 4, and under this value the distribution is proper. When d = 3, the value (d2 - 1) / 4 = 2, and under this value the distribution is not proper. So, the open problem is formulated as follows.

Open problem. Consider a birth-and-death process with the rates of birth and death λi and μi, respectively. Assume that λi  >  μi and, as i increases to infinity, lim i  →    ∞λi  /  μi = 1. Assume that for large n the following estimate is true What is the fractional threshold value of θ such that the period of the birth-and-death process would have a proper distribution?

Appendix 1

A.1. Birth-and-death process φt

To obtain the birth and death rates of the birth-and-death process φt we need to study the cardinality of level-sets.

Proposition A.1 Let n > 0 is integer number. Then the number of vectors in Zd with norm n is

[formula]

The number of vectors in Zd having i nonzero coordinates is [formula], where [formula] means the number of ways to represent given i coordinates in d places , and [formula] means the number of ways to represent a positive integer number n as sum of i positive integers. The factor 2i includes the possibility to represent these elements with positive and negative signs. Then, the sum over i yields the desired result.

Since each vector contains d component, then the total number of components in all the vectors in Zd having norm n is

[formula]

The total number of zero components in all the vectors in Zd having norm n is

[formula]

If φt - 1 = n, then the phase space for φt contains 2C(n) states, since each of C(n) coordinates can increase or decrease by unit. Then, the possible number of events {φt = n + 1} is C(n) + C0(n), while the possible number of events {φt = n - 1} is C(n) - C0(n) and all possibilities are equally likely. The fact that the process φt spends in each state an exponentially distributed time with mean 1 enables us to conclude that φt is the birth-and-death process with the birth parameter λn = C(n) + C0(n) and death parameter μn = C(n) - C0(n).

A.2. Proof of Lemma [\ref=l3]

Let a(j)1, a(j)2,,a(j)f(j,X) denote the moments of arrivals when an arriving customer finds j customers in the system, d(j)1, d(j)2,,d(j)f(j,X) denote the moments of service completions (departures) of the customers after which there are remain only j customers in the system. Since the busy period starts with a single customer, then a(0)1 coincides with the busy period start, d(0)1 coincides with the busy period completion, and z0 = 1. For 1  ≤  j, the time intervals

[formula]

are contained in the intervals

[formula]

Let us delete the intervals of (A.3) from those of (A.4) and merge the ends. Then, according to the property of the lack of memory, the number of merged points in each of the intervals of (A.4) coincides in distribution with the number of arrivals per service time (provided that arrival and service rates are unchanged and respectively equal to the values of parameters λj and μj) and has geometric distribution with parameter λj / (λj  +  μj). This enables us to conclude that {f(j,X)} have the structure of branching process, in which the distribution of the number of offspring in the jth generation depends on the order number of generation, j, and is described by [\eqref=eq-3.3] and [\eqref=eq-3.7]. Hence, f(j,X) = Rj, and [\eqref=eq-3.8] follows.

Appendix 2

A.3. Listing of the C/C++ program for an approximate calculation of the eventual return probability