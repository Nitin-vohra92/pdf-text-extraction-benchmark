Question Lemma Corollary Corollaries Proposition Criterion Conjecture Hypothesis

Definition Definition-Proposition Data Construction Notation Assumptions Condition Example Problem Algorithm Remark Remarks Note Summary

Claim

On minimal log discrepancies

Introduction

1991 Mathematics Subject Classification. Primary: 14B05, Secondary: 14E30.

The Logarithmic Minimal Model Program (LMMP for short) predicts that an algebraic variety can be simplified by performing a finite sequence of surgery operations (extremal contractions and flips). Although singularities appear naturally in the process, there exists a class of mild singularities preserved by these operations. It is expected that varieties with only log canonical singularites form the largest class in which LMMP works.

These mild singularities are controlled by minimal log discrepancies (m.l.d.'s for short), invariants introduced by V.V. Shokurov [\cite=problems]. For instance, the m.l.d. of a variety X in a nonsingular (Grothendieck) point η∈X is just the codimension of X in η.

Related to the existence and termination of flips is the A.C.C. Conjecture, proven in codimension two [\cite=term] [\cite=acc], and for Γ  =  {0} in the case of toric varieties [\cite=Bor] (see Section 1 for definitions and notations):

[\cite=problems] Let (X,B) be a log variety, and let Γ  ⊂  [0,1] be a subset satisfying the descending chain condition. Then the set

[formula]

satisfies the ascending chain condition (a.c.c. for short).

Note that A(Γ,n) satisfies a.c.c. iff it is bounded from above and it has no accumulation points from below. The following conjecture, proven up to codimension three [\cite=C3f] [\cite=Mrk] [\cite=Kaw], proposes a sharp upper bound:

[\cite=problems] Let (X,B) be a log variety and let η∈X be a Grothendieck point. Then the following inequality holds:

[formula]

Moreover, X is nonsingular in η if [formula].

Our main interest is in the first part of Conjecture [\ref=max_mld]. We formulated a stronger form in [\cite=Am], as a lower semi-continuity behaviour of minimal log discrepancies:

We should note here that lower semi-continuity does not hold if we allow the codimension of the points to jump. It turns out that lower semi-continuity is in fact equivalent to the following stronger form of the inequality proposed in Conjecture [\ref=max_mld]:

Hypothesis [\ref=precise] has interesting inductive properties (cf. Section 2). Our main result is the following:

In section 1 we review basic definitions and results. The equivalence of Hypotheses [\ref=lower_semicontinuity] and  [\ref=precise] is proved in section 2, as a formal consequence of the Finiteness Theorem [\ref=finite]. The latter states that the set of all minimal log discrepancies of a log pair (X,B) form a finite set [formula], called the mld-spectrum of (X,B). Moreover, the fibers of the mld map [formula], defined on the closed points of X, give a finite partition of X into constructible sets. Section 3 contains the proof of Hypothesis [\ref=precise] under the extra assumption [formula]. It is based on LMMP in dimension 3 (cf. [\cite=mori-3folds] [\cite=3-flips] [\cite=3-models]), and on known results on 3-dimensional canonical and terminal points (cf. [\cite=C3f] [\cite=canmod] [\cite=mori-term] [\cite=Mrk] [\cite=Kaw] [\cite=acc]). The last section is a good illustration for all the above: Hypothesis [\ref=lower_semicontinuity] follows from explicit formulae for minimal log discrepancies.

Prerequisites

A variety is a reduced irreducible scheme of finite type over a fixed field k, of characteristic 0. An extraction is a proper birational contraction of normal varieties. We will use Zariski's Main Theorem in the following form: if μ:  →  X is an extraction and x∈X is a closed point such that dim μ- 1(x) = 0, then μ is an isomorphism over a neighborhood of x (cf. [\cite=Ha]).

We denote by ηX the generic point of a variety X. A Grothendieck point η∈X is called proper if η  ≠  ηX. A neighborhood of η in X is an open subset U  ⊆  X such that η∈U.

A log pair (X,B) is a normal variety X equipped with an [formula]-Weil divisor B such that K + B is [formula]-Cartier. B is called the pseudo-boundary of the log pair. A log variety is a log pair (X,B) such that B is an effective divisor.

A log pair (X,B) has log nonsingular support if X is nonsingular and [formula] is a divisor with normal crossings [\cite=KMM].

A log resolution of a log pair (X,B) is an extraction μ:  →  X such that [formula] is nonsingular and [formula] is a divisor with normal crossings.

If (X,B) is a log pair and μ:  →  X is an extraction, there exists a unique divisor [formula] on [formula] such that

[formula] on [formula],

[formula].

The divisor [formula], called the log codiscrepancy divisor of K + B on [formula], determines a log pair structure on [formula].

The induced log pair [formula] has log nonsingular support if μ:  →  (X,B) is a log resolution. In the sequel, when we say that μ:(,)  →  (X,B) is a log resolution, it is understood that [formula].

Let (X,B) be a log pair. Let [formula] be a prime divisor on an extraction of X. The log discrepancy of E with respect to K + B (or with respect to (X,B)), is defined as

[formula]

where e is the coefficient of E in the log codiscrepancy divisor [formula]. By definition, al(E;X,B) = 1 if E is not in the support of [formula]. The center of E on X is μ(E), denoted by cX(E). The log discrepancy al(E;X,B) depends only on the discrete valuation defined by E on k(X), in particular independent on the extraction [formula] where E appears as a divisor. We will write a(E;X,B) or a(E;B), dropping the index l and even the variety X from the notation. However, a(E;B) should not be confused with the standard notation in the literature for the discrepancy of K + B in E, which is equal to - 1 + al(E;X,B).

In the above notation, the log discrepancies for prime divisors on [formula] are uniquely determined by the formula

[formula]

where the sum runs over all prime divisors of [formula].

(V.V. Shokurov) The minimal log discrepancy of a log pair (X,B) in a proper Grothendieck point η∈X is defined as

[formula]

where the infimum is taken after all prime divisors on extractions of X having η as a center on X. We set by definition a(ηX;X,B) = 0.

The log pair (X,B) has only log canonical (Kawamata log terminal) singularities if a(η;B)  ≥  0 (a(η;B) > 0) for every proper point η∈X. Also, (X,B) is said to have only canonical (terminal) singularities if a(η;B)  ≥  1 (a(η;B) > 1) for every point η∈X of codimenision at least 2.

[\cite=KMM] One can read the singularity type on a resolution. Indeed, assume μ:(,)  →  (X,B) is a log resolution. Then (X,B) has only log canonical singularities (Kawamata log terminal singularities) iff the same holds for (,). Since (,) has log nonsingular support, this is equivalent to the fact that all the coefficients of [formula] are at most 1 (strictly less than 1).

Since any extraction is an isomorphism up to codimension 1, one can easily compute minimal log discrepancies in these cases. Indeed, if [formula], then a(η;B) = 0 by definition. If [formula], then a(η;B) = 1 - bη, where bη is the coefficient of B in [formula] (which is zero if η is not in the support of B).

In Grothendieck points of codimension at least 2, the minimal log discrepancy is either a non-negative real number, or -    ∞  :

[\cite=Ko1] Let (X,B) be a log pair and let η∈X with [formula].

If (X,B) is not log canonical in any neighborhood of η, then

[formula]

Assume that (X,B) is log canonical in a neighborhood of η. Let (,) be a log resolution of (X,B) such that μ- 1() is a divisor and [formula] has normal crossings. Then

[formula]

Under the same assumptions, the following hold:

a(η;B) =  -   ∞   if a(η;B) < 0.

a(η;B) =  -   ∞   if η∈E is a proper point of a prime divisor E with a(ηE;B) < 0.

(of Proposition  [\ref=ml]) i): By Lemma [\ref=ml_lemma].a), we just need to show that (X,B) is log canonical in some neighborhood of η if a(η;B)  ≥  0. Suffices to show that a(ξ;B)  ≥  0 for all η∈. Assume by contradiction that a(ξ;B) < 0. Let E be a prime divisor on an extraction μ:  →  X such that a(E;B) < 0 and cX(E) = ξ. Since η∈ is a proper point, there exists a proper point η'∈E such that cX(η') = η. From Lemma [\ref=ml_lemma].b), a(η';B) =  -   ∞  , hence a(η;B) =  -   ∞  . Contradiction!

ii): Follows from Lemma [\ref=formula].

(of Lemma [\ref=ml_lemma]) a): Let E be a prime divisor on an extraction μ:  →  X such that a(E;B) < 0 and cX(E) = η. Since the induced map μ|E:E  →   has generic fibers of positive dimension, there exists a proper point η'∈E such that cX(η') = η. Thus a(η;B)  ≤  a(η';), hence suffices to check b).

b): We may assume that (X,B) has log nonsingular support. Let E1 be the exceptional divisor on the blow-up in η, and let η1 be a component of [formula] dominating η. Inductively, let Ek + 1 be the exceptional divisor on the blow-up in ηk, and let ηk + 1 be a component of [formula] dominating ηk. A simple computation gives

[formula]

In particular, a(η;B) =  -   ∞  .

Assume X is a nonsingular variety and [formula] is a divisor with normal crossings supporting the divisor [formula].

For J∈P(I) denote [formula] and [formula] (set [formula] and [formula]);

For η∈X set I(η) = {i∈I;η∈Ei}∈P(I), and let Cη be the generic point of the unique component of EI(η) containing η.

Assume that (X,B) is a log nonsingular pair having only log canonical singularities in η∈X. Then

[formula]

In particular, [formula].

In other words, if non-negative, minimal log discrepancies on log pairs with log nonsingular support are attained on the first blow-up. This is definitely false in general.

Step 1: We first check that inf η∈Ei0a(η;B) = ai0. Indeed, [formula] [\cite=KMM], so a(η;B)  ≥  ai0 if η∈Ei0. The equality is attained on the generic point of Ei0.

Step 2: Assume η is the generic point of a connected component of EI(η). Blowing up X in η we have again a log nonsingular pair, and the new divisor E has log discrepancy aI(η). From the previous case, we infer a(η) = aI(η).

Step 3: Otherwise, shrinking X, we may assume that I(η) = I, and there exist divisors {Bj}j∈J such that [formula] has log nonsingular support and [formula] is a connected component of [formula]. Set ai = 1 for all i∈J. From Step 2, [formula].

Hypothesis [\ref=precise] is valid if we further assume that (X,B) has log nonsingular support.

Indeed, let η,ξ∈X with η∈. There is nothing to prove if a(η;B) =  -   ∞  , so we may assume that (X,B) has only log canonical singularites in η. Then [formula] where [formula].

Minimal log discrepancies behave well with respect to products.

If (X,BX) and (Y,BY) are two log pairs, we denote by (X  ×  Y,BX  ×  Y) the product log pair, i.e. the usual product with canonical Weil divisor KX  ×  Y = KX  ×  Y + X  ×  KY and pseudoboundary BX  ×  Y = BX  ×  Y + X  ×  BY. Note that

[formula]

where p1 and p2 are the projections.

One can easily check that (X  ×  Y,BX  ×  Y) has log nonsingular support if so do (X,BX) and (Y,BY). Moreover, If μ:(,)  →  (X,B) and ν:(,D̃)  →  (Y,D) are log resolutions then

[formula]

is a log resolution. We will need the folowing lemma:

Assume η and ξ are points on the log pairs (X,BX) and (Y,BY), respectively. Then

[formula]

For good resolutions that compute minimal log discrepancies,

[formula]

is a divisor with normal crossings, and

[formula]

For simplicity, we may assume a(η;BX),a(ξ;BY)  ≥  0 (the other cases are similar). Therefore ai,bj  ≥  0 near η and ξ respectively, and Lemma [\ref=formula] gives

The mld stratification

Let (X,B) be a log pair. The set

[formula]

is called the mld-spectrum of (X,B). The partition of X given by the fibers of the map

[formula]

defined on the closed points of X, is called the mld-stratification of (X,B).

(Finiteness) The mld-spectrum [formula] of a log pair is a finite set, and the mld-stratification is constructible, i.e. all the fibers of the map a are constructible sets.

Assume W  ⊂  X is a closed irreducible subvariety and (X,B) is a log pair with only log canonical singularities in ηW. Then there exists an open subset U of X such that [formula] and

[formula]

for every closed point [formula].

(of Theorem [\ref=finite]) Suffices to prove that a|W takes a finite number of values and its fibers are constructible subsets, for every closed subset W  ⊆  X. There is nothing to prove if dim W = 0, so let dim W > 0. Let W0 be an irreducible components of W. From Lemma [\ref=ml_lemma].b) and Proposition [\ref=key_fin], there exists an open subset U0  ⊂  X such that [formula], [formula] is constant, and U0 does not intersect the other irreducible components of W. Thus

[formula]

and we are done by Noetherian induction.

(of Proposition [\ref=key_fin]) Let μ:(,)  →  (X,B) be a log resolution with a normal crossing divisor [formula] on [formula] supporting [formula] and the divisor μ- 1(W). Shrinking X near W, we may assume

[formula]

for some subset IW  ⊆  I, and μ(Ei) = W for every i∈IW. We may assume that (X,B) has only log canonical singularities, and dim W > 0. Note that a(ηW;B) =  min i∈IWai.

Removing from X all components of [formula] that do not contain W, we may assume that W  ⊆  μ(C), or [formula] for every (connected) component C of [formula]. We call relevant those components C with W = μ(C). The following hold:

[formula] and dim C =  dim  - |I(ηC)| for every relevant C.

If η∈μ- 1(W), then Cη, the unique component of EI(η) containing η, is relevant.

Since the generic fibers of the morphisms μ|C:C  →  W have expected dimension, there exists an open subset U  ⊂  X such that [formula] and

[formula]

for every relevant C and for every closed point [formula].

Let [formula] and η∈μ- 1(x). Then [formula], hence

[formula]

But [formula] and all ai's are non-negative numbers, hence a(I(η))  ≥  a(ηW). Thus a(η)  ≥  a(ηW) +  dim W. Taking infimum after all η's as above, we obtain

[formula]

Finally, let k∈IW be an index such that a(ηW;B) = ak. Let η be the generic point of an irreducible component of [formula] of maximal dimension. Since Ek is relevant, [formula]. Moreover, I(η) = {k} since [formula]. Therefore [formula], and the above inequality is in fact an equality.

Fix a log pair (X,B) and consider the function

[formula]

The fiber a- 1( -   ∞  ) is closed. It is the union of all closed subvarieties W of X such that a(ηW;B) =  -   ∞  . Its complement is the biggest open subset of X on which (X,B) has log canonical singularities.

[formula] is the complement of the biggest open subset of X on which (X,B) has Kawamata log terminal singularities. It is denoted Nklt(X,B), or LCS(X,B).

The fiber a- 1( dim X) contains the open dense subset [formula], and the converse inclusion should hold if B is effective, according to the second part of Shokurov's Conjecture.

Note that Lemma [\ref=mld_product] implies that

[formula]

The first part of Conjecture [\ref=max_mld] can be reduced to Hypothesis [\ref=lower_semicontinuity]. Indeed, we may assume η  =  {x} is a closed point. The function a(x;B) would jump downwards only in special points, and it is constant equal to dim X on an open dense subset of X. Therefore sup x∈Xa(x;B)  =   dim X.

The two hypotheses [\ref=lower_semicontinuity] and  [\ref=precise] are equivalent.

Assume Hypothesis [\ref=precise] is valid, and let x∈X be a closed point. Using Theorem [\ref=finite], we may shrink X such that x∈ for every irreducible component C of the fibers of the map a. For x'∈X, there exists a C such that x'∈C. Since x∈, we infer that a(x;B)  ≤  a(ηC;B) +  dim ηC. But a(ηC;B) +  dim ηC = a(x';B), so we are done.

Assume Hypothesis [\ref=lower_semicontinuity] is valid. According to Proposition [\ref=key_fin], we may assume that η  =  {x} is a closed point and x∈. Let Ux be a neighborhood of x such that a(x;B)  ≤  a(x';B) for all x'∈Ux. Then [formula] is an open dense subset. From Proposition [\ref=key_fin], there exists some [formula] such that a(x';B) = a(ξ;B) +  dim ξ. Therefore a(x;B)  ≤  a(ξ;B) +  dim ξ.

Hypothesis [\ref=precise] has very strong inductive properties. Denote by Hc the Hypothesis [\ref=precise] with the extra assumption [formula]. Fix η∈X a point of codimension c, that we may assume to be a closed point x.

Suppose that Hc' is valid for c' < c. Then Hc for x is equivalent to the following weaker version: if C is a curve passing through x, then a(x;B)  ≤  a(ηC;B) + 1

Suppose Hc' is valid for c'  ≤  c and the characterization of nonsingularity from Conjecture [\ref=max_mld] is valid for c' < c. Then a(x;B) >  dim X - 1 implies that x is an isolated singularity. Thus the new case in each dimension is that of isolated singularities.

Lower semi-continuity up to codimension 3

By Lemma [\ref=equiv], suffices to check Hypothesis [\ref=precise]. We think of η∈X as being fixed, and we shrink X to neighborhoods of η without further notice.

We may assume a(η;B) > 1, otherwise there is nothing to prove. Therefore (X,B) has only log canonical singularities by Proposition [\ref=ml]. In particular, the coefficients of B are non-negative numbers less than or equal to 1 (note that (X,B) might not be Kawamata log terminal). Minimal log discrepancies are invariant to cutting with generic hyperplane sections, hence for our purposes we can always assume that some fixed Grothendieck point is in fact closed.

We will need the following results:

[\cite=acc] Assume (X,B) is a log variety, and X is nonsingular in η. Then the following hold:

[formula].

[formula] iff [formula] and [formula].

[\cite=Al] Assume η∈X is a singular point of codimension 2 on the log variety (X,B). Then a(η;B)  ≤  1. Moreover, equality holds iff [formula] and X has a Du Val singularity in η.

Hypothesis [\ref=precise] is valid if [formula].

Since a(η;B)  ≤  1 if [formula], we may assume [formula]. By assumption, a(η;B) > 1, hence Proposition [\ref=dimtwo] implies that X is nonsingular in η and

[formula]

Therefore [formula]. If [formula], decompose B = b  ·   + B', with 0  ≤  b  ≤  1 and [formula]. Then a(η;B)  ≤  2 - b = a(ξ;B) + 1.

Assume X is a 3-fold and KX is [formula]-Cartier (we take B = 0). The following hold for a singular closed point x∈X:

[\cite=C3f] If (x,X) is a canonical singularity of index 1, then either a(x) = 1, or X has a cDV singularity at x, i.e. there exists a hyperplane section H  ⊂  X having a Du Val singularity in x.

[\cite=Mrk] a(x) = 2 if X has a cDV singularity in x.

[\cite=Kaw] [formula] if (x,X) is a terminal singularity of index r.

See also [\cite=Msk] for upper bounds of minimal log discrepancies of certain hypersurface singularities.

Assume η∈X is a point of codimension 3 on the log variety (X,B) such that a(η;B)  >  2. Then X is nonsingular in η.

We may assume dim X = 3 and η  =  {x} is a closed point.

Step 1: By Lemma [\ref=why], a(ηC;B) > 1 for every curve passing through x. From the codimension 2 case, (X,B) has only terminal singularities.

Step 2: X has [formula]-factorial singularities. Indeed, from LMMP we can find a [formula]-factorialization μ:(,)  →  (X,B), where (,) is a log variety again. If dim μ- 1(x) > 0, there exists η∈μ- 1(x) with [formula], hence a(η;)  ≤  2 from the codimension <  3 cases. Then a(x;B)  ≤  2. Contradiction! Otherwise, dim μ- 1(x) = 0. Zariski's Main Theorem implies that μ is an isomorphism over a neighborhood of x, hence X is [formula]-factorial.

Step 3: Assume by contradiction that x is a singular point. Then it must be an isolated terminal point. From Theorem [\ref=3known], [formula], where r is the index of KX at x. Contradiction!

Assume x∈W  ⊂  X, and dim X = 3. Assume that either [formula] and a(ηW;B)  ≤  0, or [formula] and a(ηW;B)  ≤  1. Then

[formula]

We may assume a(x;B)  ≥  0 and a(ηW;B)  ≥  0.

Step 1: Assume [formula] and a(ηW;B) = 0. By easy divisorial adjunction, a(x;B)  ≤  a(x;BWν), where BWν is the different of K + B on the normalization Wν of W. The log variety (Wν,BWν) has dimension 2, so a(x;BWν)  ≤  2.

Step 2: Assume [formula] and 0  ≤  a(ηW;B)  ≤  1. From LMMP, there exists a crepant extraction μ:(,)  →  (X,B) such that [formula] is effective and there exists a prime divisor E on [formula] with μ(E) = W and a(ηE;) = a(ηW;B). Let η be the generic point of a curve in the fiber of μ|E:E  →  C over x. From the codimension 2 case, a(η;)  ≤  a(ηE;) + 1. But a(x;B)  ≤  a(η;), so we are done.

Hypothesis [\ref=precise] holds if [formula].

We may assume that η is a closed point x on the 3-fold X.

Step 1: Assume [formula] is a curve C passing through x. From Lemma [\ref=why], we may assume that a(ηC;B) > 1. Then we may also assume a(x;B) > 2, hence X is nonsingular in both x and ηC. By Lemma [\ref=close], [formula] and [formula]. Therefore

[formula]

Step 2: Assume [formula] is a surface S passing through x. Let x∈C  ⊂  S be a curve. Then a(ηC;B)  ≤  a(ηS;B) + 1 from the codimension 2 case. From the previous step we get a(x;B)  ≤  a(ηC;B) + 1, thus a(x;B)  ≤  a(ηS;B) + 2.

The following characterization of cDV singularities is part of the folklore, but we include here a proof for completeness.

Assume (X,B) is a log variety and η∈X is a point of codimension 3. Then a(η;B) = 2 iff exactly one of the following holds:

[formula] and X has a cDV singularity in η (i.e. a cDV singularity after cutting [formula] with [formula] general hyperplanes).

X is nonsingular in η and [formula].

The second part follows from Lemma [\ref=close], so we just have to prove i). We may assume dim X = 3 and η  =  {x} is a closed singular point.

Step 1: (X,B) has only canonical singularities. Indeed,

[formula]

for every curve passing through x. From the codimension 2 case, (X,B) has only canonical singularities on [formula]. But a(x;B) = 2, hence we are done.

Step 2: Assume that B is [formula]-Cartier. Then KX is [formula]-Cartier, and let r be the index of X at x. Since 2  ≤  a(x;B)  ≤  a(x;0)  ≤  2, we infer that B = 0 near x and a(x): = a(x;0) = 2. We just have to prove that r = 1, since then X has only canonical Gorenstein singularities, and therefore x∈X is a cDV point due to Theorem [\ref=3known].i). Note that if x∈X is a terminal point, then [formula] by Kawamata, hence r = 1. X admits a terminal crepant extraction by [\cite=canmod], i.e. there exists an extraction μ:  →  X such that [formula] has only terminal singularities and [formula]. Note that 2 = a(x)  ≤  a() for every closed point ∈μ- 1(x). Thus the terminal subcase implies that [formula] is Cartier. In particular, KX is Cartier near x, i.e. r = 1.

Step 3: Assume that B is not [formula]-Cartier at x. We have to show that this is impossible. From LMMP we can find a small extraction μ:  →  X such that [formula] is [formula]-factorial. Let [formula] be the proper transform of B. In particular, μ*(K + B) = K + . If η∈μ- 1(x), then

[formula]

We have dim μ- 1(x) > 0. Otherwise, Zariski's Main Theorem would imply that μ is an isomorphism over a neighborhood of x. Thus B is [formula]-Cartier, contradicting our assumption.

Therefore μ- 1(x) is a connected union of curves and [formula] has only cDV isolated singularities in μ- 1(x) from Step 2. Moreover, [formula] intersects μ- 1(x) in a finite set of points. Otherwise, if some curve C over x is included in [formula], then a(ηC;B) < 2, a contradiction.

We arrive at the final contradiction with the following argument, kindly suggested by V. V. Shokurov: [formula] is μ-nef, but not μ-trivial, since [formula] intersects the fiber μ- 1(x). However, [formula] admits no flipping contraction since its difficulty [\cite=nonv] is 0. Contradiction!

Toric minimal log discrepancies

We refer the reader to [\cite=Fu] for definitions and basic notations of toric geometry. Let X = TNemb(Δ) be a toroidal embedding, and let {Bi}ri = 1 be the TN-invariant divisors of X, corresponding to the primitive vectors {vi}ri = 1 on the 1-dimensional faces Δ. Note first that [formula] and [formula] is log canonical (cf. [\cite=Al_lcsp]).

Let [formula] be an invariant [formula]-divisor such that K + B is [formula]-Cartier. This is equivalent to the existence of some linear form [formula] such that φ(vi) = ai for every i. Moreover, assume 0  ≤  ai  ≤  1 for every i, hence (X,B) is a log variety with log canonical singularities.

[\cite=Bor] Let TN(Δ')  →  X be the birational extraction induced by a subdivision Δ'  ⊂  Δ, and let Ev  ⊂  TN(Δ') be the invariant prime divisor corresponding to a primitive vector v∈|Δ|. Then

[formula]

Since any toric variety can be resolved by a basic subdivision of the fan, we obtain the following formula for minimal log discrepancies in orbits:

[formula]

Here, [formula] denotes the relative interior of [formula], and [formula] is the TN-orbit corresponding to the cone σ∈Δ. We dropped the primitiveness assumption on the vectors since φ is non-negative on |Δ|. Note that a{0} = 0.

In the above notations, let [formula] be the partition of X into TN-orbits.

Each strata in the mld-stratification is a union of orbits. In other words, [formula] for every cone σ∈Δ and every closed point [formula].

[formula] for all cones τ,σ∈Δ such that τ is a face of σ (i.e. [formula] is in the closure of [formula]).

In particular, Hypothesis [\ref=lower_semicontinuity] is valid for toric varieties.

i): The equality holds for the generic closed point [formula] from Proposition [\ref=key_fin]. This extends to all the points in [formula] since TN acts transitively on orbits and leaves the boundary fixed.

ii): Let τ be a proper face of σ and let aτ  =  φ(v) for some [formula]. We can find primitive vectors [formula] on the 1-dimensional faces of σ such that

[formula]

Therefore [formula].

Assume [formula] and [formula]. Let [formula]. Then [formula]. Therefore [formula].

The second part of Conjecture [\ref=max_mld] has the following interpretation on toric varieties:

Let [formula] be a strongly rational polyhedral cone generated by the primitive vectors [formula]. Assume [formula] is a linear form such that 0  ≤  φ(vi)  ≤  1 for every i, and let

[formula]

If φσ  >   dim σ - 1 then σ is a nonsingular cone.

According to Proposition [\ref=mld_toric], under the above assumptions we have

[formula]

Moreover, φσ  =   dim σ iff φ(vi) = 1 for every i. Indeed, the same equality must hold for any proper face of σ, in particular for the 1-dimensional rays of σ, hence [formula] for every i.

We use induction on n =  dim σ. If n = 1, there is nothing to prove, so let n  ≥  2. By Proposition [\ref=mld_toric].ii), every proper face [formula] has the same property with respect to [formula]. By induction, all proper faces of σ are nonsingular cones.

Step 1: Assume σ is a simplicial cone, i.e. r = n. It is known that σ is nonsingular iff

[formula]

Assume Pσ  ≠  {0}. Since all proper faces are non-singular cones, [formula]. Therefore there exists [formula]. Then 0 < ti < 1 for every i, hence [formula]. Therefore [formula]. This implies [formula], a contradiction. Therefore Pσ  =  {0}, hence σ is a nonsingular cone.

Step 2: If [formula] is a face of codimension 1 and vi∉τ, then [formula] is a nonsingular cone of dimension n. Indeed, let [formula]. By assumption, σ' is a simplicial cone of dimension dim σ. This also implies that [formula], hence σ' has the same property with respect to [formula]. Therefore σ' is nonsingular from Step 1.

Step 3: We may assume that r = n + 1. Indeed, if r = n we are done from Step 1. Otherwise, r  ≥  n + 1, and we show that this leads to contradiction. Let σ'  ⊆  σ be a cone of dimension n generated by n + 1 of the vectors vi's. Then σ' has the same property with respect to [formula], since [formula]. Therefore suffices to show that the case r = n + 1 is impossible.

Step 4: Assume [formula] is a face of codimension 1 and vi,vj∉τ. Then [formula]. Indeed, let [formula] be the generators of τ, which also form a basis of the lattice [formula]. From Step 2, [formula] and [formula] are both basis for the lattice [formula]. The transition matrix has determinant ±  1, hence the statement.

Step 5: Let σ be generated by [formula]. By Step 2, we may assume that [formula] is a basis of the lattice [formula], hence

[formula]

We show that ri∈{ - 1,0,1} for every i. At least one ri is positive (negative). Assume ri > 0. Then {vk;k∉{i,n + 1}} generates a codimension 1 face, hence

[formula]

On the other hand, [formula], hence ri  =    ±  1. Therefore ri = 1.

Assume rj < 0. If ri > 0, then {vk;k∉{i,j}} generates a codimension 1 face, so

[formula]

Since [formula], we deduce that r = 1. Therefore

[formula]

But [formula], thus rj  =    ±  1. Therefore rj =  - 1.

Step 6: Let [formula], where s  ≥  1 and s + 1  ≤  k  ≤  n. One can easily check that

[formula]

Therefore [formula]. Contradiction!