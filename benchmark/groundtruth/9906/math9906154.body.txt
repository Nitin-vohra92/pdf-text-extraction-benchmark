Aaron Robertson Temple University, Philadelphia, PA 19122 <aaron@euclid.math.temple.edu>

Herbert S. Wilf University of Pennsylvania, Philadelphia, PA 19104-6395<wilf@math.upenn.edu>

and

Doron Zeilberger Temple University, Philadelphia, PA 19122<zeilberg@euclid.math.temple.edu>

April 11, 1999

A (132) pattern (resp. a (123) pattern) in a permutation π of |π| letters is a triple 1  ≤  i < j < k  ≤  n of indices for which π(i) < π(k) < π(j) (resp. π(i) < π(j) < π(k)). Let fr(n) denote the number of permutations π of n letters that have no (132) patterns and exactly r (123) patterns. Our main result is the following.

The generating function for the {fr(n)} is

[formula]

in which the nth numerator is [formula].

We think it is remarkable that such a continued fraction encodes information about (132)-avoiding permutations. We will first prove the theorem, and then study some consequences and generalizations.

The patterns

Let the weight of a permutation π of |π| letters be z|π|q|123(π)|t|12(π)|, in which |123(π)| is the number of patterns (123) (rising triples) in π, and |12(π)| is the number of rising pairs in π. Let

[formula]

where the sum extends over all (132)-avoiding permutations π.

If π is a (132)-avoiding permutation on [formula], (n > 0) and the largest element, n, is at the kth position, i.e., π(k) = n, then by letting π1: = {π(i)}k - 11 and π2: = {π(i)}nk + 1, we have that every element in π1 must be larger than every element of π2, or else a (132) would be formed, with the n serving as the '3' of the (132). Hence, π1 is a permutation of the set [formula], and π2 is a permutation of the set [formula]. Furthermore, π1 and π2 are each (132)-avoiding. Conversely, if π1 and π2 are (132)-avoiding permutations on [formula] and [formula] respectively (for some k, 1  ≤  k  ≤  n), then (π1nπ2) is a nonempty (132)-avoiding permutation.

Thus we have:

[formula]

since a (123) pattern in [formula] may either be totally immersed in the π1 part, or wholly immersed in the π2 part, or may be due to the n serving as the '3' of the (123), the number of which is the number of (12) patterns in π1.

We also have

[formula]

and, of course

[formula]

Hence,

[formula]

Now sum over all possible (132)-avoiding permutations π, to get the functional equation

[formula]

in which the 1 corresponds to the empty permutation.

Next let Q(q,z,t) be the sum of all the weights of all permutations with exactly ONE (132) pattern. By adapting the argument from Miklós Bóna's paper [\cite=Bo] we easily see that Q(q,z,t) satisfies

[formula]

This holds since our sole (132) pattern can either appear in the elements

before n,

after n, or

with n as the '3' in the (132) pattern.

The term zP(q,zt,qt)Q(q,z,t) corresponds to (a), zQ(q,zt,qt)P(q,z,t) corresponds to (b), and t2z2P(q,zt,qt)(P(q,z,t) - 1) corresponds to (c). We see that case (c) follows since π = (π1,n - k,n,π2), where π1 is a permutation of

[formula]

The fractions

Here we study this generating function P(q,z,t) further, and find that it is a pretty continued fraction, and discover a fairly explicit form for its numerator and denominator.

First, from ([\ref=eq:fcnleq]) we have that

[formula]

and so by iteration we have the continued fraction,

[formula]

Now let

[formula]

Then substitution in ([\ref=eq:cfrac]) shows that A(q,z,t) = B(q,zt,tq), and therefore

[formula]

where B satisfies the functional equation

[formula]

To find out more about the form of B we write

[formula]

Then φ0 = 1, and

[formula]

for [formula]. It is easy to see by induction that

[formula]

For example, we have

[formula]

and

[formula]

In general, the exponent of t in φm(q,t) will be a linear form in the m summation indices, plus a constant, and the exponent of q will be an affine form in these indices, i.e., a quadratic form plus a linear form plus a constant. Let's find all of these forms explicitly.

Hence suppose in general that

[formula]

in which [formula] is the m-vector of summation indices, Qm is a real symmetric m  ×  m matrix to be determined, [formula] are m-vectors, and bm,dm are scalars. Inductively we find that

[formula]

The m  ×  m matrix Qm is { min (r,s) / 2}mr,s = 1. Thus we have the following formula for B.

The denominator B(q,z,t) of the grand generating function P(q,z,t) is explicitly given by

[formula]

The series computations

If fr(n) denotes the number of permutations of n letters that contain no pattern (132) and have exactly r (123)'s, we write AR[formula]. Then AR(r,z) is the coefficient of qr in the series development of P(q,z,1) of ([\ref=eq:gfun]). That is, we have

[formula]

>From ([\ref=eq:argen2]) we see that if we terminate the fraction P(q,z,1) at the numerator qN, say, then we'll know all of the [formula] exactly.

Further, if we know the denominator B(q,z,t) in ([\ref=eq:pform]) exactly through terms of order qN, then by carrying out the division in ([\ref=eq:pform]) and keeping the same accuracy, we will, after setting t = 1, again obtain all of the generating functions {AR(r,z)}Nr = 0 exactly.

Finally, to find the denominator B(q,z,t) in ([\ref=eq:pform]) exactly through terms of order qN, it is sufficient to carry out the iteration that is implicit in ([\ref=eq:beq]) N times, since further iteration will affect only the terms involving powers of q higher than the Nth.

In that way we computed the AR(r,z)'s for 0  ≤  r  ≤  15 in a few seconds, as is shown below in the initial section of the series ([\ref=eq:argen2]):

[formula]

[formula]

[formula]

If gr(n) denotes the number of permutations of n letters that contain 1 (132) pattern and have exactly r (123)'s, we write Aaron(r,z)[formula]. Then Aaron(r,z) is the coefficient of qr in the series development of Q(q,z,1) of ([\ref=eq:qfcnleq]). Since we have a very quick method to compute P(q,z,1), we can iterate equation (4) to compute the Aaron(r,z)'s. Shown below are the Aaron(r,z)'s for 0  ≤  r  ≤  6, that were computed in a few minutes.

[formula]