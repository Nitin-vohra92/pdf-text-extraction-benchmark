Theorem Proposition Lemma

Appendix to 'Roth's theorem on progressions revisited' by J. Bourgain

Introduction

In this appendix we flesh out the details of two results stated in the paper. The first is a refinement of Freıman's theorem, a result which has an extensive literature (see, for example, [\cite=YB] [\cite=MCC] [\cite=GAF] [\cite=IZR] [\cite=MBN] and [\cite=TCTVHV]); familiarity with [\cite=MCC] and [\cite=IZR] will be assumed, although it is not logically necessary.

Suppose that [formula] is a finite set with [formula]. Then A is contained in a multidimensional arithmetic progression P with

The previous best estimates are due to Chang [\cite=MCC] who showed the above result (up to logarithmic factors) with 2 in place of 7 / 4. Note that one cannot hope to improve the dimension bound past ⌊K - 1⌋, or the exponent of K in the size bound below 1; at the end of [\cite=MCC] Chang (using arguments of Bilu [\cite=YB]) actually shows how to bootstrap the dimension bound to ⌊K - 1⌋ for a small cost in the size bound. See the notes [\cite=BJGNOPACG] of Green for an exposition of this argument.

The second result we shall show is an improvement of a theorem of Konyagin and Laba from [\cite=SVKIL]. For [formula] and [formula] we write α.A: = {αa:a∈A}.

Suppose that [formula] is a finite set and [formula] is transcendental. Then

In [\cite=SVKIL] the above result was shown with a 1 in place of 4 / 3 - again, up to factors of log  log |A| - and it was observed that for any transcendental α and positive integer N there is a simple construction of a set A with |A| = N and [formula].

The improvements in both Theorem [\ref=thm.improvedfreiman] and Theorem [\ref=thm.konyaginlaba] stem from the following result, the proof of which is the content of this appendix. It will be appropriate for us to consider Bohr sets in [formula] rather than the generalizations presented in the paper: if Γ is a set of characters on [formula] and δ∈(0,1], then we write

Suppose that [formula] have [formula] and A has density α. Then (A - A) + (B - B) contains [formula], where and

The appendix now splits into five sections. In §[\ref=sec.bohrsetsanddissociativity] we recall the basic facts about Bohr sets and dissociativity which we shall need; in §[\ref=sec.densityincrement] we detail the key new density increment developed in the paper, before completing the proof of Theorem [\ref=thm.mainrefinement] in §[\ref=sec.proofofmaintheorem]. Finally, in §[\ref=sec.freimanimprovement] we prove Theorem [\ref=thm.improvedfreiman] and in §[\ref=sec.konyaginlaba] we prove Theorem [\ref=thm.konyaginlaba].

Bohr sets and dissociativity

We say that a Bohr set B(Γ,δ) is regular if Typically Bohr sets are regular, a fact implicit in the proof of the following proposition, which may be found, for example, as Lemma 4.25 fo [\cite=TCTVHV].

Suppose that B(Γ,δ) is a Bohr set. Then there is a δ' with [formula] such that B(Γ,δ') is regular.

There is a natural candidate for 'approximate Haar measure' on B(Γ,δ): we write βΓ,δ for the unique uniform probability measure on B(Γ,δ). Having identified such a measure there are various possible formulations of the 'approximate annihilator' of a Bohr set and the following lemma helps us pass between them.

Suppose that B(Γ,δ) is a regular Bohr set and κ > 0 is a parameter. Then

Dissociativity is an important concept and for us and we shall require a local analogue, but first we need some notation. If Λ is a set of characters and m:Λ  →  { - 1,0,1} then we write If S is a symmetric neighborhood of the trivial character then we say that a set of characters Λ is S-dissociated if The usual notion of dissociativity corresponds to taking S equal to the set containing just the trivial character, and typically for us S will be a set of the form [formula]; the following lemma is the tool by which we make use of this notion.

Suppose that B(Γ,δ) is a regular Bohr set, L is a set of characters and Λ is a maximal [formula]-dissociated subset of characters. Then L is contained in

We begin by proving that L  ⊂  〈Λ〉 + S. Suppose (for a contradiction) that there is some character [formula]. Let [formula] which is a strict superset of Λ. We shall show that Λ' is dissociated contradicting the maximality of Λ. Suppose that m∈{ - 1,0,1}Λ' is such that m.Λ'∈S. We have three cases.

mγ = 0 in which case m|Λ.Λ∈S and so [formula] by S-dissociativity of Λ. It follows that [formula].

mγ = 1 in which case γ∈  -  m|Λ.Λ + S  ⊂  〈Λ〉 + S which contradicts the fact that [formula].

mγ =  - 1 in which case γ∈m|Λ.Λ + S  ⊂  〈Λ〉 + S which contradicts the fact that [formula].

Thus [formula] and Λ' is S-dissociated as claimed. This contradiction proves that L  ⊂  〈Λ〉 + S.

By Lemma [\ref=lem.nestingofdual] we have Now if γ∈〈Λ〉 then [formula] so

[formula]

It follows that The result follows from the triangle inequality.

The density increment

The objective of this section is to prove the following proposition which reflects the main innovation of the paper. The key idea of the proposition is that if we have a large number of highly independent characters at which [formula] is large then they induce 'orthogonal' density increments which can consequently be done simultaneously resulting in a more favourable width reduction to density increment ratio in our Bohr sets.

Suppose that B(Γ,δ) is a regular Bohr set, A  ⊂  B(Γ,δ) has relative density α and ρ∈(0,1] is a parameter. Suppose, further, that there is a Bohr set B(Γ,δ') with and a [formula]-dissociated set Λ of at least 27ρ- 1(1 +  log α- 1) characters such that for each λ∈Λ we have [formula]. Then there is a regular Bohr set B(Γ',δ'') with such that

This proposition is proved using Proposition (*) which essentially introduces Riesz products. We shall now formalize some appropriate notation and definitions to deal with them. Suppose that Λ is a symmetric set of characters. [formula] is hermitian if [formula] for all λ∈Λ. Given a hermitian ω:Λ  →  D we define the product and call it a Riesz product.

To pass between the notion of dissociaitivity defined in the previous section and the 'Riesz product condition' towards the end of Proposition (*) we use the following technical lemma.

Suppose that B(Γ,δ) is a regular Bohr set, Λ is a symmetric [formula]-dissociated set of characters and ω:Λ  →  D is hermitian. Then for all [formula].

We need to introduce some smoothed measures. Let L be an integer to be optimized later and write [formula] for the measure [formula] where βΓ,δ' occurs 2L times. Now [formula] and [formula] is uniform on B(Γ,δ  +  δ'') so

[formula]

the last inequality by regularity and the fact that [formula]. Now Plancherel's theorem tells us that if [formula]. L can now be optimized with ease.

The content of the next proof is simply the observation that a Riesz product on Λ is roughly constant on a small enough Bohr set on the characters Λ.

For each λ∈Λ let ω(λ) be a complex number such that Note that ω is hermitian since 1AdβΓ,δ is real. We let Φ be the set [formula] so that [formula]. From the definition of ω we see that [formula] for all φ∈Φ and since Lemma [\ref=lem.rieszproductestimate] applies and we have for all a:Φ  →  [ -  1,1].

We apply Proposition (*) (with constants which come out of the proof) to conclude that there is a set Φ'  ⊂  Φ with such that Let Λ' be the subset of Λ such that [formula] and ω': = ω|Λ' so that [formula]. We take [formula] and it follows that Now place some total order <   on Φ'. Then It follows that and hence if y∈B(Γ',δ'') we conclude that If we define then this last expression can be written as Hence, by Lemma [\ref=lem.rieszproductestimate], we have whence Pick δ'' satisfying the lower bound of the proposition and regular for Γ' by Proposition [\ref=prop.regularvalue], such that where the last inequality is by choice of δ''. Consequently But

[formula]

It follows that from which we retrieve the result.

The proof of Theorem [\ref=thm.mainrefinement]

The proof is iterative with the following lemma as the driving ingredient.

Suppose that B(Γ,δ) is a regular Bohr set and [formula] has relative density α in B(Γ,δ). Suppose, further, that there is a set [formula] such that [formula]. Then at least one of the following conclusions is true.

(A - A) + (B - B) contains [formula] where Λ is a set of size O(K3 / 4 log α- 1) and

There is a regular Bohr set B(Γ',δ'') with and such that

Apply Proposition [\ref=prop.regularvalue] to pick δ' regular for Γ such that Let Λ be a maximal [formula]-dissociated subset of If [formula] then apply Lemma [\ref=lem.containedinintersection] to see that L is contained in where Write |B| = βN. By the Cauchy-Schwarz inequality we have

[formula]

It follows that if we write [formula] then [formula]. By the inversion formula we have whence, by Parseval's theorem, we have

[formula]

if [formula]. It follows that we are in case ([\ref=item.case1]).

In the other case we discard (if necessary) just enough elements of Λ to ensure that the inequality [formula] holds and then apply Proposition [\ref=prop.densityincrement] with parameter [formula]. It follows that there is a regular Bohr set B(Γ',δ'') with and It follows that we are in case ([\ref=item.case2]).

Iterating this to yield Theorem [\ref=thm.mainrefinement] is a simple exercise.

We construct a sequence of regular Bohr sets B(Γk,δk) iteratively initializing with Γ0 as the set containing the trivial character and δ0 = 1 which has B(Γ0,δ0) regular for trivial reasons. Write [formula] so that α0  =  α and let xk be such that [formula]. We apply Lemma [\ref=lem.iterationlemma] repeatedly to the sets xk - A and the Bohr sets B(Γk,δk). If after k steps of the iteration we have never found ourselves in the first case of Lemma [\ref=lem.iterationlemma] then Since [formula] the first of these ensures that k = O(K1 / 4( log α- 1) and so there is some k of size O(K1 / 4 log α- 1) for which we end up in the first case of Lemma [\ref=lem.iterationlemma], and at that stage we have and The result follows.

Improving Freıman's theorem: the proof of Theorem [\ref=thm.improvedfreiman]

Ruzsa's proof of Freıman's theorem in [\cite=IZR] naturally splits into four stages: finding a good model; Bogolioùboff's argument; determining the structure of Bohr sets; and, Chang's pullback and covering argument. The improvement of this work arises from replacing Bogolioùboff's argument by the more sophisticated Theorem [\ref=thm.mainrefinement].

To 'find a good model' we use the following proposition due to Ruzsa which essentially appears as Theorem 8.9 in [\cite=MBN] for example.

Suppose that A is a finite set of integers with [formula]. Then there is an integer N with N = KO(1)|A| and a set A'  ⊂  A with [formula] such that A' is Freıman 8-isomorphic to a subset of [formula].

We have already dealt with 'Bogolioùboff's argument', so we turn to determining the structure of Bohr sets. It was a key insight of Ruzsa in [\cite=IZR] that Bohr sets contain large multidimensional progressions. Fortunately the same is true for intersections of Bohr sets.

The following is a straightforward generalization of [\cite=TCTVHV]. It shows that the intersection of two Bohr sets contains a large multidimensional progression. If Γ is a set of characters on [formula] and (δγ)γ∈Γ∈(0,1]Γ then we write

Suppose that Γ is a set of characters on [formula] and (δγ)γ∈Γ∈(0,1]Γ. Then B(Γ,(δγ)γ∈Γ) contains a symmetric multidimensional progression P of dimension |Γ| and size at least [formula].

Finally, 'Chang's pullback and covering argument' is the following result which converts a large progression contained in 2A - 2A into a progression containing A. It may be found, for example, as [\cite=BJGSTSA]

Suppose that A is a finite set of integers with [formula] and 2A - 2A contains a multidimensional progression of dimension d and size η|A|. Then A is contained in a multidimensional progression of size at most exp (O(d + K log Kη- 1))|A| and dimension at most O(d + K log Kη- 1).

With these ingredients we can now prove Theorem [\ref=thm.improvedfreiman].

We apply Proposition [\ref=prop.ruzsamodel] to get an integer N with N = KO(1)|A| and a set A'  ⊂  A with [formula] such that A' is Freıman 8-isomorphic to a subset A'' of [formula]. Note that A'' has [formula] and density K- O(1). Apply Theorem [\ref=thm.mainrefinement] to get that 2A'' - 2A'' contains [formula] where and Proposition [\ref=prop.largeprogressionsinbohrsets] then ensures that 2A'' - 2A'' contains a multidimensional progression of dimension O(K3 / 4 log K) and size at least exp ( - O(K3 / 4 log 3K))N. Since A'' is Freıman 8-isomorphic to a subset of A we have that 2A'' - 2A'' is Freıman 2-isomorphic to a subset of 2A - 2A which thus contains a multidimensional progression of dimension O(K3 / 4 log K) and size at least exp ( - O(K3 / 4 log 3K))|A|. The result follows from Proposition [\ref=prop.changspullback].

It is worth remarking that for the purpose of improving the bounds in Freıman's theorem for general abelian groups (the current best such appearing in the paper [\cite=BJGIZR] of Green and Ruzsa) it would be desirable to pay closer attention to the α-dependencies in Theorem [\ref=thm.mainrefinement]. These contribute logarithmic terms in [formula], but polynomial terms when we do not have a modelling lemma of the strength of Proposition [\ref=prop.ruzsamodel], as is the case in general.

Improving the Konyagin-Laba theorem: the proof of Theorem [\ref=thm.konyaginlaba]

We require two preliminary results.

Suppose that [formula], [formula] and [formula]. Then

Write A': = A - A and B': = α.(A - A). By the Plünnecke-Ruzsa estimates ([\cite=TCTVHV]) we have [formula] for all k. Since α  ≠  0 we have that |kB'| = |kA'|, whence [formula] and, in particular, [formula] and [formula]. By this second inequality and Ruzsa's covering lemma ([\cite=TCTVHV]) there is a set S with [formula] such that 3A' - 2A'  ⊂  A' - A'  +  S. Again, by Ruzsa's covering lemma and the fact that [formula] there is also a set T with [formula] and α.A  ⊂  A - A  +  T, whence B'  ⊂  A' - A'  +  2T - 2T. Put T': = 2T - 2T and note that [formula].

Now, write [formula] and define a sequence of sets Tl recursively by letting T1 be some set containing precisely one element of A' and Tl + 1: = S + T' - T' + αTl. We shall show by induction that Bl  ⊂  A' - A'  +  Tl. For l = 1 this is immediate. Assume that we have shown the result for some l. Then

[formula]

The claim follows. It remains to note that [formula] as required.

Note that a direct application of the Plünnecke-Ruzsa estimates gives only a bound of the form KO(l2)|A|.

The following is a straightforward modification of Proposition [\ref=prop.ruzsamodel].

Suppose that A and B are finite sets of integers with [formula] and [formula] is a positive integer. Then there is an integer N with N = KO(k) min {|A|,|B|}, a subset of A of size at least |A| / k, a subset B, and a Freıman k-isomorphism mapping these sets to A'' and B'' in [formula] respectively. Furthermore, [formula].

There is clearly a Freıman k-isomorphism which maps A and B onto A' and B', respectively, some subsets of [formula] for a sufficiently large prime p. Since [formula] we have |A' + B'| = |A + B| and consequently we shall assume that A and B are subsets of [formula].

Suppose that [formula] and define [formula] and [formula] to be the map which takes [formula] to its least non-negative member. The range of φ' is partitioned by the k sets and, moreover, φ'|φ'- 1(Ij) is clearly a Freıman k-isomorphism for each j∈[k].

By the pigeon-hole principle there is some j = j(q) such that similarly there is some [formula] such that Put [formula], and note that [formula] is a Freıman k-isomorphism.

Finally, let N: = |k(A + B) - k(A + B)| and [formula] be the usual quotient map. For every q, [formula] is a Freıman k-homomorphism; it is also a Freıman k-isomorphism: put and ψ is a Freıman k-isomorphism for some q if [formula]. For each q there are at most [formula] non-zero elements in I(q), whence if q is chosen uniformly at random from [formula], we have

[formula]

We conclude that there is some q such that [formula], and so [formula], and ψ is a Freıman k-isomorphism.

To finish the proof we put A'': = ψ(A(q)) and B'': = ψ(B(q)), and since ψ is a Freıman 2-isomorphism,

[formula]

The bound on N follows from the Plünnecke-Ruzsa estimates ([\cite=TCTVHV]).

The following argument is due to J. Bourgain.

Since [formula] is finite it generates a finite dimensional [formula]-module in [formula], whence [formula] is Freıman isomorphic of all orders to a subset [formula] of [formula]. (Here, of course, A is isomorphic to A' and α.A to B'.)

Let L be the the largest coefficient occurring in any element of [formula] (we may assume, by a translation, that they are all positive). The map is a Freıman 8-isomorphism of [formula] into [formula] from which it follows that [formula] since |A'|  =  |B'|. By Proposition [\ref=prop.ruzsamodelbooster] there is an integer N with N = KO(1)|A|, a subset of A' of size at least |A| / 8, a subset of B' and a Freıman 8-isomorphism mapping these sets to A'' and B'' in [formula] respectively such that [formula].

It follows from Theorem [\ref=thm.mainrefinement] that (A'' - A'') + (B'' - B'') contains [formula] where and (Essentially) by Lemma 2.0(i) of the paper we have that If η  >   max {δ- 1N- 1 / 2|Γ|,ε- 1N- 1 / 2|Λ|} then this intersection has size greater than 1 and hence contains a non-zero element say d. Moreover by the triangle inequality, for any k with [formula] we have [formula]. Thus (A'' - A'') + (B'' - B'') contains an arithmetic progression of length for some absolute C > 0, and hence (A - A) + (α.A - α.A) contains an arithmetic progression P of length L.

By Lemma [\ref=lem.iteratedgrowth] with parameter 2l and some manipulations we get that

[formula]

However, (A - A) + α.(A - A) contains P as so we have (by the transcendance of α) that the left hand side is at least |P|l. Taking l = ⌈2CK3 / 4 log K⌉ and inserting the lower bound for |P|, the result follows.