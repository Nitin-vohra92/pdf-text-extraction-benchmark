Lemma Proposition Corollary

Example Definition Remark Assumption

Convex bodies and multiplicities of ideals

Introduction

The purpose of this note is to employ, in the local case, techniques from the theory of semigroups of integral points and Newton-Okounkov bodies (for the global case) and to obtain new results as well as new proofs of some previously known results about multiplicities of ideals in local rings.

Let R  =  OX,p be the local ring of a point p on an n-dimensional irreducible algebraic variety X over an algebraically closed field [formula]. Let [formula] denote the maximal ideal of R and let [formula] be an [formula]-primary ideal, i.e. [formula] is an ideal containing a power of the maximal ideal [formula]. Geometrically speaking, [formula] is [formula]-primary if its zero set (around p) is the single point p itself. Let [formula] be n generic elements in [formula]. The multiplicity [formula] of the ideal [formula] is the intersection multiplicity, at the origin, of the hypersurfaces Hi  =  {x|f(x)  =  0}, [formula] (it can be shown that this number is independent of the choice of the fi). According to Hilbert-Samuel's theorem, the multiplicity [formula] is equal to:

[formula]

(This result is analogous to Hilbert's theorem on the Hilbert function and degree of a projective variety.) More generally, let R be an n-dimensional Noetherian local domain over [formula] (where [formula] is isomorphic to the residue field [formula] and [formula] is the maximal ideal). Let [formula] be an [formula]-primary ideal of R. Since [formula] contains a power of the maximal ideal [formula], [formula] is finite dimensional regarded as a vector space over [formula]. The Hilbert-Samuel function of the [formula]-primary ideal [formula] is defined by:

[formula]

For large values of k, [formula] coincides with a polynomial of degree n called the Hilbert-Samuel polynomial of [formula]. The Samuel multiplicity, [formula] of [formula] is defined to be the leading coefficient of [formula] multiplied by n!.

It is well-known that the Samuel multiplicity satisfies a Brunn-Minkowski inequality [\cite=Teissier1] [\cite=RS]. That is, for any two [formula]-primary ideals [formula], [formula] we have:

[formula]

More generally we define multiplicity for [formula]-primary graded sequences of subspaces. That is, a sequence [formula] of [formula]-subspaces in R such that for all k,m we have [formula], and [formula] contains a power of the maximal ideal [formula] (Definition [\ref=def-graded-seq-subspace]). We recall that if [formula] are two [formula]-subspaces of R, [formula] denotes the [formula]-span of all the xy where [formula] and [formula]. In particular, a graded sequence [formula] where each [formula] is an [formula]-primary ideal, is an [formula]-primary graded sequence of subspaces. We call such [formula] an [formula]-primary graded sequence of ideals.

For an [formula]-primary graded sequence of subspaces we define multiplicity [formula] to be:

[formula]

(It is not a priori clear that the limit exists.)

We will use convex geometric arguments to prove the existence of the limit in [\eqref=equ-multi-graded-seq-ideals-intro] and a generalization of [\eqref=equ-Brunn-Mink-intro] to [formula]-primary graded sequences of subspaces, for a large class of local domains R.

Let us briefly discuss the convex geometry part of the story. Let C be a closed strongly convex cone with apex at the origin (i.e. C is a convex cone and does not contain any line). We call a closed convex set Γ  ⊂  C, a C-convex region if for any x∈Γ we have x  +  C  ⊂  Γ. We say that Γ is cobounded if [formula] is bounded. It is easy to verify that the set of cobounded C-convex regions is closed under addition (Minkowski sum of convex sets) and multiplication with a positive real number. For a cobounded C-convex region Γ we call the volume of the bounded region [formula] the covolume of Γ and denote it by (Γ). Also we refer to [formula] as a C-coconvex body. (Instead of working with convex regions one can alternatively work with coconvex bodies.) In [\cite=Askold-Vladlen] [\cite=Askold-Vladlen2], similar to convex bodies and their volumes (and mixed volumes), the authors develop a theory of convex regions and their covolumes (and mixed covolumes). Moreover they prove an analogue of the Alexandrov-Fenchel inequality for mixed covolumes (see Theorem [\ref=thm-alexandrov-fenchel-covolume]). The usual Alexandrov-Fenchel inequality is an important inequality about mixed volumes of convex bodies in [formula] and generalizes the classical isoperimetric inequality and the Brunn-Minkowski inequality. In a similar way, the result in [\cite=Askold-Vladlen] implies a Brunn-Minkowski inequality for covolumes, that is, for any two cobounded C-convex regions Γ1, Γ2 where C is an n-dimensional cone, we have:

[formula]

We associate convex regions to [formula]-primary graded sequences of subspaces (in particular [formula]-primary ideals) and use the inequality [\eqref=equ-intro-BM-inequ-covol] to prove the Brunn-Minkowski inequality for multiplicities. To associate a convex region to a graded sequence of subspaces we need a valuation on the ring R. We will assume that there is a valuation v on R with values in [formula] (with respect to a total order on [formula] respecting addition) such that the residue field of v is [formula], and moreover the following conditions (i)-(ii) hold . We call such v a good valuation on R (Definition [\ref=def-good-valuation]):

(i) Let [formula] be the value semigroup of (R,v). Let C  =  C(S) be the closure of the convex hull of S. It is a closed convex cone with apex at the origin. We assume that C is a strongly convex cone.

Let [formula] be a linear function. For any [formula] let [formula] denote the half-space [formula]. Since the cone C  =  C(S) associated to the semigroup S is assumed to be strongly convex we can find a linear function [formula] such that the cone C lies in [formula] and it intersects the hyperplane [formula] only at the origin.

(ii) We assume there exists r0  >  0 and a linear function [formula] as above such that for any f∈R, if [formula] for some k > 0 then [formula].

Let [formula] denote the image of [formula] under the valuation v. The condition (ii) in particular implies that for any k > 0 we have [formula].

As an example, let [formula] be the algebra of polynomials localized at the maximal ideal [formula]. Then the map v which associates to a polynomial its lowest exponent (with respect to some term order) defines a good valuation on R and the value semigroup S coincides with the semigroup [formula], that is, the semigroup of all the integral points in the positive orthant [formula]. In the same fashion any regular local ring has a good valuation, as well as the local ring of a toroidal singularity (Example [\ref=ex-good-val-toric-local-ring] and Theorem [\ref=th-good-val-reg-local-ring]). More generally, in Section [\ref=sec-valuation-ideal] we see that an analytically irreducible local domain R has a good valuation (Theorem [\ref=th-good-val-S/R] and Theorem [\ref=th-good-val-analytically-irr-sing]; see also [\cite=Cutkosky1]). A local ring R is said to be analytically irreducible if its completion is an integral domain. Regular local rings and local rings of toroidal singularities are analytically irreducible. (We should point out that in the first version of the paper we had addressed only the case where R is a regular local ring or the local ring of a toroidal singularity.)

Given a good [formula]-valued valuation v on the domain R, we associate the (strongly) convex cone [formula] to the domain R which is the closure of convex hull of the value semigroup S. Then to each [formula]-primary graded sequence of subspaces [formula] in R we associate a convex region [formula], such that the set [formula] is bounded (Definition [\ref=def-Gamma-I]). The main result of the manuscript (Theorem [\ref=th-multi-ideal-covol]) is that the limit in ([\ref=equ-multi-graded-seq-ideals-intro]) exists and:

[formula]

The inequality [\eqref=equ-intro-main] and the Brunn-Minkowski inequality for covolumes (see [\eqref=equ-intro-BM-inequ-covol] or Corollary [\ref=cor-Brunn-Mink-covol]) are the main ingredients in proving a generalization of the inequality [\eqref=equ-Brunn-Mink-intro] to [formula]-primary graded sequences of subspaces (Corollary [\ref=cor-Brunn-Mink-multi]).

We would like to point out that the construction of [formula] is an analogue of the construction of the Newton-Okounkov body of a linear system on an algebraic variety (see [\cite=Okounkov-log-concave], [\cite=Okounkov-Brunn-Mink], [\cite=KKh-Annals], [\cite=LM]). In fact, the approach and results in the present paper are analogous to the approach and results in [\cite=KKh-Annals] regarding the asymptotic behavior of Hilbert functions of a general class of graded algebras. In the present manuscript we also deal with certain graded algebras (i.e. [formula]-primary graded sequences of subspaces) but instead of dimension of graded pieces we are interested in the codimension (i.e. dimension of [formula]), that is why in our main theorem (Theorem [\ref=th-multi-ideal-covol]) the covolume of a convex region appears as opposed to the volume of a convex body ([\cite=KKh-Annals]). Also our Theorem [\ref=th-multi-ideal-covol] generalizes [\cite=KKh-Annals] which gives a formula for the degree of a projective variety X in terms of the volume of its corresponding Newton-Okounkov body, because the Hilbert function of a projective variety X can be regarded as the Hilbert-Samuel function of the affine cone over X at the origin.

On the other hand, the construction of [formula] generalizes the notion of the Newton diagram of a power series (see [\cite=Kushnirenko] and [\cite=AVG]). To a monomial ideal in a polynomial ring (or a power series ring), i.e. an ideal generated by monomials, one can associate its (unbounded) Newton polyhedron. It is the convex hull of the exponents of the monomials appearing in the ideal. The Newton diagram of a monomial ideal is the union of the bounded faces of the Newton polyhedron. One can see that for a monomial ideal [formula], the convex region [formula] coincides with its Newton polyhedron (Theorem [\ref=th-covol-monomial]). The main theorem in this manuscript (Theorem [\ref=th-multi-ideal-covol]) for the case of monomial ideals recovers the local case of the well-known theorem of Bernstein-Kushnirenko, about computing the multiplicity at the origin of a system [formula] where the fi are generic functions from [formula]-primary monomial ideals (see Section [\ref=sec-monomial-ideal] and [\cite=AVG]).

Another immediate corollary of [\eqref=equ-intro-main] is the following: let [formula] be an [formula]-primary ideal in [formula]. Fix a term order on [formula] and for each k  >  0 let [formula] denote the initial ideal of the ideal [formula] (generated by the lowest terms of elements of [formula]). Then the sequence of numbers

[formula]

is decreasing and converges to [formula] as k  →    ∞   (Corollary [\ref=cor-Lech]).

The Brunn-Minkowski inequality proved in this paper is closely related to the more general Alexandrov-Fenchel inequality for mixed multiplicities. Take [formula]-primary ideals [formula] in a local ring R  =  OX,p of a point p on an n-dimensional algebraic variety X. The mixed multiplicity [formula] is equal to the intersection multiplicity, at the origin, of the hypersurfaces Hi  =  {x|fi(x)  =  0}, [formula], where each fi is a generic function from [formula]. Alternatively one can define the mixed multiplicity as the polarization of the Hilbert-Samuel multiplicity [formula], i.e. it is the unique function [formula] which is invariant under permuting the arguments, is multi-additive with respect to product of ideals, and for any [formula]-primary ideal [formula] the mixed multiplicity [formula] coincides with [formula]. In fact, in the above the [formula] need not be ideals and it suffices for them to be [formula]-primary subspaces.

The Alexandrov-Fenchel inequality is the following inequality among the mixed multiplicities of the [formula]:

[formula]

When n  =   dim R  =  2 it is easy to see that the Brunn-Minkowski inequality [\eqref=equ-Brunn-Mink-intro] and the Alexandrov-Fenchl inequality [\eqref=equ-Alex-Fenchel-mixed-multi] are equivalent. By a reduction of dimension theorem for mixed multiplicities one can get a proof of the Alexandrov-Fenchel inequality [\eqref=equ-Alex-Fenchel-mixed-multi] from the Brunn-Minkowski inequality [\eqref=equ-Brunn-Mink-intro] for dim (R) = 2. The Brunn-Minkowski inequality [\eqref=equ-Brunn-Mink-intro] was originally proved in [\cite=Teissier1] [\cite=RS].

In a recent paper [\cite=KKh-mixed-multi] we give a simple proof of the Alexandrov-Fenchel inequality for mixed multiplicities of ideals using arguments similar to but different from those of this paper. This then implies an Alexandrov-Fenchel inequality for covolumes of convex regions (in a similar way that in [\cite=KKh-Annals] and in [\cite=Askold-BZ] the authors obtain an alternative proof of the usual Alexandrov-Fenchel inequality for volumes of convex bodies from similar inequalities for intersection numbers of divisors on algebraic varieties).

We would like to point out that the Alexandrov-Fenchel inequality in [\cite=Askold-Vladlen] for covolumes of coconvex bodies is related to an analogue of this inequality for convex bodies in higher dimensional hyperbolic space (or higher dimensional Minkowski space-time). From this point of view, the Alexandrov-Fenchel inequality has been proved for certain coconvex bodies in [\cite=Fillastre].

After the first version of this note was completed we learned about the recent papers [\cite=Cutkosky1] [\cite=Cutkosky2] and [\cite=Fulger] which establish the existence of limit ([\ref=equ-multi-graded-seq-ideals-intro]) in more general settings. We would also like to mention the paper of Teissier [\cite=Teissier2] which discusses Newton polyhedron of a power series, and notes the relationship/analogy between notions from local commutative algebra and convex geometry. Also we were notified that, for ideals in a polynomial ring, ideas similar to construction of [formula] appears in [\cite=Mustata] were the highest term of polynomials is used instead of a valuation. Moreover, in [\cite=Mustata] the Brunn-Minkowski-inequality for multiplicities of graded sequences of [formula]-primary ideals is proved for regular local rings using Teissier's Brunn-Minkowski [\eqref=equ-Brunn-Mink-intro].

Finally as the final version of this manuscript was being prepared for publication, the preprint of D. Cutksoky [\cite=Cutkosky3] appeared in arXiv.org in which the author uses similar methods to prove Brunn-Minkowski inequality for graded sequences of [formula]-primary ideals in local domains.

And few words about the organization of the paper: Section [\ref=sec-mixed-vol] recalls basic background material about volumes/mixed volumes of convex bodies. Section [\ref=sec-convex-diag] is about convex regions and their covolumes/mixed covolumes, which we can think of as a local version of the theory of mixed volumes of convex bodies. In Sections [\ref=sec-semigp-int] and [\ref=sec-semigp-ideal] we associate a convex region to primary sequences of subsets in a semigroup and prove the main combinatorial result required later (Definitions [\ref=def-Gamma-I-semigroup] and Theorem [\ref=th-vol-Gamma-semigroup]). In Section [\ref=sec-multi-ideal] we recall some basic definitions and facts from commutative algebra about multiplicities of [formula]-primary ideals (and subspaces) in local rings. The next section (Section [\ref=sec-monomial-ideal]) discusses the case of monomial ideals and the Bernstein-Kushnirenko theorem. Finally in Section [\ref=sec-valuation-ideal], using a valuation on the ring R, we associate a convex region [formula] to an [formula]-primary graded sequence of subspaces [formula] and prove the main results of this note (Theorem [\ref=th-multi-ideal-covol] and Corollary [\ref=cor-Brunn-Mink-multi]).

Acknowledgement. The first author would like to thank Dale Cutkosky, Vladlen Timorin and Javid Validashti for helpful discussions. We are also thankful to Bernard Teissier, Dale Cutkosky, Francois Fillastre and Mircea Musta for informing us about their interesting papers [\cite=Teissier2], [\cite=Cutkosky1] [\cite=Cutkosky2], [\cite=Fillastre] and [\cite=Mustata].

Mixed volume of convex bodies

The collection of all convex bodies in [formula] is a cone, that is, we can add convex bodies and multiply a convex body with a positive number. For two convex bodies [formula], their (Minkowski) sum Δ1  +  Δ2 is {x  +  y|x∈Δ1,y∈Δ2}. Let [formula] denote the n-dimensional volume in [formula] with respect to the standard Euclidean metric. The function [formula] is a homogeneous polynomial of degree n on the cone of convex bodies, i.e. its restriction to each finite dimensional section of the cone is a homogeneous polynomial of degree n. In other words, for any collection of convex bodies [formula], the function:

[formula]

is a homogeneous polynomial of degree n in [formula]. By definition the mixed volume [formula] of an n-tuple [formula] of convex bodies is the coefficient of the monomial [formula] in the polynomial [formula] divided by n!. This definition implies that mixed volume is the polarization of the volume polynomial, that is, it is the unique function on the n-tuples of convex bodies satisfying the following:

(Symmetry) V is symmetric with respect to permuting the bodies [formula].

(Multi-linearity) It is linear in each argument with respect to the Minkowski sum. The linearity in first argument means that for convex bodies Δ1', [formula], and real numbers λ',λ''  ≥  0 we have:

[formula]

(Relation with volume) On the diagonal it coincides with the volume, i.e. if [formula], then [formula].

The following inequality attributed to Alexandrov and Fenchel is important and very useful in convex geometry (see [\cite=BZ]):

In dimension 2, this inequality is elementary. We call it the generalized isoperimetric inequality, because when Δ2 is the unit ball it coincides with the classical isoperimetric inequality. The celebrated Brunn-Minkowski inequality concerns volume of convex bodies in [formula]. It is an easy corollary of the Alexandrov-Fenchel inequality. (For n = 2 it is equivalent to the Alexandrov-Fenchel inequality.)

Mixed covolume of convex regions

Let C be a strongly convex closed n-dimensional cone in [formula] with apex at the origin. (A convex cone is strongly convex if it does not contain any lines through the origin.) We are interested in closed convex subsets of C which have bounded complement.

We call a closed convex subset Γ  ⊂  C a C-convex region (or simply a convex region when the cone C is understood from the context) if for any x∈Γ and y∈C we have x  +  y∈Γ. Moreover, we say that a convex region Γ is cobounded (alternatively we say Γ is inscribed in C) if the complement [formula] is bounded. In this case the volume of [formula] is finite which we call the covolume of Γ and denote it by (Γ). One also refers to [formula] as a C-coconvex body.

The collection of C-convex regions (respectively cobounded regions) is closed under the Minkowski sum and multiplication by positive scalars. Similar to the volume of convex bodies, one proves that the covolume of convex regions is a homogeneous polynomial [\cite=Askold-Vladlen]. More precisely:

As in the case of convex bodies, one uses the above theorem to define mixed covolume of cobounded regions. By definition the mixed covolume [formula] of an n-tuple [formula] of cobounded convex regions is the coefficient of the monomial [formula] in the polynomial [formula] divided by n!. That is, mixed covolume is the unique function on the n-tuples of cobounded regions satisfying the following:

(Symmetry) CV is symmetric with respect to permuting the regions [formula].

(Multi-linearity) It is linear in each argument with respect to the Minkowski sum.

(Relation with covolume) For any cobounded region Γ  ⊂  C:

[formula]

The mixed covolume satisfies an Alexandrov-Fenchel inequality [\cite=Askold-Vladlen]. Note that the inequality is reversed compared to the Alexandrov-Fenchel for mixed volumes of convex bodies.

The (reversed) Alexandrov-Fenchel inequality implies a (reversed) Brunn-Minkowski inequality. (For n = 2 it is equivalent to the Alexandrov-Fenchel inequality.)

Semigroups of integral points

In this section we recall some general facts from [\cite=KKh-Annals] about the asymptotic behavior of semigroups of integral points. Let [formula] be an additive semigroup. Let [formula] denote the projection onto the second factor, and let [formula] be the set of points in S at level k. For simplicity, assume [formula] and that S generates the whole lattice [formula]. Define the function HS by:

[formula]

We call HS the Hilbert function of the semigroup S. We wish to describe the asymptotic behavior of HS as k  →    ∞  .

Let C(S) be the closure of the convex hull of [formula], that is, the smallest closed convex cone (with apex at the origin) containing S. We call the projection of the convex set [formula] to [formula] (under the projection onto the first factor (x,1)  ↦  x), the Newton-Okounkov convex set of the semigroup S and denote it by Δ(S). In other words,

[formula]

(In fact, one can show that taking convex hull in the above definition is not necessary.) If [formula] then Δ(S) is compact and hence a convex body.

The Newton-Okounkov convex set Δ(S) is responsible for the asymptotic behavior of the Hilbert function of S (see [\cite=KKh-Annals]):

Primary sequences in a semigroup and convex regions

In this section we discuss the notion of a primary graded sequence of subsets in a semigroup and describe its asymptotic behavior using Theorem [\ref=th-semigp-NO]. In section [\ref=sec-valuation-ideal] we will employ this to describe the asymptotic behavior of the Hilbert-Samuel function of a graded sequence of [formula]-primary ideals in a local domain.

Let [formula] be an additive semigroup containing the origin. Without loss of generality we assume that S generates the whole [formula]. Let as above C  =  C(S) denote the cone of S i.e. the closure of convex hull of [formula]. We also assume that C is a strongly convex cone, i.e. it does not contain any lines through the origin.

For two subsets I,J  ⊂  S, the sum I  +  J is the set {x + y|x∈I, ~ y∈J}. For any integer k  >  0, by the product k * I we mean [formula] (k times).

A graded sequence of subsets in S is a sequence [formula] of subsets such that for any k,m  >  0 we have Ik  +  Im  ⊂  Ik + m.

Let [formula], [formula] be graded sequences of subsets. Then the sequence [formula] defined by

[formula]

is also a graded sequence of subsets which we call the sum of sequences [formula] and [formula].

Let [formula] be a linear function. For any [formula] let [formula] (respectively [formula]) denote the half-space [formula] (respectively [formula]), and similarly for [formula] and [formula]. By assumption the cone C  =  C(S) associated to the semigroup S is strongly convex. Thus we can find a linear function [formula] such that the cone C  =  C(S) lies in [formula] and it intersects the hyperplane [formula] only at the origin. Let us fix such a linear function [formula].

We will be interested in graded sequences of subsets [formula] satisfying the following condition:

We say that a graded sequence of subsets [formula] is primary if there exists an integer t0  >  0 such that for any integer k > 0 we have:

[formula]

One verifies that if [formula] is another linear function such that C lies in [formula] and it intersects the hyperplane [formula] only at the origin then it automatically satisfies [\eqref=equ-primary-semigroup-ideal] with perhaps a different constant t'0  >  0. Hence the condition of being a primary graded sequence does not depend on the linear function [formula]. Nevertheless when we refer to a primary graded sequence [formula], choices of a linear function [formula] and an integer t0  >  0 are implied.

Since C intersects [formula] only at the origin it follows that for any k  >  0 the set [formula] is bounded which implies that [formula] is finite. But by [\eqref=equ-primary-semigroup-ideal], [formula] and hence is finite.

Let [formula] be a primary graded sequence. Define the function [formula] by:

[formula]

(Note that by Proposition [\ref=prop-I_k-cofinite] this number is finite for all k > 0.) We call it the Hilbert-Samuel function of [formula].

To a primary graded sequence of subsets [formula] we can associate a C-convex region [formula] (see Definition [\ref=def-convex-region]). This convex set encodes information about the asymptotic behavior of the Hilbert-Samuel function of [formula].

Let [formula] be a primary graded sequence of subsets. Define the convex set [formula] by

[formula]

It is an unbounded convex set in C. (As in Section [\ref=sec-semigp-int], one can show that taking convex hull in the above definition is not necessary.)

Let [formula] and t0 be as in Definition [\ref=def-primary-sequence]. From the definitions it follows that the region Γ contains [formula]. Thus [formula] and hence is bounded. Next let x∈Γ. Since x + C  ⊂  C, Γ contains the set [formula]. But the convex hull of x and [formula] is x + C. Thus x + C  ⊂  Γ because Γ is convex.

The following is an important example of a primary graded sequence in a semigroup S.

Since [formula] is finite there exists t1 > 0 such that [formula]. Put [formula]. Because C is a rational polyhedral cone, M1 is a finitely generated semigroup. Let [formula] be semigroup generators for M1. Let t0  >  0 be bigger than all the [formula]. For k > 0 take [formula]. Then [formula] for [formula]. Thus [formula]. This implies that [formula] and hence [formula]. It follows that x∈k * M1. That is, [formula] and hence [formula] as required. The assertion [formula] follows from the observation that (k  *  I)  =  k  ~  (I).

The following is our main result about the asymptotic behavior of a primary graded sequence.

Let t0  >  0 be as in Definition [\ref=def-primary-sequence]. Then for all k > 0 we have [formula] Moreover take t0 to be large enough so that the finite set [formula] generates the lattice [formula] (this is possible because S and hence I1 generate [formula]). Consider

[formula]

[formula]

S̃ and T̃ are semigroups in [formula] and we have S̃  ⊂  T̃. From the definition it follows that both of the groups generated by S̃ and T̃ are [formula]. Also the Newton-Okounkov bodies of S̃ and T̃ are:

[formula]

[formula]

where [formula]. Since [formula], we have:

[formula]

Here as usual S̃k  =  {(x,k)|(x,k)∈S̃} (respectively T̃k) denotes the set of points in S̃ (respectively T̃) at level k. Hence

[formula]

By Theorem [\ref=th-semigp-NO] we have:

[formula]

[formula]

Thus

[formula]

On the other hand, we have:

[formula]

and hence [formula] This finishes the proof.

For a primary graded sequence [formula] we denote [formula] by [formula]. Motivated by commutative algebra, we call it the multiplicity of [formula].

The following additivity property is straightforward from definition.

For any k > 0 we have (I'k)  +  (I''k)  =  (I'k  +  I''k). From this the required equality [formula] follows.

Let [formula] be n primary graded sequences. Define the function [formula] by:

[formula]

Follows immediately from Proposition [\ref=prop-additivity-semigroup-ideal], Theorem [\ref=th-vol-Gamma-semigroup] and Theorem [\ref=th-covol-polynomial].

Let [formula] be primary graded sequences. Define the mixed multiplicity [formula] to be the coefficient of [formula] in the polynomial [formula] divided by n!.

From Theorem [\ref=th-vol-Gamma-semigroup] and Proposition [\ref=prop-additivity-semigroup-ideal] we have the following corollary:

From Theorem [\ref=thm-alexandrov-fenchel-covolume] and Corollary [\ref=cor-Brunn-Mink-covol] we then obtain:

Multiplicities of ideals and subspaces in local rings

Let R be a Noetherian local domain of Krull dimension n over a field [formula], and with maximal ideal [formula]. We also assume that the residue field [formula] is [formula].

If [formula] are two [formula]-subspaces then by [formula] we denote the [formula]-span of all the xy where [formula] and [formula]. Note that if [formula] are ideals in R then [formula] coincides with the product of [formula] and [formula] as ideals.

A [formula]-subspace [formula] in R is called [formula]-primary if it contains a power of the maximal ideal [formula].

A graded sequence of subspaces is a sequence [formula] of [formula]-subspaces in R such that for all k,m > 0 we have [formula]. We call [formula], [formula]-primary if moreover [formula] is [formula]-primary. It then follows that every [formula] is [formula]-primary and hence [formula] is finite. (If each [formula] is an [formula]-primary ideal in R we call [formula] an [formula]-primary graded sequence of ideals.)

When [formula] is algebraically closed, an ideal [formula] in R  =  OX,p is [formula]-primary if the subvariety it defines around p coincides with the single point p itself.

Let [formula], [formula] be [formula]-primary graded sequences of subspaces. Then the sequence [formula] defined by

[formula]

is also an [formula]-primary graded sequence of subspaces which we call the product of [formula] and [formula].

Let [formula] be an [formula]-primary graded sequence of subspaces. Define the function [formula] by:

[formula]

We call it the Hilbert-Samuel function of [formula]. The Hilbert-Samuel function [formula] of an [formula]-primary subspace [formula] is the Hilbert-Samuel function of the sequence [formula]. That is, [formula].

For an [formula]-primary ideal [formula] it is well-known that, for sufficiently large values of k, the Hilbert-Samuel function [formula] coincides with a polynomial of degree n called the Hilbert-Samuel polynomial of [formula] ([\cite=SZ]).

Let [formula] be an [formula]-primary graded sequence of subspaces. We define the multiplicity [formula] to be:

[formula]

(It is not a priori clear that the limit exists.) The multiplicity [formula] of an [formula]-primary ideal [formula] is the multiplicity of its associated sequence [formula]. That is:

[formula]

(Note that by Remark [\ref=rem-Hilbert-Samuel-poly] the limit exists in this case.)

The notion of multiplicity comes from the following basic example:

In Section [\ref=sec-valuation-ideal] we use the material in Section [\ref=sec-semigp-ideal] to give a formula for [formula] in terms of covolume of a convex region.

One can also define the notion of mixed multiplicity for [formula]-primary ideals as the polarization of the Hilbert-Samuel multiplicity [formula], i.e. it is the unique function [formula] which is invariant under permuting the arguments, is multi-additive with respect to product, and for any [formula]-primary ideal [formula] the mixed multiplicity [formula] coincides with [formula]. In fact one can show that in the above definition of mixed multiplicity the [formula] need not be ideals and it suffices for them to be [formula]-primary subspaces.

Similar to multiplicity we have the following geometric meaning for the notion of mixed multiplicity when R  =  OX,p is the local ring of a point p on an n-dimensional algebraic variety X. Take [formula]-primary subspaces [formula] in R. The mixed multiplicity [formula] is equal to the intersection multiplicity, at the origin, of the hypersurfaces Hi  =  {x|fi(x)  =  0}, [formula], where each fi is a generic function from the [formula].

Case of monomial ideals and Newton polyhedra

In this section we discuss the case of monomial ideals. It is related to the classical notion of Newton polyhedron of a power series in n variables. We will see that our Theorem [\ref=th-vol-Gamma-semigroup] in this case immediately recovers (and generalizes) the local version of celebrated theorem of Bernstein-Kushnirenko ([\cite=Kushnirenko] and [\cite=AVG]).

Let R be the local ring of an affine toric variety at its torus fixed point. The algebra R can be realized as follows: Let [formula] be an n-dimensional strongly convex rational polyhedral cone with apex at the origin, that is, C is an n-dimensional convex cone generated by a finite number of rational vectors and it does not contain any lines through the origin. Consider the semigroup algebra over [formula] of the semigroup of integral points [formula]. In other words, consider the algebra of Laurent polynomials consisting of all the f of the form [formula], where we have used the shorthand notation [formula], [formula] and [formula]. Let R be the localization of this Laurent polynomial algebra at the maximal ideal [formula] generated by non-constant monomials. (Similarly instead of R we can take its completion at the maximal ideal [formula] which is an algebra of power series .)

Let [formula] be an [formula]-primary monomial ideal in R, that is, an [formula]-primary ideal generated by monomials. To [formula] we can associate a subset [formula] by

[formula]

The convex hull [formula] of [formula] is usually called the Newton polyhedron of the monomial ideal [formula]. It is a convex unbounded polyhedron in C, moreover it is a C-convex region. The Newton diagram of [formula] is the union of bounded faces of its Newton polyhedron.

It is easy to see that if [formula] is an ideal in R then [formula] is a semigroup ideal in [formula], that is, if x∈I and y∈S then x + y∈I.

Let [formula] be an [formula]-primary monomial ideal. Then for any k > 0 we have [formula]. It follows from Proposition [\ref=prop-polyhedral-primary-semigroup-ideal] that [formula] defined by [formula] is a primary graded sequence in [formula] and the convex region [formula] associated to [formula] coincides with the Newton polyhedron [formula] defined above.

More generally, let [formula] be an [formula]-primary graded sequence of monomial ideals in R. Associate a graded sequence [formula] in S to [formula] by:

[formula]

As usual let [formula] be a linear function such that C lies in [formula] and intersects [formula] only at the origin. Let [formula]. Then for all k > 0, [formula]. As in the proof of Proposition [\ref=prop-polyhedral-primary-semigroup-ideal] we can find t'0 > 0 such that for all k > 0, [formula]. Since [formula] is [formula]-primary there exists m > 0 such that [formula] and hence for all k > 0 we have [formula]. Thus [formula], which implies that [formula]. That is, [formula] is a primary graded sequence in S with t0  =  mt'0.

Let [formula] denote the convex region associated to the primary graded sequence [formula] (Definition [\ref=def-Gamma-I-semigroup]). We make the following important observation that [formula] is additive with respect to the product of graded sequences of monomial ideals.

From Proposition [\ref=prop-convex-region-monomial-ideal], Proposition [\ref=prop-Newton-poly-additive] and Theorem [\ref=th-vol-Gamma-semigroup] we readily obtain the following.

Using Theorem [\ref=th-mixed-multi-poly-semigp] one can define the mixed multiplicity of [formula]-primary graded sequences of monomial ideals. Then Theorem [\ref=th-mixed-multi-mixed-covol-monomial] can immediately be extended to mixed multiplicities of [formula]-primary graded sequences of monomial ideals.

One knows that the mixed multiplicity of an n-tuple [formula] of [formula]-primary subspaces in R gives the intersection multiplicity, at the origin, of hypersurfacs Hi  =  {x|fi(x)  =  0}, [formula], where each fi is a generic element from the subspace [formula]. Theorem [\ref=th-mixed-multi-mixed-covol-monomial] then gives the following corollary.

When R is the algebra of polynomials [formula] localized at the origin (or the algebra of power series localized at the origin), i.e. the case corresponding to the local ring of a smooth affine toric variety, Corollary [\ref=cor-local-BK-toric-sing] is the local version of the classical Bernstein-Kushnirenko theorem ([\cite=AVG]).

As opposed to the proof above, the original proof of the Kushnirenko theorem is quite involved.

Corollary [\ref=cor-local-BK-toric-sing] has been known to the second author since the early 90's (cf. [\cite=Askold-finite-sums]), although as far as the authors know it has not been published.

Main results

Let R be a domain over a field [formula]. Equip the group [formula] with a total order respecting addition.

A valuation [formula] is a function satisfying:

For all 0  ≠  f,g∈R, v(fg)  =  v(f)  +  v(g).

For all 0  ≠  f,g∈R with f + g  ≠  0 we have v(f + g)  ≥   min (v(f),v(g)). (One then shows that when v(f)  ≠  v(g), v(f + g)  =   min (v(f),v(g)).)

For all [formula], v(λ)  =  0.

We say that v has one-dimensional leaves if whenever v(f)  =  v(g), there is [formula] with v(g  +  λf)  >  v(g).

From definition [formula] is an additive subsemigroup of [formula] which we call the value semigroup of (R,v). Any valuation on R extends to the field of fractions K of R by defining v(f / g)  =  v(f)  -  v(g). The set [formula] is a subring of K called the valuation ring of v. Also [formula] is a maximal ideal in Rv. The field [formula] is called the residue field of v. One can see that v has one-dimensional leaves if and only if the residue field of v is [formula].

For a subspace [formula] in R define [formula] by:

[formula]

Similarly, for a graded sequence of subspaces [formula] in R, define [formula] by:

[formula]

For the rest of the paper we assume that R is a Notherian local domain of dimension n such that R is an algebra over a field [formula] isomorphic to the residue field [formula], where [formula] is the maximal ideal of R. Moreover, we assume that R has a good valuation in the following sense:

We say that a [formula]-valued valuation v on R with one-dimensional leaves is good if the following hold:

(i) The cone C(S) associated to the value semigroup [formula] is a strongly convex cone (recall that C(S) is the closure of convex hull of S). It implies that there is a linear function [formula] such that C(S) lies in [formula] and intersects [formula] only at the origin.

(ii) We assume there exists r0  >  0 and a linear function [formula] as above such that for any f∈R if [formula] for some k > 0 then [formula].

The condition (ii) in particular implies that for any k > 0 we have:

[formula]

In other words, the sequence [formula] given by [formula] is a primary graded sequence in the value semigroup S.

The following is a generalization of Proposition [\ref=prop-convex-region-monomial-ideal].

Let r0 > 0 be as in Definition [\ref=def-good-valuation] and let m > 0 be such that [formula]. Then for k > 0 we have [formula]. From Definition [\ref=def-good-valuation] for all k > 0, [formula], which implies that [formula]. That is, [formula] is a primary graded sequence with t0  =  mr0.

The arguments in Example [\ref=ex-good-val-toric-local-ring] in particular show the following:

More generally, one has:

By Theorem [\ref=th-good-val-reg-local-ring], S has a good valuation. By the linear Zariski subspace theorem in [\cite=Hubl] or [\cite=Cutkosky1] v|R is a good valuation for R too.

Using Theorem [\ref=th-good-val-S/R] and as in [\cite=Cutkosky1] we have the following:

Take m > 0 with [formula] and let r0 and [formula] be as in Definition [\ref=def-good-valuation]. If [formula] then [formula]. Thus the set of valuations of elements in [formula] is bounded. In particular [formula] is finite. Let B be a finite subset of R such that all the v(b), b∈B, are distinct and {v(b)|b∈B} coincides with [formula]. Among the set of elements in R that are not in the span of [formula] and B take f with maximum v(f). If v(f)  =  v(b) for some b∈B, then we can subtract a multiple of b from f getting an element g with v(g)  >  v(f) which contradicts the choice of f. Similarly v(f) can not lie in I otherwise we can subtract an element of [formula] from f to arrive at a similar contradiction. This shows that the set of images of elements of B in [formula] is a [formula]-vector space basis for [formula] which proves the proposition.

To the sequence of subspaces [formula] we associate a C-convex region [formula], which is the convex region [formula] associated to the primary sequence [formula]. The convex region [formula] depends on the choice of the valuation v. By definition the convex region [formula] associated to an [formula]-primary subspace [formula] is the convex region associated to the sequence of subspaces [formula].

The following superadditivity follows from Proposition [\ref=prop-additivity-semigroup-ideal]. Note that [formula] (cf. Proposition [\ref=prop-Newton-poly-additive]).

From Theorem [\ref=th-multi-ideal-covol], Proposition [\ref=prop-superadd-ideal] and Corollary [\ref=cor-Brunn-Mink-covol] we readily obtain:

By Theorem [\ref=th-good-val-analytically-irr-sing] and Corollary [\ref=cor-Brunn-Mink-multi] we obtain the Brunn-Minkowski inequality [\eqref=equ-Brunn-Mink-graded-seq-ideals] for an analytically irreducible local domain R. But in fact the assumption that R is analytically irreducible is not necessary: Suppose R is not necessarily analytically irreducible. First by a reduction theorem the statement can be reduced to dim R  =  n  =  2. In dimension 2, the inequality [\eqref=equ-Brunn-Mink-graded-seq-ideals] implies that the mixed multiplicity of ideals e(  ·  ,  ·  ), regarded as a bilinear form on the (multiplicative) semigroup of [formula]-primary graded sequences of ideals, is negative semidefinite restricted to each local analytic irreducible component. But the sum of negative semidefinite forms is again negative semidefinite which implies that Corollary [\ref=cor-Brunn-Mink-multi] should hold for R itself.

As another corollary of Theorem [\ref=th-multi-ideal-covol] we can immediately obtain inequalities between the multiplicity of an [formula]-primary ideal, multiplicity of its associated initial ideal and its length. Let R be a regular local ring of dimension n with a good valuation (as in Example [\ref=ex-good-val-toric-local-ring] and Theorem [\ref=th-good-val-reg-local-ring]).

From definition one shows that [formula] is the convex hull of [formula] (see Theorem [\ref=th-covol-monomial]). It easily follows that

[formula]

We now notice that [formula] is the number of integral points in [formula] that in turn is bigger than or equal to the volume of [formula] and hence the volume of [formula]. More generally, from the definition of [formula] we have an increasing sequence of convex regions:

[formula]

Now from Theorem [\ref=th-multi-ideal-covol] we have [formula] and for each k, [formula]. This finishes the proof.

The inequality [formula] is a special case of an inequality of Lech [\cite=Lech]. See also Lemma 1.3 in [\cite=FEM].