A symplectic integrator for the symmetry reduced and regularised planar 3-body problem with vanishing angular momentum

Introduction

It is well known that the flow ΨtH of a Hamiltonian H of the form H  =  T(p)  +  V(q) with conjugate variables q and p can be approximated by splitting it into the integrable flow ΨtT of T(p) and the integrable flow ΨtV of V(q) and observing that [formula], see, e.g.  [\cite=ChannellNeri1996] [\cite=HaLuWa02] [\cite=mclachlan2002] [\cite=LeimkuhlerReich04]. Thus a first order explicit symplectic integrator is obtained, and higher order methods can be constructed along similar lines [\cite=Yoshida1990]. In an integrable and separable Hamiltonian system of the form H  =  H1(q1,p1)  +  H2(q2,p2) such splitting gives the exact identity [formula]. If instead the Hamiltonian is a product H  =  H1(q1,p1)H2(q2,p2) again the system is integrable with integrals H1 and H2 and the flow can be written as

[formula]

In the superscript tHi denotes multiplication of t by the (constant) value of Hi. A monomial Hamiltonian is a special case that has the same structure. There are obvious generalisations to more degrees of freedom. Hence any polynomial Hamiltonian is a sum of integrable monomial Hamiltonians, and thus a splitting integrator can be constructed. Symplectic integration of polynomial Hamiltonians has been discussed in [\cite=shi93] [\cite=gjaja94] [\cite=ChannellNeri1996] [\cite=Blanes2002] [\cite=quispel2004]. In a recent paper by [\cite=blanesIserles2012] various methods for time step control in geometric integrators are constructed and discussed. These methods could be useful in order to implement variable time stepping on top of our method, see the discussion in section [\ref=subsec:timestep].

In this paper we apply these methods to the polynomial Hamiltonian of the globally regularised and symmetry reduced 3-body problem at angular momentum zero. For a review of numerical and regularisation methods in the n-body problem we refer to [\cite=Tanikawa2007]. It is well known that binary collisions in the 3-body problem can be regularised. Regularisation consists of a canonical transformations which essentially extracts a square root near collision, and of a scaling of time so that the approach to the collision is slowed down. The classical simultaneous regularisation of the (spatial) 3-body problem is due to [\cite=Heggie74]. This increases the dimension of phase space from 18 to 24. Instead we would like to decrease the dimension of phase space by using reduction at the same time as regularisation. The simultaneous regularisation of the planar 3-body problem is due to [\cite=lemaitre64], and we use a version due to [\cite=Waldvogel1982]. This is a symmetric simultaneous regularisation of the symmetry reduced planar 3-body problem and has the smallest possible 6-dimensional phase space. The resulting Hamiltonian is a polynomial of up to degree 6 in the canonical variables. A modern extension of these regularising transformations has recently been given by [\cite=MoMo12], however, their Hamiltonians are not polynomial but rational.

Our paper applies the methods for construction of an explicit symplectic integrator to Waldvogel's Hamiltonian with angular momentum zero. We also describe how a similar integrator could be constructed for Heggie's Hamiltonian, which works for non-zero angular momentum and in the spatial problem.

The 3-body Hamiltonian

The classical 3-body problem has long been studied, but still many open questions regarding its dynamics remain. For many questions, e.g. the study of relative periodic orbits, it is useful to reduce by translational and rotational symmetries, so that the absolute rotation of an orbit can be separated from shape dynamics in the centre of mass frame. Moreover, to study collision or near-collision orbits it is essential to perform (global) regularisation of the binary collisions. Following [\cite=Waldvogel1982] we are going to do both.

If the position and momentum of mass mj, for j  =  1,2,3, are given by complex Cartesian coordinates Xj and Pj respectively, we can transform into symmetry-reduced coordinates such that

[formula]

where aj  =  |Xl  -  Xk| is the length of the triangle's side opposite to mj, φj is the angle of that side in the original coordinate system (in the direction of mk to ml), as illustrated in figure [\ref=fig:1sym-reduce], and (j,k,l) represents cyclic permutations of (1,2,3).

This reduction results in coordinates aj and [formula], which represents the orientation angle of the triangle with respect to the original choice of Cartesian coordinates, and corresponding canonical momenta pj and pφ. The Hamiltonian rewritten in these coordinates is independent of φ, so pφ is a constant of motion. Hamilton's equations for (aj,φ,pj,pφ) give the reduced dynamics, including a differential equation for φ which may be integrated along to be able to recover the unreduced position of the triangle.

The globally regularising transformation, illustrated in figure [\ref=fig:2reg], goes from symmetry-reduced to regularised coordinates, simultaneously regularising all the binary collisions. Define αj for j  =  1,2,3 such that aj  =  α2k  +  α2l. In this way α2j is the distance from mj to the point where the incircle of the triangle touches the sides adjacent to mj.

The space of coordinates (aj) is the space of all triangles, not accounting for orientation. Orientation is taken to be positive if, going clockwise around the triangle, the masses are encountered in a cyclic permutation of (1,2,3) or negative otherwise. The space of all possible oriented triangles is called the shape space, and the space of (αj) is a four-fold covering of this space, in which the sign of the product α1α2α3 determines the orientation of the triangle. Thus the triangle formed by (α1,α2,α3) is the same as the ones formed by (α1, - α2, - α3), ( - α1,α2, - α3) and ( - α1, - α2,α3).

Canonically conjugate momenta πj are introduced using a generating function. Finally the time scaling

[formula]

together with Poincaré's trick to make this Hamiltonian yields the regularised and symmetry reduced polynomial Hamiltonian

[formula]

where H is the original Hamiltonian written in the new coordinates and [formula] is the energy corresponding to the initial conditions [formula], so only those solutions for which [formula] are physically meaningful.

The Hamiltonian of the zero-angular momentum 3-body problem in regularised coordinates is

[formula]

where

[formula]

in which

[formula]

where

[formula]

The sum in [\eqref=eqn:K0] (and any hereafter where the index of summation is unspecified) is over cyclic permutations of (1,2,3), so that (j,k,l) is replaced by (1,2,3), (2,3,1), and (3,1,2) in turn, and then the three corresponding terms are added together. When there is no summation the indices (j,k,l) take on the three possible cyclic permutations in turn, as, e.g., in the definition of Aj and Bk above. The new Hamiltonian is a polynomial in [formula] and [formula], and thus Hamilton's equations of motion for this system can be integrated with an explicit symplectic integrator obtained by splitting into monomials. As we are going to show in the next section it is more efficient to split into certain polynomials whose flow can be exactly solved.

Construction of the Symplectic Integrator

The basic building blocks of the integrator are the exact solutions for monomial Hamiltonians Hmn  =  qmpn in one degree of freedom. The flow of this Hamiltonian for m  ≠  n is

[formula]

while for m  =  n it is

[formula]

For the Hamiltonian we are studying the cases that occur are n = m = 1, n = m = 2, and m = 3, n = 1. We also recall that if the Hamiltonian is a function of positions or momenta only (with any number of degrees of freedom) the flows are

[formula]

Integrable Polynomial Hamiltonians

The basic building blocks just mentioned are now combined to form integrators for the terms that appear in the Hamiltonian K. The main observation is that if the Hamiltonian is a product of factors that depend on disjoint groups of degrees of freedom, then each factor is a constant of motion. Each of the factors in our case is either depending on momenta or positions only (denoted by T(p) or U(q)) or it is a single monomial in one degree of freedom (denoted by Hmn) or a sum of monomials of disjoint degrees of freedom (denoted by G).

We now list the cases that are relevant in our case (recall that each of the factors depends on disjoint groups of degrees of freedom): where G is a Hamiltonian which is the sum of Hamiltonians depending on disjoint degrees of freedom G  =  H1(q1,p1)  +  H2(q2,p2) and thus [formula]. Note that all these formulas are exact, and that the order of composition is irrelevant since the flows commute and the individual factors are constants of motion.

Splitting

Let us now explain how to split K [\eqref=eqn:K] into such terms. It is a polynomial Hamiltonian of degree 6 in [formula] and [formula] with 34 monomials. There are 13 monomials, dependent only on [formula], of degrees 6 and 4, which may be treated as a single stage. The remaining 21 terms may be grouped such that only 9 more stages are necessary to approximate the flow of the full Hamiltonian to first order in the time step in 10 stages. Let [formula], where we set Mj  =  mkml and [formula]. Then the splitting is

[formula]

where each subindexed function Ci is a constant of motion in its associated Hamiltonian.

There are clearly four groups in equation [\eqref=eqn:splitting], which we shall enumerate 0: {0}, 1: {1,2,3}, 2: {4,5,6} and 3: {7,8,9}. H0 depends on coordinates only, so can be integrated by [\eqref=eqn:porqonly]. Group 1 can be integrated by [\eqref=eqn:Hb], group 2 can be integrated by [\eqref=eqn:Ha], and finally group 3 can be integrated by [\eqref=eqn:Hc] where G is a sum of Hmm Hamiltonians.

Higher order methods

An important ingredient in constructing higher order reversible methods is the adjoint (φt)* of a method φt which is defined to be (φ- t)- 1. If [formula] and each ψti is self-adjoint, then the adjoint is obtained by reversing the order of composition. This follows from the definition of the adjoint:

[formula]

In our case the self-adjointness of the individual steps ψti follows from the fact that they are exact solution of Hamilton's equations.

Channell & Neri [\cite=ChannellNeri1996] offer a basic derivation of a reversible, symplectic map that is accurate to second order in the time step. When the splitting is of the form H  =  T(p)  +  U(q) this leads to the symplectic leapfrog integrator, by composing symplectic Euler with its adjoint.

This construction also applies to the more complicated case with a first order integrator composed of 10 self-adjoint maps as in our case. Given [formula] as above a reversible second order method is found as

[formula]

[\cite=Yoshida1990] gives a general method by which one may obtain integrators of arbitrary even order, if only one has, to start with, a reversible even-order integrator φt2 such as the symplectic leapfrog--or, more generally, symplectic midpoint. One can compose φt2 to obtain a fourth order integrator φt4, and compose this to obtain φt6 and so on. In general, given φt2n,

[formula]

where we define [formula] to adjust the step size of the lower order method.

This method is easy to construct and implement, but quickly becomes unwieldy. When n  =  2 (order 4), there are three evaluations of the second order method, but at orders 6 and 8 there are, respectively, nine and twenty-seven. As noted by [\cite=Yoshida1990], there are better methods, and he gives coefficients for a sixth order method and several sets of coefficients for eighth order methods. The construction of higher order methods is discussed extensively in [\cite=HaLuWa02] and [\cite=mclachlan2002]. We will assess in section [\ref=sec:numerics] which methods give good results for our problem comparing the methods whose coefficients are given in [\cite=HaLuWa02] and those constructed by [\cite=Yoshida1990].

Regularisation and variable time stepping

There is a well known restriction on symplectic integration that such integrators must use a constant step size, or the benefits of these methods for large integration times are lost due to the introduction of new secular error terms. Various authors have discussed methods of achieving adaptive step size in symplectic integration that avoids this problem; for example, [\cite=mikkola1997] [\cite=pretoTremaine1999] [\cite=blanesBudd2005] [\cite=blanesIserles2012].

In particular, [\cite=blanesIserles2012] explore the use of Sundman and Poincaré transformations and give a good overview of the problem. In general the Sundman transformation is non-symplectic, though with care the transformation can be made to respect geometric structure. In the their framework, the time scaling [formula] is called the monitor function. Our situation is special because the regularisation transformation consists of two intimately related steps. First there is the canonical extension of the transformation of coordinates from distances aj to their "roots" αj (space regularisation), and second there is the time scaling (time regularisation). The time scaling up to a constant factor is achieved using the square of the Jacobian determinant of the transformation of the coordinates. Only the combination of the two achieves global regularisation. Treating the time transformation separately as a monitor function would mean to integrate singular equations, since the original equations are singular at collision, and they are still singular after the spatial regularisation alone. Slight modifications of the time scaling are possible, see the remark at the end of the next section.

In order to achieve variable time stepping a monitor function could be used in the way described by [\cite=blanesIserles2012] by integrating another equation on top of the regularisation (in space and time) we have done. This may be particularly useful when integrating orbits with large distances between the bodies.

Finite time blowup

It must be noted that the solution of the Hamiltonian H  =  qmpn given in [\eqref=eqn:polysol1] can (for n  ≠  m) reach infinity in finite time. This occurs when

[formula]

This obviously makes step sizes comparable to this threshold risky when this form of solution is used in the integrator. This singularity could be reached if the denominator is negative and large during forward timesteps, or if the denominator is positive and large for "backward" timesteps (as during the middle stage of Yoshida's trick). This possibility arises in equation [\eqref=eqn:K] in the group 4 of the splitting [\eqref=eqn:splitting], which have terms of the form α3jπ1j. It may appear that this finite time blowup is an artefact of the integrator. However, after the time scaling the Hamiltonian K does have finite time blow up when particles escape to infinity. In this light it seems less unexpected that a stage of the corresponding symplectic integrator shows the same behaviour.

[\cite=Blanes2002] provides a means by which to avoid such singularities, by way of rewriting the polynomial in terms of sums of binomials in the coordinates and momenta and finding coefficients such that the two expressions are equal. We did apply this to the Hamiltonian H31 in our problem, and found a way to replace this with a Cremona map. However, it turned out that the overall error of the method was worse than without this modification. Our method is more expensive, since it needs to compute rational powers, but this additional cost is worth it.

A way to possibly avoid finite time blowup when the configuration of the system becomes large would be to consider a rational--rather than polynomial--time scaling function as in [\cite=MoMo12]. One could consider, for example, [formula] (recalling [formula]), which tends to 0 for γ  =  3 or to aj  /  4 for γ  =  2 as αj  →    ∞  . For negative energy, the only possible escape to infinity is of one single mass and a hard binary; in regularised coordinates this is exactly one coordinate tending to infinity while the other two remain bounded. Such a time scaling would inevitably require that the Hamiltonian be split differently, possibly with more stages and complexity. In principle the methods described in this paper apply as long as exact solutions can be found for the partial Hamiltonians. Unfortunately we have not been able to solve all of the resulting rational Hamiltonians.

Other polynomial globally regularised Hamiltonians

Our main concern in this paper is the zero-angular momentum reduced and regularised planar 3-body problem, which has 3 degrees of freedom. Other well known globally regularised polynomial Hamiltonians are due to [\cite=Waldvogel1972] for the planar 3-body problem and to [\cite=Heggie74] for the spatial 3-body problem. These Hamiltonians are not fully symmetry reduced and have 4 degrees of freedom (planar arbitrary angular momentum) and 12 degrees of freedom (spatial arbitrary angular momentum).

Heggie's simultaneously regularised Hamiltonian for the spatial 3-body problem [\cite=Heggie74] in canonical variables Qji and conjugate Pji, j  =  1,2,3, [formula] has the form

[formula]

where μjk  =  mjmk  /  (mj  +  mk), and [formula], [formula]. In addition Pl  =  (Pl1,Pl2,Pl3,Pl4)T and Al is the KS-matrix [\cite=kustaanheimo65] of the form

[formula]

The terms H0 and H4,5,6 are analogous to the previous ones. The terms in H- 1 can be split into 9 terms of the form ajfkgl where the functions fk and gl only depend on the degrees of freedom k and l, respectively. These terms are somewhat similar to the Hamiltonians H1,2,3 in Waldvogel's case. Thus the Hamiltonian can be split into 13 polynomials of degree up to 6 each of which is integrable.

When setting Qji and Pji with i = 3,4 equal to zero Heggie's Hamiltonian describes a planar problem. However, this still has 6 degrees of freedom. We can reduce the number of degrees of freedom to 4 by instead using Waldvogel's Hamiltonian [\cite=Waldvogel1972] [\cite=orbitsin3bp]. This Hamiltonian is a polynomial of degree 12 and can be split into 15 terms in a way similar to the two cases discussed above.

Numerical examples

In this section we will show some numerical results achieved using our integrator in a selection of orbits ranging from far from collision to close encounters to a collision orbit.

Figure [\ref=fig:averror] shows the energy error for various integration methods in a "work-precision" diagram. The error is averaged over several different initial conditions integrated over a fixed time interval. The error is displayed as a function of the computational cost. The methods compared are the base method of order 21, the integrators of [\cite=Yoshida1990] (43, 69, and 827) and other higher order symmetric compositions of symmetric methods of various authors, whose coefficients are given in [\cite=HaLuWa02], section V.3.2, also see the references therein. The subscript with each method's order indicates the number of second order substeps in the evaluation of a single time step, indicating the cost of each method, where the second order method is given the base cost of 1. A close look at the graph reveals that integrator 817 achieves the lowest error with a step size of about 0.0027, though it is a close call between any of the three best methods 815, 817 and 1035. Reducing the step size further creates larger round-off errors. All of the following examples are calculated with the 817 integrator and step size 0.0027, unless otherwise mentioned. Consider the figure-8 choreography, discovered by [\cite=fig8paper0Moore], proved to exist by [\cite=fig8paper1ChencinerMontgomery] and explored by [\cite=fig8paper2Simo] [\cite=fig8paper3Simo]. We choose initial conditions

[formula]

in regularised coordinates, with h  =   - 1 and equal unit masses. In scaled time, the figure-8 has a period of 2.221813718; in physical time its period is 9.2371333. The trajectory in regularised coordinates is shown in figures [\ref=fig:fig8alpha] and and the energy error over 25 orbits with large time steps given by the period divided by 200 is shown in figure [\ref=fig:fig8K]. Figure [\ref=fig:fig8-3d] shows the trajectory of this orbit in the 3-dimensional space (αj). Note that each crossing of a plane αj  =  0 corresponds to a syzygy with mj in the middle of the configuration.

Next we look at the Pythagorean orbit [\cite=pythagOrbit1967] for m1 = 3, m2 = 4, m3  =  5, with initial conditions as given in [\cite=orbitsin3bp], which, in regularised coordinates, are

[formula]

This orbit has a close encounter between masses 1 and 3 at around t  =  15.8 in physical time (about τ  =  1.52 in scaled time). Waldvogel's analysis regularises the system, albeit slightly differently, and his integration is not symplectic. The final motions of this orbit compare well with other studies; plotting the orbit in physical space produces results indistinguishable from [\cite=pythagOrbit1967], [\cite=orbitsin3bp].

The regularisation of the 3--body problem allows our integrator to cope well when the distances between any two masses are small. The result of the time scaling is that the regularised system has a finite time blowup for any escape orbit. If one continues to integrate the Pythagorean orbit past τ  =  8.105, the error in the energy grows exponentially and the results become inaccurate.

Finally, we show results in a periodic collision orbit, discovered during a search for periodic orbits in the reduced space, with initial conditions

[formula]

equal unit masses and h  =   - 1. This orbit has two collisions between masses 1 and 2, as can be seen by α1  =  α2  =  0 at τ  =  1.9362 and τ  =  5.062 in figure [\ref=fig:collalpha]. This orbit is periodic in full phase space and is shown in figures [\ref=fig:colldetails], [\ref=fig:collcartesian] and [\ref=fig:coll3d]. Its scaled period is 6.2520511, corresponding to a physical period of 29.6117209. Note in figure [\ref=fig:coll3d] that the collisions happen on the α3-axis, when α1  =  α2  =  0.

Because Hamiltonian systems are time-reversible, it is desirable to have an integrator with the same property. The second order map φt2 is constructed as such, and Yoshida's formula for higher order integrators constructs them to be reversible as well. That means that φt2n φ- t2n  =  Id up to roundoff error. Figures [\ref=fig:fig8error], [\ref=fig:pytherror] and [\ref=fig:collerror] show how closely this integrator returns to its initial condition after a certain number of time steps in one direction, followed by the same number of iterations with a negative time step.

By this measure, the integrator has the most trouble with Pythagorean orbit, which clearly shows signs that it exists within a chaotic region of phase space by the exponential growth of error. However; energy is well preserved in this and the other cases.

Conclusion

We have constructed a symplectic integrator for the reduced and regularised planar 3-body problem at zero angular momentum. The method works well, but it is not very efficient, because each (first order) time step involves the computation of 10 individual maps. Our interests is the computation of relative periodic orbits including collision orbits, and for this task the method is appropriate. The detailed results about relative periodic orbits and their geometric phase will be reported in a forthcoming paper.

Integrator stages

Subsection [\ref=subsec:monomialintegration] described how to integrate a monomial Hamiltonian, and subsection [\ref=subsec:splitting] described the splitting of equation [\eqref=eqn:K] into a minimal number of solvable parts and those solutions. Here we use those solutions to build an explicit first order symplectic composition method for [\eqref=eqn:K].

Let the timestep be Δτ, let μj  =  (mk  +  ml), let the values of the system before and after one timestep respectively be [formula] and [formula] and intermediate steps be [formula]. Now

[formula]