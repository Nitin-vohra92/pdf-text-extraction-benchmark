A second-order stock market model

Key words: stochastic portfolio theory, Atlas model, first-order model, second-order model.

JEL Classification: G10. AMS 2010 Subject Classification: 91B24.

Introduction

First-order and second-order stock market models are relatively simple stochastic models that manifest some of the stability properties of actual stock market behavior. These models are descriptive as opposed to normative, and are constructed using data analysis based on actual stock markets. First-order models are stock-market models where the parameters for return and volatility are based on the ranks of the stocks. These models were introduced in and developed in , and reflect the actual rank-based growth rates and variances of the stocks in the market. First-order models are asymptotically stable, and accurately reproduce the long-term characteristics of the market's capital distribution. However, these models are ergodic in the sense that each stock asymptotically spends equal average time at each rank, and this ergodicity property does not seem to be present in actual markets. This lack of verisimilitude is the motivation to consider the next level of complexity: second-order models.

Second-order models are a form of hybrid Atlas models, where the return and volatility parameters are based on the rank and the name (or index) of the stocks (see ). While these models retain many of the characteristics of first-order models, the above ergodicity property is no longer present, and this produces a more realistic representation of actual stock market behavior. In second-order models, larger stocks tend to remain asymptotically among larger stocks, and smaller stocks tend to remain among smaller stocks. This behavior is closer to that of actual stock markets, so second-order models provide a more accurate descriptive representation of stock market behavior.

Estimation of the parameters for first-order models is fairly straightforward, and can be accomplished without great ado. Second-order parameter estimation is somewhat more complicated. Here we shall focus on the growth-rate parameters, and find it necessary to rely on implicit methods to determine values for these parameters. Our purpose here is to develop techniques for estimating second-order growth-rate parameters, not to carry out an exhaustive examination of these parameters for an entire stock market. First, let us establish some formal definitions.

A market is a family of stocks [formula] whose capitalizations are modeled by continuous, positive semimartingales that satisfy

[formula]

for [formula], where n  ≤  d, [formula] is an [formula]-valued Brownian motion defined on [formula], and the Gi and Siν are progressively measurable with respect to the Brownian filtration, with Gi locally integrable and Siν locally square-integrable. The reason we define these processes on [formula] is that in practice we are confronted with time series over a given block of time, and the analysis of these series can be performed in both forward and reversed time. Hence, we see a sample in time of the processes [formula] and draw our conclusions from this sample.

We shall assume that for any i  ≠  j, the intersection sets {t:Xi(t) = Xj(t)} have Lebesgue measure zero, almost surely, and we shall also assume that there are no triple points, i.e., if i < j < k then there is almost surely no [formula] such that Xi(t) = Xj(t) = Xk(t). The general setting for our model can be found in and .

The value Xi(t) of the stock Xi at time t represents the total capitalization of the company at that time. If we let Z represent the total capitalization of the market, then and we can define the market portfolio to be the portfolio μ with weight processes given by the market weights

We shall assume that the market weight process [formula] has a stable, or steady-state, distribution, and that the system is in that stable distribution. We shall be interested in the relative behavior of the log-capitalizations or log-weights. If μ(t) is in its steady-state distribution, then the log-difference processes defined by for [formula], will also be in their steady-state distribution.

Consider the ranked capitalization processes corresponding to the Xi(t) in descending order and the corresponding ranked market weights Let rt(i) represent the rank of Xi(t), and let pt be the inverse permutation of rt (with ties in rank settled by the order of the indices), so and, similarly Hence, pt(k) represents the index, or name, of the stock occupying rank k at time t.

The ranked market weights [formula] comprise the capital distribution curve of the market at time t. The capital distribution curves over several decades of the 20th century can be seen in Figure [\ref=f1], a version of which appears in . The curves in Figure [\ref=f1] show the ranked market weights on December 31 of the years 1929, 1939, 1949, 1959, 1969, 1979, 1989, and 1999. During that period, the number of stocks in the market increased over each decade, so the decade associated with each curve is clear from the chart. We see that the capital distribution curve of the market shows a certain stability over time, so the assumption that μ is in its steady state distribution would seem to be consistent with the observed data.

Acknowledgements. The authors are grateful to Adrian Banner, Daniel Fernholz, Vassilios Papathanakos, and Johannes Ruf for their many helpful discussions and suggestions, as well as for their participation and inspiration during the course of this research.

First-order models

A first-order model is a stock-market model in which each stock has constant growth and variance parameters that depend only on the rank of the stock by market capitalization. These models were developed in and , and can be constructed to reflect certain properties of actual stock markets. A first-order model that is based on an actual market will have a steady-state capital distribution curve that is about the same as the capital distribution curve for the actual market (see , Figure 5.6).

A first-order model is defined by a system [formula] of the form

[formula]

for [formula], where [formula] are real constants, [formula] are positive constants, and [formula] is an [formula]-valued Brownian motion, and where r̂t(i) represents the rank of X̂i(t) (analogously to rt(i) for the rank of Xi(t)). We shall assume that the gk satisfy and for m < n. With these parameters, the X̂i form an asymptotically stable system, which means that the market weights [formula] satisfy and the limits corresponding to [\eqref=2.2a] and [\eqref=2.2z] below exist (see also , Definition 5.3.1).

Suppose we have a market X, and suppose that its market portfolio μ is in the steady-state distribution. We define the asymptotic rank-based relative variances for the market by

[formula]

and the asymptotic rank-based relative growth rates by

[formula]

and suppose these limits exist almost surely. Since these parameters are based on the market weight processes μi, they represent values relative to the market portfolio μ.

For [formula], let Λ be the local time of the nonnegative semimartingale [formula] at the origin, and set [formula]. Since we have assumed that the Xi almost surely have no triple points, it follows that for [formula], the local time by Λ is identically zero, so here we need to consider only local times of the form Λ, and we have For [formula], we can define the asymptotic local time

[formula]

which exists almost surely, and define [formula]. It turns out that the estimation of the [formula] is not difficult, and the procedure is described in the appendix of . It can be shown (c.f. Proposition 5.3.2 in ) that

[formula]

holds for [formula], and it follows that [formula].

The smoothed values of [formula] and [formula] for the largest 5120 stocks in the U.S. market for the decade 1990-1999 are shown in Figures [\ref=f2] and [\ref=f3]. Since the number of stocks in the market changed during the decade of 1990-1999, we limit our attention here to the largest 5120 stocks, which is fewer than the number of stocks in the market at any time during that decade. The values in Figure [\ref=f3] do not add up to zero, since the largest 5120 stocks are a strict subset of the larger market.

The first-order model [formula] such that

[formula]

where r̂t(i) is the rank of X̂i(t) at time t, is called the first-order model for the market X. As we have seen, the growth and variance parameters for X̂ are derived from the relative growth and variance parameters corresponding to the market weight processes [formula], not directly from the capitalization processes X̂i.

First-order models are ergodic in the sense that

[formula]

This ergodicity property does not seem to be present in real markets, but instead there exist asymptotic occupation rates defined by

[formula]

Here θki represents the fraction of time that Xi spends in the kth rank. The n  ×  n matrix θ = (θki) is bistochastic, and we shall assume that all the entries are positive. For a first-order model, [\eqref=2.20] implies that θki = 1 / n for all i and k, and since this does not seem to characterize the behavior of real markets, we shall now consider a more general class of models.

Second-order models

A second-order model is a stock-market model in which each stock has constant growth and variance parameters that depend on the rank and name, or index, of the stock. Second-order models are examples of hybrid (Atlas) models, which were discussed in . A second-order model is defined by a system [formula] of the form

[formula]

for [formula], with constants gk, γi and σik > 0, for [formula], and a Brownian motion W. In order for the X̂i to be asymptotically stable, these parameters must satisfy and, for any permutation π∈Σn, Here we are interested in estimating the growth-rate parameters γi and gk. For simplicity, we shall consider only rank-based variances, and assume that σ2ik  =  σ2k for all i and k.

It was shown in that a second-order model of the form [\eqref=3.1] is asymptotically stable, and the asymptotic occupation rates

[formula]

are defined for all i and k, almost surely. The matrix [formula], like θ in [\eqref=2.2b], will be bistochastic with positive entries. We can generate the first-order parameters [formula] and [formula] for X̂ as in [\eqref=2.2a] and [\eqref=2.8], with and With these parameters, it was shown in that, almost surely,

[formula]

In matrix form, this can be expressed

[formula]

where γ, g, and [formula] are column vectors. From this we see that

[formula]

so

[formula]

Estimation of second-order parameters

The first-order growth parameters [formula] for the market X can be estimated directly from the stock return time series; however, second-order growth parameters will have to be estimated indirectly. We wish to construct a second-order model that has first-order growth parameters equal to those of the market, and an occupation-rate matrix equal to the occupation-rate matrix θ of the market. Under these circumstances, as in [\eqref=1], we have

[formula]

and we wish to solve this equation for g, the vector of name-based growth parameters for the second-order model of the market X. If we can solve [\eqref=4.1a] for this g, then we can use [\eqref=4], in the form

[formula]

to generate the name-based growth parameters γi for this second-order model. Let us first consider the matrix θ.

The matrix θ is bistochastic and we have assumed that all its entries are positive, so this also holds for θT and θθT. By the Perron-Frobenius theorem (see ), the symmetric matrix θθT will have a simple eigenvalue equal to 1 with eigenvector [formula], and all the other eigenvalues will have absolute value less than 1. Hence, In  -  θθT has rank n - 1 and its kernel is generated by e1, so the condition that the gk sum to zero means that g is orthogonal to this kernel, and this ensures a unique solution to [\eqref=4.1a].

Unfortunately, it seems to be essentially impossible to estimate θ with any reasonable accuracy, so although we can use this matrix to prove the existence and uniqueness of g, in practice we cannot actually solve equation [\eqref=4.1a]. Instead, let us consider [\eqref=3.5] in the form

[formula]

We can use this equation to generate the gk recursively, and then estimate the γi from the returns data and the gk.

Let us assume that the market X is defined for all [formula], that the weight process μ for X has a stable distribution, and that μ is in that stable distribution. We can then define the time-reversed market [formula] with stock capitalizations [formula] and weights [formula], and with this definition we can define the expected backward occupation rates similarly to [\eqref=2.2b]. Since the weight process is in its steady-state distribution, the limits of [\eqref=2.2b] will be the same at plus and minus infinity, so the forward and backward expected occupation rates θki will be equal. The results of imply that the forward and backward asymptotic local times Λ will also be the same, so the forward and backward versions of the [formula] are equal. Hence, it follows from [\eqref=2.3] that the forward and backward [formula] are equal. In this case, [\eqref=4.1a] implies that the forward and backward values of the gk are equal, and from [\eqref=4.1b], we see that the forward and backward γi are also equal. Quadratic variation is invariant under time reversal, so the forward and backward [formula] will be the same. Hence, the first- and second-order models for X are the same as the corresponding models for [formula], and this allows us to use both X and [formula] to estimate the second-order parameters.

In order to estimate the second-order parameters, it is necessary to observe the movement of market weights forward and backward in time. To this end, we define the concept of flow in a market. The forward flow φk of the market at rank k is defined for [formula] by and the backward flow [formula] of the market is defined by In Figure [\ref=f4] we see the exponential of forward and backward flow for the largest 250 stocks in the U.S. market over the decade from 1990 to 1999. The plots show the average exponential flow of each of the ten deciles of the top 250 stocks, with each decile comprising 25 stocks. The forward and backward flows need not be equal, and they do not appear to be equal in Figure [\ref=f4]. We see from the chart that for the largest 250 stocks the flow is downward. For the smaller stocks, we would expect the flow to be upward.

If we follow the flow of a stock that occupies a given rank at time zero, then the expected rank of the stock will change over time according to its flow. Suppose a stock is at rank k at time 0, and let us estimate its expected rank at time [formula] by In this case, [formula], and if this rank is among the higher ranks, we would expect the flow to be negative, which would mean that for τ > 0 we would expect that [formula] and [formula]. We would like to use the [formula] to estimate the gk, and although [formula] need not equal [formula], the gk generated using either one will provide estimates for the solution of [\eqref=1]. Accordingly, we shall use the average of the two, with where the brackets signify the nearest integer. Values of [formula] for [formula] and [formula] are shown in Figure [\ref=f5], and the values for positive and negative τ are clearly different. We have no explanation for this difference.

Figure [\ref=f4] was generated by following the market weights of stocks that occupied a given rank at a given time in the decade from January 1, 1990 to December 31, 1999. Since stocks enter and leave the market, we used only the largest 250 stocks, after eliminating any stocks that did not have a full ten-year history. The trajectories of the weights for each to the top 250 ranks were followed for 1000 days forward or backward, and were then averaged over all starting dates that would allow the full 1000 days to be used. Finally, the ranks were separated into deciles, with ranks 1-25 in the first decile, 26-50 in the second decile, and so forth. The curves in Figure [\ref=f4] represent the average trajectories for the weights of each of the ten deciles, forward and backward.

Figure [\ref=f5] was generated by following the weight trajectories used for Figure [\ref=f4] and, for each trajectory, noting the starting rank and ending rank, i.e., the rank after 1000 days (approximately four years of trading days). The final rank corresponding to the initial rank k in Figure [\ref=f5] is the average ending rank for those trajectories that begin at rank k at time 0. This was carried out in forward time and reversed time.

Let [formula] be the expected growth rate at time [formula] of a stock which occupies rank k at time 0, and we shall estimate [formula] and [formula] from the slope of the forward and backward flow at rank k, so

[formula]

for τ  ≥  0, with [formula]. We shall use the average to estimate the rank-based growth rates gk. In the data we analyzed, the derivatives in [\eqref=4.4] at τ = 4 were estimated by measuring the rate of change of the flows φ(τ) and [formula] for the period from day 981 to day 1000, and then annualizing this rate.

Since for a given stock the name-based growth rate is invariant with rank, the same holds for the average of the name-based growth rates weighted by occupation rates, Hence,

[formula]

for [formula], where and [formula] the largest integer such that [formula]. If we combine [\eqref=4.1] with [\eqref=3.5], we find that

[formula]

We can first estimate [formula], [formula], and [formula], and then use [\eqref=4.2] to recursively generate the values of the rank-based growth rates gk for a subsequence of ranks of the form [formula], as well as interpolated points.

Once we have estimates for the values of the gk, we can estimate the γi directly by using

[formula]

Our second-order model for the market X will then be

The various steps in the estimation process are shown in Figures [\ref=f6], [\ref=f7], and [\ref=f8]. In Figure [\ref=f6] we see the estimated forward rank [formula] versus the initial rank k, and find that the relation is quite close to linear with With this estimate, we can use [\eqref=4.2] in the form

[formula]

to estimate the gk from the values of [formula] and [formula].

The values of [formula] were estimated from the slopes of the flows used to generate Figure [\ref=f4] for the ten rank-decile groups of 25 stocks each from the largest 250 stocks. Linear approximations for all the ranks were generated using a least squares fit. These results appear in Figure [\ref=f7], and the corresponding linear equations are By using the values derived from these equations in [\eqref=4.4] we can generate values for gk for an increasing sequence of ranks k. The chart in Figure [\ref=f8] shows these values with linear interpolation connecting the points to generate a continuous curve.

Once we have estimates for the values of the gk, we can use these values along with [\eqref=4.3] to estimate values for the γi of individual stocks by name. The integrals in [\eqref=4.3] were approximated by daily logarithmic relative returns taken for each of the stocks along with the values of the gk. The (non-normalized) values for γi for the decade 1990-1999 for a number of well-known stocks appear in Table [\ref=t1]. This is hardly a definitive study, so only a few stocks are included here. Moreover, in some future work, it would be desirable to have confidence intervals for these values, rather than point estimates. In that regard, probably the most promising method would use some form of jackknife estimator, with perhaps 12 pseudovalues generated by leaving out one month of the year at a time (see ). Probably the entire estimation process would need to be repeated for each pseudovalue.

The values in Table [\ref=t1] were estimated using combined forward and backward estimates, as in [\eqref=4.3], for the decade 1990-1999. Using only forward estimates or only backward estimates for the γi could have produced biased estimates, since some of these companies grew considerably over that decade. For each company, the number in parentheses is the rank of the time-averaged log-weight of the stock during the decade.

While the values in Table [\ref=t1] may not be definitive, they at least appear plausible. The higher-ranked stocks have generally higher γ, which should help them maintain their positions at the top of the market. At this writing, Apple, AAPL, has the highest market capitalization in the U.S. market, but in the 1990s we see that its average rank was 93, and its γ is correspondingly - 1.67%. Hence, the estimated γi provide no miraculous forecasts of future behavior; instead they reflect local stability consistent with the observed decade.

Conclusion

The purpose of first- and second-order models for stock markets is to create a rigorous backdrop for the statistical analysis of the behavior of individual stocks. Second-order models provide a more accurate and complete representation of a stock market than is possible in first-order models. The estimation of parameters for second-order models is more involved than for first-order models, and implicit methods must be used. We have proposed methods for the estimation of second-order growth rate parameters, and with these methods a more complete stock-market model is possible. Nevertheless, our techniques are rudimentary, and we believe that future research will yield significant improvements.