High moments Jarque-Bera tests for arbitrary distribution functions

Introduction

In this paper, we are concerned with generalizations of Jarque-Bera's (JB) [\cite=jarque] tests based on arbitrary first (4k) moments, k  ≥  2, rather than on the first eight ones as usual. (See [\cite=neil] for a reminder of JB tests, page 69). We obtain general statistics that allow statistical tests for any distribution function G provided it has enough moments. For a reminder, the classical JB test belongs to the class of omnibus moment tests, i.e. those which assess simultaneously whether the skewness and kurtosis of the data are consistent with a Gaussian model. This test proved optimum asymptotic power and good finite sample properties (see [\cite=jarque]). A detailed description of that test and related indepth analyses can be found in Bowman and Shenton, D'Agosto, D'Agostino et al., etc. (See [\cite=bowman], [\cite=dagostino], [\cite=dagostinopers] and [\cite=dagostinotiet]).

Let X, X1, X2, ... be a sequence of independent and identically distributed random variables (r.v.'s) defined on the same probability space [formula]. For each n  ≥  1, the skewness and kurtosis coefficients related to the sample X,...,Xn are defined by

[formula]

These statistics are designed to estimate the theoretical skewness and kurtosis given by [formula] and [formula] where [formula] and σ2 = var(X) respectively denote the mean and the variance of X that is supposed to be nondegenerated. Here and in all the sequel, [formula] stands for the mathematical expectation with respect to the probability [formula]. Now, under the hypothesis :

H0 : X follows a Gaussian normal law,

we have b2 = 0 and a = 3 and the JB statistic

[formula]

has an asymptotic chi-square distribution with two degrees of freedom under the null hypothesis of normality. Jarque-Bera's test consists in rejecting H0 when Tn is far from zero. We will find below that the constants 6 and 24 used in ([\ref=jb]), actually, are closely related to the first four even moments of a N(0,1) random variable which are 1,3,15 and 105 and a more convenient form of ([\ref=jb]) is

Our objective here is to generalize JB's test to a general df G by considering high  moments [formula] [formula] with [formula],instead of the first eight moments only. We base our methods on the remark that for a random variable X  ~  N(m,σ2), one has

[formula]

Actually JB's test only checks the third and fourth moments of X while the coefficients of the JB statistic ([\ref=jb]) uses the first eight moments of X. Our guess is that we would have better tests if we were able to simultaneously check all the first (2k) moments for some k  ≥  2. To this purpose, we consider the following statistics, that is the normalized centered empirical moments (NCEM),

[formula]

where

are the [formula] non-centered and the centered empirical moments. By the classical law of large numbers, the statistics in ([\ref=momemp]) are, for each fixed p, asymptotic estimators of

[formula]

whenever the (4p)th moment exists. Finally we consider C1-class functions [formula] et [formula] and denote [formula] and [formula].

Our general test is based on the following statistics, for k  ≥  2,

[formula]

which almost-surely (a.s) tends to

[formula]

as n  →    +    ∞  . For an independent and identically distributed sequence X1, X2, ... of r.v.'s associated with a distribution function G having a finite 2k-moment, we will have by Theorem [\ref=theo1] below that

From such a general result, we are able to derive a normality test by using it with bp = 0, ap = ((2p) / (2pp!) for 2  ≤  p  ≤  k, and rejects normality for a large value of Tn(f,q,k).

We are going to establish a general asymptotic normality of Tn(f,g,k) for any df's G with 4k finite moments. These results provide themselves efficient tests for an arbitrary d.f. Next, we will derive chi-square tests that generalize JB's test for higher moments and for arbitrary df's too.

Our results will show that these tests based on the 2k moments, need, in fact, the eight 4k moments for computing the variance. This unveils that the classical JB's test is not based only on the kurtosis and the skewness but also on the sixth and the eighth moments. To describe the complete form of the Jarque-Bera method, put

The JB's test for a N(m,σ2) r.v. will be showed to derive from the following general law

[formula]

with the particular coefficients p = 2, bp = 0 and ap = 3. This may be a new explanation of the powerfulness of the JB classical tests since a successful test of normality means that the sample is from a df having same first eight moments as the N(0,1) r.v., and this is very highly improbable for a non normal r.v..

As an illustration of what preceeds, consider a distribution following a double-gamma distribution [formula] of density probability [formula] with [formula]. This rv is centered and has a kurtosis coefficient equal to 3. It is rejected from normality by the JB test. If only the skewned and kurtosis do matter, it would not be the case. Actually, the rejection comes from the parameters aj(2) and bj(2) that are very different from a standard normal distribution to this specific distribution.

The rest of the paper is organized as follows. In Subsection [\ref=subsec21] of Section [\ref=sec2] we begin to give a concise of reminder the modern theory of functional empirical processes that is the main theoretical tool we use for finding the asymptotic law of ([\ref=02]). Next in Subsection [\ref=subsec22] we establish general results of the consistency of ([\ref=02]) and its asymptotic law, consider particular cases in Subsection [\ref=subsec23], propose chi-square universal tests in Subsection [\ref=subsec24] and finally state the proofs in Subsection [\ref=subsec25]. We end the paper by Section [\ref=sec3] where simulation results concerning the normal and double-exponential models are given.

We here express that in all the sequel, the limits are meant as n  →    +    ∞   and this will not be precised again unless it is necessary.

RESULTS AND PROOFS

A reminder of Functional empirical process

Since the empirical functional process is our key tool here, we are going to make a brief reminder on this process associated with X1, X2, ..., and defined for each n  ≥  1 by

where f is a real measurable function defined on [formula] such that

[formula]

and

[formula]

It is known (see van der Vaart [\cite=vaart], pages 81-93) that [formula] converges to a functional Gaussian process [formula] with covariance function

[formula]

at least in finite distributions. [formula] is linear, that is, for f and g satisfying ([\ref=var]) and for [formula], we have

This linearity will be useful for our proofs. We are now in position to state our main results.

Statements of results

First introduce this notation for [formula], k  ≥  2, and 2  ≤  p  ≤  k. Let fi and gi, i = 1,...,k be C1-functions with values in [formula]. Put μ2  =  σ2 and m1 = m and [formula]

[formula]

[formula]

[formula]

and

[formula]

Here are our main results.

Let [formula] for k  ≥  2. Then where

(Normality test). Let X be a [formula] r.v. and let, for all k  ≥  2 Then where and

Particular cases and consequences

A general test

Let G be an arbitrary df with a 4kth finite moment for k  ≥  2, this is [formula]. We want to check whether a sample X1,..,Xn is from G. We then select C1 - functions fi and gi, i = 1,...,k and compute the observed value [formula] of [formula] and report the p-value of the test, that is [formula] where s2 is either the exact variance σ2k or its plug-in estimator

Our guess is that using a greater value of k makes the test more powerful since the equality in distribution of univariate r.v.'s means equality of all moments when they exist (see page 213 in [\cite=loeve]). For k = 2, this result depends on the first eight moments. Then to find another df G1 for which the p-value exceeds 5% would suggest it has the same eight moments as G, which is highly improbable. Simulation studies in Section [\ref=sec3] support our findings. Remark that we have as many choices as possible for the functions the [formula] and [formula].

Unfortunately, in the simulation studies reported below, we noticed that the plug-in estimator 2k,n may hugely over estimate the exact variance and leads to accepting any data to follow that model, or significantly underestimate it and leads to reject data form the model itself. This is why we only use the exact variance here.

Now let us show how to derive chi-square tests from Theorem [\ref=theo1].

Generalized JB test and tests for symmetrical df's

Suppose that X is a symmetrical distribution. We have from Theorem [\ref=theo1] that

[formula]

Since X is symmetrical, that is [formula] for [formula], we may without loss of generality suppose that m1 = 0 since replacing X by X - m1 does affect neither the [formula] nor the [formula] Then we have from ([\ref=no1]) and ([\ref=no2]) thatand

By reminding that hphq = hp + q for p  ≥  0 and q  ≥  0, we observe that the product B(p)  ×  C(p) only includes functions hj with odd [formula] and then [formula]. Thus

where [formula] and [formula]. We get

Let [formula] for p  ≥  2 and G be a symmetrical df. We have

[formula]

For a standard normal random variable, we get bj(2) = 6 and aj(2) = 24 and the normality JB's test becomes a particular case of ([\ref=jbG]), which is a general chi-square test for an arbritrary df with 2p-finite moments.

Let G be a Gaussian df. Then

We see that we obtain an infinite number of tests for the normality. For example, for p=3, we have, [formula] etc.

A general chi-square test

Consider ([\ref=no5]) and put abj(p) = cov(C(p),B(p)) and suppose that Δ(p) = aj(p)  ×  bj(p) - abj(p)2  ≠  0. We have

Let [formula] and Δ(p)  ≠  0 for 2  ≤  p  ≤  k. Then converges in law to a χ22 r.v..

It is now time to prove Theorem [\ref=theo1] before considering the simulation studies.

Proofs

Since G has at least first 4k moments finite, we are entitled to use the finite-distribution convergence of the empirical function process [formula] as below. Let us begin to give the asymptotic law of [formula]. By denoting [formula] we have

where [formula] is defined in ([\ref=no1]) and where we used that the linearity of the empirical functional process. By observing that [formula], we finally obtain

[formula]

Now the law of bn,p is given by

By the delta-method, we have

and then

and next, by noticing from [\ref=03] that [formula] for all [formula],

where B(p) is given in ([\ref=no2]). By the very same methods, we have

C(p) is stated in ([\ref=no3]). The delta-method also yields

This completes the proof of the theorem. The proof of the corollary is a simple consequence of the theorem.

Simulation and Applications

Scope the study

We want to focus on illustratring how performs the general test for usual laws such as Normal and Double Gamma ones. It is clear that the generality of our results that are applicable to arbitrary d.f.'s with some finite kth-moment (k  ≥  2) deserves extended simulation studies for different classes of df's. We particularly have to pay attention to the choice of k and of the functions fi and gi, depending on the specific model we want to test.

In this paper, we want to set a general and workable method to simulate and test two symmetrical models. The normal and the double-exponential one with density [formula]. We expect to find a test that accepts normality for normal data and rejects double-exponental data and to confirm this by the Jarque-Berra test, and to have an other test that exactely does the contrary.

Once these results are achieved, we would be in position to handle a larger scale simulation research following the outlined method. Specially, fitting financial data to the generalized hyberpoblic model is one the most interesting applications of our results.

The frame

We first choose all the functions fi equal to f0 and all the functions gi equal to g0. We fix k = 3, that is we work with the first twelve moments. As a general method, we consider two [formula] G1 and G2. We fix one of them say G1 and compute T(f,g,k) = T(f,g,k,G1) and the variance σ2k from the exact distribution function G1. We generate samples of size n from one the [formula] (either G1 or G2) and compute Tn(f,g,k). We repeat this B times and report the mean value [formula] of the replicated values of [formula] and report the p-value [formula]. The simulation outcomes will be considered as conclusive if p is high for samples from G1 and low for samples from G2. The results are compared with those given by the Kolmogorov-Smirnov test (KST) and when the data are Gaussian, they are compared with the outcomes from JB's classical test.

The results

We consider the following cases : G1 is a Gaussian r.v N(m,σ2); G2 is double-exponential law  Ed(λ) with density probability [formula] and G3 is a double-gamma law γd(a,b) with probability density [formula].

Normal Model N(m,[formula]

The choice f0(x) = g0(x) = x2 is natural since the Jarque-Berra test may be derived for our result for these functions and for k = 2. The model is determined by these following parameters :

We recall that the variance of our statistic depends on the first 4k moments.

Simulation study.

Testing the model with N(0,1) data gives the following outcomes for n = 20

and for n = 100,

and for n = 1000,

where JB is the classical Jarque-Berra statistic, pJB is the p-value of the JB test, KS is the Kolmogorov-smirnov statistic and pKS is the related p-value. Our model accepts the normality and this is confirmed by JB's test and by the Klmogorov-Smirnov test (KST). The simulation results are very stable and constantly suggest acceptance.

Testing the double-exponential versus the normal model

Recall that the values (bp,ap) for 2  ≤  p  ≤  6  are (0,3),(0,15),(0,946),(0,10395). Comparing these values with those of a normal model, it is natural to think that the test will fail since only the bp coincide and the test is only based on the moments. Indeed, using data from Ed(1) gives for n = 11

and for n = 22

Our test rejects the Ed(1) model for n = 11 and JB's test rejects it only for n  ≥  22. We see here the advantage brought by the value k = 3 in our statistic. The KST has problems in rejecting the false Ed(1) even for n = 1000 that of Jarque-Berra.

Testing the double-gamma versus the normal model.

Let use γd(a,b) data with [formula] and b = 1. We have the outcomes for n = 11

and for n = 22

We have similar results. Ou test rejects the Ed(1) model for n = 12 and JB's test rejects it only for n  ≥  18. We see here the advantage brought by the value k = 3 in our statistic. Although the first four moments of a γd(a0,1) are 0,1,0 and 3, that is, the same of those of standard normal rv, this model is rejected. We already pointed out that the coefficients 4 and 6 are in fact based on the first eight moments and the discrepancy of moments higher than 4 results in the rejection.

Analysing the tables above, we conclude that our test performs better the JB's test against a double-gamma df with same skewness and kurtosis than a normal df for small sample sizes around ten and this is real advantage for small data sizes. Even for k = 2, our test is performant for the small values n = 11 and n = 12.

Double-exponential model Ed(λ).

We point out that the statistic Tn(f,g,k) does not depend on the λ. Then we only consider λ = 1 in the following. We always use f0(x) = g0(x) = x2. The model is determined by the following values.

Here, we do not have the Jarque-Berra test to confirm the results.

Simulation. Testing the model with Ed(λ) data gives the following outcomes, for n = 800.

The simulation results are very stable and constantly suggest acceptance.

Testing normal data. Using normal data gives

The N(0,1) model is rejected. We noticed that the rejection of normal data is automatically obtained for large sizes here, when n is greater than 900. For n between 500 and 900, rejection is frequent but acceptance occurs now and then. Whe also noticed that the variance of [formula] are high and do not allow to reject normal data for small sizes. This leads us to consider other functions. Now consider the classes of functions We obtain good results for n = 150 with θ = 0.1 and p = 2. In this case, the exact value of the statistic is 11.600. The double-exponential Ed(1) model is confirmed according to the following table

while the normal model is rejected as illustrated below :

It is important to mention here that the KST is very powerfull is rejecting the normal model with double-exponential and double-gamma data with extremely low p-value's.

Conclusion and perspectives

We proposed a general test for an arbitrary model. The methods are based on functional empirical processes theory that readily provided asymptotic laws from which statistical tests are derived. They depend on an integer k such that the pertaining df has 4k first finite moments. We got two kinds of tests. A general one based on functions [formula]and gi, i = 1,...,k, with an asymptotic normal law. We derived from these results chi - square tests that are valid for general df's and that includes the Jarque-Berra test of normality. Both tests used arbitrary moments. We only undergone simulation studies for the first kind of test. Our simulation studies showed high performance for normality against other symmetrical laws such as double-exponential or double-gamma ones. For suitable choices of fi, gi and k, the test performs well for small samples (n = 20) both for accepting the normal model and rejecting other models. We also showed that for suitable choice of fi and gi, the test for the double-exponential model is also successful, but for sizes greater that n = 150. In upcoming papers, we will focus on detailed results on specific models and try to found out, for each case, suitable value of the parameters of the tests ensuring good performances for small data. A paper is also to be devoted to simulation studies for the khi - square tests and their applications to financial data.