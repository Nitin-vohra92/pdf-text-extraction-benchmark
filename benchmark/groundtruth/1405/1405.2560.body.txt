Lemma Proposition Corollary

Definition Conjecture Example

Intervals of Permutations with a Fixed Number of Descents are Shellable

Introduction and Preliminaries

A permutation of length n is an ordering of the integers [formula], without repetitions. Given two permutations σ and π, we define an occurrence of σ as a pattern in π to be a subsequence of π with the same relative order of elements as in σ. For example, if σ = 213 and π = 23514 then there are two occurrences of σ in π, as the subsequences 214 and 314. The set of all permutations forms a poset P, with a partial ordering defined by σ  ≤  π if σ occurs as a pattern in π. An interval

[formula]

. The direct sum [formula] of two permutations σ and π is obtained by appending π to σ after adding the length of σ to each letter of π. For example, [formula]. A descent occurs at i in a permutation [formula] if πi  >  πi + 1. As an example, 23154 has descents at 2 and 4.

If σ  ≤  π, then [formula]. Therefore, if the permutations σ and π both have exactly k descents, then any permutation τ∈[σ,π] also has exactly k descents. We denote the induced subposet of all permutations with exactly k descents as Pk. The Möbius function for a poset is defined recursively as follows: μ(a,b) = 0 if [formula], μ(a,a) = 1 for all a and for a < b:

[formula]

One of the main goals of this paper is to study the Möbius function of Pk.

The interior of the interval

[formula]

, written Δ(σ,π), is the simplicial complex whose faces are the chains contained in the interior (σ,π). When we attribute a topological property to an interval we mean the corresponding property of its order complex. We refer the reader to [\cite=Wac07] for extensive background on the subject of order complexes.

A simplicial complex is pure if all its maximal faces, which are called facets, have the same dimension. The order complex of an interval of permutations is always pure. A pure simplicial complex Δ is shellable if its facets can be arranged in linear order [formula] in such a way that the subcomplex [formula] is pure and (dim Δ - 1)-dimensional for  2  ≤  k  ≤  t, where 〈F〉  =  {G:G  ⊆  F}, that is, 〈F〉 is the subcomplex generated by F. Again we refer the reader to [\cite=Wac07] for extensive background on the subject of shellability.

Let A be the poset of words on the alphabet of positive integers, with the partial order called subword order where v  ≤  w, with [formula], if there is a subsequence [formula] in w such that [formula]. For example, 2132  ≤  212312 but [formula]. In [\cite=Bjo90] a formula was given for computing the Möbius function on intervals of A in polynomial time, and it is shown that all intervals in A are shellable. In this paper we present an order isomorphism, that is, an order-preserving bijection, from each interval in the permutation posets Pk to a corresponding interval in A. This allows us to easily compute the Möbius function of intervals from the posets Pk and to show that they are shellable.

The reduced Betti number k(X) of a simplicial complex X is the rank of the k-th reduced homology group of X (for background on the homology of simplicial complexes we refer the reader to [\cite=Koz08]). The Philip Hall Theorem and the Euler-Poincaré formula, which appear as Proposition 1.2.6 and Theorem 1.2.8 in [\cite=Wac07], combined state:

[formula]

where (Δ(σ,π)) is the reduced Euler characteristic of the order complex of

[formula]

in P* that does not contain a nontrivial disconnected subinterval is shellable. This result was then used to show that intervals of layered permutations that do not contain a nontrivial disconnected subinterval are shellable. Furthermore, it was conjectured that the same applies to the more general class of separable permutations, that is, the permutations that avoid 2413 and 3142.

In Section [\ref=sec:bij] we present a bijection from P to a subposet of A. We show that when we restrict this bijection to Pk it is an order isomorphism. This allows us to draw on many useful results that have been proven for subword order, such as the shellability of intervals, and apply these results to permutations. In Section [\ref=sec:mob] we use this order isomorphism to present a formula for the Möbius function of intervals from the posets Pk. We use this formula to prove a conjecture made in [\cite=Smith13] and to present an alternative, simpler proof of [\cite=Smith13] on the Möbius function of intervals

[formula]

has no nontrivial disconnected subintervals and we conjecture that these intervals are shellable.

Bijection From Permutations to Words

In this section we present an order isomorphism from the poset Pk of permutations with exactly k descents to a subposet of A. Let max (w) be the value of the largest letter in the word w. We now define the poset of words we consider:

Let [formula] denote the poset of words with subword order on the alphabet of all positive integers, with the additional conditions that for any w∈  ~  :

Let [formula] denote the subposet of [formula] of words w where max (w) = k.

For example, 231423∈ but [formula] because the rightmost occurrence of 2 does not have a 3 to its left.

The additional conditions in Definition [\ref=addCon] are very similar to the definition of a restricted growth function, which can be used to encode set partitions, see [\cite=Mil77]. To see the similarity we use the definition of a restricted growth function that appears in Question 106 in [\cite=Sta96]. A restricted growth function is a sequence of the positive integers [formula] with each letter occurring at least once and the first occurrence of i appearing before the first occurrence of i + 1, for 1  ≤  i  ≤  k - 1. If we consider AC2 reworded as beginning at the right end of the word, and travelling left, then the first occurrence of i must appear before the last occurrence of i + 1. The key difference is that AC2 requires at least one occurrence of i + 1 after the first i whereas a restricted growth function requires that all occurrences of i + 1 are after the first i. As such, it is easy to see that [formula] is a larger class than the class of restricted growth functions.

We know that the number of permutations of length n in Pk is the Eulerian number A(n,k), see [\cite=Sta97]. We show that there is a length-preserving bijection from [formula] to Pk - 1, which implies the number of words of length n in [formula] is given by the Eulerian number A(n,k - 1).

When referring to both words and permutations we often use the notation αi to refer to the letter at location i in α, and |α| to denote the length of α. Given a letter c of the permutation π, let dπ(c) be the index of the run containing c, where a run is a maximal consecutive sequence of increasing letters. Therefore, dπ(c) equals the number of descents preceding c in π, plus 1. For example, d35241(5) = 1 and d35241(1) = 3. Given a letter j of the word w, let pw(j) be the set of positions of the letter j in w, in increasing order. For example, p21232(2) = {1,3,5}. Now define the following functions:

[formula]

[formula]

Now consider what these functions are doing. When applying f to π we first find the location of 1 in π and count the number of preceding descents, which gives the first letter, dπ(1), of f(π). We then repeat this for the letter 2 in π and continue up to n. To apply g to w we find the positions of each 1 in w and g(w) begins with these positions in increasing order. Then we find the positions of each 2 in w and we continue g(w) with these positions in increasing order. We continue this up to max (w). For example, if π  =  263415 then f(π) = 312231, and if w = 214321 then g(w) = 261543.

Before proceeding we define a term used for both permutations and words:

Consider two elements a  ≤  b of a poset of either words or permutations. An embedding of a in b is a sequence η of length |b| such that the nonzero positions in η are the positions of an occurrence of a in b and removal of all the zeros from η results in a.

The embeddings of the word 2121 in 211221 are 210201, 210021, 201201 and 201021. The embeddings of the permutation 213 in 142356 are 021030,  020130,  021003 and 020103.

We now show that f and g are inverses of each other. First we show that f and g link the number of descents of permutations in P and the largest letter of words in [formula].

Let f and g be defined as above.

If π∈Pk, then f(π)∈.

If w∈, then g(w)∈Pk.

For [\eqref=lem:im:1], consider π∈Pk and let w = f(π). It is clear that w is a word and that dπ(πn) = k + 1. Also there must be an occurrence of all the letters [formula] because for each i the letter at the location of the i-th descent maps to i. All that remains to be shown is that w satisfies AC2 in Definition [\ref=addCon]. Let wt = i be the rightmost occurrence of the letter i. This implies the letter t at position j in π is the rightmost letter that is preceded by exactly i descents, and hence a descent occurs directly after πj. Thus the letter πj + 1 is mapped to i + 1. Since πj + 1  <  πj, the letter πj + 1 is mapped to an earlier location in w than πj. Therefore, wt = i is preceded by an occurrence of i + 1. Since the argument holds for all i, this proves [\eqref=lem:im:1].

For [\eqref=lem:im:2], we need to show there are k descents in g(w). By AC2 in Definition [\ref=addCon], the largest letter in pw(t) must have a greater value than the smallest letter in pw(t + 1). Therefore, for each t there is a descent between pw(t) and pw(t + 1) in g(w). Since each pw(j) is increasing, these k are the only descents.

The map f is a bijection with inverse g.

We prove this by showing that [formula] and gf = idP.

First consider w∈ and v = f(g(w)). If wi = t then dg(w)(i) = t, since i∈pw(t) and thus in the t-th run of g(w). Since we know that wi = t = dg(w)(i) = vi for all i, we conclude w = v.

Now consider g(f(π)) such that π∈Pk, and let [formula] be the j-th run of π for some [formula]. Each [formula], where [formula], is mapped to the letter j in f(π), and these are the only letters mapped to j. In turn only those letters are mapped into pf(π)(j). Since each segment is listed in increasing order, and this holds for all j, we have g(f(π)) = π.

So f is a bijection from P to [formula]. Finally we need to see if this bijection is order-preserving. This is not true in general. For example, consider the permutations [formula]: Applying f yields [formula].

Consider the functions fk obtained by restricting f to Pk and gk obtained by restricting g to [formula]. We know by Lemma [\ref=lem:im] that the image of fk is [formula] and the image of gk + 1 is Pk. Combining this with Lemma [\ref=lem:bij] implies fk is a bijection. We now show that fk and gk are order-preserving:

The bijection fk is an order isomorphism.

Consider two permutations σ,π∈Pk with σ  ≤  π. Since σ and π have the same number of descents, thus the same number of runs, for any occurrence of σ in π the t-th run of σ must occur in the t-th run of π. If [formula] is an occurrence of σ in π, then [formula]. Let [formula] be the reordering of [formula] in increasing order, then [formula] occurs in fk(π) and is equal to fk(σ). Therefore, fk(σ)  ≤  fk(π).

Now consider two words v,w∈ with v  ≤  w. Let η be an embedding of v in w, and let [formula]. It is easy to see that pη(t)  ⊆   ~ pw(t), which implies (η)  ≤  gk(w). Also (η) is an occurrence of gk(v), so gk(v)  ≤   ~ gk(w).

Hence we have an order isomorphism between Pk and [formula]. One of our key results is the following corollary, which follows directly from [\cite=Bjo90] and Theorem [\ref=thm:op]:

Any interval

[formula]

Note that CL-shellability implies shellability, so a poset that is dual CL-shellable is shellable. For a good survey of the implications of different types of shellability we refer the reader to [\cite=Wac07].

We can also consider f as a map to the poset of words on generalised subword order, where the underlying poset is the chain of positive integers. In this case f is order-preserving, but g is not. For example, [formula] but [formula].

It is known that a shellable complex has the homotopy type of a wedge of spheres. Therefore, Corollary [\ref=cor:shell] gives the following result:

If σ and π are permutations with the same number of descents, then Δ(σ,π) is homotopy equivalent to a wedge of |μ(σ,π)| spheres of dimension dim Δ(σ,π) = |π| - |σ| - 1.

Computing the Möbius function

We can use Theorem [\ref=thm:op] along with [\cite=Bjo90], which also appears as [\cite=SagVat06], to compute the Möbius function of any interval in P between permutations with the same number of descents. To do this we first need to define what a normal embedding is in the case of permutations. The definition we use is induced by the definition of a normal embedding in [\cite=SagVat06] after applying the bijection from Theorem [\ref=thm:op]:

An adjacency in a permutation is a sequence of consecutively valued letters in increasing consecutive order. The tail of an adjacency is all but the first letter of the adjacency. An embedding η of σ in π is normal if ηi is nonzero for each letter πi in the tail of an adjacency. We use the notation from [\cite=Bjo90] and denote the number of normal embeddings of σ in π as [formula].

There is an analogous decreasing adjacency, but we are only interested in increasing adjacencies.

As in Example [\ref=ex:em] consider 213 and 142356. The adjacencies in 142356 are 23 and 56 so the tails of the adjacencies are 3 and 6. Hence the only normal embedding is 020103 and therefore [formula].

We use this definition to state the following result:

If σ and π are permutations with the same number of descents, then

[formula]

This follows directly from Theorem [\ref=thm:op] and [\cite=Bjo90].

In [\cite=Bjo90] it was shown that [formula] can be computed in polynomial time.

In Section [\ref=sub:mob] we use Proposition [\ref=prop:mob] to give a simpler proof of a result which appears in [\cite=Smith13] and prove a conjecture from the same paper. First we present two corollaries:

Consider σ,  π∈Pk. Let t be the total number of letters in all the tails of all the adjacencies in π. If t > |σ|, then μ(σ,π) = 0.

This result doesn't hold if we remove the restriction on the number of descents. For example, consider σ = 213 and π = 569341278, which have one and two descents, respectively. The total number of letters in all the tails of 569341278 is t = 4 and |σ| = 3, but [formula].

Corollary [\ref=cor:a] is another part of the answer to a question posed in [\cite=BJJS11] asking when is μ(σ,π) = 0. Whilst we cannot yet give a simple definitive answer to this question, there are results which present several classes of intervals with a zero Möbius function, such as results in [\cite=BJJS11], [\cite=Smith13] and [\cite=SteTen10].

A result in [\cite=BJJS11] showed that if σ and π are separable permutations, then |μ(σ,π)| is at most the number of occurrences of σ in π. Proposition [\ref=prop:mob] implies this is also the case if we fix the number of descents, since an embedding corresponds to a unique occurrence.

If σ and π have the same number of descents, then |μ(σ,π)| is at most the number of occurrences of σ in π.

Möbius Function of Permutations With at Most One Descent

Proposition [\ref=prop:mob] allows us to compute the Möbius function of an interval between two permutations with the same number of descents, but says nothing about intervals between permutations with different number of descents. Now we consider the intervals

[formula]

Intervals of

[formula]

We have shown that intervals between two permutations with the same number of descents are shellable. Now we consider intervals of the form

[formula]

such that π∈P1.

If π∈P1, then the order complex Δ(,π) is homotopy equivalent to a suspension of Δ(21,π). Therefore, the reduced Betti numbers of Δ(,π) are n(Δ(,π)) = n - 1(Δ(21,π)), for n > 0, and 0(Δ(,π)) = 0.

Let X = (,π) and [formula], where [formula] is the largest increasing permutation that occurs in π. The only permutations in A not in (21,π) are 21 and 12. The permutations 21 and 12 occur as a pattern in every permutation in (21,π). Therefore, in the order complex of A each of the points associated to 12 and 21 is the apex of a cone over Δ(21,π), so Δ(A) is a suspension of Δ(21,π).

We use the Quillen Lemma to show that Δ(X) is homotopically equivalent to Δ(A). Consider the map f: ~ X  →  A defined by:

[formula]

This map is order-preserving and f- 1(A≥  a) = X≥  a which is an upper ideal, thus Δ(f- 1(A≥  a)) is contractible. Therefore, by the Quillen Fiber Lemma, f induces a homotopy equivalence between Δ(X) and Δ(A). Thus, Δ(X) is homotopically equivalent to a suspension of Δ(21,π). The result on the reduced Betti numbers then follows directly from the property of the suspension that [formula].

It is not true that all intervals

[formula]

the subinterval

[formula]

is not shellable. Similarly in

[formula]

is disconnected and of rank 3. Consequently, if a permutation π∈P1 contains 456123 or 356124 the interval

[formula]

are all shellable, we conjecture that containing 456123 or 356124 are the only obstructions to shellability for the intervals

[formula]

is shellable.

We have been unable to prove this conjecture, but we show that these intervals have no nontrivial disconnected subintervals. We prove this below, but first we need a result from [\cite=McSt13] and the following definition:

Let η be an embedding of σ in π. The zero set of η, which we denote Zη, is the set {i:ηi = 0}. The zero set ZE of a set of embeddings E is the union of the zero sets of all the embeddings in the set E.

Let σ = 213 and π = 245136. Consider the following embeddings of σ in π: η1 = 200130, η2 = 200103 and η3 = 020103. These embeddings have zero sets Zη1  =  {2,3,6}, Zη2  =  {2,3,5} and Zη3  =  {1,3,5}. Therefore, the set {η1,η2,η3} has zero set {1,2,3,5,6}.

(see [\cite=McSt13]) Consider two permutations σ  <  π such that |π| - |σ|  ≥  3. The interval

[formula]

If π∈P1 and π avoids 456123 and 356124, then the interval

[formula]

, of rank 3 or more, with α∈P0 (so α is an increasing permutation) and β∈P1. We show there is no way to split the embeddings of α in β into two sets with disjoint zero sets. To do this we separate the embeddings into three disjoint sets:

Embeddings with all of α embedded before the descent in β constitute the set E1.

Embeddings with all of α embedded after the descent in β constitute the set E2.

Embeddings with part of α embedded before the descent in β, and part after, constitute the set E3.

Note that each embedding in E1 has zeros in all positions after the descent. Similarly, all embeddings in E2 have zeros in all positions before the descent. Therefore, it is not possible to split E1 or E2 into smaller sets that have disjoint zero sets. Moreover, E3 cannot be split into smaller sets with disjoint zero sets. To see this note that, it is always possible to swap a nonzero letter with a zero letter directly to the right if after the descent, or directly to the left if before the descent. We can use this to build a sequence of embeddings between any two embeddings in E3, where the elements in each adjacent pair in the sequence have only one letter differing in their zero sets. If the zero sets differ by only one element they cannot be disjoint. Since we can build such a sequence between any two embeddings in E3, it is not possible to split E3 into two sets with disjoint zero sets.

Suppose that all three sets are non-empty. Since both E1 and E2 are non-empty, it is not possible to make an embedding that uses all letters from one side of the descent and some letters from the other. This means that each embedding in E3 must have a zero on both sides of the descent. So all embeddings in E1 must be placed in the same set, all embeddings in E3 must be placed in the same set as the embeddings in E1 and all embeddings in E2 must be placed in the same set as the embeddings in E3. So we cannot split the embeddings into two sets with disjoint zero sets.

We now analyse three cases, depending on which of the three sets are empty.

First suppose E1 is empty and that E2 and E3 are non-empty. Consider the embeddings in E3. Unless an embedding embeds all its letters before the descent, and then some after, it has a zero before the descent, so must be put into the same set as E2. Furthermore, as E3 cannot be split into two sets with disjoint zero sets, the only way for E2 and E3 to have disjoint zero sets is if all the embeddings in E3 have no zeros before the descent. We show that the only way such an embedding can exist is if β  =  β1β2...βd...βi...βn with βi  >  βd and any letter strictly between βd and βi is less than βd. Also the number of letters not between βd and βi must be exactly |α|. Therefore, we can embed α as

[formula]

such that αd + 1 is embedded in position i. To see this is the only possible embedding suppose there is another embedding [formula]. Since there cannot be a zero before the descent there must be a zero after i. This implies it would also be possible to embed the sequence αd...αa after the descent, leaving a zero before the descent, contradicting our requirement for E3.

If η is a valid embedding, then βd - 2βd - 1βd must be of one of two forms, either c(c + 1)(c + 2) or c(c + 2)(c + 3). Otherwise we could build valid embeddings of the form

[formula]

which has a zero before the descent, contradicting our requirement for E3. We also know that there are [formula] letters smaller than βd that occur after βd. Therefore, the embedding η can only exist if there is an occurrence of either 456123 or 356124 in β. Since β avoids both these permutations η cannot be a valid embedding. So if E1 is empty the embeddings cannot be split into disjoint zero sets.

An analogous argument shows that if E2 is empty, then the embeddings cannot be split into disjoint zero sets.

Now suppose E3 is empty but E1 and E2 are not. As E3 is empty there can be no increasing sequence of length |α| spread across both sides of the descent. Using this we can repeat the same argument as above showing that βd - 2βd - 1βd must be of one of the forms c(c + 1)(c + 2) or c(c + 2)(c + 3). Therefore, if β avoids 456123 and 356124 this case cannot arise.

Therefore, if π∈P1 and π avoids 456123 and 356124, then for any   ≤  α  ≤  β  ≤  π the embeddings of α in β cannot be split into two sets with disjoint zero sets. Thus, by Lemma [\ref=prop53], the interval

[formula]

has no disconnected subintervals of rank 3 or more.

Acknowledgements

I would like to thank the authors of the GAP system [\cite=GAP4] and the authors of the GAP homology package which were very useful in analysing the order complexes studied in Section [\ref=sec:shell]. I would also like to thank Nik Rukuc for the suggestion to consider permutations with one descent as binary strings, Einar Steingrmsson for numerous helpful comments, Russ Woodroofe for pointing out an error in an earlier version of the paper and the referees whose comments greatly improved the readability of the paper.