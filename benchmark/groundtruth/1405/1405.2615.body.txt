Dimers and Dominoes

September 24, 1992 (revised November 4, 1997)

James Propp Massachusetts Institute of Technology and MSRI

1. Counting configurations on a rectangle.

Let us count the number of domino tilings of an m-by-n checkerboard, or equivalently, the number of matchings of an m-by-n square grid of dots, G, where by a matching of a graph we mean a collection of edges such that each vertex of the graph belongs to exactly one edge in the collection. (In physics, one regards each vertex as an atom, and each edge in a matching as representing a diatomic molecule, or dimer; hence a matching of a graph is also known as a dimer cover.) In order for the checkerboard to have a domino tiling, it is necessary that the number of cells, mn, be even; assume for definiteness that n is even.

Let N(m,n) denote the number of tilings. We know that N(m,n) must be at least (Fm)n / 2, where Fm denotes the mth Fibonacci number, because (as is easily shown by induction) there are Fm ways of tiling a 2-by-m rectangle with dominoes. That is, N(m,n) is asymptotically at least as large as [formula], where [formula] and [formula]. On the other hand, we can encode any tiling of the region with at most mn / 2 bits, one tile at a time, by iterating the following rule: Find the upper-left-most cell that does not belong to an already-encoded domino, and record 0 or 1 according to whether it shares a domino with the cell to its right or the cell below it. For the price of one bit we have encoded the position of a domino covering two cells, and so it takes only mn / 2 bits to encode the full tiling. Thus N(m,n) is asymptotically no larger than [formula].

We will find it more convenient to work with matchings of G than tilings of the checkerboard, but we want to retain the notion of an alternating coloring. We color the vertices of G black and white such that each black vertex has only white neighbors and vice versa.

Let A be the adjacency matrix of the graph G, whose rows and columns are indexed by the vertices of G and whose j,kth entry equals 1 if the jth vertex of G is adjacent to the kth vertex of G and equals 0 otherwise. Let B be the "bipartite adjacency matrix" of G, whose rows and columns are indexed by the black vertices and white vertices of G, respectively, and whose j,kth entry equals 1 if the jth black vertex of G is adjacent to the kth white vertex of G and equals 0 otherwise. If we order the vertices of G so that all the black vertices precede all the white vertices, then A has the block-structure

[formula]

(where the superscript "t" denotes the transpose). It is clear that the permanent of A is equal to the square of the permanent of B, and that the permanent of B is equal to the number of matchings of G.

Our approach is based on that of Kasteleyn (P.W. Kasteleyn, The statistics of dimers on a lattice, I: The number of dimer arrangements on a quadratic lattice, Physica 27 (1961), 1209-1225). Let Ã and [formula] be the matrices obtained from A and B, respectively, by replacing each entry + 1 that corresponds to a vertical bond in G by + i. I claim that det   =    ±  N(m,n), where N(m,n) is the number of matchings of the graph. To prove this, it suffices to show that all the contributions to the determinant equal ±  1, and that all have the same sign. If all bonds are horizontal, the contribution is clearly ±  1, since no i's are involved. We know (see, for instance, W. Thurston, Conway's tiling groups, Amer. Math. Month. 97 (1990), 757-773) that every matching can be obtained from the all-horizontal matching by means of elementary moves of the form

[formula]

In the original matrix B, this corresponds to a transposition

[formula]

(where the two rows are indexed a and b, the two columns are indexed c and d, and all intervening rows and columns are omitted), which yields a transversal of the matrix whose parity is opposite that of the original transversal. But in the matrix [formula], this change of parity is compensated for by the fact that in one of the two transversals, the associated entries are + i's instead of + 1's. Note that

[formula]

so det Ã  =    ±  ( det )2. To determine the sign, note that if we combine any transversal of [formula] with its own transpose, we get a transversal of Ã that is the product of an even number of transpositions. This transversal contributes + 1 to det Ã, so det Ã  >  0, and det Ã  =  N(m,n)2.

Here is another way of verifying that the terms in the determinant add coherently, i.e. with no cancellations. Label the white nodes of G from 1 to mn / 2, and do the same for the black nodes, so that every matching of G corresponds to a permutation of {1,...,mn / 2} and can be assigned a parity, which coincides with the parity of the associated transversal of the matrix B. Put + 1's on the horizontal edges of the graph G and + i's on the vertical edges, and call these the weights of the edges. Say more generally that the weight of a set of edges is the product of the weights of the edges belonging to the set. Every matching μ of G corresponds to a non-vanishing transversal of [formula], and its contribution to det  is equal to its parity σ(μ) times its weight w(μ), where w(μ) must equal ±  1 since every matching contains an even number of vertical edges. We need to show that for any two matchings μ1 and μ2 of G, σ(μ1)w(μ1)  =  σ(μ2)w(μ2), or equivalently, σ(μ1)  /  σ(μ2)  =  w(μ2)  /  w(μ1).

Let μ1  +  μ2 be the multigraph obtained by combining the edges of μ1 and the edges of μ2. Thus, every edge that is common to μ1 and μ2 yields a double edge (which we regard as a 2-cycle), while the rest of μ1  +  μ2 splits up into even-length cycles of length 4 or more. Suppose we get r cycles in this way; then μ2 can be obtained from μ1 in r stages, by rotating edges around cycles. represent their lengths by 2l1,2l2,...,2lr, where 2l1 + 2l2 + ... + 2lr = mn. The permutation of {1,...,mn / 2} associated with μ2 is equal to the permutation associated with μ1 times the product of an l1-cycle, an l2-cycle, ... , an lr-cycle. Thus the parity of μ2 equals the parity of μ1 times ( - 1)(l1 + 1) + (l2 + 1) + ... + (lr + 1). (Note: the length of the graph-theoretic cycle in G' is twice the length of the associated permutational cycle on {1,...,mn / 2}.) That is, a cycle in μ1  +  μ2 of length 2l contributes a factor of ( - 1)l + 1 to the relative parity of μ2 with respect to μ1.

What about the relative weight of μ2 with respect to μ1? Given an oriented closed path Γ in the square grid, define the disparity d(Γ) as the number of vertical edges in Γ that point from a black to a white vertex minus the number of vertical edges in Γ that point from a white to a black vertex. Then it can be seen that the contribution to the relative weight w(μ2)  /  w(μ1) made by a particular cycle in μ1  +  μ2 is equal to id(Γ), where Γ is an (arbitrary) orientation of that cycle. Since Γ is non-self-intersecting it is easy to show that d(Γ) is equal to the sum of d(Γc) as c runs over the square cells enclosed by Γ, where Γc is the closed path of length 4 that encircles the jth square cell enclosed by Γ and has the same orientation as Γ itself; for if one examines the sum, one sees that cancellation takes place on all edges interior to Γ that belong to two Γc's, leaving only edges on Γ itself uncancelled. But d(Γc) is ±  2, according to whether c is a black or white cell under a checkerboard coloring. Hence d(Γ) is equal to twice the difference between the number of black cells and the number of white cells enclosed by Γ, which is congruent, modulo 4, to twice the sum of the number of black cells and the number of white cells enclosed by Γ. Hence a cycle in μ1  +  μ2 enclosing area A contributes a factor of ( - 1)A to the relative weight of μ2 with respect to μ1.

To finish our analysis, recall Pick's theorem for polygons whose vertices belong to a square grid: [formula], where A denotes the area enclosed by a polygon, I denotes the number of interior grid-points, and B denotes the number of grid-points on the boundary. In the case of our cycle Γ, the number of interior vertices I must be even (since both μ1 and μ2 give matchings on this set of vertices), and [formula] is just l, the length of the cycle. Hence A is congruent to l - 1 modulo 2, so that the parity-factor ( - 1)l + 1 and the weight-factor ( - 1)A  =  ( - 1)l - 1 exactly cancel.

Thus we see that all the matchings contribute coherently to the determinant of B.

Example: m = 3, n = 2. Index the entries in a rectangle with 3 rows and 2 columns as shown:

[formula]

Then we get

[formula]

corresponding to the fact that the 3-by-2 rectangle can be tiled by dominoes in exactly 3 ways.

We will find a general formula for det Ã by determining the full spectrum of Ã. Here I use an approach suggested to me by Noam Elkies in private correspondence. Let V be the space of functions [formula] such that f(x, - y) = f( - x,y) =  - f(x,y) and f(x + 2(m + 1),y) = f(x,y + 2(n + 1)) = f(x,y) for all [formula]. Note that for such a function f, f(x,y) vanishes if either x is a multiple of m + 1 or y is a multiple of n + 1. Let L:V  →  V be the modified local summation operator (Lf)(x,y)  =  f(x - 1,y)  +  f(x + 1,y)  +  if(x,y - 1)  +  if(x,y + 1). It is easy to check that L does indeed send V to V. V is isomorphic to [formula] (restrict [formula] to {1,...,m}  ×  {1,...,n}), and the mn-by-mn matrix that intertwines the action of L under this automorphism is Ã. Hence det Ã is the product of the eigenvalues of L.

A basis for V is given by the functions

[formula]

(1  ≤  i  ≤  m, 1  ≤  j  ≤  n). It is easy to check that these are eigenfunctions of L, using the identity sin (α  -  β)  +   sin (α  +  β)  =  ( sin α)(2 cos β):

[formula]

So

[formula]

Since n is even, we can combine the k and n + 1 - k factors to get

[formula]

Since the j and m + 1 - j factors are equal, and since we want the positive square root of det Ã anyway, we get

[formula]

when m is even.

Thus, for instance, the number of domino tilings of an 8-by-8 checkerboard is 12988816  ≈  1.2982. (Note that 12988816 is exactly equal to 36042. In fact, N(n,n) is a perfect square when n is congruent to 0 mod 4 and twice a perfect square when n is congruent to 2 mod 4. This is a special case of a result of William Jockusch's; he showed that if G is a bipartite graph with a 4-fold rotational symmetry that swaps the two color classes, then the number of matchings of G is a square if the the number of vertices of G is a multiple of 8 and twice a square otherwise.)

Another way to calculate det Ã is to note that it is of the form [formula] where [formula] denotes the Kronecker product, Im is the m-by-m identity matrix, In is the n-by-n identity matrix, Cm is the m-by-m matrix

[formula]

and Cn is the n-by-n matrix of the same form. The eigenvalues of det Ã are therefore precisely the values μ  +  iν where μ,ν are eigenvalues of Cm and Cn, respectively. This yields the same answer as before.

Kasteleyn's approach is slightly different: instead of using a determinant, he uses a Pfaffian. However, since our graph is bipartite, it's not hard to show that the two methods are algebraically equivalent.

In general, for n even we have

[formula]

so that as n gets large

[formula]

which is one-half of the average value of log   (α  +  α- 1  +  iβ  +  iβ- 1) as α and β range independently over the unit circle with uniform density.

It can be shown that the double integral evaluates to G / π, where G is Catalan's constant 1 / 1  -  1 / 9  +  1 / 25  -  1 / 49  +  .... Thus, the number of domino tilings of the n-by-n board (with n even) is roughly 1.34n2.

2. Counting configurations on a torus.

Let us now count the number of domino tilings of an m-by-n torus, or equivalently, the number of matchings of an m-by-n toroidal grid of dots, G'. G' can be obtained from G by adding m extra horizontal edges and n extra vertical edges; we call these edges of G' special. For simplicity, we will require that both m and n be even.

It turns out, for reasons that involve the non-planarity of the graph G', that there is no way of replacing the entries of the adjacency matrix by roots of unity to obtain a new matrix whose determinant equals the permanent of the original adjacency matrix. However, we will see that the number of matchings of G', which we denote by N'(m,n), can be written as a linear combination of four determinants.

Let A' and B' be the adjacency matrix and bipartite adjacency matrix of G', respectively, so that

[formula]

Let [formula] and [formula] be the matrices obtained from A and B, respectively, by replacing each entry + 1 that corresponds to a vertical bond in G' by + i. Then (as we will see below) the determinant of [formula] is actually zero. Moreover, there is no alternative way of choosing the signs that ensures that all the terms contribute coherently.

The problem is that we can still take cycles in μ1  +  μ2, where μ1, μ2 now denote two matchings of G', and we can still evaluate the relative parity as ( - 1)l + 1 where 2l is the length of the cycle, but we can no longer evaluate the relative weight as ( - 1)A, since the cycle map not be contractible and hence does not enclose any area. (Contractible loops pose no problem, even though they lack a well-defined "inside", since the two regions into which a contractible cycle divides the torus must have areas of equal parity.) There is probably some parity-version of Pick's theorem that applies in this setting, at least when the edges as well as the vertices of the polygon are required to belong to the grid, but I haven't yet formulated, let alone proved, such a result.

Kasteleyn says "it can be shown that" the determinant of [formula] counts correctly only those matchings that contain an even number of horizontal special edges and an even number of vertical special edges -- that all other matchings contribute with the wrong sign. This is in fact the case, and in private communication Glenn Tesler, William Jockusch, and Greg Kuperberg have sent me arguments that substantiate Kasteleyn's claim; however, I have never seen these details anywhere in print. Kasteleyn himself seems to have sidestepped the problem by switching to a different approach, in between writing of his journal article and his later article Graph Theory and Crystal Physics; in the latter, he uses orientations of graphs instead of weightings of graphs.

Taking Kasteleyn's claim as true, we can proceed to find N'(m,n). Let us focus for simplicity on the case in which m and n are both divisible by 4. Let 0  =  . Let 1 be obtained from [formula] by changing the signs of all the + i's associated with the special vertical edges of G'. Let 2 be obtained from [formula] by changing the signs of all the + 1's associated with the special horizontal edges of G'. Let 3 be obtained from [formula] by making both sorts of sign-changes. Then it is easy to check that the following table applies:

[formula]

For instance, if a matching involves an odd number of special horizontal edges and an even number of special vertical edges -- that is, if the matching is of type "(odd,even)," or "(o,e)" for short -- then it contributes - 1 to det 0, - 1 to det 1, + 1 to det 2, and + 1 to det 3. It is evident from the table that the linear combination [formula] counts each matching with weight + 1, and so is equal to N'(m,n).

Introducing modified adjacency matrices Ãk (k = 0,1,2,3) that correspond to the modified k's in the obvious way, we are able to write

[formula]

To evaluate these determinants, introduce the matrices D+m, D-m, D+n, and D-n, where D+m is the m-by-m circulant matrix

[formula]

D-m is the m-by-m not-quite-circulant matrix

[formula]

and D+n and D-n are similarly defined n-by-n matrices. We can write [formula], [formula], [formula], and [formula], so we can find the eigenvalues of all four matrices provided we can find the eigenvalues of the D+ and D- matrices. This is easily done: the circulant matrix D+m has eigenfunctions x  ↦  e2jπix / m with eigenvalues [formula] (1  ≤  j  ≤  m), while the near-circulant matrix D-m has eigenfunctions x  ↦  e(2j - 1)πix / m with eigenvalues [formula] (1  ≤  j  ≤  m). Using these values, it can be checked that det A0 actually vanishes, so we need not worry about potential difficulties arising from the fact that our linear combinination of determinants has both plus and minus signs, allowing for massive cancellations that might swamp the final answer. (It might be interesting to have a combinatorial explanation for the vanishing of det B0, via some sort of pairing of terms.)

When all the work is done, is turns out that N'(m,n) grows at asymptotically the same rate as N(m,n).

What we really are after is the entropy of the dimer model. This is defined as

[formula]

where N*(m,n) is the number of different possible m-by-n excerpts of dimer configurations on the entire plane. Equivalently, we may imagine laying down dominoes on a checkerboard such that dominoes are now allowed to straddle the boundary of the board. We call such an arrangement an "overtiling" of the board. It is not hard to show that every overtiling of a rectangle extends to a tiling of the plane, so N*(m,n) is simply the number of overtilings of an m-by-n rectangle. We have N*(m,n)  ≥  N'(m,n)  ≥  N(m,n), since the "straight" boundary of the rectangle is a special case of doubly periodic boundary conditions, and doubly periodic boundary conditions in turn form a special case of arbitrary boundary conditions.

Let us digress briefly to consider why the limit

[formula]

exists. This is a fairly straightforward generalization of the one-dimensional argument, but it's worthwhile checking that the same analysis goes through. (Thanks to Boris Solomyak for helping me work this out.)

We need to note that the function N*(  ·  ,  ·  ) is monotone in each of its arguments; that is, for all m'  ≥  m and n'  ≥  n, N*(m',n) and N*(m,n') are both ≥  N(m,n). We also need to note that N*(m,n) is submultiplicative in each of its arguments; that is, if m = m1 + m2 and n = n1 + n2 then N*(m,n)  ≤  N*(m1,n)N*(m2,n) and N*(m,n)  ≤  N*(m,n1)N*(m,n2). Equivalently, log N*(m,n) is subadditive in each argument, so that for instance log N*(jm,kn)  ≤  jk log N*(m,n).

Now let

[formula]

Observe that [formula] for all m,n; for if it happened that [formula] then we would necessarily have [formula] for arbitrarily large values of m' and n' (namely, those that are multiples of m and n, respectively), contradicting our definition of α.

Fix ε  >  0, and take m0,n0 such that [formula]. Take m, n suitably large (just how large they need to be will be determined shortly) and write m = jm0 + r and n = kn0 + s with 0  ≤  r  <  m0, 0  ≤  s  <  n0. Since N*(  ·  ,  ·  ) is monotone, log N*(m,n) is less than or equal to log N*((j + 1)m0,(k + 1)n0), which by subadditivity is at most (j + 1)(k + 1) log N*(m0,n0). Hence

[formula]

By taking m,n large, we force j,k to be large, which forces the preceding expression to be less than α  +  2ε, say. Since ε was arbitrary, we have shown the existence of the limit.

We now face the truly interesting question: What is α? Our earlier work tells us that α  ≥  G / π, but it does not give us an upper bound. We may write [formula], where C stands for some boundary-configuration (specifically, the locations of those dominoes that straddle the boundary of the rectangle) and N*C(m,n) is the number of ways of tiling the rectangle subject to the boundary condition C. We know that N*(m,n) grows quadratic-exponentially, namely as exp αmn, while the number B of boundary-conditions C grows only linear-exponentially (in fact, it is bounded above by 24n). Hence the average value of N*C(m,n), as C ranges uniformly over all boundary conditions, also grows like exp αmn, and in particular, there must exists a two-parameter family of boundary conditions C(m,n) such that and N*C(m,n)(m,n) grows like exp αmn.

Unfortunately, we do not know what the suitable conditions C(m,n) to choose. Fortunately, we do not need to, on account of a lovely trick discovered by Greg Kuperberg. Picture the m-by-n rectangle   ×  [1,n] in [formula], with the (unknown) boundary condition C(m,n). By reflecting C(m,n) in the lines x = m and y = n, we get doubly-periodic boundary conditions on   ×  [1,2n], which must be compatible with exactly (N*C(m,n)(m,n))4 overtilings of the 2m-by-2n rectangle. Hence N*(2m,2n)  ≥  (N*C(m,n)(m,n))4, Hence [formula]. Sending m,n to infinity, we get α  ≤  G / π. Combining this with the reverse inequality, we find that α  =  G / π.