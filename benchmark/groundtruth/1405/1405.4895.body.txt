=1

Bayesian inference of Gaussian mixture models with noninformative priors

Introduction

Gaussian mixture models (GMMs) are very flexible models with a range of applications, including clustering and approximation of multimodal densities. Bayesian methods are useful for fitting these models to data, because they enable the uncertainty in the model parameters to be directly quantified - by simply examining the posterior distribution or by computing credible intervals. However, it is difficult to make an objective choice of prior for the parameters of the Gaussian components (i.e. their means and variances, in one dimension), when no information is available on which a subjective prior could be based. The typical objective approach would be to use a noninformative prior, i.e. a prior selected according to a formal rule [\citep=kass_selection_1996]. For GMMs, this approach is usually not possible. Standard noninformative priors such as the Jeffreys prior [\citep=jeffreys_theory_1961] [\citep=kass_selection_1996] generally cannot be used for mixture models, because they tend to be improper, and placing independent improper priors on the parameters of each mixture component will cause the posterior to be improper as well [\citep=roeder_practical_1997] [\citep=stephens_bayesian_1997] [\citep=marin_bayesian_2005]. Given this difficulty, one popular approach for GMMs has been to use proper priors, with their parameters chosen so that they are "weakly informative" [\citep=richardson_bayesian_1997]. Heuristically, this can be defined as follows: the prior densities should be relatively flat in the range of values that the parameters could be expected to take, given the range of the data [\citep=raftery_hypothesis_1996]. Such priors are also referred to as "locally uniform" [\citep=box_bayesian_1973] or as "diffuse" [\citep=kass_selection_1996]. For example, weakly informative priors were used in [\citep=ferguson_bayesian_1983] [\citep=raftery_hypothesis_1996] [\citep=richardson_bayesian_1997] [\citep=stephens_bayesian_2000]. In some cases, weakly informative priors can be justified as an objective approach by the fact that as they are made increasingly weak, the posterior density converges to the density that is obtained with some noninformative improper prior. For example, in hierarchical models, this is the case for uniform(0,L) prior densities on the standard deviations of group level effects: as L  →    ∞  , under some conditions, one obtains the same posterior as if an improper uniform(0,  ∞  ) prior had been used [\citep=gelman_prior_2006]. However, this convergence cannot occur for mixture models, as the posterior is improper if the priors are improper. In other settings where there is no proper limiting posterior, weakly informative priors are prone to issues such as sensitivity of the posterior to prior parameters, and can give nonsensical posteriors [\citep=kass_selection_1996] [\citep=berger_bayesian_2000]. Therefore, we might expect weakly informative priors to lead to practical problems in GMMs as well. In this paper, we show that this is indeed the case, and propose a straightforward modification of the mixture model which solves this problem. The paper is organized as follows: in section [\ref=section_standard], after introducing the standard approach for Bayesian inference with a GMM, we show that for a simple example data set, weakly informative priors are prone to a severe prior domination effect. Because of this, there is no generally valid way to choose the prior parameters when attempting to use weakly informative priors. In section [\ref=section_min], we show that a slight modification of the standard GMM allows noninformative priors to be used. This avoids the problem of parameter choice. In section [\ref=Section_imp], we provide MCMC implementations of our model and compare it with the standard model on real and simulated data.

Related work

Various approaches have been proposed for placing priors on the component parameters of a GMM. These can be roughly divided into three strategies. The first approach is to use proper priors, with the prior parameters chosen such that the prior is suitably weakly informative. One disadvantage of this approach is the fact that multiple prior parameters usually need to be specified. For example, the model of [\cite=richardson_bayesian_1997] has 4 parameters related to scale or shape, for which no default values are available. [\citet=richardson_bayesian_1997] propose heuristic values for these based on the range of the data values. In this paper, we demonstrate a further, serious problem with weakly informative priors (see section [\ref=section_weakinf]). An alternative is to use "partially proper" priors which are noninformative in some specific way, similar to the improper priors which would be available in a non-mixture setting [\citep=mengersen_testing_1996] [\citep=roeder_practical_1997]. These priors have been shown to give proper posteriors. However, they still require some rather crucial information to be specified. For example, [\citet=mengersen_testing_1996] developed a prior in which the means of the mixture components are specified in terms of their differences from each other. The prior on the overall location of the mixture density can then be improper. However, a proper prior has to be used for the differences of the component means. This is an important feature of the model, and the fact that one must base it on subjective input is problematic. The prior proposed by [\cite=roeder_practical_1997] follows a similar approach. Finally, one can use an improper prior, and employ a modified sampling algorithm that makes the posterior proper, by forcing each component to always have a minimal number of data points assigned to it [\citep=diebolt_estimation_1994]. This has been shown to be equivalent to multiplying the original priors with a data-dependent factor [\citep=wasserman_asymptotic_2000]. The advantage of this approach is that there are no subjective choices to make. The disadvantage is that the prior becomes data-dependent, which is formally incorrect in a Bayesian framework. [\cite=wasserman_asymptotic_2000] motivated the data-dependent prior primarily by showing that it leads to intervals with second-order correct frequentist coverage. Our approach is related to the work of [\cite=diebolt_estimation_1994] and [\cite=wasserman_asymptotic_2000], in that our method enables improper priors to be used by ensuring that each component is assigned a minimum number of data points. However, our modification does not result in any data-dependence of the priors. Instead, our approach is to recast inference in terms of a slightly modified model.

Bayesian inference for GMMs

In this section, we introduce the GMM as it is typically used in Bayesian inference. For simplicity, we focus on the 1-dimensional case (the generalization to more than one dimension is straightforward). Thus, suppose we have a sample [formula] of N data points, each in [formula]. We assume throughout this paper that these data points are i.i.d. samples from some (unknown) distribution that is dominated by Lebesgue measure on [formula]. We want to model their density with a mixture of K univariate Gaussian densities, where K is specified in advance, and fixed. According to this model, the [formula] are i.i.d., each following the mixture density given by:

[formula]

where fN(  ·    ;μ,σ2) denotes the univariate Gaussian density function with mean μ and variance σ2. The parameters of the component densities thus consist of [formula] and [formula]. The mixture weights [formula] must satisfy:

[formula]

Inference for this model is greatly simplified by putting it in a generative representation, with the aid of latent variables that indicate which component generated which data point. Let [formula] be the set of all possible assignments of the N data points to K components. Note that we can rewrite the likelihood from model [\eqref=mixture_1D] as:

[formula]

where [formula] and [formula]. This means that [\eqref=mixture_1D] is equivalent to a two-stage generative model where, to generate a value of xj, we first draw a value of a latent variable Gj distributed on [formula] with probabilities [formula], and then draw a value of xj from fN(  ·    ;μGj,σ2Gj). For the purposes of inference, we now assume that [formula] was generated by such a model, and take [formula] to be the vector of latent variables associated with [formula]. In a Bayesian framework, [formula], [formula], [formula], [formula] and [formula] are all treated as random variables. The prior distribution of [formula] is generally taken to be the Dirichlet distribution of order K with parameters [formula] [\citep=diebolt_estimation_1994] [\citep=wasserman_asymptotic_2000]. Often, [formula] is chosen, which gives a prior on [formula] that is uniform over the probability simplex. This choice will be made throughout this paper. We refer to the model given by [\eqref=mixture_1D] with a Dirichlet prior on [formula] as the standard GMM, reflecting the fact that many models found in the literature include this basic structure (as long as [formula] is random, and not fixed a priori).

Weakly informative priors

Different options are available for the prior distribution [formula]. The usual choice is to assume prior independence between the component densities, and then to place a proper prior π(μi,σ2i) on each pair [formula]. When proper priors are used, their parameters are often chosen such that the priors are weakly informative, i.e. with relatively flat densities over the range of relevant values. However, in practice, weakly informative priors can strongly constrain the posterior such that the result of the inference becomes very poor. As an example, consider a model with a conjugate normal-inverse gamma prior:

[formula]

Here the Gaussian part of the density has a zero mean for simplicity; it is of course also possible for it to be non-zero. We assume that the data are approximately centered, so that the zero mean makes sense. Conventionally, this prior can be made weakly informative by setting the parameters α, β and κ to take similar, low values (e.g. they could all be set to 0.01). The idea is that the inverse-gamma part approximates the Jeffreys prior for σ2i [\citep=lunn_bugs_2012] (which means it is relatively flat on the log scale), and the conditional Gaussian part is approximately flat because of the small value of κ. Obviously this is a heuristic approach, and the precise values will depend on the scale of the data. To demonstrate a problem inherent to such priors, we use a synthetic dataset, consisting of 100 datapoints sampled from the following two-component GMM:

[formula]

The two component densities overlap strongly. Figure [\ref=synth_data] shows a histogram of the data, with the mixture density superimposed. Figure [\ref=synth_data_nivg] shows histograms of approximate samples from the posterior distributions of μ1 and μ2, given these data, as the values of α, β and κ are decreased. These were computed by Gibbs sampling, using a standard scheme which alternated between sampling new values for [formula] conditional on [formula], and new values for [formula] conditional on [formula]. This particular form of Gibbs sampling is also referred to as data augmentation [\citep=tanner_calculation_1987] [\citep=diebolt_estimation_1994]. Posterior densities for the component parameters of mixture densities generally can have multiple modes [\citep=celeux_computational_2000] [\citep=marin_bayesian_2005]. This is also evident in figure [\ref=synth_data_nivg] - the histograms of μ1 and μ2 in the top row are markedly bimodal. These modes arise because the posterior is invariant under permutations of the component indices. As a result, the samples of μ1 effectively contain contributions from both mixture components, and similarly for μ2, a phenomenon referred to as label-switching. For further inference, a variety of methods would be available to separate the samples from the two "true" components [\citep=stephens_dealing_2000] [\citep=hurn_estimating_2003] [\citep=jasra_markov_2005] [\citep=grun_dealing_2009] [\citep=yao_bayesian_2009]. For our purposes, the posteriors are sufficient as they are. Convergence of the sampler was assessed by the fact that the histograms for μ1 and μ2 are very similar - this indicates that the sampler was able to move well between the different symmetric modes of the posterior [\citep=celeux_computational_2000] [\citep=lee_bayesian_2008]. When α, β and κ are all equal to 0.1, the posterior distributions of μ1 and μ2 each have two modes, which reflect the fact that the data can be more or less well separated into a group with a mean of approximately - 1.25, and a group with a mean of 1.25. As the prior parameters are decreased, a central mode appears, and eventually dominates the posterior. This mode is produced by assignments of the data points to components such that one component takes all points or a large majority, and thus has a posterior mean of approximately zero. We can see this by plotting the proportion of samples of [formula] in which one of the components is assigned no points - this proportion increases steadily as the prior parameters α, β and κ decrease (figure [\ref=synth_data_nivg_zeros]). Therefore, varying the prior so it is supposedly less informative actually constrains the posterior so that the central mode plays a larger and larger role. This is a prior domination effect [\citep=kass_selection_1996], because the prior parameters, not the data, control the contribution of the central mode to the posterior. This effect can be explained using the explicit solution for the posterior probability of the latent variables [formula]. From Bayes' formula, it is given by:

[formula]

In this specific case, π(μi,σ2i) is the normal-inverse gamma prior, and [formula] is the prior on [formula] given the Dirichlet prior [formula], which can be obtained by integrating out [formula], and is given by:

[formula]

where [formula] is the number of points assigned to the i-th component, i.e.

[formula]

We use the following short notation for the integrals:

[formula]

so that

[formula]

A closed-form expression for [formula] can be obtained by straightforward integration:

[formula]

Note that this is simply equal to 1 for ni = 0. Now assume for simplicity that we use a parametrization in which the prior parameters are related by fixed linear functions. We then can show that as the prior becomes less informative, the posterior density [formula] will become concentrated on those [formula] which assign all the data points to one component:

Lemma 1

Assume that N  >  K, and that α  =  c1κ and β  =  c2κ, with fixed constants c1  >  0 and c2  >  0. Let [formula] be vectors of latent variables. If [formula] assigns all data points to a single component, i.e. [formula], and [formula] does not do this, then P - a.s.:

The proof is given in the appendix [\eqref=lemma_1]. Here, the P - a.s. refers to the (unknown) law on [formula]. Similarly, one can show that for the precise situation we had in the later part of the simulations, namely α held fixed and β  =  c2κ while κ  →  0, then if [formula] assigns all data points to a single component and [formula] gives at least two components each more than one data point, [formula] also holds. In the case of our example analysis with a mixture of 2 components, this means that as the prior is made less and less informative, eventually most samples from the posterior of μ1 and μ2 will be conditional on instances of [formula] such that one component has all or all but one of the data points assigned to it. The posterior density of μ for this "greedy" component will be centered at the overall mean of the data, approximately 0. This explains the increase in the mode centered at 0 which can be seen in figure [\ref=synth_data_nivg]. Figure [\ref=synth_data_nivg_zeros] shows the proportion of sampled [formula] which assign one component no data points at all - this proportion increases as the prior becomes less informative.

We chose the model with a conjugate normal-inverse gamma prior as an example because it is possible to find an explicit solution for the posterior [formula]. The prior domination effect can also be observed in a model proposed by [\citet=richardson_bayesian_1997]. This model is slightly more complicated, as it introduces an additional hierarchical level via the variable β:

[formula]

The original formulation of the model allows for a non-zero mean of π(μi); as before, we take it to be zero. We implemented the GMM with these priors using Gibbs sampling. For the parameters, we used α  =  2, g  =  0.2 as proposed in [\cite=richardson_bayesian_1997]. We also kept h  =  10κ at all times, to match their settings. We then decreased h and κ, following the approach in [\cite=richardson_bayesian_1997] that these parameters should be small for the prior to be weakly informative. The result (figures [\ref=synth_data_rg], [\ref=synth_data_rg_zeros]) is similar as before. The central mode does not become quite as pronounced, which seems to be because the additional hierarchical level in this prior makes it more robust to parameter variation [\citep=robert_bayesian_2007]. However, the mode still changes strongly in size as the prior parameters are varied.

For the model with these priors, proving the equivalent of lemma 1 is more difficult. We can make the general (informal) argument that for weakly informative priors, the integral [formula] will tend to be small for [formula], because the prior π will be small for any pair (μi,σ2i) for which the likelihood is reasonably large. A similar argument was made by [\citet=jennison_discussion_1997] in the context of mixture models with a random number of components. Therefore, we expect that as the prior is made increasingly weak, [formula] will become concentrated on [formula] that allocate no data points to at least one component. We thus expect to see effects like those in figures [\ref=synth_data_nivg] and [\ref=synth_data_rg] for all weakly informative priors. This means that there is no well-founded, general method to choose the parameters of a given prior so as to make it weakly informative for a GMM. We cannot simply choose the parameters such that the prior density is extremely diffuse, because this may affect the posterior for [formula] to such an extent that the posterior for the component parameters is noticeably affected. Crucially, we cannot assume that the presence of a central mode as in figures [\ref=synth_data_nivg] and [\ref=synth_data_rg] must always be an artefact due to the prior. So we would have to somehow choose the parameters to be at some middle ground between having the priors be sufficiently diffuse and avoiding the prior domination effect on [formula], but it is not clear how this could be objectively achieved, in general. Note that the example dataset is not particularly special; its only important aspect is that its two modes are fairly close together, which is a feature we could expect many real datasets to have.

The GMM with noninformative priors

Since weakly informative priors are problematic in practice, we developed an approach that enables noninformative improper priors to be used. The main motivation for this is that noninformative priors do not require parameters to be specified, so they avoid the problems seen in the previous section. It is helpful to first write the posterior [formula] as:

[formula]

Suppose that [formula] is a product of independent Jeffreys priors on the pairs (μi,σi) and a Dirichlet prior [formula]:

[formula]

[formula]

Then we obtain: This posterior is improper, as the terms [formula] are not integrable over [formula] when [formula]. However, if [formula], then these terms are P - a.s. integrable, where P is the (unknown) law of [formula] (see appendix, [\ref=int_1D]). Therefore, if we exclude from the posterior all [formula] with [formula] for any [formula], we can use the improper Jeffreys prior and still have a P - a.s. proper posterior. This modified posterior is given by:

[formula]

where [formula] contains all "good" [formula]: The motivation for this posterior is that it is minimally modified compared to the original [\eqref=post_G_expansion] - only some [formula] are dropped to ensure propriety. This modification was first introduced by [\cite=diebolt_estimation_1994], who applied it but subsequently inferred the model parameters as if the posterior had not been modified. [\cite=wasserman_asymptotic_2000] treated it more formally, introducing a data-dependent modification of the prior [formula] which leads to the modified posterior. To present this prior, we first define the likelihood with a fixed [formula] by: Then the [\cite=wasserman_asymptotic_2000] modified version of [formula] is:

[formula]

(compare with equation 17 in [\citep=wasserman_asymptotic_2000]). If we use the representation [\eqref=post_G_expansion], we can readily see that this indeed gives the modified posterior [\eqref=good_posterior]. However, the prior [\eqref=prior_wasserman] is formally incorrect in a Bayesian framework, as the likelihood terms depend on the data [formula]. To avoid this data-dependence, we can reparametrize the model. First of all, note that the marginal posterior [formula] from [\eqref=good_posterior] is given by:

[formula]

where we use [\eqref=standard_z_prior]. We reparametrize the mixture model to obtain this marginal posterior by placing the following prior directly on [formula]:

[formula]

Then the full posterior is given by:

[formula]

By using the prior [\eqref=new_G_prior], we leave out the hyperparameter [formula] entirely. Therefore, the resulting model is no longer equivalent to the original mixture model [\eqref=mixture_1D]. However, we can show that at least marginally (for a single data point x), this model closely resembles [\eqref=mixture_1D]. First, we define [formula]. We condition on [formula], on [formula], and on [formula]. We assume that N data points are generated but consider only one of these, [formula], marginalizing the others out to obtain:

[formula]

with the ni fixed, and satisfying:

[formula]

In this marginal density, instead of [formula] we have the parameter [formula]. [formula] gives the proportions with which the different components contribute to the data, whereas [formula] gave the probabilities that a given data point is generated by each component. In addition, the new model directly requires each component to have at least 2 associated data points. This simply means that we require each component in the model to have actually made a meaningful contribution to the observed data. This seems to be a sensible prior assumption. In a sense, it makes the mixture fitting problem less ill-posed [\citep=marin_bayesian_2005]: in the original mixture model, we could always fit models with an arbitrarily large number of components, and correspondingly low component probabilities pi. In this new model, the [formula] are not independent of each other when we condition on [formula], [formula] and [formula] and marginalize out [formula]. By contrast, in the standard model the xj are independent when we condition on [formula], [formula] and [formula]. The reason for this dependence is that the distribution [\eqref=new_G_prior] imposes dependence between the Gj (when we condition on [formula]). As before, the prior on [formula] is parameterized by [formula]. If we make the choice [formula], then [formula] is uniform in terms of the numbers of points assigned to the different components, when we consider only assignments with at least 2 points per component. That is, all [formula] with every component ≥  2 have the same prior probability. This resembles the behavior of the standard prior [\eqref=standard_z_prior] when [formula].

Implementations

We developed Markov Chain Monte Carlo methods for sampling from the posterior of the GMM with the priors [formula] [\eqref=new_G_prior] and [formula] [\eqref=Jeffreys_prior]. For better comparison with the computational results in section [\ref=section_weakinf], we at first continued to use a Gibbs sampling-based method. Note that use of the prior [formula] does not mean that we have to perform Gibbs sampling on a higher-dimensional space, as Gibbs sampling techniques for the standard model [\eqref=mixture_1D] also require [formula] to be explicitly sampled. Nevertheless, optimizing the efficiency of the Gibbs sampler still seemed worthwhile. To do so, we implemented a scheme which only samples from [formula], by Gibbs sampling from the posterior [formula] with [formula] and [formula] integrated out. This is an example of collapsed Gibbs sampling, which in theory should converge faster than basic Gibbs sampling [\citep=liu_collapsed_1994]. [formula] is given by [\eqref=z_post], with the prior [formula] [\eqref=standard_z_prior] replaced by [formula] [\eqref=new_G_prior], and [formula] in accordance with the Jeffreys prior (σi, not σ2i, is now the integration variable). The integrals over μi and σi which appear in the expression for [formula] are given by:

[formula]

where [formula] (see appendix, [\ref=int_1D]). The collapsed Gibbs sampling algorithm then is as follows: to generate S samples [formula], from a Markov chain whose distribution converges to [formula], we run:

[formula]

The density [formula] is obtained readily as it is proportional to [formula]. We can discard a burn-in period, then take e.g. every 10th sample to obtain an approximate sample from [formula]. For each [formula] within this sample, we can obtain a sample for each pair [formula] from their joint posterior conditioned on [formula] and [formula] (this density is simply normal-inverse gamma). The final result is an approximate sample from [formula]. Note that we obtain these samples retrospectively, they are not part of the actual Markov chain. We can of course easily obtain samples from the component proportions ni / N, given the set of samples of [formula]. This scheme can also be used with a normal-inverse gamma prior on each pair [formula]. In this case, the integrals in [\eqref=z_post] are given by [formula] as in [\eqref=fi_expression]. Besides the modified prior [formula] [\eqref=new_G_prior], we can also use the original prior [formula] [\eqref=standard_z_prior]. In the latter case, for each sample [formula], we can obtain a sample of [formula] from its distribution conditioned on [formula] (which is Dirichlet). Because the μi and σ2i must be integrated out, there are some limitations on the priors that can be used for these parameters (the integral [formula] must be available in closed form). In particular, the [\citet=richardson_bayesian_1997] hierarchical model cannot be implemented. We found that although the Gibbs sampling-based method performed adequately for some example datasets, on others it failed to converge in a reasonable number of iterations, as demonstrated by the fact that the approximation of the posterior of some μi did not show the expected symmetric modes. This is a well-known issue with Gibbs sampling for mixture models [\citep=jasra_markov_2005] [\citep=marin_bayesian_2005]. An alternative is to use the Metropolis-Hastings algorithm, either in a standard form [\citep=marin_bayesian_2005] or in a tempering MCMC scheme [\citep=jasra_markov_2005]. This tends to explore the posterior density better, as demonstrated by the fact that switching between posterior modes occurs more frequently. Therefore, we implemented a simple Metropolis-Hastings-based scheme for our model. This method had faster convergence on test data, and is probably more suitable for most practical applications. Details of the implementation are in the appendix [\eqref=MH_imp]. MATLAB and R code for both collapsed Gibbs and Metropolis-Hastings sampling is provided at https://sourceforge.net/projects/bayesiangmm/.

Comparison of the models

We used a collapsed Gibbs sampling scheme to implement the GMM with the priors [formula] [\eqref=new_G_prior] and [formula] [\eqref=Jeffreys_prior]. For a comparison, we used the same method to implement the standard GMM [\eqref=mixture_1D] with a Dirichlet prior on [formula] and normal-inverse gamma priors on the pairs (μi,σ2i), [formula]. We first tested these models on the galaxy dataset, which is a widely used dataset originally analyzed by [\cite=roeder_density_1990]. The dataset consists of 82 points (the velocities of different galaxies), a histogram of which is shown in figure [\ref=galaxy]. We fit the data with a mixture of 4 Gaussians, using both models. Note that 4 was chosen mainly as an example, we do not assume that it is the most appropriate number. The resulting posterior densities are very similar (figures [\ref=galaxy_analysis_nivg], [\ref=galaxy_analysis_improper]). Therefore, on this data set with mostly well-separated modes, our model gives the same result as the standard model. Note that for each model, all 4 component means have similar posterior densities, indicating that the Gibbs sampler was able to move between different modes of the posterior likelihood. We next used the new model to analyze the synthetic dataset from figure [\ref=synth_data]. The resulting posteriors for μ1 and μ2 are shown in figure [\ref=synth_data_imp]. They have only two distinct modes, similar to the result from the standard model with relatively large values for the prior parameters (c.f. figures [\ref=synth_data_nivg] and [\ref=synth_data_rg]). For this analysis, we also examined the posterior distribution of n1 and n2. We found that there does not seem to be a significant peak for ni near 2. This suggests that constraining ni to be at least 2 did not significantly affect the posterior, other than removing the enrichment of smaller ni values seen for the standard model (c.f. figures [\ref=synth_data_nivg_zeros] and [\ref=synth_data_rg_zeros]).

Conclusion

We have shown that improper priors can be used for Bayesian inference of GMMs with only a slight modification of the original model, which consists of using the modified prior [formula] [\eqref=new_G_prior], and recasting inference in terms of proportions [formula] rather than probabilities [formula]. Our approach is generic: any improper prior on the parameters of a Gaussian distribution can be used, as long as a specific number of data points is guaranteed to make the posterior P  -  a.s. proper. Besides the Jeffreys prior mentioned thus far, uniform priors for variance parameters would also be possible [\citep=gelman_prior_2006]. Also, our approach can be generalized to more than one dimension, although the minimum number of data points per component will generally need to be increased from 2. This modification of the model has several advantages. First of all, we can use noninformative priors to avoid the problem of parameter choice for weakly informative proper priors. This is crucial, as we have seen that proper priors are prone to a prior domination effect which makes parameter choice difficult. Using a model which permits both proper and improper priors also enables the effect of informative proper priors on the posterior to be compared with a noninformative improper prior. Throughout this study, we have held the number of components (K) fixed. Methods which treat this number as random are very useful for nonparametric density estimation - these have been studied by [\citep=ferguson_bayesian_1983] [\citep=escobar_bayesian_1995] [\citep=richardson_bayesian_1997] [\citep=stephens_bayesian_2000], among others. However, suppose we not only want to obtain a predictive density, but also want to infer the parameters of the different mixture components. Then treating K as random leads to some complications. For one, proper priors on the component parameters must be used in this case, but estimates of K tend to be rather sensitive to the choice of these priors. This is true both for methods using reversible jump MCMC [\citep=richardson_bayesian_1997] and birth-death process-based methods [\citep=stephens_bayesian_2000]. Also, a high degree of uncertainty about the number of components may remain [\citep=escobar_bayesian_1995] [\citep=richardson_bayesian_1997] [\citep=stephens_bayesian_2000]. This can be a problem if our strategy is to infer the component parameters conditional on the maximum a posteriori number of components. Thus, it may be more useful to take a range of possible values of K (maybe based on prior knowledge), and sample from the posterior of a mixture model for each of these values. At the very least, this has the advantage of preserving as much information as possible.

Acknowledgements

I would like to thank Peter Bühlmann and Hans Rudolf Künsch for their very helpful comments and advice.

Appendix

Proof of Lemma 1

Lemma 1

Assume that N  >  K, and that α  =  c1κ and β  =  c2κ, with fixed constants c1  >  0 and c2  >  0. Let [formula] be vectors of latent variables. If [formula] assigns all data points to a single component, i.e. [formula], and [formula] does not do this, then P - a.s.:

Proof: We have (see [\eqref=fi_notation]):

[formula]

with:

[formula]

where [formula]. For [formula], we have [formula]. For [formula], we have: Therefore, for [formula], [formula] and [formula] as κ  →  0. For [formula], we have: with:

[formula]

[formula] by the Cauchy-Schwarz inequality. We now use the assumption that [formula] consists of i.i.d. samples from a distribution F that is dominated by Lebesgue measure on [formula]. For any [formula], let [formula] denote a vector consisting of all xj with j∈S. We define: for [formula]. Now, we have: For n  >  1, we have by Tonelli's theorem: Therefore, since F is dominated by Lebesgue measure on [formula], [formula] for all [formula] with #  S  >  1. This means that P - a.s., [formula] and [formula] with [formula], we have [formula]. Now we obtain for [formula], P - a.s.: [formula] and [formula] for arbitrarily small ε  >  0, as κ  →  0. Using [\eqref=G_post_exp], we have: [formula] is P - a.s. [formula] as κ  →  0 (because [formula] assigns all data points to one component). [formula] is P - a.s. at most [formula] as κ  →  0. This is the case when it assigns all but one data point to one component, and one data point to another component, and none to the other components (note that this depends on the assumption N  >  K). Therefore [formula] is P - a.s. [formula] as κ  →  0, so its limit is P - a.s. zero, and we obtain the statement of the lemma. In the latter part of the simulations (see figure [\ref=synth_data_nivg]), we held α fixed at a small value to avoid computational difficulties. Using the same approach as above, we can show that in the case of two components, with fixed α and β  =  c1κ, if [formula] assigns each component more than one data point and [formula] does not do this, then P - a.s. [formula] as κ  →  0.

Integrating out the Jeffreys prior

Here, we derive the closed-form expression for with an improper Jeffreys prior [formula]. We assume that [formula] holds, and that [formula] was generated via independently drawing each [formula] from some distribution on [formula] that is absolutely continuous with respect to Lebesgue measure. Then, we can readily derive the following:

[formula]

Define [formula] is P  -  a.s.  >  0 for [formula], using the assumption on the distribution of [formula] (see the proof of Lemma 1). Assuming [formula] holds, we make the substitution [formula], and solve the integral to obtain:

[formula]

Metropolis-Hastings implementation of our model

For increased computational efficiency, we implemented the GMM with the priors [formula] [\eqref=new_G_prior] and [formula] [\eqref=Jeffreys_prior] using a Metropolis-Hastings algorithm. This was based on the algorithm given for the standard mixture model in [\cite=marin_bayesian_2005], but with several modifications. Our scheme produces approximate samples from the joint posterior distribution of [formula], [formula] and [formula], given [formula]. From each sample of [formula], we can immediately compute [formula], i.e. the proportions with which the different Gaussian components contribute to the observed data. The proposal distributions for [formula], [formula] and [formula] are all denoted by g(  ·  |  ·  ) in the following. We take [formula] to be Gaussian with mean vector [formula] and covariance proportional to the identity matrix. To make the Metropolis-Hastings random walk more efficient at exploring the posterior distribution of mean vectors, we also restrict the values of the components of [formula] to a pre-specified interval

[formula]