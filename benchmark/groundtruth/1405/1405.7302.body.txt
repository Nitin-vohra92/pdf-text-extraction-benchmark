Lemma Fact

A quantitative version of the Blow-up Lemma

Alfréd Rényi Institute of Mathematics Hungarian Academy of Sciences Budapest, P.O. Box 127 Budapest, Hungary, H-1364 and Computer Science Department Worcester Polytechnic Institute Worcester, MA, USA 01609 gsarkozy@cs.wpi.edu

Introduction

Notations and definitions

All graphs are simple, that is, they have no loops or multiple edges. v(G) is the number of vertices in G (order), e(G) is the number of edges in G (size). deg(v) (or deg G(v)) is the degree of vertex v (within the graph G), and deg(v,Y) (or deg G(v,Y)) is the number of neighbors of v in Y. δ(G) and Δ(G) are the minimum degree and the maximum degree of G. N(x) (or NG(x)) is the set of neighbors of the vertex x, and e(X,Y) is the number of edges between X and Y. A bipartite graph G with color-classes A and B and edges E will sometimes be written as G = (A,B,E). For disjoint X,Y, we define the density

[formula]

The density of a bipartite graph G = (A,B,E) is the number

[formula]

For two disjoint subsets A,B of V(G), the bipartite graph with vertex set [formula] which has all the edges of G with one endpoint in A and the other in B is called the pair (A,B).

A pair (A,B) is ε-regular if for every X  ⊂  A and Y  ⊂  B satisfying

[formula]

we have

[formula]

A pair (A,B) is (ε,d,δ)-super-regular if it is ε-regular with density at least d and furthermore,

[formula]

[formula]

H is embeddable into G if G has a subgraph isomorphic to H, that is, if there is a one-to-one map (injection) φ:V(H)  →  V(G) such that {x,y}∈E(H) implies {φ(x),φ(y)}∈E(G).

A quantitative version of the Blow-up Lemma

The Blow-up Lemma [\cite=KSSz2] [\cite=KSSz3] has been a successful tool in extremal graph theory. There are now at least four new proofs for the Blow-up Lemma since the original appeared; an algorithmic proof [\cite=KSSz3], a hypergraph-packing approach [\cite=RRT], a proof based on counting perfect matchings in (Szemerédi-) regular graphs [\cite=RR], and its constructive version in [\cite=RRW]. Very recently the Blow-up Lemma has been generalized to hypergraphs by Keevash [\cite=KEE] and to d-arrangeable graphs by Böttcher, Kohayakawa, Taraz, and Würfl [\cite=BKTW]. The Blow-up Lemma has been applied in numerous papers (see e.g. [\cite=ARR] [\cite=GRR] [\cite=KOR] [\cite=KS] [\cite=KRSSz] [\cite=KO1] [\cite=KO2] [\cite=LRS] [\cite=RR] [\cite=RRT] [\cite=RRW]). See also the discussion on the Regularity Lemma and the Blow-up Lemma on pages 803-804 in the Handbook of Graph Theory [\cite=B2] or the survey paper [\cite=KO3].

In either of our proofs [\cite=KSSz2] [\cite=KSSz3], the dependence of the parameters was not computed explicitly. In this paper we give a quantitative version, i.e. we compute explicitly the parameters.

There exists an absolute constant C such that, given a graph R of order r  ≥  2 and positive parameters d, δ, and Δ, for any [formula] the following holds. Let N be an arbitrary positive integer, and let us replace the vertices of R with pairwise disjoint N-sets [formula] (blowing up). We construct two graphs on the same vertex-set [formula]. The graph R(N) is obtained by replacing all edges of R with copies of the complete bipartite graph KN,N, and a sparser graph G is constructed by replacing the edges of R with some (ε,d,δ)-super-regular pairs. If a graph H with Δ(H)  ≤  Δ is embeddable into R(N) then it is already embeddable into G.

Our proof is almost identical to the proof in [\cite=KSSz3]. Of course one difference is that we have to compute explicitly the dependence between the parameters. Furthermore, this is also a slight strengthening of the original statement as there can be a small number of exceptional vertices which may have smaller degrees (δ may be much smaller than d). We note that the recent "arrangeable" Blow-up Lemma [\cite=BKTW] is also quantitative, but first of all the bound on ε is somewhat weaker and second it does not allow for the strengthening mentioned above. However, in a recent application [\cite=GS] we needed precisely this strengthening. We believe that this quantitative version of the Blow-up Lemma will find other applications as well.

In Section 2 we give the embedding algorithm. In Section 3 we show that the algorithm is correct.

The algorithm

The main idea of the algorithm is the following. We embed the vertices of H one-by-one by following a greedy algorithm, which works smoothly until there is only a small proportion of H left, and then it may get stuck hopelessly. To avoid that, we will set aside a positive proportion of the vertices of H as buffer vertices. Most of these buffer vertices will be embedded only at the very end by using a König-Hall argument.

Preprocessing

We will assume that [formula]. We will assume for simplicity, that the density of every super-regular pair in G is exactly d. This is not a significant restriction, otherwise we just have to put everywhere the actual density instead of d.

We will use the following parameters:

[formula]

where a  ≪  b means that a is small enough compared to b. For example we can select the parameters in the following explicit way:

[formula]

[formula]

[formula]

For easier reading, we will mostly use the letter x for vertices of H, and the letter v for vertices of the host graph G.

Given an embedding of H into R(N), it defines an assignment

[formula]

and we want to find an embedding

[formula]

such that φ(x)∈ψ(x) for all x∈V(H). We will write Xi  =  ψ- 1(Vi) for [formula].

Before we start the algorithm, we order the vertices of H into a sequence [formula] which is more or less, but not exactly, the order in which the vertices will be embedded (certain exceptional vertices will be brought forward). Let m = rd'N. For each i, choose a set Bi of d'N vertices in Xi such that any two of these vertices are at a distance at least 3 in H. (This is possible, for H is a bounded degree graph.) These vertices [formula] will be called the buffer vertices and they will be the last vertices in S.

The order S starts with the neighborhoods [formula]. The length of this initial segment of S will be denoted by T0. Thus [formula].

The rest of S is an arbitrary ordering of the leftover vertices of H.

Sketch of the algorithm

In Phase 1 of the algorithm we will embed the vertices in S one-by-one into G until all non-buffer vertices are embedded. For each xj not embedded yet (including the buffer vertices) we keep track of an ever shrinking host set Ht,xj that xj is confined to at time t, and we only make a final choice for the location of xj from Ht,xj at time j. At time 0, H0,xj is the cluster that xj is assigned to. For technical reasons we will also maintain another similar set, Ct,xj, where we will ignore the possibility that some vertices are occupied already. Zt will denote the set of occupied vertices. Finally we will maintain a set t of exceptional pairs of vertices.

In Phase 2, we embed the leftover vertices by using a König-Hall type argument.

Embedding Algorithm

At time 0, set C0,x = H0,x  =  ψ(x) for all x∈V(H). Put T1 = d''n.

For t  ≥  1, repeat the following steps.

Step 1 (Extending the embedding).  We embed xt. Consider the vertices in Ht - 1,xt. We will pick one of these vertices as the image φ(xt) by using the Selection Algorithm (described below in Section [\ref=selection]).

Step 2 (Updating).  We set

[formula]

and for each unembedded vertex y (i.e. the set of vertices xj,t < j  ≤  n), set

[formula]

and

[formula]

We do not change the ordering at this step.

Step 3 (Exceptional vertices in G).

1. If [formula], then go to Step 4.

2. If t = 1, then we do the following (this is the part that is new compared to the proof in [\cite=KSSz3]). We find the 1st exceptional set (denoted by E1i) consisting of those exceptional vertices v∈Vi, 1  ≤  i  ≤  r for which there exists a [formula] such that (Vi,Vj) is (ε,d,δ)-super-regular, yet

[formula]

(Note that deg G(v,Vj)  ≥  δ|Vj| always holds by super-regularity.) ε-regularity implies that |E1i|  ≤  rεN. We are going to change slightly the order of the vertices in S. We choose a set E1H of nonbuffer vertices x∈H of size [formula] (more precisely |E1i| vertices from Xi for all 1  ≤  i  ≤  r) such that they are at a distance at least 3 from each other. This is possible since H is a bounded degree graph and [formula] is very small. We bring the vertices in E1H forward, followed by the remaining vertices in the same relative order as before. For simplicity we keep the notation [formula] for the resulting order. Furthermore, we slightly change the value of T0 to [formula].

3. If t = T0, then we do the following. We find the 2nd exceptional set (denoted by E2i) consisting of those exceptional vertices v∈Vi, 1  ≤  i  ≤  r for which v is not covered yet in the embedding and

[formula]

Once again we are going to change slightly the order of the remaining unembedded vertices in S. We choose a set E2H of unembedded nonbuffer vertices x∈H of size [formula] (more precisely |E2i| vertices from Xi for all 1  ≤  i  ≤  r) with

[formula]

Thus in particular, if x∈Xi, then E2i  ⊂  Ht,x. Again we may choose the vertices in EH as vertices in H that are at a distance at least 3 from each other and any of the vertices embedded so far. We are going to show later in the proof of correctness that this is possible since H is a bounded degree graph and [formula] is very small as well. We bring the vertices in E2H forward, followed by the remaining unembedded vertices in the same relative order as before. Again, for simplicity we keep the notation [formula] for the resulting order.

Step 4 (Exceptional vertices in H).

1. If T1 does not divide t, then go to Step 5.

2. If T1 divides t, then we do the following. We find all exceptional unembedded vertices y∈H such that |Ht,y|  ≤  (d')2n. Once again we slightly change the order of the remaining unembedded vertices in S. We bring these exceptional vertices forward (even if they are buffer vertices), followed by the non-exceptional vertices in the same relative order as before. Again for simplicity we still use the notation [formula] for the new order. Note that it will follow from the proof, that if t  ≤  2T0, then we do not find any exceptional vertices in H, so we do not change the ordering at this step.

Step 5 - If there are no more unembedded non-buffer vertices left, then set T = t and go to Phase 2, otherwise set t←t + 1 and go back to Step 1.

Find a system of distinct representatives of the sets HT,y for all unembedded y (i.e. the set of vertices xj, T < j  ≤  n).

Selection Algorithm

We distinguish two cases. Let [formula].

Case 1. [formula].

We choose a vertex v∈Ht - 1,xt as the image φ(xt) for which the following hold for all unembedded y with {xt,y}∈E(H),

[formula]

[formula]

and

[formula]

for at least a (1 - ε') proportion of the unembedded vertices y' with ψ(y') = ψ(y) and [formula]. Then we get t by taking the union of t - 1 and the set of all of those pairs {y,y'} for which ([\ref=3]) does not hold for v = φ(xt), Ct - 1,y and Ct - 1,y'. Thus note that we add at most Δε'N new pairs to t.

Case 2. xt∈EH.

If [formula], l = 1,2, then we choose an arbitrary vertex of Eli as φ(xt). Note that for all y∈NH(xt), we have Ct - 1,y  =  ψ(y),

[formula]

and

[formula]

(using our choice of parameters). Here we used super-regularity and the fact that |EH|  ≪  Δm which will be shown later (Lemma [\ref=E]).

Proof of correctness

The following claims state that our algorithm finds a good embedding of H into G.

Claim 1.  Phase 1 always succeeds.

Claim 2.  Phase 2 always succeeds.

If at time t, S is a set of unembedded vertices x∈H with ψ(x) = Vi (here and throughout the proof when we talk about time t, we mean after Phase 1 is executed for time t, so for example xt is considered embedded at time t), then we define the bipartite graph Ut as follows. One color class is S, the other is Vi, and we have an edge between an x∈S and a v∈Vi whenever v∈Ct,x.

In the proofs of the above claims the following lemma will play a major role. First we prove the lemma for t  ≤  T0, from this we deduce that |EH| is small, then we prove the lemma for T0  <  t  ≤  T.

We are given integers 1  ≤  i  ≤  r, 1  ≤  t  ≤  T0 and a set S  ⊂  Xi of unembedded vertices at time t with |S|  ≥  (d''')2|Xi| = (d''')2N. If we assume that Phase 1 succeeded for all time t' with t'  ≤  t, then apart from an exceptional set F of size at most ε''N, for every vertex v∈Vi we have the following

[formula]

Proof. In the proof of this lemma we will use the "defect form" of the Cauchy-Schwarz inequality (just as in the original proof of the Regularity Lemma [\cite=SzemRegu]): if

[formula]

then

[formula]

Assume indirectly that the statement in Lemma [\ref=egy] is not true, that is, |F| > ε''N. We take an F0  ⊂  F with |F0| = ε''N. Let us write ν(t,x) for the number of neighbors (in H) of x embedded by time t. Then in Ut using the left side of ([\ref=2]) we get

[formula]

where the error term comes from the neighbors of elements of E1H (we are yet to start the embedding of the vertices in E2H), since for them we cannot guarantee the same lower bound.

We also have

[formula]

[formula]

[formula]

The error terms come from the following (x,x') pairs. For each such pair we estimate [formula]. The first error term comes from the pairs where x = x'. The second error term comes from those pairs (x,x') for which [formula]. The number of these pairs is at most |S|Δ(Δ - 1)  ≤  Δ2|S|. The third error term comes from those pairs (x,x') for which x or x' is a neighbor of an element of E1H. Finally we have the pairs for which {x,x'}∈t. The number of these pairs is at most 2tΔε'N  ≤  2Δε'N2.

Next we will use the Cauchy-Schwarz inequality with m = ε''N and the variables [formula] are going to correspond to deg Ut(v), v∈Vi (and the first m variables to degrees in F0). Then we have

[formula]

[formula]

Then using ([\ref=nagy]), ([\ref=D]) and the Cauchy-Schwarz inequality we get

[formula]

[formula]

[formula]

[formula]

which is a contradiction with ([\ref=7]), since |S|  ≥  (d''')2N,

[formula]

and

[formula]

by the choice of the parameters.  [formula]

An easy consequence of Lemma [\ref=egy] is the following lemma.

In Step 3 we have |E2i|  ≤  ε''N for every 1  ≤  i  ≤  r.

Proof. Indeed applying Lemma [\ref=egy] with t = T0 and S = Bi (so we have |S| = |Bi| = d'N  >  (d''')2N) we get

[formula]

and E2i  ⊂  F.  [formula]

From this we can prove Lemma [\ref=egy] for t > T0 with ε''' instead of ε''.

We are given integers 1  ≤  i  ≤  r, T0  <  t  ≤  T and a set S  ⊂  Xi of unembedded vertices at time t with |S|  ≥  (d''')2|Xi| = (d''')2N. If we assume that Phase 1 succeeded for all time t' with t'  ≤  t, then apart from an exceptional set F of size at most ε'''N, for every vertex v∈Vi we have the following

[formula]

Proof. We only have to pay attention to the neighbors of the elements of E2H, otherwise the proof is the same as the proof of Lemma [\ref=egy] with ε''' instead of ε''. In ([\ref=nagy]) the error term becomes Δrε''N2, coming from the neighbors of elements of E2H.

In ([\ref=7]) we have more bad pairs, namely all pairs (x,x') where x or x' is a neighbor of an element of E2H. These give an additional error term of 2Δrε''|S|N2. However, the contradiction still holds, since

[formula]

by the choice of the parameters.  [formula]

An easy consequence of Lemmas [\ref=egy] and [\ref=egy'] is the following lemma.

We are given integers 1  ≤  i  ≤  r, 1  ≤  t  ≤  T, a set S  ⊂  Xi of unembedded vertices at time t with |S|  ≥  d'''|Xi| = d'''N and a set A  ⊂  Vi with |A|  ≥  d'''|Vi| = d'''N. If we assume that Phase 1 succeeded for all time t' with t'  ≤  t, then apart from an exceptional set S' of size at most (d''')2N, for every vertex x∈S we have the following

[formula]

Proof. Assume indirectly that the statement is not true, i.e. there exists a set S'  ⊂  S with |S'| > (d''')2N such that for every x∈S' ([\ref=jolmetsz]) does not hold. Once again we consider the bipartite graph Ut = Ut(S',Vi). We have

[formula]

On the other hand, applying Lemmas [\ref=egy] or [\ref=egy'] for S' we get

[formula]

contradicting the previous inequality.  [formula]

Finally we have

For every 1  ≤  t  ≤  T and for every vertex y that is unembedded at time t, if we assume that Phase 1 succeeded for all time t' with t'  ≤  t, then we have the following at time t

[formula]

Proof. We apply Lemma [\ref=ketto] with St the set of all unembedded vertices in Xi at time t, and [formula] (all uncovered vertices). Then for all but at most (d''')2N vertices x∈St using ([\ref=2]) and ([\ref=4]) we get

[formula]

if |At|  ≥  (d' / 2)N. We will show next that in fact for 1  ≤  t  ≤  T, we have

[formula]

so ([\ref=11]) always holds. Assume indirectly that this is not the case, i.e. there exists a 1  ≤  T' < T for which,

[formula]

From the above at any given time t for which T1|t and 1  ≤  t  ≤  T', in Step 4 we find at most (d''')2N exceptional vertices in Xi. Hence, altogether we find at most

[formula]

exceptional vertices in Xi up to time T'. However, this implies that at time T' we still have many more than (d' - d'')N unembedded buffer vertices in Xi, which in turn implies that |AT' + 1|  ≫  (d' - d'')N, a contradiction. Thus we have

[formula]

at time T (or in Phase 2) we have at least (d' - d'')N unembedded buffer vertices in each Xi, and furthermore, for every 1  ≤  t  ≤  T for all but at most (d''')2N vertices x∈St we have

[formula]

Let us pick an arbitrary 1  ≤  t  ≤  T and an unembedded y at time t (with ψ(y) = Vi). We have to show that ([\ref=nagyH]) holds. Let kd''n = kT1  ≤  t  <  (k + 1)T1 for some 0  ≤  k  ≤  T / T1. We distinguish two cases:

Case 1. y was not among the at most (d''')2N exceptional vertices of Xi found in Step 4 at time kT1. Then

[formula]

Indeed, at time kT1 we had |HkT1,y|  ≥  (d')2N. Until time t, Ht,y could have been cut at most once to a ≥  (δ / 2)-fraction (if y is a neighbor of an element of EH, there can be at most one such EH-neighbor) and at most Δ times to a ≥  (d - ε)-fraction (using ([\ref=1]) and ([\ref=5])), and precisely t - kT1  ≤  T1  =  rd''N new vertices were covered.

Case 2. y was among the at most (d''')2N exceptional vertices of Xi found in Step 4 at time kT1. Then

[formula]

since at time (k - 1)T1 (we certainly must have k  ≥  2), y was not exceptional, and because the exceptional vertices were brought forward we have t  ≤  kT1  +  r(d''')2N. Thus in both cases we have |Ht,y| > d''N, as desired.  [formula]

Finally we show that the selection algorithm always succeeds in selecting an image φ(xt).

For every 1  ≤  t  ≤  T, if we assume that Phase 1 succeeded for all time t' with t'  ≤  t, then Phase 1 succeeds for time t.

Proof. We only have to consider Case 1 in the selection algorithm. We choose a vertex v∈Ht - 1,xt as the image φ(xt) which satisfies ([\ref=1]), ([\ref=2]) and ([\ref=3]). We have by Lemma [\ref=harom],

[formula]

By ε-regularity we have at most 2εN vertices in Ht - 1,xt which do not satisfy ([\ref=1]) and similarly for ([\ref=2]). For ([\ref=3]) we define an auxiliary bipartite graph B as follows. One color class W1 is the vertices in Ht - 1,xt and the other class W2 is the sets [formula] for all pairs {y,y'} where {xt,y}∈E(H), ψ(y) = ψ(y'), and [formula]. We put an edge between a v∈W1 and an S∈W2 if inequality ([\ref=3]) is not satisfied for v and S. Let us assume indirectly that we have more than ε'N vertices v∈W1 with deg B(v)  >  ε'|W2|. Then there must exist a S∈W2 with

[formula]

However, this is a contradiction with ε-regularity since

[formula]

Here we used the fact that the pair corresponding to S is not in t - 1. Thus altogether we have at most 4εN  +  ε'N  ≪  d''N vertices in Ht - 1,xt that we cannot choose and thus the selection algorithm always succeeds in selecting an image φ(xt), proving Claim 1.  [formula]

Proof of Claim 2. We want to show that we can find a system of distinct representatives of the sets HT,xj,T < j  ≤  n, where the sets HT,xj belong to a given cluster Vi.

To simplify notation, let us denote by Y the set of remaining vertices in Vi, and by X the set of remaining unembedded (buffer) vertices assigned to Vi. If x = xj∈X then write Hx for its possible location HT,xj at time T. Also write M = |X| = |Y|.

The König-Hall condition for the existence of a system of distinct representatives obviously follows from the following three conditions:

[formula]

[formula]

[formula]

Equation ([\ref=konig1]) is an immediate consequence of Lemma [\ref=harom], ([\ref=konig2]) is a consequence of Lemma [\ref=egy]. Finally to prove ([\ref=konig3]), we have to show that every vertex in Y  ⊂  Vi belongs to at least d'''|X| location sets Hx. However, this is trivial from the construction of the embedding algorithm, in Step 3 of Phase 1 we took care of the small number of exceptional vertices for which this is not true. This finishes the proof of Claim 2 and the proof of correctness.  [formula]