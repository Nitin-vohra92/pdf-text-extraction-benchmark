Non-linear Dynamics, Emergent Behaviors and Controlled Expansions: Towards Effective Modeling of the Congested Traffic

Introduction

Modeling the dynamics of the highway traffic flow has been the endeavor of researchers in many disciplines for the last fifty years[\cite=dogbe] [\cite=as] [\cite=helbing] [\cite=kernerbook]. Various different models have been proposed to describe both the free and the congested phase of the traffic flow[\cite=bando] [\cite=JiangR_PRE01] [\cite=PengGH_PhyA13] [\cite=GLW_PhyA08] [\cite=kerner1] [\cite=kerner2] [\cite=stepan] [\cite=nagel] [\cite=kim] [\cite=naka] [\cite=xue] [\cite=nishinari]. Most of these models can capture the low density free flow phase, and the wide moving jams when the density is high. Kerner[\cite=kernercrit] first suggested that some essential empirical features are not captured by most of these models; there exists a "synchronized phase" that can be distinguished by a scattering of data points covering a two-dimensional region on the flow-density plane. It is argued this phase is qualitatively different from the wide moving jams, particularly when a bottleneck at the highway is present[\cite=kernerexp1] [\cite=kernerexp2]. This raises the questions of the relevance of the popular general motor (GM) model classes to real traffic systems, because these models only describe a two-phase transition[\cite=kernercrit].

Most of the three-phase models are constructed by putting in a "synchronization gap" by hand[\cite=kerner1] [\cite=kerner2] [\cite=kerner3], at the cost of making the models more sophisticated with significantly more parameters. These, together with other three-phase models[\cite=kimca], reproduce the "synchronized phase" with a multitude of steady states in the congested phase. However, Helbing et.al[\cite=helbing2] pointed out that the characterization of the complex congested states of the traffic flow as a single synchronized phase is delicate, and with properly adjusted parameters some GM models can reproduce many empirical observations at the highway bottleneck[\cite=helbing2]. One should also note inhomogeneous road conditions and vehicle types[\cite=helbing3], as well as stochastic driving behaviors can contribute to the scattering of the flow-density plot. More importantly, it is not well understood if the empirical data in the congested phase comes from equilibrium/steady traffic conditions, or from slowly evolving transient ones.

Unlike conventional physical systems, where the construction of the physical models are guided and constrained by symmetries, in traffic systems such symmetries are conspicuously lacking. Even individual components are not identical to each other: each of them responds to the interaction and environment differently, and in a time-dependent way. While constructions of the traffic models are generally guided by simplicity and the use of physically transparent parameters, there is a certain level of arbitrariness in how the model should look like due to the lack of a more fundamental guiding principle. This is one of the main reasons for a plethora of different traffic models and the controversies in the field.

In this paper, we aim to explore such guiding principles by proposing a systematic way of constructing traffic models, in order to remove the arbitrariness in the possible forms of the models. The first part of the paper is to develop a general framework to obtain the master deterministic microscopic model, which can in principle be obtained from empirical measurements. Various simplified effective models can thus be constructed via the controlled expansions of the master microscopic model. For the next part we use the published empirical data of the A-5 North German Highway as an example to illustrate how a minimal effective model should be constructed and tuned. We first establish a list of empirical features of the traffic dynamics that are commonly reported and well-defined. This includes most of the quantitative characteristics and the qualitative spatiotemporal traffic patterns on which the "three phase" traffic theory is based. This is followed by our proposal of a simple algorithm to construct a minimal effective model that can capture all these empirical features, with the intention that such model is the simplest possible, and it has enough predictive power for it to be useful for traffic optimization and transport engineering.

The resulting effective model is within the framework of our guiding principle and is able to capture unambiguously the empirical features that are previous thought to require the sophisticated "three phase models"[\cite=kerner1] [\cite=kerner2] [\cite=kerner3], or the intelligent driver models (IDM)[\cite=helbing4] that have an artificial divergence when the headway goes to zero. More importantly our effective model is surprisingly simple, providing strong evidence that the non-linear dynamics alone is fundamental to the empirical features listed in Sec. [\ref=sec_empirical]. A careful interpretation of the emergent quantities in the system of non-linear ODEs is an important component of our algorithm, in which the parameters and functional forms in the model are no longer estimated, but well-defined by macroscopic empirical features.

The requirement that empirical features are common and well-defined does not come without a price: given the complex nature of the traffic system, there are observations of various spatiotemporal traffic patterns that are difficult to differentiate in a well-defined way. Thus the predictive power of our model, as well as our theoretical understanding, is at best ambiguous for those observations. Nevertheless, we aim to achieve a clear understanding of what can be unambiguously captured by the model and theory given the set of necessary assumptions, and to establish a useful "reference point": when better understandings of the empirical features emerge, one can systematically extend and generalize the model.

The paper will be organized as follows: In Sec. [\ref=sec_empirical] we present a list of empirical features, defining them entirely from the experimental point of view, minimizing the tendency of pre-mature theoretical interpretations. In Sec. [\ref=sec_model] we present a general framework of systematically modeling the traffic dynamics from the most general equations of motion. All assumptions of the model are listed and connections to various microscopic models in the literature are discussed. In Sec. [\ref=sec_property] we study some of the universal properties of a class of simplified effective models, which belongs to the OV model class, and focus on the quantities emerging from the non-linear anisotropic interactions between vehicles. In particular we introduce an emergent length scale that quantifies the strength of interaction between the quasisolition structures appearing in the solutions of the OV models, leading to non-trivial cluster statistics when the constant headway solutions (or the ground states) of the OV model are randomly perturbed. This emergent scale plays an important role in tuning the model and defining the time scale in the traffic dynamics. In Sec. [\ref=sec_algorithm] we present a simple algorithm in constructing a minimal effective model based on the macroscopic empirical data, and in particular their relationship with the emergent quantities in the traffic model, and in Sec. [\ref=sec_prediction] we present the model's predictions of the quantitative empirical features, together with the characteristic spatiotemporal patterns, and compare them with the empirical observations. In Sec. [\ref=sec_conclusion] we summarize our results and discuss the outlooks of the traffic modeling.

Empirical Features of Traffic Dynamics

Many work has been published on the empirical studies of the highway traffic dynamics, and readers can refer to [\cite=kernerbook] [\cite=helbing2] [\cite=helbing4] for detailed information. The reconstruction of the complex spatiotemporal patterns along the highway based on the measurement of the flow and average velocity at a specific location is also a subtle issue, and an excellent discussion can be found in[\cite=helbing2]. One of the most popular techniques in analyzing the traffic data is the construction of the flow-density diagram, where the flow of traffic through a fixed cross-section is plotted against the average density of the vehicles on the highway. A schematic drawing of such plot is shown in Fig.([\ref=schematics]).

It is well understood that in the limit of the road density ρ  →  0, the flow-density relationship is linear with very small scattering of the data. The gradient in that limit lim ρ  →  0dQ / dρ is the maximum velocity Vmax of the vehicles on the highway. This is the characteristic velocity of the vehicle when it is travelling freely with no other vehicle in the front, and is in general constrained by the speed limit, road conditions and the physical capabilities of the vehicle.

When the density increases from zero, initially the average velocity of the vehicles does not change much, as the vehicles hardly interact with each other. Thus the flow increases linearly. At intermediate densities, the interaction between vehicles strongly reduce the average velocity, leading to a sub-linear increase of the flow against the density. This continues until the density reaches the critical density ρc, at which the flow reaches a maximum [formula]. The maximum flow [formula] is also defined as the capacity of the highway.

In general the relationship between the flow and density becomes more scattered as the density increases towards ρc. What is more interesting is a characteristic discontinuous drop in Q when ρ increases past ρc, together with an onset of wide scattering of the flow-density relationship, covering a two-dimensonal area on the flow-density plane. There is clearly a phase transition here physically corresponding to the breakdown of the free flow traffic to the congested traffic. In Kerner's "three-phase traffic theory"[\cite=kernerbook], the two-dimensional scattering of the flow-density data points corresponds to the "synchronized flow", or the "synchronized phase". The fundamental assumption of the "three-phase theory" is that each scattered data point on the flow-density plane corresponds to a steady state, that can be either stable or unstable against the formation of the wide moving jam. Microscopically it is postulated that the speed adaptation of the drivers at high vehicle density leads to a non-unique relationship between the average velocity and the average headway. It is also postulated the two-dimensional covering of the "synchronized phase" is bounded by the free flow, and a characteristic upper and lower boundary.

In this paper, we take a step back and stop short of making assumptions about the nature of the scattered flow-density relationship. The real highway traffic is an open system and it is very difficult to verify experimentally if these states are steady states, or just transient states that last for long enough time for it to be captured by the sensors. Instead we just characterize the congested phase of the traffic dynamics by a depression of the traffic flow and a much larger scattering of the flow-density relationship as compared to the free flow when ρ  <  ρc.

There is also a well-known "hysteresis effect"[\cite=bertini1], whereby the traffic flow breaks down at the maximum flow [formula], and after staying congested for an extended period of time returns back to the free flow but at a smaller flow. While due to the wildly fluctuating nature of the congested phase one cannot characterize the "hysteresis effect" quantitatively, one can understand it from the crucial empirical observation that the traffic flow downstream of the congested phase, and in particular of the wide moving jam, is significantly smaller than the maximum flow [formula][\cite=kernerbook], and this should also be predicted by a useful model.

Another important feature in the flow-density diagram is the "J line", corresponding to the emergence of the wide moving jam in the traffic. The structure of the wide moving jam is surprisingly robust[\cite=kernerbook], leading to several readily measurable quantities that are characteristic of the traffic system. The gradient of the "J line" is obtained from the characteristic velocity Vj of the jam moving upstream; the intersection of the "J line" with the free flow branch of the flow-density plot comes from the characteristic flow Qdj, and the density ρdj of the vehicle right downstream of the wide moving jam. The intersection of the "J line" with the density axis comes from the density of the vehicle, ρj, within the wide moving jam, where all vehicles come to a stop with zero velocity. One should also note the following relationship

[formula]

It was noted by Kerner these characteristic quantities does not change with the flow and density of the vehicles away from the wide moving jam (both upstream and downstream), thus a useful traffic model should be able to capture these important quantities.

Apart from the flow density diagram, it is also very important to characterize the rich spatiotemporal patterns of the traffic in the congested phase. It is well established that the congested phase is macroscopically rather homogeneous as compared to the wide moving jams, though microscopically one would observe spatial and temporal fluctuations of both density and velocity, sometimes in the form of numerous narrow jams in which the vehicles' velocities drop to zero momentarily[\cite=kernerbook] [\cite=kernerexp1] [\cite=kernerexp2] [\cite=helbing2] [\cite=helbing4]. The distinction between the general congested traffic (the "synchronized phase" or the "general patterns") and the wide moving jams is rather difficult to define for the highway traffic without the presence of the bottlenecks. It is, however, unambiguous that when the traffic density exceeds ρc, one almost never see wide moving jams evolve spontaneously from the free flow, unless something drastic (for example, an accident) happens. Instead the traffic breaks down to the congested (or the "synchronized") phase which can last up to an hour; the wide moving jams, on the other hand, emerge from the congested phase via the "pinch effect" or merging of numerous narrow jams. This qualitative mechanism should be predicted by a useful model.

The spatiotemporal patterns of the highway traffic with the presence of bottlenecks are also very important in characterizing the traffic dynamics. The distinction between the "synchronized flow" and the wide moving jam can be unambiguously stated by looking at the behaviors of their respective downstream front. The downstream front of the wide moving jam will move with the same characteristic velocity Vj when passing through the bottleneck, while the downtream front of the "synchronized phase" is pinned at the bottleneck[\cite=kernerbook]. When the bottleneck is in the form of an on-ramp through which additional vehicles are injected into the main highway traffic, a wide moving jam passing through the bottleneck can either induce or suppress the congested flow upstream of the bottleneck, depending on the strength of the traffic flow along the main highway traffic Qm and from the on-ramp Qin. In general the congested flow can last for a few kilometers, and the wide moving jams tend to evolve from the congested traffic and move upstream.

Detailed studies of the congested phase, including the "general pattern" and the "synchronized phase", also show that when the bottleneck strength increases, the mean frequency of the moving jam emergence becomes greater, and the region of the congested traffic upstream of the bottleneck is also smaller. Another important observation of the highway traffic indicates that there are still very significant fluctuations in the average velocity of the vehicles even in the region when the vehicle density is very high. These two fundamental empirical features were first pointed out to illustrate the inadequacy of the early GM model classes[\cite=kernerbook], which seem to predict exactly the opposite behaviors. They are thus very important gauges in testing the usefulness of any constructed traffic models. The empirical features listed in this section is summarized in Table. [\ref=t].

A General framework in model construction

A microscopic traffic model requires the understanding of the dynamics of a single vehicle based on the interaction with its environment. Unlike classical physical systems we cannot write down equations based on the symmetry of the system: there is no spatial or temporal symmetry in the traffic system, and even the interacting components are not identical to each other. In fact, the complex dynamics of the traffic system can be a result of the following (non-exhausive) factors: a). the non-linear interaction between individual vehicles; b). diversity of the vehicle/driver types; c). stochasticity of the driving behaviors; d). inhomogeneity of the traffic lanes; e). time dependence of the vehicle number and driving behaviors. To understand any empirical features observed in the real traffic, it is very important to show which one or few of those factors (and not others) are fundamentally responsible, and this should be reflected in the constructed model. From a more theoretical point of view, one would also like to understand what interesting phenomena can result from the non-linear dynamics alone, independent of all other factors.

In reality almost all highway traffics have multiple lanes, and the behavior of lane changing and overtaking can be important for certain empirical observations[\cite=helbing7] [\cite=herman]. In this paper, however, we ignore multiple lanes completely by modeling the traffic as a one-dimensional system. Each component, or vehicle, is labeled by a subscript n, which increases sequencially in the direction of the highway traffic, indicating no overtaking. We try to base our model on what we actually observe experimentally as much as possible. The acceleration of the [formula] vehicle is most generally given by

[formula]

where {si} and {ti} combined is the collection of environmental factors that influences the acceleration. The separation of these factors into groups {si} and {ti} is arbitrary, but from the modeling perspective {si} contains all the unimportant factors we would like to average over. This is because Eq.([\ref=gg]) by itself is not useful for analytic or numerical calculations. One can, however, repeatedly measure an over a wide range of {si} and {ti} and average over {si}, which is formally represented as follows

[formula]

where N0 is the proper normalization factor. If we also assume identical drivers in the traffic system, one also need to average over all the vehicles on the highway to obtain

[formula]

where N is the total number of vehicles. One can also give a time delay on the LHS of Eq.([\ref=gg])~  Eq.([\ref=aagg]) to model the reaction time of the drivers. Since the reaction time tends to be small and the acceleration is already the second time derivative, we will not consider it here. More importantly Eq.([\ref=agg]) and Eq.([\ref=aagg]) can be empirically measured after proper averaging. In practice, one does not need to know the details of {si} to obtain Eq.([\ref=aagg]). A reasonably sufficient process is to record {an,{ti}} of many vehicles for a long period of time over diverse environments. For each set of {ti} one can average over the corresponding an to obtain Eq.([\ref=aagg]).

The choice of parameters in {ti} is motivated physically and for convenience. Since we are interested in the spatiotemporal characteristics of the traffic dynamics, it is natural to take {ti} as a collections of positions and velocities. The most intuitive choice is {ti}  =  {hn,Δvn,vn}, where hn is the bumper to bumper headway of the [formula] vehicle, and Δvn = vn + 1 - vn is the velocity difference between the two consecutive vehicles. We are thus looking at the equation of motion of a one-dimensional system of identical components with a nearest neighbour anisotropic interaction. All other factors are averaged over and from Eq.([\ref=aagg]) we obtain:

[formula]

where for notational convenience we remove the bar representing the average taken in Eq.([\ref=agg]) and Eq.([\ref=aagg]). We will show in Sec. [\ref=sec_algorithm] that Eq.([\ref=meqn]) contains the minimal set of parameters to capture the empirical features discussed in Sec. [\ref=sec_empirical].

It is a data and labor intensive task to obtain empirically the exact model as defined in Eq.([\ref=meqn]), but we do know from common driving experience that an should increase with increasing hn,Δvn, but decrease when vn increases. In addition, we make two key assumptions. We first assume there exist solutions to [formula]; the solution is basically a statement that for hn = h0, Δvn = 0, all vehicles are equally spaced apart traveling at the same velocity with no acceleration. We define this as the ground state of the traffic system at average density h- 10. This gives the implicit solution(s) [formula]. For each h0 there can exist more than one V(k)op indexed by k, leading to more than one ground states with different velocities at the same traffic density.

The second assumption is that f0 is smooth around Δvn = 0 and vn = V(k)op. The two physical scales of the traffic system is ρj, the maximum vehicle density which occurs within a wide moving jam; and Vmax, the maximum velocity. Using the dimensionless quantities h̃n = hnρj,ṽn = vn / Vmax,ṽ(k)op = V(k)op / Vmax and Δṽn  =  Δvn / Vmax, we define

[formula]

where 0 is also dimensionless and κ  =  ρjVmax. The assumption allows us to do Taylor expansion around each ground state as follows

[formula]

when [formula] as well as Δṽn are small, and where O(2) contains terms of higher orders of expansion. Here we also define ãn = anρj, so the only dimenional scale in the equation is κ which gives the inverse time.

A few comments are in order here. The averaging process performed in Eq.([\ref=agg]) and Eq.([\ref=aagg]) leads to a time-independent, deterministic model with identical drivers. These are the general assumptions for most microscopic traffic models in the literature. The resulting model in Eq.([\ref=meqn]) can be easily generalized to more (long-ranged) interactions, for example by including the next nearest neighbour (vn + 2∈{ti}), or backward looking (vn - 1∈{ti}), though we will show in Sec. [\ref=sec_algorithm] and Sec. [\ref=sec_prediction] they are not necessary.

On the other hand, it is unlikely that Eq.([\ref=meqn]) will diverge in the limit hn  →  0. In fact since Eq.([\ref=meqn]) is in principle averaged from the empirical data, an must be bounded both from the above and from below. However, popular models like the IDM with an artificial divergence when the headway goes to zero also can be expanded around its unique ground state at each average density. One would in fact expect any model with a fundamental diagram to have an equivalent model in the form of Eq.([\ref=meqn]), with a unique optimal velocity function that can capture the same physics of the traffic dynamics.

The "speed adaptation model" in [\cite=kerner3] proposes two different optimal velocity functions in two velocity ranges. If one assumes f0 is analytic, this corresponds to expanding around two different V(k)op. One should note that if we assume smoothness of f0 and if there exists multiple V(k)op, we would expect ∂0  /  ∂ṽn  ≥  0 when evaluated at Δṽn = 0,ṽn  =  ṽ(k)op for some k. Around these points Eq.([\ref=expansion]) is generally unstable with both velocities and headways diverge over time. Consequently the lowest order approximation in Eq.([\ref=expansion]) becomes invalid and most probably the system will settle into one of the stable regions where ∂0  /  ∂ṽn < 0. Thus if experimentally f0 is found to be analytic with multiple V(k)op for certain range of hn, then the "speed adaptation model" can be justified microscopically.

Most of the complicated "three-phase" microscopic models proposed assumes that [formula] is not analytic when hn is smaller than the so-called "synchronization gap". Unlike the IDM models where the divergence of the acceleration is purely an artificial modeling tool, the non-analyticity of f0 can in principle be checked with the experimental data. It would be interesting to see if the exact f0 from the empirical measurement shows non-analytic behavior. In this framework the non-analyticity of f0 is the necessary condition for the multitude of steady states with a non-unique relationship between the flow and density.

Emergent properties of the analytic model

We now focus on Eq.([\ref=expansion]) with one particular V(k)op and discuss the mathematical properties of the resulting coupled ODEs with non-linear interactions. We first rewrite Eq.([\ref=expansion]) in a simpler form, ignoring higher orders of [formula]:

[formula]

here [formula], and the second term on the right still keeps all the higher orders of Δṽn. This is just a general form of the optimal velocity (OV) model, and its mathematical properties are quite well known. In addition to briefly discussing those properties, we will also introduce an emergent intrinsic length scale, which is not only theoretically interesting by itself, but also serves as an important tuning parameter for Sec. [\ref=sec_algorithm].

To simplify the discussion we use the simplest form of the OV model as an example, and all the relevant properties are universal and can be qualitatively applied to Eq.([\ref=meq2]) unless otherwise stated. In this simplest case we ignore the dependence of the acceleration on Δvn and choose the most popular optimal velocity function[\cite=bando]:

[formula]

We also take the special case [formula], independent of h̃n. Defining sn = C1h̃n - C2, and rescaling the time t  →  κC1V2t, a simple transformation gives us the equivalent form

[formula]

with the only dimensionless parameter [formula]. We will now focus on Eq.([\ref=ovmm]), where sn is dimensionless. The change of variable and the scaling away of the dimensions not only tells us that seemingly different driving behaviors are actually equivalent, it also makes the symmetry of ODE's in Eq.([\ref=ovmm]) explicit. One should note by definition a physical hn, which is always positive, can lead to negative sn depending on the parameters in Eq.([\ref=ovf]). Linear analysis leads to a stable phase of sn = s0 against small perturbation, and the spinodal line (or the neutral stability line) is given by

[formula]

In the regime [formula], a small perturbation to a uniform headway s0 with sn(t  →  0) = s0  +  δsn leads to sn(t  →    ∞  ) = s0, so this regime is linearly stable. The uniform headway solution is the ground state defined in Sec. [\ref=sec_model]. Note Eq.([\ref=linear]) is only exact in the limit when the perturbation goes to zero; close to the spinodal line, the uniform headway configuration is metastable, a large enough perturbation will also lead to the formation of clusters.

We now show that the coexistence curve that separates the metastable phase and the absolutely stable phase can be numerically obtained from the cluster structure. Firstly, in the regime |s0| < sc1, it is well known that small perturbations will grow in time with the formation of clusters, as shown in Fig.([\ref=singlepeak]), where a random initial condition settles into a configuration with the majority number of vehicles having two extremum headways given by ±  sc2. As smaller sn implies higher physical vehicle density, vehicles with headway - sc2 form clusters or jams of very high density with minimal velocity, while vehicles with headway sc2 moves with very high velocity, forming anti-clusters. Interestingly like sc1, the numerical value of sc2 only depends on κ0 but not on s0, so the cluster structure is unique once the parameters in the model is fixed.

Secondly the number of vehicles involved in the "kink" or "anti-kinks" are independent of s0 and the total number of vehicles N. A "kink" is the "go front", or the transition region from a cluster with sn  ~   - sc2 to an anti-cluster with sn  ~  sc2, while an "anti-kink" is the "stop front", or the transition region from an anti-cluster to a cluster. Thus for large N we can ignore vehicles in the "(anti-)kink", and the number of vehicles in the cluster is given by

[formula]

Clearly for s0  ≥  sc2, no clusters can be formed, given random initial perturbations of any magnitude, as long as [formula]. Similarly, no anti-clusters can exist for s0 <  - sc2. We thus identify sc2 as the coexistence curve [\cite=kerner] [\cite=yu] [\cite=naka] and plot it together with sc1 in Fig.([\ref=singlepeak]). The numerically calculated coexistence curve and the spinodal line coincides at the critical neutral stability point located at s0 = 0,κ = 2, agreeing with the previous analysis[\cite=nagatani] [\cite=xue]. Note that sn can be negative, and the physical vehicle density is calculated from the model parameters C1 and C2. There is also a duality between s0  ↔   - s0, where clusters at s0 corresponds to anti-clusters at - s0, and all behaviors at s0 are identical to those at - s0. This symmetry is entirely due to the fact that the RHS of Eq.([\ref=ovmm]) is odd. In the more general model of Eq.([\ref=meq2]), this duality can be broken and it is thus not universal.

Progresses have been made in treating non-linear ODE describing car-following models analytically[\cite=nakashini] [\cite=yokokawa1] [\cite=naka] [\cite=nagatani]; For Eq.([\ref=ovmm]) it is generally accepted that one can do a controlled expansion near the critical neutral stability point and close to the neutral stability line; the former leads to the modified KdV equations plus correction terms, that gives the approximate "(anti-)kink" solutions; the latter reduces the original model to the KdV equations plus corrections that give rise to soliton solutions[\cite=kurtze]. However, away from the neutral stability line, it is clear from the numerical calculation that if one makes the vehicle index continuous, the transition between the two extremum headways is discontinuous and analytically intractable.

One can, however, show that the "kink" and "anti-kink" of a single cluster move at the same velocity, by taking [formula]. For the "kink", the [formula] vehicle is located in the cluster, while the [formula] vehicle is located in the anti-cluster. From Eq.([\ref=ovmm]) we have

[formula]

The relevant set of solutions is s = 2 tanh (sc2)t + C, where C is an unimportant constant of integration. This gives the velocity of the "kink" as the number of vehicles per unit time as follows

[formula]

The velocity of the "anti-kink" is calculated similarly, thus vk gives the velocity of the cluster, which again is independent of the vehicle density of the traffic lane. Here we make the assumption that for vehicles far away from the "kink" or the "anti-kink", their headway takes the value of ±  sc2. More importantly, if we concatenate two clusters together, as long as the assumption holds (e.g. when the two clusters are far away), they will move at the same velocity and will never merge.

One interesting universal aspect of the OV models is the non-trivial probability distribution of the number of cluster formations, when the ground state is randomly perturbed. One might expect that a random initial state like the inset of Fig.([\ref=singlepeak]) should lead to a random number of clusters[\cite=zhang], at least in the limit of large N, subjecting to the constraint of Eq.([\ref=jnumber]). However, our numerical results show that the probability distribution of the number of clusters is not random; it strongly depends on the initial headway s0 and κ0. An example of the probability distribution is calculated and presented in Fig.([\ref=probability]), by fixing the strength of the initial random perturbation and κ0 in Eq.([\ref=ovmm]), and only vary the initial headway s0. For each value of s0, sufficiently large number of random initial states are generated until the probability for each number of clusters converges.

A few comments are in order here before we give a proper explanation. In Fig.([\ref=probability]) we only plot the part where s0 is negative, because the probability distribution is identical for s0 and - s0. For |s0| > 0.87 we can see the final state is dominated by the one-cluster configuration, and this is true even for an infinitely long traffic lane as N  →    ∞  ; in this case, most probably one very large cluster develops, instead of several clusters with smaller lengths. As |s0| decreases, the probability of having more than one cluster increases, and for |s0| < 0.82, it is almost impossible to have just one cluster. As |s0| further decreases towards zero, the average number of clusters most probably will tend to infinity. This cannot be observed numerically for a finite number N, since at s0 = 0 the total number of vehicles in the clusters is ~  N / 2(see Eq.([\ref=jnumber])).

To understand the probability distribution of the number of clusters, we characterize quantitatively the strength of interaction between two clusters by the time it takes for them to merge. It is useful to plot dsn / dt instead of sn as a function of the vehicle index n. The "kinks" and "anti-kinks" lead to exponentially localized "quasisolitons" of opposite charges (see Fig.([\ref=interaction])), which closely resemble the "autosolitons" in dissipative non-linear systems[\cite=book]. When quasisolitons of opposite charges annihilate each other, two clusters or anti-clusters merge into one. We numerically observe that the time needed for annihilation, ta, increases exponentially with the number vehicles n between the peaks of these two quasisolitons, giving the relationship

[formula]

One thus note that when |s0| increases, the cluster (for s0 > 0) or the anti-cluster (for s0 < 0) region gets narrower(see Eq.([\ref=jnumber])), leading to higher probability of short distances between quasisolitons. Thus the probability of having multiple (anti-) clusters is suppressed, as shown in Fig.([\ref=probability]). The intrinsic "scale" n0 in Eq.([\ref=ta]) depends on sc2 or κ0, which is also plotted in Fig.([\ref=interaction]). This is analogous to the interaction and collapsing of kinks and anti-kinks in the Ginzburg-Landau theory[\cite=rougemont], though here the total number of vehicles in the cluster has to satisfy Eq.([\ref=jnumber]), so that at least one cluster will remain for a finite system with periodic boundary condition. Thus the greater the intrinsic scale, the stronger the interactions between the quasisolitons, so this scale can be used to quantify the absolute value of the quasisoliton charge. The interaction leads to merging of clusters, reducing the probability of having multiple clusters in the traffic lane. Fig.([\ref=probability]) will look qualitatively the same if the x-axis is replaced with increasing sc2. The dependence of average number of clusters as a function of s0 and sc2 are plotted separately in Fig.([\ref=average]), numerically supporting the above explanation[\cite=comment1].

One should note that the symmetry smax =  - smin = sc2 is a result from the fact that the RHS of Eq.([\ref=ovmm]) is odd in sn. This symmetry forbids us to tune the corresponding hmax and hmin independently. The symmetry could be broken when V(k)op, or additional terms from [formula] in Eq.([\ref=meq2]) contains components that are even in sn. In these cases, all three emergent quantities smax,smin (or the physical headways hmax,hmin) and n0 can be tuned freely with the parameters in the model, providing the necessary degrees of freedom in Sec. [\ref=sec_algorithm] to capture the empirical features in Sec. [\ref=sec_empirical].

Understanding the multicluster solutions and the physical significance of the intrinsic scale n0 is important in explaining some of the essential features of the traffic dynamics. While spatially random perturbations grow and interact with each other in the metastable and linearly unstable region and eventually form very wide clusters corresponding to the large moving jams, physically n0 characterizes the time scale over which the intermediate transient states can last, as well as the width of the narrow jams that can be detected by the actual measurement. Numerical calculation also shows n0 can be used to tune the maximum acceleration that would normally occur in the congested traffic (which is much smaller than the physical limit of the acceleration of the actual vehicle), making it an important parameter in tuning the effective model.

Algorithm for tuning the traffic model

We will now proceed to construct the simplest effective model, or the minimal model for the real traffic dynamics, that can capture what we observe in Sec. [\ref=sec_empirical]. The discussions in Sec. [\ref=sec_property] is universal, and for a general model given by Eq.([\ref=meqn]), there are also three emergent quantities hmax,hmin and n0. Physically, n0 also controls the maximum acceleration in the congested traffic, and the interaction between clusters is crucial for the time scale of the evolution of the wide moving jams. We make the following assumptions to start with the simplest possible model from Eq.([\ref=expansion]):

Only the linear order of [formula] is kept. The model is thus reduced to Eq.([\ref=meq2]).

In Eq.([\ref=meq2]) we make both κ1 and g independent of the headway hn, so the only headway dependence is within V(k)op.

We assume f0 decreases monotonically with respect to increasing vn for any hn at Δvn = 0, thus there is only one V(k)op.

Following assumption c) we remove the subscript (k) in Vop. Assumptions in a) and b) are simplifications of the exact model, which can only be justified if vn - Vop is small compared to Vmax, and both κ1 and g depend weakly on hn throughout the time evolution of the traffic dynamics. If we only keep the linear order in Δṽn in our expansion and the expansion coefficient independent of hn, the resulting model is the full force velocity model[\cite=JiangR_PRE01]. It does not however contain enough degrees of freedom to capture all the empirical features in Sec. [\ref=sec_empirical], because of the symmetry [formula] (see Sec. [\ref=sec_property]). One can either make the coefficient of expansion dependent on hn, or keep the higher orders in ṽn. For simplicity we choose the latter option. Here we postulate the empirical features in Sec. [\ref=sec_empirical] can be universally captured by the three emergent quantities of the general traffic models; the simplifications we undertake only remove non-essential microscopic details we are not prepared to capture.

We use the well-studied A-5 North German Highway from Kerner[\cite=kernerexp1] as an example. Tuning the model only requires the information from the flow-density plot, which consists of the free flow part (where the flow depends approximately linearly on the density), the congested part (with a collection of randomly scattering data at higher density with suppresed flow) and the wide moving jam given by the "J line". The list of statistically robust quantities from the flow-density plot we use are:

[formula]

Here [formula] is the critical density of the highway at which [formula], the maximum flow, is observed. Qdj and ρdj are the flow and density downstream of the wide moving jam respectively, while ρj is the density within the jam. For the lack of the raw traffic data, all the numerical values are rough estimates only, and for our purpose of illustration that is sufficient, as we do not need to fine-tune the model to simulate the qualitative empirical features. We also assume on average the length of the vehicle lc = 5m, and by identifying the parameters of the cluster structure with the characteristic parameters of a wide moving jam we have the following relationship:

[formula]

The two other characteristic velocities from the flow-density plot are [formula], the velocity of the downstream front of a wide moving jam, and [formula], the velocity of the downstream front between [formula] and Qdj. The cluster parameters are given by hmax  =  ρ- 1dj - lc,hmin  =  ρ- 1j - lc,hcr  =  ρ- 1c - lc.

The simplest form of Vop has been suggested in[\cite=helbing6] for its analytic tractability; it however does not capture the correct fundamental diagram in the free flow phase. Here we solve Eq.([\ref=relationship]) most simply with a piecewise function passing through [formula] and bounded at Vmax, so as to fix the quantitative features of the real traffic dynamics[\cite=footnote2] in the free flow phase. Defining [formula] we have:

[formula]

Thus the fundamental diagram is defined by Vop (see Fig.([\ref=fig2b])), capturing the quantitative features of the empirical flow-density plot. The next step is to tune κ0 and [formula] so that the cluster solutions have the desirable hmax,hmin and n0. We adopt the reasonable assumption that the maximum acceleration for the vehicles in the stop-and-go wave should be within the range of ±  3ms- 2. Small variations around this quantitative assumptions do not qualitative alter the arguments and conclusions in this paper. Given that three parameters need to be fixed, [formula] has to be non-linear and contain terms that are even in Δvn to break the symmetry of smax =  - smin (see Sec. [\ref=sec_property]). We choose to simply adopt the AFVD model[\cite=GLW_PhyA08] (in the case where λ2  ≠  0) as follows

[formula]

The effective model is now completely defined, and with numerical calculations the fitted parameters are κ0 = 0.1s- 1,λ1 = 6.2 and λ2 =  - 2.9, corresponding to hmin  ~  3m and hmax  ~  52m.

A summary of our algorithm is in order. The optimal velocity function we chose defines the fundamental diagram: it gives the correct maximum average velocity of the traffic system (when the density of the traffic on the highway is very small). It also gives the right (ρdj,Qdj) and [formula] pairs on the flow-density plot, where the traffic is still in the free flow phase. In addition, it gives the maximum density ρj of the traffic. While these are just some of the special points on the flow density plot, the tuning of the other parameters in the model (κ0,λ1,λ2) makes sure (Qdj,ρdj) corresponds to the characteristic flow and density downstream of a wide moving jam, and ρj corresponds to the density within a wide moving jam. In addition, it also makes sure the acceleration of vehicles in congested traffic is physically reasonable.

The parameters in the model all have very clear physical meanings; the general features of the optimal velocity function is also quite intuitive. Both [formula] and [formula] are not smooth, which is not physical. They are, however, just unimportant artifects of the model that can be easily (but tediously) removed mathematically without affecting any of the conclusions or the predictive powers of the model. One should note that the optimal velocity function and the parameters in the model do not explicity tell us about the transition from the free flow to the congested flow, or the maximum flow that can be achieved, as well as the qualitative features of the complex spatiotemporal patterns. All these features will be predicted by the dynamics of the model which we will show in the following section.

Predictions of the effective model

We now proceed to examine what the minimal model predicts about the traffic dynamics. Given the parameters in the model, the free flow in the stable phase is given in the region [formula]. The metastable region is given by [formula]. In this region, a large enough perturbation will grow in time and leads to the instability of the free flow and formation of the jams. The empirical feature that the free flow persists up to the critical density ρc  ~  30veh / h is nicely predicted by the fact that for the metastable region with density smaller than ~  30veh / h, the perturbation needs to be greater than the average vehicle headway for the free flow to be unstable (see Fig.([\ref=fig2b])), which is unlikely without collisions. Thus the effective model captures [formula] and ρc quite accurately, even though Eq.([\ref=piecewise]) in no way guarantee the stability condition agreeing with the empirical data.

To study the congested traffic and the evolution of the wide moving jams, both periodic boundary condition of a single homogeneous lane and open boundary condition of a single lane with the presence of an on-ramp bottleneck are simulated. For periodic boundary conditions, the initial condition is chosen to have random fluctuations of the headways with different average density. Though in the long time limit wide moving jams eventually form for average density [formula], the intermediate process can be quite complicated. When the average density is very close to the phase boundary, or the coexistence curve given by [formula], very large perturbations are needed to nucleate a wide moving jam via the well-known "boomerang" behavior[\cite=helbing1] [\cite=kernerbook]; when the average density increases further, the "pinch effect"[\cite=kernerbook] is observed at multiple locations leading to multiple narrow jams; at high density numerous narrow jams form relatively quickly, and over time these narrow jams interact and merge into a few wide moving jams (see Fig.([\ref=fig3b])).

While the "pinch effect" and the formation of numerous narrow jams are well-known in the literature[\cite=kernerbook], the existence of the "boomerang" behavior is still debated[\cite=kernerbook] [\cite=helbing1]. The absence of "boomerang" behavior may also due to the rarity of very large perturbations on a multi-lane highway, when accidents and bottlenecks are absent. Even for moderately large perturbations, it takes more than an hour for a closed traffic system to develop the "boomerang behavior". One should also note that based on the numerical simulation, it takes 30  ~  60 minutes for the wide moving jams to eventually emerge from a random initial condition via complex intermediate states. Thus comparing numerical results with a fixed number of vehicles and periodic boundary condition to the empirical observations can be extremely tricky. The real world traffic, being an open system, does not maintain its vehicle density and the total number of vehicles over an extended period of time; variation of the average density within the metastable/unstable region leads to a mixture of long lasting intermediate states, numerous narrow jams and occasional wide moving jams.

From both the empirical validation and transportation engineering points of view, numerical simulations of the effective model in the presence of bottlenecks are more crucial. In our simulation with open boundary condition the virtual sensor measures the flow and average velocity of the passing vehicles in exactly the same way as the traffic sensors installed in the real world highways[\cite=helbing2]. We use the idealized initial condition with a constant main traffic flow Qm and an on-ramp flow Qin. At low enough Qin the free flow is maintained, though in the linearly unstable region the on-ramp flow has to be close to zero. When Qin increases, corresponding to the increase in the bottleneck strength, the congested flow develops immediately upstream of the bottleneck. This region with length Lc share the characteristics of the "synchronized flow" (see Fig.([\ref=fig2b]), Fig.([\ref=fig3b])). Narrow jams form upstream of the congested flow, and wide moving jams appear upstream of these narrow jams from merging of the narrow jams and the "pinch effect". The "boomerang" behavior is also observed (see Fig.([\ref=fig3b]h)). The congested flow can be either spontaneous or induced by a passing wide moving jam. In general, Lc can be as long as 4km and decreases with the increase of Qin.

Previous GM based models were criticized in [\cite=kernerbook] based on some fundamental empirical observations of the congested phase at the bottleneck, as well as on the absence of the homogeneous congested traffic (HCT) empirically. In contrast, the effective model we constructed agrees with the empirical observation that increasing the bottleneck strength leads to higher frequency of moving jam emergence and smaller Lc (see Fig.([\ref=fig4b])). In fact this is the most common situation for various different Qm. Numerical calculations also show the metastable phase in the high density region is very narrow. The model actually predicts complicated spatio-temporal structures for the congested traffic at very high density, with traffic flow fluctuate between zero to 500 veh / h, agreeing with the empirical observation in[\cite=kernerbook]. This is simply because small perturbation is linearly unstable even in the region of vehicle density up to ~  100veh / km.

Summary and Outlook

In summary, we have presented a systematic way of constructing traffic models that in principle can capture all the empirical features for which stochasticity as well as diversity in drivers and vehicle types do not play a fundamental role; only the averaged non-linear interaction between the vehicles is fundamental. The exact form of the traffic model given by Eq.([\ref=meqn]) can be obtained by the empirical measurement. In the case that the model is analytic, one should obtain various effective models by expansions around the ground states defined in Sec. [\ref=sec_model]. The compromise between keeping the model simple and capturing more microscopic details can now be done in a systematic way by choosing the appropriate set of parameters to average over, and by making various approximations in the expansions.

In addition, we proposed a simple algorithm to justify the approximations we made by expanding the traffic model around a unique ground state. The resulting minimal effective model shows that the physics of many empirical observations of the highway traffic dynamics can be captured by a deterministic effective model based on a simple optimal velocity function we proposed. In this framework the congested traffic is characterized by long lasting transient states of the model, from which the wide moving jams evolve from the "pinch effect" or the merging of the narrow jams. Interestingly, our results imply it is probably difficult to distinguish between real traffic dynamics and those from identical autonomous vehicles with simple driving rules based on the empirical data, including the flow-density plot and the congestion patterns near the bottlenecks. One should note that even deterministic models can simulate seemingly unpredictable dynamics because in reality the initial condition can be random and the highway traffic is an open system.

While the minimal effective model we constructed give convincing evidence that many complex traffic dynamics can still be explained solely by the simple interactions between nearest neighbour vehicles, we would not expect the model to explain all the interesting empirical features[\cite=helbing]. With more advanced techniques in collecting and analyzing empirical data, more empirical features can be properly defined, and we would expect to relax certain assumptions in our effective model(see Table. [\ref=tt]) to capture those features. One should note that the optimal velocity model class emerge naturally from an analytic traffic model, though such model can still be complicated if there is more than one ground state for a fixed average density. This, together with the possibility that the model could be non-analytic within certain density range, can justify the parameter rich "three-phase models" from a more fundamental ground. A long term, microscopic measurement of the vehicle acceleration as a result of the interaction between its close neighbours under diverse environmental settings is currently work in progress. The empirical data, together with proper averaging, should be able to give us Eq.([\ref=meqn]) and thus provide insight on which effective model is more consistent with the nature.