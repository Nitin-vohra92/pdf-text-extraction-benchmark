Lemma Claim Corollary Conjecture Definition

Quantitative (p,q) theorems in combinatorial geometry

Introduction

Helly's theorem is a central result regarding the intersection structure of convex sets. It says that a finite family of convex sets in [formula] is intersecting if and only if every subfamily of cardinality d + 1 is intersecting [\cite=Helly:1923wr]. Among the many generalizations and extensions of Helly's theorem (see, for instance, [\cite=Danzer:1963ug] [\cite=Eckhoff:1993uy] [\cite=Matousek:2002td] [\cite=Wenger:2004uf] [\cite=Amenta:2015tp]), a crowning achievement of combinatorial convexity is the proof of the (p,q) theorem by Alon and Kleitman, answering positively a conjecture by Hadwiger and Debrunner [\cite=Hadwiger:1957we].

The (p,q) theorem has a rich history of variations and generalizations as well, described in the survey [\cite=Eckhoff:2003ed]. Newer results include a version for set systems of bounded VC-dimension [\cite=Matousek:2004cs], colorful and fractional versions [\cite=Barany:2014bp] or versions with the intersections being restricted to be in certain curves [\cite=Govindarajan:2015ir]. It should be noted that even though there are plenty of results regarding existence of (p,q) theorems, finding efficient bounds for c(p,q,d) remains an extremely difficult problem.

Recently, there have been developments regarding versions of Helly's theorem which work if we additionally require the condition that the intersection of the convex sets is quantitatively large. This could mean, for example, that it contains many points from a certain discrete subset S of [formula] or that it has a large volume.

The first results of this kind were given by Bárány, Katchalski and Pach [\cite=Barany:1982ga] [\cite=Barany:1984ed]. They proved that given a finite family F of convex sets in [formula], if the intersection of every 2d of them has volume at least one, then [formula]. This has been recently improved by Naszódi to conclude [formula] for some absolute constant c > 0 [\cite=Naszodi:2015vi]. The result does not hold checking subfamilies of size 2d - 1. Optimizing over the volume guaranteed in the conclusion instead of the size of the families needed to be checked, the following version of Helly's theorem was obtained.

The quantity [formula] is closely related to results of approximation of convex sets by polytopes with few facets. Due to the lower bounds in this theorem, it is impossible to obtain a result with [formula] in the conclusion, regardless of the size of the subfamilies we are willing to check.

For discrete functions over the convex sets, such as counting the number of integer points, there are also Helly-type results. The first of this kind was presented by Doignon.

This result was rediscovered several times [\cite=Bell:1977tm] [\cite=Scarf:1977va] [\cite=Hoffman:1979ix]. Doignon's theorem has a quantitative generalization [\cite=Aliev:2014va]. Aliev et. al. showed that there is a constant c(k,d) such that for any finite family of convex sets in [formula] such that the intersection of every c(k,d) of them contains at least k points with integer coordinates, the intersection of the whole family contains at least k points with integer coordinates.

Recall that a set [formula] is said to be discrete if every point [formula] has a neighborhood such that x is the only point of S within it. For any discrete set S, we can consider versions of Helly's theorem for S, and in particular can consider quantitative Helly numbers, defined as follows.

For a discrete set [formula], we define the k-quantitative Helly number [formula] as the smallest number for which the following statement holds. For any finite family F of convex sets in [formula] such that for every subfamily F' of cardinality [formula] or less we know that [formula] has at least k points of S, then [formula] contains at least k points of S. If no such number exists, we consider [formula].

An example of a large family of sets S with finite [formula] for all k is the following. Let L be a lattice in [formula] and [formula] be sublattices. If [formula], then [formula] [\cite=DeLoera:2015wp]. For the case where S is the integer lattice, better bounds are found in [\cite=Aliev:2014va].

The aim of this paper is to show a general quantitative version of the (p,q) theorem - in particular, one that captures the behavior of continuous functions as well as discrete functions over the convex sets in [formula]. In Theorem [\ref=theorem-general-quantitative-pq] we show a general set of conditions that a function [formula] must satisfy in order to give a (p,q) theorem, where Cd refers to the family of convex sets in [formula]. In particular, we prove that the functions [formula], the surface area, and [formula] satisfy the conditions, where S is any discrete set with finite Helly numbers. Namely, we obtain the following corollaries.

Let S be a discrete subset of [formula] and k be an integer such that [formula] is finite. Let [formula] be positive integers. Then, there is a constant c = c(p,q,k,S) such that the following is true. For any finite family F of convex sets in [formula], each containing at least k points of S and such that for every p sets in F there are q whose intersection contains k points of S, we can find c sets [formula], each containing k points of S, such that every F∈F contains at least one Ki.

Given a positive integer d and 1 > ε  >  0, there is a constant n(d,ε) such that the following holds. Let p  ≥  q  ≥  n(d,ε) be positive integers. Then, there is a constant [formula] such that the following is true. For any finite family F of convex sets in [formula], each of volume at least one and such that for every p sets in F there are q whose intersection has volume at least one, we can find [formula] convex sets [formula], each of volume 1 - ε, such that every F∈F contains at least one Ci.

Given a convex set [formula], let [formula] be its surface area. Given a positive integer d and 1 > ε  >  0, there is a constant n2(d,ε) such that the following holds. Let p  ≥  q  ≥  n2(d,ε) be positive integers. Then, there is a constant [formula] such that the following is true. For any finite family F of convex sets in [formula], each of surface area at least one and such that for every p sets in F there are q whose intersection has surface area at least one, we can find [formula] convex sets [formula], each of surface area 1 - ε, such that every F∈F contains at least one Ci.

For every fixed d, the quantity n(d,ε) of Corollary [\ref=theorem-vol-pq] is [formula]. For d = 1, it is a simple exercise to show that the classic (p,q) theorem implies Corollary [\ref=theorem-vol-pq], with [formula] for all i. For the quantity n2(d,ε) in Corollary [\ref=theorem-surface], we do not have explicit asymptotic bounds.

The case k = 1, [formula] of Corollary [\ref=theorem-quant-pq] has already been proven [\cite=Alon:1995fs]. Moreover, a surprising result is an improvement by Bárány and Matouek [\cite=Barany:2003wg]. They showed that the condition needed on p,q is only p  ≥  q  ≥  d + 1, while [formula]. However, it seems that one of their key ingredients [\cite=Barany:2003wg] fails when k  ≥  2. The fractional Helly theorems of Averkov and Weismantel [\cite=Averkov:2010tv] and the methods below show that we can relax the condition to p  ≥  q  ≥  d + 1 if k = 1 as long as [formula] is finite. Moreover, if k = 1, the condition of S being discrete can be replaced by asking S to be closed.

A key step for Corollaries [\ref=theorem-vol-pq] and [\ref=theorem-surface] is the existence of a "floating body". These floating bodies are extensions for arbitrary functions of the definition introduced in [\cite=Schutt:1990tj], where they are developed for the volume. This concept allows us to prove general forms of the fractional Helly theorem. It should be pointed out that these methods do not work for all functions, in particular the diameter does not satisfy the required conditions. The floating bodies we discuss also allow us to prove general quantitative versions of the colorful Helly theorem by Lovász, whose proof appeared in a paper by Bárány [\cite=Barany:1982va]. In particular, they work for the surface area and volume. The case of the volume was already known [\cite=DeLoera:2015wp], with an essentially different proof.

The paper is organized as follows. In section [\ref=section-strong] we state the general (p,q) theorem, the conditions needed for it and prove the result. In section [\ref=section-fractional-both] we give exhibit a class of functions that satisfies the conditions stated in section [\ref=section-strong]. This includes volume, the surface area and the number of points from a discrete set. Using the same methods of section [\ref=section-fractional-both], we provide a general set of properties needed to prove quantitative version of the colorful Helly theorem in section [\ref=section-colorful-volumetric]. In section [\ref=section-remarks] we include some remarks and open problems.

General quantitative (p,q) theorem

Let [formula] and Cd be the family of convex sets in [formula]. We wish to determine which functions [formula] allow for a quantitative (p,q) theorem. We say that a function [formula] is monotone if A  ⊂  B implies f(A)  ≤  f(B). During the rest of the paper we assume that the functions we work with are monotone. The main three ingredients we need are that f can be approximated by circumscribed polyhedra, that f can be approximated by inscribed polytopes and a fractional Helly theorem. We define these three porperties below. The first two conditions are directly related to the approximation of convex sets by polytopes, we recommend the surveys [\cite=Bronstein:2008dn] [\cite=Gruber:1993gj] for this subject.

Regarding the existence of approximations by circumscribed polyhedra, we can state a condition in terms of Helly-type theorems.

We say [formula] admits a Helly theorem if given 1 > ε > 0 there is an integer H(f,d,ε) such that for any finite family F and λ > 0, if every subfamily F' of cardinality at most H(f,d,ε) satifies [formula], then [formula].

It was shown in [\cite=Amenta:2015tp] that those functions which allow for approximations by circumscribed polyhedra always admit a Helly theorem. Namely, it is sufficient to know that for every convex set K with f(K) <   ∞  , there is a polyhedron P such that

K  ⊂  P,

P has a bounded number of facets in terms of d,ε, and

f(K)  ≥  (1 - ε)f(P).

If f is the indicator of the property "being non-empty" in Definition [\ref=definition-helly], we recreate Helly's original result. The results needed for the volumetric version are stated precisely in [\cite=Anonymous:HS2Q-kvJ], which give approximation estimates based on the Nikodym metric. For the surface area, it suffices to use a compactness argument similar to that we will use in section [\ref=section-fractional-both]. For the indicator of "containing a set of k points from a set S", the definition of [formula] is precisely the Helly theorem (with ε  =  0). Another equivalent formulation for this property is with the function [formula] and the hidden constant being k, and ε = 0. In addition to the work in [\cite=DeLoera:2015wp], previous quantitative Helly-type results for continuous functions existed with contraction and expansion of convex sets [\cite=Langberg:2009go].

The next ingredient is that f can be approximated by inscribed polytopes.

We say [formula] can be approximated by inscribed polytopes if for every 1 > ε  >  0 there is a constant C(f,d,ε) such that for every ∞    >  λ  ≥  0 and every convex set [formula] with f(K)  ≥  λ, there is a polytope [formula] such that

P  ⊂  K,

P has at most C(f,d,ε) vertices, and

f(P)  ≥  (1 - ε)λ.

For example, very precise estimates exist for [formula] [\cite=Gordon:1995kn] [\cite=Gordon:1997wi], giving [formula] for some absolute constants c for an upper and lower bound. For the indicator of "having at least k points of S", one gets trivially C(f,d,0)  =  k. For the surface area, again a compactness argument as in section [\ref=section-fractional-both] is sufficient, although it does not yield explicit bounds.

The methods in [\cite=DeLoera:2015wp] also show that this kind of approximation is closely linked to the existence of colorful Carathéodory theorems, as in [\cite=Barany:1982va]. This comes as no surprise since Carathéodory's theorem is the natural dual of Helly's theorem, and these approximations are duals to the ones needed for Helly-type theorems. We will be using the approximations as above in combination with the following result.

The colorful Carathéodory theorem comes when we use the theorem above with the polytope from Definition [\ref=definition-caratheodory] when f(  ·  ) is the indicator of the property "contains the origin" (note that C(f,d,0)  =  1 in this case). This has also been studied for instance for [formula], where [formula] is the Euclidean ball of radius λ centered at the origin [\cite=Kirkpatrick:1992ex] [\cite=DeLoera:2015wp]. These are often referred to as quantitative Steinitz results, which were also pioneered by Bárány, Kathalski and Pach [\cite=Barany:1982ga]. If one changes the unit ball by an arbitrary centrally symmetric set, approximations reducing the Banach-Mazur distance, such as [\cite=Barvinok:2014fx], come into play.

The final ingredient is a fractional Helly theorem.

We say [formula] admits a fractional Helly theorem if, given 1 > ε > 0, there is an integer F = F(f,d,ε) such that for any α > 0 there is a β  =  β(α,f,d,ε) > 0 such that the following holds. Given any finite family F of convex sets in [formula], if there are at least [formula] subsets A  ⊂  F of cardinality F that satisfy [formula], there is a subset F'  ⊂  F of cardinality at least β|F| such that [formula].

We should emphasize that it is not immediate that a Helly theorem implies a fractional Helly theorem, or vice-versa. In particular, for the volumetric version of the (p,q) theorem we present, the fractional Helly we prove has a larger bound for [formula] than [formula].

Given a finite family of convex sets in [formula] of volume at least one, if we make a simplicial complex by taking a vertex for each set and a face for each subfamily whose intersection has volume at least one, there is no indication that the resulting complex is d'-collapsible or even d'-Leray for some d' depending on d. In other words, the machinery developed by Gil Kalai to obtain fractional Helly results cannot be applied directly [\cite=Kalai:1984isa] [\cite=Kalai:1986ho]. For a deeper discussion of the relation of topological properties of nerve complexes and Helly theorems, we recommend [\cite=Tancer:2013iz].

The most compelling cases are those for which F(f,d,ε)  ≠  H(f,d,ε). One instance where this can be observed is when f is the indicator of the function "contains a point with integer coordinates", where Bárány and Matouek showed that the fractional Helly number is d + 1, while the Helly number is 2d [\cite=Barany:2003wg]. Other examples of this phenomenon include fractional Helly numbers for the property of "having a hyperplane transversal" [\cite=Alon:1995fs], or fractional Helly numbers for set systems with bounded VC-dimension [\cite=Matousek:2004cs]. In both cases there is no Helly theorem but there is a fractional version. We show a general way to obtain fractional Helly theorems, but the restrictions for the function increase.

For each of the definitions mentioned, we say f satisfies a sharp version of the result if it holds for ε  =  0. For instance, Doignon's theorem can be restated as [formula], with the hidden λ being one. Note that given a discrete set S, the function [formula] and λ  =  k would give the quantitative results for "having at least k points of S". This also sheds some light on why Helly-type results for functions that vary continuously such as the volume or diameter have a necessary loss ε while discrete functions, such as [formula] do not. For [formula], it suffices for [formula] to get that f(K)  ≥  (1 - ε)k implies f(K)  ≥  k, so n(f,d,ε)  =  n(f,d,0), so small values of ε are of no consequence.

Let [formula] be a monotone function that admits a Helly theorem, approximations by inscribed polytopes and a fractional Helly theorem. Then, given [formula], there is a constant c = c(f,p,q,d,ε) such that for any finite family F of convex sets in [formula], if out of every p elements of F there is a q-tuple A such that [formula], then there is a family T of at most c convex sets [formula] such that f(Ki)  ≥  1 - ε for each i and every set in F contains at least one set in T.

Moreover, if f admits sharp versions of the results mentioned, then we may take ε = 0 in this theorem as well.

The constant [formula] is completely arbitrary, and indeed any ε'  =  γε for some constant 1  >  γ > 0 would work (affecting the value of c, of course). However, with the constant shown we get corollaries [\ref=theorem-quant-pq], [\ref=theorem-vol-pq] and [\ref=theorem-surface].

In order to prove Theorem [\ref=theorem-general-quantitative-pq], we need new interpretations of results regarding the combinatorial structure of sets of points in [formula]. That is, given a family S of points in [formula], we are interested in the combinatorial properties of the family of the convex hulls of subsets of S. In particular, we need versions of Tverberg's theorem, Bárány's selection theorem and the existence of weak ε-nets for convex hulls.

These are classic results in combinatorial geometry. As we present them we mention some references for the interested reader. Each of these results could be seen as a counterpart for a Helly-type theorem. Indeed, both Helly's theorem and Tverberg's theorem aim to find intersecting families of convex sets. Both the fractional Helly theorem and Bárány's selection theorem aim to find a positive-fraction subfamily which is intersecting. Finally, both the (p,q) theorem and the existence of weak ε-nets aim to bound the piercing number of a family of convex sets.

We start with Tverberg's theorem.

We say [formula] admits a Tverberg theorem if, given 1 > ε > 0, there is an integer T(f,d,ε) such that for any positive integer m and any real λ > 0, given a family [formula] of n = (m - 1)T(f,d,ε) + 1 convex sets [formula] such that f(Ti)  ≥  λ for all i, there is a partition of T into m parts [formula] such that

[formula]

We should stress that the relevant feature of the definition above is that the number of sets needed to obtain a Tverberg partition is linear on the number of parts. That is the key that allows the next results to hold.

The classic result was proven by Tverberg in 1966 [\cite=Tverberg:1966tb], where f is the indicator function of "being non-empty", and T(f,d,0)  =  d + 1. The case m = 2 is known as Radon's lemma [\cite=Radon:1921vh]. Other quantitative versions of Tverberg's theorem exist [\cite=DeLoera:2015wp], but they are essentially different from the version presented here. Finding exact bounds for the case when f is the indicator function of "containing a point with integer coordinates" is a surprisingly resistant problem, even for m = 2 [\cite=Jamison:1981wz]. We show that a quantitative Helly and approximations by inscribed polytopes imply a Tverberg theorem.

Let [formula] be a monotone function that admits a Helly theorem and approximations by inscribed polytopes. Then, f admits a Tverberg theorem.

In order to prove the result mentioned, we will show the following. Given ε1,ε2∈(0,1) and a positive integer m, take

[formula]

Then, given a family [formula] of sets such that f(Ti)  ≥  λ for all i, there is a partition of T into m parts [formula] such that

[formula]

This will imply that f admits a Tverberg theorem. In particular [formula].

Given a family T as above, consider the family

[formula]

Note that each F∈F is missing at most (m - 1)d  ·  C(f,d,ε2) sets of T. Thus, any H(f,d,ε1) of them have at least one Ti in common, which means that their intersection has size at least λ under f. By the definition of H(f,d,ε1), there is a convex set T0 with f(T0)  ≥  (1 - ε1)λ contained in [formula].

Every closed halfspace that contains a point of T0 also contains points of at least (m - 1)d  ·  C(f,d,ε2) + 1 sets of T. If this was not the case, there would be a a point p∈T0 and closed halfspace containing p and points of at most (m - 1)d  ·  C(f,d,ε2) sets of T. This would contradict the fact that [formula]. In particular, we have [formula].

Now we construct [formula] inductively. By the definition of C(f,d,ε2), there we can find a set P  ⊂  T0 of cardinality at most C(f,d,ε2) such that [formula]. By the observation above, [formula].

If C(f,d,ε2)  >  1, by the quantitative Carathéodory theorem there is a set [formula] of cardinality at most d  ·  C(f,d,ε2) such that [formula]. For each point of U1, let us take one set of T that contains it, and form A1 in this way. Note that [formula] and |A1|  ≤  d  ·  C(f,d,ε2). By removing A1 from T, we have that every closed halfspace that contains a point of T0 also contains points of at least (m - 2)d  ·  C(f,d,ε2) + 1 sets of what is left of T. Thus, we can continue this process and generate the sets [formula]. In the end,

[formula]

Thus, the same holds for [formula], and since f is monotone we obtain the result.

If C(f,d,ε2)  =  1 we use the same inductive construction, but we have to take an additional precaution. Let {p}  =  T0. When we construct A1, we can take it to be minimal in cardinality. Thus, if |A1|  =  d + 1, we have that [formula]. This means that every closed halfspace that contains p in its boundary contains at most d points of A1. In other words, we can keep the reduction process as before.

Now we move on to the selection theorem. Our goal is to show that allowing approximations by inscribed polytopes and a Tverberg theorem is enough to obtain the result below.

Let [formula] be a monotone function that can be approximated by inscribed polytopes and let [formula]. We say f admits a selection theorem if for any 1 > ε > 0 there is a constant ρ(f,d,ε) such that for any λ > 0 and any finite family T of convex sets in [formula], if f(T)  ≥  λ for all T∈T, there is a convex set T0 with f(T0)  ≥  λ(1 - ε) contained in the convex hull of the union at least [formula] subsets A  ⊂  T of cardinality r(f,d,ε).

The original result by Bárány [\cite=Barany:1982va] is the case when f is the indicator function of the property "is non-empty". Even in this case, finding the optimal value of ρ is a remarkably difficult problem. The current best lower bound is [formula] [\cite=Gromov:2010eb]. We recommend [\cite=Karasev:2012bj] [\cite=Pach:1998vx] for further extensions and references of related results.

Let [formula] be a monotone function that admits a Tverberg theorem and approximations by inscribed polytopes. Then, f admits a selection theorem.

Take T a finite family of convex sets in [formula] with f(T)  ≥  λ for all T∈T. Since f admits a Tverberg theorem, there is a convex set U0 with [formula] and partition P of T into [formula] parts such that the convex hull of the union of each part contains U0.

By the definition of [formula], there is a polytope T0  ⊂  U0 with at most [formula] vertices such that [formula]. Color each part in P with a different color. Since the convex hull of the union of each part contains T0, by the quantitative colorful Carathéodory theorem, for each [formula] colors, there is a rainbow choice of subsets of T such that the convex hulls of the sets contains T0. In other words, the number of r(f,d,ε)-tuples satisfying the desired conditions is at least

[formula]

Using a selection theorem, we can show the existence of weak ε-nets for convex sets, similarly to [\cite=Alon:1992ek]. The goal now is, given a finite family T of large convex sets under f, to bound the quantitative equivalent of the piercing number for the family of sets generated by taking the convex hull of the union of many subsets of T. We say a set T pierces a family of sets F if every set in F contains a set in T. We use the selection theorem to construct a piercing set following a greedy algorithm.

Given [formula] and 1 > ε'  >  0, we say f admits bounded weak ε'-nets for convex sets if for every 1 > ε > 0 there is a constant m = m(f,d,ε,ε') such that for every λ > 0 and every finite family T of convex sets in [formula] with f(T)  ≥  λ for all T∈T, there is a family T0 of at most m convex sets in [formula] with f(T0)  ≥  (1 - ε)λ for all T0∈T0 such that for every subset A  ⊂  T of cardinality at least ε'|T|, there is at least one set of T0 contained in [formula].

We say that T0 is a ε'-weak net for the pair (T,ε) if it satisfies the conditions above.

If [formula] is monotone, can be approximated by inscribed polytopes and admits a selection theorem, then for any 1 > ε' > 0, it admits bounded weak ε'-nets for convex sets.

Given ε > 0, λ > 0 and a finite family T of convex sets in [formula] with f(T)  ≥  λ for all T∈T, we will construct inductively a weak ε'-net for the pair (T,ε).

Let [formula]. In order to construct a weak ε'-net T0, we start with T0 being the empty set. Let R be the number of r(f,d,ε)-tuples B  ⊂  T such that [formula] contains no set of T0. If there is a subset A  ⊂  T of cardinality at least ε'|T| such that the convex hull of its union contains no set of T0, then we can apply the selection theorem to A and find a convex set T0 with f(T)  ≥  λ(1 - ε) that is contained in the convex hull of the union of at least

[formula]

sets B  ⊂  A of cardinality r(f,d,ε). Thus, by adding T to T0, we are effectively reducing R by the quantity above. Thus, this cannot be done more than [formula] times, which gives the desired result.

With the existence of weak ε-nets, we are ready to prove the quantitative version of the (p,q) theorem. For this purpose, we need the following definitions.

Given a monotone function [formula], we define

[formula]

Given λ > 0 and a finite family F  ⊂  Cd, we define

Given λ > 0 and a finite family F  ⊂  Cd, we define the f-transversal number τ(f,λ)(F) as the minimum [formula] over all functions w:Cd(f,λ)  →  {0,1} such that

[formula]

for all F∈F.

Given λ > 0 and a finite family F  ⊂  Cd, we define the fractional f-transversal number τ*(f,λ)(F) as the minimum [formula] over all functions w:Cd(f,λ)  →  [0,1] such that

[formula]

for all F∈F.

Given λ > 0 and a finite family F  ⊂  Cd, we define the fractional f-packing number ν*(f,λ)(F) as the maximum [formula] over all functions w:F  →  [0,1] such that

[formula]

for all C∈Cd(f,λ).

Let [formula] be a monotone function that admits weak ε-nets for convex sets. Then, τ(f,1 - ε)(F) is bounded by a function that depends only on f,d,ε, and [formula].

Let [formula] be a function that realizes [formula], and write [formula]. Without loss of generality, we may assume that w has finite support and takes only rational values. Let M be the common denominator of w(K) for all [formula]. Let T be the family that is formed by the disjoint union of M  ·  w(K) copies of K, for each [formula]. Now consider K a weak [formula]-net for T, as in Definition [\ref=definition-weak-net-quant] (the hidden constant λ being equal to [formula]).

Notice that for each K∈K, we have that [formula]. Also, by the definition of τ*, for a set F∈F, there are at least [formula] sets in T contained in F. Thus, by the definition of K, there must be a set in K contained in F. This implies that the indicator function of K satisfies the conditions in the definition of τ(f,1 - ε)(F). Moreover, |K| depends only on r,f,ε, and d, as desired.

Let [formula] be a monotone function that admits a fractional Helly theorem and [formula]. Let F be a finite family of convex sets such that for every K∈F we have f(K)  ≥  1 and out of every p sets in F, there is a q-tuple A such that [formula]. Then [formula] is bounded by a function that depends only on f,p,q,ε, and d.

Let w:F  →  [0,1] be a function that realizes [formula], and write [formula]. We may assume without loss of generality that w(F) is rational for all F∈F. Let [formula] where M is the common denominator for all w(F) with F∈F. Let F' be a family consisting of NF copies of F for each F∈F, and N  =  |F'|. Note that [formula].

The family F' satisfies that out of every (p - 1)(q - 1) + 1 of its sets, there is a q-tuple A such that [formula]. This is because given (p - 1)(q - 1) + 1 sets of F', there are either q copies of the same set or at least p different sets of F. In either case, we have a q-tuple satisfying the property. Thus, there is a positive fraction of the [formula]-tuples of F' whose intersection A satisfies f(A)  ≥  1. By the fractional Helly theorem, there must be a set A0 with [formula] contained in at least βN sets of F'. In other words,

[formula]

This implies that [formula], and β is bounded by a function depending only on p,q,f,ε and d.

By linear programming duality, [formula]. Thus, using the lemmata [\ref=lemma-first] and [\ref=lemma-second], we have a bound on [formula] that only depends on p,q,f,d, and ε. Notice that a function that realizes [formula] is the indicator of the family T of sets we are looking for in the theorem, i.e. every set in T is large according to f, and every set in F contains a set in T.

Conditions for a fractional Helly theorem

In order to prove the Corollaries [\ref=theorem-quant-pq], [\ref=theorem-vol-pq] and [\ref=theorem-surface], it suffices to show that the volume, surface area and the indicator of having k points of S satisfy the desired properties. The first two conditions (admitting a Helly theorem and being approximable with inscribed polytopes) were discussed in section [\ref=section-strong]. Thus, it only remains to show the fractional Helly theorems. We do this in Lemma [\ref=lemma-fractional-general] below.

In order to prove this lemma we will use previous results regarding the convex floating body [\cite=Schutt:1990tj]. For a convex set K with finite volume, we define [formula] as the set of points x such that [formula] for all closed halfspaces H∋x. There are several results regarding the volume of the floating body [\cite=Barany:2010cy]. For sufficiently smooth bodies K of unit volume, we have

[formula]

where c is a constant depending only on the dimension (see [\cite=leich]). This result is described in [\cite=Barany:2010cy], where it is mentioned that it was proved by Buchta, Gruber and Müller but only appears as a private communication. The result holds for sufficiently smooth convex sets, and the constant c is maximized by ellipsoids. However, by standard approximation results, we can see that the bound above extends to all convex sets. The reason why this bound is presented for sufficiently smooth bodies is that in that case there is a matching upper bound.

Note that if K is a convex set of unit volume and K' is another convex set such that [formula], then [formula]. There is no reason why the floating body is unique to the volume, and indeed we can introduce the following definition

Given a monotone function [formula], we say that there is a floating body for f if for every 1  >  ε  >  0, there is a δ  =  δ(ε)  >  0 such that any convex set K with f(K)  <    ∞  , there is a convex set K(f,ε) such that

f(K(f,ε))  ≥  (1 - δ)f(K) and

for any convex set A, if [formula], then K(f,ε)  ⊂  A.

Morevoer, we require that δ(ε)  →  0 if ε  →  0. Throughout the rest of this section we will assume that f and d are fixed. Even though δ(ε) depends on them, it will be useful to denote it this way.

We first show how some general properties of f are enough to prove the existence of a floating body, which the reader can check are satisfied for the surface area. We then show how the existence of a floating body and a Helly theorem are enough to prove a fractional Helly theorem and a colorful Helly theorem.

We say a function [formula] is

homogeneous if there is a constant k such that for all α > 0, we have that f(αK)  =  αkf(K);

strictly monotone if f is monotone and for every convex set B with 0 < f(B)  <    ∞  , if A  ⊂  B is a convex set such that the closure of A is different from the closure of B, then f(A)  <  f(B);

well-defined, if [formula] and f(B)∈{0,  ∞  } for any unbounded convex set B.

Let [formula] be a continuous, strictly monotone, homogeneous, and well-defined function. Then, there is a floating body for f.

Note that our condition of continuity over convex sets is taken under the topology induced by the Hausdorff metric.

Since f is homogeneous, well-defined and continuous, it is enough to show the existence of floating bodies for sets K which are compact and contained in the closed ball of radius one around the origin. Let us show that for a fixed K there is a δ  =  δ(K,ε) and a floating body K' = K(f,ε) satisfying the conditions of Definition [\ref=definition-floating-body] with f(K')  =  (1 - δ(K,ε))f(K). We may assume that ∞    >  f(K)  >  0 without loss of generality.

For every direction v, consider a v-halfspace a set of the form [formula] for some real α, where 〈  ·  ,  ·  〉 denotes the usual dot propduct. Let H'v be the containment-minimal v-halfspace such that [formula]. Note that H'v exists and is unique since f is well-defined, strictly monotone, and continuous. We define [formula] and [formula].

Let K''  ⊂  K be any compact convex set such that f(K'')  =  1 - ε. If [formula], there must be a closed halfspace which strictly separates a point of K' from all of K''. However, if v is the direction defining this hyperplane, it would contradict K'  ⊂  H'v.

Let us show that δ(K,ε)  →  0 as ε  →  0. If this was not true, there would be an α > 0 such that δ(K,ε)  <  (1 - α)f(K) for all ε > 0. Since K(f,ε1)  ⊂  K(f,ε2) if ε1  >  ε2, we can consider the convex set [formula]. By continuity of f, we have that f(K0)  ≤  1 - α and K0  ⊂  K. Thus, since f is strictly monotone, there must be a v-halfspace H0 such that K0  ⊂  H0 and H0 does not contain the closure of K.

Let [formula]. It is clear that K0  ⊂  K1  ⊂  K, and the closure of K1 and K are different, so f(K1)  =  (1 - β)f(K) for some β  >  0. Notice then that [formula], contradicting the fact that K(f,β / 2)  ⊂  K0. Thus δ(K,ε)  →  0 as ε  →  0.

Let δ(ε) be the supremum of δ(K,ε) over all compact K with f(K)  ≤  1 contained in the closed unit ball centered at the origin. Let us show that δ(ε)  →  0 as ε  →  0. If this was not the case, there would be a sequence of pairs [formula] such that εn  →  0 and [formula]. However, since the space of sets we considered is compact under the Hausdorff metric, there would be a set K* such that Kn  →  K*. Since f is a continuous function and we are working with a compact metric space, it is uniformly continuous. Thus, we can use the constructed sequence to show that [formula] as n  →    ∞  , a contradiction.

Let [formula] be a well-defined, continuous, strictly monotone function that admits a Helly theorem and such that there is a floating body for f. Then f admits a fractional Helly theorem. Moreover

[formula]

where δ is the parameter induced by the floating body for f.

The reader may notice that any function that is well-defined, continuous and homogeneous allows for a Helly theorem, using a compactness argument such as the one in the last step of the proof above. The same argument also shows that f can be approximated by inscribed polytopes.

For a convex set K, we refer to f(K) as its size. In order to prove this lemma, it suffices to show that, given α > 0 and F a finite family of n convex sets in [formula], if an α-fraction of the H(f,d,ε)-tuples are intersecting, then there is a set of size at least 1 - δ(ε) contained in a positive fraction β of the sets in F. For simplicity, let h = H(f,d,ε).

We may assume that the sets in F are bounded. Let v be a direction. We consider a v-halfspace to be a set of the form {x:〈x,v〉  ≤  α} for some real α. For each (h - 1)-tuple [formula] such that [formula], let HB be the v-halfspace such that [formula]. We denote this intersection by KB.

Now consider an h-tuple A of F such that [formula]. Among its (h - 1)-tuples, there must be one, call it A', such that HA' is containment-maximal. It is clear that if we add HA' to A, in the resulting family the intersection of any h sets has size at least one. By the definition of h we have that the intersection of this whole family has size at least 1 - ε. However, this implies that the set not in A' contains KA'(f,ε).

For each h-tuple A such that [formula], let A' be one of its (h - 1)-tuple with containment-maximal HA'. If a positive fraction of the h-tuples satisfy the condition of the problem, then a simple counting argument shows that there must be an (h - 1)-tuple M which was assigned to at least βn different h-tuples, for some positive β not depending on n. Thus at least βn sets contain KM(f,ε), as desired.

The function [formula] admits a fractional Helly theorem. Moreover, for any fixed dimension d, we have that [formula].

The function [formula] admits a fractional Helly theorem.

It is clear that the surface area function is homogeneous and well-defined. It remains to prove that it is strictly monotone. Suppose that B0 is a convex set with [formula], and consider A  ⊂  B0 such that the closures of A and B0 are distinct. Then, there exists a point b of [formula] and a halfspace H such that A  ⊂  H and [formula]. Take [formula]. Note that the surface area of B1 is strictly less than that of B0.

If the closures of B1 and A are the same, then we are done. Otherwise, we define B2 from B1 similarly. By proceeding in this manner for n steps, we attain either Bn and A with the same closure or else Bn an arbitrarily good approximation of A, by a simple convexity argument. Because [formula] for every n, we conclude that [formula], as desired.

By contrast, the diameter function is not strictly monotone, and actually fails to have a floating body.

Let [formula] be a discrete set and k a positive integer such that [formula]. Then, the function f(  ·  ) which is the indicator of the property "having at least k points of S" admits a sharp fractional Helly theorem. Moreover, for any fixed dimension d, we have that [formula].

The proof is equivalent to the one of Lemma [\ref=lemma-fractional-general]. In this case, v must be chosen such that it is not orthogonal to any segment with endpoints in S. Since S is discrete, and thus countable, this is always possible. In this case, following the notation above, KM0 is a subset of exactly k points of S, and the same arguments follow.

Colorful Helly for continuous functions

We show how the floating bodies defined in the previous section imply a colorful Helly theorem. When adapted to the volume, this yields an essentially different proof of the volumetric version of Helly's theorem. The first proof is given in [\cite=DeLoera:2015wp].

Let [formula] be a well-defined, continuous, monotone function that admits a Helly theorem and such that there is a floating body for f. Let h  =  H(f,d,ε), and [formula] be finite families of convex sets in [formula], considered as color classes. Suppose that the intersection of every colorful choice [formula] has size at least one under f. Then, there is a color class Fi for which

[formula]

We follow the same technique as in the proof of Lemma [\ref=lemma-fractional-general]. For a convex set K, we refer to f(K) as its size. We may assume without loss of generality that the sets in [formula] are bounded.

Consider v a direction. We consider a v-halfspace to be a set of the form {x:〈x,v〉  ≤  α} for some real α. For each colorful (h - 1)-tuple [formula] (i.e. each Fi is in a different color class) we have [formula]. Let HB be the v-halfspace such that [formula]. We denote this intersection by KB.

Now consider a colorful h-tuple A of F. We know that [formula]. Among its (h - 1)-tuples, there must be one, call it A', such that HA' is containment-maximal. It is clear that if we add HA' to A, in the resulting set the intersection of any h sets has size at least one. By the definition of h we have that the intersection of this whole family has size at least 1 - ε. However, this implies that the set not in A' contains KA'(f,ε).

Now let B be a colorful (h - 1)-tuple with containment-maximal HB over all possible colorful (h - 1)-tuples. Let Fi be the color class that does not have a set in B. The observations above imply that

[formula]

finishing the proof.

Let [formula], and [formula] be finite families of convex sets in [formula], considered as color classes. Suppose that the intersection of every colorful choice [formula] has volume at least one. Then, there is a color class Fi for which

[formula]

for some constant c depending only on the dimension.

Remarks

It is unclear if the constants needed for the volumetric Helly theorem, the colorful volumetric Helly theorem and the fractional volumetric Helly theorem should be different or not. In particular

Is it true that [formula]?

The known results where the fractional Helly number is different from the Helly number all require checking smaller subfamilies for the fractional version. It would be interesting to have fractional Helly results which require stronger conditions than their Helly counterpart.

As far as the authors know, there are no examples where a colorful Helly theorem requires larger family sizes than its monochromatic counterpart. There are currently two different proofs of the colorful volumetric Helly theorem which require O(ε- (d2 - 1) / 4) color classes, as opposed to the Θ(ε- (d - 1) / 2) for the monochromatic version.

For the colorful volumetric Helly theorem, are O(ε- (d - 1) / 2) color classes sufficient?

Acknowledgments

The authors would like to thank Jesús De Loera for stimulating discussions on the topic. We would also like to thank the University of Michigan, Northeastern University, and the Massachusetts Institute of Technology for providing space and resources to carry out this research. D.R. was supported by the National Science Foundation Graduate Research Fellowship under Grant No. 1122374.

David Rolnick Mathematics Department Massachusetts Institute of Technology Cambridge, MA 02139

Pablo Soberón Mathematics Department Northeastern University Boston, MA 02445

E-mail addresses: drolnick@math.mit.edu, p.soberonbravo@neu.edu