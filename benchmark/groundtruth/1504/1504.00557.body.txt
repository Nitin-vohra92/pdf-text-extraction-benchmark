Proposition Lemma Corollary Conjecture

Definition Terminology Warning Notation Setup Definition-Remark Example Remark

Exercise Problem Question

The Sarkisov program for Mori fibred Calabi-Yau pairs

Department of Mathematics Imperial College London 180 Queen's Gate London, SW7 2AZ, UK Anne-Sophie Kaloghiros

Department of Mathematics Brunel University Uxbridge Middlesex, UB8 3PH,UK

Introduction

Usnich [\cite=usnich06:_sympl_cp_thomp_t] and Blanc [\cite=MR3080816] proved that the group of birational automorphisms of [formula] that preserve the volume form [formula] is generated by [formula], [formula], and the birational map:

[formula]

In this paper we prove a generalisation of this result valid in all dimensions. Our theorem generalises the theorem of Usnich and Blanc in the same way that the Sarkisov program [\cite=MR1311348], [\cite=MR3019454] generalises the theorem of Noether and Castelnuovo stating that [formula] is generated by [formula] and a standard quadratic transformation

[formula]

Our main result is the following:

A volume preserving birational map between Mori fibred Calabi-Yau pairs is a composition of volume preserving Sarkisov links.

In the rest of the introduction, we introduce the terminology needed to make sense of the statement and, along the way, we state the more general factorisation theorem [\ref=thm:2] for volume preserving birational maps of general Calabi-Yau pairs. Theorem [\ref=thm:2] is used in the proof of the main result and is of independent interest. We conclude with some additional remarks.

A Calabi-Yau (CY) pair is a pair (X,D) of a normal variety X and a reduced [formula]-Weil divisor D  ⊂  X such that KX + D  ~  0 is a Cartier divisor linearly equivalent to 0.

We say that a pair (X,D) has (t, dlt), resp. (t, lc) singularities or that it "is" (t, dlt), resp. (t, lc) if X has terminal singularities and the pair (X,D) has dlt, resp. lc singularities.

Similarly (X,D) has (c, dlt), resp. (c, lc) singularities or "is" (c, dlt), resp. (c, lc) if X has canonical singularities and the pair (X,D) has dlt, resp. lc singularities.

We say that a pair (X,D) is [formula]-factorial if X is [formula]-factorial.

We use the following observation throughout: If (X,D) is a CY pair, then, because KX + D is an integral Cartier divisor, for all geometric valuations E, [formula]. If in addition (X,D) is lc or dlt, then a(E,KX + D)  ≤  0 implies a(E,K + D) =  - 1 or 0.

If (X,D) is a dlt CY pair, then automatically it is (c, dlt). More precisely if E is a geometric valuation with small centre on X and if the centre [formula], then a(E,KX) > 0.

Indeed, consider a valuation E with small centre on X. Then

[formula]

therefore a(E,KX)  ≤  0 implies a(E,KX + D)  ≤  0 and then, because KX + D is a Cartier divisor, either a(E,KX + D) =  - 1, which is impossible because by definition of dlt, see remark [\ref=rem:NKLT] below, [formula] is smooth, or a(E,KX + D) = 0 and [formula].

Let (X,DX) and (Y,DY) be CY pairs. A birational map [formula] is volume preserving if there exists a common log resolution

[formula]

such that [formula]. It is essential to the definition that we are requiring equality here not linear equivalence.

If (X,DX) is a CY pair then there is a (unique up to multiplication by a nonzero constant) rational differential ωX∈Ωnk(X) / k (where n =  dim X) such that [formula]. Similarly there is a distinguished rational differential ωY on Y. To say that φ is volume preserving is to say ωX  =  ωY (up to multiplication by a nonzero constant) under the identification Ωnk(X) / k  =  Ωnk(Y) / k given by φ. Equivalently, φ is volume preserving if for all geometric valuations E, a(E,KX + DX) = a(E,KY + DY). It follows that the notion is independent of the choice of common log resolution.

Volume preserving maps are called crepant birational in [\cite=MR3057950].

The composition of two volume preserving maps is volume preserving.

The first step in the proof of theorem [\ref=thm:1] is the following general factorisation theorem for volume preserving birational maps between lc CY pairs, which is of independent interest. See [\cite=kolla15:_calab] for a similar statement.

Let (X,D) and [formula] be lc CY pairs and [formula] a volume preserving birational map. Then there are [formula]-factorial (t, dlt) CY pairs (Y,DY), [formula] and a commutative diagram of birational maps:

[formula]

where:

the morphisms g:Y  →  X, [formula] are volume preserving;

[formula] is a volume preserving isomorphism in codimension 1 which is a composition of volume preserving Mori flips, flops and inverse flips (not necessarily in that order).

A Mori fibred (Mf) CY pair is a [formula]-factorial (t, lc) CY pair (X,D) together with a Mori fibration f:X  →  S. Recall that this means that [formula], - KX is f-ample, and ρ(X) - ρ(S) = 1.

Terminology

We use the following terminology throughout.

A Mori divisorial contraction is an extremal divisorial contraction f:Z  →  X from a [formula]-factorial terminal variety Z of an extremal ray R with KZ  ·  R < 0. In particular X also has [formula]-factorial terminal singularities.

If (Z,DZ) and (X,DX) are (t, lc) CY pairs, then it makes sense to say that f is volume preserving. In this context, this is equivalent to saying that [formula] and, in particular, [formula].

A birational map [formula] is a Mori flip if Z has [formula]-factorial terminal singularities and t is the flip of an extremal ray R with KZ  ·  R < 0. Note that this implies that [formula] has [formula]-factorial terminal singularities.

An inverse Mori flip is the inverse of a Mori flip.

A birational map [formula] is a Mori flop if Z and [formula] have [formula]-factorial terminal singularities and t is the flop of an extremal ray R with KZ  ·  R = 0.

Again if (Z,DZ) and [formula] are (t, lc) CY pairs, it makes sense to say that t is volume preserving. One can see that this just means that [formula].

Let (X,D) and [formula] be Mf CY pairs with Mori fibrations X  →  S and [formula]. A volume preserving Sarkisov link is a volume preserving birational map [formula] that is a Sarkisov link in the sense of [\cite=MR1311348]. Thus φ is of one of the following types:

A link of type I is a commutative diagram:

[formula]

where Z  →  X is a Mori divisorial contraction and [formula] a sequence of Mori flips, flops and inverse flips;

A link of type II is a commutative diagram:

[formula]

where Z  →  X and [formula] are Mori divisorial contractions and [formula] a sequence of Mori flips, flops and inverse flips;

A link of type III is the inverse of a link of type I;

A link of type IV is a commutative diagram:

[formula]

where [formula] is a sequence of Mori flips, flops and inverse flips.

It follows from the definition of Sarkisov link that all the divisorial contractions, flips, etc. that constitute it are volume preserving; in particular, all varieties in sight are naturally and automatically (t, lc) CY pairs.

In order to appreciate the statement of our main theorem [\ref=thm:1], it is important to be aware that, although all Mf CY pairs are only required to have lc singularities as pairs, we insist that all varieties in sight have [formula]-factorial terminal singularities. Our factorisation theorem is at the same time a limiting case of the Sarkisov program for pairs [\cite=MR1460896] and a Sarkisov program for varieties [\cite=MR1311348], [\cite=MR3019454]. The Sarkisov program for pairs usually spoils the singularities of the underlying varieties, while the Sarkisov program for varieties does not preserve singularities of pairs. The proof our main result is a balancing act between singularities of pairs and of varieties.

We expect that it will be possible in some cases to classify all volume preserving Sarkisov links and hence give useful presentations of groups of volume preserving birational maps of interesting Mf CY pairs. We plan to return to these questions in the near future.

The paper is structured as follows. In Section [\ref=sec:mmp] we develop some general results on CY pairs and volume preserving maps between them and prove Theorem [\ref=thm:2]; in Section [\ref=sec:proof] we prove Theorem [\ref=thm:1].

Acknowledgements

We thank Paolo Cascini, János Kollár and Vladimir Lazi for useful comments on a preliminary version.

Birational geometry of CY pairs

Let (X,D) be a lc CY pair, and f:W  →  X a birational morphism. The log transform of D is the divisor

[formula]

where the sum is over all prime divisors E  ⊂  W.

Lemma [\ref=lem:3] is a refinement of [\cite=MR1225842] and [\cite=MR2802603]. In order to state it we need a definition.

Let X be a normal variety. A geometric valuation with centre on X is a valuation of the function field K(X) of the form [formula] where E  ⊂  Y is a divisor on a normal variety Y with a birational morphism f:Y  →  X. The centre of E on X, denoted [formula], is the generic point of f(E).

Let (X,D) be a lc pair. The nonklt set is the set

[formula]

where E is a geometric valuation of the function field of X with centre the scheme theoretic point [formula].

We use the following statement throughout. It is part of the definition of dlt pairs [\cite=MR1658959] that if (X,D) is dlt where [formula] with Di  ⊂  X a prime divisor, then [formula] is the set of generic points of the

[formula]

and X is nonsingular at all these points.

Let (X,D) be a lc CY pair where X is not necessarily proper, f:W  →  X a log resolution, and [formula].

The MMP for KW + DW over X with scaling of a divisor ample over X exists and terminates at a minimal model (Y,DY) over X.

More precisely, this MMP consists of a sequence of steps:

[formula]

where [formula] is the divisorial contraction or flip of an extremal ray [formula] with (KWi + Di)  ·  Ri < 0, and we denote by gi:Wi  →  X the structure morphism and by g:(Y,DY)  →  (X,D) the end result. Then:

For all i, denote by [formula] the induced map. For all i, there are Zariski open neighbourhoods:

[formula]

such that [formula] is an isomorphism;

[formula] and [formula] (that is, g is a dlt crepant blow-up);

(Y,DY) is a (t, dlt) CY pair. In particular, Y has terminal singularities;

The map [formula] contracts precisely the prime divisors E  ⊂  W with a(E,KX + D) > 0. In other words, a f-exceptional divisor E  ⊂  W is not contracted by the map [formula] if and only if a(E,KX + D) = 0 or - 1.

The MMP exists by [\cite=MR2802603]. In the rest of the proof we use the following well-known fact: if E is a geometric valuation with centre on W, then for all i

[formula]

and the inequality is an equality if and only if [formula] is an isomorphism in a neighbourhood of [formula]. In particular, this implies at once that [formula] and the two sets are equal if and only if there exist Zariski open subsets as in (1), if and only if for all E with a(E,K + Di) =  - 1 ti is an isomorphism in a neighbourhood of zWiE.

Now write

[formula]

with F > 0, f-exceptional, with no components in common with DW. We are running a F-MMP, hence if Fi  ⊂  Wi denotes the image of F, then the exceptional set of the map [formula] is contained in [formula], see [\cite=MR3057950]. From this it follows that hi is an isomorphism from [formula] to its image in Wi. At the start, DW has no components in common with F and [formula] is a snc divisor: thus, if a(E,KW + DW) =  - 1, then [formula]. It follows that [formula]. Together with what we said, this implies (1).

As for (2), it is obvious that for all i [formula]. By the negativity lemma [\cite=MR1658959] Fi  ≠  0 implies Fi not nef, so the MMP ends at gN = g:WN = Y  →  X when FN = 0, that is, [formula].

For (3) we need to show that Y has terminal singularities. Suppose that E is a valuation with small centre [formula] on Y. By what we said in Remark [\ref=rem:1], either a(E,KX) > 0, or:

[formula]

and we show that this second possibility leads to a contradiction. Write [formula]. Note that zi∈Wi is never a divisor for this would imply that a(E,KY) > 0. By what we said at the start of the proof, for all i, a(E,KWi + Di)  ≤  a(E,KWi + 1 + Di + 1) with strict inequality if and only if [formula] is not an isomorphism in a neighbourhood of zi∈Wi. There must be a point where strict inequality occurs otherwise [formula] and W = W0 is not terminal in a neibourhood of z0. This, however, implies that a(E,KW + D) < 0, that is, a(E,KW + DW) =  - 1 and then by (1) h:W  →  Y is an isomorphism in a neighbourhood of z0, again a contradiction.

The last statement (4) is obvious.

This example should help appreciate the statement of Theorem [\ref=thm:2] and the subtleties of its proof. Let [formula] and W the total space of the vector bundle OE( - 1, - 2). Let DW  ⊂  W be a smooth surface such that [formula] is a ruling in E and a - 2-curve in DW. Let f:W  →  Y be the contraction of E along the first ruling and [formula] the contraction along the second ruling. Then (Y,D) and [formula] are both dlt, [formula] is terminal, Y is canonical but not terminal, and the map [formula] is volume preserving.

Let

[formula]

be a common log resolution. Since φ is volume preserving, then for all geometric valuations E [formula] and:

[formula]

where [formula] and

[formula]

Let g:(Y,DY)  →  (X,D) and [formula] be the end products of the (KW + DW)-MMP over X and [formula] as in Lemma [\ref=lem:3], and denote by [formula] the induced map. By Lemma [\ref=lem:3](4) χ is an isomorphism in codimension one.

Denote by [formula] and [formula] the obvious maps and write [formula]; by Lemma [\ref=lem:3](1) t|UW and [formula] are isomorphisms onto their images [formula] and [formula]. It follows from this that χ|U maps U isomorphically to [formula].

In the rest of the proof if N is a divisor on Y we denote by [formula] its transform on [formula] and conversely: because χ is an isomorphism in codimension one it is clear what the notation means.

Let us choose, as we can by what we just said above, an ample [formula]-divisor [formula] on [formula] general enough that both [formula] and (Y,DY + L) are dlt. Let 0 < ε  <    < 1 be small enough that [formula] is ample. Note that, again by what we said above, writing [formula], both pairs [formula] and (Y,Θ) are klt.

Since [formula] is ample, [formula] is the log canonical model of (Y,Θ). It follows that χ is the composition of finitely many [\cite=MR2601039] flips

[formula]

of the MMP for KY  +  Θ. If N is a divisor on Y, denote by Ni its transform on Yi. For all i, χi is a (KYi  +  Θi)-flip and, at the same time, a (KYi + Di)-flop, and hence all pairs (Yi,Di) are lc. We next argue that all (Yi,Di) are in fact (t,dlt).

Because the MMP is a MMP for [formula], the exceptional set of χi is contained in [formula]. From this it follows that, writing U0 = U, χ0|U0 is an isomorphism onto its image, which we denote by U1 and, by induction on i, χi|Ui is an isomorphism onto its image, which we denote by Ui + 1. We show by induction that, for all i, Ui is a Zariski neighbourhood of [formula], so that χi is a local isomorphism at the generic point of each [formula] and (Yi,Di) is a dlt pair. Indeed assuming the statement for i < k consider [formula]. Let E be a valuation with discrepancy a(E,KYk + 1 + Dk + 1) =  - 1, then also a(E,KYk + Dk) =  - 1, thus [formula] and then by what we just said χk is an isomorphism at zk, hence zk + 1  =  χk(zk)∈Uk + 1. This shows that all (Yi,Di) are dlt.

Finally we prove that for all i Yi is terminal. Assume for a contradiction that Yj is not terminal. By Remark [\ref=rem:1](2) Yj is canonical and there is a geometric valuation E with [formula], and then also [formula]. Since Y is terminal, a(E,KY) > 0, and [formula], and [formula], but then a(E,KY + DY) > a(E,KW + DW), so that we must have that a(E,KW + DW) =  - 1, that is [formula] and this is a contradiction.

Sarkisov program under Y

Basic Setup

We fix the following situation, which we keep in force throughout this section:

[formula]

Y and [formula] have [formula]-factorial terminal singularities and g:Y  →  X and [formula] are birational morphisms.

[formula] is the composition of Mori flips, flops and inverse flips.

p:X  →  S and [formula] are Mfs.

The goal of this section is to prove theorem [\ref=thm:3] below. In the final short section [\ref=sec:mainthm] we show that theorem [\ref=thm:2] and theorem [\ref=thm:3] imply theorem [\ref=thm:1]. The proof of theorem [\ref=thm:3] is a variation on the proof of [\cite=MR3019454].

A birational map [formula] is contracting if f- 1 contracts no divisors.

If a birational map [formula] is contracting, then it makes sense to pullback [formula]-Cartier ([formula]-Cartier) divisors from Y to X. Choose a normal variety W and a factorisation:

[formula]

with p and q proper birational morphisms. If D is a [formula]-Cartier ([formula]-Cartier) [formula]-divisor ([formula]-divisor) on Y the pullback [formula] is defined as:

[formula]

(this is easily seen to be independent of the factorisation).

The birational map [formula] is a composition of links [formula] of the Sarkisov program where all the maps [formula] are contracting.

Finitely generated divisorial rings

General theory

Let [formula] be a a contracting birational map.

Let DX be an [formula]-divisor. We say that f is DX-nonpositive (DX-negative) if [formula] is [formula]-Cartier and

[formula]

where all aE  ≥  0 (all aE > 0).

Note the special case DX = KX in the definition just given.

Let X / Z be a normal variety, proper over Z, and D an [formula]-divisor on X.

A semiample model of D is a D-nonpositive contracting birational map [formula] to a normal variety Y / Z proper over Z such that [formula] is semiample over Z;

An ample model of D is a rational map [formula] to a normal variety W / Z projective over Z together with an ample [formula]-Cartier divisor A, such that there is a factorisation [formula]:

[formula]

where [formula] is a semiample model of D, g:Y  →  W is a morphism, and [formula].

Let X / Z be a normal variety proper over Z and D an [formula]-divisor on X.

Suppose that W / Z is normal, A an ample [formula]-divisor on W, and [formula] an ample model of D. If [formula] is a semiample model of D, then the induced rational map [formula] is a morphism and [formula].

All ample models of D are isomorphic over Z.

We refer to[\cite=MoriProcs] for basic terminology on divisorial rings.

[\cite=MoriProcs] Let X be a projective [formula]-factorial variety, and [formula] a rational polyhedral cone containing a big divisor such that the ring [formula] is finitely generated. Then there exists a finite rational polyhedral fan Σ and a decomposition:

[formula]

such that:

For all σ∈Σ there exists a normal projective variety Xσ and a rational map [formula] such that for all D∈σ, φσ is the ample model of D. If σ contains a big divisor, then for all [formula], φσ is a semiample model of D.

For all [formula] there exists a morphism φστ:Xσ  →  Xτ such that the diagram

[formula]

commutes.

Under the assumptions of Theorem [\ref=thm:decomposition], if a cone σ∈Σ intersects the interior of [formula], then it consists of big divisors (this is because the big cone is the interior of the pseudo-effective cone). This holds in particular if σ is of maximal dimension.

Theorem [\ref=thm:decomposition](2) follows immediately from part (1) and remark [\ref=rem:5](1).

Let X be a projective [formula]-factorial variety, and [formula] a rational polyhedral cone containing a big divisor such that the ring [formula] is finitely generated. We say that C is generic if:

For all σ∈Σ of maximal dimension, Xσ is [formula]-factorial.

For all σ∈Σ, not necessarily of maximal dimension, and all [formula] of codimension one, the morphism Xσ  →  Xτ has relative Picard rank ρ(Xσ  /  Xτ)  ≤  1.

Let X be a projective [formula]-factorial variety, and [formula] a generic rational polyhedral cone containing a big divisor.

Let [formula] such that the cone [formula] contains a big divisor, and let ε > 0. There exist [formula] with [formula] such that the cone [formula] is generic.

Make sure that all cones [formula], [formula], intersect all cones σ∈Σ properly.

Let X be a projective [formula]-factorial variety, [formula] big [formula]-divisors on X such that all pairs (X,Δi) are klt, and let

[formula]

Then [formula] is finitely generated, and if [formula] spans [formula] as a vector space then C is generic.

For the proof see for example [\cite=MoriProcs]. Note that the assumptions readily imply that [formula] contains big divisors. The finite generation of [formula] is of course the big theorem of [\cite=MR2601039].

In what follows we work with a pair (X,GX) where X is [formula]-factorial and:

GX is a [formula]-linear combination of irreducible mobile divisors;

(X,GX) is terminal;

KX + GX is not pseudoeffective.

Assumption (i) implies that when running the MMP for KX + GX no component of GX is ever contracted, so that (X,GX) remains terminal throughout the MMP. Assumption (iii) means that the MMP terminates with a Mf.

Let X be a projective [formula]-factorial variety, GX as in setup [\ref=setup:1], [formula] big [formula]-divisors on X such that all pairs (X,GX  +  Δi) are klt.

Then for all ε > 0 there are ample [formula]-divisors [formula] with | |Hi| | < ε such that

[formula]

is generic.

Add enough ample divisors to span N1 and then use lemma [\ref=lem:2] to perturb [formula] inside a bigger cone. Since [formula], then [formula], and hence there is no need to perturb GX.

Special case: 2-dimensional cones

Suppose that A is a big [formula]-divisor on X such that

the pair (X,GX  +  A) is klt;

KX + GX + A is ample on X;

the cone C  =  〈KX + GX,KX + GX + A〉 is generic.

Then, the decomposition of [formula] given by theorem [\ref=thm:decomposition] corresponds to running a MMP for KX + GX with scaling by A. This MMP exist by [\cite=MR2601039]. In more detail, let

[formula]

be rational numbers such that [formula] and the maximal cones of the decomposition correspond to the intervals (ti,ti + 1). For all t∈(ti,ti + 1) KX + GX + tA is ample on [formula]. Then

[formula]

is a minimal model program for KX + GX with scaling by A, that is:

[formula]

where Ai denotes the push forward of A, and [formula] is the divisorial contraction or flip of an extremal ray [formula] with

[formula]

and

[formula] and

[formula]

is a Mf. Moreover:

Genericity means that at each step there is a unique extremal ray [formula] with (KXi + GXi + ti + 1Ai)  ·  Ri = 0 and (KXi + GXi)  ·  Ri < 0.

The following follows immediately from genericity. If 0 < ε  <    < 1 is small enough then for all ample [formula]-divisors H with | |H| | < ε, KX + GX + A + H is ample on X, the cone [formula] is still generic, and the MMP for KX + GX with scaling by A + H is identical to the MMP for KX + GX with scaling by A, in the sense that the sequence of steps and end product are identical.

Special case: 3-dimensional cones

In this subsection we prove the following special case of theorem [\ref=thm:3]:

Suppose that (Y,GY) is as in setup [\ref=setup:1], and that A, [formula] are big [formula]-divisors on Y such that:

(Y,GY + A) and [formula] are klt;

KY + GY + A and [formula] are both ample on Y;

the cones C  =  〈KY + GY,KY + GY + A〉 and [formula] are generic;

the MMP for KY + GY with scaling by A, resp. [formula], ends in a Mf X / S, resp. [formula].

Then the birational map [formula] is a composition of links [formula] of the Sarkisov program where each map [formula] is contracting.

The proof is the argument of [\cite=MR3019454], which we sketch here for the reader's convenience. After a small perturbation of A and [formula] as in corollary [\ref=cor:1] that, as stated in § [\ref=sec:special-case:-2](4), does not change the two MMPs or their end products, the cone [formula] is generic. The argument of [\cite=MR3019454] then shows how walking along the boundary of [formula] corresponds to a chain of Sarkisov links from X / S to [formula]. By construction, all maps from Y are contracting.

Proof of Theorem [\ref=thm:3]

Write [formula] where each

[formula]

is a Mori flip, flop or inverse flip, and Y = Y0, [formula].

For all [formula]-divisors GY on Y denote by GYi the strict transform on Yi. Choose GY such that for all [formula]:

GYi satisfies the setup [\ref=setup:1], and

χi is either a (KYi + GYi)-flip or antiflip.

One way to choose GY is as follows: if χi is a flop, choose GYi ample, general, and very small on Yi. If GYi is small enough then for all j if χj was a flip or antiflip then it still is a flip or antiflip. On the other hand now χi is a (KYi + GYi)-flip. Some other flops may have become flips or antilfips. If there are still flops repeat the process by adding, on Yk such that χk is a (KYk + GYk)-flop, a very small ample divisor to GYk, and so on until there are no flops left.

For all [formula], we choose by induction on i a big divisor Ai on Yi such that KYi + GYi + Ai is ample, 〈KYi + GYi,KYi + GYi + Ai〉 is generic, and the MMP for KYi + GYi with scaling by Ai terminates with a Mf pi:Xi  →  Si. At the start p0 = p:X0 = X  →  S0 = S, but it will not necessarily be the case that [formula]. We prove, also by induction on i, that for all i the induced map [formula] is the composition of Sarkisov links under Y. Finally we prove that the induced map [formula] is the composition of Sarkisov links under Y.

Suppose that for all j < i Aj has been constructed. We consider two cases:

If χi - 1 is a (KYi - 1 + GYi - 1)-flip, choose an ample [formula]-divisor [formula] on Yi - 1 such that [formula] is generic and the MMP for KYi - 1 + GYi - 1 with scaling by [formula] begins with the flip χi - 1. This can be accomplished as follows: if χi - 1 is the flip of the extremal contraction γi - 1:Yi - 1  →  Zi - 1 then [formula] where Li - 1 is ample on Yi - 1 and Ni - 1 is ample enough on Zi - 1. Now set

[formula]

where [formula] is γi - 1-trivial and 0 < ε  <    < 1. Note that [formula] generic implies 〈KYi + GYi,KYi + GYi + Ai〉 generic. We take pi:Xi  →  Si to be the end product of the MMP for KYi + GYi with scaling by Ai. It follows from lemma [\ref=lem:6], applied to Yi - 1 and the divisors Ai - 1, [formula], that the induced map [formula] is a composition of Sarkisov links under Yi - 1 and hence, since [formula] is an isomorphism in codimension one, under Y.

If χi - 1 is a (KYi - 1 + GYi - 1)-antiflip, choose Ai ample on Yi such that 〈KYi + GYi,KYi + GYi + Ai〉 is generic and the MMP for KYi + GYi with scaling by Ai begins with the flip χ- 1i - 1. We take pi:Xi  →  Si to be the end product of the MMP for KYi + GYi with scaling by Ai. It follows from lemma [\ref=lem:6], applied to Yi - 1 and the divisors Ai - 1,

[formula]

where KYi + GYi + t1Ai is χ- 1i - 1-trivial and 0 < ε  <    < 1, that the induced map [formula] is a composition of Sarkisov links under Yi - 1 and hence, since [formula] is an isomorphism in codimension one, under Y.

Finally, choose [formula] ample on [formula] such that [formula] is generic and the MMP for [formula] with scaling by [formula] terminates with the Mf [formula]. It follows from lemma [\ref=lem:6], applied to [formula] (and the divisors AN, [formula]), that the induced map [formula] is a composition of Sarkisov links under [formula] and hence, since [formula] is an isomorphism in codimension one, under Y.

Proof of theorem [\ref=thm:1]

Let (X,D) and [formula] with p:X  →  S and [formula] be (t,lc) Mf CY pairs, and let [formula] be a volume preserving birational map. Theorem [\ref=thm:2] gives a diagram:

[formula]

where (Y,DY), [formula] are (t,dlt) [formula]-factorial CY pairs, g, [formula] are volume preserving and χ is a volume preserving composition of Mori flips, flops and inverse flips. In particular, if we forget the Ds, we are in the situation of § [\ref=sec:basic-setup], so that by theorem [\ref=thm:3] [formula] is the composition of Sarkisov links [formula] such that all induced maps [formula] are contracting. Denoting by [formula], it is clear that for all i gi is volume preserving hence also [formula] is volume preserving, and (Xi,Di) is a (t,lc) CY pair.