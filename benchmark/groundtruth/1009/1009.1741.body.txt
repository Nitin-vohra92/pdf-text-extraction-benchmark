Metaplectic Ice

Introduction

The study of spherical Whittaker functions of reductive groups over local fields is of fundamental importance in number theory and representation theory. Recently, in two separate series of papers, the authors and their collaborators have studied Whittaker functions on metaplectic covers of such groups. The goal of this paper is to introduce a new method for describing such p-adic metaplectic Whittaker functions: two-dimensional lattice models of statistical mechanics. In such a model, one defines the partition function to be a weighted sum over states of the model. We show that there exists a choice of weights for which the partition functions are metaplectic Whittaker functions. Baxter [\cite=baxter] developed important techniques for evaluating the partition functions of lattice models including the so-called "commutativity of transfer matrices" and the use of the Yang-Baxter equation. We discuss how these methods relate to our descriptions of Whittaker functions and to prior work.

Two different explicit formulas have been given in [\cite=ChintaOffen] and [\cite=McNamara] for the spherical Whittaker function on a metaplectic cover of [formula] over a non-archimedean local field. The first of these is expressed in terms of a Weyl group action described in [\cite=CG], the second in terms of a function on Gelfand-Tsetlin patterns initially introduced in [\cite=wmd3]. In fact, this latter representation belongs to a family of explicit formulas, one for each reduced expression of the long element of the Weyl group as a product of simple reflections. Two such reduced expressions in type A are particularly nice, and lead to representations of the Whittaker function as sums over Gelfand-Tsetlin patterns. In keeping with earlier works, we refer to the two different descriptions as "Gamma" and "Delta" rules. The main result of [\cite=wmd5book] is a combinatorial proof that these two definitions are in fact equal. This equality allows one to prove the analytic properties of an associated global object (a multiple Dirichlet series) by applying Bochner's convexity principle.

In the following section we demonstrate that the Gelfand-Tsetlin patterns we are concerned with are in bijection with admissible states of the six-vertex model having certain fixed boundary conditions. After recalling the description of the metaplectic Whittaker function as a function on Gelfand-Tsetlin patterns in Section 3, we use the bijection with the lattice model in Section 4 to express both the Gamma and Delta descriptions of the Whittaker function as partition functions for certain respective choices of Boltzmann weights.

In Section 5, we take the connection with statistical models further. We show that the necessary result for demonstrating the equivalence of the Gamma and Delta descriptions may be reformulated in terms of the commutativity of transfer matrices. Baxter [\cite=baxter] advocated the use of the Yang-Baxter equation for demonstrating this commutativity. In Section 6, we explain how this is carried out in the context of the six-vertex model and we speculate about the possibility of such an equation in the metaplectic case.

Finally we discuss the Weyl group action on metaplectic Whittaker functions, initially established by Kazhdan and Patterson [\cite=kp], which plays a critical role in the explicit formulas of [\cite=ChintaOffen]. When the degree of the cover is 1, i.e. the linear case, the p-adic spherical Whittaker function is essentially a Schur polynomial by results going back to Shintani [\cite=Shintani]. The Weyl group action is thus closely related to the standard permutation action on polynomials in r + 1 variables. In [\cite=hkice], this Whittaker function (or equivalently, the Schur polynomial multiplied by a q-deformation of the Weyl denominator) is realized as a partition function on a six-vertex model and its properties are studied via instances of the Yang-Baxter equation. On the other hand, as soon as the degree of the cover is greater than 1, the action looks rather different (cf. [\eqref=defn:PQ]-[\eqref=eq:fe]). Nevertheless, we may ask whether these functional equations may also be phrased in terms of transfer matrices and a Yang-Baxter equation, and in this final section, we present evidence towards an affirmative answer.

This work was partially supported by the following grants: NSF grants DMS-0844185 (Brubaker), DMS-0652817 and DMS-1001079 (Bump), DMS-0847586 (Chinta), DMS-0652609 and DMS-1001326 (Friedberg), DMS-0801214 (Gunnells) and NSA grant H98230-10-1-0183 (Friedberg).

Six Vertex Model and Gelfand-Tsetlin Patterns

In this section, we demonstrate a bijection between strict Gelfand-Tsetlin patterns and admissible states of the six vertex model (or "square ice") on a finite square lattice with certain fixed boundary conditions. The boundary conditions on ice were known to Hamel and King, who presented bijections between ice and patterns related to the symplectic group in [\cite=hamelkinguturn]. A treatment tailored to the aims of the present paper was given in [\cite=hkice], whose terminology we now recall.

A Gelfand-Tsetlin pattern of rank r is a triangular array of integers

[formula]

in which the rows interleave: [formula]. The set of all Gelfand-Tsetlin patterns with fixed top row is in bijection with basis vectors of a corresponding highest weight representation of [formula]. Indeed, any given top row [formula] is a partition which may be regarded as a dominant weight of the [formula] weight lattice. Each successive row of a pattern then records a branching rule down to a highest weight representation on a subgroup of rank one less. We will focus mainly on the set of strict Gelfand-Tsetlin patterns, whose entries in horizontal rows are strictly decreasing. In terms of representation theory, these patterns result from branching through strictly dominant highest weights. Top rows of strict Gelfand-Tsetlin patterns are then indexed by strictly dominant weights λ  +  ρ where λ is a dominant weight and ρ is the Weyl vector [formula].

Now we come to lattice models. The six-vertex model consists of labelings of edges in a square grid where each vertex has adjacent edges in one of six admissible configurations. This model is sometimes referred to as "square ice" where each vertex of the grid represents an oxygen atom and the 6 admissible ways of labeling adjacent edges correspond to the number of ways in which two of the four edges include a nearby hydrogen atom. If we represent adjacent hydrogen atoms by incoming arrows, and locations where there is no adjacent hydrogen atom by outgoing arrows, the six admissible states are as follows.

[formula]

We will use a representation consisting of a lattice whose edges are labeled with signs +   or -  , called spins. To relate this to the previous description, interpret a right-pointing or down-pointing arrow as a +  , and a left-pointing or up-pointing arrow as -  . We then find the following six configurations. (The index i in the table indicates the row to which the vertex belongs, and will be used in later sections.)

[formula]

The rectangular lattices we consider will be finite, with boundary conditions chosen so that the admissible configurations are in bijection with strict Gelfand-Tsetlin patterns with fixed rank r and top row λ  +  ρ as above. Here [formula] with λj  ≥  λj - 1 for all j, and we suppose that λ0 = 0.

For example, put r  =  2, and take λ  =  (3,2,0), so that λ  +  ρ  =  (5,3,0). Then we have the following boundary conditions for the ice:

[formula]

The column labels are written above each column, and row labels have been placed next to each vertex. These row labels will be used in Section [\ref=sec:imwf], but need not concern us now. The edge spins have been placed inside circles located along the boundary. The remaining open circles indicate interior spins not determined by our boundary conditions, though any filling of the grid must use only the six admissible configurations in the above table. Such an admissible filling of the finite lattice having above boundary conditions will be referred to as a of ice.

Given a fixed rank r and a dominant weight [formula], there is a bijection between strict Gelfand-Tsetlin patterns with top row λ  +  ρ and admissible states of ice having boundary conditions determined by λ as above.

We begin with a strict Gelfand-Tsetlin pattern. Each row of the Gelfand-Tsetlin pattern will correspond to the set of spins located between numbered rows of ice, the so-called "vertical spins" since they lie on vertical edges of the grid, as follows. To each entry ai,j in the Gelfand-Tsetlin pattern, we assign a -   to the vertical spin between rows labeled r + 2 - i and r + 1 - i in the column labeled ai,j. (Recall that we are using decreasing row labels from top to bottom as in the example ([\ref=bdconds]).) The remaining vertical spins are assigned +  .

It remains to assign horizontal spins, but these are already uniquely determined since the left and right edge horizontal spins have been assigned and each admissible vertex configuration has an even number of adjacent +   spins. We must only verify that the resulting configuration uses only the 6 admissible configurations (from the 8 having an even number of +   signs) for the corresponding ice. This is easily implied by the interleaving condition on entries in the Gelfand-Tsetlin pattern, which is violated if one of the two inadmissible configurations appears. See Lemma 2 of [\cite=hkice] for more details.

A simple example illustrates the bijection:

[formula]

Metaplectic Whittaker Functions and Patterns

We now discuss the relation between the spherical metaplectic Whittaker function on the n-fold cover of of [formula] over a non-archimedean local field and Gelfand-Tsetlin patterns. Such a relationship, described globally, was conjectured in [\cite=wmd3] and was established in [\cite=eisenxtal]. Though it is possible to pass from the global result to its local analogue (cf. [\cite=Friedberg-McNamara]), a direct local proof was given by McNamara [\cite=McNamara], expressing a metaplectic spherical Whittaker function as a generating function supported on strict Gelfand-Tsetlin patterns. In this section, we recall two formulations of this explicit description, following [\cite=wmd5book]. In Section [\ref=sec:imwf], we will explain their translations to square ice via the bijection of Proposition [\ref=bijprop].

Let [formula] denote the n-fold metaplectic cover of [formula], where F denotes a nonarchimedean local field having ring of integers [formula] and residue field of order q. (There are several related such extensions, but we will use the one in [\cite=kp] where their parameter c = 0.) We assume 2n divides q - 1, which guarantees that F contains the group μ2n of 2nth roots of unity. The group [formula] is a central extension of G(F) by μn:

[formula]

We will identify μn  ⊂  F with the group [formula] of complex n-th roots of unity by some fixed isomorphism. For convenience, we will sometimes denote [formula] as just [formula], and if H is an algebraic subgroup of G, we may denote by [formula] the preimage of H(F) in [formula].

For details of the construction of the metaplectic group and results about its representations, see [\cite=mcnamarafoundations] in this volume. Let B(F) be the standard Borel subgroup of upper triangular matrices in G(F), and let T(F) be the diagonal maximal torus. Then B(F) = T(F)U(F) where U(F) is the unipotent radical of B(F). The metaplectic cover splits over various subgroups of G(F); for us it is relevant that it splits over U(F) and over [formula], the standard maximal compact subgroup. By abuse of notation, we will sometimes denote by K the homomorphic image of K in [formula] under this splitting.

Let [formula] be any map such that [formula] is the identity map on G(F). Then the map σ:G(F)  ×  G(F)  →  μn such that

[formula]

is a 2-cocycle defining a class in H2(G(F),μn). A particular such cocycle was considered by Matsumoto [\cite=Matsumoto], Kazhdan and Patterson [\cite=kp] and Banks, Levy and Sepanski [\cite=BanksLevySepanski]. By these references, such as [\cite=kp] Section 0.1, the map [formula] may be chosen so that the restriction of σ to T(F) is given by the formula

[formula]

The cocycle σ also has the property that σ(u,g) = σ(g,u) = 1 if u∈U(F), and so the restriction of [formula] to U(F) is a homomorphism to [formula].

We will call a representation π of [formula] or any subgroup genuine if π(ζg) = ζπ(g) when ζ∈μn. Recall that [formula] denotes the inverse image under π of the maximal torus T(F). The center [formula] of [formula] has finite index. Since [formula] is a Heisenberg group, characters of [formula] parametrize the irreducible genuine representations of [formula] as follows. Let χ be a quasi-character of [formula] that is unramified. This means that it is trivial on the maximal compact subgroup of this abelian group. Let A be a maximal abelian subgroup of [formula]. Extend χ to A, then induce it to [formula]. By Clifford theory, the resulting representation i(χ) of [formula] is genuine, irreducible, and finite-dimensional. It does not depend on either A or the extension of χ to A.

We extend i(χ) to the inverse image [formula] of B(F) in such a way that [formula] acts trivially. We then consider the representation of [formula] obtained by normalized induction. We call the vector space of the resulting representation I(χ). It has a one-dimensional space of K-fixed, i.e. spherical, vectors.

Let [formula] be an additive character that is trivial on [formula] but on no larger fractional ideal. Given a spherical vector f in I(χ), we may construct the spherical metaplectic Whittaker function via the integral

[formula]

where ψ is the character of U(F) given by

[formula]

and w0 is a representative in K of the long Weyl group element. Strictly speaking, W(g) as we have defined it is an i(χ)-valued function and should be composed with a natural choice of linear functional on i(χ) to obtain a complex-valued function. For brevity we will sometimes refer to W(g) as the metaplectic Whittaker function.

Note that χ on [formula] may be described by a choice of r complex numbers [formula]. The transformation property [formula] for all u∈U(F),k∈K, implies that it suffices to determine W on the inverse image of the torus T(F). Moreover, since W is genuine, it is sufficient to specify W on [formula]. Given [formula], where ωi are fundamental weights, let tλ be the element of the torus T(F) given by

[formula]

Let [formula]. Due to our assumption that F contains the 2n-th roots of unity, (p,p)n = 1 and by ([\ref=cocycle]) it follows that [formula].

It is not hard to show that [formula] unless λ is a dominant weight.

Given any dominant weight λ, the metaplectic Whittaker function [formula] may thus be expressed as a Dirichlet series in r complex variables [formula] of the form

[formula]

where q denotes the cardinality of the residue field [formula]. We now describe the function [formula]. See [\cite=McNamara] for further details.

The positive integer n will continue to denote the degree of the metaplectic cover. We define the Gauss sum

[formula]

where [formula] denotes the n-th power Hilbert symbol, and we normalize the Haar measure so that [formula]. As a further shorthand, for any positive integer b, we set

[formula]

Note that for a fixed base field F, these values depend only on b mod n. If n divides b, in particular if n = 1, we have

[formula]

We caution the reader that the q-powers that appear in the g(a,b) are normalized differently than in the previous works [\cite=eisenxtal] [\cite=wmd5book] [\cite=wmd3]; these are the functions denoted [formula] and [formula] in [\cite=wmd5book]. The function h is a degenerate Gauss sum whose values may be made explicit, while (if [formula]) g(b) is a "true" Gauss sum.

Any strict Gelfand-Tsetlin pattern [formula] with entries indexed as in ([\ref=gtindexing]), we associate a weighting function γ to each entry ai,j with i  ≥  1 as follows:

[formula]

Then we define

[formula]

If [formula] is a Gelfand-Tsetlin pattern that is not strict, we define [formula]. We also define

[formula]

In particular, note that both GΓ and [formula] are defined using differences of elements above and to the right of ai,j. The superscript Γ may be regarded as indicator that these quantities are defined using such "right-hand" differences.

We present these definitions in this ad-hoc fashion in order to give a brief and self-contained treatment, but in fact they have very natural descriptions when reinterpreted as functions on a Kashiwara crystal graph. See [\cite=wmd5book] for an extensive discussion.

As an example, consider the Gelfand-Tsetlin pattern [formula] in ([\ref=workingexample]). Then

[formula]

(Brubaker, Bump, and Friedberg [\cite=eisenxtal]; McNamara [\cite=McNamara]) Given a dominant weight λ and a fixed r-tuple of non-negative integers [formula], the function  [formula] appearing in the p-adic Whittaker function [formula] is given by

[formula]

where the sum is over all Gelfand-Tsetlin patterns with top row corresponding to λ  +  ρ satisfying the subscripted condition.

There is a second explicit description of [formula] in terms of "left-hand" differences using functions GΔ and [formula] that are analogous to those defined in ([\ref=Ggamma]) and ([\ref=kgamma]) respectively. Assuming that [formula] is strict, set

[formula]

and define

[formula]

If [formula] is not strict, define [formula]. We also set

[formula]

The main theorem of [\cite=wmd5book] is as follows:

Given a dominant weight λ and a fixed r-tuple of non-negative integers [formula],

[formula]

where the sums each run over all Gelfand-Tsetlin patterns with top row corresponding to λ  +  ρ satisfying the subscripted condition.

As an immediate corollary, we have a second description of the p-adic Whittaker function in terms of GΔ and [formula]. We refer to these two recipes on the left- and right-hand sides of ([\ref=gammaisdelta]) as the Γ- and Δ-rules, respectively.

In fact, there are many other descriptions for the Whittaker function, though these are generally much more difficult to write down as explicitly. Indeed, as explained in [\cite=BerensteinZelevinsky] [\cite=Littelmann], there exist bases for highest weight representations corresponding to any reduced expression for the long element w0 of the Weyl group of [formula] -- Sr, the symmetric group on r letters -- as a product of simple reflections σi. These make use of the Kashiwara crystal graph and are commonly called string bases. Using these bases, one may make a correspondence between long words and recipes for the Whittaker function (cf. [\cite=wmd5book]). From this perspective, the Γ-rule corresponds to the word

[formula]

whereas the Δ-rule corresponds to the word

[formula]

These two words are as far apart as possible in the lexicographic ordering of all reduced decompositions. The proof of Theorem [\ref=statementA] as given in [\cite=wmd5book] uses a blend of combinatorial arguments to give various equivalent forms of the identity ([\ref=gammaisdelta]) as we move through the space of long words. We highlight various aspects of the proof in more detail now.

The proof is by induction on the rank r. The inductive hypothesis allows us to equate any two recipes for the Whittaker function whose associated long words differ by a sequence of relations obtained from a lower rank case. For example, assuming the rank 2 case allows us to perform a braid relation σ1σ2σ1  =  σ2σ1σ2, which could be applied to the word corresponding to the Γ-rule above. After a series of such identities, we arrive at two descriptions for the Whittaker function as a weighted sum over Gelfand-Tsetlin patterns that agree on the bottom r  -  2 rows of the pattern. Thus, we may restrict our attention to the top three rows of a rank r pattern. We refer to such three-row arrays of interleaving integers, where we fix both the top and bottom of the three rows, as "short Gelfand-Tsetlin patterns" and re-index the three rows as follows:

[formula]

These two recipes for the Whittaker function will be called GΓΔ (as this recipe uses a right-hand rule for the entries ai and a left-hand rule for the entries mj) and GΔΓ (where the use of rules is reversed). To be exact, using the definitions in ([\ref=gammagtwt]) and ([\ref=deltagtwt]), we have

[formula]

Rather than define functions kΓΔ and kΔΓ on short patterns in analogy to the recipes above, it is enough to specify the middle row sum as the other rows are fixed.

Before stating the reduction, we require one final ingredient. There is a natural involution qr on short Gelfand-Tsetlin patterns of rank r, given by acting on middle row entries according to

[formula]

where if i  =  0 we understand that [formula] and if i  =  r, [formula]. This involution qr is used by Berenstein and Kirillov (cf. [\cite=BerensteinKirillov]) to define a Schützenberger involution on Gelfand-Tsetlin patterns. Brubaker, Bump and Friedberg use the involution qr to give the following reduction of Statement A in [\cite=wmd5book].

Fix an (r  +  1)-tuple of positive integers [formula], an (r  -  1)-tuple of positive integers [formula] and a positive integer k. Then

[formula]

where ai' are the entries of [formula], [formula], and the sums range over all short patterns with top row [formula] and bottom row [formula] satisfying the indicated condition.

See [\cite=gelbvol] and Chapter 6 of [\cite=wmd5book] for a full proof of the reduction from Statement A to Statement B. As noted above, the proof of Statement B proceeds through a series of additional reductions which occupy thirteen chapters of [\cite=wmd5book]. In brief, for "generic" short patterns [formula], the Schützenberger involution qr gives a finer equality [formula], which implies the equality of Statement B summand by summand. By "generic" we mean that the entries of the short pattern are in general position - in particular, for all i, [formula] using the notation of ([\ref=shortgtindexing]). Note that the Schützenberger involution does not necessarily preserve strictness for all patterns in the remaining non-generic cases, and one needs much more subtle arguments to handle these short patterns. For such patterns, Statement B is not in fact true summand by summand, and one does need to sum over all short patterns with fixed row sum to obtain equality.

As an alternative to establishing Statement B, we mention that one could also prove Theorem [\ref=statementA] by computing the Whittaker integral in two ways, mimicking the techniques of [\cite=eisenxtal], thus obtaining a proof via decomposition theorems in algebraic groups which respect the metaplectic cover. In subsequent sections of this paper, we propose a third way of viewing these theorems using ice-type models, which portends new connections between number theory/representation theory and statistical physics.

Ice and Metaplectic Whittaker Functions

In statistical mechanics, one attempts to infer global behavior from local interactions. In the context of lattice models, this means that we attach a to each vertex in the grid and for each admissible state of the model, we consider the product of all Boltzmann weights ranging over all vertices of the grid. Then one can attempt to determine the of the lattice model, which is simply the sum over all admissible states of the associated weights. In this section, we explain how to obtain the metaplectic spherical Whittaker function of Section [\ref=whitdefined] as the partition function of a lattice model with boundary conditions as defined in Section [\ref=bijectionsection].

We make use of the two sets of Boltzmann weights BΓ and BΔ. When these weights are applied to an admissible state of ice, we refer to the resulting configuration as Gamma ice or Delta ice, respectively. In order to indicate which set of weights is being used at a particular vertex, we use [formula] for Gamma ice and [formula] for Delta ice.

[formula]

In giving these Boltzmann weights, we have made use of the notation in ([\ref=gandhforshort]). For Gamma ice, the constant a equals the number of +   signs in the i-th row to the right of the vertex [formula]. For Delta ice, the constant a equals the number of -   signs in the i-th row to the left of the vertex [formula]. In either case, we refer to this constant as the "charge" at the vertex. Note by our definitions in ([\ref=gandhforshort]), the Boltzmann weights only depend on the charge mod n. The weights BΓ and BΔ also depend on parameters zi, where i indicates the row in which the vertex is found. For Gamma ice, the row numbers decrease from r + 1 to 1 as we move from top to bottom as in the example ([\ref=bdconds]), while for Delta ice, the row numbers increase from 1 to r + 1. These zi are referred to as "spectral parameters." We often suppress the dependence of BΓ and BΔ on the spectral parameters zi, 1  ≤  i  ≤  r + 1. Let [formula].

Given an admissible state of Gamma ice (or Delta ice, respectively) S, we define

[formula]

where the product (in either case) is taken over all vertices in the state of ice S.

Under the bijection of Proposition [\ref=bijprop], with strict pattern [formula] corresponding to an admissible state of Gamma ice [formula], then [formula] as defined in ([\ref=Ggamma]) is related to [formula] in ([\ref=icygs]) as follows:

[formula]

where [formula] is the sum of the entries in the i-th row of the pattern [formula].

Similarly, for an admissible state of Delta ice S, [formula] as defined in ([\ref=Gdelta]) is related to [formula] in ([\ref=icygs]) by

[formula]

We first illustrate this for Gamma ice with our working example from ([\ref=workingexample]) in rank 2. The admissible Gamma ice S and its associated Boltzmann weights are pictured below.

[formula]

Taking the product over all these weights, we obtain [formula], which indeed matches [formula] with [formula] as in ([\ref=workingexample]) and [formula] as in ([\ref=gofexample]).

The relevant terms in the metaplectic Whittaker function take the form

[formula]

as given in Theorem [\ref=thm:bbfm]. However, [formula] may be easily recovered from our fixed choice of highest weight [formula] and the row sums [formula] used in the monomial above. Indeed,

[formula]

Hence, upon performing this simple transformation, we may recover the monomials in q1 - 2si in ([\ref=relevantterms]) from those in zj appearing in [formula] of the above proposition. A similar set of transformations holds for the Delta rules.

Proposition [\ref=matching] is a consequence of the bijection given in Proposition [\ref=bijprop]. We sketch the proof for Gamma ice, as the proof for Delta ice is similar. Recall that -   vertical spins correspond to the entries of the pattern, so the values γ(ai,j) given in ([\ref=gammagtwt]) should appear in the Boltzmann weights for vertices sitting above a -   vertical spin. The particular cases of ([\ref=gammagtwt]) to be used are determined by the vertical spin the vertex in question. We now show that each bi,j in ([\ref=gammagtwt]) matches the charge, the number of +   signs to the right of the vertex in row i. Equivalently, we must show that every spin between column ai,j and column ai  -  1,j in row i is assigned a +  . So suppose that ai,j  >  ai  -  1,j and let v be the vertex in row i, column ai,j, and let w be the vertex in row i, column ai  -  1,j. Then the north and south spins for v are ( + , - ) which, by the six admissible configurations in Gamma ice, forces the east spin to be +  . All the vertices between v and w have north and south spins ( + , + ) according to our bijection. The east spin +   for v becomes the west spin for the neighboring vertex v' to the right of v, forcing the east spin of v' to be +   as well. This effect propogates down the row, forcing all row spins between v and w to be +  . Finally we must show that the spectral parameters for G are given by differences of consecutive row sums. This is Lemma 3 of [\cite=hkice].

Given a fixed set of boundary conditions for the vertex model and an assignment B of Boltzmann weights associated to each admissible vertex, we refer to the set of all admissible states S as a "system." Given a system [formula], its partition function [formula] is defined as

[formula]

where this latter product is taken over all vertices v in the state S. In particular, let [formula] denote the system with boundary conditions as in Section [\ref=bijectionsection], Boltzmann weights BΓ, and rows labeled in descending order from top to bottom. Similarly, let [formula] denote the system with the same boundary conditions, but with Boltzmann weights BΔ and rows labeled in ascending order from top to bottom. Using this language, we may now summarize the results of the past two sections in a single theorem.

Given a dominant weight λ for [formula], the metaplectic Whittaker function [formula] is expressible as either of the two partition functions [formula] or [formula]

This is merely the combination of Theorems [\ref=thm:bbfm] and [\ref=statementA] together with Proposition [\ref=matching].

Transfer Matrices

Baxter considered the problem of computing partition functions for solvable lattice models (cf. [\cite=baxter]). His approach is based on the idea of using the Yang-Baxter equation (called the "star-triangle identity" by Baxter) to prove the commutativity of row transfer matrices. We will show that basic properties of metaplectic Whittaker functions can be interpreted as commutativity of such transfer matrices, and at least when the metaplectic degree n  =  1, the Yang-Baxter equation can be used to give proofs of these.

The row transfer matrices shall now be described. Let us consider a row of vertices that all have the same Boltzmann weights. If B  =  (a1,a2,b1,b2,c1,c2) then we use the assignment of Boltzmann weights in the following table.

[formula]

The vertical edge spins in the top and bottom boundaries will be collected into vectors [formula] and [formula]. The subscripts correspond to the columns which, we recall, are numbered in ascending order from right to left. For example, if α  =  ( - , + , - , + , + , - ) and β  =  ( + , - , + , + , + , - ), we would consider the partition function of the following one-layer system of ice:

[formula]

Let VB(α,β) denote the partition function. Recall that we compute this as follows. We complete the state by assigning values to the interior edges (unlabeled in this figure) and sum over all such completions. Let VB be the 2N  +  1  ×  2N  +  1 matrix whose entries are all possible partition functions VB(α,β), where the choices of α and β index the rows and columns of the matrix, respectively. This is referred to as the transfer matrix for the one-layer system of size N with Boltzmann weights B at every vertex.

Now let us consider a two-layer system:

[formula]

Note that we are using two sets of Boltzmann weights B1 and B2 for the top and bottom layers, respectively. We may try to express the partition function V(α,γ) for the two layer system pictured above having top row α as in ([\ref=eq:onelayer]) and bottom row γ  =  ( + , + , + , - , + , + ) in terms of one-layer partition functions. However each one-layer system is only determined upon a choice of vertical spins lying between the rows. One such choice of edge spins is β as in the one-layer system in ([\ref=eq:onelayer]), but we must sum over all possible choices to get the partition function of the two-layer system. Therefore

[formula]

which is precisely the entry V(α,γ) in the product of the two transfer matrices VB1 and VB2.

Cases where the transfer matrices commute are of special interest. Indeed, this commutativity means that one can interchange the roles of Boltzmann weights B1 and B2 in ([\ref=eq:twolayer]) and the value of the product of the transfer matrices is unchanged. Baxter considers the case where B1  =  (a,a,b,b,c,c) and B2  =  (a',a',b',b',c',c') for arbitrary choices of a,a',b,b',c,c'. However, his boundary conditions are toroidal; that is, the boundary edges at the left and right edges of the each row are identified and treated as interior edges, hence summed over. With this modification, Baxter proves that if [formula], where [formula] and [formula] is similarly defined with a',b' and c', then the transfer matrices commute. Obtaining a sufficiently large family of commuting transfer matrices is a step towards evaluating the partition function, since by doing so one can make the eigenspaces one-dimensional. Thus the problem of simultaneously diagonalizing them has a unique solution and therefore becomes tractable.

Let us now show how Statement B may be formulated in terms of commuting transfer matrices. We consider a two layer system having a layer of Gamma ice and a layer of Delta ice, thus:

[formula]

We use the values in ([\ref=weighttable]); in the top row, the spectral parameter is z1, and in the bottom row it is z2. Regarding the boundary conditions, as always the rows of ice must have +   at the left edge and -   at the right edge. Furthermore, we fix a choice of spins for the top edge and the bottom edge of this two-layered ice such that the top edge has two more -   than the bottom row. In this example, the locations of the -   along the top edge are (reading from right to left) 0,1,4,6 and along the bottom edge, they are at 3,4. We have labeled each vertex with [formula] and [formula] to remind the reader of the Boltzmann weights that we are using. We will call this system [formula] and its partition function [formula].

On the other hand we may consider the same configuration with the roles of the Boltzmann weights for Gamma and Delta ice switched, as in the figure below. Note that the boundary conditions remain the same as in ([\ref=gammadeltaice]). We will refer to this system as [formula].

[formula]

Given top and bottom boundary values as vectors of spins α and γ and Boltzmann weights BΓ1 and BΔ2 as in ([\ref=weighttable]), let [formula] and [formula] be the systems described above. Then [formula].

We prove this by showing that the claim is equivalent to Statement B, stated as Theorem [\ref=statementB] here and proved by combinatorial means in [\cite=wmd5book]. Note in particular that we have reformulated Statement B as the commutativity of two transfer matrices.

We associate two strictly decreasing vectors of integers with α and γ, which we call [formula] and [formula]. Namely, let [formula], where the li's are the integers such that αli  =    -  , arranged in descending order; [formula] is defined similarly with regard to γ. Thus, in the example ([\ref=gammadeltaice]) above there are -   spins in the 6,4,1,0 columns of the top row and so [formula], while [formula]. Similarly, given any admissible state of the system, let β be the middle row of edge spins, and associate in similar fashion a sequence [formula] according to the location of -   signs in β.

We observe that the sequences [formula] interleave. This holds for the same reason that the rows of the pattern interleave in Proposition [\ref=bijprop]; it is a consequence of Lemma 2 of [\cite=hkice]. Therefore the legal states of either system [formula] are in bijection with the (strict) short Gelfand-Tsetlin patterns

[formula]

These are not in bijection with the terms of the sum [formula] appearing in Theorem [\ref=statementB] because there is no condition on the middle row sum. Rather, the states of ice give all possible middle row sums. However, letting [formula] denote the Boltzmann weight for a state of ΓΔ ice, this may be regarded as a homogeneous polynomial in the two spectral parameters z1 and z2 of our two-row system. In the notation of Proposition [\ref=matching], this monomial is [formula], where [formula] denotes the i-th row sum in the short Gelfand-Tsetlin pattern above. Clearly, the middle row sum can be recovered from knowledge of this monomial for fixed choice of boundary conditions α and γ, which dictate the top and bottom row of the short pattern. A similar correspondence may be obtained for the ΔΓ system whose short patterns [formula] are associated to the monomial [formula]. Of course, the boundary conditions remain constant whether we are using the ΓΔ or ΔΓ system, so [formula] and [formula]. Thus, the monomials

[formula]

agree precisely when

[formula]

which is exactly the condition on the sum in Theorem [\ref=statementB]. Hence we see that the commutativity of transfer matrices - the statement that [formula] - is an equality of two homogeneous polynomials and the matching of each monomial corresponds to the identity of Statement B for each possible middle row sum.

The Yang-Baxter Equation

The proof of Theorem [\ref=abba], the commutativity of transfer matrices, uses the equivalence with Theorem [\ref=statementB] and hence implicitly relies on all of the combinatorial methods of [\cite=wmd5book] in order to obtain this result. In this section, we want to explore the extent to which Baxter's methods for solving statistical lattice models, most notably the Yang-Baxter equation, may be used to prove the commutativity of transfer matrices.

In our context of two-dimensional square lattice models, the Yang-Baxter equation may be viewed as a fundamental identity between partition functions on two very small pieces of ice - each having 6 boundary edges to be fixed, 3 internal edges, and 3 vertices each with an assigned set of Boltzmann weights.

Let R,S, and T be three collections of Boltzmann weights associated to each admissible vertex. Then for every fixed combination of boundary conditions σ,τ,α,β,ρ,θ, we have the following equality of partition functions:

[formula]

Recall that these partition functions are sums of Boltzmann weights over all admissible states. Hence, the left-hand side is a sum over all choices of internal edge labels μ,ν,γ, while the right-hand side is a sum over internal edge labels φ,ψ,δ. Note that the roles of S and T are interchanged on the two sides of the equality.

In the diagram above one vertex, labeled R, has been rotated by [formula] for ease of drawing the systems. It should be understood in the same way as S and T - it has a Boltzmann weight associated to a set of admissible adjacent edge labels. However, vertices of this type have a distinguished role to play in the arguments that follow, so we use the term R-vertex to refer to any vertex rotated by [formula] like R in ([\ref=startriangleide]).

Once equipped with the Yang-Baxter equation, the commutativity of transfer matrices, i.e. invariance of the partition function under interchange of rows, may be proved under certain assumptions. We illustrate the method with a three-layer system of ice [formula] having boundary conditions and admissible vertices like those of the system [formula], to give the basic idea. Suppose we wanted to analyze the effect of swapping the second and third rows in the following configuration:

[formula]

Suppose there exists only one admissible R-vertex having positive spins on the right; without loss of generality we take it to have all positive spins. Then the partition function [formula] for ([\ref=rectangle]) multiplied by the Boltzmann weight for the R-vertex with all +   spins is equal to the partition function for the following configuration of ice.

[formula]

(By assumption, the only legal values for a and b are +  , so every state of this problem determines a unique state of the original problem.) Now we apply the Yang-Baxter equation to move this R-vertex rightward, to obtain equality with the the following configuration.

[formula]

Repeatedly applying the Yang-Baxter equation, we eventually obtain the configuration in which the R-vertex is moved entirely to the right.

[formula]

In drawing the above picture, we have again assumed that there is just one legal configuration for the R-vertex having two -   spins on the left, and assumed the spins of this R-vertex were all -  . If we let [formula] denote the system with the same boundary conditions as [formula] shown in ([\ref=rectangle]) but with the second and third row Boltzmann weights interchanged, we have shown

[formula]

where BR denotes the assignment of Boltzmann weight to each configuration. In particular, if the two admissible R-vertices coming from the left- and right-hand sides of ([\ref=commute?]) have equal Boltzmann weights, we obtain the exact equality of the two configurations, i.e. the commutativity of transfer matrices.

We now explore the possibility of obtaining a Yang-Baxter equation with S and T in ([\ref=startriangleide]) corresponding to the Boltzmann weights BΓ and BΔ, respectively, from ([\ref=weighttable]). In light of our previous argument, this would give an alternate proof of Theorem [\ref=statementB]. However, the Boltzmann weights in ([\ref=weighttable]) depend not only on spins +   or -   on adjacent edges, but also on a "charge" a mod n. Recall from Section [\ref=sec:imwf] that using BΓ weights, charge records the number of +   signs in a row between the given vertex and the -   boundary spin at the right-hand edge the row. Using BΔ weights, charge counts the number of -   signs between the vertex and the +   boundary at the left.

In order to demonstrate a Yang-Baxter equation, we need Boltzmann weights that are purely local -- i.e., depend only on properties of adjacent edges -- so we need a different way of interpreting charge. We do this by labeling horizontal edges with both a spin and a number mod n. We declare the Boltzmann weight of these vertices to be 0 unless the edge labels a,b mod n to the immediate left and right of the vertex reflect the way charge is counted for the given spins. For example, with BΓ weights, a  =  b + 1 if the spin below a is +   and a = b if the spin below a is -  . Using this interpretation, we record the non-zero vertices for both sets of Boltzmann weights:

[formula]

The above vertices are admissible for any choice of a mod n (and the integers a + 1 are, of course, understood to be mod n as well). This means that we are generalizing the six-vertex model, since due to the dependence on a, each vertex has more than six admissible states.

For n = 1, the charge labels on horizontal edges are trivial as the Gauss sums g(a) and h(a) are independent of a as evaluated in ([\ref=nequalone]). For this special case, it was shown in [\cite=hkice] that a Yang-Baxter equation exists with weights S and T as in ([\ref=startriangleide]) taken to be BΓ and BΔ from the table above. We refer the reader to [\cite=hkice] for the corresponding Boltzmann weights R for which the Yang-Baxter equation is satisfied. Thus we obtain an alternate proof of Theorem [\ref=theycommute], or equivalently Theorem [\ref=statementB], using methods from lattice models.

In general, we know from [\cite=wmd5book] that Theorem [\ref=theycommute] is true for any positive integer n. It would be extremely interesting to find a local relation like ([\ref=startriangleide]) similarly proving that the transfer matrices commute, and this is currently under investigation by the authors.

Weyl group invariance and the Yang-Baxter equation

Kazhdan and Patterson [\cite=kp] describe how the metaplectic Whittaker functions transform under the action of the Weyl group. This invariance--which does not follow directly from the description of the coefficients H given in Theorem [\ref=thm:bbfm]--plays a key role in the proof of the metaplectic Casselman-Shalika formula for GLr + 1 by Chinta and Offen [\cite=ChintaOffen], and was the main inspiration for the Weyl group action in [\cite=CG].

In this section we restate this Weyl group invariance in terms of the partition functions defined in the previous sections. We content ourselves to describe how a simple reflection acts on the partition function. Let σi denote the simple reflection in the Weyl group corresponding to the i-th simple root. We let σi act on the spectral parameter [formula] by [formula] i.e. the ith and (i + 1)st coordinates are transposed. Here the notation [formula] refers to the partition function associated to the system [formula], where [formula] is either of the two systems [formula] or [formula] introduced in Section [\ref=sec:imwf].

Further define, for [formula],

[formula]

where we again use the shorthand notation of ([\ref=gandhforshort]) and interpret g(0): = g(n) =  - q- 1. The functions P,Q are closely related to the functions τ1s,τ2s of [\cite=kp].

For each 1  ≤  i  ≤  r, we may decompose the partition function

[formula]

where [formula] is the sum over all states [formula] such that [formula] is equal to a constant times [formula] where [formula]. Then the Whittaker function satisfies

[formula]

We now consider the extent to which the functional equations [\eqref=eq:fe] can be interpreted in the language of transfer matrices. First we consider the case n = 1. The decomposition on the right-hand side of [\eqref=eq:decomposition] has only one term, namely Z itself, since the congruence condition is automatically satisfied by all monomials for any i. The i-th functional equation [\eqref=eq:fe] becomes

[formula]

or

[formula]

Recalling the effect of σi on [formula] defined above, the partition function on the right-hand side is the result of swapping the spectral parameters associated to rows i and i + 1 in the system [formula]. Note that [\eqref=eq:commutation] is not exactly the same as "commutation of two transfer matrices" because we do not have the identity [formula]. Indeed, the partition function Z is not a symmetric function, but it is very close to one: it is a Schur polynomial times a q-deformation of the Weyl denominator (cf. [\cite=hkice]).

Nevertheless, with assumptions as in Section [\ref=sec:ybe], we may ask for a Yang-Baxter equation leading to a proof of [\eqref=eq:commutation]. That is, we seek sets of Boltzmann weights R,S, and T satisfying [\eqref=startriangleide] where S  =  T  =  BΓ or S  =  T  =  BΔ. Comparing [\eqref=eq:commutation] with [\eqref=commute?], we further require Boltzmann weights BR for the R-vertices such that

[formula]

It follows from results in [\cite=hkice] that we may use the following coefficients in the R-vertex for Gamma ice:

[formula]

We are taking all ti =  - q- 1 in Table 1 in [\cite=hkice], and observe that the order of the rows in this paper are opposite those in that paper. Our convention here is the same as in [\cite=wmd5book].

For n > 1 the situation is more complicated, but rather suggestive. In general [formula], so we cannot rewrite [\eqref=eq:fe] to look like [\eqref=commute?] and [\eqref=eq:commutation]. However according to [\eqref=defn:PQ], the denominators of P and Q appearing in the ith functional equation [\eqref=eq:fe] are equal and independent of j. For any j, they are zni - zni + 1 / q. Thus, clearing denominators, we may rewrite [\eqref=eq:fe] as follows

[formula]

where

[formula]

Let S be a state of the system, and as before let [formula] be the exponents of [formula] in [formula]. We make the following observation. In the weights ([\ref=localweighttable]), there is a contribution of zi if and only if the charge is not augmented as we move across the vertex. Since (in Gamma ice) the charges at the right edge will have value 0, it follows that the charges at the left edge will have value ci where ai  +  ci is the number of vertices in the row. Therefore

[formula]

and we may therefore write

[formula]

We will now explain how, with a suitable R-vertex, ([\ref=fewoden]) could also be interpreted as an identity similar to ([\ref=commute?]), but now with sets of Boltzmann weights involving charges. We will describe the characteristics that such an R-vertex might have. For simplicity, we will assume that n is odd.

The value will depend on the spins and charges of the adjacent edges. Let us assume first that the spins on these four edges are all +  , with charges di  +  1, di, di  +  1', di' as follows:

[formula]

If j  =  di  +  1  -  di and j'  =  di  +  1'  -  di' then we require that the Boltzmann weight of this vertex v is zero unless [formula] or n  -  j mod n. Moreover in these cases we require that the Boltzmann weight of ([\ref=pprvertex]) is

[formula]

except when [formula]. In this case the weight will be

[formula]

since g(0)  =    -  q-  1.

Regarding the case where the vertex has spin -   on all four adjoining edges, we require that the Boltzmann weight of

[formula]

is zero unless di  =  di  +  1  =  0, in which case it is zni  +  1  -  q-  1zni.

Assuming that the R-vertex has the above properties, we may now express the functional equation in a form similar to ([\ref=commute?]). Let us fix the vertical edge spins above the zi  +  1 row and below the zi row, and work with just the two relevant rows; let [formula] denote the two-layer system consisting of just rows i + 1 and i with these boundary spins fixed. In order to establish ([\ref=eq:fe]), or equivalently ([\ref=fewoden]), it suffices to show

[formula]

Since [formula] is a homogeneous polynomial in the zi, and since only ai and ai  +  1 are allowed to vary, we have ai  +  ai + 1 equal to a constant. Since we are assuming that n is odd, there will be a unique pair of charges ci and ci  +  1 mod n such that ([\ref=constantdiff]) is satisfied, and such that [formula] modulo n.

Now let us consider the partition function of the system

[formula]

obtained by attaching the R-vertex to the left of [formula]. From the above discussion, this equals

[formula]

Similarly the partition function of the system

[formula]

is

[formula]

The equality of these partition functions implies ([\ref=fewoden]).

At this writing, we do not know if the values of the R-vertex that we have described can be completed to a full R-matrix such that the appropriate Yang-Baxter equation is satisfied. We know that this can be done when n  =  1, and since ([\ref=fewoden]) is true, it seems very plausible that this can be done in general. Thus we may conjecture that within this scheme, or some similar one, it is possible to formulate a Yang-Baxter equation adapted to these weights that gives a proof of ([\ref=fewoden]). Such a "metaplectic" Yang-Baxter equation might well have importance beyond the problems that we have discussed in this paper.