Lemma Corollary Proposition Conjecture Remark

On the cardinality of sumsets in torsion-free groups

Introduction

Let G be a torsion-free group written multiplicatively, and let |  ·  | denote the cardinality of a finite set. A basic problem in Additive Combinatorics is to estimate the cardinality of AB = {ab:  a∈A,b∈B} of two finite sets A,B  ⊂  G in terms of |A| and |B|. A basic notion is a progression with ratio r  ≠  1 and length n, which is a set of the form [formula] where a and r commute.

Let us review some related results if G is abelian. In this case we have the simple inequality

[formula]

with equality if and only if A and B are progressions with common ratio. Following Ruzsa [\cite=Ruz09], we call the minimal rank of a subgroup whose some coset contains A the dimension of A. According to Freiman [\cite=Fre73], if the dimension of A is d, then

[formula]

This estimate is optimal. It follows that if |A2|  ≤  3|A| - 4, then A is contained in some coset of a cyclic group. Actually, even a progression of length 2|A| - 3 contains A according to the (3k - 4)-theorem of Freiman [\cite=Fre73]. More precise structural information on A is available if |A2| = 2|A| + n for 0  ≤  n  ≤  |A| - 4 by Freiman [\cite=Fre09b], for example, A is contained in a progression of length |A| + n + 1.

The inequality ([\ref=Freimanmulti]) was generalized to a pair of sets by Ruzsa [\cite=Ruz94] who proved that if |A|  ≥  |B|, and the dimension of AB is d, then

[formula]

By requiring additionally that the smaller set B is d-dimensional, Gardner and Gronchi [\cite=GaG01] proved a discrete version of the Brunn-Minkowski inequality which shows that

[formula]

Additional lower bounds with stronger geometric requirements on the sets A and B have been also obtained by Matolcsi and Ruzsa [\cite=MaR] and Green and Tao [\cite=GrT06].

In the non-abelian case the situation is much less understood. Kempermann [\cite=Kem56] implies in the case of any torsion-free group G that

[formula]

Brailovsky and Freiman [\cite=BrF90] characterized the extremal sets in the inequality [\eqref=eq:kemp] by showing that, if min {|A|,|B|}  ≥  2 then, up to appropriate left and right translations, both A and B are progressions with common ratio. In particular, A and B lie in a left and a right coset, respectively, of a cyclic subgroup.

The analogy with the abelian case was extended in Hamidoune, Lladó and Serra [\cite=HLS98] to the inequality

[formula]

if |B|  ≥  4, and A is not contained in some left coset of a cyclic subgroup.

These known facts are connected with the following conjecture of Freiman (personal communication), extending the (3k - 4)-theorem above.

Let A be a finite subset of a torsion-free group with |A|  ≥  4. If

[formula]

then A is covered by a progression of length at most 2|A| - 3.

By using the so-called isoperimetric method, see Hamidoune [\cite=Ham96], [\cite=Ham08] or [\cite=Ham09], we obtain the following results:

For any integer k  ≥  1 there exists a c(k) such that the following holds. If G is a torsio-free group, A  ⊂  G is not contained in a left coset of any cyclic subgroup, B  ⊂  G has more than c(k) elements, then

[formula]

Remark Our current methods yield c(k)  ≤  32(k + 3)6.

Note that, in Theorem [\ref=thm:main], the assumption on A not being contained in a left coset of a cyclic group is crucial. For example, if A is a progression of length at most k + 2 with ratio r  ≠  1, and B is the union of two r-progressions of arbitrary length, then |AB|  ≤  |A| + |B| + k.

The value of the lower bound c(k) can be improved for unique product groups. Recall that a group G has the unique product property if, for every pair of finite sets A,B  ⊂  G, there is an element g∈AB which can be uniquely expressed as a product of an element of A and an element of B. In this case, G is torsion-free. We note that every right linearly orderable group has the unique product property, and any residually finite word hyperbolic group has a finite index unique product subgroup, according to T. Delzant [\cite=Del97]. On the other hand, it was first shown by Rips and Segev [\cite=RiS87] that not all torsion-free groups have the unique product property, and S.D. Promislow [\cite=Pro88] even provided an explicit construction for such an example. In addition, unique product groups are discussed in A. Strojnowski [\cite=Str80], S.M. Hair [\cite=Hai03], and W. Carter [\cite=Car07]. For unique product groups, the bound on c(k) in Theorem [\ref=thm:main] can be reduced to a cubic polynomial on k; namely, Lemma [\ref=unique] yields that

[formula]

We note that it can be deduced with the help of ([\ref=GG]) that in abelian torsion-free groups, the optimal order of c(k) is quadratic. The c(k) in Theorem [\ref=thm:main] is at least of quadratic order also for non-abelian unique product groups, as the following example shows.

We consider the Klein bottle group G0  =  〈u,v|u- 1vu = v- 1〉, and hence vu = uv- 1 and v- 1u = uv. Since 〈v〉 is a normal subgroup with factor isomorphic to [formula], G0 is a non-abelian unique product group. Let A  =  {1,u,v} and B  =  {uivj:i,j = 0,1,...,m - 1} for m  ≥  1. Then |B| = m2 and [formula], thus

[formula]

In line with Conjecture [\ref=conj:freiman], we conjecture that, if A = B, then the lower bound on |B| in Theorem [\ref=thm:main] can be replaced by a bound linear in k. We construct an example in the group G0 above to indicate, what to expect in Theorem [\ref=thm:main] in this case.

For m  ≥  1, let [formula] where P = {ui:i = 0,1,...,2m} and Q = {u2i:i = 0,1,...,m - 1}, and hence |A| = 3m + 1. Since v commutes with u2, we have (vuQ)(vuQ) = (vuv)uQ2 = u2Q2  ⊂  P2. Moreover, denoting by P0 and P1 the set of even and odd powers of u in P, respectively, we have [formula]. It follows that

[formula]

We note that the above example seems to match a conjecture of Freiman [\cite=Fre02], which would yield that A is the union of two progressions provided that [formula].

In the direction of Conjecture [\ref=conj:freiman] for a torsion-free group G, our results yield the following.

If A is a subset of a torsion-free group with |A|  ≥  66, and |A2| = 2|A| + n for 0  ≤  n  ≤  2- 5 / 6|A|1 / 6 - 3, then A is contained in a progression of length |A| + n + 1.

Remark In unique product groups, the conditions are |A|  ≥  63 and [formula].

If A is a finite subset of a torsion-free group G, then Corollary [\ref=A=B] provides strong structural information when |A2| is very close to 2|A|. This has been made possible in part by the known structural properties in abelian groups. Now if G is abelian and |A2| < K|A| for some K > 3 then still strong structural properties have been established by Freiman [\cite=Fre73] using multidimensional progressions, see the monograph of Tao and Vu [\cite=TaV06] or the survey by Ruzsa [\cite=Ruz09] for recent developments. But if G is any torsion-free group and [formula], then A may not be contained in an abelian subgroup. Actually, it is still not completely understood, what to expect, in spite the results about some specific groups (see Breuillard and Green [\cite=BeGI], or Tao's blog [\cite=Tao09]).

Atoms and fragments

For this section, we fix a torsion-free group G.

For n  ≥  1 and a finite non-empty set C  ⊂  G, the n-th isoperimetric number of C is defined to be

[formula]

A finite set V  ⊂  G is an n-fragment for C, if |V|  ≥  n and |VC| - |V| = κn(C). In addition an n-fragment of minimal cardinality is an n-atom for C.

Naturally, if U is an n-atom for C, then xU is also an n-atom for Cy for any x,y∈G. In what follows, we present simple statements about atoms. For the sake of completeness, we verify even the known ones, except for the following crucial property of atoms, due to Hamidoune [\cite=Ham96]: If U is an n-atom and F is an n-fragment for a finite nonempty subset C  ⊂  G, then

[formula]

This property has the following useful consequence.

For a torsion-free group G and n  ≥  1, if U is an n-atom for C  ⊂  G and [formula], then [formula].

For right translations we have a weaker result.

For a torsion-free group G and n  ≥  2, if U is an n-atom for C  ⊂  G and [formula], then

[formula]

Remark In particular, if n = 2, then [formula]. Proof: Let us partition U into the maximal left g-progressions [formula], where [formula], [formula]. In particular, [formula] for i  ≠  j. We may assume that |U1|  ≥  |Ui|, [formula] and that h1 = 1.

It follows by Corollary [\ref=atomleft] that

[formula]

thus |U1|  ≤  n. In addition, for i  ≥  2, we have

[formula]

thus |Ui|  ≤  n - 1. Therefore |U|  ≤  m(n - 1) + 1 and

[formula]

as claimed.  Q.E.D.

The minimality of the cardinality of atoms directly yields (see [\cite=Ham96] or [\cite=HLS98])

If U is an n-atom for C  ⊂  G, n  ≥  1, in a torsion-free group G, and |U| > n, then any element in UC can be represented in at least two ways as a product of an element of U and an element of C.

We deduce two rough, but useful estimates about 2-atoms which can be found in [\cite=Ham96] as well.

If U is a 2-atom for C  ⊂  G, |C|  ≥  3, in a torsion-free group G, then |U|  ≤  |C| - 1.

Proof: We may assume that |U| > 2 and 1∈C, and hence U  ⊂  UC. According to Lemma [\ref=atomnonunique], for any u∈U, there are vu∈U and [formula] such that u = vucu. If cu = cw for u  ≠  w∈U, then [formula], contradicting Corollary [\ref=atomleft]. Therefore u  ↦  cu is an injective map from U into [formula].  Q.E.D.

For any non-empty C  ⊂  G, let C- 1  =  {g- 1:  g∈C}.

If U is a 2-atom for C  ⊂  G, |C|  ≥  3, in a torsion-free group G, and |UC|  ≤  |U| + |C| + k, then |U|  ≤  k + 3.

Proof: Let V be a 2-atom for U- 1 with 1∈V, thus

[formula]

If V = {1,g} with g  ≠  1, then Lemma [\ref=atomright] yields

[formula]

which in turn implies |U|  ≤  k + 3. If |V|  ≥  3, then Lemma [\ref=atomright] and Lemma [\ref=2atomrough] yield

[formula]

which in turn implies |U|  ≤  k + 2.  Q.E.D.

Now we extend Lemma [\ref=2atom] to n-atoms, which extension is the only novel result of this section.

If U is an n-atom for C  ⊂  G, |C|  ≥  3 and n  ≥  3, in a torsion-free group G, and |UC|  ≤  |U| + |C| + k, then |U|  ≤  n(2k + 3).

Proof: Let V be a 2-atom for U- 1, hence

[formula]

It follows by Lemma [\ref=2atom] that |V|  ≤  k + 3. Moreover, by Lemma [\ref=atomright], we have [formula]. Hence,

[formula]

thus |U|  ≤  n(2k + 3).  Q.E.D.

All these statements about atoms would readily follow from the following conjecture of Y.O. Hamidoune [\cite=Ham09].

Any n-atom in a torsion-free group has cardinality n.

We recall that a group G has the unique product property if for any finite non-empty sets A,B  ⊂  G, there is a g∈AB that can be represented in a unique way in the form ab with a∈A and b∈B. In this case G is torsion-free. It follows by Lemma [\ref=atomnonunique] that unique product groups satisfy Conjecture [\ref=atom].

Small product sets

The proof of Theorem [\ref=thm:main] together with an estimate of c(k) will follow from the following Lemma and the estimations on the size of atoms in the previous section.

Let G be a torsion-free group. Suppose that A  ⊂  G with |A| = 3 is not contained in a left coset of any cyclic subgroup of G. For d  ≥  3 and any finite set B  ⊂  G of cardinality greater than 4d3, we have

[formula]

Proof: We suppose that |AB|  ≤  |B| + d, and seek a contradiction. We may assume that A = {1,u,v}, where 〈u,v〉 is not cyclic.

For g∈G, we write [formula]. Since [formula], we see that |Bu|  ≤  d. Similarly, |Bu- 1|  ≤  d, as [formula], and, of course, |Bv|,|Bv- 1|  ≤  d also hold. Since B is finite, for any x∈B the coset 〈u〉x must contain an element of Bu, hence the elements of B belong to at most d cosets of 〈u〉, and similarly for 〈v〉. Therefore there exists an x0∈B such that

[formula]

In order to simplify notation, by replacing B with Bx- 10, we may assume without loss of generality that x0 = 1. Let [formula], and [formula]. We have |B0| > 4d. Elements of Z are powers of both u and v, hence Z is contained in the center of H = 〈u,v〉. As Z  ≠  {1} and A does not generate a cyclic group, we deduce that u and v do not commute.

We are going to show that BZ  ⊇  H. Take an element g∈H, and let us choose a word of shortest length [formula], where each ai is one of u, u- 1, v, v- 1, in the coset gZ. Then the cosets Z, a1Z, a2a1Z, , [formula] are pairwise disjoint. To any x∈B0, we assign the sequence [formula], which sequences are pairwise disjoint as x runs through B0. If [formula], then there is a smallest [formula] such that [formula]. It follows that Sx has an element in [formula], namely, x if i = 1, and [formula] if i  ≥  2. Since |B0| > 4d  ≥  |Bu| + |Bu- 1| + |Bv| + |Bv- 1|, and [formula] for x  ≠  y in B0, there exists an x∈B0 such that [formula]. We conclude that [formula].

Now the index of the central subgroup Z in H is finite (bounded by |B|), so the center has finite index in H. According to a classical theorem of Schur (see, e.g., Robinson [\cite=Rob96]), this implies that the commutator subgroup of H is finite. If the commutator subgroup is 1, then H is abelian, and if the commutator subgroup is non-trivial, then we have some torsion elements. In any case, we have contradicted the assumptions on A and G, and hence proved the lemma.  Q.E.D.

Proof of Theorem [\ref=thm:main]: Without loss of generality we may assume that 1∈A. Then 〈A〉 is not cyclic by our assumption. Let B  ⊂  G be a finite set with |B| > 32(k + 3)6. If B is contained in some right coset of a cyclic subgroup H, then A intersects at least two left cosets of H. Let A1 be one of these intersections. Then using [\eqref=eq:kemp] we get

[formula]

Therefore we may assume that B is not contained in a right coset of any cyclic subgroup.

If |A|  ≤  k + 3, then let A0 = A, and if |A| > k + 3, then let A0 be a (k + 3)-atom for B with 1∈A0. By definition, |AB|  ≥  |A| + |A0B| - |A0|. Proposition [\ref=natom] gives that either |A0B| - |A0| > |B| + k, or |A0|  ≤  (k + 3)(2k + 3). If 〈A0〉 is not cyclic, then choose [formula] such that 〈u,v〉 is not cyclic. For [formula], we have, by Lemma [\ref=uvk], that

[formula]

Finally if 〈A0〉 is cyclic, then A0  ≠  A, so |A0|  ≥  k + 3, and B intersects at least two right cosets of 〈A0〉. Let B1 be one of these intersections. We have by [\eqref=eq:kemp]

[formula]

completing the argument. Q.E.D.

If G is a unique product group, then the argument above, just using Conjecture [\ref=atom] in place of Proposition [\ref=natom], leads to

Let G be a unique product group, A,B  ⊂  G finite subsets, and k  ≥  1. Suppose that A is not contained in a left coset of any cyclic subgroup, and |B| > 4(2k + 3)3, then

[formula]

Acknowledgement: We are grateful for the help of Miklós Abért, Warren Dicks, Gábor Elek and Imre Ruzsa in the preparation of this manuscript. We particularly thank Yahya O. Hamidoune for fruitful discussions on the problem addressed in this paper, and Peter A. Linnell for providing in depth information on unique product groups.

Károly J. Böröczky, carlos@renyi.hu Alfréd Rényi Institute of Mathematics, and Universitat Politècnica de Catalunya, Barcelona Tech, and Department of Geometry, Roland Eötvös University

Péter P. Pálfy, ppp@renyi.hu Alfréd Rényi Institute of Mathematics

Oriol Serra, oserra@ma4.upc.edu Universitat Politècnica de Catalunya, Barcelona Tech