Lemma Corollary Proposition Definition Example Claim

Explicit incidence bounds over general finite fields

Preliminary notation

This paper uses the following notation throughout. Given two real-valued functions f,g with domain D, we write

f  ≪  g, f = O(g) or g  =  Ω(f) if there is a constant γ such that f(x)  ≤  γg(x) for all x∈D. The implicit constant γ may be different each time this notation is used.

f  ≈  g if f  ≪  g and g  ≪  f

Given two sets [formula], we define:

the sumset [formula]

the product set [formula]

the ratio set [formula]

Introduction

Incidences

This paper is about incidences between points and lines in a plane. A point is incident to a line if it lies on that line, and a single point can be incident to more than one line if they cross at that point. An established problem is to find upper bounds for the number of incidences between finite sets of points and lines of given cardinality.

Specifically, fix a field F and an integer n, and let P and L be finite sets of points and lines respectively in the plane F  ×  F with [formula]=[formula]. Define

[formula]

to be the cardinality of the set of incidences between P and L. The problem is to establish upper bounds on I(P,L). A straightforward exercise in combinatorics [\cite=TV] shows that one always has [formula]. So non-trivial incidence bounds are those of the form [formula] for positive ε.

Known bounds

Different bounds are known for different choices of the field F. Things are largely settled in the settings [formula] and [formula]. The result ε  =  1 / 6 was obtained in these settings, by Szeméredi and Trotter [\cite=ST] and Tóth [\cite=toth] respectively. In both cases, the bound holds unconditionally and is sharp up to multiplicative constants.

Much less is known in the finite field setting [formula]. It is certainly not possible to have a non-trivial bound that holds in all cases, as the trivial bound [formula] is achieved when P = F  ×  F and L is the set of lines determined by pairs of points in P. So one must impose some extra condition on P.

When [formula] is a finite field of prime order this can be simply a cardinality condition. The best-known result in this setting, due to Helfgott and Rudnev [\cite=HR], requires simply that n is strictly less than p, and guarantees that ε  ≥  1 / 10678 when this condition is satisfied. This result is unlikely to be best-possible, and followed work of Bourgain, Katz and Tao [\cite=BKT] which established the existence of a non-trivial ε > 0 so long as n < p2 - δ(ε), but did not quantify it.

Bounds over general finite fields

The Helfgott-Rudnev bound is known only in [formula], and so one would like to extend it to general (i.e. not necessarily prime) finite fields [formula]. In particular, it would be good to extend to [formula], as this is the finite analogue of [formula]. However, general finite fields can have subfields, and so stronger conditions than just cardinality are required on P. This is because, as with the example above, if K is a subfield of F then the trivial bound [formula] can be achieved when P is the subplane K  ×  K.

It is therefore an interesting problem to find conditions on [formula] for which an explicit Helfgott-Rudnev-type bound holds for any L with |L| = |P|. Progress on this problem sheds light on the relationship between the algebraic structure of fields and the geometric structure of incidences. Ultimately one would like to find an algebraic condition for P that is both necessary and sufficient for an explicit incidence bound.

The natural condition to try imposing on P would be to insist that it is 'not too close' to being a copy of a subplane, for example by ensuring that its projection onto one of either the x- or y-axis is 'not too close' to a copy of a subfield. However, the currently-known approaches for proving Helfgott-Rudnev-type bounds rely on first applying a projective transformation to P, which could disrupt such a condition. So any condition must, additionally, be preserved by projective transformation.

Results

We present an incidence result in [formula], which holds so long as P satisfies certain conditions. Informally, these are that the projection A(P) of P onto some co-ordinate axis has no more than 'half-dimensional interaction' with 'large' subfields G of [formula], where 'large' will be defined relative to the cardinality n = |P|.

By no more than 'half dimensional interaction', we mean that A(P) does not intersect an affine copy of G in more than |G|1 / 2 places, and intersects no more than |G|1 / 2 distinct translates of G. Since the motivation is that such sets are a long way from being fields, we shall call them 'antifields' and 'strong antifields'.

Let F be a field and λ > 0.

Let A  ⊆  F. Then

A is a [formula]-antifield if [formula] for all subfields G of F and all a,b∈F.

A is a [formula]-strong-antifield if it is a (1,λ)-antifield and, for every subfield G with |G|  ≥  λ, it intersects strictly fewer than [formula] distinct translates G + b of G.

Let P  ⊂  F  ×  F. Then

P is a [formula]-antifield if the set [formula] is a (1,λ)-antifield

P is a [formula]-strong-antifield if the set [formula] is a (1,λ)-strong-antifield

Note that since one can always apply a change of basis, the projection can in fact be onto any vector multiple of [formula].

Parts 1.(a) and 2.(a) of the definition are motivated by work of Katz and Shen [\cite=KS] generalising sum-product bounds in [formula] to [formula]. Parts 1.(b) and 2.(b) are motivated by the need to avoid disruption by projective transformations. A key idea, which shall be seen later, is that certain projective images of a strong antifield will always be antifields.

We are now able to state the result:

There is an absolute constant γ such that if F is a finite field, P and L are sets of points and lines respectively in F  ×  F with |P| = |L| = n, and P is additionally a [formula]-strong-antifield, then [formula].

The majority of this paper is concerned with the proof of Theorem [\ref=theorem:result]. But since it is not necessarily obvious that many point sets should satisfy the conditions of the theorem, we shall first show that it is easy to construct examples in the important cases q = p2 and q = p4. This is demonstrated by the following two corollaries; the first corollary demonstrates the requirement for limited interaction with subfields, and the second corollary demonstrates how one can ignore 'small' subfields.

Let [formula] with |P| = n, and define [formula]. Let t be a defining element of [formula] over [formula], so that [formula]. Suppose that |A|  ≪  p and that [formula] where [formula] with [formula], and [formula] with [formula] for each j∈J. Then we have [formula] for all sets of lines L in [formula] with |L| = n.

We need to show that the hypotheses imply that P is a [formula]-strong-antifield. To do this, we first need to show that P is simply a [formula]-antifield. Note that the only sets of the form [formula] with [formula] are given by [formula] and [formula], where j,k range over [formula]. Note further that [formula]. We know by assumption that

[formula]

for each [formula]. Observe that

[formula]

So we conclude that P is a [formula]-antifield. Since [formula] it is also a [formula]-strong-antifield, as required.

Let [formula] with [formula], and define [formula]. Let t be a defining element of [formula] over [formula], so that [formula]. Suppose that |A|  ≪  p2 and that [formula] where [formula] with [formula], and [formula] with [formula] for each j∈J. Then we have [formula] for all sets of lines L in [formula] with |L| = n.

We need to show that the hypotheses imply that P is a [formula]-strong-antifield. Note that since [formula], we can ignore the subfield [formula] and need check this only with respect to the subfields [formula] and [formula]. This checking follows Corollary [\ref=theorem:p^2].

Structure for proving Theorem [\ref=theorem:result]

The rest of the paper is concered with proving Theorem [\ref=theorem:result]. This section outlines the structure of the proof. It states results, which will be proved later, and shows how they fit together to give the overall proof. There are two components to this. The first component is a key lemma that relates the algebraic and geometric structure of antifields. The second component uses this key lemma, and a method of Katz and Shen [\cite=KS], as part of an otherwise technical generalisation of the Helfgott-Rudnev proof.

The first component: Relating the algebraic and geometric stucture of antifields

Recall that we defined both antifields and strong-antifields, that both are defined algebraically, and that Theorem [\ref=theorem:result] is a statement about strong-antifields. The first component of the proof of Theorem [\ref=theorem:result] is to relate the algebraic and geometric structure of these objects by showing that under certain projective transformations the image of a strong-antifield is an antifield.

The formal statement is expressed in terms of cross ratios. These are projective invariants, which means that they are preserved by projective transformations of a line and so are important in projective geometry.

Let F be a field and let a,b,c,d∈F with a  ≠  d and b  ≠  c. Then define the cross ratio X(a,b,c,d) by

[formula]

We can now state the key lemma:

Let A  ⊆  F be a (1,λ)-strong-antifield and let B  ⊆  F. Suppose there is a cross-ratio-preserving injection τ:B  →  A (i.e. an injection τ for which X(τ(b1),τ(b2),τ(b3),τ(b4)) = X(b1,b2,b3,b4) whenever b1,b2,b3,b4∈B). Then B is a (1,λ)-antifield.

The second component: Applying the first component in a technical modification of the Helfgott-Rudnev proof

The structure of the second component broadly follows [\cite=HR]. It begins by applying Lemma [\ref=theorem:key] in an adaptation of an argument of Bourgain, Katz and Tao [\cite=BKT] to replace L and P with a construction of lines and points of a certain form, at the expense of some incidences and of passing from a strong-antifield to an antifield.

Let F be a field, and let P and L be a set of lines and points respectively in F  ×  F with |P| = |L| = n such that [formula] for some ε > 0. Let λ  ≥  0. Then, if P is a (2,λ)-strong-antifield there exist:

Sets A,B  ⊆  F with [formula] and 0∉B

A set LA of lines through the origin with gradients in A.

A set LB of horizontal (i.e. gradient 0) lines with y-intercepts in B

A (2,λ)-antifield P* with |P*|  ≤  n, the points of which each lie on the intersection of a line in LA with a line in LB.

such that [formula] where L(P*) is the set of lines determined by pairs of points in P*.

Following [\cite=HR] we then generalise the definition of incidences to colinear k-tuples for any integer k:

Let F be a field. Let P be a finite set of points in F  ×  F and let L be a finite set of lines in F  ×  F. We define the number of colinear k-tuples between P and L, denoted Ik(P,L) by

[formula]

This generalises the definition of incidences because I(P,L) = I1(P,L). Moreover, the following lemma shows that Hölder's inequality relates incidences to colinear k-tuples:

Let F be a field and [formula]. Let P,L be sets of points and lines in F  ×  F. Then we have [formula].

Define [formula] by [formula] where δlp = 1 if p∈L and 0 otherwise, i.e. f(l) is the number of points in P that are incident to l. Note that [formula]. Hölder's inequality implies that [formula], which is the same as [formula].

Applying Lemma [\ref=theorem:relation] with k = 3 reinterprets Proposition [\ref=theorem:propbelow] as a lower bound on colinear triples:

With the notation in Proposition [\ref=theorem:propbelow] and Definition [\ref=theorem:colinear], we also have [formula]

So we have a lower bound on colinear triples in P*. Separately, the next proposition gives an upper bound on this quantity, which is obtained by combinatorial methods. Its proof uses the method in [\cite=KS] to adapt the approach in [\cite=HR].

There is an absolute constant γ1 such that if:

F is a field and A, B are finite subsets of F with 0∉B.

LA is the set of lines through the origin with gradients lying in A.

LB is the set of horizontal lines crossing the y-axis at some b∈B.

P is a set of points, each lying on the intersection of some line in LA with some line in LB.

[formula].

P is, additionally, a [formula]-antifield.

Then:

The results collected above then allow us to prove Theorem [\ref=theorem:result]:

Proving Theorem [\ref=theorem:result] from the propositions

Let |P| = |L| = n with [formula]. If ε  >  1 / 12838 then we are already done, so assume that ε  ≤  1 / 12838. We shall find a constant γ such that ε  ≥  1 / 12838 so long as P is a [formula]-strong-antifield.

So let us suppose that P is a [formula]-strong-antifield, where γ is a constant to be specified. Apply Proposition [\ref=theorem:propbelow] and Corollary [\ref=theorem:below] to obtain a particular [formula]-antifield P* for which

[formula]

and for which Proposition [\ref=theorem:above] is applicable so long as

[formula]

where γ1 is an absolute constant. Note also that

[formula]

Now, since ε  ≤  1 / 12838 and combining [\eqref=eq:below] and [\eqref=eq:abound], we see that there is an absolute constant γ2 such that

[formula]

So we can ensure that [\eqref=eq:req] holds by taking [formula]. We therefore have by Proposition [\ref=theorem:above] that

[formula]

Comparing [\eqref=eq:below] and [\eqref=eq:above], plugging in [\eqref=eq:abound], and taking logs then yields ε  ≥  1 / 12838 as required.

The rest of this paper

The proof of Theorem [\ref=theorem:result] will be complete once Propositions [\ref=theorem:propbelow] and [\ref=theorem:above] have been established. Lemma Lemma [\ref=theorem:key] is used for proving Propositions [\ref=theorem:propbelow]. The proofs of these three results are the subject of the rest of the paper:

Section [\ref=section:aflemma] presents the proof of Lemma [\ref=theorem:key]

Section [\ref=section:BKTproof] presents the proof of Proposition [\ref=theorem:propbelow].

Section [\ref=section:lemmata] collects some technical lemmata that will be useful when proving Proposition [\ref=theorem:above], some with proof and some without.

Finally, Section [\ref=section:above] presents the proof of Proposition [\ref=theorem:above].

Proving Lemma [\ref=theorem:key]

This section is concerned the proof of Lemma [\ref=theorem:key]. Recall the statement of the lemma:

Lemma [\ref=theorem:key]

Let A  ⊆  F be a (1,λ)-strong-antifield and let B  ⊆  F. Suppose there is a cross-ratio-preserving injection τ:B  →  A (i.e. an injection τ for which X(τ(b1),τ(b2),τ(b3),τ(b4)) = X(b1,b2,b3,b4) whenever b1,b2,b3,b4∈B). Then B is a (1,λ)-antifield.

For a set A, define [formula]. To prove Lemma [\ref=theorem:key] we will need the following intermediate result:

Let F be a field. Suppose A  ⊆  F and there is a subfield G of F for which X(A)  ⊆  G. Then either [formula] for all x,y∈F, or there exist x,y∈F such that A  ⊆  xG + y.

We show that if [formula] then A  ⊆  xG + y. Let a,b,c be three distinct elements of [formula] and suppose for a contradiction that [formula]. Then we can find d∈A with d∉xG + y. So we have

[formula]

where g1,g2,g3,g4∈G and [formula]. Moreover, since a,b,c are distinct, we know that g1,g2,g3 are distinct. Finally, we know that a,b,c  ≠  d. We then know by assumption that

[formula]

But we also have

[formula]

Since g1,g2 and g3 are distinct, this means that

[formula]

and so there exists g5∈G with

[formula]

We now split into two cases, according to whether or not g5 = 1. If g5 = 1 then we obtain g3 = g1, which contradicts the fact that these two elements are distinct. If g5  ≠  1 then we obtain

[formula]

which contradicts the fact that [formula]. Either way, we are done.

Let F be a field, G be a subfield of F, A  ⊆  F be a (1,λ)-strong-antifield, and A'  ⊆  A be such that [formula]. Then [formula].

Suppose that there exists A'  ⊆  A with [formula] and X(A')  ⊆  G. Then by Lemma [\ref=theorem:cr], either A'  ⊆  aG + b for some a,b∈F, or [formula] for all a,b∈F.

In the former case, we have [formula] and so [formula]. In the latter case we have [formula] for all distinct translates G + b of G, which means that A' and therefore A intersects at least [formula] such translates.

Either way, we contradict the fact that A is a (1,λ)-strong-antifield and are therefore done.

We are now in a position to prove Lemma [\ref=theorem:key].

Proof of Lemma [\ref=theorem:key]

Suppose for a contradiction that there is a subfield G of F and elements a,b∈F such that

[formula]

Let [formula]. Then we have τ(B')  ⊆  A and [formula], but also X(τ(B')) = X(B')  ⊆  G. This contradicts Corollary [\ref=theorem:coroll] and so we are done. This completes the proof of Lemma [\ref=theorem:key].

Proof of Proposition [\ref=theorem:propbelow]

We will now use Lemma [\ref=theorem:key] to prove Proposition [\ref=theorem:propbelow]. Recall the statement of Proposition [\ref=theorem:propbelow]:

Proposition [\ref=theorem:propbelow]

Let F be a field, and let P and L be a set of lines and points respectively in F  ×  F with |P| = |L| = n such that [formula] for some ε > 0. Let λ  ≥  0. Then, if P is a (2,λ)-strong-antifield there exist:

Sets A,B  ⊆  F with [formula] and 0∉B

A set LA of lines through the origin with gradients in A.

A set LB of horizontal (i.e. gradient 0) lines with y-intercepts in B

A (2,λ)-antifield P* with |P*|  ≤  n, the points of which each lie on the intersection of a line in LA with a line in LB.

such that

[formula]

where L(P*) is the set of lines determined by pairs of points in P*.

Recall that for a point p and a line l we define δpl to be 1 if p∈l and 0 otherwise. We initially follow [\cite=BKT] and [\cite=HR].

The first step is to show that we may assume every point in P is incident to [formula] and [formula] lines in L. Indeed, let [formula]. Then:

[formula]

Similarly, let [formula]. Then:

[formula]

So between them P+ and P- contribute only five sixths of the [formula] incidences. Without loss of generality we shall discard them and assume from now on that |P|  ≤  n, and that every point p∈P is incident to [formula] and [formula] lines in L.

Let L1 be the set of "rich" lines in L defined by

[formula]

Let P1 be the set of points in P that are "bushy" relative to L1, defined by

[formula]

We need to check that P1 is non-empty. Note firstly that

[formula]

and therefore I(P,L1)  ≫  I(P,L). Now note that

[formula]

This means that I(P1,L1)  ≫  I(P,L1)  ≫  I(P,L) and so P1 is certainly non-empty. Now for each p∈P1 let Pp be the set of points in P that are joined to p by a line in L1. We have:

[formula]

This means that:

[formula]

where the second inequality follows by Cauchy-Schwartz. So we have:

[formula]

For each p∈P define xp to be the x-co-ordinate of p. And for each x∈F define [formula]. It is easy to see that [formula] and so we deduce that [formula] for every x∈F. Plugging this into [\eqref=equat:cspigeon] yields

[formula]

We can therefore fix two distinct points p,q∈P1 with xp  ≠  xq such that

[formula]

Now let [formula] and note that

[formula]

Since I(Pxp,L)  ≤  n we can discard all points in Pxp other than p , and thereby assume [formula].

At this point we diverge from [\cite=BKT] and [\cite=HR]. All we shall carry forward are the facts that:

[formula].

P' is a (2,λ)-strong-antifield.

There are two points p,q, lying on distinct vertical lines, such that [formula] where Pp is a set of points lying on [formula] lines through p, and Pq is a set of points lying on [formula] lines through q

No point in P' lies on the vertical line through p.

These facts are unaffected by translation of P' and so without loss of generality we shall assume that p is in fact the origin.

Recall that the projective plane [formula] is defined to be [formula], modulo dilations. We embed F  ×  F in [formula] by identifying (x,y)∈F  ×  F with [formula]. This accounts for all elements of [formula] apart from those of the form (x,y,0); these are said to lie on the line at infinity. For our purposes, the only such point we need consider is the point (1,0,0). Every line incident to this point has gradient 0, and is therefore horizontal. A projective transformation is an invertible linear map from [formula] to itself, i.e. a 3  ×  3 non-singular matrix, and has the important property that it maps points to points and lines to lines.

Returning to the proof, we apply the projective transformation τ given by

Note that:

[formula]

τ maps the y-axis to the line at infinity. In particular, it maps the origin (which we have assumed to be p) to the point at infinity with gradient 0, and so the points in τ(Pp) lie on [formula] horizontal lines.

Since P' has no points on the y-axis, the image τ(P') is contained in F  ×  F.

Since q does not lie on the y-axis, the point τ(q) lies in F  ×  F and not the line at infinity. Every point in τ(Pq) lies on one of [formula] lines through τ(q).

[formula] for each point (x,y) with x  ≠  0. So the map x  ↦  x- 1 is a cross-ratio-preserving injection from [formula] to [formula]. Since P' is a (2,λ)-strong-antifield, Lemma [\ref=theorem:key] implies that τ(P) is a (2,λ)-antifield.

From the above we see that we have a (2,λ)-antifield P*  =  τ(P') such that:

[formula]

Each point in P* lies on

one of [formula] lines that pass through a single point s in F  ×  F.

one of [formula] horizontal lines.

The properties above are again invariant under translation and so without loss of generality we may assume that s is the origin. And since each horizontal line in P* contributes at most n incidences we can discard points to assume that 0∉B. We then take A to be the set of gradients of the [formula] lines through the origin, and B to be the y-intercepts of the [formula] horizontal lines. This completes the proof of the proposition.

Lemmata for proving Proposition [\ref=theorem:above]

This section collects the technical lemmata that will be used to prove Proposition [\ref=theorem:above].

Pivoting results

We will make use of some 'pivoting' results. The first, Lemma [\ref=theorem:pivot2], was applied in the Helfgott-Rudnev proof [\cite=HR], and before that in e.g. [\cite=GK], [\cite=garaev], [\cite=KSprime], [\cite=shen] and [\cite=li]. It is stated here without proof.

Let F be a field, let Z  ⊆  F and let [formula]. Let a,b∈F. Then if [formula] there exist z1,z2,z3,z4∈aZ + b such that for all Z'  ⊆  Z with [formula] we have [formula]

The next lemma is a quick and well-known result that is a necessary tool for the lemma that follows it:

Let F be a field, let Z  ⊆  F and let [formula]. If x∉R(Z) then [formula].

Clearly [formula], so we seek [formula]. If there exist z1,z2,z3,z4∈Z with z2  ≠  z4 and z1 + xz2 = z3 + xz4, then we can write [formula], which contradicts the fact that x∉R(Z). So there is only one way of writing each elemnent v∈Z + xZ in the form v = z1 + xz2 with z1,z2∈Z. We therefore have [formula], as required.

Lemma [\ref=theorem:pivot1], due to Katz and Shen [\cite=KS], generalises an approach that is traditionally used in conjunction with Lemma [\ref=theorem:pivot2]. The generalistation means that the result allows for the possibility of nontrivial additive subgroups.

Let F be a field and let Z  ⊆  F be finite such that [formula] is not a subfield of F. Let a,b∈F. Then either

[formula] is not closed under multiplication, in which case there exist x1,x2,z1,z2,z3,z4∈Z such that [formula] for all Z'  ⊆  Z.

[formula] is closed under multiplication but is not closed under addition, in which case there exist y1,y2,y3,y4∈Z such that [formula] for all Z'  ⊆  Z.

Note that R(aZ + b) = R(Z) so without loss of generality we may assume a = 1 and b = 0.

Case 1

Since R(Z)  ·  R(Z)  ≠  R(Z) there are x1,x2,x3,x4,y1,y2,y3,y4∈Z with

[formula]

This can be written as

[formula]

and so there are a1,a2,b1,b2,b3,b4∈Z with [formula]. We therefore have that for any Z'  ⊆  Z

[formula]

This completes the proof of Case 1.

Case 2

We seek z1,z2,z3,z4∈Z such that [formula]. We will then be done, as for any Z'  ⊆  Z we will have

[formula]

Since R(Z) + R(Z)  ≠  R(Z) there are x1,x2,x3,x4,y1,y2,y3,y4∈Z with

[formula]

On the other hand, since R(Z)  ·  R(Z) = R(Z) there are z1,z2,z3,z4∈Z with

[formula]

Combining these two facts gives:

[formula]

This completes the proof of Case 2 and therefore of the lemma.

We will also use the following lemma, due to Katz and Shen. A proof can be found in [\cite=KS].

If R(Z)  ⊆  G for some subfield G of F, then Z  ⊆  aG + b for some a,b∈F

A lemma about sumsets

The following lemma was used in the Helfgott-Rudnev paper [\cite=HR], and is originally due to Bourgain [\cite=bourgain]:

Let F be a field. Let X and Y be finite subsets of F and let [formula] Then there exist elements x1,x2,x3∈X such that [formula].

Let E be the number of solutions to the equation x1 + yx2  =  x3 + yx4 with x1,x2,x3,x4∈X and y∈Y. Then

[formula]

So there exist z1,z2∈X such that the equation x1 + yz1 = z2 + yx2 has [formula] solutions [formula]. In other words, if X1 = X - z1 and X2 = X - z2 then there are [formula] solutions (u,v,y)∈X1  ×  X2  ×  Y to the equation v = yu. By averaging, there is an element u* = x* - z1∈X1 with x*∈X such that v = yu* has [formula] solutions. Thus:

[formula]

Standard results from additive combinatorics

We record some standard results from additive combinatorics. The first, below, formalises a common technique.

Let X be a finite set and let [formula] be a function. Then there is a subset Y  ⊆  X with [formula] such that for any y∈Y we have [formula]

Let [formula] where [formula]. We seek to show that [formula]. We see this as follows:

[formula]

So we have

[formula]

We will use the following form of the Plünnecke-Ruzsa inequality, due to Ruzsa [\cite=ruzsa]:

Let [formula]. Then [formula]

The following lemma is a version of the Balog-Szemerédi-Gowers theorem. A proof can be found in [\cite=TV], but this appears to have a typographical error which leads to an exponent of - 4, rather than the correct exponent of -5 below. See [\cite=FS] for a proof yielding the exponent of - 5.

Let X,Y be additive sets with [formula]. Suppose that there is a subset G  ⊆  X  ×  Y such that [formula] and that [formula] for some α∈(0,1). Then there exist subset X'  ⊆  X and Y'  ⊆  Y with [formula] such that [formula]

A proof of the following 'covering' result can be found in [\cite=shen].

Let G be a group and B,C  ⊆  G be finite. Let ε∈(0,1). Then the number of translates of C required to cover [formula] elements of B is [formula].

Proof of Proposition [\ref=theorem:above]

Recall the statement of Proposition [\ref=theorem:above]:

Proposition [\ref=theorem:above]

There is an absolute constant γ1 such that if:

F is a field and A, B are finite subsets of F with 0∉B.

LA is the set of lines through the origin with gradients lying in A.

LB is the set of horizontal lines crossing the y-axis at some b∈B.

P is a set of points, each lying on the intersection of some line in LA with some line in LB.

[formula].

P is, additionally, a [formula]-antifield.

Then:

This section uses the results of Section [\ref=section:lemmata] to prove Proposition [\ref=theorem:above].

Structure of the proof

We shall assume that P is a (2,λ) antifield for some λ, and then show that the conclusion of the Proposition follows when [formula].

The proof of Proposition [\ref=theorem:above] uses the following three claims, whose proofs are deferred. Instead, we shall first see how they are applied to prove the proposition. The proofs of the claims then follow.

There is a subset [formula] with [formula] such that for each c∈C there is a pair of (1,λ)-antifields A1c,A2c  ⊆  F with

[formula]

[formula]

Moreover, there exists a particular element c*∈C such that, writing A* = Ac*, we have

[formula]

for all c∈C.

The following bounds hold for each c∈C

[formula]

[formula]

[formula]

[formula]

There exists an integer Γ with

[formula]

such that given any c∈  ±  C, [formula], and D  ⊆  A2*, a constant proportion of cD + x can be covered with Γ translates of A1*

Proof of Proposition [\ref=theorem:above], assuming claims

Apply Lemma [\ref=theorem:intersection] with X = A2*, [formula] and, by inequality [\eqref=claim4], [formula]. This provides a1,a2,a3∈A2* such that

[formula]

For convenience, define [formula], to give the lower bound

[formula]

We seek an upper bound for [formula] with which to compare [\eqref=zbound]. There are three possible cases:

[formula] is not closed under multiplication. By Lemma [\ref=theorem:pivot1] there are then elements c1,c2,d1,d2,d3,d4∈C such that for every Z'  ⊆  Z with [formula] we have

[formula]

[formula] is closed under multiplication but is not closed under addition. By Lemma [\ref=theorem:pivot1] there are then elements c1,c2,c3,z4∈C such that for every Z'  ⊆  Z with [formula] we have

[formula]

[formula] is a field, G say. Lemma [\ref=theorem:ratiofield] implies that in this case we have Z  ⊆  aG + b for some a,b∈F. So, collecting together various facts, we have

Z  ⊆  A2* - a1.

A2* is a [formula]-antifield, and therefore so is A2* - a1.

Z  ⊆  aG + b for some a,b∈F.

[formula].

So for some [formula], the definition of a (2,λ)-antifield implies that [formula]. Lemma [\ref=theorem:pivot2] then implies that there are elements c1,c2,c3,c4∈C such that for every Z'  ⊆  Z with [formula] we have

[formula]

Dealing with Case 1

Given any Z'  ⊆  Z with [formula] and any E  ⊆  A2* with [formula], apply Lemma [\ref=theorem:plunnecke] with X = c1(d1 - d2)E and k = 3 to get

[formula]

By definition of Γ from Claim [\ref=theorem:coveringclaim], there is a subset S1  ⊆  A2* with [formula] such that d1S1 can be covered with Γ copies of A1*. Further, there is a subset S2  ⊆  S1 with [formula] such that - d2S2 can be covered with Γ copies of A1*. And there is a subset S3  ⊆  S2 with [formula] such that c1S3 can be covered with Γ copies of A1*. Set E = S3, so that d1E, - d2E and c1E can be covered with Γ copies of A1* each.

Similarly, recall that Z  ⊆  A2*  -  a1, and pick Z'  ⊆  Z with [formula] such that d3Z',- d4Z' and - c2Z' can each be covered with Γ copies of A1* each. Altogether, this means that:

[formula]

Lemma [\ref=theorem:plunnecke] and the bound in Claim [\ref=theorem:coveringclaim] then give

[formula]

Comparing with [\eqref=zbound] gives [formula], which satisfies the bound in the statement of the proposition.

Dealing with Case 2

Given any any Z'  ⊆  Z with [formula] and any E  ⊆  A2* with [formula] we can apply Lemma [\ref=theorem:plunnecke] with [formula] and k = 2 to get

[formula]

As in Case 1, pick Z' and E so that:

[formula]

Lemma [\ref=theorem:plunnecke] then gives:

[formula]

Comparing with [\eqref=zbound] gives [formula],which satisfies the bound in the statement of the proposition.

Dealing with Case 3

As with Cases 1 and 2, pick Z' so that

[formula]

Then Lemma [\ref=theorem:plunnecke] gives

[formula]

Comparing with [\eqref=zbound] gives [formula], which satisfies the bound in the statement of the proposition.

The proof of the proposition is therefore complete, subject to the proofs of Claims [\ref=theorem:bsgclaim], [\ref=theorem:sumsetclaim] and [\ref=theorem:coveringclaim], which are given below.

Proof of Claim [\ref=theorem:bsgclaim]

Every point in P is the intersection of a horizontal line in LB (with y-co-ordinate lying in B) and a line through the origin in LA (with gradient lying in A). Denote the lines in LB by hb for each b∈B and the lines in LA by da for each a∈A. Furthermore, for each b∈B define the set Xb  ⊆  F by

[formula]

Note that Xb is a (1,λ)-antifield for each b∈B as it is contained in the (1,λ)-antifield [formula]

Now, the set of lines L(P) and the set of points P generate T colinear triples. So, by averaging, there are two distinct elements b1,b2∈B such that there are [formula] colinear triples (p1,p2,p3)∈P  ×  P  ×  P with p1∈hb1 and p2∈hb2.

By Lemma [\ref=theorem:popularity] there is then a set B'  ⊆  B with [formula] such that, for each b∈B', there are [formula] colinear triples (p1,p2,p3)∈P  ×  P  ×  P with p1∈hb1, p2∈hb2 and p3∈hb.

This is the same as saying that for each b∈B' there are [formula] elements x1∈Xb1 and x2∈Xb2 for which

[formula]

So for each b∈B', we can apply the Balog-Szemeredi-Gowers theorem (Lemma [formula]) with [formula], [formula], n = |A|, [formula] and [formula] to find subsets A1b  ⊆  Xb1 and A2b  ⊆  Xb2 with

[formula]

[formula]

Moreover, note that A1b and A2b are both (1,λ)-antifields for each b∈B' as they are contained in the (1,λ)-antifields Xb1 and Xb2 respectively.

By dropping at most one element we may assume that b2∉B'. Now let [formula] and note that the map [formula] is a bijection. Define sets A1c,A2c by Aic = Aib(c) for each c∈C'. Then we have

[formula]

[formula] for each c∈C'

[formula] for each c∈C'

Let Pc = A1c  ×  A2c, so that [formula] for each c∈C'. Cauchy-Schwartz implies that:

[formula]

So there is a particular element c*∈C' such that

[formula]

Lemma [\ref=theorem:popularity] then yields a subset C  ⊆  C' such that

[formula] for all c∈C

[formula]

Note that [formula] to see that

[formula]

for each c∈C. This completes the proof of the claim.

Proof of Claim [\ref=theorem:sumsetclaim]

The claim is proved by repeated application of Lemma [\ref=theorem:plunnecke] and inequalities [\eqref=size], [\eqref=sumset] and [\eqref=intersection]:

Proof of [\eqref=claim1]

Lemma [\ref=theorem:plunnecke] and the inequalities [\eqref=size] and [\eqref=sumset] imply that

[formula]

Similarly for [formula], which completes the proof of [\eqref=claim1].

Proof of [\eqref=claim2]

Lemma [\ref=theorem:plunnecke], and inequalities [\eqref=intersection] and [\eqref=claim1], imply that

[formula]

Now apply Lemma [\ref=theorem:plunnecke] again, with [\eqref=sumset] and [\eqref=intersection], to see that

[formula]

which completes the proof of [\eqref=claim2]

Proof of [\eqref=claim3]

Lemma [\ref=theorem:plunnecke], and inequalities [\eqref=sumset], [\eqref=intersection], [\eqref=claim1] and [\eqref=claim2], imply that:

[formula]

which completes the proof of [\eqref=claim3]

Proof of [\eqref=claim4]

Lemma [\ref=theorem:plunnecke], and inequalities [\eqref=sumset], [\eqref=intersection], [\eqref=claim1] and [\eqref=claim3], imply that

[formula]

This completes the proof of [\eqref=claim4], and therefore of the whole claim.

Proof of Claim [\ref=theorem:coveringclaim]

Given D  ⊆  A2*, [formula] and c∈C, use the covering lemma (Lemma [\ref=theorem:covering]) to cover a constant proportion of cD + x with

[formula]

translates of [formula], and hence with the same number of translates of A1*. Lemma [\ref=theorem:plunnecke] and the inequalities [\eqref=sumset],[\eqref=intersection] and [\eqref=claim1] then give:

[formula]

The proof is similar when c∈ - C. This completes the proof of the claim.

Acknowledgements

The author is grateful to Oliver Roche-Newton and Misha Rudnev for useful discussions and for pointing out various typographical errors in earlier drafts, and to Nick Gill for asking some awkward questions.