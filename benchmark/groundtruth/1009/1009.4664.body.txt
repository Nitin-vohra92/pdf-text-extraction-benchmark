Theorem Theorem Definition Claim Lemma Corollary Conjecture Proposition Criterion Algorithm Definition/Proposition Example Remark

[formula] level 1 conformal blocks divisors on [formula]

Introduction

The moduli spaces [formula] of Deligne-Mumford pointed stable curves of genus g are central objects of study in algebraic geometry and mathematical physics. Given a simple Lie algebra [formula], a positive integer [formula] called the , and an n-tuple of dominant integral weights [formula] with each λi of level [formula], the WZW model of conformal field theory can be interpreted as defining vector bundles on [formula] whose fibers are the so-called vector spaces of conformal blocks. These vector bundles were first constructed by Tsuchiya, Ueno, and Yamada [\cite=Ueno]; their ranks are computed by the famous Verlinde formulae [\cite=Verlinde], [\cite=Faltings].

In this work, we study the divisors [formula] on [formula] associated to the conformal blocks bundles given by [formula], level 1, and weights [formula]. Here the ωi denote the fundamental dominant weights. Fakhruddin showed that for [formula] level 1, conformal blocks vector bundles have rank 1 [\cite=Fakh]*5.2.5. If the set of weights [formula] is Sn-symmetric, then we write Dn1,j for the corresponding divisor.

Conformal blocks bundles on [formula] are globally generated ([\cite=Fakh]*Lemma 2.2) and hence they define morphisms to projective varieties [formula]. The morphisms determined by the conformal blocks bundles given by [formula], level [formula], and weights [formula] were shown by Fakhruddin to factor through the contraction maps from [formula] to the weighted pointed moduli spaces defined by Hassett ([\cite=Fakh]*Prop. 4.7). We prove an analogous statement for conformal blocks bundles given by [formula], level 1, and weights [formula]. Namely, in Lemma [\ref=slnHassettSpace] we identify what we call the minimal Hassett space [formula] determined by [formula], and we prove the following result about the associated contractions (see Section [\ref=slnmorphisms]).

In Proposition [\ref=nclass] we give the classes of the divisors Dn1,j, and we learn more about their associated morphisms by finding their position in the cone of nef divisors on [formula]. Recall that a divisor D on a proper variety X is nef if D nonnegatively intersects every curve on X. The set of classes of nef divisors on X generates a closed cone [formula] in the Néron-Severi space [formula]. (Note that on [formula], algebraic and rational equivalence are the same, so [formula], [\cite=KeelIntersection].) The divisors Dn1,j are Sn-invariant, and are elements of the cone of symmetric nef divisors, [formula]. It is known that Sn-invariant nef divisors on [formula] are big (cf. [\cite=KeelMcKernanContractible]*Thm. 1.3(2), [\cite=GibneyNumerical]*Prop. 4.5), and so the associated morphisms are birational.

To prove Theorem [\ref=extremal], for each divisor Dn1,j we define a family of rational curves G  =  Gn1,j (cf. Definitions [\ref=k_geq_3_family] and [\ref=k=2_family]). Given [formula], the family Gn1,j consists of [formula] independent effective curves (thought of as classes in [formula]) each of which intersects the divisor Dn1,j in degree zero. In fact, the curves in Gn1,j are F-curves (cf. [\ref=curvessection]), which are special, combinatorially defined rational curves in the moduli space [formula]. In order to show that the curves in G  =  Gn1,j are independent, which is the hardest part of this paper, we use a convenient basis of F-curves (cf. Proposition [\ref=C1]). In Proposition [\ref=gamma_j], we give a formula for expressing any F-curve in that basis. This formula may be a useful tool for other purposes.

We now say a few words about how we came to study the family of divisors {Dn1,j}.

Fakhruddin has recently found recursive formulas for the classes of general conformal blocks divisors on [formula] [\cite=Fakh]. Swinarski implemented these formulas in a free and open source Macaulay 2 [\cite=Macaulay] package called ConfBlocks [\cite=ConfBlocks], which can compute classes of conformal blocks divisors for many different Lie algebras and levels. After some experimentation using the programs ConfBlocks, NefWiz [\cite=NefWiz], and polymake [\cite=Polymake], our group noticed that the divisors Dn1,j often spanned extremal rays of the nef cone.

We also observed that many of the divisors Dn1,j lie in a part of the nef cone that was not previously well understood. More precisely: the Ray Theorem of Keel and McKernan [\cite=KeelMcKernanContractible] and its extension by Farkas and Gibney [\cite=FarkasGibney] gives good understanding of the cone in [formula] generated by log canonical divisors. If a divisor D is log canonical and intersects every F-curve nonnegatively, then D is nef, and by [\cite=BCHM], semiample. However, many of the divisors Dn1,j are not log canonical, and hence proving that they are nef and semiample requires different methods.

We were also able to identify the images of the morphisms associated to some of the divisors Dn1,j. For instance, if n is even, Dn1,2 is the pullback of λ along a map [formula], and hence this linear series maps [formula] to the Satake compactification A*g [\cite=AGS]. The image of the morphism associated to the divisor Dn1,n / 2 is the GIT quotient [formula] with the symmetric linearization [\cite=AGS]. These examples piqued our interest in understanding the geometry of the morphisms associated to the divisors Dn1,j; these morphisms have been studied further by Giansiracusa (cf. Remark [\ref=Giansiracusa] and [\cite=Giansiracusa]).

In a related paper, Alexeev, Gibney, and Swinarski study conformal blocks divisors [formula] for [formula], level [formula], and weights [formula] when n is even [\cite=AGS]. We compare and contrast that paper and this one.

One aspect of the divisors in the families {Dn1,j} and [formula] that makes them amenable to study is that we have good understanding of the ingredients which are needed to use Fakhruddin's formulas for Chern classes. Specifically, the fusion rules, which give the ranks of the conformal blocks for n = 3 marked points, are combinatorial and relatively easy if [formula] or if [formula] and [formula]. For general simple Lie algebras and levels, the fusion rules can be much more complicated, making it correspondingly more difficult to obtain general formulas.

In order to study the [formula] divisors in [\cite=AGS], we needed to find a useful formula for the intersection of the divisors with F-curves. This required application of conformal blocks tools such as factorization. On the other hand, for the [formula] level 1 divisors, Fakhruddin gives a combinatorial formula for the intersection of the divisors with F-curves [\cite=Fakh]*5.2.

In [\cite=AGS] it is shown that the [formula] divisors [formula] lie on the boundary of the symmetric nef cone, and that for all n  ≥  10, four of these divisors span extremal rays of the symmetric nef cone. It was relatively easy to find sets of curves which intersect these divisors in degree zero and to prove independence of these families. In contrast, all of the [formula] divisors Dn1,j, [formula] span extremal rays of the symmetric nef cone. Finding families of curves which these divisors intersect in degree zero and proving the independence of these families of curves was considerably more difficult in the [formula] case. So, although the divisors considered in the present paper and in [\cite=AGS] are closely related, the types of results we needed to prove were different for the two families.

Outline of the paper: In Section [\ref=background] we establish the notation and conventions we will follow, giving basic definitions and references about conformal blocks bundles and [formula]. In Section [\ref=slnmorphisms] we prove Theorem [\ref=thmA] on factoring morphisms through Hassett spaces; this section may be may be read independently of the rest of the paper. In Section [\ref=newtools] we introduce some new tools for working with curves and divisors on [formula]; the main result here is that we invert the matrix of intersection numbers between natural bases of symmetric divisors and symmetric curves on [formula]. This allows us to write divisors in the natural basis given their intersection numbers with F-curves. Likewise, we may write an arbitrary symmetric F-curve class in the natural basis of symmetric curve classes. In Section [\ref=divisor_classes] we give explicit formulas for the intersection numbers and divisor classes of Dn1,j. In Section [\ref=special_cases_section] we show that Dn1,j is extremal in the symmetric nef cone if j = 1,2,3,4 or if j|n. In Section [\ref=k_geq_3_structure] we define and study the family G which is used to show the extremality of Dn1,j when ⌊n / j⌋  ≥  3, and in Section [\ref=k_geq_3_independence] we prove the extremality of Dn1,j in this case. We outline a parallel analysis for the case ⌊n / j⌋ = 2 in Sections [\ref=k=2_structure] and [\ref=k=2_independence]. Examples and the Macaulay 2 code used to compute them are provided in each case; see or follow the hyperlinks in this .pdf file.

Acknowledgements

This project was initiated during Spring Semester 2009 under the Vertical Integration of Research and Education (VIGRE) Program sponsored by the National Science Foundation (NSF) at the Department of Mathematics at the University of Georgia (UGA). We would like to acknowledge the NSF VIGRE grant DMS-03040000 for partial financial support of this project. In addition to the authors, the Spring 2009 UGA VIGRE Algebraic Geometry group included Tyler Kelly, David Krumm, Lev Konstantinovsky and Brandon Samples. We would also like to acknowledge the participants of the UGA Conformal Blocks Seminar, which in addition to the authors included Valery Alexeev, Brian Boe, Bill Graham, Elham Izadi, and Robert Varley. Finally we would like to thank Noah Giansiracusa, Daniel Krashen, Chris Manon, and Michael Thaddeus for helpful conversations.

Background: Conformal blocks, , cones of divisors and curves

In this section we give the basic notation and definitions we use and give references on conformal blocks, the moduli space of curves and basic notions in birational geometry. We claim no originality for any of the results discussed below; we hope that this information will be useful to algebraic geometers and conformal blocks readers.

Conformal blocks bundles

We refer the reader to the papers [\cite=Beauville], [\cite=Faltings], [\cite=Fakh], [\cite=Looijenga], [\cite=Ueno], for details and proofs of the statements and facts about conformal blocks which we use in the sequel.

We begin with an informal description of the conformal blocks vector bundles. Let [formula] be a Lie algebra. Let [formula] be a positive integer, called the level. Let [formula] be an n-tuple of dominant integral weights in the Weyl alcove of level [formula] in the root system for [formula].

Let [formula] be the affine Lie algebra associated to [formula]:

[formula]

Just as in the case of finite-dimensional Lie algebras, to each weight λi we may associate an irreducible [formula]-module Hλi. Let [formula] be the tensor product of these modules for the weights in [formula].

We can describe the fiber of the conformal blocks bundle [formula] over a point [formula] as follows: Let [formula]. Choose a local coordinate zi near each pi; this gives ring homomorphisms [formula]. Define a [formula] action on [formula] as follows:

[formula]

Then the fiber of [formula] over the point [formula] is the vector space of coinvariants of this [formula] action on [formula].

While [formula] and [formula] are infinite-dimensional, the vector space of coinvariants is finite-dimensional. These fibers form an algebraic vector bundle on Mg,n. (In particular, the dimension of the vector space of coinvariants does not depend on the curve C or the points {pi}, but only on the genus g and the number of marked points n.)

The construction can be extended to nodal curves, yielding an algebraic vector bundle [formula] on [formula]. Here we record a few additional facts about these bundles which are most relevant to our paper.

The fibers over nodal curves admit very specific direct sum decompositions known as the factorization rules.

The vector bundle [formula] on [formula] admits a projectively flat connection.

When g = 0, the connection satisfies the KZ equations.

When g = 0, the vector bundle [formula] is globally generated, and hence its determinant line bundle is nef.

Symmetric divisors and curves on

Divisors on

The symmetric group Sn acts on [formula] by permuting the order of the marked points. In this paper we shall almost exclusively work with Sn-symmetric divisors, and so we take a moment to recall the basic tools for these. A standard reference is [\cite=KeelMcKernanContractible].

The boundary of [formula] is the locus parametrizing nodal curves. The irreducible components of the boundary are denoted ΔI,Ic and are indexed by partitions of the set [formula] into two subsets I,Ic each of size at least two. Then ΔI,Ic is the closure of the locus in the moduli space parametrizing curves with two irreducible components meeting at a single node, having points with labels in I on one component, and points with labels in Ic on the other component. We write δI for the class of the divisor ΔI,Ic. The boundary classes {δI} span [formula]; the relations between them can be found in [\cite=KeelIntersection].

Let [formula], and let [formula] denote the vector subspace of Sn-symmetric divisor classes on [formula]. Let [formula]. The divisors [formula] are Sn-symmetric and form a basis of [formula]. They span [formula] because they are the images of the ΔI under symmetrization. One easy way to see that they are independent is to compute their intersection numbers with curves in the moduli space; see for instance [\ref=inverseintersectionmatrixlemma].

We define g in the following way: If n is even, then g  =  n / 2 - 1, so that n = 2g + 2. If n is odd, then g = ⌊n / 2⌋ - 1, so that n = 2g + 3. These choices for g are convenient because we have [formula] in both cases.

Curves on [formula]

There is a set of rational curves on [formula] called F-curves which are especially useful and important. Collectively, F-curves sweep out the locus in [formula] corresponding to curves having at least n - 4 nodes. They can be defined combinatorially in terms of their dual graphs. Let G be a tree with n labelled leaves that is trivalent at every vertex except one, where it is 4-valent. Then the locus in [formula] parametrizing curves with dual graph G is an open rational curve, given by the cross ratio of the four special points on the 4-valent vertex. The closure of this locus is called an F-curve, in honor of both Faber and Fulton. Deleting the 4-valent vertex of the graph G partitions the leaves [formula] into four nonempty subsets I1, I2, I3, I4, and the homology class of the F-curve depends only on this partition. We denote this FI1,I2,I3,I4. The classes of F-curves span [formula].

Our primary use of F-curves will be in intersecting them with symmetric divisor classes on [formula]. In particular, we do not need to know the partition [formula]; we only need to know the cardinalities #  I1, #  I2, #  I3, #  I4. We call these four numbers the shape of the partition. (Given two F-curve classes whose partitions have the same shape, the intersection with the class of D will be the same, since D is symmetric.) Thus, a partition a + b + c + d = n of the integer n into four positive integers determines an F-curve class, up to Sn symmetry. We interpret the symbol Fa,b,c,d as a weighted average of F-curve classes over all partitions of shape a,b,c,d. In the sequel we often omit the fourth index d = n - a - b - c and write Fa,b,c  =  Fa,b,c,d. A key intersection formula we need is due to Keel and McKernan:

Let [formula] be a symmetric divisor class on [formula]. Let a + b + c + d = n be a partition of n into 4 positive parts. Then

[formula]

where if [formula], we define αt  =  αn - t.

Cones of curves and divisors

The cohomology ring of [formula] is well-understood; it was first described by Keel [\cite=KeelIntersection]. However the birational geometry of [formula] is not completely understood and is known to be quite complicated. An important open question in algebraic geometry is to determine the nef cone of [formula].

Recall that a divisor D on a space X is nef if D  ·  C  ≥  0 for every effective curve C  ⊂  X. The nef cone is the closure of the ample cone -- those divisors that (after taking suitably large multiples) yield embeddings of X in projective space.

We define a cone [formula] called the F-cone as the cone of divisors which nonnegatively intersect the F-curves:

[formula]

In particular, every nef divisor must intersect the F-curves nonnegatively, so we have an inclusion [formula]. For n  ≤  7, this inclusion is an equality, but at the time of this writing, it is not known whether this inclusion is an equality for n > 7 [\cite=Larsen].

The cone F0,n is combinatorially defined but intractable for large values of n; the Picard number of [formula] is [formula] [\cite=KeelIntersection]*p. 550. Thus for n  ≥  7 it is not practical to experiment with the full cone F0,n. This is one reason we are led to consider a smaller cone: Let

[formula]

Then [formula] contains the cone [formula] of Sn-symmetric nef divisors, and is much simpler since its ambient space is only g-dimensional, and there are fewer partitions of integers a + b + c + d = n than partitions of the set [formula].

Studying [formula] sheds light not only on [formula], but also on [formula]: Gibney, Keel, and Morrison showed that the birational geometry of [formula] is determined by the cone [formula] associated to [formula] [\cite=GibneyKeelMorrison].

In this paper we will study nef divisors that span extremal rays of the cone [formula]. Recall that the ambient vector space [formula] of Sn-symmetric divisors is g-dimensional. Let F be a family of g - 1 independent F-curves F(i). Then F determines a ray in [formula] given by the intersection of the hyperplanes F(i)  ·  D  =  0. If this ray is spanned by a divisor which intersects all the F-curves nonnegatively, then this ray must be extremal in the F-cone [formula]. We also know that the divisors Dn1,j, being conformal blocks divisors, are nef. Thus, since they are nef and span extremal extremal rays of [formula], they span extremal rays of [formula].

Here is an example:

Let F  =  {F1,1,j|1  ≤  j  ≤  g - 1}. The independence of all the curves in the family F will be shown in Section [\ref=newtools].

We will see in Section [\ref=special_cases_section] that the divisor Dn1,2 intersects every curve in F in degree zero. Therefore, this divisor spans an extremal ray in the symmetric nef cone.

conformal blocks and Hassett's spaces

In this section we show that to any conformal blocks divisor [formula], one may associate a minimal Hassett space [formula] such that the morphism defined by the linear series given by [formula] factors through the birational contraction [formula]. When the weights are symmetric, we also show that the associated morphism factors through a particular log canonical model of [formula]. Fakhruddin has proved an analogous statement for the conformal blocks divisors given by [formula] [\cite=Fakh]*Prop. 4.7.

Notation. We refer to Hassett's paper [\cite=HassettWeighted] for the definition of the moduli spaces of weighted pointed stable curves [formula] with weights A. We write [formula]. In [\cite=HassettWeighted]*Theorem 4.1, Hassett defines natural birational morphisms [formula] which may be described as follows: given a point [formula], its image under ρA,N is obtained by successively collapsing components of C along which [formula] fails to be ample.

Let [formula] be an n-tuple of fundamental dominant weights of [formula] satisfying [formula] for each [formula], and [formula]. Let [formula] be the conformal blocks divisor for [formula], level 1, and weights [formula]. Let A be the set of weights [formula]. We say that [formula] is the minimal Hassett space determined by [formula] and call [formula] the associated maximal contraction.

To check that A determines a Hassett weighted moduli space, one needs to know that [formula] for each [formula], and that [formula]. The hypotheses on [formula] ensure that these conditions on A are satisfied.

Let [formula] be an n-tuple of fundamental dominant weights of [formula] satisfying [formula] for each [formula], and [formula]. Let [formula] be the minimal Hassett space determined by [formula]. Then the morphism [formula] associated to the divisor [formula] factors through the natural birational contraction [formula] defined by Hassett.

In the proof of Theorem [\ref=factor], we shall see that if F = FN1,N2,N3,N4 is any F-curve that is contracted by ρA,N, then Dn1,ω  ·  F = 0. For the reader's convenience, we state just what we need of Fakhruddin's Proposition 5.2 in order to show that the divisors [formula] contract the same F-curves as the Hassett contractions ρA,N.

[\cite=Fakh]*Prop. 5.2 Let [formula] with 0  ≤  ij  <  n for [formula], where ω0 = 0. Let F be an F-curve on [formula] corresponding to a partition [formula]. Let νk be the representative in [formula] of [formula] modulo n. If [formula], then [formula].

Let [formula] be the morphism given by [formula] and ρA,N be the contraction of [formula] onto the minimal Hassett moduli space [formula]. To show that [formula] factors through ρA,N we would like to define a morphism [formula], such that [formula]. Set theoretically, this will be the map [formula]. This is well defined as long as whenever X is a curve on [formula] that is contracted by ρA,N, then X is also contracted by [formula]. We show that this is true for F-curves. Since every effective curve that is contracted by ρA,N is a linear combination of the F-curves that get contracted ([\cite=Fakh], Lemma 4.6), the map is well defined. It remains to check that the intersection [formula] for all F-curves FN1,N2,N3,N4 that are contracted by ρA,N.

An F-curve F = FN1,N2,N3,N4 is contracted by ρA,N precisely when [formula]. (Here we order the indices so that |N1|  ≤  |N2|  ≤  |N3|  ≤  |N4|.) Using Fakhruddin's notation from Proposition [\ref=Fakh5.2], this gives [formula] and by definition, ν4 < n. In order for the intersection [formula] to be nonzero, the sum [formula] must be 2n, which is impossible.

Typically, the divisors Dn1,j contract more curves than the contraction maps ρA,N from [formula] to the minimal Hassett space [formula] determined by Dn1,j. For instance, the morphism of the divisor Dn1,2 has image equal to [formula] (cf. [\cite=AGS]). In [\cite=GiansiracusaSimpson], Giansiracusa and Simpson study moduli spaces of pointed conics [formula] and describe birational morphisms [formula]. While talking with Giansiracusa, we noticed that for certain linearizations, the curves that get contracted under the morphisms that he and Simpson study are the same curves that get contracted by Dn1,3. Giansiracusa has generalized this observation further, identifying the images of the morphisms given by the Dn1,j with GIT quotients ([\cite=Giansiracusa]).

New tools for working with curves and divisors on

The main objects of study in this work are certain semiample divisors that come from conformal blocks. One of the ways we can study these divisors is by understanding their intersections with families of independent F-curves in [formula]. We give an example below.

Let n = 2g + 2, or n = 2g + 3. The set of curves F  =  {F1,1,i:1  ≤  i  ≤  g} is independent.

(We claim no originality for this result. It appears, for instance, in [\cite=GibneyNumerical] and [\cite=AlexeevSwinarski]. We include a proof because it illustrates our techniques well. See the related paper [\cite=AGS] for a proof by a different method.)

We prove Proposition [\ref=C1] by studying matrices of intersection numbers, and answer the following question about divisors at the same time: Suppose we have a symmetric divisor D on [formula]. Given the intersection numbers of D with the F-curves {Fi,1,1,n - i - 2}, how can we write D in the basis of [formula] consisting of the divisors [formula]?

Our goal is to find coefficients bj such that [formula]. (Note the indexing on the right: there are g divisors, starting with B2 and ending with Bg + 1.)

Each curve Fi,1,1 yields an equation:

[formula]

We can write this as a matrix equation:

Let M be the matrix of intersection numbers (Fi,1,1  ·  Bj), and let N: = M- 1. Then we have

The following lemma, whose proof is an easy exercise, gives a formula for N.

If n is odd, then If n is even, then:

Let n = 13. Then

Let n = 12. Then

In particular, since M is invertible, it has full rank, and this proves Proposition [\ref=C1].

Writing F-curves in the basis

Since the F-curves {Fj,1,1}gj = 1 form a basis for [formula], we may write [formula]. In this subsection, we obtain a general formula for the coefficients γj. Let P: = Nt be the transpose of the matrix N of Lemma [\ref=inverseintersectionmatrixlemma]:

[formula]

Suppose [formula]. We can intersect both sides of this equation with the divisors [formula] and solve for the vector [formula] of numbers γj:

By combining this formula for P with Keel and McKernan's formula for intersection numbers (see [\ref=Keel_McKernan_formula]) above, we obtain the following formula for γj. Note that the function A below arises from combining all the fractional parts of [\ref=matrix_P]; the function B arises from the remaining terms in line 1 of [\ref=matrix_P].

Suppose that a  ≤  b  ≤  c  ≤  d. Define three piecewise linear functions A, B, f as follows:

[formula]

Then γj, the coefficient on Fj,1,1 when Fa,b,c,d is written in the {Fj,1,1} basis, is

[formula]

Let n = 12. Suppose we want to compute F1,2,2 in the basis {Fj,1,1}. The matrix N is given in Example [\ref=n=12_example]. We compute Thus,

[formula]

Alternatively, using Proposition [\ref=gamma_j] above, we find: A(1,2,2,7) = 0, B(1,1,2,2,7) =  - 1, B(2,1,2,2,7)  =  B(3,1,2,2,7) = 1, and B(4,1,2,2,7) = B(5,1,2,2,7) = 0.

When n is even, we can show A(a,b,c,d) is even, and it follows that the numbers γj are integers.

Some useful formulas

In this subsection we give more explicit formulas for some curves which appear often in the sequel. These cover many, but not all, of the curves we work with; any example not covered by the propositions below can be calculated from Proposition [\ref=gamma_j] instead. The formulas below are easily obtained from Proposition [\ref=gamma_j].

Suppose 2k  <  g + 1 - 2k. Suppose that i + 2k  ≤  g + 1 and i  ≠  g + 1 - 2k if n is even. Then [formula], where the coefficients γj are given below.

If i < k:

[formula]

If k  ≤  i < 2k:

[formula]

If 2k  ≤  i  ≤  g + 1 - 2k:

[formula]

Let n = 62, k = 7, i = 16. Then the vector [formula] of coefficients γj is ( - 2, - 3, - 4, - 5, - 6, - 7, - 6, - 5, - 4, - 3, - 2, - 1,0,0,0,1,2,3,4,5,6,7,6,5,4,3,2,1,0,0).

Suppose that i + k  ≤  g + 1  <  i + 2k, and that k  ≤  2k  ≤  i  ≤  n - i - 2k  ≤  i + k, and i  ≠  g + 1 - k if n is even.

Then [formula], where the coefficients are given as follows.

[formula]

Let n = 62, k = 9, i = 19. Then the vector [formula] of coefficients γj is ( - 2, - 3, - 4, - 5, - 6, - 7, - 8, - 9, - 8, - 7, - 6, - 5, - 4, - 3, - 2, - 1,0,0,1,2,3,4,5,6,8,10,12,12,12,6).

We summarize some of the properties of the numbers γj which are used in the sequel.

Suppose j  ≥  6. Given i,k, let γj be defined by [formula].

For 2k - 1  ≤  i  ≤  g - k + 1, and for 1  ≤  j  ≤  2k - 2, the coefficients γj are independent of i, and are given by the formulas γj  =   - j - 1 if j < k, and j + 1 - 2k if k  ≤  j  ≤  2k - 2.

For 2k  ≤  i  ≤  g - k + 1, and for 2k - 1  ≤  j  ≤  i - 1, the coefficients γj = 0.

For 2k  ≤  i  ≤  g - k + 1, the coefficient γi = 1.

The formulas from Proposition [\ref=case_1] establish these claims when i  ≤  g - 2k. However, Proposition [\ref=case_2] does not establish these claims in all cases when g - 2k + 1  ≤  i  ≤  g - k + 1, so we sketch a proof.

We use Proposition [\ref=gamma_j] to compute γj in these cases. When g - 2k + 1  ≤  i  ≤  g - k + 1, we have a = b = k,c = i,d = n - i - 2k, and a + d  ≤  g + 1. Thus A(k,k,i,n - i - 2k)  =  2k. If 1  ≤  j  ≤  2k - 2, we have B(j,k,k,i,n - i - 2k)  =   - j - 1 - 2k. If k - 1  ≤  j  ≤  2k - 2 we have B(j,k,k,i,n - i - 2k) = j + 1 - 4k. If 2k - 1  ≤  j  ≤  i - 2, we have B(j,k,k,i,n - i - 2k)  =  2k. If i - 1  ≤  j  ≤  i, we have B(j,k,k,i,n - i - 2k)  =  j + 1 - i. The result follows.

Fakhruddin has given convenient formulas for computing the intersection of the Dn1,j with an arbitrary F-curve. In Proposition [\ref=symm] we recall his formula for intersecting with symmetric F-curves, and in Proposition [\ref=intersectionform] we give an explicit expression for the intersection numbers [formula]. The main result that we prove in this section is the following theorem, which gives the classes of the divisors Dn1,j.

Fix n = 2g + 2 or n = 2g + 3 and [formula]. Write [formula]. Then [formula], where when n is odd,

[formula]

and when n is even,

[formula]

The formulas for the numbers brj follow from Lemma [\ref=inverseintersectionmatrixlemma]. The numbers aij are given by Proposition [\ref=slk_l1_numbers] below.

Fakhruddin's intersection formulas

In this subsection we give explicit formulas for the intersection of the Dn1,j with the symmetric F-curves that arise in the expression of the class of Dn1,j.

Fakhruddin gives explicit formulas for intersecting Dn1,j with any F-curve on [formula]. For convenience, we present his intersection formulas for the intersection of Dn1,j with the symmetric F-curves.

(Fakhruddin 5.2) Let Fn1,n2,n3,n4 be the symmetric F-curve defined by the partition [formula] of n into four positive integers. Let νi be the representative in [formula] of jni modulo n. Put [formula] and [formula]. Then

[formula]

Notation. We write x  %  y for the remainder when x is divided by y. Note that this is the unique integer between 0 and y - 1 representing the congruence class of x mod y.

Write n = 2g + 2 or n = 2g + 3. Let 2  ≤  j  ≤  g + 1.

If [formula], then Dn1,j  ·  Fn1,n2,n3,n4 = 0.

If νi = 0 for any i, then Dn1,j  ·  Fn1,n2,n3,n4 = 0.

if Dn1,j  ·  Fn1,n2,n3,n4 = 0, then either [formula], or νi = 0, or both.

[formula] such that [formula].

The first statement is part of Proposition [\ref=fakh_5.2]. For the second, note that if [formula], then by the first statement we have Dn1,j  ·  Fn1,n2,n3,n4 = 0, and if [formula], we have νmin  =  0 and νmax < n, so we are in the first case of the formula, and Dn1,j  ·  Fn1,n2,n3,n4  =  νmin  =  0.

For the third statement, note that since νmax  <  n, there is no way to get Dn1,j  ·  Fn1,n2,n3,n4 = 0 out of the second case of the formula. Hence, if Dn1,j  ·  Fn1,n2,n3,n4  =  νmin  =  0, we must be in the first case or the third case.

The fourth statement requires a little more work. To compute ν1  =  (n - i - 2)j%n, we seek α such that 0  ≤  αn - ij - 2j  <  n. Then [formula], so [formula]. Observe that [formula].

To compute ν2, we seek β such that 0  ≤  ij - βn < n. Then [formula], so [formula]. Observe that [formula].

We have ν3  =  ν4  =  j  ≠  0 and

Note that [formula].

By the third statement of the proposition, to have Dn1,j  ·  Fn1,n2,n3,n4 = 0, we must have either ν1 = 0 or ν2 = 0 or [formula]. To have [formula], there must exist an integer p such that [formula]. Under these circumstances we have ν1  ≠  0 and ν2  ≠  0, and the fourth statement follows.

The particular intersection numbers Dn1,j  ·  F1,1,i arise in the class of Dn1,j. To make them even more explicit, we define

For [formula],

Given [formula], we use Proposition [\ref=fakh_5.2] to solve for possible indices [formula] such that F1,1,i,n - 2 - i  ·  Dn1,j  ≠  0. As a first step, we explicitly determine ij%n  =  ij  -  αn and (n - 2 - i)j%n  =  (n - 2 - i)j  -  βn. Thus (α + 1)n  >  ij  ≥  αn and (β + 1)n  >  (n - 2 - i)j  ≥  βn. Since i  ≤  n - 2 - i, one has that (β  +  1)n > (n - 2 - i)j  ≥  ij  ≥  αn and in particular α  ≤  β. We get a nonzero intersection if and only if (n - 2 - i)j%n  +  ij%n  +  2j  =  2n, that is, α  +  β = j - 2. In particular we have the bound [formula].

Now substitute j - 2 - α for β, giving (α  +  1)n  +  (n - 2j)  >  ij  ≥  αn  +  (n - 2j). Since n - 2j  ≥  0, we get the tighter bound (α + 1)n  >  ij  ≥  αn  +  (n - 2j). Now taking κ  =  κ(n,j,i) as above, ij  =  αn  +  n - κ and substituting this into our tighter inequality gives κ  ≤  2j. We can now compute the intersection numbers. Using Fakhruddin's notation we let νm for 1  ≤  m  ≤  4 denote the integers representing the mod n congruence classes of j,j,ij and (n - 2 - i)j respectively. Since 0 < 2j  ≤  n we can take ν1  =  ν2  =  j and by definition ν3  =  ij%n  =  n - κ. When the intersection number is nonzero, this forces ν4  =  (n - 2 - i)j%n to be n + κ - 2j.

In the case κ  ≤  j, one has that n - κ - j  ≥  n - 2j  ≥  0 and so ν3  ≥  ν1  =  ν2. Also n - κ - (n + κ - 2j) = 2(j - κ)  ≥  0, so ν3  ≥  ν4. This gives that ν3 is the maximum of the νi. If ν4 is the minimum, then min   +   max   =  n + (n - 2j)  ≥  n. If ν1  =  ν2 = j is the minimum, then min   +   max  = j + n - κ = n + (j - κ)  ≥  n. In either case, the intersection number is n - ν3  =  κ, as asserted. In case κ  ≥  j, one has that ν4 is maximum of the νi. Indeed, ν4  ≥  ν3 since (n + κ - 2j) - (n - κ) = 2(κ - j)  ≥  0, and ν4  ≥  ν2  =  ν1, since n + κ - 2j - j  ≥  n - 2j  ≥  0. If ν3 is the minimum of the νi, then max   +   min  = n + κ - 2j + n - κ = n + (n - 2j)  ≥  n. If ν1  =  ν2 = j is the minimum of the νi, then max   +   min  = n + κ - 2j + j  ≥  n. In either case the intersection number is n - ν4 = n - (n + κ - 2j) = 2j - κ, as asserted.

We split the proof of the Extremality Theorem into four cases. Throughout the sequel we write n = jk + r where 0  ≤  r < j. First, we consider the special cases j = 1,2,3,4. Second, we consider the case r = 0. Third, we will consider the case k  ≥  3 and r > 0. Fourth, we will consider the case k = 2 and r > 0. In each case, we will define a family [formula] consisting of g - 1 curves.

In this section we will define a family of curves [formula] in the special cases 1  ≤  j  ≤  4 or r = 0. We consider the matrix C given by the coefficients when the curves in [formula] are written in the basis {Fq,1,1}. (We will use the letters p,q to index rows and columns of matrices.) The matrix C has g - 1 rows and g columns. We will argue that C has full rank by exhibiting a (g - 1)  ×  (g - 1) minor Ĉ with nonzero determinant. Our choice of the minor corresponds to the curve that is dropped in the construction of the family [formula].

If

We consider the cases j = 1,2,3,4. Note that if k = 2 and j  ≤  4, then n  ≤  11, and one can check the extremality of Dn1,j in these cases by direct calculations. So in the arguments below, we may assume that k  ≥  3.

Suppose j = 1. Then we can show that Dn1,1 is trivial. Indeed, we may use Propositions [\ref=fakh_5.2] and [\ref=when_int_numbers_are_zero] to show that Dn1,1  ·  Fi,1,1 = 0 for all F-curves of the form Fi,1,1 for i  ≤  g. These curves form a basis for the vector space of 1-cycles modulo numerical equivalence, by Proposition [\ref=C1].

Suppose that j = 2. We may also assume k  ≥  3 by the note above. We use Propositions [\ref=fakh_5.2] and [\ref=when_int_numbers_are_zero] d) to show that Dn1,2  ·  Fi,1,1  =  0 if 1  ≤  i  ≤  g - 1. Thus we take   =  {Fi,1,1:1  ≤  i  ≤  g - 1}. This is a set of g - 1 distinct curves; they are independent by Proposition [\ref=C1]; and hence the Dn1,2 is extremal.

Suppose j = 3. We may also assume k  ≥  3 by the note above. If r = 0 then we may use Propositions [\ref=fakh_5.2] and [\ref=when_int_numbers_are_zero] d) to show that Dn1,3  ·  Fi,1,1  =  0 if [formula]. We take [formula] to be this family. This is a set of g - 1 distinct curves; they are independent by Proposition [\ref=C1]; and hence the Dn1,3 is extremal in this case.

If r = 1,2 then we may use Propositions [\ref=fakh_5.2] and [\ref=when_int_numbers_are_zero] d) to show that Dn1,3  ·  Fi,1,1  =  0 if [formula], and also that Dn1,3  ·  Fk - 1,k,k  =  0. We take [formula].

Next, we consider the matrix C described above. We compute ck - 1,k - 1 using Proposition [\ref=gamma_j] and find that this is - r  ≠  0. Hence C has full rank, the family [formula] is independent, and Dn1,3 is extremal.

Suppose j = 4. We may also assume k  ≥  3 by the note above. We use Propositions [\ref=fakh_5.2] and [\ref=when_int_numbers_are_zero] d) to show that Dn1,j  ·  Fi,1,1  =  0 unless i is in the set I below. We form a family [formula] in each case as follows:

If r = 0 the only k,k-curve in [formula] is Fk - 1,k,k. Thus most rows of the matrix C look like rows of the identity matrix. We compute ck - 1,k - 1  =   - k + 1  ≠  0. Thus C has full rank, and hence [formula] is independent and Dn1,4 is extremal.

If r > 0 then we only need to check the following 2  ×  2 minor of C: This has determinant 2. Thus C has full rank, [formula] is independent, and Dn1,4 is extremal.

If

When r = 0 we may use Proposition [\ref=fakh_5.2] to show that Dn1,j  ·  Fi,1,1  =  0 if [formula], and that Dn1,j  ·  Fi,k,k  =  0 if [formula]. This motivates us to define [formula]. We then throw out the last k,k-curve to get a family [formula].

Suppose j  ≥  5 (the cases j = 2,3,4 were covered in the previous subsection). We form a matrix N as follows: As above, start with the matrix C given by the coefficients when the curves in G are written in the basis {Fq,1,1}. We delete the row and column corresponding to the curve that was dropped in the construction of the family [formula] to obtain a (g - 1)  ×  (g - 1) minor Ĉ.

To show that Ĉ is full rank, it is enough to show that the minor consisting of rows which come from k,k-curves, and the corresponding columns, has nonzero determinant. Write [formula]. Then we extract this m  ×  m minor and call it M. (See Example [\ref=25-7] below.) Let N be the matrix obtained from M by subtracting row m from rows 1 through m - 1.

Then N is the following m  ×  m matrix:

We may row reduce across the bottom row to compute the determinant of the matrix, and find det N  =  ( - k + 1)m. Thus, det Ĉ  ≠  0, the family [formula] is independent, and Dn1,j is extremal when r = 0.

Given n and j, as before we let k: = ⌊n / j⌋ and r: = n - jk. Thus, we have n = jk + r, where k is a positive integer, and 0  <  r  <  j. (The case r = 0 was handled in Section [\ref=r=0_section].)

In this section, for each Dn1,j with k  ≥  3, we will describe a family of curves G  =  Gn1,j which will be used in the next section to prove the extremality of the divisor Dn1,j. (See Sections [\ref=k=2_structure] and [\ref=k=2_independence] for the case k = 2.)

Suppose integers n and j are given. Recall that g is defined by n = 2g + 2 or n = 2g + 3, and suppose 2  ≤  j  ≤  g + 1. We define

Let n and j be as above. Suppose k  ≥  3, j  ≥  4, and r > 0. (For the cases r = 0 and j  ≤  4, see Section [\ref=special_cases_section].)

We define a set of F-curves G as follows: For each [formula], if i∈Tj,n, then put G(i)  =  Fi,k,k. If [formula] and Dn1,j  ·  Fi,1,1  =  0, then put G(i) = Fi,1,1. Otherwise, if [formula] and Dn1,j  ·  Fi,1,1  ≠  0, then put G(i) = Fi,k,k. Define G  =  {G(i):1  ≤  i  ≤  g}. Let p be the largest index i such that G(i)  =  Fi,k,k. Then we also define a family [formula] of g - 1 curves as [formula].

Let n = 20 and j = 6. We abbreviate and write D6 for D201,6. Then g = 9, so to prove that D6 is extremal, we need 9 independent F-curves which intersect D6 in degree zero. Also k  =  ⌊20 / 6⌋  =  3, so if necessary we will replace curves of the form F1,1,m with curves of the form F3,3,m.

We compute intersection numbers and choose curves below:

Thus the family G  =  {F1,1,1,F2,3,3,F3,3,3,F4,1,1,F5,3,3,F6,3,3,F7,1,1,F8,1,1,F9,3,3}. Then we drop F9,3,3 to get   =  {F1,1,1,F2,3,3,F3,3,3,F4,1,1,F5,3,3,F6,3,3,F7,1,1,F8,1,1}.

In a series of propositions below, we will elucidate the structure and properties of the family G in more detail.

Suppose that n  =  jk + r with k  ≥  3. Then every member of G intersects Dn1,j in degree zero.

We need to show two things:

If i∈Tj,n, then Dn1,j  ·  Fi,k,k  =  0.

If [formula] and Dn1,j  ·  Fi,1,1  ≠  0, then Dn1,j  ·  Fi,k,k  =  0.

For the first statement: Notice that if i∈Tj,n, then ij is an integer multiple of n. Thus ν1 = 0, and by Proposition [\ref=when_int_numbers_are_zero], this implies that Dn1,j  ·  Fi,k,k  =  0.

For the second statement, let 1  ≤  i  ≤  g, and suppose Dn1,j  ·  Fi,1,1  ≠  0. Then we need to show that Dn1,j  ·  Fi,k,k  =  0.

As usual, we write n = jk + r, where 0  ≤  r  <  j.

By Lemma [\ref=fakh_5.2], we know

[formula]

We will show that

[formula]

which by Lemma [\ref=fakh_5.2] implies the desired result.

So suppose for purposes of contradiction that

[formula]

Subtracting ([\ref=ikk_eq]) from ([\ref=i11_eq]) yields

[formula]

which simplifies to

[formula]

We now study the terms ( - (i + 2)j)%n and ( - (i + 2k)j)%n. First, consider ( - (i + 2)j)%n. Write ij  =  Qn  +  R where 0  ≤  R  <  n. Then

[formula]

Next, consider ( - (i + 2k)j)%n. Since jk = n - r this is equal to ( - ij + 2r)%n, so

[formula]

We now study each of the four cases that arise from the two formulas above.

Case 1: n  ≥  R + 2j, 2r  ≥  R. Then ([\ref=to_contradict]) reads - R - 2j + n  +  R  -  2r  =  2n - 2r - 2j, a contradiction.

Case 2: n  ≥  R + 2j, 2r  <  R. Then ([\ref=to_contradict]) reads - R - 2j + n  +  R - 2r - n  =  2n  -  2r - 2j, a contradiction.

Case 3: n  <  R + 2j, 2r  ≥  R. Since r < j, these inequalities imply n  <  2j + 2r  <  3j + r, which contradicts the hypothesis that n = jk + r with k  ≥  3.

Case 4: n  <  R + 2j, 2r  <  R. Then ([\ref=to_contradict]) reads - R - 2j + 2n  +  R - 2r - n  =  2n  -  2r - 2j, a contradiction.

Suppose k  ≥  3 and r > 0. Suppose j  ≥  5. The family G begins as follows:

G(i)  =  Fi,1,1 for [formula];

G(k - 1)  =  Fk - 1,k,k;

G(k)  =  Fk,k,k.

We use Proposition [\ref=when_int_numbers_are_zero]. Since 0  <  r  <  j, we have jk < jk + r  <  j(k + 1), and hence [formula]. Then for i  ≤  k - 2, [formula], so [formula]. There is no [formula] such that [formula], so Dn1,j  ·  Fi,1,1  =  0. Hence G(i)  =  Fi,1,1 for [formula].

If i = k - 1, then [formula], so Dn1,j  ·  Fk - 1,1,1  ≠  0 and G(k - 1)  =  Fk - 1,1,1.

Similarly, for i = k, we have [formula], so Dn1,j  ·  Fk,1,1  ≠  0 and G(k)  =  Fk,1,1.

Suppose k  ≥  3 and r > 0. Suppose j  ≥  5.

The k,k curves in the family G show up in the following patterns:

a pair of k,k-curves, followed by (k - 1) 1,1-curves, followed by a pair of k,k-curves. We call the first such pair in this sequence a (k - 1) pair.

a pair of k,k-curves, followed by (k - 2) 1,1-curves, followed by a pair of k,k-curves. We call the first such pair in this sequence a (k - 2) pair.

We proceed inductively. For the base case, by Proposition [\ref=k_geq_3_beginnings] we know the first k curves in G are

[formula]

For the induction step, we will show that if

[formula]

then Fi,k,k and Fi + 1,k,k are followed by either (k - 2) or (k - 1) 1,1-curves, followed by another pair of k,k-curves.

Note that since 0  <  r  <  j, we have [formula].

Case 1. Suppose that [formula]. Then we know Dn1,j  ·  Fi,1,1  ≠  0 and Dn1,j  ·  Fi + 1,1,1  ≠  0. By Proposition [\ref=when_int_numbers_are_zero], there exists [formula] such that [formula] and q such that [formula]. Combining these statements with our bounds on j / n and k, we conclude there exists [formula] such that [formula].

Next we argue that [formula]. Suppose not. Then [formula], a contradiction.

Next we argue that [formula]. We know [formula] and [formula], so [formula].

Then there are three possibilities. If [formula], then we have [formula]. It follows that Dn1,j  ·  Fi + z,1,1 = 0 for [formula], and moreover no such i + z∈Tj,n. We also have Dn1,j  ·  Fi + k,1,1  ≠  0 and Dn1,j  ·  Fi + k + 1,1,1  ≠  0. Thus

[formula]

Thus, the pair Fi,k,k and Fi + 1,k,k is a k - 2 pair.

If [formula], then we have [formula]. It follows that Dn1,j  ·  Fi + z,1,1 = 0 for [formula], and moreover no such i + z∈Tj,n. We have Dn1,j  ·  Fi + k + 1,1,1  ≠  0. We have i + k + 2∈Tj,n. Thus

[formula]

Thus, the pair Fi,k,k and Fi + 1,k,k is a k - 1 pair.

If [formula], then we have [formula]. It follows that Dn1,j  ·  Fi + z,1,1 = 0 for [formula], and moreover no such i + z∈Tj,n. We also have Dn1,j  ·  Fi + k + 1,1,1  ≠  0 and Dn1,j  ·  Fi + k + 2,1,1  ≠  0. Thus

[formula]

Thus, the pair Fi,k,k and Fi + 1,k,k is a k - 1 pair.

Case 2. Suppose that i∈Tj,n. We claim this cannot happen. Since i∈Tj,n, we have [formula]. But then we have [formula], and there exists p∈Z such that [formula]. Then Dn1,j  ·  Fi - 1,1,1  ≠  0, but this contradicts the induction hypothesis.

Case 3. Suppose that i + 1∈Tj,n. Then we know [formula]. We can show that [formula], and thus

[formula]

Thus, the pair Fi,k,k and Fi + 1,k,k is a k - 2 pair.

Suppose k  ≥  3 and r > 0. We define the sequence of pairs (si) associated to G as follows: Write L for the last k,k-curve in [formula]. Group the k,k-curves Fi,k,k in G with i < L according to whether they fall into (k - 1) pairs or (k - 2) pairs as defined by the Proposition above. Define si = k - 1 if the ith group is a (k - 1) pair, and si = k - 2 if the ith group is a (k - 2) pair. Note: we start indexing (si) with i = 0.

In the following proposition we study how the family G ends.

Write n = jk + r with 0  ≤  r  <  j. Suppose k  ≥  3, j  ≥  6 and r > 0.

If j is even: the curve Fg,1,1 is dropped, and it is preceded either by a k - 1 pair or a k - 2 pair, so FL,k,k is either Fg - k + 1,k,k or Fg - k - 1,k,k.

If j is odd: the curve that is dropped is always second in a pair, and is given as follows:

If n is even, j is odd, k is even: [formula] is dropped, and [formula]

If n is even, j is odd, k is odd: [formula] is dropped, and [formula].

If n is odd, j is odd, k is even: [formula] is dropped, and [formula].

If n is odd, j is odd, k is odd: [formula] is dropped, and [formula].

Case 1: j even. Suppose j is even. We show that Dn1,j  ·  Fg,1,1  ≠  0 and Dn1,j  ·  Fg - 1,1,1 = 0. Then by Proposition [\ref=k_geq_3_pairs] and checking that [formula], the result follows.

Suppose n is even. Then to compute Dn1,j  ·  Fg,1,1,g using Prop. [\ref=fakh_5.2] we have ν1  =  ν4  =  n - j  ≠  0 and ν2  =  ν3 = j  ≠  0. By Prop. [\ref=when_int_numbers_are_zero] c) we have Dn1,j  ·  Fg,1,1,g  ≠  0, and G(g) = Fg,k,k. As this is the last possible curve in G, it is the last k,k-curve in G, and hence the curve that is thrown out.

Next we compute Dn1,j  ·  Fg - 1,1,1,g + 1. We see that ν4 = 0 and hence by Prop. [\ref=when_int_numbers_are_zero] b) we have Dn1,j  ·  Fg - 1,1,1,g + 1 = 0. Since [formula] we have G(g - 1) = Fg - 1,k,k, and the result follows.

Suppose n is odd. We compute Dn1,j  ·  Fg,1,1,g + 1. Write j = 2m. We see that ν1 = n - 3m, ν2  =  ν3 = j, ν4 = n - m. We have νi  ≠  0 for all i and [formula]. Hence by Prop. [\ref=when_int_numbers_are_zero] c) we have Dn1,j  ·  Fg,1,1,g + 1  ≠  0. Since [formula] we have G(g) = Fg,k,k. As this is the last possible curve in G, it is the last k,k-curve in G, and hence the curve that is thrown out.

Next we compute Dn1,j  ·  Fg - 1,1,1,g + 2. Write j = 2m. We see that ν1 = n - 5m, ν2  =  ν3 = j, ν4 = m. We have [formula]. Hence by Prop. [\ref=when_int_numbers_are_zero] a) we have Dn1,j  ·  Fg,1,1,g + 1  =  0. Since [formula] we have G(g - 1) = Fg - 1,k,k, and the result follows.

Case 2: j odd. It is enough to show in each case that Dn1,j  ·  Fi,1,1  ≠  0 and Dn1,j  ·  Fi - 1,1,1  ≠  0 (where i is given in the statement of the theorem). Then regardless of whether i,i - 1∈Tj,n we get G(i) = Fi,k,k and G(i - 1) = Fi - 1,k,k. Then we can use Prop. [\ref=k_geq_3_endings] to see that Fi,k,k is the last k,k-curve in G and hence is the curve that is dropped.

Case 2a: n is even, j is odd, k even.

We compute [formula]. We have ν1  =  n - j + r / 2, ν2  =  ν3 = j,ν4  =  j(k - 1) + r / 2. We have νi  ≠  0 for all i and [formula]. Hence by Prop. [\ref=when_int_numbers_are_zero] c) we have [formula].

Next, we compute [formula]. We have ν1  =  n - 2j + r / 2, , ν2  =  ν3 = j, ν4  =  jk + r / 2. We have νi  ≠  0 for all i and [formula]. Hence by Prop. [\ref=when_int_numbers_are_zero] c) we have [formula].

Thus we have [formula] and [formula]. By Prop. [\ref=k_geq_3_endings], we see that [formula] is the last k,k-curve in G, and hence it is the curve that is dropped in forming [formula].

Case 2b, 2c, and 2d. The proofs for the remaining cases are similar to the proof of Case 2a above. We will simply report the νi that are needed.

Suppose k  ≥  3. The family [formula] consists of g - 1 distinct curves.

The concern is that in the definition of the family G, we might pick the same curve twice, i.e. G(i)  =  G(i') where i  ≠  i'.

This will never happen for two 1,1-curves.

If k  ≥  3, then since the non-1,1-curves are k,k-curves, duplication implies that we have Fi,k,k  =  Fi',k,k. Thus i'  =  n - i - 2k and i'  ≤  g, and this could only happen in the range i  ≥  g - 2k + 2. By Propositions [\ref=k_geq_3_pairs] and [\ref=k_geq_3_endings], we know exactly which k,k-curves appear in this range, and we can check case-by-case that, after dropping the last k,k-curve in forming [formula], there are never any duplicate curves.

Suppose k  ≥  3, r > 0, and j  ≥  6.

As before, we form a matrix C whose p,qth entry is the coefficient on Fq,1,1 when the curve G(p) is written in the basis {Fq,1,1}. We then drop the column corresponding to the curve which is dropped when creating the family [formula]. By Proposition [\ref=k_geq_3_endings] the column which is deleted is as follows:

If n is even and j is even: column g.

If n is odd, j is even: column g.

If n is even, j is odd, k is even: column [formula].

If n is even, j is odd, k is odd: column [formula].

If n is odd, j is odd, k is even: column [formula].

If n is odd, j is odd, k is odd: column [formula].

This yields a (g - 1)  ×  (g - 1) minor Ĉ. (See Example [\ref=25-7] below.)

Rows in Ĉ which correspond to 1,1-curves look like rows of the identity matrix. Hence, to show that Ĉ is full rank, it is enough to show that the minor consisting of rows which come from k,k-curves, and the corresponding columns, has nonzero determinant. We extract this minor and call it M. (See Example [\ref=25-7] below.)

Let m be the number of rows/columns in M. We see that the first two columns of M are constant starting in row 3. Moreover, the lower right (m - 2)  ×  (m - 2) block of M is upper triangular with nonzero entries on the diagonal.

Let N be the matrix obtained from M by subtracting row m from rows 1 through m - 1.

If j = 7 and n = 25 we have

The first m - 1 rows of N are upper triangular with nonzero diagonal entries, by Proposition [\ref=cij_summary].

We want to row reduce row m to make N upper triangular, and show that the resulting diagonal entry in row m is also nonzero. This will show that N (and hence Ĉ) is full rank.

Instead of considering the change in N as we row reduce through each column individually, we will only consider the change in N as we row reduce through pairs of columns corresponding to the pairs of [formula] recorded in the sequence (si). There are two main reasons for this. First, the nonzero entries in upper left block of the matrix N are fairly uniform. As a result, for the "early" row reductions, we can compute the change in the diagonal entry simply from knowing whether we are row reducing through a (k - 1) pair or a (k - 2) pair. Second, if we only peek at the row reductions in between the blocks, there are always two well-defined nonzero entries in row m, which we designate ai and bi below. If we were to consider the row reduction after an arbitrary column (say partway through a pair) there could be 1, 2, or 3 nonzero entries. Hence, using the sequence of pairs gives us a better framework for recursion.

Suppose two curves Fi,k,k and Fi + 1,k,k form a (k - 1) pair in G, and i + 2k  ≤  L. (In particular, by Proposition [\ref=case_1] we have γj  =  0 if j  ≥  L.) Consider the 3  ×  5 submatrix of N whose rows correspond to these two curves and FL,k,k and whose columns correspond to the curves Fp,1,1 for p∈{i,i + 1,i + k + 1,i + k + 2,L}. Then row reducing through this (k - 1) pair looks like the following: where

[formula]

Suppose two curves Fi,k,k and Fi + 1,k,k form a (k - 2) pair in G, and i + 2k  ≤  L. (In particular, by Proposition [\ref=case_1] we have γj  =  0 if j  ≥  L.) Consider the 3  ×  5 submatrix of N whose rows correspond to these two curves and FL,k,k and whose columns correspond to the curves Fp,1,1 for p∈{i,i + 1,i + k,i + k + 1,L}. Then row reducing through this (k - 2) pair looks like the following: where

[formula]

Using the recurrences for ai and bi above, we obtain ai + 1 - bi + 1  =  ai - bi  =   - 1 for all i.

ai, bi, (ai - bi), ai + 1, bi + 1, and (ai + 1 - bi + 1) all have the same sign.

Proposition [\ref=k_geq_3_recurrences] applies when i  ≤  L - 2k or i  ≤  L - 4k - 2. We will row reduce N using Proposition [\ref=k_geq_3_recurrences] as long as we can, and then compute the determinant of the remaining block directly.

Let FL,k,k be the last k,k-curve in the family [formula]. We need to consider four possibilities for how FL,k,k may fit into the family. It could be the first curve in a pair (in which case FL + 1,k,k is the curve that was dropped in the formation of [formula]) or it could be the second curve in a pair. This pair could be preceded by a (k - 1) pair or a (k - 2) pair.

Suppose that j is odd. Then by Proposition [\ref=k_geq_3_endings], we see that FL,k,k is always the first member of a pair. Then there are two possible final steps in the row reduction. On the other hand, if j is even, then by Proposition [\ref=k_geq_3_endings], we see that FL,k,k is the second member of a pair. Then there are two possible final steps in the row reduction. This leads to the following proposition.

We write

[formula]

If j is odd:

FL,k,k is preceded by a (k - 1) pair. Then row reducing N yields a lower right 3  ×  3 block of the form

[formula] [formula] n,k same parity n,k opposite parity Example: Example:

The determinant of this block is tT  =  eaT  -  (e - 1)bT + cT where e = 2 or 1, respectively.

FL,k,k is preceded by a (k - 2) pair. Then row reducing N yields a lower right 3  ×  3 block of the form

[formula] [formula] n,k same parity n,k opposite parity Example: Example:

The determinant of this block is tτ  =  eaτ  -  (e - 1)bτ + cτ where e = 3 or 2, respectively.

If j is even:

FL,k,k and FL - 1,k,k are preceded by a (k - 1) pair. Example: . Then row reducing N yields a lower right 4  ×  4 block of the form The determinant of this block is wτ  =   - 2aτ + 2bτ + cτ.

FL,k,k and FL - 1,k,k are preceded by a (k - 2) pair. Example: . Then row reducing N yields a lower right 4  ×  4 block of the form The determinant of this block is also wτ  =   - 2aτ + 2bτ + cτ.

We use Proposition [\ref=case_2] or Proposition [\ref=gamma_j] to compute the right hand column in each case.

We have already defined sequences (ai), (bi), and (ci) in Proposition [\ref=k_geq_3_endings]. We use the defining relations for tτ and wτ given in Proposition [\ref=k_geq_3_matrices] above to define sequences (ti) and (wi) for all i.

The sequences (ti) and (wi) satisfy the following recurrences:

[formula]

[formula]

t0 is negative, and the sequence (ti) is nonincreasing, for any of the four pairs (d,e)  =  ( - k + 1,1), ( - k + 1,2), ( - k + 2,2), or ( - k + 2,3).

w0 is positive, and the sequence (wi) is nondecreasing.

From direct computation and Proposition [\ref=k_geq_3_recurrences] we know that a0  =   - k, b0 =  - k + 1, and (ai - bi) =  - 1. Also c0 = 1 if j is even, k - 2 if j is odd and n,k have the same parity, or k - 1 otherwise, and d =  - c0. It is then easy to see that t0 is negative. Then, by the recurrences established in Proposition [\ref=tw_recurrences], we see that ti weakly decreases. On the other hand w0 is positive. Then, by the recurrences established in Proposition [\ref=tw_recurrences], we see that wi increases.

Suppose k  ≥  3, r > 0. Then det (N)  ≠  0, and hence the family [formula] consists of independent curves.

Write n = jk + r with 0  ≤  r  <  j. Suppose k  ≥  3. Then the divisor Dn1,j spans an extremal ray of [formula].

By Propositions [\ref=k_geq_3_kills_curves] and [\ref=k_geq_3_distinct] and Corollary [\ref=k_geq_3_independence_theorem], we know that the family [formula] consists of g - 1 independent curves, all of which intersect Dn1,j in degree zero.

It is possible to solve the recurrences above. This gives the following formulas for the det N when r  ≠  0:

If j is even, | det N|  =  j / 2.

If j is odd and r is even, | det N|  =  j - r / 2.

If j is odd and r is odd, | det N|  =  (j - r) / 2.

These formulas have been checked experimentally for n = 6 to n = 150, and we also proved it in a few cases. They hold for k = 2 as well as k  ≥  3. However, it did not seem worth the extra pages to compute det N when showing det N  ≠  0 suffices to establish the extremality of the divisors Dn1,j. Also, we wanted to keep the exposition for the cases k  ≥  3 and k = 2 as similar as possible, as we only outline the proof for the case k = 2 in the next section.

As in the previous two sections, write n = jk + r with 0  ≤  r  <  j. Now we consider the case k = 2. There are many parallels between the definition and structure of the family when k = 2 and k  ≥  3, but ultimately we felt it was easier to write up these two cases separately.

In contrast with the previous case, we will simply outline the proof when k = 2, omitting many details.

Write n = jk + r with 0  <  r  <  j and k = 2. Suppose j  ≥  6. (For the cases r = 0 and j  ≤  5 see Section [\ref=special_cases_section].)

We define families of curves G and [formula] as follows: If [formula], then set G(i)  =  Fi,3,3. If [formula] and Dn1,j  ·  Fi,1,1 = 0, then set G(i)  =  Fi,3,3. If [formula] and Dn1,j  ·  Fi,1,1  ≠  0 and Dn1,j  ·  Fi,2,2  =  0, then set G(i)  =  Fi,2,2. Otherwise, if [formula] and Dn1,j  ·  Fi,1,1  ≠  0 and Dn1,j  ·  Fi,2,2  ≠  0, then set G(i)  =  Fi,3,3.

We set G  =  {G(i):1  ≤  i  ≤  g}. Let p be the largest index such that G(i)  ≠  Fi,1,1. Then we set   =  {G(i):1  ≤  i  ≤  g,i  ≠  p}.

Let n = 28 and j = 11. We abbreviate and write D11 for D281,11. Then g = 13, so to prove that D11 is extremal, we need 12 independent F-curves which intersect D11 in degree zero. Also k  =  ⌊28 / 11⌋  =  2, so if necessary we will replace curves of the form F1,1,m with curves of the form F2,2,m or F3,3,m.

We compute intersection numbers and choose curves below: Then, we drop the last curve that is not of the form Fi,1,1, which is F12,2,2. Thus, for n = 28, and D11 intersects every member of this family in degree zero.

Every member of G intersects Dn1,j in degree zero.

The family G may contain 1,1-curves, 2,2-curves, and 3,3-curves. In the next proposition, we aim to describe the patterns in which these appear.

The curves in G may be grouped as follows:

G(i) = Fi,2,2 and G(i + 1) = Fi + 1,2,2. We call this pattern a 22.

G(i) = Fi,3,3, G(i + 1) = Fi + 1,2,2, and G(i + 2) = Fi + 2,1,1. We call this pattern a 321.

We define a sequence of pairs and triples (si) when k = 2. (Compare this to Definition [\ref=k_geq_3_s] which applies when k  ≥  3.) If the ith group is of the first type above, we set si = 22. If the ith group is of the second type above, we set si = 321.

Given n and j we can determine how the family G begins.

Write n = jk + r with 0  ≤  r  <  j and k = 2. Then if j  <  2r, we have s0 = 321, and if j  ≥  2r, we have s0 = 22.

Given n and j, we can determine how the family G ends.

Write n = jk + r with 0  ≤  r  <  j and k = 2. Then there are thirteen possible endings for the family G. These are listed in Table [\ref=data_table] below.

The family [formula] consists of g - 1 distinct curves.

We let L2 be the index of the last 2,2-curve in [formula] and let L3 be the index of the last 3,3-curve in [formula]. Let L =  min {L2,L3}.

It will be convenient to define one more sequence, (βi):

The proof of extremality will now break into several cases, depending on the pattern of the curves in the family G. The strategy is similar in every case:

Find a recurrence relation satisfied by the rows L2 and L3 as one row reduces these rows through a 321 or a 22.

Define a sequence xi whose final member xτ computes det N.

Show that the sequence (xi) is absolutely nondecreasing, and x1  ≠  0. Thus det N  ≠  0.

In the next definition and proposition, we carry out Step 1. We define sequences (ai), (bi), (di), (ei), (Ai), (Bi), (Di), and (Ei), and find recurrence relations for these sequences as one row reduces rows L2 and L3 through a 321 or a 22.

If we row reduce row L2 through two columns corresponding to a 22, or two columns corresponding to a 321, there are at most two leading nonzero entries. We denote these ai and bi respectively.

Row L3 begins with three nonzero leading entries, which we denote A0, B0, C0. After row reducing through the first two columns, there are at most two nonzero leading entries, which we denote A1 and B1. If we row reduce rows L2 and L3 through two columns corresponding to a 22, or two columns corresponding to a 321, we again have at most two leading nonzero entries, which we denote Ai and Bi.

Suppose N has m columns. We define sequences (di) and (ei) as the values in row L2 and the columns specified in Table [\ref=data_table] as the matrix N is row reduced. Similarly, we define sequences (Di) and (Ei) as the entries in row L3 and the column specified in Table [\ref=data_table] as N is row reduced.

Recursion when row reducing through a 22. Suppose G(i) = Fi,2,2 and G(i + 1) = Fi + 1,2,2, and i + 4  ≤  L2. Consider the 4  ×  6 submatrix of N whose rows correspond to these two curves, FL2,2,2, and FL3,3,3, and whose columns correspond to the curves Fp,1,1 for p∈{i,i + 1,i + 2,i + 3} plus the columns containing di and ei. Then row reducing through this pair looks like the following: We have

[formula]

for i  ≥  0, and similar recurrences hold for Ai,Bi,Di,Ei for i  ≥  1.

Recursion when row reducing through a 321. Suppose G(i) = Fi,3,3, G(i + 1) = Fi + 1,2,2, and G(i + 2) = Fi + 2,1,1, and i + 4  ≤  L2. Consider the 4  ×  6 submatrix of N whose rows correspond to Fi,3,3, Fi + 1,2,2, FL2,2,2, and FL3,3,3, and whose columns correspond to the curves Fp,1,1 for p∈{i,i + 1,i + 3,i + 4} together with the columns containing di and ei. Then row reducing through this pair looks like the following: We have

[formula]

for i  ≥  0, and similar recurrences hold for Ai,Bi,Di,Ei for i  ≥  1.

In particular, the recurrences for ai, bi, Ai, and Bi are case independent.

ai + 1 - bi + 1  =  ai - bi  =   - 1.

Suppose i  ≥  1. Then Ai  =  Bi  =  ( - 1)βi + 12.

Proof of extremality when : an example

We will present the proof of extremality in Case (1) as an example before we give the general proof.

Suppose that n is even, j is odd, and [formula]. Then by Proposition [\ref=k=2_endings] and Table [\ref=data_table], the sequence (si) ends 321,321,31. Thus L3  =  g - 2 and L2  =  g - 3. The sequences (di) and (Di) are defined by the second to last column (i.e. the column corresponding to the curve Fg - 3,2,2) and the sequences (ei) and (Ei) are defined by the last column (i.e. the column corresponding to the curve Fg - 2,3,3).

For example, here is the matrix N for n = 48,j = 17. The sequence (si) is 321, 321, 321, 321, 22, 321, 321, 31.

We have d0  =  1, e0  =  1, D0  =  0, E0  =  2.

As we row reduce rows L2 and L3 of N, the recurrences of Proposition [\ref=k=2_recurrences] hold until we reach the lower right 5  ×  5 block. (We can see this in the example above for n = 48,j = 17 as follows. The first ten rows all have zeroes to the left of the diagonal, followed by at most four nonzero entries starting on the diagonal, followed by zeroes until the last two columns. Thus, the recurrences apply as long as the nonzero entries do not reach the last two columns, i.e. when we reach the lower right 5  ×  5 block.)

After all these row reductions, the lower right 5  ×  5 block is The determinant of this block is We use this relation to define a sequence (xi) for all i  ≥  1 in terms of the sequences (ai), (bi), (di), (ei), (Ai), (Bi), (Di), (Ei), which were previously defined.

Suppose n = jk + r with 0  ≤  r  <  j and k = 2. Suppose n is even, j is odd, [formula], so that we are in Case (1).

Suppose i  ≥  1. Then Di  =  ( - 1)βi + 1.

Suppose i  ≥  1. Then Ei = ( - 1)βi.

Using the previous formulas gives a simplified formula for xi:

[formula]

Since j  <  2r, we have that s0 = 321. Then we may compute directly by row reducing that D1  =  1 and E1 =  - 1. Then, for i  ≥  1, we may apply the recurrence relations for Di and the formulas for Ai and Bi obtained in Proposition [\ref=k=2_recurrences] above.

The third claim follows once we have the previous two formulas for Di and Ei.

x1 = 5.

The sign of xi is ( - 1)βi + 1, i.e. - bi  +  di - ei + 3  ≥  0.

For i  ≥  1,

We prove the first statement by a direct calculation. Since j  <  2r, we know that s0 = 321. Thus we can compute (a1,b1,d1,e1)  =  (1,2,4,0) and (A1,B1,D1,E1)  =  (2,2,1, - 1), and hence x1  =  ( - 1)2( - 2 + 4 - 0 + 3) = 5.

We prove the remaining statements by induction on the number of 321 and 22's encountered, with i = 1 as the base case. The calculation above shows that the claimed sign for x1 is correct.

For the induction step, if si = 22, so that we row reduce through a 22, we can use the recurrences of Proposition [\ref=k=2_recurrences] as follows:

[formula]

By the induction hypothesis, xi and ( - 1)βi + 12 have the same sign, so we have |xi + 1|  =  |xi| + 2.

Similarly, if si = 321, so that we row reduce through a 321, then again we apply the recurrences of Proposition [\ref=k=2_recurrences]:

[formula]

By the induction hypothesis, xi and ( - 1)βi + 1 have the same sign. We have |xi + 1|  =  |xi| + 1.

Indeed, in the example n = 48,j = 17 above, the sequence xi is 5, - 6,7, - 8, - 10 for [formula].

Proof of extremality when : the general argument

We refer to Table [\ref=data_table] for all the data that is necessary for each case of the general argument.

Given n and j, we first compute how the family G ends. This leads to thirteen different cases. Once we know the ending, we can compute L2 and L3.

Next, for each case, we can determine which columns define the sequences d,D and e,E. Note by Proposition [\ref=cij_summary] that when we write FL2,2,2 and FL3,3,3 in the basis {Fq,1,1}, these rows begin with two or three nonzero entries followed by several zeroes, followed by a nonzero "tail" of length less than 4. These two tails are then propagated to all the previous rows as we form the matrix N from the matrix M. Let L: =  min {L2,L3}. It follows that the upper right (L - 1)  ×  (m - L + 1) block of N has at most two independent columns. We select the leftmost two independent columns to define d,D,e,E. The results are listed in Table [\ref=data_table].

Next, for each case, we can determine when the recurrences of Proposition [\ref=k=2_recurrences] will break down by finding the last row before row L whose nonzero entries after the diagonal do not reach column d,D and column e,E.

Thus we can use the recurrences of Proposition [\ref=k=2_recurrences] to row reduce N until we arrive at one of the thirteen matrices given in Figure [\ref=thirteen_matrices]. Since N is upper triangular with 1's on the diagonal for the first L - 1 rows, the determinant of N is computed by the determinant of this remaining lower right block. We define xτ as the determinant of this block and compute xτ in terms of aτ, bτ, dτ, eτ, Aτ, Bτ, Dτ, and Eτ. We then use this relation to define xi for i  ≥  1 in terms of ai, bi, di, ei, Ai, Bi, Di, and Ei. We write all of these expressions in the format xi  =  ( - 1)βi + 1f(ai,bi,di,ei) and list f in Table [\ref=data_table].

The sequence (xi) is absolutely nondecreasing, and x1  ≠  0.

det N  =  xτ  ≠  0. Therefore the family [formula] is independent.

We refer to the third block of Table [\ref=data_table] throughout the discussion below.

The proof is by induction on i (the number of 321 blocks or 22 blocks) with i = 1 as the base case.

To check the base case, in each case (1)-(13), we can compute a1, b1, d1, e1, A1, B1, D1, and E1 and hence x1, and verify that x1  ≠  0 and has the sign listed in Table [\ref=data_table].

For the induction step, we can use the recurrences of Proposition [\ref=k=2_recurrences] to establish a relationship between xi + 1 and xi when we row reduce through a 22 or 321 respectively. By carefully analyzing the resulting relations together with the signs of xi + 1 and xi, we see that |xi + 1|  ≥  |xi|. The result follows.

Appendix: Data for the proof of extremality when k = 2

References

Software Packages Referenced