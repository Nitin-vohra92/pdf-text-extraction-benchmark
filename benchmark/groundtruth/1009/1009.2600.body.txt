Nonlinear Schrödinger equation with unbounded or vanishing potentials: solutions concentrating on lower dimensional spheres

Lemma Corollary

Introduction

We consider the nonlinear Schrödinger equation

[formula]

which appears for instance in nonlinear optics or condensed matter physics. A standing wave solution of [\eqref=NLS] is a solution of the form

[formula]

where E is the energy of the wave. The function ψ is a standing wave solution of [\eqref=NLS] if and only if u is a solution of the semilinear elliptic equation

[formula]

where ε2  =  2 / 2m and V(x)  =  W(x)  -  E. It is a bound state if [formula]. From a physical point of view, one expects to recover the laws of classical mechanics when   →  0. It is thus interesting to study the behaviour of the solutions of [\eqref=p1] as ε tends to 0. The bound states of [\eqref=p1] with ε small are referred to as semiclassical states.

It is well known that problem [\eqref=p1] possesses solutions which exhibit concentration phenomena as ε  →  0. More precisely, these solutions converge uniformly to 0 outside some concentration set, while remaining uniformly positive in the concentration set. This concentration set can be either a point, a finite set of points or a manifold.

The solutions concentrating around one or several isolated points have been intensively studied (see for example and their bibliographies).

On the other hand, one can ask if there exist solutions of [\eqref=p1] concentrating on a higher dimensional set. This problem has been solved for some specific higher dimensional sets. Solutions concentrating on curves have been found recently in [\cite=MMM], see also [\cite=DKW] for the case N = 2 and for a Neumann singularly perturbed problem. Here we shall restrict ourselves to the problem of solutions concentrating around spheres. In several recent papers , solutions concentrating on (N - 1)-dimensional spheres have been found. In [\cite=MP], solutions concentrating on (N - 2)-dimensional spheres are investigated.

We focus on solutions concentrating around a k-dimensional sphere in [formula], 1  ≤  k  ≤  N - 1. The existence of such solutions has been discussed in remarks in [\cite=AM2], [\cite=AM], [\cite=ByW]. Particular problems arise in the critical frequency case, namely when [formula]. These problems have been tackled in [\cite=AR] and [\cite=ByW].

Assume that p  >  1, that [formula] is a positive bounded radially symmetric potential, that [formula] is bounded and that

[formula]

If there exists r* such that the function [formula] defined for r  >  0 by

[formula]

has an isolated local maximum or minimum at r  =  r*, then, for ε  >  0 small enough, equation [\eqref=p1] has a positive radially symmetric solution [formula] that concentrates at the sphere [formula].

The problem in [\cite=ByW] is rather different. The potential V vanishes and the solutions concentrate around zeroes of V. The asymptotic behaviour depends on the shape of V around 0.

Theorem [\ref=ThAR] relies on a Lyapunov-Schmidt reduction method. The aim of this note is to examine possible improvements in the previous results that can be obtained by using the penalization method, a variational method originally due to Del Pino and Felmer [\cite=DF1] and adapted to our framework in the papers . This method permits us to treat superquadratically decaying potentials, or even compactly supported potentials.

Our results include the following simple particular case.

Let N  ≥  3, [formula] and [formula] be a radial potential. If there exists r*  >  0 such that the function M(r) defined by [\eqref=def:Mr] has an isolated local minimum at r  =  r* such that M(r*) > 0, then for ε small enough, the equation [\eqref=p1] has a positive radially symmetric solution uε that concentrates on the sphere of radius r*.

If N  ≥  5, one has also that [formula] (see Corollary [\ref=cor:L2]).

In contrast with Theorem [\ref=ThAR], we do not require any boundedness assumption on V or its derivatives, and we treat potentials V which are singular at the origin or vanish superquadratically at infinity.

Theorem [\ref=theo:special] is a particular case of Theorem [\ref=Th:main] below, which deals with a nonlinearity which is neither necessarily homogeneous nor autonomous, see equation [\eqref=p1f] below. Furthermore, we will find solutions concentrating on a k-dimensional sphere, 1  ≤  k  ≤  N - 1. In this case, the critical exponent to be taken into consideration is [formula] if N - k  ≥  3, pk  =    ∞   if N - k  =  1,2. We also obtain results for N = 2 with a little more care, see Section [\ref=rem:N=2].

Let us point out that if V is compactly supported and [formula], then equation [\eqref=p1] has no positive solution in the neighborhood of infinity, see the discussion in [\cite=MVS].

Assuming that the potential V is cylindrically symmetric, we can reduce [\eqref=p1] to a problem in [formula]. The single-peaked solutions of this problem can then be extended to [formula] by symmetry. In this way, we obtain a solution of [\eqref=p1] concentrating around a k-dimensional sphere. Observe that since the reduced problem is in [formula], the critical exponent to be considered is the one in dimension N - k. This allows for example to treat critical problems by looking for cylindrically symmetric (non necessarily radial) solutions.

Assumptions and main result

We shall study the equation with a more general nonlinearity

[formula]

Let k be a fixed integer such that 1  ≤  k  ≤  N - 1. This number k is the dimension of the sphere on which we want to construct concentrating solutions. Let us choose any (N - k - 1)-dimensional linear subspace [formula]. We denote by [formula] the orthogonal complement of H. If [formula], we will write x  =  (x',x'') with x'∈H and [formula].

The potentials

We consider a nonnegative potential [formula] and a nonnegative competing function [formula], [formula]. We assume that for every [formula] such that R(H) = H, we have [formula] and [formula]. This will be the case if for example V and K are radial functions.

The nonlinearity

We make classical assumptions on f that lead to a good minimax characterization of the infimum on the Nehari manifold. Namely, we assume that [formula] is continuous and that

there exists q > 1 such that f(s)  =  O(sq) as s  →  0+,

there exists p > 1 such that [formula] and f(s)  =  O(sp) as s  →    ∞  ,

there exists 2  <  θ  ≤  p + 1 such that

[formula]

where [formula],

the function

[formula]

is nondecreasing.

Notice that (f2) is nothing but the subcriticality condition in dimension N - k.

The growth conditions

Following we impose one of the three sets of growth conditions at infinity :

there exists σ  <  (N - 2)q - N such that

[formula]

there exists [formula] such that

[formula]

there exist α  <  2 and [formula] such that

[formula]

Note that in comparison with [\cite=BVS], in (G2∞) and (G3∞), V might vanish somewhere. We also impose one of the three sets of growth conditions at the origin, which mirror those at infinity :

there exists τ  >   - 2, such that

[formula]

there exists [formula] such that

[formula]

there exist γ  >  2 and [formula] such that

[formula]

By Kelvin transform, there is a duality between the conditions at the origin and the conditions at infinity, at least in the case where f(t) = tp. If one defines [formula] to be the Kelvin transform of u, i.e.,

[formula]

and the transformed potentials

[formula]

and

[formula]

the function uε solves [\eqref=p1f] if and only if [formula] solves the same problem with [formula] and [formula] in place of V and K. One sees that V, K satisfy (Gi0) if and only if [formula] and [formula] satisfy (Gi∞).

The problem at the origin is in a sense in duality with the one at infinity. Whereas a slow decay of V at infinity does allow a lot of freedom for K, a strong singularity at the origin allows for very singular K's too. The critical threshold growth is 1 / |x|2 both at the origin and at infinity. This can be made clearer if we observe that the optimal barrier functions at the origin are the optimal one at infinity mapped by Kelvin transform.

The auxiliary potential

Before we can state our last assumption, we need a few preliminaries. Let a,b  >  0. The equation

[formula]

is called the limit equation associated with [\eqref=p1f]. The weak solutions of [\eqref=plim] are critical points of the functional [formula] defined by

[formula]

Any nontrivial critical point [formula] of Ia,b, belongs to the Nehari manifold

[formula]

A solution [formula] is a least-energy solution of [\eqref=plim] if

[formula]

The ground-energy function is defined by

[formula]

and the auxiliary potential [formula] by

[formula]

The following lemma states some properties of the ground-energy function, see [\cite=BVS]*Lemma 3.

Assume [formula] is a continuous function that fulfills assumptions (f1)-(f4). Then, for every [formula], E(a,b) is a critical value of Ia,b and we have

[formula]

If u∈Na,b and E(a,b)  =  Ia,b(u), then [formula] and up to a translation, u is a radial function such that [formula] for every [formula]. Moreover, the following properties hold:

E is continuous in [formula];

for every [formula], a  →  E(a,b*) is strictly increasing;

for every [formula], b  →  E(a*,b) is strictly decreasing;

for every λ  >  0, E(λa,λb)  =  λ1 - N / 2E(a,b);

if f(u)  =  up with [formula], then

[formula]

If f(u)  =  up with [formula], the last property of the preceding lemma implies the following explicit form of the auxiliary potential:

[formula]

Due to the symmetry that we shall impose on the solution (see [\eqref=def:spaceH]), the concentration can only occur in the space [formula]. We assume that there exists a smooth bounded open set [formula] such that

[formula]

for every [formula] such that R(H) = H,

[formula]

and

[formula]

In the case where k = N - 2, we shall need the condition

[formula]

By continuity of M in Λ, this condition is not restrictive. Similarly, we can also assume that V  >  0 on [formula] and that M is continuous on [formula].

Our main result is the following theorem.

Let N  ≥  2, [formula] satisfy one set (Gi0) of growth conditions at the origin and one set (Gj∞) of growth conditions at infinity, and f satisfy assumptions (f1)-(f4). Assume there exists an open bounded set [formula] such that [\eqref=eqLambdacapH], [\eqref=symLambda], [\eqref=hyp:Lambda] and, if k = N - 2, [\eqref=def:Lambda] hold. Then there exists ε0  >  0 such that for every 0  <  ε  <  ε0, problem [\eqref=p1] has at least one positive solution uε. Moreover, for every 0  <  ε  <  ε0, there exists [formula] such that uε attains its maximum at xε,

[formula]

and there exist C > 0 and λ  >  0 such that

[formula]

where Skε is the k-sphere centered at the origin and of radius [formula].

In the special case where [formula] is the unique minimizer of M on [formula], then xε  →  x0, and the solution concentrates around a k-dimensional sphere of radius [formula] centered at the origin.

One should note that the theorem is valid in dimension 2, but the solutions that are obtained do not decay at infinity in general.

Theorem [\ref=theo:special] follows from Theorem [\ref=Th:main] by taking [formula], f(u)  =  up and k = N - 1. Indeed, we notice that the growth condition (G10) is always satisfied whereas the condition (G1∞) holds if and only if (N - 2)p  -  N  >  0, i.e. [formula].

The sequel of the paper is devoted to the proof of Theorem [\ref=Th:main]. In Section [\ref=sec:Penal], we introduce a penalized problem and prove that it has a least energy solution. In Section [\ref=sec:Asympt], we study the asymptotics of this solution and in Section [\ref=sec:barrier], we obtain decay estimates of the solution and show that it also solves the original problem. In all these sections, we assume that N  ≥  3. The modifications for the case N = 2 will be addressed in Section [\ref=rem:N=2].

The penalization scheme

We assume that N  ≥  3. Let [formula] be the set of compactly supported smooth functions. The homogeneous Sobolev space [formula] is the closure of the set of compactly supported smooth functions [formula] with respect to the norm

[formula]

Thanks to Sobolev inequality, we have [formula]. Let us also recall Hardy's inequality in [formula]. One has

[formula]

for all [formula].

Following [\cite=MVS], we define the penalization potential [formula] by

[formula]

where β  >  0 and [formula]. Notice that for all [formula], we have

[formula]

By Hardy's inequality, we deduce that the quadratic form associated to -  Δ  -  H is positive, i.e.

[formula]

for all [formula].

This inequality implies the following comparison principle.

Let [formula] be a smooth domain. Let [formula] be such that [formula], [formula] and

[formula]

If [formula], assume also that w  ≥  v on ∂Ω. Then w  ≥  v in Ω.

It suffices to multiply the inequality [\eqref=comp] by (w - v)-, integrate by parts and use [\eqref=positivity].

Fix μ∈(0,1). We define the penalized nonlinearity [formula] by

[formula]

Let [formula]. One can check that gε is a Carathéodory function with the following properties :

gε(x,s)  =  o(s), s  →  0+, uniformly in compact subsets of [formula].

there exists p > 1 such that [formula] and

[formula]

there exists 2  <  θ  ≤  p + 1 such that

[formula]

the function

[formula]

is nondecreasing for all [formula].

We look for a positive solution of the penalized equation

[formula]

in the Hilbert space

[formula]

endowed with the norm

[formula]

We will search for a solution of [\eqref=p2] in the closed subspace

[formula]

Define [formula] by

[formula]

The functional Jε is well defined and of class [formula]. By the principle of symmetric criticality [\cite=Palais], critical points are weak solutions of [\eqref=p2]. Furthermore, Jε has the mountain pass geometry. It remains to show that Jε satisfies the Palais-Smale condition. The proof below is inspired from [\cite=BVS]. Recall that a sequence [formula] is a Palais-Smale sequence for Jε if

[formula]

For ε sufficiently small, every Palais-Smale sequence for Jε contains a convergent subsequence.

Let [formula] be a Palais-Smale sequence for Jε. It is standard to check, using (g3), that for ε sufficiently small, the sequence (un)n is bounded in [formula]. We infer that, up to a subsequence, [formula] in [formula].

For [formula], set [formula]. Note that

[formula]

By Hardy's inequality, we have for λ  ≥  0,

[formula]

Since (un)n is bounded in [formula], for every δ  >  0, there exists [formula] such that

[formula]

Now we claim that for all δ  >  0, there exists [formula] such that

[formula]

We only sketch the proof, since the arguments are similar to those in [\cite=BVS]*Lemma 6. Since [formula] is compact, there exists λ0  ≥  0 such that

[formula]

Let [formula] be such that 0  ≤  ζ  ≤  1 and

[formula]

Define a cut-off function [formula] by

[formula]

Since 〈J'ε(un),ηλun〉  =  o(1) as n  →    ∞  , we deduce that

[formula]

as n  →    ∞  . If λ  ≥  2λ0, ηλ = 0 on Λ and it follows from (g3) that

[formula]

On the other hand, using Hardy's inequality, we can show as in [\cite=BVS] that

[formula]

Combining [\eqref=ps3], [\eqref=ps4] and [\eqref=ps5], we get, for every λ  ≥  2λ0,

[formula]

By [\eqref=ps:claim1], for λ large enough,

[formula]

the claim follows.

Conclusion. We can write

[formula]

We notice that the first two terms in the right-hand side tend to 0 as n  →    ∞  . Fix δ  >  0 and let λ  >  0 be such that [\eqref=ps:claim1] and [\eqref=ps:claim2] hold. We evaluate the integral in the third term of [\eqref=ps10] separately on Λ, [formula] and [formula], where [formula].

By (g2), one has [formula]. By Rellich Theorem, the embedding [formula] is compact for all q > 1 such that [formula]. We can thus assume that un  →  u in Lp + 1(Λ). We deduce that gε(x,un)  →  gε(x,u) in Lq(Λ) as n  →    ∞  , where [formula]. We conclude from Hölder inequality that

[formula]

By (g3), one has [formula] for [formula]. By Rellich Theorem, we can assume that un  →  u in [formula]. We deduce that gε(x,un)  →  gε(x,u) in [formula] as n  →    ∞  . We conclude as above that

[formula]

Finally, using (g3), [\eqref=ps:claim1] and [\eqref=ps:claim2], we obtain

[formula]

since [formula] and [formula].

Since δ  >  0 is arbitrary, we conclude

[formula]

which ends the proof.

We can now state an existence theorem for the penalized problem [\eqref=p2]. The proof follows from standard arguments.

Let [formula] be a Carathéodory function satisfying (g1) - (g4) and [formula] be a nonnegative function. Then, for all ε  >  0, the functional Jε possesses a nontrivial critical point [formula], which is characterized by

[formula]

The function uε found in Theorem [\ref=Th1] is called a least energy solution of [\eqref=p2]. By standard regularity theory, if [formula] is a solution of [\eqref=p2], then [formula] for every q∈(1,  ∞  ). In particular, [formula] for every α∈(0,1). Since gε is not continuous, we cannot achieve a better regularity. Notice also that, by the strong maximum principle, any nontrivial nonnegative solution [formula] of [\eqref=p2] is positive in [formula].

Asymptotics of solutions

In this section we study the asymptotic behaviour as ε  →  0 of the solution found in Theorem [\ref=Th1]. We follow closely the arguments in [\cite=BVS]*§ 6. We first prove an energy estimate which is the counterpart of [\cite=BVS]*Lemma 12. Let [formula].

Suppose that the assumptions of Theorem [\ref=Th1] are satisfied. For ε small enough, the critical value cε defined in [\eqref=ceps] satisfies

[formula]

where ωk is the volume of the unit sphere in [formula]. Moreover, the solution uε of [\eqref=p2] found in Theorem [\ref=Th1] satisfies, for some C > 0,

[formula]

Let [formula] be such that [formula]. Denote by I0 the functional defined by [\eqref=defIab] with a  =  V(x0) and b  =  K(x0) and w a ground state of [\eqref=plim]. Take [formula] to be a cut-off function such that 0  ≤  η  ≤  1, η  =  1 in a neighbourhood of [formula] and [formula]. Consider the test function

[formula]

Setting

[formula]

we compute by a change of variable

[formula]

For ε small enough, we obtain

[formula]

We deduce from [\eqref=ceps] that

[formula]

which is the desired conclusion.

Suppose that the assumptions of Theorem [\ref=Th1] are satisfied and let [formula] be positive solutions of [\eqref=p2] obtained in Theorem [\ref=Th1]. Then there exists δ  >  0 such that

[formula]

Suppose by contradiction that [formula] as ε  →  0. Then, (f1) implies that, for all ε sufficiently small, Kf(uε)  ≤  μVuε in Λ. By (g3), we deduce that

[formula]

Proposition [\ref=Th:comp] then implies that [formula] for all ε sufficiently small, which is impossible.

By the symmetry imposed on the solution uε, one can write [formula] with [formula]. Since the H1V-norm of uε is of the order ε(N - k) / 2, it is natural to rescale [formula] as [formula] around a well-chosen family of points [formula].

The next lemma shows that the sequences of rescaled solutions converge, up to a subsequence, in [formula] to a function [formula].

Suppose that the assumptions of Theorem [\ref=Th1] are satisfied. Let [formula] be positive solutions of [\eqref=p2] found in Theorem [\ref=Th1], [formula] and [formula] be sequences such that εn  →  0 and [formula] as n  →    ∞  . Set

[formula]

Comparison functions

The next lemma provides a minimal positive solutions of the operator -  Δ  -  H in [formula].

For every ε  >  0, there exists [formula] such that

[formula]

and

[formula]

Moreover, there exists C  >  0 such that, for every [formula] and every ε  >  0,

[formula]

The function Ψε is obtained by minimimizing

[formula]

on the set

[formula]

By classical elliptic regularity theory, [formula]. The estimate [\eqref=PsiepsilonFiniteIntegral] follows from [\eqref=positivity].

In order to obtain the estimate [\eqref=DecayPsiepsilon] consider the problem

[formula]

We have just proved that this problem has a solution [formula] such that

[formula]

Now set for ρ∈(0,1) and x∈B(0,ρ),

[formula]

We compute that

[formula]

Since for [formula],

[formula]

the function W is a supersolution of -  Δ  -  H in B(0,1). Moreover, if one takes ρ  <  1 such that

[formula]

W is positive on ∂B(0,ρ). In view of [\eqref=PsiFiniteIntegral] Proposition [\ref=Th:comp] implies that Ψ is bounded from above by a positive multiple of W in B(0,ρ). Since Ψ is continuous and W is bounded in B(0,1), we obtain that Ψ is bounded in B(0,1). By similarly considering

[formula]

(see Lemma 3.4 of [\cite=MVS]), we obtain that [formula]. We have thus proven that

[formula]

Now, note that since V is nonnegative,

[formula]

In view of [\eqref=PsiFiniteIntegral] and [\eqref=PsiepsilonFiniteIntegral], Proposition [\ref=Th:comp] is applicable, and for every [formula],

[formula]

As explained in [\cite=MVS], the estimate [\eqref=DecayPsiepsilon] is the best one can hope for if V decays rapidly at infinity or is compactly supported. However, if V decays quadratically or subquadratically at infinity, we can improve [\eqref=DecayPsiepsilon].

Let Ψε be given by Lemma [\ref=lemmaPsiepsilon].

If [formula], then there exist λ  >  0, R  >  0 and C  >  0 such that for every ε  >  0 and [formula],

[formula]

If [formula] with α  <  2, then there exist λ  >  0, R  >  0, C  >  0 and ε0  >  0 such that for every ε∈(0,ε0) and [formula],

[formula]

If [formula], then there exist λ  >  0, r  >  0 and C  >  0 such that for every ε  >  0 and x∈B(0,r),

[formula]

If [formula] with α  <  2, then there exist λ  >  0, R  >  0, C  >  0 and ε0  >  0 such that for every ε∈(0,ε0) and x∈B(0,r),

[formula]

For [\eqref=Psiepsiloninfinityquadratic], there exist R  >  0 and λ  >  0 such that for [formula]

[formula]

One then checks that

[formula]

is a supersolution in [formula].

For [\eqref=PsiepsiloninfinitySuperquadratic], there exist R  >  0 and η  >  0 such that for [formula]

[formula]

One then checks that

[formula]

is a supersolution in [formula] with [formula] and ε small enough.

The proofs of the other assertions are similar.

The other tool is a function that describes the exponential decay of uε inside Λ.

Let [formula] and R  >  0 be such that

[formula]

Define

[formula]

There exists λ  >  0 and ε0  >  0 such that for every ε∈(0,ε0), one has

[formula]

First one computes

[formula]

Let us choose λ  >  0 such that λ2  <  (1 - μ) inf ΛV. In view of [\eqref=condRxeps], one has for [formula],

[formula]

This last expression is positive if ε is sufficiently small.

Let (xε)ε  ⊂  Λ be such that

[formula]

and ρ  >  0. Then, there exist ε0  >  0 and a family of functions [formula] such that for all ε∈(0,ε0), one has

Wε satisfies the inequation

[formula]

[formula] and [formula],

Wε  ≥  1 on ∂BH(xε,ερ),

for every x∈BH(xε,ερ),

[formula]

Moreover,

If [formula], then there exists λ  >  0, ν  >  0 and C  >  0 such that for ε  >  0 small enough,

[formula]

If [formula] with α  >  2, then there exists λ  >  0 and C  >  0 such that for ε  >  0 small enough,

[formula]

If [formula], then there exists λ  >  0, ν  >  0 and C  >  0 such that for ε  >  0 small enough,

[formula]

If [formula] with α  >  2, then there exists λ  >  0 and C  >  0 such that for ε  >  0 small enough,

[formula]

Let Ψε be given by Lemma [\ref=lemmaPsiepsilon]. Choose a set [formula] such that [formula], [formula] and [formula] is compact. Choose [formula] such that Ψ̃ε  =  Ψε in [formula] and [formula] in Λ. In view of the estimate of Lemma [\ref=lemmaPsiepsilon], one can also ensure that [formula]. Choose R > 0 such that

[formula]

Let Φxεε be given by [\eqref=def:Phieps] and set

[formula]

By [\eqref=conditionRb], for ε small enough, BH(xε,R)  ⊂  Λ so that [formula]. Moreover, if ε is small enough, Lemma [\ref=CompPeak] is applicable and in [formula], we have

[formula]

In [formula], one has

[formula]

for ε small enough. In [formula], one has

[formula]

for ε small enough since [formula] is positive on [formula]. Finally, in [formula], one has

[formula]

We set

[formula]

where λ is chosen as in the previous lemma. It is standard to see that Wε satisfies properties [\eqref=barrierb] and [\eqref=barrierc]. Statement [\eqref=barrierd] follows from Lemma [\ref=lemmaPsiepsilon]. The other conclusions follow from Lemma [\ref=lemmaImprovedDecay].

Thanks to the previous lemma, we obtain an upper bound on the solutions (uε)ε > 0 of [\eqref=p2].

Suppose that the assumptions of Proposition [\ref=Prop1] are satisfied. Let [formula] be the positive solutions of [\eqref=p2] found in Theorem [\ref=Th1] and (xε)ε > 0  ⊂  Λ be such that

[formula]

Then there exist C > 0, λ  >  0 and ε0 > 0 such that for all ε∈(0,ε0),

[formula]

Moreover, [\eqref=Wepsiloninfinityquadratic], [\eqref=WepsiloninfinitySuperquadratic], [\eqref=Wepsilon0quadratic] and [\eqref=Wepsilon0Superquadratic] in Lemma [\ref=lemma:barrier] hold with uε in place of Wε.

By Lemma [\ref=lemma:subsol], there exist ρ  >  0 and ε0 > 0 such that for all ε∈(0,ε0), the solution uε satisfies inequation [\eqref=lowsol]. Further, [formula] is bounded as ε  →  0 in view of Lemma [\ref=convergentSubsequence]. Let (Wε)ε be the family of barrier functions given by Lemma [\ref=lemma:barrier]. By Proposition [\ref=Th:comp], we have

[formula]

and the conclusion comes from Lemma [\ref=lemma:barrier].

We are now in a position to prove Theorem [\ref=Th:main].

We know from Theorem [\ref=Th1] that the modified equation [\eqref=p2] possesses a positive solution [formula]. In order to prove that for ε small enough, this solution actually solves [\eqref=p1], it suffices to show that, for every [formula], one has

[formula]

Assume that V and K satisfy (G1∞) and (G10), by Proposition [\ref=Prop:decay] and assumptions (f4) and (f1), if ε  >  0 is small enough, we have for all [formula],

[formula]

The other cases can be treated in a similar way.

In some settings, it is interesting to determine whether the solutions are in L2. We obtain as a byproduct the following

Let uε be the solution of [\eqref=p1] found in Theorem [\ref=Th:main]. If N  ≥  5 or [formula], then, for ε small enough, [formula].

This follows immediately from Proposition [\ref=Prop:decay].

The two-dimensional case

In dimension N  =  2, the method has to be modified because the classical Hardy inequality fails on unbounded domains of [formula]. Let us recall the Hardy-type inequality that was proved in [\cite=MVS]*Lemma 6.1:

Let R  >  r. Then there exists C  >  0 such that for every [formula],

[formula]

We deduce therefrom

If [formula] is nonnnegative and non identically 0, then there exists κ0  >  0 such that for ε  >  0 sufficiently small, for every [formula],

[formula]

One sees that by the conformal transformation [formula], Lemma [\ref=lemmaHardyMV] becomes

[formula]

Therefore, one has

[formula]

Since V is continuous and does not vanish identically, there exists [formula] and [formula], such that [formula]. Hence, there exists C  >  0 such that

[formula]

Bringing the inequalities together, there exists C  >  0 such that

[formula]

This brings the conclusion when ε  >  0 is small enough.

The space [formula] can thus be defined as in the case N > 2 as the closure of [formula] with respect to the norm defined by [\eqref=eqNorm].

The penalization potential [formula] is defined by

[formula]

where β  >  0 and κ∈(0,κ0) We see that

[formula]

Together with Lemma [\eqref=lemmaNewHardy], this ensures positivity of the quadratic form associated to -  ε2(Δ + H)  +  V.

As in the case N > 2, this inequality implies the following comparison principle.

Let [formula] be a smooth domain. Let [formula] be such that [formula], [formula] and

[formula]

If [formula], assume also that w  ≥  v on ∂Ω. Then w  ≥  v in Ω.

One continues the proof of Theorem [\ref=Th:main] as in the case N  ≥  3. In Proposition [\ref=prop:PS], one takes [formula] and

[formula]

One then obtains estimate [\eqref=ps5] by using Lemma [\ref=lemmaNewHardy] instead of Hardy's inequality. The only other notable difference lies in the choice of the function W in the proof of Lemma [\ref=lemmaPsiepsilon], where one follows the construction of [\cite=MVS]*Lemma 6.3, i.e.

[formula]