X-ray absorption and occultation in LS 5039

and Guillaume Dubus1 1Laboratoire d'Astrophysique de Grenoble, UMR 5571 Université Joseph Fourier Grenoble I / CNRS, BP 53, 38041 Grenoble, France 2Astronomical Observatory, Jagiellonian University, Orla 171, 30-244 Kraków, Poland

Introduction

Gamma-ray binaries are systems containing a massive star and a compact object that emit most of their power at energies above 100 MeV. They have been detected up to very high energy (VHE) gamma-rays and are thus sites of particle acceleration up to multi-TeV energies. There are three established gamma-ray binaries PSR B1259-63 [\citep=hesspsrb1259], LS 5039 [\citep=hessls5039] [\citep=fermils5039] and LS I+61 303 [\citep=magiclsi61303] [\citep=fermilsi61303] and a candidate binary HESS J0632+057 [\citep=discoveryhessj0632].

The VHE emission in gamma-ray binaries is thought to be due to Compton upscattering of UV photons from the massive star by energetic electrons. Electron acceleration could take place either in a relativistic jet (microquasar scenario, ; ; [\citealt=dermer2006]) or in the shocked wind of a young pulsar (pulsar wind scenario, [\citealt=maraschi1981] [\citealt=dubus2006]), where the shock results from the interaction between the pulsar wind and the stellar wind of the companion star. The latter model is known to be operating in case of PSR B1259-63 (; ). The nature of the compact object and the electron acceleration site are uncertain in the remaining gamma-ray binaries.

Gamma-ray binaries have also been observed in X-rays where their properties differ from those of high-mass X-ray binaries (HMXB). The X-ray spectrum of gamma-ray binaries are power-laws but show no apparent cutoffs up to hundreds of keV. The X-rays are thought to be due to non-thermal synchrotron or inverse Compton emission. Gamma-ray binaries also do not display X-ray outbursts and state transitions as usually seen in accreting binaries.

LS 5039 is the most compact gamma-ray binary, composed of an unknown compact object in a 3.9 day orbit around a O6.5V star [\citep=casares2005]. It has a regular behavior in both gamma-rays and X-rays. The X-ray lightcurve shows an orbital modulation with a remarkable long-term stability [\citep=kishishita2009] [\citep=takahashi2009] [\citep=hoffmann2009]. The modulation is present at low (1-10 keV) and medium (10-40 keV) X-ray energies, with minimum and maximum flux at superior and inferior conjunction respectively. The location of the minima and maxima suggest the modulation is a geometrical effect related to the orientation of the binary with respect to the observer, rather than due to physical changes taking place in the shocked winds region when the compact object travels on its elliptical orbit.

X-ray absorption in the stellar wind and occultation of the X-ray emitting region by the massive star both result in orbital modulations with the correct phases for flux minimum and maximum. However, for LS 5039 there is no evidence for an absorption excess due to the stellar wind at any orbital phase, even at superior conjunction [\citep=takahashi2009]. This has been used to argue that the X-ray emitting region must be far out from the system, where the column density of material crossed by the X-rays is small [\citep=bosch2007] [\citep=bosch2009]. Here, we re-examine this question in detail, taking into account the 3D geometry of the interaction in the pulsar wind scenario to compute model lightcurves. This is used to derive constraints on the binary parameters from the lack of absorption and occultation signatures in the observed lightcurve.

The outline of this article is as follows. The model is described in §[\ref=s:model] and applied in §[\ref=s:absorption] to estimate the size of the X-ray emitting region based on the observed hydrogen column density. The occultation of the X-ray emitting region by the massive star is studied in section §[\ref=s:occultation]. Finally, §[\ref=s:discussion] discusses the findings and presents the conclusions.

The geometric model

Shape of the shock

In the pulsar wind scenario, X-rays are emitted by particles accelerated in the shock region where the pulsar wind and the stellar wind of the massive star collide (Fig. [\ref=shock_schematics]). The interaction region is bounded by two termination shocks [formula] and Sp. Downstream (zones 2 and 3), two shocked winds are separated by a tangential contact discontinuity (CD). Upstream (zones 1 and 4), the winds behave as in the case of single star/pulsar. In this example, the stellar wind momentum dominates over the pulsar wind. The stagnation point Rs between the two winds along the line joining the stars is found by equating the ram pressures from the two winds:

[formula]

where a is the binary orbital separation, [formula] is the stellar wind mass loss rate and [formula] is the pulsar spindown power. The stellar wind velocity v at the radial distance r from the star's centre is given by a β-velocity law

[formula]

where r0  =  1 - (v0 / v∞)1 / β with v0 the initial wind velocity, v∞ is the wind terminal velocity, [formula] is the stellar radius and β  ≈  1 is a parameter describing wind acceleration.

The detailed structure of the shock will depend on the momenta of the winds and on radiative cooling of the gas. Efficient cooling will tend to collapse the termination shocks onto the CD. The shock structure can also be affected by mixing instabilities at the interface and by orbital motion stevens1992. There is no general semi-analytic description of the shock structure but a description of the CD can be obtained. The CD is defined as the surface where the perpendicular components of the ram pressures balance each other [formula]. For each point in space one can then define a dimensionless parameter

[formula]

where θ1 an θ2 are angles between the line tangential to the CD at the given point and the direction towards the star or pulsar respectively as illustrated in Fig. [\ref=shock_schematics]. r1 and r2 are distances from the star and pulsar respectively. The value of η at the stagnation point (θ1  =  θ2  =  π / 2) equals

[formula]

The η0 depends on orbital phase via v(Rs) and parametrizes the shape of the shock, which is then obtained by solving the differential equation (Eq. 6 in )

[formula]

with the initial condition x  =  Rs and y = 0. Numerical simulations show that this holds reasonably well in the case of the interaction with a relativistic pulsar wind [\citep=bogovalov2008]. The solution is a 2D profile of the CD x = f(y). The CD is symmetrical with respect to x-axis, thus it is best represented in cylindrical coordinates (ρ,ψ,x) as x = f(ρ), where [formula] and ψ  =   arctan (z / y).

An example 3D representation of the model is shown in Fig. [\ref=3Dshock_schematics]. In cases where η0  <  1 the stellar wind dominates over the pulsar wind. When η0  ≪  1, the opening angle of the CD [formula] (where α is an angle between x-axis and a line tangential to the CD at a large distance from the stagnation point) and the CD wraps around the pulsar creating a tail-like structure. For η0 > 1 the opening angle [formula] and the CD curves around the massive star. Note that there is a maximum value of η0 associated with a minimum realizable distance R mins between the star and CD. This is approximately the place where [formula] has its maximum. Stable balance is lost if the pulsar wind moves beyond this point: then the pulsar wind overwhelms the stellar wind and is stopped at the star surface.

The shape of the CD will be correct up to the point where the Coriolis force curves the shock structure. Assuming that the stellar wind is collimating the pulsar wind, this happens at a distance ~  v∞Porb, or about 5.4 a.u. (130 R[formula]) for LS 5039 with the parameters given in §[\ref=s:ls5039]. Closer in, the orientation of the surface can also be altered by orbital motion: the skew angle s is given by tan s = vorb / v(a) where vorb is the pulsar orbital velocity.

X-ray emission

In the pulsar wind scenario, the X-ray emission is primarily due to synchrotron emission in the shocked pulsar wind region (zone 3 in Fig. [\ref=shock_schematics]) which is tenuous and optically thin to X-rays. The stellar wind region may also be a source of X-rays, either because of the kinetic energy dissipated in the colliding winds (zone 2) or due to small-scale instabilities in the stellar wind (zone 1) . In both cases the emission is softer (kT  ≈  0.5 keV) and weaker (1030-1033 erg s- 1, e.g. [\citealt=stevens1992]) than the observed X-ray emission from LS 5039 (≈  1033 erg s- 1, [\citealt=takahashi2009]). Detecting X-ray line emission would provide valuable diagnostics of the stellar wind but this emission is most likely swamped by synchrotron emission.

The cooling parameter [formula] of the O star wind [\citep=stevens1992] is ≈  1 in LS 5039, at the limit of efficient radiative cooling. Isothermal (radiatively efficient) shocks have small widths. The pressure in the shocked pulsar wind will mostly be due to the lowest-energy electrons if the particles have a steep distribution. These electrons have long cooling times and the shock may be more closely approximated as adiabatic rather than isothermal. Complex numerical simulations are required to obtain the detailed structure and emissivity of the shock region. At this stage, we assume that the shocked regions 2 and 3 have a negligible width and that the emissivity is uniform over the 2D shock surface, which should suffice to capture the geometrical effects that we want to investigate.

The 2D shock surface is approximated by the CD surface for ρ∈〈0,ρ max〉 and zero otherwise, with ρ max the cylindrical radius at which a sphere centered at (Rs,0,0) of radius Rout intersects the CD (see Fig. [\ref=shock_schematics]). The size of the emitting region is conveniently parametrized by Rout in the following. The total flux from the emitting volume is

[formula]

where jE is the unit volume emissivity, and λjE is the constant surface emissivity. The unit surface element of CD equals

[formula]

Absorption and occultation

The uniform emission of X-rays is affected in two, orbital phase-dependent, ways. First, X-rays can undergo photoelectric absorption as they cross the dense stellar wind. The wind density at the distance r from the stellar center is

[formula]

where mH is hydrogen mass while μ = 1.3 is the mean molecular weight. Second, at some phases and for some inclinations, parts of the emitting surface of the CD are occulted by the massive star and are thus invisible to the observer (black regions in Fig. [\ref=3Dshock_schematics]).

In order to estimate the impact of absorption and occultation on the observed flux, a random sample of N points is uniformly distributed on the surface of CD out to Rout (see Fig. [\ref=3Dshock_schematics] and Appendix A). Each point corresponds to a N-th part of the emitting surface and has a flux equal 1 / N (the total flux is normalized to unity). The observed flux at given energy E, inclination angle i and orbital phase φ is

[formula]

where NHj is the stellar wind's hydrogen column density obtained from integration of n(r) along the line of sight from point j, σ is the photoelectric cross section of the plasma which is a function of photon energy E. If the plasma is ionized, σ also depends on plasma ionization parameter which varies along the line of sight. ζi is the occultation function which value is 0 whenever a line of sight crosses the interior of the massive star and 1 otherwise.

In calculations of NH the parts of the line of sight that cross the pulsar side of the CD (zones 3 and 4 in Fig. [\ref=shock_schematics]) are considered to be empty since neither unshocked nor shocked pulsar wind have sufficient densities to absorb X-rays. For simplicity, we also assume that zone 1+2 are described by Eq. [\ref=eq:vwind] all the way from the stellar surface out to the CD i.e. we ignore the density enhancement in the shocked stellar wind (zone 2). Again (§[\ref=ss:xray]), detailed numerical simulations would be required to model this appropriately. An estimate can be derived using the thin shell colliding wind model of . The surface density of the shock is [formula] in the orbital plane, where it is maximum. This corresponds to a column density across the shock [formula], compared to the wind column density NH  ≈  2 1021cm- 2 from [formula] to infinity (for the same wind parameters). NH,shock is also about 30 times less than the inferred wind column density at superior conjunction (see §[\ref=s:absorption]). We conclude that taking into account the density enhancement in the shocked region is unlikely to change our results significantly.

Parameters for LS 5039

We adopt the following binary parameters for LS 5039: v∞  =  2.4  ×  108 cm s- 1, [formula], [formula] and [formula] K. For the wind of the massive star, we adopt β = 1 and v0  =  2  ×  106 cm s- 1 (Eq. [\ref=eq:vwind]). The value of [formula] in LS 5039 is not well constrained and varies from ~  3  ×  10- 8 to 7.5  ×  10- 7 M[formula] yr- 1, with values of several 10- 7 M[formula] yr- 1 favoured in the most recent litterature ([\citealt=kudritzki2000] [\citealt=mcswain2002] [\citealt=mcswain2004] [\citealt=casares2005]; ). These mass loss rates are derived from Hα line fitting, a diagnostic which is known to be affected by wind clumping [\citep=puls2008]. The true [formula] could be a factor 2-3 lower than the [formula] estimated from Hα. The large range of η that we explore covers this uncertainty.

The binary inclination angle is [formula] if the binary contains a neutron star. The orbit eccentricity is e = 0.33, while the angle of the line of nodes is [formula] [\citep=aragona2009]. For these orbital parameters the periastron, apastron, pulsar superior and inferior conjunction correspond to orbital phases φ  =   0, 0.5, 0.045 and 0.67 respectively. The respective binary separations are 1.4  ×  1012, 2.82  ×  1012, 1.46  ×  1012, and 2.59  ×  1012 cm. The skew angle is [formula] at periastron and [formula] in apastron. This has a negligible impact on the conclusions and is not taken into account.

A strict lower limit on the value of [formula] in LS 5039 is ≃1035 erg s- 1 which implies 100% radiative efficiency to gamma rays (at a distance of 2-3 kpc). At the other end of the scale, the pulsar wind will impact the star surface beyond a certain [formula] set by [formula] and the binary separation at periastron. Such a situation is thought to occur in the black widow pulsars where the wind from the low-mass stellar companion is very weak [\citep=phinney1988]. If the pulsar wind is dominated by the kinetic energy of the cold e+ e- pairs then radiative braking of the pulsar wind by inverse Compton losses might still allow a shock to form just above the O star surface . The magnetic field of the O star may also be sufficient to hold off the pulsar wind [\citep=harding1990]. However, there is no observational evidence that the stellar wind in LS 5039 collapses due to the relativistic wind momentum impinging on its pulsar-facing hemisphere. [\citet=mcswain2004] find no differences in UV spectra taken at two different orbital phases (0.40 and 0.63 based on ephemeris of [\citealt=aragona2009]), the latter one close to inferior conjunction of the compact object where the effect of the O star wind quenching by the pulsar wind should be most visible. Assuming the O star wind does not collapse implies a maximum η max≃0.6, reached at periastron, for which the CD opening angle is [formula]. For the lower and upper limit on [formula], the corresponding [formula] varies between ~  1.5  ×  1036 erg s- 1 and 3.8  ×  1037 erg s- 1 respectively, well below the [formula] of the Crab pulsar (4.6  ×  1038 erg s- 1). In the following calculations we often use the value of η0 = 0.004 to examine the model predictions in the case of extreme stellar wind domination over the pulsar wind. At this value of η0 the CD opening angle is only [formula].

There is also no evidence for X-ray ionization of the stellar wind [\citep=mcswain2004], suggesting that the impact of ionization on X-ray absorption can be neglected. We confirmed the validity of this assumption for LS 5039 with the photoionization code XSTAR [\citep=xstar]. In the simulation, an optically thin plasma cloud was illuminated by a source with a spectrum composed of a power law with spectral index 1.5 and 1-10 keV luminosity 6.03  ×  1033 erg s- 1 ([\citealt=takahashi2009], assuming a 2.5 kpc distance to LS 5039 from Earth) and a black body (stellar continuum) with a temperature [formula], radius [formula] and luminosity [formula] erg s- 1. The measured opacities in the 1-10 keV range did not differ from those of the cold plasma described by [\citet=morrison1983]. The intense UV radiation of the massive star does not influence the plasma opacity at energies above 0.5 keV.

X-ray absorption in LS 5039

Observations show no signatures of X-ray absorption by the stellar wind in LS 5039. The XMM-Newton and Suzaku spectra of LS 5039 are absorbed by an equivalent hydrogen column density consistent with the Galactic value. The upper limit on the intrinsic column density at the phase of superior conjunction (where the line of sight column density related to the stellar wind is highest) is as low as N maxH = 2.6  ×  1021 cm- 2 [\citep=bosch2007] [\citep=takahashi2009].

The photoelectric absorption depends on four parameters, [formula], i, Rout and η0. This can be used to estimate the maximum allowed [formula] for which the line of sight column density does not exceed N maxH. For example, for a point X-ray source located at the pulsar position, at the phase of superior conjunction, and at inclination angle [formula], the upper limit on the stellar wind mass loss rate is [formula] M[formula] yr- 1. For a point source located at the stagnation point, the [formula] is lower, since the line of sight probes regions of the stellar wind with higher density. For an X-ray emitting point source located at Rs and for which η0  =  η max, then [formula] M[formula] yr- 1.

These values of [formula] are at the lower end of the [formula] scale for the Galactic O stars, [\citep=mokiem2007]. [formula] could be higher if the wind was highly ionized but this is unlikely (see §[\ref=s:ls5039]). [formula] could also be higher if the X-ray emitter is away from the massive star, e.g., in the form of a jet, emitting X-rays at a distance >  1012 cm where the stellar wind is rarified [\citep=bosch2007]. Another possibility is that the X-ray emitting region is not point-like but large compared to the size of the massive star.

For the measured value of N maxH and as a function of [formula], we estimate the minimum size of the X-ray emitting region for which intrinsic absorption would not manifest itself in the X-ray spectrum. The upper limit N maxH is based on X-ray data fitting which assumed that an entire (point or extended) X-ray source is covered by a uniform absorbing gas cloud so that

[formula]

where the intrinsic flux equals 1. In our case however, where an extended X-ray source is absorbed by a stellar wind, the line of sight column density of each X-ray emitting surface element is different and the observed flux is given by Eq. [\ref=eq:flux]. In general, the observed spectra of a source covered by an uniform absorber and of a source covered by stellar wind are different ([formula] keV). We assume that the spectral fitting is not able to distinguish between different types of absorbers if the fluxes at 1 keV are equal i.e.

[formula]

where σ(1keV)  =  2.4  ×  10- 22 cm2 [\citep=morrison1983]. This is justified, because at energies [formula] keV, the photoelectric cross-section decreases quickly and the difference between the two absorbed spectra is relatively small. Furthermore, the spectrum is most sensitive to absorption at energies [formula] keV, but below 1 keV the sensitivity of the instruments starts to drop and the data errors increase which may also make it difficult to distinguish between different models.

In order to obtain the lower limit on the size of the X-ray emitting region at 1 keV, we explore the parameter space ([formula], η, Rout, i) to find solutions that satisfy Eq. [\ref=eq:equation_size] at superior conjunction. In this calculation we reject points which are occulted by the star (adjusting N accordingly) to test only the effect of absorption.

The estimated minimum size of the 1 keV X-ray source is shown in Fig. [\ref=extended_source]. The size of the emitting region must be larger to compensate for the denser gas when the mass loss rate is increased. For η0≃η max and at large emitter size, the results are not sensitive to inclination changes. The highly collimated pulsar wind shock (η0  ≪  1) needs to have a large emitting surface to explain the observations.

Occultation in LS 5039

The occultation of the X-ray emitting region by the massive star does not depend on energy, thus its only signature in the spectrum is a periodic reduction in flux. The amplitude and duration of occultation depend on three main parameters i, η0 and Rout. We find that the duration of the occultation is longest for binaries with circular orbits and where at all phases η0  >  1 (when the CD curves around the massive star). The occultation duration can last up to 40% of the orbital period. The latter is because curved portions of the CD are partly occulted by the star even at phases away from the superior conjunction. The amplitude of occultation is highest if the inclination is high and the size of the emitting region is small compared to the size of the star. However, this situation is unlikely to occur in LS 5039 since [formula] (see §[\ref=s:ls5039]).

When η0 is below unity, occultation influences the shape of the X-ray lightcurve only around superior conjunction. Lightcurves calculated for the most preferable conditions to observe occultation in LS 5039 (high η0, high i and small Rout) are shown in Fig. [\ref=lightcurves_occultation]a. The dip in the lightcurve caused by occultation is narrow and covers only Δφ  ~  0.2 in phase around superior conjunction. The depth of the minimum strongly depends on Rout. Note also that for large Rout two minima appear, separated by a local maximum. This effect is related to the size of the shadow cast by the star onto the CD surface, which is larger when the line of sight is tangential to the surface of CD. These two local minima are too narrow (Δφ  ~  0.025) to be resolved in the Suzaku lightcurve. A similar lightcurve study for η0  ≪  1 shows even deeper and narrower minimum than in case of η0  ~  η max (Fig. [\ref=lightcurves_occultation]b).

The X-ray modulation cannot be explained by occultation alone but this does not preclude an observable effect in the form of a sharp drop in flux around superior conjunction. In order to place an upper limit on this effect, we normalize the Suzaku lightcurve to 1 and fit it with a sine function in order to remove the orbital modulation. The standard deviation of the subtracted data is σd = 0.1. The upper limit on the depth of a dip in the data is assumed to be 3σd, meaning a [formula] reduction of the 1-10 keV flux would not be statistically significant. The dip in the lightcurve at the superior conjunction may be caused by the combined effects of absorption and occultation. The effect of absorption on 1-10 keV flux is low. In a simple estimate, for NH = N maxH and for the observed power law spectrum of LS 5039 with photon index Γ = 1.51, the integrated absorbed (using uniform absorber, i.e., wabs model in xspec) 1-10 keV flux is at most ~  6% lower than the 1-10 keV unabsorbed flux. Therefore we do not take absorption into account in the following calculations.

There is no significant dip in the data of LS 5039 at the phases close to superior conjunction. To put constraints on the binary parameters based on the lack of occultation only, we explore the parameter space to find solution to equation in superior conjunction

[formula]

The final product of the study is Fig [\ref=occultation] where areas above each curve correspond to inclination angles and sizes of the X-ray emitter for which the effect of occultation at superior conjunction does not exceed the 3σd limit. The range of allowed parameters changes with the shape of CD.

Conclusions

Using a 3D model of a gamma-ray binary in the framework of the pulsar wind scenario, we tested the influence of X-ray absorption and occultation on the lightcurve and spectrum of LS 5039. We find that occultation cannot be responsible for the smooth X-ray orbital modulation in LS 5039, since this would require η0 > 1. This appear unlikely because there is no sign in the UV lines [\citep=mcswain2004] that the O star wind is quenched on the hemisphere facing the compact object. Even for the most favorable conditions ([formula] and large i) the duration of occultation never exceeds Δφ = 0.2. The cause of the X-ray modulation has to be found elsewhere .

Constraints on the binary geometry are derived from the observed upper limit on the intrinsic column density and on the depth of the occultation dip. Limiting the effects of absorption and occultation requires the X-ray source to be extended. The minimum size of the X-ray emitting region, which depends on the stellar mass loss rate, shape of CD and inclination angle, varies between 3-15 [formula]. An emitter size [formula] with [formula] would be compatible with a [formula] binary inclination. The limit based on the lack of X-ray eclipses and assuming a point source at the compact object location is 60[formula] [\citep=casares2005]. A large X-ray source also loosens the constraints on the stellar mass loss rate derived from the observed lack of intrinsic absorption. For example, for η0  ~  0.004, an emission region [formula] at inclination [formula], allows a mass-loss rate of 1.5  ×  10- 7 M[formula] yr- 1 compared to 4.7  ×  10- 8 M[formula] yr- 1 for a point source located at the pulsar position. A more precise determination of the stellar wind mass loss rate would greatly help narrow down the possibilities. Still, we can conclude that an extended X-ray source appears necessary to reconcile the pulsar wind scenario with the upper limits on X-ray absorption in the wind and the absence of occultation features in the lightcurve.

An extended X-ray source in gamma-ray binary can be expected in the pulsar wind scenario. High-energy electrons will be accelerated and randomized all along the termination shock of the pulsar wind. The shock distance from the pulsar is smaller towards the stellar companion than away from the O star, the efficiency of particle acceleration may also change at different locations. Calculations also show that the synchrotron emission from the electrons peaks in the 1-10 keV range only after significant cooling ([\citealt=dubus2006]; ). For a typical magnetic field of 0.1-1 G, the injected electrons radiate primarily synchrotron above 0.1 MeV while they upscatter stellar photons to energies above a GeV. The electrons are advected away in the shocked flow with an initial speed ≈  c / 3. The bulk of the 1-10 keV radiation is emitted at a distance [formula] from the star in Fig.  4 of [\citet=dubus2006]. More detailed modeling is required to obtain the exact evolution of the shock conditions with distance and quantify precisely the extent of the X-ray emission region. Such modeling would also yield the precise contribution to the X-ray emission and absorption from the shocked stellar wind region, which we have neglected here (§[\ref=s:model]).

The application to other known gamma-ray binaries is not straightforward since these contain a Be star with a dense equatorial outflow in addition to the tenuous stellar wind. The geometry of the interaction region with the pulsar wind changes between the polar wind and disk wind and can have a complicated shape at the transition that has yet to be investigated. However, the wider orbits of LS I+61[formula]303 and PSR B1259-63, the estimated inclination of [formula] in PSR B1259-63, will limit the impact of absorption and occultation on the lightcurve.

Acknowledgments

This work was supported by the European Community via contract ERC-StG-200911 and in part by the Polish MNiSW grant NN203065933.

Appendix A - Random generation of uniformly distributed points on the 3D surface.

Here we explain how to generate a random sample of points uniformly distributed on a 3D surface S, symmetrical with respect to x-axis, described by a function f(ρ) where [formula]. We adopt an accept-reject algorithm commonly used for generating random samples drawn from an arbitrary distribution.

First, we generate N random points distributed uniformly on the yz-plane. The points are denoted in polar coordinates as (ρ1,ψ1),(ρ2,ψ2),...,(ρN,ψN) where ρi∈〈0,ρ max〉 and ψi∈〈0,2π〉.

Second, we assign to each point a random number w∈〈0,1〉, where w1,w2,...,wN are drawn from an uniform distribution. The wi are weights, used to accept and reject points on the basis of a density function

[formula]

where Δρ  →  0, P(ρi)∈〈0,1〉, dS is a unit 3D surface element given by Eq. [\ref=eq:ds], and

[formula]

Finally, from our sample of points uniformly distributed on the 3D surface, we choose only points for which wi  <  P(ρi). In the paper, f is the solution to Eq. [\ref=eq:antokhin], while ρ max is determined by Rout and has to be found numerically. An example sample of points is plotted in Fig. [\ref=3Dshock_schematics].