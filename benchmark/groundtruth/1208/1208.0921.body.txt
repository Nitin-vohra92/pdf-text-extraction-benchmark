Fractal analysis of resting state functional connectivity of the brain

Introduction

The dynamics of endogenous neuronal activities has been an important issue in neuroscience since it is supposed to take control of most neuronal activities arising in the brain [\cite=Fox2007a]. The huge default-mode functional network of the brain has been usually investigated through resting state neuroimaging data such as electroencephalography (EEG) and functional magnetic resonance imaging (fMRI) [\cite=Laufs2003] [\cite=DeLuca2006] [\cite=Musso2010] [\cite=Deco2011]. One of the major goals in resting state neuroimaging research is the reliable inference of functional dynamics of spontaneous neuronal population activities from resting state neuroimaging data. However, it is not straightforward since resting state signals may be significantly affected by non-neuronal physiological factors. On the other hand, the response to stimulation in task-based experimental paradigm is prominently correlated with brain activities either directly or indirectly.

One of the non-neuronal obstacles in resting state neuroimaging studies is the fractal behavior (or long-range dependence) where the power spectrum tends to exhibit 1 / fα power law scaling across low frequencies. This phenomenon has been observed through a number of resting state neuroimaging studies [\cite=Zarahn1997b] [\cite=Stam2004] [\cite=VandeVille2010] [\cite=Expert2011]. As such a phenomenon has been ubiquitously observed in nature, the fractal behavior in neuroimaging data may also arise from various mediators such as respiration [\cite=Cordes2001a] [\cite=Birn2006], cardiac fluctuations [\cite=West1999], system noise, hemodynamics (in the case of fMRI) as well as neuronal activities [\cite=Teich1997] [\cite=Mazzoni2007] [\cite=Allegrini2009].

The classical model of fractal behavior or long memory in baseline neuroimaging signals has been the fractional Gaussian noise (FGN) which is defined as an increment process of fractional Brownian motion (FBM) and completely characterized by both Hurst exponent and variance [\cite=Beran1994]. The FGN model has been adopted to various fractal-based analyses of fMRI data for a decade so as to account for scale-free dynamics of neuroimaging signals [\cite=Bullmore2001] [\cite=Bullmore2004a] [\cite=Maxim2005] [\cite=Achard2006] [\cite=Wink2008].

However, there is a controversy about whether the FGN is the most appropriate model for resting state neuroimaging signals among a variety of long memory models. While the FGN model is defined just with two parameters under mathematically strict conditions of self-similarity, a neuroimaging signal is produced from a nonlinear biological system which is controlled by numerous hidden parameters. In this reason, the fractionally integrated process (FIP) model, based on the concept of fractional differencing [\cite=Hosking1981a], is worth consideration as an alternative to the FGN model since it embraces diverse types of long memory. Indeed, the FGN is regarded as a special type of the FIP model which is more extensive than FGN.

In this paper, we adopted the fractionally integrated process (FIP) model to effectively describe the fractal behavior of neuroimaging signals. In the FIP model, a neuroimaging signal is represented as the output of a long memory (LM) filter whose input is a nonfractal signal (sometimes called short memory as a notion corresponding to long memory). In other words, a nonfractal signal is transformed into a neuroimaging signal with fractal behavior through long memory filtering as shown in Fig. [\ref=fig:lmfilter], which indicates that the fractal behavior is attributed not to the nonfractal input but to the LM filter. The influence of several factors on the fractal behavior can be well aggregated in terms of a sequence of long memory filters.

The FIP model sheds light on the influence of fractal behavior on functional connectivity. The correlation of resting state neuroimaging signals between two brain regions may significantly differ from that of the nonfractal input signals according to the difference of memory parameters. Hence, the ordinary correlation of resting state neuroimaging data may not well reflect the functional dynamics of spontaneous neuronal activities due to the fractal behavior.

The theoretical expectation that functional connectivity may be influenced by fractal behavior leads us to take into account the correlation of fractal-free input signals as a novel concept of resting state functional connectivity while the Pearson correlation of neuroimaging signals has been the most popular definition of functional connectivity. This particular correlation, which is independent of fractal behavior, is called the nonfractal connectivity. Its mathematical description is provided in section [\ref=section:nonfractal-conn]. The nonfractal connectivity is not exactly identical to the correlation of spontaneous neuronal population activities due to the nonlinearity of neurophysiological systems. However, it may give us better information on correlation structure of spontaneous neuronal populations than ordinary correlation of neuroimaging data since it eliminates the distortion of functional connectivity due to fractal behavior.

The nonfractal connectivity is comparable to fractal connectivity which was first proposed in [\cite=Achard2008] as the asymptotic value of wavelet correlations over low frequency scales. The wavelet correlations of two long memory processes are converged on a specific value which is determined by the correlation of short memory parts as well as memory parameters. We show the theoretical relevance of nonfractal connectivity to fractal connectivity.

In this paper, we propose three wavelet-based approaches to estimating both nonfractal connectivity and fractal connectivity: (1) the SDF(Spectral density function)-based method, (2) the covariance-based method, and (3) the linearity-based method. As prerequisite to estimating these connectivities, memory parameters should be estimated a priori. We tested two wavelet-based univariate estimators of memory parameter: the wavelet-based least-mean-squares (LMS) method and the wavelet-based maximum likelihood (ML) method. The performance of all proposed estimators was verified through simulation studies. We also show an example of applying these estimators to resting state fMRI data taken from anesthetized rat brains to estimate nonfractal connectivity.

This paper is organized as follows. In section [\ref=section:long-memory-model], the FIP model of resting state neuroimaging signals is briefly introduced, and the concepts of nonfractal connectivity and fractal connectivity are described in section [\ref=section:nonfractal-conn]. The wavelet-based estimators of both connectivities are proposed in section [\ref=section:estimation]. The results of simulation studies and experiments in fMRI data are provided in section [\ref=section:simulation] and [\ref=section:fmri].

Long memory model

Fractal properties of a time series can be modeled as long memory models such as FGN, ARFIMA, and GARCH processes. In this section, we especially introduce both univariate and multivariate fractionally integrated processes (FIP) that encompass several classes of long memory such as fractionally integrated noise (FIN), FGN, and ARFIMA [\cite=Granger1980] [\cite=Hosking1981a].

Univariate case

Let x(t) be a real-valued discrete process of length N given by

[formula]

where [formula], L denotes the back-shift operator, and u(t) (called short memory) is a stationary process whose spectral density [formula] is a non-negative symmetric function bounded on [formula] and bounded away from zero at the origin. x(t) can be represented as the convolution of u(t) with the long memory (LM) filter g(t) as follows

[formula]

where

[formula]

If - 1 / 2  <  d < 1 / 2, the spectral density of x(t) is given by

[formula]

The fractal behavior is controlled by the memory parameter d. If 0 < d < 1 / 2, the process x(t) is said to be a stationary long memory process with memory parameter d while x(t) is nonstationary if d > 0.5. If d = 0, the process becomes a white noise.

Multivariate case

The definition of the univariate long memory model can be extended to the multivariate case. Consider a real-valued q-vector process [formula] given by

[formula]

where [formula] is a multivariate stationary process whose spectral density [formula] is bounded on [formula] and bounded away from zero at the origin. For  - 1 / 2  <  dk  <  1 / 2, the spectral density of [formula] is given by

[formula]

where

[formula]

In the case of 0 < dk < 1 / 2 for 1  ≤  k  ≤  q for 1  ≤  k  ≤  q, [formula] is said to be a stationary long memory process with memory parameter [formula]. If [formula] is a vector ARMA process, [formula] becomes a multivariate ARFIMA process. On the other hand, if [formula] is a vector i.i.d. random variable, i.e.

[formula]

[formula] becomes a multivariate fractionally integrated noise (mFIN). In this case, the cross-spectral density of xm(t) and xn(t) is given by

[formula]

where γm,n is identical to the (m,n)-th element of Σu.

Nonfractal and fractal connectivity

As discussed in the section [\ref=section:introduction], the most popular definition of functional connectivity has been the Pearson correlation. The multivariate long memory model introduced in the section [\ref=section:long-memory-model] additionally provides two novel definitions of resting state functional connectivity: fractal connectivity and nonfractal connectivity. While fractal connectivity is defined based on the asymptotics of wavelet correlation, nonfractal connectivity is defined based on the covariance of short memory.

Nonfractal connectivity

Let [formula] be an mFIN process with memory parameter [formula], and [formula] be a short memory function of [formula] given in [\eqref=eq:order-diff]. The nonfractal connectivity of xm(t) and xn(t) is defined as

[formula]

where γm,n denotes the covariance of um(t) and un(t); that is, [formula].

Fractal connectivity

The variance of a discrete time series can be decomposed over several frequency bands (called scales) through the discrete wavelet transform (DWT). Let Wi(j,k) be the wavelet coefficient of the ith process xi(t) at scale j and time point k. The wavelet covariance is defined as [formula] at scale j. Since the wavelet coefficients of an FIP at a scale j is covariance stationary, νm,n(j) is independent of time t. Let Hj(f) be the squared gain function of the wavelet filter such that

[formula]

Then, the wavelet covariance of xm(t) and xn(t) at scale j is related to the cross-spectral density [\cite=Percival2000a] as follows

[formula]

The wavelet correlation [formula] is given by

[formula]

Suppose that [formula] is a multivariate FIN process which satisfies the condition [\eqref=eq:zt-iid]. Then, the wavelet covariance of xm(t) and xn(t) at scale j is approximated by

[formula]

where

[formula]

It is well known the following Taylor series

[formula]

From [\eqref=eq:cross-sdf] and [\eqref=eq:est_sin2],

[formula]

Substituting [formula] in [\eqref=eq:wave-cov-sdf] with [\eqref=eq:est_S(f)], we finally get [\eqref=eq:wave-cov-asymp].

The asymptotic property of wavelet correlation [\ref=theorem:asymp-wave-cov] was also proved for more general cases of short memory in [\cite=Achard2008]. From [\eqref=eq:wave-cor] and [\eqref=eq:wave-cov-asymp], the wavelet correlation of xm(t) and xn(t) asymptotically converges to

[formula]

where

[formula]

The asymptotic wavelet correlation ρ∞m,n is called the fractal connectivity of xm(t) and xn(t). The ratio of fractal connectivity to nonfractal connectivity is given from [\eqref=eq:vfip-scor] by

[formula]

The ratio depends just on a pair of long memory parameters as depicted in Fig. [\ref=fig:RATIO-FF-NF]. As the difference of long memory parameters increases, fractal connectivity gets away from nonfractal connectivity. On the other hand, fractal connectivity is nearly identical to nonfractal connectivity if the difference of two memory parameters approaches zero.

Estimation of fractal connectivity and nonfractal connectivity

The multivariate FIP model indicates that both nonfractal connectivity and fractal connectivity can be well estimated if memory parameters are known. Here we deal with a simple case such that a given time series is approximated as a multivariate FIN process (mFIN). The estimation of nonfractal connectivity and fractal connectivity is organized as two steps. The first step is to estimate memory parameters, and the next step is to compute both fractal connectivity and nonfractal connectivity given the memory parameters. In this section, several wavelet-based techniques which can be exploited in each step are introduced. All of these methods are based on the wavelet transform which are optimal to investigate the properties of long memory processes.

Estimation of memory parameters

Wavelet least-mean-squares method (LMS)

By taking logarithm to [\eqref=eq:wave-cov-asymp], we obtain the following linear relationship of wavelet variance in the logarithm scale:

[formula]

It enables us to estimate the memory parameters m by linear regression over a given scale interval [formula] on the basis of the biased estimator of wavelet variance given by

[formula]

where nj is the number of coefficients in scale j except boundary coefficients [\cite=Percival2000a]. In a similar manner with [\cite=Achard2008], the optimal scale interval [formula] for linear regression in [\eqref=eq:linear-wave-cov] is globally determined by

[formula]

where [formula] is the space of all scale intervals, [formula], and

[formula]

Wavelet maximum-likelihood method (ML)

The likelihood function for memory parameter dm and asymptotic variance Gm is given by

[formula]

The matrix Σm denotes the covariance matrix of xm(t), and can be replaced by [formula] where W is a wavelet transform matrix and Λ is a diagonal matrix which has diagonal elements Λm(j): = νm(j) given in [\eqref=eq:wave-cov-asymp] for j = 1,...,J as an average value of spectral density function (SDF) over the band [formula]. The reduced log likelihood function can be obtained on the basis of the Brockwell and Davis's method [\cite=Brockwell1991]:

[formula]

with N = 2J, Nj = N / 2j, and

[formula]

where Vm are the scaling coefficients at scale J and Wj,t is the t-th element of j-th level wavelet coefficients. The optimal memory parameter m can be estimated by minimizing [\eqref=eq:loglikelihood] with respect to m [\cite=Percival2000a].

Estimation of short-memory covariance

The SDF-based method (SDF)

The estimator m,n of short memory covariance can be semiparametrically computed by [\eqref=eq:sigma-fip]. Since Vm  ≈  0 in stationary long memory processes, the equation can be approximated as

[formula]

The covariance-based method (COV)

Alternatively, the short memory covariance can be estimated by exploiting the properties such that the sum of wavelet covariances over all scales is identical to the covariance of a time series; i.e.,

[formula]

Since [formula] for a FIN process, the estimator of short memory covariance can be obtained from [\eqref=eq:wave-cov-asymp] and [\eqref=eq:sum-wave-cov] as follows

[formula]

The linearity-based method (LIN)

The estimator of short memory covariance can be also obtained in the other way based on the linearity of wavelet covariance over scales as follows.

[formula]

where

[formula]

[formula]

Estimation of fractal and nonfractal connectivity

After the estimators for memory parameters [formula] and the short memory covariance [formula] are obtained, the nonfractal connectivity m,n can be estimated by using [\eqref=eq:nonfractal-con-def] as follows

[formula]

Likewise, fractal connectivity ∞m,n can be estimated from [\eqref=eq:vfip-scor] and [\eqref=eq:nonfractal-con-est] as follows

[formula]

Simulation study

In this section, the performance of three wavelet-based estimators for nonfractal connectivity was evaluated. We also analyzed the influence of short memory condition, dimension, and length of time series on the estimation of nonfractal connectivity. By combining a connectivity estimator with a memory parameter estimator, six pairs of estimator, such as LMS-LIN, LMS-COV, LMS-SDF, ML-LIN, ML-COV, ML-SDF methods, were finally tested.

Setup

We simulated multivariate ARFIMA[formula] processes that belong to the FIP model. First, the short memory [formula] in [\eqref=eq:order-diff] was given as an ARMA(p,0) process as follows

[formula]

In [\eqref=eq:sim-zt], εi(t) for [formula] is an i.i.d. random variable where

[formula]

[formula]

and

[formula]

If we set

[formula]

where b = ρ(q - 2)  -  (q - 3), the short memory correlation is forced to be Dm,n  =  ρ for m,n > 1 and m  ≠  n. Afterwards, the memory parameters [formula] were equally distributed over d∈( - 1 / 2,1 / 2), and the multivariate ARMA(p,0) process was filtered by the LM filter defined in [\eqref=eq:long-memory-filter].

Effects of short memory condition

To study the effects of short memory conditions on the performance of estimators, we performed Monte Carlo simulations with 100 repetitions of four-dimensional ARFIMA(p,d,0) processes under four different types of short memory condition in [\eqref=eq:phi-ar] and [\eqref=eq:innovation]:

[formula] and φk,i = 0

[formula], φk,1 = 0.9 and φk,i = 0 for i > 1

[formula] and φk,i = 0

[formula], φk,1 = 0.9 and φk,i = 0 for i > 1

where [formula] and [formula] was set with ρ = 0.3 in [\eqref=eq:innovation-condition]. In the conditions (1A) and (1B), each short memory process is statistically independent of each other while the conditions (2A) and (2B) let short memory processes be cross-correlated. On the other hand, the conditions (1B) and (2B) let each process be autocorrelated.

In Fig. [\ref=fig:short-mem-cond], all methods were weak in the conditions (1B) and (2B) where short memory parts were more auto-correlated; the relative decrease in consistency for two cases was common to all six methods. The deteriorated performance in (1B) and (2B) is a foreseeable result since these short memory conditions no longer follow the assumption of mFIN in [\eqref=eq:zt-iid] adopted for our proposed estimators. Hence, our proposed estimators were not efficient when the set of short memory signals cannot be approximated as a multivariate i.i.d. process.

In the cases (2A) and (2B) where short memory processes are cross-correlated, LMS-LIN, ML-LIN, and ML-COV estimators were not significantly biased. However, Fig [\ref=fig:nonfractal-dim] and [\ref=fig:nonfractal-dim-highcor] show that all estimators except LMS-LIN are more biased as the correlation of short memory increases when the dimension (the number of time series) is large.

In these experiments, the short memory processes were given as a multivariate ARMA(0,0) process with innovation which fulfills [\eqref=eq:innovation] and [\eqref=eq:innovation-condition]. The short memory correlation coefficient in [\eqref=eq:innovation-condition] was set by either ρ = 0.2 or ρ = 0.8. In Fig [\ref=fig:nonfractal-dim] and [\ref=fig:nonfractal-dim-highcor], the absolute bias of estimators except LMS-LIN increased as the dimension increases, and the increasing rate of bias was faster when the short memory correlation was high. Hence, the high correlation of short memory results in the deterioration of estimation performance. All the above results show that the bias of estimators tends to be associated with cross-correlation of short memory parts, but also that the consistency tends to be related to auto-correlation of each short memory part. In summary, the performance of our proposed estimators for nonfractal connectivity is manifestly influenced by the short memory conditions.

Effects of dimension and length of time series

Fig [\ref=fig:nonfractal-dim] and [\ref=fig:nonfractal-dim-highcor] show that the estimators of nonfractal connectivity except LMS-LIN depend on the dimension of time series. The LMS-LIN method was relatively less biased even in high dimension than other methods, however the consistency was large. On the other hand, the other methods were more biased as the dimension increases; especially the increase in bias was more prominent in the LMS-SDF and ML-SDF methods. Hence, the increase in the number of time series leads to the poor performance of estimating nonfractal connectivity. Nevertheless, the ML-COV method has the best consistency even in high dimension and high correlation.

Fig. [\ref=fig:nonfractal-len] shows that the performance of nonfractal connectivity estimation is associated with the length of time series. In multivariate ARFIMA(0,d,0) processes with zero cross-correlation between short memory parts, the consistency of all methods was improved as the length of time series increases. However, the LMS-LIN method had greater bias than ML-LIN when the length of time series was small. In Fig. [\ref=fig:short-mem-cond], the LMS-LIN and ML-LIN methods had different performance in all tested short memory conditions even though they have the common approach to estimating nonfractal connectivity. These results imply that the estimation of nonfractal connectivity can be affected by the estimator of memory parameter.

Concluding Fig. [\ref=fig:short-mem-cond]-[\ref=fig:nonfractal-len], the ML-COV method would be the best choice as an estimator of nonfractal connectivity since it exhibits small bias in various cases of short memory conditions and high consistency even in high dimension and high short memory correlation. As shown in Fig [\ref=fig:nonfractal-example], the connectivity matrix estimated by the ML-COV method has smaller difference with the original short memory correlation matrix than those produced by other methods have. However, it is theoretically expected that the covariance-based method including ML-COV may be more sensitive to additive noises than other methods. In the case that the signal-to-noise ratio is low, the ML-LIN method may have better performance than ML-COV.

Resting state functional MRI

We applied our proposed estimator of nonfractal connectivity to a resting state fMRI data of the anesthetized rat brain taken from 4.7T MRI scanner. We manually separated the 15 ROIs from the anatomical MRI image, and mapped them into the 64  ×  64  ×  8 volume of blood-oxygen-level-dependent (BOLD) signals in fMRI by using the FLIRT (FMRIB's Linear Image Registration Tool). These ROIs correspond to aCG, CPu-L, CPu-R, MEnt+MEntV-L, MEnt+MEntV-R, HIP-L, HIP-R, S1-L, S1-R, S2-L, S2-R, LSI+MS, TE-L, TE-R, and TH [\cite=Paxinos2007].

We computed both the Pearson correlation and nonfractal connectivity by using the ML-LIN method. In Fig. [\ref=fig:fmri-conn], the estimated nonfractal connectivity has significantly different patterns from the ordinary correlation. As shown in the modularized graph representations of Pearson correlation and nonfractal connectivity obtained after thresholding the number of edges by 20, the nonfractal functional network tends to exhibit increased modularity while the correlation-based functional network exhibits high randomness.

Conclusion

In this article, we modeled a resting state neuroimaging signal as a fractionally integrated process and introduced the nonfractal connectivity as a novel concept of resting state functional connectivity. There is no empirical evidence which demonstrates that the nonfractal connectivity reflects the correlation of spontaneous neuronal population activities. Through empirical analyses and computational modeling of resting state neuroimaging data, the association of nonfractal connectivity and neuronal population activities needs to be clarified in the future.

We also proposed several wavelet-based methods for estimating nonfractal and fractal connectivity. These estimators are optimal under the assumption that the given signals can be approximated by an mFIN while neuroimaging signals would have various short memory and can be seriously contaminated by physiological or system noises. Hence, the estimators need to be improved in a variety of short memory conditions and the existence of additive noises. It would be also valuable to figure out the biological mechanism of fractal behavior which gives rise to the distortion in functional connectivity. All these challenges may give us insight into the relationship of resting state functional connectivity and fractal behavior.

Acknowledgment

This neuroimaging research was supported by the special project grant from the Leibniz Institute for Neurobiology, and SA was partly funded by ANR 2010 JCJC 0302 01. We thank Frank Angenstein for fMRI data.