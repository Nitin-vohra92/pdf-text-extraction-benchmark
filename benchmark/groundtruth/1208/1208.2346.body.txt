= =0.5in =0.35in

On existence of Budaghyan-Carlet APN hexanomials

=×

Introduction

If f is a function from [formula] to [formula], one can ask for the number of solutions to f(x + a)  =  f(x)  +  b, where [formula] and a is nonzero. Note that if x is one solution, then x + a is another, so the solutions come in pairs. The function f is said to be almost perfect nonlinear (APN) if there are always exactly zero or two solutions. The function f(x + a)  +  f(x) is called a derivative of f. An APN function is simply a function whose derivatives yield two-to-one maps on [formula]. As pointed out by Carlet, Charpin, and Zinoviev [\cite=CCZ], the APN property is equivalent to the property that a certain binary linear code defined in terms of f is double error-correcting. Construction of APN functions is a recurring theme in the literature; see [\cite=BDKM], [\cite=BDMW], [\cite=CarletDCC], and the survey article [\cite=Carlet].

Let r = 2m and s = 2n, where m,n  ≥  1. For [formula], and [formula], Budaghyan and Carlet [\cite=BC] consider the hexanomial

[formula]

For any positive integer N, denote by μN the group of N-th roots of unity in the algebraic closure of [formula]. If M is odd, then μM has order M, and μM  ⊂  μN if and only if M divides N. In particular, [formula], where [formula] denotes the nonzero elements of a field [formula].

.

. If ys + 1  +  cys  +  cry  +  1 has no roots y belonging to μr + 1, then all the derivatives of F are 2k-to-1 mappings from [formula] to [formula], where [formula]. (In particular, if k = 1, then F(x) is APN.)

Let us say that the pair (r,s) is BC-compatible if [formula] can be found satisfying the hypothesis of the theorem. We found an exact and surprisingly simple criterion for BC-compatibility:

. The pair r = 2m, s = 2n is BC-compatible if and only if m  >  1 and n / m is not an odd integer.

Previously, it was known that (r,s) is BC-compatible only in some special cases. In [\cite=BC] it was found empirically that (2m,2) is BC-compatible whenever 6  ≤  2m  ≤  500 and [formula], and also in at least 140 of the 166 checked cases when 3 divides m. Later, Bracken, Tan, and Tan [\cite=BTT] proved that (r,s) is BC-compatible if [formula] or 4 mod 6 and [formula], and in particular the Budaghyan-Carlet APN hexanomials belong to an infinite family. All the cases in [\cite=BC] and [\cite=BTT] satisfy that ys + 1  +  cys  +  cry  +  1 has no roots in [formula]. This condition is stronger than the required hypothesis, since [formula].

Theorem 2 implies that if c is properly selected, then F(x) is APN whenever m > 1 and [formula]. We will show that F(x) is APN when m = 1 also, so in fact the only requirement is [formula]. More generally, we prove the following.

. For all r  =  2m and s = 2n, and for all [formula], a value [formula] can be found such that all the nonzero derivatives of F(x) are 2k-to-one mappings from [formula] to [formula], where [formula].

For another viewpoint on the APN hexanomials F(x), see [\cite=CarletDCC], where it is shown that they belong to a family that is constructed using bent functions.

Proof of Theorem 1

For completeness, we present the proof by Budaghyan and Carlet of Theorem 1. As above, r = 2m, s = 2n, [formula], and [formula]. Note that [formula], where u = 2k, [formula]. Let F(x) be the hexanomial defined in ([\ref=Fdef]). Assuming the hypothesis that ys + 1  +  cys  +  cry  +  1 has no roots in μr + 1, we are to show that for any nonzero [formula] and any [formula], the equation

[formula]

has exactly zero solutions or exactly u solutions in [formula].

Denote the number of solutions by N(a,b). Let Ga(x) = F(ax)  +  F(ax  +  a)  +  F(a). Then N(a,b) is the number of solutions in [formula] to Ga(x) = F(a) + b. We claim that Ga is an [formula]-linear function. Accepting this for the moment, we see that proving N(a,b)∈{0,u} is equivalent to showing that Ker(Ga) (considered as an [formula]-linear function on [formula]) has order u. We will in fact show [formula].

To see that Ga is [formula]-linear, we note that the terms in F(ax) are of the form αxv + w or αxv, where [formula] and v,w∈{r,s,rs,1} (all powers of u). Thus, Ga is a sum of terms α(xv + w  +  (x + 1)v + w  +  1)  =  α(xv  +  xw). This is [formula]-linear because v and w are powers of u. Note also that Ker(Ga) contains [formula], because xv + xw = x + x = 0 for all [formula].

Now Ga(x)  =  as + 1(x + xs)  +  ar + 1(x + xr)  +  cars + 1(x + xrs)  +  crar + s(xr + xs)  +  das + rs(xs + xrs)  +  a(s + 1)r(xrs + xr). Suppose Ga(x0) = 0 with [formula]. Then of course Ga(x0)  +  Ga(x0)r  =  0. Using that xr20 = x0, ar2 = a, cr2 = c, dr2 = d, we find that many terms in Ga(x0)r cancel with terms in Ga(x0). The result is

[formula]

Now [formula] since [formula], [formula] since a  ≠  0. So we have x0  +  xr0 = 0. Returning to the original formula for Ga and using the relation x0  =  xr0, we see that every term either vanishes or becomes a multiple of x0 + xs0:

[formula]

Since a is nonzero, the term as + 1 is nonzero. Since ar - 1 belongs to μr + 1, the hypothesis of the theorem implies that 1  +  ca(r - 1)s  +  crar - 1  +  a(s + 1)(r - 1) is nonzero. So we conclude that Ga(x0)  =  0 implies xr0 = x0 and xs0 = x0, i.e. [formula]. This proves that [formula], as claimed.

Proof of Theorem 2

As above, let r = 2m and s = 2n, where m,n  ≥  1. Let

[formula]

The technical condition needed in Theorem 1 for the hexanomial F(x) to have desired properties is that there exists [formula] such that G(c,y) has no roots in μr + 1. If such c exists, then we say that the pair (r,s) is BC-compatible. We first need a lemma.

. r + 1 divides s + 1 if and only if n / m is an odd integer.

First, suppose [formula] is an odd integer, and we will show that r + 1 divides s + 1. Since [formula] if and only if a|b, and since 2m|2n, we see that [formula]. Since [formula] if and only if the order of x divides 2a - 1, we see that [formula] and [formula]. Let τ denote the Frobenius map on [formula] (given by squaring), ρ  =  τm, and [formula]. Note that ρ(a) = ar and σ(a) = as, for [formula]. Now

[formula]

Since [formula] is odd, we see that if z∈μr + 1 then [formula], and so z∈μs + 1. Thus, μr + 1  ⊂  μs + 1, and consequently r + 1 divides s + 1.

To prove the converse, suppose that r + 1 divides s + 1 and we will prove that n is an odd multiple of m. Let Kr denote the subfield of the algebraic closure of [formula] that is generated by μr + 1. We claim [formula]. First, [formula], so [formula]. Now [formula] can be viewed as a vector space over Kr. If the dimension is d, then r2 = |Kr|d  ≥  (r + 1)d  >  rd. So d = 1, and consequently [formula] as claimed.

Since r + 1 divides s + 1, we have μr + 1  ⊂  μs + 1, so the field generated by μr + 1 is contained in the field generated by μs + 1. That is, [formula]. It follows that m divides n, say [formula]. Let τ, ρ, σ be as above, and let 1  ≠  z∈μr + 1. By ([\ref=FrobFormula]), ρ(z) = 1 / z. Since [formula], and z  ≠  1 / z, we see that σ(z) = 1 / z if [formula] is odd, and σ(z)  =  z  ≠  1 / z if [formula] is even. On the other hand, z∈μr + 1  ⊂  μs + 1, so by ([\ref=FrobFormula]), σ(z) = 1 / z. Then [formula] must be odd.

Now we prove our theorem.

. Let r and s be arbitrary positive integral powers of two, and let

[formula]

There exists [formula] such that G(c,y) has no roots in μr + 1 if and only if r > 2 and r + 1 does not divide s + 1. (By the lemma, these conditions on r and s are equivalent to m > 1 and n / m is not an odd integer.)

First let us show if r  =  2 then G(c,y) has a root in μ3 for any [formula]. If c∈{0,1} then G(c,1) = 0. If [formula] then G(c,y) = 0 for y = c∈μ3. This establishes the result when r = 2.

Now let us show if r  +  1 divides s  +  1 then for all [formula], the polynomial G(c,y) has a root y∈μr + 1. If c = 0, then G(c,1) = 0. If c  ≠  0, then set y = c(r / 2)(r - 1). This belongs to μr + 1, because yr + 1 = (cr / 2)r2 - 1 = 1. Since r + 1 divides s + 1, we have ys + 1 = 1, so

[formula]

For the remainder of the proof, assume r > 2 and [formula]. We must find [formula] such that G(c,y) has no roots y∈μr + 1. For y∈μr + 1, let

[formula]

We are seeking [formula], where

[formula]

Such c exists if and only if |X|  <  r2.

Since G(c,y) has degree r in the variable c, we have |Xy|  ≤  r. This gives a bound:

[formula]

This bound is not good enough, as we need to show |X|  <  r2. To attain this, we must take into account that the sets Xy are not disjoint.

We consider separately the two cases: r + 1 divides s - 1, and r + 1 does not divide s - 1. If r + 1 divides s - 1, then for y∈μr + 1 we have G(c,y) = y2  +  (c  +  cr)y  +  1. It follows that

[formula]

and so Xy  =  Xy- 1. Consequently, [formula], where the union includes one representative among each pair {y,1 / y}. There are 1  +  r / 2 representatives, giving |X|  ≤  r(1  +  r / 2). Since r > 2 by hypothesis, this is less than r2, as required.

Finally, we consider the case where [formula] and [formula]. Observe that [formula]. Also, observe that if y∈μr + 1 then G(y,y) = 0, so y∈Xy. Thus, X1  ⊂  Z  ⊂  X, where

[formula]

It follows that

[formula]

and so

[formula]

This leads to the inequality

[formula]

So to demonstrate that |X| < r2, it suffices to show that [formula] for all [formula], and [formula] for at least one y. We will do this by constructing some explicit elements of [formula].

Two elements of [formula] are y and y- s. These are in Xy because for c  =  y,

[formula]

and for c = y- s,

[formula]

Note that y and y- s are distinct if and only if ys + 1  ≠  1.

If ys - 1  ≠  1 then we can obtain another element of [formula] by setting

[formula]

Here [formula], because (using yr  =  1 / y) we have

[formula]

Also c0∈Xy, because

[formula]

Since [formula] and [formula], we know c0 is distinct from y and y- s.

In summary, for [formula] we have:

If ys - 1  ≠  1 and ys + 1  ≠  1, then c0, y, and y- s are distinct elements of [formula].

If ys - 1  ≠  1 but ys + 1  =  1, then c0 and y are distinct elements of [formula].

If ys - 1  =  1 then y and y- s are distinct elements of [formula].

We see that [formula] always. Moreover, when y is a primitive (r + 1)th root of unity, then from the hypothesis that r + 1 does not divide s + 1 or s - 1, we will have that ys + 1  ≠  1 and ys - 1  ≠  1, so [formula]. As noted above, this completes the demonstration that |X| < r2, and completes the proof.

Proof of Theorem 3

Theorem 3 asserts that for r = 2m and s  =  2n, and any choice of [formula], there always exists [formula] such that the nonzero derivatives of the hexanomial F(x) given by ([\ref=Fdef]) are 2k-to-one mappings from [formula] to [formula], where [formula]. Here we provide a proof.

If m does not divide n, then (r,s) is BC-compatible by Theorem 2, so Theorem 3 holds. If m divides n, then the next lemma shows that any choice of c will work, so that Theorem 3 again holds.

. If m divides n (equivalently, [formula]), then the nonzero derivatives of F(x) are r-to-one mappings from [formula] to [formula], for any choice of [formula] and [formula].

For nonzero [formula], let Ga(x)  =  F(ax)  +  F(ax + a)  +  F(a). As explained in the proof of Theorem 1, it suffices to prove that Ga has exactly r roots in [formula]. If [formula], then using the relation xr20 = x0, we find that Ga(x0) + Ga(x0)r  =  (d + dr)as + rs(x0 + xr0)s. This is nonzero, therefore [formula]. If [formula], then using the relation xr0 = x0 we find that Ga(x0)  =  (x0 + xs0)as + 1(1  +  ca(r - 1)s  +  crar - 1  +  a(s + 1)(r - 1)). Since [formula], we see that x0 + xs0 = 0, and so Ga(x0) = 0. This establishes that Ga has exactly r roots in [formula], as required.