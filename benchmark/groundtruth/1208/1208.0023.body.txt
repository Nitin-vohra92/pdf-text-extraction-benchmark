Lemma Corollary Proposition Definition Remark

Device-Independent Quantum Key Distribution with Local Bell Test

Introduction

The security of quantum key distribution (QKD) [\cite=bb84] [\cite=ekert91] relies on the fact that two honest parties, Alice and Bob, can devise tests--utilizing laws of quantum physics--to detect any attack by an eavesdropper, Eve, that would compromise the secrecy of the key strings they generate [\cite=Gisin2002]. While the theoretical principles allowing this are nowadays well understood, it turns out that realizing QKD with practical devices is rather challenging. That is, the devices must conform to very specific models, otherwise the implementation may contain loopholes allowing side-channel attacks [\cite=sidechannelrefs].

In general, there are two broad approaches towards overcoming such implementation flaws. The first is to include all possible imperfections into the model used in the security analysis. This approach, however, is quite cumbersome and it is unclear whether any specific model includes all practically relevant imperfections. In the second approach, which is known as device-independent QKD (DIQKD) [\cite=pironio09] [\cite=McKague2009] [\cite=haenggi10] [\cite=Haenggi10a] [\cite=masanes10], the security is based solely on the observation of non-local statistical correlations, thus it is no longer necessary to provide any model for the devices (though a few assumptions are still required). In this respect, DIQKD appears to be the ultimate solution to guarantee security against inadvertently flawed devices and side-channel attacks.

DIQKD in its current design requires the two distant parties Alice and Bob to perform a Bell test [\cite=Bell1964] (typically the Clauser-Horne-Shimony-Holt (CHSH) test [\cite=Clauser1969]), which is applied to pairs of entangled quantum systems shared between them. In practice, these quantum systems are typically realized by photons, which are distributed via an optical fiber. Hence, due to losses during the transmission, the individual measurements carried out on Alice's and Bob's sites only succeed with bounded (and often small) probability. In standard Bell experiments, one normally accounts for these losses by introducing the fair-sampling assumption, which asserts that the set of runs of the experiment--in which both Alice's and Bob's measurements succeeded--is representative for the set of all runs.

In the context of DIQKD, however, the fair-sampling assumption is not justified since Eve may have control over the set of detected events. More concretely, she may use her control to emulate quantum correlations based on a local deterministic model, i.e., she instructs the detector to click only if the measurement setting (chosen by the party, e.g., Alice) is compatible with the prearranged values. This problem is commonly known as the detection-loophole [\cite=Pearle1970]. In fact, for state-of-the-art DIQKD protocols, it has been shown in Ref. [\cite=Gerhardt2011] that the detection-loophole is already unavoidable when using optical fibers of about 5km length.

One possible solution to this problem are heralded qubit amplifiers [\cite=HQA], which have been proposed recently. The basic idea is to herald the arrival of an incoming quantum system without destroying the quantum information it carries. This allows Alice and Bob to choose their measurement settings only after receiving the confirmation, which is crucial for guaranteeing security. Unfortunately, realizing an efficient heralded qubit amplifier that is applicable for long distance DIQKD is extremely challenging; although there has been progress along this direction [\cite=Kocsis2012].

In this work, we take a different approach to circumvent the detection-loophole. We propose a protocol that combines a self-testing scheme for the Bennett and Brassard (BB84) states [\cite=bb84] with a protocol topology inspired by the "time-reversed" BB84 protocol [\cite=Biham96] [\cite=Inamori2002] [\cite=Braunstein2012] [\cite=Lo12]. Crucially, the protocol only requires Bell tests carried out locally in Alice's laboratory, so that the detection probabilities are not affected by the losses in the channel connecting Alice and Bob. We show that the protocol provides device-independent security under the assumption that certain devices are causally independent (see below for a more precise specification of the assumptions).

In contrast to existing protocols for DIQKD, whose security is inferred from the monogamy of non-local correlations, the security of our protocol is proved using a recent generalization of the entropic uncertainty relation that accounts for quantum side information [\cite=berta10]. This is the key ingredient that allows us to circumvent the need to bound the non-locality between particle pairs shared by Alice and Bob (non-locality over larger distances is hard to achieve, as explained above). Instead, the uncertainty relation solely depends on the local properties of the states sent by Alice, which in turn, can be inferred from the local Bell test.

Technically, our security proof uses a relation between the local CHSH test and a variant of the entropic uncertainty relation for smooth entropies [\cite=Tomamichel2010]. The analysis applies to the (practically relevant) finite-size regime, where the secret key is generated after a finite number of channel uses. The resulting bounds on the achievable key size are comparable to the almost tight finite-size result [\cite=Tomamichel2012a] for the BB84 protocol. Furthermore, in the (commonly studied) asymptotic limit where the number of channel uses tends to infinity, and in the limiting case where the CHSH inequality is maximally violated, the performance of our protocol reaches the one of the BB84 protocol.

Required Assumptions

As mentioned above, our goal is to impose only limited and realistic assumptions on the devices used by Alice and Bob. These are as follows:

First, it is assumed that Alice and Bob's laboratories are perfectly isolated, i.e., no information leaves a party's laboratory unless this is foreseen by the protocol. Second, we assume that Alice and Bob can locally carry out classical computations using trusted devices and that they have trusted sources of randomness. Third, we assume that Alice and Bob share an authenticated classical channel. Finally, we require that the devices of Alice and Bob are causally independent, that is, there is no correlation in their behavior between different uses. This, for instance, is guaranteed if the devices have no internal memory or if their memory can be reliably erased after each use.

We remark that, in very recent work [\cite=RUV12] [\cite=VV12] [\cite=BCK12], it has been shown that this last assumption can be weakened further for standard DIQKD protocols. More precisely, it is shown that the assumption of causal independence can be dropped for the repeated uses of a device within one execution of the protocol. However, the assumption of causal independence still needs to be made when the same devices are reused in a subsequent execution of the protocol, as information about previously generated keys may leak otherwise [\cite=BCK13].

Protocol Topology

In this section we describe the basic idea and the main structure of the QKD scheme we propose. The actual protocol will then be detailed in the next section.

Our proposal is motivated by the time-reversed BB84 protocol [\cite=Biham96] [\cite=Inamori2002] [\cite=Braunstein2012] [\cite=Lo12]. This protocol involves a third party, Charlie, whose task is to help Alice and Bob distribute their key strings. Importantly, however, no trust in this third party is required. While a deviation of Charlie from the protocol may cause abortion of the key distribution protocol, it will not compromise the secrecy of a successfully distributed key string. The time-reversed BB84 protocol consists of the followings steps: first, Alice and Bob each generate a pair of qubits in the maximally entangled state [formula] and send one of their qubits to Charlie. Subsequently, Charlie performs a Bell-state-measurement (BSM) on the two received qubits and broadcasts the outcome to Alice and Bob [\cite=Bennett1993]. The two remaining qubits held by Alice and Bob are now in a Bell state. Alice then applies appropriate bit and phase flips on her qubit to convert this joint state to [formula]. Finally, Alice and Bob measure their qubits at random in one of the two BB84 bases. Note that Alice and Bob can alternatively measure the qubits they kept before Charlie performs the BSM, and Alice flips the outcome of her measurement if necessary once she has received the correction (i.e., the outcome of the BSM) from Charlie.

The security of the time-reversed BB84 protocol, as described above, depends on the correct preparation and measurement of the states by Alice and Bob. In order to turn this protocol into a device independent one, we add a CHSH test on Alice's site. Security is then established by virtue of a relation between the violation of this CHSH test and the incompatibility of the two possible measurements carried out by Alice's device (which are supposed to be in the two BB84 bases). More precisely, we bound the overlap between the basis vectors of the two measurements that Alice may choose. This is all that is needed to apply the entropic uncertainty relation [\cite=Tomamichel2010] mentioned in the introduction, which allows us to infer security without any further assumptions on Alice's and Bob's devices. We note that our modification of the time-reversed BB84 protocol is reminiscent of the idea of self-testing of devices introduced by Mayers and Yao [\cite=MY04] (see Ref. [\cite=MYS12] for the CHSH version). Our test has however a different purpose: its goal is to certify the incompatibility of Alice's local measurements, while the test of Mayers and Yao certifies that Alice and Bob share a maximally entangled state.

In order to realize the CHSH test, we use a setup with three different devices on Alice's site: two measurement devices [formula], [formula] and a source device [formula] (see Fig. [\ref=fig1]). The source device generates a pair of entangled qubits and sends them to [formula] and [formula]. The device [formula] has two settings [formula] [\cite=footnote1] and produces a binary output after one of the settings is chosen by Alice. The device [formula] has three settings [formula]. The first two produce a binary output (a measurement outcome), and the last one sends the qubit (from the device [formula]) to the quantum channel which connects to Charlie. Alice has therefore two modes of operation, of which one (corresponding to the settings [formula]) is used to carry out the CHSH test and one (corresponding to the setting [formula]) is chosen to communicate to Charlie. We refer to these operation modes as [formula] and [formula], respectively.

Bob has two devices: a measurement device [formula] and a source device [formula]. The latter generates entangled qubits and sends one of them to the quantum channel and the other to [formula]. The device [formula] has two settings [formula] and produces a binary output after one of the settings is chosen by Bob.

Protocol Description

The protocol is parameterized by the secret key length [formula], the classical post-processing block size mx, the error rate estimation sample size mz, the local CHSH test sample size mj, the tolerated CHSH value [formula], the tolerated channel error rate [formula], the tolerated efficiency of Charlie's operation [formula], the error correction leakage [formula] and the required correctness [formula].

In the following, the first three steps are repeated until the conditions in the sifting step are satisfied.

1. State preparation and distribution: Alice selects an operation mode [formula] where [formula] is selected with probability [formula] and [formula] is selected with probability 1 - ps [\cite=footnote2]. In the following, we describe [formula] and [formula] formally for each of the runs, which we label with indices i.

[formula]: Alice measures both halves of the bipartite state. More specifically, she chooses two bit values ui,vi uniformly at random, where ui sets the measurement on the first half to [formula] or [formula] and vi sets the measurement on the second half to [formula] or [formula]. The outputs of each measurement are recorded in si and ti, respectively.

[formula]: Alice selects a measurement setting [formula] with probabilities [formula] and 1 - px, respectively [\cite=footnote2], measures one half of the bipartite state with it and stores the measurement output in yi. The other half of the bipartite state is sent to Charlie.

Similarly, Bob selects a measurement setting [formula] with probabilities px and 1 - px, respectively, measures one half of the bipartite state with it and stores the measurement output in yi'. The other half of the bipartite state is sent to Charlie.

2. Charlie's operation: Charlie makes an entangling measurement on the quantum states sent by Alice and Bob, and if it is successful, he broadcasts [formula], otherwise he broadcasts [formula]. Furthermore, if [formula], then Charlie communicates gi∈{0,1}2 to Alice and Bob. Finally, Alice uses gi to make correcting bit flip operations.

3. Sifting: Alice and Bob announce their choices {hi}i,{ai}i,{bi}i over an authenticated classical channel and identify the following sets: key generation [formula], channel error rate estimation [formula], and Alice's local CHSH test set, [formula].

The protocol repeats steps (1)-(3) as long as |X| < mx or |Z| < mz or |J| < mj, where [formula]. We refer to these as the sifting condition.

4. Parameter estimation: To compute the CHSH value from J, Alice uses the following formula, [formula], where f(ui,vi,si,ti) = 1 if [formula], otherwise f(ui,vi,si,ti) = 0. Next, both Alice and Bob publicly announce the corresponding bit strings {yi}i∈Z, [formula] and compute the error rate [formula]. Finally, they compute the efficiency of Charlie's operation η: = |X| / || where [formula]. If [formula] or [formula] or [formula], they abort the protocol.

5. One-way classical post-processing: Alice and Bob choose a random subset of size mx of X for post-processing. An error correction protocol that leaks at most [formula]-bits of information is applied, then an error verification protocol (e.g., this can be implemented with two-universal hashing) that leaks [formula]-bits of information is applied. If the error verification fails, they abort the protocol. Finally, Alice and Bob apply privacy amplification [\cite=Bennett1995] with two-universal hashing to their bit strings to extract a secret key of length [formula] [\cite=RennerThesis].

Security definition

Let us briefly recall the criteria for a generic QKD protocol to be secure. A QKD protocol either aborts or provides Alice and Bob with a pair of key strings, SA and SB, respectively. If we denote by E the information that the eavesdropper (Eve) gathers during the protocol execution, then the joint state of SA and E can be described by a classical-quantum state, [formula] where {ρsE}s are quantum systems (conditioned on SA taking values s) held by Eve. The QKD protocol is called [formula]-correct if [formula], and [formula]-secret if [formula] where [formula] is the probability that the protocol aborts and USA is the uniform mixture of all possible values of the key string SA. Accordingly, we say that the QKD protocol is [formula]-secure if it is both [formula]-correct and [formula]-secret [\cite=Tomamichel2012a] [\cite=MullerQuadeRenner] [\cite=RennerThesis]. Note that this security definition guarantees that the QKD protocol is universally composable [\cite=RennerThesis] [\cite=MullerQuadeRenner]. That is, the pair of key strings can be safely used in any application (e.g., for encrypting messages) that requires a perfectly secure key (see [\cite=RennerThesis] for more details).

Security analysis

In the following, we present the main result and a sketch of its proof. For more details about the proof, we refer to the Appendix.

The correctness of the protocol is guaranteed by the error verification protocol which is parameterized by the required correctness [formula].

Main Result. The protocol with parameters [formula] is [formula]-secret if

[formula]

for [formula] and [formula], where [formula] denotes the binary entropy function, [formula] and [formula], with the statistical deviations given by

[formula]

Proof sketch. Conditioned on passing all the tests in the parameter estimation step, let XA be the random variable of length mx that Alice gets from X and let E' denote Eve's information about XA at the end of the error correction and error verification protocols.

We use the following result from [\cite=RennerThesis]. By using privacy amplification with two-universal hashing, a Δ-secret key of length [formula] can be generated from XA with

[formula]

for any ε  >  0. Here [formula] denotes the smooth min-entropy [\cite=RennerThesis]. It therefore suffices to bound this entropy in terms of the tolerated values ([formula], [formula] and [formula]).

First, using chain rules for smooth entropies [\cite=RennerThesis], we get [formula], where E denotes Eve's information after the parameter estimation step. Then, from the generalised entropic uncertainty relation [\cite=esther11], we further get

[formula]

where c* is the effective overlap of Alice's measurements (a function of the measurements corresponding to settings [formula] and the marginal state). Here, ZA can be seen as the bit string Alice would have obtained if she had chosen setting [formula] instead. Likewise, ZB represents the bit string obtained by Bob with setting [formula]. From Ref. [\cite=Tomamichel2012a], the smooth max-entropy of the alternative measurement is bounded by the error rate sampled on the set Z of size mz, [formula], where μ is the statistical deviation due to random sampling theory, i.e., with high probability, the error rate between ZA and ZB is smaller than [formula].

It remains to bound the effective overlap c* with [formula] and [formula]. First, we note that [formula] is independent of Charlie's outputs and X  ⊆   with equality only if Charlie always outputs a pass. Furthermore, X is not necessarily a random subset of [formula] as a malicious Charlie can control the content of X (this is discussed later). Assuming the worst case scenario, it can be shown that [formula] where η = |X| / || is the efficiency of Charlie's operation and * is the effective overlap of [formula]. Next, by establishing a relation between the effective overlap and the local CHSH test [\cite=esther11] (for completeness, we provide a more concise proof in Lemma [\ref=lem:chsh_c] in the Appendix) and using random sampling theory, we further obtain

[formula]

Here ξ quantifies the statistical deviation between the expected CHSH value and the observed CHSH value, and ζ quantifies the statistical deviation between the effective overlaps of [formula] and J, respectively.

Putting everything together, we obtain the secret key length as stated by Eq. ([\ref=eqn1]).

Asymptotic limit. In the following, we consider the secret fraction defined as [formula] [\cite=Gisin2002]. In the asymptotic limit N  →    ∞   and using [formula] (corresponding to the Shannon limit), it is easy to verify that the secret fraction reaches

[formula]

The expression reveals the roles of the modes of operation [formula] and [formula]. The first provides a bound on the quality of the devices (which is taken into account by the log 2 term) and the latter, apart from generating the actual key, is a measure for the quality of the quantum channel.

Discussion

We have proposed a DIQKD protocol which provides security even if the losses of the channel connecting Alice and Bob would not allow for a detection-loophole free Bell test. Nevertheless, the security of the protocol still depends on the losses and the protocol therefore needs to perform a check to ensure that Charlie does not output a fail too often. This dependence from the failure probability arises from the fact that a malicious Charlie may choose to output a pass only when Alice and Bob's devices behave badly. Therefore, the CHSH value calculated from Alice's CHSH sample is not a reliable estimate for the overlap of the sample used to generate the key string. However, with the CHSH test, Alice can estimate how often her devices behave badly and thus determine the minimum tolerated efficiency (or the maximum tolerated failure probability) of Charlie. This is illustrated in Fig. [\ref=Fig2] where large values of [formula] are required to tolerate small values of [formula].

Taking the asymptotic limit and the maximal CHSH value, we see that the secret fraction is independent of [formula], which is not so surprising since the maximal CHSH value implies that the devices of Alice are behaving ideally all the time. Remarkably, we recover the asymptotic secret fraction for the BB84 protocol [\cite=SP00].

From a practical point of view, the possibility to consider very small values of [formula] is certainly appealing, since it suggests that the distance between Alice and Bob can be made very large. A quick calculation using the best experimental values [\cite=ExpMDIQKD] (i.e., [formula] and [formula] where t is the channel transmission) shows that the secret fraction is positive for t  >  0.45. This translates to about a 17km optical fiber between Alice and Bob. Accordingly, to achieve larger distances, we would need a local CHSH test that generates violations larger than those achieved by current experiments.

Conclusion

In summary, we provide an alternative approach towards DIQKD, where the Bell test is not carried out between Alice and Bob but rather in Alice's laboratory. On a conceptual level, our approach departs from the general belief that the observation of a Bell violation between Alice and Bob is necessary for DIQKD. On the practical side, it offers the possibility to replace the extremely challenging task of implementing a long distance detection-loophole free Bell test with a less challenging task, i.e., implementing a local detection-loophole free Bell test. In fact, recently, there has been very encouraging progress towards the implementation of a local detection-loophole free CHSH test [\cite=Giustina2013]. In view of that, we believe an experimental demonstration of DIQKD with local Bell tests is plausible in the near future.

Acknowledgments. We thank Jean-Daniel Bancal, Marcos Curty, Esther Hänggi, Stefano Pironio, Nicolas Sangouard, Valerio Scarani and Hugo Zbinden for helpful discussions. We acknowledge support from the National Centre of Competence in Research QSIT, the Swiss NanoTera project QCRYPT, the Swiss National Science Foundation SNSF (grant No. 200020-135048), the CHIST-ERA project DIQIP, the FP7 Marie-Curie IAAP QCERT project and the European Research Council (grant No. 258932 and No. 227656).

Appendix: D

We present the proof for the main result given in the main text. First, we discuss about the assumptions and then introduce the necessary technical lemmas. Second, we establish a relation between the local CHSH test and a generalized version of smooth entropic uncertainty relation (Lemma [\ref=lem:chsh_c]). Third, we provide the required statistical statements for estimating certain quantities of the bit strings of Alice and Bob. Finally, we state our main result (Theorem [\ref=securitythm]) which is slightly more general than the main result presented above.

Notations

We assume that all Hilbert spaces denoted by [formula], are finite-dimensional. For composite systems, we define the tensor product of [formula] and [formula] as [formula]. We denote [formula] as the set of positive semi-definite operators on [formula] and [formula] as the set of normalised states on [formula], i.e., [formula]. Furthermore, for a composite state [formula], the reduced states of system A and system B are given by [formula] and [formula], respectively. A positive operator valued measure (POVM) is denoted by [formula] where [formula]. For any POVM, we may view it as a projective measurement by introducing an ancillary system, thus for any POVM with binary outcomes, we may write it as an observable [formula], such that [formula]. We also use [formula] to represent the concatenations of elements and

[formula]

Basic assumptions on Alice's and Bob's abilities

Prior to stating the security proof, it is instructive to elucidate the basic assumptions necessary for the security proof. In particular, the assumptions are detailed in the following:

Trusted local sources of randomness. Alice (also Bob) has access to a trusted source that produces a random and secure bit value upon each use. Furthermore, we assume the source is unlimited, that is, Alice can use it as much as she wants, however the protocol only requires an amount of randomness linear in the number of quantum states generated.

An authenticated but otherwise insecure classical channel. Generally, this assumption is satisfied if Alice and Bob share an initial short secret key [\cite=WC81] [\cite=Stinson94]. Note that the security analysis of such authentication schemes was recently extended to the universally composable framework [\cite=RennerThesis] [\cite=MullerQuadeRenner] in Ref [\cite=Portmann2012], which allows one to compose the error of the authentication scheme with the errors of the protocol, giving an overall error on the security.

No information leaves the laboratories unless the protocol allows it. This assumption is paramount to any cryptographic protocol. It states that information generated by the legitimate users is appropriately controlled. More concretely, we assume the followings

Communication lines.-- The only two communication lines leaving the laboratory are the classical and the quantum channel. Furthermore, the classical channel is controlled, i.e., only the information required by the protocol is sent.

Communication between devices.-- There should be no unauthorized communication between any devices in the laboratory, in particular from the measurement devices to the source device.

Trusted classical operations. Classical operations like authentication, error correction, error verification, privacy amplification, etc must be trusted, i.e., we know that the operations have ideal functionality and are independent of the adversary.

Measurement and source devices are causally independent. This means each use of the device is independent of the previous uses. For example, for N uses of a source device and a measurement that produces a bit string [formula], we have

[formula]

where Mx̄ is the POVM element corresponding to the outcome x̄.

Technical lemmas

Let O and [formula] be observables with eigenvalues ±  1 on Hilbert space [formula]. Then there exists a partition of the Hilbert space, [formula], such that

[formula]

where [formula] satisfies [formula] for all i.

Let [formula] be the average of n independent random variables [formula] with values in

[formula]

Let [formula] be a list of (not necessarily distinct) values in

[formula]

Let [formula] be a list of (not necessarily distinct) values in

[formula]

Since T is a random sample of X, from Lemma [\ref=lem:serfling], we have

[formula]

Using [formula] we finish the proof.

The main ingredient is a fine-grained entropic uncertainty relation (see [\cite=Tomamichel2012thesis] and [\cite=esther11]).

Let ε > 0,  ≥  0 and [formula]. Moreover let [formula], [formula] be POVMs on [formula], and [formula] a projective measurement on [formula] that commutes with both [formula] and [formula]. Then the post-measurement states [formula], [formula] satisfy

[formula]

where the effective overlap is defined as

[formula]

Note that ([\ref=eq:ucr]) is a statement about the entropies of the post-measurement states ρXB and ρZC, thus it also holds for any measurements that lead to the same post-measurement states. Accordingly, one may also consider the projective purifications [formula] and [formula] of [formula] and [formula], applied to [formula], where [formula] is a pure state of an ancillary system. Since both measurement setups [formula] and [formula] give the same post-measurement states, the R.H.S of ([\ref=eq:ucr]) holds for both [formula] and [formula]. We can thus restrict our considerations to projective measurements.

In the protocol considered, Alice performs independent binary measurements -- [formula] and [formula] -- on each subsystem i. We can reduce [\eqref=eq:effective] to operations on each subsystem, if we choose [formula] to also be in product form, i.e., [formula], where k̄ is a string of (not necessarily binary) letters ki∈K. Then plugging this, [formula] and [formula] in the norm from [\eqref=eq:effective], we get

[formula]

Putting this in [\eqref=eq:effective] with [formula], [formula], and dropping the subscript i when possible, we obtain,

[formula]

In the following we will refer to

[formula]

as the overlap of the measurements {Mix}x and {Niz}z.

An upper bound on the effective overlap with the CHSH value

In this section, we first introduce the notion of CHSH operator [\cite=BelloperatorRefs] and then prove the relation between the CHSH test and the effective overlap ([\ref=eq:effective.decomposition]).

In the CHSH test, two space-like separated systems share a bipartite state ρ and each system has two measurements. More specifically, system A has POVMs {M00,M01} and {M10,M11} and system T has POVMs {T00,T01} and {T10,T11}. Since for any POVM there is a (unitary and) projective measurement on a larger Hilbert space that has the same statistics, we can restrict our considerations to projective measurements. Then, we may write the POVMs as observables with [formula] outcomes, i.e., at the site of the first system, the two observables are [formula] and [formula]. Furthermore, the measurements are chosen uniformly at random. As such, the CHSH value is given by [formula] where the CHSH operator is defined as

[formula]

where u,v and s,t are the inputs and outputs, respectively. The maximization of S(ρ,β) over the set of density operators for a fixed β is defined by [formula]. Moreover, the CHSH operator can be decomposed into a direct sum of two-qubits subspaces via Lemma [\ref=lem:jordan]. Mathematically, we may write [formula] and [formula] where {Pk}k is a set of projectors such that [formula]. Note that in Lemma [\ref=lem:jordan], one may select a partition of the Hilbert space such that each block partition has dimension two. This allows one to decompose the general CHSH operator into direct sums of qubits CHSH operators. Likewise, for the measurements of Bob, [formula] and [formula]. For all k, PkO0APk and PkO1APk can be written in terms of Pauli operators,

[formula]

where [formula] and [formula] are unit vectors in [formula] and Γk is the Pauli vector. Combining [\eqref=CHSH:op] and [\eqref=CHSH:block] yields

[formula]

and it can be verified that

[formula]

where

[formula]

Whenever the context is clear, we write S = S(ρ,β) and [formula].

In the following analysis, we consider only one subsystem, the superscript i is omitted, i.e., we use [formula] instead.

Let {OxA}x∈{0,1} and {OyT}y∈{0,1} be observables with eigenvalues ±  1 on [formula] and [formula] respectively and let [formula] be the CHSH operator. Then for any [formula], the effective overlap c* is related to the CHSH value [formula] by

[formula]

Using [\eqref=CHSH:block], let the relative angle between [formula] and [formula] be θk∈[0,π  /  2] for all k, i.e., [formula]. Furthermore, we can express [formula] and [formula] in terms of rank-1 projectors. Formally, we have [formula] and similarly for [formula]. Plugging these into ([\ref=eq:effective.decomposition]),

[formula]

Next, we want to relate ck to the CHSH value. Using the result of Seevinck and Uffink [\cite=seevinck2007], for all r, ([\ref=CHSH:w_kr]) satisfies

[formula]

where sin (θk) and sin (θr) quantify the commutativity of Alice's kth and system T's rth measurements, respectively. From ([\ref=lem:c_k_theta]) and ([\ref=CHSH:Seev]) we obtain for all r,

[formula]

where we use the fact that the right hand side is a monotonic decreasing function. Finally, we get

[formula]

and the inequality is given by the Jensen's inequality and ([\ref=decom:CHSH]).

Statistics and efficiency of Charlie's operation

We recall in the protocol description, after the sifting step, Alice and Bob identify sets X,Z and J. Also, they have [formula] where || corresponds to the total number of times Alice chooses sub-protocol [formula], and both Alice and Bob choose setting [formula].

Part of the goal is to estimate the average overlap of set X with the observed CHSH values (evaluated on sets J) and the efficiency of Charlie's operation η. Note that η = |X| / ||. To do that, we need the following two lemmas: the first (Lemma [\ref=lem:statistics.cstar]) gives a bound on the average effective overlap of X in terms of the average effective overlap of [formula] and the efficiency of Charlie's operation η, and the second (Lemma [\ref=lem:statistics.chsh]) gives a bound on the probability that the observed CHSH value is larger than the expected CHSH value.

Let [formula] and [formula] be the average effective overlaps of X and [formula], respectively, and let η: = |X| / ||. Then

[formula]

First, we note that X  ⊆   with equality only if Charlie always outputs a pass (or has perfect efficiency). Next, we consider {c* ,i}i∈ in decreasing order, that is, [formula]. Accordingly, the average overlap of [formula] can be written as

[formula]

where we consider that X collects the large effective overlaps, and the inequality is given by c* ,i  ≥  1 / 2. Finally, let η = |X| / ||.

Let SJ be the average CHSH value on mj independent systems, and [formula] the observed CHSH on these systems. Then

[formula]

We define the random variable

[formula]

where ui,vi,si,ti are the inputs and outputs, respectively of the measurements on system i, and [formula]. It is easy to see that [formula], [formula] and [formula]. The proof is then immediate from Lemma [\ref=lem:chernoff].

Secrecy analysis

With the relevant results in hand, we are ready to prove our main result which roughly follows the same line of argument as Ref. [\cite=Tomamichel2012a]. The main differences are the use of a more general smooth entropic uncertainty relation (Lemma [\ref=thm:ucr]) to bound the error on the secrecy, and the CHSH test to bound the effective overlap of the measurement operators and states used by the uncertainty relation (Lemma [\ref=lem:chsh_c]). Since the players can only sample the CHSH violation, we use Lemma [\ref=lem:statistics.cstar] to bound the distance between this estimate and the expected effective overlap of the key set. The correctness of the protocol are evaluated in exactly the same way as in Ref [\cite=Tomamichel2012a], so we refer to that work for the corresponding bounds and theorems. We only prove the secrecy of the protocol here.

Contrary to most QKD protocols, the protocol adopts a tripartite model where Charlie is supposed to establish entanglement between Alice and Bob. Thus in our picture, we can view Charlie as an accomplice of the adversary and evaluate the secrecy on the overall state conditioned on the events where Charlie outputs a pass.

We briefly recall the main parameters of the protocol, which are detailed in the protocol definition given in the paper. Conditioned on the successful operation of Charlie (the events whereby Charlie outputs a pass), Alice and Bob generate systems until at least mx of them have been measured by both of them in the basis [formula], mz have been measured in the basis [formula], and j have been chosen for both CHSH tests. The tolerated error rate and the CHSH value are [formula] and [formula], respectively.

Furthermore, we take that our information reconciliation scheme leaks at most [formula]-bits of information, where an error correction scheme which leaks at most [formula]-bits of information is applied [\cite=RennerThesis], then an error verification scheme using two-universal hashing which leaks [formula]-bits of information is applied. If the error verification fails, they abort the protocol.

The protocol is [formula]-secret if for some [formula] such that [formula], the final secret key length [formula] satisfies

[formula]

where [formula] and [formula] with the statistical deviations given by

[formula]

[formula]

and

[formula]

Let Ω be the event that [formula] and [formula] and [formula]. If Ω fails to occur, then the protocol aborts, and the secrecy error is trivially zero. Conditioned on passing these tests, let X be the random variable on strings of length mx that Alice gets from the set X, and let E denote the adversary's information obtained by eavesdropping on the quantum channel. After listening to the error correction and hash value, Eve has a new system E'. Using [formula] (the number bits used for error correction and error verification) and using chain rules for smooth entropies [\cite=RennerThesis] we bound the min-entropy of the X given E'

[formula]

From the entropic uncertainty relation (Lemma [\ref=thm:ucr]), we further get

[formula]

where Z can be seen as the outcome Alice would have gotten if she had measured the same systems in the corresponding basis [formula], and B is Bob's system in this case (before measurement).

The max-entropy of the alternative measurement is then bounded by the error rate sampled on the mz systems Z [\cite=Tomamichel2012a]:

[formula]

where [formula] and pΩ: =  Pr [null].

Next, we bound c* (evaluated on Alice's devices from X) in terms of the observed CHSH value [formula]. We first use the arithmetic-geometric mean's inequality, from which we get

[formula]

where c*X is the average effective overlap on X. Using Lemma. [\ref=lem:statistics.cstar], we get

[formula]

Since [formula] is randomly chosen by Alice and is independent of Charlie, [formula] can be estimated from c*J, i.e., we apply Corollary [\ref=Cor:serfling] to further obtain Pr [null]  ≤  εc*, hence

[formula]

Lemma [\ref=lem:chsh_c] can now be used together with Jensen's inequality, so with probability at least 1 - ε',

[formula]

We still need to take into account that we only have an approximation for the CHSH value of the systems in J. From Lemma [\ref=lem:statistics.chsh] we get that

[formula]

Finally, the bound on the error of privacy amplification by universal hashing [\cite=RennerThesis] says that the error is less than [formula] as long as

[formula]

Putting all the above equations together we get ([\ref=eq:securitythm]), with a total error conditioned on the event Ω of at most [formula]. If we remove this conditioning, the error is then

[formula]