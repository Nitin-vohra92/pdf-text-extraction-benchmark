N-representability is QMA-complete

The central theoretical problem in the field of many-body strongly correlated quantum systems is to find efficient ways of simulating Schrödinger's equations: it is very easy to write down those equations, but notoriously difficult to solve them or even to find approximate solutions. The main difficulty is the fact that the dimension of the Hilbert space describing a system of N quantum particles scales exponentially in N. This makes a direct numerical simulation intractable: every time an extra particle is added to the system, the computational resources would have to be doubled.

The situation is not hopeless, however, as in principle it could be that all physical wavefunctions, i.e., the ones that are realized in nature, have very special properties and can be parameterized in an efficient way. The idea would then be to propose a variational class of wavefunctions that capture the physics of the systems of interest, and then do an optimization over this restricted class. This approach has proven to be very successful, as witnessed by mean field theory and renormalization group methods. So far, an efficient variational class to describe complex wavefunctions such as those arising in quantum chemistry has not been found.

One of the basic problems in quantum chemistry is to find the ground state of a Hamiltonian describing the many-body system of an atom or molecule. The essential element that makes typical Hamiltonians very ungeneric is the fact that at most 2-body interactions occur. This implies that the number of free parameters in such Hamiltonians scales at most quadratically in the number of particles or modes, and hence the ground states of all such systems form a small-dimensional manifold.

In the case of a Hamiltonian with only 2-body interactions, the energy corresponding to a wavefunction is completely determined by its 2-body correlation functions, and as a consequence the ground state will be the one with extremal 2-body reduced density operators. This fact was realized a long time ago, and led Coulson [\cite=Coulson] to propose the following problem: given a set of N quantum particles, can we characterize the allowed sets of 2-body correlations or density operators between all pairs of particles?

If the particles under consideration are fermions, this has been called the N-representability problem [\cite=Coleman]. Here, we consider the reduced density operators acting on pairs of fermions, and we want to decide whether they are consistent with some global state over N fermions. An efficient solution to the N-representability problem would be a huge breakthrough, as it would (for example) allow us to calculate the binding energies of all molecules. Therefore, a very large effort has been devoted to solving this problem and there exists a large literature on this subject (see e.g. [\cite=book1] [\cite=book] [\cite=Mazziotti]).

Here we will show that the N-representability problem is intractable, as it is QMA-complete and hence NP-hard. The complexity class QMA (Quantum Merlin-Arthur) is the natural generalization of the class NP (nondeterministic polynomial time) to the setting of quantum computing. Colloquially, a problem is in QMA if there exists an efficient quantum algorithm that, when given a possible solution to the problem, can verify whether it is correct; here the "solution" may be a quantum state on polynomially many qubits . A problem is QMA-hard if it is at least as hard as any other problem in QMA; that is, given an efficient algorithm for this problem, one could solve every other problem in QMA efficiently . We say that a problem is QMA-complete if it is in QMA and it is also QMA-hard.

In a seminal work, Kitaev [\cite=Kitaev] proved that the Local Hamiltonian problem--determining the ground state energy of a spin Hamiltonian that is a sum of 5-body terms (on n qubits), with accuracy ±  ε where ε is inverse polynomial in n--is QMA-complete. In fact, it was later shown that this problem remains QMA-complete when restricted to 2-body interactions [\cite=Kempe1] [\cite=Kempe2], and even in the case of geometrically local interactions [\cite=Terhal].

Because the Hamiltonians under consideration are local, the corresponding ground states have extremal local properties. The dual problem of determining the ground state energy of a local Hamiltonian is to decide whether a given set of local density operators can be realized as the reduced density operators of the same global state. Checking the consistency of such a set of local density operators ρ(ij), i.e., checking whether there exists a global state σ compatible with those local density operators, is a QMA-complete problem itself [\cite=Yi-Kai]. In the present paper, we will use very similar techniques to prove that N-representability, which is the fermionic version of that problem, is also QMA-complete.

To sketch the main ideas of the proof, we will first consider the classical marginal problem: suppose we have N random variables that can take the values ±  1, according to some joint probability distribution, and we define the 2-variable marginal distributions

[formula]

Given a set of marginal probability distributions, we would like to check whether they are consistent, i.e., whether there exists a global probability distribution whose marginals are equal to the ones we were given.

Suppose that there exists an efficient algorithm (whose running time is polynomial in N) to solve this problem. Then it would be possible to identify ground states of all Ising spin glasses. The strategy would be as follows: since the set of consistent marginals is convex and the energy is a linear function of the marginals, the problem amounts to minimizing a linear function subject to a set of convex constraints that can be checked in polynomial time. This can be done in polynomial time using the ellipsoid method [\cite=GLS]. It therefore follows that an efficient algorithm for checking consistency allows to find ground states of Ising spin glasses, a problem that is known to be NP-hard [\cite=Barahona]. Hence the problem of determining whether a set of binary marginals is consistent is itself NP-hard.

Let us now formulate the N-representability problem in the context of quantum chemistry. Electrons and nuclei tend to arrange themselves such as to minimize their energy, and the binding energy of a molecule can be determined by calculating the minimal energy of the corresponding Hamiltonian. In practice, the nuclei are fairly well localized and can be treated as classical degrees of freedom, and the wavefunction of the N electrons can be approximated as a linear combination of tensor products of the d single-particle modes in the system (those form the basis set).

As electrons are fermionic, the complete wavefunction must be antisymmetric, and this is most easily taken into account by working in the formalism of second quantization:

[formula]

Here [formula] is the creation operator for the j'th mode, and |Ω〉 represents the vacuum state without fermions. The creation and annihilation operators obey the following anticommutation relations:

[formula]

Note that we restrict ourselves to the subspace of states with exactly N fermions. d denotes the number of modes, which is typically much larger than N. The number of degrees of freedom is [formula], which grows exponentially in N when d  ≥  cN for some constant c > 1.

In the case of quantum chemistry, the Hamiltonian typically contains only one- and two-body interactions between all modes, and so it can be written as a linear combination of terms of the form [formula] and [formula].

The 2-fermion reduced density matrix (2-RDM) is calculated by tracing out all but two of the fermions:

[formula]

where ρ(N) is a mixture of states |ψ〉 with exactly N fermions. In the language of second quantization, the matrix elements of the 2-RDM are given by:

[formula]

The N-representability problem (with d modes) can now be stated as follows. Consider a system of N fermions and d modes, [formula]. (For purposes of complexity, we consider N to be the "size" of the problem.) We are given a 2-fermion density matrix ρ, of size [formula], where each entry is specified with [formula] bits of precision. In addition, we are given a real number [formula], specified with [formula] bits of precision. The problem is to distinguish between the following two cases:

There exists an N-fermion state σ such that [formula]. In this case, answer "YES."

For all N-fermion states σ, [formula]. In this case, answer "NO."

If neither of these cases applies, then one may answer either "YES" or "NO." Note that we do not insist on solving the problem exactly; we allow an error tolerance of [formula]. We use the [formula] matrix norm or trace distance, [formula], to measure the distance between σ and ρ.

We will show that N-representability is QMA-complete. The proof consists of two parts. First, we show that any 2-local Hamiltonian of spins can be simulated using a 2-local Hamiltonian of fermions with d = 2N. Using techniques of convex programming, we show that an oracle for N-representability would allow us to estimate the ground state energies of 2-local Hamiltonians; thus, N-representability is QMA-hard.

Second, we show that N-representability is in QMA; specifically, we construct a quantum verifier that can check whether a 2-particle state is N-representable, given a suitable witness.

Let us first show how to map a 2-local Hamiltonian, defined on a system of N qubits, to a 2-local Hamiltonian on fermions, with d  =  2N modes; this is the opposite of what has been done in [\cite=VC]. The idea is to represent each qubit i as a single fermion that can be in two different modes ai,bi; so each N-qubit basis state corresponds to the following N-fermion state:

[formula]

Also, all the relevant single-qubit operators should correspond to bilinear functions of the creation and annihilation operators (this construction guarantees that operators on different qubits commute). This can be achieved by the following mapping:

[formula]

It can easily be checked that these fermionic operators obey the Pauli commutation relations within the subspace spanned by states of the form ([\ref=map0]).

Recall that the qubit Hamiltonian can be written as a linear combination of Pauli operators. So the fermionic Hamiltonian can now be created by rewriting these Pauli operators with respect to the above mapping (note that only bilinear terms occur, and hence operators on different sites commute). Notice that if the qubit Hamiltonian only contains 2-body terms, then the fermionic Hamiltonian will only contain terms with at most 2 annihilation and 2 creation operators.

The only thing that is left to do is to guarantee that there is exactly one fermion on every site i. This can be achieved by adding the following projectors as extra terms in the fermionic Hamiltonian:

[formula]

All the Pi are biquadratic and commute with all the operators introduced in ([\ref=map]), and hence the complete Hamiltonian will be block diagonal. By making the weights of these projectors large enough (a constant times the norm of the Hamiltonian, which is at most polynomial in N), we can always guarantee that the ground state of the full Hamiltonian will have exactly one fermion per site .

Let us now assume that we have an efficient algorithm for N-representability. We claim that this allows us to efficiently determine the ground state energy of a 2-local Hamiltonian on qubits, a problem which is known to be QMA-hard [\cite=Kempe2]. We start by transforming the Hamiltonian [formula] on N qubits with 2-particle interactions into a Hamiltonian [formula] on d = 2N fermionic modes with 2-particle interactions (as described above). The problem of finding the ground state energy of [formula] can be expressed as a convex program, which can be solved in polynomial time using an oracle for N-representability (this is what we will show below). Our approach is similar to [\cite=Yi-Kai], though in this case we are dealing with fermions rather than qubits.

The basic idea is to construct a convex program that finds a 2-particle density matrix ρ which is N-representable, and which minimizes the expectation value of [formula]. This program has polynomially many variables, and it is easy to see that the set of N-representable states is convex, and [formula] is a linear function of ρ.

There are two minor complications. First, [formula] describes a system with 2N modes and an arbitrary number of particles, whereas N-representability pertains to a system with exactly N particles. But this is not a problem, because the interesting behavior in [formula] occurs in a subspace where all the states have exactly N particles. So, in our convex program, we only need to consider states ρ that have exactly N particles.

This lets us simplify [formula] as follows. Since we are only interested in how it acts on N-particle states, we can write [formula]. So we can assume that all the terms in [formula] are of the form [formula].

Second, convex optimization algorithms usually require that the set K of feasible solutions be full-dimensional, i.e., K cannot lie in a lower-dimensional subspace. So we have to represent the state ρ in such a way that there are no redundant variables.

Let S be a complete set of 2-particle observables , and let [formula]; note that [formula]. We represent ρ in terms of its expectation values [formula] for all S∈S; let [formula] denote the vector of these expectation values. We define K to be the set of all [formula] such that the corresponding state ρ is N-representable. Note that the N-representability oracle allows us to test whether a given point [formula] is in K.

We write our Hamiltonian in the form [formula] (plus a constant term); the coefficients γS can be computed using the Gram-Schmidt procedure. It is easy to see that [formula]. Our convex program is as follows: find some [formula] that minimizes [formula].

We can solve this convex program in polynomial time, using the shallow-cut ellipsoid algorithm (see [\cite=GLS], and references cited therein). We mention a few technical details. The algorithm requires some additional information about K, namely a guarantee that K is contained in a ball of radius R centered at 0, and K contains a ball of radius r centered at some point p. (Also, the running time of the algorithm grows polynomially in log (R / r).) In our case, we can set [formula], and [formula] .

There is also the issue of numerical precision. Our oracle for N-representability has limited accuracy--it may give incorrect answers for points near the boundary of K. On the other hand, we only need an approximate solution to the convex program, in order to solve the Local Hamiltonian problem. It turns out that [formula] precision is sufficient. The ellipsoid algorithm still works in this setting; see [\cite=GLS] for details.

Note that, in place of the ellipsoid algorithm, we could have used a different algorithm based on random walks in convex bodies [\cite=BV]; this was the approach used in [\cite=Yi-Kai]. However, it is not clear if we could use one of the interior-point methods for convex optimization; these methods are substantially faster, but they usually require an explicit description of the constraints, not just a membership oracle.

This completes the proof that N-representability is QMA-hard. As a corollary, we have also proven that estimating the ground state energy for local fermionic Hamiltonians is QMA-hard. Note that the use of the ellipsoid algorithm to reduce a convex optimization problem to a convex membership problem is not new; see [\cite=GLS] for references to related work.

Next, we show that N-representability is in QMA. That is, we construct a poly-time quantum verifier V that takes two inputs: a description of the problem (that is, ρ and β); and a "witness" τ, which is a quantum state on polynomially many qubits. The verifier V should have the following property: if ρ is N-representable, there exists a witness τ that causes V to output "true" with probability ≥  p1; if ρ is not N-representable (within error tolerance β), then for all possible states τ, V outputs "true" with probability ≤  p0; and [formula].

The idea is that, when ρ is N-representable, the correct witness τ consists of (multiple copies of) an N-fermion state σ that satisfies [formula]. Then the verifier can use quantum state tomography to compare σ and ρ.

We represent the N-fermion state σ using d qubits, via the following mapping:

[formula]

Call the resulting qubit state σ̃. We use the Jordan-Wigner transform to map the fermionic annihilation operators to qubit operators:

[formula]

Thus, an observable [formula] is transformed into [formula], which is a tensor product of many single-qubit observables and one four-qubit observable.

We claim that the expectation value 〈Õ〉 can be estimated efficiently. Without loss of generality, assume that the eigenvalues of Õ lie in the interval

[formula]