Note on the number of proper colorings of a graph

Martin Klazar Department of Applied Mathematics and Institute for Theoretical Computer Science (ITI) Faculty of Mathematics and Physics, Charles University Malostranské nám estí 25, 118 00 Praha Czech Republic klazar at kam.mff.cuni.cz

Using a counting argument called Turán sieve (with motivation in number theory), Liu and Murty proved in [\cite=liu_murt] an inequality on the number of proper vertex colorings, by λ colors, of a simple graph G = (V,E) with v = |V| vertices and e = |E| edges:

[formula]

This note presents a more direct combinatorial argument that gives a slightly stronger inequality.

Theorem. If [formula] is a simple graph with v  ≥  1 vertices and e = |E|  ≥  0 edges and λ  ≥  1 is the number of colors, then

[formula]

Proof. For e = 0 the inequality holds and so does for λ = 1 (for λ = 1 and e = 0 we interpret 0 / 0 as 1), and we assume that λ  ≥  2 and e  ≥  1. Let L, |L| = λ, be the set of colors, C be the set of colorings of V by colors from L, and Cp  ⊂  C be the colorings which are proper (i.e., have no monochromatic edge). We shall construct an injection

[formula]

with the property that for every coloring [formula] there are at most λ - 1 colors c such that (c,g) is in the image Im(I) of I. Then we must have

[formula]

and the inequality follows.

For every subset X  ⊂  V, fix a spanning forest FX of the graph GX induced by G on X (i.e., fix a spanning tree in every component of GX). Now for (h,f)∈E  ×  Cp, where h = {u,w} with u < w and f(u) = d  ≠  f(w) = c, consider the set Y  ⊂  V of vertices having in f color d or c. In the spanning forest FY, u and w lie in the same component K and K contains a unique path P joining u and w. Recolor the vertices of K by c and d so that all vertices of P are colored with d and the only monochromatic edges in E(K) (and hence in E(FY)) are those of P; there is exactly one such coloring of K (since K is a tree). Define g∈C as given by this recoloring on K and as coinciding with f elsewhere. Set I((h,f)) = (c,g); recall that c is the color lost on P by the recoloring. Clearly, [formula]. Note that the only bad colors in g--colors appearing on some edge in E monochromatic in g--are d (because of the edges in P) and possibly c (the recoloring may have created some edges monochromatic in the color c but these must lie in [formula]). The membership (c,g)∈Im(I) imposes on (c,g) further restrictions which we discuss in a moment.

We have to verify the injectivity of I and the property of its image. Let [formula] be given. We describe how to reconstruct uniquely (h,f) from (c,g) = I((h,f)). First, set [formula] where B is the set of colors bad in g. As we mentioned, necessarily |B'| = 2. Thus Y is uniquely reconstructed as Y = g- 1(B'). The color d∈B', d  ≠  c, is the only color that is bad in g with respect to the edges in E(FY) and, moreover, the monochromatic edges in E(FY) form a path P with endvertices u < w that must be adjacent (this is forced by (c,g)∈Im(I)). Thus the edge h is uniquely reconstructed as {u,w}. If we modify g on the component K of FY containing P so that K is properly colored with c and d but u retains its color d (such a coloring of K is unique), the resulting coloring is necessarily proper with respect to all edges in E (else (c,g) could not be in Im(I)) and f must be equal to it. Hence we have reconstructed (h,f). This shows that I is an injection.

Finally, let (c,g)∈Im(I) and B be the set of bad colors in g. If |B| = 1, then [formula] and for fixed g we have at most λ - 1 possibilities for c. If |B| = 2, then c∈B and is uniquely determined (must be distinct from the color in B that is bad in g with respect to the edges in E(FY) where Y = g- 1(B)) and there are again at most λ - 1 possibilities for c when g is fixed.

Closing remarks. Stronger result was obtained long ago by Lazebnik in [\cite=laze]:

[formula]

where

[formula]

The last third term in the minimum is identical with the one obtained here. I could not check [\cite=laze] to see if the above argument based on an injective mapping, which still may be of some interest, is subsumed in the proofs of [\cite=laze]. For further strengthening and references on the problem to bound the number of proper colorings, see Byer [\cite=byer].