Corollary Definition Proposition Example Lemma Remark

SOME IDENTITIES AND FORMULAS INVOLVING GENERALIZED CATALAN NUMBERS

Siu-Ah Ng

Key words: Catalan numbers, paths, generating functions

Introduction

By a path, we mean a finite sequence {ai}0  ≤  i  ≤  n where [formula] and either ai + 1 = ai + (1,0) or ai + 1 = ai + (0,1). That is to say, a walk from a0 to an whose steps consist of horizontal or vertical positive unit movements.

The classical Catalan number is the number of paths from the origin to (n,n) without crossing the diagonal. It is given by [formula] and has many well-known interpretations (Cf [\cite=HP1]). In [\cite=Ng] we came across the following natural generalization:

Let   0  ≤  m  ≤  n.   The generalized Catalan number is defined as the number of paths from (0, - 2m) to (n - m,n - m) without crossing the line y = x and is denoted by   Cn,m.

For completeness, we give in § [\ref=catalang] a proof of [formula] The number   Cn,m   has an ancient history. In [\cite=B] Bertrand studied   an,m,   the number of paths from the origin to (n,m) without crossing the diagonal, as the number of solutions to the ballot problem. One verifies that [formula] (For another derivation, one can check that [formula] for the dqk defined in [\cite=HP2].)

We then move on to proving new identities and formulas.

In § [\ref=variations] we consider some variations of   Cn,m   and compute closed formulas for them. In § [\ref=identities] we derive some binomial identities by counting Catalan numbers and their variants. In § [\ref=recur] we obtain recursive relations for the generalized Catalan numbers, from which identities for the central binomial coefficients and an identity for certain sum of products of the generalized Catalan numbers are given. In the main section § [\ref=genfunction] we give a close formula for the multivariate generating function for the generalized Catalan numbers. In § [\ref=moreformulas] more formulas are produced, including certain product of the generating functions. We end in the final section § [\ref=det] with an elegant formula for the Catalan determinant.

Generalized Catalan numbers

For completeness, we give a direct derivation of a close formula for   Cn,m   although as remarked earlier it is already included in references such as [\cite=B] and [\cite=HP2].

Given integers   0  ≤  m  ≤  n,   we have

[formula]

Fix   0  ≤  m  ≤  n. We let   Λ   be the set of paths from   (0, - 2m)   to   (n - m,n - m)   and   Γ   be the subset of "bad" paths, i.e. those that cross the line   y = x.   So [formula]

Given a path   P∈Γ,   let k be smallest such that P crosses   y = x   at   (k,k),   i.e. both (k,k) and (k,k + 1) belong to P. Let Q be the path obtained from P by reflecting across the line y = x + 1 only the portion of P from   (0, - 2m)   to   (k,k + 1).   The result is a path from   ( - 2m - 1,1)   to   (n - m,n - m).   See Figure [\ref=fig1] above. This is simply the André's reflection method and one can easily see that it establishes a bijection between Γ and the set of paths from   ( - 2m - 1,1)   to   (n - m,n - m).   Therefore

[formula]

On the other hand,

[formula]

Hence

[formula]

and the conclusion follows by noticing that

[formula]

Bertrand's ballot problem: Suppose the final result of an election is such that party A gets 2m more votes than its opposition B, say A gets n + m and B gets n - m votes. What is the probability that A is at least 2m votes ahead of B in all partial counts throughout the whole process?

The probability of the event in the generalized ballot problem is [formula]

By shifting all paths 2m units up, it is clear that Cn,m is the number of paths from (0,0) to (n - m,n + m) without crossing y = x + 2m. Then identify each vote for party A with (0,1) and that for party B with (1,0).

The conclusion follows by noticing that each possible ballot outcome in the problem corresponds to a path from (0,0) to (n - m,n + m), hence there are [formula] of them in total, and those ballot outcome with A leading B by at least 2m votes corresponds to paths from (0,0) to (n - m,n + m) without crossing y = x + 2m.

Some variations

Superficially, the definition of   Cn,m   seems to be too restricted, since it considers only the even number 2m and allowing touching y = x. Here in this section we consider some variations and they can be computed in similar ways.

Let   0  ≤  m  ≤  n.

n,m  : =   the number of paths from (0, - 2m - 1) to (n - m,n - m) without crossing y = x.

Dn,m  : =   the number of paths from (0, - 2m) to (n - m,n - m) strictly below y = x until reaching (n - m,n - m).

n,m  : =   the number of paths from (0, - 2m - 1) to (n - m,n - m) strictly below y = x until reaching (n - m,n - m).

Suppose   0  ≤  m  ≤  n.   Then

[formula]

[formula]

[formula]

We first prove (2). Notice that a path P from the set defining Dn,m must pass (n - m,n - m - 1) before reaching (n - m,n - m). Similar to the proof of Theorem [\ref=catalan], P can be reflected across the line y = x to form a path Q from   ( - 2m,0)   to   (n - m,n - m - 1),   as shown in Figure [\ref=fig2].

We let   Λ   be the set of paths from   (0, - 2m)   to   (n - m,n - m - 1)   and   Γ   be the subset of "bad" paths, i.e. those that cross the line   y = x - 1.   Clearly, [formula] By the reflection trick used in the proof of Theorem [\ref=catalan], we can identify paths in   Γ   with paths from ( - 2m,0) to (n - m,n - m - 1). Therefore [formula]

So [formula]

To prove (1), by shifting 1 unit down, we can identify paths defining   n,m   with paths from (0, - 2m - 2) to (n - m,n - m) strictly below y = x until reaching (n - m,n - m). Therefore

[formula]

and the conclusion follows.

Now for (3), we notice that by shifting 1 unit up, paths defining   n,m   are identified with paths from (0, - 2m) to (n - m,n - m) without crossing y = x. Therefore   n,m    =    Cn,m.

Identities

In this section we derive some interesting identities which are corollaries of Theorem [\ref=catalan] or Theorem [\ref=catalanvariations].

[formula]

where   0    ≤    m    ≤  n - 1.

A "bad" path P from (0, - 2m) to (n - m,n - m), i.e. one that crosses y = x, is a path from (0, - 2m) to some (k,k), immediately before crossing y = x, then proceed to (k,k + 1) and takes any path to (n - m,n - m) as shown in Figure [\ref=fig3] below.

The number of paths from (0, - 2m) to (k,k)    =    ((m + k) - m,(m + k) - m) without crossing y = x is given by   Cm + k,m,   while the number of paths from (k,k + 1) to (n - m,n - m) is given by [formula] Hence the number of the "bad" paths are

[formula]

Since this number is also [formula] the conclusion follows from the last part of the proof of Theorem [\ref=catalan].

[formula]

where   1    ≤    m    ≤  n - 1.

Note that a path from (0, - 2m) to (n - m,n - m) without crossing the line y = x can be decomposed into a path from (0, - 2m) to the first touch at y = x, some (k,k),   0  ≤  k  ≤  n - m, followed by a path from (k,k), to (n - m,n - m) without crossing the line y = x, as shown in Figure [\ref=fig4] below.

The number of the former paths is Dk + m,m and the number for the latter is Cn - m - k,0,   therefore we have

[formula]

Hence, by Theorem [\ref=catalan] and Theorem [\ref=catalanvariations],

[formula]

and equation ([\ref=identityeq3]) follows.

It is easy to check that equation ([\ref=identityeq1]) can be transformed into the following form:

[formula]

Although equations ([\ref=identityeq3]) and ([\ref=identityeq11]) are similar, it is not clear how they are related.

[formula]

where   0    ≤    m    ≤  n - 1   and   1  ≤  k  ≤  2m.

The number of paths from (0, - 2m) to (n - m,n - m) is [formula] the right side of the above equation ([\ref=identityeq2]).

For each   1  ≤  k  ≤  2m   we can decompose these paths into the path from (0, - 2m) first touching the line y = x - 2m + k at (h,h - 2m + k), for some 0  ≤  h  ≤  n - m, followed by a path from (h,h - 2m + k) to (n - m,n - m), as shown in Figure [\ref=fig5] below.

The number of paths from (h,h - 2m + k) to (n - m,n - m) is [formula]

By shifting up   2m - k   units, we can see that a path from (0, - 2m) first touching the line y = x - 2m + k   at   (h,h - 2m + k)   corresponds to a path from (0, - k) first touching the line y = x   at   (h,h).   Therefore, if k is even, the number is given by

[formula]

if k is odd, the number is given by

[formula]

both producing the same number.

Summing the product [formula] over 0  ≤  h  ≤  n - m, equation ([\ref=identityeq2]) follows.

It appears that equation ([\ref=identityeq2]) actually holds for all   k > 0. The current proof doesn't seem to work for   k > 2m.

Recursive relations and identities

In this section we will derive two recursive relations for the generalized Catalan numbers. As corollaries, we obtain some identities for the central binomial coefficients. The first recursive relation for the generalized Catalan numbers we consider is the following.

For   0  ≤  m < n, we have the following recursive relation

[formula]

A path defining   Cn,m   is either a path touching the line   y = x   only once at the terminal point   (n - m,n - m)   (the number of such is given by   Dn,m   ) or a path touching some   (k,k),   where   0  ≤  k  ≤  n - m - 1   for the last time before hitting the terminal point   (n - m,n - m),   as shown in Figure [\ref=fig11].

Write   (k,k)   as ((k + m) - m,(k + m) - m),   we have

[formula]

But

[formula]

hence the result follows.

As a consequence, we have an identity for the nth central binomial coefficient.

Let   0  ≤  m < n, then

[formula]

By equation ([\ref=thm2eq]) in Theorem [\ref=reqthm2] we have:

[formula]

i.e.

[formula]

hence the result follows if m = 0; for m > 0, we get

[formula]

and equation ([\ref=cor1eq]) is proved.

The following is an identity to be used in § [\ref=moreformulas].

Let   1  ≤  m < n, then

[formula]

This is just another form of equation ([\ref=cor1eq]) in Corollary [\ref=cor1] by noticing that

[formula]

Now we consider another recursive relation for the generalized Catalan numbers.

Let   0  ≤  m  ≤  n. Then

[formula]

From Theorem 5 in [\cite=Ng] we can obtain

[formula]

The result then follows from the identity (4) of Corollary 7 in [\cite=Ng].

From the above we have another expression for the nth central binomial coefficient. The proof is similar to that of Corollary [\ref=cor1].

Let   1  ≤  m  ≤  n, then

[formula]

Generating functions

In this section we derive a formula for the generating function of generalized Catalan numbers. A comprehensive teatment of generating functions can be found in [\cite=FS].

For fixed   m  ≥  0   we let   γm(x)   denote the generating function of   Cn  +  m,  m,   i.e. the power series

[formula]

It is well-known for the classical Catalan numbers   Cn,  0   that

[formula]

(See for example [\cite=HP1].)

We denote the corresponding multivariate generating function by:

[formula]

In [\cite=CR] a formula for the generating function for   an,m   is given, i.e.

[formula]

Using the relation   Cn,m    =    an + m,n - m,   it can be verified that

[formula]

However we have another derivation here:

[formula]

We first need the following lemmas:

Let n  ≥  0   then

[formula]

where we sum over   a,  b,  c    ≥  0.

We count paths defining Cn  +  m  +  1,  m  +  1, i.e. paths from (0, - 2(m + 1)) to (n,n) = (n + m + 1 - (m + 1),n + m + 1 - (m + 1)) without crossing y = x, by using their first touch (a,a - 1) and (a + b,a + b) at the lines y = x - 1 and y = x respectively as in Figure [\ref=fig22] below.

The number of paths from (0, - 2m - 2) that first touch y = x - 1 at (a,a - 1) is the same as those reaching (a,a - 2) without crossing y = x - 2, i.e. the number is Ca  +  m,  m. Similarly, the number of paths from (a,a - 1) first reaching y = x at (a + b,a + b) is Cb,0 and the number of paths from (a + b,a + b) to (n,n) without crossing y = x is Cc,0, where c = n - a - b, hence the result is proved.

Now we have a recursive relation for the generating function γm(x):

For m  ≥  0,   we have

[formula]

We use Lemma [\ref=mainlem]:

[formula]

Now we prove Theorem [\ref=mainthm] from Lemma [\ref=gammalem]. Note that:

[formula]

from which the result follows.

More formulas

In this section we prove a few more fomulas relating to the generating functions.

Let   m  ≥  1.   The generating function   γm(x)   is equal to

[formula]

Replacing   n - m - 1   by   n   in Corollary [\ref=cor1a] equation ([\ref=cor1aeq]), we obtain for   n  ≥  1   that

[formula]

Then the theorem follows from

[formula]

We now the product   γm(x)  γ0(x)   and the following power series:

[formula]

Let   0  ≤  m  ≤  n.   Then

[formula]

From Theorem [\ref=reqthm2] equation ([\ref=thm2eq]) we have:

[formula]

therefore

[formula]

For   1  ≤  m  ≤  n,   we have

[formula]

Compare the power series expansion of   γm(x)  γ0(x)   given in the last line of the proof of Theorem [\ref=catgenthm] and the one given by   θ(x).   Then equation ([\ref=anothereq]) is obtained by replacing   n + 1   for   n.

A beautiful determinant

In this final section, we prove the following:

For integer   N    ≥  0,

[formula]

We suggest the name Catalan determinant for the above, for the entries of the matrix are the generalized Catalan numbers   Ci + j,  i.

First we need a slight modification of [\cite=W] Theorem 1. (See also [\cite=K].) An almost identical proof is given here for completeness.

Let [formula] be a formal power series and let   ci,j    =    f2i + 1(x),   where      denotes the coefficient of xj in the series. Then

[formula]

Let

[formula]

The   (i,k)-entry of   BC   is given by

[formula]

which equals   (2a1)i   if   k = i   and equals   0   if   k < i, hence   BC   is an upper triangular matrix with diagonal entries   (2a1)i.   In particular

[formula]

But   B   is lower triangular with diagonal entries   1,   so    det B    =    1   and the result follows.

To prove Theorem [\ref=thm1], we let, as in § [\ref=genfunction],   γi(x)   be the generating function of   Ci  +  j,  i,   i.e. the power series

[formula]

Then

[formula]

and Lemma [\ref=gammalem] gives that

[formula]

Therefore

[formula]

and Theorem [\ref=thm1] is now proved by applying Lemma [\ref=lem] to   f(x)    =    γ0(x).