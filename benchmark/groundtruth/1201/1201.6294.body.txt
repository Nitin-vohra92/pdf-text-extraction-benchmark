Lemma Proposition Corollary

The Generalized Wielandt Inequality in Inner Product Spaces

Introduction

The Wielandt and generalized Wielandt inequalities control how much angles can change under a given invertible matrix transformation of [formula]. The control is given in terms of the condition number of the matrix. Wielandt, in [\cite=W], gave a bound on the resulting angles when orthogonal complex lines are transformed. Subsequently, Bauer and Householder, in [\cite=BH], extended the inequality to include arbitrary starting angles. These basic inequalities of matrix analysis were introduced to give bounds on convergence rates of iterative projection methods but have found a variety of applications in numerical methods, especially eigenvalue estimation. They are also applied in multivariate analysis, where angles between vectors correspond to statistical correlation. See, for example, [\cite=BH], [\cite=E], [\cite=ET], [\cite=HJ] and [\cite=H]. There are also matrix-valued versions of the inequality that are receiving attention, especially in the context of statistical analysis. See [\cite=BD], [\cite=LLP], [\cite=WI], and [\cite=ZZ].

The condition number of an invertible matrix A is [formula], where [formula] denotes the operator norm. If A is positive definite and Hermitian, κ(A) is easily seen to be the ratio of the largest and smallest eigenvalues of A. The following statement of the generalized Wielandt inequality is taken from [\cite=H].

Let A be an invertible n  ×  n matrix. If [formula] and Φ,Ψ∈[0,π  /  2] satisfy

[formula]

then

[formula]

The generalized Wielandt inequality can be difficult to apply for several reasons. First, despite having various equivalent formulations, the inequality seems always to be expressed in ways that hide the natural symmetry coming from the invertible transformation involved. Next, the conditions for equality are known, see [\cite=K], but are unwieldy and hard to apply. Finally, the angles involved are angles between complex lines rather than between individual vectors.

Although the last point seems minor, we found it to be the key to a symmetric formulation and a simple description of the cases of equality. In Theorem [\ref=main] and its matrix analytic counterpart, Theorem [\ref=Mmain], we present a new inequality that gives sharp upper and lower bounds for the angle between a pair of transformed vectors. The conditions for equality are simple and easy to apply. This new inequality relates angles between vectors rather than between complex lines but it immediately implies a result for angles between complex lines that is equivalent to the generalized Wielandt inequality. Moreover, this version of the generalized Wielandt inequality retains the simple form of the new inequality and (most of) the simplicity of its conditions for equality.

In Section [\ref=mainResults] we work in the context of an arbitrary real or complex vector space having two inner products. This approach preserves symmetry by avoiding the distinction between angles before and after a fixed transformation. Also, the main result is not restricted to [formula] but holds for vectors in infinite-dimensional spaces. As an application of the unrestricted result, we improve a metric space inequality from [\cite=D]. The main results are then formulated in the language of matrix analysis in Section [\ref=matrices], and we apply them to improve inequalities from [\cite=Yeh] and [\cite=LS], and to settle a conjecture from [\cite=Yan].

To begin, a short discussion of angles in inner product spaces is in order. In a real inner product space (V,〈,〉  ·    ·  ) the angle θ  =  θ(u,v) between two non-zero vectors is defined by, 0  ≤  θ  ≤  π and

[formula]

Here [formula] is the norm induced by the inner product. The angle between subsets S and T of V is the infimum of the angles between non-zero elements of S and T, so

[formula]

With this definition it is easy to check that the angle [formula] between the lines [formula] and [formula] satisfies 0  ≤  Θ  ≤  π / 2 and

[formula]

A complex inner product space (V,〈,〉  ·    ·  ) may be viewed as the real inner product space [formula] where [formula] with the scalars restricted to [formula]. Since [formula] for all v∈V, lengths in V are preserved and therefore so are angles. Thus, this real inner product is used to define the angle θ between the vectors u and v, and a computation gives the formula for the angle Θ between the complex lines [formula] and [formula]. We have,

[formula]

The second formula is often used as a definition of the angle between vectors u and v in a complex inner product space. (Angles defined this way do not determine angles in triangles correctly but they have the advantage that complex orthogonality, namely [formula], is equivalent to the angle between u and v being π / 2.)

We will make use of the simple observation that if |α| = 1, then

[formula]

(Note that our inner products are taken to be linear in the first variable.) The above observation remains valid for [formula] in a real inner product space, where [formula].

Main results

Suppose V is a non-trivial real or complex vector space. Let 〈,〉1  ·    ·   and 〈,〉2  ·    ·   be inner products on V and define m, Vm, M, VM, E1 and E2 by,

[formula]

for j = 1,2. Here, as usual, [formula] and [formula]. We anticipate the result of Corollary [\ref=E] in the definition of E above.

Evidently 0  ≤  m  ≤  M  ≤    ∞  , 0∈Vm and 0∈VM. (The convention 0  ·    ∞   = 0 ensures that 0∈VM when M =   ∞  .) A standard compactness argument shows that if V is finite dimensional then 0 < m  ≤  M <   ∞   and Vm  ≠  {0}  ≠  VM. If m = M then Vm = VM = V and, by polarization, [formula] for all u,v∈V.

Let V be a real vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). If m < M, then Vm and VM are subspaces and the two are mutually orthogonal with respect to both inner products.

Proof. Suppose u is a non-zero vector in Vm and v∈V is not a multiple of u. Then

[formula]

is defined and differentiable for [formula]. Since f achieves its minimum value at t = 0, f'(0) = 0. That is, [formula]. Thus, for all u∈Vm and all v∈V,

[formula]

(The excluded case, u = 0 or v a multiple of u, is easily verified.) It follows that if v∈Vm then f is the constant function with value m2. In particular, f(1) = m2, so u + v∈Vm. Since it is clearly closed under scalar multiplication, Vm is a subspace.

Repeating the argument for VM shows that it, too, is a subspace and that for all v∈VM and u∈V,

[formula]

If u∈Vm and v∈VM then [formula] and hence [formula]. Thus u and v are orthogonal with respect to both inner products. This completes the proof.

Let V be a real vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). If V is two-dimensional, then there is a basis of V that is orthogonal with respect to both inner products.

Proof. If m = M then the two inner products are multiples of each other and any orthogonal basis will do. Otherwise, let 0  ≠  b∈Vm and 0  ≠  B∈VM. Then {b,B} is the desired basis.

The next result justifies the use of E to denote either E1 or E2.

Let V be a real vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). Then E1 = E2.

Proof. By symmetry it is enough to show that E1  ⊆  E2. For (u,v)∈E1, let

[formula]

By Lemma [\ref=orthogonal], w and W are orthogonal with respect to 〈,〉2  ·    ·  , so

[formula]

Thus

[formula]

and so (u,v)∈E2.

Having two inner products, the space V has two differing notions of the angle between vectors. Our main result provides a comparison between these angles in terms of the quantities m and M defined in ([\ref=defs]).

Let V be a real or complex vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). For independent vectors u and v in V let φ and ψ be defined by, 0  ≤  φ  ≤  π, 0  ≤  ψ  ≤  π,

[formula]

Then

[formula]

Equality holds in the right-hand inequality if and only if (u,v)∈E. Equality holds in the left-hand inequality if and only if (u, - v)∈E.

Proof. First consider the case that V is a real vector space. Note that the assumption of independence ensures 0 < φ  <  π and 0 < ψ  <  π.

By Corollary [\ref=2basis], the span of u and v has a basis {b,B} that is orthogonal with respect to both inner products. Without loss of generality we may assume that [formula]. For notational convenience, set [formula] and [formula] and suppose, by interchanging b and B if necessary, that n  ≤  N. Note that the definitions of m and M ensure that m  ≤  n and N  ≤  M. Write u = ubb + uBB and v = vbb + vBB for some real numbers ub, uB, vb, and vB. In terms of these coordinates we have,

[formula]

and

[formula]

Thus,

[formula]

The derivative of

[formula]

is

[formula]

so g(1)  ≤  g(N2 / n2). Multiplying both sides of this by n2 gives,

[formula]

Combining ([\ref=sin]) and ([\ref=n2cos]) gives,

[formula]

with equality if and only if g'(x) = 0 for x∈(1,N2 / n2). Since m  ≤  n  ≤  N  ≤  M, ([\ref=nN]) proves the right-hand inequality of ([\ref=TAN]).

If equality holds in the right-hand inequality of ([\ref=TAN]), then equality holds in ([\ref=nN]) and n = m, N = M, b∈Vm, and B∈VM. If m = M then Vm = VM = V and φ  =  ψ so the last two statements of the theorem are trivial. Otherwise, equality in ([\ref=nN]) implies that g' is zero on the non-trivial interval (1,M2 / m2). That is,

[formula]

and hence u2Bv2b = v2Bu2b. Since u and v are independent, both uB and vB are non-zero, they have opposite signs, and uBvb =  - vBub. Therefore,

[formula]

and

[formula]

That is, (u,v)∈E1 = E.

Conversely, suppose that (u,v)∈E, set

[formula]

and observe that w + W is in the direction of u and w - W is in the direction of v. By Lemma [\ref=orthogonal], w and W are orthogonal with respect to both inner products. Thus,

[formula]

and

[formula]

A similar calculation yields the corresponding formula for ψ and leads to the conclusion,

[formula]

Taking square roots establishes equality in the right-hand inequality of ([\ref=TAN]).

Applying the right-hand inequality of ([\ref=TAN]) to the vectors u and - v replaces φ by π  -  φ and ψ by π  -  ψ to give the conclusion,

[formula]

This proves the left-hand inequality of ([\ref=TAN]), with equality if and only if (u, - v)∈E. This completes the proof in the case that V is a real vector space.

If V is a complex space and 〈,〉1  ·    ·   and 〈,〉2  ·    ·   are complex inner products, the conclusion of the theorem follows by applying the result just proved to the real vector space [formula] equipped with the real inner products [formula] and [formula]. This completes the proof.

The angle between two subsets of V is defined as an infimum of angles between pairs of vectors. The inequality ([\ref=TAN]) remains valid when we take an infimum of all three terms so we have the following result. Note that since the cosine function is decreasing, the cosine of an infimum of angles is achieved by taking the supremum of their cosines.

Let V be a real or complex vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). For S,T  ⊆  V, each containing at least one non-zero vector, let Φ and Ψ be the angles between the subsets S and T with respect to 〈,〉1  ·    ·   and 〈,〉2  ·    ·  , respectively. That is, 0  ≤  Φ  ≤  π, 0  ≤  Ψ  ≤  π,

[formula]

Then

[formula]

The following theorem is our version of the generalized Wielandt inequality in inner product spaces. As pointed out earlier, the angles between the (real or complex) lines determined by u and v are often taken as alternative definitions of the angle between vectors themselves. We show that with this definition the results of Theorem [\ref=main] still hold, but the conditions for equality become slightly more complicated.

Let V be a real or complex vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). For independent vectors u and v in V let Φ and Ψ be defined by, 0  ≤  Φ  ≤  π / 2, 0  ≤  Ψ  ≤  π / 2,

[formula]

Then

[formula]

Let α1 and α2 be solutions to [formula] and [formula]. Equality holds in the right-hand inequality of ([\ref=TAN2]) if and only if (α1u,v)∈E and either α1  =  α2 or [formula]. Equality holds in the left-hand inequality of ([\ref=TAN2]) if and only if (α2u, - v)∈E and either α1  =  α2 or [formula].

Proof. Apply Corollary [\ref=ST] to the lines [formula] and [formula] ([formula] and [formula] in the real case) to obtain ([\ref=TAN2]). By ([\ref=alpha]), Φ is the angle between α1u and v with respect to 〈,〉1  ·    ·   and Ψ is the angle between α2u and v with respect to 〈,〉2  ·    ·  . To analyse the right-hand inequality of ([\ref=TAN2]), let θ be the angle between α1u and v with respect to 〈,〉2  ·    ·  . The infimum definition of Ψ and Theorem [\ref=main] show that

[formula]

By ([\ref=alpha]), the first of these is equality if and only if either α1  =  α2 or [formula]. By Theorem [\ref=main], the second is equality if and only if (α1u,v)∈E. Thus equality holds in the right-hand inequality of ([\ref=TAN2]) if and only if (α1u,v)∈E and either α1  =  α2 or [formula].

To analyse the left-hand inequality of ([\ref=TAN2]), let θ be the angle between α2u and v with respect to 〈,〉1  ·    ·  . The infimum definition of Φ and Theorem [\ref=main] show that

[formula]

By ([\ref=alpha]), the first of these is equality if and only if either α1  =  α2 or [formula]. By Theorem [\ref=main], the second is equality if and only if (α2u, - v)∈E. Thus equality holds in the left-hand inequality of ([\ref=TAN2]) if and only if (α2u, - v)∈E and either α1  =  α2 or [formula].

The inequalities ([\ref=TAN]) and ([\ref=TAN2]) can be expressed in various equivalent forms. In terms of cosines ([\ref=TAN]) becomes, with χ = (M2 - m2) / (M2 + m2),

[formula]

Replace φ and ψ by Φ and Ψ to get the expression for ([\ref=TAN2]). In terms of inner products instead of angles, the inequalities ([\ref=TAN]) of Theorem [\ref=main] and ([\ref=TAN2]) of Theorem [\ref=lines] become, in the case [formula],

[formula]

and

[formula]

respectively.

The special case Φ  =  π / 2 in Theorem [\ref=lines] gives an inner product formulation of Wielandt's inequality that includes all cases of equality. Note that the right-hand inequality of ([\ref=modIP]) is equivalent to the left-hand inequality of ([\ref=TAN2]).

Let V be a real or complex vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). Suppose the non-zero vectors u,v∈V are orthogonal with respect to 〈,〉1  ·    ·   and α satisfies [formula]. Then,

[formula]

with equality if and only if (αu, - v)∈E.

The following theorem gives upper and lower bounds on the difference between the cosines of φ and ψ. It improves the estimates given in Theorems 1 and 2 of [\cite=D].

Let V be a real or complex vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). For independent vectors u and v in V,

[formula]

and, if [formula], then

[formula]

Also,

[formula]

Proof. Suppose φ and ψ are the angles between u and v with respect to 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Since,

[formula]

Theorem [\ref=main] gives

[formula]

where x =  tan 2(φ / 2). A little calculus shows that the minimum value, over all x∈[0,   ∞ ], of the expression on the left occurs at x = m / M and the maximum value, over all x∈[0,   ∞ ], of the expression on the right occurs at x = M / m. This gives ([\ref=regen]). If [formula] then φ  ≤  π / 2 and so x  =   tan 2(φ / 2)  ≤  1. The maximum value on the right now occurs at x = 1, giving ([\ref=pos]).

The same analysis, applied to the angles Φ and Ψ between the lines [formula] and [formula] (or [formula] and [formula] in the real case) includes the restriction tan 2(Φ / 2)  ≤  1 and gives the right-hand inequality in ([\ref=absgen]). The left-hand inequality follows from the right-hand one by interchanging the inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Besides interchanging the angles φ and ψ, this has the effect of replacing m by 1 / M and M by 1 / m to give

[formula]

Multiplying through by - 1 completes the proof.

In our notation, Dragomir's results from [\cite=D] are

[formula]

and, if [formula], then

[formula]

Since

[formula]

Theorem [\ref=Drag] improves on both of these statements.

The estimate ([\ref=regen]), on the difference between the cosines of φ and ψ readily gives a lower bound on the product of those cosines.

Let V be a real or complex vector space equipped with inner products 〈,〉1  ·    ·   and 〈,〉2  ·    ·  . Make the definitions ([\ref=defs]). For independent vectors u and v in V,

[formula]

Proof. Let μ = (M - m) / (M + m),

[formula]

Note that 0  ≤  μ < 1. By the Cauchy-Schwarz inequality and ([\ref=regen]), the point (x,y) lies in the region defined by [formula], [formula], and - 2μ  ≤  x - y  ≤  2μ. Minimizing xy over this hexagonal region easily yields (x,y) = ( - μ,μ) or (x,y) = (μ, - μ). Thus, xy  ≥    -  μ2 as required.

Formulation in terms of matrices

The angle θ between vectors [formula] is defined by 0  ≤  θ  ≤  π and

[formula]

and the angle Θ between the complex lines [formula] and [formula] satisfies 0  ≤  Θ  ≤  π / 2 and

[formula]

Let A be an invertible n  ×  n matrix and consider the two inner products

[formula]

on [formula]. Then the definitions in ([\ref=defs]) show that [formula] and [formula] so the condition number of A is κ(A) = M / m. Theorem [\ref=main] becomes the following.

Let A be an invertible n  ×  n matrix. For independent [formula] let φ be the angle between x and y and let ψ be the angle between Ax and Ay. Then,

[formula]

Let λn and λ1 denote the smallest and largest eigenvalues of A*A. Then equality holds in the right-hand inequality above if and only if [formula] is in the λn-eigenspace of A*A and [formula] is in the λ1-eigenspace of A*A. Also, equality holds in the left-hand inequality above if and only if [formula] is in the λn-eigenspace of A*A and [formula] is in the λ1-eigenspace of A*A.

Theorem [\ref=lines] gives a concise reformulation of the generalized Wielandt inequality. Since κ(A) = κ(A- 1), the symmetry between the angles Φ and Ψ is clear.

Let A be an invertible n  ×  n matrix. For independent [formula] let Φ be the angle between the complex lines [formula] and [formula] and let Ψ be the angle between the complex lines [formula] and [formula]. Then

[formula]

It takes a bit of care to show the equivalence of this theorem with Theorem [\ref=gW] because the angles Φ and Ψ represent subtly different concepts in the two statements. In Theorem [\ref=Mlines], Φ and Ψ represent angles between given complex lines, while in Theorem [\ref=gW] they represent bounds on those angles rather than the angles themselves. Also, one must apply Theorem [\ref=gW] to A and to A- 1 (or else to x,y and to x, - y) to obtain both sides of the inequality above.

The conclusion of Theorems [\ref=Mmain] and [\ref=Mlines] may be rewritten as

[formula]

where χ = (κ(A)2 - 1) / (κ(A)2 + 1). (Of course, φ and ψ should be replaced by Φ and Ψ when rewriting Theorem [\ref=Mlines].)

We have omitted the characterization of the cases of equality in Theorem [\ref=Mlines] but they can be readily obtained from Theorem [\ref=lines]. Conditions for equality in Theorem [\ref=main] are simpler than those in Theorem [\ref=lines] because the former deals with angles between a single pair of vectors and the latter with an infimum of angles between vectors in two one-dimensional subspaces. To recognize when equality occurs in Theorem [\ref=main] one only has to consider the placement of the vectors u and v relative to the eigenspaces Vm and VM. But equality in Theorem [\ref=lines] requires that this infimum of angles be achieved for u and v in addition to requiring their correct placement with respect to these eigenspaces. In [\cite=K], Kolotilina gave the following characterization of the cases of equality in the generalized Wielandt inequality, without explicit recognition of this two-stage requirement. We give an alternative proof using Theorem [\ref=lines]. (Notice that the complex numbers ξ and η appearing in the Theorem of [\cite=K] are unnecessary as they may be absorbed into the eigenvectors x1 and xn.)

Let B be an n  ×  n invertible Hermitian matrix, suppose λ1  >  λn > 0 are its largest and smallest eigenvalues, respectively, and set χ = (λ1  -  λn) / (λ1  +  λn). Fix independent [formula] and let [formula]. Then

[formula]

if and only if

[formula]

for some complex number ε of unit modulus and some unit eigenvectors x1 and xn satisfying Bx1  =  λ1x1 and Bxn  =  λnxn.

Proof. With A = B1 / 2 we have B = A*A. Apply Theorem [\ref=lines] to the inner products ([\ref=MIPs]) and note that M = λ1 and m = λn so VM and Vm are the λ1- and λn-eigenspaces of B, respectively. Using ([\ref=COS]), we see that ([\ref=kolo]) is equivalent to equality in the left hand inequality of ([\ref=TAN2]). Thus, Theorem [\ref=lines] shows that ([\ref=kolo]) holds if and only if (α2x, - y)∈E and either α1  =  α2 or y*x = 0. As in Theorem [\ref=lines], |y*x| = α1y*x and |(Ay)*(Ax)| = α2(Ay)*(Ax).

First suppose that x and y satisfy ([\ref=kolocond]). A calculation, using the fact that x1 and xn are orthogonal, shows that [formula] and [formula]. It follows that either α1  =  α2  =  ε or y*x = 0. Also,

[formula]

and

[formula]

so (α2x, - y)∈E.

Conversely, suppose that (α2x, - y)∈E and either α1  =  α2 or y*x = 0. Set ε  =  α2. Then there exist w∈Vm and W∈VM such that

[formula]

Since w and W are orthogonal,the parallelogram law gives [formula] and the definition of φ gives [formula]. Solving these two equations yields, [formula] and [formula]. With [formula] and [formula] we have ([\ref=kolocond]). This completes the proof.

In Theorem 3 of [\cite=Yeh], Yeh gave a different generalization of the Wielandt inequality for angles between complex lines. Here we show that Theorem [\ref=Mlines] gives the stronger inequality.

[\cite=Yeh] Let A be an invertible n  ×  n matrix. For independent [formula] let Φ be the angle between the complex lines [formula] and [formula] and let Ψ be the angle between the complex lines [formula] and [formula]. Define θ by 0  ≤  θ  ≤  π / 2 and cot (θ / 2) = κ(A). If cos Φ  ≤  1 / κ(A)2, then

[formula]

Proof. By Theorem [\ref=Mlines] and ([\ref=MCOS]), it is enough to show that

[formula]

where

[formula]

But both χ and cos Φ are positive, so

[formula]

as required.

In Theorem 3.1 of [\cite=Yan], Yan generalized the Wielandt inequality for real symmetric matrices as follows.

[\cite=Yan] Let B be a real n  ×  n symmetric positive definite matrix with eigenvalues [formula]. For independent [formula] define Φ by 0  ≤  Φ  ≤  π / 2 and [formula]. Then,

[formula]

It was left as a conjecture in [\cite=Yan] that the theorem remains true for complex vectors x and y and a positive definite Hermitian matrix B.

It is routine to verify that the expression

[formula]

is increasing in s and decreasing in t. Thus, the maximum in ([\ref=yanr]) is achieved when i = 1 and j = n, where it takes the value,

[formula]

Here χ = (λ1  /  λn - 1) / (λ1  /  λn + 1). If A = B1 / 2, then κ(A)2  =  κ(B) = λ1  /  λn so Theorem [\ref=Mlines] and ([\ref=MCOS]) implies that Theorem [\ref=yan] holds in both the real and complex cases, confirming Yan's conjecture.

We end with an improvement of Lemma 2.2 from [\cite=LS]. It follows directly from Corollary [\ref=cosprod] with [formula] and [formula].

Suppose A and B are real symmetric positive definite n  ×  n matrices and let κ  =  κ(A- 1 / 2BA- 1 / 2). Then for [formula] with [formula],

[formula]

The above inequality followed by the AM-GM inequality give the conclusion of Lemma 2.2 from [\cite=LS]:

[formula]