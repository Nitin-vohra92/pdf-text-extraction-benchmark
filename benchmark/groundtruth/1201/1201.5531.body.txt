=1

Rapid simulation of protein motion: merging flexibility, rigidity and normal mode analyses

Protein Rigidity, protein flexibility, normal mode analysis, conformational change, domain motion, rapid simulation, coarse-grained methods, multi-scale methods.

Introduction

Protein conformational changes and dynamic behaviour are fundamental for processes such as catalysis, regulation, and substrate recognition. The time scales of motions involved in enzyme function span multiple orders of magnitude, from the picosecond timescale of local side groups rotations to the milli-/microsecond timescale of the motion of entire domains [\cite=HenK07]. Empirical-potential molecular dynamics (MD) has proved to be a valuable tool for investigating molecular motions, but specialized expertise, large-scale computing resources and weeks or months of compute time are required to explore protein motion on simulation time scales greater than tens of nanoseconds [\cite=ShaMLS10]. There is clearly a need for methods that that permit exploration of possible large conformational motions of proteins in a rational, albeit somewhat simplified, fashion with minimal computational resources. Such explorations allow for the generation of hypotheses about large conformational motion and protein function that can then be investigated with detailed MD simulations and by experimental methods such as FRET [\cite=GieAET06].

The computational cost of simulations can be reduced by coarse-graining (CG) -- averaging out atomic degrees of freedom so as to represent groups of atoms by a single site [\cite=RusLPS09] [\cite=Cle08] -- and/or by simplifying the intersite interactions. Different levels of simplification can then be combined in multi-scale methods [\cite=YalB07] [\cite=SheBS08]. Here, we shall consider three such methods in particular. Pebble-game rigidity analysis, implemented in First [\cite=JacRKT01], provides valuable information on the distribution of rigid and flexible regions in a structure [\cite=WelJR09]. Geometric simulation in the Froda algorithm [\cite=WelMHT05] uses rigidity information and explores flexible motion [\cite=JolWHT06] [\cite=JolWFT08]. Normal mode analysis of a coarse-grained elastic network model (ENM), implemented in ElNemo [\cite=SuhS04] [\cite=SuhSB04], generates eigenvectors for low-frequency motion which are potential sources of functional motion and conformational change [\cite=BahLBS10] [\cite=Ma05] [\cite=RueCO07] [\cite=NakMKH10] [\cite=DykS10].

Our approach in this study is to bias the generation of new conformations in First/Froda along an eigenvector predicted by ElNemo as a low-frequency mode. The bias directs the motion of the atoms in the direction of the eigenvector while the geometric constraint system maintains rational bonding and sterics and prevents the build-up of distortions that occur in a linear projection. The method is outlined schematically in Figure [\ref=fig:method]. We apply our method to a set of six proteins of various sizes from 58 to 1605 residues. We find that flexible motion in an all-atom model can be explored to large amplitudes in a few CPU-minutes, until further motion is limited by bonding or steric constraints, representing the calculated limit of motion along that vector.

Methods

Protein selection

We deliberately selected six proteins for analysis that are diverse in function, structural characteristics and size, ranging from 58 to 1605 residues. For each protein, we selected a representative high-resolution structure from the Protein Data Bank (PDB) [\cite=BerWFG00]. The proteins and their PDB codes are listed in Table [\ref=Tab:cutoffs] and their structures are shown in Figure [\ref=fig:proteins] with colour coding according to the results of rigidity analysis.

Bovine pancreatic trypsin inhibitor (BPTI) is a small well-studied protease inhibitor of 58 amino acids, comprising mainly random-coil structure plus two antiparallel β-strands and two short α-helices; the protein has only a small hydrophobic core, but is additionally stabilized by 3 intra-chain disulphide bonds [\cite=WloWHS84] [\cite=AmiH88]. Mammalian mitochondrial cytochrome-c is a classic electron-transfer protein containing a redox-active haem group bound within a primarily α-helical protein fold. These two were selected as contrasting small proteins.

As medium size proteins we selected α1-antitrypsin and the core catalytic domain of the motor protein kinesin [\cite=ShiHTM04]. The former is a protease inhibitor of the serpin family [\cite=EllPDL00] which operates via a 'bait' mechanism comparable to that of a mouse-trap, involving a very significant conformational change, whereas the latter is a mechanochemical device that transduces the chemical energy of ATP hydrolysis into mechanical work, specifically the depolymerisation of microtubules in the case of this kinI kinesin. Both these proteins comprise an extensive β-sheet core flanked by several α-helices.

Protein disulphide-isomerase (PDI) is a large protein (with more than 500 residues) comprising 4 distinct domains each with a thioredoxin-like fold, connected by two short and one longer linker [\cite=FreKR02]; the protein has both redox and molecular chaperone activity and intramolecular flexibility is essential for its action in facilitating oxidative folding of secretory proteins [\cite=TiaKLS08] [\cite=TiaXNLS06]. The largest protein selected is an integral membrane protein (a bacterial protein of 1605 residues) that operates as a pentameric ligand-gated ion channel (pLGIC); it comprises an extracellular -- mainly β-sheet -- domain and a membrane-embedded domain, mainly comprising α-helices which form the lining of the ion-channel; the mechanisms of ion permeation and channel gating are not yet completely understood but it is clear that a conformational change is required for function [\cite=HilD08].

Rigidity analysis and energy cutoff selection

We add the hydrogen atoms absent from the PDB X-ray crystal structures using the software Reduce [\cite=WorLRR99] and remove alternate conformations and renumber the hydrogen atoms in Pymol [\cite=Del02]. This produces usable files for First rigidity analysis. For each protein we produce a "rigidity dilution" or rigid cluster decomposition (RCD) [\cite=JacRKT01] plot (displayed in the supplementary Figure [\ref=Fig:RCD_plot]). The plots show the dependence of the protein rigidity on an energy cutoff parameter, Ecut, which determines the set of hydrogen bonds to be included in the rigidity analysis. The tertiary structures with the residues coloured by the rigid clusters they belong to are shown in Figures [\ref=3D_1BPI_Ec]-[\ref=3D_2VL0_Ec] for each of the selected energy cutoffs.

Previous studies [\cite=JacRKT01] suggested that Ecut should be at least - 0.1 kcal/mol in order to eliminate a large number of very weak hydrogen bonds, and that a natural choice is near the 'room temperature' energy of - 0.6 kcal/mol. We have recently discussed the criteria for a robust selection of Ecut [\cite=WelJR09]. For each protein we have selected several energy cutoffs at which to explore flexible motion, as listed in Table [\ref=Tab:cutoffs]. A higher cutoff energy increases the number of constraints included in the simulation, and this is expected to restrict protein motion. We have used in each case at least one cutoff at which the protein is largely rigid (in the range - 0.1 kcal/mol to - 0.7 kcal/mol) and at least one lower cutoff at which the protein is largely flexible (in the range - 0.5 kcal/mol to - 2.2 kcal/mol).

Normal modes of motion

We obtain the normal modes of motion using the ENM [\cite=Tir96] implemented in ElNemo software [\cite=SuhS04] [\cite=SuhSB04]. This generates, for each protein, a set of eigenvectors and associated eigenvalues. Other implementations of elastic network models are also available, for example the AD-ENM of Zheng et al. [\cite=ZheD03].

The low-frequency modes are expected to have the largest amplitudes and thus be most significant for large conformational changes. However, the six lowest-frequency modes (modes 1 to 6) are trivial combinations of rigid-body translations and rotations of the entire protein. For illustration, here we consider the five lowest-frequency non-trivial modes, that is modes 7 to 11 for each protein. We will denote these modes as m7, m8, , m11.

The mode eigenvectors are predicted on the basis of a single protein conformation. The amplitude to which a mode can be projected may be limited by bonding and/or steric constraints that are not evident in the input structure or fully captured by the ENM. A linear projection of all the residues in the protein along a mode eigenvector introduces unphysical distortions of the interatomic bonding. Typically, to avoid this and project a mode to finite amplitude requires one or more cycles of a combined method; the mode is projected linearly until distortions become evident and the resulting structure is relaxed using constrained MD/molecular mechanics [\cite=CheLGL06] [\cite=XuTB03] [\cite=MiyOW03]. We explore an alternative method for projection of modes to large amplitudes, using rigidity analysis and geometric simulation.

Froda mobility simulation

Geometric simulation, implemented in the Froda module within First [\cite=WelMHT05] [\cite=FarST10], explores the flexible motion available to a protein with a given pattern of rigidity and flexibility. New conformations are generated by applying a small random perturbation to all atomic positions; Froda then reapplies bonding and steric constraints to produce an acceptable new conformation. Motion can be biased by including a directed component to the perturbation. The capability to use a mode eigenvector as a bias was implemented in First/Froda by one of us (SAW) and has been briefly reported previously [\cite=JimWFR11]. The combination of ElNemo and First/Froda, illustrated schematically in Figure [\ref=fig:method], is described in detail in supplementary material (section [\ref=Supp:settings]).

Since the displacement from one conformation to the next is small, we record only every 100th conformation and continue the run for typically several thousand conformations. The run is considered complete when no further projection along the mode eigenvector is possible (due to steric clashes or bonding constraints) which manifests itself in slow generation of new conformations and poor reproducibility in the results of independent runs. We have performed Froda mobility simulation for each protein at several selected values of Ecut, see section [\ref=rigidityanalysis].

During conformation generation we track the fitted RMSD between α carbons of the initial and current conformation. This measure is discussed in more detail in supplementary material (section [\ref=Supp:RMSD]). To project a mode to an amplitude of several Å in fitted RMSD typically takes a few CPU-minutes on a single processor. We carry out five parallel simulations for each structure, mode and direction of motion and monitor the evolution of fitted RMSD during each run, as illustrated in Figures [\ref=Fig:RMSD:SL]-[\ref=Fig:RMSD:2VL0].

Raw and fitted RMSD

The RMSDs reported in Table [\ref=RMSD_table] are α carbon RMSDs from the input structure to a generated conformation, obtained after least-squares fitting using the PyMOL intra_fit command. These values differ somewhat from the raw RMSD values reported by Froda in its output files, which are calculated without any fitting being carried out. In particular, the fitted RMSD saturates once further motion along the mode direction is no longer possible, due to steric clashes or limits imposed by covalent or noncovalent bonding constraints. The raw RMSD is greater than the fitted RMSD and tends not to saturate, but rather to continue to increase slowly, once the motion is effectively jammed. The reason for this different behaviour is a small difference in the statistical weighting given to each residue by ElNemo and by First/Froda. In the elastic network modelling, every residue is given equal statistical weight. The non-trivial mode eigenvectors thus generated have no significant component of rigid-body motion for the whole structure. In Froda, however, the bias is applied to an all-atom representation of the structure; and thus the bias applied to a residue with many atoms affects the whole-body motion of the structure more than the bias applied to a residue with few atoms. The motion in Froda therefore acquires a small component of rigid-body translation and rotation, which increases the raw RMSD. Least-squares fitting to the input structure removes the rigid-body components, so the fitted RMSD detects actual conformational change.

The effects of fitting are illustrated in Figure [\ref=RawvsfittedRMSD]a for mode m7 of structure 1BPI. The raw RMSD values increase almost linearly during the generation of 10000 conformers, whereas the fitted RMSD values saturate for conformers from ≈   5000 up to 10000. Conformers 5000 and 10000 differ by [formula] in raw RMSD but by only [formula] in fitted RMSD. Superpositions of conformers 0, 5000 and 10000 with and without fitting, shown in Figures [\ref=RawvsfittedRMSD]b,c, show that conformers 5000 and 10000 are indeed very similar to each other. Hence, fitting structures before calculating RMSD values allows us to identify real conformation change and remove the component of rigid-body motion introduced by Froda.

Results

Conformer generation with mode bias

The output of the mobility simulations for BPTI (1BP1) is summarized in Figures [\ref=Fig:RMSD:SL]a-c. The evolution of RMSD for each of m7, ,m11, during runs at two selected values of Ecut, is represented in Figures [\ref=Fig:RMSD:SL]b and [\ref=Fig:RMSD:SL]c respectively. In all cases, we observe an initial phase in which the RMSD increases almost linearly, as the protein explores the mode direction without encountering significant steric or bonding constraints on the motion. During this phase, generation of new conformations in Froda is very rapid and the RMSDs from different runs are very similar to each other. The RMSD then displays an inflection, ceasing to rise linearly, and approaching an asymptote; this indicates that steric clashes and bonding constraints (such as hydrophobic tethers) are preventing further exploration along the mode direction. The asymptote is thus an amplitude limit on the mode. In this phase the generation of new conformations in Froda becomes slower as the fitting algorithm has increasing difficulty finding a valid conformation, and the RMSDs achieved by different runs differ. In the regime of slow conformation generation, the mode bias is forcing the structure into a regime of steric clashes and/or of bonding constraint limits, for example when residues connected by a hydrophobic tether are being pushed apart. This regime cannot correspond to the low-frequency flexible motion which we wish to explore. Our presentation of RMSD data for larger proteins is therefore truncated once this "jamming" starts. For most of our proteins, 2500 conformations is sufficient to cover the regime of rapid conformation generation. For our largest protein, pLGIC (2VL0), we find that 1000 conformations was sufficient.

Small loop motion

In Figure [\ref=Fig:RMSD:SL]a we show an ensemble of structures for BPTI generated by exploring the lowest-frequency nontrivial mode, m7, and in Figures [\ref=Fig:RMSD:SL]b,c we show the RMSDs achieved for the five lowest-frequency nontrivial modes. The amplitudes of flexible motion for BPTI at the cutoffs - 0.2 kcal/mol and - 2.2 kcal/mol reach an asymptote at RMSD values around 2 to 4Å. Considerable asymmetry, a factor of 2 difference in the achievable RMSD, is observable in some modes between the two possible directions of motion. Let us emphasize here that in general the amplitudes of flexible motion are not available from either the elastic network model or the rigidity analysis without simulation of flexible motion.

BPTI (1BPI) is a small protein with some relatively flexible loop regions. For contrast, we now examine a compact globular protein, cytochrome-c (1HRC). RMSD results are shown in Figure [\ref=Fig:RMSD:SL]e,f truncated once jamming had begun. Although this protein is twice as large as BPTI in terms of residues, its capacity for flexible motion is visibly more limited, with amplitudes below 2Å in all modes. This result is important in validating our method of projecting modes to large amplitude; if geometric simulation were capable of reaching unphysically large amplitudes, the method would lose its value.

Large loop motion

RMSDs for low-frequency modes of internal kinesin motor domain protein (1RY6) are shown in Figure [\ref=Fig:RMSD:LL]b, c for two different energy cutoffs. The amplitudes achievable for these modes differ little between the different energy cutoffs; motion occurs principally in a flexible loop region around residues 37-46. An exploration of m7 is presented in Figure [\ref=Fig:RMSD:LL]a for an energy cutoff of - 1.1 kcal/mol, clearly showing the loop motion. We find that the combination of the mode bias and the bonding constraints naturally causes the large flexible loop to follow a curved trajectory.

As shown in Figures [\ref=Fig:RMSD:LL]e, f, α1-antitrypsin (1QLP) displays several low-frequency modes which easily explore amplitudes of up to 2-2.5Å RMSD depending on the rigidity cutoff. The motion shown in Figure [\ref=Fig:RMSD:LL]d again involves the easy motion of large flexible loops with respect to the relatively rigid β-sheet core of the protein.

Domain motion

Protein disulphide isomerase (2B5E) is an interesting case for protein mobility. The protein consists of four domains (a-b-b'-a') connected by flexible linkers. Biological evidence indicates that conformational flexibility is vital to the function of the enzyme [\cite=FreKR02]. Rigidity analysis immediately brings out the flexibility of the molecule (see Figure [\ref=Fig:RCD_plot]e). Even at very high Ecut values (Ecut  =   - 0.015 kcal/mol), the rigidity analysis reveals the domain organisation of the protein with each domain corresponding to a distinct rigid cluster flanked by flexible linkers. The RMSD achievable by low-frequency flexible motion therefore does not depend significantly on the energy cutoff; motion is slightly limited at the weakest cutoff (Figure [\ref=Fig:RMSD:2B5E]b), but at other cutoffs the achievable amplitudes are essentially the same (Figure [\ref=Fig:RMSD:2B5E]c and d). Close examination of the conformation generation in First/ Froda indicates that the amplitudes are limited eventually as further motion along the mode would over-extend covalent and hydrophobic-tether constraints.

The inter-domain nature of the flexible motion is detailed in Figure [\ref=Fig:RMSD:2B5E]a which shows structures at the amplitude limits of m7 in the positive and negative directions. The structures are aligned on the b-b' domains, bringing out the motion of the a domain and particularly of the a' domain. The CPU time required to project this protein with more than 500 residues along m7 to an amplitude of more than 20Å is less than 15 minutes.

The largest protein we have investigated is pLGIC (2VL0). Its pentameric structure includes a transmembrane domain composed of α-helices and an extracellular domain consisting largely of β-sheets. The major rigidity transition in the protein identified by First occurs between a cutoff of - 0.4 kcal/mol, when almost the entire structure forms a single rigid cluster, and - 0.5 kcal/mol, when the five backbone sections linking the two major domains have become flexible and the many α-helices in the transmembrane are mutually flexible. At the lower energy cutoff it is possible for the two domains to move relative to each other, and the transmembrane helices are also capable of relative motion. The increased RMSD possible at the lower Ecut is visible in Figure [\ref=Fig:RMSD:2VL0].

The flexible motion at the higher cutoff, with the protein largely rigid, involves only the motion of a few flexible loops. The motion at the lower cutoff is far more biologically interesting. The lowest-frequency non-trivial mode, m7, involves a counter-rotation of the transmembrane and extracellular domains, including a change in the relative tilt of transmembrane helices lining the ion channel. This flexible motion is shown in Figure [\ref=Fig:RMSD:2VL0]a, b. The CPU time to project this large protein with more than 1600 residues along m7 to its amplitude limit is less than twenty minutes.

Discussion

Extensive RMSD as a characterisation of total flexible motion

The evolution of RMSD values is displayed in Figures [\ref=Fig:RMSD:SL]-[\ref=Fig:RMSD:2VL0] and the maximum values achieved by these motions, which range from 1.5Å to 10Å, are shown in Table [\ref=RMSD_table]. However, the character of the flexible motion does not seem well reflected by the RMSD values. For example, a small protein of 58 residues without a large conformational change such as BPTI shows RMSD values of up to 3.5Å in its small loop motion (Figure [\ref=Fig:RMSD:SL]); whereas the channel protein pLGIC, a thirty times larger protein by residue count (1605 residues), shows a substantial domain motion, in which a large proportion of the atoms undergo relative motion as the transmembrane protein and extra cellular domains counter-rotate (see Figure [\ref=Fig:RMSD:2VL0]a, b). Yet the channel protein pLGIC shows maximum RMSD values of around 2.5Å only. So, although RMSD is a good measure for comparing two similar structures, it does not necessarily capture the scale of motion in different structures.

We introduce an extensive RMSD measure by multiplying the RMSD (which describes the average displacement of atoms) by the number of residues in the protein. Figure [\ref=Fig:xRMSD] shows these xRMSD values for all the selected proteins moving along m7. The three categories of motion which we have discussed -- small loop motion, large loop motion and domain motion -- become clearly visible in xRMSD. The xRMSD results for BPTI and cytochrome-c closely resemble each other even though cytochrome-c is almost double the size of BPTI. Similarly, the kinesin protein and the α1-antitrypsin display similar xRMSD behaviour to each other in their large loop motion. PDI and the pLGIC likewise have similar xRMSD behaviour reflecting their domain motion. Thus the character and extent of the flexible motions in proteins of various sizes, as shown in Figures [\ref=Fig:RMSD:SL]a,d, [\ref=Fig:RMSD:LL]a,d, [\ref=Fig:RMSD:2B5E]a and [\ref=Fig:RMSD:2VL0]a,b, is better reflected by the xRMSD than by the RMSD alone.

Monitoring the evolution of normal modes

It is implicit in normal-mode analysis of protein conformational change that a mode eigenvector should be a valid direction for motion over some non-zero amplitude. For example, Krebs et al. [\cite=KreAWE02] have surveyed a large number of known conformational changes, using paired crystal structures, comparing the vector describing the observed conformational change to the low-frequency elastic network mode eigenvectors using a dot product. In many cases the observed change had a large dot product (> 0.5) with only one or two normal modes.

In each of our simulations we use an initial normal mode, m(i)j, as a bias throughout the simulation. We calculate a new set of current normal modes, m(c)j, for each newly generated conformation. We compute the dot product of the bias vector, m(i)j, with m(c)j, that is, the current normal mode with the same mode number j, as in m(i)j  ·  m(c)j. Graphs of these dot products are shown for all protein structures investigated here in the supplementary Figures [\ref=Fig:dot1BPI]-[\ref=Fig:dot2VL0].

We find that three main classes of dot product behaviour emerge, shown schematically in Figure [\ref=Fig:paraboles]a. In motif 1, the dot product remains close to 1 throughout the simulation, indicating the initial and current modes remain very similar. In this case the motion of the protein is not introducing significant changes to the elastic network model and the mode eigenvector remains almost unchanged. In motif 2, there is a gradual decline in the dot product, of quadratic or cosine character; this suggests a gradual rotation of m(c)j relative to m(i)j. Perhaps the most interesting case is motif 3, in which the dot product m(i)j  ·  m(c)j collapses rapidly; this can occur at any point in the simulation, even if the RMSD between the initial and current conformations is small. Examples of these motifs can be observed for all our proteins. We find, e.g. a motif 1 behavior in mode m7 for PDI (cp. Figure [\ref=Fig:dot2B5E]b, c, d), a motif 2 behaviour in m7 for kinesin (cp. Figure [\ref=Fig:dot1RY6]) and motif 3 character in m7 for antitrypsin (cp. Figure [\ref=Fig:dot1QLP]) as well as in BPTI (cp. Figure [\ref=Fig:dot1BPI]). Similar agreement with all motifs can be found for higher modes, although, as a general tendency, the smooth motifs 1 and 2 become gradually less visible and the more rapid changes exemplified by motif 3 more pronounced.

These sudden collapses do not indicate that the initial normal mode eigenvector has ceased to be a valid direction along which flexible motion is possible. Rather, the eigenvector has ceased to represent a single pure mode; m(i)j now has significant overlap with multiple other modes m(c)k. This mode mixing is illustrated, e.g., in Figure [\ref=Fig:dots]b for projection of cytochrome-c (1HRC) along m(i)11 at a cutoff energy Ecut  =   - 1.2 kcal/mol. After projection in the positive direction over about 0.25Å RMSD, m(i)11 has a large overlap with m(c)11 and also with m(c)10. After a similar projection in the negative direction, m(i)11 has only a small overlap with m(c)11, and instead has some overlap with many low-frequency modes m(c)k such as k = 8, 9, 10, 12, 13, 14. Thus, a pure mode calculated on one structure may be a mixture of multiple modes when calculated on a very similar conformation.

These results clarify that while the dot products provide useful additional information about the stability of the initial modes during the simulated motion, they are not simply correlated with loop or domain motion in contradistinction to the xRMSD.

Significance of rigidity-analysis energy cutoff

In the case of small loop motion, it is clear that lowering the rigidity-analysis energy cutoff -- thus making the structure more flexible -- increases the amplitude of flexible motion, as one might expect. The simulation of flexible motion can thus add value to rigidity analysis of protein structures by identifying the constraints that must be eliminated in order for two residues to become independently mobile. In the case of large domain motion, however, the most important criterion appears to be whether the domains are mutually rigid or not.

We can see in the case of PDI (Figure [\ref=Fig:RMSD:2B5E]) that the amplitude of flexible motion for the lowest-frequency modes is almost unaffected by the choice of the energy cutoff (Ecut) provided it is set at a reasonable value of energy cutoff which represents each domain as a number of separate small rigid clusters. This conclusion can also be drawn in the case of the ligand-gated ion channel protein.

Conclusions

We have reported a hybrid method to explore protein motion by integrating both rigidity constraints from First and directional information, in the form of low-frequency elastic network mode eigenvectors obtained using Elnemo, into the geometric simulation method Froda. The exploration brings out features of the motion that could not be inferred using First or ElNemo alone. In order to illustrate the method, we have applied it here to a diverse selection of proteins whose flexible motion ranges from small loop motion (BPTI, cytochrome-c) and large loop motion (a kinesin and an antitrypsin) to large motions of entire domains (protein disulphide isomerase and a transmembrane pore protein). Detailed studies of dynamics in relation to function of particular proteins are currently in progress [\cite=JimBVF11] [\cite=BelCM11]. The combined method can rapidly explore motion to large amplitudes in an all-atom model of the protein structure, maintaining steric exclusion and retaining the covalent and noncovalent bonding interactions present in the original structure. Significant amplitudes of motion are achieved with only CPU-minutes of computational effort even in a pentameric pore protein with more than 1600 residues. The amplitude of motion that can be achieved by flexible loops increases as the rigidity-analysis energy cutoff is lowered. For large-scale motion of domains, the most important criterion is that the energy cutoff should be low enough that different domains do not form a single rigid body. We note that RMSD, a measure of structural similarity, does not properly reflect the scale of flexible motion between different proteins; this is better captured by an extensive measure, xRMSD, which reflects both the size of the protein and the amplitude of its motion. Examination of the behaviour of the elastic network eigenvectors during the motion shows many examples of mode mixing, so that a given vector of motion can change from being a pure mode to a mixed one after quite small displacements, without losing its character as an "easy" direction for flexible motion.

We believe that the ability to explore large amplitudes of flexible motion in an all-atom model with minimal computational resources will be of great use in biochemistry, structural biology, and biophysics, as a generator of new hypotheses and intuitions about protein structure and function, and as an ally to other simulation methods such as molecular dynamics, Monte Carlo folding simulations [\cite=BurVWW11] and ab-initio simulations. Such a study is currently in preparation for PDI [\cite=JimBVF11].

Acknowledgements

We gratefully acknowledge support from the Royal Society through the India-UK International Scientific Seminar scheme. SAW thanks the Leverhulme Trust for support through an Early Career Fellowship. JEJ thankfully acknowledges EPSRC and BBSRC funding support during his PhD. The authors would like to thank two anonymous reviewers for their very helpful comments.

References

Supplementary information

Settings, input files and command line options

All simulations were carried out using the ElNemo and First software. Froda is a routine available within First. The file formats and command line options to apply a mode eigenvector as a bias in First/Froda have not previously been published in the literature, and we therefore describe them here.

The required input for all calculations is a .pdb format file containing an all-atom representation of the protein structure including hydrogen atoms, which we shall name protein.pdb. Our usual procedure is to obtain a file containing the heavy atom positions from the Protein Data Bank; to remove alternate side chain conformations and nonbonded heteroatoms including water molecules; to add hydrogens using the Reduce software, including flipping of side chains where necessary; and to renumber the atoms sequentially using PyMOL.

Normal mode calculations were carried out using ElneMo using the default setting in the pdbmat.dat input file of a 12Å cutoff in the spring network. The protein structure is given as a pdbmat.structure file, consisting of only the α carbon lines from the all-atom structure. The output is a pdbmat.eigenfacs file which, for a protein of N residues, contains 3N mode eigenvectors. Each eigenvector is described with a mode number, a frequency, and N lines each giving a Cartesian vector; the ith line is the displacement to be applied to the ith residue. The vector is normalized so that the sum of the squares of all displacement vectors is unity. The first few lines of a mode appear thus:

To pass this mode as a bias to First/Froda we prepare a mode.in file giving, for each residue, the identity of the α carbon atom for that residue in the pdb file, followed by the displacement vector. The first few lines of a mode.in file appear thus: In Froda, the first displacement vector will be applied as a bias to the motion of all atoms in the first residue, and so forth.

The command line options for First to carry out a Froda simulation with a mode bias can be given as follows: FIRST -non $PROTEIN -E -$CUT -FRODA -mobRC1 -freq $FREQ -totconf $TOTCONF -modei -step $STEP -dstep $DSTEP

Taking terms in order, FIRST is the First executable; -non is to run in noninteractive mode; $PROTEIN is the name of the all-atom .pdb format input file; -E -$CUT runs the rigidity analysis with hydrogen-bond cutoff energy -$CUT; FRODA invokes the Froda algorithm to simulate flexible motion; -mobRC1 specifies that the largest rigid cluster is to be mobile, like the smaller rigid clusters, during the simulation; -freq $FREQ specifies the frequency with which newly generated conformations are to be written to file as new conformations; -totconf $TOTCONF specifies the total number of new conformations to generate; modei specifies that mode.in should be read and applied as a bias; -step $STEP specifies the magnitude of random perturbations of the atomic positions in the generation of each new conformation; and -dstep $DSTEP specifies the magnitude of the displacement of the structure along the mode eigenvector in the generation of each new conformation.

For all our calculations we have set $FREQ to 100 so as to save every 100th conformation; we have used a $STEP of 0.1Å; and we have used $DSTEP values of 0.01Å and - 0.01Å so as to project each mode in both possible directions. Thus to explore the motion of protein.pdb at an energy cutoff of - 1.0 kcal/mol, we would use two command lines as follows

Raw vs fitted RMSD

Figure [\ref=RawvsfittedRMSD] shows the importance of using a fitted RMSD to identify and subtract correctly the rigid-body motion during a simulation. The raw RMSD values (in cyan) do not saturate, whereas the fitted RMSD values (in black) do. As presented in the figure, the evolution of the fitted and raw RMSD values shows that raw RMSD values continue to increase linearly, hence accounting for network internal motion as well as spatial rigid-body translation (cp. figure [\ref=RawvsfittedRMSD]b), whereas fitted RMSD values saturate as they account for network internal motion only (cp. figure [\ref=RawvsfittedRMSD]c). The good overlap of the conformers 5000 (orange) and 10000 (green) as shown in figure [\ref=RawvsfittedRMSD]c correspond to the only minimal increase in fitted RMSD observed in figure [\ref=RawvsfittedRMSD]a beyond conformer 5000. The two structures overlap each other along the polypeptide chain, which indicates that there is little motion between the two conformers. However, conformer 5000 and 10000 have substantially moved with respect to the initial structure, i.e. conformer 0 (black). Hence, it is clear from this comparison that we account for the rigid-body motion effect by fitting all the conformers to the initial structure.