8.5in 11in 0in 77pt .75in

Corollary Lemma

Volume growth and stochastic completeness of graphs

Introduction

Let Γ = (G,E) be an unoriented, connected, finite or countably infinite, locally finite graph. We assume that Γ has neither loops nor multiple edges. We use d to denote the graph metric on Γ; given x,y∈G, d(x,y) is equal to the number of edges in a shortest (geodesic) path between x and y. Given x,y∈G, we write x  ~  y if {x,y}∈E. We assume that Γ is a weighted graph, so that associated with each (x,y)∈G  ×  G is a nonnegative edge weight πxy which is symmetric (πxy  =  πyx for x,y∈G) and satisfies πxy > 0 if and only if {x,y}∈E. The edge weights define a measure on G by setting [formula] for x∈G, and extending to all subsets of G by countable additivity. If π(e) = 1 for all e∈E, we say that Γ has the standard weights. We denote weighted graphs by the pairing (Γ,(π(e))e∈E); for brevity we write this as (Γ,π).

On (Γ,π), we consider the variable-speed continuous time simple random walk (VSRW), which we denote by (Xt)t  ≥  0. This process has generator LX given by

[formula]

The jump probabilities for X are P(x,y)  =  πxy  /  πx; the jump times, started at a vertex x, are exponentially distributed random variables with parameter πx, so that the mean jump time is 1 / πx. This process is strong Markov. The heat kernel of X is the function [formula], defined for t  ≥  0 and x,y∈G. A good general reference for the VSRW is the upcoming book by Barlow [\cite=B]. For analytic properties of the operator LX, which is sometimes referred to as the physical Laplacian, see [\cite=We].

A weighted graph (Γ,π) is stochastically complete if the heat kernel of the VSRW on (Γ,π) satisfies

[formula]

for all t  ≥  0 and x∈G. If (π(e))e∈E are the standard weights, and (Γ,π) is stochastically complete, we simply say that Γ is stochastically complete. A weighted graph which is not stochastically complete is said to be stochastically incomplete. The heat kernel condition [\eqref=sccrit] is equivalent to X having infinite lifetime (or X being non-explosive). If [formula] are the times between jumps of X, then non-explosiveness is equivalent to having, [formula]a.s.,

Stochastic completeness is also equivalent to various uniqueness criteria for the heat equation on (Γ,π); see [\cite=Wo], and also [\cite=G2] for stochastic completeness in the related setting of Riemannian manifolds.

This paper is primarily concerned with the relationship between volume growth and stochastic completeness for graphs. Generically speaking, small volume growth ensures that the VSRW does not escape from its starting point too quickly, as it implies that the process, on average, is not too much more likely to move away from its starting point than towards it. For diffusions on a Riemannian manifold, the best possible criterion relating volume growth in the Riemannian volume and stochastic completeness of the manifold was proved by Grigor'yan in [\cite=G1] (see also [\cite=G2] for a more detailed exposition of results on stochastic completeness for manifolds), and is as follows:

(Grigor'yan, [\cite=G1]) Let M be a geodesically complete Riemannian manifold with Riemannian metric ρM and Riemannian volume V. If there exists r0  ≥  0 and x0∈M such that

[formula]

then M is stochastically complete.

This result was generalized to the setting of strongly local Dirichlet spaces by Sturm in [\cite=St]; there, the Riemannian metric is replaced by the intrinsic metric associated with the Dirichlet form. This result is not applicable to the setting of graphs, as the Dirichlet form associated with the VSRW is non-local.

Stochastic completeness of graphs has been a topic of substantial interest in recent years. Attempting to modify the techniques used in the manifold setting to the setting of graphs quickly leads to difficulties, due in large part to the fact that the heat kernel of the VSRW has very different long range behavior than the heat kernel of a Riemannian manifold (see [\cite=F1] and [\cite=G1]). The situation is further complicated by the fact that the Riemannian metric plays a different role for diffusions on manifolds than the graph metric does for the variable-speed random walk. In order to obtain a criterion analogous to Grigor'yan's manifold result, it is necessary to consider metrics which are in some sense 'adapted' to the structure of the VSRW; we will discuss the notion of adaptedness subsequently.

Previous results for stochastic completeness on graphs have focused primarily on relatively simple graphs possessing a high degree of symmetry. Numerous results for spherically symmetric graphs and trees are contained in [\cite=Wo]. Necessary and sufficient criteria for stochastic completeness of weakly symmetric graphs are established in [\cite=KLW]. Stochastic completeness of subgraphs is discussed in [\cite=KL], and [\cite=Hu1] establishes analytic criteria which are equivalent to stochastic completeness of graphs and which have analogues in the manifold setting. Criteria for stochastic completeness in the general setting of symmetric jump processes are proved in [\cite=MU]. A proof of stochastic completeness in a particular adapted metric assuming at most exponential volume growth is given in [\cite=B+2].

The recent paper of Grigor'yan, Huang, and Masamune ([\cite=GHM]), which also deals with symmetric jump processes, establishes a criterion for stochastic completeness on graphs if one considers volume growth with respect to the graph metric, as well as a volume growth criterion for stochastic completeness of graphs using adapted metrics. This criterion is also obtained via different techniques in [\cite=Hu2]. However, this result is not analogous to the manifold criterion [\eqref=VGSCM], and does not produce optimal results when compared with the exact criteria in [\cite=Wo] for spherically symmetric graphs or trees.

Our main result is as follows:

Let (Γ,π) be a weighted graph, and let ρ be a metric on Γ satisfying the following two conditions:

There exists cρ > 0 such that ρ(x,y)  ≤  cρ whenever x  ~  y.

There exists Cρ > 0 such that for each x∈G.

Denote by Bρ(x,r) the closed ball of radius r centered at x in the metric ρ, and let |  ·  | denote counting measure.

If there exists x0∈G and r0  ≥  0 such that

then (Γ,π) is stochastically complete.

An immediate consequence of this criterion is that a weighted graph is stochastically complete if there exists x0∈G and r0  ≥  0 such that that |Bρ(x0,r)|  ≤  Cecr2 log r for r  ≥  r0. This is a substantial improvement over the best previous result relating volume growth and stochastic completeness of graphs (found in [\cite=GHM] and [\cite=Hu2]), which proved stochastic completeness under the assumption that there exists x0∈G, r0  ≥  0, and c∈(0,2) such that |Bρ(x0,r)|  ≤  Cecr log r for r  ≥  r0.

The criterion in Theorem [\ref=mainresult] will be seen to yield sharp results for stochastic completeness of graphs in certain applications where necessary and sufficient conditions for stochastic completeness are known, such as birth-death chains. As Theorem [\ref=mainresult] is also analogous to the result of Grigor'yan relating volume growth with stochastic completeness on manifolds, one expects that Theorem [\ref=mainresult] is essentially the best possible criterion relating volume growth and stochastic completeness of graphs.

The condition on the metric in the hypotheses of Theorem [\ref=mainresult] appeared previously in work of the author in [\cite=F1], and has also been used in papers of Frank, Lenz, and Wingert ([\cite=FLW]) and Grigor'yan, Huang, and Masamune ([\cite=GHM]). A closely related metric is the intrinsic metric arising from the Dirichlet space construction of the VSRW, which was studied first by Davies in [\cite=D]. In light of the aforementioned result of Sturm for local Dirichlet spaces, one might expect that an analogue of Theorem [\ref=mainresult] holds using the intrinsic metric for the VSRW; we will show by a counterexample that this is not the case.

While this result deepens our understanding of the relationship between continuous time simple random walks on graphs and diffusion processes on manifolds, the overall picture is still far from clear. This paper shows that the sharp volume growth criteria for stochastic completeness on graphs and on manifolds are the same. The author has also shown in [\cite=F2] that the optimal volume growth criteria for the bottom of the spectrum of the Laplacian on graphs and manifolds are also very similar. However, the recent paper of Huang [\cite=Hu2] shows that a certain uniqueness class for the heat equation (with close connections to stochastic completeness) is very different for graphs and manifolds. As well, it has been known for some time that heat kernel behavior is very different for graphs and manifolds; while the heat kernel of a diffusion on a manifold admits a Gaussian upper bound (see [\cite=G3]), the heat kernel of a continuous time simple random walk only satisfies a Gaussian upper bound in a certain space-time region (see [\cite=F1]), and satisfies a different, 'Poisson-type' heat kernel estimate elsewhere (see [\cite=D] and [\cite=F1]). It would be useful to understand the connections between these disparate results in some sort of unified framework.

The structure of the paper is as follows. In Section [\ref=S2], we define Brownian motion on metric graphs, and compute jump probabilities and moments of hitting times for Brownian motions on weighted metric graphs. The Dirichlet form associated with these processes is strongly local, and consequently the result of Sturm relating volume growth in the intrinsic metric to stochastic completeness is applicable in this setting. In Section [\ref=S3], we discuss various metrics for the VSRW and for Brownian motion on metric graphs, with an emphasis on intrinsic metrics and adapted metrics. These metrics are compared under varying hypotheses, and an example is given showing that on graphs with unbounded vertex degrees, the intrinsic metric for the VSRW may have certain undesirable properties from the perspective of stochastic completeness. In Section [\ref=S4], given the VSRW on a weighted graph and an adapted metric, we use the adapted metric to define a weighted metric graph which has the same vertex set as the weighted graph. We show that Brownian motion on this metric graph behaves similarly to the VSRW with respect to jump probabilities and expected jump times, and that the intrinsic metric on the metric graph is larger than the adapted metric on the graph. Finally, in Section [\ref=S5], we prove Theorem [\ref=mainresult]; under the hypotheses of this theorem, our comparison results for metrics, combined with Sturm's result for stochastic completeness on local Dirichlet spaces, imply that the Brownian motion on the associated metric graph defined in Section [\ref=S4] is non-explosive. By using the estimates on various moments of hitting times for Brownian motion on metric graphs from Section [\ref=S2], we show that this implies that the VSRW is also non-explosive. We then present examples demonstrating that Theorem [\ref=mainresult] yields sharp results when applied to graphs for which necessary and sufficient conditions for stochastic completeness are known.

Brownian motion on metric graphs

This section contains a construction of Brownian motion on metric graphs, and computations of hitting probabilities and moments of hitting times for this process. These results will be used in Section [\ref=S4] to construct a Brownian motion on a metric graph which behaves similarly to a given VSRW; this will be useful in our subsequent study of stochastic completeness of graphs.

Construction

We begin with a graph Γ = (G,E). For each e∈E, we assign a positive, finite edge length [formula], and give this graph a metric structure by identifying the edge e with a copy of the closed interval

[formula]

Hitting probabilities and hitting times

This section collects several results on the hitting probabilities and hitting times of Brownian motion on metric graphs. We will work exclusively with the augmented weighted metric graph [formula]. We set

Using this definition, [\eqref=compcondloop] becomes

[formula]

Our results for hitting probabilities and hitting times will be stated strictly in terms of q because Theorem [\ref=BMjump1] and Theorem [\ref=BMjump2] are simpler to express in terms of the q conductances.

Denote Brownian motion on [formula] by (Yt)t  ≥  0. As we will not be using the VSRW in this section, there is no ambiguity in writing L: = LY.

Let the vertex x be adjacent to the vertices [formula] via the edges [formula], and to itself through the loop [formula]. We use B to denote the part of the graph containing [formula], as well as the metric edges [formula]. We also introduce coordinates on B, rooted at x; given 1  ≤  j  ≤  k and [formula], we write (j,z) for the unique point on I(ej) which is at a distance of z from x. On the loop, we choose an arbitrary orientation and write [formula] for the unique point on [formula] which is at a positive distance of z from x (according to the orientation of the loop).

We write [formula] for the first time that (Yt)t  ≥  0, started at y, hits any of [formula]. Given y∈B, we write [formula] for the probability law of (Yt)t  ≥  0 started at y, and [formula] for expectations with respect to this probability law.

We remark also that all results in this section are valid for loopless metric graphs; one needs only to replace all sums over [formula] with sums over E(x).

For 1  ≤  j  ≤  k,

Let [formula]. By general Markov process theory, u satisfies

By solving the differential equation along each edge, we obtain constants (ai)1  ≤  i  ≤  k and (bi)1  ≤  i  ≤  k such that u((i,y))  =  aiy + bi. By letting [formula], we get that bi = b for 1  ≤  i  ≤  k. On the loop, u is linear and satisfies [formula], so u is identically equal to b along the loop.

Plugging in the boundary condition shows that, for 1  ≤  i  ≤  k,

[formula]

By [\eqref=compcondloop2], since the terms corresponding to the loop vanish, we have

By multiplying the i - th equation in [formula] by [formula] and summing over 1  ≤  i  ≤  k, we obtain that

and hence

With this in hand, we may also compute from [\eqref=eq1] that for 1  ≤  i  ≤  k,

Note that in the above the edge densities (ω(e))e∈E do not appear. This is to be expected, given that changing the edge densities only causes a time-change of the Brownian motion (Yt)t  ≥  0, which cannot change the probabilities of exiting B through the vertices [formula]. Similarly, none of the quantities related to the loop edge [formula] appear, since traversing the loop does not change the probability of exiting B at a specified vertex.

The first moment of the hitting time T satisfies

Let [formula]. By general Markov process theory, v satisfies

Thus, we obtain that v((i,y))  =    -  ω(ei)y2 + aiy + bi for some constants (ai)1  ≤  i  ≤  k and (bi)1  ≤  i  ≤  k. Letting [formula], we get that bi  =  b for 1  ≤  i  ≤  k. Since [formula] for 1  ≤  i  ≤  k, we have that

[formula]

On the loop edge, since [formula], we have that

The compatibility condition [\eqref=compcondloop2] gives

As before, we multiply the i - th equation in [formula] by [formula], and sum over 1  ≤  i  ≤  k to obtain

Once we have computed b, we may compute from [\eqref=eq2] that for 1  ≤  i  ≤  k,

The second moment of the hitting time T and the variance of T are given by

[formula]

Set [formula]. Given ε  ≪  1 and a point (i,y) which is not one of the vertices [formula], we use the strong Markov property to obtain

[formula]

Rearranging as before and letting [formula], we get that w''((i,y))  =   - 4ω(ei)v((i,y)), or Lw  =   - 2v, so that the function w satisfies

The explicit form for v was worked out in the proof of Theorem [\ref=BMjump1], and hence, using the same techniques as before, one obtains the desired formulae.

Metrics for the VSRW and for Brownian motion on metric graphs

In this section, we define and compare several metrics for graphs and metric graphs. We begin with several conventions. In this section, we begin with a weighted graph (Γ,(π(e))e∈E) and the associated VSRW (Xt)t  ≥  0. We will also analyze the weighted metric graph [formula], which has the associated Brownian motion (Yt)t  ≥  0. The case of weighted metric graphs with loops, which requires virtually no changes from the regular metric graph setting, is discussed at the end of this chapter.

Given an edge e∈E, we use [formula] and [formula] to denote the initial and terminal vertices, respectively. In many situations, the orientation one chooses for edges may not matter (and one may choose an arbitrary orientation); in other situations, such as consecutive edges in a path, there will be a natural orientation.

We have already defined geodesic metrics on both (Γ,π) and [formula]. In our following work, we will need to consider metrics which arise from consideration of the stochastic processes on these spaces.

Intrinsic metrics

Both the VSRW on weighted graphs and Brownian motion on metric graphs may be defined through the theory of Dirichlet spaces; such processes have an intrinsic notion of distance associated with them.

We work first with the case of Brownian motion on [formula], and view it as the process associated with the strongly local Dirichlet form (E,D(E)) on [formula]. According to Dirichlet form theory (see [\cite=St]), there exists a measure Γ(f,g) satisfying

Set [formula]. The intrinsic metric for Y is defined by [formula]. For x∈I(e), we have

[formula]

Suppose that f∈LY. Consider the edge e; if x∈I(e), then |f'(x)|2  ≤  ω(e), so that [formula]. Consequently, if we restrict to points x,y∈G, the intrinsic metric satisfies

where [formula].

The situation is slightly more complicated when one considers the VSRW on (Γ,π). Here, the associated Dirichlet form is nonlocal. However, we can make the analogous calculations to those in the local case. The Dirichlet form is given by

and in analogy with the local case we set

so that

Set LX: = {f∈C(G):Γ(f,f)  ≤  1} and define the intrinsic metric for X by dI(x,y): =  sup {f(x) - f(y):f∈LX}. Equivalently, we have

where [formula].

Adapted metrics for the VSRW

We call a metric ρ adapted to the VSRW X on (Γ,π) if there exists Cρ  ≥  0 such that for all x∈G,

This condition has appeared previously in [\cite=F1], [\cite=FLW], and [\cite=GHM], and it has close apparent connections to the condition in the definition of EX. All weighted graphs admit an adapted metric (see the metric dV in the following section).

In a similar vein, suppose that (α(e))e∈E are positive edge weights. We say that (α(e))e∈E are adapted to the VSRW if there exists Cα  ≥  0 such that, for each x∈G,

Any choice of edge weights (even for edge weights which are not adapted) induce metrics in the following ways:

[formula]

where [formula]. Note that for any x,y∈G, [formula], where [formula] is the intrinsic metric for Brownian motion (Yt)t  ≥  0 on some weighted metric graph [formula] satisfying [formula] and ω(e) = α(e) for each e∈E.

These metrics coincide:

For all x,y∈G, d1,α(x,y) = d2,α(x,y).

Pick x0∈G and set fx0(x): = d2,α(x,x0). Then for e∈E,

so that fx0∈Eα, and consequently for x,y∈G, d1,α(x,y)  ≥  |fx(x) - fx(y)| = d2,α(x,y).

For the reverse inequality, given any ε > 0 and any f∈EX, by the definition of d2,α, there is a path [formula] with [formula],  = y such that

Taking the supremum over f∈EX and noting that ε > 0 was arbitrary, we get that for x,y∈G, d2,α(x,y)  ≥  d1,α(x,y), and consequently d1,a = d2,a.

Consequently, we write dα to denote the common value of d1,a and d2,a, and refer to it as the metric induced by the weights (α(e))e∈E. Since [formula], the induced metric associated with a set of adapted edge weights is also adapted.

Any metric ρ induces edge weights by setting [formula]; if the metric ρ is adapted, then the induced edge weights are also adapted. In turn, these edge weights induce a metric, which we denote by dρ. We refer to dρ as the metric induced by the metric ρ. It is not necessarily the case that ρ and dρ coincide; for example, if p > 1 and d  ≥  2 and ρ is the p - norm on the d - dimensional lattice [formula], then dρ is the 1 - norm on [formula].

Let ρ be any metric (not necessarily adapted), and let dρ be the induced metric. Then for all x,y∈G, ρ(x,y)  ≤  dρ(x,y).

We have that dρ(x,y): =  sup {|f(x) - f(y)|:f∈Eρ}. Given x0∈G, set fx0(x): = ρ(x,x0). Since

we conclude that fx0∈Eρ, and consequently for x,y∈G, dρ(x,y)  ≥  |fx(x) - fx(y)|  =  ρ(x,y).

The intrinsic metric for the VSRW is not, in general, adapted; see Example 2 in Section [\ref=S3.4].

Remark: We say that a metric is strongly adapted to the VSRW on (Γ,π) if there exist positive constants cρ,Cρ such that for each x∈G,

Similarly, we say that the edge weights (α(e))e∈E are strongly adapted to the VSRW on (Γ,π) if there exist positive constants cα,Cα such that for each x∈G,

These conditions will occasionally be useful in our study of stochastic completeness. In contrast to the condition of adaptedness, strongly adapted metrics (or strongly adapted edge weights) do not always exist for a given weighted graph, as will be shown in a subsequent example. While strongly adapted metrics induce strongly adapted edge weights, it is not always true that the induced metric for a given set of strongly adapted edge weights is strongly adapted.

Other metrics

We define the following additional metrics on X:

[formula]

These are the metrics induced by the edge weights (π(e)- 1 / 2)e∈E and [formula], respectively. The letters E and V reflect the fact that the metrics dE and dV are constructed using the edge weights (π(e))e∈E and the vertex weights (πx)x∈G, respectively. The metric dE was considered first by Davies in [\cite=D]; he used this metric in his study of heat kernel bounds for random walks on graphs . The metric dV is a slight modification of a metric introduced independently by the author in [\cite=F1], who used this metric to obtain Gaussian upper bounds for heat kernels of general continuous time simple random walks, and by Grigor'yan, Huang, and Masamune in [\cite=GHM].

The following results, which are so simple that we state them without proof, give simple criteria to determine when the metrics dE and dV are induced by adapted edge conductances:

Let (Γ,π) be a weighted graph. Then the edge weights (π(e)- 1 / 2)e∈E are strongly adapted (or adapted) to the VSRW if and only if vertex degrees on Γ are uniformly bounded.

Let (Γ,π) be a weighted graph. The edge weights [formula] are adapted to the VSRW. In particular, the metric dV is always adapted.

Comparing metrics

This section clarifies the relationship between the metrics dI, dE, and dV; these estimates are most useful in understanding the intrinsic metric dI, which is difficult to calculate explicitly due to its non-local nature.

For all x,y∈G, dI(x,y)  ≤  2dE(x,y).

It is immediate from the definition of EX that whenever x  ~  y and f∈EX, |f(x) - f(y)|  ≤  2π- 1 / 2xy. For any ε > 0 and any f∈EX, by the definition of dE, there is a path [formula] such that

We conclude that for all x,y∈G, dI(x,y)  ≤  2dE(x,y).

For all x,y∈G, 21 / 2dV(x,y)  ≤  dI(x,y).

Fix x0∈G. Note that fx0(x): = 21 / 2dV(x,x0) satisfies, for any x∈G,

so that fx0∈EX. Fix x,y∈G; we calculate that dI(x,y)  ≥  |fx(x) - fx(y)|  =  21 / 2dV(x,y).

Now, we impose additional conditions on the structure of (Γ,π).

Suppose that vertex degrees in (Γ,π) are uniformly bounded by CG. Then for all x,y∈G,

The rightmost inequality was proven in Lemma [\ref=Xcomp1]. For the other, we note that for x0∈G, [formula], which implies that [formula].

Suppose that there exists C > 0 such that for each e∈E,

[formula]

Then

Trivially, [\eqref=contweight] implies dE  ≤  C1 / 2dV. Combining this with Lemma [\ref=Xcomp1] and Lemma [\ref=Xcomp2] gives the desired result.

The condition [\eqref=contweight] is sometimes referred to as 'controlled weights' (see [\cite=B]). It is a stronger condition than uniformly bounded vertex degree.

We now give two families of graphs, both of which will be useful in our study of stochastic completeness. The first family of graphs shows that it is not always possible to find a strongly adapted metric on a graph. The second family shows that on graphs with unbounded vertex degree, the intrinsic metric dI may be very different from (for example) the adapted metric dV. In particular, this example shows that the intrinsic metric may fail to be adapted.

Example 1: A graph which does not admit a strongly adapted metric.

Fix an unbounded function [formula], and let [formula] be disjoint sets with |An| = r(n) and such that [formula] for each [formula]. Let Γr: = (Gr,Er) be as follows:

[formula]

Equip this graph with the standard weights. Suppose that Γr admits a strongly adapted metric ρ. Then there exist positive constants cρ,Cρ such that for each x∈Gr,

On the other hand, for each [formula],

[formula]

which is impossible since r is unbounded.

Note also that this graph is always stochastically complete, regardless of the choice of r. Every other jump is to a vertex in some An, and at such vertices, since there are only two neighbors, the mean jump time of the VSRW is 1 / 2. Consequently, the lifetime of the VSRW on this graph is infinite. This example shows that there exist stochastically complete graphs with arbitrarily large volume growth (this has been observed earlier using a different construction in [\cite=Wo]). In particular, it is not possible to obtain results for general graphs showing that sufficiently large volume growth implies stochastic incompleteness.

Example 2: Spherically symmetric trees with increasing rate of branching.

Let Γα (0 < α < 2) be a tree rooted at x0, with all vertices at a graph distance of r from x0 having k(r): = ⌊rα⌋ neighbors at a graph distance of r + 1 from x0; we equip these graphs with the standard weights.

We compute that if xR∈Γα satisfies d(x0,xR) = R, then

[formula]

Let [formula] be the geodesic (minimal length) path joining x0 and xR; we use V(γ) to denote the set of vertices in γ. For 0  ≤  j  ≤  R, we set f(xj) = j / 2. For [formula], let n(x) denote the unique y∈V(γ) satisfying d(x,V(γ)) = d(x,y), and set f(x): = f(n(x)). It is clear that f∈EX, and hence that dI(x0,xR)  ≥  R / 2.

In particular, this example shows that in general, one cannot find a constant C > 0 such that dV(x,y)  ≥  CdI(x,y), even if we restrict to x,y∈G such that d(x,y)  ≥  R for some constant R > 0. We will revisit this setting in Example 2 of Section [\ref=S5.1].

Measures

Consider the general continuous time simple random walk on (Γ,(π(e))e∈E,(θx)x∈G) given by

This process is a time-change of the VSRW, depending on the choice of the vertex measure (θx)x∈G. The invariant measure associated with this process is simply (θx)x∈G; hence for the VSRW we have that the measure of U  ⊂  G is

We have already defined the measure associated with Brownian motion on [formula]; given [formula], we have that

Notably, for an edge e, we have

Loops

Here we work with Brownian motion (Yt)t  ≥  0 on [formula] and Brownian motion (Zt)t  ≥  0 on the augmented graph [formula]. We have already noted that the Dirichlet space formulation of Brownian motion goes through unchanged when loops are added; in particular, if [formula] denotes the measure on [formula], then the restriction of [formula] to subsets of [formula] is equal to mMG; as such, there is no need to distingush between mMG and [formula]. As before, for any [formula], we have [formula].

Loops also have very little impact on the intrinsic metrics. Let [formula] denote the intrinsic metric on [formula] and [formula] denote the intrinsic metric on [formula]. As before, we have that for [formula] and [formula],

[formula]

where

[formula]

If [formula], then [formula].

First, the restriction of any g∈EZ to [formula] is in EY; as an immediate consequence [formula]. On the other hand, given f∈EY, one may extend f to [formula] by setting, at each x∈G, f(y) = f(x) for each [formula]. This extension is in EZ; consequently [formula], and hence [formula] for all [formula].

In particular, [formula] and [formula] are equal when evaluated between points of G.

Synchronizing Brownian motion on metric graphs with the VSRW

In this section, we begin with a weighted graph (Γ,(π(e))e∈E) and the associated VSRW (Xt)t  ≥  0. We investigate the question of when it is possible to find a weighted metric graph [formula] or [formula] such that Brownian motion (Yt)t  ≥  0 on this space behaves similarly to the VSRW (Xt)t  ≥  0 with respect to certain properties.

Let T be the hitting time for Y described in Section [\ref=S2]; it is the time it takes Y to hit a vertex different from the last visited one. Let [formula] be the jump time of the VSRW. We write [formula] for the law of (Yt)t  ≥  0 started at x∈G, and [formula] for the law of (Xt)t  ≥  0 started at x∈G.

Our first result concerns jump probabilities only:

X and Y have the same jump probabilities if and only if [formula] and (p(e))e∈E are chosen such that there exists λ > 0 such that for each e∈E, [formula].

Fix x∈G. Setting [formula], we obtain

This implies that there exists λ  =  λ(x) such that [formula] for e∈E(x). Given an edge e: = {u,v}, by comparing the equalities [formula] and [formula], we obtain that λ(u) = λ(v). Since G is connected, we conclude that λ is constant.

The situation for synchronizing expected jump times is more complex. We have the following necessary and sufficient criteria which shows when it is possible to synchronize the jump probabilities and expected jump times using a loopless metric graph:

We begin with a definition from graph theory:

A disjoint cycle cover of Γ  =  (G,E) is a collection of vertex-disjoint cycles in G such that every vertex in G is incident to some edge in one of the cycles. A single edge is considered a cycle.

It is possible to choose [formula], (p(e))e∈E, and (ω(e))e∈E so that X and Y satisfy, for each x∈G,

[formula]

if and only, if for every e∈E, there exists a disjoint cycle cover of (G,E) which uses the edge e.

First, by the previous result, we know that there exists λ > 0 such that (p(e))e∈E and [formula] satisfy [formula] for each e∈E.

Fix x∈G. Setting [formula], we get that

Given that (p(e))e∈E and [formula] have been chosen, we set [formula]; we then get that

In other words, the problem is to determine when it is possible to assign edge weights (c(e))e∈E to each edge of the graph so that the edge weights incident to each vertex sum to 1. By the following lemma, we see that this happens if and only if, for each e∈E, there is a disjoint cycle cover containing e in one of its cycles.

Suppose that Γ = (G,E) is a locally finite graph. It is possible to assign edge weights to each edge of the graph (G,E) so that the edge weights incident to each vertex sum to 1 if and only if, for each e∈E, there is a disjoint cycle cover containing e in one of its cycles.

We reproduce the proof at [\cite=MO]. Suppose that for each e∈E, there is a disjoint cycle cover containing e in one of its cycles. Fix an edge f, and pick a disjoint cycle cover containing that edge. For each e∈E, we define cf(e): = 1 if the edge f appears as an isolated edge in the disjoint cycle cover, cf(e): = 1 / 2 if the edge e is part of a proper cycle in the disjoint cycle cover, and cf(e)  =  0 otherwise. For any x∈G, we have [formula], and cf(f) > 0, but not necessarily that cf(e) > 0 for all edges e.

Now, let (α(e))e∈E be any collection of positive numbers satisfying [formula], and set, for each e∈E, [formula].

Note that since α(f)cf(e) > 0, c(e) > 0, and for any vertex x∈G with neighbors [formula], we have that

[formula]

as desired.

On the other hand, suppose that for each x∈G, the sum of the edge weights incident to x is 1. It is clear that the (possibly infinite) weighted adjacency matrix A is doubly stochastic, and by the Birkhoff-von Neumann theorem is a (possibly infinite) convex combination of permutation matrices, which we denote by (Pn)n∈I. Write

with an > 0, [formula]. Fix e∈E. Then the corresponding entry of A is nonzero, so some Pj must have a nonzero entry in the same place. A has zero entries on its diagonal (as (G,E) has no loops), so each Pj must also. By considering the cycle decomposition of the permutation corresponding to the matrix Pj, we see that Pj naturally corresponds to a disjoint cycle cover containing the edge e.

Remarks: 1. The condition arising in Theorem [\ref=sync1] is very unstable, as it can be destroyed by perturbing a graph very slightly; modifying any graph so that it has at least one vertex of degree 1 will make it impossible to synchronize the VSRW with a Brownian motion as in Theorem [\ref=sync1].

2. It is not difficult to see that it is always possible to synchronize the jump probabilities and jump times on [formula]; one proceeds as above and sets [formula] for all non loop edges, so that [formula] for all x∈G. One then chooses the edge weights on loops so that [formula] for all x∈G. However, the intrinsic metric for the Brownian motion that one obtains from this process may have undesirable properties.

In applications, we may be studying the VSRW on (Γ,π) with a particular adapted metric in mind. The following result allows us to construct Brownian motion on a weighted metric graph [formula] such that the VSRW and the Brownian motion have the same jump probabilities and approximately the same expected jump times, and with the additional property that the intrinsic metric for the Brownian motion is closely related to the adapted metric for the VSRW.

Let (Γ,π) be a weighted graph with adapted edge weights (α(e))e∈E. Let [formula] be the metric graph such that, for e∈E,

[formula]

and for each x∈G,

There exists Cα > 0 such that for any x∈G,

[formula]

The relation [\eqref=jump] follows immediately from Theorem [\ref=syncjump]. By adaptedness of (α(e))e∈E, there exists a positive constant Cα such that for any x∈G,

from which it follows immediately that

[formula]

so that [\eqref=moment] follows from [\eqref=SA] and [\eqref=BMjump1].

Let (Γ,π) be a weighted graph, and let ρ be a metric adapted to the VSRW. Let [formula] be the metric graph such that, for e∈E,

[formula]

and for each x∈G,

There exist positive constants cρ,Cρ such that for any x∈G,

[formula]

Additionally, if dρ is the metric induced by the edge weights [formula], then for all x,y∈G, ρ(x,y)  ≤  dρ(x,y).

This follows immediately from Lemma [\ref=rhodrho], Lemma [\ref=metricloop], and Theorem [\ref=sync2].

Remarks: 1. Theorem [\ref=sync2] is our first result where use of the augmented graph [formula] is essential. If one wishes to prove an analogue of this result on the loopless metric graph [formula] while still having control over the intrinsic metric for the associated Brownian motion, then the necessary condition on the edge weights (α(e))e∈E is not adaptedness but rather strong adaptedness. This is undesirable since strongly adapted edge weights do not exist for every weighted graph (c.f. Example 1 of Section [\ref=S3.4]).

2. Note that the choice that [formula] for all e∈E is somewhat arbitrary. Take any φ:E  →  (0, +   ∞  ). If one replaces [formula], (p(e))e∈E, (ω(e))e∈E with [formula], (pφ(e))e∈E, (ωφ(e))e∈E satisfying [formula], [formula], ωφ(e): = ω(e)(φ(e))2, then the Brownian motion on the new weighted graph behaves identically to the Brownian motion on the original weighted graph with respect to hitting probabilities and moments of hitting times.

Stochastic completeness of graphs

In this section we present general results relating volume growth in adapted metrics to stochastic completeness of (Γ,π), and corollaries specializing to the intrinsic metric dI and the adapted metric dV. These results are analogous to Grigor'yan's result on stochastic completeness on manifolds, and will be seen to produce sharp results when applied to specific graphs for which exact criteria for stochastic completeness are known. Additionally, we present an example showing that in contrast to the setting of local Dirichlet spaces, the intrinsic metric dI may be a poor metric for analyzing stochastic completeness of graphs.

We begin by compiling two results on the convergence of random series which will be used in the proof of our main results.

Convergence of random series

In this section, we let [formula] be a probability space, on which we have the sequence of random variables [formula], and the associated filtration [formula]. We define the following events:

[formula]

Two events are said to be equivalent if their symmetric difference has probability 0. We have the following two results:

(Doob, [\cite=Do]) Suppose that the sequence of random variables [formula] is nonnegative and that there exists C > 0 such that [formula] for all [formula]. Then the events A and C are equivalent.

(Brown, [\cite=Br]) The event [formula] is almost surely a subset of A (i.e., [formula]). That is, if each of the series associated with B, C, and D converge, then the series associated with A converges also.

Remark: The paper [\cite=Br] claims to prove a generalization of the Kolmogorov three-series theorem for dependent random variables. While [\cite=Br] does correctly prove that simultaneous convergence of the series associated with the events B, C, and D is sufficient for the convergence of the original series (which yields Theorem [\ref=Brown]), the proof of necessity is incorrect, and in [\cite=Gi] it is shown that there can be no general three-series theorem of this type.

Proof of the main result

Our proof uses the following criterion of Sturm which relates stochastic completeness to volume growth on local Dirichlet spaces:

(Sturm, [\cite=St]) Let (Yt)t  ≥  0 be the stochastic process associated with the strongly local Dirichlet form (E,D(E)) on L2(X,m), and denote the intrinsic metric on this space by ρ. Suppose that there exists x0∈X and r0 > 0 such that

Then (Yt)t  ≥  0 is non-explosive.

In this section, T and [formula] will denote jump times for Y and X as in previous sections.

Let (Γ,π) be a weighted graph, and let (α(e))e∈E be edge weights adapted to the VSRW on (Γ,π) such that there exists Dα > 0 satisfying α(e)  ≤  Dα for all e∈E. Let ρ be any metric satisfying ρ(x,y)  ≤  dα(x,y). If there exists x0∈G and r0 > 0 such that

then (Γ,π) is stochastically complete.

Let (Xt)t  ≥  0 denote the VSRW on (Γ,π), which has the natural filtration (GXt)t  ≥  0, let [formula] denote the jump times for X, and set [formula] and FXn: = GXHX(n).

We begin with the following lemma:

Under the hypotheses of Theorem [\ref=SC1], [formula]a.s.,

By adaptedness, there exists Cα > 0 such that for all x∈G,

We will work with the metric graph [formula], where for e∈E,

[formula]

and for each x∈G,

Let X denote the VSRW on (Γ,π) and let Y denote Brownian motion on [formula]. By Theorem [\ref=sync2], X and Y have the same jump probabilities. We begin with the process (Yt)t  ≥  0. By sampling Y each time it hits a vertex different from the last visited vertex, we obtain a discrete time simple random walk on (Γ,π), which we denote by [formula], and we use this simple random walk to construct the VSRW (Xt)t  ≥  0; this is a coupling of X and Y; in particular X and Y exist on the same probability space, so there is no need to distinguish between [formula] and [formula] (or [formula] and [formula]). Let [formula] and [formula] be the jump times for X and Y, respectively; setting [formula] and [formula], we have that

[formula]

Let [formula] be the filtration such that for each [formula], FXn: = GXHX(n), where (GXt)t  ≥  0 is the natural filtration for X. Similarly, let [formula] be the filtration such that for each [formula], FYn: = GYHY(n), where (GYt)t  ≥  0 is the natural filtration for Y.

From Theorem [\ref=sync2], for [formula],

[formula]

and for x,y∈G, ρ(x,y)  ≤  dα(x,y). By Lemma [\ref=metricloop], dα agrees with [formula] when evaluated between points of G. Thus, for all r  ≥  0, [formula]. We have that

[formula]

In particular, since [formula], the hypothesis

implies that

By Theorem [\ref=Sturm], this implies non-explosiveness of Y, and hence, [formula]a.s.,

By Theorem [\ref=Brown], for any K > 0, [formula]a.s., at least one of the following equalities holds:

[formula]

Fix K > 0. We will show that any of [\eqref=TS1], [\eqref=TS2], [\eqref=TS3] implies

[formula]

If [\eqref=TS1] holds, by Markov's inequality,

[formula]

If [\eqref=TS2] holds, we use the trivial estimate

If [\eqref=TS3] holds, we begin by noting that

[formula]

Hence

We conclude that [\eqref=TS3] implies that one of the following equalities holds:

[formula]

Suppose that [\eqref=Varsigma] holds. Note that if τn is the jump time for (Yt)t  ≥  0 started at the vertex x, then by Theorem [\ref=BMjump2],

[formula]

and hence

From this estimate, it is clear that if [\eqref=Varsigma] holds, then either [\eqref=Esigma] holds, in which case we are done, or [\eqref=E2sigma] holds. In the latter case, either the positive sequence [formula] converges to 0, in which case eventually [formula] (implying that that [\eqref=Esigma] holds), or it does not converge to 0, in which case it is clear that [\eqref=Esigma] holds also. Thus, we conclude that [\eqref=TS3] implies [\eqref=Esigma].

We conclude that [formula] [formula]a.s. implies [formula] [formula]a.s. By [\eqref=tausigma], this implies [formula] [formula]a.s. also.

At this point, we assume that the vertex weights (πx)x∈G are bounded below by Cπ > 0. We will subsequently discharge this assumption by a probabilistic argument.

Under the hypotheses of Theorem [\ref=SC1] and the additional hypothesis that the vertex weights (πx)x∈G are bounded below by Cπ > 0, (Γ,π) is stochastically complete.

By Lemma [\ref=SClem1], we have that [formula]-a.s.,

Note that [formula] and that the jump time from the vertex x is exponential with parameter πx. Clearly, πx  ≥  Cπ > 0. Then we have that

[formula]

Note that [formula]. It follows that for [formula],

and hence [formula]a.s., [formula]. Since [formula] is a uniformly bounded sequence of nonnegative random variables, Theorem [\ref=Doob] implies that [formula]a.s.,

Since [formula] pointwise, we conclude that [formula]a.s.,

and hence (Γ,π) is stochastically complete.

Finally, we remove the hypothesis that the vertex weights are bounded below. Suppose that (Γ,π) is a stochastically incomplete graph which satisfies the hypotheses of Theorem [\ref=SC1], but has vertex weights which are not bounded below.

Let H: = {x∈G:πx  ≤  1}. Consider the augmented graph [formula], where [formula] is obtained from (G,E) by adding, for each x∈H, a vertex [formula] connected to the rest of the graph only by the edge [formula]; denote these additional vertices by [formula]. The edges of the form [formula] are given weight 1.

Let [formula] denote the VSRW on [formula]. We use this to construct the VSRW on (Γ,π) via a coupling, as follows: At each vertex in [formula], [formula] and X move identically. At a vertex x∈H, [formula] eventually jumps to some vertex in [formula]. X jumps to the same vertex after waiting an exponential time with parameter πx.

We define [formula] on [formula] as follows. Given x,y∈G with [formula], we set

[formula]

Since ρ was adapted and [formula] for all x∈H, [formula] is an adapted metric on [formula] with constant at most Cρ + 1.

For any x0∈G and r  ≥  0, we have that

Consequently, [formula] satisfies the hypotheses of Lemma [\ref=SClem2], so [formula] is stochastically complete and [formula] is non-explosive.

By hypothesis, X explodes with positive probability, and we denote the event on which this occurs by SIX. Given U  ⊂  G and [formula], TXU is the total amount of time X spends at vertices of U, and similarly [formula] is the total amount of time [formula] spends at vertices of V.

On SIX, we have that

Clearly [formula] on SIX. Since X and [formula] move identically on [formula], this implies that [formula] on SIX.

Next, we use the fact that TXH  <    ∞   on SIX. Since the times between jumps for the VSRW are independent of the jump directions, the times between jumps from vertices in H are independent exponentially distributed random variables with mean at least 1. By the second Borel-Cantelli Lemma, an infinite number of visits to H would cause X to spend an infinite amount of time at vertices of H, and have infinite lifetime, which would be impossible. So on SIX, X visits H only finitely many times.

Using the coupling, each visit to a vertex x∈H by X is associated with an initial visit to x by [formula], as well as a geometrically distributed (finite) number of additional visits to x and [formula] by [formula] (before [formula] visits [formula] again). The times between all of these jumps for [formula] are independent exponentially distributed random variables with mean at most 1; consequently, their sum is finite. Since [formula] only visits H and [formula] finitely many times on SIX, we conclude that on SIX, [formula] and [formula].

Thus, on SIX,

Consequently, [formula] explodes with positive probability, contradicting the stochastic completeness of [formula].

Combining this argument with Lemma [\ref=SClem2], we conclude that under the hypotheses of Theorem [\ref=SC1], (Γ,π) is stochastically complete.

Let (Γ,π) be a weighted graph, and let ρ be a metric adapted to the VSRW on (Γ,π) such that there exists Dρ > 0 satisfying ρ(x,y)  ≤  Dρ whenever x  ~  y. If there exists x0∈G and r0 > 0 such that

then (Γ,π) is stochastically complete.

Upon noting that the edge conductances [formula] are adapted and uniformly bounded above, this follows from Corollary [\ref=sync3] and Corollary [\ref=SC1].

Let (Γ,π) be a weighted graph with uniformly bounded vertex degrees and edge weights uniformly bounded below. If there exists x0∈G and r0 > 0 such that

then (Γ,π) is stochastically complete.

Set α(e): = π(e)- 1 / 2 for e∈E. By Lemma [\ref=SA1] and the hypothesis of edge weights uniformly bounded below, the hypotheses of Theorem [\ref=SC1] are satisfied, and by Theorem [\ref=Xcomp1], for x,y∈G, dI(x,y)  ≤  dE(x,y)  =  dα(x,y), so the result follows from Theorem [\ref=SC1].

Let (Γ,π) be a weighted graph such that the vertex weights (πx)x∈G are bounded below. If there exists x0∈G and r0 > 0 such that

then (Γ,π) is stochastically complete.

This is an immediate consequence of Lemma [\ref=SA2] and Corollary [\ref=cor1].

Given a weighted graph (Γ,π), we define dW to be the metric induced by the edge weights [formula]. It is clear that dW  ≤  dV, so dW is always adapted, and also that dW(x,y)  ≤  1 whenever x  ~  y.

Let (Γ,π) be a weighted graph. If there exists x0∈G and r0 > 0 such that

then (Γ,π) is stochastically complete.

This is an immediate consequence of Corollary [\ref=cor1].

Remarks: 1. The analogue of Sturm's result relating stochastic completeness with volume growth in the intrinsic metric is false; see Example 2 in Section [\ref=S5.1] for an example where the VSRW is stochastically incomplete but where [formula]. On graphs with unbounded vertex degree and sufficiently poor connectivity properties (in the sense that there are very few geodesic paths joining vertices), the intrinsic metric is not adapted to the VSRW. Indeed, in Section [\ref=S3.4] we gave an example in which the VSRW moves very quickly but the intrinsic metric is approximately equal to the graph metric. Consequently, it appears that the intrinsic metric is not the right metric to use for studying stochastic completeness of graphs, and that adaptedness or strong adaptedness is the relevant condition, particularly in light of Corollary [\ref=cor1]. It would be interesting to determine conditions under which the intrinsic metric is adapted to the VSRW for graphs with unbounded vertex degree.

2. None of the Theorems and Corollaries in this section use the notion of strong adaptedness. However, the lower bound appearing in the definition of strong adaptedness ensures that the metric cannot be unnecessarily small, which would in turn cause the volume growth to be unnecessarily large. If the metric ρ fails to be strongly adapted, the resulting criteria one obtains for stochastic completeness may be far from optimal. See the remark following Example 2 in Section [\ref=S5.1].

3. These techniques and results are also applicable to the general continuous time simple walk with generator Lθ defined in Section [\ref=S3.5]; call this process (Zt)t  ≥  0. Here one works with edge weights (β(e))e∈E which are bounded above and adapted to this random walk, i.e., weights satisfying, for all x∈G,

One constructs the associated Brownian motion as in Theorem [\ref=sync2], and sets [formula], [formula], [formula] for x∈G. The techniques of this section allow one to prove the analogue of Theorem [\ref=SC1] for (Zt)t  ≥  0, using the invariant measure described in Section [\ref=S3.5] and considering volume growth in any metric ρ such that ρ(x,y)  ≤  dβ(x,y) for all x,y∈G. However, this criteria may not be very useful. For example, if θx  =  πx, the associated random walk (which is referred to as the constant-speed continuous time simple random walk, or CSRW, and which jumps at exponentially distributed times with mean 1) is always stochastically complete, regardless of volume growth.

Examples

In this section, we present several examples which demonstrate how one can use Theorem [\ref=SC1] and its various corollaries to quickly determine sharp stochastic completeness criteria for various graphs.

Example 1: Stochastic completeness of the birth-death chain. We have [formula], where [formula], and we assign weights (π(e))e∈E satisfying πn,n + 1  =  (n + 1)2 log β+(n + 1) for 0  ≤  β < 2, where [formula]. We use the metric dV for ease of computation. As R  →    ∞  ,

and hence [formula]. By Corollary [\ref=cor2] or Corollary [\ref=cor3], we conclude that if 0  ≤  β  ≤  1, then (Γ,π) is stochastically complete. This result may be seen to be sharp; by Example 4.12 of [\cite=Wo], (Γ,π) is stochastically incomplete if and only if

[formula]

Plugging in πn,n + 1  =  (n + 1)2 log β+(n + 1) with 0  ≤  β < 2, we see that [\eqref=SCBD] occurs precisely when 1 < β < 2.

Example 2: Stochastic completeness of spherically symmetric trees.

The construction of these objects was done in Example 2 in Section [\ref=S3.4]. Let Γα be a tree rooted at x0, with all vertices at a graph distance of r from x0 having k(r): = ⌊rα⌋ neighbors at a graph distance of r + 1 from x0 for 0 < α < 2. We equip these graphs with the standard weights. Clearly vertex degrees are unbounded in this setting.

As before, we use the adapted metric dV for ease of computation. We previously computed that if xR∈Γα satisfies d(x0,xR) = R, then [formula]. Hence if [formula], then [formula]. As well, [formula], so that

[formula]

From Corollary [\ref=cor2], we conclude that Γα is stochastically complete if α  ≤  1. By Remark 4.3 of [\cite=Wo], the exponent 1 is sharp; if α > 1 then Γα is stochastically incomplete.

Note that in this setting the metric dV is strongly adapted. Now, suppose that we work on Γ1 with a different choice of metric. Given 1 < β < 2, we consider the metric dβ induced by the edge weights cβ(e) = r-  β / 2 if [formula]; these weights are adapted but not strongly adapted. Proceeding as above, we obtain that [formula]; this gives

even though Γ1 is stochastically complete. Consequently, this adapted metric does not give sharp volume growth criteria.

This family of graphs also yields an interesting counterexample. We previously computed that [formula], and it follows that for any α > 1

from which it follows that

even though Γα is stochastically incomplete. Comparing this result with Theorem [\ref=Sturm] shows that the relationship between volume growth in the intrinsic metric and stochastic completeness on graphs is different than the corresponding result for local Dirichlet spaces.

Acknowledgements: The author thanks the following individuals for their detailed reading of the manuscript and helpful comments. Martin Barlow suggested this problem, answered many questions relating to the theory of Dirichlet spaces, and provided detailed feedback on many revisions of this paper. Ed Perkins gave several useful suggestions. Pat Fitzsimmons informed the author of the error in the main result of [\cite=Br], which rendered the original proof of Lemma [\ref=SClem2] invalid.