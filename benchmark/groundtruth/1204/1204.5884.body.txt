Unicity Distance of Quantum Encryption Protocols

Lemma Conjecture Corollary Proposition

Introduction

Shannon provided the concept of unicity distance in 1949[\cite=sha49] . He showed a way of calculating approximately how many ciphertexts were necessary to recovery the unique key for the classical encryption protocols, the length of ciphertexts needed was determined by the entropy of the key space and the redundance of the plaintext space. This parameter can be used to measure the number of times one key can be reused securely, while the length of ciphertexts encrypted by same key is not more than the unicity distance, this key can not be confirmed under the Known Ciphertext Attack(KCA). According to Deavours, the unicity distance of DES is worked out as 8.2 ASCII characters or 66 bits[\cite=Dea77] [\cite=Sch96] . Mao and Wu[\cite=Mao07] used the unicity distance to analyse the security of hashing algorithms, Liu, Zhang and Li[\cite=Liu10] then develop it into multimedia hash scheme.

The quantum key distribution has been proved to be unconditionally secure and applied in practice[\cite=Eke91] [\cite=Lo95] [\cite=Deu96] [\cite=May96_QKD] [\cite=May01]. Though it is seem that quantum one-time pad(which usually called private quantum channel[\cite=Amb00] [\cite=Amb04] [\cite=Boy03]) can be achieved theoretically with the quantum key distribution, we still need to consider the repetition of key for the well-known low efficiency of the quantum key distribution. The unicity distance of quantum encryption protocols represents the theoretical limitation of how many times a key can be reused in quantum context. The unicity distance of a quantum encryption protocol can be used to measure its efficiency and the security in practice.

Preliminaries

Private key encryption protocol

The private key encryption protocols can be divided into five different kinds based on that if the plaintext space, the key space, and the algorithm are belong to classical or quantum context, we present the classification as follows:

The plaintext and key are both classical, the algorithm is also classical.

The plaintext and key are both classical, but the algorithm is a quantum one(CCQ).

The plaintext is classical, but the key and the algorithm are quantum ones.

The plaintext is quantum, the key is classical, but the algorithm is a quantum one.

The plaintext, the key, and the algorithm are quantum.

Within this classification, the first kind of protocol is the protocol generally called classical encryption protocol, and the other four kinds of protocol are all called quantum encryption protocols. This classification is not based on the ciphertext space, because we think the ciphertext space's should be coincident with the algorithm. Furthermore, we think the classical algorithm can not be played on quantum states, so the algorithm of a protocol with quantum states must be quantum operation. More detailed discussions about this classification will be presented in our further work.

Shannon's unicity distance is presented in classical context. In this paper, we discussed about the unicity distance of the second kind of protocol with classical plaintext and key space and quantum algorithm, we call it unicity distance of CCQ encryption protocol.

Information-theoretic security

In classical cryptography, the information-theoretic security is suggested by O. Goldrich [\cite=Gold04] as follows:

An encryption is information-theoretically secure if for every circuit family {Cn}, every positive polynomial p(  ·  ), all sufficiently large n's, and every x,y in plaintext space:

[formula]

where G is a key generation algorithm.

We have suggested a definition of information-theoretic security of quantum encryption[\cite=Cho12] as follows:

A quantum encryption is information-theoretically secure if for every quantum circuit family {Cn}, every positive polynomial p(  ·  ), all sufficiently large n, and every x,y in plaintext space:

[formula]

where the encryption algorithm E is a quantum algorithm, and the ciphertext E(x),E(y) are quantum states.

And the following theorem shows a way to prove a quantum encryption scheme is information theoretically indistinguishable:

For every plaintexts x and y, let the density operators of cipher states G(1n)(x) and G(1n)(y) are ρx and ρy, respectively. A quantum private-key encryption is said to be information theoretically indistinguishable if for every positive polynomial p(  ·  ) and every sufficiently large n's,

[formula]

Unicity distance

The Shannon's unicity distance is a crucial quantify for evaluating the security of a private key encryption protocol. There are some paraments related to it:

n1(y): while the length of a given ciphertext y reachs n1(y), the attacker can determine the key from it.

n2, [formula]: it is the average length of ciphertext necessary for the attacker to determine the key.

n3(a lower bound of n1): if the attacker wants to obtain the key, the length of ciphertext required must not less than n3.

n4(an upper bound of n1): when the attacker owns a ciphertext with length n4, he can determine the key.

n5(a lower bound of n2): according to information theory and properties of function, n2 is proved bigger than n5.

It must be noticed that the generally proved unicity distance [formula] is indeed a n5, so people always need more ciphertexts to get the unique encryption key.

Based on the definition of unicity distance, it can be seen that if the ciphertext eavesdropper Eve owned is longer than the unicity distance, it can only be decrypted into a meaningful plaintext with the unique encryption key, but decrypt into meaningless message with any other keys. Which means the ciphertext sets encrypted from the same set of meaningful plaintexts with different keys must be almost mutually disjoint sets.

Classical encryption protocols have a property that its decryption process is certain, which means every time we decrypt the same ciphertext with the same key will result the same plaintext; however, the quantum encryption protocols have a certain decryption result with the unique right key but a uncertain decryption result with a random bit-string. It means that a quantum encryption protocol may not have unicity distance even if its ciphertext sets encrypted from the same set of meaningful plaintext with different keys are almost mutually disjoint sets.

Analogy with the proof for classical unicity distance, we can give a similar proof for quantum unicity distance:

Let the quintuple (P,C,K,E,D) is a CCQ encryption scheme, then we have

[formula]

where ρP,ρK,ρC are the density operators of the plaintext space, key space, and ciphertext space respectively, S(ρ) expresses the Von Neumann entropy.

Remark: The elements of a classical space can be regarded as quantum states coded by a set of standard orthogonal bases, so we can get the density operator of a classical space.

Proof: According to the property of Von Neumann entropy, we have

[formula]

In order to decrypting the ciphertext successfully, the encryption algorithm is always a unitary operator, which is named as UE. So

[formula]

then

[formula]

[formula]

Thus the lemma follows. [formula]

We define P = {0,1}l,C is a l-qubits space, let the redundancy of plaintext be RL, so we get:

Let the quintuple (P,C,K,E,D) is a CCQ encryption scheme, given a long enough (length is n) ciphertext, the expectation [formula] of spurious key satisfies

[formula]

Proof: For a given Y∈Cn, the number of spurious key is |K(Y)| - 1, so

[formula]

Based on Lemma [\ref=lem1]

[formula]

here S(ρCn)  ≤   log (2l  ×  n) = l  ×  n, S(ρK) = H(K), and while plaintext is long enough, S(ρPn) = H(Pn) = n(1 - RL)  ×  l.

Then we get

[formula]

On the other side, for every given Y∈Cn, S(ρK|ρY)  ≤  log|K(Y)|, so

[formula]

Thus the theorem follows. [formula]

Then we can get

[formula]

as the result of theorem [\ref=the1], which means if [formula], we can get

[formula]

However, this result is not relevant to the quantum ciphertext-only attack for the properties of quantum information is rather different from classical information in very basic aspect. Obtaining a classical message is the same as knowing what it is, but it does not mean right in a quantum situation. Once we get a unknown quantum state which would be one of some non-orthogonal states, the properties of quantum mechanical determine that we can not accurately distinguish it. Here we must distinguish two relations between quantum states and people:

"A quantum state in one's mind":

A quantum state in one's mind indicates one knows the mathematic expression of the state, or the process preparing it exactly.

"A quantum state in one's hand":

A quantum state in one's hand indicates one owns the quantum register which contains the qubits. Generally speaking, one cannot know what the state is according to basic principles of quantum theory.

In practice, the attacker can only get a quantum register with the ciphertext state, rather than a mathematical expression of the state, so we need to consider the concept of quantum unicity distance(QUD) for CCQ encryption protocols under this situation, and it must be bigger than Ineq. ([\ref=ineqn2]).

Quantum extension of unicity distance for CCQ encryption protocol(QUD)

According to a CCQ encryption scheme, assume the key is k0 with length n, the plaintext is i∈P, then the encryption process Ek0 is shown as:

[formula]

So Ekk0  =  〈k|UE|k0〉 is the operation element for Ek0, it satisfies that:

[formula]

Where the first equality is the completeness condition, and the second equality is a new relation for the encryption process.

We rewrite the expression as:

[formula]

The density operator of ciphertext for sender then is shown as:

[formula]

the density operator of ciphertext for receiver is shown as:

[formula]

and the density operator of ciphertext for attacker is shown as:

[formula]

QUD1

The accessible information for the attacker with the quantum ciphertext in hand is bounded by Holevo χ quantity of the state:

[formula]

where H(M:I) is the information achieve from the ciphertext. So we can use χ to analyze the security of the quantum encryption protocol. While the length of ciphertexts is n, we can get

[formula]

where S(  ·  ) is the Von Neumann entropy, ρE is the density operator of ciphertext for attacker, and

[formula]

where probabilities qi is determined by the plaintext space, and pk0 is determined by the key space.

Based on the theorem about the upper bound on the entropy of a mixture of quantum states [\cite=Nie03], We can have

[formula]

then the information of the key is limited by

[formula]

Similarly, since [formula] is a pure state(while a particular plaintext and a key is given, the ciphertext is a pure state), we have

[formula]

then

[formula]

It can be seen that, while reusing private key k0 to encrypt plaintexts, suppose the length of the ciphertexts is n, S(ρE) - χ(n) will be increasing as the length of plaintext encrypted cumulated, though H(K) is keeped the same. So there must be a bound n0 which satisfies that the accessible information of K is almost H(K) in a range of errors less than any given small amounts. With this knowledge we give the first definition of QUD as follows:

For a quantum encryption protocol, we call n0 is the quantum unicity distance if it is the lower bound of the length of ciphertext, which satisfies:

[formula]

This definition means that if the accessible information of the key from the quantum ciphertext is near sufficiently the entropy of the key, the key can be determined. Here we should point out that, the classical unicity distance can also be explained in this way. From Ineq. ([\ref=ineqn2]), we can get nl - nl(1 - RL)  ≥  H(K), which is also means the accessible information of the ciphertext is greater than the information of plaintext and key, as the accessible information of a classical bit string is equal to its number of bits. However, there is an important difference between QUD1 and the definition of classical unicity distance: the classical unicity distance is always limited if the redundancy of plaintext is not zero, while the QUD1 may be unlimited for the same plaintext.

QUD2

We can define the unicity distance of CCQ encryption protocol referring to Shannon's unicity distance, it turn out this result: the spurious key of a quantum ciphertext Y may be defined as the bit-string with which decrypting Y result a meaningful plaintext. But under quantum mechanical, the result of the decryption with a random bit-string should be have many possibilities, then the spurious key must make every possibility of the result being a meaningful plaintext, which is difficult to satisfy; on the other hand if we decrypt ciphertext with a random bit-string, the most possible condition should have some meaningful results and others meaningless. So we need to give a new definition for unicity distance of CCQ encryption protocol.

The spurious key of the unicity distance of CCQ encryption protocol is the bit-string except the unique key k0 with which decrypting ciphertext Y may result a meaningful plaintext with probability more than 1 - δ. Let's define set Z as the set of meaningful plaintexts, M is the measurement, the spurious key of Y can be represented as follow:

[formula]

For a quantum encryption protocol, if there exists a N satisfying that while the length of ciphertext is bigger than N, the amount of quantum spurious key is 0, we will call N the unicity distance of CCQ encryption protocol.

Notice that a classical ciphertext can be used any times to verify all keys but a quantum ciphertext can only be used once, so unicity distance of CCQ encryption protocol should contain two components: the length of ciphertext with which we can verify if a bit-string is the key and the size of the key space. These will be addressed in more detail later in this article.

QUD3

This definition of QUD2 is suited for deriving the unicity distance of a given quantum encryption protocol, but it is difficult to derive the unicity distance of a formalized quantum encryption protocol. Therefore we give another definition of unicity distance of CCQ encryption protocol.

Let n is the length of quantum ciphertext Yn, the amount of its quantum spurious key is:

[formula]

where Dk is decryption transformation with key k, Zn contains all the elements with length n of Z, and P(n) is the projection operator of Zn. Then the unicity distance is defined as follow:

For a quantum encryption protocol, if there exists a N satisfying that while the length of ciphertext n is bigger than N, |K(Yn)| = 1, we will call N the unicity distance of CCQ encryption protocol.

Examples and discussions

Quantum encryption protocols with finite unicity distance(QUD2)

Probabilistic encryption[\cite=God84] is also called randomized encryption. A process of probabilistic encryption E can be shown as follow:

[formula]

where Vm and Vn are plaintext space and ciphertext space with m  ≤  n, K is the key space and R is a set of random numbers.

The probabilistic encryption protocols maps one plaintext into different ciphertexts with the same key, so it can resist chosen plaintext attack better, and increase the effective size of the plaintext space.

Here two quantum encryption protocols are both probabilistic protocols. We will give their unicity distance based on QUD2.

The protocol A

For simplicity, we consider bitwise encryption. We use key k∈{0,1}l to encrypt a bit x under following protocol:

The encryption: we randomly choose a bit-string [formula], satisfies [formula]. The bit x is encrypted to be [formula]. Here

[formula]

The decryption: we measure each qubit with bases determined by ki, which will result bi, then [formula].

The security of this protocol is proved in [\cite=Yan12].

For the convenience of analysis, we assume the plaintext is the codewords being encoded with error correcting code(ECC) C, here C is a (m,k)-ECC which can correct t-bit error. Then the minimum distance between each m-bit codewords is 2t + 1. Let the length of key is m  ×  l, make every l - bit used to encrypt one bit of plaintext as a group, so the key can be divided into m groups. For any m  ×  l-bit-string, we can divide it into m groups similarly. It is easy to find that once there exists any differences between the string and the key in one group, the decryption of this group will result of 0 or 1 with both probability of 50%, so we may just consider the number of groups with differences, named m0. Let pe is the probability of checking one m  ×  l-bit-string.

While m0 < 2t + 1, one m  ×  l-bit-string can not be checked out if and only if every group of string with error results out the right plaintext with probability 50%. When checking this kind of key with ciphertext whose length is n  ×  m,

[formula]

While [formula], an error key may result out 2m0 different ciphertexts, there are at least 22t invalid ciphertexts. When checking this kind of key,

[formula]

Let security parameter is p0 = 1 - δ, if we want to satisfy pe  ≥  p0 with every m0: if m0 < 2t + 1, it turns out [formula]; else it turns out [formula].

Note that we need to check every key with the maximum n, so

[formula]

Then the unicity distance for p0 is N = n0  ×  2m  ×  l.

It was proved that m  ×  l-bits key just can encrypt [formula]-bits plaintext[\cite=Amb00] [\cite=Boy03]. The gap between [formula] and N is much bigger than that of classical encryption protocols.

The protocol B

We first consider bitwise encryption. Using the following scheme to encrypt every bit with key k∈{0,1}l.

Encryption: Alice chooses i∈{0,1}l randomly. A bit x is encrypted to be

[formula]

Decryption: Suppose the key [formula], randomly choose one bit of k whose value is 1. Here we assume the jth bit of k is chosen. First we do controlled-NOT operation to each bit of ciphertext but the jth bit, the control bit of each operation is always the jth bit. Then we measure the kth bit with basis |  ±  〉. If the result is | + 〉 we have x = 0, else x = 1.

Note that here k should not be a zero-string.

Similar to the proof in article[\cite=Jia10] [\cite=Hay08], we denote the density operator of the ciphertext as ρ(x,k), then we have:

[formula]

where b∈{0,1}.

While we encrypt a bit-string [formula], the density operator of the ciphertext for attacker can be shown as

[formula]

If for every positive polynomial p(  ·  ), there exist a sufficiently large N satisfy that while n > N, [formula], the protocol will be information-theoretically secure.

Proof: Define

[formula]

For every [formula], [formula],[formula],, we have

[formula]

As [formula] and [formula], we have:

[formula]

which means for every x,

[formula]

so we can get the following inequality:

[formula]

Based on the Theorem.[\ref=information], we can say that the protocol is bound information-theoretically secure. [formula]

We also assume the plaintext is the codewords being encoded with error correcting code(ECC) C as above. Let the length of key is m  ×  l and use every l-bit of the key as a group to encrypt one bit plaintext, it can used to encrypt m-bits plaintext once. When the length of the plaintext more than m bits, we repeat this process and reuse the key.

The protocol B has a property as follow:

Proof: Let [formula] is the unique key.

The ciphertext then can be expressed as

[formula]

Let [formula] is another random bit-string. Without loss of generality, we assume [formula], [formula], [formula], [formula]. Let the control bit chosen by him is the jth bit.

If kj = 1.

For example, he chooses k'(1), and use the first bit of ciphertext as the control bit, there exists two cases.

If i(1) = 0, after the first step of decryption, the result is:

[formula]

If and only if t = s = r, which means k' = k, he can make sure the value of b when measuring the control bit with |  ±  〉 basis, otherwise, there should exist another bit entangled with the control bit, then its reduced density operator can be expressed as

[formula]

so if he measures it with |  ±  〉 basis, he will get 0 or 1 with same probability.

If i(1) = 1, after the first step of decryption, the result is:

[formula]

The same as the first situation, the property follows.

If kj = 0.

For example, he chooses k'(r + 1), and uses the (r + 1)th bit of ciphertext as the control bit, there also exists two cases.

If i(s + 1) = 0, after the first step of decryption, the result is:

[formula]

While the control bit is |0〉 and independent from other bits here, the attacker measures it with |  ±  〉 basis, he will get 0 or 1 with same probability.

If i(s + 1) = 1, the same as the above situation, after the first step of decryption, the control bit is |1〉 and independent from other bits.

Thus the property follows. [formula]

This property means that once there exists any errors in one group, the decryption will result of 0 or 1 both with probability 50%, so we may just consider the number of groups with errors, named m0. Let pe is the probability of verification of that if one (m  ×  l)-bit-string is the key.

Similarly as above, if m0 < 2t + 1, it turns out [formula]; else it turns out [formula].

Then the unicity distance for p0 is

[formula]

here |K| = 2m  ×  l is the size of the key space.

Quantum encryption protocol with infinite unicity distance(QUD2)

We know the quantum one time pad has infinite unicity distance based on its unconditional security, besides this we suggest in Sec. [\ref=sec1] that the definition of QUD1 may lead to infinite unicity distance. Here we present another idea which also designs a quantum encryption protocol with infinite unicity distance under definition of QUD2. For this protocol, the ciphertext with any length can not be used to check more than one bit-string. The protocol is shown as follow:

The plaintext X is a classical bit-string with length [formula], [formula], xi∈0,1.

Firstly X is encoded into [formula]. Its vector notation is

[formula]

only one row of the last vector is 1 and the other 2n - 1 rows is 0.

Then the protocol may generate a quantum operator Ek,n determined by the key k and the length n:

[formula]

The ciphertext |φY〉  =  Ek,n(|φX〉) is a qubit-string. Assume the lth row of |φX〉 is 1, then the vector notation of |φY〉 can be shown as:

[formula]

They satisfy that each qubit of |φY〉 should be entangled with others.

According to this kind of protocol, the length of k is not increase with increasing of plaintext, and the n is said to be open for the attacker, so the number of keys that need exhaustive is remain the same. It means this protocol is different from one-time pad protocol. On the other hand, Bob has the right key k and is able to decrypt the ciphertext. Meanwhile, once the attacker Eve tries to decrypt the ciphertext with any bit-string k', all the qubits will collapse, which means no matter how long the plaintext is, Eve can only check that if one bit-string k' is the key. In other words, this kind of protocol also has infinite unicity distance.

The key point to this kind of protocol is that, how to design a scheme as follow: the scheme can generate a quantum operator Ek,n that can be applied to a qubit-string with length n for every n, Ek,n should be determined by k with limited length, and each column of the matrix of Ek,n cannot do direct product decomposition.

In fact, the last condition can be changed into that the matrix of Ek,n cannot do direct product decomposition.

On the other hand, there exists some properties that may reduce the unicity distance for quantum encryption protocols. If a quantum encryption protocol for whom every ciphertext decrypted with any key will result a computational basis, its unicity distance can be reduced greatly. Because we can use one ciphertext string to check every key again and again with this kind of quantum encryption. The existence of this encryption has not been proved, but all the classical encryptions belongs to this group in a sense.

Discussions

Our analysis of unicity distance of CCQ encryption protocol above is only for one kind of quantum encryption protocols, the unicity distance of other three kinds of quantum encryption protocol will be discussed in the further research. We derived the unicity distance according to the given quantum encryption protocols, these results need some precondition such as the expression of plaintext space, so how to derive the unicity distance of a formalized quantum encryption protocol is still an open problem.

Note that there is a big gap between the condition of the Private Quantum Channel and the unicity distance of the given protocols, this would be a normal behavior, so how can we define a protocol is secure in practice(not perfect secure) is worth to discuss.

Conclusion

We classify encryption protocols into five types, then we present a definition of the unicity distance of CCQ encryption protocol(the encryption protocols whose plaintext and key are classical but algorithm is a quantum one). We show that we can not completely copy the proof of classical unicity distance to prove quantum one, then we present three useful definitions of quantum unicity distance.

In classical context, a encryption protocol must have unicity distance while the key is reused and the plaintext has nonzero redundancy, so we can tell that only one time pad can lead to infinite unicity distance while a language always has nonzero redundancy. In Quantum context, quantum one time pad(PQC) also has infinite unicity distance, we suggest that based on QUD2 there may exist other quantum encryption protocols which also has infinite unicity distance besides quantum one time pad, it is very different from classical one.

Acknowledgment

This work was supported by the National Natural Science Foundation of China (Grant No. 61173157).