Lemma Proposition Corollary Remark

Target-point based path following controller for a car-type vehicle using bounded controls

Abstract

In this paper, we have studied the control problem of target-point based path following for car-type vehicles. This special path following task arises from the needs of vision based guidance systems, where a given target-point located ahead of the vehicle, in the visual range of the camera, must follow a specified path. A solution to this problem is developed through a non linear transformation of the path following problem into a reference trajectory tracking problem, by modeling the target point as a virtual vehicle. Bounded feedback laws must be then used on the real vehicle's angular acceleration and the virtual vehicle's velocity, to achieve stability. The resulting controller is globally asymptotically stable with respect and the proof is demonstrated using Lyapunov based arguments and a bootstrap argument. The effectiveness of this controller has been illustrated through simulations.

Introduction

In the field of autonomous vehicle guidance, navigation and control, path-following problem of car-type vehicles is of particular interest. Many contemporary researchers have published various techniques and strategies for this problem, such as [\cite=SamsonAit] [\cite=consolini1] [\cite=Jiang] [\cite=Samson] [\cite=Egersted] [\cite=Bianco_2004]. Among open-loop motion planning techniques, differential flatness approach has been significant in motion planning to drive vehicles on Cartesian paths [\cite=Fliess] [\cite=Rouchon]. In feedback control techniques, larger effort has been made on tracking problems. A backstepping approach has been presented in the context of tracking in [\cite=Jiang2]. This approach has also been used in [\cite=Changboon], to develop a controller that is robust against vehicle skidding effects. Do et al. have further improved upon Jiang's backstepping method in [\cite=K_DO2_2004] and [\cite=K_DO1_2004], by adding observers to render the controller output-feedback and extending it to tracking and stabilization for parking problems of a vehicle and introducing dynamic update laws to compensate for parametric uncertainty and modeling errors. In [\cite=Aguiar] Aguiar et al. have used adaptive switched supervisory control combined with a non linear Lyapunov-based control to ensure the global convergence of the position tracking error to a small neighborhood of the origin. Bloch and Drakunov [\cite=Bloch1996] have used sliding mode control for the stabilization and tracking of a nonholonomic dynamic system. This controller is global and ensures convergence to the neighborhood of the desired trajectory. Lee et al. [\cite=Lee2001] have proposed a saturated feedback controller for tracking of a unicycle-type vehicle, using its forward velocity and angular acceleration as control inputs. They have also extended this controller for application on car-type vehicles.

The problem of path following differs from pure stabilization or tracking problems because the path, described by its curvature κ(.), is defined in space only, not in time. In this paper, we have addressed the path following control of a robot car-type vehicle using target point. This control problem arises from camera-vision applications [\cite=broggi] [\cite=Piazzi1], where the vehicle is guided by a target point ahead of the vehicle, within the visual range of the camera [\cite=Bertozzi1] [\cite=broggi]. The target point is fixed at a known distance d > 0 from the center of gravity on the axis of the vehicle. The control objective is to drive the vehicle, such that the target point follows the desired path (as shown in Fig. 1). This problem has been addressed in [\cite=consolini2] where a local robust path following strategy has been proposed using target point. Their solution is based on an open loop control based on inversion of the nominal model, and a closed loop control for stabilization of the resultant system. The error dynamics have been expressed in the Frénet frame associated to the followed path. This technique, also discussed in [\cite=MS], is convenient only when the vehicle is close, positioned and oriented to the path.

In our work, a global asymptotically stable controller is developed by parameterizing the path as a "virtual vehicle", which is tracked by the actual vehicle. In this way, the path following problem is converted into a tracking problem, with two control inputs: the angular acceleration of the real vehicle and the velocity of the virtual vehicle. The forward velocity control of the real vehicle is not considered as part of the navigation problem, as it is controlled by other intelligent control systems in practical applications (for example, ABS, ESP [\cite=pasillias]). It is instead assumed to be a measured state that is strictly positive, meaning that the vehicle is in continuous forward motion.

It can be noted that if there is no target point, i.e. d = 0, then the tracking error model obtained in this study is identical to [\cite=Lee2001], in which tracking has been achieved by using saturation on one control input while the other is unbounded. In our case, the introduction of the target point at a distance makes the dynamics of the tracking error model more complicated. Specifically, the development produces a first order nonlinear non-globally Lipschitz differential equation (see equation [\eqref=omega]) that can blow up in finite time. To overcome this difficulty, our solution necessitates the application of saturated controls for both our control inputs with arbitrary small amplitude. Examples of application of saturated control can be found in [\cite=Chitour1995] [\cite=Liu1996] [\cite=Yakoubi2006] [\cite=Yakoubi2007] [\cite=Yakoubi2007-1] [\cite=Yakoubi2007-2]. Consequently, if both the control inputs are applied on the real vehicle, then the path following problem developed here becomes equivalent to the generalization of [\cite=Lee2001], as tracking problem with a target-point.

This paper can be seen as the continuation of the authors' previous work in [\cite=ait], in which a unicycle type vehicle had been considered. However, the arguments of the Lyapunov analysis used for the convergence proof are significantly more involved than that of [\cite=ait], due to the added state of the car type vehicle (essentially an integrator) and the fact that one must keep track of the small amplitudes of the saturations. Therefore, a positive definite function V is designed instead of a global Lyapunov function, whose time derivative along the closed-loop system is strictly negative outside a neighborhood of the origin. The design of V relies on an asymptotic analysis of a Ricatti equation, which is not needed in [\cite=ait]. The convergence to zero is then demonstrated using a bootstrap procedure [\cite=bootstrap], i.e., once the system errors converge to a neighborhood, they continue to diminish to a smaller neighborhood, and ultimately converge asymptotically to the origin. The results so obtained can be extended to the case where only the position of the reference trajectory is directly known.

The paper is organized as follows: in Section 2, the vehicle model and reference trajectory parameterization have been presented. In Section 3, the control design has been discussed and the Lyapunov function has been developed. The stability analysis of the closed loop system has been discussed in Section 4. Simulation results have been provided in Section 5, and a conclusion has been presented in Section 6.

Vehicle model and reference trajectory

Let us consider a path Γ with geodesic curvature κr whose absolute value is bounded by κmax > 0, i.e., for all t  ≥  0, we have

[formula]

As described in the introduction, Γ will be parameterized as a vehicle trajectory with a forward velocity u(t) such that Γ(t) = (pr(t),qr(t)) is described by the following state equations

[formula]

where ψr represents the angle between the abscissa axis and the velocity vector [formula], and κr is the scalar curvature associated to the parametrization of Γ by time t. The arclength s of Γ is given by [formula] and the scalar curvature κr(t) is hence equal to κ*r(s(t)).

The state equations for the vehicle dynamics are

[formula]

These equations represent the vehicle's motion with a velocity Vx, along the curve defined by the its geodesic curvature κ. The control variable ρ0 will be defined later. Notice that Vx is not necessarily constant, but simply a continuous function of time, which verifies the following hypothesis: there exist two positive constants 0 < Vmin  ≤  Vmax, such that for all t  ≥  0

[formula]

The strict positivity of the lower bound is necessary to derive our subsequent results. Note that path following for a unicycle type of vehicle has been obtained under weaker hypotheses than that of the above equation, cf. in particular the persistent excitation condition (PEC) [\cite=Khalil]. It is not clear to us how to extend the present work only assuming that Vx satisfies the PEC (see Remark [\eqref=pec:0]).

For the target point, the equations for the coordinates p and q are defined as

[formula]

We will also suppose throughout the paper that

dκmax < 1.

The above assumption may be considered as a technical one or a design constraint for positioning the target point. However, it is reasonable to upper bound the curvature of the reference path in terms of the distance d. Indeed, tracking a circle of radius d' < d with a point fixed at a distance d in front of a vehicle is impossible. To see that, one can see that intuitively of rely on equation [\eqref=eq:kap2] given below. At the ligth of the previous example, Hypothesis (H1) is almost optimal.

The dynamics of the target point in a form similar to [\eqref=veh1] can be obtained by deriving the precedent equations. One first gets that

[formula]

The curve defined by the target point is traveled at the following speed

[formula]

Our objective now is to define the dynamics of the target point as those of a car. For that purpose, we consider θ as the angle between the abscissa axis and the velocity vector [formula]. One easily gets that

[formula]

then [formula], and the scalar curvature ω is defined by [formula].

We define the dynamics of ω by the new control variable [formula]. Deriving equation [\eqref=theta], we obtain

[formula]

Hence the dynamics of the target point (p,q) becomes

[formula]

The error between the target point and the reference curve is defined as

[formula]

and the error dynamics is given by

[formula]

Control design and Lyapunov Function

In this section, we will present a control law u(ep,eq,ξ,η,t) and ρ(ep,eq,ξ,η,t), such that the system ([\ref=erreur]) is globally asymptotically stable (GAS for short) w.r.t. origin. Note that, from the equations [\eqref=eq:vd] and [\eqref=omega], one recovers the control ρ0 once vd and ρ are determined. However, there is an issue of possible blow-up in finite time for κ (and thus for ρ0). Indeed, assuming that one is able to stabilize [\eqref=erreur] to zero, then the control ρ0 is obtained by derivating κ, which is in turn obtained by solving [\eqref=omega], seen as an o.d.e. with unknown κ since ω tends to κr asymptotically. Equation [\eqref=omega] is of the type [formula] with the right-hand side f not globally Lipschitz w.r.t. κ, hence it is not immediate to insure global existence of κ for all t  ≥  0. We will show later on, that an appropriate choice of u and ρ under Hypothesis (H1) solves this problem (see Lemma [\ref=explosion] below).

The standard saturation function σ(x) defined for [formula] by

[formula]

Let us first of all perform a variable change on the control, as follows

[formula]

where u1, u2 are the new control variables.

In order to define ω, ρ and to perform the change of inputs variables, vd must be greater than zero and thus Vx must also be strictly positive. It is therefore not obvious to proceed as above, if Vx only satisfies (PEC).

With the boundedness of κ and Vx, equation [\eqref=eq:vd] implies that νd is bounded. If one insists on having ρ bounded, then we must assume also that ρr is bounded, as

[formula]

where ρr,max is a known positive constant.

The system ([\ref=erreur]) is therefore rewritten as

[formula]

The bounded controls u1 and u2 can be expressed in the following form:

[formula]

with sufficiently small gains C1 and D. Since κ is bounded, vd also remains uniformly bounded throughout t  ≥  0. We can hence change the time scale by considering ds = vd dt. To keep the notations simple, we would continue to use t for time, and the point for the derivation with respect to s, like [formula]. This has no effect on the control laws since our design is based on static feedback (w.r.t. the error). The error dynamics hence becomes

[formula]

Let us perform the following change of variable corresponding to a time-varying rotation in the frame of the reference trajectory

[formula]

The system becomes

[formula]

where u1, u2 will be chosen such that ([formula]) becomes GAS. The control variables u1 and u2 are defined as follows

[formula]

where k1,k2,C1,C2,D are positive real numbers and σ() is the standard saturation function defined in ([formula]). Typically, we want to stabilize the system with arbitrarily small saturation levels C1 and D. In conclusion, the final system, noted (Σ) becomes

[formula]

where

[formula]

In the following section, it is shown that Global Asymptotic Stability of the system ([\ref=system]) can be achieved by proper selection of C1, C2, k1, k2.

More precisely, we prove the following theorem, which is the main result of the paper.

Consider a path Γ with geodesic curvature [formula] verifying [\eqref=kappa0] for some κmax > 0. It is then possible to track asymptotically γ with a point fixed at a distance d > 0 in front of a vehicle, where dκmax < 1, by choosing the control laws u1,u2 according to [\eqref=control0] with constants k1,k2,C1,C2,D, which satisfy the following conditions. Set [formula].

[formula]

where β is a positive constant larger than 8, D is an arbitrary positive constant, fixed a-priori, and k2 is large enough that [formula].

The proof of GAS stability of System ([\ref=system]) has been carried out as an argument based on Lyapunov analysis.

The first remark consists in focusing on the last two equations in (Σ) and we will first treat the case where there is no saturation on [formula].

In that case, the last two equations in the previous section define a double integrator system, which shall now be denoted as (Sk):

[formula]

with,

[formula]

The system (Sk) can be presented in the matrix form

[formula]

where,

[formula]

Since A is Hurwitz, there exists a quadratic form Vk  =  ZTPkZ, where Pk is a positive definite square matrix, obtained by solving the following Riccati equation

[formula]

where, ΥL is the L2-gain related to the system (Sk). The derivative [formula] is given by the following equation

[formula]

and verifies

[formula]

The Lyapunov function proposed for the global system ([\ref=system]) is

[formula]

where M, k1, k2 are positive constants to be chosen later in particular to ensure that V is positive definite function, see Lemma [\ref=le:V] below. Moreover, a straightforward computation yields the following:

The derivative of the Lyapunov function can be upper bounded as follows,

[formula]

The rest of the argument is divided in two main steps. In the first step, the existence of appropriate constants M,k1,k2,C1,C2 is proven, such that V has a positive definite quadratic form in all the variables. This means that there exists a bounded region Yk2 (for k2 typically large), in the (y1,y2) - plane:

[formula]

such that outside this region, the derivative of V along trajectories of [\eqref=system] fulfills the following inequality

[formula]

In the second step, a bootstrap-type argument is applied to show the convergence of trajectories of [\eqref=system] to zero, as t tends to infinity.

These two steps have been achieved in the following manner: the L2-gain of (Sk), denoted by ΥL is calculated, then Pk is estimated for k2 tending to infinity. Then ISS (input-to-state) type bounds are calculated for ξ and η and the derivative of the Lyapunov function is estimated outside Yk2, and the argument is concluded. The detailed calculations have been presented in the following subsections.

L2-gain ΥL

Let us study the system (Sk), defined in the equation ([\ref=integrators]). We recall that, (Sk) can be presented in the following matrix form

[formula]

We will tune k2  ≥  20 with [formula], then 1  <  ΥL  <  1.2.

The proof of Lemma [\ref=le:l2] is given in Appendix.

Estimation of Pk for large k2

In this section, we take k1  =  ak22 with [formula] and k2 tending to infinity. We will prove the following two results whose proofs are given in Appendix.

As k2 tends to infinity, the positive define matrix Pk defined in [\eqref=eq:ricatti] admits the following asymptotic expansion

[formula]

with [formula], 1  ≤  i  ≤  3, where the Fi are positive constants (only depending on a) so that F1F3 - F22 > 0.

For k2 large enough and M  =  βk2, the function V defined in [\eqref=Lyapunov] is a positive quadratic form in (ξ,η,y1,y2).

ISS bounds for ξ and η

For a real-valued continuous and bounded function f defined on [formula], we set

[formula]

and

[formula]

Consider the system ([\ref=matrix_form_ex]). By tuning [formula] , the ISS bounds of ξ and η satisfy the following inequalities for t  ≥  0,

[formula]

where Z0 is the initial condition.

As a consequence, we have, for t  ≥  0 large enough,

[formula]

The proof of the above lemma is given in Appendix.

From the argument of Lemma [\ref=l_sup_limite_non_satur], other ISS bounds for ξ and η can simply be derived by considering the system (Sk) defined in [\eqref=integrators] with the controls ν1 and ν2 given in [\eqref=eq:nu00].

Let (Sk) be the system defined in [\eqref=integrators] with the controls ν1 and ν2 given in [\eqref=eq:nu00]. Assume that

[formula]

Then the bounds [\eqref=ISS_limite1] can be improved as follows: there exists T > 0 such that, for every t > T,

[formula]

The argument is straightforward by replacing C1 and C2, which were used to bound ν1 and ν2 in [\eqref=eq:mu] by κmaxC1|y1|*(t) and C2|y2|*(t).

For the rest of the paper, we choose C1,C2 <  < 1 so that the limsup of both ξ and η are very small. In the subsequent computations, we can assume with no loss of generality that [formula], | sin ξ|  ≤  |ξ| and [formula].

The following inequality holds true

[formula]

Estimation of [formula] for y∉Yk2

In this subsection, we choose the several parameters so that [formula] verifies [\eqref=final] outside the region Yk2, for k2 large enough. The results are summarized in the next lemma.

For the choice of parameters defined in Theorem [\ref=theo1], there exists k2 large enough and T > 0, such that, for every t > T, Eq. [\eqref=final] is verified.

The proof of Lemma [\ref=le:11] is given in Appendix. In the rest of the paper, the symbol C has been used to represent arbitrary constants, depending only on β.

Notice that inside Yk2, the term k2|y1ξ| cannot be controlled since we only have for that purpose the term βk2ξ2 + Cy21.

Final step

Note that outside Yk2, for t large enough, [formula]. To see that, we proceed as before since either [formula] or [formula]. As a consequence, every trajectory of [\eqref=system] must reach Yk2 in finite time. Therefore, along every trajectory of [\eqref=system], the value of V is eventually smaller than Vmax, the maximal value of V over the set

[formula]

By using [\eqref=eq:Venc] and Lemma[\ref=l_sup_limite_non_satur], we get

[formula]

We deduce by using again [\eqref=eq:Venc] that, along every trajectory of [\eqref=system] and for t large enough

[formula]

We can then use the improved ISS bounds for ξ and η obtained in Lemma [\ref=le:ISSnew]. In particular, one gets that, for t large enough,

[formula]

In turn, this new bound for ξ allows one to shrink the bounded region Yk2 outside which [formula] verifies [\eqref=final]. Indeed, one has to satisfy either [\eqref=eq:11] or [\eqref=eq:22], which leads to either [formula] or [formula].

Continuing the procedure described before, we construct inductively four sequences of positives numbers y1,n, y2,n, ξn and ηn, n  ≥  0, of upper bounds of ||y1||*, ||y2||*,||ξ||* and ||η||* respectively, such that the following inequalities are verified

[formula]

which are obtained from [\eqref=ISS_limite2], and

[formula]

which are, according to [\eqref=eq:11] and [\eqref=eq:22], the equations needed to define, at the (n + 1)-th step, the bounded region outside which [formula] verifies [\eqref=final]. It is simple to prove that, for all non negative integer n, we have

[formula]

This immediately yields the convergence to zero of trajectories of [\eqref=system].

The bootstrap procedure we have used above is clearly an instance of a small gain theorem.

Stabilization of the original system

We have stabilized System [\eqref=system] in case there is no saturation on [formula]. We will now show that for every initial condition, the term inside the outer saturation in [formula] becomes bounded by 1 for t sufficiently large (i.e. there exists T > 0 such that, for t > T, the thesis holds true). Thus the last two equations of [\eqref=system] are given by [\eqref=integrators]. To show that, we need an ISS-type of result on the system

[formula]

where d1 and d2 are amplitude-bounded perturbations which amplitudes are bounded by constants eventually depending on κmax. We first perform the linear change of variable defined by

[formula]

A direct computation shows that the dynamics of (X,Y) is given by

[formula]

Since both [formula] and [formula] are of the magnitude of [formula], these constants can be chosen arbitrarily small. Then, as a consequence of Theorems 2.5 and 2.6 in [\cite=COCV2001], one gets that there exists C(a) > 0 a positive constant only depending on a so that

[formula]

Therefore, [formula] becomes strictly less than one for t large enough if [formula] is small enough.

The following lemma provides bounding conditions on u1 and u2 that would guarantee that the differential equation given in [\eqref=omega] is defined for all times t  ≥  0.

For k2D large enough, the differential equation in κ given by [\eqref=omega] is defined for all times t  ≥  0.

Proof of Lemma [\ref=explosion] After multiplying [\eqref=omega] by κ, one can rewrite as follows,

[formula]

The right-hand side of the above inequality is majored by

[formula]

If we can ensure that

[formula]

then this will easily imply that κ does not blow up in finite time. Indeed, assuming that [\eqref=no-explo1] holds, then there exists K > 0 (only depending on d||η||∞ and dκmax) such that the right-hand side of [\eqref=eq:kap2] becomes negative for |κ|  ≥  K. This readily yields that |κ| becomes strictly less than K in finite time and therefore does not blow up in finite time.

We now show that [\eqref=no-explo1] holds true with an appropriate choice of the constants k1,k2. Without loss of generality we can assume that ξ(0) = η(0) = 0. In that case, one can replace the lim sup 's in the left-hand side of [\eqref=est-Y] by ||X||∞  +  ||Y||∞. Since [formula] can be chosen arbitrarily small, [\eqref=no-explo1] follows.

The proposed method appears to require global localization of the mobile robot and the desired trajectory at every sampling instant with respect to the world frame, which is usually very difficult to obtain in real applications. However, this does not restrict or limit the application of the presented controller in real life. For example, the position coordinates in (x,y) frame of reference can be obtained by a camera and the angle ψ (the direction of vehicle) by a gyroscope. The position of the target point can then be translated into (p,q) frame of reference given in Equation (5). From here, a finite time differentiator can be used to get [formula], and later on the angle θ. A simple exponential (even homogeneous finite time) observer can be used to get η as in [\cite=mazenc_pvtol].

Since the proof of the convergence is using a Lyapunov function which is strict outside Yk2, the results of Theorem [\ref=theo1] can easily be extended in case where we have only direct access to (pr(  ·  ),qr(  ·  )). Note that the gradient of the Lyapunov function is linear in its argument and thus, if the states are obtained through observers of differentiators, this will require Ci, i = 1,2 in [\eqref=final] to be changed with Ci + fi(t), where fi(  ·  ) is the observation or estimation error. There exist fixed time convergent differentiators such as [\cite=moreno2011], which ensure that the derivative converges in fixed finite time. On the other hand, if the estimation or convergence is asymptotic, it has been shown in [\cite=COCV2001] [\cite=mazenc_pvtol] that if f1,f2 tend to zero exponentially, then the controller will also converge and the proof will not change.

Simulations

The performance of the presented controller can be seen in the simulation results obtained using the following parameters:

[formula]

dκmax has been chosen much smaller than 1 in order to emphasize upon significant initial conditions (in particular, ξ(0) close to π) so that the resultant illustrations highlight our claim. The initial conditions imposed upon the error are

[formula]

The parameters of the controller was taken as follow:

[formula]

Figure [\ref=tra1] shows the reference trajectory, the target point and vehicle in a 2D coordinate plane. It can be seen that the system converges to the reference trajectory asymptotically. Once the vehicle converges, the target point and the vehicle follow the trajectory very closely. The convergence can also be seen in the error graph shown in figure [\ref=erreurs], where the initial conditions are also visible.

Figures [\ref=com_u] and [\ref=com_ro] show the control signals u and ρ respectively. It is clear from these figures that the controller does not attain extremely large values, and is bounded. This is an essential property in real systems, which does not result in impossible control signals when the initial error is very large.

Conclusion

In this paper, we have addressed the problem of path following using a target point rigidly attached to a car type vehicle, by controlling only the orientation of the vehicle by its angular acceleration. The main idea was to determine a control law using saturation which ensures global stabilization in two steps. The proposed Lyapunov function forces the errors to enter a neighborhood of the origin in finite time. The Lyapunov analysis also shows that by a bootstrap procedure, this neighborhood contracts asymptotically to zero. Simulation results illustrate the GAS performance of the controller.

Proof of technical lemmas

Proof of Lemma [\ref=le:l2]

One has

[formula]

and the L2-gain is defined by

[formula]

where [formula] is the largest singular value of G(jω). Since

[formula]

one has that [formula] is the inverse of the smallest eigenvalue of S(ω).

We start the calculation of the matrix S(ω) and get

[formula]

The minimum eigenvalue is equal to

[formula]

The minimum of λmin with respect to ω is equal to

[formula]

We deduce that

[formula]

If we tune [formula] and k2  ≥  20, then 0.93  <  λmin  <  1, and 1  <  ΥL  <  1.2.

Proof of Lemma [\ref=le:P_k]

In that case, and by using the Taylor expansion of equation ([\ref=l2g]), we have the following asymptotic expansion of Υ2L,

[formula]

Then, the Riccati equation proposed in [\eqref=eq:ricatti] takes the following form

[formula]

It can easily be checked that S is definite positive since det (S)  >  0:

[formula]

and we get:

[formula]

and we deduce from [\eqref=l2g] the following Taylor expansion for det (S),

[formula]

Then, the Riccati equation ([\ref=eq:P^2]), takes the form:

[formula]

where [formula], and the solution is:

[formula]

where Rφ is a rotation of angle φ and [formula] is the unique symmetric positive definite matrix whose square is equal to S. We first estimate [formula] and then φ.

We clearly have

[formula]

where [formula], [formula] and

[formula]

The asymptotic expansions of the above quantities are

[formula]

We also need the asymptotic expansions of the eigenvalues of S. Since

[formula]

then,

[formula]

We immediately deduce the following asymptotic expansions for the eigenvalues of S,

[formula]

We use [formula] to denote the unit vector b / ||b|| and define the angle φb so that Rφbe1  =  , where [formula].

We have

[formula]

and

[formula]

where [formula] and

[formula]

We then get that R-  φbe2 = l2e2 - l1e1. We can therefore write

[formula]

and deduce that

[formula]

Finally, we seek a formula of the type

[formula]

where the sI's are positive. A simple identification leads to the equations

[formula]

We deduce at once from the asymptotic expansions of the eigenvalues of S obtained in [\eqref=eq:lam] that

[formula]

From the expression [formula], we obtain

[formula]

and we deduce that [formula], i.e.,

[formula]

where [formula]. It implies that

[formula]

We now collect the result of the equation ([\ref=eq:X]) and ([\ref=eq:g]) to get,

[formula]

After a long but straightforward computation, we arrive at [\eqref=eq:P].

Proof of Proposition [\ref=le:V]

The proof is developed using Young inequality, [formula], where ε is an arbitrary positive constant.

First of all, according to Lemma [\ref=le:P_k], for large k2, the quadratic form Vk(ξ,η) satisfies the following inequality

[formula]

for some positive universal constant C > 0. Then, by setting [formula] and [formula], we obtain

[formula]

Since [formula], the above inequality ensures, for k2 large enough, the existence of l > 0 only dependent of a such that

[formula]

The previous inequality with M = βk2 and k1  =  ak22 computed in [\eqref=eq:V] implies

[formula]

By using Young's inequality, we get

[formula]

Which implies,

[formula]

then for large enough k2, V is a positive quadratic form in (ξ,η,y1,y2).

Proof of Lemma [\ref=l_sup_limite_non_satur]

The solution of the equation ([\ref=matrix_form]) is

[formula]

where Z0 is the initial value of Z for t = 0. We start by diagonalization of the matrix A, whose eigenvalues are equal to

[formula]

with corresponding eigenvectors [formula] and [formula]. From here, we obtain A  =  PDP   -   1, where

[formula]

We get

[formula]

The control variables ν1 and ν2 are bounded respectively by κmaxC1 and C2 and we obtain that the components of the vector [formula] are bounded componentwise by

[formula]

By taking [formula], we get [formula] and [formula]. We can bound the components of the vector defined in [\eqref=toto] by

[formula]

Equation [\eqref=toto1] can be deduced directly from Equations [\eqref=toto0] and [\eqref=toto2]. Moreover, since A is Hurwitz, we arrive to [\eqref=ISS_limite1].

Proof of Lemma [\ref=le:11]

The terms |ηξ| and k2ξ2 are clearly dominated by [formula].

In [\eqref=lyap2], one has [formula], which is dominated by [formula] if [formula]. The latter clearly holds true for k2 large enough.

We have [formula], which is dominated by C2y2σ(y2) / 4 if AMC22  ≤  C2 / 4. The latter is true according to the choice of C2 in [\eqref=eq:param].

We now turn to the control of the term k2C1|y2κrσ(y1)| by [formula]. If |y2|  ≥  1, the second term is in control if [formula] which holds true. Assume now that |y2|  ≤  1. In the case where |y1|  ≥  1, the first term is in control if [formula] which obviously holds true. It remains the case where |y1|  ≤  1. It is immediate to check that the quadratic form [formula] is definite positive.

We next consider the term k1|y2||ξ|3. To control it, we first bound |ξ|2 by [formula] for t large enough. In case |y2|  ≥  1, then the term is immediately dominated by [formula]. Otherwise, one has, for k2 large enough,

[formula]

the last two terms being controlled by [formula].

Using again the estimate |ξ| by [formula] for t large enough, the control of k1|y1||ξ|2 reduces to that of k2|y1ξ|. It therefore remain to control the latter. This is where we need the hypothesis that y∉Yk2. Assume first that one wants to get the inequality

[formula]

This holds true if [formula]. On the other hand, if one wants to get the inequality

[formula]

it holds if [formula]. In any case, outside Yk2, one of the two inequalities [\eqref=eq:11] or [\eqref=eq:22] must hold true and Lemma[\ref=le:11] is established.

Finally, with the choice of M = βk2 together with [\eqref=eq:P], it is immediate to verfy that V is positive definite. Moreover, we get

[formula]

for some positive constants ai, di, 1  ≤  i  ≤  3.