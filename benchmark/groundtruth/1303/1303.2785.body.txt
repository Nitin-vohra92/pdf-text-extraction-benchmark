Theorem Corollary Proposition Lemma Remark Definition

Hypothesis

Metaplectic tensor products for automorphic representations of [formula]

Introduction

Let F be either a local field of characteristic 0 or a number field, and R be F if F is local and the ring of adeles [formula] if F is global. Consider the group [formula]. For a partition [formula] of r, one has the Levi subgroup

[formula]

Let [formula] be irreducible admissible (resp. automorphic) representations of [formula] where F is local (resp. F is global). Then it is a trivial construction to obtain the representation [formula], which is an irreducible admissible (resp. automorphic) representation of the Levi M(R). Though highly trivial, this construction is of great importance in the representation theory of [formula].

Now if one considers the metaplectic n-fold cover [formula] constructed by Kazhdan and Patterson in [\cite=KP], the analogous construction turns out to be far from trivial. Namely for the metaplectic preimage [formula] of M(R) in [formula] and representations [formula] of the metaplectic n-fold covers [formula], one cannot construct a representation of [formula] simply by taking the tensor product [formula]. This is simply because [formula] is not the direct product of [formula], namely

[formula]

and even worse there is no natural map between them.

When F is a local field, for irreducible admissible representations [formula] of [formula], P. Mezo ([\cite=Mezo]), whose work, we believe, is based on the work by Kable [\cite=Kable2], constructed an irreducible admissible representation of the Levi [formula], which can be called the "metaplectic tensor product" of [formula], and characterized it uniquely up to certain character twists. (His construction will be reviewed and expanded further in Section [\ref=S:Mezo].)

The theme of the paper is to carry out a construction analogous to Mezo's when F is a number field, and our main theorem is

In the above theorem, [formula] indicates the metaplectic restricted tensor product, the meaning of which will be explained later in the paper. The existence and the local-global compatibility in the main theorem are proven in Theorem [\ref=T:main], and the cuspidality and square-integrability are proven in Theorem [\ref=T:cuspidal] and Theorem [\ref=T:square_integrable], respectively.

Let us note that by unitary, we mean that πi is equipped with a Hermitian structure invariant under the action of the group. Also we require πi be an automorphic subrepresentation, so that it is realized in a subspace of automorphic forms and hence each element in πi is indeed an automorphic form. (Note that usually an automorphic representation is a subquotient.) We need those two conditions for technical reasons, and they are satisfied if πi is in the discrete spectrum, namely either cuspidal or residual.

Also we should emphasize that if n > 2, we do not know if our construction works unless we impose a technical assumption as in Hypothesis ([formula]). We will show in Appendix [\ref=A:topology] that this assumption is always satisfied if n = 2, and if n > 2 it is satisfied, for example, if gcd (n,r - 1 + 2cr) = 1, where c is the parameter to be explained. We hope that even for n > 2 it is always satisfied, though at this moment we do not know how to prove it.

As we will see, strictly speaking the metaplectic tensor product of [formula] might not be unique even up to equivalence but is dependent on a character ω on the center [formula] of [formula]. Hence we write

[formula]

for the metaplectic tensor product to emphasize the dependence on ω.

Also we will establish a couple of important properties of the metaplectic tensor product both locally and globally. The first one is that the metaplectic tensor product behaves in the expected way under the action of the Weyl group. Namely

Theorem [\ref=T:Weyl_group_local] and [\ref=T:Weyl_group_global]. Let w∈WM be a Weyl group element of [formula] that only permutes the [formula]-factors of M. Namely for each [formula], we have [formula] for a permutation σ∈Sk of k letters. Then both locally and globally, we have

[formula]

where the left hand side is the twist of [formula] by w.

The second important property we establish is the compatibility of the metaplectic tensor product with parabolic inductions. Namely

Theorem [\ref=T:induction_local] and [\ref=T:induction_global]. Both locally and globally, let [formula] be the standard parabolic subgroup whose Levi part is [formula]. Further for each [formula] let [formula] be the standard parabolic of [formula] whose Levi part is [formula]. For each i, we are given a representation

[formula]

of [formula], which is given as the metaplectic tensor product of the representations [formula] of [formula]. Assume that πi is an irreducible constituent of the induced representation [formula]. Then the metaplectic tensor product

[formula]

is an irreducible constituent of the induced representation

[formula]

where Q is the standard parabolic subgroup of M whose Levi part is [formula].

In the above two theorems, it is implicitly assumed that if n > 2 and F is global, the metaplectic tensor products in the theorems exist in the sense that Hypothesis ([formula]) is satisfied for the relevant Levi subgroups.

Finally at the end, we will discuss the behavior of the global metaplectic tensor product when restricted to a smaller Levi. Namely for each automorphic form [formula] in the metaplectic tensor product, we would like to know which space the restriction [formula] belongs to, where [formula], viewed as a subgroup of M, is the Levi for the smaller group [formula]. Somehow similarly to the non-metaplectic case, the restriction [formula] belongs to the metaplectic tensor product of [formula]. But the precise statement is a bit more subtle. Indeed, we will prove

Theorem [\ref=T:restriction]. Assume Hypothesis ([formula]) is satisfied, which is always the case if n = 2 or gcd (n,r - 1 + 2cr) =  gcd (n,r - r1 - 1 + 2c(r - r1)) = 1. Then there exists a realization of the metaplectic tensor product [formula] such that, if we let

[formula]

then

[formula]

as a representation of [formula], where [formula] is the metaplectic tensor product of [formula], ωδ is a certain character twisted by δ which runs through a finite subset of [formula] and [formula] is a multiplicity.

The precise meanings of the notations will be explained in Section [\ref=S:restriction].

Even though the theory of metaplectic groups is an important subject in representation theory and automorphic forms and used in various important literatures such as [\cite=Banks2] [\cite=F] [\cite=BBL] [\cite=BFH] [\cite=BH] [\cite=Suzuki] to name a few, and most importantly for the purpose of this paper, [\cite=BG] which concerns the symmetric square L-function on [formula] , it has an unfortunate history of numerous technical errors and as a result published literatures in this area are often marred by those errors which compromise their reliability. As is pointed out in [\cite=BLS], this is probably due to the deep and subtle nature of the subject. At any rate, this has made people who work in the area particularly wary of inaccuracies in new works. For this reason, especially considering the foundational nature of this paper, we tried to provide detailed proofs for most of our assertions at the expense of the length of the paper. Furthermore, for large part, we rely only on the two fundamental works, namely the work on the metaplectic cocycle by Banks, Levy and Sepanski ([\cite=BLS]) and the local metaplectic tensor product by Mezo ([\cite=Mezo]), both of which are written carefully enough to be reliable.

Finally, let us mention that the result of this paper will be used in our forthcoming [\cite=Takeda2], which will improve the main result of [\cite=Takeda1].

Throughout the paper, F is a local field of characteristic zero or a number field. If F is a number field, we denote the ring of adeles by [formula]. As we did in the introduction we often use the notation

[formula]

The symbol R× has the usual meaning and we set

[formula]

Both locally and globally, we denote by OF the ring of integers of F. For each algebraic group G over a global F, and [formula], by gv we mean the [formula] component of g, and so gv∈G(Fv).

For a positive integer r, we denote by Ir the r  ×  r identity matrix. Throughout we fix an integer n  ≥  2, and we let μn be the group of [formula] roots of unity in the algebraic closure of the prime field. We always assume that μn  ⊆  F, where F is either local or global. So in particular if n  ≥  3, for archimedean F, we have [formula], and for global F, F is totally complex.

The symbol ( - , - )F denotes the [formula] order Hilbert symbol of F if F is local, which is a bilinear map

[formula]

If F is global, we let [formula], where the product is finite. We sometimes write simply ( - , - ) for ( - , - )R when there is no danger of confusion. Let us recall that both locally and globally the Hilbert symbol has the following properties: for a,b∈R×. Also for the global Hilbert symbol, we have the product formula [formula] for all a,b∈F×.

We fix a partition [formula] of r, and we let

[formula]

and assume it is embedded diagonally as usual. We often denote each element m∈M by

[formula]

or sometimes simply [formula], where [formula].

For [formula], we let B = TNB be the Borel subgroup with the unipotent radical NB and the maximal torus T.

If π is a representation of a group G, we denote the space of π by Vπ, though we often confuse π with Vπ when there is no danger of confusion. We say π is unitary if Vπ is equipped with a Hermitian structure invariant under the action of G, but we do not necessarily assume that the space Vπ is complete. Now assume that the space Vπ is a space of functions or maps on the group G and π is the representation of G on Vπ defined by right translation. (This is the case, for example, if π is an automorphic subrepresentation.) Let H  ⊆  G be a subgroup. Then we define [formula] to be the representation of H realized in the space

[formula]

of restrictions of f∈Vπ to H, on which H acts by right translation. Namely [formula] is the representation obtained by restricting the functions in Vπ. Occasionally, we confuse [formula] with its space when there is no danger of confusion. Note that there is an H-intertwining surjection [formula], where π|H is the (usual) restriction of π to H.

For any group G and elements g,h∈G, we define gh = ghg- 1. For a subgroup H  ⊆  G and a representation π of H, we define gπ to be the representation of gHg- 1 defined by gπ(h') = π(g- 1h'g) for h'∈gHg- 1.

We let W be the set of all r  ×  r permutation matrices, so for each element w∈W each row and each column has exactly one 1 and all the other entries are 0. The Weyl group of [formula] is identified with W. Also for our Levi M, we let WM be the subset of W that only permutes the [formula]-blocks of M. Namely WM is the collection of block matrices

[formula]

where Sk is the permutation group of k letters. Though WM is not a group in general, it is in bijection with Sk. Note that if w∈WM corresponds to σ∈Sk, we have

[formula]

In addition to W, in order to use various results from [\cite=BLS], which gives a detailed description of the 2-cocycle σr defining our metaplectic group [formula], one sometimes needs to use another set of representatives of the Weyl group elements, which we as well as [\cite=BLS] denote by [formula]. The set [formula] is chosen to be such that for each element [formula] we have det (η) = 1. To be more precise, each η with length l is written as

[formula]

where wαi is a simple root refection corresponding to a simple root αi and is the matrix of the form

[formula]

Though the set [formula] is not a group, it has the advantage that we can compute the cocycle σr in a systematic way as one can see in [\cite=BLS]. For each w∈W, we denote by ηw the corresponding element in [formula]. If w∈WM, one can see that ηw is of the form (εjδσ(i),jIrj) for εj∈{  ±  1}. Namely ηw is a k  ×  k block matrix in which the non-zero entries are either Irj or - Irj.

The author would like to thanks Paul Mezo for reading an early draf and giving him helpful comments, and Jeff Adams for sending him the preprint [\cite=Adams] and explaining the construction of the metaplectic tensor product for the real case. The author is partially supported by NSF grant DMS-1215419. Also part of this research was done when he was visiting the I.H.E.S. in the summer of 2012 and he would like to thank their hospitality.

The metaplectic cover [formula] of [formula]

In this section, we review the theory of the metaplectic n-fold cover [formula] of [formula] for both local and global cases, which was originally constructed by Kazhdan and Patterson in [\cite=KP].

The local metaplectic cover [formula]

Let F be a (not necessarily non-archimedean) local field of characteristic 0 which contains all the [formula] roots of unity. In this paper, by the metaplectic n-fold cover [formula] of [formula] with a fixed parameter [formula], we mean the central extension of [formula] by μn as constructed by Kazhdan and Patterson in [\cite=KP]. To be more specific, let us first recall that the n-fold cover [formula] of [formula] was constructed by Matsumoto in [\cite=Matsumoto], and there is an embedding

[formula]

Our metaplectic n-fold cover [formula] with c = 0 is the preimage of [formula] via the canonical projection [formula]. Then [formula] is defined by a 2-cocycle

[formula]

For arbitrary parameter [formula], we define the twisted cocycle σ(c)r by

[formula]

for [formula], where recall from the notation section that ( - , - )F is the [formula] order Hilbert symbol for F. The metaplectic cover with a parameter c is defined by this cocycle. In [\cite=KP], the metaplectic cover with parameter c is denoted by [formula] but we avoid this notation. This is because later we will introduce the notation [formula], which has a completely different meaning. Also we suppress the superscript (c) from the notation of the cocycle and always agree that the parameter c is fixed throughout the paper.

By carefully studying Matsumoto's construction, Banks, Levy, and Sepanski ([\cite=BLS]) gave an explicit description of the 2-cocycle σr and shows that their 2-cocycle is "block-compatible" in the following sense: For the standard [formula]-parabolic of [formula], so that its Levi M is of the form [formula] which is embedded diagonally into [formula], we have

[formula]

for all [formula]. (See [\cite=BLS]. Strictly speaking in [\cite=BLS] only the case c = 0 is considered but one can derive the above formula using the bilinearity of the Hilbert symbol.) This 2-cocycle generalizes the well-known cocycle given by Kubota [\cite=Kubota] for the case r = 2. Also we should note that if r = 1, this cocycle is trivial. Note that [formula] is not the F-rational points of an algebraic group, but this notation seems to be standard.

Let us list some other important properties of the cocycle σr, which we will use in this paper.

The first one is simply the definition of 2-cocycle and all the others are some of the properties of σr listed in [\cite=BLS].

We need to recall how this cocycle is constructed. As mentioned earlier, Matsumoto constructed [formula]. It is shown in [\cite=BLS] that [formula] is defined by a cocycle [formula] which satisfies the block-compatibility in a much stronger sense as in [\cite=BLS]. (Note that our [formula] corresponds to [formula] of [\cite=BLS].) Then the cocycle σr is defined by

[formula]

where l is the embedding defined by

[formula]

See [\cite=BLS]. (Note the difference between this embedding and the one in ([\ref=E:embedding0]). This is the reason we have the extra Hilbert symbol in the definition of σr.)

Since we would like to emphasize the cocycle being used, we denote [formula] by [formula] when the cocycle σ is used. Namely [formula] is the group whose underlying set is

[formula]

and the group law is defined by

[formula]

To use the block-compatible 2-cocycle of [\cite=BLS] has obvious advantages. In particular, it has been explicitly computed and, of course, it is block-compatible. Indeed, when we consider purely local problems, we always assume that the cocycle σr is used.

However it does not allow us to construct the global metaplectic cover [formula]. Namely one cannot define the adelic block-combatible 2-cocycle simply by taking the product of the local block-combatible 2-cocycles over all the places. Namely for [formula], the product

[formula]

is not necessarily finite. This can be already observed for the case r = 2. (See [\cite=F].)

For this reason, we will use a different 2-cocycle τr which works nicely with the global metaplectic cover [formula]. To construct such τr, first assume F is non-archimedean. It is known that an open compact subgroup K splits in [formula], and moreover if |n|F = 1, we have [formula]. (See [\cite=KP].) Also for k,k'∈K, a property of the Hilbert symbol gives ( det (k), det (k'))F = 1. Hence one has a continuous map [formula] such that σr(k,k')sr(k)sr(k') = sr(kk') for all k,k'∈K. Then define our 2-cocycle τr by

[formula]

for [formula]. If F is archimedean, we set τr  =  σr.

The choice of sr and hence τr is not unique. However when |n|F = 1, there is a canonical choice with respect to the splitting of K in the following sense: Assume that F is such that |n|F = 1. Then the Hilbert symbol ( - , - )F is trivial on O×F  ×  O×F, and hence, when restricted to [formula], the cocycle σr is the restriction of [formula] to the image of the embedding l. Now it is known that the compact group [formula] also splits in [formula], and hence there is a map [formula] such that the section [formula] given by [formula] is a homomorphism on [formula]. (Here we are assuming [formula] is realized as [formula] as a set and the group structure is defined by the cocycle [formula].) Moreover [formula] is determined up to twists by the elements in [formula]. But [formula] because [formula] is a perfect group and μn is commutative. Hence [formula] is unique. (See also [\cite=KP] for this matter.) We choose sr so that

[formula]

With this choice, we have the commutative diagram

[formula]

where the top arrow is (g,ξ)  ↦  (ł(g),ξ), the bottom arrow is l, and all the arrows can be seen to be homomorphisms. This choice of sr will be crucial for constructing the metaplectic tensor product of automorphic representations. Also note that the left vertical arrow in the above diagram is what is called the canonical lift in [\cite=KP] and denoted by [formula] there. (Although we do not need this fact in this paper, if r = 2 one can show that τr can be chosen to be block compatible, which is the cocycle used in [\cite=F].)

Using τr, we realize [formula] as

[formula]

as a set and the group law is given by

[formula]

Note that we have the exact sequence

[formula]

given by the obvious maps, where we call p the canonical projection.

We define a set theoretic section

[formula]

Note that κ is not a homomorphism. But by our construction of the cocycle τr, κ|K is a homomorphism if F is non-archimedean and K is a sufficiently small open compact subgroup, and moreover if |n|F = 1, one has [formula].

Also we define another set theoretic section

[formula]

where sr(g) is as above, and then we have the isomorphism

[formula]

which gives rise to the commutative diagram

[formula]

of set theoretic maps. Also note that the elements in the image [formula] "multiply via σr" in the sense that for [formula], we have

[formula]

Let us mention

See [\cite=KP].

If P is a parabolic subgroup of [formula] whose Levi is [formula], we often write

[formula]

for the metaplectic preimage of M(F). Next let

[formula]

and [formula] its metaplectic preimage. Also we define

[formula]

and often denote its preimage by

[formula]

The group [formula] is a normal subgroup of finite index. Indeed, we have the exact sequence

[formula]

where the third map is given by [formula]. We should mention the explicit isomorphism [formula] defined as follows: First for each [formula], define a map [formula] by

[formula]

Then the map given by

[formula]

is a homomorphism. Clearly the map is well-defined and 1-1. Moreover this is surjective because each element [formula] is written as

[formula]

and [formula].

The following should be mentioned.

It is well-known that F×  n is closed and of finite index in F×. Hence the group [formula] is discrete, in particular Hausdorff. But both [formula] and [formula] are, as topological groups, isomorphic to this Hausdorff space. This completes the proof.

Let us mention the following important fact. Let [formula] be the center of [formula]. Then its metaplectic preimage [formula] is not the center of [formula] in general. (It might not be even commutative for n > 2.) The center, which we denote by [formula], is

[formula]

where d =  gcd (r - 1 + 2c,n). (The second equality is proven in [\cite=GO].) Note that [formula] is a closed subgroup.

Let π be an admissible representation of a subgroup [formula], where [formula] is the metaplectic preimage of a subgroup [formula]. We say π is "genuine" if each element [formula] acts as multiplication by ξ, where we view ξ as an element of [formula] in the natural way.

The global metaplectic cover [formula]

In this subsection we consider the global metaplectic group. So we let F be a number field which contains all the [formula] roots of unity and [formula] the ring of adeles. Note that if n > 2, then F must be totally complex. We shall define the n-fold metaplectic cover [formula] of [formula]. (Just like the local case, we write [formula] even though it is not the adelic points of an algebraic group.) The construction of [formula] has been done in various places such as [\cite=KP] [\cite=FK].

First define the adelic 2-cocycle τr by

[formula]

for [formula], where τr,v is the local cocycle defined in the previous subsection. By definition of τr,v, we have τr,v(gv,g'v) = 1 for almost all v, and hence the product is well-defined.

We define [formula] to be the group whose underlying set is [formula] and the group structure is defined via τr as in the local case, i.e.

[formula]

for [formula], and ξ,ξ'∈μn. Just as the local case, we have

[formula]

where we call p the canonical projection. Define a set theoretic section [formula] by g  ↦  (g,1).

It is well-known that [formula] splits in [formula]. However the splitting is not via κ. In what follows, we will see that the splitting is via the product of all the local [formula].

Let us start with the following "product formula" of σr.

From the explicit description of the cocycle σr,v(g,g') given at the end of §4 of [\cite=BLS], one can see that σr,v(g,g') is written as a product of Hilbert symbols of the form (t,t')Fv for t,t'∈F×. This proves the first part of the proposition. The second part follows from the product formula for the Hilbert symbol.

By the Bruhat decomposition we have g = bwb' for some b,b'∈B(F) and w∈W. Then for each place v

[formula]

By the previous proposition, σr,v(b,wb') = σr,v(w,b') = 1 for almost all v. By ([\ref=E:kappa_and_s]) we know sr,v(b) = sr,v(w) = sr,v(b') = 1 for almost all v. Finally by definition of τr,v, τr,v(w,b') = τr,v(b,wb') = 1 for almost all v.

This proposition implies that the expression

[formula]

makes sense for all [formula], and one can define the map

[formula]

Moreover, this is a homomorphism because of Proposition [\ref=P:product_formula] and ([\ref=E:convenient]).

Unfortunately, however, the expression [formula] does not make sense for every [formula] because one does not know whether sr,v(gv) = 1 for almsot all v. Yet, we have

We already know sr(g) is defined and [formula] is a homomorphism on [formula]. Also sr(n) is defined thanks to ([\ref=E:kappa_and_s]) and [formula] is a homomorphism on [formula] thanks to Proposition [\ref=P:BLS] (1). Moreover for all places v, we have σr,v(gv,nv) = 1 again by Proposition [\ref=P:BLS] (1). Hence for all v, sr,v(gnv) = sr,v(g)sr,v(nv) / τr,v(g,nv). For almost all v, the right hand side is 1. Hence the global sr(gn) is defined. Also this equality shows that [formula]. The same argument works for ng.

If [formula] is a subgroup on which [formula] is not only defined but also a group homomorphism, we write [formula]. In particular we have

[formula]

We define the groups like [formula], [formula], [formula], etc completely analogously to the local case. Let us mention

That [formula] and [formula] are closed follows from the following lemma together with Lemma [\ref=L:closed_subgroup_local]. Once one knows [formula] is closed, one will know [formula] is closed because it is the preimage of the closed [formula] under the canonical projection, which is continuous.

Let (xi)i∈I be a net in H that converges in [formula], where I is some index set. Let g =  lim i∈Ixi. Assume g∉H. Then there exists a place w such that gw∉Hw. Since Hw is closed, the set [formula] is open. Then there exists an open neighborhood U of g of the form [formula], where Uv is some open neighborhood of gv and at v = w, Uv = Uw. But for any i∈I, xi∉U because xi,w∉Uw, which contradicts the assumption that g =  lim i∈Ixi. Hence g∈H, which shows H is closed.

Just like the local case, the preimage [formula] of the center [formula] of [formula] is in general not the center of [formula] but the center, which we denote by [formula], is

[formula]

where d =  gcd (r - 1 + 2c,n). The center is a closed subgroup of [formula].

We can also describe [formula] as a quotient of a restricted direct product of the groups [formula] as follows. Consider the restricted direct product [formula] with respect to the groups [formula] for all v with [formula] and [formula]. If we denote each element in this restricted direct product by Π'v(gv,ξv) so that gv∈Kv and ξv = 1 for almost all v, we have the surjection

[formula]

where the product Πvξv is literary the product inside μn. This is a group homomorphism because [formula] and the groups [formula] and [formula] are defined, respectively, by τr and τr,v. We have

[formula]

where ker ρ consists of the elements of the form (1,ξ) with [formula] and Πvξv = 1.

Let π be a representation of [formula] where [formula] is the metaplectic preimage of a subgroup [formula]. Just like the local case, we call π genuine if [formula] acts as multiplication by ξ for all ξ∈μn. Also we have the notion of automorphic representation as well as automorphic form on [formula] or [formula]. In this paper, by an automorphic form, we mean a smooth automorphic form instead of a K-finite one, namely an automorphic form is Kf-finite, Z-finite and of uniformly moderate growth. (See [\cite=Cogdell].) Hence if π is an automorphic representation of [formula] (or [formula]), the full group [formula] (or [formula]) acts on π. An automorphic form f on [formula] (or [formula]) is said to be genuine if f(g,ξ) = ξf(g,1) for all [formula] (or [formula]). In particular every automorphic form in the space of a genuine automorphic representation is genuine.

Suppose we are given a collection of irreducible admissible representations πv of [formula] such that πv is κ(Kv)-spherical for almost all v. Then we can form an irreducible admissible representation of [formula] by taking a restricted tensor product [formula] as usual. Suppose further that ker ρ acts trivially on [formula], which is always the case if each πv is genuine. Then it descends to an irreducible admissible representation of [formula], which we denote by [formula], and call it the "metaplectic restricted tensor product". Let us emphasize that the space for [formula] is the same as that for [formula]. Conversely, if π is an irreducible admissible representation of [formula], it is written as [formula] where πv is an irreducible admissible representation of [formula], and for almost all v, πv is κ(Kv)-spherical. (To see it, view π as a representation of the restricted product [formula] by pulling it back by ρ as in ([\ref=E:surjection]) and apply the usual tensor product theorem for the restricted direct product. This gives the restricted tensor product [formula], where each πv is genuine, and hence it descends to [formula].)

Finally in this section, let us mention that we define

[formula]

namely [formula]. The author does not know if this is equal to [formula] unless n = 2, in which case the Hasse-Minkowski theorem implies those two coincide. Similarly we define

[formula]

The metaplectic cover [formula] of the Levi M

Both locally and globally, one cannot show the cocycle τr has the block-compatibility as in ([\ref=E:compatibility]) (except when r = 2). Yet, in order to define the metaplectic tensor product, it seems to be necessary to have the block-compatibility of the cocycle. To get round it, we will introduce another cocycle τM, but this time it is a cocycle only on the Levi M, and will show that τM is cohomologous to the restriction τr|M  ×  M of τr to M  ×  M both for the local and global cases.

The cocycle τM

In this subsection, we assume that all the groups are over F if F is local and over [formula] if F is global, and suppress it from our notation.

We define the cocycle

[formula]

by

[formula]

where ( - , - ) is the local or global Hilbert symbol. Note that the definition makes sense both locally and globally. Moreover the global τM is the product of the local ones.

We define the group [formula] to be

[formula]

as a set and the group structure is given by τM. The superscript c is for "compatible". One advantage to work with [formula] is that each [formula] embeds into [formula] via the natural map

[formula]

Indeed, the cocycle τM is so chosen that we have this embedding.

Also recall our notation

[formula]

and

[formula]

We define [formula] analogously to [formula], namely the group structure of [formula] is defined via the cocycle τM. Of course, [formula] is a subgroup of [formula]. Note that each [formula] naturally embeds into [formula] as above.

Locally or globally, it suffices to show τM(gi,gj) = τM(gj,gi) for [formula] and [formula]. But the block-compatibility of the 2-cocycle τM, we have τM(gi,gj) = τri(gi,Irj)τrj(Irj,gj) = 1, and similarly have τM(gj,gi) = 1.

The block-compatibility of τM guarantees that the map is indeed a group homomorphism. The description of the kernel is immediate.

The relation between τM and τr

Note that for the group [formula] (instead of [formula]), the group structure is defined by the restriction of τr to M  ×  M, and hence each [formula] might not embed into [formula] in the natural way because of the possible failure of the block-compatibility of τr unless r = 2. To make explicit the relation between [formula] and [formula], the discrepancy between τM and τr|M  ×  M (which we denote simply by τr) has to be clarified.

Local case:

Assume F is local. Then we have

[formula]

so τM and σr|M  ×  M are cohomologous via the function [formula]. Here recall from Section [\ref=S:group] that the map [formula] relates τri with σri by

[formula]

for [formula]. Moreover if |n|F = 1, sri is chosen to be "canonical" in the sense that ([\ref=E:canonical_section]) is satisfied.

The block-compatibility of σr implies

[formula]

for [formula] and [formula]. Hence if we define M:M  →  μn by

[formula]

we have

[formula]

namely τr and τM are cohomologous via M. Therefore we have the isomorphism

[formula]

The following lemma will be crucial later for showing that the global τM is also cohomologous to [formula].

First note that if k,k'∈M(OF), then τr(k,k') = τM(k,k') = 1 and so by ([\ref=E:s_hat]) we have

[formula]

i.e. M is a homomorphism on MM(OF). Hence it suffices to prove the lemma only for the elements k∈M(OF) of the form

[formula]

where [formula] is in the [formula] place on the diagonal. Namely we need to prove

[formula]

In what follows, we will show that this follows from the "canonicality" of sr and sri, and the fact that the cocycle for [formula] is block-compatible in a very strong sense as in [\cite=BLS]. Recall from ([\ref=E:canonical_section]) that sr has been chosen to satisfy [formula], where [formula] is the map on [formula] that makes the diagram ([\ref=E:canonical_diagram]) commute. Similarly for sri with r replaced by ri. Let us write

[formula]

for the embedding that is used to define the cocycle σri. Define the embedding

[formula]

where A is a ri  ×  ri-block and accordingly b is ri  ×  1, c is 1  ×  ri and d is 1  ×  1. Note that this embedding is chosen so that we have

[formula]

By the block compatibility of [formula] we have

[formula]

This is nothing but [\cite=BLS]. (The reader has to be careful in that the image [formula] is not a standard subgroup in the sense defined in [\cite=BLS] if one chooses the set Δ of simple roots of [formula] in the usual way. One can, however, choose Δ differently so that [formula] is indeed a standard subgroup. And all the results of [\cite=BLS] are totally independent of the choice of Δ.) This implies the map (gi,ξ)  ↦  (F(gi),ξ) for [formula] is a homomorphism. Hence the canonical section [formula], which is given by [formula], restricts to the canonical section [formula], which is given by [formula]. Namely we have the commutative diagram

[formula]

where all the maps are homomorphisms. In particular, we have

[formula]

for all [formula]. Thus

[formula]

The lemma has been proven.

Global case:

Assume F is a number field. We define [formula] by

[formula]

for [formula]. The product is finite thanks to Lemma [\ref=L:s_hat_M]. Since both of the cocycles τr and τM are the products of the corresponding local ones, one can see that the relation ([\ref=E:s_hat]) holds globally as well.

Thus analogously to the local case, we have the isomorphism

[formula]

For each i the splitting [formula] is given by gi  ↦  (gi,  sri(gi)- 1), where [formula] is defined via the cocycle τri. The lemma follows by the block-compatibility of τM and the product formula for the Hilbert symbol.

Just like the case of [formula], the section [formula] as in this lemma cannot be defined on all of [formula] even set theoretically because the expression [formula] does not make sense to all [formula]. So we only have a partial set theoretic section

[formula]

But analogously to Proposition [\ref=P:s_split], we have

This follows from Proposition [\ref=P:s_split] applied to each [formula] together with the block-compatibility of the cocycle τM. (Note that one also needs to use the fact that for all g,g' in the subgroup generated by M(F) and [formula], we have [formula].)

This splitting is related to the splitting [formula] by

For [formula], we have

[formula]

where for the elements in M(F), all of sri and sr are defined globally, and the second equality follows from the definition of M as in ([\ref=E:s_hat_M]).

This proposition implies

If π is realized in a space V of automorphic forms on [formula], then [formula] is realized in the space of functions of the form [formula] for f∈V. The automorphy follows from the commutativity of the diagram in the above lemma.

The following remark should be kept in mind for the rest of the paper.

The center [formula] of [formula]

In this subsection F is either local or global, and accordingly we let R = F or [formula] as in the notation section. And all the groups are over R.

For any group H (metaplectic or not), we denote its center by ZH. In particular for each group [formula], we let

[formula]

For the Levi part [formula], we of course have

[formula]

But for the center [formula] of [formula], we have

[formula]

in general, and indeed [formula] might not be even commutative.

In what follows, we will describe [formula] in detail. For this purpose, let us start with

First let us note that if we write σr  =  σ(c)r to emphasize the parameter c, then

[formula]

because (ar, det (g))- 1 = ( det (g),ar). Hence it suffices to show the lemma for the case c = 0.

But this can be done by using the recipe provided by [\cite=BLS]. Namely let g = ntηn' for n,n'∈NB, t∈T and [formula]. Then

[formula]

Now by Proposition [\ref=P:BLS] (3), σ(η,aIr) is a product of ( - a,a)'s, which is 1. Hence by using Proposition [\ref=P:BLS] (4), we have

[formula]

By an analogous computation, one can see

[formula]

Using (a,ti)- 1 = (ti,a), one can see

[formula]

But this is equal to ( det (g),ar - 1) because [formula].

Note that this lemma immediately implies that the center [formula] of [formula] is indeed as in ([\ref=E:center_GLt]), though a different proof is provided in [\cite=KP].

Also with this lemma, we can prove

First assume F is local. Let [formula] and [formula]. It suffices to show σr(m,a)σr(a,m)- 1 = 1 if and only if all ai are as in the proposition. But

[formula]

where for the third equality we used the above lemma with r replaced by ri.

Now assume a is such that [formula]. Then the above product must be 1 for any m. In particular, choose m so that gj = 1 for all i  ≠  j. Then we must have [formula] for all [formula]. This implies

[formula]

for all i. Since this holds for all i, one can see a- 1iaj∈F×  n for all i  ≠  j, which implies [formula]. But if [formula], then

[formula]

This must be equal to 1 for any choice of gi, which gives ar - 1 + 2cri∈F×  n.

Conversely if a is of the form as in the proposition, one can see that [formula] for any m.

The global case follows from the local one because locally by using ([\ref=E:tau_sigma]) and am = ma, one can see σr(m,a)σr(a,m)- 1 = 1 if and only if τr(m,a)τr(a,m)- 1 = 1, and the global τr is the product of local ones.

Lemma [\ref=L:to_compute_center] also implies

The local case is an immediate corollary of Lemma [\ref=L:to_compute_center] because if [formula] the lemma implies σr(g,aIr) = σr(aIr,g). Hence by ([\ref=E:tau_sigma]), locally τr(g,aIr) = τr(aIr,g) for all [formula] and a∈F×. Since the global τr is the product of the local ones, the global case also follows.

Let us mention that in particular, if n = 2 and [formula], then [formula] and [formula] is the center of [formula]. This fact is used crucially in [\cite=Takeda1].

It should be mentioned that this description of the center [formula] easily implies

[formula]

Also we have

By the block compatibility of the cocycle τM, one can see that an element of the form [formula] commutes with all the elements in [formula] if and only if each (aiIri,ξ) commutes with all the elements in [formula]. But this is always the case by the above lemme (with r replaced by ri). This proves the proposition.

If F is global, we define

[formula]

where recall that [formula] is the section that splits M(F). Similarly we define groups like [formula], etc. Namely in general for any subgroup [formula], we define the "F-rational points" [formula] of [formula] by

[formula]

The abelian subgroup [formula]

Again in this subsection, F is local or global, and R = F or [formula]. As we mentioned above, the preimage [formula] of the center ZM of the Levi M might not be even commutative. For later purposes, we let [formula] be a closed abelian subgroup of [formula] containing the center [formula]. Namely [formula] is a closed abelian subgroup such that

[formula]

We let

[formula]

where p is the canonical projection. If F is global, we always assume [formula] is chosen compatibly with the local [formula] in the sense that we have

[formula]

Note that if AM(Fv) (hence [formula]) is closed, then [formula] (hence [formula]) is closed by Lemma [\ref=L:closed_subgroup_local_global].

Of course there are many different choices for [formula]. But we would like to choose [formula] so that the following hypothesis is satisfied:

The author does not know if one can always find such [formula] for general n. But at least we have

This is proven in Appendix [\ref=A:topology].

We believe that for any reasonable choice of [formula] the above hypothesis is always satisfied, but the author does not know how to prove it at this moment. This is a bit unfortunate in that this subtle technical issue makes the main theorem of the paper conditional when n > 2. However if n = 2, our main results are complete, and this is the only case we need for our applications to symmetric square L-functions in [\cite=Takeda1] [\cite=Takeda2], which is the main motivation for the present work.

Let us mention that the group [formula] (for any choice of AM) is a normal subgroup of [formula], and hence the quotient [formula] is a group. Accordingly, if the hypothesis is satisfied, the image of M(F) in the quotient is a discrete subgroup and hence closed.

Also we have

[formula]

following the convention as in ([\ref=E:H(F)]), and we set

[formula]

On the local metaplectic tensor product

In this section we first review the local metaplectic tensor product of Mezo [\cite=Mezo] and then extend his theory further, first by proving that the metaplectic tensor product behaves in the expected way under the Weyl group action, and second by establishing the compatibility of the metaplectic tensor product with parabolic inductions. Hence in this section, all the groups are over a local (not necessarily non-archimedean) field F unless otherwise stated. Accordingly, we assume that our metaplectic group is defined by the block-compatible cocycle σr of [\cite=BLS], and hence by [formula] we actually mean [formula].

Mezo's metaplectic tensor product

Let [formula] be irreducible genuine representations of [formula], respectively. The construction of the metaplectic tensor product takes several steps. First of all, for each i, fix an irreducible constituent π(n)i of the restriction [formula] of πi to [formula]. Then we have

[formula]

where g runs through a finite subset of [formula], mi is a positive multiplicity and g(π(n)i) is the representation twisted by g. Then we construct the tenor product representation

[formula]

of the group [formula]. Note that this group is merely the direct product of the groups [formula]. The genuineness of the representations [formula] implies that this tensor product representation descends to a representation of the group [formula], i.e. the representation factors through the natural surjection

[formula]

We denote this representation of [formula] by

[formula]

and call it the metaplectic tensor product of [formula]. Let us note that the space Vπ(n) of π(n) is simply the tensor product [formula] of the spaces of π(n)i. Let ω be a character on [formula] such that for all [formula] where a∈F× we have

[formula]

Namely ω agrees with π(n) on the intersection [formula]. We can extend π(n) to the representation

[formula]

of [formula] by letting [formula] act by ω. Now extend the representation π(n)ω to a representation ρω of a subgroup [formula] of [formula] so that ρω satisfies Mackey's irreducibility criterion and so the induced representation

[formula]

is irreducible. It is always possible to find such [formula] and moreover [formula] can be chosen to be normal. Mezo shows in [\cite=Mezo] that πω is dependent only on ω and is independent of the other choices made throughout, namely the choices of π(n)i, [formula] and ρω. We write

[formula]

and call it the metaplectic tensor product of [formula] with the character ω.

Mezo also shows that the metaplectic tensor product πω is unique up to twist. Namely

This is [\cite=Mezo].

Let us mention the following, which is not explicitly mentioned in [\cite=Mezo].

The restriction [formula] contains a representation of the form [formula] for some representations π(n)i of [formula]. Let πi be an irreducible constituent of [formula]. Then one can see that πω is [formula].

From Mezo's construction, one can tell that essentially the representation theory of the group [formula] is determined by that of [formula]. Let us briefly explain why this is so. Let π be an irreducible admissible representation of [formula], and [formula] be the distribution character. If π is genuine, so is χπ. Namely χπ((1,ξ)) = ξχπ() for all ξ∈μn and [formula]. But if [formula] is a regular element but not in [formula], then one can find ξ∈μn with ξ  ≠  1 such that (1,ξ) is conjugate to [formula]. This is proven in the same way as [\cite=KP]. (The only modification one needs is to choose A  ⊂  Mr(F) in their proof so that [formula].) Therefore for such [formula], one has χπ() = 0. Namely, the support of χπ is contained in [formula]. (Indeed, this argument by the distribution character is crucially used in [\cite=Mezo]. ) This explains why π is essentially determined by the restriction [formula].

This idea can be observed in

This follows from Proposition [\ref=P:local_uniqueness] and Lemma [\ref=L:always_tensor_product].

Also let us mention

By inducting in stages, we have [formula], where [formula] is as in ([\ref=E:Mezo_tensor]), and by [\cite=Mezo] we have

[formula]

where χ runs over the finite set of characters of [formula] that are trivial on [formula]. Moreover it is shown in [\cite=Mezo] that any extension of π(n)ω to [formula] is of the form [formula] and [formula] for all χ by [\cite=Mezo]. Hence we have

[formula]

Let ω be as above and [formula] as in Section [\ref=S:abelian]. The restriction [formula] gives a character on [formula] because [formula] is contained in the center of [formula] by ([\ref=E:center_Mtn]). The product [formula] of ω and [formula] defines a character on [formula] because the two characters agree on [formula]. Since the Pontryagin dual is an exact functor, one can extend it to a character on [formula], which we denote again by ω. Namely ω is a character on [formula] extending ω such that ω(a) = π(n)(a) for all [formula]. With this said, we have

This follows from the previous proposition because we have the inclusion [formula].

The archimedean case

Let us make some remarks when F is archimedean. Strictly speaking, Mezo assumes that the field F is non-archimedean. If [formula], then [formula]. Indeed, [formula] (direct product), and the metaplectic tensor product is obtained simply by taking the tensor product [formula] and descending it to [formula]. Hence there is essentially no discrepancy between the metaplectic case and the non-metaplectic one.

If [formula] (so necessarily n = 2), one can trace the argument of Mezo and make sure the construction works for this case as well, with the proviso that equivalence has to be considered as infinitesimal equivalence. However, it has been communicated to the author by J. Adams that for this case, the induced representation [formula] is always irreducible. (See [\cite=Adams]). Hence one can simply define the metaplectic tensor product to be this induced representation.

Twists by Weyl group elements

As in the notation section, we let WM be the subset of the Weyl group [formula] consisting of only those elements which permute the [formula]-factors of [formula]. Though WM is not a group in general, it is identified with the group Sk of permutations of k letters. Assume w∈WM is such that

[formula]

for a permutation σ∈Sk, and so [formula] for each [formula]. Namely w corresponds to the permutation σ- 1. Then we have

[formula]

Let [formula] be an irreducible admissible representation of [formula]. As in the notation section one can define the twist [formula] of π by [formula] to be the representation of [formula] on the space Vπ given by [formula] for [formula]. To ease the notation we simply write

[formula]

Actually since [formula] is in the center, for any preimage w̃ of w, we have [formula], and hence the notation wπ is not ambiguous.

The goal of this subsection is to show that the metaplectic tensor product behaves in the expected way under the Weyl group action. Namely, we will prove

To prove this, we first need

Note that [formula] and [formula] because we are using [formula], and hence

[formula]

Let

[formula]

We need to show φw(m) = 1 for all m∈M(n). Let us first show that the map m  ↦  φw(m) is a homomorphism on M(n). To see it, for m,m'∈M(n) we have

[formula]

On the other hand, we have

[formula]

where the last equality follows because σr(wmw- 1,wm'w- 1) = σr(m,m') by the block-compatibility of σr. Hence by comparing those two, one obtains φw(mm') = φw(m)φw(m'). Therefore to show φw(m) = 1, it suffices to show it for the elmenets of the form

[formula]

for [formula].

Then one can rewrite φw(m) as follows:

[formula]

where for the third equality we used Proposition [\ref=P:BLS] (0). So we only have to show

[formula]

This can be shown by using the algorithm computing the cocycle σr given by [\cite=BLS]. To use the results of [\cite=BLS], it should be mentioned that one needs to use the set [formula] for a set of representatives of the Weyl group of [formula] as defined in the notation section. Also let us recall the following notation from [\cite=BLS]: For each [formula], the "torus part function" [formula] is the unique map such that

[formula]

where n,n'∈NB, t∈T and [formula] when [formula] is written as

[formula]

by the Bruhat decomposition. Namely [formula] is the "torus part" of g.

Using this language, each w∈WM is written as

[formula]

where [formula], and [formula] is of the form

[formula]

where εi∈{  ±  1}.

We are now ready to carry out our cocycle computations for ([\ref=E:cocycle_computation1]). Let us deal with σr(m,w- 1) first. Write m = ntηn' by the Bruhat decomposition, so [formula]. But recall that we are assuming m is of the form as in ([\ref=E:form_of_m]), so the decomposition ntηn' takes place essentially inside the [formula]-block. In particular, we can write

[formula]

where [formula]. (Note that det (ti)∈F×  n.) Then one can compute σr(m,w- 1) as follows:

[formula]

Now since η is essentially inside the [formula]-factor of M and ηw- 1 only permutes the [formula]-factors of M, we have l(ηηw- 1) = l(η) + l(ηw- 1), where l is the length function. Hence by applying [\cite=BLS], we have

[formula]

Here note that [formula] is of the form [formula] and η is in the [formula]-block. Hence [formula]. Thus by the block-compatibility of σr, ([\ref=E:cocycle_computation2]) is written as

[formula]

Clearly, if εi = 1, then both σri(ti,εiIri) and σri(ηi,εiIri) are 1. If εi =  - 1, then by Proposition [\ref=P:BLS] (3), one can see that σri(ηi,εiIri) = 1. Hence in either case, one has

[formula]

Next let us deal with σr(w- 1,wmw- 1) in ([\ref=E:cocycle_computation1]). First by the analogous computation to what we did for σ(m,w- 1), one can write

[formula]

Since w corresponds to the permutation σ- 1, if we let

[formula]

be the embedding of [formula] into the corresponding [formula]-factor of wMw- 1, then ([\ref=E:cocycle_computation4]) is written as

[formula]

Note that [formula] and l(ηw- 1τi(ηi)) = l(ηw- 1) + l(τi(ηi)). Hence by using [\cite=BLS], this is written as

[formula]

By the block compatibility of σr, one can see

[formula]

Also to compute σr(ηw- 1,τi(ti)), one needs to use Proposition [\ref=P:BLS] (3). For this purpose, let us write

[formula]

where [formula]. By looking at the formula in Proposition [\ref=P:BLS] (3), one can see that σr(ηw- 1,τi(ti)) is a power of

[formula]

which is equal to [formula] because [formula]. Hence ([\ref=E:cocycle_computation5]), which is the same as ([\ref=E:cocycle_computation4]), becomes

[formula]

Hence the left hand side of ([\ref=E:cocycle_computation1]) is written as

[formula]

We need to show this is 1. But clearly this is the case if εi = 1. So let us assume εi =  - 1. Namely we will show σri( - Iri,ti)- 1σri(ti, - Iri) = 1. But by Proposition [\ref=P:BLS] (4), one can compute

[formula]

and

[formula]

Noting that ( - 1,ai)- 1 = (ai, - 1), we have

[formula]

where the last equality follows because [formula]. This completes the proof.

Now we are ready to prove Theorem [\ref=T:Weyl_group_local].

By restricting to [formula], one can see that the left hand side of ([\ref=E:Weyl_group_local]) contains the representation [formula] and the right hand side of ([\ref=E:Weyl_group_local]) contains [formula], where [formula] is the representation of [formula] whose space is the space of [formula]. Hence by Lemma [\ref=L:equivalent_tensor_product], it suffices to show that

[formula]

But this can be seen from the commutative diagram

[formula]

where the left most arrow is the representation of [formula] (direct product) acting on the space of [formula] by permuting each factor by σ- 1, which descends to the representation [formula] of [formula]. To see this indeed descends to [formula], one needs the above lemma.

Compatibility with parabolic induction

We will show the compatibility of the metaplectic tensor product with parabolic induction. Hence we consider the standard parabolic subgroup [formula] where M is the Levi part and N the unipotent radical.

First let us mention

Though this seems to be well-known, we will give a proof here. Let [formula] and [formula], where n∈N. (Note that since we are assuming the group [formula] is defined by σr, each element in [formula] is written as (n,1).) We may assume  = (m,1) for m∈M. Noting that - 1 = (m- 1,σr(m,m- 1)- 1), we compute

[formula]

By Proposition [\ref=P:BLS] (1), σr(m,n) = 1. Also since mnm- 1∈N, we have σr(mn,m- 1) = σr(mnm- 1m,m- 1) = σr(m,m- 1) again by Proposition [\ref=P:BLS] (1). Thus we have [formula].

By this lemma, we can write

[formula]

where [formula] normalizes [formula] and hence for a representation π of [formula] one can form the induced representation

[formula]

by letting [formula] act trivially.

First we need

To show it is one-to-one, assume [formula]. We need to show φ = 0. But for any [formula], one can write [formula], where [formula] and [formula]. Hence any [formula] is written as   =  ' for some [formula] and [formula]. Hence φ() = π()φ('). But φ(') = 0. Hence φ() = 0.

To show it is onto, let [formula]. Define [formula] by

[formula]

where η is chosen to be such that [formula]. Namely η is given by the cocycle as

[formula]

That [formula] follows because if [formula] then [formula]. Also one can check [formula] as follows: We need to check φ((g,ξ)) = π()φ(g,ξ) for all [formula]. But since π (and hence φ) is genuine, we may assume [formula] is of the form (m,1) for m∈M and ξ = 1. Then

[formula]

where

[formula]

Now

[formula]

where

[formula]

Since [formula], the right hand side of ([\ref=E:F_tilde]) becomes

[formula]

where

[formula]

and

[formula]

Then one can compute

[formula]

by using Proposition [\ref=P:BLS] (0). Hence ([\ref=E:F_tilde]) is written as

[formula]

This completes the proof.

With this lemma, one can prove the theorem.

Let π(n)i be an irreducible constituent of the restriction [formula]. By the above lemma, it is an irreducible constituent of

[formula]

Noting that [formula], we have the inclusion

[formula]

But since σi is a metaplectic tensor product of [formula], the restriction [formula] is a sum of representations of the form

[formula]

where each τ(n)i,t is an irreducible constituent of the restriction [formula] of τi,t to [formula]. Note that this is a metaplectic tensor product representation of [formula]. Hence the metaplectic tensor product

[formula]

is an irreducible constituent of

[formula]

Note that the metaplectic tensor product for the group [formula] can be defined for reducible representations, and hence [formula] is defined and the space of the representation is the same as the one for the usual tensor product. In particular, the space of the representation ([\ref=E:tensor_of_tensor]) is the usual tensor product. Then one can see that ([\ref=E:tensor_of_tensor]) is equivalent to

[formula]

(To see this one can define a map from ([\ref=E:tensor_of_tensor]) to ([\ref=E:tensor_of_tensor2]) by [formula] where [formula] is the product of functions which can be naturally viewed as a function on [formula].)

Now let ω be a character on [formula] that agrees with π(n) on [formula], so that the product

[formula]

is a well-defined representation of [formula]. Now all the constituents of the representation ([\ref=E:tensor_of_tensor2]) have the same central character, and hence ω agrees with ([\ref=E:tensor_of_tensor2]) on [formula], and hence π(n)ω is a constituent of

[formula]

Recall that the metaplectic tensor product πω is a constituent of

[formula]

and hence a constituent of

[formula]

which is

[formula]

by inducing in stages.

Now one can see that the inner induced representation in ([\ref=E:tensor_of_tensor3]) is equal to

[formula]

where the unipotent group [formula] acts trivially and [formula] is the Levi part of [formula], namely

[formula]

By Proposition [\ref=P:Mezo] applied to the Levi [formula], the representation ([\ref=E:tensor_of_tensor4]) is a sum of the metaplectic tensor product

[formula]

Hence πω is a constituent of [formula] as claimed.

The global metaplectic tensor product

Starting from this section, we will show how to construct the metaplectic tensor product of unitary automorphic subrepresentations. Hence all the groups are over the ring of adeles unless otherwise stated, and it should be recalled here that as in [\eqref=E:star] the group [formula] is the image of [formula] under the partial map [formula], and we simply write [formula] for [formula], when there is no danger of confusion. Also throughout the section the group [formula] is an abelian group that satisfies Hypothesis ([formula]).

The construction

The construction is similar to the local case in that first we consider the restriction to [formula], though we need an extra care to ensure the automorphy.

Let us start with the following.

This follows from the admissibility and unitarity of [formula].

The lemma implies that the restriction [formula] is also completely reducible. (See the notation section for the notation [formula].) Hence each irreducible constituent of [formula] is a subrepresentation. Let

[formula]

be an irreducible subrepresentation. Then each vector f∈π(n)i is the restriction to [formula] of an automorphic form on [formula]. Hence one can naturally view each vector f∈π(n)i as a function on the group

[formula]

Namely the representation π(n)i is an irreducible representation of the group [formula] realized in a space of "automorphic forms on Hi".

Note that Hi is indeed a group and moreover it is closed in [formula], which can be shown by using Lemma [\ref=L:discrete_sub]. Also note that each element in Hi is of the form (hi,ξi) for [formula] and ξi∈μn. By the product formula for the Hilbert symbol and the block-compatibility of the cocycle τM, we have the natural surjection

[formula]

given by the map [formula] because [formula] for all [formula].

Now we can construct a metaplectic tensor product of [formula], which is an "automorphic representation" of [formula] realized in a space of "automorphic forms on [formula]" as follows.

Since πi is genuine, for each fi∈Vπ(n)i and g∈Hi, we have fi(g(1,ξ)) = fi((1,ξ)g) = ξfi(g) for all ξ∈μn. Now the kernel of the map ([\ref=E:global_surjection]) consists of the elements of the form [formula] with [formula]. Hence each [formula], viewed as a function on the direct product [formula], factors through the map ([\ref=E:global_surjection]), which we denote by [formula]. Namely we can naturally define a function [formula] on [formula] by

[formula]

One can see each function [formula] is "automorphic" as follows: For [formula] and [formula], we have

[formula]

Just like the local case, we would like to extend the representation π(n) to a representation of [formula] by letting [formula] act as a character. This is certainly possible by choosing an appropriate character because [formula] is in the center of [formula]. To ensure the resulting representation is automorphic, however, one needs extra steps to do it.

For this purpose, let us, first, define

[formula]

Note that this is not necessarily the same as [formula]. Also let

[formula]

By our assumption on [formula] (Hypothesis ([formula])), the image of [formula] (and hence [formula]) in the quotient [formula] is discrete. Hence by Lemma [\ref=L:discrete_sub], H is a closed (and hence locally compact) subgroup of [formula]. Also note that the group [formula] commutes pointwise with the group H by Proposition [\ref=P:Z_M_commute_Mtn] and hence [formula] is in the center of H.

We need the following subtle but important lemma.

Let π(n)Hi be an irreducible subrepresentation of [formula] such that [formula]. Analogously to the construction of [formula], one can construct the representation [formula] of [formula]. (The space of this representation is again a space of "automorphic forms on [formula]" but this time it is an irreducible representation of the group [formula], rather than just [formula]. The construction is completely the same as π(n) and one can just modify the proof of Proposition [\ref=P:tensor_product_Mtn].) Then one can see

[formula]

and

[formula]

Let π(n)H be an irreducible subrepresentation of [formula] such that

[formula]

where both sides are spaces of functions on [formula]. Such π(n)H certainly exists, since each πi is unitary and the unitary structure descends to [formula] making it unitary. Now since π(n)H is unitary and H is locally compact, π(n)H admits a central character χ. Thus for each f∈Vπ(n)H and a fortiori each f∈Vπ(n), we have f(ah) = χ(a)f(h) for a∈ZH and h∈H.

In the above lemma, if [formula], we have χ(a) = 1 by the automorphy of f, namely χ is a "Hecke character on ZH".

Now define a character ω on [formula] such that ω is trivial on [formula] and

[formula]

Such ω certainly exists because [formula] is viewed as a character on the group [formula], which is a locally compact abelian group naturally viewed as a closed subgroup of the locally compact abelian group [formula], and thus it can be extended to [formula].

For each f∈π(n), viewed as a function on [formula], we extend it to a function [formula] by

[formula]

This is well-defined because of our choice of ω, and

The lemma follows from the definition of fω and the obvious equality [formula].

The group [formula] acts on the space of functions of the form fω, giving rise to an "automorphic representation" π(n)ω of [formula], namely

[formula]

and [formula] acts as the character ω. As abstract representations, we have

[formula]

where by ω  ·  π(n) is the representation of the group [formula] extended from π(n) by letting [formula] act via the character ω.

We need to make sure the relation between π(n)ω and its local analogue we constructed in the previous section. For this, let us start with

Since π(n) is an irreducible quotient, there is a surjective [formula] map

[formula]

Fix a place v0. Since [formula], there exists a pure tensor [formula] such that [formula]. (Note that, as we have seen, the space of [formula] is the space of the usual restricted tensor product [formula].) Define

[formula]

by

[formula]

for w∈Vπv0. Then the composite [formula] is a non-zero [formula] intertwining. Let w∈πv0 be such that [formula]. Then [formula] is a finite linear combination of pure tensors, and indeed it is written as

[formula]

where xi∈π(n)v0 and [formula]. Here one can assume that [formula] are linearly independent. Let [formula] be a linear functional such that λ(y1)  ≠  0 and [formula]. (Such λ certainly exits because [formula] are linearly independent.) Consider the map

[formula]

defined on pure tensors by

[formula]

This is a non-zero [formula] intertwining map. Moreover the composite [formula] gives a non-zero [formula] intertwining map from πv0 to π(n)v0. Hence π(n)v0 is an irreducible constituent of the restriction [formula].

By taking k = 1 in the above lemma, one can see that if one writes

[formula]

then each local component π(n)i,v is an irreducible constituent of [formula] where πi,v is the v-component of [formula]. Then one can see that for [formula], if we write [formula], we have

[formula]

where the right hand side is the local metaplectic tensor product representation of [formula]. Also one can see that the character ω decomposes as [formula] where ωv is a character on [formula]. Hence by ([\ref=E:pin_omega]) we have

Now that we have constructed the representation π(n)ω of [formula], we can construct an automorphic representation of [formula] analogously to the local case by inducing it to [formula], though we need extra care for the global case. First consider the compactly induced representation

[formula]

where φ is such that φ(hm) = π(n)ω(h)φ(m) for all [formula] and [formula], and the map m  ↦  φ(m;1) is a smooth function on [formula] whose support is compact modulo [formula]. (Note here that for each [formula] and [formula], φ(m)∈Vπ(n)ω is a function on [formula]. For [formula], we use the notation φ(m;m') for the value of φ(m) at m' instead of writing φ(m)(m').) Also consider the metaplectic restricted tensor product

[formula]

where for almost all v at which all the data defining [formula] are unramified, we choose the spherical vector [formula] to be the one defined by

[formula]

where [formula] is the spherical vector defining the restricted metaplectic tensor product [formula]. (Let us mention that we do not know if the dimension of the spherical vectors in [formula] is one or not.) One has the injection

[formula]

given by [formula]. The reason the image of T lies in the compactly induced space is because for almost all v, the support of [formula] is [formula] and for all v the index of [formula] in [formula] is finite by ([\ref=E:finite_quotient]). (Indeed, the support property and the finiteness of this index imply that T is actually onto as well, though we do not use this fact.)

Let

[formula]

namely V(π(n)ω) is the image of T. For each φ∈V(π(n)ω), define [formula] by

[formula]

Let us note that by AMM(n)(F) we mean [formula], which is not necessarily the same as AM(F)M(n)(F), and

[formula]

By the automorphy of π(n)ω, φ is left invariant on [formula] and hence the sum is well-defined. Also note that for each fixed [formula] the map m'  ↦  φ(m'm;1) is compactly supported modulo [formula]. Now by our assumption on [formula] (Hypothesis ([formula])), the image of M(F) is discrete in [formula], and hence the group [formula] naturally viewed as a subgroup of [formula] is discrete. Now a discrete subgroup is always closed by [\cite=Deitmar]. Thus the above sum is a finite sum, and in particular the sum is convergent. Moreover one can find φ with the property that the support of the map m'  ↦  φ(m';1) is small enough so that if [formula], then φ(γ;1)  ≠  0 only at γ = 1. Thus the map [formula] is not identically zero.

One can verify that [formula] is a smooth automorphic form on [formula]: The automorphy is clear. The smootheness and Kf-finiteness follows from the fact that at each non-archimedean v, the induced representation [formula] is smooth and admissible. That [formula] is Z-finiteness and of uniform moderate growth follows from the analogous property of [formula], because the Lie algebra of [formula] at archimedean v is the same as that of [formula].

As we already mentioned, the sum in ([\ref=E:definition]) is finite. But a priori which [formula] contributes to the above sum depends on m. Yet, one can show that as m runs through [formula], only finitely many γ's contribute. To show it, we need the following lemma.

It is well-known that the strong approximation theorem implies

[formula]

and the index of (F×v)n in F×v is finite. This proves the lemma.

We may assume that φ is of the form [formula] for a simple tensor [formula]. Then there exists a finite set S of places such that for all k∈κ(KS), we have k  ·  φ  =  φ, where [formula] and [formula] is the section m  ↦  (m,1). Namely the stabilizer of φ contains κ(KS). Then one can see that

[formula]

for all [formula]. Also we have [formula]. Hence, noting that [formula], we see that the γ's that contribute to the sum in ([\ref=E:definition]) depend only on the class in

[formula]

But one can see that this set can be identified with the product of k copies of

[formula]

where [formula], and this set is finite by Lemma [\ref=L:strong_approximation]. This implies that there are only finitely many [formula] such that [formula] for at least some [formula]. This completes the proof.

Since the map [formula] is [formula]-intertwining, the space [formula] provides a space of (possibly reducible) automorphic representation of [formula]. Hence πω is an automorphic representation of [formula].

Since each πi is unitary, so is each π(n)i, from which one can see that π(n)ω is unitary. Since V(π(n)ω) is a subrepresentation of the compactly induced representation induced from the unitary π(n)ω, V(π(n)ω) is unitary. Hence πω, which is a subquotient of [formula], is actually a quotient of [formula] by admissibility. With this said, one can derive the isomorphism [formula] from Lemma [\ref=L:local_global]. Since the local πωv depends only on the choice of [formula], the global πω depends only on [formula] up to equivalence.

We call the above constructed πω the global metaplectic tensor product of [formula] (with respect to ω) and write

[formula]

The uniqueness

Just like the local case, the metaplectic tensor product of automorphic representations is unique up to twist.

By Theorem [\ref=T:main], the global metaplectic tensor product is written as the metaplectic restricted tensor product of the local metaplectic tensor products of Mezo. Hence by Proposition [\ref=P:local_uniqueness] for each i and each place v, there is a character ωi,v on [formula] trivial on [formula] such that [formula]. Let [formula]. Then [formula]. The automorphy of ω follows from that of πi and π'i. This proves the only if part. The if part follows similarly.

Cuspidality and square-integrability

In this subsection, we will show that the cuspidality and square-integrability are preserved for the metaplectic tensor product.

Assume [formula] are all cuspidal. It suffices to show that for each φ∈V(π(n)ω)

[formula]

for all unipotent radical U of the standard proper parabolic subgroup of M, where recall from Proposition [\ref=P:s_split_M] that the partial set theoretic section [formula] is defined (and a group homomorphism) on the groups M(F) and [formula]. We know that [formula] is a finite sum of [formula] for [formula]. Hence it suffices to show [formula]. Note that for each [formula] with [formula], we have

[formula]

where [formula]. Hence we may assume γ∈M(F) is a diagonal matrix, and so [formula]. Then we have

[formula]

We would like to show this is equal to zero. For this purpose, recall that for each γ, [formula] is in the space Vπ(n)ω and hence is (a finite sum of functions) of the form [formula] with fi∈Vπi and each fi is a cusp form. We may assume [formula] is a simple tensor [formula]. Now we can write [formula], where each Ui is a unipotent subgroup of [formula] with at least one of Ui non-trivial, and accordingly we denote each element u∈U by [formula]. Then by definition of [formula], we have

[formula]

and

[formula]

Hence

[formula]

This is equal to zero because each fi is cuspidal and at least one of Ui is non-trivial.

Next let us take care of the square-integrability.

We need a few lemmas for the proof of this theorem.

The first equality is [\cite=Bourbaki], and the second equality follows from the natural identification [formula].

Now let [formula] be any function. Then the absolute value |f| is non-genuine in the sense that it factors through [formula]. Also we let

[formula]

This is a closed subgroup by Lemma [\ref=L:closed_subgroup_local] and [\ref=L:closed_subgroup_local_global]. Note the inclusions

[formula]

where all the groups are closed subgroups of [formula]. Then we have

Let f be an automorphic form on [formula] with a unitary central character. Since |f| is non-genuine, we have

[formula]

where recall that [formula] is the canonical projection. Note that the quotient measure on the right hand side exists because the group [formula] is closed by [\cite=MW] and is unimodular because [formula] is unimodular and M(F) is discrete and countable. By Lemma [\ref=L:quotient_measure], we have

[formula]

Since for each fixed [formula], the function z  ↦  f(κ(zm)) is a smooth function on [formula], there exists a finite set S of places such that for all [formula] we have f(κ(z'zm)) = f(κ(zm)). Hence the inner integral of the above integral is written as

[formula]

Note that we have the inclusion

[formula]

because [formula], and note that [formula] can be identified with the product of k copies of

[formula]

By Lemma [\ref=L:strong_approximation], we know that this is a finite group, and hence the integral in ([\ref=E:square_integrable]) is just a finite sum. Thus for some finite [formula], we have

[formula]

where for the second equality we used

[formula]

where ω is the central character of f which is assumed to be unitary. The lemma follows from this.

Write each element [formula] as [formula] where [formula]. Then [formula] if and only if [formula] for all i. Hence the integral in the lemma is the product of integrals

[formula]

where [formula] consists of the elements of the form aiIri with [formula]. So we have to show that this integral converges. But with Lemma [\ref=L:M_square_integrable] applied to [formula], we know

[formula]

because each φi is square-integrable modulo center. By Lemmas [\ref=L:quotient_measure] and [\ref=L:discrete_sub], this is written as

[formula]

In particular the inner integral converges, which proves the lemma.

Now we are ready to prove Theorem [\ref=T:square_integrable].

By Lemma [\ref=L:M_square_integrable], we have only to show

[formula]

By Lemma [\ref=L:quotient_measure], we have

[formula]

Note that by Lemma [\ref=L:finite_sum], the sum of the integrand is finite. Also the map [formula] is invariant under [formula] on the left. Hence to show the inner integral converges, it suffices to show the integral

[formula]

converges. But this follows from Lemma [\ref=L:pin_square_integrable].

To show the outer integral converges, note that the map [formula] is smooth and hence there exists a finite set of places S so that [formula] for all k∈M(OS). Thus the integral in [\eqref=E:outer_integral] is (a scalar multiple of)

[formula]

Now the set theoretic map

[formula]

given by

[formula]

where ιi is as in ([\ref=E:iota]) is a well-defined surjection. Hence Lemma [\ref=L:strong_approximation] implies that the set

[formula]

is a finite set. Therefore the outer integral of the above integral is a finite sum and hence converges. This completes the proof.

Twists by Weyl group elements

Just as we saw in Section [\ref=S:Weyl_group_global] for the local case, the global metaplectic tensor product behaves in the expected way under the action of the Weyl group elements in WM. Namely

Note that each [formula] is written as [formula], where we view [formula] as an element of [formula] view the natural embedding [formula], and the product [formula] is literally the product inside [formula]. Then one can see that

[formula]

Hence the theorem follows from the local counter part (Theorem [\ref=T:Weyl_group_local]).

The following is immediate:

Let us mention the following subtle point. Here we have (at least) two different realizations of wπω in a space of automorphic forms on [formula], the one is in the space [formula] as in the proposition and the other as in the definition of the metaplectic tensor product [formula] by choosing an appropriate [formula] that satisfies Hypothesis ([formula]) with respect to the Levi [formula] (if possible at all). Without the multiplicity one property for the group [formula], we do not know if they coincide. But one can see that if [formula] satisfies Hypothesis ([formula]) with respect to [formula], then the group [formula] satisfies Hypothesis ([formula]) with respect to [formula]. Then if we define [formula] by choosing [formula], one can see from the construction of our metaplectic tensor product that the space of [formula] is indeed a space of automorphic forms of the form [formula] for [formula].

Compatibility with parabolic induction

Just as the local case, we have the compatibility with parabolic inductions. But before stating the theorem, let us mention

One can prove it by using the local analogue (Lemma [\ref=L:normalizer_local]). Namely let [formula], so - 1 = (m- 1,τr(m,m- 1)- 1). Also let [formula]. Then

[formula]

Then one needs to show

[formula]

so that [formula]. But one can show it by arguing "semi-locally". Namely for a sufficiently large finite set S of places, we have

[formula]

where for the second equality we used ([\ref=E:tau_sigma]), for the third equality we used the same cocycle computation as in the proof of Lemma [\ref=L:normalizer_local] and finally for the last equality we used sr(mvnvm- 1v) = 1 for all v∉S.

Let us mention that for the case at hand one can prove this lemma as we did here. However this lemma holds not just for our [formula] but for covering groups in general . (See [\cite=MW].)

At any rate, this lemma allows one to form the global induced representation

[formula]

for an automorphic representation π of [formula], and hence one can form Eisenstein series on [formula] just like the non-metaplectic case.

With this said, we have

This follows from its local analogue (Theorem [\ref=T:induction_local]) and the local-global compatibility of the metaplectic tensor product [formula].

Restriction to a smaller Levi

As the last thing in this paper, let us mention an important property of the metaplectic tensor product which one needs when one computes constant terms of metaplectic Eisenstein series. (See [\cite=Takeda2].)

Both locally and globally, let

[formula]

be viewed as a subgroup of M in the obvious way. We view [formula] as a subgroup of [formula] embedded in the right lower corner, and so M2 can be also viewed as a Levi subgroup of [formula] embedded in this way.

Both locally and globally, we let

[formula]

be the block-compatible 2-cocycle on M2 defined analogously to τM. One can see that the block-compatibility of τM and τM2 implies

[formula]

which gives the embeddings

[formula]

(Note that the last map is not the natural inclusion because here [formula] is actually [formula], and that is why we use [formula] instead of ⊆  .)

For each automorphic form [formula] in the space of the metaplectic tensor product, one would like to know which space the restriction [formula] belongs to. Just like the non-metaplectic case, it would be nice if this restriction is simply in the space of the metaplectic tensor product of [formula] with respect to the character ω restricted to, say, [formula]. But as we will see, this is not necessarily the case. The metaplectic tensor product is more subtle.

Let us first introduce the subgroup [formula] of [formula] which plays the role analogous to that of [formula]:

[formula]

Note that [formula], but the equality might not hold in general. The following lemma implies that [formula] is abelian.

This follows by the block-compatibility of τM and the fact that [formula] is abelian.

Also one can see that the image of [formula] under the canonical projection is closed, and hence [formula] is closed.

Another property to be mentioned is

The lemma can be verified by direct computations. Note that for both cases, the inclusion ⊆   is immediate. To show the reverse inclusion, we need that if [formula] and [formula] are such that [formula], one can always write a = a2a1 with [formula] such that [formula], and hence [formula].

Now assume that our group [formula] satisfies the following:

As an example of [formula] satisfying the above hypothesis, we have

This can be merely checked case-by-case.

Next for each [formula], define [formula] by

[formula]

Since [formula] and [formula], this is well-defined, and since [formula] is a homomorphism on M(F), ωδ is a character. Indeed, one can compute

[formula]

because one can see

[formula]

and ω is genuine. Hence for each [formula] we have ωδ(a) = ω(a) because ( det δ, det a) = 1, namely

[formula]

Therefore using [formula] and ωδ, one can construct the metaplectic tensor product representation of [formula] with respect to [formula], namely

[formula]

Then we have

Recall that

[formula]

where the sum is finite by Lemma [\ref=L:finite_sum]. Note that AMM(n)(F) is a normal subgroup of M(F), and hence [formula] is a group, which is actually an abelian group because it is a subgroup of the abelian group [formula]. By Lemma [\ref=L:M_2] we have the inclusion

[formula]

Hence we have

[formula]

By using Lemma [\ref=L:M_2], one can see that the map on [formula] defined by [formula] is in the induced space [formula], where [formula] and ω is actually the restriction of ω to [formula]. Now since we are assuming that [formula] satisfies Hypothesis ([formula]), the inner sum is finite. Since the sum over [formula] is finite, the outer sum is also finite.

Thus there are only a finitely many [formula] that contribute to the sum over [formula] and so we have

[formula]

Note that one can choose γi to be in [formula], so [formula]. So we have

[formula]

One can see by using Lemma [\ref=L:M_2] that the map on [formula] defined by

[formula]

is in the induced space [formula], where [formula]. Hence the function on [formula] defined by

[formula]

belongs to πωγi. Since we do not know the multiplicity one property for the group [formula], we might have a possible multiplicity mδ. This completes the proof.

This is immediate from the above proposition.

Now we can restrict the metaplectic tensor product "from the bottom", and get the same result. Let

[formula]

and embed Mk - 1 in [formula] in the upper left corner. Then define [formula] and the character ωδ analogously. Also consider the analogue of Hypothesis ([formula]), namely Then we have

The proof is essentially the same as the case for the restriction to [formula]. We will leave the verification to the reader.

Also for the case n = 2, we can do even better.

For (a), one can inductively show that [formula] satisfies both Hypotheses ([formula]) and ([formula]) for the Levi Mj. Thus one can successively apply the above theorem for [formula], which proves the theorem. The case (b) can be treated similarly.

On the discreteness of the group [formula]

In this appendix, we will discuss the issue of when [formula] can be chosen so that the group [formula] is a discrete subgroup of [formula], and hence the metaplectic tensor product can be defined. In particular, we will show that if n = 2, one can always choose such [formula], and hence all the global results hold without any condition. If n > 2, the author does not know if it is always possible to chose such nice [formula], though he suspects that this is always the case.

Throughout this appendix the field F is a number field. Also for topological groups H  ⊆  G, we always assume [formula] is equipped with the quotient topology.

The crucial fact is

Let [formula] be the open neighborhood of the identity defined by Kv  =  O×Fv for all finite v and Kv = F×v for all infinite v. To show the discreteness of the image of F×, it suffices to show that the set [formula] has only finitely many points modulo A×  m. This is because the image of F× in [formula] will then have an open neighborhood of the identity in the subspace topology for [formula] containing finitely many points, and the quotient [formula] is Hausdorf since [formula] is closed.

Now let [formula] and u∈F× be such that [formula]. Then [formula], and so for each finite v, we have uv∈F×  mvKv, which implies the fractional ideal (u) generated by u is [formula] power in the group IF of fractional ideals of F. Namely [formula], where PF the group of principal fractional ideals. On the other hand for any [formula], one can see that [formula].

Accordingly, if we define

[formula]

we have the surjection

[formula]

given by [formula]. So we have only to show that the group [formula] is finite. But note that the map u  ↦  (u) gives rise to the short exact sequence

[formula]

where UK is the group of units for F. Now the group [formula] is finite by Dirichlet's unit theorem. The group [formula] is isomorphic to the group of m-torsions in the class group of F via the map

[formula]

for each fractional ideal [formula], and hence finite. Therefore [formula] is finite.

As a first consequence of this, we have

Let

[formula]

be the map defined by [formula]. Then [formula]. Moreover the map [formula] is continuous. Hence we have a continuous group isomorphism

[formula]

Moreover, one can construct the continuous inverse by sending each [formula] to the first entry of the [formula] block [formula]. But the image of M(F) in [formula] under [formula] is discrete by the above proposition. The proposition follows.

As a corollary,

If the center is already in [formula], one can choose [formula] and then [formula], and so AMM(n)(F) = M(n)(F). Then by the above proposition, [formula] is discrete in [formula].

Proposition [\ref=P:M(F)_is_discrete] also implies

It suffices to show it for [formula] because the canonical projection is continuous. But for this, one can apply the following lemma with [formula] and Γ = M(F), which will complete the proof.

Let p:G  →  G / Y be the canonical projection. By our assumption, the image p(Γ) of Γ is discrete in the quotient topology. Now since Y is closed, the quotient G / Y is a Hausdorf topological group. Hence p(Γ) is closed by [\cite=Deitmar]. To show ΓY is closed, it suffices to show every net {γiyi}i∈I that converges in G, where γi∈Γ and yi∈Y, converges in ΓY. But since p is continuous, the net {p(γiyi)} converges in G / Y. But p(γiyi) = p(γi) and p(γi)∈p(Γ). Since p(Γ) is closed and discrete, in order for the net {p(γi)} to converge, there exists γ∈Γ such that p(γi) = p(γ) for all sufficiently large i∈I, namely, the net {p(γi)} is eventually constant. Hence for sufficiently large i, we have γiyi  =  γyi' for some yi'∈Y. This means that the net {γiyi} is eventually in the set γY. But since Y is closed, so is γY, which implies that the net {γiyi} converges in γY  ⊂  ΓY.

Finally in this appendix, we will show that if n = 2, one can always choose [formula] so that the group [formula] is discrete and hence the metaplectic tensor product is defined, and moreover the metaplectic tensor product can be realized in such a way that it behaves nicely with the restriction to the smaller rank groups.

First let us note that for any r, the center [formula] is given by

[formula]

Accordingly, one can see

[formula]

With this said, one can see

It is clear that [formula] is abelian since for each [formula], [formula] is the center of [formula], and hence commutes pointwise with [formula] for all j  ≥  i. To show [formula] is closed, it suffices to show [formula] is closed. Now one can write [formula], where AM(Fv) is defined analogously to the global case. Then one can see that Z(2)M(Fv)  ⊆  AM(Fv)  ⊆  ZM(Fv), and since Z(2)M(Fv) is closed and of finite index in ZM(Fv), so is AM(Fv). But ZM(Fv) is closed in M(Fv) and so AM(Fv) is closed in M(Fv). Then one can show that [formula] is closed in [formula] by Lemma [\ref=L:closed_subgroup_local_global].

Now one can show by induction on k that the group [formula] is the kernel of the map

[formula]

where εi is either 1 or 2. Hence one has a continuous group isomorphism

[formula]

where the space on the right is Hausdorff. Hence the space on the left is Hausdorf as well, which shows [formula] is closed. Also one can show that the image of M(F) is discrete as we did for Proposition [\ref=P:M(F)_is_discrete].

Identical to the previous proposition.

Let us make the following final remark.