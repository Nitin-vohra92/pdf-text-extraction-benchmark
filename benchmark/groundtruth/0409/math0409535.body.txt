In search of Robbins stability

This note may be viewed as an addendum to Robbins's note [\cite=robbins] in this volume. Its purpose is to speculate on whether the p-adic stability phenomenon that Robbins observed empirically for Dodgson condensation appears in other nonlinear recurrence relations that "unexpectedly" produce integer or nearly-integer sequences, and to provide an example where this provably occurs.

In order to carry out this speculation, we'll phrase Robbins's observation in a somewhat more general framework. For us, a recurrence relation over a field K will consist of a finite partially ordered set S plus, for each s∈S, a rational function fs  =  Ps / Qs over K in the indeterminate vector (xt)t < s. (The restriction to S finite does not concede any generality for our purposes: to consider an infinite recurrence, look instead at all of its finite truncations.) We also assume (for simplicity) that the partial order on S is generated by the relation in which t is less than s if fs is nonconstant as a function of xt alone. In this case, s∈S is minimal for the partial order if and only if fs is a constant function; we thus use the term initial interchangeably with "minimal".

Before proceeding further, it will be helpful to set up some more notation. For I  =  (is)s∈S a tuple of nonnegative integers, we write xI for [formula]; for any function g:S  →  K, we write gI for [formula]. Write [formula] and [formula], where as,I and bs,I are zero for all but finitely many I, and Ps and Qs have no common polynomial factor.

Suppose now that K is equipped with a discrete (nonarchimedean) valuation v, e.g., [formula] with the p-adic valuation for some prime p. Suppose also that the Ps and Qs are normalized so that v(as,I)  ≥  0 and v(bs,I)  ≥  0 for all s and I, and so that for each s,

[formula]

Suppose further that there exists a function g:S  →  K such that g(s)  =  fs(g) for all s∈S; note that g is unique if it exists, and the only obstruction to its existence is the vanishing of Qs for some s. That is, g is the unique solution of the recurrence, and satisfies

[formula]

for all s∈S.

Now fix a positive integer N. We denote by *   any element of K with v( * )  ≥  N; here we intend that two different occurrences of *   may refer to two different numbers. With this convention, we have the following simplification rules:

[formula]

We also have c  *    =    *   whenever v(c)  ≥  0.

Define an N-perturbation of the recurrence as any function g':S  →  K such that for each s∈S,

[formula]

In case s is initial, this yields g'(s)  =  g(s)(1  +   * ); this is the same as saying that v(g'(s)  -  g(s))  ≥  v(g(s))  +  N.

The point of this definition is that, in the case [formula], g' is a possible result of computing fs(g') using p-adic floating point numbers with N-digit mantissas. Specifically, recall from [\cite=robbins] that a "p-adic floating point number with an N-digit mantissa" consists of a pair (a,e), where the "mantissa" a is an invertible element of [formula] and the "exponent" e is any integer. This pair is used to represent any p-adic number ãpe such that ã is invertible in [formula] and the image of ã under the natural map from [formula] to [formula] is a. Hence two numbers r and s admit the same representation if and only if r  =  s(1  +  pNu) for some [formula], i.e., if v(s / r  -  1)  ≥  N.

One can then reimagine p-adic floating point arithmetic as being carried out with actual p-adic numbers, except that at any point in an arithmetic operation, a gremlin may come along and multiply any value by a factor of the form 1  +    *  . In this interpretation, g'(s) is then allowed to be any result of computing fs(g') in the presence of such gremlins. (Note that any "gremlin factor" applied after adding two numbers together can be absorbed into the gremlin factors by which each summand is multiplied. Also, the reciprocal of a gremlin factor is itself a gremlin factor.)

Given an N-perturbation g', define its projected precision loss rs(g') at s∈S as

[formula]

this generalizes the notion of "condensation error" introduced by Robbins. Note that the projected precision loss is determined by the computed denominators rather than the actual denominators, which would be the v(Qt(g)); these often but do not always coincide. Note also that rs(g')  =  0 when s is initial (because the only term in the maximum is v(Qs(g'))  =  v(1)  =  0), and that rs(g')  ≥  rt(g') whenever t  ≤  s, i.e., the bound gets larger (i.e., worse) as you go along.

We say that the recurrence exhibits Robbins stability if for any positive integer N, any N-perturbation g', and any s∈S, if rs(g')  <  N, then

[formula]

Robbins's conjecture in [\cite=robbins], made on the basis of copious numerical evidence, then essentially (but see next paragraph) amounts to the statement that the recurrence obtained from Dodgson condensation of a matrix of indeterminates (indexed by the connected minors) exhibits Robbins stability. (Note that the term min {0,v(g(s))} drops out in Robbins's case because v(g(s)) is always nonnegative; this seems to be warranted by experimental evidence, as we note at the very end.)

It may be more accurate to speak here of "weak Robbins stability", as we are actually generalizing a slightly restricted version of Robbins's conjecture. That is because Robbins permits the "borderline" case rs(g')  =  N; indeed, the comment in [\cite=robbins] that "a quantity can be accurate to zero places" suggests that this permission was deliberate. However, we are not entirely sure whether to believe the conjecture in the borderline case, and our proof of Robbins stability in the one nontrivial case we can prove (see the Theorem below) does not handle the borderline case; a future clarification of this issue would be welcome.

It may be helpful to recall (or rather, to attempt to reconstruct) some of Robbins's motivation for making his original conjecture. The quantity N  -  rs(g') measures the extent to which we can distinguish the denominators we have divided by so far from zero. To the extent that we can make this distinction, we expect that Dodgson condensation should continue to work; this expectation is formalized in the inequality defining the stability property.

However, the assertion that N  -  rs(g') measures our ability to distinguish denominators from zeroes is only really meaningful if those denominators are integral. This suggests that it may not be wise to expect stability for recurrences in which denominators occur in an unsystematic fashion; this caution is borne out by a simple example, which we now give.

Take S  =  {0,1,2,3,4,5,6,7}, equipped with the ordering that agrees with the usual ordering except that 0 and 1 are not comparable, and consider the recurrence over [formula] given by

[formula]

The function g in this case takes the values

[formula]

Let v denote the 2-adic valuation; then the function g' taking the values

[formula]

is an N-perturbation for N = 6, because

[formula]

and g'(n)  =  fn(g') for n = 5,6,7. The projected precision loss is

[formula]

and v(663 / 140)  =   - 2, so Robbins stability would predict that

[formula]

However, - 17463 / 1601860  -  663 / 140  =   - 2661195 / 560651 has valuation 0, so the recurrence does not exhibit Robbins stability.

As noted before, it is unclear whether one should expect Robbins stability to be exhibited by recurrences with "unpredictable" denominators. However, there is a wide class of recurrences in which denominators either do not occur, or occur in a limited and systematic fashion; these are the recurrences which exhibit the "Laurent phenomenon", in the parlance of Fomin and Zelevinsky [\cite=fz]. That paper establishes that a number of interesting recurrences (like Dodgson condensation) have the following property: if one views the initial constants as distinct indeterminates, the noninitial terms turn out to be polynomials in these indeterminates and their inverses. (See [\cite=propp] for an online discussion of such recurrences and related topics.)

Among recurrences admitting the Laurent phenomenon, Dodgson condensation is but one example, and it seems (to us, anyway) that the unexpected cancellations that contribute to the Laurent phenomenon may in the condensation case must have something to do with the unexpectedly strong bound on the precision loss predicted by Robbins stability. We thus pose the question: do other Laurent recurrences exhibit Robbins stability?

One can trivially construct many recurrences exhibiting Robbins stability, by considering those for which Qs  =  1 for all s, so that no divisions are ever performed in the calculation and hence rs(g')  =  0 for all s∈S. In fact, these recurrences have a much stronger property.

We proceed by induction on s; for s minimal, the desired inequality is given directly by the definition of an N-perturbation, so we assume that s is nonminimal and that

[formula]

In particular, v(g'(t))  ≥  0 for all t < s.

We now begin a second induction to show that (g')I  =  gI  +    *   for all tuples I of nonnegative integers indexed by the set of t∈S with t < s; this induction will be on the sum of the entries of I. If this sum is zero, then the desired equality is the trivially true 1  =  1  +    *  . Otherwise, given a tuple I for which the claim is known for all tuples of smaller sum, choose some t at which I has a nonzero component, and let J be the tuple obtained by decreasing this component by 1. Then gI  =  gJg(t) and likewise for g', (g')J  =  gJ  +    *   by the inner induction hypothesis, and g'(t)  =  g(t)  +    *   by the outer induction hypothesis. These imply that g'(t) and (g')J have nonnegative valuation, and so

[formula]

This completes the inner induction, so we may conclude that (g')I  =  gI  +    *   for all I.

To complete the outer induction, note that

[formula]

since v(as,I)  ≥  0 by hypothesis.

On the other hand, it seems not so easy to establish that Robbins stability is exhibited by any recurrences, even ones exhibiting the Laurent phenomenon, in which nontrivial divisions take place. However, we have succeeded in doing so in one case, which we now describe; it is a form of a recurrence of Conway and Coxeter [\cite=conway], which we will refer to here as the "number frieze" recurrence.

Fix a positive integer n, and set

[formula]

with the partial order given by

[formula]

Choose [formula] of nonnegative valuation, and define a recurrence on S by

[formula]

then g exists and takes values with nonnegative valuations. Indeed, as noted in [\cite=propp2], this is basically a special case of Dodgson condensation: the f(a,b) are connected minors of the tridiagonal matrix

[formula]

and while one cannot condense this matrix (as some of the other connected minors vanish), one can recover the number frieze recurrence by instead condensing the matrix

[formula]

where t is an indeterminate, then setting t = 0 in the resulting polynomials.

Note that the proof will actually yield a stronger result, as in the trivial case (Qs  =  1 for all s): it effectively shows that as long as the projected precision loss is strictly less than N, Robbins stability holds even using fixed point arithmetic (i.e., working modulo pN) instead of floating point arithmetic.

Let g' be an N-perturbation. (To simplify notation, we write g(a,b) and g'(a,b) instead of g((a,b)) and g'((a,b)).) We prove by induction on a that as long as r(a,b)(g')  <  N, we have v(g'(a,b)  -  g(a,b))  ≥  N  -  r(a,b)(g') (and hence v(g'(a,b))  ≥  0, since g(a,b) is known to have nonnegative valuation); this gives precisely the Robbins stability bound.

Before continuing, we introduce another notational convention. Put r  =  r(a,b)(g'), and write [formula] to mean v(Y - Z)  ≥  N - r (so in particular any star is congruent to 0). Note that the congruences [formula] and [formula] imply that [formula] always; if Y,Z,Y',Z' have nonnegative valuation, the congruences also imply that [formula]. Moreover, if [formula] and Y,Z both have valuation 0, then [formula].

We now return to the induction. For a = 0,1, the desired inequality holds by default because (a,b) is initial. For a = 2, the denominator of f(a,b) is x(0,b + 1), and g'(0,b + 1)  =  g(0,b + 1)  +    *    =  1  +    *   has valuation 0, so again the desired inequality follows. For a = 3 and 0  ≤  b  ≤  n - 3, we have

[formula]

by the induction hypothesis, g'(2,b)  =  g(2,b)  +    *  , g'(2,b + 1)  =  g(2,b + 1)  +    *  , and g'(1,b + 1)  =  g(1,b + 1)  +    *  , so

[formula]

Since Q(a',b')(g')  =  1 for a'  =  0,1, and since for a' = 2 we have as above Q(a',b')(g')  =  1  +    *  , we have

[formula]

Hence (since r < N by assumption) we have g'(1,b + 1)  <  N, yielding v(g'(1,b + 1)  +   * )  =  v(g'(1,b + 1)); in particular, v(g(1,b + 1))  =  v(g'(1,b + 1))  =  r. We can now write

[formula]

as desired.

Suppose now that a  ≥  4, r(a,b)(g')  <  N, and the induction hypothesis holds for all pairs (a',b')  <  (a,b); in particular, we have v(g'(a',b'))  ≥  0 whenever (a',b')  <  (a,b). To eliminate some indices, put and likewise with primes; note that [formula] all have nonnegative valuation, as do [formula] by the induction hypothesis. We then have because g' is an N-perturbation and v(g'(a',b'))  ≥  0 for a'  <  a. (More explicitly, the definition of an N-perturbation implies that E'  =  (B'C'(1 +  * )  -  (1 +  * )) / (A'(1 +  * )) and the like, but the product of each lettered quantity with a star is again a star.) We also have four analogous equations without the primes and stars. Moreover, if (a',b')  <  (a,b), we have r  ≥  r(a',b')(g') by the way the projected precision loss is defined, so the induction hypothesis implies in particular that [formula]; in particular, we have

[formula]

and we wish to show that [formula].

By the induction hypothesis, we have v(E')  ≥  0. If v(E')  =  0, then [formula] imply [formula] and [formula]. Since N  >  r, the congruence [formula] and the assumption v(E')  =  0 imply v(E)  =  0, and so [formula]. Consequently

[formula]

as desired.

Since the case v(E) = 0 is okay, we assume hereafter that v(E')  >  0; then v(B'C'  -  1  +   * )  >  0, and hence v(B'C'  -  1)  >  0. Since v(B')  ≥  0, v(C')  ≥  0, and 0  =  v(1)  ≥   min {v(B'C'),v(1 - B'C')}, this is only possible if v(B')  =  v(C')  =  0.

We now compute

[formula]

As before, we have [formula], [formula], [formula], [formula], and [formula]. Moreover, from the definition of the projected precision loss, we have

[formula]

and so [formula].

Since r  <  N, the facts that v(B'C')  =  0 and [formula] together imply that v(BC)  =  0; then the congruence [formula] implies [formula]. This together with the previous mentioned congruences and the equation

[formula]

yields [formula], as desired.

Note that in this example, the precision bound given by Robbins stability is not always sharp if one fixes (a,b) and varies over all N-perturbations. For instance, for [formula] with the 3-adic valuation, take

[formula]

For m and N sufficiently large (say m  >  5 and N  ≥  2m), the projected precision loss is m (achieved by g(1,1)  =   - 3m), but experiments suggest that v(g'(5,0) - g(5,0))  ≥  N  -  m  +  5 always. It would be interesting to find a more precise version of the projected precision loss that detects such "localized disruptions", specifically by relaxing the restriction that the bound can only get worse with each successive term. Such a formulation of the stability phenomenon may even suggest progress towards Robbins's original conjecture or generalizations.

Although all our examples have been recurrences over [formula], with v equal to a p-adic valuation, we have taken care to make our setup more general. In particular, one could use our framework to look at Robbins stability in [formula], with v the x-adic valuation. This might serve as a bridge between the Laurent phenomenon and Robbins stability.

We conclude by mentioning some further experiments the first author has conducted with Punyashloka Biswal. Namely, we have been applying Robbins's testing regimen to other recurrences exhibiting the "Laurent phenomenon" of [\cite=fz]: compute pairs of N-perturbations using N-digit p-adic floating point arithmetic (generating the undetermined p-adic digits at random), and compare their difference to the projected precision loss predicted by Robbins stability. (This is somewhat easier than comparing one N-perturbation to the exact solution.) Two families of examples we have considered, which both appear to exhibit Robbins stability, are the Somos sequences

[formula]

for k = 4,5,6,7, and the sequences

[formula]

given in [\cite=fz]. Notably, the latter example seems to require the correction term min {0,v(g(s))} that we introduced into the definition of Robbins stability.

Acknowledgments

Thanks to Joe Buhler for referring us to the formulation of Robbins's conjecture appearing here. The first author is supported by NSF grant DMS-0400727, and the second author is supported by NSA grant H92830-04-1-0054.