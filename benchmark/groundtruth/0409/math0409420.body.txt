Theorem Proposition Lemma Corollary Conjecture

Definition Problem Example Question

Finite Field Models in Arithmetic Combinatorics

Introduction

This article is concerned with a variety of problems in additive and combinatorial number theory. The following two examples will convey the general flavour:

What is r3(N), the cardinality of the largest subset of [formula] containing no three distinct elements x,x + d,x + 2d in arithmetic progression?

If [formula], write A  +  A for the set of all sums a  +  a', a,a'∈A. What can be said about the structure of A if A is nearly closed under addition in the sense that [formula]?

What, then, is the "general flavour"? Of course, both of these problems are of an additive combinatorial flavour. Furthermore, they may both be asked in a general abelian group. Regarding Problem [\ref=prob1], we may define the quantity r3(G) for any finite abelian group G. And Problem [\ref=prob2] makes sense in any abelian group.

The ability to generalise to an arbitrary G will be a common feature of many of the questions we discuss. An important observation is that not all abelian groups were created equal. It turns out that both Problems [\ref=prob1] and [\ref=prob2] are both considerably easier in groups other than those in which they were originally asked ([formula] for Problem [\ref=prob1] and [formula] for Problem [\ref=prob2]). Indeed, Meshulam [\cite=meshulam] observed that Problem [\ref=prob1] is naturally addressed in [formula], whereas Ruzsa [\cite=ruzsa-freimangroups] saw that Problem [\ref=prob2] is particularly pleasant in [formula]. Here, [formula] denotes the finite field with p elements, and [formula] is our notation for a vector space of countable dimension over [formula].

Roughly speaking, the reason that finite field models are nice to work with is that one has the tools of linear algebra, including such notions as subspace and linear independence, which are unavailable in general abelian groups.

Historically, questions such as Problems [\ref=prob1] and [\ref=prob2] were investigated in their original settings, and it was observed only later that analogous arguments worked in the finite field setting and in fact looked rather simpler. More recently, there has been a trend in the opposite direction. This has been fuelled by an idea of Bourgain [\cite=bourgain2] which, suitably interpreted, can be viewed as a way of converting arguments in the finite field setting to arguments which work for an arbitrary group G by using a kind of "approximate linear algebra". The author [\cite=green-reg] produced a result about sets of integers with few solutions to x  +  y  =  z which would have been very difficult to attain without first considering a finite field model, and more work of this sort is in progress. It is an interesting feature of many problems that progress for the groups G which are "of interest", such as [formula], is scarcely simpler than for general abelian G.

The format of this article is as follows. After setting up a little notation and a few definitions, we will discuss a number of finite field problems of "Szemerédi type", that is to say along the lines of Problem [\ref=prob1]. We will strive for a uniform treatment of three such problems: 3-term APs (§ [\ref=sec4]), right-angled triangles (§ [\ref=sec5]) and 4-term APs (§ [\ref=sec6]). We will discuss a fourth problem in § [\ref=sec7], which concerns solutions to x  +  y  =  z and is in a somewhat similar spirit.

After these four sections we will, in § [\ref=sec8], sketch an argument of Bourgain, which is currently being developed by the author and others, including T.Tao and I. Shkredov, into a machine for converting arguments in the finite field setting into arguments that work in any finite abelian group G. This is often of some interest when [formula], because in that case it is often possible to infer results concerning the integers.

After that there follow three further sections of a somewhat miscellaneous nature dealing with finite field analogues of problems in additive number theory.

Since this is a survey article we have not gone into a great deal of technical detail. There are, however, two areas we discuss which are not well covered in the literature. Thus on the author's webpage one may find two supplementary documents [\cite=sup-doc-1] [\cite=sup-doc-2]. The first of these gives details of the finite field version of Shkredov's argument, which is outlined in § [\ref=sec5]. The second supplies proofs for the result of Ruzsa discussed in § [\ref=sec10].

Our scope in this article is a little limited, in that our main interest is in additive combinatorial problems which can be usefully studied in [formula] for fixed p, regarding n as a variable parameter. Secondly, I have unashamedly prioritised areas in which I have personally worked. There are most assuredly other areas of mathematics where finite field models have proved invaluable, such as the study of the Kakeya and restriction phenomena. We do not touch upon these matters here, referring the reader instead to the article [\cite=mockenhaupt-tao] as well as in the surveys [\cite=katz-tao-survey] [\cite=tao-survey1] [\cite=tao-survey2].

Notation and Basic Definitions

Let p be a prime (p will be either 2,3 or 5). Write [formula] for the finite field with p elements, which may be identified with [formula], and for an integer [formula] write [formula] for a vector space of dimension n over [formula]. This will be understood to have been given to us with a fixed basis [formula], relative to which we will occasionally write a given [formula] as a coordinate vector [formula]. We will always write N  =  pn for the cardinality of the space [formula].

Once we have a basis the Fourier transform of a function [formula] can be written down in a concrete form. A complete set of characters [formula] is given by the maps γξ, defined by

[formula]

where [formula] and ω  =  e2πi / p. Thus, for any [formula], we define

[formula]

We may also write this as [formula] on occasion. The basic facts concerning the Fourier transform are summarised in the following lemma.

Let [formula] be two functions. Then

[formula];

(Plancherel) [formula];

(Inversion) [formula];

(Convolution) Write [formula]. Then [formula].

Very often, we will be concerned with functions f which are the characteristic functions of sets [formula]. It is very convenient to abuse notation and write A(x) for such a function. Thus A(x)  =  1 if x∈A, and A(x)  =  0 otherwise. This notation is by now reasonably widespread in the literature, as are alternative notations such as χA or [formula].

It will be very convenient to use the language of conditional expectation. Suppose that x is a variable or set of variables, and that f is a real-valued function of x. Then we write

[formula]

for the average of f(x) over all x∈B.

Let us conclude with some notation concerning sumsets. If G is an abelian group and if A,B  ⊆  G then we write A  +  B  =  {a  +  b:a∈A,b∈B}. For any positive integers s,t we write sA  +  tB for the set of all sums [formula],and sA  -  tB for the set of all sums [formula].

Uniformity

A notion which will feature repeatedly in this article is that of uniformity, also referred to in various related guises as regularity, pseudorandomness or quasirandomness.

Let [formula] be a set, and let η∈(0,1) be a parameter. We will say that A is η-uniform if

[formula]

Observe that if A is η-uniform then it is also η'-uniform for all [formula].

The basic philosophy behind this definition is as follows. A truly random set A (generated, say, by including each [formula] in A independently at random with probability 1 / 2) will be η-uniform with very high probability. In fact, using a large deviation estimate such as Chernoff's bound (see [\cite=alon-spencer] for example) one can show that this is true even for η  =  N- 1 / 2  +  ε. A truly random set will have many other properties almost surely. Remarkably, many of these are consequences of A being η-uniform. This phenomenon was investigated in the context of graphs by Thomason [\cite=thomason1] [\cite=thomason2] and by Chung, Graham and Wilson [\cite=chung-graham-wilson]. Chung and Graham [\cite=chung-graham] later defined quasi-randomness for subsets of [formula]. Quasirandomness has been most thoroughly explored in the context of graphs, for which the reader should consult the excellent survey articles [\cite=krivelevich-sudakov] [\cite=komlos-simonovits]. The notions of uniformity in [formula] and in [formula] differ in little more than notation.

As an example of uniformity/quasirandomness at work, and to get comfortable with the notation, let us prove that uniformity is more-or-less equivalent to a combinatorial condition involving M(A), the number additive quadruples in A (solutions to a1  +  a2  =  a3  +  a4, ai∈A).

Let [formula] have cardinality αN.

Suppose that A is η-uniform. Then [formula].

Suppose that [formula]. Then A is ε1 / 4-uniform.

Remark. An easy application of the Cauchy-Schwarz inequality confirms that [formula], so this lemma concerns sets with close to the minimum number of additive quadruples.

Proof. The proof of this Lemma rests on the identity

[formula]

which may be proved by observing that [formula] and using Lemma [\ref=basic-fourier-properties] (2) and (4). To prove (1), assume that A is η-uniform, so that [formula] for all ξ  ≠  0. Then we have

[formula]

as required. To prove (2), assume that [formula]. Then for any ξ  ≠  0 one has

[formula]

which is what we wanted to prove.

We observe that if [formula], and if H  +  g is a coset of some subspace [formula], then there is a natural notion of what it means for A to be η-regular relative to H  +  g. Indeed we may define a set A+ gH  ⊆  H by setting

[formula]

for x∈H. Since H is a subgroup, it is isomorphic to [formula] for some [formula] and it makes sense to talk about the Fourier transform on H. We say that A is η-uniform on H  +  g if A+ gH is η-uniform, considered as a subset of H.

The key reason for uniformity being so important to us in the present survey is that it allows us to count solutions to certain linear equations in sets which are sufficiently uniform. Lemma [\ref=add-quad-lem] was of course a rather special example of this (the linear equation being a1  +  a2  =  a3  +  a4). The next proposition illustrates this further.

Let p be a prime and suppose that [formula]. Suppose that [formula], [formula], are non-zero integers coprime to p. Let [formula] be a subspace, and let [formula] satisfy [formula]. Suppose that the density of A on H  +  gi is αi, and that A is η-uniform. Then M, the number of solutions to [formula] with ai∈H  +  gi for [formula], satisfies

[formula]

Proof. With the notation introduced above we can write

[formula]

This can be written in terms of the Fourier transform on H as

[formula]

Separating off the term ξ  =  0 and bounding the other term using Hölder's inequality, we get

[formula]

This concludes the proof.

Of particular importance to us will be two cases of the above with k  =  3: (λ1,λ2,λ3)  =  (1,1, - 2), which corresponds to arithmetic progressions of length 3, and (λ1,λ2,λ3)  =  (1,1, - 1), corresponding to what are known as Schur triples (solutions to x  +  y  =  z).

A particularly nice feature of finite fields is that the notion of a set [formula] being uniform is closely related to that set being well-distributed in cosets of codimension one hyperplanes. We will use this principle several times in the sequel, so let us state and prove a quantitative version of it now.

Suppose that [formula] is a set of size αN (N  =  pn) and that A is not η-uniform, so that there is ξ  ≠  0 with |Â(ξ)|  >  ηN. Let [formula], and write h(x)  =  H(x) / |H|. Then

[formula];

[formula];

[formula].

Remark. [formula] is the density of A on the coset H  +  x. Proof. To prove (1), observe that

[formula]

Statement (2) is a simple corollary of this:

[formula]

Statement (3) is proved by working directly with the definition of Â(ξ). It leads to somewhat better qualitative bounds than (2).

Let, then, H  +  xj, [formula], be a complete set of cosets of H. Then

[formula]

where [formula]. Thus [formula]. Observe, however, that [formula]; it follows that [formula], and whence from the pigeonhole principle that [formula] for some j. For such a j, we have [formula].

Roth's Theorem and the iteration method

Let us begin by recalling Problem [\ref=prob1].

Problem [\ref=prob1]. What is the cardinality of the largest subset of [formula] containing no three distinct elements x,x + d,x + 2d in arithmetic progression?

This question was first raised by Erds and Turán in 1936 [\cite=erdos-turan], and was addressed by Klaus Roth [\cite=roth]. Define r3(N) to be the answer to Problem [\ref=prob1]. Roth proved that r3(N)  ≪  N /  log  log N, a bound which was improved to N( log N)- c independently by Heath-Brown [\cite=heath-brown] and Szemerédi [\cite=szemeredi-aps], and then to r3(N)  ≪  N( log  log N /  log N)1 / 2 by Bourgain [\cite=bourgain2]. We are still a long way from a complete understanding of r3(N); the best known lower bound is Behrend's [\cite=behrend] 1946 example showing that [formula].

It is natural to define r3(G) for any group G with no 2-torsion (though see [\cite=lev]). A particularly appealing case, which fits with the discussion of this article, is [formula]. In this case it turns out that the four proofs [\cite=bourgain2] [\cite=heath-brown] [\cite=roth] [\cite=szemeredi-aps] can all be adapted to give the following result.

We have [formula] (= O(3n / n)).

In fact, all four proofs look the same in the finite field setting. Roth's proof was adapted to the finite field setting by Meshulam [\cite=meshulam] and the argument we give to prove Theorem [\ref=finite-field-roth] is the same as his.

There are two key ingredients. The first is a special case of Proposition [\ref=prop3.3], asserting that if A is sufficiently uniform then we can count solutions to the equation a1  +  a2  =  2a3 (that is, arithmetic progressions of length three).

Suppose that [formula] has cardinality αN, and that A is η-uniform. Then there are at least (α3  -  ηα)N2 solutions to the equation a1  +  a2  =  2a3 with ai∈A. In particular if η  =  α2 / 2 and N  >  2 / α2 then A contains a 3-term AP (x,x + d,x + 2d) with d  ≠  0.

Proof. The first part is just a matter of setting [formula] and (λ1,λ2,λ3)  =  (1,1, - 2) in Proposition [\ref=prop3.3]. To verify the second statement, one must simply check that if η  =  α2 / 2 and N  >  2  /  α2 then (α3  -  ηα)N2 is greater than αN, the number of "trivial" 3-term APs (x,x,x) in A.

The second key ingredient is Lemma [\ref=uniformity-hyperplanes] (3), which asserts that if A is not η-uniform then it has increased density on some coset of a hyperplane. In combination with Lemma [\ref=ap3-lemma] this leads naturally to an iterative method for proving Theorem [\ref=finite-field-roth].

Proof of Theorem [\ref=finite-field-roth]. Set A0  =  A, [formula], α0  =  α. For each [formula] we perform the following algorithm:

If Ai is α2i / 2-uniform then STOP.

Otherwise by Lemma [\ref=uniformity-hyperplanes] find a hyperplane [formula] and an x∈Hi such that [formula]. Now set [formula] and set [formula].

Note that if Ai contains a 3-term AP then so does A.

The algorithm cannot be repeated forever, since the sequence (αi)∞i = 1 satisfies α0  =  α and [formula] then αi  >  1 for i  >  50 / α. Thus we reach a STOP at step K of the algorithm, for some K  <  50 / α. At this stage, AK is α2K / 2-uniform. If in addition |HK|  >  2 / α2K then, by Lemma [\ref=ap3-lemma], AK contains a 3-term AP. Since |HK|  =  3- KN  >  3- 50 / αN and αK  >  α, we see that the original set A contains a 3-term AP if α  >  C /  log N for some C.

We call the above an iteration argument for obvious reasons. We will encounter several such arguments in this survey, so let us take the opportunity to look at the important features of it.

Our concern was with certain configurations [formula], which in this section were the three-term arithmetic progressions (x,x + d,x + 2d), d  ≠  0.

A key feature of the argument was a collection [formula] of structures, which in this case was the collection of all cosets of subspaces of [formula]. There was also some measure of the complexity ω(S) of a given structure [formula], this being the codimension of the subspace. For a given set [formula] and for any [formula] there was a notion of the density δS(A) of A relative to S. Finally, there was a norm ||  ·  ||S on functions f:S  →  [ -  1,1], for any [formula] (in the example above, this was the L∞ norm of the Fourier transform of f, regarded as a function on [formula]). This we used to define a notion of uniformity relative to some [formula]; a set was η-uniform if [formula].

The "iteration step" of Roth's argument can be presented in the following way.

Let [formula], and let [formula] be a set with δS(A)  =  α. Then one of the following three alteratives holds:

(generalised von Neumann theorem) [formula], in which case A contains some [formula];

(density increment) ||A  -  δS(A)||S  >  α2 / 2, in which case we may find [formula], [formula], such that [formula];

(endpoint) |S|  <  2 / α2.

Several subsequent arguments will have the same general form, with different notions of Struct, Config, ω and ||  ·  ||S. The choice of Struct and, perhaps more importantly, of the norm ||  ·  ||S is vitally important. ||  ·  ||S must be "strong" enough for us to be able to prove a von Neumann theorem, yet "weak" enough that one may obtain a density increment.

To conclude this section, let use return to the question of estimating [formula], which I regard as a very interesting one. It seems to dramatically expose our lack of understanding of 3-term arithmetic progressions. There does not seem to be an analogue of Behrend's example in the finite field setting (Behrend's construction makes important use of convexity in [formula]). The best known lower bounds on [formula] come from design theory, where a set in [formula] with no 3-term AP is known as a cap. Write f(n) for the cardinality of the largest cap in [formula]. In [\cite=edel] one finds the estimate

[formula]

which seems to be the best known. In that paper it is stated as an interesting research problem to determine if μ(3)  =  1. I believe that this is not so.

μ(3)  <  1. That is, there is an absolute constant δ  >  0 such that [formula].

I would expect any methods used to make progress on this conjecture to assist with the Problem [\ref=prob1]. At present the best known bound is that given in Theorem [\ref=finite-field-roth].

Right-angled triangles - an argument of Shkredov

In this section we write [formula], and N  =  |Vn|  =  2n.

We are concerned with a sort of two-dimensional generalisation of Problem [\ref=prob1]:

What is [formula], the cardinality of the largest subset of [formula] containing no corner ((x,y),(x  +  d,y),(x,y + d)), d  ≠  0?

Ajtai and Szemerédi [\cite=ajtai-szemeredi] proved that [formula], and various subsequent authors [\cite=solymosi] [\cite=vu] have obtained explicit bounds of the shape [formula]. Here log *N is the number of times one must take the logarithm of N in order to produce a number less than 2.

Very recently Shkredov [\cite=shkredov] produced the first "sensible" bound

[formula]

In this section we give the finite field version of his argument, in which the details are greatly simplified.

Let G be an abelian group of size N, and consider the collection of corners in G  ×  G, by which we mean triples ((x,y),(x + d,y),(x,y + d)), d  ≠  0. Write [formula] for the cardinality of the largest set A  ⊆  G  ×  G which does not contain any corner.

We have [formula].

It is natural to try and use the iteration method, in the form outlined in the previous section. The most naïve attempt at doing this would involve taking [formula] to be the set of cosets of products H  ×  H, where [formula] is a subspace, and the definition of uniformity to be much the same as before. The notion of having no large Fourier coefficients makes perfect sense in H  ×  H. Unfortunately, however, this notion of uniformity is not subtle enough to give good control on the number of corners, essentially because it does not "see" the coordinate structure of H  ×  H. The following example is instructive:

Let B be a random (and hence highly uniform) subset of Vn with cardinality βN, and let [formula] be the set B  ×  B. Then A is also highly uniform. The density of A is α  =  β2. A corner in A corresponds to a quadruple of points (x,x + d,y,y + d)∈B4, and we know from Lemma [\ref=add-quad-lem] that there are roughly β4N3  =  α2N3 such configurations. If A were truly random, however, it would have more like α3N3 corners.

The next idea, then, might be to define a somewhat finer notion of uniformity which respects the coordinate structure somewhat more. Using Proposition [\ref=add-quad-lem] as a guide, we might define [formula] to be rectilinearly η-uniform if the number of configurations ((x,y),(x + d,y),(x,y + e),(x + e,y + e)) in A4 is at most (α4  +  η)N4. Such a notion does, as we will see, give some control on the number of corners in A. Unfortunately passing to a new structure [formula] on which the density increases is now problematic.

To see why, consider again example [\eqref=ex1]. It is easy to see that A fails to be rectilinearly uniform, but there is no product set (H  +  x)  ×  (H'  +  x'), H,H' large subspaces of [formula], on which the density of A increases markedly.

Note, however, that in this example there is at least some structure on which the density of A increases, and that is the product set B  ×  B (of course, the density of A on this set is one). This behaviour is more-or-less typical: if a set [formula] has substantially more than α4N4 rectangles then it has increased density on some product B1  ×  B2. This can be proved graph-theoretically by associating to A the bipartite graph ΓA with vertex sets two copies of [formula], an edge xy being deemed to lie in ΓA precisely if (x,y)∈A. A rectangle in A then corresponds to a copy of C4 in ΓA, and we are reduced to showing that if ΓA has substantially more than α4N4 copies of C4 then there are large vertex sets B1,B2 such that the edge density of ΓA restricted to [formula] is much greater than α. Shkredov in effect provides a spectral proof of this statement, which is in the spirit of [\cite=frieze-kannan]. A purely combinatorial proof is more traditional, and somewhat simpler - the details may be found in [\cite=sup-doc-1].

The discussion of the last paragraph might suggest that we should enlarge [formula] to include all translates of products B  ×  B. This turns out to be too much of a compromise - one cannot establish a useful generalised von Neumann theorem.

The above discussions motivate Shkredov's main advance, which is an appropriate definition of [formula]. The definition depends on the global density α of A, a feature which has no analogue in other applications of the iterative method discussed in this paper.

Let α  >  0. Define [formula] to consist of all translates of product sets S  =  E1  ×  E2, where E1,E2 are subsets of some [formula], |Ei|  =  βi|H| and Ei is a (2- 36β121β122α36)-uniform subset of H for i  =  1,2.

Suppose that S  =  E1  ×  E2 is a product set, and that f:S  →  [ -  1,1] is a function. Then we define the rectangle norm of f, ||f||S by

[formula]

It is not totally obvious that ||  ·  ||S is a norm, but this is in fact the case. Let us now look at how the argument fits together, starting with a generalised von Neumann theorem.

Let [formula], so that S  =  E1  ×  E2 be a product set, where E1,E2  ⊆  H, |Ei|  =  βi|H| and Ei is (2- 36β121β122α36)-uniform for i = 1,2. Let A  ⊆  S be a set with [formula]. Suppose that and that [formula]. Then A has at least α3β21β22N3 / 2 corners.

The proof of this statement involves a number of applications of Cauchy-Schwarz.

To complement the generalised von Neumann theorem, we must establish a density increment result. The following can be obtained by simple graph theory (or alternatively by spectral methods, as done in [\cite=shkredov]).

Let S  =  E1  ×  E2 be a product set, and suppose that A  ⊆  S has δS(A)  =  α and [formula]. Then there are sets Fi  ⊆  Ei with [formula] such that the density of A on S'  =  F1  ×  F2 satisfies [formula].

Remark. There is no need to assume that the sets E1,E2 are uniform in this proposition.

Proposition [\ref=prop5.7] has a significant deficiency, which means that it cannot be used in combination with Proposition [\ref=gvn] to provide an iterative proof of Theorem [\ref=shkredov-thm]. This is that the sets F1,F2 which it outputs need not be uniform, and so it is quite possible that [formula]. The following further result is required.

Let α,τ,σ∈(0,1) be parameters, and let S'  =  F1  ×  F2 be a product set in W  ×  W with |Fi|  =  δiN. Suppose that A  ⊆  S' is a set with δS'(A)  =  α  +  τ, and that

[formula]

Then there is a subspace W'  ⊆  W, [formula] and t1,t2∈W such that if [formula], [formula] and S''  =  E'1  ×  E'2 then

[formula];

E'1,E'2 are 2σ-uniform as subsets of W';

[formula].

The proof of this theorem also proceeds by a version of the iterative method, and in this sense Skhredov's argument is a sort of double iteration method. The most important content of the proposition is that if S  ⊆  W  ×  W then we may pass to a translate of W'  ×  W' on which S looks uniform, where [formula] is a subspace of somewhat large codimension. If this really was our only aim, then we could proceed as follows. Either S is already uniform, or else S has a large Fourier coefficient ξ. In the latter case, S has increased density on some translate of [formula], by Lemma [\ref=uniformity-hyperplanes] (2). [formula] obviously contains a set of the form W'  ×  W', with W' having codimension at most two. Now simply iterate the argument.

The one further issue is that we also need to keep control of the density of A, which sits inside S. To achieve this it is necessary to partition W  ×  W into pieces which are translates of products W'  ×  W', such that S is uniform on almost all of them. By a simple pigeonhole argument there must be some piece on which S is uniform, and on which the relative density of A is still quite large. Note that the subspaces W' need not be the same for each piece; this is important from the point of view of obtaining bounds, or else one runs into examples such as that in § 9 of [\cite=green-reg].

To get this decomposition into pieces one uses the iterative argument with one small modification. At the jth stage of the iteration we will have a collection [formula] of pieces, each being a translate of some product W'  ×  W'. If c∈Cj, write δ(c) for the relative density of S on the piece c. Our previous proposal was to ensure that sup c∈Cjδ(c) increases at each step of the iteration, this idea having served us well in the past. What one does instead is to increase the L2 average [formula]. This can be accomplised by using Lemma [\ref=uniformity-hyperplanes] (1).

Propositions [\ref=prop5.7] and [\ref=prop5.8] together give the requisite density increment result to go with the generalised von Neumann theorem of Proposition [\ref=gvn]. Thus we can employ an iteration argument. Working out the bounds gives Theorem [\ref=shkredov-thm].

Progressions of Length Four

In this section we give another example of the iterative method at work.

Estimate r4(N), the cardinality of the largest subset of [formula] containing no four distinct elements x,x + d,x + 2d,x + 3d in arithmetic progression?

This question was, like Problem [\ref=prob1], raised by Erds and Turán in 1936. Szemerédi [\cite=szemeredi-4] was the first to show that r4(N)  =  o(N). It was not until as recently as 1998 that the first "sensible" upper bound, r4(N)  ≪  N( log  log N)- c, was provided by Gowers [\cite=gowers-szem4]. Gowers' argument was iterative, like the arguments of § [\ref=sec4] and [\ref=sec5].

Of course, one can define r4(G) for any abelian group G of size N. Recently, T.Tao and the author [\cite=green-tao-ap4s] studied the case [formula], starting from Gowers' work. Certain features of [\cite=gowers-szem4] become rather simpler in this setting, and we were able to run the iterative method quite efficiently, obtaining the following theorem.

[formula] for some c  >  0.

Write [formula] for the collection of all four-term progressions in [formula]. Any hope of proving a generalised von Neumann theorem with the same uniformity norm that we used in § [\ref=sec4] is dashed by the following example:

There is a set [formula] with density 1 / 5, which is highly uniform, but which does not contain roughly 5- 4N2 four-term arithmetic progressions.

Proof. Let [formula]. Then A certainly has density approximately 1 / 5. To see that A is highly uniform, write

[formula]

If λ  ≠  0 then each term in the product has magnitude [formula], giving a total contribution of 5n / 2; if λ  =  0 then, provided ξ  ≠  0, at least one term in the product vanishes. It follows that [formula].

However, A has roughly 5- 3N2 progressions of length four. Indeed, since A is so highly uniform we know from Proposition [\ref=prop3.3] that it contains roughly this many progressions of length three. However if x, x + d and x + 2d all lie in A then x  +  3d∈A automatically, in view of the easily verified identity

[formula]

Remark. Gowers has shown us an example of a subset of [formula] which is uniform and has density α, but has many fewer than α4N2 four-term arithmetic progressions.

Similar examples can be constructed using any quadratic form q(x)  =  xTMx  +  rTx  +  b in place of xTx. Remarkably, there are essentially no other examples. We shall formalise this statement in what follows.

Let [formula] be a function. Then the Gowers U3-norm of f, ||f||U3, is defined by ||f||8U3  =

[formula]

Again, it is not completely obvious that ||  ·  ||U3 is a norm, but this is not to hard to show. The following result is due to Gowers [\cite=gowers-szem4]. As with the other generalised von Neumann theorems we have mentioned, the proof involves several applications of the Cauchy-Schwarz inequality.

(Generalised Von Neumann theorem) Suppose that [formula] has density α, and that [formula]. Then A has at least α4N2 / 2 four-term arithmetic progressions.

The next theorem is proved in [\cite=green-tao-ap4s] by adding a single new idea, the so-called "symmetry argument", to the ideas of Gowers [\cite=gowers-szem4]. This theorem clarifies the sense in which the "quadratic" examples of Furstenberg and Weiss are in a sense the only ones:

Suppose that [formula]. Then A has quadratic bias, meaning that there is some quadratic form q(x)  =  xTMx  +  rTx  +  b such that A has density at least α  +  C(δ) on the zero set S  =  {x:q(x)  =  0}.

The reader may note that these two theorems do not, in their present incarnations, dovetail together to give an iteration argument because there is no natural definition of [formula]. Roughly speaking, Gowers took [formula] to be the collection of translates of subspaces of [formula]. It is possible to deduce from the conclusion of Theorem [\ref=gow-thm2] that A has increased density on some [formula], but unfortunately the codimension ω(S) might be exceedingly large (perhaps n  -  n1 / 100). This does not, then, lead to a very efficient iterative argument.

In [\cite=green-tao-ap4s] a much less appetising approach is forced to work, which leads to superior bounds. Roughly, this involves taking [formula] to be the collection of all quadratic submanifolds, our name for an intersection

[formula]

where qj(x)  =  xTMjx  +  rTjx  +  bj are quadratic forms. The "roughly" is quite important. We must in fact assume that S is "generic", meaning that the matrices Mj are not too linearly dependent. In practise this means that they satisfy a rank condition such as [formula] for all possible choices of scalars [formula]. We also allow our quadratic forms to be defined only on a subspace [formula] of not-too-large codimension. This is because of the very useful observation that an arbitrary quadratic submanifold can be made generic after passing to an appropriate subspace W.

Generalising the notion of Gowers U3-norm to such a setting is straightforward; in fact the definition is the same except that the expectation in [\eqref=gowu3] is taken over S. Proving an analogue of Theorem [\ref=gow-thm] is substantially more involved, but it is possible and reads as follows.

Let [formula]. That is to say, S is a generic quadratic submanifold in some [formula], this being the zero set of some k quadratic forms [formula] on W. Then S has approximately |S|3 / |W| four-term arithmetic progressions.

(Generalised von Neumann theorem) Suppose that A  ⊆  S has density α, and that [formula]. Then A has at least α4|S|3 / 2|W| four-term arithmetic progressions.

(Gowers-type inverse theorem) Suppose that [formula]. Then A has quadratic bias, meaning that there is some quadratic form qk + 1(x)  =  xTMk + 1x  +  rTk + 1x  +  bk + 1 such that A has density at least α  +  C(δ) on the set [formula].

A key feature of the theorem is that the density increment C(δ) is independent of the number of quadratic forms k. The proof of the theorem is long and somewhat difficult and occupies the bulk of [\cite=green-tao-ap4s].

Theorem [\ref=gow-thm22] of course allows one to set up an iteration scheme. If [formula] is a set with density α which contains no four-term progressions, then one may find a sequence

[formula]

of generic quadratic manifolds, defined on subspaces

[formula]

such that the density of A on Sj is at least α  +  jC(α20). This leads to a contradiction after C(α20)- 1 iterations.

Unfortunately, this still leads to a bound of the shape [formula], since we have only been able to establish Theorem [\ref=gow-thm22] with a function C(δ) which behaves like exp ( - δ- B), and this results in a very large number of iterations. We conjecture that a better bound holds, but we cannot prove this even in the less general context of Theorem [\ref=gow-thm2]. I regard this as one of the key open questions in this area of arithmetic combinatorics.

Let [formula] be a function with [formula]. Suppose that [formula]. Then there is a quadratic form q on [formula] such that

[formula]

for some absolute constant C.

We do know this with δC replaced by a function of exponential type. An affirmative answer to the PGI conjecture would be implied by an affirmative answer to the Polynomial Freiman-Ruzsa conjecture (PFR), which is discussed in some detail in § [\ref=sec10].

Fortunately, for the purposes of obtaining a bound on [formula] one can get by with a weaker conclusion in Theorems [\ref=gow-thm] and [\ref=gow-thm2]. In Theorem [\ref=gow-thm], one can obtain a "polynomial" density increment, leading to a much shorter iterative process, by passing to a set of the form [formula], where [formula] is a subspace. One can allow the codimension of W to be a power of α- 1, which is just as well since this is the best bound we have.

Szemerédi Regularity in Groups

The object of this section is to state some results and open problems from [\cite=green-reg]. The results are slightly different from those in the previous section in the problem addressed is not quite of "Szemerédi type". However what we discuss here is certainly in a similar spirit, being concerned with solutions of linear equations in sets of integers, and can furthermore be interpreted as an application of the iteration method.

We will be somewhat brief: more details can of course be found in the paper [\cite=green-reg] itself, which is written from a viewpoint rather similar to that of the present survey.

Szemerédi's regularity lemma is a famous result in graph theory. It can be regarded as structure theorem for all graphs, in the sense that it shows that one can decompose a completely arbitrary graph into a bounded number of pieces, almost all of which are pseudorandom. There are many excellent articles on this topic - see for example [\cite=komlos-simonovits].

One consequence of Szemerédi's regularity lemma is the following interesting result.

Let Γ be a graph on N vertices, and suppose that one must remove δN2 edges from G in order to destroy all triangles in Γ. Then Γ has at least C1(δ)N3 triangles, for some C(δ)  >  0.

Put another way, if a graph is almost triangle-free (i.e. contains few triangles) then it can be made truly triangle-free by the removal of a small number of edges.

Our investigations in [\cite=green-reg] were motivated by an "arithmetic" question related to the above theorem.

Let G be an abelian group of size N, and suppose that A  ⊆  G is a set. Suppose that one must remove δN elements from A in order to create a sum-free set (that is, a set with no solutions to x  +  y  =  z). Then A has at least C2(δ)N2 Schur triples (triples (x,y,z) for which x  +  y  =  z).

This result may be regarded as a structure theorem for sets which are almost sum-free; they can be made truly sum-free by the removal of a few elements.

This theorem is deduced from a result which we call a Szemerédi-type regularity lemma for abelian groups. This result is a perfect example for the present survey, since in the context of a general abelian group it requires substantial preparation to even state the result. When [formula], however, things are much easier.

Let [formula] be a set, and let ε  >  0 be a parameter. Then there is a subspace [formula] with codimension at most M(ε), and such that A is ε-uniform on at least a proportion 1  -  ε of the cosets of H.

Let us say, for the rest of this section, that A is ε-regular relative to H if it satisfies the conclusion of this theorem.

Let us sketch the deduction of Theorem [\ref=almost-sum-free] from Theorem [\ref=reg-thm]. Suppose that [formula] is a set with the property that one must remove at least δN elements from A to leave a set which is sum-free. Apply Theorem [\ref=reg-thm] with ε  =  (δ / 10)3, giving a subspace H of codimension at most M(ε) such that A is ε-uniform for a proportion at least 1  -  ε of the cosets of H. For each coset H  +  x, we ask two questions:

Is A ε-uniform on H  +  x?

Is the density of A on H  +  x at least (2ε)1 / 3?

If the answer to either of these questions is no then we simply remove all of [formula] from A. Let the set remaining after we have asked the above questions for all cosets H  +  x be called A'. It is easy to see that

[formula]

We claim that A' is sum-free. Indeed, were it not there would be x1,x2,x3 with x1  +  x2  =  x3, such that A is ε-uniform and has density [formula] on each H  +  xi. By Proposition [\ref=prop3.3] this means that K, the number of solutions to a1  +  a2  =  a3 with [formula], satisfies

[formula]

which means that [formula]. Thus certainly the number of Schur triples in A is certainly at least ε|H|2 / 2, which is at least ε2- 2M(ε)  -  1N2.

The proof of Theorem [\ref=reg-thm] is very much in the spirit of the iterative method. One again takes [formula] to be the collection of all subspaces [formula], but here there is no [formula]. Let [formula] be a set, and let [formula]. We define the L2-density of A with respect to H by

[formula]

In [\cite=green-reg] this is called the index, and is written (A;H).

The key to the proof is the following lemma (Lemma 2.2 of [\cite=green-reg]), which can be proved by elaborating somewhat on the proof of Lemma [\ref=uniformity-hyperplanes] (1).

Let [formula] and suppose that [formula] is a subgroup which is not ε-regular for A. Then there is a subgroup [formula] such that [formula] and [formula].

Theorem [\ref=reg-thm] is simply a matter of applying Lemma [\ref=lem2.2] iteratively. Since [formula] for any H, the number of iterations is no more than ⌈1 / ε3⌉.

An unfortunate feature of Theorem [\ref=reg-thm] and its proof is that M(ε) grows like a tower of twos of height ε- 3. This is because each application of Lemma [\ref=lem2.2] results in an exponentiation of the codimension of H. By adapting a brilliant construction of Gowers [\cite=gowers-tower], which shows that Szemerédi's regularity lemma for graphs must have tower type bounds, we were able to show that M(ε) must be at least as bad as a tower of twos of height about log (1 / ε).

We were not able to produce a similar example in the setting of Theorem [\ref=almost-sum-free].

Find a "reasonable" bound for C2(δ), the quantity appearing in Theorem [\ref=almost-sum-free], or prove that no such bound exists.

In fact for [formula] I am not able to exclude the possibility that C2(δ) can be a polynomial in δ. This need not be the case for [formula], due to the Behrend example of a large subset of [formula] containing no 3-term AP. See [\cite=green-reg] for a further discussion.

The corresponding for graphs (relating to Theorem [\ref=ruz-szem-thm]) is also wide open, though again it is known that C1(δ) cannot be taken to be polynomial in δ.

From Finite Fields to [formula]

We have now seen several examples concerning additive combinatorics in finite fields. However, for many of the problems we have considered it is an analogue in [formula] or (more-or-less equivalently) in [formula] which is actually of interest.

In recent years the passage from finite fields to the integers, at least for problems concerning configurations of the type we have been discussing in the last four sections, has started to form into something resembling a theory. This is thanks to the work of Bourgain [\cite=bourgain2] on finding good bounds for r3(N).

Bourgain's ideas are developed in detail in his original paper, of course, and have also been discussed in [\cite=green-reg] and [\cite=tao-notes]. In this section we restrict ourselves to a few remarks which illustrate the important points.

Consider the problem of finding a bound for r3(G) using the iteration method, where G is an abelian group with order N and no 2-torsion. It is not hard to see (essentially by changing the letter ξ to γ in Proposition [\ref=prop3.3]) that if A  ⊆  G has density α and substantially fewer than α3N2 3-term APs then A has a non-trivial large Fourier coefficient, that is to say

[formula]

has magnitude a large fraction of N for some non-trivial character γ∈G*.

It is not immediately clear how to use this information. We can no longer assert that A has increased density on a subspace, because in a general group G there is no such thing as a subspace. What we can show, rather painlessly, is that A has increased density on a translate of a Bohr set, that is to say a set of the form x  +  B({γ},ε), where

[formula]

The reader who has followed the various iterative arguments in the last four sections might now suggest that we define Struct to be the collection of all Bohr sets B(Γ,ε), where [formula] is a set of characters and

[formula]

Note that in [formula] a Bohr set is the same thing as a subspace when ε  <  1 / 4. Such a strategy is clearly not going to be without its difficulties. If [formula], it looks as though we are going to have to make some sense of what it means to do Fourier analysis on S. Since B(Γ,ε) is not a group, this will certainly not be a trivial matter.

In fact, B  =  B(Γ,ε) is quite a long way from being a group. The homomorphism [formula] carries B into a small d-dimensional box D. If one picks x,x' at random in D, the chance that x  +  x'∈D is just 2- d. Hence one expects that typically |B  +  B|  ≈  2d|B|, which compares unfavourably with the result |H  +  H|  =  |H| which holds if [formula] is a genuine subspace.

We will not, in this survey, go into the details of what we mean by Fourier analysis on B, nor how the large doubling constant of B is unpleasant in this context. We hope the reader will believe us when we say that reducing the doubling constant is a very helpful thing to do.

Bourgain's advance is to consider B not by itself, but together with another Bohr set B': = B(Γ,ε'), where ε' is much smaller than ε . Then if x∈B and x'∈B' we have x  +  x'∈B(Γ,ε  +  ε'), a set which ought not to be much larger than B. Thus |B  +  B'|  ≈  |B|, and we may think of the pair (B,B') as behaving like an approximate group. Roughly speaking, it turns out to indeed be possible to run an iterative argument in which Struct is the collection of all such pairs (B,B').

There are a number of further technicalities to be overcome. One interesting one is that our assertion that B(Γ,ε  +  ε') is not much larger than B(Γ,ε) is not true in general. Suppose, for example, that [formula], that the characters in Γ are linearly independent and that ε  <  2 sin (π / 5),ε  +  ε'  >  2 sin (π / 5). Then |B(Γ,ε)|  =  5n  -  d, whilst |B(Γ,ε  +  ε')|  =  3- d5n. Bourgain circumvents this difficulty by using an averaging argument to show that for a typical ε the size of B(Γ,ε) is roughly invariant under small perturbations of ε. Tao [\cite=tao-notes] observed that one could also replace Bohr sets by smoothed Bohr sets, and then such difficulties go away. I implemented this idea slightly differently in [\cite=green-reg], defining the a smoothed Bohr "set" by

[formula]

We conclude this section by giving an up-to-date summary of the extent to which the problems of the last four sections have been given Bourgain's treatment. Of course, in the original paper [\cite=bourgain2] the question of r3(G) was treated (actually, Bourgain only treats r3(N) but it is clear that his methods work in an arbitrary G). In [\cite=green-reg] the results of § [\ref=sec7] are all fully generalised to any finite abelian G, and in particular Theorem [\ref=almost-sum-free] is proved in this general setting. As regards adapting the methods of § [\ref=sec5] to obtain a bound of the form [formula], this ought to be possible (Shkredov, work in progress). Finally there is the issue of transferring the arguments of § [\ref=sec6] to obtain a bound of the form r4(G)  ≪  N( log N)- c. In particular one would like this for [formula], which would imply that r4(N)  ≪  N( log N)- c. Since the argument for [formula] is already rather difficult, one should not expect this to be at all straightforward. Even describing the correct generalisation of the notion of quadratic form to an arbitrary G is not straightforward [\cite=green-tao-manifesto].

Progressions in Sumsets

As promised, we now move onto questions of a somewhat more miscellaneous nature. This section concerns the following problem.

Let [formula] be a set of size N / 10 (say). Must A  +  A contain a long arithmetic progression?

Bourgain [\cite=bourgain1] proved that the answer is "yes"; A  +  A must contain a surprisingly long arithmetic progression. If L(N,α) is the smallest l for which there is a set [formula] of cardinality αN such that A  +  A does not contain a progression of length l, then Bourgain showed that L(N,1 / 10)  ≫   exp (c( log N)1 / 3). In [\cite=green-aps-sumsets] this was improved to L(N,1 / 10)  ≫   exp (c( log N)1 / 2). An example of Ruzsa [\cite=ruzsa-niveau] shows that L(N,1 / 10)  ≪   exp (cε( log N)2 / 3  +  ε).

It seems as though the natural finite field analogue of Problem [\ref=sumset-aps] involves replacing "arithmetic progression" by "coset of a subspace".

Write D(n,α) for the smallest d for which there is [formula] of density α such that A  +  A does not contain a coset of a subspace of dimension d. Estimate D(n,α).

The techniques of [\cite=green-aps-sumsets] adapt to this situation in a straightforward manner, and one obtains the following.

Suppose that [formula]. Then [formula].

A detailed proof of this fact may be found in [\cite=green-rkpnotes]. In keeping with the philosophy of this survey, some of the details are rather cleaner than in the orginal argument [\cite=green-aps-sumsets] which applied to subsets of [formula].

A more dramatic difference between the finite field case and the original setting of Problem [\ref=sumset-aps] can be observed when one tries to adapt Ruzsa's construction to the finite field setting.

[formula].

Proof. Let A be the set of all vectors [formula] with at least [formula] ones with respect to the standard basis. By the central limit theorem the number of ones in a random vector [formula] is roughly normally distributed with mean n / 2 and standard deviation [formula], and so for large n we have [formula]. Now any vector x∈A  +  A must have at least [formula] zeros. Using this fact, we shall prove that A  +  A meets all translates of all [formula]-dimensional subspaces. Indeed, write [formula] and suppose that U is a translate of some subspace of dimension n  =  d. U can be written as

[formula]

where the ai are linearly independent. Write ai in component form as (a(j)i)nj  =  1. The column rank of the matrix (aij) is n  -  d, and hence so is the row rank. Without loss of generality, suppose that the first n  -  d rows [formula], [formula], are linearly independent. Then we can solve the n  -  d equations

[formula]

for the λi, giving a vector in U with no more than d zeros.

Narrow the gap between Theorems [\ref=thm9.3] and [\ref=ruz-niv].

My suspicion is that the upper bound of Theorem [\ref=ruz-niv] is closer to the truth.

I cannot resist mentioning two problems which were raised at the AIM conference on additive combinatorics. The first is due to Croot:

Fix θ∈(0,1). What is

[formula]

In words, we are interesting in finding subsets A  ⊆  [N] with density N-  θ such that A  +  A contains no long arithmetic progression. Croot states that the bounds [formula] are known. The upper bound comes by considering a multidimensional progression of dimension about θ log 2N: it would be interesting to see whether a construction related to niveau sets gives anything better.

The second question is due to Katznelson:

What is the measure of the largest open subset A of the torus [formula] for which A  -  A does not contain a 1-dimensional subgroup? In particular, is it 2- d?

Freiman's Theorem

A great deal of the material in this section was communicated to me in person by Imre Ruzsa, and is reproduced here and in the supplementary document [\cite=sup-doc-2] (which contains proofs) with his kind permission. The reader will also wish to consult Ruzsa's own survey article [\cite=ruzsa-survey], as well as the material from the AIM conference on Additive Combinatorics [\cite=aim-notes].

This section concerns Problem [\ref=prob2] of the introduction. Let [formula] have doubling at most K, meaning that we have the inequality [formula]. What can be said about the structure of A?

It is hard to think of any examples of sets A with this property other than cosets of subspaces, and large subsets of them. In fact, these are the only such examples as was shown by Imre Ruzsa [\cite=ruzsa-freimangroups]. The best known bounds for a result of this type are due to Ruzsa and the author [\cite=green-ruzsa3]:

Let [formula] be a finite set with [formula]. Then A is contained within a coset of some subgroup [formula] with [formula].

A version of this result, with somewhat weaker bounds, will be a consequence of Proposition [\ref=ruzsa-prop] below (which is also due to Imre Ruzsa).

Theorem [\ref=freiman-torsion] gives, in a weak sense, a complete description of sets with small doubling. We showed that if [formula] then A is contained in a coset of a subspace of size at most K222K2 - 2|A|; conversely, if A has this property then it is clear that [formula]. It would be of great interest to have a structure theorem which does not result in exponential losses in K of this sort. Perhaps one can even arrange things so that one has a result of the form

[formula]

where K' is polynomial in K.

It is easy to see that such a structure theorem would have to take a form somewhat different from Theorem [\ref=freiman-torsion]. Indeed if one takes [formula] to be a subspace H together with K points [formula] such that [formula] then it is clear that [formula], but that the smallest coset-of-a-subspace containing A has size roughly 2K|A|.

Ruzsa [\cite=ruzsa-freimangroups] reports that Katalin Marton has suggested that one should be looking for a covering of A by a small number C1(K) of cosets of some rather smaller subspace of size C2(K)|A|. I agree with this, and it is to some extent believeable that C1(K) and C2(K) can be polynomial in K. Ruzsa was probably the first to actually dare to conjecture this, and he certainly states such a conjecture explicitly in [\cite=ruzsa-survey]. Such matters are also touched upon (in the [formula]-setting) in [\cite=bourgain3] [\cite=gowers-rough-struct].

Imre Ruzsa indicated to me a large part of the following proposition giving a number of statements equivalent to such a structure theorem. The proof may be found in [\cite=sup-doc-2].

The following five statements are equivalent.

If [formula] has [formula], then there is A'  ⊆  A, [formula], which is contained in a coset of some subspace of size at most C2(K)|A|.

If [formula] has [formula], then A may be covered by at most C3(K) cosets of some subspace of size at most C4(K)|A|.

If [formula] has [formula], and if additionally there is a set B, [formula], such that A  +  B  =  A  +  A, then A may be covered by at most C5(K) cosets of some subspace of size at most C6(K)|A|.

Suppose that [formula] is a function with the property that [formula]. Then f may be written as g  +  h, where g is linear and [formula].

Suppose that [formula] is a function with the property that for at least 23m / K of the quadruples [formula] with x1  +  x2  =  x3  +  x4 we have f(x1)  +  f(x2)  =  f(x3)  +  f(x4). Then there is an affine linear function [formula] such that f(x)  =  g(x) for at least 2m / C8(K) values of x.

Furthermore if Ci(K) is bounded by a polynomial in K for all i∈I, where I is any of the sets {1,2},{3,4},{5,6},{7},{8} then in fact Ci(K) is bounded by a polynomial in K for all i.

Remarks. Statement (4) is perhaps the most elegant and natural one here. Observe also that (4) is rather easy with the bound C7(K)  =  2K. Thus Proposition [\ref=ruzsa-prop] implies a weak version of Theorem [\ref=freiman-torsion]. It is the possibility of polynomial bounds for Ci(K) that is the most interesting feature of this proposition. Let us call this the PFR conjecture:

The function C7(K) (and hence all of the other functions Ci(K), [formula]), can be taken to be polynomial in K.

The following question has implications for PFR.

Let [formula] be a set of density α. Then 2A  -  2A contains a subspace with codimension f(α). What is the behaviour of f(α)?

Using a Fourier-analytic technique of Bogolyubov [\cite=bogolyubov] one may show that f(α)  ≪  α- 2, and a refinement of this technique due to Chang [\cite=chang] allows one to improve this to f(α)  ≪  α- 1 log (1 / α). We have not been able to rule out the possibility that f(α)  ≪   log (1 / α), which if true would imply PFR.

The proof of Proposition [\ref=ruzsa-prop] uses an important result known as Plünnecke's inequality [\cite=plunnecke], a new proof of which was found by Ruzsa [\cite=ruzsa-plun]. This states that if A is a subset of any abelian group G, and if [formula], then we have the inequality [formula] for any positive integers s,t. The reader may observe that (1) of Proposition [\ref=ruzsa-prop] implies a much stronger bound for some large subset A'  ⊆  A, for large s,t, at least if there is a good bound on C2(K). We may call such an A' subplünnecke. Nets Katz asked me to formulate a principle to the effect that A being subplünnecke implies that A is very economically contained in some coset of a subspace. The following result is my best effort so far in this direction:

Let [formula], and suppose that there is a constant B such that [formula] for all [formula]. Then A is contained in a union of 2CB log B cosets of some subspace having size at most |A|.

The hope, of course, is that one might be able to show that if [formula] then A has a large subset A' which is subplünnecke in the sense of Proposition [\ref=subplunprop], for some reasonably small B (ideally, B  =  O( log K /  log  log K), which would imply PFR).

For me the most important reason for wanting to understand the PFR conjecture is the implications it would have for our understanding of quadratic Fourier coefficients. In particular, PFR in [formula] (the formulation is obvious) would imply a positive solution to the PGI Conjecture (Conjecture [\ref=quad-inverse]).

Suppose that PFR is true in [formula]. Then PGI is true. That is, let [formula] be a function with [formula], and suppose that [formula]. Then there is a quadratic form q on [formula] such that

[formula]

for some absolute constant C.

The deduction is given in [\cite=green-tao-manifesto].

In my opinion it would be very interesting to determine whether PGI has any implications for PFR. It is just plausible that this represents the most natural way to attack PFR, though at the moment we have little idea how to carry out such a programme.

The results of this section may be discussed in the context of general abelian groups G. However, the issues are of a rather different nature to those discussed in § [\ref=sec8]. Freiman's original work concerned subsets of [formula], and was quite geometric in feel. See [\cite=bilu] [\cite=freiman] [\cite=green-edinburgh-notes] for a further discussion. Ruzsa's proof [\cite=ruzsa-gaps] has proved much more adaptable, and recently Ruzsa and the author [\cite=green-ruzsa4] were able to obtain a structure theorem for sets with small doubling which is valid in any abelian group.

Let G be an abelian group, and suppose that A  ⊆  G has [formula]. The A is contained in a set of the form H  +  P, where H is a subgroup, P is a generalised arithmetic progression, the dimension of P is [formula] and [formula].

Remark. A generalised arithmetic progression of dimension d is a set of the form

[formula]

We obtain the bounds C9(K)  ≪  KC and C10(K)  ≪  eKC, for some absolute constant C.