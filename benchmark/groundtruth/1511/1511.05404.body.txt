Prediction in complex systems: the case of the international trade network

Introduction

In the past few years, the international trade network has attracted the attention of researchers from various fields, and especially from the complex networks scientists. The international trade was studied for the first time under the network framework in [\cite=snyder1979structural], using a blockmodel consisting in partitioning countries together according to their trade flows, military interventions, diplomatic exchanges, and conjoint treaty memberships. The complex network approach was used in [\cite=serrano2003topology] and showed that the international trade exhibits common features with the World Wide Web network. It has been shown that many features of the international trade can be explained using models based on the gravity equation [\cite=tinbergen1962analysis] [\cite=fagiolo2010international] [\cite=bhattacharya2008international]. Recently, not only the countries, but also their exports have been analyzed under the complex network framework. The Product Space attempts to explain how the nations develop by projecting their exports on a 2D map, and observing how they diffuse in the Product Space [\cite=hidalgo2007product]. The Economic Complexity aims to rank products by the technological requirements needed for a country to be able to manufacture a product, and to rank the countries by their competitiveness [\cite=hausmann2007you] [\cite=cristelli2014overview].

The prediction of quantity and price of exports in the international trade has been studied using various models [\cite=hummels2005variety] and additional information such as geographical distance between countries and common language [\cite=rauch1999networks]. By contrast, we employ here a recommendation approach that is usually applied to e-commerce systems [\cite=liben2007link] [\cite=lu2011link] in order to predict what an individual country will export in the future. The prediction of which products a country will add to its export basket can help to understand how countries grow. The countries' future exports are particularly complex to predict, as their evolution depends on many external factors, such as geographical position, diplomatic relations between countries, available natural resources, and technologies. Nevertheless, previous studies [\cite=hidalgo2007product] [\cite=tacchella2012new] showed that it is possible to measure the competitiveness of a country, estimate its future growth and even predict its future exports using solely the international trade data. The last aspect, personalized prediction of future exports for each country, further suffers from the lack of a traditional approach with conventional metrics and renowned prediction algorithms.

Recommender systems were created to filter the relevant information in information systems [\cite=resnick1997recommender] [\cite=adomavicius2005toward]. For instance, an algorithm can help a person to choose which movie to watch by creating a list of most relevant movies that this particular person might enjoy, whereas it is a tremendous task to find a movie of interest among the thousands of existing ones. Recommendation using temporal and causal effects has recently attracted attention [\cite=zhu2015consistence] [\cite=koren2010collaborative]. In this paper, we use a network representation for countries and their exports. A network is made of nodes connected by links. Nodes represent countries and products, and a link connect a country to a product if the country exports the product. We call this type of network bipartite, as the nodes are formed by two disjoint sets: countries and products. This allows us to treat the problem within a recommender system framework [\cite=lu2011link]. The approach that we use slightly differs from a link prediction approach because we aim to predict the future exported products for each country instead of predicting the most likely future exports for the network as a whole.

We use a recent recommender algorithm based on diffusion [\cite=zhou2010solving] as a tool for prediction. However, as demonstrated in , the international trade data fundamentally differs from online systems data on which recommendation is typically done by the absence of preferential attachment [\cite=barabasi1999emergence]. This makes it impossible to predict the future popularity of a product from its current popularity and the predictions thus have correspondingly lower accuracy. To improve the recommendation accuracy, we adopt a temporal approach to devise a new definition of mutual distance between products, and couple it with the diffusion method in order to enhance the prediction of the links. This approach is closely related to the proximity of products [\cite=hidalgo2007product], defined as a distance between each couple of products depending on the number of co-occurrences in countries' export baskets. Based on this distance, it was shown that the closer a product is to one of the products the country is currently exporting, the more likely it is to be added to the country's export basket in the future. The recommendation of movies to users was improved by the use of co-occurrences in [\cite=zhu2015consistence]. In [\cite=koren2010collaborative], the authors studied the temporal dependence of movies ratings and used it to improve the prediction of future ratings.

In order to improve the prediction performance of the diffusion method, we also use Economic Complexity as defined in [\cite=tacchella2012new]. The first definition of Economic Complexity was made by the use of two self-consistent linear equations [\cite=hidalgo2009building] [\cite=hausmann2014atlas], which were then successfully applied to predict the long-term growth of countries' export basket. A more recent definition was given as a set of two self-consistent non-linear equations [\cite=tacchella2012new] that reflect the non-linear relations between complexity of products and competitiveness of countries. This non-linear definition of complexity was shown to capture more information than the linear one on the countries' hidden growth potential in a toy model of countries' exports [\cite=cristelli2013measuring]. The use of the complexity of products in the prediction process allows us to improve the diversity of the prediction, while maintaining the same level of accuracy. In contrast with the mutual distances introduced previously, the Economic Complexity theories aim to assign each country and product an individual score on an absolute scale.

Methods

Data

We use the NBER-UN dataset which was described and cleaned in [\cite=feenstra2005world]. We cleaned it further by removing aggregate categories and keeping only the countries for which complete mutual export data are available. Products having zero total export volume for a given year while having nonzero total export volume for the previous and the following years were removed from the dataset. Products and countries with no entries after year 1993 were removed as well. After the cleaning procedure, the network consists of 65 countries and 770 products. To decide if we consider country i to be an exporter of product α or not, we use the Revealed Comparative Advantage (RCA) [\cite=balassa1965trade] which is defined as

[formula]

where eiα is the volume of product α that country i exports in thousands of US dollars. RCA characterizes the relative importance of a given export volume of a product by a country in comparison with this product's exports by all other countries. We use a bipartite network representation with two different kinds of nodes, one for countries and one for products. All country-product pairs with values above a RCA threshold--which is set to 1--are consequently joined by links between the corresponding nodes in the bipartite network. Before the RCA threshold is applied, there are 35,881 links between the countries and products. In the year 1998, 10,148 links are above the RCA threshold, which means that 20% of all possible links between countries and products are present. In this paper, Latin symbols i,j are used for countries and Greek symbols α,β for products. The set of links present at year t is labeled Ct, and the set of new links that have been added between time t - 1 and t is labeled [formula] (the set of new links could also be built with a longer time step, i.e [formula], see ).

Note that we omit time indices in the following sections for the sake of clarity and we implicitly discuss the status of the network at time t. The degree values ki and kα, are the number of links originating at a country node i and a product node α, respectively.

International trade metrics

In many online bipartite networks, such as users and movies, users do not require any special skill to watch a movie. Conversely, countries need capabilities in order to produce a good and then export it. And so it is in particular important to capture the relations between items, as a country needs to build its path towards a product in order to add it to its export basket [\cite=hidalgo2009building]. We want to take into account this major difference in our prediction process by using quantities especially developed for the international trade. We first describe two metrics--proximity and causality--used to assess the relations between products, which can be further extended to describe the relations between countries and products. In [\cite=hidalgo2007product] the proximity φαβ of products α and β was introduced as the symmetrized probability that a country exports product α, given that it exports product β.

[formula]

where Ci is the set of products exported by country i, P(α∈Ci|β∈Ci) is the probability of exporting product α given that β is being exported, and φαβ is the proximity of α and β. The proximity Φiα of product α to country i is defined as the average proximity of products in i's export basket to product α

[formula]

Based on proximity, we propose a measure labeled causality which takes into account the time order in which products are introduced in production, similar to the URL/HTTP prediction in [\cite=sarukkai2000link] and to the country-product time evolution analysis in [\cite=zaccaria2014taxonomy]. Causality is defined as the conditional probability that country i starts to export product α at time t, given that it does export product β at time t,

[formula]

Its method of computation of is given in Appendix B. Based on this, a modified closeness Ψiα between product α and country i is defined as the average causality between product α and i's export basket

[formula]

where ψαβ is defined in .

The third metric assigns a score to individual countries and products instead of describing the relations between products. In [\cite=tacchella2012new], the country-product network was studied using a set of self-consistent equations to compute fitness of countries and complexity of products. Fitness of a country indicates its ability to manufacture complex products, relatively to other countries, while complexity of a product indicates the amount of technology required to produce it. Country fitness and product complexity are defined as

[formula]

where n is the current iteration, Cα is the set of countries that export product α, Fni is the fitness of country i at iteration step n and Qnα is the complexity of product α at step n. Fitness and complexity are initialized as F0i = Q0α = 1 and normalized after each iteration so that their sum is N and M, respectively. The convergence of the algorithm and its stopping condition were studied in [\cite=pugliese2014convergence].

Link prediction

Algorithms inspired by heat [\cite=zhang2007heat] and mass [\cite=zhou2007bipartite] diffusion were designed to recommend items to users in bipartite networks [\cite=zhou2010solving]. If the two methods are coupled together, the resulting hybrid diffusion method is one of the best performing link prediction method in bipartite networks without explicit rating of items [\cite=lu2012recommender].

The relative weight of heat and mass diffusion is controlled by an adjustable parameter λ. Each product α is assigned an initial resource fα, and each resource is propagated by [formula], where the elements of the hybrid diffusion matrix [formula] are

[formula]

where aiα is 1 if RCAiα  ≥  1 and 0 otherwise. The matrix [formula] corresponds to the propagation of resource through the links of the networks, similar to either heat diffusion (λ = 0) or mass spreading (λ = 1). The matrix notation is an elegant way of mixing the two diffusion processes; but its interpretation is not straightforward. We refer to the original paper [\cite=zhou2010solving] for a detailed discussion. Elements of the initial resource vector for a given country are set to 1 for all the products that meet the RCA threshold and zero otherwise.

We attempt to improve the hybrid prediction method by including the causality closeness ψiα in the final diffusion score as

[formula]

where fiα is the score that the hybrid method assigns to the link between country i and product α. We label this method causality+hybrid. In this way, recommendation gives preference to products that are considered similar to the current production of country i, in terms of causality. Proximity Φiα can be used in the same way, giving rise to the proximity+hybrid method.

In the same spirit, we attempt to improve our export predictions by including the complexity scores in the hybrid diffusion process by multiplying the initial resource assigned to the product α with a factor

[formula]

where θ is an adjustable parameter and Rα,t is the complexity rank of product α at time t (ranks 1 and M correspond to the product of highest and lowest complexity, respectively). Note that fitness of countries as well as rankings obtained by the Method of Reflections [\cite=hidalgo2009building] [\cite=hausmann2014atlas] can also be used to weight the propagation process, but the results are nearly identical to the complexity modification. For θ > 0, the weights computed in give more initial resources to high complexity items. By giving additional resources to high complexity products, a higher score is diffused to the products that are also of high complexity, as high complexity products are exported by high fitness countries.

Link prediction metrics

In this section, we define six metrics to measure the quality of the prediction, three assess its precision and three evaluate its diversity. Recommender system assign a score to each country-product couple. To measure how good are the predictions based on the data from a given year, we focus on all links in the country-product network that are absent in that year and appear in the next year (new exports). The ranking scores r is obtained by ranking the corresponding products in the score list of the corresponding countries, and compute the relative rank riα = piα / (M - ki), where piα is the rank of product α in country i's score list. By averaging this quantity over all newly added links, we obtain the ranking score r.

The prediction list for an individual country is built with the top L scoring products that do not meet the RCA threshold in year t. where L is set to 20 in this work (see ). A correct prediction occurs if a link is present in the prediction list at a given year, and in the network in the next year. We denote by Di(L) the number of correct predictions for country i. By averaging Di(L) over countries and normalizing it by the length of the prediction list L, we obtain precision P(L) [\cite=zhou2010solving]. Precision of 0.1 means that 10% of the products in the top L score lists are correctly predicted. Countries differ in size and the number of new items that they introduce in their export basket each year. To take this variety into account, we use recall [formula], where [formula] is the number of links originating from country i in Nt. Overall recall R(L) is obtained by averaging Ri(L) over all countries. Recall complements precision; the two metrics are often considered simultaneously.

The diversity of the prediction lists is also an important aspect of the methods. The first two metrics assess the degree and complexity for correctly predicted links. Note that in [\cite=zhou2010solving] these metrics were computed over all prediction lists' entries, not only the correctly predicted ones. A subscript c is added to point out this difference. For each product α, we compute the self-information Iα  =   log 2(N / kα) [\cite=tribus1961thermostatics]. By averaging it over all correctly predicted links for country i we obtain Ic,i(L), and its average over countries is novelty Ic(L). The higher the score, the more items with low degree we predict. We argue that a good prediction method should predict products of high complexity as they require more advanced technology than low complexity ones. We further define the quantity Cc,i(L) as the average complexity rank of products that are correctly predicted for country i. Its average over each country gives the complexity metric Cc(L). We finally measure how the prediction lists differ from each other with the inter-list Hamming distance [\cite=hamming1950error] (also named personalization) hij(L) = 1 - qij(L) / L, where qij is the number of common products in the prediction lists of countries i and j. The overall personalization h(L) is obtained by averaging over all country pairs; the values of zero and one correspond to all lists being identical and mutually exclusive, respectively.

Results

To begin our analysis, we compare the statistical properties of the country-product network with other types of real bipartite networks. Bipartite networks representing online systems typically consist of user- and item-nodes with connections between them drawn when a user has collected, bought, rated, or otherwise interacted with an item. The item degree distribution is usually broad and often exhibits a power-law shape [\cite=lu2012recommender]. This is a direct consequence of the preferential attachment process [\cite=barabasi1999emergence], which occurs in many real networks, such as scientific collaboration networks [\cite=newman2001scientific], metabolic networks [\cite=jeong2000large] and social networks [\cite=newman2001structure]. The preferential attachment assumption is based on the observation that high degree nodes attract additional links at a higher rate than low degree nodes. We show in a that the degree distribution on the product side of the country-product network differs greatly from the power-law distribution shown in c for the Netflix Prize network [\cite=bennett2007netflix] (Netflix Prize was a recommendation contest organized by the DVD rental company Netflix; the data consist of users and DVDs that they have rated). As shown in b and d, the degree increase per time step is also different for the two networks. The degree increase of products in the country-product network is weakly negatively correlated with the current degree (the linear correlation coefficient is r =  - 0.28), while for the Netflix Prize network there is a strong positive correlation between degree increase and the current degree (r = 0.77). As we shall soon see, this difference and the resulting high diversity of the products that receive new links in one time step reduce the prediction accuracy in the country-product data as compared to the accuracy in user-item data. While the preferential attachment model is a good description of the growth in the Netflix Prize network, it is obviously not a suitable one for the country-product network. Models based on hidden capabilities of countries and required capabilities for producing various products seem more appropriate in this respect [\cite=hidalgo2009building] [\cite=cristelli2013measuring].

The performance of four basic prediction methods are compared in different years in . In user-item data, mass diffusion outperforms significantly its heat diffusion counterpart [\cite=lu2012recommender] [\cite=zhou2010solving]. However, as a and c show, the situation is very different in the country-product data: heat diffusion outperforms mass diffusion in both ranking score and precision. The reason lies in the absence of preferential attachment in the country-product data as shown in b and d. An example using a simple model with and without preferential attachment is provided in . Heat diffusion which, unlike mass diffusion, does not favor popular items [\cite=zeng2012reinforcing] is thus better suited for the prediction task here. Causality and proximity can be used alone to predict the future exports of countries (see b, d). Causality outperforms proximity in ranking score, which indicates that the temporal aspect of ψiα captures different relations between products than φiα. At the same time, proximity outperforms causality in the precision metrics, indicating that top-scoring products are more relevant with proximity than causality. When optimizing the prediction performance, we found that averaging proximity from year 1992 provides the best results, while causality benefits from a longer time period and data from as early as 1984 were used to build the causality relations (see ).

We compare the performance of all the methods in . In agreement with [\cite=zhou2010solving], the hybridization between mass and heat diffusion improves every accuracy metrics, as well as prediction diversity. Compared to the hybrid method, complexity+hybrid () slightly improves every metric, albeit at the expense of adding an additional free parameter in the prediction process. Proximity and causality both perform similarly to the hybrid diffusion method, without any parameters, and both have their strong points: causality yields better ranking score and predicts products of lower degree, while proximity yields better precision and predicts products of higher complexity (d). By coupling proximity or causality with diffusion, we further improve the results. The best overall performance is obtained with causality+hybrid. Compared to random predictions, the precision metric is improved by a factor of 4 as compared to a factor of 80 in the Netflix Prize network [\cite=zhou2010solving], which indicates a comparably low predictability of future links appearing in the country-product network. Note that we can add an additional parameter in the causality+hybrid method by exponentiating the causality score (ψiα  →  ψθiα, where θ is a free parameter), resulting in an improvement of roughly 3% on the ranking score, but a substantial improvement (around 20%) of the personalization metric.

The selection of parameters is an important issue for those non-parameter-free methods. We generally use the whole dataset to optimize the parameters of our prediction methods. To control for possible overfitting, we use an approach similar to the three-fold validation which is common in information filtering [\cite=abu2012learning] [\cite=zeng2013information]. We first find the parameters for year t that minimize the ranking score, and then use the optimized parameters to make the prediction for year t + 1. a shows that the optimal parameters are nearly constant over time for Hybrid and causality+hybrid methods. b further shows that the parameter range in which complexity and causality coupled with diffusion methods outperforms hybrid diffusion method is quite wide. The ideal parameter of causality+hybrid method is very close to 0, which makes the causality+hybrid effectively a parameter-free method. In d, we set the parameters to a fixed value before the prediction. We see that the accuracy and diversity improvements are still present for every method, and both complexity and causality coupled with diffusion improve further those results.

Discussion

We used the hybrid diffusion algorithm [\cite=zhou2010solving] one of the standard recommendation methods in unweighted bipartite networks, to predict new links in the country-product export network. Unlike for the usual user-item data, heat diffusion algorithm produced satisfactory results, which we attributed to the growth mechanism of country-product data where preferential attachment--a key driving force in user-item data--is absent. Recently developed metrics for country fitness and product complexity were used to enhance the prediction performance. While they carry information about individual countries and products and generally enhance prediction performance, we found relations between products--proximity and causality--to be even more beneficial. The best overall prediction method was achieved by combining the heat diffusion recommendation with causality scores.

In this work, we restricted our input information to the state of the country-product network obtained by applying the RCA threshold; the detailed information on the export volume has been ignored. If we remove this restriction and use for instance the RCA values for prediction, we can achieve high prediction accuracy simply by ranking the products by their RCA value in the prediction list (products whose RCA exceeds 1 are naturally excluded because the corresponding links already exist). This results in the ranking score [formula], and precision [formula], which is a significant improvement over the best-performing causality+hybrid method which yields [formula], [formula]. The improvement is a direct consequence of using additional information (relative link importance quantified by the RCA metric) which is furthermore very specific to the country-product network and thus not available in other systems to which our prediction approach may be relevant (bipartite user-item networks where links connect items with the users who have purchased or otherwise connected with them, for example).

The introduction of the causality score demonstrates the possibility and benefits of using time information in the prediction process. This score can also find its use in other kinds of data, such as user-movie data where a user who appreciated the first episode of a series of movies is likely to watch also the second one. Apart from prediction, causality needs to be studied further to understand what it tells us about the relations between products; for example by inspecting which products are exported before a new product starts to be exported. The prediction in the country-product network can be further improved external information on geography (neighboring countries may have similar capabilities) and temporal evolution of prices and export volumes (their growth may attract new producers). Prediction approaches built on multiple models and components motivated by machine learning [\cite=bell2007lessons] [\cite=koren2009matrix] [\cite=jahrer2010combining] could eventually contribute to understanding the limited prediction precision in country-product data.

Acknowledgments

This work was supported by the Swiss National Science Foundation Grant No. 200020-143272 and by the EU FET-Open Grant No. 611272 (project Growthcom).

Effect of timestep on precision metrics

In the main text, we predict the new products that countries will export in the next year. In , we fix a year t and predict the new products that countries will export in year t + Δt, but that it is not exporting in year t (in terms of sets, we try to predict [formula]). With respect to the ranking score r, causality is optimal when predicting the near future, but becomes less accurate for higher Δt. Proximity and hybrid are less sensitive to Δt. Precision increases with Δt for every method because the number of new products exported for each country increases with Δt.

Parameters of causality and proximity relations

Causality and proximity have two parameters each. The first one is the number of years used to compute the resulting values. The results are shown in a and b. For proximity, it is mostly optimal to use data from 1991, which corresponds to the arrival of unified Germany in the dataset. For causality, while it is generally beneficial to increase the history length, taking data before 1984 results in a worsening of ranking score due to a change of products' classification original dataset (see Ref. [\cite=feenstra2005world]). The causality relations were computed country by country: for each country we consider that there is a causal relation between α and β for country i if α∈Nti and β∈Cti at least once during the period considered. The causality ψαβ is the simply the ratio between the number of causal relation and the number of countries that export the product at least once. We can restrain the computation to the n closest products when computing the closeness between a country and a product. By doing so, we aim to take only the most significant products into account, which is similar to the nearest neighbors typically used in recommendation algorithms [\cite=sarwar2001item]. The results are shown in c and d. We eventually use the all products into account to compute both proximity and causality. While d shows that it is not the optimal choice for causality, the difference is rather insignificant (around 0.2%).

Length of the prediction list

A prediction method assigns a score to every country-product pair, and generates a prediction list of length L for each country by choosing the L best-scoring products. The length of the prediction lists is a free parameter, which can be set arbitrarily. We use L = 20 in the main test, which reflects the length of a practical prediction list [\cite=zhou2010solving], and it is also close to the mean number of new products exported by each country between two consecutive years (approximately 17.2 averaged from 1994 to 2000). For completeness, we show the dependency of precision and recall on the length of the prediction list in . Precision decreases with the prediction list length L, which shows that the best ranked products indeed have the highest probability of being exported by a given country in the next year.

The interplay between preferential attachment and Heat diffusion

We study here a simple model in order to verify that in a network without preferential attachment, it is possible for the Heat diffusion algorithm to have accuracy comparable with that of Mass diffusion. Our network consists of N users and M items. Each user i has a vector of preferences [formula] and each item α has a vector of categories [formula], which correspond to users' tastes. An item can either belong to a category or not which corresponds to the elements of category vectors being either one or zero. On the other hand, a user can either like category, ignore it, or even dislike it, which corresponds to the elements of user preference vectors being 1, 0, or - 1, respectively. Elements of category vectors are set to 1 or 0 with 50% probability each. User preference vectors are set to zero with 50% probability, or else to 1 or - 1 with equal probability. Links are created one by one between the users and items. The user i to which we add a link is chosen among every users with uniform probability, and the item α is chosen with the following rule

[formula]

where θ is a parameter to tune the amount of preferential attachment or users’ preferences used in the growth process, and Oαi is the number of items β which fulfill [formula]. Normalization with Oαi enhances the weight of items with high overlap [formula] and compensates for the fact that the number of such items is small. When [formula], the term proportional to 1 - θ is ignored and only the first term contributes to P(α,i). In total, m links are created in the network. Note that the model setting and parameters are arbitrary and can be modified to accommodate different behavior of user and items. This elementary model, similar to the agent-based model that was used to evaluate a news recommendation model [\cite=medo2009adaptive] [\cite=zhou2011emergence], is nevertheless sufficient to illustrate the desired dependency between preferential attachment and recommendation performance.

When the network is built only with preferential attachment (θ  =  1), the correlation between the actual degree of items and their future degree increase is 0.91. When only users’ preferences are used to build the network (θ  =  0), this correlation drops to 0.11. Recommendations obtained with either Heat or Mass diffusion method on artificially created data are then evaluated using the same approach as the country-product data before. The results are presented in . In the absence of preferential attachment, Mass and Heat perform similarly in terms of precision and recovery. By contrast, when preferential attachment is the main driving force (θ  >  0.75), Mass clearly outperforms Heat in terms of precision and recovery. This demonstrates that the weight of preferential attachment in the system's evolution is of crucial importance for the choice of the optimal recommendation algorithm. Note that in the model we assume a narrow degree distribution on the user side which is consistent with the country degree distribution distribution shown in which is also far from the scale-free distributions that are commonly found in real social and e-commerce data.