20mm

Hypothesis Proposition Corollary Example Lemma Definition Problem Conjecture

Remark

Almost sure convergence of vertex degree densities in the vertex-splitting model

Introduction

The vertex splitting model is a recent model of randomly growing ordered trees introduced in [\cite=DDJS:2009]. It is a modification of a model of randomly growing trees encountered in the theory of RNA-folding [\cite=RNA]. The parameters of the model are non-negative weights (wi,j)i,j  ≥  0, symmetric in the indices i and j, and the trees are grown randomly in discrete time steps according to the following rules: Let T be an ordered tree, VT its set of vertices and denote the degree of a vertex v by deg (v).

Start with some finite tree T0 at time t0: = |VT0|.

Given a tree T at time t  ≥  t0, select a vertex v in T with probability

[formula]

where

[formula]

Partition the edges which contain v into disjoint sets of adjacent edges: E' of size k - 1 and E'' of size deg (v) - k + 1, with probability [formula].

Remove the vertex v and the edges containing it and insert two new vertices v' and v''. Connect v' by an edge to all vertices u such that uv is an edge in E' and connect v'' to all vertices w such that wv is an edge in E''. Add the edge v'v'' (see Fig [\ref=f:split]).

The numbers (wi)i  ≥  1 defined by [\eqref=splittingweights] are called splitting weights and the numbers (wi,j)i,j  ≥  1 are referred to as partitioning weights. We say that the vertex v which is selected in step (2) is split into the vertices v' and v'' in step (4).

In step (3) of the growth rules, the adjacency of edges is well-defined since the trees are ordered. There are in general many choices of the sets E' and E''. When deg (v) is even and k - 1  =   deg (v) / 2 there are exactly deg (v) / 2 different choices but otherwise there are deg (v) different choices.

We are interested in studying the distribution of vertex degrees in large random trees T grown according to the above rules. More precisely, let nt,k be the number of vertices of degree k in the tree at time t. In [\cite=DDJS:2009] the asymptotics of the expected values [formula] were studied under the following assumptions.

The splitting weights are linear, i.e. satisfy wi  =  ai + b for some real numbers a and b such that wi  ≥  0 for all i  ≥  1.

There is a finite integer [formula] such that wj,k  =  0 if either j or k exceeds [formula] (no vertices of degree greater than [formula] are created in the growth process) and w1,k  =  wk,1 > 0 for all [formula] (it is possible to create vertices of degree [formula] starting from any initial tree). (Corresponds to (1) in Lemma 2.3 in [\cite=DDJS:2009].)

[formula] for some i satisfying [formula] (it is possible to split vertices of degree [formula]). (Corresponds to (2) in Lemma 2.3 in [\cite=DDJS:2009].)

The [formula] matrix B given by the matrix elements

[formula]

is diagonalizable. (Appears in Theorem 2.5 in [\cite=DDJS:2009].)

It was shown that under these assumptions the limits [formula] exist for [formula] and are the unique positive solutions to

[formula]

such that [formula] and [formula]. The last two should be compared to the equations

[formula]

which is (2.7) in [\cite=DDJS:2009].

The condition (A1) is a very convenient technical condition and we will assume that it holds throughout the paper. The reason is that for linear splitting weights, the total weight of selecting a vertex in T only depends on the number of vertices in T, namely

[formula]

by [\eqref=eq:sum].

In this paper we prove stronger results concerning convergence of the random variables nt,k. First of all, we prove almost sure convergence of nt,k / t towards ρk satisfying [\eqref=eq:solution] which immediately implies, by the boundedness of nt,k / t and the dominated convergence theorem, that the expected value converges. Furthermore, we relax some of the conditions (A2)-(A4) stated above as will be mentioned in the statement of the results in Theorem [\ref=thm:as]. In particular we do not require the matrix B to be diagonalizable when [formula] and we obtain partial results when there is no bound on the maximum degree.

Throughout this paper we do not take into account the structural properties of the trees, but only analyze the asymptotic vertex degree densities. This means that the analysis fits into the framework of generalized Pólya urn models. Consider [formula] urns, labelled [formula], initially containing some number of balls. At each time step, draw a ball from urn i with probability proportional to wini, where ni is the number of balls in the i:th urn. Then put two balls back in, one in the k:th urn and one in the (i + 2 - k):th urn, where the pair (k,i + 2 - k) is chosen with probability wk,i + 2 - k / wi. In this framework each vertex of degree i in the vertex splitting tree corresponds to a ball in the i:th urn. The body of literature regarding Pólya urns is large. In particular, whenever [formula], our results follow from [\cite=Janson2004]. In fact stronger results regarding asymptotic joint normality are attainable in this regime, but we do not pursue this matter further. Even though the results of [\cite=Janson2004] holds only for a finite number of urns, sometimes a reduction from a situation from infinitely many urns to a situation with finitely many urns is possible. For the vertex splitting model, such a reduction unfortunately only works for the subclass of splitting trees for which, for all large enough i, the only positive partitioning weights are w1,i + 1,w2,i.

By choosing the splitting and partitioning weights appropriately, the vertex splitting model contains several other known models. For instance, by letting w1,i + 1 be the only positive partitioning weight, we may retrieve the random recursive trees by choosing wi = 1 and the random plane recursive trees by choosing wi = i. These were analyzed in [\cite=Janson2005b] by using the aforementioned connection to generalized Pólya urns.

Without giving complete details, we also extend our results to the setting considered in the motivating paper [\cite=RNA], in which a correspondence between coloured splitting trees and arch deposition models is exploited to analyze the secondary structure of RNA folding. In this case each vertex is coloured either black or white. If a black vertex is chosen, it is recoloured white. If a white vertex is chosen, it splits (similar to the aforementioned 1-coloured case) into two black vertices. By and large the same methods apply, and moreover it turns out that there is a clear correspondence between the 1-coloured version and the 2-coloured version.

Main results

In the following we let [formula] be a positive integer or infinite. If [formula] we will assume that initially no vertex has degree [formula] and that Condition (A2) above is satisfied. Let [formula]. For each k such that [formula], define the sequence (a(j)k)j  ≥  0 as follows. For k = 1 let

[formula]

and when [formula] let

[formula]

The main result of the paper is the following.

Suppose that [formula]. Then for each k such that [formula] the following limits exist and it holds almost surely that

[formula]

and [formula] is a positive solution to

[formula]

satisfying

[formula]

When [formula] the solution is unique.

We note that Theorem [\ref=thm:as] requires fewer assumptions than those in (A1)-(A4). However, we have not provided conditions which guarantee that (ak)∞k = 1 is a unique positive solution to [\eqref=eq:ask] satisfying [\eqref=eq:sums].Whenever [formula] however, uniqueness is guaranteed since the condition that [formula] is equivalent to Condition (A2) above which guarantees that [\eqref=eq:solution] has rank at least [formula]. Equations [\eqref=eq:sums] fix the remaining constant. In the case [formula] we do not know how to prove that the system has a unique solution, but we comment on some special examples in the next section.

The case [formula] is implicitly covered by the case [formula] by assuming that there is some i for which w1,i + 1 = 0. This allows for the identification of three regimes as follows.

There is some i  ≥  1 such that w1,i + 1 = 0.

There is no i  ≥  1 such that w1,i + 1 = 0, and [formula].

It holds that [formula].

Theorem [\ref=thm:as] deals with Case I and III, but we do not know how to extend these results to case II. The assumption [formula] in some sense ensures that the probability of performing the split i  ↦  (1,i + 1) does not become too small as i grows large.

The rest of the paper is outlined as follows. In Section 2 we give some examples of the case [formula] to which Theorem [\ref=thm:as] is applicable and where uniqueness of the solution to [\eqref=eq:ask]-[\eqref=eq:sums] is proved. The proof of Theorem [\ref=thm:as] along with some technical results is presented in Section 3. Finally, in Section 4 we sketch similar results for a two-coloured vertex splitting model that was originally considered in [\cite=RNA].

Examples

Before we turn to the proof of Theorem [\ref=thm:as], we consider some explicit examples that can be analysed using Theorem [\ref=thm:as]. Throughout we assume that wi = ai + b where ai + b > 0 for all [formula]. If a  ≠  0, it is easy to see that the growth rules defined in the introduction are not changed if we take wi = i + x with x = b / a, so for notational convenience we will sometimes use this definition instead, unless we are interested in the case of constant splitting weights.

We will focus on the case where there is no bound on the vertex degrees since the case when [formula] is already covered. In general we cannot show that the system of equations in Theorem [\ref=thm:as] has a unique solution. However, in some specific cases this is possible, and we present some of these here.

Preferential attachment

Preferential attachment-type models are obtained by attaching new edges to existing vertices, where the vertex is chosen with probability proportional to the vertex degree. In the vertex-splitting model with [formula], this is obtained by setting all partitioning weights to zero, except for [formula] for all i  ≥  1. The conditions of Theorem [\ref=thm:as] are satisfied, so the limiting degree distribution (ai)∞i = 1 satisfies the equations

[formula]

The relations [formula] and [formula] imply that [formula], so [formula]. Then, iterating ([\ref=eq:prefattk]) we find that

[formula]

for all k  ≥  1. It is not difficult to analyse the asymptotics of the sequence (ak)∞k = 1. One can show that when a  ≠  0

[formula]

by using standard asymptotics for the Gamma function.

If wi = i, then the preferential attachment model is equivalent to the model of random plane recursive trees. In this case the exact solution is given by

[formula]

This was originally proved by Móri [\cite=MoriRandomTrees] using martingale methods. He also achieved results on joint normality of the degree densities. The case wi = 1 is equivalent to the case of random recursive trees; the exact solution being

[formula]

in this case. Using the connection to generalized Pólya urns mentioned in the introduction, Janson [\cite=Janson2005b] proved stronger results that imply the almost sure convergence to the densities in [\eqref=eq:pa1] and [\eqref=eq:pa2].

Uniform partitioning weights

Let wi = i + x, where x >  - 1. In [\cite=DDJS:2009], the expected degree densities were studied in the case of uniform partitioning weights, i.e.

[formula]

The methods in [\cite=DDJS:2009] were non-rigorous in this case but the results were correct as we confirm here. By Theorem [\ref=thm:as] the asymptotic vertex degree densities (ai)∞i = 1 satisfy

[formula]

Subtracting the k:th equation from the (k + 1):st yields the recursion

[formula]

where we have defined a0 = 0. The solution is given by

[formula]

where

[formula]

and [formula] is the modified Bessel function of the first kind. In particular, for x = 0, i.e. splitting weights wk = k, we have

[formula]

It is easy to see that the obtained solutions are in fact unique. Namely, from [\eqref=eq:unif1] one can inductively determine constants [formula] such that ak = Cka1 for all k  ≥  1. The condition [formula] determines a1 uniquely as a function of these constants.

If the splitting weights are constant, i.e. wi = b for some b > 0, then the solution to [\eqref=eq:unif1] is given by

[formula]

However, in this case iw1,i + 1 = O(i- 1), so the conditions of Theorem [\ref=thm:as] are not satisfied. This falls into Case II identified in Remark [\ref=rem:rem1], so it does not follow by our results that these are also the almost sure limiting vertex densities.

An infinite class

Our next example provides an infinite class of splitting trees for which a unique solution to the system of equations is attainable. It includes the preferential attachment model and more generally a model of trees which grow by attachment and grafting, studied in [\cite=Siggi2012] (see below).

Let (αi)∞i = 1 be a sequence in (0,1], such that inf i  ≥  1wiαi  >  0. Suppose there exists some M  ≥  2 such that iw1,i + 1  =  αiwi, iw2,i = (1 - αi)wi for all i  ≥  M with the exception that w2,2  =  (1 - α2)w2 when M = 2.

The conditions of Theorem [\ref=thm:as] are satisfied. In particular, for k > M the asymptotic degree sequence satisfies

[formula]

which is similar to the expressions in Section [\ref=sec:prefatt]. Iterating we find

[formula]

for all k > M.

For any 1  ≤  k  ≤  M

[formula]

where the final sum is zero unless k = 1 or k = 2. For instance, choosing k = M yields

[formula]

so we can determine CM - 1 so that aM - 1 = CM - 1aM. Continue inductively to find a sequence (Ci)M - 1i = 1 such that ak = CkaM for 1  ≤  k < M. In the case k = 1 and k = 2 one gets a system of two equations involving a1 and a2 which may easily be seen to have a unique solution which is a multiple of aM. Now, the condition [formula] means that [formula], so [formula], where we have put CM = 1 for consistency. But this allows us to uniquely determine the entire sequence (ak)∞k = 1.

An example of a family of weights which belongs to the above class appears in [\cite=Siggi2012] (with a minor modification in the dynamics which does not affect the limiting densities). The weights in [\cite=Siggi2012] are defined in terms of two parameters α,γ∈[0,1] by

[formula]

and by choosing M = 2 and [formula] for all i  ≥  M. Note that when α  =  0 this is the preferential attachment model. In [\cite=Siggi2012] the solution to [\eqref=eq:ask] when 0 < γ < 1 was found to be

[formula]

and for γ  =  1

[formula]

The results agree with [\eqref=eq:pa0] and [\eqref=eq:pa2] when α  =  0 (preferential attachment). There was no proof in [\cite=Siggi2012] that these solutions are the limiting degree densities but our Theorem [\ref=thm:as] along with the uniqueness of the solution confirms that they are the almost sure limit. In the case 0 < γ < 1, standard asymptotics of the Gamma function yield the power law

[formula]

and when γ  =  1 the densities decay exponentially with rate (1 - α) / (2 - α).

Proof of Theorem [\ref=thm:as]

We now turn to the proof of Theorem [\ref=thm:as]. To simplify notation, we deal only with the case [formula], the discussion being even simpler when [formula] is finite. First we state a key lemma, that appears in slightly more general form in [\cite=BackhauszMoriLemma].

Let (Ft)∞t = 0 be a filtration. Let (ξt)∞t = 0 be a non-negative process adapted to (Ft)∞t = 0, and let (ut)∞t = 1,(vt)∞t = 1 be non-negative predictable processes such that ut < t for all t  ≥  1 and lim t  →    ∞ut  =  u > 0 exists almost surely. Let w be a positive constant. Suppose that there exists δ > 0 such that [formula]. If

[formula]

for some constant v  ≥  0 and

[formula]

then

[formula]

We use Lemma [\ref=lem:backhauszmori] to prove the following lemma. This essentially follows the approach taken in the papers [\cite=BackhauszMori] [\cite=Thornblad2015]. We note here that the s-term present below does not appear in Theorem [\ref=thm:as] since we shall later prove that [formula], but this is a priori not known.

Suppose that s: =  inf {iw1,i  +  1 : i  ≥  1} > 0. Then lim j  →    ∞a(j)k = :ak exist for each k, (ak)k  ≥  1 is a positive bounded sequence satisfying

[formula]

and [formula] holds almost surely,

Let us first state the idea behind the proof of Lemma [\ref=thm:liminf]. To ease notation we define [formula] for each k  ≥  1.

For each k  ≥  1, show by induction that a(j)k  ≤  Ak for all j  ≥  0.

Prove that (a(j)k)∞j = 1 is monotonically increasing (in j) for each k. Since each such sequence lies in the bounded set

[formula]

Recall the definition of the total weight Wt in [\eqref=eq:wt]. The following expressions for the expected number of vertices of degree k, conditional on the tree at the previous time step, easily follow from the growth rules. For k = 1 we have that

[formula]

In the last line we used the fact that [formula].

For k  ≥  2 we have that

[formula]

We shall use the above analysis along with Lemma [\ref=lem:backhauszmori]. By induction we prove that a(j)k  ≤  Ak for all j  ≥  0. For j = 0 we clearly have a(0)k = 0  ≤  Ak. Suppose that a(j)k  ≤  Ak for some j and for all k  ≥  1. We prove first that a(j + 1)1  ≤  A1. For this, define the following variables:

[formula]

We note that (ut)∞t = 1 and (vt)∞t = 1 are positive predictable sequences and that ξt is non-negative and adapted. Furthermore, we have that [formula]. The condition ut < t in Lemma [\ref=lem:backhauszmori] is satisfied for large enough t, which is enough. In fact, the initial starting tree is irrelevant, so if ut0  ≥  t0, one can grow the tree and wait until ut < t occurs, at which point Lemma [\ref=lem:backhauszmori] can be applied. Recall that s =  inf {iw1,i + 1 : i  ≥  1}. Using Fatou's lemma and the induction hypothesis we find that

[formula]

Applying Lemma [\ref=lem:backhauszmori] we find that

[formula]

For k  ≥  2 define the following variables:

[formula]

We note that (ut)∞t = 1 and (vt)∞t = 1 are positive predictable sequences and that ξt is non-negative and adapted. Furthermore, we have that [formula]. We now apply Fatou's lemma and use the induction hypothesis and find that

[formula]

Applying Lemma [\ref=lem:backhauszmori] we find that

[formula]

We note finally that the technical condition [formula] is satisfied for all k  ≥  1. Indeed, the conditional expectation [formula] is bounded above by 4. This completes the Step 1, i.e. we have showed that a(j)k  ≤  Ak for all j  ≥  0 and all k  ≥  1.

We now prove that for each k  ≥  1, the sequence (a(j)k)∞j = 0 is increasing. We use an inductive argument. By construction we have that [formula]. Suppose that the statement is true for some j. Recall that s: =  inf {iw1,i  +  1 : i  ≥  1} > 0, so in particular iw1,i + 1 - s  ≥  0 for all i  ≥  1. Then

[formula]

This proves that the sequence (a(j)k)∞j = 0 is increasing for k = 1. The proof for k  ≥  2 is similar and we omit this.

For each k  ≥  1 we thus have that the sequence (a(j)k)∞j = 0 is an increasing sequence. It is bounded above by Ak  ≤  1, so each such sequence must be convergent and we have the existence of a limit

[formula]

By taking limits in ([\ref=eq:seq10]-[\ref=eq:seqkj]) we find that

[formula]

and for each k  ≥  2

[formula]

Interchanging limits and summation is justified since all terms are positive. Using w1 = w1,2, it is now easy to see that ([\ref=eq:lim1j]) is equivalent to

[formula]

This completes the proof.

Next we show that the sequence (ak)∞k = 1, constructed in Lemma [\ref=thm:liminf], defines a probability distribution. After this we prove Theorem [\ref=thm:as]. First we prove the following lemma, which is in the spirit of Lemma 2.3 in [\cite=DDJS:2009]

The sequence (ak)∞k = 1 satisfies [formula] and [formula].

Recall from Lemma [\ref=thm:liminf] that for each j and k, [formula]. Thus, for each j,

[formula]

by Fatou's lemma and ([\ref=eq:sum]). Similarly, for each j, [formula]. Letting j  →    ∞   it follows from monotonicity of a(j)k that the following series are convergent and satisfy

[formula]

Summing ([\ref=eq:liminf1]) and ([\ref=eq:liminfk]) over [formula] we find that

[formula]

Similarly, multiplying the k:th equation by k and summing over [formula] we find by swapping sums and using

[formula]

that

[formula]

which yields, with some simple rewriting

[formula]

The limit, as N  →    ∞  , of the left hand side exists by [\eqref=eq:convsums] and thus the limit of the right hand side exists, denote it by

[formula]

Then

[formula]

Finally, let [formula] and [formula]. Putting wk = ak + b in [\eqref=eq:A] and [\eqref=eq:B] we obtain the linear system of equations

[formula]

having solutions

[formula]

Since [formula], a  ≥  0 and thus by [\eqref=eq:convsums] it necessarily holds that x  ≤  0. If x < 0 then there is an M such that for all N  ≥  M, NwNaN  >   - x / 2. Therefore

[formula]

which contradicts [\eqref=eq:convsums]. Thus x = 0 which gives A = 1 and B = 2, as desired.

Already knowing that [formula], the idea is to prove that [formula] for all k  ≥  1. By Lemma [\ref=lem:eigeneqs] we have that [formula]. By definition it holds that [formula]. The following calculation is routine and only uses Fatou's lemma and well-known facts about the limit inferior and limit superior. For any k  ≥  1 we have that

[formula]

Thus, by the above along with Lemma [\ref=thm:liminf]

[formula]

almost surely for all k  ≥  1. This implies that for all k  ≥  1

[formula]

almost surely. Finally, Equations [\eqref=eq:ask] and [\eqref=eq:sums] follow from Lemma [\ref=thm:liminf] and Lemma [\ref=lem:eigeneqs].

An extension to two colours

As mentioned in the introduction, the motivation of this study originally comes from [\cite=RNA], wherein a two-coloured version of the vertex splitting tree was considered. In this model, each vertex in the tree is coloured either white or black, the number of black and white vertices of degree i at time t denoted by [formula] and [formula] respectively. The parameters of the model are the splitting weights [formula] and symmetric partitioning weights [formula], satisfying [formula]. Start at time t = 2 with a single edge with both its endpoints black. At each time step, the tree evolves as follows.

Select a vertex v in the tree with probability proportional to [formula] if v is white, and [formula] if v is black.

If v is black, make it white. If v is white, partition its edges into two disjoint sets of adjacent edges E' of size k - 1 and E'' of size deg (v) - k + 1 with probability [formula]. Remove the vertex v and its incident edges. Insert two new black vertices v' and v'', such that v' is connected to all vertices u such that uv is an edge in E', and v'' is connected to all vertices w such that wv is an edge in E''. Add the edge v'v''.

The paper [\cite=RNA] considered only the case corresponding to splitting weights [formula] and [formula] (no bound on vertex degrees) and uniform partitioning weights

[formula]

In this case the model is equivalent to a model of random RNA folding, see [\cite=RNA] where the correspondence is explained in detail. Under the assumption that the limit exists, the authors in [\cite=RNA] found that

[formula]

for all k  ≥  1. We consider a wider class of splitting weights and partitioning weights and are able to prove an analogue of Theorem [\ref=thm:as] replacing [formula] and [formula] with [formula] and [formula] respectively and proving almost sure convergence. Thus we confirm, strengthen and generalize the above results from [\cite=RNA].

Let [formula] and [formula]. This choice ensures that the total weight grows linearly, i.e.

[formula]

which can be showed by induction. Moreover, up to a multiplicative constant this is the unique choice of splitting weights resulting in linear growth for the total weight. Note also that [formula]. It is also possible to show that

[formula]

Equations [\eqref=eq:totweight] and [\eqref=eq:2totweight] correspond to [\eqref=eq:sum].

In the following theorem, the sequences [formula] and [formula] are constructed like the sequence (ak)∞k = 1 in Theorem [\ref=thm:as], but we leave the exact details to the reader.

Suppose that [formula]. Then there exist two non-negative sequences [formula] and [formula] such that

[formula]

satisfying

[formula]

for all [formula]. Moreover [formula] and [formula].

Note that the quantities [formula] and [formula] are not degree densities any more, since the tree does not grow whenever a black vertex is selected. The actual asymptotic degree densities are given by

[formula]

and

[formula]

The proof of Theorem [\ref=thm:as2] is similar to that of Theorem [\ref=thm:as], so we omit this. Instead we mention another result that relates the densities of any two-coloured process to a one-coloured process. Note however that this depends crucially on knowing that the solutions to the equations in Theorems [\ref=thm:as] and [\ref=thm:as2] are unique, something we do not know in general. If this is known, the rest of the proof is straightforward and is omitted - it amounts to showing that the appropriate conditions and equations in Theorem [\ref=thm:as] and Theorem [\ref=thm:as2] are satisfied.

Let [formula] and [formula] be the splitting weights for the 2-colour model. Let [formula] be the partitioning weights. Define a 1-colour process with splitting weights [formula] and partitioning weights [formula]. Let [formula] and [formula] be the degree densities of the 2-colour model, and let ai be the degree densities of the 1-colour model. If these are unique as solutions to the systems in Theorem [\ref=thm:as] and Theorem [\ref=thm:as2] respectively, then

[formula]

for all [formula].

Let us illustrate Proposition [\ref=prop:1rel2] by considering uniform partitioning weights in the the one-coloured and two-coloured cases, respectively. Indeed, this was the case considered in [\cite=RNA] and mentioned at the beginning of the section. In any case, it can be shown that

[formula]

so the asymptotic vertex densities are given by

[formula]

Now, if we follow the notation in Proposition [\ref=prop:1rel2] we obtain a one-coloured process, which is precisely the uniform splitting model considered in Section [\ref=sec:uniform], with weights wk = k and partitioning weights

[formula]

Recall [\eqref=eq:unif2], i.e. that the limiting vertex densities in this case were

[formula]

In this particular case one verifies that

[formula]

as predicted by Proposition [\ref=prop:1rel2].