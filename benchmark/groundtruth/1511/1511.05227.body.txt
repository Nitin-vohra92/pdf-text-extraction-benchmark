Parameter identifiability and identifiable combinations in generalized Hodgkin-Huxley models

Introduction

Since its introduction in 1952, the Hodgkin and Huxley (HH) model for membrane excitability in the squid giant axon has become one of the most commonly used formalisms in mathematical neuroscience, with citations now numbering in the tens of thousands [\cite=HH1952] [\cite=HH1952b]. By partitioning membrane voltage change into currents caused by the flow of distinct ions, Hodgkin and Huxley created an illuminating characterization of the underlying cause of axon potentials. In the model, each ionic current is gated by channels, and the probability of the channels being open or closed is voltage-dependent. The original model assumes these gates operate independently, and, while subsequent work has shown this not to be the case, HH nonetheless provides a good description of ionic behavior at the appropriate scale and remains highly relevant in the literature today. Consequently, much work has been dedicated to parameter estimation for the HH equations [\cite=Buhry2011] [\cite=Lee2006] [\cite=Csercsik2010] [\cite=Willms1999] [\cite=Fink2009] [\cite=Willms2002] [\cite=Hafner1981] [\cite=Vavoulis2012].

Most treatments of HH parameter estimation have tackled the problem with a focus on practicality--estimating parameters given noisy and limited data. However, there has been relatively little examination [\cite=Csercsik2010] of the more basic but essential question of structural identifiability: given perfect, noise-free data, can the parameters in the model be uniquely determined? While such perfect data is of course unrealistic, structural identifiability is a prerequisite for practical identifiability and successful parameter estimation. Furthermore, such structural identifiability information can be used to generate insights into ways to reduce the model to improve identifiability, or to guide collection of new data that will allow all parameters to be estimated. Thus, understanding the structural identifiability properties of the HH model provides an important foundation in efforts to connect HH-based models with data.

Here, we examine the identifiability of a broad class of generalized HH-type models. We elucidate the identifiable combination structure for this class of models, evaluate the role of initial conditions in identifiability, and consider what additional data is needed to ensure identifiability. Additionally, we show that the proof of identifiability of the time-constants for the gating variables allows us to develop a novel practical estimation approach for general HH-type models.

Methods

Generalized Hodgkin-Huxley Models

The HH equations for ionic current can be generalized for pn ion channel gates of type n acting independently as

[formula]

where g is the conductance associated with the ion channel, V is the voltage of the cell, E is the reversal potential of the ion, and the mi terms represent the probability of a voltage-controlled gate being open. Each of the mi is further taken to satisfy the differential equation

[formula]

in which mi,  ∞(V) is the steady-state probability of the gate being open when the voltage is held at V and τi(V) is the time-constant for the kinetics of the gate's activation or inactivation at that same voltage. In cases similar to the classical HH model, where only two types of gate appear, the conventional notation mp1hp2 may be used instead of mp11mp22.

While the HH model represents a heavily approximated version of ionic channel dynamics (assuming all ion channels are independent, ignoring changes in reversal potential due to ion flow), its ability to reproduce action potentials and other properties of cell electrophysiology have led to it remaining highly relevant over the six decades since its publication.

Typically, the voltage-dependent parameters, mi,  ∞ and τi, are estimated from voltage clamp experiments. In a voltage clamp, a feedback loop is used to hold voltage at a constant value, and the current required to maintain this constant voltage (theoretically, exactly cancelling the ionic currents) is recorded. Individual currents are isolated, either by blocking all other ionic currents, or by subtracting traces where the current in question is blocked from those where nothing is blocked. Once found, the values for mi,  ∞ and τi across all the fixed voltages are considered together and fit so that the two parameters are then described by functions of voltage, mi,  ∞(V) and τi(V). These functions often follow standard forms, e.g. Boltzmann equations, although these are not necessarily completely physically accurate [\cite=Willms1999].

Much other work has concerned the process of parameter estimation for HH-type models [\cite=Buhry2011], but only a few sources have addressed the issue of identifiability. In [\cite=Csercsik2010], the identifiability of the parameters {g,m1,  ∞,m2,  ∞} was evaluated in currents of the form I(t)  =  g  mp11mp22(V - E). Csercsik and colleagues show that these parameters are unidentifiable, and moreover, no pair of them is identifiable, although the precise form of any identifiable combinations is not determined. Here, we repeat and extend that analysis in the generalized case for an arbitrary number of gates, using a scaling argument, and then additionally show that the time constants τi are identifiable. We also examine the identifiability of powers pi in the 'two independent gates'-type scenario, and evaluate how knowledge of the initial conditions of the gating variables alters the identifiability structure of the model.

Identifiability and differential algebra

Identifiability addresses the question of whether the a given set of parameters can be uniquely estimated for a given model and data. Structural identifiability addresses this question in the case where we assume 'perfect,' noise-free data (i.e. complete knowledge of the measured variables for all time points). While this represents an unrealistic best-case scenario, it forms a necessary condition for estimation from real, noisy data, and indeed structural unidentifiability is quite common among mechanistic models [\cite=Audoly2001] [\cite=Meshkat2009] [\cite=Eisenberg2013]. The importance of identifiability and its place as a necessary precursor to fitting data are discussed further in [\cite=Csercsik2010] [\cite=Eisenberg2013] [\cite=miao2011].

Methods for determining structural identifiability have been developed in detail elsewhere [\cite=Audoly2001] [\cite=Meshkat2009] [\cite=Eisenberg2013] [\cite=Bellu2007] [\cite=Bellman1970] [\cite=Chapman2009] [\cite=Cobelli1980], so we provide only brief overview here. Consider a model of the form:

[formula]

[formula]

where [formula] represents the (vector of) parameters, [formula] is the unobserved state variable vector, (t) are the known experimental input(s) into the system, if any, and (t) represents the observed (measured) output (s). We also let 0 represent the vector of initial conditions for (t). A model is said to be identifiable if [formula] can be recovered uniquely from [formula] and [formula]. Because there may be particular or degenerate parameter values and initial conditions for which an otherwise identifiable model is unidentifiable (e.g. initial conditions starting at a constant steady state), structural identifiability is often defined for almost all parameter values and initial conditions [\cite=Meshkat2009] [\cite=Audoly2001] [\cite=Saccomani2003]:

For a given ODE model [formula] and output [formula], an individual parameter p is uniquely (globally) structurally identifiable if for almost every value * and almost all initial conditions, the equation (,t,*)  =  (,t,) implies p  =  p*. A parameter p is said to be non-uniquely (locally) structurally identifiable if for almost any * and almost all initial conditions, the equation (,t,*)  =  (,t,) implies that p has a finite number of solutions.

Similarly, a model [formula] is said to be uniquely (respectively non-uniquely) structurally identifiable for a given choice of output [formula] if every parameter is uniquely (respectively non-uniquely) structurally identifiable, i.e. the equation (,t,*)  =  (,t,) has only one solution,   =  p* (respectively finitely many solutions).

There are a number of approaches to determining identifiability; here, we use the differential algebra approach [\cite=Ollivier1990] [\cite=Audoly2001] [\cite=Eisenberg2013] which is briefly summarized as follows. For models with f and g rational, construct the [formula] equations from the state variable equations and the output equations. Input-output equations are monic differential polynomials in the input and output variables and their derivatives with rational coefficients in the parameter vector [formula] (i.e. with the state variables [formula] and all of their derivatives eliminated from the equations). These can be generated in many ways, including using Ritt's pseudo division or Groebner bases, among others [\cite=Ollivier1990] [\cite=Audoly2001] [\cite=meshkat2012alternative] [\cite=Eisenberg2013] [\cite=bearup2013input] [\cite=Cobelli1980]. The coefficients (rational in [formula]) of the input-output equations are identifiable, and the structural identifiability of the model (i.e. injectivity of the map from parameters to output), can then be tested simply by checking injectivity of the map from the parameters to the coefficients.

As a simple example for illustrative purposes, we consider the HH model given in Eqs. [\eqref=eq:current] and [\eqref=eq:gates] in the minimal case where n = p1 = 1. Then solving for m1 from Eq. [\eqref=eq:current] yields:

[formula]

Plugging this into Eq. [\eqref=eq:gates] yields

[formula]

To make this equation monic, we simply clear the coefficient for [formula], yielding our input-output equation:

[formula]

The coefficients of the input-output equation are identifiable, so that we see that τi is an identifiable parameter, while g  m1,  ∞ forms an identifiable combination with neither parameter identifiable individually.

Results and Discussion

Generalized Hodgkin-Huxley equation identifiability

As stated above, we consider the identifiability of a generalized form of Hodgkin-Huxley equations, given in Eqs. [\eqref=eq:current] and [\eqref=eq:gates]. Unless otherwise stated, we assume we are fitting a single voltage clamp trace and therefore that V is fixed and known. Our output is thus given by y  =  I(t). Voltage steps in clamp experiments typically are preceded by a period of time in which the voltage is held fixed at a holding potential, Vhold, consistent across all trials; when this value is used, it will always be distinguished from the step value V. Typically, the reversal potential Eion is readily determined through experimental means [\cite=HH1952] [\cite=HH1952b] while the other parameters (the mi, τi, and g) are estimated from the data.

m∞ combinations and non-identifiability

The authors of [\cite=Csercsik2010] show that for the two-gate HH model, I(t)  =  g  mp1hp2(V - E), no pair from {g,m∞,h∞} is identifiable. It is possible to show the same is true in the generalized case with a simple scaling argument, much like what appears as an example in [\cite=Eisenberg2013].

The conductance term g and the steady-state parameters mi,  ∞ are not identifiable from voltage clamp data. Nor is the product of any strict subset of g and the mi,  ∞; however, the product [formula] is an identifiable combination.

From Eq. [\eqref=eq:current] for ionic current,

[formula]

observe that we can rescale m1 by [formula] to get gmp11  =  p11 and [formula]. This new expression for the ionic current has the same identifiability and input-output structure as the previous one except the conductance term does not appear; hence g is not an identifiable parameter (as g can take on any value and yield the same output given the same input, by adjusting the value of m1,  ∞).

The argument for the steady-state parameters proceeds similarly. Assuming no steady-state parameter is exactly zero, rescale mi for [formula] by [formula] so that zi  =  mi / mi,  ∞. Then

[formula]

Next, rescale mn so that [formula], so that

[formula]

and

[formula]

for [formula] while

[formula]

Again the identifiability structure is unchanged, but the steady-state parameters appear only once, grouped into a single term: [formula]. The individual steady-state parameters are thus not identifiable, nor is the product of any strict subset of the steady-state parameters and conductance term. Their full product with g is identifiable because

[formula]

which, under the assumption of perfect data, is known.

To illustrate this issue, Figure [\ref=fig:unid]A shows two simulated sodium-type current traces, with gating variables of the form m3h, which are identical despite different m∞ and h∞ values; a similar example is included in [\cite=Csercsik2010].

τ identifiability

While the undentifiability of the steady-state parameters can be ascertained through scaling, to show the identifiability of the time constants using results from differential algebra requires a slightly more technical analysis.

The time constants for the gating variable kinetics, τi, are identifiable from voltage clamp data.

We start by considering the case where pi  =  1 for all i. Rescale the current trace by the steady state value [formula]. This value, while possibly very small, is non-zero. Next, let mi / mi,  ∞  =  zi as previously and denote the rescaled current by Î(t)  =  I(t) / I∞. Make the substitution [formula] to rewrite this current as

[formula]

Expanding this product gives:

[formula]

Since [formula], we can write down successive derivatives of I(t) as:

[formula]

From the first 2n - 1 derivatives of Î(t), we can write down the system:

[formula]

where Ĩ  =  Î(t) - 1 and the λi's represent a sequential indexing of the possible [formula] quantities with [formula] for [formula] and

[formula]

Denote this Vandermonde matrix by V and this system as Vx  =  y, with

[formula]

The 'λ'-Vandermonde matrix is invertible as long as λi  ≠  λj, which occurs with probability 1, so x  =  V- 1y (with ith entry denoted xi). We can next observe that

[formula]

Since all xi can be written as a linear combination of the derivatives of Î(t), the equation [formula] gives a polynomial in Î(t) and its derivatives with coefficients in the parameters: an input-output equation.

Furthermore, the coefficients of the monomials of the form Î(k)(t) (or Ĩ, "singletons") are the entries of the last row of the inverse Vandermonde matrix. Note that the entries of the last row are also the coefficients ak of the polynomial [formula], the 2n - 2 roots of which are [formula] (λ2n - 1 can be recovered by summing over all the roots and dividing by 2n - 1). These roots are invariant under scalings of the coefficients; hence, by finding the roots of the polynomial with coefficients taken from these monomials, we can recover the set of τi from them. This implies that the τis are identifiable parameters.

It remains to consider the case where pi is not necessarily 1. Let [formula], and note that we can use a (2N  -  1)-by-(2N  -  1) Vandermonde matrix in writing a linear system Vx  =  y similar to the one above, with the key difference being that now certain λ are equal. V in this case will not be invertible; however, by eliminating the repeated columns and collapsing all duplicate entries of x into single entries (e.g. Replacing [formula] with [formula] ), we can rewrite the system so that V is (2N  -  1)-by-p, x is p-by-1, and y is (2N  -  1)-by-1, where p is a quantity that emerges from the partitioning of N into pi. Removing rows of V until it is square (while preserving the first n and last rows), we can construct an input-output equation by equating entries of x in the same way as before, and the coefficients of singleton monomials will also be the coefficients of a polynomial with zeros equal to [formula].

Hence, the time constants are identifiable, even in the generalized case discussed here. This proof can also provide a way to estimate the time constants from experimental data, discussed further below.

Power identifiability

For a classical two-gate Hodgkin-Huxley model of the form I  =  g(V  -  E)mp11mp22, the powers p1 and p2 are identifiable.

This can be shown by considering successive derivatives of log (I(t)), specifically f(t)  =  I'(t) / I(t), f'(t), and f''(t). Computing f and its derivatives and replacing mi''(t) with - mi'(t) / τi yields expressions in terms of the parameters pi and τi and the ratio of state variables mi'(t) / mi(t). Replacing these ratios with a  =  m1'(t) / m1(t) and b  =  m2'(t) / m2(t) gives the following:

[formula]

[formula]

[formula]

Using Mathematica to eliminate the variables a and b through a Groebner basis computation yields an input-output equation, the coefficients of which readily imply the identifiability of p1 and p2. We conjecture that a similar result holds for the generalized case, however the growth of this Groebner basis calculation's complexity with n has made this somewhat intractable so far.

Consideration of initial conditions

Thus far we have assumed no knowledge of the initial conditions of the model (although initial conditions for the output I(t) and its derivatives are assumed known as I(t) is measured perfectly for all times). In this case, the additional information provided by knowledge of the initial conditions changes the identifiability structure of the problem.

If initial conditions for the gating variables mi,0: = mi(0) are known, the steady state parameters at a fixed voltage, mi,  ∞(V), are identifiable from voltage clamp data.

As before, scale the original current trace I(t) by [formula] to get [formula]. The only parameters in this scaled model are the (identifiable) τi values, so by Theorem 2.2 the model is itself identifiable. We can solve for the initial conditions of the scaled model using the explicit solution i(t)  =  1  -  (1  -  i,0) exp ( - t / τi). Once found, the scaled initial conditions can be divided into the unscaled initial conditions, yielding the steady state parameters mi,  ∞(V).

Identifiable combinations in terms of initial conditions

Given the lack of identifiability for HH models unless the gating variable initial conditions are known, a natural question arises in whether consideration of the initial conditions--even when unknown--might yield additional identifiable combinations. Moreover, when practically fitting the model, the initial conditions of the gating variables would need to be considered.

The pairs mi,0 / mi,  ∞ are identifiable combinations given voltage clamp data.

Replacing the mi in Eq. [\eqref=eq:current] with their explicit solutions and factoring yields

[formula]

Dividing the current trace by its steady-state value therefore gives us

[formula]

in which the ratios mi,0 / mi,  ∞ are identifiable, along the with τi's.

We note that this proof also shows that the initial conditions for the gating variables are identifiable for the scaled model considered in the proof of Theorem [\ref=th:unid], wherein we scaled all mi by their steady state values (as in this case, the steady state values are precisely the mi,0 / mi,  ∞).

In applying these results to experimental data, we also note that it is reasonable to assume that the initial conditions of the gating variables mi,0 are the same for all experimental voltage steps V because of the pre-step fixed holding potential Vhold. As a result, the shape of the mi,  ∞(V) curve up to scaling by the constant mi,0 can be found from the data in this way, and a concrete value of mi,0 can be chosen so that [formula]. If the curve isn't smooth at a certain value of V, it is possible that mi,0 differed from the other trials at that point (e.g. the system may not have fully equilibrated before the next clamp experiment was run).

Applications

Rescaling the Sim-Forger model

To demonstrate the unidentifiability and identifiable combinations determined in Theorem [\ref=th:ICcombos] using an HH-model applied in practice, we consider the Sim-Forger model of a suprachiasmatic nucleus (SCN) neuron [\cite=sim2007modeling]. Extensions of this model have used the HH model to gain insight into the underlying mechanisms of timekeeping in the SCN [\cite=Belle2009] [\cite=Diekman2013]. The non-uniqueness of the steady-state parameters when the initial conditions are not known allows us to generate the same output from two different Hodgkin-Huxley style models using two different sets of initial conditions. The sodium current equation in this model is given by: INa  =  gNa(V - ENa)m3h. The steady-state parameters m∞ and h∞ are given by the equations

[formula]

[formula]

with initial conditions m0  =  0.34 and h0  =  0.045. If we rescale so that ∞  =  am∞, [formula], 0  =  0.34a and [formula], the model will produce identical output for a  ≠  0. This is shown in Figure [\ref=fig:unid]B, where the solid line shows the output for a = 1 while the open circles shows the same output for a  =  2. The two traces are identical.

Fitting the time constants through a least squares approach

Finally, while the proof of time constant identifiability in Theorem [\ref=th:tau] does not immediately appear useful for parameter estimation, we next illustrate how the input-output equations obtained in the proof of Theorem [\ref=th:tau] can be used to estimate the identifiable τi's. We demonstrate this using the two-gate HH model, with each gate appearing once: I  =  g(V - E)mh. We generated simulated voltage clamp data, I(t) (with a timestep of 0.1 milliseconds), and the first and second derivatives (I',I'') were estimated numerically from the data in MATLAB (from the slope of the line between first two data points).

The resulting current trace and its derivatives were concatenated into a T-by-9 matrix, where T is the number of time points composing I and 9 is the number of distinct monomials in (I - 1), I', and I'', of maximum degree two:

[formula]

These monomials should form an input-output equation with the appropriate coefficients; hence, the vector x making up the null space of A will give us these coefficients.

To ensure that A has a null space, we took its singular value decomposition and made the least singular value equal to zero. This corrected for any errors in the derivative computation and enforced the rank deficiency requirement. We then solved for x from Ax  =  0. From the theorem proving the identifiability of the time constants, the first three entries of x should be the coefficients of the degree 2 polynomial with roots - 1 / τm and - 1 / τh. We then found the roots of this polynomial using the aptly-named MATLAB function 'roots'.

Indeed, the roots did agree with the prescribed time constants. For preset τh  =  4 and τm  =  22, the time constants recovered in this way were τh  =  3.9928 and τm  =  22.0072. While noise will likely confound this process in real data, it nonetheless provides an interesting and novel way of fitting HH-style equations. As the other identifiability results predict, the steady-state parameters do not need to be known to estimate the time-constants. In addition, no initial guess of where the time constants lie in parameter space is needed to arrive at this estimate. Thus, even given the issues that may come with estimating the derivatives of I(t) in the presence of noise, this approach may also be a useful way to obtain initial estimates of the τi's which are 'in the ballpark', and then more conventional optimization approaches can be used.

Conclusions

In this work, we have shown that the time constants for the gating variables of a generalized HH-type model are identifiable, while the steady-state parameters are not--unless initial conditions are known. In the case where the initial conditions for the gating variables are not known, we have also shown how the steady state parameters form identifiable combinations, both as a single product with the conductance g, and as ratios with their initial conditions. We have further demonstrated that for ionic currents with two types of voltage-dependent gates, the number of each is an identifiable parameter.

Given the common use of parameter estimation to connect HH models with data in the literature [\cite=Buhry2011] [\cite=Lee2006] [\cite=Csercsik2010] [\cite=Willms1999] [\cite=Fink2009] [\cite=Willms2002] [\cite=Hafner1981] [\cite=Vavoulis2012], these results may be directly useful for fitting and using electrophysiological models. In particular, the points about initial conditions may be useful in practice, as matching both the initial condition and the steady-state parameter at once is an underdetermined problem. Previous work has noted the range of difficulties with estimation for HH-type models [\cite=Buhry2011] [\cite=Lee2006] [\cite=Willms1999] [\cite=Csercsik2010], and this analysis may help to both explain and improve on some of these issues by explicitly laying out the identifiability properties of general HH-type models.

In [\cite=Csercsik2010], the authors used differential polynomial reduction to show that the steady-state parameters are not identifiable. Rather than attempting that computation in the generalized case, we simply rescaled the equations to conclude that the parameters are not identifiable from the altered identifiability structure (one parameter fewer) of the equations. Rescaling in this way is a quick and easy way to begin to approach identifiability questions in the wild, and we hope it proves useful to those who are less comfortable with differential algebra.

To show that the time constants were identifiable in the fully general case, we used a linear system that emerges from the structure of the HH equations and their derivatives. By solving the linear system and equating one entry in the resulting vector with the products of others, we generated an input-output equation. The coefficients of this input-output equation were the coefficients of the polynomial with roots at the time constants and sums of time constants. We were further able to demonstrate the identifiability of the time constants by using the method described in our proof to compute two time constants from simulated data.

In this way, our proof for the identifiability of the time constants also led to the development of a novel approach to estimation of the gating variable time constants, which does not require knowledge or estimation of the steady state parameters. The matrix form of the input-output equations allowed us to estimate parameters by considering the nullspace, which we illustrated using simulated data from the two-gate HH model case. By contrast, more standard estimation approaches would need to estimate the (potentially unidentifiable) steady state parameters and gating variable initial conditions in order to estimate the time constant parameters--this can be somewhat ameliorated by re-scaling the model by the steady state constants (e.g. as in the proof of Theorem [\ref=th:unid]), or by knowledge of the initial conditions, but still requires additional information. This approach enabled us to arrive at a good approximation of the original parameters without needing to know or guess any other unknown parameters, including initial conditions. While we recognize that the presence of noise would confound this process, the idea behind it could prove useful in later work, perhaps in suggesting a starting point in parameter space for error-minimizing parameter searches.

This analysis has focused only on the identifiability of the Hodgkin-Huxley model from data obtained through voltage clamp; a natural extension for future work is to consider data taken from current clamp experiments, in which a current is applied and changes in voltage are recorded, and action potential clamp experiments, which are similar to voltage clamp except that instead of a constant voltage being maintained via a feedback loop, the voltage is instead fixed to match an action potential. Finally, the extensions of Hodgkin-Huxley are wide and varied and encompass much more than voltage-dependent gates acting independently. There is a broad literature of ion channel models out there that could likely benefit from inspection similar to this.

Acknowledgments

We would like to thank Danny Forger for his discussions with us about this work. This material is based upon work supported by the National Science Foundation Graduate Student Research Fellowship under Grant No. DGE 1256260.