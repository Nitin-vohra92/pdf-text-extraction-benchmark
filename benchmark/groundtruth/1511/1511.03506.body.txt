QM/MM description of periodic systems

QM/MM DESCRIPTION OF PERIODIC SYSTEMS

Introduction

The theoretical description of extended systems has become more and more important in the course of treating realistic systems. Presently, energy conversion has become an important topic, and there has been an upsurge of research in electrochemistry.

The targeted systems are rather complex, e.g. the simulation of electrolytes in contact with electrodes. This can often not be done with density functional theory, due to the system size and corresponding large numerical effort. On the other hand, empirical models may not always work well, and besides, they depend on the choice of parameters, such as force fields. The combination of quantum mechanical (QM) and molecular mechanics (MM) methods (QM/MM) is therefore tempting in this area. Therefore, the present article aims at a description of an implementation of such a QM/MM scheme for molecular and periodic systems.

Method

The main intention is to establish a QM/MM scheme for molecules and periodic systems. These schemes have become popular over the past years especially for the modeling of biological systems, see e.g. [\cite=Maseras1995] [\cite=Svensson1996] [\cite=Eichler1996] [\cite=Bakowies1996] [\cite=Sherwood2003]. Also, periodic systems are now investigated on this level, e.g. [\cite=Sauer2000] [\cite=Yarne2001] [\cite=Laino2006] [\cite=Sanz2011]. The systems to be targeted with the present approach are in the area of electrochemistry, e.g. electrolytes, in contact with metal surfaces. Motivated by the aim to develop a theoretical scheme to treat electrochemical interfaces self-consistently, we formulated a QM/MM approach which in the first stage is making use of the so called subtractive scheme to evaluate the system's energy (see, e.g. [\cite=Sherwood2003]). In this scheme, the total energy and forces are obtained as

[formula]

[formula]

Compared to molecules, the periodicity has to be taken into account. This is in the present approach achieved by summing the interactions with the help of the Ewald method in the case of periodicitiy in three dimensions, and Parry's potential [\cite=Parry] for the case of periodicity in two dimensions. The MM interaction is thus summed for the whole system, and subsequently corrected due to the contributions from the QM region: the energy of the QM region and its periodic replicas are again summed with the Ewald or Parry method, on the MM and the QM level separately. Subsequently, the data obtained is inserted in equations [\ref=energyequation] and [\ref=gradientequation]. This QM/MM level corresponds to a mechanical embedding, where the interactions between the QM and MM region are treated on the MM level. The QM and MM calculations for the QM region are performed without taking the atoms into account which are not in the QM region. However, the total energy in equation [\ref=energyequation] and the forces in equation [\ref=gradientequation] now include effects of the QM region. An extension of mechanical embedding leads to electrostatic embedding where the QM calculations include the effects of all the other atoms by e.g. representing these atoms by point charges. The present implementation corresponds thus to a periodic extension of a mechanical embedding. For a comparison of the embedding schemes, see e.g. [\cite=LinTruhlar2007].

Implementation

The present scheme requires a QM and an MM code, and a connection between both. For the MM region GULP was used [\cite=Gale1997], and for the QM region CRYSTAL [\cite=Manual09]. Energies and gradients are obtained from these codes and manipulated according to equations ([\ref=energyequation]) and ([\ref=gradientequation]). Besides these codes, it is necessary to have a routine which works with the manipulated energies and forces: here, a modified version of GULP is used. Finally, an interface (i.e. wrapper) to perform the communication between the three aforementioned codes is required, for purposes such as e.g. extracting the energy and gradients, or setting up new input files during an optimisation (e.g. GULP and CRYSTAL inputs for the QM region are generated automatically during an optimisation).

This strategy has the advantage that features which are available within GULP can be used for QM/MM calculations, such as the geometry optimisation or molecular dynamics. However, one has to keep in mind that in the present implementation only the MM Hessian is available.

Computational parameters

The target of the present work is mainly to establish the methodology. A relatively simple potential is used [\cite=ToukanRahman1985], which employs intermolecular Coulomb and Lennard-Jones terms, and a harmonic intramolecular potential. The advantage is that this is well suited for test purposes, as e.g. results for the water dimer already exist and can thus be compared with. The ab-initio calculations were done on the simple LDA (local density approximation) level, with Dirac-Slater exchange and the correlation functional as in Ref. [\cite=PZ81]. If not stated otherwise, for oxygen a

[formula]

basis set (as in Ref. [\cite=Ditchfield1971]) was used. These basis sets are medium sized, which also means that they are robust and problems from linear dependencies are unlikely to occur.

The structures are visualised with XCrysDen [\cite=XCrysDen] and Molden [\cite=Molden].

Results and discussion

Structural optimisation

Water molecule and dimer

Results for the geometry and vibrational frequencies of the water molecule are displayed in table [\ref=H2Omoleculegeometry]. The MM results are practically identical to those of the publication where this potential was suggested [\cite=ToukanRahman1985]. The QM results (on the LDA level) are in reasonable agreement with the LDA results in Ref. [\cite=Xu2004]. Larger basis sets were used in Ref. [\cite=Xu2004], and indeed, the agreement of the computed H-O-H angle (108.1[formula] vs 104.9[formula] in Ref. [\cite=Xu2004]) can be improved, when the oxygen basis set is enhanced. For this purpose, the

[formula]

Two dimensional periodicity

In a next step, periodicity was implemented. An advantage of the presently used codes is that both employ the same electrostatic potentials, i.e. Saunders' potential [\cite=Vic1994] for one dimensional periodicity, Parry's [\cite=Parry] for two dimensional periodicity and the Ewald potential for three dimensional periodicity. Note that in the present case of two-dimensional periodicity, the implementation of the periodicity is truly two-dimensional. This implies that the system is not repeated in the third direction (z-direction), and there is consequently no parameter for the vacuum thickness.

As a test, the potential curve was computed, where a water dimer was periodically arranged, with the lattice constants a = b, and a fixed angle [formula] (see figure [\ref=H2Odimer2dperiodicgeometry]). Then, the oxygen positions were fixed at a distance of 2.8 Å  (one oxygen 2.8 Å  vertically above the other along the z-axis, which is the non-periodic direction). For various lattice constants, the hydrogen positions were optimised. In the QM/MM case, one molecule was considered the QM region; here it is the one whose oxygen atom has a hydrogen bridge to the second water molecule. This resulted in three potential curves visualised in figure [\ref=H2Odimer2dperiodicpotentialcurve].

For large values of the lattice constant, one obtains essentially the structure of a single water dimer, as the interaction between the dimers is small. When reducing the lattice constant, the water molecules tilt to the molecules of the neighbouring cell, as the interaction to this neighbouring molecule becomes more important. The potential curve has a minimum for a certain lattice constant, which is shortest at the QM level and longer at the MM level. The QM/MM equilibrium distance is now in between the QM and MM equilibrium distance, as the dominant interactions are now the QM-interaction between neighbouring molecules in one layer and the MM-interaction between neighbouring molecules in the other layer.

Molecular dynamics

In a next step, the QM/MM expressions as in equations ([\ref=energyequation]) and ([\ref=gradientequation]) were used to perform molecular dynamics. The implementation is similar to the one used for geometry optimisation as was described in the previous sections. The energy and gradient calculations in the molecular dynamics part of the GULP code were correspondingly modified, and the ab-initio energy and gradient are again extracted from CRYSTAL.

Water dimer

To test the implementation, molecular dynamics simulations were performed for the water dimer (without any periodicity), at the level of MM, QM and QM/MM. The starting point was a system consisting of two water molecules at a relatively large distance (oxygen-oxygen distance ~  5 Å). At the MM level, as CPU time is not critical, a simple, nearly brute force way to obtain the minimum structure was to employ an NVT ensemble at T=10 K with a production run of 400 ps, using a time step of 1 fs.

On the QM level, the optimisation was more difficult due to problems with overheating, when the system gained kinetic energy too quickly. Thus, a series of molecular dynamics runs was used to obtain the minimum structure. Starting again from the geometry where two water molecules are far apart, a 1 ps simulation was performed (time step 1 fs, initial temperature 100 K, and cooling with a rate of 0.1 K/step down to 5 K). Subsequently, the final geometry was used as a new initial geometry, and a simulation at a temperature of 5 K (NVE ensemble, 1 ps, time step 1 fs) was performed. After repeating this procedure a few times, the final structure was essentially the one of the geometry optimisation in table [\ref=H2Omoleculegeometry].

At the QM/MM level, the simulation turned out to be straightforward. The NVT ensemble was used, at a temperature of 10 K, and with a simulation length of 100 ps (1 fs time step).

In all cases, the final structure agreed reasonably well with the one obtained from a straightforward optimisation as described in section [\ref=optimisationsection], e.g. the O-O distance at the end of the MD run was 2.733 Å  (MM), 2.614 Å  (QM), and 2.781 Å  (QM/MM).

Two-dimensional periodicity

Two water molecules were periodically arranged in a two-dimensional box of 5×  5 Å  size, and a molecular dynamics run at the MM level was performed (NVT ensemble, 400 ps total length, 1 fs time step). The initial temperature was 300 K, and lowered to 50 K in 25000 steps. The final structure agreed with the one obtained by a normal minimisation with the default optimiser (BFGS). With a similar (though shorter) molecular dynamics run and using the QM/MM energy and forces, an optimisation at the QM/MM level was performed. The structure agreed reasonably well with the one from the MM optimisation. This serves as an additional test for the QM/MM implementation.

Three-dimensional periodicity

In the case of three-dimensional periodicity, 32 water molecules were considered, in a cubic box of 9.856 Å, corresponding to a density of 1 g/cm3 (see figure [\ref=waterbox]). The calculation of the radial pair distribution function and of the mean square displacement (MSD) was implemented in GULP, or independently computed with ISAACS [\cite=LeRoux2010]. A simulation length of 25 ps equilibration (NVT ensemble) and subsequently 100 ps production was chosen (NVE ensemble), at a time step of 1 fs.

Results for the MSD at the MM level are summarised in figure [\ref=MMmsd]. The temperature is the one as it was obtained as an average over the run. For temperatures [formula] 218 K, there is a linear slope, which increases with temperature, whereas for temperatures [formula] 164 K, the MSD is approximately constant. This indicates a phase transition from the liquid to the solid phase in this temperature range, with this potential. The radial pair distribution functions are displayed in figure [\ref=radialPDFbild]. They agree reasonably well with the literature, e.g. with empirical potentials [\cite=Rahman1973] [\cite=Jorgensen1983] [\cite=Sprik1991], DFT [\cite=Laaseonen1993] [\cite=Izvekov2002] [\cite=Vandevoldele2005] and recently also MP2 [\cite=DelBen2013].

Finally, QM/MM simulations were performed for systems with 32 H2O molecules, out of which 0 to 4 molecules were treated on the QM level, and all the other ones on the MM level. This is labelled as (H2O)n32 - n (where superscript and subscript are the numbers of QM and MM treated molecules, respectively), with n ranging from 0 to 4. The QM region is fixed to the initially defined QM molecules. More sophisticated approaches define a spatial QM region, and consider diffusion into and out of this region via an adaptive scheme [\cite=Bulo2009] [\cite=Bulo2013]. The present results are similar to the MM results, for example a comparison is shown in figure [\ref=radialPDFbildQMMM] for the oxygen-oxygen radial pair distribution function. In the simulations, it turns out that QM clusters are formed: initially, the QM molecules were put far apart. After a while, they start to form dimers in the case of (H2O)230, and arrange in a triangle for (H2O)329. For (H2O)428, there are enough QM molecules so that they can form a chain, which connects the cells; i.e. there is a stripe of QM molecules going through the unit cell. This formation of QM clusters and QM stripes is presumably due to the different binding energies of QM molecules and MM molecules with the functional and potential used in the present work (see the discussion about the water dimer in section [\ref=Water_molecule_and_dimer]). This may require a readjustment of the water potential is some cases, but not necessarily in general. For example, in the case of systems such as water in contact with a transition metal surface, the first water layer has an ice-like structure, and might constitute a possible QM region, whereas the remaining water molecules might be described with a semi-empirical potential.

Conclusion

A QM/MM implementation for periodic systems has been presented. Calculations on the water dimer and for water with two and three-dimensional periodicity show that the implementation works properly. Structural optimisation and molecular dynamics simulations have been implemented on the QM/MM level. In the case of three-dimensional periodicity, as a test system a box of 32 water molecules was studied at the MM and QM/MM level. The pair distribution functions agree well when computed on the MM or QM/MM levels.

Acknowledgements

We acknowledge support from the European Research Council (ERC) through the ERC-Starting Grant THEOFUN (Grant Agreement No. 259608) as well as from the DFG (Deutsche Forschungsgemeinschaft).