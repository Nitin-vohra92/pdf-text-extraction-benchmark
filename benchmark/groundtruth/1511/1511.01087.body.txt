Topological expansion for Haar-distributed orthogonal matrices and second-order freeness of orthogonally invariant ensembles

Lemma Proposition Corollary

Remark Notation Example

Definition

Introduction

The connection between free probability and random matrices was first described in [\cite=MR1094052]. Many important ensembles of random matrices, including any independent matrices with unitarily or orthogonally invariant distributions, are asymptotically free.

This connection may be extended to the second-order statistics, or fluctuations, of matrices. Second-order freeness is defined in [\cite=MR2216446], and it is shown that independent matrices which are unitarily in general position are second-order free in [\cite=MR2294222]. (See also [\cite=MR2302524].) However, the real analogues of the complex matrix models do not generally obey the definition of complex second-order freeness. A definition for real second-order freeness, satisfied by real Ginibre matrices, Gaussian orthogonal matrices, and real Wishart matrices, is given in [\cite=2011arXiv1101.0422R].

Expected values of traces of many complex random matrices may be calculated as sums over orientable surfaces, in which the order of the term depends only on the genus of the surface (see [\cite=MR2036721], Chapter 3, for details of this construction for Gaussian unitary matrices, and [\cite=MR2052516] for complex Wishart matrices). In the analogous expressions for real random matrices, nonorientable surfaces appear in addition to the orientable ones (see [\cite=2011arXiv1101.0422R] [\cite=2012arXiv1204.6211R] for expansions for details of the expansions for real Ginibre, Gaussian orthogonal, and real Wishart matrices). We present a similar expression for Haar-distributed orthogonal matrices, similarly analogous to the expression for Haar-distributed unitary matrices in [\cite=MR2294222]. While this expression resembles those for the other real matrix models, it lacks the property that connected components contribute multiplicatively, so many of the approaches of [\cite=2011arXiv1101.0422R] cannot be used. However, a cumulant approach allows us to consider the contribution of connected components for large matrices. This diagrammatic representation gives us expressions for the first- and second-order statistics of independent matrices which are orthogonally in general position, demonstrating that they are asymptotically real second-order free.

In Section [\ref=section:_notation], we give the notation, constructions, and lemmas we will be using, including summaries of the cartographic machinery (see [\cite=MR0404045] [\cite=MR2036721], and [\cite=MR1813436] [\cite=MR2851244] [\cite=2011arXiv1101.0422R] [\cite=2012arXiv1204.6211R] for the nonorientable case), the annular noncrossing conditions from [\cite=MR2052516], and the Weingarten calculus for Haar-distributed orthogonal matrices from [\cite=MR1959915] [\cite=MR2217291] [\cite=MR2567222]. In Section [\ref=section:_genus_expansion], we present an exact formula for the expected value of the product of traces of expressions involving Haar-distributed orthogonal matrices and outline how asymptotic values may be computed diagrammatically. We give an example calculations with diagrams. In Section [\ref=section:_cumulants], we give exact and asymptotic expressions for the cumulants of traces. In Section [\ref=section:_freeness], we show that matrices which are orthogonally in general position are real second-order free. In particular, this demonstrates that independent random matrices whose distributions are orthogonally invariant are real second-order free.

Notation

For an integer n > 0, we denote the set of integers [formula] by [formula]. For any set [formula], we let [formula], and we let [formula].

We will let δ:k  ↦   - k. For an even [formula] (or one which we may extend to an even function on ±  I), we let [formula].

Partitions

A partition of a set I is a set of subsets [formula] (which we call blocks) such that [formula], [formula] for k  ≠  l, and [formula], 1  ≤  k,l  ≤  n. We denote the number of blocks in a partition π by [formula]. We will denote the set of all partitions of I by [formula], and the set of all partitions of [formula] by [formula].

The partitions of I form a partially-ordered set: if [formula], then we say that [formula] (π is finer than ρ or ρ is coarser than π) if every block of π is contained in a block of ρ. In fact, [formula] is a lattice: for [formula], we define the join of π and ρ, [formula], as the smallest partition larger than both π and ρ, and the meet [formula] as the largest partition smaller than both π and ρ. We denote the smallest element of [formula] (in which all elements are singlets) by 0I, and the smallest element of [formula] by 0n. We denote the largest element (which consists of a single block I) by 1I, and the largest element of [formula] by 1n.

If blocks V1,V2∈π are subsets of the same block of [formula], we say that ρ connects these blocks of π.

If f is a function with domain I, we define [formula] as the partition whose blocks are the preimages of points in the range of f.

A useful lemma:

If [formula], [formula] for some set I, then

[formula]

Since each partition considered is coarser than π, we can consider each partition to be an element of the partitions on the blocks of π, [formula], where a block corresponds to the set of blocks of π contained in it. The number of blocks in a partition is thus the same in both posets.

A block V of σ may join at most [formula] blocks of ρ, so taking the join of ρ with σ reduces the number of blocks by at most [formula]. Considered as elements of [formula], the number of elements in the underlying set is instead [formula], so in fact this join reduces the number of blocks by at most [formula], as desired.

A partition whose blocks all contain exactly two elements is called a pairing. We denote the set of pairings on I by [formula] and the set of pairings on [formula] by [formula]. We note that this set is empty for n odd, so any sum over this set is zero.

We define the Möbius function [formula] as the unique function such that [formula] unless [formula], and for any [formula],

[formula]

The value of [formula] depends only on the number of blocks of π contained in each block of ρ. See, e.g., [\cite=MR1311922], Chapter 12, for more detail on Möbius functions, and the exercises to Chapter 10 of [\cite=MR2266879] for the Möbius function of partitions in particular.

We define the nth mixed moment an of random variables [formula] by

[formula]

For [formula], we define the moment aπ by

[formula]

We define the cumulants [formula] such that kn is an n-linear function, and such that for [formula],

[formula]

to be the unique functions satisfying, for all n,

[formula]

Equivalently, the cumulants are

[formula]

We note that the first cumulant [formula] is the expectation and the second cumulant [formula] is the covariance.

It is a standard result that a cumulant containing any independent random variables vanishes.

In order to distinguish the partition of a set from the partition of an integer (an unordered list of integers summing to that integer), we will always refer to the partition of an integer as a Young diagram.

A Young diagram on integer n  ≥  0 is an unordered list of integers summing to n. If λ is a Young diagram on n, we write [formula].

We will refer to the integers in the list λ as the lengths of its rows. A Young diagram with rows of length [formula] may be written [formula].

Permutations

We denote the set of permutations on a set I by [formula], and the set of permutations on [formula] by Sn. We will generally write permutations π in cycle notation.

The elements in a cycle form an orbit of that partition. We will use the term orbit to refer to this subset of the domain, and cycle to refer to the action of the permutation on this subset.

Since the orbits of a permutation form a partition of its domain, we will often use the permutation to represent this partition. A pairing [formula] corresponds to a permutation in [formula], in which each element is mapped to the other element in its block.

If [formula] is the smallest number of factors in an expression of π as a product of transpositions, then

[formula]

This number depends on the implied domain of π, which we will state explicitly if it is not clear from context.

We note that if we conjugate [formula] by [formula], the cycle notation of ρπρ- 1 is that of π, but with each k∈I replaced by [formula].

If [formula], then we define the permutation induced by π on J  ⊆  I, denoted [formula], by letting [formula] where m > 0 is the smallest integer such that [formula].

In cycle notation, this amounts to deleting the elements not in J. If π does not connect J and [formula], then [formula] is just the restriction of π to J, which is a permutation on J.

Premaps

Pairs of permutations may be used to represent orientable maps (or surfaced graphs, or surface gluings), see [\cite=MR0404045] [\cite=MR2036721]. In order to represent unoriented maps (as appear in the real matrix calculations, see [\cite=MR2036721], Chapter 3), we use what we will call premaps. (These are not exactly what are referred to as premaps in the existing literature, but are a component of them. See [\cite=MR1813436].) For proofs of the cited results on premaps, see [\cite=2011arXiv1101.0422R], and for diagrams motivating the constructions, see [\cite=2012arXiv1204.6211R].

A premap is a permutation [formula] such that δπδ  =  π- 1, and such that there is no cycle containing both k and - k for k∈I. We denote the set of premaps on ±  I by [formula].

The second condition may be verified by checking that there is no k∈I such that [formula] (see [\cite=2011arXiv1101.0422R]).

For any [formula], [formula], and for any [formula] δεπδε is a premap with the same number of cycles, since conjugation by δε swaps some k and - k in π.

We call a cycle in [formula] particular if its k with smallest [formula] is positive. We note that for every particular cycle in π, we have a cycle that is not particular containing the negatives of the elements (in reverse order). We will denote by π / 2 the set of elements of ±  I contained in particular cycles, as well as the permutation π restricted to this set (so π / 2 uniquely determines π).

For I with [formula] and [formula], let φ+: = φ and φ-: = δφδ. For [formula], define

[formula]

If φ encodes the face information of a map and α the edge or hyperedge information, [formula] may be thought of as encoding the vertex information, but it is its inverse which appears more often in our calculations; see [\cite=2012arXiv1204.6211R].) As shown in [\cite=2011arXiv1101.0422R], [formula].

For I with [formula], a [formula], and a [formula], we define the Euler characteristic by

[formula]

We use several properties of the Euler characteristic (see [\cite=2011arXiv1101.0422R] for proofs):

If [formula] has orbits [formula], and if [formula] connects the blocks [formula] (that is, [formula]), then [formula].

We note that [formula]. Let [formula] with [formula], [formula], [formula], i = 1,2, and let [formula] and [formula]. Then [formula].

Noncrossing Conditions

Highest order terms are often represented by highest Euler characteristic terms, which are typically those which can be represented as noncrossing diagrams. Noncrossing conditions may be defined in terms of permutations. We cite the definitions and characterisations for φ with one and two cycles, for oriented and unoriented surfaces. (Our conventions are slightly different from those in [\cite=MR1475837] [\cite=MR2052516], where α follows the sense of φ. Here we think of each object as being oriented counter-clockwise relative to itself. See [\cite=2012arXiv1204.6211R] for more exposition.)

Let I be a finite set, let [formula] be a permutation with a single cycle, and let [formula].

We call α disc nonstandard (relative to φ) if there are three distinct elements a,b,c∈I such that [formula] and [formula]. We call α disc standard (relative to φ if there are no such elements.

We call α disc crossing (relative to φ) if there are four distinct elements a,b,c,d∈I such that [formula] but [formula]. We call α disc noncrossing (relative to φ) if it is neither disc nonstandard nor disc noncrossing.

We denote the set of disc-noncrossing permutations on I relative to φ by [formula].

The following theorem from [\cite=MR1475837] shows that the noncrossing conditions are equivalent to a condition on the number of cycles.

Let [formula] for some finite set I, and let φ have a single cycle. Then

[formula]

if and only if [formula].

Similar conditions for φ with two cycles can be found in [\cite=MR2052516]:

Let [formula] be a permutation with two cycles (which we will refer to as [formula] and [formula]), and let [formula].

We say that α is annular nonstandard (relative to φ) if any of the following conditions holds:

there are a,b,c∈I such that [formula] and [formula],

there are a,b,c,d∈I such that [formula] but [formula].

We call α annular standard (relative to φ) if none of these conditions hold.

Let [formula] and [formula]. We define a permutation λx,y on [formula] by letting [formula] and [formula] (we will generally assume that [formula] and [formula] have at least two elements), and letting [formula] otherwise. We say that α is annular crossing (relative to φ) if any of the three following conditions holds:

there are elements a,b,c,d∈I such that [formula] but [formula],

there are elements a,b,c,x,y∈I, [formula] and [formula], such that [formula] and [formula],

there are elements a,b,c,d,x,y∈I, [formula] and [formula], such that [formula] but [formula].

We call α annular noncrossing (relative to φ) if it is neither annular nonstandard or annular noncrossing. We denote the set of connected (i.e. those connecting the cycles of φ) annular-noncrossing permutations relative to φ by [formula].

Let [formula] for some finite set I, where φ has two cycles and α connects the cycles of φ. Then

[formula]

if and only if [formula].

The analogous results for premaps (representing diagrams where twists are possible) are shown in [\cite=2011arXiv1101.0422R]:

Let [formula] have a single cycle, and let [formula]. Then [formula] if and only if π does not connect I and - I and [formula].

Let [formula] have two orbits V1 and V2, and let [formula] connect ±  V1 and ±  V2. Then [formula] if and only if, for some choice of sign ε  =    ±  1, α does not connect [formula] to [formula] and [formula].

Matrices

For an N  ×  N matrix X, we denote the (usual) trace by [formula]. We denote the normalized trace [formula].

When indices appear on a matrix, we will move the subscript of a matrix to a bracketed superscript: [formula]. We will also use negative integers to denote the transposes of the matrices: [formula].

For [formula], we define the trace of N  ×  N matrices [formula] along the cycles of a permutation [formula] by

[formula]

(We note that the matrices with subscripts not in I do not appear in the expression.) The normalized trace of the matrices is defined similarly.

We will often use the following expression for products of traces of matrices, which may demonstrated by direct calculation:

Let [formula], and let [formula]. Then for N  ×  N matrices [formula],

[formula]

We will often write the choice of indices [formula] as a function [formula].

The Weingarten Calculus

The Weingarten calculus was developed in [\cite=MR1959915] [\cite=MR2217291] [\cite=MR2567222]. We outline some of the proofs here; however, the only properties we will use are those marked as theorems. Since we will only be using the real Weingarten function, we will use the symbol [formula] to refer to that function.

We define a Gram matrix indexed by [formula] by [formula]. (We will usually drop the dimension N from the notation.) The Weingarten function [formula] is the pseudoinverse of G.

The Weingarten function depends only on the size of the blocks of [formula], each of which has an even number of elements (being the union of pairs). If [formula] has blocks of size [formula], we may also index the Weingarten function by the Young diagram [formula] with rows of length [formula].

From Theorem 3.13 of [\cite=MR2217291]:

The Weingarten function [formula] with [formula] has leading-order term

[formula]

where Ck is the kth Catalan number [formula].

We will denote the normalized Weingarten function by

[formula]

We note in particular that [formula].

The Weingarten function can be expressed:

[formula]

(see [\cite=MR2217291]).

The following appears in Corollary 3.4 of [\cite=MR2217291]:

Let O be a Haar-distributed orthogonal matrix. Then

[formula]

For [formula] with [formula], we define a sort of cumulant of the Weingarten function by

[formula]

or equivalently

[formula]

(We use the normalized Weingarten function instead of the usual one as in [\cite=MR2217291], since it appears more often in this paper.)

The following appears in Theorem 3.16 of [\cite=MR2217291]:

For [formula], and [formula] with [formula], the cumulant [formula] is of order [formula].

The cumulants may be expressed

[formula]

To see this, we define an operator S on functions on the positive integers [formula] which are eventually zero by

[formula]

and a product [formula] on such functions by

[formula]

The convolution [formula] is associative, and [formula] (proven in [\cite=MR1959915]). Let [formula], [formula], and l a nonnegative integer. For j, 1  ≤  j  ≤  r, and nonnegative integers [formula] with [formula], define [formula] by letting [formula] be the number of ordered [formula]-tuples [formula] with [formula], [formula], [formula], [formula], and [formula], and define [formula] to be the number of tuples such that, in addition, [formula]. Then the coefficient of [formula] in [formula] is

[formula]

which is the coefficient of [formula] in

[formula]

(where the subset Uj corresponding to [formula] in the convolution is the set of [formula] for which [formula]). For [formula], the coefficient of [formula] in the sum of only the terms with [formula] is

[formula]

which is the coefficient of [formula] in the given expression for the cumulants.

To put a bound on the order of the cumulant, we note that [formula] is a distance metric. If joining [formula]) ([formula] with π reduces the number of blocks by m, then it must reduce the number of blocks of any πjs by at least as much (Lemma [\ref=lemma:_useful]). Since [formula] (Lemma [\ref=lemma:_loops] below shows that [formula]), we have [formula], so inserting π between any πjs and πjs + 1 increases the total distance of the path by 4m. Thus, if we require our list of πj to reduce the number of blocks of ρ to [formula], the total distance must be at least [formula], and the bound follows.

Freeness

A noncommutative probability space is a pair [formula] consisting of a unital algebra A and a linear functional φ1 such that [formula].

A second-order probability space is a triple [formula], where [formula] is a noncommutative probability space, and [formula] is a function which is tracial in each argument such that for any a∈A, [formula].

A real second-order probability space is a second-order probability space equipped with an involution a  ↦  at such that for any a,b∈A, [formula].

When we consider algebras generated by elements of a real second-order probability space, we also require the algebra to be closed under this involution (which is the transpose when we are considering finite random matrices).

We say that an element a∈A of a noncommutative probability space is centred if [formula]. We may centre an element a by subtracting [formula] (we will denote multiples of the unit by scalars): we denote the centred element by [formula].

We say that a word [formula] is alternating if [formula]. We say that it is cyclically alternating if, in addition, [formula].

For [formula] subalgebras of A, we say that [formula] are alternating if, for 1  ≤  i  ≤  n, ai∈Aki with [formula]. We say that they are cyclically alternating if, in addition, kn  ≠  k1.

Subspaces [formula] of a noncommutative probability space are free if, for any [formula] centred and alternating,

[formula]

Subsets of A are free if the algebras they generate are free.

Subspaces [formula] of a real second-order probability space are real second-order free if they are free, and for any [formula] and [formula] centred and cyclically alternating, we have for p  ≠  q:

[formula]

and, taking subscripts modulo the appropriate range (as we will do throughout), for p = q,

[formula]

Subsets of A are real second-order free if the algebras the generate are free.

If we have a set of N  ×  N random matrices [formula] for N arbitrarily large (we will generally suppress N in the notation), we say that they have a (first-order) limit distribution if there is a noncommutative probability space [formula] with [formula] such that, for any noncommutative polynomial p in m variables, we have

[formula]

while any higher cumulant of such normalized traces vanishes as N  →    ∞  .

We say that random matrices [formula] have a second-order limit distribution if, in addition, we have a φ2 such that [formula] is a second-order probability space, and for [formula] noncommutative polynomials in [formula] variables, we have

[formula]

while for r > 2, we have

[formula]

We say that the random matrices have a real second-order limit distribution if [formula] is a real second-order probability space with involution x  ↦  xt, and for every λ∈Λ, -  λ∈Λ (where, as elsewhere, X-  λ = XTλ and x-  λ = xtλ).

We say that sets of random matrices are asymptotically free if they have a limit distribution, and the corresponding sets of elements of the limit distribution are free.

We say that sets of random matrices are asymptotically real second-order free if they have a real second-order limit distribution, and the corresponding sets of elements of the second-order limit distribution are real second-order free.

For the standard definitions in (complex) second-order freeness, see [\cite=MR2216446] [\cite=MR2294222] [\cite=MR2302524].

Moments of Haar-Distributed Orthogonal Matrices

For a finite set I of signed integers we define the alternating permutations [formula] as the set of permutations π on I such that [formula]. We define the alternating premaps [formula].

For I a subset of the positive integers, the map given by [formula] is a bijection from [formula] to [formula].

The blocks of [formula] each have an even number of elements, so we may construct a Young diagram whose row-lengths are half the number of elements in the blocks. The cycles of π+π- consist of pairs with the same number of elements, so we may construct a Young diagram with a row for each pair of cycles whose length is the number of elements in each of those cycles. The cycles of π-δπ+ each contain an even number of elements, so we may construct a Young diagram whose row-lengths are half the number of elements in the cycles of π-δπ+ / 2. All three Young diagrams are equal.

Since neither π+ or π- changes the sign, π-δπ+ is alternating. We have [formula] while its inverse has [formula], and since neither π+ nor π- have fixed points it will never take k to - k, so it is a premap. For k > 0, [formula] and [formula], so the map is injective. For any alternating premap [formula] and k∈I we let [formula] and [formula] (and we let these act trivially on - I). Then [formula], and since [formula], these are indeed pairings. We calculate that [formula], so the map is surjective.

Since a block of [formula] is a union of pairs, it must have an even number of elements.

Since π+ and π- are both self-inverse, elements of an orbit of the subgroup generated by π+ and π- may be obtained by applying them alternatingly to an element k of that orbit. Since π-π+ is the inverse of π+π-, all elements of the orbit are of the form [formula] or [formula] for some integer m. Thus this orbit is the union of the cycle of π+π- containing k and its image under left multiplication by π-, which is the cycle containing [formula]. These cycles must be disjoint: if [formula] for any m, then [formula], but since [formula] must not have fixed points, we have a contradiction. Each block of [formula] is then the disjoint union of two cycles of π+π- containing the same number of elements, and thus the constructed Young diagram is the same as that constructed from [formula].

Since π-δπ+ is alternating, each cycle must contain an even number of cycles. We calculate that for k > 0, [formula], so the positive elements of each cycle are the elements of a cycle of π+π-, and thus the constructed Young diagram is the same as that constructed from π+π-.

We will denote the Young diagram constructed in this manner from an alternating premap [formula] by [formula]. For every pair of cycles in ρ of length n, [formula] has a row of length n / 2.

It is actually possibly to construct more correspondences between these constructions, which we will not need. The connections between the various constructions are illustrated in the following example:

In Figure [\ref=figure:_loops] we show pairing [formula] above a horizontal line and [formula] below it. Their union consists of two disjoint loops.

The blocks of [formula] correspond to the loops in Figure [\ref=figure:_loops]. Since one block contains six points, the other two, this partition corresponds to Young diagram [formula].

We calculate that [formula]. The first two cycles each have 3 elements. Their union is the set of points in the loop with 6 points, and each enumerates alternating points around this loop (in opposite directions). The last two cycles each have 1 element, and their union is the set of points in the loop with 2 points. This permutation also corresponds to Young diagram [formula].

We also calculate that [formula]. The two cycles of length 6 trace out the loop with 6 points in Figure [\ref=figure:_loops] and the two of length 2 trace out the loop with 2 points (in opposite directions). This premap corresponds to Young diagram [formula].

Let O be a Haar-distributed orthogonal matrix. Let φ∈Sn, let [formula], let [formula], and let [formula] be random matrices independent from O. Then

[formula]

In order to accommodate arbitrary values of ε, instead of the usual ik and jk we will use indices ιk for all [formula], which we interpret as a function [formula]. We choose indices such that the kth occurrence of the matrix O appears with the indices ιk and ι- k. By Lemma [\ref=lemma:_traces], we have

[formula]

The expected value containing entries of the matrix O may be calculated using Theorem [\ref=theorem:_integral]. On a nonvanishing term, there are constraints on the indices [formula] and [formula] for k > 0. Since π+ and δπ-δ act on disjoint sets, we may combine this as [formula] for all [formula]. Thus our expression is:

[formula]

Reversing the order of summation, we get:

[formula]

We show that the constraints on the indices are those which would appear in the trace along [formula].

We note that for k > 0,

[formula]

so the product of terms from matrices Xk may be expressed

[formula]

The constraint [formula] tells us that the second index of Xk is equal to [formula], the first index of Xφ- 1-δεπ+δπ-δεφ+. (Taking the constraint in the opposite direction, it is also equal to [formula], the first index on Xφ- 1-δεδπ+δπ-δδεφ+, and since π-δπ+ is a premap, this is the same term. Likewise, applying the constraints to the first indices results in the same equality. Since any subscript of ι appears at most once, these are all of the constraints.) Relabelling the first index of Xk as ik, and replacing the second index with the first index which it is constrained to be equal to, we find that these are exactly the constraints on the indices of

[formula]

Expressing this in terms of the normalized trace and Weingarten function, the first expression follows, and the second follows from Lemma [\ref=lemma:_loops].

By Lemma [\ref=lemma:_Euler_characteristic] and Theorems [\ref=theorem:_unoriented_noncrossing] and [\ref=theorem:_leading_order_Weingarten], if [formula] have a limit distribution, the large matrix limit of the expected value in Proposition [\ref=proposition:_genus_expansion] exists, and the surviving terms are those where α restricts to an orientable disconnected (disc) noncrossing permutation on each cycle of φ. At highest order, the contribution of each hyperedge and each vertex contributes multiplicatively.

If we wish to calculate

[formula]

we construct the faces shown in Figure [\ref=figure:_faces]. Indices appear around the faces in the cyclic order they appear in the traces. If we wish to consider the term corresponding to the pairings in Example [\ref=example:_loops], we glue the edges corresponding to indices constrained to be equal (also shown in Figure [\ref=figure:_faces]). The full expression is a sum over all possible surfaces constructed by gluing pairs of positive index edges and pairs of negative index edges. The direction of the gluing is such that the corners with the Xk matrices are together.

We find a number of vertices whose corners contain the matrices Xk. The constraints on their indices are those that Lemma [\ref=lemma:_traces] gives for the trace of the product of the matrices (in clockwise order). Expressed in terms of the normalized trace, each of these vertices contributes an order of N. The subscripts appearing around these vertices (in counterclockwise order) are given by the cycles of the permutation [formula], so the trace is along the cycles of [formula]. In this case, [formula].

In addition, we find a number of vertices which contain the matrix O or its transpose. These correspond to the loops of [formula] (see Example [\ref=example:_loops]). By Theorem [\ref=theorem:_leading_order_Weingarten], each of these vertices also contributes an order of N, and together a factor of [formula]. At highest order, each vertex contributes a factor of [formula], where k is the degree of the vertex and Ck / 2 - 1 is the [formula]th Catalan number. We have [formula], and (from [\cite=MR2217291]),

[formula]

which, when N  →    ∞  , is [formula].

We may also interpret the hypermap π-δπ+  =  α as the set of hyperedges (edges which may have any positive integer number of ends, rather than just two, which may be visualized as vertices which alternate with the original set of vertices as in the original construction in Figure [\ref=figure:_faces]; see [\cite=MR0404045] [\cite=MR2036721] [\cite=2012arXiv1204.6211R]). This allows us to represent each occurrence of the matrix O or OT as a single edge, and each Xk as a vertex. In Figure [\ref=figure:_hyperedges] we represent them as shapes touching the edges they are gluing. Twists in the shape represent the edge being identified in a reversed direction. This identification must be consistent with the directions marked with arrows in the diagram, which is counter-clockwise for O terms and clockwise for OT terms. The cycles of α (divided by two) give the partition the Weingarten function is applied to, and the vertices again give the trace of the Xk.

We calculate that [formula], so the surface is a connected sum of three projective planes (cross-cap genus 3).

We calculate that the contribution of this diagram to the expected value is

[formula]

Proposition [\ref=proposition:_genus_expansion] shows that Haar-distributed orthogonal matrices satisfy a number of the hypotheses of the matrices discussed in [\cite=2011arXiv1101.0422R]; specifically, for all φ∈Sn, [formula], and Xk random matrices independent from O, we have

[formula]

for each finite set of positive integers I, [formula] is a subset of the premaps on ±  I such that for any J  ⊆  I, the [formula] which do not connect ±  J and [formula] are the product of a [formula] and [formula]; and [formula] is a function such that [formula] exists. (The only hypothesis that is not satisfied is that [formula] be multiplicative in disconnected factors.) In particular, this means (see [\cite=2011arXiv1101.0422R]) that, if [formula] are independent Haar-distributed orthogonal matrices and [formula] is a word, then

[formula]

We may depict this diagrammatically by considering only gluings where each hyperedge may connect only copies of the same matrix, and the contribution of the hyperedges is calculated for each matrix Oc separately. Since [formula] is not multiplicative, we can no longer express the contribution of a diagram as the product of the contributions of its connected components.

Cumulants with Haar-Distributed Orthogonal Matrices

Let [formula] with [formula]. Let [formula] be independent Haar-distributed orthogonal matrices, and let [formula] be random matrices independent from the Oc. Let [formula], let [formula], and for 1  ≤  k  ≤  r, let

[formula]

Let [formula]. For [formula] let [formula]. Let [formula] be the particular cycles of [formula]. (We omit the indexing of s and the σk by α to avoid clutter.) For [formula], let [formula] have a block corresponding to each block V∈ρ equal to [formula]. Then:

[formula]

If the algebra generated by the Xk has a second-order limit distribution, then [formula] exists, and for r > 2, [formula].

The cumulant may be written

[formula]

We may then expand the Weingarten functions and the expected value in terms of their cumulants. The innermost product becomes:

[formula]

Permuting the order of summation

[formula]

The innermost sum is equal to 1 when the lower bound [formula], and 0 otherwise. The first part of the theorem follows.

We know that [formula] and

[formula]

and vanishes asymptotically if τ contains a block of size greater than 2. The full cumulant is then [formula]. We know that [formula], so

[formula]

By Lemma [\ref=lemma:_useful], [formula]. Thus

[formula]

Since τσ must connect the blocks of [formula], τ must have a k not in a singleton in each block of [formula], or

[formula]

Since [formula], we have that the cumulant is [formula].

Furthermore, if r > 2, then either [formula]; or [formula], in which case we can get a strict inequality from ([\ref=formula:_Weingarten_cumulant_inequality]); or τσ must connect more than 2 blocks, in which case it either has at least two k not in singletons in one block of [formula], or a block of size greater than 2. In the first case [formula]. In the second, the inequality we get from ([\ref=formula:_cumulant_inequality]) is strict. In the third, if we have more than on k not in a singleton then the inequality ([\ref=formula:_Weingarten_cumulant_inequality]) is strict, and if σ has a block of size larger than 2, the cumulant over the block of size greater than 2, and hence the product, vanishes.

Matrices Orthogonally in General Position

We present two technical lemmas which will be useful in the following proofs. Lemma [\ref=lemma:_neighbours] [\ref=disc] shows that any disc-noncrossing permutation with no singletons must have a cycle which contains a pair of neighbours: since every cycle must contain more than one element, we can find a sequence of nested cycles until we find one containing the pair of neighbours. (In fact we can find two, since we may always find two distinct notions of "outside", and hence two directions of nesting.) Lemma [\ref=lemma:_neighbours] [\ref=annulus] shows that if an annular-noncrossing permutation with no singletons has a cycle with more than one element in one disc of the annulus, then it must have a cycle with a pair of neighbours: elements on one side of this permutation may be connected to the other cycle of φ, but we may similarly find a sequence of nested permutations on the other side until we find a pair of neighbours. This means that in alternating products of centred matrices orthogonally in general position, highest order terms must correspond to an α connecting a pair of neighbours under these conditions. Roughly, it may not connect a 2n to [formula], since terms are alternating, and if it connects a 2n - 1 to [formula], the centred matrix between them appears alone in a cycle of [formula], allowing us to show that the term must vanish. In the first-order case, all terms vanish, and in the second-order case, we are left with the spoke diagrams, as we expected.

Let [formula] be a permutation with one cycle. If [formula] has no cycles with only one element, then there are at least two distinct [formula] such that [formula].

For any a, [formula]. If [formula], then let [formula]. Point c must be in a distinct cycle of π from a and b: if not, then [formula], so α would be disc nonstandard. Let [formula]. Since [formula], we must have [formula] (disc-noncrossing condition). So if m1 and m2 are the smallest positive integers such that [formula] and [formula], then m2 < m1. By induction, we can repeat this process and eventually find a k such that [formula].

If we now let [formula] and [formula], then we may find a [formula] such that [formula]. Since [formula], we know that [formula].

Let [formula] be a permutation with two cycles. If [formula], then if there are any two points sharing both a cycle of φ and one of α, we can find a k such that [formula].

Let a and b share cycles of both φ and π. We will denote this cycle of φ by [formula]. If there are points c and d in the other cycle of φ such that [formula], then π is annular nonstandard (second condition). Thus we can find [formula] such that [formula].

We choose a and b such that, in addition, [formula] for the minimal positive integer m. If [formula], then let [formula]. The point x must be in a different cycle of α from a and b: [formula], so [formula] would be disc nonstandard. By the first annular-noncrossing condition and the minimality of m, [formula].

Consider an element c with [formula]. Element c cannot share a cycle with x (first annular-noncrossing condition), so if I is the union of the orbits of such c, then [formula] (second and third annular-noncrossing conditions). This means that all d sharing cycles with a c∈I have [formula] (third annular-noncrossing condition), and thus also have [formula] (and [formula] is the restriction of α to I).

We can then apply Lemma [\ref=lemma:_neighbours] [\ref=disc] to [formula], so we must be able to find two distinct k∈I such that [formula]. At least one of these must not be [formula], and since λx,y and φ agree on all other c∈I, we have the desired k.

The following lemma shows that, for independent [formula] indexed by some set of colours [formula], in the expansion of an expression of the form

[formula]

according to Proposition [\ref=proposition:_genus_expansion], the cycles of any [formula] indexing the Xk have a consistent colour. This means that any single trace appearing in a trace along [formula] must satisfy the hypotheses of the limit distributions of that algebra.

Let [formula] be even positive integers, and let [formula], let [formula], and let [formula] be a word in colours [formula] such that for positive integer k, [formula]. Then for any [formula], the permutation [formula] takes odd integers to odd integers, and for any odd integer k, [formula].

Let [formula] be odd, and consider the action of each permutation in [formula]. If α does not change the parity, then neither or both [formula] terms act. Since α is alternating, the sign is changed, so neither or both of φ+ and φ- 1- act, and the parity is ultimately preserved. Similarly, if α changes the parity, exactly one of the [formula] terms acts, so the sign is unchanged and exactly one of φ+ and φ- 1- acts, again preserving the parity.

If φ+ acts, it takes k to the even number sharing its colour, and if φ- 1- acts, it takes the integer from an even number to the odd number sharing its colour. None of the other factors change the colour.

Associate with each colour [formula] an algebra of random matrices Ac with first-order limit distribution, and assume that the Ac are either independent or collectively possess a limit distribution. For each [formula] let Oc be an independent Haar-distributed orthogonal matrix independent from any matrix in any of the Ac. Then the algebras [formula] are free.

The rth cumulant of normalized traces (including the first) of a product of elements of the OTcAcOc may be expressed as N- r times the value in Proposition [\ref=proposition:_cumulants]. The trace over [formula] is a product of a number of traces, each of which is a classical random variable, and each associated to one colour [formula] according to Lemma [\ref=lemma:_colours]. Let us call them [formula]. Then

[formula]

Any cumulant of independent Zk vanishes (if the Ac are independent), and any cumulant ks for s > 1 vanishes asymptotically as a condition of the first-order limit distribution of the algebra associated to its colour (or the full algebra). Thus the only remaining term is the one associated with the partition of singlets ρ = 0r:

[formula]

Each expected value has a finite N  →    ∞   limit, again a condition of the first-order limit distribution. So if r = 1, the N  →    ∞   limit exists, and if r > 1, it vanishes.

Let [formula] be an alternating word in the colours, and for 1  ≤  k  ≤  n, let [formula] be a centred matrix (i.e. [formula]). Then, letting [formula], [formula], and [formula], we have:

[formula]

For a term surviving as N  →    ∞  , we have [formula] and hence [formula]. Being alternating each of its cycles must contain more than one element, so by Lemma [\ref=lemma:_neighbours] [\ref=disc], there must be a [formula] such that [formula]. For even k  ≠  2n, [formula], so [formula] cannot connect k and [formula]. Thus k is odd (or k = 2n; if so, we choose the other k). Then [formula], so cycle [formula] appears in its cycle decomposition, so [formula] for some s. Since [formula], the term in ([\ref=formula:_first-order]) associated to this α must vanish. Thus ([\ref=formula:_first-order]) vanishes asymptotically, proving the result.

Associate with each colour [formula] an independent algebra of random matrices Ac with second-order limit distribution. For each [formula] let Oc be an independent Haar-distributed orthogonal matrix independent from any matrix in any of the Ac. Then the algebra generated by the OTcAcOc has a second-order limit distribution.

Expanding a cumulant of terms in the algebras generated by the OTcAcOc in the form of Proposition [\ref=proposition:_cumulants], by Lemma [\ref=lemma:_colours], each trace appearing in this expansion is associated with one colour [formula], so any cumulant kτ in which traces of different colours appear in the same block of τ vanishes. The remaining cumulants must satisfy the convergence requirements as cumulants of an algebra with a second-order limit distribution.

Associate with each colour [formula] an algebra of random matrices Ac with second-order limit distribution, and assume that either the Ac are independent, or the algebra generated by the Ac has a second-order limit distribution. For each [formula] let Oc be an independent Haar-distributed orthogonal matrix independent from any matrix in any of the Ac. Then the algebras [formula] are free of real second-order.

We have first-order freeness by Proposition [\ref=proposition:_first-order] and the existence of a second-order limit distribution by Proposition [\ref=proposition:_limit_distribution] (if the Ac are independent; if they collectively have a second-order limit distribution then by Proposition [\ref=proposition:_cumulants], so do the OTcAcOc).

Let [formula] and [formula] be cyclically alternating words in the colours, and let [formula] and [formula] be centred random matrices with [formula], [formula], and [formula], [formula]. We let

[formula]

Let

[formula]

[formula]

[formula]

Let [formula]. We have, in the notation of Proposition [\ref=proposition:_cumulants]:

[formula]

We consider the terms that survive as N  →    ∞  . If α does not connect [formula] and [formula], then at least one of ρ or τσ must, in which case that partition must have at least one block of size 2. In either case, this block corresponds to a factor which is [formula], so in a surviving term, this is the only block of size greater than one in either partition. Furthermore, we must have [formula] (so [formula] does not connect [formula] to [formula] or [formula] to [formula], with [formula] and [formula]). By Lemma [\ref=lemma:_neighbours] [\ref=disc], we can then find two k in [formula] and two in [formula] such that [formula], all of which are odd (since for k even, [formula], so they cannot be in the same cycle of [formula]). For each, [formula], so the cycle [formula] appears in [formula]. In addition, since in a surviving term, τσ can have a block connecting at most two cycles of [formula], we must have at least one cycle [formula] in its own block of τσ. The term then contains the expected value of the trace of a centred matrix, so it vanishes.

Otherwise, α connects [formula] and [formula]. Highest order terms have [formula] (so by Theorem [\ref=theorem:_unoriented_noncrossing], we have either [formula] or [formula]) and have both ρ and τ as small as possible.

Since each cycle of α must contain more than one element, any surviving α must be a pairing where each pair consists of an element from [formula] and an element from [formula]. If p  ≠  q, there are no such pairings, so the covariance vanishes asymptotically as desired. If p = q, we will consider two cases: [formula] is odd, and [formula] is even.

If [formula] is odd, define k by [formula]. Then the cycle [formula] appears in α, and hence the cycle [formula] appears in [formula].

We show by induction that for [formula], [formula] (taken in [formula], modulo 2q). Let a be the first integer in [formula] for which this does not hold. Let b = 2k - a - 1, let [formula], and let [formula]. We know that [formula], since we know the partners of every element between (so c and d cannot be any of these elements). We also know that [formula] and [formula], so [formula], which is the third annular-crossing condition.

Such a α appears in ([\ref=formula:_second-order_expansion]) only if [formula] for all [formula], that is, if [formula] for all [formula]. If so, we calculate that the cycles of [formula] are [formula], 1  ≤  i  ≤  2p, and the contribution of the term is:

[formula]

If there is an i such that [formula], then the term α does not appear in the sum, so we make take the contribution to be zero. By Proposition [\ref=proposition:_first-order],

[formula]

which is again the desired contribution.

The case [formula] even is similar. Define k by [formula]. Then the cycle [formula] appears in [formula], connecting [formula] to [formula], so [formula]. By induction, [formula]. There is nonzero contribution only if [formula] for all [formula], and as above, in either case the contribution of the term is

[formula]

The result follows.

We note that conjugating by any orthogonal matrix does not change the value of traces, so we may also have one ensemble which is not conjugated.

Several corollaries follow:

Any combination independent matrices drawn from orthogonally invariant distributions (including real Ginibre matrices, Gaussian orthogonal ensemble matrices, real Wishart matrices, and Haar-distributed orthogonal matrices) and one other ensemble (possibly constant matrices) are real second-order free.

An algebra of random matrices A with second-order limit distribution is free of real second-order from OTAO, where O is a Haar-distributed orthogonal matrix independent from A.