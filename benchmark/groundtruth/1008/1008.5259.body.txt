Michel Petitjean

Abstract. Given n points in Euclidean space Ed, we propose an algebraic algorithm to compute the best fitting (d - 1)-cylinder. This algorithm computes the unknown direction of the axis of the cylinder. The location of the axis and the radius of the cylinder are deduced analytically from this direction. Special attention is paid to the case d = 3 when n = 4 and n = 5. For the former, the minimal radius enclosing cylinder is computed algebrically from constrained minimization of a quartic form of the unknown direction of the axis. For the latter, an analytical condition of existence of the circumscribed cylinder is given, and the algorithm reduces to find the zeroes of an one unknown polynomial of degree at most 6. In both cases, the other parameters of the cylinder are deduced analytically. The minimal radius enclosing cylinder is computed analytically for the regular tetrahedron and for a trigonal bipyramids family with a symmetry axis of order 3.

Keywords: Best fitting cylinder; smallest enclosing cylinder; minimal cylinder; circumscribed cylinder through five points; numerical algorithm.

2010 MSC codes: 51M04, 51N15, 65D10, 65K05, 90C26

1. Introduction

Let Ed be the d-dimensional Euclidean space, Ud - j be a (d - j)-dimensional affine subspace, and ρ a non negative real number. The set of points x of Ed lying at distance smaller or equal to ρ from their orthogonal projection on Ud - j is called a j-cylinder. We consider n data points in Ed. A j-cylinder C containing n points is called a circumscribed j-cylinder if all n points are lying on the boundary of C. We consider further only (d - 1)-cylinders in this paper. A (d - 1)-cylinder is defined with an axis, i.e. a unit vector u defining the direction of the axis and a point c of Ed locating the axis, and a radius ρ.

Given n data points xi,i = 1,...,n in Ed, several cylinder problems are defined.

Best fitting cylinder problem: Find the (d - 1)-cylinder (u,c,ρ) minimizing the standard deviation of the population of the n squared distances between the xi and their projections on the axis, ρ2 being the mean of this population. If it happens that the minimal standard deviation is null, all distances are equal to ρ and the resulting cylinder is circumscribed to the n points.

Smallest enclosing cylinder problem: Find the (d - 1)-cylinder (u,c,ρ) of minimal radius ρ enclosing the n points.

Circumscribed cylinder problem: Find the (d - 1)-cylinder (u,c,ρ) circumscribed to the n points, and if it is not unique, exhibit the one of minimal radius. The circumscribed cylinder may not exist.

The circumscribed cylinder problem in E3 seems to have appeared in the literature in 1977 [\cite=Bottema1977], but practical algorithms appeared much later [\cite=Devillers2003], at the occasion of the analysis of circular cylinders through four or five points. Unfortunately, the practical computation of solutions is not trivial and requires the use of specialized packages. Recently, a numerical solver based on second order cone programming methods has been devised to compute smallest enclosing cylinders [\cite=Watson2006]. Bounds for the radius of minimal enclosing d-simplices have been given [\cite=Brandenberg2006], and the complexity of the smallest enclosing cylinder problem has been investigated for metrology applications [\cite=Schomer2000].

In this paper we propose simple algebraic algorithms to solve the three cylinders problems, which can be implemented without the use of sophisiticated packages. The motivation comes from recent molecular modeling studies in which the shape of many small molecules is expected to be suitably fitted with cylinders [\cite=Meslamani2009]. In this context, d = 3, and the smallest enclosing cylinder problem is the basic one we need to solve. We face to small n values, so that we are interested by the algebraic aspects rather than by the computational complexity. Solving the best fitting cylinder problem is useful to introduce our approach, and solving the circumscribed cylinder problem is part of our full algorithm.

2. The best fitting cylinder problem

The usual scalar product of x and y is x'y, the quote denoting a vector of matrix transposition. The norm of x is ||x|| = (x'x)1 / 2. We define X as the rectangular array of n lines and d columns containing xi' at the line i, i = 1,...,n. The squared distance between xi and its projection on the axis is Δi  =  (xi - c)'(xi - c)  -  ((xi - c)'u)2. The mean of the population of the Δi is [formula], and the variance to be minimized is [formula].

Any point c lying on the axis of the cylinder can be used. Thus we decide to retain c as the projection of the origin on the axis, i.e. c'u = 0. We are left with the minimisation of a polynomial of u and c, subject to the orthogonality condition c'u = 0 and to the normalization u'u = 1. Using the Lagrange multipliers K and L, the function to be minimized is

Min{c,u}Fcu (1)

[formula]

For clarity we assume further than the mean of the n points is translated to the origin. Setting Vi = xixi', the inertia matrix is [formula] and the covariance matrix is V = T / n. We also further assume that the set of the n points is not subdimensional, i.e. X is of full rank d, and T = X'X and V are invertible. The identity matrix of rank d is I, we define Bi = I  ·  Tr(Vi - V)  -  (Vi - V). Then, Δi = Tr(Vi) - 2c'xi + c'c - u'Viu, and the expression of Fcu expands as

[formula] (2)

The components of u and c are the 2d unknowns in (2). The unknown radius is ρ2  =  . It is computed from c and u. The gradient of Fcu relative to c is

[formula] (3)

The stationary point is such that Gc = 0, so that

[formula] (3)

The Lagrangian K is expressed from setting u'c = 0 in (3). Then, the analytical expression of the optimal c value can be used in (2), so that the minimization in (1) reduces to a non convex optimization problem in which there are only d unknowns, i.e. the components of u. Standard algebraic solvers can be used [\cite=Gill2008]. Moreover, starting points are random unit vectors u, which in fact are d - 1 independant parameters values. This is beneficial in term of global optimization cost. E.g., for d = 3, a reasonable amount of random initial unit vectors should suffice to locate the global minimum of Fcu, and there is no need of a huge of initial 6-tuples.

The case where the solution is F*cu = 0 is of special interest. In this situation, all the n points are lying at distance ρ from the axis, and we face to a circumscribed cylinder problem. We have n equations Δi  =  , i.e.

u'Biu  =  2c'xi (4)

Only n - 1 are independant equations because [formula] and [formula]. Adding to them the two equations c'u = 0 and u'u = 1, we get a system of n + 1 independant equations of 2d unknowns c and u. This system is determined when n = 2d - 1. When d = 3, we retrieve that at most a finite number of cylinders is expected to pass through 5 points in general position. More will be said further.

3. The smallest enclosing cylinder problem

A cylinder is a convex set, so that the smallest cylinder enclosing n points is the one which encloses the vertices of the convex hull of the n points. Thus, deleting the points interior to the hull before computing the smallest enclosing cylinder can drastically reduce the computational cost. Convex hull algorithms in 2, 3, and more dimensions have been described [\cite=Edelsbrunner1987] [\cite=Preparata1985].

When d = 3, the smallest enclosing cylinder problem is here the minimal radii enclosing cylinder problem, which should not be confused with the minimal height enclosing cylinder problem. This latter is a special case of the smallest enclosing 1-cylinder problem although the former is a smallest enclosing (d - 1)-cylinder problem. The minimal height enclosing cylinder is defined by the closest enclosing parallel planes, and we know from proposition 3 in [\cite=Brandenberg2006] that these latter planes contain together at least one 4-tuple of vertices of the convex hull. The radius of the minimal height enclosing cylinder is then the radius of the smallest circle containing the projections of the points on one of the closest enclosing parallel planes.

We return back to the minimal radii enclosing cylinder problem. Owing to the result given at the end of section 2, the smallest enclosing cylinder must be seeked in the set of minimal radius cylinders circumscribed to k points, k taking successively increasing values from 1 to 2d - 1. The smallest k value for which there is at least one minimal radius circumscribed cylinder enclosing all n points is retained. If there are several such circumscribed cylinders, the smallest radius one is retained. It may be not unique.

When d = 3, we look for minimal radius cylinders circumscribed to successively 1, 2, 3, 4 and 5 points. Cases k = 1 and k = 2 are degenerate. The case k = 3 is in fact subdimensional: find the two closest lines enclosing 3 points. Still from proposition 3 in [\cite=Brandenberg2006] we deduce that the associated minimal radius is half of the smallest of the three heights of the triangle defined by the three points. Only the cases k = 4 and k = 5 are non trivial. We consider them hereafter, assuming d = 3.

4. The smallest cylinder passing through 4 points

Here we set n = 4. For convenience, we set γ = 2c and we define the vector b having four components bi = u'Biu. The four equations in (4) are rewritten in matricial form Xγ = b, and because we already assumed X to be of full rank, we express γ from u in (5).

γ = T- 1X'b (5)

The squared radius ρ2  =   = Tr(V) - u'Vu + c'c is to be minimized under the constraints u'c = 0 and u'u = 1. Setting W = I  ·  Tr(T) - T and using the Lagrangians K and L, the objective function of u to be minimized is

F = u'u  ·  u'Wu + γ'γ - 2Kγ'u + L(1 - u'u) (6)

The case of the regular tetrahedron is solved analytically.

Theorem 1. (a) There are three absolute minimal radius circumscribed cylinders to the regular tetrahedron. The ratio of the minimal radius to the length of the edge is 1 / 2. The axis of the three cylinders intersect at the center of the tetrahedron and are mutually orthogonal, following the directions parallel to the edges of the cube having for vertices the four ones of the tetrahedron plus the four ones got by reflection of these latter through the center. (b) There are six absolute maximal radius circumscribed cylinders to the regular tetrahedron. The ratio of the maximal radius to the length of the edge is [formula]. The axis of the six cylinders following the directions parallel to the edges of the tetrahedron.

Proof. We use: x1' = (1,1,1), x2' = (1, - 1, - 1), x3' = (1, - 1,1), x4' = ( - 1, - 1,1).

Part (a): the center is at the origin and the covariance matrix V is the identity matrix I. The squared radius to be minimized is ρ2 = Tr(V) - u'Vu + c'c = 2 + c'c, under the constraints u'c = 0 and u'u = 1, with γ = 2c = T- 1X'b. The absolute minimum at c = 0 and ρ2 = 2 will be valid under the condition that the four equations u'Biu = γ'xi = 0 are indeed satisfied for some unit vector u. Then, u'Biu = Tr(Vi - V) - u'(Vi - V)u, i.e. u'Biu = xi'xi - 3 - (u'xi)2 + 1 = 1 - (u'xi)2. The solutions u are such that u'xi = 1 or u'xi =  - 1, which is written in matricial form Xu = δ, where δ is a vector with each of its four component taking independantly the value 1 or the value - 1, and δ'δ = 4. So, u = T- 1X'δ = X'δ / 4 and u'u = 1. We deduce that the set of solution unit vectors u reduces to the set of the canonical base vectors and their opposite. The rest of the proof of part (a) is trivial.

Part (b): the squared radius to be maximized is still ρ2 = 2 + c'c. Noticing that XX' / 4 is the centering operator I - 11' / n, where I is now the identity matrix of size n = 4 and [formula] is the vector having its four components equal to 1, c'c = b'XT- 2X'b / 4 = b'b / 16. From (4), and because u'Biu = 1 - (u'xi)2, we have [formula]. After expansion: c'c = [1 - (u41 + u42 + u43)] / 2. The orthogonality constraint reduces to [formula]. Either u1 or u2 or u3 is null. We solve the optimization problem in respect to the unkown vector (u21,u22,u23)', which describes the boundary of the equilateral triangle having the three canonical base vectors as extreme points. The norm of this latter unknown vector is minimized when its extremity lies on the mid of any of the side of the equilateral triangle: u21 = 1 / 2,u22 = 1 / 2,u23 = 0, or u21 = 1 / 2,u22 = 0,u23 = 1 / 2, or u21 = 0,u22 = 1 / 2,u23 = 1 / 2. Thus the unit solutions vectors u are in the directions of the edges and the maximal radius is 3 / 2. Note that minimizing c'c let to retrieve the canonical base vectors as solutions, reproving part (a).

The results of theorem 1 are in agreement with those in [\cite=Brandenberg2006] [\cite=Devillers2003] [\cite=Maehara2010] and with those for equifacial tetrahedra [\cite=Brandenberg2004] [\cite=Theobald2003], although the proof given here differs from the previously published ones.

Returning to the case of the general tetrahedron, it is pointed out that we are seeking for an unknown direction rather than for an unit vector, so that the normalization condition can be weakened. The leading term u'u in (6) permits to write F as an homogeneous quartic to be minimized under the orthogonality constraint γ'u = 0. When this orthogonality constraint is satisfied by some vector u, it is still satisfied by any vector colinear to u, and when the gradient of the homogeneous quartic vanishes for some vector u, it vanishes again for any vector colinear to u. So, any non null vector u got during the Newton iterations can be renormalized without affecting the convergence of the iterative process. Such technique was successfully used in a minimal variance computation encountered in the geometric docking problem [\cite=Petitjean2002] [\cite=Petitjean2004]. Some other practical implementation details follow. Random starting unit vectors are generated from an isotropic distribution. At the iteration k, the Lagrangians values are computed to minimize the norm of the full gradient of F. Then the Newton step sk =  - αkH- 1kgk is computed, where gk and Hk are respectively the gradient of F at uk and its Hessian at uk, and αk is a positive real, which is usually set to 1 when the quadratic convergence is achieved (see also the discussion at the end of the paper). However the resulting vector uk + sk does not satisfy anymore to the constraints. The orthogonality condition can be restored via solving the minimization problem

Min{s}(s - sk)'(s - sk), subject to gk's < η, and to uk + 1γk + 1 = 0 (7)

The parameter η in the first constraint is set to ensure that, using a first order approximation, there is a sufficient decrease of F. For that, we should impose a negative value to gk's, and we simply set η = gk'sk. But solving (7) needs a costly extra work due to the orthogonality constraint. Thus, we expand the expression of the orthogonality constraint and we approximate it to the first order of the unknown s. The modified constrained minimization problem (7) is solvable analytically, and the Newton step s is computed at low cost. Then, as mentioned above, the normalization constraint is restored via setting ||uk + 1|| = 1.

Our implementation of the solver was programmed in f77 with double precision (i.e. 64 bits) floating numbers. The termination criterion was |cos(u,c)|  ≤  10- 10 and |(Fk + 1 - Fk)| / (Fk + 1 + Fk)  ≤  10- 10. Alternate termination criterions may consider the norm of the gradient, the norm of the Newton step s, etc.

Thousands of random tetrahedra were generated from various probability laws, including quasi-flat and quasi-linear sets. The implementation of the Newton method appeared to be effective for most random initial unit vectors. In fact, for most tetrahedra, the convergence was observed for all initial vectors. In the worst situations, reducing significantly the length of the Newton step at each iteration before restoring the orthogonality constraint and operating with 100-250 initial values suffice to overcome the problem of convergence failure and to observe a significant number of times the convergence. Anyway, there may be several locally minimal radius cylinders enclosing a tetrahedra, and the upper bound of the number of local minima has been shown to be 9 [\cite=Devillers2003]. So, we indeed needed to operate with a sufficient number of random initial unit vectors.

A typical example is the regular tetrahedron x1' = (1,1,1), x2' = (1, - 1, - 1), x3' = (1, - 1,1), x4' = ( - 1, - 1,1). Two locally minimal radii were found: ρ = 1.41421356 and ρ = 1.50000000. Among the 100 performed minimizations, the smallest radius was found 32 times and the other one was found 68 times. The numbers of iterations ranged from 4 to 35, with a mean value around 9.7. The axis of the cylinder associated to the smallest radius is in agreement with the one given in theorem 1. We observed that the other radius corresponds to the six unit vectors in the six respective directions defined by the edges of the tetrahedron, for which the calculated value is indeed ρ = 3 / 2.

5. The circumscribed cylinder problem

Here we set n = 5. The convex hull of the 5 points is either a tetrahedron with one of the 5 points lying in its interior, or a trigonal bipyramid. Falling in this latter configuration is a necessary condition of existence of the circumscribed cylinder, but it does not suffice. According to (4), we must find the zeroes of the system (8) of 6 unknowns c and u

u'Biu = 2c'xi , i = 1,...,5; u'c = 0; u'u = 1 (8)

The system (8) contains only 6 independant equations because the 5 first ones are dependant (sum to zero). Again, the radius is computed from c and u and the center c = γ / 2 is computed according to (5):

ρ2  =   = Tr(V) - u'Vu + c'c

γ = T- 1X'b, bi = u'Biu

Thus, reporting the expression of c in some linear combination t of the 5 first equations of (8) lead to a system of only 3 equations of 3 unknowns, i.e. the components of u. We define the vector [formula] as a vector having its 5 components equal to 1. X being centered and of full rank, there is only one direction orthogonal to the 4-dimensional subspace defined by the the three independant columns of X and the vector [formula], this latter being itself orthogonal to each of the 3 columns of X, i.e. [formula]. We set the linear combination t to follow this unique direction, and we conventionnally normalize t't = n, and a plus sign is arbitrarily attributed to the component of t having the largest absolute value. In other words, the computation of t needs that we perform a Gram-Schmidt orthogonalization of the columns of X and of the vector [formula]. Alternatively, an adequate rotation can be made so that X is positioned in its principal components set of axis (i.e. T = X'X is diagonal), so that the columns of X and the vector [formula] are all orthogonal, thus providing an easy way to compute t.

Having X't = 0 means that [formula]. Then we define the matrix [formula], and we consider the system (9) issued from the linear combination t of the 5 first equations of (8):

u'Mu = 0; u'c = 0; u'u = 1 (9)

This system, where c is a quadratic function of u, has three equations of three unknowns. It is valid if and only if M is not null.

Theorem 2. X being full dimensional, the matrix M is null if and only if two points are identical.

Proof. We assume [formula]. We have [formula], and so, [formula]. Because Tr(M) = 0, we have also [formula] and thus [formula]. We define the diagonal matrix Θ with its diagonal element Θi,i = ti, i = 1,...,5. Then, X'ΘX = 0, so that we can write the matrix product

[formula]

The result of the matrix product above is a square matrix which cannot be of full rank because it is the product of a 6 columns and 5 lines matrix by its transposed. Because X is of full rank, the block [formula] must have at least one null eigenvalue. So, there is some vector ω such that ω'X'Θ'ΘXω = 0, and so ΘXω = 0. We set X1234 as the four lines array of the points x1, x2, x3, x4 , and Θ1234 as the associated diagonal submatrix of Θ, and we remark that X1234 is of full rank because if it was not, there would be some vector orthogonal to x1, x2, x3 and x4, and thus it would be orthogonal to x5 because [formula], thus implying that X is not of full rank, a contradiction. This remark stands for all the submatrices of X containing four of the five points. Now, if Θ1234 would be invertible, we would have found a vector ω such that X1234ω = 0, which is impossible, so Θ1234 is not invertible, and there at least one zero element among t1, t2, t3, t4. This conclusion is valid for all four-tuples of {1,2,3,4,5}, so that there are at least two distinct null elements among t1, t2, t3, t4,t5.

Conventionnally, we set t4 = 0 and t5 = 0 without loss of generality. From the orthogonality conditions X't = 0 and 't = 0, we have t1x1 + t2x2 + t3x3 = 0 and t1 + t2 + t3 = 0, which means that x1, x2, x3 are aligned. Assuming t1t2t3  ≠  0, x3 = (t1x1 + t2x2) / (t1 + t2) and expanding the expression of M = t1x1x1' + t2x2x2' + t3x3x3' leads to M = t1t2(x1 - x2)(x1 - x2)' / (t1 + t2). The assumption M = 0 would imply here that x1 = x2 = x3, which is impossible due to the full dimensionnality of X. So, t1t2t3 = 0, and we must assume that a third element of t is null. We set conventionnally t3 = 0, and we have both t1 + t2 = 0 and t1x1 + t2x2 = 0, meaning that x1 = x2 because t is not null by definition, and M is indeed null.

Conversely, we consider a full rank set such that two points, say 1 and 2, are identical. The unique direction t is colinear to (1, - 1,0,0,0) and thus M = 0.

Having two identical points means that in fact we face to the four points problem, and this situation was considered in section 4. It may also be considered that suppressing the equation u'Mu = 0 lead to an underdetermined system, and so the problem of finding the zeroes of a function should be transformed in an optimization problem where the radius of the cylinder is to be minimized. Anyway, we further assume that we have never two identical points.

Theorem 3. The set of solutions of (8) and the set of solutions of (9) are equal.

Proof. Obviously, the set of solutions of (8) is included in the set of solutions of (9). In order to ensure that the solutions of (9) satisfies to (8), we should check that they indeed satisfy to the five equations u'Biu = 2c'xi, i = 1,...,5, or, in matricial form, b = 2Xc. We recall that the center is computed from γ = 2c = T- 1X'b, with bi = u'Biu, i = 1,...,5. The 5-dimensional vector b can be decomposed in the basis of 5 independant vectors build with the 3 columns of X and the vector [formula] and the vector t, i.e. b = 2XβX  +  β1  +  βtt, where βX contains the three coefficients associated to the columns of X and β1 and βt are the coefficients associated respectively to [formula] and t. The sum of the five Bi is null, thus 1'b = 0 and so β1 = 0. From u'Mu = 0 we have [formula]. Thus, 2t'XβX  +  βtt't = 0, from which βt = 0 because t'X = 0. So, b is indeed a linear combination of the columns of X, i.e. b = 2XβX. The computed center is 2c = T- 1X'b, so βX = c and indeed b = 2Xc. Remark: the assumption M  ≠  0 was not used in the proof above.

Lemma 1. There are at most 6 cylinders circumscribed to 5 points.

Proof. The homogeneous polynomial equations u'Mu = 0 and u'c = 0 in the system (9) define the intersection of two curves in the projective plane of respective degrees 2 and 3. The normalization condition u'u = 1 is just a practical way to avoid a null vector u, and in fact all non null vectors colinear to a solution u at the intersection of u'Mu = 0 and u'c = 0 define the same intersection and lead to the same cylinder. So, applying Bezout theorem shows that we should have at most 6 cylinders passing through 5 points. This result was already proved in [\cite=Devillers2003] via an other method.

Lemma 2. There is no cylinder circumscribed to 5 points when either M or - M is positive definite.

Proof. Obvious from u'Mu = 0.

The matrix [formula], characterizes a quadric surface. Except in the particular situation where an eigenvalue of M vanishes, the surface u'Mu = t'b = 0, i.e. [formula], is an elliptical cone. The cubic surface is u'γ = 0, with [formula].

Solving the system (9) can be reduced to an one unknown problem. We assume without loss of generality that the data set is rotated to have M being diagonal with eigenvalues μ1  ≥  μ2  ≥  μ3. The case μ1μ3 > 0 was proved to correspond to no circumscribed cylinder and the case μ1  =  μ3 = 0 was proved to correspond to an infinite number of cylinders (four points problem).

The equations u'Mu = 0 and u'u = 1 define a linear system of two equations of the the three squared components of u. One of the components u1 or u2 or u3 is taken as the unknown parameter, and the expressions of the two other components are reported in u'γ = 0. Due to the free choice of the signs of these two other components, we have in fact four one unknown equations to solve. Assuming that we performed the rotation above and that the eigenvalues of M are separated, the relations between the components of u are

u22 = (u21(μ3  -  μ1) - μ3) / (μ2  -  μ3)u23 = (u21(μ1  -  μ2) + μ2) / (μ2  -  μ3)

u21 = (u22(μ3  -  μ2) - μ3) / (μ1  -  μ3)u23 = (u22(μ2  -  μ1) + μ1) / (μ1  -  μ3)

u21 = (u23(μ2  -  μ3) - μ2) / (μ1  -  μ2)u22 = (u23(μ3  -  μ1) + μ1) / (μ1  -  μ2)

The components of u must be in [0;1], but from the relations above we get tighter bounds for the unknown component to be selected. When μ2  ≥  0:

0  ≤  u21  ≤  1 - μ1 / (μ1  -  μ3)

0  ≤  u22  ≤  1 - μ2 / (μ2  -  μ3)

μ2 / (μ2  -  μ3)  ≤  u23  ≤  1 + μ3 / (μ1  -  μ3)

And when μ2  ≤  0:

-  μ2 / (μ1  -  μ2)  ≤  u21  ≤  1 - μ1 / (μ1  -  μ3)

0  ≤  u22  ≤  1 + μ2 / (μ1  -  μ2)

0  ≤  u23  ≤  1 + μ3 / (μ1  -  μ3)

When either μ1  =  μ2 or μ2  =  μ3, some of the relations and intervals above are invalid. The case μ1  =  μ3 is such than there is no cylinder to find, either because M or - M is positive definite, or because M = 0 and we have a four points problem. Outside these situations, we can always retain u2 as the unknown parameter. Whatever unknown we select, either u1, u2 or u3, the resulting function is not a polynomial.

Theorem 4. The system (9) can been solved via extracting the real roots of a polynomial of degree at most equal to 6.

Proof. Having rotated the set so that M is diagonal, we rotate it again around the second eigenvector of M with an angle α2 to be specified.

u'Mu  =  u21(μ1 cos 2(α2) + μ3 sin 2(α2))  +  u22μ2  +  u23(μ1 sin 2(α2) + μ3 cos 2(α2))

-  2u1u3sin(α2)cos(α2)(μ1  -  μ3)

We consider the general case where μ1μ3 < 0. The case where μ1μ3 = 0 and either μ1  ≠  0 or μ3  ≠  0 will be considered later.

We select α2 so that μ1 sin 2(α2) + μ3 cos 2(α2) = 0, i.e. [formula]. The quadric becomes a parabola in the projective plane defined by the coordinate u1.

[formula] (10)

[formula] (11)

Reporting u3 / u1 in the expression of the cubic curve in the projective plane leads to a polynomial of degree six in u2 / u1, which has at most 6 real roots. We deduce u3 / u1 from (11) and then we have the direction of u. So we get at most 6 cylinders.

The existence of solutions such that u1 = 0 should be checked. When μ2  ≠  0, we deduce from (10) that u2 = 0, and hence u' = (0,0,  ±  1) should satisfy to u'γ = 0, so that the coefficient of u33 in the cubic form is null. If the solution u' = (0,0,  ±  1) is indeed found, the other ones found in the projective plane from (11) are such that the curve defined from u'γ = 0 degenerates to a quintic of u2 / u1 and we cannot expect more than 5 real roots, i.e. there are at most 6 cylinders.

When μ2 = 0, the homogeneous cubic of u2 and u3 offers at most 3 real roots when solved either in u2 / u3 or u3 / u2 (u2 and u3 cannot be both null). The solutions other than u' = (0,u2,u3) found in the projective plane from (11) are such that the curve defined from u'γ = 0 is a cubic of u2 / u1 and we expect at most 3 real roots, i.e. there are at most 6 cylinders.

We consider now the case where μ1μ3 = 0 and either μ1  ≠  0 or μ3  ≠  0. Selecting α2 = 0 so that M is diagonal, we have μ1u21  +  μ2u22  +  μ3u23 = 0. When μ2  ≠  0, there is only one potential solution which is either u' = (0,0,  ±  1) or u' = (  ±  1,0,0). When μ2 = 0, either u1 = 0 when μ1  ≠  0 or u3 = 0 when μ3  ≠  0. When μ1  ≠  0, u'γ is an homogeneous cubic of u2 and u3 which offers at most 3 roots when solved either in u2 / u3 or u3 / u2 (u2 and u3 cannot be both null), so that we expect at most 3 cylinders. A similar conclusion is got when μ3  ≠  0.

In any case, the system (9) can be solved by finding the roots of a polynomial of degree at most 6, and we cannot get more than 6 cylinders, which redemonstrates lemma 1.

6. An example of trigonal bipyramid with a symmetry axis of order 3

We present the case of a bipyramid [formula] symmetric around its equilateral triangular basis with a symmetry axis of order 3 orthogonal to the triangular basis. We set x1' = (0,0,h), x2' = (0,0, - h), x3' = (1,0,0), [formula], [formula]. The set is centered.

[formula]

[formula]

[formula]

So, there is no circumscribed cylinder when [formula]. We assume [formula].

[formula]

[formula]

[formula]

[formula]

b1 = b2 = 3(2h2 - 2 + u21 + u22) / 10

b3 = (4 - u21(4h2 + 7) + u22(3 - 4h2)) / 10

[formula]

[formula]

[formula]

Solving u'Mu=0 with u'γ = 0, i.e. (2h2 + 1)(u21 + u22) = 2 and u1(u21 - 3u22) = 0 leads to the six desired directions u and we easily deduce Theorem 5 below.

Theorem 5. (a) The symmetric bipyramid [formula] of interapex half-height h has no circumscribed cylinder when [formula]. (b) When [formula], [formula] has six circumscribed cylinders. The axis are in the directions [formula], which intersect at c' = (1 / (4h2 + 2),0,0), plus their rotated images of respective angles 2π / 3 and 4π / 3 around the interapex symmetry axis of order 3. All six cylinders have radius ρ = (4h2 + 1) / (4h2 + 2).

Neither the condition of existence of the cylinders circumscribed to [formula] nor their analytical calculations seem to be previously reported in the literature. They are mainly consequences of Theorem 3 and Lemma 2, which themselves cannot be trivially deduced from existing results in cited papers and provide a simpler approach to the circumscribed cylinder problem in E3.

7. Discussion and conclusion

Some results in this work were already available in previous papers such as [\cite=Brandenberg2004] [\cite=Devillers2003] [\cite=Theobald2003]. We had clearly mentioned these references at the appropriate places. Since these results are obtained here via different techniques and add both to the clarity and the self-content character of the paper, we left them. Having said that, we recall that several novelties are introduced in this paper. First, formulating the problems through variance minimizations led us in the three-dimensional case to the original systems (6) and (9), which offer particularly simple expressions of the unknown axis u. It means that iterative numeric solvers need only random 3-tuples, and can be programmed by most users having some knowledge of constrained optimization, without needing to install specialized mathematical packages.

In the case of the circumscribed cylinder to five points, we produced a simple and new condition of existence of the cylinder relying on the eigenvalues of the matrix M in section 5. This matrix and its properties were yet unpublished. The explicit expressions of the polynomials of one variable at the end of section 5 are original, too. However, we found easier to programme directly the solver of (9) rather than seeking for the roots of the one variable polynomials. It was just an arbitrary developper's choice. Then, the third reviewer of this paper mentioned that the presence of square roots in the polynomials could be penalizing, and thus particular methods such as [\cite=Eigen2005] could be used.

Finally, the original analytical solution for the symmetric bipyramid in section 6, which relies on the explicit calculation of the matrix M, is outlined.

By no way we claim that the original present approach is better than the previous ones, such as in [\cite=Devillers2003], and the present software, named CYL, downloadable for free at , is neither claimed to offer the best possible implementations of the methods nor is claimed to work better than other cylinder computation softwares. Moreover, the second reviewer informed us that the algebraic approach in [\cite=Devillers2003] could guarantee the result, although our solver (see in particular section 4) cannot offer this guarantee for all datasets, despite the encouraging results we got.

It would have been of high interest to compare our practical experiment results with those of existing methods such as the algebraic method in [\cite=Devillers2003]. But, apart for the regular tetrahedron (detailed numerical results at the end of section 5), and for the bipyramid in section 6, we found only one public dataset, mentioned in [\cite=Watson2006]: we retrieved the optimal radius of the 12 points set minimal enclosing cylinder computed in [\cite=Watson2006] with all significant digits.

We propose to those readers who have access to some cylinders computation software, to exchange with us any data and practical experimentation results they like.

Acknowledgements I thank the three reviewers for having taken time to analyse this work, and I am particularly grateful to the third reviewer who did pertinent remarks about computational details and provided ref. [\cite=Eigen2005].