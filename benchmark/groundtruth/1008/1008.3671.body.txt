Lemma Corollary Example Proposition

Rational Distances with Rational Angles

Introduction

A famous problem of Erd os from 1946 [\cite=Erdo46] concerns the maximal number of unit distances among n points in the plane; we will denote this number by u(n). He showed that u(n) > n1 + c /  log  log n, using a [formula] piece of a scaled integer lattice, and conjectured that this was the true magnitude. The best known upper bound is u(n) < cn4 / 3, first proved by Spencer, Szemerédi and Trotter in 1984 [\cite=Spen84]. This bound has several other proofs, the simplest of which was the proof by Székely [\cite=Szek97], using a lower bound for the crossing number of graphs. A recent result of Matouek [\cite=Mato11] shows that the number of unit distances is bounded above by cn log n log  log n for most norms. As a general reference for work done on the unit distances problem, see [\cite=Bras06].

We will show that the upper bound [formula] holds if we only consider unit distances that have rational angle, by which we mean that the line through the pair of points makes a rational angle in degrees with the x-axis (or equivalently, its angle in radians, divided by π, is rational). Under this restriction, we can use an algebraic theorem of Mann [\cite=Mann65] to get a uniform bound on the number of paths between two fixed vertices in the unit distance graph, which will lead to a contradiction if there are too many unit distances with rational angle between the points.

In fact, our proof also shows that the bound [formula] holds for the number of rational distances with rational angles, if we have no three points on a line. The lower bound, n1 + c /  log  log n, of Erds does not apply in this case as we are restricted to rational angles. But a construction of Erds and Purdy gives a superlinear lower bound for unit (and hence rational) distances with rational angles.

If instead we allow up to nα points on a line where 1 / 2  ≤  α  ≤  1, the number of rational distances with rational angles is bounded by 4n1 + α. This bound is tight up to a constant factor with the lower bound now coming from an n1 - α  ×  nα square grid. If we allow up to nα points on a line where 0 < α < 1 / 2, the number of rational distances with rational angles is bounded above by [formula]. We get a lower bound of cn1 + α from n1 - α horizontal lines each containing nα rational points so that no three points on different lines are collinear.

In Section [\ref=sec:main] we will state our main results and give an outline of the proof. Section [\ref=sec:mann] contains the algebraic tools that we will use, including, for completeness, a proof of Mann's Theorem. In Section [\ref=sec:graph] we use the bounds obtained from Mann's theorem and some graph theory to prove our main results. In Section [\ref=sec:lower] we give lower bounds for the main results.

Main Results and Proof Sketch

We will say that a pair of points in [formula] has rational angle if the line segment between them, viewed as a complex number z  =  reπiγ, has [formula]. Our first result is the following.

Given n points in [formula], the number of pairs of points with unit distance and rational angle is at most [formula].

Roughly speaking, our proof goes as follows. Given n points in the plane, we construct a graph with the points as vertices, and as edges the unit line segments that have rational angle. We can represent these unit line segments as complex numbers, which must be roots of unity because of the rational angle condition. Then if this graph has many edges, it should have many cycles of a given length k, and each such cycle would give a solution to the equation

[formula]

with ζi a root of unity. Using an algebraic theorem of Mann from 1965 [\cite=Mann65], we could give a uniform bound on the number of such solutions, depending only on k (under the non-degeneracy condition that no subsum vanishes). If the number of non-degenerate cycles goes to infinity with n, this would give a contradiction.

However, dealing with cycles of arbitrary length is not so easy, so instead in our proof we count non-degenerate paths (which we will call irredundant paths) of length k between two fixed vertices, which correspond to solutions of the equation

[formula]

where [formula] corresponds to the line segment between the two points. We have extended Mann's theorem to this type of equation, giving a similar upper bound and proving our result.

In fact, in our proof it turns out that it is not necessary for the lengths to be 1, but that they only need to be rational. This is because our extension of Mann's theorem also works for equations of the type

[formula]

where [formula] and [formula]. This leads to the following results.

Suppose we have n points in [formula], no three of which are on a line. Then the number of pairs of points with rational distance and rational angle is at most [formula].

The constant 6 in this theorem and the next is not optimal, but is the smallest integer that followed directly from our proof.

Suppose we have n points in [formula], with no more than nα on a line, where 0 < α < 1 / 2. Then the number of pairs of points with rational distance and rational angle is at most [formula].

Suppose we have n points in [formula], with no more than nα on a line, where 1 / 2  ≤  α  ≤  1. Then the number of pairs of points with rational distance and rational angle is at most 4n1 + α.

Mann's Theorem

For completeness we provide a proof of Mann's Theorem. We then prove the extension that we will need to prove the main result in the next section.

Suppose we have

[formula]

with [formula], the ζi roots of unity, and no subrelations [formula] where [formula]. Then

[formula]

for all i,j, with [formula].

We can assume that ζ1 = 1 and a1 = 1, so that we have [formula]. We take a minimal m such that ζmi = 1 for each i. We will show that m must be squarefree, and that a prime p that divides m must satisfy p  ≤  k. Together these prove the theorem. Let p be a prime dividing m. Write m  =  pj  ·  m* with (p,m*)  =  1, and use that to factor each ζi as follows:

[formula]

with ρ a primitive pjth root of unity so

[formula]

Now reorganize the equation as follows:

[formula]

where the coefficients are of the form

[formula]

with [formula]. So f is a polynomial over the field K of degree ≤  p - 1 and f(ρ) = 0. The polynomial f is not identically zero, since that would give a subrelation containing strictly fewer than k terms. To see this, observe that we must have σi  ≥  1 for at least one i, otherwise ζm / pi = 1 for each i, contradicting the minimality of m. But we can compute the degree of ρ over K to be

[formula]

This is a contradiction unless j = 1, which proves that m is squarefree. Knowing that m is squarefree, we have m  =  p  ·  m* with (p,m*) = 1, and

[formula]

Still f(ρ) = 0 for f(x) a polynomial over K, not identically zero. But we know ([\cite=Lang94], Ch. VI.3) that the minimal irreducible polynomial of ρ over K is [formula], hence we must have f(x)  =  cF(x) for some c∈K. In particular, f has p terms, which implies that our original relation had at least p terms, so k  ≥  p.

Suppose we have

[formula]

with [formula], [formula], roots of unity ζi, and no subrelations [formula] or [formula] where [formula] and [formula]. Then for any ζ*j there is a ζi such that

[formula]

with [formula].

We have [formula], which gives the single equation

[formula]

Mann's Theorem does not apply immediately, because there might be subrelations. But we can break the equation up into minimal subrelations

[formula]

where each [formula], [formula], and there are no further subrelations. Given ζ*j, there is such a minimal subrelation of length ≤  2k in which it occurs, and which must also contain some ζi. Applying Mann's Theorem to this equation gives [formula] with [formula].

Note that in the above proof we require a  ≠  0. If a = 0 and there is no proper subrelation as in [\eqref=eqn:sum2] then [\eqref=eqn:sum1] still has the subrelations

[formula]

so we cannot use Mann's Theorem to get a relation between a ζi and ζ*j.

For [formula] we define Zka to be the set of k-tuples of roots of unity [formula] for which there are [formula] such that [formula] with no subrelations, i.e.:

[formula]

Let [formula]. Given [formula], |Zka|  ≤  (k  ·  C(k))k.

Fix an element [formula] and let m  =  C(k) and Mi  =  ζ- mi for 1  ≤  i  ≤  k. Then for ζ*j in any element of Zka, we have an i such that [formula]. In other words ζ*j is a solution of Mixm  =  1. Each of these k equations has m  =  C(k) solutions, hence there are at most k  ·  m  =  k  ·  C(k) choices for each ζ*j.

Rational Distances and Mann's Theorem

We are now in a position to prove the main results. Suppose we have a graph G = G(V,E) on v(G) = n vertices and e(G) = cn1 + α edges. We will denote the minimum degree in G by δ(G). The following lemma assures us that we can remove low-degree vertices from our graph without greatly affecting the number of edges.

Let G be as above. Then G contains a subgraph H with e(H) = (c / 2)n1 + α edges such that δ(H)  ≥  (c / 2)nα.

We iteratively remove vertices from G of degree less than (c / 2)nα. Then, the resulting subgraph H has δ(H)  ≥  (c / 2)nα and we removed fewer than (c / 2)n1 + α edges so H contains more than (c / 2)n1 + α edges.

Note that the subgraph H constructed above contains at least v(H) = (c / 2)nα vertices.

Suppose we are given a path on k edges [formula]. We call this path irredundant if

[formula]

for any [formula].

Let G be the graph with the n points in the plane as vertices and the rational distances with rational angles between pairs of points as edges. Suppose there are n1 + f(n) such distances for some positive function f. Then e(G) = n1 + f(n). We will count the number of irredundant paths Pk in G, for a fixed k that we will choose later. By Lemma [\ref=lem:minDeg] we can assume that e(G)  ≥  (1 / 2)n1 + f(n),v(G)  ≥  (1 / 2)nf(n) and δ(G)  ≥  (1 / 2)nf(n).

The number of irredundant paths Pk starting at any vertex v is at least

[formula]

since, if we have constructed a subpath [formula] of Pk, then at most [formula] of the at least δ(G) continuations are forbidden. Thus the total number of irredundant paths Pk is at least

[formula]

if 2k  ≤  (1 / 2)nf(n), which is true as long as k  <  f(n) log n /  log 2. It follows that there are two vertices v and w with at least

[formula]

irredundant paths Pk between them. We will call the set of these paths Pvw, so that we have |Pvw|  ≥  nkf(n) - 1 / 4k.

Given Pk∈Pvw, [formula], consider the k-tuple [formula] where ζi is the root of unity in the direction from pi - 1 to pi, i.e. [formula]. Note that [formula], because Pk is irredundant. Since there are no three points on a line, this process gives an injective map from Pvw to Zka so |Pvw|  ≤  (k  ·  C(k))k by Corollary [\ref=cor:bound]. Thus

[formula]

But this gives

[formula]

The term log (C(k)) is the log of the product of the primes less than or equal to 2k. This is a well known number-theoretic function called the Chebyshev function and denoted by ϑ, specifically ϑ(2k) =  log (C(k)). We use the following bound on ϑ (for a proof see [\cite=Apos76]):

[formula]

This gives

[formula]

Let k be an integer such that f(n) log n / 18  <  k  <  f(n) log n / 14, (possible since otherwise f(n)  =  O(1 /  log n) giving nf(n)  =  O(1)). Then the condition that k < f(n) log n /  log 2 is clearly satisfied, and we get

[formula]

This completes the proof.

In the statement of Theorem [\ref=thm:unit], the requirement that there are no three points on a line is unnecessary. This is because, from any point, there is only one unit distance in any direction. Thus we can apply the same proof as in Theorem [\ref=thm:rat] to Theorem [\ref=thm:unit] without having to worry about multiple points on a line. Thus we also have a proof of Theorem [\ref=thm:unit].

Consider a path [formula]. If the distance from pi - 1 to pi is less than the distance from pi - 1 to any vertex on the line connecting pi - 1 and pi and not in [formula] then Pk is called a shortest path.

This proof is almost the same as the proof of Theorem [\ref=thm:rat] except that instead of considering all irredundant paths Pk, we only consider shortest irredundant paths. Suppose there are n1 + α + f(n) edges in the rational distance graph. Since there are at most nα points on a line, we get that from any vertex v there are at least

[formula]

shortest irredundant paths Pk, if k  <  f(n) log n /  log 2. For any two vertices v,w let Pv,w be the set of shortest irredundant paths Pk between v and w. Then there are two vertices v,w such that the number of shortest irredundant paths between v and w is at least

[formula]

By Mann's Theorem, since we are looking at shortest irredundant paths, |Pv,w|  ≤  (k  ·  C(k))k. Let k be an integer such that f(n) log n / 18  <  k  <  f(n) log n / 14. Then

[formula]

Assume we have a configuration of n points with at most nα on a line, [formula], and n1 + α  +  f(n) rational distances with rational angles, for some positive function f(n).

The graph G on these points has e(G) = n1 + α + f(n). By Lemma [\ref=lem:minDeg] we can assume that e(G)  ≥  n1 + α + f(n) / 2, v(G)  ≥  nα  +  f(n)  /  2 and δ(G)  ≥  nα + f(n) / 2. We now count irredundant paths P2 of length 2. Note that an irredundant path on two edges is just a noncollinear path.

For any vertex v, since we have at most nα points on a line, v is the midpoint of at least

[formula]

paths P2 if f(n)  ≥   log 4 /  log n (if f(n)  <   log 4 /  log n then nf(n)  <  4, completing the proof.) Thus there are two vertices v and w with at least (1 / 8)n2(α + f(n)) - 1 noncollinear paths P2 between them.

But by Corollary [\ref=cor:bound] there is a constant number of directions from each of v and w. Since we are looking at noncollinear paths P2, the direction from v and the direction from w uniquely determine the midpoint for a path P2. Thus there are at most (k  ·  C(k))k = 144 noncollinear paths P2 between v and w, since k = 2.

Putting the upper and lower bounds together we get that n2(α + f(n)) - 1  ≤  2732. This gives

[formula]

since α  ≥  1 / 2. But this gives nf(n)  <  4, completing the proof.

Lower Bounds

In this section we give lower bounds for the theorems given in Section [\ref=sec:main].

The bounds in Theorems [\ref=thm:unit] and [\ref=thm:rat] are not far from optimal as the following construction of Erds and Purdy [\cite=Erdo76] shows.

Suppose we have n points, no three on a line, with the maximum possible number of unit distances with rational angles; we call this number f(n). Consider these points as the set [formula] of complex numbers. For any [formula] with |a| = 1, a  ≠  zi - zj for any i  ≠  j, the set [formula] contains at least 2f(n) + n unit distances since there are f(n) amongst each of the sets [formula] and [formula] and |zi - (zi + a)| = 1 for each i. This new set may have three points on a line, but we show that we can choose a appropriately so this is not the case.

Consider a pair of points zi and zj. For each zk, the set of points {zk + a:|a| = 1} intersects the line through zi and zj in at most two points. So there are at most two values of a that will give three points on a line. There are [formula] pairs of points and n choices for zk so there are at most [formula] values of a that make a point zk + a collinear with two points zi and zj. Similarly we have n2(n - 1) values of a that make a point zk collinear with two points zi + a and zj + a. Thus there are only finitely many values of a that give three points on a line. There are infinitely many choices for a so we are done.

This shows that f(2n)  ≥  2f(n)  +  n for n  >  2 and clearly f(2) = 1. From this we get that f(2k)  ≥  2k - 1(k - 1) = 2k - 1 log 2(2k - 1). Taking 2k  ≤  n  <  2k + 1 we get that f(n)  ≥  cn log n for all n. This construction gives a lower bound for Theorems [\ref=thm:unit] and [\ref=thm:rat].

The bound in Theorem [\ref=thm:rat3] is not far from optimal. In fact we can get a lower bound of cn1 + α. Consider n1 - α lines parallel to the x-axis, and choose nα rational points on each line such that no three points on different lines are collinear (this can always be done since there are infinitely many rational points to choose from). There are cn2α rational distances on each horizontal line and n1 - α such lines giving at least cn1 + α rational distances with rational angles (all the angles are zero).

The bound in Theorem [\ref=thm:rat2] is tight up to a constant factor as can be seen by considering an n1 - α  ×  nα square grid. Then there are at least cn2α rational distances on each of the n1 - α horizontal lines in the grid containing nα points. This gives at least cn1 + α rational distances with rational angles (the angles are all zero).

Acknowledgment

The authors would like to thank Jirka Matouek for making us aware of the lower bound for unit distances with no three points on a line. We are indebted to the anonymous referee for helpful comments and suggestions.