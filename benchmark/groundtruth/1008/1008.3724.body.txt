Proposition Conjecture Corollary Lemma

Example

Polyhedral Representation of Discrete Morse Functions on Regular CW Complexes and Posets

Introduction and Statement of the Result

In its classical form, Morse theory is concerned with smooth functions on smooth manifolds. See [\cite=MI2] for the basics of Morse theory. In addition to the traditional smooth approach, there are a number of discrete analogs of Morse theory, two of which have been widely cited in the literature: the first, due to Banchoff, is found in [\cite=BA1], [\cite=BA2] and [\cite=BA3]; the second, due to Forman, is more recent, and is found in [\cite=FORM3], [\cite=FORM4] and subsequent papers.

Although Banchoff's and Forman's approaches are both widely cited, there does not appear to be in the literature a thorough discussion of the relation between these two approaches. Such a lack of discussion is perhaps due to the the fact that upon first encounter, the two approaches appear to be quite different. Banchoff considers finite polyhedra embedded in Euclidean space, whereas Forman considers CW complexes (not necessarily embedded). A "Morse function" for Banchoff is a projection onto a straight line in Euclidean space, whereas a "Morse function" for Forman, called a "discrete Morse function," is a map that assigns a number to each cell of a CW complex, subject to certain conditions.

Given a projection map, Banchoff defines an index at each vertices of a polyhedron, but at no other cells, whereas given a discrete Morse function, Forman defines an index for each critical cell, which could be of any dimension. Banchoff does not define the concept of critical vertices vs. ordinary vertices in [\cite=BA1], though he does do so for polyhedral surfaces in in [\cite=BA2], and we will use that approach for all dimensions. For Forman, the distinction between critical cells vs. ordinary cells is of great importance. Finally, Banchoff focuses on relating the index at vertices to polyhedral curvature, whereas Forman focuses on using critical points for the purpose of reconstructing the CW complex up to homotopy type by attaching cells.

In spite of these apparent differences, the purpose of this note is to prove that for finite regular CW complexes there is a very concrete relation between the approaches of Banchoff and Forman, as given in the following theorem. This theorem says that information about critical cells in the sense of Forman can be obtained by Banchoff's method for an appropriate embedding of the barycentric subdivision of the original finite regular CW complex. We note that in Forman's method a critical [formula]-cell p always has index p, and so the only question to be asked is whether or not a cell is critical, not what its index is.

We assume that the reader is familiar with Banchoff's approach as in [\cite=BA1], and Forman's approach as in [\cite=FORM3], though we will make use of only the first few sections of the latter paper. We need the following clarification of Banchoff's method, which is taken from [\cite=BA2]. Let K be a simplicial complex in some [formula], and let ξ∈Sm - 1 be a unit vector. In order to define the index at each vertex of K, Banchoff assumes that projection onto the line spanned by ξ is general for K, which means that it yields distinct values for any two vertices of K that are joined by an edge; this condition is true for almost all values of ξ. With that assumption, Banchoff defines an index with respect to the projection, denoted [formula], for each vertex v of K. As mentioned above, Banchoff does not define the terms critical vertex vs. ordinary vertex in [\cite=BA1]. In [\cite=BA2], however, which treats only surfaces, he defines a vertex to be critical if and only if [formula], and we will take that definition as the correct one for higher dimensions as well.

Let X be a finite regular CW complex, and let f be a discrete Morse function on X. Then for any sufficiently large [formula], and for any unit vector ξ∈Sm - 1, there is a polyhedral embedding of the barycentric subdivision of X in [formula] such that a cell in X is critical in the sense of Forman with respect to f if and only if its barycenter is critical in the sense of Banchoff with respect to projection onto the line spanned by ξ.

For the sake of brevity, we will say "discrete-critical" when we mean "critical in the sense of Forman," and "polyhedral-critical" when we mean "critical in the sense of Banchoff," and similarly for ordinary cells and vertices.

We take the barycentric subdivision of the CW complex in Theorem [\ref=thmAE] for the following reasons. First, whereas Forman's method determines whether every cell is critical or ordinary, Banchoff's method assigns such information only to the vertices, and by taking the barycentric subdivision we obtain a single vertex corresponding to each original cell. Second, the barycentric subdivision of a regular CW complex is a simplicial complex, and simplicial complexes are easier to embed in Euclidean space than more general cell complexes. Third, even if the original CW complex were a simplicial complex, we would still need to take its barycentric subdivision prior to embedding the complex in Euclidean space, because of the following simple example. Let K be a triangle together with its faces, which is a simplicial complex. The function that assigns to teach face of the triangle its dimension is a discrete Morse function, and every face is discrete-critical, as mentioned in [\cite=FORM3]*p. 108. However, for any embedding of the triangle in Euclidean space prior to barycentric subdivision, it is seen that the projection onto any appropriate line in the Euclidean space takes any point in the interior of an edge to a value lower than one of its vertices, and any such point, when taken as a vertex of a subdivision of the edge, is polyhedral-ordinary. Hence, if we want to recover the discrete-critical cells by projection onto a line in Euclidean space, we need the flexibility of first taking the barycentric subdivision prior to embedding.

Although the motivation for this note was as stated above, it turns out that the only property of regular CW complexes that is needed for the proof of Theorem [\ref=thmAE] is the fact that the set of cells of a regular CW complex form a graded poset (partially ordered set) in a natural way, and that such a poset has various nice properties. It is therefore more clear, and slightly more general, to formulate and prove our theorem in the context of posets.

We assume that the reader is familiar with basic properties of posets. See [\cite=STAN]*Chapter 3 for details. All posets are assumed to be finite. Let P be a poset. We let <   denote the partial order relation on P, and we write [formula] if b covers a, and [formula] if [formula] or a  =  b. If a∈P, we let

[formula]

The order complex of P, denoted [formula], is the simplicial complex with a vertex for each element of P, and a simplex for each non-empty chain of elements of P; it is a standard fact that such a construction yields a simplicial complex. In particular, it is always possible to compute the Euler characteristic [formula]. If C  ⊆  P is a chain (always assumed non-empty), we let l()C denote the length of the chain, which is one less than the number of elements in the chain.

A function [formula] for some [formula] is a rank function for P if it satisfies the following conditions: for a,b∈P, if a is a minimal element then ρ(a)  =  0, and if [formula] then ρ(a)  +  1  =  ρ(b). A poset is graded if it has a rank function. (There is some variation in the literature regarding the term "graded"; for example, the definition used in [\cite=STAN]*Chapter 3 is more stringent.)

We will also need the following properties of posets, one of which is the mod 2 version of graded posets, where we partly follow the terminology of [\cite=BRAN]*p. 6.

Let P be a finite poset.

The poset P is 2-wide if for any a,b,c∈P such that [formula], there is some d∈P such that d  ≠  b and [formula].

Let [formula] be a function. The function μ is a parity rank function if it satisfies the following conditions: for a,b∈P, if a is a minimal element then μ(a)  =  0, and if [formula] then 1  -  μ(a)  =  μ(b). A poset is parity-graded if it has a parity rank function.

Let [formula] be a parity rank function. The poset P is downward Eulerian if a∈P and a not minimal imply [formula].

We note that if a finite poset has a rank function, then it is unique, and similarly for a parity rank function.

Let X be a regular CW complex. Then the face poset of X, denoted P(X), is the poset that has one element for each cell of X, where the order relation is given by σ  <  τ if σ is in the boudary of τ, for cells σ and τ of X. The poset P(X) is ranked, where the rank of a cell in X is its dimension. It is a standard fact that [formula] and X have homeomorphic underlying spaces. The topological name for [formula] is the barycentric subdivision of X; if X is a simplicial complex, then [formula] is combinatorially the same as the usual barycentric subdivision of X. See [\cite=L-W] or [\cite=BJOR1] for details. The poset P(X) is 2-wide by [\cite=FORM3]*Theorem 1.2. The function that assigns each cell of X the number 0 or 1 depending upon whether the dimension of the cell is even or odd is clearly a parity rank function on P(X). The poset P(X) is downward Eulerian, because for each σ∈P(X), the interval P(X)<  σ is the set of all cells in the boundary of σ, which is a sphere, and hence has the appropriate Euler characteristic.

Although the face poset of a regular CW complex is 2-wide, has a parity rank function, and is downward Eulerian, not every poset satisfying these three properties is the face poset of a regular CW complex. For example, let P be the poset shown in Figure [\ref=figMCOM2]. The reader may verify that the three properties hold for P. However, the poset P is not the face poset of a regular CW complex, because if it were, then the interval [formula] would be the face poset of the boundary of cell m, and hence [formula] would be a sphere, and yet [formula] is not connected.

The original definition of discrete Morse functions in [\cite=FORM3] is for discrete Morse functions on CW complexes, but the same definition can be used without change for discrete Morse functions on posets.

Let P be a poset, and let [formula] be a function.

The map f is a discrete Morse function if the following condition holds: for each b∈P, there is at most one a∈P such that [formula] and f(a)  ≥  f(b), and there is at most one c∈P such that [formula] and f(b)  ≥  f(c).

Suppose f is a discrete Morse function. An element b∈P is discrete-critical with respect to f if there is no a∈P such that [formula] and f(a)  ≥  f(b), and there is no c∈P such that [formula] and f(b)  ≥  f(c); otherwise b is discrete-ordinary with respect to f.

The following lemma is a restatement for posets of Lemma 2.5 of [\cite=FORM3]; the original proofs works for posets, so we do not give it here.

Let P be a finite poset, and let [formula] be a discrete Morse function. Suppose that P is 2-wide. If b∈P, there cannot be both some a∈P such that [formula] and f(a)  ≥  f(b), and some c∈P such that [formula] and f(b)  ≥  f(c).

Lemma [\ref=lemAAZ] is not true if the assumption that P is 2-wide is dropped. For example, let P  =  {0,1,2} have the usual total order, and let [formula] be defined by f(x)  =  2  -  x for x∈P. Then f is a discrete Morse function on P, but it does not satisfy the conclusion of the lemma.

Our main theorem, to be proved in Section [\ref=secPRO], is the following.

Let P be a finite poset, and let [formula] be a discrete Morse function. Suppose that P is 2-wide, is parity-graded with parity rank function μ, and is downward Eulerian. Then for any sufficiently large [formula], and for any unit vector ξ∈Sm - 1, there is a polyhedral embedding [formula] such that the projection of [formula] onto the line spanned by ξ is general for [formula], and such that for every b∈P, the index of φ(b) with respect to this projection is given by

[formula]

By the properties of the face poset of a CW complex stated above, and using the definition of polyhedral-critical, Theorem [\ref=thmAE] is an immediate corollary of Theorem [\ref=thmAEP].

Another consequence of Theorem [\ref=thmAEP] is the following. In [\cite=FORM3]*Section 3, analogs of some fundamental results for smooth Morse functions are proved for discrete Morse functions on regular CW complexes. One such result is [\cite=FORM3]*Corollary 3.7 (ii),which is part of the Weak Morse Inequalities. We can use Theorem [\ref=thmAEP], together with [\cite=BA1]*Theorem 1, to deduce the following analogous result for posets.

Let P be a finite poset, and let [formula] be a discrete Morse function. Suppose that P is 2-wide, is parity-graded with parity rank function μ, and is downward Eulerian. For each i∈{0,1}, let

[formula]

Then [formula].

By Theorem [\ref=thmAEP], there is some [formula], some unit vector ξ∈Sm - 1, and a polyhedral embedding [formula] such that the projection of [formula] onto the line spanned by ξ is general for [formula], and such that Equation [\ref=eqAFA] holds.

For each i∈{0,1}, let

[formula]

and let

[formula]

Then

[formula]

where the third equality is by Equation [\ref=eqAFA], and the fourth equality is by [\cite=BA1]*Theorem 1.

We can now use Corollary [\ref=coroAEQ] to produce a new proof of [\cite=FORM3]*Corollary 3.7 (ii), which is restated in the following corollary.

Let X be a finite regular r-dimensional CW complex, and let f be a discrete Morse function on X. For each [formula], let Mi be the number of i-cells of X that are discrete-critical with respect to f. Then [formula].

As noted earlier, the face poset P(X) satisfies the hypothesis of Corollary [\ref=coroAEQ]. Because the parity rank function on P(X) is the result of assigning to each in X its dimension mod two, it is seen that [formula]. As mentioned previously, it is a standard fact that [formula] and X have homeomorphic underlying spaces. Hence [formula]. The desired result now follows immediately from Corollary [\ref=coroAEQ].

Our proof of Corollary [\ref=coroAER] is not shorter or simpler than the proof in [\cite=FORM3]*Corollary 3.7 (ii), because our proof relies upon the proof of Theorem [\ref=thmAEP], but our proof is nonetheless quite different from the original proof in that the former is essentially combinatorial, whereas the latter uses topological concepts such as homotopy equivalence.

Proof of the Main Theorem

We start with the following three lemmas, the first two of which are very simple, and the third of which is the bulk of our work.

Let V be a finite set with n elements, where n  ≥  1, and let [formula] be a function. Then there is a map [formula] such that ψ(V) spans an [formula]-simplex, and that for each vertex v∈V, the projection of ψ(v) onto the x-axis equals f(v).

The proof is by induction on n. If n  =  1, let v be the single element of V, and then define [formula] to be ψ(v)  =  f(v). Now suppose the result is true for n  -  1, where n  ≥  2. Let w∈V, and let V'  =  V  -  {w}. Because V' has at least one element, then by the inductive hypothesis there is a map [formula] such that φ(V') spans an [formula]-simplex, and that for each vertex v∈V', the projection of φ(v) onto the x-axis equals f(v). We can think of [formula] as sitting in [formula] in the usual way, and hence we can think of φ as a map [formula]. Let [formula] be defined by letting ψ|V'  =  φ, and letting ψ(w) be a point in [formula] with first coordinate equal to f(w), and last coordinate not equal to zero. Because ψ(w) can be joined to ψ(V'), we see that ψ(V) spans an [formula]-simplex, and it is evident by definition that for each vertex v∈V, the projection of ψ(v) onto the x-axis equals f(v).

For the next lemma, we need the following notation. Let P be a poset. If S  ⊆  P, we let [formula] denote the set of non-empty chains in S. If b,s,t∈P, and if [formula] and [formula], we let

[formula]

Let P be a poset. Suppose that P is 2-wide, is parity-graded with parity rank function μ, and is downward Eulerian. Let a,b∈P.

[formula].

If [formula], then [formula].

If [formula], then [formula].

For Part ([\ref=lemAAR1]), there are two cases. First, suppose that b is a minimal element of P. Therefore μ(b)  =  0. Also, we see that [formula], and therefore [formula]. Second, suppose b is not a minimal element. There is a bijective map from [formula] to [formula], where the map is obtained by taking each chain in the former set and removing b. This map shortens the length of each chain by 1. Using the definition of the order complex together with the definition of downward Eulerian, we have

[formula]

For Part ([\ref=lemAAR2]), we observe that

[formula]

There is a bijective map from [formula] to [formula], where the map is obtained by taking each chain in the former set and removing b. This map shortens the length of each chain by 1. We then use Part ([\ref=lemAAR1]), together with the fact that μ(a)  =  1  -  μ(b), to see that

[formula]

The proof of Part ([\ref=lemAAR3]) is similar to the proof of Part ([\ref=lemAAR2]), and we omit the details.

Let P be a poset, and let [formula] be a discrete Morse function. Suppose that P is 2-wide. Then there is a discrete Morse function g on P that satisfies the following properties. Let x,y,z,w∈P.

An element of P is discrete-critical with respect to f if and only it is discrete-critical with respect to g.

If x  ≠  y, then g(x)  ≠  g(y)

If [formula] and g(x)  <  g(y), then g(z)  <  g(y) and g(x)  <  g(w).

Let a∈P. We say that a is up-troubled (respectively short-up-troubled) with respect to f if there are x,y∈P such that [formula] (respectively [formula]) and that f(x)  <  f(y)  ≤  f(a). We say that a is down-troubled (respectively short-down-troubled) with respect to f if there are z,w∈P such that [formula] (respectively [formula]) and that f(a)  ≤  f(w)  <  f(z).

Let [formula] be a function. We say that h is a good variation of f if h is a discrete Morse function, and if an element of P is discrete-critical with respect to f if and only if it is discrete-critical with respect to h.

Step 1: We will define a good variation of f that has no short-up-troubled elements.

It is a standard result that there is a total order on the set P that is consistent with the original partial order <   on P. Suppose that such a total order has been chosen. We proceed recursively according to the total order, modifying f once for each element of P.

Let a∈P be the least element of P with respect to the total order. Then a is a minimal element with respect to <  . If a is not short-up-troubled, we do not modify f at this stage. Now suppose that a is short-up-troubled. Then there are x,y∈P such that [formula] and f(x)  <  f(y)  ≤  f(a). Observe that a and x are both discrete-ordinary with respect to f. By the definition of discrete Morse functions, we know that f(a)  <  f(z) for all z∈P such that [formula] and z  ≠  x. By Lemma [\ref=lemAAZ] we know that if b∈P and [formula], then f(x)  <  f(b). We then modify f by decreasing the value of f(a) so that it is strictly greater than f(x), and strictly less than f(b) for all b∈P such that [formula]. The modified f is a good variation of f, and a is not short-up-troubled for the modified f. To avoid cumbersome notation, we use f to denote the modified f.

Now suppose that f has been modified one element of P at a time so that the resulting function is a good variation of f, and that the first k  -  1 elements of P in the total order are not short-up-troubled. Let e∈P be the k-th element of P in the total order. If w∈P and w  <  e, then w is prior to e in the total order, and hence w is not short-up-troubled. If e is not short-up-troubled, we do not modify f at this stage. Now suppose that e is short-up-troubled. Then there are x,y∈P such that [formula] and f(x)  <  f(y)  ≤  f(e). As before, we know that that e and x are both discrete-ordinary, that f(e)  <  f(z) for all z∈P such that [formula] and z  ≠  x, and that f(x)  <  f(b) for all b∈P such that [formula].

Suppose that there is some h∈P such that [formula] and f(x)  ≤  f(h). Because P is 2-wide, there is some t∈P such that t  ≠  e and [formula]. Because f(x)  ≤  f(e), then by the definition of discrete Morse functions we know that f(t)  <  f(x). Because f(x)  ≤  f(h), we deduce that h is short-up-troubled, which is a contradiction. Hence f(d)  <  f(x) for all d∈P such that [formula].

We now modify f by decreasing the value of f(e) so that it is strictly greater than f(x), and strictly less than f(b) for all b∈P such that [formula]. By the previous paragraph, we see that the modified f is a good variation of f, and now e is not short-up-troubled; the elements of P that are less than e in the total order remain not short-up-troubled.

By recursion, we can modify f so that the resulting function is a good variation of f that has no short-up-troubled elements.

Step 2: We prove that the modified f has no up-troubled elements. Suppose to the contrary that there is some a∈P that is up-troubled. Then there are x,y∈P such that [formula] and f(x)  <  f(y)  ≤  f(a). Because a is not short-up-troubled, then [formula]. By a standard fact about finite posets, there are [formula], with q  ≥  1, such that [formula]. Without loss of generality, we may assume that a was chosen so that q is minimal for all possible up-troubled elements. This minimality implies that f(bj)  <  f(y)  ≤  f(a) for all [formula]. It follows in particular that f(b1)  <  f(a). By Lemma [\ref=lemAAZ] we see that f(b1)  <  f(b2), where we replace b2 with x if q  =  1. Because [formula] and f(b1)  <  f(b2)  <  f(a), we deduce that a is short-up-troubled, which is a contradiction.

Step 3: We will further modify f so that the resulting function is a good variation of f that still has no up-troubled elements, and will now also have no short-down-troubled elements. The modification is the same as in Step 1, except that it is upside down. The only question is whether we can perform this modification in such a way that it does not cause any elements to become short-up-troubled; if we can make sure that no element becomes short-up-troubled as a result of this modification, then by Step 2 no element will be up-troubled.

We proceed recursively, again using the total order on P given in Step 1, though this time starting from the greatest element with respect to the total order, and proceeding downward. Let q∈P be the greatest element of P with respect to the total order. Modify f analogously to the way we modified f at the least element a in Step 1, so that the modified f is a good variation of f, and q is not short-down-troubled for the modified f. This modification of f, which is done by possibly increasing the value of f(q), cannot cause q or any element that is less than q with respect to <   to become short-up-troubled, and because q is a maximal element with respect to <  , there is nothing else that could become short-up-troubled as a result of this modification.

Now suppose that f has been modified so that the resulting function is a good variation of f, that the last k  -  1 elements of P in the total order are not short-down-troubled, and that there are no short-up-troubled elements. Hence by Step 2 there are no up-troubled elements. Let u∈P be the k-th from last in the total order. If v∈P and u  <  v, then v is after u in the total order, and hence by hypothesis v is not short-down-troubled. If u is not short-down-troubled, we do not modify f at this stage. Now suppose that u is short-down-troubled. Then there are z,w∈P such that [formula] and f(u)  ≤  f(w)  <  f(z). Analogously to Step 1, we know that f(v)  <  f(u) for all v∈P such that [formula] and v  ≠  z, that f(h)  <  f(z) for all h∈P such that [formula], and that f(z)  <  f(p) for all p∈P such that [formula].

We could proceed analogously to Step 1, and modify f by increasing the value of f(u) so that it is strictly less than f(c), and strictly greater than f(h) for all h∈P such that [formula], in which case the modified f would be a good variation of f, and now u would not be short-down-troubled, and the elements of P that are greater than u in the total order would remain not short-down-troubled. However, by increasing the value of f(u) in this way, we might cause u to become short-up-troubled, and so we do not modify f yet, but rather make the following additional observation.

Suppose that there are x,y∈P such that [formula] and f(x)  <  f(y). Let r∈P be such that [formula]. Then [formula], and hence [formula]. Because r is not up-troubled, then f(r)  <  f(y). We now modify f by increasing f(u) so that it is strictly less than f(c), and strictly greater than f(h) for all h∈P such that [formula], and strictly less than f(i) for all i∈P such that there is some j∈P such that [formula] and f(j)  <  f(i). We then see that the modified f is a good variation of f, and now u is not short-down-troubled and not short-up-troubled, and the elements of P that are greater than u in the total order remain not short-down-troubled. The one remaining question is whether any element of P other than u has become short-up-troubled as a result of this modification of f. The only possible elements of P that could be become short-up-troubled as a result of increasing f(u) are elements s∈P for which there exist an element t∈P such that [formula] or [formula]; however, it is seen that in either such case, increasing the value of f(u) could not make s become short-up-troubled if were is not already such prior to increasing f(u).

By recursion, we can modify f so that the resulting function is a good variation of f that has no short-down-troubled elements and no short-up-troubled elements.

Step 4: Similarly to Step 2, it can be proved that the modified f has no down-troubled elements, as well as no up-troubled elements. Hence, the modified f satisfies Parts ([\ref=lemAD1]) and ([\ref=lemAD2]) of the lemma.

Step 5: Let q∈P. We say that q is general with respect to f if f(q)  ≠  f(x) for all x∈P  -  {q}.

We will even further modify f so that the resulting function is a good variation of f that still has no up-troubled elements and no down-troubled elements, and now also has all elements general.

As before, we proceed recursively, using the total order on P given in Step 1. Let a∈P be the least element of P with respect to the total order. We then modify f by increasing f(a) slightly, in such a way that a is general after the modification, and that nothing in f(P) is between the original value of f(a) and the new value; such a modification is possible because f(P) is finite. It is then seen that if x,y∈P are such that f(x)  <  f(y) prior to the modification, it must still be the case that f(x)  <  f(y) after the modification. It follows that no elements of P can become up-troubled or down-troubled as a result of the modification, that the modified f is still a discrete Morse function, and that if an element of P is discrete-critical prior to the modification, then it remains so after the modification. Suppose that a is discrete-ordinary prior to the modification. Because a is a minimal element with respect to <  , then it must be the case that before the modification f(a)  ≥  f(b) for some b∈P such that [formula], and hence a will continue to be discrete-ordinary after the modification. A similar argument shows that no other element of P can change from discrete-ordinary to discrete-critical as a result of the modification. Hence the modified f is a good variation of f, has no short-up-troubled elements and no short-down-troubled elements, and a is general.

Now suppose that f has been modified so that the resulting function is a good variation of f, that the first k  -  1 elements of P in the total order are general, and that there are no up-troubled elements and no down-troubled elements. Let e∈P be the k-th element of P in the total order. As before, we modify f by increasing f(e) slightly, in such a way that e is general after the modification, and that nothing in f(P) is between the original value of f(e) and the new value. Once again e is general after the modification, the modified f is still a discrete Morse function, no elements of P can become up-troubled or down-troubled as a result of the modification, and if an element of P is discrete-critical prior to the modification, then it remains so after the modification. Suppose that e is discrete-ordinary prior to the modification. First, suppose that there is some x∈P such that [formula] and f(x)  ≥  f(e) prior to the modification. Because x  <  e, then x is prior to e in the total order, and hence x is general. Therefore f(x)  >  f(e) prior to the modification, and this inequality will still hold after the modification, and hence e will remain discrete-ordinary. Second, suppose that there is some y∈P such that [formula] and f(e)  ≥  f(y) prior to the modification. Then f(e)  >  f(y) after the modification, and hence e will remain discrete-ordinary. As before, no other element of P can change from discrete-ordinary to discrete-critical as a result of the modification. Hence the modified f is a good variation of f, has no short-up-troubled elements and no short-down-troubled elements, and first k elements of P in the total order are general.

By recursion, we can modify f so that the resulting function is a good variation of f that has no up-troubled elements and no down-troubled elements, and has all elements general, which proves the lemma.

We are now ready for the proof of our main theorem.

We will show that an embedding with the desired property can be found for a single choice of [formula] and with respect to ξ being the unit vector in the direction of the positive x-axis. It will then follow immediately that an appropriate embedding can be found in [formula] for k  >  m with respect to the same ξ by using using the usual embedding of [formula] in [formula]. Appropriate embeddings with respect to any unit vector ξ∈Sk - 1 can be found by rotating and translating the original embedding.

Let g be the discrete Morse function on P obtained by applying Lemma [\ref=lemAD] to f. By Part ([\ref=lemAD1]) of the lemma, it will suffice to prove the theorem with f replaced by g.

Suppose that P has k elements. By Lemma [\ref=lemAB] there is a map [formula] such that ψ(P) spans an [formula]-simplex, and that for each vertex v∈V, the projection of ψ(v) onto the x-axis equals g(v). Because [formula] is a simplicial complex with k vertices, it can be identified with a subcomplex of the [formula]-simplex spanned by ψ(P). Hence we can think of ψ as inducing a polyhedral embedding [formula], where φ(v)  =  ψ(v) for all v∈P, and where we think of P as the set of vertices of [formula].

By Lemma [\ref=lemAD] ([\ref=lemAD3]) we know that if a,b∈P and a  ≠  b, then g(a)  ≠  g(b). It follows that if ψ(a) and ψ(b) are vertices of [formula] that are joined by an edge, then g(a)  ≠  g(b), and hence the projection of ψ(a) onto the x-axis does not equal the projection of ψ(b) onto the x-axis. We can therefore define Banchoff's index at the vertices of [formula], where the projection is onto the x-axis, and hence we can apply the notion of polyhedral-critical and polyhedral-ordinary to these vertices.

Let b∈P, so that b is a vertex of [formula]. Following [\cite=BA1], we compute the index [formula] as follows. Let T denote the set of all simplices of [formula] that contain φ(b) as a vertex and for which projection onto the x-axis has maximal value at φ(b). Then [formula]. We can view this last formula from a different perspective. By the definition of [formula], every simplex of [formula] is a non-empty chain in P. The choice of φ states that the projection of φ(a) onto the x-axis equals g(a) for all a∈P. Hence, we see we can think of T as the set of all chains in P that contain b, and on which g is maximal at b. If C is a chain in P, then the dimension of this chain when thought of as a simplex of [formula] is equal to l()C. Therefore [formula].

Suppose that b is discrete-critical with respect to g. Let v∈P be such that v  <  b. If [formula], then g(v)  <  g(b) because b is discrete-critical with respect to g. Now suppose [formula]. By a standard fact about finite posets, there is some z∈P such that [formula]. Because b is discrete-critical with respect to g, then g(z)  <  g(b). By Lemma [\ref=lemAD] ([\ref=lemAD2]) we deduce that g(v)  <  g(b). A similar argument shows that g(b)  <  g(u) for any u∈P such that b  <  u. Hence, the set T consists precisely of all chains in [formula] that contain b; this set is denoted [formula]. Lemma [\ref=lemAAR] ([\ref=lemAAR1]) implies that

[formula]

Next, suppose that b is discrete-ordinary with respect to g. Then by Lemma [\ref=lemAAZ] either there is a single h∈P such that [formula] and g(h)  ≥  g(b), or there is a single u∈P such that [formula] and g(b)  ≥  f(u), but not both.

First, suppose that there is some h∈P such that [formula] and g(h)  ≥  g(b). Then g(b)  <  g(z) for all z∈P such that [formula]. By the same argument used above, we know that g(b)  <  g(u) for any u∈P such that b  <  u, and hence that [formula].

Let c∈P be such that c  <  b and c  ≠  h. If [formula], then the definition of discrete Morse functions implies that g(c)  <  g(b). Now suppose [formula]. Combining basic properties of posets with the fact that P is 2-wide, there is some t∈P such that t  ≠  h and [formula]. Then by the definition of discrete Morse functions we know that g(t)  <  g(b), and using Lemma [\ref=lemAD] ([\ref=lemAD2]) it follows that g(c)  <  g(b).

Putting the above considerations together, we see that h is the only element of [formula] such that g(h)  >  g(b). Hence [formula], and Lemma [\ref=lemAAR] ([\ref=lemAAR2]) implies that

[formula]

Second, suppose that there is some u∈P such that [formula] and g(b)  ≥  g(u). An argument similar to the previous case shows that [formula]. Lemma [\ref=lemAAR] ([\ref=lemAAR3]) implies that [formula].