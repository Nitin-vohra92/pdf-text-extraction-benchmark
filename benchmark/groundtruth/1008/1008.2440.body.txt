Corollary Lemma Proposition Conjecture Definition Example Remark

Inverse Star, Borders, and Palstars

Inverse star

Let L be a language such that L  =  L*. Then, following [\cite=Brzozowski&Grant&Shallit:2009], we say that L is closed. Brzozowski [\cite=Brzozowski:1967] studied the the "smallest" language M such that L  =  M*.

For closed languages L, define

[formula]

Brzozowski proved

If L is closed then (L-  *)*  =  L. Furthermore L-  *  =  L  -  L2. If L is regular and closed, then so is L-  *.

In this note we show that the class of context-free languages is not closed under the operation -  * . First, though, we take a digression to discuss products of palindromes.

Palstars, prime palstars, and unbordered words

In this section we find a new connection between the prime palstars (as introduced in Knuth, Morris, and Pratt [\cite=Knuth&Morris&Pratt:1977]) and the unbordered words.

We start with some definitions. By wR we mean the reverse of the word w. A palindrome is a word w such that w  =  wR. In this paper we will only be concerned with the nonempty palindromes of even length:

[formula]

A palstar is an element of the language [formula].

A word x is a prime palstar if it is a palstar and cannot be written as the product of two palstars. Evidently a prime palstar must itself be a palindrome. The first few prime palstars over {0,1} are 00,0110,010010,011110,01000010,01011010,01111110, and their complements, obtained by mapping 0 to 1 and vice versa. The language of all prime palstars is denoted PRIMEPALSTAR.

Every palstar has a unique factorization into prime palstars.

The proof of this theorem depends on the following lemma:

No prime palstar is a proper prefix of another prime palstar.

If w is a palindrome of even length, then its factorization into prime palstars must be of the form [formula], where xi  =  xn + 1 - i for 1  ≤  i  ≤  n.

Suppose [formula] is the factorization into prime palstars xi. If n  =  1 we are done. Otherwise, since w ends with xn, it must begin with xRn  =  xn. Hence either x1 is a prefix of xn, or vice versa. By Lemma [\ref=pal] we must have x1  =  xn. Using the same argument on the shorter palindrome x1- 1wx- 11, we derive the remaining equalities.

We now turn to borders. A word is said to be bordered if it has some nonempty prefix that is also a suffix. Otherwise, it is unbordered. Unbordered words are also called bifix-free in the literature [\cite=Nielsen:1973].

Equivalently, a word w is bordered if it can be written in the form xyx for some nonempty word x. For example, entanglement begins and ends with the string ent.

Given two words of the same length [formula] and [formula], their perfect shuffle [formula] is defined by [formula].

A word w is a prime palstar if and only if there exists an unbordered word z such that [formula].

Suppose w is not a prime palstar. If w is not an even length palindrome then it is certainly not of the form [formula]. Suppose then that w is an even length palindrome and hence is of the form [formula]. We will show that z is bordered. Since w is not a prime palstar we can factor w into a product of prime palstars. Then by Corollary [\ref=palin] such a factorization must look like [formula] for some palindrome x. Then when we "unshuffle" w into z and zR, we get that z starts with the odd-indexed letters of x and ends with the odd-indexed letters of xR. But x  =  xR, so z starts and ends with the same word.

On the other hand, suppose [formula]. By comparing the symbols x to y we see that if [formula], then w is not a palindrome. So assume y  =  xR. Now if x is bordered, then we can write it as x  =  zuz for some nonempty string z. Then [formula]. This gives a factorization of w as a product of two or three nonempty palstars (according to whether u is empty or nonempty).

An example of this theorem in English is [formula], which is a prime palstar, and is the shuffle of the unbordered word [formula] with its reversal.

Enumeration of palstars

As far as we know, up to now no one has enumerated the palstars. However, our argument above allows us to do so, based on enumeration of the unbordered words.

Nielsen [\cite=Nielsen:1973] has shown that if an denotes the number of unbordered words of length n over an alphabet of size k, then

[formula]

(Also see [\cite=Blom:1994].) Furthermore, he showed that an  ~  ckkn, where ck is a constant that tends to 1 as k  →    ∞  , and [formula].

It follows that if bn is the number of prime palstars of length 2n, then bn  =  an. In particular, about 27% of all binary palindromes are prime palstars.

Context-free languages and inverse star

We now apply the results in Section [\ref=palstar] to prove that the class of context-free languages is not closed under inverse star.

Clearly [formula] is context-free. We have [formula]. So it suffices to show that [formula] is not context-free. Suppose it were. First, we need the following result.

The language U of unbordered words over an alphabet of size at least 2 is not context-free.

Assume it is. Without loss of generality the alphabet is [formula]. Consider

[formula]

the intersection of U with a regular language. Then

[formula]

Since the context-free languages are closed under intersection with a regular language, it suffices to prove U' is not context-free.

To do this, we use Ogden's lemma [\cite=Ogden:1968]. Choose

[formula]

and distinguish the third block of 0's, the one corresponding to C. Write z  =  uvwxy. Then by Ogden's lemma vwx must contain at most n distinguished positions and vx at least one.

If vx contains a 1, then by pumping we get a string with too many 1's. Thus vx contains 0's only, and each of v, x is contained in a single block of zeros.

Case 1: v contains 0's from block A, and x contains 0's from block C. Then consider uv2wx2y  =  1 0a' 1 0b' 1 0c' 1 0d'. It has a'  ≥  d', a contradiction.

Case 2: v contains 0's from block B, and x contains 0's from block C. Then consider uviwxiy  =  1 0a' 1 0b' 1 0c' 1 0d', where i  =  (n! / |x|) + 1. Then this string has a'  =  c', b'  ≥  d', a contradiction.

Case 3: vx contains 0's from block C. Then as in the previous case, choose i  =  (n! / |vx|)  +  1. The resulting string has a'  =  c' and b'  ≥  d', a contradiction.

Case 4: v contains 0's from block C, and x contains 0's from block D. Consider uviwxiy  =  1 0a' 1 0b' 1 0c' 1 0d' with i  =  0 to get a'  ≥  d', a contradiction.

Now, using this result, we can prove our last result:

Over an alphabet of two or more letters, PRIMEPALSTAR is not context-free.

Consider the morphisms g and h defined as follows: g(a)  =  00, g(b)  =  01, g(c)  =  10, g(d)  =  11, and h(a)  =  h(b)  =  0, h(c)  =  h(d)  =  1. Then the effect of [formula] is to extract the odd-indexed letters from an even-length word.

Assume that [formula] is context-free. Then [formula] would be context-free. But by Theorem [\ref=palstar-thm] [formula], the language of unbordered words, which we have shown in Theorem [\ref=ming] to be non-context-free.