Packing tight Hamilton cycles in 3-uniform hypergraphs

Michael Krivelevich

Po-Shen Loh

40pt 10pt

Definition Fact Proposition Lemma Corollary

Introduction

Hamilton cycles occupy a position of central importance in graph theory, and are the subject of countless results. The most famous is of course Dirac's Theorem [\cite=Dirac], which states that a Hamilton cycle can always be found in any n-vertex graph with all degrees at least n / 2. Much more work has been done to determine conditions for Hamiltonicity in graphs, digraphs, hypergraphs, and random and pseudo-random instances of these objects. See, e.g., any of [\cite=Bol] [\cite=HS] [\cite=KKMR] [\cite=KrivSud] [\cite=KMO-type-l] [\cite=KO-di-survey].

There has also been a long history of research concerning conditions for the existence of multiple edge-disjoint Hamilton cycles. Indeed, Nash-Williams discovered that the Dirac condition already guarantees not just one, but at least [formula] edge-disjoint Hamilton cycles. His questions in [\cite=NW12] [\cite=NW13] [\cite=NW14] started a line of investigation, leading to recent work by Christofides, Kühn, and Osthus [\cite=CKO], who answered one of his conjectures asymptotically by proving that minimum degree [formula] is already enough to guarantee [formula] edge-disjoint Hamilton cycles.

For random graphs, these "packings" with Hamilton cycles are even more complete. Bollobás and Frieze [\cite=BolFrieze] showed that for every fixed r, one can typically find r edge-disjoint Hamilton cycles in the random graph process as soon as the minimum degree reaches 2r. Kim and Wormald [\cite=KW] established a similar result for random r-regular graphs, proving that such graphs typically contain ⌊r / 2⌋ edge-disjoint Hamilton cycles. The previous statements are of course best possible, but invite the natural question of what happens when r is allowed to grow. Along these lines, Frieze and Krivelevich showed in [\cite=FK-mindegree] that one can pack [formula] Hamilton cycles in Gn,p, up to [formula], where δ is the minimum degree of the graph. For large p, they discovered in [\cite=FK0] that one can pack almost all edges into Hamilton cycles. This was later improved to essentially the full range of p by Knox, Kühn, and Osthus [\cite=KKO].

In the hypergraph setting, the study of this Hamilton cycle packing problem was initiated by Frieze and Krivelevich in [\cite=FK]. Although the notion of a Hamilton cycle in an ordinary graph is clear, there are several ways to generalize the notion to hypergraphs. Indeed, for any [formula], we may define a k-uniform hypergraph C to be a Hamilton cycle of type [formula] if there is a cyclic ordering of the vertices of C so that every edge consists of k consecutive vertices, and every pair of consecutive edges Ei - 1,Ei in C (according to the natural ordering of the edges) has [formula]. The extreme cases [formula] and [formula] are the most obvious generalizations of graph Hamiltonicity, and cycles of those types are often called tight and loose, respectively. In [\cite=FK], the first two authors studied the problem of covering almost all the edges of a given k-uniform hypergraph with disjoint Hamilton cycles of a fixed type [formula]. They considered [formula] on the looser end of the spectrum, determining sufficient conditions for the cases [formula]. However, their methods did not extend to the regime [formula], which seems more difficult.

New results

In this paper, we introduce several new techniques which enable us to prove the first results for packing tight Hamilton cycles, i.e., with [formula]. To give the clearest presentation of the new methods involved, we concentrate on the concrete case of 3-uniform hypergraphs, which we refer to as 3-graphs from now on. Our approach can be naturally extended to the general k-uniform case, but the explanations necessarily become more involved.

We focus on 3-graphs with certain pseudo-random properties. Consequently, our results will yield corollaries in the standard random 3-graph model, denoted Hn,p;3, in which each of the [formula] possible edges independently appears with probability p. Recall that there are several essentially equivalent notions of pseudo-randomness in graphs, most notably the ones involving uniformity of edge distribution, the second eigenvalue, or the global count of 4-cycles. (See, e.g., the survey [\cite=KS-survey].) However, even in ordinary graphs, these global conditions are insufficient for Hamilton cycle packing, because Hamilton cycles visit every vertex. Therefore, even a single non-conforming vertex can doom the entire packing process.

This situation can be prevented by localizing the specification of the pseudo-random criteria. Importantly, the resulting stronger conditions are still satisfied by the random objects in question. For example, in the graph case, this can be done by controlling the degrees and codegrees (see, e.g., [\cite=CGW] [\cite=Thomason]). Note that this is a special case of the more general notion of controlling the numbers of extensions to certain specific subgraphs, uniformly over all base sites, instead of just the global number of copies of a certain graph (C4, say). The following definition generalizes that concept to 3-graphs.

Let [formula] be distinct vertices of a 3-graph H, and let Γ be a graph on vertex set

[formula]

Example 1.  If t  =  2 and Γ is a single edge, then dΓ(v1,v2) is the number of edges which contain the pair {v1,v2}. This can be interpreted as a generalized notion of degree.

Example 2.  In general, if Γ is the complete graph on t vertices, then [formula] is the number of x which simultaneously form edges with all pairs {vi,vj}. This can be interpreted as a generalized notion of codegree.

We can now state our localized version of pseudo-randomness, which we will later show is satisfied by the random 3-graph Hn,p;3 whp when p is not too small. Since we need to control many quantities within certain ranges, we will employ the notation A = (1  ±  ε)B as a shorthand for the pair of inequalities (1  -  ε)B  ≤  A  ≤  (1  +  ε)B.

We say that an n-vertex 3-graph H is [formula]-uniform if for every auxiliary graph Γ on t  ≤  7 vertices and s  ≤  6 edges, and every choice of distinct vertices [formula], we have

Remark.  We do not actually need the full strength of this definition, as will be clear in the proof of Lemma [\ref=lem:d] in Section [\ref=sec:3graph]. Indeed, there are only 5 specific graphs Γ with respect to which we require control (depicted in Figure [\ref=fig:gamma] of Section [\ref=sec:3graph]). However, we feel that the description is more succinctly captured in the above statement.

The main result of this paper establishes the first known packing result for tight Hamilton cycles in pseudo-random hypergraphs. Here, and in the rest of this paper, we write f(n)  ≪  g(n) if f / g  →  0 as n  →    ∞  .

Suppose that n is a sufficiently large multiple of four, and ε45np16  ≫   log 21n. Then every (ε,p)-uniform 3-graph with n vertices can have all but at most ε1 / 15-fraction of its edges covered by a disjoint union of tight Hamilton cycles.

Note that in Hn,p;3, for each graph Γ with s  ≤  6 edges on a set of t  ≤  7 vertices, the value of [formula] has distribution [formula]. So, the Chernoff bound in Section [\ref=sec:tools] (Fact [\ref=fact:chernoff]) shows that as long as ε2np6  ≫   log n, we have giving the following immediate corollary.

Suppose that ε,n,p satisfy ε45np16  ≫   log 21n. Then whenever n is a multiple of four, Hn,p;3 can have all but at most ε1 / 15-fraction of its edges covered by a disjoint union of tight Hamilton cycles whp.

Remark.  Although both results are stated for n divisible by 4, we expect that they are true in general. Note, however, that a divisibility condition is unavoidable in the general case of packing Hamilton cycles of type [formula] in k-uniform hypergraphs, since [formula] must divide n.

Along the way, we also prove a new result about packing Hamilton cycles in pseudo-random digraphs. The result differs from that in [\cite=FK0] as our definition of pseudo-randomness is local instead of global, and therefore may be easier to apply in some situations. Indeed, the previous result required a minimum degree condition, together with bounds on the edge distributions across almost all cuts. We can now replace the latter conditions with two more local statements. The specific conditions that we impose below have been tailored for the task of producing Hamilton cycles in digraphs.

We say that an n-vertex digraph is [formula]-uniform if it satisfies the following properties:

Remark.  It is not clear that this is the minimal set of pseudo-random conditions which enable Hamilton cycle packing in directed graphs. We choose the above statements because they naturally arise from our analysis, and are therefore the most convenient for our purposes. Importantly, one can easily see that they are satisfied by random digraphs whp, as long as the edge probability is not too small.

Under these easily-verifiable conditions, we are able to prove the following packing result for digraphs, which has the obvious corollary for random digraphs which are not too sparse.

Suppose that ε11np8  ≫   log 5n, and n is a sufficiently large even integer. Then every (ε,p)-uniform digraph can have its edges partitioned into a disjoint union of directed Hamilton cycles, except for a set of at most ε1 / 8-fraction of its edges.

Although we originally developed this result only as a building block for our 3-graph analysis in Section [\ref=sec:3graph], we feel it is worth bringing attention to, as it may be of independent interest. In particular, it is easier to apply than its counterpart in [\cite=FK0], because our pseudo-randomness conditions are easier to verify.

Proof overview and organization

The key insight in the proof of Theorem [\ref=thm:3graph] is the following connection between tight Hamilton cycles in H and Hamilton cycles in an associated digraph. For a random permutation [formula] of the vertices of H, define an [formula]-vertex digraph D with vertex set [formula]. Note that each vertex of D corresponds to an ordered pair of vertices of H, so D will have an even number of vertices, since the number of vertices of H is a multiple of 4. Place a directed edge from (vi,vi + 1) to (vj,vj + 1) if and only if both hyperedges {vi,vi + 1,vj} and {vi + 1,vj,vj + 1} are present in H. In this construction, Hamilton cycles in D give rise to tight Hamilton cycles in H.

To extract edge disjoint Hamilton cycles from a digraph D with an even number of vertices, we use an approach similar to that taken in [\cite=FK]. Let [formula] be a random permutation of the vertices of D with m  =  n / 4, and define [formula] and [formula]. Define a bipartite graph Γ with bipartition (A,B), and place an edge between wi∈A and wj∈B whenever [formula] and [formula] are both edges of D. Now perfect matchings in Γ give rise to Hamilton cycles in D, and previous approaches in [\cite=FK] show how to pack perfect matchings in pseudo-random bipartite graphs.

However, not all Hamilton cycles in D arise from perfect matchings in one particular Γ. Similarly, not all Hamilton cycles in H arise from Hamilton cycles in a single D. We overcome both obstacles with the same iterative approach, which we illustrate for the hypergraph packing. Roughly speaking, instead of stopping after generating a single D, we sequentially generate digraphs [formula] in the above manner, extracting a large set of edge disjoint directed Hamilton cycles from each, and deleting the corresponding edge-disjoint Hamilton cycles from H. At each step, we verify that the pseudo-random properties are maintained. We repeat the process until we have packed the required number of cycles.

Since the digraph packing and hypergraph packing proofs are essentially independent (though similar), we separate them into Sections [\ref=sec:digraph] and [\ref=sec:3graph], respectively. All required concentration inequalities are collected in Section [\ref=sec:tools] for the reader's convenience. The final section contains some concluding remarks and open problems.

Notation and conventions

We will implicitly assume throughout that ε,p are small, e.g., less than 1 / 10. Our results have them tending to zero. The following (standard) asymptotic notation will be utilized extensively. For two functions f(n) and g(n), we write f(n)  =  o(g(n)) or g(n)  =  ω(f(n)) if lim n  →    ∞f(n) / g(n)  =  0, and f(n)  =  O(g(n)) or g(n)  =  Ω(f(n)) if there exists a constant M such that |f(n)|  ≤  M|g(n)| for all sufficiently large n. We also write f(n)  =  Θ(g(n)) if both f(n)  =  O(g(n)) and f(n)  =  Ω(g(n)) are satisfied. All logarithms will be in base e  ≈  2.718.

Probabilistic tools

We recall the Chernoff bound for exponential concentration of the binomial distribution. The following formulation appears in, e.g., [\cite=AS].

For any ε  >  0, there exists cε  >  0 such that any binomial random variable X with mean μ satisfies where cε is a constant determined by ε. When ε  <  1, we may take [formula].

A binomial random variable is the sum of independent indicator variables. We also need concentration in settings which are still product spaces, but are somewhat more complicated than simple binomials. A random variable X(ω) defined over an n-dimensional product space [formula] is called C-Lipschitz if changing ω in any single coordinate affects the value of X(ω) by at most C. The Hoeffding-Azuma inequality (see, e.g., [\cite=AS]) provides concentration for these distributions.

Let X be a C-Lipschitz random variable on an n-dimensional product space. Then for any t  ≥  0,

We also need concentration in settings where the probability space is not a simple n-dimensional product space, but rather the set of permutations on n elements. The following concentration inequality can be found in, e.g., Section 3.2 of [\cite=McDiarmid] or Lemma 11 of [\cite=FP].

Let X be a random variable on the uniformly distributed probability space of permutations on n elements, and let C be a real number. Suppose that whenever σ,σ'∈Sn differ by a single transposition, |X(σ)  -  X(σ')|  ≤  C. Then,

Packing Hamilton cycles in digraphs

In this section, we show how to complete the outline in Section [\ref=sec:overview] for Hamilton cycle packing in digraphs. Recall that the main idea in this part is to reduce the problem to packing perfect matchings in bipartite graphs. We begin by showing how to achieve the final step.

Packing perfect matchings

Here, we will show that we can efficiently decompose a suitably uniform bipartite graph into perfect matchings. This is contained in the following proposition, whose statement is very similar to Lemma 6 of [\cite=FK]. For completeness, we provide a slightly different proof here.

Let G be a bipartite graph with parts A and B, each of size m. Suppose that p,ε  <  1 / 2 are given such that every vertex has degree (1  ±  ε)mp, and every pair of distinct vertices has codegree at most (1 + ε)mp2. Also assume that ε4 / 3mp2  ≥  1. Then the edges of G can be partitioned into the disjoint union [formula], where |E0|  <  4ε1 / 3e(G) and each Ei with i  ≥  1 is a perfect matching.

We mentioned in the introduction that although pseudo-randomness can be deduced from the global 4-cycle count, local conditions are required to pack spanning objects such as Hamilton cycles or perfect matchings. For bipartite graphs, the above proposition's conditions on codegrees and degrees provide this localized property. Indeed, the concentrated codegree condition implies the global bound on the number of 4-cycles, simply by summing over all vertex pairs. The following lemma converts this into a suitable bound on the uniformity of edge distribution--another pseudo-random property, which we actually need to complete this proof.

Let G be a bipartite graph with parts A and B, each of size m. Let X and Y be subsets of A and B, respectively, with |X|  ≥  1 / (εp) and |Y|  ≥  ε1 / 3m. Suppose that ε,p are given such that every vertex in X has degree (1  ±  ε)mp, and every pair of distinct vertices in X has codegree at most (1 + ε)mp2. Then e(X,Y)  ≥  (1  -  3ε1 / 3)|X||Y|p.

Proof.  Let x  =  |X| and y  =  |Y|. For each vertex v∈B, let dX(v) denote the number of neighbors v has in X. Define the random variable Z by sampling a uniformly random vertex v∈B, and setting Z  =  dX(v). Since every vertex in X has degree at least (1 - ε)mp, we have e(X,B)  ≥  (1 - ε)xmp, and so [formula].

From the codegree condition, the number of labeled paths of length 2 from X to X is at most (1 + ε)x2mp2. This quantity is also equal to so [formula]. Therefore, [formula], which is at most (1 + 3ε)(xp)2 since we assumed x  ≥  1 / (εp).

This implies that [formula], and this low variance will allow us to conclude that vertices in Y cannot have an average dX which is too low. Formally, if we assume for contradiction that e(X,Y)  <  (1  -  3ε1 / 3)xyp, then Jensen's inequality gives (here, [formula] is a shorthand for [formula]):

[formula]

Yet a uniformly random vertex in B lies in Y with probability at least ε1 / 3, so contradiction. [formula]

Now that we know the edges are distributed fairly uniformly, we can prove the packing result using the maxflow-mincut theorem.

Proof of Proposition [\ref=prop:graph].  First, observe that if we can pack k  =  (1  -  3ε1 / 3)mp edge-disjoint perfect matchings into G, then the proportion of unused edges is at most We will use the maxflow-mincut theorem to show that we can indeed pack k matchings. Observe that one can pack k edge-disjoint perfect matchings in G if and only if the following network has an integer flow of size exactly km. Give each edge in G a capacity of 1, and direct it from A to B. Add a source vertex σ, with an edge of capacity k to each vertex in A, and add a sink vertex τ, with an edge of capacity k from each vertex in B. Clearly, an integer flow of size km is achieved if and only if the subset of used edges between A and B forms a k-regular graph. Since every k-regular bipartite graph can be decomposed into k edge-disjoint perfect matchings, this completes the argument.

All capacities are integers, so there is an integer flow which achieves the maximum size. Therefore, by the maxflow-mincut theorem, it remains to show that every cut has size at least km. Consider an arbitrary cut. Let X  ⊂  A be those vertices of A which are on the same side as σ, and let Y  ⊂  B be those vertices of B which are on the same side as τ. Let x  =  |X| and y  =  |Y|. The size of this cut is then exactly k(m - x)  +  k(m - y)  +  e(X,Y). Therefore, it suffices to establish the following inequality for all choices of X  ⊂  A and Y  ⊂  B:

[formula]

This is purely an inequality about the original graph G. Since it is symmetric in X and Y, assume without loss of generality that x  ≤  y.

We will use Lemma [\ref=lem:flow-prelim] to estimate e(X,Y), but first, we will need to dispose of the boundary cases y  ≤  ε1 / 3m and x  ≤  1 / (εp), in which it does not apply. In the first case, observe that we automatically have x  ≤  y  ≤  ε1 / 3m as well, so k(m - x)  +  k(m - y) is already at least km. (We may assume ε1 / 3  <  1 / 2.) In the second case, note that if m - y  ≥  x, then k(m - x)  +  k(m - y) is already at least km. So, we may assume that m - y  ≤  x  ≤  1 / (εp). Yet every vertex in X has at least (1 - ε)mp neighbors in B, and only at most m - y of them can be outside Y. Therefore, since we assumed that 1 / (εp)  ≤  ε1 / 3mp. Yet the final quantity exceeds xk, so we also have inequality [\eqref=ineq:cut] in this case.

In all remaining cases, we see that Lemma [\ref=lem:flow-prelim] applies, so The right-hand side is bilinear in x and y, so it is minimized when x,y∈{0,m}. If either of x or y are 0, then one of the first two terms is already km. On the other hand, if x  =  y  =  m, then the expression is precisely (1 - 3ε1 / 3)m2p  =  km as well.

Therefore, all cuts in the network have size at least km, so by the maxflow-mincut theorem, there is a flow of size km, completing the proof. [formula]

Directed Hamilton cycles and perfect matchings

Now that Proposition [\ref=prop:graph] allows us to efficiently pack perfect matchings, we can use it as the base to which we reduce the problem of packing Hamilton cycles in directed graphs. Throughout this section, all directed graphs have no loops, and no repeated edges in the same direction. However, they may have edges in both directions between pairs of vertices.

The main objective of this section is to prove Theorem [\ref=thm:digraph], which allows us to efficiently pack Hamilton cycles in digraphs that have the pseudo-random properties specified in Definition [\ref=def:digraph-props]. As mentioned in the proof overview in Section [\ref=sec:overview], we extract Hamilton cycles from digraphs by connecting them to perfect matchings in ordinary graphs. Consider the following random procedure, which constructs an undirected bipartite graph Γ from a digraph D with an even number of vertices.

Procedure 1.  This takes as input a digraph D with an even number of vertices.

Generate a random permutation [formula] of the vertices of D. Consider this sequence as two consecutive segments of length [formula], and let [formula] and [formula]. The graph Γ will be a bipartite graph with parts A and B.

Define the successor of vi to be vi + 1, unless [formula] (in which case the successor is v1) or i  =  n (in which case it is [formula]). Similarly, define the predecessor of vi to be vi - 1, unless i = 1 (in which case it is [formula]), or [formula] (in which case it is vn).

For vi∈A and vj∈B, place the edge vivj in Γ if and only if D contains both directed edges [formula] and [formula], where vi+ is the successor of vi as defined in the previous step.

Since an edge in Γ corresponds to two edges in D, we account for this by defining [formula] to be the digraph containing all [formula], for each vivj∈Γ with vi∈A.

The key observation is that perfect matchings in Γ cleanly correspond to Hamilton cycles in [formula]. Specifically, given a perfect matching M in Γ, one can recover a Hamilton cycle in [formula]. Indeed, for each vi∈A, M matches vi to a distinct vi'∈B. So, [formula] is a directed Hamilton cycle in [formula]; call this the Hamilton cycle associated with M.

Let M1,M2 be edge-disjoint perfect matchings in Γ. Then their associated Hamilton cycles [formula] are also edge-disjoint in [formula].

Proof.  Since M1 and M2 are disjoint, it is clear that [formula] and [formula] cannot overlap on any edges directed from A to B. On the other hand, if both [formula] contain the same edge [formula], where vj∈B and vk∈A, then they also both contain [formula], by definition of [formula]. Then both Mi contain the edge vk - 1vj, contradiction. [formula]

The next step, as we mentioned in the proof overview in the introduction, is to show that the randomly constructed bipartite graph inherits the pseudo-random properties of the initial digraph.

Suppose n, p, and ε satisfy ε2np8  ≫   log n. Let D be an (ε,p)-uniform digraph on n vertices (n even), and randomly construct the undirected bipartite graph Γ according to Procedure 1. Then, with probability 1 - o(n- 1), Γ satisfies all of the following properties:

Proof.  By construction, Γ is a bipartite graph with parts [formula] and [formula]. There are essentially four claims to prove, as the parts A and B are not constructed symmetrically.

Claim 1: Degrees in [formula] are correct.  To show this, for an arbitrary vertex a, define a random variable Na as follows. Let b be the successor of a, as defined in Step 2 of Procedure 1. Na is of no interest when a∈B but allowing a∈B makes the proof a trifle simpler. By definition, a and b are either both in A or both in B; let Na be the number of vertices x in the other part such that both [formula] and [formula] are edges of D. Note that Na is actually the degree of a in Γ if a happens to end up in A. Therefore, it suffices to show that [formula] with probability 1  -  o(n- 2).

Note that the random variable Na is completely determined by the permutation σ. Expose σ in stages. First, expose which index i has vi  =  a. Next, expose the identity of the vertex b which is the successor of a. This determines vi and vi+, where i+ is either i + 1, 1, or n / 2  +  1. Conditioned on these, the associations to the remaining vertices vj are a uniform permutation over the remaining n - 2 vertices. Yet the last part of property (ii) for (ε,p)-uniformity shows that in D, the number of vertices x with [formula] and [formula] in D is (1  ±  ε)np2. As each x will land in the part opposite {a,b} with probability exactly [formula], we immediately have [formula].

For concentration, we use Fact [\ref=fact:conc-perm]. We already conditioned on a and b, so the remaining randomness is from a uniformly random permutation of n - 2 elements. Transposing two of those elements can only change Na by at most 1, so by Fact [\ref=fact:conc-perm], Na deviates from its expectation by [formula] with probability at most Therefore, Na is indeed [formula] with probability 1  -  o(n- 2), as desired.

Claim 2: Degrees in [formula] are correct.  Consider an arbitrary vertex b. Let Sb be the set of ordered pairs of distinct vertices (x,y) with [formula]. By property (i) of (ε,p)-uniformity, b has (1  ±  ε)np in-neighbors, and (1  ±  ε)np out-neighbors. Since εnp  ≫  1, this implies that |Sb|  =  (1  ±  3ε)n2p2. Let Nb be the number of these pairs that, after the permutation σ, have the additional properties that (i) both x and y are on the opposite side of the bipartition to b, and (ii) y is the successor of x. It suffices to show that Nb is [formula] with probability 1  -  o(n- 2), because Nb is precisely the degree of b whenever b happens to end up in B.

For this, we employ the same strategy as used in the previous claim. First expose the index i for which vi  =  b. Then, the locations of the remaining vertices are uniformly permuted amongst the remaining n - 1 positions. For a given ordered pair (x,y)∈Sb, the probability that x lands on the opposite side of b is precisely [formula]. Then, conditioned on this, the probability that y is the successor of x is precisely [formula]. Therefore, For concentration, we again expose b first, and then consider the resulting (n - 1)-permutation. Consider two such permutations σ and σ' differing only on a single transposition. Transposing two of those elements can only change Nb by at most 4, so by Fact [\ref=fact:conc-perm], the probability that Nb deviates by over [formula] from its expectation is at most as before. Hence Nb is indeed [formula] with the desired probability 1  -  o(n- 2).

Claim 3: Co-degrees in [formula] are correct.  This is similar to Claim 1. Fix any two distinct vertices a and b, and let c and d be their respective successors as defined in Step 1 of Procedure 1. Note that we may have b = c or a = d, but not both. Let Na,b be the number of vertices x such that x is on the opposite side of a, and [formula].

Expose the indices i,j for which vi  =  a and vj  =  b, and expose their successors c and d. The remaining vertices are uniformly permuted over the remaining n - 4 positions (or n - 3 positions if b  =  c or a  =  d, although the argument will be the same). By property (iii) of (ε,p)-uniformity, there are (1  ±  ε)np4 candidates for x. As each x will land in the part opposite a with probability either [formula] (if b is on the same side as a) or [formula] (if b is opposite a), it follows that [formula]. A transposition in the (n - 4)-permutation can only affect Na,b by at most 1, so the probability that Na,b deviates from its expectation by over [formula] is at most Taking a union bound over all pairs (a,b) yields the desired result.

Claim 4: Co-degrees in [formula] are correct.  This is similar to Claim 2. Fix any two distinct vertices a and b, and let Sa,b be the set of ordered pairs of distinct vertices (x,y) with [formula]. By property (ii) of (ε,p)-uniformity, a and b have (1  ±  ε)np2 common in-neighbors, and (1  ±  ε)np2 common out-neighbors. Since εnp2  ≫  1, this implies that |Sa,b|  =  (1  ±  3ε)n2p4. Let Na,b be the number of these pairs that, after the permutation σ, have the additional properties that (i) both x and y are on the opposite side of the bipartition from a, and (ii) y is the successor of x.

Expose the indices i,j for which vi  =  a and vj  =  b; the remainder is then an (n - 2)-permutation over the leftover positions. A similar calculation to Claim 2 shows that [formula], and a similar concentration argument shows that Na,b is within [formula] of its mean with probability 1  -  o(n- 3). Therefore, a union bound over all a,b completes the proof of this final claim, and the proof of Lemma [\ref=lem:gamma] [formula]

At this point, we could immediately apply the results of Section [\ref=sec:graph] to pack Γ with perfect matchings, which then correspond to Hamilton cycles in D. However, it is unfortunate that this would miss most of the edges of D, since not all edges of D are in correspondence with edges of Γ. The solution is to iterate Procedure 1 several times. Some care must be taken because the edges of D will be covered many times by different Γ. We will specify how to deal with this in Procedure 2 below, but first we collect two intermediate results which control this multiplicity over several iterations of Procedure 1.

Suppose n and ε satisfy εn  ≫  1. Let D be an (ε,p)-uniform digraph on n vertices (n even), and randomly and independently construct [formula] graphs [formula] according to Procedure 1. Let [formula] be their corresponding digraphs. Then, with probability 1  -  o(n- 1), every edge of D is covered [formula] times by the [formula].

Proof.  Fix an arbitrary edge [formula], and let q be the probability that it appears in [formula] if Γ is constructed according to Procedure 1. Since the [formula] are independent, the number of times [formula] is covered will then be [formula], and we will use the Chernoff bounds to prove concentration. So, let [formula] be the permutation which produces Γ, and let A and B be the two sides of the bipartition as defined in Procedure 1.

There are two ways that [formula] can appear in [formula]: either u∈A and v∈B and [formula] for the successor u+ of u, or u∈B and v∈A and [formula] for the predecessor v- of v. These two cases are clearly disjoint, so q  =  q1  +  q2, where q1 and q2 are the respective probabilities in these two cases. To calculate q1, the probability that u∈A is precisely 1 / 2. Conditioned on this, the probability that v∈B is precisely [formula]. By property (i) of (ε,p)-uniformity, d+(v)  =  (1  ±  ε)np, so the probability that some out-neighbor of v becomes the successor of u is [formula]. Therefore, since [formula]. An analogous calculation shows that [formula] as well. Hence [formula].

Now, the number of times that [formula] is covered by the [formula] is precisely [formula]. Since [formula], the Chernoff bound implies that the probability that the Binomial deviates from its mean by more than a factor of 1  ±  0.01ε is at most Taking a union bound over all O(n2) edges [formula], we obtain the desired result. [formula]

Suppose r  ≪  n1 / 2. Construct r independent Γi according to Procedure 1. Then with probability 1  -  o(n- 1), every pair of distinct vertices a,b∈D has the property that b is the successor of a in at most 5 of the permutations for Γi.

Proof.  For a fixed pair (a,b), the probability that b is the successor of a in a single run of Procedure 1 is exactly [formula]. Therefore, the probability of this occurring more than 5 times in r independent runs is at most [formula]. Taking a union bound over all pairs (a,b), we obtain the result. [formula]

Since a single run of Procedure 1 packs very few edges into Hamilton cycles, we must repeat the procedure multiple times, deleting the packed edges from D after each round. However, it is important to maintain the pseudo-random properties through the iterations, and the set of removed edges after a single run of Procedure 1 would be too sparse to control the changes in the pseudo-random counts. The following extension provides one way to achieve this, by repeating Procedure 1 enough times to uniformly involve all edges of D.

Procedure 2.  This takes as input a digraph D with an even number of vertices, and an integer parameter r.

Independently generate the random undirected bipartite graphs Γ1, , Γr according to Procedure 1, and let σi, [formula], Ai, and Bi be their corresponding permutations, digraphs, and bipartitions, respectively.

For each edge [formula], let [formula]. If [formula], then independently select a uniformly random index in [formula] to label [formula] with.

For each Γi, define a subgraph Γi' by keeping each edge ab (a∈Ai and b∈Bi) if and only if both [formula] and [formula] are labeled by i, where a+ is the successor of a according to σi.

For each i, let [formula] be the digraph containing all [formula], for each ab∈Γi', with a∈Ai, where a+ is the successor of a according to σi.

Observe that the final step ensures that the [formula] are all disjoint. So, Lemma [\ref=lem:hamilton-matching] shows that we can work independently on each [formula], packing Hamilton cycles by packing perfect matchings in Γi' with Proposition [\ref=prop:graph]. After this, we will remove all [formula] from D, and show that their distribution is sufficiently uniform for us to maintain the necessary pseudo-random properties. The following Lemma shows that the Γi' themselves are sufficiently pseudo-random for us to apply Proposition [\ref=prop:graph].

Suppose n, p, and ε satisfy ε10np8  ≫   log 5n. Let D be an (ε,p)-uniform digraph on n vertices (n even), and conduct Procedure 2 with [formula]. Let [formula]. Then, with probability 1  -  o(n- 1), every Γi' satisfies the following properties:

Proof.  Our restrictions on ε,n,p allow us to apply Lemmas [\ref=lem:gamma] and [\ref=lem:gamma-cover], so we have that with probability 1  -  o(n- 1), after Step 1 of Procedure 2:

Condition on the above outcome of Step 1, and consider an arbitrary Γi', which is derived from Γi with bipartition [formula]. It suffices to show that in the randomness of Step 2, with probability 1  -  o(n- 2) each individual Γi' has the desired properties, since r  =  o(n) by the given restrictions on ε,n,p. There are four cases to consider: degrees in Ai, degrees in Bi, codegrees in Ai, and codegrees in Bi. Fortunately, they will all follow by essentially the same argument.

We begin with the degree of an arbitrary vertex u∈Ai. By (a) above, the degree of u in Γi is [formula]. Note that this actually corresponds to exactly du pairs of directed edges in D, of the form [formula], and all 2du directed edges involved are distinct. Step 2 of Procedure 2 assigns labels to all directed edges, and the degree of u in Γi' is precisely the number of the above pairs of directed edges for which both edges are labeled i. Since every directed edge is covered (1  ±  1.03ε)κ times by (b) and the edges are labeled independently, the probability that both of a given pair above receive label i is - 2. Therefore, the expected degree of u in Γi' is [formula]. Furthermore, since all directed edges involved are distinct, the Chernoff bound shows that the probability of the degree deviating from its mean by more than a factor of 1  ±  ε is at most because ε2np2  /  κ2  ≫   log n. Therefore, with probability 1  -  o(n- 3), the degree of u in Γi' is [formula]. Taking a union bound over all u∈Ai establishes part (i) for those degrees.

The arguments for the other three parts of the lemma are similar. For a vertex v∈Bi, its incident edges in Γi correspond to dv disjoint pairs of directed edges, so the exact same argument as above produces the bound for these degrees.

The codegree of a given pair of vertices u,v∈Ai corresponds to disjoint quadruples of distinct directed edges. From (a), there are [formula] such quadruples. The probability that a given quadruple is completely labeled by i is - 4 by (b), so the expected codegree in Γi' is [formula]. By the Chernoff bound, the probability that the codegree deviates from its expectation by a factor of more than 1  ±  ε is at most since ε2np4  /  κ4  ≫   log n. Taking a union bound over all pairs of vertices u,v∈Ai produces the desired bound for their codegrees. The argument for codegrees in Bi is similar. [formula]

The next few lemmas build up to a result which controls how D is affected by the deletion of all edges in the [formula]. The first one controls the "first-order" effect of the deletion process.

Condition on the first step of Procedure 2 covering every edge of D (1  ±  1.03ε)κ times by the [formula]. Fix any vertex a∈D and any set E of edges incident to a (all oriented in the same way with respect to a). Suppose that ε2|E|  /  κ2  ≫   log n. Then with probability 1  -  o(n- 5), the number of edges of E which are covered by the [formula] is [formula],

Proof.  We start with the case when all edges in E are directed out of a. Let the random variable N be the number of these edges which are covered by the [formula]. Since we conditioned on the first step of Procedure 2, the only remaining randomness is in the independent assignments of the edge labels. We expose these labels in three stages. First, expose the labels of E. Now each edge e∈E has its label l(e), so we can identify its partner edge in [formula] which must also receive l(e) in order for both to remain in [formula]; let F be the set of all partner edges found in this way. Next, expose all labels outside [formula]. Finally, expose the labels of F. It is clear that the second stage does not affect N at all. Thus, after conditioning on the result of the second stage, we are at the following situation: every edge e∈E has a label l(e), and it will only still be covered by the [formula] if its partner in [formula] also receives the label l(e). Since its partner is in (1  ±  1.03ε)κ different [formula], the probability that e is covered by [formula] is the inverse of this multiplicity; linearity of expectation then gives [formula].

We will use the Hoeffding-Azuma inequality to show the concentration of N. Indeed, the third stage exposure is a product space of dimension |F|  ≤  |E|. Consider the effect of changing the label of a single edge f∈F. By the definition of F, the edge f is either some [formula] directed into a, or some [formula] not incident to a with [formula]. In the latter case, [formula] is the only edge of E which can be affected by the label of f, so N can change by at most 1. For the remaining case [formula], suppose that the label of f was changed from j to k. By construction, only the (single) partner edge of f in [formula] could suffer from changing f's label away from j; this could decrease N by at most 1. Similarly, only the partner edge of f in [formula] could benefit from changing f's label to k, and this would only increase N by at most 1. We conclude that N is 1-Lipschitz, so the Hoeffding-Azuma inequality implies that the probability N deviates from its expectation by over [formula] is at most Therefore, with probability 1  -  o(n- 5), we have [formula], in the case when all edges of E are directed out of a. The case when all edges are directed into a follows by essentially the same argument. [formula]

The next lemma controls the "second-order" effect of the deletion process.

Fix any distinct vertices a,b∈D and any set X of vertices such that either

Condition on the first step of Procedure 2 covering every edge of D at least κ times by the [formula], and on the fact that b is the successor of a in at most 5 of the permutations.

Suppose that |X|  /  κ4  ≫   log n. Then with probability 1  -  o(n- 5), the number N of vertices in X which still have both of their designated edges above still covered by the [formula] is at most [formula].

Proof in situations (i) and (ii).  These two cases follow by very similar arguments; for concreteness, let us begin with (i). Let E be the set of 2|X| edges specified in (i). Since we conditioned on the first step of Procedure 2, the only remaining randomness is in the independent assignments of the edge labels. We expose these labels in three stages. First, expose the labels of E. Now each edge e∈E has its label l(e), so we can identify its partner edge in [formula]; denote the partner by φ(e), and let F be the set of all partner edges found in this way. Next, expose all labels outside [formula]. Finally, expose the labels of F. It is clear that the second stage does not affect N at all. Thus, after conditioning on the result of the second stage, we are at the following situation: every edge e∈E has a label l(e), and e will only still be covered by the [formula] if its partner φ(e) also receives the label l(e).

The random variable N counts the number of vertices x for which both [formula] and [formula] are still covered by the [formula]. Note that their partner edges [formula] and [formula] are distinct unless they both coincide as some [formula]. If they are distinct, then clearly the probability of having both receive their correct labels is at most [formula]. On the other hand, if they coincide, then we must have that in both permutations [formula] and [formula], the vertex c is the successor of a and b. Yet c has a unique predecessor, so [formula]. Therefore, it is actually impossible for the (coincident) partner edge to receive a label which suits both [formula] and [formula], so the probability is 0. In all cases, we have an upper bound of [formula], so [formula].

We use the Hoeffding-Azuma inequality to probabilistically bound N, since the third exposure stage is a product space. Consider the effect of changing the label of a single edge f∈F. By the definition of F, the edge f is either some [formula] or [formula], or some [formula] with [formula] and [formula] both in D. In the latter case, x is the only vertex which may have its count in N affected, so N changes by at most 1 under this perturbation. By symmetry, it remains to consider the case when [formula] changes its label from j to k. By construction, only the partner edge [formula] of f in [formula] could suffer from changing f's label away from j; this could potentially lose only y in the count of N, so N would decrease by at most 1. Similarly, only the partner edge of f in [formula] could benefit from changing f's label to k, and this could only increase N by at most 1. We conclude that N is 1-Lipschitz over its product space of dimension |F|  ≤  2|X|, so the Azuma-Hoeffding inequality implies that the probability that N exceeds its expectation by more than [formula] is at most This finishes the case when (i) holds. The case when (ii) holds follows from a directly analogous argument.

Proof in situation (iii).  Let E be the set of 2|X| edges specified in (iii). We expose the labels in the same three stages as before: first E, then the other non-partner edges, and finally the partner edges F.

Again, after the second stage we would be at the following situation: every edge e∈E has a label l(e), and a vertex x will only be counted toward N if the partner edge [formula] receives the label [formula], and [formula] also receives [formula]. However, this time there is an additional complication, because it can happen that one or both of these partner edges have already had their labels exposed. The only way this could happen is if either [formula] or [formula].

Fortunately, we are only seeking an upper bound on N, so we only need to determine when this first round exposure already forces a vertex x to contribute to N. A moment's thought reveals that the only way this can happen is if the first round gave both [formula] and [formula] the same label l, and furthermore, the permutation σl has b as the successor of a. Now we use the assumption that at most 5 of the permutations σl satisfy this property. Let L be the set of the corresponding indices l.

We can circumvent this issue, by observing that in the first exposure, the number of x for which both [formula] and [formula] receive the same label l∈L is stochastically dominated by [formula]. Since |X|  /  κ2  ≫   log n, the Chernoff bound then implies that with probability 1  -  o(n- 5), the first round has at most [formula] "bad" x which have the potential of being automatically included in the count for N.

The second round exposure is essentially irrelevant, so we may now condition on the result of the second round satisfying the property in the previous paragraph. As we only need to upper bound N, it remains to consider only the "good" x. From our previous discussion, if a good x has, say, the label of [formula] already exposed to be l then b is not the successor of a in permutation l and so this x cannot contribute to N.

Also note that the only way for [formula] to equal [formula] is if both are [formula]. If [formula] then a∈B and if [formula] then a∈A and so we must have [formula]. Hence it is not possible for [formula] to simultaneously match both labels, and x cannot contribute to N.

So, if we let let Y be the subset of good vertices x∈X for which [formula], and neither label has yet been exposed, it remains to control the number M of vertices in Y which contribute to N. Since each x∈Y has [formula] and their labels are independent, we immediately have [formula].

We show that M is concentrated by using the Hoeffding-Azuma inequality on the third round exposure product space of dimension |F|  ≤  2|X|. Consider the effect of changing the label of an edge f∈F from j to k. There are three types of edges in F:

Thus M is 2-Lipschitz, and the Hoeffding-Azuma inequality shows that the probability it exceeds its expectation by |X|  /  κ2 is at most

Since we conditioned on there being at most [formula] bad vertices, we have [formula]. Putting everything together, we conclude that with probability 1  -  o(n- 5), [formula], completing the proof. [formula]

The previous two lemmas now enable us to prove that the pseudo-random properties of the digraph are still maintained after deleting the [formula].

Suppose n, p, and ε satisfy ε8np4  ≫   log 5n. Let [formula] and [formula]. Let D be an (ε,p)-uniform digraph on n vertices (n even), and conduct Procedure 2. Let D' be the subgraph of D obtained by deleting all edges covered by any [formula]. Then, with probability 1  -  o(n- 1), D' is an (ε',p')-uniform digraph with [formula] and [formula].

Proof.  By applying Lemmas [\ref=lem:gamma-cover] and [\ref=lem:gamma-rare-consec], the outcome of Step 1 of Procedure 2 will satisfy the following two properties with probability 1  -  o(n- 1). (The second follows since (ε2p)4  ≫  n- 1, and so r  ≪  n1 / 2.)

Every edge of D covered (1  ±  1.03ε)κ times by the [formula].

For any a,b, the vertex b is the successor of a in at most 5 of the permutations for the Γi.

Condition on this outcome. We will now show that in the remaining randomness of Step 2, the properties of (ε',p')-uniformity are satisfied with probability 1  -  o(n- 1). We establish them one at a time.

Property (i).  Consider an arbitrary vertex a. By (ε,p)-uniformity, it has (1  ±  ε)np out-edges in D, and ε2(np)  /  κ2  =  Θ(ε6np  /   log 2n)  ≫   log n. So, we may apply Lemma [\ref=lem:d-delete-out-nbrs] to the set of out-edges of a. This shows that with probability 1  -  o(n- 5), the new out-degree of a in D', in terms of its original out-degree d+(a) in D, is

[formula]

Here, we used d+(a)  =  (1  ±  ε)np by (ε,p)-uniformity. Taking a union bound over all a∈D, we obtain the desired result on out-degrees with probability 1  -  o(n- 4). A similar argument controls all in-degrees. [formula]

Property (ii).  Consider an arbitrary pair of distinct vertices a,b, and let X be the set of their common out-neighbors. Let X1 be the number of vertices in x∈X such that [formula] is covered by the [formula], let X2 be the number of x∈X such that [formula] is covered by the [formula], and let X12 be the number of x∈X such that both [formula] and [formula] are covered by the [formula]. Clearly, the number of common out-neighbors of a and b in D' is exactly d+(a,b)  -  X1  -  X2  +  X12, where d+(a,b) was the number of their common out-neighbors in D.

Note that d+(a,b)  =  (1  ±  ε)np2 by (ε,p)-regularity, and ε2(np2)  /  κ2  =  Θ(ε6np2  /   log 2n)  ≫   log n. So, Lemma [\ref=lem:d-delete-out-nbrs] implies that with probability 1  -  o(n- 5), both X1 and X2 are [formula]. On the other hand, we also have (np2)  /  κ4  =  Θ(ε8np2  /   log 4n)  ≫   log n, so Lemma [\ref=lem:d-delete-co-out] bounds X12 by [formula] with probability 1  -  o(n- 5). Therefore, X12 is within [formula] additive error of [formula] because εκ  ≫  1.

Putting these bounds together, we have that the new number of common out-neighbors is

[formula]

Here, d+(a,b)  =  (1  ±  ε)np2 by (ε,p)-uniformity. Taking a union bound over all a,b∈D, we obtain the desired result on the new d+(a,b) with probability 1  -  o(n- 3). Similar arguments control the other two parts of property (ii) of (ε',p')-uniformity. [formula]

Property (iii).  This is a slight extension of the previous argument. Consider any four vertices a,b,c,d, which are all distinct except for the possibility b = c. Let X and X' be the sets of vertices x such that [formula], [formula], [formula], [formula] are all in D or D', respectively. Let X1, X2, X3, and X4 be the sets of vertices x∈X such that [formula], [formula], [formula], or [formula] are still covered by the [formula]. Define the pairwise intersections [formula]. By inclusion-exclusion, we have As in (ii), since ε2(np4)  /  κ2  =  Θ(ε6np4  /   log 2n)  ≫   log n (to apply Lemma [\ref=lem:d-delete-out-nbrs]) and (np4)  /  κ4  =  Θ(ε8np4  /   log 4n)  ≫   log n (for Lemma [\ref=lem:d-delete-co-out]), we have that with probability 1  -  o(n- 5), each [formula], and each [formula]. Thus Here, we used |X|  =  (1  ±  ε)np4 by (ε,p)-uniformity. Now observe that However, since εκ  ≫  1, the error term is [formula]. Therefore, we have Taking a union bound over all choices of a,b,c,d, we obtain the desired result on the new d+(a,b) with probability 1  -  o(n- 1). [formula]

Now we have established control over the pseudo-random properties of the digraph after deletion, as well as over the individual bipartite graphs Γi' at each stage. We finally combine all of our lemmas to prove the main result of this section, that pseudo-random digraphs can be efficiently packed with Hamilton cycles.

Proof of Theorem [\ref=thm:digraph].  We will iterate Procedure 2, packing all intermediate [formula] at each iteration and deleting them from the digraph, until very few edges remain. The total number of iterations will be o(n), so since our previous lemmas hold with probability 1  -  o(n- 1), a final union bound will show that we achieve the desired packing whp.

Let D0  =  D, ε0  =  ε, and p0  =  p. Define the sequences (εt), (pt) via the following recursion:

[formula]

Let T be the smallest index such that [formula]. Note that εt only increases, so Also note that since we have in general that [formula]. Therefore,

[formula]

We now iteratively construct [formula], such that each Dt is (εt,pt)-uniform. Indeed, consider the (random) Procedure 2 applied to Dt with respect to [formula]. Let [formula]. This produces bipartite graphs Γt,i' and directed graphs [formula] with all [formula] disjoint. Let Dt + 1 be the result of deleting all [formula] from Dt. To apply Lemmas [\ref=lem:gamma-prime] and [\ref=lem:digraph-delete], we must check that ε10tnp8t  ≫   log 5n. But this follows from our initial assumption that ε11np8  ≫   log 5n since εt  ≥  ε and [formula]. Therefore, as the individual failure probabilities of Lemmas [\ref=lem:gamma-prime] and [\ref=lem:digraph-delete] are o(n- 1) and T  =  o(n), we may assume that the outcome of Procedure 2 satisfies the following properties:

Fix this outcome. We may apply Proposition [\ref=prop:graph] to each Γt,i' because where we used [formula], εt  ≥  ε, and our initial assumption that ε11np8  ≫   log 5n. So, every Γt,i' can be packed with edge-disjoint perfect matchings, missing only a 4ε1 / 3t-fraction of the edges. By Lemma [\ref=lem:hamilton-matching], these edge-disjoint perfect matchings in Γt,i' correspond to edge-disjoint Hamilton cycles in [formula], missing the same fraction of edges since there is a 2-to-1 correspondence between edges in [formula] and Γt,i'.

We carry on the above procedure until we create DT. Then, we will have packed Hamilton cycles in [formula], up to a fractional error of 4ε1 / 3T - 1. Since DT is (εT,pT)-uniform, it has at most [formula] edges. As D was (ε,p)-uniform, it had at least [formula] edges. Thus DT itself has at most [formula]-fraction of the total number of edges.

Therefore, the fraction of edges of D that have not been covered is at most since ε1 / 3T - 1  ≪  ε1 / 8 by inequality [\eqref=eq:epsilon-T]. This completes the proof.

Remark.  The above proof showed that we can pack the edges of D with Hamilton cycles, up to a fractional error of at most εc, where c  =  1 / 8. In fact, one can prove the same result for any c  >  1 / 7, and all of the calculations can be recovered by following our proof. Indeed, we intentionally introduced a very high level of precision in Lemma [\ref=lem:gamma-cover]. It is clear that the same argument can replace the 1.03 with 1.003, etc. These smaller order errors are what accumulate into the decimal places in the final 4.23 which appears in Lemma [\ref=lem:digraph-delete], and which later determines the value of c. When 4.23 is replaced by a constant arbitrarily close to 4, the above argument produces a result with c approaching 1 / 7.

Hypergraphs

This section is organized so that its structure is parallel to the previous section. Indeed, their themes are similar, as the objective of this section is to establish another reduction, this time from the hypergraph setting to the digraph setting. The fundamental building block is now the following procedure, which should be compared with Procedure 1.

Procedure 3.  This takes as input a 3-graph H with an even number of vertices.

Generate a random permutation [formula] of the vertices of H. Split it into n / 2 successive pairs (v1,v2), (v3,v4), , (vn - 1,vn).

Construct a directed graph D with n / 2 vertices, one corresponding to each of the pairs above. Place a directed edge from (vi,vi + 1) to (vj,vj + 1) if and only if both hyperedges e = {vi,vi + 1,vj} and f = {vi + 1,vj,vj + 1} are present in H. Consider e and f to be partners, and introduce the notation φσ(e) = f and φσ(f) = e.

Since a directed edge in D corresponds to two hyperedges in H, we account for this by defining H'  ⊂  H to be the hypergraph containing all {vi,vi + 1,vj}, {vi + 1,vj,vj + 1}, for each directed edge from (vi,vi + 1) to (vj,vj + 1) in D.

As already noted, Hamilton cycles in D correspond precisely to tight Hamilton cycles in H. Indeed, the hyperedges corresponding to the directed edges of a Hamilton cycle are precisely those which are needed for a tight Hamilton cycle in the hypergraph.

Let C1,C2 be edge-disjoint Hamilton cycles in D. Then their associated Hamilton cycles C1',C2' in H are also edge-disjoint.

Proof.  It suffices to show that given a fixed pairing (v1,v2), , (vn - 1,vn) from Step 1, any given hyperedge {a,b,c} can be associated with at most one directed edge in Step 3. Indeed, by construction, some pair of vertices in the hyperedge, say (a,b), must be a pair above. If the pair containing c is (c,x), then the directed edge must be from (a,b) to (c,x), hence unique. Similarly, if the pair containing c is (x,c), then the only possibility is that the directed edge is from (x,c) to (a,b). [formula]

As in the previous section, our next goal is to show that the result of Procedure 3 (a digraph) is pseudo-random. The following lemma will be a useful component of the proof.

Let S be a given set of ordered pairs of distinct vertices (a,b), with ε2|S|2  /  n3  ≫   log n. Then with probability 1  -  o(n- 9), the number N of ordered pairs in S which appear in the list of n / 2 ordered pairs from Step 1 of Procedure 3, satisfies [formula].

Proof.  The probability that any given (x,y)∈S appears as an ordered pair in Step 1 is precisely [formula]. This is because x must land in one of the n / 2 positions of the permutation which correspond to first-vertices of ordered pairs, and then y must land in the position immediately following x. Since [formula], linearity of expectation gives [formula].

For concentration, we apply Fact [\ref=fact:conc-perm]. Suppose the permutation σ is converted to σ' via the single transposition of the positions of the vertices x and y. Let x' and y' be the other vertices in their respective ordered pairs (according to σ). Then, the only changes in the set of ordered pairs produced by Step 1 is that the ordered pairs (x,x') and (y,y') change to (y,x') and (x,y'). All other ordered pairs remain the same, so their inclusion or exclusion in N remains invariant. Therefore, the value of N can only change by at most 2. Fact [\ref=fact:conc-perm] then implies that the probability that N deviates from its mean by more than [formula] is at most completing the proof. [formula].

Now we show that the result of Procedure 3 is a pseudo-random digraph.

Suppose n, p, and ε satisfy ε2np16  ≫   log n. Let H be an (ε,p)-uniform 3-graph on n vertices (n even), and randomly construct the [formula]-vertex directed graph D according to Procedure 3. Then, with probability 1 - o(n- 1), D is (5ε,p2)-uniform.

Proof.  We verify the properties of D one at a time, starting with out-degrees. Fix any two distinct vertices a,b, and let Na,b be the number of ordered pairs (x,y) produced by Step 1 such that {a,b,x},{b,x,y}∈H. It suffices to show that with probability 1  -  o(n- 3), [formula]. (Note the factor of 2 because D has n / 2 vertices.) For this, first let Sa,b be the set of ordered pairs (x,y), not necessarily produced by Step 1, such that {a,b,x},{b,x,y}∈H. This is a deterministic set, from the hypergraph H, whose size we can estimate by applying (ε,p)-uniformity to H with various auxiliary graphs Γ. Indeed, by applying the property with Γ1 (in Figure [\ref=fig:gamma]) and (a,b), the number of choices for x such that {a,b,x}∈H is (1  ±  ε)np. Then, given such a choice for x, applying uniformity with Γ1 and (b,x) shows that there are (1  ±  ε)np choices for y such that {b,x,y} is also an edge. Putting these estimates together, we conclude that |Sa,b|  =  (1  ±  3ε)n2p2. Since ε2(n2p2)2  /  n3  ≫   log n, Lemma [\ref=lem:pairs-kept] gives [formula] with the desired probability.

The arguments for the other properties are very similar. For in-degrees, we fix a pair of distinct vertices (a,b), and apply uniformity with Γ1 to show there are (1  ±  ε)np choices for y such that {y,a,b}∈H. Applying again on (y,a), we find a further (1  ±  ε)np choices for x such that {x,y,a}∈H. This is exactly the same estimate as we had in the out-degree case above, so the same argument completes it.

To control the common out-degrees of pairs of vertices in D, we fix 4 distinct vertices of H, arranged in two pairs (a,b) and (c,d). Applying uniformity with Γ2 (see Figure [\ref=fig:gamma]), there are (1  ±  ε)np2 choices for x such that {a,b,x},{c,d,x}∈H. After fixing such a choice for x, another application of uniformity with Γ3 (see Figure [\ref=fig:gamma]) shows that there are (1  ±  ε)np2 choices for y such that {b,x,y},{d,x,y}∈H. Therefore, there are (1  ±  3ε)n2p4 pairs (x,y) which could serve as the terminal vertex of both directed edges from (a,b) and (c,d), if only (x,y) appeared as a pair in Step 1. Since ε2(n2p4)2  /  n3  ≫   log n, we may apply Lemma [\ref=lem:pairs-kept], and finish as before.

A similar argument controls d-(a,b) in D. To establish the last part of property (ii) of (5ε,p2)-regularity for D, fix any 4 distinct vertices in H arranged in two pairs (a,b) and (c,d). Applying uniformity with Γ1 (see Figure [\ref=fig:gamma]), there are (1  ±  ε)np choices for x such that {a,b,x}∈H. Fix such an x. Applying uniformity again with Γ4 (see Figure [\ref=fig:gamma]), with (b,x,c,d) corresponding to the labels in Figure [\ref=fig:gamma], we see that there are (1  ±  ε)np3 choices for y such that all of {b,x,y},{x,y,c},{y,c,d}∈H. Hence there are (1  ±  3ε)n2p4 choices for a pair (x,y) which would be both an in-neighbor of (a,b)∈D and an out-neighbor of (c,d)∈D, if only (x,y) appeared as a pair in Step 1. Thus Lemma [\ref=lem:pairs-kept] finishes this case as before.

For property (iii) of (5ε,p2)-regularity for D, fix any 8 distinct vertices in H, arranged in 4 pairs (a,b), (c,d), (e,f), and (g,h). Applying uniformity with Γ2 shows that there are (1  ±  ε)np2 choices for x such that both {a,b,x},{c,d,x}∈H. Then, after fixing such an x, applying uniformity with Γ5 (see Figure [\ref=fig:gamma]) shows that there are (1  ±  ε)np6 choices for y such that all {b,x,y},{x,y,e},{y,e,f},{d,x,y},{x,y,g},{y,g,h}∈H. Hence there are (1  ±  3ε)n2p8 choices for a pair (x,y) which would out-neighbors of both (a,b),(c,d)∈D and in-neighbors of (e,f),(g,h)∈D, if only (x,y) appeared as a pair in Step 1. Since ε2(n2p8)2  /  n3  ≫   log n, we may apply Lemma [\ref=lem:pairs-kept], and finish as before. [formula]

Next we prove the analogue of Lemma [\ref=lem:gamma-cover], establishing that repeated runs of Procedure 3 will cover the edges of H fairly uniformly.

Suppose n and ε satisfy εn  ≫  1. Let H be an (ε,p)-uniform 3-graph on n vertices (n even), and randomly and independently construct [formula] digraphs [formula] according to Procedure 3. Let Hi be their corresponding 3-graphs. Then, with probability 1  -  o(n- 1), every edge of H is covered [formula] times by the Hi.

Proof.  Fix an edge {a,b,c} of H, and let q be the probability that it is covered by H1. There are several ways in which this can happen. First, it could be that (a,b) is a pair from the permutation σ1 for H1, and (c,x) is another pair, with {b,c,x} also an edge of H. Let us bound the probability q1 of this particular event happening. Let t be the number of choices for x such that {b,c,x}∈H. In terms of t, we have [formula]. To see this, first expose the position of a; it is in the first half of an ordered pair with probability 1 / 2. Next, b must be occupy the second position in that ordered pair, and then c must select a first half spot in one of the remaining ordered pairs. Finally, there are t valid choices for c's partner. But by (ε,p)-uniformity applied with Γ1 (Figure [\ref=fig:gamma]), t  =  (1  ±  ε)np. So (using [formula]), [formula].

The above argument can be run with any permutation of a,b,c. Also, it could be that c occupied the second position in its ordered pair, e.g., if (x,c) and (a,b) were the pairs involved. Therefore, [formula]. Since the r random constructions are independent, the number of times {a,b,c} is covered is [formula], which has expectation [formula]. The Chernoff bound implies that the probability that the Binomial deviates from its mean by more than a factor of 1  ±  0.01ε is at most Taking a union bound over all O(n3) edges {a,b,c}, we obtain the desired result. [formula]

Next, we prove a result which will serve the same purpose as Lemma [\ref=lem:gamma-rare-consec] of the previous section. Procedure 3 constructs a digraph D on half as many vertices by pairing up the vertices of H. Let us say that a set S of 4 vertices of H is condensed in D if two of those pairs above contain all 4 vertices in S. For example, if S  =  {a,b,c,d}, and two vertices of D are the ordered pairs (b,c) and (d,a), then S is condensed in D.

Suppose r  ≪  n3 / 2. Construct r independent Di according to Procedure 3. Then with probability 1  -  o(n- 1), every set S of 4 vertices in H is condensed in at most 9 of the Di.

Proof.  For a fixed set of 4 vertices {a,b,c,d}, the probability that it is condensed in D1 is precisely [formula]. To see this, first expose the position of a in the permutation σ1 which defines D1. This identifies the position which contains the other vertex in a's pair; expose the vertex in that spot. The probability that it is b, c, or d is precisely [formula]. Assuming this is the case, there are still two vertices of interest left, say c and d. Then expose the position of c. This identifies the position which contains the other vertex in c's pair; expose the vertex in that spot. The probability that it is d is precisely [formula].

Since the Di are independent, the number of them which have the above property with respect to {a,b,c,d} is stochastically dominated by [formula]. Since we assumed r  ≪  n3 / 2, the probability that this exceeds 9 is at most so a union bound over all O(n4) choices for {a,b,c,d} completes the proof. [formula]

We now formulate the analogue of Procedure 2 for the hypergraph setting.

Procedure 4.  This takes as input a 3-graph H with an even number of vertices, and an integer parameter r.

Independently generate the random digraphs [formula] according to Procedure 3, and let Hi be their corresponding 3-graphs.

For each edge e∈H let [formula]. If [formula], independently select a uniformly random index in Ie to label e with.

For each Di, define the subgraph Di' by keeping each edge [formula] if and only if both of its corresponding 3-graph edges are labeled by i.

For each i, let Hi' be the 3-graph containing all hyperedges which correspond to the directed edges left in Di'. Note that e(Hi')  =  2e(Di').

As in Procedure 2, the final step ensures that the Hi' are all disjoint, so Lemma [\ref=lem:hamilton-di-hyp] shows that we can work on each Di' independently, packing Hamilton cycles with Theorem [\ref=thm:digraph]. Then, we will remove all Hi' from H, and repeat. The next result establishes the necessary pseudo-random properties of the Di'.

Suppose n, p, and ε satisfy ε18np16  ≫   log 9n. Let H be an (ε,p)-uniform 3-graph on n vertices (n even), and conduct Procedure 4 with [formula]. Let [formula]. Then, with probability 1  -  o(n- 1), every Di' is [formula]-uniform.

Proof.  Our restrictions on ε,n,p allow us to apply Lemma [\ref=lem:d] (ε2np16  ≫   log n) and Lemma [\ref=lem:d-cover] (ε  ≫  n- 1), so we have that with probability 1  -  o(n- 1), after Step 1 of Procedure 4:

Condition on the above outcome of Step 1, and consider an arbitrary Di'. It suffices to show that in the randomness of Step 2, with probability 1  -  o(n- 3) each individual Di' has the desired properties, since r  =  o(n2) by the given restrictions on ε,n,p. We start by verifying out-degrees. A vertex v∈Di' corresponds to a pair of vertices (a,b) from H. For each edge of Di which is directed away from v, there is a distinct pair of vertices (x,y) from H. That directed edge remains in Di' if and only if both of its associated hyperedges {a,b,x},{b,x,y} receive label i. This happens with probability - 2 by property (b) above. Yet property (a) ensures that the number t of such directed edges in Di is [formula], so the expected out-degree of v in Di' is [formula].

For concentration, note that all of the 2t hyperedges associated with the t directed edges are distinct, so their labels are generated independently. Therefore, by the Chernoff inequality, the probability that the out-degree of v in Di' deviates from its expectation by more than a factor of 1  ±  ε is at most because ε2np2  /  κ2  =  Θ(ε6np2  /   log 2n)  ≫   log n. Therefore, with probability 1  -  o(n- 4), the degree of v in Di' is [formula]. Taking a union bound over all v∈Di establishes uniformity for out-degrees.

All other properties of [formula]-uniformity follow by a similar argument. Importantly, in each case, all directed edges correspond to disjoint pairs of hyperedges, so we can always use the Chernoff inequality to establish concentration. The smallest mean we ever deal with is [formula], from property (iii) of uniformity for Di', so the largest error in concentration is at most where we use ε2n(p2  /  κ2)4  =  ε18np8  /   log 8n  ≫   log n. [formula]

We now move to show how the hypergraph H is affected by the deletion of all hypergraphs Hi'. As before, we use inclusion/exclusion to sandwich the quantities in question, using an accurate "first-order" estimate, together with a rough "second-order" upper bound.

Condition on the first step of Procedure 4 covering every edge of H (1  ±  1.03ε)κ times by the Hi. Fix any two distinct vertices a,b∈H, and a set S of vertices such that {a,b,x}∈H for all x∈S. Suppose that ε2|S|  /  κ3  ≫   log n. Then with probability 1  -  o(n- 8), the number N of vertices x∈S such that {a,b,x} is covered by the Hi' is [formula],

Proof.  Let [formula]. Since we are conditioning on the result of Step 1, the only randomness left is in the independent exposure of all hyperedge labels, most of which are irrelevant for N. We define F, the set of relevant edges, as follows. For each Hj which covers some e = {a,b,xi}, there is a partner edge f = φj(e) such that e remains in Hj' if and only if e and f receive the label j. Let F be the collection of all partner edges obtained in this way, together with all {a,b,xi}. Since we assume every {a,b,xi} is covered at most (1  +  1.03ε)κ times by the Hj, we always have |F|  ≤  2κ|S|. Observe that all labels outside F have no effect on N at all, so we may condition on an arbitrary setting of those labels, leaving only |F| independent labels to be exposed.

Next, we show that the probability that a particular edge e = {a,b,xi} is covered by the Hj' is - 1. To see this, note that after revealing the label j of e, there is a single partner edge f = φj(e), whose label must match that of e. Since f is covered (1  ±  1.03ε)κ times by the Hi, it has probability - 1 of receiving that label j. Therefore by linearity of expectation, [formula].

We use the Hoeffding-Azuma inequality to establish the concentration of N, as the remaining randomness is a product space of dimension |F|  ≤  2κ|S|. Consider the effect of changing the label of a hyperedge e  =  {x,y,z}∈F from i to j. Note that its old partner edge φi(e) overlapped with e in two vertices, but also included a new vertex, say w. Changing the label of e away from i could potentially remove any or all of x,y,z,w from the count for N (if φi(e) had received label i), so this could potentially reduce N by up to 4. Similarly, setting the label of e to j can potentially increase N by up to 4. Therefore, N is 4-Lipschitz, so the Hoeffding-Azuma inequality implies that the probability that N deviates from its expectation by more than [formula] is at most where we used ε2|S|  /  κ3  ≫   log n. Therefore, with probability 1  -  o(n- 8), we have [formula], as desired. [formula]

Having proved an accurate "first-order" estimate, we move to the "second-order" upper bound (analogous to Lemma [\ref=lem:d-delete-co-out]). In the 3-graph setting, this breaks into two cases, which we treat in the following two lemmas.

Condition on the first step of Procedure 4 covering every edge of H (1  ±  1.03ε)κ times by the Hi. Fix any distinct vertices a,b,c,d∈H and any set of vertices S such that both {a,b,x},{c,d,x}∈H for all x∈S. Suppose that |S|  /  κ5  ≫   log n. Then with probability 1  -  o(n- 8), the number N of vertices x∈S which still have both {a,b,x} and {c,d,x} covered by the Hi' is at most [formula].

Proof.  Again, the only remaining randomness is in the labeling of the hyperedges in Step 2. Also, since each edge is covered by at most (1  +  1.03ε)κ of the Hj, less than 2κ  ·  2|S| of them are relevant for N, for the same reason as in the previous proof. So, we may condition on all labels for irrelevant edges, and focus on the remaining product space over the relevant edges F.

Let us bound the probability that a particular x∈S remains in the count for N. First, expose the labels for e  =  {a,b,x} and f  =  {c,d,x}, and suppose they are k and l. Let their partner edges be e'  =  φk(e) and f'  =  φl(f). Importantly, e' cannot equal f, because e' must overlap with e in two vertices. Hence the label of e' has not yet been exposed. Similarly, the label of f' has not yet been exposed. However, note that it may happen that e'  =  f'.

In order for x to remain in the count for N, e' must receive label k and f' must receive label l. First we show that if e'  =  f', then the probability of this occurring is 0. Indeed, if k  ≠  l, it clearly cannot happen. But otherwise, if k  =  l, it is impossible for e'  =  f' in the first place, because in Hk, each edge has a distinct partner edge, so e' and f' should be distinct.

On the other hand, if e'  ≠  f', the probability that these independent labels equal k and l is at most - 2, because each edge is covered by at least (1  -  1.03ε)κ of the Hj. Therefore, we conclude that in all cases, the probability of a certain xi remaining in the count for N is at most [formula], so [formula].

Finally, the same argument that we used in the proof of Lemma [\ref=lem:h-delete-1] shows that N is 4-Lipschitz over the product space of dimension |F|  <  4κ|S|. Hence the probability that N exceeds its expectation by more than [formula] is at most since we assumed |S|  /  κ5  ≫   log n. Therefore, with probability 1  -  o(n- 8), we have [formula], as desired. [formula]

Condition on the first step of Procedure 4 covering every edge of H (1  ±  1.03ε)κ times by the Hi, and on the property that every set of 4 vertices of H is condensed in at most 9 of the Di. Fix any distinct vertices a,b,c∈H and any set of vertices S such that both {a,b,x},{b,c,x}∈H for all x∈S. Suppose that |S|  /  κ5  ≫   log n. Then with probability 1  -  o(n- 8), the number N of vertices x∈S which still have both {a,b,x} and {b,c,x} covered by the Hi' is at most [formula].

Proof.  Again, the only remaining randomness is in the labeling of the hyperedges in Step 2, so we may concentrate on the product space of dimension |F|  ≤  2κ  ·  2|S|, where F is the set of all edges {a,b,x},{b,c,x} and their possible partners.

To bound the probability that a particular x∈S remains in the count for N, expose the labels for e  =  {a,b,x} and f  =  {b,c,x}, and suppose they are k and l. Let their partner edges be e'  =  φk(e) and f'  =  φl(f). This time, it is possible for e'  =  f or f'  =  e, but that can only happen if the 4 vertices a,b,x,c are condensed in Dk. Furthermore, if k  ≠  l, then x is automatically excluded from the count for N, which is not a problem because we only seek an upper bound.

Therefore, the probability that x contributes to N is at most q1  +  q2, where q1 is the probability that e and f both receive the same label k, with a,b,x,c condensed in Dk, and q2 is the conditional probability that e' and f' receive labels k and l, given the exposure of the labels of e and f, and e'  ≠  f, f'  ≠  e. We assumed that a,b,x,c were only condensed in at most 9 of the Dj, so [formula].

As for q2, the same argument that we used in the previous lemma shows that if e'  =  f', then we must have had k  ≠  l, so it is impossible for e' to receive k and f' to receive l, hence x cannot contribute to N. The only remaining case is e'  ≠  f', and the probability that both receive the correct label is at most - 2. Putting everything together, we conclude that the probability that x contributes to N is at most [formula], so [formula].

Finally, the same argument that we used in the previous proof again establishes the Lipschitz constant of 4 for N in the product space of dimension |F|  <  4κ|S|. Hence the probability that N exceeds its expectation by more than [formula] is at most since we assumed |S|  /  κ5  ≫   log n. Therefore, with probability 1  -  o(n- 8), we have [formula], as desired. [formula]

Now we combine our first-order and second-order bounds, and show that the pseudo-random properties of H are maintained after deleting all Hi'.

Suppose n, p, and ε satisfy ε10np6  ≫   log 6n. Let [formula] and [formula]. Let H be an (ε,p)-uniform 3-graph on n vertices (n even), and conduct Procedure 4. Let H' be the subgraph of H obtained by deleting all edges covered by any Hi'. Then, with probability 1  -  o(n- 1), H' is an (ε',p')-uniform 3-graph with [formula] and [formula].

Proof.  By applying Lemmas [\ref=lem:d-cover] and [\ref=lem:d-rare-close], the outcome of Step 1 of Procedure 4 will satisfy the following two properties with probability 1  -  o(n- 1). (The second follows since (ε2p)5  ≫  n- 1, and so r  ≪  n3 / 2.)

Every edge of H is covered (1  ±  1.03ε)κ times by the Hi.

Every set of 4 vertices of H is condensed in at most 9 of the Di.

Condition on this outcome. We will now show that in the remaining randomness of Step 2, the properties of (ε',p')-uniformity are satisfied with probability 1  -  o(n- 1). For this, fix a set of t  ≤  7 vertices [formula], and let Γ be an arbitrary t-vertex graph with s  ≤  6 edges. It suffices to show that in H', the random variable [formula] is (1  ±  ε')nps with probability 1  -  o(n- 8), because we can then take a union bound over all O(n7) choices for the vi, and all O(1) possibilities for Γ.

Let S be the set of all x such that {vi,vj,x}∈H for every edge ij∈Γ. Our assumed (ε,p)-uniformity gives |S|  =  (1  ±  ε)nps. We will use a similar inclusion/exclusion argument as in the proof of Lemma [\ref=lem:digraph-delete] to estimate X in terms of |S|. Let [formula] be the edges of Γ. For each [formula], define the random variable Xk as follows. Let i,j be the endpoints of edge ek. Then let Xk be the number of vertices x∈S such that {vi,vj,x} is covered by some Hl'. Also, for every two distinct [formula], let the random variable Xk1k2 count the number of vertices x∈S such that both {vi1,vj1,x} and {vi2,vj2,x} are covered by some Hl', where i1,j1 and i2,j2 are the respective endpoints of e1 and e2. In terms of these random variables, the principle of inclusion/exclusion always gives Since we noted above that |S|  =  (1  ±  ε)nps  =  Ω(np6), we have ε2|S|  /  κ3  ≥  Ω(ε8np6  /   log 3n)  ≫   log n, so Lemma [\ref=lem:h-delete-1] controls all [formula] with probability 1  -  o(n- 8). Also, since |S|  /  κ5  ≥  Ω(ε10np6  /   log 5n)  ≫   log n, Lemmas [\ref=lem:h-delete-2-disjoint] and [\ref=lem:h-delete-2-incident] show that every [formula] with probability 1  -  o(n- 8).

Putting everything together, and using s  ≤  6 and [formula], we have Now observe that Again using [formula], we bound the error term by [formula]. Therefore, we have as desired. [formula]

We finally finish the proof of Theorem [\ref=thm:3graph]. The method is essentially the same as that used to prove Theorem [\ref=thm:digraph] in the previous section.

Proof of Theorem [\ref=thm:3graph].  Let H0  =  H, ε0  =  ε, and p0  =  p. Define the sequences (εt), (pt) via the following recursion:

[formula]

Let T be the smallest index such that [formula]. Note that εt only increases, so

[formula]

Also note that since we have in general that [formula]. Therefore,

[formula]

We now iteratively construct [formula], such that each Ht is (εt,pt)-uniform. Indeed, consider the (random) Procedure 4 applied to Ht with respect to [formula]. Let [formula]. This produces digraphs Dt,i' and 3-graphs Ht,i' with all Ht,i' disjoint. Let Ht + 1 be the result of deleting all Ht,i' from Ht. To apply Lemmas [\ref=lem:d-prime] and [\ref=lem:h-delete], we must check that ε18tnp16t  ≫   log 9n. But this follows from our initial assumption that ε45np16  ≫   log 21n since εt  ≥  ε and [formula]. Therefore, the two lemmas show that with probability 1  -  o(n- 1), Procedure 4 results in the following properties:

We may assume this outcome, since we will only iterate T  =  o(n) times. In order to apply Theorem [\ref=thm:digraph] to each Dt,i', we must verify that [formula]. Indeed, this is the case: by our initial assumption that ε45np16  ≫   log 21n. So, every Dt,i' can be packed with Hamilton cycles, missing only an ε1 / 8t-fraction of the edges. By Lemma [\ref=lem:hamilton-di-hyp], these edge-disjoint Hamilton cycles in Dt,i' correspond to edge-disjoint Hamilton cycles in Ht,i', missing the same fraction of edges since there is a 2-to-1 correspondence between edges in Ht,i' and Dt,i'.

We carry on the above procedure until we create HT. Then, we will have packed Hamilton cycles in [formula], up to error of ε1 / 8T - 1-fraction. It remains to estimate the numbers of edges in HT and H. Note that in general, by applying (ε,p)-uniformity to every pair of vertices (using Γ1 in Figure [\ref=fig:gamma]), we can estimate the number of edges in any (ε,p)-uniform 3-graph to be [formula], because this counts every hyperedge 3! times. Thus H has at least [formula] edges, and HT has at most [formula] edges. Thus HT itself has at most [formula]-fraction of the total number of edges.

Therefore, the fraction of edges of H that have not been covered is at most since ε1 / 8T - 1  ≪  ε1 / 15 by inequality [\eqref=eq:3epsilon-T]. This completes the proof. [formula]

Remark.  The above proof showed that we can pack the edges of H with Hamilton cycles, up to a fractional error of at most εc, where c  =  1 / 15. In fact, one can prove the same result for any c  >  1 / 13, and all of the calculations can be recovered by following our proof. Just as in Section [\ref=sec:digraph], we intentionally introduced a very high level of precision in Lemma [\ref=lem:d-cover]. It is clear that the same argument can replace the 1.03 with 1.003, etc. These smaller order errors are what accumulate into the decimal places in the final 6.6 which appears in Lemma [\ref=lem:h-delete], and which later determines the value of c. When 6.6 is replaced by a constant arbitrarily close to 6, the above argument produces a result with c approaching 1 / 13.

Concluding remarks

Our proof of Theorem [\ref=thm:3graph] is only valid when n is divisible by four, because we required a factor of 2 in each reduction step (from hypergraphs to digraphs, and then to bipartite graphs). Although we do not expect this condition to be necessary, removing this restriction is open. We also leave open the question of packing Hamilton cycles of type [formula] in k-uniform hypergraphs when k  ≥  4 and [formula]. Finally, another interesting direction is to streamline the sets of pseudo-random properties which appear in the statements of our packing results (both for digraphs and for 3-graphs).