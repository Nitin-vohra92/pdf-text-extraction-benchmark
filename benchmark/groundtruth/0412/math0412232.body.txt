The existence of maximum likelihood estimates in the Bradley-Terry model and its extensions

Dalhousie University and University of Bern

Introduction

A paired-comparison experiment is used to assess the relative worths of t objects when they can only be compared two at a time, and when the result of such a comparison yields only the result that one of the objects was preferred to the other (or, possibly, that the two objects in the comparison were equally preferable). The most commonly-used model for data from such an experiment is that of , with extensions by and . These models yield estimates of the probability that one object will be preferred to another. give an extensive bibliography of Bradley-Terry and related models.

Applications of the Bradley-Terry model include taste-testing, in which each comparison is carried out by a judge, and sporting competition, in which the objects are players or teams and comparisons represent games between them, with preferences corresponding to wins and losses (or ties). In this paper, we use for definiteness the terms "teams" and "games" to refer to the objects and comparisons, though our results apply more widely.

A drawback of the Bradley-Terry model is that it is possible for estimated probabilities to equal 0 or 1, and therefore the maximum likelihood estimates of the parameters are not guaranteed to exist (in the sense of being in the interior of the parameter space). This was noted by , who gave a necessary and sufficient condition for the estimated probabilities to lie strictly between 0 and 1 in Bradley and Terry's original model.

The Bradley-Terry model and its extensions can be viewed as special cases of (binomial and trinomial) logistic regression models. and give conditions which determine whether the maximum likelihood estimates in logistic regression are finite or infinite, and give linear programs and other methods for determining the effect of any nonexistent parameter estimates on the estimated probabilities.

In this paper, we use the results of and to show that a simple procedure, based on ideas of graph theory, leads to a complete analysis of a paired comparison experiment using the original Bradley-Terry model and one of its extensions, even when the maximum likelihood estimates do not all exist. We also demonstrate that variations on this procedure apply to the other extensions of the model. In Section [\ref=secbt], we review the Bradley-Terry model and its extensions; in Section [\ref=secnotie] we consider estimation when the only possible outcomes are wins and losses, and in Section [\ref=sectie] we consider what happens when ties are included in the model. Finally, we discuss the presentation of results from our methods in Section [\ref=secpres] and give some illustrative examples in Section [\ref=secex].

Bradley-Terry model and extensions

Bradley and Terry's original model

The model assumes that each team has a "worth" or "strength" πi  ≥  0 reflecting the i-th team's tendency to win (or lose). The πi are determined only up to ratios, and so in practice an additional condition, such as [formula] or πt = 1, is imposed to force the maximum likelihood estimates to be well-defined. The Bradley-Terry model asserts that the probability pij of team i defeating team j is

[formula]

equivalently, πi  /  πj represents the odds in favour of i defeating j. (The Bradley-Terry model is therefore a "proportional-odds" model.)

If each pair of teams i and j play nij games against each other with team i winning yij of them, and all games are assumed independent, the likelihood is seen to be

[formula]

shows that the likelihood equations require the observed and expected numbers of wins for each team to be equal (where the expected number of wins is the sum of win probabilities over games played by the team).

An order effect

In taste testing, an object may be more likely to be preferred simply because it is presented first rather than second; in sports, a team is typically more likely to defeat another when playing at home. This "order effect" or "home field advantage" can be included in the model by assuming the probability of i defeating j in that order (that is, with team i at home) to be

[formula]

The additional parameter γ  ≥  0 represents the advantage of being first (playing at home); it is assumed to be the same for all teams. This model was proposed by . As in Section [\ref=secbtone], the likelihood equations equate the observed and expected wins for each team; the additional equation for γ equates the observed and expected wins for the home team over all games played.

Team-specific order effects

It is often the case that a single home field (order) effect is consistent with the data, though this may be because there is insufficient data to prove that a separate home field effect is necessary for each team. Nonetheless, it is straightforward to generalize ([\ref=eqhomeprob]) to allow team-specific home field effects. This is most easily done by observing that we are effectively treating "team i at home" and "team i on the road" as completely separate entities. Letting πiH denote the strength of team i at home and πiV the strength of team i on the road (as "visiting team"), the probability pij of team i defeating team j with i at home can be modelled as

[formula]

and the likelihood equations now equate observed and expected home and road wins for each team (a total of 2t equations for the 2t parameters, though one equation and one parameter are redundant).

Ties and the Bradley-Terry model

If one of the possible outcomes of a comparison is "no preference" (that is, "tie"), then this should be included in the model. One straightforward approach is simply to count a tie as half a win and half a loss and use ([\ref=btorig]), ([\ref=eqhomeprob]) or ([\ref=allhomeprob]) as appropriate. This violates the binomial assumption underlying those models, but can work well in practice if the goal is simply to estimate the strengths of the teams (rather than estimating probabilities). proposed a generalization of the Bradley-Terry model that allows for a tie as a third outcome. Letting pijk denote the probability of outcome type k (k = 1 if i wins, k = 2 if j wins, k = 0 if a tie), the generalization is

[formula]

The additional parameter ν  ≥  0 reflects the tendency for ties to happen, and is assumed to be the same for all teams. This model has two desirable properties: the conditional probability of i defeating j, given a non-tie, is as in ([\ref=btorig]), and the probability of a tie, for fixed ν, is maximum when πi  =  πj. The likelihood equation for ν equates the observed and expected ties over all games; the remaining equations now equate the observed and expected points for each team, where one point is given for a win and half a point for a tie (or equivalent such as two points for a win and one for a tie).

show how ties and order effects may be modelled simultaneously; it is also possible to combine the above model with ([\ref=allhomeprob]).

Team-specific tie effects

Model ([\ref=eqtieprob]) assumes that all teams have the same tendency to tie games, and this may not always be reasonable. For example, found that some chess players tend to draw more matches than others, even after allowing for the strength of opposition faced. In this case, one can replace ν by a νi for each team, as follows:

[formula]

with the likelihood equations now equating the observed and expected points and ties (and therefore wins) for each team. This model can also be combined with one containing order effects.

Numerical methods

describes the following procedure for the model ([\ref=btorig]): the likelihood equations set, for team i,

[formula]

and therefore

[formula]

This can be treated as a fixed-point iteration, using the current parameter values on the right-hand side to produce an updated value for the parameter on the left. Ford shows that, if the maximum likelihood estimates π̂i all exist, the values from the iterative procedure will converge to the maximum likelihood estimates. Convergence is generally slow, but the procedure is reliable and easy to program. The same idea can be used in the extensions to the Bradley-Terry model.

Several other iterative procedures are available, such as those described and compared in . These also assume that the parameter estimates π̂i all exist. They tend to require fewer iterations than Ford's method, but have greater computational cost per iteration so that an overall improvement in speed is not guaranteed.

However, the existence of the π̂i is not normally apparent, and if one or more of the π̂i is actually infinite or zero, an iterative procedure will only converge slowly, if at all. Indeed, the usual reason for such a procedure to reach its iteration limit is that some parameter estimates do not exist.

Estimation with win/loss outcomes

Introduction

When parameter estimates may not exist, a much more satisfactory approach is first to identify the nonexistent ones (and hence the fitted probabilities that are 1 or 0), and only then to apply an iterative procedure if necessary. showed that, in ([\ref=btorig]), the estimates will all exist if and only if there is no division of the teams into two groups A and B such that every game between a team in A and a team in B was won by the team in A. More generally, in logistic regression, some observations may have fitted probabilities that are 0 or 1, and it is desired to isolate and remove these observations before applying an iterative procedure to estimate the remainder of the probabilities; this is the problem addressed by and .

Simple Bradley-Terry model

The model ([\ref=btorig]) is written as a logistic regression model by letting βl  =   log πl; showed that the existence of maximum likelihood estimates in such a model was connected with the existence of certain solutions to the corresponding logistic discrimination problem. In the present context, that problem is defined by requiring

[formula]

if there exists at least one game in which i has defeated j.

and then characterize the cases in which maximum likelihood estimates fail to exist by defining "complete separation", "quasi-complete separation" and "overlap". For complete separation, there must exist βi satisfying ([\ref=eqsep]) with strict inequality for all observations. In this case, all the fitted probabilities (for outcomes which actually occurred) and the maximized likelihood itself are 1. For quasi-complete separation, there must exist βi satisfying ([\ref=eqsep]) with at least one strict inequality and at least one equality. In this case, the maximum of the likelihood is less than 1, but some of the fitted probabilities are 1. Overlap occurs otherwise (that is, when the only solution to ([\ref=eqsep]) is with equality and all the βi are equal); in this case, it is shown that all the maximum likelihood estimates all exist and all the estimated probabilities lie strictly between 0 and 1. (Note that the βi in a sense play a dual rôle: for determining the separation properties of the data, we are concerned only with the existence of non-equal βi solving the discrimination problem; the βi in the likelihood itself for our regression problem represent the relative strengths of the teams, and the values will be different in the two contexts. For clarity, we will, as much as possible, work with β when discussing the question of separation and π when dealing with maximum likelihood estimates.)

For any two teams i and j, define the relation ≥   by i  ≥  j if there is a game in which i has defeated j. (Note that we can have i  ≥  j and j  ≥  i, if for instance i and j have played twice and won one game each.) For consistency in the sequel, we also define i  ≥  i to be true for each team i.

Define the relation [formula] by [formula] if i  ≥  j or if there exist teams [formula] such that [formula]. Now consider the t teams as vertices of a directed graph G which has an edge from vertex i to vertex j if i  ≥  j. Determining whether the relation [formula] holds for a pair of teams k and l is equivalent to determining whether there is a path in the directed graph from the vertex representing k to that representing l - that is, whether there is an edge from k to l in the transitive closure [formula] of G. The transitive closure of a graph can be computed in O(t3) time by an algorithm due to Floyd and Warshall - see, for example, .

For each pair of teams i and j, [formula] or not and [formula] or not. Define the relations [formula] as follows:

[formula]

It is possible, though redundant, to define i  ≪  j if and only if j  ≫  i. Further, [formula] since i  ≥  i and hence [formula].

It is easily seen that [formula] is an equivalence relation and that ≫   is an ordering. We assert that when [formula], the fitted probability of i defeating j lies strictly between 0 and 1, when i  ≫  j, the fitted probability is 1, and when [formula], the fitted probability is arbitrary since there is no basis for comparison between i and j.

To apply the Albert-Anderson-Santner-Duffy theory, we assign βi such that βi  =  βj if [formula]. For i  ≫  j, we assign values such that βi  >  βj. These assignments are possible since [formula] is an equivalence relation and ≫   is an ordering. Provided that all teams have played at least one game, this permits values to be assigned to all βi. In each case, the numerical values of the βi are arbitrary; it is only the ordering that is of importance.

To show that this correctly identifies complete separation, quasi-complete separation, and overlap, note first that [formula] if and only if [formula] and [formula]. Thus there exist (possibly empty) strings of teams such that [formula] and [formula]. The discrimination equation ([\ref=eqsep]) implies that [formula] and [formula]. This can only be satisfied by βi  =  βj. Thus βi  =  βj if and only if [formula]. When i  ≫  j, however, βi  >  βj; at least one of the inequalities in the chain must be strict since otherwise [formula] as well. Finally, if [formula], neither [formula] nor [formula], which means that no chain of inequalities between βi and βj in either direction can be inferred from the discrimination equation. Thus there exist solutions with either sign of βi  -  βj. (This is only possible if i and j did not play one another, and thus is only relevant to the probabilities of outcomes of games which did not occur.) It follows that if no pair of teams is related by [formula], the βi may all be chosen to be different, and we have complete separation. If there exist teams i and j with [formula] and also teams k and l with k  ≫  l (or [formula]), we take βi  =  βj and βk  >  βl, indicating quasi-complete separation. Finally, if all teams are related by [formula], then βi  =  βj for all i,j, and so we have overlap.

The identification of outcomes with 0 or 1 probabilities allows us to replace the probability of a win for i in a game against j in ([\ref=btorig]) with

[formula]

An "arbitrary" probability is one whose value is not determined by the data (i.e., there exist maximum likelihood solutions with all values, between and including 0 and 1, for the probability in question). The effect of the modified definition of probability on the maximum likelihood equations is to remove from the calculation any games whose outcomes have maximum likelihood probabilities of 0 or 1. The resulting strength estimates π̂i are all guaranteed to exist and can be found by methods such as those discussed in Section [\ref=secbtfive]. Maximum likelihood estimates of unit (or vanishing) probability are now associated with a ≫   relationship between teams, rather than an infinite (or zero) ratio of strength parameters.

Team-specific order effects

In Section [\ref=secbtthree], it is noted that team-specific home field advantage parameters can be modelled by considering each team's home performances independently of its road performances. The separation properties of the data can therefore be determined exactly as in Section [\ref=secestone] with 2t items, the home and road versions of teams [formula].

Single order effect

If in ([\ref=eqhomeprob]) we let βl  =   log πl and η  =   log γ, the Albert-Anderson discrimination condition for a game between i and j with i at home and winning (losing) is

[formula]

If we reparameterize, defining βlH  =  βl  +  η / 2 and βlV  =  βl  -  η / 2, the condition becomes

[formula]

(H represents "home team" and V "visiting team".) This is the condition of Section [\ref=sectshfa], but since we have overparameterized, we also have that

[formula]

since each difference is equal to η. In inferring [formula] relationships between the teams, we therefore need to take into account ([\ref=eqhomeres]) as well as ([\ref=eqhomefirst]). Equation ([\ref=eqhomeres]) has two implications:

If there exists a set of teams [formula], with r  ≥  2, such that [formula], then βlH  ≥  βlV for all teams l, since η  ≥  0. (The difference between the sum of the left-hand sides of the inequalities and the sum of the right-hand sides is rη.) The same applies with H and V interchanged.

If βiH  ≥  βjH for any teams i,j, then βiV  ≥  βjV for those teams and conversely, since βi  ≥  βj.

The procedure of Section [\ref=secestone] is therefore no longer sufficient. An iterative scheme will be necessary in its place, since knowledge that η  ≥  (  ≤  )0 provides additional information about whether βiH  ≥  (  ≤  )βiV, and conversely. Note, however, that if we once determine that η  ≥  0, we do not need to check again (since the implications for βiH and βiV are fixed); the same applies separately when 0  ≥  η.

To determine whether η  ≥  0, we need to find a chain of inequalities, as described above, beginning and ending at the same team. Unless we already have that βkH  ≥  βkV for some k, this is most easily done by constructing a directed graph GH which has vertices representing the teams [formula] and edges from i to j whenever βiH  ≥  βjV (that is, when [formula]). In GH, no vertex k is considered connected to itself, since we only construct GH if [formula] does not hold for any k. We then compute the transitive closure H of GH, and determine whether it contains any edges from a vertex k to itself, in which case βkH  ≥  βkV and hence η  ≥  0.

To determine whether η  ≤  0, the same technique can be applied with H and V interchanged.

This leads to the following algorithm:

[formula] and [formula] for each team l (for completeness).

For each game, let i be the home team and j the visiting team. If i defeated j, [formula]; otherwise, [formula].

Construct a directed graph G with the 2t vertices [formula] and edges connecting those vertices related by [formula]. Compute the transitive closure [formula] of G; any edges (k,l) in [formula] but not G imply an additional [formula] relationship between items k and l.

If [formula] for any k, set [formula] for all k, and go to Step [\ref=stepsix]. Otherwise, construct a directed graph GH with vertices [formula] and edges from i to j whenever [formula]. Compute its transitive closure H. If H contains an edge from some vertex l to itself, set [formula] for all k.

If [formula] for any k, set [formula] for all k, and go to Step [\ref=stepfour]. Otherwise, construct a directed graph GV with vertices [formula] and edges from i to j whenever [formula]. Compute its transitive closure V. If V contains an edge from some vertex l to itself, set [formula] for all k.

For each i and j, if [formula], then [formula], and conversely.

If steps [\ref=steptwo] through [\ref=stepfour] on the current cycle added any [formula] relationships, go back to step [\ref=steptwo]; otherwise, stop.

It is computationally most convenient to maintain the directed graph G as an adjacency matrix, in which the [formula] relationships can be found and updated directly.

The maximum number of [formula] relationships is 4t2, so the maximum number of iterations of steps [\ref=steptwo] through [\ref=stepfour] is bounded. Often, in practice, only one or two iterations are necessary.

To determine the probabilities whose maximum likelihood estimates are 1, 0 or arbitrary, we find which relation, [formula] applies between each pair of items, where a item is an entity such as iH, a team with a venue attached. (Note that even if iH  ≫  jV, it is perfectly possible to have [formula], depending on the magnitude of the home field advantage.) Then, instead of using ([\ref=eqhomeprob]), we define the probability of i defeating j with i at home as

[formula]

Once again, using this modified probability formula in the maximum likelihood equations effectively removes games whose outcomes have maximum likelihood probabilities of 0 or 1 from the data set, and produces a solution in which [formula] and all the π̂i exist.

Estimation in the presence of ties

Reparameterization

The discrimination conditions for models containing ties can be written most conveniently if we define parameters which cast the two versions of the model (single or team-specific tie parameters) in the same notation, by defining [formula] in the model ([\ref=eqtieprob]) or [formula] in ([\ref=alltieprob]), so that the relative probabilities of a win, tie, or loss for team i in a game against team j are πi, πi +πj +, and πj, respectively. (Note that the model with team-specific tie parameters could in fact be defined in this way, with the πi + taking the place of the νi as independent parameters.) For convenience, we also define πi -  =  πi  /  πi +, which means that the relative probabilities of a win or tie for team i against team j are πi - and πj +, respectively.

show that, if the response variable in a logistic regression has g categories, then each observation contributes g - 1 conditions on their α. In the presence of ties, therefore, each game gives two conditions on the βi. If we write βi  =   log πi and βi +  =   log πi + in either of the models with ties, the conditions are

[formula]

if i defeats j, and

[formula]

if the result is a tie.

If we define an additional parameter βi -  =  βi  -  βi +  =   log πi -, the conditions take on the simpler form

[formula]

if i defeats j, and

[formula]

if the result is a tie.

To determine which results have maximum-likelihood probabilities which are 0 or arbitrary, we need to find the exhaustive set of inequalities which apply among the t parameters [formula] and also among the 2t parameters [formula] as a result of the conditions ([\ref=eqconda]) and ([\ref=eqcondd]), along with auxiliary conditions relating βi, βi +, and βi -. These will be different depending on whether the model contains a single tie parameter or one for each team.

Single tie parameter

If there is only one tie parameter, the definitions of the parameters imply βi  ± = (βi  ±   log ν) / 2. This means that the discrimination conditions can be re-cast without reference to βi by replacing ([\ref=eqconda]) with the conditions

[formula]

by adding or subtracting log ν from both sides. The auxiliary relationship

[formula]

is identical to the condition ([\ref=eqhomeres]) given in Section [\ref=secsingleord], so the procedure determining the complete set of inequalities applying to this model is the same as that in the model with a single order effect, even though it is being applied in a different context. Specifically:

[formula] and [formula] for each team l (for completeness).

For each game in which i defeated j, [formula], [formula], and [formula]. For each game in which i tied j, [formula] and [formula].

Carry out the corresponding steps from the single-order-parameter algorithm of Section [\ref=secsingleord], with H replaced by +   and V by -  .

Once the full set of [formula] relationships has been determined, they can be used to determine the ≫  , [formula], or [formula] relationships between the 2t items [formula]. Since i +  is guaranteed by step [\ref=stepfour] of the algorithm to have the same relationship with j +  as i -  does with j -  (and to allow an analogy with the following section), it is convenient to refer to that relationship as holding between i and j. For example, if i +   ≫  j +  (which means i -   ≫  j - ) we say i  ≫  j.

From these relationships, we can conclude that the maximum likelihood estimates of certain probabilities are 0, 1 or arbitrary. However, with three possible outcomes, we may have one outcome whose estimated probability is zero, while the remaining two probabilities are both estimated to be nonzero. Tables [\ref=tabfourone] and [\ref=tabfourtwo] show, respectively, the maximum-likelihood probabilities of wins and ties taking the relationships into account. The maximum likelihood estimates π̂i,π̂j,π̂i +,π̂j + are guaranteed to exist.

In the Tables, note that the combination of relationships which gives an arbitrary probability for any result is only possible if the two teams have not actually played. Note also that in some cases (for example [formula], [formula], [formula]) the ratio of the probabilities of two outcomes can be well-defined and finite, with the ratio of either to the probability of the third outcome unconstrained by the data. That is, the conditional probabilities of the first and second outcomes, given that the third outcome does not happen, lie strictly between 0 and 1. However, in this case we still consider all three probabilities to be arbitrary.

If the maximum likelihood estimates are zero for two of the probabilities pij0,pij1,pij2, the third probability is estimated to be 1, and any such games can simply be removed from the data set before estimating the remaining probabilities. However, in games where exactly one outcome is constrained to have zero probability, the modified probabilities from Table [\ref=tabfourone] and [\ref=tabfourtwo] must be used to leave only those outcomes out of likelihood maximization. Since the likelihood equations here equate observed and expected points for each team (where points are defined as in Section [\ref=secbtfour]), as well as observed and expected overall ties, this means that we must restrict our calculations to those outcomes whose probabilities are known to lie strictly between 0 and 1.

If we make the obvious generalization that yijk is the number of games between i and j with outcome k, and take pijk from Tables [\ref=tabfourone] and [\ref=tabfourtwo], the likelihood equations become, for each πi,

[formula]

and for ν,

[formula]

These equations yield a method analogous to Ford's for finding the maximum likelihood estimates. In the first set of equations, a factor [formula] can be removed from the right-hand side and isolated, and in the last equation the same can be done with ν. Then, in each case, a fixed-point iteration can be carried out.

Team-specific tie parameters

In the case of a team-specific tie parameter model, the auxiliary equations describing the overparameterization that exists due to the introduction of the extra t parameters [formula] are

[formula]

These do not lend themselves to a direct simplification of ([\ref=eqconda]), but allow us to infer some inequalities among parameters by adding and subtracting others. For example, if βi +  ≥  βj - and βi -  ≥  βj +, we can add the two inequalities to infer βi  ≥  βj. This produces the following algorithm for determining the [formula] relationships amongst the teams [formula] as well as the items [formula]:

[formula], [formula], and [formula] for each team l (for completeness).

For each game in which i defeated j, [formula] and [formula]. For each game in which i tied j, [formula] and [formula].

Construct a directed graph G with vertices [formula] and with edges from i to j if [formula]. Compute the transitive closure [formula] of G. Any edges (k,l) in [formula] but not G imply additional relationships [formula]. Repeat with the directed graph G +  whose edges are the 2t items [formula].

For each pair of teams i and j:

If [formula] and [formula], then [formula];

If [formula] and [formula], then [formula];

If [formula] and [formula], then [formula];

If [formula] and [formula], then [formula];

If [formula] and [formula], then [formula];

If [formula] and [formula], then [formula].

If steps [\ref=loopstart] or [\ref=loopend] on the current cycle added any [formula] relationships, go back to step [\ref=loopstart]; otherwise, stop.

As in Section [\ref=secsingleord], it is computationally convenient to maintain G and G +  as adjacency matrices, for ease of determination and updating of the [formula] relationships.

Once we have obtained the full set of [formula] relationships among the t teams and the 2t team-and-sign items, we use them to find the [formula], ≫  , and [formula] relationships among teams and between the "plussed" teams [formula] and the "minussed" teams [formula]. These can then be used to identify the outcomes whose maximum-likelihood probabilities vanish and to deduce correctly the remaining estimated probabilities pijk according to Tables [\ref=tabfourone] and [\ref=tabfourtwo]. Again, this procedure permits a maximum likelihood solution for the remaining probabilities with parameter estimates that exist. This time, the likelihood equations are, for each πi,

[formula]

and for each νi,

[formula]

Again, a Ford-like iterative process can be constructed. In the first set of equations, a πi can be factored out of the right-hand side and isolated, and in the second set, the same can be done with either [formula] or πi +.

Presentation of results

Introduction

Our procedures yield maximum likelihood estimates for all the probabilities pij (or pijk in the presence of ties), but these probabilities may be determined from the existence of, say, a ≫   relationship rather than from finite parameters that represent the strengths of the teams. It is, nonetheless, desirable to have a "strength" measure for each team regardless of whether the parameter estimates all exist; for example, we may wish to produce a rank ordering of the teams.

Simple Bradley-Terry model

Here, the maximum-likelihood solution is completely specified by a partition of the teams into equivalence classes according to the [formula] relation defined in Section [\ref=secestone], the relations (≫   or [formula]) between classes, and the estimated πi for each team, defined up to an overall multiplicative factor within each class. This does not permit easy comparison of teams in different classes.

To provide a ranking of the teams even in the presence of [formula] relationships, as well as a single number with a concrete interpretation, we can define the round-robin winning percentage, or "RRWP". This is the proportion Ri of games a team would be expected to win if they played each other team an equal number of times (as in a "balanced schedule" or "round-robin tournament"), and is given by the average of that team's estimated winning probability against all of the other teams:

[formula]

Arbitrary pij are (for definiteness) set equal to [formula] in this calculation. This allows the RRWP to be defined given any set of results. This definition gives a sensible ordering of the teams, since if pij > pji for a pair of teams i and j, then (because pik  ≥  pjk for any other team k), Ri > Rj. If two teams are related by [formula], and thus the maximum likelihood probability of one defeating the other is arbitrary, the RRWP can be used to provide a somewhat arbitrary ordering of them. We do not have enough information to compare such teams directly in the Bradley-Terry model, but the RRWP in effect pulls to the middle of the rankings teams with many arbitrary pij, those teams being "unknown quantities".

In the case where the teams have actually played a balanced schedule, each team's RRWP will be equal to its actual winning percentage. This is a manifestation of the familiar result that the Bradley-Terry model reproduces ordering by won-lost record in the case of a balanced schedule ("complete block design" in the language of ). However, this definition extends to the case where some teams are related by ≫  , in which case there are maximum likelihood estimates of parameters in the traditional Bradley-Terry model that do not exist.

Order effects

In the presence of order effects, either single or team-specific, the definition of RRWP must be generalized to include the home field advantage. The quantity pij is now the predicted probability for i to win a game at home against j, and because of the home field advantage pji  ≠  1 - pij in general. Note that the "diagonal" probability pii is a measure of the strength of the home advantage; with a single order effect, it is simply γ / (1 + γ), while with team-specific order effects, pii measures the difference between team i's performances as a home team and as a visiting team.

A logical generalization of the RRWP to a model with order effects is the percentage of games a team would be expected to win if they played each other team once at home and once on the road:

[formula]

Once again, arbitrary pij are replaced in the sum by 1/2, and if the teams have actually played this kind of round-robin, each team's RRWP will be equal to its actual winning percentage. In a model with a single order effect where the home advantage parameter exists ([formula] for all k), Ri > Rj if i  ≫  j, or if [formula] and πi  >  πj.

Models with ties

When ties are allowed in the model, the concept of RRWP must be generalized. Our procedures now give estimated probabilities pijk of each result (win, loss or tie) in games between each pair of teams. We can use the pijk to obtain the predicted number of wins, losses, and ties for each team in a round-robin schedule. The predicted round-robin percentage Rik of outcome k for team i is

[formula]

As in Sections [\ref=secbtfour] and [\ref=secbtfive], k = 1 denotes a win for team i, k = 2 a win for team j, and k = 0 a tie. All arbitrary probabilities for a particular hypothetical (unplayed) game are assigned equal weight, so that if all three probabilities (win, loss, or tie) against a particular opponent are arbitrary, they are all assumed to be 1 / 3 in the sum, while if one probability pijk vanishes, the other two are assumed to be 1 / 2. One could of course define a more sophisticated method of making this assignment, taking into consideration known ratios of unknown probabilities, or the overall proportion of ties, but we only present the simplest method here.

These round-robin proportions can be used to define a RRWP, according to the traditional definition of a tie as a half a win and a half a loss, by

[formula]

In the single tie parameter model, if pij1 > pij2, then Ri > Rj. This means that if no teams are related by [formula] the ranking of the teams by strength and by RRWP will be identical. This is not true in the model with team-specific tie parameters, as illustrated in Section [\ref=secexrank].

The round-robin proportions predicted by the team-specific tie parameter model will always agree with the actual fractions of games won, lost, and tied by each team after a balanced schedule has been completed. For the model with a single tie parameter, it is only the combination wins-plus-half-losses (or equivalent) which has this property. Thus, with team-specific tie parameters, there is nothing special about counting a tie as half a win; indeed, given any system awarding ck points for outcome k, we can define a "round-robin points per game", RRPPG, that is equivalent to RRWP if the point system is a linear transformation of [formula]:

[formula]

After a round-robin tournament with this point system, the points obtained per game by each team will be equal to Ti. This implies that the Ti may sensibly be used to rank the teams after any collection of games.

The world standard for soccer, for example, sets c1 = 3,c2 = 0,c0 = 1 - that is, three points for a win and one for a tie. A model with a single tie parameter (or the idea, mentioned in Section [\ref=secbtfour], of counting ties literally as half a win and half a loss) is no longer reasonable here, since the teams could be ranked differently by Ti and by points even at the end of a balanced schedule (because the observed and expected proportions of ties for each team may not match). Instead, it is necessary to fit team-specific tie parameters and then rank the teams by Ti, since then observed points per game will equal Ti after a balanced schedule.

Examples

Example 1

Suppose there are four teams, a,b,c,d. Teams a and b play twice, winning one game each, and c and d do the same. Team a plays c once, with a winning. Even though each team has at least one win and at least one defeat, it is seen that there is still a separation between the groups {a,b} and {c,d}, because the only inter-group comparison is a's win over c.

Applying the procedure of Section [\ref=secestone] gives the relations a  ≥  b,  b  ≥  a,  c  ≥  d,  d  ≥  c,  a  ≥  c. Hence [formula] directly and [formula] indirectly, from computing the transitive closure. These are all the [formula] relationships, and so the teams are related as follows:

[formula]

In other words, a and b as a group are "infinitely stronger" than c and d as a group, and the maximum likelihood probability of a team in {a,b} defeating a team in {c,d} is 1.

The maximum likelihood estimates for the probabilities of a defeating b and for c defeating d are both (unsurprisingly) 0.5, and so the RRWP's for a, b, c and d are 0.833, 0.833, 0.167 and 0.167 respectively.

Example 2

Suppose four teams play the following games. The first-named team is at home in each case, and we will want to fit a home field advantage.

a vs b: a wins

b vs a: b wins

c vs a: a wins

c vs d: c wins

d vs c: d wins

(This is in fact the same set of games as in Example 1.)

The procedure of Section [\ref=secsingleord] is concisely expressed in the table below. A number in a particular row and column denotes a [formula] relationship between the items of that row and column; the number itself denotes the number of the step at which that [formula] relationship was added. An asterisk denotes that the [formula] relationship was added on the second iteration. A third iteration failed to add any more [formula] relationships.

The relationships between each H-team and each V-team are therefore (the ≪   relation between CH and AV of course means AV  ≫  CH):

The RRWP's apply to each of teams a,b,c,d as a whole (averaged over the items representing their home and road performances, as in ([\ref=eqrrwptwo])).

The estimated probabilities of the events that occurred are all 1, and hence the maximum value of the likelihood is 1. This result contrasts with Example 1, which was based on the same data, but without a home field effect. The home field advantage in this Example is overwhelming, to the extent that the winner of a game between a and b is predicted "with certainty" to be the home team, but the difference in strength between a and c is so large that it even overcomes this home field advantage. Finally, since aV  ≫  cH but [formula], the RRWP for team a is greater than that for team b, as shown.

Example 3

Suppose now that three teams a, b, c play a round-robin in which each team meets the others four times, as follows:

The won-lost-tied records of these three teams are as follows:

With a single tie parameter, the algorithm of Section [\ref=secsingletie] shows that all items [formula] are related [formula]: the likelihood is maximized by probabilities strictly between 0 and 1. The estimated probabilities are:

and the round-robin wins, losses, and ties per game, and RRWP, are:

Team b is estimated to be stronger than team c, since pbc1 > pbc2, which is not surprising considering that b has 7 points in the round-robin (2 points for a win and 1 for a tie), while c has only 6. Note that the RRWP agrees with the actual winning percentage for each of the three teams, but the round-robin wins, losses, and ties per game for each team predicted by the model do not agree with the actual numbers.

If we apply the algorithm of Section [\ref=sectietwo] to fit team-specific tie parameters, we obtain the [formula] relationships shown in the two tables below. A number in a table indicates, as previously, that the teams or items in question are related by [formula], with the number itself indicating the step at which the [formula] was found.

This shows that a -   ≫  c +  and c -   ≫  a + , with all other relevant relationships being [formula]. (Only relationships of the form i vs.  j, i +  vs. j -  with i  ≠  j concern games that can be played.) From the second Table of Section [\ref=secsingletie], the estimated probability of a tie between a and c is zero. The entire set of estimated probabilities is:

and the RRWP values are:

Note now that team c is estimated to be stronger than b, since its probability of winning against b is higher than its probability of losing. In other words, under the team-specific tie parameter model, the ranking of teams by strength no longer necessarily agrees with the ranking under a point system of 2 per win and 1 per tie. The explanation here is that b has almost no chance of defeating a, but gains a substantial number of points against a from ties - enough, in fact, to overcome its deficit of points from games against c.

Note also that in this model the predicted proportions of round-robin wins, losses, and ties for each team agree with the observed proportions.

Example 4

In Fall 1998, the Western Athletic Conference (WAC), an American collegiate sports association, had 16 members. For (American) football competition, these were divided geographically into two divisions. Each team played all the other teams in its own division, but faced only one opponent from the other division. The teams, their abbreviated names and their division membership are shown in the first three columns of Table [\ref=tab:kenwac]. "Mtn" denotes Mountain division, "Pac" Pacific. Game results were obtained from .

We focus on three subsets of the game results: the games played before October 18, those played before October 25, and all the games played in the regular season. There were no ties, and we have chosen not to model any home field advantage. Model ([\ref=btorig]) was fitted to each subset of the data, and RRWP calculated for each team as in Section [\ref=secpresone]. Table [\ref=tab:kenwac] summarizes the wins, losses and RRWP for each team and subset.

The RRWP values do not show which relationships, [formula], ≫  , ≪   or [formula], hold between each pair of teams. These are depicted in Figure [\ref=fig:kenrels] for each of the three subsets of the data. The relation [formula], as described in Section [\ref=secestone], divides the teams into equivalence classes; in this example, all the classes except one contain only one team (which is used to label the class), while the remaining class, labelled "Others", contains all the remaining teams. The vertical position of the classes on the page is determined by RRWP; an arrow connecting two classes denotes a ≫   relationship between them. (For simplicity, arrows implied by transitivity are not shown; thus, for example, Wyo. ≫   UNM in all three diagrams.)

Most teams played only three games before October 18. As a result, there are numerous ≫   and [formula] relationships among the teams, and the relationship diagram, shown in Figure [\ref=fig:kenrels]a, is complicated. However, the diagram explains two apparent anomalies in the RRWP values from Table [\ref=tab:kenwac]: SDSU's three wins came against teams that lost all their games, explaining the low RRWP of .600, while BYU's low RRWP of .233 comes from defeating two winless teams (Hawaii and UNLV) and losing to FSU, which was FSU's only win.

Each team played once between October 18 and October 25, with the results shown in Table [\ref=tab:weektwo]. Results where the winning team was already related to the losing team by ≫   or [formula] do not affect the relationships, but a relationship of [formula] changes to ≫   and one of ≪   changes to [formula], pending the results of other games. Thus BYU and FSU join SJSU and UTEP in the "Others" class, while now SDSU ≫   Utah and UNM ≫   Hawaii. This simplifies the relationship diagram considerably, as shown in Figure [\ref=fig:kenrels]b. Note that Utah now has the third-highest RRWP because the team's two losses came against the top two teams.

At the end of the season, the relationship diagram was as shown in Figure [\ref=fig:kenrels]c. Thirteen of the sixteen teams are now related [formula], so that estimated win probabilities for games between these teams are strictly between 0 and 1, and can be estimated with standard techniques. UNM, UNLV and Hawaii are still related ≪   to the "Others" class, since none of these teams have any wins against teams in the "Others" class. Because UNM ≫   Hawaii but UNLV [formula] UNM and Hawaii (that is, UNM's only win of the season came against Hawaii, while UNLV played neither team), the three teams' RRWP's rank as shown in the last column of Table [\ref=tab:kenwac].

The final RRWPs for the teams in the "Others" class generally agree with the teams' won-lost records. Differences in RRWP between teams with the same numbers of wins arise for two reasons: the Mountain division is stronger overall than the Pacific, and some teams faced a stronger opponent in their inter-divisional game than others. For example, Air Force (Mountain) came out ahead of SDSU and BYU (Pacific), while SDSU was ahead of BYU because their inter-divisional opponents were Tulsa and UNLV respectively. On the other hand, Rice and CSU had identical 5-3 records and had interdivisional opponents with identical 3-5 records, so both pairs of teams ended with identical RRWP's.

Discussion

In the Bradley-Terry model, we have shown that the separation properties of the data, and therefore the determination of the probabilities estimated to be 0 or 1 by maximum likelihood, can be found by considering the transitive closure of certain graphs. This makes for straightforward computation, and avoids the need for the linear programming routines that are required for logistic regression in general. We also suggest that the Round-Robin Winning Percentage (RRWP) or Round-Robin Points Per Game (RRPPG) provide a sensible way of summarizing the results, because they are defined regardless of the separation properties of the data.

One practical application of the RRWP (or RRPPG) is to provide "mid-season" rankings for a league of teams which will eventually play a balanced schedule, but have not yet completed it. At the end of the season, the each team's RRWP will be equal to the actual winning percentage used by the league to order the final standings, but when only part of the season has been played, the RRWP should be a more accurate measure of a team's performance to date, as it considers the strength of the completed portion of their schedule. Another application would be to a league which, because of considerations such as travel or length of season, does not play a balanced schedule. Traditionally, the teams in such leagues are ranked according to winning percentage, which benefits teams who happen to play weaker opponents more often.

We also note that in models with team-specific order effects (such as ([\ref=allhomeprob]) or team-specific tie parameters (such as ([\ref=alltieprob])), there is more than one parameter per team, so that ranking the teams by a single strength parameter is either impossible (in the former case) or not necessarily desirable (in the latter). RRWP and RRPPG provide a uniform means for ranking which may be preferable depending on the application.

Aknowledgments

We would like to thank G. Hatfield and R. Stagat for useful discussions of applications of the Bradley-Terry model. JTW acknowledges support by the Swiss Nationalfonds, and by the Tomalla Foundation, Zürich.