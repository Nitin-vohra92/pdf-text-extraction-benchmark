Calculating the r- n Interactions, 1  ≤  n < 3, in a Periodic System with a Neutralizing Background Charge Density

Introduction

Simulation of atomic systems very often entails the calculation of the Coulomb interaction of point charges. The commonly used periodic boundary conditions embed the simulation box in an infinitely periodic system. The interaction energy per unit cell volume of this infinitely periodic system, of N charges zi, [formula], can be written as

[formula]

Here [formula] represents the lattice vectors defined by the simulation box, and the prime on the sum excludes the term [formula] when i = j. The Coulomb interaction corresponds to the case n = 1. To make the discussion and derivation slightly more general, the inverse power is allowed to vary in the range 1  ≤  n  <  3. It has been shown that when 1  ≤  n  ≤  3, the sum converges only when the overall neutrality is met, i.e., [formula] [\cite=Williams_71]. For n = 1, the sum is conditionally convergent, i.e., the value of the sum depends on the order in which the terms are added. An elegant, conventional way to calculate this sum, the Ewald summation, introduces a convergence function that separates the sum into two components. The first component converges rapidly in the real space and the second converges rapidly in the Fourier space [\cite=Ewald_21] [\cite=Nijboer_57] [\cite=Tosi_64] [\cite=Frenkel_96]. The [formula] term, being the reciprocal lattice vectors, in the Fourier space depends on the shape of the infinitely periodic system [\cite=De_Leeuw_80] [\cite=Smith_81] and can be recast as a surface integral [\cite=Deem_90]. Its value can be determined analytically in simple cases or evaluated numerically in the general cases. Ignoring this term corresponds to the boundary conditions with an infinite dielectric constant [\cite=Frenkel_96]. Faster algorithms for the calculation of the Coulomb interaction have been developed, and references can be found in a recent review paper [\cite=Schlick_99].

Problems arise during simulation of charged systems when some ions are treated implicitly. For example, when a peptide with basic or acidic amino acids is embedded in a shell of water molecules, the explicit charges may not meet the neutrality condition and, hence, result in an infinite energy. One possible way to overcome this problem is to add counter ions or fictitious charges in a way to maintain charge neutrality [\cite=Falconi_98]. This paper presents an alternative way to arrive at a finite energy, by adding to the system a uniform, neutralizing charge density [formula], Vc being the volume of the simulation box, or unit cell. This background charge density adds negligible amount of computational time, and the result obtained from this derivation may be useful in practical simulations. It allows for a computationally convenient approach to ionic systems where some ions and atoms are treated implicitly. In particular, it facilitates simulations of ionic systems in the grand canonical ensemble, where charged molecules can be added to or removed from the system. The accommodation of the inverse power n = 2 may provide useful expressions for screened Coulomb interactions. For example, one way to model the solvent effects in the AMBER forcefield [\cite=Weiner_86] [\cite=Cornell_95] for biological systems is use a distance-dependent dielectric constant such as ε  /  ε0  =  4r, where r is in Å [\cite=Guenot_92]. Therefore, the screened Coulomb interaction is proportional to r- 2 and can be calculated by the results developed for n = 2.

This paper is organized as follows. In Sec. [\ref=sec:devel] a Ewald based, computationally useful expression for the energy of this system is derived. It is shown that that an extra term proportional to [formula] arises when the explicit charge neutrality does not hold. The result and the [formula] term originating from the boundary conditions are discussed in Sec. [\ref=sec:discuss]. The conclusion is given in Sec. [\ref=sec:conclude].

Development

Consider in a infinitely periodic system the potential ψi contributed by a point charge zi located at , and its neutralizing uniform density ρi =  - zi / Vc. For 1  ≤  n  <  3, the potential can be written as

[formula]

where L is the characteristic dimension of the periodic system and

[formula]

is a cutoff function that is added to specify the shape of the periodic system. The vector represents the geometrical center of the cell, [formula]. The procedure of including the shape of the volume followed by taking the limit is non-trivial and leads to the [formula] term in the Coulomb interaction case [\cite=Deem_90]. Note that when n  ≥  3, [formula] diverges due to the singularity at [formula]. Next, we introduce a convergence function φ(r), which tends rapidly to zero at infinity. This convergence function is used to split [formula] into two components:

[formula]

Here [formula] and [formula] stand for the short-ranged and long-ranged parts of the sum, respectively. Assuming the convergence function φ(r) decays fast enough so that each term in [formula] is finite, the limit L  →    ∞   can be formally taken and

[formula]

Note that the average of ψ(R)i over the simulation box is zero:

[formula]

where [formula] denotes integration over the simulation box. The long-ranged [formula] is best evaluated by rewriting it as a sum of Fourier components. Let [formula] denote the Fourier transform

[formula]

The Fourier components of [formula] are non-zero only at the reciprocal lattice vectors . Therefore,

[formula]

where

[formula]

For n = 1, [formula] leads to the non-vanishing [formula] term as L  →    ∞  . However, it diminishes when n > 1. We shall neglect this term for now and discuss it later in Sec. [\ref=sec:discuss].

Uses of Eqs. ([\ref=eqn:poten_split]), ([\ref=eqn:psi_i_r]), and ([\ref=eqn:psi_i_kn0]) give

[formula]

Now we add up the contributions from all charges and the background density and let the total potential be [formula]. The total interaction energy, per unit cell volume, is therefore

[formula]

The bracketed term in Eq. ([\ref=eqn:total_e]) stands for the potential acting on the point charge i, and can be rewritten as

[formula]

Here [formula] is the structure factor. If we ignore the surface contribution, the [formula] term is zero, as is the second term at the right hand side of Eq. ([\ref=eqn:total_e]). Finally, substituting Eq. ([\ref=eqn:psi_i_m_self]) into Eq. ([\ref=eqn:total_e]) yields an expression for the total energy:

[formula]

The convergence function φ(r) should be chosen in a way that each term of Eq. ([\ref=eqn:total_e_gen]) is finite and computable. One possible choice is [formula] [\cite=Williams_71], where Γ(n / 2) and Γ(n / 2, αr2) are the gamma function and the incomplete gamma function, respectively. The parameter α adjusts the contributions from the real and the reciprocal parts and should be optimized for the system of interest. With this choice of φ(r), the Fourier transform of [formula] has been shown to be [\cite=Nijboer_57]

[formula]

and

[formula]

The short-ranged part of the contribution from the background charge density can be evaluated analytically to be

[formula]

Therefore, the interaction energy can be written as

[formula]

In the Coulomb interaction case, n = 1, φ(r) is the complementary error function [formula] and Eq. ([\ref=eqn:U_useful]) is reduced to the Ewald sum [\cite=Frenkel_96] plus an extra term proportional to [formula]:

[formula]

For n = 2, ψ(r)  =   exp ( - αr2) and the corresponding equation is

[formula]

Discussion

The [formula] term described by Eq. ([\ref=eqn:psi_i_k0]) does not diminish when n  ≤  1. Let [formula]. When [formula] is multipole-expanded and the limit L  →    ∞   is taken, the first term becomes zero due to charge neutrality. Thus, the leading term in [formula] is the second term, which is non-zero only at the surface of the periodic system and can be recast as

[formula]

where

[formula]

is the "center of mass" of the simulation box, [formula] is the dipole moment of the simulation box, and S(L) is the surface of the volume with a characteristic dimension L. Note that both the explicit charges and the background charge density contribute to the dipole moment. It is interesting to see that [formula] is the only term that contributed to the average potential over the simulation box, i.e.,

[formula]

Note that the average of both the short-ranged part and the [formula] terms over the simulation box is zero.

The contribution of [formula] to the energy per unit cell is

[formula]

Substituting the expression for [formula] into Eq. ([\ref=eqn:surface_U]) gives

[formula]

Clearly, this term diverges when n < 1 and diminishes when n > 1 as L  →    ∞  . For n = 1 it contributes a finite energy to the system [\cite=Deem_90]. It is interpreted as the interaction between the dipole moment of the system and the surface charges at the boundary. Ignoring this term corresponds to using boundary conditions with an infinite dielectric constant.

It is worth mentioning that, for the n > 3 case, an expression having the same form as Eq. ([\ref=eqn:U_useful]) was derived in ref. [\cite=Williams_71] without the addition of a neutralizing background charge density. Here the same equation is extended to the case 1  ≤  n  <  3 with a different physical interpretation.

Conclusion

The r- n interaction energy, 1  ≤  n < 3, for a infinitely periodic system with charges and a neutralizing, uniform background charge density is derived. Following the Ewald transformation, the interaction energy is split into a real space sum and Fourier space sum, and both are rapidly convergent. The Ewald based expression for this energy has an extra term proportional to the square of the total explicit charge of the system. This expression may be useful for simulations in which explicit charge neutrality does not hold or for which the total explicit charges is a fluctuating quantity.