Corollary Lemma Conjecture Claim

Combinatorial and Probabilistic Formulae for Divided Symmetrization

Let V be set of variables, |V| = m, say, [formula] (but further we need different sets, like {x2,x3,x9}). It is convenient to think that V is well ordered: [formula]. For a rational function (with coefficients in some field) φ of variables from V, define its symmetrization as [formula], where summation is taken over all m! permutations π of variables.

Let f be polynomial of degree d in variables from V. Then, its divided symmetrization

[formula]

is also polynomial of degree not exceeding d - m(m - 1) / 2, in particular, it vanishes identically when d < m(m - 1) / 2. The reason why DS(f) is polynomial is the following. Fix variables x,y and partition all summands into pairs corresponding to permutations (π,σπ), where σ is a transposition of x and y. We see that in the sum of any pair multiple x - y in denominator is canceled. Thus every multiple is canceled and so we get polynomial.

Let G(V,E) be a graph on the set of vertices V. We view E as a set of pairs (x,y)∈V2, x < y. We may consider "partial symmetrization in G", that is,

[formula]

Of course this is a polynomial again of degree at most d - |E| due to the obvious formula

[formula]

If we restrict DSG to polynomials of degree at most |E|, we get a linear functional. The kernel KG of this functional is particularly structured. First of all, all polynomials of degree less then d lie in KG. Next, if f has a symmetric factor: f = gh, g is symmetric and non-constant, then f∈KG. This is true because of the formula DSG(gh) = gDSG(h), and the second multiple being equal to 0 since deg h < |E|.

Assume that G is disconnected. That is, [formula], and there are no edges of G between U and W: [formula], where EU,EW are sets of edges joining vertices of U,W respectively. Denote the corresponding subgraphs of G by GU = (U,EU) and GW = (W,EW). Note that both U,W are well ordered sets of variables and thus above the definitions still work for the subgraphs GU,GW.

Any polynomial f may be represented as a sum [formula], where the polynomials ui depend only on variables from U, while wi depends only on variables from W (and, of course, the degree deg ui  +   deg wi of each summand does not exceed deg f). Assume that deg f  ≤  |E|. Then

[formula]

(the binomial factor comes from fixing the sets of variables π(U) and π(V). If deg ui < |EU| then the symmetrization DSGU(ui) is just 0, analogously if deg wi  <  |EW|. If deg ui = |EU|, deg wi = |EW|, then both DSGU(ui), DSGW(wi) are constants and therefore do not depend on the sets of variables π(U), π(V)). It follows that f∈KG if for any i either ui∈KGU or wi∈KGW. As already noted above, it is so unless deg ui = |EU|, deg wi = |EW|. If f has a factor symmetric in the variables from U, then DSGU(ui) = 0.

Next observation. If E'  ⊂  E and [formula] that [formula]. Combining this with our previous argument, we get the following

If E'  ⊂  E and U  ⊂  V is a connected component in [formula], f is divisible by [formula], where h is symmetric in variables from U, then f∈KG.

Denoting by IG the set of polynomials v such that vh∈KG provided that deg vh  ≤  |E| (it is a sort of ideal, but the set of polynomials with restricted degree is not a ring), we have found some elements in IG: all symmetric polynomials and all polynomials like those in Lemma [\ref=lem1].

Now we restrict our attention to the following specific situation. Let m = n + 1, [formula], E(G) = {(xi,xi + 1),0  ≤  i  ≤  n - 1}. For notational simplicity, denote Φ(f) = DSG(f), K = KG, I = IG. Also denote [formula]. We have yn∈I and yk(xk + 1 - xk)∈I for [formula].

Let's show how this helps to calculate, say, Φ(xni).

[formula]

Induction on n. The base case n = 1 (or even n = 0) is straightforward. Denote ci  =  Φ(xni). We have [formula], since symmetric polynomials lie in K. Next, denoting e = (xk,xk + 1)∈E we get

[formula]

by [\eqref=eq1] and by the induction assumption. We obtain n + 1 linear relations on [formula] which determine them uniquely and also the numbers [formula] satisfy those relations. This finishes the induction step.

This lemma and many other nice formulae for Φ are obtained recently by T. Amdeberhan in [\cite=T].

Now, consider the product

[formula]

Proceed as follows. At first, replace xn - 1 by xn - 2 in this product. Next, replace xn - 2 by xn - 3, and so on. Finally we get n!xn0. The value of Φ does not change after such replacements. Indeed, when we replace xk + 1 by xk, we add (to our polynomial) a quantity divisible by [formula]. This is an element of I, hence what we add lies in K. Thus

[formula]

For any homogeneous polynomial [formula] of degree n, we have

[formula]

Taking [formula] recovers Corollary 6.5 of [\cite=P].

It suffices to prove Theorem [\ref=Postnikov] for monomials [formula], [formula]. We are interested only in cyclic type of [formula], and for cyclic type [formula] this follows from [\eqref=eq2] and the fact that yn∈I. Denote by [formula] the function of a cyclic vector [formula] which is defined as the difference between two parts of [\eqref=eq3]. It helps to remember that I contains yn and yk(xk - xk + 1) = yk(2yk - yk - 1 - yk + 1) (we may think that indices are taken modulo n, then it is true for all k). Thus we have [formula] and [formula] if c1  ≥  2. These relations imply that Q is always 0. Indeed, if, say, Q attains positive values and [formula] is maximal, and c1  ≥  2, then we see that [formula] and [formula] are other maximizers. It is easy to see that by such operations we may come to cyclic type [formula] and so get a contradiction.

The above proof is indirect in the sense that it does not say explicitly what Φ(h) is. This is partially fixed in the following description in terms of a probabilistic sandpile-type process.

Consider n coins distributed somehow among the vertices of a regular (n + 1)-gon, which are enumerated by [formula]. Choose any vertex v containing at least 2 coins and rub it: take 1 coin from the vertex v and put either to left or right neighbor of v with equal probability. Proceed until it is possible. The number of vertices with at least 1 coin does not decrease. When it stabilizes, there is an empty vertex v, and its neighbor u we should rub u finitely often, else with probability 1 v becomes non-empty. Analogously consider neighbor of u and verify that with probability 1 it must be rubbed finitely often and so on. So, with probability 1 the process terminates in a finite time. Next, the ultimate distribution of configurations does not depend on the choice of the rubbed vertex at every turn. This follows from the facts that operations commute, and any vertex with at least 2 coins must be rubbed at some point before the process terminates.

There are n + 1 possible final configurations (one empty vertex and n vertices wih 1 coin).

Assume that initially we have ci coins at vertex [formula]. Then the probability [formula] that vertex n is empty in the final configuration equals [formula].

We have [formula], [formula] when cn > 0 and for all i

[formula]

The same three properties are shared by the function [formula]. But they define the function uniquely, as the argument with maximum principle (very much the same as in the proof of Theorem [\ref=Postnikov]) shows.

By cyclic symmetry, [formula] is the probability that in the final configuration vertex i - 1 is empty. Summing over all i, we get [formula], where summation indices are cyclic modulo n + 1. This is another proof of Theorem [\ref=Postnikov].

Now we consider arbitrary tree.

Let T = (V,E) be a tree on a well ordered set V, |V| = n. Let [formula] be a monomial of degree n - 1, where we call [formula] a weight of a vertex x. The total weight of all vertices equals - 1. For each edge e = (x,y)∈E, x < y, consider two connected components of the graph [formula]. The total weight is negative for exactly for one of them. If this component contains y, call edge e regular, else call it inversive. Define sign [formula] as [formula]. Call a permutation π of the set V C-acceptable if for all edges e = (x,y), π(x) < π(y) if and only if e is regular.

The partial divided symmetrization DST(C) of the monomial C equals the number of C-acceptable permutations times [formula].

Induction on n. The base case n = 1 is obvious. Assume that n > 1 and the assertion is valid for n - 1. For any monomial C denote by τ(C) the number of C-acceptable permutations times [formula]. We need to check that τ(C) = DST(C) for all C. To this end, it suffices to verify the following properties of τ and DST:

(i) τ(C) - DST(C) does not depend on C;

(ii) [formula].

We start with (i). In turn, it suffices to prove that τ(C1x) - DST(C1x) = τ(C1y) - DST(C1y), where C1 is a monomial of degree n - 2 and e = (x,y)∈E, x < y, is an edge of T. We have

[formula]

Denote [formula], where Vx, Vy are components of [formula] containing x, y respectively; Tx, Ty are trees induced by T on Vx, Vy, and C1 = Cx  ·  Cy, where Cx is a monomial in elements the of Vx and Cy in the elements of Vy. We have

[formula]

In the second case we also have τ(C1x) = τ(C2x), since any edge ẽ is either regular for both monomials C1x, C1y, or inversive for both monomials. In the first case edge e is regular for C1x and inversive for C1y. It means that sC1x and C1y have different signs: [formula]. It follows that τ(C1x) - τ(C1y) equals [formula] times number of permutations π which are either C1x-acceptable or C1y-acceptable. If we fix π(Vx) (and thus automatically π(Vy)), which may be done in exactly [formula] ways, this property of a permutation is a combination of independent properties on Tx and on Ty. Applying the induction hypothesis we get that τ(C1x) - τ(C1y) equals [formula], as desired.

Now we come to (ii). We have [formula], since [formula] is a symmetric polynomial. So, it suffices to prove that [formula]. This, however, is an alternating sum of numbers of pointed permutations: τ(xn - 1) counts permutations π pointed by x satisfying π(u) > π(v) for any edge uv so that there exists a path from x to u avoiding v. We prove that it does vanish by providing a sign-changing involution on this set of pointed permutations (sign is understood in the sense of τ). Let v1 > v2 be two maximal elements of V. The involution acts as follows: take permutation π pointed by x, then π(x) = v1. Let y = π- 1(v2), then x and y are neighbors. Replace π(x) by v2 and π(y) by v1, also point a new permutation by y.

I am grateful to Tewodros Amdeberhan for pending my attention to this topic, for fruitful discussions, and for reading and editing the preliminary version of the manuscript.