Lineare Rekurrenzen, Potenzreihen und ihre erzeugenden Funktionen

Vorwort

In diesem Artikel möchte ich mich mit linearen Rekursionsgleichungen und den erzeugenden Funktionen ihrer Folgen befassen. Wenngleich die zu verwendenden Techniken nicht neu oder schwierig sind, so bleibt die Behandlung des Themas üblicherweise außerhalb der Lehrbücher. Das ist auch deswegen bedauerlich, weil sich ganzzahlige Folgen wie die Fibonaccizahlen u.ä. ausdauernder Beliebtheit erfreuen und das Rad der Berechnung ihrer geschlossenen Form trotzdem ständig neu erfunden wird. Darüber hinaus ist das Rechnen mit erzeugenden Funktionen ein unabdingbarer Bestandteil der Kombinatorik.

Im ersten Teil werden wir sehen, dass die durch lineare Rekurrenzen definierten Zahlenfolgen, wenn sie als Koeffizienten in Potenzreihen eingesetzt werden, zu erzeugenden (generierenden) Funktionen führen, die rational sind. Umgekehrt erzeugt jede rationale Funktion eine Potenzreihe, deren Koeffizienten mindestens einer linearen Rekurrenz genügen.

Im darauf folgenden Teil wird ersichtlich werden, dass diese Zuordnung mehrere Vorteile hat, insbesondere bei der Berechnung der sogenannten geschlossenen Form der erzeugten Zahlenfolge. Wir hoffen, dass die vermittelten Techniken auch anhand der großen Menge von Beispielen deutlich werden. Obwohl es möglich wäre, alle Methoden in Software zu realisieren, ist dies unseres Wissens (2007) noch nirgendwo implementiert, daher sollten die Beispiele auch als Testfälle für solche Software geeignet sein.

R. Stephan, 2007

Ein Beispiel: Lukaszahlen

Dieses Kapitel ist ganz ähnlich gehalten wie ein entsprechendes Kapitel von Wilf in Generatingfunctionology über die Fibonaccizahlen.

Betrachten wir die Folge der Lucaszahlen. Diese sind, wie die Fibonaccizahlen, definiert durch die lineare Rekurrenz

[formula]

haben jedoch die Anfangswerte a0 = 2, a1 = 1, und ergeben daher eine andere Zahlenfolge:

[formula]

Erzeugende Funktion

Wir wollen nun eine geschlossene Form für die Lucaszahlen finden, das heißt eine Formel in Abhängigkeit von n, die nur aus einfachen Funktionen besteht, wie Addition, Subtraktion, Multiplikation, Wurzel etc.

Dazu setzen wir die Zahlen der Lucasfolge als Koeffizienten in eine formale Potenzreihe (mit formal ist gemeint, dass die Frage der Konvergenz dieser Reihe für uns irrelevant ist). Wir nehmen an, dass der Potenzreihe eine wie auch immer geartete erzeugende Funktion von x entspricht, und nennen sie L(x):

[formula]

Um die geschlossene Form zu finden, benötigen wir erst die erzeugende Funktion L(x). Dazu multiplizieren wir die Rekurrenz ([\eqref=rgf-lr]) mit xn und summieren ins Unendliche:

[formula]

Halt! höre ich die Leser rufen, was ist das? Hierbei handelt es sich um eine ungewöhnliche Manipulation, die aber völlig korrekt ist, wenn wir sie in jedem Glied der drei Terme betrachten:

[formula]

Da aber diese Teilfolgen so durch L(x) beschrieben werden können:

[formula]

[formula]

[formula]

bekommt die Rekurrenz [\eqref=rgf-lr] die Form

[formula]

woraus mit den entsprechenden Startwerten folgt

[formula]

Geschlossene Form

Da sich die erzeugende Funktion L(x) in zwei Partialbrüche mit einfacherem Nenner zerlegen läßt, ist davon auszugehen, dass sich auch die Lucaszahlen als Summe zweier Ausdrücke darstellen lassen. Durch Lösen der quadratischen Gleichung erhalten wir die Nullstellen des Polynoms im Nenner von L(x), und damit dessen Partialbruchzerlegung:

[formula]

[formula]

Nach Berechnung von A und B und weiterer Manipulation folgt

[formula]

In diese Form gebracht, läßt sich die Potenzreihen-Identität

[formula]

anwenden und wir erhalten endlich für die Lucaszahlen an

[formula]

und daher die Formel von Binet

[formula]

Potenzreihen-Identitäten

Die einfachste Potenzreihe ist die geometrische Reihe:

[formula]

Sie erzeugt den konstanten Wert 1. Durch Differentiation und anschließende Multiplikation mit x (man spricht auch von der Anwendung des xD-Operators) erhalten wir jene Funktion, die die Folge an = n, also die natürlichen Zahlen, erzeugt.

[formula]

Jede weitere Anwendung des xD-Operators erzeugt die nächste Potenz von n.

[formula]

[formula]

[formula]

[formula]

Hier bezeichnet (xD)m die m-malige Anwendung des xD-Operators.

Geht es darum, Potenzen einer konstanten Zahl c zu erzeugen, genügt es, x in der geometrischen Reihe durch cx zu ersetzen:

[formula]

Ebenso gelten die Regeln des xD-Operators für diese Funktion, und wir erhalten

[formula]

Wir werden sehen, dass alle linearen Rekurrenzen bzw. ihre rationalen erzeugenden Funktionen Zahlenfolgen erzeugen, die sich als Summe von den in [\eqref=rgf-p1] und [\eqref=rgf-p2] erzeugten Ausdrücken darstellen lassen. Die Behandlung weiterer Identitäten von Potenzreihen ist hier daher gar nicht notwendig.

Homogene und inhomogene Rekurrenzen

Bevor wir zu den zentralen theoretischen Erkenntnissen kommen, die diesem Buch zugrunde liegen, ist es noch notwendig, zwei Arten von linearen Rekurrenzen zu betrachten. Wir werden sehen, dass nur sogenannte homogene Rekurrenzen auf einfache Weise handhabbar sind, und dass inhomogene Rekurrenzen in diese überführt werden können. Alle anderen Arten von Rekurrenzen können mit den dargestellten Methoden nicht gelöst werden. Zunächst jedoch:

Eine lineare Rekurrenz (auch Rekursion oder Differenzengleichung) besteht aus einer Gleichung der Form

[formula]

und vorgegebenen Anfangswerten

[formula]

wobei n eine ganzzahlige Unbekannte ist, k als positive ganze Zahl die Ordnung der Rekurrenz bezeichnet, und die ci vorgegebene ganze Zahlen sind. Auch ist die Funktion von n, f(n), von einer Form, die sich wiederum von einer linearen Rekurrenz darstellen läßt. Da wir uns nur mit ganzzahligen Folgen befassen, ist ck gleich Eins.

Eine lineare Rekurrenz ist homogen, wenn f(n) gleich Null ist.

Beispiele.

Quadratische Rekurrenz: an + 2 = an + 1an,  a0 = 2,a1 = 3

Nichtlineare Rekurrenz: an + 2 = nan + 1 - an,  a0 = 1,a1 = 2

Inhomogene lineare Rekurrenz 2.Ordnung:   an + 2 = 5an + 1 - an - n,  a0 = 0,a1 = 1

Inhomogene lineare Rekurrenz 3.Ordnung: an + 3 = an + 2 + an + 1 + an + 1,  a0 = 0,a1 = 1,a2 =  - 1

Homogene lineare Rekurrenz 4.Ordnung: an + 4 = 2an + 3 - an + 2 + 5an + 1 - an,  a0 =  - 5,a1 =  - 1,a2 = 3,a3 =  - 7

Ein Hauptsatz

Für das Verständnis linearer Rekurrenzen ist es zentral, den folgenden Hauptsatz und seine Folgerungen zu kennen.

Jede homogene lineare Rekurrenz erzeugt eine Zahlenfolge, die als Koeffizienten in einer Potenzreihe von einer rationalen Funktion erzeugt wird, wobei der Nenner der erzeugenden Funktion ein Polynom ist, dessen Koeffizienten mit den Koeffizienten der entsprechenden Rekurrenz identisch sind, wenn die Gleichung gleich Null gesetzt wird.

Damit besteht eine bijektive Zuordnung zwischen rationalen Funktionen und homogenen linearen Rekurrenzen. Als Beispiel siehe den ersten Abschnitt über die Lucaszahlen. Setzen wir die Differenzengleichung der Lucaszahlen auf Null, lautet sie:

[formula]

mit den Koeffizienten 1, - 1, - 1 gleich denen des Nennerpolynoms von L(x).

Der allgemeine Beweis ist einfach, man verfahre so wie im Beispiel bei der Herleitung der erzeugenden Funktion. Die nachstehenden Folgesätze ergeben sich unmittelbar:

Der Grad des Nennerpolynoms der erzeugenden Funktion ist gleich der Ordnung der entsprechenden linearen Rekurrenz.

Die wichtigste Schlußfolgerung ergibt sich jedoch durch Anwendung des Fundamentalsatzes der Algebra und der zuvor gefundenen Potenzreihen-Identitäten.

Jede lineare Rekurrenz hat eine geschlossene Form der Art

[formula]

wobei D die Ordnung der Rekurrenz, zj eine (auch komplexe) Nullstelle des Nennerpolynoms der erzeugenden Funktion, Mj die Vielfachheit dieser Nullstelle, und die cj,k rationale Konstanten sind, die es schlußendlich herauszufinden gilt.

Siehe den Buchteil "Ausführliche Beispiele", wo das Finden der geschlossenen Form ein zentrales Thema ist.

Das asymptotische Verhalten einer linearen Rekurrenz ist exponentiell. Die Basis der Potenz ist das betragsmäßig größte Inverse aller Nullstellen des Nennerpolynoms der erzeugenden Funktion.

Auch dies ergibt sich unmittelbar, und damit kann das asymptotische Verhalten einer linearen Rekurrenz direkt aus der Differenzengleichung berechnet werden, wenn sie in der homogenen Form ist.

Als Beispiel die Formel 2n + 3n mit der Rekurrenz

[formula]

der das Nennerpolynom 1 - 5x + 6x2 mit den Nullstellen [formula] und [formula] entspricht. Zu beachten ist, dass Nullstellen auch komplex sein können.

Die Perrin-Folge

Über die vor allem zahlentheoretischen Eigenschaften der Perrin-Folge bietet die Wikipedia einen Artikel. Wir wollen die geschlossene Form dieser Zahlenfolge ausgehend von ihrer Differenzengleichung

[formula]

herleiten. Sei P(x) die entsprechende erzeugende Funktion

[formula]

dann gilt

[formula]

[formula]

[formula]

Seien z1,z2,z3 die Lösungen der Gleichung 1 - x2 - x3, dann ist

[formula]

Zunächst wollen wir eine asymptotische Abschätzung machen, weiter unten in diesem Kapitel werden wir aber eine Möglichkeit zur Bestimmung der A,B,C kennenlernen.

Das asymptotische Verhalten der Perrin-Folge

Die Funktion P(x) ist, wie in Gleichung [\eqref=rgf-pe1] gesehen, die Summe dreier Brüche, deren Nenner x - z durch Division zu [formula] umgeformt werden kann. Der dabei entstehende Faktor [formula] von x entspricht der Konstanten c in einer unserer Potenzreihen-Identitäten, und daher können wir die Perrin-Zahlen als Summe dreier Potenzen, multipliziert mit jeweils einem unbekannten Faktor, darstellen:

[formula]

Die drei Nullstellen z1,z2,z3 des Nennerpolynoms von P(x) können mit Taschenrechner oder PC-Software (z.B. ein Computer-Algebra-System) numerisch erhalten werden:

[formula]

Egal, welche Faktoren D,E,F gelten, mit zunehmendem n wird sich derjenige Term durchsetzen, dessen Basis [formula] den größten Betrag besitzt, und wird das asymptotische Verhalten bestimmen. Der Rechner liefert

[formula]

und daher

[formula]

Partialbruchzerlegung durch Koeffizientenvergleich

Die Berechnung der Faktoren A,B,C in Gleichung [\eqref=rgf-pe1] ist durch folgendes Standardverfahren möglich. Die Gleichung wird mit dem Nennerpolynom von P(x) multipliziert.

[formula]

[formula]

Dies führt bei Berücksichtigung der jeweiligen Faktoren von 1, x und x2 zu einem Gleichungssystem mit drei Unbekannten

[formula]

mit der Lösung A = z1,B = z2,C = z3, woraus wiederum D = E = F = 1 folgt. Durch Einsetzen in die Gleichungen [\eqref=rgf-pe2] und [\eqref=rgf-pe3] erhalten wir

[formula]

Unsere vorige Abschätzung [\eqref=rgf-pe3] ist so gut, dass bei ihr ab der zehnten Perrinzahl nur noch gerundet werden muss:

Eine Fibonacci-Teilfolge

Bei genauerer Betrachtung der Fibonacci-Folge

[formula]

fällt auf, dass die Glieder der Teilfolge

[formula]

alle ungerade zu sein scheinen, was wir zunächst ohne Beweis voraussetzen. Angenommen, uns interessiert die Folge, die sich durch Verringerung um 1 und anschließender Halbierung dieser Werte ergibt, also

[formula]

und wir wollen eine geschlossene Form dafür finden, dann brauchen wir zuerst eine Rekurrenz für an. Dazu ist es notwendig, auch an - 1 und an - 2 durch fn auszudrücken:

[formula]

Durch einfache Manipulationen und Kenntnis der Rekurrenz für fn ist es möglich, f3n + 1 durch f3n - 2 und f3n - 5 auszudrücken:

[formula]

[formula]

Daraus folgt wiederum für an

[formula]

und wir erhalten die Rekurrenz

[formula]

Die Inhomogenität der Rekurrenz spielt keine Rolle bei der Berechnung der erzeugenden Funktion A(x), solange sich zusätzliche Ausdrücke als Potenzreihe darstellen lassen, und wir erhalten

[formula]

[formula]

Lösung der quadratischen Nennerfaktor-Gleichung liefert den Ansatz für die Partialbruchzerlegung

[formula]

Mit der Standard-Lösungsmethode kommen wir über

[formula]

[formula]

auf das Gleichungssystem

[formula]

mit der Lösung

[formula]

woraus sich nach Umwandlung der Nenner die gesuchte Form ergibt

[formula]

mit der Abschätzung

[formula]

Die Partialsummen der Kubikzahlen

Ein häufig auftretendes Problem sind Partialsummen-Folgen und Differenzen-Folgen, die sich aus vorgegebenen Zahlenfolgen ableiten. Als Operation auf Potenzreihen betrachtet, erhält man die erste Differenz durch Multiplikation der Erzeugenden mit (1 - x):

[formula]

Daraus folgt unmittelbar, dass die Funktion A(x) / (1 - x) die erste Partialsumme der Folge an erzeugt:

[formula]

Wir wollen dies am Beispiel der Kubikzahlen [formula] veranschaulichen. Die Partialsummenfolge der Kubikzahlen

[formula]

besitzt die erzeugende Funktion (siehe das Kapitel über Potenzreihen-Identitäten)

[formula]

Die Nullstelle des Nennerpolynoms hat den Wert 1 und ist fünffach, das heißt, in der geschlossenen Form von an können Potenzen von n bis n4 auftreten. Der Ansatz für die Partialbruchzerlegung von A(x) lautet

[formula]

[formula]

mit dem Gleichungssystem

[formula]

Es hat die Lösung [formula] und daher ist

[formula]

Was auch gleich dem Quadrat der Dreieckszahlen ist.

Diese Identität läßt sich selbstverständlich auch auf anderem Weg (und in diesem Fall vielleicht sogar schneller) beweisen. Es ging in diesem Kapitel jedoch um die Demonstration der allgemeinen Methode zur Behandlung von Partialsummen, und um mehrfache Nullstellen bei der Partialbruchzerlegung.

Eine vorgegebene Folge

Es sei das Problem vorgegeben, die geschlossene Form der Folge zu finden, die die erzeugende Funktion

[formula]

besitzt (diese Zahlenfolge entsteht bei einer gewissen Zerteilung von Polygonen). Wir können diesmal nicht von der Rekurrenz ausgehen, sehen aber sofort anhand der Erzeugenden, dass sie von 6. Ordnung ist, außerdem kommt in der geschlossenen Form n bis zur dritten Potenz, sowie Potenzen von ( - 1) multipliziert mit n bis zur ersten Potenz, vor. Der Ansatz setzt sich daher aus den vier Termen 1, n, n2 und den zwei Termen ( - 1)n und n( - 1)n als Einzelfunktionen der Partialbruchzerlegung zusammen:

[formula]

(Benutzen Sie Gleichung [\eqref=rgf-p2] mit c =  - 1, um die letzten beiden Terme zu erhalten!)

Der Ansatz führt zu dem Gleichungssystem

[formula]

mit der Lösung

[formula]

und damit der Formel

[formula]

Ein gemeinsamer Teiler

Die Zahlenfolge mit der Formel [formula] ist 4-periodisch:

[formula]

Wenngleich die Folge damit eine eindeutige und leicht berechenbare Form hat, würde uns eine geschlossene Form interessieren, die nur aus Potenzen besteht. Dazu versuchen wir zunächst, eine Rekurrenz zu finden.

Die Periodizität liefert sofort:

[formula]

und daher

[formula]

Der Ansatz

[formula]

führt auf das Gleichungssystem

[formula]

mit der Lösung [formula]. Wir erhalten die Formel

[formula]

Eine Differenzengleichung für cosh

Die in den bisherigen Beispielen angewandten Prinzipien führten zu Methoden, die zum Ziel hatten, eine bestimmte Art der geschlossenen Form zu erhalten, nämlich eine Summe von Potenzen. Umgekehrt ist es kein Problem, von einer solchen Form auszugehen, und zu einer formalen Potenzreihe zu gelangen, von der sich dann eine Rekurrenz ablesen läßt.

Beispielsweise lautet die Definition für den Kosinus Hyperbolicus

[formula]

Daraus folgt für die formal erzeugende Funktion, wir nennen sie C(x),

[formula]

Der Nenner wiederum zeigt den Weg zur Differenzengleichung

[formula]

Alternierende Folgen

Mit den Methoden des letzten Beispiels können auch komplexere Aufgabenstellungen bewältigt werden. Sei die Definition gegeben

[formula]

Solche periodisch wechselnden Folgen werden mit dem Ansatz

[formula]

bearbeitet. Das Prinzip: ist n gerade, bleibt das zwischen den Brüchen stehende Vorzeichen ein Plus, und die f2-Terme heben sich gegenseitig auf. Ist n ungerade, wird das Vorzeichen ein Minus und die f1-Terme verschwinden.

Ein Beispiel, von der Definition über die Erzeugende zur Rekurrenz:

[formula]

Das Resultat

[formula]

besteht nur aus Folgengliedern, die einer einzigen der in der Definition angegebenen Teilfolgen angehören, gilt aber für die ganze Folge. Das bedeutet, dass durch Halbierung der Indices eine Rekurrenz entsteht, die für jede der beiden Einzelfolgen 22n und 2n gilt, und wir eine Methode entdeckt haben, mit der sich eine solche berechnen läßt.

Weiterführende Literatur

Über den kombinatorischen Aspekt generierender Funktionen siehe man Wilf, Generatingfunctionology und über ihre asymptotische Entwicklung und vieles mehr sei Graham, Knuth, Ptashnik, Concrete Mathematics empfohlen.