Proposition Lemma Corollary Conjecture

Strong Spherical Asymptotics for Rotor-Router Aggregation and the Divisible Sandpile

Introduction

Rotor-router walk is a deterministic analogue of random walk, first studied by Priezzhev et al. [\cite=PDDK] under the name "Eulerian walkers." At each site in the integer lattice [formula] is a rotor pointing north, south, east or west. A particle starts at the origin; during each time step, the rotor at the particle's current location is rotated clockwise by 90 degrees, and the particle takes a step in the direction of the newly rotated rotor. In rotor-router aggregation, introduced by Jim Propp, we start with n particles at the origin; each particle in turn performs rotor-router walk until it reaches a site not occupied by any other particles. Let An denote the resulting region of n occupied sites. For example, if all rotors initially point north, the sequence will begin A1  =  {(0,0)}, A2  =  {(0,0),(1,0)}, A3  =  {(0,0),(1,0),(0, - 1)}. The region A1,000,000 is pictured in Figure 1. In higher dimensions, the model can be defined analogously by repeatedly cycling the rotors through an ordering of the 2d cardinal directions in [formula].

Jim Propp observed from simulations in two dimensions that the regions An are extraordinarily close to circular, and asked why this was so [\cite=Kleber] [\cite=Propp]. Despite the impressive empirical evidence for circularity, the best result known until now [\cite=LP] says only that if An is rescaled to have unit volume, the volume of the symmetric difference of An with a ball of unit volume tends to zero as a power of n, as [formula]. The main outline of the argument is summarized in [\cite=intelligencer]. Fey and Redig [\cite=FR] also show that An contains a diamond. In particular, these results do not rule out the possibility of "holes" in An far from the boundary or of long tendrils extending far beyond the boundary of the ball, provided the volume of these features is negligible compared to n.

Our main result is the following, which rules out the possibility of holes far from the boundary or of long tendrils in the rotor-router shape. For r  ≥  0 let

[formula]

Let An be the region formed by rotor-router aggregation in [formula] starting from n particles at the origin and any initial rotor state. There exist constants c,c' depending only on d, such that

[formula]

where r = (n / ωd)1 / d, and ωd is the volume of the unit ball in [formula].

We remark that the same result holds when the rotors evolve according to stacks of bounded discrepancy; see the remark following Lemma [\ref=odomflow].

Internal diffusion limited aggregation ("internal DLA") is an analogous growth model defined using random walks instead of rotor-router walks. Starting with n particles at the origin, each particle in turn performs simple random walk until it reaches an unoccupied site. Lawler, Bramson and Griffeath [\cite=LBG] showed that for internal DLA in [formula], the occupied region An, rescaled by a factor of n1 / d, converges with probability one to a Euclidean ball in [formula] as n  →    ∞  . Lawler [\cite=Lawler95] estimated the rate of convergence. By way of comparison with Theorem [\ref=rotorcirc], if In is the internal DLA region formed from n particles started at the origin, the best known bounds [\cite=Lawler95] are (up to logarithmic factors)

[formula]

for all sufficiently large n, with probability one.

We also study another model which is slightly more difficult to define, but much easier to analyze. In the divisible sandpile, each site [formula] starts with a quantity of "mass" [formula]. A site topples by keeping up to mass 1 for itself, and distributing the excess (if any) equally among its neighbors. Thus if x has mass m > 1, then each of the 2d neighboring sites gains mass (m - 1) / 2d when we topple x, and x is left with mass 1; if m  ≤  1, then no mass moves when we topple x.

Note that individual topplings do not commute; however, the divisible sandpile is "abelian" in the following sense.

Let [formula] be a sequence with the property that for any [formula] there are infinitely many terms xk = x. Let

[formula]

Then [formula] and νk  →  ν  ≤  1. Moreover, the limits u and ν are independent of the sequence {xk}.

The abelian property can be generalized as follows: after performing some topplings, we can add some additional mass and then continue toppling. The resulting limits u and ν will be the same as in the case when all mass was initially present. For a further generalization, see [\cite=scalinglimit].

The limiting function u in Proposition [\ref=divsandpileabelianproperty] is the odometer function for the divisible sandpile. This function plays a central role in our analysis. The limit ν represents the final mass distribution. Sites [formula] with ν(x) = 1 are called fully occupied. Proposition [\ref=divsandpileabelianproperty] is proved in section 3, along with the following.

For m  ≥  0 let [formula] be the domain of fully occupied sites for the divisible sandpile formed from a pile of mass m at the origin. There exist constants c,c' depending only on d, such that

[formula]

where r  =  (m / ωd)1 / d and ωd is the volume of the unit ball in [formula].

The divisible sandpile is similar to the "oil game" studied by Van den Heuvel [\cite=VdH]. In the terminology of [\cite=FR], it also corresponds to the h  →    -    ∞   limit of the classical abelian sandpile (defined below), that is, the abelian sandpile started from the initial condition in which every site has a very deep "hole."

In the classical abelian sandpile model [\cite=BTW], each site in [formula] has an integer number of grains of sand; if a site has at least 2d grains, it topples, sending one grain to each neighbor. If n grains of sand are started at the origin in [formula], write Sn for the set of sites that are visited during the toppling process; in particular, although a site may be empty in the final state, we include it in Sn if it was occupied at any time during the evolution to the final state.

Until now the best known constraints on the shape of Sn in two dimensions were due to Le Borgne and Rossin [\cite=LBR], who proved that

[formula]

Fey and Redig [\cite=FR] proved analogous bounds in higher dimensions, and extended these bounds to arbitrary values of the height parameter h. This parameter is discussed in section 4.

The methods used to prove the near-perfect circularity of the divisible sandpile shape in Theorem [\ref=divsandcircintro] can be used to give constraints on the shape of the classical abelian sandpile, improving on the bounds of [\cite=FR] and [\cite=LBR].

Let Sn be the set of sites that are visited by the classical abelian sandpile model in [formula], starting from n particles at the origin. Write n  =  ωdrd. Then for any ε > 0 we have

[formula]

where

[formula]

The constant c2 depends only on d, while c'2 depends only on d and ε.

Note that Theorem [\ref=sandpilecircintro] does not settle the question of the asymptotic shape of Sn, and indeed it is not clear from simulations whether the asymptotic shape in two dimensions is a disc or perhaps a polygon (Figure [\ref=sandpile1m]). To our knowledge even the existence of an asymptotic shape is not known.

The rest of the paper is organized as follows. In section 2, we derive the basic Green's function estimates that are used in the proofs of Theorems [\ref=rotorcirc], [\ref=divsandcircintro] and [\ref=sandpilecircintro]. In section 3 we prove Proposition [\ref=divsandpileabelianproperty] and Theorem [\ref=divsandcircintro] for the divisible sandpile. In section 4 we adapt the methods of the previous section to prove Theorem [\ref=sandpilecircintro] for the classical abelian sandpile model. Section 5 is devoted to the proof of Theorem [\ref=rotorcirc].

Basic Estimate

Write (Xk)k  ≥  0 for simple random walk in [formula], and for d  ≥  3 denote by

[formula]

the expected number of visits to x by simple random walk started at the origin. This is the discrete harmonic Green's function in [formula]; it satisfies Δg(x)  =  0 for x  ≠  o, and Δg(o) =  - 1, where Δ is the discrete Laplacian

[formula]

The sum is over the 2d lattice neighbors y of x. In dimension d = 2, simple random walk is recurrent, so the expectation defining g(x) is infinite. Here we define the potential kernel

[formula]

where

[formula]

The limit defining g(x) in ([\ref=potentialkerneldef]) is finite [\cite=Lawler] [\cite=Spitzer], and g(x) has Laplacian Δg(x) = 0 for x  ≠  o, and Δg(o) =  - 1. Note that ([\ref=potentialkerneldef]) is the negative of the usual definition of the potential kernel; we have chosen this sign convention so that g has the same Laplacian in dimension two as in higher dimensions.

Fix a real number m > 0 and consider the function on [formula]

[formula]

Let r be such that m  =  ωdrd, and let

[formula]

where e1 is the first standard basis vector in [formula]. The function γd plays a central role in our analysis. To see where it comes from, recall the divisible sandpile odometer function of Proposition [\ref=divsandpileabelianproperty]

[formula]

Let [formula] be the domain of fully occupied sites for the divisible sandpile formed from a pile of mass m at the origin. For x∈Dm, since each neighbor y of x emits an equal amount of mass to each of its 2d neighbors, we have

[formula]

Moreover, u = 0 on ∂Dm. By construction, the function γd obeys the same Laplacian condition: Δγd  =  1  -  mδo; and as we will see shortly, γd  ≈  0 on ∂Br. Since we expect the domain Dm to be close to the ball Br, we should expect that u  ≈  γd. In fact, we will first show that u is close to γd, and then use this to conclude that Dm is close to Br.

We will use the following estimates for the Green's function [\cite=FU] [\cite=Uchiyama]; see also [\cite=Lawler].

[formula]

Here [formula], where ωd is the volume of the unit ball in [formula], and κ is a constant whose value we will not need to know. For [formula] we use |x| to denote the Euclidean norm of x. Here and throughout the paper, constants in error terms denoted O(  ·  ) depend only on d.

We will need an estimate for γd near the boundary of the ball Br. We first consider dimension d = 2. From ([\ref=standardgreensestimate]) we have

[formula]

where

[formula]

In the Taylor expansion of φ about |x| = r

[formula]

the linear term vanishes, leaving

[formula]

for some t between |x| and r.

In dimensions d  ≥  3, from ([\ref=standardgreensestimate]) we have

[formula]

Setting φ(x)  =  |x|2  +  adm|x|2 - d, the linear term in the Taylor expansion ([\ref=secondordertaylor]) of φ about |x| = r again vanishes, yielding

[formula]

for t between |x| and r. Together with ([\ref=taylordim2]), this yields the following estimates in all dimensions d  ≥  2.

Let γd be given by ([\ref=subtractoffconstant]). For all [formula] we have

[formula]

Let γd be given by ([\ref=subtractoffconstant]). Then uniformly in r,

[formula]

The following lemma is useful for x near the origin, where the error term in ([\ref=quadraticgrowth]) blows up.

Let γd be given by ([\ref=subtractoffconstant]). Then for sufficiently large r, we have

[formula]

Since γd(x) - |x|2 is superharmonic, it attains its minimum in Br / 3 at a point z on the boundary. Thus for any x∈Br / 3

[formula]

hence by Lemma [\ref=gammalowerbound]

[formula]

Lemmas [\ref=gammalowerbound] and [\ref=gammanearorigin] together imply the following.

Let γd be given by ([\ref=subtractoffconstant]). There is a constant a depending only on d, such that γd  ≥   - a everywhere.

Divisible Sandpile

Let μ0 be a nonnegative function on [formula] with finite support. We start with mass μ0(y) at each site y. The operation of toppling a vertex x yields the mass distribution

[formula]

where [formula] and Δ is the discrete Laplacian on [formula]. Thus if μ0(x)  ≤  1 then Txμ0  =  μ0 and no mass topples; if μ0(x) > 1 then the mass in excess of 1 is distributed equally among the neighbors of x.

Let [formula] be a sequence with the property that for any [formula] there are infinitely many terms xk = x. Let

[formula]

be the amount of mass present at y after toppling the sites [formula] in succession. The total mass emitted from y during this process is

[formula]

where [formula].

As [formula] the functions uk and μk tend to limits [formula] and μk  →  μ. Moreover, these limits satisfy

[formula]

Write [formula] for the total starting mass, and let [formula] be a ball centered at the origin containing all points within L1-distance M of the support of μ0. Note that if μk(x) > 0 and μ0(x) = 0, then x must have received its mass from a neighbor, so μk(y)  ≥  1 for some y  ~  x. Since [formula], it follows that μk is supported on B. Let R be the radius of B, and consider the quadratic weight

[formula]

Since μk(xk) - μk - 1(xk)  =    -  αk(xk) and for y  ~  xk we have [formula], we obtain

[formula]

Summing over k we obtain from ([\ref=finitetimeodom])

[formula]

Fixing x, the sequence uk(x) is thus increasing and bounded above, hence convergent.

Given neighboring vertices x  ~  y, since y emits an equal amount of mass to each of its 2d neighbors, it emits mass uk(y) / 2d to x up to time k. Thus x receives a total mass of [formula] from its neighbors up to time k. Comparing the amount of mass present at x before and after toppling, we obtain

[formula]

Since [formula] we infer that μk  →  μ: = μ0  +  Δu. Note that if xk = x, then μk(x)  ≤  1. Since for each [formula] this holds for infinitely many values of k, the limit satisfies μ  ≤  1.

A function s on [formula] is superharmonic if Δs  ≤  0. Given a function γ on [formula] the least superharmonic majorant of γ is the function

[formula]

The study of the least superharmonic majorant is a classical topic in analysis and PDE; see, for example, [\cite=Koosis]. Note that if f is superharmonic and f  ≥  γ then

[formula]

Taking the infimum on the left side we obtain that s is superharmonic.

The limit u in Lemma [\ref=existenceoflimits] is given by u  =  s  +  γ, where

[formula]

and s is the least superharmonic majorant of -  γ.

By Lemma [\ref=existenceoflimits] we have

[formula]

Since Δγ  =  1 - μ0, the difference u - γ is superharmonic. As u is nonnegative, it follows that u - γ  ≥  s. For the reverse inequality, note that s + γ - u is superharmonic on the domain D  =  {x ~ | ~ μ(x) = 1} of fully occupied sites and is nonnegative outside D, hence nonnegative inside D as well.

As a corollary of Lemmas [\ref=existenceoflimits] and [\ref=discretemajorant], we obtain the abelian property of the divisible sandpile, Proposition [\ref=divsandpileabelianproperty], which was stated in the introduction.

We now turn to the case of a point source mass m started at the origin: μ0 = mδo. More general starting distributions are treated in [\cite=scalinglimit], where we identify the scaling limit of the divisible sandpile model and show that it coincides with that of internal DLA and of the rotor-router model. In the case of a point source of mass m, the natural question is to identify the shape of the resulting domain Dm of fully occupied sites, i.e. sites x for which μ(x) = 1. According to Theorem [\ref=divsandcirc], Dm is extremely close to a ball of volume m; in fact, the error in the radius is a constant independent of m. As before, for r  ≥  0 we write

[formula]

for the lattice ball of radius r centered at the origin.

For m  ≥  0 let [formula] be the domain of fully occupied sites for the divisible sandpile formed from a pile of size m at the origin. There exist constants c,c' depending only on d, such that

[formula]

where r  =  (m / ωd)1 / d and ωd is the volume of the unit ball in [formula].

The idea of the proof is to use Lemma [\ref=discretemajorant] along with the basic estimates on γ, Lemmas [\ref=gammalowerbound] and [\ref=gammaupperbound], to obtain estimates on the odometer function

[formula]

We will need the following simple observation.

For every point x∈Dm  -  {o} there is a path [formula] in Dm with u(xi + 1)  ≥  u(xi) + 1.

If xi∈Dm  -  {o}, let xi + 1 be a neighbor of xi maximizing u(xi + 1). Then xi + 1∈Dm and

[formula]

where in the last step we have used the fact that xi∈Dm.

We first treat the inner estimate. Let γd be given by ([\ref=subtractoffconstant]). By Lemma [\ref=discretemajorant] the function u - γd is superharmonic, so its minimum in the ball Br is attained on the boundary. Since u  ≥  0, we have by Lemma [\ref=gammaupperbound]

[formula]

for a constant C depending only on d. Hence by Lemma [\ref=gammalowerbound],

[formula]

for a constant C' depending only on d. It follows that there is a constant c, depending only on d, such that u(x) > 0 whenever r / 3  ≤  |x| < r - c. Thus Br - c - Br / 3  ⊂  Dm. For x∈Br / 3, by Lemma [\ref=gammanearorigin] we have u(x)  ≥  r2 / 4 - C > 0, hence Br / 3  ⊂  Dm.

For the outer estimate, note that u - γd is harmonic on Dm. By Lemma [\ref=gammanonnegativeeverywhere] we have γd  ≥   - a everywhere, where a depends only on d. Since u vanishes on ∂Dm it follows that u - γd  ≤  a on Dm. Now for any x∈Dm with r - 1 < |x|  ≤  r, we have by Lemma [\ref=gammaupperbound]

[formula]

for a constant c' depending only on d. Lemma [\ref=boundarypath] now implies that Dm  ⊂  Br + c' + 1.

Classical Sandpile

We consider a generalization of the classical abelian sandpile, proposed by Fey and Redig [\cite=FR]. Each site in [formula] begins with a "hole" of depth H. Thus, each site absorbs the first H grains it receives, and thereafter functions normally, toppling once for each additional 2d grains it receives. If H is negative, we can interpret this as saying that every site starts with h =  - H grains of sand already present. Aggregation is only well-defined in the regime h  ≤  2d - 2, since for h = 2d - 1 the addition of a single grain already causes every site in [formula] to topple infinitely often.

Let Sn,H be the set of sites that are visited if n particles start at the origin in [formula]. Fey and Redig [\cite=FR] prove that

[formula]

where n  =  ωdrd, and [formula] denotes symmetric difference. The following theorem strengthens this result.

Fix an integer H  ≥  2 - 2d. Let Sn  =  Sn,H be the set of sites that are visited by the classical abelian sandpile model in [formula], starting from n particles at the origin, if every lattice site begins with a hole of depth H. Write n  =  ωdrd. Then

[formula]

where

[formula]

and c2 is a constant depending only on d. Moreover if H  ≥  1 - d, then for any ε > 0 we have

[formula]

where

[formula]

and c'2 is independent of n but may depend on d, H and ε.

Note that the ratio [formula] as [formula]. Thus, the classical abelian sandpile run from an initial state in which each lattice site starts with a deep hole yields a shape very close to a ball. Intuitively, one can think of the classical sandpile with deep holes as approximating the divisible sandpile, whose limiting shape is a ball by Theorem [\ref=divsandcirc]. Following this intuition, we can adapt the proof of Theorem [\ref=divsandcirc] to prove Theorem [\ref=sandpilecirc]; just one additional averaging trick is needed, which we explain below.

Consider the odometer function for the abelian sandpile

[formula]

Let Tn  =  {x|u(x) > 0} be the set of sites which topple at least once. Then

[formula]

In the final state, each site which has toppled retains between 0 and 2d - 1 grains, in addition to the H that it absorbed. Hence

[formula]

We can improve the lower bound by averaging over a small box. For [formula] let

[formula]

be the box of side length 2k + 1 centered at x, and let

[formula]

Write

[formula]

Le Borgne and Rossin [\cite=LBR] observe that if T is a set of sites all of which topple, the number of grains remaining in T is at least the number of edges internal to T: indeed, for each internal edge, the endpoint that topples last sends the other a grain which never moves again. Since the box Qk(x) has 2dk(2k + 1)d - 1 internal edges, we have

[formula]

The following lemma is analogous to Lemma [\ref=boundarypath].

For every point x∈Tn adjacent to ∂Tn there is a path [formula] in Tn with u(xi + 1)  ≥  u(xi) + 1.

By ([\ref=dumblaplbounds]) we have

[formula]

Since u(xi - 1) < u(xi), some term u(y) in the sum above must exceed u(xi). Let xi + 1 = y.

Let

[formula]

and let

[formula]

Taking m  =  n / (2d - 1 + H) in Lemma [\ref=gammaupperbound], we have

[formula]

for a constant C depending only on d. By ([\ref=dumblaplbounds]), u - ξd is superharmonic, so u - ξd  ≥   - C(2d - 1 + H) in all of Bc1r. Hence by Lemma [\ref=gammalowerbound] we have for x∈Bc1r

[formula]

where C' depends only on d. It follows that u is positive on Bc1r  -  c2 - Bc1r / 3 for a suitable constant c2 depending only on d. For x∈Bc1r / 3, by Lemma [\ref=gammanearorigin] we have u(x)  >  (2d - 1 + H)(c21r2  /  4 - C)  >  0. Thus Bc1r  -  c2  ⊂  Tn  ⊂  Sn.

For the outer estimate, let

[formula]

Choose k large enough so that [formula], and define

[formula]

Finally, let

[formula]

By ([\ref=averagedinabox]), u(k)  -  ψd is subharmonic on T(k)n. Taking m = n / (d - ε + H) in Lemma [\ref=gammanonnegativeeverywhere], there is a constant a depending only on d, such that ψd  ≥   - a(d + H) everywhere. Since u(k)  ≤  (2d + H)(d + 1)k on ∂T(k)n it follows that u(k)  -  ψd  ≤  a(d + H) + (2d + H)(d + 1)k on T(k)n. Now for any x∈Sn with c'1r - 1  <  |x|  ≤  c'1r we have by Lemma [\ref=gammaupperbound]

[formula]

for a constant 2 depending only on d, H and ε. Then u(x)  ≤  c'2: = (2k + 1)d2. Lemma [\ref=boundarypathology] now implies that Tn  ⊂  Bc'1r  +  c'2, and hence

[formula]

We remark that the crude bound of (2d + H)(d + 1)k used in the proof of the outer estimate can be improved to a bound of order k2H, and the final factor of (2k + 1)d can be replaced by a constant factor independent of k and H, using the fact that a nonnegative function on [formula] with bounded Laplacian cannot grow faster than quadratically; see [\cite=scalinglimit].

Rotor-Router Model

Given a function f on [formula], for a directed edge (x,y) write

[formula]

Given a function s on directed edges in [formula], write

[formula]

The discrete Laplacian of f is then given by

[formula]

Inner Estimate

Fixing n  ≥  1, consider the odometer function for rotor-router aggregation

[formula]

We learned the idea of using the odometer function to study the rotor-router shape from Matt Cook [\cite=Cook].

For a directed edge (x,y) in [formula], denote by κ(x,y) the net number of crossings from x to y performed by the first n particles in rotor-router aggregation. Then

[formula]

for some edge function R which satisfies

[formula]

for all edges (x,y).

In the more general setting of rotor stacks of bounded discrepancy, the 4d - 2 will be replaced by a different constant here.

Writing N(x,y) for the number of particles routed from x to y, we have

[formula]

hence

[formula]

In what follows, [formula] denote constants depending only on d.

Let [formula] with 2  ≤    #  Ω  <    ∞  . Then

[formula]

For each positive integer k, let

[formula]

Then

[formula]

for a constant C'0 depending only on d. Since Ω can intersect at most   (Ω) + 1  ≤  2  (Ω) distinct sets Sk, taking C0  =  2C'0 the proof is complete.

Let G  =  GBr be the Green's function for simple random walk in [formula] stopped on exiting Br. For any ρ  ≥  1 and x∈Br,

[formula]

Let (Xt)t  ≥  0 denote simple random walk in [formula], and let T be the first exit time from Br. For fixed y, the function

[formula]

has Laplacian ΔA(x)  =    -  δxy in Br and vanishes on ∂Br, hence A(x) = G(x,y).

Let x,y∈Br and z  ~  y. From ([\ref=standardgreensestimate]) we have

[formula]

Using the triangle inequality together with ([\ref=stoppedgreen]), we obtain

[formula]

where [formula].

Write D  =  {y∈Br  :  |x - y|  ≤  }. Then

[formula]

Taking Ω  =  w - D in Lemma [\ref=diameterbound], the inner sum on the right is at most C0Diam(D)  ≤  2C0ρ, so the right side of ([\ref=twointegrals]) is bounded above by C1ρ for a suitable C1.

Finally, the terms in which y or z coincides with x make a negligible contribution to the sum in ([\ref=theparty]), since for [formula]

[formula]

Let H1,H2 be linear half-spaces in [formula], not necessarily parallel to the coordinate axes. Let Ti be the first hitting time of Hi. If [formula], then

[formula]

where hi is the distance from x to Hi.

If one of H1,H2 contains the other, the result is vacuous. Otherwise, let [formula] be the half-space shifted parallel to Hci by distance 2h2 in the direction of x, and let [formula] be the first hitting time of [formula]. Let (Xt)t  ≥  0 denote simple random walk in [formula], and write Mt for the (signed) distance from Xt to the hyperplane defining the boundary of H1, with M0 = h1. Then Mt is a martingale with bounded increments. Since [formula], we obtain from optional stopping

[formula]

hence

[formula]

Likewise, dM2t  -  t is a martingale with bounded increments, giving

[formula]

Let [formula]. Denoting by Dt the distance from Xt to the hyperplane defining the boundary of H2, the quantity

[formula]

is a martingale. Writing [formula] we have

[formula]

hence by ([\ref=timeupperbound])

[formula]

Finally by ([\ref=justgamblersruin])

[formula]

Let x∈Br and let ρ  =  r + 1 - |x|. Let

[formula]

Let τk be the first hitting time of S*k, and T the first exit time from Br. Then

[formula]

Let H be the outer half-space tangent to Br at the point z∈∂Br closest to x. Let Q be the cube of side length [formula] centered at x. Then Q is disjoint from S*k, hence

[formula]

where T∂Q and TH are the first hitting times of ∂Q and H. Let [formula] be the outer half-spaces defining the faces of Q, so that [formula]. By Lemma [\ref=hitthehyperplane] we have

[formula]

Since dist(x,H)  =  |x - z|  ≤  ρ and dist[formula], and ρ  ≥  1, taking [formula] completes the proof.

Let G = GBr be the Green's function for random walk stopped on exiting Br. Let x∈Br and let ρ  =  r + 1 - |x|. Then

[formula]

Let S*k be given by ([\ref=shells]), and let

[formula]

be the portion of the boundary of the enlarged spherical shell [formula] lying closer to x. Let τW be the first hitting time of W, and T the first exit time from Br. For w∈W let

[formula]

For any y∈S*k and z  ~  y, simple random walk started at x must hit W before hitting either y or z, hence

[formula]

For any y∈S*k and any w∈W we have

[formula]

Lemma [\ref=letsgetthispartystarted] yields

[formula]

By Lemma [\ref=geoshells] we have [formula], so the above sum is at most 3C1C2ρ. Since the union of shells [formula] covers all of Br except for those points y within distance ρ of x, and [formula] by Lemma [\ref=letsgetthispartystarted], the result follows.

Let κ and R be defined as in Lemma [\ref=odomflow]. Since the net number of particles to enter a site x  ≠  o is at most one, we have [formula]. Likewise [formula]. Taking the divergence in ([\ref=gradodom]), we obtain

[formula]

Let T be the first exit time from Br, and define

[formula]

Then Δf(x)  =  1 for x∈Br  -  {o} and Δf(o) = 1 - n. Moreover f  ≥  0 on ∂Br. It follows from Lemma [\ref=gammaupperbound] with m = n that f  ≥  γ  -  C4 on Br for a suitable constant C4.

We have

[formula]

Each summand on the right side is zero on the event {T  ≤  k}, hence

[formula]

Taking expectations and using ([\ref=laplodom]) and ([\ref=laplodomat0]), we obtain

[formula]

hence

[formula]

Since random walk exits Br with probability at least [formula] every time it reaches a site adjacent to the boundary ∂Br, the expected time spent adjacent to the boundary before time T is at most 2d. Since |R|  ≤  4d, the terms in ([\ref=sumofRs]) with z∈∂Br contribute at most 16d3 to the sum. Thus

[formula]

For y∈Br we have [formula], hence

[formula]

Write [formula]. Note that since [formula] and κ are antisymmetric, R is antisymmetric. Thus

[formula]

Summing over k and using the fact that |R|  ≤  4d, we conclude from ([\ref=triplesum]) that

[formula]

where G = GBr is the Green's function for simple random walk stopped on exiting Br. By Lemma [\ref=greengradbound] we obtain

[formula]

Using the fact that f  ≥  γ  -  C4, we obtain from Lemma [\ref=gammalowerbound]

[formula]

The right side is positive provided r / 3  ≤  |x|  <  r - C5 log r. For x∈Br / 3, by Lemma [\ref=gammanearorigin] we have [formula], hence Br - C5 log r  ⊂  An.

Outer Estimate

The following result is due to Holroyd and Propp (unpublished); we include a proof for the sake of completeness. Notice that the bound in ([\ref=HPbound]) does not depend on the number of particles.

Let Γ be a finite connected graph, and let Y  ⊂  Z be subsets of the vertex set of Γ. Let s be a nonnegative integer-valued function on the vertices of Γ. Let Hw(s,Y) be the expected number of particles stopping in Y if s(x) particles start at each vertex x and perform independent simple random walks stopped on first hitting Z. Let Hr(s,Y) be the number of particles stopping in Y if s(x) particles start at each vertex x and perform rotor-router walks stopped on first hitting Z. Let H(x)  =  Hw(1x,Y). Then

[formula]

independent of s and the initial positions of the rotors.

For each vertex u∉Z, arbitrarily choose a neighbor η(u). Order the neighbors [formula] of u so that the rotor at u points to vi + 1 immediately after pointing to vi (indices mod d). We assign weight w(u,η(u)) = 0 to a rotor pointing from u to η(u), and weight w(u,vi)  =  H(u)  -  H(vi)  +  w(u,vi - 1) to a rotor pointing from u to vi. These assignments are consistent since H is a harmonic function: [formula]. We also assign weight H(u) to a particle located at u. The sum of rotor and particle weights in any configuration is invariant under the operation of routing a particle and rotating the corresponding rotor. Initially, the sum of all particle weights is Hw(s,Y). After all particles have stopped, the sum of the particle weights is Hr(s,Y). Their difference is thus at most the change in rotor weights, which is bounded above by the sum in ([\ref=HPbound]).

For [formula] let

[formula]

Then

[formula]

Note that for simple random walk started in Bρ, the first exit time of Bρ and first hitting time of Sρ coincide. Our next result is a modification of Lemma 5(b) of [\cite=LBG].

Fix ρ  ≥  1 and y∈Sρ. For x∈Bρ let [formula], where T is the first hitting time of Sρ. Then

[formula]

for a constant J depending only on d.

We induct on the distance |x - y|, assuming the result holds for all x' with [formula]; the base case can be made trivial by choosing J sufficiently large. By Lemma 5(b) of [\cite=LBG], we can choose J large enough so that the result holds provided |y| - |x|  ≥  2- d - 3|x - y|. Otherwise, let H1 be the outer half-space tangent to Sρ at the point of Sρ closest to x, and let H2 be the inner half-space tangent to the ball [formula] of radius [formula] about y, at the point of [formula] closest to x. By Lemma [\ref=hitthehyperplane] applied to these half-spaces, the probability that random walk started at x reaches [formula] before hitting Sρ is at most 21 - d. Writing [formula] for the first hitting time of [formula], we have

[formula]

where we have used the inductive hypothesis to bound H(x').

The lazy random walk in [formula] stays in place with probability [formula], and moves to each of the 2d neighbors with probability [formula]. We will need the following standard result, which can be derived e.g. from the estimates in [\cite=Lindvall], section II.12; we include a proof for the sake of completeness.

Given [formula], lazy random walks started at u and v can be coupled with probability 1 - C / R before either reaches distance R from u, where C depends only on d.

Let i be the coordinate such that ui  ≠  vi. To define a step of the coupling, choose one of the d coordinates uniformly at random. If the chosen coordinate is different from i, let the two walks take the same lazy step so that they still agree in this coordinate. If the chosen coordinate is i, let one walk take a step while the other stays in place. With probability [formula] the walks will then be coupled. Otherwise, they are located at points u',v' with |u' - v'| = 2. Moreover, [formula] for a constant C' depending only on d. From now on, whenever coordinate i is chosen, let the two walks take lazy steps in opposite directions.

Let

[formula]

be the hyperplane bisecting the segment

[formula]

With H defined as in Lemma  [\ref=inthezone], we have

[formula]

for a constant J' depending only on d.

Given u∈Bρ and v  ~  u, by Lemma [\ref=lazycoupling], lazy random walks started at u and v can be coupled with probability 1 - 2C / |u - y| before either reaches distance |u - y| / 2 from u. If the walks reach this distance without coupling, by Lemma [\ref=inthezone] each has still has probability at most J / |u - y|d - 1 of exiting Bρ at y. By the strong Markov property it follows that

[formula]

Summing in spherical shells about y, we obtain

[formula]

We remark that Lemma [\ref=harmonicmeasuregrad] could also be inferred from Lemma [\ref=inthezone] using [\cite=Lawler] in a ball of radius |u - y| / 2 about u.

To prove the outer estimate of Theorem [\ref=rotorcirc], we will make use of the abelian property of rotor-router aggregation. Fix a finite set [formula] containing the origin. Starting with n particles at the origin, at each time step, choose a site x∈Γ with more than one particle, rotate the rotor at x, and move one particle from x to the neighbor the rotor points to. After a finite number of such choices, each site in Γ will have at most one particle, and all particles that exited Γ will be on the boundary ∂Γ. The abelian property says that the final configuration of particles and the final configuration of rotors do not depend on the choices. For a proof, see [\cite=DF].

In our application, we will fix ρ  ≥  r and stop each particle in rotor-router aggregation either when it reaches an unoccupied site or when it reaches the spherical shell Sρ. Let Nρ be the number of particles that reach Sρ during this process. Note that at some sites in Sρ, more than one particle may have stopped. If we let each of these extra particles in turn continue performing rotor-router walk, stopping either when it reaches an unoccupied site or when it hits the larger shell Sρ + h, then by the abelian property, the number of particles that reach Sρ + h will be Nρ + h. We will show that when h is order r1 - 1 / d, a constant fraction of the particles that reach Sρ find unoccupied sites before reaching Sρ + h.

Fix integers ρ  ≥  r and h  ≥  1. In the setting of Proposition [\ref=HP], let Γ be the lattice ball Bρ + h + 1, and let Z  =  Sρ + h. Fix y∈Sρ + h and let Y = {y}. For x∈Sρ, let s(x) be the number of particles stopped at x if each particle in rotor-router aggregation is stopped either when it reaches an unoccupied site or when it reaches Sρ. Write

[formula]

where T is the first hitting time of Sρ + h. By Lemma [\ref=inthezone] we have

[formula]

where

[formula]

is the number of particles that ever visit the shell Sρ.

By Lemma [\ref=harmonicmeasuregrad] the sum in ([\ref=HPbound]) is at most J' log h, hence from Propositon [\ref=HP] and ([\ref=H_wbound]) we have

[formula]

Let ρ(0)  =  r, and define ρ(i) inductively by

[formula]

Fixing h  <  ρ(i + 1) - ρ(i), we have

[formula]

so ([\ref=tinyRRs]) with ρ  =  ρ(i) simplifies to

[formula]

where C  =  J  +  J'.

Since all particles that visit Sρ(i) + h during rotor-router aggregation must pass through Sρ(i), we have by the abelian property

[formula]

Let [formula]. There are at most Mρ(i) + h nonzero terms in the sum on the right side of ([\ref=alltermsaresmall]), and each term is bounded above by ([\ref=eventinierRRs]), hence

[formula]

where the second inequality follows from Nρ(i) + h  ≥  Nρ(i) / 2. Summing over h, we obtain

[formula]

The left side is at most Nρ(i), hence

[formula]

provided Nρ(i)  ≥  C': = (2dC)2d - 1. Thus the minimum in ([\ref=doublemin]) is not attained by its first argument. It follows that Nρ(i + 1)  ≤  Nρ(i) / 2, hence Nρ(a log r)  <  C' for a sufficiently large constant a.

By the inner estimate, since the ball Br - c log r is entirely occupied, we have

[formula]

Write xi  =  ρ(i + 1) - ρ(i) - 1; by ([\ref=lotsavolume]) we have

[formula]

By Jensen's inequality, subject to this constraint, [formula] is maximized when all xi are equal, in which case xi  ≤  C''r1 - 1 / d and

[formula]

Since Nρ(a log r)  <  C' we have Nρ(a log r) + C'  =  0; that is, no particles reach the shell Sρ(a log r) + C'. Taking c'  =  C'  +  C'', we obtain from ([\ref=outershellbound])

[formula]

Concluding Remarks

A number of intriguing questions remain unanswered. Although we have shown that the asymptotic shape of the rotor-router model is a ball, the near perfect circularity found in Figure [\ref=rotor1m] remains a mystery. In particular, we do not know whether an analogue of Theorem [\ref=divsandcircintro] holds for the rotor-router model, with constant error in the radius as the number of particles grows.

Equally mysterious are the patterns in the rotor directions evident in Figure [\ref=rotor1m]. The rotor directions can be viewed as values of the odometer function mod 2d, but our control of the odometer is not fine enough to provide useful information about the patterns. If the rescaled occupied region [formula] is viewed as a subset of the complex plane, it appears that the monochromatic regions visible in Figure [\ref=rotor1m], in which all rotors point in the same direction, occur near points of the form (1 + 2z)- 1 / 2, where z  =  a + bi is a Gaussian integer (i.e. [formula]). We do not even have a heuristic explanation for this phenomenon. Figure 7 shows the image of A1,000,000 under the map z  ↦  1 / z2; the monochromatic patches in the transformed region occur at lattice points.

László Lovász (personal communication) has asked whether the occupied region An is simply connected, i.e. whether its complement is connected. While Theorem [\ref=rotorcirc] shows that An cannot have any holes far from the boundary, we cannot answer his question at present.

A final question is whether our methods could be adapted to internal DLA to show that if n = ωdrd, then with high probability Br - c log r  ⊂  In, where In is the internal DLA cluster of n particles. The current best bound is due to Lawler [\cite=Lawler95], who proves that with high probability Br - r1 / 3( log r)2  ⊂  In.

Acknowledgments

The authors thank Jim Propp for bringing the rotor-router model to our attention and for many fruitful discussions. We also had useful discussions with Oded Schramm, Scott Sheffield and Misha Sodin. We thank Wilfried Huss for pointing out an error in an earlier draft. Yelena Shvets helped draw some of the figures.