Three-pile Sharing Nim and the quadratic time winning strategy

Introduction

In a supermarket, it is the usual practice that bottles of milk with a shorter expiration date are placed in the front (the customer side) of shelves and those with a longer expiration date are placed at the back (the store side). One day, two staff challenge each other with the following game. There are a different number of bottles with a short expiry date in rows on the shelf (Figure [\ref=F.Milk] (a)). The staff need to make sure that there is roughly an equal number of bottles in each row to increase the likelihood that customers will take the older milk in the front rather than the fresher milk which will be placed at the back of the shelf. The two staff take turns to move a bottle from a row which has a larger number of bottles and move it to a row which has a smaller number of bottles, such that the size of the destination row does not exceed that of the source row. The staff member who makes the final move, that is, when the difference between the row with the highest number of bottles and the row with the lowest number of bottles is at most one, wins. Figure [\ref=F.Milk] (b) gives a possible ending state of the game in Figure [\ref=F.Milk] (a). We will analyze this game in this paper.

A combinatorial game is played by two players in which the players move alternately, following some given rules of moves. The players are aware of the situation of the game after each move. There is no element of luck (for example, dealing cards). In the normal convention, the player who cannot find a legal move in her turn loses. A game is short if it has finitely many positions and each position can be visited no more than one time. A game is impartial if the two players have the same legal moves from every position. In this paper, games are short and impartial. The reader can find a comprehensive theory of combinatorial games, especially impartial games, in [\cite=ww] [\cite=Con01].

The game of Nim, analyzed by Bouton [\cite=Bouton], provides a typical example of combinatorial games. Nim is played with a finite row of piles of tokens. A move consists of choosing one pile and removing an arbitrary number of tokens from that pile.

Several variants of Nim have been studied in the literature. For examples, in the game of End-Nim [\cite=Alb01], from a row of piles of tokens, a move can remove tokens from only either of the end piles. This is an example of restriction of Nim. In Wythoff [\cite=Wyt], played with two piles, one can remove tokens from one pile as in Nim or remove an equal number of tokens from both piles. Wythoff is an example of extension of Nim.

In this paper, we examine a 3-pile variant of Nim in which the players move tokens from one pile to some other without reducing the total of tokens. The rule of game is as follows. There are three piles of tokens. In her turn, the player takes some tokens from one pile and adds them to one of other piles provided that after the move the receiving pile does not have more tokens than the source pile. The player who makes the last move wins. We call this game Sharing Nim.

By definition there are three types of moves for Sharing Nim as follows from (a,b,c) with a  ≤  b  ≤  c:

(a,b,c)  →  (a + k,b - k,c) with k  ≤  (b - a) / 2; or

(a,b,c)  →  (a + k,b,c - k) with k  ≤  (c - a) / 2; or

(a,b,c)  →  (a,b + k,c - k) with k  ≤  (c - b) / 2.

A position is called an N-position if the player about to move next has a plan of moves to win. Otherwise, we have a P-position. We also use P as the set of P-positions. A position without available move is a terminal position.

For a subset S of nonnegative integers, [formula] is the least nonnegative integer not in S. By this, [formula] (corresponding to terminal position). The Sprague-Grundy value G(p), also known as nim-value, of a position p is defined recursively as follows: [formula]. We call k-position a position whose nim-value is k. One can see that a position is a P-position if and only if it is a 0-position.

Nim-values are essential for the understanding of those games that can be decomposed into separate components such that each of which is also a game. We call such cases sums of games. In other words, a sum G + H of two given games G and H is a game in which a move can be made in either G or H following exactly the rules for chosen game. The sum game ends if there is no move available from both G and H. It was showed independently by Sprague [\cite=Spr36] [\cite=Spr37] and Grundy [\cite=Gru39] that [formula] in which [formula], call nim-addition, is the addition in binary number system without carrying, meaning [formula]. In particular, G + H is a P-positions if and only if G(H)  =  G(G).

For example, the game of Nim with multiple piles is the sum of single piles and the nim-value of position consisting of n piles [formula] is [formula].

We start with a remark on the simplification of positions of 3-pile Sharing Nim. By the definition of the game, we have

For positive integers a,b, and c with a  ≤  b  ≤  c, G(a,b,c)  =  G(0,b - a,c - a). We also write [formula].

Thus, it is enough to study positions (0,a,b). We also assume that a  ≤  b in that notation.

By Lemma [\ref=Lem.sim], we will use (0,a,b) to denote the class of all positions (c,a + c,b + c).

We give nim-values G(0,a,b) for 0  ≤  a  ≤  b  ≤  16 in Table [\ref=T1] in which the entry (a,b) is the nim-value G(0,a,b). The top diagonal that contains all (a,a)-entries is called main diagonal. One can see in Table [\ref=T1] that each column is equal to its reverse. For example, the 5th column in Table [\ref=T1] is (0,3,1,1,3,0).

We will prove this phenomenon in the next section. We then characterize P-positions and discuss related properties in Section [\ref=S.P]. It will be shown that the winning strategy can be computed in quadratic time. The strategy can also be taught to first-year students in secondary school, requiring only background on arithmetics. Section [\ref=S.P.per] discusses the periodicity of P-positions and N-position. Especially, we raise evidence supporting the conjecture that rows and diagonals in Table [\ref=T1] seem to be bounded but not ultimately periodic. In Section [\ref=S.v1], we give a formula for 1-positions. We discuss the distribution of nim-values in two dimensional array in Section [\ref=S.Dis].

Symmetry and palindromes

We explain the two properties of Table [\ref=T1] mentioned in Section [\ref=S.int]. A sequence is a palindrome if it reads the same backward or forward. For example, (1,2,3,2,1) is a palindrome. We show that for a  ≤  b / 2, the sequence [formula] is a palindrome. This explains the phenomenon of columns we have mentioned on Table [\ref=T1] in Section [\ref=S.int].

For all a,b such that 0  ≤  a  ≤  b, G(0,a,b)  =  G(0,b - a,b).

We prove the theorem by induction on b. It can be checked that the theorem holds for b  =  1 and b  =  2. Assume that the theorem holds for b  ≤  n for some n  ≥  2. We show that the theorem holds for b  =  n + 1. We prove this claim by induction on a.

We first prove the case a  =  1. We show that

[formula]

A move from either of these two positions is to take k tokens from a pile of size n + 1 and add to a pile of size 0 provided that k  ≤  n + 1 - k. It remains to show that

[formula]

By Lemma [\ref=Lem.sim], the RHS is G(0,n + 1 - 2k,n + 1 - k). Since n + 1 - k  ≤  n, by the inductive hypothesis on b, ([\ref=pro.eq.1]) holds.

Assume that for b  =  n + 1 the theorem holds for all a  ≤  m for some m such that 0  ≤  m  <  b. We show that the theorem holds for a  =  m + 1 or equivalently

[formula]

Let p  =  (0,m + 1,n + 1) and q  =  (0,n - m,n + 1). It suffices to prove the two following facts:

if there exists a move from p to p' then there exists a move from q to q' such that G(q')  =  G(p');

if there exists a move from q to q' then there exists a move from p to p' such that G(p')  =  G(q').

From some position (0,x,y), there may be three types of moves, to (k,x - k,y) or (0,x + k,y - k) or (k,x,y - k). We will prove only one type of moves in . The other types of moves of and can be treated essentially the same and we leave to the reader. Using Figure [\ref=F.com], it is easy to find the corresponding moves to p',q' required in and above. We will mention this as bellow.

Consider the move p  →  (k,m + 1 - k,n + 1)  =  (0,m + 1 - 2k,n + 1 - k)  =  p' where k  ≤  (m + 1) / 2. In Figure [\ref=F.com], this option moves k tokens from the red middle pile to the left one. Consider the move from q to q'  =  (0,n + 1 - m + k,n + 1 - k). In Figure [\ref=F.com], this option moves k tokens from the blue left pile to the middle one. Since n + 1 - k  ≤  n, by the inductive hypothesis on b, G(q')  =  G(p') and so ([\ref=pro.eq.2]) holds.

By the principle of mathematical induction, the theorem holds for b  =  n + 1 and a  ≤  b. Again, by the principle of mathematical induction, the theorem holds for all b and a  ≤  b.

Theorem [\ref=thm.ab] can be explained as follows. Given position p  =  (a,b,c) and n  ≥  c. Consider the position q  =  (n - a,n - b,n - c). By Lemma [\ref=Lem.sim] and Theorem [\ref=thm.ab], G(p)  =  G(q). Note that the position q obtained by adding the amount of tokens to each pile from p until reaching n. By Lemma [\ref=Lem.sim], it is sufficient to consider the case a  =  0 and n  =  c. We say that q is the complement of the position p (Figure [\ref=F.com] (α)).

One can also use Figure [\ref=F.com] to prove Theorem [\ref=thm.ab]. In order to prove this, we prove the formula G(a,b,c)  =  G(n - a,n - b,n - c) with n being fixed. The proof can be done by induction on c - a. The base case is when c - a  ≤  1 (Figure [\ref=F.com.base]).

Two games G and H are said to be isomorphic if there is one-to-one map f between position sets of G and H such that x  →  x' is a move in G if and only if there exist positions y,y' in H such that y  →  y' is a move and f(x)  =  y, f(x')  =  y'. The following follows straightforwardly from the proof of Theorem [\ref=thm.ab].

The two game positions (0,a,b) and (0,b - a,b) are isomorphic.

By Theorem [\ref=thm.ab], it suffices to analyze positions (0,a,b) with a  ≤  b / 2.

The following corollary means each finite column displayed in Table [\ref=T1] is a palindrome.

For a  ≤  b / 2, the sequence

[formula]

is a palindrome.

It also follows from Theorem [\ref=thm.ab] that in Table [\ref=T1], the row of nim-values on the right of the entry (a,2a) and the diagonal (parallel to the main diagonal) of nim-values starting from this entry are identical.

The two sequences (G(0,a,2a + i))i  ≥  0 and (G(0,a + i,2a + i))i  ≥  0 are identical.

Characteristics of P-positions

We formulate P-positions and describe related properties. By this formula, we can decide in quadratic time whether or not a given position is a P-position. Moreover, from an N-position, one can find a winning move (moving to some P-position) in quadratic time.

The P-positions form the set

[formula]

Set

[formula]

We need to prove two facts:

there is no move between any two distinct positions in A, and

from any nonterminal position not in A, there exists a move that terminates in A.

For (1), first note that there is no move from either (0,0,22k(2l + 1)) or (0,22k(2l + 1),22k(2l + 1)) to (0,0,0). There is no move from a position of the form (0,0,22k(2l + 1) to some other position of the same form since such a move increases one pile of size 1 and keeps the other unchanged. There is also no move from a position of the form (0,22k(2l + 1),22k(2l + 1)) to some other position of the same form since such a move reduces one of the two biggest piles. It remains to show that

there is no move (0,0,22k(2l + 1))  →  (0,22k'(2l' + 1),22k'(2l' + 1)), and

there is no move (0,22k(2l + 1),22k(2l + 1))  →  (0,0,22k'(2l' + 1)).

For , the only possible move that equalizes the two biggest piles is (0,0,22k(2l + 1))  →  (0,22k - 1(2l + 1),22k - 1(2l + 1)). For , the only move that equalizes the smallest two piles is [formula]. Since the power of 2 in resulted positions are 2k - 1, and hold.

We now prove (2). Let p  =  (0,a,b) be a position not in A. By Theorem [\ref=thm.ab], it suffices to choose a,b such that a  ≤  b / 2. Set b  =  a + y. Then p  =  (0,a,a + y) with a  ≤  y.

Consider y - a. There exist k  ≥  0 and l  ≥  0 such that either y - a  =  22k(2l + 1) or y - a  =  22k + 1(2l + 1). For the former case, p can be moved to

[formula]

For the latter case, p can be moved to

[formula]

Note that the two forms of P-positions in Theorem [\ref=P] are symmetric by Theorem [\ref=thm.ab].

To decide whether or not a given position is a P-position, it is sufficient to test if there are two equal piles and the difference between this size and that of the remaining pile is equal to some 22k(2l + 1). The first task involves three subtractions, requiring linear time. The second task is to shift all the bits two squares to the right repeatedly (dividing by 4 repeatedly) before checking if the last digit is 1. Shifting rightwards two bits requires 4L times, with L being the length � the input. When the input contains only 1's, we need to repeat shifting L / 2 times. Therefore, the second task requires quadratic time.

We have the following optimization property.

It follows from Theorem [\ref=P] and Lemma [\ref=Lem.sim] that from an N-position (a,b,c), exactly one of the following three moves is the winning move:

equalizing the two piles a and b: moving (b - a) / 2 tokens from pile b to pile a, or

equalizing the two piles b and c, or

equalizing the two piles a and c.

Especially, if there are two equal piles, the winning move, if it exists, can be made simply without knowledge of P-positions shown in Theorem [\ref=P]: equalizing one of these two piles with the third pile (the pile having different size).

Thus, the winning strategy can be taught to first year students at high school with basic background on arithmetics: starting with each option in Remark [\ref=R.opt-move] before dividing the difference in the size repeatedly by 4 until reaching either an odd number or an even number not divisible by 4. If the former case holds, that move is chosen. Otherwise, take another option in Remark [\ref=R.opt-move].

Since each option in Remark [\ref=R.opt-move] can be done in linear time, by Remark [\ref=R.P-linear], from an N-position, a move to some P-position can be computed in quadratic time.

We next answer the following counting problem. Suppose two players want to play this game with some n tokens. They need to decide the sizes of three piles. Assume one player volunteers to do this job with the intention of letting the other move first. How many different ways that she can arrange the sizes of tokens to win.

Let P(n) the number of P-positions involving exactly n tokens. Then P(n)  =  ⌊n / 3⌋ in which ⌊.⌋ denotes the integer part.

A P-position involving n tokens must be (a,a,a) or (a,a,a + b) or (a,a + b,a + b) for some a  ≤  ⌊n / 3⌋ and b  =  22k(2l + 1). Moreover, if (a,a,a + b) is a P-position then (a,a + b / 2,a + b / 2) is not a P-position by Theorem [\ref=P]. Similarly, if (a,a + b,a + b) is a P-position then (a,a,a + 2b) is not a P-position. Thus, for each a, there is at most one way to arrange the remaining n - 3a to establish a P-position. Since a  ≤  ⌊n / 3⌋, there are at most ⌊n / 3⌋ P-positions involving exactly n tokens.

For each a such that 1  ≤  a  ≤  ⌊n / 3⌋, consider n - 3a. Note that either n - 3a  =  22k(2l + 1) or n - 3a  =  22k + 1(2l + 1) for some k,l  ≥  0. In the former case, we have P-position (a,a,a + 22k(2l + 1)). In the latter case, we have P-position (a,a + 22k(2l + 1),a + 22k(2l + 1)). Therefore, there are exactly ⌊n / 3⌋ P-positions.

How is not an apparently bounded nim-sequence periodic?

We conjecture that nim-values in each row in Table [\ref=T1] are bounded. We then discuss the periodicity of P-positions and nim-values on rows of Table [\ref=T1].

Consider nim-values on Table [\ref=T1] and suppose we can extend the table large enough. One may have following questions.

Are the nim-values on each row bounded? If so, is each row ultimately periodic?

If the nim-values on each row are not bounded, is each row ultimately arithmetic periodic?

Recall that a sequence (si) is said to be ultimately periodic (resp. arithmetic periodic) if there exist n0 and p  >  0 (resp. and s  >  0) such that for all n  ≥  n0, si + p  =  si (resp. si + p  =  si  +  s). An arithmetic periodic sequence is said to be additive periodic if s  =  p.

By Theorem [\ref=P], the bottom row of Table [\ref=T1], with a  =  1, is not ultimately arithmetic periodic and, moreover, has entries 0 when b is even. Thus, question (2) is not relevant for the bottom row and also may not relevant for other rows. Moreover, our computation leads us to the following conjecture.

Given a  ≥  1, the nim-sequence (G(0,a,n))n  ≥  a is bounded.

For examples, the first 490 nim-values of the sequence (G(0,0,n)n  ≥  1) are bounded by 12 (Table [\ref=T.P], read from left to right); the first 500 nim-values of the sequence (G(0,2,n)n  ≥  3) are bounded by 41; the first 800 nim-values of the sequence (G(0,6,n)n  ≥  3) are bounded by 72. We include data for the second and the third examples in Appendix [\ref=App] (Figures [\ref=row3] and [\ref=row7]).

If Conjecture [\ref=C.bound] holds, the game displays a surprising pattern of nim-values. This property suggests that its Sprague-Grundy function would involve modulus division.

Note that multiple-pile Nim and several of its variants have property that if the size of one pile increase, the nim-values ultimately increase. For example, on the two-dimension array of nim-values of Wythoff whose (i,j) entry is nim-value G(i,j) of Wythoff game, every row is ultimately additive periodic [\cite=Lan04] and every diagonal parallel to the main diagonal contains every nonnegative integer [\cite=BF90]. Thus, rows and diagonals of nim-values for Wythoff are not bounded.

We now move our attention to Question (1): is each row in Table [\ref=T1] ultimately periodic? We start with the bottom row, studying the periodicity of the P-positions. We list the first 490 values of the bottom row of Table [\ref=T1] in Table [\ref=T.P].

As mentioned, the table suggests that the nim-values of the sequence (G(0,0,n))n  ≥  1 is bounded. Our data also shows that the first 1000 values of this sequence is bounded by 12. The pattern of the nim-values may raise question: is the sequence ultimately periodic? We will show that the answer is negative. Moreover, we will show that the periodicity does not even hold for P  /  N status of this sequence.

One may also ask if the positions whose nim-values are 1 in Table [\ref=T.P] are periodic. We will prove that periodicity in Section [\ref=S.v1].

Set

[formula]

Let n  ≥  3.

If n is odd, f(n)  =  0.

If n mod 25∈{4,12,16,20,28}, f(n)  =  0.

If n mod 25∈{2,6,8,10,14,18,22,24,26,30}, f(n)  =  1.

If n is odd, n  =  2l + 1 for some l and so (0,0,n) is a P-position by Theorem [\ref=P].

If n mod 25  =  16 or n  =  25m + 16, we rewrite n  =  24(2m + 1) and so (0,0,n) is a P-position by Theorem [\ref=P]. Set S  =  {4,12,20,28}. Note that each element s∈S can be written as 22(2l + 1). If n mod 25∈S, we rewrite n  =  25m  +  22(2l + 1)  =  22(23m + 2l + 1) and so (0,0,n) is a P-position by Theorem [\ref=P].

Set T  =  {2,6,8,10,14,18,22,24,26,30}. Note that every t∈T can be written as 22k + 1(2l + 1) with k  ≤  1. Therefore, if n mod 25∈T, n  =  22k + 1(24 - 2km + 2l + 1). Since 4 - 2k  >  0, n  =  22k + 1(2l' + 1) and so (0,0,n) is not a P-position by Theorem [\ref=P].

We display the first 490 values of f(n) as in Table [\ref=T.f], in which each row has 25 values (except for the first row) and the values in the bold column (the 10th one from the right) are corresponding to those f(n) with n mod 25  =  1. Note that Table [\ref=T.f] is obtained from Table [\ref=T.P] by replacing positive values by 1.

One may ask if the sequence (f(n))n  ≥  0 is ultimately periodic. The exceptional case not included in Proposition [\ref=P-per] is [formula] whose f(n) values form the bold column (first column) in Table [\ref=T.f]. This is the case the periodicity dies out. We now discuss this phenomenon.

The sequence (f(n))n  ≥  0 is not ultimately periodic.

Assume on the contradiction that (f(n))n  ≥  0 is ultimately periodic with period p and preperiod n0, meaning f(n + p)  =  f(n) for all n  ≥  n0. It follows from Proposition [\ref=P-per] that p is even. Otherwise, we can choose even n large enough such that (n + p) mod 25 belongs to the modulo set in the case (3) of Proposition [\ref=P-per], giving a contradiction.

Set S1  =  {4,12,16,20,28}, S2  =  {2,6,8,10,14,18,22,24,26,30}, and S  =  {2,4,6,8,10,12,14,18,20,22,26}. Note that S  =  {|s1 - s2||s1∈S1,s2∈S2,s1  >  s2}. We next prove that p mod 25∉S. Assume on the contradiction that p mod 25∈S. Without loss of generality, we can assume that p mod 25  =  s2  -  s1 for some s1∈S1 and s2∈S2. Since the sequence (f(n))n  ≥  0 is ultimately periodic, we can choose n large enough such that f(n + p)  =  f(n). Moreover, we can choose n such that n mod 25  =  s1, giving f(n)  =  0 by Proposition [\ref=P-per]. We now have (n + p) mod 25  =  s2 and so f(n + p)  =  1 by Proposition [\ref=P-per], giving f(n + p)  ≠  f(n). This is a contradiction.

We next show that p mod 25∉{0,16,24,28,30}  =  T. We show that for any t∈T such that p mod 25  =  t, there exists n  ≥  n0 such that n mod 25  =  1 and f(n + p)  ≠  f(n).

Consider the case p mod 25  =  0. We write p  =  2r(2q + 1)25. If r is odd, we choose n  =  2s(2t + 1)25 for some even s  >  r such that n  ≥  n0. This task is simply increasing s until n exceeds n0. Then (0,0,n) is not a P-position by Theorem [\ref=P] and so f(n)  =  1. Note that n + p  =  25 + r(2s - r(2t + 1) + 2q + 1). Since 5 + r is even and s  >  r, (0,0,n) is a P-position by Theorem [\ref=P] and so f(n + p)  =  0. Similarly, if r is even, we choose n with similar form and odd s. The same argument gives f(n)  =  0 and f(n + p)  =  1. In both cases, we have f(n + p)  ≠  f(n), contradicting to the ultimate periodicity of (f(n))n  ≥  0.

Similarly, one can argue that p mod 25  ≠  16,24,28,30. Thus, [formula]. This is a contradiction. Therefore, the sequence (f(n))n  ≥  0 is not ultimately periodic.

If the bottom row of Table [\ref=T1] is ultimately periodic, (f(n))n  ≥  1 is ultimately periodic. It follows from Theorem [\ref=P-n-per] that the bottom row (and similarly, the main diagonal) of Table [\ref=T1] is not ultimately periodic. Based on this phenomenon, it is also reasonable to conjecture that

Rows of Table [\ref=T1] are not ultimately periodic.

The reason for the conjecture is that computing sequence (G(0,a,n))n  ≥  a partially requires data from sequences (G(0,c,n))n  ≥  c for c  <  a. This is because from any position (0,a,n) for n  ≥  2a, there exists a move to some position (0,c,m), by moving a - c tokens from the pile of size n to the pile of size 1.

We now discuss the periodicity of P-positions. We say that g-positions in the ath row of Table [\ref=T1] is ultimately periodic if there exist n0 and p such that for all n  ≥  n0, (0,a,n) is a g-position if and only if (0,a,n + p) is a g-position. It follows from Theorem [\ref=P-n-per] that

The distribution of P-positions on the bottom row are not periodic.

A formula for 1-positions

We prove a formula for 1-positions.

The 1-positions form the set

[formula]

Recall that the P-positions form the set P  =  {(0,0,0),(0,0,22k(2l + 1)),(0,22k(2l + 1),22k(2l + 1))|k  ≥  0,l  ≥  0} (Theorem [\ref=P]). It can be checked that [formula]. We need to prove the following two facts:

there is no move between any two distinct positions in B, and

from any position not in [formula], there exists a move that terminates in B.

It is simple to check and we leave to the reader. For , let [formula]. We write a  =  4q + r and b  =  a  +  4s + t. By Corollary [\ref=C.iso], it suffices to consider the case where a  ≤  b / 2 or equivalently 4s + t  ≥  4q + r.

We have mentioned that in position (a,b,c), we assume that a  ≤  b  ≤  c. Note that after a move, the hierarchy may not be the same and we need reorder the entries. We skip the process of reordering entries in a position after a move in this proof. For example, we may write "removing 3 token from the third entry to the first entry leads (1,2,7) to (0,2,2)". Here, we mean [formula] after subtracting 2 from each entry and reordering entries by increasing order.

Consider the case t = 0.

If r  =  0, x  =  (0,4q,4q + 4s). We examine the parity of s.

If s is odd or equivalently s  =  2p + 1, moving 2s tokens from the third pile to the second leads x to (0,4q + 2s,4q + 2s)  =  (0,4(q + p) + 2,4(q + p) + 2)∈B.

If s is even or equivalently s  =  2p, moving 2s - 1 tokens from the third pile to the second leads x to (0,4q + 2s - 1,4q + 2s + 1)  =  (0,4(q + p) - 1,4(q + p) + 1)∈B.

If r  =  1, x  =  (0,4q + 1,4q + 1 + 4s) with s  >  q. Moving 4q + 3 tokens from the third pile to the first leads x to [formula].

If r  =  2, x  =  (0,4q + 2,4q + 2 + 4s) with s  >  q. We examine the parity for s.

If s is odd or equivalently s  =  2p + 1, moving 4p + 1 tokens from the third pile to the second leads x to (0,4(q + p + 1) - 1,4(q + p + 1) + 1)∈B.

If s is even or equivalently s  =  2p, moving 2s  =  4p tokens from the third pile to the second leads x to (0,4(q + p) + 2,4(q + p) + 2)∈B

If r  =  3, x  =  (0,4q + 3,4q + 3 + 4s) with s  >  q. Moving 4q + 1 tokens from the third entry to the first leads x to [formula].

Consider the case t = 1.

If r  =  0, x  =  (0,4q,4q + 4s + 1) with s  ≥  q. Moving 4q - 2 tokens from the third entry to the first leads x to [formula].

If r  =  1, x  =  (0,4q + 1,4q + 1 + 4s + 1) with s  ≥  q. We examine the parity of s - q.

If s - q is odd, s  >  q. Moreover, s - q - 1  =  2p for some p  ≥  0. Moving 2q + 2s + 1 tokens from the third entry to the first leads x to (2q + 2s + 1,4q + 1,2q + 2s + 1)  =  (2(s - q - 1) + 2,0,2(s - q - 1) + 2)  =  (0,4p + 2,4p + 2)∈B.

If s - q is even, s - q  =  2p for some p  ≥  0. Moving 2q + 2s tokens from the third entry to the first leads x to [formula].

If r  =  2, x  =  (0,4q + 2,4q + 2 + 4s + 1) with s  >  q. Moving 4q + 4 tokens from the third entry to the first leads x to [formula].

If r  =  3, x  =  (0,4q + 3,4q + 3 + 4s + 1) with s  >  q. Moving 4q + 3 tokens from the third entry to the first leads x to [formula].

Consider the case t  =  2.

If r  =  0, x  =  (0,4q,4q + 4s + 2) with s  ≥  q. Moving 4q tokens from the third entry to the first leads x to [formula].

If r  =  1, x  =  (0,4q + 1,4q + 1 + 4s + 2) with s  ≥  q. Moving 4q - 1 tokens from the third entry to the first leads x to [formula].

If r  =  2, x  =  (0,4q + 2,4q + 2 + 4s + 2). If s  =  q, moving 4q + 1 tokens from the third entry to the first leads x to [formula]. We now consider the case s  >  q and examine s - q.

If s - q  =  2p for some p. Moving 2q + 2s + 1 tokens from the third entry to the first leads x to [formula].

If s - q  =  2p + 1, moving 2q + 2s + 2 tokens from the third entry to the first leads x to [formula].

If r  =  3, x  =  (0,4q + 3,4q + 3 + 4s + 2) with s  >  q. If s is even or equivalently s  =  2p, moving 2s  =  4p tokens from the third entry to the second leads x to [formula]. If s is odd or s  =  2p + 1, moving 2s + 1  =  4p + 3 tokens from the third entry to the second leads x to (0,4(q + p + 1) + 2,4(q + p + 1) + 2)∈B.

Consider the case t = 3.

If r  =  0, x  =  (0,4q,4q + 4s + 3) with s  ≥  q. Moving 4q + 2 tokens from the third entry to the first leads x to [formula].

If r  =  1, x  =  (0,4q + 1,4q + 1 + 4s + 3) with s  ≥  q. Moving 4q + 1 tokens from the third entry to the first leads x to [formula].

If r  =  2, x  =  (0,4q + 2,4q + 2 + 4s + 3) with s  ≥  q. Moving 4q tokens from the third entry to the first leads x to [formula].

If r  =  3, x  =  (0,4q + 3,4q + 3 + 4s + 3) with s  ≥  q.

Consider the case s  =  q. Moving 4q + 2 tokens from the third entry to the first leads x to [formula].

Consider the case s  >  q.

If s - q is odd, or s - q  =  2p + 1 for some p. Moving 2q + 2s + 3 tokens from the third entry to the first leads x to [formula].

If s - q is even, or s - q  =  2p for some p. Moving 2q + 2s + 2 tokens from the third entry to the first leads x to [formula].

As mentioned in Section [\ref=S.P.per], the positions whose nim-values are 1 appearing in Table [\ref=T.P] are periodic, corresponding to those having formula (0,0,4k + 2). Moreover, by Theorem [\ref=v1], we have the following periodicity of 1-positions on the bottom and the third one from the bottom

The 1-positions distributed on the bottom row (reps. main diagonal) and the third row (reps. third diagonal from the top diagonal) from the bottom of Table [\ref=T1] are periodic.

An estimation of the distribution of nim-values

In this section, we will discuss the bound of the distribution of g-positions for each g.

We have shown that the P-positions appear only on the bottom row (and the main diagonal) of Table [\ref=T1]. By Theorem [\ref=v1], 1-positions are distributed on only bottom row and the third row (from the bottom), except for the position (0,1,2). Let we ignore diagonals as they are identical to rows. Although 1-positions are periodic on each row, the P-positions are not periodic (Corollary [\ref=P-notperiodic]). We haven't known if the periodicity will hold for k-positions on each row (for k  ≥  2).

Our computation shows that for each nim-value g  ≥  2, g-positions are distributed on the bottom 2g rows or less of Table [\ref=T1] (or top 2g diagonals).

For a  ≤  b / 2, if G(0,a,b)  =  g  ≥  2 then a  ≤  2g - 1.

We give here examples with g  =  2 and g  =  3. For g  =  2, 2-positions (0,a,b) has a  ≤  3 (We have tested for a  ≤  14) with following first 300 values for b:

a  =  0: 32, 72, 104, 120, 128, 136, 200, 216, 232, 248, 288.

a  =  1: 3, 13, 17, 18, 23, 29, 33, 38, 39, 40, 46, 48, 53, 55, 57, 61, 62, 68, 70, 80, 85, 86, 87, 91, 95, 96, 100, 101, 102, 109, 110, 116, 117, 118, 124, 126, 128, 132, 136, 144, 145, 150, 151, 159, 165, 166, 167, 174, 176, 181, 182, 187, 189, 195, 196, 197, 204, 206, 208, 212, 213, 214, 222, 223, 224, 228, 229, 238, 240, 244, 256, 263, 278, 279, 284, 285, 294, 295, 296.

a  =  2: 4, 6, 7, 11, 26, 27, 46, 71, 78, 80, 110, 136, 151, 159, 160, 174, 182, 190, 232, 247, 248, 256, 263, 264, 271, 272, 279, 288.

a  =  3: 23, 67, 147, 243, 259, 275

For g  =  3, 3-positions (0,a,b) has a  ≤  3 (We have tested for a  ≤  14) with following first 300 values for b:

a  =  0: 8, 40, 88, 96, 160, 168, 184, 264, 280, 296.

a  =  1: 4, 5, 21, 25, 27, 31, 37, 45, 47, 54, 69, 76, 77, 78, 83, 84, 89, 111, 115, 125, 130, 131, 141, 146, 147, 156, 160, 161, 173, 192, 193, 198, 199, 207, 216, 221, 227, 237, 242, 253, 257, 259, 267, 269, 274, 289, 299.

a  =  2: 18, 19, 22, 31, 35, 48, 55, 62, 63, 70, 95, 102, 103, 104, 118, 119, 123, 134, 138, 139, 147, 150, 154, 167, 168, 170, 183, 184, 187, 199, 207, 214, 216, 224, 231, 235, 246, 250, 251, 260, 267, 275, 282, 283, 287, 292.

a  =  3: 7, 10, 36, 53, 60, 68, 89, 92, 107, 108, 124, 179, 184, 204, 221, 229, 236, 247, 279, 292.

Note that the estimation of a with a  ≤  2g - 1 seems to be overestimation. It seems that when g increases, a gets closed to g than to 2g - 1. For example, up to b  =  200, we have following bound for a:

g  =  4, a  ≤  6;

g  =  5, a  ≤  6;

g  =  6, a  ≤  7;

g  =  7, a  ≤  9;

g  =  8, a  ≤  12;

g  =  9, a  ≤  11;

g  =  10, a  ≤  13.

Discussion

We have analyzed 3-pile Sharing Nim and shown that this game can be solved in quadratic time. Especially, the strategy of this game can be understood easily by first year students at high school. We have also obtained a formula for 1-positions. We have discovered the case in which finite nim-sequences form palindromes when reading horizontally or vertically. Recall that palindromes is not unusual for two-pile Nim-like games when we read nim-values on the line that orthogonal to the main diagonal, consisting of entries (ea - i,i) for given a and 0  ≤  i  ≤  a. Such an example is Wythoff'g game [\cite=Wyt].

We have conjectured that the nim-sequence (G(0,a,n))n  ≥  a is bounded, presenting the possibility of a surprising pattern of nim-sequences of variants of Nim: nim-values are bounded regardless of the increase of a single pile. Regardless of the tendency of being bounded, it seems that these nim-sequences are not ultimately periodic, with the case a  =  0 being verified.

A possible research direction is to study the game with more than 3 piles. It can be seen that results in Section [\ref=S.palindrome] still holds for Sharing Nim with more than 3 piles, using Figure [\ref=F.com].

Another research direction is to playing Sharing Nim on graphs. The idea is as follow. On a direct graph, we place on each vertex a number of tokens. Each move consists of choosing one vertex x and moving an arbitrary number of tokens from that vertex to an adjacent vertex y provided that vertex y does not have more tokens than x after the move. Let we call this game Graph Nim. From this view, playing n-pile Sharing Nim is similar to playing Graph Nim on a complete graph Kn.

Appendix. Data on the bounded nim-sequences