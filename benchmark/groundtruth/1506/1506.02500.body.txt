Theorem Corollary Lemma Proposition Definition Example Remark

Two-weight norm inequalities for the Local Maximal Function

Introduction

Let Ω be a proper open and non empty subset of [formula]. Let Q = Q(x,l) be a cube with sides parallel to the axes. Here x and l denotes its center and half its side length respectively. For 0  <  β  <  1 we consider the family of cubes well-inside of Ω defined by

[formula]

where, as in all of this work, [formula] denotes the d∞ metric. Related to this family we have the following local maximal function on Ω:

[formula]

for every [formula] and every x∈Ω.

In 2014 E. Harboure and the two last authors ([\cite=HSV3]) considered this operator in the more general setting of a metric spaces X instead of [formula] with the Lebesgue measure replaced by a Borel measure μ defined only on Ω and doubling on the balls of Fβ (i.e.: ~  μ(B(x,2r))  ≤  c  μ(B(x,r)), whenever B(x,2r)∈Fβ). The main result of [\cite=HSV3] was a characterization of the weights w such that Mβ is bounded from Lp(Ω,wμ) to Lp(Ω,wμ), 1  <  p  <    ∞  , that is there exists a constant C such that

[formula]

for every function f∈Lp(Ω,w  dμ). The classes of weights related to this boundedness are a local version of the well known Ap-Muckenhoupt classes, associated to the Hardy-Littlewood maximal operator ([\cite=Muck]), more precisely non negative functions [formula] such that

[formula]

for every ball B in Fβ.

After seeing this result, it is natural to ask ourselves about the problem for a couple of weights (v,w). In connection with it, we should recall that the situation in the case [formula] do not have an easy answer. In fact, E. Sawyer ([\cite=SAW]) proved that the necessary and sufficient condition is

[formula]

for every cube [formula]. The problem becomes a little worse if we want to consider the boundedness from Lp to Lq with 1  <  p  ≤  q  <    ∞  . In this case, Sawyer again, but this time as a particular case of his solution of the problem for fractional maximal ([\cite=SAW2]), showed that the condition turns out to be

[formula]

Our setting is even a bit more complicated since the family Fβ does not include all the balls needed to consider Ω as a metric space itself. At this point, if we restrict the problem to the case p = q, a simple application of a result due to B. Jawerth (Theorem 3.1, p. 382 [\cite=JAW]) allows us to get

Given 1 < p  <    ∞  , 0  <  β  <  1. Let (u,v) be a pair of weights. Then assuming that σ = v1 - p' is a weight, the following statement are equivalent:

[formula]

if and only if there is a constant c such that

[formula]

for all finite unions F of cubes in Fβ, [formula]; provided

[formula]

where

[formula]

Leaving aside that we are not getting an answer to the whole problem, the hypothesis on (u,v) have two drawbacks. In the first place, integrals over finite unions of cubes must be calculated instead of only integrals over cubes like in [\eqref=Sawyer_condition]. In the second place the conditions involve the operator itself, which looks worse. The first disadvantage can be overcome by assuming an extra hypothesis on the weight v: a doubling condition related to [formula] over balls of Fβ. We say that a weight u satisfies a doubling condition on cubes of Fβ, denoted by u∈Dβ, whenever there exists a constant C = C(β) such that

[formula]

for every cube in Fβ such that 2Q∈Fβ, where 2Q means the concentric cube with side length two times the side length of Q, and [formula].

By assuming a Dβ condition on [formula], an application of results in [\cite=HSV3] shows that our context fulfill the hypothesis about the boundedness of Mβ,σ in Theorem [\ref=teo1]. But taking into account the additional geometric information we get about the sets on which the maximal is defined (notice that the Theorem of Jawerth is related to general basis of open sets in [formula]), a better result can be obtained. Indeed we can prove the following Theorem.

Given 1 < p  ≤  q  <    ∞  , 0  <  β  <  1. Let (u,v) be a pair of weights such that σ = v1 - p'∈Dβ, then

[formula]

for every function f∈Lp(v) if and only if

[formula]

for every cube Q∈Fβ.

Note that the hypothesis [\eqref=dos] looks like [\eqref=Sawyer_condition]. However the appearance of the operator, the second problem we have mentioned, makes it difficult to check the condition. In the case [formula] C. P�rez (Theorem 1.1, [\cite=PEREZ]) gave a solution by adding an A∞-condition on [formula]. We recall that a weight u belongs to the A∞ class of Muckenhoupt if there are positive constants c and δ such that

[formula]

for every measurable set E  ⊂  Q and every cube Q. With this extra assumption, the necessary and sufficient condition for the boundedness of the maximal is the existence of a constant C such that

[formula]

for every cube Q; which sometimes is referred to as Ap,q condition. It is important to note that we cannot apply the solution given by C. P�rez because, as it was said before, our setting is not even a metric space. However, it served as a source of inspiration for our second result. In order to formulate it we introduce a couple of definitions.

Given 0  <  β  <  1, we say that a weight u belongs to Aβ∞ if it there are positive constants c and δ such that [\eqref=c-delta] holds for every Q∈Fβ.

Let 1  <  p  ≤  q  <    ∞   and 0  <  β  <  1. We say that the weights u and v lies in the class [formula] if and only if

[formula]

for every cube Q∈Fβ, where [formula]. In this cases we write [formula].

Now we are in position to enunciate our second theorem where the reference to the operator in the hypothesis on the weights is completely avoided.

Let p, q, β and the weights u and v as in the Theorem above. In addition if u∈Dβ and σ = v- 1 / (p - 1) belongs to Aβ∞, then

[formula]

if and only if

[formula]

We note that, under the hypothesis of Theorem [\ref=teo3], the classes [formula] coincides for different values of β. So, as is the one-weight case, we can refer to those weights as local weights (see Lemma [\ref=apqcoinciden] in section 4.)

As an important tool to prove the theorem above we consider the centered local maximal function on Ω, namely Mcβ given by

[formula]

for every [formula] and every x∈Ω. For this operator we show that the following theorem holds. We enunciate it here because it is important itself.

Let 1  <  p  ≤  q  <    ∞  , 0  <  β  <  1 and let u and v be two weights such that σ = v- 1 / (p - 1) belongs to Aβ∞. Then

[formula]

if and only if

[formula]

Although the statements of our theorems are in terms of the maximal operator we want to remark that minor modifications in the proofs lead us to corresponding results for a fractional maximal function defined over Fβ.

The structure of the paper is as follows. Section 2 contains some useful geometrical lemmas. The proofs of Theorem [\ref=teo2] is in section 3. Finally the proofs of Theorems [\ref=teo3] and [\ref=Mb'] are in section 4.

Technical Lemmas

In this section we present a covering theorem and several covering results necessary for the proof of results below. We will write the following well-known theorem adapted to the context in our work and without proof.

Let [formula]. For each x∈E, let Qx be a cube centered at x. Assume that E is bounded or that sup x∈ElQx  <  1. Then, there exists a countable set E0  ⊂  E and a constant [formula] such that

[formula]

[formula]

Now, we need to explain the notion of "cloud" of a given cube. That is, given 0 < β < 1 and a cube Q∈Fβ, we shall denote the set

[formula]

and we say that these are the "cloud" of Q. This idea was introduced in [\cite=HSV3] and the proof of the following lemmas can be found there in the context of the metric spaces.

Let Q = Q(x,l)∈Fβ such that [formula]. We consider [formula] such that [formula]. Then there exists natural numbers h1,h2 independent of Q such that

[formula]

The proof is a consequence of the claim 1 and 2 contained in the proof of the lemma 2.3 in [\cite=HSV3].

Now, denoting by D the usual family of dyadic cubes belonging to Fβ we have the following lemma.

Let Ω be an open proper subset of [formula]. Given 0  <  β  <  1, for each [formula] such that 2- t  ≤  β / 5, there exists a covering Wt of Ω by dyadic cubes belonging to Fβ and satisfying the following properties

If R = R(xR,lR)∈Wt, then 10  R∈Fβ and

[formula]

There is a number M, only depending on β and t, such that for any cube Q0 = Q(x0,l0)∈Fβ with [formula], the cardinal of the set

[formula]

is at most M. We will call the union of this cubes as

[formula]

We will follow the ideas of Lemma 2.3 in [\cite=HSV3]. So, we only show how we take the covering Wt. For [formula], we consider the bands defined by

[formula]

If Ωk is non empty, let us consider the collection Gk of all usual dyadic cubes Qj = Q(xj,lj) such that

[formula]

where t is given as in the hypothesis. It is clear that Ωk  ⊂  Gk. Moreover, taking y∈Qj and [formula] we get

[formula]

and

[formula]

so the inclusion

[formula]

holds. However there are not cubes intersecting three bands simultaneously. In fact, suppose that there exists z,w∈Qj such that z∈Ωk - 1 and w∈Ωk + 1. Then

[formula]

This implies that t is less than or equal to 0 which is a contradiction. In conclusion, we can say that, for a fixed k there exists in Gk three classes of cubes

[formula]

Next, for each k we define the new collection Ek as follows: if either Qj  ⊂  Ωk or [formula] we put the cube Qj in Ek. If [formula] we consider the 2n dyadic sub-cubes and put them in Ek - 1. So, we note that Ek contains some cubes from Ek + 1 that have been subdivided into 2n sub-cubes. Thus, the collections Ek are pairwise disjoint and for each Qj(xj,lj)∈Ek we have that lj = 2k - t - 2 and

[formula]

Now, we are able to define a disjoint collection of dyadic cubes by

[formula]

This is the family of cubes that we will consider. Then, the properties of the lemma follows by analogous arguments of [\cite=HSV3].

Let 0 < β < 1, [formula] and μ be a measure doubling on Fβ. We consider [formula] such that 2- t  ≤  β / 20 and the covering Wt of the Lemma above. Then, for any cube Q such that [formula] there exists a constant K depending only on β and the constant of the doubling property of μ such that

[formula]

where Wt,Q is as in Lemma above.

The proof follows the same lines as in Remark 3.2 in [\cite=HSV3] in the general setting of metric spaces.

Since Nβ(Q)  ⊂  Wt,Q for every cube in Fβ, by the Lemma above we can deduce that

[formula]

We observe by the construction [\eqref=ecu24] that for each cube Qj(xj,lj)∈Ek  ⊂  Wt we get

[formula]

In general, we will say that a collection of cubes {Qi} is of Whitney's type if there exists constants 0  <  c1  <  c2  <  1 such that

[formula]

Let {Qi} be a pairwise disjoint collection of Whitney's type cubes. Then their clouds have bounded overlapping. More precisely, there exists a natural number M > 0 such that

[formula]

for every x in Ω.

Let {Qi} be a such collection, xi and li their centers and length sides respectively. Take again the bands Ωk as in Lemma [\ref=Metodo_HSV]. We consider x∈Ωk and assume that

[formula]

for some family of index F. Let us prove that there is a constant M such that the cardinal of this family is controlled by M for every point x∈Ω. By lemma [\ref=lema1], if the center xi∈Ωki, we can say that

[formula]

Thus, the range of j is independent of Qi and equal to h = h2 + h1. Now, since ki - h1  ≤  k  ≤  ki + h2 for every i∈F it is easy to see that

[formula]

that is, the range of values that may be the union of the clouds is 2h.

Now, suppose that there exists [formula] with i,s∈F and li  ≤  ls. Let Py, Pz, Pi and Ps be cubes such that

[formula]

[formula]

Now, we take as in the figure the points

[formula]

Then, since all the cubes belongs to Fβ and considering [\eqref=ecu22] we have the following estimation

[formula]

On the other hand

[formula]

Thus, there exists at most

[formula]

disjoint cubes of the family {Qi}. This fact and [\eqref=ecu22] say that the family F is finite and then there exists a fixed natural number M, depending only on β such that

[formula]

as we wanted to prove.

Let f be a non-negative, locally integrable function and μ be a doubling measure on [formula]. Suppose that for some h > 0 and some cube Q = Q(xQ,lQ)∈Fβ

[formula]

If 10Q∈Fβ then there exists a dyadic cube P = P(xP,lP) such that Q  ⊂  5P∈Fβ and a positive constant c1, independent of Q, such that

[formula]

If [formula] then there exists a dyadic cube R = R(xR,lR) such that Q  ⊂  Wt,R and a positive constant c2, independent of Q, such that

[formula]

where Wt is as in the Lemma [\ref=Metodo_HSV].

Let Q = Q(xQ,lQ) be a such cube of the hypothesis. For [\ref=Metodo_C-U_1] we consider [formula] such that 2k - 1  <  lQ  ≤  2k. Considering dyadic cubes with side length equal to 2k - 1, there exists a finite collection of dyadic cubes [formula], with 1  ≤  N  ≤  3n, which intersect the interior of Q. Calling P any of these and taking [formula], we have

[formula]

Now, if w∈Q we get

[formula]

which implies that Q  ⊂  5P. Moreover, for each z∈5P

[formula]

Thus, we can deduce that Q  ⊂  5P  ⊂  8Q. Now, a simpler estimation show that 5P∈Fβ whenever 10Q do it. In fact

[formula]

then, recalling that 0  <  β  <  1 we get

[formula]

this implies that [formula] as required. Furthermore, for at least one of these dyadic cubes, which we denote by P,

[formula]

since otherwise we get a contradiction. In fact

[formula]

Now, since 5P  ⊂  8Q, the Lebesgue measure say that inequality [\eqref=tres-a] follows with c1 = 5n / 24n.

In order to prove [\ref=Metodo_C-U_2], by the Lemma [\ref=Metodo_HSV] the cardinal of Wt,Q is finite and independent of Q, and its cubes are comparable size with Q, the same argument can be applied to take one of them, namely R such that [\eqref=tres-b] holds.

Proof of the Results

Assume that [\eqref=uno] holds. In particular, it is for f = σχQ, Q∈Fβ. Then

[formula]

To show that [\eqref=dos] implies [\eqref=uno], fix a non negative function f∈Lp(Ω,v). By a standard argument, we may assume without loss of generality that f is bounded and has compact support. Now, for each [formula], we consider the sets

[formula]

Considering a collection {Qkx}x∈Ak of cubes such that

[formula]

we define

[formula]

For the cubes in Q1 by [\ref=Metodo_C-U_1] of Lemma [\ref=Metodo_C-U] there exists a dyadic cube Pkx such that Qkx  ⊂  5Pkx, 5Pkx∈Fβ and

[formula]

On the other hand, for the cubes in Q2 we take t such that 2- t  ≤  β / 20 and consider the covering Wt of the Lemma [\ref=Metodo_HSV]. Now, we can apply [\ref=Metodo_C-U_2] of Lemma [\ref=Metodo_C-U] to have a dyadic cube Rkx such that its cloud contain the original cube Qkx and

[formula]

Since the Pkx's and Rkx's are dyadic and bounded in size (since f has compact support) we can obtain a maximal disjoint sub-collection [formula] such that for each x, either Qkx  ⊂  5Pkj or Qkx  ⊂  Wt,Pkj for some j.

We define [formula], if Pkj was chosen from a cube in Q1 and [formula] if Pkj was chosen from a cube in Q2. It is clear that [formula]. Now we define the following sets:

[formula]

Thus [formula] and since the Ak's are disjoint, the sets Ekj's are pairwise disjoint for all j and k.

In order to prove [\eqref=uno] we proceed as follows

[formula]

Now, multiplying and dividing by [formula] we have

[formula]

where [formula], the discrete measure ω on X is given by

[formula]

and for a non-negative, measurable function g, the operator T is defined by

[formula]

By interpolation's theory it is sufficient to show that T is weak-type (1,q / p) for getting [\eqref=uno]. For this, fix g bounded and with compact support. Then for λ  >  0 we consider

[formula]

By the definition of [formula] we have

[formula]

Then, we can estimate

[formula]

Remembering that 5Pkj∈Fβ and since Ekj  ⊂  5Pkj, it is not difficult to see that

[formula]

Let now {Pi} be the maximal disjoint sub-collection of {Pkj  : ~ (j,k)∈B1λ}. Then, since the Ekj are pairwise disjoint and the hypothesis [\eqref=dos] we have

[formula]

Finally, by the definition of B1λ, the cubes Pi's are disjoint and q / p  ≥  1

[formula]

The estimation above follows similar lines of the proof of Theorem 1.1 in [\cite=CUr].

Now, we need to estimate II. For this, let (j,k)∈B2λ and we write

[formula]

where Pkj,m∈Wt(Pkj) are disjoint. By Lemma [\ref=Metodo_HSV] [\ref=Metodo_HSV_-_3] we know that tkj  ≤  M where M is independent of the cubes. Then, considering tkj disjoint sets defined by

[formula]

So, we get

[formula]

where the sets Ekj,m are disjoint in j, m and k. Then

[formula]

Now, we consider for each Pkj,l a finite chain joining Pkj,l with Pkj,m, that is, a finite subset of Wt(Pkj), say [formula] which are all different, with R1 = Pkj,l and Rn = Pkj,m and for Ri and Ri + 1 neither Ri  ⊂  Ri + 1 or Ri + 1  ⊂  Ri.

Moreover, part [\ref=Metodo_HSV_-_1] and [\ref=Metodo_HSV_-_3] of the Lemma [\ref=Metodo_HSV] say that Pkj,m∈Fβ and n  ≤  M. Thus, since σ is doubling on Fβ we can deduce that σ(Pkj,l)  ≤  C    σ(Pkj,m). Then, by the Lemma [\ref=duplica] again we have

[formula]

where the last inequality holds because Ekj,m  ⊂  Pkj,m. Let [formula] be a maximal disjoint sub-collection of {Pkj,m} with 1  ≤  m  ≤  tkj and (j,k)∈B2λ. Then, since the Ekj,m's are pairwise disjoint, we have that

[formula]

Now, by inequality [\eqref=dos] and the fact that q  ≥  p we get

[formula]

Finally, since the operator T is defined on the cubes Pkj we need to take again a maximal disjoint sub-collection of the family {Pkj} with (j,k)∈B2λ. Let {Ps} be such sub-collection. Thus, since the Pi's are disjoint and Pi∈Wt,Pkj  ⊂  Wt,Ps for some (j,k)∈B2λ and some s, by the definition of the operator T we can estimate

[formula]

as we wanted to prove. Then the proof of the Theorem is complete.

More manageable conditions on cubes

Now we concentrate in the classes [formula]. Since Fα  ⊂  Fβ, whenever α  ≤  β we observe that [formula]. Moreover, if [formula] consist in all weights for what [\eqref=Apq_condition] holds for every cube [formula], it is clear that [formula]. This inclusion is proper. In fact taking u(x) = ||x||α and v(x) = ||x||γ, with [formula], it is not difficult to see that [formula] whenever - n  <  α  <  n(q - 1). However, if [formula] and 0  <  β  <  1, we can check that [formula] for every power [formula].

However, in the next Lemma, we show that, under certain conditions on the weights the classes [formula] really are independent of β.

Let 0  <  α  <  β  <  1. Let u and v be weights such that u,σ∈Dα. Then

[formula]

Let 0  <  α  <  β  <  1. By the previous observation, the Lemma is proved if we show the inclusion [formula]. For this, given a cube [formula] we consider the cube [formula]. Taking [formula] such that [formula], since ∈Fα, by the doubling condition on u and σ we get

[formula]

which proves the lemma.

Let σ∈Aβ∞. Then σ satisfies a Reverse Hölder inequality, i.e.

[formula]

for every cube Q∈Fβ.

We only need to observe that for every cube Q = Q(x,l)∈Fβ and any cube   =  (x',l')  ⊂  Q such that l  =  2  l' it follow that ∈Fβ. In fact, since [formula] and β  <  1

[formula]

implies

[formula]

Then, the proof follows a similar way as in [\cite=GCRF].

Let 0  <  β  <  1 and we consider [formula]. If σ = v- 1 / (p - 1)∈Aβ∞ then there exists p̃  <  p and   <  q such that [formula].

Since σ∈Aβ∞, by the Lemma [\ref=Ainf-->RHI] it follows that σ satisfies a Reverse Hölder inequality as in [\eqref=RHI]. Thus, from the hypothesis on the weights we get

[formula]

Now, taking δ  >  0 such that (p - 1) / (1 + ε) = p - δ - 1 the Lemma is proved defining p̃ = p - δ and [formula]. In fact,

[formula]

and noting that p / q  =  p̃  /   defining σ̃ = v- 1 / (p̃ - 1) by [\eqref=ecu10] we have [formula].

In the next Lemma we show the relation between the local and the centered local maximal function.

Let 0  <  α  <  1 / 4. There exists 0  <  γ  <  1 such that

[formula]

for every locally integrable function f and every x in Ω.

Let f be a locally integrable function. For 0  <  α  <  1 / 4 and x∈Ω we consider cubes Q, [formula] such that x∈Q∈Fα and [formula] is centered at x with [formula]. If we show that ∈Fγ, for some 0  <  γ  <  1 then the Lemma will be proved. In fact,

[formula]

then, taking the supremum over all cubes in Fα containing x we get [\eqref=Mb_vs_Mb']. So, we observe that

[formula]

thus

[formula]

Then, it is clear that ∈Fγ with [formula] since the choose of α.

That [\eqref=Max_cent] implies [\eqref=condicion_para_dos_pesos] is trivial using the test function σχQ for each cube Q∈Fβ and the definition of Mcβ.

On the other hand, since it is clear that [formula], if we prove that Mcβ is of weak type (p̃,) for some number p̃  <  p and   <  q, by applying the Marcinkiewicz interpolation theorem we will get the result.

In order to do this, let Uλ  =  {x∈Ω: ~ Mcβf(x)  >  λ} and let

[formula]

a covering for Uλ. Then, by the Theorem [\ref=BesiTeo] we can select a countable subfamily of cubes [formula] which still cover Uλ and such that [formula].

Then, considering p̃ and [formula] provided by the Lemma [\ref=lema4.2] and taking into account the property of the cubes in the covering we can write

[formula]

Hölder inequality with p̃  >  1 and Lemma [\ref=lema4.2] allows us to get

[formula]

and the proof of the Theorem is complete.

Now, we introduce the following maximal function. For each 0  <  β  <  1 we get

[formula]

Let 0  <  β  <  1 and let 1  <  p  ≤  q  <    ∞  . Given two weights u and v such that [formula] and σ∈Dβ, we have

[formula]

For each x∈Ω we choose a cube Qx such that [formula] and

[formula]

Now, let t be such that 2- t  ≤  β / 20 and we consider the covering Wt of Ω provided by the Lemma [\ref=Metodo_HSV]. For simplicity we write

[formula]

where the cubes Qj are disjoint. Since x∈Qj for some j, denoting xQ the center of Qx, we get

[formula]

This implies that their centers holds

[formula]

Since 10Qj∈Fβ by part [\ref=Metodo_HSV_-_1] of the Lemma [\ref=Metodo_HSV], the inequality above and the fact [formula] we have that

[formula]

Thus, |Qj|  ≤  C    |Qx|. Now, it is clear that x∈Nβ(Qj) since [formula]. Then, by Hölder inequality we can proceed as follows

[formula]

Since σ∈Dβ, by Remark [\ref=nubes_comparables] we get [formula]. In addition, we use the fact that [formula], p  ≤  q and by the Lemma [\ref=solapamiento_de_nubes_controlada] we can conclude that

[formula]

which gives [\eqref=Ms_acotada].

Now, we are going to apply the results mentioned above to prove the analogous result for the local maximal.

Clearly [\eqref=Max_beta] implies [\eqref=Apqbeta]. Conversely let 0 < β < 1. By Lemma [\ref=Max_local_vs_Max_centrada] with α  =  β / 4 there exists 0  <  γ  <  1 such that the inequality

[formula]

for every x∈Ω. Then, by Theorem [\ref=Mb'] and Proposition [\ref=Acotacion_de_Max_truncada] we have

[formula]

and the proof of the Theorem is complete.