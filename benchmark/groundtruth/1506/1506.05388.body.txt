Lemma Corollary Addendum Claim Proposition Question Conjecture

Definition Example

Extremal H-colorings of trees and 2-connected graphs

David Galvin

Introduction and statement of results

For a simple loopless graph G  =  (V(G),E(G)) and a graph H  =  (V(H),E(H)) (possibly with loops, but without multi-edges), an H-coloring of G is an adjacency-preserving map f:V(G)  →  V(H) (that is, a map satisfying f(x)  ~  Hf(y) whenever x  ~  Gy). Denote by hom (G,H) the number of H-colorings of G.

The notion of H-coloring has been the focus of extensive research in recent years. Lovász's monograph [\cite=Lovasz] explores natural connections to graph limits, quasi-randomness and property testing. Many important graph notions can be encoded via homomorphisms -- for example, proper q-coloring using H = Kq (the complete graph on q vertices), and independent (or stable) sets using [formula] (an edge with one looped endvertex). The language of H-coloring is also ideally suited for the mathematical study of hard-constraint spin models from statistical physics (see e.g. [\cite=BrightwellWinkler]). Particularly relevant to the present paper is the Widom-Rowlinson model of the occupation of space by k mutually repulsive particles, and which is encoded as an H-coloring by the graph HWR(k) which puts loops on every vertex of K1,k (the star on k + 1 vertices). Note that the original Widom-Rowlinson model [\cite=WidomRowlinson] has k = 2.

Many authors have addressed the following extremal enumerative question for H-coloring: given a family G of graphs, and a graph H, which G∈G maximizes or minimizes  hom(G,H)? This question can be traced back to Birkhoff's attacks on the 4-color theorem, but recent attention on it owes more to Wilf and (independently) Linial's mid-1980's query as to which n-vertex, m-edge graph admits the most Kq-colorings. For a survey of the wide variety of results and conjectures on the extremal enumerative H-coloring question, see [\cite=Cutler].

A focus of the present paper is the extremal enumerative H-coloring question for the family T(n), the set of all trees on n vertices. This family has two natural candidates for extremality, namely the path Pn and the star K1,n - 1, and indeed in [\cite=ProdingerTichy] Prodinger and Tichy showed that these two are extremal for the count of independent sets in trees: for all T∈T(n),

[formula]

The Hoffman-London matrix inequality (see e.g. [\cite=Hoffman] [\cite=London] [\cite=Sidorenko2]) is equivalent to the statement that hom (Pn,H)  ≤   hom (K1,n - 1,H) for all H and n; a significant generalization of this due to Sidorenko [\cite=Sidorenko] (see also [\cite=CsikvariLin] for a short proof) shows that the right-hand inequality of ([\ref=inq-PT]) extends to arbitrary H.

Fix H and n  ≥  1. Then for any T∈T(n),

[formula]

In other words, the star admits not just the most independent sets among n-vertex trees, but also the most H-colorings for arbitrary H. Two points are worth noting here. First, since deleting edges in a graph cannot decrease the number of H-colorings, Theorem [\ref=thm-siderenko] shows that among all connected graphs on n vertices, K1,n - 1 admits the most H-colorings. Second, if we extend T(n) instead to the family of graphs on n vertices with minimum degree at least 1 and consider even n, then as shown by the first author [\cite=Engbers] the number of H-colorings is maximized either by the star or by the graph consisting of a union of disjoint edges.

The left-hand side of ([\ref=inq-PT]) turns out not to generalize to arbitrary H: Csikvári and Lin [\cite=CsikvariLin], following earlier work of Leontovich [\cite=Leontovich], exhibit a (large) tree H and a tree E7 on seven vertices such that hom (E7,H)  <   hom (P7,H), and raise the natural question of characterizing those H for which hom (Pn,H)  ≤   hom (T,H) holds for all n and all T∈T(n).

Our first result gives a partial answer to this question. Before stating it, we need to establish a convention concerning degrees of vertices in graphs with loops.

Convention: For all graphs in this paper, the degree of a vertex v is the number of neighbors of v, i.e., d(v)  =  |{w:v  ~  w}|. In particular, a loop on a vertex adds one to the degree. We let Δ denote the maximum degree of H.

Let n  ≥  1 and let H be a regular graph. For an integer [formula], let [formula] be the graph obtained from H by adding [formula] looped dominating vertices sequentially. Then for any T∈T(n),

[formula]

Equality occurs if and only if T  =  Pn or [formula] is a complete looped graph.

Notice that the result also holds for H where each component is of the form [formula]. Theorem [\ref=thm-minfortrees] generalizes the left-hand side of ([\ref=inq-PT]), as [formula] is obtained from K1 by adding a single looped dominating vertex, and our proof is a generalization of the inductive approach used in [\cite=ProdingerTichy].

Since the Widom-Rowlinson graph HWR(k) can be constructed from the disjoint union of k looped vertices by the addition of a single looped dominating vertex, an immediate corollary of Theorem [\ref=thm-minfortrees] is that for all n  ≥  1,

[formula]

for all T∈T(n). We also note in passing that Theorem [\ref=thm-minfortrees] may be interpreted in terms of partial H-colorings of G (that is, H-colorings of induced subgraphs of G that need not be extendable to H-colorings of G). Specifically, when [formula] the theorem says that if H is regular, then among all n-vertex trees none admits fewer partial H-colorings than Pn.

Our second result is a new proof of Sidorenko's theorem, valid for sufficiently large n.

For non-regular H there is a constant cH such that if n  ≥  cH and T∈T(n) then

[formula]

with equality if and only if T  =  K1,n - 1.

(Notice that for Δ-regular H we have  hom(T,H)  =  |V(H)|Δn - 1 for all T∈T(n), so the restriction to non-regular H is only to highlight the characterization of equality.) While Theorem [\ref=thm-maxfortrees] is weaker than Theorem [\ref=thm-siderenko] in that it only holds for n  ≥  cH, it is noteworthy for two reasons. Firstly, our proof uses a stability technique -- we show that if a tree is not structurally close to a star (specifically, if it has a long path), then it admits significantly fewer H-colorings than the star, and if it is structurally almost a star but has some blemishes, then again it admits fewer H-colorings. Secondly, the proof is less tree-dependent than Sidorenko's, and so the ideas used may be applicable in other settings. We illustrate this by considering the extremal enumerative question for H-colorings of 2-connected graphs. Let C2(n) denote the set of 2-connected graphs on n vertices, and let Ka,b be the complete bipartite graph with a and b vertices in the two color sets. Also, for graph H with maximum degree Δ, denote by s(H) the number of ordered pairs (i,j) of vertices of H satisfying [formula]. The special case [formula] of the following was established by Hua and Zhang [\cite=HuaZhang].

For non-regular connected H there is a constant cH such that if n  ≥  cH and G∈C2(n) then

[formula]

with equality if and only if G = K2,n - 2.

For Δ-regular H the same conclusion holds whenever s(H)  ≥  2Δ2  +  1 (if H is loopless and bipartite) or s(H)  ≥  Δ2 + 1 (otherwise).

For regular H we have s(H)  ≥  |V(H)| (consider ordered pairs of the form (i,i)), so an immediate corollary in this case is that if |V(H)|  ≥  2Δ2 + 1 (if H is loopless and bipartite) or |V(H)|  ≥  Δ2 + 1 (otherwise) then for all large n K2,n - 2 is the unique 2-connected graph with the most H-colorings. Note that the bounds on s(H) in the Δ-regular case are tight with respect to the characterization of uniqueness: when [formula] we have hom (G,H)  =  Δn for all n-vertex G, and here s(H) = Δ2, and when H = KΔ,Δ (a loopless bipartite graph) we have [formula] for all n-vertex connected graphs G, and here s(H) = 2Δ2.

Since all G∈C2(n) are connected, the restriction to connected H is natural. Unlike with Theorem [\ref=thm-maxfortrees], the restriction to non-regular H is somewhat significant here. In particular, there are examples of regular graphs H such that for all large n, there are graphs in C2(n) that admit more H-colorings than K2,n - 2 (and so there is no direct analog of Theorem [\ref=thm-siderenko] in the world of two connected graphs). One such example is H = K3; it is easily checked that  hom(Cn,K3) >  hom(K2,n - 2,K3) for all n  ≥  6 (where Cn is the cycle on n vertices). More generally, we have the following.

Let n  ≥  3 and q  ≥  3 be given. Then for any G∈C2(n),

[formula]

with equality if and only if G = Cn, unless q = 3 and n = 5 in which case G = K2,3 also achieves equality.

The same conclusion holds with C2(n) replaced by the larger family of 2-edge-connected graphs on n vertices.

In the setting of Theorem [\ref=thm-2conn-cycles] it turns out that no extra complications are introduced in moving from 2-connected to 2-edge-connected. We do not, however, currently see a way to extend Theorem [\ref=thm-2connected] to this larger family. In particular, the key structural lemma given in Corollary [\ref=cor-P3] does not generalize to the family of 2-edge-connected graphs. The rest of the paper is laid out as follows. The proof of Theorem [\ref=thm-minfortrees] is given in Section [\ref=sec-minfortrees]. We prove Theorem [\ref=thm-maxfortrees] in Section [\ref=sec-maxfortrees], and use similar ideas to then prove Theorem [\ref=thm-2connected] in Section [\ref=sec-2connected]. The proof of Theorem [\ref=thm-2conn-cycles] is given in Section [\ref=sec-2conn-cycles]. Finally, we end with a number of open questions in Section [\ref=sec-concluding_remarks].

Proof of Theorem [\ref=thm-minfortrees]

Let H be a Δ-regular graph, and form [formula] by adding [formula] disjoint looped dominating vertices sequentially to H. Using induction on n, we will show something a little stronger than Theorem [\ref=thm-minfortrees], namely that for any n-vertex forest F, [formula], with equality if and only if either [formula] is a complete looped graph, or F = Pn. We will first prove the inequality, and then address the cases of equality.

For n  ≤  4, the only forest F on n vertices that is not a subgraph of Pn (and so for which [formula] is immediate) is F = K1,n - 1; but in this case the required inequality follows directly from the Hoffman-London inequality [\cite=Hoffman] [\cite=London].

So now fix n  ≥  5, and let F be a forest on n vertices. In what follows, for x∈V(F) and [formula] we write [formula] for the number of homomorphisms from F to [formula] that map x to i. Also, we'll assume that [formula] has [formula] vertices, say [formula], with the looped dominating vertices being [formula].

Let x be a leaf in F, with unique neighbor y (note that we may assume that F has an edge, because the desired inequality is trivial otherwise). For each [formula],

[formula]

which in particular implies [formula] if [formula]. So

[formula]

If F = Pn then F - x = Pn - 1 and F - x - y = Pn - 2. Therefore, using induction and the above argument twice, we have

[formula]

When can we achieve equality? If [formula] is the complete looped graph, then we have equality for all F. So we may assume that [formula] is not a complete looped graph, and that in particular there are [formula] with [formula]. Now consider an F with more than one component, and let u and v be vertices of F in different components. Using the looped dominating vertices of [formula] we may construct an [formula]-coloring of F in which u is colored i and v is colored j. This is not a valid [formula]-coloring of the forest obtained from F by adding the edge uv. It follows that there is a tree T on n vertices with [formula]. The proof of the Hoffman-London inequality (hom (K1,n - 1,H)  ≥   hom (Pn,H)) given in [\cite=Sidorenko2] in fact shows strict inequality for [formula] that is not a complete looped graph; since strict inequality holds for the base cases n  ≤  4, the inductive proof therefore gives strict inequality unless F - x = Pn - 1 and F - x - y = Pn - 2, which implies F = Pn.

Proof of Theorem [\ref=thm-maxfortrees]

The goal of this section is to show that for non-regular H there is a constant cH such that if n  ≥  cH and T∈T(n) then

[formula]

with equality if and only if T  =  K1,n - 1. Recall that a loop in H will count once toward the degree of a vertex v∈V(H) and Δ denotes the maximum degree of H. If H has components [formula] then [formula], so we may assume that H is connected.

Let V=  Δ  ⊂  V(H) be the set of vertices in H with degree Δ. By coloring the center of the star with a color from V=  Δ, we have

[formula]

We will show that if n  ≥  cH and T  ≠  K1,n - 1, then hom (T,H)  <  |V=  Δ|Δn - 1. We use the following lemma, which will also be needed in the proof of Theorem [\ref=thm-2connected].

For non-regular H there exists a constant [formula] such that if [formula], then hom (Pk,H)  <  Δk - 2.

Let A denote the adjacency matrix of H, which is a symmetric non-negative matrix. Since an H-coloring of Pk is exactly a walk of length k through H, we have

[formula]

By the Perron-Frobenius theorem (see e.g. [\cite=Seneta]), the largest eigenvalue λ of A has a strictly positive eigenvector [formula], for which it holds that Ak  =  λk. Considering the row of Ak containing [formula], it follows that [formula] for some constant c1. Combining this with ([\ref=eq-homs-lin-alg-count]) we find that hom (Pk,H)  ≤  |V(H)|2c1λk. Since H is not regular, we have λ  <  Δ, and so the lemma follows.

We use Lemma [\ref=lem-no_long_paths] to show that any tree T containing Pk as a subgraph, for [formula], has hom (T,H)  <  |V=  Δ|Δn - 1. Indeed, by first coloring the path and then iteratively coloring the rest of the tree we obtain

[formula]

(The bound hom (Pk,H)  <  Δk - 2 will be necessary for the proof of Theorem [\ref=thm-2connected]; here the weaker bound hom (Pk,H)  <  |V=  Δ|Δk - 1 would suffice.)

So suppose that T does not contain a path of length [formula]. Then there is a constant c2 > 0 (depending on [formula], but independent of n) and a vertex v∈T with d(v)  =  nc2. (To see this, note that in a tree on n vertices with maximum degree at most nc, a simple greedy algorithm readily constructs a path of length around 1 / c.) Since T  ≠  K1,n - 1 we have d(v)  <  n - 1 and so some neighbor w of v is adjacent to a vertex in [formula]. As H is connected and not regular, there is an i∈V(H) with dH(i)  =  Δ and dH(j)  ≤  Δ - 1 for some neighbor j of i.

The number of H-colorings of T that don't color v with a vertex of degree Δ is at most

[formula]

The number of H-colorings that color v with a vertex of degree Δ different from i is at most

[formula]

and the number of H-colorings that color v with i and w with a color different from j is at most

[formula]

Finally, the number of H-colorings that color v with i and w with j is at most

[formula]

since the degree of j is at most Δ - 1 and w is adjacent to a vertex in [formula], which can be colored with one of the at most Δ - 1 neighbors of j. Combining ([\ref=eqn-cols1]), ([\ref=eqn-cols2]), ([\ref=eqn-cols3]), and ([\ref=eqn-cols4]) we obtain

[formula]

the final inequality valid as long as n  ≥  cH.

Proof of Theorem [\ref=thm-2connected]

Here we build on the approach used in the proof of Theorem [\ref=thm-maxfortrees] to tackle the family of n-vertex 2-connected graphs C2(n).

In order to proceed, we will need a structural characterization of 2-connected graphs. In the definition below we abuse standard notation a little, by allowing the endpoints of a path to perhaps coincide.

An ear on a graph G is a path whose endpoints are vertices of G, but which otherwise is vertex-disjoint from G. An ear is an open ear if the endpoints of the path are distinct. An (open) ear decomposition of a graph G is a partition of the edge set of G into parts [formula] such that Q0 is a cycle and Qi for [formula] is an (open) ear on [formula].

A graph is 2-connected if and only if it admits an open ear decomposition.

Since removing edges from a graph does not decrease the count of H-colorings, we will assume in the proof of Theorem [\ref=thm-2connected] that we are working with a minimally 2-connected graph G, meaning that G is 2-connected and for any edge e we have that G - e is not 2-connected. A characterization of these graphs is the following, which can be found in [\cite=Dirac].

A 2-connected graph G is minimally 2-connected if and only if no cycle in G has a chord.

Let G be a minimally 2-connected graph. There is an open ear decomposition [formula] of G, and a c satisfying [formula], with the property that each of Q1 up to Qc are paths on at least four vertices, and each of Qc + 1 through [formula] are paths on three vertices with endpoints in [formula].

Let [formula] be an open ear decomposition of G. If any of the Qk, [formula], is a path on two vertices, its removal leads to an open ear decomposition of a proper spanning subgraph of G, contradicting the minimality of G. So we may assume that each of Q1 through [formula] is a path on at least three vertices. We claim that if Qi is a path on exactly three vertices, then the degree 2 vertex in Qi also has degree 2 in G; from this the corollary easily follows.

To verify the claim, let Qi be on vertices x,a and y, with a the vertex of degree 2, and suppose, for a contradiction, that there is some Qj, j  >  i, that has endpoints a and z (the latter of which may be one of x, y). In [formula] there is a cycle C containing both x and y, and in [formula] there is a path P from z to C that intersects C only once. Now consider the cycle C' that starts at a, follows Qj to z, follows P to C, follows C until it has met both x and y (meeting y second, without loss of generality), and finishes along the edge ya. The edge xa is a chord of this cycle, giving us the desired contradiction.

The next lemma follows from results that appear in [\cite=Engbers], specifically Lemma 5.3 and the proof of Corollary 5.4 of that reference.

Suppose H is not KΔ,Δ or [formula] (the complete looped graph). Then for any two vertices i, j of H and for k  ≥  4 there are at most (Δ2 - 1)Δk - 4 H-colorings of Pk that map the initial vertex of the path to i and the terminal vertex to j.

Corollary 5.4 in [\cite=Engbers] gives a bound of Δk - 2 for a smaller class of H, which is simply for convenience. The proof given actually delivers a bound of (Δ2 - 1)Δk - 4 for all H except KΔ,Δ and [formula].

We begin with the proof for a non-regular connected graph H, and then consider regular H and describe the necessary modifications needed in the proof.

Let H be non-regular and connected. We will first show that for all sufficiently large n and all minimally 2-connected graphs G that are different from K2,n - 2 we have hom (G,H)  <   hom (K2,n - 2,H), and we will then address the cases of equality when G is allowed to be not minimal. An easy lower bound on the number of H-colorings of K2,n - 2 is

[formula]

where s(H) is the number of ordered pairs (i,j) of (not necessarily distinct) vertices in V(H) with the property that [formula]. For the first inequality, consider coloring the vertices in the partition class of size 2 of K2,n - 2 with colors i and j, and for the second note that the pair (i,i), where i is any vertex of degree Δ, is counted by s(H).

Suppose that G contains a path on [formula] vertices (with [formula] as given by Lemma [\ref=lem-no_long_paths]). By first coloring this path and then iteratively coloring the remaining vertices we have (using Lemma [\ref=lem-no_long_paths]) hom (G,H)  <  Δk - 2Δn - k  =  Δn - 2. We may therefore assume that G contains no path on [formula] vertices.

Consider now an open ear decomposition of G satisfying the conclusions of Corollary [\ref=cor-P3]. Since G contains no path on [formula] vertices, we have that there is some constant (independent of n) that bounds the lengths of each of the Qi, and so [formula], the number of open ears in the decomposition, satisfies [formula]. We now show that c, the number of paths in the open ear decomposition that have at least four vertices, may be taken to be at most a constant (independent of n). Coloring Q0 first, then coloring each of Q1 through Qc, and then iteratively coloring the rest of G, Lemma [\ref=lem-col_paths] yields

[formula]

(noting that [formula]). Unless c is a constant, this quantity falls below the trivial lower bound on hom (K2,n - 2,H) for all sufficiently large n.

Now since there are only constantly many vertices in the graph G' with open ear decomposition [formula], and G is obtained by adding the remaining vertices to G', each joined to exactly two vertices of G', it follows by the pigeonhole principle that for some constant c' there is a pair of vertices w1, w2 in G with at least c'n common neighbors, all among the middle vertices of the Qi for i  ≥  c + 1. (Notice that this makes G "close" to K2,n - 2 in the same sense that in the proof of Theorem [\ref=thm-maxfortrees] a tree with a vertex of degree Ω(n) was "close" to K1,n - 1.)

We count the number of H-colorings of G by first considering those in which w1 is colored i and w2 is colored j, for some pair i,j∈V(H) with [formula]. There are at most

[formula]

such H-colorings. Next, we count the number of H-colorings of G in which w1 is colored i and w2 is colored j, for some pair i,j∈V(H) with [formula]. We argue that in G' (the graph with open ear decomposition [formula]) there must be a path P on at least 4 vertices with endpoints w1 and w2. To see this observation, since G  ≠  K2,n - 2 there must be some vertex v∈G' so that v  ≠  w1, v  ≠  w2, and [formula]. Choose a cycle in G' containing v and w1, and find a path from w2 to that cycle (the path will be trivial if w2 is on the cycle). From this structure we find such a path P, and it must have at least 4 vertices as [formula].

Coloring G by first coloring w1 and w2, then the vertices of P, and finally the rest of the graph, we find by Lemma [\ref=lem-col_paths] that the number of H-colorings of G in which w1 is colored i and w2 is colored j, for some pair i,j∈V(H) with [formula] is at most

[formula]

Combining ([\ref=small-common-nhood]) and ([\ref=large-common-nhood]) we have

[formula]

with the strict inequality valid for all sufficiently large n.

We have shown that for non-regular connected H, K2,n - 2 is the unique minimally 2-connected n-vertex graph maximizing the number of H-colorings. We now complete the proof of Theorem [\ref=thm-2connected] for non-regular connected H by showing that if G is an n-vertex 2-connected graph that is not minimally 2-connected then hom (G,H)  <   hom (K2,n - 2,H). Suppose for the sake of contradiction that hom (G,H)  =   hom (K2,n - 2,H). Since deleting edges from G cannot decrease the count of H-colorings, the uniqueness of K2,n - 2 among minimally 2-connected graphs shows that K2,n - 2 is the only minimally 2-connected graph that is a subgraph of G, and in particular we may assume that G is obtained from K2,n - 2 by adding a single edge, necessarily inside one partition class of K2,n - 2. Since K2,n - 2 is a subgraph of G, all H-colorings of G are H-colorings of K2,n - 2.

Suppose that i and j are distinct adjacent vertices of H. The H-coloring of K2,n - 2 that maps one partition class to i and the other to j must also be an H-coloring of G, which implies that both i and j must be looped. By similar reasoning, if i and j are adjacent in H, and also j and k, then i and k must be adjacent. It follows that H is a disjoint union of fully looped complete graphs, and so if connected must be a single complete looped graph (and therefore is regular), which is a contradiction.

Now we turn to regular connected H satisfying s(H)  ≥  2Δ2 + 1 (if H is loopless and bipartite) or s(H)  ≥  Δ2 + 1 (otherwise). For these H, Lemma [\ref=lem-no_long_paths] does not apply. We will argue, however, that there is still an [formula] such that if 2-connected n-vertex G has an open ear decomposition in which any of the added paths Qi, i  ≥  1, has at least [formula] vertices then G has fewer H-colorings than K2,n - 2. Once we have established this, the proof proceeds exactly as in the non-regular case.

We begin by establishing that G has no long cycles; we will use the easy fact that the number of H-colorings of a k-cycle is the sum of the kth powers of the eigenvalues of the adjacency matrix of H. By the Perron-Frobenius theorem there is exactly one eigenvalue of the adjacency matrix of H equal to Δ, and a second one equal to -  Δ if and only if H is loopless and bipartite, with the remaining eigenvalues having absolute value strictly less than Δ. It follows that the number of H-colorings of a k-cycle is, for large enough k, less than [formula] (if H is loopless and bipartite) or [formula] (otherwise). If G has such a cycle then by coloring the cycle first and then coloring the remaining vertices sequentially, bounding the number of options for the color of each vertex by Δ, we get that the number of H-colorings of G falls below the trivial lower bound on  hom(K2,n - 2,H) of s(H)Δn - 2.

Now if a 2-connected G has an open ear decomposition with an added path Qi, i  ≥  1, on at least [formula] vertices, then it has a cycle of length at least [formula], since the endpoints of Qi are joined by a path in [formula].

Proof of Theorem [\ref=thm-2conn-cycles]

In this section we show that for all q  ≥  3 and n  ≥  3, among n-vertex 2-edge-connected graphs, and therefore among the subfamily of n-vertex 2-connected graphs, the cycle Cn uniquely (up to one small exception) admits the greatest number of proper q-colorings (that is, Kq-colorings). The result is trivial for n = 3 and easily verified directly for n = 4, so throughout we assume n  ≥  5.

We will use the following characterization of 2-edge-connected graphs, due to Robbins (see Section [\ref=sec-2connected] for the definition of ear decomposition).

A graph is 2-edge-connected if and only if it admits an ear decomposition.

Notice that we are trying to show that Cn, which is the unique graph constructed with a trivial ear decomposition Q0 = Cn, maximizes hom (G,Kq). To do this, we aim to show that almost any time a 2-edge-connected graph contains a cycle and a path that meets the cycle only at the endpoints (which is what results after the first added ear in an ear decomposition for G  ≠  Cn), we can produce an upper bound on hom (G,Kq) which is smaller than hom (Cn,Kq); we will then deal with the exceptional cases by hand. The proof will initially consider an arbitrary fixed cycle and a path joined to that cycle at its endpoints in G (but independent of a particular ear decomposition of G), and will begin by producing an upper bound on hom (G,Kq) based on the lengths of the path and cycle. Let G  ≠  Cn be an n-vertex 2-edge-connected graph, and let C be a non-Hamiltonian cycle in G of length [formula]. Since [formula] and G is 2-edge-connected, there is a path P on at least 3 vertices that meets C only at its endpoints. Suppose first that P contains m + 2 vertices, where m  ≥  2 (so there are m vertices on P outside of the vertices of C). Color G by first coloring C, then P, and then the rest of the graph. Using [formula] and Lemma [\ref=lem-col_paths], we have

[formula]

Since the last inequality is strict for [formula] and the second-to-last inequality is strict for all odd [formula], the chain of inequalities is strict for all [formula]. In other words, if G contains any cycle C and a path P on at least 4 vertices that meets C only at its endpoints, then hom (G,Kq)  <   hom (Cn,Kq).

Suppose next that all the paths on at least three vertices that meet C only at their endpoints have exactly three vertices. If [formula], or if [formula] and there is such a path that joins two adjacent vertices of the cycle, then using just the vertices and edges of C and one such path P we can easily find a new cycle C' and a path P' on at least four vertices that only meets C' at it endpoints, and so hom (G,Kq)  <   hom (Cn,Kq) as before.

It remains to find an upper bound for those 2-edge-connected graphs (apart from Cn) that do not have any of the following:

a cycle of any length with a path on at least 4 vertices that only meets the cycle at its endpoints;

a cycle of length at least 5 and a path on 3 vertices that only meets the cycle at its endpoints; or

a cycle of length 4 with a path of length 3 that only meets the cycle at its endpoints, and those endpoints are two adjacent vertices of the cycle.

Recall that we are assuming n  ≥  5. For the remaining graphs, notice that if Q0 is a cycle of length 3, then [formula], where Q1 is a path on three vertices (by (a) above), must contain a cycle of length 4. In fact, in this case this cycle will use vertices from both Q0 and Q1. Therefore, we need not separately analyze the situation where C is a cycle of length 3 among the remaining graphs. In particular, this means that there is one final case to consider: C has length [formula], and P is a path on 3 vertices that only meets C at its endpoints, and the endpoints of P are non-adjacent vertices of C. In this case, C and P form a copy of K2,3, and we color this copy of K2,3 first and then the rest of G. This gives

[formula]

For n  ≥  6, some algebra shows that the right-hand side above is strictly less than hom (Cn,Kq), and also for n = 5 and q  >  3. For n = 5 and q = 3 we have equality, and so in this case hom (G,K3)  ≤   hom (C5,K3) with equality only if G has the same number of proper 3-colorings as K2,3 and has K2,3 as a subgraph; this can only happen if G = K2,3 (using a similar argument as the one given in the proof of the cases of equality for Theorem [\ref=thm-2connected]).

Concluding Remarks

In this section, we highlight a few questions related to the work in this article.

Which graphs H have the property that the path on n vertices is the tree that minimizes the number of H-colorings?

Since the star maximizes the number of H-colorings among trees, it is natural to repeat the maximization question among trees with some prescribed bound on the maximum degree. Some results (for strongly biregular H) are obtained in [\cite=Ray].

For a fixed non-regular H and positive integer Δ, which tree on n vertices with maximum degree Δ has the most H-colorings?

There are still open questions about regular H in the family of 2-connected graphs. In particular, we have seen that K2,n - 2 and Cn are 2-connected graphs that have the most H-colorings for some H.

What are the necessary and sufficient conditions on H so that K2,n - 2 is the unique 2-connected graph that has the most H-colorings?

Are Cn and K2,n - 2 the only 2-connected graphs that uniquely maximize the number of H-colorings for some H?

Finally, it would be natural to try to extend these results to k-connected graphs and to k-edge-connected graphs (note that some results for graphs with fixed minimum degree δ, with Kδ,n - δ being the graph with the most H-colorings in this family, can be found in [\cite=Engbers]).

Let H be fixed. Which k-connected graph has the most H-colorings? Which k-edge-connected graph has the most number of H-colorings?