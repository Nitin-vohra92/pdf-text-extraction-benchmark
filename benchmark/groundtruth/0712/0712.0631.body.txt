0cm 0cm 16.7cm Lemma Corollary Proposition Definition Remark

Overpartitions and class numbers of binary quadratic forms

Introduction and statement of results

In this paper we relate overpartition analogues of Ramanujan's mock theta function f(q) to the generating function for Hurwitz class numbers H(n) of binary quadratic forms of discriminant - n. The generating function for H(n) is the holomorphic part of the Zagier-Eisenstein series F(z) [\cite=HZ] [\cite=Za1], where

[formula]

Here and throughout q = e2πiz and z = x + iy. The series F(z) transforms like a weight [formula] modular form on Γ0(4), but it is non-holomorphic. It is the original example of a class of functions now called weak Maass forms [\cite=Br-Fu1] (see Section [\ref=ProofSection] for the their definition).

Building on an idea of Zwegers [\cite=Zw], the first author and Ono [\cite=Br-On1] [\cite=Br-On2] have recently constructed infinite families of weak Maass forms arising from the generating function for Dyson's rank. Recall that Dyson [\cite=Dy] defined the rank of a partition to be the largest part minus the number of parts. A special case of the results in [\cite=Br-On1] says that Ramanujan's mock theta function which counts the number partitions with even rank minus the number of partitions with odd rank, is the holomorphic part of a weight [formula] weak Maass form.

Viewing this function in the framework of weak Maass forms has led to many applications, including an exact formula for the coefficients of f(q) [\cite=Br-On1], asymptotics for the number of partitions of n with fixed rank m [\cite=Br], and identities of for rank differences [\cite=BOR]. For example, in [\cite=Br-On1] the first author and Ono proved an exact formula for α(n) conjectured by Andrews and Dragonette [\cite=An] [\cite=Dr],

[formula]

Here A2k(n) denotes a Kloosterman-type sum and [formula] is the usual Bessel function of order [formula].

In this paper we consider two analogues of Ramanujan's mock theta function f(q) in the setting of overpartitions. For the coefficients of these two series we give exact formulas which are of a completely different nature than ([\ref=conj]). Namely, we will exhibit formulas in terms of the Hurwitz class number H(n).

Recall that an overpartition of n is a partition in which the first occurrence of a number may be overlined. For example, the 14 overpartitions of 4 are

4, [formula], 3 + 1, [formula], [formula], [formula], 2 + 2, [formula], 2 + 1 + 1, [formula], [formula], [formula], 1 + 1 + 1 + 1, [formula].

Next recall the M2-rank, which was introduced by the second author [\cite=Lo2] based on the work in [\cite=Be-Ga1]. To define it, we use the notation [formula] to denote the largest part of an object, n(  ·  ) to denote the number of parts, and λo for the subpartition of an overpartition consisting of the odd non-overlined parts. Then the M2-rank of an overpartition λ is

[formula]

where χ(λ)  =  1 if the largest part of λ is odd and non-overlined and χ(λ)  =  0 otherwise. For example, the M2-rank of the overpartition [formula] is 3 - 6 + 3 - 1  =   - 1.

Now let [formula] (resp. [formula], M2e(n), M2o(n)) denote the number of overpartitions of n with even rank (resp. odd rank, even M2-rank, odd M2-rank). For instance we have [formula], [formula], M2e(4)  =  6, and M2o(4)  =  8. We shall be concerned with the rank differences

[formula]

whose generating functions are

[formula]

In [\cite=Br-Lo1] the authors showed that [formula] is the holomorphic part of a weak Maass form of weight [formula] (note the different weight from the partition case). Similar arguments will be used to show that [formula] is also the holomorphic part of a weight [formula] weak Maass form. Then we shall see that the non-holomorphic parts of [formula] and [formula] essentially match that of F(z). It turns out that the modular forms resulting from cancelling these non-holomorphic parts can also be written in terms of H(n), yielding exact formulas for [formula] and [formula].

We use H(q) to denote the generating function for the Hurwitz class numbers (i.e. the holomorphic part of F(z)): Moreover we let [formula] be the classical theta function.

We have

Now to express the coefficients [formula] and [formula] in terms of class numbers, we recall that Gauss proved that if we define r(n) by

[formula]

then we have

[formula]

The following formulas are then immediate:

We have

[formula]

[formula]

Five remarks.

1) Theorem [\ref=main] further emphasizes the role that rank differences play in linking partitions to automorphic forms which are not classical modular forms. In addition to the mock theta function f(q) described earlier, we recall that the generating function for the number of partitions into distinct parts with even rank minus the number of partitions into distinct parts with odd rank gives rise to a Maass waveform [\cite=An-Dy-Hi1] [\cite=Co1].

2) The method of proof yielding exact formulas for [formula] and [formula] is completely different from the one used in [\cite=Br-On1] to obtain ([\ref=conj]). In [\cite=Br-On1] the authors use Maass Poincaré series whereas here we employ relations between non-holomorphic parts of weak Maass forms.

3) The above equations imply that [formula] and [formula] only grow polynomially (like nk where 1 / 2 - ε  <  k  <  1 / 2 + ε, to be precise), whereas the coefficients α(n) grow exponentially.

4) One obvious application of [\eqref=formula1eq] and [\eqref=formula2eq] is to use facts about class numbers to learn about rank differences. From a combinatorial perspective, there are many surprising consequences. Even before appealing to the vast knowledge about class numbers, there are immediate relations, such as

[formula]

which seem rather unlikely given the disparate definitions of Dyson's rank and the M2-rank.

5) It would be interesting to see whether combinatorial properties of overpartitions could be employed to obtain information about class numbers. Is there some natural involution on overpartitions which changes the parity of the rank (or M2-rank) but which is not defined on a subset whose size clearly corresponds to class numbers?

In Corollaries [\ref=cor1] and [\ref=cor2] below we give a brief indication of what can be said about overpartitions by combining class number formulas with [\eqref=formula1eq] and [\eqref=formula2eq]. Corollary [\ref=cor1] contains some exact formulas at p2k and 2p2k, while Corollary [\ref=cor2] gives a couple of congruences in arithmetic progressions whose members are highly divisible by powers of 4. We state these for [formula], but of course similar statements hold for [formula], and of course these are just a few among endless possibilities.

If p is an odd prime, then we have

[formula]

[formula]

We have the following congruences:

For any a  ≥  1, if M|2a  +  2  -  3, then for all n  ≥  0 and t = 1 or 2 we have

For any a  ≥  1, if M|2a + 1 - 1, then for all n  ≥  0 we have

For example, if we take a  =  4 and t = 1 in (i) of Corollary, then we obtain

[formula]

Another application is to relate overpartition rank differences to other partition-theoretic functions which have connections to class numbers. To give one example, using work of Ono and Sze [\cite=On-Sz1] we may deduce the following:

Let C4(n) denote the number of partitions of n which are 4-cores. If 8n + 5 is square-free, then we have

[formula]

Thus all of the congruences and identities for C4(n) in [\cite=On-Sz1] apply to [formula] and M2e(8n + 5)  -  M2o(8n + 5) as well.

As a final application of Theorem [\ref=main], we use known generating functions for [formula], [formula], and class numbers to deduce q-series identities. We give four examples.

We have

[formula]

[formula]

[formula]

[formula]

One may view the first three equations above as analogous to the mock theta conjectures of Ramanujan [\cite=Hi1] in the sense that a linear combination of two non-modular functions becomes modular.

weak Maass forms and the proof of Theorem [\ref=main]

Here we prove Theorem [\ref=main]. Let us first recall the notion of a weak Maass form. If [formula], z = x + iy with [formula], then the weight k hyperbolic Laplacian is given by

[formula]

If v is odd, then define εv by

[formula]

Moreover we let χ be a Dirichlet character. A (harmonic) weak Maass form of weight k with Nebentypus χ on a subgroup Γ  ⊂  Γ0(4) is any smooth function [formula] satisfying the following:

For all [formula] and all [formula], we have

We have that Δkg = 0.

The function g(z) has at most linear exponential growth at all the cusps of Γ.

Recall that in [\cite=Br-Lo1] the authors related [formula] to a weak Maass form. To be more precise, define the function

[formula]

with

[formula]

Then the function [formula] is a weak Maass form of weight [formula] on Γ0(16). We have a similar result for the function [formula]. For this we let

[formula]

where

[formula]

We show

The function [formula] is a weak Maass form of weight [formula] on Γ0(16).

The proof is quite similar to the case of M(z) treated in [\cite=Br-Lo1], so we just give an idea of the proof here. We first note that

[formula]

where

[formula]

is the usual η function. Next define the function This function is related to [formula] via One first determines a transformation law of [formula] under inversion.

We have where

[formula]

Now let We relate I(z) to a theta integral.

We have

Differentiating Lemma [\ref=HilfsFunktion] and using Lemma [\ref=ThetaLemma] yields

We have where

It is not hard to see that N2(z) introduces the same error integral as [formula] under inversion. Now one can finish the proof as in [\cite=Br-On1].

We next turn to the proof of Theorem [\ref=main]. For this define the function We must show that [formula].

We start by showing that [formula] is a weakly holomorphic modular form on Γ0(16) with trivial Nebentypus character. For this we observe that [formula] is a weak Maass form of weight [formula] on Γ0(16) whose holomorphic part is given by [formula]. Thus [formula] is the holomorphic part of a weak Maass form. We now check that the associated weak Maass form doesn't have a non-holomorphic part. Indeed, the non-holomorphic part of [formula] is given by

[formula]

This agrees with the non-holomorphic part of - 16H(z).

We next claim that [formula] is actually a holomorphic modular form. It is known (see [\cite=DS], for example) that if the coefficients of a weakly holomorphic modular form grow at most polynomially, then it is holomorphic. To take advantage of this fact in the case of [formula], we multiply by Θ(z). Then we have

[formula]

the first term on the right hand side following from the generating function [\cite=Br-Lo1]

[formula]

Now the coefficients in this first term of [\eqref=weight2] can be expressed in terms of sum-of-divisor functions, and hence grow at most polynomially. It is well-known that the Hurwitz class numbers grow polynomially, thus so do the coefficients in the product of H(z) and Θ(z).

Hence we have that [formula] is a holomorphic modular form of weight 2 and level Γ0(16). To show that it is equal to [formula] we compute that the q-expansions agree up to q4. This then completes the proof of part (i) of Theorem [\ref=main].

The proof of part (ii) is essentially the same. There we use Theorem [\ref=MaassTheorem] to cancel the non-holomorphic parts of 2(z) and F(z), and for the polynomial growth we appeal to the generating function for the M2-rank ([\ref=M2ofq]).

Proof of the corollaries

These are simple calculations using Corollary [\ref=formula1], equation [\eqref=rofn], and the following fact [\cite=Co.5]: If - n  =  Df2 where D is a fundamental discriminant, then

[formula]

Here h(D) is the class number of [formula], w(D) is half the number of units in the ring of integers of [formula], σ1(n) is the sum of the divisors of n, and μ(n) is the Möbius function.

It is shown in [\cite=On-Sz1] that if 8n + 5 is square-free, then

[formula]

Invoking [\eqref=Cohenformula] shows that in this case [formula] is also equal to [formula], thus establishing [\eqref=cor3eq].

Kronecker [\cite=Kr1], Mordell [\cite=Mo1], and others have given nice generating functions involving certain class numbers F(n) and G(n). The definitions of these class numbers are not important here, only that H(n)  =  G(n)  -  F(n) and r(n)  =  24F(n)  -  12G(n). Thus we may recast the main theorems in terms of these class numbers,

[formula]

and

[formula]

Then, [\eqref=cor4eq1] follows from [\eqref=fofq] and Mordell's generating function for F(n) [\cite=Mo1], while [\eqref=cor4eq2] follows from [\eqref=M2ofq] and Kronecker's generating function for F(n) [\cite=Kr1]. Equations [\eqref=cor4eq3] and [\eqref=cor4eq4] follows from [\eqref=fofq] and [\eqref=M2ofq].