Corollary Lemma

COMPUTING THE COHOMOLOGICAL BRAUER GROUP OF A TORIC VARIETY

The purpose of this article is to show how one might compute the étale cohomology groups Hpét(X,Gm) in degrees p = 0, 1 and 2 of a toric variety X with coefficients in the sheaf of units. The method is to reduce the computation down to the problem of diagonalizing a matrix with integral coefficients. The procedure outlined in this article has been fully implemented by the author as a program written in the "C" programming language.

The groups that we want to compute are finitely generated abelian groups. Our method for computing them is to reduce the problem to a matrix theory computation involving matrices with integer coefficients. Let us begin with a brief description of the algorithms for matrices with integer coefficients which are to be used.

Let S be an m  ×  n matrix with integer coefficients. The basic procedure that we perform on S is "diagonalization", or equivalently, "put S into Smith normal form." This means that we find invertible matrices X and Y so that [formula] where [formula] and [formula]. Thus S has column rank s. An algorithm for computing X, Y and [formula] can be found in [\cite=CR:RTf].

Once we have computed the matrix Y we can find simultaneous bases for the column space of S and [formula]. By this we mean a set of vectors [formula] that extend to a basis for [formula] and such that a basis for the column space of S is [formula]. We simply take [formula] to be the columns of the matrix [formula] (where there are s ones) [formula]. The vectors [formula] span the smallest direct summand of [formula] that contains the column space of S. A basis for the kernel of S exists in the columns numbered [formula] of the matrix Y.

Say the columns of B contain a basis for a direct summand of rank s of [formula] and X is an invertible matrix such that [formula]. Let A be an m  ×  l matrix whose columns are in the column space of B. The matrix XA represents the function which maps the columns of A into the column space of B.

Suppose we have an m  ×  l matrix A and an n  ×  m matrix B such that BA  =  0 and we want to compute the homology group [formula]. First find a basis for the kernel of B as above. Say this basis makes up the columns of the matrix K. Find invertible matrices X and Y so that [formula]. We want to write the columns of A as linear combinations of the columns of KY. The matrix for the embedding [formula] is the [formula] matrix XA. The invariant factors of [formula] are obtained by diagonalizing this matrix.

We now discuss how to use the above algorithms to compute the cohomological Brauer group of a toric variety. Let [formula], [formula]. Let Δ denote a fan on [formula] and [formula] the corresponding toric variety over the algebraically closed field k of characteristic 0. Let K denote the function field of X. The cohomological Brauer group of X is the second étale cohomology group with coefficients in the sheaf of units, H2ét(X,Gm). According to [\cite=DFM:Cbg], if [formula] is an equivariant desingularization of X, then there is a split-exact sequence with natural maps

[formula]

Sequence ([\ref=eq1]) reduces the calculation of H2ét(X,Gm) down to the computation of the 2 smaller groups in the sequence. The relative cohomological Brauer group H2ét(K / X,Gm) consists of the 2-cocycles which are generically split. The group H2ét(,Gm) is naturally isomorphic to the image of the Brauer group of X in the Brauer group of the function field of X, [formula]. In order to compute these groups, our method allows us to also compute the zeroeth and first degree étale cohomology groups without much extra work. The divisor class group is the Picard group of a suitable open subset of X and we might as well compute it as well. The groups which we plan to compute are now enumerated.

The image of the Brauer group of X in [formula]. This group is naturally isomorphic to the Brauer group [formula] of an equivariant desingularization [formula] of X.

The divisor class group [formula].

The group of units H0ét(X,Gm).

The Picard group [formula].

The relative cohomological Brauer group, H2(K / X,Gm).

Let [formula] be the cones in Δ of dimension 1. For each ρi∈Δ(1) choose a primitive generator [formula] such that [formula].

Let [formula] be an equivariant desingularization of X. Then [formula] is the toric variety associated to a fan Δ' obtained by subdividing Δ. Any maximal cone τ∈Δ' is contained in some maximal cone σ∈Δ. For such a pair (τ,σ), the group generated by [formula] is equal to the smallest direct summand of N that contains {ρ∈Δ(1)|ρ  ⊆  σ}. Let N' be the group generated by [formula]. The invariant factors of N / N' can be computed using the methods described above. For each maximal cone σ of Δ, find a basis L(σ) for the smallest direct summand of N containing {ηi|ρi  ⊆  σ}. Set up a matrix whose columns are the elements of [formula] and compute the invariant factors of this matrix using the above mentioned methods. Say the invariants are [formula]. In order to compute group 1 above, we use [\cite=DF:Bgt] which says H2ét(,Gm) is isomorphic to [formula]. Note that [formula] according to whether |ai|  =  1,|ai|  >  1,ai  =  0.

The divisor class group of X is isomorphic to that of the toric variety associated to the fan [formula]. The class group of the latter variety is the cokernel of the function [formula]. The rows of the matrix for this function are just the transposed vectors [formula]. So the class group is determined using the methods from above.

As in [\cite=DFM:Cbg], let SF denote the sheaf of support functions on Δ, M the constant sheaf M and U the sheaf kernel defined by the sequence

[formula]

It follows from [\cite=O:Cba] that [formula] and from [\cite=DFM:Cbg] that H2ét(K / X,Gm) [formula]. Let L denote the cokernel of the morphism U  →  M in the category of presheaves. So L is a presheaf which is locally isomorphic to SF. That is, SF is the sheaf associated to L. For any cone σ∈Δ, let Δ(σ) denote the subfan of Δ consisting of σ and all of its faces. Then L(Δ(σ))  =  SF(Δ(σ)) since support funtions on a cone are linear. Therefore we see that [formula] for all p. If [formula] are the maximal cones of Δ, and σij denotes [formula], then the [formula]ech complex

[formula]

can be used to compute the groups Hp(Δ,SF)  =  Hp(Δ,L). The sequence

[formula]

is exact, so we see that L(Δ(σ)) is just the dual of the group [formula]. Given any cone σ∈Δ, we find L(Δ(σ)) as follows. First set up a matrix S whose columns consist of those ηi such that ρi∈σ. A basis L(σi) for L(Δ(σ)) is computed by methods of the introduction by finding a basis for the smallest direct summand of [formula] containing the column space of S. For this and other computations involving L(σ) it is not necessary to distinguish between N and its dual M. If τ is a face of σ, there is a projection L(Δ(σ))  →  L(Δ(τ)). The matrix for this projection corresponds to writing the elements in the basis L(τ) in terms of the basis L(σ) hence can be carried out using the above algorithms. The ingredients for writing the matrix for δ0 and δ1 are now available. Each is just a suitably interpreted direct sum of projections of the form L(Δ(σ))  →  L(Δ(τ)).

The kernel of δ0 is the group of support functions SF(Δ). As mentioned above, the Picard group is computed as [formula]. The kernel of the map M  →  SF(Δ) is U(Δ) which is just H0ét(X,Gm) / k* hence we can compute the group of units on X. Again as mentioned above, the relative Brauer group H2ét(K / X,Gm) is the first homology group [formula].