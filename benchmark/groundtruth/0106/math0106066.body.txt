The largest eigenvalue of sparse random graphs

Benny Sudakov

40pt 10pt

Proposition Lemma Corollary Conjecture Claim

Introduction

Let G = (V,E) be a graph with vertex set [formula]. The adjacency matrix of G, denoted by A = A(G), is an n-by-n 0,1-matrix whose entry Aij is one if (i,j)∈E(G), and is zero otherwise. It is immediate that A(G) is a real symmetric matrix. We thus denote by [formula] the eigenvalues of A which are usually called also the eigenvalues of the graph G itself. A family [formula] is called the spectrum of G.

Spectral techniques play an increasingly important role in modern Graph Theory. A serious effort has been invested in establishing connections between spectral characteristics of a graph and its other parameters. An interested reader can consult monographs [\cite=CveDooSac95], [\cite=Chu97] for a detailed account of known results. The ability to compute graph eigenvalues efficiently (both from theoretical and practical points of view), combined with results from spectral graph theory, has provided a basis for quite a few graph algorithms. A survey of applications of spectral techniques in Algorithmic Graph Theory by Alon can be found in [\cite=Alo98].

In this paper we study eigenvalues of random graphs. A random graph G(n,p) is a discrete probability space composed of all labeled graphs on vertices [formula], where each edge (i,j), 1  ≤  i < j  ≤  n, appears randomly and independently with probability p = p(n). Sometimes with some abuse of notation we will refer to a random graph G(n,p) as a graph on n vertices generated according to the distribution G(n,p) described above. Usually asymptotic properties of random graphs are of interest. We say that a graph property A holds almost surely, or a.s. for brevity, in G(n,p) if the probability that G(n,p) has A tends to one as the number of vertices n tends to infinity. Necessary background information on random graphs can be found at [\cite=B], [\cite=JanLucRuc00]. It is important to observe that the adjacency matrix of a random graph G(n,p) can be viewed as a random symmetric matrix, whose diagonal entries are zeroes and whose entries above the diagonal are i.i.d. random variables, each taking value 1 with probability p and value 0 with probability 1 - p. This allows to bridge between random graphs and extensively developed theory of random real symmetric matrices and their spectra (see, e.g. [\cite=Meh91]).

The subject of this paper is asymptotic behavior of the largest eigenvalue λ1(G(n,p)) of random graphs. (Notice that due to the Perron-Frobenius Theorem, for every graph G on n vertices, λ1(G)  ≥  |λi(G)| for all [formula]. Thus λ1(G) is equal to the spectral norm or the spectral radius of A(G). It is easy to observe that for every graph G = (V,E) its largest eigenvalue λ1(G) is always squeezed between the average degree of G, [formula] and its maximal degree Δ(G) =  max v∈VdG(v). As for all p(n)  ≫   log n the last two quantities are both asymptotically equal to np, it follows that in this range of edge probabilities a.s. λ1(G(n,p)) = (1 + o(1))np. In fact, much more is known for large enough values of p(n), Füredi and Komlós proved in [\cite=FurKom81] that for a constant p, λ1(G(n,p)) has asymptotically a normal distribution with expectation (n - 1)p + (1 - p) and variance 2p(1 - p).

In contrast, not much appears to be known for the case of sparse random graphs, i.e. when p(n) = O( log n). Khorunzhy and Vengerovsky [\cite=KhoVen00] and Khorunzhy [\cite=Kho01b] consider mainly the case p(n) = 1 / n and show that in this case the spectral norm of A(G(n,p)) a.s. tends to infinity with n. Moreover, it is stated in [\cite=KhoVen00] that the mathematical expectation of the number of eigenvalues that go to infinity is of order Θ(n).

Here we are to find the asymptotic value of the largest eigenvalue of sparse random graphs. To grasp better the result, observe that if Δ denotes a maximal degree of a graph G, then G contains a star SΔ and therefore [formula]. Also, as mentioned above λ1(G) is at least as large as an average degree of G. As for all values of p(n)  ≫  1 / n2, a.s. |E(G(n,p))| = (1 + o(1))(n2p / 2), we get that a.s. λ1(G(n,p))  ≥  (1 + o(1))np. Combining the above lower bounds together, we get that a.s. [formula]. As it turns out this lower bound can be matched by an upper bound of the same asymptotic value, as given by the following theorem:

As the asymptotic value of the maximal degree of G(n,p) is known for all values of p(n) (see Lemma [\ref=l21] below), the above theorem enables to estimate the asymptotic value of λ1(G(n,p)) for all relevant values of p. In particular, for the case p = c / n we get:

The rest of the paper is organized as follows. In the next section we gather necessary technical information about random graphs, used later in the proof of the main result. The main theorem, Theorem [\ref=t11], is proven in Section 3. Section 4, the last section of the paper, is devoted to concluding remarks and discussion of related open problems.

Throughout the paper we will omit systematically floor and ceiling signs for the sake of clarity of presentation. All logarithms are natural. We will frequently use the inequality [formula].

Some properties of sparse random graphs

In this section we show some properties of sparse random graphs which we will use later to prove Theorem [\ref=t11]. First we need the following definition. Let G(n,p) be a random graph. Denote

[formula]

In words, Δp is the maximal k for which the expectation of the number of vertices of degree k in G(n,p) is still at least one.

Let G = G(n,p) be a random graph. Then

(i)  The maximum degree of G almost surely satisfies Δ(G) = (1 + o(1))Δp.

(ii)  If np  →  0 then almost surely G is a forest.

(iii)  If p  ≤  e- ( log  log n)2 / n, then almost surely all connected components of G are of size at most (1 + o(1))Δp.

(iv)  If p  ≤   log 1 / 2n / n, then almost surely every vertex of G is contained in at most one cycle of length ≤  4.

Proof.  Parts (i) and (ii) are well known and can be found, e.g., in the monograph of Bollobás [\cite=B]. To show (iii) it is enough to bound from above the expectation of the number Y of trees on t = (1 + 1 /  log  log n)Δp + 1 vertices, contained in G(n,p) as subgraphs. Obviously this expectation is equal to

[formula]

On the other hand, by the definition of Δp, we have that [formula] and Δp = o( log n). Therefore, using that p  ≤  e- ( log  log n)2 / n and t > Δp, we conclude

[formula]

Now (iii) follows from Markov's inequality. Finally, the expected number of pairs of intersecting cycles of length s,t  ≤  4 in the graph G is obviously at most O(nsnt - 1ps + t)  ≤  O( log 4n / n) = o(1). This, by Markov's inequality, implies (iv). [formula]

Next we show that the set of vertices of relatively high degree in G(n,p) spans a graph with small maximum degree and with no cycles. More precisely, the following stronger statement is true.

Let p  ≥  e- ( log  log n)2 / n and let X be the set of vertices of random graph G = G(n,p) with degree larger than np(1 + 1 /  log  log n) + Δ1 / 3p. Then

(i)  Almost surely every cycle of G of length k intersects X in less than k / 2 vertices.

(ii)  Almost surely every vertex in G has less than Δ7 / 8p neighbors in X.

Proof.  First we consider the case when e- ( log  log n)2 / n  ≤  p  ≤   log 1 / 4n / n. In this case, by definition, Δp  =  Ω( log n / ( log  log n)2) and np  ≤   log 1 / 4n. To prove the lemma we first estimate the probability that all the vertices of a fixed set T of size |T| = t have degrees at least log 1 / 3n /  log  log n  <  Δ1 / 3p. It is easy to see that for such a set T, either there are at least ( log 1 / 3n /  log  log n)t / 3 edges in the cut (T,V(G) - T), or the set T spans at least ( log 1 / 3n /  log  log n)t / 3 edges of G. Since the number of edges in the cut (T,V(G) - T) is a binomially distributed random variable with parameters t(n - t) and p, we can bound the probability of the first event by

[formula]

Also, the number of edges spanned by T is a binomially distributed random variable with parameters t(t - 1) / 2 and p. We can thus bound the probability of the second event similarly by

[formula]

Therefore, the probability that all the vertices in the given set of size t have degree at least Δ1 / 3p is at most e-  Ω(t log 1 / 3n). Essentially repeating the above argument shows that conditioning on the presence of any specific set of at most 2t edges in G leaves the latter probability still at most e-  Ω(t log 1 / 3n).

Using this bound we can easily estimate the probability that there exists a cycle of length k with at least k / 2 vertices inside the set X. Clearly this probability is at most

[formula]

(First choose k vertices of a cycle and fix their order, then require that the k edges of the cycle are present in G(n,p), then choose a set T of the cycle vertices of cardinality |T| = t = ⌈k / 2⌉, and then require all vertices of T to belong to X, conditioning on the presence of the cycle edges in G(n,p).) This implies claim (i) of the lemma. Similarly, the probability that there exists a vertex with at least Δ7 / 8p neighbors in X is at most

[formula]

This completes the proof of the lemma for e- ( log  log n)2 / n  ≤  p  ≤   log 1 / 4n / n.

Next we consider the case when p  ≥   log 1 / 4n / n. We again start by estimating the probability that that all the vertices of a fixed set T of size t  ≤  n / 2 have degree at least np(1 + 1 /  log  log n). Similarly as before, for such a set T, there are at least t(n - t)p + tnp / (3 log  log n) edges in the cut (T,V(G) - T), or the set T spans at least t(t - 1)p / 2 + tnp / (3 log  log n) edges. By the standard estimates for Binomial distributions (see, e.g., [\cite=AS], Appendix A) it follows that the probability of the first event is at most e-  Ω(tnp / ( log  log n)2). The same estimates can be used to show that if n / (6 log  log n)  ≤  t  ≤  n / 2 then the probability of the second event is also bounded by e-  Ω(tnp / ( log  log n)2). On the other hand, if t  ≤  n / (6 log  log n), then this probability can be bounded directly by

[formula]

Therefore, the probability that all degrees of vertices in the given set of size t are at least np(1 + 1 /  log  log n) is at most e-  Ω(tnp / ( log  log n)2). Again, conditioning on the presence of any specific set of at most 2t edges does not change the order of the exponent in the above estimate.

Using this bound together with the fact that np  ≥   log 1 / 4n we can estimate probability that there exists a cycle of length k with at least k / 2 vertices inside set X. Clearly this probability is at most

[formula]

This implies claim (i). Similarly, the probability that there exists a vertex with at least Δ7 / 8p neighbors in X is at most

[formula]

This implies claim (ii) and completes the proof of the lemma. [formula]

Finally we need one additional lemma.

Let G = G(n,p) be a random graph with e- ( log  log n)2 / n  ≤  p  ≤   log 1 / 2n / n. Then a.s. G contains no vertex which has at least Δ1 / 3p other vertices of G with degree ≥  Δ3 / 4p within distance at most two.

Proof.  Let v be a vertex of G(n,p) and let [formula] be the vertices with degree at least Δ3 / 4p which are within distance at most two from v. Let T be the set of vertices of the smallest connected subgraph of G which contain v together with all the vertices ui. Since the shortest path form v to ui may contain only one vertex distinct from v and ui, then it is easy to see that the size of T satisfies Δ1 / 3p + 1  ≤  |T| = t  ≤  2Δ1 / 3p + 1. In addition each ui has at least [formula] neighbors outside set T. Therefore there are at least [formula] edges of G between T and V(G) - T. Since the number of edges in the cut (T,V(G) - T) is a binomially distributed random variable with parameters t(n - t) and p we can bound the probability of this event for a fixed set T of size |T| = t by

[formula]

Here we used that for p  ≥  e- ( log  log n)2 / n, by definition, Δp  ≥  Ω( log n / ( log  log n)2) and the facts that np  ≤   log 1 / 2n and t  ≤  2Δ1 / 3p + 1.

As we explained in the previous paragraph, the probability that there exists a vertex that violates the assertion of the lemma is bounded by the probability that there exists a connected subgraph on |T| = t  ≤  2Δ1 / 3p + 1 vertices such that the number of edges in the cut (T,V(G) - T) is at least [formula]. Using that for p  ≤   log 1 / 2n / n, by definition, Δp = o( log n), we can bound this probability by

[formula]

This completes the proof. [formula]

The proof of main result

In this section we prove Theorem [\ref=t11]. We start by stating some simple properties of the largest eigenvalue of a graph, that we will need later.

Let G be a graph on n vertices and m edges and with maximum degree Δ. Let λ1(G) be the largest eigenvalue of the adjacency matrix of G. Then is has the following properties.

(i)  [formula].

(ii)  If [formula] then [formula]. If in addition graphs Gi are vertex disjoint, then λ1(G) =  max iλ1(Gi).

(iii)  If G is a forest then [formula]. In particular if G is a star on Δ + 1 vertices then [formula].

(iv)  If G is a bipartite graph such that degrees on both sides of bipartition are bounded by Δ1 and Δ2 respectively, then [formula].

Proof.  Most of these easy statements can be found in Chapter 11 of the book of Lovász [\cite=L]. Here we sketch the proof of few remaining ones for the sake of completeness.

(iii)  Let A be the adjacency matrix of G and let [formula] be its eigenvalues. Since G is a forest on n vertices it is easy to see that the trace of A2 satisfies

[formula]

On the other hand λ1 =  - λn because G is bipartite. Therefore we can conclude that 2λ21  ≤  2(n - 1) and hence [formula]. For the proof of the rest of the statement (iii) see, e.g., [\cite=L].

(iv)  Let A be the adjacency matrix of G. Then by definition it is easy to see that A2 is the adjacency matrix of a multigraph with maximum degree Δ1Δ2. Therefore by (i) we have that λ1(A2) = λ21(G)  ≤  Δ1Δ2 and hence [formula]. [formula]

Having finished all the necessary preparations, we are now ready to complete the proof of our main theorem.

Proof of Theorem [\ref=t11].  We start with the easy case when the random graph is very sparse. If p  ≤  e- ( log  log n)2 / n, then by Lemma [\ref=l21] a.s. G = G(n,p) is a disjoint union of trees of size at most (1 + o(1))Δp. Therefore by claims (ii) and (iii) of Proposition [\ref=p31] we have that [formula]. On the other hand, By Lemma [\ref=l21] the maximum degree of G is almost surely at least (1 + o(1))Δp and thus claim (i) of Proposition [\ref=p31] implies that [formula]. Since the value of the edge probability satisfies np = o(1) < Δp, we obtain that [formula].

Another relatively simple case is when p  ≥   log 1 / 2n / n. Then by definition it is easy to check that [formula] and hence it is enough to prove that [formula]. To get a lower bound on the largest eigenvalue note that the standard Chernoff estimates for the binomial distributions (see, e.g., [\cite=AS] , Appendix A) imply that the number of edges in G(n,p) is a.s. (1 + o(1))n2p / 2. Therefore by claim (i) of Proposition [\ref=p31], the largest eigenvalue of G(n,p) is almost surely at least (1 + o(1))n2p / n = (1 + o(1))np.

To get an upper bound, denote by X the set of vertices of random graph G = G(n,p) with degree larger than np(1 + 1 /  log  log n) + Δ1 / 3p. Let G1 be a subgraph of G induced by the set X, let G2 be a subgraph of G induced by the set V(G) - X and finally let G3 be a bipartite subgraph of G containing all the edges between X and V(G) - X. By definition [formula] and thus by claim (ii) of Proposition [\ref=p31] we obtain that [formula]. Since the maximum degree of graph G2 is np(1 + 1 /  log  log n) + Δ1 / 3p = (1 + o(1))np, then by claim (i) of Proposition [\ref=p31] it follows that λ1(G2)  ≤  (1 + o(1))np. Also note that by our construction, any cycle in the graphs G1 or G3 should have at least half of its vertices in the set X. Therefore from Lemma [\ref=l22] we get that almost surely G1 and G3 contains no cycles. In addition, by Lemma [\ref=l21], the maximum degree of these two forests is bounded by (1 + o(1))Δp. Then using claim (iii) of Proposition [\ref=p31] we obtain that [formula]. This implies that

[formula]

Finally we treat the remaining case when e- ( log  log n)2 / n  ≤  p  ≤   log 1 / 2n / n. Similarly as before we have that a.s. the maximum degree of G = G(n,p) is (1 + o(1))Δp and the total number of edges in G is (1 + o(1))n2p / 2. Therefore claim (i) of Proposition [\ref=p31] implies that

[formula]

To handle the upper bound on λ1 we again use a partition of G into smaller subgraphs, whose largest eigenvalue is easier to estimate.

Denote by X1 the set of vertices of G with degree at least Δ3 / 4p and by X2 the set of vertices with degrees larger than np(1 + 1 /  log  log n) + Δ1 / 3p but less than Δ3 / 4p. Let [formula] and let Y1 contains all vertices of V(G) - X with at least one neighbor in X1. Finally let Y2 be the set [formula]. Note that by definition there are no edges between X1 and Y2.

We consider the following subgraphs of G. Let G1 be the subgraph of G induced by the set X. Then by Lemma [\ref=l22], G1 contains no cycles and has maximum degree at most Δ7 / 8p. Therefore by claim (iii) of Proposition [\ref=p31] we get that [formula].

Our second graph G2 consists of all edges between X2 and V(G) - X. Note that by definition, any cycle in G2 has exactly half of its vertices in X2  ⊂  X. Thus by Lemma [\ref=l22], almost surely G2 is a forest. In addition, the maximum degree in G2 is bounded by the maximal possible degree of a vertex from the set V(G) - X1, which is Δ3 / 4p. Using claim (iii) of Proposition [\ref=p31] we get that [formula].

Next consider the graph G3, induced by the set of vertices Y1. Let v∈V(G) - X be a vertex with at least Δ1 / 3p + 1 neighbors in Y1. Since by definition every neighbor of v in Y1 is also a neighbor of some vertex in X1 we obtain that there are at least Δ1 / 3p + 1 paths of length two from v to the set X1. On the other hand, by Lemma [\ref=l21], v almost surely is contained in at most one cycle of length 4. This implies that all but at most one of the endpoints of these paths in X1 are different. Therefore vertex v has at least Δ1 / 3p distinct vertices of X1 with in distance two. Now from Lemma [\ref=l23] it follows that a.s. there is no vertex with this property. Hence every vertex v∈V(G) - X has almost surely at most Δ1 / 3p neighbors in Y1. In particular the maximum degree of G3 is bounded by Δ1 / 3p, which implies that [formula].

Let G4 be the bipartite subgraph consisting of all the edges of G between Y1 and Y2. By definition, the degree of every vertex in Y1 is at most np(1 + 1 /  log  log n) + Δ1 / 3p and we already proved in the previous paragraph that the degree of every vertex from Y2 in this graph is at most Δ1 / 3p. Therefore, using claim (iv) of Proposition [\ref=p31] together with the facts that np  ≤   log 1 / 2n and [formula] we obtain

[formula]

Finally we define G5 to be the subgraph of G induced by the set Y2, and G6 to be a bipartite graph containing all the edges of G between X1 and Y1. Since there are no edges crossing from X1 to Y2 it is easy to check that [formula]. Also since the graphs G5 and G6 are vertex disjoint, then by claim (ii) of Proposition [\ref=p31] we obtain that [formula] and

[formula]

By definition, the maximum degree of G5 is bounded by (1 + o(1))np + Δ1 / 3p, which implies that λ1(G5)  ≤  (1 + o(1))np + Δ1 / 3p. Hence to finish the proof it remains to bound λ1(G6).

Consider the graph G6. Let T be the set of vertices from Y1 with degrees greater than one in G6 and let u∈X1 be a vertex with at least Δ1 / 3p + 1 neighbors in T. By definition, every neighbor of u in T has also an additional neighbor in X1, which is distinct from u. Therefore we obtain that there are at least Δ1 / 3p + 1 simple paths of length two from u to the set X1. On the other hand, by Lemma [\ref=l21], u almost surely is contained in at most one cycle of length 4. This implies that all but at most one of the endpoints of these paths in X1 are different. Therefore vertex u has at least Δ1 / 3p distinct vertices of X1 within distance two. Now from Lemma [\ref=l23] it follows that a.s. there is no vertex with this property. In addition it follows that every vertex from Y1 has degree at most Δ1 / 3p in G6. Let H be the subgraph of G6 containing all the edges from X1 to T. Then by the above discussion its maximum degree is bounded by Δ1 / 3p and therefore λ1(H)  ≤  Δ1 / 3p. On the other hand, since the degree of every vertex in Y1 - T in G6 is at most one and the graph is bipartite, we obtain that G6 - H is a union of vertex disjoint stars. The size of each star is at most the maximum degree of G. Then by claims (ii) and (iii) of Proposition [\ref=p31] we get that

[formula]

This implies the desired upper bound on λ1(G), since

[formula]

and completes the proof of the theorem. [formula]

Concluding remarks

In this paper we have found the asymptotic value of the largest eigenvalue of a random graph G(n,p), or the spectral radius of the corresponding random real symmetric matrix.

It would be quite interesting to obtain more accurate estimates on the error term in the asymptotic estimate for λ1(G(n,p)), given by Theorem [\ref=t11]. Notice that due to the recent concentration result of the first author and Vu [\cite=KriVu00], the standard deviation of λ1(G(n,p)) can be asymptotically bounded by an absolute constant, and this random variable is sharply concentrated. Our proof methods do not allow us to locate the expectation of λ1 with such degree of precision. Neither we are able to obtain a limit distribution of λ1, as has been done by Füredi and Komlós [\cite=FurKom81] for the case of a constant edge probability p. This is another attractive open question.

One can also try to determine when the largest eigenvalue of a random graph has multiplicity one and then to understand a typical structure of the first eigenvector of G(n,p). While for the case p  ≫   log n / n, where the graph G(n,p) becomes a.s. almost regular, the first eigenvector will be a.s. almost collinear to the all-1 vector, the picture becomes more complicated for smaller values of p(n). Notice that for p(n)  ≪   log n / n the graph G(n,p) is a.s. disconnected, and therefore the support of the first eigenvector will be at most as large as the size of its largest connected component.

Consider the case p = c / n, for a constant c > 0. Performing direct calculations similar to those of Section 2 of the present paper, one can show that in this case G(n,p) contains almost surely an unbounded collection of vertices of degree Δ(G)(1 - o(1)) at distance at least three from each other. Considering then the subgraph of G spanned by those vertices and their neighbors shows that a.s. G(n,p) has an unbounded number of eigenvalues λi = (1 - o(1))λ1.

Another observation for the case p = c / n is that according to Corollary [\ref=cor1] the first eigenvalue of G(n,c / n) remains asymptotically the same for all values of the constant c > 0 and appears thus to be quite insensitive to the growth of c > 0. This stays in a sharp contrast with many other properties of random graphs such as the appearance of the giant component (all components of G(n,c / n) are a.s. at most logarithmic in size for c < 1, while for c > 1 G(n,p) contains a.s. one component of a linear size and the rest are O( log n)) or planarity (G(n,c / n) is a.s. planar for c < 1 and a.s. non-planar for c > 1).

Another related problem is to investigate the spectrum of the Laplacian of a random graph G(n,p). For a graph G, the Laplacian L = L(G) is defined as L = D - A, where A is the adjacency matrix of G and D is the diagonal matrix whose diagonal entries are degrees of corresponding vertices. For any graph G, the Laplacian L(G) is easily seen to be a real symmetric matrix with non-negative eigenvalues, the smallest of them being zero. One may study the so-called spectral gap (the smallest positive eigenvalue of the Laplacian) of random graphs G(n,p) for various values of p(n).

The methods of this paper can be possibly applied to the study of the spectrum of dilute random matrices. A dilute random matrix A is defined by

[formula]

where ai,j are jointly independent random variables with zero mean and variance 1, and bi,j are also jointly independent and independent from {ai,j}, where bi,j = 1 with probability p = p(n) and bi,j = 0 with probability 1 - p. In other words, the dilute random matrix is obtained by replacing each entry of a matrix from the so-called Wigner ensemble by zero independently with probability q = 1 - p. As such, it unifies the notions of the Wigner random matrices and random graphs. Khorunzhy proved in [\cite=Kho01a] that the spectral norm of the dilute random matrix is asymptotically equal to [formula] in the case p(n)  ≫   log n / n (under some additional technical assumptions) and it asymptotically much larger than [formula] for p(n)  ≪   log n. It would be quite interesting to determine the asymptotic behavior of the spectral radius of the dilute random matrix for the case of small values of p(n).