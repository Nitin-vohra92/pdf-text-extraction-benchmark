=1 Corollary Lemma Proposition Definition Remark

Local Improvements to Reduced-Order Approximations of Optimal Control Problems Governed by Diffusion-Convection-Reaction Equation

Department of Mathematics and Institute of Applied Mathematics Middle East Technical University, 06800 Ankara, Turkey

Introduction

Optimal control problems(OCPs) governed by partial differential equations(PDEs) appear in several applications such as fluid dynamics, environmental modelling and engineering. To achieve an accurate numerical solution, a problem with a large dimension has to be solved. Even, it is resolved several times if an iterative optimization method is preferred. This increases the computational complexity. We use discontinuous Galerkin(DG) method with upwinding the convection term so that the continuity condition on the test and the trial functions are flexed, particularly along the edges of the triangles. However, the degrees of freedom is much higher than for the continuous Galerkin method. Thus, in order to solve the problem fast, we employ proper orthogonal decomposition(POD) method to derive the low-dimensional model of the problem.

POD is an efficient tool to produce an optimal basis from the numerical solution of the problem at discrete time steps. The POD basis, as opposed to the finite element method, contains information about the dominant characteristics of the problem. The accuracy of the reduced solution depends on how much information about the full-order solution is contained in this basis. More accurate solutions can be found by increasing the number of POD basis functions. However, this increases the computational cost. Therefore, the basis dimension is decided by balancing the accuracy and the number of the truncated POD basis. Specifically, the most energetic POD modes are chosen by measuring the ratio between the eigenvalues of the retained POD basis and the sum of the whole eigenvalues.

In the literature, there are several studies concerning the reduced-order modelling. An overview of model reduction techniques for fluid dynamics problems can be found in the following report [\cite=TLassila_AManzoni_AQuarteroni_2013a]. However, POD reduced-order modelling of the OCPs governed by diffusion-convection-reaction equation is rare, especially in 2D. For example, a finite horizon OCP for one-dimensional advection-diffusion equation is solved by choosing the time steps adaptively in [\cite=AAlla_MFalcone_2013a]. In [\cite=KKunisch_SVolkwein_1999a], the reduced-order solution for the OCP governed by Burgers' equation is investigated. Optimality system-POD method is proposed in order to eliminate the effect of the reference control, which might be different from the optimal control, to the state in [\cite=KKunisch_SVolkwein_2008a]. The choice of the time steps from which POD basis is computed can be decided in such a way that the error between the POD solution and its corresponding trajectory is minimized [\cite=KKunisch_SVolkwein_2010a]. On the other hand, POD is applied to reacting flows with an adaptive strategy to capture the local dynamics of the chemical process in [\cite=MSinger_HWGreen_2009a] in order to reduce the computational cost. In [\cite=MLi_PDChristofidess_2008a], optimal control of diffusion-convection-reaction process is concerned by applying two different spatial discretization techniques to compute the POD basis. In the presence of control or state constraints, a posteriori error estimation is employed to measure the difference between the suboptimal control computed using the POD basis and the optimal control and then the number of POD basis is decided [\cite=FTroeltzsch_SVolkwein_2009a] [\cite=AStudinger_SVolkwein_2013a] [\cite=GMartin_SVolkwein_2014a].

The POD basis which is generated via the snapshot ensemble depending on a set of parameters may not give accurate results when it is used to approximate the problem depending on a different set of parameters. For an accurate reduced solution of the perturbed problem, the POD basis must be regenerated for each parameter, which is costly. In this paper, motivated by the studies [\cite=AHay_JTBorggaard_PDominique_2009a] [\cite=AHay_JTBorggaard_IAkhtar_2010a] [\cite=AHay_AImran_JTBorggaard_2012a], we include the sensitivity information to enrich the low-dimensional subspace by extrapolating and expanding the POD basis in case of perturbation of the diffusion term. This idea requires the solution of the sensitivity equations which can be obtained by applying continuous sensitivity equations(CSEs) method or finite difference(FD) approximation. Because CSEs are always linear, the former method is especially preferable for nonlinear problems. The latter one requires the computation of the full problem at least one more time, so it is expensive for nonlinear case. Apart from the sensitivity analysis method, we use the subspace angle interpolation method(SAIM), which is applied to fluid-structure interaction problems in [\cite=FVetrano_LCGarrec_2011a], to increase the robustness. We construct the snapshot matrix using the state solution, the adjoint solution or a combination of them [\cite=MHinze_SVolkwein_2008a]. We compare these different bases in terms of accuracy and complexity by measuring the error and the computational time and investigate the advantages and main drawbacks of them.

The rest of the paper is organized as follows: In Sect.[\ref=ocp], we introduce the OCP governed by diffusion-convection-reaction equation without control constraints. In Sect.[\ref=prob_disct], the symmetric interior penalty Galerkin method is explained and the fully-discrete optimality system is derived. The POD method and the reduced-order optimality system follow in Sect.[\ref=pod]. In Sect.[\ref=pod_basis], the derivation of different POD bases using the sensitivity analysis and SAIM are explained. We present the numerical results in Sect.[\ref=numerical]. Then, the paper ends with the conclusion.

The Optimal Control Problem

In this paper, we are interested in the following distributed optimal control problem governed by the unsteady diffusion convection reaction equation without control constraints

[formula]

subject to where Ω is a bounded open, convex domain in [formula] with a Lipschitz boundary ∂Ω and I  =  (0,T] is the time interval. [formula] are given functions and r,ε,α are given positive scalars. The velocity field [formula] does not depend on time and satisfies the incompressibility condition, i.e. [formula].

In order to write the variational formulation of the problem, we define the bilinear forms

[formula]

the state and the test space as [formula]. It is well known that the pair [formula] is the unique solution of the optimal control problem ([\ref=s1]-[\ref=s2]) if and only if there is an adjoint [formula] such that (y,u,p) satisfy the following optimality system [\cite=FTroeltzsch_2010a]

Problem Discretization

In this section, we briefly describe the symmetric interior penalty Galerkin(SIPG) method which we use for spatial discretization. Let {Th}h be a family of shape regular meshes such that [formula], [formula] for Ki,Kj∈Th, [formula]. The diameter of an element K and the length of an edge E are denoted by hK and hE, respectively. Further, the maximum value of element diameter is denoted by [formula].

We only consider discontinuous piecewise finite element spaces to define the discrete spaces of the state, adjoint, control and test functions

[formula]

Here, [formula] denotes the set of all polynomials on K∈Th of degree p. We split the set of all edges Eh into the set E0h of interior edges and the set E∂h of boundary edges so that [formula]. Let [formula] denote the unit outward normal to ∂Ω. We define the inflow boundary

[formula]

and the outflow boundary [formula]. The boundary edges are decomposed into edges [formula] that correspond to inflow boundary and edges [formula] that correspond to outflow boundary. The inflow and outflow boundaries of an element K∈Th are defined by

[formula]

where [formula] is the unit normal vector on the boundary ∂K of an element K.

Let the edge E be a common edge for two elements K and Ke. For a piecewise continuous scalar function y, there are two traces of y along E, denoted by y|E from inside K and ye|E from inside Ke. Then, the jump and average of y across the edge E are defined by:

[formula]

Similarly, for a piecewise continuous vector field [formula], the jump and average across an edge E are given by

[formula]

For a boundary edge [formula], we set [formula] and [formula] where [formula] is the outward normal unit vector on Γ.

We can now give DG discretizations of the state equation ([\ref=s2]) in space for fixed control u. The DG method proposed here is based on the upwind discretization of the convection term and on the SIPG discretization of the diffusion term [\cite=DSchotzau_LZhu_2009a]. This leads to the following (bi-)linear forms applied to yh∈H1(0,T;Yh) for [formula]

[formula]

where

[formula]

with a constant interior penalty parameter σ > 0. We choose σ to be sufficiently large, independent of the mesh size h and the diffusion coefficient ε to ensure the stability of the DG discretization as described in [\cite=BRiviere_2008a] with a lower bound depending only on the polynomial degree.

Let fh,ydh and y0h be approximations of the source function f, the desired state function yd and initial condition y0, respectively. The functions (yh,uh)∈H1(0,T;Yh)  ×  L2(0,T;Uh) solve the semi-discrete OCP if and only if (yh,uh,ph)∈H1(0,T;Yh)  ×  L2(0,T;Uh)  ×  H1(0,T;Yh) is a unique solution of the following optimality system: For details, we refer the reader to the study [\cite=TAkman_HYucel_BKarasozen2013a] where a priori error estimates for SIPG discretization combined with backward Euler is provided and the quadratic convergence rate in space is achieved. For time-discretization, we use Crank-Nicolson method, which is known to be stable and second order convergent.

Let [formula] be a subdivison of I with time intervals Im  =  (tm - 1,tm] and time steps k  =  tm  -  tm - 1 for [formula]. Then, the fully discrete optimality system for ([\ref=s7]) is written as follows:

Proper Orthogonal Decomposition

In this section, we briefly explain the POD method following [\cite=SVolkwein_2008a] and its generalization to Galerkin type spatial discretization [\cite=MFahl_2000a]. Let the DG approximation to the function w(x,ti) at t = ti be expressed as where φj(x) denotes the discontinuous finite element functions with x∈Ω. Let the matrix W be a real-valued M  ×  N matrix containing the DG coefficients DGj(ti) on its i-th column. We assume that the snapshots are linearly independent so that W has full-column rank. On the other hand, the POD approximation is written as where ψj(x) denotes the POD basis functions. The aim is to find the function ψj(x) representing the snapshot ensemble wDGi as well as possible, which is equivalent to the following minimization problem [\cite=KKunisch_SVolkwein_1999a] where [formula] with the finite element mass matrix M.

The POD basis is computed using the singular value decomposition(SVD), because it is more stable than the eigenvalue decomposition, i.e. the singular values decay to machine precision, whereas the eigenvalues stagnate above [\cite=AStudinger_SVolkwein_2013a]. The Cholesky decomposition of the symmetric positive definite mass matrix M ~  =  ~ M1 / 2 ~ (M1 / 2)T is required. Then, we obtain the data matrix W̃  ~   =  ~ M1 / 2W and whose SVD is written as W̃  ~   =  ~ UΣVT. Firstly, coefficients of the POD basis, namely Ψ, are computed by solving the linear system

[formula]

with the first l columns of U. Then, l-many POD basis functions are expressed as a linear combination of the finite element basis functions φi(x) as follows

[formula]

The dimension of the POD basis must be several order lower than the dimension of the full-order space from which we obtain the snapshots of the problem. The number of POD basis functions l is decided according to the ratio between the modelled and the total energy,

[formula]

where σi's denote the singular values of the data matrix W̃ and d = (W̃).

After deriving the POD basis, low-dimensional optimality system corresponding to ([\ref=OD_ocp_theta]) is derived by applying Galerkin projection. In addition, the initial condition y0, desired state yd and the source function f are also projected onto the low-dimensional space. Then, the reduced-order POD Galerkin modelling of the optimality system is written as follows:

[formula]

Computation of Different POD Bases

In general, the POD basis generated via the snapshots depending on a parameter μ0 cannot capture the dynamics of the perturbed problem depending on μ  =  μ0  +  Δμ. In order to eliminate this drawback of the method, motivated by the studies [\cite=AHay_JTBorggaard_PDominique_2009a] [\cite=AHay_JTBorggaard_IAkhtar_2010a] [\cite=AHay_AImran_JTBorggaard_2012a], POD sensitivities can be used to enrich the low-dimensional space for a wider range of parameters. We generate two new bases, i.e. extrapolated POD(ExtPOD) and expanded POD(ExpPOD). In addition to these, the subspace angle interpolation method(SAIM) [\cite=ABjork_GHGolub_1973a] can be applied, which does not require the sensitivity information. Now, we proceed with the details of the sensitivity analysis.

Proper Orthogonal Decomposition Sensitivities

The sensitivity of a term is defined as the derivative of that term with respect to a quantity of interest μ. We assume that the state, the adjoint and the control are functions depending on space, time and the quantity of interest μ,

[formula]

We define the sensitivities as

In this study, we are interested in the sensitivity with respect to the diffusion term μ  =  ε. The CSEs are obtained by differentiating the continuous state ([\ref=s2]) and the adjoint equation associated to ([\ref=s4_b]) and the optimality condition ([\ref=s4_c]) with respect to μ. The subscript μ denotes the derivative with respect to μ. The corresponding optimality system with sy,sp and su is written as follows,

[formula]

We note that the homogeneous Dirichlet boundary conditions are imposed to ([\ref=sens_s1]) after differentiating ([\ref=s2_b]) in the same way. The optimality system ([\ref=sens_s1]) is discretized using the same numerical method, i.e. SIPG in space and Crank-Nicolson time, as for ([\ref=s4]).

The sensitivity equations are always linear, so CSE method would be especially promising for nonlinear problems. On the other hand, FD approximation can also be used to find the sensitivities. It requires the evaluation of the OCP depending on the perturbed parameters. In particular, the sensitivity of the state can be computed via the centred difference

[formula]

The increment Δμ is chosen sufficiently small for an accurate FD approximation and it is chosen sufficiently large for the difference between two nearby POD vectors to be larger than the discretization error by one order of magnitude [\cite=AHay_JTBorggaard_PDominique_2009a].

After finding the sensitivities of the state and the adjoint, the POD sensitivities are obtained. To do so, we treat each POD mode as a function of both space and the parameter, i.e. ψ  =  ψ(x,μ). Then, we differentiate the relation ([\ref=pod_Psi1]) with respect to μ and solve the resulting equation for Ψμ. We proceed with the relation ([\ref=Psi1]) to derive the POD basis sensitivities ψμ

The computation of Ulμ, which appears after differentiating ([\ref=pod_Psi1]) with respect to μ, is realised through the relation

The term W̃μ denotes the sensitivity of the snapshot matrix, which is obtained by solving ([\ref=sens_s1]) using CSE method or FD approximation. For the computation of Vlμ and [formula], we consider the eigenvalue problem BVl  =  Vlλl with the lth column of V. After differentiation, one obtains the relation

[formula]

The orthonormal matrix Vl has already been computed via SVD. Then, the eigenvalue sensitivities are given by Each term of [formula] is computed due to the relation between the singular values σμ and the eigenvalues λμ, i.e. σ2μ  =  λμ.

The equation ([\ref=VBV]) is solved in the least-squares sense and we denote one particular solution by sl. The general solution to ([\ref=VBV]) is expressed as sl  +  γVl for [formula] with a simple λl. In addition, we differentiate the normalization condition Vl(Vl)T =  ~ 1 leading to Vlμ(Vl)T = 0. Then, the sensitivity of Vl and γ are determined by For details, we refer the reader to [\cite=AHay_JTBorggaard_PDominique_2009a].

In ExtPOD, the POD basis depending on μ is written using the first-order Taylors expansion as follows The reduced-order solution is expressed as

In ExpPOD, the POD basis sensitivities are also added to the original POD basis as follows

[formula]

and the reduced-order solution is written as where the dimension of the reduced basis is doubled.

The Subspace Angle Interpolation Method

In this section, we explain the method following [\cite=ABjork_GHGolub_1973a] and [\cite=FVetrano_LCGarrec_2011a]. Let Ψ1 and Ψ2 be the coefficients of two POD bases spanning two subspaces associated to two different parameters μ1 and μ2. We derive SVD of their product, which is given by (Ψ1)TΨ2  =  ŨΣ̃ṽT. For a decreasing sequence of the singular values of Σ̃, i.e. [formula], the principal angles and the principal vectors associated to those subspaces are given by

Then, the coefficients of the new basis are constructed as in [\cite=FVetrano_LCGarrec_2011a] for any parameter μ1  <  μN  <  μ2 through the linearly interpolated principle angle

The coefficients of the new basis are written as where u:,j,v:,j are the columns of U and V. We note that this method only requires the coefficients of two precomputed bases and it is applied if only one parameter is perturbed in the system.

Numerical Results

In this section, we present some numerical results to investigate the performances of the methods. The CPU times are obtained on a 3.17 GHz desktop PC. The full problem is solved with linear finite elements for Δt = 1 / 60 and Δx = 1 / 40 leading to 9600 degrees of freedom. We used the Newton-conjugate gradient method with Armijo line-search in the optimization step for fast convergence. Three different snapshot sets for W are used to generate the POD basis, namely the state Y, the adjoint P and the combination of them [formula], as in [\cite=MHinze_SVolkwein_2008a]. The sensitivities derived from CSE method are calculated at the same time steps with FD approximation and we use them in the bases generation step. The error between the benchmarked and the reduced solution is measured with respect to L2(0,T;L2(Ω)) norm.

We note that the nominal value for the diffusion term is ε = 10- 2. We generate POD basis once using the snapshots associated to this nominal/baseline value and denote the corresponding results by POD in the figures. We choose the parameter range for μ  =  ε as 1 / ε  =  80:5:120. For SAIM, two snapshot sets associated to two different parameters are required. To do so, we fix the parameters as μ1  =  1 / 125 and μ2 = 1 / 75.

We consider the optimal control problem with

[formula]

We take the source function f, the desired state yd and the initial condition y0 as

[formula]

The exact solution of this problem is not known and the convection field is not a constant vector. In Figure [\ref=EX2_F:1], we present the numerical solutions of the state on the first row and its sensitivities on the second row at the time instances t = 0.2,0.6,1 from left to right. In Figure [\ref=EX2_F:2], the numerical solution of the adjoint on the first row and its sensitivities on the second row are given at the time instances t = 0.8,0.4,0 from left to right. Due to the convection field [formula], the state rotates clockwise as t  →  T = 1, while the adjoint follows the counter-clockwise direction as t  →  t0 = 0. Since the convection field is fixed, the associated sensitivities rotate in the same direction, too. The state and the adjoint are highly sensitive where their solutions change mostly.

In Figure [\ref=EX2_F:3], we present the decay of the eigenvalues and their sensitivities. They decrease rapidly showing that POD can be successfully applied. The sensitivities are computed by CSE method and FD approximation for comparison purposes. We observe that both approaches give almost the same results. In addition, the eigenvalues decay following the same pattern as the sensitivities do which means that the ordering will remain in case of parameter perturbations [\cite=AHay_JTBorggaard_PDominique_2009a].

We present the computational time for the full-problem, CSE method and FD approximation in Table [\ref=EX2_T:1]. In total, the full-problem is solved in 30 seconds. The CSE method takes almost 2 minutes. The sensitivities are computed using FD approximation in 55 seconds, which is faster than CSE method.

The total energy E(l) in the formula ([\ref=energy]) is fixed up to 100(1 - γ)% by keeping the most energetic POD modes. In this study, we choose 9 POD basis functions setting γ = 10- 2. In Table [\ref=EX2_T:2], we compare the computational cost of the reduced problem in terms of different bases and the snapshot ensemble. For each case, the reduced problem is solved less than 5 seconds, which is faster than for the full-problem. Using the snapshot set P, the problem is solved faster than with the snapshot set Y. It is because a better approximation to the control is achieved and led to fast convergence in the optimization step. On the other hand, the size of the set [formula] is twice as large as Y or P. Therefore, it takes longer to compute the POD basis and the reduced solution. In terms of POD sensitivities, ExpPOD is slower than ExtPOD; because, its dimension is doubled. The SAIM is more costly than ExtPOD due to the additional computations to generate the new basis. We note that the speed of POD gains importance when we have to solve the full-problem several times in case of parameter perturbations.

Now, we compare the low-order solutions obtained by 3 different snapshot sets. We take the numerical solution as the benchmark. In Figure [\ref=EX2_F:4], we present the error for the state on the left column and the error for the control on the right column with respect to the diffusion term using 9 POD bases. The control approximated with the POD bases generated from the state solution is poor because the characteristics of the control are totally different from the state solution. Similarly, the error in the state approximated by the snapshots of the adjoint is higher. Thus, the choice of the snapshot ensemble affects the approximation depending on whether it contains information about the term which will be approximated or not. The best result for the control is derived with the snapshot set P and [formula]. The inclusion of the adjoint information in the POD basis generation step improves the performance of the method, because the relation between the adjoint and the control is determined through the optimality condition ([\ref=s4_c]). In addition, a good approximation to the control influences the state solution directly due to acting on the right-hand side of ([\ref=s2_a]). Therefore, the snapshot ensemble [formula] leads to the smallest error. For the state solution, the snapshot set Y and [formula] outperforms the snapshot set P. It is because the former set contains information about state and the latter offers a good approximation to the control which influences the state solution directly due to the optimality condition.

We investigate the differences of the POD bases in terms of accuracy depicted in Figure [\ref=EX2_F:4]. We observe that the baseline, ExtPOD and SAIM POD obtained from the snapshot set Y fails to predict the control in case of parameter perturbations since the error remains the same. Instead, ExpPOD improves the approximation. SAIM improves the quality of the perturbed state solution obtain from the snapshot set Y and [formula] for larger perturbations. Similar observations are also valid for the control with the snapshot set P and [formula]. For this example, the best results for both of the state and the control are achieved through the snapshot set [formula] with ExtPOD and ExpPOD. As we increase the number of POD bases, ExtPOD becomes superior.

In Figure [\ref=EX2_F:5], we present the results for negative changes in ε, particularly for ε = 1 / 80. All methods surpass the baseline POD. For the state approximation, with the snapshot set Y and [formula], ExtPOD approximates the state better than SAIM worse than ExpPOD. However, it catches the ExpPOD as we increase the number of POD bases. On the other hand, for the control, with the snapshot set P and [formula], the smallest error is achieved. While ExtPOD offers better results than SAIM, it cannot beat ExpPOD.

Conclusions

We aim to improve the robustness of the POD method by extrapolating or expanding the POD basis using the sensitivity information. In addition, we generate a new basis using SAIM, which requires the snapshots associated to two different parameters μ1 and μ2. If one does not have these snapshots, then SAIM would be expensive especially for nonlinear problems. We note that it outperforms the baseline POD for large perturbations. To derive the sensitivities, we observe that CSE method is more time consuming than FD approximation. The snapshot ensemble [formula] and ExpPOD leads to the smallest error. The error is almost equal to the one in the ExtPOD as we increase the number of POD bases, so ExtPOD becomes preferable. In a future work, we will be interested in the local improvements to the POD solution of the optimal control of Burgers' equation.