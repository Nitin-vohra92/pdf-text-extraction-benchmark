Corollary Lemma Proposition Assumption Definition Remark

Orbit and spin tracking in a radial electric field

Introduction

I tracked the orbit and spin in a model of a homogenous radial electric field [formula]. I treated only motion in the horizontal plane, and only for on-energy particles H = H0  =  γ0mc2. Hence there was no dispersion orbit: the orbital motion consisted purely of betatron oscillations around the reference radius r0. The problem was more subtle than I anticipated. My tracking output did not agree with averages I had previously calculated for various parameters. Significantly, the tracking output indicated that 〈xβ〉  ≠  0 for this model. I realized eventually that this is correct: my tracking program is reliable and was sending me a message. I calculated the value of 〈xβ / r0〉 to O(x20 / r20) using canonical transformations (see below). I then recalculated the averages for various parameters, and I then obtained excellent agreement with the tracking output.

In what follows I shall define the parameter α, the angle between the spin and the direction of the velocity (basically cos α is the helicity), and the naïve analytical expression for the average 〈dα / dθ〉. The tracking output did not agree with this expression. I shall then derive a more detailed expression for 〈xβ / r0〉, and then rederive a more accurate expression for 〈dα / dθ〉.

The fact that 〈xβ / r0〉  ≠  0 for this model is food for thought about assumptions which have been made in various statistical analyses of EDM averages.

Helicity

Use cylindrical polar coordinates (ρ,θ,z), where the arc-length along the reference orbit is s = r0θ. The electric field is radial and the field and potential are given by

[formula]

First of all we know that for this model, all circular orbits circulate with the same kinetic energy and different potential energies. We have the relation

[formula]

If [formula] (no magnetic field), the spin precession equation of motion for the helicity is given by

[formula]

We neglect vertical motion. The orbit and spin precess in the horizontal plane. We set

[formula]

Then, using [formula],

[formula]

Hence

[formula]

This is quite general. It is applicable for any value of the reference momentum. However, the case of interest to us is when the reference is at the magic momentum, given by a  =  1 / (β20γ20). Then we must expand βγ to include the off-axis motion.

Why is α relevant? I have my own personal opinion about this, but I shall postpone that to a later document.

Naïve average

The quantity of interest is the secular average 〈dα / dθ〉. For brevity define ξ = x / r0. Then using H  =  γmc2  +  Φ,

[formula]

In this note I treat only the case H  =  H0  =  γ0mc2. Note also that

[formula]

Then

[formula]

Then, using β2γ2  =  γ2 - 1,

[formula]

Then, setting a  =  1 / (β20γ20),

[formula]

Then, assuming 〈ξ〉  =  0 and 〈ξ2〉  =  (1 / 2)(x20 / r20), we obtain

[formula]

The tracking results disagreed with this significantly. The above result indicates that for [formula] (so [formula]), then 〈dα / dθ〉  →  (3 / 2)(x20 / r20). However the tracking results indicated that [formula] instead.

The tracking results also indicated that 〈ξ〉  =  O(x20 / r20)  ≠  0. I eventually realized that this is correct, and that it is the key.

Hamiltonian & canonical transformations

Henceforth I set c = 1. The Hamiltonian in cylindrical coordinates (ρ,θ,z) is

[formula]

We set pz = 0 below and treat only motion in the horizontal plane. Define p0 = mγ0β0. The potential is

[formula]

Here ρ = r0 + x and ρ0 = r0. The logarithmic potential means that all of the orbits are bounded. The equation for the classical turning radius x* is easy to write down. We set ρ  =  ρ* and pρ = 0 in eq. [\eqref=eq:hamtim]. Then, for some H = H* and ps = L / ρ0 (L is the angular momentum), the classical turning radius is the solution of the equation

[formula]

In general there are two solutions for ρ*: there is both a maximum and a minimum classical turning radius. If the maximum and minimum classical turning radii are equal then the orbit is a circle. However, when using a Taylor series and perturbation theory, I shall expand to the fourth order in ξ = x / r0. Then

[formula]

The highest power is [formula], which is negative, hence orbits can escape to infinity. This simply means the perturbation series is then not valid, and the higher order terms are not negligible. There is no infinity in the actual orbital motion.

We use the arc-length s along the reference orbit as the independent variable. Then

[formula]

Let us employ canonical transformations and diagonalize the Hamiltonian, by expanding terms in a Taylor series. Note that x always appears in the dimensionless combination x / r0, hence use ξ = x / r0. To preserve the Hamiltonian structure of the equations, we scale the independent variable to θ = s / r0:

[formula]

Next, we scale the momentum px  =  p0  pξ. To preserve the Hamiltonian structure of the equations, we divide K by p0:

[formula]

Hence we define q = K / p0. I shall treat only the case H  =  γ0m below. There is no off-energy dispersion orbit. Then x = px = 0 is a solution, viz. motion in a circle of radius r0. The orbital motion consists purely of betatron oscillations. Then

[formula]

Define κ  =  ps / p0. Note that K is invariant along an orbit, hence ps and hence κ are also invariant. Hence ps = ps0 and κ  =  κ0. Note that the value of κ must be precomputed using the initial data. We can employ the equivalent Hamiltonian

[formula]

The partial derivatives of all dynamical variables are the same using K1 and q. We work with K1 below. We expand K1 in a Taylor series in powers of ξ, up to the fourth power:

[formula]

We discard the constant term, and separate K1 into quadratic and anharmonic terms. The quadratic terms describe the motion of a particle of mass κ, with a tune [formula]. We can define action-angle variables (J,φ) for the linear dynamical motion

[formula]

Then the Hamiltonian in (linear dynamical) action-angle variables is

[formula]

We use the trigonometric identities Then the expansion in Fourier harmonics is

[formula]

We eliminate the terms in J3 / 2, all of which are nonsecular. Let the new action-angle variables be (J1,φ1). The generating function is

[formula]

The new angle variable φ1 is given by

[formula]

The old action variable J is given by

[formula]

Then we may set J≃J1 in the O(J2) terms in K. For the O(J3 / 2) terms in K, we may set φ≃φ1, which yields

[formula]

The transformed Hamiltonian is (note that νxΔJ1 cancels the terms in J3 / 21)

[formula]

From this we can deduce the leading order tuneshift

[formula]

Our real interest is in the value of 〈x〉. Now

[formula]

We want the average 〈ξ〉, which is given by the secular terms

[formula]

This expression is valid to O(x20 / r20). To this level of approximation, the initial conditions yield

[formula]

Then

[formula]

Let us also calculate 〈pξ〉 as a sanity check. Because the Hamiltonian is invariant under a change of sign pξ  →   - pξ, we must have 〈pξ〉  =  0. We obtain

[formula]

There are no secular terms so 〈pξ〉 = 0 as required.

Helicity at magic momentum

We know that

[formula]

We also know that

[formula]

We now know that to O(x20 / r20)

[formula]

Then

[formula]

The secular term is

[formula]

This matches well with the tracking output. This is good.

Figure [\ref=fig:dadtavg] displays a graph of 〈dα / dθ〉 vs. a for a model homogenous weak focusing ring with a radial electric field. The ring radius was 40 m. One particle was tracked for one million turns, with an initial value x0 = 1 mm and px0 = 0. The agreement between the tracking data and the analytical formula is excellent.

Remarks

Although eq. [\eqref=eq:dadtsec] is analytical, it was really the tracking output which pointed to this expression. Note that it was the tracking program which yielded the correct answer, and the analytical theory then caught up, to fit the tracking results. The initial theoretical analysis assumed that 〈xβ〉 = 0, and led to the naïve expression eq. [\eqref=eq:dadtnaive]. Indeed, I have assumed that 〈xβ〉 = 0 in all of my statistical averages for EDM calculations up to now. I now know that this is not so. I also know now that my tracking program is suffciently accurate and reliable to be taken seriously, if and when its output disagrees with analytical results.

Basically, the phase space orbits in an EDM ring are not exactly ellipses centered on the origin. The distortions of the phase space tori, though small, are significant enough to matter for EDM work. Note that in general it is standard practice to assume that 〈xβ〉 = 0 when calculating statistical averages. This is satisfactory in most applications. Typically, the anharmonic terms (for example due to sextupoles) are small, except in deliberate cases such as slow extraction. However, for a logarithmic potential, such as in the EDM ring, the anharmonic terms are sufficiently large that the value of 〈xβ〉 makes a significant contribution to the secular rate of change of the helicity, viz. 〈dα / dθ〉. This calls into question many assumptions which have been made about statistical averages for EDM calculations. Certainly, the statistical averages in my papers must be reexamined.

All of the work reported in this note for was on-energy particles. I did not treat an energy offset H  ≠  H0. I also did not treat models of electric fields for a different value of the field index, i.e. non-logarithmic potentials. I also did not treat vertical motion. These are all issues for future work.