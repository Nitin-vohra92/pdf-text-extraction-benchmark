Anomalous impact in reaction-diffusion models

In most systems, small perturbations induce proportionally small responses: this is the linear response regime. Critical systems are exceptions to this general rule: long-range correlations make these systems particularly fragile. A well known example of anomalously large response is the magnetic susceptibility close to the para/ferromagnetic transition. In fact, exactly at the transition, the magnetisation M is zero in the absence of an external force (the magnetic field H), but behaves when H  →  0 as M  ~  Hδ with δ  <  1 (for example δ = 1 / 3 in mean-field, see e.g. [\cite=Goldenfeld:1992]). The fact that δ  <  1 is tantamount to saying that the linear response coefficient lim H  →  0M / H diverges at criticality, indicating anomalous fragility. Conversely, the observation of a diverging linear response suggests a non-trivial underlying organisation of the system. This is partly the reason why the recently reported universal anomalous impact of small trades in financial markets has triggered a spree of activity (see e.g. [\cite=Almgren:2005] [\cite=Farmer:2011] [\cite=Toth:2011] [\cite=Iacopo:2013] and refs. therein). Market impact is not only a problem of paramount importance for finance practitioners (for whom market impact amounts to trading costs), it also relates to one of the most fundamental questions in theoretical economics: why and how do prices change? Market impact is at the core of the sophisticated mechanism through which markets absorb trading information as an input and produce prices as an output [\cite=Bouchaud:2008] [\cite=Bouchaud:2010]. The failure of such a mechanism can have dramatic consequences for society, ranging from market inefficiencies to full-fledged crashes (see e.g. [\cite=Bouchaud:2011] and refs. therein).

More precisely, by "market impact" we mean the average price change I after the sequential execution of a total volume Q of contracts (which we call meta-order). Contrary to the models customarily employed in the field of theoretical economics [\cite=Kyle:1985], in which I is traditionally assumed to be a linear function of Q, a growing consensus in the empirical literature indicates that impact follows a concave law, that is well-described by the so called "square-root" impact formula:

[formula]

where δ is an exponent in the range 0.4 - 0.7, σD and VD are the respectively the daily price fluctuations and the daily traded volume [\cite=Barra:1997] [\cite=Almgren:2005] [\cite=Moro:2009] [\cite=Toth:2011] [\cite=Iacopo:2013]. Y is a dimensionless coefficient which is found to be of order 1.

As mentioned above, the fact that δ  <  1 indicates that markets are inherently fragile: vanishingly small traded volumes are expected to have a disproportionate impact on prices. Even more surprisingly, the law appears to be universal, as it is to a large degree independent of details such as the type of contract traded, the geographical position of the market venue, the period of time in which trading takes place or the strategy used to execute the order [\cite=Toth:2011] (by universality we do not just mean the form of Eq. ([\ref=eq:sqrt_fin]) but also the value of the dimensionless coefficient Y). It appears to be extremely robust against microstructural changes; for example the rise of high-frequency trading (HFT) in the last ten years seems to have had very little effect on the validity of Eq. ([\ref=eq:sqrt_fin]). Such a universality is the main reason why one should expect simple models to be able to reproduce the square-root law. If the relevant properties of the market are included in a stylized model, the low-frequency properties of the dynamics (say, from some hours to a few days) should be correct even if the high-frequency (say, below one minute) description is inaccurate or not realistic.

In this spirit, we propose here a coarse-grained model of the market much inspired by [\cite=Bak:1997] [\cite=Tang:1999], which relies on two fundamental ingredients in order to describe market dynamics: i) participants place and update orders to buy (sell) at prices as low (high) as possible; ii) market clearing (buy orders and sell orders annihilate each other when at the same price). Therefore, we postulate, as in [\cite=Toth:2011], the existence of a latent order book (modeled as a one-dimensional grid of length L) encoding the trading intentions of the market participants: in this setting each price level x can be populated by particles of two types (B and A), representing respectively the intended orders to buy (bids) and to sell (ask). In practice, such book can be seen as a proxy for the supply and demand curves at the intra-day scale. Such point of view tacitly assumes segregation among the two particle types (i.e., supply and demand curves do not overlap), and implicitly enforces the presence of a finite spread separating the highest bid (the rightmost B particle) and the lowest ask (the leftmost A particle) through a market clearing condition.

The stochastic dynamics that we propose for the particles populating the book consists of a hopping process for both type of particles (each particle can jump either right or left with probability D per unit time) and of a reaction process mimicking the market clearing condition: particles at the same site will have a probability λ per unit time to start a reaction process (we will eventually consider the limit λ  →    +    ∞  ). The reaction process may have three different outcomes, chosen at random according to the value of two parameters p and m:

[formula]

For p = 0, this boils down to the model studied in [\cite=Bak:1997] [\cite=Tang:1999], but this setting is too restrictive as it does not allow one to introduce a bias m, which is of course a crucial ingredient to study impact. In fact, the events associated with p > 0 can be interpreted as due to the action of an additional agent, who adds to the system an extra bid particle (with probability (1 + m) / 2) or an extra ask particle (with probability (1 - m) / 2). The lack of a conservation law for the difference between the number of buy and sell particles is then explained by the imbalance introduced by such extra agent. Finally, we suppose that a flux of particles per unit time JB = JA = J (of type B and A) are inserted at the boundaries (respectively at sites 1 and L). Hence, the system lies in a non-equilibrium state due to the presence of an external particle pressure, representing the flux of orders coming from new participants, that can become interested in entering the market. The model will only make sense if the results do not depend on L, which is to a large extent arbitrary.

The model described above leads in continuous approximation to the following dynamics:

[formula]

where a(x,t) and b(x,t) are the densities of particles of type A and B, and [formula] and [formula]. In this limit the conditions at the boundary become the Neumann boundary conditions

[formula]

This model is extremely hard to solve in one dimension due to the presence of strong correlations among the particle positions [\cite=Ben-Naim:1992] [\cite=Cornell:1993]. Whereas in higher dimension (or in the small coupling regime λJ- 1 / 2D- 1 / 2  ≪  1) the mean field approximation 〈ab〉  =  〈a〉〈b〉 is quite accurate, in one dimension and in the large coupling regime λJ- 1 / 2D- 1 / 2  ≫  1 (which is relevant here), interactions are too strong for the mean-field prediction to be even qualitatively correct [\cite=Ben-Naim:1992] [\cite=Cornell:1993]. In that case, even in the simpler case p = 0, it is necessary to rely on approximate results obtained by using sophisticated renormalization group techniques [\cite=Cardy:1996] or to resort to numerical simulations [\cite=Araujo:1993] [\cite=Cornell:1995].

In our setting, the symmetric case p = 0 corresponds to the case in which the flux of the market is balanced, i.e., no meta-order is being executed. Hence, it represents the market unperturbed state, and it is then worth to underline its main features. First, we remark that in the symmetric case uA = uB, due to the conservation law for the difference of A and B particles, the combination φ  =  b  -  a follows a diffusion equation of the type ∂tφ  =  D∂2xxφ, subject to the boundary condition - D∂xφ|x = 0,L  =  J. The stationary state is immediate to compute and results in a linear density profile:

[formula]

Second, the interface of the model x*t (corresponding to the traded price) diffuses anomalously: while at large times the boundaries obviously confine the system between x = 0 and x = L, in the small time regime tD / L2  ≪  1 the interface diffuses very slowly, as the law of |x*t - x*0| is found to be compatible with ~   log t (as opposed to the case J = 0 considered in [\cite=Cardy:1996] which leads to |x*t - x*0|  ~  t1 / 4). In particular for L  →    ∞   the interface - and hence the mid-price - is sub-diffusive. Despite being at odds with empirical observations of actual financial markets, sub-diffusion of the price within the model is expected from the confining effect of the order book itself: the diffusive nature of prices in a financial market (namely, the fact that for times larger than a few trades one has |x*t - x*0|  ~  t1 / 2) is enforced by strategic interactions, a mechanism which we have chosen not to include in the present version of our model (see [\cite=Toth:2011] [\cite=Iacopo:2013] for a detailed discussion of this point).

The goal of the present discussion is to investigate the change in the interface position due to an imbalance in the order flux, i.e. the case p  ≠  0, m  ≠  0. We model such imbalance by supposing that the system, after being prepared in the symmetric stationary state at time t = 0, is subject to a sudden change of the values p and/or m controlling the imbalance parameters uA,uB until a time t = T. In that case, it is convenient to study the evolution of the linear combination ψ  =  uBb  -  uAa, which again follows a simple diffusion equation:

[formula]

with boundary conditions

[formula]

The interest in the field ψ lies in the fact that for λ  →    ∞   its zeroes coincide with the zeroes of the field φ  =  b  -  a. Hence, by identifying the average price change 〈x*t〉 with the point verifying 〈φ(〈x*t〉,t)〉  =  0, it is possible to connect the solution of Eq. ([\ref=eq:diff_psi]) with the expected position of the interface at a time t = T after the initial perturbation. The solution of Eq. ([\ref=eq:diff_psi]) subject to the boundary conditions ([\ref=eq:bound_psi]) and the initial conditions ([\ref=eq:stat_phi]) is:

[formula]

where we have defined the dimensionless variables

[formula]

An inspection of Eq. ([\ref=eq:sol_psi]) at τ = 0 reveals that the motion of the interface is due to the discontinuous shape of ψ(x,0) right after the perturbation: the smooth stationary shape of φst(x) is mapped into the piecewise linear function ψ(x,0) . Additionally, the boundary conditions for ψ are asymmetric, implying that in the modified coordinates the side pushing the interface with more pressure encounters a milder resistance on the other side in terms of particle density. The trajectory of the average mid-point 〈x*T〉  =  L(1 / 2 + y*τ) can be computed by exploiting the relation

[formula]

while the partial derivatives can be extracted from Eq. ([\ref=eq:sol_psi]), which implies:

[formula]

where Θ3(z,q) is the Jacobi theta function of the third kind. The above expressions can be used to solve Eq. ([\ref=eq:mid_point_rel]) with respect to [formula]. A small τ expansion for Θ3(πy,e- 4π2τ) leads finally to a differential equation for the trajectory y*τ, whose solution is

[formula]

where the function α(z) satisfies the transcendental equation:

[formula]

Eqs. ([\ref=eq:mid_point]) and ([\ref=eq:alpha]) are our central result: they state that the average change in the interface position grows as the square root of the rescaled time. Moreover, when putting back the original units, one finds that 〈x*T〉  -  L / 2  =  2α(DT)1 / 2, independent of L. This means that in the infinite size limit DT / L2  →    ∞   the impact is unaffected by the long size behavior of the system. Finally, in this regime Eq. ([\ref=eq:mid_point]) becomes exact, as the large L regime corresponds to the small τ limit. Numerical simulations of the model have been performed in this regime, finding perfect agreement with Eq. ([\ref=eq:mid_point]) (see Fig. [\ref=fig:impact]).

In order to relate this findings to empirical results on market impact Eq. ([\ref=eq:sqrt_fin]), we need to link the variation of the mid-price 〈x*T〉 to the executed volume Q. According to the financial interpretation suggested above, p > 0 represents the action of an additional agent which for [formula] is introducing a bias in the volume imbalance. Hence it is natural to identify such bias as the volume Q executed by the agent. Its average is equal to [formula], the average number of A particles that reached the interface minus the number of B particles that touched the reaction zone. Another quantity of interest is [formula], which is equal to the total number of particles that reacted. An accurate approximation of 〈Q〉 and 〈V〉 can be obtained by mapping Eq. ([\ref=eq:deriv_sol]) on the original coordinate system, so to integrate in time the fluxes through the interface. Exploiting again the properties of the Jacobi theta function of the third kind, one finds that

[formula]

where the functions β(z) and γ(z) are given by

[formula]

Eq. ([\ref=eq:avg_imb]) leads to an approximate estimate of the impact of the type I  =  2α(QD / βJ)1 / 2, which is in very good agreement with the simulation results shown in the inset of Fig. [\ref=fig:impact]. Eq. ([\ref=eq:gamma]) can be used to characterize the imbalance parameter z = uB / uA as a function of the participation rate of the additional agent φ  =  2Q  /  (Q  +  V), whose average is equal in mean-field approximation to

[formula]

Eqs. ([\ref=eq:beta]) and ([\ref=eq:gamma]) can also be used to associate the Y term appearing in Eq. ([\ref=eq:sqrt_fin]) with the combination Y(z)  =  α(z)β- 1 / 2(z). For small φ this is approximately equal to Y  ≈  (φ / 4π)1 / 2, at odds with empirical observations.

All the above results hold in an extremely broader context: (i) if drifts term of the type μ〈∂xa〉,μ〈∂xb〉, or if decay terms -  ν〈a〉, - ν〈b〉 are added to Eq. ([\ref=eq:dynamics]), then an extra timescale will implicitly be induced in the model. In this case Eqs. ([\ref=eq:mid_point]), ([\ref=eq:beta]) and ([\ref=eq:gamma]) will still provide a correct description of the system in regime of small times. Secondly, (ii) when changing the reaction term λuA / B  a  b to any other symmetric combination of a and b, the equation for ψ will be unaltered. This implies that by appropriately tuning the reaction term, it is possible to change the diffusion properties of the system all the way from log t to t1 / 2 without affecting the square-root impact law, Eq. ([\ref=eq:mid_point]) (see Fig. [\ref=fig:diffusion]).

In this paper, we have provided an analytically tractable implementation of the type of system proposed in [\cite=Toth:2011]: in our model market clearing indeed induces a locally linear (V-shaped) liquidity profile close to the traded price, which in turn induces a square root impact shape, as suggested by the mean-field argument in [\cite=Toth:2011]. However, it is highly non-trivial that such a mean-field argument gives the correct answer since the fluctuations in the interface position are in fact found to be much larger than the impact itself. It is therefore quite important to have a model where the "square-root" impact can be established analytically (rather than numerically, as in [\cite=Toth:2011] [\cite=Iacopo:2013]). Even though the exact predictions of our stylized model might depend on the actual choice of the reaction parameters, our results suggest that in a one-dimensional system of annihilating particles, a concave dependence of the interface position on the flux imbalance should be regarded as the rule, rather than as the exception. This confirms that very generic features (diffusion and market clearing condition) are, as surmised in [\cite=Toth:2011], sufficient to explain the anomalous reaction of prices to volume imbalances. As emphasized in [\cite=Toth:2011] and recalled in the introduction, this also means that markets are "critical", i.e. generically close to an instability since the liquidity is vanishingly small in the vicinity of the current price. Liquidity fluctuations are thus bound to play a crucial role, and we expect these fluctuations to be at the heart of the turbulent dynamics of financial markets [\cite=Lillo:2005] [\cite=Bouchaud:2011] [\cite=Toth:2011].

Acknowledgements We thank R. Benichou, J.de Lataillade, C. Deremble, J. Donier, D. Farmer, J. Gatheral, J. Kockelkoren, P. Kyle, Y. Lempérière, F. Lillo, M. Potters and H. Waelbroeck for many discussions on these issues. This research benefited from the support of the "Chair Markets in Transition", under the aegis of "Louis Bachelier Finance and Sustainable Growth" laboratory, a joint initiative of École Polytechnique, Université d'Évry Val d'Essonne and Fédération Bancaire Franaise.