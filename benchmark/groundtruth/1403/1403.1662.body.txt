Local non-equilibrium thermodynamics

Introduction

Statistical mechanics provides physical interpretations of entropy and free energy that are macro-state functions (i.e., functions defined on a domain of the phase-space points of a system, and thus inevitably non-local in character), and sets bounds on permissible processes expressed as path functions like heat and work, where a path is defined as a trajectory of macrostates of a system [\cite=callen]. As a system gets smaller, the effect of fluctuations becomes significant, yet modern theory [\cite=review] [\cite=revSears] [\cite=revSeifert] form of beautiful equalities [\cite=morris1993] [\cite=gala] [\cite=kur] [\cite=crooks99] [\cite=sasa] [\cite=kawai]. Modern theory has identified energetics [\cite=sekimoto98] and entropy production on the level of individual trajectories [\cite=seifert05], and has linked path functions to properties of macrostates [\cite=jar], as verified experimentally [\cite=hummer] [\cite=liph2001] [\cite=liph2002] [\cite=expSasa] [\cite=expColin] [\cite=ritort2012]. The relationship between classical and modern approaches is schematically drawn in Fig. [\ref=fig:fig1].

Despite these successes in non-equilibrium theories, however, still lacking is a unified framework analogous to classical thermodynamics [\cite=jarReview]. It is important to note that contrary to the classical cases, a path in the modern theory is defined as a trajectory of phase-space points of a system. In general, the modern theory has been built effectively upon quantities defined locally (i.e., functions defined at each phase-space point). For example, a local form of information theoretic Shannon entropy, so called stochastic entropy, is defined as -   ln p(x,t), where p(x,t) is the phase-space density of a microstate x of a system. Such a local form is necessary for boundary conditions of a process (a path) to recover the second law of thermodynamics over a finite time interval for small scale systems [\cite=crooks99] [\cite=seifert05]. Then we immediately encounter a serious conceptual difficulty. As a component of the second law, the entropy should be a property of an ensemble. However, it has not been clear at all how such an ensemble property as entropy could be assigned locally, or independently of a trajectory. This difficulty in the notion of locality is also closely associated with a classical view of difficulties of non-equilibrium thermodynamics; the ill-defined notion of a macrostate during dynamic evolution of a system. It is thus difficult to apply the language of equilibrium thermodynamics, most importantly the argument of counting, to non-equilibrium problems.

Without counting, for both equilibrium and non-equilibrium situations, we have no way to even imagine what entropy is. We remove this fundamental difficulty by constructing a new ensemble that is local in space and time, and is well-defined even in dynamic evolution of a system. Specifically, we count the accessible number of paths to a microstate and consider all trajectories to a microstate in non-equilibrium as an ensemble of the state. We, then, show that local entropy, similarly defined local information and local free energy are properties of the ensemble, and relate functions within the ensemble to state functions of the ensemble which have been concealed behind the integrated-out forms of previous theories.

Theoretical Framework

In this article, we consider a classical stochastic system in contact with a heat bath of temperature T. To provide some intuitive grasp, we take as a simple example a polymer chain whose one end is fixed and the other end under an external control λτ that may vary over time 0  ≤  τ  ≤  t (see the right panel of Fig. 1). We will refer to λτ as a macrostate (the state of a polymer chain) at time τ, and to the phase-space points of the polymer chain (excluding momentum variables for simplicity) as microstates. Note that, in this experiment, λτ is the only parameter controlling the macrostate of a polymer chain.

We define a forward process as one where an external control λτ is varied from λ0 to λt during 0  ≤  τ  ≤  t in a well-defined manner, and a corresponding reverse process λ'τ as [formula]. Let l be a space-time trajectory of the system's microstates (i.e., evolving polymer configurations) during a forward process. Since l fluctuates, we repeat the process λτ with appropriate initial probability density p(x,0) over all microstates x. When we consider a microstate along a path l at time τ, we will denote it as lτ. We define path-dependent work done on the system by the external control during a forward process as follows:

[formula]

where l is a trajectory, E(lτ,τ) is the energy of a microstate lτ at time τ. Path-dependent heat transferred to the system during the same process is defined as follows:

[formula]

where [formula] means either [formula] for deterministic frameworks, or a multiplication in the Stratonovich sense for stochastic frameworks. Then, for each l, by adding the heat and work during the forward conversion we have the first law of thermodynamics in the following form:

[formula]

where ΔE  =  E(lt,t) - E(l0,0).

Let Λ be the set of all space-time trajectories of a system connecting times 0 and t, and Λx be those paths that reach a phase space point x at time t from the past (see Fig. 2). There is a natural projection π from Λx onto x such that π(Λx) = x, and then each microstate x can be regarded as an ensemble with conceptual rigour. This is because π- 1(x) includes an infinite number of stochastic trajectories reaching x. This indicates that thermodynamic quantities can be defined for x.

Our results will be built upon two assumptions. Firstly, we assume that the probability of path l∈Λ is represented as [formula] for some function s. The explicit form of s depends on the type of model. For example, it would be the stochastic action with an initial condition derived by Onsager for stochastic models [\cite=onsager1], the Hamiltonian of a system [\cite=jarReview], or a bath at time 0 for deterministic frameworks [\cite=jar2000]. Based on this, we develop the following idea: Since each path may not be equally probable, we assign each path a weight of the form [formula] so that less probable paths would be less counted. Let Ω(X) be the accessible number (or the total weight) of paths in a sample space X, then, we have [formula]. In this framework, every unit path, a collection of paths of which total weight is 1, is equally probable, and the probability of a microstate (e.g., a chain configuration) x at time t would be simply the ratio of the accessible number (or the total weight) of trajectories that pass x at time t to that of all possible trajectories, i.e., Ω(Λx) / Ω(Λ). This new framework provides us with a basis for "counting" analogous to classical entropy.

Secondly, we assume microscopic reversibility [\cite=crooks99] [\cite=jar2000], proven by Jarzynski in the Hamiltonian framework [\cite=jar2000], and valid in various stochastic frameworks [\cite=review]. To state this, let us consider a forward process λτ  (0  ≤  τ  ≤  t), and a space-time trajectory l of a polymer chain from a specific configuration (microstate) l0 to another lt during t. We also consider the time reversed conjugate l' of the path l, i.e., [formula] for 0  ≤  τ  ≤  t under the reverse process λ'τ  =  λt - τ. Here, we set the initial probability density for the reversed process p'(x,0) as the final probability density for the forward process p(x,t) so that we have:

[formula]

Now, the condition for microscopic reversibility [\cite=crooks99] [\cite=jar2000] reads as follows:

[formula]

where Q is heat flowing into the system, β = 1 / kBT (kB: the Boltzmann constant), pΛ(l  |  l0) is the conditional path probability in the sample space Λ, and p'Λ(l'  |  l'0) is that for the reverse process. We note that pΛ(l  |  l0)  ≠  p'Λ(l'  |  l'0) in general.

Given the above setup, we construct "local non-equilibrium thermodynamics", where locally-defined entropy, information, and free energy are true thermodynamic potentials for each microstate, in sharp contrast with "stochastic thermodynamics", where they are trajectory-dependent.

Results

Local functions as state functions of Λx

Firstly, we prove that various local functions defined at each phase-space point x at time t are actually state functions of the newly introduced ensemble Λx. Let us consider a local form of information theoretic Shannon entropy (so called stochastic entropy) [\cite=crooks99] [\cite=seifert05]. To show that this entropy is the property of the ensemble Λx, we define a quantity for Λx:

[formula]

which we shall call information. As a reference value let φ0 be the maximally attainable value of information, i.e., φ0   =    ln Ω(Λ) (see Fig. 2a). Then, [formula] becomes [formula]. Since the argument of the logarithm is simply the ratio of the total weight of paths in Λx to that of Λ, which becomes p(x,t), σ(x,t) is identical to the local Shannon entropy. Thus, stochastic entropy σ(x,t) can be viewed as a property of the ensemble Λx as desired. Here we emphasize that the local entropy is now defined through a means of counting. We remark that φ(x,t) may be interpreted as the information on the occurrence of the microstate (i.e., the polymer configuration), entropy σ(x,t) as lost information upon specifying a particular microstate x. Thus, the sum of information φ(x,t) and entropy σ(x,t) conserves locally. Hence, any theory for information could be interpreted using entropy and vice versa, and we will select one depending on the context. In this picture, every microstate of a system carries information, and thus we will consider information gain/consumption of each microstate but not information measurement/erasure procedures formulated in terms of mutual information [\cite=lloyd1] [\cite=lloyd2] [\cite=sagawa] [\cite=sagawa2]. Now we define a free-energy-like quantity as follows:

[formula]

Note that σ(x,t)   =   kB(φ0   -   φ(x,t)). Thus, local free energy ψ(x,t) enables us to treat the information and energy of each microstate on an equal footing since ψ(x,t) is nothing but the sum of energy E(x,t) and information φ(x,t) adjusted by the reference value φ0 and scaled by kBT.

It was shown by Hummer and Szabo [\cite=hummer] that energy E(x,t) could be represented as weighted average of work functions over all paths in Λx. In detail, they derived the following relation using the Feynmann-Kac formula:

[formula]

where the bracket indicates an average over all paths in Λ, δ(x,t) is the Dirac-delta function at a microstate x and time t, and Feq(λ0) is the equilibrium free energy of a macrostate λ0. Due to the end-point conditioning by δ(x,t), only the paths in Λx among Λ contribute to the value of the left-hand side of this relation. Thus, equation ([\ref=hummer]) shows that energy E(x,t) is to be a property of the ensemble Λx. Accordingly, the local free energy ψ(x,t) is also a property of Λx as desired (see Appendix A). We note that the average of ψ(x,t) over microstates is known as the effective free energy of a macrostate, and relations between the effective free energy and relative entropy of macrostates have been investigated in [\cite=esposito2011].

Roles of local free energy ψ(x,t) within Λx

Now, we derive fundamental relations for each non-equilibrium microstate, which share their mathematical forms with those of classical and modern theories.

Firstly, we show that the newly introduced local free energy ψ(x,t) is a critical quantity in determining the non-equilibrium probability of each microstate x. As above, we explicitly calculate the ratio of the total weight of paths in Λx to that in Λ (see Appendix B). Then, from equation ([\ref=phi]) and equation ([\ref=psi]), we have the following:

[formula]

This relation shows that local free energy ψ(x,t) plays a role analogous to equilibrium free energy for non-equilibrium microstates. We stress that p(x,t) is expressed solely by (micro-)state functions (i.e., true thermodynamic potentials) of the ensemble Λx, which is independent of specific paths to realize a microstate x. Here it may be worth noting that the structure of our theory is not dependent on the resolution used for specifying a microstate (see Methods). In the literature, equation ([\ref=neq2]) appears implicitly either from definitions of path-dependent stochastic entropy and free energy, or mixed with work functions (path functions) if an ensemble is considered [\cite=crooks2000] [\cite=jar_lag2009]. For the latter, p(x,t) could be written in the above simple form as a property of the ensemble Λx only if the relation between ψ(x,t) and work functions were resolved as shown later in equation ([\ref=workpsi2]).

Secondly, we prove a local version of the Crooks relation. The original Crooks relation is a core equation that can generate various modern fluctuation theorems within Λ focusing on implementing a macrostate λt from an initial ensemble [\cite=crooks2000]. The local Crooks relation that we prove holds while implementing a single microstate, and thus it can generate various fluctuation theorems within Λx as will be shown below. Using equation ([\ref=rev]) and equation ([\ref=neq2]), we have

[formula]

where ΔE = E(lt,t) - E(l0,0), and Δψ  =  ψ(lt,t) - ψ(l0,0). Applying the first law as in equation ([\ref=1st]), we have [formula]. Now we consider path probabilities within Λx so that pΛ(l) = p(lt,t)pΛx(l) and p'Λ(l') = p'(l'0,0)p'Λx(l'). Due to equation ([\ref=prob]), we obtain the following local Crooks relation:

[formula]

This relation implies that fluctuation theorems for (realizing) a macrostate remain the same even if we focus on a single microstate. Most importantly, the local Crooks relation provides a physical interpretation for local free energy ψ(x,t). To see this, we integrate equation ([\ref=crooks]) over the ensemble Λx, giving:

[formula]

where the bracket indicates an average taken over all paths to x at time t. If we assume that p(x,0) is the Boltzmann-Gibbs distribution (then, we have ψ(x,0) = Feq(λ0) for all x (see equation ([\ref=fluct1]) below)), we may rewrite equation ([\ref=workpsi]) as follows:

[formula]

This is nothing but the local form of Jarzynski's relation, expressed for each microstate, revealing that the local free energy ψ(x,t) encodes (regulates) work contents for realizing a single microstate x from an initial ensemble. This role of ψ(x,t) is analogous to that of equilibrium free energy Feq(λt), as expected. As a corollary, we have

[formula]

which shows that average efficiency of the conversion from work to ψ is less than 100%, indicating that the second law of thermodynamics holds even within the ensemble of realizations of each microstate x. It should be noted that local ensemble Λx is critical to reveal this role of ψ(x,t): This term would otherwise be integrated out to give equilibrium free energy (see equation ([\ref=fluct1])). We remark that equation ([\ref=workpsi2]) is a highly desired generalization of Landauer's principle, which quantifies fluctuations in erasure processes [\cite=memory] [\cite=berut] (see Examples and also Discussion).

Roles of local free energy ψ(x,t) between Λxs

Finally, we prove two inter-microstate relations. The first relation explains how non-equilibrium work measurement could give equilibrium free energy. Since the accessible number of microstates, [formula], is a function of an equilibrium free energy Feq(λt) of a state λt, equation ([\ref=neq2]) implies the following link between the instant distribution for local free energy ψ and an equilibrium free energy for the corresponding macrostate:

[formula]

where the bracket indicates the average over all microstates (chain configurations). According to equation ([\ref=workpsi2]), non-equilibrium work measurement within Λx gives non-equilibrium free energy ψ(x,t). Thus if the measurement is done over all paths in Λ, it corresponds to taking the average of ψ, which gives equilibrium free energy as expressed in equation ([\ref=fluct1]). As a corollary, we have [formula]. In equilibrium, ψ(x,t)  =  Feq(λt) holds for all x due to the strict convexity of the exponential function [\cite=cover]. This condition together with equation ([\ref=neq2]) gives the Boltzmann-Gibbs distribution, and clearly characterizes the meaning of the "least biased" in an equilibrium as presented by Jaynes [\cite=jaynes]. Boltzmann assigned each microstate an equilibrium thermal quantity: The above equilibrium condition for ψ(x,t) shows that this is valid only in equilibrium.

Next, we demonstrate the critical role of local free energy ψ(x,t) in non-equilibrium relaxation. We consider a Brownian system described by the following Langevin equation, which is a minimal prototype that contains the stochasticity: [formula], where ζ is the friction constant and ξ is the fluctuating force that satisfies the fluctuation-dissipation theorem, 〈ξ(t)ξ(t')〉 = 2kBTζδ(t - t'). Then, the probability density p(x,t) of this system obeys the Fokker-Planck equation as [formula] From equation ([\ref=neq2]), the time evolution of local information φ(x,t) is described by

[formula]

where [formula] (see Appendix C). We note that this flow driven by local free energy gradient should be interpreted as information flow (not entropy flow) (see Fig. 2b). When information flows from x to x' with a loss, we may say that entropy flows with an increase to the opposite direction, x' to x, since the sum of them is conserved locally. Thus, equation ([\ref=eq:dynamics]) tells us that for regions of high work content, ψ spontaneously decreases through the exchange of local information and entropy until all available sources of energy are consumed so that driving force ψ(x,t) becomes constant for all x, i.e., E(x,t) = Tσ(x,t) for all x (up to an additive constant). In a non-equilibrium steady state, the relation [formula] should be satisfied. Here we emphasize that the above equation is a closed form partial differential equation, which is for the information content between ensembles Λx, i.e., the quantity independent of individual paths, or (micro-)state functions. This leads to essential differences from apparently similar dynamical equations, e.g., the ordinary differential evolution equation for macroscopic Shannon-entropy [\cite=peliti] and the ordinary differential equation for entropy production along stochastic paths in [\cite=seifert05].

Examples

We present two examples of non-equilibrium systems where the concept of local free energy allows elegant representation of all relevant phenomena.

In the first example, we will see that local free energy ψ(x,t) provides a new insight for understanding the cyclic behaviour of the famous Szilard engine [\cite=leff2002]. In step (1), a single particle in a box of volume V in contact with a heat bath of temperature T is in equilibrium. For analysis, we will split the phase-space of the particle into two: the left-half of the box and the right-half denoted as L and R, respectively, and use this coarse-grained phase-space (see Methods). Let β = 1 for a while for simplicity. Then, the free energy of the system is Feq =  -  ln Z, where [formula]. In step (2), a partition is inserted in the middle of the box. Before measurement, the local free energy of the left and the right would be the same, ψ(L)  =  ψ(R)  =    -   ln Z1  -   ln 2, where [formula] (see equation ([\ref=eq:cgfree])). Note that the local free energy is not different from the initial equilibrium free energy at this point, i.e., ψ(L)  =  ψ(R)  =  Feq. In step (3), we measure where the particle is, and assume that it was left without loss of generality. Then, we would have ψ(L) =  -  ln Z1. Since ψ is a true thermodynamic potential, independent of paths realizing a state L as shown in equation ([\ref=workpsi2]), we can deduce that work should be consumed upon measurement such that [formula] on average (equation ([\ref=eq:coro])). In step (4), we link a weight in accordance with the observation in step (3) and convert heat into work by the amount of ln 2. Thus, it does not violate the second law of thermodynamics.

Here we note that a similar argument also applies to Landauer's erasure process [\cite=landauer]. In detail, the first and the final stage of the erasure process are identical to step (2) and step (3) of the above example of the Szilard engine, respectively. In this case, however, step (3) is achieved not by measurement but by perfectly localizing the particle to the left irrespective of its initial position (e.g., by extracting the partition separating the two halves of the box and subsequently using a piston to shift the particle to the left side of the box). In any case, consumed work is characterized by the state function ψ(L), independently of paths to realize the state. We remark that fluctuations of work (not just average work) are exactly regulated by Δψ, as expressed in equation ([\ref=workpsi2]).

In the second example, we illustrate how our theory converts raw data collected from fluctuating degrees of freedom into a useful set of state functions as well as the important role of local free energy ψ(x,t) in non-equilibrium relaxation, both by means of Brownian dynamics simulations (see Appendix D). We consider a Brownian particle under a tilted bi-stable potential (Fig. 3e), which has a uniform distribution at time t  =  0. We repeated the in-silico experiment, counted the number of particles for each partitioned bin at each time, and calculated local information and free energy. Recall that information is the accessible number of paths to a point x. Due to the imposed initial condition of constant local information, the local free energy ψ initially has the same shape as the energy E(x,t) over all microstates (Fig. 3a). We observe that it is ψ that drives the information flow to establish local equilibrium as an intermediate step (Fig. 3b) until global equilibrium is reached (Fig. 3d). This is an illustration of an exact mechanism for non-equilibrium relaxation (as expressed by equation ([\ref=eq:dynamics])), which, to our knowledge, has not yet been achieved (see the legends of Fig. 3 and Appendix D).

Discussion

We have identified a new ensemble for each microstate, and revealed the important roles played by local free energy ψ(x,t) of the new ensemble. Most importantly, ψ(x,t) turns out to be a key quantity for generalizations of the Boltzmann-Gibbs distribution and Landauer's principle to include arbitrary fluctuations, and controls non-equilibrium relaxation. In the literature, related equations to this manuscript appear implicitly in various forms without awareness of the role of the local free energy ψ(x,t). For example, the most representative form for the generalized Boltzmann-Gibbs distribution appears in the literature [\cite=crooks2000] [\cite=jar_lag2009] as follows:

[formula]

where peq(x,t) is the Boltzmann-Gibbs distribution, ΔF  =  F(λt) - F(λ0) that is the difference between equilibrium free energy. This relation is a combined form of equations [\eqref=neq2], [\eqref=workpsi2], and a corollary of [\eqref=fluct1]. In [\cite=broeck2014], equation ([\ref=neq2]) arises simply from the definitions of path-dependent entropy and free energy without a significant relationship between ψ(x,t) and work as given in equation ([\ref=workpsi2]). In [\cite=berut], fluctuations in Landauer's principle have been investigated using equation ([\ref=hummer2]) to find Landauer's bound without awareness of the role, i.e., the exact quantification of the fluctuation, played by ψ(x,t). Very recently, symmetry-breaking energetics (e.g., for a Brownian particle that is experiencing a switching from a single-well to a double-well potential and is then confined in one well resulting in loss of ergodicity) has been investigated in [\cite=roldan2014], and it has been shown that

[formula]

where [formula] is the average work required for symmetry-breaking, ΔFi  =  Fi  -  Feq(λ0), where Fi satisfies [formula] and is called conformational free energy of the trapped region i of the phase-space, and pi is the probability of trapping in the region i. If we rewrite equation ([\ref=sym]) using the coarse-grained phase-space notation (see Methods) and equation ([\ref=eq:cgprob]), we have

[formula]

where Δψ  =  ψ(i,t)  -  Feq(λ0). This relation is identical to equation ([\ref=eq:coro]), a corollary of our main theorem, equation ([\ref=workpsi2]), indicating that local free energy ψ regulates fluctuations in symmetry-breaking energetics. Overall, these examples indicate the universal importance of local free energy ψ(x,t) in the thermodynamic expressions.

The second issue we discuss concerns structural similarity between an equilibrium macrostate and a non-equilibrium microstate equipped with the new ensemble Λx. We showed that the Boltzmann-Gibbs distribution and Jarzynski's relation, which hold for (implementing) a macrostate, can be expressed in a similar manner while implementing a non-equilibrium microstate. Moreover, local functions are well-defined state functions of the new ensemble Λx, i.e., true thermodynamic potentials that are independent of paths of realizing a (micro-)state, playing similar roles to equilibrium macrostate functions like free energy. If we pursue this direction further, we may borrow various notions from equilibrium thermodynamics. For example, we may define non-equilibrium temperature locally as dE(x,t) / dσ(x,t). In principle, this approach enables us to transfer all the techniques of equilibrium thermodynamics to analyse non-equilibrium local objects. We believe that there is significant value in investigating the usefulness of such an approach in non-equilibrium systems.

Methods

Practical definition of a microstate

Here we briefly mention a subtlety associated with the definition of a microstate by using a polymer configuration as its example. When we try to specify a configuration of a polymer chain at time t, there is always a problem of the space-time resolution that is used to distinguish different microstates. This is particularly the case for experiments and simulations. This resolution problem can be resolved by a coarse-grained partition of the phase space. Let [formula] be a partition of the phase space with K non-overlapping subsets χj. We may regard χj as a coarse-grained microstate. The information of χj is defined as follows:

[formula]

where [formula] Then, we apply the previous argument and obtain the non-equilibrium probability of χj, p(χj,t) = eφ(χj,t) - φ0. In this case, we shall define the free energy of χj as follows:

[formula]

where σ(χj,t) = kB(φ0  -  φ(χj,t)), identical to stochastic entropy, and E(χj,t) is defined such that [formula]. Then, we have

[formula]

We note two things here: Firstly, the structure of our theory is invariant under the transformation of a microstate x to a coarse-grained one χj. Secondly, when we do not divide fluctuating degrees of freedom, our theory reduces to global theorems in a natural way. For example, let a single coarse-grained microstate χ be the set of all fluctuating degrees of freedom. Then ψ(χ,t) becomes Feq(λt) from equation ([\ref=eq:cgfree]). We see immediately that equations (11)-(14) in the main text reduce to the corresponding known global relations, and equations (9) and (15) reduce to trivial identities. Similarly, it may be instructive to apply the same framework to an equilibrium situation, where a system is in a stationary state with thermal fluctuations. Even in an equilibrium situation, we can think of an initial state and a state at time t. Thus we can still define φ(x,t) and ψ(x,t). Our intuition immediately tells us that σ(x,t) and ψ(x,t) should both be independent of x and t, suggesting that their averages are standard entropy and free energy, respectively.

Experimental measurement

As an example, we consider a polymer chain (in a heat bath of temperature T) whose one end is fixed and the other end is under an external control λτ that varies over time 0  ≤  τ  ≤  t in a well-defined manner, as shown in the right panel of Fig. 1. We prepare the system initially to be sampled according to a probability density p(x,0). Let us assume that p(x,0) is the Boltzmann-Gibbs distribution for simplicity. We carry out the experiment by controlling λτ during 0  ≤  τ  ≤  t, and measure work W done on the system. If we have additional information on the final microstate, our theory converts the fluctuating details into φ and ψ (a microstate can be a coarse-grained one). We repeat the process N times, a large number. Let Nx be the number of the experiments whose final microstate is x. Here we put a number to path i reaching microstate x from i = 1 to Nx and express the work done in path i as Wi. Then, we obtain the energy of x using the following equality for Λx: as proven in [\cite=hummer]. Here Feq(λ0) is the equilibrium free energy of the initial macrostate. It is important to note that the normalization factor is N. If the summation is taken over all experiments, it reduces to the Jarzynski relation. We also proved that giving ψ(x,t). It is important that the normalization factor here is Nx. These two equalities are linked by the the relation between ψ(x,t) and Feq(λt) in equation ([\ref=fluct1]).

Acknowledgments

It is a pleasure to thank C. Hyeon and H. Park in KIAS for discussions. We are also grateful to Taiki Yanagishima for critical reading of our manuscript. L.J. was supported by the National Research Foundation of Korea Grant funded by the Korean Government (NRF-2011-013-C00008), and in part by Kwangwoon University Research Year Grant in 2011. H.T. acknowledges Grants-in-Aid for Scientific Research (S) and Specially Promoted Research from the Japan Society for the Promotion of Science (JSPS), and the Aihara Project, the FIRST program from JSPS, initiated by the Council for Science and Technology Policy (CSTP).

Appendix

A. Illustration of local ψ.

Here, we consider a Brownian particle in a box in contact with a heat bath of temperature T and block it incompletely as shown in Fig. [\ref=fig:psi]. Let ΛA be all the paths from an initial ensemble to A at time t. We define the accessible number (or the total weight) Ω(ΛA) of paths in ΛA by [formula], where g(l) is a weight of a path l such that g(l) is proportional to the probability of path l (see the main text, or Section B below). The information content φ(A,t) is defined by φ(A,t) =  ln Ω(A,t). As a reference value φ0 is defined by the logarithm of the total weight of all paths, i.e., φ0  =   ln Ω(Λ), where Λ is the set of all paths. Now, the presence of the partial wall increases the accessible number (or the total weight) Ω(ΛA) of paths to A, so does information content φ(A,t), and thus the local free energy ψ(A,t). Note that the local free energy is defined by ψ(A,t)  =  E(A,t)  -  Tσ(A,t), where E(A,t) is the energy of the microstate A at time t and σ(A,t)  =  kB(φ0  -  φ(A,t)). Similarly, ψ(B,t) would be decreased. As we will see from the main text, ψ is the work content. Thus, we could extract work from the increase of ψ(A,t) by linking a weight to the partition during non-equilibrium evolution of the particle. We also note that the thermodynamical asymmetry between A and B is due to the initial condition, indicating the importance of initial conditions in non-equilibrium [\cite=jarReview].

B. Derivation of Eq. (9).

Let Λ be the set of all possible space-time trajectories of an experiment. When we count the accessible number of paths, we assign each path a weight of the form [formula], where s(l) is such that the probability of path l is represented as [formula], so that less probable paths are to be less counted. Then, a probability of path l in a sample space X would be [formula]. It would be convenient to deal with a trajectory in a discrete approximation as a set of states xi in consecutive times ti for [formula]. Let us denote the set of trajectories that pass xk at time tk as Λ(xk,tk) for some integer k (see Fig. [\ref=fig:path]). We will calculate the ratio of the number of paths in Λ(xk,tk) to the number of all possible trajectories in Λ. Since the probability of path l is [formula], the ratio becomes [formula]. Then, the ratio would be approximated as [formula], where each sum is taken over the phase-space points at time ti, and [formula] means that we omit the sum over the phase-space points at time tk. It is important to omit that sum at time tk, otherwise the result would be 1. By the law of total probability the sum reduces to p(xk,tk).

C. Derivation of dynamic rules.

We consider the Langevin equation, which is a minimal prototype that contains an essence of stochasticity: [formula], where E(x,t) is energy of a microstate x at time t, ζ is the friction constant and ξ is the fluctuating force that satisfies the fluctuation-dissipation theorem, 〈ξ(t)ξ(t')〉 = 2kBTζδ(t - t'). The probability density p(x,t) of a system under the overdamped Langevin equation obeys the Fokker-Planck equation as

[formula]

From p(x,t) = eφ(x,t) - φ0 (see the main text or Sections A and B above), we have [formula] and [formula]. Substituting these relations into the Fokker-Planck equation, and dividing by p(x,t), we obtain the following equation:

[formula]

Here the first two terms in the right-hand side may be written as [formula], and the second two terms as [formula]. Noting that the sum in the parenthesis is just ψ(x,t) (see the main text or Section A above), we have

[formula]

where [formula] denotes the Laplacian. This is a non-linear convection-diffusion equation with a source term. It determines the dynamics of φ and ψ completely, given initial and boundary conditions, where the energetic cost of the information flow is mediated by heat with less than 100% efficiency resulting in a net loss of information, andthus a net increase of entropy.

D. Details of in-silico experiments.

We carried out in-silico experiments of the Brownian movement of a particle. We numerically solve the following overdamped Langevin equation:

[formula]

where E(x,t) is energy of a microstate x, and thermal fluctuation ξ satisfies 〈ξ(t)ξ(t')〉 = 2kBTζδ(t - t'). Here we set ζ = 1 for simplicity. Then, after discretization, we have

[formula]

where ε  =  ti + 1 - ti and r(ti) is a random number drawn from the standard normal distribution. In our simulations, we set the mobility to unity, and kBT to 2 by rescaling. We constrained the particle by setting the reflecting boundaries at x = 0 and x = L (L = 10). We used ε = 0.01. The domain is partitioned into 50 bins, and we counted the number of particles for each bin at each time to obtain the graphs of information and free energy.

Figure [\ref=figs1] shows the profiles of information and free energy when the initial condition is set to p(x,0) = δ(x - L / 4). In this case, there is no barrier in ψ(x,t) although there is an energy barrier. Thus, the local equilibrium is established quickly in the initial stage. Then the free energy ψ drives information φ to the right region until reaching the global equilibrium. During this second stage, the flow continues without breaking the established local equilibrium. Note that the profile of information evolves from the hat shape to the shape that exactly compensates the energy profile up to an additive constant.

Now we put initially the particle at the location of the global minimum of energy, i.e. p(x,0) = δ(x - 3L / 4), and Fig. [\ref=figs2] shows the profiles of information and free energy over microstates. There is no barrier in the free energy profile ψ. First, the local equilibrium is established quickly, and the flow of information φ continues towards the left region although the speed is much slower than the local equilibration process. Second, the flow of information φ continues until the global equilibrium is established without breaking the local equilibrium. In this case again, the profile of information at the equilibrium compensates exactly the energy profile up to an additive constant.