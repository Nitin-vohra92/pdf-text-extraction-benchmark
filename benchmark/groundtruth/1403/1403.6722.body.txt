Introduction

Solar eruptions are the most energetic events in our solar system, releasing large bursts of radiation as solar flares and ejecting plasma into the heliosphere as coronal mass ejections (CMEs). On the Sun, these eruptions are often associated with large-scale disturbances that propagate across the solar atmosphere at typical speeds of ≈  200 - 400 km s- 1 [\citep=Thompson:2009il] although more recently velocities of up to ~  1500 km s- 1 have also been measured [\citep=Olmedo:2012ff] [\citep=Shen:2013tw]. Initially observed by [\citet=Moses:1997qa], [\citet=Dere:1997fk] and [\citet=Thompson:1999zt] using the Extreme ultraviolet Imaging Telescope [\citep=Delaboudiniere:1995ve], these disturbances (commonly called "EIT waves") have been studied in detail for more than ≈  15 years. However, they remain a source of debate with conflicting observations of their properties leading to a myriad of theories proposed to explain the phenomenon.

Initial studies of the "EIT wave" feature interpreted it as a fast-mode magnetoacoustic wave using the theory originally proposed by [\citet=Uchida:1968gb] [\citet=Uchida:1970jl], with the disturbance initiated by the same eruption producing the associated solar flare and CME. This is consistent with observations of refraction [\citep=Veronig:2006cq] and reflection [\citep=Gopalswamy:2009kl] at coronal-hole boundaries and observed pulse properties such as pulse dispersion and dissipation [\citep=Long:2011fv] [\citep=Muhr:2011pi], although some authors have suggested alternate wave interpretations such as solitons [\citep=Wills-Davey:2007mw] or slow-mode MHD waves [\citep=Podladchikova:2010fu]. However, observations of stationary bright fronts at coronal-hole boundaries and low pulse speeds have lead to the proposal of "pseudo-wave" theories. These interpretations see the disturbance not as a true wave, but as a bright feature produced by Joule heating at the boundary between the erupting CME and the background coronal magnetic field as the CME propagates into the heliosphere [\citep=Delannee:2000bh] [\citep=Delannee:2008qf]. A third alternative, originally proposed by [\citet=Chen:2002zr], combines aspects of both the wave and pseudo-wave theories to interpret "EIT waves" as a hybrid of both. In this case, the erupting CME drives a fast-mode wave that then propagates freely, while magnetic reconnection driven by the restructuring magnetic field as the CME erupts is seen as a second, slower propagating feature. This theory was built upon in a subsequent article by [\citet=Chen:2005ys] and has been the focus of further simulations performed by [\citet=Cohen:2009ly] and [\citet=Downs:2011nx] [\citet=Downs:2012cr]. There has also been some observational evidence for a second propagating front, particularly in work by [\citet=Zhukov:2004if], [\citet=Chen:2011vn] and [\citet=Harra:2011hc]. A detailed discussion of the different proposed theories and the evidence for and against them may be found in the recent reviews by [\citet=Wills-Davey:2009qc], [\citet=Gallagher:2011oq] and [\citet=Zhukov:2011ud].

The rich variety of theories proposed to explain the "EIT wave" phenomenon can be explained by the methods typically used to study them. As relatively rare events, "EIT waves" are often studied in isolation, with single-event studies used to infer general phenomenological properties. Despite more than 15 years of analysis, this approach remains the primary technique for investigating them and can explain the level of uncertainty that still surrounds their true physical nature. However, several authors have proposed larger statistical surveys of the phenomenon, with the work of [\citet=Thompson:2009il] in particular the benchmark for statistical analysis of "EIT waves". [\citet=Thompson:2009il] manually identified 176 events observed by EIT onboard the SOlar and Heliospheric Observatory [\citep=Domingo:1995dq] spacecraft between 24 March 1997 and 24 June 1998, finding speeds ranging from ≈   50 - 700 km s- 1, with values most typically being ≈   200 - 400 km s- 1. This catalogue has since been utilised by multiple authors, with [\citet=Biesecker:2002uq] using it to show an unambiguous correlation between "EIT waves" and CMEs while more recent work by [\citet=Warmuth:2011kh] used it to show evidence for three distinct kinematic classes of "EIT waves".

A recent article by [\citet=Nitta:2013kc] can be seen as the spiritual successor to the work of [\citet=Thompson:2009il], producing a catalogue of "EIT waves" observed by the Atmospheric Imaging Assembly [\citep=Lemen:2012bs] onboard the Solar Dynamics Observatory [\citep=Pesnell:2012lh] spacecraft. In this case, 171 disturbances were manually identified between April 2010 and January 2013, with the observations used to examine the relationship between "EIT waves", solar flares and CMEs although no relationship was found between the wave speed and flare intensity or CME magnitude.

Despite their breadth and impact, the catalogues compiled by both [\citet=Thompson:2009il] and more recently [\citet=Nitta:2013kc] consist of manually identified events, with the consequence that identification is entirely user-dependent. This was noted by [\citet=Thompson:2009il], who assigned one of six quality ratings to each event as "an indicator of the observability of the wave in the data". However, the rating is entirely subjective and dependent on consistent application by the authors. This approach means that the same parameters may not necessarily be applied consistently to events identified by both catalogues, despite best efforts.

Several authors have proposed automated approaches to the identification and analysis of "EIT waves" to try to overcome these issues. The Novel EIT wave Machine Observing (NEMO) catalogue was developed by [\citet=Podladchikova:2005ye] to identify and analyse the coronal dimmings associated with "EIT waves" using data from SOHO/EIT (). This technique was successfully implemented and operated at the Solar Influences Data Analysis Centre at the Royal Observatory of Belgium from 1997 to 2010 and primarily identified coronal-dimming regions, although a strong correlation was noted between the dimming regions and the propagating "EIT wave" feature. An alternative technique using Huygens tracking was proposed by [\citet=Wills-Davey:2006ss]. This approach employs percentage base-difference [\citep=Wills-Davey:1999fc] images, with the pulse identified by finding the line of peak intensities corresponding to the peak of the Gaussian cross-section of the pulse. Once the disturbance has been identified in each image, its path of propagation is found using a reverse-engineered Huygens tracking approach. While highlighting several of the issues associated with the manual identification of "EIT waves" and attempting to rectify them, this technique has not been implemented on a larger scale to the best of the authors' knowledge.

As noted by [\citet=Aschwanden:2010fk], the sheer volume of data available from SDO/AIA has underlined the need for automated algorithms to identify and characterise events of interest to the wider solar community. The SDO Feature Finding Team [\citep=Martens:2012kl] has produced and implemented a number of automated techniques designed to identify and analyse features ranging from active regions and coronal holes to flares, coronal bright points, waves, CMEs, and filaments. In this article, we discuss the Coronal Pulse Identification and Tracking Algorithm (CorPITA), the "EIT wave" detection module for the FFT. This algorithm is designed to identify, track, and analyse "EIT waves" using the continuous data stream available from SDO/AIA. The algorithm is outlined in Section [\ref=sect:alg], before being applied to a sample data set in Section [\ref=sect:app]. The performance and caveats of the algorithm are then discussed and conclusions drawn in Section [\ref=sect:conc].

Algorithm Overview

The transient nature of coronal "EIT waves" means that CorPITA is designed to operate as a triggered algorithm, using the 211 Å passband to identify the pulse. Although "EIT waves" are easily identifiable in both the 211 and 193 Å passbands, the background emission from the solar corona is much lower in the hotter 211 Å passband, making automated identification and tracking of the pulse much easier. A source point is defined, with intensity profiles created along a series of arcs radiating from that point, which are then used to identify the propagating pulse. The pulse is tracked both spatially across the arcs and temporally along the arcs as it propagates across the Sun, with the kinematics of the pulse calculated once it can no longer be identified. There are therefore several distinct parts to the analysis, including the initial preparation, the image processing, and finally the detection and analysis of the event. These are outlined in detail in the sections below and are shown graphically in the flowchart depicted in Figure [\ref=fig:pseudo_code].

Event Preparation

CorPITA was designed to operate as a triggered rather than synoptic algorithm as a result of the random, transient nature of coronal "EIT wave" pulses. It enables calculation of the pulse kinematics, which require measuring the temporal variation of the distance of the pulse from some point. To do this, the algorithm is triggered when a solar flare erupts, allowing the location of the flare to be taken as the source from which the propagation distance of the pulse may be measured. Note that this does not imply a causal relationship between the flare and the propagating pulse, instead ensuring that events are treated in a consistent manner and allowing the uncertainty with regard to the actual source of the pulse to be determined from the initial identification of the pulse.

Once triggered, a pre-event image is identified as the image 120 seconds prior to the flare start time, with the time period chosen to minimise contamination due to the flare. This pre-event image is then taken as a base image to be used in conjunction with all subsequent images to produce percentage base-difference images that will be used to identify the pulse (see Figure [\ref=fig:wave_prof]b for an example). The percentage base-difference images are produced using,

[formula]

where It is the image intensity at time t and I0 is the pre-event image intensity. PBD images are used as they allow changes in the pulse morphology and intensity to be determined relative to a consistent background coronal intensity. This is important for measuring the true variation in pulse width and peak intensity with propagation as the reference image remains constant, unlike the case of running-difference images that use a changing reference image.

The pre-event image is used to define an area mask on the surface of the Sun bounded by two great-circles 10[formula] apart that intersect at the location of the flare (shown in red in Figure [\ref=fig:wave_prof]a). Each mask is segmented into a series of annuli of 1[formula] width on the solar surface from the source point to the solar limb. This width was chosen due to the arbitrary nature of the wave propagation; the mask annuli used to identify the pulse will by definition cross pixels at an angle, so the 1[formula] width ensures that sufficient whole pixels will be included in each annulus while negating the effects of pixel fragments at the edges. This process is repeated to achieve 360 overlapping area masks sequentially offset by 1[formula]. These masks are unique to each event and are defined once and called from memory as required for that event. This approach speeds up a repetitive process and ensures that all images are treated equally and systematically.

Image Processing

The pulse is identified using intensity profiles obtained from each area mask for each successive image. This approach allows the position, pulse width, and maximum intensity to be determined for each observation. The pulse features being detected are typically broader than 10[formula], but can exhibit spatial inhomogeneity on smaller scales. The area masks are therefore chosen to overlap to ensure that a smooth variation is found in the spatial location of the pulse.

The images are processed on an image-by-image basis, allowing for continuous data streaming and in recognition of the fact that each pulse is different and can last for a period of time that is a priori unknown. Due to variations in the image intensity, exposures affected by the onboard Automatic Exposure Control (AEC) system are ignored by CorPITA as they adversely affect the PBD image intensity used to identify features. Each image is processed using the aia_prep.pro routine available in the SolarSoftWare library and rebinned to [formula] pixels before being de-rotated to the time of the base image and then combined with the base image to create a PBD image. This rebinning speeds up the processing of the image (a requirement for near-real-time detection) while ensuring sufficient pixels and retaining a high degree of accuracy.

An intensity profile is then created for each of the 360 overlapping area masks previously described in Section [\ref=subsect:prep]. The mean intensity and corresponding standard deviation is calculated from the set of pixels contained within each mask annulus. For a given area mask, this results in a 1-dimensional mean intensity profile that varies with distance away from the source location (e.g. Figure [\ref=fig:wave_prof]c). The pulse is subsequently identified using a watershed technique and fitted using a Gaussian model [\citep=Wills-Davey:1999fc].

Three peaks in intensity are identified at this point, allowing any stationary bright features or the flare to be identified and discarded if necessary and ensuring an accurate fit to the pulse. This is shown in Figure [\ref=fig:wave_prof]c where three intensity peaks have been successfully identified and fitted by the algorithm. The peak identification for each arc uses the parameters derived for the previous profile as an initial estimate to ensure consistent results. This process is repeated for each profile and the parameters saved.

The algorithm repeats this approach for three images before beginning to look for motion (three images are used as this is the minimum number of images required to produce an average motion, smoothing out image-to-image variation). The algorithm examines the distance-time variation of the features identified for each profile using the derivative of a Savitsky-Golay filter. This determines forward motion by checking if the velocity of the identified feature is positive and lies within pre-defined limits (i.e. 1 < v < 2  000 km s- 1). These limits ensure that a significant jump in feature position (e.g. from close to the source to close to the limb in a single time-step) is not mistaken for actual forward motion. This test is reapplied as new images are processed, allowing a continuous examination of whether the identified features are exhibiting forward motion.

This process is repeated for ten minutes worth of observations, allowing a significant amount of time for the pulse to appear and begin propagating (if present). This time period was chosen as it is comparable to the typical observing cadence of the Extreme UltraViolet Imager [\citep=Wuelser:2004bd] onboard the Solar TErrestrial RElations Observatory [\citep=Kaiser:2008ij] spacecraft. If a pulse has been identified at this point moving away from the source and is still propagating, the algorithm continues operation on an image-by-image basis until continuous outward motion is no longer found.

Event Detection

Once a moving feature has been identified, tracked, and can no longer be detected, its properties are examined to determine if it is a propagating pulse or some other phenomenon (such as a moving loop or filament eruption). The variation of feature distance with time is examined for each of the three candidates identified for an area mask. The algorithm identifies the longest time period of continuous outward motion for each of the three candidates, scoring each to determine that which best corresponds to a pulse in that area mask.

The scoring system uses a number of different parameters to try and identify a propagating "EIT wave" with the parameters designed to return a percentage "quality-rating". The most important parameter (accounting for 50 % of the quality-rating score) is the number of data points corresponding to the detected pulse ([formula]) relative to the total number of images processed ([formula]). The other parameters are scored using a simple pass/fail system that awards 1 point for a pass and 0 points for a fail. The first two of these parameters examine the kinematics of the pulse, with points awarded for reasonable fit values of initial velocity ([formula]) and constant acceleration ([formula]). The final parameter examines the uncertainty in the fitted pulse position, quantified by the relative position error, defined as,

[formula]

where d is an array of pulse fit-centroid distances from the source location, σd is an array of fit uncertainties in d, and the mean is calculated over all data points in the longest period of continuous outward motion. The quality-rating scoring system then follows,

[formula]

where [formula] has a value of 1 for 1 < vfit < 2  000 km s- 1, [formula] has a value of 1 for [formula] m s- 2, and [formula] has a value of 1 for [formula].

Figure [\ref=fig:wave_dt] shows the variation in distance with time for the three candidates identified by CorPITA for the area mask shown in Figure [\ref=fig:wave_prof]. In each case, the shaded section indicates the possible pulse identified by the algorithm, with the quality rating then used to determine the optimal candidate for the "EIT wave" pulse. The top panel shows a candidate which exhibits continuous outward motion over an extended period of time with no major errors associated with the data points and reasonable estimates for the fitted kinematics. This is reflected in the quality rating score of ≈  80 %. The middle panel shows a candidate that exhibits some variation in position with time where CorPITA has identified a small section which may correspond to a pulse. However, a significant jump in distance over two data-points is apparent, producing unphysical estimates for the fitted kinematics, all of which is apparent in the small quality score. Finally, the third candidate exhibits significant variability in distance with time, and only a very small section that may correspond to a pulse is identified. This section is too small to fit kinematics and this is reflected in the low quality score.

Each candidate from each arc is scored, with the scores recorded and used to identify the presence of a pulse. If the quality score for the highest rated candidate from an arc exceeds 60 %, a positive identification is recorded for that arc. A positive pulse identification is recorded only if ten or more adjacent arcs record a score greater than 60 %. This allows highly directional pulses to be identified, but also ensures that pulses are not inaccurately identified by multiple single arcs returning anomalously high scores. A series of plots recording the behaviour and kinematic properties of the candidates identified in each arc is then produced allowing a visual confirmation if required.

Characterisation and Output

Once a pulse has been positively identified, CorPITA returns a series of outputs allowing a thorough examination of the detection. The first output illustrates the evolution of the pulse as it propagates across the Sun; this is shown in Figure [\ref=fig:wave_img]. In this case, colour indicates the temporal evolution of the pulse, with each area mask that returns a sufficiently high-quality score being plotted. This allows a rapid assessment of the temporal evolution of the pulse, as well as allowing the behaviour of the pulse as it encounters different regions of the solar atmosphere to be highlighted.

The variation in derived kinematics with time for the identified pulse are also returned for each area mask studied. As well as returning the initial velocity and constant acceleration values from a quadratic fit to the data, a bootstrapped Savitsky-Golay filter [\citep=Byrne:2013kx] is used to determine the unbiased variation in both velocity and acceleration with time (see Figure [\ref=fig:wave_kins]). It is clear that while the fit to the distance-time data shown in Figure [\ref=fig:wave_kins]a returns a single value for the initial velocity and acceleration, the Savitsky-Golay filter reveals the variation in both velocity and acceleration during propagation, with the bootstrapping approach allowing the associated errors to be well defined [\citep=Byrne:2013kx]. This approach may potentially be used to examine plasma variations in the material through which the pulse propagates [\citep=West:2011rq] [\citep=Long:2011dz] [\citep=Long:2013fu].

With a positive pulse identification, CorPITA produces an output XML file for input into the HEK, recording the source location, maximum quality score for the event, start and end time for the pulse, and the fitted kinematics and direction of the highest-rated overall candidate to have been identified. This allows a brief summary of the event and provides a simple quotable estimate for the fitted kinematics of the pulse.

Case Study Results

CorPITA was originally defined and tested using the eruption from 7 June 2011 as a sample case as it featured a spectacular filament eruption with a number of active regions and coronal holes on disk, which made identifying and tracking the propagating disturbance difficult. However, a systematic analysis of a larger data set from February 2011 is included here as a sample case study to illustrate the capabilities of the algorithm. This time period was chosen as a number of flares of varying size and magnitude were observed during that month, with NOAA AR 11158 in particular being quite active. A number of "EIT waves" were also observed, several of which have been previously studied in detail [\citep=Schrijver:2011qo] [\citep=Veronig:2011mb] [\citep=Harra:2011hc] [\citep=Olmedo:2012ff] [\citep=Long:2013fu], allowing a direct comparison of results.

A list of flares identified using the 94 Å passband of SDO/AIA by the SDO Flare Detective Algorithm [\citep=Grigis:2010tg] was used as a basis to define the location and start time of all flares during February 2011. Note that the flare location provided by the Flare Detective is the centre of the macro-pixel used to identify the flare rather than the actual position of the flare itself. This may be compared to the issues with identifying a feature of finite initial extent erupting from anywhere in an irregularly shaped active region and generally not observed until propagating through the quiet corona. The use of an initial offset distance compensates for both the macro-pixel offset and the initial uncertainty with regard to the true eruption centre of the feature but does not affect the ultimate identification or measurement of the pulse properties as it is just chosen for consistency as a point from which to measure position.

A series of 47 flares of varying magnitude were identified, including one X-class flare, seven M-class flares, 24 C-class flares and 15 flares with no measured GOES class. CorPITA was applied to each event in turn, with the data automatically downloaded as required from the Virtual Solar Observatory. Of the 47 flares identified, 17 were associated with a wave as detected by CorPITA, including the one X-class flare, five of the M-class flares, eight of the C-class flares and three with no measured GOES class. No wave signature was observed for 24 of the identified and tested flares.

The robust nature of the algorithm is illustrated by Figure [\ref=fig:non_wave], which shows an event from 8 February 2011 which had no detectable wave signature. The highest rated feature detected (shown in Figure [\ref=fig:non_wave]b - d) has a score of ≈  73 %, with 57 arcs exhibiting detected features with a score greater than 60 %. However, these arcs were randomly oriented and did not fulfil the criterion of at least ten adjacent arcs with a score greater than 60 %, with the result that the event was correctly classified as a "non-wave" event. The random nature of the detections are apparent in Figure [\ref=fig:non_wave]a, where the speckled dots indicate detections.

An example of a positive "EIT wave" detection identified by CorPITA is shown in Figure [\ref=fig:wave] for an event that erupted from NOAA AR 11158 on 13 February 2011. The large-scale nature of the pulse is immediately apparent from Figure [\ref=fig:wave]a as it propagates in almost all directions from its epicentre. In addition, the epicentre of the pulse is offset from the centre of the active region, suggesting that the initial driver in this case erupted from the edge of the active region rather than the centre. The score of the highest rated area mask for this event is ≈  87 %, only slightly higher than that shown in Figure [\ref=fig:non_wave]. However, the global nature of the feature detected in this case has been identified by the algorithm that correctly classified this event as an "EIT wave".

The capabilities of the algorithm in detecting variations in the kinematics of the pulse as it propagates with time are also apparent in Figure [\ref=fig:wave]a. Although the pulse propagates in almost all directions from the epicentre, this propagation is not uniform. This has potential implications for coronal seismology by allowing "EIT waves" to be used to study the properties of the solar corona on a systematic basis. The combination of pulse detections from CorPITA with one of either global magnetic-field extrapolations or density estimates could be used to make global estimates of the other. In addition, regions that are particularly "EIT wave" productive would potentially allow estimates of plasma properties to be made over extended periods of time (i.e., an entire disk passage).

Discussion and Conclusions

In this article we have presented a new automated algorithm for identifying, tracking and analysing "EIT waves" in data from SDO/AIA. CorPITA uses an intensity-profile technique applied to percentage base-difference images to identify the propagating pulse, tracking it for as long as possible before estimating the variation in kinematics across 360 overlapping area masks of 10[formula] width. This allows the variation of the pulse propagation across the entire Sun to be studied and analysed, providing an indication of variations in the magnetic-field strength and density of the low solar corona. The systematic, automated approach of CorPITA allows reproducible detections of an "EIT wave" following a specified series of analytical steps along with a statistically significant estimate of the pulse kinematics, providing an opportunity to determine their true physical nature across a large sample of events.

The period chosen to provide a sample output from CorPITA included two large-scale "EIT wave" events that have been previously studied. The CorPITA analysis of both of these events is shown in Figure [\ref=fig:prev_wave]. In both cases, "EIT waves" were successfully identified by the algorithm, allowing a direct comparison with the work of [\citet=Schrijver:2011qo] and [\citet=Olmedo:2012ff], who studied the 15 February 2011 event, and [\citet=Harra:2011hc], [\citet=Veronig:2011mb] and [\citet=Long:2013fu], who studied the 16 February 2011 event.

For the 15 February 2011 event (shown in Figure [\ref=fig:prev_wave]a - d), CorPITA returned an average initial velocity of [formula] km s- 1, although this varied from ≈   0 - 1 000 km s- 1 across the arcs where a pulse was detected and tracked. Figure [\ref=fig:prev_wave]a also shows the anisotropic nature of the pulse propagation, with the pulse tracked primarily across quiet regions of the solar corona and not through the different adjacent active regions. This is consistent with the work of [\citet=Olmedo:2012ff] who noted the variation in pulse velocity with direction, although the current version of CorPITA cannot detect the reflection that they observed while the transmission through coronal holes and active regions would produce a jump in pulse position that cannot currently be tracked. Despite this, CorPITA successfully identifies the pulse and the variation in its propagation through the quiet solar corona.

The 16 February 2011 event (shown in Figure [\ref=fig:prev_wave]e - h) was also successfully identified by CorPITA, with an average initial velocity of [formula] km s- 1 and fitted initial velocities varying from ≈   100 - 975 km s- 1 across the different arcs. The anisotropic nature of the pulse is again shown by Figure [\ref=fig:prev_wave]e, with the pulse in this case strongly directed towards solar North away from the erupting active region. The fitted initial velocities measured by CorPITA are in good correspondence with those measured by [\citet=Harra:2011hc], [\citet=Veronig:2011mb] and [\citet=Long:2013fu], indicating that the same pulse is identified. However, CorPITA is designed to identify the forward motion of a single propagating pulse and cannot yet identify multiple propagating pulses associated with a single event, although this may be implemented in a future iteration of the code. As a result, it does not observe the second propagating feature identified by [\citet=Harra:2011hc].

The results shown here indicate that CorPITA offers a fully automated, robust approach for identifying, tracking and analysing "EIT waves". This will allow a systematically reproducible analysis of the entire SDO/AIA data-set as well as a near-real-time analysis of these events when fully incorporated into the SDO feature analysis pipeline. Automating the identification of these events from SDO/AIA data will allow an improved statistical analysis which has implications for our understanding of the physical processes involved in the eruption and propagation of this phenomenon. The ability of CorPITA to identify anisotropies in the propagation of these pulses also suggests that it may be used to investigate the large-scale structure of the solar corona using coronal seismology to study density and magnetic field variations.