= cmr10 at 10 true pt

3 pt 12 pt Theorem Conjecture Problem Assumption Heuristic Proposition Fact Lemma Corollary Remark Remarks Example Definition

Structure of large incomplete sets in abelian groups

Introduction

Let G be an abelian group and A be a subset of G. We use SA to denote the collection of all subset sums of A

[formula]

We will keep this notation when A is sequence of (not necessarily different) elements of A. In this case SA is the collection of all subsequence sums of A. Zn denotes the cyclic group of order n. Example. Take G = Z11. If A is the subset {1,2,3}, then SA  =  {1,2,3,4,5,6}. If A is the sequence {1,1,3}, then SA  =  {1,2,3,4,5}.

Following Erd os [\cite=erd], we say that A is complete if SA = G and incomplete otherwise. If G is finite, the critical number of G, c(G), is the smallest integer m such that any subset [formula] with size m is complete. This parameter has been studied for a long time and its exact value is known for most groups.

Let G be a finite abelian group of order n = ph, where p is the smallest prime divisor of G. Then the following holds

If p = 2 and h  ≥  5 or [formula], then c(G) = h. If p = 2 and h  ≤  4 and [formula], then c(G) = h + 1.

If h is a prime, then p + h - 2  ≤  c(G)  ≤  p + h - 1. Furthermore, if h = p  ≥  3 or h  ≥  2p + 1, then c(G) = p + h - 2.

If p  ≥  3 and h is composite, then c(G)  =  p + h - 2.

The first statement is due to Diderrich and Mann [\cite=DM]. The second combines results of Mann and Wou [\cite=MW] ( who studied the case h = p) and Didderich [\cite=D1]. The last statement has been known as Didderich conjecture, posed in [\cite=D1] and was proved by Gao and Hamidoune [\cite=GH], more than twenty years later.

In this paper, we would like to study the following question

What is the structure of a relatively large incomplete set ?

Technically speaking, we would like to have a characterization for incomplete sets of relatively large size. Such a characterization has been obtained recently in [\cite=GHLS] for sets of size at least n / (p + 2). In this paper, we will be able to treat much smaller sets. (In fact, our assumption on "relatively large" is almost sharp; see Theorem [\ref=theorem:dir2].) The method used in our proofs is different from those used in previous papers. As a by-product, one obtains a new proof for a good portion of Theorem [\ref=theorem:old], including a new proof for Didderich's conjecture for large n (see the remarks following Theorem [\ref=theorem:dir1]).

Notation. < A >  denotes the subgroup generated by A. [formula] denotes the expectation of a random variable X. All logarithms have natural base, if not specified otherwise.

The characterization of large incomplete sets

Let us start by a simple fact, whose proof is left as an exercise.

Let p be a prime and A be a sequence of p - 1 non-zero elements in Zp. Then [formula]. On the other hand, there is a sequence of p - 2 non-zero elements of Zp such that [formula].

Let G be an abelian group of size n and q be a prime divisor of n. Let H be a subgroup of size n / q. A direct corollary of Fact [\ref=fact1] is the following

If A is an incomplete subset of G and [formula], then [formula] has at most q - 2 elements. Consequently A has at most n / q + q - 2 elements.

Let G be an abelian group of size n. A subset A of G is nice if there is a subgroup H of G such that |G / H| is a prime and [formula].

Given a subgroup H in G and an element a∈G, we use a / H to represent the coset of H which contains a. a / H can be viewed as an element of the quotient group G / H. If B is a subset of G, then B / H: = {b / H|b∈B} is a sequence in G / H.

If A is a nice incomplete set in a finite abelian group G of size n, then [formula], where p is the smallest prime divisor of n. Furthermore, [formula] is an incomplete sequence in Zq  =  G / H.

(Proof of Fact [\ref=fact2]) If A is a nice incomplete set then [formula], for some prime divisor q of n. On the other hand, it is easy to see that [formula], where p is the smallest prime divisor of n.

Our leading idea is that relatively large incomplete sets are nice. A special case has been verified by Gao, Hamidoune, Lladó and Serra [\cite=GHLS]. Their theorem can be reformulated in the current setting as follows

Let G be an abelian group of order n = ph, where p  ≥  5 is the smallest prime divisor of n, h  ≥  15p is composite. Let A be an incomplete subset of at least [formula] elements. Then A is nice. Furthermore, there is a subgroup H of size n / p such that [formula].

For any positive ε  ≤  1, define

[formula]

and let n(ε) be the smallest integer m such that for any n  ≥  m

[formula]

n(ε) is relatively small. One can take, say, n(ε)  =  500 / ε4.

Now we are ready to state our first theorem.

Let δ be a positive constant at most 1 / 6 and [formula], t  ≥  2, be primes satisfying three conditions

p2  ≥  3;

[formula];

[formula].

Let G be an abelian group of order n and A be an incomplete subset of G of size at least [formula]. Then A is nice and there is a subgroup H such that n / |H| is one of the pi, [formula] and [formula].

Let us have a few comments on this theorem.

Using Theorem [\ref=theorem:dir1] and Facts [\ref=fact1'], we can recover a large portion of Theorem [\ref=theorem:old]. To see this, consider an incomplete set A which does not contain zero. If |A|  ≤  n / p1, there is nothing to prove. If |A|  ≥  n / p1, and n = |G| satisfies the assumptions of Theorem [\ref=theorem:dir1], apply this theorem to obtain the subgroup H. As A does not contain zero, then [formula]. By Facts [\ref=fact1'], |A|  ≤  n / q + q - 3, where q = n / |H|. But n / q + q  ≤  n / p1 + p1, so |A|  ≤  n / p1 + p1 - 3.

The third assumption [formula] in Theorem [\ref=theorem:dir1] can be voided if we assume t  ≥  3 (i.e., n / p1 is composite) and n sufficiently large. In that case [formula]. It follows that the assumptions of Theorem [\ref=theorem:dir1] are satisfied whenever p1  ≥  3, h is composite and n is sufficiently large. Thus, we have a new proof of Didderich conjecture for sufficiently large n.

Unlike Theorem [\ref=theorem:GHLS], one cannot conclude that H has size n / p1. It is easy to give examples where |G| / |H| can be any of the pi.

The next question is to find the best lower bound on |A| that guarantees niceness. Our second theorem gives an almost complete answer for this question.

For any positive constant δ there is a positive constant D(δ) such that the following holds. Let [formula], t  ≥  3, be primes such that [formula], where [formula]. Let G be an abelian group of order n and A be an incomplete subset of G with cardinality at least [formula]. Then A is nice. Furthermore, the lower bound [formula] cannot be replaced by [formula], for any constant α.

Finally, let us discuss the case when G = Zn, where n is a prime. This case has not been covered by the results presented so far. Olson [\cite=O2], improving upon a result of Erd os and Heilbronn [\cite=EH], shows that [formula]. His bound was improved by da Silva and Hamidoune [\cite=daH] to [formula]. As far as characterization results are concerned, we know of the following two results.

Let n be a prime and A be an incomplete subset of [formula] of size at least (2n)1 / 2. Then there is some non-zero element [formula] such that

[formula]

Let n be a prime and A be an incomplete subset of [formula] of size at least 1.99n1 / 2. Then there is some non-zero element [formula] such that

[formula]

Theorem [\ref=theorem:DF] is due to Deshouillers and Freiman [\cite=DF]. Theorem [\ref=theorem:NSV] is due to Nguyen, Szemerédi and Vu [\cite=NSV]. The error term in this O(n1 / 2) is best possible, as shown by a construction in [\cite=Des2].

The rest of the paper is organized as follows. Section 3 contains the main lemma to the proofs, which states that if A is sufficiently large, then SA contains a subgroup of size comparable to |A|. The proofs of the theorems come in Sections 4 and 5. Section 6 is devoted to concluding remarks.

The existence of a large subgroup in SA

Our key tool is the following statement, which asserts that if A is a sufficiently large subset of G, then SA contains a large subgroup of G. Recall the definition of C(ε) and n(ε) from [\eqref=Cep] and [\eqref=Nep].

Let 0  <  ε  <  1 be a constant and G be an abelian group of size n, where [formula]. Let A be a subset of G with at least [formula] elements. Then SA contains a subgroup of size at least (1 - ε)|A|.

The bound (1 - ε)|A| is asymptotically sharp, as A itself can be a subgroup. The lower bound [formula] for |A| is sharp up to the logarithmic term. To see this, consider G = Zp2 and [formula]. It is clear that [formula]. On the other hand, SA does not contain any proper subgroup of G. It is interesting to see whether the log  term can be removed.

The theorem also holds for non-abelian group, see Theorem [\ref=theorem:subgroup1] at the end of this section.

By definition of n(ε), if n  ≥  n(ε) then

[formula]

In this case we have the following corollary, which is easier to use.

Let 0  <  ε  <  1 be a constant and G be an ablian group of size n  ≥  n(ε). Let A be a subset of G with at least [formula] elements. Then SA contains a subgroup of size at least (1 - ε)|A|.

To prove Theorem [\ref=theorem:subgroup], we use the following result of Olson [\cite=O1] (see also [\cite=TVbook]). Let A be a set and l be a positive integer, we define

[formula]

Also recall that < A >  denotes the subgroup generated by A.

Let G be finite abelian group, l be a positive integer and 0∈A be a finite subset of G. Then either lA =  < A >  or [formula].

Since [formula], the following corollary is immediate.

Let G be a finite abelian group, l be a positive integer and 0∈A be a finite subset of G such that (l + 1)|A|  ≥  2|G|, then

[formula]

We also needs the following result of Olson [\cite=O1], which refines an earlier result of Szemerédi [\cite=Sz] (Szemerédi proved the theorem for an unspecified constant instead of 3).

Let G be an abelian group of order n and A be subset of at least [formula] elements. Then 0∈SA.

We also need the following simple lemma:

Let G be an abelian group and A be a subset of G. Let l be a positive integer and S a subset of G such that every element of S can be represented as the sum of two different elements of A in at least 2l - 1 ways (not counting permutations). Then lS  ⊂  SA.

(Proof of Lemma [\ref=lemma:cor:1]) Let [formula] be (not necessarily different) elements of S. We represent [formula] as a sum of different elements of A using the greedy algorithm. To start, represent x1 = a1  +  a1' where a1  ≠  a1' are different elements of A. Assume that we have represented [formula], where 1  ≤  i  <  l and [formula] are all different. Now look at xi + 1. Each of the 2i elements [formula] appear in at most one representation of xi + 1. Since xi + 1 has at least 2l - 1  >  2i representations, we can find a representation xi + 1  =  ai + 1  +  ai + 1' where both ai + 1 and ai + 1' are different from [formula]. This concludes the prof.

(Proof of Theorem [\ref=theorem:subgroup]) For each element x∈G, let mx be the number of ways to represent x as the sum of two different elements of A (not counting permutations). A double counting argument gives

[formula]

Notice that mx is at most M: = |A| / 2. Set K: = 2 / ε. Let Sj be the collection of those x where K- jM  <  mx  ≤  K- j + 1M for [formula], where j0 is the largest integer such that K- j0M  ≥  1. Let Sj0 + 1 be the collection of those x where 1  ≤  mx  ≤  K- j0M. By the definition of Sj

[formula]

which, together with [\eqref=equ:cor:1-1] imply

[formula]

Call a set Sj small ([formula]) if it has at most (1 - ε)|A| elements and large otherwise. The contribution from the small Sj on the left hand side is at most

[formula]

taken into account the facts that K = 2 / ε and M = |A| / 2. Since [formula], we have

[formula]

From this and [\eqref=equ:cor:1-3], we have

[formula]

The bound [formula] guarantees that

[formula]

(In fact, C(ε) is defined so that this inequality holds.) Set lj: = K- jM. Since the number of large Sj is at most j0 + 1  ≤  ⌊ log 2 / ε|A| / 2⌋ + 1, [\eqref=equ:cor:1-4], [\eqref=equ:cor:1-5] and the pigeon hole principle imply that there is a large Sj such that

[formula]

Notice that |Sj|  ≤  |G| = n. It follows that (⌊lj / 2⌋ + 1)|Sj|  ≥  2n. Apply Corollary [\ref=cor:subgroup] to l: = ⌊lj / 2⌋ and [formula], we can conclude that lS =  < S > . On the other hand, by the definition of S

[formula]

By Lemma [\ref=lemma:cor:1],

[formula]

for all 1  ≤  i  ≤  l. Finally, 0∈SA by Olson's theorem. Thus SA contains < A > , which has at least (1 - ε)|A| elements since Sj is large and | < S > |  ≥  |S|  ≥  |Sj|. This concludes the proof.

All the tools used in the proof (Theorems [\ref=theorem:olson] and [\ref=theorem:szemeredi], Lemma [\ref=lemma:cor:1]) hold for non-abelian groups. Thus, Theorem [\ref=theorem:subgroup] also holds for this case. The proof requires only two simple modifications. First, in Lemma [\ref=lemma:cor:1], 2l - 1 is replaced by 4l - 3. The reason is that in the proof, each of the elements [formula] can now appear in at most 2 representations of xi + 1. The second is that in the proof of Theorem [\ref=theorem:subgroup], we need to fix an ordering on the elements of G and when we consider a sum x + y, we always assume that x precedes y in this ordering. The rest of the proof remains the same.

For any constant 0  <  ε  <  1 there are constant n1(ε) and C1(ε) such that the following holds. Let G be a group of size n, where n  ≥  n1(ε). Let A be a subset of G with at least [formula] elements. Then SA contains a subgroup of size at least (1 - ε)|A|.

The values of n1(ε) and C1(ε) might be slightly different from that of n(ε) and C(ε), due to the modifications.

Proof of Theorem [\ref=theorem:dir1]

Let G be a finite additive group and A be a subset of G with cardinality at least ⌊|G| / 2⌋ + 2. Then SA  =  G.

(Proof of Lemma [\ref=lemma:dir2]) Let x be an arbitrary element of G. There are exactly ⌊|G| / 2⌋ (unordered) pairs (a,b) of different elements of G such that a + b = x. The claim follows by the pigeon hole principle. One can improve the bound slightly but from our point of view it is not important.

(Proof of Theorem [\ref=theorem:dir1]) Let A1 be an arbitrary subset of A with cardinality [formula]. By the upper bound on p1, we can assume that [formula], which enables us to apply Corollary [\ref=theorem:subgroup] to A1 and obtain a subgroup H  ⊂  SA1 where

[formula]

The assumption p2  ≥  3 shows that [formula]. It follows that |H|  =  n / q where q is one of the pi ( 1  ≤  i  ≤  t). Furthermore,

[formula]

Consider the sequence [formula] in the quotient group G / H = Zq. If B has at least q - 1 non-zero elements, then by Fact [\ref=fact1] SB contains [formula], which implies that

[formula]

a contradiction as A is incomplete. Thus, B has at most q - 2 non-zero elements. So we can conclude that all but at most q - 2 elements of [formula] lie in H. Let A2 denote the set of these elements. We have

[formula]

The right most formula is

[formula]

since [formula] by the assumption [formula] and the definition of C(δ).

On the other hand, |H| is at most [formula]. Thus, |A2|  ≥  |H| / 2 + 2 and so by Lemma [\ref=lemma:dir2], SA2 = H. Notice that [formula]. Thus [formula] which means that A is nice, completing the proof.

Proof of Theorem [\ref=theorem:dir2]

Without loss of generality, we can assume that δ  ≤  1 / 2 and A has exactly [formula] elements. Let A1 be a subset of A of size [formula]. Setting D(δ) sufficiently large, one can assume that n is sufficiently large and [formula] (where C is defined as in [\eqref=Cep]), thanks to the assumption

[formula]

This enables us to apply Corollary [\ref=cor:subgroup] to A1 and conclude that SA1 contains a subgroup H of size at least

[formula]

The critical point here is that |H| is larger than [formula]. This forces |H|  =  n / q where q is one of the primes pi. It would be easy to finish the proof now if A had at least [formula] (instead of only [formula]) elements. The reason is that in this case we still have [formula] elements outside A1 to play with. Arguing as in the previous proof, we can show that most of these elements should be in H and span it. As we lack these extra elements, we need an additional trick that helps us to show that actually most elements of A1 are already in H. The heart of this trick is Lemma [\ref=lemma:random] below. Before presenting the lemma, let us make some observations. Set [formula]. As A1 was chosen arbitrarily, A2 is an arbitrary subset of A with [formula] elements. Since A is incomplete, [formula], where q = |G| / |H|  ≤  p1p2. By setting D(δ) sufficiently large, we can assume

[formula]

which implies

[formula]

To summarize, A has the property that for any subset A2 of size [formula], there is a maximal subgroup H of G such that [formula].

Let S be a subset of G of size [formula] such that no maximal subgroup of G contains (1 - δ / 2) fraction of S. Then there is a subset S'  ⊂  S of size [formula] such that no maximal subgroup of G contains (1 - δ / 10) fraction of S'.

Assuming the lemma for a moment, we can conclude the proof as follows. By the lemma and its preceding paragraph, there is a maximal subgroup H such that

[formula]

as δ  ≤  1 / 2. Since |H|  ≤  n / p1 and the smallest prime divisor p' of H is either p1 or p2, it is easy to verify that

[formula]

Thus we can apply Theorem [\ref=theorem:old] or Theorem [\ref=theorem:dir1] for H and [formula] to deduce that [formula] is complete in H. Therefore, [formula] and A is nice.

Now we prove Lemma [\ref=lemma:random], using a probabilistic argument.

(Proof of Lemma [\ref=lemma:random]) Set [formula] and ε: = δ / 10. Consider a random subset S1 of S obtained by selecting each element a∈S to be in S1 with probability [formula], independently. Let H be a subgroup of G. By linearity of expectation and the assumption of the lemma , we have

[formula]

On the other hand, [formula]. Both [formula] and S1 have binomial distribution. By property of the binomial distribution, there is a positive constant c0 depending only on ε such that with probability at least 1 -  exp ( - c0ρs)

[formula]

and

[formula]

It is well known (and easy to prove) that the number of maximal subgroups of G is at most |G| = n. If D(δ) (and so n) is sufficiently large, then

[formula]

Thus, we can use the union bound to conclude that there exists a set S1 such that [\eqref=S1-1] holds and [\eqref=S1-2] holds simultaneously for every maximal subgroup H. Let S' be any subset of S1 of size [formula]. For any maximal subgroup H

[formula]

This concludes the proof of the lemma.

The following example shows that the lower bound [formula] cannot be reduced to [formula], for any fixed α.

Example. Take n: = p2q where 1  <  p  <  q are large primes. Consider [formula]. Given any δ > 0 and any function D(δ), by choosing q properly p we can guarantee that

[formula]

We write an element a∈G as a = (x,y) where x∈Zp2 and y∈Zq. Let m be the largest integer such that [formula]. Set

[formula]

It is easy to show that A is incomplete and not nice, thanks to the fact that [formula]. On the other hand,

[formula]

The proof of the theorem is complete.

Concluding remarks

One can use the additional trick in the proof of Theorem [\ref=theorem:dir2] to improve upon the constant (5 / 6 + δ) in Theorem [\ref=theorem:dir1]. However, this requires some modification on the assumptions. We prefer to present Theorem [\ref=theorem:dir1] in the simplest way in order to illustrate the ideas.

One can also use the method presented here to study incomplete sets with size less than [formula]. However, the characterization obtained in this case is more technical and less appealing.