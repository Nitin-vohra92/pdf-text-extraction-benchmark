Dominance refinements of the Smirnov two-sample test

LaBRI Université de Bordeaux I 33405 Talence, France loeb@labri.u-bordeaux.fr URL http://www.labri.u-bordeaux.fr/~  loeb

Keywords Smirnov two-sample test, dominance refinement, Gnedenko path. AMS classification 62G10, 05A15

Introduction

Let [formula] and [formula] be independent random samples from continuous distribution functions F and G, respectively. In order to test nonparametrically whether X1 is stochastically smaller than Y1, one often uses the Smirnov statistic

[formula]

where Fm and Gn are the empirical distribution functions of [formula]  and [formula] respectively.

Narayana (1971, pp. 43 ff.) constructs explicit dominance refinements of (upper-tailed) Smirnov two-sample tests with equal sample sizes and calculates their power against Lehmann alternatives G  =  Fk(k  >  0). In the ranges considered by Narayana (3  ≤  m  =  n  ≤  10), he shows that the powers of these dominance refinements are uniformly greater than the Smirnov test. It is thus of practical importance to know when dominance refinements exist.

Narayana (1975) stated without proof that dominance refinements of the Smirnov two-sample test exist if and only if gcd (m,n)  >  1. This claim was restated as a conjecture in Narayana (1979, Exercise 9, p. 30). The purpose of this paper is to prove this conjecture. We will show that this conjecture is closely related to the number of natural significance levels of the Smirnov two-sample test.

Dominance refinements

In this section, we explain what dominance refinements are.

A convenient way to study the distribution of D+mn is the so-called Gnedenko path. The Gnedenko path ω of the samples [formula] and [formula] is defined as follows: ω is a path from (0,0) to (m,n) with unit steps ωi to the east or north. If the ith value of the ordered combined sample comes from [formula], then ωi is a step east; otherwise, it is a step north. Since we assume that F and G are continuous, the probability of a tie ( i.e., Xi = Yj) is zero. Hence, ω is almost surely well-defined. It is easy to see that under H0:F  =  G, all paths from (0,0) to (m,n) are equiprobable, i.e., [formula] for all paths w. Now,

[formula]

if and only if all vertices (x,y) of the Gnedenko path satisfy

[formula]

In other words, mnD+mn  ≥  r if and only if ω crosses below the line nx  -  my  =  r. A convenient way to describe a path ω is to represent it by a n-tuple [formula], where ti is the horizontal distance from (m,n - i) to ω (see Figure 1). The path [formula] is said to dominate [formula] if si  ≥  ti for [formula].

Let the ⌈x⌉ be the ceiling of x, i.e., the smallest integer larger than or equal to x and let ⌊x⌋ be the floor of x, i.e., the largest integer not exceeding x. The r-profile is the path [formula], where ti is the ceiling of the horizontal distance from (x,m - i) to the line nx  -  my  =  r). Clearly, the r-profile is the minimal path that lies above (possibly touching) the line nx  -  my  =  r.

Thus, we may cast the (upper-tailed) Smirnov two-sample test completely in terms of Gnedenko paths as follows: mnD+mn  ≤  r if and only if the Gnedenko path dominates the r-profile. Thus, the Smirnov two-sample test is completely characterized by its r-profiles ( i.e., we regard the test as a set of critical regions, indexed by its natural significance levels, cf. Gibbons (1992, p. 23)). This formulation shows that we attain more significance levels if we can insert intermediate paths between consecutive r-profiles of the Smirnov two-sample test (see Narayana (1979, Chapter 2)). A set of paths totally ordered by dominance is said to be a dominance refinement of any set of paths included in it. Note that under this definition, we consider a test to be a dominance refinement of itself, called the trivial dominance refinement. A set of paths is saturated if it has no nontrivial dominance refinement.

Of course, there exist other refinements of the Smirnov test. Each partition of the set of paths with a common value r of the statistic D+mn ( i.e., all paths that touch but do not cross the line nx  -  my  =  r) yields a refinement of the Smirnov test. For example, we can divide the paths that touch but do not cross the line nx  -  my  =  r according to the number of times that they touch the line nx  -  my  =  r. Dominance refinements partition the set of paths with a common value of D+mn into dominance regions, i.e., collections of paths that dominate a given path. An advantage of dominance refinements is that they can be described very efficiently by simply listing the critical paths. Hence, the refined test can be performed graphically.

Another reason for considering dominance refinements (or the notion of dominance itself) is the following relation with most powerful rank (MPR) tests. If F and G have densities f and g respectively, and the likelihood ratio f / g is increasing (as is the case for the Lehmann alternatives Ha:G  =  Fk, k  >  0), then s dominates t implies [formula] (see Savage (1956)). Hence, if a path s belongs to the critical region of an MPR test, then all paths dominated by s must also belong to this critical region. Thus, an MPR test at a fixed significance level is a dominance test in the terminology of Narayana (1979, Chapter 3, p. 35). Conversely, dominance tests are good approximations for MPR tests (see Narayana (1979, Chapter 3, pp. 44-45)).

Let us look at two examples in order to get a feeling for the Narayana conjecture.

(Figure 2, m = 4, n = 2) The 0-profile and the 1-profile coincide and are equal to the path 〈2,4〉 whereas the 2-profile is the path 〈1,3〉. Thus, we see that there are two intermediate paths between the 1-profile and the 2-profile: 〈1,4〉 and 〈2,3〉. Inserting either of these paths, we obtain a refinement of the Smirnov test. Note that the 2-profile differs from the 1-profile by the possibility to go through the points (1,0) and (3,1), which both lie on the line 2x  -  4y  =  2.

(Figure 3, m = 5, n = 3) The 0-profile is the path 〈2,4,5〉, and the 1-profile is the path 〈2,3,5〉. Thus, there is no intermediate path between the profiles; this is also true for the other pairs of consecutive profiles. In other words, there is no refinement. Note that there is only one lattice point on each line of the form 3x  -  5y  =  r and that no profiles coincide.

Main Results

The examples above indicate that the existence of dominance refinements depends on the number of lattice points on lines of the form nx  -  my  =  r. In the following lemmas, we enumerate these points. These lemmas are used in our proof of the Narayana conjecture.

For unexplained notions of number theory and combinatorics, we refer the reader to Stark (1970, Chapters 2 and 3) and Berge (1971).

Let m, n, and r be positive integers, and let d =  gcd (m,n). 1. The Diophantine equation

[formula]

has integer solutions if and only if d divides r.

2. If (x,y) is a solution of ([\ref=unconstrained]), then the integer solutions of ([\ref=unconstrained]) are exactly

[formula]

Proof: 1. If r  =  d, then by Euclid's Lemma there exist integer solutions (x,y) of nx  -  my  =  r. Obviously, this also holds if r is a multiple of d. Conversely, if there exists an integer solution (x,y) of nx  -  my  =  r, then r is a multiple of d, since d divides both m and n.

2. If t, x, and y are integers such that nx  -  my  =  r, then x': = x  +  tm   /   d and y': = y  +  tn   /   d satisfy nx'  -  my'  =  r. Conversely, if nx  -  my  =  r and nx'  -  my'  =  r, then subtraction yields n(x  -  x')  =  m(y'  -  y). Cancelling the common factor d and using the uniqueness of prime factorizations, we see that there exists an integer t such that x  -  x'  =  tm   /   d and y'  -  y  =  tn   /   d. [formula]

Let m and n be positive integers with greatest common divisor d and m  ≥  n. Let r be a nonnegative number. The Diophantine equation

[formula]

has integer solutions only if d divides r and 0  ≤  r  ≤  nm. In that case, the number of solutions to the Diophantine equation ([\ref=star]) is given by

[formula]

Here, (n / d)- 1 denotes the inverse of n / d in the ring [formula].

Proof: The first assertion is an immediate consequence of Lemma [\ref=L1] and the fact that (m,0) lies on the line nx  -  my  =  nm.

Now, define m'  =  m / d, n'  =  n / d, and r'  =  r / d. By the remainder theorem, there exist nonnegative integers p and q such that r'  =  n'p  +  q with 0  ≤  q  <  n'. Since m' and n' are relatively prime, it follows from Lemma 1 that there exist integers a (0  ≤  a  ≤  m') and b (0  ≤  b  <  n') such that q  =  an'  -  bm'. Thus, r'  =  n'(p  +  a)  -  m'b. Hence, (p + a,b) is a solution to ([\ref=unconstrained]). We claim that (p + a,b) is the solution (x,y) (x  ≥  0) of ([\ref=unconstrained]) with minimal nonnegative y. This claim follows from the above, since the next smaller solution of ([\ref=unconstrained]) has y'  =  b  -  n'  <  0. Thus, the solutions of ([\ref=unconstrained]) with y  ≥  0 are exactly [formula].

Now, impose x  ≤  m on this solution set. This leads to t  ≤  (m  -  p  -  a) / m'. Therefore, the solutions to ([\ref=star]) are [formula] where [formula].

Note that if p + a  >  m, then T =  - 1 and there are no solutions at all.

The value of p follows from n'p  =  r'  -  q (0  ≤  q  <  n'). It follows from r'  =  n'(p  +  a)  -  m'b that [formula]. Since m' and n' are relatively prime, n' has an inverse in [formula]. Thus, [formula]. Equivality follows since a < n'  ≤  m'.[formula]

Examples.

(Figure 2, m = 4, n = 2) If r = 1, then there are no solutions, since d does not divide r. If r  =  2, then p  =  ⌊1 / 2⌋  =  0 and n / d  =  1, hence [formula] and a  =  0. Thus, the number of solutions equals [formula].

(Figure 3, m = 5, n = 3) If r  =  1, then p  =  ⌊1 / 3⌋  =  0 and [formula], since [formula]. Thus, a  =  2 and the number of solutions equals [formula]. If r  =  14, then p  =  ⌊14 / 3⌋  =  4, a  =  2, and the number of solutions equals 1  +  1  -  ⌈6 / 5⌉  =  1 + 1 - 2  =  0.

Let m and n be positive integers with greatest common divisor d. Let sk be the number of positive divisors r of d such that αr = k (in Lemma [\ref=previous]), in other words, such that the Diophantine equation [\ref=star] has precisely k integer solutions. Then

sk = 0 for k > d,

sk  =  nm  /  d2 for 0 < k < d,

s0 = (nm - (n + m)d + d2) / 2d2, and

sd = (nm + (n + m)d - d2) / 2d2.

Proof: We use the notation of Lemma 2 and its proof. Without loss of generality, m  ≥  n.

1. This follows from the second part of Lemma 1.

2. By Lemma 2, nx  -  my = r has k (0  <  k  <  d) solutions with the constraints 0  ≤  x  ≤  m and 0  ≤  y  ≤  n if [formula]. In other words, if m  -  m'k  <  p  +  a  ≤  m  -  m'(k - 1). Each r' corresponds uniquely to a pair (p,q) with either 0  ≤  q  <  n' and 0  ≤  p  <  m or q  =  0 and p  =  m. First choose q, which can be done in n' ways. This fixes a. Hence, p must obey 0  ≤  m  -  m'k  -  a  <  p  ≤  m  -  m'(k - 1)  -  a  ≤  m - a  ≤  m, of which there are exactly m' solutions.

3. By Lemma 1, we must have r  >  nm  -  nm / d, or equivalently r'  >  nm / d  -  nm / d2. Each line n'x  -  m'y  =  r' has 0 or 1 integer solutions with 0  ≤  x  ≤  m and 0  ≤  y  ≤  n. Now, consider all lattice points (x,y) with nx  -  my  >  nm  -  nm / d, x  ≤  m, and y  ≥  0, i.e., the triangle spanned by the points (m - m',0), (m,0), and (m,n') with the points (m - m',0) and (m,n') excluded. It is easy to see that this triangle contains Δ: = (m'   +   1)(n'   +   1)   -   2)   /   2 points. By the second part of Lemma 1, each such point corresponds uniquely to a line nx  -  my  =  r with exactly one lattice point in the region 0  ≤  x  ≤  m and 0  ≤  y  ≤  n. Hence, the other nm / d2  -  Δ lines contain no point.

4. This follows by elimination, since there are nm / d values of r under consideration. [formula]

Define the Bell-Stirling number Bon to be the number of ordered partitions of [formula] into disjoint nonempty sets [formula]. For example, Bo0 = 1, Bo1 = 1, Bo2 = 3, Bo3 = 13, Bo4 = 75, Bo5 = 539. The Bell-Stirling number can also be defined implicity by its generating function (Motzkin (1971, p. 171))

[formula]

Now, we prove the Narayana conjecture by counting dominance refinements and saturated dominance refinements.

Let m and n be positive integers with greatest common divisor d.

The Smirnov upper-tailed two-sample test with sample sizes m and n has exactly (d2  +  nm(2d  -  1) + d(n + m)) / (2d2) natural levels.

All saturated dominance refinements of the Smirnov upper-tailed two-sample test with sample sizes m and n have exactly ((n + 1)(m + 1) - (d + 1)) / 2  +  1 natural levels.

(Narayana's Conjecture) The Smirnov upper-tailed two-sample test is saturated if and only if the sample sizes are relatively prime.

The number of dominance refinements of the Smirnov upper-tailed two-sample test with samples size m and n (including the trival one) is given by the product

[formula]

The number of saturated dominance refinements of the Smirnov upper-tailed two-sample test with sample sizes m and n is given by the product

[formula]

Proof: 1. We use the representation of the Smirnov test as a set of r-profiles. As noted above, the r-profile is different from the (r - 1)-profile exactly when the Diophantine equation ([\ref=star]) has at least one solution (x,y). The number of levels thus corresponds to the number of r such that αr > 0 in Lemma [\ref=previous] (including r  =  0). We are thus led to sum [formula] in Lemma [\ref=last], which equals 1  +  (d - 1)nm   /   d2  +  (nm   +   (n   +   m)d    -    d2)   /   (2d2)  =  (d2    +    nm(2d    -    1)   +   d(n   +   m))   /   (2d2).

2. Let [formula] be a saturated set of paths. The region strictly between two consecutive paths Pi and Pi + 1 is exactly a unit square {(x,y)|(xi - 1  ≤  xiyi  ≤  yi + 1} as in Figure 2, otherwise additional paths could be inserted between Pi and Pi + 1. All points (x,y) with 0  ≤  x  ≤  m, 0  ≤  y  ≤  n and nx - my  >  0 determine exactly one such unit square, since they lie under the 0-profile. There are ((n + 1)(m + 1)  -  (d  +  1)) / 2 such points, since there are d + 1 lattice points on nx  -  my  =  0. Thus, the path is of length (n + 1)(m + 1) - (d  +  1)) / 2 - 1 and consists of (n + 1)(m + 1) - (d  +  1)) / 2 natural significance levels.

3. If m and n are relatively prime, then substitution of d = 1 into parts 1) and 2) yields that the Smirnov upper-tailed two-sample test has as many natural significance levels as its saturated dominated refinement. Hence, the Smirnov test is saturated. Conversely, if m and n are not relatively prime, then by Lemma [\ref=last] there is at least one line nx  -  my  =  r with two lattice points. Hence, the Smirnov upper-tailed two-sample test admits a non-trivial dominance refinement.

4. Consider an r-profile P with αr = k, and the (r - 1)-profile P'. The area between P and P' consists of k unit squares as in Figure 3. New profiles can be "inserted" between P and P' by passing the path across the k unit squares in several steps instead of all at once. Let [formula] be an ordered partition of the k unit squares. Define the intermediary path Pi to pass under the cells [formula], over the cells [formula], and follow paths P and P' where they agree. Each such ordered partition determines a dominance refinement of this step in the list of paths which make up the Smirnov test. There are Bok ordered partitions.

To consider the combinations of refinements of each step of the Smirnov test, we take the product over all r.

5. The reasoning is similar to that in part 4 except we must only consider ordered partitions into unit blocks. There are k! such ordered partitions of a k element set. [formula]

Table [\ref=natu] shows the number of natural significance levels for the upper-tailed Smirnov two-sample test for various sample sizes. Note especially the low number of levels for Smirnov tests with equal sample sizes ( e.g., compare the number of levels for m = n = 10 with those for m = 10 and n = 9). Table [\ref=satur] shows the number of natural significance levels for saturated dominance refinements of the upper-tailed Smirnov two-sample test for various sample sizes. Note that unlike in Table [\ref=natu], there are no big differences in Table [\ref=satur].

If we can list the profiles of an upper-tailed Smirnov two-sample test, then using Kreweras' theorem (Narayana (1971, p. 21) we can also calculate the levels rather than the total number of levels. For example, in the case of equal sample sizes m = n, the profiles are the paths [formula], [formula],[formula], [formula]. In order to calculate the levels associated to these profiles, we must calculate the number of paths dominated by these profiles. According to (a special case of) Kreweras' theorem, this amounts to calculating the determinants of the matrices

[formula]

where [formula] is defined as [formula] for y  ≥  z  ≥  0 and 0 otherwise. E.g., for m = m = 10, we easily calculate that the natural significance levels are 5.41  ×  10- 6, 1.08  ×  10- 5, 2.71  ×  10- 5, 7.58  ×  10- 5, 2.27  ×  10- 4, 7.14  ×  10- 4, 0.00232, 0.00774, 0.0263, 0.0909, and 0.318.

Remark. In our theorem, we only considered the upper-tailed Smirnov test based on D+mn  =   sup t  (Fm(t)  -  Gn(t)). Of course, similar results exist for the Smirnov tests based on D-mn  =   sup t  (Gn(t)  -  Fm(t)) or Dmn  =   sup t  |Fm(t)  -  Gn(t)|.

Acknowledgement. We would like to thank John Einmahl for stimulating discussions on this paper.