Smoothed Particle Magnetohydrodynamics Simulations of Protostellar Jets and Turbulent Dynamos

Introduction

Magnetic fields play an important role in all phases of star formation. On the scale of molecular clouds, the sites where stars are formed, magnetic fields can affect the structure of the supersonic turbulence. It is known that this turbulence drives the local compression needed to trigger gravitational collapse of molecular cloud cores, and simulations by [\citet=pn11] and [\citet=fk12] show that the additional pressure from magnetic fields can help support against gravitational collapse and reduce star formation rates by factors of 2-3.

On the scale of individual protostars, magnetic fields are responsible for launching protostellar jets and outflows. These jets and outflows are both well observed [\citep=richeretal00] [\citep=wuetal04] and simulated [\citep=mim08] [\citep=commerconetal10] [\citep=ptb12] [\citep=mh13]. They reduce the efficiency of star formation [\citep=mm00] [\citep=hansenetal12], and are drivers of turbulence in the interstellar medium [\citep=nl07] [\citep=cfb10].

In this work, we have performed Smoothed Particle Magnetohydrodynamic (SPMHD) [\citep=pm04a] [\citep=pm04b] [\citep=pm05] simulations of the gravitational collapse of a prestellar core to form the first hydrostatic core (before the protostar is formed), and also of magnetised Mach 10 turbulence which exponentially amplifies an initial seed magnetic field. These simulations use new numerical techniques to maintain the divergence free constraint on the magnetic field, detect shocks, and reduce numerical dissipation of the magnetic field.

This paper begins with a brief review of SPMHD in §[\ref=sec:spmhd], discussing how magnetic fields are simulated with SPMHD, and the benefits of using SPMHD for star formation simulations. In §[\ref=sec:cleaning], the constrained hyperbolic divergence cleaning method is introduced, which is used to maintain [formula]. In §[\ref=sec:jet], we present results from simulations of a collapsing prestellar core. The jet produced in our simulations during protostellar collapse is discussed in §[\ref=sec:jet-results]. In §[\ref=sec:mhdturb], results from simulations of Mach 10 magnetised turbulence are presented. These simulations focus on the dynamo amplification of the magnetic field, with comparison to results from grid based methods. A summary and discussion is given in §[\ref=sec:summary].

Smoothed Particle Magnetohydrodynamics

Smoothed Particle Hydrodynamics (SPH) is a numerical method for simulating fluid flow (see reviews by [\citealt=monaghan05] [\citealt=price12]). The hydrodynamic equations are solved by discretising the fluid into a set of particles which contain a portion of the mass, energy, and momentum of the fluid. Fluid quantities, such as density, are calculated per particle by interpolating from neighbouring particles using a kernel weighted summation.

SPH is widely used in astrophysics. It can easily handle complex geometries, has excellent conservation properties, and couples easily with N-body methods for gravity. Regions of higher density contain more mass, and therefore more resolution elements. This is useful for star formation, because as gas collapses to form dense objects, the mass, and hence particles, trace the collapse providing continuous resolution of that process until the Jeans mass falls below the mass resolution [\citep=bb97].

The equations of SPMHD

The ideal MHD equations solved with SPMHD are given, for a particle a, by

[formula]

where [formula] and [formula] are the velocity and magnetic fields, [formula] denotes [formula], and W is an interpolation kernel. We use the cubic spline kernel [\citep=ml85] in this work.

Variable resolution is obtained by self-consistently deriving the density, ρ, and smoothing length, h, through iteration of equations ([\ref=eq:sphcty]) and ([\ref=eq:h]). The smoothing length is related to the local particle spacing by hfac = 1.2, with [formula] corresponding to the number of dimensions. Variable smoothing length gradients are handled by Ω (see [\citealt=sh02]).

The momentum equation ([\ref=eq:spmhd-momentum-eqn]) is derived from the Lagrangian and exactly conserves energy and momentum. It is expressed in terms of the Maxwell stress tensor,

[formula]

with the thermal pressure, P, obtained through a suitable equation of state. Terms containing [formula] are subtracted from the SPMHD momentum equation, introducing a small amount of non-conservation of energy and momentum, but greatly enhancing stability and performance. The induction equation ([\ref=eq:sphind]) is a representation of [formula].

Shock capturing

Hydrodynamic and magnetic shocks are captured by the addition of artificial viscosity and resistivity to the momentum and induction equations. The artificial viscosity used here was formulated by [\citet=monaghan97] by analogy to Riemann solvers, and is given by

[formula]

The signal velocity represents the characteristic speed of information propagation across the shock, given by

[formula]

For ideal MHD, the sound speed, c, is replaced by the fast MHD wave speed,

[formula]

where vA corresponds to the Alfvén speed.

Artificial resistivity was formulated through a similar procedure by [\citet=pm05]. The corresponding term in the induction equation ([\ref=eq:sphind]) is given by,

[formula]

The signal velocity for artificial resistivity is chosen as [formula], which is the averaged fast MHD wave speeds.

The dimensionless parameters α and αB are of order unity. To reduce the dissipation from artificial viscosity and resistivity away from shocks (where it is unnecessary), α and αB may be set individual for each particle and used to regulate the strength of the applied dissipation. [\citet=mm97] proposed integrating αa according to

[formula]

with αa∈[0.1,1]. This equation increases αa in regions of converging flow, with a post-shock decay timescale, τ  =  h  /  Cc, of approximately five smoothing lengths ([formula]).

[\citet=pm05] created a similar switch for artificial resistivity, using

[formula]

with a range αB,a∈[0,1].

Recently, we have proposed a new switch for artificial resistivity that is more robust at detecting shocks and leads to less overall dissipation [\citep=tp13]. It sets

[formula]

in the range αB,a∈[0,1]. This increases artificial resistivity in regions of strong magnetic field gradients. Since [formula], this leads to a quantity which is related to the Alfvénic Mach number. By normalising the gradient against the magnitude of the magnetic field, the switch responds to the relative degree of discontinuity and does so independently of the absolute magnetic field strength (this is important for the dynamo amplification simulations in §[\ref=sec:mhdturb]). Setting the value of αB directly in this manner improves the responsiveness to shocks by removing the time delay present in equation ([\ref=eq:intalphaB]).

Constrained hyperbolic divergence cleaning

The zero divergence constraint on the magnetic field is maintained using constrained hyperbolic divergence cleaning [\citep=tp12]. The cleaning algorithm couples an additional scalar field, ψ, to the magnetic field, and divergence error in the magnetic field is dispersed and diffused using a series of damped waves. By spreading the divergence error over a larger volume, it is able to be removed faster than using just a diffusion term alone, and furthermore, the impact of any single large source of error is reduced.

The method is a Hamiltonian version of hyperbolic divergence cleaning [\citep=dedner02] which has been derived by defining the energy content of the ψ field, and including it as part of the Lagrangian. This leads to continuum equations,

[formula]

and SPMHD equations

[formula]

The divergence wave speed, ch, is chosen as the maximum allowable according to the Courant timestep criterion (typically this would be the fast MHD wave speed). The damping term, τ  =  h  /  σch, is best chosen in the regime of critical damping, which from empirical tests [\citep=tp12], is σ∈[0.2,0.3] for 2D and σ∈[0.8,1.2] for 3D. Equation ([\ref=eq:continuumcleandpsi]) differs from [\citet=dedner02] by the addition of the [formula] term, which describes how ψ changes as the fluid is expanded or compressed. The constraint from energy conservation also leads to a specific choice of derivative operators in the SPH formulation, as given by equations ([\ref=eq:sphgradpsi]) and ([\ref=eq:sphcleandpsi]).

By building the method from the ground up in the context of the Lagrangian equations of motion, it inherently retains the stability properties of SPH and is guaranteed to always decrease the divergence of the magnetic field. This fixes problems in the previous implementation by [\citet=pm05] particularly at density contrasts and free boundaries.

Molecular cloud core collapse

[\citet=larson69] showed collapsing prestellar cores undergo a two stage collapse for low mass star formation. For both stages the collapse is nearly isothermal, but has a brief adiabatic phase when molecular hydrogen reaches densities higher than 10- 13 g cm- 3. At these densities, the gas becomes optically thick, trapping radiation. These first hydrostatic core objects have a lifetime of only several thousand years, ending when the gas reaches 2000 K and the molecular hydrogen disassociates. The radiation is then able to freely escape, and the core undergoes a second near-isothermal collapse to form a protostellar core.

Observations of first core objects have been difficult because of the low luminosity of these objects, and it is only within recent years that candidate detections have been made. [\citet=pinedaetal11] observed a low-mass dense core in the Perseus Molecular Cloud, with upper limits on bolometric luminosity and temperature of 0.05 L[formula] and 30 K, and found traces of a slow (3 km s- 1), poorly collimated outflow. Per Bolo 58 has been studied by [\citet=enochetal10], finding it to be a promising first hydrostatic core candidate with an internal luminosity of [formula]. [\citet=dunhametal11] detected a well collimated ([formula]) bipolar outflow in Per Bolo 58 with characteristic velocity of 2.9 km s- 1.

We have performed simulations of a [formula] collapsing prestellar core during the first stage of collapse to form the first hydrostatic core .

Initial conditions and numerical details

The simulations are performed for a [formula] spherical core with radius R = 4  ×  1016 cm ([formula] AU), giving an initial density of 7.43  ×  10- 18 g cm- 3. It is set in solid body rotation with angular velocity Ω  =  1.77  ×  10- 13 rad s- 1. The free fall time is [formula] yr. A barotropic equation of state is used (as described in [\citealt=ptb12]), where the gas is isothermal below a critical density of ρc  =  10- 14 g cm- 3, and adiabatic above this density. The speed of sound is c = 2.2  ×  104 cm s- 1.

The initial magnetic field is uniform along the rotation axis with mass-to-flux ratio 5, or Bz = 163μG. Edge effects with the magnetic field are avoided by embedding the core in an ambient medium in a periodic box of length 4R. The medium has a density contrast of 1:30 and is set in pressure equilibrium with the core.

The core is simulated using 1  ×  106 particles. Self-gravity is included by use of a hierarchical binary tree [\citep=benzetal90], with the SPH smoothing kernel used for gravitational force softening [\citep=pm07]. A sink particle [\citep=bbp95] is inserted once the density reaches ρd  =  10- 10 g cm- 3 and accretes material within 6.7 AU.

Only a minimal amount of artificial resistivity is applied to the magnetic field, using the switch described in equation ([\ref=eq:intalphaB]) in the range αB∈[0,0.1]. The constrained hyperbolic divergence cleaning algorithm (§[\ref=sec:cleaning]) is used to remove errors arising from the divergence of the magnetic field. Using this algorithm, the average divergence error of the field is kept to within 1% (Figure [\ref=fig:jet-cleaning]).

First core jet

The simulations are performed until [formula]. At [formula], the winding of the magnetic field by the infalling material launches a well collimated jet along the axis of rotation (Figure [\ref=fig:jet-jet]). The jet has mean velocity 2 km s- 1, with top end velocities of 5-7 km s- 1 (see Figure [\ref=fig:jet-massv]), which is consistent with observed speeds and the escape velocity for an object of this mass and radius.

The jet is highly efficient at removing mass. By [formula], 40% of the original material in the core has been ejected through this outflow, consistent with outflow studies by [\citet=mm00] and [\citet=hansenetal12]. The material around the sink particle settles into a disc-like object due to the conservation of angular momentum, but has sub-Keplerian orbital velocites by a factor of ~   3-4.

The magnetic field near the sink particle is ~   100 mG, wound in a toroidal geometry. This leads to the "wiggles" observed in the jet as a result of the expanding magnetic field in the z-direction. The magnetic field lines at [formula] are shown in Figure [\ref=fig:jet-field], where the field from each particle is represented with an opacity proportional to field strength.

Mach 10 magnetised turbulence

Why are observed magnetic fields in the universe as strong as they are? It is becoming increasingly understood that small scale turbulent dynamos drive exponential amplification of the magnetic field, such that even if initial magnetic fields had tiny field strengths, they would have rapidly reached observed values (see reviews by [\citealt=becketal96] [\citealt=bs05] [\citealt=widrowetal12]).

We have been performing a code comparison between SPMHD and finite difference methods on the dynamo amplification of magnetic fields in Mach 10 turbulence, representative of turbulence found in molecular clouds in the Milky Way (for reviews, see [\citealt=evans99] [\citealt=es04] [\citealt=mk04] [\citealt=mo07]). These simulations begin with an initially weak magnetic field, which is exponentially amplified through the conversion of turbulent energy until the magnetic energy reaches equipartition with the kinetic energy (an increase of 10 orders of magnitude in this case). Our comparison extends the purely hydrodynamic code comparison by [\citet=pf10] on the statistics of driven Mach 10 turbulence between SPH and grid-based methods. Their conclusion was that excellent agreement was found in the properties of the turbulence, with SPH performing better at resolving dense structures, and grid-based methods better for volumetric quantities.

Initial conditions

The simulations are run at resolutions of 1283 and 2563 particles. The initial conditions are similar to the parameter study performed by [\citet=federrathetal11]. The density is uniform, with ρ = 1, and an isothermal equation of state is used with c = 1. The initial magnetic field is [formula] such that the initial plasma beta is [formula].

The turbulence is driven and sustained using an acceleration based upon the Ornstein-Uhlenbeck process [\citep=eswaranpope88] [\citep=federrathetal10], which is a stochastic process with a finite autocorrelation timescale that drives motion at low wave numbers. The driving force is constructed in Fourier space, allowing it to be decomposed into solenoidal and compressive components and for this case we only use the solenoidal component.

Detecting magnetic shocks

It is important to correctly capture shocks in the magnetic field for these simulations. However, the dissipation from the added artificial resistivity reduces the magnetic Reynolds number. Since molecular clouds are known to have high kinetic and magnetic Reynolds numbers ([formula]-109), it is important to reduce sources of numerical dissipation. Thus, a switch is used to "turn off" artificial resistivity in regions away from shocks. We found the switch proposed by [\citet=pm05] was not able to detect shocks while the magnetic field was weak, leading to significant noise in the magnetic field and spurious growth rates.

We have developed a new artificial resistivity switch [\citep=tp13] for this work, as described in §[\ref=sec:spmhddiss]. It sets [formula], which measures the relative degree of discontinuity in the magnetic field. In this way, it is able to detect and capture shocks throughout the several orders of magnitude change in magnetic field strength.

An important note about dissipation terms in SPMHD is that they are resolution dependent. The dissipation can be effectively halved by doubling the resolution of the simulation.

Turbulence results

The turbulence is simulated for 60 turbulent turnover times using the Flash code [\citep=flash] [\citep=flash3] at 1283 grid cells, and with the Phantom SPMHD code at 1283 and 2563 particles. The SPMHD simulations have been run for both artificial resistivity applied with a fixed αB = 1 parameter, and using the new artificial resistivity switch to reduce dissipation.

Renderings of the evolution of the z-integrated column density and magnetic field are shown in Figure [\ref=fig:turb-rendering] for the 2563 particle simulation using the new artificial resistivity switch. The structure in the magnetic field closely resembles the shock structures in the density field, which is to be expected since the magnetic field is weak. Even once the field is reaching saturation, shocks in the magnetic field are still driven primarily by the forcing though subtle differences start to become apparent.

The growth of magnetic energy as a function of time is shown in Figure [\ref=fig:turb-energy]. Comparable growth rates for 1283 grid cells can be achieved using either 2563 particles when applying fixed artificial resistivity everywhere, or at the same resolution of 1283 particles when using the new resistivity switch. Thus it can be concluded that using the new resistivity switch produces an effect similar to doubling the resolution.

The saturation level is in agreement between the Flash results and the SPMHD results when using a fixed artificial resistivity parameter. When using the new artificial resistivity switch to reduce magnetic dissipation, however, the saturation level for the SPMHD results are 2-3×   higher for both the 1283 and 2563 simulations.

Summary and discussion

In this work, we have performed Smoothed Particle Magnetohydrodynamic (SPMHD) simulations of the gravitational collapse of a prestellar core to form the first hydrostatic core, and also of magnetised Mach 10 turbulence, representative of conditions in molecular clouds. These simulations used the constrained hyperbolic divergence cleaning method [\citep=tp12] to maintain the [formula] constraint on the magnetic field. It is a Hamiltonian version of hyperbolic divergence cleaning [\citep=dedner02] that we have formulated for SPMHD through derivation from the discretised Lagrangian. Thus it possesses the conservation and stability properties inherent to SPH, and was found to reduce errors in the magnetic field by 10×  .

The collapsing core simulations [\citep=ptb12] produced a slow, well collimated jet from the central object that has properties consistent with candidate observations of first hydrostatic cores. It is efficient at removing mass out of the core, with up to 40% of the material being removed by the time the remaining mass in the core has been accreted onto the central sink particle.

Our simulations of Mach 10 magnetised turbulence model dynamo amplification of the magnetic field through the conversion of turbulent energy into magnetic energy. An initially weak magnetic field is present which was exponentially increased ~   10 orders of magnitude in energy until it reaches saturation. Both the saturation level and growth rates were consistent with results from the grid based code Flash when using a fixed artificial resistivity parameter. Simulations were also run using a switch for artificial resistivity to reduce numerical dissipation [\citep=tp13], which lead to similar growth rates as if double the resolution had been used, but with a saturation level 2-3×   higher.

T. Tricco thanks the conference organisers for the opportunity to speak. T. Tricco is supported by Endeavour IPRS and APA postgraduate research scholarships. We are grateful for funding via Australian Research Council Discovery Projects grants DP1094585 and DP110102191. This research was undertaken with the assistance of resources provided at the Multi-modal Australian ScienceS Imaging and Visualisation Environment (MASSIVE) through the National Computational Merit Allocation Scheme supported by the Australian Government. The Flash simulations were run at LRZ (grant pr32lo) and JSC (grant hhd20).