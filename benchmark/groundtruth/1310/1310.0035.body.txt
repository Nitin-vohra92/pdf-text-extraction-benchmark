Identical inferences about correlated evolution arise from ancestral state reconstruction and independent contrasts

Introduction

Statistical methods for the detection of correlated evolution have been divided into two broad classes. Directional methods involve reconstruction of ancestral states followed by statistical inference based on the deviation in trait values along each branch of a phylogenetic tree, while nondirectional or cross-sectional methods involve comparisons of trait values across taxa rather than along branches [\citep=HarveyPagel1991] [\citep=Pagel1993]. Methods arising from the Brownian motion model, in which traits evolve over time by accumulating increments drawn from a symmetrical zero-centred distribution with fixed variance, include both directional approaches such as reconstruction of ancestral states under maximum likelihood or squared-change parsimony criteria [\citep=Maddison1991] [\citep=Pagel1993] [\citep=McArdleRodrigo1994] [\citep=Schluteretal1997] and nondirectional approaches such as independent contrasts [\citep=Felsenstein1985] [\citep=Garlandetal1992] and phylogenetic generalized least squares [\citep=Grafen1989] [\citep=MartinsHansen1997].

It is well known that all methods based on the Brownian motion model are ultimately means of estimating the same model parameter, namely the variance of the Brownian process underlying trait evolution [\cite=Pagel1993] [\cite=Pagel1997] [\cite=Rohlf2001] [\cite=Freckleton2012]. The mean squared standardized independent contrast across the internal nodes of a phylogeny is an estimator of this parameter, while the mean squared deviation of reconstructed trait value across the branches of a phylogeny is an estimator of half this parameter [\citep=Ackerly2009]. The close association of methods based on Brownian motion is further indicated by the facts that the phylogenetic mean trait value inferred under indendent contrasts is identical to the global maximum likelihood estimate of the root's trait value [\citep=Garlandetal1999] [\citep=Revelletal2008], that independent contrasts and phylogenetic generalized least squares models yield identical regression estimators for the slope and gradient of two correlated traits [\citep=Blombergetal2012], and that regression coefficients of bivariate data estimated under directional and nondirectional approaches are highly correlated [\citep=Pagel1997].

The primary reason to select one class of method over another is thus not that they measure different things but that their estimators exhibit different statistical properties that may be more or less desirable [\citep=Pagel1993]. In this sense, independent contrasts and phylogenetic generalized least squares models are generally favoured over ancestral state reconstruction. [\citet=Pagel1993] argues that independent contrasts are best suited to the problem of identifying evolutionary correlation coefficients, since directional methods based on a tree with n tips count evolutionary changes on 2(n - 1) internal branches, meaning that "half of the variation that a directional method calculates is redundant because it overlaps with variation already calculated" yielding "results that seem more stable than they actually are", whereas independent contrasts, based on values calculated at n - 1 internal nodes, "make use of all the variance in the data, but in a way that does not count any of it twice". [\citet=Ackerly2009] concurs with this view and adds that deviations in trait value occurring on internal branches of a phylogeny are not independent, since trait deviations associated with each sibling pair of branches depend on the value of the ancestral state at the pair's common ancestor. Based on an analysis of phenotypic change in a bacteriophage colony with known evolutionary history, [\citet=OakleyCunningham2000] advocate "the use of independent contrasts in addition to or instead of the more error-prone ancestral estimation procedures", error they ascribe to the existence of a directional bias in the polarity of trait change over time in their dataset. Directional tendencies in the evolutionary process have been shown to reduce the accuracy of ancestral state estimation in studies using fossil calibration to assess reconstruction quality [\citep=FinarelliFlynn2006] and the quality of ancestral state reconstruction has been challenged in general [\citep=Donoghueetal1989] [\citep=WebsterPurvis2002] [\citep=Slateretal2012].

It is shown here that independent contrasts and maximum likelihood ancestral state reconstruction not only estimate the same underlying Brownian rate parameter for a univariate trait, but also - in studies of correlated evolution - yield numerically identical regression estimators for the gradient and correlation coefficient of bivariate traits. As a consequence, inferences about correlated evolution derived from maximum likelihood ancestral state estimation are as valid as, and indeed identical to, those derived from independent contrasts procedures. We show that the independent contrast associated with a pair of sibling nodes in a phylogenetic tree can be expressed in terms of the Gaussian local likelihood function of the node that is the direct common ancestor of the pair. It thus transpires that the numerical calculations carried out in generating independent contrasts are identical to those carried out in maximum likelihood ancestral state estimation in both univariate and multivariate situations. One consequence of this finding is that novel formulae for independent contrasts can be derived for any model of trait evolution for which a local likelihood function can be defined, including non-standard models that deviate from classical neutral assumptions. As a demonstration we derive new formulae for independent contrasts appropriate for a Brownian motion model of trait evolution with directional drift, which, in a bivariate context, are shown to yield more accurate estimates of correlation coefficient and slope than standard independent contrasts when the underlying evolutionary process does in fact exhibit a directional tendency. These findings are discussed in the context of claims that ancestral state esimation is in some sense more error-prone than independent contrasts.

Methods

Our primary results depend on the standard Brownian motion likelihood function for a trait [formula] evolving over a rooted bifurcating phylogenetic tree such that the deviation in trait value along a branch of length t is normally distributed with variance proportional to t. Our formulae refer to a general node n whose child nodes are denoted i and j connected by branches of length ti and tj respectively, and whose parent node p is connected by a branch of length tp. Trait [formula] takes value xn at node n. The likelihood of an ancestral state assignment is given by:

[formula]

where φ(x;μ,σ) is the density of the Gaussian distribution (μ,σ) evaluated at x. Each node n is associated with a Gaussian global maximum likelihood function which describes the maximized likelihood of the tree conditional on the value of xn, denoted (,σ̂), and also with a Gaussian local maximum likelihood function describing the maximized likelihood of the subtree rooted at n condition on the value of xn, denoted (,σ̃).

In our results we derive new formulae for independent contrasts accommodating traits evolving under Brownian motion with directional drift. In order to assess the performance of these directional independent contrasts in comparison with standard independent contrasts in identifying the slope and correlation coefficient of a pair of continuous characters evolving with a directional tendency, simulation studies were performed on one thousand random Yule trees, each with a number of trips drawn uniformly from 40 to 400. For each tree, evolution was simulated under a bivariate Brownian motion model with random reduced major axis regression slope (drawn uniformly from 0.2-2), random correlation coefficient (drawn uniformly from 0.2-1) and random drift parameters [formula] and [formula] (drawn uniformly from 0-[formula] and 0-[formula]). The realized RMA regression slope and correlation coefficient were recorded, and then re-estimated, on the basis of tips data only, using standard independent contrast and directional independent contrasts as defined in Equation [\ref=eq:directionalIC] below.

Results

Supplement S1 shows that the standardized independent contrast between nodes i and j, (i,j) can be expressed as the sum of the squared directional (sensu [\citet=Pagel1993]) standardized deviations in local maximum likelihood ancestral state as follows:

[formula]

An estimator for the variance of an evolving trait [formula] based on global maximum likelihood ancestral state reconstruction is given by:

[formula]

while the covariance of traits [formula] and [formula] is given by

[formula]

Supplement S2 demonstrates that these variance and covariance estimators are numerically identical to the variance and covariance of the set of independent contrasts generated from the same phylogeny and data.

An estimator for the reduced major axis (RMA) regression slope between [formula] and [formula] based on maximum likelihood ancestral state reconstruction is given by

[formula]

Supplement S3 demonstrates that this regression gradient estimator is numerically identical to the RMA regression estimator based on independent contrasts, and that this identity also holds for ordinary least squares regression.

Equation [\eqref=eq:IC] can be used to generate formulae for independent contrasts appropriate for any model of trait evolution for which a local likelihood function can be defined. Supplement S4 derives formulae for a model of trait evolution with a directional tendency:

[formula]

where M is the mean directional drift per unit time (with M = 0 under standard independent contrasts) and where i and σ̃2i are estimated recursively from the tips to the root of the phylogeny according to

[formula]

[formula]

Supplement S4 also includes formulae for calculating the maximum likelihood ancestral state reconstruction under this model. The parameter M is typically not known a priori but is easily estimated by a linear search maximizing the likelihood of an ancestral state assignment (or, identically, minimizing the sum of squared contrasts). Results of simulation studies comparing performance of directional independent contrasts to standard independent contrasts in estimating correlation coefficient, RMA gradient and M are illustrated in Figures 1 and 2. While the directional model has generally been regarded as underidentified [\citep=Grafen1989] we find maximum likelihood estimates of M to be identified for phylogenies that are not perfectly balanced in both topology and tips data. Software for maximum likelihood estimation of M along with standardized directional independent contrasts has been made available at http://www.sfu.ca/ micke/dirpic.html.

Discussion

Maximum likelihood ancestral state reconstruction has often been regarded as a poor second cousin to nondirectional analysis of correlated evolution using independent contrasts of phylogenetic generalized least squares [\citep=Pagel1997] [\citep=OakleyCunningham2000]. Ancestral reconstruction has been regarded as more error-prone [\citep=OakleyCunningham2000], requiring fossil calibration to improve accuracy in the reconstruction of directional deviations in trait value [\citep=Donoghueetal1989] [\citep=WebsterPurvis2002] [\citep=Slateretal2012]. Independent contrasts, being nondirectional, have been considered more robust with respect to such sources of bias and error. In this paper we have shown that, to the contrary, regression estimators based on maximum likelihood ancestral state reconstruction are numerically identical to estimators based on independent contrasts. Previous authors have considered the calculation of ancestral states using independent contrasts to yield identical results as direct methods such as those of [\citet=Schluteretal1997] but "without the use of maximum likelihood". We have shown that the numerical calculations involved in calculating independent contrasts are in fact identical to those involved in fitting the maximum likelihood model and that the standardized independent contrast associated with a pair of nodes of a phylogeny can be expressed directly in terms of the Gaussian likelihood function at those nodes and their common parent. It has previously been proposed that maximum likelihood estimates yield too narrow confidence intervals, since there are twice as many branches in a phylogeny than there are internal nodes [\citep=Pagel1993] [\citep=Pagel1997]. We agree with [\citep=Ackerly2009] that this apparent overconfidence is wholly remedied by reducing the number of degrees of freedom in the calculation of confidence bounds by a factor of two when using ancestral state reconstruction, though this manipulation is not necessary to guarantee the identity of point estimates made by regression estimators under ancestral state reconstruction and independent contrasts. In the light of findings that regression estimators based on independent contrasts are also identical to those based on phylogenetic generalized least squares [\citep=Blombergetal2012], we conclude that all comparative methods based on the Brownian motion model of evolution yield identical inferences about the parameters of correlated evolution and are conceptually indistinguishable. Our response to claims that ancestral state reconstruction is error-prone is to point out that the ancestral states themselves are merely nuisance parameters of the model formulation. Cross-sectional methods simply embed this error into the values of independent contrasts themselves. In estimating summary statistics of these nuisance parameters, such as evolutionary rate or correlation coefficient, independent contrasts offers no advantage over ancestral state-based methods.

One useful implication of this model is that ancestral states under non-standard models of trait evolution contain useful information about correlation structure. Given the evidence that directional tendencies give rise to biased estimates of evolutionary model parameters, it may be useful to incorporate such tendencies directly into the model likelihood function. For those wedded to the idiom of independent contrasts, we have shown that Equation [\ref=eq:IC] can be used to generate novel formulae for independent contrasts when an appropriate likelihood function can be formulated. Specifically, we here present formulae for independent contrasts under directional drift (Equations [\ref=eq:directionalIC]-[\ref=eq:directionalIC3]) and show that these "directional independent contrasts" markedly improve estimation of correlation coefficient and slope (Figures 1 and 2).

More generally, ancestral state reconstructions of traits evolving under wholly non-Brownian statistical models [\citep=Landisetal2013] [\citep=ElliotMooers2013], which entirely invalidate the assumptions of independent contrasts and phylogenetic generalized least squares as currently formulated, still contain useful information about correlated evolution. Maximum likelihood fitting of ancestral states is a useful general strategy for complex models of trait evolution, it is appropriate to use these reconstructed states to make inferences about historical patterns and processes of correlated evolutionary change when cross-sectional methods such as independent contrasts are not available.

Acknowledgements

The author thanks NSERC and the Human Evolutionary Studies Program at Simon Fraser University for financial support, and members of the FAB* and HESP groups for their comments.

Supplementary Information

Introduction

Terminology

We consider a continuous biological trait [formula] evolving over a rooted bifurcating phylogenetic tree. At each node n, the biological trait has value xn. Each node n has two descendant nodes, i and j, unless n is a tip. Each node n has a parent node p, unless n is the root. The branch connecting node n to its parent has length tn.

Independent contrasts

Independent contrasts are calculated using an algorithm that traverses the phylogeny from tips to root, iteratively calculating transformed trait values [formula] and transformed branch lengths [formula] along the way. Following [\citet=Felsenstein1985] the independent contrast associated with node n, n, is defined as:

[formula]

where [formula] and [formula] when xn is known with certainty (for example when node n is a tip on the phylogeny associated with an empirically observed trait value) and otherwise

[formula]

Maximum likelihood ancestral state reconstruction

Consider a node n connected to its parent pn by a branch of length tn. The change in the value of the evolving trait along this branch, xn - xpn is normally distribution with mean zero and variance proportional to tn. The likelihood of the tree with respect to some candidate ancestral state reconstruction [formula] is given by the product of the normal distributions associated with each branch:

[formula]

where φ(x;μ,σ) is the probability density of the normal distribution mean μ and variance σ2. The task of maximum likelihood ancestral state reconstruction is to identify the [formula] which maximizes the likelihood function in [\eqref=eq:treeML].

Maddison (1994) notes that, in addition to the global maximum likelihood ancestral state reconstruction [formula], there exists a local maximum likelihood ancestral state reconstruction [formula] such that each n is the ancestral state maximizing the likelihood of the subtree rooted at node n. Since [\eqref=eq:treeML] is a product of normal distributions, the local likelihood function at node n is also a normal distribution which we denote (n,σ̃n). Evidently the local maximum likelihood estimate of n must be equal to n. The parameters n and σ̃n for each n can be estimated in a traversal from the tips of the phylogeny to its root. For each tip t of the phylogeny with known trait value xt, we have μt = xt and σt = 0 if the tip trait value is known with certainty or a nonzero value if the tip trait's distribution is known. For each internal node n with two children i and j connected by branches of length ti and tj, the local likelihood function with respect to xn is given by the product of the local likelihood functions at i and j suitably weighted by the branch lengths under the Brownian assumption of additive variance:

[formula]

from which the values of n  =  n and σ̃n can be read off.

Similarly we denote the maximum likelihood function at node n with respect to xn as (n,σ̂n). As mentioned above, root = root and σ̂root = σ̃root. For other nodes of the phylogeny for which the maximum likelihood function must be estimated, we follow a similar logic to obtain:

[formula]

from which the values of x̂n  =  n and σ̂n can be read off.

We note that Maddison (1994) has described a similar two-pass algorithm based on the quadratic function describing the sum of squared deviations in trait value on the phylogeny, a method yielding identical local and global ancestral state estimates resulting from somewhat more complex formulae. The distributional approach described above has the benefit of directly yielding confidence intervals based on σ̂n for each node n.

Results

Independent contrasts can be expressed in terms of the local maximum likelihood ancestral state reconstruction

Consider Equation [\eqref=eq:ICtn]. When calculating independent contrasts by traversing from the tips to the root of a phylogeny, each branch is extended by a factor of

[formula]

a term which is strikingly similar in form to the variance of the local maximum likelihood function at node n defined in Equation [\eqref=eq:localPhi2] as σ̃2n:

[formula]

Indeed if we grant that each tip t of the phylogeny has a fixed point estimate of xt, with σ̃t  =  0, then for any node whose children are tips we have

[formula]

and this identity will hold for all branches since the left side of the equation, like the right side, is additive down the the phylogeny and stored as a constant factor in the transformed branch lengths (under independent contrasts) or in the variance of the local maximum likelihood function (under maximum likelihood reconstruction), resulting in the equality:

[formula]

Note that the formula for [formula] given in Equation [\eqref=eq:ICxn] simplifies to:

[formula]

which is strikingly similar in form to the mean of the local maximum likelihood function at node n defined in Equation [\eqref=eq:localPhi2]:

[formula]

By substituting according to equation [\eqref=tnprime_in_terms_of_tildesigma] we obtain:

[formula]

Again, since [formula] for any tip with fixed trait value, by induction on Equation [\eqref=eq:ICxn_simplified] it follows that

[formula]

for general n.

Equations [\eqref=tnprime_in_terms_of_tildesigma] and [\eqref=xnprime_in_terms_of_tildemu] provide a fundamental connection between maximum likelihood ancestral state reconstruction and independent contrasts, permitting us to represent an independent contrast at node n in terms of the local maximum likelihood function. By substituting into [\eqref=eq:IC] we obtain:

[formula]

The sum of squared independent contrasts over a phylogeny is identical to the sum of squared deviations over a phylogeny imputed by the global maximum likelihood ancestral state reconstruction

Since the local likelihood function at node n is a normal distribution with mean n, the local maximum likelihood ancestral state estimate is n  =  n, a quantity which generates the following sum of squared deviations in the evolving trait on branches leading from n to its children:

[formula]

By substituting [\eqref=eq:tildemun] we obtain:

[formula]

Since, at the root, the local likelihood and sum of squares is equal to the global likelihood and sum of squares, and given that the sum of squared deviations derived from the pair of branches descending from any node is identical to the squared independent contrast, we obtain:

[formula]

Regression estimators derived from maximum likelihood ancestral state reconstruction and from independent contrasts yield identical estimates of slope and correlation coefficient for bivariate traits evolving under Brownian motion

Reduced major axis and ordinary least squares estimators for slope and correlation coefficient depend solely on the variance and covariance of the variables subject to regression analysis. The variance of trait [formula] given a maximum likelihood ancestral state reconstruction [formula] is given by

[formula]

where the phylogeny has t tips and 2t - 2 is the number of edges. The variance based on independent contrasts is:

[formula]

because two branches are consumed by each independent contrast. For this reason [formula] is exactly twice as large as [formula]. It can be shown using Equation [\eqref=eq:ICn_in_terms_of_tilde_mu_ij] and the same line of reasoning that the covariance [formula] is also exactly twice as large as [formula].

Due to cancelling out of the denominators in the variance terms, the correlation coefficient based on independent contrasts, ρIC, is identical to that based on maximum likelihood ancestral state reconstruction, ρML:

[formula]

Similarly, the ordinary least squares regression slope estimators based on independent contrasts and maximum likelihood ancestral state reconstruction are also identical:

[formula]

as are the reduced major axis regression slope estimators:

[formula]

Independent contrasts for Brownian motion with a directional tendency

The standard Brownian motion model of continuous character evolution has zero mean such that the expected value of a trait after a period of evolution of duration t is equal to the value of the trait prior to the period of evolution. A directional tendency to the evolutionary process can be modelled in terms of a nonzero mean M, such that the expected value of a trait after a period of evolution of duration t is equal to tM. By modifying Equation [\eqref=eq:localPhi2] appropriately it is trivial to incorporate the directional tendency into the model described previously. In a traversal from the tips of the tree to the root we define the local likelihood function for each internal node:

[formula]

[formula]

and calculate a phylogenetically independent contrast incorporating directional tendency:

[formula]

Substituting [\eqref=tildemun_directional] into [\eqref=eq:directionalPC] we obtain:

[formula]

For the sake of completeness, we here also define the maximum likelihood function for each node, which can be calculated in a second traversal from the root of the phylogeny to its tips in order to obtain maximum likelihood ancestral states under a directional tendency:

[formula]

[formula]

Given some value of M it is thus possible to calculate a set of phylogenetically independent contrasts for a trait evolving with directional tendency. The value of M is typically not known, but is easily estimated from the data by conducting a linear search to identify the [formula] which minimizes the sum of squared contrasts or maximizes the global likelihood of the model.