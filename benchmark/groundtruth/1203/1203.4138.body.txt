Lemma Corollary Proposition

Definition Example

Remark

Affine semigroups having a unique Betti element

Introduction

An affine semigroup is a finitely generated submonoid of [formula] for some positive integer r, where [formula] denotes the set of nonnegative integers. Thus any affine semigroup is cancellative ([formula] implies [formula]), reduced (its only unit is 0, the identity element), and torsion free ([formula] for k a positive integer implies that [formula]). In fact the converse is also true by Grillet's theorem: if S is a finitely generated cancellative, reduced, torsion free monoid, then it is an affine semigroup (see for instance [\cite=RGS99]).

Every affine semigroup is finitely presented, and this means, that it can be described by a finite presentation: a finite set of 'free' generators and a finite set of relations among them. The elements whose factorizations are involved in the relations of a minimal presentation are called Betti elements (since from them one can compute the minimal free resolution of the semigroup ring associated to the monoid).

In this manuscript we study affine semigroups having just one Betti element. It turns out that these monoids have a flower shape, since they are the gluing of several free monoids (in the categorical sense, that is, semigroups that are isomorphic as monoid to [formula] for some s), and these monoids, the petals, are glued by a single element, the stem (see Theorem [\ref=Th.Main]). The concept of gluing and its basic properties are recalled in Section [\ref=sec:unico-betti]. For numerical semigroups we are able to give a characterization in terms of the minimal generating set, which allow us to construct as many examples as we like.

Recently, several manuscripts take advantage of minimal presentations to compute non-unique factorization invariants. We show in the last section how to compute the elasticity, the maximum of the Delta set, the catenary and tame degree, and the ω-invariant of any affine semigroup with a single Betti element. As a consequence we obtain that the last three invariants in this list coincide (see Theorem [\ref=Th.Main2]), as for monoids having a generic presentation (see [\cite=BGSG]).

Affine semigroups with a single Betti element

Let S be an affine semigroup minimally generated by [formula], that is to say, [formula] and no proper subset of A generates S. Let A denote the r  ×  p - integer matrix whose columns are [formula] The monoid map

[formula]

is sometimes known as the factorization homomorphism associated to A. For every [formula], the set [formula] is the set of factorizations of [formula].

Let [formula] be the kernel congruence of πA, that is, [formula] if [formula], or equivalenty, [formula] and [formula] are factorizations of the same element in S. Notice that S is isomorphic to the monoid [formula].

Given [formula], the congruence generated by σ is the least congruence on [formula] containing σ. If [formula] is the congruence generated by σ, then we say that σ is a presentation of S. Rédei's theorem (see [\cite=Redei]) states that every finitely generated monoid is finitely presented. A presentation for S is a minimal presentation if none of its proper subsets generates [formula]. In our setting, all minimal presentations have the same cardinality ν(S) (see for instance [\cite=RGS99]). It is well known that [formula] and S is said to be a complete intersection if the equality holds.

Moreover, given a minimal presentation σ for S, the set

[formula]

does not depend on σ (see for instance [\cite=RGS99]). Following [\cite=uniquely], we will write (S) for the above set and we will say that [formula] is a Betti element of S. Notice that [formula] if and only if S is a free affine semigroup. Every free affine semigroup is a complete intersection with ν(S) = 0. In particular, free affine semigroups are complete intersections.

For an element [formula], we define its support as the set [formula]. Notice that [formula] and [formula] have disjoint support if and only if the usual dot product [formula] equals zero. We emphasize that a necesary (but not sufficient) condition for a presentation σ for S to be minimal is that [formula] and [formula] have disjoint support and [formula] for every [formula] (see, e.g., [\cite=RGS99]).

Let [formula] be such that [formula]. Assume that [formula]. Let [formula].

[formula] if and only if [formula].

For every i  ≠  j, [formula].

There exists [formula], [formula] and [formula] with [formula], such that for every [formula], [formula], for some [formula], with [formula]. If [formula], then a > 0.

(a) Assume that [formula] for some [formula]. Take [formula]. Since [formula], there exists [formula]. Hence [formula]. Conversely, if [formula], then [\cite=uniquely], forces [formula].

(b) Suppose on the contrary that there exists [formula] and [formula] with [formula] Let [formula] Then [formula] and [formula] (because [formula]), in contradiction with the preceding statement.

(c) If [formula], we are done by taking [formula] and [formula]. Otherwise, from the proof of [\cite=uniquely], there exists [formula] such that [formula]. Let [formula] thus we have [formula] and [formula] So by repeating the above argument as many times as needed we obtain [formula] with [formula] for some [formula] and [formula] with unique factorization. This process stops since [formula] in [formula] and there are no infinite descending chains with respect to <  .

Let us see that a and [formula] (and thus [formula]), depend exclusively on [formula]. Notice that [formula]. If [formula] with [formula] and [formula] with unique factorizations, then [formula]. This leads to [formula], which contradicts the fact that [formula] has a unique factorization (1).

Gluings

Let A1 and A2 be disjoint nontrivial subsets of A such that [formula]. Set S1 and S2 to be the affine semigroups generated by A1 and A2, respectively. We say that S is the gluing of S1 and S2 if there exists [formula] such that [formula], where [formula] stands for the subgroup of [formula] generated by A (and [formula] is the set of integers). We also say that S is the gluing of S1 and S2 by [formula].

If S is the gluing of S1 and S2, then ν(S)  =  ν(S1)  +  ν(S2)  +  1.

See [\cite=Ro97].

As an easy corollary of this result, we obtain the following (see [\cite=fischer97]).

Let S be the gluing of S1 and S2. If S1 and S2 are complete intersections, then S is a complete intersection.

It is also known what are the Betti elements of a gluing.

If S is the gluing of S1 and S2 by [formula], then [formula]

See [\cite=uniquely].

Let S be the subsemigroup of [formula] generated by the columns of

[formula]

Clearly, S is the gluing of [formula] and [formula] by [formula] Since [formula] (because both semigroups are free) we obtain that [formula] by Proposition [\ref=Th10.uniquely]. Now, by Proposition [\ref=Th1.4.Ro97], any minimal presentation of S has cardinality 1. So, we conclude that [formula] is a minimal presentation of S.

Primitive elements

Let I(A) be the set of irreducible elements (atoms) of [formula], that is, the set of minimal elements of [formula] with respect the usual partial order on [formula]. The set I(A) generates [formula] as a monoid ([\cite=RGS99]). Denote by [formula], which is known as the set of primitive elements of [formula] or the Graver basis of A. This set generates [formula] as a congruence, it actually contains every minimal presentation of [formula] (see, e.g. [\cite=Sturmfels]).

Circuits

A nonzero element [formula] in the kernel congruence of πA is called a circuit of [formula] if [formula] and [formula] have disjoint support, [formula] is minimal with respect to inclusion, and the coordinates of [formula] are relative prime. The set of circuits of [formula] is denoted by CA. It is worth to be noted that the circuits of [formula] can be computed by using elementary linear algebra (see the proof of [\cite=Sturmfels]).

Now we are in a position to state our main theorem:

Let S be an affine semigroup minimally generated by [formula], and let [formula] be nonzero. The following are equivalent:

[formula].

[formula].

S is gluing of some S1 and S2 by [formula] with [formula].

Notice that as a consequence of second equality in (b), we also obtain that [formula] for every [formula] (since otherwise [formula] would not be a circuit).

We will prove

[formula]

The inclusion [formula] is well known, see [\cite=Sturmfels].

Now take [formula]. By Proposition [\ref=prop-unificadora] (c), applied to [formula] and [formula], there exists [formula] such that [formula]. The minimality of a primitive element with respect to the usual partial order, forces [formula]. This proves that [formula].

Let [formula]. By the minimality of the supports of the elements of CA, there exists [formula] such that [formula]. Since we already know that [formula], and Propositon [\ref=prop-unificadora] asserts that any two different factorizations of [formula] have disjoint support, we conclude that either [formula] and [formula], or [formula] and [formula]. Notice that [formula] is again a circuit, and this shows that [formula].

Let [formula]. Clearly, [formula] is also a system of generators of [formula] as a congruence. Let [formula], and [formula]. Set S1  =  〈A1〉 and S2  =  〈A2〉. Then [formula] is of the form [formula] with no pair in σ having common support with [formula] (due to Remark [\ref=soportes_disjuntos]). Hence [\cite=Ro97], implies that S is the gluing of the (free) semigroup S1 and S2.

It follows easily from Proposition [\ref=Th10.uniquely].

Let A be the incidence matrix of the complete graph K4, that is to say,

[formula]

and let S be the subsemigroup of [formula] generated by the columns of A. It is easy to see that S is the gluing of S1,S2 and S3 by [formula] where S1 is the free semigroup generated by the first and sixth columns, S2 is the free semigroup generated by the second and fifth columns and S3 is the free semigroup generated by the third and fourth columns. So, by Theorem [\ref=Th.Main], S has a unique Betti element, in this case, [formula]

There are important families of affine semigroups that satisfies the equality [formula] for instance, affine semigroups generated by the columns of r  ×  p - unimodular matrices have this property (see, [\cite=Sturmfels]). Nevertheless, the condition [formula] is not sufficient for a semigroup to have a unique Betti element as the following example shows:

The incidence matrix A of the graph:

is a 6  ×  7-unimodular matrix. If S is the subsemigroup of [formula] generated by the columns of A, then [formula] (see [\cite=KaTh] for the details).

From the results in [\cite=Ka11], it follows that the only affine semigroup defined by the incidence matrix of a graph having a unique Betti element is the semigroup associated to K4 (see Example [\ref=example_K]).

Let [formula] be nonzero. If [formula] then

CA is a presentation of S.

S is the gluing of [formula] free affine semigroups.

S is a complete intersection.

(a) It follows directly from the definition of [formula] and the implication (a) ⇒   (b) in Theorem [\ref=Th.Main].

(b) By using recursively the implication (b) ⇒   (c) in Theorem [\ref=Th.Main], we obtain that S is a gluing of free semigroups. More precisely, if [formula] then S is the gluing of [formula] where Si is the semigroup generated by [formula] and Sn the semigroup generated by [formula].

(c) Our claim follows from part (b), by Corollary [\ref=Cor1.4.Ro97].

From Proposition [\ref=prop-unificadora] (b) and [\cite=RGS99] it also follows that if [formula], then every minimal presentation of S is of the form [formula], where I is the set of edges of any spanning tree of the complete graph on the vertices [formula].

Numerical semigroups with a single Betti element. A numerical semigroup is a submonoid of [formula] with finite complement in [formula]. It follows that gcd (S) = 1. Any submonoid M of [formula] is isomorphic to a numerical semigroup, since it suffices to divide its elements by the greatest common divisor of M (see [\cite=libro-ns]). Every numerical semigroup has a unique minimal system of generators, which is always finite (see for instance [\cite=libro-ns]). Thus any numerical semigroup is an affine semigroup.

Let S be a numerical semigroup minimally generated by [formula], p  ≥  2. Set

[formula]

Notice that

[formula]

Moreover if [formula] then the minimality of ci implies [formula] and [formula] for every j  ≠  i.

The following conditions are equivalent.

The set [formula] is a singleton.

There exists [formula] pairwise relatively prime integers greater than one, such that [formula] for all [formula].

Furthermore, if this is the case, [formula] and [formula].

Let [formula]. By Theorem [\ref=Th.Main] (a) ⇒   (b), we deduce that [formula] Moreover, since [formula] and ci divides nj for every i  ≠  j, we conclude that [formula]

We use induction on p. The case p = 2 follows trivially. Observe that [formula]. If we set S1  =  〈n1〉 and [formula], then [formula]. We obtain that S is the gluing of the monoids S1 and S2. By induction hypothesis, [formula] has a unique Betti element (observe that if d' is the only Betti element of S', then [formula]). Define [formula]. By Theorem [\ref=Th.Main] (a) ⇒   (b), we obtain [formula]. Hence [formula]. Notice also that [formula]. By the definition of c2', c2'  ≤  k2. Besides, [formula], and since gcd {k2,k3} = 1, we deduce that k2 divides c2'. Hence c2' = k2. In the same way, one proves that ci' = ki for [formula]. Now by Proposition [\ref=Th10.uniquely], we have that [formula].

In the context of toric ideals, a proof of the implication 2 ⇒   1 can be found in [\cite=KaOj].

As as consequence of the equivalence 1 ⇔   2, we can construct as many examples of numerical having just one Betti element as we like: it suffices to take p relatively prime positive integers, and then take the numerical semigroup (minimally) generated by the products of all p - 1 subsets with p - 1 elements. For instance, if c1  =  7,c2  =  5,c3  =  3 and c4  =  2, the numerical semigroup S generated by n1  =  c2c3c4  =  30,n2  =  c1c3c4  =  42,n3  =  c1c2c4  =  70 and n4  =  c1c2c3  =  105 has only one Betti element, d  =  210. A minimal presentation for S is [formula]

Non-unique factorization invariants

We next compute some non-unique factorization invariants for affine semigroups with a single Betti element. We recall their definitions here, though in same cases we present a simplified version that fits in our scope. The interested reader in these invariants is referred to [\cite=GHKb].

Throughout this section, S will denote an affine semigroup minimally generated by [formula]

Given [formula] and [formula] set [formula] and define the set of lengths of [formula] as [formula]

Let [formula]. If [formula] then there exist a and [formula] such that for every [formula]

[formula]

By Proposition [\ref=prop-unificadora] (c), [formula] for some [formula] and [formula] So, it suffices to take [formula] and [formula] (recall that a and [formula] depend exclusively on [formula]).

Notice that, with the above notation, if [formula] and [formula] there exists [formula] such that [formula] Otherwise, [formula] will have more than one factorization.

The elasticity of [formula] is defined as [formula], and the elasticity of S is

[formula]

The following result can be deduced from [\cite=atomicos] and Theorem [\ref=Th.Main], we include an alternative (and straightforward) proof for the single Betti element setting.

If [formula] then [formula]

Let [formula] By Lemma [\ref=lemma-key-fact], there exist a and [formula] such that [formula] and [formula] Therefore,

[formula]

and the claim follows.

Let [formula] Since [formula] is finite, we can write [formula] With this notation, the delta set of [formula] is [formula] and the delta set of S is the union of the delta sets of the elements in S, in symbols,

[formula]

It is known that the maximum of the delta set of S is reached in the Betti elements of S (see [\cite=delta]); therefore, if [formula] then

[formula]

For [formula] and [formula] we define [formula] Notice that [formula] and [formula] lie in [formula] and this is the largest element in [formula] fulfilling this condition with respect to the usual partial ordering on [formula]

Let [formula] be such that

[formula]

It is not difficult to see that [formula] is actually a metric in the topological sense (see [\cite=GHKb]).

The catenary degree of [formula] is the minimum [formula] such that for any s∈S and for any [formula] there exists a sequence [formula] such that

[formula] and [formula],

[formula].

The ω-primality of S, ω(S), is the minimum of all [formula] such that for every minimal generator [formula], if [formula], with [formula] for all i∈I, then there exists Ω  ⊆  I with #  Ω  ≤  N such that [formula].

The tame degree of S, [formula], is the minimum of all [formula] such that for all [formula], [formula] and every minimal generator [formula] such that [formula], there exists [formula] such that [formula] and [formula].

Next we prove that for affine semigroups with a single Betti element, the catenary and tame degrees coincide with the ω-primality as occurs in the generic case ([\cite=BGSG]). We can also give an explicit value for these invariants.

Let S be an affine semigroup minimally generated by [formula] If [formula] then

[formula]

By [\cite=Ge-Ka10a], [formula], and from [\cite=Ge-Ha08a], [formula]. Hence

[formula]

Let [formula] By Proposition [\ref=prop-unificadora] (c), [formula] Therefore, given [formula] such that [formula] we have that [formula] for every sequence [formula] satisfying (a) and (b) in Definition [\ref=Def.catenary]. Therefore,

[formula]

Finally, for all [formula], [formula] and every minimal generator [formula] such that [formula], if [formula] there exists [formula] such that [formula] and [formula] Indeed, by Proposition [\ref=prop-unificadora], [formula] for some [formula] and [formula] Since [formula] there exists k such that [formula] (in particular, αk  =  0). Now, if [formula] is such that αl  ≠  0, by taking [formula] we are done.

So, either [formula] or [formula], and consequenly the minimality of [formula], yields

[formula]

The proof now follows from ([\ref=desigualdades]).

In [\cite=catenary] it is shown (though with a different notation) that the catenary degree of S depends only on the catenary degree of the Betti elements of S, and that the tame degree can be computed from the factorizations of the elements involved in [formula]. In view of Theorem [\ref=Th.Main], if S has a single Betti element, then the only element whose factorizations appear in [formula] is precisely this single Betti element. By using this fact one could have give an alternative proof to Theorem [\ref=Th.Main].