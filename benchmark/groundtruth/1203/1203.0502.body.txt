[formula]

Identifying influential spreaders and efficiently estimating infection numbers in epidemic models: a walk counting approach

Joseph T. Lizier

Introduction

Epidemic spreading in biological, social, and technological networks has recently attracted much attention (see for instance [\cite=Cohen01] [\cite=Albert00] [\cite=Pastor-Satorras01] [\cite=Dodds04] [\cite=Chen2011] [\cite=Newman02] [\cite=Chung09]). Most of these studies focus on the following question: Assume that we first infect a randomly chosen individual of the network (patient zero) - how likely is it that a substantial part of the network will be infected? In these earlier approaches the network was considered as a whole and the role of patient zero on the disease spreading process was neglected.

In this letter, we consider the role a single individual plays in the spreading process rather than the global properties of the network. It is of particular interest to identify the most influential spreaders, and to do so without expensive simulations. This knowledge could, for instance, be used to prioritise vaccinations for the most influential spreaders. The number of neighbours of an individual is a simple but crude approximation for an individual's influence, and one has to take further topological properties of the network into account to understand the spreading process adequately [\cite=Kitsak10] [\cite=klemm11a]. As such, [\cite=Kitsak10] [\cite=Chen2011] [\cite=klemm11a] propose different inference measures for a node's spreading influence such as the k-shell decomposition, the local centrality measure or eigenvector centrality. All of these approaches show strong correlations between their measure of influence and the (simulated) number of infected nodes. There is potential for improvement however in: i. considering network features encountered by longer infection walks, and ii. addressing the ultimate goal of estimating the expected number of infections rather than merely obtaining correlations. Importantly, one can only predict whether an infection will be epidemic (i.e. a large portion of the network will be infected) or harmless from an estimate of infection numbers, not from correlation scores of an inference method alone. In this letter, we present an approach based on counting the number of potential infection walks from a given initially infected individual. Our method overcomes the above issues and allows us to consistently estimate with very good accuracy the expected number of infections from each patient zero. Moreover, our method is very efficient and has low computational costs.

The general model

We consider epidemic spreading on network structures. A complex network can be identified with a graph Γ = (V,E) (here V is the vertex and E is the edge set) in an obvious way. We say that i and j are neighbours, in symbols i  ~  j, if they are connected by an edge. In general, we deal with undirected graphs, though our formulae are trivially extended for the directed case. Often it is convenient to describe a graph by its adjacency matrix [formula] where the matrix element aij  =  1 if i and j are neighbours and zero otherwise, and |V| is the number of vertices. Furthermore, [formula] denotes the (out) degree of the vertex i. First we consider a generalization of the SIS (susceptible/infected/susceptible)-model and the SIR (susceptible/infected/removed)-model. In our model a disease is spread in a network through contact between infected (ill) individuals and susceptible (healthy) individuals. At a given time step, each infected individual will infect each of its susceptible neighbours with a given probability 0  ≤  β  ≤  1 (for simplicity we assume that β is the same for all pairs of vertices - however generalization to variable βij is straightforward). An infected individual will be removed from the network with probability (1 - λ) (modelling either death or full recovery with immunity); otherwise, an infected individual remains in the network with probability λ and remains susceptible to (re)infection at the (very) next time step. For λ = 0 and λ = 1 this model reduces to the SIR and SIS model, respectively.

For a given network, we want to find the expected number of infections given the person that was infected first. It is natural to think of the spreading process in terms of infection walks in the corresponding graph. The degree of a vertex is a first indicator of how many individuals it will infect, however this neglects all infection walks of length greater than one - see also [\cite=klemm11a] where the role of longer infection walks in epidemic spreading is discussed and numerical simulations were performed. Moreover such walks play a very important role in the dynamics of complex networks. In the following we will show that it is crucial to also take longer infection walks into account in order to get precise results.

The probability p(i,j,k) that vertex j is infected through a walk of length k given that the infection started at vertex i can be written as

[formula]

where [formula] is the probability that vertex j is infected at time k given that vertex j is susceptible at time k, and [formula] is the probability that vertex j is susceptible (i.e. not removed) at time k, both given that the infection started at vertex i. (We refer to time here since the spreading process is updated at discrete time steps; hence it is equivalent to say that vertex j is infected through a walk of length k or infected at time k).

For general graph topologies it is difficult and expensive to calculate the p(i,j,k) exactly. In the subsequent analysis we show how each of [formula] and [formula] in turn can be approximated when we make the following reasonable simplification assumption: We assume that all infection walks (of the same as well as different lengths) are independent of each other, i.e. we treat them as if they have no edges in common. As our simulation results indicate, this is a reasonable approximation. Using this independent walk assumption, we approximate:

[formula]

P(i,j,k) is the set of all walks from i to j of length k and p(Pm) is the probability that the infection takes place along the walk Pm. This formula is easily obtained by noting that [formula] is the probability that j is not infected at time k given that it was susceptible and that the infection started at vertex i. It is insightful to rewrite the last equation in the following form:

[formula]

where sk,lij is the number of walks from i to j of length k with l repeated vertices, i.e. the number of walks consisting of k + 1 - l different vertices (including i and j).

Let us have a closer look at the relationship between [formula] and [formula]. To properly compute [formula], one must compute infection probabilities on each walk Pm in some order, and properly condition these infection probabilities on those of overlapping previously considered walk in [formula]. This leads to properly conditioned infection probabilities [formula] and the expression:

[formula]

Now, if infection has not already occurred on one of these previously considered walks [formula], then [formula] only differs from [formula] where Pm has any overlapping edges with [formula]. Since infection did not occur on any of these walks with shared edges, then some of the shared edges for the walk Pm may in fact already be closed (i.e. dropping [formula] below p(Pm)). This yields:

[formula]

i.e. the independent walk assumption leads to an overestimation of [formula].

Let us now study [formula] in more detail. We introduce [formula], (see footnote [\ref=fn:discretisationDifference]) i.e. the probability that vertex j is removed at time k given the infection started at vertex i. For all t  ≥  1, we have:

[formula]

[formula]

Summing ([\ref=eq:psucUpdateRelation]) over all t from 1 to k - 1 we obtain:

[formula]

where we used [formula]. As before, we use the independent walk assumption to approximate [formula] by [formula], and also p(i,j,k) by q(i,j,k) where we define:

[formula]

So by analogy to ([\ref=eq:psucFromP]) we define:

[formula]

We observe that [formula] satisfies an equation similar to ([\ref=eq:psucUpdateRelation]):

[formula]

We then consider the connection between [formula] and [formula]. In order to investigate this we note that walks of length one and two always satisfy the independence assumption. Hence we have [formula] and [formula] for k = 1,2.

Now we will prove by induction that [formula] for all t. First we assume this is true for t  =  k (as demonstrated for k = 1,2 above). Then considering t  =  k  +  1, combining ([\ref=eq:p_i_j_k]) and ([\ref=eq:psucUpdateRelation]) we have:

[formula]

where we used ([\ref=eq:plessq]) and our inductive assumption [formula]. Hence we conclude that:

[formula]

That is, we systematically underestimate the probability [formula] of being susceptible. Together with the observation that we systematically overestimate the probability of being infected in ([\ref=eq:plessq]), these opposite effects of our independent walks assumption may balance each other in ([\ref=eq:q_i_j_k]).

We define the impact of vertex i (the estimated number of infections given that vertex i was infected first) as

[formula]

Ii counts the total number of infections, and so is not required to converge if λ  >  0 since then some of the vertices might be infected several times. Alternatively some other studies define outbreak size as the number of nodes infected at least once, though this does not inform one as to whether the infection will die out or not. (Note that if the nodes cannot be infected several times, i.e. for the SIR model, both aforementioned quantities coincide.) It is easy to verify that in considering only walks of length 1, the impact of vertex i is Ii(L = 1) = βdi. This shows that the degree di of vertex i is the first order approximation of the impact Ii. In order to calculate the q(i,j,k) we need to know all the sk,lij. The calculation of sk,lij from i to all j can be completed in O(Dk) steps (average case of counting walks along homogeneous out-degree D nodes with independent edges), and is the computational-time bottleneck for our method. (We propose later an asymptotically more efficient calculation for the SIS case). Crucially, while this asymptotic scaling is the same as for simulating the disease spreading process, the constant factor of proportionality for our technique is smaller by several magnitudes.

In the following, we restrict ourselves to the special cases λ  =  0,1 where we obtain the SIR and SIS models.

The SIS-model

The SIS model corresponds to the case λ = 1, i.e. where infected nodes always become susceptible again (i.e. do not die or become immune). Examples of SIS-type disease spreading include computer viruses and pests in agriculture where the individuals (computer/crops) do not develop immunity against the disease and hence can be re-infected again.

To compute [formula], one has to count the number skij of different walks of length k between i and j, i.e. the number of possible infection walks with any number of repeated vertices l. Crucially, skij is given by the ij-th entry of the k-th power Ak of the adjacency matrix A, which is computed in low-order polynomial time, making our method asymptotically much more efficient than simulations for the SIS special case. By equation ([\ref=pk]) the probability p(i,j,k) that j is infected by i through a walk of length k is then approximated by (with λ = 1):

[formula]

where we used [formula] since λ = 1 here. We obtain:

[formula]

(using 00 = 1 by convention if we allow β = 1). Again we point out that this expression might not converge (particularly if β is too large) since individuals can be infected several times. Such divergence has a meaningful interpretation: i.e. that the infection will remain forever in the network and will not die out. In [\eqref=eq:ISIS] we take arbitrarily long walks into account since the vertices cannot develop immunity against the disease and so no upper bound for the maximal length of an infection walk exists.

For other diseases it is more natural to assume that the vertices can develop immunity after infection.

The SIR-model

The SIR model corresponds to the case λ = 0, i.e. where infected nodes never become susceptible again after infection as the individuals develop immunity or die. As far as infection spreading is concerned, they are considered removed (i.e. they cannot spread the virus, nor be reinfected). Examples of SIR-type disease spreading include most diseases spread among humans. Since a vertex cannot be infected twice, we have to modify our previous considerations appropriately. Instead of general walks we now have to consider self-avoiding walks (SAWs) or paths. Indeed, it has been previously suggested that an understanding of SAWs would be useful in epidemiology [\cite=eub05], though this was not properly investigated. It is well known that, compared to counting walks, it is much more difficult to count SAWs in a graph [\cite=Madras93]. However, instead of explicitly calculating the number of SAWs one can obtain the number of SAWs recursively [\cite=hayes98]. In particular, the number of SAWs from i to j of length k + 1 is given by:

[formula]

for k  ≥  1 where [formula] is the number of SAWs from i to a neighbour g of j (in Γ) of length k in the graph that is obtained from Γ by removing the vertex j. The adjacency matrix of the graph [formula] is obtained from the adjacency matrix of Γ by deleting the j-th row and column.

Noting that there cannot exist a SAW of length k > |V| - 1, we obtain for the overall expected number of infected vertices starting from vertex i (with λ = 0):

[formula]

We write ISIRi(L) to represent estimates with the sum over paths k limited to maximum path length L.

Simulation results

We provide a brief application of our technique to simulations of SIR spreading phenomena using: a. the social network structure generated from email interactions between employees of a university [\cite=gui03] (giant-component with 1133 nodes and 5451 undirected edges, diameter 8); b. the structure of the C. elegans neural network [\cite=white86] [\cite=watts98] (297 nodes and 2345 directed edges) to demonstrate a directed network, and c. the collaboration network of the arXiv cond-mat repository [\cite=new04] (giant-component with 27519 nodes, 116181 undirected edges, diameter 16) to demonstrate a larger network.

For each network, we compute estimates ISIRi(L) from ([\ref=eq:SIR]) for maximum (self-avoiding) walk lengths L = 1 to 7 (max. of 5 for the cond-mat network), with variable infection rate β, for each patient zero i. To investigate the accuracy of these estimates, we also compute numbers of infections for each patient zero i and β as averages SSIRi over 1000 simulations (10000 for the cond-mat network). Furthermore, to compare the accuracy of inferences of the relative effectiveness of each node, we have also measured the k-shell [\cite=Kitsak10] and eigenvector centrality for each node in the network (these measures were suggested as useful inferrers of relative spreading efficiency from each node in [\cite=Kitsak10] and [\cite=klemm11a]). Using Java code on a 2.0 GHz Intel Xeon CPU E5-2650, the 10000 simulations SSIRi for all nodes and β values were completed for the cond-mat network in around 2000 hours; our estimates ISIRi(L) were completed for L  =  4 and 5 in 30 and 60 minutes respectively; while with Matlab scripts the degree and eigenvector centrality were completed in less than one second each and k-shell computed in less than 30 seconds. We note that computation of the relevant walks skij for SIS models is significantly more efficient than for SIR, since they can be directly computed from Ak (as described earlier). We chose to perform SIR simulations here in order to provide a greater computational challenge for our technique.

The extent to which our estimates accurately represent the relative spreading effectiveness from each patient zero is examined via the correlation of estimates ISIRi(L) to simulated results SSIRi for the various networks in Fig. [\ref=fig:correlationsFigs], as well as via their rank order correlations (defined in [\cite=klemm11a]). These figures demonstrate that our estimates ISIRi(L) consistently provide very accurate assessment of relative spreading effectiveness of the nodes over large ranges of β for all networks examined, in particular for L > 1 and for β values in the sub-critical, critical, and the lower-end of the super-critical spreading regimes. (Critical spreading is defined as β  =  βc  =  1  /  αmax [\cite=klemm11a], where αmax is the largest eigenvalue of the adjacency matrix A. Fig. [\ref=fig:correlationsFigs] indicates βc and also β- 3dB where 30 % of the network is infected on average (upper super-critical regime) - the number of infections continue to increase very quickly beyond this β).

The correlation results for ISIRi(L) generally improve as L increases. Estimates up to only short path lengths L do not properly capture the effects of spreading on the network structure further away from patient zero when these nodes become more vulnerable at larger β. In particular, L = 1 captures only the out-degree of the initially infected node, and therefore does not represent any network structure more than one hop away. In general then, one faces a trade-off between accuracy of inference of effectiveness against shorter computational time. Importantly though, very good results can be obtained with short path lengths L, with the results from L = 4 say being almost indistinguishable from longer L for most of the range of β. This is a crucial point, since the runtime for the computations for L  ≤  4 is much faster than simulations, and is on the order of the runtimes for the more simple degree (L = 1) and k-shell inference methods for the small networks. Finally, we note that the accuracy of the method drops once β is well-inside the super-critical regime (even for large L) due to: i. insufficient path length at high β, ii. our independent walks assumption becomes less valid at high L and β, and iii. with most nodes infecting a large proportion of the network, the structure surrounding each node makes less of an impact on the spreading efficiency.

Crucially, the accuracy achieved by our ISIRi(L) can only be matched by large numbers of simulations, which take significantly longer runtime. Fig. [\ref=fig:correlationsFigs] shows that, for the cond-mat network, using only 10 repeat simulations (with runtime double that of ISIRi(L = 5)) provides much worse correlations, while comparable correlations up to the lower super-critical regime can only be achieved with 1000 simulations which cost around 200×   more runtime. As deduced earlier, our technique has asymptotically faster runtime by a significant constant factor.

Further, our estimates ISIRi(L) are consistently more accurate with L  ≥  2 than the k-shell inference, for β values in the sub-critical, critical and early super-critical regimes. A similar conclusion holds against the eigenvalue centrality measure of [\cite=klemm11a], for all but a couple of β values near the critical regime in Fig. [\ref=fig:condmatRankOrder]; indeed, eigenvector centrality only achieves comparable accuracy near the critical regime. These are crucial results covering the regimes of importance (since in the deeper super-critical regime, a large proportion of the network becomes infected and understanding the spreading efficiency of various initially infected nodes becomes less important). Though our estimates are less efficient than k-shell or eigenvalue centrality, they are still much faster than simulations, and these results suggest a strong advantage to using ISIRi(L).

Additionally, we emphasise that while other tools such as the k-shell and eigenvector centrality are useful for inferring the relative spreading effectiveness of each node, they do not actually estimate the number of infections from each node. This is a distinct feature of our approach as compared to these other methods. In Fig. [\ref=fig:actualVersusInferred] we directly compare our estimates ISIRi(L) to the simulated values SSIRi for each node i, for several values of β. This clearly shows that our technique provides reasonable estimates of the expected number of infections across the sub-critical spreading regime and up to criticality for L  ≥  4. Indeed, reasonable accuracy can still be obtained with larger L into the critical regime, though the time-efficiency benefits of doing so (as compared to simulation) declines.

Fig. [\ref=fig:actualVersusInferred] also demonstrates quite well the manner in which estimates improve (in general) with increasing maximum considered path length L. We see that, while using too small a maximum path length L appears to be the largest contributor to the inaccuracy of ISIRi(L) (serving to pull points above the line SSIRi  =  ISIRi(L)), other errors are introduced by our approximations in ([\ref=eq:plessq]) and ([\ref=eq:psusgreaterthanq]) (the former of which pulls the points below this line by overestimating the probability of infection). As previously stated though, for reasonable β and large enough L, these errors seem to roughly cancel. Importantly also, while the correlation of estimates to simulated infection numbers may not always increase with L in the supercritical regime, larger L values provide consistently more accurate estimates of infection numbers (e.g. see β = 0.12 in Fig. [\ref=fig:correlationsFigs] and Fig. [\ref=fig:actualVersusInferred]).

Finally, we consider a simple heuristic to determine an appropriate L length to use. For potential infection walks from patient zero of length L, and for small β in the sub-critical regime (in particular with doβ  <  1), one can make a naive estimate of the expected numbers of infections at length L as (doβ)L, where do is the average out-degree of the network. One can then compute minimum L values to keep (doβ)L below a given value r. For instance, in the email network (with do = 9.62), using r  =  0.02 suggests that with L  ≥  4 and β  ≤  0.039 we will only neglect infections on walk lengths where the expected number of infections was below 0.02. Of course, this is a simple estimate, neglecting the effects of dependent walks and making an implicit assumption that this r = 0.02 is not large enough to significantly alter the number of infections; however it, along with observing from the diameters that many walks can be captured with L = 4, helps to explain why L = 4 provides good results even as β approaches criticality.

Conclusions

We have presented a method for efficiently estimating the number of resulting infections from a given initially infected node in a network model. This technique focusses on counting the number of functional walks to each candidate for infection, and in SIR models the only type of walks of interest are self-avoiding walks. Our technique is distinct from other recently proposed measures to infer spreading effectiveness of each node because it focusses specifically on disease spreading walks rather than general measures of network topology. We demonstrated our technique to provide consistently more accurate inference of spreading effectiveness than other candidate techniques such as k-shells up to the lower super-critical regime. This accuracy improvement is obtainable in reasonable computational time for SIR models, while still more accurate assessment can be obtained by increasing the computational time, and faster assessment can be made for SIS models. Our technique is also distinguished in specifically estimating the number of infections, and we demonstrated that these estimates are reasonably accurate over a large range of β for large enough values of the maximum counted walk lengths L.