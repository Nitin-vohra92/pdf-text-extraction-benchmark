Lemma Corollary Proposition Conjecture Definition Remark Example Question

HADWIGER'S THEOREM FOR DEFINABLE FUNCTIONS

Introduction

Let [formula] denote Euclidean n-dimensional space. A valuation on a collection S of subsets of [formula] is an additive function [formula]:

[formula]

Valuation v is [formula]-invariant if v(φA)  =  v(A) for all A∈S and [formula], the group of Euclidean (or rigid) motions in [formula]. A classical theorem of Hadwiger [\cite=Hadwiger] states that the [formula]-invariant continuous valuations on compact convex sets S in [formula] (here a valuation is continuous with respect to convergence of sets in the Hausdorff metric) form a finite-dimensional [formula]-vector space generated by intrinsic volumes μk, [formula].

Any [formula]-invariant continuous valuation v on compact convex subsets of [formula] is a linear combination of the intrinsic volumes:

[formula]

for some constants [formula]. If v is homogeneous of degree k, then v  =  ckμk.

The intrinsic volumes μk are characterized uniquely by (1) [formula] invariance, (2) normalization with respect to a closed unit ball, and (3) homogeneity: μk(λ  ·  A) = λk(A) for all A∈S and [formula]. These measures generalize Euclidean n-dimensional volume (μn) and Euler characteristic (μ0).

This paper extends Hadwiger's Theorem to similar valuations on functions instead of sets. Section [\ref=sec:back] gives background on the definable (o-minimal) setting that lifts Hadwiger's Theorem to tame, non-convex sets and then to constructible functions; there, we also review the convex-geometric, integral-geometric, and sheaf-theoretic approaches to Hadwiger's Theorem. In Section [\ref=sec:dist], we consider definable functions [formula] as [formula]-valued functions with tame graphs, and correspondingly define dual pairs of (typically) non-linear "integral" operators [formula] and [formula] mapping [formula] as generalizations of intrinsic volumes, so that [formula] for all A definable. These integrals are [formula]-invariant and satisfy generalized homogeneity and additivity conditions reminiscent of intrinsic volumes; they are furthermore compact-continuous with respect to a dual pair of topologies on functions. This culminates in Section [\ref=sec:HT4D] in a generalization of Hadwiger's Theorem for functions:

Any [formula]-invariant definably lower- (resp. upper-) continuous valuation [formula] is of the form:

[formula]

(resp., integrals with respect to ⌈dμk⌉) for some [formula] continuous and monotone, satisfying ck(0) = 0.

The k = 0 intrinsic measure ⌊dμ0⌋ is a recent generalization ⌊dχ⌋ of Euler characteristic [\cite=BG:pnas] shown to have applications to signal processing [\cite=GR] and Gaussian random fields [\cite=BoBo]. The k = n intrinsic measure ⌊dμn⌋ is Lebesgue volume. The measures come in dual pairs ⌊dμk⌋ and ⌈dμk⌉ as a manifestation of (Verdier-Poincaré) duality. Our results yield the following:

Any [formula]-invariant valuation, both upper- and lower-continuous, is a weighted Lebesgue integral.

We conclude the Introduction remarking that over the past few years several very interesting papers by M. Ludwig, A. Tsang and others appeared, that deal with valuations (often tensor- or set-valued) on various functional spaces (such as Lp and Sobolev spaces): for a recent report, see [\cite=Ludwig]. Our approach deviates from this circle of results primarily in the choice of the functional space: definable functions form a distinctly different domain for the valuation. The quite fine topologies we impose on the definable functions yield a rich supply of the valuations continuous in these topologies.

Background

Euler characteristic

Intrinsic volumes are built upon the Euler characteristic. Among the many possible approaches to this topological invariant -- combinatorial [\cite=KR], cohomological [\cite=GZ], sheaf-theoretic [\cite=Schapira] [\cite=Schurmann], we use the language of o-minimal geometry [\cite=vdD]. An o-minimal structure is a sequence O = (On)n of Boolean algebras of subsets of [formula] which satisfy a few basic axioms (closure under cross products and projections; algebraic basis; and O1 consists of finite unions of points and open intervals). Examples of o-minimal structures include the semialgebraic sets, globally subanalytic sets, and (by slight abuse of terminology) semilinear sets; more exotic structures with exponentials also occur [\cite=vdD]. The details of o-minimal geometry can be ignored in this paper, with the following exceptions:

Elements of O are called tame or, more properly, definable sets.

A mapping between definable sets is definable if and only if its graph is a definable set.

The basic equivalence relation on definable sets is definable bijection; these are not necessarily continuous.

The Triangulation Theorem [\cite=vdD]: any definable set Y is definably equivalent to a finite disjoint union of open simplices {σ} of different dimensions.

The Hardt Theorem [\cite=vdD]: for f:X  →  Y definable, Y has a triangulation into open simplices {σ} such that f- 1(σ) is homeomorphic to Uσ  ×  σ for Uσ definable, and, on this inverse image, f acts as projection.

For more information, the reader is encouraged to consult [\cite=vdD] [\cite=Coste] [\cite=Nicolaescu:normal].

The (o-minimal) Euler characteristic is the valuation χ that evaluates to ( - 1)k on an open k-simplex. It is well-defined and invariant under definable bijection [\cite=vdD], and, among definable sets of fixed dimension (the dimension of the largest cell in a triangulation), is a complete invariant of definable sets up to definable bijection. Note that the o-minimal Euler characteristic coincides with the homological Euler characteristic (alternating sum of ranks of homology groups) on compact definable sets. For locally compact definable sets, it has a cohomological definition (alternating sum of ranks of compactly-supported sheaf cohomology), yielding invariance with respect to proper homotopy.

Intrinsic volumes

Intrinsic volumes have a rich history (see, e.g., [\cite=Bernig] [\cite=Cheeger] [\cite=KR] [\cite=Schanuel]) and as many formulations as names, including the following:

Slices: One way to define the intrinsic volume μk(A) of a definable set A is in terms of the Euler characteristic of all slices of A along affine codimension-k planes:

[formula]

where λ is the following measure on Pn,n - k, the space of affine (n - k)-planes in [formula]. Each affine subspace P∈Pn,n - k is a translation of some linear subspace L∈Gn,n - k, the Grassmannian of (n - k)-dimensional subspaces of [formula]. That is, P is uniquely determined by L and a vector [formula], such that [formula]. Thus, we can integrate over Pn,n - k by first integrating over [formula] and then over Gn,n - k. Equation [\eqref=eq:ivdef] is equivalent to

[formula]

where L∈Gn,n - k, the factorspace [formula] is given the natural Lebesgue measure, and γ is the Haar (i.e. [formula]-invariant) measure on the Grassmannian, scaled appropriately.

Projections: Dual to the above definition, one can express μk in terms of projections onto k-dimensional linear subspaces: for any definable [formula] and 0  ≤  k  ≤  n,

[formula]

where L∈Gn,k and [formula] is the fiber over [formula] of the orthogonal projection map π:A  →  L. For A convex, Equation [\eqref=eq:ivProjEq] reduces to where the integrand is the k-dimensional (Lebesgue) volume of the projection of A onto a k-dimensional subspace L of [formula].

Normal, conormal, and characteristic cycles

Perspectives from geometric measure theory and sheaf theory are also relevant to the definition of intrinsic volumes. In this section, we restrict to the o-minimal structure of globally subanalytic sets and use analytic tools based on geometric measure theory, following Alesker [\cite=Alesker] [\cite=Alesker:gafa], Fu [\cite=Fu], Nicolaescu [\cite=Nicolaescu:conormal] [\cite=Nicolaescu:normal] and many others.

Let [formula] be the space of differential k-forms on [formula] with compact support. Let [formula] be the space of k-currents -- the topological dual of [formula]. Given any k-current [formula], the boundary of T is [formula] defined as the adjoint to the exterior derivative d. A cycle is a current with null boundary.

It is customary to use the flat topology on currents [\cite=Federer]. The mass of a k-current T is

[formula]

(|ω| is the usual norm), which generalizes the volume of a submanifold. The flat norm of a k-current T is

[formula]

where Rk is the space of rectifiable k-currents. The flat norm quantifies the minimal-mass decomposition of a k-current T into a k-current R and the boundary of a (k + 1)-current S.

Normal cycle: The normal cycle of a compact definable set A is a definable (n - 1)-current [formula] on the unit sphere cotangent bundle [formula] that is Legendrian with respect to the canonical 1-form α on [formula]. The normal cycle generalizes the unit normal bundle of an embedded submanifold to compact definable sets. The normal cycle is additive: for A and B compact and definable,

[formula]

The intrinsic volume μk is representable as integration of a particular (non-unique) form [formula] against the normal cycle:

[formula]

Fu [\cite=Fu] gives a formula for the normal cycle in terms of stratified Morse theory; Nicolaescu [\cite=Nicolaescu:normal] gives a nice description of the normal cycle from Morse theory.

Conormal cycle: The conormal cycle (also known as the characteristic cycle [\cite=Kashiwara] [\cite=KS] [\cite=Schurmann]) of a compact definable set A is a Lagrangian n-current [formula] on [formula] that generalizes the cone of the unit normal bundle. Indeed, the conormal cycle is the cone over the normal cycle. An intrinsic description for A a submanifold-with-corners is that the conormal cycle is the union of duals to tangent cones at points of A. The conormal cycle is additive: for A and B definable,

[formula]

The intrinsic volume μk is representable as integration of a certain (non-unique) form [formula] (supported by a bounded neighborhood of the zero section of the cotangent bundle) against the conormal cycle:

[formula]

As the conormal cycles are cones, one can always rescale the forms ωk so that they are supported in a given neighborhood of the zero section of the cotangent bundle. We fix the neighborhood once and for all, and will assume henceforth that all ωk are supported in the unit ball bundle [formula].

The microlocal index theorem [\cite=KS] [\cite=Schurmann] gives an interpretation of the conormal cycle in terms of stratified Morse theory.

Continuity: The flat norm on conormal cycles yields a topology on definable subsets on which the intrinsic volumes are continuous. For definable subsets A and B, define the flat metric by

[formula]

thereby inducing the flat topology. (That this is a metric follows from [formula] being an injection on definable subsets.) For any T∈Ωn and ω∈Ωnc, both supported on [formula]:

[formula]

Since the intrinsic volumes can be represented by integration of bounded forms over the intersection of the conormal cycle with the unit ball bundle, the intrinsic volumes are continuous with respect to the flat topology. We remark also that for the convex constructible sets, the flat topology is equivalent to the one given by the Hausdorff metric.

Intrinsic volumes for constructible functions

It is possible to extend the intrinsic volumes beyond definable sets. The constructible functions, [formula], are functions [formula] with discrete image and definable level sets. By abuse of terminology, [formula] will always refer to compactly supported definable functions with finite image in [formula].

As the integral with respect to the Euler characteristics is well defined for constructible functions, one can extend the intrinsic volumes to constructible functions using the slicing definition above:

[formula]

In so doing, one obtains, e.g., the following generalization of the Poincaré theorem for Euler characteristic.

We need the Verdier duality operator in [formula], which is defined e.g. in [\cite=Schapira]. Briefly, the dual of [formula] is a function [formula] whose value at x0 is given by

[formula]

where the integral is with respect to Euler characteristic (see also [\cite=BG:siam]), and B(x0,ε) is the n-dimensional ball of radius ε centered at x0. In many cases, this duality swaps interiors and closures. For example, if A is a convex open set with closure [formula], then [formula] and [formula].

For a constructible function h on [formula], [formula], and [formula] the Verdier duality operator in [formula],

[formula]

The result holds in the case k = 0 (see [\cite=Schapira]). From Equation ([\ref=eq:IVforCF]), μk is defined by integration with respect to dχ along codimension-k planes, followed by the integration over the planes. By Sard's theorem, for (Lebesgue) almost all L∈Gn,n - k and [formula], the level sets of h are transversal to [formula], whence, by Thom's second isotopy lemma, [\cite=shiota],

[formula]

for almost all L and [formula]. Integration over Pn,n - k finishes the proof.

If definable sets A, [formula] satisfy [formula], then Proposition [\ref=prop:generalPoincare] implies

[formula]

Intrinsic volumes for definable functions

The next logical step, lifting from constructible to definable functions, is the focus of this paper. Let [formula] denote the definable functions on [formula], that is, the set of functions [formula] whose graphs are definable sets in [formula] which coincide with [formula] outside of a ball (thus compactly supported and bounded). In [\cite=BG:pnas], integration with respect to Euler characteristic μ0 was lifted to a dual pair of nonlinear "integrals" [formula] and [formula] via the following limiting process, now extended to μk:

For [formula], the lower and upper Hadwiger integrals of h are, respectively,

[formula]

For k = n these two definitions agree with each other and with the Lebesgue integral; for all k < n, they differ. For k = 0, these become the definable Euler integrals [formula] and [formula]. The following result demonstrates several equivalent formulations, mirroring those of Section [\ref=sec:back]. As a consequence, the limits in Definition [\ref=def:int] are well-defined, following from compact support and the well-definedness of ⌊dχ⌋ and ⌈dχ⌉ from [\cite=BG:pnas].

For [formula],

[formula]

Note that for T > 0 sufficiently large and N = mT,

[formula]

Thus, ([\ref=eq:ex]); the same proof using ⌈dμk⌉ implies that

[formula]

which, with ([\ref=eq:ex]), yields ([\ref=eq:dual]). For ([\ref=eq:slice]), This integral is well-defined, since the excursion sets {h  ≥  s} and {h  <   - s} are definable, and h is bounded and of compact support. The Fubini theorem yields ([\ref=eq:slice]) via For ([\ref=eq:proj]), fix an L∈Gn,k and let πL be the orthogonal projection map on to L. Then the affine subspaces perpendicular to L are the fibers of πL and Instead of integrating over Pn,n - k, integrate over the fibers of orthogonal projections onto all linear subspaces of Gn,k: Finally, for ([\ref=eq:co]), rewrite ([\ref=eq:ex]) by expressing the intrinsic volumes in terms of the conormal cycles, as in ([\ref=eq:int-conormal]).

Continuous valuations

Valuations on functions are a straightforward generalization of valuations on sets. A valuation on [formula] is a functional [formula], satisfying v(0)  =  0 and the following additivity condition:

[formula]

where [formula] and [formula] denote the pointwise max and min, respectively.

We present two useful topologies on [formula] that allow us to consider continuous valuations. With these topologies, the notion of a continuous valuation on [formula] properly extends the notion of a continuous valuation on definable subsets of [formula].

Let [formula]. The lower and upper flat metrics on definable functions, denoted [formula] and [formula], respectively, are defined as follows (see [\ref=eq:FlatMetricSets]):

[formula]

The distinct topologies induced by the lower and upper flat metrics are the lower and upper flat topologies on definable functions. A valuation on definable functions is lower- or upper-continuous if it is continuous in the lower or upper flat topology, respectively.

Note that the integrals in [\eqref=eq:LowFlatMetricFunct] and [\eqref=eq:UprFlatMetricFunct] are well-defined because they may be written with finite bounds, as it suffices to integrate between the minimum and maximum values of f and g. These metrics extend the flat metric on definable sets, for they reduce to [\eqref=eq:FlatMetricSets] when f and g are characteristic functions.

Definition [\ref=def:FlatTopoFunc] does result in metrics. If [formula], then [formula] only for s in a set of Lebesgue measure zero. However, if the excursion sets of f and g agree almost everywhere, then all excursion sets of f and g agree, and thus f = g. For, if {si}i is a sequence of negative real numbers converging 0, and {f  ≥  si}  =  {g  ≥  si} for all i, then: The result for [formula] follows similarly from the observation that [formula].

That the lower and upper flat topologies are distinct can be seen by noting that for the identity function f on the interval

[formula]

The lower and upper Hadwiger integrals are lower- and upper-continuous, respectively.

Let [formula] be supported on [formula]. The following inequality for the lower integrals is via [\eqref=eq:FlatNormIneq]:

[formula]

Since ωk and dωk are bounded, we have continuity of the lower integrals in the lower flat topology. The proof for the upper integrals is analogous.

For constructible functions, the lower and upper flat topologies of the previous section are equivalent. Thus, we may refer to the flat topology on constructible functions without specifying upper or lower. A valuation on constructible functions is conormal continuous if it is continuous with respect to the flat topology. Conormal continuity is the same as "smooth" in the Alesker sense [\cite=Alesker] [\cite=Alesker:gafa], but distinct from continuity in the topology induced by the Hausdorff metric on definable sets.

Hadwiger's Theorem for functions

A dual pair of Hadwiger-type classifications for (lower-/upper-) continuous Euclidean-invariant valuations is the goal of this paper.

If [formula] is a (conormal) continuous valuation on constructible functions, invariant with respect to the right action by Euclidean motions, then v is of the form: for some coefficient functions [formula] with ck(0) = 0.

For the class of indicator functions for convex sets [formula], continuity of v in the flat topology implies that v is continuous in the Hausdorff topology. Since convex tame sets are dense (in Hausdorff metric) among convex sets in [formula], Hadwiger's Theorem for sets implies that

[formula]

where ck(r) are constants that depend only on v, not on A. Conormal continuity implies that the valuation v(A) is the integral of the linear combination of the forms ωk (defined in [\eqref=eq:int-conormal]),

[formula]

over [formula].

Now suppose [formula] is a finite sum of indicator functions of disjoint definable subsets [formula] of [formula] for some integer constants [formula]. By equation [\eqref=eq:HadwigerConstrFunc1] and additivity,

[formula]

We can rewrite equation [\eqref=eq:HadwigerConstrFunc2] in terms of excursion sets of h. Let [formula]. That is, Bi  =  {h  ≥  ri} and Bi  =  {h  >  ri - 1}. Then the valuation v(h) can be expressed as:

[formula]

where ck(r0) = 0. Thus, a valuation of a constructible function can be expressed as a sum of finite differences of valuations of its excursion sets. Equivalently, equation [\eqref=eq:HadwigerConstrFunc3] can be written in terms of constructible Hadwiger integrals:

[formula]

Since we require that a valuation of the zero function is zero, it must be that ck(0) = 0 for all k.

Note that Lemma [\ref=lem:HadwigerConstrFunc] holds for functions of the form [formula] where the Ai are definable and the [formula] are not necessarily integers.

In writing an arbitrary valuation on definable functions as a sum of Hadwiger integrals, the situation becomes complicated if the coefficient functions ck are decreasing on any interval. The following proposition illustrates the difficulty:

Let [formula] be a continuous, strictly decreasing function. Then,

[formula]

On the left side of equation [\eqref=eq:DecreasingComposition], we integrate c composed with upper step functions of h: On the right side of equation [\eqref=eq:DecreasingComposition], we integrate lower step functions of the composition c(h): Since c is strictly decreasing, c- 1 exists. There exists a discrete set

[formula]

We may then rewrite the above sum as: where ε  →  0 as m  →    ∞   by continuity of c. In the limit, both sides are equal:

Proposition [\ref=prop:DecreasingComposition] implies that if [formula] is increasing on some interval and decreasing on another, then the maps [formula] defined are neither lower- nor upper-continuous.

Lemma [\ref=lem:HadwigerConstrFunc] and Proposition [\ref=prop:DecreasingComposition] provide a generalization of Hadwiger's Theorem:

Any [formula]-invariant definably lower-continuous valuation [formula] is of the form:

[formula]

for some [formula] continuous and monotone, satisfying ck(0) = 0. Likewise, an upper-continuous valuation can be similarly written in terms of upper Hadwiger integrals.

Let [formula] be a lower valuation, and [formula]. First approximate h by lower step functions. That is, for m  >  0, let [formula]. In the lower flat topology, lim m  →    ∞hm  =  h. On each of these step functions, Lemma [\ref=lem:HadwigerConstrFunc] implies that v is a linear combination of Hadwiger integrals:

[formula]

for some [formula] with ck(0) = 0, depending only on v and not on m. By Proposition [\ref=prop:DecreasingComposition], the ck must be increasing functions since we are approximating h with lower step functions in the lower flat topology.

We can alternately express equation [\eqref=eq:HDF1] as

[formula]

where we choose lower rather than upper integrals since v is continuous in the lower flat topology. Continuity of v, and convergence of hm to h, in the lower flat topology imply that v(hm) converges to v(h) as h  →    ∞  . More specifically,

[formula]

By continuity of the lower Hadwiger integrals (Lemma [\ref=lem:HadIntCont]) and the ck, Equation [\eqref=eq:HDF3] becomes

[formula]

The proof for the upper valuation is analogous.

Any [formula]-invariant valuation both upper- and lower-continuous is a weighted Lebesgue integral.

Integration with respect to ⌊dμk⌋ and ⌈dμj⌉ are independent unless k = j = n. For any v both upper- and lower-continuous, we have for some functions k and [formula].

Lower and upper Hadwiger integrals with respect to μk are unequal, except when k = n, implying that [formula] for [formula], and [formula]. Therefore, for some continuous function [formula], and with dμn  =  ⌊dμn⌋  =  ⌈dμn⌉ denoting Lebesgue measure.

Speculation

The present constructions are potentially applicable to generalizations of current applications of intrinsic volumes. One such recent application is to the dynamics of cellular structures, such as crystals and foams in microstructure of materials. The cells in such structures often change shape and size over time in order to minimize the total energy level in the system. Let [formula] be a closed n-dimensional cell, with Ci denoting the union of all i-dimensional features of the cell: i.e., C0 is the set of vertices, C1 the set of edges, etc. MacPherson and Srolovitz found that when the cell structure changes by a process of mean curvature flow, the volume of the cell changes according to

[formula]

where M and γ are constants determined by the material properties of the cell structure [\cite=MS]. Replacing the intrinsic volumes of cells with Hadwiger integrals may (1) lead to interesting dynamical systems on the (singular) foliations (by the level sets of a piece-wise smooth function, and (2) allow for description of evolution of real-valued physical fields (temperature, density, etc.) of cells.

A more widely-known application of the intrinsic volumes is in the formulas for expected Euler characteristic of excursion sets in Gaussian random fields [\cite=Adler] [\cite=AdlerTaylor]. These formulae and the associated Gaussian kinematic formula [\cite=AdlerTaylor] rely crucially on the intrinsic volumes of excursion sets. It is already recognized in recent work [\cite=BoBo] that the definable Euler measure ⌊dχ⌋  =  ⌊dμ0⌋ is relevant to Gaussian random fields: we strongly suspect that the other definable Hadwiger measures ⌊dμk⌋ and ⌈dμk⌉ of this paper are immediately applicable to Gaussian random fields.