Lemma Definition Remark Conjecture Proposition Corollary Remark Example

A Szemerédi-Trotter type theorem in [formula]

Introduction

In [\cite=Szemeredi], Szemerédi and Trotter proved the following theorem:

The number of incidences between m points and n lines in [formula] is O(m2 / 3n2 / 3 + m + n).

Theorem [\ref=szemerediTrotterThm] has seen a number of generalizations, including the following one due to Pach and Sharir in [\cite=Pach]:

Let P be a collection of m points in [formula] and S a collection of n curves with k degrees of freedom--i.e. there exists a constant C0 such that any two curves can meet in at most C0 points and at most C0 curves can contain any given k points. Then the number of incidences between points in P and curves in S is where the implicit constant depends only on C0.

Theorem [\ref=pachSharirResult] was proved using the crossing number inequality for planar graphs, which was first employed in incidence geometry by Székely in [\cite=Szekely] and later used by Arnov in [\cite=Arnov] to obtain some partial incidence results in higher dimensions.

In a different direction, Tóth [\cite=Toth] generalized Theorem [\ref=szemerediTrotterThm] to complex points and lines in [formula]. However, as of this writing (2012), Tóth's paper is still in the midst of a lengthy review process while awaiting publication. Solymosi and Tardos [\cite=Solymosi3] gave a simpler proof of the same result in the special case where the point set is a Cartesian product of the form [formula]. Edelsbrunner and Sharir [\cite=Edelsbrunner] obtained incidence results for certain configurations of points and codimension-1 hyperplanes in [formula], and Laba and Solymosi [\cite=Laba] obtained incidence bounds for points and a general class of 2-dimensional surfaces in [formula], provided the points satisfied a certain homogeneity condition. Elekes and Tóth [\cite=Elekes] and later Solymosi and Tóth [\cite=Solymosi2] obtained incidence results between points and hyperplanes in [formula], again provided the points satisfied various nondegeneracy and homogeneity conditions.

In [\cite=Solymosi], Solymosi and Tao used the discrete polynomial ham sandwich theorem to obtain bounds for the number of incidences between points and bounded degree algebraic surfaces satisfying certain "pseudoflat" conditions (i.e. they behaved similarly to hyperplanes). Aside from an ε loss in the exponent, Solymosi and Tao's result resolved a conjecture of Tóth on the number of incidences between points and d-flats in [formula]. The discrete polynomial ham sandwich theorem was also used by the author in [\cite=Zahl] to obtain incidence results between points and 2-dimensional surfaces in [formula] (with no homogeneity condition), and by Kaplan et al.  in [\cite=Kaplan2] to obtain similar bounds on the number of incidences between points and spheres in [formula]

In this paper, we combine the crossing number inequality and the discrete polynomial ham sandwich theorem to obtain a new result which can be seen either as a sharpening of the [formula] version of the Solymosi-Tao result from [\cite=Solymosi] or a generalization of Tóth's result from [\cite=Toth]. To the best of the author's knowledge, this is the first time these two techniques have been used together.

New Results

We call a collection S of surfaces C0-good if for each pair of distinct surfaces [formula] we have the following:

dim S = 2.

S is a real algebraic variety and deg S  ≤  C0.

[formula].

Here, C0 should be thought of as a fixed constant, while our collections of points and surfaces is allowed to be large. All of the bounds in the rest of this paper will depend on C0, but for notational convenience we shall suppress this dependence, and we shall say a collection of surfaces is good if it is C0-good for some fixed value of C0.

Let P be a collection of points and S a good collection of surfaces. We define the set of incidences of P and S to be

Let S∈S. We define [formula] to be the set of smooth points of S (see e.g.  [\cite=Bochnak]). If [formula] we define Tx(S) to be the tangent plane to S at x. This is an (affine) 2-plane in [formula].

We say a collection of incidences I  ⊂  I(P,S) is (C0,k)-admissible if the following requirements are satisfied:

If (p,S)∈I, then [formula].

If S and [formula] are distinct and [formula], then [formula].

For any k points [formula], there are at most C0 surfaces S∈S such that (pi,S)∈I for each [formula].

As above, we shall call a collection of incidences k-admissible if it is (C0,k)-admissible for some value of C0. Finally, we may say a collection of surfaces is [formula] if the value of k is either understood from the context or does not matter.

The most important example arises from complex points and lines in [formula]. Let [formula] be a collection of (complex) points in [formula] and let L be a collection of complex lines in [formula]. Then if [formula] is the image of [formula] under the standard identification of [formula] with [formula], and S is the collection of affine 2-planes in [formula] which are the images of the complex lines in L, then S is a 1-good collection of surfaces, and I(P,S) is a (1,2)-admissible collection of incidences.

Requirement [\ref=admissible2nd] in Definition [\ref=admissibleDefn] may seem artificial, but it is necessary to prevent the situation in which all of the surfaces meet in a common 1-dimensional variety and all of the points lie on that variety. If this were to occur, then the trivial bound of mn incidences would be sharp.

We are now ready to state our results.

Let [formula] be a collection of points, with |P| = m. Let S be a good collection of surfaces, with |S| = n. Let I  ⊂  I(P,S) be a collection of 2-admissible incidences. Then we have the following bounds.

If m  ≤  n2 - ρ, then

[formula]

while if m > n2,

[formula]

For all values of m and n,

[formula]

Here, the constant C1 may depend only on the constants appearing in Definitions [\ref=goodDefn] and [\ref=admissibleDefn], while Cρ may also depend on ρ.

The next theorem is an analogue of Theorem [\ref=pachSharirResult], though we lose an additional logarithmic factor.

Corollaries and applications of Theorem [\ref=surfacesInR4Thm]

If S is a collection of affine 2-planes in [formula] with no two 2-planes meeting in a common line, then S is a good collection. If [formula], then any collection of incidences I  ⊂  I(P,S) is 2-admissible. Thus we have the following corollary:

Let [formula] be a collection of m points and let S be a collection of n 2-planes in [formula] such that any two planes meet in at most one point. Then the number of incidences between points in P and planes in S is bounded by the quantities in [\eqref=surfacesInR4ThmBigm]-[\eqref=surfacesInR4ThmAllValues].

We can use Corollary [\ref=szemerediTrotter2Planes] to recover the Szemerédi-Trotter theorem for complex lines in [formula], which was originally proved by Tóth in [\cite=Toth]. Note that by point-line duality in [formula], we can always assume that the number of lines is at least as great as the number of points. Thus we have:

Let P be a collection of m points and let S be a collection of n (complex) lines in [formula]. Then the number of incidences between points in P and complex lines in S is

As another special case, any collection S of complex unit circles in [formula] (regarded as 2-dimensional real varieties in [formula]) is a good collection. Furthermore, if P is a collection of points then we can partition the collection of incidences between S and P into boundedly many classes [formula] such that each collection of incidences is 2-admissible. See Corollary 2.7 of [\cite=Solymosi] for details. Thus we have

Let P be a collection of m points and let S be a collection of n (complex) unit circles in [formula]. Then the number of incidences between points in P and circles in S is

This result allows us to obtain an improved bound on the unit distance problem in [formula]:

Let [formula] be a finite set of points, with |P| = m. Then

Proof sketch

For simplicity, we shall only sketch the proof of Theorem [\ref=surfacesInR4Thm], i.e. the k = 2 case, and we will concentrate on proving [\eqref=surfacesInR4ThmIntm]. Furthermore, we shall assume that the surfaces in S are 2-planes. The basic idea is as follows. Since each pair of points has at most two 2-planes passing through both of them, we can use the Cauchy-Schwarz inequality to obtain a rudimentary bound on the cardinality of any collection of point-surface incidences. We will call this the Cauchy-Schwarz bound. Using the discrete polynomial ham sandwich theorem, we find a polynomial P of controlled degree whose zero set cuts [formula] into open "cells," such that each cell contains roughly the same number of points from P, and each surface from S does not enter too many cells. We can then apply the Cauchy-Schwarz bound within each cell. This allows us to count the incidences occurring between surfaces and points in [formula]. In order to count the remaining incidences, we perform a "second level" polynomial ham sandwich decomposition on the variety Z. This gives us a polynomial Q which cuts Z into a collection of 3-dimensional cells, which are open in the relative (Euclidean) topology of Z. We then apply the Cauchy-Schwarz bound to each of these 3-dimensional cells. The only incidences left to count are those between surfaces in S and points in [formula]. Let [formula]

We can choose P and Q in such a way that Y is a 2-dimensional variety in [formula]. Let S be a surface in S. Then S will intersect Y in a union of isolated points (proper intersections) and 1-dimensional curves (non-proper intersections) (the case where S meets Y in a 2-dimensional variety can be dealt with easily). The number of isolated points in the intersection can be controlled by the degrees of the polynomials P and Q (we are working over [formula] where Bézout's theorem need not hold, so we need to be a bit careful), and thus the number of incidences between points [formula] and surfaces S∈S such that p is an isolated point of [formula] can be controlled.

The only remaining task is to control the number of incidences between points of [formula] and 1-dimensional curves arising from the intersection of Y and surfaces S∈S. To simplify the exposition, pretend Y is a disjoint union of N 2-planes, i.e. [formula] (of course, we will not make this assumption when we prove the actual result). Then for each plane Πi, [formula] is a line on Πi. It remains to count the number of incidences between [formula] and {LS,i}S∈S. The Szemerédi-Trotter theorem for lines in [formula] would give us the bound

[formula]

but if we sum [\eqref=2dST] over the N values of i, we have only bounded the number of incidences by N1 / 3|P|2 / 3|S|2 / 3 + |P| + |S|. Since N can be quite large, this is not sufficient. Instead, recall Székely's proof in [\cite=Szekely] of the Szemerédi-Trotter theorem, which uses the crossing number inequality (the crossing number inequality and all other graph-related quantities are defined in Section [\ref=graphTheorySection] below). Loosely speaking, we consider the graph drawing Gi on Πi whose vertices are the points of [formula], and two vertices are connected by an edge if there is a line segment from {Li,S}S∈S passing through the two points. Then the number of edges of the graph is comparable to the number of incidences between points and lines, and this is controlled by C(Gi)1 / 3V(Gi)2 / 3, where C(Gi) is the number of edge crossings and V(Gi) is the number of vertices of Gi. Thus in place of [\eqref=2dST], we have

[formula]

The key insight is that

[formula]

Indeed, every pair of 2-planes [formula] can intersect in at most one point, and since we assumed the planes {Πi} composing Y were disjoint, the intersection point of [formula] can occur on Πi for at most one index i. Summing [\eqref=2dSTCrossings] over all choices of i, applying Hölder's inequality, and inserting [\eqref=boundOnCrossingNum], we obtain the correct bound on the number of incidences between surfaces in S and points lying on Y.

Unfortunately, the assumption that Y is a disjoint union of 2-planes need not be true. Thus we must cut Y up into pieces, each of which behaves like a 2-plane, and we need to prove a more general form of the Szemerédi-Trotter theorem for families of curves and points that lie on suitable domains. This is a purely topological argument, and it is done using the crossing number inequality. The decomposition of Y into suitable domains relies on results from real algebraic geometry, and it works well provided Y is not of too high degree. The degree of Y depends on the value of ( log |P|) / ( log |S|). If |P| is too large compared to |S|, the degree of Y is too big, and we cannot cut Y into suitable pieces without introducing error terms that are larger than the bounds we are trying to prove. Thus, instead of choosing "optimal" values for the degrees of P and Q, we choose smaller values so that the degree of Y is not too big. We can no longer apply the Cauchy-Schwarz bound to control the incidences occurring within each of the 3 and 4-dimensional cells described above. Instead, we borrow an idea from Solymosi and Tao in [\cite=Solymosi], and we assume an appropriate bound on the number of incidences between collections of points [formula] and surfaces [formula] provided [formula] and [formula] have a better ratio of sizes than |P| and |S|. Based on the way the cell decomposition works, this induction assumption will be satisfied for the collection of points and surfaces inside each cell of the decomposition, provided that |P|  ≤  |S|2 - ε for some constant ε > 0, where the improvement obtained by the induction step depends on ε. After finitely many applications of the induction step, we obtain a situation where the ratio of |P| and |S| is very favorable, and thus our decomposition of Y into "2-plane-like pieces" is very good. At this point, we can select P and Q to have optimal degrees and use the arguments above where we apply the Cauchy-Schwarz bound within each cell rather than the induction hypothesis.

The proof of [\eqref=surfacesInR4ThmAllValues] is similar, except we never apply the Cauchy-Schwarz bound; we keep applying the induction hypothesis bounds until our cells are so small that we can use a trivial bound to control the number of incidences that occur with each cell. This is similar to the techniques used by Solymosi and Tao. However, Solymosi and Tao need to iterate their induction step roughly log |P| times, while with our techniques we only need to perform the induction step about log  log |P| times. This allows us to get a slightly sharper bound. In order to prove Theorem [\ref=surfacesInR4Thm][formula], we use the more intricate crossing-number based arguments of Pach and Sharir from [\cite=Pach] in place of Székely's proof of the Szemerédi-Trotter theorem.

Thanks

The author is very grateful to Silas Richelson and Terence Tao for helpful discussions. The author was supported in part by the Department of Defense through the National Defense Science & Engineering Graduate Fellowship (NDSEG) Program.

Preliminaries

In this section we shall recall some basic definitions and also state several lemmas that will be needed in the body of the proof. The proofs of these lemmas have been deferred to Appendix [\ref=proofAppendix].

Notation and Definitions

Throughout the paper, C will denote a sufficiently large absolute constant that is allowed to vary from line to line. We will write [formula] to mean A < CB and we say that a quantity B is O(A) if [formula]. We say a quantity B is o(A) if A is O(B), and we say a quantity B is o(1;ε) if B = B(ε) is some function of ε, ε  ≥  0 with B(ε)  →  0 as ε  →  0 (B may also be a function of additional variables. In this case, we require that B(ε)  →  0 as ε  →  0 for each fixed value of the other variables).

Graph theory

Let G be a multigraph with maximum edge multiplicity M, and let H be a drawing of G, i.e. a collection of points and curves in [formula] such that every vertex of G corresponds to a distinct point of H, and every edge of G corresponds to a curve in H such that every two curves intersect in a discrete set, and no points (i.e. vertices) are contained in the relative interior of any curve (i.e. edge).

We define V(G) to be the number of vertices of G and E(G) to be the number of edges, and similarly for H. We define C(H) to be the crossing number of H, i.e. the number of times two curves cross each other. Since the intersection of any two curves is a discrete set, C(H) is finite.

Let H be a drawing of a multigraph with maximum edge multiplicity M. Then either E(H) < 5V(H), or

[formula]

Let s,t be fixed, and let [formula] be a bipartite graph with |G1| = a,|G2| = b that contains no copy of Ks,t. Then G has at most O(ba1 - 1 / s  +  a) edges. Symmetrically, G has at most O(ab1 - 1 / t  +  b) edges.

Real algebraic geometry

Unless otherwise noted, all polynomials will be (affine) real polynomials, i.e. elements of [formula], and all varieties will be affine real varieties. Definitions and standard results about real algebraic varieties can be found in [\cite=Basu] [\cite=Bochnak].

A (real) algebraic variety [formula] is a set of the form [formula] where [formula] are polynomials. Note that we do not require varieties to be irreducible.

If [formula] is an ideal, we define By abuse of notation, if [formula], then we define [formula].

If [formula] is a variety, we define

If [formula] is a real variety, then [formula] denotes the smallest complex variety containing Z. Note that if [formula] is a point, then p* is the image of p under the canonical embedding [formula]. Conversely, if [formula] is a complex variety, then [formula] is its set of real points. The properties of Z* and [formula] will be discussed further in Section [\ref=realCplxVarietiesSec].

Let [formula] be a collection of non-zero real polynomials. A strict sign condition on Q is a map σ:Q  →  {  ±  1}. If Q∈Q, we will denote the evaluation of σ at Q by σQ. If [formula] is a variety, and σ is a strict sign condition on Q, then we can define the realization of σ on Z by

[formula]

We define

[formula]

and

[formula]

We call [formula] the collection of "realizations of realizable strict sign conditions of Q on Z." Note that if some Q∈Q vanishes identically on Z then [formula] and thus [formula].

An ideal [formula] is real if for every sequence [formula], [formula] implies aj∈I for each [formula].

The following proposition shows that real principal prime ideals and their corresponding real varieties have some of the "nice" properties of ideals and varieties defined over [formula].

Let [formula] be a principal prime ideal. Then the following are equivalent:

(P) is real.

[formula].

[formula].

[formula] does not vanish identically on [formula].

The sign of P changes somewhere on [formula].

While not every polynomial [formula] is a product of real ideals, the following lemma shows that for our applications, we can always modify our polynomials to ensure that this is the case.

Let [formula] be a real polynomial. Then there exists a real polynomial P̃ such that deg P̃  ≤   deg P, [formula] and the irreducible components of P̃ generate real ideals.

The proof of this lemma has been deferred to Appendix [\ref=proofAppendix].

We will make essential use of the real Bézout's theorem (see e.g. [\cite=Basu]) and of Harnack's theorem (see e.g. [\cite=Coolidge]).

Let [formula] be real polynomials of degrees [formula]. Then the number of nonsingular intersection points of [formula] is at most [formula].

Let [formula] be an algebraic plane curve. Then Z contains O(( deg Z)2) connected components.

Polynomial ham sandwich-type theorems

In [\cite=Guth], Guth and Katz used the polynomial ham sandwich theorem to prove the following "discrete" polynomial ham sandwich theorem.

Fix e. Let [formula] be finite families of points, with [formula] . Then there exists a polynomial [formula] of degree at most e such that

Iterating Theorem [\ref=discreteHamSandThm] as in [\cite=Guth], for any discrete set we can find a polynomial P that cuts [formula] into open "cells," with each cell not containing too many points from the discrete set:

Let P be a collection of points in [formula], and let D > 0. Then there exists a non-zero polynomial P of degree at most D such that each connected component of [formula] contains at most O(|P| / D4) points of P.

After applying Lemma [\ref=makeAPolyProdRealIdeals], we can ensure that the irreducible components of P generate real ideals:

Let P be a collection of points in [formula], and let D > 0. Then there exists a non-zero polynomial P of degree at most D such that each connected component of [formula] contains at most O(|P| / D4) points of P, and each irreducible component of P generates a real ideal.

Consider the following collection of 72 points:

[formula]

and let D = 2. Then the degree-4 polynomial cuts [formula] into 16 open cells [formula] (the cells are unbounded, but this is fine) plus the set We can verify that the polynomials [formula] generate real ideals, so P is a product of irreducible polynomials, each of which generates a real ideal. We have [formula] for each [formula]. Thus P satisfies the requirements of Corollary [\ref=hamSandwichThmStronger] (Corollary [\ref=hamSandwichThmStronger] only specifies the degree of P up to an implicit constant, so we cannot verify that the degree is correct). Finally, note that we have [formula]

Let [formula] be a large collection of points that lie in general position on the 2-plane {x1 = x2 = 0}, and let D be much smaller than |P|1 / 4. Then we can verify that the polynomial P(x1,x2,x3,x4) = x1 satisfies the requirements of Corollary [\ref=hamSandwichThmStronger]; [formula] cuts [formula] into the two cells Ω1  =  {x1 > 0} and Ω2  =  {x1 < 0}. We have [formula] and [formula] This phenomenon is unavoidable: any polynomial P satisfying the requirements of Corollary [\ref=hamSandwichThmStronger] must contain a factor P1 of the form P1(x1,x2,x3,x4) = ax1 + bx2 for some [formula] (provided the points of P are in general position). Thus we must have [formula] so each of the cells of the decomposition [formula] will be empty. This example is interesting because if (,L) is a collection of complex points and lines in [formula], and (P,S) is the collection of points and 2-planes in [formula] associated to (,L), then all of the points of P will lie on a common 2-plane, so the situation will resemble this example.

Theorem [\ref=hamSandwichThm] will be used to obtain the "first level" decomposition of the point set P. However, as seen in the above examples, many points may lie on the "boundary" [formula] and we will need to control the number of incidences between surfaces in S and points on [formula]. To do this, we shall perform a second discrete polynomial ham sandwich decomposition on the algebraic set [formula]. This shall be done with the following theorem:

Let P be a collection of points in [formula] lying on the set [formula] for P an irreducible polynomial of degree D such that P generates a real ideal. Let ρ > 0 be a small constant, and let E  ≥  ρD. Then there exists a collection of polynomials [formula] with the following properties:

|Q|  ≤   log 2(DE3) + O(1).

[formula].

None of the polynomials in Q vanish identically on Z.

The realization of each of the O(DE3) strict sign conditions of Q on Z contains at most [formula] points of P.

Each irreducible component of each polynomial Q∈Q generates a real ideal.

All implicit constants depend only on ρ and the dimension d.

Theorem [\ref=variantHamSandwichThm] is proved in [\cite=Zahl]. We can continue Examples [\ref=ex1] and [\ref=ex2].

The following lemma will be used to control the number of incidences that can occur between points and good surfaces that lie inside of an algebraic variety in [formula]. A proof of the lemma can be found in Appendix [\ref=corOfThomTypeBoundLem2].

Let S be a collection of good surfaces, let P be a collection of points, let I  ⊂  I(P,S) be a collection of admissible incidences, and let [formula] be a variety with [formula]. Suppose that for each S∈S, we have S  ⊂  V, and that for each (p,S)∈I we have [formula]. Then

[formula]

Thom-type lemmas

In order to use the polynomial ham sandwich cell decomposition described above, we need to control how many cells a given surface S∈S can enter. This is accomplished by the following theorem:

Let [formula] be a real polynomial of degree D whose irreducible components generate real ideals, and let S be a 2-dimensional irreducible real variety of degree ≤  C. Then S intersects at most O(D2) connected components of [formula], where the implicit constant depends only on C.

We will need similar control on the number of times a surface S∈S can enter a 3-dimensional cell on the variety [formula].

Let [formula] be an irreducible real polynomial of degree D that generates a real ideal, and let [formula] be a collection of real polynomials, such [formula], and for each Q∈Q, the irreducible components of Q generate real ideals. Let S be a 2-dimensional surface of degree ≤  C. Then S meets at most O(DE) realizations of realizable strict sign conditions of Q on [formula].

The proofs of Lemmas [\ref=ThomTypeBoundLem1] and [\ref=corOfThomTypeBoundLem2] can be found in Appendix [\ref=proofAppendix].

A similar result to Lemma [\ref=corOfThomTypeBoundLem2] can be obtained from the recent work of Barone and Basu in [\cite=Barone].

Real and Complex Varieties

Let [formula] be a real variety and let [formula] [formula] be the irreducible components of Z*. Then [formula] are the irreducible components of Z. Furthermore, for each [formula] [formula] so in particular [formula] is non-empty.

If [formula] are irreducible and (P),(Q) are real ideals such that [formula], then [formula] is a complete intersection.

Main Results: Proof of Theorem [\ref=surfacesInR4Thm]

The proofs of Theorems [\ref=surfacesInR4Thm] and [\ref=surfacesInR4Thm][formula] are very similar, so wherever possible we shall deal with both theorems at the same time. Thus we will frequently divide our arguments into the cases k = 2 (corresponding to Theorem [\ref=surfacesInR4Thm]) and k  ≥  3 (corresponding to Theorem [\ref=surfacesInR4Thm][formula]).

Let P,S, I, and k be as in the statements of Theorems [\ref=surfacesInR4Thm] and [\ref=surfacesInR4Thm][formula]. First, it suffices to prove Theorems [\ref=surfacesInR4Thm] and [\ref=surfacesInR4Thm][formula] in the special case where all the surfaces S∈S are irreducible. If the surfaces are not irreducible, then there exists a constant C0 such that each S∈S can be written [formula], where each Si is an irreducible 2-dimensional surface (technically, S may contain irreducible components that are 0 or 1-dimensional, but by Property [\ref=admissibleDefnSmooth] of a admissible intersection, no points may lie on such components, so we may discard them). For each index [formula], let Sj  =  {Sj:S∈S} (where [formula] if S contains fewer than j irreducible components). We can verify that each collection Sj of surfaces is good, and that [formula] is admissible. We have

[formula]

and the surfaces in each collection Sj are irreducible. Thus if we can establish Theorem [\ref=surfacesInR4Thm] in the special case where all the surfaces are irreducible, we can apply the result to each term in [\eqref=unionOfIrreducibles] to recover the general result. Thus we shall assume that all surfaces in S are irreducible.

First, from Lemma [\ref=turanBoundLemma], we have

[formula]

This immediately gives us [\eqref=surfacesInR4ThmBigm] and [\eqref=surfacesInR4ThmBigm][formula], and it also gives us [\eqref=surfacesInR4ThmIntm], [\eqref=surfacesInR4ThmIntm][formula], [\eqref=surfacesInR4ThmAllValues], and [\eqref=surfacesInR4ThmAllValues] if n > cmk or m > cn2 for some small constant c to be chosen later. Thus we may assume

[formula]

Main induction step

Theorem [\ref=surfacesInR4Thm] will follow from the following two theorems:

Let S be a good collection of surfaces, P a collection of points, and I a collection of k-admissible incidences. Suppose Then

[formula]

if k = 2, and if k  ≥  3.

Let S be a good collection of surfaces, P a collection of points, and I a collection of k-admissible incidences. Then there exists the following:

A number A satisfying

[formula]

where c0 is some small absolute constant.

Numbers {Ai} with each Ai  ≥  0 and

[formula]

and numbers {mi} with each mi  ≥  0 and

[formula]

Collections {(Pj,Sj)}, with Pj  ⊂  P, Sj  ⊂  S, with

[formula]

Collections {(Pij,Sij)}, with Pij  ⊂  P, Sij  ⊂  S such that for each index i,

[formula]

These collections have the property that

[formula]

where

[formula]

if k = 2, and if k  ≥  3.

We will first prove the bounds [\eqref=surfacesInR4ThmIntm] and ([\ref=surfacesInR4ThmIntm][formula]) by establishing the following induction step. There exists a small absolute constant c0 with the following property. If there exists some ρ0 > 0 and a constant Cρ0 for which [\eqref=surfacesInR4ThmIntm] and ([\ref=surfacesInR4ThmIntm][formula]) hold for that value of ρ0, then there exists a constant C* for which [\eqref=surfacesInR4ThmIntm] and ([\ref=surfacesInR4ThmIntm][formula]) hold for all values of ρ  ≤  (1 - c0)ρ. If ρ  >  1 then [\eqref=surfacesInR4ThmIntm] and ([\ref=surfacesInR4ThmIntm][formula]) hold by Theorem [\ref=baseCaseThm]. Once this fact has been established, it suffices to note that for any ρ > 0, if B >  log ρ  /   log (1 - c0), then we obtain the bounds [\eqref=surfacesInR4ThmIntm] and ([\ref=surfacesInR4ThmIntm][formula]) for ρ after at most B iterations of the above procedure. Thus it suffices to establish the induction step.

Suppose [\eqref=surfacesInR4ThmIntm] or ([\ref=surfacesInR4ThmIntm][formula]) holds for all ρ  >  ρ0. Let ρ  >  (1 - c0)ρ0. Apply the decomposition from Theorem [\ref=inductionThm]. We can assume that for each index j,

[formula]

where C is the implicit constant from [\eqref=propertiesOfPtsISphrsII]. If this is not the case for some j, simply add admissible surfaces to Sj at random. Doing so will not affect I, and it will increase [formula] by at most a factor of 2.

Now, for each index j, we have

[formula]

Now, |P|  ≤  |S|2 - ρ, i.e. C|Pj|A4  ≤  (C|Sj|A2)2 - ρ, thus

[formula]

where in the final line we used [\eqref=defnOfA] and the assumption that |S| is sufficiently large to absorb the constant C2 - ρ into the exponent (if |S| is not sufficiently small then the entire result is trivial).

Similarly, for each index i,j, we have

[formula]

Thus C|Pij|AiA3  ≤  (C|Sij|AiA)2 - ρ, so

[formula]

Now, recall that we selected ρ so that (1 + c0)ρ  >  ρ0. Then by our induction hypothesis,

[formula]

if k = 2, and if k  ≥  3. Thus if k = 2, we obtain the following bound (for clarity, we shall write the computation for general k):

[formula]

and if k  ≥  3,

Similarly, if k = 2,

[formula]

and if k  ≥  3,

Now, by [\eqref=defnOfA], [formula] and thus for k = 2 we have

[formula]

while for k  ≥  3 we have

Thus, if we set Cρ = C  ·  Cρ0, we obtain [\eqref=surfacesInR4ThmIntm] and ([\ref=surfacesInR4ThmIntm][formula]) and for all values of [formula].

We can apply similar reasoning to establish [\eqref=surfacesInR4ThmAllValues] and ([\ref=surfacesInR4ThmAllValues][formula]). The key idea is that by iterating Theorem [\ref=inductionThm] about log  log m times, we reduce to the case of counting incidences between collections of points and curves of bounded size, and we can apply trivial bounds. On the other hand, each application of Theorem [\ref=inductionThm] introduces a multiplicative constant C0 into our bounds, so our final bounds are sharp except for a Clog  log m0  =   log Cm factor. We will now make this intuition precise. The case k = 2 and k  ≥  3 can be dealt with simultaneously. Suppose [\eqref=surfacesInR4ThmAllValues] holds for all collections ,, with ||  ≤  m0. Apply Theorem [\ref=inductionThm] to the collection P,S,I. Then

[formula]

Similarly,

[formula]

Let C2 be the supremum of the constant appearing on the final lines of [\eqref=allValuesEqn1] and [\eqref=allValuesEqn2]. If we make C1 large enough, Using [\eqref=defnOfA], and assuming m is sufficiently large (if m is not sufficiently large then the entire result is trivial), we have Thus,

[formula]

This closes the induction.

The base case

In this section, we shall prove the base case for our induction.

We shall prove the theorem by induction on m. For m sufficiently small the result is immediate, since we can chose a large constant in the quasi-inequalities [\eqref=baseCaseEqn] and ([\ref=baseCaseEqn][formula]).

First ham sandwich decomposition

Let

[formula]

which by [\eqref=r4mnNotTooDifferent] satisfies

[formula]

Let P be a squarefree polynomial of degree at most D such that [formula] cuts [formula] into O(D4) cells {Ωi}, such that [formula]. Let ni be the number of surfaces in S that meet cell i. By Lemma [\ref=ThomTypeBoundLem1],

[formula]

and thus if we apply Lemma [\ref=turanBoundLemma] within each cell, we obtain

[formula]

Write

[formula]

where S1 (resp. S2) consists of those surfaces that are contained (resp. not contained) in Z. By Lemma [\ref=controlOfSmoothPtsLem], we have

[formula]

so it suffices to consider incidences between surfaces and points lying on [formula]. Let R be the square-free part of [formula], i.e. (R) is radical and [formula]. Since P was square-free, [formula] is a complete intersection. If we let [formula] be those surfaces contained in [formula], then we must have [formula], and thus applying Lemma [\ref=turanBoundLemma], we have

[formula]

Let [formula] be those surfaces (contained in Z) that are not contained in [formula]. We must now control [formula] and [formula]. But note that Z and [formula] are both the zero-set of polynomials of degree O(D), and thus the two collections of incidences can be dealt with in the same fashion.

Second ham sandwich decomposition

We shall now control [formula]. Factor [formula], with each Pj irreducible of degree Dj, and let Zj  =  {Pj}. Let [formula] so that [formula]; if the same point p lies on several Zj, place p into just one of the sets Pj (the choice of set does not matter). Let

[formula]

We have

[formula]

Thus by the induction hypothesis, we have

[formula]

if k = 2, and if k  ≥  3. If c is selected sufficiently small, the contribution from [\eqref=contribFromInduction] is acceptable.

Let us now suppose j∈A1. Use Lemma [\ref=variantHamSandwichThm] to find a collection Qj of polynomials with [formula], where

[formula]

such that each strict sign condition of Qj on Zj contains [formula] points.

Let mij be the number of points of Pj that lie in the i-th strict sign condition of Qj on Zj, and let nij be the number of surfaces in S2 that meet the i-th strict sign condition of Qj on Zj. Let [formula].

By Lemma [\ref=corOfThomTypeBoundLem2],

[formula]

Thus

[formula]

It remains to control [formula]. We shall defer this step until the next section. Thus, if j∈A1 then

[formula]

and thus by Hölder's inequality,

[formula]

Let Y be a 2-dimensional variety of the form:

[formula], with [formula].

[formula] deg Pj  =  Dj,  deg Qj = Ej.

Pj is irreducible generates a real ideal. Qj is a product of irreducible polynomials, each of generates a real ideal (and thus Zj and Qj are hypersurfaces).

Qj is not divisible by Pj.

Let P  ⊂  Y be a collection of points, with |P| = m. Let S be a collection of admissible surfaces, with |S| = n such that no surface in S is contained in Y. Let I  ⊂  I(P,S) be a collection of k-good incidences. Then the following holds:

If k = 2, then

[formula]

If k  ≥  3, then

[formula]

We shall defer the proof of Lemma [\ref=crossingNumberIneqLemma] to Section [\ref=proofOfCrossingNumberIneqLemmaSection] below. Applying Lemma [\ref=crossingNumberIneqLemma] to the collection [formula] with [formula] we see that if k = 2, then

[formula]

Here we used the assumption m  ≤  n, and thus If k  ≥  3 then a similar computation shows

[formula]

Combining [\eqref=contribFromInduction], [\eqref=contributionFromA2A3], and [\eqref=controlOfBdryIncidencesNow] we obtain

[formula]

if k = 2, and if k  ≥  3.

However, an identical argument can be used to obtain analogous bounds for [formula]. Combining [\eqref=r4mnNotTooDifferent], [\eqref=R4firstLevelCellInteriors], [\eqref=ptsCapZSmoothSphrs1], [\eqref=ptsCapZSingSphrs1Prime], and either [\eqref=PcapZSphrs2k2] or ([\ref=PcapZSphrs2k2][formula]), we obtain

[formula]

if k = 2, and if k  ≥  3.

The induction step

We shall now prove the induction step theorem.

The proof will follow a similar outline to that of Theorem [\ref=baseCaseThm], and we shall gloss over those steps that are identical.

First ham sandwich decomposition

Let

[formula]

By [\eqref=r4mnNotTooDifferent], A satisfies

[formula]

As in the previous section, let P be a squarefree polynomial of degree at most A such that [formula] cuts [formula] into O(A4) cells {Ωi} such that if [formula] then [formula] Let [formula]. By Lemma [\ref=ThomTypeBoundLem1], [formula]. We have that the collections {i},{Si} satisfy the requirements from [\eqref=propertiesOfPtsISphrsI] and [\eqref=propertiesOfPtsISphrsII].

It remains to find appropriate collections of points and surfaces that contain [formula]. Write [formula] as in [\eqref=decompOfSphrs]. Let By Lemma [\ref=controlOfSmoothPtsLem],

[formula]

We now consider incidences between surfaces and points lying on [formula]. Let R be the squarefree part of [formula]. Let [formula] be those surfaces contained in [formula], so [formula]. Let By Lemma [\ref=turanBoundLemma], we have

[formula]

Let [formula] be those surfaces (contained in Z) that are not contained in [formula]. We must now control [formula] and [formula].

Second ham sandwich decomposition

Factor [formula] and partition [formula] as in the previous section. Let Aj  =   deg Pj.

For each index j, apply Lemma [\ref=variantHamSandwichThm] to the data [formula] and denote the resulting collection Qj.

Let Pij be those points of Pj that lie in the i-th strict sign condition of Qj on Zj, and let Sij be those surfaces in S2 that meet the i-th strict sign condition of Qj on Zj. We can verify that {Pij} and {Sij} satisfy the requirements from [\eqref=propertiesOfPtsISphrsTwoI].

We shall perform a similar decomposition for the points of [formula], and denote the resulting collections [formula], [formula]. Again, [formula] and [formula] satisfy the requirements from [\eqref=propertiesOfPtsISphrsTwoI], and thus the collection [formula] satisfies the properties from [\eqref=propertiesOfPtsISphrsTwoI].

Finally, it remains to control the "boundary incidences," where [formula] and [formula] is defined similarly. But by Lemma [\ref=crossingNumberIneqLemma],

[formula]

if k = 2, and if k  ≥  3. The analogous bounds hold for [formula] Thus if we let we can verify that our collections {Pj}, {Sj}, {Pij}, {Sij}, and [formula], satisfy the conclusions of Theorem [\ref=inductionThm].

Controlling boundary incidences: proof of Lemma [\ref=crossingNumberIneqLemma]

Before we begin the proof, let us first recall Székely's proof in [\cite=Szekely] of the Szemerédi-Trotter theorem, which uses the crossing number inequality. Let [formula] be a collection of points and L a collection of lines in [formula]. Let I(,L) be the number of incidences between points in [formula] and lines in L. Suppose that all of the points (and thus all of the incidences) are contained in some large disk [formula] Consider the following graph drawing H: the vertices of H are the points of [formula] and the points where a line from L meets ∂U. The edges of H are the line segments connecting two vertices that arise from lines in L. To each incidence (p,L)∈I, we can associate an edge of H in such a way that the same edge is assigned to at most two incidences. Thus [formula] Now, delete all of the edges involving a vertex on ∂U, and delete the vertices on ∂U. We have deleted at most 2|L| edges. Let [formula] be the resulting graph drawing. Then [formula]. By the crossing number inequality,

[formula]

Thus [formula]

We wish to do the same thing on the real algebraic varieties {Yj}. In order to do that, we will have to formulate the above proof in a slightly more general setting.

Let A be a collection of open curves (i.e. homeomorphic images of (0,1)) and B a collection of points on a planar domain [formula] Then we define the number of incidences between curves in A and points in B to be and we define the number of crossings of curves in B to be

Let:

U be a smooth 2-dimensional manifold that is homeomorphic to an open subset of [formula].

A be a collection of 1-dimensional open curves lying on U.

B be a collection of points on U.

Let C0 be a constant so that for any two points [formula] there are at most C0 curves [formula] with p∈αj and [formula] for each [formula].

Then

[formula]

where the implicit constant depends only on C0.

Note that in Definition [\ref=defnOfCurvePtIncidences], a point is incident to an (open) curve if it lies on the closure of that curve. On the other hand, a crossing of two curves is a point common to the relative interior of both curves. Similarly, in Lemma [\ref=STforLinesOnHomeo] we require that for any two points, there are at most O(1) curves which contain those points in their relative interiors--there may be arbitrarily many curves whose closures contain the two points.

We also have the slightly weaker bound for "curves with k degrees of freedom":

Lemmas [\ref=STforLinesOnHomeo] and [\ref=STforLinesOnHomeo][formula] are useful when combined with the following lemma:

Let [formula] be a 2-dimensional real variety of the following form:

[formula], where each [formula] is a 2-dimensional real algebraic set that is a (set-theoretic) complete intersection of two (real) hypersurfaces

[formula] with deg Pj  =  Dj,  deg Qj  =  Ej, Ej  >  cDj for some small absolute constant c.

Let [formula] be a collection of points, let S be a collection of good surfaces, and let I be a collection of admissible incidences. Suppose further that for each (p,S)∈I, there does not exist an index j for which p is an isolated point of [formula] Thus for each S∈S and for index j, either [formula], or p lies on a 1-dimensional component of [formula].

Then there exists an "error set" [formula] and an "incidence model" M  =  {(Ui,Ai,Bi,ιi)}Mi = 1, where for each i,

[formula] is homeomorphic to an open subset of [formula].

Ai is a collection of open curves (homeomorphic to (0,1)) contained in Ui.

Bi  ⊂  Ui is a collection of points.

[formula] is an embedding.

M and [formula] have the following properties:

M does not increase crossing number:

[formula]

M counts incidences: If [formula], then there exists some index i, some p̃∈Bi, and some α∈Ai such that ιi(p̃)  =  p, p∈ιi(α), α  =  ι- 1i(S), and [formula].

The curves in Ai have k degrees of freedom: For each index i, and for each collection of k points [formula] there are at most C0 curves in Ai passing through each of [formula], where C0 is the constant from Definition [\ref=goodDefn].

M does not contain too many curves:

[formula]

[formula] is not too big:

[formula]

Using Lemmas [\ref=STforLinesOnHomeo] and [\ref=decompOfYLem], we shall prove Lemma [\ref=crossingNumberIneqLemma].

Let {Yj}, S, P, and I be as in the statement of Lemma [\ref=crossingNumberIneqLemma]. We define

[formula]

Note that since [formula] for any S∈S, I1 consists of those pairs (p,S) such that for each index j, either [formula] or p lies on a 1-dimensional component of [formula].

We shall first deal with I0. Fix a choice of S and j. Since [formula], [formula] consists of 0 and 1-dimensional irreducible components. By Harnack's theorem (see Remark [\ref=HarnackRemark] below), [formula] can contain at most D2j 0-dimensional components. Now, consider the collection Υ of 1-dimensional irreducible components of [formula]. We have [formula]. For each curve γ∈Υ, either γ*  ⊂  W*j, or [formula] is a discrete set. Let Υ1 and Υ2 denote those sets where the former (resp. latter) occurs. If γ∈Υ1, then we must have γ  ⊂  Yj, and thus for any point p∈P that lies on γ, we must have (p,S)∈I1. If γ∈Υ2, then by Bézout's theorem (over [formula]), [formula] and thus there are at most O( deg γ  ·  Ej) points p∈P for which p∈γ and (p,S)∈I0. Summing over all curves in Υ2, we conclude

[formula]

while Harnack's theorem deals with plane algebraic curves and [formula] is a space curve, since [formula] is a proper intersection, we can select a generic projection [formula]. The image curve [formula] may have fewer connected components than the original curve, but the decrease is controlled by the number of singular points of [formula], and this in turn is controlled by D2j

Summing [\eqref=sumOverGamma] over all indices j and all choices of S∈S and adding back the incidences that lie on 0-dimensional components of [formula] for al choices of S∈S, we obtain

[formula]

It remains to control |I1|. Use Lemma [\ref=decompOfYLem] on the data [formula]. Denote the resulting incidence model M and the resulting error set [formula]. We have

[formula]

[\eqref=modelIncidencesControlIncidences], [\eqref=modelPointsControlled], and [\eqref=modelCrossingsControlled] follow from the definition of Mj and the observation that if α∈Ai, |∂α| = 2, i.e. an open curve only has two ends.

Now, if k = 2, apply Lemma [\ref=STforLinesOnHomeo] to each collection (Ui,Ai,Bi). We have

[formula]

where in the final line we used [\eqref=MjDoesNotIncreaseCrossing] and the fact that If k  ≥  3, apply Lemma [\ref=STforLinesOnHomeo][formula] to each collection (Ui,Ai,Bi). We get

This concludes the proof of Lemma [\ref=crossingNumberIneqLemma], modulo the proofs of Lemmas [\ref=STforLinesOnHomeo] and [\ref=decompOfYLem].

Szeméredi-Trotter on a domain

Since all of the quantities we wish to consider are invariant under homeomorphism, without loss of generality we can assume U is an open subset of [formula]. Now, replace each curve γ∈A with a slightly "shrunk" curve [formula], so that [formula] does not meet any point from B nor any curve from A. If [formula] denotes the set of shrunk curves, then [formula] Delete from [formula] those curves [formula] that are incident to fewer than 2 points from B, and denote the resulting set of curves [formula]. Then [formula]

Consider the drawing H of the multi-graph whose vertices are the points of B and where two vertices are connected by an edge if the two corresponding points are joined by a curve from [formula]. Then H is an admissible graph drawing. The multigraph H need not be a graph, since two vertices can be connected by several edges. However, the maximum edge multiplicity of H is bounded by some constant C0. Furthermore, [formula], so by Theorem [\ref=crossingNumberIneq],

The proof of Lemma [\ref=STforLinesOnHomeo][formula] is very similar to Pach and Sharir's proof in [\cite=Pach] of the Szemerédi-Trotter theorem for curves with k degrees of freedom, but there are a few key places where the proof differs (and the final conclusion of Lemma [\ref=STforLinesOnHomeo][formula] is slightly weaker). For completeness, we have included a sketch of Lemma [\ref=STforLinesOnHomeo][formula] in Appendix [\ref=PachSharirAppendix].

An earlier result similar to Lemma [\ref=STforLinesOnHomeo][formula] was proved by Pach and Sharir in [\cite=Pach2]. There, the authors required that the curves in A be algebraic curves defined by k real parameters, i.e. there is an assignment from these k parameters to the curves such that any choice of parameters defines at most a constant number of curves, and the dependence of the curves on the parameters is algebraic of low degree. While the curves we are dealing with are algebraic and are defined by k parameters, the dependence of the curves on the parameters is of high degree, so the result from [\cite=Pach2] is not sufficient for our purposes.

[formula]-Alg →  C0

We shall begin by constructing the "error set" [formula]:

[formula]

First, note that [formula] is an algebraic curve, and Now, if [formula] and there exist two distinct surfaces [formula] such that both (p,S) and [formula] are in [formula] then [formula] must contain a 1-dimensional component of [formula] so in particular [formula] is not a discrete set, which contradicts the fact that S is a good collection of surfaces. Thus for each [formula] there exists at most one S∈S for which [formula]. Thus it suffices to control

[formula]

However, [\eqref=numberOfcurvesPassingP] is bounded by the degree of [formula] which is This establishes [\eqref=SPrimeNotTooBig].

Now for each S∈S, we shall partition the curves of [formula] that do not lie in [formula] into classes ΓS,j. Write [formula] as a union of irreducible real curves and isolated points. To each real curve γ, either [formula] or there is a unique index j for which every 1-dimensional connected component of γ lies in Yj (note that γ may have 0-dimensional components, which need not lie in Yj, but by our assumptions on I no incidences can occur on these components). If [formula], place γ in ΓS,j for this choice of j. Similarly, partition P into collections {Pj}, where p∈Pj if j is the minimal index for which p∈Yj. Then if p∈P, S∈S, [formula], then there is a unique index j such that p∈Pj and there exists a curve γ∈ΓS,j with p∈γ. The only way this can fail to be the case is if p∈Pj and every irreducible curve [formula] containing p lies in [formula] for some index [formula]. But this would imply that p is an isolated point of [formula] and by assumption I does not contain any pairs (S,p) for which this can occur.

Thus

[formula]

We wish to consider each variety Yj and the associated points and curves on that variety separately. However, before we do this we need to ensure that the same intersection [formula] does not get counted as two distinct "crossings" on two different varieties (say Yj and [formula]). To prevent this from happening, we will keep track of the points where such an accident might occur. To this end, for each S∈S and each index j let

[formula]

Let γ∈ΓS,j, and let [formula]. Then we define [formula] as follows. Let [formula] be a generic projection of γ onto [formula], let [formula] be the image of x under the same projection, and let g be the squarefree polynomial with [formula]. Then [formula] is the order of vanishing of g at [formula]. In particular, if x∉γ then [formula].

By the same arguments used above to obtain [\eqref=controlIncidences0],

[formula]

On the other hand, we have

[formula]

Indeed, the only way [\eqref=noCrossingsDoubleCounted] could fail is if the following occurs: there exist surfaces S and [formula] a point [formula], indices j and , and curves [formula] and [formula] such that

[formula]

and

[formula]

But if [\eqref=xInBothCurves] holds then x is an isolated point of [formula] so x∈ΞS,j and thus [\eqref=xNotInDoubleCountingSet] fails. This establishes [\eqref=noCrossingsDoubleCounted] .

Thus, we can consider each variety Yj and its associated point and curve sets Pj,{ΓS,j}S∈S individually. We are reduced to proving the following lemma.

Suppose we are given the following data:

A 2-dimensional real variety of the form [formula] with [formula]

A collection of points P, a collection of good surfaces S, and for each S∈S, a collection ΓS,j of irreducible curves in [formula] such that for each γ∈ΓS,j, [formula].

A collection of k-admissible incidences I  ⊂  I(P,S), such that for each (p,S)∈I, there exists γ∈ΓS,j with p∈γ.

For each S∈S, a finite collection of "bad" points ΞS.

Then there exists an incidence model Mj  =  {(Ui,Ai,Bi,ιi)}Mi = 1 satisfying:

For each i, Ai is a collection of simple open curves, Bi is a collection of points, Ui is homeomorphic to a open subset of [formula], and [formula] is an embedding.

[formula]

i.e. the number of crossings between pairs of curves in the incidence model is controlled by the number of crossings of the curves from ΓS,j and [formula] that do not occur on the "bad" sets ΞS or [formula] as S and [formula] range over all pairs of surfaces.

If p∈P, S∈S, and γ∈ΓS,j, then there exists some index i, some p̃∈Bi, and some α∈Ai such that ιi(p̃) = p, α  =  ι- 1i(S), and [formula], i.e. the incidence model counts curve-point incidences.

For each i, the curves in Ai have k degrees of freedom (in the sense of Item [\ref=kDegFreedomItm] from Lemma [\ref=decompOfYLem]).

[formula]

where [formula] is as defined in Definition [\ref=defnOfCurveMult].

Once we have Lemma [\ref=incidenceModelOneComponent], we can prove Lemma [\ref=decompOfYLem] as follows. For each index j, apply Lemma [\ref=incidenceModelOneComponent] to each collection [formula] {ΞS,j}), and denote the resulting incidence model Mj  =  {(U(j)i,A(j)i,B(j)i, ι(j)i)}. From [\eqref=noCrossingsDoubleCounted] and [\eqref=inYjCrossingsControlled], we have

[formula]

If (p,S)∈I, then as noted above there exists a unique index j and a curve γ∈ΓS,j with p∈Pj and p∈γ. But then by Property [\ref=2ndLemma2ndItem], there exists some index i, some p̃∈B(j)i, some α∈A(j)i such that [formula]

Finally,

[formula]

where on the final line we used the fact that [formula].

Thus the incidence model [formula] verifies the requirements of Lemma [\ref=decompOfYLem]. This concludes the proof of Lemma [\ref=decompOfYLem], modulo the proof of Lemma [\ref=incidenceModelOneComponent].

We shall select a very large ball B0 containing all of the points from P, and we shall decompose [formula] into a union of 2-dimensional C∞ manifolds. The manifolds will have the property that for a suitably chosen 2-plane

[formula]

any affine translate of Π0 will intersect a given manifold at most once (such manifolds are called "monotone" in the computational geometry literature).

Indeed, let

[formula]

If our choices for e1 and e2 in [\eqref=defnOfPi0] are generic, then Xj may be empty or it may be a union of isolated points and 1-dimensional curves. We can see that each (necessarily smooth) connected component of [formula] is monotone: First, let [formula] be a generic projection in the direction of some vector v∈Π0, so [formula] is a line passing through the origin (see Figure [\ref=XjFigure]). Let e be a vector so that 〈e〉  =  π(Π). Then if U is a (necessarily bounded) connected component of [formula] then π(U) is also bounded and connected. It suffices to show that for any z∈π(U), z is a smooth point of π(U), and the line z + 〈e〉 meets π(U) solely at the point z. First, suppose π(U) is not smooth, and let z be a singular point. Then since U is smooth and π is a local diffeomorphism in a neighborhood of each pre-image point of π- 1(z), in a small neighborhood of z, π(U) is a union of distinct, smooth 2-manifolds, each of which contains z. Thus, we can find a nearby point [formula] for which [formula] meets π(U) in at least two distinct points, call them [formula] and [formula]. Now, let β be a smooth path in U connecting a pre-image of [formula] to a pre-image of [formula]. Then π(β) is a smooth curve in π(U), and d(π(β)) always lies in TCg(U), the geometric tangent cone of U. But TCg(U) never contains 〈e〉, which is a contradiction. Thus each compact connected component of [formula] is monotone.

We must now count how frequently a curve γ∈ΓS,j intersects [formula]. This will be done in the next two lemmas.

Let P,S, Yj,Zj,Wj,Pj,Qj and {ΓS,j}S∈S be as in the statement of Lemma [\ref=incidenceModelOneComponent]. Select γ∈ΓS,j and let Xj be as in [\eqref=defnOfXj]. Then

[formula]

First, note that if our choices of e1 and e2 in [\eqref=defnOfPi0] are generic, then for each curve [formula], we have that [formula] will be a discrete set of points. Thus, we can guarantee the following things:

Every point of [formula] is a smooth point of γ and a smooth point of Xj. In particular, no point of [formula] is an isolated point of Xj.

At every point [formula] we have the following property: let [formula] be a sufficiently small ball centered at z*, so that if [formula] is the Grassmanian of (complex) 2-planes in [formula], then the tangent bundle is a smooth 2-(complex)-dimensional submanifold of [formula]. Let

[formula]

Then if [formula] is the image of z in [formula] we have that [formula] and J intersect transversely at , so the intersection is a smooth curve in [formula]. Thus in particular, if we apply a small C∞ perturbation to the surface [formula], then the image of the perturbed surface in [formula] will still intersect J transversely.

First, observe: If (Pj,Qj) is a reduced ideal, i.e. if [formula] on [formula] then

[formula]

where

[formula]

Then, to compute [formula], it suffices to count the number of intersection points in [formula], and this is a (set-theoretic) complete intersection. We are working over [formula], so we cannot appeal directly to Bézout's theorem, but we can use arguments similar to those used to obtain [\eqref=controlIncidences0].

In order to make this argument work, we will need to perturb Pj and Qj to make (Pj,Qj) a reduced ideal. Doing so will cause Yj to "split" (in a small neighborhood of a smooth point) into several sheets, and (locally) there will be one or more copy or copies of γ on each sheet. Through careful counting, we can recover the above result.

We will need several elementary results from intersection theory. Further details can be found in standard textbooks such as [\cite=Fulton] [\cite=Harshorne]. Throughout this section, we will choose an embedding of [formula] into [formula] This will allow us to identify points in [formula] with those in [formula] and to identify (complex, affine) polynomials with homogeneous polynomials.

If [formula] we will let If denote the projective ideal generated by f (here as elsewhere, f is identified with its image under the above embedding from [formula] into [formula]). If [formula], let [formula] be the zero set of f (either in [formula] or in [formula], depending on context). If [formula] then [formula] is the local ring obtained by localizing [formula] at the point x (again, we have identified x with its image in [formula]). If [formula] are polynomials, we say that [formula] intersect properly if [formula]

If [formula] intersect properly, and V is an irreducible component of [formula], then we define where x is a generic point of V.

This definition of multiplicity has the following useful geometric property. Let [formula] intersect properly and let V be an irreducible component of [formula]. Select a generic point x∈V and a generic hyperplane H of dimension [formula], such that [formula]. Then we can find a small ball [formula] containing x such that x is the only point in [formula]. Now, let [formula] where [formula] are generic real numbers with sufficiently small magnitude. Then [formula] is a union of [formula] points: if B is a small ball centered around a generic point of V, then if we perturb [formula] the intersection "splits" into [formula] sheets.

Let S be the surface and let γ∈ΓS,j be the curve in the statement of Lemma [\ref=controlOfgammacapXj]. Let

[formula]

where e is a generic vector in [formula]. We can verify that [formula] is an irreducible 3-dimensional variety of bounded degree: in short, select a rotation of [formula] so that e is the x1-direction. By the Tarski-Seidenberg theorem (see e.g. [\cite=Bochnak]), the projection πx1(S) is a bounded degree algebraic variety, with ideal [formula] Let [formula] where [formula] is the canonical embedding of I into [formula]. [formula] has codimension 1, so we can write [formula] for some polynomial fS that generates a real ideal.

Now, [formula] is a 1-dimensional curve, and thus [formula] is a proper intersection. We also have [formula] is a 1-dimensional (complex) curve and so [formula] is a proper intersection. Since [formula] we also have [formula], so there exists an irreducible component [formula] such that (as sets) [formula]. We define [formula] similarly. By Proposition [\ref=propertiesOfRealCplxVar], [formula] is irreducible. Thus [formula] is well-defined. We define

[formula]

where x is a generic point of [formula]. Since [formula] lies generically in [formula] there exists a unique irreducible component V of [formula] that contains [formula], and [formula] where the latter multiplicity is given by Definition [\ref=multiplicityDefn].

We will need a rigorous way to show that if two manifolds intersect transversely, then slight perturbations of the manifolds still intersect transversely. The following definition will aid in this process.

Let U and [formula] be smooth manifolds in some ambient space X (we will have either [formula] or [formula]. We say U and [formula] are ε-close if there exists a diffeomorphism ψ:X  →  X sending U to [formula] and [formula] If [formula] is ε-close to U, we say [formula] is an ε-perturbation of U.

Let [formula] where ε1,ε2 are chosen generically from the interval (0,ε); ε will be chosen later. Then [formula] is a reduced ideal. We claim: If z is a smooth point of γ (and thus z* is a smooth point of [formula]), a smooth point of Yj, and a smooth point of [formula], then if [formula] is a sufficiently small ball centered at x*, then:

[formula] is a union of [formula] smooth disjoint 2-manifolds, and each of these 2-manifolds is a o(1;ε)-perturbation of [formula].

[formula] is a union of [formula] smooth curves, and each of these curves is a o(1;ε)-perturbation of [formula] These curves lie on the various connected components of [formula]

The key observation is the following.

Select [formula] and let ρ > 0. Let B be the ball centered at z of radius ρ. Then provided ε is sufficiently small (depending on ρ), we have

[formula]

The idea is to show that each of the [formula] 1-dimensional curves in [formula] intersects some 1-dimensional curve from [formula]. We expect this to happen because the (unperturbed) curves intersect transversely, and the perturbation is very small.

Indeed, let ζ  ⊂  B be a simple curve from [formula] Then since [formula] is smooth, ζ is a o(1;ε)-perturbation of [formula], in the sense of Definition [\ref=defnOfPerturbation]. Let [formula] be the smooth 2-manifold containing ζ. Then since [formula] is smooth, [formula] is a o(1;ε) perturbation of [formula]. Now, z is one of finitely many intersection points of γ and Xj, and each of these intersections are transverse. Thus if we select ε sufficiently small (depending on both the transversality of the intersection and ρ), then ζ and [formula] must intersect. Thus in particular, ζ intersects [formula] But there are [formula] such curves ζ. This establishes the lemma.

We claim: if ε is sufficiently small, then there exists a curve [formula] which is the "image" of [formula] under the above perturbation. Indeed, we can select a small constant c so that if [formula] is the set of points that are distance at least 2c from any point of [formula] that does not lie in [formula], then G contains an open interval. Let [formula] be a point contained in the relative interior of this open interval, and let B1 be a small ball centered at z. Then if we select ε sufficiently small, then [formula] is a union of curves, each of which is a c-perturbation of [formula]. Let ζγ be the smallest algebraic set containing [formula] We have [formula] ζγ corresponds to the intuitive notation of the "image" of [formula] under the perturbation.

We can now bound the degree of ζγ. Let [formula] be a generic 3-plane. Then [formula]. But by the definition of multiplicity above, to each point [formula], we can find a small ball B centered at x such that Thus

[formula]

Lemma [\ref=numberOfPerturbedVerticalIncidences] can be rephrased as the statement

[formula]

i.e.

[formula]

But this and [\eqref=degzetagamma] imply that

[formula]

This concludes the proof of Lemma [\ref=controlOfgammacapXj].

Let S, Yj,Zj,Wj,Pj,Qj and {ΓS,j}S∈S be as in the statement of Lemma [\ref=incidenceModelOneComponent], and let S∈S. Then

[formula]

Let [formula] be as defined in [\eqref=defnSDagger]. For each γ∈ΓS,j, let [formula] and [formula] be defined as above. Then if [formula] there must be smooth points of Yj in every (Euclidean) neighborhood of x (γ∈ΓS,j implies γ lies generically on [formula]). Thus x* is a singular point of [formula], so

[formula]

From this we can conclude that x* is a singular point of the (not necessarily irreducible) curve [formula]. Furthermore, the number of intersection points of [formula] with [formula] (counting multiplicity) as γ ranges over all curves in ΓS,j is controlled by the number of singular points of [formula] that occur on S* (again, counting multiplicity). Let [formula] be the union of all irreducible curves in [formula] that are not contained in S*. Then the number of singular points of [formula] that occur on S* is at most the number of singular points of [formula] plus the number of intersection points of ζ with S* (again, counting multiplicity). The former quantity is at most D2j, and the latter is at most DjEj.

We can now complete the proof of Lemma [\ref=incidenceModelOneComponent]. Fix a choice of S∈S. For each γ∈ΓS,j, Delete the points that lie in ΞS, the points of [formula] the points of [formula] and the points that lie on some [formula] We can verify that after these points have been removed, the remaining set is a disjoint union of connected 1-dimensional manifolds. Furthermore, the number of 1-manifolds is

[formula]

Indeed, every time a point x is removed, the number of manifolds can increase by at most [formula]. If [formula] then [formula], so the number of curves added by removing points of this type is at most [formula] We can apply similar bounds to control the number of manifolds that are added when the other types of points are excised.

Now, each of these 1-manifolds is homeomorphic to either the interval (0,1) or the circle S1. For those manifolds that are homeomorphic to circles, remove two points at random to obtain two curves homeomorphic to (0,1). Our new collection of simple curves has the same cardinality (up to a factor of two), and each curve lies entirely within a single component of [formula]. Let {Ui} be the connected components of [formula] and let Ai consist of those simple curves lying in Ui, as γ ranges over [formula]. Let [formula] and let [formula] be the canonical embedding of Ui into [formula].

From [\eqref=numberOfCurvesFromS] we have

[formula]

so Requirement [\ref=incidenceModelOneComponentItm5] is satisfied. In order to verify the remaining requirements we shall introduce some notation

Let α∈Ai for some index i. Then there exists a unique surface S0∈S and a unique curve γ0∈ΓS0,j such that α  ⊂  ι- 1i(γ). We will define S(α) to be S0 and we will define γ(α) to be γ0.

We can verify that [formula] i.e. that [formula] since the vectors e1 and e2 from [\eqref=defnOfPi0] were chosen generically. Recall as well that by assumption, [formula]. If γ∈ΓS,j,p∈P, p∈γ, then we can immediately verify that either there exists an index i and a curve α∈Ai with γ(α) = γ and p∈∂(ιi(α)), or there exists an index i, a curve α∈Ai, and a point p̃ in Bi with ιi(p̃)  =  p, γ(α) = γ, and p̃∈α. Thus Requirement [\ref=incidenceModelOneComponentItm3] is satisfied.

To verify Requirement [\ref=incidenceModelOneComponentItm2], note that if [formula] and [formula] Then [formula] and [formula] Furthermore, [formula] are the unique pair of curves in {Ai} corresponding to the triple [formula]

To obtain Requirement [\ref=incidenceModelOneComponentItm4], we shall apply a slight perturbation to the curves of {Ai} as follows: for each curve α∈Ai and point p∈Bi, if p∈α but (S(α),ι(p))∉I, modify α in a small neighborhood of p so that p∉α. We can always do this in such a way that the number of crossings between α and the other curves is not affected, and α remains unchanged in a small neighborhood of every point [formula] distinct from p. After this perturbation has been performed for every curve, then the collection {(Ai,Bi)} satisfies Requirement [\ref=incidenceModelOneComponentItm4]. Indeed, since I is k-admissible, if there exists an index i, a collection of k points [formula] and a collection of C0 + 1 curves in Ai such that each curve is incident to each of [formula], then there must exist two curves [formula] from this collection of curves such that [formula]. However, this implies that ιi(α) either contains a singular point of γ(α), or it contains a point of [formula] (if [formula]). But by our construction of Ai, no such points may lie on any curve in Ai. Thus Requirement [\ref=incidenceModelOneComponentItm4] is satisfied.

Finally, recall that we already established Requirement [\ref=incidenceModelOneComponentItm1] above (in the discussion preceding Lemma [\ref=controlOfgammacapXj]).

Open Problems and Further Work

Theorems [\ref=surfacesInR4Thm] and [\ref=surfacesInR4Thm][formula] have several obvious shortcomings, namely the fact that we do not have a uniform bound on the cardinality of a collection of 2-admissible incidences I  ⊂  I(P,S) which does not depend on the ratio log |P| /  log |S|, and in addition we loose a log |P| factor when bounding the cardinality of a collection of k-admissible incidences. This gives rise to our first conjecture:

Let [formula] be a collection of points, let S be a good collection of surfaces, and let I be a collection of k-admissible incidences. Then

[formula]

In order to prove Conjecture [\ref=noLossConjecture] for the case k = 2, it appears that we need a way to deal with incidences between points p∈P and surfaces S∈S for which [formula] is a 1-dimensional curve, and p lies on [formula] Here Y is as defined in Lemma [\ref=crossingNumberIneqLemma]. For k > 2 we need to deal with both this problem and the logarithmic loss introduced by emulating the Pach-Sharir proof for obtaining bounds on incidences between points and curves with k degrees of freedom. It seems plausible that a cleverer modification of the Pach-Sharir techniques might remove this logarithmic loss.

We can also ask similar questions in higher dimensions, and here things appear to be more difficult. In [formula] we define a family of surfaces S to be good if it satisfies the requirements from Definition [\ref=goodDefn], except in place of Requirement [\ref=goodDefnDim2] we require that every surface in S has dimension d. We define a set of incidences I  ⊂  I(P,S) to be k-admissible if it satisfies the requirements from Definition [\ref=admissibleDefn]. We then have the following conjecture.

Let P be a collection of points in [formula] d even, and S a collection of smooth d / 2-dimensional algebraic surfaces of degree O(1) such that every two surfaces meet in O(1) points and at most O(1) surfaces pass through any collection of k points. Then

[formula]

The bound [\eqref=conjecturedHigherDimBound] is what you would obtain if you performed a cell decomposition on the point set P with a polynomial P whose degree was chosen to minimize the number of incidences inside the cells, and you ignored incidences occurring on the boundary of the cells, i.e. if you only considered Section [\ref=firstDecomp] from the proof of Theorem [\ref=baseCaseThm]. This assumption is satisfied if the points in P are in general position in [formula].

Conjecture [\ref=conj1] is an obvious generalization of a conjecture of Tóth [\cite=Toth], who proposed Conjecture [\ref=conj1] in the case where S is a collection of affine d-planes. The conjecture seems plausible because a slight modification of the methods used by Solymosi and Tao in [\cite=Solymosi] yield the following slightly weaker statement:

Let P,S,I be as in Conjecture [\ref=conj1]. Then for any ε > 0, we have

[formula]

More ambitiously, we could conjecture

Let P be a collection of points in [formula] and S a collection of smooth [formula]-dimensional algebraic surfaces, [formula], of degree at most C0 such that every [formula] surfaces meet in at most C0 points and at most C0 surfaces pass through any collection of k points, [formula]. Then

[formula]

Again, the bound in Conjecture [\ref=secondConj] is the one we would obtain if we used the polynomial ham sandwich theorem to cut [formula] into cells and applied Lemma [\ref=turanBoundLemma] to control each cell, i.e. Conjecture [\ref=secondConj] is saying that the number of incidences between surfaces and points on the boundary of the (first level) cell decomposition is controlled by (the worst case behavior of) the number of incidences between surfaces and points in the interior of the (first level) cell decomposition.

It appears that in order to resolve these conjectures some new techniques must be developed. In particular, it appears that in order to control the number of incidences between points and [formula]-dimensional varieties, we need to perform [formula] polynomial ham sandwich decompositions, with each successive decomposition performed on the variety defined by the previous decompositions. As [formula] increases, the number of cases to be considered increases dramatically, and certain difficulties such as the failure of the connected components of a complete intersection to themselves be complete intersection, the failure of a set-theoretic complete intersection to be a nonsingular complete intersection, etc. become increasingly problematic. A second difficulty is that the surfaces in S need not form a complete intersection with the polynomial ham sandwich cuts. This was already the main difficulty for proving Theorems [\ref=surfacesInR4Thm] and [\ref=surfacesInR4Thm][formula]. In our proof, however, it was only necessary to perform two ham sandwich decompositions, and we were left with a problem about points and curves on a 2-dimensional surface, so we could appeal to the crossing number inequality. In higher dimensions there is no obvious analogue of the crossing number inequality, and thus it is not obvious how to proceed.

Proofs of Lemmas from Section [\ref=preliminariesSection]

Let [formula]. Write [formula] as a product of irreducible factors. Place each irreducible factor that generates a real ideal in Q. If Pj is a factor that does not generate a real ideal then consider [formula] for v a generic vector. We have [formula] and [formula] Apply the above procedure to [formula]. This process will terminate after finitely many iterations. Let [formula].

Let p∈P, and let H  =  Tp(V). Suppose there existed surfaces S1,S2∈S with [formula] Recall that p must be a smooth point of S and of [formula]. Since S  ⊂  V, we have Tp(S)  ⊂  Tp(V) = H. Similarly, [formula]. Since I is k-good, [formula] Thus we have two affine 2-planes, Tp(S) and [formula] which meet only at the point p, but both are contained in the affine 3-plane H. This cannot occur. Thus for each point p∈P, there can exist at most one surface S∈S with (p,S)∈I. Thus

[formula]

The proof is similar to the proof of Lemma 13 in [\cite=Zahl], so we will only give a brief sketch here. First, select a large number R so that every cell that meets S does so within the ball centered at the origin of radius R. Let P̃  =  P  ·  fB, where fB(x1,x2,x3,x4)  =  x21 + x22 + x23 + x24  -  R2. Thus the number of cells of [formula] that S meets is at most the number of bounded cells of [formula] that S meets. Since the property of S meeting a cell is open, we can apply a small generic translation to S and a small generic perturbation to P̃, and doing so can only increase the number of bounded cells that S meets. Now, we can find f1,f2 such that [formula] (f1,f2) is a reduced ideal, and f1 and f2 are of bounded degree. Let v be a generic vector in [formula], and let [formula]. Then [formula]. Now, the number of cells of [formula] that S enters is controlled by the number of (necessarily non-singular) intersection points of S, [formula], and [formula] (again, see Lemma 13 in [\cite=Zahl] for details), and this is O(D2).

Write [formula] as a union of irreducible curves, and denote this collection of irreducible curves by Γ. By Harnack's theorem, [formula] can have at most O(( deg P)2) components (again, see Remark [\ref=HarnackRemark] for details). Now, for each irreducible curve γ∈Γ and each Q∈Q, either [formula] or [formula] and thus [formula]. We will call intersections of this type "important" intersections between S, Z and [formula]. If [formula], then since [formula], [formula], and thus γ does not enter any realizations of realizable strict sign conditions of Q on Z. Now, if Ω is a realization of a realizable sign condition of Q on Z, and [formula], then we can associate to the pair (S,Ω) an important intersection of S, Z, and [formula] for some Q∈Q in such a way that every important intersection is assigned to at most 2 pairs (S,Ω). Thus the number of realizations of realizable strict sign conditions of Q on Z is at most [formula].

Pach-Sharir's bound for curves with k degrees of freedom

If we attempt to draw a graph on the region U in the same manner as in Lemma [\ref=STforLinesOnHomeo], we run into the difficulty that many curves can connect two vertices, and a priori we do not have a way to bound the number of such curves, so we cannot use Theorem [\ref=crossingNumberIneq] to obtain useful bounds on the number of edge crossings. To get around this problem, we will partition the points in B into roughly log |B| diadic size ranges based on the degree of the points, i.e. the number of edges meeting each point. We will use the crossing number inequality to control the number of edges in each piece of this diadic decomposition and then sum the contributions from each piece. Pach and Sharir consider the case where C(U) is comparable to |A|2, and they are able to use some careful arguments to avoid introducing an additional log |B| factor into their bounds. Unfortunately in our case C(U) may be much smaller than |A|2 so we cannot use their techniques to avoid the log |B| factor that appears in [\eqref=pachSharirStyleControl].

For p∈B, let d(p) be the number of curves in A that contain p. Define

[formula]

Let [formula] be the degree (up to a factor of 2) of the points in [formula], and let [formula]. Note that

[formula]

We have [formula], and thus it suffices to control [formula]. Define

[formula]

We have

[formula]

Applying Lemma [\ref=turanBoundLemma] we have

[formula]

We shall now control [formula] for [formula]. Let [formula] be the graph drawing whose vertices are the points [formula], and where if two vertices both lie on a curve γ∈A with at most k - 2 points of [formula] in between them, then we connect them by the piece of γ lying between them (thus in general several edges will be drawn on top of each other, and two vertices may be connected by several different edges). Let [formula] be the graph obtained from [formula] by erasing every edge whose multiplicity exceeds [formula] for some large constant C to be chosen later. We have

[formula]

We claim that

[formula]

Equation [\eqref=HellControlsIncidences] is proved on pages 124-5 of [\cite=Pach], and the proof for us is identical.

Now, every point on a curve α∈A belongs to the relative interior of at most [formula] edges of [formula] lying on α, so there is a subgraph [formula] with [formula] such that no two edges of [formula] overlap, i.e. [formula] is an admissible drawing of a multigraph with maximum edge multiplicity [formula]. Let For [formula],

[formula]

but since [formula], we get [formula] and thus

[formula]

If [formula], then by [\eqref=crossingNumberIneqEqn],

[formula]

Adding back the (k - 1)|A| incidences from curves passing through fewer than k point of [formula], we obtain

Summing over all indices [formula] and noting that [formula], and [formula] we obtain

[formula]

Combining [\eqref=congtrolJij1], [\eqref=controlOfJ2slashJ3], and [\eqref=sumIncidencesij], we obtain the lemma.