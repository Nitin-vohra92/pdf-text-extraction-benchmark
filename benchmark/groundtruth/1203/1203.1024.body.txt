Lemma Claim

The Janson inequalities for general up-sets

and Lutz Warnke

Let [formula] be a probability space, and I  ⊆  F a collection of events with the following properties:

[formula]

and

[formula]

The standard and most important example is when Ω  =  {0,1}S is a product probability space (with product measure), and I is the collection of all increasing events, i.e., events A such that ω∈A and [formula] pointwise imply ω'∈A. (Of course, one can instead take all decreasing events.) Then [\eqref=Icorr] is simply Harris's Lemma [\cite=Harris] (also known as Kleitman's Lemma [\cite=Kleitman]). There are other examples, such as increasing events in random cluster models with parameter [formula]; see [\cite=FKG].

Let [formula], write Ii for the indicator function of Ai, and set

[formula]

and

[formula]

where we write i  ~  j if i  ≠  j and Ai and Aj are dependent. (Note that we sum over ordered pairs, and exclude the term i = j. These conventions are not universal!)

Under the conditions above we have

[formula]

and, for any [formula],

[formula]

where φ(x) = (1 + x) log (1 + x) - x with φ( - 1) = 1.

When the events Ai are principal up-sets, i.e., events in a product space {0,1}S of the form [formula] for some αi  ⊆  S, the first inequality in [\eqref=i2] is the well known Janson inequality [\cite=Janson]. The second is also given in [\cite=Janson]; for other convenient weaker forms see [\cite=JLR_book]. Under the same assumptions, [\eqref=i1] was proved earlier by Janson, Luczak and Ruciski [\cite=JLR_ineq]. We shall prove Theorem [\ref=th1] by modifying the proofs of these inequalities to avoid applying Harris's Lemma to the conditional measure [formula].

We begin with a simple observation that, in the standard setting, follows from the equality conditions in Harris's Lemma. Indeed, we claim that, for each i,

[formula]

To see this, note first that if A,B,C∈I and A is independent of B and of C, then

[formula]

Since, by [\eqref=Iclosed], [formula] and [formula] are in I, by [\eqref=Icorr] we have

[formula]

The sum of these inequalities is the equality [\eqref=e1], so both inequalities are equalities, and in particular A is independent of [formula]. Since Ai is independent of each Aj∈Si by definition, it follows inductively that Ai is independent of any intersection of events Aj∈Si, so Ai is independent of the set Si of events, as claimed.

To prove [\eqref=i1] we modify the argument given by Boppana and Spencer [\cite=BS], following the presentation in [\cite=AS]. Following Boppana and Spencer, set [formula], so [formula]. It suffices to show that for each i we have

[formula]

since the sum of the final expression is exactly μ  -  Δ / 2. Fix i. Still following [\cite=BS] [\cite=AS], set

[formula]

noting that, by [\eqref=claim], Ai is independent of R. Then

[formula]

(We may assume that [formula], since otherwise [formula].) At this point the original argument involves writing the final probability as [formula]. Instead, we simply write

[formula]

By [\eqref=Iclosed], [formula], so [formula]. Since [formula], using [\eqref=Icorr] and the union bound it follows that

[formula]

Recalling that Ai is independent of R, combining [\eqref=e2], [\eqref=e3] and [\eqref=e4] gives [\eqref=aim], completing the proof of [\eqref=i1].

Turning to [\eqref=i2], fix [formula] and let

[formula]

so X = Yi + Zi, with Zi containing the terms independent of Ii and Yi the others (including Ii itself). In the proof of [\eqref=i2] given in [\cite=JLR_book], the only step in which anything is assumed about the events Ai is (2.20) on page 32, where it is shown (in our notation) that for [formula] and each [formula],

[formula]

Proceeding much as in the proof of [\eqref=aim], note that

[formula]

Also,

[formula]

where

[formula]

Now from [\eqref=claim], Ii and Zi are independent, so [formula]. We may write f in the form [formula], where [formula] are the distinct values taken by f, and each Jj is the indicator function of the event [formula]. Note that any such Bj may be expressed as [formula] for some set J of subsets of [formula], so [\eqref=Iclosed] implies Bj∈I. Writing 1 - g in an analogous form, it follows from [\eqref=Icorr] that [formula], so [formula]. Hence,

[formula]

Using [\eqref=e5] for the first step this gives

[formula]

This is exactly [\eqref=aim2], and the rest of the proof in [\cite=JLR_book] is unaltered.

We have stated two of the best-known and cleanest forms of the inequalities in Theorem [\ref=th1]. Let us note that other forms also hold in the present more general context. For example, the inequality [\eqref=aim] leads to the bound

[formula]

where [formula]. This bound was given by Boppana and Spencer [\cite=BS] (for ε = 1 / 2); see also [\cite=AS] [\cite=JLR_book].

Furthermore, [\eqref=aim2] is the only step in the proof of Lemma 1 of [\cite=JLR_ineq] that requires any assumptions about the Ai. Hence this result, which is slightly stronger than [\eqref=i1], also holds in the present setting, giving (in our notation)

[formula]

A key feature of the various Janson inequalities is that when Δ is small, then the bounds are close to best possible, since [formula]. We have not stressed this since it is well known that this lower bound applies to general up-sets Ai, by Harris's Lemma. Similarly, it applies whenever the Ai are in some collection I of events satisfying [\eqref=Icorr] and [\eqref=Iclosed].

The bounds in [\eqref=i2] can be extended to the weighted case [formula] with positive ci, studied, e.g., in [\cite=KV]: we obtain

[formula]

where [formula] and

[formula]

for [formula]. (In applications, it may be convenient to note that [formula] when [formula].) The proof of [\eqref=i2e] is a straightforward modification of that of Theorem 2.14 in [\cite=JLR_book]. The key inequality is again [\eqref=aim2], now with [formula] replaced by [formula] in the definitions of X, Yi and Zi. The proof above carries over since all ci are positive. Finally, in this setting [\eqref=i2a] also holds, with [formula] replaced by [formula].