Proposition Lemma Definition Corollary Example Claim

Conjecture

An (almost) optimal answer to a question by Wilf

Introduction

We say that two permutations [formula] and [formula] are identically ordered provided [formula]

Let p be a permutation of length n with entries denoted [formula]. We define a subsequence of p to be a sequence [formula] where [formula]. We say that p  contains a pattern [formula] if there exists a k-subsequence of p  that is ordered identically with q.

At the Conference on Permutation Patterns, Otago, New Zealand, 2003, Herb Wilf asked how many distinct patterns could there be in a permutation of length n. Based on empirical evidence, it seems this number may approach the theoretical upper bound of 2n. In this paper we enumerate patterns contained in a certain class of permutations to at least establish a lower bound for this function.

Let f(p) be the number of distinct patterns contained in a permutation p. Let h(n) be the maximum f(p) for any permutation p of length n. Upper bounds for h(n) are the number of all subsequences, 2n, and the number of permutations for each pattern length, k!. As n grows, this second bound quickly becomes insignificant, as

[formula]

for all k above a breakpoint which grows much slower than n. Therefore, we are concerned with proving that h(n) grows almost as fast as 2n.

Wilf demonstrated a class of permutations for which [formula].

Let Wn denote the n-permutation [formula]. It should be clear that

[formula]

Then, the number of patterns contained in Wn which do not include the first entry is f(Wn - 1). The number of patterns contained in Wn which are required to include the first entry but are distinct from those just enumerated is f(Wn - 2). If f(Wn)  =  f(Wn - 1)  +  f(Wn - 2) then the sequence [formula] is at least a [formula] sequence, where each point is the sum of the two previous points. In fact, this sequence has a rate of growth greater than the [formula], the (eventual) rate of growth of [formula] sequences.

We examined properties of all permutations up to length 10 and many beyond. A pleasantly surprising phenomenon was that [formula] appears to be a monotonically increasing function. The permutation

[formula]

has 16874 distinctly ordered subsequences, more than 2n - 1 for n  =  15. It seemed evident that Wilf's rate of growth could be improved upon. In this paper we present a class of permutations πk where f(πk) exceeds [formula].

The Construction

Let p be a permutation. We call an entry pi a descent if pi  >  pi + 1.

For n  >  3, there exists an n-permutation containing more than [formula] distinct patterns

Let πk denote the permutation

[formula]

For example,

π3  =  3 6 9   2 5 8   1 4 7

π4  =  4 8 12 16   3 7 11 15   2 6 10 14   1 5 9 13

It should be noted that the only descents in such a permutation are at the last entry of each segment, descending to the first entry of the subsequent segment. As these points play a signifanct role in our proof, we shall denote the first entry of each segment the [formula] of that segment.

Also, each segment is structured so that the ith entry of that segment is less than the ith entry of each preceding segment.

As counting all patterns of such a permutation leads to overwhelming complexity, we will restrict our attention to counting only certain patterns. Let k  >  3. For the subsequences under consideration, we require that the first k entries of πk be included, i.e., every entry in the first segment. Also, we include the perigee of each of the other segments. For example, underlining the entries required in π4,

[formula]

Requiring these 2k  -  1 entries leaves k2  -  (2k  -  1)  =  (k  -  1)2 entries to choose from. To maximize the number of choices, we will choose half of these remaining entries for inclusion. Altogether, there will be [formula] subsequences of length [formula] fulfilling these requirements. We claim that these subsequences are distinctly ordered, i.e., correspond to distinct patterns.

Suppose q and r are identically ordered subsequences of this type. Then, the descents in q and r must be at the same positions. We required the perigee of each segment of πk to be included in q and r, so any descent will immediately precede a perigee. Therefore, each perigee occupies the same position in q as in r. This, in turn, implies that the ith entry of q lives in the same segment of πk as does the ith entry of r, since they are situated between the same perigees.

Furthermore, included in both q and r are all entries of the first segment of πk. Since q and r are identically ordered, by definition, [formula]. If there was some entry in the first segment of πk that was less than some qi and greater than ri, then q and r would not be distinctly ordered as was assumed. As noted earlier, the ith entry of each segment of πk is less than the ith entry of πk itself. So, any two entries qi and ri occupy the same position within the same segment and are, in fact, equal. Therefore, q  =  r.

We've shown that two identically ordered subsequences must actually be the same, and our claim follows that the subsequences are all distinct.

Stirling's approximation gives

[formula]

So, the number of distinct subsequences fullfilling the above requirements in πk will approach

[formula]

.

Letting n  =  k2, the length of the permutation πk, we have, as n  →    ∞  ,

[formula]

Long Distance Relationships

[formula] There is still much in this area to be explored. While the above class of permutations lends itself to proof, like Wilf's, it is a tradeoff between manageability and performance. We have only counted a restricted number of patterns in certain less than optimal permutations. The Holy Grail here would be tighter bounds for h(n).

Second to that a strong result would be an inductive proof on n that for any permutation π of length n, one could find a permutation of length n + 1 that contains π as well as at least 2f(π) patterns. This would at least prove that h(n) grows at least as fast as 2n for all n.

The aim for optimizing the permutation is typically to maximize the sum of the geographical and numerical distances between any two entries. That was how the above class of permutations was discovered, although this property was not explicitly used in the proof.

cm