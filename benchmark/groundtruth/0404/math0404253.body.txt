Theorem : Proposition : Example continued: Lemma Proposition Corollary Definitions Algorithm

Irreducible compositions and the first return to the origin of a random walk

Edward A. Bender Gregory F. Lawler , Robin Pemantle , Herbert S. Wilf

ABSTRACT: Let [formula] be a pair of compositions of n into k positive parts. We say this pair is irreducible if there is no positive j  <  k for which [formula]. The probability that a random pair of compositions of n is irreducible is shown to be asymptotic to 8 / n. This problem leads to a problem in probability theory. Two players move along a game board by rolling a die, and we ask when the two players will first coincide. A natural extension is to show that the probability of a first return to the origin at time n for any mean-zero variance V random walk is asymptotic to [formula]. We prove this via two methods, one analytic and one probabilistic.

Keywords: generating function, central limit, renewal, Cauchy integral, diagonal, camembert region, dice game

Subject classification: Primary: 60C05, 05A16; secondary: 05A15, 05A17, 60G50.

Introduction

By a composition of n into k parts we mean an ordered representation of n as a sum of k positive integers. Let C and C' denote respectively the compositions [formula] and [formula] of n into k parts. We'll say that C,C' are an irreducible pair if for every [formula] we have [formula], while, of course, equality holds at j = k. Note that we allow [formula] for i  ≠  j.

Our starting point for this note is the following. Let f(n) denote the number of irreducible ordered pairs of compositions of n into the same number of parts.

[formula]

This gives a combinatorial interpretation to sequence A081696 of Sloane's database. Furthermore, if we let pn denote the probability that a pair of compositions is irreducible when chosen uniformly at random from among all pairs of n compositions into an equal number of parts, then

[formula]

Remark: A somewhat similar problem about integer partitions was studied by Erd os et al [\cite=ENS].

The asymptotics in ([\ref=eq:comp_asym]) and ([\ref=eq:p]) are derived from the exact computation ([\ref=eq:comp_GF]). We compare this to another well known paradigm for analyzing compositions, namely poissonization. It is well known that a uniform random composition of n may be generated by letting {Yj:j  ≥  1} be independent random variables whose distribution is geometric with mean 2, that is, [formula]. Let [formula] denote the partial sums. If T: =  min {k:Wk  ≥  n} is the first time the partial sums exceed n, then [formula] is uniformly distributed over compositions of n. The number of parts of the composition is T, which is asymptotically normal with mean n / 2 and standard deviation [formula]. Conditioning on T = k gives the uniform distribution on compositions of n into k parts.

From this viewpoint, a pair of compositions with the same number of parts is just a pair of independent random walk sequences {Yj} and {Yj'}, conditioned to have the same stopping time T  =  T'. Irreducibility of the pair corresponds to Wj  ≠  Wj' for all 1  ≤  j  ≤  T - 1. Let [formula] be the partial sums of the difference sequence {Xj}. Then irreducibility corresponds to τ  =  n, where τ is the first return time, that is, τ  =   min {k  ≥  1:Sk  =  0}.

A rigorous proof of ([\ref=eq:p]) via analysis of the return time of {Sn} to the origin would require, among other things, showing that conditioning on T  =  T' does not significantly affect the distribution of the return time. This would be far messier than the compact proof of Theorem [\ref=thm:irreducible] below. Nevertheless, the poissonization paradigm raises the question of the distribution of the return time of {Sn} to the origin. The same question arises in a game similar to Parcheesi with only one token per player. Here, the two players each roll a die and (simultaneously) advance their token the number of positions shown on the die. When the tokens collide, they must both go back to start. The chance of the first collision occurring at time n is just [formula]. Our main result is the following asymptotic for an:

Let {Xj:j  ≥  1} be independent with mean zero, finite variance, V, and no periodicity (that is, the GCD of times n at which it is possible to have Sn  =  1 is 1). Let {Sn}, τ and an be as above. Then the probability an of the first return to 0 occurring at time n is asymptotically given by

[formula]

Surprisingly, given the wealth of knowledge about random walks, we were unable to find this theorem in the literature. The formula is not surprising, and is what one obtains in a thumbnail calculation by "differentiating" with respect to n estimates such as ([\ref=eq:Q]) below, which is an estimate for [formula]. There are special cases, such as the simple random walk where Sn  =    ±  1 according to a fair coin-flip, in which an is easy to compute exactly. Asymptotics in the general case are well known for many quantities such as Qn and [formula], but we could find no text that included asymptotics for an and indeed these seem tricky to obtain by probabilistic methods; a probabilistic proof of Theorem [\ref=th:finite_variance] is the subject of the last section of this note.

In the remainder of this section, we prove Theorem [\ref=thm:irreducible]. In the subsequent section we prove Theorem [\ref=th:finite_variance] by analytic means. In the final section, we give a probabilistic proof of Theorem [\ref=th:finite_variance].

Proof of Theorem [\ref=thm:irreducible]: Let f(n,k) be the number of irreducible ordered pairs of compositions of n into k parts. We will show that

[formula]

from which ([\ref=eq:comp_GF]) follows by setting y  =  1.

To show ([\ref=eq:twovar]), by considering the number of ordered pairs of compositions of n into k parts such that the partial sums of the parts agree with each other at indices [formula], we see that

[formula]

the right side being the total number of pairs of compositions of n into k parts. Hence if [formula], we have

[formula]

in which the Pn's are the Legendre polynomials. The claimed result ([\ref=eq:twovar]) now follows by solving for F.

The estimate ([\ref=eq:comp_asym]) follows from ([\ref=eq:comp_GF]) via standard Tauberian theorems. The result of Flajolet and Odlyzko, for instance (Theorem [\ref=th:FO] quoted below) suffices, although ([\ref=eq:comp_asym]) may also be obtained by the method of Darboux which requires a smaller region of analyticity. Since there are

[formula]

ordered pairs of compositions of n with the same number of parts, it follows that the probability that a random pair of compositions of n with the same number of parts is irreducible is ~  8 / n. [formula]

Analytic proof

Let [formula] be the generating function for the probabilities an of first return at time n. Let [formula], where [formula] is the probability of a return to the origin at time n but not necessarily the first return (set a0'  =  1 and a0  =  0). Then G and H are analytic on the open unit disk and G  =  1  /  (1  -  H). We will use this to obtain H from G, while G in turn is obtained from the two-variable generating function

[formula]

Finally, we may write F  =  1  /  (1  -  zg(w)) where

[formula]

is the generating function for X1.

The following estimates are elementary. From the local central limit theorem [\cite=Dur], as n  →    ∞  ,

[formula]

Consequently,

[formula]

as [formula]. To see this, let ε denote 1  -  z and compute

[formula]

using dominated convergence at the first approximation.

Finally, for H  =  1  -  1 / G, we have the estimate

[formula]

as [formula]. The proof of Theorem [\ref=th:finite_variance] rests on these estimates and on the following Tauberian theorem of [\cite=FO]:

Say that a region R is a Camembert region if it is of the form [formula]. If a function H is analytic in a Camembert region and H(z)  ~  C(1 - z)-  α near z  =  1, then its coefficients an satisfy

[formula]

[formula]

Proof of Theorem [\ref=th:finite_variance]: Let C denote the unit circle. For fixed w∈C, the function F(z,w) is analytic as z varies over the open unit disk; this follows from absolute convergence of the power series. It also follows that F(z,w) is continuous in (z,w) on the product Ω: = D  ×  C of the open unit disk with the unit circle. For fixed w∈C, the Cauchy integral formula gives

[formula]

We may sum this over n and exchange the sum and integral as long as |z|  <  1, leading to

[formula]

where γ goes around the unit circle, counterclockwise.

Suppose we can show G to be analytic in a Camembert region. It follows that H  =  1  -  1 / G is meromorphic in a Camembert region, and since a function whose coefficients go to zero may have no poles in the closed unit disk, it follows that H is analytic in a Camembert region. The conclusion of the theorem will then follow from ([\ref=eq:H]) and Flajolet-Odlyzko.

Claim: There is a Camembert region R such that z  ≠  1  /  g(w) for any z∈R and w on the unit circle, C. Consequently, F(z,w) has an extension to R  ×  C that is analytic in z and continuous in (z,w).

Proof: The facts that X1 is a probability distribution, has mean zero, and has variance V translate into three facts about g, namely, g(1)  =  1,g'(1)  =  0,g''(1)  =  V. Immediately, we then have

[formula]

Hence arg (1 / g(w))  →  0 as w  →  1 in C and there is an δ  >  0 such that for arg (z - 1)  >  δ and |θ|  <  δ, z  ≠  1  /  g(eiθ). For 1  ≠  w∈C, aperiodicity of X1 implies |g(w)|  <  1. Let ε be the minimum of δ and the values |g(eiθ)|- 1  -  1 on [formula]. Then z  ≠  1  /  g(w) on the Camembert region R(ε). [formula]

Finishing the proof of Theorem [\ref=th:finite_variance], we let R be as in the conclusion of the lemma and observe that for any closed loop β in R, we may exchange the order of integration in the representation of G in ([\ref=eq:cauchy]) to get

[formula]

By Morera's theorem, G is analytic in R, completing the proof of Theorem [\ref=th:finite_variance]. [formula]

Probabilistic proof

Let [formula] and [formula] denote probabilities for {Sn  =  y} respectively with or without killing at the origin. These quantities are symmetric in the two arguments. Previously defined quantities are related to these by an'  =  pn(0,0) and an  =  qn(0,0). We let [formula] be the tail sums of {an}.

The derivations of ([\ref=eq:CLT]), ([\ref=eq:G]) and ([\ref=eq:H]) in the probability literature are via the generating function analysis in the previous section. At this point, the methods part ways. The probabilistic analysis derives an from its tail sums, Qn. The reasonably well known estimate on Qn is

[formula]

This is proved analytically, not via extending a two-variable generating function to a Camembert region, but just from ([\ref=eq:H]). The key here is that the sequence {Qn} is monotone. According to a Tauberian theorem which may be found in [\cite=Fel], the extra regularity, together with the behavior of its generating function H  /  (1 - z) for real [formula], implies ([\ref=eq:Q]).

Since an + 1  =  Qn  -  Qn + 1, the conclusion of the theorem now follows if we can establish regularity of an to the degree that

[formula]

Note that we have now converted the task from one of finding the correct leading term into one of finding an upper bound to within a constant factor, which is a problem well suited to probabilistic analysis. To complete the regularity argument we need a couple of estimates on how rapidly [formula] can change with n. We will prove these at the end.

Under the assumptions of aperiodicity, zero mean and finite variance, there is a constant C such that

[formula]

Upper bounds for qn(0,x) are given by

[formula]

We now prove ([\ref=eq:regular]) for n  =  3m, the cases of 3m + 1 and 3m + 2 being identical. Breaking down according to location at times m and 2m we get

[formula]

Write [formula]. Substituting this in the above equation gives

[formula]

and hence

[formula]

We must bound each of the three terms by O(m- 5 / 2). The second term is a2mam  =  O(m- 3) by ([\ref=eq:small_q]). Using ([\ref=eq:small_p]) we see that the first term is

[formula]

The third term requires a little more care. We will show that

[formula]

To show this, split into three ranges of values for y, namely [formula], [formula] and [formula]. In the first range we use ([\ref=eq:small_p]) and ([\ref=eq:small_q]) with |y| bounded above by k1 / 2 to see that the summand is O(k- 3 / 2)O(k1 / 2m- 3 / 2). There are k1 / 2 summands, so the total sum is O(k- 1 / 2m- 3 / 2).

In the middle range, we use ([\ref=eq:large_p]) and ([\ref=eq:small_q]) to see that the summand is bounded by a constant multiple of k- 1 / 2|y|- 2|y|m- 3 / 2. Summing over y introduces the factor of (1 / 2) log (m / k). For the third sum, use ([\ref=eq:large_p]) and ([\ref=eq:large_q]) to see that the summand is O(k- 1 / 2|y|- 2m- 1), so that summing over [formula] gives O(k- 1 / 2m- 3 / 2). This proves ([\ref=eq:summand]).

Finally, summing ([\ref=eq:summand]) over k  <  m gives O(m- 5 / 2) which establishes ([\ref=eq:regular]), finishing the proof of Theorem [\ref=th:finite_variance]. [formula]

Proof of Lemma [\ref=lem:bounds]: The simplest of the inequalities is ([\ref=eq:large_q]), so we handle it first. Let n  =  3m. The bound ([\ref=eq:large_q]) follows immediately from

[formula]

To prove ([\ref=eq:small_q]), we decompose according to the position at time m and at time 2m, so that

[formula]

where [formula] and we have used qm(z,x)  =  qm(x,z) to infer [formula]. Thus it suffices to show that

[formula]

Observe that there is a constant c depending on the distribution of X1 but not on y such that the probability, call it ρ(y), of hitting y in at most y2 steps starting from the origin is at least c (use the local central limit theorem to bound the expected number of visits to y within the first t2 steps by from below by c1(1 + |y|) and use the Green's function to bound the expected number of visits to y given at least one visit from above by c2(1 + |y|)). By a last exit decomposition, we then have

[formula]

where τ(y) is the probability starting at the origin of hitting y before returning to the origin. Using pj(0,0)  =  Θ(j- 1 / 2) and solving for τ(y) gives

[formula]

But by ([\ref=eq:Q]), decomposing according to the time y is first hit,

[formula]

and solving for Qn(y) proves ([\ref=eq:Q_m]).

The bounds on δn(x): = |pn(0,x)  -  pn + 1(0,x)| are classical (though not all that well known) and are obtained by the same means as the local central limit theorem. Let

[formula]

be the characteristic function of X1, so that as we have seen, mean zero, finite variance and aperiodicity imply that

[formula]

near 1, while

[formula]

for all |θ|  ≤  π. The inversion formula gives

[formula]

We obtain from ([\ref=eq:p1])

[formula]

Given ([\ref=eq:phi_1]) and ([\ref=eq:phi_2]), we see this is a saddle point integral with main contribution near θ  =  0. In particular, since φ(θ)  ≤  1  -  cθ2, we know that |φ(θ)|n  ≤  c exp (bn3 / 4) for n- 1 / 8  ≤  |θ|  ≤  π and we may restrict the integrals to a suitable range such as |θ|  <  n- 1 / 8. Let [formula]. From ([\ref=eq:phi_1]),

[formula]

whence δn(x)  =  O(n- 3 / 2).

For ([\ref=eq:large_p]) we integrate ([\ref=eq:p1]) twice by parts to get

[formula]

The same truncation and change of variables, together with the estimate

[formula]

give δn(x)  =  O((1 + x2)n- 1 / 2) and completes the proof of the lemma. [formula]

Acknowledgement: The problems we address were suggested by a question posed by Dr. Amy Myers.