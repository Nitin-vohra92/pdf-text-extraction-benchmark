Lemma Corollary Definition Remark

Incidence bounds for complex algebraic curves on Cartesian products

The first author was supported by ERC Advanced Research Grant no. 267165 (DISCONV), by Hungarian National Research Grant NK 104183, and by NSERC. The second author was partially supported by Swiss National Science Foundation Grants 200020-144531 and 200021-137574. Part of this research was performed while the authors visited the Institute for Pure and Applied Mathematics (IPAM) in Los Angeles, which is supported by the National Science Foundation.

Introduction

Not many incidence bounds have been proved over the complex numbers. The quintessential incidence bound of Szemerédi and Trotter for points and lines in [formula] was generalized to [formula] by Tóth [\cite=T] and Zahl [\cite=Z]. It states that for a finite set P of points in [formula] and a finite set L of lines in [formula], the set of incidences, denoted by [formula], satisfies

[formula]

The Szemerédi-Trotter bound was generalized to algebraic (and even continuous) curves in [formula] by Pach and Sharir [\cite=PS], but their result has not yet been fully extended to [formula]. Solymosi and Tao [\cite=ST] and Zahl [\cite=Z] did prove complex versions, but only for algebraic curves satisfying certain restrictions. These restrictions include the requirement that the curves are smooth and that the intersections of the curves are transversal (i.e., the curves have distinct tangent lines at their intersection points); both restrictions do not hold in many potential applications. Concurrently with this paper, Sheffer and Zahl [\cite=SZ] proved a complex version of the Pach-Sharir bound without such restrictions, but with a slightly weaker bound.

Incidence bounds are often easier to prove when the point set has the structure of a Cartesian product. This obervation was used by Solymosi and Vu [\cite=SV] to obtain incidence bounds in [formula]. It was noted by Solymosi [\cite=S] that the Szemerédi-Trotter bound in [formula] can be proved more easily (compared to [\cite=T]) when the point set is a Cartesian product; this statement was then used to obtain a sum-product bound over [formula]. Solymosi and Tardos [\cite=ST] used the same observation to obtain bounds on rich Möbius transformation from [formula] to [formula].

We prove a Pach-Sharir-like incidence bound for algebraic curves in [formula], under the assumption that the point set is a Cartesian product A  ×  B with [formula]. We do not require the curves to satisfy the restrictions that were needed in [\cite=ST] [\cite=Z], and the bound is slightly stronger than in [\cite=SZ]. Like in [\cite=PS] [\cite=ST] [\cite=Z] [\cite=SZ], the curves must satisfy a degrees-of-freedom condition, which can come in different forms. Theorem [\ref=thm:mainintro] states our main result with what is probably the most convenient condition; several other versions can be found in Section [\ref=sec:corcurves].

Let A and B be finite subsets of [formula] with |A| = |B|, and set P: = A  ×  B. Let C be a finite set of algebraic curves in [formula] of degree at most d, such that any two points of P are contained in at most M curves of C. Then

[formula]

We have worked out in detail the dependence of the bound on the parameters, which is of interest in certain applications, in particular [\cite=RSZ] [\cite=VZ]. Our proof works via an incidence bound for well-behaved surfaces in [formula], which is interesting in its own right; it was used by Raz and Sharir [\cite=RS] to improve the best known bound on the number of unit area triangles determined by a point set in [formula].

Although the assumption that the point set is a Cartesian product is very restrictive, it is satisfied in a number of interesting problems. We give several examples of such applications in Section [\ref=sec:applications]. These include an answer to a question of Elekes [\cite=E02] related to sum-product estimates, and a generalization to [formula] of a recent result of Sharir, Sheffer, and Solymosi [\cite=SSS] on distinct distances between lines. More sophisticated applications can be found in the already mentioned works [\cite=RS] [\cite=RSZ] [\cite=VZ], which were in fact the original motivation for this paper.

We begin in Section [\ref=sec:real] with the elementary proof of the real analogue of our main theorem, which is not a new result, but serves as an introduction to our main proof. In Section [\ref=sec:tools] we collect the technical tools that we use, and in Section [\ref=sec:main] we prove our main bound, which concerns point-surface incidences in [formula]. In Section [\ref=sec:corsurfaces] we deduce some corollaries for surfaces in [formula], and in Section [\ref=sec:corcurves] we prove corollaries for curves in [formula], including Theorem [\ref=thm:mainintro] above. Finally, in Section [\ref=sec:applications], we give three applications.

Warmup: Points and curves in .

As a warmup for the complex case, we first give a proof of the corresponding statement for incidences between real algebraic curves and a Cartesian product in [formula]. This is not a new result, as it follows from the work of Pach and Sharir [\cite=PS]. The proof given here is, however, much simpler, because the product structure allows for a trivial partitioning of the plane; the proof is self-contained up to a few basic facts about algebraic curves. Moreover, it provides a blueprint for our main proof in Section [\ref=sec:main].

Throughout, given a set P of points and a set C of geometric objects, we define the set of incidences by I(P,C): = {(p,c)∈P  ×  C:p∈c}.

Let A and B be finite subsets of [formula] and P: = A  ×  B. Let C be a finite set of algebraic curves in [formula] of degree at most d such that any two points of P are contained in at most M curves of C. We assume that no curve in C contains a horizontal or vertical line, that d4|C|  ≤  M|P|2, and that |A|  ≤  |B| and d|C|  ≥  M|B|2 / |A|. Then

[formula]

Let r be a real number, to be chosen at the end of the proof, satisfying d  ≤  r  ≤  |A|. We "cut" [formula] in O(r) points that are not in A, splitting [formula] into O(r) intervals so that each interval contains O(|A| / r) elements of A (this is possible because r  ≤  |A|). Similarly, we choose O(r) cutting points not in B that split [formula] into at most O(r) intervals, each containing O(|B| / r) elements of B (using r  ≤  |A|  ≤  |B|). This gives a partition of [formula] into O(r2) open cells (which are rectangles) and a closed boundary (consisting of O(r) lines). Each cell contains O(|A||B| / r2) = O(|P| / r2) points of P, while the boundary is disjoint from P.

We need to bound the number of cells that a curve C∈C can intersect. The curve has O(d2) connected components by Harnack's Theorem (see Lemma [\ref=lem:baronebasu] below), and it has at most d intersection points with each of the O(r) boundary lines by Bézout's Inequality (see Lemma [\ref=lem:bezout] below), using the fact that the curve contains no horizontal or vertical line. Thus the O(d2) connected components are cut in O(dr) points. By wiggling the cutting lines slightly, we can ensure that they do not hit a curve of C in a singularity, since algebraic curves have finitely many singularities (see Section [\ref=sec:tools]). Therefore, each cut increases the number of connected components by at most one. Thus any C∈C intersects O(d2 + dr) = O(dr) (using d  ≤  r) of the O(r2) cells.

Let I1 be the subset of incidences (p,C)∈I(P,C) such that (p,C) is the only incidence of C in the cell containing p, and let I2 be the subset of incidences (p,C)∈I(P,C) such that C has at least one other incidence in the cell that contains p. Then, since a curve intersects O(dr) cells, we have

[formula]

On the other hand, given two points in one cell, there are by assumption at most M curves in C that contain both points. Thus, in a cell with k points there are at most [formula] incidences from I2. Therefore, summing over all cells, we have

[formula]

Choosing [formula] gives

[formula]

We have to verify that our choice of r satisfies d  ≤  r and r  ≤  |A|. The first follows from the assumption d4|C|  ≤  M|P|2 and

[formula]

The second follows from the assumption d|C|  ≥  M|B|2 / |A| and

[formula]

This completes the proof.

Theorem [\ref=thm:warmup] has several conditions which can be simplified in various ways to make the statement more suitable for application. We state one version here as an example, but we refer to Section [\ref=sec:corcurves] for the proof (which is identical to that of the complex version presented there).

Let A and B be finite subsets of [formula] with |A| = |B|, and P: = A  ×  B. Let C be a finite set of algebraic curves in [formula] of degree at most d, such that any two points of P are contained in at most M curves of C. Then

[formula]

Definitions and tools

Definitions

We introduce a few definitions and basic facts from algebraic geometry in some detail, because the subtle differences between real and complex varieties play a role in our proof.

A variety in [formula] is a set of the form

[formula]

for polynomials [formula]. Such sets are normally called affine varieties (or just zero sets), but since this is the only type of variety that we consider, we refer to them simply as varieties. Similarly, we define a real variety to be a zero set of the form

[formula]

with polynomials [formula]. We refer to [\cite=Ha] [\cite=He] for definitions of the dimension [formula] and the degree deg (V) of a complex variety V, and we refer to [\cite=BPR] or [\cite=BCR] for a careful definition of the real dimension of a real variety W, denoted by [formula]. One can locally view a real variety as a real manifold (around any nonsingular point, see below), and the real dimension equals the dimension in the manifold sense (more precisely, it is the maximum dimension at any nonsingular point).

A complex algebraic curve in [formula] is a variety V with [formula]. In our definition, a curve [formula] of degree d has the form [formula] for a polynomial [formula] of degree d - k and a finite set P of size k. A variety [formula] is a real algebraic curve in [formula] if [formula], and it is a real algebraic surface if [formula]. A real algebraic curve [formula] can be written as [formula] for a polynomial [formula]; we define the degree of C to be minimum degree of such an f. For convenience, we will occasionally use the notion of a semialgebraic curve in [formula], which is a subset of a real curve defined by polynomial inequalities; in particular, if we remove a finite point set from a real curve, the connected components of the remainder are semialgebraic curves.

A curve [formula] is irreducible if there is an irreducible f such that [formula]. An irreducible component of an algebraic curve [formula] is an irreducible algebraic curve C' such that C'  ⊂  C. A curve in [formula] of degree d has a decomposition as a union of at most d irreducible components (some of which may be points).

We also need to consider singularities of curves, but only for real curves in [formula] or [formula]. For a curve in [formula], we define a point on the curve to be a singularity if it does not have a neighborhood in which the curve is a real manifold of dimension one (for details see [\cite=Ha] or [\cite=BCR]). A key fact that we need is that the number of singularities of a curve in [formula] of degree d is less than d2. More precisely, define the branches of a singularity in a small neighborhood to be the connected components of the curve in that neighborhood after removing the singularity. Then the total number of branches over all singularities, for any choice of sufficiently small neighborhoods, is at most d2 (see [\cite=F]). For a curve in [formula], we only need the fact that the number of singularities is finite (see [\cite=BCR]).

Intersection bounds

In the proof of our main theorem we will frequently have to bound the size of the intersection of two varieties, both over [formula] and over [formula]. The prototype for such intersection bounds is the following lemma. Here we consider the degree of a finite point set to be its size, so the lemma says that the intersection of two curves is either a finite set of bounded size, or a curve of bounded degree.

If C1 and C2 are algebraic curves in [formula] or [formula], then

[formula]

With the right definition of degree, this inequality can be extended to varieties in [formula], but in [formula], the inequality may fail in this form. Nevertheless, various cautious bounds on the number of connected components of intersections of real varieties have been proved, which can often serve the same purpose; see for instance [\cite=BPR]. We will use the following recent result of Barone and Basu [\cite=BB]. It gives a refined bound when the defining polynomials of the variety have different degrees, which is crucial in our proofs. We state it in a similar way to Basu and Sombra [\cite=BS], with some modifications based on the more general form in [\cite=BB]. We simplify the statement of the bound somewhat using the following (non-standard) definition.

Let [formula] have dimension km, with [formula]. Write [formula] and k0: = D. We define the Barone-Basu degree of V by

[formula]

Note that, for example, a two-dimensional variety [formula] in [formula] that is defined by any number of polynomials of degree at most d has Barone-Basu degree d2. Indeed, we have k0 = 4 and km = 2, and either there are two gi such that ki - 1 - ki  =  1, or there is one gi such that ki - 1 - ki  =  2; in both cases the Barone-Basu degree comes out to d2.

Let [formula] with [formula]. Let [formula] with deg (h)  ≥   deg (gm). Then the number of connected components of both [formula] and [formula] is

[formula]

In the ideal case where each ki  =  D - i, this would be a natural generalization of Lemma [\ref=lem:bezout]. On the other hand, if deg (gi)  ≤  d for each i, we get the bound O(dD - km deg (h)km), without any individual conditions on the gi. The fact that h is arbitrary allows for the following trick to deal with more polynomials in the role of h: To bound the number of connected components of, say, [formula], one can simply set h: = h21 + h22 and use the lemma.

Finally, we record a simple fact about the surface in [formula] associated to a curve in [formula].

Let [formula] be an algebraic curve of degree d. Then the associated real surface S in [formula] is defined by two polynomials of degree at most 2d, and [formula].

There is a finite set P and a polynomial f(x,y) of degree d - |P| such that we can write [formula]. The real polynomials

[formula]

define the surface in [formula] associated to [formula]; both have degree at most d - |P|. The set P, viewed as a subset of [formula], is defined by a polynomial h3 of degree 2|P|. If we set g1  =  h1h3 and g2  =  h2h3, then we have [formula], and g1,g2 have degree at most d - |P| + 2|P|  ≤  2d.

Write k0: = 4, [formula], and [formula] as in Definition [\ref=def:BBdegree]. We clearly have k2 = 2. Then k1∈{2,3,4}, and, whichever it is, we get

[formula]

This completes the proof.

Polynomial partitioning

Our proof relies on the following technique introduced by Guth and Katz [\cite=GK].

Let A be a finite subset of [formula]. For any [formula] with 1  ≤  r  ≤  |A|1 / 2 there exists a polynomial [formula] of degree O(r) such that [formula] has O(r2) connected components, each containing O(|A| / r2) points of A.

In the proof of Theorem [\ref=thm:warmup], we in fact used a trivial partitioning on [formula]: For [formula] and any 1  ≤  r  ≤  |A|, there is a subset [formula] of size O(r) such that [formula] has O(r) connected components, each containing O(|A| / r) points of A. Moreover, we used the fact that the points of X have some "wiggle room", in the sense that they can be varied in some small neighborhood without affecting the partitioning property. We now show that a point set on a real algebraic curve can be partitioned in a similar way.

Such a partitioning would not be possible for arbitrary continuous curves with self-intersections, or for algebraic curves of arbitrary degree. If we take an arbitrary point set in general position and connect any two points by a line, the union of the lines is an algebraic curve of high degree that cannot be partitioned with a small number of cutting points on the curve. However, on an algebraic curve of bounded degree δ, one can control the number of self-intersections (singularities) of the curve in terms of δ, and this allows us to partition it into O(δ2) pieces.

Let [formula] be an algebraic curve of degree δ, containing a finite set A. Then there is a subset [formula] of O(δ2) points, such that [formula] consists of O(δ2) connected semialgebraic curves, each containing O(|A| / δ2) points of A. Moreover, each point p∈X has an open neighborhood on C such that any point of that neighborhood could replace p without affecting the partitioning property.

Around every singularity p of C, choose a sufficiently small closed ball Bp with boundary circle Rp, so that Bp contains no other singularities of C, and no point of A other than possibly p itself. We put the points of [formula] into X for each p. For each singularity p, [formula] is at most the number of branches of C at p in the neighborhood Bp (as defined at the end of Subsection [\ref=subsec:defs]), and the total sum of these numbers is at most δ2. Hence we have put at most δ2 points into X. The points of X are themselves not singularities, so removing a point of X increases the number of connected components by at most one, since around such a point C is a one-dimensional manifold.

By Lemma [\ref=lem:baronebasu], C has at most O(δ2) connected components, so removing the points of X cuts C into O(δ2) connected semialgebraic curves. Each of these semialgebraic curves either contains at most one point of A (a singularity), or it is simple (i.e., it has no self-intersections). We can cut these simple curves at a total of O(δ2) points, so that every resulting curve contains O(|A| / δ2) points of A, and no cutting point is in A. Adding these cutting points to X completes the proof. It should be clear that shifting the cutting points within a sufficiently small open neighborhood will not affect the proof.

Main bound for surfaces in

In this section we prove our main incidence bound for points and surfaces in [formula], from which we will deduce our incidence bounds for complex algebraic curves in Section [\ref=sec:corcurves]. It only applies to surfaces that are well-behaved in the following way.

A surface S in [formula] has good fibers if for every [formula], the fibers [formula] and [formula] are finite.

Note that if a curve in [formula] contains no horizontal or vertical line, then its associated surface in [formula] has good fibers. Since it is easy to remove a line from a curve, this property is easily ensured. On the other hand, for a surface S in [formula], the fiber [formula] may be a one-dimensional curve, which is not so easily removed. Nevertheless, see [\cite=RS] for an example of a situation where the surfaces have this property. We also note that for surfaces with a limited set of bad fibers, the proof below might still be made to work.

Our proof uses the Guth-Katz polynomial partitioning technique from Lemma [\ref=lem:polpart] in a special way that is adjusted to the Cartesian product structure. Specifically, [formula] is viewed as a product [formula], and we partition each copy of [formula] separately. We first partition [formula] using a curve provided by Lemma [\ref=lem:polpart], and then we partition that curve using Lemma [\ref=lem:partoncurve]. The partitions of the two copies of [formula] are then combined into a cell decomposition of [formula].

To make the bookkeeping of these partitions a bit easier to follow, we use the following terminology for our cell decomposition of [formula]: a k-cell is a connected set of dimension k that will be used in the final cell decomposition; a k-wall is a k-dimensional variety that cuts out the (k + 1)-cells, but that is itself to be decomposed into lower-dimensional cells; a k-gap is a k-dimensional variety that also helps to cut out the (k + 1)-cells, but does not contain any incidences, so does not need to be partitioned further. To summarize: [formula] is partitioned into 4-cells by 3-walls and 3-gaps; each 3-wall is then partitioned into 3-cells by 2-walls and 2-gaps; the 2-walls are then partitioned into 2-cells using only 1-gaps.

In the statement that we prove here, we make the degrees-of-freedom condition a bit more flexible. We view the set I(P,S) as an incidence graph, i.e., the bipartite graph with vertex sets P and S, where p∈P is connected to S∈S if p∈S. The condition that any two points are in at most M surfaces can then be rephrased as I(P,S) containing no complete bipartite subgraph K2,M. Here we weaken that condition by considering a subgraph of I(P,S); we show that if that subgraph contains no K2,M, then its number of edges (denoted by |I|) is bounded. This formulation is often convenient in applications; see [\cite=ST] [\cite=Z] for incidence bounds that are also stated in this way.

Let A1 and A2 be finite subsets of [formula] and P: = A1  ×  A2. Let S be a finite set of algebraic surfaces in [formula] that have good fibers and are defined by polynomials of degree at most d. Let I  ⊂  I(P,S) be an incidence subgraph containing no K2,M. Assume that d8|S|  ≤  M|P|2, and that |A1|  ≤  |A2| and d2|S|  ≥  M|A2|2 / |A1|. Then

[formula]

Every surface S∈S has [formula] by the remark just after Definition [\ref=def:BBdegree]. As in the proof of Theorem [\ref=thm:warmup], we partition the space, see how the varieties intersect the cells, and then use a simple counting argument. We note that the counting is exactly as in Theorem [\ref=thm:warmup], except that the parameters d and r from that proof are replaced by d2 and r2 in this proof.

Partitioning.

We partition [formula] into O(r4) cells and some gaps, so that each cell contains O(|P| / r4) points of P, and the gaps contain no points of P. We assume that d2  ≤  r2  ≤  |A1|.

We use Lemma [\ref=lem:polpart] to get polynomials f1,f2 of degree r  ≤  |A1|1 / 2 so that [formula] partitions [formula] into r2 cells, each containing O(|Ai| / r2) points of Ai. Then we use Lemma [\ref=lem:partoncurve] to partition C1 and C2, obtaining sets [formula] with |Xi|  =  O(r2), so that [formula] consists of O(r2) connected components, each containing O(|Ai| / r2) points of Ai.

The 3-walls [formula] and [formula] partition [formula] into O(r4) 4-cells, each containing O(|P| / r4) points of P. The 3-wall [formula] is partitioned by the 2-wall C1  ×  C2, combined with the 2-gap [formula]; similarly, [formula] is partitioned by the 2-wall C1  ×  C2 and the 2-gap [formula]. Thus the 3-walls are partitioned into O(r4) 3-cells, each containing O(|P| / r4) points of P. The gaps are not partitioned further. The 2-wall C1  ×  C2 is partitioned by the 1-gaps X1  ×  C2 and C1  ×  X2, again resulting in O(r4) cells, each containing O(|P| / r4) points of P. This completes the partitioning. Altogether there are O(r4) cells, each containing O(|P| / r4) points of P.

Intersections.

We now show that any surface S∈S intersects O(d2r2) of the O(r4) cells, and we do this separately for the 4-cells, 3-cells, and 2-cells.

4-cells: The 4-cells are cut out by the 3-wall [formula]. To get an upper bound on the number of 4-cells intersected by S, we want an upper bound on the number of connected components of [formula]. We apply Lemma [\ref=lem:baronebasu] to deduce that [formula] has

[formula]

connected components; here [formula] by assumption, and the condition of Lemma [\ref=lem:baronebasu] (that the degree of f1f2 is at least the degree of the polynomials defining S) follows from the assumption d2  ≤  r2. This means that S intersects O(d2r2) of the 4-cells.

3-cells: Set [formula]. Note that [formula], because for any [formula] the fiber [formula] is finite, since S has good fibers. If [formula], then by Lemma [\ref=lem:baronebasu] [formula] consists of O(d2  ·  r2) points, so it intersects at most that many cells. Hence we can assume [formula]. To see how many 3-cells inside [formula] are intersected by S1, we separately consider its intersection with the 2-wall C1  ×  C2, and with the 2-gap [formula].

The fact that [formula] implies that [formula]. Therefore, by Lemma [\ref=lem:baronebasu], [formula] has

[formula]

connected components. Hence the wall C1  ×  C2 cuts S1 into O(d2r2) connected semialgebraic curves.

Now consider the gap [formula]. For p∈X1, we have [formula], and [formula] is finite, again because S has good fibers. Since we can write [formula], it follows from Lemma [\ref=lem:baronebasu] that [formula]. Thus the curve S1 has

[formula]

points of intersection with this gap. Moreover, using the "wiggle room" for the points in X1 mentioned in Lemma [\ref=lem:partoncurve], and the fact that S1 has finitely many singularities, we can assume that none of the points in [formula] is a singularity of S1. Hence, removing such a point increases the number of connected components by at most one (which would not quite be true at a singularity). Since the wall C1  ×  C1 cuts S1 into O(d2r2) connected components, and we remove O(d2r2) further points, it finally follows that S1 intersects O(d2r2) of the 3-cells inside [formula]. Note that X1 should be chosen so that [formula] avoids the singularities of S1 for all S∈S simultaneously, but this is possible since there are finitely many points to avoid, while there is infinite wiggle room.

A symmetric argument gives the same bounds for [formula], so altogether we get that S intersects O(d2r2) of the 3-cells inside [formula].

2-cells: Set [formula]. The 2-wall C1  ×  C2 is partitioned by the 1-gaps X1  ×  C2 and C1  ×  X2. As above we have [formula] for p∈X1, so we get [formula] and similarly [formula]. Finally, we can write [formula], so S3 has O(d2  ·  (2r)2) connected components. Again each cut increases the number of connected components by at most one, so altogether S3 intersects O(d2r2) of the 2-cells.

Counting.

Let I1 be the subset of incidences (p,S)∈I such that (p,S) is the only incidence of S from I in the cell containing p, and let I2 be the subset of incidences (p,S)∈I such that S has at least one other incidence from I in the cell that contains p. The fact that a surface from S intersects O(d2r2) cells implies

[formula]

On the other hand, given two points p1,p2 in one cell, there are by assumption fewer than M surfaces S∈S such that (p1,S),(p2,S)∈I. Thus we have

[formula]

Choosing [formula] gives [formula]. We need to ensure that d2  ≤  r2  ≤  |A1|; this follows from the two assumptions of the theorem, by the same calculation as in the proof of Theorem [\ref=thm:warmup] (with d and r replaced by d2 and r2).

Corollaries for surfaces in

We now deduce some more practical corollaries of Theorem [\ref=thm:main] for surfaces in [formula], without the awkward conditions on the sizes of the sets of points and surfaces. To remove these conditions we use the K ovári-Sós-Turán theorem, a commonly used tool in incidence geometry. It gives a bound on the number of edges in a graph not containing a complete bipartite graph Ks,t; see Bollobás [\cite=B] for the version stated here.

Let G  ⊂  X  ×  Y be a bipartite graph. Suppose that G contains no Ks,t, i.e., for any s vertices in X, there are fewer than t vertices in Y connected to both. Then the number of edges of G is bounded by

[formula]

We now use this lemma to obtain a more convenient version of Theorem [\ref=thm:main]. See [\cite=RS] for an application of this corollary.

Let A and B be finite subsets of [formula] with |A| = |B|, and [formula]. Let S be a finite set of surfaces in [formula] that have good fibers and are defined by polynomials of degree at most d. Let I  ⊂  I(P,S) be an incidence subgraph containing no K2,M or KM,2. Then

[formula]

If d- 2M|P|1 / 2  ≤  |S|  ≤  d- 8M|P|2, we can apply Theorem [\ref=thm:main] directly, which results in the first term of the bound. If |S| > d- 8M|P|2, then we can apply Lemma [\ref=lem:KST] with X: = P and Y: = S to get

[formula]

On the other hand, if |S|  <  d- 2M|P|1 / 2, then Lemma [\ref=lem:KST] with X: = S and Y: = P gives

[formula]

Combining these bounds proves the corollary.

Next we prove a version of Theorem [\ref=thm:main] where the condition on the excluded complete bipartite subgraph is weakened in a different way: Instead of requiring every two points to lie in a bounded number of surfaces, we only require this for any s points. Such a bound was given for curves in [\cite=PS]; see [\cite=Z] for a similar statement for surfaces in [formula]. To prove it we only have to modify the counting step in the proof of Theorem [\ref=thm:main].

Let A1 and A2 be finite subsets of [formula] and P: = A1  ×  A2. Let S be a finite set of algebraic surfaces in [formula] that have good fibers and are defined by polynomials of degree at most d. Let I  ⊂  I(P,S) be an incidence subgraph containing no Ks,t. Assume that |S|  ≤  d- (4s - 2)|P|s, and that |A1|  ≤  |A2| and |S|  ≥  |A1|1 - s|A2|s. Then

[formula]

As said, we reuse the partitioning and intersection steps from the proof of Theorem [\ref=thm:main], and we jump in at the counting step.

Let I1 be the subset of incidences (p,S)∈I such that S has at most s - 1 incidences from I in the cell that p lies in. Let I2 be the subset of incidences (p,S)∈I such that C has at least s incidences from I in the cell that p lies in. The fact that a surface from S intersects O(d2r2) cells implies

[formula]

On the other hand, given s points in one cell, there are by assumption fewer than t surfaces S∈S containing all s points. Thus we have

[formula]

Setting [formula] gives

[formula]

We need to ensure that d2  ≤  r2  ≤  |A1|. The assumption that |S|  ≤  d- (4s - 2)|P|s gives r4s - 2  ≥  d4s - 2, and the assumption that |S|  ≥  |A1|1 - s|A2|s gives r4s - 2  ≤  |A1|2s - 1.

Again, we can prove a version with more practical conditions.

Let A and B be finite subsets of [formula] with |A| = |B|, and [formula]. Let S be a finite set of surfaces in [formula] that have good fibers and are defined by polynomials of degree at most d. Let I  ⊂  I(P,S) be an incidence subgraph containing no Ks,t or Kt,2. Then

[formula]

If |P|1 / 2  ≤  |S|  ≤  d- (4s - 2)|P|s, we can apply Theorem [\ref=thm:main] directly, which results in the first term of the bound. If |S| > d- (4s - 2)|P|s, then Lemma [\ref=lem:KST] gives |I|  =  Od,s,t(|S|), while if |S|  <  |P|1 / 2, then Lemma [\ref=lem:KST] gives |I|  =  OM(|P|). Combining these bounds proves the corollary.

Corollaries for curves in

In this section we deduce several incidence bounds for complex algebraic curves from Theorem [\ref=thm:main], including Theorem [\ref=thm:mainintro]. There are many different ways to vary these statements, and we certainly do not cover all combinations, but we focus on those that have turned out useful in applications (see Section [\ref=sec:applications] and [\cite=RSZ] [\cite=VZ]).

We make some effort to determine the dependence of the bounds on the parameters d and M, because this is of interest in the applications [\cite=VZ] [\cite=RSZ]. In the incidence bounds for curves in [formula] that were proved in [\cite=ST] [\cite=Z] [\cite=SZ], determining this dependence seems challenging.

The following corollary is our first practical incidence bound for curves in [formula]. Note that the second term in the bound is a bit awkward, but this seems unavoidable when |A|  ≠  |B|.

Let A and B be finite subsets of [formula] with |A|  ≤  |B|, and let P: = A  ×  B. Let C be a finite set of algebraic curves in [formula] of degree d such that no two have a common component. Let I  ⊂  I(P,C) be an incidence subgraph containing no K2,M. Then

[formula]

Let I1 be the subset of incidences (p,C)∈I such that p lies on a horizontal or vertical line contained in C. Since the curves have no common components, each horizontal or vertical line occurs at most once, and any point is contained in at most two such lines, so

[formula]

Let I2 be the subset of incidences (p,C)∈I such that p does not lies on a horizontal or vertical line contained in C. Let C* be the set of curves obtained by removing all the horizontal and vertical lines from the curves in C; we have |C*|  ≤  |C|. We can view I2 as a subgraph of the incidence graph I(P,C*). The fact that the curves in C* contain no horizontal or vertical lines implies that the associated surfaces in [formula] have good fibers, and by Lemma [\ref=lem:complextoreal] the surfaces are defined by polynomials of degree at most 2d. Hence we can apply Theorem [\ref=thm:main] to obtain

[formula]

unless we have d8|C*|  >  M|P|2 or d2|C*| < M|B|2 / |A|.

Suppose that d8|C*|  >  M|P|2. Since I contains no K2,M, we can use Lemma [\ref=lem:KST] to get

[formula]

Suppose that d2|C*| < M|B|2 / |A|. Because the curves do not have common components, any two curves intersect in at most d2 points by Bézout's Inequality (Lemma [\ref=lem:bezout]). Thus I2 contains no Kd2 + 1,2, so by Lemma [\ref=lem:KST] we have

[formula]

Combining these bounds finishes the proof.

With a little more work, we can remove the condition that no two curves have a common component, with almost no effect on the bound; this is Theorem [\ref=thm:mainintro]. Note that we lose the flexibility of allowing a subgraph of the incidence graph. Indeed, the curves could all share a common component, and on that component the incidence subgraph could be any bipartite graph K2,M, which need not satisfy the desired bound.

Let A and B be finite subsets of [formula] with |A| = |B|, and P: = A  ×  B. Let C be a finite set of algebraic curves in [formula] of degree at most d, such that any two points of P are contained in at most M curves of C. Then

[formula]

We have to deal with horizontal or vertical lines in the curves, and with the case d2|C| < M|P|1 / 2; the other cases can be treated as in Corollary [\ref=cor:practical].

Let C1 be the multiset of horizontal and vertical lines contained in curves of C, and let C2 be the curves that remain after these lines have been removed. In total there are at most d|C| lines in C1 (counted with multiplicity). The lines that contain at most one point of P together give at most d|C| incidences. The lines that contain at least two points of P have multiplicity at most M by assumption, so a point on such a line is contained in at most 2M such lines (counted with multiplicity), resulting in at most 2M|P| incidences. Hence

[formula]

Now suppose d2|C| < M|P|1 / 2. We split each curve in C2 into its at most d irreducible components. The components that contain at most one point of P give altogether at most d|C| incidences. Let C* be the multiset of components that contain at least two points of P. A curve in C* has multiplicity at most M by assumption.

Let Cij be the set of curves in C* that have multiplicity between 2i and 2i + 1 and degree between 2j and 2j + 1. The sum of all the degrees of all the components of the curves in C is at most d|C|, so the number of curves of degree at least 2j that occur with multiplicity at least 2i is bounded by d|C| / 2i + j. Thus

[formula]

and two distinct curves in Cij intersect in at most 2j + 1  ·  2j + 1  =  4  ·  22j points by Lemma [\ref=lem:bezout]. Hence the incidence graph I(P,Cij) contains no [formula], so Lemma [\ref=lem:KST] gives

[formula]

Therefore,

[formula]

Together with |I(P,C2)|  =  |I(P,C*)| + O(d|C|) this completes the proof.

Finally, we state a curve version of Corollary [\ref=cor:surfaces2].

Let A and B be finite subsets of [formula] with |A| = |B|, and P: = A  ×  B. Let C be a finite set of algebraic curves in [formula] of degree at most d, such that any s points of P are contained in at most t curves of C. Then

[formula]

If |P|1 / 2  ≤  |C|  ≤  d- (4s - 2)|P|s, we can apply Theorem [\ref=thm:main] to the surfaces associated to the curves, which results in the first term of the bound. If |C| > d- (4s - 2)|P|s, then Lemma [\ref=lem:KST] gives

[formula]

If |C|  <  |P|1 / 2, then arguing as in the proof of Corollary [\ref=cor:practical2] gives |I(P,C)|  =  Od,t(|P|).

Applications

We now show several examples of applications in which the assumption that the point set is a Cartesian product is satisfied. We do not work out these applications in the greatest generality here, but merely give some samples that should illustrate the usefulness of our bounds.

Rich transformations.

Elekes [\cite=E02] [\cite=E11] introduced various questions of the following form: Given a group G of transformations on some set X and an integer k, what is the maximum size of

[formula]

for a finite subset S  ⊂  X? The work of Guth and Katz [\cite=GK] involved this question for [formula] and G the group of Euclidean isometries of [formula]. Solymosi and Tardos [\cite=ST] gave the bound |Rk(A)| = O(|A|4 / k3) when [formula] and G is the group of linear transformations from [formula] to [formula], and the bound |Rk(A)| = O(|A|6 / k5) when [formula] and G is the group of Möbius transformations from [formula] to [formula].

We give one example to illustrate how our incidence bound can be used for this type of problem. We consider the group of Möbius transformations (cz + a) / (dz + b) for which c = 0,d = 1; i.e., the inversion transformations.

Let [formula] be finite and let Rk(A) be the set of inversion transformations φab(z)  =  a / (z + b), with [formula] and a  ≠  0, for which [formula]. Then

[formula]

Let P: = A  ×  A. Define [formula] and set C: = {Cab:φab∈Rk(A)}. Then for every Cab∈C we have [formula].

The curves Cab are clearly distinct. Suppose that two points [formula] lie on the curve Cab. Then we have y(x + b) = a = y'(x' + b), so

[formula]

If y  ≠  y', then b is determined by this equation, and a is determined by a  =  y(x + b). If y'  =  y  ≠  0, then we have x' = x, a contradiction. If y = 0, we would have a  =  0, also a contradiction. Thus at most two curves Cab pass through any two points (x,y),(x',y').

Corollary [\ref=cor:practical2] (or Theorem [\ref=thm:mainintro]) then gives

[formula]

This implies [formula].

Elekes-Nathanson-Ruzsa-type problems.

In [\cite=ENR], Elekes, Nathanson, and Ruzsa considered generalizations of sum-product inequalities over [formula]. Their proofs converted these problems into incidence problems for points and curves over [formula], with the point set being a Cartesian product. So these problems are well-suited to our incidence bounds over [formula].

For instance, one of the main results of [\cite=ENR] stated that if [formula] is a convex function and [formula] a finite set, then

[formula]

where f(A): = {f(a):a∈A}. For a rational function [formula], the same bounds can be deduced by splitting up the graph of f into convex and concave pieces (the number of which is bounded in terms of the degree of f). Over [formula], it is not clear what the analogue of a convex function would be, but for polynomials or rational functions, these bounds could be generalized to [formula]. We do this for the specific function f(x) = 1 / x, thereby solving Problem 2.10 in Elekes's survey [\cite=E02].

Let [formula] be finite and write 1 / A: = {1 / a:a∈A}. Then

[formula]

Set P: = (A + A)  ×  (1 / A + 1 / A),

[formula]

and C: = {Cab:a,b∈A}. The curve Cab equals the graph y  =  1 / (x - a)  +  1 / b. Then each of the |A|2 curves Cab has [formula], since for every a'∈A we have x = a + a'∈A + A and

[formula]

so (x,y)∈Cab.

We now check that the curves in C meet the conditions of Corollary [\ref=cor:practical2]. Suppose that two points [formula] lie on the curve Cab. Then x  ≠  a,x'  ≠  a. We have

[formula]

so (y - y')(x - a)(x' - a)  =  x' - x. This implies y  ≠  y', since otherwise we would also get x' = x. Then we get

[formula]

At most two a satisfy this equation, and a determines b by y  =  1 / (x - a) - 1 / b. Thus at most two curves Cab pass through the points (x,y),(x',y').

By Corollary [\ref=cor:practical2], we get (the second and third term have no effect)

[formula]

This gives |A + A|  ·  |1 / A + 1 / A| = Ω(|A|5 / 2).

For the second statement, we define C*ab: = Z((x - 1 / a)(y - b)  -  1), which is |A|-rich on (A + 1 / A)  ×  (A + 1 / A). The conditions of Corollary [\ref=cor:practical2] can be checked in a similar way, so

[formula]

which gives |A + 1 / A| = Ω(|A|5 / 4).

Elekes-Rónyai-type problems.

Elekes and Rónyai [\cite=ER] introduced another class of questions that lead to incidence problems on Cartesian products in a natural way. The strongest result in this direction was recently obtained by Raz, Sharir, and Solymosi in [\cite=RSS], and it states the following. Let [formula] be a polynomial of constant degree, let [formula] with |A| = |B| = n, and write f(A,B): = {f(a,b):a∈A,b∈B}. Then we have |f(A,B)| = Ω(n4 / 3), unless f is of the form g(h(x) + k(y)) or g(h(x)  ·  k(y)), with [formula]. In other words, f is an "expander" unless it has a special form. A generalization of this statement is proved in [\cite=RSZ], using our Theorem [\ref=thm:mainintro].

Again, the typical approach to these problems is by converting them into incidence problems between points and curves, with the points forming a Cartesian product. The general analysis is considerably more difficult; in particular, the curves can actually have many common components, and one needs to show that they do not have too many common components, unless f has a special form.

To illustrate how our incidence bounds can extend such results to [formula], we establish a simple case, where the polynomial does not have the special form. Moreover, this case is a nice geometric question. It was first considered in [\cite=ER], and the real equivalent of the bound below was obtained by Sharir, Sheffer, and Solymosi [\cite=SSS], whose proof we follow here.

Consider the "Euclidean distance" defined by D(p,q): = (px - qx)2 + (qx - qy)2 for [formula], and write D(A,B): = {D(a,b):a∈A,b∈B}.

Let L1,L2 be two lines in [formula], and A  ⊂  L1,B  ⊂  L2 with |A| = |B| = n. Then

[formula]

unless L1 and L2 are parallel or orthogonal.

If the lines are not parallel or orthogonal, we can assume that L1 is the x-axis, and that L2 contains the origin and is not vertical. Then the lines can be parametrized by p(x) = (x,0) and q(y)  =  (y,my), for some [formula], so that the distance is given by

[formula]

We will show that the polynomial f is an expander in the sense of Elekes and Rónyai.

Set P: = A  ×  A,

[formula]

and C: = {Cbb':b,b'∈B}. The equation of Cbb' is

[formula]

which defines a hyperbola, unless b = b'. The curves of the form Cbb have altogether at most n2 incidences, so we can safely ignore them. A quick calculation shows that any two points are contained in at most two hyperbolas Cbb' with b  ≠  b'. Thus, by Corollary [\ref=cor:practical2], we have

[formula]

Writing f- 1(c): = {(a,b)∈A  ×  B:f(a,b)  =  c} and using Cauchy-Schwarz gives

[formula]

Therefore |f(A,B)|  =  Ω(n4 / I(P,C)) = Ω(n4 / 3).