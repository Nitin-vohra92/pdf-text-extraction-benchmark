Equistarable bipartite graphs

This research is supported in part by "Agencija za raziskovalno dejavnost Republike Slovenije", research program P1-0285 and research projects J1-5433, J1-6720, J1-6743, and BI-US/14-15-050. The first author also thanks for partial support the National Science Foundation (Grant IIS-1161476).

Keywords: equistable graph, general partition graph, bipartite graph, equistarable graph, graph MSC (2010): 05C69, 05C50, 05C22, 05C76

Introduction

In [\cite=MT] Milani c and Trotignon established a connection between equistarability and equistability and between 2-extendable graphs and general partition graphs. (See Section [\ref=sec:Preliminaries] for definitions.) In particular, they proved that: (1) if a graph G is triangle-free, then G is equistarable if and only if [formula], the complement of its line graph, is equistable and (2) a connected triangle-free graph G of minimum degree at least 2 is 2-extendable if and only if [formula] is a general partition graph. Based on this approach, they disproved Orlin's conjecture [\cite=MM15], which stated that every equistable graph is a general partition graph. The counterexamples in [\cite=MT] are based on complements of line graphs of triangle-free graphs, and that work left open the validity of Orlin's conjecture for the class of complements of line graphs of bipartite graphs, and more generally for the class of perfect graphs. Regarding other subclasses of perfect graphs, Orlin's conjecture can be easily verified to hold for bipartite graphs and their complements, and was shown to hold for chordal graphs [\cite=Pel_Rot] and for line graphs of bipartite graphs [\cite=Lev_Mil].

We show in this paper that Orlin's conjecture holds for the complements of line graphs of bipartite graphs. We achieve this by further extending the connections between a triangle-free graph G and the complement of its line graph [formula], translating the properties that [formula] is a general partition graph, resp. a triangle graph, to G. We recall that the general partition property and the triangle property are a sufficient and a necessary condition, respectively, for equistability. We summarize the connections in Table [\ref=tabela].

We show that, when restricted to the class of bipartite graphs, the upper three classes on the left in Table [\ref=tabela] coincide. Moreover, when restricted to the class of forests, all four classes on the left in Table [\ref=tabela] coincide.

The paper is structured as follows. Section [\ref=sec:Preliminaries] contains the basic definitions and known lemmas that establish the known equivalences and implications in Table [\ref=tabela]. In Section [\ref=sec:Basic_results] we establish the first and the last equivalence from Table [\ref=tabela] and observe that the implications in the left side of the table cannot be reversed. Sections [\ref=sec:Equistarable_bipartite] and [\ref=sec:forests] contain our main results, that is, a complete characterization of equistarable bipartite graphs and of equistarable forests, along with some algorithmic aspects concerning the recognition of these newly characterized families.

Preliminaries

All graphs in the paper will be finite, simple and undirected. For undefined graph theoretic notions, we refer to [\cite=west]. A stable or (independent) set in a graph is a set of pairwise non-adjacent vertices; a stable set is said to be maximal if it is not contained in any other stable set. A clique in a graph is a set of pairwise adjacent vertices. We denote by N(u) the set of all neighbors of u and [formula]. The degree of a vertex u in a graph G, denoted by dG(u), is equal to |N(u)|. The minimum degree of a graph G is the minimum degree of its vertices and is denoted by δ(G).

The complement of a graph G is the graph [formula] with the same vertex set as G in which two distinct vertices are adjacent if and only if they are not adjacent in G. The line graph L(G) of G is a graph such that: (i) the vertex set of L(G) is the edge set of G and (ii) two distinct vertices of L(G) are adjacent if and only if they share a common endpoint as edges in G. A graph G is bipartite if its vertex set can be partitioned into two independent sets, and triangle-free if it does not have a triangle (K3) as induced subgraph. A graph is said to be a star if it is isomorphic to the complete bipartite graph K1,n for some n  ≥  1.

A graph G = (V,E) is a general partition graph if there exists a set U and an assignment of non-empty subsets Ux  ⊆  U to the vertices of G such that two vertices x and y are adjacent if and only if [formula] and for every maximal stable set S of G, the set {Ux  :x∈S} is a partition of U [\cite=McAvaney14]. A graph G = (V,E) is said to be equistable if and only if there exists a mapping [formula] such that for all S  ⊆  V, S is a maximal stable set in G if and only if [formula] [\cite=MR553649]. In 1994 Mahadev et al. introduced in [\cite=MPS13] a subclass of equistable graphs, the so-called strongly equistable graphs. For a graph G, we denote by S(G) the set of all maximal stable sets of G, and by T(G) the set of all other nonempty subsets of V(G). A graph is said to be strongly equistable if for each T∈T(G) and for each γ  ≤  1 there exists a function [formula] such that φ(S) = 1 for all S∈S(G), and φ(T)  ≠  γ. The triangle condition was introduced by McAvaney et al. in [\cite=McAvaney14] and states that for every maximal stable set S in G  =  (V,E) and every edge uv in G  -  S there is a vertex s∈S such that {u,v,s} induces a triangle in G. Graphs satisfying this condition are called triangle graphs.

A matching in a graph G is a set of pairwise disjoint edges. Given a matching M in a graph G, we say that a vertex v is covered (or saturated) by M if v is an endpoint of an edge in M. We will denote by V(M) the set of all endpoints of edges in M. Given two matchings M and M' in a graph G, we say that M extends to M' if M  ⊆  M'. A matching consisting of exactly k edges will be referred to as a k-matching (where k is the size of the matching). A matching M is said to be a perfect matching of G if it covers all vertices of G. We say that a matching M in a graph G is a perfect internal matching if every vertex not covered by M is a leaf, that is, a vertex of degree 1. Perfect internal matchings were studied in a series of papers, see for example [\cite=Bar_Gombas] [\cite=Bar_Mik_ARS] [\cite=Bar_Mik_IPL] and references cited therein. For a general reference on matching theory, see [\cite=LovPlum].

A connected graph G is said to be k-extendable if G contains a k-matching and every k-matching can be extended to a perfect matching [\cite=MR583220]. We generalize this notion as follows.

Even though for the purposes of stating the main results in this paper (Theorems [\ref=thm:main_for_bipartite] and [\ref=thm:main_for_forests]), it would be more convenient to define a graph G to be k-internally extendable simply as a graph in which every k-matching extends to a perfect internal matching, we decided to keep the definition more restrictive, requiring also connectedness and the existence of a k-matching. This is because this way, the definition is similar to the definition of k-extendable graphs; moreover, the two notions coincide for graphs of minimum degree at least 2. In this paper, we consider k-internally extendable graphs only for k∈{1,2}.

Given a graph G and a vertex v∈V(G), the star rooted at v is the set E(v) of all edges incident with v. A star of G is a star rooted at some vertex v∈V(G) and a star is said to be maximal if it is not properly contained in any other star. We denote the union of stars from a set of vertices as [formula], where U  ⊆  V(G). In [\cite=MT] were introduced as graphs G = (V,E) without isolated vertices for which there exist a mapping [formula] on the edges of G such that a subset F  ⊆  E is a maximal star in G if and only if [formula]. Such a mapping φ is called an equistarable weight function of G. Note that for every equistarable weight function φ, we have φ(e)  >  0 for all e∈E(G), since otherwise that would directly imply that we would have a total weight of 1 on some subset of the edges that does not induce a maximal star in G. For a graph G we denote by S*(G) the set of all maximal stars of G, and by T*(G) the set of all other nonempty subsets of E(G). A graph G = (V,E) without isolated vertices is said to be strongly equistarable if for each T∈T*(G) and each γ  ≤  1 there exists a mapping [formula] such that φ(S) = 1 for all S∈S*(G), and φ(T)  ≠  γ [\cite=MT]. Given a graph G and a subset of edges F  ⊆  E(G), the characteristic vector of F is the vector χF∈{0,1}E(G) defined as χFe  =  1 if e∈F, and χFe  =  0, otherwise.

We also introduce the following property imposing a constraint on 5-vertex paths in the graph. A graph G is said to be P5-constrained if the middle vertex of every (not necessary induced) 5-vertex path P5 in G is of degree at least 3, that is, it is incident with at least one edge not in the path.

We conclude this section by discussing the validity of Table [\ref=tabela]. The following lemmas from [\cite=MT] establish the second and third equivalences in Table [\ref=tabela].

Let G be a triangle-free graph. Then G is strongly equistarable if and only if [formula] is a strongly equistable graph.

Let G be a triangle-free graph. Then G is equistarable if and only if [formula] is equistable.

The first and the third implication in the right side of Table [\ref=tabela] were proved by Miklavi c and Milani c in [\cite=MM15] (the third one was essentially observed already in [\cite=MPS13]), and, as already mentioned, the second implication in the right side of Table [\ref=tabela] was proved by Mahadev et al. in [\cite=MPS13]. Lemmas [\ref=lem:strongly_equistar-strongly_equistab] and [\ref=lem:equistar-equistab] along with the second implication in the right side of Table [\ref=tabela] directly imply the second implication in the left side of Table [\ref=tabela].

Every strongly equistarable triangle-free graph G is equistarable.

In fact, a straightforward adaptation of either the geometrical proof of the result of Mahadev-Peled-Sun from [\cite=MPS13] or the alternative proof given in [\cite=MT] to the setting of strongly equistarable graphs shows that the same statement holds for general graphs (not necessary triangle-free). That is, every strongly equistarable graph is equistarable.

The first and the fourth equivalence in Table [\ref=tabela] will be proved in Lemmas [\ref=lem:co-line-gpg] and [\ref=lem:co-line-triangle], respectively, in Section [\ref=sec:Basic_results]. In turn, this will imply the validity of the first and the third implication in the left side of Table [\ref=tabela].

Basic results and examples

As proved by Korach et al. in [\cite=Korach-Peled-Rotics], a graph G is equistable if and only if each connected component of G is equistable. As we show in Lemma [\ref=lem:equistarable_components] below, the analogous property for equistarable graphs holds only in one direction. To this end, recall that in [\cite=MT] the following property of the graph H depicted in Fig. [\ref=fig:equistarable_notstrongly] was observed.

Let H be the graph depicted in Fig. [\ref=fig:equistarable_notstrongly], and let [formula] be any weight function on the edges of H such that φ(E(v))  =  1 for every v∈V(H). Then, the 2-matching {e,f} (see Fig. [\ref=fig:equistarable_notstrongly]) satisfies φ({e,f})  =  1 / 2.

The statement of Lemma [\ref=lem:H] appeared within the proof of Proposition 2 in [\cite=MT] (where graph H was named G*) and was established using the structure of a basis of the kernel of the incidence matrix of the graph. We offer an alternative, shorter proof, using a method that we will apply again later (in the proof of Proposition [\ref=prop:Petersen]).

Let [formula] be the mapping as depicted in Fig. [\ref=fig:H].

That is, vertices in the bigger part of the bipartite graph H - {e,f} get assigned weight 1 / 2, and all the other vertices get weight - 1 / 2. Using the coefficients given by the mapping λ, the characteristic vector of the 2-matching M  =  {e,f} can be expressed as a linear combination of the characteristic vectors of maximal stars, that is, [formula] Since [formula] and φ(E(v))  =  1 for all v∈V(H), this implies that φ(M)  =  1 / 2.

If a graph G is equistarable, then every connected component of G is equistarable. On the other hand, the class of equistarable graphs is not closed under taking disjoint union.

If φ is an equistarable weight function of a graph G and C is a connected component of G, then φ', the restriction of φ to E(C) is an equistarable weight function of C. This follows immediately from the definitions, using the fact that for every subset F of E(C), F is a maximal star of C if and only if it is a maximal star of G.

The fact that the class of equistarable graphs is not closed under taking disjoint union can be now justified using Lemma [\ref=lem:H]. Indeed, the lemma implies that the disjoint union of two copies of H contains a 4-matching of total weight 1 in each equistarable weight function, and is hence not equistarable.

The following consequence of Lemma [\ref=lem:equistarable_components] is in contrast with the fact that the class of strongly equistable graphs is closed under join, as proved by Mahadev et al. in [\cite=MPS13].

The set of equistable graphs is not closed under join.

Since the graph H depicted in Fig. [\ref=fig:equistarable_notstrongly] is an equistarable triangle-free graph, the complement of its line graph is equistable (see Table [\ref=tabela]). Let 2H denote the disjoint union of two copies of H. It can be seen that the graph [formula] is isomorphic to the join of two copies of [formula]. However, since the graph 2H is not equistarable, the graph [formula] is not equistable.

The following lemma is from [\cite=MT].

Let G be a triangle-free graph with δ(G)  ≥  2. Then, [formula] is a general partition graph if and only if every 2-matching of G extends to a perfect matching.

We now generalize Lemma [\ref=lem:gen.par-2ext], thus establishing the first equivalence in Table [\ref=tabela]. In the proof we will make use of a result by McAvaney et al., which we now state. A strong clique in a graph G is a clique containing at least one vertex (equivalently: exactly one vertex) from each maximal stable set.

Let G be a graph. Then, G is a general partition graph if and only if every edge of G belongs to a strong clique.

For every triangle-free graph G, the following conditions are equivalent:

[formula] is a general partition graph.

Every 2-matching of G extends to a perfect internal matching.

Every component of G is either a star or 2-internally extendable.

We first show the equivalence of conditions 1 and 2, and then the equivalence of conditions 2 and 3.

For 1  ⇔  2, we first use Theorem [\ref=thm:strong-cliques] to infer that it suffices to show that every edge of [formula] belongs to a strong clique if and only if every 2-matching of G extends to a perfect internal matching. It follows from the definitions of the complement and the line graph operators that a subset M  ⊆  E(G) is a 2-matching of G if and only if it forms an edge of [formula]. Moreover, a set [formula] forms a strong clique in [formula] if and only if F forms a stable set in L(G) intersecting all maximal cliques of L(G). Since G is triangle-free, maximal cliques of L(G) correspond bijectively to the maximal stars of G. Therefore, a stable set F in L(G) intersecting all maximal cliques of L(G) is a matching of G intersecting all maximal stars of G. Equivalently, F is a perfect internal matching of G that in addition contains all unique edges of components of G isomorphic to K2 (since the stars rooted at any vertex of the K2 are maximal stars).

The above implies that every edge of [formula] belongs to a strong clique if and only if every 2-matching of G extends to a perfect internal matching that contains all unique edges of components of G isomorphic to K2. This last condition is easily seen to be equivalent to the condition that every 2-matching of G extends to a perfect internal matching, and establishes the equivalence 1  ⇔  2.

To prove 2  ⇒  3, suppose that every 2-matching of G extends to a perfect internal matching, let C be a component of G that is not a star, and let M be a 2-matching in G. By assumption, M extends to a perfect internal matching M'. Then, matching [formula] is a perfect internal matching of C extending M.

It remains to show 3  ⇒  2. Suppose that every connected component of G is either a star or 2-internally extendable. Then, each component C of G contains a perfect internal matching, say MC. Let M = {e,f} be a 2-matching in G. If M is contained in a single connected component of G, say C, then M is contained in a perfect internal matching of C, say M', and a perfect internal matching of G extending M is given by [formula], where C denotes the set of all connected components of G.

Suppose now that the two edges of M belong to different connected components of G, say e∈Ce and f∈Cf. We claim that e is contained in an internal perfect matching of Ce (and then by symmetry, f is contained in an internal perfect matching of Cf). If e extends to a 2-matching of Ce, then we can apply the assumption that Ce is 2-internally extendable, and the claim follows. So suppose that {e} is a maximal matching in Ce. Then, the set [formula], where e  =  xy, is an independent set in Cf. Since Ce is triangle-free, every vertex of [formula] is of degree 1 in Ce. But this implies that {e} itself is a perfect internal matching of Ce.

Denoting by Me and Mf internal perfect matchings of Ce and Cf containing e and f, respectively, a perfect internal matching of G extending M is given by [formula]. This establishes the implication 3  ⇒  2 and completes the proof.

The last equivalence from Table [\ref=tabela] is proved in the next lemma. Recall that a graph is said to be P5-constrained if the middle vertex of every (not necessary induced) 5-vertex path P5 in G is incident with at least one edge not in the path.

Let G be a triangle-free graph with at least one edge. Then [formula] satisfies the triangle condition if and only if G is P5-constrained.

Suppose first that [formula] satisfies the triangle condition but G is not P5-constrained. Therefore there exists a [formula] in G where dG(v3) = 2. The set E(v3) = {v2v3,v3v4} is a maximal star in G, therefore in [formula] it is a maximal stable set, because G is triangle-free. Let us introduce e  =  v1v2 and f  =  v4v5. Since in the graph [formula] the vertex [formula] is adjacent to f but not to e and [formula] is adjacent to e but not to f, we conclude that the edge {e,f} in [formula] can not be extended to a triangle with a vertex from the maximal stable set E(v3), a contradiction with the triangle condition.

Suppose now that G is P5-constrained. We will verify that the triangle condition holds for [formula]. Take a maximal stable set S in [formula] and a pair of adjacent vertices [formula]. Note that S is a maximal star in G, centered at some vertex v and {e,f} is a 2-matching in G. Note also that since e,f∉S, these two edges are not incident with v in G. It is enough to show that there exists an edge g∈S  ⊆  E(G) such that {e,f,g} form a 3-matching in G. Equivalently, we need to show that v has a neighbor not covered by the matching {e,f}. If dG(v) = 1, that is, |S|  =  1, then, since S is a maximal star, the connected component of G containing vertex v is a single edge, g∈E(G). Thus, no edge of G is incident with g, and hence {e,f,g} is a 3-matching. If dG(v) = 2, then, since G is triangle-free and P5-constrained, at most one neighbor of v is covered by {e,f}, hence in this case there exists an uncovered neighbor of v. Similarly, if dG(v)  ≥  3, then the triangle-freeness implies that e and f cover at most two neighbors of v, and again there exists an uncovered one. So in all cases we can extend {e,f} to a 3-matching using an edge incident with v. This shows that [formula] satisfies the triangle condition.

Counterexamples to converses of the implications in Table [\ref=tabela]

As explained at the end of Section [\ref=sec:Preliminaries], Lemmas [\ref=lem:co-line-gpg] and [\ref=lem:co-line-triangle] together with previously known results suffice to justify all implications and equivalencies in Table [\ref=tabela]. In [\cite=MM15], circulant graphs of the form Cn({1,3}) for odd n  ≥  11 were given as examples of a connected triangle-free strongly equistarable graphs that are not 2-extendable; thus, since 4-regular, these graphs are also not 2-internally extendable. This shows that the first implication on either side of Table [\ref=tabela] cannot be reversed. The graph H depicted in Fig. [\ref=fig:equistarable_notstrongly] was given in [\cite=MM15] as an example of an equistarable but not strongly equistarable graph. Note that the graph is triangle-free, and hence shows that the second implication on either side of Table [\ref=tabela] cannot be reversed.

What about the third implication on either side of Table [\ref=tabela]? Regarding examples of non-equistable graphs satisfying the triangle condition, all the examples known so far (to us) can be found in [\cite=MM15]. These are:

A specific example discovered already by DeTemple et al. [\cite=MR1212882]: a 9-vertex graph G* given by [formula] and by the family of its maximal stable sets S(G) = {{1,2,3},{4,5,6}, {7,8,9},{1,4,7},{3,6,9}}.

An infinite family consisting of tensor product graphs of the form Km  ×  Kn with .

(Recall that the tensor product of two graphs G and H is the graph G  ×  H with vertex set V(G)  ×  V(H) in which two vertices (u1,v1) and (u2,v2) are adjacent if and only if u1v1∈E(G) and u2v2∈E(H).) It is an easy exercise to verify that for each m,n, we have where [formula] denotes the graph isomorphism relation. Therefore, since the graphs Km,n are triangle-free, Lemma [\ref=lem:co-line-triangle] implies that the graphs Km,n for m > n  ≥  3 are P5-constrained and non-equistarable. In the next proposition, we offer a short direct proof of this fact.

For every m  >  n  ≥  3, the complete bipartite graph Km,n is P5-constrained and not equistarable.

Let [formula] with 3  ≤  n  <  m. Since δ(G) = n  ≥  3 the graph G is P5-constrained. Suppose G is equistarable and fix an equistarable weight function [formula]. Note that every vertex of G is a center of a maximal star. Hence, n  =  φ(E(A))  =  φ(E)  =  φ(E(B))  =  m, a contradiction.

The specific example G* mentioned above was introduced by DeTemple et al. in [\cite=MR1212882] as the intersection graph of a system of chords on a circle (represented on the left in Fig. [\ref=fig:system_of_chords_and_bipartite_graph]). It turns out that G* is also of the form [formula] where G is a bipartite P5-constrained non-equistarable graph. In fact, such G is the smallest member of an infinite family B of bipartite P5-constrained non-equistarable graphs, which we define now. Let Km,n be the complete bipartite graph with a fixed bipartition {A,B} of its vertex set with |A| = m and |B| = n. Let K+m,n be a graph obtained from Km,n by adding to each vertex from set B a private neighbor (a leaf). Then B  =  {K+m,n|3  ≤  n  ≤  m + 1}. The graph K+2,3 is shown in Fig. [\ref=fig:system_of_chords_and_bipartite_graph].

Each graph in B is P5-constrained and not equistarable.

Let G∈B, with bipartition {A',B} such that [formula], where L is the set of leaves and |A| = m, |B| = |L| = n. Since n  ≥  3, we do not have any vertices of degree 2, so G is P5-constrained. Suppose that G is equistarable and fix an equistarable weight function [formula]. Note that every vertex of [formula] is the center of a maximal star. Summing up the maximal stars from each partition we get n  =  φ(E(B))  =  φ(E(A))  +  φ(E(L))  =  m  +  φ(E(L)) implying φ(E(L))  =  n  -  m. Since φ(e) > 0 for all e∈E(G), we have φ(E(L))  >  0 and therefore n > m, which together with n  ≤  m + 1 implies n  =  m + 1 and hence φ(E(L))  =  1. This is a contradiction since the set of edges in E(L) does not induce a star in G.

All the above examples of P5-constrained non-equistarable triangle-free graphs are bipartite. In the next proposition we exhibit a graph that is not of this form.

The Petersen graph is triangle-free, P5-constrained, and not equistarable.

Let G be the Petersen graph. Clearly, G is triangle-free as well as P5-constrained (since it is 3-regular). Suppose for a contradiction that G is equistarable and let [formula] be an equistarable weight function of G. Fix a 3-matching M of G such that the subgraph of G induced by M is 1-regular (for example, let M consist of the three thick edges as in Fig. [\ref=fig:Petersen]), and let [formula] be the mapping given by [formula]

To complete the proof, observe that the characteristic vector of M can be expressed in the form

[formula]

However, since [formula], this means that we have expressed the characteristic vector of M as an affine combination of the characteristic vectors of the (maximal) stars of G. Since φ(E(v))  =  1 for all v∈V(G), this implies that φ(M)  =  1, contrary to the fact that φ is an equistarable weight function of G and M is not a star. This shows that the Petersen graph is not equistarable.

The complement of the line graph of the Petersen graph is a non-equistable graph satisfying the triangle condition.

Equistarable bipartite graphs

When restricted to complements of line graphs of triangle-free graphs of minimum degree at least 2, Orlin's conjecture can be rephrased in terms of equistarable graphs as follows: every connected component of an equistarable triangle-free graph G of minimum degree at least 2 is 2-extendable. As the graph in Fig. [\ref=fig:equistarable_notstrongly] shows, this is not the case. The work [\cite=MT] left open the validity of Orlin's conjecture for the class of complements of line graphs of bipartite graphs, and more generally for the class of perfect graphs. In this section, we prove that Orlin's conjecture holds for complements of line graphs of bipartite graphs (note that these graphs are perfect), using the notions of 1- and 2-internal extendability (see Definition [\ref=def:k-internally_ext.]). In particular, we show that in the case of bipartite graphs, the classes of (i) graphs in which each connected component is either a star or 2-internally extendable, (ii) strongly equistarable graphs, and (iii) equistarable graphs, all coincide (cf. Table [\ref=tabela]).

Let G be a connected equistarable bipartite graph with δ(G)  ≥  2. Then, G is 1-extendable.

We offer two proofs of this lemma. Our first proof is based on the classical Birkhoff-von Neumann theorem on doubly stochastic matrices.

Fix a bipartition {A,B} of V(G), and an equistarable weight function [formula]. Since δ(G)  ≥  2, every star is maximal. It follows that |A|  =  φ(E(A))  =  φ(E(G))  =  φ(E(B))  =  |B|. Let n  =  |A|  =  |B|, and let Q be the n  ×  n matrix with rows are indexed over A, and columns indexed over B defined by

[formula]

For every a∈A, we have [formula], and similarly [formula] for all b∈B. Since Q only has non-negative entries, it is doubly stochastic. By the Birkhoff-von Neumann theorem, Q can be written as a convex combination of permutation matrices, say [formula] where λi  ≥  0 for all i and [formula].

To show that G is 1-extendable, we need to argue that every edge ab∈E(G) is contained in a perfect matching. Note that φ(ab) > 0 (since otherwise [formula] would be a set of edges of unit φ-weight not equal to a star). Consequently, [formula], so there exists some [formula] such that λj > 0 and Pja,b > 0. We claim that M  =  {xy  :  Pjx,y > 0} is a perfect matching in G. To see this, it suffices to show that M  ⊆  E(G). But this follows from the fact that xy∈M implies [formula]. We conclude that G is 1-extendable.

Our second proof of Lemma [\ref=lem:equistarable-1-extendable] is derived using the following characterization of k-extendable bipartite graphs.

Let k  ≥  1 and let G = (V,E) be a connected bipartite graph with a bipartition {A,B} of its vertex set and |V|  ≥  2k. Then, G is k-extendable if and only if |A| = |B| and for all non-empty subsets X  ⊆  A with |X|  ≤  |A| - k, it holds that |N(X)|  ≥  |X| + k.

In the proof of Lemma [\ref=lem:bipartite_equistarable] below, we will make use of the following result on matchings.

Let G be a bipartite graph with bipartition [formula]. Suppose MA and MB are matchings in G. Then there exists a matching [formula] which covers all the vertices of A covered by MA and all the vertices of B covered by MB.

Every component of an equistarable bipartite graph is either a star or 2-internally extendable.

Let G' be an equistarable bipartite graph and let G = (V,E) be a component of G'. Then G is equistarable by Lemma [\ref=lem:equistarable_components]. Fix a bipartition {A,B} of V, and let [formula] be an equistarable weight function of G.

Suppose that G is not a star. Let L be the set of leaves of G and let us say that a vertex v∈V is internal if it is neither a leaf nor adjacent to a leaf.

We split the proof into two cases.

Case 1: [formula].

Since the graph G does not have any leaves, Lemma [\ref=lem:equistarable-1-extendable] implies that G is 1-extendable. We claim that G is also 2-extendable. Suppose that is not the case, and let {ab,a'b'} with a,a'∈A and b,b'∈B be a 2-matching not contained in any perfect matching. By Hall's Theorem, there exists a subset [formula] such that [formula]. Since the graph is 1-extendable, S must have edges to both b and b', and we must have [formula].

It follows that the sum of the characteristic vectors of the stars corresponding to [formula] minus the sum of the characteristic vectors of the stars of vertices in S defines a subset F of the edges of G such that {ab,a'b'}  ⊆  F; in particular, F is not a star. Since [formula], we have φ(F) = 1. This contradicts the fact that φ is an equistarable weight function of G. Thus in this case G is 2-extendable, which is equivalent to the condition that G is 2-internally extendable.

Case 2: [formula].

We start by proving that for every subset S of internal vertices in A (or in B) we have |N(S)|  ≥  |S| + 2. Since each vertex in [formula] is the center of a maximal star, we have |S|  =  φ(E(S))  ≤  φ(E(N(S)))  =  |N(S)| and therefore we just have to rule out the cases when |N(S)|∈{|S|,|S| + 1}.

If |N(S)| = |S|, then since G is connected, and S  ≠  A (since [formula] in this case), there must exist an edge incident with N(S) but not with S. Therefore, since φ is strictly positive on all edges, we get |S|  =  φ(E(S))  <  φ(E(N(S)))  =  |N(S)|, a contradiction. Suppose now that |N(S)| = |S| + 1 for some subset S  ⊆  A of internal vertices, and let [formula]. Clearly, φ(F)  =  1. Since φ is an equistarable weight function of G, the set F is a maximal star. Since every vertex in N(S) incident with an edge in F is also incident with an edge not in F, the star F cannot be rooted at a vertex in N(S). Therefore, it is rooted at some vertex [formula] with dG(x)  ≥  2. Since the star is maximal, we have N(x)  ⊆  N(S). By connectedness, this implies that [formula] and N(S)  =  B. In particular, all vertices of A are of degree at least 2. Therefore, G has at least one leaf in the set B = N(S), which is in contradiction with the assumption that S consists of internal vertices only. Therefore we have shown that |N(S)|  ≥  |S| + 2.

Now let M be a 2-matching of G. The inequality we have proven implies that for every subset S of internal vertices in A - V(M) (or in B - V(M)), we have |NG - V(M)(S)|  ≥  |S|. Therefore, by Hall's theorem there exists a matching MA in G - V(M) covering all internal vertices in A - V(M) and a matching MB in G - V(M) covering all internal vertices in B - V(M). By Theorem [\ref=thm:matching_extension], graph G contains a matching [formula] covering all internal vertices in [formula]. This matching together with M covers all internal vertices in G. Some vertices incident with a leaf might still be uncovered, but they can be covered one by one with new edges to form a perfect internal matching containing M. This proves that G is 2-internally extendable and hence the lemma is proved.

Now we have everything ready to prove the characterization of equistarable bipartite graphs,

For every bipartite graph G without isolated vertices, the following are equivalent:

Since bipartite graphs are triangle-free, we already know (a) ⇔   (b) (by Lemma [\ref=lem:co-line-gpg]) and (a) ⇒   (c) ⇒   (d) (by Table [\ref=tabela]). Lemma [\ref=lem:bipartite_equistarable] establishes the implication (d) ⇒   (a) completing the proof of the theorem.

Table [\ref=tabela] and Theorem [\ref=thm:main_for_bipartite] imply the following.

Orlin's conjecture holds for complements of line graphs of bipartite graphs. That is, within the class of complements of line graphs of bipartite graphs, every equistable graph is a general partition graph.

Lemma [\ref=lem:equistarable_components] and its proof show that triangle-free equistarable graphs are not closed under taking disjoint union. On the other hand, Theorem [\ref=thm:main_for_bipartite], in particular the equivalence of items (a) and (d), shows that for the case of bipartite graphs, we have the following.

A bipartite graph G is equistarable if and only if every connected component of G is equistarable.

We conclude this section with an algorithmic remark. To the best of our knowledge, the computation complexity status of recognizing graphs in each of the following classes is open: (strongly) equistable graphs, general partition graphs, triangle graphs, (strongly) equistarable graphs. The characterization of equistarable bipartite graphs given by Theorem [\ref=thm:main_for_bipartite] implies an efficient recognition algorithm for this special case.

Equistarable bipartite graphs can be recognized in polynomial time.

Given a graph G, testing for bipartiteness can be done in linear time, and we may also assume that G has no isolated vertices. By Theorem [\ref=thm:main_for_bipartite], in order to determine if G is equistarable, it is enough to enumerate all of the O(|E(G)|2) 2-matchings of G, and check, for each of them, if it can be extended to a perfect internal matching. Given a 2-matching M, this can be done as follows. Defining [formula], the problem becomes equivalent to the problem of determining if the graph G  -  V(M) contains a matching covering all vertices in U. This problem can be solved in polynomial time either via matching matroids (see, e.g., [\cite=schrijver-book]), or by reducing the problem to an instance of the maximum weight matching problem. This can be done by assigning a weight [formula] to each edge e of the graph G  -  V(M). In this case, the graph G  -  V(M) contains a matching that covers U if and only if the graph G  -  V(M) contains a matching M' of total weight w(M')  ≥  |U|. Since the maximum weight matching problem is solvable in polynomial time [\cite=Edmonds], the proposition is proved.

Equistarable forests

Recall that a forest is an acyclic graph. In this section we show that the classes of (i) forests in which each connected component is 2-internally extendable or a star, (ii) strongly equistarable forests, (iii) equistarable forests, and (iv) P5-constrained forests, all coincide (cf. Table [\ref=tabela]).

Every tree T with at least one edge is 1-internally extendable.

The proof is by induction on the number of vertices. For n = 2 the statement is true, since the tree with two vertices has only one edge. Let n  ≥  3, let T be a tree on n vertices and let e be the edge of T that we want to extend into a perfect internal matching. Suppose the statement of the lemma is true for every tree on at most n - 1 vertices. We now show that it holds also for T. The removal of the endpoints of e (along with all the edges incident to them) from T results in a forest with connected components [formula], k  ≥  1. Let [formula]. For each i∈I, a tree Ti has no more than n - 1 vertices (and at least one edge) and is therefore 1-internally extendable by the inductive hypothesis. For each such i, let vi∈V(Ti) be the unique vertex in Ti adjacent to an endpoint of e, and let ei be an edge in Ti incident with vi. Let Mi be a perfect internal matching of Ti that extends ei. By our inductive hypothesis, Mi exists. Using the fact that every leaf of T is also a leaf of one of the subtrees, we can construct a perfect internal matching M of T containing e as: [formula]. Therefore we conclude that T is 1-internally extendable.

Using the above lemma, we now prove the stated characterization.

For every forest F without isolated vertices, the following are equivalent:

The fact that (a), (b), (c), (d) are equivalent follows from Theorem [\ref=thm:main_for_bipartite]. Since forests are triangle-free, implication (d) ⇒   (e) is given by Table [\ref=tabela].

It remains to show (e) ⇒   (a). Let a forest F be P5-constrained. Let T be a connected component of F. Then, T is also P5-constrained. Suppose that T is not a star. Fix a 2-matching M = {e,f} of T and consider the (unique) shortest path P in F between e and f. We construct another matching M' by putting in it for every vertex of P not covered by M, an arbitrary edge incident with it and not in P. (Since T is P5-constrained, all the vertices of P have degree at least 3.) By deleting all edges in P, we are left with a forest F' consisting of trees (note that every leaf of T is also a leaf in F), each of which contains exactly one edge of [formula]. By Lemma [\ref=lem:a1-ext._trees], this edge can be extended to a perfect internal matching in the corresponding tree. This means that the matching [formula] can be extended to a perfect internal matching of T, thus F is 2-internally extendable.

Since forests are bipartite graphs, testing whether a given forest is equistarable can be done in polynomial time by Proposition [\ref=prop:bipartite_recognition]. Theorem [\ref=thm:main_for_forests] implies that this can be done even in linear time.

Equistarable forests can be recognized in linear time.

It is well know that acyclicity can be tested in linear time using depth-first search. Given a forest F, in order to determine if F is equistarable, it is enough to check whether each connected component C of F is P5-constrained (by Theorem [\ref=thm:main_for_forests]). This means that it is enough to identify all vertices v with dF(v) = 2 and check that each of them has at least one leaf in their neighborhood.

Acknowledgement

The third author is grateful to Nicolas Trotignon and Denis Cornaz for stimulating discussions on the topic.