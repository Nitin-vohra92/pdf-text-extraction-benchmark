MHD Generation Code

Rodrigo Carboni Méndez

Introduction

Nowadays, there are programs that generate codes for a given mesh arrangement, but there is no a program to generate the differential equation in a given space-time. Now, we show how it is possible by means of a EXCALC package [\cite=Schruefer] of REDUCE [\cite=Hearn] and a LINUX script. REDUCE is a free computer algebra system (CAS) software intended to algebraic manipulation. In that sense, it is similar to Mathematica or Maple. The EXCALC package solves problems using the Cartan formalism or differential forms [\cite=Arfken] [\cite=Hassani].

Due to the advent of new technology, there is an interest in plasma simulations and visualizations e.g. [\cite=Carboni] [\cite=Germaschewski] [\cite=Pen]. There are a lot of information on these subjects in the Internet [\cite=Birdsall] [\cite=Jardin] [\cite=Hockney] [\cite=Hsu] [\cite=Tajima]. Moreover, the mesh or grid generation is important in designing complex engineering structures or complex nonsymmetric systems [\cite=Persson].

We wrote a REDUCE program (MHD.red) and a long UNIX script (discretized-mhd) mainly for Magnetohydrodynamics (MHD), but the program and script we present here are easy to modify for another purposes. Our program could be used together with a mesh generation code to solve complex problems.

The paper is organized as follows. In section [\ref=01], a brief description of MHD is presented. A short summary of EXCALC is given in section [\ref=02]. The explanation of the program is described in section [\ref=03]. Moreover, we present the results of the discretization to Cartesian coordinates as an example. The conclusions and future work is discussed in section [\ref=06].

MHD

MHD is the study of the dynamics of electrically conducting fluids. Examples of such fluids include plasmas, liquid metals, and salt water or electrolytes. Plasmas can be regarded as fluids since the mean free paths for collisions between the electrons and ions are macroscopically long. Thus, collective interactions between large numbers of plasma particles can isotropize the particles velocity distributions in some local mean reference frame, thereby making it sensible to describe the plasma macroscopically by a mean density, velocity, and pressure. These mean quantities can then be shown to obey the same conservation laws of mass, momentum and energy for fluids.

The fundamental concept behind MHD is that magnetic fields can induce currents in a moving conductive fluid, which in turn creates forces on the fluid and also changes the magnetic field itself. The set of equations which describe MHD are a combination of the Navier-Stokes equations of fluid dynamics and Maxwell's equations of electromagnetism.

An important physical parameter that defines the way MHD treats the systems is resistivity. When the resistivity is very low plasmas can be treated as perfect conductors (ideal MHD in the infinite magnetic Reynolds number limit) and the the lines of force appear to be dragged along with the conductor.

When the resistivity cannot be neglected the magnetic field can generally move through the fluid following a diffusion law with the resistivity of the plasma serving as a diffusion constant. According to this the solutions to the ideal MHD equations are only applicable for a limited time before diffusion becomes too important to ignore. The diffusion time across a solar active region is hundreds to thousands of years. The interested reader may consult the references [\cite=Cap] [\cite=Dendy] [\cite=Jackson] [\cite=Kulikovskiy].

There are many applications of MHD but in this article we are interested in those related to astrophysics and cosmology. Plasma is the constituent of many astrophysical objects of the Universe: stars, nebulae, the interplanetary, the interstellar and the intergalactic media.

Many astrophysical problems require the treatment of magnetized fluids in dynamical, strongly curved spacetimes. Such problems include the origin of gamma-ray bursts, magnetic braking of differential rotation in incipient neutron stars arising from stellar core collapse or binary neutron star merger, the formation of jets and magnetized disks around newborn black holes and many others [\cite=Tajima2].

MHD Equations:

Continuity Equation

The conservation of mass in a fluid tell us that

[formula]

where ρ is the density, [formula] is the fluid velocity and [formula].

Maxwell Equations

The electric Gauß law is

[formula]

where [formula] is the electric field, ρe is the electric charge density and ε0 is the vacuum permittivity.

The magnetic Gauß law is

[formula]

where [formula] is the magnetic field.

The Amperé law is

[formula]

where [formula] is the electric current density and μ0 is the vacuum permeability.

The Faraday law is

[formula]

Equation of Motion

The equation of motion of a fluid or the Navier-Stokes equation with electromagnetic fields is

[formula]

where [formula] is a the stress tensor with components

[formula]

P is the pressure and Tij represents the viscosity stress tensor components, which are given by

[formula]

with μ and ν are the first and second viscosity coeficients.

[formula] is the volume Lorentz force given by

[formula]

where [formula] is the Poynting vector

[formula]

and [formula] is the electromagnetic tensor with following components

[formula]

The Ohm Law

The Ohm law is

[formula]

η is the resistivity.

Equation of State

The equation of state for an ideal gas is

[formula]

where T is the temperature and R is the gas constant.

Equation of Energy Conservation

The equation of energy conservation is

[formula]

where

[formula]

and ε is the internal energy

[formula]

here γ is the adiabatic exponent

[formula]

and [formula] is the heat flux vector

[formula]

with k is the thermal conductivity.

EXCALC

EXCALC is a package under REDUCE intended to solve problems with Cartan exterior calculus. The advantage of using it, is that given equations can be written independent on the coordinate system. The outcomes of the calculations from these equations are expressed in the chosen coordinate system. Here, it is a list of the most used commands:

The principal operations with 1-forms or vectors are listed below

For more information about this REDUCE package, the interested user may consult the references.

The Program

The REDUCE program MHD.red to transform the MHD equations into Cartesian coordinates is included as an appendix. The script discretized-mhd and the generating code are not include in this paper, but it can be emailed send by the authors if requested, and in a near future will be available at our Space Research Center Webpage.

Example of the Script for Cartesian Coordinates

Now, we will present the modified output of the programs for a given MHD equations using an UNIX script. Let us consider the induction equation:

[formula]

where [formula] and [formula], without taking into account the time variation of the electric field.

For example, the outcome from our program for the y component of the induction equation (Cartesian coordinates) is

As this output is not easy to handle, we translate such equation to a FORTRAN or C code, then we wrote a script that modify this outcome into equations with a prescribed discretization method. To this aim, we employ the UNIX command sed [\cite=Unix]. This command change the output using the prescribed discretization method. For instance, the following commands

will produce the translation

[formula]

[formula]

The output of our REDUCE program is mhdeqs (see Appendix) and the mhdeqsnew, which should be created before one runs the script, will contain all modifications of the entire system of equations.

Example of the Code Generation

Here, we show a part of the output after the script is run. In this case, the y component of the induction equation is converted into

Thus, it is possible to use this output as a FORTRAN or C code.

Conclusion

In this paper, we show how to produce quickly a computer code useful to implement simulations or visualizations. The automatic generation of the computer code is possible by means of REDUCE programs and UNIX scripts that modify and manipulate the output of the programs and generate computer codes with a given discretization method. The programs shown here, are flexible and are easy to modify for other purposes.

Due to the rapid advance of technology, there is an interest in computer simulations and visualizations, in particular in plasma physics. Our program together with recent developed grid generation codes helps solve complex plasma phenomena.

Appendix