First-hit analysis of algorithms for computing quadratic irregularity

Introduction

Let [formula] be a real quadratic field with D a positive fundamental discriminant. In several previous papers the author has defined an analogue for the theory of regular and irregular primes in this setting, based on the following definition:

Let ζD be the zeta function for [formula], and let δ be equal to p - 1 unless D  =  p, in which case δ  =  (p - 1) / 2. We say that p is D-regular if p is relatively prime to ζD(1 - 2m) for all integers m such that 2  ≤  2m  ≤  δ  -  2 and also p is relatively prime to pζD(1  -  δ). The number of such zeta-values that are divisible by p will be the index of D-irregularity of p.

(More generally, we may refer to the concept as "quadratic irregularity"; see [\cite=Holden98] [\cite=Holden99] [\cite=mathcomp] for more details and extensions to any totally real number field.)

According to a well-known theorem of Kummer, p divides the order of the class group of [formula] if and only if p divides the numerator of a Bernoulli number B2m for some even 2m such that 2  ≤  2m  ≤  p - 3. Such primes are called irregular; the others are called regular. In [\cite=Holden99], building on work of Greenberg and Kudo, the author proved that in the setting we have described above Kummer's criterion can be extended to give information about whether p divides the class number (that is, the order of the class group) of [formula]. To be exact, we have:

Assume that p does not divide D. Then p divides the class number of [formula] if and only if p is not D-regular.

The main focus of this paper is in finding large p which are irregular for some D. This may be useful for cryptography, in that one common way of constructing public-key cryptographic systems is to utilize the problem of finding a discrete logarithm in some abelian group. In order to make sure that the discrete logarithm problem is computationally hard, one needs to know something about the structure of the group involved, e.g. that it is divisible by a large prime. Theorem [\ref=GH] shows that if p is a large D-irregular prime and p does not divide D, then the class group of [formula] may be suitable for cryptography. We will come back to this in Section [\ref=practical].

Search Algorithms

Suppose, for instance, that we want to find p of a specified size dividing ζD(1 - 2m) for some m such that 2  ≤  2m  ≤  δ - 2 or dividing pζD(1 - δ). (For reasons that will become clear, we will not encounter the situation D = p in practice, so we may focus on the case where δ  =  p - 1. See Section [\ref=probabilities] for the details.) More specifically, we might fix a real number c greater than 1 and then look for m and D such that P  ≤  p  ≤  cP and p divides ζD(1 - 2m) for some positive m less than or equal to (p - 1) / 2. (In practice, c = 2 would probably be the most common choice, since that would be equivalent to specifying the size of p in number of bits.)

The algorithm that we will use to carry out this search is described in [\cite=mathcomp]. The algorithms there fall into two basic types. The first type calculates ζD(1 - 2m) in a range of m for each D before going on to the next D, and calculates each value in time O(mO(1)D1 + o(1)) when amortized over both D and m. The second type calculates ζD(1 - 2m) in a range of D for each m before going on to the next m. If one keeps a table of intermediate values as described in Section 3 of [\cite=mathcomp], this algorithm can calculate each value in time [formula] when amortized over both D and m, where [formula] is a subexponential function corresponding to a choice of factoring routine used in the calculation, e.g. [formula] for the number field sieve. The facts that the amortized times are subpolynomial in D and that a range of D are calculated for each m suggest using this algorithm.

In fact, one might suppose that one could always use m = 1 and search until an appropriate D is found without ever going on to the next m. However, one other factor needs to be taken into account. The size of the numerator of ζD(1 - 2m) is O(m(lgm  +  lgD)) bits (see [\cite=Holden98]), so ζD(1 - 2m) is much more likely to have large prime factors for large m than for small m. The same issue comes up for D, of course, but to a lesser degree and in a way which does not greatly affect this algorithm, since a large number of values of D are used for each m.

To make sure that we can avoid getting stuck in a range where the values of the numerator of ζD(1 - 2m) are too small, we will give our algorithm parameters M1, D1, and D2 such that we always have m  ≥  M1 and D1  ≤  D  ≤  D2. In Section [\ref=hypotheses] we will explain some conjectures which imply that for each pair (D,m), the chance that each prime between P and cP divides ζD(1 - 2m) is approximately 2 / P. Given this, the Prime Number Theorem implies that the chance that some prime between P and cP divides ζD(1 - 2m) is approximately 2(c - 1)  /  ( log P).

Now if we are trying D1  ≤  D  ≤  D2 for each m, we see that the chance that we find a suitable D for any given m is approximately

[formula]

since the asymptotic density of fundamental discriminants in the integers is 3 / π2. However, if we consider the typical case c = 2, then we see that we only have to choose D2 - D1 to be on the order of magnitude of log P for the expected probability of success on any given m to be 1! Thus with D2 - D1 reasonably large, the expected time using this strategy is

[formula]

where the added term of P accounts for the time it takes to check whether each p divides each computed ζD(1 - 2m). Table [\ref=first-hit-timing] provides some actual timing examples of this algorithm, running on a Pentium III computer using the Linux operating system and the GP-Pari interpreted language. (See [\cite=PARImanual].) In all cases D1 = 5 and M1 = 2.

The Hypotheses: Conjectures and Previous Results

The hypotheses mentioned in Section [\ref=algorithms] stem from the conjecture, made (not very explicitly) by Siegel in [\cite=Siegel64], that the numerators of the Bernoulli numbers B2m were evenly distributed modulo p for any odd prime p. Siegel used the conjecture to derive a conjectural density for the irregular primes. (Lehmer seems to have done the same thing in [\cite=Lehmer] but only gives the density.) Siegel's hypothesis was used more generally by Johnson ([\cite=Johnson75]) and independently by Wooldridge ([\cite=Wooldridge]) to predict the density of primes with a given index of irregularity, that is such that p divides a given number of the Bernoulli numbers [formula]. It also comes in handy for predicting many other values that are related to irregular primes, such as the order of magnitude of the first prime of a given index of irregularity. (See, for example, [\cite=Wagstaff78].) Since B2m =  - ζ(1 - 2m)(2m), it is equivalent to say that the values of ζ(1 - 2m) are evenly distributed modulo p, where ζ(s) is the Riemann zeta function.

Little or no progress has been made on proving Siegel's hypothesis, but a great deal of data has been collected, especially in regard to the prediction of Johnson and Wooldridge. Specifically, this prediction says that as p  →    ∞  , the probability that p has index of irregularity r goes to

[formula]

(In addition to the original sources, the details may be found in Section 5.3 of [\cite=Washington].) Note that this prediction does not rely on the full strength of Siegel's hypothesis, but merely on the weaker hypothesis that the Bernoulli numbers are 0 modulo p with probability 1 / p. The assumptions made in Section [\ref=algorithms] relate only to predictions about indices of irregularity based on this weaker hypothesis.

Wagstaff, in [\cite=Wagstaff78], computed ur(x), the fraction of primes not exceeding x with index r of irregularity for each r between 0 and 2 and for all r  ≥  3 grouped together, and compared this distribution to the predicted distribution for each multiple x of 1000 up to 125000. The result of the chi-squared test "fluctuated usually between 0.1 and 1.0 and had the value 0.29 at x = 125000. It was 0.03 at x = 8000" [\cite=Wagstaff78]. These results correspond to significance levels of .992, .801, .962, and .999, respectively. (The significance levels used in this paper correspond roughly to the probability that the agreement between the observed results and the predicted results is not due to chance. Statisticians consider the threshold for considering a result to be not due to chance to be a significance level of .9 to .95. Since we are not actually conducting a valid statistical study in this paper, all of the statistical results should be taken with a very large grain of salt.)

Buhler, Crandall, Ernvall, and Metsänkylä hold the record for computations with irregular primes, having found all the irregular primes below four million as described in [\cite=BCEM]. They do not seem to have done a chi-squared analysis, but they tabulate the values of ur(x) for x = 4000000 and r between 0 and 7. A chi-squared test using the same methodology as before has the result 1.02, for a significance level of .796. Earlier, in [\cite=BCS], Buhler, Crandall, and Sompolski tabulated the same data for x = 1000000. The result of the same chi-squared test is 0.78, for a significance level of .854.

Unfortunately, the only way to collect data to test Siegel's hypothesis is to investigate B2m for larger and larger m, which is very computationally intensive. (See [\cite=Bach] or [\cite=Fillebrown] for details.)

However, in the more general number field case, there are many more dimensions to the problem. We start by restricting our attention to the case of k an abelian totally real number field. Then we know that

[formula]

where Ĝ is the character group of [formula] and L(s,χ) is the L-function associated with the character χ. Note that L(s,1) = ζ(s), so the Riemann zeta function is a factor of the zeta function for k. (See [\cite=CF], e.g., for more details.) Certainly it seems likely that for a fixed (totally real) number field k and character χ the values of the numerator of L(1 - 2m,χ) are evenly distributed modulo p as m varies. (It is known that these values are rational numbers.) We also hypothesize that these values for different χ are independent, which implies that the numerators of ζk(1 - 2m) are distributed modulo p like the product of [formula] independent integer variables, each of which is evenly distributed modulo p. We will refer to this as the "product distribution", for lack of a better term. However, it also is reasonable to conjecture that for a fixed m the values of ζk(1 - 2m) are distributed according to the product distribution modulo p as k varies. More precisely, if we fix m and the degree of k we expect the values to be distributed according to the product distribution modulo p as the discriminant of k varies. Alternatively, if we fix m and the discriminant of k we expect the values to be distributed according to the product distribution modulo p as the degree varies.

In this paper we will be considering the former situation. As in the previous sections, we fix the degree at 2, and let [formula] be a real quadratic field with zeta function ζD(s). In this case

[formula]

where [formula], the Kronecker symbol, where appropriate.

In addition to the above definitions we will make one more set:

Let χ be as above and let δ be as in Section [\ref=introduction]. We will say that p is χ-regular if p is relatively prime to L(1 - 2m,χ) for all integers m such that 2  ≤  2m  ≤  δ  -  2 and also p is relatively prime to pL(1 - 2m,χ). The number of such L-values that are divisible by p will be the index of χ-irregularity of p.

Saying that the values of ζk(1 - 2m) are distributed according to the product distribution and that the values of ζ(1 - 2m) are evenly distributed is the same as saying that the values of L(1 - 2m,χ) are evenly distributed modulo p. Then we can make the same prediction about the indices of χ-irregularity that Johnson and Wooldridge made about the indices of irregularity in the rational case. We briefly investigated this issue in [\cite=Holden98], where there are tables of the analogue of ur(x) (using the index of χ-irregularity) for x = 1000, r from 0 to 4, and D = 5,8,12, and 13. The chi-squared test results are not included, but using the methodology discussed earlier they are 3.32, 1.74, 1.15, and 2.54. The corresponding significance levels are .345, .628, .765, and .469, respectively. We could total the values of (the analogue of) ur(x) for the four values of D and compare them to the predicted values; we might expect that this would give us a better significance level because of the larger "sample size". However, in this case the chi-squared result is 3.53 and the significance level is .316, which is worse than any of the results for the values of D taken separately! This may be due to some small second-order bias which is common to each sample and thus is reinforced when they are pooled together.

The Hypotheses: New Results

In the course of testing the algorithms in [\cite=mathcomp], we collected more data in addition to that above. Table [\ref=D5] shows the number of primes less than 5000 which have χ-index of irregularity r for various values of r and D = 5. We compared the observed and predicted distributions, using the methodology above, for primes below x where x was 1000, 2000, 3000, 4000, and 5000, and found chi-squared values of 3.32, 5.03, 2.51, 1.73, and 2.10 and significance levels of .344, .170, .473, .630, and .552, respectively.

Other data was obtained using the philosophy, described in Section [\ref=algorithms], of computing the values of L(1 - 2m,χ) for large numbers of D and relatively small values of m. As in the discussion of D = 5,8,12, and 13 above, we present the total across the different discriminants. Table [\ref=aveD5000] presents the data for all D < 5000 and p < 100. The chi-squared value for the totals is 81.1 and the significance level is .000.

However, if we view the data broken down by prime, as in Table [\ref=breakdownD5000], we see that a large part of the contribution to the chi-squared value is from small primes. The values of p shown in the table were selected with an eye towards showing both a trend toward smaller chi-squared values as p increases and also some of the exceptions. We hope to make the nature of the small-prime contribution clearer in the future.

Practical Notes

The hypotheses that p divides ζ(1 - 2m) with probability 1 / p and that p divides L(1 - 2m,χ) with the same probability clearly imply that p divides ζD(1 - 2m) = ζ(1 - 2m)L(1 - 2m,χ) with probability (2 / p) - (1 / p2), or approximately 2 / p for very large p, as we claimed in Section [\ref=algorithms]. Also, for the algorithms in that section one doesn't really have to worry about the possibility that δ is not p - 1, since this would require D = p. However, we showed that D2 - D1 can be on the order of magnitude of log p, so the case of D = p can only arise as the result of what can only be called bad planning.

As mentioned in the introduction, one use for the algorithms of this paper may be to find D and p such that the class group of [formula] can be used for cryptographic protocols. In [\cite=BP97], Buchmann and Paulus introduced a one way function based on class groups of number fields and noted that such a function could be used to implement Diffie-Hellman key exchanges and ElGamal signature schemes, to take two examples. These ideas are expanded on in [\cite=Meyer-roots], which introduces a signature scheme called RDSA which is based on taking p-th roots in the class group of a number field or other abelian group. Here p is a random prime number which (one assumes) does not divide the order of the group. One advantage of this signature scheme is that it is unnecessary and in fact undesirable to know precisely the order of the group, a situation which frequently occurs with class groups and in fact is generally true for the class groups found with the algorithms above.

Given that the order of the class group is unknown, the question of which class groups are suitable for these protocols is addressed in [\cite=Meyer-fields], which gives two necessary conditions on the class number:

The class number must be sufficiently large. This should make it difficult to determine the class number or discrete logarithms using exhaustive search, Pollard Rho, Baby-Step-Giant-Step, Hafner-McCurley, or index calculus.

The class number must have at least one sufficiently large prime divisor. This should make it difficult to find discrete logarithms using a Pohlig-Hellman attack.

As we have seen, the algorithms of this paper allow us to find a class number with a prime divisor as large as desired, and thus with the class number itself as large as desired.

The drawback is that the amount of time and space needed to carry out the cryptographic protocols in these groups can also be very large. The papers [\cite=BP97] and [\cite=Meyer-fields] explain how to represent the objects necessary to compute with. Since elements in the class group are equivalence classes of ideals in a ring of integers, we need to store a [formula]-basis for the ring of integers of [formula]. As noted in [\cite=BP97] and explained in more detail in [\cite=BvS], this requires [formula] bits of storage, where Δ is the discriminant of [formula]. Unfortunately, it is not hard to show that Δ = Dp - 1p2p - 4 if p does not divide D or Dp - 1pp - 3 if p does divide D (but p  ≠  D). (See [\cite=Washington], for instance.) Thus the [formula]-basis requires (p log D)O(1) bits of storage. Furthermore, as explained in [\cite=Meyer-fields], an ideal class should be represented by a member of the class which is LLL-reduced; that is, by one which corresponds to an LLL-reduced lattice under Minkowski's embedding. Such an representation requires [formula] bits of storage, where n is the degree of the field and Δ is as before. (See [\cite=BvS] and [\cite=BK] for details.) In our case n = p - 1 (assuming p  ≠  D) so this again requires (p log D)O(1) bits of storage. Of course, this means that the time it takes to carry out the basic algorithms for the class group is also generally going to be exponential in the size of p. Whether this situation is bad enough to preclude the use of our fields is not yet clear.

Conclusion and Future Work

Much of the future work described in [\cite=mathcomp] still remains to be done; in particular many improvements could be made in the implementations of the algorithms and perhaps in the algorithms themselves. However, the results already seem encouraging. With a faster implementation, the use of the search algorithm of Section [\ref=algorithms] to find class groups large enough for secure cryptography seems quite feasible, although this should be tested in practice. More importantly, an implementation of one or more cryptographic protocols needs to be done using the class groups we have described in order to determine whether secure cryptography can be done sufficiently quickly in these groups.

The data collected in Section [\ref=newdata] is also encouraging, but clearly more is necessary. The author hopes to implement and run his algorithms on a true supercomputer in the near future. The data produced by this will undoubtably give a clearer picture of the phenomena so far observed, perhaps leading to refinements of our hypotheses.

Acknowledgements

The author would like to thank Don Burdick of the Institute of Statistics and Decision Sciences at Duke University for his help in making sense of the data presented in Sections [\ref=olddata] and [\ref=newdata]. He would also like to thank Carl Pomerance for suggesting that this data was worthy of presenting to a statistician in the first place.