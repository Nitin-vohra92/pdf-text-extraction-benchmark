package@font

Magnetic Tunnel Junction Mimics Stochastic Cortical Spiking Neurons

The human brain is the most powerful and yet energy efficient computing system known to man. As an attempt to mimic the human brain, and thereby emulate its efficiency in cognitive and perception tasks, computing models have been developed that try to mimic the functionalities involved in the neurons and synapses in the human brain. Although a complete understanding of the brain has still remained elusive, recent advances in neuroscience have brought forward important behavioral characteristics and phenomena underlying neuronal and synaptic operations. Neuromorphic computing refers to the emulation of such underlying neuroscience mechanisms by an equivalent hardware implementation.

Past research on hardware implementation of spiking neurons have mainly focused on deterministic neural models, like the Hodgkin-Huxley [\cite=ghosh2009spiking] and Leaky-Integrate-Fire [\cite=ghosh2009spiking] models. However, emulation of such neural characteristics require area-expensive CMOS implementations involving more than 20 transistors [\cite=rajendran2013specifications] [\cite=indiveri2003low] and a direct mapping of neuronal characteristics to a single nanoelectronic device is still missing. Further, such deterministic neuron models have little correspondence to the probabilistic firing nature of biological neurons and is unable to account for the fact that neural computation in the brain is significantly prone to noise arising from the synapses, dendrites or the neuron itself [\cite=nessler2013bayesian]. Recently, theoretical studies have been performed to demonstrate that Bayesian computation can be performed in networks inspired from cortical microcircuits of pyramidal "stochastic" neurons [\cite=nessler2013bayesian]. Such neurons, observed in the cortex, spike stochastically and the probability of firing depends on the instantaneous magnitude of the resultant post-synaptic current input to the neuron [\cite=nessler2013bayesian] [\cite=wallace2011emergent] [\cite=benayoun2010avalanches] [\cite=nessler2009stdp]. In this paper, we demonstrate a nano-magnetic device that can mimic such cortical "stochastic" neurons.

Let us first illustrate the device structure and principle of operation of a Magnetic Tunnel Junction (MTJ) [\cite=julliere1975tunneling] [\cite=baibich1988giant] [\cite=binasch1989enhanced]. The MTJ consists of two ferromagnetic layers separated by a tunneling oxide barrier (MgO). The magnetization direction of one of the layers (denoted by pinned layer, PL, in Fig. [\ref=mtj]), P, is magnetically hardened so that it serves as the reference layer. The magnetization of the free layer (FL), [formula], can be manipulated by an input charge current. The MTJ is characterized by two stable resistance states, namely the low-resistance parallel (P) configuration ([formula] and P are parallel) and the high-resistance anti-parallel (AP) configration ([formula] and P are anti-parallel). Charge current from the pinned layer to the free layer causes the MTJ to switch to the AP state and vice versa by overcoming the energy barrier, EB (see Fig. [\ref=mtj]). Considering the initial state of the MTJ to be the P state, such a behavior can be mapped to a neural firing when the MTJ switches to the AP state.

The magnetization dynamics of the FL in a nanoscale monodomain magnet at T = 0K can be described by solving Landau-Lifshitz-Gilbert equation with additional term to account for the spin momentum torque according to Slonczewski[\cite=slonczewski1989conductance],

[formula]

where, [formula] is the unit vector of free layer magnetization, [formula] is the gyromagnetic ratio for electron, α is Gilbert s damping ratio, eff is the effective magnetic field including the shape anisotropy field for elliptic disks calculated using [\cite=beleggia2005demagnetization], [formula] is the number of spins in free layer of volume V (Ms is saturation magnetization and μB is Bohr magneton), and Is is the input spin current generated by charge current flow through the pinned layer. Equation  [\ref=llg] can be reformulated by simple algebraic manipulations as,

[formula]

Let us consider an MTJ with in-plane magnetic anisotropy (IMA). The in-plane component of magnetization, [formula], of the nanomagnet can be considered equivalent to the membrane potential of a biological neuron. The first two terms in the RHS of the above equation constitute the "leak" term in the magnetization (membrane potential) dynamics while the last term relates to the integration of input pulses applied to the MTJ. The MTJ "fires" when the magnetization switches to the opposite stable state. Fig. [\ref=mtj_lif] illustrates the leak and integration components of the neuron dynamics for an MTJ elliptic disk due to the application of three successive pulses. The magnetization starts increasing due to integration of the pulses. However, it is insufficient to "switch" the MTJ and the magnetization starts leaking once the applied pulse is removed. The firing or "spiking" of the neuron (which occurs when the membrane potential crosses the threshold) is equivalent to the switching of the MTJ, i.e. magnetization reversal of the in-plane component from -1 to +1. Once the neuron "spikes", it has to be reset back to the intial state. Hence, the operation of the neuron MTJ can be resolved into two cycles, namely a "write" phase followed by a "read" phase. During the "write" phase, the MTJ neuron receives the resultant input synaptic current at a particular time step while the "read" phase is utilized to determine whether the neuron has switched during the "write" phase and is reset back to the P state in case the MTJ switched to the AP state. This reset phase is analogous to the "refractory" period observed in biological neurons [\cite=ghosh2009spiking] where the neuron is not able to generate a "spike" for some time duration after generating a "spike" (corresponding to the time delay involved in reseting back the MTJ to the P state).

At non-zero temperature, the magnetization dynamics of the MTJ is characterized by thermal noise, which can be accounted for by an additional thermal field [\cite=scholz2001micromagnetic], [formula], where G0,1 is a Gaussian distribution with zero mean and unit standard deviation, KB is Boltzmann constant, T is the temperature and δt is the simulation time step. In presence of thermal noise, the switching behavior of the MTJ due to the flow of a charge current through the pinned layer, during the "write" cycle, is stochastic in nature and the probability of switching increases with increase in the magnitude of input current. Hence, such a device offers a direct mapping to the functionality of "stochastic" neurons observed in the cortex [\cite=nessler2013bayesian] [\cite=wallace2011emergent] [\cite=benayoun2010avalanches] [\cite=nessler2009stdp], where the neuron "spikes" (switches its state) probabilistically depending on its resultant synaptic input. The switching characteristics of the neuron in response to the input synaptic current can be varied by changing the energy barrier (or equivalently the free layer thickness) and the duration of the synaptic current as illustrated in Fig. [\ref=prob].

Recent experiments have shown that such an MTJ structure with in-plane magnetic anisotropy (IMA) can also be switched by a charge current flowing through a heavy-metal (HM) underlayer due to the injection of spins (whose polarization is transverse to the direction of both spin and charge current) at the FL-HM interface (assuming spin-Hall effect to be the dominant underlying physical phenomenon: Fig. [\ref=she](a)) [\cite=hirsch1999spin] [\cite=pai2012spin] [\cite=miron2011perpendicular] [\cite=liu2012spin] [\cite=liu2012current]. We will refer to FL switching by such a HM underlayer for the rest of this text due to the possibilities of having decoupled "write" and "read" current paths which helps in interfacing such MTJ "stochastic" neurons with a synaptic resistive crossbar array (discussed later in the text). It is worth noting here that the mechanism of MTJ switching by spin-Hall effect and mapping to a neuron functionality is exactly similar as discussed before. The only difference is that the spin current is generated by the HM underlayer instead of the pinned layer of the MTJ. The generated spin current, [formula] (IQ is the charge current flowing through the HM, θSH is spin-Hall angle [\cite=pai2012spin], dimensions WMTJ and tHM are shown in Fig. [\ref=she](a)). Hence, the device also offers energy-efficient "write" since spin polarization is not limited by polarization of the pinned layer and > 100% spin injection efficiency can be achieved [\cite=pai2012spin]. The device simulation parameters were obtained from experimental measurements [\cite=pai2012spin] and have been shown in Table I. Fig. [\ref=she](b)-(c) illustrates the principle of operation of the "Neuron" MTJ with access transistors to decouple the "write" and "read" current paths.

The behavior of a network of such stochastic MTJ neurons were studied in a standard digit recognition problem based on the MNIST dataset [\cite=lecun1998gradient] as shown in Fig. [\ref=network](a). Such network connections have been observed in pyramidal neurons in the cortex [\cite=nessler2013bayesian] [\cite=nessler2009stdp]. The neurons receive input Poisson spike trains whose frequency is proportional to the pixel intensity. 100 images of digits "0" and "1" were used for the recognition purpose and the network was simulated for a number of time steps, TS, for each image. It is worth noting here that each time step refers to the duration of the "write" phase of the neuron MTJ discussed before. Whenever a neuron spikes, a common inhibitory signal prohibits the neurons from spiking for a period, τinh. Such a network arrangement can be mapped to a crossbar network interfaced with such MTJ neurons as shown in Fig. [\ref=network](b) where programmable resistive synapses encode the synaptic weight at each crosspoint. Phase-change devices [\cite=jackson2013nanoscale], Ag-Si memristors [\cite=jo2010nanoscale] or spintronic synapses [\cite=sengupta2015spin] have been proposed in literature to implement such synaptic functionality in a crossbar architecture. The synapses were modeled with 4-bit discretization and a maximum to minimum resistance ratio of 20. An input spike triggers a voltage across the corresponding row for a duration of τ0 time steps (analogous to post-synaptic potential observed in biology). The neuron, therefore, receives an input current which is proportional to the weighted sum of the post-synaptic voltages (since HM resistance is much lower than the synaptic resistances at each cross-point) and spikes in a stochastic manner. A behavioral model of the neuron was developed by running stochastic LLG simulations to capture its probabilistic spiking behavior. Non-Equilibrium Green's function based transport simulation framework [\cite=fong2011knack] was used to model the MTJ resistance. Unsupervised learning was performed using Spike-Timing Dependent Plasticity (STDP) [\cite=diehl2015unsupervised] [\cite=knag2015sparse]. The STDP weight update equations were, [formula] (for Δt > 0) and [formula] (for Δt < 0), where Δt is the spike timing difference. During learning, lateral inhibition prevented the non-spiking neurons from spiking for a particular duration. In order to prevent single neurons from dominating the spiking pattern, homeostasis [\cite=diehl2015unsupervised] [\cite=knag2015sparse] was performed by scaling the input current to the MTJ neuron by a variable which increased at every spike. The neurons learn representative models of the digits after a few epochs (Fig. [\ref=network](c)). After learning, each neuron gets trained to respond to a specific digit (Fig. [\ref=network](d)). Each time step in the simulation was taken to be 0.5ns long and the barrier height of the neuron MTJ was chosen to be 20KBT. The total input current to each neuron over all the 100 images were averaged to obtain an average input current of ~  7μA per time step per neuron. The average I2Rt energy consumption per neuron per image was evaluated to be ~  4.5fJ.

To conclude, this is the first demonstration of utilizing the stochastic switching behavior of MTJs in presence of thermal noise as a probabilistic spiking neuron. Although the impact of thermal noise on MTJ switching behavior has limited its scalability in memory applications, such noise effects can be potentially exploited to build probabilistic neural computing platforms that can perform Bayesian computation similar to the brain. Although past research has mainly focused on deterministic neural models, emulation of such neural characteristics require area-expensive CMOS implementations involving more than 20 transistors [\cite=indiveri2003low] [\cite=rajendran2013specifications]. CMOS based stochastic neural models might be possible [\cite=alspector1989performance] but involve significant silicon area and power consumption since they do not offer a direct mapping to the underlying neuroscience mechanisms. However, the noisy switching characteristics of MTJs can efficiently mimic such stochastic neural models and can potentially pave the way for neuromorphic systems that utilize noisy stochastic neurons as a computing element.

Authors P. Panda and P. Wijesinghe contributed equally to this work. The work was supported in part by, Center for Spintronic Materials, Interfaces, and Novel Architectures (C-SPIN), a MARCO and DARPA sponsored StarNet center, by the Semiconductor Research Corporation, the National Science Foundation, Intel Corporation and by the National Security Science and Engineering Faculty Fellowship.