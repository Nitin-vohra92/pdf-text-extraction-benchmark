Modelling the chemistry of star forming filaments

, S. Walch,1 1I. Physikalisches Institut, Universität zu Köln, Zülpicher Str. 77, 50937 Köln, Germany

Introduction

Modelling the chemical evolution of the gas during the process of star formation on various scales is a numerically and theoretically challenging task. On the one hand, it requires to solve a large set of reaction equations with sufficient accuracy, which is computationally extremely demanding. On the other hand in depth knowledge about the necessary reactions and their corresponding rates is required, which involves laboratory work and quantum mechanical calculations.

Nonetheless, the chemical state of the gas and the associated cooling and heating processes are required to properly model the thermodynamical evolution of the gas and to make accurate predictions via synthetic observations. In particular in the latter case it is common to use fixed conversion factors to e.g. obtain the number density of a particular molecular species from the gas density which, however, is a severe oversimplification and might not be accurate enough.

Several authors have incorporated reduced chemical networks in their 3D, magneto-hydrodynamical (MHD) simulations [\citep=Clark13] [\citep=Smith14] [\citep=Walch15]. The newly designed chemistry package KROME [\citep=Grassi14] is a versatile package which allows the user to incorporate chemistry in MHD simulations in a very efficient manner and simultaneously guarantees the freedom to choose any desired network as well as its associated cooling and heating processes. It is therefore a good choice to model the complex chemical evolution of star forming regions.

Recently, the importance of filamentary structure in star forming clouds has been re-emphasized [\citep=Andre10]. These filaments result from the interaction of gravity and turbulence and harbour pre- and protostellar cores [\citep=Gomez14] [\citep=Smith14] [\citep=Kirk15]. Recent observations of both molecular line and dust emission have provided a wealth of information about the properties of these filaments, like e.g. the thermodynamical state, the typical extension, and fragmentation of the filaments. Numerical simulations, however, often lack the detailed description of the chemical state and can therefore be compared only indirectly to the observations. This and the fact that filaments appear to be ubiquitous in the star formation process make them an optimal target to test the feasibility of using a detailed chemical network in fully self-consistent 3D-MHD simulations.

The outline of the paper is as follows: In Section [\ref=sec:IC] we briefly discuss the initial conditions, in Section [\ref=sec:chem] we describe the employed chemical network and heating and cooling processes. In Section [\ref=sec:results] we first describe the time evolution of a fiducial run before we study the impact of the radiation field on the chemical and thermal evolution of the filaments. In Section [\ref=sec:dis] we compare with observations and give details about the computational cost before we summarize our results.

Initial conditions and FLASH solver

The simulations presented here use the same initial conditions and numerical methods - except the chemistry and cooling/heating processes - as those presented in [\citet=Seifried15]. Here we briefly summarize the main points. The simulations are performed with the astrophysical code FLASH 4.2.2 [\citep=Dubey08]. We solve the equations of ideal MHD using a maximum resolution of 40.3 AU. The Poisson equation for gravity is solved using a multipole method based on a Barnes-Hut tree [\citep=Wunsch15].

The simulated filaments have an initial width of about 0.1 pc following a Plummer-like density profile along the radial direction. The filaments have a length of 1.6 pc and a mass per unit length of 75 M[formula]/pc. This corresponds to about three times the critical mass per unit length [\citep=Ostriker64] of

[formula]

which is why the filaments are unstable against collapse along the radial direction and subject to subsequent fragmentation. The initial central density of the filaments is [formula] g cm- 3.

Recent observations have shown that filaments have magnetic fields which can be directed either along or perpendicular to the filament [\citep=Sugitani11] [\citep=Li13] [\citep=Palmeirim13], which is why we test both magnetic field orientations. We take the initial magnetic field strength in the centre of the filament to be 40 μG, in agreement with recent observations [\citep=Sugitani11]. The field is uniform in strength for the perpendicular case and declines outwards in the parallel case proportional to ρ0.5. In addition, we superimpose a transonic turbulent velocity field [\citep=Seifried15].

The strength of the interstellar radiation field (ISRF) and the cosmic ray ionisation rate (CRIR) influence the reaction rates as well as the heating of dust, which is taken into account by the chemistry package (see Online Material). Since, however, the strength of the ISRF and the CRIR can vary locally in our Galaxy, we perform simulations with different values. In our fiducial run we apply a CRIR of 1.3  ×  10- 17 s- 1 [\citep=Vastel06] and an ISRF corresponding to 1.7 times the Habing flux [\citep=Draine78]. Since for the CRIR also significantly higher values are found [\citep=Caselli98] [\citep=Ceccarelli11], we perform a second pair (perpendicular and parallel magnetic fields) of simulations with a CRIR of 1  ×  10- 16 s- 1 and G0 = 1.7. In the third set of simulations we additionally increase the ISRF by a factor of 5, i.e. G0 = 8.5. Hence, in total we have a set of six simulations with different (initial) conditions.

The chemical network

In order to model the chemical evolution of the gas, we use the KROME package [\citep=Grassi14], which in principle allows to model any desired chemical network. The network used contains 37 species and 287 reactions including different forms of hydrogen and carbon bearing species like H+, H, H2, C+, C, and CO but also more complex species like e.g. HCO+, H2O, or the cosmic ray tracer H+3. In particular, the network allows for a very detailed description of the formation of CO and H2 (also including the formation of H2 on dust). We assume that all elements heavier than He are depleted with respect to their cosmic abundances using values given by [\citet=Flower05] typical for dense molecular gas. Initially all elements are in their atomic form. More details about the used species, reactions, and initial abundances are provided in the Online Material.

The strength of the ISRF and the CRIR are needed to model the chemical evolution as well as the heating and cooling processes properly. In particular, the ISRF experiences an attenuation when travelling through the gas. We calculate the attenuation in the FLASH code with the TreeCol algorithm [\citep=Clark12] [\citep=Wunsch15]. For each cell in the computational domain we compute the total (H + H2), H2, and the CO column densities in 48 directions. We take the geometrical average and obtain the mean column densities, N[formula], N[formula], and N[formula], as well as the visual extinction, AV, and the self-shielding factors for H2 and CO formation [\citep=Glover10]. The attenuation of the ISRF also affects the photoelectric (PE) heating due to dust particles, which is taken into account by scaling the strength of the ISRF with G0 ×   exp(-2.5 AV).

The cooling rate due to line emission of CO is provided by K. Omukai in tabulated form based on the results of [\citet=Neufeld93] and [\citet=Omukai10]. The actual rate in each cell depends on N[formula] and the local gas density and gas temperature, [formula] . We also use these tabulated rates to calculate the cooling due to 13CO and C18O by downscaling N[formula] and the according cooling rates by 69 and 557, respectively [\citep=Wilson99].

Finally, for calculating the dust temperature, [formula], we take into account the transfer of energy from gas to grains via collisions, which also affects [formula] itself, heating of the grains due to the ISRF, and cooling of dust grains via black-body radiation. In each timestep, we calculate the equilibrium dust temperature for all three processes after the chemistry update is done. We emphasize that a more detailed description of all cooling and heating processes used and their coupling to the ISRF and the CRIR is provided in the Online Material.

Results

Time evolution of a fiducial run

Before we start the different simulations, we evolve the chemistry in each cell for 500 kyr, during which the hydrodynamical evolution is turned off, i.e. only [formula], [formula], and the chemical composition are updated. Since at densities of about 105 cm- 3 the typical timescale for H2 formation on dust grains is of the order of a few 100 kyr, 500 kyr are sufficient to reach a rough chemical equilibrium. After this initial relaxation phase, each simulation is followed for 300 kyr.

In the following, we present the time evolution of the run with a parallel magnetic field, G0 = 1.7, and a CRIR of 1.3 ×   10- 17 s- 1. In Fig. [\ref=fig:species] we plot the spatial distribution of H, H2, C, and CO at the end of the simulation, which reveals some differences in the radial distribution. Whereas H2 and CO are concentrated towards the centre of the filament, H and C are more extended. Moreover, there is a clear impact of the initial turbulence field on the distribution of the chemical species, causing strong local variations.

The radial density profiles of H2, H, H+, CO, C, and C+ at 4 different times are shown in Fig. [\ref=fig:time]. In order to smooth out local fluctuations, we have averaged the densities along the major axis of the filament. The constant increase of the central number densities of H, H2, C, and CO over time is caused by the contraction of the filament along the radial direction. On the other hand, [formula] and [formula] remain almost unchanged over time as they recombine when the filament becomes denser. In the upper left panel we also show the number density of all H atoms (divided by two in order to be comparable to [formula]), which represents the shape of the mass density profile. In the centre of the filament most of the hydrogen is bound in H2, only outside ~   0.1 pc, where the black and purple line start to differ, hydrogen mainly occurs in atomic or ionised form. Hence, there is a gradual conversion of H+ over H to H2 towards the centre of the filament as well as of C+ over C to CO, with [formula] exceeding [formula] at ~   0.1 pc as well. This agrees with the picture obtained from Fig. [\ref=fig:species] that H and C envelop H2 and CO. We note that a similar result was also found by [\citet=Clark13].

Impact of the ISRF and the CRIR

Next, we study the influence of the ISRF and CRIR on the properties of the filaments. In Fig. [\ref=fig:radial] we plot the radial dependence of H2, H, and H+ (top row), as well as of CO, C, and C+ (middle row) and of [formula] and [formula], (bottom row) at the end of each of the six simulations. On the left we show the runs with a perpendicular magnetic field, on the right runs with a parallel magnetic field.

Increasing the CRIR naturally results in a higher ionisation fraction of gas. This is reflected by the abundances of H+ and C+, which are 1 - 2 orders of magnitude higher in runs with CRIR = 1  ×  10- 16 s- 1. Also [formula] shows a slight increase with increasing CRIR, which is due to the larger amount of energy released by various dissociation reactions caused by cosmic rays.

Increasing the strength of the ISRF only marginally affects the chemical composition of the gas. However, [formula] and [formula] are increased by a few Kelvin, which is most likely due to the increased PE heating. Interestingly, we find that for all runs [formula] decreases towards the centre of the filaments. We attribute this to the progressive attenuation of the ISRF - mainly responsible for dust heating - towards the centre of the filament [\citep=Clark13]. The gas temperature [formula], however, is very different from [formula] partly even revealing an increase towards the centre. Moreover, as already seen in Fig. [\ref=fig:time], we find a gradual conversion of H+ over H to H2, and C+ over C to CO towards centre of the filaments for all runs.

As shown in [\citet=Seifried15] the magnetic field has a strong impact on the dynamical evolution of the filament, which is also reflected in the chemical composition. Considering the relative abundances of C+ and H+ with respect to [formula] (not shown here), it can be seen that in the very centre they are somewhat lower for runs with a perpendicular field, which we attribute to the higher central densities in these cases and thus higher recombination rates, whereas at somewhat larger radii of ~   0.1 pc they are somewhat enhanced. The latter we attribute to that fact that in the case of a perpendicular field more gas has fallen inwards and fewer gas remains in the outer parts. This in turn allows the ionising radiation to penetrate more deeply, thereby dissociating CO and ionising C and H.

Discussion and conclusions

Physical interpretation

As shown in Fig. [\ref=fig:radial], [formula] decreases towards the centre of the filament in all runs, which was recently also found in observations [\citep=Arzoumanian11] [\citep=Palmeirim13] [\citep=Li14]. From the averaged quantities (Figs. [\ref=fig:time] and [\ref=fig:radial]) we can now obtain the polytropic index γ of the dust by assuming a polytropic relation [formula]. By visual inspection of the [formula] vs. ρ plots (see Online Material) at different times and runs, we find γ to be in a range from 0.9 to 0.95, which is in good agreement with [\citet=Palmeirim13]. We again emphasize that [formula] and [formula] are markedly different, which requires independent measurements for both quantities in observations. We attribute this to the fact that the collisional coupling between gas and dust at n  ~  105  -  106 cm- 3 is not yet strong enough to assure similar temperatures.

By inspecting Fig. [\ref=fig:radial] it can also be seen that the ratio [formula] is not constant along the radial direction. There is a strong decline of R with increasing radius of about 2 orders of magnitude, which is due to the fact that the formation of CO happens at somewhat smaller radii (i.e. higher gas column densities) than that of H2. This variation in R most likely also affects the value of the X-factor, which is used to convert CO luminosities into H2 column densities. Our work therefore suggests that caution is recommended when using CO line intensities to obtain total gas masses. Furthermore, varying CRIR and ISRF mainly affects R at radii larger than 0.05 pc. In the centre of the filament, however, R is comparable for all our runs with a value around 1.5  ×  10- 4, and thus in good agreement with observations [\citep=Tielens13] despite our simplified depletion description. We note that the variation of R over time is rather small, independent of the considered run.

Finally, we emphasise that also abundances of other species like H+3, H2O, OH, or CH included in the network seem to be in reasonable agreement with observations [\citep=Tielens13]. This is a significant step forward compared to smaller chemical networks used in previous works [\citep=Clark13] [\citep=Smith14] [\citep=Walch15]. We postpone a more in-depth discussion of these species to a subsequent paper.

Numerical cost/Performance

The simulations were carried out on computing nodes with 2 - 5 GB memory per CPU, which corresponds to state-of-the-art computing nodes at modern supercomputing facilities (see Acknowledgements for which facilities were used). In order to estimate the increase of computational power required, we compare our runs with an isothermal (T = 15 K) simulation without a chemical network, which is also evolved for 300 kyr. The slightly different thermodynamical evolution of the filaments in runs with and without the network results in slightly different timesteps as well as different numbers of cells in the simulation domain, which cannot be avoided. However, these differences affect the cost estimates only marginally. Overall, we find that the inclusion of the network (including heating and cooling processes) increases the computation costs per timestep by roughly a factor of 7. However, tabulating the reaction rate coefficients, which avoids the repeated evaluation of the exponential function, reduces the cost increase to about a factor of 5.

Altogether we argue that - considering the ever increasing computing power, the higher accuracy as well as the significant gain of additional physical and chemical information - it seems feasible and necessary for the future to perform simulations with large chemical networks.

Conclusions and outlook

We present first results of simulations of star forming filaments using - to our knowledge - the largest chemical network ever applied in 3D-MHD simulations. For this we combine the versatile chemistry package KROME [\citep=Grassi14] with the TreeCol algorithm [\citep=Clark12] [\citep=Wunsch15], which allows us to self-consistently calculate the optical depth and shielding parameters in the simulation domain, which in turn is required to properly determine dissociation and photoionization reactions. The network contains 37 species and 287 thoroughly selected reactions. We show that in terms of memory consumption such simulations are feasible on modern supercomputers. Despite an increase of computation costs by a factor of ~   5 - 7, we argue that the significant gain of physical and chemical information justifies the usage of large chemical networks in future simulations.

Concerning the chemical composition as well as the thermodynamical behaviour of the simulated filaments, the results appear to be promising and in good agreement with observational results. In particular, we show that there is a gradual conversion of H+ over H to H2 as well as of C+ over C to CO towards the centre of the filaments. Moreover, we find that the dust temperature [formula] decreases towards the centre of the filament following a polytropic relation [formula] with γ≃0.9  -  0.95 in agreement with recent observations [\citep=Arzoumanian11] [\citep=Palmeirim13] [\citep=Li14]. Furthermore, we show that the dust and gas temperature can be markedly different even at densities of n  ~  105  -  106 cm- 3.

This work paves the way for many future applications: The detailed chemical modelling will allow us to produce synthetic observations of several molecular lines as well as of continuum emission. Filament widths obtained from these synthetic observations allow us to study how well a projected (2D-) width matches the actual (3D-) width of the filament obtained directly from the simulation data. Furthermore, the simulations can improve our understanding of the X-factor required for the mass determination of gaseous objects. Moreover, the network will allow us to study the evolution of other molecules like H2O or the cosmic ray tracer H+3 in detail, which, due to space limitations, we could not discuss here. We also note that we plan to include even more complex chemical networks. In particular, the inclusion of nitrogen, a constituent of a number of important observational tracers, is of large interest. Finally, we plan to improve our treatment of CO freeze-out in order to get a better handle on the X-factor.

Acknowledgements

The authors thank T. Grassi and S. Bovino for the development of the KROME chemistry package and the useful discussions, as well as S. Glover for discussions on the implementation of a dust cooling routine. The authors acknowledge funding by the Bonn-Cologne Graduate School as well as the Deutsche Forschungsgemeinschaft (DFG) via the Sonderforschungsbereich SFB 956 Conditions and Impact of Star Formation and the Schwerpunktprogramm SPP 1573 Physics of the ISM. The simulations were performed on JUROPA and JURECA at the Computing Center Jülich. The FLASH code was developed partly by the DOE-supported Alliances Center for Astrophysical Thermonuclear Flashes (ASC) at the University of Chicago.