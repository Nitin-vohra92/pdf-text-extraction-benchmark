The TileCal Energy Reconstruction for LHC Run2 and Future Perspectives

Introduction

The Tile Calorimeter (TileCal) [\cite=tile] is the central hadronic section of the ATLAS calorimeter and it covers the pseudo-rapidity (η) region laying at |η|  <  1.6 [\cite=atlas]. It consists of approximately 5000 cells each one readout by two channels. Radially, it is divided into 3 main layers, A, BC (B for the extended barrel) and D (see Figure [\ref=fig:seg]). Four special cells are located in the gap/crack region (E cells). The front-end electronics [\cite=3in1] shapes and amplifies the analog signals (two outputs with gain ratio of 1:64), providing a fixed and stable 150 ns pulse shape (see Figure [\ref=fig:pulse]). The pulse is sampled at 40 MHz and a readout window of 7 samples is available for digital processing for each channel. The signal arrival time and signal amplitude (energy) released in the channel are estimated online by a fast Optimal Filter (OF) technique [\cite=of_orig].

The increase of the LHC luminosity will lead to higher occupancy in the ATLAS calorimeter system. Since the TileCal signal width and the readout window are larger than the LHC nominal event rate (25 ns), the cell signals may be generated by particles originated by interactions from subsequent proton-proton bunch-crossings. This process results in the observation of both in-time and out-of-time (OOT) signals within the same readout window. This effect is especially expected in cells from A and E layers of TileCal, which are more exposed and closer to the beam. Under pile-up conditions, the signal of interest located in the central bunch crossing is deformed (see Figure [\ref=fig:pileup]). As a result, the standard OF method becomes biased, since it assumes only the central bunch crossing signal corrupted with the usual electronic noise (WGN - White Gaussian Noise).

This work evaluates the use of the background covariance matrix in the design of the OF technique operating under pile-up conditions, and it introduces a discussion regarding future perspectives.

Next section introduces the OF method in details as well as an investigation of the computation of the background covariance matrix. Section [\ref=sec:results] shows the results using full ATLAS simulation Monte Carlo MinBias events. Section [\ref=sec:cof] introduces a new method to deal with the signal pile-up that has been studied. Finally, the conclusions are outlined in Section [\ref=sec:conclusions].

TileCal Optimal Filter method

In TileCal, the digitized ADC samples yi can be expressed as [\cite=OFtile]:

[formula]

where ped is the signal pedestal, A is the true amplitude, g(t) is the normalized reference pulse shape at time t (output from shaper), τ corresponds to the phase between the expected and measured times, and ni is the background noise.

The online amplitude estimation needs to be simple and fast to meet Level-1 timing constraints [\cite=trigger]. The baseline method used in both hadronic [\cite=OFtile] and electromagnetic [\cite=OF] calorimeters in ATLAS is based on a weighted sum of the digitized samples, aiming at minimizing the variance in the estimation of the signal amplitude. In this approach, the estimate of the amplitude is given by:

[formula]

where yi are the digitized samples, N is the number of samples available and the vector wi corresponds to the OF weights, which are computed offline.

The variance of the amplitude parameter to be minimized is given by:

[formula]

where   =  {w1,w2,...,wN} and C corresponds to the background covariance matrix.

The OF implementation that operated during Run1 in TileCal for both online and offline is called OF2, and it performs the optimization procedure subjected to the following constraints:

[formula]

[formula]

[formula]

where the vectors gi and g'i are the TileCal reference pulse shape and its derivative, respectively. The first constraint (Equation [\ref=eq:of3]) regards unbiased estimations, while the additional second and third constraints (Equations [\ref=eq:of4] and [\ref=eq:of5]) are added to make the estimation procedure immune against phase and baseline fluctuations, respectively.

The weights wi can be found by solving the following matrix system:

[formula]

where λ,ξ,v are the Lagrange multipliers.

If the noise can be modeled as an uncorrelated Gaussian process, the covariance matrix C can be written as an identity matrix. This approximation holds if the pile-up noise is negligible.

If the third constraint (Equation [\ref=eq:of5]) is removed from the optimization procedure, we call this method OF1. The difference is that OF2 computes the baseline value on an event-by-event basis, while OF1 relies on the stability of the baseline, and it subtracts a fixed value from each ADC sample

[formula]

The constant value ped is computed through special runs and stored in a data base.

In the case where the effect of signal pile-up is not present, the background comprises mainly the electronic noise, which is often described by a White Gaussian process [\cite=peebles]. Under these conditions, the OF technique (both OF1 and OF2) operates on its optimal performance. However, the signal pile-up introduces another contribution to the background, which becomes non-Gaussian under such conditions. As a result, the OF becomes no longer optimal.

The correct treatment of the pile-up as background would require a non-linear modeling, which is impracticable for LHC Run2 due to hardware limitations. However, the background covariance matrix can be used in the OF design in order to reduce the uncertainties and bias due to the pile-up, improving the energy estimation performance of the OF method.

The occupancy of most of the TileCal cells is low, and the pile-up signal can be treated as outlier for the majority of the cells. Additionally, since the covariance matrix is very sensitive to outliers, alternative ways of computing this quantity must be considered.

The classical covariance matrix estimation [\cite=peebles] takes into account the whole dataset as follows:

[formula]

where x̄ and k̄ are the mean values of the random variables x and k, respectively, evaluated at instant i and j. M is the total number of events in the given dataset. The outliers result in a larger variance which in turn lead to biases in the computation of the OF weights.

Alternatively, the Minimum Covariance Determinant Estimator (MCDE) [\cite=mcde] algorithm randomly takes a subset of the background events and computes its classical covariance matrix (through Equation [\ref=eq:covariance]) and its determinant. The algorithm repeats this procedure 500 times (default) and it selects the subset that resulted in the lowest determinant. This subset contains the events that has the lowest covariance between the samples (ADC digits) and therefore it consists of the most probable events, disgarding most of the outliers (high energy pile-up in this case).

Simulation Results

The performance evaluation will be carried out using full ATLAS Minimum Bias (MB) simulation [\cite=simu]. Both OF1 and OF2 algorithms are applied to this data sample to estimate the signal reconstruction performance. Since the MB events contain only background (electronic plus pile-up), the mean and the dispersion of the energy distribution can be used to quantify the bias and the estimation error, respectively. Also, since the OF method is a linear approach, this estimation error and bias are the same for any energy range.

Figure [\ref=fig:histE4final] shows the reconstructed energy from the MB events for a high occupancy cell, namely the E4. It can be noted that the use of the covariance matrix improves considerably the energy resolution. The OF1 with covariance matrix shows a sharp negative and positive tails, whereas OF2 presents a large dispersion in both negative and positive tails. It can also be seen that the use of the identity matrix in the OF1 design leads to a large positive bias for such high occupancy cells in TileCal.

The improvement, in percentage, in the estimation error (RMS of the distribution) that is introduced in the OF1 estimation by using the correct covariance matrix (computed through MCDE) with respect to the identity matrix is quantified by

[formula]

where RI stands for Resolution Improvement. Figure [\ref=fig:OF1vsOF1] shows the RI in all cells in the central and extended barrels for φ = 4.2 rad. As expected, the A and E cells in the extended barrels present the largest improvements due to their higher occupancy.

The use of the pedestal value, retrieved form a data base, does not introduce bias to the final estimate for all cells as the mean of the distributions are smaller than 1 ADC count (1 ADC counts corresponds to approximately 12 MeV for a high gain channel). The cells located in the BC and D layers presented similar mean and RMS values, for both OF1 with covariance and identity matrices due to their low occupancy. The OF2 shows improvements by using the covariance matrix with respect to identity matrix only for the E3 and E4 cells.

Future perspectives

The OF1 method incorporates the signal pile-up through the use of the background covariance matrix. Although the background becomes non-gaussian under pile-up conditions and the OF design remains luminosity-dependent, such approach still presents good performance and implementation simplicity. For the case of high pile-up conditions (cell occupancy greater than 10%, for instance), an alternative technique has been developed. The Constrained Optimal Filter (COF) is a method based on signal deconvolution that recovers the energies from all signals within the readout window.

The COF is a two-step algorithm. Firstly, it detects the presence of OOT signals by estimating the amplitude of the signals within the readout window. The estimation is performed by the following equation:

[formula]

where [formula] is a 7  ×  7 matrix where each row corresponds to a shifted version of the reference pulse shape. It should be stressed that the amplitude estimation is independent from the luminosity. The decision is based on a simple threshold, which is defined according to the cell noise energy (see Figure [\ref=fig:pileupdet]). Secondly, it designs an optimal filter where the constraints are set to estimate the amplitude of only the detected signals.

In order to show the performance of the COF method, Figure [\ref=fig:eneHist] shows the distributions of the cell energy reconstructed by the OF2 and COF methods using p-p collision data with 25 ns of bunch spacing (dT) and maximum average number of interactions per crossing (<  μ  >  ) of 11.3. Under these conditions, the energy reconstructed by COF is resilient to OOT signals. It can be seen that OF2 presents a large negative tail (bias) due to the presence of OOT signals located at the ±  75 and ±  50 ns. Since for COF the OOT signals within the readout window do not spoil the estimation of the signal of interest, it presents better performance (smaller dispersion) under pile-up conditions than OF2.

Conclusions

We presented a study on using a covariance matrix computation for absorbing the pileup noise and thus improving energy reconstruction in the TileCal. The results show that the OF1 method taking the pedestal value from the data base and using such covariance matrix is the most suitable method for online energy reconstruction in TileCal for LHC Run2. The pedestal value is computed through special pedestal runs, and both the covariance matrix and the OF weights are computed offline, and loaded into the digital signal processor available in the Readout Driver for online energy estimation.

For high-luminostiy conditions, where the signal pile-up is present, an alternative method (COF) based on signal deconvolution is being tested within TileCal, showing promising results.