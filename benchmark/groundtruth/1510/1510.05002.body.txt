Nonasymptotic Homogenization of Periodic Electromagnetic Structures: Uncertainty Principles

Introduction

Overview

Over the last 15-20 years, artificial magnetism of periodic dielectric or metal/dielectric structures ("metamaterials" and photonic crystals) has attracted much attention and is often tacitly assumed to have no principal limitations, especially in the ideal case of negligible losses. In this paper, however, we argue that such limitations do exist. Namely, the stronger the magnetic response (as measured by the deviation of the optimal effective permeability tensor from identity), the less accurate ("certain") predictions of any homogeneous model of the material are. We call this an uncertainty principle (UP) for the effective parameters of metamaterials. It should be emphasized that this principle constitutes a general limitation and is not confined to any particular method of homogenization.

We also introduce another uncertainty principle: if the magnetic response of a periodic structure is strong, then homogenization cannot accurately reproduce the TR (transmission and reflection) parameters and, simultaneously, power dissipation (the heating rate) in the material. This ultimately follows from the fact that the TR coefficients are governed by the boundary values of Bloch waves in the material, while power is related to the volume average of a quadratic function of that wave. The premise of our analysis is that the objective of homogenization is to predict, as accurately as possible, transmission and reflection of waves by a periodic electromagnetic structure - for simplicity, a slab (this eliminates complications due to edges and corners). We also consider a homogeneous slab of the same thickness and with a material tensor M such that the TR coefficients for the original and homogeneous slabs agree to a given level of tolerance over a sufficiently broad range of illumination conditions.

Our analysis is general and does not depend on a particular homogenization theory and on the way the effective tensor M is determined. We consider periodic electromagnetic structures in the framework of classical electrodynamics. This does include plasmonic metamaterials with feature sizes above ~  10-20 nm, when classical (frequency-dependent) permittivity ε(ω) is still applicable. However, the field of metamaterials is currently so broad[\cite=Sihvola07] that our theory may not be directly applicable to some types (superconducting materials, magnonic materials [\cite=Mikhaylovskiy10] [\cite=Zivieri12], etc.).

We argue that for TR to be rendered accurately, not only the dispersion relation in the bulk, but also the boundary conditions on the surface of the slab must be approximated well. It then follows that the amplitudes of the Bloch waves within the material are dictated by an accurate boundary match with the incident and reflected waves. Loosely speaking, this boundary match fixes the wave impedance, while the Bloch number fixes the dispersion relation. Both pieces of information are necessary to define the effective material tensor unambiguously.

A critical question then is whether the resulting tensor is (or could be) independent of the angle of incidence. Clearly, angular-dependent material parameters do not have their traditional meaning, and their practical utility is limited.

An illumination-independent tensor certainly exists in the classical homogenization limit, when the ratio of the lattice cell size a to the vacuum wavelength λ approaches zero [\cite=Bakhvalov-Panasenko89] [\cite=Bensoussan78] [\cite=Milton02]. However, magnetic effects vanish in that limit [\cite=Bossavit05] [\cite=Tsukerman08], and therefore this case is not of primary interest to us here. In the remainder, we shall assume a non-asymptotic regime, where a and λ are of the same order of magnitude ([formula]). Then, in general, there is an appreciable surface wave whose behavior is quite involved. In his previous work [\cite=Markel-Schotland12], one of the co-authors showed that surface waves have zero averages of the tangential field components on the interface boundary. Therefore they do not affect coarse-scale boundary conditions and homogenization, although they of course do contribute to the near-field behavior.

Remark 1. If lattice periods along the interface are greater than the vacuum wavelength, then surface waves are propagating rather than evanescent. We exclude this case from consideration.

Surface waves propagating along interfaces can carry energy and, for a sample finite in all directions, can be reflected off its edges and scattered off its corners. This cannot be addressed in the simplified setup adopted in this paper: a slab with a finite thickness but infinite in the remaining two directions. However, since surface waves do not generally exist in homogeneous media (expect for special circumstances such as total internal reflection or surface plasmons at interfaces where Re ε changes its sign), it is clear that the presence of such waves in periodic structures and reflection of these waves from the edges can only be detrimental to homogenization and cannot weaken the uncertainty principles presented here. Thus, to fix key ideas, we disregard surface waves. The interested reader may find further information in Refs. [\cite=Markel-Schotland12] [\cite=Xiong13] [\cite=Xiong15], although research on this subject is still far from being complete.

There is ample evidence in the existing literature that effective parameters of metamaterials may have limited accuracy and validity. As an instructive example[\cite=Simovski-review09], the celebrated negative-index metamaterial due to Smith et al. [\cite=Smith00] cannot be homogenized for a range of wavelengths in the vicinity of the second Γ-point, even though these wavelengths are relatively long (a  /  λ  ~  0.1). Another notable example is the work of the Jena and Lyngby groups [\cite=Menzel10], who show that high symmetry of a metamaterial cell does not imply optical isotropy, especially in frequency ranges where the effective index is negative.

In our previous publications [\cite=Markel-Tsukerman-PRB2013] [\cite=Tsukerman-Markel14], we brought to the fore an interplay between magnetic response, the accuracy of homogenization and the range of illumination conditions. Here we extend this line of reasoning and show that not only negative index, but a strong magnetic response must unfortunately be accompanied by lower accuracy of effective parameters, unless illumination conditions are restricted to a narrow range.

Local vs. Nonlocal Parameters

This paper deals exclusively with local effective material parameters. Because of extensive discussions of nonlocality (or "spatial dispersion") in the literature on metamaterials, it might be tempting to draw a connection between the uncertainty principles of this paper and nonlocality; hence brief comments on the latter are called for.

In classical electromagnetism, a local linear material relationship (say, between the [formula] and [formula] fields and with magnetoelectric coupling ignored for the sake of brevity) has the form [formula] - that is, one field at any given point is related to another field at that same point. In contrast, a classical nonlocal relationship is usually written as

[formula]

where E is a convolution kernel and [formula] is the region occupied by the material in question.

However, even if the nonlocal relation ([\ref=eqn:D-eq-Eps-star-E]) could be rigorously established in the bulk, it would require special treatment at interfaces due to the lack of translational invariance. We are not aware of any theory that would rigorously define the kernel [formula] as a function of two position vectors near the metamaterial/air interface. Moreover, it is not clear how such a kernel could be put to practical use, as all metamaterial devices proposed so far depend critically on a local description of the effective medium.

If, for the argument's sake, one were to accept the view that weak spatial dispersion is equivalent to local parameters (ε,μ) (even though we have argued against this view[\cite=Markel-Tsukerman-PRB2013]), then our requirement that parameters be local would still be justified.

In the remainder of the paper, we lay out theoretical arguments supporting the two uncertainty principles summarized above and present an instructive example: a triangular lattice of cylindrical air holes in a dielectric host, as investigated previously by Pei & Huang [\cite=Pei12]. This example is interesting because, despite a high level of isotropy around the Γ-point in the second photonic band, which may be thought as conducive to homogenization, the uncertainty principles remain valid.

Formulation of the problem

The formulation of the homogenization problem was given in Ref. [\cite=Tsukerman-Markel14]. For completeness, we include it here in a shortened form, omitting some technical details not critical for the analysis in this paper.

We consider homogenization of periodic composites characterized by the intrinsic permittivity and permeability [formula] and [formula]. The effective parameters will be denoted with ε and μ (without the tilde). The composite constituents are assumed to be linear, local and intrinsically nonmagnetic so that [formula] everywhere in space. Also, we assume that [formula] is a scalar (a multiple of the identity tensor). In contrast, the effective parameters ε and μ can be different from unity and are, generally, second-rank tensors.

The tilde sign is used for all lattice-periodic quantities. For example, Bloch-periodic functions (Bloch waves) are written in the form where [formula] is the Bloch wave vector. Here symbol [formula] is used to distinguish the Bloch wave vector of a given medium from a generic wave vector [formula]. In the case of orthorhombic lattices, periodicity is expressed as

[formula]

where ax,y,z are the lattice periods and nx,y,z are arbitrary integers. Of course, [\eqref=periodicity] is assumed to hold only if both points [formula] and [formula] are simultaneously located either inside the composite or in a vacuum.

Fine-level fields - that is, the exact solutions to the macroscopic Maxwell's equations - are denoted with small letters [formula], [formula], [formula] and [formula]. Capital letters [formula], [formula], [formula], [formula] are used for coarse-level fields that would exist in an equivalent effective medium, still to be defined. The constitutive relations for the fine-level fields are Note that [formula] because the medium is assumed to be intrinsically nonmagnetic.

Our analysis is in the frequency domain with the exp ( - iωt) phasor convention. At a working frequency ω, the free-space wave number k and wavelength λ are

We compare transmission and reflection of electromagnetic waves through/from (separately) two slabs of a thickness d each, for simplicity infinite in the longitudinal direction (half-space can be viewed as a valid particular case d  →    ∞  ). One of these slabs is composed of a given metamaterial (i.e. has a periodic structure), while the other one contains a homogeneous medium with a yet unknown material tensor M. To any (monochromatic) plane wave incident on the surface z  =  0 of either slab at an angle [formula], there correspond transmission (T) and reflection (R) coefficients [formula], [formula]; [formula], [formula], where subscripts 'MM' and 'hmg' indicate the metamaterial and homogeneous cases, respectively. Under the condition of Remark 1, reflection and transmission coefficients for the metamaterial slab are well defined.

The difference between the reflection and transmission coefficients produced by the two slabs will be referred to as the TR-discrepancy δTR:

[formula]

[formula]

where [formula] is a desired norm - say, the L2-norm over a given range of illumination conditions, e.g. [formula] if all propagating waves but no evanescent ones are considered. Our analysis below applies to any homogenization theory that produces a tensor M approximately minimizing the TR-discrepancy δTR.

First Uncertainty Principle: Magnetic Response vs Accuracy of Homogenization

As noted in the Introduction, magnetic characteristics of metamaterials become trivial in the zero-cell-size limit [\cite=Sjoberg05-149] [\cite=Bossavit05] [\cite=Tsukerman08] (assuming that the intrinsic material parameters remain bounded). Thus a strong magnetic response can only be achieved if the cell size forms an appreciable fraction of the vacuum wavelength. It is the objective of this section to show that stronger effective magnetic properties are unavoidably accompanied by lower approximation accuracy of the metamaterial by a homogeneous medium with local parameters. We call this an "uncertainty principle" (UP) of local homogenization.

Although parts of our analysis are similar to those of Ref. [\cite=Tsukerman-Markel14], we do not assume that the M tensor has been determined using necessarily the procedure of Ref. [\cite=Tsukerman-Markel14]. Rather, let M be found using any method (say, parameter retrieval as the most common example).

To avoid unnecessary mathematical complications and to keep our focus on the physical essence of the problem, we present our analysis of the UP for the s-mode (the [formula] field in the z direction, the [formula] field in the xy-plane), with a plane wave impinging in the xy-plane on a half-space filled with a metamaterial, i.e. a dielectric structure characterized by a permittivity [formula] periodic in the x and y directions with the same (for simplicity) lattice constant a.

We introduce normal n and tangential τ coordinates relative to the material/air interface S; n points from the air (on the side of the incident wave) into the metamaterial.

A Bloch wave with a wavevector [formula] is

[formula]

where subscript 'B' indicates a Bloch wave-related quantity. The tangential component of the respective [formula]-field is

[formula]

(only the tangential component is used in the analysis, and therefore subscript 'τ' is dropped for brevity of notation). The periodic factor for the magnetic field is

[formula]

We now compare wave propagation from the air into a half-space filled with

(i) a metamaterial, and

(ii) a homogeneous medium, with its material tensor yet to be determined to minimize the TR-discrepancy.

In both cases (i) and (ii), the field in the air is given by

[formula]

[formula]

where the tangential component is again implied for [formula].

It will be convenient to assume that the reflection coefficient R is exactly the same in cases (i) and (ii). Strictly speaking, there can be (and in practice will be) some approximation tolerance; however, introducing this tolerance explicitly would obscure the analysis while adding little to its physical substance.

As already stated, in the case of a metamaterial we ignore the surface wave. Then the field in the metamaterial is just the Bloch wave ([\ref=eqn:e-Bloch-wave]), ([\ref=eqn:h-Bloch-wave]). This should be compared with the transmitted wave in the homogeneous half-space:

[formula]

[formula]

Phase matching between ([\ref=eqn:eT-homog]) and ([\ref=eqn:e-Bloch-wave]) implies that for best approximation one must have

[formula]

Further, due to the boundary conditions at the material/air interface, the amplitudes of the transmitted wave in the equivalent homogenized medium must be

[formula]

[formula]

where 〈,  ·  ,〉S denotes the air/cell boundary average. Indeed, if, say, condition ([\ref=eqn:ET0-eq-avrg-EB]) were to be violated, then in the homogenized case there would be a spurious jump of the E-field across the air/material interface, with the nonzero mean

[formula]

(assuming that the interface boundary is at n  =  0). This jump will result in a commensurate far-field error.

Remark. We require that boundary conditions hold in the sense of averages ([\ref=eqn:ET0-eq-avrg-EB]), ([\ref=eqn:HT0-eq-avrg-EB]) rather than point-wise because zero-mean discrepancies between a Bloch wave and a plane wave at the boundary are unavoidable. Indeed, the Bloch wave in an inhomogeneous medium has higher-order spatial harmonics that cannot be matched by a plane wave. Conditions ([\ref=eqn:ET0-eq-avrg-EB]), ([\ref=eqn:HT0-eq-avrg-EB]) ensure that the discrepancy between the Bloch field on the material side and plane waves on the air side affect only the near field, as long as a  <  λ.

Now that the field amplitudes in the homogenized material have been determined, we can find the material tensor for which the dispersion relation (in essence, Maxwell's equations) will be satisfied. We'll be primarily interested in the case of four-fold (C4 group) symmetry, which is particularly instructive. (In a more general situation, the effective tensor needs to be defined via ensemble averages, as was done in our previous paper [\cite=Tsukerman-Markel14].) For C4 cells, the material tensor is diagonal (in particular, there is no magnetoelectric coupling) and, moreover, μττ  =  μnn. In the remainder, we shall focus on the μττ entry of the tensor.

Maxwell's [formula]-equation for the generalized plane wave ([\ref=eqn:eT-homog]), ([\ref=eqn:hT-homog]) gives the amplitude of the tangential component of the [formula]-field in this wave:

[formula]

or, substituting [formula] from ([\ref=eqn:k-eq-q]) and ET0 from ([\ref=eqn:ET0-eq-avrg-EB]),

[formula]

This, along with Eq. ([\ref=eqn:HT0-eq-avrg-EB]) for the amplitude of HT, leads to the following expression for the effective magnetic permeability:

[formula]

where we inserted expression ([\ref=eqn:tilde-h-via-e]) for h̃B. Switching for algebraic convenience from permeability to reluctivity, we arrive at the following surprisingly simple expression:

[formula]

where θB is the propagation angle for the Bloch wave. It is instructive to split ẽB in ([\ref=eqn:zeta-tau-via-etilde-dn]) into its mean value e0 and zero-mean [formula],

[formula]

Then ([\ref=eqn:zeta-tau-via-etilde-dn]) becomes

[formula]

It becomes immediately clear that magnetic effects in metamaterials are due entirely to higher-order spatial harmonics of the Bloch wave, manifested in [formula]. (If [formula], the Bloch wave is just a plane wave, and ζττ  =  0.) To avoid any misunderstanding, note that [formula] by definition has a zero average in the volume of the cell but in general not on its surface, which makes all the difference in [\eqref=eqn:zeta-tau-via-e-zeromean].

The behavior of Bloch waves in inhomogeneous lattice cells is complicated, and there are no simple closed-form expressions for these waves. (Approximations are well known but exist only as formal solutions of large linear systems developed in a finite basis, e.g. in a plane-wave basis.) From the qualitative physical perspective, however, one may conclude that, due to the complex dependence of [formula] on θB (i.e. on the illumination conditions), ζττ is in general angle-dependent. Moreover, this angular dependence will tend to be stronger when the magnetic effects (nonzero ζττ) are themselves stronger, as both are controlled by [formula]. This conclusion can also be supported quantitatively (see Appendix A) but does not have the status of a mathematical theorem; the door is therefore still open for engineering design and optimization, with a compromise between the strength of magnetic response and homogenization accuracy.

Second Uncertainty Principle: TR-discrepancy vs. Power Discrepancy

In this section, we put forward a second uncertainty principle: if magnetic response is appreciable, homogenization cannot accurately reproduce both TR and power dissipation (the heating rate). The root cause of that can be easily grasped from the simplified 1D sketch in Fig. [\ref=fig:E0-from-bc-and-power]. Let the periodic factor ẽ(x) of a Bloch wave in a given lattice cell be approximated, in a homogenized medium, by a plane wave of amplitude E0. If it is power dissipation in the homogenized medium that is matched to the actual power, then E0 should be at the root-mean-square (rms) level indicated by the dashed line. On the other hand, if it is the boundary conditions that are matched (which is necessary for rendering the TR correctly), then E0 must have a different value, indicated by the solid line in the figure.

Let us proceed to a more formal analysis. In the homogenized case, the general expression for the total current density within the medium is, in the frequency domain,

[formula]

where

[formula]

[formula]

[formula]

[formula]

Substituting expressions for [formula] and [formula] ([\ref=eqn:P-eq-D-minus-E]) and ([\ref=eqn:M-eq-B-minus-H]) into the expression for [formula] ([\ref=eqn:J-eq-dtP-curl-M]), one obtains

[formula]

[formula]

[formula]

Expressing the heating rate as [formula], one obtains per-cell power dissipation in the homogenized medium[\cite=Markel08]

[formula]

The power calculation for the actual fine-scale fields is similar but simpler, since for intrinsically nonmagnetic components magnetization [formula] is by definition zero. Hence we have

[formula]

[formula]

Thus the actual power dissipation per lattice cell is

[formula]

Let us consider an s-wave as a simple but representative model; the conclusion generalizes to arbitrary waves in 2D or 3D periodic structures. For an s-wave, the "longitudinal" [formula] terms vanish, as the electric field is, by definition, orthogonal to [formula]. Then, for power dissipation WC on the coarse level to be equal to the actual power wC, the amplitude E0 on the coarse level has to satisfy

[formula]

This follows from the direct comparison of expressions ([\ref=eqn:power-homogenized]), ([\ref=eqn:power-actual]) and the fact that [formula] and [formula] contain the same Bloch exponential: [formula], [formula].

On the other hand, to represent TR accurately, one needs to honor the boundary conditions (see Sec. [\ref=sec:Magnetic-response-vs-accuracy]). Thus, according to ([\ref=eqn:ET0-eq-avrg-EB]),

[formula]

If ([\ref=eqn:E0-sq-eq-int-e2]) were to hold with E0 satisfying ([\ref=eqn:E0-eq-avrg-EB]), one would have

[formula]

and the right hand side simplifies because the zero-mean function [formula] is orthogonal to the constant e0:

[formula]

Since the volume distribution of a Bloch mode and the respective value of e0 are only loosely related to its boundary values, the above condition is quite restrictive and cannot be expected to hold for any given wave, let alone for all Bloch waves, traveling in different directions or evanescent. A trivial exception is [formula], in which case the Bloch wave turns into a plane wave and there are no magnetic effects. The stronger these effects, the more strongly ([\ref=eqn:Esim-sq-eq-int-esim2]) will in general be violated.

Numerical Example: the Uncertainty Principle for a Problem with High Isotropy

The Setup

As an instructive example, we consider the hexahedral lattice of cylindrical air holes in a dielectric host investigated previously by Pei & Huang [\cite=Pei12]. The radius of each air hole is [formula], the dielectric permittivity of the host is [formula]; s-polarization (TM-mode, one-component E field perpendicular to the plane of the figure). This example is interesting because in the second photonic band it exhibits a high level of isotropy around the Γ-point and a negative effective index.

The elementary cell of this lattice can also be viewed as a rhombus, with the corresponding real-space lattice vectors

[formula]

and reciprocal vectors

[formula]

The real and reciprocal vectors satisfy the standard Kronecker-delta relation

[formula]

For this structure, we have calculated the Bloch bands and modes, as well as wave transmission and reflection. All of these simulations employed high-order FLAME difference schemes [\cite=tsukerman_05_1] [\cite=tsukerman_06_1] [\cite=Tsukerman-book07] [\cite=Tsukerman-PBG08]. These schemes do not necessarily operate on Cartesian grids and, in particular, have been adapted to rhombic ones for the calculation of Bloch modes. Selected results follow.

The first-Brillouin-zone equal frequency contour for a  =  0.365λ (λ being the vacuum wavelength), close to the Γ-point a  ≈  0.368λ, is shown in Fig. [\ref=fig:circular-isofreq-triang-lattice-a0365]. The contour is indeed seen to be almost circular.

Two modes with qx  =  0 and qy  =  0 are plotted in Fig. [\ref=fig:abs-E-Bloch-mode-triang-lattice-a0365-qx0-qy0]. Incidentally, in contrast with rectangular lattices, for hexahedral ones the Bloch mode with qy  =  0 is not generally lattice-periodic in the y-direction. Indeed, consider a point [formula] on the lower side of the rhombic cell and the corresponding point [formula] on the upper side. For a plane-wave component (m1,m2) of a Bloch wave, the respective phase factor between the two points is equal to unity only for even values of m1:

[formula]

[formula]

where the Kronecker-delta property of the lattice vectors was taken into account.

However, a similar calculation shows that for qx  =  0 lattice periodicity in the x direction does hold. Indeed, in that case the phase factor is

[formula]

[formula]

Numerical results in the following subsection illustrate that the uncertainty principle is valid even for this highly isotropic case.

An Optimized Tensor

To verify the uncertainty principle numerically, we performed "brute-force" minimization of the TR-discrepancy with respect to a varying effective material tensor. The TR data from accurate FD simulations of wave propagation through a hexahedral-lattice slab was taken as a basis. Parameters of the lattice are given in the previous subsection; the angle of incidence varied from zero to an adjustable value θmax. The number of layers in the slab was fixed at eight, which, according to extensive published evidence, should yield a very reasonable representation of bulk behavior. The Matlab[formula] optimization function fminsearch was run repeatedly from different initial guesses for the tensor. ( fminsearch employs the Nelder-Mead simplex search method that does not use numerical or analytic derivatives.) Included in our optimization routine was a simulated annealing procedure [\cite=Kirkpatrick83] [\cite=Otten89] which allows the numerical solution to escape from a local minimum, in the search for a global one. Admittedly, in complex nonlinear optimization it can almost never be claimed (with the notable exception of convex problems) that a global minimum has been found. Still, in our case minimization was surprisingly robust and converged to the same final result regardless of the initial guess.

This tensor optimization can be viewed as a generalization of the traditional S-parameter retrieval, except that illumination is not limited to normal incidence and the material tensor is not limited to a diagonal one. Optimization was performed under constraints proved formally in Appendix B: namely, the magnetoelectric coupling entries of the tensor are purely imaginary, while all remaining ones are real.

For reference, we also consider the static tensor corresponding to the a  /  λ  →  0 limit. This tensor is diagonal, its magnetic part being the identity tensor. For s polarization, the effective static-limit permittivity is just the volume average of those of the host and inclusion.

Figs. [\ref=fig:error-RT-vs-theta-hex-lattice-a01-maxangle-pi4] and [\ref=fig:error-RT-vs-theta-hex-lattice-a0365-maxangle-pi4] contrast the accuracy of homogenization for the cases of a long wavelength (a  /  λ  =  0.1) and a short one (a  /  λ  =  0.365), in correlation with the corresponding magnetic effects. As already noted, a  /  λ  =  0.365 is close to the second Γ-point.

For the long wavelength (Fig. [\ref=fig:error-RT-vs-theta-hex-lattice-a01-maxangle-pi4]), one observes that the optimized tensor yields a good "engineering level" of accuracy: the TR errors are below 0.01 in a broad range of (albeit not all) angles of illumination. Even the static tensor in that case is borderline acceptable. This does not violate the uncertainty principle for TR, as magnetic effects in the long-wavelength case are weak: μ  ≈  1.04 for the optimized tensor and μ  =  1 for the static one.

The situation is completely different for the short wavelength near the second Γ-point (Fig. [\ref=fig:error-RT-vs-theta-hex-lattice-a0365-maxangle-pi4]). Not surprisingly, the static tensor in this regime is not applicable at all. But even the optimized tensor does not work: the errors are too large, except for an accidental narrow range of the angles of incidence. (Clearly, for any given specific angle, TR can be represented perfectly just by parameter fitting.)

Conclusion

The paper demonstrates that a nontrivial effective permeability tensor of periodic structures composed of intrinsically nonmagnetic constituents has limitations and is subject to (at least) two "uncertainty principles". First, the stronger the magnetic response (as measured by the deviation of the optimal effective permeability tensor from identity), the less accurate ("certain") predictions of the effective medium theory. Second, also in the case of a strong magnetic response, homogenization cannot simultaneously and accurately reproduce both TR and power relations in the periodic structure. In practice, there is still room for engineering design, but the trade-offs between magnetic response and the accuracy of homogenization must be noted.

These conclusions follow from the analysis of coarse-level fields that must satisfy the dispersion relation and boundary conditions accurately, while simultaneously approximating the far field reflected and transmitted by a metamaterial sample. All of this implies that not only the dispersion relation but also surface impedance have to be illumination-independent. These prerequisites cannot unfortunately be simultaneously satisfied if the desired magnetic response is strong. As a supporting example, we considered a hexahedral lattice of cylindrical air holes in a dielectric host, as investigated previously in Ref. [\cite=Pei12]. Even in this highly isotropic case, seemingly conducive to homogenization, the uncertainty principles remain valid.

Acknowledgment

The work of Vadim A. Markel has been carried out thanks to the support of the A*MIDEX project (No. ANR-11-IDEX-0001-02) funded by the "Investissements d'Avenir" French Government program, managed by the French National Research Agency (ANR). The research of both authors was also supported by the US National Science Foundation under Grant DMS-1216970.

Appendix A: Dependence of Bloch Waves on Direction of Propagation

As no analytical expressions are available for Bloch waves, let us consider an approximation and examine its implications for the magnetic parameter ζ in ([\ref=eqn:zeta-tau-via-e-zeromean]). Since ([\ref=eqn:zeta-tau-via-e-zeromean]) is valid for the case of a four-fold symmetry, we continue to operate under that assumption. To simplify analytical manipulations, we assume, in addition, that the metamaterial consists of C4-symmetric but otherwise arbitrarily shaped particles embedded in a homogeneous host; then the medium next to the lattice cell boundary is homogeneous, which is quite typical. Finally, we shall continue to concentrate on the 2D case, s-mode; it will be clear from the analysis below that this assumption is not critical, but it does simplify the mathematics greatly.

Under the above assumptions, the e-field at the cell boundary can be expanded into cylindrical harmonics:

[formula]

where Jm and hm are the Bessel function and the Hankel function of the first kind, respectively; cm and sm are (yet undetermined) coefficients, and k is the wavenumber corresponding to the host material around the cell boundary. The (infinite) coefficient vectors [formula] and [formula] are linearly related:

[formula]

Eq. ([\ref=eqn:s-vs-c-via-T]) may serve as a definition of the scattering matrix T which depends on the particle in the cell and fully characterizes its electromagnetic response.

As an approximation, let us retain the terms in ([\ref=eqn:cyl-harmonic-expansion-inc-scattered]) up to quadrupole (|m|  ≤  2); the coefficient vectors then reduce to length five, and T is 5  ×  5.

Since the Bloch wave is defined up to an arbitrary scaling factor, we need four conditions to fix the coefficient vectors [formula] and [formula]. The simplest way to impose such conditions is by collocation at the four edge midpoints of the boundary.

More precisely, let the square lattice cell a  ×  a be centered at the origin; let midpoints 1 and 2 correspond to the bottom and top edges, respectively: [formula], [formula]. We require that the fields at these midpoints be related by the Bloch condition

[formula]

where [formula]. In a completely similar manner, for the midpoints on the "left" and "right" edges, [formula], [formula], the Bloch condition is

[formula]

where [formula]. It is straightforward to write the midpoint collocation condition in matrix-vector form

[formula]

[formula]

α  =  1,3.

All Js and Is above are row vectors of length five. Vector Jl contains the values of the Bessel functions at the collocation point l - that is, the values [formula], [formula]. Likewise, vector Il contains the values of the respective Hankel functions [formula]. Vectors labeled with superscript ∂ are analogous but contain the respective partial derivatives of the Bessel/Hankel functions: ∂n for collocation points 1 and 2, and ∂τ for points 3 and 4.

Recalling now that   =  T ([\ref=eqn:s-vs-c-via-T]) and merging the four conditions above into a single matrix, we have

[formula]

where

[formula]

Now that the Bloch wave expansion into cylindrical harmonics has been evaluated, we can substitute it into expression ([\ref=eqn:zeta-tau-via-etilde-dn]) for ζττ:

[formula]

The key point here is that coefficients [formula] depend in quite a convoluted way on the angle. Indeed, vector [formula] is the null space of matrix A which contains λτ and λτ, which in turn are complex exponentials of cos θB and sin θB. This convoluted angular dependence of [formula] translates, via ([\ref=eqn:zeta-tau-matrix-form]), into an even more complex angular dependence of ζττ.

Appendix B: Properties of the Tensor, s-mode

This section includes a formal proof of some properties of the optimized material tensor, under natural assumptions about this optimization. The general plan of analysis is as follows:

Assume some valid fields [formula] in and around a metamaterial slab.

Apply a transformation ("symmetry") S with regard to which Maxwell's equations are invariant: e'  =  Se, etc.

Find coarse-level [formula]: [formula], [formula], [formula], [formula]; [formula], etc., where functions f1,2 are boundary averages[\cite=Tsukerman-Markel14] and functions g1,2 come from Maxwell's equations.

Given [formula], [formula] determine the implications for M.

Let us implement this plan if S is complex conjugation. The governing equation for the s-mode is

[formula]

This equation is indeed invariant with respect to complex conjugation S if ε is real. The original and transformed Bloch waves are, for a given [formula],

[formula]

[formula]

(tangential component). Here

[formula]

For a real [formula],

[formula]

with

[formula]

[formula]

The above derivation formally shows that, as could be expected, if [formula] is a valid Bloch wave in a lossless structure, then [formula] is also a valid Bloch wave. (Notably, the sign of the magnetic field is reversed as the direction of the wave is reversed.)

The amplitudes of the two respective plane waves in the homogenized medium are therefore related as follows:

[formula]

[formula]

[formula]

Let there be a material tensor M that relates the fields as follows:

[formula]

Then from ([\ref=eqn:E0-prime-eq-E0-conj]) - ([\ref=eqn:B0-prime-eq-minus-B0-conj]) it follows that entries M12, M13, M21, M31 are purely imaginary, while all others are real. Indeed, substituting into ([\ref=eqn:calM-EH-eq-DB]) a valid wave with amplitudes (E0,H0x,H0y), we have, say, for the first equation in the system

[formula]

and for the corresponding conjugate wave with (E*0, - H*0x, - H*0y),

[formula]

From the above equations for the two waves, it immediately follows that

[formula]

M = M,    M =-M,    M = -M,

[formula]