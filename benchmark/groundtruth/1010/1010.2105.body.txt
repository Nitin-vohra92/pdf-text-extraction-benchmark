Universality of weak selection

Introduction

In evolutionary game theory the outcome of strategic situations determines the evolution of different traits in a population [\cite=maynard-smith:1973to]. Typically, individuals are hardwired to a set of strategies. The performance in an evolutionary game determines the rate at which strategies spread by imitation or natural selection. Due to differences in payoff, different strategies spread with different rates under natural selection. In infinitely large well-mixed populations this is described by the deterministic replicator dynamics [\cite=taylor:1978wv] [\cite=hofbauer:1979mm] [\cite=zeeman:1980ze] [\cite=hofbauer:1998mm]. In this set of non-linear differential equations the intensity of selection, which determines how payoff affects fitness, only changes the time scales, but not the direction of selection or the stability properties. In finite populations fluctuations cannot be neglected [\cite=fogel:1998aa] [\cite=ficici:2000aa] [\cite=schreiber:2001aa] [\cite=nowak:2004pw]. The dynamics becomes stochastic: Selection drives the system into the same direction as the corresponding deterministic process, but sometimes the system can also move into another direction. The strength of selection determines the interplay between these two forces. The absence of selective differences is called neutral selection: Moving into one direction is as probable as moving into any other, independent of the payoffs. If selection acts, the transition probabilities become payoff dependent and thus asymmetric. The asymmetry can be the same in each state (constant selection) or state dependent (frequency dependent selection). In general, under frequency dependent selection the probability that one strategy replaces another can be fairly complicated. However, under the assumption of weak selection, some important insights can be obtained analytically [\cite=nowak:2004pw] [\cite=traulsen:2006aa] [\cite=ohtsuki:2006na] [\cite=ohtsuki:2007pr] [\cite=altrock:2009nj] [\cite=kurokawa:2009aa] [\cite=gokhale:2010pn] [\cite=ohtsuki:2010aa]. It has to be pointed out that these results do in general not carry over to stronger selection.

Weak selection describes situations in which the effects of payoff differences are small, such that the evolutionary dynamics are mainly driven by random fluctuations. This approach has a long standing history in population genetics [\cite=kimura:1968aa] [\cite=ohta:2002aa]. In evolutionary biology, a phenotype is often found to be slightly advantageous over another phenotype [\cite=akashi:1995ge] [\cite=charlesworth:2007pn]. Further, a recent experiment suggests that some aspects of weak selection are reflected in human strategy updating in behavioral games [\cite=traulsen:2010pn]. In the context of evolutionary game dynamics, however, weak selection has only recently been introduced by Nowak et al. [\cite=nowak:2004pw]. The definition of weak selection is unambiguous in the case of constant selection, but there are different ways to introduce such a limit under frequency dependent selection [\cite=traulsen:2010fy].

In the simplest case, frequency dependence can be introduced by an evolutionary game between two types A and B. In a one shot interaction (where strategies are played simultaneously) a type A interacting with another type A receives payoff a, two interacting B types get d each. Type A interacting with B gets b, whereas B obtains c. This symmetric [formula] game can be described by the payoff matrix

[formula]

Let i denote the number of A individuals in a population of constant size N. Under the assumption of a well-mixed population, excluding self-interactions, the average payoffs for individuals of either type are given by

[formula]

These expectation values are the basis for the evolutionary game. In the continuous limit N  →    ∞  , the state of the system is characterized by the fraction of A individuals x = i / N. The dynamics are typically given by the replicator dynamics [formula], which has the trivial equilibria x̂ = 0 and x̂ = 1. Additionally, there can be a third equilibrium between zero and one, given by [formula]. In finite populations, the probabilistic description does not allow the existence of equilibrium points anymore. Moreover, the invariance of the replicator dynamics under rescaling of the payoff matrix [\cite=hofbauer:1998mm] is lost in finite population models. Typically, the average payoffs are mapped to the transition probabilities to move from state i to other states, only i = 0 and i = N are absorbing states. When only two types compete and there is only one reproductive event at a time this defines a birth-death process. The transition probabilities from i to i + 1, and from i to i - 1 are then denoted by T+i and T-i, respectively. They determine the probability of the process to be absorbed at a certain boundary, usually called fixation probability, as well as the average time such an event takes, termed average fixation time.

An important result of evolutionary game dynamics in finite populations under weak frequency dependent selection is the one-third rule. It relates the fixation probability of a single type A individual, φ1, to the position of the internal equilibrium [formula] in a coordination game, i.e. when a > c and d > b. If selection is neutral, we have φ1 = 1 / N. If the internal equilibrium is less than one third, [formula], then φ1 > 1 / N. Originally, this weak selection result has been found for large populations in the frequency dependent Moran process [\cite=nowak:2004pw]. Subsequently, the one-third rule has been derived from several related birth-death processes [\cite=traulsen:2005hp] [\cite=traulsen:2006bb] [\cite=ohtsuki:2007aa], and also for the frequency dependent Wright-Fisher process [\cite=imhof:2006aa] [\cite=traulsen:2006ab], which is still a Markov process, but no longer a birth-death process. In a seminal paper, Lessard and Ladret have shown that the one-third-rule is valid for any process in the domain of Kingman's coalescence [\cite=lessard:2007aa], which captures a huge number of the stochastic processes typically considered in population genetics. Essentially, this class of processes describes situations in which the reproductive success is not too different between different types. Thus, the generality of the one-third-rule under linear weak selection is well established. Here we ask a slightly different question: To which order can two birth-death processes be considered as identical under weak selection? Some authors have considered higher weak selection orders for specific processes [\cite=ross:2007aa] [\cite=bomze:2008lr] [\cite=huang:2010aa]. We investigate two classes of birth-death processes, a general pairwise imitation process motivated by social learning and a general Moran process based on reproductive fitness. In this light, we also discuss cases which violate the one-third rule.

The manuscript is organized in the following way: In Sec. [\ref=sec:FixProb] we compute the weak selection expansion of the fixation probability in a general case of our two classes of birth-death processes. In Sec. [\ref=sec:FixTime], we perform the same calculations for the significantly more complicated fixation times. In Sec. [\ref=sec:Disc] we discuss our analytical results and conclude. Some detailed calculations can be found in the Appendix.

Probabilities of fixation

A birth-death process is characterized by the transition probabilities from each state i to its neighboring states, T+i and T-i. We assume that this Markov chain is irreducible on the interior states and we exclude mutations or spontaneous switching from one type to another. Thus, the process gets eventually absorbed at i = 0 or N. For any internal state, the probability to hit i = N starting from 0 < i < N, φi, fulfills the recursion equation φi = (1 - T+i - T-i)φi + T-iφi - 1 + T+iφi + 1 [\cite=goel:1974aa] [\cite=ewens:2004qe] [\cite=nowak:2006bo]. This recursion can be solved explicitly, respecting the boundary conditions φ0 = 0 and φN = 1. For a single A individual in a populations of B, the probability to take over the population is [\cite=goel:1974aa] [\cite=ewens:2004qe] [\cite=nowak:2006bo]

[formula]

In any model of neutral selection, the transition probabilities of the Markov chain fulfill T-i / T+i = 1, and hence the respective fixation probability of a single mutant amounts to 1 / N.

In this section we focus on the weak selection approximation of Eq. ([\ref=eq:FixProb01]). We do this for two different approaches to evolutionary game theory: imitation dynamics and selection dynamics. In the former case, strategy spreading is based on pairwise comparison and imitation, in the latter it results from selection proportional to fitness and random removal. The most prominent examples are the Fermi process and the Moran process, respectively.

Pairwise comparison

In a pairwise comparison process, two individuals are chosen randomly to compare their payoffs from the evolutionary game, Eqs. ([\ref=eq:MPayoffA]) and ([\ref=eq:MPayoffB]). One switches to the others strategy with a given probability, see Fig. [\ref=fig1]. If selection is neutral, this probability is constant. If selection acts, the larger the payoff difference, the higher the probability that the worse imitates the better. But typically there is also a small chance that the better imitates the worse. Otherwise, only the strategy of the more successful individual is adopted. This would lead to a dynamics that is stochastic in the time spent in each interior state, but deterministic in direction [\cite=traulsen:2006bb]. Thus, given that all interior states are transient, the fixation probabilities are either 0 or 1 and there is no basis to discuss a weak selection limit.

Selection is parameterized by the intensity of selection β  ≥  0. As a first example we consider the Fermi process [\cite=blume:1993jf] [\cite=szabo:1998wv] [\cite=traulsen:2006bb]. Let the two randomly selected individuals X and Y have payoffs πX and πY. Then X adopts Y's strategy with probability [formula]. Thus, the transition probabilities of an evolutionary game with payoffs Eqs. ([\ref=eq:MPayoffA]) and ([\ref=eq:MPayoffB]) are given by

[formula]

The probability to stay in state i is 1 - T-i - T+i. The Fermi process is closely related to Glauber dynamics [\cite=glauber:1963aa]. If we define individuals' energy as the exponential function of payoff, then the Fermi process can be mapped onto the Ising model. The Fermi process has the comfortable property that the ratio of transition probabilities simplifies to [formula], such that the products in Eq. ([\ref=eq:FixProb01]) can be replaced by sums in the exponent. Defining u = (a - b - c + d) / (N - 1) and v = (Nb - Nd - a + d) / (N - 1), such that πA  -  πB = u  i + v, leads to

[formula]

For large N, the sum can be replaced by an integral, leading to a closed expression [\cite=traulsen:2006bb]. For weak selection, [formula], Eq. [\eqref=eq:Fermi02] can be approximated by

[formula]

This can also be obtained directly from T-i / T+i  ≈  1 - β(πA  -  πB). The fixation probability under weak selection is greater than in the neutral case if the term linear in β is positive, Nu + u + 3v > 0. In particular, for a coordination game in a large population, this implies [formula]. Thus, natural selection favors the mutant strategy, if the invasion barrier is less than one-third, which is the well known one-third rule [\cite=nowak:2004pw] [\cite=traulsen:2006bb] [\cite=ohtsuki:2007aa] [\cite=lessard:2007aa] [\cite=bomze:2008lr]. It holds when the fixation probability in a large but finite population can be approximated up to linear order in selection intensity.

Can we make general statements based on an expansion of φ1 concerning the probability of switching strategies, g(Δπ)? In a general framework, the probability that X switches to the strategy of Y, given the difference in their payoffs, Δπ  =  πX  -  πY, is governed by the intensity of selection. We call g(Δπ) the imitation probability function of a general pairwise comparison process. In a well mixed population, the transition probabilities read

[formula]

The larger the payoff difference, the more likely the worse individual switches to the strategy of the better. Therefore the imitation function is nondecreasing, g'(Δπ)  ≥  0. Additionally, if the payoffs of the two chosen individuals are equal, the neutral probability of switching is non-zero, g(0) > 0 (otherwise, the process does not allow a meaningful definition of weak selection because it would always deterministically follow the direction of selection). The fixation probability for this general pairwise comparison process can be expanded to the second order (see Appendix [\ref=app:Aa])

[formula]

where

[formula]

and

[formula]

C1 is proportional to the increase of the imitation function at Δπ = 0, see Fig. [\ref=fig2]. Note that for large N, C1 > 0 is equivalent to Nu + 3v > 0, which for large N further simplifies to [formula]. Thus, the one-third rule holds for all pairwise comparison processes that fulfill g'(0)  ≠  0, and g(0) > 0. Moreover, C1 is proportional to 2g'(0) / g(0), while C2 is proportional to the square of this quantity. Thus, 2g'(0) / g(0) can be absorbed into the selection intensity by proper rescaling. Therefore, the more rapid the increases of the imitation function at Δπ = 0, the stronger is the sensitivity of the fixation probability to changes in average payoff. For low switching probabilities in the neutral case, Δπ = 0, we have a fixation probability that changes rapidly when the payoff difference becomes important, [formula]. While most previous models have either considered g(0) = 0 (which lies out of the scope of our approach, because it does not lead to a reasonable definition of weak selection) or g(0) = 0.5 (which is the default case), some authors have also explored imitation functions with other values of g(0). For example, Szabó and Hauert have used the imitation function [formula], where α is a constant [\cite=szabo:2002te]. In this case 2g'(0) / g(0) = 2 / (1 +  exp ( - α)), thus, an increase in α is equivalent to an increase in the (small) selection intensity.

Now it is straightforward to come up with an imitation function that leads to a violation of the one-third rule, for example g(Δπ) = 1 / (1 +  exp {  -  Δπ3}). Obviously, g(βΔπ) satisfies the conditions g'(βΔπ)  ≥  0, and [formula]. Further, both the first and the second order expansions vanish. Therefore, the fixation probability under weak selection can only be approximated as

[formula]

where C3 can be derived in the same way as C1 and C2. In special games, the sign of C3 can also change at [formula], but in general this will not be the case due to the complicated dependence of C3 on u and v. In more general terms, the 1/3 rule is not sustained whenever the linear approximation of g(βΔπ) vanishes.

Moran process

In the frequency dependent Moran process the payoff π, given by Eqs. ([\ref=eq:MPayoffA]) and ([\ref=eq:MPayoffB]), is mapped to fitness f, as illustrated in Fig. [\ref=fig1]. In each reproductive event, one individual is selected for reproduction (producing an identical offspring) proportional to fitness. To keep the size of the population to the constant value N, a randomly chosen individual is removed from the population subsequently. As in pairwise comparison processes, the state i can at most change by one per time step.

In the simplest case, fitness is a linear function of payoff. With a background fitness of one, the fitnesses of type A and B read fA = 1 + β  πA, and fB = 1 + β  πB, respectively. The quantity [formula] serves as the intensity of selection. Note that β is bound such that fitness never becomes negative. The probability that the number of A individuals increases by one, i  →  i + 1, is given by

[formula]

The other possible transition, i  →  i - 1, occurs with probability

[formula]

When selection is neutral, β = 0, we have T±i = i(N - i) / N2. Up to linear order in β the Moran process has the same fixation probability as the Fermi process, Eq. ([\ref=eq:Fermi03]), such that in this approximation the one-third rule is fulfilled. This is because under first order weak selection, T-i / T+i is again a linear function of the payoff difference.

In general, let fitness be any non-negative function of the product of payoff and selection intensity, f(βπ), which fulfills [formula]. For simplicity, we assume that the baseline fitness f(0) is one. The transition probabilities in a population with types A and B read

[formula]

Note that T-i / T+i  =  f(βπB)  /  f(βπA). Up to second order in β, the fixation probability of a single A mutant in a population of B is (see Appendix [\ref=app:Ab])

[formula]

where

[formula]

and with u and v as above. Note that the first order term depends on payoff differences only, but the second order term also depends on the payoff values directly. An example for such an approximation is shown in Fig. [\ref=fig2]. The first order term D1 is proportional to the increase in fitness at π = 0, f'(0). The first order term D1 is proportional to Nu + 3v for large N. Hence, the one-third rule holds for every Moran model for which f'(0) does not vanish under weak selection. Additionally, [formula] can be absorbed into the selection intensity by rescaling: Changing this rate is equivalent to changing the intensity of selection. Note that this is not possible with D2, where not only the slope, but also the curvature of the fitness function at the origin plays a role. However, when the exponential fitness function f =  exp (βπ) is employed [\cite=traulsen:2008aa], the second term of Eq. ([\ref=eq:Moran05b]) vanishes. This allows to incorporate f'(0) into the selection intensity even for the second order term.

Again, we conclude the section with an example where the one-third is violated. Consider the fitness function f(βπ) = 1 + β3π3, which obviously satisfies f(0) = 1, and [formula]. Both, first and second order correction in β vanish, D1 = D2 = 0. Therefore, the first non-trivial approximation of the fixation probability is

[formula]

If D3 changes sign at [formula], we recover the one-third rule. This is only the case for very special games. In analogy to the previous section, the general one-third rule does not hold anymore.

Times of fixation

In this section we address the conditional fixation time τAi. In a finite population of N - i individuals of type B and i individuals of type A, τAi measures the expected number of imitation or birth-death events until the population consist of type A only, under the condition that this event occurs. In general, the probability PAi(t) that after exactly t events the process moved from any i to N, which is the all A state, obeys the master equation [formula]. The average fixation time [formula] is the stationary first moment of this probability distribution, resulting from a recursive solution of [formula]. In a similar way one can find [formula], such that the total average lifetime of the Markov process amounts to φiτAi + (1 - φi)τBi [\cite=goel:1974aa] [\cite=karlin:1975xg] [\cite=antal:2006aa]. Following the previous section we restrict our analysis to the biologically most relevant case i = 1, which yields [\cite=goel:1974aa] [\cite=karlin:1975xg]

[formula]

Maruyama and Kimura [\cite=maruyama:1974aa], Antal and Scheuring [\cite=antal:2006aa] as well as Taylor et al. [\cite=taylor:2006jt] have shown that the conditional fixation time of a single mutant of either type is the same, τA1  =  τBN - 1. This remarkable identity holds for any evolutionary birth-death process, and is thus valid for any [formula] game and for any selection intensity. However, for j > 1 we have τAj  ≠  τBN - j, unless β vanishes. Since τA1 and τBN - 1 are identical up to any order in β, we obtain

[formula]

for any n. This symmetry can help to obtain several properties of the expansion of the conditional fixation time, Eq. ([\ref=eq:Time01]), without brute force calculations.

Pairwise comparison

Let us first consider the fixation time in the special case of the Fermi process, Eq. ([\ref=eq:Fermi01]). When the selection intensity vanishes, β = 0, we have τA1(0) = 2N(N - 1), [\cite=altrock:2009nj] [\cite=ewens:2004qe]. When selection is weak, [formula], the conditional fixation time is approximately τA1  ≈  τA1(0) + ∂βτA1(β)|β = 0  β  +  ∂2βτA1(β)|β = 0  β2 / 2. For the Fermi process, the first order term is then given by [\cite=altrock:2009nj]

[formula]

where u stems from πA  -  πB = u  i + v, compare App. [\ref=ssec:PWC]. The first order expansion of τA1 is only proportional to the i dependent term u in this special case. This can also be seen from a symmetry argument [\cite=taylor:2006jt] [\cite=antal:2006aa]: Since τA1  =  τBN - 1, the fixation time does not change under a  ↔  d and b  ↔  c. Since u, but not v, is invariant under this exchange of strategy names, τA1 can depend under linear weak selection only on u, but not on v. The second order term of the conditional fixation time for the Fermi process yields

[formula]

where

[formula]

Now, in contrast to the first order expansion Eq. ([\ref=eq:TimeP01]), both u and v enter. An interesting relation is E3 = E2 / N. In the following, we show that this is found for any pairwise comparison process and not only in the special case of the Fermi process.

For general pairwise comparison processes under neutral selection, the conditional fixation time is τA1(0) = N(N - 1) / g(0), where g(0) > 0. When selection acts, Eq. ([\ref=eq:Fermi04]), the transition probabilities become dependent on the derivative of the imitation function, [formula]. We are now interested in the imitation function's influence on the first and second order terms in β. In general, the first order term in β reads

[formula]

with the multi-index α = (α1,α2,α3), |α| = α1  +  α2  +  α3, see App. [\ref=app:Ba] for details of the calculation. The general structure of this term is determined by hα, which is linear in u and v, as |α| equals one. Thus, ∂βτA1|β = 0 = F1  u + F2  v is also of this form, where F1 and F2 only depend on the population size N. With the same symmetry argument as above, based on [\cite=taylor:2006jt] [\cite=antal:2006aa], we can conclude that F2 = 0. This yields

[formula]

We can now calculate the payoff independent term F1 for any g(Δπ) from the special case u = 1 and v = 0, which reads

[formula]

Here, β can be rescaled by g'(0) / g(0)2. Changing g'(0) or g(0) is equivalent to changing the selection intensity appropriately. In particular, when u > 0, which is true e.g. for coordination games such as the stag-hunt game [\cite=skyrms:2003aa], the conditional time it takes on average for a mutant type to take over decreases with the intensity of selection. Moreover, for a > c and b > d in combination with u < 0, a mutant which is always advantageous over the wild type needs longer to reach fixation than a neutral mutant. This phenomenon, termed stochastic slowdown in [\cite=altrock:2010aa], occurs in any imitation process, since Eq. [\eqref=eq:TimeP05] only depends on u.

For the second order term in the expansion in β we can write

[formula]

hα is of the form G1  u2 + G2  uv + G3  v2. Thus ∂2βτA1|β = 0 is also of this form, where the Gi's only depend on N. Again, we consider the transformation a  ↔  d and b  ↔  c which corresponds to exchanging the names of the strategies. For the transformed game, we obtain ∂2βτBN - 1|β = 0  =  G1  u2 + G2  uṽ + G3  ṽ2 with ṽ = (Nc - Na - d + a) / (N - 1). Using Eq. ([\ref=eq:Time02]), we obtain G2  u(v - ṽ) + G3  (v2  -  ṽ2) = 0. With v + ṽ =  - N  u, we then get G3 = G2 / N -- the symmetry discussed above for a special case holds for any imitation function. Eventually, the second order term in β for general imitation probability is given by

[formula]

The special cases u = 1,  v = 0, as well as u = 0,  v = 1 allow to compute G1 and G2 explicitly. Thus we have (see Appendix [\ref=app:Ba]) Obviously, Eq.([\ref=eq:TimeP08]) does not allow a rescaling of the intensity of selection. Instead, the properties of the imitation function enter in a more intricate way. An example of this approximation is shown in Fig. [\ref=fig3].

Moran process

To close this section, we consider the Moran process, where selection at birth is proportional to fitness and selection at death is random. For neutral selection β = 0, it is well known that τA1(0) = N(N - 1) [\cite=antal:2006aa] [\cite=altrock:2009nj] [\cite=ewens:2004qe]. When selection is weak [formula], the conditional mean fixation time is approximately τA1  ≈  τA1(0) + ∂βτA1|β = 0  β. For the Moran process with linear fitness function, fA = 1 + βπA, we have ∂βτA1|β = 0 =  - u  N2(N2 - 3N + 2) / 36, compare [\cite=taylor:2006jt] [\cite=altrock:2009nj]. The first order expansion of τA1 again depends only on u, but not on v. This can be shown based on [\cite=taylor:2006jt] [\cite=antal:2006aa] or explicitly [\cite=altrock:2009nj].

With general fitness mapping f(βπ) with transition rates ([\ref=eq:Moran03a]) and ([\ref=eq:Moran03b]), we have

[formula]

which allows a rescaling of the intensity of selection when τA1 is approximated up to linear order.

With general fitness function f(x), it becomes unwieldy to calculate higher order terms in β. However, the general calculations are similar to that of the general pairwise comparison rules. Eq. ([\ref=eq:Moran05b]) reveals that already the second order expansion of the fixation probability φ1 with general fitness mapping is tedious in form. Thus the equivalent terms for the fixation time τA1 are even more complicated and do not lead to further insight in this case. Since it would be only an academic exercise to calculate them, we do not give them explicitly here. It is clear that the weak selection approximation is not universal over a large class of processes in second order in the fixation times.

Discussion

In the past years, weak selection has become an important approximation in evolutionary game theory [\cite=nowak:2004pw] [\cite=traulsen:2006aa] [\cite=ohtsuki:2006na] [\cite=ohtsuki:2007pr] [\cite=altrock:2009nj] [\cite=kurokawa:2009aa] [\cite=gokhale:2010pn]. Weak selection means that the game has only a small influence on evolutionary dynamics. In evolutionary biology and population genetics, the idea that most mutations confer small selective differences is widely accepted. In social learning models, it refers to a case where imitation is mostly random, but there is a tendency to imitate others that are more successful. Since weak selection is the basis of many recent results in evolutionary dynamics [\cite=nowak:2006pw] [\cite=ohtsuki:2006na] [\cite=traulsen:2006aa] [\cite=tarnita:2009df] [\cite=antal:2009aa], it is of interest how universal these results are. It has been shown that they are remarkably robust and the choice of evolutionary dynamics has only a small impact in unstructured populations [\cite=lessard:2007aa] [\cite=antal:2009hc]. In structured populations, however, the choice of evolutionary dynamics can have a crucial impact on the outcome [\cite=ohtsuki:2006na] [\cite=ohtsuki:2006oz] [\cite=tarnita:2009jx] [\cite=tarnita:2009df] [\cite=nowak:2010aa] [\cite=roca:2009am] [\cite=roca:2009aa]. For example, for a prisoner's dilemma on a graph under weak selection, cooperation may be favored by a death birth process while it is never favored by a birth death process. In a well mixed population, however, the transition probabilities for those two processes are identical, thus they lead to the same result. However, in general spatial structure has a less pronounced effect under weak selection than under strong selection [\cite=roca:2009am] [\cite=roca:2009aa].

We have addressed to what extent two evolutionary processes can be considered as identical by investigating the fixation probability and the fixation time. For any given [formula] payoff matrix, we have considered two classes of evolutionary processes: Pairwise comparison and Moran processes. An interesting special case is the Moran process with exponential fitness mapping, which is equivalent to the Fermi process (a special case of the pairwise comparison rule) in terms of fixation probabilities.

For the fixation probability, the first order term in the selection intensity always has the same form, given that it does not vanish. In addition, regardless of the choice of imitation functions, two pairwise comparison processes are always identical up to second order weak selection in the fixation probabilities. For Moran processes, an equivalent statement does not hold. Recently, a paper has shown that in 3  ×  3 games under weak selection, the Fermi update rule can be quite different from the Moran process and the local update rule (an imitation process with linear imitation function [\cite=traulsen:2005hp]), while the Moran process and the local update rule are more similar to each other [\cite=bladon:2010ws]. Our result shows that for weak selection in 2  ×  2 games, these three processes can be mapped to each other by an appropriate rescaling of the intensity of selection.

For the first order approximation of the average fixation time, there are differences in the dependence on the system size, but all processes depend on the game in the same way. This follows from a symmetry in fixation times [\cite=taylor:2006jt] [\cite=antal:2006aa]. For higher orders in the intensity of selection, a simple rescaling of the selection intensity does not exist for the fixation times and a general statement on the relation between two processes cannot be made.

The robustness of weak selection results, i.e. the invariance to changes of the underlying stochastic process, found in the linear approximation is remarkable, but follows from basic assumptions on evolutionary dynamics. Moreover, the universality of weak selection breaks down when higher order terms are discussed.

Acknowledgement

B.W. gratefully acknowledges the financial support from China Scholarship Council (2009601286). L.W. acknowledges support by the National Natural Science Foundation of China (10972002 and 60736022). P.M.A. and A.T. acknowledge support by the Emmy-Noether program of the Deutsche Forschungsgemeinschaft.

Third order expansion of the fixation probabilities

Here, we expand the fixation probability φ1 for general birth-death processes up to the third order. Let γi = T-i / T+i and

[formula]

Note that the first index of psi refers to the order of the derivative and the second index gives the position in state space. We expand Eq.([\ref=eq:FixProb01]) to the third order under weak selection [formula]. Hence, we have

[formula]

Then the fixation probability can be written as

[formula]

This now serves as a starting point for our particular processes with certain choices of γi = T-i / T+i and particular psi resulting from this.

General pairwise comparison process

For general switching probabilities in a pairwise comparison process, we have

[formula]

Inserting these quantities into Eqs.([\ref=GeneralFpTranProbExpansion]) and ([\ref=GerneralFpMid]) leads to

[formula]

Q1 and Q2 have been calculated in the main text. Note that they only depend on g'(0) / g(0), whereas Q3 also depends on higher order derivatives of the imitation function. Thus, two pairwise comparison processes that are identical in first order are also identical in second order. Only in third order, differences start to emerge.

Let us briefly come back to our example of an imitation function that violates the 1 / 3-rule, g(x) = (1 +  exp ( - x3))- 1. In this case, we have g(0) = 1 / 2, g'(0) = g''(0) = 0 and g'''(0) = 3 / 2. Thus, both Q1, and Q2 vanish and the third order expansion of the fixation probability is

[formula]

Moran processes

For Moran processes with general fitness functions, we have p1i =  - f'(0)Δπi and p2i = 2(f'(0))2πAΔπi - f''(0)(πA  +  πB)Δπi. Inserting these quantities into Eqs.([\ref=GeneralFpTranProbExpansion]) and ([\ref=GerneralFpMid]) leads to

[formula]

Thus, the first and the second order expansion of the fixation probability of such processes are given by Eqs.([\ref=eq:Moran05a]) and ([\ref=eq:Moran05b]), respectively. In particular for f(π) = 1 + π3, both p1i and p2i vanish and p3i =  - 6(π3A  -  π3B). By Eq.([\ref=GerneralFpMid]), this yields

[formula]

where [formula].

Times of fixation

General expressions for the first and second order expansion of the fixation time for the birth-death process have been given in Eq([\ref=eq:TimeP04a]) and Eq.([\ref=eq:TimeP07]). Based on these, we show the results for the general pairwise comparison rule first and then discuss the Moran process.

General pairwise comparison process

For the first order term of the fixation time, Eq.([\ref=eq:TimeP04a]), each hα on the rhs. is proportional to g'(0) / g2(0). Thus, the first order term of the fixation time is of the form Rg'(0) / g2(0). In particular, when g(Δπ) is the Fermi function, g'(0) / g2(0) is one. Hence the first order of the fixation time for the Fermi process is R, cf. Eq.([\ref=eq:TimeP01]). This leads to the first order expansion of the fixation time for general pairwise comparison rule, Eq.([\ref=eq:TimeP06]).

For the second order, we write Eq. ([\ref=eq:TimeP07]) explicitly as

[formula]

As shown in the main text, the second order term is of the form of [formula]. Letting u = 1 and v = 0 leads to

[formula]

after some tedious calculations using the identity [formula][\cite=graham:1994aa]. Summing these Ki's leads to G1 in Eq.([\ref=eq:TimeP09a]). On the other hand, letting u = 0 and v = 1 yields

[formula]

Adding these Ki's yields G2 / N as in Eq. ([\ref=eq:TimeP09b]). Thus, the quantities in Eq. ([\ref=eq:TimeP08]) are finally derived.

Moran processes

For Moran processes, the approach is fully equivalent to pairwise comparison processes. However, the results do not only depend on payoff differences u and v, but on the full payoff matrix with entries a, b, c, and d. This makes the calculations a matter of diligence and leads to quite long expressions, but not to additional insights. Thus, we do not give details of the derivation here.