Main Theorem Question Lemma Corollary Corollaries Proposition Criterion Conjecture Principle ComplementPitfall Definition Condition Example Examples Hint Exercise Problem Construction Question Algorithm Remark Aside Note Summary Notation Warning Definition-Theorem Definition-Lemma Convention Key idea Explanation Method Assumption

Claim Conclusion

= C =O = R

Continuous closure of sheaves

Let [formula] be an ideal. Following [\cite=brenner] a polynomial [formula] is in the continuous closure of I iff there are continuous functions φi such that [formula]. These polynomials form an ideal IC  ⊃  I. For example

[formula]

shows that [formula].

The above definition is very natural, but it is not clear that it gives an algebraic notion (since [formula] does not map continuous functions to continuous functions) or that it defines a sheaf in the Zariski topology (since a continuous function may grow faster than any polynomial).

This note has three aims:

We give a purely algebraic construction of the continuous closure of any torsion free coherent sheaf ([\ref=cc.2.defn]). Although the construction makes sense for any reduced scheme, even in positive and mixed characteristic, it is not clear that it corresponds to a more intuitive version in general.

In characteristic 0 we prove that one gets the same definition of IC using various subclasses of continuous functions ([\ref=mydef=brdef]).

We show that taking continuous closure commutes with flat morphisms whose fibers are semi-normal ([\ref=flat.commute.thm]), at least in characteristic 0. In particular, the continuous closure of a coherent ideal sheaf is again a coherent ideal sheaf (both in the Zariski and in the étale topologies) and it commutes with field extensions.

It should be noted that although our definition of the continuous closure is purely algebraic and without any reference to continuity, the proof of these base change properties uses continuous functions in an essential way.

Instead of working with [formula] or other algebraically closed fields, one can also define the continuous closure over any topological field. The most interesting is the real case, considered in [\cite=fef-kol]. The answer turns out to be quite different; for instance, over [formula] the continuous closure of (x2 + y2) is itself but over [formula] it is the much larger ideal (x2 + y2,x3,y3). The methods, however, are quite similar. The main difference is that the base change properties are not considered in [\cite=fef-kol] and the key construction ([\ref=red.step.main.2]) is more complicated over non-closed fields.

The methods of this paper provide a way to compute the continuous closure in principle, but it is unlikely to be practical in its current form.

Descent problems

Instead of working with ideals, I work with maps of locally free sheaves f:E  →  F. Thus an ideal sheaf [formula] corresponds to the map [formula]. For inductive purposes we need the case when E and F live on different schemes.

Fix a base scheme S. A descent problem over S is a compound object

[formula]

consisting of a proper morphism p:Y  →  X of reduced S-schemes of finite type, a locally free sheaf E on X, a locally free sheaf F on Y and a map of sheaves f:p*E  →  F.

The original setting corresponds to the cases

[formula]

and, at least when X is (semi)normal, the continuous closure is

[formula]

where C0 denotes the space of continuous sections.

Our claim is that in general the primary task should be to understand the continuous aspects of the problem, that is, the image of

[formula]

Once that is done, the answers to the algebraic questions should follow.

A descent problem over [formula] is called finitely determined if for every [formula] the following are equivalent

There is a [formula] such that [formula].

For every finite subset Z  ⊂  Y there is a [formula] such that [formula] for every z∈Z.

For finitely determined descent problems it is quite easy to pass between the continuous and the algebraic sides.

The original descent problems ([\ref=desc.prob.efn].2) are finitely determined only in the trivial case I = OX. A better example is given by the following construction. Given [formula], let Y: = BIX denote the blow-up of I with projection p:Y  →  X. The ideal sheaf f*I  ⊂  OY is locally free; denote it by OY( - E) where E is an exceptional divisor. We get a descent problem

[formula]

which is, as we will see, equivalent to the original one. Finite determinacy for ([\ref=desc.prob.efn].6) is my reformulation of the axis closure condition of [\cite=brenner] (though they are probably not quite equivalent). It turns out that ([\ref=desc.prob.efn].6) is finitely determined in many cases but not always. Such examples were discovered by [\cite=hochster]; an especially nice one is I = (x2,y2,xyz).

This paper grew out of first reducing ([\ref=desc.prob.efn].2) to ([\ref=desc.prob.efn].6) and then studying the latter by restriction to E and induction.

The key technical result ([\ref=main.thm.v0]) shows that every descent problem is equivalent to a finitely determined descent problem. To achieve this, we need various ways of modifying descent problems. The following definition is chosen to consist of simple and computable steps yet be broad enough for the proofs to work. (It should become clear that several variants of the definition would also work. The present one is meant to supersede the choice in [\cite=k-obw].)

Let [formula] be a descent problem over S. A scion of [formula] is any descent problem [formula] that can be obtained by repeated application of the following procedures.

For a proper morphism r:Y1  →  Y set

[formula]

Given Yw, assume that there are several proper morphisms ri:Yw  →  Y such that the composites [formula] are all the same. Set

[formula]

where [formula] is the natural diagonal map.

Assume that f factors as [formula] where F' is a locally free sheaf and [formula] for all y in a dense open subscheme Y0  ⊂  Y. Then set

[formula]

By construction, each scion [formula] comes equipped with a morphism rs:Ys  →  Y, called the structure map.

Each scion remembers all of its forebears. That is, two scions are considered the "same" only if they have been constructed by an identical sequence of procedures. This is quite important since the way we obtain the locally free sheaf Fs does depend on the whole sequence.

The class of all scions of [formula] is denoted by [formula].

Simple examples of scions are given by restrictions. If Y1  ⊂  Y is a subscheme, we set

[formula]

If X1  ⊂  X is a subscheme and [formula], we set [formula].

Let [formula] be a descent problem with scions

[formula]

An algebraic global section of F over [formula] is a collection of sections

[formula]

such that the φi commute with pull-backs for the operations ([\ref=rel.desc.prob.sefn].1-2) and with push-forward for the operations ([\ref=rel.desc.prob.sefn].3). All sections form an OS-module

[formula]

one can also think of it as the direct limit of the H0(Ysni,Fsni) over the category [formula]. We call φi the restriction of Φ to Yi, denoted by Φ|Yi. The most important of these restrictions is Φ|Y. Note that Φ|Y uniquely determines Φ. Indeed, the constructions ([\ref=rel.desc.prob.sefn].1-2) automatically carry along φ and in ([\ref=rel.desc.prob.sefn].3) the natural map H0(Ysn,F')  →  H0(Ysn,F) is an injection.

We usually think of [formula] as an OS-submodule of H0(Ysn,Fsn).

Note also that every φX∈H0(X,E) defines a global section of F over [formula] by setting φi: = fi(p*iφX). Thus we have natural maps

[formula]

We can now define a notion of continuous closure of sheaves. A justification of the definition will be given only later in ([\ref=mydef=brdef]).

Let X be a pure dimensional, reduced, affine scheme over a field of characteristic 0 and J a torsion free coherent sheaf on X. One can realize J as the image of a map between locally free shaves f:E  →  F. Let [formula] be the corresponding descent problem. Define the continuous closure of J as

[formula]

We see later ([\ref=cl.indep.say]) that JC does not depend on the choice of f:E  →  F.

The above definition is purely algebraic but it does not connect with continuity in any obvious way. Actually, for base fields that are not naturally subfields of [formula], it is not even clear what continuity should mean. This is the question we consider next.

Classes of continuous functions

Here we describe various classes of functions where out proof works.

Here are some natural examples satisfying the assumptions ([\ref=function.classes.ass].1-7). Let us start with the cases when [formula].

Let [formula] denote all continuous functions on [formula].

Let [formula] denote all locally Hölder continuous functions on [formula].

Let S0(X) be the sheaf of [formula]-valued continuous semi-algebraic functions on [formula], viewed as a real algebraic variety. (If [formula], we identify [formula] with [formula] and view [formula] as a real variety. A function on [formula] is semi-algebraic iff its graph is semi-algebraic, that is, a finite union of sets defined by polynomial inequalities of the form f  ≥  0.) See [\cite=bcr] for details and proofs of the properties ([\ref=function.classes.ass].1-7). (Let me just note that ([\ref=function.classes.ass].4) is more interesting than it sounds. For instance, on the Whitney umbrella [formula] not every Zariski dense open set is Euclidean dense.)

I do not know how to generalize the first two of these in case k is not embedded into [formula], but the third variant can be extended to any characteristic 0 field.

Let [formula] be a real closed field, [formula] and assume that [formula]. Let [formula] be the sheaf of [formula]-valued continuous semi-algebraic functions on [formula], viewed as an [formula]-variety. (See [\cite=bcr] for details.)

I do not know any examples in positive characteristic.

Finitely determined descent problems

The notion of a finitely determined descent problem ([\ref=desc.prob.efn].5) admits an obvious generalization to the C*-valued case. We also need the following more general version.

Let [formula] be a descent problem and Z  ⊂  X a closed algebraic subvariety. [formula] is called finitely determined relative to Z if for every [formula] that vanishes on p- 1(Z) the following are equivalent

There is a [formula] such that [formula].

For every finite subset [formula] there is a [formula] such that [formula] for [formula].

We see in ([\ref=wronsk.lem]) that these are also equivalent to the following precise form:

The above (2) holds for all [formula].

Although ([\ref=findet.defn].2) asks about all possible finite sets of points in Y, the conditions imposed by points in different fibers of p are independent. Thus the only interesting case is when all the yi are in the same fiber. Working in a fiber, we have a general abstract test.

Let Y be a set and [formula] functions on Y with values in a field K. Assume that the fi are linearly independent. Then the following are equivalent.

φ is a linear combination of the fi.

For every r + 1 points [formula] there are [formula] (possibly depending on the yi) such that [formula] for [formula].

The following determinant is identically zero as a function on Yr + 1.

[formula]

Proof. Since the fi are linearly independent, there are [formula] such that the upper left r  ×  r subdeterminant above is nonzero. Fix these [formula] and solve the linear system

[formula]

Replace φ by [formula] and let yr + 1 vary. Then our determinant is

[formula]

The whole determinant vanishes iff ψ(yr + 1) is identically zero. That is, when [formula].

If a descent problem is not finitely determined, we can still study the conditions imposed by ([\ref=findet.defn].2). This leads to the following definition.

Given a descent problem [formula], let [formula] denote all 0-dimensional scions and [formula] itself. We can now define

[formula]

as the collection of sections [formula] (resp. [formula]) that satisfy the compatibility conditions as in ([\ref=scion.sect.defn]) where now Yi runs through only the scions in [formula].

Thus [formula] is finitely determined iff

[formula]

An advantage of [formula] is that it can be easily computed algebraically.

This implies important functoriality properties of [formula], but first we need a definition.

Let [formula] be a descent problem over a base field k. We consider two ways of obtaining new descent problems by base change.

First, every field extension k'  ⊃  k gives a descent problem over k'

[formula]

Second, let b:X0  →  X be a flat, finite type morphism with reduced fibers. Let Y be a reduced scheme and p:Y  →  X a morphism. Then bY:Y': = X'  ×  XY  →  Y is flat with reduced fibers, hence Y' is also reduced. Thus

[formula]

is also a descent problem. All the constructions in ([\ref=rel.desc.prob.sefn]) commute with pull-back by flat morphisms with reduced fibers. Thus we get a pull-back map [formula].

Note that it is not obvious that there is a pull-back map [formula]. (Indeed, [formula] has scions that are not pulled-back from [formula] and these could pose additional restrictions on sections.) We see in ([\ref=faithful=isom]) that such problems do not arise.

Let X be an affine scheme of finite type over a field and [formula] a descent problem. Then the formation of [formula] commutes with flat, seminormal base changes and with base field extensions.

Proof. Note that in ([\ref=exact.seq.say]) the formation of the Xi and Qi commutes with flat, seminormal base changes and with base field extensions. Using ([\ref=exact.seq.say].4), this implies that [formula] also commutes with flat, seminormal base changes and with base field extensions.

The main theorem and its consequences

Let [formula] be a property of descent problems. Let [formula] be a descent problem over a field k. We say that [formula] is universally [formula] if [formula] satisfies [formula] for every base field extension k'  ⊃  k followed by any flat, finite type, seminormal base change b:X'k'  →  Xk'.

The main technical result of this note is the following.

Let [formula] be a descent problem over a field of characteristic 0. Then it has a universally finitely determined scion [formula] whose structure map rs:Ys  →  Y is surjective.

Before giving a proof, let us consider some consequences. First we have the following property, which was the very reason for our definition of scions.

Let [formula] be a descent problem over a field of characteristic 0. Assume that C* satisfies the properties ([\ref=function.classes.ass].1-7). Then

[formula]

Proof. Note that, by ([\ref=basic.props].2), the containment

[formula]

always holds. To see the converse, let [formula] be a finitely determined scion of [formula] whose structure map rs:Ys  →  Y is surjective. We have the obvious inclusions

[formula]

and

[formula]

since [formula] is finitely determined. Note further that C*(X,E)  →  C*(Ys,Fs) factors through C*(Y,F) and through [formula]. Since the structure map rs:Ys  →  Y is surjective, C*(Y,F)  →  C*(Ys,Fs) is injective. These show that

[formula]

We can now see that the 2 definitions of the continuous closure, ([\ref=cc.2.defn]) and the obvious generalization of ([\ref=cc.1.defn]), agree with each other.

Let X be a reduced affine scheme over a field of characteristic 0 and f:E  →  F a map between locally free sheaves. Set [formula], as a subsheaf of F. Then

[formula]

Proof. By definition, [formula] and, by ([\ref=basic.props].3),

[formula]

By ([\ref=main.thm.v1]), [formula].

As another consequence, we obtain that global sections of scions are unchanged by surjective structure maps. Note that we use the invariance of continuous sections to derive the invariance of algebraic sections.

Let [formula] be a descent problem over an affine base X over a field of characteristic 0. Let [formula] be a scion of [formula] whose structure map rs:Ys  →  Y is surjective. Then the restriction maps

[formula]

are isomorphism.

Proof. Since rs is surjective, the restriction maps are injective. By ([\ref=main.thm.v1]), [formula] is surjective and it factors through [formula]. Thus the restriction map is surjective with C*-coefficients.

The algebraic case also follows once we prove that if [formula] and its restriction to Ys is algebraic then φ itself is algebraic. This is a local question on Y, hence we need to show that if φ∈C*(Y) and r*sφ is a regular function then φ is a regular function on Ysn. We can view φ as a morphism to [formula]; let Y' be its image. Since Ys  →  Y is proper, Y'  →  Y is proper and Y'K  →  YK is a homeomorphism. Thus Y' is dominated by the seminormalization.

The next result is an important invariance property of global sections of descent problems.

Let X be an affine scheme of finite type over a field of characteristic 0 and [formula] a descent problem. Then taking algebraic global sections of [formula] commutes with base field extensions and with flat, seminormal base changes.

In particular, taking the continuous closure commutes with base field extensions and with flat, seminormal base changes.

Proof. By ([\ref=main.thm.v0]), [formula] has a universally finitely determined scion [formula] whose structure map rs:Ys  →  Y is surjective.

By ([\ref=faithful=isom]),

[formula]

and the equality continues to hold after every base change. Thus it is sufficient to prove ([\ref=flat.commute.thm]) in case [formula] is universally finitely determined. For such descent problems

[formula]

and we saw in ([\ref=flat.commute.cor]) that [formula] commutes with base field extensions and with flat, seminormal base changes.

Since open embeddings are flat with seminormal fibers, we can sheafify the notion of continuous closure.

Let [formula] be a descent problem. By ([\ref=flat.commute.thm]), as [formula] runs through all affine open subsets, the rule

[formula]

defines a coherent sheaf in the Zariski topology, denoted by

[formula]

and called the push forward of [formula].

As in ([\ref=scion.sect.defn].1), there are natural maps

[formula]

Finally, let us see that the definition ([\ref=cc.2.defn]) is independent of the auxiliary choices.

The continuous closure is independent of the choice of f:E  →  F.

Proof. Pick f:E  →  F such that [formula]. Composing a surjection E'  →  E and an injection [formula], we get another map f':E'  →  F' such that [formula]. We get two descent problems, [formula] and [formula]. We claim that

[formula]

This follows from ([\ref=main.thm.v1]) and the obvious maps

[formula]

Proof of Theorem [\ref=main.thm.v0]

In order to get an idea of the proof, assume first that X,Y are normal and let Y  →  W  →  X denote the Stein factorization. We first study which sections over Y descend to W and then try to descend them to X.

If we look over a single point w∈W, the the question is answered by ([\ref=wronsk.lem]). Working in our family, this means passing from Y  →  W to the (n + 1)-fold fiber product [formula]. The fiber product can be rather singular in general, so this will work only over a dense open subset of W.

Going from W to X is easy if we work locally analytically. In this case W  →  X is a local isomorphism over an open subset of W, thus every question over W can be rewritten as a question over X. This will not work well algebraically, but there are no problems if W  →  X is Galois.

The point of ([\ref=red.step.main.2]) is to show that by passing to a suitable scion, the above considerations apply, at least over a dense open subset of X.

Then we finish by a straightforward dimension induction ([\ref=pf.of.main.thm]).

Let [formula] be a descent problem. Then there is a closed algebraic subvariety Z  ⊂  X with dim Z <  dim X and a scion [formula] with surjective structure map :  →  Y and with the following properties.

Let [formula] be the irreducible components. For every i∈I let i  ⊂   be the closure of [formula] and i the restriction of [formula] to i. Then, for every i∈I,

a finite group Gi acts on i,

there is a Gi-equivariant factorization [formula],

over [formula], the map w̃i:W̃i  →  Xi is finite and Galois with group Gi,

there is a Gi-equivariant quotient bundle w̃*iE  →  Ẽi such that i factors as [formula].

Proof. We may harmlessly assume that p(Y) is dense in X.

After we construct [formula], the plan is to make sure that Z contains all of its "singular" points. In the original setting Z is the set where the map [formula] has rank 0. In the general case, we need to include points over which [formula] drops rank and also points over which p̃ drops rank. During the proof we gradually add more and more irreducible components to Z as needed.

Step 0. To start with, we add to Z the locus where X is not normal and the p(Yj) where Yj  ⊂  Y is an irreducible component that does not dominate any of the irreducible components of X. In the conclusions, the different i have no effect on each other, hence we can work with them one at a time. We construct each i separately, and then let [formula] be the disjoint union of the i for i∈I and of [formula].

For simplicity of notation, we drop the index i. We thus assume that X is irreducible and every irreducible component of Y dominates X. We may assume that Y is normal, take the Stein factorization [formula] and set m =  deg (W / X). In several steps we construct the following diagram

[formula]

Step 1: Constructing W(m)X and its column.

Let s:W  →  X be a finite morphism of (possibly reducible) varieties.

Consider the m-fold fiber product [formula] with coordinate projections πi:WmX  →  W. For every i  ≠  j, let Δij  ⊂  WmX be the preimage of the diagonal Δ  ⊂  W  ×  XW under the map (πi,πj). Let W(m)X  ⊂  WmX be the union of the dominant components in the closure of [formula] with projection s(m):W(m)X  →  X. The symmetric group Sm acts on W(m)X by permuting the factors.

Let X0  ⊂  X be the largest Zariski open subset over which s is smooth. If x∈X0 then [formula] consists of ordered m-element subsets of s- 1(x), thus Sm acts transitively on [formula] if |s- 1(x)| = m.

Let now p:Y  →  X be as above with Stein factorization [formula]. Let YmX denote the m-fold fiber product [formula] with coordinate projections πi:YmX  →  Y.

Let Y(m)X  ⊂  YmX denote the dominant parts of the preimage of W(m)X under the natural map qm:YmX  →  WmX with projection p(m):Y(m)X  →  X. Note that, for general x∈X, Sm acts transitively on the irreducible components of [formula].

Let F be a locally free sheaf on Y. Then [formula] is a locally free sheaf on YmX. Its restriction to Y(m)X is denoted by F(m).

The Sm-action on Y(m)X naturally lifts to an Sm-action on F(m). From f:p*E  →  F we get an Sm-invariant map of locally free sheaves [formula]. For each m we get a scion of [formula]

[formula]

Step 2: Constructing (m)X and its column.

More generally, let [formula] be a descent problem. (Note that the base is W instead of X.) Assume that W is irreducible. Consider the coherent sheaf [formula].

Let Gr(d,E)  →  W be the universal Grassmann bundle of rank d quotients of E where d is the rank of E' at a general point. At a general point w∈W, [formula] is such a quotient. Thus E' gives a rational map [formula], defined on a dense open subset. Let   ⊂  Gr(d,E) denote the closure of its image and t:  →  W the projection. Then t is a proper birational morphism and we have a decomposition

[formula]

where Ē is a locally free sheaf of rank d on [formula], s is a rank d surjection everywhere and j is a rank d injection on a dense open subscheme.

Applying this to [formula], with W(m)X playing the role of the base, we obtain (m).

Step 3: Constructing W̃(m)X and its column.

More generally, let [formula] be a descent problem. Assume that W and the generic fiber of q are irreducible and E  →  q*F is an injection. We construct a scion

[formula]

with surjective structure map such that [formula] is an isomorphism.

Set [formula] and let Yn + 1W be the union of the dominant components of the n + 1-fold fiber product of Y  →  W with coordinate projections πi. Let :Yn + 1W  →  W be the map given by any of the [formula]. Consider the diagonal map

[formula]

which is an injection over a dense open set Y0  ⊂  Yn + 1W by assumption. Using ([\ref=rel.desc.prob.sefn].3) we can replace [formula] by *E.

Applying this to (m) we obtain (m).

Let [formula] be a descent problem and Z  ⊂  X a closed algebraic subvariety. Let [formula] be the irreducible components and assume that [formula] for every i  ≠  j. Let i  ⊂  Y be the closure of [formula] and i the restriction of [formula] to i. Assume that for every i ([\ref=red.step.main.2].1-4) hold.

Then [formula] is finitely determined relative to Z.

Proof. Let ΨY∈C*(Y,F) be a section that vanishes on p- 1(Z) such that ([\ref=findet.defn].2) holds. We can uniquely write [formula] where [formula]. It is thus enough to write [formula] for each i. For a fixed i, we need to do this over Xi and then extend ψi,X to X by setting it zero on the complement. Thus it is sufficient to work with one i at a time.

Using the isomorphism [formula], Ψi can be identified with a section Ψ̃i of *iẼi. The conditions ([\ref=findet.defn].2) now imply that Ψ̃i is constant on the fibers of i  →  W̃i and is Gi-invariant. Thus Ψ̃i is the pull-back of a Gi-invariant section Ψ̃W,i of Ẽi that vanishes on the preimage of Z. Using a Gi-invariant C*-splitting of [formula] we can think of Ψ̃W,i as a Gi-invariant section of w̃*iE. Therefore Ψ̃W,i descends to a section [formula] that vanishes on Z.

Princeton University, Princeton NJ 08544-1000