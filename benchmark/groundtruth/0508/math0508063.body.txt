Theorem Proposition Lemma Corollary Conjecture

Definition Problem Example Question Dichotomy

Long arithmetic progressions of primes

introduction and history

This is a description of recent work of the author and Terence Tao [\cite=green-tao-primes] on primes in arithmetic progression. It is based on seminars given for a general mathematical audience in a variety of institutions in the UK, France, the Czech Republic, Canada and the US.

Perhaps curiously, the order of presentation is much closer to the order in which we discovered the various ingredients of the argument than it is to the layout in [\cite=green-tao-primes]. We hope that both expert and lay readers might benefit from contrasting this account with [\cite=green-tao-primes] as well as the expository accounts by Kra [\cite=Kra] and Tao [\cite=taosurvey1] [\cite=taosurvey2].

As we remarked, this article is based on lectures given to a general audience. It was often necessary, when giving these lectures, to say things which were not strictly speaking true for the sake of clarity of exposition. We have retained this style here. However, it being undesirable to commit false statements to print, we have added numerous footnotes alerting readers to points where we have oversimplified, and directing them to places in the literature where fully rigorous arguments can be found.

Our result is:

The primes contain arbitrarily long arithmetic progressions.

Let us start by explaining that the truth of this statement is not in the least surprising. For a start, it is rather easy to write down a progression of five primes (for example 5,11,17,23,29), and in 2004 Frind, Jobling and Underwood produced the example

[formula]

of 23 primes in arithmetic progression. A very crude heuristic model for the primes may be developed based on the prime number theorem, which states that π(N), the number of primes less than or equal to N, is asymptotic to N /  log N. We may alternatively express this as

[formula]

Consider now the collection of all arithmetic progressions

[formula]

with [formula]. Select x and d at random from amongst the N2 possible choices, and write Ej for the event that x  +  jd is prime, for [formula]. The prime number theorem tells us that

[formula]

If the events Ej were independent we should therefore have

[formula]

We might then conclude that

[formula]

For fixed k, and in fact for k nearly as large as 2 log N /  log  log N, this is an increasing function of N. This suggests that there are infinitely many k-term arithmetic progressions of primes for any fixed k, and thus arbitrarily long such progressions.

Of course, the assumption that the events Ej are independent was totally unjustified. If E0,E1 and E2 all hold then one may infer that x is odd and d is even, which increases the chance that E3 also holds by a factor of two. There are, however, more sophisticated heuristic arguments available, which take account of the fact that the primes >  q fall only in those residue classes [formula] with a coprime to q. There are very general conjectures of Hardy-Littlewood which derive from such heuristics, and a special case of these conjectures applies to our problem. It turns out that the extremely naïve heuristic we gave above only misses the mark by a constant factor:

For each k we have

[formula]

where

[formula]

is a certain product of "local densities" which is rapidly convergent and positive.

We have

[formula]

In particular we compute

[formula]

and

[formula]

What we actually prove is a somewhat more precise version of Theorem [\ref=mainthm1], which gives a lower bound falling short of the Hardy-Littlewood conjecture by just a constant factor.

For each [formula] there is a constant γ'k  >  0 such that

[formula]

for all N  >  N0(k).

The value of γ'k we obtain is very small indeed, especially for large k.

Let us conclude this introduction with a little history of the problem. Prior to our work, the conjecture of Hardy-Littlewood was known only in the case k  =  3, a result due to Van der Corput [\cite=van-der-corput] (see also [\cite=chowla]) in 1939. For [formula], even the existence of infinitely many k-term progressions of primes was not previously known. A result of Heath-Brown from 1981 [\cite=heath-brown1] comes close to handling the case k  =  4; he shows that there are infinitely many 4-tuples q1  <  q2  <  q3  <  q4 in arithmetic progression, where three of the qi are prime and the fourth is either prime or a product of two primes. This has been described as "infinitely many [formula]-term arithmetic progressions of primes".

the relative szemerédi strategy

A number of people have noted that [\cite=green-tao-primes] manages to avoid using any deep facts about the primes. Indeed the only serious number-theoretical input is a zero-free region for ζ of "classical type", and this was known to Hadamard and de la Vallée Poussin over 100 years ago. Even this is slightly more than absolutely necessary; one can get by with the information that ζ has an isolated pole at 1 [\cite=taonotes1].

Our main advance, then, lies not in our understanding of the primes but rather in what we can say about arithmetic progressions. Let us begin this section by telling a little of the story of the study of arithmetic progressions from the combinatorial point of view of Erds and Turán [\cite=erdos-turan].

Fix an integer [formula]. We define rk(N) to be the largest cardinality of a subset [formula] which does not contain k distinct elements in arithmetic progression.

Erds and Turán asked simply: what is rk(N)? To this day our knowledge on this question is very unsatisfactory, and in particular we do not know the answer to

Is it true that rk(N)  <  π(N) for N  >  N0(k)?

If this is so then the primes contain k-term arithmetic progressions on density grounds alone, irrespective of any additional structure that they might have. I do not know of anyone who seriously doubts the truth of this conjecture, and indeed all known lower bounds for rk(N) are much smaller than π(N). The most famous such bound is Behrend's assertion [\cite=behrend] that

[formula]

slightly superior lower bounds are known for rk(N), [formula] (cf. [\cite=laba-lacey] [\cite=rankin]).

The question of Erds and Turán became, and remains, rather notorious for its difficulty. It soon became clear that even seemingly modest bounds should be regarded as great achievements in combinatorics. The first really substantial advance was made by Klaus Roth, who proved

We have r3(N)  ≪  N( log  log N)- 1.

The key feature of this bound is that log  log N tends to infinity with N, albeit slowly. This means that if one fixes some small positive real number, such as 0.0001, and then takes a set [formula] containing at least 0.0001N integers, then provided N is sufficiently large this set A will contain three distinct elements in arithmetic progression.

The generalisation of this statement to general k remained unproven until Szemerédi clarified the issue in 1969 for k  =  4 and then in 1975 for general k. His result is one of the most celebrated in combinatorics.

We have rk(N)  =  o(N) for any fixed [formula].

Szemerédi's theorem is one of many in this branch of combinatorics for which the bounds, if they are ever worked out, are almost unimaginably weak. Although it is in principle possible to obtain an explicit function ωk(N), tending to zero as N  →    ∞  , for which

[formula]

to my knowledge no-one has done so. Such a function would certainly be worse than 1 /  log *N (the number of times one must apply the log function to N in order to get a number less than 2), and may even be slowly-growing compared to the inverse of the Ackermann function.

The next major advance in the subject was another proof of Szemerédi's theorem by Furstenberg [\cite=furst]. Furstenberg used methods of ergodic theory, and his argument is relatively short and conceptual. The methods of Furstenberg have proved very amenable to generalisation. For example in [\cite=bergelson-leibman] Bergelson and Leibman proved a version of Szemerédi's theorem in which arithmetic progressions are replaced by more general configurations [formula], where the pi are polynomials with [formula] and pi(0)  =  0. A variety of multidimensional versions of the theorem are also known. A significant drawback of Furstenberg's approach is that it uses the axiom of choice, and so does not give any explicit function ωk(N).

Rather recently, Gowers [\cite=gowers4] [\cite=gowers] made a major breakthrough in giving the first "sensible" bounds for rk(N).

Let [formula] be an integer. Then there is a constant ck  >  0 such that

[formula]

This is still a long way short of the conjecture that rk(N)  <  π(N) for N sufficiently large. However, in addition to coming much closer to this bound than any previous arguments, Gowers succeeded in introducing methods of harmonic analysis to the problem for the first time since Roth. Since harmonic analysis (in the form of the circle method of Hardy and Littlewood) has been the most effective tool in tackling additive problems involving the primes, it seems fair to say that it was the work of Gowers which first gave us hope of tackling long progressions of primes. The ideas of Gowers will feature fairly substantially in this exposition, but in our paper [\cite=green-tao-primes] much of what is done is more in the ergodic-theoretic spirit of Furstenberg and of more recent authors in that area such as Host-Kra [\cite=host-kra] and Ziegler [\cite=ziegler].

To conclude this discussion of Szemerédi's theorem we mention a variant of it which is far more useful in practice. This applies to functions [formula] rather than just to (characteristic functions of) sets. It also guarantees many arithmetic progressions of length k. This version does, however, follow from the earlier formulation by some fairly straightforward averaging arguments due to Varnavides [\cite=varnavides].

Let [formula] be an integer, and let δ∈(0,1] be a real number. Then there is a constant c(k,δ)  >  0 such that for any function [formula] with [formula] we have the bound

[formula]

We do not, in [\cite=green-tao-primes], prove any new bounds for rk(N). Our strategy is to prove a relative Szemerédi theorem. To describe this we consider, for brevity of exposition, only the case k  =  4. Consider the following table.

On the left-hand side of this table is Szemerédi's theorem for progressions of length 4, stated as the result that a set [formula] of density 0.0001 contains many 4-term APs if N is large enough. On the right is the result we wish to prove. Only one thing is missing: we must find an object to play the rôle of [formula]. We might try to place the primes inside some larger set P'N in such a way that [formula], and hope to prove an analogue of Szemerédi's theorem for P'N.

A natural candidate for P'N might be the set of almost primes; perhaps, for example, we could take P'N to be the set of integers in [formula] with at most 100 prime factors. This would be consistent with the intuition, coming form sieve theory, that almost primes are much easier to deal with than primes. It is relatively easy to show, for example, that there are long arithmetic progressions of almost primes [\cite=grosswald].

This idea does not quite work, but a variant of it does. Instead of a set P'N we instead consider what we call a measure [formula]. Then there is c(α,η)  >  0 with the following propety. Let [formula] be a function with [formula] and such that [formula] for all [formula], and suppose that

[formula]

Then

[formula]

for some [formula].

This may be applied with [formula] and α  =  1  +  o(1). Now, however, condition [\eqref=eq44a] does not so obviously hold. In fact, one has the estimate

[formula]

To prove this requires more than simply the good distribution of [formula] in residue classes to small moduli. It is, however, a fairly standard consequence of the Hardy-Littlewood circle method as applied to primes by Vinogradov. In fact, the whole theme of linear bias in the context of additive questions involving primes may be traced back to Hardy and Littlewood.

Proposition [\ref=primes-3-dichotomy-2] and [\eqref=eq44b] imply that [formula]. Thus there are infinitely many three-term progressions in the modified (W-tricked) primes, and hence also in the primes themselves.

progressions of length four and quadratic bias

We return now to the discussion of § [\ref=sec3]. There we were interested in counting 3-term arithmetic progressions in a set A  ⊆  G with cardinality αN. In this section our interest will be in 4-term progressions.

Suppose then that A  ⊆  G is a set, and recall that

[formula]

is the normalised count of four-term arithmetic progressions in A. One may, of course, ask the analogue of Question [\ref=ques3.1]:

Let α∈(0,1), and suppose that A  ⊆  G is a set with cardinality αN. What is T4(A)?

Examples 1,2 and 3 make perfect sense here, and we see once again that there is no immediately satisfactory answer to Question [\ref=ques4.1]. With high probability the random set of Example 1 has about E4(α): = α4 four-term APs, but there are structured sets with with substantially more or less than this number of APs. As in § [\ref=sec3], these examples are consistent with a dichotomy of the following type:

Taking into account the three examples we have so far, it is quite possible that this dichotomy takes exactly the form of that for 3-term APs. That is to say "A has structure" could just mean that A has linear bias:

Let α,η∈(0,1). Suppose that A  ⊆  G is a set with |A|  =  αN, and that

[formula]

Must there exist some c  =  c(α,η)  >  0 and some character γ∈Ĝ with the property that

[formula]

That the answer to this question is no, together with the nature of the counterexample, is one of the key themes of our whole work. This phenomenon was discovered, in the context of ergodic theory, by Furstenberg and Weiss [\cite=furst-weiss] and then again, in the discrete setting, by Gowers [\cite=gowers].

Example 4 (Quadratically structured set). Define [formula] to be the set of all x such that x2∈[ -   αN  /  2,αN  /  2]. It is not hard to check using estimates for Gauss sums that |A|  ≈  αN, and also that

[formula]

that is to say A does not have linear bias. (In fact, the largest Fourier coefficient of 1A  -  α is just N- 1 / 2  +  ε.) Note, however, the relation

[formula]

valid for arbitrary [formula]. This means that if x,x + d,x + 2d∈A then automatically we have

[formula]

It seems, then, that if we know that x,x + d and x  +  2d lie in A there is a very high chance that x  +  3d also lies in A. This observation may be made rigorous, and it does indeed transpire that [formula].

How can one rescue the randomness-structure dichotomy in the light of this example? Rather remarkably, "quadratic" examples like Example 4 are the only obstructions to having T4(A)  ≈  E4(α). There is an analogue of Proposition [\ref=3-dichotomy] in which characters γ are replaced by "quadratic" objects.

Let α,η∈(0,1). Then there is c(α,η)  >  0 with the following property. Suppose that A  ⊆  G is a set with |A|  =  αN, and that

[formula]

Then there is some quadratic object q∈Q(κ), where [formula], with the property that

[formula]

We have not, of course, said what we mean by the set of quadratic objects Q(κ). To give the exact definition, even for [formula], would take us some time, and we refer to [\cite=green-tao-gowersu3] for a full discussion. In the light of Example 4, the reader will not be surprised to hear that quadratic exponentials such as q(x)  =  e(x2 / N) are members of Q. However, Q(κ) also contains rather more obscure objects such as

[formula]

and

[formula]

where {x} denotes fractional part. The parameter κ governs the complexity of the expressions which are allowed: smaller values of κ correspond to more complicated expressions. The need to involve these "generalised" quadratics in addition to "genuine" quadratics such as e(x2 / N) was first appreciated by Furstenberg and Weiss in the ergodic theory context, and the matter also arose in the work of Gowers.

quadratic bias and the primes

It is possible to prove a version of Proposition [\ref=4-dichotomy] which might be applied to primes. The analogue of Proposition [\ref=primes-3-dichotomy] is true but not useful, for the same reason as before: the primes exhibit significant bias in residue classes to small moduli. As before, this bias may be removed using the W-trick.

Let α,η∈(0,2]. Then there are c(α,η) and κ0(α,η)  >  0 with the following propety. Let [formula] be a function with [formula] and such that [formula] for all [formula], and suppose that

[formula]

Then we have

[formula]

for some quadratic object q∈Q(κ) with [formula].

One is interested, of course, in applying this with [formula]. If we could verify that [\eqref=eq44d] does not hold, that is to say the primes do not have quadratic bias, then it would follow that [formula]. This means that the modified (W-tricked) primes have many 4-term progressions, and hence so do the primes themselves.

One wishes to show, then, that for fixed κ one has

[formula]

Such a result is certainly not a consequence of the classical Hardy-Littlewood circle method. Generalised quadratic phases such as [formula] are particularly troublesome. Although we do now have a proof of [\eqref=lam-quad], it is very long and complicated. See [\cite=green-tao-u3mobius] for details.

In the next section we explain how our original paper [\cite=green-tao-primes] managed to avoid the need to prove [\eqref=lam-quad].

quotienting out the bias - the energy increment argument

Our paper [\cite=green-tao-primes] failed to rule out the possibility that [formula] correlates with some quadratic function q∈Q(κ). For that reason we did not obtain a proof of Conjecture [\ref=hlconj], getting instead the weaker statement of Theorem [\ref=gtthm]. In this section we outline the energy increment argument of [\cite=green-tao-primes], which allowed us to deal with the possibility that [formula] does correlate with a quadratic.

We begin by writing

[formula]

Proposition [\ref=primes-4-dichotomy-2] tells us that [formula], unless f0 correlates with some quadratic q0∈Q. Suppose, then, that

[formula]

Then we revise the decomposition [\eqref=step0] to

[formula]

where F1 is a function defined using q0. In fact, F1 is basically the average of [formula] over approximate level sets of q0. That is, one picks an appropriate scale ε  =  1 / J, and then defines

[formula]

where B0 is the σ-algebra generated by the sets x:q0(x)∈[null] be a real number and let ν be a psuedorandom measure. Then there is a constant c'(4,δ)  >  0 with the following property. Suppose that [formula] is a function such that [formula] pointwise, and for which [formula]. Then we have the estimate

[formula]

In [\cite=green-tao-primes] we prove the same theorem for progressions of any length [formula].

Proposition [\ref=prop7] captures the spirit of our argument quite well. We first deal with arithmetic progressions in a rather general context. Only upon completion of that study do we concern ourselves with the primes, and this is simply a matter of constructing an appropriate pseudorandom measure. Note also that Szemerédi's theorem is used as a "black box". We do not need to understand the proof of it, or to have good bounds for it.

Observe that one consequence of Proposition [\ref=prop7] is a Szemerédi theorem relative to the primes: any subset of the primes with positive relative density contains progressions of arbitrary length. Applying this to the set of primes congruent to [formula], we see that there are arbitrarily long progressions of numbers which are sums of two squares.

soft obstructions

Readers familiar with [\cite=green-tao-primes] may have been confused by our exposition thus far, since "quadratic objects" play essentially no rôle in that paper. The purpose of this brief section is to explain why this is so, and to provide a bridge between this survey and our paper. Further details and discussion may be found in [\cite=green-tao-primes].

Let us start by recalling § [\ref=sec3], where a set of "obstructions" to a set A  ⊆  G having roughly E3(α) three-term APs was obtained. This was just the collection of characters γ∈Ĝ, and we used the term linear bias to describe correlation with one of these characters.

Let [formula] be a function with [formula]. Now we observe the formula

[formula]

which may be verified by straightforward harmonic analysis on G. Coupled with the fact that

[formula]

a consequence of Parseval's identity, this means that the "dual function"

[formula]

can be approximated by the weighted sum of a few characters. Every character is actually equal to a dual function; indeed we clearly have [formula].

We think of the dual functions D2(f) as soft linear obstructions. They may be used in the iterative argument of § [\ref=sec7] in place of the genuinely linear functions, after one has established certain algebraic closure properties of these functions (see [\cite=green-tao-primes])

The great advantage of these soft obstructions is that it is reasonably obvious how they should be generalised to give objects appropriate for the study of longer arithmetic progressions. We define

[formula]

This is a kind of sum of f over parallelepipeds (minus one vertex), whereas D2(f) was a sum over parallelograms (minus one vertex). This we think of as a soft quadratic obstruction. Gone are the complications of having to deal with explicit generalised quadratic functions which, rest assured, only become worse when one deals with progressions of length 5 and longer.

The idea of using these soft obstructions came from the ergodic-theory work of Host and Kra [\cite=host-kra], where very similar objects are involved.

We conclude by emphasising that soft obstructions lead to relatively soft results, such as Theorem [\ref=gtthm]. To get a proof of Conjecture [\ref=hlconj] it will be necessary to return to generalised quadratic functions and their higher-order analogues.

acknowledgements

I would like to thank James Cranch for reading the manuscript and advice on using Mathematica, and Terry Tao for several helpful comments.