Lemma Corollary

The partial-fractions method for counting solutions to integral linear systems

Euler's generating function

We are interested in computing the number of integer solutions of the linear system

[formula]

where [formula] is a nonnegative (m  ×  d)-integral matrix and [formula]. We think of [formula] as fixed and study the number of solutions [formula] as a function of [formula]. (Strictly speaking, this function should only be defined for those [formula] which lie in the nonnegative linear span of the columns of [formula].)

The function [formula], often called a vector partition function, appears in a wealth of mathematical areas and beyond: Number Theory (partitions), Discrete Geometry (polyhedra), Commutative Algebra (Hilbert series), Algebraic Geometry (toric varieties), Representation Theory (tensor product multiplicities), Optimization (integer programming), as well as applications to Chemistry, Biology, Physics, Computer Science, and Economics.

Denote the columns of [formula] by [formula]. The following lemma goes back to at least Euler [\cite=euler]:

[formula] equals the coefficient of [formula] of the function

[formula]

expanded as a power series centered at [formula].

Expand each factor of the right-hand side into a geometric series.

Equivalently, the coefficient of [formula] in [formula] equals the constant term in [formula], denoted by [formula]. So Euler's Lemma can be conveniently stated as

[formula]

In a series of articles [\cite=tetrahed] [\cite=bdr] [\cite=beckpixton] [\cite=polygons], we used complex integration of [formula] to compute [formula] for special cases of [formula]. Similar techniques were applied in [\cite=lasserrezeron]. Here we expand [formula] into partial fractions to compute its constant term, and hence [formula]. This work constitutes in a sense a refinement of the complex-integration methods, with the advantage that it is more flexible and--more importantly--applicable for any integral linear system.

Vector partition functions

The nature of the counting function [formula] is given by the following theorem. A quasi-polynomial is a finite sum [formula] with coefficients [formula] that are functions of [formula] which are periodic in every component of [formula]. The degree of Q is the degree of the largest power [formula] appearing in Q. A matrix is unimodular if every square submatrix has determinant ±  1.

The function [formula] is a piecewise-defined quasi-polynomial in [formula] of degree [formula]. The regions of [formula] in which [formula] is a single quasi-polynomial are polyhedral, that is, they are defined by linear constraints. If [formula] is unimodular then [formula] is a piecewise-defined polynomial.

The unimodular case of this theorem is due to Dahmen and Micchelli [\cite=dahmenmicchelli].

The computation of both [formula] and the chamber complex consisting of the regions of quasi-polynomiality give rise to challenging problems. The most powerful technique for computing [formula] which we are aware of is due to Brion and Vergne [\cite=brionvergne]. (The methods described here are much more elementary.) The chamber complex is still much of a mystery. A promising approach can be found in [\cite=szenesvergne].

We finish this section with a reciprocity theorem. Let [formula] count the integer solutions of

[formula]

Both [formula] and [formula] are quasi-polynomials, and can hence be algebraically defined for arguments which are not integer vectors in the positive span of [formula]. The following identity shows the close relationship between the two functions.

The quasi-polynomials [formula] and [formula] satisfy

[formula]

This identity gives rise to a symmetry property of [formula]. Let rk denote the sum of the entries in the [formula] row of [formula], and let [formula]. Then the integer solutions of

[formula]

are in bijection (via xk  ↦  xk - 1) with the integer solutions of

[formula]

and hence [formula]. This yields:

The quasi-polynomial [formula] satisfies

[formula]

The partial-fractions method

This section describes the idea behind our computations. Recall that our goal is to derive

[formula]

We start by expanding

[formula]

into partial fractions in one of the components of [formula], say z1:

[formula]

Here Ak and Bj are polynomials in z1, rational functions in [formula], and exponential in b1. (We are tacitly assuming that there are no multiple poles (besides [formula]), which generally holds unless m = 1, a case which can be handled easily.) The two sums on the right-hand side correspond to the analytic and the meromorphic part with respect to z1 = 0. The latter does not contribute to the z1-constant term, whence

[formula]

The effect of one partial fraction expansion is to eliminate one of the variables of the generating function, at the cost of replacing one rational function by a sum of such. The following idea is now evident.

The constant term of the remaining rational functions in the one variable zm can be computed with the methods introduced in [\cite=bdr]. This implies, in particular, that any vector partition function is a quasi-polynomial whose nontrivial ingredients are Fourier-Dedekind sums [\cite=bdr]. The constant-term computation for the last variable also explains the quasi-polynomial character of [formula], since in this last step roots of unity will appear, with the components of [formula] as exponents.

We note that this algorithm computes [formula] as a function of [formula], that is, it allows symbolic computation. Secondly, it is not very hard to deduce Sturmfels's Theorem [\ref=sturmthm] from this algorithm. What might be more important, however, is the fact that the constraints which define the regions of quasi-polynomiality of [formula] are obtained "on the go" as one computes [formula]: When expanding into partial fractions, one has to check where the poles of a rational function are. The components of [formula] will appear (linearly) in the exponents of these rational functions, and hence one will automatically have to split the computation into cases which give rise to different regions in the chamber complex of quasi-polynomiality.

While we hope that our algorithm gives a computational tool, in particular, for obtaining the chamber complex defining the regions of quasi-polynomiality of a vector partition function, it is not clear to us why the chambers obtained from the partial fractions analysis coincide with Sturmfels's predicted chambers.

Our algorithm is best illustrated by going through an actual example.

An illustrating example

Let [formula], and write [formula], so [formula] counts the integer solutions of

[formula]

By Euler's Lemma [\ref=eulerlemma],

[formula]

We first expand into partial fractions with respect to w:

[formula]

Taking constant terms gives

[formula]

(At this point, we could interpret each of the three constant terms as counting integer solutions to new linear systems. For example, the last term gives the number of integer points (x,y)  ≥  0 satisfying 2x + y  ≤  a. To keep a general flavor, we continue with our general algorithm.)

We compute the constant term of each of the three terms separately. For starters,

[formula]

if b - a + 1  >  0, equivalently (since a and b are integers) b  ≥  a. If b < a, we use

[formula]

which gives

[formula]

Incidentally, this identity is true not only for b < a, but also for b = a and b = a + 1, because the right-hand side vanishes then. This suggests that the regions of quasi-polynomiality overlap, as was proved by Szenes and Vergne [\cite=szenesvergne]. Hence for the first constant term, we obtain

[formula]

For the second term in ([\ref=exparfrac]),

[formula]

if 2b - a + 2  ≥  0. If a  ≥  2b + 3 we expand into partial fractions again:

[formula]

Similar to the first constant-term computation, this identity is also valid for a = 2b + 2,2b + 1,2b, whence

[formula]

The computation for the last term in ([\ref=exparfrac]) is almost identical. (Note that this term always contributes.)

[formula]

Summing up all terms in ([\ref=exparfrac]) gives finally

[formula]

It is a fun exercise to show that [formula], as promised by Corollary [\ref=reccor].

We pause for a moment to introduce the geometry behind our linear system. By thinking of x3 and x4 as slack variables, we can see that

[formula]

is equivalent to

[formula]

Depending on the relationship between a and b, the geometric figure described by this linear system is a quadrilateral or triangle.

The inequalities which define the different cases for [formula] determine the chamber complex in the parameter space, and in this example also the combinatorial type of the polytope: Except for boundary cases, in the first (a  ≤  b) and last ([formula]) case, it is a triangle, and in the second case ([formula]) a quadrilateral. In fact, the geometry of the triangle in the first case only depends on a, which is reflected in [formula], and similarly the last case shows only dependency on b. In this last case, the triangle actually has integer vertices (the linear system is unimodular), whence we get a polynomial. In the first two cases the vertices of the polytope are half-integral, which is reflected in the period-2 quasi-polynomials. The following picture illustrates the three overlapping chambers.

Ehrhart quasi-polynomials

A convex polytope P in [formula] is the convex hull of finitely many points in [formula]. Alternatively (and this correspondence is nontrivial [\cite=ziegler]), one can define P as the bounded intersection of affine halfspaces. A polytope is rational if all of its vertices have rational coordinates. (A vertex of P is a point [formula] for which there is a hyperplane H such that [formula].) We denote by [formula] the relative interior of P. For a positive integer t, let L¶(t) denote the number of integer points ("lattice points") in the dilated polytope tP  =  {tx:x∈P}. The fundamental result about the structure of L¶ is as follows.

If P is a convex rational polytope, then the functions L¶(t) and [formula] are quasi-polynomials in t whose degree is the dimension of P. If P has integer vertices, then L¶ and [formula] are polynomials.

Ehrhart conjectured and partially proved the following reciprocity law, which was proved by Macdonald [\cite=macdonald].

The quasi-polynomials L¶ and [formula] satisfy

[formula]

The computation of Ehrhart quasi-polynomials is only slightly easier than that of [formula]. Recent work includes [\cite=barvinokehrhart] [\cite=brionvergne] [\cite=cappellshaneson] [\cite=chendcg02] [\cite=latte] [\cite=diazrobins] [\cite=guillemin] [\cite=kantorkhovanskii] [\cite=khovanskipukhlikov] [\cite=pommersheim].

Suppose the convex polytope [formula] is given by an intersection of halfspaces, that is,

[formula]

for some (m  ×  d)-matrix [formula] and m-dimensional vector [formula]. We may convert these inequalities into equalities by introducing slack variables. If P has rational vertices, we can choose [formula] and [formula] in such a way that all their entries are integers, without loss of generality nonnegative ones. In summary, we may assume that a convex rational polytope P is given by

[formula]

where [formula] and [formula]. (If we are interested in counting the integer points in P, we may assume that P is in the nonnegative orthant, i.e., the points in P have nonnegative coordinates, as translation by an integer vector does not change the lattice-point count.)

The connection to vector partition functions is now evident. Since [formula], we obtain [formula] as a special evaluation of [formula]. Note that [formula] lie in the same chamber of quasi-polynomiality of [formula]. Ehrhart's Theorem [\ref=quasi] is therefore a special case of Sturmfels's Theorem [\ref=sturmthm], and Theorem [\ref=rec] is a special case of Theorem [\ref=multirec].

As an example, the quadrilateral Q described by

[formula]

(a special case of the polygons appearing in Section [\ref=examplesec]) with vertices (0,0),(4,0),(3,1),(0,5 / 2) has the Ehrhart quasi-polynomial

[formula]

Ehrhart quasi-polynomials are easier to compute, since one does not need to derive/know the chamber complex of quasi-polynomiality of [formula]. Our algorithm, naturally, works just as well for L¶.

Concluding remarks

Many open problems and questions remain untouched. Most importantly, we hope that our ideas will give rise to practical implementations of computing vector partition functions (including the chamber complex defining the regions of quasi-polynomiality) in their various disguises in form of a computer software. Again, the partial-fraction method is more general and more flexible than algorithms using complex residues, for example in [\cite=beckpixton].

Not unrelated is the question of computational complexity. It is known that the rational generating function of the Ehrhart quasi-polynomial of a d-polytope can be computed in polynomial time if d is fixed [\cite=barvinokalgorithm]. We have not analyzed the complexity of our algorithm. This seems interesting in the light that our algorithm depends on the number of contraints, geometrically corresponding to the facets (codimension-1 faces) of the polytope. Barvinok's algorithm, in contrast, depends on the number of vertices of the polytope.

Another venue which should be explored is the following: After each step in our algorithm, one could reinterpret the constant term of each summand as counting integer solutions of a linear system. It might be interesting to simplify each of these linear systems (as far as this is possible without changing the number of integer solutions), and then proceed with the algorithm.