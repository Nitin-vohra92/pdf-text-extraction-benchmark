Corollary Proposition Lemma Assumption Remark Note Notes Example

=α =β =δ =ε =ε =φ =γ =ι =κ =λ =ω =ϱ =σ =ς =θ =ϑ =ζ =υ

=Δ =Γ =Λ =Ω =Θ

A quantum version of free energy - irreversible work relations

Wojciech De Roeck and Christian Maes Instituut voor Theoretische Fysica K.U.Leuven, Belgium.

Abstract: We give a quantum version of the Jarzynski relation between the distribution of work done over a certain time-interval on a system and the difference of equilibrium free energies. The main new ingredient is the identification of work depending on the quantum history of the system and the proper definition of various quantum ensembles over which the averages should be made. We also discuss a number of different regimes that have been considered by other authors and which are unified in the present set-up. In all cases, and quantum or classical, it is a general relation between heat and time-reversal that makes the Jarzynski relation so universally valid.

KEY WORDS: irreversible work, nonequilibrium processes, entropy production.

Introduction

Thermodynamic potentials such as the Helmholtz free energy are crucial in applications of thermodynamics. They give insight in what processes are a priori workable, with what effects and under what circumstances. Basically one is interested in two types of information. One is the expression of these potentials as a function of system-parameters. That determines the thermodynamic landscape and it yields the thermodynamic forces. A second type of information concerns the mutual relation between these potentials and the link with available work and entropy-energy transformations. For example, for a system that can extract heat from an environment at constant temperature T, the energy that is available to do work is exactly the free energy [formula], that is its energy V minus the heat term TS where S is the entropy of the system. Furthermore, to study its equilibrium properties we should maximize the total entropy (of system and reservoir) for a given energy contents but that again is equivalent with minimizing the free energy at fixed temperature.

If, as often happens, no very reliable computation of the free energy landscape can be made, the above provides immediate rescue. It suffices to measure the work done under isothermal conditions in changing the parameters of the system and it will be equal to the free energy difference. That however is only valid if the thermodynamic process involved is quasi-static. In other words, the changes must be done very slowly, a situation that cannot be hoped for in many cases. It was therefore very useful that an extended relation between free energy and work was proposed and exploited in a series of papers since the pioneering work of Jarzynski in 1997, [\cite=ja1]. That relation looks as follows:

[formula]

In the left-hand side ΔF is what we want to know, the difference in free energies between two equilibria with parameter values κf and κi. The right-hand side is an average over all possible paths that take the system in equilibrium for a certain parameter value κi in its initial Hamiltonian to a state where that parameter is changed into κf. The work done W depends on the path if the process is not adiabatic (i.e. without heat transfer) or if it is not quasi-static. The protocol, i.e. the sequence of forcing in the time-dependent Hamiltonian, is always kept fixed.

Derivations of the Jarzynski relation [\eqref=jar] have been made in various ways and in various approximations, see [\cite=Cro] [\cite=ja1] [\cite=ja2] [\cite=ja3] [\cite=ja4] [\cite=ja5] [\cite=MRV] [\cite=MN]. From such a relation free energy differences can be measured even in situations where the process of changing the parameters is not so well-controlled. That has already been experimentally realized in e.g. molecular systems [\cite=Hum] [\cite=Lip] [\cite=Rit].

A natural extension of [\eqref=jar] concerns the quantum regime. That appears possibly important and relevant when the system in question should be treated with the methods of quantum mechanics. In nano-devices the interplay between nanomechanics and thermodynamics becomes all important. Yet, a more fundamental reason to be interested in a quantum version of [\eqref=jar] is the question that it poses on the quantum nature of path-dependence. We enter here the domain of quantum mechanics on histories. It is a priori not clear how to define quantum mechanical work that depends on a path that the system has followed. In the present paper we derive a quantum extension of [\eqref=jar] where we explicitly deal with that path-dependence and where we start from a time-dependent unitary evolution on the level of the system plus environment.

Previous results

Various proposals for quantum extensions of the Jarzynski relation have appeared in the literature. We briefly bring up some aspects of such studies.

In [\cite=Tas] and following [\cite=Kur] one introduces the probabilities

[formula]

that the system is found in the α  -  th eigenstate φα of the Hamiltonian H at an initial time (when the system in in thermal equilibrium at inverse temperature β) and then is found in the α' - th eigenstate φα'' of the Hamiltonian H' at a later time. The operator U in [\eqref=probs] is the unitary operator for the time inhomogeneous evolution during the whole period. It is then an easy computation, done in [\cite=Tas], that

[formula]

That resembles [\eqref=jar] except for the important fact that the left-hand side averages over an exponential of a total (in time) energy difference. In particular there is no concept here of a path-dependent work. One interpretation is that the system in question is here really the total system (subsystem + heat bath) and one should follow the change in energy over the whole system. We think however that it is more useful to have a representation of work in terms of the coordinates (and history) of the subsystem only. After all, that is what free energies are all about thermodynamically. A second interpretation is that one thinks of the unitary evolution as working entirely on the subsystem itself and the heat bath is completely absent except for the inverse temperature β. That can be called the adiabatic regime and we return to it in Section [\ref=adi].

The presentation in [\cite=Muk] contains analogies both with what was described in [\cite=Cro] and with the adiabatic treatment of [\cite=Tas]. In [\cite=Cro] a derivation of [\eqref=jar] was given based on a time-inhomogeneous Markov process which satisfies, at each time, the detailed balance relation for some energy function. That can be lifted to the quantum regime when the Markov process is seen as an effective description of a quantum system in contact with a heat bath. For example, the quantum weak coupling limit exactly reproduces the classical Markov process as dynamics for the system when in the energy basis for the system Hamiltonian. In that precise sense, [\cite=Cro] was the first quantum extension of the Jarzynski relation. Here one deals with an effective dynamics of the subsystem and we turn to in in Section [\ref=mama].

Finally, in [\cite=Yuk] the question of path-dependence of the work is analyzed in an operator-setting and it is pointed out that various ambiguities remain in the ordering of the operators. These ambiguities only seem to disappear in a quasi-static limit which unfortunately, is exactly the regime we are less interested in. While it is in principle possible to define a work-operator for the total system, the question in that setting remains whether its projection on the subsystem remains useful and its spectrum measurable.

In the present paper we deal with a unitary evolution over the total system, subsystem plus reservoir, and we deal explicitly with a path-dependent work. That is new but the reason that the Jarzynski relation [\eqref=jar] is so universally valid remains the same as for classical systems. The basic observation is that the entropy production can be identified with the source of time-reversal breaking in the action governing the distribution of system histories, see [\cite=il] [\cite=M] [\cite=MN]. We briefly state that point here in a formal way to refer to it later when things become more explicit. We take the dynamics time-dependent through which work W is done on the system over a time-period while in contact with a heat bath at constant inverse temperature β. The time-dependent dynamics starts with an energy function Vi and at time n the energy function is given by Vf. Let q(ω,ρi) denote the probability of a history (ωt)n0 (on a certain level of description) of the system started in the state ρi at time zero. We choose ρi  =   exp [ -   βVi] / Zi. We now reverse the protocol (the sequence of forcing) and let (ω,ρf)) denote the probability of the history ω when started in ρf at time zero. We choose ρf  =   exp [ -   βVf] / Zf for the same temperature but with a different energy function. For the probability of the time-reversed trajectory [formula], we then write (Θω,ρf). Introducing the action L, we have

[formula]

with

[formula]

Then,

[formula]

The change in energy Vf(ωn)  -  Vi(ω0) equals the work W minus the heat Q that flows into the bath. On the other hand, it can be argued that the source term of time-symmetry breaking (Θω)  -  L(ω) equals the entropy production βQ, see [\cite=MN]. Hence, we get from [\eqref=idea] that

[formula]

But, by normalization, multiplying the above relation with q(ω,ρi) and summing over all ω gives one; hence [\eqref=jar] obtains.

What remains to be done is to give a quantum expression for the above quantities and that is the subject of the present paper. In other words, we want to obtain an algorithm, valid for a system subject to the laws of quantum mechanics, through which we can measure the difference in equilibrium free energies. Moreover, we want this algorithm to be formulated on the level of the subsystem. That means that we must trace out the heat bath from the equality [\eqref=tas].

Formulation of the problem

We model a possibly small quantum system in contact with a much larger heat reservoir kept at fixed inverse temperature β. The Hilbert space of the subsystem is denoted by HS and that of the environment by HR; both are assumed finite dimensional. As usual the total real and self-adjoint Hamiltonian is a sum of three contributions,

[formula]

where the system-part HSt is parameterized by [formula] and acts on HS. The Hamiltonian of the reservoir HR (acting on HR) and the coupling HI between system and reservoir are assumed fixed. We will not need any explicit description of these terms. Setting γ = 0 decouples system and reservoir. The canonical density matrices describing equilibrium for the decoupled system are

[formula]

We are interested in the difference of Helmholtz free energies

[formula]

The dynamics for the total system is unitary and time-dependent with unitary operator

[formula]

acting on [formula]. The parameter λ is real and sets the energy-time scale.

While the left-hand side of [\eqref=jar] is clear and given by [\eqref=helm] the question is about the quantum version of the right-hand side: What is the averaging and what is the work? Different reduced dynamics for the subsystem can be imagined that are relevant in different types of regimes.

Results

Effective regime

Here we suppose that the dynamics for the subsystem is described via some effective dynamics. There are various candidates but one class of examples is obtained as the quantum analogue of a Markov process on HS. These can be rigorously obtained under various conditions and in various limiting regimes. Following [\cite=DS], one can start with a time-dependent Hamiltonian Ht and take the weak coupling limit. Obviously the driving protocol has to vary on the same time scale as the dissipation processes through contact with the reservoir. What results is a time-inhomogeneous Markov process such that the instantaneous generator at time t satisfies detailed balance with respect to H(t). One way to implement that is to think of a sequence [formula] where alternating in time, the transition is either thermal as for φtαt  →  φtαt + 1, and is modelled by a completely positive map Λt which satisfies the condition of detailed balance with respect to [formula],

[formula]

or is mechanical as for φtαt  →  φt + 1αt. That last transition is imagined instantaneously performed so that we define the probability of a trajectory ω as the product

[formula]

Expectations will be denoted by 〈  ·  〉D. The total change in energy is [formula] and the total heat that flows in the heat bath in the thermal transitions [\eqref=db] is

[formula]

The total work is therefore defined as

[formula]

and is done over the transitions φtαt  →  φt + 1αt. We then have

[formula]

The simplest way to prove [\eqref=corpocro] is to use the relation between entropy production and time-reversal as in [\cite=M] [\cite=MN] [\cite=il] [\cite=Cro]. Let [formula] be the time-reversed trajectory. Similar to [\eqref=pathprobD] we define a path-space measure starting from ρn:

[formula]

and compute the ratio

[formula]

By using detailed balance [\eqref=db] at every time-step and the definitions [\eqref=hea]-[\eqref=wo], one arrives at

[formula]

Apply to that relation the normalization condition

[formula]

to conclude [\eqref=corpocro]. The proof above mimics exactly the scenario of [\eqref=idea]. The result is the very analogue of the main identity by Crooks in [\cite=Cro] but where the transition rates in [\eqref=pathprobD] have a quantum mechanical expression.

Repeated measurements

We come back to the set-up of [\eqref=ham]-[\eqref=eq]. Assume that each HSt is non-degenerate and has projections Ptα on its eigenstates φtα with eigenstates Vtα. A trajectory or path for the subsystem is a sequence [formula] where each αt runs over the possible eigenstates of [formula]. We now give a probability measure on such trajectories which is obtained by tracing out the quantum mechanical probabilities for the whole system. Let PE denote the projection on the energy-space in HR for the reservoir Hamiltonian HR with energy E. The probability to find the total system initially in equilibrium for [\eqref=eq] and at later times in eigenstates φtαt for the system and with energies Et for the reservoir is given by

[formula]

When viewed from the subsystem, the probability for trajectory [formula] is thus (let [formula])

[formula]

and when conditioning on ω, [\eqref=pathprob] gives expectations denoted as

[formula]

when qβ(ω) is non-zero. Finally, the expectations in the path-space measure [\eqref=pathprobsys] are written as

[formula]

The change in energy for the subsystem corresponding to the path ω is Vnαn  -  V0α0 where Vtα is the energy of φtα. We define a path-dependent work by the formula

[formula]

The interpretation follows the first law of thermodynamics. To change the parameters in the Hamiltonian HSt isothermally some heat must flow from the bath into the system. That is the second term in [\eqref=work]. We can expect that the heat bath is dispersionfree with respect to the subsystem in the sense that through each step φtαt  →  φt + 1αt + 1 of the trajectory ω, the corresponding change in energies Et + 1 - Et of the reservoir is determined:

[formula]

That gives the heat Q flowing into the reservoir. At the same time the energy in the subsystem changes, the first term in [\eqref=work]. Combined, [\eqref=work] gives the work performed on the subsystem. For [\eqref=pathprob] - [\eqref=work],

[formula]

That means that the Jarzynski relation [\eqref=jar] is unaffected in the quantum regime when, in the averaging, the quantum mechanical probabilities are used. We will now verify [\eqref=realJarz].

We apply again the ideas around [\eqref=idea]. We define the time-reversed path-space measure from [\eqref=pathprob] by reversing the order in which the time-dependent dynamics is applied and by now starting from the density matrix ρn of [\eqref=eq]:

[formula]

It follows immediately that

[formula]

and hence

[formula]

as required.

The repeated measurements introduce another aspect of randomness in the distribution of work which is absent classically. Unless one is taking an effective dynamics like in Section [\ref=mama], one will always need to take care of that aspect to define in any useful way what is meant by work that depends on the history of the subsystem.

Special cases

There are a number of special cases that we treat separately.

Adiabatic regime

We consider only the subsystem that was initially brought in thermal equilibrium at inverse temperature β and that from time zero on is isolated from the environment. We take thus the same set-up as in Section [\ref=pa] except that we cut the coupling with the reservoir. The initial density matrix is

[formula]

and the dynamics is unitary on HS and here denoted by USt with [formula] changing as time proceeds. USt need not commute with HSt. Instead of [\eqref=pathprobsys] we now take the probability of trajectory [formula] to be

[formula]

with expectations 〈  ·  〉S. For ω the change in energy of the subsystem is Vn  -  V0 as was the first term in [\eqref=work]. Then

[formula]

That identity is the generalization of Equation 2.7 in [\cite=Tas]. Note that [\eqref=corpo] is true for an arbitrary family of unitary operators defining the time-evolution. It can be obtained from the following exact identity. Let G be an operator on HS and write Tr [formula]. Then, as one easily checks,

[formula]

for all super-operators Λt (acting linearly on density matrices) that leave the identity invariant, Λt(1) = 1. One can generalize [\eqref=pathprobS] and [\eqref=corpo] by choosing here

[formula]

with μtr  ≥  0 and [formula], meaning that the unitary USr is employed with probability μtr at time t. These Λ's leave the identity invariant, so [\eqref=forcorpo] applies and

[formula]

just like in [\eqref=pathprobS]-[\eqref=corpo] but now with probabilities

[formula]

Of course, if γ in [\eqref=ham] is zero, then [formula] factorizes and the treatments of Sections [\ref=mama]-[\ref=genc] reduces to the adiabatic case. The work is a difference of energies (instead of a path-dependent quantity) and there is no heat (Q = 0).

Quasi-static regime

We imagine then that the evolutions Ut are slow enough so that the system plus reservoirs relax into an equilibrium state with respect to Ht. We think about the case of Section [\ref=genc]. Always,

[formula]

but in the quasi-static regime we have

[formula]

which suffices to see that 〈e-  β(En - E0)〉(ω) depends only on (ω0,ωn). Again, there is no path dependence in the work W.

No time-dependence

Suppose that [\eqref=ham] does not contain a parameter dependence and that the time-evolution is homogeneous ([formula]). Then of course ΔF = 0. For the effective Markovian dynamics of Section [\ref=mama], one sees immediately that W(ω) = 0 for each ω in [\eqref=wo]. In the adiabatic case of Section [\ref=adi] as well: V0α0  -  Vnαn = 0 with qSβ  -   probability one when we ask that in [\eqref=pathprobS] the projections Ptαt and the unitary evolutions mutually commute. In the case of Section [\ref=genc], we can use conservation of energy Viαi + Ei  =   constant, as in the first law [\eqref=work], when we ignore the (boundary) interaction term HI in the energy balance. In that case we again get W(ω) = 0.

Acknowledgment: We are much indebted to Karel Neto cný for many useful discussions.