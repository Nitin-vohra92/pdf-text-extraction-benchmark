Optimal flux states, reaction replaceability and response to knockouts in the human red blood cell

Introduction

Understanding metabolic activity from the underlying genotype is one of the most addressed problems in computational biology. Functional modularity of metabolic networks suggests that topological aspects may provide a key to identify a class of 'critical' structures or 'essential' metabolic pathways [\cite=maha] [\cite=samal]. However the metabolic genotype only constitutes the frame on the top of which the dynamic phenotype is built. Criticality of a metabolic pathway will in general depend on both the network reconstruction from genomic information and the 'model of metabolism' defined on it. In E.coli, phenotypical essentiality of metabolic genes has been associated with a reduced allowed variability of the corresponding fluxes, suggesting that dynamically stiff reactions may constitute an evolutionarily robust backbone of metabolism conserved over different species [\cite=Mar].

Here we attempt a more thorough integration of topological and dynamical views that will provide further insights into the efficiency, robustness and responsiveness of a metabolic network. We will first associate the criticality of a reaction with its topological replaceability by enumerating the alternative paths from substrate to product along the network edges. Then we will validate and compare these results with the metabolic phenotype that results from the definition of a general constraint based model for metabolic flux prediction.

We carry out our analysis on the metabolic network of the human red blood cell (hRBC), one of the most studied organisms in systems biology, from the earliest mathematical models of single biochemical pathways [\cite=rapo] [\cite=holz] to the currently available genome-scale reconstructions [\cite=sysbio]. The reason for this choice lies essentially in its limited size. On one hand, it allows to compute reaction replaceabilities by a suitable modification of Johnson's exact algorithm for counting loops in a directed graph [\cite=Joh]. On the other, it allows for the efficient application of various sampling methods to the space of viable flux states [\cite=Wib] [\cite=Mar]. This is vital to address many important properties of erythrocytes. Indeed for some organisms under certain conditions it is reasonable to assume that the metabolic activity is aimed at maximizing a subset of the metabolic reactions (or a function of them) associated with a certain biological function. In such cases the relevant flux configuration can be computed by standard optimization algorithms. For example, E.coli's metabolism has been shown to maximize biomass production under evolutionary pressure [\cite=edw], but after a genetic knockout it responds with a minimum rearrangement of fluxes [\cite=seg]. While the production of the cofactors ensuring the maintenance of osmotic balance and the release of oxygen may be argued to be their metabolic goal, erythrocytes do not generically allow for such a simplification. Information-rich directions in flux space must be retrieved by coupling the underlying constraints on fluxes with other types of analyses. Much understanding has indeed been obtained from the uniform sampling of feasible states [\cite=Wib] [\cite=Pri] [\cite=Bra] and by functional studies, like the computation of extreme pathways [\cite=wiba], of metabolic regulatory structures [\cite=pricea] [\cite=barrett] and of metabolic pools [\cite=kau2].

These aspects combined make hRBCs a key benchmark for both theories of metabolism and computational tools.

Approach

Given a reaction network, we want to compute, for any pair of metabolites a and b that are respectively substrate and product in a reaction i (this situation will be indicated by [formula]), the number [formula] of alternative pathways, excluding reaction i, of length [formula] allowing for the conversion a    →    b, see Fig.[\ref=loop]. The idea is that a metabolite conversion [formula] for which [formula] (or, more properly,[formula]) is large will be more easily substituted in case of a knockout than one for which the above quantity is small. Finding paths connecting two points of a directed network is a long-studied problem in computer science. The focus is usually on locating the shortest paths or the fastest way to find any path. Characterizing all the distinct paths between two vertices is however a less confronted issue. In our case it is crucial to avoid overcounting, e.g. due to self-intersecting paths. Therefore we shall resort to an exhaustive algorithm. We will identify the substitutive paths using the following trick: for each pair (a,b) of metabolites such that [formula], revert i fictitiously. This results in a new graph where an auxiliary edge [formula] replaced the edge [formula], see again Fig.[\ref=loop]. Counting the number of alternative reaction chains producing b from a then comes down to computing the number of directed cycles, i.e., non self-intersecting directed closed paths along the edges of the new graph, passing through the fictitious edge [formula]. Thanks to the limited size of the hRBC network it is possible to solve this enumeration problem exactly via Johnson's algorithm [\cite=Joh], briefly described in the following section. [formula] can now be trivially inferred. For simplicity, [formula] will denote here the number of reactions in the alternative pathway ([formula] in Fig.[\ref=loop]).

The space of viable fluxes will be defined through a constraint-based approach which relies on more general assumptions than flux-balance analysis (FBA, [\cite=Kau]). FBA is the standard method to model steady-state reaction networks where mass balance constraints are imposed to every metabolite. For a reaction network with N reactions and M metabolites, let us denote by [formula] and [formula], respectively, the M  ×  N matrices of output and input stoichiometric coefficients. The stoichiometric matrix is given by [formula]. Letting [formula] denote a vector of fluxes (with properly chosen bounds νmini  ≤  νi  ≤  νmaxi), the concentrations [formula] of metabolites vary in time according to [formula], where [formula] stands for the net cellular uptake of metabolite a (ua > 0 if a is a global output of metabolism, ua < 0 if a is consumed by the organism, ua = 0 if a is mass-balanced). Assuming a steady state, the concentrations are constant in time (i.e. [formula]) and vectors [formula] satisfying [formula], or

[formula]

represent flux configurations ensuring that each metabolite meets its production or consumption constraints at fixed concentrations. As N is typically larger than M, the system is underdetermined and feasible flux states form a convex set of dimension [formula] embedded in the N-dimensional space of fluxes. In absence of a selection criterion that allows to pick one solution out of this set (as e.g. a maximum biomass principle), a uniform sampling of the solution space should be carried out. This can be achieved effectively, albeit at a considerable computational cost, by Monte Carlo methods [\cite=Wib] [\cite=Pri] or by message-passing procedures [\cite=Bra].

Here we will consider a different but related approach based on Von Neumann's (VN) model of reaction networks [\cite=Mar]. In the VN framework we fix the environment through a small set of intakes on nutrients and define a self-consistent flux problem where the network chooses, given a target growth rate, how much of the nutrients to use and which metabolites are globally produced. Mass balance then emerges as a property of the solutions for some metabolites. The equations describing the VN model have been studied by statistical mechanics methods in [\cite=DeMM] [\cite=DeM]. For an intuitive derivation, note that the quantities [formula] and [formula] represent, respectively, the total output and the total input of each metabolite for a given flux vector [formula]. Then a flux vector such that [formula], with some constant ρ > 0, describes a network state where metabolites are being produced at a rate at least equal to ρ, since for each of them the total output is at least ρ times the total input. It is simple to see that as ρ increases the volume of such flux vectors shrinks continuously (for ρ = 0 every flux vector is a solution). In particular, there exists a value [formula] of ρ, representing the maximum metabolic production rate compatible with the stoichiometric constraints, above which no suitable flux vectors exist. The presence of conserved metabolic pools [\cite=Fam] implies [formula] [\cite=DeM2], so that in metabolic networks optimal fluxes correspond to the solutions of

[formula]

The solutions of ([\ref=vn]) do not coincide with those of ([\ref=fba]) even for [formula]. Interestingly, a finite volume of (optimal) flux states turns out to satisfy the above constraints [\cite=Mar]. This trait is at odds with both the behavior of the solutions of ([\ref=vn]) for a random reaction network (where a single solution survives at [formula] [\cite=DeM]) and with the optimization that is usually coupled to FBA (where typically a single flux state maximizes the objective function), and points to the robustness of metabolic phenotypes. For E.coli, in particular, the solutions of ([\ref=vn]) have been shown to reproduce both the large-scale organization of fluxes and the individual measured rates. In addition, fluxes with the smallest solution-to-solution fluctuations, representing the most susceptible parts of the network, turn out to be strongly correlated with E.coli's phenomenologically essential genes [\cite=Mar].

Methods

Reconstructed network

We consider the hRBC metabolic network studied in [\cite=Pri], a map of which is shown in Fig. [\ref=mappa]; Table [\ref=tab] lists reactions and the corresponding abbreviations. The network comprises three main pathways, namely glycolysis (reactions 1-13), the pentose phosphate (PP) pathway (14-21) and the adenosine metabolism, with a total of M = 39 metabolites linked by N = 59 reactions: 49 internal reactions (34 of which come from the splitting of 17 reversible processes), 3 auxiliary fluxes to maintain the osmotic equilibrium and the redox state of the cell (ATPase, NADHase, NADPHase) and 7 uptake reactions to guarantee the intake of the necessary nutrients (GLU, ADE, ADO, INO) and of the cytosol elements (H2O, H, Pi).

Structural properties

Structural vulnerabilities are identified by analyzing the loop structure of a modified metabolic reaction network, created from the original one by inverting -in turn- the direction of the single reaction for which we want to compute the replaceability, as explained in Fig.[\ref=loop]. The fastest known exact algorithm (for the worst case scenario) of this cycle enumeration problem for a directed graph was introduced by Johnson [\cite=Joh]. We shall now shortly describe its key ideas, referring to [\cite=Joh] for a pseudocode. Given a directed graph with n vertices and e edges, the algorithm is designed to build non-selfintersecting paths from a root vertex r to itself, loading them onto stacks. The main ingredients allowing for an optimal exploration of the graph are (a) a smart choice of the root vertex and (b) an efficient method to avoid duplicating cycles and repeating searches on the same portions of the graph. To achieve this, vertices are initially ordered in some lexicographic sequence, and the algorithm only selects as roots those nodes that are the "least" vertex (in the initial ordering) of at least one cycle. The algorithm described in [\cite=Tarjan72] garantuees to find such vertices in O(n + e) operations. Moreover, to avoid self-intersections, each time a node is loaded onto a stack it is also given a "blocked" status. It was proven by Johnson that if a vertex v stays blocked as long as every path from v to the root vertex r intersects the current path at a vertex other than r, the algorithm outputs all cycles exactly once. By sufficiently delaying the unblocking of each of these vertices and by keeping track of the portions of the graph that have been searched holding the current stack, the maximum time that can elapse between two consecutive cycle outputs can be reduced to O(n + e). The same holds for the time window before the first cycle is delivered and for the one after the output of the last cycle. Hence, the total time needed to list the, say, c cycles of the graph is O((n + e)(c + 1)). In our case, each fictitious reaction reversal generates a new graph, so that computing the complete substitutability map for the hRBC requires a time of the order O(N(n + e)(c + 1)). For practical reasons, we perform this analysis on the bipartite metabolic network (as in Fig.[\ref=loop]) rather than the reduced network of Fig.[\ref=mappa]. This implies that in our case n = N + M.

One can in principle consider different measures of replaceability of a metabolic conversion [formula]. The quantity [formula], which counts the total number of paths alternative to i from a to b of any length, is perhaps the most obvious option, while taking into account the fact that longer detours are less convenient than shorter ones from an energetic viewpoint one is lead to consider e.g. exponentially-weighted functions like [formula]. R-based and W-based rankings of metabolic conversion are rather different. The full rankings are available from http://chimera.roma1.infn.it/SYSBIO. Here we limit ourselves to identifying three key reaction groups which are independent of the replaceability measure: (a) the group of reactions such that each substrate-product pair involved in them can be substituted (this is putatively the part of the network that is most robust to single knockouts); (b) the group of reactions that cannot be substituted, corresponding to the most harmful enzymopathies; (c) the group of reversible reactions that are only replaceable in one direction, corresponding to the situation in which a conversion a  ↔  b can only be substituted in one direction in case of a knockout. Note that, for topological reasons, intakes are not replaceable.

Optimal flux configurations

Optimal flux vectors, i.e. solutions of ([\ref=vn]), are computed by the algorithm introduced in [\cite=DeM] based on [\cite=Kra]. The idea is to modify fluxes iteratively until all inqualities in ([\ref=vn]) are satisfied. Specifically, for a fixed [formula] (with [formula] in our case) define [formula] and let [formula] denote the rows of [formula], for [formula]. Let also, for each iteration step t, [formula] be the flux vector at step t and

[formula]

At each t, the algorithm runs as follows. If [formula], update fluxes according to

[formula]

and iterate in t. Else, if [formula] stop, i.e. [formula] is a solution.

Convergence to a solution is guaranteed for all [formula] [\cite=DeM], so that [formula] can be approximated with the desired resolution by iterating the above process for increasing values of ρ. To ensure that solutions are well defined one can either resort to setting fixed upper bounds on νi's or, as we do, impose a linear constraint of the form [formula] on the solutions (this is equivalent to singling out one flux as the reference unit for the other fluxes). It is convenient to initialize the algorithm with a random vector [formula]. Different initial points generate trajectories to different solutions at [formula] and the sampling of the solution space thus obtained turns out to be uniform [\cite=Mar].

As a means to characterize the shape of the solution space we employ the average overlap between different optimal flux vectors, defined as follows. Let [formula] and [formula] denote two distinct solutions of ([\ref=vn]) and, for each flux i, let

[formula]

This quantity, called the 'overlap' between α and β, equals 1 if flux i takes on the same value in solutions α and β and decreases as the values differ more and more. Averaging qαβ(i) over different pairs of solutions provides a measure of the allowed variability of flux i (smaller variability corresponds to larger average overlap), complementary to the standard deviation of the resulting flux distribution. The complex shape of the solution space can then be roughly understood by distinguishing narrower directions with larger overlap or less variable fluxes from broader ones. It is reasonable to think that a cell will be more sensitive to perturbations (e.g. knockouts) of fluxes with larger overlap. Hence analyzing the susceptibility of the solution space to perturbations along the directions identified by different fluxes allows to extract a list of the potentially more deleterious perturbations, in analogy with previous work on E.coli [\cite=Mar].

Response to enzymopathies

In order to test the hRBC network against enzymopathies, we can focus on two types of perturbations. One can first employ a structural criterion: the knockout of a metabolic conversion a  →  b that is less "substituted" is more likely to be deleterious for the cell than the knockout of a highly replaceable conversion. The second criterion is based on fluxes: fluxes with smaller allowed variability (i.e. larger overlap) in the healthy cell are more likely to be critical links of the network than fluxes whose value can be changed over a larger range without losing optimality. As is to be expected, the knockouts rankings produced in these ways have a large degree of similarity, as reactions in the group (b) discussed above coincide with the physiologically most critical part of hRBC's metabolism. The simplest way to simulate an enzymopathy on flux i is to constrain its value below a certain upper bound [formula]. Deficiencies can be partial, i.e., of a smaller degree, the closer [formula] is to the upper limit of the allowed range in the healthy cell, or total if [formula]. Such constraints cause in principle a modification of the solution space along the direction i which in turn cascades on the entire volume, modifying the optimal states of the metabolic network.

Results

Structural properties

The substitutability map derived from the loop analysis is displayed in Fig. [\ref=lupi]. (For the sake of simplicity we exclude the highly replaceable currency exchange fluxes from this discussion.) The most replaceable core of the network lies in the PP pathway (reactions 17-21), which constitutes the main source of NADPH, a key metabolite in erythrocytes that limits the accumulation of peroxides protecting the cell from hemolysis. The high reliability coming with replaceability partly explains the reason why this group of reactions plays a central role not just as an auxiliary pathway for glycolysis, see the following analysis of fluxes. Unreplaceable reactions are instead lined up along glycolysis (numbers 1,6,8-13), in the bridge between glycolysis and the PP-pathway (14 and 16) or in auxiliary modules (22, 27, 29; the ADE→  AMP conversion in 25 is also not replaceable being directly linked to the ADE uptake). The physiologically most deleterious knockouts (HK, PK and G6PDH) all belong to this group. For instance, deficiency in the level of G6PDH is the basis of different types of hemolytic anemias, including favism, and is also linked to malaria resistance [\cite=fm]. Finally, there is a group of reversible reactions that can be replaced only in one direction (reaction 2, 4, 7, 15, 23, 26). The last three of these could still be replaced in case of a knockout if a proper medium is selected. For instance, if reaction 15 is knocked out, it could be substituted by an alternative chain of reactions provided 6PGC is externally supplied. This is instead not possible for reaction 4 and possibly 23 (depending on the directionality of reaction 26), as a knockout in these cases would necessarily result in a net production of FDP and R1P.

Optimal flux configurations

The flux distribution corresponding to optimal states in the healthy and enzyme deficient hRBC are displayed reaction by reaction in Fig.[\ref=dis], obtained by sampling 10000 solutions of ([\ref=vn]), while a pictorial representation of the optimal flux states is given in Fig.[\ref=map]. For the healthy cell (black line in Fig.[\ref=dis] and top left panel in Fig.[\ref=map]) the large flux backbone is formed by the second part of the glycolysis (crucial for ATP, NADH and 23DPG production) and the PP pathway (NADPH production). The latter gives a substantial contribution to the former, not just as salvage way. The adenosine metabolism shows instead lower flux values. In addition to GLU, which is the fundamental substrate for hRBCs, the INO uptake plays an important role as an alternative way to the PP pathway. It is worth stressing that these solutions imply a net production of 23DPG, the crucial regulator for oxygen release, which is obtained without any imposed constraint. This picture is strongly reminiscent of the first eigenpathway obtained by extreme pathways analysis in [\cite=pricea], though the thermodynamic constraints and production requirements used in [\cite=pricea], including one on 23DPG, are more strict than the self-consistent analysis presented here. In Fig. [\ref=corre] we report the overlap map of the hRBC. Comparing this with Fig. [\ref=lupi] one sees that the large overlap backbone coincides to a large degree with the structurally most vulnerable parts of the network. Note that the overlap of reactions 2, 4, 15 and 26 is larger in the direction that cannot be replaced, further pointing to a higher susceptibility, and that currency reactions (31-35) belong to the most constrained part of the network. Revealingly, however, topological and dynamical characterizations prove to be complementary in some cases. This is seen e.g. from reaction 3, which is flux-constrained but also highly replaceable, so that the knockout damage is limited even in presence of a small allowed dynamical range. (A similar picture holds for reaction 23). To conclude, we remind that in our framework uptake fluxes are optimized variables not fixed by boundary conditions. In the optimal state five of the uptakes have a limited allowed variability, implying rather severe constraints on the cell's environment.

Response to enzymopathies

We have simulated the most studied enzymopathies by constraining the flux of the corresponding reaction. Generically speaking, the hRBC metabolism displays a large resilience against partial perturbations. Indeed, we have observed appreciable differences in relevant cellular functions compared to the non-deficient case only under full enzyme deficiences, as also observed in [\cite=sysbio] within a standard FBA optimization approach. Even under the most serious enzyme deficiencies the network appears to be able to maintain the production of ATP, NADH and NADPH almost constant, see also [\cite=tekir]. We focus here on PK and G6PDH deletions. As shown in Fig.[\ref=dis], the alterations in the flux distributions are not particularly striking and indeed we do not observe global flux rearrangements on the network's scale. The G6PDH enzymopathy appears to only cause local changes, confirming the structural predictions, the overlap calculations and also in agreement with clinical observations [\cite=Jac]. The response to PK knockout is instead more marked. The synoptic analysis of Fig.[\ref=map] shows that in general the response to the perturbation consisted in a drop of the GLU uptake, and in a reduction of the glycolitic flux, while the Rapoport-Leubering shunt (reactions 8-9) for the production of 23DPG remains particularly stable, as does the adenosine metabolism. For the glycolytic deficiences PK and HK we further observe an increase of the INO uptake to sustain the PP pathway and allow for the second part of glycolysis, and with it the production of ATP and NADH, to take place. Configurations corresponding to the next most severe enzymopathies (HK, EN, PGK and PGM) are available from http://chimera.roma1.infn.it.

Final remarks

In this work we compare two robustness measures for biochemical networks, one based on structural properties (the reaction replaceability), the other based on dynamical capabilities (the overlaps). The latter depends on both the network topology and the model defined on it. Within VN's frame, we found that unreplaceable reactions largely correspond to processes with a smaller allowed flux variability. In such directions, reaction knockouts as well as constraints on the fluxes are mostly harmful. Reactions with limited (but non zero) replaceability tend to have instead smaller overlap, so that while the reaction is difficult to substitute still its flux can be largely adjusted. In an evolutionary perspective [\cite=vit], the former pathways appear as 'frozen', and perturbations at these nodes will require large-scale flux rearrangement, while a mutation affecting the latter group may be neutral and could be preserved across generations. Interestingly, some reactions have both a large overlap and a large replaceability. These, albeit structurally robust, are dynamically constrained and should be considered as critical pathways of the metabolism as well. Integrating dynamical and structural characterizations thus provides a rather complete picture of the emerging network robustness. The structural analysis performed here was made possible by the small size of hRBC's metabolic network, which has served here as a model system to test basic concepts and algorithms. The use of the same procedure on a larger network, such as E.coli's, is likely to be prevented by CPU time growth. However, message-passing algorithms, designed specifically to solve combinatorial optimization or counting problems -albeit approximately- on graphical models, may be a suitable replacement [\cite=VKMa].

Acknowledgment

It is a pleasure to thank S. Jain for pointing us to [\cite=samal] and D. Segrè for important comments and suggestions.