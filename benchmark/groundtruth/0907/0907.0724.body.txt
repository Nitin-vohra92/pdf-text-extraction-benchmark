Corollary Lemma

Definition Conjecture

Lines, Circles, Planes and Spheres

Introduction

The problem of maximizing the number of three-point lines goes back as far as 1821 when several such problems appeared in [\cite=JJ21] in a section called "Trees planted in rows." The first question of the section essentially asks (but in a rhyming verse) how to plant nine trees such that they form ten rows of three. That section also includes several variations on this question. Many years later, Sylvester demonstrated a configuration of n points in the plane, lying on a cubic curve, that determines [formula] three-point lines [\cite=Mil68]. (More specifically, Sylvester's configuration was answering his own question of how to plant 81 trees to form 800 rows of three!) See [\cite=BGS74] and [\cite=BMP05] for a complete history of the Orchard Problem.

In Section [\ref=sec-orchard], we discuss an unexpected equivalence to the Orchard Problem that we found while researching a lower bound for the number of spheres determined by a set of points. This lower bound, best possible under its hypothesis, is [formula], where torchard3(n) is the upper bound on the number of three-point lines determined by n points, no four collinear, in the plane. This equivalence was discovered after realizing that a similar subtractive term exists for circles (but was overlooked in [\cite=Ell67]). We must first, however, present several lower bounds on determined planes which, by using methods inspired by P. D. T. A. Elliott, provide the tools necessary to obtain our results for spheres.

Motzkin's 1951 paper, [\cite=Mot51], is often cited for his conjecture (also conjectured by Dirac in [\cite=Dir51]) that among any set of 2n noncollinear points in the plane there exist n ordinary (i.e., two-point) lines. Included in that paper, [\cite=Mot51], are several results concerning planes (or hyperplanes) determined by points in three, or higher, dimensional space.

Using two counter-examples, i.e., the Desargues configuration and a set of points all lying on two skew lines in [formula], Motzkin demonstrated that a three-point plane need not exist among a finite set of noncoplanar points. So Motzkin defined the proper analog to an "ordinary line" to be an "ordinary plane", i.e., a plane in which all but one of the incident points may lie on a line. Similarly, an "ordinary hyperplane" in d-space is defined to be one in which all but one of its points are incident to a (d - 2)-flat (i.e., an affine subspace of dimension d - 2). S. Hansen later proved that an ordinary hyperplane necessarily exists among a finite set of points in ([formula])-space [\cite=Han65]. Hansen also found a new infinite family of configurations in [formula] with no three-point planes [\cite=Han80].

Given a set of n points in [formula], let m be the number of planes determined, and let t be the number of lines. Purdy conjectures, under various conditions, that [formula] and [formula]. Extending this to [formula], it is conjectured by Purdy that under certain conditions the number of hyperplanes determined is at least the number of (d - 2)-flats. (See Section [\ref=sec:cor-conj] for discussion of these conjectures.)

Compared to the work done concerning points in the plane, relatively little has been done to extend Motzkin's results concerning planes in [formula]. Several results in this area were obtained by Erds and Purdy in [\cite=EP77], with which the present paper is related. In [\cite=EP77], they prove that given a finite set of [formula] points, not all coplanar and no three collinear, there are at least [formula] planes determined. (This result verified [formula] for that case.) They also proved that given such a point set there exist [formula] determined planes (for a suitable c) incident to at most four points. The present article improves upon both of these results.

Lines Determined by Points in [formula]

This section contains a new result for lines in the plane. Its inclusion was motivated, in part, because it demonstrates in a more familiar setting the method of proof that will be used again for planes in 3-space.

In this section, we will consider a set of n points in [formula]. Let tk be the number of lines incident to exactly k of these points. Let t be the total number of determined lines, i.e., [formula]

In [\cite=EP78], Erds and Purdy prove the following lemma. For the convenience of the reader, we provide a proof.

If r points are on a line, l, and s points are not on l, then

[formula]

The result is true for s = 0 and s = 1, so suppose s > 1. We shall use induction on s. Let p, not on l, be the last point to be added for a total of s points off of l. Assume it's true for s - 1. By adding point p, at most s - 1 existing lines are spoiled, and r lines are created of which at most s - 1 already exist. Thus,

[formula]

The following lemma is due to Elliot [\cite=Ell67].

The number of lines determined by at most three points in a plane is at least one-half the total number of lines. More specifically,

[formula]

Beginning with Melchior's Inequality [\cite=Mel41],

[formula]

Adding t2 + t3 to both sides yields,

[formula]

Obviously, t = t2 + t3 + t4 + .... So,

[formula]

The lemma follows.

We shall use one more lemma, due to Kelly and Moser [\cite=KM58], which is also a consequence of Melchior's Inequality. Let ri be the total number of points incident to exactly i determined lines.

The total number of lines is at least one-third the total number of point-line incidences. That is,

[formula]

Again starting from Melchior's Inequality,

[formula]

By adding 3t to both sides,

[formula]

The lemma follows.

By combining Lemmas [\ref=lem:lb-23-pt-lines] and [\ref=lem:pt-line-incidences] we see the following, or simplified,

[formula]

Let S be a set of n points in [formula]. If [formula], and no more than n - k points are collinear, then

[formula]

We define the degree of a point to be the number of determined lines to which it is incident.

Case 1: There exist two points, p and q, of degree <  6k.

Let l be the line determined by p and q. Assume l is incident to exactly n - x points. Each line through p, other than l, must be incident to less than 6k points, otherwise the degree of point q would be too high, i.e. a contradiction. Likewise for lines through q. Thus, [formula].

By Lemma [\ref=lem:lb-ol], we know [formula]. The second derivative of f(x) is negative, i.e., f''(x)  =   - 4. Therefore,

[formula]

One can verify that when [formula], [formula], thus the lemma is true for this case.

Case 2: There exist at least n - 1 points of degree [formula].

From ([\ref=eqn:lb-t23-incidences]) we know (for positive k),

[formula]

Therefore, the lemma is true in both cases.

We should mention that one could derive a similar bound for t2 + t3 using a result of Kelly-Moser from [\cite=KM58] (i.e., [formula] when at most n - k are collinear and n sufficiently large) with Lemma [\ref=lem:lb-23-pt-lines]. Using the Kelly-Moser result one would need a larger value for k but could achieve a better lower bound for n. One could also derive a result similar to the corollary in the following section using this method.

Circles Determined by Points in [formula]

We shall now apply Theorem [\ref=thm:2-3-pt-lines] to produce a corollary on the number of circles determined by at most four points (among a finite set of points) in the plane. The proof will utilize circular inversion.

Circular inversion is a transformation of the euclidean plane, i.e., a mapping of [formula]. This transformation has several properties useful to the combinatorial geometer, e.g., for demonstrating the existence of circles determined by a finite set of points. Motzkin may have been first to use circular inversion for this purpose. More specifically, Motzkin ([\cite=Mot51]) proved that in a finite set of points in the plane, not all collinear and not all cocircular, each point is incident to either a three-point line or a three-point circle. Prompted by a conjecture of Erds, Elliott improved upon this by demonstrating a lower bound on the total number of circles determined by such a set of points [\cite=Ell67]. Using a similar method, Bálint and Bálintová ([\cite=BB94]) further extended the results of Elliott. For any reader unfamiliar with circular inversion, we would recommend [\cite=Har00] for coverage of this transformation.

P. D. T. A. Elliott's 1967 result [\cite=Ell67] that the number of circles is at least [formula] is slightly wrong. The lower bound is actually

[formula]

as may be seen by taking a circle with n - 1 points on it and a point p off the circle. It is easy to arrange the points such that p lies on [formula] threepoint lines. (We discovered this when we tried to prove that the number of spheres is at least [formula] and discovered that there is a subtractive term derived from the Orchard Problem.) Apparently, this counter-example even escaped the notice of the well-known geometer Beniamino Segre whom Elliott cited as providing an eight point counter-example to his result. Elliott's proof can easily be modified to show the correct result with the same lower bound of 394 for n. By the way, Bálint and Bálintová [\cite=BB94] gave the correct lower bound (i.e., [formula]) in 1994, but without any explanation, and we (and also Elliott [\cite=Ell08]) thought it was a misprint.

We define Invp(S) to be the circular inversion of a point set S about the point p∉S. (In this case S may be finite of infinite.) Although we will not give a formal definition of circular inversion, we provide its basic properties (see [\cite=Har00] for details):

Invp is self-inverse, i.e., q  =  Invp(Invp(q)).

If l is a line passing through p, then Invp(ł)  =  l.

If l is a line not passing through p, then Invp(l) is a circle passing though p.

Let S be a set of n points, one of which is p. Let [formula] be the set of n - 1 points formed by circular inversion about p. We begin with the following lemma.

If at most n - k points in S are incident to any line or circle, then in S', at most (n - 1) - k = n - k - 1 will be on any line. Thus, (by Theorem [\ref=thm:2-3-pt-lines]) when [formula], the number of determined lines incident to at most three points in S' is at least k(n - k - 1) - k(k - 1). In [formula], at most (n - 1) / 2 of these lines can be incident to p.

Let S be a set of n points in [formula] with at most n - k ([formula]) points on any line or circle. If [formula], then there exist at least [formula] circles determined in S.

Let cr be the number of circles incident to [formula] points in S. We denote by c(p)r the number of circles in S incident to r points, one of which is p.

This corollary is true when there exists a circle or line incident to n - 1 points (see the exceptional case for Elliot's result above), so assume [formula]. Let [formula], for some arbitrary p∈S. By Lemma [\ref=lem:circ-3-4], at least k(n - k - 1) - k(k - 1) determined lines in S' are incident to at most three points. Since at most [formula] of these lines are incident to p in [formula], it must be the case that [formula]. By repeating this argument for all n points in S, each circle is counted at most four times. Thus,

[formula]

Planes Determined by Points in [formula]

Let [formula], a set of n points in [formula], no three collinear and not all coplanar.

One method for determining the number of planes determined by a set of points in [formula] is to take an arbitrary point, p∈S, and project from p onto a plane π, the other points of S. The lines determined (by the projected points) on π correlate to the planes determined by the point set.

Let L be the set of [formula] lines determined by points of S. Let π be any plane which intersects every line in L, but does not contain any point of S. Let pi∈S be the point from which we project, and let li,j be the line connecting point pi with another point pj∈S. The projection of point pj on π is the point of intersection of li,j with π. Since no three points are collinear, this projection of pj is unique with respect to pi.

Although no three points are collinear in S, there might exist three points whose projections onto π are collinear. Also, the point from which we project is not itself projected; So a set of n points, will produce n - 1 points projected onto π.

Let tk(p) be the number of lines determined on π, when projecting from point p, containing exactly k [formula] points. Let [formula].

Let mk(p) be the number of planes containing exactly k [formula] points, one of which is point p. Let [formula].

For any point p∈S,

[formula]

Let pn∈S be an arbitrary point from which we project the others onto a plane π. Let si and sj on π be the projections of distinct points pi∈S and pj∈S, respectively. Let l be the line determined by si and sj. The points pi, pj and pn determine a plane, P, which contains line l. Any other point whose projection lies on l is incident to P. Since each point in S - {pn} has a unique projection onto π, the identity follows.

This identity, and derivations thereof, will be utilized throughout this section to obtain our primary results.

A Derivation from Melchior's Inequality

Let tk be the number of lines determined by points in a plane containing exactly k points.

We again use Melchior's Inequality [\cite=Mel41],

[formula]

Applying this inequality to the projection onto π from point p1∈S, along with the identity ([\ref=eqn:lines-to-planes]), we see that

[formula]

Since this inequality is true for whichever point we choose, we may extend this by summing over all n points in S,

[formula]

Let mk be the number of planes determined by points of S containing exactly k points. Each k-plane is counted exactly k times in this summation, yielding

[formula]

From this we get the following theorem:

Let S be a set of n points in [formula], no three collinear and not all coplanar. Let mk be the number of planes determined by points of S containing exactly k points. It must be the case that

[formula]

By separating the m3 term from the summation and reordering the inequality, one can see our first corollary:

Given a set of n points in [formula], no three collinear and not all coplanar, there exists at least n planes containing exactly three points. More specifically,

[formula]

From Theorem [\ref=thm-melchior-sum], one may also derive a bound for the number of planes determined by at most four points. The inequality from Theorem [\ref=thm-melchior-sum] can be rewritten,

[formula]

Let m be the total number of determined planes. By adding 5m to both sides, we see that

[formula]

or

[formula]

From this we get our next corollary:

Let S be a set of n points in [formula], no three collinear and not all coplanar. Let m be the total number of planes determined by S. The number of planes determined by S containing at most four points is more than five-eighths of the total number of determined planes. More specifically,

[formula]

Planes Incident to Exactly Three Points

In [\cite=CS93], Csima and Sawyer published their well-known result that among any set of [formula] points in a plane, not all collinear, there exist [formula] lines incident to exactly two points. We will now use this result to obtain an analogous result for the number of planes determined by exactly three points in 3-space.

Let S be a set of n points in [formula], no three collinear and not all coplanar. Let p1∈S be the point from which we project the others onto π.

Since the points are not all coplanar, their n - 1 projections onto π are not all collinear. Thus, Csima and Sawyer's result can be applied:

[formula]

By summing the above inequality for all n points, we would count each three-point plane three times. By taking one-third of that total, we arrive at the following:

[formula]

Let S be a set of n points in [formula], no three collinear and not all coplanar. There exists at least [formula] planes determined by exactly three points.

Total Number of Determined Planes

The following lemma is an extension of a result of Erds and Purdy (called "Lemma 2") in [\cite=EP77].

Let S be a set of n points in [formula], not all coplanar and no three collinear. Let m be the total number of planes determined by S. If exactly n - k of the points are coplanar, then

[formula]

Case k = 1: Let S be the set of n points. Let M be the plane containing n - 1 points, and p the point not on M. Each pair of points on M, along with p, determine a three-point plane. The relation is true with equality.

Case k = 2: Let p and q be the two points not on M. The line [formula] intersects M at a point r∉S. There can be at most [formula] pairs that determine a line through r, and therefore at most [formula] pairs that determine a plane with p that is incident to q (or vice versa). Therefore, the number of planes determined is at least [formula].

Case [formula]: Following the same argument as the case for k = 2, since there are [formula] pairs of points not on M, the number of planes determined is at least [formula].

Before we begin the primary result of this section, we will also need the following lemma.

Let mk be the number of planes incident to exactly k points. Let m be the total number planes determined by a point set. Given a set of n points, no three collinear and not all coplanar,

[formula]

Theorem [\ref=thm-melchior-sum] states the following,

[formula]

By negating this inequality one gets,

[formula]

Similarly, one can unwind the summation from ([\ref=eqn-mel-pairs]) to get,

[formula]

Adding ([\ref=eqn-neg-mel-pairs]) to ([\ref=eqn-exp-mel-pairs]) produces,

[formula]

Therefore,

[formula]

Dividing the inequality by two produces the lemma.

This leads us to the following theorem, which is a generalization of the Kelly-Moser Theorem (called "Theorem 4.1" in [\cite=KM58]) to three dimensions:

Let S be a set of n points in [formula], no three collinear and at most n - k coplanar. If [formula], the total number of planes determined by S is at least [formula].

The function, [formula], is a cubic polynomial of k and can be rewritten as:

[formula]

Let c1 and c2, where c1 < c2, be the function's two local extrema at [formula]. For all [formula], f(c1) > 0 and f(c2) < 0. Furthermore, f''(c1) < 0 and f''(c2) > 0.

Trivially, S contains [formula] pairs of points. We define the degree for a pair of points to be the number of determined planes to which the pair is incident.

Case 1: More than [formula] pairs of points have degree < 6k.

These ([formula]) pairs cannot form a matching, hence two pairs of low degree (< 6k) must share a point. Assume two such pairs are {p,q} and {p,r}. Let M be the plane determined by the points p, q, and r. Let a < 6k be the number of planes determined by S, not including M, incident to the pair {p,q}. Likewise, let b < 6k be the number of planes incident to the pair {p,r}. Since no three points are collinear, any plane passing through {p,q} can share at most one point of S, other than p, with a plane though the pair {p,r}. Therefore, at most a  ·  b  <  36k2 points of S are not on M. If M has exactly n - x points on it, then [formula].

We claim that for all [formula], the following two conditions are true: To verify the first, it would be sufficient for [formula], and thus, it is true for all [formula]. To verify the second, one must first consider our formula as a function of two variables, n and k, i.e.,

[formula]

Considering k to be a constant,

[formula]

is a convex quadratic function of n. By solving f2(n) = 0, one can see that for all [formula], f2(n) is positive.

From the two properties listed above, it is obvious that for all x such that [formula], it is also true that [formula]. So our inequality holds in this first case.

Case 2: At most [formula] pairs of points have degree < 6k.

There are at least [formula] pairs of degree [formula]. Let Pi be the number of pairs of points incident to exactly i planes. By Lemma [\ref=lem-total-planes],

[formula]

Thus, for all [formula] (and [formula]),

[formula]

Thus our inequality holds in this case as well.

Planes Determined by At Most Four Points

Let m3 be the number of planes incident to exactly three points. Given a set of points S, no three collinear, if r points lie on a plane π, and s do not, then [formula].

We define a plane with more than three points to be spoiled. This lemma is obviously true for s = 0 and s = 1. We will use induction on s.

Assume s  >  1. Let p be one of the s points not on π. If p is removed there are [formula] three-point planes. The addition of p will spoil at most [formula] of those planes.

Let q be any one of the other s - 1 points, in S and not on π. Let x∉S be the point (possibly at ∞  ) at which the line pq intersects π. There can be at most [formula] pairs of points, in S and on π, that determine a line through x, thus forming a four point plane with p and q.

So, the addition of p introduces [formula] new planes of which at most [formula] contain four or more points. Thus,

[formula]

Let S be a set of n points in [formula], no three collinear and at most n - k coplanar. If [formula], then

[formula]

We now define [formula]. The function can be rewritten in the following form:

[formula]

Let c1 and c2, where c1 < c2, be the two local extrema of this function at [formula]. We note that f(c1) > 0 (i.e. [formula]) and f(c2) < 0. Furthermore, f''(c1) < 0 and f''(c2) > 0.

For obvious reasons, the following proof is very similar to the proof for Theorem [\ref=thm-total-planes] in the previous section.

Trivially, S contains [formula] pairs of points. We define the degree for a pair of points to be the number of determined planes to which the pair is incident.

Case 1: More than [formula] pairs of points have degree [formula].

These ([formula]) pairs cannot form a matching, hence two pairs must share a point. Assume two such pairs are {p,q} and {p,r}. Let M be the plane determined by the points p, q, and r. As demonstrated in Theorem [\ref=thm-total-planes], there can be at most [formula] points of S not on M. If M has exactly n - x points on it, then [formula].

We claim that for all [formula], the following two conditions are true: To verify the first, it would be sufficient for [formula], and thus, it is true for all [formula]. To verify the second, one must first consider our formula as a function of two variables, n and k, i.e.

[formula]

Considering k to be a constant,

[formula]

is a convex quadratic function of n. By solving f2(n) = 0, one can see that for all [formula] (and [formula]), f2(n) is positive.

From the two properties listed above, it is obvious that for all x such that [formula], it is also true that [formula]. So our inequality holds in this first case.

Case 2: At most [formula] pairs of points have degree [formula].

There are at least [formula] pairs of degree [formula]. Let Pi be the number of pairs incident to exactly i planes. By Corollary [\ref=cor:lb-34-pt-planes], we know that [formula]. Thus, by Lemma [\ref=lem-total-planes]

[formula]

Therefore, [formula]. So the theorem is true in this case as well.

Corollaries and Conjectures

From Theorem [\ref=thm-total-planes], we have two corollaries. Both relate to conjectures found in [\cite=EP95]. In [\cite=EP77], Erds and Purdy proved [formula] for [formula]. Theorem [\ref=thm-total-planes] improves this by showing it to be true for [formula] (i.e., k = 1), which leads to the following corollary.

Let S be a set of [formula] points in [formula], no three collinear and not all coplanar. Let m be the number of planes determined by S, and t the number of lines. For all such point sets, [formula].

Putting k = 1, Theorem [\ref=thm-total-planes] says that [formula]. Since no three points are collinear, [formula]. Thus, [formula].

This is conjectured by Purdy to be true when [formula] for any finite set of points in [formula] that are not all coplanar and not all on two skew lines.

Let S be a set of [formula] points in [formula], no three collinear and no n - 1 coplanar. Let m be the number of planes determined by S, and t the number of lines. For all such point sets, [formula].

Putting k = 2, thus [formula], Theorem [\ref=thm-total-planes] shows that

[formula]

(for [formula]).

Purdy proved in [\cite=Pur86] that if the points are not all coplanar and not all on two skew lines then [formula], for some c > 0. Erds asked what are sufficient conditions for [formula]. Purdy conjectured in [\cite=EP95] that [formula] when n is sufficiently large, no n - 1 points are coplanar and the points do not lie on two skew lines.

This conjecture is easily seen to be false for projective geometries over finite fields. Let q = pk, where p is any prime and [formula]. We denote by PG(d,q) the projective d-space over GF(q), and by [formula], we denote the Gaussian coefficient. In PG(3,q), the number of points (same as the number of planes) is [formula], and the number of lines is [formula] [\cite=Hir79] [\cite=Oxl92]. (From this one can see that n  <  t  >  m.) Since PG(3,q) is a rank-4 matroid, the conjecture is also false for matroids.

This conjecture has also been extended by Purdy to d-dimensional space [\cite=EP95]. We define the rank of a flat (i.e., rk(f)) to be one more than its dimension, e.g., points have rank one, lines rank two, etc. A set of flats [formula] is defined to be a covering set of flats for a point set [formula] if every point in S is incident to a flat in F. Furthermore, the rank of a set of flats F is defined to be the sum of the ranks of its members, i.e., [formula]. A point configuration S is irreducible if there does not exist a covering set of r ([formula]) flats with rank at most [formula].

Let wk be the number of determined flats of rank k. For any sufficiently large irreducible point configuration in [formula], Purdy conjectures that [formula]. By projection (i.e., one which preserves the number of (d - 2)-flats), it would follow that [formula], thus implying unimodality in this case.

Seymour proved [\cite=Sey82], in the more general context of matroids, that if no five points are collinear then [formula]. This is related to a conjecture by Mason [\cite=Mas72] and others that the sequence of Whitney Numbers (i.e., [formula]) is log-concave, i.e., [formula] for all i > 0. Purdy proved in [formula] [\cite=Pur86] that if the points do not all lie on a plane then [formula], for some c > 0. See [\cite=EP95] for further discussion of these and other conjectures.

Spheres Determined by Points in [formula]

Circular Inversion has a lesser known extension to higher dimensional space, i.e., spherical inversion. For the convenience of the reader, we provide below a basic definition and the relevant properties of spherical inversion. We refer the reader to [\cite=Bla00] for a rigorous definition and proof of the given properties.

Let p be any fixed point in [formula]. Without loss of generality, let p be the origin of a coordinate system. We assume, of course, that coordinates are determined relative to some orthonormal basis. Let q, with coordinates (x,y,z), be any other point in [formula]. We define the "spherical inverse" to be (for any q  ≠  p):

[formula]

(This inversion occurs about a sphere of unit radius centered at p. Invp(p) is left undefined.) We apply this mapping, i.e., Inv, not only to points but also to sets of points, either infinite or finite, intending the obvious results.

The mapping has the following properties (for any arbitrary point p):

Invp is self-inverse, i.e., q  =  Invp(Invp(q)).

If π is a plane passing through p, then Invp(π)  =  π.

If π is a plane not passing through p, then Invp(π) is a sphere passing though p.

Let S be a set of [formula] points in [formula], not all cospherical, no n - 1 coplanar, no four cocircular and no three collinear. For any arbitrary p∈S, the set [formula] will be likewise.

For contradiction, assume q1, q2 and q3 are three collinear points in S. Choose the center of inversion, p, to be any other point in S. Let l be the line determined by the qi. Let M be the plane incident to l and passing through p (the center of inversion). Let N be any plane incident to l but not passing through p. Obviously [formula], which is the intersection of a plane (i.e., Invp(M)) with a sphere (i.e., Invp(N)). Thus, Invp(l) is a circle incident to these four points. By self-inversion, one can see that the converse is also true.

The other claims are obvious.

Spheres Incident To Exactly Four Points

Using the lemma above and some careful counting, we now prove a lower bound on the number of four point spheres determined by a set of points in [formula]. We also utilize a result, from an earlier section, concerning the number of three-point planes determined by a set of points.

Let S be a set of [formula] points in [formula], not all cospherical or coplanar, no four cocircular and no three collinear. There exist at least [formula] spheres incident to exactly four points of S, where [formula].

Choose any p∈S to be the center of inversion. Let [formula], and let [formula].

Assume n - 1 points in S are coplanar. Let p be the point not on the plane. Since no three points are collinear and no four cocircular, there are [formula] four point spheres determined through p, and the theorem is true. We now assume that no n - 1 points are coplanar in S.

By Lemma [\ref=lem-inv-props], S'' is a set of n points such that no n - 1 are coplanar. Thus, the points of S' are not all coplanar (and no three collinear). From Theorem [\ref=thm-3-pt-planes], we know that S' determines at least [formula] three-point planes. There are two possible cases.

Case 1: At most [formula] of these three-point planes (determined by points in S') pass through p.

The set S thus contains at least [formula] four point spheres incident to point p.

Case 2: More than [formula] of these three-point planes (determined by points in S') pass through p.

We now carefully count the [formula] pairs of points in S' (as seen from p). Each of the at least [formula] planes that pass through p account for at least three of these pairs, i.e., at least [formula] pairs. This leaves at most [formula] pairs to form a three-point plane with p in S''. Hence, the set S'' must determine at least [formula] three-point planes that do not pass through p.

Thus, the set S (again) contains at least [formula] four point spheres incident to point p.

Since the selection of p was arbitrary this argument may be repeated n times, counting each of these spheres four times. Thus the number of four point spheres determined by S is at least [formula].

The Orchard Problem

Let t3(S) be the number of three-point lines determined by some finite point set S in the plane. Let torchard3(n) be the maximum of t3(S) for all n element point sets S in the plane containing no four collinear points. We refer to determining the exact value of torchard3(n) as the "classic" Orchard Problem.

Consider a set of n points in three-space, no three collinear and no four cocircular. Our ultimate aim is to prove that the minimum number of spheres determined by these points is exactly [formula].

To this end, we let S be a set of n cospherical points with no four cocircular. We shall prove in this section that the maximum number of planes, determined by S, that share a common point p∉S is equal to torchard3(n). For brevity, we will refer to this bound as Mmax3(n).

We begin with the lemma below that will be used in the following section (i.e., Section [\ref=sec:sphere-at-most-5]) to prove a lower bound on the total number of determined spheres. It is this lemma that led us to the rather unexpected equivalence to the Orchard Problem.

Let S be a set of n points in [formula], exactly n - k cospherical, no four cocircular and no three collinear. Let σ0 be the sphere to which n - k points are incident. Let p∈S be any point not on σ0. There are at least [formula] spheres determined by p and three points on σ0. Furthermore, each of these spheres is incident to at most 3 + k points of S.

From p, project the n - k points of σ0 onto a plane π. Let tk(p) be defined as in Definition [\ref=def-lines-pi] for the n - k points being projected. Since no four points are cocircular, tk(p) = 0 for all [formula]. So obviously, [formula]. All point triples on σ0 not forming a plane through p must determine a sphere with p.

In the proof above, we assert that obviously [formula]. Combinatorially, one can see that [formula], since no two distinct three-point lines may share a pair of points. This is further improved by observing that, by counting all pairs of points, [formula]. Using the Csima-Sawyer result (i.e., [formula]), this upper bound can be lowered to [formula].

Improving upon Sylvester's work, point configurations have been demonstrated by Burr, Grünbaum, and Sloane [\cite=BGS74], and again by Füredi and Palásti's [\cite=FP84] that come very close to this theoretical bound. More specifically, these configurations have shown that [formula]. See [\cite=BMP05] for coverage of more recent results.

A set of n points on a sphere, no four cocircular will project onto n points on a plane, no four collinear, so there will be at most torchard3(n) three-point lines and consequently at most that many planes through three points on the sphere and the point of projection. However, to show these two bounds to be equivalent we need to also prove the more difficult "converse" of this. That is, we must prove that every orchard configuration in the plane can back project into points on a sphere, no four cocircular. From this equivalence, we conclude that not only is [formula] the lower bound for determined spheres (see Section [\ref=sec:sphere-at-most-5]), but that this bound is always attainable. (Note that the projection of a circle onto a plane is a conic section, and that five points, no three collinear, are required to determine a unique conic section [\cite=Cox74].)

Let S be a configuration of n points, no four collinear, on a plane π. There must exist a set S' of n points, all cospherical but no four cocircular, and a point of projection p such that projecting the points from S' onto π produces the point set S.

Let π be the plane in [formula] containing the point configuration S. We will assign each point in S unique coordinates (x,y,1), for some x,[formula]. We further require the points of S to be rotated such that no two points share a first coordinate.

Let [formula], [formula], [formula] and [formula] be any four points of the configuration S. Let [formula] be a unit sphere, centered at [formula] and tangent to π, to which the points of S' are incident. The point from which we project will be the center of the sphere, i.e., [formula].

If any three of the four points are collinear they will not determine a conic section, so we assume that this is not the case. We also assume that [formula], [formula] and [formula] are labelled in a clockwise order, as seen from p.

Let [formula], [formula], [formula], and [formula] be the euclidean distances from each of the four points on π to the center of the sphere [formula]. Let [formula], [formula], [formula], and [formula] be unit vectors representing four points on the sphere which project to [formula], [formula], [formula] and [formula], respectively.

Let [formula] be the plane determined by points at [formula], [formula] and [formula]. The plane [formula] (which does not contain [formula]) intersects [formula] in a circle. Let [formula] be the circle formed by the intersection of [formula] with [formula].

We denote by (û,) the scalar product of two vectors û and [formula]. We now consider [formula], [formula], [formula] and [formula] to be fixed. Let [formula]. Obviously, [formula] is a vector orthogonal to the plane [formula]. For any two points, e.g., û and [formula], on the circle [formula], their scalar products (as vectors relative to the center) with [formula] are the same, i.e., [formula]. Therefore, ŵ is on [formula] if and only if [formula].

The function f(p1,p2) can be rewritten as (Aa + Bb + Cc + Dd) / (a  ·  b  ·  c  ·  d), where A,B,C and D are constants (i.e., their values are constant relative to the points [formula], [formula], [formula] and [formula]). Since we are concerned with the roots of the function f, we will only consider its numerator. We also fix p2 to be zero.

Let [formula], and thus,

[formula]

The first term of g'0(p1) has two conjugate poles which are the complex zeroes of the monic quadratic 1 + (w1 - p1)2 + w22 = p21 - 2w1p1  +  1  +  w21  +  w22. The quadratic polynomials are all distinct, and since their roots occur in conjugate pairs, their roots are all distinct. So, g'0(p1) has eight poles, implying that g0(p1) is not identically zero.

Let [formula] be conjugates of g0 formed by reversing (in the seven possible ways remaining) the signs of its last three terms. By taking the product of these eight functions we obtain a polynomial (i.e., with no radicals). Let [formula]. Obviously, P(p1) is zero wherever g0(p1) is zero and furthermore, P(p1) is not identically zero. Thus, P(p1) is a polynomial having at most a finite number of (real) roots.

Since there are only a finite number of four point combinations in S, there must exists a point (p1,0,1) on π to which the sphere may be tangent such that the points of S', no four cocircular, project onto the points of S. Therefore, torchard3(n) = Mmax3(n).

Total Number of Spheres Determined

In this section, we shall prove the following.

Let S be a set of n points in [formula], not all cospherical or coplanar, no four circular and no three collinear. If [formula], then the number of spheres determined by S is at least [formula]. This bound is best possible.

We begin with the following lemma.

Let S be a set of n points in [formula], at most n - k cospherical or coplanar, no four cocircular and no three collinear. If [formula] for some p∈S, then S' is a set of n - 1 point with at most n - 1 - k coplanar.

Since spherical inversion is self-inverse, it's also the case that [formula].

Let π be a plane incident to exactly r points in S'. There are two cases.

Case: p is incident to π.

The Invp(π) is a plane containing r + 1 points (including p) in S. Since r + 1 is at most n - k, the lemma follows.

Case: p is not incident to π.

The Invp(π) is a sphere containing r + 1 points (including p) in S. Since r + 1 is at most n - k, the lemma follows.

We now provide a lemma, analogous to the previous one, for when n - k points are coplanar.

Let S be a set of n points in [formula], exactly n - k coplanar, no four cocircular and no three collinear. Let π be the plane to which n - k points are incident. Let p∈S be any point not on π. There are at least [formula] spheres determined by p and three points on π. Furthermore, each of these spheres is incident to at most 3 + k points of S.

Since no three points are collinear and no four cocircular, each point triple from the plane will determine a unique sphere with p.

The following two lemmas place an upper bound on the intersection of two sets. The proof for the primary theorem of this section utilizes the inclusion-exclusion principle, which requires an upper bound for the size of the intersection of two such sets.

Let S be a set of n points in [formula], exactly n - k ([formula]) cospherical, no four cocircular and no three collinear. Let σ0 be the sphere to which n - k points are incident. Let p∈S and q∈S be any two distinct points not on σ0. Let σp be the set of spheres determined by p and three points from σ0. Likewise, let σq the set of spheres determined by q and three points from σ0. It must be the case that [formula].

The spheres in [formula] all contain at least five and at most 3 + k points. Furthermore, no two distinct spheres in [formula] can share a pair of points from σ0, since that pair along with p and q determine a sphere. This reduces our problem to determining how many distinct point triples from σ0 can there be such that no two triples share a pair. From this, we see that [formula].

Let S be a set of n points in [formula], exactly n - k ([formula]) coplanar, no four cocircular and no three collinear. Let π be the plane to which n - k points are incident. Let p∈S and q∈S be any two distinct points not on π. Let σp be the set of spheres determined by p and three points from π. Likewise, let σq the set of spheres determined by q and three points from π. It must be the case that [formula].

The spheres in [formula] all contain at least five and at most 3 + k points. Furthermore, no two distinct spheres in [formula] can share a pair of points from σ0, since that pair along with p and q determine a sphere. The lemma follows.

We shall consider all possible cases.

Case: Exactly n - 1 points in S are cospherical.

Follows from Lemma [\ref=lem-cospherical-1-off].

Case: Exactly n - 1 points in S are coplanar.

Follows from Lemma [\ref=lem-coplanar-1-off].

Case: Exactly n - 2 points in S are cospherical.

Let σ0 be the sphere incident to n - 2 points. Let p and q be the two points not on σ0. Let σp be the set of spheres determined by p and three points on σ0, and let σq be defined in similarly.

From the Inclusion-Exclusion Principle, we know [formula]. The spheres in [formula] are each incident to at most five points.

From Lemmas [\ref=lem-cospherical-1-off] and [\ref=lem-cospherical-intersection], we see that

[formula]

(for all [formula]). Note that by the Füredi-Palásti configuration [\cite=FP84], [formula].

Case: Exactly n - 2 points in S are coplanar.

Let π be the plane incident to n - 2 points. Let p and q be the two points not on π. Let σp be the set of spheres determined by p and three points from π, and let σq be defined similarly.

From the Inclusion-Exclusion Principle, we know [formula]. The spheres in [formula] are each incident to at most five points.

From Lemmas [\ref=lem-coplanar-1-off] and [\ref=lem-coplanar-intersection], we see that

[formula]

(for all [formula]).

Case: Exactly n - 3 points in S are cospherical.

Let σ0 be the sphere incident to n - 3 points. Let p, q and r be the three points not on σ0. Let σp be the set of spheres determined by p and three points on σ0, and let σq and σr be defined similarly.

Again, the Inclusion-Exclusion Principle shows that

[formula]

The set [formula] contains precisely those spheres incident to six points. Since these spheres are already subtracted, we need not alter the formula above.

Therefore, the number of spheres incident to at most five point is at least

[formula]

(for all [formula]).

Case: Exactly n - 3 points in S are coplanar.

Let π be the sphere incident to n - 3 points. Let p, q and r be the three points not on π. Let σp be the set of spheres determined by p and three points on π, and let σq and σr be defined similarly.

Again, the Inclusion-Exclusion Principle shows that

[formula]

The set [formula] contains precisely those spheres incident to six points. Since these spheres are already subtracted, we need not alter the formula above.

Therefore, the number of spheres incident to at most five point is at least

[formula]

(for all [formula]).

Case: At most n - 4 points in S lie on any plane or sphere.

Let [formula] for some p∈S. S' is a set of n - 1 points with at most n - 3 on any plane.

By combining Theorem [\ref=thm-total-planes], Corollary [\ref=cor:lb-34-pt-planes] and Lemma [\ref=lem-n-1-k-coplanar], we know that if [formula] then the number of planes determined at most four points in S' is at least [formula]. We need an upper bound on how many of these planes pass through p.

From the proof of Lemma [\ref=lem-cospherical-1-off], we know that the number of planes determined by points in S' passing through p is less than [formula]. All other planes determined in S' correspond to a sphere determined by points in S. The number of spheres, passing through p, determined by at most five points in S is at least

[formula]

We can repeat this argument for all n points in S, counting each sphere at most five times. Thus, the number of spheres determined by S is at least

[formula]

(for all [formula]).

Conclusion

In this paper, our results for point sets in [formula] assumed no three points are collinear. It would be interesting to know whether similar results could be obtained by assuming that at most j points are collinear, for some fixed [formula].

If one were to allow an arbitrary number of collinear points, the lower bounds for the number of objects determined (e.g., lines, planes, etc.) become weaker. Consider the class of configurations which have exactly n - k points collinear for a fixed k. We note the following:

At most [formula] lines are determined.

At most [formula] planes are determined.

At most [formula] spheres are determined.

It would also be interesting to know whether the results of this paper could be matched, or improved upon, using oriented matroids.