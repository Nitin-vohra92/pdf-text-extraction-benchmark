Asymptotic equivalence of paired Hotelling test and conditional logistic regression

Abstract

Matching, the stratification of observations, is of primary importance for the analysis of observational studies. We show that the score test of conditional logistic regression and the paired Student/Hotelling test, two tests for paired data, are asymptotically equivalent.

Keywords: matching, conditional logistic regression, asymptotic equivalence, paired Student test, observational studies.

Introduction

Observational studies are the main source of information in many areas of science such as epidemiology or the social and political sciences [\citep=Rosenbaum2002]. Such studies aim at estimating the effect of a treatment on an outcome and they differ from randomized experiments by the absence of random allocation of treatment. This lack of randomization is due to ethical or economical considerations and as a consequence, observational studies are subject to confounding. In the typical context of an observational study, we have n observations of a random outcome Y and a random predictor or treatment X. The analysis is complicated by the possibility of confounding i.e., the influence of a third variable Z on X or Y. To take an example, suppose Y is lung cancer, X is yellow coloration of the teeth and Z is smoker status. If we do not take into account Z, we will find an association between Y and X but if we control for Z, the association will disappear since both lung cancer and yellow coloration of the teeth are caused by smoking. In a randomized experiment, randomization will ensure that the treated and non-treated group have similar values for all confounders.

Matching is an important method to control for bias in observational studies. Matching is the grouping of observations in strata. Such a grouping is necessary when the observations in a strata cannot be considered independent. For example, consider a continuous variable, such as blood pressure, which is measured before and after the beginning of a medical treatment given to a group of patients. In order to show that the treatment is effective, an incorrect approach would be to compare the mean of the group before treatment to the mean after treatment using a two-samples Student test. This naive approach relies on the unwarranted assumption of independence of the measurement of the same patient before and after the treatment. The correct approach is to compute the difference between blood pressure before and after treatment for each patient and then to test if the differences have zero mean using a Student test. This is called the paired Student test. In this simple example, the stratas are the pairs of observations of the same patient.

In presence of confounding, matching on the values of the confounder remove bias [\citep=rubin73] or when there are several confounders, other techniques based on matching can be used [\citep=rosenbaum83]. Matching can also guide the data collection of an observational study. This is best illustrated by the case-control study in epidemiology. Such a study begins by gathering disease cases for example at hospitals. The recruitment of controls is less straightforward than the recruitment of cases and must try and limit confounding. One way of achieving this is to choose controls that are naturally matched to cases: for each case, controls are chosen among friends or neighbors whose -potentially unobserved- confounders are similar to that of the case. As the case and his controls have been chosen for their similarity, they cannot be considered independent and must be grouped in a strata.

Once a matching is obtained, adapted statistical procedures are needed and especially statistically sound testing procedures. A good reference on statistical methods for matched data is the monograph by [\cite=breslow1981]. For strata limited to pairs of one case and one control (or before and after treatment) and when the predictor X is a binary variable, the so-called McNemar test can be used [\citep=mcnemar]. In this simple case, there are only 4 possibilities for each pair. The data can be summarized in the following two-by-two contingency table.

In the table above, a + d is the number of pairs of a case and a control concordant for the predictor X and b + c is the number of discordant pairs. The statistic ξmc of the McNemar test depends only on the numbers of discordant pairs b and c and has the following form: Under the null hypothesis of independence between Y and X, ξmc follows the χ2 distribution asymptotically [\citep=mcnemar]. This test statistic has the advantage of being computationally simple.

However, in many settings, we have access to more than one control for each case. For example, in the Isis-Diab study [\citep=balazard2016], each patient was asked to recruit two controls . A test for strata of arbitrary size and a binary predictor was proposed in [\cite=MH] and is now referred to as the Cochran-Mantel-Haenszel (CMH) test. It also provides an estimate of the odd-ratio associated with the predictor. The original article contains an interesting discussion of practical aspects of the prospective study of disease.

If the predictor is not binary but continuous, appropriate tests are available if the matching is a pairing i.e., each case has exactly one control. If the vector of differences between cases and controls can be assumed to be normally distributed, a Student test can be applied on this vector to decide if its mean is zero as in our first example. The resulting test is called the paired Student test [\citep=mcdonald2009]. The paired Hotelling test is the generalization of the paired Student test when there are several predictors. When the normality assumption is not respected, a non-parametric alternative is available via the Wilcoxon signed rank test.

None of the above procedures allow for analysis of continuous variables with arbitrary strata size. This was made possible by conditional logistic regression (CLR) first introduced in [\cite=breslow78]. CLR is however not limited to continuous variables and can be applied in all settings of the previous tests. As CLR is based on logistic regression, it is more flexible than the previous tests and allows for multivariate analyses.

When different statistical tests are available for the same data, it is desirable to prove that their results are similar. For procedures based on maximum likelihood such as CLR, the three tests of significance for predictors (the Wald test, the likelihood ratio test and the score test) have been shown to be asymptotically equivalent [\citep=engle1984wald]. This result of asymptotic equivalence is with respect to the null hypothesis as well as to a sequence of local alternatives.

For the analysis of matched data with a binary predictor, the available tests have been shown to be identical. When the strata are pairs, both the CMH test and the McNemar test can be applied and their statistic is identical [\citep=agresti]. When the strata size is arbitrary, CMH and CLR can be applied and the CMH statistic is identical to the score test statistic of CLR [\citep=Day79] and therefore if the strata are pairs, the McNemar statistic will be identical to the score test statistic of CLR.

When the strata are pairs and the predictor (resp. predictors) is continuous, the paired Student test (resp. paired Hotelling test) and CLR can be applied. However, to the best of the author's knowledge, there are no results comparing the two procedures in that case. The objective of this note is to prove that the paired Hotelling test is asymptotically equivalent to the score test of CLR and therefore also to the Wald and likelihood ratio tests.

We start by deriving the exact form of the two test statistics in section 2. Finally, we present our result and prove it in section 3.

Test statistics

Let [formula] be the label of the [formula]-th individual of the i-th stratum and [formula] its continuous predictor value. The paired Hotelling test can be applied when stratas are pairs of discordant observations and therefore [formula]. Without loss of generality, we can assume that Yi1 = 1 and Yi2 = 0.

We are interested in testing the null hypothesis:

[formula]

against the alternative hypothesis:

To test this null hypothesis in this setting, we have two options: the paired Hotelling test whose test statistic we denote [formula] or CLR whose score test statistic we denote [formula]. We now derive the expressions of those two test statistics. As we will show below, the paired Hotelling test and CLR depend only on the vector of differences between pairs. We therefore denote Zi = Xi1 - Xi2 the difference between pairs.

Paired Hotelling test

The hypotheses tested by the paired Hotelling test are expressed by the parameter [formula], the mean of the difference between pairs. Using this parameter, the hypothesis [\eqref=null] becomes [formula].

Let the unbiased sample covariance be defined as: where [formula] and [formula] is the transposition operator. The statistic of the test is:

[formula]

When Z follows a centered Gaussian distribution, the distribution of [formula] is called the Hotelling distribution.

Conditional Logistic Regression score test

In logistic regression, the likelihood of an observation, given the parameters [formula] and [formula], equals: with y∈{0,1}.

Logistic regression can take into account stratification by having a different constant term αi for each stratum. However, when the strata are small e.g., pairs, this leads to a large number of parameters and biases parameter estimation [\citep=breslow1981]. Conditional logistic regression adresses the problem by conditioning the likelihood on the number of cases in each stratum. This eliminates the need to estimate the αi. In the case of pairings, when the first observation is a case and the second is a control, the conditional likelihood of the i-th strata is:

[formula]

In the general case, when there is k cases in a strata of size m, with the cases being the first k observations, the conditional likelihood of a strata can be written: where Cmk is the set of all subsets of size k of the set [formula].

To obtain the full conditional likelihood, we multiply over each stratum and take the log  to obtain the log -likelihood [formula]: The score [formula] is then defined by: If [formula], the covariance matrix of [formula] is Fisher's information matrix: To test the hypothesis [formula], the score test statistic is:

Expressed using [formula], hypothesis [\eqref=null] becomes [formula]. As shown above, the null hypothesis of the paired Hotelling test is expressed using [formula], the mean of the difference between pairs, rather than [formula], the regression coefficient. There is no general correspondence between the two parameters. However, the two null hypotheses that are of interest in practice are the same: [formula].

For [formula], the score, Fisher's information matrix and the test statistic become: and

[formula]

Now that we have expressed analytically [formula] and [formula], we state our result in the following section.

Asymptotic equivalence

In this section, we introduce the sequence of local alternatives and state the result of asymptotic equivalence between the two tests.

We adopt the framework of [\cite=engle1984wald] for asymptotic equivalence. The motivation for considering a sequence of local alternatives is that any reasonable test will have the right size and will reject a fixed alternative when the number of observations becomes large. The sequence of local alternatives considers deviations from the null that approach the null as sample size increases. This allows to compare tests more precisely.

We model the sequence of local alternatives by a triangular array of observations [formula] that respects the following assumption. Let [formula] and Σ be a positive definite matrix of dimension p. The triangular array of Assumption [\ref=triangular] is the sequence of local alternatives. The parameter [formula] controls the deviation from the null. The null hypothesis is the special case of the sequence of local alternatives when [formula]. The [formula] in the denominator of the deviation shrinks the deviation towards the null as the sample size increases. This particular power of n ensures that the test statistics are well-behaved as they converge in distribution.

We denote [formula] (resp. [formula]) the statistic of the score test (resp. of the paired Hotelling test) associated with Z(n), the n-th line of the triangular array of Assumption [\ref=triangular]. In the same fashion as for the Student distribution and the χ2 distribution, the Hotelling distribution with degrees of freedom p and n - 1 and the χ2p distribution are different for finite samples but they are the same asymptotically. Therefore, [formula] is enough to guarantee asymptotic equivalence. Our theorem is more precise as it includes the convergence rate and limiting distribution of this difference. We note the convergence in distribution d.

Under the null or a sequence of local alternatives, the paired Hotelling test and the score test of CLR are asymptotically equivalent. More precisely, under Assumption [\ref=triangular], we have:

[formula]

where [formula] with V  ~  N(0,Σ) and N refers to the normal distribution.

Examples of distribution of K for p = 1, Σ  =  σ2 = 1 and different values of [formula] are shown in figure [\ref=distributionK]. We see that for small values of [formula], K is concentrated between 0 and 1 / 4. As [formula] grows, the distribution shifts to large, negative values.

For the practitioner, the result of Theorem [\ref=triangular] will not affect the choice of test but ensures that similar conclusions are reached regardless of that choice. The result also implies that CLR can be considered a generalization of the paired Hotelling or Student test when the conditions for the latter do not apply.

Proof of Theorem 1

To facilitate the notation, we omit the dependence in n in most quantities, writing Z instead of Z(n). The quantity we want to estimate is:

[formula]

where [formula].

The Lindeberg-Feller Central Limit Theorem for triangular arrays [\citep=hall_heyde] applied on the W(n)i gives:

[formula]

with V  ~  N(0,Σ). The weak law of large numbers for triangular arrays implies:

[formula]

Combining [\eqref=CLT] and [\eqref=LLN], we see:

[formula]

and, using the second identity in [\eqref=LLN2], we obtain: Applying Slutsky's lemma to all of the above, we conclude: where [formula] with V  ~  N(0,Σ). This concludes the proof of Theorem 1.

[formula]

Acknowledgements

The author thanks Gérard Biau for his supervision and his many comments on the manuscript. Funding: The author acknowledges a PhD grant from École Normale Supérieure.

References