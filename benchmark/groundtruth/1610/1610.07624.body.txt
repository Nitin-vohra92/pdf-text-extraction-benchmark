=1

Simulating cosmologies beyond ΛCDM with PINOCCHIO

Introduction

Here we briefly introduce the cosmological constant problem and the proposed theories aiming at solving it. We point out that a generic prediction of those theories is that the linear growth factor/rate depends on scale, a feature shared by the standard ΛCDM model in presence of massive neutrinos.

Dark energy

The discovery of the expansion of the Universe [\cite=Riess_98] [\cite=Perlmutter_99] [\cite=Schmidt_98] has revolutionized our understanding of cosmology. The standard model of cosmology assumes the existence of a cosmological constant: a fluid with an uniform and constant energy density having an equation of state PΛ =  - ρΛ that acts as a repulsive force and that is responsible for the expansion of the Universe on late times. That model is capable of reproducing extremely well a very diverse set of cosmological observations. However, the value of ρΛ differs significantly from that obtained from the natural scales of the early Universe, and therefore, reproducing its magnitude requires a huge fine-tuning.

In order to avoid that problem, models with mechanisms that naturally mimic the properties that a cosmological constant induce on cosmology at late times have been proposed. These models encompass new fields and interactions in the Universe, General Relativity modifications, cosmological models with extra dimensions, local deviations from the Copernican principle, and back-reaction effects of the formation of cosmic structures on the overall cosmological background (see [\cite=Amendola_2013] for a recent review). For some classes of theories, the observable consequences of gravity modification amount to a variation of the linear growth factor D(t) (and the linear growth rate, its logarithmic derivative with respect to the scale factor a, f = d log D / d log a) that can take a scale dependence: D(t,k).

A way to disentangle different models is through the spatial distribution of galaxies in the Universe. The reason behind is that galaxy clustering is sensitive to the underlying matter distribution and to the growth of matter perturbations, with different models predicting different outcomes. Several missions such as the Dark Energy Survey (DES) [\cite=DES], the Large Synoptic Survey Telescope (LSST) [\cite=Ivezic_2008] and EUCLID [\cite=Laureijs_2011] will shed light on the nature of dark energy by means of photometric and spectroscopic galaxy surveys.

Massive neutrinos

The presence of a linear scale-dependent growth is not limited to rather exotic models of modified gravity, but it also appears in the standard ΛCDM model when massive neutrinos are taken into account. We now provide a brief introduction on the importance of constraining the neutrino masses from cosmological observables, in particular from galaxy clustering.

The standard model of particle physics describes neutrinos as fundamental massless particles organized in three different families. The discovery of the neutrino oscillation phenomenon has however pointed out that at least two of the three neutrino families have mass [\cite=Fogli] [\cite=Tortola] and have established a lower bound on the sum of the neutrino masses: [formula]. This has been one of the most important discoveries of the last decades as it points towards the existence of physics beyond the standard model. On the other hand, being neutrinos the second most abundant particles in the Universe (see e.g. [\cite=Cosmology_Weinberg]), the fact that they are massive has important consequences for the growth and spatial distribution of matter on cosmological scales.

Determining the neutrino masses and their hierarchy is thus one of the most important goals in modern physics. Unfortunately, setting tight upper bounds on neutrino masses from laboratory experiments is a great challenge; current bounds on electron neutrino mass, from tritium β-decay, are mνe < 2.05 ~ eV  ~  (95%) [\cite=Kraus_2005] [\cite=Aseev_2011] and it is expected that in the near future KATRIN will lower that limit to mνe < 0.2 ~ eV  ~  (90%).

On the other hand, neutrino masses leave their signatures in many different cosmological observables. Therefore, it is also possible to constrain the sum of the neutrino masses using data from cosmological observations. In order to achieve this, it is very important to accurately understand, from the theoretical side, the impact that neutrino masses induce on cosmological observables, both at the linear, mildly non-linear and fully non-linear level.

At linear order, massive neutrinos induce two different effects on cosmology [\cite=LesgourguesPastor] [\cite=LesgourguesBook]. On the one hand they modify the matter-radiation equality time, that takes place at lower redshift in a massive neutrino cosmology than in the equivalent model with massless neutrinos. On the other hand, the growth of cold dark matter (CDM) perturbations on small scales is slower in a universe with massive neutrinos. These two effects leave distinct signatures on the anisotropies of the cosmic microwave background (CMB) and observations of those can thus be used to place constraints on the neutrino masses [\cite=Planck_2015]. Furthermore, the combination of the above two effects induces a suppression of power, on small scales, in the linear matter power spectrum at low-redshift in a massive neutrino cosmology with respect to the one of the massless neutrino model. Therefore, galaxy clustering can be used to determine the neutrino masses.

The effect induced by the neutrino masses is therefore embedded, among other probes, in CMB and large-scale structure data [\cite=Hannestad_2003] [\cite=Reid] [\cite=Thomas] [\cite=Swanson] [\cite=Saito_2010] [\cite=dePutter] [\cite=Xia2012] [\cite=WiggleZ] [\cite=Zhao2012] [\cite=Costanzi] [\cite=Basse] [\cite=Planck_2013] [\cite=Beutler_2014] [\cite=Wyman_2013] [\cite=Battye_2013] [\cite=riemer] [\cite=Hamann_2013] [\cite=Costanzi_2014] [\cite=Giusarma_2014] [\cite=Palanque-Delabrouille:2014jca] [\cite=2015JCAP...11..011P] [\cite=Cuesta_2015]. The current tightest constraint, [formula] (95% C.L.), has been achieved by combining data from the Lyα-forest, CMB and baryonic acoustic oscillations (BAO).

The amount of information contained in the linear regime is very large, but the one embedded into the mildly-non linear regime is much larger. Therefore, we can significantly improve our constraints on the value of the cosmological parameters, and in particular on the sum of the neutrino masses, by making accurate theoretical predictions in that regime. Recently, a huge effort has been carried out aiming at investigating, characterizing and finally understanding the impact of neutrino masses on the mildly and fully non-linear regime [\cite=LoVerde_2013] [\cite=Abazajian_2005] [\cite=Roncarelli_2014] [\cite=Fontanot_2014] [\cite=Baldi_2013] [\cite=Ma] [\cite=Wong] [\cite=Brandbyge_haloes] [\cite=Brandbyge_2008] [\cite=Paco_2011] [\cite=Paco_2012] [\cite=Paco_2013] [\cite=Castorina_2013] [\cite=Costanzi_2013] [\cite=Rossi_2014] [\cite=LoVerde_2014a] [\cite=LoVerde_2014b] [\cite=Ichiki_Takada] [\cite=Agarwal2011] [\cite=Bird_2011] [\cite=Wagner2012] [\cite=Viel_2010] [\cite=Villaescusa-Navarro_2012] [\cite=Marulli_2011] [\cite=Yacine-Bird] [\cite=Blas_2014] [\cite=Peloso_2015] [\cite=Castorina_2015] [\cite=Massara_halo_model] [\cite=Massara_voids]. Most of those studies involve running dedicated N-body simulations incorporating massive neutrinos, which are computationally expensive. Upper limits on the sum of the neutrino masses are expected to further shrink with future surveys as Euclid [\cite=Carbone_2011] [\cite=Costanzi] [\cite=Audren_2013] [\cite=Sartoris_2015] [\cite=Petracca_2015], DESI [\cite=Font-Ribera_2014] or SKA [\cite=Pritchard_2008] [\cite=Villaescusa-Navarro_2015b].

Purpose

A key ingredient required to transform galaxy clustering measurements into cosmological parameter values and errorbars is the covariance matrix of measurements, whose inverse enters the likelihood used to compute confidence levels for parameters. Accurately modeling that matrix requires running thousands of N-body simulations, which is computationally prohibitive in most of the cases. In order to circumvent this problem, approximate methods have been developed as PTHALOS [\cite=PTHALOS], Augmented Lagrangian Perturbation Theory (ALPT) [\cite=Kitaura_2013], PerturbAtion Theory Catalog generator of Halo and galaxY distributions (PATCHY) [\cite=PATCHY], Comoving Lagrangian Acceleration method (COLA) [\cite=Tassev_2013] [\cite=Tassev_2015] [\cite=L-PICOLA], Effective Zel'dovich approximation mocks (EZmocks) [\cite=EZmocks], FastPM [\cite=FastPM] and PINOCCHIO [\cite=Monaco_2002] [\cite=Taffoni_2002] [\cite=Monaco_2002b] [\cite=Monaco_2013] (see [\cite=Chuang_2015] for a comparison among the different methods and N-body simulations).

The above methods, including PINOCCHIO, are mostly designed to work for the standard ΛCDM model, where the linear growth factor and growth rate are scale-independent. The purpose of this work is to develop and validate a method that allows PINOCCHIO  to generate fast and accurate mock halo catalogues in cosmological models where the linear growth factor and the growth rate depend on scale. Our goal is therefore to provide the community with a tool that can be used, among many other things, to estimate covariance matrices, abundance and clustering properties of dark matter halos and determine amplitudes and errors from cross-correlations of cosmological observables with a high accuracy and predicting power in those models.

As we have seen above, examples of such models are modified gravity theories and the standard ΛCDM model with massive neutrinos. The method that we will outline in the next section is general, and can be employed in any model that exhibits a linear scale-dependent growth factor/rate. We will however focus our attention on cosmologies with massive neutrinos, and we will compare the results of our method against state-of-the-art N-body simulations with massive neutrinos.

The paper is organized as follows. In Sec. [\ref=sec:pinocchio] we quickly describe the PINOCCHIO code and depict the method used to extend its capabilities to massive neutrino cosmologies. The set of N-body simulations with massless and massive neutrinos run for this project is described in Sec. [\ref=sec:simulations]. The comparison between the abundance and clustering properties of dark matter halos from PINOCCHIO and from the simulations is presented in Sec. [\ref=sec:results]. Finally, a summary and the main conclusions of this work are outlined in Sec. [\ref=sec:conclusions].

PINOCCHIO and method implementation

In this section we briefly describe the PINOCCHIO  code and present the method we use to allow it to generate halo catalogues in cosmologies with a scale-dependent linear growth factor and growth rate, focusing in the particular case of models with massive neutrinos.

PINOCCHIO is a semi-analytic Lagrangian code that starts from a linear density contrast field, sampled on a regular cubic grid, and predicts, for each grid element (or particle), the time at which this is expected to collapse (to go into orbit crossing). This is done by smoothing the linear density contrast on many scales and using ellipsoidal collapse to compute the earliest time at which the particle is expected to collapse. Collapsed particles are then grouped into halos with an algorithm that mimics their hierarchical formation. The original code was presented by [\cite=Monaco_2002] and the massively parallel version in [\cite=Monaco_2013]. For this work we use the new version recently described in [\cite=Munari_2015], where displacements are computed using second-order Lagrangian Perturbation Theory (2LPT).

One of the assumptions on which the original PINOCCHIO code relies is that the growth factor D(t), is scale-independent, i.e. all perturbations grow at the same relative pace. The growth factor is then used as the time variable for the evolution of perturbations. In particular, the ellipsoidal collapse routine returns the growth factor at which the mass element is predicted to collapse.

Within the ΛCDM framework, massive neutrinos can be viewed as a secondary, diffuse, matter component with a large free-streaming velocity [\cite=Paco_2012] [\cite=Massara_halo_model], in contrast to the dominant CDM which is assumed to have negligible thermal velocities at any redshift. A proper calculation of the evolution and clustering of the massive neutrino fluid, together with its interaction and back-reaction with CDM in the fully non-linear regime would require the use of a Boltzmann plus an N-body code.

However, it is now well established that while massive neutrinos contribute to the expansion rate of the Universe their non-linear clustering is negligible [\cite=Ma] [\cite=Wong] [\cite=Paco_2011] [\cite=Paco_2012] [\cite=Ichiki_Takada] [\cite=Paco_2013] [\cite=Castorina_2013] [\cite=Costanzi_2013] for reasonable neutrino masses. One of the consequences of this is that the halo mass function and halo bias in a cosmology with massive neutrinos can be described in terms of the CDM plus baryons density field (instead of the total matter density field) [\cite=Ichiki_Takada] [\cite=Castorina_2013] [\cite=Costanzi_2013] [\cite=Castorina_2015]. Based on this finding, it is possible to generate mock halo catalogues in cosmologies with massive neutrinos using PINOCCHIO  by providing it the proper power spectrum.

In a cosmology with massive neutrinos, the evolution of matter perturbations is affected by the neutrino thermal velocities in such a way that the growth factor is both time and scale-dependent: D(t;R). We have adapted our code to deal with a scale-dependent linear growth factor, inherent to massive neutrino cosmologies as well as to some classes of modified gravity theories.

We now describe in detail the modifications performed to PINOCCHIO.

(i) Linear growth factors are obtained from the linear CDM plus baryons power spectrum Pcb(k,t). This is generated using the CAMB code [\cite=CAMB] for a given cosmological model. We used [formula] output times, logarithmically equally spaced in scale factor from z = 99 to z = 0.

Scale dependence implies that growth factors for density contrast in Fourier space differs from that for density and for displacements in configuration space, because these are obtained from different integrals of the power spectrum and in this case the growth factor cannot be factored out. So in place of a single D(t) function we have at least three functions of t and k, for the power spectrum, the density and the velocity or displacement. The growth factor in Fourier space is computed by taking ratios of Pcb(k,t) at different times: D2(t,k) = Pcb(k,t) / Pcb(k,t0). Growth factor for density, smoothed at the scale R (the same scales used to compute collapse times) with a Gaussian filter [formula] is

[formula]

where W̃(kR) is the Fourier transform of the window function and the normalization of the growth factor is assumed to be Dδ(t0,R) = 1 for all R, t0 being a reference time, typically corresponding to the last required output. For displacements:

[formula]

(ii) Growth factor is not used as a time variable any more. When the ellipsoidal collapse function is called for a smoothing radius R, it returns the growth factor Dcoll at which the particle is expected to collapse. Then the collapse redshift is computed by inverting the Dδ(z,R) function (equation [\ref=eq:growdelta]) at fixed R, and 1 + zcoll is used in place of the inverse growth factor of the original code.

(iii) Second-order growth factor of displacements for 2LPT is implemented using the approximation [\citep=Bouchet_1995]

[formula]

We notice that the above expression has been derived for a neutrinoless cosmology. Developing second order Lagrangian perturbation theory in presence of massive neutrinos is not trivial, so the above formula has to be considered as an approximation. We do not however expect large corrections to the above formula for cosmologies with realistic neutrino masses, and since we are dealing with second order corrections we consider that for our purposes here the above formula is accurate enough. We plan to investigate these issues in detail in a future work.

(iv) The creation of halo catalogues requires to compute displacements for particles and groups, both to decide whether accretion or merging must take place and to compute positions when writing the final catalog. Displacements are computed using the velocity growth factor of equation [\ref=eq:growvel]. For collapsing particles, the radius R to be used in the growth factor is the radius at which the earliest collapse is predicted, for groups we use their Lagrangian radius (N1 / 3pΔ, where Np is the number of particles in the halo and Δ the comoving inter-particle distance).

(v) Peculiar velocities are computed using growth rate functions f(Ω,R) = d ln Dv(a,R) / d ln a and f(2)(Ω,R) = d ln D(2)v(a,R) / d ln a, obtained numerically from the velocity growth factors.

Calibration of the parameters that regulate the construction of halos has been performed so as to optimize the agreement with the ΛCDM N-body simulation. This reproduces the analytic fit of [\cite=Crocce_MF] only at the 10% level, our calibration provides agreement at 5% level at [formula], so we are in fact fitting the discrepancies of simulations with respect to the analytic formula.

In order to check the robustness and validity of our method we carried out several tests. We now briefly discuss the most relevant ones that we performed for a massive neutrino cosmology. First, we used the total matter power spectrum in place of the CDM+baryons one as input for PINOCCHIO. Second, we used the density growth factor in place of the velocity one to compute displacements. We obtained significantly worse agreement with the halo mass function from N-body simulations in both cases. Third, we checked that results are insensitive to the choice of the reference redshift used to normalize the growth factors. Fourth, we tested the stability of results against the number of CAMB outputs, [formula], used to compute the growing modes. Figure [\ref=fig:GFtest] shows the relative changes of the mass function at z = 0 obtained by using [formula], 50, 20 and 10, all equally spaced in log a from z = 99 to z = 0. Results are very stable, to better than 5 %, down to [formula], while larger differences are obtained for smaller values. By using [formula] we are thus adopting a very conservative value; converged results at percent level are achieved with a lower number of CAMB outputs.

N-body simulations

In this section we describe the set on N-body simulations we have run for this paper. We have used these simulations to study how well our extension of PINOCCHIO works for cosmologies with massive neutrinos.

Our simulation suite comprises four different runs, each of them for a different model with different sum of the neutrino masses Mν  =  {0.0  ~  eV,0.3  ~  eV,0.6  ~  eV,0.9  ~  eV}. Relatively high values are adopted to obtain sizeable differences in the configuration we use. The simulation box size is 1000 comoving h- 1Mpc and within it we follow the evolution of 5123 cold dark matter particles plus 5123 neutrino particles (only for the massive neutrino models). When generating the initial conditions, we keep the module of the k-space modes equal to their average value given by the power spectrum, so as to keep sample variance low. The gravitational softening length for each particle type is set to 1 / 40 of their mean linear inter-particle distance. We save snapshots at redshifts z = {2,1,0.5,0}.

The initial conditions are generated at z = 99 using the Zel'dovich approximation. Linear matter power spectra and transfer functions are computed using the CAMB code [\cite=CAMB]. The mass-weighted power spectrum from the CDM and baryons power spectra, Pcb(k,z), is used to set up the initial conditions of the CDM particles, while for the neutrino particles we employ the neutrino power spectrum. Neutrino particles receive two different velocity components: a peculiar one arising from the gravitational potential and a second one to account for their thermal velocities. For the latter we set the amplitude by randomly sampling Fermi-Dirac momentum distribution of neutrinos, while the direction of the velocity vector is randomly chosen.

The values of the following cosmological parameters are the same for all runs: Ωm  =  0.3175, Ωb = 0.049, ΩΛ = 0.6825, h = 0.6711, ns = 0.9624, [formula] (in agreement with values provided by the Planck collaboration in 2015 [\cite=Planck_2015]). In the model with massless neutrinos Ων = 0 while in cosmologies with massive neutrinos Ων = Mν / (94.1h2  ~  eV). We set the value of ΩCDM to be Ωm  -  Ων  -  Ωb. Since the value of the scalar amplitude is the same in all models, the value of σ8 will be different in each cosmology: σ8  =  {0.834,0.760,0.690,0.628} for the models with Mν  =  {0.0  ~  eV,0.3  ~  eV,0.6  ~  eV,0.9  ~  eV}, respectively.

Besides the above four simulations we have run an additional simulation for a massless neutrino model. The value of the cosmological parameters of that simulation are exactly the same of the above model with 0.0 eV neutrinos, with the exception of [formula] and σ8 = 0.717. We use that simulation to study the well-known degeneracy between Mν and σ8 in the halo mass function. The value of σ8 of this simulation matches the value of σ8 computed from the CDM plus baryons linear density field of the simulation with Mν = 0.6 eV. In [\cite=Castorina_2013] it was argued that this situation maximizes the degeneracy.

In all simulations we identify dark matter halos by using the Friends-of-Friends (FoF) algorithm [\cite=FoF], taking b = 0.2 as the value of the linking length parameter. For our analysis we only consider halos containing at least 32 CDM particles. For cosmologies with massive neutrinos we identify the dark matter halos considering only the CDM field, as the presence of massive neutrinos can be safely neglected [\cite=Paco_2012] [\cite=Castorina_2013] [\cite=Massara_halo_model]. The masses of the FoF halos are further corrected to take into account the bias induced by particle discreteness according to [\cite=Warren_2006].

Results

In this section we present and discuss the main results of our analysis. We compare the properties of dark matter halos from PINOCCHIO  against those from simulations for different cosmologies with massless and massive neutrinos. The comparison is carried out by running PINOCCHIO  with the same cosmological models and random seeds as the N-body simulations, again keeping the module of k-space modes equal to their average value given by the power spectrum. In subsection [\ref=subsec:MF] we show the abundance of halos as predicted by PINOCCHIO and compare it against the results from N-body simulations and the fitting formula from Crocce et al. [\cite=Crocce_MF]. In subsection [\ref=subsec:degeneracy] we investigate whether PINOCCHIO  is able to reproduce the degeneracy between Mν and σ8 that affects the halo mass function. The clustering properties of the dark matter halos from PINOCCHIO and their comparison with simulations is presented in the subsection [\ref=subsec:clustering].

Halo abundance

In Fig. [\ref=fig:MF] we show with solid lines the halo mass function, obtained from the N-body simulations for cosmologies with massless and massive neutrinos at z = 0 (left) and z = 1 (right). As it can be seen, the higher the neutrino masses the lower the abundance of halos for a fixed mass at any redshift. That behavior is just a consequence of the suppression on the linear matter and CDM+baryons power spectrum induced by massive neutrinos on small scales [\cite=Marulli_2011] [\cite=Villaescusa-Navarro_2012] [\cite=Ichiki_Takada] [\cite=Castorina_2013] for models sharing the value of Ωm and As.

In that plot we also display with dashed lines the halo mass function for the different models using the fitting formula of Crocce et al. [\cite=Crocce_MF] that was obtained by fitting the abundance of dark matter halos (FoF halos) in the MICE simulations. For cosmologies with massive neutrinos we input the variance of the CDM plus baryons linear density field into the fitting formula instead of the variance of the total matter linear field, since it was pointed out in [\cite=Castorina_2013] that this reproduces much better then results of the N-body simulations (see also [\cite=Ichiki_Takada] [\cite=Castorina_2015] [\cite=Costanzi_2013]).

It can be seen that the agreement between the analytic fitting formula and the results of the N-body simulations is good at the 10% level, as already noted in [\cite=Castorina_2013]. Differences among the two are due to the low number of halos (in the high-mass end) and to the resolution (in the low-mass end) of the simulations.

The star points in Fig. [\ref=fig:MF] show the halo mass function for the different models obtained by employing PINOCCHIO. We find that the agreement between simulations, the analytic fit and PINOCCHIO is very good for all models at the two different redshifts considered in this work. In order to further quantify the agreement between PINOCCHIO and the results from simulations and the analytic fit, we plot in the middle and bottom panel of Fig. [\ref=fig:MF] the ratio between those. PINOCCHIO  has been calibrated to reproduce the mass function of the 0.0 eV simulation to within 5% in the range of masses ([formula]) where statistics is good. Because the agreement between the N-body mass function and the analytic fit is of order 10%, PINOCCHIO  is found to underestimates the analytic fit by the same amount. We find that at z = 0 the accuracy with which PINOCCHIO reproduces the halo mass function from the simulations remains stable for almost the whole mass range considered here for the four different cosmological models. We obtain deviations larger than 5% between simulations and PINOCCHIO for halo masses larger than [formula] for the model with Mν = 0.9 eV, where the number of objects that lie in that mass interval is low. Deviations of [formula] are also observed in the other models in the high-mass end of the mass function, possibly induced by the low statistics in that regime.

At z = 1 we find that PINOCCHIO  is able to reproduce the abundance of dark matter halos from simulations within 5 - 10% for all cosmological models with a weak dependence on halo mass. Again, the comparison for the Mν = 0.9 eV model is a bit more noisy, in particular in the high-mass end, since the number of halos in that cosmology is much lower than the one from the other models. When comparing the results from PINOCCHIO  against those from the fitting formula of Crocce et al. at z = 1 we find again agreement at the [formula] level. As with the results at z = 0, this discrepancy arises due to the imperfect matching between the halo mass function from simulations and the Crocce et al. fitting formula.

Overall we find very good agreement, at the 5 - 10% level, between the abundance of dark matter halos from N-body simulations, the Crocce et al. analytic fitting formula and PINOCCHIO for all the cosmological models and redshifts considered in this work. In particular, agreement between PINOCCHIO  and simulations is stable with neutrino mass, showing variations in excess of [formula]% only for the largest and unrealistic neutrino masses.

Mν  -  σ8 degeneracy

It is well known that a strong degeneracy between the cosmological parameters Mν and σ8 is imprinted on the halo mass function (see for instance [\cite=Carbone_2011] [\cite=Marulli_2011] [\cite=Castorina_2013] [\cite=Castorina_2015],[\cite=Costanzi_2013]). This fact severely limits the constraining power of the halo mass function to set, for instance, upper bounds on the sum of the neutrino masses. That degeneracy can however be broken by combining CMB and/or BAO observations with the halo mass function [\cite=Peloso_2015].

In this section we investigate how well PINOCCHIO is able to reproduce the mass function of simulations in this degenerate case. It was pointed out in [\cite=Castorina_2013] that cosmologies sharing the value of the cosmological parameters {Ωm,Ωb,ΩΛ,ns,σ8,cb} will exhibit a very similar, though not identical, halo mass function. σ28,cb represents the variance of the linear CDM plus baryons power spectrum when smoothed with a top-hat filter of radius 8 ~ h- 1Mpc.

We use two different cosmological models to study this degeneracy: 1) our model with Mν = 0.6 eV massive neutrinos and 2) a massless neutrino model having the same value of the cosmological parameters {Ωm,Ωb,ΩΛ,ns,σ8,cb} as the former cosmology. We notice that the difference between the latter model and our fiducial massless neutrino cosmology resides in the value of σ8, which is 0.717 in the former and 0.834 in the latter.

In Fig. [\ref=fig:degeneracy] we show the halo mass function of the two models at redshifts z = 0 and z = 1 from PINOCCHIO, N-body simulations and by using the fitting formula of Crocce et al. It can be seen that the halo mass functions of both models are very similar in shape, while there is a small offset (very hard to observe in practice) in amplitude among the two: the massless neutrino model presents a slightly higher abundance of dark matter halos in comparison with the model with massive neutrinos.

The difference in amplitude can be seen more clearly in the bottom panels of Fig. [\ref=fig:degeneracy], where we show the ratio between the halo mass functions of the models with massive and massless neutrinos. The different panels show the results when the ratio is taken using the outcome of the N-body simulations, PINOCCHIO  and the Crocce et al. fitting formula. By employing the analytic fitting formula we find that the ratio between the halo mass function of both models exhibits a very weak dependence on halo mass, with a difference in amplitude of [formula] at both z = 0 and z = 1. These results are corroborated by the ratio of the halo mass function from the N-body simulations, where the same trend and difference in amplitude is observed. Finally, we find that also PINOCCHIO produces two very similar mass functions with a small offset. In this case the offset is found to be of [formula]%, marginally smaller than the one found in simulations. The code is thus able to reproduce both the degeneracy and the small amplitude varitation apart from a 5% systematic difference when comparing PINOCCHIO and N-body results.

Halo clustering

We now compare the clustering properties of the dark matter halos from the N-body simulations and PINOCCHIO. We focus our attention on the 2-point (hereafter 2pt) statistics, that we measure using two different estimators: the correlation function and the power spectrum. In order to avoid problems related to mass resolution we only consider dark matter halos containing at least 100 particles for both the PINOCCHIO  and simulation catalogues, corresponding to a mass threshold of [formula]. Notice that this value slightly changes among cosmologies since the mass of the CDM particles depends on ΩCDM, which is different in each model.

A thorough test of the ability of PINOCCHIO to reproduce clustering of DM halos is presented in [\cite=Munari_2015], where it is shown that 3LPT allows to reproduce the halo-halo power spectrum, both in real and redshift space, to within 10% up to k = 0.3 - 0.5 ~ h ~ Mpc- 1. Conversely halo bias is recovered to within a few per cent. In this paper we use 2LPT and a lower mass resolution, that was shown in [\cite=Munari_2015] to give worse results for clustering. As a consequence, 10% accuracy in P(k) is reached at k = 0.2 h ~ Mpc- 1. Our goal here is to demonstrate that the same level of accuracy is reached when using a scale-dependent growth rate for a massive neutrinos cosmology.

For each cosmological model and for each data set (either from simulations or PINOCCHIO) we have computed the 2pt correlation function using the Landy-Szalay estimator [\cite=Landy_Szalay] both in real and redshift-space. The random catalogue we employ for the measurement contains 2 million points, more than 50 times the typical number of halos in the different catalogues. When computing distances among halos we take into account the periodicity of the boxes. In Fig. [\ref=fig:CF] we show the results for the different cosmological models in real and redshift-space at z = 0. We do not show results at z = 1 since the low number of halos present at that redshift makes our measurements rather noisy.

As shown in Fig.[\ref=fig:CF], at z = 0 PINOCCHIO  can reproduce the 2pt correlation function of dark matter halos from simulations within [formula] both in real and redshift-space for all the cosmological models considered here. On large-scales results are noisy since the number of pairs relative to the random catalogue decreases at large radii. On small scales we appreciate a discrepancy between the clustering amplitude from PINOCCHIO  and the simulations, amounting to a [formula]% of difference in linear bias. This is in line with the uncertainty quoted in [\cite=Munari_2015]. This difference is pretty stable with neutrino mass, with the possible exception of Mν = 0.9 eV model where bias gets somewhat larger.

We also compare the clustering properties of the dark matter halos from the simulations and PINOCCHIO in Fourier-space by computing the halo power spectrum. In Fig. [\ref=fig:Pk] we show the halo power spectrum at z = 0 and z = 1 from the N-body simulation and PINOCCHIO catalogues in real and redshift-space for the four different cosmological models with massive and massless neutrinos. We have subtracted the shot-noise level from the power spectrum measurements in all cases.

At z = 0 we find an excellent agreement, for all cosmological models, between the halo power spectrum from PINOCCHIO  and the simulations. The agreement, better than 5% for a wide range of scales, breaks down on small scales, for the reasons mentioned above. The halo power spectrum from the PINOCCHIO  catalogues agree at the 10%,20% level on scales as non-linear as k = 0.2,0.3 ~ h ~ Mpc- 1 both in real and redshift-space.

At z = 1 the agreement is a bit worse, but still at the level of 10% down to k = 0.3 ~ h ~ Mpc- 1 in real and redshift-space. Consistently with what noticed above, the most pronounced discrepancies between the halo power spectrum from PINOCCHIO  and the simulations take place for the Mν = 0.9 eV model, where linear bias is overestimated by [formula]%. We notice from Figure [\ref=fig:MF] that the match in the mass functions is less good for the highest neutrino mass, so a fixed cut in mass selects different halo populations that have different bias.

Overall, we find that, for all cosmological models but the one with the largest (and unrealistic) neutrino mass, the ability with which the PINOCCHIO code recovers the clustering properties of the dark matter halos is stable and independent of neutrino mass. Small (10%) discrepancies are found only for the Mν = 0.9 eV model.

Halo field

In this section we want to test the capability of PINOCCHIO  of reproducing the properties of the halo field from simulations such as its probability distribution function (pdf). We notice that a detailed test was presented in [\cite=Monaco_2013], for massless neutrino cosmologies, where it is shown that PINOCCHIO  is able to reproduce well the large-scale structure as compared to simulation, even if most massive haloes in PINOCCHIO tend to be more isolated than their simulation counterparts. Here we want to demonstrate that we can reach the same level of accuracy using a scale-dependent growth rate for a massive neutrinos cosmology: a first visual impression can be given using Fig.[\ref=fig:halo_comparison] where compute the halo spatial distribution obtained from PINOCCHIO  against the one from the N-body simulation for the models with Mν = 0.0,0.9 eV at z = 0, in a region of size 1000  ×  1000  ×  20,(h- 1Mpc)3. As it can be seen the agreement between the location and mass of dark matter halos from PINOCCHIO  and the simulations is remarkable.

In order to test the stability of the last result with neutrino mass in a more quantitative way, we have computed the pdf of the halo density field and its moments: in Fig.[\ref=fig:pdf_density] we show the ratio among the variance σ2, the skewness γ1 and kurtosis β2 computed from the halo catalogues from Pinocchio and the ones obtained from the simulations, for the different cosmological models explored in the paper at z = 0,0.5,1.0 : the agreement between the results is stable with neutrino mass, with the exception of the unrealistic 0.9  eV case where the assumption of treating neutrinos at the linear level becomes weak.

These results show that PINOCCHIO  is able to reproduce the halo spatial distribution at a remarkable level and these results are stable increasing the neutrino mass, up to the level in which neutrinos cannot be described under the linear assumption.

Summary and conclusions

The discovery that neutrinos are massive particles has profound implications in both particle physics and cosmology. From the particle physics side, the fact that neutrinos are massive requires an extension of the standard model of particle physics and to identify the field which gives then mass. For cosmology, it is expected that the growth and spatial distribution of matter in the Universe will be affected by neutrinos, since those are the second most abundant particles in the whole Universe.

One of the most important questions in physics is: what are the neutrino masses? The answer to this question is embedded into cosmological observables such as the spatial distribution of galaxies. Constraints on the value of the cosmological parameters, and in particular on the sum of the neutrino masses, via galaxy clustering, requires to compute the likelihood of a given model given the observed data. One of the fundamental pieces needed to estimate the likelihood is the covariance matrix of clustering statistics, whose accurate evaluation involves running thousands of N-body simulations, which is computationally prohibitive in most cases. In order to circumvent this problem, fast and accurate numerical tools have been developed with the goal of providing catalogues of dark matter halos whose abundance and clustering properties reproducing as close as possible those from N-body simulations. One of those codes is PINOCCHIO  [\cite=Monaco_2002] [\cite=Taffoni_2002] [\cite=Monaco_2002b] [\cite=Monaco_2013].

The purpose of the present work has been to extend the capabilities of PINOCCHIO  to be able to generate halo catalogues in cosmologies with a linear scale-dependent growth factor/rate, as models with massive neutrinos or some modified gravity theories. We have achieved this by proposing a new method where growth factors and growth rates are computed from the output of CAMB. In this paper we have focused on cosmologies with massive neutrinos for illustrative purposes. Our method relies on the fact that the abundance and clustering properties of dark matter halos in massive neutrino cosmologies depend only on the properties of the linear CDM plus baryons density field [\cite=Ichiki_Takada] [\cite=Paco_2013] [\cite=Castorina_2013] [\cite=Costanzi_2013] [\cite=Castorina_2015]. The estimated growth factors from CAMB outputs are then used in PINOCCHIO  to generate halo catalogues. We have carried out several tests to check the robustness of our method, showing that if PINOCCHIO  is input with incorrect power spectra or the same growth factor is used for both velocities and density, the properties of halos from PINOCCHIO  are significantly different to those from simulations.

In order to further validate the code we have compared, for different cosmologies with different neutrino masses, the properties of the halo catalogues generated by PINOCCHIO  against N-body simulations. We have focused our analysis on the abundance of dark matter halos (halo mass function) and on the clustering properties of those (2pt correlation function and power spectrum).

After a fine calibration performed on the Mν = 0.0 eV model (aimed at reproducing the discrepancies of the simulation with respect to the analytic fit of [\cite=Crocce_MF]), we find that PINOCCHIO  is able to reproduce the halo mass function from N-body simulations within 5% for cosmologies with neutrino masses ranging from Mν = 0.3 eV to Mν = 0.9 eV at both z = 0 and z = 1, with some ([formula]%) difference only for the largest and unrealistic neutrino mass.

We have also verified that PINOCCHIO  reproduces the well-known degeneracy between the cosmological parameters Mν and σ8 that affects the halo mass function. We emphasize that PINOCCHIO  is able to reproduce not only the absolute amplitude of the mass functions but also the relative differences among halo abundances from different models (to within 5%), which, for this particular case are very small. In both cases we find that PINOCCHIO  is capable of reproduce the spatial distribution of halos in real-space within [formula] at z = 0 and z = 1 down to k = 0.2 ~ h ~ Mpc- 1. We have also checked that the clustering properties of dark matter halos from N-body simulations are reproduced, for all the cosmological models considered in this work, at the same accuracy level demonstrated in [\cite=Munari_2015]. We have checked this using two different estimators for the halo clustering: the 2pt correlation function and the power spectrum. Finally in order to test the capability of PINOCCHIO  of reproducing the halo spatial distribution with neutrino masses against simulations, we have computed the moments of the halo density probability distribution function, showing that we can reach the same level of accuracy of [\cite=Monaco_2013] with realistic values of the neutrino mass. Furthermore, the peculiar velocities of dark matter halos from simulations are also very well reproduced by PINOCCHIO, as the clustering properties of dark matter halos from simulations and PINOCCHIO  agree at the [formula] level down to k = 0.2 ~ h ~ Mpc- 1 in redshift-space. We notice that in the case of the power spectrum at z = 0, PINOCCHIO  is able to reproduce the clustering of halos from simulations within 5% up to [formula] both in real and redshift-space. This is obtained using 2LPT and a relatively modest mass resolution. [\cite=Munari_2015] showed that even better results are obtained with 3LPT and working with a better resolution (after which convergence is reached). So, the main result of this paper is not the accuracy level reached but its constancy for [formula] eV, with some [formula]% differences found only for the highest neutrino mass.

The work presented in this paper extends the capabilities of PINOCCHIO, allowing it to predict the abundance, spatial distribution and peculiar velocities of dark matter halos in cosmologies with a scale-dependent growth rate of linear perturbations like the case of massive neutrinos. This same method can be applied to those classes of modified gravity theories where the main effect of modification is a specific, scale-dependent growth factor/rate. We emphasize that the time required to obtain a halo catalogue with PINOCCHIO  is a factor of [formula] lower than the time needed to obtain it from an N-body simulation, thus further supporting its use for an accurate prediction of cosmic covariances of clustering measurements also in non-Λ-CDM cosmologies.

Acknowledgements

N-body simulations have been run in the Zefiro cluster (Pisa, Italy). FVN has been supported by the Simons Foundation and by the ERC Starting Grant "cosmoIGM". PM acknowledges support from a FRA 2015 grant of Trieste University. SB acknowledges support from the PRIN-MIUR 201278X4FL grant “and from the PRIN-INAF/2012 Grant “The Universe in a Box: Multi-scale Simulations of Cosmic Structures”. We acknowledge partial support from "Consorzio per la Fisica - Trieste" and from the INFN IS PD51 “INDARK.