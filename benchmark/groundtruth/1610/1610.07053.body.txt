Event reweighting with the NuWro neutrino interaction generator

NuWro

NuWro [\cite=nuwro_12] is a neutrino interaction generator capable of producing predictions for neutrino-nucleus interactions at neutrinos of energies between 0.1 and 100 GeV. NuWro contains a wide variety of models and tuneable parameters, but until now it has had no facility to perform event reweighting. This has limited its use by experimental groups for anything more than final cross-section prediction comparisons. NuWro ReWeight was written to facilitate the use of NuWro at current and future neutrino interaction experiments.

Event Reweighting

Event generation is an inherently inefficient process. Generated event properties must be distributed correctly according to the model used. This is often achieved by rejection sampling: randomly throwing sets of interaction properties and accepting interactions with a probability proportional to the predicted cross-section for that event. When tuning free model parameters to data, many sets of model predictions must be generated to investigate how the model fits the data. It is often advantageous to 'reweight' model predictions to determine the response of varying free parameters rather than fully recalculating them. Each generated event comes with an associated 'weight' which is proportional to the probability for that event. Reweighting is the process of calculating a scaling factor which can be combined with the original event weight to give a new weight which would be correct if the event had been generated under some different set of free parameter values. This process involves no Monte Carlo techniques and so no computational time is 'wasted', it can be many orders of magnitude faster than re-generation. This significant boost in efficiency makes more involved studies of systematic uncertainty and goodness-of-fit feasible. Generating [formula] events using the NuMI on-axis flux was found to take [formula], while reweighting those events to a new prediction took [formula] on a single CPU core, and [formula] when parallelised over 32 cores.

NuWro now supports reweighting of free-nucleon model parameters for Charged Current Quasi Elastic (CCQE) [\cite=lsaccelreact_72] and single pion production (SPP) interactions--important interaction channels at beam energies of [formula]. Three free model parameters are available for SPP events: [formula] and [formula] are free parameters in the baryonic resonance form factors [\cite=GraczykSobczykFF_08]. The other free parameter, [formula] is a scale factor for the cross section of SPP through non-resonant processes. Figure. [\ref=fig:rwvalid] shows the effect of simultaneously varying [formula] and [formula] on the SPP Q2 distribution. It can be seen that the reweighting very precisely reproduces the fully re-generated prediction. Figure. [\ref=fig:dialresponse] shows the effect of reweighting the three parameters on the SPP cross section as a function of Q2 and [formula]. Increasing the value of [formula] and decreasing [formula] simultaneously results in a cross section prediction that is very similar to the nominal prediction over a large fraction of the Q2 range; this suggests that these parameters are strongly anti-correlated.

Comparison to Bubble Chamber data

To test the event reweighting, as well as the current predictions of NuWro, reweighting was used to tune the NuWro CCQE and SPP predictions to historic bubble chamber data from ANL [\cite=ANLCCQE_77] [\cite=ANL1pi_82] and BNL [\cite=BNLCCQE_81] [\cite=BNL1pi_86]. Comparison to bubble chamber data is important because interactions on deuteron targets are expected to only exhibit weak final state interaction effects [\cite=wu_15]. This allows tuning of the neutrino-nucleon interaction model. Subsequent comparison to nuclear-target data can be used to tune theoretical models of nuclear effects.

The global neutrino cross-section comparison framework, NUISANCE [\cite=NUISANCE], was used to jointly fit a number of published projections of the neutrino-mode CCQE and SPP event selections. A binned χ2 test between the generated (and reweighted) events and the released data was extremised to find the best fit parameter values. Event rate distributions, such as BNL CC1π+ Q2, Figure. [\ref=fig:bnlcc1pipq2], were included in a shape-only way. Cross sections, such as ANL CCQE flux-unfolded [formula], Figure. [\ref=fig:anlccqeenu], were also used in the fit. A consistent goodness of fit test, such as χ2 per number of degrees of freedom, is difficult to define because the bin-to-bin covariances were not provided with the data. The pre- and post-fit parameter values are presented in Table. [\ref=table:ANLBNLFitResults]. The fit converged and the best fit values of [formula] and [formula] were within the uncertainties of the nominal NuWro values. The best fit for [formula] was found to be lower than in [\cite=GraczykSobczykFits_09], however, this fit allowed the non-resonant background contribution to vary through [formula] and included a different subset of the available data. A similar value of [formula] was found in [\cite=valencia_deltaspp_10] . As part of the fit, MINUIT [\cite=minuitref_94] calculates an approximate parameter error matrix, the corresponding correlation matrix is shown in Figure. [\ref=fig:covmat]. This preliminary tune did not include comparison to any hadronic mass distributions--where the effect of [formula] and [formula] might be separable. Future tunes will include more data sets and further validation.

Event reweighting has been added to the NuWro event generator. This enables more sophisticated investigations into the compatibility of models with data, as well as determination of well motivated, correlated model uncertainties for use in neutrino scattering analyses.

References