Dynamics of suspended rigid aggregating particles in flowing medium: theory, analysis and scientific computing

Anthony J. Roberts

Keywords: surface adhesion, collision frequency function, Smoluchowski coagulation equations, multi-scale modelling, equation-free modelling, patch dynamics

Introduction

The process of particle aggregation in the presence of fluid flow, is indispensible in many important scientific and industrial applications. The aerosol pollutant aggregation within the atmosphere [\citep=Friedlander1977], cell aggregation in blood flow [\citep=Crowl2010], rheology of liquid crystal polymer suspensions [\citep=Calderer2004] [\citep=Forest2006] [\citep=Sircar2009], cluster growth of paramagnetic particles in microchannels [\citep=Promislow1995], adherence of medical gels with nano-particles for targeted drug delivery [\citep=Keener2011a], colloidal suspensions in pulp and paper-making industries as well as wastewater treatment plants [\citep=Somasundaran2005] are just some examples. The mechanism is spatio-temporally multi-scale, beginning with the coalescence of two surfaces at particle-scale (or micro-scale) and ensuing dynamics of particle agglomerates at the continuum-scale (or macro-scale). While the established experimental protocols have successfully described aggregation at macro-scale [\citep=Neelamegham1997], a clear understanding of the multi-scale relationships between the microscopic phenomena of surface adhesion and the macroscopic structure of the aggregating flocs, is lacking [\citep=Marshall2007]. The complexities involved at each scale of spatial structure of the aggregates, necessitate the development of novel multi-scale theory that dynamically relays information between the fine(micro)-scale to the bulk(macro)-scale. Therefore the motivation of this article is to develop a single, unified theory and approach that can capture the complex, dynamical evolution of the process of aggregation at each scale of spatial organisation.

Past investigations in the micro-scale modelling of fluid-borne surface adhesion have addressed some theoretical challenges. These include the ligand-receptor binding kinetics [\citep=Dembo1988], surface deformation [\citep=Hodges2002], excluded volume effects [\citep=Poland1992], paramagnetism [\citep=Promislow1995], short range interactions [\citep=Zhang2003] and flow past the surrounding surfaces [\cite=Goldman1967]. Consequently, many detailed kinetic models have successfully described the adhesion-fragmentation processes from the microscopic perspective. Schwarz [\citep=Korn2006] and more recently Mahadevan [\citep=Mani2012] studied the cellular adhesion between the ligand coated wall and a sphere moving in a shear flow. A similar model by Ranganathan [\citep=Ramesh2015] described surface adhesion via Langevin simulations. Although these micro-scale models correctly predict the fine-scale/particle level information, they have limited applications in validating large, industrial scale experiments [\citep=Somasundaran2005].

On the meso-level of spatial organisation are computational methods that fully resolve the coupling between the particles themselves and between the particles and the fluid. One example is the direct numerical simulation of the momentum equations in which multiple rigid or elastically deformable particles are present [\citep=Hu2001]. Recently, lattice Boltzmann [\citep=Crowl2010] and dissipative particle dynamics [\citep=Pivkin2006] also have been employed for this purpose. While these direct approaches fully resolve the dynamics at the particle scale and accurately capture the hydrodynamic interactions between particles in an aggregate, they are computationally expensive to implement [\citep=Brown2008].

As a result, a slew of macro-scale, coarse-grained approaches have emerged that allow explicit aggregate morphology to be retained while removing the full coupling between individual particles and the fluid [\citep=Mousel2010] [\citep=Marshall2007]. However, these approaches together with the continuum theories [\citep=Cogan2004], rely on phenomenological assumptions governing the geometry of the aggregates in fluid flow, in place of rigorous upscaling of the micro-scale models, thereby limiting their predictive power outside the range of parameters for which these models have been calibrated. In summary, each of these research efforts have focused on the hierarchical spatial structure using separate theories. Efforts to link the coupled multiscale dynamics of the aggregation mechanism, are limited [\citep=Mori2013].

Sciortino made a recent effort to couple the microscopic ligand kinetics of charged surfaces with the meso-macro general dynamic equations (GDE) governing particle aggregation dynamics, but those numerical studies were done with chemically inert particles [\citep=Corezzi2012]. Other examples in this direction includes developing probabilistic extensions of the Smoluchowski's multiplicative aggregation kernel in one [\citep=Odriozola2001] and two dimensions [\citep=MonchoJorda2001], with kernels containing one scaling parameter to be fit to data. Jia develop a method for predicting critical coagulant concentration via deriving a kernel incorporating surface charge density and potential as a function of the electrolyte [\citep=Jia2006]. Gilbert investigated and validated the forces and potentials for nanoparticles [\cite=Gilbert2007] while Babler and Morbidelli studied aggregation and fragmentation, but only driven by diffusion and shear flow [\citep=Babler2007]. Using a single theory, the present work attempts to resolve the complications involving the aggregation process at three different scales of spatial organisation, i.e., the physical difficulty of modelling the surface adhesion of two particles at micro-level, the computational pitfall of modelling multi-particle aggregation at meso-level and the computational expense of simulating the resultant GDE in large macro-scale domain (i.e., a long pipe in the current study). An innovative technique to connect the spatio-temporal dynamics between the micro-meso spatial scales, via the balancing of the forces and torques, is described. The computational challenge, at macro-scale, is tackled by developing an 'equation-free' patch dynamics method for the numerical macro-scale modelling of meso-scale system with fine scale details.

The article is laid out as follows. Section [\ref=sec:model] describes the comprehensive mathematical model. A physical model outlining particle collisions as function of particle size, is developed at micro-scale (§[\ref=subsec:micro]). The model explicitly accounts for the binding/unbinding of the tethers on the particle surface (§[\ref=subsubsec:Binder]) as well as the interaction of the charged surface with the ions dispersed in the fluid medium (§[\ref=subsubsec:LongRange]). An innovative mechanism between the micro-meso closure and the derivation of the collision frequency function is provided in §[\ref=subsubsec:Collision]. Next, the collision frequency function is then introduced into the GDE governing the spatially varying profile of particle size distribution function, [formula] (§[\ref=subsec:meso]). A cross-sectionally averaged, slow manifold solution is derived in §[\ref=subsubsec:manifold]. Finally, a patch dynamics method to numerically evaluate the slow manifold solution in 1-D cross-sectionally averaged domain is discussed in §[\ref=subsec:macro]. The simulation results are highlighted in §[\ref=sec:results], which is followed (in §[\ref=sec:conclusions]) with a brief discussion of the biophysical implication of these results and the focus of our future directions.

Mathematical model

The aim in this study is to explore how the adhesion mechanism for two rigid, spherical particles governed by the micro-hydrodynamics as well as the microscale surface forces including the attractive/repulsive forces in an ionic medium, bond stretching and finite resistance to rotation via bond tilting, impact the population balance of the aggregates in mesoscale as well as the evolution dynamics in a cross-sectionally averaged pipe flow at macroscale. This aim is achieved by numerically calculating the particle size distribution function, [formula]. In the following discussion, the lowercase and uppercase quantities (e.g., , ) will denote variables at the micro and the macro levels, respectively. The particle size distribution function is of our fundamental interest since most of the physical and chemical properties of flowing, particulate suspensions can be evaluated by taking appropriate moments, including the number concentration, mass concentration and aggregate structure tensors [\citep=Sircar2008].

Micro-scale kinetics

In this section, we derive the collision frequency function that describe the particle-particle interactions, β (eqn. ([\ref=eq:unsteadySmoluchowski]), §[\ref=subsec:meso]), using a combination of kinetic theory and problem-specific chemical, biological and physical sources of interactions. Each particle constitutes a rigid spherical core onto which linear, hookean, spring-like binding ligands (i.e. binders) are attached and the surface of the coalescing particles are linked through these ligands. We neglect the shearing effect of the fluid flow on the mean rest length of the binders as well as the spatial dependence in the material parameters. The effects of gravity, non-specific forces acting on the particles, as well as the roughness of the particle surface are neglected. We assume that subject to a finite tilting, the binders are fixed on the particle surface.

The fluid medium as well as the surface of the particles are charged, but only the effects of Coulombic repulsion and Van der Waals attraction are incorporated (§[\ref=subsubsec:LongRange]). Other interactions including hydration effects, hydrophobic attraction, short range steric repulsion, and polymer bridging, which are absent in the length scales of our interest, are neglected [\citep=Gregory2006]. The binder kinetics is assumed to be independent of the salt concentration (i.e. the spring stiffness, λ0 (§[\ref=subsubsec:Binder]) is independent of the charge-screening length, δ, and the zeta potentials, ψi (§[\ref=subsubsec:LongRange])). This implies that we are neglecting the electro-viscous stresses [\citep=Tabatabaei2010]. Finally, due to their relatively large micron-size scale, the binder kinetics of these particles are significantly different from the core-shell nano-crystal interactions, which are applicable at much smaller scales [\citep=Duval2008].

Binder kinetics

Figure [\ref=fig:Fig1]a illustrates the adhesion of two particles which are modelled as two rigid spheres, si (with radius ri) and sj (with radius rj), respectively. To simplify the visualisation of the micro-level dynamics, consider a moving frame, Rm, with origin Om (sometimes referred as the Lagrangian frame of reference) fixed on the surface of the sphere si at a point equidistant from the edge of the separation gap. The unit vectors for this frame of reference are [formula], [formula] and [formula]. For a given spatial point [formula] in this moving frame, the total relative velocity (of sphere si with respect to sj) is [formula], where the relative translational velocity, u, and the rotational velocity ω, are functions of the fluid velocity, [formula] (§[\ref=subsubsec:manifold]). Let d(x) be the vertical separation gap between the two spheres. Define [formula] as the number of bonds that are attached between the surfaces A and A + dA at time t. [formula] is the total number of binding ligands. The function g is synonymous with the term sticking probability [\citep=Somasundaran2005]. The total number of bonds formed is [formula] , where as  =  πr2s is the area of adhesion (refer §[\ref=subsubsec:Collision] for details on the radius of adhesion, rs). In further description of the model we denote [formula], without loss of generalisation.

The forward and reverse reaction rates for the binding ligands are then written as Boltzmann distributions, allowing highly stretched bonds to be readily broken by thermal energy fluctuations. The kinetics are also influenced by the surface potential of the two charged surfaces. Further, we cater for the ligands tilting by a finite angle α0 with respect to the vertical direction. This tilt is again expressed as a Boltzmann distribution, D(α0), such that a bond may form between the two spheres for a given angle [formula]. With these degrees of freedom, the bond attachment detachment rates are

[formula]

where kB is the Boltzmann constant, T is the temperature, l0 is the mean rest length of the binders, λ0 is the binder stiffness coefficient, and λs is the spring constant of the transition state used to distinguish catch (λ0  <  λs) from slip (λ0  >  λs) bonds [\citep=Dembo1988]. W(d) is the total surface potential described in §[\ref=subsubsec:LongRange]. As depicted in Figure [\ref=fig:Fig1]a, [formula] is the length of a bond in a stretched configuration. The energy associated with tilting a bond from its vertical position is (1 / 2)λθα20, (λθ being the torsion constant) and the corresponding Boltzmann distribution is

[formula]

where [formula] is the normalization constant for all possible tilt orientations along the flow-direction. Ignoring non-equilibrium binding kinetics (i.e., [formula]), in the limit of small binding affinity and abundant ligands on the binding surface (i.e., [formula]), the evolution equation for the sticking probability is [\citep=Dembo1988] [\citep=Reboux2008],

[formula]

Long range interactions

For two charged spheres, of radii ri,rj, the potential due to the repulsive Coulombic forces in the gap of size d is [\citep=Gregory2006]

[formula]

where δ is the Debye length, ε and ε0 the dielectric constant of vacuum and the medium, respectively, and ψ0, the average zeta potential of the diffuse cloud of charged counterions. The potential due to the Van der Waal forces for these spheres in the regime of close contact is

[formula]

where A is the Hamaker constant, measuring the Van der Waal 'two-body' pair-interaction for macroscopic spherical objects. The total surface potential is [formula], which is pair-wise attractive over short and long range, and pair-wise repulsive over intermediate range.

Collision frequency function

First, the mesoscale hydrodynamic forces, [formula], and torques, [formula], on two rigid spheres in Stokes' flow are listed. These were derived by O'Neill  [\cite=ONeill1970] using lubrication theory. At leading order in [formula], these expressions are

[formula]

where U is the cross sectionally averaged fluid flow (§[\ref=subsubsec:manifold]), [formula] and μ is the dynamic viscosity of the fluid. The superscripts (t,r,f) denote components arising from relative translation, rotation and the flow of the surrounding fluid, respectively. These hydrodynamic forces must balance the forces arising from all the bond interactions,

[formula]

The subscripts i = E,C,T denote extension, surface charges and torsion, respectively. The adhesion area of the circular patch is given by as  =  πr2s, where the adhesion radius, rs, is found by Mahadevan (details in supplementary material, [\citep=Mani2012]) using a scaling law argument of the 'settling phase of the particles',

[formula]

The coupling across the scales is obtained via the global force balance on the spheres in the horizontal and vertical directions, and the torque balance about the center of mass of the spheres (i.e., forces and torques from eqn. ([\ref=eq:macroscale_F]) with forces from eqn. ([\ref=eq:microscale_F])), which solves for the unknown variables, u,ω,d, i.e.,

[formula]

Finally, in a Stokes regime, the collision frequency function, β (eqn. ([\ref=eq:unsteadySmoluchowski]) in §[\ref=subsec:meso]), is proportional to the total microscale force, [formula], given by [\citep=Sircar2013]

[formula]

where [formula] is known as the aggregation contact efficiency parameter [\citep=Somasundaran2005]. The operator [formula] denotes the magnitude of a vector. We remark that in the case of static equilibrium (u = ω = 0) with no bond tilting effects on the binders ([formula]) the evolution of g (eqn. ([\ref=eq:coll_fac])) trivially reduces to

[formula]

and further, with perfect binding ([formula] so that g  →  Keq), the collision frequency reduces to

[formula]

where [formula] and [formula] are the respective volumes of the spheres. In a neutral solution with no dissolved ions (i.e., the Debye length, δ- 1  →  0), we have

[formula]

which is the collision frequency function for Brownian diffusion for hard spheres commonly used in many theoretical and experimental studies of aggregation [\citep=Friedlander1977] [\citep=Gregory2006]. To summarize, the micro-scale surface adhesion model of two particles has the following features:

Each particle constitutes a rigid spherical core onto which linear, hookean, spring-like binding ligands are attached. The surface of the coalescing particles are linked through these ligands. The ligand kinetics is mediated by the bond formation/breakage rates and modelled using eqn. [\eqref=eq:coll_fac].

The rigid core of the particles, is charged and suspended in an ionic medium. These effects are modelled via the repulsive Coulombic interactions (eqn. [\eqref=eq:CI]) and the attractive Van der Waal interactions (eqn. [\eqref=eq:VWI]).

The coupling between dynamics at the micro(particle)-level and the meso(cluster)-level, is achieved through the global balance of the meso-scale drag forces and couples (eqn. [\eqref=eq:macroscale_F]) with the micro-scale forces associated with the binder kinetics (eqn. [\eqref=eq:microscale_F]).

Meso-scale dynamics

Particle aggregation, diffusion together with convection determines the time rate of change of the particle size distribution function, [formula]. In this section a continuous GDE, sometimes referred as the population balance equation [\citep=Smoluchowski1916], is set up. By solving this equation for different initial and boundary conditions, the size distribution can be calculated for geometries and flow conditions of practical interest.

For a continuous distribution, the collision rate between particles of size [formula] and [formula] depends on the collision frequency function, [formula], described in §[\ref=subsubsec:Collision]. The net rate of formation of particles of size [formula], between the range [formula]-[formula]+d[formula], is given by

[formula]

where [formula] and [formula] are maximum and the minimum size of particle aggregates. The minimum size is trivially set to the size of 1 particle. The non-linear term, φ(n) (eqn. ([\ref=eq:steadySmoluchowski])), represents the time rate of change of the size-distribution in the absence of convection or diffusion. Alternatively, they can be interpreted as the 'steady-state' solution of the particle aggregates in a steady fluid flow (since ∂n / ∂t  =  U∂n / ∂x where U is the uniform fluid speed and x is the distance in the direction of flow). The factor of 1 / 2 in eqn. ([\ref=eq:steadySmoluchowski]) accounts for the double counting of the collisions in the integral. The GDE for continuous meso-scale size distribution, with (constant coefficient, D) convective diffusion in an incompressible fluid with velocity [formula], is

[formula]

The GDE is a nonlinear, partial integro-differential equation coupled across multiple spatial scales. We remark that the numerical experiments are set-up in a regime far away from turbulent flows, where particle fragmentation due to split [\citep=Neelamegham1997] and erosion [\citep=Pandya1983] are non negligible. The solution to the cross-sectionally averaged slow manifold of the number density in steady pipe-flow, is provided in §[\ref=subsec:macro].

Evolution of a slow manifold

This section justifies and constructs a model of the long-term dispersion of the particle aggregates along a long pipe that is carried by Poiseuille flow down the pipe [\citep=Mercer1994]. This approach, supported by center manifold theory, can be readily extended to cater for reactive [\citep=Wright2012] or sedimenting material [\citep=Suslov1999] in long pipes of complex and varying geometry [\citep=Mercer1994].

Consider the particle aggregates being carried by a fluid flow in a round pipe of radius a (Figure [\ref=fig:Fig1]c). We assume that the particles are neutrally buoyant, i.e., the particles have no effect on the density of the fluid so that concentration differences do not cause density differences that could generate secondary flows. The along pipe flow is the Poiseuille flow, [formula], where U is the cross-sectionally averaged downstream velocity (defined later). Using the pipe radius, a, and the time associated with cross-pipe diffusion, τ = a2 / D, as the characteristic length and time scale, the particle conservation pde ([\ref=eq:unsteadySmoluchowski]) reduces to

[formula]

for pouiseuille flow. [formula]. The boundary condition is that of zero diffusive flux on the wall,

[formula]

Note that the equilibria, n*, of the pde ([\ref=eq:pouiseuille]) satisfies [formula]. We find a slow manifold about such an equilibria and hence deduce a model global in size distribution and local to small ∂  /  ∂x, corresponding to the low wavenumber solution in Fourier space. Choosing to write the model in terms of the cross-pipe average, to an initial approximation, the slow manifold model is the trivial

[formula]

where the amplitude [formula] is defined via the projection, [formula], which is the cross-pipe average. Now seek to iteratively refine this model [\eqref=svdispcm0], using the corrections n̂(N,R,θ) ~ and ~ ĝ(N), where

[formula]

is a more refined model. Substituting into the advection diffusion pde ([\ref=eq:pouiseuille]) and neglecting products of the small corrections (i.e., - U∂n̂  /  ∂X,∂2n̂  /  ∂X2) gives

[formula]

where the subscript, X, denotes the longitudinal derivatives (see Figure [\ref=fig:Fig1]c). Using the approximation ([\ref=eq:step1]), the chain rule, [formula] and the identity [formula], we have

[formula]

Note that L is self-adjoint, upon defining the inner product [formula]. An adjoint eigenvector of this operator is z(R,θ)   =  constant. Projecting eqn. ([\ref=eq:step3]) in the space spanned by this eigenvector, gives which simplifies to

[formula]

as U(R) = 2U(1 - R2) has cross-sectional average of U by the non dimensionalisation. Using this update ĝ and the fact that there are no θ variations in the right-hand side of eqn. ([\ref=eq:step3]), the first correction n̂ can be found as [formula] where [formula]. The arbitrary constant of integration is found from the constraint that the cross-sectional average of every correction n̂ has to be zero. Correcting the initial model [\eqref=svdispcm0] with these n̂ and ĝ we deduce a refined model

[formula]

The Approximation Theorem suggests that the NXX term needs correction because the residuals in the equation resulting from this approximate model, (see the iterate, eqn. ([\ref=svdispcm2])), are of order 2 [\citep=Mercer1994]. Hence, following the above procedure, a second level of refinement leads to where [formula]. Higher order corrections of the estimate in eqn. ([\ref=svdispcm2]) can be easily derived using computer algebra. The reaction diffusion eqn. ([\ref=svdispcm2]) has an effective diffusion coefficient of 1 + U2  /  48, i.e., the effective rate of dispersion along the pipe is faster than what is predicted by simple cross-sectional averaging. The dimensional form of the model [\eqref=svdispcm2], is

[formula]

The extra dispersion (with coefficient U2a2 / (48D)), also called the shear dispersion, is proportional to the square of the velocity and inversely proportional to the cross-pipe diffusivity and implies that the smaller the molecular diffusion, the larger the shear dispersion, a paradox which is well established [\cite=Roberts2003].

Macro-scale evolution: patch dynamics

Solution within each patch

We construct jth patch of width (2k + 1)h and denote it with macro-scale lattice point Xj (Figure [\ref=fig:Fig2]a). k is the patch half-width and h is the meso-scale lattice spacing. First step, for each point within a patch and for every time-step, the non-linear aggregation term, φ(n) (eqn. ([\ref=eq:steadySmoluchowski])), is calculated. The integrals (eqn. ([\ref=eq:microscale_F])) in the collision frequency function (eqn. ([\ref=eq:collisionFreq])) using the adaptive Lobatto quadrature (via Matlab function quadl). The function, φ(n), is numerically evaluated by employing the Galerkin approximation scheme developed by Banks [\citep=Kappel1989] and adopted by others [\citep=Sircar2010]. While evaluating the integrals in eqn. ([\ref=eq:steadySmoluchowski]), we chose [formula] femtoliter (fL) as a lower bound in our simulations, since the radius of the smallest aggregate (consisting of a single particle) was of the order of a micron. In our discrete aggregation model we chose the upper bound, [formula] fL and the volume resolution of N = 100 bins per fL. Other parameters used in the simulation are listed in Table [\ref=tab:parameter] (see §[\ref=sec:results]). As reported in [\citep=Kappel1989], the convergence of this first order approximation scheme was tested and a linear (first order) relationship was found between the l∞-error of the solution and the mesh-size, δu (δu being the discretisation in the aggregate volume). The non-dimensional advection-reaction-diffusion equation ([\ref=svdispcm2]) is discretised using the standard Crank-Nicolson scheme. The non-linear reaction term is treated explicitly. Although the size of the domain is arbitrarily fixed at K = 100 patches, the reason for the choice the patch half-width, k, buffer half-width, b, and the lattice spacings, h,H, is explained in §[\ref=sec:results]. Physical inlet and exit conditions are needed for the macro-scale solution in the first patch, X1, and the last patch, XK, respectively. The conditions are [\citep=Roberts1992], where κ = 2 / 105, n1(t) is the prescribed particle size distribution across the domain entrance. The overbar ( [formula] ), denotes the cross-stream average and the operator [formula] denotes the convolution, [formula]. The functions r1 is given by

[formula]

The inlet condition ([\ref=eq:inlet]) ensures that the second order shear dispersion model ([\ref=eq:reducedModel]) is accurate after the entry transients have disappeared and the exit condition ([\ref=eq:outlet]) ensures that the exit does not have an upstream influence (via diffusion) [\citep=Roberts1992]. In following discussions, we drop the overbar over the variables, so that n = n(x,t) is the cross-sectionally averaged particle size distribution function.

Extracting macroscale field

After eqn. ([\ref=eq:dispfpm]) is solved within the jth patch for nij, together with the coupling conditions (§[\ref=subsubsec:patch3]), we define a macro-scale solution field within each of these patches. We propose a macro-scale solution, referred as the patch amplitude from hereon, as an average over the meso-scale field within the patch 'core' (Figure [\ref=fig:Fig2]b),

[formula]

where b is the patch-buffer half width, such that 0  ≤  b  <    k. Some patch dynamics methods extract the macro-scale solution by trivially using the meso-scale solution at the patch center, corresponding to b  =  0 [\citep=Roberts2001]. However, unlike the 'rough' micro-scale structure in the present setup, these methods are for 'smooth' micro-scale dynamics with only slight variations within patches.

Coupling condition between patches

Two coupling conditions are required to solve eqn. ([\ref=eq:dispfpm]), at each end within the jth patch. These conditions are derived from an interpolation of the macro-scale field, Nj, from its nearest macro-scale neighbours, [formula] To write these conditions, we define a fractional step r, connecting the spacing between the meso-scale domain, h, and the macro-scale domain, H, such that rH  =  (k - b)h (Figure [\ref=fig:Fig2]b). We also define the meso-scale and the macro-scale step operators, [formula], such that ε±  1nij = ni  ±  1j and [formula], respectively. Thus, [formula]. Finally, we introduce the macro-scale mean and difference operators, [formula] and [formula], respectively. Using the condition ([\ref=eq:amplitude]), note that

[formula]

which are the required coupling conditions. The ≈   can be replaced with an equality provided Γ  →    ∞  . Detailed discussion on the theoretical support for patch dynamics are provided elsewhere [\citep=Roberts2001]. Finally, it has been shown that it is possible define arbitrary patch coupling conditions, provided suitably large buffers are chosen to shield the patch 'core' from unwanted consequences of these coupling conditions over short evaluation times [\citep=Samaey2006]. To summarise, given the macro-scale solution, Nj(tn - 1) at time tn - 1, the patch dynamics algorithm for finding the macroscale solution , Nj(tn) at time tn, is

Using the micro-scale field variables evaluated at time tn - 1, setup the non-linear reaction term, φ(n) (eqn. ([\ref=eq:steadySmoluchowski])), within each patch j.

Numerically solve eqn. ([\ref=eq:dispfpm]), together with coupling conditions ([\ref=eq:couplingConditions]) within all patches j, such that Nj = Nj(tn - 1).

From the amplitude condition ([\ref=eq:amplitude]), determine the macro-scale solution at time tn for all macro-scale points Xj (Figure [\ref=fig:Fig2]a), such that nij = nij(tn),Nj = Nj(tn).

Using the macro-scale solution Nj(tn) evaluated in Step 3, return to Step 1 to determine the solution at time step tn + 1.

The computational technique is 'equation-free' since no attempt is made to derive an explicit macro-scale model. The procedure simply evaluates 'on the fly' numerical solutions of the model at each macro-scale point, Xj, and time-step, tn.

Numerical results: dynamics of cross sectionally averaged size distribution

Table [\ref=tab:parameter] lists the parameters used in our numerical calculations. The parameter values are chosen so that they closely replicate the adhesion-fragmentation of neutrophiles in slow viscous flow conditions. For example, the p-selectine molecule extends about 40 nm from the endothelial cell membrane, so when combined with its ligand psgl-1 it is reasonable to take l0  ≈  100 nm as an estimate of the length of the unstressed bond [\citep=Shao1998]. Hochmuth measured variations of up to three orders of magnitude in vivo in measuring the values of the microvillus stiffness, λ0 [\citep=Shao1998]. Direct measurements of the parameters, [formula], [formula] and [formula] are scarce, although values in several thousands have been used in previous models [\citep=Hammer1996]. Since we do not wish to study the effects of finite rotation of the ligands [\citep=Reboux2008] or the effect of catch-versus-slip bonds [\citep=Dembo1988], the corresponding parameters related to these material properties are fixed at  = 1.0 and  = 0.5 , respectively. The dielectric constant in vacuum is εD0  =  8.854  ×  10- 12 Farad m- 1, whereas the permittivity of water at temperature [formula]C is εD = 78.5 (not to be confused with ε which is a length ratio defined in §[\ref=subsubsec:Collision] (eqn. ([\ref=eq:macroscale_F])) or the macroscale step operator, [formula], defined in §[\ref=subsubsec:patch3]). The dissolved salt (furnishing the ions in the fluid) is assumed to be a 1-1 electrolyte with a zeta potential of ψ0 = 25 mV (corresponding to the surface potential studies by Gregory [\citep=Gregory2006]). We assume that the solute concentration in the fluid only effects the Debye length, δ. The Boltzmann factor is taken as kBT = 3.1  ×  10- 21 J. Finally the cross-sectionally averaged fluid speed is fixed at U = 1.5 (eqn.( [\ref=svdispcm2])), to ensure the correct application of the inlet and exit conditions on the macro-domain (eqn.( [\ref=eq:BC])), developed by Roberts [\citep=Roberts1992].

Case φ(n) = 0: error analysis

First, the overall performance of the numerical method is tested for the advection-diffusion system, since an analytical solution is available in this case. We choose an initial profile, n(x = 0,t = 0) = 1, the numerical time-step, [formula]. The l∞ error is evaluated for four different values of the meso-scale spacing, h = 0.025,0.03,0.035,0.04, which removes the possibility of any spurious oscillations of the approximate solution, as predicted by Von Neumann stability analysis (i.e., [formula], where [formula], eqn. ([\ref=svdispcm2])). The application of Crank-Nicolson method implies second order accuracy of the method within each patch. Figure [\ref=fig:Fig3] highlights that the method is second order accurate in the macro-scale, as well (since all curves in the log   -  scale of the l∞ error versus meso-scale spacing, h, has slope=2). The patch half-width is fixed at k = 10. To choose an optimal value of the buffer half-width, b, and the meso-scale macro-scale spacing ratio, r, notice that since the patches cannot overlap, 0 < r < 0.5. Further, lower values of r implies that the patches are further apart. Lower value of r (i.e., r = 0.01) and no averaging within each patch (i.e., b = 0, the curve ([formula]) in Figure [\ref=fig:Fig3]) implies that the information is relayed between the scales with minimum computational effort. Consequently the numerical error is highest in this case, among all selected choices of (b,r). Alternatively, close patches (i.e., r = 0.49) with maximal buffer half-width size (i.e., b = 9, the curve ([formula])) leads to the lowest error with the selected values of (b,r), but the advantage of patch scheme (to perform computations widely spaced patches, is lost). We choose b = 5,r = 0.10, (the curve ([formula])) which keeps the numerical error reasonably low while maintaing the advantage of the method. Our choice of b  ≈  k / 2 has been corroborated as an ideal one, in other applications [\citep=Roberts2001] [\citep=Samaey2006].

Conclusion

By analysing the emergent, large scale, evolution we showed that patch dynamics macroscale modelling is able to capture the emergent dynamics of a microscale lattice system when the microscale has fine detail. For best results it is important to appropriately choose the patch geometry, defined by the patch half-width n, and the patch coupling conditions, defined by the buffer half-width b, relative to the underlying period K of the microscale detail. We showed that the symmetry of the microscale model is important and should be reflected in the choice of patch geometry and coupling conditions. We expect that other microscale models require similar consideration when implementing patch dynamics for macroscale modelling.

Acknowledgements

SS acknowledges the financial support from Dr. David Bortz in Dept. of Applied Mathematics, University of Colorado, Boulder, where the work started initially. The authors thank Dr. Judith Bunder in the Department of Mathematical Sciences, Adelaide University, for helping at various stages of the development of the numerical method.