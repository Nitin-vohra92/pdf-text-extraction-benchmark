On the NP-Completeness of Some Graph Cluster Measures

Institute of Computer Science, Academy of Sciences of the Czech Republic, P. O. Box 5, 18207 Prague 8, Czech Republic, sima@cs.cas.cz Satu Elisa Schaeffer

Laboratory for Theoretical Computer Science, Helsinki University of Technology, P. O. Box 5400, FI-02015 TKK, Finland, elisa.schaeffer@tkk.fi

Introduction

Clustering is an important issue in the analysis and exploration of data. There is a wide area of applications in data mining, VLSI design, parallel computing, web searching, software engineering, computer graphics, gene analysis, etc. See also [\cite=Jain99] for an overview. Intuitively clustering consists in discovering natural groups (clusters) of similar elements in data set. An important variant of data clustering is graph clustering where the similarity relation is expressed by a graph. In this paper, we restrict to unweighted, undirected graphs with no self-loops.

We first recall some basic definitions from graph theory. Let G = (V,E) be an undirected graph and denote by E(S) = {{u,v}∈E  ;  u,v∈S} the set of edges in a subgraph G(S) = (S,E(S)) induced by a subset of vertices S  ⊆  V. We say that S  ⊆  V creates a clique of size |S| if edges in [formula] join every two different vertices in S. Further denote by dG(v) = |{u∈V  ; {u,v}∈E}| the degree of vertex v∈V in G. We say that graph G is a cubic graph if dG(v) = 3 for every v∈V. Moreover, any subset of vertices A  ⊆  V creates a cut of G, that is a partition of V into disjoint sets A and [formula]. The size of cut A is defined as

[formula]

and

[formula]

denotes the sum of degrees in cut S  ⊆  V.

A canonical definition of a graph cluster does not exist, but it is commonly agreed that a cluster should be a connected subgraph induced by a vertex set S with many internal edges E(S) and few edges to outside vertices in [formula] [\cite=Broder00] [\cite=Kannan00]. In this paper we consider several locally computable fitness functions that are used for measuring the quality of a cluster within the graph. The prominent position among graph cluster measures is occupied by the conductance [\cite=Brandes03] [\cite=Cheng05] [\cite=Flake02] [\cite=Gkantsidis03] [\cite=Kannan00] which is defined for any cut [formula] in graph G as follows

[formula]

Furthermore, the local density δG(S) [\cite=Virtanen03] (cf. the average degree [\cite=Holzapfel03]) of a subset [formula] in graph G is the ratio of the number of edges in subgraph G(S) induced by S over the number of edges in a clique of size |S| vertices, that is

[formula]

for S containing at least two vertices whereas define δG(S) = 0 for |S| = 1. Similarly, we define the relative density [\cite=Mihail02] of cut [formula] as follows

[formula]

Yet another graph cluster measure which we call single cluster editing (cf. [\cite=Shamir02]) of a subset S  ⊆  V counts the number of edge operations (both additions and deletions) needed to transform S into an isolated clique:

[formula]

Proposed clustering algorithms [\cite=Brandes03] [\cite=Jain99] [\cite=Mihail02] [\cite=Schaeffer05] usually search for clusters that are optimal with respect to the above-mentioned fitness measures. Therefore the underlying optimization problems of finding the clusters that minimize the conductance or maximize the densities or that need a small single cluster editing are of special interest. In this paper we will formally prove that the associated decision problems for the conductance (Section [\ref=conductance]), local and relative densities (Section [\ref=densities]), and single cluster editing (Section [\ref=editing]) are NP-complete. These complexity results appear to be well-known or at least intuitively credible, but not properly documented in the literature.

Conductance

Finding a subset of vertices that has the minimum conductance in a given graph has been often stated to be an NP-complete problem in the literature [\cite=Arora04] [\cite=Brandes03] [\cite=Carrasco03] [\cite=Flake02] [\cite=Kannan00] [\cite=Leighton99] [\cite=Lovasz96]. However, we could not find an explicit proof anywhere. For example, the NP-completeness proof due to Papadimitrou [\cite=Shi00] for the problem of finding the minimum normalized cut which is in fact the conductance of a weighted graph does not imply the hardness in the unweighted case. Thus we provide the proof in this section. The decision version for the conductance problem is formulated as follows:

Minimum Conductance ( Conductance) Instance: An undirected graph G = (V,E) and positive integer φ. Question: Is there a cut S  ⊆  V such that ΦG(S)  ≤  φ  ?

Conductance is NP-complete.

Proof: Clearly, Conductance belongs to NP since a nondeterministic algorithm can guess a cut S  ⊆  V and verify ΦG(S)  ≤  φ in polynomial time. For the NP-hardness proof the following maximum cut problem on cubic graphs will be reduced to Conductance in polynomial time.

Maximum Cut for Cubic Graphs ( Max Cut-3) Instance: A cubic graph G = (V,E) and positive integer a. Question: Is there a cut A  ⊆  V such that cG(A)  ≥  a  ?

The Max Cut-3 problem was first stated to be NP-complete in [\cite=Yannakakis78] which became a widely used reference [\cite=Garey79] although an explicit proof cannot be found there and we were unable to reconstruct the argument from the sketch. Nevertheless, the NP-completeness of Max Cut-3 follows from its APX-completeness presented in [\cite=Alimonti00]. The following reduction to Conductance is adapted from that used for the minimum edge expansion problem [\cite=Kaibel01].

Given a Max Cut-3 instance, i.e.  a cubic graph G = (V,E) with n = |V| vertices, and positive integer a, a corresponding undirected graph G' = (V',E') for Conductance is composed of two fully connected copies of the complement of G, that is [formula] where Vi  =  {vi  ;  v∈V} for i = 1,2, and [formula] where [formula] for i = 1,2, and E3  =  {{u1,v2}  ;  u,v∈V}. In addition, define the required conductance bound

[formula]

The number of vertices in G' is |V'| = 2n and the number of edges |E'| = (2n - 4)n since

[formula]

due to G is a cubic graph. It follows that G' can be constructed in polynomial time.

For a cut [formula] in G' with k = |S|  ≤  2n vertices denote by

[formula]

the cuts in G that are projections of S to V1 and V2, respectively. Since [formula] it holds [formula] according to definition ([\ref=conductS]). Hence, k  ≤  n can be assumed without loss of generality when computing the conductance in G'. Thus,

[formula]

follows from condition ([\ref=degG']) and the fact that G' is composed of two fully connected complements of G, which can be rewritten as

[formula]

Now we verify the correctness of the reduction by proving that the Max Cut-3 instance has a solution if and only if the corresponding Conductance instance is solvable. First assume that a cut A  ⊆  V exists in G whose size satisfies

[formula]

Denote by

[formula]

the cut in G' whose projections ([\ref=projS]) to V1 and V2 are SA1 = A and [formula], respectively. Since |SA| = n and [formula] the conductance of SA can be upper bounded as

[formula]

according to equations ([\ref=condG'2]), ([\ref=cuta]), and ([\ref=phi]), which shows that SA is a solution of the Conductance instance.

For the converse, assume that the conductance of cut [formula] in G' meets

[formula]

Let A  ⊆  V be the maximum cut in G. For cut SA defined according to ([\ref=SA]) we prove that

[formula]

which is rewritten to

[formula]

according to ([\ref=PhiSA]) and ([\ref=condG'2]) where k = |S|  ≤  n and S1,S2 are defined in ([\ref=projS]). Since 2cG(A)  ≥  cG(S1) + cG(S2) due to A is the maximum cut in G, it suffices to show

[formula]

which follows from [formula] and cG(S1) + cG(S2)  ≤  |S1|  ·  n + |S2|  ·  n = kn. Thus,

[formula]

holds according to ([\ref=PhiSA]), ([\ref=PhiSAleqPhiS]), ([\ref=condphi]), and ([\ref=phi]), which implies cG(A)  ≥  a. Hence, A solves the MAX CUT-3 instance. [formula]

Local and Relative Density

The decision version of the maximum density problem is formulated as follows:

Maximum Density ( Density) Instance: An undirected graph G = (V,E), positive integer k  ≤  |V|, and a rational number 0  ≤  r  ≤  1. Question: Is there a subset S  ⊆  V such that |S| = k and the density of S in G is at least r  ?

We distinguish between Local Density and Relative Density problems according to the particular density measure used which is the local density ([\ref=ldensityS]) and the relative density ([\ref=rdensityS]), respectively. Clearly, Local Density is NP-complete since this problem for r = 1 coincides with the NP-complete Clique problem [\cite=Karp72]. Also the NP-completeness of Relative Density can easily be achieved:

Relative Density is NP-complete.

Proof: Obviously, Relative Density belongs to NP since a nondeterministic algorithm can guess a cut S  ⊆  V of cardinality |S| = k and verify ϱG(S)  ≥  r in polynomial time. For the NP-hardness proof the following minimum bisection problem on cubic graphs which is known to be NP-complete [\cite=Bui87] will be reduced to Relative Density in polynomial time.

Minimum Bisection for Cubic Graphs ( Min Bisection-3) Instance: A cubic graph G = (V,E) with n = |V| vertices and positive integer a. Question: Is there a cut S  ⊆  V such that [formula] and cG(S)  ≤  a  ?

Given a Min Bisection-3 instance, i.e.  a cubic graph G = (V,E) with n = |V| vertices, and positive integer a, a corresponding Relative Density instance consists of the same graph G, parameters [formula] and

[formula]

Now for any subset S  ⊆  V such that [formula] it holds

[formula]

due to G is a cubic graph, which gives

[formula]

according to ([\ref=rdensityS]). It follows from ([\ref=defr]) and ([\ref=rhoGS]) that ϱG(S)  ≥  r iff cG(S)  ≤  a. [formula]

Single Cluster Editing

The problem of deciding whether a given graph can be transformed into a collection of cliques using at most m edge operations (both additions and deletions) which is called Cluster Editing is known to be NP-complete [\cite=Shamir02]. When the desired solution must contain exactly p cliques, the so called p-Cluster Editing problem remains NP-complete for every p  ≥  2. Here we study the issue of whether a given graph contains a subset S of exactly k vertices such that at most m edge additions and deletions suffice altogether to turn S into an isolated clique:

Minimum Single Cluster Editing ( 1-Cluster Editing) Instance: An undirected graph G = (V,E), positive integers k  ≤  |V| and m. Question: Is there a subset S  ⊆  V such that |S| = k and εG(S)  ≤  m  ?

1-Cluster Editing is NP-complete.

Proof: Obviously, 1-Cluster Editing belongs to NP since a nondeterministic algorithm can guess a subset S  ⊆  V of cardinality |S| = k and verify εG(S)  ≤  m in polynomial time. For the NP-hardness proof the Min Bisection-3 problem is used again (cf. the proof of Theorem [\ref=reldensNP]) which will be reduced to 1-Cluster Editing in polynomial time.

Given a Min Bisection-3 instance, i.e.  a cubic graph G = (V,E) with n = |V| vertices, and positive integer a, a corresponding 1-Cluster Editing instance consists of the same graph G, parameters [formula] and

[formula]

Now for any subset S  ⊆  V such that [formula] it holds

[formula]

according to ([\ref=scledit]) and ([\ref=cubES]). It follows from ([\ref=defm]) and ([\ref=epsGS]) that εG(S)  ≤  m iff cG(S)  ≤  a. [formula]

Conclusion

In this paper we have presented the explicit NP-completeness proofs for the decision problems associated with the optimization of four possible graph cluster measures; namely the conductance, the local and relative densities, and single cluster editing. In clustering algorithms, combinations of fitness measures are often preferred as only optimizing one may result in anomalies such as selecting small cliques or connected components as clusters. An open problem is the complexity of minimizing the product of the local and relative densities [\cite=Schaeffer05] (e.g. their sum is closely related to the edge operation count for the single cluster editing problem). Another important area for further research is the complexity of finding related approximation solutions [\cite=Arora04].