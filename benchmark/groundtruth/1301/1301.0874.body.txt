Closed forms for a multigraph enumeration

Introduction

Denote by I(n,k) the sum of the inverses of the orders of the groups of automorphisms of all the pairwise non-isomorphic connected multigraphs on n vertices and cyclomatic number k. The third author, in joint work with Oeckl [\cite=MeOe:loop], used the symmetric algebra on a vector space to derive a recursion formula for generating certain linear combinations of tensors over the rational numbers. The tensors represent connected multigraphs (with loops and multiple edges allowed) on the same number of vertices and on the same cyclomatic number. The formula produces larger multigraphs from smaller ones by increasing by 1 the number of their vertices or the number of their edges. The key feature is that the sum of the coefficients of all the tensors representing isomorphic multigraphs is the inverse of the order of their group of automorphisms. Note that, in this setting, the order of the group of automorphisms of a multigraph consisting of an isolated vertex with s loops is 2ss!. Also, the order of the group of automorphisms of a multigraph consisting of two vertices joined by r multiple edges is 2r!.

An interesting property of the formula of [\cite=MeOe:loop] is that of having an alternative expression: see Proposition 15 of that paper. The latter consists of two terms. The first one relates connected multigraphs on n vertices and cyclomatic number k with all their connected subgraphs on n vertices and cyclomatic number k - 1. The second term relates connected multigraphs on n vertices and cyclomatic number k with all the pairs of their connected subgraphs with total number of vertices equal to n and total cyclomatic number equal to k. This alternative formula then induces a recurrence for I(n,k).

This note proves closed or at least simpler forms for the sequences of I(n,k) in constant n or k when these are small. In constant k, these are

For all n  ≥  1, [formula] and [formula].

The first formula is the sum of the inverses of the orders of the groups of automorphisms of all the trees (up to isomorphism) on n vertices, which was pointed out by Pólya [\cite=Polya].

In constant n, the answer is much more complete. We find several forms of the generating function

[formula]

including the two-variable generating function

[formula]

Define J(n,k): = 2k(n + k - 1)!I(n,k) to normalize the sequences I(n,k). We find that the sequences of J in constant n possess concise rational generating functions whose coefficients are simple formulas. With the sum running over all compositions of n, i.e. sequences of positive integers that sum to n, the general form is:

[formula]

There are 2n - 1 compositions of n, but the number of distinct sums of squares of parts among these compositions is much smaller, meaning that the number of factors in each generating function is much smaller than might have been expected from the above theorem. Hence a more efficient method of producing a generating function and explicit formula for a given n might be desired. There is a fairly simple routine for calculating explicit formulas and generating functions, which we give in the last section. Values for n = 1 through 4 are given in the table in the theorem below:

For k  ≥  0, the formulas and generating functions for J(n,k), 1  ≤  n  ≤  4, are as given in the following table.

In the next section of this note, we prove Theorem 1. When k = 0, we use Dziobek's recurrence [\cite=dziobek] for Cayley's formula to show that J(n,0) = nn - 3. When k = 1, we use an identity related to Abel's theorem to prove that [formula], which is Sloane's sequence A001865 in [\cite=OES]. In Section [\ref=sec:enumerator] we prove Theorem 2 by solving the differential recursive equation. We also give a general expression for J(n,k). In Section [\ref=sec:hands] we consider Rn from another angle, and re-prove some of the expansions with a more hands-on approach that displays different underlying combinatorics.

Formulas in constant k

We use the formula of Proposition 15 of [\cite=MeOe:loop] to give a recursive definition for our sequences, which in Theorem 1 are respectively A007830 and A001865 in [\cite=OES].

In the following, for all n  ≥  1 and k  ≥  0 by I(n,k) we denote the sum of the inverses of the orders of the groups of automorphisms of all the pairwise non-isomorphic connected multigraphs on n vertices and cyclomatic number k. By the formula of Proposition 15 of [\cite=MeOe:loop] the numbers I(n,k) are defined recursively as follows. With boundary condition

[formula]

then for all [formula] and [formula] we have

[formula]

For convenience of calculation, we define

[formula]

Then, for all [formula] and [formula] the recursion for J(n,k) is

[formula]

The same boundary conditions hold.

We now prove Theorem 1.

For all n  ≥  1:

[formula]

[formula]

To prove formula (a) note that the recurrence for J(n,0) reads as follows:

[formula]

For T(n): = nJ(n,0) we obtain Dziobek's recurrence [\cite=dziobek] for Cayley's formula:

[formula]

This is thus solved by T(n) = nn - 2 which is the sequence A000272 in [\cite=OES]. Therefore, we have J(n,0) = nn - 3.

To prove (b) we first recall the following Abel-type identity [\cite=Riordan]:

[formula]

For x = 0 and y = j the above formula specializes to

[formula]

We now proceed by induction on n. The result clearly holds for n = 1. We assume the result to hold for all t in 0  <  t  <  n. Then

[formula]

Now, formula ([\ref=AbelFormula]) yields for n = m + μ:

[formula]

Substituting this into the previous line we obtain

[formula]

as desired.

A natural question is whether the recurrence can be similarly simplified for k > 1. Attempts with Abel-type identities of greater generality did not yield results that we considered useful, but the quest does not seem theoretically implausible; the authors would be interested in any observations that readers might be able to provide.

Formulas in constant n

Generating functions

Define the generating function for the sequence of I(n,k) with n constant:

[formula]

In particular,

[formula]

because J(1,k) = 1 for all k.

We now wish to prove

[formula]

If we multiply each I(n,k) by xk and sum, the recursive equation ([\ref=eq:Izero]) for I(n,k) becomes a differential recursive equation for Rn:

[formula]

with boundary conditions Rn(0) = I(n,0) = nn - 2 / n!, Rn(x)  =  0 for n < 1.

To simplify, apply the change of variable

[formula]

The inverse relation

[formula]

gives the boundary condition Pn(1) = δn,1.

The differential recursive equation satisfied by Pn(z) is

[formula]

Observe that P1(z)  =  1, and if Pi(z) is polynomial for all 1  ≤  i  <  n, then Pn(z) satisfying this recurrence is polynomial as well. The first polynomials are

[formula]

The equation for the generating function

[formula]

is

[formula]

with the boundary condition

[formula]

The non-linear term is eliminated by the change of variable f =  log g. The equation for g is therefore linear:

[formula]

with the boundary condition g(y,1) = ef(y,1) = ey. A family of solutions of this equation is given by

[formula]

Moreover, the boundary condition g(y,1) = ey implies gn = 1 for all n:

[formula]

Finally,

[formula]

Note that if we set z  =  (1 + t), we obtain

[formula]

which is the well-known exponential generating function for [formula], where the sum is over all connected graphs G on the set [formula] and e(G) is the number of edges of G. (See [\cite=Gessel] for this formula and related results.) Thus, Pn(z)  =  Cn(z - 1).

Substituting ex for z, we obtain a generating function for Rn:

[formula]

The generating function for Rn(x) becomes

[formula]

However, this expression is highly singular in x and does not provide a generating function for Rn. The alternative expression

[formula]

is not singular and generates Rn, in the sense that Rn(x) is x- n times the coefficient of sn in the expansion of xh(x,s).

The extraction described yields

[formula]

where all [formula].

Explicit forms for J(n,k)

We now wish to show Theorem 3 by isolating explicit generating functions for J(n,k) individually. We can proceed as follows:

[formula]

Now replace x  →  2x, s  →  s / 2 to obtain

[formula]

We define [formula] to get

[formula]

where we used [formula]. Therefore,

[formula]

is a generating function for J(n,k) and this equation defines [formula]. We calculate

[formula]

where we have put λ = e- x. This gives

[formula]

Thus,

[formula]

The polynomials Zn(t) can be calculated by summing over the compositions of n, proving Theorem 3:

[formula]

[formula]

The number of distinct sums of squares of the parts of partitions or compositions of n is the OEIS sequence A069999; it grows like n2 / 2 [\cite=savit-00]. (We remark that the first case where a sum appears twice is n = 6.) The first [formula] are:

[formula]

Formulas in constant n: the hands-on approach

In this section we are interested in re-deriving the Zn(t) more directly, and finding the closed formulas to prove Theorem 4. Using strictly discrete mathematics instead of the generating function, we seek additional insight into the combinatorial structure of the sequences J(n,k).

The case J(1,k) = 1 for k > 0 is trivial from the recursion.

For n = 2, the recursion ([\ref=eq:Jzero]) becomes

[formula]

We now note that 4(4k - 1 - 2k - 2)  +  2k - 1  =  4k  -  2k  +  2k - 1  =  4k  -  2k - 1 and since the statement holds for k = 0, the claim on the values follows inductively.

That the value 4k  -  2k - 1 is the coefficient of xk in [formula] can be seen from expansion: the coefficient is

[formula]

For n = 3, the recursion ([\ref=eq:Jzero]) gives

[formula]

Let us pause to note the process here. We added a term to the sum, namely the i = 0 term, which is the j =  - 1 case of 4j  -  2j - 1. However, this term is 0. We then complete the binomial sum, changing the 4 to a 5, and the 2 to a 3.

Iterating the recursion with the form thus obtained, we obtain the closed formula for J(3,k):

[formula]

To show that the generating function claim is true, we factor the last term of equation ([\ref=JThreeK]):

[formula]

The same recurrence and initial condition is satisfied by the coefficient of xk in [formula], as we can see by noting that this coefficient is the complete homogeneous symmetric polynomial in 3, 5, and 9:

[formula]

where [formula] denotes the coefficient of xk in f(x).

The n = 4 case is proved similarly. Begin by expanding the defining recursion for J(n,k) using the formulas for J(1,k) through J(3,k). Gather symmetric expansions with the same binomial coefficients.

[formula]

Now complete the sums so that the bounds are [formula]. The crucial observations at this point are again that 4i - 2i - 1 = 0 for i =  - 1, and likewise [formula] for i∈{ - 1, - 2}, and so the terms to be added are all 0.

Using the binomial theorem to sum, we find

[formula]

At this point the desired generating function can be shown to have coefficients given by the same recursion. By iterating the recursion and summing the truncated geometric series, we obtain the formula given in Theorem 4.

[formula]

As expected, the values for the formula for J(4,k) are indeed zero at k∈{ - 1, - 2, - 3}, and so a similar neat expansion holds for J(5,k). The process of completing the binomial, summing with the binomial formula, and then iterating the recursion and summing the geometric series will provide explicit formulas easily as long as this property holds.

From the expansion of Zn(t) at the end of the previous section it is clear that the sequences J(n,  ·  ) will all be tidy exponential sums with at most Fibonacci-many terms, possibly fewer as overlaps occur. If these sums are in fact zero in just exactly the necessary domain outside of the original meaningful domain of the indices, we think that this itself would be an interesting observation on the behavior of the combinatorics of the problem.