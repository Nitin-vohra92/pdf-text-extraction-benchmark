Proposition Lemma

A higher-order singularity subtraction technique for the discretization of singular integral operators on curved surfaces

Supported by the Swedish Research Council under contract 621-2011-5516.

Introduction

A major challenge facing the community working on integral equation based solvers for boundary value problems is the construction of efficient discretizations of integral operators with singular kernels on curved surfaces. Classic approaches such as singularity subtraction, special purpose quadrature, singularity cancellation, kernel regularization, and various adaptive strategies may work well in many situations but have not yet fully, in three dimensions, succeeded in unleashing the computational power of integral equation methods needed for excellence in real-world physics applications [\cite=Klock12]. Recently, two new promising methods have been launched: the quadrature by extension (QBX) method which exploits that fields induced by integral operators are often smooth close to the boundaries where their sources are located [\cite=Klock12] and a method relying on a combination of adaptivity, local invertible affine mappings with certain orthogonality properties, and the use of precomputed tables of quadrature rules [\cite=Brem12]. It seems to be an open question what method, or combination of techniques, is best.

This note is about promoting a classic technique for the discretization of singular integral operators on curved surfaces, namely singularity subtraction. The idea is to use analytical evaluation to a maximum degree and split singular (and nearly singular) operators into two parts each - one ill-behaved part whose action can be evaluated using high-order analytic product integration, and another more regular part for which purely numerical integration is used, compare [\cite=Farin01]. Based on this idea we present and implement a simple Nyström scheme for Laplace's equation on tori. Surprisingly accurate results are produced.

Problem formulation and methods

We consider the interior Dirichlet Laplace problem

[formula]

where g(r) is a smooth function on the boundary Γ of a smooth domain V in [formula]. For the solution of ([\ref=eq:PDE1],[\ref=eq:PDE2]) we use the double-layer representation

[formula]

where nr is the exterior unit normal of Γ at position r, dσ is an element of surface area, and μ is an unknown layer density. An integral equation formulation for ([\ref=eq:PDE1],[\ref=eq:PDE2]) reads

[formula]

Parameterization

The domain V is taken to be a torus whose surface Γ is parameterized over the square [formula] as

[formula]

where

[formula]

and δ1 and δ2 are shape parameters. The choice δ1 = 0 corresponds to the standard tori used in [\cite=Brem12].

We shall use Nyström discretization for ([\ref=eq:inteq]) based on composite tensor product Gauss-Legendre quadrature. For this, we introduce a sequence of mappings ρij with [formula] and [formula]

[formula]

The mapping ρij(t) covers a patch Γij of Γ when mapped from the square [formula]. The disjoint union of the Γij is Γ. See Figure [\ref=fig:tori] for two examples.

Using ([\ref=eq:param2]) and introducing

[formula]

we can rewrite the integral operator in ([\ref=eq:inteq]) as the sum

[formula]

Singularity subtraction

Nyström discretization works well for a particular Dij in ([\ref=eq:Dsum]) if r is far away from the patch Γij. If r is close to, or on, Γij then the kernel is nearly singular, or singular, and something better is needed. Let

[formula]

where t(r) = ρ- 1ij(r). For t' close to t(r) the operator Dij can be expanded

[formula]

[formula]

See [\cite=Johns89] for a discussion of a similar expansion.

Our proposed singularity subtraction technique for t' close to t(r) makes use of the split

[formula]

Here

[formula]

with K a small integer and with Dij as in ([\ref=eq:Dsum]). The action of DKij is to be evaluated using high-order analytic product integration and [formula] is supposed to be sufficiently smooth as to allow for accurate Nyström discretization.

Recursive evaluation of integrals

Computing Dijkμ(r) in ([\ref=eq:Dijk]) requires the evaluation of an expression of the form

[formula]

where a, b, and c are constants known from ([\ref=eq:vij]) and αmn are coefficients of a polynomial approximating the smooth function Jij(r,t')Δkij(r,t')μ(r'). The variable substitution x = at'1, x0 = at1, y = bt'2, y0 = bt2 makes the terms in ([\ref=eq:form1]) appear as

[formula]

We now present a scheme for the evaluation of integrals of the form ([\ref=eq:form2]). Let

[formula]

and define in the Hadamard finite part sense the indefinite integrals

[formula]

Using partial integration, and for given values (x,x0,y,y0,c), one can show that when m + n + 1  ≠  2k holds

[formula]

When m + n + 1 = 2k holds

[formula]

where βk = 1 / ((1 - c2)(2k - 1)). For the evaluation of Fmk we use

[formula]

Expression for Gnk are obtained by interchanging [formula] and [formula] in the expressions for Fmk. The recursions for Cmnk, Fmk and Gnk allow the integrals in ([\ref=eq:form1]) to be evaluated at a modest computational cost. Note that, for this, only Cmnk with m,n  ≥  0 and k  ≥  1 are needed.

Details on the discretization

We now give precise details on our Nyström discretization of ([\ref=eq:inteq]). Aiming at 10th order convergence we take 10-point composite tensor product Gauss-Legendre quadrature (GL10) as our underlying quadrature scheme. On each Γij there will then be a grid of 100 discretization points where the discretized density [formula] is sought. The discretized system ([\ref=eq:inteq]) has 100p1p2 unknowns. We shall also use a temporary, finer, grid with 256 discretization points on each Γij placed according to 16-point composite tensor product Gauss-Legendre quadrature (GL16).

If, for a particular Dij and r in ([\ref=eq:Dsum]), the local parameter t = ρ- 1ij(r) is such that 3.5 < |t|, then the point r is considered far away from Γij and we discretize Dijμ(r) using the underlying GL10 scheme.

If 2 < |t|  ≤  3.5, then r is somewhat close to Γij and we use an extended scheme: first [formula] is interpolated to the finer grid on Γij and then Dijμ(r) is discretized using GL16. High-degree polynomial interpolation of smooth functions known at Legendre nodes can be very accurate, despite involving ill-conditioned Vandermonde systems [\cite=Hels08].

If |t| < 2, then r is close to Γij, the operator Dij is nearly singular or weakly singular, and we use the split ([\ref=eq:split]). The discretization is carried out on the GL16 grid on Γij, which means that [formula] has to be interpolated to 256 points as in the previous paragraph. The operator [formula] is discretized using GL16. The operator DKij is discretized using the method of Section [\ref=sec:recur]. We let [formula] in ([\ref=eq:form1]). The 256 coefficients αmn are obtained by multiplying the pointwise values of [formula] at the 256 fine grid points on Γij with pointwise values of Jij(r,t')Δkij(r,t') and then, in principle, solving a Vandermonde system of size 256  ×  256. In practice one can obtain the αmn by solving two 16  ×  16 systems with multiple right hand sides. As for the optimal number K in ([\ref=eq:split]), it turns out to be related to the polynomial degree of the underlying discretization and to the overall mesh refinement determined by p1 and p2 of ([\ref=eq:param2]). For small vales p1 and p2 and high degree quadrature, K should be rather low. We choose K = 1, that is, we use two terms in the sum of ([\ref=eq:split2]).

Numerical examples

Numerical experiments are performed on tori given by ([\ref=eq:param]) using a program solely implemented in Matlab and executed on a workstation equipped with an IntelXeon E5430 CPU at 2.66 GHz and 32 GB of memory. Three different δ = (δ1,δ2) are chosen: δ = (0,1), δ = (0.5,1), and δ = (0,0.25). See Figure [\ref=fig:tori] for illustrations. The boundary condition g(r) in ([\ref=eq:PDE2]) is taken as g(r) = 1 / |r - r1| - 1 / |r - r2|, with r1 = (4,0,0) and r2 = (0,4,0) for δ = (0,1), with r1 = (4.5,0,0) and r2 = (0,3.5,0) for δ = (0.5,1), and with r1 = (3.25,0,0) and r2 = (0,3.25,0) for δ = (0,0.25). The discretized system ([\ref=eq:inteq]) is solved iteratively using GMRES.

Figure [\ref=fig:conv] shows convergence of U(r), evaluated via a discretization of ([\ref=eq:rep]), at points along the center of the torus tubes. The mesh is refined by increasing the parameters p1 and p2 of ([\ref=eq:param2]), keeping p2 = p1 for δ = (0,1), p2 = 2p1 for δ = (0.5,1), and p2 = 4p1 for δ = (0,0.25). A relative residual less than εmach is obtained in between 15 and 20 iterations for reasonably resolved systems. The recursion of Section [\ref=sec:recur] is rather fast. For example, with 10,000 discretization points and δ = (0,0.25) only 28 seconds are spent doing singularity subtraction.

One can see in Figure [\ref=fig:conv] that the initial convergence of U(r) is approximately 10th order, as expected. As the number of discretization points grows, however, the error stemming from the discretization of [formula] dominates and the convergence slows down. Our scheme can, on its own, not compete with the mix of techniques presented by Bremer and Gimbutas [\cite=Brem12].

Conclusion

This note is about promoting singularity subtraction as a helpful tool in the discretization of singular integral operators on curved surfaces. Singular and nearly singular kernels are expanded in series whose terms are integrated on parametrically rectangular regions using high-order product integration, thereby reducing the need for spatial adaptivity and precomputed weights. A simple scheme is presented and an application to the interior Dirichlet Laplace problem on some tori gives around ten digit accurate results using only two expansion terms and a modest programming- and computational effort. Further development, including modifications as to allow for parametrically triangular regions, is needed before the technique may find its way into competitive solvers.