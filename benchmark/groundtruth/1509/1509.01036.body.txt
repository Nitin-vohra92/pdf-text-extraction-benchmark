Definition Corollary Proposition Lemma

On the square-freeness of the offset equation to a rational planar curve

Keywords: Offset curves; planar rational curves; squarefree factorization; implicit equations.

Introduction

Offset curves have been largely studied in the field of Computer Aided Geometric Design (see [\cite=Farouki] for an overview on offset curves). These curves allow to give thickness to a thin object, and have been successfuly used in contexts like manufacturing, graphic design or robotics [\cite=Farouki]. Furthermore, different theoretical aspects related to offset curves have been considered in the literature: algebraic properties [\cite=Far2], [\cite=Rafa1], topology [\cite=AS07], [\cite=A08], parametrization [\cite=AS97], singularities [\cite=paper], [\cite=Kim], [\cite=Maekawa], [\cite=Seong] or genus computation [\cite=AS99], [\cite=Fukushima], to give a non-exhaustive list of topics or papers. Many of these papers focus on planar curves described by means of rational parametrizations, since this type of parametrizations is popular and widely used in CAGD.

In the seminal paper [\cite=Far2], a method to find an implicit equation for the offset of a planar rational curve is given. This method, which we briefly summarize in Section [\ref=sec-prelim] of this paper, requires to compute the resultant of two polynomials that are built from the parametrization. Afterwards, in certain cases we need to remove an extraneous factor, whose components can be computed a priori. The resulting equation F(x,y) has at most two irreducible components [\cite=Rafa1], which can be of either simple or special nature, in the terminology of [\cite=Rafa1]. Hence, F(x,y) can be written as F(x,y) = (f1(x,y))r  ·  (f2(x,y))s, where f1(x,y) and f2(x,y) are irreducible polynomials, and f2(x,y) is assumed to be constant in the case when the offset has just one component. However, no observation is made in the literature on the values of r,s, i.e. on the multiplicity structure of F(x,y). The goal of this paper is to fill this gap, thereby completing the description of the algebraic structure of the resultant giving rise to the offset of a rational curve.

In this paper we will see that the multiplicities r,s can be computed in advance, and are related to two notions. The first one, which has already been mentioned in the preceding paragraph, is the simple or special nature of the corresponding offset component. The second one is the tracing index [\cite=SWPD] of the parametrization. Essentially, the tracing index describes how many times a rational parametrization traces a given curve, or, in other words, how many times the parametrization traces a regular point of the curve. If the tracing index is 1, then the parametrization is said to be proper; this means that the degree of the parametrization is minimum. In this paper we prove that if the parametrization is proper then r = s = 1 whenever there is no special component, and r = 1, s = 2 whenever there is a special component; in particular, if we have properness and there is no special component, then F(x,y) is square-free. When the parametrization has tracing index n > 1, we get r = s = n if there is no special component, and r = n, s = 2n if there is a special component. As a consequence, F(x,y) is square-free iff the parametrization of the curve is proper, and the offset has no special component (see Corollary [\ref=corfinal]).

The motivation for this paper came up while the authors were developing the results of [\cite=paper], where the problem of computing the self intersections of an offset curve was studied. Indeed, at a certain point in [\cite=paper] (see Remark 2 in [\cite=paper]) it was necessary to study whether or not the polynomial F(x,y) was square-free. Furthermore, as we show in this paper (see Theorem [\ref=charact]), the square-free character of F(x,y) also characterizes the situation when the offset has no special component, which is a necessary hypothesis, for instance, in [\cite=paper] and [\cite=Fukushima]. In turn [\cite=Rafa1], this allows to recognize whether or not a given rational curve is the offset to another curve.

The paper consists of two sections. In Section [\ref=sec-prelim] we provide some preliminary definitions and results. In Section [\ref=sec-main] we prove the theorems on the multiplicity structure of F(x,y), and we illustrate them with some examples.

Preliminaries and generalities

Let C be a real, rational plane curve, not a line or a circle, parametrized by

[formula]

where pi(t),qi(t), i = 1,2, are polynomials with rational coefficients and gcd (p1,q1) =  gcd (p2,q2) = 1. It is well-known that the resultant provides the implicit equation of the curve. From Theorem 4.41 in [\cite=SWPD],

[formula]

where c is a nonzero constant, f(x,y) is the implicit equation of C, and n is the tracing index of the parametrization φ(t), i.e. the number of times the parametrization φ(t) covers a regular point (x,y)∈C. The interested reader can check § 1.6 [\cite=SWPD] for further reading on the notion of tracing index. Additionally, we say that φ(t) is proper iff it is birational, i.e. iff φ(t) is injective except perhaps for finitely many values of the parameter t (corresponding to the self-intersections of the curve). One can prove (Theorem 4.30 in [\cite=SWPD]) that φ(t) is proper iff the tracing index is 1. Since properness can always be achieved by reparametrizing the curve, if necessary [\cite=SWPD], it is not uncommon to assume that one works with proper parametrizations. However, we do not need to make any a priori assumption on the properness of φ(t).

By reducing the components of φ(t) to common denominator, we can write

[formula]

where gcd (X(t),Y(t),W(t)) = 1. Calling

[formula]

we define the offset to C at distance [formula], Od(C), as the Zariski closure of the set of points (x,y) = φd(t), where

[formula]

with U2(t) + V2(t)  ≠  0, W(t)  ≠  0. Hence, (x,y) = φd(t) implies that the Euclidean distance between (x,y)∈Od(C) and the point p = φ(t)∈C, measured along the normal line to C through p = φ(t), is d; in this situation, we say that p = φ(t) generates (x,y). By an abuse of the language, we will also say that (x,y)∈Od(C) is generated by t. Furthermore, when the first sign of ±   and ∓   in the expression [\eqref=offset] is considered, the geometrical locus described is called the exterior offset; if the second sign is chosen, the geometrical locus described this way is called the interior offset. The union of the exterior and interior offsets is the whole offset, Od(C).

In general, we will say that P∈C generates Pd∈Od(C) if Pd = P  ±  d  ·  N(P), where N(P) is the unitary normal vector to C at P. If t  →    ∞φ(t) is an affine point, which happens iff  deg(X(t))  ≤   deg(W(t)) and  deg(Y(t))  ≤   deg(W(t)), then t  →    ∞φd(t) gives rise to two points, which we denote by P±    ∞ = (x±    ∞,y±    ∞). The points P±    ∞ also belong to Od(C).

The computation of the implicit equation of Od(C) is addressed in [\cite=Far2]. In order to compute this equation, the following polynomials are introduced:

[formula]

Roughly speaking, the implicit equation of Od(C) is found by eliminating the variable t in the system formed by [\eqref=P] and [\eqref=Q]. However, in order to avoid as many extraneous components as possible, we first divide P̃(x,y,t), (x,y,t) by their contents with respect to t. The polynomials obtained from P̃ and [formula] after removing their t-contents are denoted by P(x,y,t) and Q(x,y,t), respectively.

Now writing

[formula]

we have (see Theorem 3.6 of [\cite=Far2]) that

[formula]

where F(x,y) is an implicit equation of Od(C), and G(x,y) is a product of extraneous linear factors. The extraneous linear factors can be computed a priori by using Lemma 3.4 of [\cite=Far2]. It is worth observing that although [\cite=Far2] assumes that φ(t) is proper, by following the discussion in [\cite=Far2] one can check that the results in Theorem 3.6 and Lemma 3.4 of [\cite=Far2] are also valid even if φ(t) is not proper.

Notice that we said that F(x,y) is "an" implicit equation, and not "the" implicit equation. The reason is that h(x,y) = 0 is the implicit equation of a curve iff h(x,y) is the polynomial of minimum degree implicitly defining the curve. Hence, F(x,y) is "the" implicit equation of Od(C) iff it is square-free. We will prove, in Section [\ref=sec-main], that this is certainly the case whenever two conditions, that we will make precise, hold; if some of these conditions fails then F(x,y) is not square-free, although we will see that the multiplicity of its components can be computed in advance.

The first of these conditions is related to the properness of φ(t), that we recalled at the beginning of the section. The second condition has to do with the notions of simple and special components of an offset curve. These notions were introduced in [\cite=Rafa1], where a more algebraic definition of the offset curve, using an incidence diagram, is given. Based on this incidence diagram, it is proven that Od(C) has at most two components. Furthermore, an irreducible component of Od(C) is said to be simple if almost every point of that component is generated by just one point of C; otherwise, the component is called special. In [\cite=Rafa1] it is proven that for almost all d, Od(C) has simple components, and that Od(C) can have at most one special component. Furthermore, it is also demonstrated that if Od(C) is irreducible then it is simple, and that special components only appear when computing offsets to offsets (in which case the special component is the original curve).

Additionally, at certain moments in the paper we will distinguish two different types of singular points, local singularities and self-intersections. In the first case there is just one branch of the curve going through the point, while in the second case there are at least two different branches of the curve through the point (see Section 2.3 of [\cite=paper] for more information). Notice that the number of local singularities of an algebraic curve is always finite. Furthermore, if an algebraic curve is defined by a square-free polynomial then it also has finitely many self-intersections.

We finish with two results related to the preceding notions, that we will use later. The first one is related to the notions of simple and special components of Od(C).

There are finitely many points of Od(C) generated by more than two points of C. Furthermore, a component Vd of Od(C) is special iff almost all points of Vd are generated by exactly two points of C.

Let [formula] be the square-free part of F(x,y), and let Pd∈Od(C) be a regular point of the curve [formula], which also defines the offset. The points P∈C generating Pd are the intersection points of each line LPd, normal to Od(C) through Pd, the circle Cd centered at Pd of radius d, and C. Since by hypothesis Pd is regular there is just one normal line LPd. Since the intersection of LPd and Cd consists of at most two points, and since the curve [formula] has finitely many singularities, the first part holds. The second part follows from the notion of special component.

Finally, we recall the next lemma, which is proven in Appendix I of [\cite=ACD15]; although in [\cite=ACD15] one works with properly parametrized curves, one can check that the proof of the lemma does not depend on the properness of the curve, and therefore it is also valid in the case of non-proper curves.

The only points of the offset where the leading coefficients of P(x,y,t), Q(x,y,t) with respect to t simultaneously vanish are P±    ∞, in the case when P±    ∞ are affine points.

Factorization of resultants

Let Mp, Mq be two algebraic curves without common components, and let p(x,y), q(x,y) be the polynomials implicitly defining Mp and Mq. Since Mp, Mq do not have common components, Mp, Mq intersect at finitely many points. Furthermore, each intersection point has an intersection multiplicity. The notion of intersection multiplicity is described, for instance, in § IV.5.1 [\cite=walker], or in § 1.6 [\cite=Fulton]. In the general case, computing the intersection multiplicity requires certain technicalities; however, when the intersection point is regular for both Mp and Mq and the tangent line at such a point is different for Mp and Mq, the intersection multiplicity is 1. Now let

[formula]

where c is constant, and the αi are the (possibly complex) roots of y(p,q). Then (see Proposition 5 [\cite=Buse], and § 1.6 [\cite=Fulton]) we have the following result.

Suppose that x = αi is not a common vertical asymptote of Mp and Mq. For all [formula], the integer βi equals the sum of all the intersection multiplicities of the points [formula] such that xj  =  αi. In particular, if the line x = αi does not contain any point of [formula] which is singular for either Mp or Mq, and no point of [formula] where the tangent lines to Mp and Mq coincide, then βi is equal to the number of (possibly complex) different points of [formula] lying on the line x = αi.

Square-freeness of F(x,y).

In this section we will give a complete description of the factorization of F(x,y) (see Eq. ([\ref=structure])). As a consequence, we will provide necessary and sufficient conditions for F(x,y) to be square-free. We will need first the following result.

Let C be a curve parametrized by φ(t), not necessarily proper. Let Pt(x,y,t) denote the partial derivative of P(x,y,t) with respect to the variable t. Then there are just finitely many points (x,y)∈Od(C) such that there exists [formula] satisfying

[formula]

Let φd(t) = (xd(t),yd(t)) be the points of the offset generated by the parameter t (see Eq. [\eqref=offset]). Hence, we have that

[formula]

i.e. the functions P(xd(t),yd(t),t),Q(xd(t),yd(t),t) are identically zero. Now assume that the statement is false. Then the function Pt(xd(t),yd(t),t) is also identically zero. Therefore, by arguing as in Lemma 8 of [\cite=paper], we deduce that Od(C) has infinitely many local singularities, which cannot be.

Now we will separately consider the case when the parametrization φ(t) is proper, and the case when its tracing index is bigger than 1.

Case of proper parametrizations.

In this subsection we will assume that the parametrization φ(t) is proper. Recalling the notation in Eq. [\eqref=structure] and since Od(C) has at most two components, we can write

[formula]

where f1(x,y), f2(x,y) are irreducible, therefore square-free, and f1(x,y) is non-constant. If Od(C) has just one component, then f2(x,y): = 1. Furthermore, if Od(C) is reducible and Od(C) has some special component (recall that there is at most one component of this type), we will assume that f2(x,y) implicitly represents this special component.

The polynomial f1(x,y) explicitly depends on x and y. If f2(x,y) is not constant, then it also explicitly depends on x and y.

We prove the result for f1(x,y); similarly for f2(x,y), in the case when it is not constant. Suppose that f1(x,y) depends on just one variable, x or y. Then Od(C) contains one line. Since C  ⊂  Od(Od(C)) and the offset of a line is a pair of two parallel lines, C contains at least one line. On the other hand, since C is rational by hypothesis, it is irreducible. Hence, if C contains a line then C must be a line. However, this is impossible because by hypothesis C is not a line.

Now let us consider the set A of the y0s satisfying some of the following conditions:

The intersection of the line y = y0 with Od(C) contains some point also belonging to the curve G(x,y) = 0.

The leading coefficients of P(x,y,t) and Q(x,y,t) with respect to t identically vanish when y = y0.

The line y = y0 contains a local singularity of Od(C).

The line y = y0 is tangent to Od(C).

There exist x0,t0 such that Eq. [\eqref=pqt] holds for (x0,y0,t0).

The line y = y0 contains either a point of a simple component of Od(C) generated by more than one value of t, or a point of a special component of Od(C) generated by more than two values of t.

Notice that in particular, the intersection points between two components of Od(C) satisfy condition (6). Furthermore, from Lemma [\ref=l-aux] we have that condition (2) implies y0  =  y±    ∞. Then we have the following result.

A is a finite set.

It is clear that there are finitely many y0s satisfying (1), (2), (3), (4) and (5). So let us see that there are also finitely many y0s satisfying (6). If Od(C) does not have any special component, since by assumption C is properly parametrized there are finitely many points of Od(C) generated by more than one value of the parameter t. If Od(C) has a special component V, by Lemma [\ref=nocircle] a generic point of V is generated by two points of C; since C is by assumption properly parametrized, this means that a generic point of V is generated by exactly two values of t.

Therefore, a generic y0 does not satisfy any condition (1)-(6). This is crucial in the next theorem, which is our first important result.

Suppose that C is properly parametrized.

If Od(C) does not have any special component, then

[formula]

If Od(C) has a special component, then

[formula]

(1) Let [formula]. We want to prove that r1 = r2 = 1. By Lemma [\ref=line] f1(x,y) and f2(x,y), when it is not constant, explicitly depend on x and y. Therefore it suffices to show that for a generic y0, f1(x,y0) and f2(x,y0) are square-free. Let y = y0 be generic, so that y0 does not satisfy any condition (1)-(6). In particular, the leading coefficients of P(x,y,t) and Q(x,y,t) do not identically vanish for y = y0, so t(P(x,y,t),Q(x,y,t)) specializes properly, i.e.

[formula]

(see Lemma 4.3.1 in [\cite=winkler]). Since y0 does not satisfy condition (1), the line y = y0 does not intersect H(x,y) = 0 in any point both belonging to Od(C) and to the curve G(x,y) = 0. Moreover y0 does not satisfy conditions (3), (4), (6) either, and therefore we have that

[formula]

where the intersections between f1(x,y) = 0 and y = y0 correspond to the xis, the intersections between f2(x,y) = 0 and y = y0 correspond to the js, and G(xi,y0)  ≠  0, G(j,y0)  ≠  0 for [formula], [formula]. Now assume that [formula], where [formula] is nonconstant. We fix [formula]; whenever f2(x,y) is nonconstant, one can argue in the same way for [formula]. From Proposition [\ref=prop-aux] we have the following possibilities:

For any [formula] there are distinct t0,t1 with P(xi,y0,t0) = Q(xi,y0,t0) = 0 and P(xi,y0,t1) = Q(xi,y0,t1) = 0. But this implies that (xi,y0)∈Od(C) is simultaneously generated by t0 and t1, which cannot happen because y0 does not satisfy condition (6).

There is some [formula] such that P(xi,y0,t) and Q(xi,y0,t) share a root t0 of multiplicity at least 2. However, in that case Pt vanishes at the point (xi,y0,t0). And this cannot happen because y0 does not satisfy condition (5).

The line x = xi is a common vertical asymptote of the curves (defined on the xt-plane) P(x,y0,t) = 0, Q(x,y0,t) = 0. But this cannot happen because y0 does not satisfy condition (2), and hence y0  ≠  y±    ∞.

So we conclude that r1 = 1. Similarly for r2, whenever f2(x,y) is not constant.

Let us address now the statement (2) of the theorem. First, one argues in the same way to reach Eq. [\eqref=H]. Also, one can prove that r1 = 1 as in statement (1). In order to prove that r2 = 2, since y = y0 does not satisfy condition (6), from Lemma [\ref=nocircle] one has that every point of the special component of Od(C), lying on the line y = y0, is generated by exactly two values of the parameter t. Therefore, by Proposition [\ref=prop-aux] one has r2  ≥  2. Now assume that r2 > 2. Again from Proposition [\ref=prop-aux] we have the following possibilities:

For any [formula] there are at least three different values t0,t1,t2 with P(xi,y0,tk) = Q(xi,y0,tk) = 0 for k = 1,2,3. But this implies that (xi,y0)∈Od(C) is simultaneously generated by t0, t1, t2, which cannot happen because y0 does not satisfy condition (6).

There is some [formula] such that P(xi,y0,t) and Q(xi,y0,t) share a root t0 of multiplicity at least 2. However, in that case Pt vanishes at the point (xi,y0,t0). But this cannot happen because y0 does not satisfy condition (5).

The line x = xi is a common vertical asymptote of the curves (defined on the xt-plane) P(x,y0,t) = 0, Q(x,y0,t) = 0. But this cannot happen because y0 does not satisfy condition (2), and hence y0  ≠  y±    ∞.

So we conclude that r2 = 2.

From Theorem [\ref=libre] above and from Theorem 7 in [\cite=Rafa1], one gets the following result, which provides a condition for checking if a rational curve C is the offset to another curve (equivalently, if Od(C) has some special component).

Let C be a rational curve properly parametrized by φ(t). The following statements are equivalent.

F(x,y) is not square-free.

Od(C) has a special component.

C is the (whole) offset to some other algebraic curve; namely, the special component of Od(C).

If t(P(x,y,t),Q(x,y,t)) is square-free, then: (1) Od(C) does not have any special component; (2) C is not the offset of any algebraic curve.

Case of non-necessarily proper parametrizations.

The aim of this section is to generalize Theorem [\ref=libre] to the case of non-proper parametrizations, and to characterize from here the square-freeness of F(x,y); hence, in this subsection we will assume that C is parametrized by a non-necessarily proper rational parametrization φ(t), with tracing index n  ≥  1. We can write F(x,y) as in Eq. [\eqref=F]; furthermore if Od(C) has any special component we assume that it is represented by f2(x,y). We also need to introduce a set A of y0s satisfying six conditions. The conditions (1)-(5) coincide with those in Section [\ref=prop-case]; however, condition (6) is replaced by the following condition:

The line y = y0 contains either a point of a simple component of Od(C) generated by more than n values of t, or a point of a special component of Od(C) generated by more than 2n values of t.

One can prove that A is finite in an analogous way to Lemma [\ref=finite].

Now we have the following theorem, which is a generalization of Theorem [\ref=libre]. It can be proven in an analogous way to Theorem [\ref=libre]. In the proof, that we ommit here, one needs to observe that since the tracing index of φ(t) is n, a generic point of a simple component of Od(C) comes from just one point of C, i.e. it is generated by n values of the parameter t. Also, a generic point of the special component of Od(C), if any, comes from exactly two points of C, i.e. it is generated by 2n values of the parameter t. Note also that the lines y = y0 containing the self-intersections of Od(C) satisfy condition (6).

Suppose that C is parametrized by a rational parametrization of tracing index n.

If Od(C) does not have any special component, then

[formula]

If Od(C) has a special component, then

[formula]

One can notice the analogy between the formulae in Theorem [\ref=libre2], and Eq. [\eqref=res]. This was somehow expectable, since tracing the curve C n times implies tracing also n times each simple component of Od(C), and 2n times each special component of Od(C). Finally we conclude with the following result, which can be derived from Theorem [\ref=libre2].

The polynomial F(x,y) is square-free iff the curve C is properly parametrized, and Od(C) does not have any special component.

Examples.

In this subsection we provide some examples illustrating the results in the two preceding subsections.

Let C be the Cardioid, of implicit equation

[formula]

This curve is rational and can be properly parametrized by

[formula]

Let us find the offset of C for d = 1; for simplicity, we will denote this offset by Z, i.e. Z  =  O1(C). By computing the resultant H(x,y) in [\eqref=lares], we get that H(x,y) is, up to a constant, the product of F(x,y),

[formula]

and an "extraneous" factor G(x,y),

[formula]

In this case, one can check that the curve defined by F(x,y) is square-free and irreducible, so Z has just one, simple, component. Following the notation of Theorem [\ref=libre], we have F(x,y) = f1(x,y)  ·  f2(x,y) with f1(x,y) square-free, and f2(x,y) = 1. The Cardioid, together with its offset for d = 1, are shown in Figure [\ref=fig:offcard].

Now let us study the offset of Z for d = 1. According to Theorem 7 in [\cite=Rafa1], the offset of Z for d = 1 must have a special component, namely the Cardioid. One can check that Z is rational; a proper parametrization of Z is [formula], where

[formula]

After computing the resultant H(x,y) in Eq. [\eqref=lares] for the above parametrization [\eqref=lapara], we check that H(x,y) = F(x,y)  ·  G(x,y), where G(x,y) = (x2  +  y2 + 4  y + 4)2 and F(x,y) factorizes into two polynomials. As predicted by statement (2) of Theorem [\ref=libre], we have

[formula]

where f1(x,y) and f2(x,y), with

[formula]

Observe that, as expected, the curve defined by f2(x,y) is our initial curve, the Cardiod. Figure [\ref=fig:offoffcard] shows the curve Z (i.e. O1(C)) in red color, and O1(Z) in black color. Moreover, the special component is plotted in dash-dotted line.

Finally, let us reparametrize the curve Z by using the following non-linear change of parameter:

[formula]

By applying this change of parameter, we get a non-proper parametrization of Z, of tracing index n = 3. After computing the polynomial F(x,y) with this non-proper parametrization, we find, as predicted by statement (2) of Theorem [\ref=libre2], F(x,y) = f1(x,y)3  ·  f2(x,y)6.

It is well known that the offset of the parabola is a rational curve. In this example, we analyze the offset of the offset of the parabola [formula] for d = 6, but considering a non-proper parametrization of the offset to [formula]. More precisely, let C be the curve defined by [formula], and let P  =  O6(C). One can check that

[formula]

[formula]

is a parametrization of P, with tracing index equal to 2. In this case, when computing the resultant H(x,y) in Eq. [\eqref=lares] we get the extraneous factor (x2  +  y2 - 2  y + 1)4. Additionally, as predicted by Theorem [\ref=libre2], we have

[formula]

where

[formula]

Figure [\ref=fig:offoffpar] shows the curve P (the offset of [formula] for d = 6) in red and O6(P) in black. Moreover, the special component is plotted in dash-dotted line.

References