Proposition Lemma Corollary Conjecture

Definition Example

Primitive points in lattice polygons

Introduction

One of the fundamental problems in discrete geometry is to estimate the number of lattice points contained in a polygon. In this paper we concern ourselves with the set of primitive lattice points

[formula]

also known as lattice points visible from the origin. It is a classical result the number of primitive lattice points in a "reasonable" region in [formula] is approximately [formula] times the area of the region. We shall be interested in the family {tA} of dilates of a fixed polygon A, for which we define the error term

[formula]

The fact that [formula], or equivalently that EA(t)  =  o(t2), was likely used as far back as Minkowski (see [\cite=Rogers] or [\cite=HW]). Stronger upper bounds for EA(t) are known; we state the following result, which will be justified in the next section, as a benchmark for comparison.

If [formula] is a polygon, then for [formula], where the implicit constant may depend on A.

The purpose of this paper is to improve this upper bound for any rational polygons (a polygon all of whose vertices have both coordinates rational), and show that it cannot be improved too much more by providing a strong Ω± result for the error term.

It is instructive to consider the specific example A  =  Δ, where Δ is the isosceles right triangle with vertices (0,0), (1,0), and (1,1) and thus area [formula]. Then [formula] is the number of primitive points in the dilate [formula], that is,

[formula]

(where the extra 1 comes from the fact that gcd (0,1) = 1). It is well known that this summatory function of the Euler φ-function is asymptotic to [formula], so we define

[formula]

Proposition [\ref=prop:_t_log_t_upper_bound_corollary] implies the estimate EΔ(t)  ≪  t log t, which (when phrased in terms of the summatory function of the Euler phi function) is a classical result of Mertens [\cite=Mertens]. The best unconditional upper bound for this error term EΔ(t) is due to Walfisz [\cite=Walfisz]. Using methods related to exponential sums, he showed that

[formula]

As a consequence of our work, we can extend this bound from the isosceles right triangle Δ to all rational polygons.

Let [formula] be a rational polygon. Then

[formula]

where the implicit constant may depend on A.

Prior to Walfisz's result, Chowla and Pillai [\cite=CP] showed that these upper bounds cannot be improved too much by establishing the lower bound

[formula]

that is, EΔ(t)  =  Ω(t log  log  log t). Later, Erd os and Shapiro [\cite=ES] obtained a slightly weaker quantitative lower bound but showed that EΔ(t) oscillates in sign infinitely often. Both results were improved by Montgomery [\cite=Montgomery87]:

[formula]; in other words,

[formula]

We use the term origin-star-shaped (star-shaped with respect to the origin) to refer to any domain B for which λB  ⊂  B for all λ∈[0,1]; note that in particular, any origin-star-shaped domain contains the origin. The main result of this paper generalizes this lower bound of Montgomery to this class of polygons:

Let [formula] be a rational origin-star-shaped polygon. Then

[formula]

where the implicit constant may depend on A.

In the process of applying an adaptation of Montgomery's argument to the general error term EA(t) for the primitive point counting function for the lattice polygon A, we found ourselves needing to establish the following "error term independence" result concerning the error term EΔ for the summatory function of φ(n), which was defined in equation [\eqref=eq:_E_delta_def]; this result may be of independent interest.

For any positive rational numbers [formula] and [formula],

[formula]

where the implied constant may depend upon the cj and fj.

In other words, there can be no "magic cancellation" among the terms EΔ(fjx) that makes the oscillation of the sum significantly smaller than that of an individual term. Furthermore we conjecture that oscillations of the same size exist even when the ci are allowed to be negative (where we require the fi to be distinct to avoid trivial cancellations).

Theorem [\ref=thm:_error_term_independence] holds for any rational numbers ci and any distinct positive rational numbers fi.

This would imply a stronger version of Theorem [\ref=thm:_polygon_lower_bound] that holds for any rational polygon A, not necessarily star-shaped or containing the origin:

Let [formula] be a rational polygon. Then

[formula]

where the implicit constant may depend on A.

The rest of the paper is divided into two sections. In the next section, we show (Theorem [\ref=thm:_error_term_decomposition]) that the error term EA(t) may be rewritten as a linear combination of dilates of the totient error function EΔ(t), thereby establishing Theorem [\ref=thm:_polygon_upper_bound] and reducing Theorem [\ref=thm:_polygon_lower_bound] to Theorem [\ref=thm:_error_term_independence]. We then establish this latter theorem in the final section.

Decomposing the error term

We begin by giving a proof of Proposition [\ref=prop:_t_log_t_upper_bound_corollary], not only for the sake of completeness, but also because the structure of the argument foreshadows how we will approach the main result of this section, namely Theorem [\ref=thm:_error_term_decomposition] below. We use the term pointed triangle to mean a triangle which has the origin as a vertex.

We begin by quoting a reasonably precise estimate [\cite=KrPo] for the number of primitive points inside a domain B: if B is convex and contains the origin, then

[formula]

where ω is the diameter of B. In particular, if C is a convex polygon containing the origin and B = tC is a dilate, then the diameter of B is a constant multiple of t and so [formula] (with the implicit constant depending on C).

However, any polygon A can be partitioned into sums and differences of finitely many pointed triangles, simply by triangulating A and noting that any triangle can be written as the signed sum of three pointed triangles. Let {Cj}nj = 1 denote these triangles, and εj∈{ - 1,1} the sign of Cj, that is whether it is added or substracted, so that [formula]. Even though these triangles have sides in common, the number of double-counted lattice points on the t-dilation of each side is at most O(t), and therefore the above bound (valid since pointed triangles are certainly convex polygons containing the origin) implies

[formula]

for [formula], as desired.

In [\cite=KrPo], the bound [\eqref=must_contain_0] is stated without the hypothesis that B contain the origin; however, this hypothesis is actually necessary. One can easily construct, using the Chinese remainder theorem, a square B of diameter ω containing no primitive lattice points whatsoever. The area of such a square is a constant times ω2, and therefore [formula], which is incompatible with the claimed bound ω log ω.

The error in the proof of [\cite=KrPo] comes when applying Lemma 2.3, which requires [formula], to a term of the form [formula]; when k > ω, the diameter of Δ / k is less than 1, and so Lemma 2.3 cannot be applied. However, if Δ is a set containing the origin, then these sets Δ / k are sets with diameter less than 1 that contain the origin, hence contain no primitive lattice points (indeed, no lattice points at all other than the origin). Therefore the sums over k in the proof of [\cite=KrPo] can be truncated at k  ≤  ω, and the rest of the argument goes through thereafter.

The remainder of this section is dedicated to proving Theorem [\ref=thm:_error_term_decomposition], which asserts that the error term EA(t) for any rational polygon A may be rewritten in terms of the totient error function EΔ(t). We begin with a detailed investigation of this latter function.

Throughout this section, we employ the notation ⌊x⌋ for the greatest integer not exceeding x and {x}  =  x - ⌊x⌋ for the fractional part of x. We also employ the sawtooth function defined as

[formula]

for all real numbers x; this function is equal to the first periodic Bernoulli polynomial 1(x) except at integer arguments.

First we establish, for the sake of completeness, some elementary, well-known, and useful estimates for sums involving the Möbius μ-function, which satisfies the key identity

[formula]

For any real numbers 2  ≤  x  ≤  y:

[formula];

[formula];

[formula].

We begin by noting that

[formula]

since [formula]. Thus part (a) follows from the classical evaluation

[formula]

Next, since [formula], we have

[formula]

by the identity [\eqref=eq:_key_M\"{o}bius_identity], establishing part (b). Lastly, note that

[formula]

by part (b). The right hand side is bounded in absolute value by 1 + x  ≪  x, establishing part (c).

We are now ready to give a more precise formula for the totient error term EΔ(t).

For any real numbers [formula],

Starting from equation [\eqref=eq:_totient_sum_introduced] and the key identity [\eqref=eq:_key_M\"{o}bius_identity], we have

[formula]

by Lemma [\ref=lem:_M\"{o}bius_lemma](b). In the remaining sum, we expand [formula] to obtain

[formula]

by Lemma [\ref=lem:_M\"{o}bius_lemma](a) and a trivial bound. Therefore

[formula]

by Lemma [\ref=lem:_M\"{o}bius_lemma](c).

Counting lattice points in the simplest way (each with weight 1) is problematic in our present context. First, we will be decomposing polygons into unions of triangles that share sides, and so double-counting lattice points on these shared boundaries would become an issue; second, any error term as large as the perimeter for counting lattice points in a triangle would result in an unacceptably large error term in the inclusion-exclusion method we use to detect primitive lattice points. Consquently, we employ a more convenient weighting in our lattice-point counting, namely the solid angle sum of a polygon.

For a point [formula], let B(p;r) = {q: d(p - q) < r} denote the ball of radius r around p. Let λ denote Lebesgue measure on [formula], and define for any polygon A

[formula]

It is easy to work out that

[formula]

where θp is the angle at the vertex p.

Using this function, we define the solid angle sum of the t-dilate of the rational polygon A to be

[formula]

We also define the corresponding sum over primitive lattice points only:

[formula]

The utility of using the solid angle weighting is that both of these functions are additive, in the sense that [formula] and [formula] for any polygons A and B with disjoint interiors.

Let A be a rational polygon. There exist a real number C, a positive integer k, and rational numbers [formula] where fi > 0 (all depending on A) such that

[formula]

where the implicit constant may depend upon A. Furthermore, when A is a origin-star-shaped Polygon the cj may be taken to all be positive.

Le Quang and Robins [\cite=LR] gave a precise formula for the solid angle sum of any rational pointed triangle T:

[formula]

where C(T), k(T), cj(T), fj(T) are constants depending on T with k(T) a positive integer, and the cj(T) and fj(T) positive rational numbers. But the rational polygon A can be partitioned as a signed sum of a finite number of rational pointed triangles (as in the proof of Proposition [\ref=prop:_t_log_t_upper_bound_corollary]). Simply summing the formula [\eqref=LQR] over these finitely many triangles yields the desired formula [\eqref=eq:_solid_angle_sum_formula], where C is the sum of the C(T), and {fj} is the union of the {fj(T)}, and so on.

The following theorem results from a careful examination of [formula], which can be related to AA(t) using the Möbius function as in the proof of Proposition [\ref=prop:_formula_for_error_term].

Let A be a rational polygon. There exist a positive integer k and rational numbers [formula] where fi > 0 such that

[formula]

where the implicit constant may depend upon A. Furthermore, if A is a origin-star-shaped polygon, then the rj may all be taken to be positive.

Theorem [\ref=thm:_polygon_upper_bound] follows immediately from Theorem [\ref=thm:_error_term_decomposition] in light of the known upper bound [\eqref=eqn:_Walfisz]. In addition, Theorem [\ref=thm:_polygon_lower_bound] follows immediately from the combination of Theorem [\ref=thm:_error_term_decomposition] and Theorem [\ref=thm:_error_term_independence]; the latter theorem is proved in the next section.

We commence by excluding the (non-primitive) origin and using the Möbius identity ([\ref=eq:_key_M\"{o}bius_identity]) to write

[formula]

Interchanging the order of summation (valid since in reality there are only finitely many nonzero terms) and rescaling (which preserves solid angles),

[formula]

by the definition of AA, We may truncate the outer sum at any real number [formula] is allowed because for larger values of d, the diameter of [formula] is less than 1, and hence [formula] (which contains the origin) cannot contain any other lattice points. Proposition [\ref=prop:_solid_angle_sum_formula] now implies

[formula]

Using Proposition [\ref=prop:_formula_for_error_term], we may rewrite the above in terms of EΔ(t) and obtain

[formula]

for any [formula].

The number of integer points on the boundary of tA is O(t) since tA has finitely many sides, each of which has length O(t). Consequently, and therefore equation [\eqref=eqn:_formula_for_P_A(t)] implies

[formula]

Upon setting [formula] and rj = cj / fj for each 1  ≤  j  ≤  k, the theorem follows.

Linear combinations of EΔ

In this section we prove Theorem [\ref=thm:_error_term_independence], showing that positive rational linear combinations of scaled copies of the totient error function EΔ have oscillations as large as those known for EΔ itself. We begin by recalling some of the components of Montgomery's argument [\cite=Montgomery87] establishing the oscillations of EΔ, after which we describe the strategy that led to our modifications.

Define

[formula]

Montgomery [\cite=Montgomery87] showed that the totient error function is closely connected to the above weighted error:

[formula].

Define

[formula]

where the sawtooth function B(x) was defined in Definition [\ref=def:_fractional_notation], and

[formula]

If b is relatively prime to q, then

Since every divisor of qb can be written uniquely as a divisor of b times a divisor of q, which is equivalent to the statement of the lemma.

The above quantities appear [\cite=Montgomery87] in a key part of Montgomery's argument, which displays a bias in the values of R0 sampled on an arithmetic progression:

There exists a positive real number c such that if 0 < α < q is a non-integral real number, then

[formula]

uniformly for [formula].

The proof of Lemma [\ref=Montgomery_constant_lemma] is based on the following ancient identity due to Raabe [\cite=Raabe] for a sum of B(x) over an arithmetic progression of points: for all real numbers x, valid for all real x; the relevance to the problem at hand is due to the fact [\cite=Montgomery87] that

[formula]

To exploit Lemma [\ref=Montgomery_constant_lemma], Montgomery chose α = q / 4, so that for all divisors d of q the quantity B(α / d) equals [formula], with the sign depending only upon the residue class of d modulo 4. On the other hand, he chose q to be the product of many primes congruent to 3 modulo 4; for any divisor d of this q, the residue class of [formula] depends only on the number of prime factors of d. With these choices, the sign of B(α / d) correlates exactly with the sign of μ(d), making the quantity K(q,α) large in absolute value. Choosing α = 3q / 4 instead again makes K(q,α) large but with the opposite sign.

One of our key observations is that we may work modulo a suitably chosen prime P rather than working modulo 4. Instead of choosing q to be the product of many primes congruent to [formula], we instead choose q to be the product of many primes that are quadratic nonresidues modulo P. The sign of B(α / d) will not be perfectly correlated with μ(d), but there will be enough of a systematic bias in the signs of B(α / d) (due to the imperfect distribution of quadratic residues and nonresidues modulo P) that we can still force K(q,α) to be large in absolute value. If we choose the prime P carefully, we can even force all of the different K(qbi,αbi) to be large in absolute value and have the same sign.

We introduce the following function, whose oscillations we will want to establish. For the rest of this section, we use boldface variables such as [formula] to indicate the dependence of various quantities on k-tuples [formula] of variables.

Given real numbers [formula] and [formula], define

[formula]

The starting point of our modification of Montgomery's method is the following easy consequence of Lemma [\ref=Montgomery_constant_lemma].

Let [formula] and [formula] be real numbers. There exists a positive real number c such that: if 0 < α < q is a real number such that none of the αbj is an integer, then

[formula]

uniformly for [formula].

We now state our oscillation result for [formula], after which we show how Theorem [\ref=thm:_error_term_independence] is implied by it. Thereafter our only remaining goal will be to establish this proposition:

Let [formula] and [formula] be fixed positive integers. There exists a constant [formula], and sequences [formula] and 0 < α+N,α-N < QN, defined for positive integers N, for which QN, tends to infinity with N and

[formula]

and

[formula]

By Lemma [\ref=R0_to_EDelta],

[formula]

Let [formula] be the least common denominator of the rational numbers [formula], and set [formula] and [formula]. Replacing x by [formula], we obtain

[formula]

Let [formula]. If there existed an x0 such that [formula] for all x > x0, then we would have

[formula]

by the bounds 0 < α+N < QN,; for large N (and hence for large QN,) this would contradict Proposition [\ref=prop:_Totient_key_proposition]. Therefore no such x0 can exist, in which case equation [\eqref=converting_E_to_G] implies that there are arbitrarily large values of x for which In other words,

[formula]

and the analogous argument using the values G(nQN  +  α-N) gives

[formula]

completing the derivation of Theorem [\ref=thm:_error_term_independence] from Proposition [\ref=prop:_Totient_key_proposition].

Before addressing Proposition [\ref=prop:_Totient_key_proposition] directly, we record some preliminary facts about the distribution of primes in residue classes and the associated L-values.

Let [formula] be a prime exceeding 3, and let [formula] denote the quadratic character modulo P. Then the class number h( - P) of the field [formula] equals

[formula]

These results are classical; see for example [\cite=Davenport].

Let [formula] be a prime exceeding 3. If χ0 denotes the principal character(mod [formula]) P, then

[formula]

where

[formula]

On the other hand, for any nonprincipal character [formula],

[formula]

Again let [formula] denote the quadratic character(mod [formula]) P. For any character [formula] we can write

[formula]

The last product is absolutely convergent uniformly in P; indeed,

[formula]

and so the last product equals [formula] and in particular is uniformly bounded. When χ is nonprincipal, we know [\cite=MV] that

[formula]

since [formula] [\cite=MV]. (Better error terms are available but are not relevant for us.) In particular, when neither χ nor χχ1 is principal, the first two products on the right-hand side of equation [\eqref=three_products] are [formula] and [formula], respectively; in particular, both are ≪  P1. This estimate establishes the lemma when χ is neither principal nor equal to χ1.

When χ  =  χ1, the first and third factors are still bounded, while now the second factor actually diverges to 0, hence in particular is still bounded. Finally, when χ  =  χ0 is principal, the second factor converges to [formula] by Lemma [\ref=class_number_lemma], while the first factor on the left-hand side of equation [\eqref=three_products] is

[formula]

by Mertens's formula [\cite=MV]. This asymptotic evaluation of the right-hand side of equation [\eqref=three_products] establishes the lemma when χ is principal, indeed with the stronger error term [formula].

We can now define the modulus QN, appearing in the statement of Proposition [\ref=prop:_Totient_key_proposition], in terms of a companion prime [formula].

Let [formula] be the smallest prime satisfying [formula]. Note that [formula], and so - 1 is a quadratic nonresidue(mod [formula]) while 2 is a quadratic residue(mod [formula]). Furthermore, if p is any odd prime dividing one of the bj, then by quadratic reciprocity [\cite=NZM] we have, since [formula] and [formula],

[formula]

Consequently, each prime dividing every bj is a quadratic residue(mod [formula]).

Now define, for any integer [formula],

[formula]

where c is the constant from Lemma [\ref=lem:_montgomery's_lemma_for_G_in_progressions]. The prime number theorem for arithmetic progressions to a fixed modulus (see [\cite=MV]) tells us that [formula]; in particular, QN, tends to infinity with N, and [formula] when N is large enough.

Note also that QN, is squarefree and relatively prime to [formula] and to each bj, since every prime p|bj satisfies [formula]. Finally, note that any divisor d of QN, has the convenient (and, for us, crucial) property that [formula], since both quantities equal ( - 1)#  {p|d}.

For any 1  ≤  b  ≤  P - 1, we have

[formula]

where cP was defined in equation [\eqref=cP_def].

From the orthogonality of the characters modulo [formula],

[formula]

by Lemma [\ref=half_product_lemma]. The statement of the lemma follows upon noting that [formula].

For any integer m that is not a multiple of [formula] and for any integer [formula],

[formula]

The exact value of the leading constant is not as important for us as the fact that its dependence on m is only in the term [formula], so that the sign of the leading constant depends on whether m is a quadratic residue or nonresidue modulo [formula].

By Definition [\ref=Montgomery_quantities_def] and the coincidence between the Legendre symbol and the Möbius function on divisors of QN, (as noted at the end of Definition [\ref=P_and_Q_definition]), we have

[formula]

The last congruence is equivalent to d being in the reduced residue class [formula], and so Lemma [\ref=lem:in_arithm_prog] applies:

[formula]

By the definition of the Bernoulli polynomial B, this sum equals

[formula]

by Lemma [\ref=class_number_lemma], which completes the proof of the lemma.

We now have all the tools we need to establish Proposition [\ref=prop:_Totient_key_proposition] and hence our main theorems.

Given a sufficiently large integer N, define two numbers [formula], where the integers [formula] satisfy [formula]; note that none of the numbers α±Nbj is an integer, since neither QN, nor any of the bj is a multiple of the prime [formula]. Since we confirmed in Definition [\ref=P_and_Q_definition] that [formula], we may invoke Lemma [\ref=lem:_montgomery's_lemma_for_G_in_progressions]:

[formula]

As noted in Definition [\ref=P_and_Q_definition], each bj is relatively prime to QN,. Thus by Lemma [\ref=K_scale_lemma] with our choice of α±N,

[formula]

By Lemma [\ref=K_evaluation_lemma],

[formula]

As noted in Definition [\ref=P_and_Q_definition], every prime dividing bj is a quadratic residue modulo [formula], which implies that [formula] always. Moreover, [formula], so the product of Legendre symbols [formula] equals 1; on the other hand, since - 1 is a quadratic nonresidue modulo [formula], the product of Legendre symbols [formula] equals - 1. Consequently,

[formula]

The last sum equals [formula], which when multiplied by the preceding product becomes [formula]. In addition, by the same argument as in the proof of Lemma [\ref=half_product_lemma],

[formula]

We therefore see that we have established the proposition with

[formula]

by the definition [\eqref=cP_def] of cP.

The condition that all of the aj are positive is used here only to ensure that this last line is non-zero. In the case where the aj may be arbitrary, and thus where the innermost sum in equation [\eqref=innermost_sum] may equal 0, it is possible that modifying [formula] and the above argument could prove the totient independence for any coefficients; however, we succeeded in getting this to work only when k  ≤  3.

Acknowledgement

The first author was partially supported by ERC Advanced Research Grant no 267165 (DISCONV) and by Hungarian National Science Grant K 111827. The fourth author was partially supported by ICERM, the Institute for Computational and Experimental Research in Mathematics, Brown University, and would like to thank the warm hospitality of the first author and the Alfréd Rényi Institute of Mathematics, Hungarian Academy of Sciences.