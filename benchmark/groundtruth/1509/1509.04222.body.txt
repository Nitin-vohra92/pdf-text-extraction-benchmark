The conjugacy problem for automorphism groups of homogeneous digraphs

Lemma Proposition Corollary Question Definition

Introduction

This article is a contribution to the study of the automorphism groups of countable homogeneous digraphs. We use the term digraph in the model-theoretic sense to mean an oriented simple graph. A countable digraph is said to be homogeneous if every finite partial automorphism extends to a total automorphism. A survey of the study of countable homogeneous structures can be found in [\cite=macpherson]; the countable homogeneous digraphs are classified in [\cite=cherlin].

Our main result will be stated in terms of the Borel complexity theory of equivalence relations. We recall that if E,F are equivalence relations on standard Borel spaces X,Y then we say that E is Borel reducible to F if there is a Borel function f:X  →  Y such that [formula]. An equivalence relation E is said to be smooth if it is Borel reducible to the equality relation on [formula]. An equivalence relation E is said to be Borel complete if it is Borel reducible to an isomorphism relation on a class of countable structures, and conversely any isomorphism relation on a class of countable structures is Borel reducible to E. (Here the countable structures are coded by a sequence of relations on [formula].) We will use the standard fact that the isomorphism relations on the classes linear orders and partial orders are Borel complete [\cite=FS]. For a resource on Borel complexity theory we refer the reader to [\cite=gao].

In [\cite=summer] and [\cite=conjugacy1], we sought to compute the Borel complexity of the conjugacy relation on automorphism groups of numerous countable homogeneous structures. For countable homogeneous digraphs, we were able to decide this complexity in all but three cases, which turned out to be more difficult than the rest. For every digraph that we did analyze, the complexity turned out to be either smooth or Borel complete. In this article we show that in the three remaining cases the conjugacy problems are all Borel complete as well. This completes the proof of the dichotomy:

If G is a countable homogeneous digraph then the conjugacy problem for [formula] is either smooth or Borel complete.

As we have said, to complete the proof it remains to consider just the three remaining digraphs. These are the generic partial order P (Section 2), the generic shuffled partial order P(3) (Section 3), and the semigeneric complete multipartite digraph [formula] (Section 4). These three proofs showcase many of the tools used in [\cite=conjugacy1] together with some additional tricks.

The conclusion of the proof of Theorem [\ref=thm:main] suggests one should next ask about the classification of automorphisms of other countable homogeneous structures. In Section 5, we introduce the class of homogeneous structures with the (n-ary) Borel amalgamation property, and show how to generalize our methods to apply to such structures.

Acknowledgement. We would like to thank Gregory Cherlin for helpful discussions regarding this material.

The generic partial order

Let P denote the generic countable homogeneous partial order. We refer the reader to [\cite=schmerl] for the classification of all homogeneous partial orders. In this section we show that the conjugacy problem for [formula] is Borel complete. We begin with the following lemma giving a strong form of the amalgamation property for the class of partial orders.

Let P be a partial order and for each i let [formula] be a partial order extending P. Then the transitive closure P' of [formula] is again a partial order. Also, P' adds no new relations to P.

First note that the transitive closure is obtained in just one step by adding a relation ai  ≤  aj whenever there is p∈P such that ai  ≤  p  ≤  aj. To verify transitivity holds after performing this step, suppose that ai  ≤  aj  ≤  ak. Then there exist p,q∈P such that ai  ≤  p  ≤  aj  ≤  q  ≤  ak. Since [formula] is a partial order, we must have that p  ≤  q. Therefore ai  ≤  p  ≤  ak and it follows that ai  ≤  ak.

Now suppose towards a contradiction that antisymmetry fails in P'. Since we have added no new relations within P or between elements of P and elements of {ai} there must be distinct i,j such that ai  ≤  aj  ≤  ai. Then there are p,q∈P such that ai  ≤  p  ≤  aj  ≤  q  ≤  ai. It follows that p  ≤  q  ≤  p, so by antisymmetry in P, we have p = q. But now ai  ≤  p  ≤  ai, which contradicts antisymmetry in [formula].

The class of countable partial orders is Borel reducible to the conjugacy relation on [formula]. Hence the conjugacy relation on [formula] is Borel complete.

Given a countable partial order P, we build a copy QP of P and an automorphism φP of QP in such a way that [formula] if and only if φP is conjugate to φP'. This will be done in stages QnP, φnP. To begin, let Q0P consist of [formula] many incomparable copies of P together with [formula] many copies of [formula]. Denote these latter copies [formula] for each [formula]. Let φ0P act on Q0P by sending the ith copy of P to the (i + 1)st copy of P, and sending m(i) to (m + 1)(i).

Assume that QnP and φnP have been constructed, and construct Qn + 1P and φn + 1P as follows. Begin by considering each set of constraints of the form ā < x <  and [formula] which are consistent with the axioms of a partial order and the diagram of QnP. (For example, we assume that ā  <  , [formula], and so forth.) Additionally assume

the constraints contain relations the form m(i) < x < (m + 1)(i).

For each such set of constraints, we add a new realization x to Qn + 1P. We do not add any relations involving x except those implied by the constraints and transitivity. Then, we close Qn + 1P under transitivity. By Lemma [\ref=lem:po-amalg], we have added no new edges to QnP.

We also extend φnP to an automorphism φn + 1P of QnP in the obvious way: If x is the point corresponding to the parameters ā,,, then we let φn + 1P(x) be the point corresponding to the parameters φnP(ā),φnP(),φnP().

We claim that any element of QP is related to just finitely many copies of [formula] in Q0P. Clearly this claim holds for elements of Q0P itself. Next assume that the claim holds for elements of QnP and consider constraints of the form ā < x <  and [formula] with parameters from QnP. By hypothesis the elements ā,, are related to just finitely many copies of [formula] in Q0P among them all. Adding an element x satisfying this constraint (as done above) and closing under transitivity does not result in x being related to any additional copies of [formula]. This completes the proof of the claim.

Now to see that QP satisfies the one-point extension property, let ā < x <  and [formula] be an arbitrary set of constraints consistent with the axioms of a partial order. Let QnP be the least level containing all of the parameters ā,,. By the claim, these parameters are related to just finitely many copies of [formula] in Q0P among them all. By the argument of the claim, it is possible to add a realization x to QnP which is related just to these finitely many copies of [formula] in Q0P. Let [formula] be the first copy of [formula] in Q0P not related to x. We now consider the constraints ā < y <  and [formula] and 0(i) < y < 1(i). This extended set of constraints is consistent and of the form [formula]. Hence in the construction we have placed a realization y of the extended constraints into Qn + 1P. This completes the verification that QP satisfies the one-point extension property.

Towards a conclusion, observe that for every x in a copy of P in Q0P we have that the φP-orbit of x is an antichain. On the other hand for every other element x we have that the φP-orbit of x is a chain. This is because we have some constraint of the form 0(i) < x < 1(i). This implies 1(i)  =  φ(0(i)) < φ(x), and the two together imply that x < φ(x).

Thus we can recover the copies of P in Q0P as the set of points whose φP-orbit is an antichain, and then further recover P. Hence if [formula] and αφP  =  φP'α it follows that α restricts to an isomorphism [formula] that sends φP-orbits to φP'-orbits. Therefore by passing to the quotient graphs of Q0P,Q0P' by the φP and φP'-orbit equivalence relations, we see that α induces an isomorphism [formula].

To conclude, we remark briefly on how the construction can be exhibited in a Borel fashion. We fix the underlying sets of P,QP,P to be [formula]. The construction of QP can be made Borel by reserving an infinite subset [formula] for each QnP, and using a previously fixed enumeration of the finite subsets S  ⊂  Ik. This immediately implies that the construction of φP is Borel also. Finally we can regard φP as an automorphism of P using a back-and-forth construction between QP and P, where each choice in the construction is resolved by choosing the least available witness.

The generic shuffled partial order

The generic shuffled partial order, denoted P(3), is a graph obtained by "shuffling" three disjoint dense subsets of P in the following fashion.

Let [formula] be a partition of P into three dense subsets. Define the shuffled graph P(3) on the underlying set of P as follows. First, if x,y∈Pi, then set [formula]. Next for each [formula], if x∈Pi and y∈Pi + 1 then set

[formula]

See Chapter 5 of [\cite=cherlin] for the proof that P(3) is homogeneous. We remark that the construction of P(3) is similar to that of the digraph S(3), which is obtained by shuffling three disjoint dense subsets of [formula]. See Section 2.2 of [\cite=conjugacy1] for our treatment of S(3).

The argument of the previous section can be modified to show that the conjugacy problem for [formula] is again Borel complete. In the proof we will let P3 denote the generic three-colored partial order. (Finite three-colored partial orders form an amalgamation class.) The structure P3 can be viewed simply as a copy of P partitioned into three distinguished dense subsets P0,P1,P2.

The isomorphism relation on countable partial orders is Borel reducible to the conjugacy relation on [formula]. Hence the conjugacy relation on [formula] is Borel complete.

Given a partial order P we modify the proof of Theorem [\ref=thm:partial] to build a copy QP of P3 as follows. The first level Q0P is constructed as before, with all vertices of Q0P of color 0. When constructing Qn + 1P we again add elements x satisfying each admissible constraint; in this way elements x of all three colors will be added. Continuing the construction as before, we obtain a structure QP which is a copy of P3, and an automorphism φP of QP. It is again the case that x∈Q0P if and only if the φP-orbit of x is an antichain.

The structure QP gives rise to a corresponding copy QP(3) of P(3) obtained by shuffling the colors according to the rules in Definition [\ref=defn:p3]. Since φP preserves the colors of QP, it is easy to see that φP is an automorphism of QP(3) too.

For the forward implication of the Borel reduction, beginning with an isomorphism [formula] it gives rise to an automorphism of the first level Q0P (which we recall was monochromatic in color 0). This then extends naturally to a color-preserving automorphism of all QP, and hence to an automorphism of QP(3). The resulting extension [formula] conjugates φP to φP'.

For the converse implication, we note that since all the φP-orbits are monochromatic, they retain their structure even after the shuffle. That is, antichain orbits remain antichain orbits, and non-antichain orbits remain non-antichain orbits. Thus given φP we can recover a copy of Q0P as the set of antichain orbits and conclude as in the proof of Theorem [\ref=thm:partial].

The semigeneric complete multipartite digraph

We say a digraph is complete multipartite if its [formula] relation is an equivalence relation. The class of finite such graphs forms an amalgamation class, and we write [formula] for the countable generic complete multipartite graph. In this section we consider the following "semigeneric" variant of [formula]. Let C be the class of finite complete multipartite graphs which additionally satisfy the following parity property: for every two maximal antichains A and B and every distinct a,a'∈A and distinct b,b'∈B there is an even number of edges pointing from the set {a,a'} to the set {b,b'}. This is once again an amalgamation class, as shown in [\cite=cherlin-imprimitive]. We let [formula] denote the countable generic graph corresponding to the class C.

In [\cite=conjugacy1] we showed that the conjugacy problem for [formula] is Borel complete. In this section we show that the conjugacy problem for [formula] is again Borel complete. We remark that the argument for completeness of [formula] cannot be used directly for [formula], since the widget used in the proof did not have the parity property (see Figure 2 of [\cite=conjugacy1]). The following lemma will help us understand the structure [formula] and its automorphisms.

Let G be a complete multipartite digraph with the parity property, and suppose A,B are two maximal antichains. There exists subsets RAB  ⊂  A and SAB  ⊂  B such that for x∈A and y∈B, we have x  →  y if and only if we have that [formula]. Refer to Figure [\ref=fig:semigen] for a diagram of these relationships.

Let A,B be two maximal antichains and, if it is possible, fix x0∈A and y0∈B such that x0  →  y0. We then let [formula] and let [formula]. We claim these sets have the desired properties. Indeed, applying the parity property to the pairs {x0,x} and {y0,y} one can conclude that x  →  y in the cases when x∈RAB and y∈SAB or else x∉RAB and y∉SAB. Similarly one can conclude that x←y in the cases when x∈RAB and y∉SAB or else x∉RAB and y∈SAB, as desired.

If it is not possible to pick x0,y0 above, then instead pick x0∈A and y0∈B with x0←y0 and proceed similarly to find RBA and SBA. Then simply let RAB: = SBA and SAB: = RcBA.

The isomorphism relation for countable linear orders is Borel reducible to the conjugacy problem for [formula]. Hence the conjugacy problem for [formula] is Borel complete.

Given a countable linear order L we will recursively construct a copy GL of [formula] together with an automorphism φL of GL such that [formula] if and only if φL is conjugate to φL'. To begin we let G0L = L itself, and φ0L  =   the identity on G0L. We remark that G0L is multipartite with parts of size 1, and therefore it has the parity property. In the construction we will also require a linear ordering <  nL on GnL, and we initially set <  0L equal to the given ordering of L.

For the remainder of the proof we fix an enumeration τk(x,) of the types of the theory of digraphs.

Assuming GnL, φnL, <  nL have been constructed, we construct Gn + 1L, φn + 1L, <  n + 1L as follows. We consider in turn each pair [formula] and S∈(GnL)<    ∞ such that the parameterized type τk(x,S) does not contradict the parity property. For each such pair, we put three new points ak(S),bk(S),ck(S) into Gn + 1L satisfying τk(x,S).

If τk(x,S) forces x to be in a maximal antichain A of GnL, then we will place these new points into A. Otherwise we will create three new antichains with one point each. Formally, if τk(x,S) contains a formula of the form [formula], we set [formula]. For future reference, let us say say that the type τk(x,S) and the points ak(S),bk(S),ck(S) added in this manner are of Class 1. On the other hand, if τk(x,S) does not contain a formula of the form [formula], then we set ak(S)  →  bk(S)  →  ck(S)  →  ak(S). We say that the type τk(x,S) and the points ak(S),bk(S),ck(S) added in this manner are of Class 2.

Before we describe the rest of the edges of Gn + 1L, let us use Lemma [\ref=lem:semigeneric-structure] to define the sets RAB and SAB for every pair of maximal antichains A,B of GnL. Note that there is an ambiguity in the lemma, since RAB and SAB may be swapped with their complements. To make the definition uniform throughout our construction, note that each maximal antichain has an element eA which was added earliest. We always choose RAB so that it contains this element eA.

Now given any element a of Class 1, a was added to some maximal antichain A. For each other maximal antichain B, we additionally specify that a lies in RAB unless its type τK(S) explicitly forces us to put a into RcAB. This specification determines the remaining edges between elements of Class 1 and elements of GnL, and also between any two elements of Class 1.

Next given an element a of Class 2, a lies in its own maximal antichain A = {a}. For each other element b of GnL or of Class 1 we set a  →  b unless the type of a explicitly forces us to set a←b.

It remains only to define the edges between two elements of Class 2. For this we will need to define the linear ordering <  n + 1. First let [formula] be the lexicographic ordering of (GnL)<    ∞ inherited from <  n. We then make the definitions:

If d∈GnL and [formula], set d < n + 1d'

If k < k', set ak(S),bk(S),ck(S) < n + 1ak'(S),bk'(S)ck'(S)

If [formula] and [formula], set ak(S),bk(S),ck(S) < n + 1ak(S'),bk(S'),ck(S')

If [formula] and S∈(GnL)<    ∞, set ak(S) < n + 1bk(S) < n + 1ck(S)

Now if τk(S) and τk'(S') are two types of Class 2, we set ak(S),bk(S),ck(S)  →  ak'(S'),bk'(S'),ck'(S') precisely when ak(S) < n + 1ak'(S').

Finally we extend the automorphism φnL of GnL to an automorphism of Gn + 1L. Given a type τk(x,S) of the form considered above, we let S' = φn(S). Then we let φn + 1L map ak(S)  ↦  bk(S'), bk(S)  ↦  ck(S'), and ck(S)  ↦  ak(S'). This completes the construction.

Letting [formula] we have that GL is complete multipartite, satisfies the parity property, and has the one-point extension property with respect to this class. Thus GL is a copy of [formula]. Letting [formula] we have that φL is an automorphism of GL. As in our previous arguments, it is not hard to see that an isomorphism [formula] gives rise to a conjugacy between φL and φL'. Moreover we can recover L as the set of fixed points of φL, which guarantees that a conjugacy between φL and φL' gives rise to an isomorphism [formula].

We conclude this section with a note motivating the need for the involved proof of the previous theorem. The "bowtie" structure of Figure [\ref=fig:semigen] has an automorphism swapping RAB with RcAB and SAB with ScAB. One might expect that this symmetry can be used to build automorphisms of [formula]. However the following result shows that these partial automorphisms do not extend to [formula], necessitating the more complicated construction above.

If φ is an automorphism of [formula] which fixes each maximal antichain setwise then φ is the identity.

Suppose φ fixes each antichain setwise, and assume towards a contradiction that a,φ(a) are unequal and lie in the same maximal antichain A.

Case 1: φ2(a)  ≠  a. Then by genericity there exists a maximal antichain B such that a,φ(a)∈RAB and φ2(a)∈RcAB. Then a,φ(a)∈RAB implies that φ(RAB) = RAB. But on the other hand φ(a)∈RAB,φ2(a)∈RcAB implies that φ(RAB) = RcAB. This is a contradiction.

Case 2: φ2(a) = a and there exists another element a'∈A besides a,φ(a) such that φ(a')  ≠  a'. Then there exists a maximal antichain B such that a,φ(a),a' lie in RAB and φ(a') lies in RcAB. Then we reach a contradiction similarly to Case 1.

Case 3: φ2(a) = a and some other element a'∈A besides a,φ(a) is fixed by φ. Then there exists a maximal antichain B such that a lies in RAB and φ(a),a' lie in RcAB. We again reach a contradiction similarly to Case 1.

Toward a more general theorem

In this final section we discuss the possibility of generalizing the methods of [\cite=summer] [\cite=conjugacy1] and the present article to classes of homogeneous structures other than graphs. More specifically, observe that many of our results are established by finding a Borel reduction from the isomorphism relation on the class of countable substructures of some countable homogeneous structure M to the conjugacy relation on [formula]. It is natural to ask whether it is always possible to find such a reduction.

Recently, Bilge and Melleray showed that the answer is yes in the case when M has a property which is stronger than homogeneity. In order to describe this result, let us recall some notions from Fraïssé theory. Let K be a class of finite (relational) structures, and let Kω be the class of countable structures, all of whose finite substructures lie in K. We say that K has the amalgamation property (AP) if for any A,B1,B2∈K and embeddings gi:A  →  Bi, there exists C∈K and embeddings fi:Bi  →  C satisfying

[formula]

We recall that K has the amalgamation property if and only if there exists a (necessarily unique) homogeneous structure M∈Kω, called the Fraïssé limit of K, such that the class of finite substructures of M is exactly K.

Next we say that K has the strong amalgamation property (SAP) if in the definition of AP we additionally have [formula]. Finally we say that K has the free amalgamation property (FAP) if in the definition of SAP we can additionally assume there are no nontrivial relations between the sets [formula] and [formula].

Let K be a class of finite structures with the FAP, and let M be the Fraïssé limit. Then the isomorphism relation on Kω is Borel reducible to the conjugacy relation on [formula].

Many of the examples considered in [\cite=conjugacy1] have the FAP, though some did not. The three structures considered in this article do not. Thus it is natural to seek a property that is weaker than the FAP but still strong enough to establish the conclusion of Theorem [\ref=thm:bm]. In the rest of this section, we undertake the beginnings of such a quest.

In the proof of Theorem [\ref=thm:bm] the authors do not use the FAP directly, but rather an extension construction: given some countable A∈Kω, they build a structure E(A)∈Kω which witnesses all configurations which are in finitary in the following sense. (For later use we write the definition in slightly more general terms than in [\cite=bilge].)

Let C be a class of countable structures and A∈C. Given a finite subset A0  ⊂  A and a quantifier-free type τ(x,ā) over A0, we say that τ is an admissible finitary type over A (with respect to the class C) if there exists B∈C such that A is a substructure of B and B contains a witness for τ.

We remark that in order to build a structure E(A) which contains witnesses for all admissible finitary types over A, it is sufficient for the ambient class Kω to have the SAP. However we have not been able to use the SAP alone to establish the conclusion of Theorem [\ref=thm:bm]. To establish the desired Borel reduction, one must be able to construct E(A) in an explicit fashion. The following definition captures the precise definable and combinatorial hypotheses we need to carry out a proof.

Let C be a class of countable structures with the SAP. We say that C has the n-ary Borel amalgamation property ([formula]) if there is a Borel assignment E:C  →  C satisfying the following properties:

For all A∈C, E(A) consists of A together with n witnesses [formula] for each admissible finite type τ over A;

E(A) has an automorphism which fixes A and cycles the witnesses [formula];

For admissible finite types τ,τ', the map xτi  ↦  xτ'i is an isomorphism of finite structures; and

Given A,A'∈C and isomorphism α:A  →  A', the natural extension :E(A)  →  E(A') is in fact an isomorphism. (Here α naturally extends to the admissible finite types over A, and hence to E(A) by (xτi) = xα(τ)i.)

We observe that [formula]. Indeed, the first implication is a consequence of the results of [\cite=bilge], and the second implication holds by definition. Moreover the first implication is not reversible, since the class of countable partial orders satisfies [formula] but not FAP. (Here one can establish [formula] using Lemma [\ref=lem:po-amalg].) We conjecture that the second implication is not reversible as well. For example the class of countable tournaments satisfies the SAP but does not apparently satisfy any [formula], an issue we will return to later on.

We are finally ready to state our generalization of Theorem [\ref=thm:bm].

Let K be a class of finite structures such that Kω has the [formula] for some [formula], and let M be the Fraïssé limit. Then the isomorphism relation on Kω is Borel reducible to the conjugacy relation on [formula].

The details of the proof are quite similar to those of Theorem [\ref=thm:bm]. To illustrate these details, we show now how it works in the special case of partial orders.

Given a countable partial order P, we build a copy QP of P and an automorphism φP of QP in such a way that [formula] if and only if φP is conjugate to φP'. This will be done in stages QnP and φnP as before.

Let Q0P be a copy of P, and let φ0P be the identity on Q0P. Next suppose QnP and φnP have been constructed. Let Qn + 1P = E(QnP), where the function E is given by [formula]. In particular, we set [formula]. Let [formula] be the natural extension of φnP to all of Qn + 1P = E(QnP), and let ψ be the automorphism of Qn + 1P which fixes QnP and exchanges all witness pairs. We then let [formula].

Letting [formula] and [formula], it is easy to see that QP is a copy of P and φP is an automorphism of it. If [formula], then the requirements on the extension map E directly imply that φP is conjugate to φP'. Conversely, since P can be recovered as the set of fixed points of φP, we clearly have that if φP is conjugate to φP' then [formula].

Although Theorem [\ref=thm:bap] is strong enough to subsume some of the results from [\cite=conjugacy1] as well as the case of partial orders, we have also been able to establish its conclusion even in cases when [formula] is not present. For example, we have already remarked that the class of tournaments does not apparently satisfy [formula]. It is possible to use triplet witnesses {xτ1,xτ2,xτ3} as in [formula], and set xτ1  →  xτ2  →  xτ3  →  xτ1. However it is not clear how to define the edges between xτ,xτ' for τ  ≠  τ'. Instead, we restricted to the subclass of linear orders, and made all such choices according to an inherited linear order on the types.

We have a similar situation in this article with the semigeneric multipartite digraph. It is possible to use twin witnesses as xτ1,xτ2 as in [formula]; the two witnesses must belong to the same antichain and we may set [formula]. On the other hand, we could not assign the edges between xτ1,xτ'1 in a Borel fashion, and relied on the subclass of linear orders once again.

To conclude, we remark that while Definition [\ref=defn:bap] is somewhat specialized, some form of Borel amalgamation may be of broader interest. It is well-known that if K has the SAP, then Kω has the SAP too (and similarly for the FAP). This can be established by either iteratively applying the finitary amalgamation property, or using a compactness argument. In either proof, one does not arrive at an explicit and uniquely determined amalgam: it relies on the choice of the enumeration of the finite substructures, or on the weak form of the Axiom of Choice that is the compactness theorem. A Borel form of SAP such as [formula] remedies this use of AC by isolating classes where countable amalgamation can be done in an explicit way.