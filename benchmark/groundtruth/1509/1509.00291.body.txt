Pearson Codes

Kees A. Schouhamer Immink

and Simon R. Blackburn

Introduction

In non-volatile memories, such as floating gate memories, the data is represented by stored charge, which can leak away from the floating gate. This leakage may result in a shift of the offset or threshold voltage of the memory cell. The amount of leakage depends on the time elapsed between writing and reading the data. As a result, the offset between different groups of cells may be very different so that prior art automatic offset or gain control, which estimates the mismatch from the previously received data, can not be applied. Methods to solve these difficulties in Flash memories have been discussed in, for example, [\cite=Jia], [\cite=Sa3], [\cite=Zh1], [\cite=Sa5]. In optical disc media, such as the popular Compact Disc, DVD, and Blu-ray disc, the retrieved signal depends on the dimensions of the written features and upon the quality of the light path, which may be obscured by fingerprints or scratches on the substrate. Fingerprints and scratches will result in rapidly varying offset and gain variations of the retrieved signal. Automatic gain and offset control in combination with dc-balanced codes are applied albeit at the cost of redundancy [\cite=I59], and thus improvements to the art are welcome.

Immink & Weber [\cite=I67] showed that detectors that use the Pearson distance offer immunity to offset and gain mismatch. The Pearson distance can only be used for a set of codewords with special properties, called a Pearson set or Pearson code. Let S be a codebook of chosen q-ary codewords [formula] over the q-ary alphabet [formula], q  ≥  2, where n, the length of [formula], is a positive integer. Note that the alphabet symbols are to be treated as being just integers rather than elements of [formula]. A Pearson code with maximum possible size given the parameters q and n is said to be optimal.

In Section [\ref=detect], we set the stage with a description of Pearson distance detection and the properties of the constrained codes used in conjunction with it. Section [\ref=description] gives a description of T-constrained codes, a type of code described in the prior art [\cite=I67], used in conjunction with the Pearson distance detector, while Section [\ref=gencon] offers a general construction of optimal Pearson codes and a computation of their cardinalities. The rates of T-constrained codes will be compared with optimal rates of Pearson codes. In Section [\ref=conclusions], we will describe our conclusions.

Preliminaries

We use the shorthand notation a + b = [formula]. In [\cite=I67], the authors suppose a situation where the sent codeword, [formula], is received as the vector   =  a(  +  ) + b, [formula]. Here a and b are unknown real numbers with a positive, called the gain and the (dc-) offset respectively. Moreover, [formula] is an additive noise vector: [formula] = [formula], where [formula] are noise samples from a zero-mean Gaussian distribution. Note that both gain and offset do not vary from symbol to symbol, but are the same for all n symbols.

The receiver's ignorance of the channel's momentary gain and offset may lead to massive performance degradation as shown, for example, in [\cite=I67] when a traditional detector, such as threshold or maximum likelihood detector, is used. In the prior art, various methods have been proposed to overcome this difficulty. In a first method, data reference, or 'training', patterns are multiplexed with the user data in order to 'teach' the data detection circuitry the momentary values of the channel's characteristics such as impulse response, gain, and offset. In a channel with unknown gain and offset, we may use two reference symbol values, where in each codeword, a first symbol is set equal to the lowest signal level and a second symbol equal to the highest signal level. The positions and amplitudes of the two reference symbols are known to the receiver. The receiver can straightforwardly measure the amplitude of the retrieved reference symbols, and normalize the amplitudes of the remaining symbols of the retrieved codeword before applying detection. Clearly, the redundancy of the method is two symbols per codeword.

In a second prior art method, codes satisfying equal balance and energy constraints[\cite=I62], which are immune to gain and offset mismatch, have been advocated. The redundancy of these codes, denoted by r0, is given by [\cite=I62]

[formula]

In a recent contribution, Pearson distance detection is advocated since its redundancy is much less than that of balanced codes [\cite=I67]. The Pearson distance between the vectors [formula] and [formula] is defined as follows. For a vector x, define

[formula]

and

[formula]

Note that [formula] is closely related to, but not the same as, the standard deviation of [formula]. The (Pearson) correlation coefficient is defined by

[formula]

and the Pearson distance is given by

[formula]

The Pearson distance and Pearson correlation coefficient are well-known concepts in statistics and cluster analysis. Note that we have |ρ,|  ≤  1 by a corollary of the Cauchy-Schwarz Inequality[\cite=MGB74], which implies that 0  ≤  δ(,)  ≤  2.

A minimum Pearson distance detector outputs the codeword

[formula]

As the Pearson distance is translation and scale invariant, that is,

[formula]

we conclude that the Pearson distance between the vectors [formula] and [formula] is independent of the channel's gain or offset mismatch, so that, as a result, the error performance of the minimum Pearson distance detector is immune to gain and offset mismatch. This virtue implies, however, that the minimum Pearson distance detector cannot be used in conjunction with arbitrary codebooks, since

[formula]

if   =  c1 + c2, [formula] and c1 > 0. In other words, since a minimum Pearson detector cannot distinguish between the words [formula] and  = c1 + c2, the codewords must be taken from a codebook S  ⊆  Qn that guarantees unambiguous detection with the Pearson distance metric ([\ref=eqms6c]).

It is a well-known property of the Pearson correlation coefficient, ρ,, that

[formula]

if and only if

[formula]

where the coefficients c1 and c2 > 0 are real numbers [\cite=MGB74]. It is further immediate, see ([\ref=eqms6cc]), that the Pearson distance is undefined for codewords [formula] with [formula], i.e., for multiples of the all-one vector. We coined the name Pearson code for a set of codewords that can be uniquely decoded by a minimum Pearson distance detector. We conclude that codewords in a Pearson code must satisfy two conditions, namely

Property A: If ∈S then c1 + c2∉S for all [formula] with (c1,c2)  ≠  (0,1) and c2 > 0.

Property B: [formula] for all [formula] .

In the remaining part of this paper, we will study constructions and properties of Pearson codes. In particular, we are interested in Pearson codes that are optimal in the sense of having the largest number of codewords for given parameters n and q. We will commence with a description of prior art T-constrained codes, a first example of Pearson codes.

T-constrained codes

For integers T satisfying 1  ≤  T  ≤  q, T-constrained codes [\cite=I66], denoted by [formula], consist of q-ary codewords of length n, where T preferred or reference symbols [formula] ∈Q must each appear at least once in a codeword. Thus, each codeword, [formula], in a T-constrained code satisfies

[formula]

The number of q-ary sequences of length n, NT(q,n), where T distinct pre-defined symbols occur at least once in every sequence, equals [\cite=I66]

[formula]

For example, we easily find for T = 1 and T = 2 that

[formula]

and

[formula]

Clearly, the number of T-constrained sequences is not affected by the choice of the specific T symbols we like to favor.

For the binary case, q = 2, we simply find that S2,n(0) is obtained by removing the all-'1' word from Qn, that S2,n(1) is obtained by removing the all-'0' word from Qn, and that S2,n(0,1) is obtained by removing both the all-'1' and all-'0' words from Qn, where Q  =  {0,1}. Hence, indeed,

[formula]

and

[formula]

The 2-constrained code Sq,n(0,q - 1) is a Pearson code as it satisfies Properties A and B [\cite=I67]. There are more examples of 2-constrained sets that are Pearson codes, such as Sq,n(0,1). Note, however, that not all 2-constrained sets are Pearson codes. For example, Sq,n(0,2) does not satisfy Property A if q  ≥  5, since, e.g., both [formula] and [formula] are codewords

It is obvious from Property B that the code S2,n(0,1) of size 2n - 2 is the optimal binary Pearson code. For the ternary case, q = 3, it can easily be argued that S3,n(0,1), S3,n(0,2), and S3,n(1,2) are all optimal Pearson codes of size 3n - 2n + 1 + 1.

However, for q > 3 the 2-constrained sets such as Sq,n(0,1), Sq,n(0,q - 1), and Sq,n(q - 2,q - 1), all of size N2(q,n), are not optimal Pearson codes, except when n = 2. For example, for q = 4, it can be easily checked that the set [formula] is a Pearson code. Its size equals N2(4,n) + N3(3,n)  =  4n - 3n - 2n + 1 + 3, which is larger than N2(4,n) and actually turns out to be the maximum possible size of any Pearson code for q = 4, as shown in the next section, where we will address the problem of constructing optimal Pearson codes for any value of q.

Optimal Pearson codes

For [formula], let m() and M() denote the smallest and largest value, respectively, among the xi. Furthermore, in case [formula] is not the all-zero word, let GCD() denote the greatest common divisor of the xi. For integers n,q  ≥  2, let Pq,n denote the set of all q-ary sequences [formula] of length n satisfying the following properties:

m() = 0;

M() > 0;

GCD() = 1.

For any n,q  ≥  2, Pq,n is an optimal Pearson code.

We will first show that Pq,n is a Pearson code. Property B is satisfied since any word in Pq,n contains at least one '0' and at least one symbol unequal to '0'. It can be shown that Property A holds by supposing that ∈Pq,n and  = c1 + c2∈Pq,n for some [formula] with c2 > 0. Clearly c1 = 0, since [formula] implies that m()  ≠  0. Then, since   =  c2, we infer that GCD()  =  c2  ×  GCD()  =  c2. Since, by definition, GCD()  =  1, we have c2 = 1 and conclude   =  , which proves that also Property A is satisfied. We conclude Pq,n is a Pearson code.

We will now show that Pq,n is the greatest among all Pearson codes. To that end, let S be any q-ary Pearson code of length n. We map all ∈S to  - m() and call the resulting code S'. Then, we map all words ' in S' to ' / GCD('). Note that both mappings are injective and that all words in the resulting code S'' satisfy Properties 1-3. Hence, S'' of size |S| is a subset of Pq,n, which proves that Pq,n is optimal.

From the definitions of T-constrained sets and Pq,n it follows that

[formula]

In the following subsections, we will consider the cardinality and redundancy of Pq,n, and compare these to the corresponding results for T-constrained codes.

Cardinality

In this subsection, we study the size Pq,n of Pq,n. From ([\ref=eqT2PT1]) and the remark following ([\ref=eqN2]), we have

[formula]

From Property B we have the trivial upper bound

[formula]

which is tight in case q = 2 as indicated in Section [\ref=description], i.e.,

[formula]

In order to present expressions for larger values of q, we first prove the following lemma. We define P1,n = 0.

For any n  ≥  2 and q  ≥  3,

[formula]

where the summation is over all integers i in the indicated range such that i - 1 is a divisor of q - 1.

For each i such that 2  ≤  i  ≤  q and i - 1 is a divisor of q - 1, we define Di,n as the set of all i-ary sequences [formula] of length n satisfying m() = 0, M() = i - 1, and GCD() = 1. Let D denote the union of all these disjoint Di,n.

The mapping ψ from Sq,n(0,q - 1) to D, defined by dividing ∈Sq,n(0,q - 1) by GCD(), is a bijection. This follows by observing that, on one hand, ψ() is a unique member of D(q - 1) / GCD() + 1,n, while, on the other hand, any sequence in ∈Di,n is the image of ((q - 1) / (i - 1))∈Sq,n(0,q - 1) under ψ.

Finally, the lemma follows by observing that |Di,n| = Pi,n - Pi - 1,n and |Sq,n(0,q - 1)| = N2(q,n) = qn - 2(q - 1)n + (q - 2)n.

We thus have with ([\ref=eqDqn]) a recursive expression for Pq,n. Starting from the result for q = 2 in ([\ref=eqbin]), we can find Pq,n for any n and q. Expressions for 2  ≤  q  ≤  8 of the size of optimal Pearson codes, Pq,n, are tabulated in Table [\ref=tab1]. The next theorem offers a closed formula for the size of optimal Pearson codes, Pq,n. We start with a definition.

For a positive integer d, the Möbius function μ(d) is defined [\cite=Ha1] to be 0 if d is divisible by the square of a prime, otherwise μ(d) = ( - 1)k where k is the number of (distinct) prime divisors of d.

Let n and q be positive integers. Let Pq,n be the cardinality of a q-ary Pearson code of length n. Then

[formula]

We use the following well-known theorem (see [\cite=Ha1], for example) in our proof of Theorem [\ref=thm:Pearson_size].

Let [formula] and [formula] be functions such that

[formula]

for all positive x. Then

[formula]

For a non-negative real number x, define

[formula]

Let Vx be the set of vectors of length n with entries in Ix and with at least one zero entry and at least one non-zero entry. Define G(x) = |Vx|. To determine G(x), note that there are |Ix|n length n vectors with entries in Ix, and we must exclude the all-zero vector and the (|Ix| - 1)n vectors with no zero entries. Since |Ix| = ⌊x⌋ + 1, we find that

[formula]

For a positive integer d, let Vx,d be the set of vectors [formula] such that [formula]. Since [formula], we see that [formula] and so Vx can be written as the disjoint union

[formula]

Moreover, |Vx,d| = |Vx / d,1|, since the map taking [formula] to [formula] is a bijection.

Define F(x) = |Vx,1|, so F(x) is the number of vectors [formula] such that [formula]. Now,

[formula]

So, by Theorem [\ref=thm:inversion_theorem], we deduce that [\eqref=eqn:inversion] holds. Theorem [\ref=thm:Pearson_size] now follows from the fact that Pq,n = F(q - 1), by combining [\eqref=eqn:inversion] and [\eqref=eqn:G].

After perusing Table [\ref=tab1], it appears that for q  ≥  4, Pq,n is roughly qn - (q - 1)n. An intuitive justification is that among the qn q-ary sequences of length n there are (q - 1)n sequences that do not contain 0, which is the most significant condition to avoid. All this is confirmed by the next corollary.

For any positive integer q, we have that

[formula]

as n  →    ∞  .

The d = 1 term in the sum on the right hand side of [\eqref=eqn:Psize] is qn - (q - 1)n, and the absolute values of remaining terms are each bounded by ⌈q / 2⌉n, since

[formula]

As discussed above, the 2-constrained codes Sq,n(0,1) and Sq,n(0,q - 1) are Pearson codes. Therefore, it is of interest to compare Pq,n with the cardinality N2(q,n) of 2-constrained codes. For q  ≤  3, we simply have Sq,n(0,1) = Pq,n, and thus N2(q,n) = Pq,n. However, for q  ≥  4, we infer from ([\ref=eqN2]), i.e., N2(q,n)  =  qn - 2(q - 1)n + (q - 2)n, and Corollary 1, i.e., Pq,n = qn - (q - 1)n + O(⌈q / 2⌉n) that N2(q,n) < Pq,n, with a possible exception for very small values of n. For all q  ≥  2,

[formula]

and it is not hard to show that

[formula]

where φ(j) is Euler's totient function that counts the totatives of j, i.e., the positive integers less than or equal to j that are relatively prime to j.

We have computed the cardinalities of N1(q,n), N2(q,n), and Pq,n by invoking ([\ref=eqN1]), ([\ref=eqN2]), and the expressions in Table [\ref=tab1]. Table [\ref=tabelqn] lists the results of our computations for selected values of q and n.

Redundancy

As usual, the redundancy of a q-ary code C of length n is defined by n -  log q|C|. From ([\ref=eqN1]), it follows that the redundancy of a 1-constrained code is

[formula]

for n sufficiently large, where the approximation follows from the well-known fact that ln (1 + a)  ≈  a when a is close to 0. Similarly, from ([\ref=eqN2]) we infer the redundancy of a 2-constrained code, namely

[formula]

for n sufficiently large. Since the 2-constrained code Sq,n(0,1) is optimal for q = 2,3, the expression for r2 gives the minimum redundancy for any binary or ternary Pearson code. From Corollary 1, it follows for q  ≥  4 that the redundancy of optimal Pearson codes equals

[formula]

In conclusion, for sufficiently large n, we have

[formula]

if q = 2,3, while

[formula]

if q  ≥  4. Figure [\ref=figredpearson] shows, as an example, the redundancies r1, r2, and rP versus n for q = 8 (the quantity rP was computed using the expression listed in Table [\ref=tab1]). Note that the redundancy r2 decreases while the redundancy of prior art balanced codes, r0, see ([\ref=r_0]), increases with increasing codeword length n. The curve r0 versus n was not plotted in Figure [\ref=figredpearson] as the redundancy of balanced codes is much higher than that of Pearson codes. For example, an evaluation of ([\ref=r_0]) shows that the redundancy r0 = 2.79 for q = 8 and n = 10, while rP = 0.147 for the same parameters.

Conclusions

We have studied sets of q-ary codewords of length n, coined Pearson codes, that can be detected unambiguously by a detector based on the Pearson distance. We have formulated the properties of codewords in Pearson codes. We have presented constructions of optimal Pearson codes and evaluated their cardinalities and redundancies. We conclude that, except for small values of q and/or n, the redundancy of optimal Pearson codes is almost the same as the redundancy of 1-constrained codes.

Jos H. Weber (S'87-M'90-SM'00) was born in Schiedam, The Netherlands, in 1961. He received the M.Sc. (in mathematics, with honors), Ph.D., and MBT (Master of Business Telecommunications) degrees from Delft University of Technology, Delft, The Netherlands, in 1985, 1989, and 1996, respectively.

Since 1985 he has been with the Faculty of Electrical Engineering, Mathematics, and Computer Science of Delft University of Technology. Currently, he is an associate professor in the Department of Intelligent Systems. He is the chairman of the WIC (Werkgemeenschap voor Informatie- en Communicatietheorie in the Benelux) and the secretary of the IEEE Benelux Chapter on Information Theory. He was a Visiting Researcher at the University of California at Davis, USA, the University of Johannesburg, South Africa, the Tokyo Institute of Technology, Japan, and EPFL, Switzerland. His main research interests are in the areas of channel and network coding, security, and (quantum) information theory.

Kees Schouhamer Immink (M'81-SM'86-F'90) received his PhD degree from the Eindhoven University of Technology. In 1998, he founded Turing Machines Inc, which has been successful in applying the tenets of information theory to digital data storage and transmission. He was from 1994 till 2014 an adjunct professor at the Institute for Experimental Mathematics, Essen-Duisburg University, Germany. In 1998, he founded Turing Machines Inc., an innovative start-up focused on novel signal processing for hard disk drives and solid-state (Flash) memories, where he currently holds the position of president.

Immink designed coding techniques of digital audio and video recording products such as Compact Disc, CD-ROM, CD-Video, Digital Audio Tape recorder, Digital Compact Cassette (DCC), Digital Versatile Disc (DVD), Video Disc Recorder, and Blu-ray Disc. He received a Knighthood in 2000, a personal Emmy award in 2004, the 1996 IEEE Masaru Ibuka Consumer Electronics Award, the 1998 IEEE Edison Medal, the 1999 AES Gold Medal, the 2004 SMPTE Progress Medal, the 2014 Eduard Rhein Prize for Technology , and the 2015 IET Faraday Medal. He received the Golden Jubilee Award for Technological Innovation by the IEEE Information Theory Society in 1998. He was named a fellow of the IEEE, AES, and SMPTE, and was inducted into the Consumer Electronics Hall of Fame, elected into the Royal Netherlands Academy of Sciences, the Royal Holland Society of Sciences, and the (US) National Academy of Engineering. He received an honorary doctorate from the University of Johannesburg in 2014. He served the profession as President of the Audio Engineering Society inc., New York, in 2003.

Simon R. Blackburn (M'12) was born in Beverley, Yorkshire, England in 1968. He received a BSc in Mathematics from Bristol in 1989, and a DPhil in Mathematics from Oxford in 1992. He has worked in the Mathematics Department at Royal Holloway University of London since 1992, and is currently a Professor of Pure Mathematics. His research interests include algebra, combinatorics and associated applications in cryptography and communication theory.