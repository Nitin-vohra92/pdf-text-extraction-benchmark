Random Walks on Directed Networks: Inference and Respondent-driven Sampling

INTRODUCTION

Random walks on networks are crucial to the understanding of many network processes, and in many applications, random walks serve as either rigorous or approximate tools depending on the amount of information available about networks. A network sampling methodology taking advantage of a random walk approximation is respondent-driven sampling (RDS). The method, first suggested in [\citet=Heckathorn1997], is especially suitable for investigating hidden or hard-to-reach populations, such as injecting drug users (IDUs), sex workers, and men who have sex with men (MSM). For such populations, sampling frames are typically unavailable because individuals often suffer from social stigmatization and/or legal difficulties, and conventional sampling methods therefore fail. High demand for valid inference on hidden populations, e.g. on the risk behavior of individuals and the disease prevalence in the population, as well as a lack of competing methods, has made RDS a leading method. Examples of RDS studies from 2013 include MSM in Nanjing, China [\citep=Tang2013], undocumented Central American immigrants in Houston, Texas [\citep=Montealegre2013], and IDUs in the District of Columbia [\citep=Magnus2013].

At the core of RDS is the notion of a social network that binds the population together. During the sampling process, already sampled individuals use their social relations (edges of the social network) to recruit new individuals in the population into the sample, creating a snowball-like mechanism. Additionally, information on the structure of the network collected during the sampling process facilitates unbiased population estimates given that the actual RDS recruitment process behaves like a random walk on the network [\citep=Salganik2004] [\citep=Volz2008].

In recent years, much RDS research has focused on the sensitivity of current RDS estimators to violations of the assumptions underlying the estimating process. In fact, it has been shown that RDS estimators may be subject to substantial biases and large variances when some assumptions are not valid [\citep=Gile2010SocMet] [\citep=Lu2012JRSS] [\citep=Wejnert2009] [\citep=Tomas2011EJS] [\citep=Goel2010]. New RDS estimators have been developed to mitigate this problem [\citep=Gile2011arXiv] [\citep=Gile2011JASA] [\citep=LuEtal].

Current RDS estimation assumes that the social network of the population is undirected. However, real social networks are at least partially directed in general. The directedness of a network can be quantified by the the ratio of the number of non-reciprocal (i.e., directed) edges to the total number of edges in the network [\citep=Wasserman1994book]. This value lies between 0 and 1, and a large value indicates that the network is close to a purely directed network. Examples of real social networks and social networks, including e-mail social networks, from online communities having a considerable fraction of non-reciprocal edges are shown in Table [\ref=Tab:SocNetworks]. For these and other directed social networks, RDS methods assuming an undirected network may be biased.

Motivated by these data, we aim to expand RDS estimation to the case of directed networks. Because the RDS method uses the random walk, a random walk framework for directed networks is a key component to this expansion. This is not a trivial task because the random walk behaves very differently in undirected and directed networks. In particular, the stationary distribution of the random walk is simply proportional to the degree of the vertex in undirected networks [\citep=Doyle1984book] [\citep=Lovasz1993Boyal], whereas it is affected by the entire network structure in directed networks [\citep=Donato2004EPJB] [\citep=Langville2006book] [\citep=MasudaOhtsuki2009NewJPhys].

In this paper, we first present the commonly available RDS estimation procedures and the basics of random walks on networks in Sections [\ref=Sec:RDS] and [\ref=Sec:RandomWalks], respectively. Then, we present methods for estimating the stationary distribution from random walks on directed networks and its application to RDS estimation in Section [\ref=Sec:Estimation]. These methods are then evaluated and compared to existing methods by numerical simulations, which we describe in Section [\ref=Sec:Simulation]. The results from simulations are presented in Section [\ref=Sec:Results]. Finally, our findings are discussed in Section [\ref=Sec:Discussion].

RESPONDENT-DRIVEN SAMPLING

In practice, an RDS study begins with the selection of a seed group of individuals from the population. Each seed is given a fixed number of coupons, typically three to five, which are effectively the tickets for participation in the study, to be distributed to other peers in the population. Those who have received a coupon and joined the study (i.e., respondents) are also given coupons to be distributed to other peers that have not obtained a coupon. This procedure is repeated until the desired sample size has been reached. Each respondent is rewarded both for participating in the study and for the participation of those to whom he/she passed coupons, resulting in double incentives for participation. The sampling procedure ensures that the identities of members of the population are not revealed in the recruitment process. For each respondent, the properties of interest (e.g., HIV status), number of neighbors (degree), and the neighbors that the respondent has successfully recruited are recorded.

We approximate the RDS recruitment process by a random walk on the social network. To this end, we assume that (i) respondents recruit peers from their social contacts with uniform probability, (ii) each recruitment consists of only one peer, (iii) sampling is done with replacement, such that a respondent may appear in the sample multiple times, (iv) the degree of respondents is accurately reported, and (v) the population forms a connected network. Then, if the random walk is in equilibrium with a known stationary distribution [formula], where N is the population size, we may estimate pA, the fraction of individuals with a property of interest A, as [\citep=ThompsonSampling]

[formula]

where S is our sample. For undirected networks, the stationary distribution is proportional to the degree [\citep=Doyle1984book] [\citep=Lovasz1993Boyal], and Eq. [\eqref=Eq:GenProbEst] yields the most widely used RDS estimator [\citep=Volz2008] given by

[formula]

where di is the degree of node i. However, the estimator given by Eq. [\eqref=Eq:RDSEst] may be biased for directed networks [\citep=Lu2012JRSS] [\citep=LuEtal]. Therefore, to estimate pA without bias from an RDS sample on a directed network, we need to accurately calculate Eq. [\eqref=Eq:GenProbEst]. Because the stationary distribution {πi} used in Eq. [\eqref=Eq:GenProbEst] is analytically intractable for most directed networks, we will proceed by deriving estimators of it.

RANDOM WALKS ON DIRECTED NETWORKS

We consider a directed, unweighted, aperiodic, and strongly connected network G with N vertices. Let eij = 1 if there is a directed edge from i to j and 0 otherwise. An undirected edge exists between i and j if and only if eij = eji = 1. We denote the number of undirected, in-directed, and out-directed edges at vertex i by [formula], [formula], and [formula], respectively. We use [formula], [formula], and [formula] to refer to the corresponding random variables if a node is drawn uniformly at random. If we specifically mention that the network is undirected, we obtain [formula], and the degree of vertex i refers to [formula]. Otherwise, the degree of vertex i refers to the triplet [formula]. We refer to [formula] and [formula] as the in-degree and out-degree of vertex i, respectively. It should be noted that we may observe for example the out-degree [formula], but not separately the [formula] and [formula] values.

Consider the simple random walk [formula] with state space [formula] on G such that the walker staying at vertex i moves to any of the [formula] neighbors reached by an undirected or out-directed edge with equal probability. We denote the stationary distribution of [formula] by [formula], where πi  =   lim t  →    ∞P(X(t) = i). If we sample from the random walk in equilibrium, vertices will be selected with probabilities given by the stationary distribution, and we then refer to {πi} as the selection probabilities of the vertices in G.

For an arbitrary network, we obtain

[formula]

where the stationary distribution is fully defined by [formula]. In undirected networks, we obtain [formula]. In contrast, there is no analytical closed form solution for {πi} in directed networks. If a directed network has little assortativity (i.e., degree correlation between adjacent vertices), {πi} is often accurately estimated by the normalized in-degree [\citep=LuEtal] [\citep=FortunatoEtal] [\citep=Ghoshal2011NatComm] because

[formula]

where [formula] is the average selection probability. However, the estimate given by [\eqref=Eq:EstPropIndeg] is often inaccurate in general directed networks [\citep=Donato2004EPJB] [\citep=MasudaOhtsuki2009NewJPhys]. Moreover, since it is much easier for individuals to assess how many people they know (i.e., out-degree) than by how many people they are known (i.e., in-degree), it is common to observe only the out-degree. In this case, Eq. [\eqref=Eq:EstPropIndeg] can not be used with an RDS sample.

ESTIMATION OF SELECTION PROBABILITIES FOR DIRECTED NETWORKS

We now derive estimators of the selection probabilities for the random walk on directed networks. We first derive an estimation scheme when the full degree [formula] is observed for all the vertices i visited by the random walk. Then, we extend this estimation to the situation in which only the out-degree [formula] of the visited vertices is observed.

Estimating Selection Probabilities From Full Degrees

In order to estimate {πi}, we assume that X(t0) = i and that t0 is sufficiently large for the stationary distribution to be reached. We evaluate the frequency with which [formula] visits i in the subsequent times. If [formula] leaves i through an undirected edge [formula], where [formula] is one of the [formula] undirected edges owned by i, [formula] may return to i after two steps using the same edge and repeat the same type of returns m times in total, perhaps using different undirected edges [formula]. Then, [formula] and X(t0 + 2m + 2) = k for some k  ≠  i.

If X(t0 + 2) = i, the walk first moves from i through an undirected edge to vertex j at t = t0 + 1 and returns to i through the same edge at t = t0 + 2. The probability of this event is given by [formula]. Because the out-degree of vertex j, i.e., [formula], is unknown, we approximate [formula] by [formula]. Here [formula] denotes the undirected degree distribution under the condition that the vertex is reached by following an undirected edge, i.e. a size-biased distribution for the undirected degree, [formula] [\citep=Newman2010]. It is also possible to estimate [formula] by [formula], which however showed to have hardly any effect in our simulations, and if any, slightly worse. Thus, we estimate the probability of returning to vertex i after two steps by

[formula]

When t  ≥  t0 + 2m + 3, we use Eq. [\eqref=Eq:EstPropIndeg] to estimate the probability to visit vertex i at any time as being proportional to [formula], i.e.,

[formula]

Under these estimates, the number of returns after two steps to vertex i, counting the starting point X(t0) = i as a return to i, is geometrically distributed with expected value [formula], and the number of steps starting from t = t0 + 2m + 2, counting this step, and ending at the time immediately before visiting i with probability [formula] is geometrically distributed with expected value [formula]. We then have a renewal process {Rni;n  ≥  1,R0i = 0} with the nth renewal occurring at random time [formula], where [formula] and [formula]. In Figure [\ref=Fig:Schematic], the behavior of the process during a renewal period is schematically shown. The average time step between consecutive renewal events is equal to 2E(Zni) + E(Yni). The average number of visits to i between the two renewal events, with the visit to i at t = t0 included, is equal to E(Zni). Therefore, from renewal theory [\citep=Resnick], we obtain an estimate of πi as

[formula]

Because [formula] and [formula], removing higher order terms in Eq. [\eqref=Eq:pi-k] yields

[formula]

The proportionality constant is given by imposing that [formula]. If the network is undirected, we obtain [formula], such that π̂i coincides with the exact solution used in Eq. [\eqref=Eq:RDSEst]. If the network is fully directed, i.e., there are no reciprocal edges and α = 1, the estimator is proportional to in-directed degree [formula].

Estimating Selection Probabilities From Out-degrees

A common situation in RDS is that only the out-degrees (i.e., [formula]) of respondents are recorded. Then, the estimator of the selection probabilities given by Eq. [\eqref=Eq:pi-k-hat] can not be directly used. To cope with this situation, we estimate the number of undirected, in-directed, and out-directed edges from the observed out-degrees and substitute the estimators [formula] in Eq. [\eqref=Eq:pi-k-hat].

Assume that we have observed the out-degree [formula] of vertex i. We estimate [formula] and [formula] by their expected proportions of the out-degree, and the in-directed degree by its expectation, as follows:

[formula]

The expectations used in Eq. [\eqref=Eq:EstimateDegrees] rely on the assumption that we have a random sample from the network, which is not true in this case. A plausible assumption on the sampled degree distributions is that they are size-biased. However, our numerical results suggest that a size-biased distribution for un-directed and/or the in-directed degree makes little difference, and if any, increases the bias of selection probability estimators. Therefore, we stay with the estimators given by Eq. [\eqref=Eq:EstimateDegrees].

When [formula] is substituted in Eq. [\eqref=Eq:pi-k-hat] in place of [formula], [formula] in the denominator is a constant. Therefore, the estimator is proportional to [formula], i.e., equivalent to Eq. [\eqref=Eq:EstPropIndeg] calculated with the estimated degrees.

Estimating Network Parameters

The estimators of directed degrees in Eq. [\eqref=Eq:EstimateDegrees] rely on knowing [formula], [formula], and [formula] separately, which are not estimable from a typical RDS sample, where only the out-degrees [formula] of respondents are recorded. Therefore, we need to extend the estimation procedure to handle these unknown moments. We do so by assuming a model for the network from which we can estimate the required moments.

Specifically, we assume that the observed network is a realization of a directed equivalent of the simple G(N,p = λ / (N - 1)) random graph [\citep=Erdos]. Given parameters α∈[0,1] and λ∈[0,N  -  1], each pair of vertices independently forms an edge with probability λ / (N - 1), which is undirected with probability (1 - α) and directed with probability α. When the edge is directed, the direction is selected with equal probability. It follows that λ is the expected total degree of a vertex and that α is the fraction of directed edges as N  →    ∞  .

If N is large, [formula], [formula], and [formula] approximately follow independent Poisson distributions with parameters (1 - α)λ, αλ / 2, and αλ / 2, respectively. Therefore, the out-degree [formula] and the in-degree [formula] are both Poisson distributed with parameter (2 - α)λ / 2. Consequently, if we estimate α and λ, we can estimate the unknown moments by substituting the estimated [formula] and λ̂ in the moments of the (Poissonian) degree distributions.

To find estimators of α and λ, we again consider the random walk [formula] on the network. Assume that eij = 1, X(t0) = i, and X(t0 + 1) = j, for a large t0. If X(t0 + 2) = i, an undirected edge between i and j exists, i.e. eij = eji = 1, and the random walk leaves vertex j via eji. Because the edge between i and j is either in-directed to j or undirected, the probability that the edge is undirected is equal to the probability that a randomly selected edge among all undirected and in-directed edges is undirected, i.e., (1 - α) / (1 - α / 2). If there is an undirected edge between i and j (i.e., eji = 1), the random walk leaves j via eji with probability [formula]. Thus, the random walk revisits vertex i at t0 + 2 under the directed E-R random graph model with probability

[formula]

Let M be the number of immediate revisits, which is described above, during l consecutive steps. Then, we have [formula], where Mk = 1 if a revisit occurs in step k and Mk = 0 otherwise. Mk is Bernoulli distributed, [formula], where jk - 1 is the vertex visited in step k - 1. We obtain the expected number of immediate revisits as

[formula]

If m is the observed number of revisits, we set m = E(M) in Eq. [\eqref=Eq:ExpectedRevisits] to obtain the moment estimator

[formula]

If the estimated   <  0, we force  = 0.

Given [formula], we estimate λ as follows. If α = 0, the network contains only undirected edges, and the observed out-degree equals the observed undirected degree, which has a size-biased distribution, with E(D̃(un)) = λ + 1. If α = 1, the network has only directed edges, and the expected observed out-degree equals the expected number of out-directed edges, λ / 2. By linearly interpolating the expected observed out-degree between α = 0 and α = 1, and substituting it with the mean sample out-degree ū, we obtain ū  =  λ / 2  +  (1 - α)(1 + λ / 2), which yields an estimator of λ as

[formula]

Using [formula] and λ̂, we can estimate the moments of the degree distributions under the random graph model. For example, [formula] is estimated by (1 - )λ̂. By substituting the estimated moments in Eqs. [\eqref=Eq:pi-k-hat] and [\eqref=Eq:EstimateDegrees], we obtain an estimator of the selection probability of vertex i as

[formula]

When α = 0 is assumed known and used in place of [formula], the estimator in Eq. [\eqref=Eq:Pi-kEstDegEstPar] is equivalent to that used in Eq. [\eqref=Eq:RDSEst]. When   =  α = 1, it is proportional to 1, and thus equivalent to the sample mean.

SIMULATION SETUP

We numerically examine the accuracy of our estimation schemes on directed Erds-Renyi graphs, a model of directed power-law networks (i.e., networks with a power-law degree distribution), and a real online MSM social network. We evaluate both the estimated selection probabilities and corresponding estimates of pA. As described in Section [\ref=Sec:Introduction], real directed social networks show a varying fraction of directed edges, corresponding to a diversity of α values. Therefore, α is varied in the model networks. We also vary λ and other network parameters. We study the performance of the estimators described in Section [\ref=Sec:Estimation] when the full degree is observed and when only the out-degree is observed, and compare the performance of our estimators to existing estimators. We do not consider RDS estimators that are not based on the random walk framework because they fall outside the scope of this study.

Network Models and Empirical Network

The first model network that we use is a variant of the simple Erds-Rényi graph with a mixture of undirected and directed edges, as described in Section [\ref=SubSec:NetworkParameters]. We generate the networks with α∈{0.25,0.5,0.75} and λ∈{5,10,15}. We then extract the largest strongly connected component of the generated network, which has O(N) vertices for all combinations of α and λ.

The directed Erds-Rényi networks have Poisson degree distributions with quickly decaying tails. To mimic heavy-tailed degree distributions present in many empirical networks [\citep=Newman2010], we also use a variant of the power-law network model proposed in [\citep=Goh2001PRL] [\citep=Chung2002PNAS] [\citep=Chung2003PNAS]. The original algorithm for generating undirected power-law networks presented in [\citet=Goh2001PRL] is as follows.

We fix the number of vertices N and expected degree E(D). Then, we set the weight of vertex i (1  ≤  i  ≤  N) to be wi = i-  τ, where 0  ≤  τ  ≤  1 is a parameter that controls the power-law exponent of the degree distribution. Then, we select a pair of vertices i and j (1  ≤  i  ≠  j  ≤  N) with probability proportional to wiwj. If the two vertices are not yet connected, we connect them by an undirected edge. We repeat the procedure until the network has E(D)N / 2 edges. The expected degree of vertex i is proportional to wi, and the degree distribution is given by [formula], where [formula] [\citep=Goh2001PRL].

To generate a power-law network in which undirected and directed edges are mixed with a desired fraction, we extend the algorithm as follows. First, we specify the expected undirected degree [formula] and generate an undirected network. Second, we define wini  =  (σin(i))-  τin (1  ≤  i  ≤  N), where σin is a random permutation on 1, [formula], N, and τin is a parameter that specifies the power-law exponent of the in-directed degree distribution. Similarly, we set wouti  =  (σout(i))-  τout (1  ≤  i  ≤  N). Third, we select a pair of vertices with probability proportional to winiwoutj. If i  ≠  j and there is not yet a directed edge from j to i, we place a directed edge from j to i. We repeat the procedure until a total of [formula] edges are placed. It should be noted that [formula]. The in-directed degree distribution is given by [formula], where [formula], and similar for the out-directed degree distribution. Finally, we superpose the obtained undirected network and directed network to make a single graph. If the combined graph is not strongly connected, we discard it and start over. This network is devoid of degree correlation by construction.

In both network models, we vary the probability of a vertex being assigned property A as proportional to six different combinations of its degree: in-degree, out-degree, undirected degree, in-directed degree, out-directed degree, and directed (in- and out-directed) degree. Formally, if [formula], we let g be equal to [formula], [formula], [formula], [formula], [formula], and [formula], respectively. We refer to these as different ways to allocate property A. We also examined the case in which we assigned the property uniformly over all vertices. However, because the performance of the different estimators is almost the same in this case, we do not show the results in the following. For all allocations of A, the property is assigned in such a way that the expected proportion of vertices being assigned A is equal to some fixed value p. Because A is stochastically assigned, the actual proportion pA of vertices with A will vary between realized allocations.

We also evaluate our estimators on an online MSM social network, www.qruiser.com, which is the Nordic region's largest community for lesbian, gay, bisexual, transgender and queer persons [\citep=Rybski2009] [\citep=LuEtal] [\citep=Lu2012JRSS]. Our dataset consists of 16,082 male homosexual members and forms a strongly connected component. Because members are allowed to add any member to their list of contacts without approval of that member, the resulting network is directed; the fraction of directed edges equals α = 0.7572. The in-degree and out-degree distributions are skewed [\citep=Lu2012JRSS], and the mean number of edges λ is equal to 27.7434. The data set also includes user's profiles, from which we obtain four dichotomous properties on which we evaluate estimators of population proportions: age (born before 1980 or not), county (live in Stockholm or not), civil status (married or unmarried), and profession (employed or unemployed).

Evaluation of Estimators

We compared the performance of our estimators of the selection probabilities with three other estimators. We refer to our estimator {π̂i} obtained from Eq. [\eqref=Eq:pi-k-hat] as [formula] (ren stands for renewal). The other estimators are the uniform stationary distribution [formula], where [formula] for all i, the selection probabilities proportional to the out-degree [formula], on which Eq. [\eqref=Eq:RDSEst] is based, where [formula], and the stationary distribution obtained from Eq. [\eqref=Eq:EstPropIndeg] [formula], i.e., proportional to the in-degree. In the following, we suppress the {} notation.

To assess the performance of an estimator we first calculated the estimated selection probabilities π̂i for one of the four estimators and the true stationary distribution πi at all the vertices in the given network. Then, we calculated their total variation distance defined by

[formula]

[\citep=Levin]. The stationary distribution πi was obtained using the power method [\citep=Langville2006book] with an accuracy of 10- 10 in terms of the total variation distance for the two distributions given in the successive two steps of the power iteration.

For [formula], we considered three variants depending on the information available from observed degree and knowledge of the moments of the degree distributions. When the full degree [formula] is observed, we used Eq. [\eqref=Eq:pi-k-hat] to calculate [formula], where [formula] is estimated by the mean of the inverse sample out-degrees. We denote the corresponding estimator with [formula], where f.d. stands for "full degree". When only the out-degree is observed and the moments of the degree distributions are known, we used Eq. [\eqref=Eq:EstimateDegrees]. This case is only evaluated for the directed Erds-Rényi graphs, and the corresponding estimator is denoted by [formula]. If only the out-degree is observed and the moments of the degree distributions are unknown, we used Eqs. [\eqref=Eq:AlphaHat], [\eqref=Eq:LambdaHat], and [\eqref=Eq:Pi-kEstDegEstPar], and the estimator is denoted [formula].

We sampled from each generated network by means of a random walk starting from a randomly selected vertex. In the random walk, we collect the degree of the visited nodes and also check whether they have property A or not. We estimated the population proportion pA from the sample by replacing π in Eq. [\eqref=Eq:GenProbEst] by either [formula], [formula], [formula], or any of the variants of [formula], yielding estimates [formula], [formula], [formula], or [formula], respectively. The sample size is denoted by s.

NUMERICAL RESULTS

Directed Erds-Renyi Graphs

In Table [\ref=Tab:ERObserveAll], we show the mean of the total variation distance DTV between the true stationary distribution and [formula], [formula], [formula], and [formula], calculated on the basis of 1000 realizations of the largest strongly connected component of the directed random graph having N = 1000 vertices. Because the standard deviation of DTV is similar between the estimators, we show an average over the four estimators. The sample size s used in [formula] is 500. We also tried s = 200, which gave similar results. The DTV value of [formula] and [formula] is much smaller than that of [formula] and [formula] for all values of α and λ. Furthermore [formula] always gives smaller DTV than [formula] although the two values are similar for many combinations of the parameters.

In Table [\ref=Tab:ERObserveOutdegreeEstimatedParameters], we show the mean and average s.d. of DTV when the out-degree, i.e. [formula], is observed but the individual [formula] and [formula] values are not. The assumptions underlying the network generation are the same as those for Table [\ref=Tab:ERObserveAll], and the sample size s is equal to 500. Here we consider two cases. In the first case, the moments of the degree distribution are known, and we use the estimator [formula]. In the second case, they are not known, and we use [formula]. Results for [formula] are not shown in Table [\ref=Tab:ERObserveOutdegreeEstimatedParameters] because in-degree is not observed. Table [\ref=Tab:ERObserveOutdegreeEstimatedParameters] indicates that DTV for [formula] is smaller than that for [formula] and [formula] when α is 0.5 and 0.75. When α = 0.75, [formula] yields the largest DTV. For α = 0.1 and 0.25, [formula] and [formula] yield similar results. For all parameter values [formula] slightly outperforms [formula]. We tried s = 200 (not shown) which gave similar s.d. for [formula], and similarly for [formula], except for α = 0.1, where, for example, λ = 15 yielded the s.d. values of 0.0039 and 0.0073 for s = 500 and s = 200, respectively.

To compare estimated pA, we generated 1000 networks for each combination of the parameters α∈{0.25,0.5,0.75} and λ = 10. On each of these networks we in turn allocate the property A in each of the six ways described in Section [\ref=SubSec:NetworkModels]. The probability of a vertex having A is denoted by p∈{0.2,0.5}. For each network and allocation, we simulate a random walk with length s∈{200,500} and calculate the differences between estimated proportions of the population with property A and the actual proportion of vertices with A. In Figure [\ref=Fig:ERProportions], results for α = 0.75, p = 0.5, and s = 500 are shown. The six groups of four boxplots correspond to the six different ways of allocating A (see Section [\ref=SubSec:NetworkModels]). The six boxplots in each group correspond to [formula], [formula], [formula], [formula], [formula], and [formula].

We see that the bias of [formula] and [formula] is small for all allocations, as to be expected. For the estimators utilizing the out-degree, [formula], [formula], and [formula], Figure [\ref=Fig:ERProportions] indicates that the choice of how to allocate A has a significant impact on the performance of estimators. When A is allocated proportional to the out-degree (Out-deg. in Fig. [\ref=Fig:ERProportions]), [formula] and [formula] yields the most accurate result, and when A is allocated proportional to the number of directed edges (Dir. in Fig. [\ref=Fig:ERProportions]), [formula] is most accurate; this is true for almost all parameter combinations. In general, the bias and variance increase with both α and p for all estimators, and a small s results in an increased variance, as to be expected. In the Supplementary material, these findings are further illustrated by numerical results with (α,p,s) equal to (0.5,0.2,500), (0.25,0.5,500), and (0.75,0.5,200).

Networks With Power-law Degree Distributions

To generate power-law networks, we set the expected total number of edges for each node to 16, while we set the expected number of undirected and directed edges equal to [formula], and (4,12). The three cases yield α = 0.25, 0.5, and 0.75, respectively. For each combination of the parameters, we generate 1000 networks of size N = 1000 and calculate the mean of the DTV. We also calculate the s.d., which is of magnitude 10- 3 and therefore not shown. The sample size s is set to 200 and 500.

The average DTV values for [formula], [formula], [formula], [formula], [formula], and [formula] are shown in Figure [\ref=Fig:PL] for various α and γ values. Figure [\ref=Fig:PL] suggests that [formula] and [formula] are the most accurate among the four estimators, with [formula] being slightly better. When α = 0.25 and 0.5, [formula] has a lower mean DTV than [formula], but this difference is not seen when α = 0.75. [formula] performs better than [formula] for all values of γ when α = 0.25, and the opposite result holds true when α = 0.75.

In Figure [\ref=Fig:PLProp], the results for [formula], [formula], [formula], [formula], [formula], and [formula] when γ = 3, [formula], [formula], p = 0.2, and s = 500 are shown. The figure indicates that [formula] and [formula] have small bias across different allocations of A. In contrast, the magnitude of the bias of [formula], [formula], and [formula] depends on the allocation type; [formula] has the smallest bias when A is allocated proportional to the undirected degree, and [formula] and [formula] when A is allocated proportional to the out-degree. Their relative performance is hard to assess for other allocations. In general, a large fraction of directed edges, small γ, and large p increase bias and variance, and variance of course decreases with s. The Supplementary material contains numerical results for [formula], (4.5,4,12,0.5,500), (4.5,12,4,0.5,500), and (3,4,12,0.2,200) to further support these results.

Online MSM Network

For the Qruiser online MSM network, we first evaluate [formula], [formula], [formula], [formula], and [formula]. The results are shown in Table [\ref=Tab:Qruiser]. Note that [formula] is not evaluated because α and λ are not known beforehand. For [formula], [formula], and [formula], DTV to the true selection probabilities is exactly calculated. For [formula] and [formula], we show the mean and s.d. of DTV on the basis of 1000 samples of size 500. We see that [formula] has smaller DTV than [formula], and that the mean DTV of [formula] is smaller than that of [formula] and [formula].

In Figure [\ref=Fig:Qruiser], we show estimates of the population proportions of the age, county, civil status, and profession properties. The true population proportions are shown by the dashed lines. The sample size is 500. Figure [\ref=Fig:Qruiser] indicates that [formula] performs best of all estimators. Among the estimators utilizing [formula], [formula] has the smallest overall bias. Moreover, the variance of [formula] is smaller than for [formula] for all properties, in particular the civil status.

DISCUSSION AND CONCLUSIONS

We developed statistical procedures for sampling vertices in social networks to account for the empirical fact that social networks generally include non-reciprocal edges. The proposed estimation procedures typically outperformed existing methods that neglect directed edges. Among the scenarios investigated in the present study, the best accuracy of estimation was obtained when undirected, in-directed, and out-directed degree are separately observed for sampled individuals. In the more realistic scenario in which one only knows the sum of undirected and out-directed edges of sampled individuals, all estimation procedures are less precise. Our simulations also showed that estimators of population proportions were highly sensitive to how the property A is allocated in the social network.

If the full directed degree [formula] is observed and the moments of the degree distributions are known, our estimator [formula] is compared to [formula]. It can be seen in Tables [\ref=Tab:ERObserveAll] and [\ref=Tab:Qruiser], and Figure [\ref=Fig:PL] that [formula] performs slightly better than [formula] in all the studied situations. The corresponding estimated proportions given by [formula] and [formula] in Figures [\ref=Fig:ERProportions], [\ref=Fig:PLProp], and [\ref=Fig:Qruiser] are very similar.

If only the out-degree [formula] is observed, we compare [formula] and [formula] (Tables [\ref=Tab:ERObserveOutdegreeEstimatedParameters] and [\ref=Tab:Qruiser], and Figure [\ref=Fig:PL]). We also include [formula] in the comparison on the generated networks, and it can be seen that the performance of [formula] is only slightly better than that of [formula]. Our estimator [formula] outperforms [formula] except when the fraction of directed edges α is small (0.1 in Table [\ref=Tab:ERObserveOutdegreeEstimatedParameters] and 0.25 in Figure [\ref=Fig:PL]). This corresponds to that [formula] will deviate further from [formula] as α increases (Eq. [\eqref=Eq:Pi-kEstDegEstPar]). Figures [\ref=Fig:ERProportions] and [\ref=Fig:PLProp] indicate that the results of the estimators [formula], [formula], and [formula] depend much on the allocation of the property A. We believe that it is of interest to further study how properties are distributed in empirical social networks.

If α is known, we can estimate λ using only the mean sample out-degree in Eq. [\eqref=Eq:LambdaHat]. Although generally difficult, it is possible to assess the fraction of directed edges in the social network of a hidden population through direct methods. In many RDS studies, participants are asked questions that experimenters use to quantify the nature of the relationship between a participant and its recruiter, e.g., friends, acquantiances or strangers [\citep=Ramirez2005] [\citep=Wang2007] [\citep=Ma2007]. With these questions, the authors aim to control for non-reciprocated relationships, which could lead to the participant being excluded from the sample. This type of questions is also useful for assessing the directedness of the social network, because the fraction of coupons given by strangers could be a measure of (non-)reciprocity. In [\citet=Gile2012diagnostics], another type of question more directly assessing reciprocation is suggested, e.g. "Do you think that the person to whom you gave a coupon would have given you a coupon if you had not participated in the study first?". Another possible method to estimate α would be to obtain information on the number of revisits m used in Eq. [\eqref=Eq:AlphaHat]. This could be done by asking for example "Would you give a coupon to the person who gave you a coupon if he or she had not yet participated in the study?".

The main focus of the present paper was on accounting for directed edges in a social network. There are also other assumptions in existing estimation procedures (including the current one) worthy of relaxing. For example, the methods typically assume that participants choose coupon recipents uniformly at random among their neighbors in the social network. In reality, they probably sample closely connected neighbors more likely, which may bias estimators of selection probabilities. Extending the RDS methods by allowing weighted edges warrants for future work. It should be noted that our methods allow the two weights on the same undirected edge in the opposite directions to be different, because our framework targets directed networks.

Random walks on directed networks have numerous other applications, including identification of important vertices [\citep=Brin1998conf] [\citep=Langville2006book] [\citep=Noh2004PRL] [\citep=Newman2005SocNetw] and community detection [\citep=Rosvall2008PNAS]. Therefore, we also hope that this work may contribute to an increased understanding in other areas of network research that use random walks on directed networks.