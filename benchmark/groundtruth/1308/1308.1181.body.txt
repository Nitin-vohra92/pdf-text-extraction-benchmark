= =1000 =10000

Magnetic Nonpotentiality in Photospheric Active Regions as a Predictor of Solar Flares

INTRODUCTION

Solar flares are sudden processes that release tremendous energy in a short period of time in the solar atmosphere. They lead to transient heating of local regions and the dramatic enhancement of electromagnetic radiation and high-energy particle ejection. Some large eruptions toward the Earth have an impact on normal human activities. It is worthwhile to make short-term predictions of solar flares to reduce losses. For a long period of time, solar physicists have been trying to understand the physics of flares, in order to make predictions by simulating the evolutions of magnetic fields in the solar atmosphere and by obtaining information from the solar interior. At present, however, it seems relatively feasible to make predictions based on the statistical relationships between solar eruptions and the evolution of other solar phenomena. Some authors predict flares based on morphological parameters or remote information from different sources (e.g., [\citealt=Gallagher02] [\citealt=Qahwaji07] [\citealt=LiR07] [\citealt=Colak09] [\citealt=Bloomfield12]). Such predictors require manual intervention before entering the prediction process, and therefore are not suitable for automatic operations. There are some other flare-prediction studies adopting the measures deduced from longitudinal magnetic fields (e.g., [\citealt=Georgoulis07] [\citealt=YuDR09] [\citealt=SongH09] [\citealt=Mason10] [\citealt=YuanY10] [\citealt=Ahmed11]).

The accumulation of magnetic nonpotential energy is of importance for solar eruptions. [\citet=Mason10] mentioned the importance of the vector-field data to obtain the most promising flare-predictive magnetic parameters. Leka and Barnes ([\citeyear=Leka07]) contributed a great amount to the exploration of the differences of magnetic-field properties between flare-imminent and flare-quiet active regions, however, the number or the time spans of their samples were quite restricted. Lacking long-term consistent observations of vector magnetic fields, the magnetic nonpotentiality was rarely used in solar flare predictions. The vector magnetograms obtained at the Huairou Solar Observing Station over more than 20 yr make the experiments possible. [\citeauthor=YangX12] ([\citeyear=YangX12], hereafter [\citetalias=YangX12]) have calculated the statistical relations between magnetic nonpotentiality and solar flares. By means of the prediction experiments described in this Letter, we can predict the occurrence of flares in particular active regions based on their magnetic properties alone, and also can estimate the starting time and eruption magnitude of the flares. In addition, several classical verification measures of dichotomous predictions are discussed to call for more serious concerns on the verification issue [\citep=Doswell90]. The Heidke Skill Scores (HSS) and the True Skill Statistics (TSS; see Section [\ref=S-SS]) of our 100 group experiments are in the ranges 0.23-0.48 and 0.32-0.82, respectively. Our results show that the nonpotentiality predictors improve the performance of predicting more powerful flares.

DATA AND METHOD

Data and Preprocessing

We use the observational data of photospheric active region vector magnetograms obtained by the Solar Magnetic Field Telescope (SMFT; [\citealt=AiGX86]) at the Huairou Solar Observing Station, National Astronomical Observatories of China. SMFT is a 35 cm aperture vector magnetograph with a tunable birefringent filter. The working spectral line for the vector magnetograms is Fe  I λ5324.19, which is a strong and broad line with an equivalent width of about 0.334 Å and a Landé factor of 1.5 ([\citealt=AiGX82]). The data employed are selected from all the vector magnetograms during the period from 1988 to 2008 subject to the following criteria: (1) the active regions are located within 30 [formula] from the solar disk center, and (2) only one magnetogram is used for each active region in one observation day. The final data set, which is also used in [\citetalias=YangX12], consists of 2173 photospheric vector magnetograms involving 1106 active regions. The detailed descriptions of the data and their distributions during the two solar cycles are in [\citetalias=YangX12], as well as the calibration for the vector magnetograms and the determination of the 180 [formula] ambiguity of the transverse field. The records of soft X-ray flares are available from NOAA's National Geophysical Data Center.

Magnetic Nonpotentiality Parameters as Predictors

The magnetic nonpotentiality parameters as predictors, the inputs for the prediction model, are the mean planar magnetic shear angle [formula], mean shear angle of the vector magnetic field [formula], mean absolute vertical current density [formula], mean absolute current helicity density [formula], absolute averaged twist force-free factor |αav|, mean free magnetic energy density [formula], effective distance of the longitudinal magnetic field dE, longitudinal-field weighted effective distance dEm [\citepalias=YangX12], mean horizontal gradient of the longitudinal field [formula], maximum horizontal gradient [formula], length of strong-gradient (>  0.05 G km- 1) inversion lines Lgnl, and mean density of longitudinal magnetic energy dissipation [formula] ([\citealt=CuiYM06] [\citealt=JingJ06]). All of the above measures are macroscopic and averaged quantities, which indicate the magnetic nonpotentiality or magnetic complexity of a whole active region. In the calculations, each magnetogram is represented as ([formula],yi), where [formula] is the predictor array and yi∈{1, - 1} is the class label of the magnetogram (yi = 1 for flaring instances and yi =  - 1 for non-flaring ones, according to the labeling scheme stated in Section [\ref=S-ExpDes]). We have tried five combinations of predictors:

Prediction Method: Support Vector Classification

Predicting whether or not an active region will flare within a certain time interval can be transformed into a classification problem. The support vector machine (SVM) first introduced by Vapnik ([\citealt=Boser92] [\citealt=Cortes95] [\citealt=Vapnik95]) is now a widely applied statistical learning theory used to solve classification and regression problems. In recent years, SVM has been applied to the field of astronomy (e.g., [\citealt=ZhangYX03] [\citealt=Wozniak04] [\citealt=Wadadekar05] [\citealt=GaoD08] [\citealt=Beaumont11] [\citealt=PengNB12]) including solar physics (e.g., [\citealt=QuM03] [\citealt=Qahwaji07] [\citealt=LiR07] [\citealt=AlOmari10] [\citealt=Labrosse10] [\citealt=Alipour12]). A machine learning system for classification is able to learn and construct a model (from the existing training data with definite category labels) which can classify the training data and predict upcoming ones whose categories are unknown. The maximum margin principle and the kernel function are the two core concepts of the SVM. By solving an optimization problem, the SVM classifier is obtained as an optimal separating hyperplane [formula] that separates the two-class data with the maximum distance. When in a linearly non-separable case, a kernel function is employed, then the training vectors [formula] are mapped into a higher-dimensional feature space in which the data can be linearly separated.

The primal optimization problem can be written as

[formula]

C > 0 is the penalty parameter for the sum of slack variables ξi. [formula] corresponds to the distance maximization of the two classes. Taking the reciprocal, the square, and the factor 1/2 are for mathematical convenience. [formula] denote the training vectors in the higher-dimensional space after employing the kernel function. The kernel function is denoted by [formula], and the corresponding dual optimization problem, which is easier to solve, is

[formula]

where αi are the Lagrange multipliers. Then the coefficients αi* for the optimal hyperplane are solved from the dual problem. The training vectors [formula] with [formula] are the support vectors that contribute to the final discriminant function

[formula]

where [formula] and b* are the corresponding solutions of the primal problem ([formula] taking any 0 < α*j < C). The plus and minus signs of [formula] indicate the two different classes.

There are a few commonly used kernels like the polynomial kernel, Gaussian radial basis kernel, sigmoid kernel, etc. After trying several kernels in the calculations, we accept the Gaussian radial basis kernel, the mathematical expression of which is [formula], where σ is a kernel parameter. The SVM software LIBSVM ([\citealt=ChangCC11]) is used in our experiments.

Note that this classification or prediction model is based on statistical relations with no obvious physical meanings; nevertheless, the physical parameters closely related to solar flares must make positive effects to the performance of the model. This is exactly why we adopt magnetic nonpotentiality and complexity parameters as predictors.

EXPERIMENTS AND RESULTS

Experiment Design

According to whether the active regions produce flares exceeding a specified class within a certain time window, every magnetogram is labeled as positive (flaring) or negative (non-flaring). The "time window" in this Letter begins at the observing time of each magnetogram. We set the flaring magnitude thresholds to C1.0, C5.0, M1.0, M5.0, and X1.0, and the time windows 6, 12, 24, and 48 hr. The positive-negative sample ratios are different for different combinations of flaring thresholds and time windows (see Table [\ref=T-sample]). In each labeled set, we divide the whole set into training and testing subsets, then train the training subset to obtain the classifier and test the rest to evaluate the performance of the classifier.

k-fold cross-validation is used for avoiding overfitting. The full set is randomly divided into k subsets with approximately equal size, (k - 1) of which are for training and the remaining is for testing. Training and testing are repeated k times. Each subset is tested exactly once. We take k = 10 for most sets, and k = 5 for the sets whose flaring samples are less than 50. The positive-negative sample ratios of both training and testing subsets are maintained consistent with that of the original set.

Performance Assessment for Predictions

The counts of successes and failures obtained from previous dichotomous prediction constitute a 2×  2 contingency table (confusion matrix in machine learning), as shown in Table [\ref=T-conmat]. The verification measures assessing the prediction performance are derived from the statistics in the table. For simplicity, we use the notations (x,y,z,w) to name the four elements of the contingency table. x is the number of the positive events predicted positive (True Positive or Hit), y the number of the positive events predicted negative (False Negative or Miss), z the number of the negative events predicted positive (False Positive or False Alarm), and w the number of the negative events predicted negative (True Negative or Correct Rejection). x and w make a positive impact on the prediction assessment while y and z do the opposite.

From Table [\ref=T-conmat], we can directly obtain eight ratios of the elements with their associated marginal sums: POD= x / (x + y), FOH= x / (x + z), FAR= z / (x + z), POFD= z / (z + w), FOM= y / (x + y), DFR= y / (y + w), PON= w / (z + w), and FOCN= w / (y + w) (cf. [\citealt=Doswell90]). POD, FOH, PON, and FOCN, in which the numerator is x or w, are hoped to be higher, and the other four are expected to be lower. Other verification measures are also available such as F1-measure, HSS, TSS, Critical Success Index (CSI), Gilbert Skill Score (GSS), and Clayton Skill Score (CSS), a summary of which is shown in Table [\ref=T-SS]. The perfect prediction, which is difficult to achieve in practice, corresponds to these verification measures reaching their upper bounds of 1. Though it has been more than a century since the "Finley affair" (see [\citealt=Murphy96]) inducing hot discussions, the study on this seemingly simple 2×  2 problem remains ongoing ([\citealt=Stephenson00]). In this work, we only consider the classical verification measures which are more intuitional to utilize in practical operations.

The percentage of correct predictions (x + w) / N (referred as ACC hereafter) is the simplest but often misleading measure to assess the prediction, especially when one side, event or non-event, is overwhelming. ACC, CSI, and F1 do not exclude the correct numbers based on the stochastic prediction. The so-called skill scores indicate the relative accuracy of a prediction to some standard reference predictions. The generic form of skill score is

[formula]

where S is a particular measure of accuracy, Sref a reference, and Sperfect the perfect prediction. A no-skill prediction scores 0, a positive score shows a better prediction than the reference, and the perfect prediction scores 1. HSS is a skill score from ACC comparing with the random prediction. GSS is the skill-modified CSI, subtracting the expected correct predictions due to chance from x. F1 is the harmonic mean of POD and FOH, and HSS happens to be the harmonic mean of skill-modified POD and skill-modified FOH (PODs and RSs in [\citealt=Schaefer90]). The skill-modified ones are always lower than the original ones.

These verification measures are related to each other through the connections of x, y, z, and w. A common property of HSS, GSS, TSS, and CSS is that they all have the factor (x  ·  w - y  ·  z) in their numerators. This factor becomes zero in the random prediction, and thus these four skill scores all have the value 0, indicating no skill. In the constant prediction (all positive predictions, y = w = 0; or all negative, x = z = 0), this factor is also zero; CSS is meaningless in this case. The values of CSI, F1, and ACC in random situations depend on the ratio of events to non-events. Another common property of the above four skill scores is that they are all fair to both events and non-events. Considering non-events as focus, swapping x with w and y with z simultaneously, they remain unchanged; this is not the case with CSI or F1.

Keeping the numerators of the above four skill scores exactly the same, the differences of their denominators are:

[formula]

GSS is usually less than TSS and HSS, except when y = z = 0 (i.e., in the perfect prediction). There is no definite magnitude relation between TSS and CSS, or between HSS and TSS. HSS is less than TSS if w is overwhelmingly dominant (w  ≫  x and usually z > y in optimizing TSS). There is little difference between HSS and TSS if w is not dominant. Detailed introductions to the contingency table and forecast verification can be found in [\citet=Wilks06].

Experiment Results and More Comments on Verification

It is nearly impossible to optimize all the verification measures simultaneously ([\citealt=Manzato05]; see also the results of [\citealt=Bloomfield12]). Accordingly, we compute the geometric mean of several verification measures (POD, FOH, TSS, HSS, GSS, CSI, F1, and [formula]) which we are more concerned about. A grid search process is carried out to obtain a relatively better pair of (C,σ2) for the final SVM classifier. A12's results are shown in Table [\ref=T-result], in which each value with its error is the arithmetical mean of the specific verification measure in k times testing. The percentage of non-events (N0 / N) is given at the end of each row for reference. F1 is always higher than CSI, except when x = 0 or y = z = 0. In rare event situations, HSS is close to F1, so HSS is likely higher than CSI. In our results, there are only two cases with HSS lower than CSI (C1.0, 48 hr; C1.0, 24 hr). These are the top two cases whose positive samples are in a larger proportion compared with other cases and w is not extremely dominant. The predictors derived from longitudinal magnetic fields (L05) perform somewhat better than those mainly involving transverse components (V06, V08) in predicting flares of ≥  C1.0 and ≥  C5.0. However, the superiority diminishes in predicting more powerful flares. For instance, in the case of ≥  M5.0 or ≥  X1.0 flares, the performance of longitudinal predictors becomes worse than that of other predictor combinations. It seems that the predictors from longitudinal fields are less sensitive in predicting large flares. Overall, there is an improvement in the prediction employing various measures derived from vector magnetic fields (A10, A12).

HSS and TSS are often discussed and applied in forecast verification (e.g., [\citealt=Woodcock76] [\citealt=Doswell90] [\citealt=Manzato05]). HSS  =  TSS when y = z; [formula] when N1 = N0. [\citet=Bloomfield12] proposed using TSS instead of HSS as a standard to reliably compare flare forecasts. However, no single scalar measure can cover all the information of the prediction results. Even the unbiased TSS, which is independent of the event frequency, fails to effectively deal with rare event predictions ([\citealt=Doswell90]). TSS approaches POD in rare event situations, so both w and z contribute little to the results. Experientially, z rises if x's proportion is increased. The bias ((x + z) / (x + y)  ≠  1) may be unintentionally introduced in optimizing a verification measure [\citep=Manzato05]. Pursuing higher POD or TSS will cause higher FAR and lower FOH. Fewer misses cost more false alarms, but "crying wolf" may be undesirable. Moreover, the same TSS does not mean the same prediction performance. For instance, Table [\ref=T-example] lists some examples from [\citet=Woodcock76]. The prediction P1 has POD = 75% and PON = 50%, and P2 has POD = 50% and PON = 75%. TSS remains the same in the two cases and two predictions, but the results are indeed different. Therefore, only one measure might mislead the prediction verification, and multiple verification measures are probably acceptable. This point of view is as well mentioned in [\citet=Schaefer90], [\citet=Doswell90], [\citet=Marzban98], etc. We believe that, since each data set may have its own intrinsic properties, it is inappropriate to compare different predictions on different trial samples.

CONCLUSIONS AND DISCUSSIONS

Based on the long-term reliable observations of the photospheric vector magnetic fields by SMFT, we adopt some nonpotentiality measures which are not available from observations of only line-of-sight magnetic fields to study the prediction of solar flares. Real-time processing and no manual intervention are two advantages of our prediction system. The data for the input of the prediction model are obtained by local observations, and the key measures as predictors are available without manual operations.

From our experiments, the combinations of magnetic measures derived from longitudinal fields perform well in the flare prediction, however, they may be less sensitive than the measures from vector fields in predicting large flares. The information of transverse fields makes a limited contribution to the prediction of low magnitude flares, but it does improve the prediction for large flares such as ≥  M5.0 and ≥  X1.0 ones. Thus, it is reasonable to include transverse field components in flare predictions.

To avoid misleading the optimization work or misusing the results from a single verification measure, prediction results should be assessed carefully. It is helpful to consider multiple verification measures. A step like k-fold cross-validation is necessary for improving the generalization capability of the prediction models. The intrinsic properties of various data sets may make a specific tool perform rather differently, and hence, it is then significant to make comparisons in the same data environment.

Some researchers have begun to use vector magnetograms from the Helioseismic Magnetic Imager (HMI) on board the Solar Dynamics Observatory to predict solar flares. Yet, the prediction methods founded on statistical information are restricted by the finite time span of HMI data at present. Results of statistical predictions depend on both the historical data set and prediction method employed. There is still a long way to go for the prediction of solar activities employing the exquisite HMI data.