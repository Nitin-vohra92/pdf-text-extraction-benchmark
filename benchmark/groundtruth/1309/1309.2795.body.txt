Note on a double binomial sum relevant to the Hadamard maximal determinant problem

Introduction

In this note we prove two results, one known and one new, involving binomial sums where the absolute value function occurs in the summands.

Lemma [\ref=lemma:Best] is a binomial sum which has appeared several times in the literature, e.g. Alon and Spencer [\cite=AS], Best [\cite=Best], Brown and Spencer [\cite=BS], Erds and Spencer [\cite=ES]. It was also a problem in the 1974 Putnam competition [\cite=Putnam74]. Lemma [\ref=lemma:Best] can be used to calculate the mean of each diagonal term that arises when the probabilistic method is used to give lower bounds for the Hadamard maximal determinant problem, as in [\cite=rpb253].

Our new result is Theorem [\ref=thm:double_sum], which gives a closed-form expression for a double sum which is analogous to the single sum of Lemma [\ref=lemma:Best]. Theorem [\ref=thm:double_sum] can be used to calculate the second moment of each diagonal term that arises when the probabilistic method is used to give lower bounds for the Hadamard maximal determinant problem. In [\cite=rpb253] we gave lower bounds without using this second moment, but such results can be improved if the second moment is known [\cite=rpbxxx].

To prove Theorem [\ref=thm:double_sum] we first use symmetry to eliminate the absolute value function occurring in the sum, and then use a two-variable variant of the method of telescoping sums, where the double sums collapse to give single sums which can be evaluated explicitly. The "magic" cancellation giving the final result suggests that a simpler proof could exist, but we have not found such a proof.

Notation

The variables k, n, p, q denote integers (not necessarily positive).

The binomial coefficient [formula] is defined to be zero if k  <  0 or k  >  n. Using this convention, we can often avoid explicitly specifying upper and lower limits of sums involving binomial coefficients.

A well-known single sum

Lemma [\ref=lemma:Best] is well-known, as noted in the Introduction. We give a proof because it illustrates some of the ideas used in the proof of Theorem [\ref=thm:double_sum].

For all k  ≥  0,

[formula]

Let [formula]. Splitting the sum into sums over positive and negative p, using [formula], and observing that the term for p = 0 vanishes, we see that

[formula]

Writing p  =  (k + p)  -  k gives

[formula]

Substituting this into [\eqref=eq:Sigma_1] and using

[formula]

and

[formula]

gives

[formula]

This completes the proof of Lemma [\ref=lemma:Best].

The main result - a double sum

For all k  ≥  0,

[formula]

Write

[formula]

The terms in S1 for which p = 0 or q = 0 are

[formula]

and the other terms are

[formula]

Considering the generating function

[formula]

applying the operator xd  /  dx twice, and evaluating the resulting expression at x = 1, we see that

[formula]

so

[formula]

Also, using symmetry, we have

[formula]

Now write p2 - q2  =  (p - k)(p + k)  -  (q - k)(q + k), so

[formula]

[formula]

On the right-hand side we use

[formula]

and the corresponding identity for [formula]. After cancelling the terms involving [formula] and regrouping, this gives

[formula]

Changing variables in the second and third summations, we obtain

[formula]

The expressions inside each pair of square brackets both involve a kind of two-variable telescoping sum - the only terms that do not cancel are those for q = 0. Thus, we obtain

[formula]

Taking out the factors that are independent of p, we are left with two easily-evaluated sums, giving

[formula]

Recall that S1  =  S2  +  S3. Using the expressions [\eqref=eq:S2] for S2 and [\eqref=eq:S3] for S3, and simplifying, we obtain the desired result for S1.

Acknowledgement

We thank Warren D. Smith for his comments on earlier drafts of this note.