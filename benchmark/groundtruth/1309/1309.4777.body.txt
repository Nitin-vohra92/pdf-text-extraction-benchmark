=10000 =10000

Jet Cleansing: Pileup Removal at High Luminosity

Introduction

Many interesting signatures both in the Standard Model and beyond are seen at the LHC in hadronic final states. This has motivated recent theoretical work in jet substructure, e.g. [\cite=Gallicchio:2010sw] [\cite=Almeida:2011aa] [\cite=Azatov:2013hya] [\cite=Backovic:2012jj] [\cite=Chien:2013kca] [\cite=Cui:2013spa] [\cite=Curtin:2012rm] [\cite=Dasgupta:2013ihk] [\cite=Dasgupta:2013via] [\cite=Ellis:2012sd] [\cite=Ellis:2012zp] [\cite=Ellis:2012sn] [\cite=Feige:2012vc] [\cite=Gallicchio:2012ez] [\cite=Gallicchio:2011xq] [\cite=Gouzevitch:2013qca] [\cite=Han:2012cu] [\cite=Hedri:2013pvl] [\cite=Hook:2012fd] [\cite=Kahawala:2013sba] [\cite=Krohn:2012fg] [\cite=Soper:2012pb], much of which has seen quick adoption in the experimental community (for an overview of the field see [\cite=Salam:2009jx] [\cite=Altheimer:2012mn] [\cite=Shelton:2013an] [\cite=Plehn:2011tg]). One outstanding problem is pileup (PU), defined as overlapping secondary collisions on top of the primary interaction. As a rough rule-of-thumb, each pileup vertex contributes around 600 MeV of energy per unit rapidity per unit azimuth [\cite=Cacciari:2008gn] [\cite=Cacciari:2009dp] [\cite=Rubin:2010fc] (in contrast, the underlying event contributes around 2-3 GeV of energy density.) Thus, for [formula], levels which will soon be regularly encountered at the LHC, an R = 1.0 jet might suffer 200 GeV of contamination!

There are already a number of very effective tools for pileup removal. The trackers at both the ATLAS and CMS experiments can determine with excellent accuracy whether a charged particle harder than around 500 MeV came from the leading vertex or a pileup vertex. Thus, most of the charged hadrons from pileup can be simply discarded - a method called charged hadron subtraction (CHS) which is used by CMS. An alternative, popular in the ATLAS collaboration, is to use the Jet Vertex Fraction (JVF) - defined as the fraction of track energy coming from the leading vertex. Cutting on the JVF can effectively remove pileup jets.

Over the last few years, these solutions have been bolstered by new ideas coming from jet substructure. These fall into roughly two classes: (1) Jet area subtraction [\cite=Cacciari:2007fd] estimates the amount of pileup in a particular jet from the pileup density ρ outside of the jet, on an event-by-event basis. Subtracting off ρ  ~    ×   area from the jet energy successfully restores distributions of kinematic observables to close to their uncontaminated state. Through a clever modification called shape subtraction this technique can also be applied to more general jet shapes [\cite=Soyez:2012hv]. (2) Jet grooming techniques (i.e. filtering [\cite=Butterworth:2008iy], pruning [\cite=Ellis:2009su] [\cite=Ellis:2009me], and trimming [\cite=Krohn:2009th]) attempt to identify individual pileup emissions within jets and remove them dynamically. Methods from both classes, as well as combinations of methods, have already proven effective in 7 and 8 TeV LHC data.

Despite the success of these varied techniques, pileup is not a solved problem. None of the above methods is powerful enough to fully alleviate pileup's effects once [formula]. This can be seen by comparing the top and bottom panels of Figs. [\ref=fig:dijetmass] and [\ref=fig:jetmass]. These figures show the results of various cleansing and subtraction techniques on a dijet mass resonance distribution and a jet mass distribution (see Sect. [\ref=sec:results] for a description of the dijet resonance used). While with moderate pileup most methods work well, at higher levels their performance deteriorates. The deterioration can also be seen in the 2D distribution of an observable with no pileup (using truth information) and the observable after pileup is added and then subtracted/groomed. Such distributions are shown in Figs. [\ref=fig:dijet2D] and [\ref=fig:jet2D]. In addition, the assumption made by subtraction, that pileup is uniformly distributed over an event is inherently more effective for kinematic observables (e.g. jet pT) than for jet shape observables (e.g. jet mass, N-subjettiness) which are sensitive to the distribution of radiation within a jet. Furthermore, shape subtraction is performed as a Taylor expansion in the pileup density which can become inaccurate for large values of the expansion parameter, ρ. In this paper, we present a method we call jet cleansing which works at high pileup, is observable independent and is remarkably effective for both kinematic and shape variables.

A new element introduced with jet cleansing beyond current experimental techniques like CHS and JVF takes inspiration from early successful jet substructure techniques [\cite=Butterworth:2008iy] [\cite=Cacciari:2008gd] [\cite=Kaplan:2008ie] [\cite=Krohn:2009th]. These methods demonstrated the power of reclustering a large R jet into jets of smaller R and have been validated in data. We find similarly that pileup removal can be much more effective if done on subjets with [formula] or [formula] rather than on full jets. Cleansing attempts to tailor the degree of energy rescaling within a jet based on locally measured levels of charged and neutral particles.

The Algorithm

To produce the inputs to our algorithm, without access to full detector simulation, we make the following approximations and assumptions. We discard all charged particles with pT  <  500 MeV. We then aggregate the remaining particles into [formula] "calorimeter cells", discarding any cells with E  <  1 GeV. These calorimeter cells are then clustered into subjets of size [formula]. We assume the charged particles can all be tagged as either coming from the leading vertex or not, and we associate them to the nearest calorimeter cell. The input to cleansing is therefore three numbers per subjet: the total transverse momentum, [formula], the pT in charged particles from the leading vertex, [formula], and the pT from charged particles from pileup, [formula]. Jet cleansing aims to best extract the total momentum from the leading vertex only, [formula], using these three inputs to rescale the four-vector constituents of the measured subjet [formula].

We propose three methods of varying sophistication with which [formula] can be guessed. Before explaining them, it is helpful to define [formula] and [formula]. While we do not know γ0 or γ1 for any particular subjet, they are constrained by

[formula]

The first method, which we call JVF cleansing simply assumes γ0  =  γ1. This is the assumption that the charged-to-neutral ratio is the same for pileup component and hard scatter component of jets. The result is that

[formula]

JVF cleansing is similar to methods ATLAS has used (at the jet level). However, while effective, JVF cleansing omits two important effects. First, there are large fluctuations in both γ0 and γ1 from subjet to subjet. The other problem is that the expected values of γ0 and γ1 are not the same. The difference is largely due the fact that detector resolution treats soft and hard particles, and charged and neutral particles differently.

To improve on JVF cleansing, we observe that the γ0 distribution is determined by fragmentation following many independent secondary collisions, while γ1 is largely due to the fragmentation of a single hard parton. Thus, the fluctuations of γ0 around its mean should decrease with [formula], while the fluctuations of γ1 are [formula]-independent. This can be seen in Fig. [\ref=fig:g0], which shows the γ0 distribution for events with no leading vertex for various values of [formula]. So an alternative to JVF cleansing is to take γ0 to be a constant, called [formula]. Based on Fig. [\ref=fig:g0], we choose [formula]. In fact, the distribution of γ0 is sensitive to how soft particles are handled. Ignoring detector effects it should be close to the isospin limit [formula]. Experimentally, γ0 can be determined from minimum bias events in data.

Taking [formula] for all subjets, we can then solve Eq. [\eqref=constraint] for γ1. This gives

[formula]

The correlation of γ1 from solving this equation with the truth-level γ1 is shown in Fig. [\ref=fig:g0] at [formula]. We find a 96.6% correlation. Using γ1 to solve for [formula] we get

[formula]

which is linear in [formula] and does not depend on [formula] or the JVF. We call this method linear cleansing. As [formula], the γ0 distribution as in Fig. [\ref=fig:g0] becomes sharper. Thus, linear cleansing becomes more and more effective as pileup increases. Even for moderate pileup, linear cleansing takes advantage of the fact that the stochastic nature of pileup makes the uncertainty on γ0 less than on γ1. Linear cleansing often yields an improvement over JVF cleansing and area/shape/charged hadron subtraction, as we quantify shortly.

In the third method, which we call Gaussian cleansing, the γ1 and γ0 distributions are approximated as truncated Gaussians:

[formula]

for [formula] where [formula] and σi are the mean and widths of the Gaussian approximations In what follows we will take [formula], [formula], σ0 = 0.15 and σ1 = 0.22, although we have seen that the results are not very sensitive to these choices. . We then find the values of γ0 and γ1 satisfying Eq. [\eqref=constraint] which maximize Eq. [\eqref=eq:maxl]. This approximation requires four input parameters but for this one is rewarded with further increases in performance.

We have implemented these three methods in a Fastjet plugin which can be obtained at and as part of the Fastjet Contrib project, .

Results

Below we compare each of the three cleansing methods to subtraction and CHS, all with and without jet grooming. The details of our implementation of subtraction and CHS are found in App. [\ref=sec:simulation]. We find that cleansing naturally dovetails with filtering and trimming, which already employ subjets. Where grooming is applied we adopt the trimming procedure which supplements cleansing by applying a cut on the ratio f of the subjet pT (after cleansing) to the total jet pT. Subjets with [formula] are discarded.

Our signal process comes from a color-singlet resonance with a mass of 500 GeV decaying into q dijets, while our background is from QCD dijet events all at [formula] TeV. Jets are clustered using the anti-kT [\cite=Cacciari:2008gp] algorithm with R = 1.0  implemented in Fastjet v3.0.3 [\cite=Cacciari:2011ma]. Where we do apply jet cleansing we employ [formula] subjets and take fcut = 0.05 where trimming is used. Further technical details of the simulation are found in App. [\ref=sec:simulation].

To test jet cleansing, we compare its performance to other methods in the reconstruction of both a kinematic variable, the dijet invariant mass, and a jet shape variable, the jet mass. As measures of performance, we consider significance as approximated by [formula], where S and B are the number of signal or background events in a 40 GeV window (the center of the window is floated separately to optimize significance for each method). For signal events, we also compute the Pearson linear correlation coefficient r between the observable with and without pileup contamination. The correlation coefficient is a useful measure here because the objective of cleansing is to restore the full representation of the jet. While correlations can be sensitive to the tails of distributions a high correlation indicates the method is successfully returning the jet to its uncontaminated state.

Results for the dijet invariant mass and jet mass are presented in Tables [\ref=table:resultsD] and [\ref=table:resultsM] respectively. Correlations for sample distributions are shown in Figs. [\ref=fig:dijet2D] and [\ref=fig:jet2D] and the correlation coefficients as a function of [formula] are plotted in Fig. [\ref=fig:CorrPU]. As one can see from the tables and plots, jet cleansing yields the best performance in every test case. Both area and shape subtraction can be improved by working at the subjet level, and including a mild amount of trimming, yet even with these improvements cleansing still comes out ahead. Also, as mentioned above, cleansing is especially effective at improving measurements of observables like jet mass which are more sensitive to the spatial distribution of radiation within a jet. We therefore expect cleansing also to work well on N-subjettiness [\cite=Thaler:2010tr] [\cite=Kim:2010uj] [\cite=Thaler:2011gf] which is especially sensitive to contamination.

That Gaussian cleansing tends to work better than linear cleansing is not surprising, since it is a more sophisticated algorithm. However, Gaussian cleansing needs input about the γ1 distribution which is related to the signal process. Although results are not that sensitive to the precise values of widths and means of the Gaussians used as inputs, there could be some process/energy dependence if optimal performance is desired. In contrast, linear cleansing only requires an estimate of [formula] which can be extracted from minimum bias data.

Finally, it is worthwhile to note the role played by trimming. As jet cleansing is designed to locally remove pileup it achieves the best correlations when used without trimming. If one wishes to approximate the jet's pre-pileup state, cleansing alone is the best option. Trimming offers improvement when the objective is to maximize [formula]. This makes sense because trimming is known to be useful, even when applied on jets with no pileup, as it tends to remove underlying event and other soft contamination primarily leaving the final state radiation. For subtraction and CHS, in contrast, at high levels of pileup trimming is important both for correlations and [formula].

Conclusions and Outlook

Jet mass has been calculated to high accuracy using perturbative QCD [\cite=Dasgupta:2012hg] [\cite=Chien:2012ur] [\cite=Jouttenus:2013hs], and measured in 7 TeV LHC data [\cite=ATLAS:2012am] [\cite=Chatrchyan:2013rla]. A direct comparison between these calculations and the data has been limited by the contamination of pileup. Since the improvement in pileup removal of cleansing over shape subtraction for jet mass are substantial, there is now hope that precision QCD jet shape (and jet distribution) calculations can be productively compared to data from the high luminosity LHC runs.

While jet cleansing works extremely well at high pileup, it is not perfect. It would be interesting to explore whether it could be improved by combining it with jet area subtraction, or by exploiting the probabilistic approach as in the Qjets paradigm [\cite=Chien:2013kca] [\cite=Ellis:2012sn] [\cite=Kahawala:2013sba]. It would also be interesting to see if cleansing can reduce the uncertainty on missing energy measurements. Finally, a note of caution - jet energy uncertainties [\cite=Aad:2012ag] [\cite=CMS-PAS-JME-10-014] may ultimately limit the performance of jet cleansing. However, given the potential improvements provided by cleansing over current methods, especially in the reconstruction of jet shapes, it is likely that cleansing will still be useful when full detector effects are included.

Note added: Shortly after the preprint was posted, ATLAS demonstrated cleansing works in its full detector simulation at up to pileup levels of [formula] [\cite=ATL-PHYS-PUB-2014-001].

Monte Carlo Details

The signal sample used in this study was a color-singlet scalar resonance with mass [formula] decaying to light quarks. Signal events were generated at matrix-element level using Madgraph5 v1.5.8 [\cite=Alwall:2011uj] requiring that the quarks have [formula]. Pythia v8.176 [\cite=Sjostrand:2007gs], tune 4C, was used to shower and hadronize events. The background sample used was hard QCD dijet events as implemented in Pythia using a phase space cut requiring partons with [formula]. To simulate pileup events, for each event i we overlay ni soft QCD events drawn from a Poisson distribution with mean [formula]. The soft QCD events are generated in Pythia. All samples are generated at [formula].

Jets are clustered from the full event, including the hard scatter and pileup, using the anti-kT algorithm [\cite=Cacciari:2008gp] with R = 1.0 as implemented in Fastjet v3.0.3 [\cite=Cacciari:2011ma]. For each event, the two hardest jets are kept provided they have [formula] and |η| < 2.5. These jets are used in the jet mass distributions and events with both of the two hardest jets passing these cuts are used in the dijet mass distributions. Where trimming is used we employ [formula] subjets and take [formula].

In correlations, the groomed/subtracted/cleansed jet is compared against the "truth" jet. The truth jet is constructed by removing all of the four-vectors originating from pileup leaving only contributions from the underlying hard scatter. In cases where particles from pileup and the hard scatter fall into the same cell, the cell is kept massless but rescaled to its hard scatter value by multiplying the four-vector by [formula].

Subtraction Methods

Area subtraction: Jets corrected by area subtraction via [formula], where ρ is a measure of the event density and Aμ is the four-vector area. To compute ρ, the event is tiled in kT jets with R = 0.5 up to |η| < 4.0 and ρ is taken as the median of the [formula] distribution. This is done using the native Fastjet implementation of JetMedianBackgroundEstimator. For each event we use the global value of ρ and do not include rapidity dependence for simplicity. We have checked that the improvements from including rapidity dependence are small and do not affect any of the conclusions. The area of each jet is computed using the Fastjet implementation of areas. We use the jet area from the full event which includes the effect of pileup.

Charged hadron subtraction: Our implementation of charged hadron subtraction proceeds as follows. First all four-vectors that come from charged pileup are subtracted from the jet. Next, we compute [formula] for the event, using the same method and parameters as above, but only including neutral particles. Finally [formula] is subtracted from the jet, with charged pileup already removed, where Aμ is the area found from the full event.