=1

Radar shadow detection in SAR images using DEM and projections

O. Haddad

Introduction

Synthetic aperture radar (SAR) contains a large amount of information that offers excellent performance compared to other satellite imaging systems. Despite the advantages SAR images have shortcomings such as relief effect due to the use of imaging radar which illuminates the ground from oblique views [\cite=Raney]. Thus, the image produced by such radars contain spatial distortions related to geometric characteristics which are in inherent in the formed acquisition geometry [\cite=Raney] [\cite=Mikhail]. Some of these geometric distortions can be reversed, for example in the case of "foreshortening" [\cite=Raney], if the terrain model is available a priori, it can be removed using the geocoding process.

There have been efforts to recover or identify shadows in real and very high resolution images [\cite=TongLinHRshadows13] [\cite=AdelineVHRshadow13], and for shape from shadow [\cite=AbramsSfShadow13], moving cast shadows [\cite=SaninShadowSurveyPR12], determining building heights [\cite=ComberHRshadow12] applications. Unfortunately, in the case of shadows present in a SAR such remedies are not possible due to irreversible lose of information. In fact, the radar will not be able to recover hidden areas which are result of lack of information concerning those particular spatial regions. Shadow regions in SAR imagery are unique in the sense that they can be characterized by the absence of distortion as well as the absence of typical speckle noise which affects other parts of the images. Nevertheless, a dark shadow area present in a SAR image can either depict a smooth region corresponding to flat or bare soil or water surfaces. This induces a confusion in inferring these regions [\cite=Jahangir] [\cite=Papson]. Moreover, typically the differences between these areas are huge with same radar image representation. To detect shadows in SAR images, previous works rely on the characteristic of shadow areas such as the absence of speckles [\cite=Mikhail] or distortion free areas. These were complicated and time consuming procedures since detecting all the areas not affected by at least one such distortion type and to locate areas which necessarily contain shadows can be cumbersome. Hence, we require a method which can detect shadows with little computational overhead and takes into consideration the complicated nature of SAR image acquisition process.

In this letter we propose a simple approach based on 1-D geometrical projections using the digital elevation model (DEM) corresponding to the geo-referenced SAR image. We first rotate and fit the DEM to the radar geometry so that each row would be in the line of sight of the radar. Then the shadow extraction is done row by row according the image size, thus simplifying the process to 1-dimensional space. The proposed approach can provide better target classification and a precise height estimation by using only the shadow information in high resolution SAR images.

The rest of the paper is presented as follows. In Section [\ref=sec:shadow] we start with the characteristics of SAR imagery and then we illustrate our methodology for shadow detection. Experimental results are given next in Section [\ref=sec:exper]. Finally, Section [\ref=sec:concl] concludes the paper. A preliminary version appeared in [\cite=Haddad].

Shadow characterization and detection in SAR images

Detecting radar shadows includes different characterizations and several different definitions give rise to different detection methods [\cite=Mikhail]. Here we provide factors which affect the shading are introduced and a modeling mechanism is introduced. The incidence angle (Figure [\ref=fig:angle]) is defined as the angular shift from the vertical position of the sensor viewing in the direction of the target. It is an important parameter which manages the shape of the shadow. For a fixed distance from the nadir, the shadow is an increasing function of the incidence angle. If we increase the sensor height with respect to a given target then the shadow regions shrinks [\cite=Hansen] [\cite=Zhang]. However, the resolution of the target gets reduced as we move away from the target. On the other hand for a fixed altitude of the sensor, there are other parameters which can affect the amount shadow regions, for example the target altitude can influence the shadow regions. If the slope of the overall terrain is higher than the depressing angle, then the shaded areas return very weak responses to the sensor. Moreover, the regions with high relief are due to low depression angle and is a source of large shadows present. Thus, we see that the loss of information due to shadows is a decreasing function of the depression angle. Radar shadows produce a 3D visualization effect without using a stereoscope, but the information provided by the shadow effect on the altitude is not reliable. Note that a radar image superimposed with shadows is not show significant elevations close to nadir. Moreover, the shadows closer to nadir are not detected at all.

Based on the above observations and the fact that SAR recovers a given scene line by line we propose the following steps for effective identification of shadow regions.

The given SAR image is first geo-referenced. For this purpose, we utilize the BEAM (Basic ENVISAT Toolbox for (A)ATSR and MERIS) software distributed by the European Space Agency (ESA) for SAR image geo-referencing as we tested the developed approach on ASAR ENVISAT data primarily.

For each radar line of sight with respect to the antenna height we generate an incidence angle image which is obtained by row by row consideration.

The DEM is rotated so that each row would match with that of the radar line of sight (slant range). For validation we use a 30m resolution ASTER DEM downloaded from the USGS (United States Geological Survey) website, see Figure [\ref=fig:usgs] for example.

The shadow mask is generated from the rotated DEM using the 1D geometrical projections applied to each row of the DEM. That is, if we let H be the sensor height, t the number of pixels, then the projection line is given by,

[formula]

where a(x) represents the slope value computed at each pixel x in the line of sight, see Figure [\ref=fig:angle]. Note that H is the tunable parameter indicating the height where the antenna is present. Then, a superposition of the DEM and the shadow mask is done, see Figure [\ref=fig:flow] the blue color regions.

Thus, the methodology we proposed composed of two major parts. First, the shadow detection on the DEM profile is done in a row by row fashion. Second the DEM and shadow mask are merged together to obtain the result. Figure [\ref=fig:flow] summarizes the proposed approach. The flowchart given in Figure [\ref=fig:flow] explains all the five steps previously mentioned steps starting with a given SAR image with corresponding DEM. We note that in our study the data elevation model is presented in a grayscale image from zero meter (Black) to 250m (White), also the Incidence Angle is presented in a grayscale image from 30[formula] (Black) to 36[formula] (White).

Experimental results

To test the robustness of the proposed shadow detection approach we perform some simulated profiles corresponding to different 1D signals using sinusoidal, logarithmic and Gaussian functions. The final detection results shown in Figure [\ref=fig:synth](a), clearly indicate the shadow regions detected as it consist of finding the intersection of the radar line with the elevated profile from the DEM. Here the shadow regions are indicated as 1D square signal (a shadow mask [\cite=Rees], in black color) where the zero (flat) values indicate the absence of shadows and non-zero (bumps) values indicate detected shadow intervals. We next use multiple 2D Gaussian functions to simulate different relief levels in an image. To reiterate our approach, we consider the following steps:

Divide the initial model line by line.

Shadow detection for each line of sight using projections along the lines.

Superposition of the shadow mask on the Gaussian DEM.

Figure [\ref=fig:synth] (b-d) show synthetic 2D Gaussian functions simulating various scenarios and corresponding shadow regions detected by our approach are provided in 2D image regions (blue, Figure [\ref=fig:synth] (e-h)), and in surface visualisation (Figure [\ref=fig:synth] (g)) . It is clear that we do not detect shadows near the nadir. Nevertheless, the detected shadow region's shape provides a confirmation of variations in the relief. Figure [\ref=fig:demo] show two real examples for the shadow detection algorithm with respect to different DEMs (Figure [\ref=fig:demo] (a)) of smaller dimensions and corresponding results with the same radar height 16 ~ km in (Figure [\ref=fig:demo] (c-d)). This illustrates the robustness of the 1D projections (Figure [\ref=fig:demo] (b)) based scheme.

Next in Figure [\ref=fig:real] we consider SAR images and their corresponding DEMs to test our algorithm further. Figure [\ref=fig:real] (a)&(d) show two different DEM regions with different characteristics. The final shadow detection results for different radar heights are given in Figure [\ref=fig:real] (b-c)& (e-f) respectively. As can be seen the scheme provides reliable shadow estimation across the variation in reliefs.

Further visualization of the detected shadow regions and corresponding DEMs are available online where MATLAB figure files showing 3D maps visualisations and data files (.fig, .mat) are provided as well . We believe that the approach presented here can augment colored remote sensed data based approach [\cite=Liu] for the recognition of backscattering objects on SAR images via their shadows.

Conclusion

In radar imaging the shadows can give additional information which can be used for target recognition. For example, the target height can be obtained by the geometry of observation system and the length of shadow, assuming either level or known ground [\cite=Liu] [\cite=Soergel]. In this paper a simple solution is given to identify the shadow regions using DEM and 1D projections. Experimental results with synthetic and real DEMs indicate the robustness of our approach in obtaining shadow regions.