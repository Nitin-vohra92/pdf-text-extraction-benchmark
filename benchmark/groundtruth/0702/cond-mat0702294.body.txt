Vertex Corrections in Localized and Extended Systems

Introduction

Many-body perturbation theory (MBPT) is a leading method for computing excited-state electronic properties in solid-state physics [\cite=Aulbur2000] [\cite=Aryasetiawan1997] [\cite=H+L1969]. Within many-body perturbation theory, Hedin's GW method [\cite=Hedin1965] is the most widely used approximation for the self-energy, Σ. The exact one-body Green's function, G (which contains information about ground and excited-state properties of the system) can be written, using a Dyson equation, in terms of a suitable Green's function of a "zeroth-order" system of non-interacting electrons, G0 (constructed from that system's one-particle wavefunctions and energies), and the self-energy operator Σ. The approximation is defined by the choice of zeroth-order system and by the expression (typically a diagrammatic expansion in terms of G0) used to approximate Σ. The self energy, Σ, contains all the information of many-body interactions in the system and can be obtained by using Hedin's set of coupled equations:

[formula]

[formula]

[formula]

[formula]

and the Dyson equation, where P is the polarizability, W the screened and v the unscreened Coulomb interaction and Γ the vertex function.The notation [formula] is used to denote space, spin and time variables and the integral sign stands for summation or integration of all of these where appropriate. (1+ denotes t1  +  η where η is a positive infinitesimal in the time argument). Atomic units are used in all equations throughout this paper. These are four coupled integro-differential equations where the most complicated term is the vertex, Γ, which contains a functional derivative and hence, in general, cannot be evaluated numerically. The vertex is the usual target of simplification for an approximate scheme.

The widely used GW approximation is derived with the Hartree method as a starting point, and hence has a rigorous foundation only when started from a non-interacting Green's function, G0, made from eigenstates of the Hartree Hamiltonian. This is because the initial self-energy, Σ0  =  0 and the vertex function is correspondingly set to Γ(12;3) = δ(12)δ(13) since δΣ(12)  /  δG(45) = 0.

Solving Hedin's equations with the vertex fixed in this expression yields the so-called self-consistent GW approximation. In this approach, the self-energy operator is formed from a product of a Green's function and a screened Coulomb interaction, where the Green's function used is consistent with that returned by Dyson's equation. Since the self-energy depends on G, this procedure should be carried out self-consistently, beginning with G = G0.

In practice, it is customary to use the first iteration only, often called [formula], to approximate the self-energy operator. Here, [formula] is perhaps the simplest possible screened interaction, which involves an infinite geometric series over non-interacting electron-hole pair excitations as in the usual definition of the RPA. It is important to make this one iteration as accurate as possible, so an initial G0 calculated using Kohn-Sham density-functional theory in the local-density approximation (DFT-LDA) is normally used. This choice of G0 generally produces much more accurate results for quasiparticle energies (the correct electron addition and removal energies, in contrast to the DFT-LDA eigenvalues[\cite=Godby1986]). However, because this choice of G0 corresponds to a non-zero Σ0, there is no longer a theoretical justification for the usual practise of setting the vertex to a product of delta functions and different choices for the exchange-correlation functional may lead to different Green's functions [\cite=Rinke_et_al] [\cite=WillsPaper].

Using the static exchange-correlation kernel, [formula], (which is the functional derivative of the DFT exchange-correlation potential, [formula], with respect to density, n) Del Sole et al. [\cite=DelSole] demonstrated how [formula] may be modified with a vertex function to make Σ consistent with the DFT-LDA starting point. They added the contribution of the vertex into both the self-energy, Σ, and the polarization, P. The result is a self-energy of the form [formula] [\cite=Notation]. The [formula] approximation is obtained when the vertex function is included in P only. As commented by Hybertsen and Louie[\cite=Hybertsen1986] and Del Sole et al. , both these results take the form of GW, but with W representing the Coulomb interaction screened by respectively the test-charge-electron dielectric function and the test-charge-test-charge dielectric function, in each with electronic exchange and correlation included through the time-dependent adiabatic LDA (TDLDA).

Del Sole et al. found that [formula] yields final results almost equal to those of [formula] for the band gap of crystalline silicon and that the equivalent results from [formula] were worse when compared to [formula]. It should perhaps be mentioned that the inclusion of other types of vertex corrections have been studied before as well, most notably corrections based on various approximations of a second iteration of Hedins equations, starting with [formula][\cite=Arno1998] [\cite=Bechstedt1997]. However, these have usually been applied with initial Kohn-Sham (KS) Green's functions, which are still not theoretically consistent with that starting point. The correct theoretical treatment of a second-iteration vertex from KS Green's functions is quite complicated and still absent in the literature.

The purpose of the present work is to make a systematic study, for both localized and extended systems, of a simple ab initio vertex correction whose form is determined by the starting approximation for the self-energy ([formula] for DFT-LDA). Related vertex corrections, including others derived from [formula], have been investigated in earlier work. For example, Northrup et al. [\cite=Northrup1987] used LDA bulk calculations as a starting point and a plasmon-pole calculation of the response function in conjunction with a [formula]-like vertex correction in the screened interaction. They found a narrowing of the band widths of Na, Li and K[\cite=Surh1988] in agreement with the experiments of Jensen and Plummer[\cite=Jensen1985] who had noted that the experimental band width was significantly narrowed ([formula]) compared to the free-electron result. Hedin's [formula] [\cite=Hedin1965] calculations only gave a narrowing of about 10  % for an homogeneous electron gas of the same mean density, indicating a large impact of further many-body effects. This led to additional experimental and theoretical investigations[\cite=Zhu1986] [\cite=Shung1987] [\cite=Lyo1988] [\cite=Itchkawitz1990] [\cite=Yasuhara1991] [\cite=Frota1992] but the issue remains controversial [\cite=Yasuhara1999] [\cite=Takada2001] [\cite=Ku2000] [\cite=Yasuhara2000].

For individual atoms, GW quasiparticle properties have been investigated previously by Shirley and Martin[\cite=Shirley1993] (including an exchange-only vertex) and, more recently, total energy studies on atoms and molecules using the variational functionals of Luttinger and Ward[\cite=Luttinger1960] have been performed by Dahlen et al. [\cite=Dahlen2004] [\cite=Dahlen2006], Stan et al. [\cite=Stan2006] and Verdonck et al. [\cite=Verdonck2006]. These studies have shown that [formula] in general gives quasiparticle properties which are much improved over DFT and Hartree-Fock methods and that, when calculated self-consistently, GW also provides reasonably good total energies for atoms (with differences versus highly accurate reference methods being on the order of tens of mHa per electron). To its merit, self-consistent GW is also a conserving approximation in the Baym-Kadanoff[\cite=Baym1961] sense. However, non-self consistent total energies in [formula] are noticeably less accurate. Conversely, the good agreement between the quasiparticle energies and experiment is destroyed when performing self-consistent calculations.

The answer to why this happens must, by definition, lie with the only approximated quantity, the vertex correction. This study is meant to address the need for a precise (including a full treatment in frequency) comparative study of the vertex corrections proposed by Del Sole et al. for localized and extended systems within G0W0.

Method

Hybertsen and Louie[\cite=Hybertsen1986] comment that it is possible to start a GW calculation from an initial self-energy, [formula]. This approach gives a theoretical basis for beginning a G0W0 calculation from DFT-LDA orbitals. Adopting this idea, we see from Eq. ([\ref=Hedin_IV]) that the second term is now non-zero, unlike in the GW approximation. Since the electron density is n(1) =   -  iG(11+) then,

[formula]

where delta-functions are to be understood in all other variables. In an appendix Del Sole et al. [\cite=DelSole] show how to add this approximate vertex to both W and Σ, and into W only, by forming two different effective Ws. Our method follows that of Del Sole et al. [\cite=DelSole] by modifying the dielectric function, ε from its form in the RPA. The screened Coulomb interaction in MBPT is written as

[formula]

where ε- 1 is the inverse dielectric function. We use the full polarization without recourse to plasmon-pole models. The random phase approximation (RPA) dielectric function is

[formula]

Del Sole et al. show that adding the form of the vertex from Eq. ([\ref=Vertex]) into both Σ and W modifies the RPA dielectric function to,

[formula]

which leads to the introduction of an effective screened Coulomb interaction W̃. This is trivial to implement into a GW computer code as it requires a simple matrix addition, once [formula] is calculated. The result of this modification is that W̃ contains not only the screened Coulomb interaction but also an exchange-correlation potential. We shall refer to this method as [formula] as we have added the correct DFT-LDA vertex to the GW method, hence the method is a one-iteration GWΓ (G0W0Γ0) calculation beginning with a DFT-LDA Green's function.

An alternative choice for the effective dielectric function,

[formula]

corresponds to adding [formula] into W only. We term this method [formula] as the LDA vertex is inserted into the screened Coulomb interaction, W, only. This is equivalent to the one-iteration GW approximation, G0W0 but with W calculated using the adiabatic LDA.

The vertices presented are thus dynamical, i.e. frequency dependent, due to the inclusion of χ0, and must include the excitonic effects of the corresponding jellium due to the appearance of [formula]. Another way of looking at it is that this corresponds to a treatment beyond G0W0 where at the level of the vertex corrections, the system is modelled by the homogenous electron gas. It is not likely, however, that these methods would be able to capture any satellite structure beyond that provided by [formula] as the calculations are non-self-consistent.

Computational Approach

The quasiparticle energies, εi and wavefunctions, ψi, are formally the solution of the quasiparticle equation,

[formula]

where Vext and VH are the external and Hartree potential, respectively.

In the case of a spherically symmetric system it is sufficient to describe all non-local operators in the GW formalism by two radial coordinates and one angular coordinate, θ, that denotes the angle between the vectors [formula] and [formula]. The self-energy, Σ, then assumes the much simpler form,

[formula]

where Pl( cos θ) is a Legendre polynomial of order l.

The Legendre expansion coefficients of the self-energy, Σ, are calculated directly, thereby circumventing the need for a numerical treatment of the angular dependence. We use a real-space and imaginary time representation[\cite=Rojas/Godby/Needs:1995] to calculate the self-energy from the non-interacting Green's function G0. The self-energy on the real frequency axis, required for solving the quasiparticle equation, is obtained by means of analytic continuation[\cite=Rojas/Godby/Needs:1995]. The current implementation has been successfully applied to jellium clusters[\cite=ClusterImStates:2004] and light atoms[\cite=Delaney/Garcia-Gonzalez/Rubio/Rinke/Godby:2004] [\cite=WillsPaper].

To obtain the quasiparticle energies and wavefunctions the quasiparticle equation ([\ref=qpe:generic]) is fully diagonalized in the basis of the single particle orbitals of the non-interacting Kohn-Sham system. For localized systems the quasiparticle wavefunctions can differ noticeably from the wavefunctions of the non-interacting system or in certain cases even have a completely different character, as was demonstrated for image states in small metal clusters [\cite=ClusterImStates:2004].

Ground-state total energies were calculated using the Galitskii-Migdal formula[\cite=Holm2000] transformed to an integral equation over imaginary frequency. This avoids analytic continuation of the self-energy, which would be unreliable for large frequencies.

For jellium, the homogenous electron gas, we solve Hedin's equations in wavevector and real-frequency space. This avoids analytic continuation and enables accurate and easy extraction of spectral properties. Again, we do not use plasmon-pole models, but the full frequency-dependent polarization.

Total Energies

The MBPT total energy results are compared against configuration interaction (CI) and quantum Monte Carlo methods (variational Monte Carlo (VMC) and diffusion Monte Carlo (DMC)). The CI and QMC family of methods usually yield the most accurate estimates of ground-state energies and are variationally bound, meaning that the lowest energy is the most accurate.

The G0W0 result with G0 constructed from DFT-LDA eigenstates, ([formula]) is in poor agreement with CI in all three cases. It is known that there is a large self-interaction error in the LDA, especially noticeable in smaller atoms. Hartree-Fock, which is self-interaction free by construction, is more accurate than DFT-LDA. Hence the self-interaction error is introduced via the LDA orbitals into the Green's function, [formula], which gives rise to the [formula] total energy's consistent poor agreement with CI. (By way of illustration, using a G0 from the superior KLI[\cite=KLI], an optimized effective potential that is formally free of self-interaction error for a two-electron system, greatly improves the DFT and GW total energies. The [formula] results for He, Be and Ne are - 1.4550(3), - 3.6780(2) and - 12.843(1) respectively.)

For all three atoms the vertex in W alone ([formula]) shows little difference to [formula] (Table [\ref=Tab:TEAtoms] and Fig. [\ref=Fig:AtomsTE]), whereas [formula] raises the total energy with respect to [formula]. This change is due not to the LDA self-interaction but to the nature of the vertex. The result of adding the LDA vertex to [formula] mirrors that of adding it to [formula]. There is an increase of the total energy when the vertex is applied in both W and Σ ([formula]) but the vertex in W only, ([formula]), results in a similar total energy to [formula]. (The [formula] and [formula] for He are - 1.4235(10) and - 1.4475(5) respectively.)

In jellium the trend is the same for all densities in the region from [formula] to 5 ([formula] is the density parameter, where [formula] and n is the electron density in atomic units) as can be seen in Table [\ref=Table:JelliumTE]. [formula] lowers the total energy of jellium slightly as compared to [formula] and [formula] makes the energy too high. [formula] is on average [formula] lower than the QMC result. [formula] is [formula] too high and [formula] [formula] lower than the QMC result.

For jellium, neither method leads to a result more accurate than [formula]. It is apparent, however, that the vertex added solely in the polarization has the minor effect of lowering the total energy. When the vertex is subsequently added into the self-energy there is a major positive shift in the total energy as seen in the atomic results as well. Self-consistent GW calculations[\cite=GarciaGonzales2001] [\cite=Holm1998] for jellium show that the self-consistent total energy is about 4 - 5% higher than the [formula] ones in the range of [formula] to 5 and the essentially exact QMC energies are about 0.5 - 1% lower than the self-consistent GW values. Assuming to a first approximation that the vertex corrections are independent and additive corrections to self-consistency, this would indicate that the [formula] energies would still be much too high, but the [formula] energies might end up very close to the QMC results if self consistency is achieved, since they lower the [formula] energies to roughly the same extent as the difference between QMC and self-consistent GW energies.

Quasiparticle Energies

The quasiparticle energy corresponding to the first ionization energy is presented for helium, beryllium and neon in Fig. [\ref=Fig:AtomsFIE]. The MBPT methods are consistently more accurate than DFT-LDA Kohn-Sham eigenvalues. However, again [formula] is roughly equivalent to [formula] for helium and beryllium and in all cases [formula] causes an increase in quasiparticle energy, in agreement with Del Sole et al. [\cite=DelSole]. In general, [formula] worsens QP energies as compared to [formula].

For jellium, different quantities are accessible at different stages of the iteration of Hedin's equations. The pair-correlation function g(r) for example, can be obtained from the (isotropic) inverse dielectric function, ε- 1(k,ω), by the integration

[formula]

where the static structure factor,

[formula]

g(r) is shown in Fig. [\ref=Fig:JelliumPCF] for [formula]. The RPA displays the well known failure to be positive definite for [formula]. This is remedied by the local vertex, but the result appears to be an overcorrection (note that [formula] and [formula] are equivalent at this stage since Σ has not yet been calculated).

The tendency of [formula] to overshoot - the reason for which, we will defer to the closing discussions - is apparent in all subsequent results. Once Σ has been calculated, the QP dispersion can be extracted. Presented in Fig. [\ref=Fig:JelliumQPD] is the real part of the self-energy evaluated at the self-consistent eigenvalues, i.e. the correction [formula] to the quasiparticle dispersion as found by the formula

[formula]

where [formula] is the non-interacting dispersion. Care has been taken to align the Fermi energy of non-interacting and interacting systems so that the Dyson equation is consistent[\cite=Holm2000] and all quantities are calculated in real frequency. The self-consistent quasiparticle energy should be used when one has a self-consistent Σ, but for a G0W0 calculation there is still controversy about whether the self-consistent eigenvalues [formula] or the zeroth-order eigenvalues [formula] are best used as the argument of [formula] in equation ([\ref=qp_eigenvals])[\cite=Aulbur2000] [\cite=PrivateCom]. The self-consistent approach was chosen in this paper.

The difference between the quasiparticle energies at k = kF and k = 0 is known as the band width, which therefore takes the form of the free-electron value (k2F / 2) corrected by the change in Fig. [\ref=Fig:JelliumQPD] between k = kF and k = 0. This band width is shown in Table [\ref=Table:JelliumBandwidth] and Fig. [\ref=Fig:JelliumBandwidth]. It consistently seems that vertex corrections applied in the screened Coulomb interaction only give the best results. This is corroborated by the fact that this quasiparticle dispersion has a better band width and that the [formula] introduces little change to the band width. These results are in agreement with those of Mahan and Sernelius[\cite=MahanAndS] obtained for a model Hubbard vertex.

The chemical potential of jellium

To get another indication of whether the large absolute positive shift of the quasiparticle dispersion is physical, we compare with experimental work functions of Al (1 0 0), (1 1 0) and (1 1 1) surfaces (see Table [\ref=Table:JelliumWkFn]). We assume that the electron density of the surface region, and therefore the electrostatic surface-dipole energy barrier, are well described by LDA calculations including the crystal lattice. The work function, φ, will, however, be sensitive to the quasiparticle bulk Fermi level, which we use here as a discriminator between self-energy approximations in the bulk. Treating the bulk metal as jellium, we obtain a shift in the workfunction due to the new chemical potential,

[formula]

where Δμ is the correction due to the shift of the bulk Fermi energy for a GW jellium calculation. The LDA workfunction is defined as the shift between the vacuum potential, [formula], and the chemical potential from the LDA surface calculation, [formula]. Since the exact self-energy for jellium must fulfill the condition

[formula]

we see that the LDA (taken from highly accurate QMC calculations) corresponds to the exact result if one assumes that the bulk is accurately modelled by jellium. Comparing with Table [\ref=Table:JelliumWkFn] and Fig. [\ref=Fig:JelliumWkFn] we see that [formula] is closest to the exact result and [formula] is slightly further away, while [formula] is even worse.

This leads us to conclude that [formula] is unphysical in the sense that a vertex correction derived from a self-energy approximation with a completely local dependence on the density (like the LDA) will have pathological features. This is most probably due to improper behaviour of the spectral function of the screened interaction, as is demonstrated in the final section of this paper.

Discussion and Conclusions

We have presented [formula] and [formula] calculations for isolated atoms and jellium. We see that [formula] worsens results in all cases compared to the common [formula] approximation.

A proper ab initio vertex correction for calculations on an arbitrary system should be derived from the starting approximation for the self-energy. In this work we have shown that in practice, vertex corrections derived from a local density approximation to the self-energy (like the LDA) are pathological when applied to both the self-energy and the screened interaction. The work function of aluminium was used to confirm that the value of the chemical potential in [formula] is far from the correct result.

An indication of why a local correction in both W and Σ performs so poorly has been discussed previously by Hindgren and Almbladh[\cite=Hindgren1997] and investigated in excitonic effects on wide-bandgap semiconductors by Marini et al. [\cite=Marini1] [\cite=Marini2]. Both types of vertex corrections lead to a modified screened interaction W̃  =  ε̃- 1v. The spectral function of this, which is required to be positive semidefinite for [formula] and negative semidefinite otherwise, is given by

[formula]

so it inherits whatever properties of definiteness the imaginary part of the dielectric function has. Now for [formula] this is given by,

[formula]

Since the RPA response function, χ0, will have the correct analytical properties by construction, this expression will obviously change sign whenever Kxc - which is strictly negative for all densities and a negative constant for jellium - is larger in magnitude than [formula], which decays as 1 / q2. This will thus lead to a spectral function with the wrong sign, which is entirely unphysical. For jellium, isolated atoms, or any sparse enough condensed state, this is guaranteed to happen, because Kxc  →    -    ∞   for low densities. Inspection of the dielectric function in [formula],

[formula]

illustrates that it cannot suffer from the same pathology. Since Eq. ([\ref=GWL_Im_diel]) ensures that the static structure factor has the correct behavior for both [formula] and [formula], no conclusions can be drawn on the reason for the overly positive value of the pair-correlation function of jellium when [formula], except that it must depend on the high k behavior of the denominator. We note that none of the calculations have been carried out self-consistently; it is possible that the vertices presented here go some way to improve self-consistent GW results.

One possibility of the failure of the LDA starting point with the inclusion of the theoretically consistent vertex is the self-interaction error the LDA orbitals carry with them. Any starting point with an inherent self-interaction error should lead to correcting terms in the diagrammatic expansion. It is possible that the first-order correction, like [formula], is not enough and higher order corrections must be applied. A vertex derived from a second iteration of Hedin's equations does indeed lead to further and more complicated diagrams than the equivalent vertex from a Hartree starting point. Unfortunately these diagrams are of prohibitive complexity for practical calculations.

It is still not understood why a correction in W only (in a TDDFT-like manner) seems to work as well as it does. There is a similarity here with the way that the Bethe-Salpeter equation (BSE) is usually applied for the calculation of optical spectra. There too it is well known that, in theory, inclusion of a screened interaction in electron-hole excitations should be accompanied by an inclusion of the double-exchange term in Σ but this has been proven to worsen results. Recently, Tiago and Chelikowsky[\cite=Tiago2006] have used a [formula] vertex in conjunction with an efficient numerical implementation of the BSE for isolated molecules and have shown that the inclusion of a TDLDA vertex gives very good results over a wide range of structural configurations in excited states.

For atomic helium and beryllium [formula] is very similar to the [formula] result but slightly worse in neon. While in jellium the band width is improved. Hence [formula] may be a local and easily implementable way to improve quasiparticle results in extended systems.

Overall, vertices based on the local density clearly have their limitations, arriving in part from the wavevector independent character of [formula]. It should be fruitful to explore vertices that incorporate non-local density-dependence and reflect the non-local character of the original self-energy operator.