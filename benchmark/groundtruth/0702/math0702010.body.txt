cmr10 scaled cmbx10 scaled

Factorials as sums

Roberto Anglani Dipartimento Interateneo di Fisica "Michelangelo Merlin", Università degli Studi di Bari, Via Amendola 173, 70126 Bari, Italy roberto.anglani@ba.infn.it Margherita Barile Dipartimento di Matematica, Università degli Studi di Bari, Via E. Orabona 4, 70125 Bari, Italy barile@dm.uniba.it

Introduction

In this paper we give an additive representation of the factorial, which can be proven by a simple quick analytical argument. We also present some generalizations, which are linked, on the one hand to an arithmetical theorem proven by Euler (decomposition of primes as the sum of two squares), and, on the other hand, to modern combinatorics (Stirling numbers).

From calculus to combinatorics

For every positive integer n,

[formula]

Proof . For all [formula] we have the following first order Taylor expansion with Lagrange remainder of the exponential function about 0:

[formula]

where [formula]. We deduce that, for all [formula],

[formula]

for some [formula]. The L.H.S. of ([\ref=0]) is

[formula]

Its n-th derivative is

[formula]

whose value at 0 is

[formula]

This is equal to the value of the n-th derivative of the R.H.S. of ([\ref=0]) at 0, which is n!. This completes the proof. Proposition [\ref=p1] admits an alternative combinatorial proof. Fix an alphabet of n letters. The number n! counts the ways of forming a word of length n using all n letters (i.e., a word having n different letters), whereas nn is the total number of words of length n (i.e., of all words, including the possibility of repeated letters). Hence nn - n! is the number of words of length n containing at least one repeated letter. Thus we can restate Proposition [\ref=p1] in the following equivalent form:

The number of words of length n containing at least one repeated letter from an alphabet of n letters is

[formula]

Proof . Recall that, for all [formula], in is the number of words of length n which can be formed from a subset of i letters; [formula] is the number of ways of choosing i letters from our alphabet. Hence the product [formula] counts the words of length n containing at most i different letters, but each word is counted more than once. Precisely, in the sum ([\ref=3]), for every integer k, 1  ≤  k  ≤  n - 1, each word containing exactly k letters is counted one time for each i-subset containing these k letters. The number of these subsets is equal to the number of ways in which we can pick i - k letters from the remaining n - k letters of the alphabet, i.e., it is equal to [formula]. Therefore, in ([\ref=3]), each word with exactly k letters is counted [formula] times in total. Hence the claim is proven once we have shown that

[formula]

Setting j = i - k and making a change of indices, the L.H.S. of ([\ref=4b]) becomes

[formula]

as was to be shown.

We also have the following different version of Proposition [\ref=p1]:

For every positive integer n,

[formula]

Proof . By Proposition [\ref=p1] we have

[formula]

By comparing the first and the last expression in the above sequence of equalities, it follows that

[formula]

In view of Proposition [\ref=p1] this proves the claim.

Euler's approach

In the preceding section, Proposition [\ref=p2] was obtained from Proposition 1 by replacing in with (i + 1)n. We are going to show that, more generally, for every positive integer n, the identity

[formula]

holds for all nonnegative integers k. This will be a consequence of Proposition [\ref=p5] below. Identity ([\ref=4]) was proven by Euler [\cite=E1] in a purely arithmetical context. In this section we essentially follow his line of thoughts.

Given a sequence (ak)k  ≥  0 of real numbers, its first difference is defined as the sequence whose k-th term is

[formula]

Recursively, for every integer n > 1, the n-th difference is defined as the first difference of (Δn - 1ak)k  ≥  0.

For every positive integer n and all nonnegative integers k,

[formula]

Proof . Let k be a nonnegative integer. We prove the claim for k by induction on n. The claim is obviously true for n = 1. Now let n  ≥  2 and suppose the claim true for n - 1. We prove it for n and k. We have

[formula]

as was to be shown. Now suppose that for all k,

[formula]

where P(x) is a polynomial of degree n. Let

[formula]

Then, for all k,

[formula]

Note that

[formula]

is a polynomial of degree n - 1, its term of highest degree being nαxn - 1. By finite descending induction it follows that Δnak is a polynomial of degree 0, i.e., a constant polynomial. We have just established

The n-th difference of a polynomial sequence of degree n is a constant sequence.

For all positive integers n, let nΔnk denote the k-th term of the n-th difference of the sequence [formula]. According to Proposition [\ref=p3], for all nonnegative integers k we have

[formula]

Euler proved

Let n be a positive integer. Then for all nonnegative integers k,

[formula]

Proof . By virtue of Proposition [\ref=p4], the sequence [formula] is constant. Hence, for all positive integers n and k,

[formula]

where the last two equalities follow by ([\ref=5]) and Proposition [\ref=p1] respectively. This completes the proof. From ([\ref=5]) and Proposition [\ref=p5] we deduce the property that we announced at the beginning of this section. In fact we have the following generalization of Propositions [\ref=p1] and [\ref=p2]:

Let n be a positive integer. Then for all nonnegative integers k,

[formula]

Next we show how Euler applied Proposition [\ref=p5] to prove a famous statement going back to Pierre de Fermat:

Every positive prime p = 4n + 1, where n is a positive integer, is the sum of two squares.

Proof . The numbers k2n, where k is a positive integer, are not all congruent modulo p. Otherwise the terms of the first difference of the sequence [formula] would all be divisible by p, and the same would be true for the differences of higher order. But this is impossible: by Proposition [\ref=p5], for all k,

[formula]

and p = 4n + 1 does not divide any of the factors of (2n)!, since these are all smaller than p. Hence there are two positive integers k and h such that

[formula]

Evidently we may assume that 1  ≤  h < k < p. Then p does not divide h and k. Consequently, by Fermat's Little Theorem, [formula], so that

[formula]

Therefore, taking ([\ref=divide]) into account,

[formula]

According to a former result by Euler (see Propositio 4 in [\cite=E2]), if a number is the sum of two squares, then the same is true for all its prime divisors that do not divide the two squares. Hence p is the sum of two squares.

Stirling numbers

Corollary [\ref=coro] is an arithmetical generalization of Proposition [\ref=p1]. We now give another generalization that is relevant from a combinatorial point of view: it consists in replacing the exponent n with an arbitrary nonnegative integer [formula]. Following the arguments used in the proof of Proposition [\ref=p1], we can conclude that

[formula]

is equal to the [formula]-th derivative of (ex - 1)n at 0. This is equal to [formula] times the coefficient [formula] of [formula] in the Taylor series expansion of (ex - 1)n at 0. Since

[formula]

for some [formula], we can compute [formula] as the coefficient of [formula] in the following polynomial:

[formula]

The term of least degree is xn. Therefore, [formula] if [formula]. Suppose that [formula]. Then the term of degree [formula] is the sum of all products

[formula]

that can be formed when applying the distributive law to ([\ref=power]). For every set [formula] there is one product ([\ref=products]) for each possible arrangement of the sequence [formula]. Call [formula] the number of these arrangements. Then it holds:

[formula]

We have thus proven the following:

[formula]

Note that [formula] can be interpreted as the number of ways in which a word of length [formula] can be subdivided into a sentence with n words of lengths i1, i2, ..., in. Hence [formula] is the number of sentences of length [formula] containing all [formula] letters of a given alphabet and formed by n words of lengths i1, i2, ..., in. If the words are replaced by subsets (i.e., the arrangement of letters in each word does not matter), the number of sentences reduces to

[formula]

If, in addition, we also assume that the arrangement of the n words does not matter, the number of sentences becomes

[formula]

This is the number of ways in which [formula] distinguishable elements can be distributed into n non distinguishable subsets with i1, i2, [formula], in elements respectively. According to Proposition [\ref=stirling] we have, for all [formula]:

[formula]

and this number is equal to the total number of ways in which [formula] elements can be distributed into n non empty subsets. It is well-known in combinatorics.

More details on Stirling numbers can be found in [\cite=LW], Chapter 3, or in [\cite=E].

[formula]

Negative exponents

We finally present some identities which extend those of the preceding sections when the exponent is [formula]. The proofs that are based on easy induction arguments will be omitted. The first result is related to Proposition [\ref=stirling].

For all positive integers n

[formula]

The term on the R.H.S. of the claim is, up to the sign, the sum of the first n terms of the well-known harmonic series. Next we replace [formula] with [formula]. We shall obtain, as in Proposition [\ref=p1] and in Corollary [\ref=coro], an expression involving factorials.

For all positive integers n,k it holds

[formula]

Proof . We prove that the claim is true for all positive integers n when k = 1. Once again we use calculus. We consider the real function f defined, for all [formula], by

[formula]

The indefinite integral of f is

[formula]

and the function F defined by

[formula]

is an antiderivative of f(x). By comparing the constant terms of Fc(x) and F(x), we find that

[formula]

Now

[formula]

which yields the claim for k = 1, namely

[formula]

The proof of the claim for any given [formula] is an easy induction on [formula].