40pt 10pt

Cycles in dense digraphs

Paul Seymour

Blair Sullivan

Princeton University, Princeton NJ 08544

when V(G) is the union of two cliques,

when the vertices of G can be arranged in a circle such that if distinct u,v,w are in clockwise order and uw is a (directed) edge, then so are both uv,vw.

Introduction

We begin with some terminology. All digraphs in this paper are finite and have no parallel edges; and for a digraph G, V(G) and E(G) denote its vertex- and edge-sets. The members of E(G) are ordered pairs of vertices, and we abbreviate (u,v) by uv. For integer k  ≥  0, let us say a digraph G is k-free if there is no directed cycle of G with length at most k. A digraph is acyclic if it has no directed cycle.

We are concerned here with 3-free digraphs. It is easy to see that every 3-free tournament is acyclic, and one might hope that every 3-free digraph that is "almost" a tournament is "almost" acyclic. That is the topic of this paper.

More exactly, for a digraph G, let γ(G) be the number of unordered pairs {u,v} of distinct vertices u,v that are nonadjacent in G (that is, both uv,vu∉E(G)). Thus, every 2-free digraph G can be obtained from a tournament by deleting γ(G) edges. Let β(G) denote the minimum cardinality of a set X  ⊆  E(G) such that [formula] is acyclic. We already observed that every 3-free digraph with γ(G)  =  0 satisfies β(G)  =  0, and our first result is an extension of this.

If G is a 3-free digraph then β(G)  ≤  γ(G).

Proof.   We proceed by induction on |V(G)|, and we may assume that [formula]. Let us say a 2-path is a triple (x,y,z) such that x,y,z∈V(G) are distinct, and xy,yz∈E(G), and x,z are nonadjacent. For each vertex v, let f(v) denote the number of 2-paths (x,y,z) with x  =  v, and let g(v) be the number of 2-paths (x,y,z) with y  =  v. Since [formula] and [formula], there exists v∈V(G) such that f(v)  ≤  g(v). Choose some such vertex v, and let A,B,C be the set of all vertices u  ≠  v such that vu∈E(G), uv∈E(G), and uv,vu∉E(G) respectively. Thus the four sets A,B,C,{v} are pairwise disjoint and have union V(G). Let G1,G2 be the subdigraphs of G induced on A and on [formula] respectively. Since g(v) is the number of pairs (a,b) with a∈A and b∈B such that a,b are nonadjacent, it follows that γ(G)  ≥  γ(G1) + γ(G2)  +  g(v). From the inductive hypothesis, β(G1)  ≤  γ(G1) and β(G2)  ≤  γ(G2); for i  =  1,2, choose Xi  ⊆  E(Gi) with |Xi|  ≤  β(Gi) such that [formula] is acyclic. Let X3 be the set of all edges ac∈E(G) with a∈A and c∈C; thus |X3|  =  f(v). Since there is no edge xy∈E(G) with x∈A and y∈B (because G is 3-free), it follows that every edge xy with x∈A and [formula] belongs to X3, and so [formula] is acyclic, where [formula]. Hence

[formula]

This proves [\ref=betathm].

Unfortunately, [\ref=betathm] does not seem to be sharp, and we believe that the following holds.

Conjecture. If G is a 3-free digraph then [formula].

If true, this is best possible for infinitely many values of γ(G). For instance, let G be the digraph with vertex set [formula], and with edge set as follows (reading subscripts modulo 4n):

vivj∈E(G) for all i,j,k with 1  ≤  k  ≤  4 and (k - 1)n < i < j  ≤  kn

vivj∈E(G) for all i,j,k with 1  ≤  k  ≤  4 and (k - 1)n < i  ≤  kn < j  ≤  (k + 1)n.

It is easy to see that this digraph G is 3-free, and satisfies β(G)  =  n2 (certainly β(G)  ≥  n2 since G has n2 directed cycles that are pairwise edge-disjoint), and γ(G)  =  2n2.

The reason for our interest in [\ref=mainconj] was originally its application to the Caccetta-Häggkvist conjecture [\cite=CH]. A special case of that conjecture asserts the following:

Conjecture. If G is a 3-free digraph with n vertices, then some vertex has outdegree less than n / 3.

This is a challenging open question and has received a great deal of attention. Any counterexample to [\ref=CHconj] satisfies [formula], so our conjecture [\ref=mainconj] would tell us that [formula], and this would perhaps be useful information towards solving [\ref=CHconj].

We have not been able to prove [\ref=mainconj] in general, and in this paper we prove two partial results, that [\ref=mainconj] holds for every 3-free digraph G such that either

V(G) is the union of two cliques, or

the vertices of G can be arranged in a circle such that if distinct u,v,w are in clockwise order and uw∈E(G), then uv,vw∈E(G).

The first result is proved in [\ref=twocliques], and the second in [\ref=circintthm]. Incidentally, Kostochka and Stiebitz [\cite=KS] proved that in any minimal counterexample to [\ref=mainconj], every vertex is nonadjacent to at least three other vertices, and the conjecture is true for all digraphs with at most 8 vertices.

A distant relative of the four functions theorem

In this section we prove a result that we apply in the next section. We begin with an elementary lemma. (+   denotes the set of nonnegative real numbers.)

If a1,a2,c1,c2,d1,d2∈  +   and a2k  ≤  ckdk for k  =  1,2, then (a1 + a2)2  ≤  (c1 + d1)(c2 + d2).

Proof.   If say c1  =  0, then since a21  ≤  c1d1, it follows that a1  =  0, and so

[formula]

as required. We may therefore assume that c1,c2 are nonzero. Now

[formula]

This proves [\ref=quad].

Before the main result of this section we must set up some notation. Let m,n  ≥  1 be integers, and let V denote the set of all pairs (i,j) of integers with 1  ≤  i  ≤  m and 1  ≤  j  ≤  n. If f:V  →    +  , and X  ⊆  V, we define f(X) to mean [formula]. For (i,j),(i',j')∈V, we say that (i',j') dominates (i,j) if i < i' and j < j'. Let a,b:V  →    +   be functions. We say that b dominates a if

a(V)  =  b(V)

for all X,Y  ⊆  V, if a(X)  +  b(Y) > a(V) then there exist x∈X and y∈Y such that y dominates x.

The main result of this section is the following. (It is reminiscent of the "four functions" theorem of Ahlswede and Daykin [\cite=AD], but we were not able to derive it from that theorem.)

Let m,n  ≥  1 be integers, let V be as above, and let a,b,c,d be functions from V to +  , satisfying the following:

a(i,j)b(i',j')  ≤  c(i',j)d(i,j') for 1  ≤  i < i'  ≤  m and 1  ≤  j < j'  ≤  n, and

b dominates a.

Then a(V)b(V)  ≤  c(V)d(V).

Proof.   We proceed by induction on m + n. Let Q be the set of all quadruples (a,b,c,d) of functions from V to +   that satisfy conditions 1 and 2 above. We say that (a,b,c,d)∈Q is good if

[formula]

Thus, we need to show that every member of Q is good. Certainly if m  =  1 or n  =  1 then condition 2 implies that a(V)  =  b(V)  =  0, and therefore (a,b,c,d) is good; so we may assume that m,n  ≥  2. (1) If (a,b,c,d)∈Q then b(i,1)  =  0 for 1  ≤  i  ≤  m, and a(m,j)  =  0 for 1  ≤  j  ≤  n. For let X  =  V, and let Y be the set of all pairs (i,1) with 1  ≤  i  ≤  m. There do not exist x∈X and y∈Y such that y dominates x, and since b dominates a it follows that a(X)  +  b(Y)  ≤  a(V). Since a(X)  =  a(V) we deduce that b(Y)  =  0. This proves the first statement, and the second follows similarly. This proves (1). (2) If (a,b,c,d)∈Q and a(i,1)  =  0 for all [formula] then (a,b,c,d) is good. This follows from (1) and the inductive hypothesis applied to the restriction of a,b,c,d to the set of all (i,j)∈V with j > 1 (relabeling appropriately).

For (a,b,c,d)∈Q, let us define its margin to be the number of pairs (i,j) such that either j = 1 and a(i,j) > 0, or i  =  m and b(i,j) > 0. For fixed m,n we proceed by induction on the margin. Thus, we assume that t  ≥  0 is an integer, and every (a,b,c,d)∈Q with margin smaller than t is good. We must show that every (a,b,c,d)∈Q with margin t is good. (3) Let (a,b,c,d)∈Q with margin t, and suppose that there exist X,Y  ⊆  V such that

a(X)  +  b(Y)  =  a(V)

there do not exist x∈X and y∈Y such that y dominates x

there exists [formula] such that (i,1)∉X and a(i,1) > 0, and there exists [formula] such that (m,j)∉Y and b(m,j) > 0.

Then (a,b,c,d) is good. Let A1  =  X and [formula]. Let [formula] and B2  =  Y. For k  =  1,2, let Ck be the set of all pairs (i',j)∈V such that there exist i,j' with i < i' and j < j' and (i,j)∈Ak and (i',j')∈Bk; and let Dk be the set of all pairs (i,j') such that there exist i',j with i < i' and j < j' and (i,j)∈Ak and (i',j')∈Bk. We observe first that [formula]; for suppose that [formula]. Since (i',j)∈C1, there exists i < i' such that (i,j)∈X; and since (i',j)∈C2, there exists j' > j such that (i',j')∈Y. But then (i',j')∈Y dominates (i,j)∈X, contradicting the second hypothesis about X,Y. This proves that [formula], and similarly [formula]. For k  =  1,2, and x∈V, define ak(x)  =  a(x) if x∈Ak, and ak(x)  =  0 otherwise. Define bk(x),ck(x),dk(x) similarly. Since a1(V) + a2(V),b1(V) + b2(V) and a1(V) + b2(V) all equal a(V), it follows that a1(V)  =  b1(V) and a2(V)  =  b2(V). We claim that (ak,bk,ck,dk)∈Q for k  =  1,2. To see this, let i < i' and j < j'; we must show first that ak(i,j)bk(i',j')  ≤  ck(i',j)dk(i,j'). Hence we may assume that ak(i,j) and bk(i',j')  ≠  0, and therefore (i,j)∈Ak and (i',j')∈Bk. From the definition of Ck,Dk it follows that (i',j)∈Ck and (i,j')∈Dk. Hence ak(i,j)  =  a(i,j), and bk(i',j')  =  b(i',j'), and ck(i',j)  =  c(i',j), and dk(i,j')  =  d(i,j'); and since a(i,j)b(i',j')  ≤  c(i',j)d(i,j'), this proves the claim. Second, we must show that bk dominates ak. We have already seen that ak(V)  =  bk(V). Let X',Y'  ⊆  V with ak(X')  +  bk(Y') > ak(V); we must show that there exist x∈X' and y∈Y' such that y dominates x. From the symmetry we may assume that k  =  1. Now [formula], and [formula], and so

[formula]

Since b dominates a, there exist [formula] and [formula] such that y dominates x. No vertex in Y dominates a vertex in X, from the choice of X,Y, and it follows that y∈Y', as required. This proves that bk dominates ak, and consequently (ak,bk,ck,dk)∈Q, for k  =  1,2.

We claim that for k  =  1,2, the margin of (ak,bk,ck,dk) is less than t. For from the third hypothesis about X,Y, there exists [formula] such that a(i,1) > 0 and (i,1)∉X (and hence a1(i,1)  =  0); this shows that the margin of (a1,b1,c1,d1) is less than that of (a,b,c,d), and so less than t. Also, there exists [formula] such that b(m,j) > 0 and (m,j)∉Y; and so similarly the margin of (a2,b2,c2,d2) is less than t. Hence from the second inductive hypothesis, we deduce that ak(V)bk(V)  ≤  ck(V)dk(V) for k  =  1,2. But ak(V)  =  bk(V) for k  =  1,2; thus ak(V)2  ≤  ck(V)dk(V) for k  =  1,2. Since a1(V) + a2(V)  =  a(V)  =  b(V) and since c(V)  ≥  c1(V) + c2(V) (because [formula]), and similarly d(V)  ≥  d1(V) + d2(V), it suffices to show that

[formula]

and this follows from [\ref=quad]. This proves (3). (4) If (a,b,c,d)∈Q with margin t, and there exists j  ≥  3 such that b(m,j) > 0, then (a,b,c,d) is good. For let ε satisfy 0  ≤  ε  ≤  1. For 1  ≤  i  ≤  m, define

[formula]

Since b dominates a, by compactness we may choose ε  ≤  1 maximum such that b dominates a1. We claim that (a1,b,c1,d)∈Q; for let i < i' and j < j'. We must check that a1(i,j)b(i',j')  ≤  c1(i',j)d(i,j'). If j  =  1, then

[formula]

and

[formula]

and since a(i,1)b(i',j')  ≤  c(i,1)d(i,j') it follows that a1(i,j)b(i',j')  ≤  c1(i',j)d(i,j') as required. If j  =  2, then

[formula]

and

[formula]

and since a(i,1)b(i',j')  ≤  c(i,1)d(i',j') and a(i,2)b(i',j')  ≤  c(i,2)d(i',j'), it follows that a1(i,j)b(i',j')  ≤  c1(i',j)d(i,j') as required. Finally, if j > 2 the claim is clear, since a1(i,j)  =  a(i,j) and c1(i',j)  =  c(i',j). This proves that (a1,b,c1,d)∈Q.

We claim that (a1,b,c1,d) is good. If ε  =  1, then a1(i,1)  =  0 for 1  ≤  j  ≤  m, and therefore (a1,b,c1,d) is good by (2). We may therefore assume that ε < 1. From the maximality of ε, there exist X,Y  ⊆  V such that

there does not exist x∈X and y∈Y such that y dominates x

a1(X) + b(Y)  =  a1(V)

for some i with 1  ≤  i  ≤  m, (i,1)∉X and and (i,2)∈X and a(i,1) > 0.

(The third statement follows from the fact that increasing ε will cause a1(X) strictly to increase.) Now we recall that there exists j  ≥  3 such that b(m,j) > 0. Since (i,2)∈X is dominated by (m,j) (for i < m by (1), since a(i,2) > 0), it follows that (m,j)∉Y. But then (a1,b,c1,d) satisfies the hypotheses of (3), and therefore (a1,b,c1,d) is good. This proves the claim.

Since a1(V)  =  a(V) and c1(V)  =  c(V), we deduce that (a,b,c,d) is good. This proves (4).

Now let (a,b,c,d)∈Q with margin t; we shall prove that it is good. By (4) we may assume that b(m,j)  =  0 for 3  ≤  j  ≤  m, and similarly that a(i,1)  =  0 for 1  ≤  i  ≤  m - 2. Since a(m,1)  =  b(m,1)  =  0 by (1), it follows that a(i,1)  ≠  0 only if i  =  m - 1, and b(m,j)  ≠  0 only if j  =  2. Let X  =  {(m - 1,1)} and let Y be the set of all (i,j)∈V with i < m; then there do not exist x∈X and y∈Y such that y dominates x. Consequently a(X)  +  b(Y)  ≤  a(V). But a(X)  =  a(m - 1,1) and b(Y)  ≥  a(V) - b(m,2), and so a(m - 1,1)  ≤  b(m,2). Similarly the reverse inequality holds, and so a(m - 1,1) = b(m,2). For (i,j)∈V, if either i  =  m or j  =  1, define

[formula]

If i < m and j > 1 let a1(i,j)  =  a(i,j),b1(i,j)  =  b(i,j), and c1(i,j)  =  c(i,j); and let d1(i,j)  =  d(i,j) except that d1(m - 1,2)  =  0. We claim that (a1,b1,c1,d1)∈Q. For let i < i' and j < j'. We must check that a1(i,j)b1(i',j')  ≤  c1(i',j)d1(i,j'). If i' < m and j > 1 then a1(i,j)  =  a(i,j) and so on, and the claim is clear. If i'  =  m or j  =  1 then a1(i,j)b1(i',j')  =  0 and again the claim is clear. Thus a1(i,j)b1(i',j')  ≤  c1(i',j)d1(i,j'). Next we must check that b1 dominates a1. Certainly

[formula]

Let X,Y  ⊆  V such that a1(X)  +  b1(Y) > a1(V). We must show that there exist x∈X and y∈Y such that y dominates x. We may therefore assume that a1(x) > 0 for all x∈X, and b1(y) > 0 for all y∈Y. In particular, since a1(m - 1,1)  =  b1(m,2)  =  0, it follows that (m - 1,1)∉X and (m,2)∉Y. Let [formula]. Then a(X')  =  a1(X) + a(m - 1,1), and so

[formula]

Hence there exist x∈X' and y∈Y such that y dominates x. If x  =  (m - 1,1), then y  =  (m,j) for some j > 1, and therefore b1(y)  =  0, a contradiction, since b1(y) > 0 for all y∈Y. Thus x  ≠  (m - 1,1), and so x∈X, as required. This proves that b1 dominates a1.

By (2), (a1,b1,c1,d1) is good, and so a1(V)b1(V)  ≤  c1(V)d1(V). Moreover,

[formula]

and b(m,2)  =  a(m - 1,1), and so a(m - 1,1)2  ≤  c(m,1)d(m - 1,2). Hence [\ref=quad] implies that

[formula]

But a(V)  =  a1(V)  +  a(m - 1,1)  =  b(V), and c(V)  ≥  c1(V) + c(m,1), and d(V)  ≥  d1(V) + d(m - 1,2); and it follows that (a,b,c,d) is good. This completes the inductive proof that every member of Q is good, and so proves [\ref=ourfunctions].

The two cliques result

In this section we prove the following.

Let G be a 3-free digraph and let M,N be a partition of V(G) such that M,N are both cliques of G. Then there is a set X  ⊆  E(G) such that every member of X has one end in M and one end in N, and [formula], and [formula] is acyclic. In particular, [formula].

Proof.   The second assertion follows immediately from the first, so we just prove the first. Since the restriction of G to M is a 3-free tournament, we can number [formula] such that uiui'∈E(G) for 1  ≤  i < i'  ≤  m. The same holds for N, but it is convenient to number its members in reverse order; thus we assume that [formula], where vj'vj∈E(G) for 1  ≤  j < j'  ≤  n. Let V be the set of all pairs (i,j) with 1  ≤  i  ≤  m and 1  ≤  j  ≤  n. For a  =  (i,j)∈V and b  =  (i',j')∈V, let us say that (a,b) is a cross if vjui,ui'vj'∈E(G) and 1  ≤  i < i'  ≤  m and 1  ≤  j < j'  ≤  n. Let A0 be the set of all edges of G from N to M, and B0 the set of all edges from M to N. Let k be the minimum cardinality of a subset [formula] such that [formula] is acyclic. (Such a number exists since [formula] is acyclic.) (1) There are k crosses [formula] such that [formula] are all distinct. For suppose not. Let H be the bipartite graph with vertex set [formula], in which vjui∈A0 and ui'vj'∈B0 are adjacent if ((i,j),(i',j')) is a cross. Then H has no k-edge matching, and so by König's theorem, there exists [formula] with |X| < k meeting every edge of H; that is, such that for every cross ((i,j),(i',j')), X contains at least one of the edges vjui,ui'vj'. We claim that [formula] is acyclic. For suppose that C is a directed cycle of [formula], with vertices [formula] in order, say. We may assume that ct  =  vj say, and none of [formula] are vertices of C. Thus c1∈M, say c1  =  ui. If c2∈N, say c2  =  vj', then j' > j and so c2ct∈E(G); but then the vertices ct,c1,c2 are the vertices of a directed cycle of G, contradicting that G is 3-free. Thus c2∈M. Since ct∉M, we may choose s with 3  ≤  s  ≤  t, minimum such that cs∈N. Let cs  =  vj', and cs - 1  =  ui' say. Since [formula] and form a directed path in this order, and the restriction of G to M is acyclic, it follows that i' > i. Also, since none of [formula] are vertices of C, it follows that j'  ≥  j. If j'  =  j then s  =  t and ct - 1,ct,c1 are the vertices of a directed cycle, a contradiction; so j' > j. Hence ((i,j),(i',j')) is a cross, and X contains neither of the edges vjui,ui'vj', a contradiction. This proves (1).

Let [formula] be crosses as in (1). Let [formula], and [formula]. Let C be the set of all (i',j)∈V such that there exist i,j' with 1  ≤  i < i'  ≤  m and 1  ≤  j < j'  ≤  n satisfying (i,j)∈A and (i',j')∈B; and let D be the set of all (i,j')∈V such that there exist i',j with 1  ≤  i < i'  ≤  m and 1  ≤  j < j'  ≤  n satisfying (i,j)∈A and (i',j')∈B. (2) [formula], and |C| + |D|  ≤  γ(G). For suppose first that [formula]. Since (i,j)∈C, there exists j' > j such that (i,j')∈B; and since (i,j)∈D, there exists j'' < j such that (i,j'')∈A. But then vj'vj''∈E(G) since j'' < j < j', and vj''ui∈E(G) since (i,j'')∈A; and uivj'∈E(G) since (i,j')∈B, contradicting that G is 3-free. This proves that [formula]. Moreover, if (i',j)∈C, we claim that ui',vj are nonadjacent. For choose i,j' with 1  ≤  i < i'  ≤  m and 1  ≤  j < j'  ≤  n such that (i,j)∈A and (i',j')∈B. Since {vj,ui,ui'} is not the vertex set of a directied cycle, it follows that ui'vj∉E(G); and since {ui',vj',vj} is also not the vertex set of a directed cycle, vjui'∉E(G). This proves that ui',vj are nonadjacent. Similarly ui,vj' are nonadjacent for all (i,j')∈D. Since [formula], it follows that |C| + |D|  ≤  γ(G). This proves (2).

Let a:V  →    +   be defined by a(x)  =  1 if x∈A, and a(x)  =  0 if [formula]; thus, a is the characteristic function of A. Similarly let b,c,d be the characteristic functions of B,C,D respectively. We claim that the hypotheses of [\ref=ourfunctions] are satisfied. For if 1  ≤  i < i'  ≤  m and 1  ≤  j < j'  ≤  n, and a(i,j)b(i',j') > 0, then (i,j)∈A and (i',j')∈B; hence vjui,ui'vj'∈E(G), and so (i',j)∈C and (i,j')∈D from the definitions of C,D; and therefore condition 1 of [\ref=ourfunctions] holds. For condition 2, note first that a(V)  =  k  =  b(V). Let X,Y  ⊆  V with a(X)  +  b(Y) > a(V)  =  k. We recall that [formula] and [formula] where (ai,bi) is a cross for 1  ≤  i  ≤  k. Thus, [formula] is the number of values of [formula] such that ah∈X, and similarly b(Y) is the number of h with bh∈Y. Since a(X) + b(Y) > k, there exists h such that ah∈X and bh∈Y, and so bh dominates ah. This proves that b dominates a, and therefore the hypotheses of [\ref=ourfunctions] are satisfied.

From [\ref=ourfunctions], it follows that a(V)b(V)  ≤  c(V)d(V), and so |A||B|  ≤  |C||D|. But |A|  =  |B|  =  k, and so |C||D|  ≥  k2. Consequently |C| + |D|  ≥  2k, and hence by (2), [formula]. This proves [\ref=twocliques].

A lemma for the second theorem

Now we turn to the second special case of [\ref=mainconj] that we can prove. The proof is in the next section, and in this section we prove a lemma which is the main step of the proof. First we need some notation. Let t  ≥  1 be an integer and let s  =  3t + 1. If n is an integer, [formula] denotes the integer n' with 0  ≤  n' < s such that n - n' is a multiple of s. If 0  ≤  i,j < s and i,j are distinct, let q > 0 be minimum such that [formula] (so q  =  j - i if j > i, and q  =  j - i  +  s if j < i). We define [formula]. Let Es denote the set of all ordered pairs ij with 0  ≤  i,j < s and j  ≠  i such that |Ds(ij)|  ≤  t, and let Fs be the set of all unordered pairs {i,j} such that 0  ≤  i,j < s and j  ≠  i and ij,ji∉Es. For 0  ≤  k < s, let Cs(k) be the set of all pairs ij∈Es such that k∈Ds(ij).

The lemma asserts the following.

Let t > 0 be an integer, let s  =  3t + 1, and for 0  ≤  i < s let ni∈  +  . Then there exists k with 0  ≤  k < s such that

[formula]

Proof.   Let Qs be the set of all sequences [formula] of members of +  . We say that [formula] is good if there exists k with 0  ≤  k < s such that

[formula]

Thus we must show that every member of Qs is good. We prove this by induction on t. (1) If t  =  1 then every member of Qs is good. For suppose that t = 1. Let (n0,n1,n2,n3)∈Qs; we must show that there exists k with 0  ≤  k  ≤  3 such that [formula]. But

[formula]

and the claim follows. This proves (1).

Henceforth we assume that t > 1. (2) If [formula] and some ni  =  0 then [formula] is good. For we may assume that n0  =  0, from the symmetry. Define mi for 0  ≤  i  ≤  3t - 3 as follows.

[formula]

From the inductive hypothesis and since t > 1, the sequence [formula] satisfies the theorem, and so there exists k' with 0  ≤  k' < s - 3 such that

[formula]

If 0  ≤  k' < t, let k  =  k'; if t  ≤  k' < 2t - 1, let k  =  k' + 1; and if 2t - 1  ≤  k'  ≤  3t - 3, let k  =  k' + 2. Since n0  =  0, in each case it follows easily (we leave checking this to the reader) that

[formula]

But

[formula]

as we can check by rewriting the left side in terms of the ni's and expanding and using that n0  =  0. Consequently,

[formula]

and so [formula] is good. This proves (2). (3) Let [formula], such that

[formula]

for all k with 0  ≤  k  ≤  3t. Then

[formula]

For let 0  ≤  k  ≤  t - 1. For 0  ≤  i  ≤  k, define

[formula]

Then

[formula]

Since the left side of this is nonnegative, and [formula], it follows that ak  ≥  0, that is,

[formula]

Similarly, for 2t + 1 + k  ≤  i  ≤  3t let

[formula]

then

[formula]

Since [formula], we deduce similarly that b2t + 1 + k  ≥  0, that is,

[formula]

Hence

[formula]

that is,

[formula]

But the sum of the left and right sides of this inequality equals N, where [formula], and so the left side is at most [formula]. Summing over all k with 0  ≤  k  ≤  t - 1, we deduce that

[formula]

This proves (3).

Now to complete the proof, let [formula]. Choose h with 0  ≤  h < s such that nh  ≤  ni for all i with 0  ≤  i < s. Let nh  =  x, and for 0  ≤  i < s, define mi  =  ni - x. Thus [formula]. We may assume that

[formula]

for all k with 0  ≤  k  ≤  3t, by cyclically permuting [formula]. By (2), [formula] is good, since mh  =  0. Hence

[formula]

But

[formula]

by (3), where [formula]. Moreover,

[formula]

It follows that [formula] is good. This completes the proof of [\ref=circlemma].

Circular interval digraphs

We say that a digraph G is a circular interval digraph if its vertices can be arranged in a circle such that for every triple u,v,w of distinct vertices, if u,v,w are in clockwise order and uw∈E(G), then uv,vw∈E(G). This is equivalent to saying that the vertex set of G can be numbered as [formula] such that for 1  ≤  i  ≤  n, the set of outneighbours of vi is [formula] for some a  ≥  0, and the set of inneighbours of vi is [formula] for some b  ≥  0, reading subscripts modulo n. The examples given earlier to show that conjecture [\ref=mainconj] is tight infinitely often are circular interval digraphs. The main result of this section is:

[formula] for every 3-free circular interval digraph.

First we need a couple of lemmas. Here is a special kind of circular interval graph. Let t  ≥  1 be an integer, let [formula] be integers, and let [formula]. Let [formula] be disjoint sets of cardinalities [formula] respectively, and let [formula]. Let [formula], where

[formula]

Let G be a digraph with vertex set N and adjacency as follows.

for 0  ≤  k  ≤  3t, if i < j and vi,vj∈Nk then vivj∈E(G)

for 0  ≤  h  ≤  3t and [formula], every vertex in Nh is adjacent to every vertex in Nk.

In this case G is a circular interval graph, and we denote it by [formula]. We observe

For all t  ≥  1 and all choices of [formula], if [formula] then [formula].

Proof.   By [\ref=circlemma], there exists k with 0  ≤  k  ≤  3t such that

[formula]

with notation as in [\ref=circlemma]. But the left side of this is at least β(G), since every directed cycle of G contains an edge uv with u∈Ni and v∈Nj for some ij∈Cs(k); and the right side equals [formula]. This proves [\ref=bagslemma].

Let us say a 3-free circular interval digraph is maximal if there is no pair u,v of nonadjacent distinct vertices such that adding the edge uv results in a 3-free circular interval digraph.

Let G be a maximal 3-free circular interval graph. Then either G is a transitive tournament, or G is isomorphic to [formula] for some choice of [formula].

Proof.   Let the vertices of G be [formula], numbered as in the definition of a circular interval digraph, and throughout we read these subscripts modulo n. For each vertex v, let N+(v),N-(v) denote the set of outneighbours and inneighbours of v, respectively. (1) If [formula] or [formula] for some vertex v, then G is a transitive tournament. For suppose that [formula] for some vertex v, say v1. If vkvj∈E(G) for some j,k with 1  ≤  j < k  ≤  n, then j > 1 and v1,vj,vk are in clockwise order, and therefore vkv1∈E(G), a contradiction. Thus G is acyclic; suppose it is not a tournament. Choose i,j with 1  ≤  i < j  ≤  n with j - i minimum such that vivj∉E(G), and let G' be obtained from G by adding the edge vivj. Then G' is a 3-free circular interval digraph, a contradiction. Thus G is a tournament, and hence a transitive tournament since it is 3-free. Similarly if [formula] for some vertex v, then G is a transitive tournament. This proves (1).

We may therefore assume that vivi + 1∈E(G) for 1  ≤  i  ≤  n. Let us say that X  ⊆  V(G) is a cluster if X is nonempty, every two vertices in X are adjacent, X can be written in the form [formula] for some a,b, and for every vertex v∉X, either X  ⊆  N+(v), or X  ⊆  N-(v), or [formula]. (2) For 1  ≤  i  ≤  n, if {vi,vi + 1} is not a cluster, then [formula] and [formula]. For certainly vivi + 1∈E(G). Let [formula], where a  ≥  1. Suppose that N+(vi + 1)  ⊆  N+(vi). Then [formula]. Let the set of inneighbours of vi be [formula], where b  ≥  1, and let the set of inneighbours of vi + 1 be [formula]. Thus c  ≤  b; suppose that c < b. Then vi - c - 1vi + 1∉E(G), and also vi + 1vi - c - 1∉E(G) since G is 3-free and vi - c - 1vi,vivi + 1∈E(G). Since vi - c - 1vi,vi - cvi + 1∈E(G), it follows that vi - c - 1vh,vhvi + 1∈E(G) for all [formula]. Consequently, the digraph G' obtained from G by adding the edge vi - c - 1vi + 1 is a circular interval digraph. From the maximality of G, G' is not 3-free, and so there exists [formula]; and therefore [formula], which is impossible since G is 3-free. This proves that c  =  b, and so {vi,vi + 1} is a cluster. Similarly if N-(vi)  ⊆  N-(vi + 1) then {vi,vi + 1} is a cluster. This proves (2).

If X,Y are clusters with [formula], it follows easily that [formula] is a cluster. Consequently every two maximal clusters are disjoint. Since {v} is a cluster for every vertex v, it follows that the maximal clusters form a partition of V(G). Let the maximal clusters be [formula] say, numbered in their natural circular order, and let |Ni|  =  ni for 0  ≤  i < s. From the definition of a cluster, if X,Y are disjoint clusters and there exists xy∈E(G) with x∈X and y∈Y, then xy∈E(G) for all x∈X and y∈Y; we denote this by X  →  Y. For 0  ≤  h  <  s, let Th be the set of all [formula] such that Nh  →  Nk; then [formula] say, for some th  ≥  0. Choose h with 0  ≤  h  <  s, and choose i such that vi∈Nh and vi + 1∈Nh + 1. Since {vi,vi + 1} is not a cluster (because maximal clusters are disjoint), it follows from (2) that [formula], and so ti + 1  ≥  ti. Since this holds for all choices of i, and t0  ≥  ts - 1, we deduce that [formula] say. We claim that s  =  3t + 1. For s  ≥  3t + 1 since G is 3-free; let us prove the reverse inequality. Let i  =  n0 and [formula]; thus vi∈N0,vi + 1∈N1, vj - 1∈Nt and vj∈Nt + 1. Since G is maximal and so adding the edge vivj does not result in a 3-free circular interval digraph, it follows that there exists k such that vjvk,vkvi∈E(G), and therefore there exists q such that q∈Tt + 1 and 0∈Tq. Hence q - (t + 1)  ≤  t and s - q  ≤  t; and so s  ≤  3t + 1. This proves that s  =  3t + 1, and so G is isomorphic to [formula]. This proves [\ref=maximal].

Proof of [\ref=circintthm]. We proceed by induction on γ(G). Suppose that G is not a maximal 3-free circular interval graph. Then we can add an edge to G forming a 3-free circular interval graph G'; and γ(G') = γ(G) - 1, so [formula] from the inductive hypothesis. Then

[formula]

as required.

Thus we may assume that G is maximal, and we may assume that G is not a transitive tournament. From [\ref=maximal] and [\ref=bagslemma], this proves [\ref=circintthm].