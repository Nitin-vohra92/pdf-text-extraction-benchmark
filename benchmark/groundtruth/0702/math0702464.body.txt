An algorithm to approximate reals by rationals of the form a / b2.

Introduction

Recently, O. Karpenkov [\cite=OK] posed the problem of the approximation of reals by rationals of the form a / b2 as a natural subject of number theory and for its incidence in the solution of cases of the Shrödinger equation. He presents a proved lower estimate for the approximation of a real ξ as

[formula]

and conjectures that there exists a constant c(ξ) such that the inequality

[formula]

has infinitely many solutions in integers a and b.

In this paper, we study the problem from an heuristic point of view and develop an algorithm that can compute an approximation of the form a / b2 in [formula] polynomial time operations. The heuristic approximation to the problem and the computational data obtained support the conjecture of O. Karpenkov.

An heuristic approach

Following a brute force scheme to search for approximations of the form a / b2 to an irrational ξ, we can compute, for [formula], the optimal value of a as the nearest integer to b2ξ. For each b value we get an approximation

[formula]

It seems reasonable to suppose that the values of δ are distributed uniformly in this interval. The probability of getting a value δ  <  c / b1 + ε, where c is a constant, will be, under that supposition, p(b) = 2c / b1 + ε. Note that, in this case,

[formula]

Moreover, we can estimate the number of rationals with the above approximation as

[formula]

Since the summatory converges for ε > 0, we can guess that there may be only finitely many rational approximations of the form a / b2 of any real ξ, for ε > 0.

When the exponent in b is exactly 3, the summatory is the harmonic series and

[formula]

where [formula] is the Euler's constant (see [\cite=LeVeque] Theorem 6.10, p. 136). Therefore, the number of approximations with b < B may be estimated as 2c(γ  +   ln B). Note that the fractions of that form are not necessarily irreducible in this estimation.

The algorithm

We consider the following modular quadratic equation,

[formula]

Since Pb2 = aQ + α, for some integer a, we can write

[formula]

Let ξ be a real number. From the equation

[formula]

we have that

[formula]

If we choose P / Q as a convergent of ξ computed from its continued fraction expansion, we have that

[formula]

from the well known result due to Hurwitz (see, by example Theorem 193, p. 164 in [\cite=H&W]).

Suppose that we are able to find a solution to equation ([\ref=eqmod]) such that b  ≤  kQ2 / 3 and [formula] for certain constants k and t. Then we have that

[formula]

If we solve equation ([\ref=eqmod]) for some value of α, we have a probability kQ- 1 / 3 of getting a value b  ≤  Q2 / 3, under the supposition that the quadratic residues are distributed at random. Since we check 2Q1 / 3 values of α, we have the chance of getting 2tk values of b in average which gives approximations of ξ that fulfill ([\ref=error]). For this task, we must solve 2tQ1 / 3 quadratic equations for which there are polynomial time algorithms whenever the factorization of Q is known. Suppose that a value of b is obtained such b = Q2 / 3, so the number of quadratic equations solved to obtain it is O(b1 / 2). Take into account that there are methods of factorization that can factorize Q in Qu steps with u well below 1 / 3 (see [\cite=Riesel] p. 218), then the complexity of this stage is smaller than the solution of the quadratic equations.

Using the described method, there may be approximations fulfilling ([\ref=error]) that scape the search of the algorithm. First, a convergent P / Q may have an approximation to ξ better than ([\ref=aprox]), mainly for small Q, what allows that higher values of b keep bounded the first summand in ([\ref=bound]). Besides, both summands can compensate if they are of opposite sign. For these reasons, in practice, it is better to use a brute force scheme for the fist values of b (say for b < 1000) and then to apply the described algorithm. Likewise, it is better to check the values of [formula] (by example of [formula]). Since, once computed the roots of ([\ref=eqmod]), checking the values of b is less time consuming, it is better to rise the bound of b to b  ≤  Q3 / 4. With these trimmings, the algorithm finds all items existing (checked by brute force) at least for b  <  2 * 109.

The algorithm was programmed using the PARI package [\cite=PARI] and compiled with the utility gp2c. The executable was launched in an AMD64 +3200 computer over one week, searching for rational approximations of π such that the difference is less than 1 / b3 in absolute value. There were found 94 rational approximations of the prescribed form which can be found in [\cite=pi] (note that only b values are tabulated because the numerator a can be computed from it). The higher rational approximation found correspond to

[formula]

[formula]

The following figure plots the number of items versus the expected value 1 + 2 ln b showing that both agree quite well. Another irrationals as e, [formula], the golden mean [formula], even numbers suspicious of irrationality as the Euler's constant were tested with the same results.

Approximating irrationals by rationals of the form a / p, p prime.

O. Karpenkov, in his cited paper, also raised the problem of approximating a real with a rational with prime denominator. We follow the procedure described in the preceding section, to find approximations of that kind. Consider the linear modular equation

[formula]

Since Px = aQ + α

[formula]

We take P and Q from a convergent of ξ and solve the equation ([\ref=eqmod2]) for the lowest absolute values of α. Since the density of primes is about 1 /  ln n, we may expect that we will find a x prime for α of the order of ln Q and let that prime be p. This constructive approach makes reasonable the

For any real ξ, there exists a constant c(ξ) such that the inequality

[formula]

with p prime, has infinitely many solutions.

Dedicatory: I dedicate this paper to the memory of my friend Manuel Torres Hernanz. Since my first collaboration with him, two decades ago, computing the Fourier transform of his magnetic measures till a recent talking about the different ways to get rational approximations to [formula], I have enjoyed his knowledge, creativity, and humanistic spirit. I miss him and I am very indebted to his generosity.